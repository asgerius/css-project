[{"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 10688391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999a0f3968db01f07c9147daf1eac51d?s=128&d=identicon&r=PG&f=1", "display_name": "hvguy", "link": "https://stackoverflow.com/users/10688391/hvguy"}, "edited": false, "score": 1, "creation_date": 1542857779, "post_id": 53422085, "comment_id": 93721380, "body": "Yes! I tried several things but was definitely over complicating it. Minor edit, port assignments had to be in parenthesis i.e. (PORTA|=(1&lt;&lt;6))"}], "tags": [], "owner": {"reputation": 920, "user_id": 5482045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/930882390318811/picture?type=large", "display_name": "Nunchy", "link": "https://stackoverflow.com/users/5482045/nunchy"}, "is_accepted": true, "score": 5, "last_activity_date": 1542857912, "last_edit_date": 1542857912, "creation_date": 1542844530, "answer_id": 53422085, "question_id": 53422032, "link": "https://stackoverflow.com/questions/53422032/c-macro-to-turn-a-pin-on-or-off/53422085#53422085", "title": "C macro to turn a pin on or off", "body": "<p>Like this?</p>\n\n<pre><code>#define LED(x) (x==ON) ? (PORTA|=(1&lt;&lt;6)) : (PORTA&amp;=~(1&lt;&lt;6))\n</code></pre>\n\n<p>EDIT: Slight error, I apologise. Is this what you're going for?</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 10688391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999a0f3968db01f07c9147daf1eac51d?s=128&d=identicon&r=PG&f=1", "display_name": "hvguy", "link": "https://stackoverflow.com/users/10688391/hvguy"}, "edited": false, "score": 0, "creation_date": 1542857830, "post_id": 53422243, "comment_id": 93721394, "body": "If it wasn&#39;t for the fact that these are distributed over different registers this would work well."}, {"owner": {"reputation": 145, "user_id": 5334741, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/eor0o.jpg?s=128&g=1", "display_name": "Ahmed Yasen", "link": "https://stackoverflow.com/users/5334741/ahmed-yasen"}, "reply_to_user": {"reputation": 41, "user_id": 10688391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999a0f3968db01f07c9147daf1eac51d?s=128&d=identicon&r=PG&f=1", "display_name": "hvguy", "link": "https://stackoverflow.com/users/10688391/hvguy"}, "edited": false, "score": 0, "creation_date": 1542881538, "post_id": 53422243, "comment_id": 93731132, "body": "@hvguy, I have edited the answer and added the generic part for all ports"}], "tags": [], "owner": {"reputation": 145, "user_id": 5334741, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/eor0o.jpg?s=128&g=1", "display_name": "Ahmed Yasen", "link": "https://stackoverflow.com/users/5334741/ahmed-yasen"}, "is_accepted": false, "score": 0, "last_activity_date": 1542881461, "last_edit_date": 1542881461, "creation_date": 1542845989, "answer_id": 53422243, "question_id": 53422032, "link": "https://stackoverflow.com/questions/53422032/c-macro-to-turn-a-pin-on-or-off/53422243#53422243", "title": "C macro to turn a pin on or off", "body": "<p>You can use the ternary operator alternatively.</p>\n\n<pre><code>#define ON 1\n#define OFF 0\n#define LED(X)  (X)?(PORTA|=(1&lt;&lt;6)):(PORTA &amp;= ~(1&lt;&lt;6));\n</code></pre>\n\n<p>You can to make it more generic macro by replacing the pin number as:</p>\n\n<pre><code>#define ON 1\n#define OFF 0\n#define LED(STATE, PIN) (STATE)?(PORTA|=(1&lt;&lt;PIN)):(PORTA &amp;= ~(1&lt;&lt;PIN));\n</code></pre>\n\n<p>Also, You can make it generic for all ports by replacing the PortName as:</p>\n\n<pre><code>#define ON 1\n#define OFF 0\n#define LED(STATE, PORT, PIN)   (STATE)?(PORT|=(1&lt;&lt;PIN)):(PORT&amp;=~(1&lt;&lt;PIN));\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10688391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999a0f3968db01f07c9147daf1eac51d?s=128&d=identicon&r=PG&f=1", "display_name": "hvguy", "link": "https://stackoverflow.com/users/10688391/hvguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 53422085, "answer_count": 2, "score": 3, "last_activity_date": 1542881461, "creation_date": 1542844104, "last_edit_date": 1542857912, "question_id": 53422032, "link": "https://stackoverflow.com/questions/53422032/c-macro-to-turn-a-pin-on-or-off", "title": "C macro to turn a pin on or off", "body": "<p>I know it seems like this has been asked before but I spent a few hours looking for and testing things and couldn't find a solution.</p>\n\n<p>I want to replace this:</p>\n\n<pre><code>#define LED_ON PORTA|=(1&lt;&lt;6)\n#define LED_OFF PORTA&amp;=~(1&lt;&lt;6)\n</code></pre>\n\n<p>with something that works like this:</p>\n\n<pre><code>#define ON 1\n#define OFF 0\n#define LED(x) if (x==ON) PORTA|=(1&lt;&lt;6) else if (x==OFF) PORTA&amp;=~(1&lt;&lt;6)\n</code></pre>\n\n<p>So what is the right way (or best way?) to do this?</p>\n"}, {"tags": ["c", "encryption", "openssl"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1542841899, "post_id": 53421649, "comment_id": 93717869, "body": "Fyi, the IV fed to any of the IV-utilizing algorithms performed by EVP encipherment functions is intentionally updated inline. There&#39;a a reason that buffer isn&#39;t addressed by <code>const unsigned char*</code>. And fwiw, there are many other ways to generate a random IV than what you&#39;re doing (which isn&#39;t very random at all)."}, {"owner": {"reputation": 23, "user_id": 7509130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898f57124599bdaf73a6eb62b0710dda?s=128&d=identicon&r=PG&f=1", "display_name": "Ronoc Eroom", "link": "https://stackoverflow.com/users/7509130/ronoc-eroom"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1542842522, "post_id": 53421649, "comment_id": 93718066, "body": "Sorry, a little confused, but should I make a copy of the IV and use that for the second encryption?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1542842620, "post_id": 53421649, "comment_id": 93718104, "body": "Assuming you want to retain the original to kick of future decipherment, yes. Unless it is a known commodity you&#39;ll have to retain it somewhere. It isn&#39;t uncommon to emit it as the first frame of your cipher text, then continue with the remainder of the encryption, and the decryptor is aware of this strat."}, {"owner": {"reputation": 23, "user_id": 7509130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898f57124599bdaf73a6eb62b0710dda?s=128&d=identicon&r=PG&f=1", "display_name": "Ronoc Eroom", "link": "https://stackoverflow.com/users/7509130/ronoc-eroom"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1542844419, "post_id": 53421649, "comment_id": 93718617, "body": "Thanks so much for the advice! I now have the same IV for each encryption, but I&#39;m still not getting any output as in my encryption is still 0010 - &lt;SPACES/NULS&gt;, I&#39;ll be editing my above code to reflect the changes"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1542844521, "post_id": 53421649, "comment_id": 93718654, "body": "Encrypted data won&#39;t necessarily be printable strings (in fact it&#39;s highly <i>unlikely</i>). Fire up a debugger and inspect the content of the memory behind <code>cipher_name</code> and <code>cipher_pin</code>."}, {"owner": {"reputation": 23, "user_id": 7509130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898f57124599bdaf73a6eb62b0710dda?s=128&d=identicon&r=PG&f=1", "display_name": "Ronoc Eroom", "link": "https://stackoverflow.com/users/7509130/ronoc-eroom"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1542844625, "post_id": 53421649, "comment_id": 93718686, "body": "The BIO_dump_fp part is what outputs the encryption as a readable string, I used the terminal version on the expected output and got an actual return. For instance inputting &quot;bob&quot; gave 0000 - c7 2b 0a 46 7f 8e 2f e1-7d e6 a3 20 99 c2 7d 2b   .+.F../.}.. ..}+"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1542844693, "post_id": 53421649, "comment_id": 93718700, "body": "Derp. yeah, just saw that there. thanks for keeping me honest."}, {"owner": {"reputation": 23, "user_id": 7509130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898f57124599bdaf73a6eb62b0710dda?s=128&d=identicon&r=PG&f=1", "display_name": "Ronoc Eroom", "link": "https://stackoverflow.com/users/7509130/ronoc-eroom"}, "edited": false, "score": 0, "creation_date": 1542845734, "post_id": 53421649, "comment_id": 93718980, "body": "It&#39;s not so much a problem of being readable, the ciphertext isn&#39;t being produced, I put an example of what it is supposed to be outputting and it&#39;s not giving anything like that"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1542846530, "post_id": 53421649, "comment_id": 93719172, "body": "Fyi, he&#39;s not joking, nor hallucinating. I primed up his algorithm, and wrote one myself I&#39;m <i>sure</i> is correct. upon executing either (the OPs or mine) on my macOS with 1.0.2o libcrypto, I get <a href=\"https://pastebin.com/UdP5C90v\" rel=\"nofollow noreferrer\">something like this</a>, which I&#39;m sure is what the OP is seeking. The <i>same</i> code ran on coliru <a href=\"https://pastebin.com/WNEsiP3Z\" rel=\"nofollow noreferrer\">gives <b>this</b></a>. Dare I ask, what OpenSSL libcrypto and/or platform is this on? Btw, in case anyone wonders, the linked output is the bin-dump of the random IV, the plaintext, and the cipher text. That spaces/null in the middle is just weird."}, {"owner": {"reputation": 23, "user_id": 7509130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898f57124599bdaf73a6eb62b0710dda?s=128&d=identicon&r=PG&f=1", "display_name": "Ronoc Eroom", "link": "https://stackoverflow.com/users/7509130/ronoc-eroom"}, "edited": false, "score": 0, "creation_date": 1542846843, "post_id": 53421649, "comment_id": 93719237, "body": "I&#39;m running Ubuntu 18.04 LTS on a VirtualBox VM, and I&#39;m using &quot;OpenSSL 1.1.0g  2 Nov 2017&quot;"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1542846883, "post_id": 53421649, "comment_id": 93719249, "body": "Worth noting, the output with spaces/null is <i>missing</i> the intentional terminating byte of the plaintext buffer on the prior line (it&#39;s actually <code>char pt[] = &quot;0123&quot;;</code> and i&#39;m intentionally using the entire buffer, terminator and all). I just noticed that. how odd. If you can, look at the two side by side. Regardless, I <i>think</i> you&#39;re getting your cipher text, regardless of that bizarre output. I tested your function and it seems correct."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1542847706, "post_id": 53421649, "comment_id": 93719401, "body": "@MaartenBodewes I wasn&#39;t suggesting you were joking. And I&#39;ve only been at this for over a quarter-century now, including crypto since &#39;93. The OP&#39;s <i>output</i> is what is confusing him, not encoding. He&#39;s purposely dumping to stdout using the very libcrypto API that is designed to do that: hex-dump to a file stream. it is the <i>inconsistencies</i> between two different builds of libcrypto (his is 1.1.0, mine is 1.0.2) that puzzles me. And if you read my prior two comments and still didn&#39;t take that away, then I doubt there is much I could add to make that outcome any different."}, {"owner": {"reputation": 23, "user_id": 7509130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898f57124599bdaf73a6eb62b0710dda?s=128&d=identicon&r=PG&f=1", "display_name": "Ronoc Eroom", "link": "https://stackoverflow.com/users/7509130/ronoc-eroom"}, "edited": false, "score": 0, "creation_date": 1542848114, "post_id": 53421649, "comment_id": 93719478, "body": "I tried to run what I had encrypted through the decrypt function to see if I was still getting the right data just outputting it poorly, but I got a &quot;EVP_DecryptFinal_ex:bad decrypt:&quot; error."}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1542848981, "post_id": 53421649, "comment_id": 93719615, "body": "@RonocEroom Please set the IV to an explicit value for <i>each encrypt</i>. It is updated with the ciphertext of the previous encrypt - which you should not use anymore. You need the same IV value during encryption as used for the specific encrypt. Often the IV is stored before the ciphertext if it is random. Note that the IV should consist of random <i>bytes</i> with any value, not random <i>digits</i>."}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1542849116, "post_id": 53421649, "comment_id": 93719640, "body": "@WhozCraig Hmm, I see what you mean. I tried reading through the <code>BIO_dump_fp</code> but I can just say that it is an example on how to obscure simple hex output to the extreme. Are you expecting this an issue of the function or maybe of the output terminal? Sorry, I did not expect &quot;dump&quot; to mean: &quot;pretty print bytes&quot; (then again <code>-d</code> does mean that in the command line)."}, {"owner": {"reputation": 23, "user_id": 7509130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898f57124599bdaf73a6eb62b0710dda?s=128&d=identicon&r=PG&f=1", "display_name": "Ronoc Eroom", "link": "https://stackoverflow.com/users/7509130/ronoc-eroom"}, "edited": false, "score": 0, "creation_date": 1542849829, "post_id": 53421649, "comment_id": 93719780, "body": "My current process is to encrypt the name, and pin using the same IV. Then put the two cipher texts into a file with the IV so they can be decrypted as needed later. I can make two seperate IVs but that seems unnecessary, but I may be wrong.  Also the openSSL guidelines say to use a 16-byte unsigned char which is what I&#39;m using."}, {"owner": {"reputation": 23, "user_id": 7509130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898f57124599bdaf73a6eb62b0710dda?s=128&d=identicon&r=PG&f=1", "display_name": "Ronoc Eroom", "link": "https://stackoverflow.com/users/7509130/ronoc-eroom"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1542853090, "post_id": 53421649, "comment_id": 93720433, "body": "UPDATE: First thank you all so much for your help! Second, if I hard code the IV into the file that handles encryption it works fine, so somewhere between calling encrypt and actually doing the encryption, somethings going wrong. I think I can work past this, but once again thank you all so much for all the work you did! @WhozCraig"}, {"owner": {"reputation": 23, "user_id": 7509130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898f57124599bdaf73a6eb62b0710dda?s=128&d=identicon&r=PG&f=1", "display_name": "Ronoc Eroom", "link": "https://stackoverflow.com/users/7509130/ronoc-eroom"}, "reply_to_user": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1542853163, "post_id": 53421649, "comment_id": 93720446, "body": "And @MaartenBodewes (sorry you can only tag one user per post)"}, {"owner": {"reputation": 23625, "user_id": 2868801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec5567811049b7ce8192be0bc0246d1?s=128&d=identicon&r=PG&f=1", "display_name": "dave_thompson_085", "link": "https://stackoverflow.com/users/2868801/dave-thompson-085"}, "edited": false, "score": 2, "creation_date": 1542854677, "post_id": 53421649, "comment_id": 93720794, "body": "<b>Your arguments are swapped.</b> You call encrypt with (plain_buf, plain_len, IV, cipher_buf) but encrypt&#39;s parameters are (plain_buf, plain_len, cipher_buf, IV) so it treats the (zeroed) cipherbuf as the IV and writes the ciphertext to the IV buffer. Since nothing is written to either cipher buffer they dump as all-zeros. Also in your edit you allocate IV_cpy and copy to it, but still use IV in the encrypt calls, so IV_cpy is effectively wasted."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 23625, "user_id": 2868801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec5567811049b7ce8192be0bc0246d1?s=128&d=identicon&r=PG&f=1", "display_name": "dave_thompson_085", "link": "https://stackoverflow.com/users/2868801/dave-thompson-085"}, "edited": false, "score": 0, "creation_date": 1542855557, "post_id": 53421649, "comment_id": 93720961, "body": "@dave_thompson_085 That would certainly do it. I hope the OP is reading this still. And it also explains how I used the OP&#39;s encrypt code and still produce valid encryptions. I was actually calling it correctly."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1542855700, "post_id": 53421649, "comment_id": 93720984, "body": "@MaartenBodewes eh. no worries I think dave thompson hit it. This is the reason I prefer <i>not</i> wrapping the libcrypto APIs,  it&#39;s just too easy to flip something and it takes forever to catch it. In C++ i wrap all the contexts, keys, etc, with <code>std::unique_ptr</code> and specialized default-deleters, but other than that, it&#39;s EVP api all the way."}, {"owner": {"reputation": 23, "user_id": 7509130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898f57124599bdaf73a6eb62b0710dda?s=128&d=identicon&r=PG&f=1", "display_name": "Ronoc Eroom", "link": "https://stackoverflow.com/users/7509130/ronoc-eroom"}, "reply_to_user": {"reputation": 23625, "user_id": 2868801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec5567811049b7ce8192be0bc0246d1?s=128&d=identicon&r=PG&f=1", "display_name": "dave_thompson_085", "link": "https://stackoverflow.com/users/2868801/dave-thompson-085"}, "edited": false, "score": 0, "creation_date": 1542855973, "post_id": 53421649, "comment_id": 93721029, "body": "I&#39;m smacking myself in the head thanks so much @dave_thompson_085"}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1542856640, "post_id": 53421649, "comment_id": 93721141, "body": "Ugh, should have seen that. OpenSSL does have &quot;normal&quot; parameter order. Key (static parameter), IV (dynamic parameter), plaintext (input). Most crypto libs use those parameters in that order. Of course Java and some other OO based APIs wrap the IV in an object, so this mistake is impossible. @WhozCraig Yeah, <i>generic</i> wrapper libs are horror shows. If you do create a method for encryption it better be application specific."}], "owner": {"reputation": 23, "user_id": 7509130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898f57124599bdaf73a6eb62b0710dda?s=128&d=identicon&r=PG&f=1", "display_name": "Ronoc Eroom", "link": "https://stackoverflow.com/users/7509130/ronoc-eroom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1542845828, "creation_date": 1542841248, "last_edit_date": 1542845828, "question_id": 53421649, "link": "https://stackoverflow.com/questions/53421649/openssl-cbc-encrypt-corruption-of-iv", "title": "OpenSSL CBC Encrypt corruption of IV", "body": "<p>I'm trying to encrypt \"customer\" information before writing that information to a file using the OpenSSL CBC-Mode for C.</p>\n\n<p>When I try to encrypt the text it doesn't create an encrypted output it also appears to corrupt the given IV\nIt goes as follows</p>\n\n<pre><code>BANK: create-user bob 1234 1\nPLAINTEXT: bob\nIV: 9289437166649966\nENCRYPTION OF NAME OUTPUT:\n0010 - &lt;SPACES/NULS&gt;        &lt;-- encrypting name outputs nothing\nPLAINTEXT: 1234\nIV: \ufffd\ufffd=H\ufffdW\ufffd\ufffdI\ufffd\ufffd%%\ufffd\ufffd\ufffd &lt;-- IV becomes unusable afterwards\nENCRYPTION OF PIN OUTPUT:\n0010 - &lt;SPACES/NULS&gt;        &lt;-- Still no encryption output\n</code></pre>\n\n<p>The corrupted IV is always the same regardless of inputted IV</p>\n\n<p>My code for generating the encryption is this:</p>\n\n<pre><code>unsigned char *cipher_name, *cipher_pin, IV[16], *IV_cpy*plaintext_n, *plaintext_p;\ncipher_name = (unsigned char *) calloc(1000, sizeof(unsigned char));\ncipher_pin = (unsigned char *) calloc(1000, sizeof(unsigned char));\nplaintext_n = (unsigned char *) calloc(1000, sizeof(unsigned char));\nplaintext_p = (unsigned char *) calloc(1000, sizeof(unsigned char));\nint cipher_len;\n.\n.\n.\nrand_gen(IV);\nIV_cpy = (unsigned char *)malloc(strlen((char *)IV));\nmemcpy(IV_cpy, IV, strlen((char *)(IV)));\n\nstrcpy((char *)plaintext_n,cmd[1]);\ncipher_len = encrypt(plaintext_n, strlen((char *) plaintext_n), IV,cipher_name);\nBIO_dump_fp (stdout, (const char *)cipher_name, cipher_len);\nstrcpy((char *)plaintext_p, cmd[2]);\nmemcpy(IV_cpy, IV, strlen((char *)(IV)));\ncipher_len = encrypt(plaintext_p, strlen((char *) plaintext_p), IV, cipher_pin);\nBIO_dump_fp (stdout, (const char *)cipher_pin, cipher_len);\n</code></pre>\n\n<p>I omitted the print statements to help readability.</p>\n\n<p>The code that generates the IV is:</p>\n\n<pre><code>void rand_gen(unsigned char *ret_val) {\n    int i, random;\n    char rand_int[2];\n    ret_val[0] = '\\0';\n    srand(time(0));\n    for(i = 0; i &lt; 16; i++) {\n            random = rand() % 10;\n            if(random == 0) {\n                    random = 1;\n            }\n            sprintf(rand_int, \"%d\", random);\n            strcat((char *)ret_val, rand_int);\n    }\n</code></pre>\n\n<p>}</p>\n\n<p>The code for the encrypt function is </p>\n\n<pre><code>int encrypt(unsigned char *plaintext, int plaintext_len, unsigned char\n*ciphertext, unsigned char *IV) {\n    EVP_CIPHER_CTX *ctx;\n    int len;\n    int ciphertext_len;\n    if(!(ctx = EVP_CIPHER_CTX_new())) handleErrors();\n    if(1 != EVP_EncryptInit_ex(ctx, EVP_aes_256_cbc(), NULL, key, IV)) handleErrors();\n    if(1 != EVP_EncryptUpdate(ctx, ciphertext, &amp;len, plaintext, plaintext_len)) handleErrors();\n    ciphertext_len = len;\n    if(1 != EVP_EncryptFinal_ex(ctx, ciphertext + len, &amp;len)) handleErrors(); \n    ciphertext_len += len;\n    EVP_CIPHER_CTX_free(ctx);\n    return ciphertext_len;\n}\n</code></pre>\n\n<p>The key is available elsewhere which is why it's not in the function args</p>\n\n<p>What is being output by encrypt:</p>\n\n<pre><code>0010 - &lt;SPACES/NULS&gt;\n</code></pre>\n\n<p>What encrypt is supposed to be outputting:</p>\n\n<pre><code>0000 - c7 2b 0a 46 7f 8e 2f e1-7d e6 a3 20 99 c2 7d 2b   .+.F../.}.. ..}+\n</code></pre>\n"}, {"tags": ["c", "linux", "make-install", "freerdp"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1542841201, "post_id": 53421593, "comment_id": 93717630, "body": "Why are you asking on stackoverflow instead of asking the freerdp developers??"}, {"owner": {"reputation": 2203, "user_id": 1602853, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/SUTHV.jpg?s=128&g=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1602853/harry"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1542841268, "post_id": 53421593, "comment_id": 93717655, "body": "It seems like a build issue of code, missing libraries"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1542873772, "post_id": 53421593, "comment_id": 93726747, "body": "Update you version of FreeRDP to one that supports OpenSSL 1.1.0, or downgrade your version of OpenSSL to 1.0.2. Also see <a href=\"https://stackoverflow.com/q/42292027/608639\">Aggregate \u2018BIGNUM foo\u2019 has incomplete type and cannot be defined</a>, <a href=\"https://stackoverflow.com/q/16878318/608639\">OpenSSL dereferencing pointer to incomplete type</a>, <a href=\"https://stackoverflow.com/q/46546230/608639\">OpenSSL error incomplete definition of type &#39;struct ec_key_st&#39;</a> and friends."}], "owner": {"reputation": 2203, "user_id": 1602853, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/SUTHV.jpg?s=128&g=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1602853/harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 449, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542873631, "creation_date": 1542840954, "last_edit_date": 1542873631, "question_id": 53421593, "link": "https://stackoverflow.com/questions/53421593/building-freerdp-and-make-install-error-field-des3-ctx-has-incomplete-type", "title": "Building FreeRDP and make install error: field \u2018des3_ctx\u2019 has incomplete type", "body": "<p>I was trying to install FreeRDP server using the link : <a href=\"https://github.com/FreeRDP/Remmina/wiki/Compile-on-Ubuntu-16.04\" rel=\"nofollow noreferrer\">https://github.com/FreeRDP/Remmina/wiki/Compile-on-Ubuntu-16.04</a></p>\n\n<p>I hit to the below error during <code>make and make install</code></p>\n\n<pre><code>[ 25%] Building C object libfreerdp-codec/CMakeFiles/freerdp-codec.dir/nsc.c.o\n[ 26%] Building C object libfreerdp-codec/CMakeFiles/freerdp-codec.dir/rfx_sse2.c.o\n[ 26%] Linking C shared library libfreerdp-codec.so\n[ 26%] Built target freerdp-codec\nScanning dependencies of target freerdp-core\n[ 27%] Building C object libfreerdp-core/CMakeFiles/freerdp-core.dir/activation.c.o\nIn file included from /home/hari/openuds/freerdp/FreeRDP-1.0.2/libfreerdp-core/tls.h:23:0,\n                 from /home/hari/openuds/freerdp/FreeRDP-1.0.2/libfreerdp-core/transport.h:33,\n                 from /home/hari/openuds/freerdp/FreeRDP-1.0.2/libfreerdp-core/mcs.h:24,\n                 from /home/hari/openuds/freerdp/FreeRDP-1.0.2/libfreerdp-core/rdp.h:23,\n                 from /home/hari/openuds/freerdp/FreeRDP-1.0.2/libfreerdp-core/activation.h:23,\n                 from /home/hari/openuds/freerdp/FreeRDP-1.0.2/libfreerdp-core/activation.c:20:\n/home/hari/openuds/freerdp/FreeRDP-1.0.2/libfreerdp-core/crypto.h:67:17: error: field \u2018des3_ctx\u2019 has incomplete type\n  EVP_CIPHER_CTX des3_ctx;\n                 ^~~~~~~~\n/home/hari/openuds/freerdp/FreeRDP-1.0.2/libfreerdp-core/crypto.h:72:11: error: field \u2018hmac_ctx\u2019 has incomplete type\n  HMAC_CTX hmac_ctx;\n           ^~~~~~~~\nlibfreerdp-core/CMakeFiles/freerdp-core.dir/build.make:62: recipe for target 'libfreerdp-core/CMakeFiles/freerdp-core.dir/activation.c.o' failed\nmake[2]: *** [libfreerdp-core/CMakeFiles/freerdp-core.dir/activation.c.o] Error 1\nCMakeFiles/Makefile2:494: recipe for target 'libfreerdp-core/CMakeFiles/freerdp-core.dir/all' failed\nmake[1]: *** [libfreerdp-core/CMakeFiles/freerdp-core.dir/all] Error 2\nMakefile:151: recipe for target 'all' failed\nmake: *** [all] Error 2\n</code></pre>\n\n<p>Could you please help me to resolve this issue?</p>\n"}, {"tags": ["c", "arrays", "malloc"], "comments": [{"owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 1, "creation_date": 1542840545, "post_id": 53421482, "comment_id": 93717431, "body": "<code>for(marks=0; *marks &lt;= \u2026</code> directly crashes. You probably meant <code>for(*marks=0; ...</code>!?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1542840557, "post_id": 53421482, "comment_id": 93717432, "body": "Fyi, turn up your warnings. Look at <code>marks_summation</code>, specifically at <code>if(gender == g)</code> and ask yourself, &quot;What is the value of <code>g</code> when this is checked?&quot; if the answer is anything other than &quot;I don&#39;t know&quot;, it&#39;s wrong. Evaluation of indeterminate variables invokes <i>undefined behavior</i>. From what I see, <code>g</code> is <i>never</i> set, and never even <i>used</i> in that function other than the improper usage I already mentioned, so consider it fair game for removal. That function also accumulates <code>sum</code>, and does absolutely nothing with it."}, {"owner": {"reputation": 375, "user_id": 5683152, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/d7Iy3.png?s=128&g=1", "display_name": "sstefan", "link": "https://stackoverflow.com/users/5683152/sstefan"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1542840743, "post_id": 53421482, "comment_id": 93717484, "body": "@WhozCraig maybe it was meant be &#39;g&#39;, ignoring the declaration..."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1542840800, "post_id": 53421482, "comment_id": 93717510, "body": "You have an unnecessary space in front of <code>%d</code> but lack the necessary space in front of <code>%c</code>. You must also check the function return value of <code>scanf</code>."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 375, "user_id": 5683152, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/d7Iy3.png?s=128&g=1", "display_name": "sstefan", "link": "https://stackoverflow.com/users/5683152/sstefan"}, "edited": false, "score": 1, "creation_date": 1542840860, "post_id": 53421482, "comment_id": 93717524, "body": "@sstefan i seriously doubt it, but i give us a one-in-five chance the OP actually clarifies the matter further. If anything, it would be checked for <code>f</code> and/or <code>m</code> . (at least in the world I live in). If ever there was a need for a conversation with ones <a href=\"https://en.wikipedia.org/wiki/Rubber_duck_debugging\" rel=\"nofollow noreferrer\">rubber duck</a> that function is it."}], "answers": [{"tags": [], "owner": {"reputation": 2013, "user_id": 946814, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ZQst0.jpg?s=128&g=1", "display_name": "Bruno Kim", "link": "https://stackoverflow.com/users/946814/bruno-kim"}, "is_accepted": false, "score": 0, "last_activity_date": 1542840854, "creation_date": 1542840854, "answer_id": 53421577, "question_id": 53421482, "link": "https://stackoverflow.com/questions/53421482/segmentation-fault-11-using-arrays/53421577#53421577", "title": "Segmentation fault 11 using arrays", "body": "<p>The following line is not doing what you might think it does:</p>\n\n<pre><code>for(marks = 0; *marks &lt;= number_of_students; marks++)\n</code></pre>\n\n<p>I believe you'd want to use an index to access each of marks elements.</p>\n"}, {"tags": [], "owner": {"reputation": 375, "user_id": 5683152, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/d7Iy3.png?s=128&g=1", "display_name": "sstefan", "link": "https://stackoverflow.com/users/5683152/sstefan"}, "is_accepted": false, "score": 0, "last_activity_date": 1542842581, "creation_date": 1542842581, "answer_id": 53421836, "question_id": 53421482, "link": "https://stackoverflow.com/questions/53421482/segmentation-fault-11-using-arrays/53421836#53421836", "title": "Segmentation fault 11 using arrays", "body": "<p>As others have pointed out, the problem is in the for loop. Besides pointers being wrong, your loop condition is also wrong. Furthermore your function doesn't return anything. Also, both of your do-while loops are infinite loops.</p>\n\n<p>Try this:</p>\n\n<pre><code>int mark_sum(int *marks, int number_of_students, char gender){\n  int sum = 0;\n  for(int i = 0; i &lt; number_of_students; ++i){\n    if(gender = 'g'){\n      if(marks[i] % 2 == 0)\n        sum += marks[i];\n    } else {\n      if(marks[i] % 2 != 0)\n        sum += marks[i];\n    }\n  }\n  return sum;\n}\n</code></pre>\n\n<p>Also, in main you need to actually store the value returned by the function:</p>\n\n<pre><code>int sum = mark_sum(marks, number_of_students, gender);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10688252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/850dccb559749c15eadb0eef2106edb5?s=128&d=identicon&r=PG&f=1", "display_name": "J.Lee", "link": "https://stackoverflow.com/users/10688252/j-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1542842581, "creation_date": 1542840310, "last_edit_date": 1542840462, "question_id": 53421482, "link": "https://stackoverflow.com/questions/53421482/segmentation-fault-11-using-arrays", "title": "Segmentation fault 11 using arrays", "body": "<p>I am a beginner with coding and I got my code to compile but when I input integers, I get segmentation fault. Please help.</p>\n\n<p>The problem is: I need to first get how many students there are then the next inputs will be the marks of those students. So if inputed 3, the next inputs should be 3 marks of the 3 students. Then the input should be either g(girl) or b(boy). From there, if boy, I need to sum up all the odd marks.</p>\n\n<p>THIS IS MY CODE:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nint marks_summation(int* marks, int number_of_students, char gender){\n\n    int i=0, sum=0;\n    int marksforGirls=0, marksforBoys=0;\n    char g;\n\n    for(marks = 0; *marks &lt;= number_of_students; marks++){\n        if(gender == g){\n            do{\n                if(marks[i]%2 == 0){\n                    marksforGirls = marks[i];\n                    i++;\n                    sum += marksforGirls;\n                }\n            } while(*marks&lt;=number_of_students);\n        }\n        else{\n            do{\n                if(marks[i]%2 != 0){\n                    marksforBoys = marks[i];\n                    i++;\n                    sum += marksforBoys;\n                }\n            } while (*marks&lt;=number_of_students);\n        }\n    }\n    return 0;\n}\n\n\nint main(){\n\n    int i=0, number_of_students=0;\n    int *marks=0;\n    int sum=0;\n    char gender;\n\n    scanf(\"%d\",&amp;number_of_students);\n\n    marks = (int*)malloc(number_of_students * sizeof(int));\n\n    for(i=0; i&lt;number_of_students; i++){\n        scanf(\" %d\", &amp;marks[i]);//for every marks put in, it will go into marks\n    }\n\n    scanf(\"%c\",&amp;gender);\n\n    marks_summation(marks, number_of_students, gender);\n\n    printf(\"%d\", sum);\n\n    free(marks);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1542840383, "post_id": 53421469, "comment_id": 93717378, "body": "malloc() returns a value."}, {"owner": {"reputation": 625, "user_id": 3140754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qceIh.jpg?s=128&g=1", "display_name": "Tom Kuschel", "link": "https://stackoverflow.com/users/3140754/tom-kuschel"}, "edited": false, "score": 2, "creation_date": 1542840527, "post_id": 53421469, "comment_id": 93717422, "body": "<code>malloc</code> itselfs returns the pointer, NULL if there is no memory available like: <code>countries_array = malloc(num_of_countries*sizeof countries_array);</code>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1542841214, "post_id": 53421469, "comment_id": 93717634, "body": "You will want to review: <a href=\"http://stackoverflow.com/questions/750178/is-it-a-good-idea-to-typedef-pointers\">Is it a good idea to <b>typedef</b> pointers?</a>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1542843773, "post_id": 53421469, "comment_id": 93718448, "body": "What is <code>countries_array = (pCountry);</code> supposed to mean? Was that intended to be a type cast of the result of the next line?"}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1542854010, "post_id": 53421469, "comment_id": 93720643, "body": "which file does the error point to, to which line? how declaration of the <code>country_array</code> looks like?"}], "answers": [{"comments": [{"owner": {"reputation": 194, "user_id": 10501192, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-l4cOz3fnQ1o/AAAAAAAAAAI/AAAAAAAAAPU/nxkUeDtLmaU/photo.jpg?sz=128", "display_name": "hellork", "link": "https://stackoverflow.com/users/10501192/hellork"}, "edited": false, "score": 0, "creation_date": 1542844009, "post_id": 53421970, "comment_id": 93718517, "body": "Checking right after malloc for out of memory condition is advisable. if (!countries_array) { fprintf(stderr, &quot;out of memory&quot;); exit 1; }"}, {"owner": {"reputation": 194, "user_id": 10501192, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-l4cOz3fnQ1o/AAAAAAAAAAI/AAAAAAAAAPU/nxkUeDtLmaU/photo.jpg?sz=128", "display_name": "hellork", "link": "https://stackoverflow.com/users/10501192/hellork"}, "edited": false, "score": 0, "creation_date": 1542845442, "post_id": 53421970, "comment_id": 93718914, "body": "On casting <code>malloc()</code>. Since this is tagged &quot;C&quot; we don&#39;t (cast) the result of <code>malloc</code>, because it hides important compiler errors if we do. In C++, it is required, so it crops up quite a bit. <a href=\"http://c-faq.com/malloc/mallocnocast.html\" rel=\"nofollow noreferrer\">c-faq.com/malloc/mallocnocast.html</a>"}], "tags": [], "owner": {"reputation": 194, "user_id": 10501192, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-l4cOz3fnQ1o/AAAAAAAAAAI/AAAAAAAAAPU/nxkUeDtLmaU/photo.jpg?sz=128", "display_name": "hellork", "link": "https://stackoverflow.com/users/10501192/hellork"}, "is_accepted": false, "score": 1, "last_activity_date": 1542957489, "last_edit_date": 1542957489, "creation_date": 1542843580, "answer_id": 53421970, "question_id": 53421469, "link": "https://stackoverflow.com/questions/53421469/array-of-structure-pointers/53421970#53421970", "title": "array of structure pointers", "body": "<p>Looks good. Just assign it to something of the same type, <code>struct Country</code>. Also, as pointed out in the comments, it should be malloc num_of_countries * sizeof <code>struct Country</code> (not the pointer type), which is now correctly dereferenced below as sizeof (*countries_array) which also works.</p>\n\n<pre><code>pCountry countries_array;\ncountries_array = malloc(num_of_countries * sizeof (*countries_array));\nstruct Country Jefferson = {\"Jefferson\", 1,2,3 };\ncountries_array[0] = Jefferson;\n\n// don't forget to free the memory when no longer needed.\nfree (countries_array);\n</code></pre>\n\n<p>If we <em>must</em> put a pointer into this array of structs, we can either dereference the pointer like countries_array[0] = *pointer, or... we could declare countries_array as an array of <em>pointers</em>, instead of an array of structs. Perhaps this is what you may want. Either way, the actual structures have to occupy memory somewhere...</p>\n\n<pre><code>pCountry *countries_array = malloc(num_of_countries*sizeof countries_array);\npCountry j = &amp;Jefferson; // `&amp;`, \"address of\" operator\ncountries_array[0] = j; // put a `pointer` into the array...\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9463605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad38dd05a4398d9d2b064b333e5d8017?s=128&d=identicon&r=PG&f=1", "display_name": "kal pola", "link": "https://stackoverflow.com/users/9463605/kal-pola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1542957489, "creation_date": 1542840257, "last_edit_date": 1542846491, "question_id": 53421469, "link": "https://stackoverflow.com/questions/53421469/array-of-structure-pointers", "title": "array of structure pointers", "body": "<p>So I have 3 files: main.c,countries.h and countries.c</p>\n\n<p>I declare pointer of the structure called \"Country\" in the countries.h</p>\n\n<p>I have included the countries.h in countries.c and in main.c</p>\n\n<p>and declared the structure its self in countries.c</p>\n\n<p><strong>countries.h</strong></p>\n\n<pre><code>typedef struct Country* pCountry;\n</code></pre>\n\n<p><strong>countries.c</strong></p>\n\n<pre><code>struct Country {\n    char *name;\n    pCity cities;\n    int numCities;\n    pTerritory countryTerr;\n};\n</code></pre>\n\n<p>now, I want to create array of pointers of the Country structure, using malloc</p>\n\n<p>so I did that:</p>\n\n<pre><code>pCountry countries_array;\ncountries_array = (pCountry); \nmalloc(num_of_countries*sizeof(countries_array));\n</code></pre>\n\n<p>and to assign pointers to each pointer,even though the malloc, does seems to work I cant</p>\n\n<p>assign pointers to the elements in the array using []:</p>\n\n<pre><code>countries_array[0]= new_pointer;\n</code></pre>\n\n<p>I get \"invalid use of undefine struct country\" and \"derefrecing pointer to incomplete\",</p>\n\n<p>what is the problem with the code?</p>\n\n<p>thanks</p>\n"}, {"tags": ["c", "arrays", "pointers", "reverse"], "comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1542839551, "post_id": 53421320, "comment_id": 93717122, "body": "What output do you get?"}, {"owner": {"reputation": 15, "user_id": 10688214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9faad2fa42a0ea16a0994ca72e9f7844?s=128&d=identicon&r=PG&f=1", "display_name": "whohasfriends3", "link": "https://stackoverflow.com/users/10688214/whohasfriends3"}, "edited": false, "score": 0, "creation_date": 1542839559, "post_id": 53421320, "comment_id": 93717124, "body": "Yes i know this, but then why here: <a href=\"https://stackoverflow.com/questions/53420928/c-array-sum-using-pointers\" title=\"c array sum using pointers\">stackoverflow.com/questions/53420928/c-array-sum-using-point&zwnj;&#8203;ers</a> we do p ++ it&#39;s the same ?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1542839664, "post_id": 53421320, "comment_id": 93717163, "body": "If you don&#39;t stop in the middle of the array, you&#39;ll reverse it twice and end up where you started."}, {"owner": {"reputation": 15, "user_id": 10688214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9faad2fa42a0ea16a0994ca72e9f7844?s=128&d=identicon&r=PG&f=1", "display_name": "whohasfriends3", "link": "https://stackoverflow.com/users/10688214/whohasfriends3"}, "edited": false, "score": 0, "creation_date": 1542839778, "post_id": 53421320, "comment_id": 93717196, "body": "How can I stop in the middle of the array please"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1542839798, "post_id": 53421320, "comment_id": 93717202, "body": "pre-decrement <code>end2</code> cos at first it points to invalid data"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1542839924, "post_id": 53421320, "comment_id": 93717247, "body": "You can stop in the middle with <code>q &lt; end2</code> instead of <code>q &lt; end</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2928, "user_id": 5927758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QmcMj.png?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/5927758/mitch"}, "is_accepted": true, "score": 4, "last_activity_date": 1542840103, "last_edit_date": 1542840103, "creation_date": 1542840053, "answer_id": 53421431, "question_id": 53421320, "link": "https://stackoverflow.com/questions/53421320/c-reverse-array-using-pointers/53421431#53421431", "title": "C : reverse array using pointers?", "body": "<p>The issue is with the for loop</p>\n\n<pre><code>void array_reverse(int *begin, int *end)\n{\n    int *end2 = end;\n    int *q = 0;\n    for (q = begin; q &lt; end; q += 1)\n    { \n        swap(q, end2); \n        end2 -= 1;\n    }\n}\n</code></pre>\n\n<p>You must change <code>end</code> to <code>end2</code> in order to stop when you reach the middle \nYou must also decrement end2 before you call swap so you are pointing at the right value</p>\n\n<pre><code>void array_reverse(int *begin, int *end)\n{\n    int *end2 = end;\n    int *q = 0;\n    for (q = begin; q &lt; end2; q += 1)\n    { \n        end2 -= 1;\n        swap(q, end2); \n\n    }\n}\n</code></pre>\n\n<p>The function call would then look something like this </p>\n\n<pre><code>int test[10] = {1,2,3,4,5,6,7,8,9,10};\narray_reverse(test, test + 10);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 194, "user_id": 10501192, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-l4cOz3fnQ1o/AAAAAAAAAAI/AAAAAAAAAPU/nxkUeDtLmaU/photo.jpg?sz=128", "display_name": "hellork", "link": "https://stackoverflow.com/users/10501192/hellork"}, "is_accepted": false, "score": -4, "last_activity_date": 1583381994, "last_edit_date": 1583381994, "creation_date": 1542840364, "answer_id": 53421488, "question_id": 53421320, "link": "https://stackoverflow.com/questions/53421320/c-reverse-array-using-pointers/53421488#53421488", "title": "C : reverse array using pointers?", "body": "<p>Here is another way of writing the loop using <code>while</code>.</p>\n\n<pre><code>void array_reverse(int *first, int *last)\n{\n    int *f = first;\n    int *l = last;\n    while (f &lt; l)\n    { \n        swap(f, l);\n        f++, l--;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 194, "user_id": 10501192, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-l4cOz3fnQ1o/AAAAAAAAAAI/AAAAAAAAAPU/nxkUeDtLmaU/photo.jpg?sz=128", "display_name": "hellork", "link": "https://stackoverflow.com/users/10501192/hellork"}, "is_accepted": false, "score": 0, "last_activity_date": 1542936548, "last_edit_date": 1542936548, "creation_date": 1542935494, "answer_id": 53439597, "question_id": 53421320, "link": "https://stackoverflow.com/questions/53421320/c-reverse-array-using-pointers/53439597#53439597", "title": "C : reverse array using pointers?", "body": "<p>There were two problems. In the <code>for</code> loop, <code>end</code> should have been <code>end2</code>.</p>\n\n<pre><code>for (q = begin; q &lt; end2; q += 1) {\n    swap(q, end2); \n    end2 -= 1; }\n</code></pre>\n\n<p>The other issue was the call. It should have been <code>array_reverse (a, a+9);</code> because <code>array</code> indexes start at <code>0</code>. Giving <code>a+10</code> for the second argument with an <code>array</code> of length 10 passes a pointer to nonsense outside the array bounds.</p>\n\n<p>I must express some appreciation for the question, it got me researching the fundamental difference between \"swapping pointer addresses around\" and swapping the \"data to which the pointers point.</p>\n\n<p>Something else worth noting is that, in C, <em><a href=\"https://stackoverflow.com/questions/2229498/passing-by-reference-in-c?noredirect=1&amp;lq=1\">function arguments are by-value copies</a></em>. We could rewrite <code>array_reverse</code> like this with no adverse consequences. Why does this work?</p>\n\n<pre><code>void array_reverse(int *begin, int *end)\n    for ( ;begin &lt; end; ) swap(begin++, end--)\n</code></pre>\n\n<p>The function body receives <em>local copies</em> of arguments to work on. Hence, there is nothing wrong with modifying their values. It is <em>guaranteed</em> that the function can't modify the initial values of its arguments outside the function without simulating a pass by reference through some form of <a href=\"https://stackoverflow.com/questions/tagged/indirection\">indirection</a>. There is a powerful simplicity to grasping the concept.</p>\n"}], "owner": {"reputation": 15, "user_id": 10688214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9faad2fa42a0ea16a0994ca72e9f7844?s=128&d=identicon&r=PG&f=1", "display_name": "whohasfriends3", "link": "https://stackoverflow.com/users/10688214/whohasfriends3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 1, "accepted_answer_id": 53421431, "answer_count": 3, "score": -1, "last_activity_date": 1583381994, "creation_date": 1542839289, "last_edit_date": 1542839687, "question_id": 53421320, "link": "https://stackoverflow.com/questions/53421320/c-reverse-array-using-pointers", "title": "C : reverse array using pointers?", "body": "<p>I don't see where I have made an error in this code :</p>\n\n<pre><code>void swap(int* a, int* b)\n{\nint temp = *a;\n\n*a = *b;\n*b = temp;\n}\n\nvoid array_reverse(int *begin, int *end)\n{\n    int *end2 = end;\n    int *q = 0;\n    for (q = begin; q &lt; end; q += 1)\n    { \n        swap(q, end2); \n        end2 -= 1;\n    }\n}\n</code></pre>\n\n<p>it should reverse the array:</p>\n\n<pre><code>arr{ 1, 2, 3}\n</code></pre>\n\n<p>becomes:</p>\n\n<pre><code>arr{ 3, 2, 1}\n</code></pre>\n\n<p>My output:</p>\n\n<pre><code>[ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10] \n</code></pre>\n\n<p>becomes :</p>\n\n<pre><code>[111009824,  2,  3,  4,  5,  6,  7,  8,  9, 10]\n</code></pre>\n\n<p>(well actually this first element always changes each time I compile and test my function and gives me random values I guess )</p>\n"}, {"tags": ["c", "arrays", "sum"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 1, "creation_date": 1542836944, "post_id": 53420928, "comment_id": 93716251, "body": "Why do you add <code>arr</code> and <code>p</code>? Just use <code>*p</code>."}, {"owner": {"reputation": 11, "user_id": 10687279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7448019609e074c05683ac36733e730?s=128&d=identicon&r=PG&f=1", "display_name": "cuckcuc", "link": "https://stackoverflow.com/users/10687279/cuckcuc"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1542836975, "post_id": 53420928, "comment_id": 93716261, "body": "So that I can get arr[p] ?"}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1542837009, "post_id": 53420928, "comment_id": 93716272, "body": "This only works if you&#39;re iterating over indicies which you aren&#39;t. You&#39;re iterating over the memory-locations of the array, so <code>p</code> always points to the current number."}, {"owner": {"reputation": 11, "user_id": 10687279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7448019609e074c05683ac36733e730?s=128&d=identicon&r=PG&f=1", "display_name": "cuckcuc", "link": "https://stackoverflow.com/users/10687279/cuckcuc"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1542837046, "post_id": 53420928, "comment_id": 93716290, "body": "I tried using *p and it worked. Please could you explain how ?"}, {"owner": {"reputation": 11, "user_id": 10687279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7448019609e074c05683ac36733e730?s=128&d=identicon&r=PG&f=1", "display_name": "cuckcuc", "link": "https://stackoverflow.com/users/10687279/cuckcuc"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1542837101, "post_id": 53420928, "comment_id": 93716311, "body": "I see. So *p = *(begin + (interation number)) ?"}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 3, "creation_date": 1542837112, "post_id": 53420928, "comment_id": 93716316, "body": "What is <code>arr</code> ?"}, {"owner": {"reputation": 11, "user_id": 10687279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7448019609e074c05683ac36733e730?s=128&d=identicon&r=PG&f=1", "display_name": "cuckcuc", "link": "https://stackoverflow.com/users/10687279/cuckcuc"}, "edited": false, "score": 0, "creation_date": 1542837183, "post_id": 53420928, "comment_id": 93716342, "body": "arr is an array containing 10 elements (from 1 to 10) which is declared before"}, {"owner": {"reputation": 11, "user_id": 10687279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7448019609e074c05683ac36733e730?s=128&d=identicon&r=PG&f=1", "display_name": "cuckcuc", "link": "https://stackoverflow.com/users/10687279/cuckcuc"}, "edited": false, "score": 0, "creation_date": 1542837262, "post_id": 53420928, "comment_id": 93716367, "body": "I dont understand how the loop is incremented. we get at first p = begin (adress number) right ? What does it exactly do at p ++ ? It does p + 1 right ? but adresses of int are of size 4 ???"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 2, "creation_date": 1542837362, "post_id": 53420928, "comment_id": 93716399, "body": "You need to post all the code. How is the function called? What is <code>arr</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "is_accepted": false, "score": 0, "last_activity_date": 1542837816, "last_edit_date": 1542837816, "creation_date": 1542837275, "answer_id": 53420998, "question_id": 53420928, "link": "https://stackoverflow.com/questions/53420928/c-array-sum-using-pointers/53420998#53420998", "title": "C: array sum using pointers", "body": "<pre><code>for (p = begin; p &lt; end; p ++)\n{\n    arraysum += *(arr + p);\n}\n</code></pre>\n\n<p>This doesn't work because you can't add <code>arr</code> and <code>p</code>. You don't need to add anything to <code>p</code>, your number is in <code>*p</code>.</p>\n\n<p>As to why: When you iterate over indicies, i.e. <code>0</code> to <code>arraylength - 1</code>, you always use the <em>begin</em> pointer and add the index to it to find you number. In your loop however, you copy the beginning pointer to <code>p</code> and increment <code>P</code> directly, so <code>p</code> starts at the first number, once incremented points at the second number, and so on, until <code>p</code> and <code>end</code> are the same, note the <code>p &lt; end</code> as condition.</p>\n\n<blockquote>\n  <p>dont understand how the loop is incremented. we get at first p = begin\n  (adress number) right ? What does it exactly do at p ++ ? It does p +\n  1 right ? but adresses of int are of size 4 ???</p>\n</blockquote>\n\n<p>Pointer-Arithmetic makes this possible. Math on pointers works a bit different, essentially making sure that you add/subtract <em>multiples</em> of the objects size. So adding one to your int-pointer actually adds <code>sizeof(int)</code> under the hood. This is also how array-indicies work, <code>array[i]</code> is equivalent to <code>*(array + i)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 10687279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7448019609e074c05683ac36733e730?s=128&d=identicon&r=PG&f=1", "display_name": "cuckcuc", "link": "https://stackoverflow.com/users/10687279/cuckcuc"}, "edited": false, "score": 0, "creation_date": 1542837390, "post_id": 53421001, "comment_id": 93716413, "body": "Ah YES ! I perfectly understand this"}], "tags": [], "owner": {"reputation": 382, "user_id": 2387608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bf202db045fe101dac30b012f760871?s=128&d=identicon&r=PG&f=1", "display_name": "alamit", "link": "https://stackoverflow.com/users/2387608/alamit"}, "is_accepted": true, "score": 0, "last_activity_date": 1542837512, "last_edit_date": 1542837512, "creation_date": 1542837285, "answer_id": 53421001, "question_id": 53420928, "link": "https://stackoverflow.com/questions/53420928/c-array-sum-using-pointers/53421001#53421001", "title": "C: array sum using pointers", "body": "<p>You could do something like this.</p>\n\n<pre><code>int array_sum(int *begin, int *end)\n{\n    int arraysum = 0;\n    while (begin &lt; end)\n    {\n        arraysum += *begin;\n        ++begin;\n    }\n    return arraysum;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10687279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7448019609e074c05683ac36733e730?s=128&d=identicon&r=PG&f=1", "display_name": "cuckcuc", "link": "https://stackoverflow.com/users/10687279/cuckcuc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 1, "closed_date": 1542839011, "accepted_answer_id": 53421001, "answer_count": 2, "score": -1, "last_activity_date": 1542837816, "creation_date": 1542836870, "question_id": 53420928, "link": "https://stackoverflow.com/questions/53420928/c-array-sum-using-pointers", "closed_reason": "Not suitable for this site", "title": "C: array sum using pointers", "body": "<p>How could I get the sum of an array using only pointers ?</p>\n\n<pre><code>int array_sum(int *begin, int *end)\n{\n    int arraysum = 0;\n    int *p = 0;\n    for (p = begin; p &lt; end; p ++)\n    {\n        arraysum += *(arr + p);\n    } \n\n   return arraysum;\n}\n</code></pre>\n\n<p>this doesn't compile at line </p>\n\n<pre><code>arraysum += *(arr + p);\n</code></pre>\n"}, {"tags": ["c", "multithreading"], "comments": [{"owner": {"reputation": 1641, "user_id": 2899030, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0461f0bdd8d4c71f6173ca16996af15b?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/2899030/brian"}, "edited": false, "score": 0, "creation_date": 1542835659, "post_id": 53420666, "comment_id": 93715771, "body": "you might want to look up asynchronous functions"}, {"owner": {"reputation": 404, "user_id": 6028941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fc4c9a4bc47642e168dc2ca24d454a8?s=128&d=identicon&r=PG&f=1", "display_name": "Matt X", "link": "https://stackoverflow.com/users/6028941/matt-x"}, "reply_to_user": {"reputation": 1641, "user_id": 2899030, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0461f0bdd8d4c71f6173ca16996af15b?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/2899030/brian"}, "edited": false, "score": 0, "creation_date": 1542835712, "post_id": 53420666, "comment_id": 93715790, "body": "@Brian no. i dont want an async func here"}], "answers": [{"comments": [{"owner": {"reputation": 404, "user_id": 6028941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fc4c9a4bc47642e168dc2ca24d454a8?s=128&d=identicon&r=PG&f=1", "display_name": "Matt X", "link": "https://stackoverflow.com/users/6028941/matt-x"}, "edited": false, "score": 0, "creation_date": 1542835742, "post_id": 53420693, "comment_id": 93715802, "body": "do I need the <code>pthread_join(thread_id, NULL);</code> line then? @MartinHeraleck&#253;"}, {"owner": {"reputation": 5195, "user_id": 4005175, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/3N6Ze.jpg?s=128&g=1", "display_name": "Martin Heraleck&#253;", "link": "https://stackoverflow.com/users/4005175/martin-heraleck%c3%bd"}, "reply_to_user": {"reputation": 404, "user_id": 6028941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fc4c9a4bc47642e168dc2ca24d454a8?s=128&d=identicon&r=PG&f=1", "display_name": "Matt X", "link": "https://stackoverflow.com/users/6028941/matt-x"}, "edited": false, "score": 0, "creation_date": 1542835905, "post_id": 53420693, "comment_id": 93715861, "body": "@MattX If you don&#39;t put it there, the <i>After Thread</i> message will print immediately after starting the thread, which will keep running."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1542836182, "post_id": 53420693, "comment_id": 93715971, "body": "If you changed the code in <code>myThread</code> to loop 10 times and print something out or sleep and then return, you&#39;d wait for it to finish with the call to <code>pthread_join</code> in main.  And after that your program could exit.  If you just leave <code>myThread</code> as it is and take out the call to <code>pthread_join</code>, your program won&#39;t wait for the thread to finish and exit right away."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 404, "user_id": 6028941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fc4c9a4bc47642e168dc2ca24d454a8?s=128&d=identicon&r=PG&f=1", "display_name": "Matt X", "link": "https://stackoverflow.com/users/6028941/matt-x"}, "edited": false, "score": 0, "creation_date": 1542836380, "post_id": 53420693, "comment_id": 93716047, "body": "@MattX Whether or not you need it depends on exactly what you&#39;re trying to do, which we do not know. What you should do depends on exactly what this thread is doing and how it relates to what the program as a whole is doing."}], "tags": [], "owner": {"reputation": 5195, "user_id": 4005175, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/3N6Ze.jpg?s=128&g=1", "display_name": "Martin Heraleck&#253;", "link": "https://stackoverflow.com/users/4005175/martin-heraleck%c3%bd"}, "is_accepted": true, "score": 2, "last_activity_date": 1542835662, "creation_date": 1542835662, "answer_id": 53420693, "question_id": 53420666, "link": "https://stackoverflow.com/questions/53420666/while-loop-within-thread-is-causing-program-to-block-c/53420693#53420693", "title": "While loop within thread is causing program to block (C)", "body": "<p>Because <code>pthread_join(thread_id, NULL);</code> waits for the thread to finish. And a thread running a <code>while (1) {}</code> loop will never finish.</p>\n"}], "owner": {"reputation": 404, "user_id": 6028941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fc4c9a4bc47642e168dc2ca24d454a8?s=128&d=identicon&r=PG&f=1", "display_name": "Matt X", "link": "https://stackoverflow.com/users/6028941/matt-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 53420693, "answer_count": 1, "score": -2, "last_activity_date": 1542835662, "creation_date": 1542835509, "question_id": 53420666, "link": "https://stackoverflow.com/questions/53420666/while-loop-within-thread-is-causing-program-to-block-c", "title": "While loop within thread is causing program to block (C)", "body": "<p>The point of threads is to be able to run multiple blocks of code at once. The first thing I think of when this possibility comes into my head is having two infinite loops running at once. Before I tried to get this working with two threads, I tried to get it to work with one, with no success.</p>\n\n<p>So I have a thread like this:</p>\n\n<pre><code>void *myThread(void *args) {\n    sleep(0.1);\n    while (1) {\n\n    }\n    return NULL;\n}\n</code></pre>\n\n<p>And I am creating the thread like so:</p>\n\n<pre><code>pthread_t thread_id;\nprintf(\"Before Thread\\n\");\npthread_create(&amp;thread_id, NULL, myThread, args);\npthread_join(thread_id, NULL);\nprintf(\"After Thread\\n\");\n</code></pre>\n\n<p>When I run this, <code>\"After Thread\"</code> does not print! Why is this happening? This makes no sense to me.</p>\n"}, {"tags": ["c", "sockets"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1542837062, "post_id": 53420656, "comment_id": 93716296, "body": "Fyi, your <code>setsockopt</code> call on the server is wrong. The option to set is not a bitmask; <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/setsockopt.html\" rel=\"nofollow noreferrer\">you can only set <b>one</b> option at a time</a>. Fixing that and the slurry of missing headers from the client, and this &quot;works&quot; (term used loosely). And you should run the server first. He&#39;s the one waiting for connections."}, {"owner": {"reputation": 41, "user_id": 10538841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61b2f62de66f475ea5387df03c5fd715?s=128&d=identicon&r=PG&f=1", "display_name": "NeverSleepAlwaysCode", "link": "https://stackoverflow.com/users/10538841/neversleepalwayscode"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1542837541, "post_id": 53420656, "comment_id": 93716464, "body": "how would i fix the <code>setsockopt</code> call?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1542837927, "post_id": 53420656, "comment_id": 93716588, "body": "@NeverSleepAlwaysCode Call <code>setsockopt()</code> multiple times, each with a different option."}, {"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1542842271, "post_id": 53420656, "comment_id": 93717984, "body": "No, you should run the server first. If the server is not running, there is nobody listening to incoming connections, and yes, the connection attempt gets refused."}], "owner": {"reputation": 41, "user_id": 10538841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61b2f62de66f475ea5387df03c5fd715?s=128&d=identicon&r=PG&f=1", "display_name": "NeverSleepAlwaysCode", "link": "https://stackoverflow.com/users/10538841/neversleepalwayscode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 306, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542835440, "creation_date": 1542835440, "question_id": 53420656, "link": "https://stackoverflow.com/questions/53420656/socket-programming-in-c-connection-failed", "title": "Socket programming in c connection failed", "body": "<p>Trying to practice socket programming in c. Been hitting an error of <code>Connection Failed</code>but not sure why. I included both the server and client code. I believe the problem is with <code>connect</code>.\nAlso, i run the client first then run the server. Is that the right way to compile it?</p>\n\n<p>//CLIENT</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;string.h&gt;\n#define PORT 8080\n\nint main(int argc, char const *argv[])\n{\n    struct sockaddr_in address;\n    int sock = 0, valread;\n    struct sockaddr_in serv_addr;\n    char *hello = \"Hello from client\";\n    char buffer[1024] = {0};\n    if ((sock = socket(AF_INET, SOCK_STREAM, 0)) &lt; 0)\n    {\n        printf(\"\\n Socket creation error \\n\");\n        return -1;\n    }\n\n    memset(&amp;serv_addr, '0', sizeof(serv_addr));\n\n    serv_addr.sin_family = AF_INET;\n    serv_addr.sin_port = htons(PORT);\n\n    // Convert IPv4 and IPv6 addresses from text to binary form\n    if(inet_pton(AF_INET, \"127.0.0.1\", &amp;serv_addr.sin_addr)&lt;=0)\n    {\n        printf(\"\\nInvalid address/ Address not supported \\n\");\n        return -1;\n    }\n\n    if (connect(sock, (struct sockaddr *)&amp;serv_addr, sizeof(serv_addr)) &lt; 0)\n    {\n        printf(\"\\nConnection Failed \\n\");\n        return -1;\n    }\n    send(sock , hello , strlen(hello) , 0 );\n    printf(\"Hello message sent\\n\");\n    valread = read( sock , buffer, 1024);\n    printf(\"%s\\n\",buffer );\n    return 0;\n}\n</code></pre>\n\n<p>//SERVER</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;string.h&gt;\n#define PORT 8080\nint main(int argc, char const *argv[])\n{\n    int server_fd, new_socket, valread;\n    struct sockaddr_in address;\n    int opt = 1;\n    int addrlen = sizeof(address);\n    char buffer[1024] = {0};\n    char *hello = \"Hello from server\";\n\n    // Creating socket file descriptor\n    if ((server_fd = socket(AF_INET, SOCK_STREAM, 0)) == 0)\n    {\n        perror(\"socket failed\");\n        exit(EXIT_FAILURE);\n    }\n\n    // Forcefully attaching socket to the port 8080\n    if (setsockopt(server_fd, SOL_SOCKET, SO_REUSEADDR | SO_REUSEPORT,\n                                                  &amp;opt, sizeof(opt)))\n    {\n        perror(\"setsockopt\");\n        exit(EXIT_FAILURE);\n    }\n    address.sin_family = AF_INET;\n    address.sin_addr.s_addr = INADDR_ANY;\n    address.sin_port = htons( PORT );\n\n    // Forcefully attaching socket to the port 8080\n    if (bind(server_fd, (struct sockaddr *)&amp;address,\n                                 sizeof(address))&lt;0)\n    {\n        perror(\"bind failed\");\n        exit(EXIT_FAILURE);\n    }\n    if (listen(server_fd, 3) &lt; 0)\n    {\n        perror(\"listen\");\n        exit(EXIT_FAILURE);\n    }\n    if ((new_socket = accept(server_fd, (struct sockaddr *)&amp;address,\n                       (socklen_t*)&amp;addrlen))&lt;0)\n    {\n        perror(\"accept\");\n        exit(EXIT_FAILURE);\n    }\n    valread = read( new_socket , buffer, 1024);\n    printf(\"%s\\n\",buffer );\n    send(new_socket , hello , strlen(hello) , 0 );\n    printf(\"Hello message sent\\n\");\n    return 0;\n} \n</code></pre>\n"}, {"tags": ["java", "c", "cuda", "gpu", "jcuda"], "comments": [{"owner": {"reputation": 27978, "user_id": 981744, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qJi4S.png?s=128&g=1", "display_name": "Erwin Bolwidt", "link": "https://stackoverflow.com/users/981744/erwin-bolwidt"}, "edited": false, "score": 1, "creation_date": 1542835509, "post_id": 53420617, "comment_id": 93715707, "body": "What&#39;s your sample? What did you expect to come out? What did come out? What debugging did you do - where in the code do you think that the problem is? Looks like the problem could be in the C code, better to tag it with C than with Java then."}, {"owner": {"reputation": 537, "user_id": 4165553, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/726401589/picture?type=large", "display_name": "Aqeel Haider", "link": "https://stackoverflow.com/users/4165553/aqeel-haider"}, "reply_to_user": {"reputation": 27978, "user_id": 981744, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qJi4S.png?s=128&g=1", "display_name": "Erwin Bolwidt", "link": "https://stackoverflow.com/users/981744/erwin-bolwidt"}, "edited": false, "score": 0, "creation_date": 1542835612, "post_id": 53420617, "comment_id": 93715748, "body": "I add the code with the question. Thanks for suggesting to tag with the C code."}, {"owner": {"reputation": 537, "user_id": 4165553, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/726401589/picture?type=large", "display_name": "Aqeel Haider", "link": "https://stackoverflow.com/users/4165553/aqeel-haider"}, "reply_to_user": {"reputation": 27978, "user_id": 981744, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qJi4S.png?s=128&g=1", "display_name": "Erwin Bolwidt", "link": "https://stackoverflow.com/users/981744/erwin-bolwidt"}, "edited": false, "score": 0, "creation_date": 1542835700, "post_id": 53420617, "comment_id": 93715785, "body": "My output with a sample image is:   Skintone Using CPU: 75417 Total Pixel Of CPU: 262144 SKinTone Percentage Using CPU: 29%  Skintone Using GPU: 29269 Total Pixel Of GPU: 262144 SKinTone Percentage Using GPU: 11%  They should be same."}], "answers": [{"tags": [], "owner": {"reputation": 537, "user_id": 4165553, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/726401589/picture?type=large", "display_name": "Aqeel Haider", "link": "https://stackoverflow.com/users/4165553/aqeel-haider"}, "is_accepted": true, "score": 0, "last_activity_date": 1542906963, "creation_date": 1542906963, "answer_id": 53435706, "question_id": 53420617, "link": "https://stackoverflow.com/questions/53420617/calculate-skintone-using-jcuda-is-not-giving-the-right-percentage/53435706#53435706", "title": "Calculate Skintone using JCuda is not giving the right percentage", "body": "<p>I solve the problem by hit and trial method. In the kernel i change the position of r with b, and the problem resolved, also instead of byte i have to send the code in int array in java. </p>\n\n<pre><code>extern \"C\"\n__global__ void skintone(uchar4* data, int w, int h, int* output)\n{\n    int x = threadIdx.x+blockIdx.x*blockDim.x;\n    int y = threadIdx.y+blockIdx.y*blockDim.y;\n\nif (x &lt; w &amp;&amp; y &lt; h)\n{\n    float b, g, r;\n    float cb, cr;\n\n    int index = y*w+x;\n    uchar4 pixel = data[index];\n\n    b = (float)pixel.x;\n    g = (float)pixel.y;\n    r = (float)pixel.z;\n\n    cb = 128 + (-0.169f * r) - (0.331f * g) + (0.5f * b);\n    cr = 128 + (0.5f * r) - (0.419f * g) - (0.081f * b);\n\n\n    if((cb &gt;= 80 &amp;&amp;  cb &lt;= 120) &amp;&amp; (cr &gt;= 133 &amp;&amp;  cr &lt;= 173)) {\n        atomicAdd(&amp;output[0], 1);\n    }\n}\n}\n</code></pre>\n\n<p>Java Code Changes. </p>\n\n<pre><code>public static void calculateSkintoneGPU() throws IOException {\n    BufferedImage img = ImageIO.read(SkinTone.class.getClassLoader().getResource(\"images.jpg\"));\n    if (img == null || img.getData() == null)\n        return;\n\n    int width = img.getWidth(null);\n    int height = img.getHeight(null);\n    int[] pixels = new int[width * height];\n    PixelGrabber pg = new PixelGrabber(img, 0, 0, width, height, pixels, 0, width);\n    try {\n        pg.grabPixels();\n    } catch (InterruptedException e){};\n\n    int totalPixels = width * height;\n\n    CUfunction kernelFunction = initlize();\n\n    int output[] = execute(kernelFunction, pixels, width, height);\n    // Flushing memory\n    img.flush();\n    img = null;\n\n    long skintoneThreshold = Math.round(output[0] / (double) totalPixels * 100.0);\n\n    System.err.println(\"Skintone Using GPU: \" + output[0]);\n    System.err.println(\"Total Pixel Of GPU: \" + totalPixels);\n    System.err.println(\"SKinTone Percentage Using GPU: \" + skintoneThreshold + \"%\");\n}\n</code></pre>\n"}], "owner": {"reputation": 537, "user_id": 4165553, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/726401589/picture?type=large", "display_name": "Aqeel Haider", "link": "https://stackoverflow.com/users/4165553/aqeel-haider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 53435706, "answer_count": 1, "score": -1, "last_activity_date": 1542906963, "creation_date": 1542835191, "last_edit_date": 1542881719, "question_id": 53420617, "link": "https://stackoverflow.com/questions/53420617/calculate-skintone-using-jcuda-is-not-giving-the-right-percentage", "title": "Calculate Skintone using JCuda is not giving the right percentage", "body": "<p>Im calculting skintone of an image in java. </p>\n\n<ol>\n<li>convert the pixel of Image in yCbCR. </li>\n<li>check if image pixel is in specific range, then its a skin color. </li>\n<li>calculate percentage by dividing it by total pixel. </li>\n</ol>\n\n<p>Its working fine in CPU code, but when i convert it to GPU code, The pixel percentage is not coming right. </p>\n\n<p>The confusing part for me was send the pixel data to GPU and get its r, g, b value in GPU. </p>\n\n<p>So i follow <a href=\"https://github.com/jcuda/jcuda-imagej-example/blob/master/src/main/java/JCuda_ImageJ_Example_Plugin.java\" rel=\"nofollow noreferrer\">JCuda Pixel Invert Example</a> example to send pixel data. The difference is the example send pixel data in int[] array and I'm sending it in byte[] array. </p>\n\n<p>Here the code. </p>\n\n<pre><code>import static jcuda.driver.JCudaDriver.cuCtxCreate;\nimport static jcuda.driver.JCudaDriver.cuCtxSynchronize;\nimport static jcuda.driver.JCudaDriver.cuDeviceGet;\nimport static jcuda.driver.JCudaDriver.cuInit;\nimport static jcuda.driver.JCudaDriver.cuLaunchKernel;\nimport static jcuda.driver.JCudaDriver.cuMemAlloc;\nimport static jcuda.driver.JCudaDriver.cuMemFree;\nimport static jcuda.driver.JCudaDriver.cuMemcpyDtoH;\nimport static jcuda.driver.JCudaDriver.cuMemcpyHtoD;\n\nimport java.awt.image.BufferedImage;\nimport java.awt.image.DataBuffer;\nimport java.awt.image.DataBufferByte;\nimport java.awt.image.Raster;\nimport java.io.File;\nimport java.io.IOException;\n\nimport javax.imageio.ImageIO;\n\nimport ij.IJ;\nimport jcuda.Pointer;\nimport jcuda.Sizeof;\nimport jcuda.driver.CUcontext;\nimport jcuda.driver.CUdevice;\nimport jcuda.driver.CUdeviceptr;\nimport jcuda.driver.CUfunction;\nimport jcuda.driver.JCudaDriver;\nimport jcuda.nvrtc.JNvrtc;\n\npublic class SkinTone {\n\npublic static void CalculateSKintoneGPU(File file) throws IOException {\n    BufferedImage bufferedImage = ImageIO.read(file);\n    if (bufferedImage == null || bufferedImage.getData() == null)\n        return;\n    Raster raster = bufferedImage.getData();\n\n    DataBuffer dataBuffer = raster.getDataBuffer();\n    DataBufferByte dataBufferInt = (DataBufferByte)dataBuffer;\n    byte[] pixels =  dataBufferInt.getData();\n\n    int totalPixels = raster.getHeight() * raster.getWidth();\n\n    CUfunction kernelFunction = initlize();\n\n    int output[] = execute(kernelFunction, pixels, raster.getWidth(), raster.getHeight());\n    // Flushing memory\n    raster = null;\n    bufferedImage.flush();\n    bufferedImage = null;\n\n    long skintoneThreshold = Math.round(output[0] / (double) totalPixels * 100.0);\n\n    System.err.println(\"Skintone Using GPU: \" + output[0]);\n    System.err.println(\"Total Pixel Of GPU: \" + totalPixels);\n    System.err.println(\"SKinTone Percentage Using GPU: \" + skintoneThreshold + \"%\");\n}\n\nstatic int[] execute(CUfunction kernelFunction, byte[] pixels, int w, int h) {\n    // Allocate memory on the device, and copy the host data to the device\n    int size = w * h * Sizeof.BYTE;\n    CUdeviceptr pointer = new CUdeviceptr();\n    cuMemAlloc(pointer, size);\n    cuMemcpyHtoD(pointer, Pointer.to(pixels), size);\n\n    int numElements = 9;\n    int s = 0;\n    // Allocate device output memory\n    CUdeviceptr deviceOutput = new CUdeviceptr();\n    cuMemAlloc(deviceOutput, numElements * Sizeof.INT);\n\n    // Set up the kernel parameters: A pointer to an array\n    // of pointers which point to the actual values.\n    Pointer kernelParameters = Pointer.to(Pointer.to(pointer), Pointer.to(new int[] { w }),\n            Pointer.to(new int[] { h }), Pointer.to(deviceOutput));\n\n    // Call the kernel function\n    int blockSize = 16;\n    int gridSize = (Math.max(w, h) + blockSize - 1) / blockSize;\n    cuLaunchKernel(kernelFunction, gridSize, gridSize, 1, // Grid dimension\n            blockSize, blockSize, 1, // Block dimension\n            0, null, // Shared memory size and stream\n            kernelParameters, null // Kernel- and extra parameters\n    );\n    cuCtxSynchronize();\n\n    // Allocate host output memory and copy the device output\n    // to the host.\n    int hostOutput[] = new int[numElements];\n    cuMemcpyDtoH(Pointer.to(hostOutput), deviceOutput, numElements * Sizeof.INT);\n\n    // Clean up.\n    cuMemFree(deviceOutput);\n    cuMemFree(pointer);\n\n    return hostOutput;\n}\n\npublic static CUfunction initlize() {\n\n    // Enable exceptions and omit all subsequent error checks\n    JCudaDriver.setExceptionsEnabled(true);\n    JNvrtc.setExceptionsEnabled(true);\n\n    // Initialize the driver and create a context for the first device.\n    cuInit(0);\n    CUdevice device = new CUdevice();\n    cuDeviceGet(device, 0);\n    CUcontext context = new CUcontext();\n    cuCtxCreate(context, 0, device);\n\n    // Obtain the CUDA source code from the CUDA file\n    String cuFileName = \"Skintone.cu\";\n    String sourceCode = CudaUtils.readResourceAsString(cuFileName);\n    if (sourceCode == null) {\n        IJ.showMessage(\"Error\", \"Could not read the kernel source code\");\n    }\n\n    // Create the kernel function\n    return CudaUtils.createFunction(sourceCode, \"skintone\");\n}\n\npublic static void CalculateSKintoneCPU(File file) throws IOException {\n    BufferedImage bufferedImage = ImageIO.read(file);\n    if (bufferedImage == null || bufferedImage.getData() == null)\n        return;\n    Raster raster = bufferedImage.getData();\n    float[] rgb = new float[4];\n    int totalPixels = raster.getHeight() * raster.getWidth();\n\n    int skinTonePixels = 0;\n\n    for (int x = 0; x &lt; raster.getWidth(); x++) {\n        for (int y = 0; y &lt; raster.getHeight(); y++) {\n            raster.getPixel(x, y, rgb);\n            if (skintone(rgb)) {\n                skinTonePixels++;\n            }\n        }\n    }\n\n    // Flushing memory\n    raster = null;\n    rgb = null;\n    bufferedImage.flush();\n    bufferedImage = null;\n\n    long skintoneThreshold = Math.round(skinTonePixels / (double) totalPixels * 100.0);\n\n    System.err.println(\"Skintone Using CPU: \" + skinTonePixels);\n    System.err.println(\"Total Pixel Of CPU: \" + totalPixels);\n    System.err.println(\"SKinTone Percentage Using CPU: \" + skintoneThreshold + \"%\");\n}\n\nprivate static boolean skintone(float[] rgb) {\n    float yCbCr[] = (float[]) convertRGBtoYUV(rgb);\n    if ((yCbCr[1] &gt;= 80 &amp;&amp; yCbCr[1] &lt;= 120) &amp;&amp; (yCbCr[2] &gt;= 133 &amp;&amp; yCbCr[2] &lt;= 173)) {\n        return true;\n    }\n    return false;\n}\n\nprivate static float[] convertRGBtoYUV(float[] rgb) {\n    final float[] yCbCr = new float[3];\n    float r = rgb[0];\n    float g = rgb[1];\n    float b = rgb[2];\n\n    yCbCr[0] = 16 + (0.299f * r) + (0.587f * g) + (0.144f * b);\n    yCbCr[1] = 128 + (-0.169f * r) - (0.331f * g) + (0.5f * b);\n    yCbCr[2] = 128 + (0.5f * r) - (0.419f * g) - (0.081f * b);\n\n    return yCbCr;\n}\n\npublic static void main(String[] args) throws IOException {\n    File file = new File(\"C:\\\\Users\\\\Aqeel\\\\git\\\\jcuda-imagej-example\\\\src\\\\test\\\\resources\\\\lena512color.png\");\n    CalculateSKintoneCPU(file);\n    CalculateSKintoneGPU(file);\n}\n</code></pre>\n\n<p>}</p>\n\n<p>Kernal File</p>\n\n<pre><code>    extern \"C\"\n__global__ void skintone(uchar4* data, int w, int h, int* output)\n{\n    int x = threadIdx.x+blockIdx.x*blockDim.x;\n    int y = threadIdx.y+blockIdx.y*blockDim.y;\n\nif (x &lt; w &amp;&amp; y &lt; h)\n{\n    float r, g, b;\n    float cb, cr;\n\n    int index = y*w+x;\n    uchar4 pixel = data[index];\n\n    r = pixel.x;\n    g = pixel.y;\n    b = pixel.z;\n\n    cb = 128 + (-0.169f * r) - (0.331f * g) + (0.5f * b);\n    cr = 128 + (0.5f * r) - (0.419f * g) - (0.081f * b);\n\n\n    if((cb &gt;= 80 &amp;&amp;  cb &lt;= 120) &amp;&amp; (cr &gt;= 133 &amp;&amp;  cr &lt;= 173)) {\n        atomicAdd(&amp;output[0], 1);\n    }\n}\n}\n</code></pre>\n\n<p><a href=\"https://drive.google.com/open?id=1PDd0Vva0R-HtwkWrnVQ_cKIVQImh4aFk\" rel=\"nofollow noreferrer\">Complete Example src, Machine Need Nvida Card, Cuda Toolkit V9 and Graphics Drivers</a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 2, "creation_date": 1542835244, "post_id": 53420606, "comment_id": 93715600, "body": "You should check the <code>return</code> value of <code>write</code> for an error."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1542835456, "post_id": 53420606, "comment_id": 93715687, "body": "1 is for standard output descriptor, 2 is for error. Others aren&#39;t open"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1542835865, "post_id": 53420606, "comment_id": 93715841, "body": "note that the <code>fork</code> part is irrelevant to the question. The example could be reduced even more to only include a <code>write</code> call."}], "answers": [{"tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 1, "last_activity_date": 1542835824, "last_edit_date": 1542835824, "creation_date": 1542835514, "answer_id": 53420668, "question_id": 53420606, "link": "https://stackoverflow.com/questions/53420606/passing-integers-in-place-of-file-descriptor-when-calling-write-command-in-c/53420668#53420668", "title": "passing integers in place of file descriptor when calling write command in c", "body": "<p>you're performing a raw <code>write</code> call where at the start of your program:</p>\n\n<ul>\n<li>1 is the standard output descriptor</li>\n<li>2 is the standard error descriptor</li>\n</ul>\n\n<p>Both write to the console by default (and 0 is the standard input, cannot be written to)</p>\n\n<p>Other descriptors are invalid unless they've been returned by an <code>open</code> call. Since you don't check the return value of <code>write</code>, you can't see that an error code is returned (probably <code>EBADF</code>, bad file descriptor)</p>\n"}], "owner": {"reputation": 5, "user_id": 9464365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c9e100d64920f89e4ce67df59c48d00?s=128&d=identicon&r=PG&f=1", "display_name": "Ashray Sinha", "link": "https://stackoverflow.com/users/9464365/ashray-sinha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 53420668, "answer_count": 1, "score": 0, "last_activity_date": 1542835824, "creation_date": 1542835143, "last_edit_date": 1542835356, "question_id": 53420606, "link": "https://stackoverflow.com/questions/53420606/passing-integers-in-place-of-file-descriptor-when-calling-write-command-in-c", "title": "passing integers in place of file descriptor when calling write command in c", "body": "<pre><code>void main()\n{\n\n     pid_t  pid;\n     int    i;\n     char   buf[BUF_SIZE];\n     fork();\n     pid = getpid();\n     for (i = 1; i &lt;= MAX_COUNT; i++) {\n          sprintf(buf, \"This line is from pid %d, value = %d\\n\", pid, i);\n          write(1, buf, strlen(buf));\n        // printf(\"%s\",buf);\n     }\n}\n</code></pre>\n\n<p>I've got the given simple code to show fork process in c. I noticed that when I pass any value greater than 2 in place of 1 in write command the code does not print anything. Why is this happening?</p>\n"}, {"tags": ["mysql", "c", "database", "real-time-data"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 9357817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04fe4fcad92eaff612c8ce3ff8862d79?s=128&d=identicon&r=PG&f=1", "display_name": "Vikas M", "link": "https://stackoverflow.com/users/9357817/vikas-m"}, "edited": false, "score": 0, "creation_date": 1542847966, "post_id": 53421619, "comment_id": 93719445, "body": "Thank you for the advice. I looked up RabbitMQ and couldn&#39;t find examples for MySQL. Do you mind posting how I could set up the message queuing process?"}, {"owner": {"reputation": 7007, "user_id": 10195153, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VnLka.jpg?s=128&g=1", "display_name": "danblack", "link": "https://stackoverflow.com/users/10195153/danblack"}, "reply_to_user": {"reputation": 51, "user_id": 9357817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04fe4fcad92eaff612c8ce3ff8862d79?s=128&d=identicon&r=PG&f=1", "display_name": "Vikas M", "link": "https://stackoverflow.com/users/9357817/vikas-m"}, "edited": false, "score": 2, "creation_date": 1542848699, "post_id": 53421619, "comment_id": 93719585, "body": "When the application that logs to the table inserts the MySQL row, it also inserts the PK (auto increment id if you don&#39;t have one), in a configured queue.  The your application as a consumer, fetchs the PK off the queue. Start with a basic hello world example: <a href=\"https://www.rabbitmq.com/getstarted.html\" rel=\"nofollow noreferrer\">rabbitmq.com/getstarted.html</a>"}, {"owner": {"reputation": 51, "user_id": 9357817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04fe4fcad92eaff612c8ce3ff8862d79?s=128&d=identicon&r=PG&f=1", "display_name": "Vikas M", "link": "https://stackoverflow.com/users/9357817/vikas-m"}, "edited": false, "score": 0, "creation_date": 1542849299, "post_id": 53421619, "comment_id": 93719683, "body": "Ah. Thank you so much."}], "tags": [], "owner": {"reputation": 7007, "user_id": 10195153, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VnLka.jpg?s=128&g=1", "display_name": "danblack", "link": "https://stackoverflow.com/users/10195153/danblack"}, "is_accepted": true, "score": 1, "last_activity_date": 1542841080, "creation_date": 1542841080, "answer_id": 53421619, "question_id": 53420450, "link": "https://stackoverflow.com/questions/53420450/how-to-receive-any-changes-in-mysql-database-in-real-time-from-client-code-in-a/53421619#53421619", "title": "How to receive any changes in MySQL database in real time from client code in a timed function?", "body": "<p>You should be using a message queue like RabbitMQ for this sort of application. Message queues have an API associated with fetching from the top of a queue. Even if you store the main data in MySQL, you can use the message queue for the primary key. With this choice of suited infrastructure your application doesn't need to preserve state.</p>\n"}], "owner": {"reputation": 51, "user_id": 9357817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04fe4fcad92eaff612c8ce3ff8862d79?s=128&d=identicon&r=PG&f=1", "display_name": "Vikas M", "link": "https://stackoverflow.com/users/9357817/vikas-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2317, "favorite_count": 0, "accepted_answer_id": 53421619, "answer_count": 1, "score": 1, "last_activity_date": 1542841080, "creation_date": 1542834234, "question_id": 53420450, "link": "https://stackoverflow.com/questions/53420450/how-to-receive-any-changes-in-mysql-database-in-real-time-from-client-code-in-a", "title": "How to receive any changes in MySQL database in real time from client code in a timed function?", "body": "<p>I have a database with a log record table which looks like this:</p>\n\n<pre><code>+-----------+------------------------+--------+\n| Timestamp | Symbol_name            | Status |\n+-----------+------------------------+--------+\n|         1 | Group2                 |      1 |\n|         2 | Group1-Device3-Signal1 |      1 |\n|         3 | Group2-Device1-Signa13 |      0 |\n+-----------+------------------------+--------+\n</code></pre>\n\n<p>Where <code>Timestamp</code> is a <code>double</code>, <code>Symbol_name</code> is a <code>varchar</code>, and <code>Status</code> is an <code>int</code>.</p>\n\n<p>Log records which contain the above data are going to be inserted into the table in real time, and my client code is supposed to query those records and analyze them. The problem I am having right now is reading a unique record each query. Currently, I have this function:</p>\n\n<pre><code>/* Called every 1000 ms (1 second). */\ngboolean app_models_timed_query(gpointer data) {\n    FwApp *app = data;\n\n    char query[APP_MAXIMUM_STRING_CHARS];\n\n    strncpy(query, \"SELECT * FROM \", APP_MAXIMUM_STRING_CHARS);\n    strncat(query, app-&gt;query_db_table_name, APP_MAXIMUM_STRING_CHARS);\n    strncat(query, \" WHERE Timestamp &lt;&gt; @lastSeenTimestamp AND Symbol_name &lt;&gt; @lastSeenSymbolName AND Status &lt;&gt; @lastSeenStatus;\", APP_MAXIMUM_STRING_CHARS);\n\n    if (mysql_query(app-&gt;query_db_con, query))\n    {\n        printf(\"Unable to retrieve data from query table.\\n\");\n        return TRUE;\n    }\n\n    MYSQL_RES *result = mysql_store_result(app-&gt;query_db_con);\n\n    if (result == NULL) return TRUE;\n\n    /* Analyze the resulting row(s) here. */\n\n    /* How to set @lastSeenTimestamp, @lastSeenSymbolName and @lastSeenStatus here? */\n\n    return TRUE;\n}\n</code></pre>\n\n<p>The function gets called every second, and in it, I query the database using the following statement:</p>\n\n<pre><code>SELECT * FROM table1 WHERE Timestamp &lt;&gt; @lastSeenTimestamp AND Symbol_name &lt;&gt; @lastSeenSymbolName AND Status &lt;&gt; @lastSeenStatus;\n</code></pre>\n\n<p>No two records will ever be exactly the same, but they can have the same timestamp, status, or symbol name.</p>\n\n<p>Note that before I enable <code>app_models_timed_query</code> to be called each second, I set the user-defined variables like so:</p>\n\n<pre><code>SET @lastSeenTimestamp = -1, @lastSeenSymbolName = '', @lastSeenStatus = 0;\n</code></pre>\n\n<p>And since timestamps will never be negative, the first time <code>app_models_timed_query</code> is called, the first row will be in the result of the query.</p>\n\n<p>However, my question is how to set the user-defined variables to the last row of the result of my query. Also, I want to know if there is a better way of reading only newly inserted rows each time <code>app_models_timed_query</code> is called.</p>\n\n<p>Many thanks,\nVikas</p>\n"}, {"tags": ["c", "string", "printf", "string-formatting"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 3, "creation_date": 1542831422, "post_id": 53419825, "comment_id": 93713965, "body": "<code>0x7ffffffe</code> is most likely not <code>INT_MAX</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 6, "creation_date": 1542831560, "post_id": 53419825, "comment_id": 93714032, "body": "Please include a <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a> that shows the problem . The exact code you used is important"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1542831585, "post_id": 53419825, "comment_id": 93714043, "body": "INT_MAX is probably <code>0x7fffffff</code> on compiler with 32 bt integers"}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1542832186, "post_id": 53419825, "comment_id": 93714282, "body": "In addition to the code for the MVCE @M.M asks for you should indicate what platform you&#39;re running the test on and the compiler toolchain you&#39;re using."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1542832607, "post_id": 53419825, "comment_id": 93714460, "body": "Are you asking specifically about the width value provided to a print format conversion specifier?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1542832856, "post_id": 53419825, "comment_id": 93714576, "body": "probably implementation dependent. Do you really want to print 1&lt;&lt;31 spaces on screen?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1542833960, "post_id": 53419825, "comment_id": 93715053, "body": "@Jean-Fran&#231;oisFabre <code>1 &lt;&lt; 31</code> is undefined behaviour (if int is 32-bit) so your comment is appropriate :D"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1542836933, "post_id": 53419825, "comment_id": 93716246, "body": "<code>%D</code> is a non-standard conversion specification."}, {"owner": {"reputation": 55, "user_id": 10448702, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-entwEGcoqPE/AAAAAAAAAAI/AAAAAAAABi4/-pcKKcFw6Qc/photo.jpg?sz=128", "display_name": "Eyosias Negash", "link": "https://stackoverflow.com/users/10448702/eyosias-negash"}, "edited": false, "score": 0, "creation_date": 1542840266, "post_id": 53419825, "comment_id": 93717340, "body": "%D was an error i meant %d. Also i am redirecting stdout to a file"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1542843417, "post_id": 53419825, "comment_id": 93718356, "body": "The program that&#39;s now in the question causes undefined behaviour since there are specifiers without corresponding arguments"}, {"owner": {"reputation": 55, "user_id": 10448702, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-entwEGcoqPE/AAAAAAAAAAI/AAAAAAAABi4/-pcKKcFw6Qc/photo.jpg?sz=128", "display_name": "Eyosias Negash", "link": "https://stackoverflow.com/users/10448702/eyosias-negash"}, "edited": false, "score": 0, "creation_date": 1542902382, "post_id": 53419825, "comment_id": 93742886, "body": "Even if i give the arguments in the code still the behavior persists it is not the lack of string format arguments that is causing this."}], "answers": [{"comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1542835896, "post_id": 53420207, "comment_id": 93715852, "body": "From your quote of the standard, I would expect <code>&quot;%4095p&quot;</code> to print out the value of the pointer padded out to 4095 bytes. Your statement <i>you are not guaranteed that anything else will get converted for that format specifier</i> seems to imply the pointer value might not get printed."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1542836553, "post_id": 53420207, "comment_id": 93716109, "body": "Upvoted, but using any value greater than 4095 results in undefined behavior. So, all bets are off in terms of what <code>printf</code> will do."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1542842629, "post_id": 53420207, "comment_id": 93718110, "body": "@jxh using a value greater than 4095 does not result in undefined behaviour. The environmental limits pertain to whether an implementation is conforming or not; they are not conditions on a program"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1542844486, "post_id": 53420207, "comment_id": 93718645, "body": "@M.M What is a conforming implementation to do with a program that attempts to emit more than the environmental limits allow?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1542844815, "post_id": 53420207, "comment_id": 93718735, "body": "@jxh the standard is not completely clear but my interpretation is that <code>fprintf</code> should return a negative error code if it could not correctly perform the output due to an environmental limit.  Some of the other library environmental limits do specify what happens if the limit is exceeded (e.g. <code>setjmp</code> specifically says that it is UB to exceed the limit).  It certainly does not use wording like &quot;a program shall not request a conversion that would produce more than 4095&quot;"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1542846045, "post_id": 53420207, "comment_id": 93719064, "body": "@M.M: I had always operated under the assumption that if the standard had defined behavior for the acceptable input, and did not define behavior for unacceptable input, the behavior for processing unacceptable input was undefined. Are you saying that violation of environmental limits does not constitute unacceptable input? Or is it that the program is conforming so long as there is a single conforming implementation that accepts it? Hmmm..."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1542846372, "post_id": 53420207, "comment_id": 93719128, "body": "@jxh yes. The definition of the behaviour of field width modifier doesn&#39;t have any limitation on the value of the modifier. The environmental limits pertain to the implementation, not the program.  A program that exceeds this limit is not <i>strictly conforming</i> but that doesn&#39;t mean it causes UB"}], "tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 8, "last_activity_date": 1542836161, "last_edit_date": 1542836161, "creation_date": 1542833076, "answer_id": 53420207, "question_id": 53419825, "link": "https://stackoverflow.com/questions/53419825/maximum-characters-printable-by-printf-in-c/53420207#53420207", "title": "Maximum characters printable by printf in C", "body": "<p>If you are asking specifically about the maximum width specifier, according to the <strong><a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1548.pdf\" rel=\"nofollow noreferrer\">C Standard</a>, &sect;7.21.6.1.15</strong> (which describes <code>fprintf</code>; <code>printf</code> is described later as a specific case of <code>fprintf</code>):</p>\n\n<blockquote>\n  <p>The number of characters that can be produced by any single conversion shall be at least\n  4095.</p>\n</blockquote>\n\n<p>This means that if, as you report, the maximum width that your C implementation's <code>printf</code> can handle for a format specifier before it stops working as expected is 0x7fffffe2, this is acceptable, since that satisfies the requirement of at least 4095 characters.</p>\n\n<p>As for the remainder of the string not being printed out, without an MCVE, I would hazard a guess at it being a side effect of having such nonsensical width values earlier in the string. Also, <code>%D</code> is not a valid format specifier.</p>\n"}], "owner": {"reputation": 55, "user_id": 10448702, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-entwEGcoqPE/AAAAAAAAAAI/AAAAAAAABi4/-pcKKcFw6Qc/photo.jpg?sz=128", "display_name": "Eyosias Negash", "link": "https://stackoverflow.com/users/10448702/eyosias-negash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 815, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1542842159, "creation_date": 1542831257, "last_edit_date": 1542842159, "question_id": 53419825, "link": "https://stackoverflow.com/questions/53419825/maximum-characters-printable-by-printf-in-c", "title": "Maximum characters printable by printf in C", "body": "<p>In C's printf function in using this gigantic string formatter width sub-specifier; close to the standard's limit a positive signed int; which is provided below the rest of the string formats are ignored.</p>\n\n<p>Example String format:</p>\n\n<pre><code>printf(\"**%2147483614p %1073739618p This text and %d formatters are ignored!!! why**\", &amp;i, &amp;j, 10);\n</code></pre>\n\n<p>output:\n**<code>2147483614 empty spaces</code>0xbf****** <code>1073739618 empty spaces</code></p>\n\n<p>Problem:</p>\n\n<p>The text \"**This text and 10 formatters are ignored!!! why****\" and the integer 10 does not show up on screen.\nIt prints the full of the first %p with its padding and the padding created by the width specifier for the second %p but no pointer and rest of string to be printed.</p>\n\n<p>Note: the second pointer can be made to be printed by left adjusting the format specifier like</p>\n\n<p><strong>printf(\"</strong>%-2147483614p %-1073739618p This text and %d formatters are ignored!!! why**\", &amp;i, &amp;j, 10);** </p>\n\n<p>but still the strings after are still missing.</p>\n\n<p>The code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char const *argv[]){\n    printf(argv[1]);\n    return 0;\n}\n</code></pre>\n\n<p>x86_64-linux-gnu\ngcc version 7.3.0</p>\n\n<p>gcc printf.c -o printf</p>\n\n<p>./printf \"<strong>%-2147483614p %-1073739618p This text and %d formatters are ignored!!! why</strong>\"</p>\n\n<p>P.S. I am aware this is a memory leak</p>\n\n<hr>\n\n<p>Found out %29p (29 is the max, 30 would not print) for second pointer prints the rest of the string. but if there is another format sting in the rest of the string it stops there.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 3, "creation_date": 1542831431, "post_id": 53419824, "comment_id": 93713970, "body": "You have to use logical operators like <code>&amp;&amp;</code> (and) or <code>||</code> (or) instead of the comma operator in the conditions of your <code>if</code>-statements."}, {"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1542831493, "post_id": 53419824, "comment_id": 93713998, "body": "What would be the acted upon condition in <code>if (in1 == word[0], in2 == word[8])</code>? <code>in2 == word[8]</code> only?"}, {"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1542831535, "post_id": 53419824, "comment_id": 93714018, "body": "@Swordfish Your comment should be an answer."}, {"owner": {"reputation": 13, "user_id": 10617591, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mhPp.jpg?s=128&g=1", "display_name": "3D0N", "link": "https://stackoverflow.com/users/10617591/3d0n"}, "edited": false, "score": 0, "creation_date": 1542831739, "post_id": 53419824, "comment_id": 93714114, "body": "i&#39;m a total beginner so i was just trying my hands on it"}, {"owner": {"reputation": 13, "user_id": 10617591, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mhPp.jpg?s=128&g=1", "display_name": "3D0N", "link": "https://stackoverflow.com/users/10617591/3d0n"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542831839, "post_id": 53419824, "comment_id": 93714156, "body": "@Swordfish thanks, but I would be much happier if I get a sample code of it"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1542832164, "post_id": 53419824, "comment_id": 93714275, "body": "Sorry, but you cannot write code at random trying to guess the syntax until it compiles. the commas aren&#39;t doing what you expect"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1542832223, "post_id": 53419824, "comment_id": 93714296, "body": "I&#39;m tempted to close as dupe of <a href=\"https://stackoverflow.com/questions/52550/what-does-the-comma-operator-do\" title=\"what does the comma operator do\">stackoverflow.com/questions/52550/&hellip;</a>"}, {"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1542832418, "post_id": 53419824, "comment_id": 93714381, "body": "It isn&#39;t necessary to define this: <code>char word[] = &quot;fantastic&quot;;</code>. Instead of <code>word[0]</code> and <code>word[8]</code> you can use <code>&#39;f&#39;</code> and <code>&#39;c&#39;</code>."}, {"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542832460, "post_id": 53419824, "comment_id": 93714397, "body": "@Swordfish Thanks for clearing that up."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1542832724, "post_id": 53419824, "comment_id": 93714518, "body": "worse than a dupe: a &quot;fix my code&quot; question. or composite duplicate. Since the scanf issue is also a well known dupe"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1542832756, "post_id": 53419824, "comment_id": 93714534, "body": "@Jean-Fran&#231;oisFabre haha, agreed."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1542832791, "post_id": 53419824, "comment_id": 93714551, "body": "but I&#39;ve always answered stuff like this in the C section when I was &quot;younger&quot;. So..."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10617591, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mhPp.jpg?s=128&g=1", "display_name": "3D0N", "link": "https://stackoverflow.com/users/10617591/3d0n"}, "edited": false, "score": 0, "creation_date": 1542833482, "post_id": 53420025, "comment_id": 93714831, "body": "thanks so much, I&#39;ve tried all your comments and I think its working..."}], "tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": false, "score": 3, "last_activity_date": 1542833512, "last_edit_date": 1542833512, "creation_date": 1542832158, "answer_id": 53420025, "question_id": 53419824, "link": "https://stackoverflow.com/questions/53419824/comparing-characters-to-strings/53420025#53420025", "title": "Comparing Characters to Strings", "body": "<blockquote>\n  <p>code I tried which doesn't allow me to enter the second character</p>\n</blockquote>\n\n<p>After</p>\n\n<pre><code>scanf(\"%c\", &amp;in1);\n</code></pre>\n\n<p>The newline (<code>'\\n'</code>) you entered after the character is still in the input buffer and will get consumed by</p>\n\n<pre><code>scanf(\"%c\", &amp;in2);\n</code></pre>\n\n<p>so you have no opportunity to enter another one. You can change both to</p>\n\n<pre><code>scanf(\" %c\" // ...\n//     ^\n</code></pre>\n\n<p>to skip leading whitespace.</p>\n\n<p><br /></p>\n\n<blockquote>\n  <p>also gets the answer wrong</p>\n</blockquote>\n\n<p>The next problems are with your <code>if</code>-statements: If you use the comma-operator between the tests for equality, the result for the whole expression will only be the rightmost subexpression:</p>\n\n<pre><code>in1 == word[0], in2 == word[8]\n</code></pre>\n\n<p>evaluates to <code>in2 == word[8]</code>. The part before the comma has no effect on it.</p>\n\n<p>When you have two boolean expressions like tests for equality you have to link them with a logical <em>and</em> (<code>&amp;&amp;</code>) to make the whole expression true when both sides of <code>&amp;&amp;</code> are true:</p>\n\n<pre><code>in1 == word[0] &amp;&amp; in2 == word[8]\n</code></pre>\n\n<p>Similarly you should use a logical <em>or</em> (<code>||</code>) if you want the whole expression be true when at least one side of <code>||</code> is true.</p>\n\n<p>So your code should look like that:</p>\n\n<pre><code>if (in1 == word[0] &amp;&amp; in2 == word[8]) {\n    printf(\"\\nWell Done!\\n\");\n}\nelse if (in1 == word[0] &amp;&amp; in2 != word[8] || in1 != word[0] &amp;&amp; in2 == word[8]) {\n    printf(\"\\nOne of your answers is incorrect!\\n\");\n}\nelse {\n    printf(\"\\nTry again next time!\\n\");\n}\n</code></pre>\n\n<p>As suggested by <a href=\"https://stackoverflow.com/users/2993960/fiddling-bits\">Fiddling Bits</a> you don't have to define an array for the word if you have no other use for it other than checking for two letters:</p>\n\n<pre><code>char const first = 'f';\nchar const last  = 'c';\n\nif (in1 == first &amp;&amp; in2 == last) {\n    printf(\"\\nWell Done!\\n\");\n}\nelse if (in1 == first &amp;&amp; in2 != last || in1 != first &amp;&amp; in2 == last) {\n    printf(\"\\nOne of your answers is incorrect!\\n\");\n}\nelse printf(\"\\nTry again next time!\\n\");\n</code></pre>\n\n<p>Less comparisons and logic is needed if you swap the order:</p>\n\n<pre><code>if (in1 == first &amp;&amp; in2 == last) {  // both correct\n    printf(\"\\nWell Done!\\n\");\n}\nelse if (in1 != first &amp;&amp; in2 != last) {  // both wrong\n    printf(\"\\nTry again next time!\\n\");\n}\nelse printf(\"\\nOne of your answers is incorrect!\\n\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 10617591, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mhPp.jpg?s=128&g=1", "display_name": "3D0N", "link": "https://stackoverflow.com/users/10617591/3d0n"}, "is_accepted": false, "score": 0, "last_activity_date": 1542833843, "creation_date": 1542833843, "answer_id": 53420372, "question_id": 53419824, "link": "https://stackoverflow.com/questions/53419824/comparing-characters-to-strings/53420372#53420372", "title": "Comparing Characters to Strings", "body": "<p>I tried your suggestions and it's working out\nThanks so much.....\nBelow is the final code which is working:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\nchar word[] = \"fantastic\";\nchar in1, in2;\nprintf(\"Please enter the first letter of the word \\'fantastic\\':\");\nscanf(\" %c\", &amp;in1);\nprintf(\"Please enter the last letter of the word \\'fantastic\\':\");\nscanf(\" %c\", &amp;in2);\nif (in1 == word[0] &amp;&amp; in2 == word[8]) {\nprintf(\"\\nWell Done!\\n\");\n}\nelse if (in1 == word[0] &amp;&amp; in2 != word[8] || in1 != word[0] &amp;&amp; in2 == word[8]) {\nprintf(\"\\nOne of your answers is incorrect!\\n\");\n}\nelse {\nprintf(\"\\nTry again next time!\\n\");\n}\nreturn 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10617591, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mhPp.jpg?s=128&g=1", "display_name": "3D0N", "link": "https://stackoverflow.com/users/10617591/3d0n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1542833843, "creation_date": 1542831253, "last_edit_date": 1542831571, "question_id": 53419824, "link": "https://stackoverflow.com/questions/53419824/comparing-characters-to-strings", "title": "Comparing Characters to Strings", "body": "<p>I'm to write a code in C to let the user enter the first and last characters of the word <code>\"fantastic\"</code>. If he is correct for the two answers it should print <code>\"Well done\"</code>, if he gets one wrong then it should print <code>\"one of your answers is incorrect\"</code> if he gets both incorrect i tell him to try again later.</p>\n\n<p>Below is the code I tried which doesn't allow me to enter the second character and also gets the answer wrong.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    char word[] = \"fantastic\";\n    char in1, in2;\n    printf(\"Please enter the first letter of the word \\'fantastic\\': \");\n    scanf(\"%c\", &amp;in1);\n    printf(\"\\nPlease enter the last letter of the word \\'fantastic\\': \");\n    scanf(\"%c\", &amp;in2);\n    if (in1 == word[0], in2 == word[8]) {\n        printf(\"\\nWell Done!\\n\");\n    }\n    else if (in1 == word[0], in2 != word[8], in1 != word[0], in2 == word[8]) {\n        printf(\"\\nOne of your answers is incorrect!\\n\");\n    }\n    else {\n        printf(\"\\nTry again next time!\\n\");\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "assembly", "gdb"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 2, "creation_date": 1542831341, "post_id": 53419810, "comment_id": 93713933, "body": "Yes you got it correct. <code>esi</code> holds the character itself not a pointer to it. You can do <code>p (char)$esi</code> or <code>p&#47;c $esi</code>."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 2, "creation_date": 1542832272, "post_id": 53419810, "comment_id": 93714317, "body": "It would be more like <code>strchr(char *rdi, int esi)</code>. Also the fact <code>esi</code> is not a pointer is implicit, <code>esi</code> is only 32-bit."}], "owner": {"reputation": 79, "user_id": 10683425, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dEc7BdYYk8s/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hYGj7JGhuwzN6uks7VrKEc8gdzwQ/mo/photo.jpg?sz=128", "display_name": "dipankar", "link": "https://stackoverflow.com/users/10683425/dipankar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542831187, "creation_date": 1542831187, "question_id": 53419810, "link": "https://stackoverflow.com/questions/53419810/what-is-this-assembly-doing-exactly", "title": "what is this assembly doing exactly?", "body": "<p>I have an assembly code that I am reading, and there is the following part in the code:</p>\n\n<pre><code>    mov    $0x28,%esi\n    mov    %rax,%rdi\n    callq  &lt;strchr@plt&gt;\n    mov    %rax,%rbx\n    test   %rax,%rax\n    jne     somewhere\n</code></pre>\n\n<p>I am having a bit of difficulty in this code. The first move moves <code>0x28</code> to register <code>%esi</code>. The second moves <code>%rax</code> to <code>%rdi</code>, and then it does <code>strchr(char *rdi, char *esi)</code>. So, basically it returns the pointer to the first occurence after ascii <code>0x28</code>, which is <code>'('</code>. Then last test tells me that it is testing whether or not string at <code>rdi</code> has a <code>'('</code> character. If does not have, then <code>test %rax, %rax</code> will set ZeroFlags, and <code>jne</code> will not execute. Is my understanding correct?</p>\n\n<p>One more question I have is when I try to check what exactly is in <code>%esi</code> after the first <code>mov</code>, I use the command <code>p (char *)$esi</code> in <code>gdb</code> but I get an output <code>&lt;error: Cannot access memory at address 0x28&gt;</code>. Could anyone advise me how I can view contents of <code>$esi</code>?</p>\n"}, {"tags": ["c", "pointers", "segmentation-fault", "malloc"], "comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 6, "creation_date": 1542829387, "post_id": 53419444, "comment_id": 93713105, "body": "<code>sizeof(char*) + n</code> is a problem"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 2, "creation_date": 1542829544, "post_id": 53419444, "comment_id": 93713162, "body": "<code>arr[i]</code> is <code>*(arr + i)</code>, not <code>*(arr + sizeof(char*) * i)</code>. You have to use the <code>sizeof</code> operator only with the functions that operate on raw data via <code>void *</code> pointers. In the pointer arithmetic above, the size of one element is inferred from <code>arr</code>&#39;s type."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542830197, "post_id": 53419444, "comment_id": 93713459, "body": "I hope you don&#39;t want to modify the things, your <code>arr[0 ... 19]</code> point to."}, {"owner": {"reputation": 134, "user_id": 10574851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/457486dcec8978b880ea34b10b3cc8b3?s=128&d=identicon&r=PG&f=1", "display_name": "Core", "link": "https://stackoverflow.com/users/10574851/core"}, "edited": false, "score": 0, "creation_date": 1542877316, "post_id": 53419444, "comment_id": 93728527, "body": "<code>sizeof(char*) + n</code> is actually a paste mistake"}], "answers": [{"tags": [], "owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "is_accepted": true, "score": 5, "last_activity_date": 1542830756, "last_edit_date": 1542830756, "creation_date": 1542829814, "answer_id": 53419551, "question_id": 53419444, "link": "https://stackoverflow.com/questions/53419444/dynamically-construct-an-array-out-of-existing-strings-without-new-malloc/53419551#53419551", "title": "dynamically construct an array out of existing strings without new malloc", "body": "<p><strong>Issues</strong></p>\n\n<ol>\n<li><p><code>char** arr = malloc( sizeof(char*) + n );</code> allocates (most likely) 24 bytes which can only store (most likely) six <code>char *</code>.</p></li>\n<li><p>You don't need to try offset the address (<code>*(arr + sizeof(char*) * i) = base;</code>) by the base type.  The offset is automatically adjusted by the <code>sizeof</code> the base type.</p></li>\n</ol>\n\n<p>The following changes must be made:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void)\n{\n    int n = 20;\n    char **arr = malloc(sizeof(char *) * n);\n\n    char *base = \"abcdefghijklmnopqrstuvwxyz\";\n\n    for(int i = 0; i &lt; n; i++)\n        arr[i] = base;\n\n    for(int i = 0; i &lt; n; i++)\n        printf(\"%d: %s\\n\", i, arr[i]);\n\n    return 0;\n}\n</code></pre>\n\n<p>The preceding uses array notation.  You can also use pointer notation if you'd like. Change <code>arr[i]</code> to <code>*(arr + i)</code>.</p>\n\n<p><strong>Output</strong></p>\n\n<pre>\n$ gcc main.c -o main.exe; ./main.exe\n0: abcdefghijklmnopqrstuvwxyz\n1: abcdefghijklmnopqrstuvwxyz\n2: abcdefghijklmnopqrstuvwxyz\n3: abcdefghijklmnopqrstuvwxyz\n4: abcdefghijklmnopqrstuvwxyz\n5: abcdefghijklmnopqrstuvwxyz\n6: abcdefghijklmnopqrstuvwxyz\n7: abcdefghijklmnopqrstuvwxyz\n8: abcdefghijklmnopqrstuvwxyz\n9: abcdefghijklmnopqrstuvwxyz\n10: abcdefghijklmnopqrstuvwxyz\n11: abcdefghijklmnopqrstuvwxyz\n12: abcdefghijklmnopqrstuvwxyz\n13: abcdefghijklmnopqrstuvwxyz\n14: abcdefghijklmnopqrstuvwxyz\n15: abcdefghijklmnopqrstuvwxyz\n16: abcdefghijklmnopqrstuvwxyz\n17: abcdefghijklmnopqrstuvwxyz\n18: abcdefghijklmnopqrstuvwxyz\n19: abcdefghijklmnopqrstuvwxyz\n</pre>\n\n<p>As recommended by <a href=\"https://stackoverflow.com/users/3975177/swordfish\">Swordfish</a> you should use the <code>const</code> qualifier on <code>arr</code> and <code>base</code>:</p>\n\n<pre><code>const char **arr = malloc(sizeof(char *) * n);\nconst char * const base = \"abcdefghijklmnopqrstuvwxyz\";\n</code></pre>\n\n<p>In this way:</p>\n\n<ol>\n<li><code>arr</code> cannot change (without a warning/error) pointed to <code>char</code>s.</li>\n<li>Neither the address of <code>base</code> nor the pointed to <code>char</code>s can be changed (without a warning/error).</li>\n</ol>\n\n<p><strong>Thanks</strong></p>\n\n<p>To <a href=\"https://stackoverflow.com/users/9829403/tim-randall\">Tim Randall</a> for catching a math error.</p>\n"}], "owner": {"reputation": 134, "user_id": 10574851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/457486dcec8978b880ea34b10b3cc8b3?s=128&d=identicon&r=PG&f=1", "display_name": "Core", "link": "https://stackoverflow.com/users/10574851/core"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 53419551, "answer_count": 1, "score": 0, "last_activity_date": 1542830756, "creation_date": 1542829308, "question_id": 53419444, "link": "https://stackoverflow.com/questions/53419444/dynamically-construct-an-array-out-of-existing-strings-without-new-malloc", "title": "dynamically construct an array out of existing strings without new malloc", "body": "<p>I want to dynamically allocate an array of strings.\nSo <em>arr</em> should consist of twenty pointers to the first character of each string.</p>\n\n<p>For simplicity, each string is just the same, stored in <em>base</em>.\nThe first for loop should now create my array, which seems to work just fine.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n  int n = 20;\n  char** arr = malloc( sizeof(char*) + n );\n\n  char* base = \"abcdefghijklmnopqrstuvwxyz\";\n\n  for(int i = 0; i &lt; n; i++)\n  {\n    *(arr + sizeof(char*) * i) = base;\n  }\n\n  for(int i = 0; i &lt; n; i++)\n  {\n    printf(\"%s\\n\", *(arr + sizeof(char*) * i));\n  }\n}\n</code></pre>\n\n<p>The seconds for loop creates a <strong>segmentation-fault</strong> during the second iteration.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1542828439, "post_id": 53419230, "comment_id": 93712662, "body": "524288 is a really unusual buffer length to use here. Usually it&#39;s best to stick with 1024 or 4096 as a &quot;good enough&quot; buffer while being aware you have severe buffer overun bugs if you use things like <code>scanf</code>. I know names can be long, but a half megabyte name is unheard of."}, {"owner": {"reputation": 53, "user_id": 10565111, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K4S8orwGiuE/AAAAAAAAAAI/AAAAAAAAAEc/K9xWvkr6Xlw/photo.jpg?sz=128", "display_name": "Zeref Dragneel", "link": "https://stackoverflow.com/users/10565111/zeref-dragneel"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1542828623, "post_id": 53419230, "comment_id": 93712739, "body": "@tadman yeahhh, I am not too sure with that kind of thing, I am not use to typing in buff sizes"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1542828751, "post_id": 53419230, "comment_id": 93712806, "body": "If you&#39;re going to have a default buffer length it&#39;s worth having a constant in C that explains what you&#39;re doing, like <code>#define BUFFER_SIZE 524288</code> or whatever size you want. That way if you change your mind you can adjust later, plus you can do any safety tests in a consistent manner."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1542828808, "post_id": 53419230, "comment_id": 93712832, "body": "It&#39;s worth turning on compiler warnings (e.g. <code>-Wall</code>) to see if the compiler has any grievances with your code it&#39;s not telling you about. Many compilers check <code>printf</code> arguments but only if you ask them to."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542828953, "post_id": 53419230, "comment_id": 93712909, "body": "Using an array for <code>age</code> and <code>dec</code> suggests you want to read more than one such records of persons?"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1542828966, "post_id": 53419230, "comment_id": 93712912, "body": "Why do you create arrays if you want to read only single values? You could do as well: <code>int age; scanf(&quot;%d&quot;, &amp;age);</code> Curious: What&#39;s the meaning of age being -7? If negative ages are meaningless, I&#39;d prefer using unsigned int for (requires format specifier <code>%u</code>)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1542838405, "post_id": 53419230, "comment_id": 93716728, "body": "&quot;it isn&#39;t taking in what I say correctly, why?&quot; --&gt; Good compilers, when their warnings are fully enabled, will provide info to solve this.  Save time, enable all warnings."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1542892350, "post_id": 53419230, "comment_id": 93737307, "body": "@Aconcagua <i>If negative ages are meaningless, I&#39;d prefer using unsigned int for (requires format specifier <code>%u</code>)</i> Doing so <code>scanf()</code> will happily read negative values, report <code>1</code> and give you garbage: &quot;u Matches an optionally signed decimal integer, whose format is the same as expected for the subject sequence of the strtoul function with the value 10 for the base argument.&quot;"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542899984, "post_id": 53419230, "comment_id": 93741641, "body": "@Swordfish &#39;garbage&#39; is going too far, behaviour is well defined. We couldn&#39;t distinguish between large values and negative ones, though, so we might need to check for <code>value &lt; INT_MAX</code>, thus discarding both negative and large values? Advantage of not having to check for &lt; 0 gone... Hm, I can remember once having safely used unsigned for not accepting negative values (<i>long, long</i> ago), when did this change (I&#39;m absolutely not in favour of...)? Or was the compiler of those days not conforming the standard even then?"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542900069, "post_id": 53419230, "comment_id": 93741683, "body": "@Swordfish Anyway, I stay with: <b><i>If</i></b> negative values are meaningless for a specific purpose, <b><i>then</i></b> a signed data type is not the appropriate one..."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542901351, "post_id": 53419230, "comment_id": 93742374, "body": "<i>when did this change (I&#39;m absolutely not in favour of...)? Or was the compiler of those days not conforming the standard even then?</i> \u2013 I cited C99+TR3 for the behaviour of <code>%u</code>. <code>strtoul</code>: <i>If the subject sequence begins with a minus sign, the value resulting from the conversion is negated (in the return type).</i>"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 10565111, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K4S8orwGiuE/AAAAAAAAAAI/AAAAAAAAAEc/K9xWvkr6Xlw/photo.jpg?sz=128", "display_name": "Zeref Dragneel", "link": "https://stackoverflow.com/users/10565111/zeref-dragneel"}, "edited": false, "score": 0, "creation_date": 1542828786, "post_id": 53419279, "comment_id": 93712824, "body": "This worked, thanks! I will accept the answer when the system allows me"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542828869, "post_id": 53419279, "comment_id": 93712868, "body": "@cleblanc For the sake of completeness you maybe want to add something about the use of <code>&quot;%s&quot;</code> with <code>scanf()</code> and error checking."}, {"owner": {"reputation": 803, "user_id": 10488923, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t7NfB.jpg?s=128&g=1", "display_name": "marvinIsSacul", "link": "https://stackoverflow.com/users/10488923/marvinissacul"}, "edited": false, "score": 0, "creation_date": 1542834284, "post_id": 53419279, "comment_id": 93715191, "body": "could&#39;ve fixed <code>dec</code> for him as well"}], "tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": true, "score": 1, "last_activity_date": 1542828544, "creation_date": 1542828544, "answer_id": 53419279, "question_id": 53419230, "link": "https://stackoverflow.com/questions/53419230/c-scanf-not-getting-correct-info/53419279#53419279", "title": "C - Scanf not getting correct info", "body": "<p>This is just printing the address of the array age as a decimal integer (actually it introduces undefined behavior);</p>\n\n<pre><code>printf(\"Age: %d\\n\", age);\n</code></pre>\n\n<p>Try this</p>\n\n<pre><code>printf(\"Age: %d\\n\", age[0]);\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 10565111, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K4S8orwGiuE/AAAAAAAAAAI/AAAAAAAAAEc/K9xWvkr6Xlw/photo.jpg?sz=128", "display_name": "Zeref Dragneel", "link": "https://stackoverflow.com/users/10565111/zeref-dragneel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 53419279, "answer_count": 1, "score": 0, "last_activity_date": 1542828544, "creation_date": 1542828309, "question_id": 53419230, "link": "https://stackoverflow.com/questions/53419230/c-scanf-not-getting-correct-info", "title": "C - Scanf not getting correct info", "body": "<p>Why is it when I run my code I get this result:</p>\n\n<pre><code>Name: Zeref\nAge: 20\nFloat: 20.11\n-----\nName: Zeref\nAge: 1072324272\nDec: 0.000000\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n    char name[524288];\n    int age[524288];\n    float dec[524288];\n\n    printf(\"Name: \");\n    scanf(\"%s\", name);\n    printf(\"Age: \");\n    scanf(\"%d\", age);\n    printf(\"Float: \");\n    scanf(\"%f\", dec);\n\n    printf(\"-----\\n\");\n\n    printf(\"Name: %s\\n\", name);\n    printf(\"Age: %d\\n\", age);\n    printf(\"Dec: %f\\n\", dec);\n\n    return 0;\n}\n</code></pre>\n\n<p>it isn't taking in what I say correctly, why?</p>\n\n<p>I want it to print out exactly what I write but using age as an int, dec as a float and name as a string. Only name works</p>\n"}, {"tags": ["c", "linux", "installation", "dkms"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10687628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a13c04eaea13f878328af48eb51ada63?s=128&d=identicon&r=PG&f=1", "display_name": "mike1024", "link": "https://stackoverflow.com/users/10687628/mike1024"}, "is_accepted": false, "score": 0, "last_activity_date": 1542828610, "creation_date": 1542828610, "answer_id": 53419293, "question_id": 53419185, "link": "https://stackoverflow.com/questions/53419185/disabling-werror-for-dkms/53419293#53419293", "title": "Disabling -Werror for dkms", "body": "<p>Never mind. I've located the Makefile by running dkms with <code>--verbose</code> and commenting the <code>-Werror</code> flag. Thank you anyway, guys.</p>\n"}], "owner": {"reputation": 1, "user_id": 10687628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a13c04eaea13f878328af48eb51ada63?s=128&d=identicon&r=PG&f=1", "display_name": "mike1024", "link": "https://stackoverflow.com/users/10687628/mike1024"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542828610, "creation_date": 1542828116, "question_id": 53419185, "link": "https://stackoverflow.com/questions/53419185/disabling-werror-for-dkms", "title": "Disabling -Werror for dkms", "body": "<p>I am currently trying to install a kernel module to Ubuntu. I've copied the source file for the module into <code>/usr/src/applespi-0.1</code>.</p>\n\n<p>Then, I did</p>\n\n<pre><code>sudo dkms install -m applespi -v 0.1\n</code></pre>\n\n<p>and got</p>\n\n<pre><code>Building module:\ncleaning build area....\nmake KERNELRELEASE=4.4.0-31-generic....(bad exit status: 2)\nError! Bad return status for module build on kernel: 4.4.0-31-generic (x86_64)\nConsult /var/lib/dkms/applespi/0.1/build/make.log for more information.\n</code></pre>\n\n<p>make.log: <a href=\"https://pastebin.com/ySsHrgUt\" rel=\"nofollow noreferrer\">https://pastebin.com/ySsHrgUt</a></p>\n\n<p>My goal is to disable -Werror for when compiling this source file. However, I can't seem to find the Makefile with the -Werror flag.</p>\n"}, {"tags": ["c", "random", "memset"], "comments": [{"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 2, "creation_date": 1542828038, "post_id": 53419153, "comment_id": 93712459, "body": "ASCII&#39;s range is only <code>0</code> - <code>127</code>. Unless <code>drand48()</code> <code>return</code>s <code>0</code> in <code>(char)((122 * drand48()) + 97)</code>, it won&#39;t fit."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1542828129, "post_id": 53419153, "comment_id": 93712505, "body": "Hint: Use <code>&#39;a&#39;</code> (single quotes) to represent a <code>char</code> that&#39;s the ASCII value of &quot;a&quot;. There&#39;s no need to guess. 122 is a <code>&#39;z&#39;</code>, so you&#39;re at the end of that range already, and 122 + 97 is way out of the range of a-z."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1542828220, "post_id": 53419153, "comment_id": 93712554, "body": "Why are you forced to use <code>memset</code>? Doing <code>dns_name[i] = ...</code> seems more logical if you have to bang out multiple characters."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1542828244, "post_id": 53419153, "comment_id": 93712566, "body": "<code>sizeof char</code> is <code>1</code> per definition. Always. And <code>1</code> is neutral for multiplication, so drop it. <code>lrand48()</code> would be better fitting since you want integers."}, {"owner": {"reputation": 1, "user_id": 10687616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e53ca16d1f7239fc24b673b3f65d4841?s=128&d=identicon&r=PG&f=1", "display_name": "jch3", "link": "https://stackoverflow.com/users/10687616/jch3"}, "edited": false, "score": 0, "creation_date": 1542828664, "post_id": 53419153, "comment_id": 93712765, "body": "If I&#39;m correct, drand48() returns a double between 0 and 1.0. So how would I get it to return a value between 97 and 122? Is it even possible?"}, {"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1542829048, "post_id": 53419153, "comment_id": 93712952, "body": "@jch3 <code>(rand() % 26) + 97</code> should work. Check my math."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 2, "creation_date": 1542829232, "post_id": 53419153, "comment_id": 93713032, "body": ". o O ( everytime one uses <a href=\"https://stackoverflow.com/questions/47882/what-is-a-magic-number-and-why-is-it-bad\">magic numbers</a>, a kitty dies :( :( )"}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 1, "creation_date": 1542830342, "post_id": 53419153, "comment_id": 93713515, "body": "The problem with <code>memset</code> is that it&#39;s a very good way of setting multiple bytes to the same value, but a very poor way of setting many bytes to different values. In this case I think it would be far simpler to use one array assignment for each letter."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1542832380, "post_id": 53419153, "comment_id": 93714367, "body": "@Swordfish: 1 is a magic number too, and concealing it by removing <code>sizeof(char)</code> means somebody may miss it when converting code that handles characters to code that handles wide characters with <code>wchar_t</code>."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1542833037, "post_id": 53419153, "comment_id": 93714652, "body": "@EricPostpischil The way it stands now (<code>sizeof(char)</code>) is useless and <code>memset()</code> wont work well for chars wider than 1, so ..."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542833552, "post_id": 53419153, "comment_id": 93714859, "body": "@Swordfish: Using <code>sizeof(char)</code> is no more useless than changing <code>97</code> to <code>&#39;a&#39;</code>. It has the same result in the current compiler but signals meaning to future readers. The fact that the future editor will also have to change <code>memset</code> to something else is a separate additional issue."}, {"owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1542843354, "post_id": 53419153, "comment_id": 93718337, "body": "@EricPostpischil: <code>sizeof(char)</code> is the loneliest number..."}], "answers": [{"comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1542841472, "post_id": 53421618, "comment_id": 93717732, "body": "Can <code>(int)(0.9999...)</code> really get rounded up to <code>1</code>? &quot;When a finite value of real floating type is converted to an integer type other than _Bool, the  fractional  part  is  discarded  (i.e.,  the  value  is  truncated  toward  zero)&quot; (<a href=\"http://www.open-std.org/jtc1/sc22/WG14/www/docs/n1256.pdf\" rel=\"nofollow noreferrer\">6.3.1.4 of ISO/IEC 9899:1999)</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1542841681, "post_id": 53421618, "comment_id": 93717798, "body": "@usr2564301 The issue is not about <code>(int)(0.9999...)</code>, but could <code>0.9999... * 26</code> under <i>any rounding mode</i> and any <code>FLT_EVAL_MODE</code> result in 26.0?  True, mathematically  <code>0.9999... * 26</code> is always less than 26, but this is FP math.  A deep analysis may show 26.0 is not possible, but not having done that, a check is prudent."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1542842457, "last_edit_date": 1542842457, "creation_date": 1542841078, "answer_id": 53421618, "question_id": 53419153, "link": "https://stackoverflow.com/questions/53419153/how-do-i-set-a-random-number-of-random-lowercase-characters-to-a-struct-member-u/53421618#53421618", "title": "How do I set a random number of random lowercase characters to a Struct member using memset in C", "body": "<blockquote>\n  <p>My code returns non ASCII characters and I am not sure why.</p>\n</blockquote>\n\n<p><strong>Wrong scale used to generate lower case letters.</strong></p>\n\n<p><code>(122 * drand48()) + 97</code> converted to an integer type can readily make 122 different values.  [97...218].  This is outside the ASCII range of <code>[0...127]</code>.</p>\n\n<hr>\n\n<blockquote>\n  <p>How do I set a random number of random lowercase character ...</p>\n</blockquote>\n\n<p><code>drand48()</code> provides a random value [0...1.0). Scale by 26 and truncate to get 26 different indexes.</p>\n\n<pre><code>int index = (int) (drand48()*26);  // 0...25\n</code></pre>\n\n<p>Pedantic code would be concerned about the few random values that may <em>round</em> the product to 26.0</p>\n\n<pre><code>if (index &gt;= 26) index = 26 - 1;\nint az = index + 'a';\n// or look up in a table if non-ASCII encoding might be used\n//        12345678901234567890123456\nint az = \"abcdefghijklmnopqrstuvwxyz\"[index];\n</code></pre>\n\n<p>Selecting a random length would use the same thing, but with <code>NUMLTRS</code> instead of 26.</p>\n\n<pre><code>int length = (int) (drand48()*NUMLTRS); \nif (index &gt;= NUMLTRS) index = NUMLTRS -1;\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>... to a Struct member using memset in C</p>\n</blockquote>\n\n<p>It is unclear if <code>dns_name[]</code> should be all the same, or generally different letters.</p>\n\n<pre><code>struct Record foo;\nif (all_same) [\n  memset(foo.dns_name, az, length);\n} else {\n  for (int i = 0; i &lt; length; i++) {\n    int index = (int) (drand48()*26);  // 0...25\n    if (index &gt;= 26) index = 26 -1;\n    int az = index + 'a';\n    foo.dns_name[i] = az;  // Does not make sense to use memset() here\n  }\n}\n</code></pre>\n\n<hr>\n\n<p>Lastly, if <code>dns_name[]</code> is meant to be a <em>string</em> for ease of later use, declare with a +1 size</p>\n\n<pre><code>dns_name[NUMLTRS + 1];\n\n// above code\n\nfoo.dns_name[NUMLTRS] = '\\0'; // append null character\nprintf(\"dna_name &lt;%s&gt;\\n\", foo.dns_name);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10687616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e53ca16d1f7239fc24b673b3f65d4841?s=128&d=identicon&r=PG&f=1", "display_name": "jch3", "link": "https://stackoverflow.com/users/10687616/jch3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542842457, "creation_date": 1542827975, "question_id": 53419153, "link": "https://stackoverflow.com/questions/53419153/how-do-i-set-a-random-number-of-random-lowercase-characters-to-a-struct-member-u", "title": "How do I set a random number of random lowercase characters to a Struct member using memset in C", "body": "<p>I am forced to use memset and drand48() to set a random number (2 - 7) of random characters that are lower case letters ('a' to 'z'). My code returns non ASCII characters and I am not sure why. </p>\n\n<pre><code>struct Record {\n    int seqnum;\n    float threat;\n    unsigned int addrs[2];\n    unsigned short int ports[2];\n    char dns_name[NUMLTRS];\n};\n</code></pre>\n\n<p>My code is in a for loop: </p>\n\n<pre><code>memset(rec_ptr[i].dns_name, (char)((122 * drand48()) + 97), \n((sizeof(char) * 7) * drand48()) + (sizeof(char) * 2));\n</code></pre>\n"}, {"tags": ["c", "c-strings", "word"], "comments": [{"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1542826266, "post_id": 53418740, "comment_id": 93711605, "body": "Are you trying to count the number of letters in each word or the average number of letters in all words?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 1, "creation_date": 1542826706, "post_id": 53418740, "comment_id": 93711834, "body": "@FiddlingBits Judging by the desired output, it&#39;s supposed to be number of words with N letters, where N ascends from 1."}, {"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1542826892, "post_id": 53418740, "comment_id": 93711926, "body": "@WhozCraig Thank you for deciphering it. :-D"}, {"owner": {"reputation": 21, "user_id": 10687512, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aDINoo2YQWg/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jc9-rShnCp4HPFFmF88dHqz79bSQ/mo/photo.jpg?sz=128", "display_name": "Kamil Lubecki", "link": "https://stackoverflow.com/users/10687512/kamil-lubecki"}, "edited": false, "score": 0, "creation_date": 1542826974, "post_id": 53418740, "comment_id": 93711976, "body": "Hi, I am trying to find how many words in the text given have for example 2 letters and so on. I seriously don&#39;t know how to do it"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1542827642, "post_id": 53418740, "comment_id": 93712286, "body": "This is an algorithm problem. It should require <i>one</i> forward scan of the string, broken into loops that skip white space, then scan non-white space to gather the length of the next word. When the length is known, update a count table (initially filled with 0&#39;s) that is indexed by that length, and repeat the entire process. When done, you&#39;ll have a count table where all non-zero values indicate the number of words of the index length. Anyway, that&#39;s the algorithm to shoot for."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1542828267, "post_id": 53418740, "comment_id": 93712579, "body": "<i>Side note:</i> <code>strlen</code> has to scan the entire string each time it is invoked. This is very slow. The length of <code>tablen</code> doesn&#39;t change, so we can cache the length and call <code>strlen</code> only once. After the <code>fgets</code>, do: <code>int tablen = strlen(tab);</code> Then, change the <code>(int)strlen(tab)</code> calls in the <code>for</code> loops to be <code>tablen</code>. This will speed things up considerably."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10687512, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aDINoo2YQWg/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jc9-rShnCp4HPFFmF88dHqz79bSQ/mo/photo.jpg?sz=128", "display_name": "Kamil Lubecki", "link": "https://stackoverflow.com/users/10687512/kamil-lubecki"}, "edited": false, "score": 0, "creation_date": 1542837521, "post_id": 53420313, "comment_id": 93716456, "body": "thanks a lot, but I&#39;m a very beginner of a C language (and basically all of this), and i don&#39;t really understand pointers. Is there any simpler method to do this? I&#39;m trying to learn topic by topic. Cheers :)"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 21, "user_id": 10687512, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aDINoo2YQWg/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jc9-rShnCp4HPFFmF88dHqz79bSQ/mo/photo.jpg?sz=128", "display_name": "Kamil Lubecki", "link": "https://stackoverflow.com/users/10687512/kamil-lubecki"}, "edited": false, "score": 0, "creation_date": 1542850829, "post_id": 53420313, "comment_id": 93719968, "body": "@KamilLubecki <a href=\"https://stackoverflow.com/q/5727/995714\">What are the barriers to understanding pointers and what can be done to overcome them?</a>"}], "tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": false, "score": 0, "last_activity_date": 1542838979, "last_edit_date": 1542838979, "creation_date": 1542833621, "answer_id": 53420313, "question_id": 53418740, "link": "https://stackoverflow.com/questions/53418740/program-to-count-length-of-each-word-in-string-in-c/53420313#53420313", "title": "Program to count length of each word in string in C", "body": "<p>By using <em>two</em> <code>for</code> loops, you're doing <code>len**2</code> character scans. (e.g.) For a buffer of length 1000, instead of 1000 character comparisons, you're doing 1,000,000 comparisons.</p>\n\n<p>This can be done in a <em>single</em> <code>for</code> loop if we use a word length histogram array.</p>\n\n<p>The basic algorithm is the same as your inner loop.</p>\n\n<p>When we have a non-space character, we increment a current length value. When we see a space, we increment the histogram cell (indexed by the length value) by 1. We then set the length value to 0.</p>\n\n<p>Here's some code that works:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint\nmain(void)\n{\n    int hist[100] = { 0 };\n    char buf[1000];\n    char *bp;\n    int chr;\n    int curlen = 0;\n\n    printf(\"Enter text: \");\n    fflush(stdout);\n\n    fgets(buf,sizeof(buf),stdin);\n    bp = buf;\n\n    for (chr = *bp++;  chr != 0;  chr = *bp++) {\n        if (chr == '\\n')\n            break;\n\n        // end of word -- increment the histogram cell\n        if (chr == ' ') {\n            hist[curlen] += 1;\n            curlen = 0;\n        }\n\n        // got an alpha char -- increment the length of the word\n        else\n            curlen += 1;\n    }\n\n    // catch the final word on the line\n    hist[curlen] += 1;\n\n    for (curlen = 1;  curlen &lt; sizeof(hist) / sizeof(hist[0]);  ++curlen) {\n        int count = hist[curlen];\n        if (count &gt; 0)\n            printf(\"%d - %d\\n\",curlen,count);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<p><strong>UPDATE:</strong></p>\n\n<blockquote>\n  <p>and i don't really understand pointers. Is there any simpler method to do this?</p>\n</blockquote>\n\n<p>Pointers are a very important [essential] tool in the C arsenal, so I hope you get to them soon.</p>\n\n<p>However, it is easy enough to convert the <code>for</code> loop (Removing the <code>char *bp;</code> and <code>bp = buf;</code>):</p>\n\n<p>Change:</p>\n\n<pre><code>for (chr = *bp++;  chr != 0;  chr = *bp++) {\n</code></pre>\n\n<p>Into:</p>\n\n<pre><code>for (int bufidx = 0;  ;  ++bufidx) {\n    chr = buf[bufidx];\n    if (chr == 0)\n        break;\n</code></pre>\n\n<p>The rest of the <code>for</code> loop remains the same.</p>\n\n<p>Here's another loop [but, without optimization by the compiler] double fetches the char:</p>\n\n<pre><code>for (int bufidx = 0;  buf[bufidx] != 0;  ++bufidx) {\n    chr = buf[bufidx];\n</code></pre>\n\n<p>Here is a single line version. Note this is <em>not</em> recommended practice because of the embedded <em>assignment</em> of <code>chr</code> <em>inside</em> the loop condition clause, but is for illustration purposes:</p>\n\n<pre><code>for (int bufidx = 0;  (chr = buf[bufidx]) != 0;  ++bufidx) {\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10687512, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aDINoo2YQWg/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jc9-rShnCp4HPFFmF88dHqz79bSQ/mo/photo.jpg?sz=128", "display_name": "Kamil Lubecki", "link": "https://stackoverflow.com/users/10687512/kamil-lubecki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2722, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1542838979, "creation_date": 1542826134, "last_edit_date": 1542826593, "question_id": 53418740, "link": "https://stackoverflow.com/questions/53418740/program-to-count-length-of-each-word-in-string-in-c", "title": "Program to count length of each word in string in C", "body": "<p>I'm writting a program to count the length of each word in array of characters. I was wondering if You guys could help me, because I'm struggling with it for at least two hours for now and i don't know how to do it properly.\nIt should go like that:</p>\n\n<p>(number of letters) - (number of words with this many letters)<br />\n  2 - 1<br />\n  3 - 4<br />\n  5 - 1<br />\netc.<br /></p>\n\n<pre><code>char tab[1000];\nint k = 0, x = 0;\n\nprintf(\"Enter text: \");\nfgets(tab, 1000, stdin);\n\nfor (int i = 2; i &lt; (int)strlen(tab); i++)\n{\n\n\n    for (int j = 0; j &lt; (int)strlen(tab); j++)\n    {\n        if (tab[j] == '\\0' || tab[j]=='\\n')\n            break;\n        if (tab[j] == ' ')\n            k = 0;\n        else k++;\n\n        if (k == i)\n        {\n            x++;\n            k = 0;\n        }\n    }\n    if (x != 0)\n    {\n        printf(\"%d - %d\\n\", i, x);\n        x = 0;\n        k = 0;\n    }\n\n}\n\n\n\nreturn 0;\n</code></pre>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1542825197, "post_id": 53418417, "comment_id": 93711121, "body": "When you write <code>page_table pt;</code> in the <code>if</code> body, the variable comes into existence when it is defined, and goes out of existence when the corresponding <code>}</code> is encountered.  The variable only lasts that long.  If you need it to last longer, you need to define it somewhere else, or (more likely) use dynamic memory allocation with <code>malloc()</code> or one of its relatives (followed later by an appropriate <code>free()</code>)."}, {"owner": {"reputation": 5, "user_id": 7729858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2324fd1a98a12b7ba46172c6ac47f9e7?s=128&d=identicon&r=PG&f=1", "display_name": "J.J.", "link": "https://stackoverflow.com/users/7729858/j-j"}, "reply_to_user": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1542825338, "post_id": 53418417, "comment_id": 93711175, "body": "@Fiddling Bits It worked! just had to change the pointers and referencing around a little. If you post that as an answer I will accept it. Thank you for the help. I was so close but so far!"}], "answers": [{"tags": [], "owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "is_accepted": true, "score": 0, "last_activity_date": 1542825617, "creation_date": 1542825617, "answer_id": 53418609, "question_id": 53418417, "link": "https://stackoverflow.com/questions/53418417/how-to-instantiate-new-struct-instance-in-loop/53418609#53418609", "title": "How to instantiate new struct instance in loop", "body": "<p>The problem that you're having is that <code>pt</code> only has block scope.  At the end of the block, <code>}</code>, <code>pt</code> doesn't exist anymore.</p>\n\n<pre><code>if ((strcmp(words[i], \"new\") == 0)) {\n    page_table pt;\n    ...\n}\n\n// pt Doesn't Exist Anymore\n</code></pre>\n\n<p>A way to resolve this is to use <code>malloc</code> to dynamically allocate memory:</p>\n\n<pre><code>if ((strcmp(words[i], \"new\") == 0)) {\n    page_table *pt = malloc(sizeof(*pt));\n    ...\n}\n</code></pre>\n\n<p>It should be noted that if you write over <code>pt</code> without <code>free</code>ing it and lose the former address you will suffer from a <a href=\"https://en.wikipedia.org/wiki/Memory_leak\" rel=\"nofollow noreferrer\">memory leak</a>.</p>\n"}], "owner": {"reputation": 5, "user_id": 7729858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2324fd1a98a12b7ba46172c6ac47f9e7?s=128&d=identicon&r=PG&f=1", "display_name": "J.J.", "link": "https://stackoverflow.com/users/7729858/j-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 53418609, "answer_count": 1, "score": 0, "last_activity_date": 1542825617, "creation_date": 1542824900, "last_edit_date": 1542825257, "question_id": 53418417, "link": "https://stackoverflow.com/questions/53418417/how-to-instantiate-new-struct-instance-in-loop", "title": "How to instantiate new struct instance in loop", "body": "<p>I'm trying to fill an array of pointers to a struct with a new struct each time. The problem that I'm getting is my array of struct pointers seems to be filling up with pointers to the same struct. I'm used to using other languages where I can say new and it calls a constructor which makes a new instans so you can still use the same name but get a new address.\nHere is my code for the structs:</p>\n\n<pre><code>struct table_entry { \n          _Bool valid; //probably not needed can just use check for null\n          _Bool mem; \n          int index; // will be number between 0-63\n  };\n  typedef struct{\n          int proc_id;\n          struct table_entry *pte[64];\n  } page_table ;\n</code></pre>\n\n<p>Here is where I am trying to make a new page_table instance but getting the same address anyway: I think the problem is within the first few lines of the first if where I am trying to make a new instance of the struct.</p>\n\n<pre><code>for (int i = 0; i &lt; size; i++) {\n    if ((strcmp(words[i], \"new\") == 0)) {\n        page_table pt;\n        printf(\"address of pt:%d\", (int) &amp;pt);\n        pt.proc_id = atoi(words[i + 1]);\n        proceses[atoi(words[i + 1])] = &amp;pt;\n        printf(\"new process: %s:%d\\n\", words[i],\n               proceses[atoi(words[i + 1])]-&gt;proc_id);\n    } else if ((strcmp(words[i], \"switch\") == 0)) {\n        printf(\"switching to process: %s\\n\", words[i + 1]);\n        int process = atoi(words[i + 1]);\n        page_table cur_pt = *proceses[process];\n        // change the current page table reference\n        printf(\"process ID%d: %d\\n\", process, cur_pt.proc_id);\n    } else if ((strcmp(words[i], \"access\") == 0)) {\n        //      printf(\"accessing memory: %d\\n\", atoi(words[i + 1]) &gt;&gt; 10);\n    }\n    for (int i = 0; i &lt;= size; i++) {\n        //      printf(\"%s\\n\", words[i]);\n    }\n}\n</code></pre>\n\n<p>I have been searching to try and figure out the best way to handle this and I'm not really sure what I'm looking for. I have looked into anonymous structs and I have also tried allocating memory using malloc. I did not seem to find success in either of those approaches, though I'm not sure I was doing them correctly. \nThank you for any help and let me know if you would like to see anything else or have any questions.</p>\n"}, {"tags": ["c", "memory", "embedded"], "comments": [{"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 2, "creation_date": 1542824093, "post_id": 53418234, "comment_id": 93710661, "body": "hum, where else do you think it could be?"}, {"owner": {"reputation": 1187, "user_id": 1238675, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HLTaO.jpg?s=128&g=1", "display_name": "Tasos", "link": "https://stackoverflow.com/users/1238675/tasos"}, "reply_to_user": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1542824168, "post_id": 53418234, "comment_id": 93710692, "body": "I have an embedded system with 1MB available RAM, the <code>FLASH_SECTOR_SIZE</code> is 65536. So this should take the entire memory. They gave me the code like this and I am wondering the same thing as you to be honest."}, {"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 1, "creation_date": 1542824313, "post_id": 53418234, "comment_id": 93710760, "body": "I guess this is done on purpose, the memory is certainly handled manually latter. this is probably because you do not have access to standard malloc/free (my guess)"}, {"owner": {"reputation": 1187, "user_id": 1238675, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HLTaO.jpg?s=128&g=1", "display_name": "Tasos", "link": "https://stackoverflow.com/users/1238675/tasos"}, "reply_to_user": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1542824495, "post_id": 53418234, "comment_id": 93710843, "body": "Hm I do see 1 malloc() call in the code"}, {"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1542824660, "post_id": 53418234, "comment_id": 93710920, "body": "obviously here there are not, but I imagine this is just a demonstration sample... that said I&#39;m just trying to guess, the board must have some documentation you may look at to get accurate info."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1542824743, "post_id": 53418234, "comment_id": 93710954, "body": "If you align a <code>uint16_t</code> array on a multiple of 16 bytes, then it might be moved by up to 14 bytes (in a multiple of 2) from where it would have been placed without the alignment directive.  That&#39;s not a huge overhead, and presumably isn&#39;t an issue since the code would (apparently, normally) work even if it was not aligned on 16 byte boundaries.  You added the attribute for a reason, and space saving was not one of the reasons.   And <b>no</b>, it does not reserve <code>FLASH_SECTOR_SIZE * 16</code> bytes; it reserves <code>FLASH_SECTOR_SIZE * 2</code> bytes (assuming <code>CHAR_BIT == 8</code>)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1543000346, "post_id": 53418234, "comment_id": 93776255, "body": "The title was missleading and not what you are asking. On a sidenote: don&#39;t use compiler features when there is a standard way.  <code>_Alignas</code> in this case."}, {"owner": {"reputation": 1187, "user_id": 1238675, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HLTaO.jpg?s=128&g=1", "display_name": "Tasos", "link": "https://stackoverflow.com/users/1238675/tasos"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1543090826, "post_id": 53418234, "comment_id": 93795438, "body": "@toohonestforthissite someone changed my title"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1543091120, "post_id": 53418234, "comment_id": 93795508, "body": "Guess who and why I left a comment? I rolled back. Please think about it before you edit again."}, {"owner": {"reputation": 1187, "user_id": 1238675, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HLTaO.jpg?s=128&g=1", "display_name": "Tasos", "link": "https://stackoverflow.com/users/1238675/tasos"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1543174552, "post_id": 53418234, "comment_id": 93812912, "body": "@toohonestforthissite please don&#39;t change it again, I have no idea what the title your are placing means. My title is my honest question."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1543175295, "post_id": 53418234, "comment_id": 93813154, "body": "That&#39;s clearly not what you ask in the text nor what the answers are about. Including the one you accepted which indocates my edit was correct. So I change it and would apprechiate you leave it as-is. Titles should be as accurate as possible to aid future users find the correct subject. If you don&#39;t understand what it means, I recommend to do some research in your favourite C book and the fine gcc manual. If you have a different question, feel free to post a new one (you are not allowed to change your question once you got an answer). Edit: I corrected an obvious typo."}], "answers": [{"comments": [{"owner": {"reputation": 1187, "user_id": 1238675, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HLTaO.jpg?s=128&g=1", "display_name": "Tasos", "link": "https://stackoverflow.com/users/1238675/tasos"}, "edited": false, "score": 0, "creation_date": 1542826440, "post_id": 53418539, "comment_id": 93711696, "body": "It is indeed used to a write to a FLASH and I figured the same reason"}], "tags": [], "owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "is_accepted": true, "score": 4, "last_activity_date": 1542825342, "creation_date": 1542825342, "answer_id": 53418539, "question_id": 53418234, "link": "https://stackoverflow.com/questions/53418234/how-much-memory-does-alignment-use-in-c/53418539#53418539", "title": "How much memory does alignment use in C?", "body": "<p>No. <code>__attribute__((aligned(16)))</code> just ensures that <code>FLASH_BUFFER2</code> is put on a 16-byte boundary. It will still reserve <code>FLASH_SECTOR_SIZE * sizeof(uint16_t)</code> bytes.</p>\n\n<p>When I've used that attribute in the past, it was because the DMA controller or the mechanism used for writing to/from internal flash memory required that the RAM location be on a 16-byte boundary. Because you are doing this on an embedded system, you could be dealing with the same thing.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1542826614, "last_edit_date": 1542826614, "creation_date": 1542826289, "answer_id": 53418777, "question_id": 53418234, "link": "https://stackoverflow.com/questions/53418234/how-much-memory-does-alignment-use-in-c/53418777#53418777", "title": "How much memory does alignment use in C?", "body": "<blockquote>\n  <p>When I run it, does it reserve FLASH_SECTOR_SIZE * 16 bytes in memory?</p>\n</blockquote>\n\n<p>No.  Type <code>uint16_t</code> is 16 <em>bits</em> wide, not 16 <em>bytes</em>.  Memory is indeed reserved for the array, but its size is <code>FLASH_SECTOR_SIZE * 2</code> bytes.</p>\n\n<p>The <code>__attribute__</code> syntax you present is not part of standard C, so what it means depends on your compiler, but I see no reason whatever to think that it makes the array not actually have memory reserved for it after all, or that it changes the amount of memory reserved.  Probably, <code>__attribute__((aligned(16)))</code> simply ensures that the start address of the array is aligned on a 16-byte boundary.</p>\n"}], "owner": {"reputation": 1187, "user_id": 1238675, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HLTaO.jpg?s=128&g=1", "display_name": "Tasos", "link": "https://stackoverflow.com/users/1238675/tasos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 53418539, "answer_count": 2, "score": 1, "last_activity_date": 1543175803, "creation_date": 1542824024, "last_edit_date": 1543175803, "question_id": 53418234, "link": "https://stackoverflow.com/questions/53418234/how-much-memory-does-alignment-use-in-c", "title": "How much memory does alignment use in C?", "body": "<p>I have this program:</p>\n\n<pre><code>__attribute__((section(\".graph\"))) __attribute__((aligned(16)))\nuint16_t FLASH_BUFFER2[FLASH_SECTOR_SIZE];\n\nint main ()\n{\n  printf(\"Hallo World\"\\n);\n}\n</code></pre>\n\n<p>When I run it, does it reserve <code>FLASH_SECTOR_SIZE * 16</code> bytes in memory?</p>\n\n<p>Edit : The technically correct question is \"does it reserve <code>FLASH_SECTOR_SIZE * 2 * 16</code> bytes in memory? (2 for <code>uint16_t</code> and 16 for alignment)\"</p>\n"}, {"tags": ["c", "linux", "sockets", "tcp"], "comments": [{"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 1, "creation_date": 1542826230, "post_id": 53417927, "comment_id": 93711587, "body": "You cannot <code>recv(controller_sock, &amp;recv_message, sizeof(recv_message), 0)</code>. The <code>controller_sock</code> is a listen one. You may only <code>accept</code> on it. Perhaps, <code>recv(clnSocket, &amp;recv_message, sizeof(recv_message), 0);</code>?"}, {"owner": {"reputation": 175, "user_id": 9005618, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a70163226c6c64ca1e915231c8c50faa?s=128&d=identicon&r=PG&f=1", "display_name": "pennyBoy", "link": "https://stackoverflow.com/users/9005618/pennyboy"}, "reply_to_user": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1542827830, "post_id": 53417927, "comment_id": 93712366, "body": "Omg thank you so much! Like forreal I really appreciate that."}], "owner": {"reputation": 175, "user_id": 9005618, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a70163226c6c64ca1e915231c8c50faa?s=128&d=identicon&r=PG&f=1", "display_name": "pennyBoy", "link": "https://stackoverflow.com/users/9005618/pennyboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542822722, "creation_date": 1542822722, "question_id": 53417927, "link": "https://stackoverflow.com/questions/53417927/communication-sending-a-message-from-a-client-to-a-server", "title": "Communication: Sending a message from a client to a server", "body": "<p>My Server can handle multiple clients/switches at a time. </p>\n\n<p>My problem is in my switch I believe, I'm trying to send an open message to the the controller. I create the the tcp socket in the switch and then right after I try to send the message to the controller, however when I try to do this, the socket disconnects from the controller and goes into an infinite loop. I'm not sure why this occurs as I'm creating and sending the message outside of my while loop. If I comment where I send the message, the socket stays connected to the controller and I am able to  wait for one of a set of file descriptors to become ready to perform I/O, currently I only have the keyboard and the socket. My socket also receives a message from the controller when it's connected \"You are connected to the server\". In addition since my switch socket disconnects my recv() return error code 107 due to the fact the socket is disconnected.</p>\n\n<p>I'm not sure If I provided too much code to look through but I added comments where I thought my error was occurring in the switch as well as the controller. Greatly appreciated for some help. I didn't add any of my own header files because they are not necessary.</p>\n\n<hr>\n\n<p>This where I execute the switch. Sends and receive messages here.</p>\n\n<pre><code>#include \"switch.h\"\n#include \"openFIFO.h\"\n#include \"packets.h\"\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;strings.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;unistd.h&gt;\n\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/select.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n\n#include&lt;poll.h&gt;\n#include &lt;signal.h&gt;\nvoid do_switch(int swIport, char *trafficfile,int swJport, int swKport, int IPlow, int IPhigh,char serverAddress[256], unsigned short portNumber){\n\n int  switch_sock;\n char server_response[256]; \n struct pollfd pfds[6];\n int rval;\n/* Switch */\nSwitch sw;\nsw.swJport = swJport;\nsw.swIport = swIport;\nsw.swKport = swKport;\nsw.IPlow = IPlow;\nsw.IPhigh = IPhigh;\nint switchLength = sizeof(Switch);\n\n // printf(\"\\n\\nstruct switchLength: %d\\n\", switchLength);\n//  printf(\"\\n\\nSwitch Struct: swIport: %d, swJport: %d,  swKport: %d, \n    IPlow: %d, IPhigh: %d\\n\", sw.swIport, sw.swJport, sw.swKport, sw.IPlow, \n    sw.IPhigh);\n\n   printf(\"\\n\\nSwitch created with the following: swIport: %d, trafficfile: \n   %s, swJport: %d,  swKport: %d, IPlow: %d, IPhigh: %d, serverAddress: %s, \n   portNumber: %d\\n\", swIport, trafficfile, swJport, swKport, IPlow, IPhigh, \n   serverAddress, portNumber);\n\n\nint fifoWrite[2];\nint fifoRead[2];\nint counter = 0;\nchar message[20] = \"Hello\";\n\n/* Create fifos */\nif(swJport != -1){\n        fifoWrite[0] = openWF(swIport,swJport);\n        fifoRead[0] = openReadFifo(swJport, swIport);\n    counter = counter + 2;\n}\nif(swKport != -1){\n    fifoWrite[1] = openWF(swIport,swKport);\n        fifoRead[1] = openReadFifo(swKport, swIport);\n    counter = counter + 2;\n}else if(swKport == -1){\n    fifoWrite[0] = openWF(swIport,swKport);\n    fifoRead[0] = openReadFifo(swKport, swIport);\n    counter = counter + 2;\n}\n\nprintf(\"fifoWrite[0]: %d\\n\", fifoWrite[0]);\nprintf(\"fifoRead[0]: %d\\n\", fifoRead[0]);\nprintf(\"fifoWrite[1]: %d\\n\", fifoWrite[1]);\nprintf(\"fifoRead[1]: %d\\n\", fifoRead[1]);   \n\n\n/* Establish connection between the controller and switch */\n/* Send a open packet to the controller */\n/* Sending a stuct */\n\n //PROBELM HERE BELOW!!!!!!!\n\n switch_sock = CreateTCPClientSocket(portNumber, serverAddress);    \n if(send(switch_sock, message, sizeof(message), 0) == -1){\n    fprintf(stderr, \"Send() Failed\");\n }\n else{\n   printf(\"Open packet is being sent to the controller\\n\");\n }\n\n\n/* Initialize poll parameters */\n//Keyboard\npfds[0].fd = STDIN_FILENO;\npfds[0].events = POLLIN;\n\n//  Socket!\npfds[1].fd = switch_sock;\npfds[1].events = POLLIN;\n\n\nprintf(\"Starting switch............................\\n\\n\");\n\nwhile(1){\n\n    rval = poll(pfds,2,-1);\n    if(rval == 0){\n        fprintf(stderr, \"Poll timed out. \\n\");\n    }if(rval == -1){\n        fprintf(stderr, \"ERROR: poll() failed\");\n        exit(0);\n    }\n\n\n    /* Check Keyboard */\n    if(pfds[0].revents &amp; POLLIN &amp;&amp; pfds[0].fd == 0){\n               int a;\n               char command[1024][256];\n               int commands;\n               char buf[256];\n               commands = read(0, buf, 256);\n               buf[commands] = '\\0';\n               buf[commands] = '\\0';\n\n               char *token;\n               token = strtok(buf, \" \");\n               while(token != NULL){\n                       strcpy(command[a], token);\n                       a++;\n                       token = strtok(NULL, \" \");\n               }\n               a = 0;\n               bzero(buf, 256);\n\n               if(strcmp(command[0], \"list\") == 0){\n                        //TODO: Make a print function\n                       printf(\"print_switch()\\n\");\n               }\n               if(strcmp(command[0], \"exit\") == 0){\n                       //TODO: Make a print function\n                    printf(\" print_switch()\\n\");\n                                printf(\"switch-disconnected\\n\");\n                                close(switch_sock);\n                                exit(0)\n\n              }\n      }\n\n    /* Server sent a welcome message */\n    // Might be PROBELM HERE BELOW when trying to send the initial packet to \n       controller!!!!!!!\n    if(pfds[1].revents &amp; POLLIN){\n        recv(switch_sock, &amp;server_response, sizeof(server_response), 0);\n        printf(\"%s\\n\", server_response);    \n    }\n }\n}\n</code></pre>\n\n<hr>\n\n<p>Creates a TCP Socket for the switch.</p>\n\n<pre><code>int CreateTCPClientSocket( unsigned short port, char *serverAddress){\n  int sock; /*socket to create */\n  struct sockaddr_in servAddr; /* Local address */\n\n  /* Construct local address structure */   \n  /* Create socket for incoming connections */\n  if ((sock =  socket(AF_INET, SOCK_STREAM, 0)) &lt; 0){\n            fprintf(stderr,\"ERROR: socket() failed\\n\");\n            exit(0);\n    }\n\n  memset(&amp;servAddr, 0, sizeof(servAddr));\n  servAddr.sin_family = AF_INET;\n  servAddr.sin_port = htons(port);\n  servAddr.sin_addr.s_addr = inet_addr(serverAddress);\n\n  if(connect(sock, (struct sockaddr *)&amp;servAddr, sizeof(struct sockaddr)) &lt; \n  0){\n     printf(\"Error code: %d\\n\", errno);\n     fprintf(stderr, \"ERROR: connect() just failed\\n\");\n     exit(0);   \n }\n return sock;\n}\n</code></pre>\n\n<hr>\n\n<hr>\n\n<p>This is the controller</p>\n\n<pre><code>#include \"controller.h\"\n#include \"packets.h\"\n#include \"switch.h\"\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;strings.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;unistd.h&gt;\n\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/select.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n\nvoid do_controller(int nSwitch, int portNumber){\n\n   int controller_sock; /* Socket descriptor for server/controller */\n   int clnSocket;  /*Socket descriptor for clients */\n   int activity;\n   int max_sd;\n   int sd;\n   int client_socket[nSwitch];\n\n   struct sockaddr_in address;\n   int addrlen;\n   /* Controller stuff */\n   Controller cont;\n   cont.ackCounter = 0;\n   cont.openCounter = 0;\n\n   Switch sw;\n\n  char message[256] = \"You have reached the server\\n\";\n  char recv_message[20];\n\n   printf(\"\\n\\nController created: nSwitch: %d on portNumber: %d\\n\", nSwitch, portNumber);\n\n  /* Initialise all client_socket[] to 0 so not checked */\n  for(int i = 0; i &lt; nSwitch; i++){\n     client_socket[i] = 0;\n  }\n\n /*Create the server/controller socket */\n  controller_sock = CreateTCPServerSocket(portNumber);  \n //addrlen = sizeof(address);\n /* Prepare for nonblocking I/O polling/select from the controller socket */    \n printf(\"Starting server.........\\n\\n\");\n while(1){\n    /* Zero the socket set and set for server sockets */\n    /* This must be reset every time select() is called */\n    /* Add keyboard to descriptor */\n    /* Add client and controller sockets  to set */\n\n    FD_ZERO(&amp;sockSet);\n    FD_SET(STDIN_FILENO, &amp;sockSet);\n    FD_SET(controller_sock, &amp;sockSet);\n    max_sd = controller_sock;\n    //max_sd = 0;\n    printf(\"nSwitch: %d\\n\", nSwitch);   \n    for(int x = 0; x &lt; nSwitch; x++){\n        sd = client_socket[x];\n        printf(\"sd: %d\\n\\n\", sd);\n        if(sd &gt; 0)\n            FD_SET(sd, &amp;sockSet);\n        if(sd &gt; max_sd)\n            max_sd = sd;\n    }   \n    printf(\"max_sd: %d\\n\", max_sd);\n\n    //wait for  one of the sockets, timeout is Null,\n    //so wait indefinitely\n    activity = select(max_sd + 1, &amp;sockSet, NULL, NULL,NULL);\n    //printf(\"Activity: %d\\n\", activity);\n    if(activity &lt; 0){\n        fprintf(stderr, \"ERROR: select()\\n\");\n        exit(0);\n    }\n\n    /*Check keyboard */\n    if(FD_ISSET(STDIN_FILENO, &amp;sockSet)){\n        int a;\n        char command[1024][256];\n        int commands;\n        char buf[256];\n        commands = read(0, buf, 256);\n        buf[commands] = '\\0';\n\n        char *token;\n        token = strtok(buf, \" \");\n        while(token != NULL){\n            strcpy(command[a], token);\n            a++;\n            token = strtok(NULL, \" \");\n        }\n        a = 0;  \n        bzero(buf, 256);\n\n        if(strcmp(command[0], \"list\") == 0){\n            //TODO: Make a print function\n            print_controller(&amp;cont, nSwitch);\n        }\n        if(strcmp(command[0], \"exit\") == 0){\n            //TODO: Make a print function\n            print_controller(&amp;cont, nSwitch);\n            exit(0);\n        }   \n        continue;   \n    }\n\n    /* Check the incoming FIFOS from the controller an attached switches */\n    /*If something happened on the controller socket,\n      then its an incomming connection. Accept new communitcation.Wait for a client to connect.\n      Recieve packets sent to the controller_sock\n      */\n\n    if(FD_ISSET(controller_sock, &amp;sockSet)){\n\n        clnSocket = AcceptTCPConnection(controller_sock);\n        if(send(clnSocket, message, sizeof(message), 0) != sizeof(message)){\n            fprintf(stderr, \"Send()\");\n            exit(0);\n        }\n        puts(\"Welcome message sent successfuly\");\n\n        //PROBELM HERE BELOW!!!!!!! Returns error code 107 because the \n          socket disconnected.\n        recv(controller_sock, &amp;recv_message, sizeof(recv_message), 0);\n        printf(\"This is my recv_message: %s\\n\", recv_message);\n\n        /*add new socket to array of sockets*/\n        for(int a = 0; a &lt; nSwitch; a++){\n            /*if position is empty */\n            if(client_socket[a] == 0){\n                client_socket[a] = clnSocket;\n                printf(\"Adding to list of sockets as %d\\n\", client_socket[a]);  \n                break;  \n            }\n        }                           \n    }\n\n    /* Communicate with the sockets and handle TCP Client */\n    for(int z = 0; z &lt;nSwitch; z++){\n        sd = client_socket[z];\n        /*Check if it was socket closed, and do other stuff */\n        if(FD_ISSET(sd ,&amp;sockSet )){\n            getpeername(sd , (struct sockaddr*)&amp;address , (socklen_t*)&amp;addrlen); \n            printf(\"Host disconnected , ip %s , port %d \\n\" , inet_ntoa(address.sin_addr) , ntohs(address.sin_port));    \n            close( sd );   \n                        client_socket[z] = 0;\n        }else{\n            //Do stuff for the client        \n            printf(\"This is the client %d\\n\", sd);\n        }\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<hr>\n\n<p>These are the controllers functions: Assign a port to socket,Set socket to listen</p>\n\n<pre><code>int AcceptTCPConnection(int servSock){\n   int clntSock;                   /* Socket descriptor for client */\n   unsigned int clientAddressLen;   /* sizeof(client_address); Length of client */\n   struct sockaddr_in cli_addr; /* Client address */\n\n   /* Set the size of the in-out parameter */\n   clientAddressLen = sizeof(cli_addr);\n   printf(\"ClientAddressLen: %x\\n\", clientAddressLen);\n   /* Wait for a client to connect */\n   if ((clntSock = accept(servSock, (struct sockaddr *) &amp;cli_addr,  \n   &amp;clientAddressLen)) &lt; 0){\n         fprintf(stderr, \"ERROR: accept failed\\n\");\n         exit(0);\n    }\n   /* clntSock is connected to a client! */\n   //infrom user of socket number used in send and receive commands\n   printf(\"Handling client %s\\n\", inet_ntoa(cli_addr.sin_addr));\n   printf(\"New connection: socket fd is: %d, ip is: %s, port: %d\\n\\n\", \n   clntSock, inet_ntoa(cli_addr.sin_addr), ntohs(cli_addr.sin_port));\nreturn clntSock;\n</code></pre>\n\n<p>}</p>\n\n<hr>\n\n<p>Create a TCP socket</p>\n\n<pre><code>int CreateTCPServerSocket(unsigned short port){\n   int sock; /* socket to create */\n   struct sockaddr_in servAddr; /* Local address */\n\n   /* Create socket for incoming connections */\n     if ((sock =  socket(AF_INET, SOCK_STREAM, 0)) &lt; 0){\n       fprintf(stderr,\"ERROR: socket() failed\\n\");\n       exit(0);\n     }\n\n  /* Construct local address structure */\n  /* Define the server address */\n //bzero((char *) &amp;server_address, sizeof(server_address));\n\n    memset(&amp;servAddr, 0, sizeof(servAddr));   /* Zero out structure */\n    servAddr.sin_family = AF_INET;                /* Internet address family \n   */\n    servAddr.sin_addr.s_addr = htonl(INADDR_ANY); /* Any incoming interface \n  */\n    servAddr.sin_port = htons(port);              /* Local port */\n\n    /* Bind to the local address */\n    printf(\"New connection:  ip is: %s, port: %d\\n\\n\", \n    inet_ntoa(servAddr.sin_addr), ntohs(servAddr.sin_port));\n\n    if (bind(sock, (struct sockaddr *) &amp;servAddr, sizeof(servAddr)) &lt; 0){\n        printf(\"Error code: %d\\n\", errno);\n        fprintf(stderr,\"ERROR: bind() just failed\\n\");\n        exit(0);\n    }\n    /* Mark the socket so it will listen for incoming connections */\n    if (listen(sock, 5) &lt; 0){\n       fprintf(stderr,\"ERROR: listen() failed\\n\");\n       exit(0);\n    }\n    return sock;\n }\n</code></pre>\n"}, {"tags": ["c", "boolean", "compiler-optimization", "boolean-logic"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 5, "creation_date": 1542822719, "post_id": 53417868, "comment_id": 93710075, "body": "&quot;I tried compiling this program with both GCC and C99.&quot; - What do you mean? GCC is a compiler and C99 is a standard."}, {"owner": {"reputation": 12499, "user_id": 304706, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4931eceec58528529fd004e56af197c4?s=128&d=identicon&r=PG", "display_name": "ndbroadbent", "link": "https://stackoverflow.com/users/304706/ndbroadbent"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1542823106, "post_id": 53417868, "comment_id": 93710255, "body": "Sorry I just mean I used both <code>gcc</code> and <code>c99</code> on the command line. So the default for <code>gcc</code> is apparently <code>-std=gnu90</code>, and calling <code>&#47;usr&#47;bin&#47;c99</code> sets <code>-std=c99</code>. I updated my question to refer to the standards instead of the command-line tools I was running."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1542823421, "post_id": 53417868, "comment_id": 93710410, "body": "What is the assembly output then?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 4, "creation_date": 1542823432, "post_id": 53417868, "comment_id": 93710418, "body": "if <code>bool1</code> is true, you&#39;re comparing to another value when you could just bail out with a single test. I guess it depends on the stats of the outcome of the booleans."}, {"owner": {"reputation": 12499, "user_id": 304706, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4931eceec58528529fd004e56af197c4?s=128&d=identicon&r=PG", "display_name": "ndbroadbent", "link": "https://stackoverflow.com/users/304706/ndbroadbent"}, "edited": false, "score": 0, "creation_date": 1542823537, "post_id": 53417868, "comment_id": 93710465, "body": "@DavidSchwartz I tried all of the different optimization options (from -O0 to -O3). I have added the output from <code>objdump</code> to my GitHub repo: <a href=\"https://github.com/ndbroadbent/gcc_experiments\" rel=\"nofollow noreferrer\">github.com/ndbroadbent/gcc_experiments</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1542824449, "post_id": 53417868, "comment_id": 93710825, "body": "Your latest edit modifies the apparent question to be about details of the cost of specific assembly instructions.  I didn&#39;t think that was where you were aiming, but if that&#39;s where you really want to go, then this question is a <a href=\"https://stackoverflow.com/questions/692718/how-many-cpu-cycles-are-needed-for-each-assembly-instruction\">dupe</a>."}, {"owner": {"reputation": 12499, "user_id": 304706, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4931eceec58528529fd004e56af197c4?s=128&d=identicon&r=PG", "display_name": "ndbroadbent", "link": "https://stackoverflow.com/users/304706/ndbroadbent"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1542826265, "post_id": 53417868, "comment_id": 93711604, "body": "@JohnBollinger You&#39;re right, that wasn&#39;t really where I wanted to go. I saw that other question and answers, but they didn&#39;t really answer my question."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1542826502, "post_id": 53417868, "comment_id": 93711742, "body": "@ndbroadbent, at this point, then, I think you&#39;re better off accepting an answer and then asking a new question about what you really want to know.  As you&#39;re probably aware, changing the question out from under existing answers is not well received around here."}, {"owner": {"reputation": 12499, "user_id": 304706, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4931eceec58528529fd004e56af197c4?s=128&d=identicon&r=PG", "display_name": "ndbroadbent", "link": "https://stackoverflow.com/users/304706/ndbroadbent"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1542826613, "post_id": 53417868, "comment_id": 93711794, "body": "@JohnBollinger Hmm, so far none of the answers really explain why this optimization isn&#39;t being used. I&#39;ve just performed some benchmarks and <code>a &lt; b</code> is usually a bit faster than <code>!a &amp;&amp; b</code> for random data."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1542826768, "post_id": 53417868, "comment_id": 93711868, "body": "I think @n.m.&#39;s answer is actually pretty clear on that: the optimization is not performed because the compiler thinks the version it does emit is better.  Whether it turns out to be right about that is likely to be context and hardware dependent."}, {"owner": {"reputation": 12499, "user_id": 304706, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4931eceec58528529fd004e56af197c4?s=128&d=identicon&r=PG", "display_name": "ndbroadbent", "link": "https://stackoverflow.com/users/304706/ndbroadbent"}, "edited": false, "score": 0, "creation_date": 1542826823, "post_id": 53417868, "comment_id": 93711897, "body": "Ok good point, I will accept that answer then."}], "answers": [{"comments": [{"owner": {"reputation": 12499, "user_id": 304706, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4931eceec58528529fd004e56af197c4?s=128&d=identicon&r=PG", "display_name": "ndbroadbent", "link": "https://stackoverflow.com/users/304706/ndbroadbent"}, "edited": false, "score": 0, "creation_date": 1542825637, "post_id": 53418529, "comment_id": 93711301, "body": "Haha awesome, that was a great way to show that the compiler knows they are equivalent. Thanks!"}, {"owner": {"reputation": 12499, "user_id": 304706, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4931eceec58528529fd004e56af197c4?s=128&d=identicon&r=PG", "display_name": "ndbroadbent", "link": "https://stackoverflow.com/users/304706/ndbroadbent"}, "edited": false, "score": 0, "creation_date": 1542827009, "post_id": 53418529, "comment_id": 93711999, "body": "I should also point out that GCC 8.2 doesn&#39;t make this optimization, but clang/llvm seems to be smarter and knows that they are equivalent."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1542827154, "post_id": 53418529, "comment_id": 93712078, "body": "Linking to an off-site resource without explaining it in the answer is not good for Stack Overflow."}, {"owner": {"reputation": 12499, "user_id": 304706, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4931eceec58528529fd004e56af197c4?s=128&d=identicon&r=PG", "display_name": "ndbroadbent", "link": "https://stackoverflow.com/users/304706/ndbroadbent"}, "edited": false, "score": 0, "creation_date": 1542827161, "post_id": 53418529, "comment_id": 93712084, "body": "Really interesting that it still uses the <code>jne</code> and <code>je</code> instructions for my original code, even if I change it to <code>a &lt; b</code>: <a href=\"https://godbolt.org/z/bUfgEd\" rel=\"nofollow noreferrer\">godbolt.org/z/bUfgEd</a> On my CPU that&#39;s actually a little bit slower than the single <code>cmp</code> instruction."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1542829853, "post_id": 53418529, "comment_id": 93713305, "body": "that answer could include the snippets directly as well. Else it&#39;s link only even if it&#39;s good"}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 7, "last_activity_date": 1542874245, "last_edit_date": 1542874245, "creation_date": 1542825308, "answer_id": 53418529, "question_id": 53417868, "link": "https://stackoverflow.com/questions/53417868/why-doesnt-the-c99-compiler-optimize-a-b-as-a-b-for-booleans/53418529#53418529", "title": "Why doesn&#39;t the C99 compiler optimize &quot;!a &amp;&amp; b&quot; as &quot;a &lt; b&quot; for booleans?", "body": "<p>Compilers are well aware of the eqivalence and are able to optimise based on it. Their idea of what should be optimised to what might be <a href=\"https://godbolt.org/z/nDrBiD\" rel=\"nofollow noreferrer\">opposite from yours</a> though.</p>\n\n<p>For sake of completeness, here's the clang-produced assembly output of a function that does <code>!a &amp;&amp; b</code> and also of a function that does \u201ca &lt; b\u201d. It's the same assembly output in both cases.</p>\n\n<pre><code>    mov     eax, edi\n    not     al\n    and     al, sil\n    ret\n</code></pre>\n"}], "owner": {"reputation": 12499, "user_id": 304706, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4931eceec58528529fd004e56af197c4?s=128&d=identicon&r=PG", "display_name": "ndbroadbent", "link": "https://stackoverflow.com/users/304706/ndbroadbent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 1, "accepted_answer_id": 53418529, "answer_count": 1, "score": 3, "last_activity_date": 1542874245, "creation_date": 1542822450, "last_edit_date": 1542826241, "question_id": 53417868, "link": "https://stackoverflow.com/questions/53417868/why-doesnt-the-c99-compiler-optimize-a-b-as-a-b-for-booleans", "title": "Why doesn&#39;t the C99 compiler optimize &quot;!a &amp;&amp; b&quot; as &quot;a &lt; b&quot; for booleans?", "body": "<p>I saw <a href=\"https://twitter.com/chordbug/status/1064932667089670144\" rel=\"nofollow noreferrer\">this really interesting tweet</a>:</p>\n\n<blockquote>\n  <p>resisting my code golf instinct to turn <code>if(!bool1 &amp;&amp; bool2)</code> into <code>if(bool1&lt;bool2)</code></p>\n</blockquote>\n\n<p>I had never seen that before, so I wanted to see if compilers would also use this optimization. I started a repo with a README and a test C program: <a href=\"https://github.com/ndbroadbent/gcc_experiments\" rel=\"nofollow noreferrer\">https://github.com/ndbroadbent/gcc_experiments</a></p>\n\n<p>Here is the test program:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n\nint main(int argc, const char* argv[]) {\n  if(argc != 3) {\n    printf(\"Usage: %s &lt;a&gt; &lt;b&gt;\\n\", argv[0]);\n    exit(1);\n  }\n  bool a = strtol(argv[1], NULL, 10) != 0;\n  bool b = strtol(argv[2], NULL, 10) != 0;\n\n  if (!a &amp;&amp; b) {\n    printf(\"!a &amp;&amp; b == true (a: %d, b: %d)\\n\", a, b);\n  } else {\n    printf(\"!a &amp;&amp; b == false (a: %d, b: %d)\\n\", a, b);\n  }\n}\n</code></pre>\n\n<p>I tried compiling this program with both the <code>gnu90</code> and <code>C99</code> standards. I know C99 has a <code>bool</code> type, but is that still treated like an integer, so the compiler can't make any optimizations based on boolean logic?</p>\n\n<p>I might be reading the assembly wrong, but it looks like C99 with <code>-O3</code> is also including <code>jne</code> and <code>je</code> instructions, instead of just using one \"less than\" operation and a single jump instruction. It looks like C++ doesn't make this optimization either.</p>\n"}, {"tags": ["c", "pointers", "swap"], "comments": [{"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 1, "creation_date": 1542822256, "post_id": 53417793, "comment_id": 93709835, "body": "Your compiler probably already told you. If not, try enabling warning messages."}, {"owner": {"reputation": 11, "user_id": 10687279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7448019609e074c05683ac36733e730?s=128&d=identicon&r=PG&f=1", "display_name": "cuckcuc", "link": "https://stackoverflow.com/users/10687279/cuckcuc"}, "reply_to_user": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 0, "creation_date": 1542822293, "post_id": 53417793, "comment_id": 93709853, "body": "Yes but why I can&#39;t do     temp = &amp;a ?"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1542822340, "post_id": 53417793, "comment_id": 93709874, "body": "cos they&#39;re different data types"}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 1, "creation_date": 1542822341, "post_id": 53417793, "comment_id": 93709876, "body": "That makes <code>temp</code> a pointer to a pointer, which makes no sense. Try <code>int temp=*a; *a=*b; *b=temp;</code>"}, {"owner": {"reputation": 11, "user_id": 10687279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7448019609e074c05683ac36733e730?s=128&d=identicon&r=PG&f=1", "display_name": "cuckcuc", "link": "https://stackoverflow.com/users/10687279/cuckcuc"}, "edited": false, "score": 0, "creation_date": 1542822417, "post_id": 53417793, "comment_id": 93709908, "body": "ah, you say this because a is already a pointer ?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10687279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7448019609e074c05683ac36733e730?s=128&d=identicon&r=PG&f=1", "display_name": "cuckcuc", "link": "https://stackoverflow.com/users/10687279/cuckcuc"}, "edited": false, "score": 0, "creation_date": 1542822544, "post_id": 53417861, "comment_id": 93709982, "body": "I see. So &amp;a doesn&#39;t exist ? a is the adress so &amp;a is what ?"}, {"owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "reply_to_user": {"reputation": 11, "user_id": 10687279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7448019609e074c05683ac36733e730?s=128&d=identicon&r=PG&f=1", "display_name": "cuckcuc", "link": "https://stackoverflow.com/users/10687279/cuckcuc"}, "edited": false, "score": 0, "creation_date": 1542822715, "post_id": 53417861, "comment_id": 93710073, "body": "The address of the pointer variable. It&#39;s called a double pointer (int**)."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 11, "user_id": 10687279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7448019609e074c05683ac36733e730?s=128&d=identicon&r=PG&f=1", "display_name": "cuckcuc", "link": "https://stackoverflow.com/users/10687279/cuckcuc"}, "edited": false, "score": 0, "creation_date": 1542842045, "post_id": 53417861, "comment_id": 93717915, "body": "@cuckcuc <code>&amp;a</code> does exist but it is not relevant to your problem. You want to change the value of the location <code>a</code> is pointing to"}], "tags": [], "owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "is_accepted": false, "score": 3, "last_activity_date": 1542822435, "creation_date": 1542822435, "answer_id": 53417861, "question_id": 53417793, "link": "https://stackoverflow.com/questions/53417793/c-swapping-two-pointer-value/53417861#53417861", "title": "C: swapping two pointer value", "body": "<p><code>temp</code> is a pointer. What you want is an <code>int</code> to take the value of what <code>a</code> is pointing to. You need to change <code>temp</code> to an <code>int</code>.</p>\n\n<pre><code>void swap(int *a, int *b)\n{\n    int temp;\n    temp = *a;\n\n    *a = *b;\n    *b = *temp;\n}\n</code></pre>\n\n<p>You may want to follow a few tutorials on C to understand how pointers work. It's a bit much to explain over a Stack Overflow answer with the multitude of resources available online and in books.</p>\n"}], "owner": {"reputation": 11, "user_id": 10687279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7448019609e074c05683ac36733e730?s=128&d=identicon&r=PG&f=1", "display_name": "cuckcuc", "link": "https://stackoverflow.com/users/10687279/cuckcuc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1542823985, "creation_date": 1542822105, "last_edit_date": 1542822344, "question_id": 53417793, "link": "https://stackoverflow.com/questions/53417793/c-swapping-two-pointer-value", "title": "C: swapping two pointer value", "body": "<p>I would like to swap the value of 2 integers using pointers.</p>\n\n<pre><code>void swap(int *a, int *b)\n{\n    int *temp;\n    temp = &amp;a;\n\n    *a = *b;\n    *b = *temp;\n}\n</code></pre>\n\n<p>why this doesn't work ?</p>\n\n<p>error given: </p>\n\n<pre><code>incompatible pointer types initializing 'int *' with an expression of type 'int **'\n</code></pre>\n"}, {"tags": ["c", "audio", "wav", "binary-data", "pcm"], "answers": [{"comments": [{"owner": {"reputation": 461, "user_id": 5341832, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b0158f37895234319da3bda7fe33978b?s=128&d=identicon&r=PG&f=1", "display_name": "Sandrocottus", "link": "https://stackoverflow.com/users/5341832/sandrocottus"}, "edited": false, "score": 0, "creation_date": 1543333667, "post_id": 53432746, "comment_id": 93875931, "body": "Hi @42LeapsOfFaith. I have been playing a lot with my data, trying to convert it (strtoll(), atoi() etc.). However, I am still not able to get what you meant. Could you please elaborate a bit on how should I modify the data before copying it to to my .wav file?"}, {"owner": {"reputation": 136, "user_id": 6412806, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fSC3n.png?s=128&g=1", "display_name": "42LeapsOfFaith", "link": "https://stackoverflow.com/users/6412806/42leapsoffaith"}, "reply_to_user": {"reputation": 461, "user_id": 5341832, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b0158f37895234319da3bda7fe33978b?s=128&d=identicon&r=PG&f=1", "display_name": "Sandrocottus", "link": "https://stackoverflow.com/users/5341832/sandrocottus"}, "edited": false, "score": 0, "creation_date": 1543366607, "post_id": 53432746, "comment_id": 93890775, "body": "The answer is in your &quot;.wav file in hex editor&quot; image. The data from your infile is in the wrong format - it is ascii-hex format (string). You need to convert it back to hex (int) before you use it (i.e. &quot;A5&quot; &gt; 0xA5). Or, store it in the infile with the correct format first... I hope this helps."}, {"owner": {"reputation": 136, "user_id": 6412806, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fSC3n.png?s=128&g=1", "display_name": "42LeapsOfFaith", "link": "https://stackoverflow.com/users/6412806/42leapsoffaith"}, "reply_to_user": {"reputation": 461, "user_id": 5341832, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b0158f37895234319da3bda7fe33978b?s=128&d=identicon&r=PG&f=1", "display_name": "Sandrocottus", "link": "https://stackoverflow.com/users/5341832/sandrocottus"}, "edited": false, "score": 0, "creation_date": 1543402405, "post_id": 53432746, "comment_id": 93904230, "body": "char c[1];  while((n = fread(&amp;c[0], 2, 1, fin)) &gt; 0) {     if (c[0] &gt; 0x39) c[0] -= 7;     c[0] &amp;= 0x0F;     if (c[1] &gt; 0x39) c[1] -= 7;     c[1] &amp;= 0x0F;     c[0] |= c[1] &lt;&lt; 4;       if(n != fwrite(&amp;c[0], 1, 1, fout))"}, {"owner": {"reputation": 136, "user_id": 6412806, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fSC3n.png?s=128&g=1", "display_name": "42LeapsOfFaith", "link": "https://stackoverflow.com/users/6412806/42leapsoffaith"}, "reply_to_user": {"reputation": 461, "user_id": 5341832, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b0158f37895234319da3bda7fe33978b?s=128&d=identicon&r=PG&f=1", "display_name": "Sandrocottus", "link": "https://stackoverflow.com/users/5341832/sandrocottus"}, "edited": false, "score": 0, "creation_date": 1543547329, "post_id": 53432746, "comment_id": 93967469, "body": "Why is &quot;filler.pcm = 3; // WAVE_FORMAT_IEEE_FLOAT (3).&quot; when you are are writing INT. Your number of channels, and number of bits are unclear... Do you know the endian&#39;ness of your data?"}], "tags": [], "owner": {"reputation": 136, "user_id": 6412806, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fSC3n.png?s=128&g=1", "display_name": "42LeapsOfFaith", "link": "https://stackoverflow.com/users/6412806/42leapsoffaith"}, "is_accepted": true, "score": 2, "last_activity_date": 1543444240, "last_edit_date": 1543444240, "creation_date": 1542895597, "answer_id": 53432746, "question_id": 53417630, "link": "https://stackoverflow.com/questions/53417630/creating-a-wav-file-from-pcm-data/53432746#53432746", "title": "Creating a .wav file from PCM data", "body": "<p>For starters, you are storing the PCM data in the file as ascii-hex. I hope that helps.</p>\n\n<p>This is a 'hack' you can use...</p>\n\n<pre><code>char c[2];\nwhile((n = fread(&amp;c[0], 2, 1, fin)) &gt; 0)\n { \n    if (c[0] &gt; 0x39) c[0] -= 7;\n    c[0] &amp;= 0x0F;\n    if (c[1] &gt; 0x39) c[1] -= 7;\n    c[1] &amp;= 0x0F;\n    c[1] |= c[0] &lt;&lt; 4;\n    if(1 != fwrite(&amp;c[1], 1, 1, fout))\n</code></pre>\n"}], "owner": {"reputation": 461, "user_id": 5341832, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b0158f37895234319da3bda7fe33978b?s=128&d=identicon&r=PG&f=1", "display_name": "Sandrocottus", "link": "https://stackoverflow.com/users/5341832/sandrocottus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1425, "favorite_count": 0, "accepted_answer_id": 53432746, "answer_count": 1, "score": 0, "last_activity_date": 1543444240, "creation_date": 1542821382, "last_edit_date": 1543396244, "question_id": 53417630, "link": "https://stackoverflow.com/questions/53417630/creating-a-wav-file-from-pcm-data", "title": "Creating a .wav file from PCM data", "body": "<p>I am trying to read the data from SPH0645LM4H-B <a href=\"https://www.knowles.com/docs/default-source/model-downloads/sph0645lm4h-b-datasheet-rev-c.pdf?sfvrsn=4\" rel=\"nofollow noreferrer\">https://www.knowles.com/docs/default-source/model-downloads/sph0645lm4h-b-datasheet-rev-c.pdf?sfvrsn=4</a>\nand convert it to .wav format, so that I can verify whether my sensor is working correctly.\nSo far, I have managed to interface the sensor and read data samples via i2s-dma transfer.</p>\n\n<p>Also, I found that <em>most mainstream computer soundfile formats consist of a header (containing the length, etc.) followed by 16-bit <strong>two's-complement PCM</em></strong> <a href=\"https://www.dsprelated.com/freebooks/mdft/Number_Systems_Digital_Audio.html\" rel=\"nofollow noreferrer\">https://www.dsprelated.com/freebooks/mdft/Number_Systems_Digital_Audio.html</a></p>\n\n<p>For converting the PCM data to wave format, I have referred <a href=\"https://stackoverflow.com/questions/19897879/converting-pcm-to-wav-file\">converting PCM to wav file</a></p>\n\n<p>Now, the sensor  data format is <em>I2S, 24-bit, 2\u2019s compliment, MSB first. The data precision is 18 bits; unused bits are</em> zeros.\nI have converted the sensor data to 32-bit (MSB is the sign bit)</p>\n\n<p>I have used the code from the following link (and the links mentioned in it) to create the .wav file:-\n<a href=\"https://stackoverflow.com/questions/48098254/append-pcm-audio-raw-data-into-wav-in-c?rq=1\">Append .pcm audio raw data into wav (in C)</a></p>\n\n<p>//.wav file header data</p>\n\n<pre><code>struct wavfile\n{\nchar            id[4];          // should always contain \"RIFF\"\nint             totallength;    // total file length minus 8\nchar            wavefmt[8];     // should be \"WAVEfmt \"\nint             format;         // 16 for PCM format\nshort           pcm;            // WAVE_FORMAT_IEEE_FLOAT (3).\nshort           channels;       // channels\nint             frequency;      // sampling frequency, 16000 in this case\nint             bytes_per_second;\nshort           bytes_by_capture;\nshort           bits_per_sample;\nchar            data[4];        // should always contain \"data\"\nint             bytes_in_data;\n};\n</code></pre>\n\n<p>//Writing the header to output .wav file</p>\n\n<pre><code>void write_wav_header(char* name, int samples, int channels)\n{\nstruct wavfile filler;\nFILE *pFile;\nstrcpy(filler.id, \"RIFF\");\nfiller.totallength = (samples * channels) + sizeof(struct wavfile) - 8;\nstrcpy(filler.wavefmt, \"WAVEfmt \");\nfiller.format = 16;\nfiller.pcm = 3; // WAVE_FORMAT_IEEE_FLOAT (3).\nfiller.channels = channels;\nfiller.frequency = 32000;\nfiller.bits_per_sample = 32;\nfiller.bytes_per_second = filler.channels * filler.frequency * filler.bits_per_sample/8;\nfiller.bytes_by_capture = filler.channels*filler.bits_per_sample/8;\nfiller.bytes_in_data = samples * filler.channels * filler.bits_per_sample/8;\nstrcpy(filler.data, \"data\");\npFile = fopen(name, \"wb\");\nfwrite(&amp;filler, 1, sizeof(filler), pFile);\nfclose(pFile);\n}\n</code></pre>\n\n<p>//Appending the audio sensor data to this .wav file</p>\n\n<pre><code>void write_pcm_data_to_file(char* inFile, char* outFile)\n{\nchar buffer[SAMPLE_SIZE];\nsize_t n;\nFILE *fin,*fout;\nfin = fopen(inFile,\"r\");\nfout = fopen(outFile,\"a\");\nwhile((n = fread(buffer, 1, sizeof(buffer), fin)) &gt; 0)\n{\n    if(n != fwrite(buffer, 1, n, fout))\n    {\n        perror(\"fwrite\");\n        exit(1);\n    }\n}\nfclose(fin);\nfclose(fout);\n}\n</code></pre>\n\n<p>This is how the resulting .wav file looks in hex editor:-\n<a href=\"https://i.stack.imgur.com/G0s5N.jpg\" rel=\"nofollow noreferrer\">.wav file in hex editor</a>\nI can see that the wav header values are set correctly, followed by my PCM data from Audio Sensor.</p>\n\n<p>However, when I play the .wav file, I am not able to play the input audio. Instead, I hear a constant tone.\nI tried changing the input audio (played different music, songs), yet the resulting .wav file plays the same constant tone.</p>\n\n<p>In order to recreate the input music played to the microphone into a wav file, what modifications should I do?</p>\n\n<p>Thanks in advance.</p>\n\n<p><strong><em>Edit:-</em></strong></p>\n\n<p>According to 42LeapsOfFaith 's answer, to convert my samples to hex, I used the following code:-</p>\n\n<pre><code>hexValue = strtoll(sample, NULL, 16);\n</code></pre>\n\n<p>I converted each value in the buffer, then wrote it into my .wav file. Now my .wav file looks like <a href=\"https://i.stack.imgur.com/3mBiQ.jpg\" rel=\"nofollow noreferrer\">modified .wav file in hex editor</a></p>\n\n<p>However, even this wav file does not play the audio.\nAny further suggestions to recreate the input music played to the microphone into a wav file?</p>\n\n<p><strong><em>Help is very much appreciated</em></strong></p>\n"}, {"tags": ["c", "ascii"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1542821738, "post_id": 53417590, "comment_id": 93709595, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/20756626/11683\">C- why char c=129 will convert into -127?</a>"}, {"owner": {"reputation": 43029, "user_id": 7505395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4t4nq.jpg?s=128&g=1", "display_name": "Patrick Artner", "link": "https://stackoverflow.com/users/7505395/patrick-artner"}, "edited": false, "score": 0, "creation_date": 1542821924, "post_id": 53417590, "comment_id": 93709688, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/20756626/c-why-char-c-129-will-convert-into-127\">C- why char c=129 will convert into -127?</a>"}, {"owner": {"reputation": 29, "user_id": 10634243, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Franco Bosi", "link": "https://stackoverflow.com/users/10634243/franco-bosi"}, "edited": false, "score": 0, "creation_date": 1542823314, "post_id": 53417590, "comment_id": 93710363, "body": "I read the comment of the possible duplicate, but I&#39;m still in doubt. If I try to printf(&quot;%c&quot;,a) will output the character &#231;, so the char a yields effectively the value 128 something that only unsigned char could represent and basically the overflow is managed not to assign a negative value to the variable but converting it to an unsigned char?"}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1542830696, "post_id": 53417590, "comment_id": 93713673, "body": "This seems like a general question about character encodings that use code unit values in the range 128 to 255. The ASCII character encoding is not one of them. Also, &#231; is not even in the ASCII character set."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10634243, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Franco Bosi", "link": "https://stackoverflow.com/users/10634243/franco-bosi"}, "edited": false, "score": 0, "creation_date": 1542823155, "post_id": 53417750, "comment_id": 93710280, "body": "basically, what you are saying is that as we know 8 bit can represent 256 values and so if you assign 128 to a signed char, even if the range is up to 127, C will manage the overflow, assuming that could be represented as unsigned char and be effectively the value 128?"}, {"owner": {"reputation": 33, "user_id": 10622587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/392b7c3ceacbb3df8194dec43b8195cc?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewF", "link": "https://stackoverflow.com/users/10622587/andrewf"}, "reply_to_user": {"reputation": 29, "user_id": 10634243, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Franco Bosi", "link": "https://stackoverflow.com/users/10634243/franco-bosi"}, "edited": false, "score": 0, "creation_date": 1542824658, "post_id": 53417750, "comment_id": 93710918, "body": "I&#39;m c#. I mean, probably, compiler just got byte/8bits (nevermind &#39;a&#39; or 128 or -15. and set value at address in memory). and google says char in c++ can be -128/127 or 0/255."}], "tags": [], "owner": {"reputation": 33, "user_id": 10622587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/392b7c3ceacbb3df8194dec43b8195cc?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewF", "link": "https://stackoverflow.com/users/10622587/andrewf"}, "is_accepted": false, "score": -1, "last_activity_date": 1542821936, "creation_date": 1542821936, "answer_id": 53417750, "question_id": 53417590, "link": "https://stackoverflow.com/questions/53417590/c-and-ascii-codes-how-could-128-represents-a-char-if-its-range-is-from-128-to/53417750#53417750", "title": "C and ASCII codes: how could 128 represents a char if it&#39;s range is from -128 to 127?", "body": "<p>signed or unsigned - it takes 8bits. 8bits can contain 256 values. Just question how we use them. </p>\n"}, {"tags": [], "owner": {"reputation": 4991, "user_id": 4340578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75589faf097f9308a448ffe021defd1?s=128&d=identicon&r=PG&f=1", "display_name": "ElderBug", "link": "https://stackoverflow.com/users/4340578/elderbug"}, "is_accepted": false, "score": 2, "last_activity_date": 1542827693, "creation_date": 1542827693, "answer_id": 53419079, "question_id": 53417590, "link": "https://stackoverflow.com/questions/53417590/c-and-ascii-codes-how-could-128-represents-a-char-if-its-range-is-from-128-to/53419079#53419079", "title": "C and ASCII codes: how could 128 represents a char if it&#39;s range is from -128 to 127?", "body": "<p><code>char c = 128;</code> by itself is correct in C. The standard says that a <code>char</code> contains <code>CHAR_BIT</code> bits, which can be greater than 8. Also, a <code>char</code> can be signed or unsigned, implementation defined, and an <code>unsigned char</code> has to contain at least the range [0, 255].</p>\n\n<p>So an implementation where a <code>char</code> is bigger than 8 bits, or the <code>char</code> is unsigned by default, this line is valid and relevant.</p>\n\n<p>Even in a common 8 bit signed <code>char</code> implementation, the expression is still well-defined in how it will convert the <code>128</code> to fit in a <code>char</code>, so there is no problem.</p>\n\n<p>In real cases, the compiler will often issue a warning for these, clang for example :<br>\n<code>warning: implicit conversion from 'int' to 'char' changes value from 128 to -128 [-Wconstant-conversion]</code>.</p>\n"}], "owner": {"reputation": 29, "user_id": 10634243, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Franco Bosi", "link": "https://stackoverflow.com/users/10634243/franco-bosi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 479, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1542827693, "creation_date": 1542821241, "last_edit_date": 1542822295, "question_id": 53417590, "link": "https://stackoverflow.com/questions/53417590/c-and-ascii-codes-how-could-128-represents-a-char-if-its-range-is-from-128-to", "title": "C and ASCII codes: how could 128 represents a char if it&#39;s range is from -128 to 127?", "body": "<p>I'm referring this question because I can't understand how ASCII characters from 0 to 255 can be represented with a signed char if the range of it is from -128 to 127. </p>\n\n<p>Being char = sizeof(char)= 1 byte, it is also reasonable to think that it can easily represent values up to the maximum of 255; </p>\n\n<p>So why the assignment: char a = 128 has nothing wrong and also why shouldn't I use unsigned char for it. </p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1542821128, "post_id": 53417529, "comment_id": 93709325, "body": "Do you realize that it is a pointer to a function?  If not, that&#39;s what it is.  You can now search for the ins and outs of pointers to functions.  If you know it&#39;s a pointer to a function, what&#39;s the problem?  It is presumably used to ensure that elements in the BST are in the correct order \u2014 it compares two nodes given pointers to the nodes, identifying which comes first and which comes second, or that they&#39;re equal."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1542821139, "post_id": 53417529, "comment_id": 93709335, "body": "Get a good book or find a good tutorial, one that explains <i>function pointers</i>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1542821213, "post_id": 53417529, "comment_id": 93709367, "body": "By the way, considering that you <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc/605858#605858\">should not cast <code>malloc</code> in C</a>, the code you found might not be the best to learn from."}], "owner": {"reputation": 41, "user_id": 8186933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NLkyukXKC40/AAAAAAAAAAI/AAAAAAAAAh8/Eo10v1edGoM/photo.jpg?sz=128", "display_name": "Rahul Bhaskar", "link": "https://stackoverflow.com/users/8186933/rahul-bhaskar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542820964, "creation_date": 1542820964, "question_id": 53417529, "link": "https://stackoverflow.com/questions/53417529/explain-this-bst-tree-bst-createint-comparevoid-argu1-void-argu2", "title": "Explain This: BST_TREE* BST_Create(int (*compare)(void* argu1, void* argu2));", "body": "<p>I can't understand the argument, i've seen it for the 1st time.</p>\n\n<p>below is the structure:</p>\n\n<pre><code>typedef struct node{\nvoid* dataPtr;\nstruct node* left;\nstruct node* right;\n}NODE;\n\ntypedef struct{\n    int count;\n    int (*compare)(void* argu1, void* argu2);\n    NODE* root;\n}BST_TREE;\n</code></pre>\n\n<p>This is Prototype:</p>\n\n<pre><code>BST_TREE* BST_Create(int (*compare)(void* argu1, void* argu2));\n</code></pre>\n\n<p>This is Function: </p>\n\n<pre><code>BST_TREE* BST_Create(int (*compare)(void* argu1, void *argu2)){\n    BST_TREE* tree;\n    tree = (BST_TREE*)malloc(sizeof(BST_TREE));\n    if(tree){\n        tree-&gt;root = NULL;\n        tree-&gt;count = 0;\n        tree-&gt;compare = compare;\n    }\n    return tree;\n}\n</code></pre>\n"}, {"tags": ["c", "recursion", "iteration", "global-variables"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1542821832, "post_id": 53417526, "comment_id": 93709639, "body": "Why do you want it recursive? I don&#39;t see any particular reason to do this recursive."}, {"owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "edited": false, "score": 2, "creation_date": 1542821984, "post_id": 53417526, "comment_id": 93709721, "body": "This isn&#39;t really a good problem to try to solve recursively. Recursion is mostly used for nested structures. For example, if you&#39;re searching for a file, you might call a function to scan a directory for it. If that function sees a directory inside of it, the function would call itself to check that directory, too. For a flat array, you&#39;re almost always going to use iteration; a recursive approach usually doesn&#39;t make sense."}, {"owner": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1542822241, "post_id": 53417526, "comment_id": 93709825, "body": "@Broman Unfortunately its an assignment requirement... I didn&#39;t think it made much sense either."}, {"owner": {"reputation": 2427, "user_id": 4983398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc9ed33d775a17d6965fd2efbfe4b52?s=128&d=identicon&r=PG", "display_name": "Gardener", "link": "https://stackoverflow.com/users/4983398/gardener"}, "edited": false, "score": 0, "creation_date": 1542822290, "post_id": 53417526, "comment_id": 93709849, "body": "You first have to come up with an algorithm for the recursion.  I think you are trying to find three squares in a straight line that all have the same value.  So, 1) Check for value of current square, 2) then check recurisvely for value of all adjacent squares, 3) then check value of next adjacent square in the same direction as step 2.  Have you looked at doing it that way?"}, {"owner": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "reply_to_user": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "edited": false, "score": 0, "creation_date": 1542822304, "post_id": 53417526, "comment_id": 93709862, "body": "@contrapants I completely agree, but this is an assignment requirement, so I have to make sure recursion fits into that function."}, {"owner": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "reply_to_user": {"reputation": 2427, "user_id": 4983398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc9ed33d775a17d6965fd2efbfe4b52?s=128&d=identicon&r=PG", "display_name": "Gardener", "link": "https://stackoverflow.com/users/4983398/gardener"}, "edited": false, "score": 0, "creation_date": 1542822436, "post_id": 53417526, "comment_id": 93709922, "body": "@JohnMurray I have, but I also have to handle diagonal situations, so I don&#39;t know how I can go about this. Perhaps I should create a function for diagonal and straight lines? Not sure."}, {"owner": {"reputation": 2427, "user_id": 4983398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc9ed33d775a17d6965fd2efbfe4b52?s=128&d=identicon&r=PG", "display_name": "Gardener", "link": "https://stackoverflow.com/users/4983398/gardener"}, "edited": false, "score": 0, "creation_date": 1542823163, "post_id": 53417526, "comment_id": 93710286, "body": "Yes.  you will need to create a function that will return the adjacent square for a given direction. `int GetIndexOfAdjacentSquare(int startSquare, int direction), where direction is an enum or a mapped list (e.g. 0 = North, 1 = NorthEast, 2 = East, etc.).  You could then call that function for all possible directions.  The function will return the index in that direction, or a 0 index if heading in that direction would take you off the board.  So, your function will figure out what the diagnol square would be from a given location.  Just one way of doing it.  Recursion would pass direction."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1542828102, "post_id": 53417526, "comment_id": 93712488, "body": "@user7823016 If it is an assignment, then please cite the complete requirements. It is extremely common here when people ask for help with homework that someone posts a nice answer and then OP says &quot;oh, but we are not allowed to use X&quot;"}, {"owner": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1542831487, "post_id": 53417526, "comment_id": 93713995, "body": "@Broman that&#39;s just it, the function is not to be hard-coded... like it is now. It just needs to work recursively."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1542912173, "post_id": 53417526, "comment_id": 93747056, "body": "Recursion is rarely the best solution to a problem. The first thing you have to understand about recursion, is that every time the function calls itself, it will re-instantiate a whole new set of parameters and local variables for the new call. Not only this is expensive, it takes up space in the call stack, that has a fixed, limited size, meaning you can only recurse so many times before your application crashes from stack overflow, that names this website. You should not use recursion lightly, it&#39;s a concept that exists and therefore you should know how it works, but it&#39;s very rarely useful."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "edited": false, "score": 0, "creation_date": 1542903927, "post_id": 53421266, "comment_id": 93743663, "body": "Would you be able to show an example? Because if I hard-code arrays I&#39;m not sure how to run through more than 1 recursively, properly."}, {"owner": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "edited": false, "score": 0, "creation_date": 1543253506, "post_id": 53421266, "comment_id": 93842123, "body": "I was mistaken, I&#39;m not sure what to pass to the recTest function, and what satisfies &#39;property&#39; p. Would you be able to explain a bit more? Having trouble connecting the dots."}, {"owner": {"reputation": 2280, "user_id": 1442575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9a74eef0b1c8e998edf3891cb6ed2e?s=128&d=identicon&r=PG", "display_name": "Jorge Adriano", "link": "https://stackoverflow.com/users/1442575/jorge-adriano"}, "reply_to_user": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "edited": false, "score": 1, "creation_date": 1543255620, "post_id": 53421266, "comment_id": 93843077, "body": "@user7823016 Sure. So, that piece of code <code>recTest</code> is meant as an example on the use of recursion to check if any element in an array <code>v</code> of dimension <code>n</code> satisfies a property <code>p</code>.  You want to check if in any of the possible &quot;winning configurations&quot; in the array <code>winpos</code>, matches the current state of your game. Of course you need to adapt the code, in particular should pass the game state as an argument too. But the overall recursion scheme is the same."}, {"owner": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "edited": false, "score": 0, "creation_date": 1543255853, "post_id": 53421266, "comment_id": 93843165, "body": "I truly hate to be a pain, but I don&#39;t know how to fit these pieces together properly. I&#39;m a freshman, and I&#39;m doing my best to learn... but this seems a bit more complicated than I was anticipating. Do you see a clear way to integrate your solution into my (terrible) code? Also, I absolutely appreciate all the help you&#39;ve provided thus far."}, {"owner": {"reputation": 2280, "user_id": 1442575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9a74eef0b1c8e998edf3891cb6ed2e?s=128&d=identicon&r=PG", "display_name": "Jorge Adriano", "link": "https://stackoverflow.com/users/1442575/jorge-adriano"}, "reply_to_user": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "edited": false, "score": 1, "creation_date": 1543264645, "post_id": 53421266, "comment_id": 93847179, "body": "Edited the code with an addapted <code>winnerCheck</code>. It&#39;s almost done now, you should finish yourself though. See also some modifications to your code that may help you organise things better."}, {"owner": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "edited": false, "score": 0, "creation_date": 1543267310, "post_id": 53421266, "comment_id": 93848401, "body": "Thank you Jorge, I wish I could upvote you more. Thank you, truly."}, {"owner": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "edited": false, "score": 0, "creation_date": 1543374456, "post_id": 53421266, "comment_id": 93892465, "body": "as much fun as I&#39;ve been having trying to fill the last piece of the puzzle in... I&#39;m not getting anywhere, and the assignment is far past-due. I&#39;ve tried a myriad of possibilities... you said it should be &quot;squares in positions pos1, pos2 and pos2 marked by same player&quot;, but aren&#39;t the values for nothing also being compared? (It crashes when I try... ` if( (n&gt;0) &amp;&amp; !(square[pos0] == square[pos1] == square[pos2]))` which compares the direct values of each of the 3 positions before it goes through to another recursive call... I&#39;m a first year. and I&#39;m having a heck of a time. I&#39;m sorry Jorge"}, {"owner": {"reputation": 2280, "user_id": 1442575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9a74eef0b1c8e998edf3891cb6ed2e?s=128&d=identicon&r=PG", "display_name": "Jorge Adriano", "link": "https://stackoverflow.com/users/1442575/jorge-adriano"}, "reply_to_user": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "edited": false, "score": 0, "creation_date": 1543420500, "post_id": 53421266, "comment_id": 93915571, "body": "OK so firstly this <code>square[pos0] == square[pos1] == square[pos2]</code> doesn&#39;t work. Rather you want to write <code>square[pos0] == square[pos1] &amp;&amp; square[pos1] == square[pos2]</code>. Secondly indeed this alone isn&#39;t enough because you must also check that they are marked with a player move, and not equally empty."}, {"owner": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "edited": false, "score": 0, "creation_date": 1543424436, "post_id": 53421266, "comment_id": 93917954, "body": "I had tried <code>square[pos0] == square[pos1] &amp;&amp; square[pos1] == square[pos2]</code> but since that doesn&#39;t work, I thought I was just heading in the wrong direction... How can I check for marked contents and not equally empty? How do I go about comparing something like that with variables square, winseq, and n already being used to mark and compare square[] based on positions?"}, {"owner": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "edited": false, "score": 0, "creation_date": 1543448078, "post_id": 53421266, "comment_id": 93927970, "body": "Nevermind Jorge, seems they weren&#39;t accepting the recursion you were helping me with, since the win-conditions were coded in that one array."}, {"owner": {"reputation": 2280, "user_id": 1442575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9a74eef0b1c8e998edf3891cb6ed2e?s=128&d=identicon&r=PG", "display_name": "Jorge Adriano", "link": "https://stackoverflow.com/users/1442575/jorge-adriano"}, "reply_to_user": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "edited": false, "score": 0, "creation_date": 1543452520, "post_id": 53421266, "comment_id": 93928993, "body": "Sorry to hear about that. It does depend on their goal with the problem. Regarding the previous question, guess it doesn&#39;t matter now, but you&#39;d just have to add a condition to check that it&#39;s marked, e.g.,  <code>(square[pos0] == &#39;X&#39; ||  square[pos0] == &#39;O&#39;) &amp;&amp; square[pos0] == square[pos1] &amp;&amp; square[pos1] == square[pos2]</code>"}], "tags": [], "owner": {"reputation": 2280, "user_id": 1442575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9a74eef0b1c8e998edf3891cb6ed2e?s=128&d=identicon&r=PG", "display_name": "Jorge Adriano", "link": "https://stackoverflow.com/users/1442575/jorge-adriano"}, "is_accepted": true, "score": 1, "last_activity_date": 1543264506, "last_edit_date": 1543264506, "creation_date": 1542838945, "answer_id": 53421266, "question_id": 53417526, "link": "https://stackoverflow.com/questions/53417526/how-can-i-convert-my-winnercheck-function-to-work-recursively-c/53421266#53421266", "title": "How can I convert my `winnerCheck` function to work recursively? - C", "body": "<p>The <code>winnerCheck</code> function tests if any of the possible winning conditions is met. And this consists on checking if certain triples are all filed by the same player. </p>\n\n<p>You could hardcode an array with all the triples that guarantee a win. Then checking for a win implies traversing that array, and that can easily be done recursively. </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>So there's 8 possible \"wining positions\" triples, which you could declare for instance as, </p>\n\n<pre><code>const int numwinpos = 8;\n\nconst int winpos[8][3] = {{1,2,3},\n                          {4,5,6},\n                          {7,8,9},\n                          {1,4,7},\n                          {2,5,8},\n                          {3,6,9},\n                          {1,5,9},\n                          {3,5,7}};\n</code></pre>\n\n<p>Regarding the recursive checking procedure here is an example for how to check whether any element of a vector <code>v</code> of size <code>n</code> satisfies a property <code>p</code>. </p>\n\n<pre><code>// returns -1 if no v[i] satisfies p\n// returns  i if v[i] satisfies p (picks largest i)\n// (i&gt;=0) and (i&lt;n)\n\nint recTest(const int v[], const int n){\n\n  if( (n&gt;0) &amp;&amp; (!p(v[n-1])) )\n    return recTest(v,n-1);\n  else\n    return n-1;\n}\n</code></pre>\n\n<p><strong>EDIT2:</strong> </p>\n\n<p>So the <code>winnersCheck</code> can be of the form, </p>\n\n<pre><code>int winnerCheck(char square[], int winseq[][3], int n){\n  // there's n winning sequences to test, 0 .. n-1\n  // let's check sequence n-1\n  int pos0 = winseq[n-1][0];\n  int pos1 = winseq[n-1][1];\n  int pos2 = winseq[n-1][2];\n  if( (n&gt;0) &amp;&amp; !(squares in positions pos1, pos2 and pos2 marked by same player) )\n\n    // game does not contain winning sequence n-1\n    // so test the other n-1 positions, i.e. 0 .. n-2 \n    return winnerCheck(square,winseq,n-1);  \n  else\n    // either n = 0 and there's no more positions to test \n    // or game contains winning sequence n-1 \n    return n-1;\n}\n</code></pre>\n\n<p>Of course the condition you need to fill in may be a bit to large to inline in that if. You may want to organise that differently or define so auxiliary function to do that work. </p>\n\n<p>Also here's some modifications to your main code that show how some of the things you had done could be clearer. </p>\n\n<pre><code>int main() {\n\n  // Game Board: there's 9 squares in the game\n  // 0 1 2\n  // 3 4 5\n  // 6 7 8\n\n  // ' ' represents \"nothing\" in a square\n  char square[9]={' ',' ',' ',' ',' ',' ',' ',' ',' '}; \n\n  // There are 8 possible ways of winning the game\n  int nwinseq = 8;\n  int winseq[8][3] = {{0,1,2},\n                      {3,4,5},\n                      {6,7,8},\n                      {0,3,6},\n                      {1,4,7},\n                      {2,5,8},\n                      {0,4,8},\n                      {2,4,6}};\n\n   // there's player 1 and player 2\n   // player 1 goes first  \n   int player = 1;   \n\n   // current play\n   // at most 9 plays in a game\n   int i = 1;\n\n   // winning sequence\n   // 8 possibilities (0 to 7)\n   // no winning sequence found when game starts\n   int w = -1;\n\n   // execute game until it's over\n   bool gameOver = false;\n\n   while(!gameOver){    \n    // print board  \n    board(square);\n\n    // ask player for his move of choice\n    int choice; \n    printf(\"Player %d, enter a number: \", player);\n    scanf(\"%d\", &amp;choice);\n\n    // change the square according to player's move\n    move(player, square, choice);\n\n    // check for win\n    w = winnerCheck(square, winseq, nwinseq);\n\n    gameOver = (w &gt;= 0) // found winning sequence i\n            || (i == 9); // or made 9 plays already\n\n    // update play number and player\n    // obs: maybe update it only if game is not over\n    // matter of taste\n    i++;\n\n    if (player == 1)\n      player = 2;\n    else // player == 2 \n      player = 1;\n  }\n\n  // Game is over \n  // Print the end result \n  // ...\n}\n</code></pre>\n\n<p>and, </p>\n\n<pre><code>void move(int player, char square[], int choice){\n   if (player == 1)\n    square[choice] = 'X';\n  else\n    square[choice] = 'O';\n}\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 53421266, "answer_count": 1, "score": 1, "last_activity_date": 1543264506, "creation_date": 1542820956, "question_id": 53417526, "link": "https://stackoverflow.com/questions/53417526/how-can-i-convert-my-winnercheck-function-to-work-recursively-c", "title": "How can I convert my `winnerCheck` function to work recursively? - C", "body": "<p><strong>ISSUE:</strong> I'm having a rough time building my understanding of recursion (slow learner), and whenever I'm tasked with creating a <code>recursive</code> function, I always create it through <code>iteration</code> first. </p>\n\n<p>Then I do my best to hit some of the basic rules of recursion, but usually end up feeling a bit burned out. </p>\n\n<p>All I'm trying to do is convert my <code>winnerCheck</code> function to work <code>recursively</code>.</p>\n\n<p>Also, I've heard using <code>global variables</code> was frowned upon. Is this true? Should I move my array <code>square</code> to work locally?</p>\n\n<p>Thanks for any guidance and input you can offer.</p>\n\n<p><strong>CODE:</strong> </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\n\nchar square[10] = {'o', '1', '2', '3', '4', '5', '6', '7', '8', '9'};\n\nint winnerCheck();\n\nvoid board();\n\nint main() {\n\n    /*\n    char board[3][3] = {\n    };\n\n    printf(\"\\t|\\t|\\t\\n\");\n    printf(\"\\t|\\t|\\t\\n\");\n    printf(\"________|_______|________\\n\");\n    printf(\"\\t|\\t|\\t\\n\");\n    printf(\"\\t|\\t|\\t\\n\");\n    printf(\"________|_______|________\\n\");\n    printf(\"\\t|\\t|\\t\\n\");\n    printf(\"\\t|\\t|\\t\\n\");\n    printf(\"\\t|\\t|\\t\\n\");\n\n*/\n\n    int player = 1, i, choice;\n    char mark;\n    do {\n        board();\n        player = player % 2 ? 1 : 2;\n\n        printf(\"Player %d, enter a number: \", player);\n        scanf(\"%d\", &amp;choice);\n\n        //mark = (player == 1) ? 'X' : 'O';\n\n        if (player == 1) {\n            mark = 'X';\n        } else {\n            mark = '0';\n        }\n\n        if (choice == 1)\n            square[1] = mark;\n        else if (choice == 2)\n            square[2] = mark;\n        else if (choice == 3)\n            square[3] = mark;\n        else if (choice == 4)\n            square[4] = mark;\n        else if (choice == 5)\n            square[5] = mark;\n        else if (choice == 6)\n            square[6] = mark;\n        else if (choice == 7)\n            square[7] = mark;\n        else if (choice == 8)\n            square[8] = mark;\n        else if (choice == 9)\n            square[9] = mark;\n\n\n        i = winnerCheck();\n        player++;\n    } while (i == -1);\n    board();\n\n    if (i == 1)\n        printf(\"==&gt;\\aPlayer %d win \", --player);\n    else\n        printf(\"==&gt;\\aGame draw\");\n    getch();\n\n    return 0;\n}\n\nint winnerCheck() {\n    if (square[1] == square[2] &amp;&amp; square[2] == square[3])\n        return 1;\n    else if (square[4] == square[5] &amp;&amp; square[5] == square[6])\n        return 1;\n    else if (square[7] == square[8] &amp;&amp; square[8] == square[9])\n        return 1;\n    else if (square[1] == square[4] &amp;&amp; square[4] == square[7])\n        return 1;\n    else if (square[2] == square[5] &amp;&amp; square[5] == square[8])\n        return 1;\n    else if (square[3] == square[6] &amp;&amp; square[6] == square[9])\n        return 1;\n    else if (square[1] == square[5] &amp;&amp; square[5] == square[9])\n        return 1;\n    else if (square[3] == square[5] &amp;&amp; square[5] == square[7])\n        return 1;\n    else if (square[1] != '1' &amp;&amp; square[2] != '2' &amp;&amp; square[3] != '3' &amp;&amp; square[4]\n                                                                         != '4' &amp;&amp; square[5] != '5' &amp;&amp;\n             square[6] != '6' &amp;&amp; square[7] != '7' &amp;&amp; square[8]\n                                                     != '8' &amp;&amp; square[9] != '9')\n        return 0;\n    else\n        return -1;\n\n}\n\nvoid board() {\n    printf(\"\\n\\n\\tTic Tac Toe\\n\\n\");\n    printf(\"Player 1 (X) - Player 2 (O)\\n\\n\\n\");\n\n//prints the board after every input\n\n    printf(\"    |     |    \\n\");\n    printf(\"  %c |  %c  |  %c  \\n\", square[1], square[2],square[3]);\n    printf(\"____|_____|____\\n\");\n    printf(\"    |     |    \\n\");\n    printf(\"  %c |  %c  |  %c  \\n\", square[4], square[5],square[6]);\n    printf(\"____|_____|____\\n\");\n    printf(\"    |     |    \\n\");\n    printf(\"  %c |  %c  |  %c  \\n\", square[7], square[8],square[9]);\n    printf(\"    |     |    \\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "recursion", "segmentation-fault"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1542819778, "post_id": 53416987, "comment_id": 93708651, "body": "Why do you put <code>count *= count-1;</code> in a loop? What does it compute?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1542819881, "post_id": 53416987, "comment_id": 93708697, "body": "You do not test the return value of <code>malloc()</code>.  My guess would be that you are computing a huge or even negative (because overflow) value in <code>count</code>, <code>malloc()</code> is therefore failing, and you are then attempting to write through the resulting null pointer."}, {"owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1542834139, "post_id": 53416987, "comment_id": 93715128, "body": "Do you use an IDE? Does it have a debugger? Do you know how to use it? It is your best friend and will easilly let you resolve problems like this without having to ask us"}], "answers": [{"tags": [], "owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "is_accepted": true, "score": 1, "last_activity_date": 1542820359, "creation_date": 1542820359, "answer_id": 53417343, "question_id": 53416987, "link": "https://stackoverflow.com/questions/53416987/pair-wise-difference-using-recursion/53417343#53417343", "title": "Pair-wise difference using recursion", "body": "<p>I think your <code>count</code> is wrong. Your second iteration is already humongous.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nsize_t total_allocated = 0;\n\nint iterateIt(int a_count, int* a) {\n    unsigned long long i, j, k;\n    unsigned long long count = a_count;\n\n    for( i = 1 ; i &lt; a_count ; i++ )\n        count *= count-1;\n\n    size_t size = count * sizeof(int);\n    printf(\"Allocating %llu ints: %llu bytes\\n\", count, (unsigned long long)size);\n    total_allocated += size;\n    printf(\"Total allocated: %llu bytes\\n\", (unsigned long long)total_allocated);\n    int *b = (int *) malloc(count * sizeof(int));\n    count = 0;\n    k = 0;\n    for( i = 0 ; i &lt; a_count ; i++ ){\n        for( j = i ; j &lt; a_count ; j++ ){\n            if(a[i] != a[j]){\n                b[k] = abs(a[i] - a[j]);\n                k++;\n            }\n        }\n    }\n\n    if( k &gt; 0){\n        return 1 + iterateIt(k, b);\n    }\n    free(b);\n    return 1;\n}\n\nint main (void)\n{\n    iterateIt(4, (int[4]){1,352,9483,50000});\n    return 0;\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>Allocating 17292 ints: 69168 bytes\nTotal allocated: 69168 bytes\nAllocating 12550317587327992670 ints: 13307782201892867448 bytes\nTotal allocated: 13307782201892936616 bytes\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1542827251, "post_id": 53417698, "comment_id": 93712126, "body": "The convergence is definitely there: at each round the maximal value decreases. I don&#39;t see a reason for a recursive approach though."}], "tags": [], "owner": {"reputation": 32921, "user_id": 5771269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be6a5b618f5bd197150a6186318beba7?s=128&d=identicon&r=PG&f=1", "display_name": "cdlane", "link": "https://stackoverflow.com/users/5771269/cdlane"}, "is_accepted": false, "score": 1, "last_activity_date": 1542833746, "last_edit_date": 1542833746, "creation_date": 1542821690, "answer_id": 53417698, "question_id": 53416987, "link": "https://stackoverflow.com/questions/53416987/pair-wise-difference-using-recursion/53417698#53417698", "title": "Pair-wise difference using recursion", "body": "<p>First consider this line:</p>\n\n<pre><code>return 1 + iterateIt(k, b);\n</code></pre>\n\n<p>The <code>b</code> array never gets freed on this <code>return</code> but if <code>k</code> is zero, it does.  Let's rewrite this code to clean it up a bit:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nunsigned iterateIt(size_t a_count, int *a) {\n\n    unsigned rep = 1;\n\n    int *b = calloc(a_count * a_count, sizeof(int));\n\n    size_t k = 0;\n\n    for (size_t i = 0; i &lt; a_count; i++) {\n        for (size_t j = i + 1; j &lt; a_count; j++) {\n            if (a[i] != a[j]) {\n                b[k++] = abs(a[i] - a[j]);\n            }\n        }\n    }\n\n    if (k &gt; 0) {\n        rep += iterateIt(k, b);\n    }\n\n    free(b);\n\n    return rep;\n}\n\nint main() {\n\n    int x[] = {1, 324, 54};\n\n    printf(\"%u\\n\", iterateIt(sizeof(x) / sizeof(int), x));\n\n    return 0;\n}\n</code></pre>\n\n<p>Watching the value of <code>a_count</code>, the program tries to allocate too much memory and fails.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Since the two halves of the matrix end up identical, I fixed the above code to do what the OP did, just process 1/2 the matrix, i.e. <code>j</code> starts at <code>i + 1</code> since the two halves end up identical.  I also ignore the diagonal as it's always zeros.  Then the code completes for the three numbers in my example code but blows up again when I increase the array to four values.</p>\n\n<p>I believe the recursive nature of the OP's solution is elegant and a non-issue but just to confirm, here's an iterative solution that fails to perform and not due to lack of stack memory:</p>\n\n<pre><code>unsigned iterateIt(size_t a_count, int *a) {\n\n    unsigned rep = 1;\n\n    bool first_time = true;\n\n    while (true) {\n\n        int *b = calloc((a_count * a_count) / 2, sizeof(int));\n\n        if (b == NULL) {\n            perror(\"calloc failed!\");\n            exit(1);\n        }\n\n        size_t b_count = 0;\n\n        for (size_t i = 0; i &lt; a_count; i++) {\n            for (size_t j = i + 1; j &lt; a_count; j++) {\n                if (a[i] != a[j]) {\n                    b[b_count ++] = abs(a[i] - a[j]);\n                }\n            }\n        }\n\n        if (b_count == 0) {\n            free(b);\n            break;\n        }\n\n        if (first_time) {\n            first_time = false;\n        } else {\n            free(a);\n        }\n\n        a = b;\n        a_count = b_count;\n\n        rep++;\n    }\n\n    return rep;\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9223564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wvFoR.png?s=128&g=1", "display_name": "Andrea Foderaro", "link": "https://stackoverflow.com/users/9223564/andrea-foderaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 53417343, "answer_count": 2, "score": 0, "last_activity_date": 1542833746, "creation_date": 1542819179, "question_id": 53416987, "link": "https://stackoverflow.com/questions/53416987/pair-wise-difference-using-recursion", "title": "Pair-wise difference using recursion", "body": "<p>I was asked to translate this pseudo code into a C program:</p>\n\n<pre><code>rep := 0\nwhile A not empty:\n    B := []\n    for x in A, y in A:\n        if x != y: append absolute_value(x - y) to B\n    A := B\n    rep := rep + 1\n</code></pre>\n\n<p>and I end up with this:</p>\n\n<pre><code>int iterateIt(int a_count, int* a) {\n    unsigned long long i, j, k;\n    unsigned long long count = a_count;\n\n    for( i = 1 ; i &lt; a_count ; i++ )\n        count *= count-1;\n\n    int *b = (int *) malloc(count * sizeof(int));\n    count = 0;\n    k = 0;\n    for( i = 0 ; i &lt; a_count ; i++ ){\n        for( j = i ; j &lt; a_count ; j++ ){\n            if(a[i] != a[j]){\n                b[k] = abs(a[i] - a[j]);\n                k++;\n            }\n        }\n    }\n\n    if( k &gt; 0){\n        return 1 + iterateIt(k, b);\n    }\n    free(b);\n    return 1;\n}\n</code></pre>\n\n<p>I used recursion to return the number of iteration of the algorithm. Practically I take the difference between any two different objects of A and put the absolute value in B, on which I recur.\nFor simple input I get the correct result but I don't understand why for input like: \n<code>16</code> <code>1 2 4 8 16 32 64 128 256 512 1024 2048 4096 8192 16384 32768</code>\nor <code>4</code> <code>1 352 9483 50000</code>\n(the first number is the number of element of A)</p>\n\n<p>I get a segmentation fault error. </p>\n\n<p>Thank you for your help</p>\n"}, {"tags": ["c", "server", "message-queue", "lpc"], "answers": [{"tags": [], "owner": {"reputation": 6544, "user_id": 451601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/164602d512ce01f188e5a50593b46c5f?s=128&d=identicon&r=PG", "display_name": "James K. Lowden", "link": "https://stackoverflow.com/users/451601/james-k-lowden"}, "is_accepted": false, "score": 0, "last_activity_date": 1542836263, "creation_date": 1542836263, "answer_id": 53420817, "question_id": 53416805, "link": "https://stackoverflow.com/questions/53416805/contents-in-message-queue-is-changed/53420817#53420817", "title": "Contents in message-queue is changed", "body": "<p>There's too much missing from your code to know definitively what's happening.  I'm placing my bet on either using unallocated memory, or not recognizing a syscall error.  </p>\n\n<p>I'm using LTS 16, and there's no definition on my system for LpcRequest or LPC_REQUEST_SIZE, etc.  You don't show how they're defined, so we don't know for example if <code>pRequest.lpcArgs[1]</code> exists.  </p>\n\n<p>You're also not checking the return code for msgsnd and msgrcv, a sure recipe for endless hours of entertaining debugging.  </p>\n\n<p>I suggest you edit your question to include working code, and a shell script that produces the mysterious result.  Then someone will be able, if willing, to debug it and explain where you went wrong.  </p>\n\n<p>My other suggestion in this area is pretty standard: W. Richard Stevens's books on TCP/IP, specifically <em>Unix Network Programming</em>.  If you're studying this stuff, you'll absolutely be glad to have read it.  </p>\n"}], "owner": {"reputation": 1, "user_id": 9198930, "user_type": "registered", "profile_image": "https://graph.facebook.com/1191156971016848/picture?type=large", "display_name": "\ubc15\uc900\ud654", "link": "https://stackoverflow.com/users/9198930/%eb%b0%95%ec%a4%80%ed%99%94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542836263, "creation_date": 1542818592, "last_edit_date": 1542824244, "question_id": 53416805, "link": "https://stackoverflow.com/questions/53416805/contents-in-message-queue-is-changed", "title": "Contents in message-queue is changed", "body": "<p>I am using uuntu 18.04.1LTS and studying IPC using C. I'm testing Unix i/o using LPC this time, and there's a problem when more than one client connects to the server at the same time.\n(when only one client connected, there is no problem.)</p>\n\n<pre><code>sprintf(s1,\"./%sA\",t);\nsprintf(s2, \"./%sB\", t);\n\nif (MakeDirectory(s1, 0755) == -1) {\n    return -1;\n}\n\nif (MakeDirectory(s2, 0755) == -1) {\n    return -1;\n}\n\n\n\nfor (i = 0; i &lt; 5; i++)\n{\n    memset(dirName, 0, SIZE);\n    sprintf(dirName, \"%s/%d\",s1,i);\n    usleep(300000);\n    if (MakeDirectory(dirName, 0755) == -1) {\n        return -1;\n    }\n}\n</code></pre>\n\n<p>This code is client's main function. There is no problem at the top, but after running the repeat statement once (when i = 1), MakeDirectory() returns -1 with an error.\n(t refers to the pid of the forked process converted into a string.)</p>\n\n<pre><code>int MakeDirectory(char* path, int mode) {\n    memset(&amp;pRequest, 0x00, LPC_REQUEST_SIZE);\n    memset(&amp;pResponse, 0x00, LPC_RESPONSE_SIZE);\n\n    pRequest.pid = getpid();\n    pRequest.service = LPC_MAKE_DIRECTORY;\n    pRequest.numArg = 2;\n    pRequest.lpcArgs[0].argSize = strlen(path);\n    strcpy(pRequest.lpcArgs[0].argData, path);\n    pRequest.lpcArgs[1].argSize = mode;\n\n    msgsnd(rqmsqid, &amp;pRequest, LPC_REQUEST_SIZE, 0);\n    msgrcv(rpmsqid, &amp;pResponse, LPC_RESPONSE_SIZE, getpid(), 0);\n\n    int res = pResponse.responseSize;\n\n    return res;\n}\n</code></pre>\n\n<p>This is client's MakeDirectory, and</p>\n\n<pre><code>int MakeDirectory(LpcRequest* pRequest) {\n    memset(&amp;pResponse, 0x00, LPC_RESPONSE_SIZE);\n\n    char *path = pRequest-&gt;lpcArgs[0].argData;\n    int mode = pRequest-&gt;lpcArgs[1].argSize;\n\n    int res = mkdir(path, mode);\n\n    pResponse.errorno = 0;\n    pResponse.pid = pRequest-&gt;pid;\n\n    printf(\"%ld\\n\", pResponse.pid);\n\n    pResponse.responseSize = res;\n    msgsnd(rpmsqid, &amp;pResponse, LPC_RESPONSE_SIZE, 0);\n\n    return res;\n}\n</code></pre>\n\n<p>This is a function of the server that runs after checking the pRequest.service when the MakeDirectory function is enabled on the client.</p>\n\n<p>Again, there's nothing wrong with having one client, and if there's more than one. I checked with printf(), but the server passes 0 and the client receives -1. I don't know why this happens.</p>\n"}, {"tags": ["c++", "c", "pragma"], "comments": [{"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 24, "creation_date": 1542818431, "post_id": 53416657, "comment_id": 93707855, "body": "<i>Is there even any reason to include a single file multiple times?</i> =&gt; Could be.  A file might have conditional compilation <code>#ifdefs</code> in it.  So you might say <code>#define MODE_ONE 1</code> and then <code>#include &quot;has-modes.h&quot;</code>, and then <code>#undef MODE_ONE</code> with <code>#define MODE_TWO 1</code> and <code>#include &quot;has-modes.h&quot;</code> again.  The preprocessor is agnostic about these kinds of things, and maybe sometimes they can make sense."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 66, "creation_date": 1542818463, "post_id": 53416657, "comment_id": 93707874, "body": "It would make sense as the default.  Just not the one they picked when C programmers still rode horses, carried guns and had 16KB of memory"}, {"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1542818622, "post_id": 53416657, "comment_id": 93707963, "body": "@Fran&#231;oisAndrieux but the duplicate seems to ask same thing about include guards in general not only #pragma once."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 11, "creation_date": 1542818728, "post_id": 53416657, "comment_id": 93708024, "body": "You can include <code>&lt;assert.h&gt;</code> multiple times, with different definitions of <code>NDEBUG</code>, in the same source file."}, {"owner": {"reputation": 969, "user_id": 9119391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91441ccec1aeff26e087429cf3d0b2cd?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Cache", "link": "https://stackoverflow.com/users/9119391/johnny-cache"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1542818844, "post_id": 53416657, "comment_id": 93708098, "body": "@Fran&#231;oisAndrieux Fair enough. That should be more clear."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 3, "creation_date": 1542818890, "post_id": 53416657, "comment_id": 93708132, "body": "As for <code>#pragma once</code> itself, there are hardware environments (typically with networked drives and possible multiple paths to the same header) where it won&#39;t work right."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1542819017, "post_id": 53416657, "comment_id": 93708204, "body": "It would be a breaking change, and would require a new means to disable it - two good reasons not to change."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1542819073, "post_id": 53416657, "comment_id": 93708232, "body": "Y&#39;all answering in comments: the dupe target is still open for answers..."}, {"owner": {"reputation": 374839, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1542819159, "post_id": 53416657, "comment_id": 93708275, "body": "@BaummitAugen: But that question is not asking about <code>#pragma once</code>, so those answers would not be appropriate. It asks about include-guards."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "reply_to_user": {"reputation": 374839, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1542819258, "post_id": 53416657, "comment_id": 93708349, "body": "@NicolBolas All answers in this comment thread appear to apply the exact same way to classical include guards as they do to <code>#pragma once</code> afaict."}, {"owner": {"reputation": 374839, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1542819339, "post_id": 53416657, "comment_id": 93708401, "body": "@BaummitAugen: Irrelevant. The &quot;duplicate&quot; is not asking about <code>#pramga once</code>, so an answer explaining <i>only</i> how <code>#pragma once</code> doesn&#39;t work would be off-topic. Notice how the answer to this question doesn&#39;t talk about include-guards or even the failures of <code>#pragma once</code>; it instead talks about where multiple inclusions are useful. Which would also not be an appropriate answer to the &quot;duplicate&quot;."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1542820075, "post_id": 53416657, "comment_id": 93708793, "body": "@JohnnyCache should I interpret your last comment in a way that you are not really interested in an answer, but rather are trolling and mark your question for moderators as such?"}, {"owner": {"reputation": 969, "user_id": 9119391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91441ccec1aeff26e087429cf3d0b2cd?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Cache", "link": "https://stackoverflow.com/users/9119391/johnny-cache"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1542820177, "post_id": 53416657, "comment_id": 93708861, "body": "@SergeyA I&#39;m very much interested in an answer, but the fact that people keep marking and unmarking it as duplicate is curious as well. In fact, that&#39;s why I&#39;ve commented with that remark, instead of editing it into the question."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1542820586, "post_id": 53416657, "comment_id": 93709055, "body": "I remember multiple inclusion of the same headers being used in <code>c</code> more than we would use it in <code>c++</code>. A compiler would not want to break this usage however."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 12, "creation_date": 1542820820, "post_id": 53416657, "comment_id": 93709176, "body": "If you have <code>#pragma once</code> assumed, what is the way of countermanding that default?  <code>#pragma many</code>?  How many compilers have implemented anything like that?"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1542822372, "post_id": 53416657, "comment_id": 93709893, "body": "@JonathanLeffler That&#39;s not a real argument though. If default <code>#pragma once</code> and an opt-out <code>#pragma many</code> was implementable and considered a good idea to the point that the standard wants it, compilers would implement it. The question here is essentially why that is not happening."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1542824356, "post_id": 53416657, "comment_id": 93710781, "body": "@MaxLanghof: It&#39;s mainly pointing out that changing the default requires a way to ensure that <code>&lt;assert.h&gt;</code> \u2014 to name (once again) the Standard C example of a header that must be includable multiple times in a single TU with (potentially) <i>different</i> effects on each occasion \u2014 continues to work correctly.  Making <code>#pragma once</code> the default probably won&#39;t happen because it would disrupt working code, and there are already other workable alternatives available within the standard.  One day, maybe, there might be <code>#pragma STDC once</code> \u2014 which would nominally be the way it would be standardized."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 2, "creation_date": 1542824933, "post_id": 53416657, "comment_id": 93711018, "body": "TL;DR because the C++ build system is an ancient joke and programmers have come to depend on its quirks"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1542827618, "post_id": 53416657, "comment_id": 93712278, "body": "I do not want to know how much back-room fighting there was over re-purposing <code>auto</code>."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 2, "creation_date": 1542829234, "post_id": 53416657, "comment_id": 93713035, "body": "Also see <a href=\"https://stackoverflow.com/questions/1143936/pragma-once-vs-include-guards/34884735#34884735\">#pragma once vs include guards?</a> and the part <b><i>#pragma once has unfixable bugs. It should never be used.</i></b> As I understand it, headers created through links create a lot of problems."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1542829447, "post_id": 53416657, "comment_id": 93713126, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/a/34884735/608639\">#pragma once vs include guards?</a>"}, {"owner": {"reputation": 215, "user_id": 4406754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280c38f4cc343f0f3be19b35d2195c91?s=128&d=identicon&r=PG&f=1", "display_name": "jamesqf", "link": "https://stackoverflow.com/users/4406754/jamesqf"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 2, "creation_date": 1542864578, "post_id": 53416657, "comment_id": 93723067, "body": "@Hans Passant: Sorry, but I still ride my horse, and have been known to carry a gun when I do, since there are bears &amp; mountain lions out there."}], "answers": [{"comments": [{"owner": {"reputation": 969, "user_id": 9119391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91441ccec1aeff26e087429cf3d0b2cd?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Cache", "link": "https://stackoverflow.com/users/9119391/johnny-cache"}, "edited": false, "score": 0, "creation_date": 1542819013, "post_id": 53416898, "comment_id": 93708202, "body": "That sounds overly complex. Any reason not to just include those definitions in the file in the first place?"}, {"owner": {"reputation": 374839, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 969, "user_id": 9119391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91441ccec1aeff26e087429cf3d0b2cd?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Cache", "link": "https://stackoverflow.com/users/9119391/johnny-cache"}, "edited": false, "score": 2, "creation_date": 1542819062, "post_id": 53416898, "comment_id": 93708227, "body": "@JohnnyCache: The example is a simplified version of how X-macros work. Please read the link; they&#39;re extremely useful in some cases for doing complex manipulations of tabular data. In any significant usage of X-macros, there would be no way you could just &quot;include those definitions in the file&quot;."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "reply_to_user": {"reputation": 969, "user_id": 9119391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91441ccec1aeff26e087429cf3d0b2cd?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Cache", "link": "https://stackoverflow.com/users/9119391/johnny-cache"}, "edited": false, "score": 2, "creation_date": 1542819092, "post_id": 53416898, "comment_id": 93708236, "body": "@Johnny - yes - one good reason is to ensure consistency (hard to do by hand when you have just a few dozen elements, never mind hundreds)."}, {"owner": {"reputation": 969, "user_id": 9119391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91441ccec1aeff26e087429cf3d0b2cd?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Cache", "link": "https://stackoverflow.com/users/9119391/johnny-cache"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1542819158, "post_id": 53416898, "comment_id": 93708274, "body": "@TobySpeight Heh, I suppose I could spare a single line of code to avoid writing thousands somewhere else. Makes sense."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 1, "creation_date": 1542819173, "post_id": 53416898, "comment_id": 93708290, "body": "To avoid duplication. Especially if the file is large. Admittedly, you could just use a big macro containing the X macro list but since projects could be using this, mandating <code>#pragma once</code> behavior would be a breaking change."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1542851078, "post_id": 53416898, "comment_id": 93720016, "body": "In many cases, the file being included will be the output of another program."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1542896895, "post_id": 53416898, "comment_id": 93739884, "body": "@Leushenko I agree (see my comment above the one above yours). In the absence of an actually compelling use case for it, I&#39;d mandate <code>include_once</code> semantics for all includes. I don&#39;t think it would be hard to implement. You can simply start hashing and the possibly memcmp-aring once you see two or more includes with the same size."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 27, "last_activity_date": 1542819564, "last_edit_date": 1542819564, "creation_date": 1542818916, "answer_id": 53416898, "question_id": 53416657, "link": "https://stackoverflow.com/questions/53416657/why-isnt-pragma-once-automatically-assumed/53416898#53416898", "title": "Why isn&#39;t #pragma once automatically assumed?", "body": "<p>Including multiple times is usable e.g., with the <a href=\"https://en.wikipedia.org/wiki/X_Macro\" rel=\"noreferrer\">X-macro</a> technique:</p>\n\n<p><em>data.inc:</em></p>\n\n<pre><code>X(ONE)\nX(TWO)\nX(THREE)\n</code></pre>\n\n<p><em>use_data_inc_twice.c</em></p>\n\n<pre><code>enum data_e { \n#define X(V) V,\n   #include \"data.inc\"\n#undef X\n};\nchar const* data_e__strings[]={\n#define X(V) [V]=#V,\n   #include \"data.inc\"\n#undef X\n};\n</code></pre>\n\n<p>I don't know about any other use.</p>\n"}, {"comments": [{"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 1, "creation_date": 1542819460, "post_id": 53417025, "comment_id": 93708469, "body": "This would still work if all headers were pragma once. As long as you didn&#39;t include the generated data more than once."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 2, "creation_date": 1542819565, "post_id": 53417025, "comment_id": 93708527, "body": "@PSkocik But maybe I <i>need</i> to include it more than once. Why shouldn&#39;t I be able to?"}, {"owner": {"reputation": 969, "user_id": 9119391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91441ccec1aeff26e087429cf3d0b2cd?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Cache", "link": "https://stackoverflow.com/users/9119391/johnny-cache"}, "edited": false, "score": 2, "creation_date": 1542820092, "post_id": 53417025, "comment_id": 93708805, "body": "@JesperJuhl That&#39;s the point. You won&#39;t <i>need</i> to include it more than once ever. You currently have the option, but the alternative isn&#39;t much worse, if at all."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 9, "creation_date": 1542821327, "post_id": 53417025, "comment_id": 93709420, "body": "@PSkocik If I change the value of <code>#define</code>s before each include that changes the behaviour of the included file then I may very well need to include it multiple times to get those different behaviours in different parts of my source file."}], "tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": false, "score": 38, "last_activity_date": 1542909269, "last_edit_date": 1542909269, "creation_date": 1542819280, "answer_id": 53417025, "question_id": 53416657, "link": "https://stackoverflow.com/questions/53416657/why-isnt-pragma-once-automatically-assumed/53417025#53417025", "title": "Why isn&#39;t #pragma once automatically assumed?", "body": "<p>You can use <code>#include</code> <em>anywhere</em> in a file, not just at global scope - like, inside a function (and multiple times if needed). Sure, ugly and not good style, but possible and occasionally sensible (depending on the file you include). If <code>#include</code> was only ever a one time thing then that wouldn't work. <code>#include</code> just does dumb text substitution (cut'n'paste) after all, and not everything you include has to be a header file. You might - for example - <code>#include</code> a file containing auto generated data containing the raw data to initialize a <code>std::vector</code>. Like</p>\n\n<pre><code>std::vector&lt;int&gt; data = {\n#include \"my_generated_data.txt\"\n}\n</code></pre>\n\n<p>And have \"my_generated_data.txt\" be something generated by the build system during compilation.</p>\n\n<p>Or maybe I'm lazy/silly/stupid and put this in a file (<em>very</em> contrived example):</p>\n\n<pre><code>const noexcept;\n</code></pre>\n\n<p>and then I do</p>\n\n<pre><code>class foo {\n    void f1()\n    #include \"stupid.file\"\n    int f2(int)\n    #include \"stupid.file\"\n};\n</code></pre>\n\n<p>Another, slightly less contrived, example would be a source file where many functions need to use a large amount of types in a namespace, but you don't want to just say <code>using namespace foo;</code> globally since that would polute the global namespace with a lot of other stuff you don't want. So you create a file \"foo\" containing</p>\n\n<pre><code>using std::vector;\nusing std::array;\nusing std::rotate;\n... You get the idea ...\n</code></pre>\n\n<p>And then you do this in your source file</p>\n\n<pre><code>void f1() {\n#include \"foo\" // needs \"stuff\"\n}\n\nvoid f2() {\n    // Doesn't need \"stuff\"\n}\n\nvoid f3() {\n#include \"foo\" // also needs \"stuff\"\n}\n</code></pre>\n\n<p>Note: I'm not advocating doing things like this. But it is possible and done in some codebases and I don't see why it should not be allowed. It <em>does</em> have its uses.</p>\n\n<p>It could also be that the file you include behaves differently depending on the value of certain macros (<code>#define</code>s). So you may want to include the file in multiple locations, after first having changed some value, so you get different behaviour in different parts of your source file.</p>\n"}, {"comments": [{"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 1, "creation_date": 1542971540, "post_id": 53417233, "comment_id": 93763960, "body": "It would not hinder <i>any</i> of that. OP asked about a <i>default</i> behaviour, not an unchangeable behaviour. It would be entirely sensible to change the default and instead provide a preprocessor flag <code>#pragma reentrant</code> or something along these lines. Hindsight is 20/20."}, {"owner": {"reputation": 3771, "user_id": 5386374, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Justin Time - Reinstate Monica", "link": "https://stackoverflow.com/users/5386374/justin-time-reinstate-monica"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1543274331, "post_id": 53417233, "comment_id": 93851199, "body": "It would hinder it in the sense of forcing people to update their libraries and dependencies, @KonradRudolph.  Not always a problem, but it could cause issues with some legacy programs.  Ideally, there would also be a command-line switch to specify whether the default is <code>once</code> or <code>reentrant</code>, to mitigate this or other potential issues."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "reply_to_user": {"reputation": 3771, "user_id": 5386374, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Justin Time - Reinstate Monica", "link": "https://stackoverflow.com/users/5386374/justin-time-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1543312284, "post_id": 53417233, "comment_id": 93863077, "body": "@JustinTime Well as my comment says it\u2019s clearly not a backwards compatible (and therefore feasible) change. The question, however, was why it was <i>initially</i> designed that way, not why it\u2019s not being changed. And the answer to that is, unambiguously, that the original design was a huge mistake with far-reaching consequences."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 10, "last_activity_date": 1542819987, "creation_date": 1542819987, "answer_id": 53417233, "question_id": 53416657, "link": "https://stackoverflow.com/questions/53416657/why-isnt-pragma-once-automatically-assumed/53417233#53417233", "title": "Why isn&#39;t #pragma once automatically assumed?", "body": "<p>No, this would significantly hinder the options available to, for example, library writers. For example, Boost.Preprocessor allows one to use pre-processor loops, and the only way to achieve those is by multiple inclusions of the same file.</p>\n\n<p>And Boost.Preprocessor is a building block for many very useful libraries.</p>\n"}, {"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1542827154, "post_id": 53417790, "comment_id": 93712079, "body": "<a href=\"https://stackoverflow.com/a/34884735/4581301\">And another take on why not standardize <code>once</code></a>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 4, "creation_date": 1542829560, "post_id": 53417790, "comment_id": 93713172, "body": "In particular, <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=52566\" rel=\"nofollow noreferrer\">see this example</a> for a case of where <code>pragma once</code> fails but include guards would have worked. Identifying files by location doesn&#39;t work either because sometimes the same file occurs multiple times in a project (e.g. you have 2 submodules that both include a header-only library in their headers and check out their own copy of it)"}, {"owner": {"reputation": 14968, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 6, "creation_date": 1542833933, "post_id": 53417790, "comment_id": 93715036, "body": "Not all pragmas are implementation-specific extensions. E.g. <a href=\"https://en.cppreference.com/w/c/preprocessor/impl#Standard_pragmas\" rel=\"nofollow noreferrer\"><code>#pragma STDC</code> family</a>. But they all do control implementation-defined behavior."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 4, "creation_date": 1542840150, "post_id": 53417790, "comment_id": 93717312, "body": "@user4581301 This answer over exaggerates the problem with pragma once and does not consider troubles due to include guards. In both case some discipline is needed. With include guards one must make sure to use a name that will not be used in an other file (which will happen after a file copy modify). With pragma once, one has to decide what is the unique right place for its file, which is a good thing after all."}, {"owner": {"reputation": 188394, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "edited": false, "score": 0, "creation_date": 1542845211, "post_id": 53417790, "comment_id": 93718856, "body": "So I&#39;d say two files are the same if <code>fwrite</code>&#39;ing to one modifies the other... I think that&#39;s reasonable? So I guess the question is not actually detecting if two files are the same, but rather doing so without actually writing to them?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 188394, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "edited": false, "score": 0, "creation_date": 1542851492, "post_id": 53417790, "comment_id": 93720102, "body": "@Mehrdad: It would be reasonable for the Standard to say that an implementation is free to ignore <code>#pragma once</code> in any case where, for whatever reason, it believes (rightly or wrongly) that two files may be distinct, but requiring that an implementation read everything in a file that is going to be skipped falls in the realm of Just Plain Dumb.  Perhaps a &quot;assume remainder of file is blank except for any required balancing <code>#endif</code> directives would be more useful, but there&#39;s no reason not to encourage implementations to provide an efficient means of..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1542851515, "post_id": 53417790, "comment_id": 93720113, "body": "...avoiding excessive file accesses during compilation on a best-effort basis."}, {"owner": {"reputation": 188394, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1542852989, "post_id": 53417790, "comment_id": 93720403, "body": "@supercat: Confused, why would you need to read the whole file that might be skipped? The implementation could just write 1 character to the <code>#pragma once</code> itself and see if it changes the other file it&#39;s trying to test against."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 188394, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "edited": false, "score": 3, "creation_date": 1542869232, "post_id": 53417790, "comment_id": 93724685, "body": "@Mehrdad: Are you seriously suggesting that compilers write to source files!?  If a compiler sees <code>#ifndef XX</code>, it must can&#39;t know whether there&#39;s anything following the corresponding <code>#endif</code> until it&#39;s read the entire file.  A compiler that keeps track of whether the outermost <code>#ifndef</code> encloses the entire file and notes what macro it checks may be able to avoid rescanning the file, but a directive to <i>say</i> there&#39;s nothing of importance following the current point would seem seem nicer than relying upon compilers to remember such things."}, {"owner": {"reputation": 188394, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1542870384, "post_id": 53417790, "comment_id": 93725161, "body": "@supercat: no, you&#39;re just not reading. I said <i>&quot;So I guess the question is not actually detecting if two files are the same, but rather doing so without actually writing to them?&quot;</i> to which you objected and said it&#39;s dumb to read a file that you would skip to which I responded that is not necessary to which you responded by forgetting what I wrote... the rest of what you wrote doesn&#39;t really make sense either, <code>#pragma once</code> already does something and that is one way to do it."}, {"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1542899083, "post_id": 53417790, "comment_id": 93741099, "body": "@supercat implementation is already free to ignore pragma once or any pragmas really. Hence why there is no pressure to standardize it, since you can already use it and get &quot;mostly working but slightly different on all platforms&quot; behavior. Actual introduction of it into standard would bring nothing more to the table if it&#39;s not actually specified how ti works and this is hard as discussed."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1542902325, "post_id": 53417790, "comment_id": 93742857, "body": "Good standards should offer recommendations instead of just requirements; in many cases, the former are <i>far</i> more valuable."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 2105, "user_id": 8718773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34213fbac0a5b09b9ff8abe458e6b87a?s=128&d=identicon&r=PG&f=1", "display_name": "Giacomo Alzetta", "link": "https://stackoverflow.com/users/8718773/giacomo-alzetta"}, "edited": false, "score": 0, "creation_date": 1542962661, "post_id": 53417790, "comment_id": 93759329, "body": "@GiacomoAlzetta There are other concerns (network drives for example). And as a compiler writer, you can&#39;t just tell people (or rather corporate &quot;customers&quot;) &quot;f*ck your code&quot;."}], "tags": [], "owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "is_accepted": true, "score": 86, "last_activity_date": 1542822407, "last_edit_date": 1542822407, "creation_date": 1542822079, "answer_id": 53417790, "question_id": 53416657, "link": "https://stackoverflow.com/questions/53416657/why-isnt-pragma-once-automatically-assumed/53417790#53417790", "title": "Why isn&#39;t #pragma once automatically assumed?", "body": "<p>There are multiple related questions here:</p>\n\n<ul>\n<li><p><strong>Why is <code>#pragma once</code> not automatically enforced?</strong><br>\nBecause there are situations in which you want to include files more than once.</p></li>\n<li><p><strong>Why would you want to include a file multiple times?</strong><br>\nSeveral reasons have been given in other answers (Boost.Preprocessor, X-Macros, including data files). I would like to add a particular example of \"avoid code duplication\": <strong>OpenFOAM</strong> encourages a style where <code>#include</code>ing bits and pieces within functions is a common concept. See for example <a href=\"https://stackoverflow.com/questions/15336494/using-include-to-include-sections-of-code\">this</a> discussion.</p></li>\n<li><p><strong>Ok, but why is it not the default with an opt-out?</strong><br>\nBecause it is not actually specified by the standard. <code>#pragma</code>s are by definition implementation-specific extensions.</p></li>\n<li><p><strong>Why has <code>#pragma once</code> not become a standardized feature yet (as it is widely supported)?</strong><br>\nBecause pinning down what is \"the same file\" in a platform-agnostic way is actually surprisingly hard. <a href=\"https://stackoverflow.com/a/23699893\">See this answer for more information</a>.</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 16855, "user_id": 1502345, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1beba9dc5373529ea99d294b23118d1b?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Aidley", "link": "https://stackoverflow.com/users/1502345/jack-aidley"}, "edited": false, "score": 5, "creation_date": 1542889650, "post_id": 53419896, "comment_id": 93735858, "body": "As usual, to understand C and C++, you need to understand their history."}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "edited": false, "score": 0, "creation_date": 1542918708, "post_id": 53419896, "comment_id": 93749033, "body": "It is <a href=\"https://herbsutter.com/2018/11/13/trip-report-fall-iso-c-standards-meeting-san-diego/\" rel=\"nofollow noreferrer\">reasonable to expect</a> that modules will land in February."}, {"owner": {"reputation": 41224, "user_id": 29639, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/J38sS.jpg?s=128&g=1", "display_name": "T.E.D.", "link": "https://stackoverflow.com/users/29639/t-e-d"}, "reply_to_user": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "edited": false, "score": 7, "creation_date": 1542931322, "post_id": 53419896, "comment_id": 93752022, "body": "@DavisHerring - Yes, but which February?"}], "tags": [], "owner": {"reputation": 41224, "user_id": 29639, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/J38sS.jpg?s=128&g=1", "display_name": "T.E.D.", "link": "https://stackoverflow.com/users/29639/t-e-d"}, "is_accepted": false, "score": 21, "last_activity_date": 1542831537, "creation_date": 1542831537, "answer_id": 53419896, "question_id": 53416657, "link": "https://stackoverflow.com/questions/53416657/why-isnt-pragma-once-automatically-assumed/53419896#53419896", "title": "Why isn&#39;t #pragma once automatically assumed?", "body": "<p>You seem to be operating under the assumption that the purpose of the \"#include\" feature even existing in the language is to provide support for decomposition of programs into multiple compilation units. <strong>That is incorrect.</strong></p>\n\n<p>It can perform that role, but that was not its intended purpose. C was <a href=\"https://en.wikipedia.org/wiki/C_(programming_language)#Early_developments\" rel=\"noreferrer\">originally developed</a> as slightly higher-level language than PDP-11 <a href=\"https://en.wikipedia.org/wiki/MACRO-11\" rel=\"noreferrer\">Macro-11</a> Assembly for reimplementing Unix. It had a macro preprocessor because that was a feature of Macro-11. It had the ability to textually include macros from another file because that was a feature of Macro-11 that the existing Unix they were porting to their new C compiler had made use of.</p>\n\n<p>Now it turns out that \"#include\" is <em>useful</em> for separating code into compilation units, as (arguably) a bit of a hack. However, the fact that this hack existed meant that it became The Way that is done in C. The fact that a way existed meant no new method ever <em>needed</em> to be created to provide this functionality, so nothing safer (eg: not vulnerable to multiple-inclusion) was ever created. Since it was already in C, it got copied into C++ along with most of the rest of C's syntax and idioms.</p>\n\n<p>There is a proposal for giving C++ <a href=\"https://cppdepend.com/blog/?p=228\" rel=\"noreferrer\">a proper module system</a> so this 45 year old preprocessor hack can finally be dispensed with. I don't know how imminent this is though. I've been hearing about it being in the works for more than a decade.</p>\n"}, {"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 3, "creation_date": 1542859992, "post_id": 53422608, "comment_id": 93721879, "body": "I would say your use case is a motivating example for the <code>_Pragma</code> directive. The same pragmas can now be expanded from regular macros. So no need to include more than once."}], "tags": [], "owner": {"reputation": 1597, "user_id": 5162810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pDGmO.jpg?s=128&g=1", "display_name": "Graham", "link": "https://stackoverflow.com/users/5162810/graham"}, "is_accepted": false, "score": 8, "last_activity_date": 1542849507, "last_edit_date": 1542849507, "creation_date": 1542849170, "answer_id": 53422608, "question_id": 53416657, "link": "https://stackoverflow.com/questions/53416657/why-isnt-pragma-once-automatically-assumed/53422608#53422608", "title": "Why isn&#39;t #pragma once automatically assumed?", "body": "<p>In the firmware for the product I mainly work on, we need to be able to specify where functions and global/static variables should be allocated in memory. Real-time processing needs to live in L1 memory on chip so the processor can access it directly, fast. Less important processing can go in L2 memory on chip. And anything that doesn't need to be handled particularly promptly can live in the external DDR and go through caching, because it doesn't matter if it's a little slower.</p>\n\n<p>The #pragma to allocate where things go is a long, non-trivial line. It'd be easy to get it wrong.  The effect of getting it wrong would be that the code/data would be silently put into default (DDR) memory, and the effect of <em>that</em> might be closed-loop control stopping working for no reason that's easy to see.</p>\n\n<p>So I use include files, which contain just that pragma. My code now looks like this.</p>\n\n<p>Header file... </p>\n\n<pre><code>#ifndef HEADERFILE_H\n#define HEADERFILE_H\n\n#include \"set_fast_storage.h\"\n\n/* Declare variables */\n\n#include \"set_slow_storage.h\"\n\n/* Declare functions for initialisation on startup */\n\n#include \"set_fast_storage.h\"\n\n/* Declare functions for real-time processing */\n\n#include \"set_storage_default.h\"\n\n#endif\n</code></pre>\n\n<p>And source...</p>\n\n<pre><code>#include \"headerfile.h\"\n\n#include \"set_fast_storage.h\"\n\n/* Define variables */\n\n#include \"set_slow_storage.h\"\n\n/* Define functions for initialisation on startup */\n\n#include \"set_fast_storage.h\"\n\n/* Define functions for real-time processing */\n</code></pre>\n\n<p>You'll notice multiple inclusions of the same file there, even just in the header. If I mistype something now, the compiler will tell me it can't find the include file \"set_fat_storage.h\" and I can easily fix it.</p>\n\n<p>So in answer to your question, this is a real, practical example of where multiple inclusion is required.</p>\n"}], "owner": {"reputation": 969, "user_id": 9119391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91441ccec1aeff26e087429cf3d0b2cd?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Cache", "link": "https://stackoverflow.com/users/9119391/johnny-cache"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6880, "favorite_count": 13, "accepted_answer_id": 53417790, "answer_count": 6, "score": 82, "last_activity_date": 1543350501, "creation_date": 1542818134, "last_edit_date": 1542818935, "question_id": 53416657, "link": "https://stackoverflow.com/questions/53416657/why-isnt-pragma-once-automatically-assumed", "title": "Why isn&#39;t #pragma once automatically assumed?", "body": "<p>What's the point of telling the compiler specifically to include the file only once? Wouldn't it make sense by default? Is there even any reason to include a single file multiple times? Why not just assume it? Is it to do with specific hardware?</p>\n"}, {"tags": ["c", "arrays", "file"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1542818252, "post_id": 53416607, "comment_id": 93707750, "body": "Please provide the return value for each use of scanf. Not the scanned value, the returned value, which indicates how many scans were successful."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 3, "creation_date": 1542818314, "post_id": 53416607, "comment_id": 93707788, "body": "Why is every <code>fread</code> size <code>sizeof(struct student)</code>?"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 2, "creation_date": 1542818413, "post_id": 53416607, "comment_id": 93707840, "body": "<code>fwrite(&amp;stu_data[i], sizeof(stu_data[i]), 1, fptr);</code> would be the proper way to write one entry to the file. Same goes for read."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10542702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732a16b5a8e950e4cff1f65b760ffd7c?s=128&d=identicon&r=PG&f=1", "display_name": "Krytec", "link": "https://stackoverflow.com/users/10542702/krytec"}, "edited": false, "score": 0, "creation_date": 1543248430, "post_id": 53421765, "comment_id": 93839571, "body": "Thank you! I only got around to seeing this now. The reading/writing tip saved my day."}], "tags": [], "owner": {"reputation": 6544, "user_id": 451601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/164602d512ce01f188e5a50593b46c5f?s=128&d=identicon&r=PG", "display_name": "James K. Lowden", "link": "https://stackoverflow.com/users/451601/james-k-lowden"}, "is_accepted": true, "score": 0, "last_activity_date": 1542842083, "creation_date": 1542842083, "answer_id": 53421765, "question_id": 53416607, "link": "https://stackoverflow.com/questions/53416607/reading-information-from-file-program-in-c/53421765#53421765", "title": "Reading information from file program in C", "body": "<p>I doubt you're writing or reading what you intend.  </p>\n\n<p>When you write, </p>\n\n<pre><code>fwrite(&amp;stu_data[i].information.studentName, sizeof(struct student), 1, fptr);\n</code></pre>\n\n<p>you're writing 1 element of <code>sizeof(struct student)</code> bytes, starting not from the beginning of the student struct, but from <code>stu_data[i].information.studentName</code>.  So you get the 50-byte name, and whatever happens to follow it in memory.  If <code>sizeof(struct student)</code> is 250 bytes, you write 200 bytes of nonsense (at best), and then continue with the next field.  Ugh!  </p>\n\n<p>Unless you have good reason not to, why not write the whole record at once?  Less code, less bother for the computer.   </p>\n\n<pre><code>fwrite(&amp;stu_data[i], sizeof(struct student), 1, fptr);\n</code></pre>\n\n<p>As a rule, that's what you should look for in your code: the address provided as the 1st parameter should be of a data structure whose size is named in the 2nd.  Even better: </p>\n\n<pre><code>fwrite(&amp;stu_data[i], sizeof(stu_data[i]), 1, fptr);\n</code></pre>\n\n<p>The same advice applies to reading.  I'll only point out one other error: </p>\n\n<pre><code>    fseek(fptr, sizeof(struct student), SEEK_SET);\n</code></pre>\n\n<p>No matter what input is provided, you seek to (what you probably intend as) the 2nd record: <code>sizeof(struct student)</code> bytes from the beginning of the file.  Likely, you want some multiple of that number, based on the input.  </p>\n\n<p>Also, <strong>hexdump</strong>(1) is your friend, especially the -C option.  </p>\n"}], "owner": {"reputation": 17, "user_id": 10542702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732a16b5a8e950e4cff1f65b760ffd7c?s=128&d=identicon&r=PG&f=1", "display_name": "Krytec", "link": "https://stackoverflow.com/users/10542702/krytec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 53421765, "answer_count": 1, "score": -1, "last_activity_date": 1546025350, "creation_date": 1542817965, "last_edit_date": 1546025350, "question_id": 53416607, "link": "https://stackoverflow.com/questions/53416607/reading-information-from-file-program-in-c", "title": "Reading information from file program in C", "body": "<p>This is my code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct student\n{\n    char studentName[50];\n    int id;\n};\nstruct student_detail\n{\n    int day, month, year, grade;\n\n    struct student information;\n}stu_data;\n//---------------------------------//\nint main()\n{\n    struct student_detail stu_data[10];\n\n    int student_no, i=0, choice=0;\n    char keyword[50];\n\n    FILE *fptr;\n\n    printf(\"Add-Information(1) || Get-Information(2): \");\n    scanf(\"%d\",&amp;choice);\n\n    if(choice == 1){\n\n        fptr = (fopen(\"userInfo.txt\",\"ab\"));\n\n        system(\"CLS\");\n        printf(\"How many students would you like to add?[MAX 10]: \");\n        scanf(\"%d\",&amp;student_no);\n        system(\"CLS\");\n\n        for(i=0; i &lt; student_no; i++){\n            system(\"CLS\");\n            printf(\"Enter student#%d's name: \",i+1);\n            scanf(\"%s\", stu_data[i].information.studentName);\n\n            printf(\"\\nWhat is %s's studentID?: \",stu_data[i].information.studentName);\n            scanf(\"%d\",&amp;stu_data[i].information.id);\n\n            printf(\"\\nWhat is %s's date of birth?(dd/mm/yy):\\n\",stu_data[i].information.studentName);\n            scanf(\"%d %d %d\",&amp;stu_data[i].day, &amp;stu_data[i].month, &amp;stu_data[i].year);\n\n            fwrite(&amp;stu_data[i].information.studentName, sizeof(struct student), 1, fptr);\n            fwrite(&amp;stu_data[i].information.id, sizeof(struct student), 1, fptr);\n            fwrite(&amp;stu_data[i].day, sizeof(struct student), 1, fptr);\n            fwrite(&amp;stu_data[i].month, sizeof(struct student), 1, fptr);\n            fwrite(&amp;stu_data[i].year, sizeof(struct student), 1, fptr);\n        }\n        fclose(fptr);\n    }\n    if(choice == 2){\n\n        fptr = (fopen(\"userInfo.txt\",\"rb+\"));\n\n        system(\"CLS\");\n\n        printf(\"What students information would you like to retreive?: \");\n        scanf(\"%s\",keyword);\n\n        fseek(fptr, sizeof(struct student), SEEK_SET);\n\n        fread(&amp;stu_data[i].information.studentName, sizeof(struct student), 1, fptr);\n        fread(&amp;stu_data[i].information.id, sizeof(struct student), 1, fptr);\n\n        fread(&amp;stu_data[i].day, sizeof(struct student), 1, fptr);\n        fread(&amp;stu_data[i].month, sizeof(struct student), 1, fptr);\n        fread(&amp;stu_data[i].year, sizeof(struct student), 1, fptr);\n\n        printf(\"Name: %s\",stu_data[i].information.studentName);\n        printf(\"\\nID: %d\",stu_data[i].information.id);\n        printf(\"\\nDate of birth: %d/%d/%d\\n\\n\",stu_data[i].day, stu_data[i].month, stu_data[i].year);\n\n    system(\"PAUSE\");\n\n    fclose(fptr);\nreturn 0;\n    }\n}  \n</code></pre>\n\n<p>Input into the file looks like this:  </p>\n\n<blockquote>\n  <p>Name: Riley<br>\n   ID: 1<br>\n   Date of birth: 01/10/2001</p>\n</blockquote>\n\n<p>When I read the information from the file I get correct information but not all of it, when read in the message looks like this:  </p>\n\n<blockquote>\n  <p>Name: y<br>\n  ID: 1<br>\n  Date of birth: 10/2001/2686248</p>\n</blockquote>\n\n<p>The writing works just not reading (sorry for lack of comments inside the program).</p>\n"}, {"tags": ["c++", "c", "gcc"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 7, "creation_date": 1542817302, "post_id": 53416375, "comment_id": 93707109, "body": "c++ doesn&#39;t allow 0 sized c arrays or c arrays of unknown sizes. Possible duplicate : <a href=\"https://stackoverflow.com/questions/9722632/what-happens-if-i-define-a-0-size-array-in-c-c\" title=\"what happens if i define a 0 size array in c c\">stackoverflow.com/questions/9722632/&hellip;</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 7, "creation_date": 1542817351, "post_id": 53416375, "comment_id": 93707144, "body": "You will do yourself a favor if you think of C and C++ as two completely separate languages that just happen to share a lot of the same keywords."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1542817354, "post_id": 53416375, "comment_id": 93707147, "body": "The code is invalid in C and C++. You need to pay attention to diagnostic messages issued by C compiler as well."}, {"owner": {"reputation": 484, "user_id": 7758765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c6963ac41170217e28cf1b41358a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Welgriv", "link": "https://stackoverflow.com/users/7758765/welgriv"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1542817355, "post_id": 53416375, "comment_id": 93707149, "body": "@Fran&#231;oisAndrieux but C does ?"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 3, "creation_date": 1542817358, "post_id": 53416375, "comment_id": 93707150, "body": "C and C++ are different languages, so why expect them to behave the same way?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1542817389, "post_id": 53416375, "comment_id": 93707166, "body": "@Welgriv I don&#39;t know if it does. I&#39;m choosing not to assume the rules of c based on my knowledge of c++. Don&#39;t take my not mentioning the rules of c as implying that it&#39;s allowed. Edit : I see now from the wording of the question how my comment could have been seen as stating a difference between c++ and c rather than just stating a fact about c++. Sorry for the confusion."}, {"owner": {"reputation": 484, "user_id": 7758765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c6963ac41170217e28cf1b41358a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Welgriv", "link": "https://stackoverflow.com/users/7758765/welgriv"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1542817410, "post_id": 53416375, "comment_id": 93707185, "body": "@AnT Ok so my <code>gcc</code> is wrong ? &gt;&lt;"}, {"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1542817953, "post_id": 53416375, "comment_id": 93707564, "body": "@Welgriv didn&#39;t you just ignore conformance warnings of your compiler?"}, {"owner": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "reply_to_user": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1542818019, "post_id": 53416375, "comment_id": 93707601, "body": "Welgriv, they put you through the ringer on this one, but it&#39;s actuallly a good question, and you included all the information we needed to see taht when invoked with default settings, <code>gcc</code> does indeed compile  this without further errors.  @&#214;&#246;Tiib, did you actually bother trying it ?"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1542818030, "post_id": 53416375, "comment_id": 93707607, "body": "@Welgriv: It is often wrong. But not in this case. Just rememberr that GCC often by default reports many serious language &quot;errors&quot; as &quot;warnings&quot;. You simply ignored its complaints. Specifying <code>-std=...</code> and <code>-pedantic-errors</code> in command line might help you to pay more attention to such errors."}, {"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "reply_to_user": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "edited": false, "score": 0, "creation_date": 1542818312, "post_id": 53416375, "comment_id": 93707786, "body": "@DanFarrell gcc gives conformance warnings with -pedantic not by default since by default it compiles some sort of &quot;gnuC&quot; language not C."}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1542832186, "post_id": 53416375, "comment_id": 93714283, "body": "<a href=\"https://gcc.gnu.org/onlinedocs/gcc/Zero-Length.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc/Zero-Length.html</a> for a description of the extension."}], "answers": [{"comments": [{"owner": {"reputation": 484, "user_id": 7758765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c6963ac41170217e28cf1b41358a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Welgriv", "link": "https://stackoverflow.com/users/7758765/welgriv"}, "edited": false, "score": 1, "creation_date": 1542817491, "post_id": 53416422, "comment_id": 93707251, "body": "So why did it compile and execute correctly with my gcc ?"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 484, "user_id": 7758765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c6963ac41170217e28cf1b41358a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Welgriv", "link": "https://stackoverflow.com/users/7758765/welgriv"}, "edited": false, "score": 0, "creation_date": 1542817588, "post_id": 53416422, "comment_id": 93707323, "body": "@Welgriv Did you pay attention to warnings (and enabled them)?"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 484, "user_id": 7758765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c6963ac41170217e28cf1b41358a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Welgriv", "link": "https://stackoverflow.com/users/7758765/welgriv"}, "edited": false, "score": 0, "creation_date": 1542817619, "post_id": 53416422, "comment_id": 93707337, "body": "@Welgriv: No, it didn&#39;t! The word &quot;compile&quot; in C world has very specific meaning: it means &quot;passed the compilation process without any language-mandated diagnostic messages&quot;. This code does not compile in GCC: see for yourself <a href=\"http://coliru.stacked-crooked.com/a/63b110261be01aa3\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/63b110261be01aa3</a> The warning you see is exactly that: a language-mandated diagnostic message indicating a constraint violation (an error) in your code. What happened next (whether it executed or not) does not matter at all. Your code is not valid C."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "reply_to_user": {"reputation": 484, "user_id": 7758765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c6963ac41170217e28cf1b41358a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Welgriv", "link": "https://stackoverflow.com/users/7758765/welgriv"}, "edited": false, "score": 0, "creation_date": 1542817621, "post_id": 53416422, "comment_id": 93707339, "body": "@Welgriv When compiling such code I get <code>warning: flexible array initialization is a GNU extension</code>, which means, that it is not part of C language, but is enabled by a compiler extension."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 484, "user_id": 7758765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c6963ac41170217e28cf1b41358a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Welgriv", "link": "https://stackoverflow.com/users/7758765/welgriv"}, "edited": false, "score": 0, "creation_date": 1542817768, "post_id": 53416422, "comment_id": 93707432, "body": "@Welgriv    Try disabling GNU language extensions by passing the <code>-std=</code> option with something that does not enable gnu stuff. Like <code>-std=c11</code>. And crank up the warnings. Also; the fact that something <i>compiles</i> means nothing more than that it is syntactically valid. It says <i>nothing</i> about whether it is <i>correct</i>. &quot;It compiles&quot; is a <i>very low</i> bar."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1542817835, "post_id": 53416422, "comment_id": 93707475, "body": "If you are not good with observing compiler diagnostics and telling which messages are actually &quot;errors&quot;, get a habit of running GCC with <code>-std=... -pedantic-errors</code> flags."}, {"owner": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1542818547, "post_id": 53416422, "comment_id": 93707908, "body": "@AlgirdasPreid\u017eius silently changing the compiler flags in your example and then telling the OP <i>thier</i> command didn&#39;t compile without warning is frustratingly deceptive.  Why not just say the truthful thing - that gcc will compile invalid code if not told to be pedantic about things!"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "reply_to_user": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "edited": false, "score": 0, "creation_date": 1542822138, "post_id": 53416422, "comment_id": 93709776, "body": "@DanFarrell But, that what pedantic means: To be pedantic about adhering to the standard, without using any compiler extensions, that accepts non-standard code. Which is what I already said in my original comment (in slightly different words). So, I fail to see the deception (Especially, since &quot;deception&quot; means &quot;<i>the act of causing someone to accept as true or valid what is false or invalid</i>&quot; (<a href=\"https://www.merriam-webster.com/dictionary/deception\" rel=\"nofollow noreferrer\">source</a>), what, about my original comment was false, or invalid?)"}, {"owner": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1542822829, "post_id": 53416422, "comment_id": 93710125, "body": "@AlgirdasPreid\u017eius, because you said &quot;No, it didn&#39;t&quot; when it fact it <i>did</i> compile and run successfully exactly as the OP showed."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "edited": false, "score": 1, "creation_date": 1542823432, "post_id": 53416422, "comment_id": 93710417, "body": "@Dan Farrell: It&#39;s, again, a confusion created by different interpretations of the term <i>compile</i>. Some people believe that if the compiler created an executable, then the code &quot;compiled and ran successfully&quot;, where &quot;success&quot;  is based on their naive expectations (as opposed to language spec). That&#39;s a rather useless understanding of the term for C/C++ purposes. A more mature and meaningful interpretation of the term is, again: &quot;code compiled&quot; = &quot;code passed the compilation process without any language-mandated diagnostic messages&quot;. In this case the code did not really compile."}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": true, "score": 7, "last_activity_date": 1542830482, "last_edit_date": 1542830482, "creation_date": 1542817436, "answer_id": 53416422, "question_id": 53416375, "link": "https://stackoverflow.com/questions/53416375/why-this-different-behaviour-of-structure-initialization-in-c-and-c/53416422#53416422", "title": "Why this different behaviour of structure initialization in C and C++?", "body": "<p>The code is invalid in C. This is not allowed in C</p>\n\n<pre><code>typedef struct{\n  int i;\n  int tab[];\n}mystr;\n\nmystr a = {1,{0,1,2}};\n</code></pre>\n\n<p>Whatever behavior you observe in C mode is a quirk of your compiler that has nothing to do with the language. The compiler supports the code as a non-standard feature, <em>an extension</em>.</p>\n\n<p>Your code is also invalid in C++, but for a reason that is completely different from what was reported by your compiler. In C++ you are not allowed to have <code>[]</code> arrays as class members at all. The compiler lets it slip through (as an <em>extension</em> again), but fails in another spot later.</p>\n\n<p>So, the answer to your question would be: the compiler you are using has different quirks/extensions in C mode than in C++ mode. Which is not surprising, since these are very different languages.</p>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1542818877, "post_id": 53416739, "comment_id": 93708118, "body": "Additionally, if one wants <code>gcc</code> to be of more help in identifying nonstandardisms, then turning off GNU extensions via the <code>-std=</code> option (e.g. <code>-std=c11</code>) is in order.  Even then, however, the compiler does not promise to diagnose <i>all</i> standard conformance issues."}], "tags": [], "owner": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "is_accepted": false, "score": 1, "last_activity_date": 1542818830, "last_edit_date": 1542818830, "creation_date": 1542818361, "answer_id": 53416739, "question_id": 53416375, "link": "https://stackoverflow.com/questions/53416375/why-this-different-behaviour-of-structure-initialization-in-c-and-c/53416739#53416739", "title": "Why this different behaviour of structure initialization in C and C++?", "body": "<p>Everything in the upvoted answer might be accurate, but it dances around the root of your question.  You're absolutely right - on debian and alpine docker images, and a gcc invocation that doesn't include <code>-pedantic</code> does compile this and run it without complaint:</p>\n\n<pre><code>root@45c9da7956c8:/# cat t.c; gcc -std=c11 -o t t.c &amp;&amp; ./t;\n#include &lt;stdio.h&gt;\n\ntypedef struct{\n  int i;\n  int tab[];\n}mystr;\n\nmystr a = {1,{0,1,2}};\n\nint main(void){\n  printf(\"%d%d%d\\n\",a.i,a.tab[0],a.tab[1]);\n  return 0;\n}\n101\n</code></pre>\n\n<p>Gcc is a very accomodating compiler, and will work with things that can only be described accurately as out of spec.  That doesn't necessarily make it a bad compiler - but it does make it a poor test of whether code is standards compliant.  <code>-pedantic</code> will help with that.</p>\n\n<p>I'll echo the point made in the question comments that it really is conceptually best to think of C and C++ as completely different languages.   At least, I can't think of a case where getting C code to compile on a c++ compiler would have any value.  Thinking of them as completely separate is a valid model for how they act in real life.  </p>\n"}], "owner": {"reputation": 484, "user_id": 7758765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c6963ac41170217e28cf1b41358a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Welgriv", "link": "https://stackoverflow.com/users/7758765/welgriv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 53416422, "answer_count": 2, "score": 1, "last_activity_date": 1542830482, "creation_date": 1542817266, "last_edit_date": 1542828008, "question_id": 53416375, "link": "https://stackoverflow.com/questions/53416375/why-this-different-behaviour-of-structure-initialization-in-c-and-c", "title": "Why this different behaviour of structure initialization in C and C++?", "body": "<p>Code :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct{\n  int i;\n  int tab[];\n}mystr;\n\nmystr a = {1,{0,1,2}};\n\nint main(void){\n  printf(\"%d%d%d\\n\",a.i,a.tab[0],a.tab[1]);\n  return 0;\n}\n</code></pre>\n\n<p>C compiling :</p>\n\n<pre><code>$ gcc main.c -o main &amp;&amp; ./main\n101\n</code></pre>\n\n<p>C++ compiling :</p>\n\n<pre><code>$ g++ main.c -o main &amp;&amp; ./main\nmain.c:8:27: error: too many initializers for \u2018int [0]\u2019\n const mystr a = {1,{0,1,2}};\n                           ^\n</code></pre>\n\n<p>I do understand the problem, it is that <code>tab</code> have no any memory allocated. But why this is ok for C ? Why do C++ doesn't automatically allocate the memory space for the <code>tab</code> ?\nI Know that structures are similar to objects in C++ but may be there is some subtleties that I do not know about global object instantiation ?</p>\n"}, {"tags": ["c", "string", "input"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 2, "creation_date": 1542817004, "post_id": 53416201, "comment_id": 93706940, "body": "<code>scanf(&quot; %s&quot;, input1);</code> reads till the next whitespace. first <code>scanf</code> will read <code>donate</code> and the second <code>100</code>."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1542817162, "post_id": 53416201, "comment_id": 93707040, "body": "Why not just add a line of code to log what&#39;s in <code>input1</code> and what&#39;s in <code>val</code> right before the <code>if</code> and figure it out yourself?"}, {"owner": {"reputation": 175, "user_id": 9771202, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LfqnrP9DuOM/AAAAAAAAAAI/AAAAAAAAAGQ/CxMkQnBkv_4/photo.jpg?sz=128", "display_name": "mahin hossen", "link": "https://stackoverflow.com/users/9771202/mahin-hossen"}, "edited": false, "score": 0, "creation_date": 1542817305, "post_id": 53416201, "comment_id": 93707112, "body": "ya i did that,the val is showing correct info.but output is coming unexpectedly"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1542817419, "post_id": 53416201, "comment_id": 93707193, "body": "@mahinhossen Are you saying <code>val</code> was <code>-1</code> and you were still getting output? Your <code>if</code> pretty clearly prevents that."}, {"owner": {"reputation": 175, "user_id": 9771202, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LfqnrP9DuOM/AAAAAAAAAAI/AAAAAAAAAGQ/CxMkQnBkv_4/photo.jpg?sz=128", "display_name": "mahin hossen", "link": "https://stackoverflow.com/users/9771202/mahin-hossen"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1542817625, "post_id": 53416201, "comment_id": 93707346, "body": "got it, i should have checked that.thanks for the help @DavidSchwartz"}, {"owner": {"reputation": 175, "user_id": 9771202, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LfqnrP9DuOM/AAAAAAAAAAI/AAAAAAAAAGQ/CxMkQnBkv_4/photo.jpg?sz=128", "display_name": "mahin hossen", "link": "https://stackoverflow.com/users/9771202/mahin-hossen"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1542817729, "post_id": 53416201, "comment_id": 93707404, "body": "is there any way? so that i can add &quot;donate 100&quot; in a string?cause as @Osiris said, string is taking &quot;donate&quot; and &quot;100&quot; seperately."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1542817773, "post_id": 53416201, "comment_id": 93707437, "body": "Don&#39;t you want them separate? You want to ignore the &quot;donate&quot; and process the &quot;100&quot;, right? So you want them separate."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 1, "creation_date": 1542817800, "post_id": 53416201, "comment_id": 93707451, "body": "@mahinhossen If you want to read a string until new line you should use <code>scanf(&quot; %[^\\n]s&quot;,input1);</code>"}, {"owner": {"reputation": 175, "user_id": 9771202, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LfqnrP9DuOM/AAAAAAAAAAI/AAAAAAAAAGQ/CxMkQnBkv_4/photo.jpg?sz=128", "display_name": "mahin hossen", "link": "https://stackoverflow.com/users/9771202/mahin-hossen"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1542818089, "post_id": 53416201, "comment_id": 93707656, "body": "i don&#39;t want them seperate. for example, if i input &quot;donate 100&quot;, then i want to total would be 100. @DavidSchwartz"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1542818416, "post_id": 53416201, "comment_id": 93707844, "body": "@mahinhossen Right, so you do want them separate. You want to be able to ignore the &quot;donate&quot; and process the &quot;100&quot;. That&#39;s most easily done if they&#39;re separate. If they&#39;re together, you&#39;d just have to separate them because you want to handle the two things differently."}, {"owner": {"reputation": 175, "user_id": 9771202, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LfqnrP9DuOM/AAAAAAAAAAI/AAAAAAAAAGQ/CxMkQnBkv_4/photo.jpg?sz=128", "display_name": "mahin hossen", "link": "https://stackoverflow.com/users/9771202/mahin-hossen"}, "edited": false, "score": 0, "creation_date": 1542818796, "post_id": 53416201, "comment_id": 93708068, "body": "can u suggest any way to do that?i used scanf(&quot; %[^\\n]s&quot;). but it isn&#39;t acting on that val.cause it remains -1.@DavidSchwartz"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1542820968, "post_id": 53416201, "comment_id": 93709252, "body": "@mahinhossen Your <code>scanf</code> is fine. You just need to add code to ignore the input if it&#39;s not a number. Your choice of <code>atoi</code> was not a good one, since it has no error detection."}], "answers": [{"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 1, "last_activity_date": 1542817360, "creation_date": 1542817360, "answer_id": 53416401, "question_id": 53416201, "link": "https://stackoverflow.com/questions/53416201/why-input-isnt-being-taken-as-i-wanted/53416401#53416401", "title": "why input isn&#39;t being taken as i wanted?", "body": "<p>Simply add logging and the answer will be obvious:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nint main()\n{\n    int T, total=0, val=-1;\n    char  input1[20];\n\n    scanf(\"%d\",&amp;T);\n\n    while(T--)\n    {\n        scanf(\" %s\",input1);\n        val=-1;\n\n        val=atoi(input1);\n        total+=val;\n\n        printf(\"\\nInput='%s' val='%d'\\n\", input1, val);\n\n        if(val != -1)\n            printf(\"%d\\n\",total);\n\n    }\n}\n</code></pre>\n\n<p>Then run it and give it your input:</p>\n\n<pre><code>4\ndonate 100\n\nInput='donate' val='0'\n0\n\nInput='100' val='100'\n100\nreport\n\nInput='report' val='0'\n100\ndonate 500\n\nInput='donate' val='0'\n100\n</code></pre>\n\n<p>As you can see, your expectation that you'd somehow get a <code>-1</code> value in <code>val</code> if <code>atoi</code> wasn't given a number is incorrect.</p>\n"}], "owner": {"reputation": 175, "user_id": 9771202, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LfqnrP9DuOM/AAAAAAAAAAI/AAAAAAAAAGQ/CxMkQnBkv_4/photo.jpg?sz=128", "display_name": "mahin hossen", "link": "https://stackoverflow.com/users/9771202/mahin-hossen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 53416401, "answer_count": 1, "score": -1, "last_activity_date": 1544019675, "creation_date": 1542816748, "last_edit_date": 1592644375, "question_id": 53416201, "link": "https://stackoverflow.com/questions/53416201/why-input-isnt-being-taken-as-i-wanted", "title": "why input isn&#39;t being taken as i wanted?", "body": "<p>In this program i want to get a input where will be a string with some int.if no values were not given then, the program will just show the total amount.</p>\n<p>But here, in the 1st case if i use a string with number,then there is 2 output.</p>\n<p>Example input:</p>\n<blockquote>\n<p>4</p>\n<p>donate  100</p>\n<p>report</p>\n<p>donate 500</p>\n</blockquote>\n<p>Example output:</p>\n<blockquote>\n<p>0</p>\n<p>100</p>\n<p>100</p>\n<p>0</p>\n</blockquote>\n<p><strong>But notice here i got chance of 3 times to input string,but output is 4 time.</strong>\n<strong>So, can anyone tell me why this program acting weird?</strong></p>\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nint main()\n{\n    int T, total=0, val=0;\n    char  input1[20];\n\n    scanf(&quot;%d&quot;,&amp;T);\n\n    while(T--)\n    {\n        scanf(&quot; %s&quot;,input1);\n        val=-1;\n\n        val=atoi(input1);\n        total+=val;\n\n        printf(&quot;\\nInput=\\&quot;%s\\&quot; val=\\&quot;%d\\&quot;\\n&quot;, input1, val);\n\n        if(val != -1)\n            printf(&quot;%d\\n&quot;,total);\n\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "authentication", "login", "registration"], "comments": [{"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1542816932, "post_id": 53415897, "comment_id": 93706884, "body": "I don&#39;t think recursively calling <code>reg</code> is a good solution to a duplicate name. The rest of the <i>calling</i> function will execute after the <i>called</i> function finishes. It&#39;s going to be simpler to fail to register the name and make the user try again. Optionally make <code>reg</code> return 0 on failure, 1 on success, and you can just call it again."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1542817126, "post_id": 53415897, "comment_id": 93707020, "body": "A user can enter more than 30 characters for a password. You can fix this with an extra limit on the <code>while</code> loop that gets characters."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1542817208, "post_id": 53415897, "comment_id": 93707061, "body": "Don&#39;t write the username and password to the file until the user has agreed"}], "answers": [{"tags": [], "owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "is_accepted": true, "score": 0, "last_activity_date": 1542817655, "creation_date": 1542817655, "answer_id": 53416492, "question_id": 53415897, "link": "https://stackoverflow.com/questions/53415897/user-login-registration-cant-register-more-than-one-user-in-c/53416492#53416492", "title": "User Login &amp; Registration: can&#39;t register more than one user in C", "body": "<p>One reason this doesn't work with multiple users is the logical structure of the <code>login</code> function.</p>\n\n<pre><code>while(!feof(fp))\n{\n    fread(&amp;w[i],sizeof(w[i]),1,fp);\n    cekun=strcmp(nama,w[i].nama);\n    cekpw=strcmp(pass,w[i].pass);\n    if(cekun==0&amp;&amp;cekpw==0)\n    {\n        system(\"cls\");\n        printf(\"\\n\\n\\n\\t\\t\\tLOGIN SUCCESSFUL!\");\n        break;\n    }\n    else if(cekun==0)\n    {\n        printf(\"\\n\\n\\n\\t\\t\\tWRONG PASSWORD!\");\n        printf(\"\\n\\n\\t\\t\\t\\t  (PRESS [Y] TO RE-LOGIN)\");\n        if(getch()=='y'||getch()=='Y')\n          system(\"cls\"); login();\n    }\n    else if(cekun!=0&amp;&amp;cekpw!=0)\n    {\n        printf(\"\\n\\n\\n\\t\\t\\tYOU ARE NOT REGISTERED\\n ...\n</code></pre>\n\n<p>This code is going to reject any login attempt unless the username and password match <em>the first entry in the file</em>.</p>\n\n<p>Instead, you should implement the following logic:</p>\n\n<pre><code>for each entry in file\n    if names match\n        if passwords match\n            login success\n        else\n            login failure\nunknown user\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": false, "score": 0, "last_activity_date": 1542819876, "creation_date": 1542819876, "answer_id": 53417205, "question_id": 53415897, "link": "https://stackoverflow.com/questions/53415897/user-login-registration-cant-register-more-than-one-user-in-c/53417205#53417205", "title": "User Login &amp; Registration: can&#39;t register more than one user in C", "body": "<p>Instead of writing functions that prompt and check, do the checking in a separate function.</p>\n\n<p>For example, let's say you use</p>\n\n<pre><code>#define  MAX_NAME_LEN  31\n#define  MAX_PASS_LEN  31\n\ntypedef struct {\n    char  name[MAX_NAME_LEN + 1];\n    char  pass[MAX_PASS_LEN + 1];\n} userinfo;\n</code></pre>\n\n<p>to store the information about known users.  Your user database could then be</p>\n\n<pre><code>#define  MAX_USERS  100\n\nstatic userinfo  known_user[MAX_USERS];\nstatic size_t    known_users = 0;\n</code></pre>\n\n<p>To register a new user, you write a function that takes the username and password as parameters:</p>\n\n<pre><code>int register_user(const char *user, const char *pass)\n{\n    const size_t  userlen = (user) ? strlen(user) : 0;\n    const size_t  passlen = (pass) ? strlen(pass) : 0;\n    size_t        i;\n\n    if (userlen &lt; 1)\n        return -1; /* Empty username */\n    if (userlen &gt; MAX_NAME_LEN)\n        return -2; /* Username is too long */\n    if (passlen &lt; 1)\n        return -3; /* Empty password */\n    if (passlen &gt; MAX_PASS_LEN)\n        return -4; /* Password is too long */\n\n    /* Check if this user is already known. */\n    for (i = 0; i &lt; known_users; i++)\n        if (!strcmp(user, known_user[i].name))\n            return -5; /* Username is already registered. */\n\n    if (known_users &gt;= MAX_USERS)\n        return -6; /* User database is full. */\n\n    /* Add this user to the user database. */\n    strncpy(known_user[known_users].name, user, MAX_NAME_LEN + 1);\n    strncpy(known_user[known_users].pass, pass, MAX_PASS_LEN + 1);\n\n    known_users++;\n\n    return 0; /* Success */\n}\n</code></pre>\n\n<p>Note that <code>(user) ? strlen(user) : 0</code> is a ternary expression.  It means that if <code>user</code> is not NULL, the expression evaluates to <code>strlen(user)</code>, otherwise it evaluates to 0.  (Yes, it is like a compact form of an <code>if</code> clause.)  It is common to see <code>strlen()</code> wrapped like this, because <code>strlen(NULL)</code> is not safe, and may crash the program: it is dreaded <em>Undefined Behaviour</em>, according to the C standard.  (They say <em>UB</em> may cause daemons fly out of your nose, but I think that's just a scary tale by the greybeards to make us take <em>UB</em> seriously.)</p>\n\n<p>The <code>(!strcmp(...))</code> is equivalent to <code>(strcmp(...) == 0)</code>, and is true if the two strings match exactly.</p>\n\n<p>Similarly, to check if the username and password pair matches a known user,</p>\n\n<pre><code>int verify_user(const char *user, const char *pass)\n{\n    const size_t  userlen = (user) ? strlen(user) : 0;\n    const size_t  passlen = (pass) ? strlen(pass) : 0;\n    size_t        i;\n\n    if (userlen &lt; 1)\n        return -1; /* Empty username */\n    if (userlen &gt; MAX_NAME_LEN)\n        return -2; /* Username is too long */\n    if (passlen &lt; 1)\n        return -3; /* Empty password */\n    if (passlen &gt; MAX_PASS_LEN)\n        return -4; /* Password is too long */\n\n    for (i = 0; i &lt; known_users; i++)\n        if (!strcmp(user, known_user[i].name)) {\n            if (!strcmp(pass, known_user[i].pass))\n                return 0;  /* Valid user */\n            else\n                return -6; /* Wrong password */\n        }\n\n    return -7; /* No such user. */\n}\n</code></pre>\n\n<p>At this point, you can write a small test program, and test if the above functions work. This is called <a href=\"https://en.wikipedia.org/wiki/Unit_testing\" rel=\"nofollow noreferrer\">unit testing</a>:</p>\n\n<pre><code>int main(void)\n{\n    int result;\n\n    result = register_user(\"foo\", \"bar\");\n    if (result) {\n        fprintf(stderr, \"register_user(\\\"foo\\\", \\\"bar\\\") failed: %d.\\n\", result);\n        exit(EXIT_FAILURE);\n    } else\n        fprintf(stderr, \"register_user(\\\"foo\\\", \\\"bar\\\") worked as expected (0).\\n\");\n\n    result = register_user(\"user\", \"pass\");\n    if (result) {\n        fprintf(stderr, \"register_user(\\\"user\\\", \\\"pass\\\") failed: %d.\\n\", result);\n        exit(EXIT_FAILURE);\n    } else\n        fprintf(stderr, \"register_user(\\\"user\\\", \\\"pass\\\") worked as expected (0).\\n\");\n\n    result = register_user(\"foo\", \"irrelevant\");\n    if (result) {\n        fprintf(stderr, \"register_user(\\\"foo\\\", \\\"irrelevant\\\") failed. Expected -5, received %d.\\n\", result);\n        exit(EXIT_FAILURE);\n    } else\n        fprintf(stderr, \"register_user(\\\"foo\\\", \\\"irrelevant\\\") worked as expected (-5).\\n\");\n\n    result = verify_user(\"no such\", \"user or password\");\n    if (result != -7) {\n        fprintf(stderr, \"verify_user(\\\"no such\\\", \\\"user or password\\\") failed. Expected -7, received %d.\\n\", result);\n        exit(EXIT_FAILURE);\n    } else\n        fprintf(stderr, \"verify_user(\\\"no such\\\", \\\"user or password\\\") worked as expected (-7).\\n\");\n\n    result = verify_user(\"foo\", \"wrong password\");\n    if (result != -6) {\n        fprintf(stderr, \"verify_user(\\\"foo\\\", \\\"wrong password\\\") failed. Expected -6, received %d.\\n\", result);\n        exit(EXIT_FAILURE);\n    } else\n        fprintf(stderr, \"verify_user(\\\"foo\\\", \\\"wrong password\\\") worked as expected (-6).\\n\");\n\n    result = verify_user(\"foo\", \"bar\");\n    if (result != 0) {\n        fprintf(stderr, \"verify_user(\\\"foo\\\", \\\"bar\\\") failed. Expected 0, received %d.\\n\", result);\n        exit(EXIT_FAILURE);\n    } else\n        fprintf(stderr, \"verify_user(\\\"foo\\\", \\\"bar\\\") worked as expected (0).\\n\");\n\n    printf(\"All tests successful.\\n\");\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>When you get better at programming, you can \"automate\" such testing using various ways.</p>\n\n<p>Only when your test program works correctly for the tests (and do test both correct and incorrect inputs and their results!), continue onwards with solving the original problem.</p>\n\n<p>That way, you know those two functions work, and you know that any issues or bugs must be elsewhere. (If you are not sure, you can add that input to the unit testing program, and verify!)</p>\n\n<hr>\n\n<p>It is not a good idea to store passwords in plain text. Ever.  You don't need to do that, either.</p>\n\n<p>What you should do, is use a <a href=\"https://en.wikipedia.org/wiki/Hash_function\" rel=\"nofollow noreferrer\">hash function</a> to convert the password to a large number; the hash function should be <em>cryptographically secure</em>. The password should be <a href=\"https://en.wikipedia.org/wiki/Salt_(cryptography)\" rel=\"nofollow noreferrer\">salted</a>, too: a random number or string, that is saved as plain text, that is prepended (or appended or both) to the password, and the combination is supplied to the hash function.  To make any dictionary attacks slow, the hash function is usually applied a large number of times; this number can vary, but a fixed number of rounds is usually just as safe.</p>\n\n<p>In this case, the user information is something like</p>\n\n<pre><code>#define  MAX_NAME_LEN  31\n#define  HASH_SIZE     64    /* for 512-bit hashes like SHA512 */\n#define  SALT_SIZE     16    /* for 128-bit salt */\n#define  HASH_ROUNDS   5000\n\ntypedef struct {\n    char           name[MAX_NAME_LEN + 1];\n    unsigned char  salt[SALT_SIZE];\n    unsigned char  hash[HASH_SIZE];\n} userinfo;\n</code></pre>\n\n<p>Let's say the cryptographically secure hash function we can use is declared as</p>\n\n<pre><code>void crypto_hash(unsigned char *hash, const void *data, const size_t size);\n</code></pre>\n\n<p>and we have a cryptographically secure random number generator that generates a random salt when we need one using</p>\n\n<pre><code>void crypto_salt(unsigned char *salt);\n</code></pre>\n\n<p>then our user registration function becomes</p>\n\n<pre><code>int register_user(const char *user, const char *pass)\n{\n    const size_t   userlen = (user) ? strlen(user) : 0;\n    const size_t   passlen = (pass) ? strlen(pass) : 0;\n    unsigned char *temp;\n    unsigned char  hash[2][HASH_SIZE];\n    size_t         i;\n\n    if (userlen &lt; 1)\n        return -1; /* Empty username */\n    if (userlen &gt; MAX_NAME_LEN)\n        return -2; /* Username is too long */\n    if (passlen &lt; 1)\n        return -3; /* Empty password */\n\n    /* TODO: Password strength checking! */\n\n    /* Check if this user is already known. */\n    for (i = 0; i &lt; known_users; i++)\n        if (!strcmp(user, known_user[i].name))\n            return -5; /* Username is already registered. */\n\n    if (known_users &gt;= MAX_USERS)\n        return -6; /* User database is full. */\n\n    /* Generate a random salt for this new user. */\n    crypto_salt(known_user[i].salt);\n\n    /* Allocate a temporary buffer for the salt and the password.\n       Here, for simplicity, we just prepend the salt to the password,\n       and include the string-terminating nul byte, '\\0'.\n       This is to protect against a certain type of tail attacks. */\n    temp = malloc(SALT_SIZE + pass_len + 1);\n    if (!temp)\n        return -8; /* Not enough memory. */\n\n    /* Combine the salt and the password, including '\\0' at end. */\n    memcpy(temp, known_user[known_users].salt, SALT_SIZE);\n    memcpy(temp + SALT_SIZE, pass, passlen + 1);\n\n    /* First hashing round. */\n    crypto_hash(hash[0], temp, SALT_SIZE + passlen + 1);\n\n    /* The temporary buffer is no longer needed.\n       We wipe, then free it. */\n    memset(temp, 0, SALT_SIZE + passlen + 1);\n    free(temp);\n\n    /* Repeated rounds. */\n    for (i = 0; i &lt; HASH_ROUNDS - 2; i++)\n        crypto_hash(hash[(i+1) &amp; 1], hash[i &amp; 1], HASH_SIZE);\n\n    /* Final round. Since i was incremented after the last\n       crypto_hash() call, the last hash is in hash[i &amp; 1]. */\n    crypto_hash(known_user[known_users].hash, hash[i &amp; 1], HASH_SIZE);\n\n    /* Wipe the temporary hash table. */\n    memset(hash[0], 0, HASH_SIZE);\n    memset(hash[1], 0, HASH_SIZE);\n\n    /* Add this user to the user database. */\n    strncpy(known_user[known_users].name, user, MAX_NAME_LEN + 1);\n    known_users++;\n    return 0; /* Success */\n}\n</code></pre>\n\n<p>Two temporary hash slots are used, because usually the <code>crypto_hash()</code> functions expect the result to be somewhere else than the source is.</p>\n\n<p>User name and password check becomes</p>\n\n<pre><code>int verify_user(const char *user, const char *pass)\n{\n    const size_t   userlen = (user) ? strlen(user) : 0;\n    const size_t   passlen = (pass) ? strlen(pass) : 0;\n    unsigned char *temp;\n    unsigned char  hash[2][HASH_SIZE];\n    size_t         i, u;\n    int            result;\n\n    if (userlen &lt; 1)\n        return -1; /* Empty username */\n    if (userlen &gt; MAX_NAME_LEN)\n        return -2; /* Username is too long */\n    if (passlen &lt; 1)\n        return -3; /* Empty password */\n\n    for (u = 0; i &lt; known_users; i++)\n        if (!strcmp(user, known_user[u].name))\n            break; /* u will be less than known_users */\n    if (u &gt;= known_users)\n        return -7; /* No such user */\n\n    /* known_user[u] matches the name. */\n\n    /* Allocate a temporary area for combining this users' salt\n       and the supplied password. */\n    temp = malloc(HASH_SIZE + passlen + 1);\n    if (!temp)\n        return -8; /* Out of memory. */\n\n    /* Combine the salt and the password the same way as when\n       the user and password was registered. */\n    memcpy(temp, known_user[u].salt, SALT_SIZE);\n    memcpy(temp + SALT_SIZE, pass, passlen + 1);\n\n    /* Calculate the hash the same way. First pass: */\n    crypto_hash(hash[0], temp, SALT_SIZE + passlen + 1);\n\n    /* Temporary buffer is no longer needed, so clear and free it. */\n    memset(temp, 0, SALT_SIZE + passlen + 1);\n    free(temp);\n\n    /* Repeated rounds, including the final round. */\n    for (i = 0; i &lt; HASH_ROUNDS - 1; i++)\n        crypto_hash(hash[(i+1) &amp; 1], hash[i &amp; 1], HASH_SIZE);\n\n    /* Because i was incremented after the last crypto_hash() call,\n       hash[i &amp; 1] is where the final hash is. Compare. */\n    if (!memcmp(hash[i &amp; 1], known_user[u].hash))\n        result =  0; /* Valid password for the user! */\n    else\n        result = -6; /* Wrong password. */\n\n    /* Wipe the temporary hash buffer. */\n    memset(hash[0], 0, HASH_SIZE);\n    memset(hash[1], 0, HASH_SIZE);\n\n    return result;\n}\n</code></pre>\n\n<p>In a practical application, it is best to <em>not</em> differentiate between <em>\"unknown user\"</em> and <em>\"wrong password\"</em>, because knowing which usernames are valid, can make certain attacks easier.</p>\n"}], "owner": {"reputation": 3, "user_id": 10686552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QC8vwVgdf7w/AAAAAAAAAAI/AAAAAAAAABs/yc1BkAtW3B8/photo.jpg?sz=128", "display_name": "yandyfebryan", "link": "https://stackoverflow.com/users/10686552/yandyfebryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1062, "favorite_count": 1, "accepted_answer_id": 53416492, "answer_count": 2, "score": 0, "last_activity_date": 1542819876, "creation_date": 1542815780, "question_id": 53415897, "link": "https://stackoverflow.com/questions/53415897/user-login-registration-cant-register-more-than-one-user-in-c", "title": "User Login &amp; Registration: can&#39;t register more than one user in C", "body": "<p>i'm working on this c project which deals with a user registration and login program. The problem is that the program was successful, but for only one user. Can you guys please explain what is wrong and what are the things that I should change? Thanks in advance.</p>\n\n<p>P.S\nThis is my first question in stackoverflow</p>\n\n<p>English isn't my main language</p>\n\n<p>Anyways here's my code in C below:</p>\n\n<pre><code>#include &lt;conio.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nstatic int i=0;\nstruct w\n{\nchar nama[30],pass[30];\n}\nw[100];\nint n;\nvoid login(void);\nvoid reg(void);\nint main(void)\n{\nmenu:\nsystem(\"cls\");\nprintf(\"\\n\\n\\n\\n\\n\\t\\t\\t\\tWELCOME!\");\nprintf(\"\\n\\n\\n\\n\\t\\t\\t\\t\\t\\t[ENTER]\");\nif(getch()==13)\n{\n    system(\"cls\");\n}\n    else\n{\n    goto menu;\n}\nmenu_main:\nprintf(\"\\n\\n\\n\\t\\t\\t[1] LOGIN\\t\\t[2] REGISTRATION\\t\\t[3] EXIT APP\");\nprintf(\"\\n\\n\\n\\t\\t\\t\\t  INPUT YOUR SELECTION THEN PRESS [ENTER]: \");\nscanf(\"%d\",&amp;n);\nswitch(n)\n  {\n    case 1: system(\"cls\");\n        login();\n        break;\n    case 2: system(\"cls\");\n        reg();\n        break;\n    case 3:system(\"cls\");\n        printf(\"\\n\\n\\t\\t\\t\\tTHANK YOU FOR USING THIS APP\\n\");\n        break;\n    default: system(\"cls\"); printf(\"\\n\\n\\t\\t\\t\\tNOT AVAILABLE\");\n        printf(\"\\n\\n\\t\\t\\tPRESS ANY KEY TO GO BACK\");\n        getch();\n        system(\"cls\"); goto menu_main;\n    }\n}\nvoid reg()\n  {\n    FILE *fp;\n    char c,username[30]; int z=0;\n    fp=fopen(\"file.txt\",\"ab+\");\n    system(\"cls\");\n    printf(\"\\n\\n\\t\\tPLEASE INPUT USERNAME &amp; PASSWORD\");\n    for(i=0;i&lt;99;i++)\n    {\n      printf(\"\\n\\n\\t\\t\\t\\t  USERNAME: \");\n      scanf(\"%s\",username);\n        while(!feof(fp))\n        {\n          fread(&amp;w[i],sizeof(w[i]),1,fp);\n          if(strcmp(username,w[i].nama)==0)\n            {\n            system(\"cls\");\n            printf(\"\\n\\n\\t\\t\\t  USERNAME IS NOT AVAILABLE\");\n            printf(\"\\n\\n\\t\\t\\t  PRESS ANY KEY TO GO BACK\");\n            getch();\n            system(\"cls\"); reg();\n            }\n          else\n          {\n            strcpy(w[i].nama,username);\n            break;\n          }\n        }\n      z=0;\n      printf(\"\\n\\n\\t\\t\\t\\t  PASSWORD: \");\n      while((c=getch())!=13)\n        {\n          w[i].pass[z++]=c;\n          printf(\"%c\",'*');\n        }\n      fwrite(&amp;w[i],sizeof(w[i]),1,fp);\n      fclose(fp);\n      printf(\"\\n\\n\\tPRESS [ENTER] IF YOU AGREE\");\n      if((c=getch())==13)\n        {\n        system(\"cls\");\n        printf(\"\\n\\n\\t\\tYOU ARE REGISTERED!\");\n        printf(\"\\n\\n\\t\\tWOULD YOU LIKE TO LOGIN?\\n\\n\\t\\t  \");\n        printf(\" PRESS [1] FOR YES\\n\\n\\t\\t   PRESS [2] FOR NO\\n\\n\\t\\t\\t\\t\");\n        scanf(\"%d\",&amp;n);\n        if(n==1)\n          { \n            system(\"cls\");\n            login();\n          }\n            else if(n==2)\n          {\n            system(\"cls\");\n            printf(\"\\n\\n\\n\\t\\t\\t\\tTHANK YOU FOR REGISTERING IN THIS APP\\n\");\n          } \n        }\n        break;\n      }\n  }\n  void login()\n    {\n      FILE *fp;\n      char c,nama[10],pass[10]; int z=0;\n      int cekun,cekpw;\n      fp=fopen(\"file.txt\",\"r\");\n      for(i=0;i&lt;=10;i++)\n      {\n        printf(\"\\n\\n\\t\\t\\t\\t  USERNAME: \");\n        scanf(\"%s\",nama);\n\n        system(\"cls\");\n        printf(\"\\n\\n\\t\\t\\t\\t  PASSWORD: \");\n        while((c=getch())!=13)\n        {\n          pass[z++]=c;\n          printf(\"%c\",'*');\n        }\n        pass[z]='\\0';\n        while(!feof(fp))\n        {\n        fread(&amp;w[i],sizeof(w[i]),1,fp);\n          cekun=strcmp(nama,w[i].nama);\n          cekpw=strcmp(pass,w[i].pass);\n          if(cekun==0&amp;&amp;cekpw==0)\n          {\n            system(\"cls\");\n            printf(\"\\n\\n\\n\\t\\t\\tLOGIN SUCCESSFUL!\");\n            break;\n          }\n        else if(cekun==0)\n          {\n            printf(\"\\n\\n\\n\\t\\t\\tWRONG PASSWORD!\");\n            printf(\"\\n\\n\\t\\t\\t\\t  (PRESS [Y] TO RE-LOGIN)\");\n            if(getch()=='y'||getch()=='Y')\n              system(\"cls\"); login();\n          }\n        else if(cekun!=0&amp;&amp;cekpw!=0)\n          {\n            h:\n            printf(\"\\n\\n\\n\\t\\t\\tYOU ARE NOT REGISTERED\\n \\t\\t\\tPRESS [ENTER] TO REGISTER\");\n            if(getch()==13)\n            system(\"cls\"); reg();\n          }\n          else if(cekun!=0&amp;&amp;cekpw==0)\n          {\n            goto h;\n          }\n        }\n        break;\n      }\n      getch();\n    }\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1542817103, "post_id": 53415817, "comment_id": 93707004, "body": "You need to use the opened directory name (<code>C:&#47;Users&#47;Start&#47;</code> \u2014 but you need that in a variable so you can use it more than once without writing the value out more than once) and the file read from it to create the path for the source file \u2014 string concatenation.  Then you call the function."}, {"owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 0, "creation_date": 1542820951, "post_id": 53415817, "comment_id": 93709243, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/26577984/how-to-move-a-file-in-c\">How to move a file in C</a>"}], "owner": {"reputation": 11, "user_id": 4191965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72f0ef11757cce1e41b49e7b99038585?s=128&d=identicon&r=PG&f=1", "display_name": "Citrusl", "link": "https://stackoverflow.com/users/4191965/citrusl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1073, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542815783, "creation_date": 1542815539, "last_edit_date": 1542815783, "question_id": 53415817, "link": "https://stackoverflow.com/questions/53415817/how-to-move-files-in-c-programming-movefiles", "title": "How to move files in C programming? (movefiles())", "body": "<p>I'm trying to open the Start folder, search for all the files there, and move them to another folder, how can i do to save the \"file\" parameter to use movefile() function? </p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;dirent.h&gt;\n#include &lt;windows.h&gt;\n\nBOOL MoveFile( LPCTSTR  lpExistingFileName, LPCTSTR  lpNewFileName);                     \nint main()\n{\n    DIR *dir;\n    struct dirent *ent;\n    dir = opendir (\"C:/Users/Start/\");\n\n    while ((ent = readdir (dir)) != NULL) \n    {\n        MoveFile(????, \"C:/Users/Destiny/\"); //how? \n    }\n\n    closedir (dir);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "c-strings"], "comments": [{"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 7, "creation_date": 1542814498, "post_id": 53415467, "comment_id": 93705372, "body": "<code>char *names[n]</code> is an array of <code>char *</code>. It points to nothing (garbage) when you attempt to write a string to it.  You need to allocate <code>char []</code> memory for it."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1542815440, "post_id": 53415467, "comment_id": 93705945, "body": "Take the <a href=\"https://stackoverflow.com/tour\">tour</a>, read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. What exactly does &quot;does not work&quot; really mean? <a href=\"https://stackoverflow.com/posts/53415467/edit\">Edit</a> your post and show some sample inputs/outputs."}], "owner": {"reputation": 49, "user_id": 10553544, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-niuuwWUYnAY/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDH6HNJ-1-xNZiEqsFgNiwZUkC7uw/mo/photo.jpg?sz=128", "display_name": "Abhi-shek", "link": "https://stackoverflow.com/users/10553544/abhi-shek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542816447, "creation_date": 1542814418, "last_edit_date": 1542814767, "question_id": 53415467, "link": "https://stackoverflow.com/questions/53415467/creating-array-of-character-pointers", "title": "Creating array of character pointers", "body": "<p>Please tell me what's wrong with this code.</p>\n\n<p>Program to input number of students, their names and then print their names.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main() {\n    int n, i;\n    scanf(\"%d\", &amp;n); // number of students\n    char* names[n]; // array of pointers.\n    for(i = 0; i &lt; n; i++) {\n        scanf(\"%100[^\\n]\", names[i]); //student names \n    }\n\n    for(i = 0; i &lt; n; i++){\n        printf(\"%s\", names[i]); // printing students names\n    }\n}\n</code></pre>\n\n<p>It does not show any error on compiling but it does not work.</p>\n"}, {"tags": ["c", "linker", "linker-errors", "rom"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1542817419, "post_id": 53415414, "comment_id": 93707194, "body": "Good luck finding a solution; I don&#39;t really understand the problem.  I think you should look hard at whether <code>a *= b&#47;c;</code> produces the same answer as <code>a = (a * b) &#47; c;</code> \u2014 and decide which answer you want.  Why is the ROM space limited to 16 bytes?  Can&#39;t you double it, and try again, or add more?  Or has your program simply grown too big and you have to remove code somewhere else?"}, {"owner": {"reputation": 1, "user_id": 8599964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bde3a55fea912ed2763fc970a8fd8c1?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas J", "link": "https://stackoverflow.com/users/8599964/thomas-j"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1543217485, "post_id": 53415414, "comment_id": 93822946, "body": "@JonathanLeffler This is an embedded application, so I can&#39;t change any of these settings. It turned out to work just fine when I moved this piece of code to a .h file instead of a .c file. There&#39;s something in the linking stage that causes the error when it deals with 64 bit data types rather than 32. I actually tried doing all of this on one line, and only resorted to what you see in the example later on when I was trying to find out where the error was coming from. In any case, the code finally compiles correctly, although I have no idea why."}], "owner": {"reputation": 1, "user_id": 8599964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bde3a55fea912ed2763fc970a8fd8c1?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas J", "link": "https://stackoverflow.com/users/8599964/thomas-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 304, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542817504, "creation_date": 1542814251, "last_edit_date": 1542817504, "question_id": 53415414, "link": "https://stackoverflow.com/questions/53415414/range-restriction-byte-requirement", "title": "Range restriction byte requirement", "body": "<p>I have a linking error in a simple piece of code, and I know where the issue is. </p>\n\n<pre><code>long long maxClampRange(long maxClamp, long LoopGainFactor, long LoopGain)\n{\n    long long tempMax = (long long)maxClamp;\n    long long tempMaxClamp;\n    tempMaxClamp = (tempMax &lt;&lt; 24);\n    tempMaxClamp *= (long long)LoopGainFactor/LoopGain;\n\n    return tempMaxClamp;\n}\n</code></pre>\n\n<p>The line shift left by 24 causes the issue when tempMax is a 64 bit long long datatype. </p>\n\n<p>What I am wondering, is how to calculate the amount of ROM that I need for this to link properly.</p>\n\n<p>The actual error is </p>\n\n<pre><code>    lk166 E112: cannot locate 1 sections(s) \n    lk166 I455: requirement:0x10 bytes of ROM area in space spe:xc16x:code'\n    lk166 I456: section type: ranged page restriction - any range of [0 .. 65536] with page alignment 65536 within range(s) 0xc0ba00-0xc0be00\n</code></pre>\n\n<p>I haven't figured out a way to break up the code that will make this work without using 32 bit long types. But, that causes everything to long work properly since it's not large enough to hold the shift.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 9, "creation_date": 1542813126, "post_id": 53415043, "comment_id": 93704538, "body": "How do you think the values in your enum are represented internally?"}, {"owner": {"reputation": 23, "user_id": 10675552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70edd2735b1362f05f2a91a4ec6582c8?s=128&d=identicon&r=PG&f=1", "display_name": "CEXDSINGH", "link": "https://stackoverflow.com/users/10675552/cexdsingh"}, "reply_to_user": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1542813184, "post_id": 53415043, "comment_id": 93704575, "body": "If I change it to be TRuuue and Faaalse, it still returns 0 and 1."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1542813281, "post_id": 53415043, "comment_id": 93704637, "body": "Changing the names has absolutely <i>nothing</i> to do with Govind&#39;s question. Changing the <i>order</i> in the enum (<code>{ True, False }</code>) would be significant. Is that what you meant ?"}, {"owner": {"reputation": 23, "user_id": 10675552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70edd2735b1362f05f2a91a4ec6582c8?s=128&d=identicon&r=PG&f=1", "display_name": "CEXDSINGH", "link": "https://stackoverflow.com/users/10675552/cexdsingh"}, "edited": false, "score": 1, "creation_date": 1542813379, "post_id": 53415043, "comment_id": 93704695, "body": "In that case,  I am clueless."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 3, "creation_date": 1542813503, "post_id": 53415043, "comment_id": 93704779, "body": "also : <a href=\"https://stackoverflow.com/questions/9907160/how-to-convert-enum-names-to-string-in-c\">How to convert enum names to string in c</a>"}], "answers": [{"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 2, "last_activity_date": 1542813376, "creation_date": 1542813376, "answer_id": 53415132, "question_id": 53415043, "link": "https://stackoverflow.com/questions/53415043/why-is-it-returning-0-or-1-and-not-true-or-false/53415132#53415132", "title": "Why is it returning 0 or 1 and not True or False", "body": "<p>From the <strong><a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1548.pdf\" rel=\"nofollow noreferrer\">C Standard</a>, \u00a7 6.7.2.2:2-3</strong>:</p>\n\n<blockquote>\n  <p>The identifiers in an enumerator list are declared as constants that have type int and\n  may appear wherever such are permitted.) An enumerator with = defines its\n  enumeration constant as the value of the constant expression. <strong>If the first enumerator has\n  no =, the value ... is 0</strong>. Each subsequent enumerator with no =\n  defines its ... value ... by\n  <strong>adding 1 to the value of the previous enumeration constant</strong>.</p>\n</blockquote>\n\n<p>Emphasis mine.</p>\n"}, {"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1542814028, "post_id": 53415144, "comment_id": 93705074, "body": "The enum token can only be used in the program text."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1542814567, "post_id": 53415144, "comment_id": 93705409, "body": "Token names may also be available in debugging databases, depending on build settings (like a <code>.pdb</code> file on Windows)"}, {"owner": {"reputation": 1588, "user_id": 6082851, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b14f3cd864bc266a401eca07b4153602?s=128&d=identicon&r=PG", "display_name": "12431234123412341234123", "link": "https://stackoverflow.com/users/6082851/12431234123412341234123"}, "edited": false, "score": 0, "creation_date": 1602505786, "post_id": 53415144, "comment_id": 113733161, "body": "A <code>enum</code> does not have to be a <code>int</code>."}, {"owner": {"reputation": 1588, "user_id": 6082851, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b14f3cd864bc266a401eca07b4153602?s=128&d=identicon&r=PG", "display_name": "12431234123412341234123", "link": "https://stackoverflow.com/users/6082851/12431234123412341234123"}, "edited": false, "score": 0, "creation_date": 1602506057, "post_id": 53415144, "comment_id": 113733294, "body": "A <code>enum</code> does no have to a <code>int</code> but can also be any integer type, which it can represent all values. <i>Each enumerated type shall be compatible with <code>char</code>, a signed integer type, or an unsigned integer type. The choice of type is implementationdefined, 128) but shall be capable of representing the values of all the members of the enumeration. ...</i> From 6.7.2.2 Enumeration specifiers - 4"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1542813756, "last_edit_date": 1542813756, "creation_date": 1542813405, "answer_id": 53415144, "question_id": 53415043, "link": "https://stackoverflow.com/questions/53415043/why-is-it-returning-0-or-1-and-not-true-or-false/53415144#53415144", "title": "Why is it returning 0 or 1 and not True or False", "body": "<p>In <code>C</code> an <code>enum</code> is no more than an <code>int</code> type but with special symbols for a subset of those <code>int</code>s. Also, unless you tell it otherwise, the implicit <code>int</code> value for the first <code>enum</code> member is 0, the second is 1, and so on.</p>\n\n<p><code>%i</code> can be used to print an <code>int</code>, which accounts for the output.</p>\n\n<p>It is not possible to display the actual <code>enum</code> token in portable C, although there are idiomatic approaches that make use of the preprocessor.</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1542813512, "post_id": 53415156, "comment_id": 93704784, "body": "Upped. Compared to my answer, this one is useful."}, {"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1542813592, "post_id": 53415156, "comment_id": 93704834, "body": "@Bathsheba Your answer is useful too. I gave you a +1 as it&#39;s more detailed."}], "tags": [], "owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "is_accepted": true, "score": 3, "last_activity_date": 1542813443, "creation_date": 1542813443, "answer_id": 53415156, "question_id": 53415043, "link": "https://stackoverflow.com/questions/53415043/why-is-it-returning-0-or-1-and-not-true-or-false/53415156#53415156", "title": "Why is it returning 0 or 1 and not True or False", "body": "<p>If you want it to print the string <code>true</code> or <code>false</code> you'll have to add something like this:</p>\n\n<pre><code>printf(\"The answer is: %s\\n\", ans ? \"true\" : \"false\");\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10675552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70edd2735b1362f05f2a91a4ec6582c8?s=128&d=identicon&r=PG&f=1", "display_name": "CEXDSINGH", "link": "https://stackoverflow.com/users/10675552/cexdsingh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "closed_date": 1542816262, "accepted_answer_id": 53415156, "answer_count": 3, "score": 0, "last_activity_date": 1542816275, "creation_date": 1542813091, "question_id": 53415043, "link": "https://stackoverflow.com/questions/53415043/why-is-it-returning-0-or-1-and-not-true-or-false", "closed_reason": "Duplicate", "title": "Why is it returning 0 or 1 and not True or False", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\ntypedef enum{\n    False,\n    True\n}Bool;\nint main(int argc, char const *argv[])\n{\n    int a = 1, d = 1;\n    Bool b = False, c = True;\n    Bool ans;\n    if (a == d)\n    {\n        ans = c;\n\n    }\n    else\n    {\n        ans = b;\n    }\n    printf(\"The answer is: %i \\n\", ans);\n    return 0;\n}\n</code></pre>\n\n<p>I think it is only returning the execution result 0 or 1.\nI want it to return the values from the enum which I created.</p>\n"}, {"tags": ["c", "thread-safety"], "answers": [{"comments": [{"owner": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1542828783, "post_id": 53416572, "comment_id": 93712822, "body": "An operation on a <code>volatile</code> does not (have to) set a memory barrier because concurrent read/write access is undefined."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1542871572, "post_id": 53416572, "comment_id": 93725712, "body": "@LWimsey I just cited all over this answer why it concurrent <i>execution</i> is well-defined. Sequencing is defined in C17 5.1.2.3 &#167;3. Concurrent access of data memory is another story. The purpose of memory barriers is to guarantee order of execution, not to guarantee thread-safety of data. If you use the <code>volatile</code> keyword, then implementing memory barriers correctly in the underlying machine code is the C compiler&#39;s job."}, {"owner": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1542945689, "post_id": 53416572, "comment_id": 93754182, "body": "Your quotes are about evaluation order on <code>volatile</code> objects. The compiler must ensure they are evaluated according to the rules of the abstact machine, but that does not mean the effects of those operations are observed by other threads in the same order. In fact, reasoning about ordering with respect to other threads is meaningless because <code>volatile</code> does not make an object data-race-free.  I am not sure though how you see the difference between &quot;<i>concurrent execution is well-defined</i>&quot; and then &quot;<i>Concurrent access of data memory is another story</i>&quot;, but concurrent read/write access ...."}, {"owner": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1542945723, "post_id": 53416572, "comment_id": 93754189, "body": ".... on a non-atomic object is undefined behavior per C17 5.1.2.4 &#167;35: <i>The execution of a program contains a data race if it contains two conflicting actions in different threads, at least one of which is not atomic, and neither happens before the other. Any such data race results in undefined behavior.</i> Since operations on <code>volatile</code> objects are only well-defined within a single thread (without additional synchronization), memory barriers are not involved. Microsoft compilers have used memory barriers on <code>volatile</code> operations, but that is based on a stronger guarantee than necessary."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1542958538, "post_id": 53416572, "comment_id": 93757613, "body": "@LWimsey What I mean is that order of execution per thread is well-defined. If the compiler were to parallelize execution so that it get executed by multiple cores - which the C standard does not inhibit - it must still follow the rules of the abstract machine. This includes things like instruction caching, branch prediction and pipeline execution."}, {"owner": {"reputation": 171, "user_id": 5086936, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dRGfLmFlyJk/AAAAAAAAAAI/AAAAAAAAADk/vU52v9L9Ivw/photo.jpg?sz=128", "display_name": "Jeroen Demeyer", "link": "https://stackoverflow.com/users/5086936/jeroen-demeyer"}, "reply_to_user": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1542968728, "post_id": 53416572, "comment_id": 93762580, "body": "@LWimsey You are talking about &quot;concurrent access on a non-atomic object&quot; but that&#39;s not what my question is about. One can get atomicity for assignment by using the type sig_atomic_t (I&#39;ll edit the question). My question is about the order of the 2 assignments."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 171, "user_id": 5086936, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dRGfLmFlyJk/AAAAAAAAAAI/AAAAAAAAADk/vU52v9L9Ivw/photo.jpg?sz=128", "display_name": "Jeroen Demeyer", "link": "https://stackoverflow.com/users/5086936/jeroen-demeyer"}, "edited": false, "score": 0, "creation_date": 1542970036, "post_id": 53416572, "comment_id": 93763224, "body": "@JeroenDemeyer In your example, the 2 assignments are obviously carried out by the same thread, which is addressed by this answer and <i>not</i> thread-safety. I guess I have no idea what you are asking for."}, {"owner": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "reply_to_user": {"reputation": 171, "user_id": 5086936, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dRGfLmFlyJk/AAAAAAAAAAI/AAAAAAAAADk/vU52v9L9Ivw/photo.jpg?sz=128", "display_name": "Jeroen Demeyer", "link": "https://stackoverflow.com/users/5086936/jeroen-demeyer"}, "edited": false, "score": 0, "creation_date": 1542999498, "post_id": 53416572, "comment_id": 93775998, "body": "@JeroenDemeyer You are right, but it came up because memory barriers were mentioned"}, {"owner": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1543001803, "post_id": 53416572, "comment_id": 93776762, "body": "@Lundin That the execution order per thread is well-defined is a given.. If a CPU could not see its own stores right away, it would be practically impossible to program"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1542817856, "creation_date": 1542817856, "answer_id": 53416572, "question_id": 53415018, "link": "https://stackoverflow.com/questions/53415018/c-thread-safety-and-order-of-operations/53416572#53416572", "title": "C: thread safety and order of operations", "body": "<p>The C standard specifies a term called <em>observable behavior</em>. This means that at a minimum, the compiler/system has a few restrictions: it is not allowed to re-order expressions containing <code>volatile</code>-qualified operands, nor is it allowed to re-order input/output.</p>\n\n<p>Apart from those special cases, anything is fair game. It may execute y before x, it may execute them in parallel. It might optimize the whole code away as there are no observable side-effects in the code. And so on.</p>\n\n<p>Please note that thread-safety and order of execution are different things. Threads are created explicitly by the programmer/libraries. A context switch may interrupt any variable acccess which is not atomic. That's another issue and the solution is to use mutex, <code>_Atomic</code> qualifier or similar protection mechanisms.</p>\n\n<hr>\n\n<p>If the order matters, you should <code>volatile</code>-qualify the variables. In that case, the following guarantees are made by the language:</p>\n\n<p>C17 5.1.2.3 \u00a7 6 (the definition of observable behavior):</p>\n\n<blockquote>\n  <p>Accesses to volatile objects are evaluated strictly according to the rules of the abstract machine.  </p>\n</blockquote>\n\n<p>C17 5.1.2.3 \u00a7 4:</p>\n\n<blockquote>\n  <p>In the abstract machine, all expressions are evaluated as specified by the semantics.</p>\n</blockquote>\n\n<p>Where \"semantics\" is pretty much the whole standard, for example the part that specifies that a <code>;</code> consists of a sequence point. (In this case, C17 6.7.6 \"The end of a full\ndeclarator is a sequence point.\" The term \"sequenced before\" is specified in C17 5.1.2.3 \u00a73). </p>\n\n<p>So given this:</p>\n\n<pre><code>volatile int x = 1;\nvolatile int y = 1;\n</code></pre>\n\n<p>then the order of initialization is guaranteed to be x before y, as the <code>;</code> of the first line guarantees the sequencing order, and <code>volatile</code> guarantees that the program strictly follows the evaluation order specified in the standard.</p>\n\n<hr>\n\n<p>Now as it happens in the real world, <code>volatile</code> does not guarantee memory barriers on many compiler implementations for multi-core systems. Those implementations are not conforming.</p>\n\n<p>Opportunist compilers might claim that the programmer must use system-specific memory barriers to guarantee order of execution. But in case of <code>volatile</code>, that is not true, as proven above. They just want to dodge their responsibility and hand it over to the programmers. The C standard doesn't care if the CPU has 57 cores, branch prediction and instruction pipelining. </p>\n"}, {"tags": [], "owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "is_accepted": false, "score": 1, "last_activity_date": 1542817977, "creation_date": 1542817977, "answer_id": 53416613, "question_id": 53415018, "link": "https://stackoverflow.com/questions/53415018/c-thread-safety-and-order-of-operations/53416613#53416613", "title": "C: thread safety and order of operations", "body": "<p>Yes, the compiler may change the order of the two assignments, because the reordering is not \"observable\" <em>as defined by the C standard</em>, e.g., there are no side-effects to the assignments (again, as defined by the C standard, which does not consider the existence of an outside observer).</p>\n\n<p>In practice you need some kind of barrier/fence to guarantee the order, e.g., use the services provided by your multithreading environment, or possibly C11 <code>stdatomic.h</code> if available.</p>\n"}], "owner": {"reputation": 171, "user_id": 5086936, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dRGfLmFlyJk/AAAAAAAAAAI/AAAAAAAAADk/vU52v9L9Ivw/photo.jpg?sz=128", "display_name": "Jeroen Demeyer", "link": "https://stackoverflow.com/users/5086936/jeroen-demeyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1542968753, "creation_date": 1542813018, "last_edit_date": 1542968753, "question_id": 53415018, "link": "https://stackoverflow.com/questions/53415018/c-thread-safety-and-order-of-operations", "title": "C: thread safety and order of operations", "body": "<p>Consider the following C code:</p>\n\n<pre><code>static sig_atomic_t x;\nstatic sig_atomic_t y;\n\nint foo()\n{\n    x = 1;\n    y = 2;\n}\n</code></pre>\n\n<p>First question: can the C compiler decide to \"optimize\" the code for <code>foo</code> to <code>y = 2; x = 1</code> (in the sense that the memory location for <code>y</code> is changed before the memory location for <code>x</code>)? This would be equivalent, except when multiple threads or signals are involved.</p>\n\n<p>If the answer to the first question is \"yes\": what should I do if I really want the guarantee that <code>x</code> is stored before <code>y</code>?</p>\n"}, {"tags": ["python", "c", "function", "struct", "swig"], "comments": [{"owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1542832803, "post_id": 53414931, "comment_id": 93714557, "body": "The example that you are self referring to <a href=\"https://stackoverflow.com/questions/1583293/using-swig-with-pointer-to-function-in-c-struct\" title=\"using swig with pointer to function in c struct\">stackoverflow.com/questions/1583293/&hellip;</a> considers a struct with a function pointer member and shows how this can be called from Python. How is this different from what you are trying to do"}, {"owner": {"reputation": 53, "user_id": 1169691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dbc76e74690308e46afef6cf86d9dd0?s=128&d=identicon&r=PG", "display_name": "Jef de Busser", "link": "https://stackoverflow.com/users/1169691/jef-de-busser"}, "reply_to_user": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1542894785, "post_id": 53414931, "comment_id": 93738644, "body": "The situation is the same. However the solution is not what I hoped it to be.   Having to repeat every declaration of structure and function related to functions pointer in the interface file is not the best solution.   In that case I might as well write the wrappers to call the code from python by hand. I specifically want to be able to tell SWIG to make function pointers callable."}, {"owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 1, "creation_date": 1542900496, "post_id": 53414931, "comment_id": 93741914, "body": "SWIG is capable of so much more and you don&#39;t need to work on such a low level and use naked pointers and do casting. All functions can be wrapped and it can even generate a run-time, which can be used for querying stuff. My advice is to skip the <code>typedef</code>ed function prototypes and simply wrap the actual functions. The will be enclosed in a library. If you need initialization, use <code>attribute(constructor)</code> in *nix or in Windows <code>DLL_PROCESS_ATTACH </code>"}, {"owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 1, "creation_date": 1542900866, "post_id": 53414931, "comment_id": 93742123, "body": "If you like, I have a small project here, which does a lot of swigging, <a href=\"http://github.com/JensMunkHansen/sofus\" rel=\"nofollow noreferrer\">github.com/JensMunkHansen/sofus</a>"}, {"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1542959799, "post_id": 53414931, "comment_id": 93758109, "body": "I&#39;m currently thinking about solutions to this, but for now I&#39;ve a quick point of clarification: Is it a mistake that <code>comp_process_t</code> takes a <code>handle_t</code>, but <code>comp_close_t</code> takes a <code>handle_t*</code>? Also are you willing to edit api.h a little, not changing the C API, but using some macros to make the SWIG interface simpler?"}, {"owner": {"reputation": 53, "user_id": 1169691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dbc76e74690308e46afef6cf86d9dd0?s=128&d=identicon&r=PG", "display_name": "Jef de Busser", "link": "https://stackoverflow.com/users/1169691/jef-de-busser"}, "edited": false, "score": 0, "creation_date": 1542977601, "post_id": 53414931, "comment_id": 93766935, "body": "1) no that&#39;s not a mistake, in the process call I use the pointer, in the close call I set it to NULL 2) Yes, I would be willing to adapt the C API a bit to accommodate SWIG, but preferably not too much and if possible #if // #ifdef blocks"}, {"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1543222731, "post_id": 53414931, "comment_id": 93825198, "body": "Re: 1) - I&#39;m not a fan of that personally - it doesn&#39;t do anything to other copies of <code>handle_t</code> which might be hanging around elsewhere in a program and in the case of SWIG bindings it only serves to clear a pointer which is in memory that itself should released shortly too. That said it&#39;s easy enough to make the destruction of the Python object automatically call this function exactly once if that&#39;s the semantics you need."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 1169691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dbc76e74690308e46afef6cf86d9dd0?s=128&d=identicon&r=PG", "display_name": "Jef de Busser", "link": "https://stackoverflow.com/users/1169691/jef-de-busser"}, "edited": false, "score": 0, "creation_date": 1543401103, "post_id": 53460023, "comment_id": 93903404, "body": "Great post! Thanks a lot for this!!  I&#39;ve implemented the first part and will add the second part (which looks really interesting) to the backlog."}], "tags": [], "owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "is_accepted": true, "score": 3, "last_activity_date": 1543222565, "last_edit_date": 1543222565, "creation_date": 1543076063, "answer_id": 53460023, "question_id": 53414931, "link": "https://stackoverflow.com/questions/53414931/swig-how-to-make-a-typedef-function-pointer-in-a-struct-callable-from-python/53460023#53460023", "title": "SWIG how to make a typedef function pointer in a struct callable from Python", "body": "<p>The simplest solution is if we claim to SWIG that the <a href=\"https://stackoverflow.com/a/11029809/168175\">function pointers are simply member functions</a> then the wrapper it will generate works quite nicely.</p>\n\n<p>To demonstrate that in this instance we need to fix up a few errors in your sample code, so I ended up with api.h looking like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>// simplified api.h\n#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef uint32_t api_error_t;\n\ntypedef void *handle_t;\ntypedef void sample_t;\ntypedef api_error_t comp_close_t(handle_t h);\ntypedef api_error_t comp_process_t(handle_t h,\n                               sample_t *in_ptr,\n                               sample_t *out_ptr,\n                               size_t nr_samples);\ntypedef struct\n{\n    comp_close_t *close;\n    comp_process_t *process;\n} audio_comp_t;\n\n// prototype for init\napi_error_t comp_init(handle_t *new_h);\n</code></pre>\n\n<p>and api.c looking like this:</p>\n\n<pre><code>#include \"api.h\"\n#include &lt;stdio.h&gt;\n\n// simplified api.c\nstatic comp_close_t my_close;\nstatic comp_process_t my_process;\n\naudio_comp_t comp = {\n    my_close,\n    my_process\n};\n\napi_error_t comp_init(handle_t *handle) {\n    *handle = &amp;comp;\n    return 0;\n}\n\napi_error_t my_close(handle_t h) {\n    (void)h; // stuff\n    return 0;\n}\n\napi_error_t my_process(handle_t h,\n                   sample_t *in_ptr,\n                   sample_t *out_ptr,\n                   size_t nr_samples) {\n    audio_comp_t *c = (audio_comp_t*) h;\n    (void)c;(void)in_ptr;(void)out_ptr;// stuff \n    printf(\"doing something useful\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>With that in place we can write api.i as below:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>%module api\n\n%{\n#include \"api.h\"\n%}\n\n%include &lt;stdint.i&gt;\n\n%typemap(in,numinputs=0) handle_t *new_h (handle_t tmp) %{\n    $1 = &amp;tmp;\n%}\n\n%typemap(argout) handle_t *new_h %{\n    if (!result) {\n        $result = SWIG_NewPointerObj(tmp$argnum, $descriptor(audio_comp_t *), 0 /*| SWIG_POINTER_OWN */);\n    }\n    else {\n        // Do something to make the error a Python exception...\n    }\n%}\n\n// From my earlier answer: https://stackoverflow.com/a/11029809/168175\n%typemap(in,numinputs=0) handle_t self \"$1=NULL;\"\n%typemap(check) handle_t self {\n  $1 = arg1;\n}\n\ntypedef struct {\n  api_error_t close(handle_t self);\n  api_error_t process(handle_t self,\n                      sample_t *in_ptr,\n                      sample_t *out_ptr,\n                      size_t nr_samples);\n} audio_comp_t;\n\n%ignore audio_comp_t;\n%include \"api.h\"\n</code></pre>\n\n<p>Here we've done a few things besides hiding the original structure and claiming it's full of member functions instead of member pointers:</p>\n\n<ol>\n<li>Make SWIG <a href=\"https://stackoverflow.com/a/11029809/168175\">automatically pass the handle in as the 1st argument</a> instead of requiring Python users to be excessively verbose. (In python it becomes <code>h.close()</code> instead of <code>h.close(h)</code>)</li>\n<li>Use argout typemap to wrap the real <code>comp_init</code> function instead of just replacing it. That's purely a matter of preference I just added it to show how it could be used.</li>\n</ol>\n\n<p>This lets my run the following Python:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import api\n\nh=api.comp_init()\nprint(h)\nh.process(None, None, 0)\nh.close()\n</code></pre>\n\n<hr>\n\n<p>We can do something that'll work quite nicely for both Python and C if you're willing to make some cosmetic changes to your API's header to facilitate things.</p>\n\n<p>I introduced a macro into api.h, <code>MAKE_API_FUNC</code>, which wraps the typedef statements you had in it originally. When compiled with a C compiler it still produces the exact same results, however it lets us manipulate things better with SWIG.</p>\n\n<p>So api.h now looks like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>// simplified api.h\n#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef uint32_t api_error_t;\n\ntypedef void *handle_t;\ntypedef void sample_t;\n#ifndef MAKE_API_FUNC\n#define MAKE_API_FUNC(name, type, ...) typedef api_error_t comp_ ## name ## _t(__VA_ARGS__)\n#endif\n\nMAKE_API_FUNC(close, audio_comp_t, handle_t);\nMAKE_API_FUNC(process, audio_comp_t, handle_t, sample_t *, sample_t *, size_t);\n\ntypedef struct\n{\n    comp_close_t *close;\n    comp_process_t *process;\n} audio_comp_t;\n\n// prototype for init\napi_error_t comp_init(handle_t *new_h);\n</code></pre>\n\n<p>So in api.i we now replace that macro, with another one, which claims to SWIG that the function pointer typedef is in fact a struct, with a specially provided <code>__call__</code> function. By creating this extra function we can proxy all our Python arguments automatically into a call to the real function pointer.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>%module api\n\n%{\n#include \"api.h\"\n%}\n\n%include &lt;stdint.i&gt;\n\n// From: https://stackoverflow.com/a/2653351\n#define xstr(a) str(a)\n#define str(a) #a\n\n#define name_arg(num, type) arg_ ## num\n#define param_arg(num, type) type name_arg(num, type)\n\n#define FE_0(...)\n#define FE_1(action,a1) action(0,a1)\n#define FE_2(action,a1,a2) action(0,a1), action(1,a2)\n#define FE_3(action,a1,a2,a3) action(0,a1), action(1,a2), action(2,a3)\n#define FE_4(action,a1,a2,a3,a4) action(0,a1), action(1,a2), action(2,a3), action(3,a4)\n#define FE_5(action,a1,a2,a3,a4,a5) action(0,a1), action(1,a2), action(2,a3), action(3,a4), action(4,a5)\n\n#define GET_MACRO(_1,_2,_3,_4,_5,NAME,...) NAME\n%define FOR_EACH(action,...)\n  GET_MACRO(__VA_ARGS__, FE_5, FE_4, FE_3, FE_2, FE_1, FE_0)(action,__VA_ARGS__)\n%enddef\n\n%define MAKE_API_FUNC(name, api_type, ...)\n%nodefaultctor comp_ ## name ## _t;\n%nodefaultdtor comp_ ## name ## _t;\ntypedef struct {\n    %extend {\n        api_error_t __call__(FOR_EACH(param_arg, __VA_ARGS__)) {\n            return $self(FOR_EACH(name_arg, __VA_ARGS__));\n        }\n    }\n} comp_ ## name ## _t;\n// Workaround from: https://github.com/swig/swig/issues/609\n%rename(\"%s_fptr\", \"%$isvariable\", \"match$ismember\"=\"1\", \"match$type\"=xstr(comp_ ## name ## _t)) name;\n%extend api_type {\n    %pythoncode %{\n        name = lambda self, *args: self.name ## _fptr(self, *args)\n    %}\n}\n%enddef\n\n%ignore comp_init;\n%include \"api.h\"\n\n%extend  audio_comp_t {\n    audio_comp_t() {\n        handle_t new_h = NULL;\n        api_error_t err = comp_init(&amp;new_h);\n        if (err) {\n            // throw or set Python error directly\n        }\n        return new_h;\n    }\n\n    ~audio_comp_t() {\n        (void)$self;\n        // Do whatever we need to cleanup properly here, could actually call close\n    }\n}\n</code></pre>\n\n<p>This is using the same <a href=\"https://stackoverflow.com/a/11994395/168175\">preprocessor mechanisms</a> I used in <a href=\"https://stackoverflow.com/a/32668302/168175\">my answer on wrapping <code>std::function</code> objects</a>, but applied to the function pointers of this problem. In addition I used <a href=\"https://stackoverflow.com/a/39807099/168175\"><code>%extend</code> to make a constructor/destructor</a> from the perspective of Python, which makes the API nicer to use. I'd probably use <code>%rename</code> too if this were real code.</p>\n\n<p>With that said we can now use the following Python code:</p>\n\n<pre><code>import api\n\nh=api.audio_comp_t()\nprint(h)\nprint(h.process)\nh.process(None, None, 0)\n</code></pre>\n\n<p>See <a href=\"http://www.swig.org/Doc3.0/Customization.html#Customization_exception\" rel=\"nofollow noreferrer\">SWIG docs</a> for a discussion on how to map the error codes onto exceptions nicely for Python too.</p>\n\n<hr>\n\n<p>We can simplify this further, by removing the need to iterate over the arguments of the variadic macro, with one simple trick. If we change our api.h macro to take 3 arguments, the 3rd of which is all the function pointer's arguments like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>// simplified api.h\n#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef uint32_t api_error_t;\n\ntypedef void *handle_t;\ntypedef void sample_t;\n#ifndef MAKE_API_FUNC\n#define MAKE_API_FUNC(name, type, args) typedef api_error_t comp_ ## name ## _t args\n#endif\n\nMAKE_API_FUNC(close, audio_comp_t, (handle_t self));\nMAKE_API_FUNC(process, audio_comp_t, (handle_t self, sample_t *in_ptr, sample_t *out_ptr, size_t nr_samples));\n\ntypedef struct\n{\n    comp_close_t *close;\n    comp_process_t *process;\n} audio_comp_t;\n\n// prototype for init\napi_error_t comp_init(handle_t *new_h);\n</code></pre>\n\n<p>Then we can now change our SWIG interface to not provide a definition of the <code>__call__</code> function we added via <code>%extend</code>, and instead write a macro that directly makes the function pointer call we wanted:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>%module api\n\n%{\n#include \"api.h\"\n%}\n\n%include &lt;stdint.i&gt;\n\n// From: https://stackoverflow.com/a/2653351\n#define xstr(a) str(a)\n#define str(a) #a\n\n%define MAKE_API_FUNC(name, api_type, arg_types)\n%nodefaultctor comp_ ## name ## _t;\n%nodefaultdtor comp_ ## name ## _t;\n%{\n#define comp_ ## name ## _t___call__(fptr, ...) fptr(__VA_ARGS__)\n%}\ntypedef struct {\n    %extend {\n        api_error_t __call__ arg_types;\n    }\n} comp_ ## name ## _t;\n// Workaround from: https://github.com/swig/swig/issues/609\n%rename(\"%s_fptr\", \"%$isvariable\", \"match$ismember\"=\"1\", \"match$type\"=xstr(comp_ ## name ## _t)) name;\n%extend api_type {\n    %pythoncode %{\n        name = lambda self, *args: self.name ## _fptr(self, *args)\n    %}\n}\n%enddef\n\n%ignore comp_init;\n%include \"api.h\"\n\n%extend  audio_comp_t {\n    audio_comp_t() {\n        handle_t new_h = NULL;\n        api_error_t err = comp_init(&amp;new_h);\n        if (err) {\n            // throw or set Python error directly\n        }\n        return new_h;\n    }\n\n    ~audio_comp_t() {\n        (void)$self;\n        // Do whatever we need to cleanup properly here, could actually call close\n    }\n}\n</code></pre>\n\n<p>The tricky thing here was that the use of <code>typedef struct {...} name;</code> idiom made renaming or hiding the function pointers inside the struct harder. (That was only necessary however to keep the addition of the <code>handle_t</code> argument automatic however).</p>\n"}], "owner": {"reputation": 53, "user_id": 1169691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dbc76e74690308e46afef6cf86d9dd0?s=128&d=identicon&r=PG", "display_name": "Jef de Busser", "link": "https://stackoverflow.com/users/1169691/jef-de-busser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 850, "favorite_count": 0, "accepted_answer_id": 53460023, "answer_count": 1, "score": 3, "last_activity_date": 1543222565, "creation_date": 1542812753, "last_edit_date": 1542817590, "question_id": 53414931, "link": "https://stackoverflow.com/questions/53414931/swig-how-to-make-a-typedef-function-pointer-in-a-struct-callable-from-python", "title": "SWIG how to make a typedef function pointer in a struct callable from Python", "body": "<p><strong>TL;DR</strong>\nDoes anybody know how to instruct SWIG to treat these members of a C-struct as a function pointer and make it callable from Python? </p>\n\n<p><strong>The full story</strong> \nI have C structs which contain pointers to functions. The functions are all typedefed. I have a C function which will allocate memory for this C struct and which will set the function pointers to point to valid C functions.\nMy simplified header file looks like this</p>\n\n<pre><code>// simplified api.h\ntypedef void *handle_t;\ntypedef void sample_t;\ntypedef error_t comp_close_t(handle_t *h);\ntypedef error_t comp_process_t(handle_t h,\n                               sample_t *in_ptr,\n                               sample_t *out_ptr,\n                               size_t *nr_samples);\ntypedef struct\n{\n    comp_close_t *close;\n    comp_process_t *process;\n} audio_comp_t;\n\n// prototype for init\nerror_t comp_init(handle_t *h, int size);\n</code></pre>\n\n<p>And corresponding simplified source file:</p>\n\n<pre><code>// simplified api.c\nstatic comp_close_t my_close;\nstatic comp_process_t my_process;\n\naudio_comp_t comp = {\n    my_close,\n    my_process\n};\n\nerror_t comp_init(audio_comp_t **handle) {\n    *handle = &amp;comp;\n    return 0;\n}\n\nerror_t my_close(handle_t *h) {\n    // stuff\n    *h = NULL;\n    return 0;\n}\n\nerror_t my_process(handle_t h,\n                   sample_t *in_ptr,\n                   sample_t *out_ptr,\n                   size_t *nr_samples) {\n    audio_comp_t *c = (audio_comp_t*) h;\n    // stuff \n    printf(\"doing something useful\\n\");\n}\n</code></pre>\n\n<p>And the latest version of my interface file: </p>\n\n<pre><code>%module comp_wrapper\n%{\n#include \"api.h\"\n%}\n\n%include \"api.h\"\n\n// Take care of the double pointer in comp_init\n%ignore comp_init;\n%rename(comp_init) comp_init_overload;\n%newobject comp_init;\n\n%inline %{\naudio_comp_t* comp_init_overload(int size) {\n    audio_comp_t *result = NULL;\n    error_t err = comp_init(&amp;result, size);\n\n    if (SSS_NO_ERROR == err) {\n        ...\n    }\n\n    return result;\n}\n%}\n\n// wrap the process call to verify the process_t * function pointer    \n%inline %{\nsss_error_t call_process(   audio_comp_t *h, \n                            sample_t *in, \n                            sample_t *out, \n                            size_t nr_samples)\n{\n    return h-&gt;process(h, in, out, &amp;nr_samples);\n}\n%}\n</code></pre>\n\n<p>I want to use SWIG to create language bindings so that I can call these object-alike structures with minimal boiler plate code from Python. Ultimately I want to use this like:</p>\n\n<pre><code>h = comp_init(50)\nh.process(h, input_data, output_data, block_size)\nh.close(h)\n</code></pre>\n\n<p>However, SWIG treats these function pointers in these structs as Objects, so whenever I want to call them I get</p>\n\n<pre><code>&gt;&gt;&gt; h = comp_init(50)\n&gt;&gt;&gt; h.api.process()\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nTypeError: 'SwigPyObject' object is not callable\n</code></pre>\n\n<p>I can workaround it by means of something like the 'call_process' function which you can find in the interface file: </p>\n\n<pre><code>call_process(h, in, out, 32) \n</code></pre>\n\n<p>but it would require me to add an extra wrapper for all struct member functions, while this shouldn't be necessary since [the SWIG documentation states that function pointers are fully supported][1] </p>\n\n<p>I assume I should write some code in the interface file so that SWIG knows that it's dealing with a function rather than a SwigPyObject</p>\n\n<p>There is some information on how to deal with (python)callbacks, but none of it seems to work in this case specifically:\n<a href=\"https://stackoverflow.com/questions/32791661/swig-call-function-pointers-stored-within-struct\">SWIG call function pointers stored within struct</a></p>\n\n<p>or without duplicating more or less all of the information from the header file into the interface file:\n<a href=\"https://stackoverflow.com/questions/1583293/using-swig-with-pointer-to-function-in-c-struct\">Using SWIG with pointer to function in C struct</a> </p>\n\n<p>and last but not least there seems to be a difference when you wrap a function pointer in a struct so solution 5 does not work: \n<a href=\"https://stackoverflow.com/questions/22923696/how-to-wrap-a-c-function-which-takes-in-a-function-pointer-in-python-using-swi\">How to wrap a c++ function which takes in a function pointer in python using SWIG</a></p>\n\n<p><strong>Does anybody know how to instruct SWIG to treat these members of a C-struct as a function pointer and make it callable from Python?</strong> </p>\n"}, {"tags": ["c", "math", "compiler-optimization", "modulus"], "comments": [{"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1542812787, "post_id": 53414711, "comment_id": 93704301, "body": "<a href=\"https://stackoverflow.com/questions/41183935/why-does-gcc-use-multiplication-by-a-strange-number-in-implementing-integer-divi?noredirect=1&amp;lq=1\">For division</a>."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1542812929, "post_id": 53414711, "comment_id": 93704401, "body": "Re implication: If you want to find larger primes, usually you just switch to a better primality check algorithm (<a href=\"https://stackoverflow.com/questions/4493645/fastest-primality-test\" title=\"fastest primality test\">stackoverflow.com/questions/4493645/fastest-primality-test</a>)&zwnj;&#8203;, which doesn&#39;t have much to do with the main question."}], "answers": [{"comments": [{"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 0, "creation_date": 1542814236, "post_id": 53415201, "comment_id": 93705189, "body": "Your math looks sound and seems to follow with the other documentation of this concept.  I think I just need to grind out a few examples in binary notation to follow it (or get some sleep so I can do the hex-&gt;binary in my head).  I was also hoping to figure out the math to get the comparison constants (which may be obvious once I can visualize it)"}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "reply_to_user": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 0, "creation_date": 1542815226, "post_id": 53415201, "comment_id": 93705803, "body": "Well, constants are quite straightforward, 0xAB is simply 1/3 and 0x55 is the highest floor of n/3 for a 8-bit n. Implications follow. :)"}], "tags": [], "owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "is_accepted": false, "score": 3, "last_activity_date": 1583565800, "last_edit_date": 1583565800, "creation_date": 1542813548, "answer_id": 53415201, "question_id": 53414711, "link": "https://stackoverflow.com/questions/53414711/math-behind-gcc9-modulus-optimizations/53415201#53415201", "title": "Math behind gcc9+ modulus optimizations", "body": "<p>Take 3, for instance.</p>\n\n<p>0xAB * 3 = 0x201, thus, modulo 0x100, 0xAB is 1 / 3, and, inversely, 0xAB * 3 \u2261 1.</p>\n\n<p>Any 8-bit unsigned integer n can be represented as n = 3*k + r, r &lt; 3, and k is at most 0x55 (decimal 85, integral part of 255 / 3).</p>\n\n<p>So we have options:</p>\n\n<ol>\n<li><p>r = 0 \u21d2 n * 0xAB = 3k * 0xAB = k * (3 * 0xAB) \u2261 k * 1 = k \u2264 0x55.</p></li>\n<li><p>r = 1 \u21d2 n * 0xAB = 3k * 0xAB + 0xAB; since 3k * 0xAB is at most 0x55 (mod 0x100), adding it to 0xAB won't overflow, so 3k * 0xAB + 0xAB \u2265 0xAB > 0x55.</p></li>\n<li><p>r = 2 \u21d2 n * 0xAB = 3k * 0xAB + 0x156 \u2261 3k * 0xAB + 0x56 \u2265 0x56 > 0x55 (same as 2.)</p></li>\n</ol>\n"}], "owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 2, "answer_count": 1, "score": 6, "last_activity_date": 1583565800, "creation_date": 1542811999, "question_id": 53414711, "link": "https://stackoverflow.com/questions/53414711/math-behind-gcc9-modulus-optimizations", "title": "Math behind gcc9+ modulus optimizations", "body": "<p><strong>Background</strong></p>\n\n<p>I was playing with prime numbers in c, when I stumbled upon a new optimization in gcc trunk (will be version 9.x) that optimizes a modulus comparison to 0 into an integer multiply and comparison using magic numbers.  In other words <code>x%prime==0</code> becomes <code>x*Magic_mul&lt;=Magic_cmp</code></p>\n\n<pre><code>_Bool mod(unsigned x){return x % Constant == 0;}\n\nmod:\n  imul edi, edi, Magic_mul\n  cmp edi, Magic_cmp\n  setbe al\n</code></pre>\n\n<p><strong>Details</strong></p>\n\n<p>Based on seeing the asm output, it does these optimizations for all integers (well, primes at least)  I converted them to hex to help see the patterns, but its not immediately obvious at the moment.</p>\n\n<pre><code>//32bit examples for _Bool mod_n(unsigned x){return x%n==0;};\n//note: parameter is unsigned but it becomes a signed multiply\nx%3==0;  // x*0xAAAAAAAB &lt;= 0x55555555\nx%5==0;  // x*0xCCCCCCCD &lt;= 0x33333333\nx%7==0;  // x*0xB6DB6DB7 &lt;= 0x24924924\nx%11==0; // x*0xBA2E8BA3 &lt;= 0x1745D174\nx%13==0; // x*0xC4EC4EC5 &lt;= 0x13B13B13\nx%17==0; // x*0xF0F0F0F1 &lt;= 0x0F0F0F0F\nx%19==0; // x*0x286BCA1B &lt;= 0x0D79435E\nx%23==0; // x*0xE9BD37A7 &lt;= 0x0B21642C\nx%29==0; // x*0x4F72C235 &lt;= 0x08D3DCB0\nx%31==0; // x*0xBDEF7BDF &lt;= 0x08421084\nx%37==0; // x*0x914C1BAD &lt;= 0x06EB3E45\nx%41==0; // x*0xC18F9C19 &lt;= 0x063E7063\nx%43==0; // x*0x2FA0BE83 &lt;= 0x05F417D0\nx%47==0; // x*0x677D46CF &lt;= 0x0572620A\nx%53==0; // x*0x8C13521D &lt;= 0x04D4873E\nx%59==0; // x*0xA08AD8F3 &lt;= 0x0456C797\nx%61==0; // x*0xC10C9715 &lt;= 0x04325C53\nx%67==0; // x*0x07A44C6B &lt;= 0x03D22635\nx%71==0; // x*0xE327A977 &lt;= 0x039B0AD1\nx%73==0; // x*0xC7E3F1F9 &lt;= 0x0381C0E0\nx%79==0; // x*0x613716AF &lt;= 0x033D91D2\nx%83==0; // x*0x2B2E43DB &lt;= 0x03159721\nx%89==0; // x*0xFA3F47E9 &lt;= 0x02E05C0B\nx%97==0; // x*0x5F02A3A1 &lt;= 0x02A3A0FD\n///...and even up to 64bit\nx%4294967291==0; //x*0x70A3D70A33333333 &lt;= 0x100000005\n</code></pre>\n\n<p>I checked <a href=\"http://www.hackersdelight.org/divcMore.pdf\" rel=\"noreferrer\">hacker's delight \"INTEGER DIVISION BY CONSTANTS\"</a> and it seems like this may be a special case of <em>remainder by multiplication and right shift</em>, but I'm not sure.  There is a <a href=\"http://www.hackersdelight.org/magic.htm\" rel=\"noreferrer\">form on hacker's delight</a> that calculates these same multiplier constants, so that seems promising.  I'm guessing the magic comparison constant replaces the shift and compare to zero, but I am having trouble visualizing the 2s complement and whether the shift is arithmetic or logical.</p>\n\n<p><strong>Question</strong></p>\n\n<p>Is there some math behind this or were the numbers determined some other way using the binary representation?</p>\n\n<p><strong>Implications</strong></p>\n\n<p>Since this is simple integer multiply and comparison this could drastically speed up (or reduce memory footprint of) checking for prime using vector extensions/intrinsics.  If the math could be extended beyond 64 bits, it could possibly make finding large Big-Number primes much faster?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 2, "creation_date": 1542812070, "post_id": 53414703, "comment_id": 93703848, "body": "I would avoid using <code>goto</code> as it makes code more difficult to follow. Don&#39;t get into the habit of using it."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 2, "creation_date": 1542812176, "post_id": 53414703, "comment_id": 93703921, "body": "<code>goto</code> is the black sheep of programming. Do <i>not</i> use it!"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1542812209, "post_id": 53414703, "comment_id": 93703944, "body": "@gsamaras in C goto is sometimes the most  appropriate solution."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1542812236, "post_id": 53414703, "comment_id": 93703962, "body": "@FiddlingBits do not promote cargo-cult. In C, <code>goto</code> is valid and useful."}, {"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1542812260, "post_id": 53414703, "comment_id": 93703974, "body": "@SergeyA If <code>goto</code> is the most appropriate solution I&#39;d say you need to refactor/re-architect/modularize your code."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 4, "creation_date": 1542812266, "post_id": 53414703, "comment_id": 93703980, "body": "<code>gametable[SIZE] = &#39;\\0&#39;;</code> Here is some <b>undefined behavior</b>. Valid array indices run from <code>0</code> to <code>SIZE-1</code>"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1542812278, "post_id": 53414703, "comment_id": 93703985, "body": "@FiddlingBits you&#39;d be wrong in saying so ;)"}, {"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1542812312, "post_id": 53414703, "comment_id": 93704008, "body": "@SergeyA I think it&#39;s a matter of opinion rather than right or wrong."}, {"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1542812384, "post_id": 53414703, "comment_id": 93704055, "body": "@SergeyA I guess it also depends on if it&#39;s responsibly used."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1542812449, "post_id": 53414703, "comment_id": 93704091, "body": "If you can&#39;t see a better solution than <code>goto</code>... keep looking."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1542812490, "post_id": 53414703, "comment_id": 93704121, "body": "A switch statement is just an enumerated <code>goto</code> construct.  And, how many times have you seen <code>goto</code> statements buried in error handling macros? (which is kind of what OP has done here without the macro.)  Just saying, there is still a place for carefully used <code>goto</code> statements."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1542812936, "post_id": 53414703, "comment_id": 93704406, "body": "How can assigning a value to <code>snakelen</code> break the code? It doesn&#39;t seem to be used. It is passed to <code>spawnfood()</code> but there it is ignored. What am I missing?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1542812999, "post_id": 53414703, "comment_id": 93704451, "body": "@FiddlingBits well, here is an exercise for you - you have a function which needs to use 3 resources, each of which has a step to aquire (initialize) and a step to cleanup. An init can be successful or a failure. Each successfully inited resource <b>must</b> be cleaned up, while a resources which failed to initialize must <b>never</b> be cleaned up. A function needs to aquire 3 resources in sequence, and perform action iff all of them were aquired successfully. Than whatever was aquired, needs to be cleaned up. How would you design such a function?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1542813060, "post_id": 53414703, "comment_id": 93704485, "body": "@TimRandall see my question above."}, {"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1542813204, "post_id": 53414703, "comment_id": 93704594, "body": "@SergeyA You make a good point. Like @ryyker mentioned above, I have used a C <code>TRY</code>/<code>FINALLY</code> macro construct with an embedded <code>goto</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1542813542, "post_id": 53414703, "comment_id": 93704800, "body": "Hey guys, breaking news: goto considered harmful! Lets debate this in the comment field! Never been done before."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1542814164, "post_id": 53414703, "comment_id": 93705148, "body": "@SergeyA when (s)he grows, (s)he will know. At this stage, it&#39;s a solid spartan no.-"}, {"owner": {"reputation": 23, "user_id": 10686377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6bfc7b7e4626481dd54385022dfc74?s=128&d=identicon&r=PG&f=1", "display_name": "FireFuro99", "link": "https://stackoverflow.com/users/10686377/firefuro99"}, "edited": false, "score": 0, "creation_date": 1542814398, "post_id": 53414703, "comment_id": 93705292, "body": "What else should i use then, instead of goto???"}, {"owner": {"reputation": 23, "user_id": 10686377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6bfc7b7e4626481dd54385022dfc74?s=128&d=identicon&r=PG&f=1", "display_name": "FireFuro99", "link": "https://stackoverflow.com/users/10686377/firefuro99"}, "edited": false, "score": 0, "creation_date": 1542814411, "post_id": 53414703, "comment_id": 93705303, "body": "Can&#39;t use break; inside a switch function."}, {"owner": {"reputation": 23, "user_id": 10686377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6bfc7b7e4626481dd54385022dfc74?s=128&d=identicon&r=PG&f=1", "display_name": "FireFuro99", "link": "https://stackoverflow.com/users/10686377/firefuro99"}, "reply_to_user": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1542814555, "post_id": 53414703, "comment_id": 93705402, "body": "@TimRandall I plan on using snakelen later on. If it changed value mid-game by itself I can not use it. So i thought better find a fix first before using it."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1542816217, "post_id": 53414703, "comment_id": 93706454, "body": "Later on, you could consider moving the <code>while</code> loop into a separate function (called <code>Game()</code> perhaps). Then you can use <code>return</code> instead of <code>goto</code>."}, {"owner": {"reputation": 23, "user_id": 10686377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6bfc7b7e4626481dd54385022dfc74?s=128&d=identicon&r=PG&f=1", "display_name": "FireFuro99", "link": "https://stackoverflow.com/users/10686377/firefuro99"}, "edited": false, "score": 0, "creation_date": 1542821115, "post_id": 53414703, "comment_id": 93709320, "body": "Great idea, thank you! Will definetly do that in later projects."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10686377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6bfc7b7e4626481dd54385022dfc74?s=128&d=identicon&r=PG&f=1", "display_name": "FireFuro99", "link": "https://stackoverflow.com/users/10686377/firefuro99"}, "edited": false, "score": 0, "creation_date": 1542813432, "post_id": 53414803, "comment_id": 93704731, "body": "Oh :/ In university we were told an array ends in a null-pointer.And as far as i know \\0 is a null-pointer. I just use it to make sure the array ends properly. If i remove that line the code doesn&#39;t work."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "reply_to_user": {"reputation": 23, "user_id": 10686377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6bfc7b7e4626481dd54385022dfc74?s=128&d=identicon&r=PG&f=1", "display_name": "FireFuro99", "link": "https://stackoverflow.com/users/10686377/firefuro99"}, "edited": false, "score": 0, "creation_date": 1542813608, "post_id": 53414803, "comment_id": 93704846, "body": "@FireFuro99 to be fair, though, if you leave the line in, the code doesn&#39;t work."}, {"owner": {"reputation": 23, "user_id": 10686377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6bfc7b7e4626481dd54385022dfc74?s=128&d=identicon&r=PG&f=1", "display_name": "FireFuro99", "link": "https://stackoverflow.com/users/10686377/firefuro99"}, "edited": false, "score": 0, "creation_date": 1542813609, "post_id": 53414803, "comment_id": 93704848, "body": "I changed it to &quot; = NULL&quot;. Doesn&#39;t change anything tho. snakelen is still 0 at the end. Help."}, {"owner": {"reputation": 23, "user_id": 10686377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6bfc7b7e4626481dd54385022dfc74?s=128&d=identicon&r=PG&f=1", "display_name": "FireFuro99", "link": "https://stackoverflow.com/users/10686377/firefuro99"}, "reply_to_user": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1542813673, "post_id": 53414803, "comment_id": 93704882, "body": "@Tim Randall  Ok - the code &quot;works&quot; when i remove that line. It just doesn&#39;t work like i expect it to. Well then that might be the problem."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1542813884, "post_id": 53414803, "comment_id": 93705003, "body": "You cannot safely store <b>any</b> value at that array index. It is illegal to do so. It causes <b>undefined behavior</b> which means that the program can do anything including nothing at all, crash, corrupt the value of another variable, or halt and catch fire."}, {"owner": {"reputation": 23, "user_id": 10686377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6bfc7b7e4626481dd54385022dfc74?s=128&d=identicon&r=PG&f=1", "display_name": "FireFuro99", "link": "https://stackoverflow.com/users/10686377/firefuro99"}, "reply_to_user": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1542814041, "post_id": 53414803, "comment_id": 93705083, "body": "@Tim Randall  I never stored any value there, i know that you cant store values there. I ended the array by placing the null-pointer (not a value), cause in university we learned (if im remember correctly) that an array ends in a null pointer."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1542814330, "post_id": 53414803, "comment_id": 93705249, "body": "Any expression of the form <code>array[index]=value;</code> <b>does</b> store a value in the array. This is nothing to do with null pointers. A null pointer is just a pointer whose value is zero, meaning it doesn&#39;t point to an object. I think you are mis-remembering something else, which is that strings\u2014arrays of <code>char</code>\u2014usually end with a <code>NUL</code> terminator. This is a single character\u2014not a pointer\u2014that has a value of zero, which is sometimes written as <code>&#39;\\0&#39;</code>. But it doesn&#39;t matter whether you write it as <code>0</code> or <code>&#39;\\0&#39;</code> or <code>0x0</code> or <code>NULL</code>, you&#39;re storing a value of zero at an array index that is invalid."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1542814408, "post_id": 53414803, "comment_id": 93705296, "body": "<i>&quot;In university we were told an array ends in a null-pointer.&quot;</i> : either you misunderstood something, or it may be time forr your teacher to retire. I suppose rather you&#39;ve misunderstood something and you&#39;re mixing up NUL (nor NULL) terminated strings and and arrays."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1542814492, "post_id": 53414803, "comment_id": 93705361, "body": "Actually, I take it back. An expression of the form <code>array[index]=value;</code> only stores a value in the array <b>if the index is valid</b>."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 2, "creation_date": 1542814902, "post_id": 53414803, "comment_id": 93705615, "body": "You were probably not told that an array ends in a null pointer.  A <i>string</i> is an array of character with a terminal null value.  The <code>array[4] = {&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;\\0}</code> initializes an array of size 4 which is a string of length 3.  <code>array[3]</code> is the nul character.  Attempting to reference <code>array[4]</code> is an error."}], "tags": [], "owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "is_accepted": true, "score": 4, "last_activity_date": 1542812463, "last_edit_date": 1542812463, "creation_date": 1542812309, "answer_id": 53414803, "question_id": 53414703, "link": "https://stackoverflow.com/questions/53414703/snake-in-c-integer-gets-changed-without-being-changed-whats-the-problem/53414803#53414803", "title": "Snake in C - Integer gets changed without being changed - what&#39;s the problem?", "body": "<pre><code> char gametable[SIZE]; //the game-screen //fill it with spaces\n ...\n gametable[SIZE] = '\\0';\n</code></pre>\n\n<p>This is wrong.   You can index an array of size N with indices 0 through N-1.  <code>gametable[SIZE]</code> is outside the array, and assigning to it invokes undefined behavior. </p>\n"}, {"comments": [{"owner": {"reputation": 428, "user_id": 6598327, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IAKEPWBcktM/AAAAAAAAAAI/AAAAAAAAAVs/Z-0Ylpo9L_Y/photo.jpg?sz=128", "display_name": "Purple Ice", "link": "https://stackoverflow.com/users/6598327/purple-ice"}, "edited": false, "score": 1, "creation_date": 1542815456, "post_id": 53415129, "comment_id": 93705954, "body": "It would be better to replace this with a macro which expands to nothing on release builds and checks only on debug builds. It&#39;s better to just get used to <code>array[SIZE+1]</code> for this anyway, it&#39;s almost expected that the <code>+1</code> will indicate that the array is both a string that will be used for text and that it will be explicitly nul terminated."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "reply_to_user": {"reputation": 428, "user_id": 6598327, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IAKEPWBcktM/AAAAAAAAAAI/AAAAAAAAAVs/Z-0Ylpo9L_Y/photo.jpg?sz=128", "display_name": "Purple Ice", "link": "https://stackoverflow.com/users/6598327/purple-ice"}, "edited": false, "score": 1, "creation_date": 1542815614, "post_id": 53415129, "comment_id": 93706064, "body": "@PurpleIce yes, you&#39;re right about the macro. I was assuming that these checks would be used as temporary development aids only, and would be removed once the bugs were out of the code."}, {"owner": {"reputation": 23, "user_id": 10686377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6bfc7b7e4626481dd54385022dfc74?s=128&d=identicon&r=PG&f=1", "display_name": "FireFuro99", "link": "https://stackoverflow.com/users/10686377/firefuro99"}, "edited": false, "score": 0, "creation_date": 1542817359, "post_id": 53415129, "comment_id": 93707151, "body": "Didn&#39;t get the macro part, but that array[SIZE+1] is a great idea! now i can set array[SIZE] to \\0 ! THANKS! :D"}], "tags": [], "owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "is_accepted": false, "score": 0, "last_activity_date": 1542813992, "last_edit_date": 1542813992, "creation_date": 1542813368, "answer_id": 53415129, "question_id": 53414703, "link": "https://stackoverflow.com/questions/53414703/snake-in-c-integer-gets-changed-without-being-changed-whats-the-problem/53415129#53415129", "title": "Snake in C - Integer gets changed without being changed - what&#39;s the problem?", "body": "<p>Caveat: This isn't a \"give a man a fish\" answer. It's a \"teach a man to fish' answer.</p>\n\n<p>On every one of your statements that reads or writes to an array, you should check the array index for validity.</p>\n\n<p>For example, instead of</p>\n\n<pre><code>gametable[snakeheadypos*YSIZE + 2*snakeheadxpos] = 'x';\n\ngametable[tmp2] =' ';\n</code></pre>\n\n<p>...write...</p>\n\n<pre><code>int index;\n\nindex=snakeheadypos*YSIZE + 2*snakeheadxpos;\nif(index&lt;0 || index &gt;=SIZE){printf(\"Index error A: value is %d\", index);exit(1);}\ngametable[index] = 'x';\n\nindex=tmp2;\nif(index&lt;0 || index &gt;=SIZE){printf(\"Index error B: value is %d\", index);exit(1);}\ngametable[index] =' ';\n</code></pre>\n\n<p>This sort of technique can help you detect array index problems, which can be a very common source of bugs, and can produce all sort of weird symptoms.</p>\n"}], "owner": {"reputation": 23, "user_id": 10686377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6bfc7b7e4626481dd54385022dfc74?s=128&d=identicon&r=PG&f=1", "display_name": "FireFuro99", "link": "https://stackoverflow.com/users/10686377/firefuro99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 53414803, "answer_count": 2, "score": -3, "last_activity_date": 1542813992, "creation_date": 1542811975, "last_edit_date": 1542812024, "question_id": 53414703, "link": "https://stackoverflow.com/questions/53414703/snake-in-c-integer-gets-changed-without-being-changed-whats-the-problem", "title": "Snake in C - Integer gets changed without being changed - what&#39;s the problem?", "body": "<p>(program language is c - when correcting please only use stuff noobs can do, I am just learning this since 1 week)</p>\n\n<p>The problem is: See the \"int snakelen = 1;\" at the start of main?</p>\n\n<p>I never change that integer. But when I end the game it is 0. Why? </p>\n\n<p>And if i TRY TO CHANGE snakelen mid-game, the game completely breaks and i get windows-error sounds.\nWhat's the matter?</p>\n\n<p>(And the food doesnt spawn randomly although i use a randomizer. And it either spawns bottom-only or top-only - changing about every 5 minutes. another wierd glitch.)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;math.h&gt;\n\n#define SIZE 2048 //32(*2 because every 2nd one is a space) * 32\n#define HSIZE 1024 //32 * 32\n#define UP_ 1\n#define DOWN_ 3\n#define LEFT_ 4\n#define RIGHT_ 2\n#define YSIZE 64 //length of a row (including spaces)\n\n//TO PLAY: Start the game once, right-click the command-promt at the top, click Settings -&gt; Layout . Then change the window size to 64 (hor) * 33 (vert)\n\nint counter = 0;\nint gamespeed = 400;//Intervall in which a game-frame gets rendered\n\nint spawnfood(int* freetable, int snakelen)\n{\n    srand ( time(NULL) ); //randomize\n    int randomIndex = rand()%(HSIZE - 1); //take random non-x-filled position from array\n    int randomValue = freetable[randomIndex]; //output the random position\n    return randomValue;\n}\n\nint main()\n{\n    int nofood = 1; //is there food in the game? 1 = no\n    //int tmp = 0; //temporary memory for later\n    int tmp2 = 0; //temporary memory2\n    int snakelen = 1; //length of snake\n    int snakedir = RIGHT_; //Position the snake is looking\n    int snakeheadxpos = 0; //x-position of snake\n    int snakeheadypos = 0; //y-position of snake\n    char q;//The button that was pressed last\n\n\n    char gametable[SIZE]; //the game-screen //fill it with spaces\n    for(int i = 0; i &lt; SIZE; i++)\n    {\n        gametable[i]=' ';\n    }\n    gametable[SIZE] = '\\0';\n\n\n    int freetable[(HSIZE)]; // 32*32 list of all pixels, which shows whether a pixel is an x or not\n    for(int i = 0; i &lt; (HSIZE); i++)\n    {\n        freetable[i]= i*2; //fill the array with its numbers\n    }\n\n\n    //START OF GAME\n    printf(\"Press any Button to start the game!\\n\");\n    getch();\n    for(int i = 0; i &lt; 31; i++){\n        printf(\"\\n\");\n    }\n\n    while(q != 27)\n    {\n        counter++;\n        if(kbhit()) //if button is pressed\n        {\n            q = getch(); //q = that button\n            switch(q) //change the way the snake looks via WASD\n            {\n            case 'w':\n                if(snakedir != DOWN_)\n                    snakedir = UP_;\n                break;\n            case 'a':\n                if(snakedir != RIGHT_)\n                    snakedir = LEFT_;\n                break;\n            case 's':\n                if(snakedir != UP_)\n                    snakedir = DOWN_;\n                break;\n            case 'd':\n                if(snakedir != LEFT_)\n                    snakedir = RIGHT_;\n                break;\n            default:\n                break;\n            }\n\n        }\n        if(counter%gamespeed == 0) //Renders a game-frame at the intervall of gamespeed\n        {\n            switch(snakedir)\n            {\n\n            case UP_:\n                if(snakeheadypos==0)\n                {\n                    goto exit_loop; //ran into a wall\n                }\n                snakeheadypos--;\n                break;\n\n            case DOWN_:\n                if(snakeheadypos==31)\n                {\n                    goto exit_loop; //ran into a wall\n                }\n                snakeheadypos++;\n                break;\n\n            case RIGHT_:\n                if(snakeheadxpos==31)\n                {\n                    goto exit_loop; //ran into a wall\n                }\n                snakeheadxpos++;\n                break;\n\n            case LEFT_:\n                if(snakeheadxpos==0)\n                {\n                    goto exit_loop; //ran into a wall\n                }\n                snakeheadxpos--;\n                break;\n            default:\n                break;\n            }\n\n            if((gametable[snakeheadypos*YSIZE + 2*snakeheadxpos] == 'o'))\n            {\n                //snakelen++; //&lt;-- WHEN YOU REMOVE THE FIRST //, THE GAME STARTS TO BUG AND I GET WINDOWS ERROR SOUNDS!\n                nofood = 1; //no more food is in the game\n            }\n            gametable[snakeheadypos*YSIZE + 2*snakeheadxpos] = 'x'; //set the pixel ur at the the moment to 'x'\n\n            gametable[tmp2] =' ';\n            tmp2 = snakeheadypos*64+snakeheadxpos*2;\n            //spawn food if there is none\n            if(nofood)\n            {\n                gametable[spawnfood(freetable, snakelen)] = 'o';\n                nofood = 0; //food is already placed\n            }\n            printf(\"%s\", gametable); // print the gametable\n        }\n    }\nexit_loop: ; //if you ran into a wall\n    printf(\"Game Over - Score: %d\", snakelen);\n}\n</code></pre>\n"}, {"tags": ["c", "linux"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10375577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f68408c21f780e93a40caff69c1b33?s=128&d=identicon&r=PG&f=1", "display_name": "SQLLearner", "link": "https://stackoverflow.com/users/10375577/sqllearner"}, "edited": false, "score": 0, "creation_date": 1542811890, "post_id": 53414340, "comment_id": 93703726, "body": "Thank you this helped! Maybe could you also shortly explain why my approach with the global variables did not work? Thank you!"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "reply_to_user": {"reputation": 23, "user_id": 10375577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f68408c21f780e93a40caff69c1b33?s=128&d=identicon&r=PG&f=1", "display_name": "SQLLearner", "link": "https://stackoverflow.com/users/10375577/sqllearner"}, "edited": false, "score": 0, "creation_date": 1542812009, "post_id": 53414340, "comment_id": 93703807, "body": "There are no global variables between processes. Each process is separate - there is nothing connecting between them, except for <code>waitpid</code> and <code>fork</code> return value. Each process has a separate <code>out</code> variable. There two processes, they do not &quot;interconnect&quot; in any way. You can create a &quot;shared memory&quot; (pool) in which you will place your variable (the name &quot;shared&quot; means it is the memory that shared between processes) or use threads (pthreads) that create threads - one process, multiple executions."}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 1, "last_activity_date": 1542810695, "creation_date": 1542810695, "answer_id": 53414340, "question_id": 53414146, "link": "https://stackoverflow.com/questions/53414146/share-number-of-child-process-to-parent-process-exit-wait-or-global-varia/53414340#53414340", "title": "Share number of child process to parent process. Exit() &amp; Wait() or global variable", "body": "<p>From <a href=\"https://linux.die.net/man/2/waitpid\" rel=\"nofollow noreferrer\">man wait</a>:</p>\n\n<blockquote>\n  <p>pid_t wait(int *status);</p>\n  \n  <p>If status is not NULL, wait() and waitpid() store status information in the int to which it points.</p>\n  \n  <p>WEXITSTATUS(status)\n  returns the exit status of the child. This consists of the least significant 8 bits of the status argument that the child specified in a call to exit(3) or _exit(2) ....</p>\n</blockquote>\n\n<p>So use:</p>\n\n<pre><code>}\n// warte fur unserer kind\nint exitstatus;\nwait(&amp;exitstatus);\n// caste exitcode to string casten\nchar str[24];\nsprintf(str, \"Exit-Code: %d\\n\", WEXITSTATUS(exitstatus));\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10375577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f68408c21f780e93a40caff69c1b33?s=128&d=identicon&r=PG&f=1", "display_name": "SQLLearner", "link": "https://stackoverflow.com/users/10375577/sqllearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 53414340, "answer_count": 1, "score": 0, "last_activity_date": 1542810695, "creation_date": 1542810102, "question_id": 53414146, "link": "https://stackoverflow.com/questions/53414146/share-number-of-child-process-to-parent-process-exit-wait-or-global-varia", "title": "Share number of child process to parent process. Exit() &amp; Wait() or global variable", "body": "<p>I have the task that the parent process needs to output exit code of the child process. This exit code is supposed to be the sum of the child process id, with an added variable k and modulo 100 of the whole. I have tried two approaches to save the exit-code from the child process:</p>\n\n<ul>\n<li>exit(exit-code) in child process and saving in parent process with wait(). You should still this in the comments</li>\n<li>saving exit-code in global variable and outputting exit-code after wait() in parent process</li>\n</ul>\n\n<p>However, both did not work. Could you help me how I could achieve it? Thank you!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n\n//globale Variable\nint out;\n\nint main()\n{\n//Nutzereingabe von k:\nint k=0;\nscanf(\"%d\",&amp;k);\n    //Erzeugen eines Kindprozesses:\n    if(fork()==0)\n    {\n        //Kindprozess liegt vor\n    int zaehler=1;\n    char ausgabe[256]={0};\n    while(zaehler&lt;=k){\n        //printf(\"%d\\t\"\n        int pid=getpid();\n        int ppid=getppid();\n        sprintf(ausgabe, \"%d %c %d %c %d\\n\", pid,' ', ppid,' ',zaehler);\n        write(STDOUT_FILENO, ausgabe, strlen(ausgabe));\n        sleep(1);\n    zaehler++;\n    }   \n    //write(STDOUT_FILENO, (getpid()+k)%100, strlen((getpid()+k)/100));\n    //printf(\"%d\\n\", (getpid()+k)%100);\n    out=(getpid()+k)%100;\n    printf(\"%i\", out);\n    exit((getpid()+k)%100);\n }\n    else\n    {\n        //Elternprozess liegt vor\n        time_t curtime;\n        time(&amp;curtime);\n        printf(\"Start: %s\", ctime(&amp;curtime));\n\n    }\n    //int exitcode=wait(NULL);\n    wait(NULL);\n    //exitcode to String casten:\n    char str[24];\n    sprintf(str, \"Exit-Code: %i\\n\", out);\n    //Ausgabe und exitcode zu einem String zusammenfuegen: (vorher concat())\n    //char* s = concat(\"Exit-Code: \", str);\n    //strncat(*str,\"Exit-Code: \",str);\n    //Ausgabe des Exitcodes:\n    write(STDOUT_FILENO, str, strlen(str));\n    time_t curtime;\n    time(&amp;curtime);\n    printf(\"Ende: %s\\n\", ctime(&amp;curtime));\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["android", "c", "linux", "ion"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1542809986, "post_id": 53413773, "comment_id": 93702648, "body": "It&#39;s not presently clear to me, and I&#39;m having trouble finding a primary documentation source, but my first inclination would indeed be to interpret a restriction to one client per process to mean no more than one FD open on the device per process."}, {"owner": {"reputation": 1107, "user_id": 560774, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ca0e429a0e536995122dfe8303276cb1?s=128&d=identicon&r=PG", "display_name": "dv_", "link": "https://stackoverflow.com/users/560774/dv"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1542832198, "post_id": 53413773, "comment_id": 93714288, "body": "I wrote a quick test, and it seems that I can indeed open multiple file descriptors. This is an i.MX8M device though, so I am not 100% sure if this isn&#39;t the result of modifications from NXP, or perhaps undefined behavior."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1542834590, "post_id": 53413773, "comment_id": 93715319, "body": "&quot;There can be no more than one client per user process&quot; does not necessarily mean that attempts to create additional clients will fail.  It could instead mean that one process using multiple clients causes or risks misbehavior."}, {"owner": {"reputation": 1107, "user_id": 560774, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ca0e429a0e536995122dfe8303276cb1?s=128&d=identicon&r=PG", "display_name": "dv_", "link": "https://stackoverflow.com/users/560774/dv"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1542878325, "post_id": 53413773, "comment_id": 93729102, "body": "Yeah, that&#39;s the problem - this case is poorly defined. Furthermore, newest versions of the ion allocator in the kernel do not even have the ion client anymore, so this whole point is probably moot. For now, I&#39;ll have to stick to version/platform specific behavior, like that on the i.MX8."}], "owner": {"reputation": 1107, "user_id": 560774, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ca0e429a0e536995122dfe8303276cb1?s=128&d=identicon&r=PG", "display_name": "dv_", "link": "https://stackoverflow.com/users/560774/dv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 432, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542809536, "creation_date": 1542808887, "last_edit_date": 1542809536, "question_id": 53413773, "link": "https://stackoverflow.com/questions/53413773/opening-more-than-one-file-descriptor-to-dev-ion", "title": "Opening more than one file descriptor to /dev/ion", "body": "<p><a href=\"https://lwn.net/Articles/480055/\" rel=\"nofollow noreferrer\">This article</a> states:</p>\n\n<blockquote>\n  <p>A user space C/C++ program must have been granted access to the /dev/ion device before it can allocate memory from ION. A call to open(\"/dev/ion\", O_RDONLY) returns a file descriptor as a handle representing an ION client. Yes, one can allocate writable memory with an O_RDONLY open. There can be no more than one client per user process.</p>\n</blockquote>\n\n<p>However, what is unclear to me is if there there can be only one <em>file descriptor</em> to /dev/ion per user process. I mean, \"there can be no more than one client per user process\" may not necessarily mean \"there can be no more than one FD to /dev/ion per user process\". For example, it could be that there is only one ION client per process, but that opening multiple /dev/ion FDs just increments an internal ION client reference count, meaning that these multiple FDs all refer to the same ION client.</p>\n\n<p>So, is calling open() multiple times OK?</p>\n\n<p>This is important, because I have multiple code fragments here in a project, and all of them try to open /dev/ion by themselves. If this is okay to do, then I leave them as they are, otherwise I have to refactor them to use one global /dev/ion FD.</p>\n"}, {"tags": ["c", "samba"], "comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1542807853, "post_id": 53413404, "comment_id": 93701317, "body": "That&#39;s not possible to answer without more context. What are you doing  ? Where in the samba code base are you doing it, and does that part of the code deal with &quot;clients&quot; ?"}, {"owner": {"reputation": 465, "user_id": 3077485, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/RIQ2i.jpg?s=128&g=1", "display_name": "Gilo", "link": "https://stackoverflow.com/users/3077485/gilo"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1542808346, "post_id": 53413404, "comment_id": 93701655, "body": "@nos it is in one of the vfs files I am trying to get the client IP for logging.  static struct vfs_fn_pointers my_vfs{ .rename_fn = my_rename....};  static int my_rename(vfs_handle_struct *handle, \t\t\t      const struct smb_filename *smb_fname_src, \t\t\t      const struct smb_filename *smb_fname_dst) {"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1542808487, "post_id": 53413404, "comment_id": 93701740, "body": "Well, without more code that shows what you are doing and whether you are doing it in the proper place , I don&#39;t see how anyone can help you with this."}, {"owner": {"reputation": 465, "user_id": 3077485, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/RIQ2i.jpg?s=128&g=1", "display_name": "Gilo", "link": "https://stackoverflow.com/users/3077485/gilo"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1542808732, "post_id": 53413404, "comment_id": 93701900, "body": "@nos I added more code to clarify. See the upper part of the original question"}], "owner": {"reputation": 465, "user_id": 3077485, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/RIQ2i.jpg?s=128&g=1", "display_name": "Gilo", "link": "https://stackoverflow.com/users/3077485/gilo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542809111, "creation_date": 1542807736, "last_edit_date": 1542809111, "question_id": 53413404, "link": "https://stackoverflow.com/questions/53413404/samba-how-to-get-client-ip", "title": "SAMBA - how to get client IP", "body": "<p>I tried to get the client IP with SAMBA by:</p>\n\n<pre><code>char *client_ip = tsocket_address_inet_addr_string(handle-&gt;conn-&gt;sconn-&gt;remote_address, talloc_tos());\n</code></pre>\n\n<p>From looking at their source code, I see that <strong><em>sconn</em></strong> can be NULL (and I am getting NULL)</p>\n\n<pre><code>struct smbd_server_connection *sconn; /* can be NULL */\n</code></pre>\n\n<p>So how can I get the client IP?</p>\n\n<p>More specifically \nIt is in one of the vfs files. I am trying to get the client IP for logging.</p>\n\n<pre><code>static struct vfs_fn_pointers my_vfs = { \n    .rename_fn = my_rename\n}; \n\nstatic int my_rename(vfs_handle_struct *handle,\n                  const struct smb_filename *smb_fname_src,\n                  const struct smb_filename *smb_fname_dst)\n{\n//HERE. HOW TO GET THE CLIENT IP FROM *handle OR ANY OTHER METHOD)\n}\n</code></pre>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 4, "creation_date": 1542807813, "post_id": 53413335, "comment_id": 93701290, "body": "Interesting observation.  I&#39;d venture a guess that if you delve into operator overloading, then this type of usage might make sense.  Which would explain why it&#39;s part of C++ but not C."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1542808043, "post_id": 53413335, "comment_id": 93701437, "body": "related/dupe: <a href=\"https://stackoverflow.com/questions/371503/why-is-i-considered-an-l-value-but-i-is-not\" title=\"why is i considered an l value but i is not\">stackoverflow.com/questions/371503/&hellip;</a>.  I think the top answer has the best reasoning I&#39;ve seen.  IT wasn&#39;t possible to do this in C since C doesn&#39;t have references but C++ does so it would be a natural extension."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 2, "creation_date": 1542808151, "post_id": 53413335, "comment_id": 93701506, "body": "I have never seen &quot;locator value&quot; before, and suspect it&#39;s a backronym. As far as I know, l-value and r-value originally referred to the left and right side of an assignment expression."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 1, "creation_date": 1542808254, "post_id": 53413335, "comment_id": 93701586, "body": "@TimRandall It&#39;s actually in the C99 standard, which surprised me."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1542808342, "post_id": 53413335, "comment_id": 93701653, "body": "@NathanOliver is there a corresponding &quot;meaning&quot; for r-value?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1542808460, "post_id": 53413335, "comment_id": 93701718, "body": "In C99 <i>value of an expression</i>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1542811171, "post_id": 53413335, "comment_id": 93703297, "body": "This is definitely a dupe but I can&#39;t find the canonical one."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1542812627, "post_id": 53413335, "comment_id": 93704205, "body": "@ptr_user7813604 If not even veteran users can find it, then we clearly can&#39;t blame you for not finding it either. The SO duplicate system isn&#39;t great."}], "answers": [{"comments": [{"owner": {"reputation": 1095, "user_id": 7813604, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c05e209ba1c9aecc893a588b77b5d82f?s=128&d=identicon&r=PG&f=1", "display_name": "Kindred", "link": "https://stackoverflow.com/users/7813604/kindred"}, "edited": false, "score": 0, "creation_date": 1542809042, "post_id": 53413512, "comment_id": 93702086, "body": "So principle of least privilege saves the day right? Allowing it to be an lvalue on primitive type doesn&#39;t cause any trouble. C is the best, I knew it. (not to offend, C++ is also the best :))"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1542809182, "post_id": 53413512, "comment_id": 93702163, "body": "I&#39;m not buying it.  As far as I can tell, C++ could have the same rule as C and still implement overloaded <code>++</code> operators the same way.  It affects how you can <i>use</i> the result, not necessarily how you must <i>compute</i> the result."}], "tags": [], "owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "is_accepted": true, "score": 7, "last_activity_date": 1542808058, "creation_date": 1542808058, "answer_id": 53413512, "question_id": 53413335, "link": "https://stackoverflow.com/questions/53413335/differences-between-prefix-increment-operator-in-c-and-c/53413512#53413512", "title": "Differences between prefix-increment operator in C and C++", "body": "<p>In C++, prefix <code>++</code> giving lvalue is actually very natural. </p>\n\n<p>Because C++ has operator overloading. For most iterators of potentially complicated type, the prefix <code>++</code> returns the lvalue of the iterator itself.</p>\n\n<p>Thus for generic programming, it would be inconvenient to make fundamental type a special case.</p>\n\n<p>For example;</p>\n\n<pre><code>auto &amp;iter = ++old_iter;\n</code></pre>\n\n<p>wouldn't work if prefix increment of pointer gives an rvalue.</p>\n"}], "owner": {"reputation": 1095, "user_id": 7813604, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c05e209ba1c9aecc893a588b77b5d82f?s=128&d=identicon&r=PG&f=1", "display_name": "Kindred", "link": "https://stackoverflow.com/users/7813604/kindred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 53413512, "answer_count": 1, "score": 7, "last_activity_date": 1542812664, "creation_date": 1542807560, "last_edit_date": 1542812664, "question_id": 53413335, "link": "https://stackoverflow.com/questions/53413335/differences-between-prefix-increment-operator-in-c-and-c", "title": "Differences between prefix-increment operator in C and C++", "body": "<p>I just read the <a href=\"https://en.cppreference.com/w/c/language/operator_incdec\" rel=\"nofollow noreferrer\">C reference about prefix increment operator</a> and realized that the result of prefix increment operator are not lvalue, but it's surprising that it is lvalue in C++. After that I read <a href=\"https://stackoverflow.com/a/371669/7813604\">this answer</a> which explaining why it's a lvalue, but I don't understand it:</p>\n\n<blockquote>\n  <p>(Line 3): <em>[\"] it appears that it is so you can take its address or assign to a reference. [.\"]</em></p>\n</blockquote>\n\n<p>and an example follows:</p>\n\n<blockquote>\n<pre><code>int i;\nextern void f (int* p);\n\nf (&amp;++i);   /* Would be illegal C, but C programmers\n              havent missed this feature */\n...\n</code></pre>\n</blockquote>\n\n<p>So what's the merit of allowing this? Is the only purpose of this that incrementing <code>i</code> in global region is illegal? If this is the only reason I would consider this be a remedy for a defect in C that cannot/hard to be resolved, or the program should probably be rewritten for the sake of readability, right?</p>\n\n<p>btw I don't understand why lvalue is also called \"locator value\", I've read <a href=\"https://msdn.microsoft.com/en-us/library/bkbs2cds.aspx\" rel=\"nofollow noreferrer\">this - line 4</a> but locator is vague for me. What's a locator, is it a pointer something?</p>\n\n<p><strong>EDIT</strong>: For the sake of your precious time reading about wth is locator value, here is my <em>homemade backronym</em>:</p>\n\n<ul>\n<li>lvalue: location value, you know the location of it.</li>\n<li>rvalue: read value, you can only read the value.</li>\n</ul>\n\n<p>don't blame me if anything gone wrong.</p>\n"}, {"tags": ["c", "integer", "reverse", "digits"], "comments": [{"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1542807474, "post_id": 53413245, "comment_id": 93701073, "body": "Your loop condition, <code>num &gt; 0</code>, will cause the loop to execute until <code>num</code> overflows, which is undefined behavior."}, {"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1542807596, "post_id": 53413245, "comment_id": 93701143, "body": "<code>preNum &#47;= 10;</code> is pointless because you have <code>preNum = num;</code> at the beginning of the loop."}, {"owner": {"reputation": 47, "user_id": 10686070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hoNGQ.jpg?s=128&g=1", "display_name": "Levent Kaya", "link": "https://stackoverflow.com/users/10686070/levent-kaya"}, "reply_to_user": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1542807645, "post_id": 53413245, "comment_id": 93701175, "body": "ok thank you so much!"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 10686070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hoNGQ.jpg?s=128&g=1", "display_name": "Levent Kaya", "link": "https://stackoverflow.com/users/10686070/levent-kaya"}, "edited": false, "score": 0, "creation_date": 1542809234, "post_id": 53413465, "comment_id": 93702198, "body": "You are awesome bro THANK YOU"}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "reply_to_user": {"reputation": 47, "user_id": 10686070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hoNGQ.jpg?s=128&g=1", "display_name": "Levent Kaya", "link": "https://stackoverflow.com/users/10686070/levent-kaya"}, "edited": false, "score": 0, "creation_date": 1542861546, "post_id": 53413465, "comment_id": 93722301, "body": "@CodeJunky Please check the accept button if this answers your question."}], "tags": [], "owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "is_accepted": true, "score": 1, "last_activity_date": 1542807928, "creation_date": 1542807928, "answer_id": 53413465, "question_id": 53413245, "link": "https://stackoverflow.com/questions/53413245/reverse-integer-in-endless-loops/53413465#53413465", "title": "Reverse Integer in Endless Loops", "body": "<p>If I understand your question correctly, you need to change your code to something like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int num = 2, preNum, digit;\n\n    while (num &lt; 100)\n    {\n        preNum = num;\n        printf(\"%d: \", preNum);\n        while(preNum)\n        {\n            digit = preNum % 10;\n            printf(\"%d\", digit);\n            preNum /= 10;\n        }\n        printf(\"\\n\");\n\n        num++;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The following output is produced:</p>\n\n<pre>\n$ gcc main.c -o main.exe; ./main.exe\n2: 2\n3: 3\n4: 4\n5: 5\n6: 6\n7: 7\n8: 8\n9: 9\n10: 01\n11: 11\n12: 21\n13: 31\n14: 41\n15: 51\n16: 61\n17: 71\n18: 81\n19: 91\n20: 02\n...\n</pre>\n"}], "owner": {"reputation": 47, "user_id": 10686070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hoNGQ.jpg?s=128&g=1", "display_name": "Levent Kaya", "link": "https://stackoverflow.com/users/10686070/levent-kaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 53413465, "answer_count": 1, "score": -2, "last_activity_date": 1542807928, "creation_date": 1542807288, "last_edit_date": 1542807351, "question_id": 53413245, "link": "https://stackoverflow.com/questions/53413245/reverse-integer-in-endless-loops", "title": "Reverse Integer in Endless Loops", "body": "<p>Hey its OK to when i set value for integer but i dont want just reverse one i want reverse integer in a endless loop(infinite) so here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main() {\nint num = 2, preNum, digit;\n\n\nwhile (1)\n{\n    while (num &gt; 0)\n    {\n        preNum = num;\n        digit = preNum % 10;\n        printf(\"%d\", digit);\n        preNum /= 10;\n    }\n    num++;\n}\n\n\n\n\ngetch();\nreturn 0;\n}\n</code></pre>\n\n<p>here is the wrong par ?</p>\n"}, {"tags": ["c", "arrays", "scanf"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1542806020, "post_id": 53412774, "comment_id": 93700206, "body": "Start by adding error checking to your code; especially with <code>fscanf()</code>."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1542806336, "post_id": 53412774, "comment_id": 93700382, "body": "Suspect you&#39;ve mis-declared <code>subject</code> - it looks like you&#39;re expecting it to be an array of strings, but instead you&#39;ve just got it as a string."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542806401, "post_id": 53412774, "comment_id": 93700425, "body": "<code>if (i == SIZE)</code> in your loop will never happen because you only loop while <code>i &lt; SIZE</code>. You have to think about a better way to exit the loop if there is no more input."}, {"owner": {"reputation": 49, "user_id": 10649711, "user_type": "registered", "profile_image": "https://graph.facebook.com/316425832510594/picture?type=large", "display_name": "Aleksandre Sikharulidze", "link": "https://stackoverflow.com/users/10649711/aleksandre-sikharulidze"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1542806427, "post_id": 53412774, "comment_id": 93700437, "body": "@ChrisTurner Array of chars and it should be a string, that is the idea."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542806479, "post_id": 53412774, "comment_id": 93700460, "body": "A string is an array of <code>char</code>s. A array of strings is an array of arrays of <code>char</code>s."}, {"owner": {"reputation": 49, "user_id": 10649711, "user_type": "registered", "profile_image": "https://graph.facebook.com/316425832510594/picture?type=large", "display_name": "Aleksandre Sikharulidze", "link": "https://stackoverflow.com/users/10649711/aleksandre-sikharulidze"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542806485, "post_id": 53412774, "comment_id": 93700470, "body": "@Swordfish What if I use EOF ?"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1542806499, "post_id": 53412774, "comment_id": 93700474, "body": "In that case you&#39;re reading it in incorrectly, you just want to pass <code>subject</code> to <code>scanf</code> and <code>printf</code> not <code>&amp;subject[i]</code>"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542806572, "post_id": 53412774, "comment_id": 93700518, "body": "You might want to look up which values <code>fscanf()</code> returns under which conditions."}, {"owner": {"reputation": 49, "user_id": 10649711, "user_type": "registered", "profile_image": "https://graph.facebook.com/316425832510594/picture?type=large", "display_name": "Aleksandre Sikharulidze", "link": "https://stackoverflow.com/users/10649711/aleksandre-sikharulidze"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1542806757, "post_id": 53412774, "comment_id": 93700633, "body": "@ChrisTurner Did that and It just leaves first letters. Programming PMathematics PMPhysics and like that and still adds more stuff at the end"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 10649711, "user_type": "registered", "profile_image": "https://graph.facebook.com/316425832510594/picture?type=large", "display_name": "Aleksandre Sikharulidze", "link": "https://stackoverflow.com/users/10649711/aleksandre-sikharulidze"}, "edited": false, "score": 0, "creation_date": 1542808288, "post_id": 53413365, "comment_id": 93701611, "body": "I used it, but it outputs something mixed, it gives me all the subjects and it is good, but it mixes with grades, but incomplete and incorrect amount of grades, grade count should be just 1 number for each course"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 49, "user_id": 10649711, "user_type": "registered", "profile_image": "https://graph.facebook.com/316425832510594/picture?type=large", "display_name": "Aleksandre Sikharulidze", "link": "https://stackoverflow.com/users/10649711/aleksandre-sikharulidze"}, "edited": false, "score": 0, "creation_date": 1542808555, "post_id": 53413365, "comment_id": 93701778, "body": "I&#39;m not sure I follow - the code I&#39;ve included should just print out each <code>subject</code>. It doesn&#39;t print out <code>gradeCount</code> or the <code>grades</code> as those lines are commented out."}, {"owner": {"reputation": 49, "user_id": 10649711, "user_type": "registered", "profile_image": "https://graph.facebook.com/316425832510594/picture?type=large", "display_name": "Aleksandre Sikharulidze", "link": "https://stackoverflow.com/users/10649711/aleksandre-sikharulidze"}, "edited": false, "score": 0, "creation_date": 1542808873, "post_id": 53413365, "comment_id": 93701972, "body": "I understand and that is the main reason of this question, it just acts strangely. This is the output I get.  Programming 3 5 3 4 2 Mathematics 3 4 3 2 Physics 3 5 4 Design 5 5 2 Logistics 3 5 1 2"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 49, "user_id": 10649711, "user_type": "registered", "profile_image": "https://graph.facebook.com/316425832510594/picture?type=large", "display_name": "Aleksandre Sikharulidze", "link": "https://stackoverflow.com/users/10649711/aleksandre-sikharulidze"}, "edited": false, "score": 1, "creation_date": 1542810313, "post_id": 53413365, "comment_id": 93702848, "body": "If that&#39;s the output you&#39;re getting, then you&#39;re not running the code included in the question, with or without my changes. If I run that code I get just &quot;Programming Mathematics Physics Design Logistics&quot;"}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": 0, "last_activity_date": 1542807636, "creation_date": 1542807636, "answer_id": 53413365, "question_id": 53412774, "link": "https://stackoverflow.com/questions/53412774/c-larger-output-than-i-have-in-file-size-problem/53413365#53413365", "title": "C - Larger Output Than I have in File (Size Problem)", "body": "<p>You need to exit the loop early if it fails to read anything in. You can do that by checking the return value of <code>fscanf</code>. If the first call doesn't return 2, you know that it didn't read in 2 values and can <code>break</code> out of the loop.</p>\n\n<p>You're also calling <code>fscanf</code> and <code>printf</code> incorrectly for dealing with a string. You are moving the starting point of where you read into/print from, which isn't needed and reduces the maximum space available to you.</p>\n\n<p>Updated code looks something like this</p>\n\n<pre><code>for (int i = 0; i &lt; SIZE; i++) {\n    if(fscanf(fp, \"%s %d\", subject, &amp;gradeCount) != 2) {\n        break;\n    }\n\n    printf(\"%s \", subject);\n    //printf(\"%d \\n\", gradeCount);\n    for (int k = 0; k &lt; gradeCount; k++)\n    {\n        fscanf(fp, \"%d\", &amp;grades[k]);\n        // printf(\"%d\" , grades[k]);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 10649711, "user_type": "registered", "profile_image": "https://graph.facebook.com/316425832510594/picture?type=large", "display_name": "Aleksandre Sikharulidze", "link": "https://stackoverflow.com/users/10649711/aleksandre-sikharulidze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542807636, "creation_date": 1542805728, "last_edit_date": 1542806302, "question_id": 53412774, "link": "https://stackoverflow.com/questions/53412774/c-larger-output-than-i-have-in-file-size-problem", "title": "C - Larger Output Than I have in File (Size Problem)", "body": "<p>I have a file, with format:</p>\n\n<p>Course - Grade Count - Grades</p>\n\n<pre><code>Programming 10 3 4 5 4 3 2 4 5 2 3\nMathematics 8 3 3 4 5 3 2 2 3\nPhysics 6 3 4 5 3 4 5\nDesign 6 5 4 5 3 2 4\nLogistics 8 3 4 5 3 1 1 2 4\n</code></pre>\n\n<p>Ex: Course - Programming, Grade Count - 10 and Grades - 3 4 5 4 3 2 4 5 2 3</p>\n\n<p>I already have </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n\n#define SIZE 70\n\nint main(void)\n{\n    char subject[SIZE];\n    int gradeCount;\n    int grades[SIZE];\n\n    FILE *fp = fopen(\"C:\\\\Project\\\\project.txt\", \"r\"); //opening already created file\n\n\n    if (fp == NULL) {\n        perror(\"Error opening file\");\n        return(-1);\n    }\n\n    for (int i = 0; i &lt; SIZE; i++) {\n\n        fscanf(fp, \"%s %d\", &amp;subject[i], &amp;gradeCount);\n        printf(\"%s \\n\", &amp;subject[i]);\n        //printf(\"%d \\n\", gradeCount);\n        for (int k = 0; k &lt; gradeCount; k++)\n        {\n            fscanf(fp, \"%d\", &amp;grades[k]);\n            // printf(\"%d \\n\" , grades[k]);\n\n        }\n\n        if (i == SIZE) {\n            break;\n        }\n    }\n\n    fclose(fp);\n    return 0;\n}\n</code></pre>\n\n<p>I need to print out \"Course\", \"Grade Count\" and \"Grades\" without any problems, later on I need to make a search and so I need to separate them from each other, but that is not the case, now I will show you the outputs for all cases, when I output first \"Subject/Course\" then \"Grade Count\" and finally \"Grades\".</p>\n\n<p>For Courses:</p>\n\n<pre><code>Programming\nMathematics\nPhysics\nDesign\nLogistics\nogistics\ngistics\nistics\nstics\ntics\nics\ncs\ns\n\n@\n\n@@\n@\n@\n</code></pre>\n\n<p>For Grade Count:</p>\n\n<pre><code>10\n8\n6\n6\n8\n8\n8\n8\n8\n8\n8\n8\n8\n8\n8\n8\n8\n8\n8\n8\n</code></pre>\n\n<p>And for Grades:</p>\n\n<pre><code>3\n4\n5\n4\n3\n2\n4\n5\n2\n3\n3\n3\n4\n5\n3\n2\n2\n3\n3\n4\n5\n3\n4\n5\n5\n4\n5\n3\n2\n4\n3\n4\n5\n3\n1\n1\n2\n4\n3\n4\n5\n3\n1\n1\n2\n4\n3\n4\n5\n3\n1\n1\n2\n4\n3\n4\n5\n3\n1\n1\n2\n4\n3\n4\n5\n3\n1\n1\n2\n4\n3\n4\n5\n3\n1\n1\n2\n4\n3\n4\n5\n3\n1\n1\n2\n4\n3\n4\n5\n3\n1\n1\n2\n4\n3\n4\n5\n3\n1\n1\n2\n4\n3\n4\n5\n3\n1\n1\n2\n4\n3\n4\n5\n3\n1\n1\n2\n4\n3\n4\n5\n3\n1\n1\n2\n4\n3\n4\n5\n3\n1\n1\n2\n4\n3\n4\n5\n3\n1\n1\n2\n4\n3\n4\n5\n3\n1\n1\n2\n4\n3\n4\n5\n3\n1\n1\n2\n4\n</code></pre>\n\n<p>In all cases, additional things are added to original stuff that should be printed out, I don't know where it comes from, I thought about pointers, but don't know much about them. Any suggestions? </p>\n\n<p>Just need to print everything normally to normally search for everything (Courses, grade count and grades) later on.</p>\n"}, {"tags": ["c", "memory-management", "merge", "malloc", "free"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1542805022, "post_id": 53412469, "comment_id": 93699687, "body": "I don&#39;t get why you&#39;re comparing the next pointer to MAGIC and aborting if that&#39;s not what&#39;s there."}, {"owner": {"reputation": 17, "user_id": 9093743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187ef5a0c2d529c005eab0b690c87633?s=128&d=identicon&r=PG&f=1", "display_name": "Nicooost", "link": "https://stackoverflow.com/users/9093743/nicooost"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1542806055, "post_id": 53412469, "comment_id": 93700227, "body": "If you malloc a block the next element of this block is MAGIC. (lauf-&gt;next = MAGIC;)   And in the free() you have to check if the element you want to free can be freed at all or if it is already free."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1542813914, "post_id": 53412469, "comment_id": 93705021, "body": "This is rather broad question. So you have a linked list, with list items representing memory blocks. And then you need to find the list items which point to adjacent memory blocks, and remove one, and fix start and length of the other to cover the memory area of both. Simple brute force way would be to traverse the free list, and test if the freed block can be merged with existing free block (either before or after), and then add it as last in the list if no suitable merge candidate was found."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1542813987, "post_id": 53412469, "comment_id": 93705046, "body": "After that works, you might want to check if the newly enlarged free block could now be merged too (in case the freed block filled a gap between two free blocks)."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1542814148, "post_id": 53412469, "comment_id": 93705140, "body": "A more efficient solution would involve using some more advanced data structure (such as a tree of some kind) to hold the free blocks, so you wouldn&#39;t have to traverse the entire list to find possible merge candidates. Slight improvement could be achieved by keeping the free list sorted (which is basically free, since you need to traverse it anyway), so you can stop searching earlier."}], "owner": {"reputation": 17, "user_id": 9093743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187ef5a0c2d529c005eab0b690c87633?s=128&d=identicon&r=PG&f=1", "display_name": "Nicooost", "link": "https://stackoverflow.com/users/9093743/nicooost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542804782, "creation_date": 1542804782, "question_id": 53412469, "link": "https://stackoverflow.com/questions/53412469/own-free-in-c-melt-free-data-blocks", "title": "Own free() in c | melt free data blocks", "body": "<p>i had to write my own free &amp; malloc function. \nSo far I have not had a problem with that, but now I am supposed to merge neighboring free memory blocks in the halde_free() function. I would be really grateful if you could help me there.</p>\n\n<pre><code>    #include \"halde.h\"\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\n/// Magic value for occupied memory chunks.\n#define MAGIC ((void*)0xbaadf00d)\n\n/// Size of the heap (in bytes).\n#define SIZE (1024*1024*1)\n\n/// Memory-chunk structure.\nstruct mblock {\n    struct mblock *next;\n    size_t size;\n    char memory[];\n};\n\n/// Heap-memory area.\nchar memory[SIZE];\n\n/// Pointer to the first element of the free-memory list.\nstatic struct mblock *head;\n\n/// Helper function to visualise the current state of the free-memory list.\nvoid halde_print(void) {\n    struct mblock* lauf = head;\n\n    // Empty list\n    if ( head == NULL ) {\n        fprintf(stderr, \"(empty)\\n\");\n        return;\n    }\n\n    // Print each element in the list\n    while ( lauf ) {\n        fprintf(stderr, \"(addr: 0x%08zx, off: %7zu, \", (uintptr_t) lauf, (uintptr_t)lauf - (uintptr_t)memory);\n        fflush(stderr);\n        fprintf(stderr, \"size: %7zu)\", lauf-&gt;size);\n        fflush(stderr);\n\n        if ( lauf-&gt;next != NULL ) {\n            fprintf(stderr, \"  --&gt;  \");\n            fflush(stderr);\n        }\n        lauf = lauf-&gt;next;\n    }\n    fprintf(stderr, \"\\n\");\n    fflush(stderr);\n}\n\nvoid *halde_malloc (size_t size) {\n    static int initialized = 0;\n\n    if(initialized == 0){\n        head = (struct mblock *) memory;\n        head-&gt;size = sizeof(memory) - sizeof (struct mblock);\n        head-&gt;next = NULL;\n        initialized = 1;\n    }\n\n    if(size == 0){\n        return NULL;\n    }\n\n    struct mblock *lauf = head;\n    struct mblock **prev_next = &amp;head;\n\n    while (lauf != NULL &amp;&amp; lauf-&gt;size &lt; size){\n        prev_next = &amp;(lauf-&gt;next);\n        lauf = *prev_next;\n    }\n\n    if(lauf == NULL){\n        errno = ENOMEM;\n        return NULL;\n    }\n\n    if((lauf-&gt;size -size) &lt;= sizeof(struct mblock)){\n        *prev_next = lauf-&gt;next;\n    } else {\n        //mblock anlegen und init.\n        struct mblock* neu = (struct mblock*) (lauf-&gt;memory + size);\n        neu-&gt;size = lauf-&gt;size - sizeof(struct mblock) - size;\n        neu-&gt;next = lauf-&gt;next;\n\n        //mblock anpassen\n        lauf-&gt;size = size;\n\n        //verketten wiederherstellen\n        *prev_next = neu;\n    }\n\n    lauf-&gt;next = MAGIC;\n\n    return lauf-&gt;memory;\n}\n\nvoid halde_free (void *ptr) {\n    if(ptr == NULL){\n        return;\n    }\n\n    struct mblock *mbp = (struct mblock *) ptr - 1;\n    if(mbp-&gt;next != MAGIC){\n        abort();\n    } else {\n        mbp-&gt;next = head;\n        head = mbp;\n    }\n}\n</code></pre>\n\n<p>The code works so far but i have really no idea how to merge blocks.. \nThe memory management runs over a simply linked lists. The variable head points to the first free memory block.</p>\n\n<p>My idea is to merge the blocks directly in the else part but i don't have a good idea to do that..</p>\n"}, {"tags": ["c", "openmp"], "answers": [{"comments": [{"owner": {"reputation": 1608, "user_id": 7757135, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JQ8Kt.png?s=128&g=1", "display_name": "JuMoGar", "link": "https://stackoverflow.com/users/7757135/jumogar"}, "edited": false, "score": 0, "creation_date": 1542808241, "post_id": 53413121, "comment_id": 93701574, "body": "Now the code is working. It lose a lot of troughput due to barriers and criticals, but that is other problem. Declarations and mallocing are working perfectly. Thank you."}, {"owner": {"reputation": 1608, "user_id": 7757135, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JQ8Kt.png?s=128&g=1", "display_name": "JuMoGar", "link": "https://stackoverflow.com/users/7757135/jumogar"}, "edited": false, "score": 0, "creation_date": 1542812419, "post_id": 53413121, "comment_id": 93704074, "body": "<code>numCoords</code> is 13 and <code>numObjs</code> is 239108"}], "tags": [], "owner": {"reputation": 1480, "user_id": 10450594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae4c6a0ca94b3094b25f18e66d8368ff?s=128&d=identicon&r=PG&f=1", "display_name": "Brice", "link": "https://stackoverflow.com/users/10450594/brice"}, "is_accepted": true, "score": 2, "last_activity_date": 1542806914, "creation_date": 1542806914, "answer_id": 53413121, "question_id": 53412033, "link": "https://stackoverflow.com/questions/53412033/how-to-declare-and-malloc-pointer-inside-openmp-parallel-region-error-segment/53413121#53413121", "title": "How to declare and malloc pointer inside OpenMP parallel region? (ERROR: Segment violation (&#39;core&#39; generated))", "body": "<p>Two reasons for the segfault:</p>\n\n<ul>\n<li><code>localClusterMemberCount</code> should be a shared variable declared outside of the parallel region, initialized within the parallel region by a single thread. Otherwise, each thread has its own copy of the variable, and for all but the thread that has gone through the <code>single</code>section, that points to a random location of the memory.</li>\n<li>An implicit or explicit barrier is needed before the section of code where pointers are freed. All threads needs to be done for sure before memory can be disallocated, otherwise one thread may free pointers still being used by other threads.</li>\n</ul>\n\n<p>There are few other issues with the code. See below with my own comments flagged with <code>***</code>:</p>\n\n<pre><code>void calculateClusterCentroIDs(int numCoords, int numObjs, int numClusters, float * dataSetMatrix, int * clusterAssignmentCurrent, float *clustersCentroID) {\n\n    int * clusterMemberCount = (int *) calloc (numClusters,sizeof(int));\n\n    /* ***\n     * This has to be a shared variable that each thread can access\n     * If declared inside the parallel region, it will be a thread-local variable\n     * which is left un-initialized for all but one thread. Further attempts to access\n     * that variable will lead to segfaults\n     */\n    int ** localClusterMemberCount;\n    #pragma omp parallel shared(localClusterMemberCount,clusterMemberCount)\n    {\n\n        // *** Make activeCluster a thread-local variable rather than a shared array (shared array will result in false sharing)\n        int activeCluster;\n        #pragma omp single\n        {\n            localClusterMemberCount = (int **) malloc (omp_get_num_threads() * sizeof(int *));\n            //localClusterMemberCount[0] = (int *) calloc (omp_get_num_threads()*numClusters,sizeof(int));\n            for (int i = 0; i &lt; omp_get_num_threads(); ++i) {\n                localClusterMemberCount[i] = calloc (numClusters,sizeof(int));\n                //localClusterMemberCount[i] = localClusterMemberCount[i-1] + numClusters;\n            }\n        }\n\n        // sum all points\n        // for every point\n        for (int i = 0; i &lt; numObjs; ++i) {\n            // which cluster is it in?\n            activeCluster = clusterAssignmentCurrent[i];\n            // update count of members in that cluster\n            ++localClusterMemberCount[omp_get_thread_num()][activeCluster];\n            // sum point coordinates for finding centroid\n\n            // *** This may be slower in parallel because of the atomic operation\n            for (int j = 0; j &lt; numCoords; ++j)\n                #pragma omp atomic\n                clustersCentroID[activeCluster*numCoords + j] += dataSetMatrix[i*numCoords + j];\n        }\n\n        /* ***\n         * Missing: one reduction step\n         * The global cluster member count needs to be updated\n         * one option is below :\n         */\n         #pragma omp critical\n         for (int i=0; i &lt; numClusters; ++i) clusterMemberCount+=localClusterMemberCount[omp_get_thread_num()];\n         #pragma omp barrier // wait here before moving on\n\n\n\n        // *** The code below was wrong; to compute the average, coordinates should be divided by the global count\n        // *** Sucessive divisions by local count will fail. Like, 1/(4+6) is not the same as (1/4)/6\n\n        // now divide each coordinate sum by number of members to find mean/centroid\n        // for each cluster\n        #pragma omp for\n        for (int i = 0; i &lt; numClusters; ++i) {\n            if (clusterMemberCount != 0)\n                // for each numCoordsension\n                #pragma omp simd //not sure this will help, the compiler may already vectorize that\n                for (int j = 0; j &lt; numCoords; ++j)\n                    clustersCentroID[i*numCoords + j] /= clusterMemberCount[i];  /// XXXX will divide by zero here for any empty clusters!\n                    // *** ^^ atomic is not needed\n                    // *** only one thread will access each value of clusterCentroID\n\n        }\n\n        #pragma omp barrier\n        /* ***\n         * A barrier is needed otherwise the first thread arriving there will start to free the memory\n         * Other threads may still be in the previous loop attempting to access localClusterMemberCount\n         * If the pointer has been freed already, this will result in a segfault\n         *\n         * With the corrected code, the implicit barrier at the end of the distributed\n         * for loop would be sufficient. With your initial code, an explicit barrier \n         * would have been needed.\n         */\n\n        // free memory\n        #pragma omp single\n        {\n            // *** Need to free all pointers and not only the first one\n            for (int i = 0; i &lt; omp_get_num_threads(); ++i) free (localClusterMemberCount[i]);\n            free (localClusterMemberCount);\n        }\n    }\n    free(clusterMemberCount);\n</code></pre>\n"}], "owner": {"reputation": 1608, "user_id": 7757135, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JQ8Kt.png?s=128&g=1", "display_name": "JuMoGar", "link": "https://stackoverflow.com/users/7757135/jumogar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 479, "favorite_count": 0, "accepted_answer_id": 53413121, "answer_count": 1, "score": 0, "last_activity_date": 1542806914, "creation_date": 1542803227, "question_id": 53412033, "link": "https://stackoverflow.com/questions/53412033/how-to-declare-and-malloc-pointer-inside-openmp-parallel-region-error-segment", "title": "How to declare and malloc pointer inside OpenMP parallel region? (ERROR: Segment violation (&#39;core&#39; generated))", "body": "<p>I am doing it like: </p>\n\n<pre><code>void calculateClusterCentroIDs(int numCoords, int numObjs, int numClusters, float * dataSetMatrix, int * clusterAssignmentCurrent, float *clustersCentroID) {\n\n    int * clusterMemberCount = (int *) calloc (numClusters,sizeof(int));\n\n    #pragma omp parallel \n    {\n        int ** localClusterMemberCount;\n        int * activeCluster;\n        #pragma omp single\n        {\n            localClusterMemberCount = (int **) malloc (omp_get_num_threads() * sizeof(int *));\n            //localClusterMemberCount[0] = (int *) calloc (omp_get_num_threads()*numClusters,sizeof(int));\n            for (int i = 0; i &lt; omp_get_num_threads(); ++i) {\n                localClusterMemberCount[i] = calloc (numClusters,sizeof(int));\n                //localClusterMemberCount[i] = localClusterMemberCount[i-1] + numClusters;\n            }\n            activeCluster = (int *) calloc (omp_get_num_threads(),sizeof(int));\n        }\n\n        // sum all points\n        // for every point\n        for (int i = 0; i &lt; numObjs; ++i) {\n            // which cluster is it in?\n            activeCluster[omp_get_thread_num()] = clusterAssignmentCurrent[i];\n            // update count of members in that cluster\n            ++localClusterMemberCount[omp_get_thread_num()][activeCluster[omp_get_thread_num()]];\n            // sum point coordinates for finding centroid\n            for (int j = 0; j &lt; numCoords; ++j)\n#pragma omp atomic\n                clustersCentroID[activeCluster[omp_get_thread_num()]*numCoords + j] += dataSetMatrix[i*numCoords + j];\n        }\n\n        // now divide each coordinate sum by number of members to find mean/centroid\n        // for each cluster\n        for (int i = 0; i &lt; numClusters; ++i) {\n            if (localClusterMemberCount[omp_get_thread_num()][i] != 0)\n                // for each numCoordsension\n                for (int j = 0; j &lt; numCoords; ++j)\n#pragma omp atomic\n                    clustersCentroID[i*numCoords + j] /= localClusterMemberCount[omp_get_thread_num()][i];  /// XXXX will divide by zero here for any empty clusters!\n        }\n\n        // free memory\n        #pragma omp single\n        {\n            free (localClusterMemberCount[0]);\n            free (localClusterMemberCount);\n            free (activeCluster);\n        }\n    }\n    free(clusterMemberCount);\n</code></pre>\n\n<p>But I get the error: <code>Segment violation ('core' generated)</code> so I am doing something bad, and I think the error is on mallocing pointers due to I have tried sequential code and it is working fine. Also I have tried parallel code but without mallocs (using globals variables with atomic) and that works fine too. The error only apears when I try to create private pointers and malloc them.</p>\n\n<p>Any idea how can I solve it?</p>\n"}, {"tags": ["c", "string", "segmentation-fault"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 2, "creation_date": 1542803549, "post_id": 53412012, "comment_id": 93698858, "body": "You declared a list of 32 <code>char *</code>s. And what they <i>point to</i> is undefined."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1542804068, "post_id": 53412012, "comment_id": 93699145, "body": "<code>malloc</code> is your friend."}, {"owner": {"reputation": 1887, "user_id": 2980012, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/84d7a206a8894a7280d94314d1201b58?s=128&d=identicon&r=PG&f=1", "display_name": "Coder77", "link": "https://stackoverflow.com/users/2980012/coder77"}, "edited": false, "score": 0, "creation_date": 1542805627, "post_id": 53412012, "comment_id": 93699995, "body": "amen to malloc, thanks guys"}], "answers": [{"comments": [{"owner": {"reputation": 955, "user_id": 9500171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dDeAV.jpg?s=128&g=1", "display_name": "Ian A.B. King", "link": "https://stackoverflow.com/users/9500171/ian-a-b-king"}, "edited": false, "score": 2, "creation_date": 1542804596, "post_id": 53412340, "comment_id": 93699454, "body": "I believe OP is still a begginer in terms of C, and given the question&#39;s content, I would assume he will have a lot of trouble understanding this answer without any explanation or comment."}], "tags": [], "owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "is_accepted": true, "score": 2, "last_activity_date": 1571094192, "last_edit_date": 1571094192, "creation_date": 1542804359, "answer_id": 53412340, "question_id": 53412012, "link": "https://stackoverflow.com/questions/53412012/assigning-character-in-array-of-strings-segmentation-fault-in-c/53412340#53412340", "title": "Assigning character in array of strings segmentation fault in C", "body": "<p>I think you want to define a 2-D char array.</p>\n\n<p>To do this make these steps:</p>\n\n<h3>First</h3>\n\n<p>Define a <code>char**</code> array of pointers.</p>\n\n<pre><code>char **splitStrings[bufSize];\n</code></pre>\n\n<h3>Second</h3>\n\n<p>Allocate memory for <strong>row</strong>:  </p>\n\n<pre><code>splitStrings = malloc(bufSize*sizeof(char*));\n</code></pre>\n\n<h3>Third</h3>\n\n<p>For each row allocate memory for <strong>its columns</strong>.</p>\n\n<pre><code>for (int i=0;i&lt;bufSize;i++){\n   splitStrings[i]=malloc(bufSize*sizeof(char*));\n}\n</code></pre>\n\n<hr>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;///for printf()\n#include &lt;stdlib.h&gt;///for malloc()\n\nint main(void){\n\n    const int bufSize = 32;\n    char **splitStrings;\n\n    splitStrings = malloc(bufSize*sizeof(char*));\n\n    for (int i=0;i&lt;bufSize;i++){\n        splitStrings[i]=malloc(bufSize*sizeof(char*));\n    }\n\n    splitStrings[0][0] = 'a';\n    splitStrings[0][1] = '\\0';\n\n    printf(\"testchar: %c\\n\", splitStrings[0][0]);\n    printf(\"teststr: %s\\n\", splitStrings[0]);\n\n    free(splitStrings);\n\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<p><strong><em>Further Notes</em></strong></p>\n\n<ul>\n<li>For more information about 2-D dynamic array <a href=\"https://stackoverflow.com/questions/2614249/dynamic-memory-for-2d-char-array\">see</a></li>\n<li>By using <code>malloc()</code> function in C never cast the result of it <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">see</a></li>\n<li><p>After allocating dynamic memory in <a href=\"https://www.gribblelab.org/CBootCamp/7_Memory_Stack_vs_Heap.html\" rel=\"nofollow noreferrer\">Heap</a> never forget to release it by using <a href=\"http://www.cplusplus.com/reference/cstdlib/free/\" rel=\"nofollow noreferrer\"><code>free()</code></a>.</p></li>\n<li><p>I suggest you read more about how to allocate dynamic memory in C with <a href=\"https://linux.die.net/man/3/malloc\" rel=\"nofollow noreferrer\"><code>malloc()</code></a> function.</p></li>\n</ul>\n\n<p><strong><em>Last Edition on code</em></strong></p>\n\n<p>Change <code>malloc(bufSize*sizeof(char));</code> to <code>malloc(bufSize*sizeof(char*));</code> this is true way of allocating memory</p>\n\n<p>Because in first case calling <code>free()</code> on <code>splitStrings</code> pointer cause memory error. <strong><em>Why?</em></strong></p>\n"}, {"comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1542806973, "post_id": 53412371, "comment_id": 93700766, "body": "Because by definition <code>sizeof(char)</code> will always == 1, your statement can be simplified to <code>...malloc(2);</code>"}], "tags": [], "owner": {"reputation": 1950, "user_id": 4049851, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-C6_hTSEP6Mc/AAAAAAAAAAI/AAAAAAAAAGg/fwUuZ82ifBA/photo.jpg?sz=128", "display_name": "Puck", "link": "https://stackoverflow.com/users/4049851/puck"}, "is_accepted": false, "score": 3, "last_activity_date": 1542804485, "creation_date": 1542804485, "answer_id": 53412371, "question_id": 53412012, "link": "https://stackoverflow.com/questions/53412012/assigning-character-in-array-of-strings-segmentation-fault-in-c/53412371#53412371", "title": "Assigning character in array of strings segmentation fault in C", "body": "<p>You missed a layer of declaration. You have a table of pointer on char <code>splitStrings</code>. Then you would need to book some memory space and point to it using your pointer. Here is the example for the first pointer:</p>\n\n<pre><code>splitStrings[0] = malloc(2*sizeof(char));\nsplitStrings[0][0] = 'a';\nsplitStrings[0][1] = '\\0';\nprintf(\"testchar: %c\",splitStrings[0][0]);\nprintf(\"teststr: %s\",splitStrings[0]);\n</code></pre>\n\n<p>Read how <code>malloc</code> is working and especially how to de-allocate memory with <code>free</code> once your done to avoid memory leak.</p>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 10673387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3578c8e29b8ffe62989972c3f03b60d?s=128&d=identicon&r=PG&f=1", "display_name": "Ramya Muralidharan", "link": "https://stackoverflow.com/users/10673387/ramya-muralidharan"}, "is_accepted": false, "score": 1, "last_activity_date": 1542805720, "creation_date": 1542805720, "answer_id": 53412769, "question_id": 53412012, "link": "https://stackoverflow.com/questions/53412012/assigning-character-in-array-of-strings-segmentation-fault-in-c/53412769#53412769", "title": "Assigning character in array of strings segmentation fault in C", "body": "<pre><code>char* splitStrings[bufSize]; //is expecting address, if it is derefencing directely will through segmentation fault.\n</code></pre>\n\n<p>we have two options one is dynamic memory allocation otherwise declare like below.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nvoid main()\n{\n    const int bufSize = 32;\n    char splitStrings[1][bufSize];\n    splitStrings[0][0] = 'a';\n    splitStrings[0][1] = '\\0';\n    printf(\"testchar: %c\",splitStrings[0][0]);\n    printf(\"teststr: %s\",splitStrings[0]);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 185, "user_id": 3025685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b33ed5f51c101e8b972e440268e06815?s=128&d=identicon&r=PG&f=1", "display_name": "MrSpudtastic", "link": "https://stackoverflow.com/users/3025685/mrspudtastic"}, "is_accepted": false, "score": 1, "last_activity_date": 1545843596, "creation_date": 1545843596, "answer_id": 53934885, "question_id": 53412012, "link": "https://stackoverflow.com/questions/53412012/assigning-character-in-array-of-strings-segmentation-fault-in-c/53934885#53934885", "title": "Assigning character in array of strings segmentation fault in C", "body": "<p>Others have answered how to fix the error, so I won't go over that. Instead, I will answer the question of why you are getting a segmentation fault. </p>\n\n<p>So, let's step through your code and see what's happening!</p>\n\n<pre><code>const int buffsize = 32;\nchar* splitStrings[buffsize];\n</code></pre>\n\n<p>Alright! So far, you have declared a const int of size 32 (good use of const btw!), and you have created a pointer to an array of characters of size 32!</p>\n\n<p>So let's look at the next line!</p>\n\n<pre><code>splitStrings[0][0] = 'a';\n</code></pre>\n\n<p>So now, you are trying to look at the first item in the array that splitStrings points to, and then looking at the first item in that array. And this is where you get your segmentation fault!</p>\n\n<p>In C, a segmentation fault occurs when something tries to access memory that it is not allowed to access. In this case, it's alright for you to access splitStrings[0], but not splitStrings[0][0]. This is because you currently don't have an array at splitStrings[0] - instead, you just have an unassigned pointer to a character. </p>\n\n<p>So, when the compiler tries to work through that, it says \"Okay, let's look at the first item in splitStrings! Alright, that's a pointer to a character! Now, let's look at the first item under that character! It's - wait, hold on. I haven't assigned that yet, it isn't allowed to have its own array yet! Segmentation fault!\"</p>\n\n<p>To fix this, you will need to create a 2D array (that's an array of arrays) and allocate that memory. EsmaeelE has given good instructions on how to do that in their answer <a href=\"https://stackoverflow.com/questions/53412012/assigning-character-in-array-of-strings-segmentation-fault-in-c/53412340#53412340\">here</a>. I also highly recommend the TutorialsPoint segments on <a href=\"https://www.tutorialspoint.com/cprogramming/c_multi_dimensional_arrays.htm\" rel=\"nofollow noreferrer\">multi-dimensional arrays</a> and <a href=\"https://www.tutorialspoint.com/cprogramming/c_array_of_pointers.htm\" rel=\"nofollow noreferrer\">arrays of pointers</a>. The site is an excellent resource for anyone trying to learn the C programming language!</p>\n\n<p>I hope that helped you understand the segmentation fault better! Feel free to ask for any clarifications!</p>\n"}], "owner": {"reputation": 1887, "user_id": 2980012, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/84d7a206a8894a7280d94314d1201b58?s=128&d=identicon&r=PG&f=1", "display_name": "Coder77", "link": "https://stackoverflow.com/users/2980012/coder77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 53412340, "answer_count": 4, "score": 1, "last_activity_date": 1571094192, "creation_date": 1542803191, "question_id": 53412012, "link": "https://stackoverflow.com/questions/53412012/assigning-character-in-array-of-strings-segmentation-fault-in-c", "title": "Assigning character in array of strings segmentation fault in C", "body": "<p>Very confused on why I'm getting a \"Segmentation Fault (core dumped)\". </p>\n\n<pre><code>const int bufSize = 32;\nchar* splitStrings[bufSize];\nsplitStrings[0][0] = 'a';\nsplitStrings[0][1] = '\\0';\nprintf(\"testchar: %c\",splitStrings[0][0]);\nprintf(\"teststr: %s\",splitStrings[0]);\n</code></pre>\n\n<p>Thanks for any help</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1542803112, "post_id": 53411944, "comment_id": 93698641, "body": "Welcome to Stackoverflow! I think you should try again creating a minimal and complete example of your code, since now the reader has to try to read your code. It seems that also some code has been cut off, I guess..."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1542804629, "post_id": 53411944, "comment_id": 93699472, "body": "Another good example why typedef&#39;ing pointers isn&#39;t a very good idea."}], "answers": [{"tags": [], "owner": {"reputation": 2842, "user_id": 648741, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/47813cc59b0edb414b88601f1defe02a?s=128&d=identicon&r=PG", "display_name": "jochen", "link": "https://stackoverflow.com/users/648741/jochen"}, "is_accepted": false, "score": 0, "last_activity_date": 1542803232, "creation_date": 1542803232, "answer_id": 53412034, "question_id": 53411944, "link": "https://stackoverflow.com/questions/53411944/pointers-in-c-is-a-pointer-did-you-mean-to-use/53412034#53412034", "title": "pointers in c- &quot; is a pointer; did you mean to use &#39;-&gt;&#39;?&quot;", "body": "<p>You have one level of pointers too many: <code>pTerritory</code> is defined to be a pointer to <code>struct Territory</code>, and in <code>struct Country</code> you make <code>countryTerr</code> a pointer to <code>pTerritory</code>.  This gives you a pointer to a pointer, where you want a pointer to a struct.  Solution: change <code>countryTerr</code> to be of type <code>pTerritory</code> (instead of <code>pTerritory *</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 0, "last_activity_date": 1542803460, "creation_date": 1542803460, "answer_id": 53412095, "question_id": 53411944, "link": "https://stackoverflow.com/questions/53411944/pointers-in-c-is-a-pointer-did-you-mean-to-use/53412095#53412095", "title": "pointers in c- &quot; is a pointer; did you mean to use &#39;-&gt;&#39;?&quot;", "body": "<p>Member <code>pTerritory *countryTerr</code> is actually of type <code>struct Territory **</code> (note that <code>pTerritory</code> is already a pointer type, and you add an additional <code>*</code> then with <code>*countryTerr</code>.</p>\n\n<p>Write</p>\n\n<pre><code>struct Country{\n   char *name;\n   pCity *cities;\n   int numCities;\n   pTerritory countryTerr;\n};    \n</code></pre>\n\n<p>and your statement <code>country_pointer-&gt;countryTerr-&gt;x1 = 25</code> should compile (and work) as intended.</p>\n\n<p>Anyway, to avoid such pitfalls due to such \"explicit pointer types\", the <code>*</code>-notation together with plain types it is commonly understood and - in my opinion - more straight and easier to read:</p>\n\n<pre><code>typedef struct Territory{\n int x1;\n int x2;\n int y1;\n int y2;\n} Territory;\n\ntypedef struct Country{\n   char *name;\n   pCity *cities;\n   int numCities;\n   Territory *countryTerr;\n} Country;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9539860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d18668c7c3ac5895460e3681788808e?s=128&d=identicon&r=PG&f=1", "display_name": "use", "link": "https://stackoverflow.com/users/9539860/use"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3045, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1542803460, "creation_date": 1542802985, "question_id": 53411944, "link": "https://stackoverflow.com/questions/53411944/pointers-in-c-is-a-pointer-did-you-mean-to-use", "title": "pointers in c- &quot; is a pointer; did you mean to use &#39;-&gt;&#39;?&quot;", "body": "<p>Im trying to assign new value to afield in a nested structures using pointer,\nbut I keep getting the compile error in the title,\nhere is my code:</p>\n\n<pre><code>    struct Territory{\nint x1;\nint x2;\nint y1;\nint y2;\n};\n\nstruct Country{\n   char *name;\n   pCity *cities;\n   int numCities;\n   pTerritory *countryTerr;\n\n};\ntypedef struct Territory* pTerritory;\ntypedef struct Country* pCountry;`struct Territory \nter_for_country;\nstruct Country new_country;\npCountry country_pointer;\ncountry_pointer = &amp;new_country;\n\nter_for_country.x1 = 3;\nter_for_country.x2 = 3;\nter_for_country.y1 = 3;\nter_for_country.y2 = 3;\n\nnew_country.numCities=2;\nnew_country.countryTerr = &amp;ter_for_country;\n</code></pre>\n\n<p>now suppose I want to change \"x1\" of new_country using the pointer \"country_pointer\", how would I do that?\nI tried :</p>\n\n<pre><code>country_pointer-&gt;countryTerr-&gt;x1 = 25;\n</code></pre>\n\n<p>but I get errors, can you help?\nthanks</p>\n"}, {"tags": ["c", "assembly", "language-lawyer", "inline-assembly"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1542801418, "post_id": 53411524, "comment_id": 93697804, "body": "That&#39;s the great thing about standards: there are so many to choose from."}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1542801697, "post_id": 53411524, "comment_id": 93697947, "body": "also valid: __asm__()"}, {"owner": {"reputation": 89, "user_id": 10670381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1671ea40f35c1f102d000eb3c8c5bff?s=128&d=identicon&r=PG&f=1", "display_name": "bright yang", "link": "https://stackoverflow.com/users/10670381/bright-yang"}, "reply_to_user": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1542801892, "post_id": 53411524, "comment_id": 93698047, "body": "@Mike I know that, but I just want to know what differs"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1542802007, "post_id": 53411524, "comment_id": 93698101, "body": "The first kind is MSVC style inline assembly while the second one is gcc style inline assembly.  Entirely different approaches, the second one is usually superior for the situations where you&#39;d use inline assembly in production code today."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1542802177, "post_id": 53411524, "comment_id": 93698191, "body": "I&#39;ve tagged lawyer to increase the possibility of someone submitting an answer superior to mine."}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1542802189, "post_id": 53411524, "comment_id": 93698197, "body": "the behavior is the same, It depends on your compiler which one is accepted"}, {"owner": {"reputation": 119716, "user_id": 643383, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/uQ5JF.png?s=128&g=1", "display_name": "Caleb", "link": "https://stackoverflow.com/users/643383/caleb"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1542802508, "post_id": 53411524, "comment_id": 93698351, "body": "@fuz You should make that an answer and maybe explain <i>why</i> one is superior."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 119716, "user_id": 643383, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/uQ5JF.png?s=128&g=1", "display_name": "Caleb", "link": "https://stackoverflow.com/users/643383/caleb"}, "edited": false, "score": 0, "creation_date": 1542802721, "post_id": 53411524, "comment_id": 93698449, "body": "@Caleb If one compiler gives you apples and another gives you oranges, while what the OP wanted was bananas (standardization), then writing an answer about why apples are better than oranges doesn&#39;t seem meaningful."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1542804367, "post_id": 53411524, "comment_id": 93699333, "body": "@Lundin if one compiler gives you hammer, and other gives you toolbox (including hammer), then the other is superior. (which is basically the analogy to MSCC inline asm vs gcc/clang inline asm) ... also you basically shouldn&#39;t use either, unless you really know what you are doing: <a href=\"https://gcc.gnu.org/wiki/DontUseInlineAsm\" rel=\"nofollow noreferrer\">gcc.gnu.org/wiki/DontUseInlineAsm</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 1, "creation_date": 1542805369, "post_id": 53411524, "comment_id": 93699873, "body": "@Ped7g These aren&#39;t the only forms, as there&#39;s more to programming than your PC. There&#39;s also hammers with wooden shafts, hammers with metal shaft, hammers with metal shaft + rubber for handle, hammers that can remove nails etc etc. Now, what I would like is a standardized saw. Which one of these hammer types is best for sawing?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 119716, "user_id": 643383, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/uQ5JF.png?s=128&g=1", "display_name": "Caleb", "link": "https://stackoverflow.com/users/643383/caleb"}, "edited": false, "score": 1, "creation_date": 1542822285, "post_id": 53411524, "comment_id": 93709846, "body": "@Caleb I don&#39;t quite feel like making an answer right now, but gcc-style syntax is superior because it allows the programmer to specify a lot of metadata the compiler can use for optimisations.  Also, gcc-style syntax allows the compiler to place variables in registers which isn&#39;t possible with MSVC-style assemble.  While the latter might be a bit more user-friendly, it is pretty much obsolete with today&#39;s reasons why people write inline assembly at all."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1542826840, "post_id": 53411524, "comment_id": 93711903, "body": "@fuz : although more flexible (and superior), GCC&#39;s extended inline assembly comes at a cost - very easy to get things wrong (less forgiving) and introduce often hard to track bugs into the code. It should be used sparingly. If there is an intrinsic then use it. If one doesn&#39;t fully understand the nuances of GCC&#39;s extended inline it may be better to put the code in a separate assembly module. The latter may be less optimal, but it may be safer."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1542802378, "post_id": 53411728, "comment_id": 93698286, "body": "C does&#39;t support <code>asm</code>. Annex J is not normative and it only gives an example of the most common form of non-standard extensions - the same one as standardized by C++."}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 1, "creation_date": 1542802758, "post_id": 53411728, "comment_id": 93698465, "body": "J.5.10 says &quot;The most common implementation is via a statement of the form asm(...)&quot; How do you read it to say that it must be of this form, or that any other form isn&#39;t standard?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 1, "creation_date": 1542802868, "post_id": 53411728, "comment_id": 93698517, "body": "@PaulHankin The key is C11 p554: &quot;Annex J (informative)&quot;. Nothing in that annex contains language requirements, it is just extra information."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 0, "last_activity_date": 1542803037, "last_edit_date": 1542803037, "creation_date": 1542802108, "answer_id": 53411728, "question_id": 53411524, "link": "https://stackoverflow.com/questions/53411524/two-forms-of-inline-assembly/53411728#53411728", "title": "Two forms of inline-assembly", "body": "<p>Annex J of the C standard is informative and states that if <code>asm</code> is supported (and it doesn't have to be), then it ought to be of the form</p>\n\n<pre><code>asm ( character-string-literal );\n</code></pre>\n\n<p>In other words, the notation using the braces is arguably less conventional than the one using the parentheses.</p>\n\n<p>(The requirements in C++ are stronger.)</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 3, "last_activity_date": 1542802339, "creation_date": 1542802339, "answer_id": 53411790, "question_id": 53411524, "link": "https://stackoverflow.com/questions/53411524/two-forms-of-inline-assembly/53411790#53411790", "title": "Two forms of inline-assembly", "body": "<p>The C language does not support inline assembler, so either form is non-standard. Every compiler tends to do this differently and therefore the syntax will vary.</p>\n\n<p>Some compilers use double underscore <code>__</code> to let through all non-standard keywords even when compiling in C standard mode.</p>\n\n<p>Unlike C, C++ does support it through standardization, in the form of <code>asm(\"instruction\");</code>.</p>\n"}], "owner": {"reputation": 89, "user_id": 10670381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1671ea40f35c1f102d000eb3c8c5bff?s=128&d=identicon&r=PG&f=1", "display_name": "bright yang", "link": "https://stackoverflow.com/users/10670381/bright-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "closed_date": 1542820226, "answer_count": 2, "score": 4, "last_activity_date": 1542803037, "creation_date": 1542801347, "last_edit_date": 1542802142, "question_id": 53411524, "link": "https://stackoverflow.com/questions/53411524/two-forms-of-inline-assembly", "closed_reason": "Duplicate", "title": "Two forms of inline-assembly", "body": "<p>There are two forms of inline assembly, one is</p>\n\n<pre><code>asm{\n    //...\n}\n</code></pre>\n\n<p>the other</p>\n\n<pre><code>asm(\n    \"...\"//work in my clang compiler\n);\n</code></pre>\n\n<p>and __asm and so on, so what is the difference?\ndefinitely not just about curly braces and brackets, i hope</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1542800963, "post_id": 53411368, "comment_id": 93697564, "body": "Sort the array (in place if it&#39;s okay to modify it) and it&#39;s easy to find duplicates and remove them."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1542801058, "post_id": 53411368, "comment_id": 93697612, "body": "Code seems to be working as designed - there are 6 different numbers in your array"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1542801164, "post_id": 53411368, "comment_id": 93697671, "body": "As for your problem, I recommend that you <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>."}, {"owner": {"reputation": 113, "user_id": 10667418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9193164bcd1a4e456ddd5c29123db8ff?s=128&d=identicon&r=PG&f=1", "display_name": "Syed Ausaf Hussain", "link": "https://stackoverflow.com/users/10667418/syed-ausaf-hussain"}, "edited": false, "score": 0, "creation_date": 1543661915, "post_id": 53411368, "comment_id": 94004905, "body": "is your problem solve?"}], "answers": [{"comments": [{"owner": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "edited": false, "score": 1, "creation_date": 1542801730, "post_id": 53411490, "comment_id": 93697961, "body": "If you use an array as counter then it would be <code>O(max_element)</code>. Probably an hash map would be a better choice if the values of the array are not themselves <code>O(n)</code>"}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 4, "last_activity_date": 1542801233, "creation_date": 1542801233, "answer_id": 53411490, "question_id": 53411368, "link": "https://stackoverflow.com/questions/53411368/different-unique-elements-in-array/53411490#53411490", "title": "different unique elements in array", "body": "<p>You need to check the entire array (currently your inner loop goes only up to <code>i</code>).</p>\n\n<pre><code>    for (int j = 0; is_u &amp;&amp; j &lt; n; ++j)\n    {\n         /* i != j to avoid comparing an element with itself. */\n         if (i != j &amp;&amp; arr[j] == arr[i]) is_u = 0;\n    }\n</code></pre>\n\n<p>Yours is obviously an O(n*n) algorithm. You could sort and check consequent elements to do the same in O(n log n).</p>\n\n<p>If you could use additional O(n) memory to use an auxiliary array to as a \"counter\", then it could be done in O(n) time complexity as well.</p>\n"}, {"tags": [], "owner": {"reputation": 113, "user_id": 10667418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9193164bcd1a4e456ddd5c29123db8ff?s=128&d=identicon&r=PG&f=1", "display_name": "Syed Ausaf Hussain", "link": "https://stackoverflow.com/users/10667418/syed-ausaf-hussain"}, "is_accepted": false, "score": 1, "last_activity_date": 1542811162, "last_edit_date": 1542811162, "creation_date": 1542802556, "answer_id": 53411842, "question_id": 53411368, "link": "https://stackoverflow.com/questions/53411368/different-unique-elements-in-array/53411842#53411842", "title": "different unique elements in array", "body": "<p>This code give you the unique number's count from the Array</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nint unique(int *arr, int n)\n{\n     int u = 0;\n\n     for (int i = 0; i &lt; n; i++)\n     {\n        int is_u = 1;\n        for (int j = 0; j &lt; n; j++)\n        {\n            //printf(\"%d,%d\\n\", arr[i], arr[j]);\n             if (arr[i] == arr[j] &amp;&amp; i != j){ \n                 //printf(\"match %d\\n\", arr[i]);\n                 is_u = 0; break;\n             }\n        }\n        if (is_u) ++u;\n\n        //printf(\"u %u \\n\",u);\n     }\n     return u;\n}\n\n\nint main(void) {\n    int arr[] = { 2, 7, 5, 8, 9, 5, 7, 5, 5, 3};\n    int n = sizeof(arr) / sizeof(arr[0]);\n    printf(\"%d\", unique(arr, n));\n    return 0;\n}\n</code></pre>\n\n<p>Two nested for loop using in this code, \nthe first for loop hold an array index. second for loop compare that index value to all array value if the same value not found in the array (except the same index) then increment in 'u'.</p>\n"}, {"tags": [], "owner": {"reputation": 1118, "user_id": 2191849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fOaLe.jpg?s=128&g=1", "display_name": "static_cast", "link": "https://stackoverflow.com/users/2191849/static-cast"}, "is_accepted": false, "score": 1, "last_activity_date": 1542810346, "creation_date": 1542810346, "answer_id": 53414229, "question_id": 53411368, "link": "https://stackoverflow.com/questions/53411368/different-unique-elements-in-array/53414229#53414229", "title": "different unique elements in array", "body": "<ul>\n<li><code>u</code> should not be initialized to 1. You don't know if there are duplicates yet.</li>\n</ul>\n\n<p>This line</p>\n\n<pre><code>int u = 1;\n</code></pre>\n\n<p>Should be</p>\n\n<pre><code>int u = 0;\n</code></pre>\n\n<hr>\n\n<ul>\n<li>Array's are 0 based. </li>\n</ul>\n\n<p>This line</p>\n\n<pre><code>for (int i = 1; i &lt; n; ++i)\n</code></pre>\n\n<p>Should be</p>\n\n<pre><code>for (int i = 0; i &lt; n; ++i) // NOTE i = 0 vs i = 1\n</code></pre>\n\n<hr>\n\n<ul>\n<li>Don't limit to i. You want to scan the entire array to find a duplicate </li>\n</ul>\n\n<p>This line</p>\n\n<pre><code>for (int j = 0; is_u &amp;&amp; j &lt; i; ++j)\n</code></pre>\n\n<p>Should be</p>\n\n<pre><code>for (int j = 0; is_u &amp;&amp; j &lt; n; ++j) // NOTE j &lt; n vs j &lt; i\n</code></pre>\n\n<hr>\n\n<ul>\n<li>You need to ignore the current index when doing the secondary scan. Otherwise all elements would be considered duplicates.</li>\n</ul>\n\n<p>This line</p>\n\n<pre><code>if (arr[j] == arr[i]) is_u = 0;\n</code></pre>\n\n<p>Should be</p>\n\n<pre><code>if (j != i &amp;&amp; arr[j] == arr[i]) is_u = 0; // NOTE added condition of j != i\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 10566392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ad1aa236f6d16c7a16df443ee3cc2c9?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/10566392/emil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 53411490, "answer_count": 3, "score": 2, "last_activity_date": 1542811162, "creation_date": 1542800826, "question_id": 53411368, "link": "https://stackoverflow.com/questions/53411368/different-unique-elements-in-array", "title": "different unique elements in array", "body": "<p>I try to write code for counting number of different unique elements in the given array but I get undesired output.<code>{ 2, 7, 5, 8, 9, 5, 7, 5, 5, 3}</code>this is the given array elements.Different unique values are <code>{ 2, 8, 9, 3}</code> it means there are 4. But my program returns 6: { 2, 5, 8, 9, 7, 3}</p>\n\n<p>here is my code:</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;stdlib.h&gt;\n\n\nint unique(int *arr, int n)\n{\n     int u = 1;\n\n     for (int i = 1; i &lt; n; ++i)\n     {\n        int is_u = 1;\n        for (int j = 0; is_u &amp;&amp; j &lt; i; ++j)\n        {\n             if (arr[j] == arr[i]) is_u = 0;\n        }\n        if (is_u) ++u;\n     }\n     return u;\n}\n\n\nint main(void) {\n    int arr[] = { 2, 7, 5, 8, 9, 5, 7, 5, 5, 3};\n    int n = sizeof(arr) / sizeof(arr[0]);\n    printf(\"%d\", unique(arr, n));\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "function-call"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1542799657, "post_id": 53410977, "comment_id": 93696834, "body": "The message you get is a compilation error. You cannot run your code as it does not even compile. That set of code snippets is not a complete example or don&#39;t you use headers? See <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> for details."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1542799700, "post_id": 53410977, "comment_id": 93696858, "body": "Just guessing as too many details are missing: You might try to compile <code>main</code> without providing a prototype for that function."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1542800303, "post_id": 53410977, "comment_id": 93697196, "body": "You don&#39;t declare the array <code>grades</code> in your code too"}], "answers": [{"tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 2, "last_activity_date": 1542799945, "creation_date": 1542799945, "answer_id": 53411181, "question_id": 53410977, "link": "https://stackoverflow.com/questions/53410977/c-code-error-not-a-function-or-function-pointer/53411181#53411181", "title": "C code Error not a function or function pointer", "body": "<p>There seem to be a couple of problems. I think the error message you get is weird, it should instead say that <code>countPassed</code> is not defined. That's because you define it after you call it. You can fix it by adding a prototype for the function before you call it. This way you tell the compiler about the existence of a function (without defining the function yet) and it will compile. For me, it worked by adding the following prototypes to your code before the main:</p>\n\n<pre><code>int countPassed(int amount);\nvoid printAll(int amount);\nvoid printAverage(int amount);\nvoid storesGrades(int amount);\n</code></pre>\n\n<p>Alternatively, you could just put the <code>main</code> function after all the other functions. Of course, that's not always going to be an option in real projects.</p>\n\n<p>Furthermore, there's no definition for <code>grades</code>. I assume you want an array of <code>int</code>, so adding something like <code>int grades[10]</code> should do the trick (in this example that would work with a maximum of 10 grades, it's also possibly to dynamically allocate that memory to allow whatever amount the user wants).</p>\n\n<p>Also, I had to add <code>#include \"stdio.h\"</code> to make it compile with the <code>printf</code>, although some compilers won't mind if it's missing. </p>\n"}, {"tags": [], "owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "is_accepted": false, "score": 2, "last_activity_date": 1542800798, "creation_date": 1542800798, "answer_id": 53411357, "question_id": 53410977, "link": "https://stackoverflow.com/questions/53410977/c-code-error-not-a-function-or-function-pointer/53411357#53411357", "title": "C code Error not a function or function pointer", "body": "<p>Since the first time you use the function <code>countPassed</code> is here:</p>\n\n<pre><code>countWhoPassed = countPassed(amount);\n</code></pre>\n\n<p>And the function is being defined much later, the compiler can't know yet how to treat a function like that. So since no prototype is declared yet, the compiler doesn't know that <code>countPassed()</code> returns an int. So without that information, the compiler assumes, </p>\n\n<pre><code>countWhoPassed = countPassed(amount);\n</code></pre>\n\n<p>is trying to assign the function pointer of <code>countPassed(int)</code> to the variable <code>countWhoPassed</code>. But then it figures that it also doesn't know such function.</p>\n\n<p>But how should the compiler know it better, not having seen this functions prototype yet?</p>\n\n<p>So make the compiler aware of how that function should look like before its first occurrence.</p>\n\n<p>So simply put </p>\n\n<pre><code>int countPassed(int amount);\n</code></pre>\n\n<p>in the declaration and include area so the compiler knows from there on how to treat that identifier.</p>\n\n<p>Or as an advanced option, declare it in a header file and include that one.</p>\n\n<p>Disclaimer: I haven't run the code nor checked it for other errors. I just answered that specific error you asked about.</p>\n"}], "owner": {"reputation": 11, "user_id": 9309998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f92628a6aa7e1c811f5495095638f2e?s=128&d=identicon&r=PG&f=1", "display_name": "jjj", "link": "https://stackoverflow.com/users/9309998/jjj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1568984384, "creation_date": 1542799098, "last_edit_date": 1568984384, "question_id": 53410977, "link": "https://stackoverflow.com/questions/53410977/c-code-error-not-a-function-or-function-pointer", "title": "C code Error not a function or function pointer", "body": "<p>I have the following C code. When i try to compile it, i get an error message:</p>\n\n<pre><code>called object 'countPassed' is not a function or function pointer\"\n</code></pre>\n\n<p>How may I fix this?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int countWhoPassed, averageCalculate, printPassed;\n    int amount = howManygrades();\n    storesGrades(amount);\n    printAll(amount);\n    averageCalculate = averageCalc(amount);\n    printAverage(amount);\n    countWhoPassed = countPassed(amount);\n    printPassed = printWhoPassed(amount);\n    return 0;\n}\n\nint howManygrades()\n{\n    int gradesAmount;\n    printf(\"How many grades do you want?\\n\");\n    scanf(\"%d\", &amp;gradesAmount);\n    while (gradesAmount &gt; 10) {\n        printf(\"Sorry, this amount of numbers is too big for the array.\");\n        scanf(\"%d\", &amp;gradesAmount);\n        while (gradesAmount &lt; 0) {\n            printf(\"Sorry, this amount of numbers is too small for the array.\");\n            scanf(\"%d\", &amp;gradesAmount);\n        }\n    }\n    while (gradesAmount &lt; 0) {\n        printf(\"Sorry, this amount of numbers is too small for the array.\");\n        scanf(\"%d\", &amp;gradesAmount);\n        while (gradesAmount &gt; 10) {\n            printf(\"Sorry, this amount of numbers is too big for the array.\");\n            scanf(\"%d\", &amp;gradesAmount);\n        }\n    }\n\n    return gradesAmount;\n}\n\nvoid storesGrades(int amount)\n{\n    int iterator;\n    float grade;\n    for (iterator = 0; iterator &lt; amount; iterator++)\n    {\n\n        printf (\"Enter another grade.\");\n        scanf(\"%f\", &amp;grade);\n        while ((grade &lt;= 0.0) || (grade &gt; 10.0))\n        {\n            printf(\"Sorry, this number is not valid.\");\n            scanf(\"%f\", &amp;grade);\n        }\n        grades[iterator] = grade;\n    }\n}\n\nvoid printAll(int amount)\n{\n    int iterator;\n    for (iterator = 0; iterator &lt; amount; iterator++)\n    {\n        printf(\"%.1f\\n\", grades[iterator]);\n    }\n}\n\nint averageCalc(int amount)\n{\n    float sum, averageResult, average;\n    int iterator;\n    sum = 0.0;\n    for (iterator = 0; iterator &lt; amount; iterator++) {\n        sum += grades[iterator];\n    }\n    average = sum / (float)amount;\n    return average;\n}\n\nvoid printAverage(int amount)\n{\n    float printThisAverage = averageCalc(amount);\n    printf(\"%.2f\", printThisAverage);\n}\n\nint countPassed(int amount)\n{\n    int iterator, countPassing;\n    countPassing = 0;\n    for (iterator = 0; iterator &lt; amount; iterator++)\n    {\n        if (grades[iterator] &gt;= 5.5)\n        {\n            countPassing++;\n        }\n    }\n    return countPassing;\n}\n\nint printWhoPassed(int amount)\n{\n    int returnValue = countPassed(amount);\n    return returnValue;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "xml", "libxml2", "xml-libxml"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1542801897, "post_id": 53410723, "comment_id": 93698048, "body": "See the <a href=\"http://www.xmlsoft.org/examples/index.html#reader3.c\" rel=\"nofollow noreferrer\">xmlsoft.org/examples/index.html#reader3.c</a> example."}, {"owner": {"reputation": 365, "user_id": 2294991, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/beda6ed4a3aba7b355f3b4cbfa76b078?s=128&d=identicon&r=PG", "display_name": "Rama P", "link": "https://stackoverflow.com/users/2294991/rama-p"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1542807921, "post_id": 53410723, "comment_id": 93701360, "body": "Thanks, I checked this example, but in my case I need to filter out a subtree like:  &lt;root&gt;&lt;child&gt;&lt;data&gt;&lt;/child&gt;&lt;child1&gt;data&lt;/child1&gt;&lt;/root&gt; if this is the XML I should be able to filter out with subtree: &lt;root&gt;&lt;child1&gt;data&lt;/child1&gt; should match the XML and produce the output if exists."}], "owner": {"reputation": 365, "user_id": 2294991, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/beda6ed4a3aba7b355f3b4cbfa76b078?s=128&d=identicon&r=PG", "display_name": "Rama P", "link": "https://stackoverflow.com/users/2294991/rama-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1542798207, "creation_date": 1542798207, "question_id": 53410723, "link": "https://stackoverflow.com/questions/53410723/filtering-a-subtree-from-an-xml", "title": "Filtering a subtree from an XML", "body": "<p>There is an API xmlTextReaderPreservePattern() to filter all nodes matched by pattern (say \"test\"). Is there a way to filter a sub-tree from XML?</p>\n"}, {"tags": ["c", "openmp", "convex-hull"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 3, "creation_date": 1542797986, "post_id": 53410585, "comment_id": 93695966, "body": "For small data sets parallelization may be slower. The cause is the overhead in creating and managing the threads."}, {"owner": {"reputation": 484, "user_id": 7758765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c6963ac41170217e28cf1b41358a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Welgriv", "link": "https://stackoverflow.com/users/7758765/welgriv"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1542798489, "post_id": 53410585, "comment_id": 93696231, "body": "I suggest to try out another algorithm that you know is highly &quot;parallelizable&quot; or enlarge the dataset as suggest by @Osiris"}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1542812284, "post_id": 53412396, "comment_id": 93703988, "body": "Since variable <code>n</code> is not modified, I see no reason why it should be shared.  Making it private may afford lighter-weight accesses by the various participating threads."}, {"owner": {"reputation": 1480, "user_id": 10450594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae4c6a0ca94b3094b25f18e66d8368ff?s=128&d=identicon&r=PG&f=1", "display_name": "Brice", "link": "https://stackoverflow.com/users/10450594/brice"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1542822351, "post_id": 53412396, "comment_id": 93709884, "body": "Then it has to be tagged as <code>firstprivate(n)</code> so that the private copy within each thread is initialized with the value of the pre-existing variable. I do not think it will have much impact, though (with a static schedule, the master thread will access its value once then distribute the work among the threads which will then loop based on their own internal, private variables)."}, {"owner": {"reputation": 31, "user_id": 8967861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05efaf9503019b169f8ab67edd883e76?s=128&d=identicon&r=PG&f=1", "display_name": "Yeoh FS", "link": "https://stackoverflow.com/users/8967861/yeoh-fs"}, "edited": false, "score": 0, "creation_date": 1543142338, "post_id": 53412396, "comment_id": 93803993, "body": "Tried to make the input subtantial enough by adding in these lines of code:      Point points[3000];   \t \tint i; \tfor(i=0;i&lt;3000;i++)     {     \tpoints[i].x = rand()%100;     \tpoints[i].y = rand()%100;     \t     \tint j;     \tfor(j=i+1;j&lt;3000;j++)     \t{     \t\tif(points[i].x==points[j].x)     \t\t{     \t\t\tif(points[i].y==points[j].y)     \t\t\t{      \t\t\t\ti--;     \t\t\t\tbreak;\t \t\t\t\t} \t\t\t} \t\t} \t}  But it crashes sometimes"}], "tags": [], "owner": {"reputation": 1480, "user_id": 10450594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae4c6a0ca94b3094b25f18e66d8368ff?s=128&d=identicon&r=PG&f=1", "display_name": "Brice", "link": "https://stackoverflow.com/users/10450594/brice"}, "is_accepted": false, "score": 3, "last_activity_date": 1542880057, "last_edit_date": 1542880057, "creation_date": 1542804545, "answer_id": 53412396, "question_id": 53410585, "link": "https://stackoverflow.com/questions/53410585/openmp-c-program-run-slower-than-sequential-code/53412396#53412396", "title": "OpenMP C program run slower than sequential code", "body": "<p>In the following piece of your code, the whole content of the parallel <code>for</code> loop is wrapped into a <code>critical</code> statement. This means that this part of the code will never be entered by more than on thread at a time. Having multiple threads work one at a time will not go faster than if a single thread had gone through all iterations. But on top of that some time is lost in synchronization overhead (each thread must acquire a mutex before entering the critical section and release it afterwards).</p>\n\n<pre><code>int l = 0,i;\n#pragma omp parallel shared (n,l) private (i)\n{\n    #pragma omp for\n    for (i = 1; i &lt; n; i++)\n    {\n        #pragma omp critical\n        {\n            if (points[i].x &lt; points[l].x)\n            l = i;\n        }\n    }\n}\n</code></pre>\n\n<p>The serial code needs to be somewhat refactored for parallelization. Reduction is often a  good approach for simple operations: have each thread compute a partial result on one part of the iterations (e.g. partial minimum, partial sum) than merge all the results into a global one. For supported operations, the <code>#pragma omp for reduction(op:var)</code> syntax can be used. But in this case, the reduction has to be done manually.</p>\n\n<p>See how the following code relies on local variables to track the index of minimum <code>x</code>, then uses a single critical section to compute the global minimum index.</p>\n\n<pre><code>int l = 0,i;\n#pragma omp parallel shared (n,l) private (i)\n{\n    int l_local = 0; //This variable is private to the thread\n\n    #pragma omp for nowait\n    for (i = 1; i &lt; n; i++)\n    {\n        // This part of the code can be executed in parallel\n        // since all write operations are on thread-local variables\n        if (points[i].x &lt; points[l_local].x)\n            l_local = i;\n    }\n\n    // The critical section is entered only once by each thread\n    #pragma omp critical\n    {\n    if (points[l_local].x &lt; points[l].x)\n        l = l_local;\n    }\n\n    #pragma omp barrier\n    // a barrier is needed in case some more code follow\n    // otherwise there is an implicit barrier at the end of the parallel region\n}\n</code></pre>\n\n<p>The same principle should be applied to the second parallel loop, which suffer from the same issue of actually being entirely serialized by the <code>critical</code> statement.</p>\n"}], "owner": {"reputation": 31, "user_id": 8967861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05efaf9503019b169f8ab67edd883e76?s=128&d=identicon&r=PG&f=1", "display_name": "Yeoh FS", "link": "https://stackoverflow.com/users/8967861/yeoh-fs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1543235140, "creation_date": 1542797753, "last_edit_date": 1543235140, "question_id": 53410585, "link": "https://stackoverflow.com/questions/53410585/openmp-c-program-run-slower-than-sequential-code", "title": "OpenMP C program run slower than sequential code", "body": "<p>I am a newbie to OpenMP, trying to parallelize Jarvis's algorithm. However it turns out that the parallel program take 2-3 times longer compare to sequential code. </p>\n\n<p>Is it that the problem itself cannot be parallelize? Or there is something wrong in how i parallelize it.</p>\n\n<p>This is my openMP program for the problem, with 2 parts being parallelize:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;omp.h&gt;\n\ntypedef struct Point\n{\nint x, y;\n} Point;\n\n// To find orientation of ordered triplet (p, q, r).\n// The function returns\n// 0 for colinear points\n// 1 as Clockwise\n// 2 as Counterclockwise\nint orientation(Point p, Point i, Point q)\n{\nint val = (i.y - p.y) * (q.x - i.x) -\n          (i.x - p.x) * (q.y - i.y);\nif (val == 0) return 0;  // colinear\nreturn (val &gt; 0)? 1: 2; // clock or counterclock wise\n}\n\n// Prints convex hull of a set of n points.\nvoid convexHull(Point points[], int n)\n{\n// There must be at least 3 points\nif (n &lt; 3) return;\n\n// Initialize array to store results\nPoint results[n];\nint count = 0;\n\n// Find the leftmost point\nint l = 0,i;\n\n#pragma omg parallel shared (n,l) private (i)\n{\n    #pragma omp for\n    for (i = 1; i &lt; n; i++)\n    {\n        #pragma omp critical\n        {\n            if (points[i].x &lt; points[l].x)\n            l = i;\n        }\n    }\n\n}\n\n// Start from leftmost point, keep moving counterclockwise\n// until reach the start point again.\nint p = l, q;\ndo\n{\n    // Add current point to result\n    results[count]= points[p];\n    count++;\n\n    q = (p+1)%n;\n    int k;\n\n    #pragma omp parallel shared (p) private (k)\n    {\n        #pragma omp for \n        for (k = 0; k &lt; n; k++)\n        {\n           // If i is more counterclockwise than current q, then\n           // update i as new q\n           #pragma omp critical\n           {\n            if (orientation(points[p], points[k], points[q]) == 2)\n               q = k;\n           }\n        }       \n\n    }\n\n    // Now q is the most counterclockwise with respect to p\n    // Set p as q for next iteration, to add q to result\n    p = q;\n\n\n} while (p != l);  // While algorithm does not return to first point\n\n// Print Result\nint j;\nfor (j = 0; j &lt; count; j++){\n  printf(\"(%d,%d)\\n\", results[j].x,results[j].y);\n}\n\n}\n\nint main()\n{\n//declaration for start time, end time\n//and total executions for the algorithm\nstruct timeval start, end;\nint i, num_run = 100;\n\ngettimeofday(&amp;start,NULL);\n\nPoint points[] = {{0, 3}, {2, 2}, {1, 1}, {2, 1},\n                    {3, 0}, {0, 0}, {3, 3}};\n\nint n = sizeof(points)/sizeof(points[0]);\n\nconvexHull(points, n);\n\ngettimeofday(&amp;end,NULL);\n\nint cpu_time_used = (((end.tv_sec - start.tv_sec) * 1000000) + (end.tv_usec \n- start.tv_usec));\nprintf(\"\\n\\nExecution time: %d ms\\n\", cpu_time_used);\nreturn 0;\n}\n</code></pre>\n\n<hr>\n\n<p>Tried to make the input subtantial enough by adding in these lines of code:</p>\n\n<pre><code>Point points[3000];\nint i;\nfor(i=0;i&lt;3000;i++) {\n    points[i].x = rand()%100;\n    points[i].y = rand()%100;\n    int j;\n    for(j=i+1;j&lt;3000;j++) {\n        if(points[i].x==points[j].x) {\n            if(points[i].y==points[j].y) {\n            i--; \n            break;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>But it crashes sometimes</p>\n"}, {"tags": ["c", "loops"], "comments": [{"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 0, "creation_date": 1542797868, "post_id": 53410581, "comment_id": 93695891, "body": "if you expect your loop to return to the <code>printf(&quot;Enter a number: \\n&quot;)</code>-part, please note that this part is outside of the loop. What do you actually observe and what do you expect?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1542797869, "post_id": 53410581, "comment_id": 93695892, "body": "If you want to skip leading white-space before a character, use a format string with a space. As in <code>&quot; %c&quot;</code>. Also note that with your loop condition, anything but a lower-case <code>&#39;n&#39;</code> would continue the loop, not only <code>&#39;y&#39;</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1542798036, "post_id": 53410581, "comment_id": 93696004, "body": "And this is also a very good time to <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>. Step through the code line by line in a debugger, checking the values of all variables (and save the result from <code>getchar</code> in a dummy variable so you can check that too)."}, {"owner": {"reputation": 484, "user_id": 7758765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c6963ac41170217e28cf1b41358a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Welgriv", "link": "https://stackoverflow.com/users/7758765/welgriv"}, "edited": false, "score": 0, "creation_date": 1542798285, "post_id": 53410581, "comment_id": 93696125, "body": "I just tested your code and it has the expected behaviour if you like to stop when you write &#39;n&#39; and continue when you write &#39;y&#39; so I don&#39;t see your problem"}], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1542800742, "post_id": 53411268, "comment_id": 93697435, "body": "In the first iteration that will read the newline left over from the first call to <code>scanf</code>."}], "tags": [], "owner": {"reputation": 109, "user_id": 10631220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a58ddcd0e5bb6d60b488327f2addf6?s=128&d=identicon&r=PG&f=1", "display_name": "ats", "link": "https://stackoverflow.com/users/10631220/ats"}, "is_accepted": false, "score": 0, "last_activity_date": 1542800362, "creation_date": 1542800362, "answer_id": 53411268, "question_id": 53410581, "link": "https://stackoverflow.com/questions/53410581/c-the-loop-doesnt-continue/53411268#53411268", "title": "C - The loop doesn&#39;t continue", "body": "<pre><code>    getchar(); // takes the user input but assigns it nowhere\n    scanf(\"%c\", &amp;answer); // reads newline, aborts while loop\n</code></pre>\n\n<p>Use <code>c = getchar();</code> and omit the <code>scanf</code>. </p>\n\n<p>Also note that a more idiomatic way of doing this would be with a <code>do-while</code> loop instead.</p>\n"}, {"tags": [], "owner": {"reputation": 7405, "user_id": 5735010, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/znAEN.jpg?s=128&g=1", "display_name": "abhiarora", "link": "https://stackoverflow.com/users/5735010/abhiarora"}, "is_accepted": true, "score": 2, "last_activity_date": 1542806199, "last_edit_date": 1542806199, "creation_date": 1542804455, "answer_id": 53412362, "question_id": 53410581, "link": "https://stackoverflow.com/questions/53410581/c-the-loop-doesnt-continue/53412362#53412362", "title": "C - The loop doesn&#39;t continue", "body": "<p>I have made few corrections in your program. </p>\n\n<ol>\n<li>It was difficult to understand what your program does. I have made your program more readable and modular by defining a separate re-usable function for <code>factorial</code>. </li>\n<li>It makes more sense to ask user again for the number if user has entered <code>'y'</code>. So, I have moved required code.</li>\n<li>I don't recommend mix use of <code>scanf</code> and <code>getchar</code> in the program. So, we can just use <code>scanf</code> for the program. The <code>scanf()</code> function removes whitespace automatically before trying to parse conversions other than characters. The character formats (primarily %c; also scan sets %[\u2026] \u2014 and %n) are the exception; they don't remove whitespace.</li>\n</ol>\n\n<p>Use \" %c\" with a <code>leading blank</code> to skip optional white space. Do not use a trailing blank in a scanf() format string.</p>\n\n<p>Note that this still doesn't consume any trailing whitespace left in the input stream, not even to the end of a line, so beware of that if also using getchar() or fgets() on the same input stream. We're just getting scanf to skip over whitespace before conversions, like it does for %d and other non-character conversions.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n\nunsigned long factorial(unsigned long num)\n{\n    unsigned long mult = 1;\n    unsigned long k = 1;\n    while (k &lt;= num) {\n        mult *= k;\n        k++;\n    }\n\n    return mult;\n}\n\nint main(void)\n{\n    char answer = 'y';\n\n    do {\n        int num = 0;\n        printf(\"Enter a number: \\n\");\n        scanf(\" %d\", &amp;num);\n\n\n        unsigned long mult = factorial(num);\n        printf(\"%d! = %lu\\n\", num, mult);\n\n        printf(\"Would you like to try another number? \\n\");\n        printf(\"Enter: y for yes | n for no\\n\");\n        scanf(\" %c\", &amp;answer);\n\n    } while (answer != 'n');  \n\n    return 0;   \n}   \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5339, "user_id": 1714692, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bd72cbc200eb7c9aa507624f154b21a7?s=128&d=identicon&r=PG", "display_name": "Francesco Boi", "link": "https://stackoverflow.com/users/1714692/francesco-boi"}, "is_accepted": false, "score": 0, "last_activity_date": 1542808575, "creation_date": 1542808575, "answer_id": 53413670, "question_id": 53410581, "link": "https://stackoverflow.com/questions/53410581/c-the-loop-doesnt-continue/53413670#53413670", "title": "C - The loop doesn&#39;t continue", "body": "<p>Your code works and the loop continues: it does not re-ask for the number because that part is outside the loop. Move it inside. Also notice that your code continues executing even when pressing any other key rather than <code>n</code>.</p>\n\n<p>This is a one way to do it starting from your code:</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n\n    int main(void)\n    {\n            char answer = 'y';\n            int num = 0;\n\n            while(answer != 'n')\n            {\n                    printf(\"Enter a number: \\n\");\n                    scanf(\"%d\", &amp;num);\n                    int mult = 1;\n                    int k = 1;\n                    while (k &lt;= num)\n                    {\n                            mult *= k;\n                            k++;\n                    }\n                    printf(\"%d! = %d\\n\", num, mult);\n\n                    printf(\"Would you like to try another number? \\n\");\n                    printf(\"Enter: any key for  yes | n for no\\n\");\n                    getchar();\n                    scanf(\"%c\", &amp;answer);\n            }\n    }\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 10620363, "user_type": "registered", "profile_image": "https://graph.facebook.com/1872867342750737/picture?type=large", "display_name": "Lidor Cohen", "link": "https://stackoverflow.com/users/10620363/lidor-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 53412362, "answer_count": 3, "score": 1, "last_activity_date": 1542810342, "creation_date": 1542797741, "last_edit_date": 1542810342, "question_id": 53410581, "link": "https://stackoverflow.com/questions/53410581/c-the-loop-doesnt-continue", "title": "C - The loop doesn&#39;t continue", "body": "<p>Why doesn't this loop continue after I enter the letter <code>y</code> into the <code>char</code> answer?</p>\n\n<p>I thought <code>getchar()</code> would help but it doesn't seem like its doing anything.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    char answer = 'y';\n    int num = 0;\n    printf(\"Enter a number: \\n\");\n    scanf(\"%d\", &amp;num);\n\n    while(answer != 'n')\n    {\n        int mult = 1;\n        int k = 1;\n        while (k &lt;= num)\n        {\n            mult *= k;\n            k++;\n        }\n        printf(\"%d! = %d\\n\", num, mult);\n\n        printf(\"Would you like to try another number? \\n\");\n        printf(\"Enter: y for yes | n for no\\n\");\n        getchar();\n        scanf(\"%c\", &amp;answer);\n    }       \n}\n</code></pre>\n"}, {"tags": ["c++", "c", "dll", "include", "lib"], "comments": [{"owner": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1542798188, "post_id": 53410038, "comment_id": 93696075, "body": "It would be a good idea to make scenario requiring library &quot;installation&quot; optional or completely omit it. Windows does not even have a concept of library installation for any particular language and even on Linux development is typically performed without ever touching those predefined paths."}, {"owner": {"reputation": 11967, "user_id": 138290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/451afcbb4d54555af26738fb7fd32d7f?s=128&d=identicon&r=PG", "display_name": "Fake Code Monkey Rashid", "link": "https://stackoverflow.com/users/138290/fake-code-monkey-rashid"}, "edited": false, "score": 0, "creation_date": 1597770867, "post_id": 53410038, "comment_id": 112240659, "body": "This question is not a duplicate since it is not about the technical difference between using angle brackets and double quotes but about which to use when writing a library (and there are at least two reasons not to use angle brackets in this instance, one of which was already provided by the asker)."}], "answers": [{"tags": [], "owner": {"reputation": 394, "user_id": 3264375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc3958029becfe0d27b76e56aa3371c3?s=128&d=identicon&r=PG", "display_name": "erenbasturk", "link": "https://stackoverflow.com/users/3264375/erenbasturk"}, "is_accepted": false, "score": 1, "last_activity_date": 1542796254, "creation_date": 1542796254, "answer_id": 53410099, "question_id": 53410038, "link": "https://stackoverflow.com/questions/53410038/which-type-of-include-or-when-writing-a-library-in-c-c/53410099#53410099", "title": "Which type of #include (&quot;&quot; or &lt;&gt;) when writing a library in C/C++", "body": "<p>if the headers in the your working directory, you should use <code>\"\"</code> \nbut,\nif the headers in the system path or inside the your include path you should use <code>&lt;&gt;.</code></p>\n"}, {"tags": [], "owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "is_accepted": false, "score": 2, "last_activity_date": 1542796358, "creation_date": 1542796358, "answer_id": 53410135, "question_id": 53410038, "link": "https://stackoverflow.com/questions/53410038/which-type-of-include-or-when-writing-a-library-in-c-c/53410135#53410135", "title": "Which type of #include (&quot;&quot; or &lt;&gt;) when writing a library in C/C++", "body": "<p><strong>When you use angle brackets</strong>, the compiler searches for the file in the include path list. <strong>When you use double quotes</strong>, it first searches the current directory (i.e. the directory where the module being compiled is) and only then it'll search the include path list.</p>\n\n<p>So, by convention, you use the angle brackets for standard includes and the double quotes for everything else. This ensures that in the (not recommended) case in which you have a local header with the same name as a standard header, the right one will be chosen in each case.</p>\n\n<p>Refer following SO answer for more details</p>\n\n<p><a href=\"https://stackoverflow.com/questions/3162030/difference-between-angle-bracket-and-double-quotes-while-including-heade\">Difference between angle bracket &lt; &gt; and double quotes &quot; &quot; while including header files in C++?</a></p>\n"}, {"tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 0, "last_activity_date": 1542796405, "creation_date": 1542796405, "answer_id": 53410152, "question_id": 53410038, "link": "https://stackoverflow.com/questions/53410038/which-type-of-include-or-when-writing-a-library-in-c-c/53410152#53410152", "title": "Which type of #include (&quot;&quot; or &lt;&gt;) when writing a library in C/C++", "body": "<p>If you use <code>\"...\"</code>   the compiler will search the local directory first and then the system directory.</p>\n\n<p>If you use <code>&lt;...&gt;</code> the compiler will search the system directory.</p>\n\n<p>A user library will normally reside along with the program. So you can use <code>\"...\"</code></p>\n\n<p>You can in any case add additional search paths using the IDE or make file.</p>\n"}], "owner": {"reputation": 965, "user_id": 1051805, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/91cf819cc15fc0ca028808788fd43dca?s=128&d=identicon&r=PG", "display_name": "Phil Rosenberg", "link": "https://stackoverflow.com/users/1051805/phil-rosenberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5128, "favorite_count": 2, "closed_date": 1542796420, "answer_count": 3, "score": 5, "last_activity_date": 1542899115, "creation_date": 1542796091, "last_edit_date": 1542899115, "question_id": 53410038, "link": "https://stackoverflow.com/questions/53410038/which-type-of-include-or-when-writing-a-library-in-c-c", "closed_reason": "Duplicate", "title": "Which type of #include (&quot;&quot; or &lt;&gt;) when writing a library in C/C++", "body": "<p>I am writing a library in C++. The library has multiple headers and cpp files and needs to be cross platform (Windows Visual Studio and Linux gcc). When built the library and headers are installed in a system directory somewhere, where they can be found by other code on the same machine (e.g. /usr/local on a Linux system).</p>\n\n<p>If one of my headers needs to #include one of my other headers then should I use angle brackets or quotes?</p>\n\n<p>I feel like angle brackets is what should be used once the library is installed so that system directories are checked, but when building the library I need to use quotes so that local directories are checked and I don't pick up an out of date version from the system directories.</p>\n\n<p>I am aware ow what the different versions of <code>#include &lt;filename&gt;</code> and <code>#include \u201cfilename\u201d</code> mean. I am asking which is appropriate and why, for the situation of writing a library.</p>\n"}, {"tags": ["c", "pointers", "shared-memory", "void-pointers"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1542796463, "post_id": 53409956, "comment_id": 93695035, "body": "Probably because there is no such thing as a generic pointer-to-pointer. <code>void**</code> is not compatible with <code>t_shm_area **</code>. The only generic pointer type is <code>void*</code>. So you need a step in between: <code>void* v = shm_area;</code>. <code>LayOutShm(...&amp;v); shm_area = v;</code>"}, {"owner": {"reputation": 99, "user_id": 8319135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92a5f668c2b1d4a474af36b5f08facd?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Juan Torres Quiroga", "link": "https://stackoverflow.com/users/8319135/jorge-juan-torres-quiroga"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1542799304, "post_id": 53409956, "comment_id": 93696657, "body": "That makes a lot of sense! Should I cast &quot;v&quot; when assigning it back to shm_area? As in <code>shm_area = (t_shm_area *)v;</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1542799653, "post_id": 53409956, "comment_id": 93696832, "body": "No, that&#39;s not needed when converting to/from void pointers."}, {"owner": {"reputation": 99, "user_id": 8319135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92a5f668c2b1d4a474af36b5f08facd?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Juan Torres Quiroga", "link": "https://stackoverflow.com/users/8319135/jorge-juan-torres-quiroga"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1542799965, "post_id": 53409956, "comment_id": 93697008, "body": "I&#39;ll change the code accordingly and check the functionality plus the static analysis reports. I&#39;ll be back with them as soon as they are available. Thank you very much!"}, {"owner": {"reputation": 99, "user_id": 8319135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92a5f668c2b1d4a474af36b5f08facd?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Juan Torres Quiroga", "link": "https://stackoverflow.com/users/8319135/jorge-juan-torres-quiroga"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1542806361, "post_id": 53409956, "comment_id": 93700402, "body": "I am glad to report that @Lundin solution worked like a charm! Please, post your comment as an answer so I can give it the green tick ^^ Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 1, "last_activity_date": 1542809058, "creation_date": 1542809058, "answer_id": 53413830, "question_id": 53409956, "link": "https://stackoverflow.com/questions/53409956/getting-out-of-bounds-and-variable-uninitialized-warnings-with-mapped-shared/53413830#53413830", "title": "Getting &quot;out-of-bounds&quot; and &quot;variable uninitialized&quot; warnings with mapped shared memory", "body": "<p>The generic pointer type in C is <code>void*</code>. There is however no generic pointer-to-pointer type <code>void**</code>. So the cast <code>(void**)&amp;shm_area</code> is a cast between non-compatible pointer types. Technically this is undefined behavior (strict aliasing violation), so anything can happen.</p>\n\n<p>To fix this, use a temporary <code>void*</code> for the parameter passing:</p>\n\n<pre><code>void* vptr = shm_area;\nLayOutShm(...&amp;vptr); \nshm_area = vptr;\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 8319135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92a5f668c2b1d4a474af36b5f08facd?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Juan Torres Quiroga", "link": "https://stackoverflow.com/users/8319135/jorge-juan-torres-quiroga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 53413830, "answer_count": 1, "score": 0, "last_activity_date": 1542809058, "creation_date": 1542795849, "question_id": 53409956, "link": "https://stackoverflow.com/questions/53409956/getting-out-of-bounds-and-variable-uninitialized-warnings-with-mapped-shared", "title": "Getting &quot;out-of-bounds&quot; and &quot;variable uninitialized&quot; warnings with mapped shared memory", "body": "<p>As part of my C application for Linux, I wrote a small library to allow different processes to communicate through shared memory areas.</p>\n\n<p>I am having lots of alerts for potential out-of-bounds pointers and potentially uninitialized variables contained in the memory areas I create this way.</p>\n\n<p>Consider the function I wrote to create a shared memory area:</p>\n\n<pre><code>int LayOutShm (const char *shm_key, size_t memory_size, void ** new_memory)\n{\n    int fd_value = 0;\n    void * pshm = NULL;\n    int return_value = MEM_MGMT_SHM_ERROR;\n\n    /* Force new_buffer pointer to NULL just like we initialize return_value to MEM_MGMT_SHM_ERROR */\n    *new_memory = NULL;\n\n    /* Shared object is created with O_EXCL to prevent two namesake areas from being created*/\n    fd_value = shm_open(shm_key, O_CREAT | O_RDWR | O_EXCL , S_IRWXU);\n\n    if(fd_value &gt; 0){\n        if(ftruncate(fd_value, memory_size) == 0){\n            /* Here is where we get the pointer to the created memory area */\n            pshm = mmap(NULL, memory_size, PROT_READ | PROT_WRITE, MAP_SHARED, fd_value, 0);\n            if(pshm != MAP_FAILED){\n                return_value = MEM_MGMT_SHM_OK;\n                memset(pshm,0,memory_size); /* Initialize the memory area */\n                *new_memory = pshm; /* Pass the pointer back to the caller */\n            }\n        }\n    }\n\n    return return_value;\n}/*LayOutShm*/\n</code></pre>\n\n<p>Now, this is some piece of code were I get warnings:</p>\n\n<pre><code>#define SHM_KEY                 \"my_shm_key\"\n\ntypedef struct{\n    pthread_mutex_t shm_mutex;\n    int shm_var1;\n    char shm_var2;\n    union{\n        int shm_union_var1;\n        char shm_union_var2;\n    }shm_union\n}t_shm_area;\n\nstatic t_shm_area * shm_area = NULL;\n\nstatic int ShmInitialization(void)\n{\n    int return_value = -1;\n\n    (void)LayOutShm(SHM_KEY, sizeof(t_shm_area), (void**)&amp;shm_area);\n\n    /*Check for errors in shared memory creation*/\n    if (shm_area == NULL){\n        syslog(LOG_ERR | LOG_USER, \"Error laying out shared memory segment\\n\");\n    }\n    else{\n        shm_area-&gt;var1 = 0; /* This assignment gets flagged with a potential out-of-bounds runtime error */\n        shm_area-&gt;shm_union.shm_union_var2 = 0; /* This assignment gets flagged with a potential out-of-bounds runtime error */\n\n        /*Create empty attributes structure*/\n        pthread_mutexattr_t mutex_attributes;\n\n        /*Initialize attributes structures with default values*/\n        (void)pthread_mutexattr_init(&amp;mutex_attributes);\n\n        /*Set attributes structure with shared memory value*/\n        (void)pthread_mutexattr_setpshared(&amp;mutex_attributes, PTHREAD_PROCESS_SHARED);\n\n        /*settype mutex PTHREAD_MUTEX_ERRORCHECK*/\n        (void)pthread_mutexattr_settype(&amp;mutex_attributes, PTHREAD_MUTEX_ERRORCHECK);\n\n        /*Initialize the mutex with all the previous attributes*/\n        (void)pthread_mutex_init(&amp;shm_area-&gt;shm_mutex, &amp;mutex_attributes);\n\n        return_value = 0;\n    }\n\n    return return_value;\n}/*ShmInitialization*/\n</code></pre>\n\n<p>This is the first time I try my hand at double pointers, so I wouldn't be surprised if I were screwing things up with either that void ** in the declaration or the way I cast the input double pointer to void.</p>\n\n<p>A previous implementation of the function returned the pointer directly and didn't generate these problems, but I was asked to change it so that we can return a status code (even if we don't use them for now).</p>\n\n<p>After that area is created, any locally declared variable I pass to the library to get values from the shared memory gets \"tainted\" with warnings from potential \"out-of-bounds\" runtime errors or \"variable might not be initialized\" warnings. The library has already been tested with several different types of data structures (some of them as big as 15kB) and data integrity and performance are satisfying.</p>\n\n<p>Any idea why am I getting these warnings? </p>\n\n<p>Thank you very much, best regards!</p>\n"}, {"tags": ["c", "arrays", "pointers", "segmentation-fault", "coredump"], "comments": [{"owner": {"reputation": 413, "user_id": 10518032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91471cd13b1f82257c4311a9e213753?s=128&d=identicon&r=PG&f=1", "display_name": "nm_tp", "link": "https://stackoverflow.com/users/10518032/nm-tp"}, "edited": false, "score": 0, "creation_date": 1542795712, "post_id": 53409866, "comment_id": 93694573, "body": "Read up on how to format your question. The code here is quite unreadable."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1542795717, "post_id": 53409866, "comment_id": 93694577, "body": "Please indent your code properly."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1542795845, "post_id": 53409866, "comment_id": 93694664, "body": "(Unrelated to the seggie, but <code>if (a == &#39;H&#39;) a = &#39;T&#39;; if (a == &#39;T&#39;) a = &#39;H&#39;;</code> will make <code>a == &#39;H&#39;</code> in both cases. You need an <code>else</code> here.)"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1542796014, "post_id": 53409866, "comment_id": 93694757, "body": "Run your code in a debugger (ie gdb) and it will tell you where in your code it is crashing"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1542796023, "post_id": 53409866, "comment_id": 93694763, "body": "Can you edit your question to include the input you gave, as well as the output you got ? Can you also indicate where the segmentation fault happened ?"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1542796150, "post_id": 53409866, "comment_id": 93694837, "body": "You want to call <code>fill_it</code> recursively and control it with <code>N</code>, but here: <code>fill_it(p, N--, ...)</code>, you don&#39;t call with an decreased <code>N</code>, but with the old value of <code>N</code>, which is only decreased after returning. De facto, you never terminate your recursion. Use <code>N - 1</code> here."}, {"owner": {"reputation": 805, "user_id": 10424245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0504daecf094f9efeb1e1cf6d231588?s=128&d=identicon&r=PG&f=1", "display_name": "Loufi", "link": "https://stackoverflow.com/users/10424245/loufi"}, "edited": false, "score": 2, "creation_date": 1542796485, "post_id": 53409866, "comment_id": 93695057, "body": "Valgrind is your friend when you have to find memory error, you should try it"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1542796953, "post_id": 53409866, "comment_id": 93695351, "body": "Calculate the size and verify it, before calling malloc."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1542797173, "post_id": 53409866, "comment_id": 93695484, "body": "(You call &#180;fill_it` recursively, but you have got a tail recursion here, which you can turn into a loop. With two nested loops, the function would be much clearer, in my opinion.)"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1542797185, "post_id": 53409866, "comment_id": 93695493, "body": "@MOehm there&#39;s also a similar problem with <code>column2++</code> in the recursive call"}, {"owner": {"reputation": 13, "user_id": 10685136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b962f13677312d021dcaf9885fe894e1?s=128&d=identicon&r=PG&f=1", "display_name": "dimitraaaa", "link": "https://stackoverflow.com/users/10685136/dimitraaaa"}, "edited": false, "score": 0, "creation_date": 1542798375, "post_id": 53409866, "comment_id": 93696166, "body": "what can i do to make it more readable?"}], "answers": [{"comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 467, "user_id": 9950378, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bMztUomG68Y/AAAAAAAAAAI/AAAAAAAAABE/FcXN1FGD0cQ/photo.jpg?sz=128", "display_name": "Jean-Marc Zimmer", "link": "https://stackoverflow.com/users/9950378/jean-marc-zimmer"}, "edited": false, "score": 0, "creation_date": 1542797665, "post_id": 53410348, "comment_id": 93695776, "body": "@Jean-MarcZimmer can&#39;t see where in my fixed version of the code that I&#39;m doing?"}, {"owner": {"reputation": 467, "user_id": 9950378, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bMztUomG68Y/AAAAAAAAAAI/AAAAAAAAABE/FcXN1FGD0cQ/photo.jpg?sz=128", "display_name": "Jean-Marc Zimmer", "link": "https://stackoverflow.com/users/9950378/jean-marc-zimmer"}, "edited": false, "score": 0, "creation_date": 1542798127, "post_id": 53410348, "comment_id": 93696047, "body": "Oh, whoops, my bad, I misread. It was on the first code section. I&#39;m really terrbile at understanding written stuff..."}, {"owner": {"reputation": 13, "user_id": 10685136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b962f13677312d021dcaf9885fe894e1?s=128&d=identicon&r=PG&f=1", "display_name": "dimitraaaa", "link": "https://stackoverflow.com/users/10685136/dimitraaaa"}, "edited": false, "score": 0, "creation_date": 1542802109, "post_id": 53410348, "comment_id": 93698160, "body": "@ChrisTurner thank you very much,you made my day! :-)"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 13, "user_id": 10685136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b962f13677312d021dcaf9885fe894e1?s=128&d=identicon&r=PG&f=1", "display_name": "dimitraaaa", "link": "https://stackoverflow.com/users/10685136/dimitraaaa"}, "edited": false, "score": 0, "creation_date": 1542806022, "post_id": 53410348, "comment_id": 93700208, "body": "@dimitraaaa if my answer is right it&#39;s traditional to mark it as such with a tick"}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": true, "score": 2, "last_activity_date": 1542797041, "creation_date": 1542797041, "answer_id": 53410348, "question_id": 53409866, "link": "https://stackoverflow.com/questions/53409866/segmantation-fault-malloc-pointers-functions/53410348#53410348", "title": "segmantation fault malloc pointers functions", "body": "<p>The problem is, you're not allocating enough memory. This line is fine</p>\n\n<pre><code>p = (char ** ) malloc((power(2, fores)) * sizeof(char * ));\n</code></pre>\n\n<p>but this loop is only allocating memory for part of the 2-dimensional array.</p>\n\n<pre><code>for (i = 0; i &lt; fores; i++)\n    p[i] = (char * ) malloc(fores * sizeof(char));\n</code></pre>\n\n<p>The memory allocation should look more like this...</p>\n\n<pre><code>foresSquared = power(2, fores);\np = malloc(foresSquared*sizeof(char *));\nfor (i = 0; i &lt; foresSquared; i++)\n    p[i] = malloc(fores);\n</code></pre>\n\n<p>Since the result of <code>power</code> is going to be consistent, it makes sense to store the value in a variable and use that rather than recalculating it. It'll make the code clearer too.</p>\n\n<p>You also don't need to cast the return value of <code>malloc</code> as C handles that for you. And <code>sizeof(char)</code> isn't needed as it's guaranteed to always be 1.</p>\n"}], "owner": {"reputation": 13, "user_id": 10685136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b962f13677312d021dcaf9885fe894e1?s=128&d=identicon&r=PG&f=1", "display_name": "dimitraaaa", "link": "https://stackoverflow.com/users/10685136/dimitraaaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 53410348, "answer_count": 1, "score": 1, "last_activity_date": 1542797041, "creation_date": 1542795583, "last_edit_date": 1542795866, "question_id": 53409866, "link": "https://stackoverflow.com/questions/53409866/segmantation-fault-malloc-pointers-functions", "title": "segmantation fault malloc pointers functions", "body": "<p>hello guys this is my code :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint power(int a, int b) {\n    int exponent = b, result = 1;\n    while (exponent != 0) {\n        result = result * a;\n        exponent--;\n    }\n    //printf(\"%d\",result);\n    return result;\n}\n\nint fill_it(char ** p, int N, int fliptimes, int column2) {\n    if (N &lt; 0) return 0;\n    int counter = 0, l;\n    char a = 'H';\n    for (l = 0; l &lt; power(2, fliptimes); l++) {\n        p[l][column2] = a;\n        counter++;\n        if (counter == (power(2, N) / 2)) {\n            counter = 0;\n            if (a == 'H') a = 'T';\n            if (a == 'T') a = 'H';\n        }\n    }\n    fill_it(p, N--, fliptimes, column2++);\n}\n\nint main() {\n    int i, fores, j, l, m;\n    char ** p;\n    printf(\"how many times did you toss the coin?:\");\n    scanf(\"%d\", &amp; fores);\n    p = (char ** ) malloc((power(2, fores)) * sizeof(char * ));\n    for (i = 0; i &lt; fores; i++)\n        p[i] = (char * ) malloc(fores * sizeof(char));\n    fill_it(p, fores, fores, 0);\n    for (l = 0; l &lt; power(2, fores); l++) {\n        for (m = 0; m &lt; fores; m++) {\n            printf(\"%c\", p[l][m]);\n        }\n    }\n    printf(\",\");\n}\n</code></pre>\n\n<p>it does compile.But when i run the program it returns a \"segmantation fault (core dumped)\" error</p>\n\n<p>i know it means that i tried to access memory,i dont have acces to but i dont understand which part of the program is defective</p>\n"}, {"tags": ["c", "string", "increment"], "comments": [{"owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 1, "creation_date": 1542793720, "post_id": 53409238, "comment_id": 93693436, "body": "Do you want to increment the address or the content, for content:  (*fubar)++;  For the address fubar++;"}, {"owner": {"reputation": 1095, "user_id": 7813604, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c05e209ba1c9aecc893a588b77b5d82f?s=128&d=identicon&r=PG&f=1", "display_name": "Kindred", "link": "https://stackoverflow.com/users/7813604/kindred"}, "reply_to_user": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 1, "creation_date": 1542794074, "post_id": 53409238, "comment_id": 93693636, "body": "@SPlatten: I want neither, I just want to know whether it would lead to undefined behaviour as the answer said..."}, {"owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 1, "creation_date": 1542794119, "post_id": 53409238, "comment_id": 93693660, "body": "You have no assignment so there is no point in the &#39;*&#39;."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1542795187, "post_id": 53409238, "comment_id": 93694269, "body": "Please, note the comment of usr to this linked answer: <i>Your &quot;SQUARELY UNDEFINED BEHAVIOUR&quot; code is in fact perfectly valid (no undefined behaviour).</i> This is exactly what I think about it. ;-)"}, {"owner": {"reputation": 1095, "user_id": 7813604, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c05e209ba1c9aecc893a588b77b5d82f?s=128&d=identicon&r=PG&f=1", "display_name": "Kindred", "link": "https://stackoverflow.com/users/7813604/kindred"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1542795379, "post_id": 53409238, "comment_id": 93694378, "body": "@Scheff: wow, but the time stamp is slightly after mine my question."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1542796866, "post_id": 53409238, "comment_id": 93695294, "body": "Oops. I was not aware about this. ;-)"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1542796921, "post_id": 53409238, "comment_id": 93695328, "body": "I guess, your question leaded usr to this fact and he left a node at the original place..."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1542797167, "post_id": 53409238, "comment_id": 93695482, "body": "Lesson learned: adhere to the rule of never mixing ++ with other operators in the same expression. It is a bad thing to do for multiple reasons: readability, maintainability, potentially undefined behavior,"}], "answers": [{"comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 1095, "user_id": 7813604, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c05e209ba1c9aecc893a588b77b5d82f?s=128&d=identicon&r=PG&f=1", "display_name": "Kindred", "link": "https://stackoverflow.com/users/7813604/kindred"}, "edited": false, "score": 1, "creation_date": 1542794064, "post_id": 53409302, "comment_id": 93693631, "body": "@ptr_user7813604 <code>*fubar++</code> is equal to <code>*(fubar++)</code>. That is also explained in the answer. Note that since it is a postfix operator the pointer is dereferenced before the increment and then the pointer is incremented."}, {"owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "reply_to_user": {"reputation": 1095, "user_id": 7813604, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c05e209ba1c9aecc893a588b77b5d82f?s=128&d=identicon&r=PG&f=1", "display_name": "Kindred", "link": "https://stackoverflow.com/users/7813604/kindred"}, "edited": false, "score": 1, "creation_date": 1542794221, "post_id": 53409302, "comment_id": 93693715, "body": "@ptr_user7813604, ++(postfix) is meaningless and means nothing since you have no additional operand in the brackets."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 1, "creation_date": 1542794222, "post_id": 53409302, "comment_id": 93693718, "body": "<code>*fubar++</code> is equal to <code>*(fubar++)</code> which is (mostly) equal to <code>*fubar; fubar++;</code>."}, {"owner": {"reputation": 1095, "user_id": 7813604, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c05e209ba1c9aecc893a588b77b5d82f?s=128&d=identicon&r=PG&f=1", "display_name": "Kindred", "link": "https://stackoverflow.com/users/7813604/kindred"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 1, "creation_date": 1542794336, "post_id": 53409302, "comment_id": 93693791, "body": "@Osiris: I remember ++(postfix) returns old value or something, but I&#39;m confused now lol."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 6, "last_activity_date": 1542795080, "last_edit_date": 1542795080, "creation_date": 1542793840, "answer_id": 53409302, "question_id": 53409238, "link": "https://stackoverflow.com/questions/53409238/whats-wrong-with-this-example-with-string-literal/53409302#53409302", "title": "What&#39;s wrong with this example with string literal?", "body": "<p>The location of the <code>++</code> is the key: If it's a suffix (like in this case) then the increment happens <em>after</em>.</p>\n\n<p>Also due to <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">operator precedence</a> you increment the <em>pointer</em>.</p>\n\n<p>So what happens is that the pointer <code>fubar</code> is dereference (resulting in <code>'h'</code> which is then ignored), and then the pointer variable <code>fubar</code> is incremented to point to the <code>'e'</code>.</p>\n\n<p>In short: <code>*fubar++</code> is fine and valid.</p>\n\n<p>If it was <code>(*fubar)++</code> then it would be undefined behavior, since then it would attempt to increase the first characters of the string. And literal strings in C are arrays of <em>read-only</em> characters, so attempting to modify a character in a literal string would be <em>undefined behavior</em>.</p>\n\n<hr>\n\n<p>The expression <code>*fubar++</code> is essentially equal to</p>\n\n<pre><code>char *temporary_variable = fubar;\nfubar = fubar + 1;\n*temporary_variable;  // the result of the whole expression\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 5, "last_activity_date": 1542796551, "last_edit_date": 1542796551, "creation_date": 1542795242, "answer_id": 53409749, "question_id": 53409238, "link": "https://stackoverflow.com/questions/53409238/whats-wrong-with-this-example-with-string-literal/53409749#53409749", "title": "What&#39;s wrong with this example with string literal?", "body": "<p>The code shown is clearly <em>not</em> undefined behaviour, since <code>*fubar++</code> is somewhat equal to <code>char result; (result = *fubar, fubar++, result)</code>, i.e. it increments the pointer, and not the dereferenced value, and the result of the expression is the (dereferenced) value <code>*fubar</code> before the pointer got incremented. <code>*fubar++</code> actually gives you the character value to which <code>fubar</code> originally points, but you simply make no use of this \"result\" and ignore it.</p>\n\n<p>Note, however, that the following code <em>does</em>  introduce undefined behaviour:</p>\n\n<pre><code>char *fubar = \"hello world\";\n(*fubar)++;\n</code></pre>\n\n<p>This is because this increments the value to which <code>fubar</code> points and thereby manipulates a string literal -> undefined behaviour.</p>\n\n<p>When replacing the string literal with an character array, then everything is OK again:</p>\n\n<pre><code>int main() {\n\n    char test[] = \"hello world\";\n    char* fubar = test;\n    (*fubar)++;\n    printf(\"%s\\n\",fubar);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>iello world\n</code></pre>\n"}], "owner": {"reputation": 1095, "user_id": 7813604, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c05e209ba1c9aecc893a588b77b5d82f?s=128&d=identicon&r=PG&f=1", "display_name": "Kindred", "link": "https://stackoverflow.com/users/7813604/kindred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 53409749, "answer_count": 2, "score": 2, "last_activity_date": 1542935552, "creation_date": 1542793636, "last_edit_date": 1542935552, "question_id": 53409238, "link": "https://stackoverflow.com/questions/53409238/whats-wrong-with-this-example-with-string-literal", "title": "What&#39;s wrong with this example with string literal?", "body": "<p>I'm reading an answer from this site which says the following is undefined</p>\n\n<pre><code>char *fubar = \"hello world\";\n*fubar++; // SQUARELY UNDEFINED BEHAVIOUR!\n</code></pre>\n\n<p>but isn't that <code>fubar++</code> is done first, which means moving the pointer to <code>e</code>, and <code>*()</code> is then done, which means extract the <code>e</code> out. I know this is supposed to be asked on chat (I'm a kind person) but no one is there so I ask here to attract notice.</p>\n"}, {"tags": ["c", "memory-management", "compiler-optimization"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1542793466, "post_id": 53409162, "comment_id": 93693268, "body": "Off topic: You should cast your pointers to <code>void *</code> for <code>printf</code>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1542793732, "post_id": 53409162, "comment_id": 93693445, "body": "This is totally implementation dependent. It probably uses more space than actually nessessary for alignment purposes."}, {"owner": {"reputation": 429, "user_id": 10209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d9d1dd420c5e9381d2978720c47940?s=128&d=identicon&r=PG&f=1", "display_name": "Korni", "link": "https://stackoverflow.com/users/10209003/korni"}, "edited": false, "score": 0, "creation_date": 1542793762, "post_id": 53409162, "comment_id": 93693461, "body": "Probably Data structure alignment. See <a href=\"https://en.wikipedia.org/wiki/Data_structure_alignment\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Data_structure_alignment</a>"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 10516096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8517688db5f4d1e49bf402642cb581d?s=128&d=identicon&r=PG&f=1", "display_name": "biaoJM", "link": "https://stackoverflow.com/users/10516096/biaojm"}, "is_accepted": false, "score": 0, "last_activity_date": 1542795375, "creation_date": 1542795375, "answer_id": 53409790, "question_id": 53409162, "link": "https://stackoverflow.com/questions/53409162/how-much-stack-space-does-c-exactly-use-for-a-function-activation-record-when-ca/53409790#53409790", "title": "How much stack space does C exactly use for a function activation record when calling it?", "body": "<p>It is because gcc's stack alignment.</p>\n\n<p>In gcc stack alignment is 16 bytes by default,while,at least in my emvironment. I changed it to 4 bytes with compile option \"-mpreferred-stack-boundary=2\",just as same as size of int.</p>\n\n<p>Then the stack top in function will move every single time I declare a new int.</p>\n\n<p>Thanks for <a href=\"https://stackoverflow.com/users/898348/jabberwocky\">Jabberwocky</a> and <a href=\"https://stackoverflow.com/users/10209003/korni\">Korni</a>'s comments which introduced a new area I didn't know before.</p>\n"}, {"tags": [], "owner": {"reputation": 10627, "user_id": 1537925, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U8DRJ.png?s=128&g=1", "display_name": "The Vee", "link": "https://stackoverflow.com/users/1537925/the-vee"}, "is_accepted": true, "score": 4, "last_activity_date": 1542796494, "last_edit_date": 1542796494, "creation_date": 1542795971, "answer_id": 53410002, "question_id": 53409162, "link": "https://stackoverflow.com/questions/53409162/how-much-stack-space-does-c-exactly-use-for-a-function-activation-record-when-ca/53410002#53410002", "title": "How much stack space does C exactly use for a function activation record when calling it?", "body": "<p>I think you are making some unfounded assumptions on how the stack, and the compiler, work. Namely:</p>\n\n<ol>\n<li>that variables are allocated at the moment you declare them,</li>\n<li>that the \"last\" variable takes up the \"top\" of the stack,</li>\n<li>that the variables only take as much space as they need,</li>\n<li>that this has a clear and deterministic answer.</li>\n</ol>\n\n<p>Here's a rough idea of what happens when you call a function in C, gcc, x86 platform, no optimizations:</p>\n\n<ol>\n<li>The parameters (if any) are stored in registers and/or the stack. The details are different between 32 and 64 bit, integers/pointers, floats, and structs of different sizes, number of arguments, vararg, and more.</li>\n<li>The <code>call</code> instruction is taken, which pushes the return address onto the stack (taking up 8 bytes in both 32 and 64 bit, I think, though for different reasons) and redirects the processor to the new address.</li>\n<li>The stack pointer is saved in the BP register, after pushing the original value of BP (4 or 8 bytes).</li>\n<li>The stack pointer is decremented by enough bytes to accommodate all local variables.</li>\n</ol>\n\n<p>Upon returning,</p>\n\n<ol start=\"5\">\n<li>The value of the BP register overwrites the stack pointer, negating step 4 automatically. Then the original value of BP is popped.</li>\n<li>The <code>ret</code> instruction is taken, popping the return address and jumping there.</li>\n</ol>\n\n<p>It should be noted that this is by no means universal, or guaranteed. \"Simple\" functions may be optimized to skip steps 3, 4 and 5. Step 4 can in principle happen multiple times. Additional magic can be done to the stack pointer like aligning it to a particular power-of-two boundary (like multiples of 128 for SSE instruction operands), allocating something called the red zone, <code>alloca</code> function, etc. Many exceptions and special cases exist. More details will depend on gcc command line parameters, or their built-in defaults per distribution. Other compilers may follow slightly different, yet compatible, conventions. But let's stick to this model.</p>\n\n<p>What's important to notice is that all the local variables are often allocated all together in step 4, and the size that's taken may be either the total size required or more. For example, it may be mandated by the conventions that the compiler makes sure that the stack pointer is a multiple of 16 at any point (so that the functions themselves can rely on this), in which case it rounds up to the nearest multiple (also with regard to what had been taken in steps 1 through 3). Within this zone the locals are assigned addresses (offset from the BP or SP) such as to respect their size <em>and alignment</em> requirements.</p>\n\n<p>Your example, especially the code in <code>main</code>, can not work because the compiler won't follow your wish to allocate the space for <code>j</code> only after returning from <code>f</code>. It happens along with <code>arr</code> and <code>i</code> in the beginning of the function and the order of the variables is unspecified, likely chosen so that they can be best \"packed\" into the space that's available, with ints taking addresses at 32- or 64-bit boundaries. Even if it did, the calculation would be mistaken by taking the address of <code>j</code> as the \"stack top after func\": at best, it would be \"stack top after func <em>and allocation</em>\". In general, the \"stack top after func\" must be the same as the \"stack top before func\" in the C calling convention.</p>\n\n<hr>\n\n<p>In order to get a more concrete idea in your function, I would suggest either:</p>\n\n<p><strong>Studying the assembly</strong> after compilation. The tool at <code>godbolt.com</code> is great for this: <a href=\"https://godbolt.org/z/_Z1uWl\" rel=\"nofollow noreferrer\">here's your code</a> compiled by gcc 8.2 in x86-64 as shown there.</p>\n\n<p>The stack pointer should be reduced by 16 (line 6) plus 8 (the size of RBP @ line 4) plus whatever the <code>call</code> at line 28 required to store the return address, 8 in 64-bit mode.</p>\n\n<p><strong>Using a debugger</strong>:</p>\n\n<pre><code>(gdb) b 11\n(gdb) b 4\n(gdb) run\nStarting program: [redacted]\nstack top before func   0x7fffffffd2dc\n\nBreakpoint 1, main () at a.c:11\n11      i = func();\n(gdb) print $rsp\n$1 = (void *) 0x7fffffffd2d0\n(gdb) c\nContinuing.\n\nBreakpoint 2, func () at a.c:4\n4       printf(\"stack top in func \\t%p\\n\", &amp;c);\n(gdb) print $rsp\n$2 = (void *) 0x7fffffffd2b0\n</code></pre>\n\n<p>You can see here that <code>rsp</code> reduced by 0x20 == 32.</p>\n"}], "owner": {"reputation": 13, "user_id": 10516096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8517688db5f4d1e49bf402642cb581d?s=128&d=identicon&r=PG&f=1", "display_name": "biaoJM", "link": "https://stackoverflow.com/users/10516096/biaojm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 53410002, "answer_count": 2, "score": 1, "last_activity_date": 1542796494, "creation_date": 1542793387, "question_id": 53409162, "link": "https://stackoverflow.com/questions/53409162/how-much-stack-space-does-c-exactly-use-for-a-function-activation-record-when-ca", "title": "How much stack space does C exactly use for a function activation record when calling it?", "body": "<p>Environment\uff1agcc version 6.3.0 (MinGW.org GCC-6.3.0-1) on Windows10</p>\n\n<p>I compile and run code in command line.</p>\n\n<p><strong>Here is my code:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;  \nint func(void){\n    int c;\n    printf(\"stack top in func \\t%p\\n\", &amp;c);\n    return 1;\n}\nvoid main(void)  { \n    int arr[0];\n    int i;  \n    printf(\"stack top before func \\t%p\\n\", &amp;i);\n    i = func();\n    int j;\n    printf(\"stack top after func \\t%p\\n\", &amp;j);\n    return;  \n}\n</code></pre>\n\n<p>Here is result:</p>\n\n<pre><code>stack top before func   0061FF2C\nstack top in func       0061FEFC\nstack top after func    0061FF28\n</code></pre>\n\n<p>The gap size between the stack top while in function and stack top out of function is 48 bytes.</p>\n\n<p>I then changed the size of \"arr\" to 1 and the result is:</p>\n\n<pre><code>stack top before func   0061FF28\nstack top in func       0061FEFC\nstack top after func    0061FF24\n</code></pre>\n\n<p>The gap just shrinked and the stack top while in function stayed put.The gap size is now 44 bytes.</p>\n\n<p>It stops shrinking when the size of \"arr\" is 3.</p>\n\n<p>The new gap size is 52 bytes. </p>\n\n<p>Is that sort of strategy of memory management?</p>\n\n<p>What's the benefit when it can use 44 bytes while it chose to use 52 bytes and the size of variables before function call can be known while compile time?</p>\n"}, {"tags": ["c++", "c", "buffer", "lptstr"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 3, "creation_date": 1542793266, "post_id": 53409086, "comment_id": 93693139, "body": "I think there is nothing special about <code>&#39;%&#39;</code> except in the format strings of <code>printf</code> and <code>scanf</code> family."}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 5, "creation_date": 1542793269, "post_id": 53409086, "comment_id": 93693144, "body": "this <code>&#39;%%&#39;</code> is not a character. Also if you want to replace a single character with two characters you have to shift all following characters otherwise eg <code>&quot;asd%asd&quot;</code> will become <code>&quot;asd%%sd&quot;</code>"}, {"owner": {"reputation": 429, "user_id": 10209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d9d1dd420c5e9381d2978720c47940?s=128&d=identicon&r=PG&f=1", "display_name": "Korni", "link": "https://stackoverflow.com/users/10209003/korni"}, "edited": false, "score": 2, "creation_date": 1542793427, "post_id": 53409086, "comment_id": 93693249, "body": "You need to resize your buffer depending on how many <code>%</code> you have in your string, because the new mapped <code>%%</code> adds a char to your string."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1542793569, "post_id": 53409086, "comment_id": 93693336, "body": "The code in the <code>for</code> loop is simply wrong. Please confirm that your code is supposed to transform a string like <code>&quot;ABC % DEF % GHI&quot;</code> into <code>&quot;ABC %% DEF %% GHI&quot;</code>."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 2, "creation_date": 1542793636, "post_id": 53409086, "comment_id": 93693382, "body": "Also <code>&#39;%%&#39;</code> is not a pair of percent signs.    It is a multi-character literal, which has type <code>int</code> and a value that is implementation-defined."}, {"owner": {"reputation": 1, "user_id": 10684808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/747da9f9654ffb5655a0753e72cff758?s=128&d=identicon&r=PG&f=1", "display_name": "ConcernedCoder", "link": "https://stackoverflow.com/users/10684808/concernedcoder"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1542794393, "post_id": 53409086, "comment_id": 93693823, "body": "@Jabberwocky I apologize for the lack of clearness. My code is supposed to read &quot;ABC%DEF%GHI&quot; from LPCTSTR lpRemapping and keep exactly the same &quot;ABC%DEF%GHI&quot; in LPTSTR lpBuffer, but as user463035818 stated, I am getting &quot;ABCEFHI&quot; in LPTSTR lpBuffer"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 2, "creation_date": 1542795550, "post_id": 53409086, "comment_id": 93694477, "body": "Is that because you check that by printing that string with <code>printf(str)</code>? Don&#39;t do that, because you never know what format specifiers (for which you don&#39;t provide arguments) it contains. To print a string, use <code>printf(&quot;%s&quot;, str)</code> or (with a new-line), <code>puts(str)</code>. There shouldn&#39;t be anything special about copying."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1542796147, "post_id": 53409086, "comment_id": 93694833, "body": "Complement to M Oehm&#39;s comment: you don&#39;t need any remapping at all. Just use the string pointed by<code>lpRemapping</code> as is."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1542799255, "post_id": 53409086, "comment_id": 93696634, "body": "Using <code>TCHAR*</code> has two big problems: it&#39;s a Windows 95 workaround; we switched to plain <code>WCHAR</code> about 2 decades ago. And since this is C++ code, we&#39;d use <code>std::wstring</code>."}], "owner": {"reputation": 1, "user_id": 10684808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/747da9f9654ffb5655a0753e72cff758?s=128&d=identicon&r=PG&f=1", "display_name": "ConcernedCoder", "link": "https://stackoverflow.com/users/10684808/concernedcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542793116, "creation_date": 1542793116, "question_id": 53409086, "link": "https://stackoverflow.com/questions/53409086/how-do-i-keep-percent-signs-copying-from-lpctstr-to-lptstr", "title": "How do I keep percent signs (%) copying from LPCTSTR to LPTSTR?", "body": "<p>I am a beginner in this and after a lot of frustration I finally had the courage to ask to all of you, the true professionals.</p>\n\n<p>I need to keep all the percent signs (%) I receive from a LPCTSTR when I copy it to a LPTSTR. After some researching and trying, I came with this:</p>\n\n<pre><code>LPCTSTR lpRemapping; // Contains a string with percents (%) in it\nsize_t nSize = _tcsclen(lpRemapping) + 1;\nLPTSTR lpBuffer = new TCHAR[nSize];\nerrno_t nResult = _tcsncpy_s(lpBuffer, nSize, lpRemapping, ((size_t)-1));\nfor (int currentChar = 0; currentChar &lt; nSize; currentChar++) {\n    if (lpRemapping[currentChar] == '%') {\n        lpBuffer[currentChar] = '%%';\n    }\n}\n</code></pre>\n\n<p>But it seems I am still losing the percent signs in the process. I have read a lot of answers telling me to use %% but I am doing something wrong here and I don't know what it is.</p>\n\n<p>I do not control the string I am receiving and some of them will definitely contain the percent sign (%).</p>\n\n<p>I really appreciate your time and I hope you can bring me some light in this matter.</p>\n"}, {"tags": ["c", "sdl-2", "mingw-w64"], "comments": [{"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 3, "creation_date": 1542793015, "post_id": 53408985, "comment_id": 93692979, "body": "<a href=\"https://stackoverflow.com/questions/25594714/how-can-i-get-the-screen-resolution-using-sdl2\" title=\"how can i get the screen resolution using sdl2\">stackoverflow.com/questions/25594714/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 3, "creation_date": 1542793485, "post_id": 53408985, "comment_id": 93693286, "body": "<i>SDL.h requires the main function to be renamed as WinMain</i> Thats not true. If you have <code>main()</code> or <code>WinMain()</code> as entry point of your program is determined by what windows subsystem you write code for (CONSOLE or WINDOWS (or others that are irrelevant here)). Also, simply renaming <code>main()</code>  to <code>WinMain()</code> won&#39;t work as both take different parameters. The error message you got tells you that. What does your definition of <code>WinMain()</code> look like?"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1542794116, "post_id": 53408985, "comment_id": 93693658, "body": "There is just no requirement at all that #include windows.h also requires WinMain().  Using the winapi works just fine in a console app that starts from main() for example, including GetSystemMetrics().  Hard to guess how this train jumped off the rails.  But you certainly need to delete your WinMain() function, SDL already takes care of that."}, {"owner": {"reputation": 2060, "user_id": 3808573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CmqrY.png?s=128&g=1", "display_name": "ssd", "link": "https://stackoverflow.com/users/3808573/ssd"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542794260, "post_id": 53408985, "comment_id": 93693740, "body": "@Swordfish : When using <code>main</code>, compiler complains about <code>WinMain</code> not to be found. Can&#39;t remember the exact address, but somewhere on the web I came across a get around by replacing the <code>main</code> as <code>WinMain</code>. Gave it a try... and this solved my problem --though no sure about the internals.  Anyway, <code>SDL_GetDesktopDisplayMode</code> seems to solve my issue. Thanks a lot!"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 3, "creation_date": 1542794579, "post_id": 53408985, "comment_id": 93693934, "body": "Internals: <a href=\"https://djrollins.com/2016/10/02/sdl-on-windows/\" rel=\"nofollow noreferrer\">How SDL2 does its initialisation magic on Windows</a> and how to get rid of that behaviour: <a href=\"https://stackoverflow.com/a/38803842/3975177\">stackoverflow.com/a/38803842/3975177</a>"}, {"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1542801821, "post_id": 53408985, "comment_id": 93698009, "body": "<code>previous declaration of &#39;WinMain&#39; was here</code> most likely means that you have declared/defined <code>WinMain</code> with different return type or parameter set, and C don&#39;t have function overloading, so that is a conflict. Modify your function definition to match API requirements. And no, SDL certainly don&#39;t require WinMain, but you already have links about that."}], "answers": [{"tags": [], "owner": {"reputation": 2060, "user_id": 3808573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CmqrY.png?s=128&g=1", "display_name": "ssd", "link": "https://stackoverflow.com/users/3808573/ssd"}, "is_accepted": true, "score": 0, "last_activity_date": 1542936184, "creation_date": 1542936184, "answer_id": 53439651, "question_id": 53408985, "link": "https://stackoverflow.com/questions/53408985/getting-screen-resolution-in-c-w-o-windows-h/53439651#53439651", "title": "Getting screen resolution in C, w/o &quot;windows.h&quot;", "body": "<p>Ok! I've realized what I was doing wrong...</p>\n\n<p>For the linking phase, I was using the following libraries and the linker was complaining about the <code>WinMain</code> function not to be found.</p>\n\n<pre><code>-lSDL2main\n-lSDL2\n</code></pre>\n\n<p>Then I added the mingw32 library as shown below and the problem got solved (the order of the libraries does matter I think).</p>\n\n<pre><code>-lmingw32\n-lSDL2main\n-lSDL2\n</code></pre>\n"}], "owner": {"reputation": 2060, "user_id": 3808573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CmqrY.png?s=128&g=1", "display_name": "ssd", "link": "https://stackoverflow.com/users/3808573/ssd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 53439651, "answer_count": 1, "score": -1, "last_activity_date": 1542936184, "creation_date": 1542792816, "question_id": 53408985, "link": "https://stackoverflow.com/questions/53408985/getting-screen-resolution-in-c-w-o-windows-h", "title": "Getting screen resolution in C, w/o &quot;windows.h&quot;", "body": "<p>Just working on a small project using SDL2...</p>\n\n<p><strong>System info</strong>: Windows</p>\n\n<p><strong>App info</strong>: using C (pure C, no c++), mingw-x64 &amp; SDL2.</p>\n\n<p>Now;</p>\n\n<p>Firstly, <code>SDL.h</code> requires the <code>main</code> function to be renamed as <code>WinMain</code>.</p>\n\n<p>On the other hand, when getting the screen resolution, I tended to use the <code>GetSystemMetrics</code> function, which requires <code>windows.h</code> to be included in the pre-processor section and at this point, <code>WinMain</code> in my code conflicts with <code>WinMain</code> declared previously in <code>winbase.h</code>. When I'm using both (<code>SDL.h</code> and <code>windows.h</code>), compiler responds:</p>\n\n<blockquote>\n  <p>previous declaration of 'WinMain' was here: <code>int WINAPI WinMain (HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd);</code></p>\n</blockquote>\n\n<p>That's because, <code>WinMain</code> is declared somewhere in the <code>winbase.h</code>, which is auto-included via <code>windows.h</code>.</p>\n\n<p>Is there a way to get the screen resolution w/o using <code>GetSystemMetrics</code> / <code>windows.h</code>? Any other ideas?</p>\n"}, {"tags": ["c", "pointers", "casting"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 2, "creation_date": 1542792771, "post_id": 53408931, "comment_id": 93692821, "body": "<code>int</code> is probably 32 bit therefore the range is <code>-2147483648</code> to <code>2147483647</code>."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 3, "creation_date": 1542792831, "post_id": 53408931, "comment_id": 93692856, "body": "&quot;<i>int range is (-32768 to 32767).</i>&quot; Try this: <code>printf(&quot;min: %d max %d\\n&quot;, INT_MIN, INT_MAX);</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1542792833, "post_id": 53408931, "comment_id": 93692858, "body": "For printing a pointer value you need to do this: <code>printf(&quot;pointer = %p\\n&quot;, (void*)&amp;somevariable);</code>.  The <code>%p</code> and the <code>(void*)</code> are mandatory, anything else is <i>undefined behaviour</i> (google that term)."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1542793136, "post_id": 53408931, "comment_id": 93693048, "body": "What makes you think <i>&quot;int range is (-32768 to 32767)&quot;</i>? What is your platform?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1542793254, "post_id": 53408931, "comment_id": 93693129, "body": "Possible duplicate: <a href=\"https://stackoverflow.com/q/6155784/694733\">Range of values in C Int and Long 32 - 64 bits</a>? It&#39;s not strictly about pointers, but the same issue."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1542793481, "post_id": 53408931, "comment_id": 93693281, "body": "That said, <code>printf(&quot;unsighed Address of i = %u \\n&quot;,(unsigned int)&amp;i);</code> is implementation defined behaviour."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10602769, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sb0Sk4R9KH0/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBCyTntY_ZBE6lXbeVieWH3yHn55Q/mo/photo.jpg?sz=128", "display_name": "KRISHNA I", "link": "https://stackoverflow.com/users/10602769/krishna-i"}, "edited": false, "score": 0, "creation_date": 1542794151, "post_id": 53409247, "comment_id": 93693677, "body": "Yeah what you said is correct. My system allocates 4 bytes for integer. Just checked it. So is -107505156 a garbage value? Usually when integer value exceeds bounds then it enters loop from negative end. Like int a = 2147483647. Then a+2 will be -2147483647 right?"}, {"owner": {"reputation": 3879, "user_id": 7371784, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/78e670334411962158df4d1ac6803ac9?s=128&d=identicon&r=PG&f=1", "display_name": "Kristjan Kica", "link": "https://stackoverflow.com/users/7371784/kristjan-kica"}, "reply_to_user": {"reputation": 57, "user_id": 10602769, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sb0Sk4R9KH0/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBCyTntY_ZBE6lXbeVieWH3yHn55Q/mo/photo.jpg?sz=128", "display_name": "KRISHNA I", "link": "https://stackoverflow.com/users/10602769/krishna-i"}, "edited": false, "score": 0, "creation_date": 1542794591, "post_id": 53409247, "comment_id": 93693944, "body": "Yes USUALLY. a+1 would be -2147483648, and a+2 would be -2147483647."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 2, "creation_date": 1542794619, "post_id": 53409247, "comment_id": 93693962, "body": "According to the standard integer overflow results in undefined behavior."}], "tags": [], "owner": {"reputation": 3879, "user_id": 7371784, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/78e670334411962158df4d1ac6803ac9?s=128&d=identicon&r=PG&f=1", "display_name": "Kristjan Kica", "link": "https://stackoverflow.com/users/7371784/kristjan-kica"}, "is_accepted": false, "score": 1, "last_activity_date": 1542793673, "creation_date": 1542793673, "answer_id": 53409247, "question_id": 53408931, "link": "https://stackoverflow.com/questions/53408931/cast-of-int-unsigned-int-for-pointers-in-c/53409247#53409247", "title": "cast of int,unsigned int for pointers in c", "body": "<p>Where do you base <code>int range is (-32768 to 32767)</code>? That implies that the size is 2 bytes.\nI don't think that is the case, since <code>-1075051656</code> is an <code>int</code> (you converted the address to <code>int</code>).</p>\n\n<p>To check the size of an <code>int</code> use <code>sizeof(int)</code>, or to find the interval of values it represents, use <code>INT_MIN, INT_MAX</code> constants.</p>\n\n<p>The size of <code>int</code> in your system is probably 4 bytes (32 bits), with interval <code>-2147483648</code> to <code>2147483647</code>. With <code>unsigned int</code> it is from <code>0 to 4,294,967,295</code>.</p>\n\n<p>Therefore you can print the value using <code>unsigned int</code>, but it overflows when converting to <code>int</code> since  <code>4294967295 &gt; 3219915640 &gt; 2147483647</code></p>\n"}, {"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1542796945, "post_id": 53409249, "comment_id": 93695347, "body": "Note that correct specifier for printing <code>uintptr_t</code> is <code>PRIuPTR</code>, not <code>lu</code>."}], "tags": [], "owner": {"reputation": 2361, "user_id": 5809597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d43b1c037d08a423aeb6ee10fc922437?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Bellon", "link": "https://stackoverflow.com/users/5809597/jorge-bellon"}, "is_accepted": true, "score": 1, "last_activity_date": 1542808539, "last_edit_date": 1542808539, "creation_date": 1542793677, "answer_id": 53409249, "question_id": 53408931, "link": "https://stackoverflow.com/questions/53408931/cast-of-int-unsigned-int-for-pointers-in-c/53409249#53409249", "title": "cast of int,unsigned int for pointers in c", "body": "<p>If you want to cast a pointer value to an integer type, you should use <code>intptr_t</code> or <code>uintptr_t</code>, which warrantee that the integer is big enough to hold any possible pointer value.</p>\n\n<p>You may be compiling your code for a 32bit architecture, or you may be lucky enough so that your stack is located in the lower area of the address space (although this is unlikely), so that in your execution the most significant bits of the address are 0.</p>\n\n<p>See <a href=\"https://en.cppreference.com/w/c/types/integer\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/c/types/integer</a></p>\n\n<p>Code (<a href=\"https://ideone.com/2NDYnP\" rel=\"nofollow noreferrer\">https://ideone.com/2NDYnP</a>):</p>\n\n<pre><code>#include &lt;stdio.h&gt;    // printf\n#include &lt;stdint.h&gt;   // intptr_t, uintptr_t\n#include &lt;inttypes.h&gt; // PRIdPTR, PRIuPTR\n\nint main() {\n    int i=3;\n    // Incorrect\n    printf(\"unsighed value of &amp;i = %u \\n\",(unsigned int)&amp;i);\n    printf(\"int value of &amp;i = %d\\n\",(int)&amp;i);\n\n    // Correct\n    printf(\"pointer Address of i = %p\\n\",&amp;i);\n    printf(\"uintptr_t value of &amp;i = %\"PRIuPTR\"\\n\", (uintptr_t)&amp;i);\n    printf(\"intptr_t value of &amp;i = %\"PRIdPTR\"\\n\", (intptr_t)&amp;i);\n\n    printf(\"Value of i = %d\\n\",i);\n\n    return 0;\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>unsighed value of &amp;i = 3131233804 \nint value of &amp;i = -1163733492\npointer Address of i = 0x7fffbaa2d60c\nuintptr_t value of &amp;i = 140736324621836\nintptr_t value of &amp;i = 140736324621836\nValue of i = 3\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 10602769, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sb0Sk4R9KH0/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBCyTntY_ZBE6lXbeVieWH3yHn55Q/mo/photo.jpg?sz=128", "display_name": "KRISHNA I", "link": "https://stackoverflow.com/users/10602769/krishna-i"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 0, "accepted_answer_id": 53409249, "answer_count": 2, "score": 0, "last_activity_date": 1542808539, "creation_date": 1542792633, "last_edit_date": 1542792987, "question_id": 53408931, "link": "https://stackoverflow.com/questions/53408931/cast-of-int-unsigned-int-for-pointers-in-c", "title": "cast of int,unsigned int for pointers in c", "body": "<p>I am new to pointers in C. Please help me with following code:</p>\n\n<pre><code>void main()\n{\n    int i=3;\n    printf(\"unsighed Address of i = %u \\n\",(unsigned int)&amp;i);\n    printf(\"int Address of i = %d\\n\",(int)&amp;i);\n    printf(\"pointer Address of i = %p\\n\",&amp;i);\n    printf(\"Value of i = %d\\n\",i);\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre class=\"lang-none prettyprint-override\"><code>unsighed Address of i = 3219915640 \nint Address of i = -1075051656\npointer Address of i = 0xbfec0378\nValue of i = 3\n</code></pre>\n\n<p>As you can see, I am just checking address of <code>i</code> through <code>int</code>, <code>unsigned int</code>, and pointer. Unsigned and pointer values are same (0xbfec0378 of base16 = 3219915640 of base10). \nBut integer value is different. int range is (-32768 to 32767). So I don't know how I got -1075051656. Can you explain this.</p>\n"}, {"tags": ["c", "bit", "bit-shift"], "comments": [{"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1542791811, "post_id": 53408589, "comment_id": 93692258, "body": "I&#39;m not sure where you get that <code>unsigned int</code> is exactly 1 byte. It isn&#39;t. It&#39;s at least 2 bytes and almost always 4. You can check with <code>sizeof(unsigned int)</code>"}, {"owner": {"reputation": 160, "user_id": 6594779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847c25720c1e7423a97c7894b530bfa4?s=128&d=identicon&r=PG&f=1", "display_name": "svtag", "link": "https://stackoverflow.com/users/6594779/svtag"}, "edited": false, "score": 0, "creation_date": 1542791820, "post_id": 53408589, "comment_id": 93692262, "body": "int is 32-bit, not 8bit."}, {"owner": {"reputation": 4837, "user_id": 9769953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f14a586643a20c8d68010f7a329f5a04?s=128&d=identicon&r=PG", "display_name": "0 0", "link": "https://stackoverflow.com/users/9769953/0-0"}, "edited": false, "score": 0, "creation_date": 1542791835, "post_id": 53408589, "comment_id": 93692277, "body": "&quot;unsigned int is exactly 1 byte&quot;: that seems highly unlikely; your premise might be wrong here. What is your platform (OS, hardware) that you are running on? See also <a href=\"https://stackoverflow.com/questions/11438794/is-the-size-of-c-int-2-bytes-or-4-bytes\" title=\"is the size of c int 2 bytes or 4 bytes\">stackoverflow.com/questions/11438794/&hellip;</a>"}, {"owner": {"reputation": 160, "user_id": 6594779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847c25720c1e7423a97c7894b530bfa4?s=128&d=identicon&r=PG&f=1", "display_name": "svtag", "link": "https://stackoverflow.com/users/6594779/svtag"}, "edited": false, "score": 4, "creation_date": 1542791899, "post_id": 53408589, "comment_id": 93692319, "body": "If you want 1byte memory, better to use <code>uint8_t</code> or <code>int8_t</code> data type, it is defined in header <code>stdint.h</code>."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1542792518, "post_id": 53408589, "comment_id": 93692689, "body": "@DanielH Actually, it <i>can</i> be... Once worked on a 16-bit DSP with CHAR_BIT == 16 and sizeof(int) == sizeof(char) == 1..."}, {"owner": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "reply_to_user": {"reputation": 160, "user_id": 6594779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847c25720c1e7423a97c7894b530bfa4?s=128&d=identicon&r=PG&f=1", "display_name": "svtag", "link": "https://stackoverflow.com/users/6594779/svtag"}, "edited": false, "score": 1, "creation_date": 1542792721, "post_id": 53408589, "comment_id": 93692796, "body": "@svtag not always, don&#39;t make that assumption."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1542793264, "post_id": 53408589, "comment_id": 93693136, "body": "@Aconcagua I thought of that, but decided it wasn&#39;t worth mentioning here. I don&#39;t know standard DSP terminology, but from outside that area you could at least make an argument that it has a two-byte <code>char</code> and the word &quot;byte&quot; has specifically come to mean eight bits. To be more precise, <code>unsigned int</code> must be at least 16 bits (assuming the underlying storage mechanism is even binary; the actual definition is in terms of maximum value) and is usually 32 on modern systems."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1542793785, "post_id": 53408589, "comment_id": 93693476, "body": "@DanielH It&#39;s a matter of definition: &quot;byte&quot; == 8-bit vs. &quot;byte&quot; == smallest addressable data unit (which on most systems is the same...). By the way: Standard does not speak of bits at all, only that unsigned int has to be capable to hold at least the values from 0 up to 65535. If you somehow happened to manage to pack these into less than 16 bit, it would still be valid..."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1542794501, "post_id": 53408589, "comment_id": 93693889, "body": "@Aconcagua I said the standard was defined in terms of maximum value. If you use a binary computer you can&#39;t squeeze that many values into less than 16 bits, but if your computer is decimal instead, you can use 5 digits instead. Although now that I think about it, other parts of the standard do depend on individual bits, so that might not be possible."}], "answers": [{"tags": [], "owner": {"reputation": 3879, "user_id": 7371784, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/78e670334411962158df4d1ac6803ac9?s=128&d=identicon&r=PG&f=1", "display_name": "Kristjan Kica", "link": "https://stackoverflow.com/users/7371784/kristjan-kica"}, "is_accepted": false, "score": 0, "last_activity_date": 1542792349, "last_edit_date": 1542792349, "creation_date": 1542791647, "answer_id": 53408647, "question_id": 53408589, "link": "https://stackoverflow.com/questions/53408589/i-dont-understand-the-behaviour-of-bitshifting-in-this-example/53408647#53408647", "title": "I dont understand the behaviour of bitshifting in this example", "body": "<p><code>0x30</code> is hex and  <code>0000000000110000</code> in binary. If you shift 4 bits, you get your result <code>0x300</code> or  <code>0000001100000000</code>.</p>\n\n<p>To respond to your edit, <code>unsigned int</code> does not take 1 <code>byte</code>. It takes the same number of bytes as an <code>int</code> does. Which in your case it is probably 4 bytes or 32 bits. </p>\n\n<p>The reason the number is shown with 2 or 3 <code>hex</code> digits, its because the 0-s in the beginning are not printed. But the number is in fact <code>0030(hex)</code> .</p>\n\n<p>Anyway, you can check the size using <code>sizeof</code>.</p>\n\n<p>EDIT: If you want to take 1 byte, see Rishikesh answer.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10557161"}, "edited": false, "score": 0, "creation_date": 1542792398, "post_id": 53408730, "comment_id": 93692620, "body": "Originally I used uint8 in my program thinking that it&#39;s the same as uint8_t.I guess that was my first mistake."}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 1, "creation_date": 1542792666, "post_id": 53408730, "comment_id": 93692759, "body": "it depends, in some systems/projects <code>uint8</code> is typecast as <code>uint8_t</code> and used. But the C standard is <code>uint8_t</code>"}], "tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": true, "score": 3, "last_activity_date": 1542795732, "last_edit_date": 1542795732, "creation_date": 1542791932, "answer_id": 53408730, "question_id": 53408589, "link": "https://stackoverflow.com/questions/53408589/i-dont-understand-the-behaviour-of-bitshifting-in-this-example/53408730#53408730", "title": "I dont understand the behaviour of bitshifting in this example", "body": "<p><code>a</code> is an <code>int</code> which is (usually) 32 bits long. </p>\n\n<p>The value of <code>0x300</code> is expected for an <code>int</code>.</p>\n\n<p>Even if you use a <code>uint8_t</code> for <code>a</code> you need to typecast the result back to <code>uint8_t</code> to see the expected result. </p>\n\n<pre><code>int main(void){\n  uint8_t a;\n  scanf(\"%hhx\",&amp;a);  // you need hhx to read unsigned char (C99 only) \n  printf(\"%hhx\",(uint8_t) (a&lt;&lt;4));\n}\n</code></pre>\n\n<p>For your information, if you do not typecast, the value <code>a&lt;&lt;4</code> will be promoted to <code>int</code> and <code>0x300</code> will be displayed</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10557161"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 53408730, "answer_count": 2, "score": 2, "last_activity_date": 1542795732, "creation_date": 1542791439, "question_id": 53408589, "link": "https://stackoverflow.com/questions/53408589/i-dont-understand-the-behaviour-of-bitshifting-in-this-example", "title": "I dont understand the behaviour of bitshifting in this example", "body": "<p>I understand that shifting means moving each bit to the left or right respectively,but when I try to shift 0x30 by 4 positions to the left I get 0x300 or 00110000000 in binary.(my desired output would be 0000 0000 ).Why does it behave this way?\nMy code in C:</p>\n\n<pre><code>int main(void){\n unsigned int a;\n scanf(\"%x\",&amp;a);\n printf(\"%b\",a&lt;&lt;4);\n}\n</code></pre>\n\n<p>Input:30\nOutput:300\nExpected output:0\nEdit:I would expect this output if I use more than 1 byte for my assigned variable ,but unsigned int is exactly 1 byte and 0x300 is 12 bits.</p>\n"}, {"tags": ["c++", "c", "openssl", "x509certificate", "pkcs#7"], "answers": [{"comments": [{"owner": {"reputation": 3214, "user_id": 4333809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb246fedefccc8b02a3efb989143d3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar81", "link": "https://stackoverflow.com/users/4333809/zohar81"}, "edited": false, "score": 0, "creation_date": 1543129699, "post_id": 53453578, "comment_id": 93801622, "body": "Hi and thanks a lot for you response. I&#39;ve read carefully throw the article you provided, but I still cannot figure out how should we detect if one of the certificates in the chain is revoked (not the root one). The store contains only list of root certificates, so it must be that the pkcs7_verify get this information otherwise ... perhaps you can elaborate some theoretically explanation as well ? thanks again !"}, {"owner": {"reputation": 387, "user_id": 8436917, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yUuvQL44b4w/AAAAAAAAAAI/AAAAAAAAARU/wDx-W1CC1vk/photo.jpg?sz=128", "display_name": "Lucas Martins", "link": "https://stackoverflow.com/users/8436917/lucas-martins"}, "reply_to_user": {"reputation": 3214, "user_id": 4333809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb246fedefccc8b02a3efb989143d3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar81", "link": "https://stackoverflow.com/users/4333809/zohar81"}, "edited": false, "score": 0, "creation_date": 1543145380, "post_id": 53453578, "comment_id": 93804666, "body": "The X509_STORE also contains the CRLs to be used in the validation and the lookup functions to look up for CRLs. I updated the answer to point that."}], "tags": [], "owner": {"reputation": 387, "user_id": 8436917, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yUuvQL44b4w/AAAAAAAAAAI/AAAAAAAAARU/wDx-W1CC1vk/photo.jpg?sz=128", "display_name": "Lucas Martins", "link": "https://stackoverflow.com/users/8436917/lucas-martins"}, "is_accepted": true, "score": 1, "last_activity_date": 1543144178, "last_edit_date": 1543144178, "creation_date": 1543012762, "answer_id": 53453578, "question_id": 53408547, "link": "https://stackoverflow.com/questions/53408547/using-openssl-to-check-if-root-certificate-in-pkcs7-is-revoked/53453578#53453578", "title": "Using openssl to check if root certificate in PKCS#7 is revoked", "body": "<p>Most of the rules of the certification path validation is set in the <code>X509_STORE</code> structure you are passing to the <code>PKCS7_verify</code> function.</p>\n\n<p><s><a href=\"http://itsjustsosimple.blogspot.com/2017/05/openssl-how-to-verifying-certificate.html\" rel=\"nofollow noreferrer\">This example</a> show how to build a complete X509_STORE and explain how to activate the CRL validation in the X509_STORE.</s> (the example is good for setting up the crl validation but not for the certificate chain handling)</p>\n\n<p>The core functions are:</p>\n\n<ul>\n<li><code>X509_STORE_set_flags</code></li>\n<li><code>X509_STORE_add_crl</code> </li>\n<li><code>X509_STORE_add_lookup</code></li>\n</ul>\n\n<p>You use the <code>X509_STORE_set_flags</code> to tell the certificate store to perform CRL validation. The flags you need are: <code>X509_V_FLAG_CRL_CHECK_ALL | X509_V_FLAG_CRL_CHECK</code>. You can find all flags <a href=\"https://www.openssl.org/docs/man1.1.0/crypto/X509_VERIFY_PARAM_set_depth.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>You use the<code>X509_STORE_add_crl</code> to add CRLs for the validation. The CRL doesn't need to be from a root CA.</p>\n\n<p>As an option to the<code>X509_STORE_add_crl</code>, you have the <code>X509_STORE_add_lookup</code>, to add a function to lookup for CRLs in any place (e.g.: file system, database, urls, etc.).</p>\n\n<p>When performing the chain validation, OpenSSl will use the CRLs and lookup functions in the X509_STORE to validate all certificates in the chain. If any certificate in the chain is revoked, an error is returned.</p>\n\n<p>It's important to add that <a href=\"https://tools.ietf.org/html/rfc5280#section-6\" rel=\"nofollow noreferrer\">the X.509 certification path validation</a> specification doesn't include the validation of trust anchors (usually root certificates). All certificates in the chain under the trust anchor have to be verified, but the trust anchor is trusted because the verifier set it as so (i.e.: the trust anchor validation is made out-of-bounds by the verifier).</p>\n"}], "owner": {"reputation": 3214, "user_id": 4333809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb246fedefccc8b02a3efb989143d3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar81", "link": "https://stackoverflow.com/users/4333809/zohar81"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 2, "accepted_answer_id": 53453578, "answer_count": 1, "score": 1, "last_activity_date": 1543144178, "creation_date": 1542791277, "last_edit_date": 1542911042, "question_id": 53408547, "link": "https://stackoverflow.com/questions/53408547/using-openssl-to-check-if-root-certificate-in-pkcs7-is-revoked", "title": "Using openssl to check if root certificate in PKCS#7 is revoked", "body": "<p>Here's <code>pkcs7_verify</code> signature taken from C/C++ library: </p>\n\n<pre><code>int PKCS7_verify(PKCS7 *p7, STACK_OF(X509) *certs, X509_STORE *store,\n             BIO *indata, BIO *out, int flags);\n</code></pre>\n\n<p>It can be used with PKCS7 block (p7) and the section that it suppose to sign (in data). </p>\n\n<p>I wonder how does this check detect if one of the certificate in the chain is revoked...</p>\n\n<p>From what I know, revocation check can be made only if matching against another certificate outside the pkcs7 block, which is marked as revoked.</p>\n\n<p>I checked the function arguments and found one that represent the list of store trusted certificates. </p>\n\n<p>This arg should hold the certificate which is the issuer of the lower-most certificate in the pkcs7 chain. So my guess is that if this certificate is marked as revoked, we fail the check on <code>revocation</code> reason... </p>\n\n<p>But what if another certificate higher in the chain is revoked ? how do I provide this piece of information to <code>pkcs7_verify</code> ?</p>\n\n<p>Or perhaps there's another openssl method that decide if a certificate in the chain is revoked or not ?</p>\n\n<p>UPDATE: </p>\n\n<p>I've found an alternative way to check whether a certificate is revoked. In the example below we can see that <code>revoked_test.pem</code> is identified as revoked by matching against the list in <code>crl_chain.pem</code>. How can I do it programmatically ? </p>\n\n<pre><code>openssl verify -crl_check -CAfile crl_chain.pem revoked-test.pem \nrevoked-test.pem: OU = Domain Control Validated, OU = PositiveSSL, CN = xs4all.nl\nerror 23 at 0 depth lookup:certificate revoked\n</code></pre>\n\n<p>thanks </p>\n"}, {"tags": ["c", "pointers", "matrix", "memory-management", "struct"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 1, "creation_date": 1542791333, "post_id": 53408525, "comment_id": 93691980, "body": "did you forgot to pass <code>size</code> to     <code>Initialize(structs);</code>? It should give compilation error or warning."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1542791356, "post_id": 53408525, "comment_id": 93691991, "body": "The code you show looks fine (assuming you pass the arguments you&#39;re supposed to pass), so the problem is probably in the code you <i>don&#39;t</i> show. Try to use a memory debugger such a <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\">Valgrind</a> (or similar) to find out if you&#39;re having some problems with out-of-bounds access or similar."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1542791437, "post_id": 53408525, "comment_id": 93692038, "body": "Oh and in C you <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc/605858#605858\">should not cast the result of <code>malloc</code></a>."}, {"owner": {"reputation": 159, "user_id": 2347708, "user_type": "registered", "profile_image": "https://graph.facebook.com/1109109309/picture?type=large", "display_name": "Borja Sanchidri&#225;n Monge", "link": "https://stackoverflow.com/users/2347708/borja-sanchidri%c3%a1n-monge"}, "edited": false, "score": 0, "creation_date": 1542791475, "post_id": 53408525, "comment_id": 93692057, "body": "Yeah, forgot to add the <code>size</code> variable, it&#39;s just an example anyways. The only real difference with the real code it&#39;s that the <code>structs</code> defined inside main it&#39;s a static global variable, does that change anything?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1542791483, "post_id": 53408525, "comment_id": 93692062, "body": "And please read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>. Lastly try to create an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of the failing code to show us."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1542794197, "post_id": 53408525, "comment_id": 93693699, "body": "Or you <a href=\"https://stackoverflow.com/a/14879184/1312382\">should cast</a>? Admitted, a minority oppinion, but too large just to be ignored. My recommendation now always is: read both and make up <i>your own mind</i>..."}], "answers": [{"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 1, "last_activity_date": 1542793127, "last_edit_date": 1542793127, "creation_date": 1542792622, "answer_id": 53408928, "question_id": 53408525, "link": "https://stackoverflow.com/questions/53408525/initialize-matrix-double-pointer-member-of-struct/53408928#53408928", "title": "Initialize matrix (double pointer) member of struct", "body": "<p>You do not need global variables here. So, you could declare, define and initialize the size of your struct array, as well as the dimensions of your matrices in the main method.</p>\n\n<p>Moreover, your methods' names are misleading, I changed them to something that communicates to the author what every function's purpose is. Or, more accurately your methods do more than one tasks. It's good to divide tasks for reusability.</p>\n\n<p>Here is a minimal example to get you started:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nstruct MyStruct\n{\n    double **matrix;\n};\n\ndouble **allocate_matrix(int rows, int cols)\n{\n    double **matrix = malloc(rows * sizeof(double*));\n    for (int i = 0; i &lt; rows; i++)\n        matrix[i] = malloc(cols * sizeof(double));\n    return matrix;\n}\n\nvoid allocate_matrices(struct MyStruct *structs, int size, int rows, int cols)\n{\n    for (int i = 0; i &lt; size; i++)\n        structs[i].matrix = allocate_matrix(rows, cols);\n}\n\nvoid fill_matrices(struct MyStruct *structs, int size, int rows, int cols)\n{\n    for (int i = 0; i &lt; size; i++)\n        for(int j = 0; j &lt; rows; j++)\n            for(int z = 0; z &lt; cols; z++)\n                structs[i].matrix[j][z] = -1.2;\n}\n\nvoid print_matrices(struct MyStruct *structs, int size, int rows, int cols)\n{\n    for (int i = 0; i &lt; size; i++)\n        for(int j = 0; j &lt; rows; j++)\n            for(int z = 0; z &lt; cols; z++)\n                printf(\"%f\\n\", structs[i].matrix[j][z]);\n}\n\nvoid free_matrices(struct MyStruct *structs, int size, int rows) {\n    for (int i = 0; i &lt; size; i++) {\n        for(int j = 0; j &lt; rows; j++) {\n            free(structs[i].matrix[j]);\n        }\n        free(structs[i].matrix);\n    }\n}\n\n\nint main()\n{\n    int rows = 3, cols = 4, size = 2;\n    struct MyStruct *structs = malloc(size * sizeof(struct MyStruct));\n    structs[0].matrix = NULL;\n    structs[1].matrix = NULL;\n    if(structs[0].matrix == NULL)\n        printf(\"null\\n\");\n    allocate_matrices(structs, size, rows, cols);\n    if(structs[0].matrix == NULL)\n        printf(\"null\\n\");\n    fill_matrices(structs, size, rows, cols);\n    print_matrices(structs, size, rows, cols);\n    free_matrices(structs, size, rows);\n    free(structs);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>null\n-1.200000\n-1.200000\n-1.200000\n-1.200000\n-1.200000\n-1.200000\n-1.200000\n-1.200000\n-1.200000\n-1.200000\n-1.200000\n-1.200000\n-1.200000\n-1.200000\n-1.200000\n-1.200000\n-1.200000\n-1.200000\n-1.200000\n-1.200000\n-1.200000\n-1.200000\n-1.200000\n-1.200000\n</code></pre>\n\n<p>Inspired from my <a href=\"https://gsamaras.wordpress.com/code/2d-dynamic-array-c/\" rel=\"nofollow noreferrer\">2D dynamic array (C)</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": false, "score": 0, "last_activity_date": 1542794877, "creation_date": 1542794877, "answer_id": 53409633, "question_id": 53408525, "link": "https://stackoverflow.com/questions/53408525/initialize-matrix-double-pointer-member-of-struct/53409633#53409633", "title": "Initialize matrix (double pointer) member of struct", "body": "<p>Extending <a href=\"https://stackoverflow.com/users/2411320/gsamaras\">gsamaras</a>' <a href=\"https://stackoverflow.com/a/53408928/1312382\">answer</a>:</p>\n\n<p><em>'You do not need global variables here'</em> is truth. Still, having constants <code>ROWS</code> and <code>COLS</code> <em>can</em> be meaningful as well. It depends on the use case!</p>\n\n<p>gsamaras' approach allowes you to define individual sizes for each matrix. If you want to <em>enforce</em> same size for all matrices created, it is less error prone not to have parameters for but constants instead.</p>\n"}], "owner": {"reputation": 159, "user_id": 2347708, "user_type": "registered", "profile_image": "https://graph.facebook.com/1109109309/picture?type=large", "display_name": "Borja Sanchidri&#225;n Monge", "link": "https://stackoverflow.com/users/2347708/borja-sanchidri%c3%a1n-monge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 53408928, "answer_count": 2, "score": 2, "last_activity_date": 1542794877, "creation_date": 1542791177, "last_edit_date": 1542792693, "question_id": 53408525, "link": "https://stackoverflow.com/questions/53408525/initialize-matrix-double-pointer-member-of-struct", "title": "Initialize matrix (double pointer) member of struct", "body": "<p>I'm having a rough time with pointers, can someone help me a little bit?</p>\n\n<p>I'm trying to initialize a double (double) pointer inside a struct array, but I'm somehow doing it wrong.. Example:</p>\n\n<pre><code>struct MyStruct\n{\n    double **matrix;\n};\n\ndouble **CalculateMatrix(...)\n{\n    double **matrix = (double**)malloc(ROWS * sizeof(double*));\n    for (int i = 0; i &lt; ROWS; i++)\n        matrix[i] = (double*)malloc(COLS * sizeof(double));\n    // + assign some values\n    return matrix;\n}\n\nvoid Initialize(struct MyStruct *structs, int size)\n{\n    for (int i = 0; i &lt; size; i++)\n        // Here structs[i].matrix holds the correct matrix values\n        structs[i].matrix = CalculateMatrix(...);\n}\n\nint main()\n{\n    struct MyStruct *structs = (struct MyStruct*)malloc(SIZE * sizeof(struct MyStruct));\n    Initialize(structs, SIZE);\n    // but once the function returns, matrix values are completely different\n}\n</code></pre>\n\n<p>Sorry if it's duplicated, I couldn't find anything </p>\n"}, {"tags": ["c", "static"], "answers": [{"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1542791830, "post_id": 53408559, "comment_id": 93692266, "body": "This doesn&#39;t answer the question, which was about declaration and definition having mismatching linkage specifiers."}, {"owner": {"reputation": 129, "user_id": 5410078, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FkN0h.jpg?s=128&g=1", "display_name": "MFrancone", "link": "https://stackoverflow.com/users/5410078/mfrancone"}, "edited": false, "score": 0, "creation_date": 1542811926, "post_id": 53408559, "comment_id": 93703754, "body": "exactly, my question was related to definition and declaration."}], "tags": [], "owner": {"reputation": 394, "user_id": 3264375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc3958029becfe0d27b76e56aa3371c3?s=128&d=identicon&r=PG", "display_name": "erenbasturk", "link": "https://stackoverflow.com/users/3264375/erenbasturk"}, "is_accepted": false, "score": 0, "last_activity_date": 1542791315, "creation_date": 1542791315, "answer_id": 53408559, "question_id": 53408514, "link": "https://stackoverflow.com/questions/53408514/is-static-keyword-necessary-both-in-functions-prototype-and-definition-in-c/53408559#53408559", "title": "Is static keyword necessary both in functions&#39; prototype and definition in C?", "body": "<p>In C whole functions have default external linkage. If you use static keyword for the function. It changes the linkage from external linkage to internal internal linkage. You can use \"static\" keyword for the function to be available for just the file which is defined in. That's all. </p>\n\n<pre><code>static void foo(void); // internal linkage\n\nvoid foo(void);        // external linkage\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 7124010, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/16c3a990c698b3bf4f12913333d88c8d?s=128&d=identicon&r=PG", "display_name": "tamir", "link": "https://stackoverflow.com/users/7124010/tamir"}, "is_accepted": false, "score": 0, "last_activity_date": 1542791364, "creation_date": 1542791364, "answer_id": 53408568, "question_id": 53408514, "link": "https://stackoverflow.com/questions/53408514/is-static-keyword-necessary-both-in-functions-prototype-and-definition-in-c/53408568#53408568", "title": "Is static keyword necessary both in functions&#39; prototype and definition in C?", "body": "<p>Your usage is perfectly OK. <code>foo</code> will be known only in the current source file being compiled.</p>\n"}, {"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 2, "last_activity_date": 1542791818, "creation_date": 1542791818, "answer_id": 53408691, "question_id": 53408514, "link": "https://stackoverflow.com/questions/53408514/is-static-keyword-necessary-both-in-functions-prototype-and-definition-in-c/53408691#53408691", "title": "Is static keyword necessary both in functions&#39; prototype and definition in C?", "body": "<blockquote>\n  <p>has the foo only an internal linkage or such usage is incorrect?</p>\n</blockquote>\n\n<p><a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.2p4\" rel=\"nofollow noreferrer\">6.2.2 Linkage of identifier</a> states:</p>\n\n<blockquote>\n  <p>For an identifier declared with the storage-class specifier extern in a scope in which a prior declaration of that identifier is visible,31) if the prior declaration specifies internal or external linkage, the linkage of the identifier at the later declaration is the same as the linkage specified at the prior declaration. </p>\n</blockquote>\n\n<p>When the <code>foo</code> definition says it has external linkage (functions have external linkage if none specified explicitly<sup>1</sup>) and at that point, there was a prior declaration of <code>foo</code> with internal linkage is visible. So <code>foo</code> has internal linkage.</p>\n\n<p><a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.2p5\" rel=\"nofollow noreferrer\"><sup>1</sup></a>: </p>\n\n<blockquote>\n  <p>If the declaration of an identifier for a function has no storage-class specifier, its linkage is determined exactly as if it were declared with the storage-class specifier extern. If the declaration of an identifier for an object has file scope and no storage-class specifier, its linkage is external. </p>\n</blockquote>\n"}], "owner": {"reputation": 129, "user_id": 5410078, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FkN0h.jpg?s=128&g=1", "display_name": "MFrancone", "link": "https://stackoverflow.com/users/5410078/mfrancone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 53408691, "answer_count": 3, "score": 4, "last_activity_date": 1542791818, "creation_date": 1542791128, "last_edit_date": 1542791547, "question_id": 53408514, "link": "https://stackoverflow.com/questions/53408514/is-static-keyword-necessary-both-in-functions-prototype-and-definition-in-c", "title": "Is static keyword necessary both in functions&#39; prototype and definition in C?", "body": "<p>I read in <a href=\"https://stackoverflow.com/a/15670259/5410078\">this post</a> how to use <code>static</code> specifier for functions in C, but I did not understand if it is necessary to use it both in a function's prototype and definition or it can be omitted in the definition. For example, in this case:</p>\n\n<pre><code>static void foo(void);\n\nvoid foo() {...}\n</code></pre>\n\n<p>has the <code>foo</code> only an <em>internal linkage</em> or such usage is incorrect?</p>\n"}, {"tags": ["c", "sockets", "raspberry-pi", "raspbian"], "comments": [{"owner": {"reputation": 1400, "user_id": 3287591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec170ce77ff19649edf457377421bb8?s=128&d=identicon&r=PG", "display_name": "Giovanni Cerretani", "link": "https://stackoverflow.com/users/3287591/giovanni-cerretani"}, "edited": false, "score": 0, "creation_date": 1542790492, "post_id": 53408016, "comment_id": 93691475, "body": "That is C code. Why do you say C/C++?"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1542790857, "post_id": 53408016, "comment_id": 93691695, "body": "It&#39;s possible you&#39;re hitting a <a href=\"https://en.wikipedia.org/wiki/Rate_limiting\" rel=\"nofollow noreferrer\">rate limit</a> on the web server you&#39;re contacting. Try sending the requests slower (eg. add a sleep between subsequent requests)."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1542791108, "post_id": 53408016, "comment_id": 93691849, "body": "Did you verify the content of your packets with Wireshark?"}], "answers": [{"tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": true, "score": 0, "last_activity_date": 1542791370, "creation_date": 1542791370, "answer_id": 53408571, "question_id": 53408016, "link": "https://stackoverflow.com/questions/53408016/503-service-temporarily-unavailable/53408571#53408571", "title": "503 - Service temporarily unavailable", "body": "<p>You provide a full URI to the <code>GET</code> field:</p>\n\n<pre><code>char *page = \"http://plankter.cz/iot/list.json\";\n...\nsnprintf(sendline, MAXSUB,\n            \"GET %s\\r\\n\"\n            \"Host: %s\\r\\n\"\n            \"Connection: close\\n\"\n            \"\\n\", page, host);\n</code></pre>\n\n<p>You should not include protocol and host name.</p>\n\n<p>Try this instead:</p>\n\n<pre><code>char *page = \"/iot/list.json\";\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10684584, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-A01l-0QOb8o/AAAAAAAAAAI/AAAAAAAAAHc/_mzZzfqHc7U/photo.jpg?sz=128", "display_name": "Radek \u010cudek", "link": "https://stackoverflow.com/users/10684584/radek-%c4%8cudek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 53408571, "answer_count": 1, "score": 1, "last_activity_date": 1542798192, "creation_date": 1542789278, "last_edit_date": 1542798192, "question_id": 53408016, "link": "https://stackoverflow.com/questions/53408016/503-service-temporarily-unavailable", "title": "503 - Service temporarily unavailable", "body": "<p>I need simple HTTP client on Raspberry PI zero with Raspbian. I used few example codes, but when i send about 7 requests then i can download just page with this error: \n503 Service temporarily unavailable\nThere is no available fastcgi process to fullfill your request.</p>\n\n<p>One of used codes: </p>\n\n<pre><code>#include &lt;arpa/inet.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;unistd.h&gt;\n#define SA      struct sockaddr\n#define MAXLINE 4096\n#define MAXSUB  200\n\nssize_t process_http(int sockfd, char *host, char *page)\n{\n    ssize_t n;\n      snprintf(sendline, MAXSUB,\n                 \"GET %s\\r\\n\"\n                 \"Host: %s\\r\\n\"\n                 \"Connection: close\\n\"\n                \"\\n\", page, host);\n\n        write(sockfd, sendline, strlen(sendline));\n\n        while ((n = read(sockfd, recvline, MAXLINE)) &gt; 0)\n         {\n    recvline[n] = '\\0';\n    }\n        printf(\"%s\", recvline);\n\n\n        return n;\n}\n</code></pre>\n\n<p>and in main is this:</p>\n\n<pre><code> int sockfd;\n        struct sockaddr_in servaddr;\n\n        char **pptr;\n\n        char *hname = \"plankter.cz\";\n        char *page = \"http://plankter.cz/iot/list.json\";\n\n        char str[50];\n        struct hostent *hptr;\n        if ((hptr = gethostbyname(hname)) == NULL) {\n                fprintf(stderr, \" gethostbyname error for host: %s: %s\",\n                        hname, hstrerror(h_errno));\n                exit(1);\n        }\n        printf(\"hostname: %s\\n\", hptr-&gt;h_name);\n        if (hptr-&gt;h_addrtype == AF_INET\n            &amp;&amp; (pptr = hptr-&gt;h_addr_list) != NULL) {\n                printf(\"address: %s\\n\",\n                       inet_ntop(hptr-&gt;h_addrtype, *pptr, str,\n                                 sizeof(str)));\n        } else {\n                fprintf(stderr, \"Error call inet_ntop \\n\");\n        }\n\n        sockfd = socket(AF_INET, SOCK_STREAM, 0);\n        bzero(&amp;servaddr, sizeof(servaddr));\n        servaddr.sin_family = AF_INET;\n        servaddr.sin_port = htons(80);\n        inet_pton(AF_INET, str, &amp;servaddr.sin_addr);\n\n        connect(sockfd, (SA *) &amp; servaddr, sizeof(servaddr));\n        process_http(sockfd, hname, page);\n        close(sockfd);\n</code></pre>\n\n<p>In this example i download json, but when i read php or txt, i have same problem. I tried some another example codes using sockets, example with happyhttp library and all give me same result after 7 requests. I think it doesn't close connection. I need to send http request and recieve data, and i need to do it few times in minute.</p>\n\n<p>Thanks for all ideas.</p>\n"}, {"tags": ["c", "data-structures", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 0, "creation_date": 1542785820, "post_id": 53407212, "comment_id": 93689183, "body": "try using typedef when you create your structure then use the type name in your sizeof."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1542786055, "post_id": 53407212, "comment_id": 93689270, "body": "Side note, but consider <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">not casting the result of malloc</a>."}], "answers": [{"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1542786306, "post_id": 53407296, "comment_id": 93689371, "body": "And why flexible array is not suitable?"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1542786731, "post_id": 53407296, "comment_id": 93689554, "body": "@SouravGhosh I just <code>ass*u*me*d</code> OP might not intended to use flexible array and accidentally declared structure like that."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1542790450, "post_id": 53407296, "comment_id": 93691454, "body": "@kiranBiradar The title suggests that an array of pointers in a struct is desired."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 0, "last_activity_date": 1542786995, "last_edit_date": 1542786995, "creation_date": 1542786038, "answer_id": 53407296, "question_id": 53407212, "link": "https://stackoverflow.com/questions/53407212/how-do-i-dynamically-allocate-memory-to-a-pointer-array-inside-a-structure/53407296#53407296", "title": "How do I dynamically allocate memory to a pointer array inside a structure", "body": "<p>Currently you are using flexible array(aka zero length array).\nWhich can be allocated as below.</p>\n\n<pre><code>struct test_case *test_case_struct =\n   malloc(sizeof (*test_case_struct) + 100 * sizeof (int *));\n</code></pre>\n\n<p>Note missing <code>*</code> for <code>int</code> and typo <code>sizeof(struct test_struct)</code> in your code.</p>\n\n<hr>\n\n<p>Alternatively you can use pointer to pointer as below.</p>\n\n<pre><code>struct test_case {\n  int n;\n  int **test;\n};\n\n\nstruct test_case *test_case_struct = malloc(\n      sizeof(*test_case_struct));\ntest_case_struct-&gt;test = malloc(100 * sizeof(int *)); // Allocates 100 pointers\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 10684281, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7ucZR4pY_QA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h8dW4fBbK0GuFQOr2YYCyCAwF9LQ/mo/photo.jpg?sz=128", "display_name": "Shiva Kumar", "link": "https://stackoverflow.com/users/10684281/shiva-kumar"}, "edited": false, "score": 0, "creation_date": 1542791267, "post_id": 53407320, "comment_id": 93691936, "body": "my intention is to have a pointer array that can point to <b>n</b> elements. where <b>n</b> is a user input. both <b>n</b> and pointer array being inside the structure. sorry for the typo in the snippet there"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 11, "user_id": 10684281, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7ucZR4pY_QA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h8dW4fBbK0GuFQOr2YYCyCAwF9LQ/mo/photo.jpg?sz=128", "display_name": "Shiva Kumar", "link": "https://stackoverflow.com/users/10684281/shiva-kumar"}, "edited": false, "score": 0, "creation_date": 1542791999, "post_id": 53407320, "comment_id": 93692374, "body": "@ShivaKumar So, you are saying, you don&#39;t need an array of pointers to <code>int</code>s, rather an array of <code>int</code>s, the count of the <code>int</code>s would be stored in <code>n</code>, right?"}, {"owner": {"reputation": 11, "user_id": 10684281, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7ucZR4pY_QA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h8dW4fBbK0GuFQOr2YYCyCAwF9LQ/mo/photo.jpg?sz=128", "display_name": "Shiva Kumar", "link": "https://stackoverflow.com/users/10684281/shiva-kumar"}, "edited": false, "score": 0, "creation_date": 1542864206, "post_id": 53407320, "comment_id": 93722976, "body": "nope. if i were to have a pointer array int *test[n], n would be a user input (this alone is not challenging for me, i gave done it before), the complexity is where i need to put the pointer array <b>int *test[ ]</b> inside a structure, and also its size <b>int n</b> inside a structure. the <b>use case</b> i am needing this for is i have the user inputting different square matrices of different dimensions (<b>int n</b>). each pointer in the <b>test[0], test[1] ... test[n]</b> is pointing to an <b>int array</b> which inturn have <b>n</b> elements in it. i hope i have made the picture clear enough."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1542786446, "last_edit_date": 1542786446, "creation_date": 1542786132, "answer_id": 53407320, "question_id": 53407212, "link": "https://stackoverflow.com/questions/53407212/how-do-i-dynamically-allocate-memory-to-a-pointer-array-inside-a-structure/53407320#53407320", "title": "How do I dynamically allocate memory to a pointer array inside a structure", "body": "<p>You need to change</p>\n\n<pre><code>  sizeof(struct test_struct)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>   sizeof(struct test_case)\n</code></pre>\n\n<p>as <code>test_struct</code> is not the correct structure type.</p>\n\n<p>In a better way, you can also use the already-declared variable name, like</p>\n\n<pre><code>struct test_case *test_case_struct = malloc(\n         sizeof (*test_case_struct) + n * sizeof(int*));\n</code></pre>\n\n<p>That said, you need to allocate memory worth of <code>int *</code>s, not <code>int</code>s, for the flexible member.</p>\n\n<p>Also, below is a snippet which shows the count is taken as user input</p>\n\n<pre><code>int main(void)\n{\n    int n = 0;\n    puts(\"Enter the count of pointers\");\n    if (scanf(\"%d\", &amp;n) != 1) {\n        puts(\"Got a problem in the input\");\n        exit (-1);\n    }\n    struct test_case *test_case_struct = malloc( sizeof(struct test_case) + n * sizeof(int*));\n    printf(\"Hello, world!\\n\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1542786297, "creation_date": 1542786297, "answer_id": 53407351, "question_id": 53407212, "link": "https://stackoverflow.com/questions/53407212/how-do-i-dynamically-allocate-memory-to-a-pointer-array-inside-a-structure/53407351#53407351", "title": "How do I dynamically allocate memory to a pointer array inside a structure", "body": "<p>Don't repeat type names. You already stumbled over your own code twice because you did that. You made the mistake of typing the wrong struct tag and confusing <code>int*</code> for <code>int</code>.</p>\n\n<p>A more hardy allocation would look like this</p>\n\n<pre><code>struct test_case *test_case_struct =\n  malloc(sizeof (*test_case_struct) + sizeof (test_case_struct-&gt;test[0]) * 100);\n</code></pre>\n\n<p>This here will allocate the size of whatever <code>test_case_struct</code> points at, plus 100 more of whatever <code>test_case_struct-&gt;test[0]</code> should be. Now you can play with the structure definition without breaking this call to malloc. And if you do perform a breaking change (like renaming <code>test</code>), you'll be notified by your compiler promptly.</p>\n"}], "owner": {"reputation": 11, "user_id": 10684281, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7ucZR4pY_QA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h8dW4fBbK0GuFQOr2YYCyCAwF9LQ/mo/photo.jpg?sz=128", "display_name": "Shiva Kumar", "link": "https://stackoverflow.com/users/10684281/shiva-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1542786995, "creation_date": 1542785622, "last_edit_date": 1542785788, "question_id": 53407212, "link": "https://stackoverflow.com/questions/53407212/how-do-i-dynamically-allocate-memory-to-a-pointer-array-inside-a-structure", "title": "How do I dynamically allocate memory to a pointer array inside a structure", "body": "<p>here is what i have in done so far </p>\n\n<pre><code>struct test_case {\n  int n;\n  int *test[];\n};\n\n\nstruct test_case *test_case_struct = (struct test_case *)malloc(\n      sizeof(struct test_struct) + 100 * sizeof(int));\n</code></pre>\n\n<p>I need to allocate n pointers in the \"test\" pointer array. As far as i know i need to allocate space to the structure and then some more for the pointer array, but when i try to compile this, i get the error \n<strong>invalid use of sizeof operator for to incomplete type struct test_struct</strong></p>\n\n<p>if someone could please inform me how i can take the value of <strong>n as a user input</strong> and have <strong>int *test [n]</strong> made possible. </p>\n"}, {"tags": ["c", "stm32", "standard-library"], "answers": [{"tags": [], "owner": {"reputation": 394, "user_id": 3264375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc3958029becfe0d27b76e56aa3371c3?s=128&d=identicon&r=PG", "display_name": "erenbasturk", "link": "https://stackoverflow.com/users/3264375/erenbasturk"}, "is_accepted": false, "score": 1, "last_activity_date": 1542785788, "creation_date": 1542785788, "answer_id": 53407238, "question_id": 53407043, "link": "https://stackoverflow.com/questions/53407043/stm32-function-in-standard-library/53407238#53407238", "title": "Stm32 function in &quot;Standard Library&quot;", "body": "<p>Firstly, you need to write the init functions of SPI,GPIO and Clock in the std library. In that case, we can not understand that which SPI1 pins you are using and which stm32 processor do you use.?</p>\n\n<p>You need provide detailed information pin number, stm32 processor number. It will be enough to answer.</p>\n"}, {"tags": [], "owner": {"reputation": 922, "user_id": 8653951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRbxO.jpg?s=128&g=1", "display_name": "theSealion", "link": "https://stackoverflow.com/users/8653951/thesealion"}, "is_accepted": false, "score": 1, "last_activity_date": 1542786984, "creation_date": 1542786984, "answer_id": 53407482, "question_id": 53407043, "link": "https://stackoverflow.com/questions/53407043/stm32-function-in-standard-library/53407482#53407482", "title": "Stm32 function in &quot;Standard Library&quot;", "body": "<p>Your function is a simple SPI tranfer.</p>\n\n<p>The lines with <code>HAL_GPIO_WritePin...</code> handle the Chip Select pin and the \n<code>HAL_SPI_Transmit()</code> does the transfer work.</p>\n\n<p>In the STD Library there are no functions to transmit complete blocks of data.\nSo you must use \n<code>void SPI_I2S_SendData(SPI_TypeDef* SPIx, uint16_t Data);</code> and transfer one byte after the other.</p>\n\n<p>The best way to get a complete example (including setup of the interface) could be found within the library itself (STM32F4xx_StdPeriph_Examples\\SPI\\SPI_TwoBoards\\SPI_DataExchangeInterrupt) </p>\n"}], "owner": {"reputation": 535, "user_id": 10024802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/470ad9d816276f1dff22193ac0642b93?s=128&d=identicon&r=PG&f=1", "display_name": "CKocar", "link": "https://stackoverflow.com/users/10024802/ckocar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 357, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1542786984, "creation_date": 1542784841, "question_id": 53407043, "link": "https://stackoverflow.com/questions/53407043/stm32-function-in-standard-library", "title": "Stm32 function in &quot;Standard Library&quot;", "body": "<p>I have this function and this is \"HAL\" library:</p>\n\n<pre><code>void ENC28_writeBuf(uint16_t len, uint8_t* data)\n{\n    uint8_t spiData[2];\n    HAL_GPIO_WritePin(GPIOD, GPIO_PIN_7, GPIO_PIN_RESET);\n    spiData[0] = ENC28_WRITE_BUF_MEM;\n    HAL_SPI_Transmit(&amp;hspi1, spiData, 1, 100);\n    HAL_SPI_Transmit(&amp;hspi1, data, len, 100);\n    HAL_GPIO_WritePin(GPIOD, GPIO_PIN_7, GPIO_PIN_SET);\n}\n</code></pre>\n\n<p>But i want to write with Standart Perhibral Library for stm32. How can i write this function in STD ?</p>\n"}, {"tags": ["c", "strcmp"], "answers": [{"tags": [], "owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "is_accepted": true, "score": 8, "last_activity_date": 1542783818, "creation_date": 1542783818, "answer_id": 53406821, "question_id": 53406785, "link": "https://stackoverflow.com/questions/53406785/comparing-user-input-to-a-predefined-array-of-characters-in-c-programming-langua/53406821#53406821", "title": "Comparing user input to a predefined array of characters in C programming language", "body": "<pre><code>if (strcmp(set, command))\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>if (strcmp(set, command) == 0)\n</code></pre>\n\n<p>The reason is that <code>strcmp</code> returns a nonzero value if the LHS or RHS is larger, and zero if they are equal. Since zero evaluates to \"false\" in a conditional, you'll have to explicitly add the <code>== 0</code> test to make it true in the sense that you're expecting, which is equality.</p>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1542784799, "last_edit_date": 1542784799, "creation_date": 1542784104, "answer_id": 53406891, "question_id": 53406785, "link": "https://stackoverflow.com/questions/53406785/comparing-user-input-to-a-predefined-array-of-characters-in-c-programming-langua/53406891#53406891", "title": "Comparing user input to a predefined array of characters in C programming language", "body": "<p>First of all, always length-bound your input while using <code>scanf()</code>, like</p>\n\n<pre><code> scanf(\"%9s\", command);\n</code></pre>\n\n<p>for a 10-element <code>char</code> array, to avoid buffer overflow by overly-long inputs.</p>\n\n<p>That said, the <code>if...else</code> block logic works in below way:</p>\n\n<pre><code>if (expression is true) {         // produce a non-zero value, truthy \n   execute the if block\n   }\nelse {                             // expression is falsy\n   execute the else block\n   }\n</code></pre>\n\n<p>In your case, the controlling expression is <code>strcmp(set, command)</code>.</p>\n\n<p>Now, point to note, in case of a <strong>match</strong>, <code>strcmp()</code> returns a <code>0</code>, in case of <strong>mismatch</strong>, it returns a non-zero value.</p>\n\n<p>Thus, </p>\n\n<ul>\n<li>If your input <strong>matches</strong> the expected pre-selected string, you'll get a <code>0</code> - which will be evaluated as <em>falsy</em> and against your expectation, it'll go to the <code>else</code> part.</li>\n<li>If your input <strong>does not match</strong> the expected pre-selected string, you'll get a non-zero value which will be evaluated as truthy and once again, the <code>if</code> block will be executed erroneously.</li>\n</ul>\n\n<p>So, in your case, you need to change the condition to negate the return value, like</p>\n\n<pre><code>   if (!strcmp(set, command))\n   {\n       printf(\"You asked for help\");\n   }\n    else if (!strcmp(set1, command))\n   {\n       printf(\"You said thanks!\");\n   }\n   else\n   {\n       printf(\"use either help or thanks command\");\n   }\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 7420837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e8f11c3d6cd853c2f062578c50f48a0?s=128&d=identicon&r=PG", "display_name": "pete mwangi", "link": "https://stackoverflow.com/users/7420837/pete-mwangi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 53406821, "answer_count": 2, "score": 3, "last_activity_date": 1560091585, "creation_date": 1542783642, "last_edit_date": 1542784404, "question_id": 53406785, "link": "https://stackoverflow.com/questions/53406785/comparing-user-input-to-a-predefined-array-of-characters-in-c-programming-langua", "title": "Comparing user input to a predefined array of characters in C programming language", "body": "<p>I have the following code which is supposed to get user input as commands then check whether the command is predefined. However, for any command entered the output is \"<strong>You asked for help</strong>\".\nI figured that the problem might be related to the way I'm comparing the user input string with the set string(s) but I still need help solving the problem.</p>\n\n<pre><code>char command[10];\nchar set[10];\nchar set1[10];\nstrcpy(set, \"help\");\nstrcpy(set1, \"thanks\");\n\nint a = 0;\nwhile (a != 1)//the program should not terminate.\n{\n   printf(\"Type command: \")\n   scanf(\"%s\", command);\n   if (strcmp(set, command))\n   {\n       printf(\"You asked for help\");\n   }\n    else if (strcmp(set1, command))\n   {\n       printf(\"You said thanks!\");\n   }\n   else\n   {\n       printf(\"use either help or thanks command\");\n   }\n}\n</code></pre>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 823, "user_id": 6699414, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7e32082597c5678a976d298d91eba29e?s=128&d=identicon&r=PG&f=1", "display_name": "PhoenixBlue", "link": "https://stackoverflow.com/users/6699414/phoenixblue"}, "edited": false, "score": 0, "creation_date": 1542783939, "post_id": 53406525, "comment_id": 93688415, "body": "What is the problem with your actual code? Also, instead of <code>list check = H-Heads[pos].next;</code> you should first make sure the list is not empty, then poiunt to the head of the list; that is: <code>if(H-&gt;Heads[pos]) check=H-&gt;Heads[pos];</code>"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1542784235, "post_id": 53406525, "comment_id": 93688551, "body": "You are confusing arrays and lists. <code>H-&gt;Heads[i].number</code> is not the proper way to access a list. For a list you need <code>H-&gt;Heads-&gt;number</code> and <code>H-&gt;Heads-&gt;next</code>. The <code>next</code> pointer will point to the next element of the list"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1542784292, "post_id": 53406525, "comment_id": 93688577, "body": "You are using <code>for (int i = 0; i &lt; H-&gt;size; ++i)</code> to iterate across a list, which is totally wrong."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542784598, "post_id": 53406525, "comment_id": 93688704, "body": "A list usually has a pointer to the first node (<code>head</code>) and a pointer to the last node (<code>tail</code>). But you are using a node to represent the whole list which obviously lacks <code>tail</code>. Without <code>tail</code> appending a node to a list is very inefficient. With tail: <code>tail-&gt;next = new_node; tail = new_node;</code> Look <a href=\"https://stackoverflow.com/a/53380533/3975177\">here</a> for a possible implementation."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 8224933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e60928b82476bf60a1e57b92f9b13974?s=128&d=identicon&r=PG&f=1", "display_name": "\u67e5\u4f1f\u660c", "link": "https://stackoverflow.com/users/8224933/%e6%9f%a5%e4%bc%9f%e6%98%8c"}, "edited": false, "score": 0, "creation_date": 1542790387, "post_id": 53407113, "comment_id": 93691414, "body": "thanks. change the &quot;check&quot; to &quot;list check = &amp;H-&gt;Heads[pos];&quot;, is ok,"}], "tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 0, "last_activity_date": 1542785217, "creation_date": 1542785217, "answer_id": 53407113, "question_id": 53406525, "link": "https://stackoverflow.com/questions/53406525/c-linked-list-append-insert/53407113#53407113", "title": "c linked list append insert", "body": "<p>You are confusing arrays and lists. <code>H-&gt;Heads[i].number</code> is not the proper way to access a list. For a list you need <code>H-&gt;Heads-&gt;number</code> and <code>H-&gt;Heads-&gt;next</code>. The next pointer will point to the next element of the list</p>\n\n<p>Basically you have an array of numbers with an extra unused pointer.</p>\n\n<p>For the <code>create</code> function given to add an element at the end, you need to <code>realloc</code> the entire array with new size. However, this is probably not what you want.</p>\n\n<p>You need to modify the <code>create</code> function to make a true list and then you can append.</p>\n\n<p>Code below, inserts at the end, you can modify to insert at a particular index.</p>\n\n<pre><code>typedef struct Info* PtrToNode;\nstruct Info {\n    int number;\n    PtrToNode next;\n};\ntypedef struct Info* list;\n\ntypedef struct HashNode* HashTable;\nstruct HashNode {\n    list Heads;\n    int size;\n};\n\nHashTable createTable(int size) {\n    HashTable H = (HashTable)malloc(sizeof(struct HashNode));\n    H-&gt;size = size;\n    H-&gt;Heads = malloc(sizeof(struct Info));\n    H-&gt;Heads-&gt;number = 0;\n    H-&gt;Heads-&gt;next = NULL;\n\n    list curr = H-&gt;Heads;\n    list nextval;\n\n    for (int i = 1; i &lt; H-&gt;size; ++i)\n    {\n        nextval = malloc(sizeof(struct Info));\n        nextval-&gt;number = 0;\n        nextval-&gt;next = NULL;\n        curr-&gt;next = nextval;\n        curr = curr-&gt;next;\n    }\n    return H;\n}\n\nint Hash(int n, int size) {\n    return n % size;\n}\n\n\nvoid insert(HashTable H, int index, int number) {\n    int pos = Hash(number, H-&gt;size);\n\n    list check = H-&gt;Heads;\n    while (check-&gt;next)  {\n        check = check-&gt;next;\n    }\n    PtrToNode newNode = (PtrToNode)malloc(sizeof(struct Info));\n    newNode-&gt;number = number;\n    newNode-&gt;next = NULL;\n    check-&gt;next = newNode;\n\n    (H-&gt;size)++;\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8224933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e60928b82476bf60a1e57b92f9b13974?s=128&d=identicon&r=PG&f=1", "display_name": "\u67e5\u4f1f\u660c", "link": "https://stackoverflow.com/users/8224933/%e6%9f%a5%e4%bc%9f%e6%98%8c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 349, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542785217, "creation_date": 1542782508, "question_id": 53406525, "link": "https://stackoverflow.com/questions/53406525/c-linked-list-append-insert", "title": "c linked list append insert", "body": "<p>I want to insert a node int the end of the linked list, but I don't know how to achieve.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct Info* PtrToNode;\nstruct Info {\n    int number;\n    PtrToNode next;\n};\ntypedef struct Info* list;\n\ntypedef struct HashNode* HashTable;\nstruct HashNode {\n    list Heads;\n    int size;\n};\n\nHashTable createTable(int size) {\n    HashTable H = (HashTable)malloc(sizeof(struct HashNode));\n    H-&gt;size = size;\n    H-&gt;Heads = (PtrToNode)malloc(H-&gt;size * sizeof(struct Info));\n    for (int i = 0; i &lt; H-&gt;size; ++i)\n    {\n        H-&gt;Heads[i].number = 0;\n        H-&gt;Heads[i].next = NULL;\n    }\n    return H;\n}\n\nint Hash(int n, int size) {\n    return n % size;\n}\n\nvoid insert(HashTable H, int index, int number) {\n    int pos = Hash(number, H-&gt;size);\n\n    list check = H-&gt;Heads[pos].next;\n    while (check) {\n        check = check-&gt;next;\n    }\n    PtrToNode newNode = (PtrToNode)malloc(sizeof(struct Info));\n    newNode-&gt;number = number;\n    newNode-&gt;next = NULL;\n    check = newNode;\n}\n</code></pre>\n\n<p>I want append in the insert function, but the params \"check\" like temporary, and if I \"while\" the H->heads[pos], the node always in the head.</p>\n"}, {"tags": ["c", "assembly", "arm", "emulation", "cpu"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1542782733, "post_id": 53406493, "comment_id": 93687933, "body": "I can&#39;t help but feel that if you are able to write your <b><i>own</i></b> emulator, you should be able to figure out how to (basically) copy data from one memory region to another. Or is that not the problem? Can you please elaborate and add more details? What <i>exactly</i> do you have? What <i>exactly</i> are you trying to do? What <i>exactly</i> have you done?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1542782971, "post_id": 53406493, "comment_id": 93688028, "body": "You talk about copying, and about &quot;splitting opcodes and registers&quot;.  Do you mean operands in general, including immediates?  So are you having problems with relocating position-dependent code to a different guest address?  This is why object file formats have relocations.  A relocation entry describes which bytes need to be modified, so you don&#39;t need to decode the machine code."}, {"owner": {"reputation": 183, "user_id": 9314272, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cfcb7daceb2beace6753ec8440dbc808?s=128&d=identicon&r=PG&f=1", "display_name": "Tailor", "link": "https://stackoverflow.com/users/9314272/tailor"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1542783616, "post_id": 53406493, "comment_id": 93688284, "body": "As far as I know, the emulator has to copy data from ROM to the RAM. But what happens after that? The emulator has to go through the RAM, read the OpCodes, variables, etc.. and execute them. But for example, how does the emulator know if the number (?) is a OpCode or a variable? Sry its kind of hard to explain it.. @Someprogrammerdude"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1542784080, "post_id": 53406493, "comment_id": 93688474, "body": "So you haven&#39;t even gotten to the stage where the emulator decodes instructions yet? Then you should take a few steps back, and start over (I think) with analysis, requirements and design. And most importantly learn about the <a href=\"https://en.wikipedia.org/wiki/Executable_and_Linkable_Format\" rel=\"nofollow noreferrer\">ELF</a> files, how to load them properly, and of course the binary format of the ARM instructions and what <i>each single bit</i> in them mean. In short, you&#39;re going way to fast and need to slow down."}, {"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1542785593, "post_id": 53406493, "comment_id": 93689101, "body": "<i>&quot;As far as I know, the emulator has to copy data from ROM to the RAM.&quot;</i> Why? Was the code compiled to be run from RAM? There are plenty of examples where most code would run from ROM (e.g. pretty much every cartridge-based video game console)."}], "owner": {"reputation": 183, "user_id": 9314272, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cfcb7daceb2beace6753ec8440dbc808?s=128&d=identicon&r=PG&f=1", "display_name": "Tailor", "link": "https://stackoverflow.com/users/9314272/tailor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 245, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542782360, "creation_date": 1542782360, "question_id": 53406493, "link": "https://stackoverflow.com/questions/53406493/run-hello-world-on-arm-emulator", "title": "Run Hello World on ARM emulator", "body": "<p>I'm trying to emulate a ARM-cpu at the moment. I read a lot about how to emulate a cpu. Right now I managed to write down all OpCodes, Registers etc and compiled a Hello World on a ARM-Maschine written in C, to get the assembler code (to test my emulator).</p>\n\n<p><strong>Assembler</strong></p>\n\n<pre><code>    .arch armv8-a\n    .file \"hello.c\"\n    .section .text.startup, \"ax\", @progbits\n    .align 2\n    .p2align 3,,7\n    .global main\n    .type main, %function\nmain:\n    stp x29, x30, [sp, -16]!\n    adrp x1, .LC0\n    add x1, x1, :lo12:.LC0\n    mov w0, 1\n    add x29, sp, 0\n    bl __printf_chk\n    mov w0, 0\n    ldp x29, x30, [sp], 16\n    ret\n    .size main, .-main\n    .section .rodata.str1.8, \"aMS\", @progbits, 1\n    .align 3\n.LC0:\n    .string \"Hello World\"\n    .ident \"GCC: (Ubuntu/Linaro 5.4.0-6ubuntu1~16.04.10)\"\n    .section .note.GNU-stack, \"\", @progbits\n</code></pre>\n\n<p>I have to load the code from the ROM to my emulated RAM from which the code will be executed. But how do I load it to the RAM? I dont understand how to split the OpCodes and the Registers.</p>\n\n<p><strong>Summary</strong></p>\n\n<p>I want to emulate a ARM-CPU on a Intel CPU with Windows. To test my emulator I wrote a Hello World in C and compiled it to get the assembler code. The assembler code is written on a ARM-Maschine with Ubuntu 16.04. My question is how to fetch the assembler code with my emulator.</p>\n"}, {"tags": ["c++", "c", "cairo", "librsvg"], "comments": [{"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1542785106, "post_id": 53406129, "comment_id": 93688917, "body": "I wrote a small program to convert SVG to PNG some time ago, maybe it helps you: <a href=\"http://termbin.com/r8t8\" rel=\"nofollow noreferrer\">termbin.com/r8t8</a>"}, {"owner": {"reputation": 507, "user_id": 4212509, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/GZQSj.jpg?s=128&g=1", "display_name": "Gregorio Litenstein", "link": "https://stackoverflow.com/users/4212509/gregorio-litenstein"}, "reply_to_user": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1542808028, "post_id": 53406129, "comment_id": 93701425, "body": "Thanks but not really. As I said on the question, the code was working with <code>rsvg_handle_new_from_file</code> before. I&#39;m trying to understand what am I doing wrong that rendering now fails. And I&#39;m doing all this because I noticed that the rendered png (with the old code) is missing images embedded in the svg."}], "answers": [{"tags": [], "owner": {"reputation": 507, "user_id": 4212509, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/GZQSj.jpg?s=128&g=1", "display_name": "Gregorio Litenstein", "link": "https://stackoverflow.com/users/4212509/gregorio-litenstein"}, "is_accepted": false, "score": 0, "last_activity_date": 1543379478, "creation_date": 1543379478, "answer_id": 53512169, "question_id": 53406129, "link": "https://stackoverflow.com/questions/53406129/librsvg-and-cairo-rsvg-handle-render-cairo-fails-what-am-i-doing-wrong/53512169#53512169", "title": "librsvg and cairo; rsvg_handle_render_cairo() fails; what am I doing wrong?", "body": "<p>The answer was ridiculously simple. I was missing <code>rsvg_handle_close(svgHandle.get(), &amp;pError);</code></p>\n"}], "owner": {"reputation": 507, "user_id": 4212509, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/GZQSj.jpg?s=128&g=1", "display_name": "Gregorio Litenstein", "link": "https://stackoverflow.com/users/4212509/gregorio-litenstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 205, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543379478, "creation_date": 1542780346, "question_id": 53406129, "link": "https://stackoverflow.com/questions/53406129/librsvg-and-cairo-rsvg-handle-render-cairo-fails-what-am-i-doing-wrong", "title": "librsvg and cairo; rsvg_handle_render_cairo() fails; what am I doing wrong?", "body": "<p>I'm playing around with some code in a project; specifically a function that takes SVG images and makes pngs out of them.</p>\n\n<p>I have this:</p>\n\n<pre><code>    typedef std::vector&lt;uint8_t&gt; BinaryBuffer;\n\n    BinaryBuffer readFile(fs::path const&amp; path) {\n        BinaryBuffer ret;\n        fs::ifstream f(path, std::ios::binary);\n        f.seekg(0, std::ios::end);\n        ret.resize(f.tellg());\n        f.seekg(0);\n        f.read(reinterpret_cast&lt;char*&gt;(ret.data()), ret.size());\n        if (!f) throw std::runtime_error(\"File cannot be read: \" + path.string());\n        return ret;\n    }\n\nvoid loadSVG(Bitmap&amp; bitmap, fs::path const&amp; filename) {\n    double factor = config[\"graphic/svg_lod\"].f();\n    // Try to load a cached PNG instead\n    if (cache::loadSVG(bitmap, filename, factor)) return;\n    std::clog &lt;&lt; \"image/debug: Loading SVG: \" + filename.string() &lt;&lt; std::endl;\n    // Open the SVG file in librsvg\n#if !GLIB_CHECK_VERSION(2, 36, 0)   // Avoid deprecation warnings\n    g_type_init();\n#endif\n    GError* pError = nullptr;\n    std::shared_ptr&lt;RsvgHandle&gt; svgHandle(rsvg_handle_new_with_flags(RSVG_HANDLE_FLAG_KEEP_IMAGE_DATA), g_object_unref);\n    rsvg_handle_set_base_uri(svgHandle.get(),filename.string().c_str());\n    BinaryBuffer data = readFile(filename);\n    std::clog &lt;&lt; \"svg/debug: svg data size is: \" &lt;&lt; data.size() &lt;&lt; std::endl;\n    gboolean result = rsvg_handle_write(svgHandle.get(), data.data(), data.size(), &amp;pError);\n//  rsvg_handle_new_from_file(filename.string().c_str(), &amp;pError)\n\n    if (result != TRUE) {\n        g_error_free(pError);\n        throw std::runtime_error(\"Unable to load \" + filename.string());\n    }\n    else {\n        std::clog &lt;&lt; \"svg/debug: SVG loaded succesfully.\" &lt;&lt; std::endl;\n    }\n    // Get SVG dimensions\n    RsvgDimensionData svgDimension;\n    rsvg_handle_get_dimensions(svgHandle.get(), &amp;svgDimension);\n    // Prepare the pixel buffer\n    std::clog &lt;&lt; \"svg/debug: svg width is: \" &lt;&lt; svgDimension.width &lt;&lt; \", and height: \" &lt;&lt; svgDimension.height &lt;&lt; std::endl;\n    bitmap.resize(svgDimension.width*factor, svgDimension.height*factor);\n    bitmap.fmt = pix::INT_ARGB;\n    bitmap.linearPremul = true;\n    // Raster with Cairo\n    std::shared_ptr&lt;cairo_surface_t&gt; surface(\n      cairo_image_surface_create_for_data(&amp;bitmap.buf[0], CAIRO_FORMAT_ARGB32, bitmap.width, bitmap.height, bitmap.width * 4),\n      cairo_surface_destroy);\n    std::shared_ptr&lt;cairo_t&gt; dc(cairo_create(surface.get()), cairo_destroy);\n    cairo_scale(dc.get(), factor, factor);\n    gboolean renderRes = TRUE;\n    renderRes = rsvg_handle_render_cairo(svgHandle.get(), dc.get());\n    if (renderRes != TRUE) {\n        throw std::runtime_error(\"Unable to render \" + filename.string());\n        }\n    // Change byte order from BGRA to RGBA\n    for (uint32_t *ptr = reinterpret_cast&lt;uint32_t*&gt;(&amp;*bitmap.buf.begin()), *end = ptr + bitmap.buf.size() / 4; ptr &lt; end; ++ptr) {\n        uint8_t* pixel = reinterpret_cast&lt;uint8_t*&gt;(ptr);\n        uint8_t r = pixel[2], g = pixel[1], b = pixel[0], a = pixel[3];\n        pixel[0] = r; pixel[1] = g; pixel[2] = b; pixel[3] = a;\n    }\n    bitmap.fmt = pix::CHAR_RGBA;\n    // Write to cache so that it can be loaded faster the next time\n    fs::path cache_filename = cache::constructSVGCacheFileName(filename, factor);\n    fs::create_directories(cache_filename.parent_path());\n    writePNG(cache_filename, bitmap);\n}\n</code></pre>\n\n<p>But it fails in <code>rsvg_handle_render_cairo</code>... I don't know why. A previous version of the function using rsvg_handle_new_from_file (which doesn't use the BinaryBuffer struct) worked fine. Note, however that essentially the same struct and readFile function is used elsewhere without any issues. And from the debug messages I've dropped in there I can see that the file is indeed getting read. I am also getting correct dimensions from my svg file and there don't seem to be any errors prior to the call to the render function (so I'd assume it's parsed ok) but maybe not?</p>\n"}, {"tags": ["c", "linux", "alsa"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1542782308, "post_id": 53406050, "comment_id": 93687770, "body": "A sound card may or may not know whether a microphone is plugged in. Some have hardware to determine this, some don&#39;t. If it does, it will probably disable the recording device when the microphonne is not plugged in, so the open call will fail. It doesn&#39;t make sense to enable the device and then not produce any frames."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1542782959, "post_id": 53406050, "comment_id": 93688024, "body": "@n.m. <i>It doesn&#39;t make sense to enable the device and then not produce any frames.</i> Why doesn&#39;t? So it produces some garbage frames?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1542784141, "post_id": 53406050, "comment_id": 93688504, "body": "It produces silent frames (or small noises because of interference) because it cannot tell silence from an unplugged mic. If it could, it would tell you that the mic is unplugged by refusing to open it."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1542784407, "post_id": 53406050, "comment_id": 93688620, "body": "@n.m. Thanks, understood!"}], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 224, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542779885, "creation_date": 1542779885, "question_id": 53406050, "link": "https://stackoverflow.com/questions/53406050/sound-programming-in-linux-capturing-raw-sound-data", "title": "Sound programming in Linux. Capturing raw sound data", "body": "<p>I'm reading the <a href=\"http://alsamodular.sourceforge.net/alsa_programming_howto.html\" rel=\"nofollow noreferrer\">ALSA</a> tutorial and came up with a question about capturing PCM data. I wrote the following example (similar to one in the tutorial). Here is it (error checking and printing messages omitted):</p>\n\n<pre><code>#include &lt;alsa/asoundlib.h&gt;\n\nint rate = 44100;\nint periods = 2;\nsnd_pcm_uframes_t period_size = 8192;\nint exact_rate;\nint direction;\n\nint main(int argc, char ** argv){\n    snd_pcm_t *pcm_handle;\n    snd_pcm_stream_t stream = SND_PCM_STREAM_CAPTURE; // &lt;--- for capturin PCM data\n    snd_pcm_hw_params_t *hwparams;\n    snd_pcm_hw_params_alloca(&amp;hwparams);\n    snd_pcm_open(&amp;pcm_handle, pcm_name, stream, 0)\n    snd_pcm_hw_params_any(pcm_handle, hwparams)\n    snd_pcm_hw_params_set_access(pcm_handle, hwparams, SND_PCM_ACCESS_RW_INTERLEAVED);\n    snd_pcm_hw_params_set_format(pcm_handle, hwparams, SND_PCM_FORMAT_S16_LE);\n    snd_pcm_hw_params_set_rate_near(pcm_handle, hwparams, &amp;exact_rate, &amp;direction);\n    snd_pcm_hw_params_set_channels(pcm_handle, hwparams, 2);\n    snd_pcm_hw_params_set_periods(pcm_handle, hwparams, periods, direction);\n    snd_pcm_hw_params_set_buffer_size(pcm_handle, hwparams, (period_size * periods) &gt;&gt; 2);\n    snd_pcm_hw_params(pcm_handle, hwparams);\n\n    //reading PCM data, microphone is not plugged\n    char *buffer = calloc(sizeof(char), period_size * periods);\n    int pcm_read_return = 0;\n    pcm_read_return = snd_pcm_readi(pcm_handle, buffer, period_size &gt;&gt; 2);\n\n    printf(\"Read %d frames\\n\", pcm_read_return); //always 2048\n    printf(\"Buffer: %s\\n\", buffer);  //Some data,not all bytes are 0\n\n    free(buffer);\n\n    return 0;\n}\n</code></pre>\n\n<p>I don't really understand the behavior. The number of frames read are <code>2048</code> all the time. <s>And they are always 0</s> Sometimes it produces some non-zero bytes. I expected no frames are read since microphone is unplugged and no PCM data should be available.</p>\n"}, {"tags": ["c", "linux", "linux-kernel", "iptables", "netlink"], "comments": [{"owner": {"reputation": 2126, "user_id": 4407613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k0ty3.png?s=128&g=1", "display_name": "Devidas", "link": "https://stackoverflow.com/users/4407613/devidas"}, "edited": false, "score": 0, "creation_date": 1542780465, "post_id": 53405999, "comment_id": 93687079, "body": "are you running this program as a root / privileged user ?"}, {"owner": {"reputation": 1, "user_id": 7722620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9edc0a5c101eed862638749430098e9a?s=128&d=identicon&r=PG&f=1", "display_name": "avinash", "link": "https://stackoverflow.com/users/7722620/avinash"}, "reply_to_user": {"reputation": 2126, "user_id": 4407613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k0ty3.png?s=128&g=1", "display_name": "Devidas", "link": "https://stackoverflow.com/users/4407613/devidas"}, "edited": false, "score": 0, "creation_date": 1542780504, "post_id": 53405999, "comment_id": 93687087, "body": "Yes,running as a root user."}, {"owner": {"reputation": 2126, "user_id": 4407613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k0ty3.png?s=128&g=1", "display_name": "Devidas", "link": "https://stackoverflow.com/users/4407613/devidas"}, "edited": false, "score": 0, "creation_date": 1542780563, "post_id": 53405999, "comment_id": 93687110, "body": "do you have auditd running ?"}, {"owner": {"reputation": 1, "user_id": 7722620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9edc0a5c101eed862638749430098e9a?s=128&d=identicon&r=PG&f=1", "display_name": "avinash", "link": "https://stackoverflow.com/users/7722620/avinash"}, "reply_to_user": {"reputation": 2126, "user_id": 4407613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k0ty3.png?s=128&g=1", "display_name": "Devidas", "link": "https://stackoverflow.com/users/4407613/devidas"}, "edited": false, "score": 0, "creation_date": 1542780907, "post_id": 53405999, "comment_id": 93687244, "body": "Yes.                                                             ps -eaf | grep -i auditd root       499     2  0 Nov16 ?        00:00:00 [kauditd] root       926     1  0 Nov16 ?        00:00:00 /sbin/auditd -n"}, {"owner": {"reputation": 2126, "user_id": 4407613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k0ty3.png?s=128&g=1", "display_name": "Devidas", "link": "https://stackoverflow.com/users/4407613/devidas"}, "edited": false, "score": 0, "creation_date": 1542781817, "post_id": 53405999, "comment_id": 93687567, "body": "can you check return value of bind and if it is less than zero use perror or check errno ?"}, {"owner": {"reputation": 1, "user_id": 7722620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9edc0a5c101eed862638749430098e9a?s=128&d=identicon&r=PG&f=1", "display_name": "avinash", "link": "https://stackoverflow.com/users/7722620/avinash"}, "reply_to_user": {"reputation": 2126, "user_id": 4407613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k0ty3.png?s=128&g=1", "display_name": "Devidas", "link": "https://stackoverflow.com/users/4407613/devidas"}, "edited": false, "score": 0, "creation_date": 1542782261, "post_id": 53405999, "comment_id": 93687748, "body": "i checked earlier with prints ,bind is returning success ,it gets stuck in receive blocking call ."}, {"owner": {"reputation": 2126, "user_id": 4407613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k0ty3.png?s=128&g=1", "display_name": "Devidas", "link": "https://stackoverflow.com/users/4407613/devidas"}, "edited": false, "score": 0, "creation_date": 1542792968, "post_id": 53405999, "comment_id": 93692940, "body": "you mean &quot;audit_get_reply&quot; this is blocking call right ?"}, {"owner": {"reputation": 2126, "user_id": 4407613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k0ty3.png?s=128&g=1", "display_name": "Devidas", "link": "https://stackoverflow.com/users/4407613/devidas"}, "edited": false, "score": 0, "creation_date": 1542793166, "post_id": 53405999, "comment_id": 93693068, "body": "check validity of fd. need to check return value whenever it expects error. let me know. I think less chance of it being invalid as bind is succeeding. please let me know is not -1."}, {"owner": {"reputation": 1, "user_id": 7722620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9edc0a5c101eed862638749430098e9a?s=128&d=identicon&r=PG&f=1", "display_name": "avinash", "link": "https://stackoverflow.com/users/7722620/avinash"}, "reply_to_user": {"reputation": 2126, "user_id": 4407613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k0ty3.png?s=128&g=1", "display_name": "Devidas", "link": "https://stackoverflow.com/users/4407613/devidas"}, "edited": false, "score": 0, "creation_date": 1542861935, "post_id": 53405999, "comment_id": 93722384, "body": "Hi,its +ve value ,i checked it."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7722620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9edc0a5c101eed862638749430098e9a?s=128&d=identicon&r=PG&f=1", "display_name": "avinash", "link": "https://stackoverflow.com/users/7722620/avinash"}, "edited": false, "score": 0, "creation_date": 1542849792, "post_id": 53409159, "comment_id": 93719772, "body": "I have tried this as well before ,since it&#39;s non blocking call,it will come out without waiting there(used the polling as well before thi call) but not received any data"}, {"owner": {"reputation": 1, "user_id": 7722620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9edc0a5c101eed862638749430098e9a?s=128&d=identicon&r=PG&f=1", "display_name": "avinash", "link": "https://stackoverflow.com/users/7722620/avinash"}, "edited": false, "score": 0, "creation_date": 1542849927, "post_id": 53409159, "comment_id": 93719797, "body": "Is there any other way as well to receive the  iptable change notification ?"}, {"owner": {"reputation": 2126, "user_id": 4407613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k0ty3.png?s=128&g=1", "display_name": "Devidas", "link": "https://stackoverflow.com/users/4407613/devidas"}, "reply_to_user": {"reputation": 1, "user_id": 7722620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9edc0a5c101eed862638749430098e9a?s=128&d=identicon&r=PG&f=1", "display_name": "avinash", "link": "https://stackoverflow.com/users/7722620/avinash"}, "edited": false, "score": 0, "creation_date": 1542874327, "post_id": 53409159, "comment_id": 93727002, "body": "maybe you have to configure audit with <code>auditctl</code> ? can you consult man page and try configuring  it ?"}, {"owner": {"reputation": 2126, "user_id": 4407613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k0ty3.png?s=128&g=1", "display_name": "Devidas", "link": "https://stackoverflow.com/users/4407613/devidas"}, "reply_to_user": {"reputation": 1, "user_id": 7722620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9edc0a5c101eed862638749430098e9a?s=128&d=identicon&r=PG&f=1", "display_name": "avinash", "link": "https://stackoverflow.com/users/7722620/avinash"}, "edited": false, "score": 0, "creation_date": 1542874662, "post_id": 53409159, "comment_id": 93727177, "body": "from your observation it is clear that there is less probablity of this code having problem. as it may have given some error. so I feel is audit is not configured to listem to netlink related or for that matter any call by default. I suggest you to go through this <a href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/security_guide/sec-defining_audit_rules_and_controls\" rel=\"nofollow noreferrer\">access.redhat.com/documentation/en-us/red_hat_enterprise_lin&zwnj;&#8203;ux/&hellip;</a> specifically example 7.2 and try simmilar thing with given example try it works and then do same/ related  for netlink"}, {"owner": {"reputation": 1, "user_id": 7722620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9edc0a5c101eed862638749430098e9a?s=128&d=identicon&r=PG&f=1", "display_name": "avinash", "link": "https://stackoverflow.com/users/7722620/avinash"}, "edited": false, "score": 0, "creation_date": 1542962617, "post_id": 53409159, "comment_id": 93759308, "body": "I tried configuring those setting earlier directly using auditctl command &amp; can see the modifcation with &quot;ausearch -k iptablesChange&quot; command output..this time i configured more rules in /etc/audit/audit.rules file but still issue persist."}, {"owner": {"reputation": 2126, "user_id": 4407613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k0ty3.png?s=128&g=1", "display_name": "Devidas", "link": "https://stackoverflow.com/users/4407613/devidas"}, "reply_to_user": {"reputation": 1, "user_id": 7722620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9edc0a5c101eed862638749430098e9a?s=128&d=identicon&r=PG&f=1", "display_name": "avinash", "link": "https://stackoverflow.com/users/7722620/avinash"}, "edited": false, "score": 0, "creation_date": 1542964467, "post_id": 53409159, "comment_id": 93760290, "body": "have you tried system calls and checked with your program ? just to be sure there is no problem in program and audit system. let me know if you see anything in your program when you try system call."}, {"owner": {"reputation": 1, "user_id": 7722620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9edc0a5c101eed862638749430098e9a?s=128&d=identicon&r=PG&f=1", "display_name": "avinash", "link": "https://stackoverflow.com/users/7722620/avinash"}, "edited": false, "score": 0, "creation_date": 1543214108, "post_id": 53409159, "comment_id": 93821728, "body": "i tried with system call in that program ,it worked.                                                     char command[50];      strcpy( command, &quot;ls -l&quot; );    system(command);"}, {"owner": {"reputation": 2126, "user_id": 4407613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k0ty3.png?s=128&g=1", "display_name": "Devidas", "link": "https://stackoverflow.com/users/4407613/devidas"}, "reply_to_user": {"reputation": 1, "user_id": 7722620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9edc0a5c101eed862638749430098e9a?s=128&d=identicon&r=PG&f=1", "display_name": "avinash", "link": "https://stackoverflow.com/users/7722620/avinash"}, "edited": false, "score": 0, "creation_date": 1543303214, "post_id": 53409159, "comment_id": 93858627, "body": "this means your program and libaudit is working so now just need to figure out right configuration for  iptable notifications. let me check if i find any."}], "tags": [], "owner": {"reputation": 2126, "user_id": 4407613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k0ty3.png?s=128&g=1", "display_name": "Devidas", "link": "https://stackoverflow.com/users/4407613/devidas"}, "is_accepted": false, "score": 0, "last_activity_date": 1542793384, "creation_date": 1542793384, "answer_id": 53409159, "question_id": 53405999, "link": "https://stackoverflow.com/questions/53405999/netlink-notification-for-iptable-modification-are-not-received-to-application/53409159#53409159", "title": "Netlink notification for iptable modification are not received to application", "body": "<p>try this flag</p>\n\n<p><a href=\"https://github.com/linux-audit/audit-userspace/blob/master/lib/libaudit.c#L383\" rel=\"nofollow noreferrer\">https://github.com/linux-audit/audit-userspace/blob/master/lib/libaudit.c#L383</a></p>\n\n<p>from libaudit source code</p>\n\n<pre><code>rc = audit_get_reply(fd, &amp;rep, GET_REPLY_NONBLOCKING,0);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7722620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9edc0a5c101eed862638749430098e9a?s=128&d=identicon&r=PG&f=1", "display_name": "avinash", "link": "https://stackoverflow.com/users/7722620/avinash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 234, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542801745, "creation_date": 1542779564, "last_edit_date": 1542801745, "question_id": 53405999, "link": "https://stackoverflow.com/questions/53405999/netlink-notification-for-iptable-modification-are-not-received-to-application", "title": "Netlink notification for iptable modification are not received to application", "body": "<p>I wrote a program to listen to iptables modification through netlink sockets, for this I used <code>NETLINK_AUDIT</code> family, when I execute the program and modify the iptables rule, program doesn't receive any message from kernel and it will be in blocking mode only. Could you help me to find what is wrong in this program or what else I need to do to receive iptables notification.</p>\n\n<pre><code>#include \"libaudit.h\"\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n\nint main()\n{\n        int rc;\n        struct audit_message rep;\n        int fd;\n        struct sockaddr_nl sa;\n\n        memset(&amp;sa, 0, sizeof(sa));\n        sa.nl_family = AF_NETLINK;\n        sa.nl_groups = 0; \n\n        fd = audit_open();\n\n        bind(fd, (struct sockaddr *) &amp;sa, sizeof(sa));\n\n        rc = audit_get_reply(fd, &amp;rep, GET_REPLY_BLOCKING, 0);\n        if(rc &lt; 0)\n        {\n                printf(\"Error\");\n        }\n        else\n        {       \n                printf(\"msg received %d \\n\",rep.nlh.nlmsg_type );\n                break;\n        }       \n\n\n        audit_close(fd);\n\n        return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "hex"], "comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1542780185, "post_id": 53405967, "comment_id": 93686985, "body": "It&#39;s clear from that output that <code>a+10</code> is the address of the tenth <code>int</code> after<code>a[0]</code>, which is 40 more than <code>a</code>. Unsurprisingly, <code>(a + 10) - a</code> is 10. Consider what that means for <code>b - a</code>(which is technically undefined behaviour, by the way)."}, {"owner": {"reputation": 1095, "user_id": 7813604, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c05e209ba1c9aecc893a588b77b5d82f?s=128&d=identicon&r=PG&f=1", "display_name": "Kindred", "link": "https://stackoverflow.com/users/7813604/kindred"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1542780704, "post_id": 53405967, "comment_id": 93687162, "body": "@rici: I thought that would be <code>-(result)</code>..."}], "answers": [{"comments": [{"owner": {"reputation": 1095, "user_id": 7813604, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c05e209ba1c9aecc893a588b77b5d82f?s=128&d=identicon&r=PG&f=1", "display_name": "Kindred", "link": "https://stackoverflow.com/users/7813604/kindred"}, "edited": false, "score": 0, "creation_date": 1542780596, "post_id": 53406104, "comment_id": 93687122, "body": "<code>0x0c</code> = <code>12</code>(decimal) so the compiler adds 2-integer distance between the start of <code>a</code> and the end of <code>b</code> right?"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "reply_to_user": {"reputation": 1095, "user_id": 7813604, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c05e209ba1c9aecc893a588b77b5d82f?s=128&d=identicon&r=PG&f=1", "display_name": "Kindred", "link": "https://stackoverflow.com/users/7813604/kindred"}, "edited": false, "score": 2, "creation_date": 1542780751, "post_id": 53406104, "comment_id": 93687180, "body": "@ptr_user7813604 - That is dependent on the compiler and/or memory and is not a requirement of the C language."}], "tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": true, "score": 2, "last_activity_date": 1542780186, "creation_date": 1542780186, "answer_id": 53406104, "question_id": 53405967, "link": "https://stackoverflow.com/questions/53405967/about-the-hexadecimal-result-of-a-b-where-each-is-a-pointer-to-an-array/53406104#53406104", "title": "About the hexadecimal result of a-b, where each is a pointer to an array", "body": "<p>When you subtract pointers you get the difference in <strong>locations</strong> not difference in bytes</p>\n\n<p>So, you get <code>0x7ffcabb73cc0</code> - <code>0x7ffcabb73c90</code> = <code>0x30</code> bytes</p>\n\n<p>Dividing this by 4 bytes per integer, you get <code>0x0c</code> <strong>integers</strong></p>\n"}], "owner": {"reputation": 1095, "user_id": 7813604, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c05e209ba1c9aecc893a588b77b5d82f?s=128&d=identicon&r=PG&f=1", "display_name": "Kindred", "link": "https://stackoverflow.com/users/7813604/kindred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 53406104, "answer_count": 1, "score": 1, "last_activity_date": 1542820028, "creation_date": 1542779426, "question_id": 53405967, "link": "https://stackoverflow.com/questions/53405967/about-the-hexadecimal-result-of-a-b-where-each-is-a-pointer-to-an-array", "title": "About the hexadecimal result of a-b, where each is a pointer to an array", "body": "<p>I'm thinking about how the result of the following snippet is <code>0xc</code>? Shouldn't it be <code>c0-90=30</code>? I run it on <a href=\"https://ideone.com/rjsY0b\" rel=\"nofollow noreferrer\">ideone.com</a>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n\n    int a[10] = {0};\n    int b[10] = {0};\n    printf(\"sizeof(a) = %d\\n\", (int)sizeof(a));\n    printf(\"%p, %p\\n\", (void *)(a+10), (void *)(b+10));\n    printf(\"a = %p; b = %p\\n\", (void *)a, (void *)b);\n    printf(\"a-b = %p\", (void *)(a-b));\n\n    return 0;\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>sizeof(a) = 40\n0x7ffcabb73ce8, 0x7ffcabb73cb8\na = 0x7ffcabb73cc0; b = 0x7ffcabb73c90\na-b = 0xc\n</code></pre>\n"}, {"tags": ["c", "linux", "console-application", "remote-access", "debian-stretch"], "comments": [{"owner": {"reputation": 1178, "user_id": 1406668, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/T4b1f.jpg?s=128&g=1", "display_name": "Dave M.", "link": "https://stackoverflow.com/users/1406668/dave-m"}, "edited": false, "score": 1, "creation_date": 1542781176, "post_id": 53405943, "comment_id": 93687347, "body": "If your program works when you run it from the console interactively, and you don&#39;t want to undertake the (significant!) work to add a network text interface, you can start it during boot under a <code>screen</code> process.  <code>Screen</code> sets up a virtual terminal I/O environment, and you can connect your real terminal to it and talk to the program running there.  When you&#39;re done, you can disconnect from <code>screen</code> and the program won&#39;t know the difference."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1542888909, "post_id": 53405943, "comment_id": 93735459, "body": "Using a virtual terminal seems like the right way to go.  Either <code>tmux</code> or <code>screen</code> will serve that purpose."}, {"owner": {"reputation": 21, "user_id": 3303433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0MzZh.jpg?s=128&g=1", "display_name": "VictorV", "link": "https://stackoverflow.com/users/3303433/victorv"}, "edited": false, "score": 0, "creation_date": 1542939284, "post_id": 53405943, "comment_id": 93753209, "body": "Great ideas.  I will look into using one of those.  Also, thanks Basile for pointing out some great study topics."}], "answers": [{"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 1, "last_activity_date": 1542888555, "last_edit_date": 1542888555, "creation_date": 1542779623, "answer_id": 53406006, "question_id": 53405943, "link": "https://stackoverflow.com/questions/53405943/how-do-i-create-a-linux-c-application-with-a-console-that-i-can-connect-to-remot/53406006#53406006", "title": "How do I create a linux C application with a console that I can connect to remotely", "body": "<p>Read more about Linux programming, perhaps the old <a href=\"http://www.makelinux.net/alp/\" rel=\"nofollow noreferrer\">ALP</a> (advanced linux programming) book (freely <a href=\"https://richard.esplins.org/static/downloads/linux_book.pdf\" rel=\"nofollow noreferrer\">downloadable</a>), or something newer. See also the <a href=\"http://man7.org/linux/man-pages/man2/syscalls.2.html\" rel=\"nofollow noreferrer\">syscalls(2)</a> list. You want some <a href=\"https://en.wikipedia.org/wiki/Inter-process_communication\" rel=\"nofollow noreferrer\">inter-process communication</a>.</p>\n\n<p>You need to learn more about <a href=\"https://en.wikipedia.org/wiki/Berkeley_sockets\" rel=\"nofollow noreferrer\">sockets</a>. See <a href=\"http://man7.org/linux/man-pages/man7/socket.7.html\" rel=\"nofollow noreferrer\">sockets(7)</a>; you might use Unix sockets, see <a href=\"http://man7.org/linux/man-pages/man7/unix.7.html\" rel=\"nofollow noreferrer\">unix(7)</a> (or use <a href=\"http://man7.org/linux/man-pages/man7/fifo.7.html\" rel=\"nofollow noreferrer\">fifo(7)</a>, <a href=\"http://man7.org/linux/man-pages/man7/pipe.7.html\" rel=\"nofollow noreferrer\">pipe(7)</a> etc...), or even TCP/IP sockets, see <a href=\"http://man7.org/linux/man-pages/man7/tcp.7.html\" rel=\"nofollow noreferrer\">tcp(7)</a> (but then beware of hostile connections from the Internet). You need to use some multiplexing <a href=\"https://en.wikipedia.org/wiki/System_call\" rel=\"nofollow noreferrer\">system call</a>, such as <a href=\"http://man7.org/linux/man-pages/man2/poll.2.html\" rel=\"nofollow noreferrer\">poll(2)</a>. In simple cases, your user could just use <a href=\"https://linux.die.net/man/1/telnet\" rel=\"nofollow noreferrer\">telnet</a> to connect to your application (beware, there is no encryption involved; so you need to trust the connection, e.g. be on some internal LAN).</p>\n\n<p>You could decide to add some web interface to your program (which then becomes a specialized web server, e.g. serving some <code>http://localhost:12345/</code> and similar URLs). Then use some HTTP <em>server</em> library, such as <a href=\"https://www.coralbits.com/libonion/\" rel=\"nofollow noreferrer\">libonion</a> or <a href=\"https://www.libhttp.org/\" rel=\"nofollow noreferrer\">libhttp</a>. Of course that requires familiarity with Web technologies (<a href=\"https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol\" rel=\"nofollow noreferrer\">HTTP</a>, <a href=\"https://en.wikipedia.org/wiki/HTML5\" rel=\"nofollow noreferrer\">HTML5</a> &amp; <a href=\"https://en.wikipedia.org/wiki/Cascading_Style_Sheets\" rel=\"nofollow noreferrer\">CSS</a>, perhaps <a href=\"https://en.wikipedia.org/wiki/JavaScript\" rel=\"nofollow noreferrer\">JavaScript</a> and <a href=\"https://en.wikipedia.org/wiki/Ajax_(programming)\" rel=\"nofollow noreferrer\">AJAX</a>). Then your user would use his/her browser to query the state of (or perhaps interact with) your application, or use some HTTP client command like <a href=\"https://curl.haxx.se/\" rel=\"nofollow noreferrer\">curl</a>. I recommend that route, but it does require some work and familiarity with Web techniques.</p>\n\n<p>You might also be interested by the <a href=\"https://www.libssh.org/\" rel=\"nofollow noreferrer\">libssh</a> library.</p>\n\n<p>You could decide that your application becomes a service, and interface it to <a href=\"https://en.wikipedia.org/wiki/Systemd\" rel=\"nofollow noreferrer\">systemd</a>.</p>\n\n<p>PS. You should dedicate several days to <em>read</em> stuff before coding.</p>\n"}], "owner": {"reputation": 21, "user_id": 3303433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0MzZh.jpg?s=128&g=1", "display_name": "VictorV", "link": "https://stackoverflow.com/users/3303433/victorv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1542888555, "creation_date": 1542779315, "question_id": 53405943, "link": "https://stackoverflow.com/questions/53405943/how-do-i-create-a-linux-c-application-with-a-console-that-i-can-connect-to-remot", "title": "How do I create a linux C application with a console that I can connect to remotely", "body": "<p>I have a multi-threaded application written in\nC that runs under Debian (Stretch).  One of the\nthreads is a simple console that supports several\ncommands to control the application.  Normally\nthis application is started automatically when\nthe system boots and runs in the background with\nthe console thread disabled.</p>\n\n<p>I am looking for a way to \"connect\" to the application remotely so that I can use the console.\nThe connection could either be direct using a\nport or I can just ssh to the box and then \nconnect to the app.</p>\n\n<p>During development I just run the app interactively\nbut would like the option to debug after it has\nalready started.</p>\n\n<p>I thought something like netcat might work but it\nseems to use TCP/IP ports whereas the console thread just connects to stdin/stdout.</p>\n\n<p>Is there a way to accomplish this?</p>\n"}, {"tags": ["c", "embedded-linux"], "comments": [{"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542778990, "post_id": 53405808, "comment_id": 93686601, "body": "<code>system()</code> spawns a child process which is used to execute the command. I&#39;d call <a href=\"http://man7.org/linux/man-pages/man2/reboot.2.html\" rel=\"nofollow noreferrer\">reboot()</a> directly. As for security please have a look at the comments to <a href=\"https://stackoverflow.com/questions/19913446/why-should-the-system-function-be-avoided-in-c-and-c\">Why should the system() function be avoided in C and C++?</a>"}, {"owner": {"reputation": 415, "user_id": 10669327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6051fc808e6d6c453bf165e339d09a6a?s=128&d=identicon&r=PG&f=1", "display_name": "raj123", "link": "https://stackoverflow.com/users/10669327/raj123"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542780014, "post_id": 53405808, "comment_id": 93686923, "body": "thanks got it we have to avoid system call.So how can I perform same functionality without system call?@Swordfish"}, {"owner": {"reputation": 415, "user_id": 10669327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6051fc808e6d6c453bf165e339d09a6a?s=128&d=identicon&r=PG&f=1", "display_name": "raj123", "link": "https://stackoverflow.com/users/10669327/raj123"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542780167, "post_id": 53405808, "comment_id": 93686981, "body": "I also read about <a href=\"http://man7.org/linux/man-pages/man2/reboot.2.html\" rel=\"nofollow noreferrer\">reboot</a> but couldn&#39;t getting it how can I use it to shutdown my system.@Swordfish"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542780653, "post_id": 53405808, "comment_id": 93687143, "body": "<a href=\"https://stackoverflow.com/a/31652816/3975177\">stackoverflow.com/a/31652816/3975177</a>"}, {"owner": {"reputation": 415, "user_id": 10669327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6051fc808e6d6c453bf165e339d09a6a?s=128&d=identicon&r=PG&f=1", "display_name": "raj123", "link": "https://stackoverflow.com/users/10669327/raj123"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542781089, "post_id": 53405808, "comment_id": 93687314, "body": "It says system(&quot;/bin/sh shutdown -P now&quot;) also safe to use Is it?@Swordfish"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542782544, "post_id": 53405808, "comment_id": 93687857, "body": "<a href=\"https://stackoverflow.com/questions/43197676/is-system-call-in-c-program-safe\" title=\"is system call in c program safe\">stackoverflow.com/questions/43197676/&hellip;</a>"}, {"owner": {"reputation": 3209, "user_id": 5794048, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Egkox.jpg?s=128&g=1", "display_name": "Murphy", "link": "https://stackoverflow.com/users/5794048/murphy"}, "edited": false, "score": 0, "creation_date": 1542972793, "post_id": 53405808, "comment_id": 93764608, "body": "From the cited manpage: &quot;Only the superuser may call reboot().&quot; If you&#39;re not running your program as <code>root</code>, you may have to set the appropriate <a href=\"http://man7.org/linux/man-pages/man7/capabilities.7.html\" rel=\"nofollow noreferrer\">capability</a> to it, or find another way."}], "answers": [{"comments": [{"owner": {"reputation": 415, "user_id": 10669327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6051fc808e6d6c453bf165e339d09a6a?s=128&d=identicon&r=PG&f=1", "display_name": "raj123", "link": "https://stackoverflow.com/users/10669327/raj123"}, "edited": false, "score": 0, "creation_date": 1545342960, "post_id": 53862139, "comment_id": 94600488, "body": "got it thanks. but to use this we need have to use setcap cap_sys_boot+ep executabe_file @Cinder Biscuits"}, {"owner": {"reputation": 30791, "user_id": 350428, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2d505d3fd867e284a384986533c2e5f8?s=128&d=identicon&r=PG", "display_name": "Axel Fontaine", "link": "https://stackoverflow.com/users/350428/axel-fontaine"}, "edited": false, "score": 1, "creation_date": 1617647423, "post_id": 53862139, "comment_id": 118356654, "body": "To shutdown instead of rebooting simply use <code>reboot(RB_POWER_OFF);</code>"}], "tags": [], "owner": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "is_accepted": false, "score": 2, "last_activity_date": 1545277387, "creation_date": 1545277387, "answer_id": 53862139, "question_id": 53405808, "link": "https://stackoverflow.com/questions/53405808/c-function-to-shutdown-linux-system/53862139#53862139", "title": "C function to shutdown linux system", "body": "<p><a href=\"http://man7.org/linux/man-pages/man2/reboot.2.html\" rel=\"nofollow noreferrer\">man reboot(2)</a></p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;sys/reboot.h&gt;\n\nint main () {\n    sync();    // If reboot() not preceded by a sync(), data will be lost.\n    setuid(0); // set uid to root, the running uid must already have the\n               // appropriate permissions to do this.\n    reboot(RB_AUTOBOOT); // note, this reboots the system, it's not as\n    return(0);           // graceful as asking the init system to reboot.\n}\n</code></pre>\n\n<p>Pre-systemd, you could also sometimes get away with:</p>\n\n<pre><code>int main() {\n    sync();\n    kill(1, SIGTERM);\n    return 0;\n}\n</code></pre>\n\n<p>This method was more prevalent on embedded systems where the program is run under a single shell, but killing initd was effective as well. Note that on newer GNU/Linux's that use systemd/upstart, <code>SIGTERM</code> is ignored by systemd.</p>\n"}], "owner": {"reputation": 415, "user_id": 10669327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6051fc808e6d6c453bf165e339d09a6a?s=128&d=identicon&r=PG&f=1", "display_name": "raj123", "link": "https://stackoverflow.com/users/10669327/raj123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 913, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1545277387, "creation_date": 1542778528, "last_edit_date": 1542779184, "question_id": 53405808, "link": "https://stackoverflow.com/questions/53405808/c-function-to-shutdown-linux-system", "title": "C function to shutdown linux system", "body": "<p>I am developing C function to shutdown my Embedded Linux system (Ubuntu) using the following way.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nint main() \n{\n    system(\"shutdown -P now\");\n    return 0;\n}\n</code></pre>\n\n<p>Is this approach is secure?<br />If not is there any better and secure way I can perform same task?</p>\n"}, {"tags": ["c", "scope"], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1542779525, "post_id": 53405951, "comment_id": 93686758, "body": "In strict C99 or later, functions do not default to anything; they must be declared (or defined) before they are used."}, {"owner": {"reputation": 43, "user_id": 780953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1ba9127a4c2387dc2e610f608012adb?s=128&d=identicon&r=PG", "display_name": "bd3lk", "link": "https://stackoverflow.com/users/780953/bd3lk"}, "edited": false, "score": 0, "creation_date": 1542851772, "post_id": 53405951, "comment_id": 93720162, "body": "I think i&#39;m more interested in C89 behaviour, but thanks for the info."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 1, "last_activity_date": 1542779603, "last_edit_date": 1542779603, "creation_date": 1542779349, "answer_id": 53405951, "question_id": 53405773, "link": "https://stackoverflow.com/questions/53405773/scope-of-function-prototypes-in-c-file-instead-of-header/53405951#53405951", "title": "Scope of function prototypes in c file instead of header", "body": "<p>1) Yes, but accidentally. A function with no declarator will default to <code>int</code> type, and its parameters will default to <code>int</code> type, and storage class will default to <code>extern</code>. Your function happens to already have those types. Thus, the declarator is not needed, strictly speaking (though it is a very bad practice to not use one). However, this has apparently been made illegal in C99, and if you are using C99 semantics, you should get an error; otherwise it is just a warning (<code>-Wimplicit-function-declaration</code>).</p>\n\n<p>2) As said above, the lack of storage class specifier in the <code>test.h</code> declarator will implicitly declare <code>f1</code> as extern. All is well.</p>\n\n<p>3) The linker will raise an error regarding duplicate identifier. If you use <code>extern int x;</code> (with no initialisation), it works. Variables don't get implicit declarations; if you just attempt to use <code>x</code> in <code>main.c</code> without the above declaration, you will get an error regarding use of an undeclared variable.</p>\n\n<p>4) <code>static</code> means several different things. I assume the question is about static functions. This only restricts the visibility of the function to the current compilation unit; there is no other effect.</p>\n\n<p>5) As noted above, making a function static only affects what can access <em>it</em>, not what <em>it</em> can access.</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1542785039, "post_id": 53405964, "comment_id": 93688887, "body": "In C90, the assumed return type of a function was indeed <code>int</code>, but nothing was assumed about the arguments except that they were subject to default argument promotion rules.  C99 and above does not, strictly, allow functions to be used before they are declared (or defined)."}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1542785355, "post_id": 53405964, "comment_id": 93689002, "body": "So, in practice an <code>int</code> or <code>int, int</code> or <code>char</code> argument is OK, but not <code>float</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1542785549, "post_id": 53405964, "comment_id": 93689085, "body": "Nope.  A <code>float</code> will be promoted to <code>double</code>, that&#39;s all.  You can pass <code>char *</code> and <code>struct Anything *</code> and so on too.  Further, the compiler isn&#39;t required to check your calls for consistency.  If you use an explicit function declaration like <code>extern int function();</code> then that has no prototype and any arguments are default promoted and there&#39;s no guarantee the compiler will cross-check different calls for consistency.  The C99 rules require a declaration; they don&#39;t require a prototype declaration, though.  You should tell your compiler to require strict prototype declarations if possible."}, {"owner": {"reputation": 43, "user_id": 780953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1ba9127a4c2387dc2e610f608012adb?s=128&d=identicon&r=PG", "display_name": "bd3lk", "link": "https://stackoverflow.com/users/780953/bd3lk"}, "edited": false, "score": 0, "creation_date": 1542851332, "post_id": 53405964, "comment_id": 93720072, "body": "Hi, so I don&#39;t understand the first answer. what is a &#39;default function&#39; ? My question is if main() can call f2(), even though it can&#39;t see the function declaration, as it&#39;s not in the test.h header file. will this return a compiler / linker / runtime error/warning ?"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "reply_to_user": {"reputation": 43, "user_id": 780953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1ba9127a4c2387dc2e610f608012adb?s=128&d=identicon&r=PG", "display_name": "bd3lk", "link": "https://stackoverflow.com/users/780953/bd3lk"}, "edited": false, "score": 0, "creation_date": 1542859525, "post_id": 53405964, "comment_id": 93721761, "body": "@Rosh - In C89 and before, if there was no declaration the compiler would implicitly assume that the function will return an <code>int</code>. A warning may be given based on your flags."}], "tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 0, "last_activity_date": 1542779733, "last_edit_date": 1542779733, "creation_date": 1542779404, "answer_id": 53405964, "question_id": 53405773, "link": "https://stackoverflow.com/questions/53405773/scope-of-function-prototypes-in-c-file-instead-of-header/53405964#53405964", "title": "Scope of function prototypes in c file instead of header", "body": "<blockquote>\n  <p>Can main.c access f2() which is implemented and prototype declared inside test2.c</p>\n</blockquote>\n\n<p>The function <code>f2</code> will be taken as a default function which has return value of int and parameters <code>int</code> if any. However, if you use different parameters, it will give an error. </p>\n\n<p>From C99 onwards, the default function is not applicable and this will give an error.</p>\n\n<blockquote>\n  <p>Can main.c access f1()? or does it need to be declared as extern</p>\n</blockquote>\n\n<p>Yes, it can access f1() as you have included <code>test.h</code> However you also need to compile <code>test.c</code> and give both files to the linker. </p>\n\n<p><code>f1()</code> declaration in <code>test.h</code> does not need to be declared as extern. By default, a function declaration is extern.</p>\n\n<blockquote>\n  <p>Does main.c have access to the x global variable inside test.c? Will it conflict with the global variable x (same name) defined in main.c?</p>\n</blockquote>\n\n<p>You need to link the variables together. Once you do you will get a linker error for this.</p>\n\n<blockquote>\n  <p>To gain local scope is it mandatory to use static keyword?</p>\n</blockquote>\n\n<p>If the variable is declared outside a function, it is global. To make it local scope you need to specifically use the static keyword.</p>\n\n<blockquote>\n  <p>Can static functions access global variables (static/non-static) defined in the same .c file ?</p>\n</blockquote>\n\n<p>Yes</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 780953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1ba9127a4c2387dc2e610f608012adb?s=128&d=identicon&r=PG", "display_name": "bd3lk", "link": "https://stackoverflow.com/users/780953/bd3lk"}, "edited": false, "score": 0, "creation_date": 1542851590, "post_id": 53406162, "comment_id": 93720127, "body": "I understand the answer is compiler/linker specific. I&#39;m compiling for the MSP430 platform, so assume the msp-gcc compiler (C89). But I would like to know the behaviour latest standard GCC compiler and Gnu tools (assuming set to C89). So for the first question - if i compile and run the above, will it produce a compiler/linker/runtime error/warning ?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 43, "user_id": 780953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1ba9127a4c2387dc2e610f608012adb?s=128&d=identicon&r=PG", "display_name": "bd3lk", "link": "https://stackoverflow.com/users/780953/bd3lk"}, "edited": false, "score": 0, "creation_date": 1542859809, "post_id": 53406162, "comment_id": 93721830, "body": "@Rosh, if what you are taking away is that the answer is compiler-specific, then you are missing the point: write conforming code, so that its behavior is <i>not</i> compiler specific.  It is not that hard to do.  As for GCC&#39;s behavior with respect to any of these questions, have you not considered trying it out for yourself?  It turns out, though, that GCC is among the compilers that still accepts implicit function declarations.  It will emit a warning about them under many combinations of options, and if you wish, you can cause that to be emitted as an error instead."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 3, "last_activity_date": 1542781211, "last_edit_date": 1542781211, "creation_date": 1542780496, "answer_id": 53406162, "question_id": 53405773, "link": "https://stackoverflow.com/questions/53405773/scope-of-function-prototypes-in-c-file-instead-of-header/53406162#53406162", "title": "Scope of function prototypes in c file instead of header", "body": "<p>In answering your questions, I suppose that the two .c sources are compiled and linked together into one program.</p>\n\n<blockquote>\n  <ul>\n  <li>Can <code>main.c</code> access <code>f2()</code> which is implemented and prototype declared inside <code>test2.c</code></li>\n  </ul>\n</blockquote>\n\n<p>Modern C does not permit calls to functions that have no declaration in scope, but K&amp;R C did permit such calls, and most implementations do still allow them.  Moreover, <code>main.c</code> could declare the function itself and then call it.</p>\n\n<blockquote>\n  <ul>\n  <li>Can <code>main.c</code> access <code>f1()</code>? or does it need to be declared as <code>extern</code></li>\n  </ul>\n</blockquote>\n\n<p>Functions have external linkage by default.  Accordingly, <code>extern</code> is the default for function declarations.  You may explicitly specify <code>extern</code>, but that's redundant.</p>\n\n<blockquote>\n  <ul>\n  <li>Does <code>main.c</code> have access to the <code>x</code> global variable inside <code>test.c</code>? Will it conflict with the global variable <code>x</code> (same name) defined in\n  main.c?</li>\n  </ul>\n</blockquote>\n\n<p>Yes and no.  It is <em>erroneous</em> for one program to contain two definitions of the same identifier with external linkage, and both your declarations of <code>x</code> do indeed constitute definitions, and both do indeed (by default) have external linkage.</p>\n\n<p>However, some implementations will merge those into one variable, others will refuse to link the program, and others might even maintain separate <code>x</code> variables.</p>\n\n<p>The right way to declare a variable that is shared across source files, by the way, is for each file to declare it, <code>extern</code>, but for exactly one to initialize it.  Usually, the <code>extern</code> declarations without initializer would go into a header file, and a single declaration with an initializer (which makes it a definition) would go into one .c file.  Example:</p>\n\n<hr>\n\n<p><strong>test.h</strong></p>\n\n<pre><code>extern int x; // _with_ extern, _without_ initializer\n</code></pre>\n\n<hr>\n\n<p><strong>test.c</strong></p>\n\n<pre><code>#include \"test.h\"\nint x = 0;  // 'extern' is optional here\n</code></pre>\n\n<hr>\n\n<p><strong>main.c</strong></p>\n\n<pre><code>#include \"test.h\"\n// no further declaration of x here\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <ul>\n  <li>To gain local scope is it mandatory to use <code>static</code> keyword?</li>\n  </ul>\n</blockquote>\n\n<p>The <code>static</code> and <code>extern</code> keywords are about <em>linkage</em>, not scope.  Linkage has to do with which code can access which objects and functions.  Scope is about which code can see which <em>declarations</em>.  Although they sound similar, these are in fact quite distinct concepts, because the same object or function can be declared multiple times.  In fact, that's routine -- it's one of the primary purposes served by header files.</p>\n\n<blockquote>\n  <ul>\n  <li>Can static functions access global variables (static/non-static) defined in the same <code>.c</code> file ?</li>\n  </ul>\n</blockquote>\n\n<p>Yes, where I interpret \"global\" to mean \"declared at file scope\".  C does not have a concept of global variables <em>per se</em>, but objects declared outside any function exist for the whole duration of the program.  Those with external linkage can be accessed from any code in the program where declarations of their identifiers are in scope.  Those with internal linkage (declared by the <code>static</code> keyword) can be accessed only from within the same translation unit, which roughly means the same .c file.</p>\n\n<p>It is also possible for an object to have <em>no</em> linkage.  This is the case for objects declared inside functions.</p>\n"}], "owner": {"reputation": 43, "user_id": 780953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1ba9127a4c2387dc2e610f608012adb?s=128&d=identicon&r=PG", "display_name": "bd3lk", "link": "https://stackoverflow.com/users/780953/bd3lk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1542851130, "creation_date": 1542778283, "last_edit_date": 1542851130, "question_id": 53405773, "link": "https://stackoverflow.com/questions/53405773/scope-of-function-prototypes-in-c-file-instead-of-header", "title": "Scope of function prototypes in c file instead of header", "body": "<p>Apologies if this question has been asked before (I only found variants to this question on SO, but not the exact one)</p>\n\n<p>My question is regarding scope w.r.t where the function prototype is defined.</p>\n\n<p>Assume we have 3 files : <code>test.h</code>, <code>test.c</code>, <code>main.c</code></p>\n\n<p><code>main.c</code> and <code>test.c</code> both includes <code>test.h</code></p>\n\n<p><strong>test.c</strong>:</p>\n\n<pre><code>int f2(int b); // function prototype (local)\n\nint x=0;\n// public function\nint f1(int a){\n return a*5;      \n}\n// local function\nint f2(int b){\n return b*10;\n}\n</code></pre>\n\n<p><strong>test.h</strong>:</p>\n\n<pre><code>int f1(int a);\n</code></pre>\n\n<p><strong>main.c</strong>:</p>\n\n<pre><code>#include \"test.h\"\nint x=1;\nint main(){\n    printf(\"%d \\n\", f1(5));\n    printf(\"%d \\n\", f2(5));\n    return 0;\n}\n</code></pre>\n\n<p>My question is:</p>\n\n<ul>\n<li>Can <code>main.c</code> access <code>f2()</code> which is implemented and prototype declared inside <code>test.c</code></li>\n<li>Can <code>main.c</code> access <code>f1()</code>? or does it need to be declared as <code>extern</code></li>\n<li>Does <code>main.c</code> have access to the <code>x</code> global variable inside <code>test.c</code>? Will it conflict with the global variable <code>x</code> (same name) defined in <code>main.c</code>?</li>\n<li>To gain local scope is it mandatory to use <code>static</code> keyword?</li>\n<li>Can static functions access global variables (static/non-static) defined in the same <code>.c</code> file ?</li>\n</ul>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1542771383, "post_id": 53404878, "comment_id": 93684807, "body": "see <a href=\"https://stackoverflow.com/a/26279717/1708801\">String Literal address across translation units</a>"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1542771400, "post_id": 53404878, "comment_id": 93684810, "body": "String literals are often &quot;merged&quot; so that there&#39;s only one copy of any given string. Check the pointer values."}, {"owner": {"reputation": 611, "user_id": 7533465, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2ad686c2498e8b4b204a934ff4242dc?s=128&d=identicon&r=PG&f=1", "display_name": "umop apisdn", "link": "https://stackoverflow.com/users/7533465/umop-apisdn"}, "edited": false, "score": 0, "creation_date": 1542771473, "post_id": 53404878, "comment_id": 93684834, "body": "Thanks for the rapid responses! Somehow when I searched I could not find these posts, but they are very helpful!"}], "answers": [{"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": true, "score": 4, "last_activity_date": 1542771490, "creation_date": 1542771490, "answer_id": 53404924, "question_id": 53404878, "link": "https://stackoverflow.com/questions/53404878/why-does-return-true-for-character-pointers/53404924#53404924", "title": "Why does &quot;==&quot; return true for character pointers?", "body": "<p>Because the two addresses <em>are</em> the same. Your compiler included one copy of the string \"Hello\" in your program and made <code>str1</code> and <code>str2</code> both point to it.</p>\n\n<p>The C standard specifies that <a href=\"https://stackoverflow.com/a/2245983/152948\">string literals might or might not be distinct arrays in memory, and that undefined things might happen if you modify them</a> in order to allow the compiler to do exactly this.</p>\n"}], "owner": {"reputation": 611, "user_id": 7533465, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2ad686c2498e8b4b204a934ff4242dc?s=128&d=identicon&r=PG&f=1", "display_name": "umop apisdn", "link": "https://stackoverflow.com/users/7533465/umop-apisdn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "closed_date": 1542775060, "accepted_answer_id": 53404924, "answer_count": 1, "score": 2, "last_activity_date": 1542771490, "creation_date": 1542771128, "question_id": 53404878, "link": "https://stackoverflow.com/questions/53404878/why-does-return-true-for-character-pointers", "closed_reason": "Duplicate", "title": "Why does &quot;==&quot; return true for character pointers?", "body": "<p>When we compare strings in C, we are careful to use <code>strcmp</code> (or its other variants) to do equality checks. For example, if one string is <code>char hello1[7] = \"hello!\"</code> and another string is <code>char hello2[7] = \"hello!\"</code>, we can check if their contents are equal using <code>strcmp</code>. However, we cannot use <code>==</code> since <code>==</code> will compare the address of the first element of each array (due to array decay), and that is always false.</p>\n\n<p>So why is it that when I try to compare two <code>char *</code> with <code>==</code>, the result is true? For example:</p>\n\n<pre><code>int main() {\n  char *str1 = \"Hello\";\n  char *str2 = \"Hello\";\n\n  if (str1 == str2) {\n    printf(\"equal\\n\");\n  } else {\n    printf(\"not equal\\n\");\n  }\n}\n</code></pre>\n\n<p>This will print <code>equal</code>. Based on my understanding, a pointer is essentially an address, so a <code>char *</code> is an address of a location containing a character. So how can two addresses be the same here?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1542771085, "post_id": 53404841, "comment_id": 93684731, "body": "Why don&#39;t you read <code>int</code>s using <code>scanf()</code> when you want <code>int</code>s? <code>while ((c = (char) getchar()) != &#39;=&#39;)</code> is why your code only processes the first line."}, {"owner": {"reputation": 15, "user_id": 9550328, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "GameCoder", "link": "https://stackoverflow.com/users/9550328/gamecoder"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542771719, "post_id": 53404841, "comment_id": 93684891, "body": "I needed to find a way to split the characters between input and exit once it reaches = unless it can be done with scanf and still work the same. getchar just seemed easier since it reads character by character."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542772712, "post_id": 53404841, "comment_id": 93685112, "body": "You have to get rid of the misconception that you need to read single chars in the first place. You want numbers? Read numbers."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": true, "score": 0, "last_activity_date": 1542772487, "creation_date": 1542772487, "answer_id": 53405038, "question_id": 53404841, "link": "https://stackoverflow.com/questions/53404841/c-checking-for-eof/53405038#53405038", "title": "C Checking for EOF", "body": "<p>Using <a href=\"https://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\"><code>scanf()</code></a> what you want is a 4-liner:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int a, b;\n    char op, ch;\n    while (scanf(\" %d %c %d %c\", &amp;a, &amp;op, &amp;b, &amp;ch) == 4 &amp;&amp; op == '+' &amp;&amp; ch == '=')\n        printf(\"%d+%d=%d\\n\", a, b, a + b);\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9550328, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "GameCoder", "link": "https://stackoverflow.com/users/9550328/gamecoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 53405038, "answer_count": 1, "score": 0, "last_activity_date": 1542772487, "creation_date": 1542770750, "question_id": 53404841, "link": "https://stackoverflow.com/questions/53404841/c-checking-for-eof", "title": "C Checking for EOF", "body": "<p>I developed a C program that does addition of integers but the problem I am having with this is that it needs to take input from stdin via input text (not interactive). However after testing I can only get it to work for a single line of input when it should work for multiple, assume this sample input are all in a single input file ((Line 1) 123+456= (Line 2) 999999999+1= ).</p>\n\n<p>I think it has to do with EOF and it should go through and repeat until finished. I tried putting an EOF in the first while loop but the output is very different than what it should be. The input format has to stay the same and cannot be changed. Is there anyway I can get it to do operations until the end of input file?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdbool.h&gt;\n\nint main() {\n    char c;\n    char a[100], b[100], array[101];\n    int n = 0;\n//It should scan through everyrthing then exit and it think start arround HERE\n        while ((c = (char) getchar()) != '=') { \n        array[n] = c;\n        putchar(c);\n        n++;\n    }\n    printf(\"=\\n\");\n    array[n] = '\\0';\n    int n1 = 0, n2 = -1;\n    while (n1 + n2 &lt; n) { //Splits the array into two separate char arrays\n        if (array[n1] == '+') {\n            n2 = 0;\n            n1 += 1;\n        }\n        if (n2 == -1) {\n            a[n1] = array[n1];\n            n1++;\n        } else {\n            b[n2] = array[n1 + n2];\n            n2++;\n        }\n    }\n    n1--;\n    a[n1] = b[n2] = '\\0';\n    int i = 0, z = 0, p = 0;\n    char array2[101];\n    bool val = false;\n    while (n1 &gt; 0 || n2 &gt; 0) { //Addition Calculation\n        int x = 0, y = 0;\n        if (n1 &gt; 0)\n            x = a[n1 - 1] - '0';\n\n        if (n2 &gt; 0)\n            y = b[n2 - 1] - '0';\n        z = x + y;\n\n        if (val)\n            z = z + p;\n\n        if (z &gt; 9) {\n            p = z % 10;\n            array2[i++] = (char) (p + '0');\n            p = z / 10;\n            val = true;\n\n        } else {\n            array2[i++] = (char) (z + '0');\n            val = false;\n        }\n        n1--;\n        n2--;\n    }\n    if (val) {\n        array2[i++] = (char) (p + '0');\n        array2[i] = '\\0';\n    }\n\n    for (n = i - 1; n &gt;= 0; n--) { //Print Result\n        printf(\"%c\", array2[n]);\n    }\n    printf(\"\\n\");\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "multicast"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1542769940, "post_id": 53404635, "comment_id": 93684484, "body": "And what does the error code say? <code>strerror(errno)</code>"}, {"owner": {"reputation": 11, "user_id": 10683216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e351eff630a98b6997d9e5eb61b8bd5?s=128&d=identicon&r=PG&f=1", "display_name": "jerron", "link": "https://stackoverflow.com/users/10683216/jerron"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1542777338, "post_id": 53404635, "comment_id": 93686201, "body": "Thanks for your clue, it really helps, strerror shows &quot;bad address&quot;,then I searched online and found a  thread says &quot;last arg of recvfrom is the address of the len instead of len it self&quot;\uff0cso problem solved!"}], "owner": {"reputation": 11, "user_id": 10683216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e351eff630a98b6997d9e5eb61b8bd5?s=128&d=identicon&r=PG&f=1", "display_name": "jerron", "link": "https://stackoverflow.com/users/10683216/jerron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542768624, "creation_date": 1542768624, "question_id": 53404635, "link": "https://stackoverflow.com/questions/53404635/why-do-i-get-1-when-recvfrom-from-a-multicast-group-address", "title": "Why do I get -1 when recvfrom() from a multicast group address?", "body": "<p>I am writting a LAN device detect test which can send a request to a multicast group 239.255.255.250 and get response from device where in same LAN as well, </p>\n\n<p>Wireshark tells me, join to group(IGMPv2) is good, sending(UDP) is good, reciving(UDP) is good, BUT in my code, It keeps return -1 when recvfrom(), Whatever I tried, it's always -1...\nI ever tried a 3rd party app in windows, it can send&amp;recive normally.</p>\n\n<p>Could anybody gives me a clue ? Thx in advance.</p>\n\n<pre><code>    socket = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP));\n    setsockopt(socket, SOL_SOCKET, SO_RCVTIMEO, &amp;timeout, sizeof(timeout));\n    setsockopt(socket, SOL_SOCKET, SO_IFDEVICE, &amp;i8IfIndex, sizeof(i8IfIndex));\n    setsockopt(socket, SOL_SOCKET, SO_BROADCAST, &amp;u8On, sizeof(int));\n    /*all aboved checked alright*/\n\n    /*join to multicast group*/\n    struct ip_mreq mreq;\n    mreq.imr_multiaddr.s_addr = htonl(0xEFFFFFFA); /*239.255.255.250*/\n    mreq.imr_interface.s_addr = INADDR_ANY; \n    setsockopt(socket, IPPROTO_IP, IP_ADD_MEMBERSHIP, &amp;mreq, sizeof(mreq)); \n\n    memset(&amp;socket_address, 0, sizeof(socket_address));\n    socket_address.sin_addr.s_addr = htonl(0xEFFFFFFA); \n    socket_address.sin_family = AF_INET;\n    socket_address.sin_port = htons(37020);     \n    //no help:bind(socket, (PSA) &amp;socket_address, sizeof(socket_address));\n\n    memset(&amp;socket_address2, 0, sizeof(socket_address2));\n    socket_address2.sin_addr.s_addr = INADDR_ANY; \n    socket_address2.sin_family = AF_INET;\n    socket_address2.sin_port = 0;   \n\n    /*send &amp; recv*/\n    int8 i8Result = 0xcc;\n    char *inquryStr = \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?&gt;&lt;Probe&gt;&lt;Uuid&gt;232B1234-FBcC-48B5-AC06-AE1F77051280&lt;/Uuid&gt;&lt;Types&gt;inquiry&lt;/Types&gt;&lt;/Probe&gt;\";\n    if(i8Result = sendto(socket, inquryStr, strlen(inquryStr), 0, (PSA) &amp;socket_address, sizeof(socket_address))) {\n        //wireshark detected ,i8Result shows 0x7C sent\n        if(i8Result = recvfrom(socket, g_HjtOsdComm.u8TRBuf, 1024, 0, (PSA) &amp;socket_address2, sizeof(socket_address2))) {\n            //wireshark detected ,but i8Result get-1\n        }\n    }\n\n    /*leave group*/\n    setsockopt(socket, IPPROTO_IP, IP_DROP_MEMBERSHIP, &amp;mreq, sizeof(mreq));\n\n    fdClose(HjtOsdSocket);\n</code></pre>\n"}, {"tags": ["c", "api", "llvm"], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 7471862, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bef6b1bc2e55b35c66067459e67c414a?s=128&d=identicon&r=PG&f=1", "display_name": "freyone", "link": "https://stackoverflow.com/users/7471862/freyone"}, "edited": false, "score": 0, "creation_date": 1542852001, "post_id": 53422059, "comment_id": 93720213, "body": "thanks your example.now i knew the allocated value is already the point value\uff0cso do nothing for &quot;&amp;&quot; operator,only when get the content ,need to &quot;load&quot; the content from the pointer."}], "tags": [], "owner": {"reputation": 106, "user_id": 10540299, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nlFk2LE4m2k/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBIQIiX6aq5TxYyssuhd1Ic0CvEjg/mo/photo.jpg?sz=128", "display_name": "Foivos Ts", "link": "https://stackoverflow.com/users/10540299/foivos-ts"}, "is_accepted": false, "score": 1, "last_activity_date": 1542845124, "last_edit_date": 1542845124, "creation_date": 1542844303, "answer_id": 53422059, "question_id": 53404596, "link": "https://stackoverflow.com/questions/53404596/how-to-use-llvmbuildstore-api/53422059#53422059", "title": "How to use LLVMBuildStore API", "body": "<p>Given that you have provided the address assignment expression to j, I suppose that the variables are not globals, but rather allocated inside a function.</p>\n\n<p>So, to translate this C snippet into LLVM IR, you first need to allocate space in the stack for variable i and pointer j, and then store constant 3 to the address of i and the address of i to the address of pointer j.</p>\n\n<p>In LLVM IR:</p>\n\n<pre><code>%i = alloca i64, align 8  ;allocation for i. %i is a pointer i64* to variable i\n%j = alloca i64*, align 8  ;respectively, the type of %j is i64** (pointer to i64*)\nstore i64 3, i64* %i, align 8  ; i=3\nstore i64* %i, i64** %j, align 8  ; store %i (the address of var i) to the address of pointer j\n</code></pre>\n\n<p>I do not know how to generate these instructions using the LLVM C API, because I have never used it. However, hopefully there might be a relevance between the C and C++ API and maybe providing the code that I would write using the C++ API might help you get an idea of the type of arguments you need to use. I hope it helps.</p>\n\n<pre><code>AllocaInst *alloc_i = new AllocaInst(Type::getInt64Ty(M.getContext()), //Type i64\n                                          0,        //AddressSpace\n                                          nullptr,  //Arraysize\n                                          8,        //Alignment\n                                          \"i\",      //name of result in IR. Leave \"\" for default\n                                          I);       //Add alloca instruction before Instruction I\n\nAllocaInst *alloc_j = new AllocaInst(Type::getInt64PtrTy(M.getContext()), //Type i64*\n                                          0,        //AddressSpace\n                                          nullptr,  //Arraysize\n                                          8,        //Alignment\n                                          \"i\",      //name of result in IR. Leave \"\" for default\n                                          I);       //Add alloca instruction before Instruction I\n\nStoreInst *store_i = new StoreInst(ConstantInt::get(Type::getInt64Ty(M.getContext()), 3), //get constant 3 of type i64\n                                          alloc_i,   //store to the result Value* of alloc_i\n                                          false, \n                                          8,         //Alignment\n                                          I);        //Insert before instr I\n\nStoreInst *store_j = new StoreInst(alloc_i,   //i64* pointer to i\n                                          alloc_j,   //store to the address of pointer j\n                                          false, \n                                          8,         //Alignment\n                                          I);        //Insert before instr I\n</code></pre>\n\n<p>Finally, consider using the C++ API instead.</p>\n"}, {"tags": [], "owner": {"reputation": 916, "user_id": 3853175, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BG7vO.png?s=128&g=1", "display_name": "JKRT", "link": "https://stackoverflow.com/users/3853175/jkrt"}, "is_accepted": false, "score": 1, "last_activity_date": 1542924529, "creation_date": 1542924529, "answer_id": 53438497, "question_id": 53404596, "link": "https://stackoverflow.com/questions/53404596/how-to-use-llvmbuildstore-api/53438497#53438497", "title": "How to use LLVMBuildStore API", "body": "<p>Considering the following C function </p>\n\n<pre><code>int main() {\n      long i=3;\n      long *j;\n      j=&amp;i;\n      return 0;\n}\n</code></pre>\n\n<p>Clang 3.8 will generate:</p>\n\n<pre><code>define i32 @main() {\n  %1 = alloca i32, align 4\n  %2 = alloca i64, align 8\n  %3 = alloca i64*, align 8\n  store i32 0, i32* %1, align 4\n  store i64 3, i64* %2, align 8\n  store i64* %2, i64** %3, align 8\n  ret i32 0\n}\n</code></pre>\n\n<p>What we can see from the generated code is that clang generates a single basic block. \nIn this basic block we generate three alloca instructions and three store instructions and one ret instruction which terminates the basic block.</p>\n\n<p>For store instructions, you can use LLVMBuildStore(). \nLLVMBuildStore takes three arguments, the first being your builder. The second parameter is what you would like to store the third is where to store it.\nFor the first two store instructions, you can use just use the LLVM value that represents your integers. </p>\n\n<p>For the third parameter use the LLVMBuildStore instruction directly without loading the variable. Where the second parameter is the LLVMValueRef you received from your previous LLVMBuildAlloca() which you got when creating :  </p>\n\n<pre><code>%2 = alloca i64*, align 8\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 7471862, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bef6b1bc2e55b35c66067459e67c414a?s=128&d=identicon&r=PG&f=1", "display_name": "freyone", "link": "https://stackoverflow.com/users/7471862/freyone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1542924529, "creation_date": 1542768295, "question_id": 53404596, "link": "https://stackoverflow.com/questions/53404596/how-to-use-llvmbuildstore-api", "title": "How to use LLVMBuildStore API", "body": "<pre><code>long i=3;\nlong *j;\nj=&amp;i;\n</code></pre>\n\n<p>I want to use LLVM C API to transform above code especially last line into llvm code .Now I search correct function in the LLVM C API ,I think should use \"LLVMBuildStore\",but there is \"&amp;\" operator,How can I translate it? LLVMBuildStore' second parameter is LLVMValueRef type value which refer to \"i\" in this case,how to get the address from this value?</p>\n"}, {"tags": ["c", "gcc", "gcc-warning"], "comments": [{"owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "edited": false, "score": 0, "creation_date": 1542762846, "post_id": 53403899, "comment_id": 93682956, "body": "Valgrind, GDB, etc"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 1, "creation_date": 1542763386, "post_id": 53403899, "comment_id": 93683078, "body": "<code>s</code> is not used at all after calling <code>func</code>, so this is a weird example"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1542763513, "post_id": 53403899, "comment_id": 93683109, "body": "It is not a &quot;<b>potential</b> error that <code>s</code> will not point to <code>*p</code>&quot;. It is clear that <code>s</code> is always <code>NULL</code>."}, {"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1542764457, "post_id": 53403899, "comment_id": 93683308, "body": "@WeatherVane I think OP realizes this. It is an example of an &quot;error&quot; by not taking a pointer to pointer as an output parameter and having the function populate the pointer."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 0, "creation_date": 1542764605, "post_id": 53403899, "comment_id": 93683341, "body": "@TypeIA since <code>s</code> is never used, its role is unclear but <code>s2</code> seems to be doing fine."}, {"owner": {"reputation": 513, "user_id": 8293226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ccfWx.png?s=128&g=1", "display_name": "mustachioed", "link": "https://stackoverflow.com/users/8293226/mustachioed"}, "edited": false, "score": 0, "creation_date": 1542766702, "post_id": 53403899, "comment_id": 93683817, "body": "<a href=\"https://clang-analyzer.llvm.org/\" rel=\"nofollow noreferrer\">Clang</a> has nice static analyzer."}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1542782703, "post_id": 53403899, "comment_id": 93687920, "body": "what about PC-Lint?"}], "answers": [{"tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 1, "last_activity_date": 1542764248, "last_edit_date": 1542764248, "creation_date": 1542763585, "answer_id": 53404034, "question_id": 53403899, "link": "https://stackoverflow.com/questions/53403899/are-there-any-tools-that-can-find-potential-errors-in-c-source-code/53404034#53404034", "title": "Are there any tools that can find potential errors in C source code?", "body": "<p>There is actually little <em>wrong</em> with that code other than abyssmal variable names :-)</p>\n\n<p>A <em>copy</em> of <code>s</code> is passed into the function as <code>p</code>, you change <code>p</code> then return it, finally assigning it to <code>s2</code>. At <em>no</em> point is <code>s</code> (or <code>p</code> or <code>s2</code>) used in a way that would cause undefined behaviour, unless the <code>malloc</code> fails, which is something you should account for:</p>\n\n<pre><code>p = malloc(32);\nif (p != NULL) memcpy(p, \"hello\", 6); // why not str[n]cpy ?\n</code></pre>\n\n<p>However, in terms of tools you can use to find problems, there are many. For example, linters, compilers with good diagnostic methods, memory trackers like <code>valgrind</code>, and debuggers like <code>gdb</code>.</p>\n\n<hr>\n\n<p>By far the most <em>important</em> tool is the wetware inside that skull of yours, <em>especially</em> with your addition of:</p>\n\n<blockquote>\n  <p>Suppose the programmer's intention is to allocate memory to s.</p>\n</blockquote>\n\n<p>I can think of <em>no</em> other tool that will catch the programmer's intention in that case. It's no different to figuring out the intent was to add two to a variable when the code states:</p>\n\n<pre><code>i++;\n</code></pre>\n"}], "owner": {"reputation": 474, "user_id": 10178858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8DOGg.jpg?s=128&g=1", "display_name": "gacopu", "link": "https://stackoverflow.com/users/10178858/gacopu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "closed_date": 1542792231, "answer_count": 1, "score": -1, "last_activity_date": 1542764248, "creation_date": 1542762360, "last_edit_date": 1542764033, "question_id": 53403899, "link": "https://stackoverflow.com/questions/53403899/are-there-any-tools-that-can-find-potential-errors-in-c-source-code", "closed_reason": "Not suitable for this site", "title": "Are there any tools that can find potential errors in C source code?", "body": "<p>For example, I have some code like this:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n\nchar *func(char *p) {\n    p = malloc(32);\n    memcpy(p, \"hello\", 6);\n    return p;\n}\n\nint main() {\n  char *s = NULL;\n  char *s2 = NULL;\n  s2 = func(s);\n  printf(\"%s\\n\", s2);\n  free(s2);\n  return 1;\n}\n</code></pre>\n\n<p>The code will work, but has a potential error that <code>s</code> will not point to <code>*p</code>(Suppose the programmer's intention is to allocate memory to s,). One can quickly find the error because it is very simple. But in a large project with many many codes, sometimes it is very hard to find an error like this. <code>gcc -Wall -Wextra</code> does not give warnings.</p>\n\n<p>Are there any tools that can find out this kind of error?</p>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1542761942, "post_id": 53403821, "comment_id": 93682735, "body": "What data are you saving? What is wrong with the data that is loaded?"}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 0, "creation_date": 1542762144, "post_id": 53403821, "comment_id": 93682783, "body": "Q: Have you tried looking at the output file in a hex editor, or the input struct with a debugger?  Q: Is there any chance the readers/writers might have different byte endianness?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1542762906, "post_id": 53403821, "comment_id": 93682974, "body": "We can&#39;t tell what type <code>ia-&gt;data</code> is. We can&#39;t tell what <code>intarr_create</code> does. This makes it hard to give a good answer."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1542762941, "post_id": 53403821, "comment_id": 93682982, "body": "Yes, it&#39;s not a very clear question, but you can infer a pretty good guess at the type by looking at the <code>fread</code> call."}], "answers": [{"tags": [], "owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "is_accepted": true, "score": 1, "last_activity_date": 1542762763, "creation_date": 1542762763, "answer_id": 53403943, "question_id": 53403821, "link": "https://stackoverflow.com/questions/53403821/troubles-with-files-in-c/53403943#53403943", "title": "Troubles with files in C", "body": "<p>In this line here, you are writing the contents of the pointer, not the data it points to.   If the length is sufficient, you'll potentially write other random data that follows it, subject to <em>undefined behavior</em>:</p>\n\n<pre><code>fwrite( &amp;ia-&gt;data, sizeof( int ), ia-&gt;len, f )\n</code></pre>\n\n<p>The problem is that you added one extra level of redirection by taking the address of <code>ia-&gt;data</code>.  It seems like you just had a copy-paste error or something.  Remove the <code>&amp;</code>:</p>\n\n<pre><code>fwrite( ia-&gt;data, sizeof( int ), ia-&gt;len, f )\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9931160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4b32b065fa61bf30ac8e4407e55a7e8?s=128&d=identicon&r=PG&f=1", "display_name": "zaack7", "link": "https://stackoverflow.com/users/9931160/zaack7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 53403943, "answer_count": 1, "score": -2, "last_activity_date": 1542762763, "creation_date": 1542761638, "last_edit_date": 1542761995, "question_id": 53403821, "link": "https://stackoverflow.com/questions/53403821/troubles-with-files-in-c", "title": "Troubles with files in C", "body": "<p>I am trying to write functions to help me with saving and loading files... but when I try to save my array from the file it is not matching the original one that I loaded in to the file. Here is my code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#include \"intarr.h\"\n\n/* LAB 6 TASK 1 */\n\n/*\n  Save the entire array ia into a file called 'filename' in a binary\n  file format that can be loaded by intarr_load_binary(). Returns\n  zero on success, or a non-zero error code on failure. Arrays of\n  length 0 should produce an output file containing an empty array.\n*/\n\nint intarr_save_binary( intarr_t* ia, const char* filename )\n{\n  FILE* f = fopen( \"filename\", \"wb\" );\n\n  if( f == NULL )\n  {\n    return 1;\n  }\n\n  if( fwrite( &amp;ia-&gt;len, sizeof( int ), 1, f ) != 1 )\n  {\n    return 1;\n  }\n\n  if( fwrite( &amp;ia-&gt;data, sizeof( int ), ia-&gt;len, f ) != ia-&gt;len )\n  {\n    return 1;\n  }\n\n  fclose( f );\n\n  return 0;\n}\n\n/*\n  Load a new array from the file called 'filename', that was\n  previously saved using intarr_save_binary(). Returns a pointer to a\n  newly-allocated intarr_t on success, or NULL on failure.\n*/\n\nintarr_t* intarr_load_binary( const char* filename )\n{\n  if( filename == NULL )\n  {\n    return NULL;\n  }\n\n  FILE* f = fopen( \"filename\", \"rb\" );\n\n  if( f == NULL )\n  {\n    return NULL;\n  }\n\n  int len;\n\n  if( fread( &amp;len, sizeof( int ), 1, f ) != 1 )\n  {\n    return NULL;\n  }\n\n  intarr_t* new_ia = intarr_create( len );\n\n  fread( new_ia-&gt;data, sizeof( int ), len, f );\n\n  fclose( f );\n\n  return new_ia;\n}\n</code></pre>\n\n<p>Also just to be clear intarr_t ia is just a struct with ia->data (array) and ia->len (len of array)</p>\n"}, {"tags": ["c", "algorithm", "math", "binary"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1542761630, "post_id": 53403775, "comment_id": 93682674, "body": "See <a href=\"https://graphics.stanford.edu/~seander/bithacks.html#CountBitsSetParallel\" rel=\"nofollow noreferrer\">Bit Population</a> (middle algorithm)"}, {"owner": {"reputation": 15181, "user_id": 3308055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mIjeo.png?s=128&g=1", "display_name": "juvian", "link": "https://stackoverflow.com/users/3308055/juvian"}, "edited": false, "score": 0, "creation_date": 1542761731, "post_id": 53403775, "comment_id": 93682691, "body": "Just solve how many ones are between 1 and x, then for a y-x range the answer is from 1 to x - from 1 to y. notice that for the least significant bit, you get a 1 every 2 numers. For the second, 2 every 4, for the third, 4 every 8..."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1542761897, "post_id": 53403775, "comment_id": 93682726, "body": "It should be fairly straight forward to calculate this in constant time (i.e. without looping through every number)"}], "answers": [{"comments": [{"owner": {"reputation": 372, "user_id": 10669066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zo0wL.jpg?s=128&g=1", "display_name": "Holy semicolon", "link": "https://stackoverflow.com/users/10669066/holy-semicolon"}, "edited": false, "score": 0, "creation_date": 1542785626, "post_id": 53404005, "comment_id": 93689115, "body": "@Broman emmm maybe there is a bug in your code <code>Error: countOnes(476744280, 477171088) Expected: 6676768 Got: 6676755</code>     i did <code>sum = numberOfOnes(477171088) - numberOfOnes(476744280)</code>"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 372, "user_id": 10669066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zo0wL.jpg?s=128&g=1", "display_name": "Holy semicolon", "link": "https://stackoverflow.com/users/10669066/holy-semicolon"}, "edited": false, "score": 0, "creation_date": 1542786110, "post_id": 53404005, "comment_id": 93689293, "body": "@HeIs Where do you find the test cases?"}, {"owner": {"reputation": 372, "user_id": 10669066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zo0wL.jpg?s=128&g=1", "display_name": "Holy semicolon", "link": "https://stackoverflow.com/users/10669066/holy-semicolon"}, "edited": false, "score": 0, "creation_date": 1542786321, "post_id": 53404005, "comment_id": 93689381, "body": "@Broman I am doing a challenge in codewars <a href=\"https://www.codewars.com/kata/596d34df24a04ee1e3000a25/train/c\" rel=\"nofollow noreferrer\">codewars.com/kata/596d34df24a04ee1e3000a25/train/c</a>"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 372, "user_id": 10669066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zo0wL.jpg?s=128&g=1", "display_name": "Holy semicolon", "link": "https://stackoverflow.com/users/10669066/holy-semicolon"}, "edited": false, "score": 0, "creation_date": 1542787201, "post_id": 53404005, "comment_id": 93689738, "body": "@HeIs What can I say? I have tested it for the n=1 to 10\u2078 and no failures at all."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 372, "user_id": 10669066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zo0wL.jpg?s=128&g=1", "display_name": "Holy semicolon", "link": "https://stackoverflow.com/users/10669066/holy-semicolon"}, "edited": false, "score": 0, "creation_date": 1542787534, "post_id": 53404005, "comment_id": 93689902, "body": "@HeIs I spotted your mistake. You should use numberOfOnes(right) - numberOfOnes(left - 1)"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 372, "user_id": 10669066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zo0wL.jpg?s=128&g=1", "display_name": "Holy semicolon", "link": "https://stackoverflow.com/users/10669066/holy-semicolon"}, "edited": false, "score": 0, "creation_date": 1542787646, "post_id": 53404005, "comment_id": 93689955, "body": "@HeIs And one more thing. If you&#39;re asking because you&#39;re doing a challenge in codewars, then say so in the question and include a link. That would have saved me TONS of time debugging my code."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 372, "user_id": 10669066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zo0wL.jpg?s=128&g=1", "display_name": "Holy semicolon", "link": "https://stackoverflow.com/users/10669066/holy-semicolon"}, "edited": false, "score": 0, "creation_date": 1542787983, "post_id": 53404005, "comment_id": 93690108, "body": "No worries, but do think about that in the future. Regarding understanding my code, it is really not that complicated. Make sure you understand the Python code first. It is much easier to read. Also look at the image."}], "tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": true, "score": 4, "last_activity_date": 1542788219, "last_edit_date": 1542788219, "creation_date": 1542763349, "answer_id": 53404005, "question_id": 53403775, "link": "https://stackoverflow.com/questions/53403775/count-ones-in-a-segment-binary/53404005#53404005", "title": "Count ones in a segment (binary)", "body": "<p>Here is a proposal for a speedup:</p>\n\n<ol>\n<li><p>Find smallest y1 such that y1 >= x1 and that y1 is a power of 2</p></li>\n<li><p>Find largest y2 such that y2 &lt;= x2 and that y2 is a power of 2</p></li>\n<li><p>Find p1 and p2 such that 2^p1=y1 and 2^p2=y2</p></li>\n<li><p>Calculate the amount of 1:s between y1 and y2</p></li>\n<li><p>Deal with x1 to y1 and y2 to x2 separately</p></li>\n<li><p>Sum the results from 4 and 5</p></li>\n</ol>\n\n<p>Let's focus on step 4. Let f(n) be the sum of ones up to (2^n)-1. We can quickly realize that f(n) = 2*f(n-1) + 2^(n-1) and that f(1)=1. This can be even further refined so that you don't have to deal with recursive calls, but I highly doubt it will be of any importance. Anyway, f(n) = n*2^(n-1)</p>\n\n<p>To get the result between y1 and y2, just use f(p2)-f(p1)</p>\n\n<p>For step 5, you can likely use a modified version of step 4.</p>\n\n<p>EDIT:</p>\n\n<p>Maybe I was to quick to say \"quickly realize\". Here is a way to understand it. The amounts of ones up to 2\u00b9-1 is easy to see. The only two binary numbers below 2\u00b9 are 0 and 1. To get the number of ones up to 2\u00b2 we take the numbers below 2\u00b9 and make a column:</p>\n\n<pre><code>0\n1\n</code></pre>\n\n<p>Clone it:</p>\n\n<pre><code>0\n1\n0\n1\n</code></pre>\n\n<p>And put 0:s before the first half and 1:s before the second half:     </p>\n\n<pre><code>00\n01\n10\n11\n</code></pre>\n\n<p>To get 2\u00b3 we do the same. Clone it:</p>\n\n<pre><code>00\n01\n10\n11\n00\n01\n10\n11\n</code></pre>\n\n<p>And add 0 and 1:</p>\n\n<pre><code>000\n001\n010\n011\n100\n101\n110\n111\n</code></pre>\n\n<p>Now it should be easy to see why f(n) = 2*f(n-1) + 2^(n-1). The cloning gives 2f(n-1) and adding the 0:s and 1:s gives 2^(n-1). If 2^(n-1) is hard to understand, remember that 2^(n-1)=(2^n)/2. In each step we have 2^n rows and half of them get an extra 1.</p>\n\n<p>EDIT2:</p>\n\n<p>When I looked at these columns, I got an idea for how to do step 5. Let's say that you want to find the amounts of 1:s from 10 to 15. Binary table for this would be:</p>\n\n<pre><code>10: 1010\n11: 1011\n12: 1100\n13: 1101\n14: 1110\n15: 1111\n</code></pre>\n\n<p>Look at the interval 12-15. The last two digits in binary is a copy of the corresponding table for 0-3. That could be utilized, but I leave that to you.</p>\n\n<p>EDIT 3:</p>\n\n<p>This was a fun problem. I wrote some python code that does this. I get some problems with too many recursive calls, but that could be solved pretty easily, and it should not be too complicated to convert this to C:</p>\n\n<pre><code>def f(n):\n    return n*2**(n-1)\n\ndef numberOfOnes(x):\n    if(x==0):\n        return 0\n    p = floor(log(x,2))\n    a = f(p)\n    b = numberOfOnes(x-2**p)\n    c = x - 2**p +1\n    return a+b+c\n</code></pre>\n\n<p>I made an image so that you easier can understand what <code>a</code>, <code>b</code> and <code>c</code> does in the function <code>numberOfOnes</code> if we call it with <code>numberOfOnes(12)</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2smgr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2smgr.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have finally converted it to C. Of course I have used some code I found here on Stack overflow. I borrowed code for integer versions of log2 and pow, and made some small modifications.</p>\n\n<p>This code is probably possible to optimize further, but it is not necessary. It is lighting fast, and I was not able to measure it's performance.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;inttypes.h&gt;\ntypedef uint64_t T;\n\n// https://stackoverflow.com/a/11398748/6699433                                                                    \nconst int tab64[64] = {\n    63,  0, 58,  1, 59, 47, 53,  2,\n    60, 39, 48, 27, 54, 33, 42,  3,\n    61, 51, 37, 40, 49, 18, 28, 20,\n    55, 30, 34, 11, 43, 14, 22,  4,\n    62, 57, 46, 52, 38, 26, 32, 41,\n    50, 36, 17, 19, 29, 10, 13, 21,\n    56, 45, 25, 31, 35, 16,  9, 12,\n    44, 24, 15,  8, 23,  7,  6,  5};\n\nT log2_64 (T value) {\n    value |= value &gt;&gt; 1;\n    value |= value &gt;&gt; 2;\n    value |= value &gt;&gt; 4;\n    value |= value &gt;&gt; 8;\n    value |= value &gt;&gt; 16;\n    value |= value &gt;&gt; 32;\n    return tab64[((T)((value - (value &gt;&gt; 1))*0x07EDD5E59A4E28C2)) &gt;&gt; 58];\n}\n\n// https://stackoverflow.com/a/101613/6699433                                                                      \nT ipow(T base, T exp) {\n    T result = 1;\n    for (;;) {\n        if (exp &amp; 1) result *= base;\n        exp &gt;&gt;= 1;\n        if (!exp) break;\n        base *= base;\n    }\n    return result;\n}\n\nT f(T n) { return ipow(2,n-1)*n; }\n\nT numberOfOnes(T x) {\n    if(x==0) return 0;\n\n    T p = floor(log2(x));\n    T a = f(p);\n    T e = ipow(2,p);\n    T b = numberOfOnes(x-e);\n    T c = x - e + 1;\n    return a+b+c;\n}\n\nvoid test(T u, T v) {\n    assert(numberOfOnes(u) == v);\n}\n\nint main() {\n    // Sanity checks\n    test(0,0);\n    test(1,1);\n    test(2,2);\n    test(3,4);\n    test(4,5);\n    test(5,7);\n    test(6,9);\n    // Test case provided in question\n    test(1000000000,14846928141);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 372, "user_id": 10669066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zo0wL.jpg?s=128&g=1", "display_name": "Holy semicolon", "link": "https://stackoverflow.com/users/10669066/holy-semicolon"}, "edited": false, "score": 0, "creation_date": 1542773263, "post_id": 53404324, "comment_id": 93685229, "body": "yeah it&#39;s useful but the code needs to find sum of all 1s between x1 and x2."}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "reply_to_user": {"reputation": 372, "user_id": 10669066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zo0wL.jpg?s=128&g=1", "display_name": "Holy semicolon", "link": "https://stackoverflow.com/users/10669066/holy-semicolon"}, "edited": false, "score": 0, "creation_date": 1542773445, "post_id": 53404324, "comment_id": 93685263, "body": "x1 and x2 are min_val and max_val in that code.  it works for 5,10 but 1,1000000000 times out on codechef, ill update the code to use the variable names in the OP."}, {"owner": {"reputation": 372, "user_id": 10669066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zo0wL.jpg?s=128&g=1", "display_name": "Holy semicolon", "link": "https://stackoverflow.com/users/10669066/holy-semicolon"}, "edited": false, "score": 0, "creation_date": 1542773994, "post_id": 53404324, "comment_id": 93685370, "body": "try and execute your code in this site it works for 1000000000 but it takes time   <a href=\"https://www.onlinegdb.com/online_c_compiler\" rel=\"nofollow noreferrer\">onlinegdb.com/online_c_compiler</a>"}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "reply_to_user": {"reputation": 372, "user_id": 10669066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zo0wL.jpg?s=128&g=1", "display_name": "Holy semicolon", "link": "https://stackoverflow.com/users/10669066/holy-semicolon"}, "edited": false, "score": 0, "creation_date": 1542774531, "post_id": 53404324, "comment_id": 93685474, "body": "is it faster than the arithmetic way?  Is it fast enough for your test?"}, {"owner": {"reputation": 372, "user_id": 10669066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zo0wL.jpg?s=128&g=1", "display_name": "Holy semicolon", "link": "https://stackoverflow.com/users/10669066/holy-semicolon"}, "edited": false, "score": 0, "creation_date": 1542774674, "post_id": 53404324, "comment_id": 93685508, "body": "unfortunately I got &quot;Execution Timed Out&quot;."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1542779372, "post_id": 53404324, "comment_id": 93686715, "body": "@Bwebb I have working C code now. You can have a look if you want. It&#39;s fast."}], "tags": [], "owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "is_accepted": false, "score": 1, "last_activity_date": 1542773577, "last_edit_date": 1542773577, "creation_date": 1542765760, "answer_id": 53404324, "question_id": 53403775, "link": "https://stackoverflow.com/questions/53403775/count-ones-in-a-segment-binary/53404324#53404324", "title": "Count ones in a segment (binary)", "body": "<pre><code>int x1 = 5;\nint x2 = 10;\nint i=0;\nint looper = 0;\nunsigned long long ones_count = 0;\n\nfor(i=x1; i&lt;=x2; i++){\n    looper = i;\n    while(looper){\n        if(looper &amp; 0x01){\n            ones_count++;\n        }\n        looper &gt;&gt;= 1;\n    }\n}\n\nprintf(\"ones_count is %llu\\n\", ones_count);\nreturn 0;\n</code></pre>\n\n<p><strong>OUTPUT</strong>: ones_count is 12</p>\n\n<p>Here is a way to count every single bit for every value in between the two values.  The shift/mask will be faster than your arithmetic operators most likely, but will still probably time out.  You need a clever algorithm like the other answer suggests i think, but heres the stupid brute force way :)</p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 4, "last_activity_date": 1542790469, "last_edit_date": 1542790469, "creation_date": 1542785917, "answer_id": 53407267, "question_id": 53403775, "link": "https://stackoverflow.com/questions/53403775/count-ones-in-a-segment-binary/53407267#53407267", "title": "Count ones in a segment (binary)", "body": "<p>You can solve this problem by computing the number of bits in the range <code>1</code> to <code>n</code> and use a simple subtraction for any subrange:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n/* compute the number of bits set in all numbers between 0 and n excluded */\nunsigned long long bitpop(unsigned long long n) {\n    unsigned long long count = 0, p = 1;\n    while (p &lt; n) {\n        p += p;\n        /* half the numbers in complete slices of p values have the n-th bit set */\n        count += n / p * p / 2;\n        if (n % p &gt;= p / 2) {\n            /* all the numbers above p / 2 in the last partial slice have it */\n            count += n % p - p / 2;\n        }\n    }\n    return count;\n}    \n\nint main(int argc, char *argv[]) {\n    unsigned long long from = 1000, to = 2000;\n\n    if (argc &gt; 1) {\n        to = from = strtoull(argv[1], NULL, 0);\n        if (argc &gt; 2) {\n            to = strtoull(argv[1], NULL, 0);\n        }\n    }\n\n    printf(\"bitpop from %llu to %llu: %llu\\n\", from, to, bitpop(to + 1) - bitpop(from));\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 372, "user_id": 10669066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zo0wL.jpg?s=128&g=1", "display_name": "Holy semicolon", "link": "https://stackoverflow.com/users/10669066/holy-semicolon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1289, "favorite_count": 0, "accepted_answer_id": 53404005, "answer_count": 3, "score": 3, "last_activity_date": 1542808884, "creation_date": 1542761244, "last_edit_date": 1542808884, "question_id": 53403775, "link": "https://stackoverflow.com/questions/53403775/count-ones-in-a-segment-binary", "title": "Count ones in a segment (binary)", "body": "<p>There is a problem which i am working on it right now and it's as follows :</p>\n\n<p>there are two numbers x1 and x2 and x2 > x1.</p>\n\n<p>for example x1 = 5; and x2 = 10;</p>\n\n<p>and I must find the sum of ones between x1 and x2 in binary representations.</p>\n\n<pre><code>5 = 101   =&gt; 2 ones\n6 = 110   =&gt; 2 ones\n7 = 111   =&gt; 3 ones\n8 = 1000  =&gt; 1 one\n9 = 1001  =&gt; 2 ones\n10= 1010  =&gt; 2 ones\nso the sum will be \nsum = 2 + 2 + 3 + 1 + 2 + 2 = 12 ones;\n</code></pre>\n\n<p>so I have managed to do the code without even transfer the numbers to binary and wasting execution time.</p>\n\n<p>I noticed that the numbers of ones in every <code>2^n</code> with <code>n &gt;= 1</code> is <code>1</code>\nEx : <code>2^1 =&gt; num of ones is 1</code>\n<code>2^2  =&gt;  1</code> <code>2^15  =&gt; 1</code></p>\n\n<p>you can test it here if you want:  <a href=\"https://www.rapidtables.com/convert/number/decimal-to-binary.html?x=191\" rel=\"nofollow noreferrer\">https://www.rapidtables.com/convert/number/decimal-to-binary.html?x=191</a> </p>\n\n<p>and between each <code>2^n and 2^(n+1)</code> there are Consecutive numbers as you will see in this example :</p>\n\n<pre><code>      num              number of ones\n2^4 = 16                      1\n      17                      2\n      18                      2\n      19                      3\n      20                      2\n      21                      3\n      22                      3\n      23                      4\n      24                      2\n      25                      3\n      26                      3\n      27                      4\n      28                      3\n      29                      4\n      30                      4\n      31                      5\n2^5 = 32                      1\n</code></pre>\n\n<p>so I did a code that can find how many ones between <code>2^n and 2^(n+1)</code></p>\n\n<pre><code>int t;                ////turns\nint bin = 1;              //// numbers of ones in the binary format ,,, and 1 for 2^5\nint n1 = 32;          //// 2^5  this is just for clarification \nint n2 = 64;          //// 2^6\nint *keep = malloc(sizeof(int) * (n2 - n1);             ///this is to keep numbers because \n                                      /// i'll need it later in my consecutive numbers\nint i = 0;\nint a = 0;\nn1 = 33               //// I'll start from 33 cause \"bin\" of 32 is \"1\";\n\nwhile (n1 &lt; n2)       /// try to understand it now by yourself\n{\n    t = 0;\n    while (t &lt;= 3)\n    {\n\n        if (t == 0 || t == 2) \n            bin = bin + 1;\n\n        else if (t == 1) \n            bin = bin;\n\n        else if (t == 3)\n        {\n            bin = keep[i];\n            i++;\n        }\n        keep[a] = bin;\n        a++;\n        t++;\n    }\n    n1++;\n}\n</code></pre>\n\n<p>anyway as you see I am close to solve the problem but they give me huge numbers and i must find the ones between them, unfortunately I have tried a lot of methods to calculate the \"sum\" using this code above and I end up with Time executing problem.<br>\nEx: <code>1, 1000000000   the numbers of ones is &gt;&gt;&gt; 14846928141</code></p>\n\n<p>so can you give me a little hint what to do next, thanx in advance.</p>\n\n<p>I'm doing this for a code war challenge: <a href=\"https://www.codewars.com/kata/596d34df24a04ee1e3000a25/train/c\" rel=\"nofollow noreferrer\">https://www.codewars.com/kata/596d34df24a04ee1e3000a25/train/c</a></p>\n"}, {"tags": ["java", "c", "arrays", "byte"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1542759800, "post_id": 53403552, "comment_id": 93682251, "body": "Depending what you want to do <code>char</code> or <code>unsigned char</code>"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 0, "last_activity_date": 1542761328, "last_edit_date": 1542761328, "creation_date": 1542759750, "answer_id": 53403591, "question_id": 53403552, "link": "https://stackoverflow.com/questions/53403552/java-byte-array-equivalant-in-java/53403591#53403591", "title": "Java Byte Array Equivalant in Java", "body": "<p>In C, you want <code>unsigned char</code>.  You'll also need to pass the length of each array as a separate parameter.</p>\n\n<pre><code>public static int distance(unsigned char hash1[], unsigned char hash2[], int len1, len2) {\n    int distance = 0;\n    for (int i = 0; i &lt; len1 &amp;&amp; i &lt; len2; i++)\n    {\n        distance += ((hash2[i] &amp; 0xFF) - (hash1[i] &amp; 0xFF))*\n                    ((hash2[i] &amp; 0xFF) - (hash1[i] &amp; 0xFF));\n    }\n    return distance;\n}\n</code></pre>\n"}], "owner": {"reputation": 537, "user_id": 4165553, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/726401589/picture?type=large", "display_name": "Aqeel Haider", "link": "https://stackoverflow.com/users/4165553/aqeel-haider"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "closed_date": 1542759725, "accepted_answer_id": 53403591, "answer_count": 1, "score": -3, "last_activity_date": 1542761328, "creation_date": 1542759493, "last_edit_date": 1542760230, "question_id": 53403552, "link": "https://stackoverflow.com/questions/53403552/java-byte-array-equivalant-in-java", "closed_reason": "Duplicate", "title": "Java Byte Array Equivalant in Java", "body": "<p>I have a Java Function which use Byte Array, C doesn't have this kind of data Type, How can i write that function in C.</p>\n\n<p>I'm not good in C, Its a Little Confusing for me, I have byte hash1 and byte hash2. </p>\n\n<p>It give me distance in int in java, Why do i need byte in Char in Java. I know the question title looks duplicate but, there is no clear explanation. </p>\n\n<p>Java Code:</p>\n\n<pre><code>public static int distance(byte[] hash1, byte[] hash2) {\n    int distance = 0;\n    for (int i = 0; i &lt; hash1.length &amp;&amp; i &lt; hash2.length; i++)\n    {\n        distance += ((hash2[i] &amp; 0xFF) - (hash1[i] &amp; 0xFF))*((hash2[i] &amp; 0xFF) - (hash1[i] &amp; 0xFF));\n    }\n    return distance;\n}\n</code></pre>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1542758580, "post_id": 53403384, "comment_id": 93681984, "body": "I don&#39;t see any error checking for any of your calls to <code>malloc()</code>, nor any code that ensures you don&#39;t overrun buffers.  The code is so poorly formatted - with lines of code that go <i>waaayy</i> off to the right - that it&#39;s unreadable."}, {"owner": {"reputation": 19, "user_id": 10236733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/202eadf0ec70d426c1d458891327afc9?s=128&d=identicon&r=PG&f=1", "display_name": "stellarCodeBro", "link": "https://stackoverflow.com/users/10236733/stellarcodebro"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1542758991, "post_id": 53403384, "comment_id": 93682091, "body": "Sorry about that. I don&#39;t know why it was formatted that badly.  I just used CTRL-k. Definitely isn&#39;t that way on my computer. I&#39;ll touch it up"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 10236733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/202eadf0ec70d426c1d458891327afc9?s=128&d=identicon&r=PG&f=1", "display_name": "stellarCodeBro", "link": "https://stackoverflow.com/users/10236733/stellarcodebro"}, "edited": false, "score": 1, "creation_date": 1542768066, "post_id": 53403471, "comment_id": 93684088, "body": "Couldn&#39;t have asked for a better answer.  I came here with a simple question but you improved my code everywhere.  Cheers!"}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 2, "last_activity_date": 1542759451, "last_edit_date": 1542759451, "creation_date": 1542758750, "answer_id": 53403471, "question_id": 53403384, "link": "https://stackoverflow.com/questions/53403384/why-cant-i-save-a-pointer-to-a-struct-to-an-index-of-a-pointer-to-an-array-of-p/53403471#53403471", "title": "Why can&#39;t I save a pointer to a struct to an index of a pointer to an array of pointers?", "body": "<pre><code>records* line = malloc(sizeof(records));\n...\nline-&gt;username = malloc(MAXLINE * sizeof(char));\n...  \nallLines[l] = line;\n...  \nfree(line);\n...  \nprintf(\"%s \", allLines[z]-&gt;username);\n</code></pre>\n\n<p>You free the <code>allLines[z]</code> pointer so it is not valid and accessing it is undefined behavior.</p>\n\n<ol>\n<li>I suggest you cleanup your code. </li>\n<li>Also please, next time, post an <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> that is a <em>minimal</em> example needed to reproduce the issue.</li>\n<li>This is a good time to learn how to debug your programs.</li>\n<li><code>char* token = malloc(MAXLINE * sizeof(char));<br>\n                    token = strsep(&amp;buf,\",\");</code> just leaks memory....</li>\n<li>What if the line is malformed and <code>token = strsep(&amp;buf,\",\");</code> returns NULL? Your code will do undefined behavior in <code>strncpy(line-&gt;index, token, strlen(token));</code> and the program will most likely receive sigsegv on linux.</li>\n<li><code>char* buf = malloc(MAXLINE * sizeof(char));\n            while(fgets(buf, MAXLINE, dirEntry)) {</code> and <code>free(buf);<br>\n                buf = malloc(MAXLINE * sizeof(char));</code>. The free + malloc with the same buffer is just pointless.</li>\n<li>Please properly indent your code. If your code has more then 3 levels of identation, it's time to create a function. Grab a good read: <a href=\"https://www.kernel.org/doc/html/v4.10/process/coding-style.html\" rel=\"nofollow noreferrer\">Linux kernel coding style</a>.</li>\n<li>All the <code>strncpy(line-&gt;password, token, strlen(token));</code> are just strange.  Firstly, it's the same as <code>strcpy(line-&gt;password, token)</code> and second if <code>strlen(token)</code> is equal to MAXLINE the output will not be null terminated and secondly if <code>strlen(token)</code> is greater then MAXLINE this will invoke undefined behaviour. You should <code>line-&gt;username = malloc((strlen(token) + 1) * sizeof(char)); memcpy(line-&gt;username, token, strlen(token) + 1);</code> or just <code>line-&gt;username = strdup(token);</code>. Also would be good to <code>if (line-&gt;username == NULL) { handle errors; }</code>. Or protect against UB with a simple <code>if (strlen(token) &gt;= MAXLINE) { fprintf(stderr, \"token too long!\"); abort(); }</code>. Or you can <code>strlcpy(line-&gt;username, token, MAXLINE)</code> which will protect against overflow and always null terminate the output. Don't use <code>strncpy</code>, it's a bad function.</li>\n<li>The allocation for <code>allLines</code> is invalid. <code>records** allLines = malloc(MAXRECORDS * sizeof(records));</code> It should allocate an array of <code>sizeof(records*)</code> pointers not records. You can allocate an array <code>records* allLines = malloc(MAXRECORDS * sizeof(records));</code> which can probably fix you code with just <code>allLines[l] = *line;</code>. But the accesses need to use <code>.</code> then <code>-&gt;</code>, like <code>printf</code> needs to be changed with <code>printf(\"%s \", allLines[z].username);</code></li>\n<li>Same goes for <code>records** files = calloc(MAXRECORDS, sizeof(records));</code> This is a pointer to a pointer to files.</li>\n<li>The portable and posixly defined macro with probably the same meaning as <code>MAXPATHLENGTH</code> is <code>PATH_MAX</code> which is defined in <code>limits.h</code></li>\n<li><code>char* path = malloc(MAXPATHLENGTH * sizeof(char));</code> and <code>path = getcwd(cwd, MAXPATHLENGTH)</code> leaks memory(!) and just strange. On success <code>path == cmd</code>... I suggest you just want <code>cmd = get_current_dir_name()</code>.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 331, "user_id": 4885518, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000364442120/picture?type=large", "display_name": "Johnny Beltran", "link": "https://stackoverflow.com/users/4885518/johnny-beltran"}, "is_accepted": false, "score": 0, "last_activity_date": 1542759506, "creation_date": 1542759506, "answer_id": 53403556, "question_id": 53403384, "link": "https://stackoverflow.com/questions/53403384/why-cant-i-save-a-pointer-to-a-struct-to-an-index-of-a-pointer-to-an-array-of-p/53403556#53403556", "title": "Why can&#39;t I save a pointer to a struct to an index of a pointer to an array of pointers?", "body": "<p>This line: </p>\n\n<p><code>records** allLines = malloc(MAXRECORDS * sizeof(records));</code></p>\n\n<p>Change it to:</p>\n\n<p><code>records** allLines = malloc(MAXRECORDS * sizeof(records*));</code></p>\n\n<p>The same goes for the line initializing <code>records** files</code></p>\n\n<p>Also: <code>files[j] = allLines;</code> is wrong. You are assigning a double pointer to a single pointer.</p>\n"}], "owner": {"reputation": 19, "user_id": 10236733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/202eadf0ec70d426c1d458891327afc9?s=128&d=identicon&r=PG&f=1", "display_name": "stellarCodeBro", "link": "https://stackoverflow.com/users/10236733/stellarcodebro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 53403471, "answer_count": 2, "score": 0, "last_activity_date": 1542759598, "creation_date": 1542758209, "last_edit_date": 1542759598, "question_id": 53403384, "link": "https://stackoverflow.com/questions/53403384/why-cant-i-save-a-pointer-to-a-struct-to-an-index-of-a-pointer-to-an-array-of-p", "title": "Why can&#39;t I save a pointer to a struct to an index of a pointer to an array of pointers?", "body": "<p>I've done something similar to this in the past so I'm not sure why when I try to print my pointer to an array of pointers I get a bunch of (null)'s as output.  This is the code I'm speaking of near the bottom of the file: </p>\n\n<pre><code>int z = 0;\nwhile (z &lt; 9) {\n    printf(\"%s \", allLines[z]-&gt;username);\n    z++;\n} \n</code></pre>\n\n<p>What I'm trying to do is get a directory (either relative or absolute) from the user then change to that directory and open all the text files inside that directory so that I can extract each line from them and store each line inside a records struct.  Please see my code below: </p>\n\n<pre><code>#define _GNU_SOURCE\n#define MAXLINE 256\n#define MAXPATHLENGTH 1024\n#define MAXRECORDS 10000\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;dirent.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;pthread.h&gt;\n\ntypedef struct records {\n    char* username;\n    char* password;\n    char* bloodType;\n    char* domainName;\n    char* index;\n} records;\n\nint main(int argc, char** argv) {\n    if(argc != 2) {\n        printf(\"You must provide 2 arguments: &lt;./filename&gt; &lt;directory&gt;\\n\");\n        return -1;\n    }\n\n    char* path = malloc(MAXPATHLENGTH * sizeof(char));\n    char* cwd = malloc(MAXPATHLENGTH * sizeof(char));\n    FILE* sortedFile;\n    FILE* dirEntry;\n    DIR* dirp; //pointer to a directory stream  \n    struct dirent* dirstructp; //pointer to a dirent structure \n    struct stat buffer;\n    records** allLines = malloc(MAXRECORDS * sizeof(records));\n    int linesInFile[MAXRECORDS];\n    records** files = calloc(MAXRECORDS, sizeof(records)); //pointer to an array of pointers (each of which point to a records struct)\n    int totalFiles;\n\n    if ((sortedFile = fopen(\"sorted.yay\", \"w+\")) == NULL) {\n        fprintf(stderr, \"%s\\n\", strerror(errno));\n        printf(\"fopen\");\n        exit(errno);\n    }\n\n    //changes the current working directory of the calling process to the directory specified\n    if((chdir(argv[1])) == -1) {\n        fprintf(stderr, \"%s\\n\", strerror(errno));\n        exit(errno);\n    }\n\n    /*copies the pathname of the current working directory to the array pointed to by cwd, which is of length MAXPATHLENGTH*/\n    if((path = getcwd(cwd, MAXPATHLENGTH)) == NULL) {\n        fprintf(stderr, \"%s\\n\", strerror(errno));\n        exit(errno);\n    }\n\n    //returns a pointer to the directory stream if successful \n    if((dirp = opendir(path)) == NULL) {\n        fprintf(stderr, \"%s\\n\", strerror(errno));\n        printf(\"opendir\");\n        exit(errno);\n    }\n\n    int i = 0;\n    int j = 0;\n    int l = 0;\n    while((dirstructp = readdir(dirp)) != NULL) {\n\n        if ((strncmp(dirstructp-&gt;d_name, \".\", strlen(\".\")) != 0) &amp;&amp; (strncmp(dirstructp-&gt;d_name, \"..\", strlen(\"..\")) != 0)) {\n\n            if(lstat(dirstructp-&gt;d_name, &amp;buffer) == -1) {\n                fprintf(stderr, \"%s\\n\", strerror(errno));\n                printf(\"Bob Saget\");\n                exit(errno);\n            }\n\n            if(S_ISREG(buffer.st_mode)) {\n\n                if ((dirEntry = fopen(dirstructp-&gt;d_name, \"r\")) == NULL) {\n                    fprintf(stderr, \"%s\\n\", strerror(errno));\n                    printf(\"fopen2\");\n                    exit(errno);\n                }   \n\n                char* buf = malloc(MAXLINE * sizeof(char));\n                while(fgets(buf, MAXLINE, dirEntry)) {                            \n                    records* line = malloc(sizeof(records));       \n                    int k = 0;         \n                    while(k &lt; 5) {                            \n                        char* token = malloc(MAXLINE * sizeof(char));                \n                        token = strsep(&amp;buf,\",\");                                               \n                        switch(k) {                                            \n                            case 0:                                                           \n                                line-&gt;username = malloc(MAXLINE * sizeof(char));                                   \n                                strncpy(line-&gt;username, token, strlen(token));                           \n                                break;                                             \n                            case 1:                                              \n                                line-&gt;password = malloc(MAXLINE * sizeof(char));            \n                                strncpy(line-&gt;password, token, strlen(token));                          \n                                break;                                             \n                            case 2:                                              \n                                line-&gt;bloodType = malloc(MAXLINE * sizeof(char));            \n                                strncpy(line-&gt;bloodType, token, strlen(token));                      \n                                break;                                             \n                            case 3:                                                \n                                line-&gt;domainName = malloc(MAXLINE * sizeof(char));           \n                                strncpy(line-&gt;domainName, token, strlen(token));                \n                                break;                                              \n                            case 4:    \n                                line-&gt;index = malloc(MAXLINE * sizeof(char));\n                                strncpy(line-&gt;index, token, strlen(token));         \n                                break;                                             \n                        }\n                        k++;                                                      \n                    }                                                         \n                    allLines[l] = line;         \n                    l++;\n                    free(line);                                                                  \n                    free(buf);                \n                    buf = malloc(MAXLINE * sizeof(char));                      \n                }                      \n                linesInFile[j] = i;\n                i = 0;    \n                files[j] = allLines;  \n                j++;         \n                totalFiles = j;\n                free(buf);\n            } \n        }\n    }\n    int z = 0;\n    while (z &lt; 9) {\n        printf(\"%s \", allLines[z]-&gt;username);\n        z++;\n    }   \n    return 0;\n}   \n</code></pre>\n"}, {"tags": ["c", "kill-process", "waitpid"], "comments": [{"owner": {"reputation": 1412, "user_id": 3809561, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RTS59.jpg?s=128&g=1", "display_name": "yyny", "link": "https://stackoverflow.com/users/3809561/yyny"}, "edited": false, "score": 0, "creation_date": 1542756437, "post_id": 53403120, "comment_id": 93681505, "body": "any particular reason you&#39;re using C for this? Such a task would be much better suited for shell programming or higher level programming languages like python."}, {"owner": {"reputation": 23, "user_id": 10331653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4576a8add17a6d50a47aee62d7e5084e?s=128&d=identicon&r=PG&f=1", "display_name": "ximilianL", "link": "https://stackoverflow.com/users/10331653/ximilianl"}, "reply_to_user": {"reputation": 1412, "user_id": 3809561, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RTS59.jpg?s=128&g=1", "display_name": "yyny", "link": "https://stackoverflow.com/users/3809561/yyny"}, "edited": false, "score": 0, "creation_date": 1542756843, "post_id": 53403120, "comment_id": 93681609, "body": "I&#39;m asked to do it in C, it wasn&#39;t my idea."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10331653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4576a8add17a6d50a47aee62d7e5084e?s=128&d=identicon&r=PG&f=1", "display_name": "ximilianL", "link": "https://stackoverflow.com/users/10331653/ximilianl"}, "edited": false, "score": 0, "creation_date": 1542761759, "post_id": 53403498, "comment_id": 93682699, "body": "Okay, that makes sense and helped me understand the related commands. However, I do have one question left: Right now, the program will stop after one iteration; if I remove the breakpoint at &quot;if ( !killflg)&quot;, it will work as expected. Am I missing something or is this just a misunderstanding?"}], "tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": true, "score": 0, "last_activity_date": 1542773443, "last_edit_date": 1542773443, "creation_date": 1542758994, "answer_id": 53403498, "question_id": 53403120, "link": "https://stackoverflow.com/questions/53403120/killing-a-process-once-time-limit-exceeded/53403498#53403498", "title": "Killing a process once time limit exceeded", "body": "<p>Your logic was a bit too complicated (e.g. too many different <code>sleep</code> calls and <code>if/else</code> ladder logic).</p>\n\n<p>Also, no need to <code>malloc</code> the <code>argv</code> strings--they can be used directly.</p>\n\n<p>I've simplified it and restructured a bit to get it to work [please pardon the gratuitous style cleanup]:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;string.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;sys/wait.h&gt;\n\n/*\n *\n */\nint\nmain(int argc, char **argv)\n{\n    int waitingTime;\n\n    if (argc &lt; 3) {\n        printf(\"Invalid number of arguments provided. Please specify a command and exactly one parameter.\");\n        return (EXIT_FAILURE);\n    }\n    // -n parameter specified? If so, set the waiting time.\n    if (argc == 5 &amp;&amp; strcmp(argv[3], \"-n\") == 0) {\n        waitingTime = atoi(argv[4]);\n    }\n    else {\n        waitingTime = 5;                // Default waiting time.\n    }\n\n    char *cmd = argv[1];\n    char *param = argv[2];\n\n    // Print the read command and its param\n    printf(\"Command: %s, Parameter: %s, Interval: %d\\n\\n\",\n        cmd, param, waitingTime);\n\n    pid_t pid;\n    int code = -1;\n    int status;\n    int killflg = 1;\n\n    for (;;) {\n        // Declared here for scope\n        int secsWaited;\n\n        secsWaited = 0;\n        pid = fork();\n\n        // stop on fork failure\n        if (pid &lt; 0) {\n            killflg = 1;\n            break;\n        }\n\n        // child process\n        if (pid == 0) {\n            pid = getpid();\n            printf(\"==============\\n\");\n#if 0\n            execlp(cmd, cmd, param, \"/\", (char *) NULL);\n#else\n            execlp(cmd, cmd, param, (char *) NULL);\n#endif\n            printf(\"Excec failed; killing the proccess.\");\n\n// NOTE/BUG: this is the child so pid is zero, so killing it is wrong\n#if 0\n            kill(pid, SIGKILL);\n#else\n            exit(1);\n#endif\n        }\n\n        killflg = 0;\n        for (;;) {\n            code = waitpid(pid, &amp;status, WNOHANG);\n            if (code &gt; 0)\n                break;\n\n            if (killflg)\n                continue;\n\n            secsWaited++;\n            sleep(1);\n\n            if (secsWaited &gt;= waitingTime) {\n                printf(\"timeout\\n\");\n                kill(pid, SIGKILL);\n                killflg = 1;\n            }\n        }\n\n        if (! killflg)\n            break;\n    }\n\n#if 0\n    free(cmd);\n    free(param);\n#endif\n\n    if (killflg)\n        code = EXIT_FAILURE;\n    else\n        code = EXIT_SUCCESS;\n\n    return code;\n}\n</code></pre>\n\n<hr>\n\n<p><strong>UPDATE:</strong></p>\n\n<blockquote>\n  <p>Right now, the program will stop after one iteration; if I remove the breakpoint at <code>if (! killflg)</code>, it will work as expected. Am I missing something or is this just a misunderstanding?</p>\n</blockquote>\n\n<p>You are correct--my bad. I had missed the following in your question:</p>\n\n<blockquote>\n  <p>The task is to read a terminal command and to run it every x seconds;</p>\n</blockquote>\n\n<p>Change the <code>break</code> into <code>sleep(waitingTime - secsWaited)</code>.</p>\n\n<hr>\n\n<p>But, a more robust way to keep track of elapsed time may be via two calls to <code>time(2)</code>:</p>\n\n<p>After the <code>killflg = 0</code>, do: <code>time_t todbeg = time(NULL); time_t todelap;</code>. Then, you can get elapsed time [anywhere] with: <code>todelap = time(NULL) - todbeg;</code> [here, <code>todelap</code> is similar to <code>secsWaited</code>]. This may be better than incrementing <code>secsWaited</code>.</p>\n\n<p><code>time</code> only has seconds resolution. For more precision control, consider using <code>clock_gettime</code> [has nanosecond resolution].</p>\n\n<p>Here's a function that I use a lot for elapsed time [in <em>fractional</em> seconds]:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;string.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;time.h&gt;\n\ndouble\ntvgetf(void)\n{\n    struct timespec ts;\n    double sec;\n\n    clock_gettime(CLOCK_REALTIME,&amp;ts);\n\n    sec = ts.tv_nsec;\n    sec /= 1e9;\n    sec += ts.tv_sec;\n\n    return sec;\n}\n\n/*\n *\n */\nint\nmain(int argc, char **argv)\n{\n    int waitingTime;\n\n    if (argc &lt; 3) {\n        printf(\"Invalid number of arguments provided. Please specify a command and exactly one parameter.\");\n        return (EXIT_FAILURE);\n    }\n    // -n parameter specified? If so, set the waiting time.\n    if (argc == 5 &amp;&amp; strcmp(argv[3], \"-n\") == 0) {\n        waitingTime = atoi(argv[4]);\n    }\n    else {\n        waitingTime = 5;                // Default waiting time.\n    }\n\n    char *cmd = argv[1];\n    char *param = argv[2];\n\n    // Print the read command and its param\n    printf(\"Command: %s, Parameter: %s, Interval: %d\\n\\n\", cmd, param, waitingTime);\n\n    pid_t pid;\n    int code = -1;\n    int status;\n    int killflg = 1;\n    double todzero = tvgetf();\n\n    for (;;) {\n        // Declared here for scope\n        double todbeg = tvgetf();\n        double todelap;\n\n        pid = fork();\n\n        // stop on fork failure\n        if (pid &lt; 0) {\n            killflg = 1;\n            break;\n        }\n\n        // child process\n        if (pid == 0) {\n            pid = getpid();\n            printf(\"============== (%.9f)\\n\",tvgetf() - todzero);\n            execlp(cmd, cmd, param, (char *) NULL);\n            printf(\"Excec failed; killing the proccess.\");\n            exit(1);\n        }\n\n        killflg = 0;\n        for (;;) {\n            code = waitpid(pid, &amp;status, WNOHANG);\n            if (code &gt; 0)\n                break;\n\n            if (killflg)\n                continue;\n\n            usleep(1000);\n\n            todelap = tvgetf() - todbeg;\n            if (todelap &gt;= waitingTime) {\n                printf(\"timeout\\n\");\n                kill(pid, SIGKILL);\n                killflg = 1;\n            }\n        }\n\n        // do _not_ wait -- we already timed out\n        if (killflg)\n            continue;\n\n        // get final elapsed time for this round and the amount of time\n        // remaining until the next interval\n        todelap = tvgetf() - todbeg;\n        useconds_t time_to_wait = ((double) waitingTime - todelap) * 1e6;\n\n        // wait until the next time period\n        if (time_to_wait &gt; 0)\n            usleep(time_to_wait);\n    }\n\n    if (killflg)\n        code = EXIT_FAILURE;\n    else\n        code = EXIT_SUCCESS;\n\n    return code;\n}\n</code></pre>\n\n<p><em>Side note:</em> I used <code>usleep</code> here, but, although slightly more complex, it's considered better to use <code>nanosleep</code></p>\n"}], "owner": {"reputation": 23, "user_id": 10331653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4576a8add17a6d50a47aee62d7e5084e?s=128&d=identicon&r=PG&f=1", "display_name": "ximilianL", "link": "https://stackoverflow.com/users/10331653/ximilianl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 756, "favorite_count": 0, "accepted_answer_id": 53403498, "answer_count": 1, "score": 2, "last_activity_date": 1542773443, "creation_date": 1542756217, "question_id": 53403120, "link": "https://stackoverflow.com/questions/53403120/killing-a-process-once-time-limit-exceeded", "title": "Killing a process once time limit exceeded", "body": "<p>I've been working on the following code for quite some time, but can't really figure it out.\nThe task is to read a terminal command and to run it every x seconds; if the command hasn't finished within the waiting time, we want to kill the process and afterwards run the command again.\nAny help would be really appreciated.\nI'm pretty sure I'm not using waitpid() correctly; how would I go about using waitpid to achieve the goal?</p>\n\n<p>Additionally, how would I go about detecting an error within a child process? The plan is to kill the parent process if an error occurred in a child process.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;string.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;sys/wait.h&gt;\n\n/*\n * \n */\nint main(int argc, char** argv) {\n    int waitingTime;\n    if (argc &lt; 3) {\n        printf(\"Invalid number of arguments provided. Please specify a command and exactly one parameter.\");\n        return (EXIT_FAILURE);\n    } \n    // -n parameter specified? If so, set the waiting time.\n    if (argc == 5 &amp;&amp; strcmp(argv[3], \"-n\") == 0) {\n        waitingTime = atoi(argv[4]);\n    } else {\n        waitingTime = 5; // Default waiting time.\n    }\n\n    char* cmd = (char*)malloc(sizeof(argv[1]));\n    cmd = argv[1];\n    char* param = (char*)malloc(sizeof(argv[2]));\n    param = argv[2];\n\n    // Print the read command and its param\n    printf(\"Command: %s, Parameter: %s, Interval: %d\\n\\n\", cmd, param, waitingTime);    \n\n    pid_t pid;\n\n    for (;;) { \n        // Declared here for scope\n        int secsWaited;\n        secsWaited = 0;\n        pid = fork();\n\n        if (pid == 0) {\n            pid = getpid();\n            printf(\"==============\\n\");\n            execlp(cmd, cmd, param, \"/\", (char *)NULL);\n            printf(\"Excec failed; killing the proccess.\");\n            kill(pid, SIGKILL);\n        } else if (pid &gt; 0) {\n            int status, code;\n            for (;;) {\n                code = waitpid(pid, &amp;status, WNOHANG);\n            if (code == 0 &amp;&amp; secsWaited &gt;= waitingTime) {\n                kill(pid, SIGKILL);\n            printf(\"Child stopped\");\n            break;\n        } else if (code == 0 &amp;&amp; secsWaited &lt; waitingTime) {\n            secsWaited++;   \n                    sleep(1);\n                } else {\n                    break;\n                }\n            }\n\n            /*if (!WIFEXITED(status)) {\n                printf(\"Time exceeding, stopping child.\");\n        // Get parent process id and kill it.\n        kill(getpid(), SIGKILL);\n        }*/\n\n\n\n            // Sleep for the specified time\n            sleep(waitingTime - secsWaited);\n\n        } else {\n            return (EXIT_FAILURE);\n        }\n\n    }      \n\n    free(cmd);\n    free(param);       \n    return (EXIT_SUCCESS);\n}\n</code></pre>\n"}, {"tags": ["c", "file", "file-io"], "comments": [{"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "edited": false, "score": 2, "creation_date": 1542755370, "post_id": 53402869, "comment_id": 93681253, "body": "<a href=\"https://www.geeksforgeeks.org/fgets-gets-c-language/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/fgets-gets-c-language</a>"}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 1, "creation_date": 1542761480, "post_id": 53402869, "comment_id": 93682635, "body": "@Joshua - <a href=\"https://linux.die.net/man/3/fgets\" rel=\"nofollow noreferrer\">fgets()</a> isn&#39;t a bad idea; using <a href=\"https://linux.die.net/man/3/fscanf\" rel=\"nofollow noreferrer\">fscanf()</a> isn&#39;t intrinstically evil.  I just wanted to stay as close to your original code as possible.  Please let me know if you&#39;d like me to update my example; please let us know if you have any further questions."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1542775267, "post_id": 53402998, "comment_id": 93685651, "body": "Suggest <code>fscanf(fp, &quot;%29s\\n&quot;, flights[n_flights].destination)</code> instead of <code>fscanf(fp, &quot;%s\\n&quot;, flights[n_flights].destination)</code>"}], "tags": [], "owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "is_accepted": false, "score": 2, "last_activity_date": 1542781736, "last_edit_date": 1542781736, "creation_date": 1542755478, "answer_id": 53402998, "question_id": 53402869, "link": "https://stackoverflow.com/questions/53402869/in-c-how-would-you-save-different-lines-of-a-text-file-to-different-variables/53402998#53402998", "title": "In C, how would you save different lines of a text file to different variables", "body": "<p>It sounds like you're on the right track.</p>\n\n<p>What about something like this:</p>\n\n<pre><code>#define MAX_FLIGHTS 100\n...\nstruct Flight flights[MAX_FLIGHTS ];\nint n_flights = 0;\n...\nwhile (!feof(fp) &amp;&amp; (n_flights &lt; MAX_FLIGHTS-1))\n{\n     if (fscanf(fp, \"%d\\n\", &amp;flights[n_flights].flightNum) != 1)\n        error_handler();\n     if (fscanf(fp, \"%29s\\n\", flights[n_flights].destination) != 1)\n        error_handler();\n     if (fscanf(fp, \"%14s\\n\", flights[n_flights].departDay) != 1)\n        error_handler();\n     ++n_flights;\n}\n...\n</code></pre>\n\n<p>ADDENDUM:\nPer Chux's suggestion, I've modified the code to mitigate against potential buffer overruns, by setting scanf max string length to 29 (1 less than char[30] buffer size).</p>\n\n<p>Here is a more detailed explanation:</p>\n\n<p><a href=\"https://rules.sonarsource.com/c/type/Vulnerability/RSPEC-1079\" rel=\"nofollow noreferrer\">SonarSource: \"scanf()\" and \"fscanf()\" format strings should specify a field width for the \"%s\" string placeholder</a></p>\n"}, {"tags": [], "owner": {"reputation": 768, "user_id": 938740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWhew.png?s=128&g=1", "display_name": "torstenvl", "link": "https://stackoverflow.com/users/938740/torstenvl"}, "is_accepted": false, "score": 0, "last_activity_date": 1542763728, "creation_date": 1542763728, "answer_id": 53404061, "question_id": 53402869, "link": "https://stackoverflow.com/questions/53402869/in-c-how-would-you-save-different-lines-of-a-text-file-to-different-variables/53404061#53404061", "title": "In C, how would you save different lines of a text file to different variables", "body": "<p>The first question you have to answer is this: how important is it for the file to be readable by people, or on other platforms? </p>\n\n<p>If it isn't that important, then I recommend serializing with <code>fwrite()</code> and <code>fread()</code>. That is easier to code for each record, and - as long as your structs are all the same size - allows O(1) access to any record in the file. </p>\n\n<p>If you <strong>do</strong> want to store these as individual lines, the best way to read a line in from a file is with <code>fgets()</code></p>\n\n<p>Pseudocode follows:</p>\n\n<pre><code>typedef struct flight {\n  int flightNum;\n  char desination[30];\n  char departDay[15];\n} flight;\n\ntypedef struct flightSet {\n  flight *flights;\n  size_t n; /* number of flights */\n  size_t nAlloc; /* number of flights you have space for */\n} flightSet;\n\n#define FLIGHTSET_INIT_SIZE 16\n#define MAX_LINE_LENGTH 128\n#define FILENAME \"file.txt\"\n\n// Create a new flightSet, calling it F\n// Allocate FLIGHTSET_INIT_ALLOC number of flight structures for F-&gt;flights\n// Set F-&gt;n to 0\n// Set F-&gt;nAlloc to FLIGHTSET_INIT_ALLOC\n\n/* Set up other variables */\nsize_t i = 0;                       // iterator */\nchar buffer[MAX_LINE_LENGTH];   // for reading with fgets() */\nflights *temp;                  // for realloc()ing when we have more flights to read\n                            // after reaching nAlloc flights\nchar *endptr;                   // for using strtol() to get a number from buffer\nFILE *fp;                       // for reading from the file\n\n// Open FILENAME with fp for reading\n\n//MAIN LOOP\n  // If i == F-&gt;nAlloc, use realloc() to double the allocation of F-&gt;flights\n  // If successful, double F-&gt;nAlloc\n\n  if (fgets(buffer, MAX_LINE_LENGTH, fp) == NULL) {\n      // End of file\n      // Use break to get out of the main loop\n  }\n\n  F-&gt;flights[i]-&gt;flightNum = (int)strtol(buffer, &amp;endptr, 10);\n  if (endptr == buffer) {\n    // The first invalid character that can't be converted to a number is at the very beginning\n    // of the buffer, so this is not a valid numerical character and your data file is corrupt\n    // Print out an error message\n    break; \n  }\n\n  if (fgets(buffer, MAX_LINE_LENGTH, fp) == NULL) {\n      // End of file when expecting new line; file format error\n      // Use break to get out of the main loop\n  } else {\n     F-&gt;flights[i]-&gt;destination = strdup(buffer);  // If your system has strdup()\n     // Check for memory allocation\n  }\n\n  if (fgets(buffer, MAX_LINE_LENGTH, fp) == NULL) {\n      // End of file when expecting new line; file format error\n      // Use break to get out of the main loop\n  } else {\n     F-&gt;flights[i]-&gt;departDay = strdup(buffer);  // If your system has strdup()\n     // Check for memory allocation\n  }\n\n  // If you've gotten here so far without errors, great!\n  //    Increment F-&gt;n to reflect the number of successful records we have in F.\n  //    Increment i, the loop iterator\n\n//Final cleanup.  Should include closing the file, and freeing any allocated\n//memory that didn't end up in a valid record. \n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 9034866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f388ab7bf6a2839c9c4f778c988f84b0?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/9034866/joshua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1542781736, "creation_date": 1542754736, "question_id": 53402869, "link": "https://stackoverflow.com/questions/53402869/in-c-how-would-you-save-different-lines-of-a-text-file-to-different-variables", "title": "In C, how would you save different lines of a text file to different variables", "body": "<p>How would I save different lines from a text File to different variables of different datatypes; all of these variables make up a struct (in my example a flight struct with the following).</p>\n\n<pre><code>struct Flight\n{\n     int flightNum;\n     char desination[30];\n     char departDay[15];\n};\n</code></pre>\n\n<p>An Example of the information that I would like to add via text file would be.</p>\n\n<pre><code>111\nNYC\nMonday\n</code></pre>\n\n<p>I obviously want to save the words NYC and Monday to a char array, but I want to save 111 to an integer variable</p>\n\n<p>So far I have</p>\n\n<pre><code>while (fscanf(flightInfo, \"%s\", tempName) != EOF)\n{\n     fscanf(flightInfo, \"%d\\n\", &amp;tempNum);\n     flight.flightNumber = tempNum;\n     fscanf(flightInfo, \"%s\\n\", tempName);\n     strcpy(flight.desination, tempName);\n     fscanf(flightInfo, \"%s\\n\", tempName)\n     strcpy(flight.departDay, tempName);\n}\n</code></pre>\n\n<p>Assume that flightInfo is a pointer to a filename, tempNum is an integer, and tempName is a char array</p>\n"}, {"tags": ["javascript", "c", "node.js", "node.js-addon", "node.js-napi"], "comments": [{"owner": {"reputation": 369690, "user_id": 182668, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b19917aa04a6839aef577f1117c71d48?s=128&d=identicon&r=PG", "display_name": "Pointy", "link": "https://stackoverflow.com/users/182668/pointy"}, "edited": false, "score": 0, "creation_date": 1542753941, "post_id": 53402705, "comment_id": 93680734, "body": "What are the numeric data types in the C code?"}, {"owner": {"reputation": 369690, "user_id": 182668, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b19917aa04a6839aef577f1117c71d48?s=128&d=identicon&r=PG", "display_name": "Pointy", "link": "https://stackoverflow.com/users/182668/pointy"}, "edited": false, "score": 0, "creation_date": 1542754043, "post_id": 53402705, "comment_id": 93680767, "body": "Also in general in any programming language where numbers are binary floating-point values, performing strict equality tests is tricky."}, {"owner": {"reputation": 63, "user_id": 7489243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1c069e12f522e01635537e7608b3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Yellowman", "link": "https://stackoverflow.com/users/7489243/yellowman"}, "reply_to_user": {"reputation": 369690, "user_id": 182668, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b19917aa04a6839aef577f1117c71d48?s=128&d=identicon&r=PG", "display_name": "Pointy", "link": "https://stackoverflow.com/users/182668/pointy"}, "edited": false, "score": 0, "creation_date": 1542754916, "post_id": 53402705, "comment_id": 93681074, "body": "@Pointy the numeric data type is float. Should i change this to double ?. Indeed I looked at the IEE754 which looks to be tricky... However I find it strange that the wrong output only happened on my machine and only when using the JS snippet and not on travis osx or a in ubuntu"}, {"owner": {"reputation": 369690, "user_id": 182668, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b19917aa04a6839aef577f1117c71d48?s=128&d=identicon&r=PG", "display_name": "Pointy", "link": "https://stackoverflow.com/users/182668/pointy"}, "edited": false, "score": 0, "creation_date": 1542755500, "post_id": 53402705, "comment_id": 93681282, "body": "The C <code>float</code> type is (usually) only 32 bits; JavaScript numbers are 64 bits."}, {"owner": {"reputation": 63, "user_id": 7489243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1c069e12f522e01635537e7608b3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Yellowman", "link": "https://stackoverflow.com/users/7489243/yellowman"}, "reply_to_user": {"reputation": 369690, "user_id": 182668, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b19917aa04a6839aef577f1117c71d48?s=128&d=identicon&r=PG", "display_name": "Pointy", "link": "https://stackoverflow.com/users/182668/pointy"}, "edited": false, "score": 0, "creation_date": 1542755941, "post_id": 53402705, "comment_id": 93681386, "body": "@Pointy Hmm yes, behind the usage of the float value I am converting the float to the double value in order for the value to be used by N-API. Do you think that there might be a loss of precision during this conversion ? I guess I should try to convert it right away into double and see how it goes"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 7489243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1c069e12f522e01635537e7608b3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Yellowman", "link": "https://stackoverflow.com/users/7489243/yellowman"}, "edited": false, "score": 0, "creation_date": 1542788772, "post_id": 53403786, "comment_id": 93690496, "body": "Hmm indeed. I could return a buffer instead of a float value that might help in term of precision"}], "tags": [], "owner": {"reputation": 36, "user_id": 10683038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OM0KIDf8QyQ/AAAAAAAAAAI/AAAAAAAAA2s/_-CLE4tj2lQ/photo.jpg?sz=128", "display_name": "Jack", "link": "https://stackoverflow.com/users/10683038/jack"}, "is_accepted": true, "score": 2, "last_activity_date": 1542761360, "creation_date": 1542761360, "answer_id": 53403786, "question_id": 53402705, "link": "https://stackoverflow.com/questions/53402705/issue-while-calculating-float-value-using-nodejs-n-api/53403786#53403786", "title": "Issue while calculating float value using NodeJS N-API", "body": "<p>In javascript v8 engine. Actually only exist smi and double.\nreadFloatBE: when float pass to v8, the float will be cast to double.\nit will promote to the double when you go out and rounding into a float.</p>\n\n<p>First, if you really want to get value like C, you need to manually specify the rounded digits and re-instantiate the Number object with the Number.prototype.toPrecision function rounded up:</p>\n\n<p>For your reference:</p>\n\n<pre><code>var v = 5.2\nvar buffer = new Buffer(5)\nbuffer.writeFloatBE(v)\nvar g = buffer.readFloatBE()\n\nconsole.log(v)\nconsole.log(g)\nconsole.log(v==g)\nconsole.log(Number(g.toPrecision(5)))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 7489243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1c069e12f522e01635537e7608b3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Yellowman", "link": "https://stackoverflow.com/users/7489243/yellowman"}, "is_accepted": false, "score": 0, "last_activity_date": 1542836122, "creation_date": 1542836122, "answer_id": 53420791, "question_id": 53402705, "link": "https://stackoverflow.com/questions/53402705/issue-while-calculating-float-value-using-nodejs-n-api/53420791#53420791", "title": "Issue while calculating float value using NodeJS N-API", "body": "<p>Indeed, as post by <a href=\"https://stackoverflow.com/users/182668/pointy\">Pointy</a> and <a href=\"https://stackoverflow.com/users/10683038/user10683038\">user10683038</a> JavaScript numbers are 64 bits. </p>\n\n<p>As I coded this feature the numeric type used was float (was not thinking at making a Node module at first glance). Later on I decided to do a conversion from <strong>float to double</strong> using a small util method like below</p>\n\n<pre><code>double v = *(double *) arg;\nstatus = napi_create_double(env, v, &amp;value);\n</code></pre>\n\n<p><strong>Strangely</strong> it appear that I might have <strong>randomly loosing decimal precision</strong> while doing this conversion while it should have not (32bit to 64bit) or I might have missing out something.</p>\n\n<p>Later on I refactor the same code but this time by <strong>using double</strong> instead and it works as it should. Many thanks to all of you.</p>\n\n<p><strong>Note</strong>: As I used this util code above method accross the NodeJS binding codebase I am surprised that I haven't got a decimal precision error earlier.</p>\n"}], "owner": {"reputation": 63, "user_id": 7489243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1c069e12f522e01635537e7608b3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Yellowman", "link": "https://stackoverflow.com/users/7489243/yellowman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 53403786, "answer_count": 2, "score": 1, "last_activity_date": 1542836122, "creation_date": 1542753835, "question_id": 53402705, "link": "https://stackoverflow.com/questions/53402705/issue-while-calculating-float-value-using-nodejs-n-api", "title": "Issue while calculating float value using NodeJS N-API", "body": "<p>Hello everyone,</p>\n\n<p>Coming from the web dev world. I am currently trying to do some C code which is converting an RGB value to an XYZ value that can be used by NodeJS through N-API. The issue that I have is regarding to <strong>float calculation</strong>. Below is the explanation of my issue:</p>\n\n<p>Based on this C code below, this code is trying to convert an RGB value to an XYZ value.</p>\n\n<pre><code>char * colorType = getStringValue(env, funcParams[2], SPACELen);\n// m is either the value srgb | adobeRgb\nMatrix m = getEnumFromStr(colorType);\nRgb * rgb = getRGBFromJSObj(env, funcParams[0]);\nxyz = generateXyzFromRgb(rgb, m);\n</code></pre>\n\n<p>And I am using this JS snippet to call my library</p>\n\n<pre><code>const rgb = {\n  r: 255,\n  g: 255,\n  b: 255\n};\n\nconst xyz = lib.getXyzFromRgb(rgb, \"srgb\", 10000);\nexpect(xyz).to.be.deep.equal({\n  x: 0.9504,\n  y: 1,\n  z: 1.0888\n});\n</code></pre>\n\n<p>If everything should be all right the output should be like the one below</p>\n\n<pre><code>{\n x: 0.9504,\n y: 1,\n z: 1.0888 \n}\n</code></pre>\n\n<p>However the output that I have is this one</p>\n\n<pre><code>{\n x: 0.9502,\n y: 0.9997,\n z: 1.0886 \n}\n</code></pre>\n\n<p>As you can see the output is totally wrong. <strong>However this wrong output only happened on my local machine (OSX) and only when I am trying to do the conversion by using the JS snippet.</strong> </p>\n\n<p>Indeed, when I am trying to run the conversion with this piece of code below directly through Xcode the <strong>output is correct</strong></p>\n\n<pre><code>// RGB and &amp; m variable is outputing the same value as the conversion done by the C code above\nxyz = generateXyzFromRgb(rgb, m);\n</code></pre>\n\n<p>Moreover when I'm trying to call the <strong>JS code through travis which also running OSX and on Ubuntu through Docker the JS code also output the right value</strong>. </p>\n\n<p>Can it be more related to the hardware or the way I am compiling my libraries or else ?</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1542753671, "post_id": 53402659, "comment_id": 93680654, "body": "But you are assigning each <i>byte</i> of the number to be equal of <code>(char)i</code>. So first number is 0x00000000, second is 0x01010101 and so on."}, {"owner": {"reputation": 625, "user_id": 3140754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qceIh.jpg?s=128&g=1", "display_name": "Tom Kuschel", "link": "https://stackoverflow.com/users/3140754/tom-kuschel"}, "edited": false, "score": 0, "creation_date": 1542753828, "post_id": 53402659, "comment_id": 93680702, "body": "your memset: shouldn&#39;t it be <code>memset(mock_sector,0,sizeof *mock_sector);</code> ? And without the for-loop!"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1542754803, "post_id": 53402659, "comment_id": 93681033, "body": "Related: <a href=\"https://stackoverflow.com/q/17288859/119527\">Using memset for integer array in c</a>"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1542814999, "post_id": 53402659, "comment_id": 93705675, "body": "Why are you using a void pointer?"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 10405839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c651470d4b14c41c408a265d35d6e68?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10405839/nate"}, "edited": false, "score": 0, "creation_date": 1542754559, "post_id": 53402702, "comment_id": 93680956, "body": "Thank you. Really Appreciate it"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1542754906, "post_id": 53402702, "comment_id": 93681071, "body": "Or better yet: <code>uint32_t *mock_sector = malloc(128 * sizeof(uint32_t));</code> then <code>mock_sector[i] = i;</code>"}], "tags": [], "owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "is_accepted": true, "score": 2, "last_activity_date": 1542753817, "creation_date": 1542753817, "answer_id": 53402702, "question_id": 53402659, "link": "https://stackoverflow.com/questions/53402659/storing-integers-in-a-mallocd-block/53402702#53402702", "title": "Storing integers in a malloc&#39;d block", "body": "<p>Doing pointer arithmetic by hand, and using memset / memcpy to set and get your values, is insane. The correct way: </p>\n\n<pre><code>((uint32_t *)mock_sector) [i] = i;\n</code></pre>\n\n<p>And of course malloc (128 * sizeof (uint32_t)), not malloc (512).</p>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 10405839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c651470d4b14c41c408a265d35d6e68?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10405839/nate"}, "edited": false, "score": 0, "creation_date": 1542754219, "post_id": 53402709, "comment_id": 93680835, "body": "memset(mock_sector + i * sizeof(uint32_t), i, sizeof(uint32_t)); The above answer says im assigning each byte the number to be equal to char of i. I just dont see why."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "reply_to_user": {"reputation": 83, "user_id": 10405839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c651470d4b14c41c408a265d35d6e68?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10405839/nate"}, "edited": false, "score": 0, "creation_date": 1542754358, "post_id": 53402709, "comment_id": 93680894, "body": "@Nate <code>memset</code> is copying <code>i</code> to each single byte occupied by the <code>uint32_t</code> at the destination address with that 3rd parameter; that&#39;s what I&#39;m trying to say."}, {"owner": {"reputation": 83, "user_id": 10405839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c651470d4b14c41c408a265d35d6e68?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10405839/nate"}, "edited": false, "score": 0, "creation_date": 1542754456, "post_id": 53402709, "comment_id": 93680923, "body": "Got it. But isn&#39;t i a 4 byte value (uint32). So its only copying the first byte of i 4 times?"}], "tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1542812814, "last_edit_date": 1542812814, "creation_date": 1542753910, "answer_id": 53402709, "question_id": 53402659, "link": "https://stackoverflow.com/questions/53402659/storing-integers-in-a-mallocd-block/53402709#53402709", "title": "Storing integers in a malloc&#39;d block", "body": "<p>If I compile the your program but change the format specifier in <code>printf</code> to be <code>%.8X</code> (base 16) rather than <code>%d</code> (base 10), the output is:</p>\n\n<pre><code>Key is: 00000000\nKey is: 01010101\nKey is: 02020202\nKey is: 03030303\nKey is: 04040404\nKey is: 05050505\nKey is: 06060606\nKey is: 07070707\nKey is: 08080808\nKey is: 09090909\nKey is: 0A0A0A0A\nKey is: 0B0B0B0B\nKey is: 0C0C0C0C\nKey is: 0D0D0D0D\nKey is: 0E0E0E0E\nKey is: 0F0F0F0F\nKey is: 10101010\nKey is: 11111111\nKey is: 12121212\nKey is: 13131313\n</code></pre>\n\n<p>Do you see the pattern and the mistake now? </p>\n\n<p>The second argument to <code>memset</code> is cast to an <code>unsigned char</code> (i.e. a byte) even though it has type <code>int</code>, as documented <a href=\"http://www.cplusplus.com/reference/cstring/memset/\" rel=\"nofollow noreferrer\">here</a>. This means that every single byte (not every <code>uint32_t</code>) will get populated with the value of <code>i</code> cast to a byte.</p>\n\n<p>Use this code to write to your array:</p>\n\n<pre><code>memset(mock_sector, 0, 512);\n\nfor (uint32_t i = 0; i &lt; 20; i++) \n{\n    mock_sector[i * sizeof(uint32_t)] = i;\n}\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 10405839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c651470d4b14c41c408a265d35d6e68?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10405839/nate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 53402702, "answer_count": 2, "score": 1, "last_activity_date": 1542812814, "creation_date": 1542753546, "question_id": 53402659, "link": "https://stackoverflow.com/questions/53402659/storing-integers-in-a-mallocd-block", "title": "Storing integers in a malloc&#39;d block", "body": "<p>I'm working on Pintos part 4, specifically indirect blocks for the inode data structure. The block is supposed to have (512 / 4) = 128 integers referring to other disk sectors inside of it. I did a small mock up here in my c program to write mock sectors to a malloc'd mock sector and then read it back. Why are the keys so big? Why isn't it 0, 1, 2, 3, 4.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;inttypes.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {\n\n  void *mock_sector = malloc(512);\n  for (uint32_t i = 0; i &lt; 20; i++) {\n    memset(mock_sector + i * sizeof(uint32_t), i, sizeof(uint32_t));\n  }\n\n  uint32_t key;\n  for (uint32_t i = 0; i &lt; 20; i++) {\n    memcpy(&amp;key, mock_sector + i * sizeof(uint32_t), sizeof(uint32_t));\n    printf(\"Key is: %d\\n\", key);\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>Result -></p>\n\n<pre><code>Key is: 0\nKey is: 16843009\nKey is: 33686018\nKey is: 50529027\nKey is: 67372036\nKey is: 84215045\nKey is: 101058054\nKey is: 117901063\nKey is: 134744072\nKey is: 151587081\nKey is: 168430090\nKey is: 185273099\nKey is: 202116108\nKey is: 218959117\nKey is: 235802126\nKey is: 252645135\nKey is: 269488144\nKey is: 286331153\nKey is: 303174162\nKey is: 320017171\n</code></pre>\n\n<p>I can even see the addresses I am calling memset on are increasing as they should.</p>\n\n<p>0x18aa010\n0x18aa014\n0x18aa018\n0x18aa01c\n0x18aa020\n0x18aa024\n0x18aa028\n0x18aa02c</p>\n"}, {"tags": ["c", "mpi"], "comments": [{"owner": {"reputation": 186, "user_id": 6353993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b06c9f8fd6570db2508793df830ccc92?s=128&d=identicon&r=PG&f=1", "display_name": "Neil Lindquist", "link": "https://stackoverflow.com/users/6353993/neil-lindquist"}, "edited": false, "score": 0, "creation_date": 1542755810, "post_id": 53402608, "comment_id": 93681352, "body": "Is there a reason you can&#39;t just have the rank 0 process then have the other processes wait at a Barrier?  I&#39;m not familiar enough with the advanced parts of MPI to say you can&#39;t do what your asking, but I don&#39;t think you can do it without a large amount of extra communication."}, {"owner": {"reputation": 186, "user_id": 6353993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b06c9f8fd6570db2508793df830ccc92?s=128&d=identicon&r=PG&f=1", "display_name": "Neil Lindquist", "link": "https://stackoverflow.com/users/6353993/neil-lindquist"}, "edited": false, "score": 0, "creation_date": 1542755861, "post_id": 53402608, "comment_id": 93681364, "body": "Although, if everything is on one computer, you might be able to use OpenMP&#39;s <code>@omp single</code> pragma"}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 1, "creation_date": 1542758415, "post_id": 53402608, "comment_id": 93681954, "body": "in MPI, each process has its own memory space, which means each process has its own <i>version</i> of <code>times</code>. you can simply <code>if (0 == MyProc) do_something_once()</code>. If you want one task initialize <code>A</code> for everyone, you will have to <code>MPI_Bcast()</code> after the initialization."}, {"owner": {"reputation": 17, "user_id": 10676663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43278cc01df6190cb952932b8c4883ae?s=128&d=identicon&r=PG&f=1", "display_name": "afs2", "link": "https://stackoverflow.com/users/10676663/afs2"}, "edited": false, "score": 0, "creation_date": 1542825121, "post_id": 53402608, "comment_id": 93711092, "body": "My problem is that I neet to do something once to be used by all the processes,I&#39;m not sure how to meake the proceses work with an array"}], "owner": {"reputation": 17, "user_id": 10676663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43278cc01df6190cb952932b8c4883ae?s=128&d=identicon&r=PG&f=1", "display_name": "afs2", "link": "https://stackoverflow.com/users/10676663/afs2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542753310, "creation_date": 1542753310, "question_id": 53402608, "link": "https://stackoverflow.com/questions/53402608/control-some-code-to-be-executed-once-in-mpi", "title": "Control some code to be executed once in MPI", "body": "<p>I can't control how to make  to execute some code once using mpi</p>\n\n<pre><code>#include \"mpi.h\"\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;sys/time.h&gt;\n\n#define N 10\n#define ITERS 1\n// N and ITERS might be input arguments\n\ndouble **A;\nint times = 0;\n\nvoid initialize (double **A)\n{\n  int i,j;\n\n  for(i =0; i &lt; N+2 ; i++){\n    for(j =0; j &lt; N+2 ; j++){\n      if(i== 0 || j == 0 || i == (N+1) || j == (N +1) )\n      A[i][j] = 0.0;\n      else\n      A[i][j] = rand() % 10 + 1;\n    }\n  }\n}\n\n\nint main(int argc, char * argv[]){\n\n  int MyProc, size,tag=1;\n  char msg='A', msg_recpt;\n  MPI_Status status;\n  double **received_array;\n\n  MPI_Init(&amp;argc, &amp;argv);\n  MPI_Comm_rank(MPI_COMM_WORLD, &amp;MyProc);\n  MPI_Comm_size(MPI_COMM_WORLD, &amp;size);\n\n  printf(\"Process # %d started \\n\", MyProc);\n  MPI_Barrier(MPI_COMM_WORLD);\n\n  int i;\n  /******Make it once*******/\n  if(times == 0){\n    printf(\"One time\\n\");\n    A = malloc((N+2) * sizeof(double *));\n\n    for (i=0; i&lt;N+2; i++) {\n      A[i] = malloc((N+2) * sizeof(double));\n    }\n    initialize(A);\n    times ++;\n  }\n  /*************/\n\n\n    MPI_Barrier(MPI_COMM_WORLD);\n  }\n  MPI_Finalize();\n}\n</code></pre>\n\n<p>I've tried with <code>times</code> variable as a flag but <em>the make it once</em> section  it's executed once per process...everethig I've tried it's executed once per process ,I don't know what to try, I can't make it using the rank of teh process because I need the first procees to arrive executes the once section. </p>\n"}, {"tags": ["javascript", "c", "integer"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1542753324, "post_id": 53402560, "comment_id": 93680528, "body": "Why not just get the components like the year, month, day, etc.?"}, {"owner": {"reputation": 625, "user_id": 3140754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qceIh.jpg?s=128&g=1", "display_name": "Tom Kuschel", "link": "https://stackoverflow.com/users/3140754/tom-kuschel"}, "edited": false, "score": 0, "creation_date": 1542753424, "post_id": 53402560, "comment_id": 93680567, "body": "Why not using timestamp with time() and localtime() to get the time as well as its components?"}, {"owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "edited": false, "score": 0, "creation_date": 1542753449, "post_id": 53402560, "comment_id": 93680575, "body": "Sorry the date made it confusing, the date part is irrelevant."}, {"owner": {"reputation": 353, "user_id": 1335475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77ef4c4df7698aec60571fd46af35cc0?s=128&d=identicon&r=PG", "display_name": "Blunt Jackson", "link": "https://stackoverflow.com/users/1335475/blunt-jackson"}, "edited": false, "score": 0, "creation_date": 1542753521, "post_id": 53402560, "comment_id": 93680601, "body": "What are you actually tryng to accomplish? You could easily split an n-bit integer into n/8 8 bit intgers, and reconstitute the original... but if you were actually looking for a more efficient way of encapsulating time, that would be pointless."}, {"owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "edited": false, "score": 0, "creation_date": 1542753564, "post_id": 53402560, "comment_id": 93680614, "body": "Nothing to do with date/datetime, sorry about that. Updated the question. I want to convert any integer of arbitrary size to array of 8-bit integers."}], "answers": [{"comments": [{"owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "edited": false, "score": 0, "creation_date": 1542754072, "post_id": 53402695, "comment_id": 93680778, "body": "If the integer is a string and it&#39;s a &quot;bigint&quot; of arbitrary size I don&#39;t think this would work. I would like for it to handle that, not sure how you knew to have 8 items in the <code>bytes</code> array, and that probably wouldn&#39;t work for arbitrarily sized small/bigints ranging from <code>0</code> to <code>&#39;47171857151875817758571875815815782572758275672576575677&#39;</code> or whatever arbitrary size."}, {"owner": {"reputation": 7703, "user_id": 3700849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6q7ai.jpg?s=128&g=1", "display_name": "zfrisch", "link": "https://stackoverflow.com/users/3700849/zfrisch"}, "edited": false, "score": 0, "creation_date": 1542755363, "post_id": 53402695, "comment_id": 93681250, "body": "This may seem relatively straightforward to you, but I don&#39;t understand where <code>Math.floor(bignum &#47; 0x100000000)</code> comes from?"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "reply_to_user": {"reputation": 7703, "user_id": 3700849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6q7ai.jpg?s=128&g=1", "display_name": "zfrisch", "link": "https://stackoverflow.com/users/3700849/zfrisch"}, "edited": false, "score": 0, "creation_date": 1542757694, "post_id": 53402695, "comment_id": 93681796, "body": "@zfrisch That&#39;s shifting the high 32 bits into the low 32 bits. Javascript &gt;&gt; 32 will just produce a 0."}], "tags": [], "owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "is_accepted": false, "score": 1, "last_activity_date": 1542753856, "last_edit_date": 1542753856, "creation_date": 1542753777, "answer_id": 53402695, "question_id": 53402560, "link": "https://stackoverflow.com/questions/53402560/how-to-split-large-integer-into-an-array-of-8-bit-integers/53402695#53402695", "title": "How to split large integer into an array of 8-bit integers", "body": "<p>Most languages, including C and Javascript, have bit-shifting and bit-masking operations as part of their basic math operations. But beware Javascript: numbers are 64 bits, but only 32-bit masking operations are allowed. So:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>let bignum = Date.now();\r\nlet hi = Math.floor(bignum / 0x100000000),\r\n    lo = bignum &amp; 0xFFFFFFFF,\r\n    bytes = [\r\n        (hi &gt;&gt; 24) &amp; 0xFF,\r\n        (hi &gt;&gt; 16) &amp; 0xFF,\r\n        (hi &gt;&gt; 8) &amp; 0xFF,\r\n        hi &amp; 0xFF,\r\n        (lo &gt;&gt; 24) &amp; 0xFF,\r\n        (lo &gt;&gt; 16) &amp; 0xFF,\r\n        (lo &gt;&gt; 8) &amp; 0xFF,\r\n        lo &amp; 0xFF\r\n    ];</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"comments": [{"owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "edited": false, "score": 0, "creation_date": 1550090115, "post_id": 53403239, "comment_id": 96146866, "body": "Wondering if the output will be unique for every unique input. That is, there will be no collisions."}], "tags": [], "owner": {"reputation": 73252, "user_id": 3874623, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6df0aa136ee42f4ea24ef08b7c348e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/3874623/mark"}, "is_accepted": true, "score": 1, "last_activity_date": 1542757458, "last_edit_date": 1542757458, "creation_date": 1542757107, "answer_id": 53403239, "question_id": 53402560, "link": "https://stackoverflow.com/questions/53402560/how-to-split-large-integer-into-an-array-of-8-bit-integers/53403239#53403239", "title": "How to split large integer into an array of 8-bit integers", "body": "<p>I'm not sure if this is too brute-forcey for what you want, but you can take an arbitrary string and just do the long division into a <code>unit8Array</code>.</p>\n\n<p>Here's a function (borrowed liberally from <a href=\"https://stackoverflow.com/questions/18626844/convert-a-large-integer-to-a-hex-string-in-javascript\">here</a>) that will convert back and forth from an arbitrarily long string:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>function eightBit(str){ \r\n    let dec = [...str],  sum = []\r\n    while(dec.length){\r\n        let s = 1 * dec.shift()\r\n        for(let i = 0; s || i &lt; sum.length; i++){\r\n            s += (sum[i] || 0) * 10\r\n            sum[i] = s % 256\r\n            s = (s - sum[i]) / 256\r\n        }\r\n    } \r\n    return Uint8Array.from(sum.reverse())\r\n}\r\n\r\n\r\nfunction eightBit2String(arr){ \r\n    var dec = [...arr], sum = []\r\n    while(dec.length){\r\n        let s = 1 * dec.shift()\r\n        for(let i = 0; s || i &lt; sum.length; i++){\r\n            s += (sum[i] || 0) * 256\r\n            sum[i] = s % 10\r\n            s = (s - sum[i]) / 10\r\n        }\r\n    }\r\n    return sum.reverse().join('')\r\n}\r\n\r\n// sanity check\r\nconsole.log(\"256 = \", eightBit('256'), \"258 = \", eightBit('258')) \r\n \r\nlet n = '47171857151875817758571875815815782572758275672576575677'\r\nlet a = eightBit(n)\r\nconsole.log(\"to convert:\", n)\r\nconsole.log(\"converted:\", a.toString())\r\nlet s = eightBit2String(a)\r\nconsole.log(\"converted back:\", s)</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>No doubt, there are some efficiencies to be found (maybe you can avoid the interim arrays).</p>\n"}], "owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 1, "accepted_answer_id": 53403239, "answer_count": 2, "score": 0, "last_activity_date": 1542757458, "creation_date": 1542753034, "last_edit_date": 1542756749, "question_id": 53402560, "link": "https://stackoverflow.com/questions/53402560/how-to-split-large-integer-into-an-array-of-8-bit-integers", "title": "How to split large integer into an array of 8-bit integers", "body": "<p>Wondering how to convert the output of arbitrarily sized integers like <code>1</code> or <code>12345</code> or <code>5324617851000199519157</code> to an array of integers.</p>\n\n<pre><code>[1] // for the first one\n// [probably just a few values for the second 12345...]\n[1, 123, 255, 32, ...] // not sure here...\n</code></pre>\n\n<p>I am not sure what the resulting value would look like or how to compute it, but somehow it would be something like:</p>\n\n<p>A bunch of 8-bit numbers that can be used to reconstruct (somehow) the original arbitrary integer. I am not sure what calculations would be required to do this either. But all I do know is that each unique arbitrarily-sized integer should result in a unique array of 8-bit values. That is, no two different date integers should result in the same array.</p>\n\n<p>It doesn't matter the language much how this is implemented, but probably an imperative language like JavaScript or C.</p>\n\n<p>I am pretty sure the arrays should all be the same length as well, but if that's not possible then knowing how to do it a different way would be okay.</p>\n"}]