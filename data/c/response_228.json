[{"tags": ["c", "fpga", "zynq", "petalinux"], "comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1558567322, "post_id": 56266114, "comment_id": 99148547, "body": "silly question but is <code>sizeof(double) == sizeof(unsigned long)</code> on your system?"}, {"owner": {"reputation": 23, "user_id": 11542024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57d30c59e2d62002b2ad45c01d8bede2?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/11542024/harry"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1558568654, "post_id": 56266114, "comment_id": 99148758, "body": "yes they both are 8 bytes  Size of Double 8, Size of UL 8"}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1558575285, "post_id": 56266968, "comment_id": 99149907, "body": "If they are going to write all the bytes as one object, they might as well just write a <code>double</code>. If that cannot work due to alignment or other issues, they should just <code>memcpy</code> between the <code>double</code> and the memory. Either way, they do not need the union or <code>unsigned long *</code>."}, {"owner": {"reputation": 259, "user_id": 4526054, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N5Ub5.jpg?s=128&g=1", "display_name": "brhans", "link": "https://stackoverflow.com/users/4526054/brhans"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1558577109, "post_id": 56266968, "comment_id": 99150212, "body": "@EricPostpischil - true. I was just trying to keep within the spirit of the original code... The intent could certainly be expressed better."}, {"owner": {"reputation": 23, "user_id": 11542024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57d30c59e2d62002b2ad45c01d8bede2?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/11542024/harry"}, "edited": false, "score": 0, "creation_date": 1558577834, "post_id": 56266968, "comment_id": 99150352, "body": "Thank you so much brhans !!, so silly of me to miss the type I am writing it to."}], "tags": [], "owner": {"reputation": 259, "user_id": 4526054, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N5Ub5.jpg?s=128&g=1", "display_name": "brhans", "link": "https://stackoverflow.com/users/4526054/brhans"}, "is_accepted": true, "score": 1, "last_activity_date": 1558575322, "last_edit_date": 1558575322, "creation_date": 1558575025, "answer_id": 56266968, "question_id": 56266114, "link": "https://stackoverflow.com/questions/56266114/read-write-to-memory-space/56266968#56266968", "title": "Read Write to Memory space", "body": "<p>Your problem is here:</p>\n\n<pre><code>    *((unsigned char *) (weights+0x00))  = conv.lw;   // Writing into the mempory\n    SysMem= *((unsigned char *) (weights+0x00));    // Reading it out from the memory\n</code></pre>\n\n<p>You're casting your <code>(void *) weights</code> as a <code>(unsigned char *)</code>, then storing the value of <code>conv.lw</code> at that pointer location.<br>\nBut by doing that type-cast, you've explicitly told your compiler that you only want to write a single <code>unsigned char</code>, so it quite happily does that with the least-significant byte of <code>conv.lw</code>.<br>\nSimilarly, when you read it back, you again cast <code>weights</code> as an <code>(unsigned char *)</code> and so you're only reading a singe byte form that location.  </p>\n\n<p>If you  instead did something like:</p>\n\n<pre><code>    *((unsigned long *) (weights+0x00))  = conv.lw;   // Writing into the mempory\n    SysMem= *((unsigned long *) (weights+0x00));    // Reading it out from the memory\n</code></pre>\n\n<p>you'd be writing and reading all the bytes of <code>conv.lw</code>.  </p>\n\n<p>There are also a few reasons which make what you're trying to do non-portable, including: <code>unsigned long</code> is only typically only 4 bytes on a 32-bit architecture, and dereferencing pointers cast from other types is (at least sometimes) undefined behavior.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 11542024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57d30c59e2d62002b2ad45c01d8bede2?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/11542024/harry"}, "edited": false, "score": 0, "creation_date": 1558577798, "post_id": 56267035, "comment_id": 99150341, "body": "Eric Postpischil , Thank you so much for fixing my issue !!"}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 0, "last_activity_date": 1558576022, "last_edit_date": 1558576022, "creation_date": 1558575692, "answer_id": 56267035, "question_id": 56266114, "link": "https://stackoverflow.com/questions/56266114/read-write-to-memory-space/56267035#56267035", "title": "Read Write to Memory space", "body": "<p>The assignment <code>*((unsigned char *) (weights+0x00))  = conv.lw;</code> writes only a single <code>unsigned char</code>, and <code>SysMem= *((unsigned char *) (weights+0x00));</code> reads only a single <code>unsigned char</code>.</p>\n\n<p>To write and read a <code>double</code>, use either:</p>\n\n<pre><code>* (double *) weights = conv.dw;\ndouble x = * (double *) weights;\nprintf(\"%a\\n\", x); // Or use %g or %f.\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>memcpy(weights, conv.dw, sizeof conv.dw);\ndouble x;\nmemcpy(x, weights, sizeof x);\nprintf(\"%a\\n\", x); // Or use %g or %f.\n</code></pre>\n\n<p>The first method requires that <code>weights</code> be suitably aligned for your platform (it looks like it would be in your example code). There should not be aliasing issues directly from this code since <code>conv.dw</code> is accessed as its proper type (<code>double</code>), and <code>weights</code> is effectively a dynamically allocated object (providing your code for getting its value is correct, and presumably your compiler supports this), so a <code>double</code> is effectively created at <code>weights</code> by writing a <code>double</code> to there.</p>\n\n<p>The second method should work regardless of alignment, provided the address in <code>weights</code> is properly accessible in your process.</p>\n\n<p>In either case, there is no need for the union. The <code>double</code> can be used directly, without aliasing it with an <code>unsigned long</code>.</p>\n"}], "owner": {"reputation": 23, "user_id": 11542024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57d30c59e2d62002b2ad45c01d8bede2?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/11542024/harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 0, "accepted_answer_id": 56266968, "answer_count": 2, "score": 1, "last_activity_date": 1558576022, "creation_date": 1558566772, "question_id": 56266114, "link": "https://stackoverflow.com/questions/56266114/read-write-to-memory-space", "title": "Read Write to Memory space", "body": "<p>I am trying to write a Signed Double number to memory and read back the same, reading back is redundant as it is just to verify if the correct data is in the memory before I trigger the PL (programmable logic) FPGA Fabric to access this data and perform a task.</p>\n\n<p>I read a file into a double (part of a union) and then write to memory through the unsigned long (part of a union). But the data before writing into memory and after I read out is wrong, it is just the last byte. (see the code and comments for details)</p>\n\n<pre><code>union floatpun {\n    double dw;\n    unsigned long lw;\n};\n\nvoid *lookup_slave_by_phy_addr(const int fd, const off_t target, const size_t mapsize)\n{\n  void *map_base, *virt_addr;\n\n  /* Map one page */\n  map_base = mmap(0, mapsize, PROT_READ | PROT_WRITE, MAP_SHARED, fd, target &amp; ~(mapsize-1));\n  if (map_base == (void *) -1) { FATAL; }\n  printf(\"Memory mapped at address %p.\\n\", map_base);\n  fflush(stdout);\n\n  virt_addr = map_base + (target &amp; (mapsize-1));\n  return virt_addr;\n}\n\n\nint main(int argc, char *argv[])\n{  \n  union floatpun conv;\n\n  FILE *fp;\n  fp = fopen(\"/media/card/numbers.txt\", \"r\");\n  fscanf(fp,\"%lf\",&amp;conv.dw);  // 0.009101592004299160 Reads this number from the file, which is correct as expected.\n  printf(\"The value Read from the File is %lx \\n\",conv.lw); // Prints 3f 82 a3 da ff ff ff fe, which is also correct.\n  fclose(fp);\n\n  int fd;\n  if ((fd = open(\"/dev/mem\", O_RDWR | O_SYNC)) == -1) { FATAL; }\n  printf(\"/dev/mem opened.\\n\");\n  fflush(stdout);\n\n  void *weights;\n  // Map systemMemory master phy address range 0000 0008 7000 0000 -&gt; 0000 0008 7FFF FFFF\n  weights       = lookup_slave_by_phy_addr(fd,strtoul(\"0x0000000870000000\",0,0),MAP_SIZE_256M);\n    *((unsigned char *) (weights+0x00))  = conv.lw;   // Writing into the mempory\n    SysMem= *((unsigned char *) (weights+0x00));    // Reading it out from the memory\n    printf(\"Read %lx\\n\", SysMem);                   // When this is printed I get only FE, the last byte of the data read from the file, I have read the following 0x01, 02 03 also, which are all junk data like 0x69 0x95 0x9A\n\n  close(fd);\n  return 0;\n}\n\n\n</code></pre>\n\n<p>What mistake am I doing in writing to memory or reading from the memory, I want this complete 64 bit written to the memory. Or should I manually write each byte to a byte of memory, arent the memory word (32 Bit) addressable? or if not can I make it a word addressable? </p>\n\n<p>Also, this is being done on Zynq with Petalinux</p>\n\n<p>Please help :)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "edited": false, "score": 0, "creation_date": 1558566684, "post_id": 56266074, "comment_id": 99148396, "body": "In your while loop <code>str</code> stays the same, you&#39;re not changing the address so the loop does the same in every iteration"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1558566688, "post_id": 56266074, "comment_id": 99148397, "body": "You haven&#39;t allocated any memory for <code>str</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1558566719, "post_id": 56266074, "comment_id": 99148407, "body": "You need <code>char *str = malloc(10000000);</code>"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1558571030, "post_id": 56266074, "comment_id": 99149190, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Your current code sample has comments that aren&#39;t properly commented out."}], "answers": [{"tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": true, "score": 0, "last_activity_date": 1558567154, "last_edit_date": 1558567154, "creation_date": 1558566812, "answer_id": 56266126, "question_id": 56266074, "link": "https://stackoverflow.com/questions/56266074/how-to-read-just-a-line-with-an-unknown-quantity-of-ints-from-a-text-file-onto-a/56266126#56266126", "title": "How to read just a line with an unknown quantity of ints from a text file onto an array (in C)", "body": "<p>The <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_sscanf.htm\" rel=\"nofollow noreferrer\"><code>sscanf</code></a> function cannot keep track of what it has read from a string like the <code>fscanf</code> function because <code>fscanf</code> functions reads from a file stream which has an internal pointer that moves ahead.</p>\n\n<p>To get the same effect with strings and <code>sscanf</code>, you need to manually move the pointer ahead. The following snippet can be used to read consecutively from the string. </p>\n\n<pre><code>int pos = 0;\nint amount;\nwhile (sscanf(str+pos,\"%d %n\", &amp;tmp, &amp;amount)) {\n    pos += amount;\n    // Rest of the code inside the while loop\n}\n</code></pre>\n\n<p>Here instead of <code>str</code> we are using <code>str + pos</code>, the pos variable keeps track of how much you have read from the string and acts like a progress pointer. \nIt is updated every time with the amount read in that call to <code>sscanf</code>. The <code>%n</code> format specifier lets us read how many characters were actually processed. </p>\n\n<p>Also, as mentioned in the comments, you are not allocating any memory for <code>str</code>. \nYou can either use the size <code>10000000</code> (which is the size you pass to <code>fgets</code>) or use <a href=\"http://man7.org/linux/man-pages/man3/getline.3.html\" rel=\"nofollow noreferrer\"><code>getline</code></a> (but <code>getline</code> is not standard C). </p>\n"}], "owner": {"reputation": 23, "user_id": 11541975, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kuv_Y6tJaF0/AAAAAAAAAAI/AAAAAAAAACQ/XV2kLzgpnxo/photo.jpg?sz=128", "display_name": "Luiz Cavalcanti", "link": "https://stackoverflow.com/users/11541975/luiz-cavalcanti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 1, "closed_date": 1558566850, "accepted_answer_id": 56266126, "answer_count": 1, "score": 0, "last_activity_date": 1558567154, "creation_date": 1558566393, "question_id": 56266074, "link": "https://stackoverflow.com/questions/56266074/how-to-read-just-a-line-with-an-unknown-quantity-of-ints-from-a-text-file-onto-a", "closed_reason": "Duplicate", "title": "How to read just a line with an unknown quantity of ints from a text file onto an array (in C)", "body": "<p>I'm trying to read a matrix from a .csr file (not exactly .csr, but based on the .csr format). The first line contains the dimensions of the matrix (x,y). The following line has an unknown number of floats, and the two following lines have the column and line where each of those floats read go.</p>\n\n<p>I thought I could read the line from the file with fgets to get the whole line where the array is going to be read, then use sscanf on the string copyed by fgets. The problem is, sscanf doesn't read one by one the ints in the string. It reads the first int on the string many times over.</p>\n\n<p>This is currently the code I wrote:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int * readLineOfInts(FILE * file) { \n  if (!file) return NULL;\n\n  int tmp, counter = 1, buff = 5, *v = malloc(buff * sizeof(int)); \n  char *str;\n  fgets(str, 10000000, file);   string e salva em str\n  while (sscanf(str,\"%d\", &amp;tmp)) {  \n    if (counter == buff) {    \n      buff *= 2;\n      v = realloc(v,buff * sizeof(int));\n    }\n    v[counter++] = tmp; \n  }\n  v[0] = counter; \n return v;\n\n}\n</code></pre>\n\n<p>If the input file is</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>5 5\n0.2 0.6 0.4\n2 3 3\n2 2 3\n</code></pre>\n\n<p>The resulting array from reading the third line should be:\nv={2,3,3}</p>\n\n<p>But my code results in:\nv={2,2,2}</p>\n"}, {"tags": ["c", "ubuntu"], "comments": [{"owner": {"reputation": 199, "user_id": 4883238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbdd8a03ea95fc24d6fd7087fc215c26?s=128&d=identicon&r=PG&f=1", "display_name": "BugSquasher", "link": "https://stackoverflow.com/users/4883238/bugsquasher"}, "edited": false, "score": 0, "creation_date": 1558573982, "post_id": 56265913, "comment_id": 99149684, "body": "Why two programs to do one thing? I hope this is a learning exercise"}, {"owner": {"reputation": 75, "user_id": 11521763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21fe913ec903c2cdc7d0aaf7e8e03e05?s=128&d=identicon&r=PG&f=1", "display_name": "protik", "link": "https://stackoverflow.com/users/11521763/protik"}, "reply_to_user": {"reputation": 199, "user_id": 4883238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbdd8a03ea95fc24d6fd7087fc215c26?s=128&d=identicon&r=PG&f=1", "display_name": "BugSquasher", "link": "https://stackoverflow.com/users/4883238/bugsquasher"}, "edited": false, "score": 0, "creation_date": 1558574208, "post_id": 56265913, "comment_id": 99149719, "body": "@BugSquasher, it is a Synchronization Problem."}, {"owner": {"reputation": 199, "user_id": 4883238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbdd8a03ea95fc24d6fd7087fc215c26?s=128&d=identicon&r=PG&f=1", "display_name": "BugSquasher", "link": "https://stackoverflow.com/users/4883238/bugsquasher"}, "edited": false, "score": 0, "creation_date": 1558574336, "post_id": 56265913, "comment_id": 99149746, "body": "Which has already been solved by every major os why do it again, and in such an inefficient manner? Shared memory between two processes is not needed."}, {"owner": {"reputation": 199, "user_id": 4883238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbdd8a03ea95fc24d6fd7087fc215c26?s=128&d=identicon&r=PG&f=1", "display_name": "BugSquasher", "link": "https://stackoverflow.com/users/4883238/bugsquasher"}, "edited": false, "score": 0, "creation_date": 1558675402, "post_id": 56265913, "comment_id": 99185558, "body": "To be more useful, I think you have a race condition in the memdata struct M because the data in the struct itself is not guarded by a mutex. That would explain the different files at least. I&#39;ll have to look at your code more in depth tomorrow."}, {"owner": {"reputation": 75, "user_id": 11521763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21fe913ec903c2cdc7d0aaf7e8e03e05?s=128&d=identicon&r=PG&f=1", "display_name": "protik", "link": "https://stackoverflow.com/users/11521763/protik"}, "reply_to_user": {"reputation": 199, "user_id": 4883238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbdd8a03ea95fc24d6fd7087fc215c26?s=128&d=identicon&r=PG&f=1", "display_name": "BugSquasher", "link": "https://stackoverflow.com/users/4883238/bugsquasher"}, "edited": false, "score": 0, "creation_date": 1558714941, "post_id": 56265913, "comment_id": 99205113, "body": "@BugSquasher, yes."}], "owner": {"reputation": 75, "user_id": 11521763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21fe913ec903c2cdc7d0aaf7e8e03e05?s=128&d=identicon&r=PG&f=1", "display_name": "protik", "link": "https://stackoverflow.com/users/11521763/protik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558571006, "creation_date": 1558565174, "last_edit_date": 1558571006, "question_id": 56265913, "link": "https://stackoverflow.com/questions/56265913/c-reader-writer-mutexes-for-a-copying-a-file-using-shared-memory-and-ring-buffer", "title": "C Reader Writer Mutexes for a Copying a File using Shared Memory and Ring Buffer", "body": "<p>I want to build a File Copier using Reader-Writer Synchronization Paradigm.\nThe Writer initializes the both of the Mutexes. The FullMutex is denoting how many Buffers are available to Write and the FreeMutex is denoting how many Buffers are available to Read.\nThe Writer waits when the Block is Full.\nThe WritePointer and ReadPointer is using the Ring Buffer. Therefore I have used Mod Operation.\nThe Block Size=M.\nThe Buffer Size=B.\nThere are N number of Buffers.\nSo, M=N*B.\nThe File Size=2M.\nAnd therefore BufferCount is actually advancing File Pointer.\nWhen all Bytes are written, I am issuing FileEnding=1.</p>\n\n<p>The compilation commands are-</p>\n\n<pre><code>g++ Writer.c -o Writer -lpthread -lrt\ng++ Reader.c -o Reader -lpthread -lrt\n</code></pre>\n\n<p>And in 2 different comand prompts are open and the commands are issued-</p>\n\n<pre><code>./Writer\n./Reader\n</code></pre>\n\n<p>Now I do not know why it is not copying and do not know how to use sem_post.<br>\nHere is the Writer.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/mman.h&gt;\n\nint main(void){\n    struct MemData{\n        sem_t FullMutex;\n        sem_t FreeMutex;\n        char FileName[128];\n        int ReadPointer;\n        int WritePointer;\n        int FileEnding;\n        char Data[512000];//MEMORY BLOCK SIZE: 500 KB\n    };\n    int SD;\n    struct MemData *M;\n    int NumberOfBuffers=10;\n    //int BufferSize=51200;//FILE BUFFER SIZE 50 KB\n    int BufferSize=2;//EXPERIMENATION\n    unsigned char Buf[BufferSize];\n    int BufferCount=0;\n\n    SD= shm_open(\"/program.shared\", O_RDWR|O_CREAT, S_IREAD|S_IWRITE);\n    if(SD&lt; 0){\n        printf(\"\\nshm_open() error \\n\");\n        return EXIT_FAILURE;\n    }\n    fchmod(SD, S_IRWXU|S_IRWXG|S_IRWXO);\n    if(ftruncate(SD, sizeof(MemData))&lt; 0){\n        printf (\"ftruncate() error \\n\");\n        return EXIT_FAILURE;\n    }\n    M=(struct MemData*)mmap(NULL, sizeof(MemData), PROT_READ|PROT_WRITE, MAP_SHARED, SD, 0);\n    if(M== MAP_FAILED){\n        printf(\"mmap() error\");\n        return EXIT_FAILURE;\n    }else{\n        sem_init(&amp;M-&gt;FullMutex, 1, 0);\n        sem_init(&amp;M-&gt;FreeMutex, 1, NumberOfBuffers);\n        strcpy(M-&gt;FileName, \"aaa.txt\");\n        M-&gt;FileEnding=0;\n        M-&gt;ReadPointer=0;\n        M-&gt;WritePointer=0;\n        memset(M-&gt;Data, '\\0', strlen(M-&gt;Data));\n    }\n    char FileName[128]=\"aaa.txt\";\n    FILE *FP= fopen(FileName, \"rb\");\n    if(FP!= NULL){\n        struct stat StatBuf;\n        if(stat(FileName, &amp;StatBuf)==-1){\n            printf(\"failed to fstat %s\\n\", FileName);\n            exit(EXIT_FAILURE);\n        }\n        long long FileSize=StatBuf.st_size;\n        printf(\"\\nFile Size: %lld\", FileSize);\n        long long FilePosition=ftell(FP);\n        FilePosition=ftell(FP);\n        long long CopyableMemorySize=FileSize-FilePosition;\n        printf(\"\\nCopyable File Size: %lld\", CopyableMemorySize);\n        int NumberOfFileBuffers=CopyableMemorySize/BufferSize;\n        printf(\"\\n Number Of File Buffers: %d\", NumberOfFileBuffers);\n        while(1){\n            sem_wait(&amp;M-&gt;FreeMutex);\n            fseek(FP, BufferCount*BufferSize, SEEK_SET);\n            fread(Buf, sizeof(unsigned char), BufferSize, FP);\n            int FreeMutexValue;\n            sem_getvalue(&amp;M-&gt;FreeMutex, &amp;FreeMutexValue);\n            int FullMutexValue;\n            sem_getvalue(&amp;M-&gt;FullMutex, &amp;FullMutexValue);\n            printf(\"\\nMutexes-Free: %d and Full: %d\", FreeMutexValue, FullMutexValue);\n            printf(\"\\nBuffer Writing: %s\", BufferCount);\n            memcpy(&amp;M-&gt;Data[M-&gt;WritePointer*BufferSize], &amp;Buf, sizeof(Buf)*sizeof(unsigned char));\n            BufferCount++;\n            M-&gt;WritePointer=(M-&gt;WritePointer+1)%NumberOfBuffers;\n            if(BufferCount&gt;=NumberOfFileBuffers &amp;&amp; M-&gt;WritePointer==M-&gt;ReadPointer){\n                M-&gt;FileEnding=1;\n                break;\n            }\n            sem_post(&amp;M-&gt;FullMutex);\n        }\n        fclose(FP);\n    }\n    close(SD);\n    return 0;\n}\n</code></pre>\n\n<p>The Reader is using the Mutex opened by the Writer.c.\nAll the Block Size, Buffer Size and Number of Buffers are same like the Writer.c.\nWhen the Reader gets FileEnding==1, it breaks the loop since there is nothing to process.\nThe Reader destroy the Mutex and deallocates Memory.</p>\n\n<p>Here is the Reader.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/mman.h&gt;\n\nint main(void){\n    char FileName[128]=\"bbb.txt\";\n    struct MemData{\n        sem_t FullMutex;\n        sem_t FreeMutex;\n        char FileName[128];\n        int ReadPointer;\n        int WritePointer;\n        int FileEnding;\n        char Data[512000];//MEMORY BLOCK SIZE: 500 KB\n    };\n    int SD;\n    struct MemData *M;\n    int NumberOfBuffers=10;\n    //int BufferSize=51200;//FILE BUFFER SIZE 50 KB\n    int BufferSize=2;//EXPERIMENATION\n    unsigned char Buf[BufferSize];\n    int BufferCount=0;\n    SD= shm_open(\"/program.shared\", O_RDWR|O_CREAT, S_IREAD|S_IWRITE);\n    if(SD&lt; 0){\n        printf(\"\\nshm_open() error \\n\"); \n        return EXIT_FAILURE; \n    }\n    M=(struct MemData*)mmap(NULL, sizeof(MemData), PROT_READ|PROT_WRITE, MAP_SHARED, SD, 0);\n    if(M== MAP_FAILED){\n        printf(\"mmap() error\");\n        return EXIT_FAILURE;\n    }\n\n    FILE *FP= fopen(FileName, \"wb\");\n    if(FP!= NULL){\n        while(1){\n            sem_wait(&amp;M-&gt;FullMutex);\n            int FreeMutexValue;\n            sem_getvalue(&amp;M-&gt;FreeMutex, &amp;FreeMutexValue);\n            int FullMutexValue;\n            sem_getvalue(&amp;M-&gt;FullMutex, &amp;FullMutexValue);\n            printf(\"\\nMutexes-Free: %d and Full: %d\", FreeMutexValue, FullMutexValue);\n             printf(\"\\nBuffer Writing: %d\", BufferCount);\n            printf(\"\\nReadPointer: %d\", M-&gt;ReadPointer);\n            printf(\"\\nWritePointer: %d\", M-&gt;WritePointer);\n            fseek(FP, BufferCount*BufferSize, SEEK_SET);\n            fseek(FP, BufferCount*BufferSize, SEEK_SET);\n            fwrite(&amp;M-&gt;Data[M-&gt;ReadPointer*BufferSize], sizeof(unsigned char), BufferSize, FP);\n            BufferCount++;\n            M-&gt;ReadPointer=(M-&gt;ReadPointer+1)%NumberOfBuffers;\n            if(M-&gt;FileEnding){\n                fclose(FP);\n                break;\n            }\n            sem_post(&amp;M-&gt;FreeMutex);\n        }\n    }\n    munmap(M,sizeof(MemData));\n    close(SD);\n    return 0;\n}\n</code></pre>\n\n<p>The input(aaa.txt) file contains these lines-</p>\n\n<pre><code>1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n</code></pre>\n\n<p>The output(bbb.txt) file contains these lines-</p>\n\n<pre><code>1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14    \n</code></pre>\n"}, {"tags": ["c", "hash"], "comments": [{"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 1, "creation_date": 1558564687, "post_id": 56265815, "comment_id": 99147982, "body": "Yes. The hash function can always be hardcoded and then you don&#39;t need the pointer."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1558564722, "post_id": 56265815, "comment_id": 99147988, "body": "Presumably it&#39;s a pointer to a function that computes the hash value."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1558565666, "post_id": 56265815, "comment_id": 99148198, "body": "You may find <a href=\"http://www.sparknotes.com/cs/searching/hashtables/section3.rhtml\" rel=\"nofollow noreferrer\">Coding up a Hash Table</a> and <a href=\"http://eternallyconfuzzled.com/tuts/datastructures/jsw_tut_hashtable.aspx\" rel=\"nofollow noreferrer\">Hash tables - eternally confuzzled</a> useful. What happens in the event of a hash-collision, the bucket, instead of being a pointer to a single <code>bucket</code> is used as a pointer to a list of <code>bucket</code> where &quot;chaining&quot; is used to create the list."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1558566513, "post_id": 56265815, "comment_id": 99148356, "body": "<code>unsigned long int(*hash)(char*);</code> just allows the user to specify a hash function of their choice. A generic hash function might not work if the inputs are highly skewed and the user might know the right hashing function."}], "owner": {"reputation": 11, "user_id": 11494219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e264154a3f8a6cd203caa92417df6ef2?s=128&d=identicon&r=PG&f=1", "display_name": "physicscsbot", "link": "https://stackoverflow.com/users/11494219/physicscsbot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558574385, "creation_date": 1558564267, "last_edit_date": 1558574385, "question_id": 56265815, "link": "https://stackoverflow.com/questions/56265815/understanding-linked-list-hash-table-implementation", "title": "Understanding Linked List Hash Table Implementation", "body": "<pre><code>/* a bucket is a linked list, each of whose entries contains a string and its hash */\n\ntypedef struct bucket bucket;\nstruct bucket {\n  char *string;\n  unsigned long int hash;\n  bucket *next;\n};\n/* By convention, the empty bucket is NULL. */\n\ntypedef struct hash_table htbl;\nstruct hash_table {\n  unsigned long int(*hash)(char*);\n  bucket **buckets; /* an array of buckets */\n  unsigned int n_buckets;\n};\n</code></pre>\n\n<p>I am trying to understand the hash_table struct. Specifically what is the purpose and use of <code>unsigned long int(*hash)(char*);</code>? I feel like I can implement a hash table without it. Any help will be greatly appreciated. Thanks!</p>\n"}, {"tags": ["c", "gcc", "modulo", "integer-division"], "comments": [{"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 1, "creation_date": 1558561888, "post_id": 56265480, "comment_id": 99147238, "body": "Do <code>x&#47;y</code> and <code>x%y</code> and then <code>x&#47;y*x + x%y</code>"}, {"owner": {"reputation": 166, "user_id": 7421890, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cad325e142f1a565d95d7d5ee13aa49f?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7421890/chris"}, "edited": false, "score": 0, "creation_date": 1558562398, "post_id": 56265480, "comment_id": 99147384, "body": "@theborn yes, haven&#39;t found that question..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1558576876, "post_id": 56265480, "comment_id": 99150167, "body": "<code>%</code> is not the <i>modulo</i> operator.  It is the <i>remainder</i>.  <a href=\"https://stackoverflow.com/a/20638659/2410359\">What&#39;s the difference between \u201cmod\u201d and \u201cremainder\u201d?</a>"}], "owner": {"reputation": 166, "user_id": 7421890, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cad325e142f1a565d95d7d5ee13aa49f?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7421890/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "closed_date": 1558562415, "answer_count": 0, "score": 1, "last_activity_date": 1558562001, "creation_date": 1558561768, "last_edit_date": 1558562001, "question_id": 56265480, "link": "https://stackoverflow.com/questions/56265480/gcc-modulo-calculates-wrong-results", "closed_reason": "Duplicate", "title": "gcc - modulo calculates wrong results", "body": "<p>While debugging my C code I've noticed that the modulo operator does not calculate the right results. I've separated the code into a single file, but no success... What's going on here?</p>\n\n<p>My system:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ cat /etc/redhat-release\nCentOS Linux release 7.6.1810 (Core)\n$ uname -s -r\nLinux 3.10.0-957.12.2.el7.x86_64\n$ uname -v\n#1 SMP Tue May 14 21:24:32 UTC 2019\n$ gcc --version\ngcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-36)\n</code></pre>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\nint main() {\n    int i;\n    printf(\"[\");\n    for(i=-11; i&lt;=11; i++) {\n        printf(\"%d \", i%11);\n    }\n    printf(\"]\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>Compile and run:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>gcc -Wall -Wextra -o test_modulo test_modulo.c\n./test_modulo\n[0 -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 0 1 2 3 4 5 6 7 8 9 10 0 ]\n</code></pre>\n\n<p>The modulo-function in the python-console:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>&gt;&gt;&gt; print([i % 11 for i in range(-11,11)])\n[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n</code></pre>\n"}, {"tags": ["c", "optimization"], "comments": [{"owner": {"reputation": 9263, "user_id": 1536976, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cc2372591e00f2ab504b59b4f7cbed43?s=128&d=identicon&r=PG", "display_name": "Trilarion", "link": "https://stackoverflow.com/users/1536976/trilarion"}, "edited": false, "score": 0, "creation_date": 1558562156, "post_id": 56265466, "comment_id": 99147321, "body": "You could display the numbers 1 to 20 as products of primes and then taking the number that is a product of primes with an the maximal order in the products before. Something like 16*9*5*7*9*11*13*17*19."}, {"owner": {"reputation": 14233, "user_id": 916000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/eumU0.png?s=128&g=1", "display_name": "Taha Paksu", "link": "https://stackoverflow.com/users/916000/taha-paksu"}, "edited": false, "score": 0, "creation_date": 1558562199, "post_id": 56265466, "comment_id": 99147326, "body": "And it also needs to end with 0."}, {"owner": {"reputation": 14233, "user_id": 916000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/eumU0.png?s=128&g=1", "display_name": "Taha Paksu", "link": "https://stackoverflow.com/users/916000/taha-paksu"}, "edited": false, "score": 0, "creation_date": 1558562705, "post_id": 56265466, "comment_id": 99147464, "body": "You can start with 3 * 7 * 10 * 11 * 13 * 17 * 19 = 9699690 as an initial pointer and check if it divides with 4, 9, 16. if it doesnt, add 9699690 more and test it again."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1558562759, "post_id": 56265466, "comment_id": 99147478, "body": "There is something you probably learned in elementary school that helps with this. When you were taught to add fractions with different denominators, you had to find a common denominator. Do you remember any of the techniques that were taught about that? If you were adding 1/6+1/10, how would you find the answer?"}, {"owner": {"reputation": 5, "user_id": 11509920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97441246ea59146d063ea5680af9cdba?s=128&d=identicon&r=PG&f=1", "display_name": "BishamonX", "link": "https://stackoverflow.com/users/11509920/bishamonx"}, "edited": false, "score": 0, "creation_date": 1558563576, "post_id": 56265466, "comment_id": 99147703, "body": "I remember but I didn&#39;t want to make calculations on the paper. Instead, I want computer to make those calculations. That&#39;s the tip I&#39;m looking for my friend."}, {"owner": {"reputation": 5, "user_id": 11509920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97441246ea59146d063ea5680af9cdba?s=128&d=identicon&r=PG&f=1", "display_name": "BishamonX", "link": "https://stackoverflow.com/users/11509920/bishamonx"}, "edited": false, "score": 0, "creation_date": 1558563628, "post_id": 56265466, "comment_id": 99147721, "body": "By the way, thank you all for your answers. I&#39;ll do my best with them."}, {"owner": {"reputation": 337, "user_id": 8952646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd2b924ba57e7db4a4029b0a9bf510b?s=128&d=identicon&r=PG&f=1", "display_name": "isragram", "link": "https://stackoverflow.com/users/8952646/isragram"}, "edited": false, "score": 0, "creation_date": 1558564010, "post_id": 56265466, "comment_id": 99147806, "body": "Try to avoid <code>goto</code>, it may bring you problems in future projects."}, {"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 0, "creation_date": 1558564305, "post_id": 56265466, "comment_id": 99147886, "body": "2x2x2x2x3x3x5x7x11x13x17x19 ... Multiply the max power of each prime less than your number.  That should work for all values (not just 20) but the numbers get big fast so use unsigned long long (or a big number library for really high values)."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 0, "creation_date": 1558564815, "post_id": 56265466, "comment_id": 99148004, "body": "@technosaurus There are some great answers in these comments; far better than mine (even if the improvement is significant) - <i>please</i> take the time to actually post an answer!  A more complete explanation would benefit those without the necessary math fu.  For example the phrase <i>&quot;max power of each prime less than your number&quot;</i> might not mean anything to many."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1558566233, "post_id": 56265466, "comment_id": 99148305, "body": "This is a duplicate of a question answered two thousand, three hundred years ago."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1558572224, "post_id": 56265466, "comment_id": 99149383, "body": "My program to compute and print all the values for numbers from 1 to 46 takes between 6 and 7 milliseconds to print the lot \u2014 on an ordinary MacBook Pro.  That code is available in my <a href=\"https://github.com/jleffler/soq\" rel=\"nofollow noreferrer\">SOQ</a> (Stack Overflow Questions) repository on GitHub as file <code>lcm20.c</code> in the <a href=\"https://github.com/jleffler/soq/tree/master/src/miscellany\" rel=\"nofollow noreferrer\">src/miscellany</a> sub-directory."}, {"owner": {"reputation": 5, "user_id": 11509920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97441246ea59146d063ea5680af9cdba?s=128&d=identicon&r=PG&f=1", "display_name": "BishamonX", "link": "https://stackoverflow.com/users/11509920/bishamonx"}, "reply_to_user": {"reputation": 337, "user_id": 8952646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd2b924ba57e7db4a4029b0a9bf510b?s=128&d=identicon&r=PG&f=1", "display_name": "isragram", "link": "https://stackoverflow.com/users/8952646/isragram"}, "edited": false, "score": 0, "creation_date": 1558610659, "post_id": 56265466, "comment_id": 99162822, "body": "@isragram May it bring problem if I only use it to break loops? If so, is there a faster way to do it instead of putting multiple breaks for each loop?"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11509920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97441246ea59146d063ea5680af9cdba?s=128&d=identicon&r=PG&f=1", "display_name": "BishamonX", "link": "https://stackoverflow.com/users/11509920/bishamonx"}, "edited": false, "score": 0, "creation_date": 1558564156, "post_id": 56265747, "comment_id": 99147841, "body": "I have defined #define PRIMES 11*13*17*19*20 and increment number with PRIMES. And it made it work less than 1 sec! Thank you for the advise. (Sorry about the answering format, still couldn&#39;t get used to with it...)"}], "tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": true, "score": 1, "last_activity_date": 1558564427, "last_edit_date": 1558564427, "creation_date": 1558563808, "answer_id": 56265747, "question_id": 56265466, "link": "https://stackoverflow.com/questions/56265466/find-the-least-common-multiple-of-multiple-numbers/56265747#56265747", "title": "Find the least common multiple of multiple numbers", "body": "<p>Change</p>\n\n<pre><code>int number = 19 ;\n</code></pre>\n\n<p>to </p>\n\n<pre><code>int number = 0 ;\n</code></pre>\n\n<p>then:</p>\n\n<pre><code>number++;\n</code></pre>\n\n<p>to </p>\n\n<pre><code>number += 20 ;\n</code></pre>\n\n<p>is an obvious improvement that will have a significant impact even if it is still a somewhat naive brute force approach.</p>\n\n<p>At onlinegdb.com your algorithm took 102 seconds to run whereas this change runs in less that one second and produces the same answer.</p>\n\n<p>The initial product of primes value suggested in a comment will provide a further improvement.</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 11509920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97441246ea59146d063ea5680af9cdba?s=128&d=identicon&r=PG&f=1", "display_name": "BishamonX", "link": "https://stackoverflow.com/users/11509920/bishamonx"}, "edited": false, "score": 0, "creation_date": 1558610443, "post_id": 56266027, "comment_id": 99162732, "body": "I am too new to C to understand this kind of format but thank you, since it gave me a point to start from in order to improve my knowledge."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 2, "last_activity_date": 1558566013, "creation_date": 1558566013, "answer_id": 56266027, "question_id": 56265466, "link": "https://stackoverflow.com/questions/56265466/find-the-least-common-multiple-of-multiple-numbers/56266027#56266027", "title": "Find the least common multiple of multiple numbers", "body": "<pre><code>#include &lt;stdio.h&gt;\n\n\n/*  GCD returns the greatest common divisor of a and b (which must be non-zero).\n\n    This algorithm comes from Euclid, Elements, circa 300 BCE, book (chapter)\n    VII, propositions 1 and 2.\n*/\nstatic unsigned GCD(unsigned a, unsigned b)\n{\n    while (0 &lt; b)\n    {\n        unsigned c = a % b;\n        a = b;\n        b = c;\n    }\n\n    return a;\n}\n\n\nint main(void)\n{\n    static const unsigned Limit = 20;\n\n    unsigned LCM = 1;\n\n    /*  Update LCM to the least common multiple of the LCM so far and the next\n        i.  The least common multiple is obtained by multiplying the numbers\n        and removing the duplicated common factors by dividing by the GCD.\n    */\n    for (unsigned i = 1; i &lt;= Limit; ++i)\n        LCM *= i / GCD(LCM, i);\n\n    printf(\"The least common multiple of numbers from 1 to %u is %u.\\n\",\n        Limit, LCM);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1558571589, "post_id": 56266348, "comment_id": 99149287, "body": "You have to do a bit more than just multiply by each prime.  For example, 8 is a power of 2, but you need 2 * 2 * 2 if the LCM is to include 8 as a factor.  Also, you run into precision problems with your 64-bit unsigned numbers after N = 46."}, {"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1558571832, "post_id": 56266348, "comment_id": 99149322, "body": "@JonathanLeffler powers of primes is covered in the while loop... precision on ints though?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1558572009, "post_id": 56266348, "comment_id": 99149346, "body": "OK; I&#39;ll check it out in due course \u2014 I&#39;m checking another answer at the moment.  My version of this code from some years ago \u2014 available in my <a href=\"https://github.com/jleffler/soq\" rel=\"nofollow noreferrer\">SOQ</a> (Stack Overflow Questions) repository on GitHub as file <code>lcm20.c</code> in the <a href=\"https://github.com/jleffler/soq/tree/master/src/miscellany\" rel=\"nofollow noreferrer\">src/miscellany</a> sub-directory \u2014 finds that the LCM for the numbers up to 46 is 9419588158802421600 (and the same value is the LCM for 44 and 45).  After that, my 64-bit numbers run out of bits."}, {"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1558574297, "post_id": 56266348, "comment_id": 99149740, "body": "@JonathanLeffler I checked and get overflow starting at 47."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1558574342, "post_id": 56266348, "comment_id": 99149749, "body": "That\u2019s what I got too."}], "tags": [], "owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "is_accepted": false, "score": 1, "last_activity_date": 1558667633, "last_edit_date": 1558667633, "creation_date": 1558568785, "answer_id": 56266348, "question_id": 56265466, "link": "https://stackoverflow.com/questions/56265466/find-the-least-common-multiple-of-multiple-numbers/56266348#56266348", "title": "Find the least common multiple of multiple numbers", "body": "<p>You need to multiply all the least common multiples together, but omit numbers that could be multiplied to get any of the others.  This translates to multiply by all primes less than N with each prime number raised to the highest power &lt;= N.</p>\n\n<pre><code>const unsigned primes[] = {\n    2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47\n};\n\nunsigned long long answer(unsigned n){ //for your example n=20\n    if (n&gt;46) return 0;  //will overflow 64 bit unsigned long long\n    unsigned long long tmp, ret = 1;\n    for (unsigned i = 0; primes[i]&lt;=n;++i){ //each prime less than n\n        tmp = primes[i];\n        while ((tmp*primes[i])&lt;=n) //highest power less than n\n            tmp *= primes[i];\n        ret *= tmp;\n    }\n    return ret;\n}\n</code></pre>\n\n<p>usage: <code>printf(\"%llu\", answer(20));</code></p>\n\n<p>If my math/code is right this should be fast and cover numbers up to 46.  If your compiler supports unsigned __int128 it can be modified to go up to 88.</p>\n\n<p>Explanation:\nTLDR version: all numbers are either prime or can be made by multiplying primes.</p>\n\n<blockquote>\n  <p>To get the least common multiple of a set of numbers you break each\n  number into it's prime multiples and multiply the highest number of\n  each prime together.</p>\n  \n  <p>Primes less than 20:\n  2,3,5,7,11,13,17,19</p>\n  \n  <p>Non primes under 20: \n  4 = 2*2\n   6 = 2*3\n   8 = 2*2*2\n   9 = 3*3\n   10 = 2*5\n   12 = 2*2*3\n   14 = 2*2*7\n   15 = 3*5\n   16 = 2*2*2*2\n   18 = 2*3*3\n   20 = 2*2*5</p>\n  \n  <p>From this we see that the maximum number of 2s is 4 and the maximum\n  number of 3s is 2.</p>\n  \n  <p>2 to the 4th &lt;= 20\n  3 squared &lt;= 20\n  All powers >1 of the remaining\n  primes are greater than 20.</p>\n  \n  <p>Therefore you get:</p>\n  \n  <p>2*2*2*2*3*3*5*7*11*13*17*19</p>\n  \n  <p>Which is what you would see if you watched the tmp variable in a\n  debugger.</p>\n  \n  <p>Another reason this is faster is that it avoids modulus and division\n  (It's expensive on a lot of systems)</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 0, "creation_date": 1558665369, "post_id": 56279451, "comment_id": 99183811, "body": "This problem overflows 32 bit int at N=23, 64 bit at N=47 and 128 bit at around N=88.  Storing the primes up to 91 takes less than 32 bytes while the code to calculate them will be significantly larger and slower than a lookup that fits in a cache line.  If you start going into BigNum territory then checking primes incrementally starts to make sense, but the calculated results will be HUGE."}, {"owner": {"reputation": 3305, "user_id": 1428695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a843c704cdb7e32a93769cddfed4747?s=128&d=identicon&r=PG", "display_name": "yhyrcanus", "link": "https://stackoverflow.com/users/1428695/yhyrcanus"}, "reply_to_user": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 0, "creation_date": 1558711532, "post_id": 56279451, "comment_id": 99203522, "body": "Very true. But if you&#39;re mapping the primes, I&#39;d argue that you may as well just map out the powers then. It&#39;ll be a little more code and a const array (2d array maybe), but then it&#39;s just pulling and multiplying the final answer."}], "tags": [], "owner": {"reputation": 3305, "user_id": 1428695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a843c704cdb7e32a93769cddfed4747?s=128&d=identicon&r=PG", "display_name": "yhyrcanus", "link": "https://stackoverflow.com/users/1428695/yhyrcanus"}, "is_accepted": false, "score": 0, "last_activity_date": 1558628737, "creation_date": 1558628737, "answer_id": 56279451, "question_id": 56265466, "link": "https://stackoverflow.com/questions/56265466/find-the-least-common-multiple-of-multiple-numbers/56279451#56279451", "title": "Find the least common multiple of multiple numbers", "body": "<p>Here's a way to do it without defining primes or divisions (except for a single sqrt), using a <a href=\"https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes\" rel=\"nofollow noreferrer\">Sieve of Eratosthenes</a> (circa 200 BCE).</p>\n\n<p>I mark composites with 1, and primes^x with -1. Then i just loop over the array of numbers from sqrt(n) to n and pull out the remaining primes and max power primes.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\n#define n 20\n\nint main()\n{\n    int prime [100]={0};\n    int rootN = sqrt(n);\n    unsigned long long inc,oldInc;\n    int i;\n    for (i=2; i&lt;rootN; i++)\n    {\n        if (prime[i] == 1) continue;\n        //Classic Sieve\n        inc = i*i;\n        while (inc &lt; n)\n        {\n         prime[inc] = 1;\n         inc += i;\n        }\n        //Max power of prime\n        oldInc = i;\n        inc = i * i;\n        while (inc &lt; n)\n        {\n         prime[inc] = 1;\n         oldInc=inc;\n         inc *= i;\n        }\n        prime[oldInc] = -1;\n        prime[i] = 1;\n\n    }\n    inc = 1;\n    for(i=rootN; i&lt;n; i++)\n    {\n        if (prime[i] == 0 || prime[i] == -1)\n        {\n            inc = inc * i;\n        }\n    }\n\n    printf(\"%llu\",inc);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11509920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97441246ea59146d063ea5680af9cdba?s=128&d=identicon&r=PG&f=1", "display_name": "BishamonX", "link": "https://stackoverflow.com/users/11509920/bishamonx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 56265747, "answer_count": 4, "score": 0, "last_activity_date": 1558667633, "creation_date": 1558561666, "last_edit_date": 1558610962, "question_id": 56265466, "link": "https://stackoverflow.com/questions/56265466/find-the-least-common-multiple-of-multiple-numbers", "title": "Find the least common multiple of multiple numbers", "body": "<p>The goal of this program is to find the smallest number that can be divided by the numbers 1 to 20 without any remainders. The code is working but it takes 33 seconds. Can I improve it so that it can be faster? How?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n  int number = 19, i, k;\n\n  label:\n  number++;\n  k = 0;\n  for (i = 1; i &lt;= 20; i++){\n    if (number%i == 0){\n      k++;\n    }\n  }\n\n  if (k != 20){\n    goto label;\n  }\n\n  printf(\"%d\\n\", number);\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "cs50", "caesar-cipher"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1558560267, "post_id": 56265161, "comment_id": 99146759, "body": "Your while loop doesn&#39;t increment <code>i</code> \u2014 you probably should remove the loop control altogether (but keep the <code>if</code> that is its body).  The <code>int k = atoi(s);</code> and following two lines should be outside the <code>for</code> loop.  It is more conventional to use either <code>if (isdigit(s[i]))</code> or <code>if (!isdigit(s[i]))</code>, if only because <code>isdigit()</code> is only guaranteed to return 0 or non-0 so testing for true would be a bad idea (and you don&#39;t do it in this code)."}, {"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "edited": false, "score": 1, "creation_date": 1558560274, "post_id": 56265161, "comment_id": 99146761, "body": "The inner while loop is an infinite loop in the case <code>s[i]</code> is a digit."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 4, "creation_date": 1558560285, "post_id": 56265161, "comment_id": 99146763, "body": "Why do you have two loops?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1558560550, "post_id": 56265161, "comment_id": 99146857, "body": "You can simply declare <code>int i = 0;</code>, remove the <code>for</code> loop completely, and just loop <code>while (s[i] != &#39;\\0&#39;) { if (isdigit (s[i]) == false) { printf(&quot; Not a digit\\n&quot;); return 1; } i++; }</code>. At the end of your code you would generally want <code>return 0;</code> as an indication of success instead of <code>return 1;</code>. Nit, you can simply use <code>puts (&quot;Success&quot;);</code> as there are no conversions for <code>printf</code> to handle. (a good compiler will optimize this for you). As you go forward, use <code>strtol</code> instead of <code>atoi</code> as <code>atoi</code> provides zero error checking for you to validate the conversion."}], "answers": [{"tags": [], "owner": {"reputation": 1053, "user_id": 7885081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZvVb.png?s=128&g=1", "display_name": "Jose Fernando Lopez Fernandez", "link": "https://stackoverflow.com/users/7885081/jose-fernando-lopez-fernandez"}, "is_accepted": false, "score": 0, "last_activity_date": 1558580900, "creation_date": 1558580900, "answer_id": 56267565, "question_id": 56265161, "link": "https://stackoverflow.com/questions/56265161/how-to-check-every-single-character-of-a-command-line-argument-caesar-pset2/56267565#56267565", "title": "How to check every single character of a command line argument? Caesar PSET2", "body": "<p>You don't need two for loops for this problem. Either loop will work on its own, and the difference is going to be in the stop condition. I'm going to use a <code>for</code> loop in this example, but an analogous implementation using a <code>while</code> loop would simply check for the next character being the nul terminator.</p>\n\n<pre><code>enum bool_t {\n    FALSE,\n    TRUE\n};\n\nint main(int argc, char *argv[])\n{\n    if (argc == 1) {\n        fprintf(stderr, \"No input(s).\\n\");\n\n        return EXIT_FAILURE;\n    }\n\n    while (*++argv) {\n        int found_invalid_character = FALSE;\n\n        for (size_t i = 0; i &lt; strlen(*argv); ++i) {\n            if (!isdigit((*argv)[i])) {\n                found_invalid_character = TRUE;\n                break;\n            }\n        }\n\n        if (found_invalid_character) {\n            printf(\"%s is not a valid integer.\\n\", *argv);\n            continue;\n        }\n\n        int n = atoi(*argv);\n        printf(\"%d is a valid integer.\\n\", n);\n    }\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>x20 is not a valid integer.\n20x is not a valid integer.\n20 is a valid integer.\n</code></pre>\n\n<p>Remember that <code>argv</code> is an array of pointers to null-terminated arrays of characters, so you're always going to be able to iterate over a \"string\" by checking whether you've hit a nul terminator. You could reimplement the functions in <code>string.h</code> from scratch if you wanted to by using that for pretty much everything. Here is the <code>strlen</code> function for example.</p>\n\n<pre><code>size_t my_strlen(const char* s) {\n    size_t len = 0;\n\n    while (*s++)\n        ++len;\n\n    return len;\n}\n</code></pre>\n\n<p>Everytime the <code>while</code> condition is evaluated, the <code>s</code> pointer is increased and dereferenced. Every value of <code>*s</code> is going to be some ASCII value, and therefore non-zero, until the nul terminator is found, at which point the <code>++len</code> statement will not be executed. This is why <code>strlen</code> conventionally returns the length of the string <em>minus the nul terminator</em>.</p>\n\n<p>So basically the <code>for</code> loop I used in my example for your program which depended on the string length of the input indirectly depended on finding the nul terminator of the input string. This is why you could just as well use a <code>while</code> loop while checking for a nul terminator.</p>\n\n<hr />\n\n<p>As an aside, I did notice that you return 1 at the end of both your success and fail branches, which I was a little puzzled by. Returning 1 conventionally indicates an error, and in fact <code>stdlib.h</code> defines the <code>EXIT_FAILURE</code> macro as 1. I do use those macros myself, although if you notice I defined <code>TRUE</code> and <code>FALSE</code> using an enum, which makes them lexically visible to the program as both \"FALSE\" and \"TRUE\" as well as 0 and 1, which are their respective values, rather than simply being text-replaced to 0 and 1 by the preprocessor.</p>\n\n<p>Also, you didn't include your headers or previous definitions, but I'm guessing you're on Windows, because <code>false</code> isn't a valid value in C without being manually defined, whereas Visual Studio, being a C++ compiler, does allow it. I bring this up because I was confused by the line <code>string s = argv[1]</code>. This could mean that you're on a C++ compiler and used the infamous <code>using namespace std;</code>, or you typedef'd: <code>typedef const char* string</code>. I don't like either option personally, but to each his own.</p>\n\n<p>Anyways, I hope this helps, good luck.</p>\n"}], "owner": {"reputation": 1, "user_id": 11541738, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7dBIw7Fe3vE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXR_3b2nj5TeQ90TT9_SHn-bFdfw/mo/photo.jpg?sz=128", "display_name": "David ", "link": "https://stackoverflow.com/users/11541738/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 311, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558580900, "creation_date": 1558559974, "last_edit_date": 1558560100, "question_id": 56265161, "link": "https://stackoverflow.com/questions/56265161/how-to-check-every-single-character-of-a-command-line-argument-caesar-pset2", "title": "How to check every single character of a command line argument? Caesar PSET2", "body": "<p>I need to check if inside the command line argument there is a non digit character. For example: ./problem 20x should print out \"Not a digit\" since it contains an x. My code doesn't seem to loop through all the characters in the command line argument. </p>\n\n<p>I've basically tried different kinds of loops but don't seem to be working. </p>\n\n<pre><code>string s = argv[1];\n\nfor (int i = 0, n = strlen(s); i &lt; n; i++)\n{\n    while (s[i] != '\\0')\n    {\n        if (isdigit (s[i]) == false)\n        {\n            printf(\" Not a digit\\n\");\n            return 1; \n        }\n    }\n    int k = atoi(s);\n    printf(\"Success\\n\");\n    return 1;\n    }\n}\n</code></pre>\n\n<p>I expect the output of \"20x\" to print out \"Not a digit\". Also the output of \"x20\" should be \"Not a Digit\"</p>\n"}, {"tags": ["c", "global-variables", "alsa", "libasound"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1558559662, "post_id": 56265081, "comment_id": 99146559, "body": "Which global variables are you having trouble with?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1558559782, "post_id": 56265081, "comment_id": 99146606, "body": "You need to use <code>extern &lt;type&gt; &lt;variablename&gt;;</code> in the header file so that the application using the library will link to the variable in the library."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1558560944, "post_id": 56265081, "comment_id": 99146977, "body": "You do need to declare the variables <code>extern</code> in the header, else you are declaring a separate variable in each source that includes the header, which produces undefined behavior.  You should also ensure that exactly one source in your library either declares those same variables <i>without</i> <code>extern</code>, or declares them with initializers, or both.  That&#39;s what will cause them to actually be part of the library, instead of being an external dependency."}], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 10455471, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZKj6S6Llntc/AAAAAAAAAAI/AAAAAAAAAAs/TYblQ0VRhmc/photo.jpg?sz=128", "display_name": "Ella Jameson", "link": "https://stackoverflow.com/users/10455471/ella-jameson"}, "is_accepted": false, "score": 1, "last_activity_date": 1558566968, "creation_date": 1558566968, "answer_id": 56266149, "question_id": 56265081, "link": "https://stackoverflow.com/questions/56265081/c-why-wont-the-global-variables-in-my-library-update-using-alsa-lib/56266149#56266149", "title": "C: Why won&#39;t the global variables in my library update? (Using ALSA Lib)", "body": "<p>Okay, so it turns out to NOT be an issue with globals at all... sorry all! It's some weird invalid argument being passed to <code>snd_pcm_hw_params_get_period_size()</code>, specifically. The code actually works with a manually defined number of loops, so I am closing this question.</p>\n"}], "owner": {"reputation": 73, "user_id": 10455471, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZKj6S6Llntc/AAAAAAAAAAI/AAAAAAAAAAs/TYblQ0VRhmc/photo.jpg?sz=128", "display_name": "Ella Jameson", "link": "https://stackoverflow.com/users/10455471/ella-jameson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558566968, "creation_date": 1558559491, "last_edit_date": 1558562808, "question_id": 56265081, "link": "https://stackoverflow.com/questions/56265081/c-why-wont-the-global-variables-in-my-library-update-using-alsa-lib", "title": "C: Why won&#39;t the global variables in my library update? (Using ALSA Lib)", "body": "<p><strong>Preface:</strong> I have looked at the other answers, and I believe this is a different type of issue. It's probably pointer related, but none of the other answers helped. I also may just be missing something.</p>\n\n<p>I managed to make a working program which streams raw audio data to stdout, using the ALSA library. I am now trying to generalize this code into a library, and the global variables in the .c file of the library are not updating. As far as I can tell, the setup is no different than the original program, so I think it should work... but it doesn't. I'd really appreciate someone explaining exactly how I'm messing this up. Thank you pre-emptively!</p>\n\n<p><strong>EDIT 1:</strong> </p>\n\n<p>All global variables at the top of <code>wm8782.c</code> fail to set when <code>wm8782_open_audio()</code> is called. For example, when <code>snd_pcm_hw_params_get_period_time(params, &amp;val, &amp;dir);</code> is called in <code>wm8782_us_to_loops()</code> after <code>wm8782_open_audio()</code> has been called, it fails because <code>params</code> was not initialized. However, <code>wm8782_open_audio()</code> completes without error!</p>\n\n<p><strong>EDIT 2:</strong></p>\n\n<p>I have added <code>extern</code> declarations in my header, no dice. See below for the updated files.</p>\n\n<p><strong>EDIT 3:</strong></p>\n\n<p>I have reproduced the problem in a single C file with no header. Simply breaking out the code into functions is enough to break it. I have replaced the 2 library files with this monolithic C file, so as to eliminate linker errors and the like.</p>\n\n<p>Here is the original program I am trying to generalize into a library. This does work as I want it to.</p>\n\n<pre><code>#define ALSA_PCM_NEW_HW_PARAMS_API\n#include &lt;alsa/asoundlib.h&gt;\n\nlong loops;\nint rc;\nint size;\nsnd_pcm_t *handle;\nsnd_pcm_hw_params_t *params;\nunsigned int val;\nint dir;\nsnd_pcm_uframes_t frames;\nchar *buffer;\n\nint main()\n{\n    /* Open PCM device for recording (capture). */\n    rc = snd_pcm_open(&amp;handle, \"hw:1\",\n                      SND_PCM_STREAM_CAPTURE, 0);\n    if (rc &lt; 0)\n    {\n        fprintf(stderr,\n                \"unable to open pcm device: %s\\n\",\n                snd_strerror(rc));\n        exit(1);\n    }\n\n    /* Allocate a hardware parameters object. */\n    snd_pcm_hw_params_alloca(&amp;params);\n\n    /* Fill it in with default values. */\n    snd_pcm_hw_params_any(handle, params);\n\n    /* Set the desired hardware parameters. */\n\n    /* Interleaved mode */\n    snd_pcm_hw_params_set_access(handle, params,\n                                 SND_PCM_ACCESS_RW_INTERLEAVED);\n\n    /* Signed 32-bit little-endian format */\n    snd_pcm_hw_params_set_format(handle, params,\n                                 SND_PCM_FORMAT_S32_LE);\n\n    /* Two channels (stereo) */\n    snd_pcm_hw_params_set_channels(handle, params, 2);\n\n    /* 44100 bits/second sampling rate (CD quality) */\n    val = 44100;\n    snd_pcm_hw_params_set_rate_near(handle, params,\n                                    &amp;val, &amp;dir);\n\n    /* Set period size to 64 frames. */\n    frames = 64;\n    snd_pcm_hw_params_set_period_size_near(handle,\n                                           params, &amp;frames, &amp;dir);\n\n    /* Write the parameters to the driver */\n    rc = snd_pcm_hw_params(handle, params);\n    if (rc &lt; 0)\n    {\n        fprintf(stderr,\n                \"unable to set hw parameters: %s\\n\",\n                snd_strerror(rc));\n        exit(1);\n    }\n\n    /* Use a buffer large enough to hold one period */\n    snd_pcm_hw_params_get_period_size(params,\n                                      &amp;frames, &amp;dir);\n    size = frames * 8; /* 4 bytes/sample, 2 channels */\n    buffer = (char *) malloc(size);\n\n    /* We want to loop for 5 seconds */\n    snd_pcm_hw_params_get_period_time(params,\n                                      &amp;val, &amp;dir);\n    //fprintf(stderr, \"%u\\n\", val);\n    loops = 5000000 / val;\n\n    while (loops &gt; 0)\n    {\n        loops--;\n        rc = snd_pcm_readi(handle, buffer, frames);\n        if (rc == -EPIPE)\n        {\n            /* EPIPE means overrun */\n            fprintf(stderr, \"overrun occurred\\n\");\n            snd_pcm_prepare(handle);\n        }\n        else if (rc &lt; 0)\n        {\n            fprintf(stderr,\n                    \"error from read: %s\\n\",\n                    snd_strerror(rc));\n        }\n        else if (rc != (int)frames)\n        {\n            fprintf(stderr, \"short read, read %d frames\\n\", rc);\n        }\n        rc = write(1, buffer, size);\n        if (rc != size)\n            fprintf(stderr,\n                    \"short write: wrote %d bytes\\n\", rc);\n    }\n\n    snd_pcm_drain(handle);\n    snd_pcm_close(handle);\n    free(buffer);\n\n    return 0;\n}\n</code></pre>\n\n<p>Now here is the modular version that will eventually be a library. This fails with <code>ERROR: Failed to get number of loops.</code>:</p>\n\n<pre><code>#define ALSA_PCM_NEW_HW_PARAMS_API\n\n#include &lt;stdbool.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;alsa/asoundlib.h&gt;\n\nchar *wm8782_buffer;\nint wm8782_buffer_size;\n\nsnd_pcm_t *wm8782_handle;\nsnd_pcm_hw_params_t *wm8782_params;\nint wm8782_dir;\nsnd_pcm_uframes_t wm8782_frames;\nunsigned int wm8782_val;\nint wm8782_rc;\n\ntypedef enum\n{\n    WM8782_READ_OVERRUN,\n    WM8782_READ_ERROR,\n    WM8782_READ_SHORT,\n    WM8782_READ_GOOD,\n} wm8782read_t;\n\ntypedef enum\n{\n    WM8782_RATE_8K = 8000,\n    WM8782_RATE_16K = 16000,\n    WM8782_RATE_32K = 32000,\n    WM8782_RATE_44_1K = 44100,\n    WM8782_RATE_48K = 48000,\n    WM8782_RATE_96K = 96000,\n    WM8782_RATE_192K = 192000,\n} wm8782rate_t;\n\nbool wm8782_open_audio(wm8782rate_t rate_in, snd_pcm_uframes_t wm8782_frames_in)\n{\n    // Open PCM device for recording (capture).\n    wm8782_rc = snd_pcm_open(&amp;wm8782_handle, \"hw:1\",\n                      SND_PCM_STREAM_CAPTURE, 0);\n    if (wm8782_rc &lt; 0)\n    {\n        fprintf(stderr,\n                \"ERROR: Unable to open pcm device: %s\\n\",\n                snd_strerror(wm8782_rc));\n        return false;\n    }\n\n    // Allocate a hardware parameters object.\n    snd_pcm_hw_params_alloca(&amp;wm8782_params);\n\n    // Fill it in with default values\n    snd_pcm_hw_params_any(wm8782_handle, wm8782_params);\n\n    // Set the desired hardware parameters. */\n\n    // Interleaved mode\n    snd_pcm_hw_params_set_access(wm8782_handle, wm8782_params, SND_PCM_ACCESS_RW_INTERLEAVED);\n\n    // Signed 32-bit little-endian format\n    snd_pcm_hw_params_set_format(wm8782_handle, wm8782_params, SND_PCM_FORMAT_S32_LE);\n\n    // Two channels (stereo)\n    snd_pcm_hw_params_set_channels(wm8782_handle, wm8782_params, 2);\n\n    // Set rate\n    wm8782_val = rate_in;\n    snd_pcm_hw_params_set_rate_near(wm8782_handle, wm8782_params, &amp;wm8782_val, &amp;wm8782_dir);\n\n    // Set period size.\n    wm8782_frames = wm8782_frames_in;\n    snd_pcm_hw_params_set_period_size_near(wm8782_handle, wm8782_params, &amp;wm8782_frames, &amp;wm8782_dir);\n\n    // Write the parameters to the driver\n    wm8782_rc = snd_pcm_hw_params(wm8782_handle, wm8782_params);\n    if (wm8782_rc &lt; 0)\n    {\n        fprintf(stderr,\n                \"ERROR: Unable to set hw parameters: %s\\n\",\n                snd_strerror(wm8782_rc));\n        return false;\n    }\n\n    // Use a buffer large enough to hold one period\n    snd_pcm_hw_params_get_period_size(wm8782_params, &amp;wm8782_frames, &amp;wm8782_dir);\n    wm8782_buffer_size = wm8782_frames * 8; // 4 bytes/sample, 2 channels\n    wm8782_buffer = (char *) malloc(wm8782_buffer_size);\n\n    return true;\n}\n\nvoid wm8782_close_audio()\n{\n    snd_pcm_drain(wm8782_handle);\n    snd_pcm_close(wm8782_handle);\n    free(wm8782_buffer);\n}\n\nwm8782read_t wm8782_read_audio()\n{\n    wm8782_rc = snd_pcm_readi(wm8782_handle, wm8782_buffer, wm8782_frames);\n    if (wm8782_rc == -EPIPE)\n    {\n        // EPIPE means overrun\n        fprintf(stderr, \"ERROR: Overrun occurred\\n\");\n        snd_pcm_prepare(wm8782_handle);\n        return WM8782_READ_OVERRUN;\n    }\n    else if (wm8782_rc &lt; 0)\n    {\n        fprintf(stderr, \"ERROR: From read: %s\\n\", snd_strerror(wm8782_rc));\n        return WM8782_READ_ERROR;\n    }\n    else if (wm8782_rc != (int)wm8782_frames)\n    {\n        fprintf(stderr, \"ERROR: Short read, read %d wm8782_frames\\n\", wm8782_rc);\n        return WM8782_READ_SHORT;\n    }\n\n    return WM8782_READ_GOOD;\n}\n\nunsigned int wm8782_us_to_loops(unsigned int us_in)\n{\n    if(snd_pcm_hw_params_get_period_time(wm8782_params, &amp;wm8782_val, &amp;wm8782_dir) &lt; 0)\n    {\n        fprintf(stderr, \"ERROR: Failed to get number of loops.\\n\");\n        return 0;\n    }\n    //fprintf(stderr, \"%u\\n\", wm8782_val);\n    return (us_in / wm8782_val);\n}\n\nint main()\n{\n    if(!wm8782_open_audio(44100, 64))\n    {\n        fprintf(stderr, \"unable to open pcm device\");\n    }\n\n    unsigned int loops =  wm8782_us_to_loops(5000000);\n\n    while (loops &gt; 0)\n    {\n        loops--;\n        wm8782_read_audio();\n\n        wm8782_rc = write(1, wm8782_buffer, wm8782_buffer_size);\n        if (wm8782_rc != wm8782_buffer_size)\n            fprintf(stderr,\n                    \"short write: wrote %d bytes\\n\", wm8782_rc);\n    }\n\n    wm8782_close_audio();\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "pipe"], "comments": [{"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1558563552, "post_id": 56264746, "comment_id": 99147695, "body": "The typical idiom is: <code>close(pin[1]); dup2(pin[0], STDIN_FILENO); close(pin[0])</code>.  You are leaving <code>pin[0]</code> and <code>pout[1]</code> open in the child.  Do a count: when you call execlp you should only have 3 open file descriptors.  The process started with 3.  You called pipe twice, bringing the total up to 7.  You should therefore call <code>close</code> 4 times before you call <code>exec</code>.  (You can think of the implicit close that occurs from dup2 as one, but if you do you need to increment the total).  Basically, for each call to <code>pipe</code>, you should call <code>close</code> twice."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1558569241, "post_id": 56264746, "comment_id": 99148854, "body": "You current code blocks when you reach about 128 KiB of data.  You&#39;ve just demonstrated why you don&#39;t normally create loops with sets of pipes.  You can achieve concurrency by having a third process read the output from <code>cat</code>, or by having multiple threads with one handling the writing to <code>cat</code> and the other reading from <code>cat</code>.  I believe you could also use <code>select()</code> or <code>poll()</code> (or, on Linux, <code>epoll()</code>) on the pipe descriptors.  Or you can do what is suggested in <a href=\"https://stackoverflow.com/users/412080/maxim-egorushkin\">Maxim</a>&#39;s <a href=\"https://stackoverflow.com/a/56264891/15168\">answer</a>."}, {"owner": {"reputation": 46, "user_id": 7738002, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Pox9yPDFX18/AAAAAAAAAAI/AAAAAAAAGQ8/2mgquTqU5sk/photo.jpg?sz=128", "display_name": "Source", "link": "https://stackoverflow.com/users/7738002/source"}, "edited": false, "score": 0, "creation_date": 1558602050, "post_id": 56264746, "comment_id": 99158157, "body": "Ahh..., concurrency, that&#39;s a good suggestion, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 46, "user_id": 7738002, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Pox9yPDFX18/AAAAAAAAAAI/AAAAAAAAGQ8/2mgquTqU5sk/photo.jpg?sz=128", "display_name": "Source", "link": "https://stackoverflow.com/users/7738002/source"}, "edited": false, "score": 0, "creation_date": 1558602103, "post_id": 56264891, "comment_id": 99158189, "body": "So stupid, should have considered non-blocking IO. Thank you!"}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1558559185, "last_edit_date": 1558559185, "creation_date": 1558558538, "answer_id": 56264891, "question_id": 56264746, "link": "https://stackoverflow.com/questions/56264746/need-suggestion-while-handle-huge-pipe-data/56264891#56264891", "title": "Need Suggestion while handle huge pipe data", "body": "<p>The first process pipes into <code>cat</code> and <code>cat</code> pipes back into the first process. Hence, for <code>cat</code> to not block on piping back, the first process must also drain that pipe. E.g.:</p>\n\n<pre><code>fcntl(pout[0], F_SETFL, fcntl(pout[0], F_GETFL) | O_NONBLOCK);\nwhile((nread=read(fd, buff, CHUNK)) &gt; 0) {\n    write(pin[1], buff, nread); // TODO: check errors and partial writes here.\n    while((nread=read(pout[0],buff,CHUNK)) &gt; 0) // pout[0] must be set into non-blocking mode.\n        write(STDOUT_FILENO, buff, nread);\n}\n</code></pre>\n\n<p>A more robust way is to set both <code>pin[1]</code> and <code>pout[0]</code> into non-blocking mode, use <code>select</code> to determine whether <code>pin[1]</code> is ready for write and <code>pout[0]</code> for read and then do write/read correspondingly and handle partial reads and writes.</p>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 7738002, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Pox9yPDFX18/AAAAAAAAAAI/AAAAAAAAGQ8/2mgquTqU5sk/photo.jpg?sz=128", "display_name": "Source", "link": "https://stackoverflow.com/users/7738002/source"}, "is_accepted": false, "score": 0, "last_activity_date": 1558602706, "creation_date": 1558602706, "answer_id": 56271809, "question_id": 56264746, "link": "https://stackoverflow.com/questions/56264746/need-suggestion-while-handle-huge-pipe-data/56271809#56271809", "title": "Need Suggestion while handle huge pipe data", "body": "<p>From your suggestions at least I have 2 ways to solve this problem \n1. Setting 'NON-BLOCK' mode by 'fcntl' or 'select/poll/epoll' </p>\n\n<ol start=\"2\">\n<li>Use concurrency such as 'pthread' for stdin pipe \npiece of code attached. </li>\n</ol>\n\n<pre><code>        struct data {\n             int from_fd;\n             int to_fd;\n        };\n</code></pre>\n\n<p>and code for pipes should look like</p>\n\n<pre><code>\n        pthread_t t;\n        struct data d;\n        d.from_fd=fd;\n        d.to_fd=pin[1];\n        pthread_create(&amp;t,NULL,&amp;fd_to_pipe,(void*) &amp;d);\n\n        while ( (nread=read(pout[0],buff,CHUNK)) &gt;0) write(STDOUT_FILENO,buff,nread);\n\n        waitpid(pid,&amp;rc,0);\n        pthread_join(t,NULL);\n\n</code></pre>\n\n<p>Thank you ! </p>\n"}], "owner": {"reputation": 46, "user_id": 7738002, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Pox9yPDFX18/AAAAAAAAAAI/AAAAAAAAGQ8/2mgquTqU5sk/photo.jpg?sz=128", "display_name": "Source", "link": "https://stackoverflow.com/users/7738002/source"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 56264891, "answer_count": 2, "score": 0, "last_activity_date": 1558602706, "creation_date": 1558557857, "question_id": 56264746, "link": "https://stackoverflow.com/questions/56264746/need-suggestion-while-handle-huge-pipe-data", "title": "Need Suggestion while handle huge pipe data", "body": "<p>I'm practicing C code with pipe system call, it works well with small chunks of data. but as the data goes beyond the pipe capacity, dead lock occurs. </p>\n\n<p>My test system is Debian Sid, but i believe it share the common ground with other Linux distributions. This piece of code works well while the input file '/tmp/a.out' is small enough to fit within the pipe, but blocked as the file is up to 1M.</p>\n\n<pre><code>#include &lt;sys/errno.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;stdio.h&gt;\n\n#define CHUNK 2048\nint main() {\n    int fd=open(\"/tmp/a.out\",O_RDONLY);\n    int pin[2];\n    int pout[2];\n\n    int nread;\n    char buff[CHUNK];\n\n    pipe(pin);\n    pipe(pout);\n    int rc;\n    pid_t pid=fork();\n    if (pid == 0) {\n        close(pin[1]);\n        dup2(pin[0],STDIN_FILENO);\n        close(pout[0]);\n        dup2(pout[1],STDOUT_FILENO);\n\n        execlp(\"cat\",\"cat\",(char *)0);\n    } else if (pid &gt; 0) {\n        close(pin[0]);\n        close(pout[1]);\n\n/* I think dead lock occurs here, but i can't figure out a way to avoid it */ \n        while ( (nread=read(fd,buff,CHUNK)) &gt; 0) write(pin[1],buff,nread);\n        close(pin[1]);\n        while ( (nread=read(pout[0],buff,CHUNK)) &gt;0) write(STDOUT_FILENO,buff,nread);\n\n\n\n        waitpid(pid,&amp;rc,0);\n        exit(rc);\n\n    } else {\n        perror(\"fork\");\n        exit(errno);\n    }\n}\n</code></pre>\n\n<p>Any suggestions?   I know Python's subprocess class have something like subprocess.communicate() to avoid this kind of dead lock, but i don't know how to deal with it in C. </p>\n\n<p>Many thanks.</p>\n"}, {"tags": ["c", "macos", "apt"], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 11340862, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5p0wLvPdnfw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfazs5yxHL5EF2WRUA7hELIXrhYGg/mo/photo.jpg?sz=128", "display_name": "Max Bridgland", "link": "https://stackoverflow.com/users/11340862/max-bridgland"}, "is_accepted": false, "score": 0, "last_activity_date": 1558771252, "last_edit_date": 1558771252, "creation_date": 1558557919, "answer_id": 56264763, "question_id": 56264680, "link": "https://stackoverflow.com/questions/56264680/building-apt-on-macos-i-already-did-most-of-port-but-getting-error-use-of-und/56264763#56264763", "title": "Building APT on macOS (I already did most of port) but getting error &quot;use of undeclared identifier &#39;GetSrvRecords&#39;&quot;", "body": "<p>You are either: </p>\n\n<ol>\n<li>Not importing the header file that includes GetSrvRecords class.</li>\n<li>Not defining the GetSrvRecords class somewhere and then not importing it. </li>\n<li>Not importing it correctly.</li>\n<li>You never defined GetSrvRecords()</li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 11354304, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lur4LcTc5oE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reJFaavPIG1gUQNbbP-4G_S5RcIGA/mo/photo.jpg?sz=128", "display_name": "Diego Magdaleno", "link": "https://stackoverflow.com/users/11354304/diego-magdaleno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558771252, "creation_date": 1558557551, "question_id": 56264680, "link": "https://stackoverflow.com/questions/56264680/building-apt-on-macos-i-already-did-most-of-port-but-getting-error-use-of-und", "title": "Building APT on macOS (I already did most of port) but getting error &quot;use of undeclared identifier &#39;GetSrvRecords&#39;&quot;", "body": "<p>I am building APT for macOS, I already did most of patches and added some compatibility headers I ported from Linux to macOS all, but I have been encountering the problem at the \"15%\" of the make process telling me:</p>\n\n<pre><code>  use of undeclared identifier 'GetSrvRecords'\n</code></pre>\n\n<p>I have tried commenting that lines but it ends up in an error that is worse</p>\n\n<pre><code>static bool DoSrvLookup(CommandLine &amp;CmdL)              /*{{{*/\n{\n   if (CmdL.FileSize() &lt;= 1)\n      return _error-&gt;Error(\"Must specify at least one SRV record\");\n\n   for(size_t i = 1; CmdL.FileList[i] != NULL; ++i)\n   {\n      std::vector&lt;SrvRec&gt; srv_records;\n      std::string const name = CmdL.FileList[i];\n      c0out &lt;&lt; \"# Target\\tPriority\\tWeight\\tPort # for \" &lt;&lt; name &lt;&lt; std::endl;\n      size_t const found = name.find(\":\");\n      if (found != std::string::npos)\n      {\n     std::string const host = name.substr(0, found);\n     size_t const port = atoi(name.c_str() + found + 1);\n     if(GetSrvRecords(host, port, srv_records) == false)\n        _error-&gt;Error(_(\"GetSrvRec failed for %s\"), name.c_str());\n      }\n      else if(GetSrvRecords(name, srv_records) == false)\n     _error-&gt;Error(_(\"GetSrvRec failed for %s\"), name.c_str());\n\n      for (SrvRec const &amp;I : srv_records)\n     ioprintf(c1out, \"%s\\t%d\\t%d\\t%d\\n\", I.target.c_str(), I.priority, I.weight, I.port);\n   }\n   return true;\n}\n</code></pre>\n\n<p>It should make without showing that problem, at all.</p>\n"}, {"tags": ["c", "linux", "select", "termios"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1558557660, "post_id": 56264661, "comment_id": 99145729, "body": "unless polling has some mecanism to release the CPU tiem to other threads - thet&#39;s exactly what <code>poll()</code> call is for, to release the cpu for other processes (and threads). There are mostly two schools - <code>poll()</code> or <code>select()</code>. Except the horrible goto that jumps fron inside <code>for{if{if{</code> outside and some indentation subjective marks, this is good code. Would be good to set <code>fds[0].events = POLLERR|POLLHUP|POLLRDNORM</code> and also handle POLLERR. If you use <code>poll()</code>, you can just <code>set_blocking(, 1)</code>."}, {"owner": {"reputation": 43, "user_id": 7460209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f4c214e3f7e62fc60c2537a81c0d33?s=128&d=identicon&r=PG&f=1", "display_name": "Owayl", "link": "https://stackoverflow.com/users/7460209/owayl"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1558557900, "post_id": 56264661, "comment_id": 99145844, "body": "Oh nice, thank you, i didnt realized it, comming from bare metal embedded systems where polling is very cycle expensive (unless there is an RTOS). OK i will check on fds[0].events = POLLERR|POLLHUP|POLLRDNORM, handle POLLERR, and then properly deal with disconnect / reconnect."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1558558045, "post_id": 56264661, "comment_id": 99145907, "body": "You tagged <code>linux</code>, so <code>poll()</code> is probably implemented with GNU libc <code>glibc</code> and is forwarded to kenrel via <code>poll()</code> syscall. Then kernel set&#39;s your process to blocked state, so it is not executing, it&#39;s waiting for I/O. This code works, there is really no problem here, I&#39;m voting as off-topic for stackoverflow. It could be better suited for <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 43, "user_id": 7460209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f4c214e3f7e62fc60c2537a81c0d33?s=128&d=identicon&r=PG&f=1", "display_name": "Owayl", "link": "https://stackoverflow.com/users/7460209/owayl"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1558558216, "post_id": 56264661, "comment_id": 99145967, "body": "Yes indeed, it is implemented in GNU libc, thank you for the review !"}, {"owner": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "edited": false, "score": 0, "creation_date": 1558569390, "post_id": 56264661, "comment_id": 99148881, "body": "Sorry, but your 2nd version still has the same problems as the 1st (and maybe more!) and could only work by fluke."}], "answers": [{"tags": [], "owner": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "is_accepted": false, "score": 0, "last_activity_date": 1558570041, "last_edit_date": 1558570041, "creation_date": 1558564294, "answer_id": 56265818, "question_id": 56264661, "link": "https://stackoverflow.com/questions/56264661/what-is-the-proper-way-to-send-an-at-command-with-termios-and-get-the-reply/56265818#56265818", "title": "What is the proper way to send an AT command with termios and get the reply", "body": "<pre><code>connect:\n    fd = open(DEVICE, O_RDWR | O_NOCTTY | O_NONBLOCK);\n    if (fd == 0){\n        perror(DEVICE);\n</code></pre>\n\n<p>The <code>open(2)</code> doesn't return <code>0</code>, but <code>-1</code> in case of error. <code>0</code> is a valid file descriptor -- by convention the standard input.</p>\n\n<pre><code>        int count = write(fd, DATA, strlen(DATA));\n        ret = poll(fds, 1, 1000);\n        if (ret &gt; 0){\n</code></pre>\n\n<p>Why aren't you checking the return value of <code>write()</code>? If the <code>open()</code> above actually failed and returned <code>-1</code>, this <code>write()</code> will fail too, return <code>-1</code> and set <code>errno</code> to <code>EBADF</code>.</p>\n\n<pre><code>                res = read(fd,buf,255);\n                if(!res){close(fd); goto connect;}\n                buf[res-2]=0;\n</code></pre>\n\n<p>Ditto, you don't care if <code>read()</code> fails, which it will certainly do if the <code>open()</code> above failed to open the file. Just like <code>open()</code>, <code>write()</code> and all system calls, <code>read()</code> will return <code>-1</code> in case of error.</p>\n\n<p>Since your file descriptor is non-blocking, be prepared to handle transient errors like <code>EAGAIN</code> separately [2].</p>\n\n<p>In the case where <code>res == -1</code> the <code>buf[res-2]=0</code> will corrupt memory by writing before the start of <code>buf</code>.</p>\n\n<p>Notice that <code>poll()</code> will <strong>not</strong> set <code>POLLERR</code> in <code>revents</code> if passed an invalid fd -- if will either <em>ignore</em> it if it's negative (like the <code>fd</code> returned by your failing <code>open()</code>), or set <code>POLLNVAL</code> if it's positive.</p>\n\n<pre><code>            if (fds[0].revents &amp; POLLHUP){ printf(\"Hangup\\n\"); close(fd); goto connect;}\n            if (fds[0].revents &amp; POLLRDNORM){\n</code></pre>\n\n<p><code>POLLHUP</code> and <code>POLLRDNORM</code>[1]  can be returned together in <code>revents</code>, signaling the last possible read, which your code will miss.</p>\n\n<p>I strongly suggest you <code>strace(1)</code> your program, which you could do while it's running, with <code>strace -p PID</code>.</p>\n\n<p>[1] btw, <code>POLLRDNORM</code> is equivalent to <code>POLLIN</code> in Linux.</p>\n\n<p>[2] and <code>EINTR</code>, if your program or the libraries it's using are setting any signal handler.</p>\n"}], "owner": {"reputation": 43, "user_id": 7460209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f4c214e3f7e62fc60c2537a81c0d33?s=128&d=identicon&r=PG&f=1", "display_name": "Owayl", "link": "https://stackoverflow.com/users/7460209/owayl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558724430, "creation_date": 1558557487, "last_edit_date": 1558724430, "question_id": 56264661, "link": "https://stackoverflow.com/questions/56264661/what-is-the-proper-way-to-send-an-at-command-with-termios-and-get-the-reply", "title": "What is the proper way to send an AT command with termios and get the reply", "body": "<p>I am using Termios in an (ressource constrained) embedded Linux platform (in C) to send commands and receive data from various tty peripherals (CP2102 USB-UART). Apparently there are various ways to do that and many are improper. I tried few with mitigated success, I came across something that works but i am not sure it is optimal or even correct :</p>\n\n<pre><code>#define BAUDRATE    115200\n#define DEVICE      \"/dev/ttyUSB0\"\n#define DATA        \"BLK\\r\"\n\nint handler(void){\n\n    char buf[255];\n    struct pollfd fds[1];\n    int fd, ret, res, retry = 0;\n\nconnect:\n    fd = open(DEVICE, O_RDWR | O_NOCTTY | O_NONBLOCK);\n    if (fd == 0){\n        perror(DEVICE);\n        printf(\"Failed to open %s\\n\",DEVICE);\n        sleepms(2000);\n        if(retry++&lt;5) goto connect;\n        //exit(-1);\n    }\n    set_interface_attribs (fd, BAUDRATE, 0); // 8n1 no parity\n    set_blocking (fd, 0);                    // not blocking\n    fds[0].fd = fd;              // streams\n    fds[0].events = POLLRDNORM;\n    for (;;)\n    {\n        int count = write(fd, DATA, strlen(DATA));\n        ret = poll(fds, 1, 1000);\n        if (ret &gt; 0){\n            if (fds[0].revents &amp; POLLHUP){ printf(\"Hangup\\n\"); close(fd); goto connect;}\n            if (fds[0].revents &amp; POLLRDNORM){\n                res = read(fd,buf,255);\n                if(!res){close(fd); goto connect;}\n                buf[res-2]=0;\n                printf(\"Received %d bytes : %s\",res,buf);\n            }\n        }\n\n    }\n} \n</code></pre>\n\n<p>Basically the command is sent, then its polling until some data come or timeout occurs.\nThis worked for over 24h and shown no issue communication wise however there is one problem : if the peripheral is disconnected then i get the \"hangout\" notification but it never reconnects, i was expecting it would since i close the file and retry connection to interface.</p>\n\n<p>Also, is poll is the best approach here? i dont want to spend CPU time in pure lost by polling (unless polling has some mecanism to release the CPU time to other threads) but i still want the call to be blocking until the timeout occurs or response arrive (i.e. i dont want to send command and get the response later with a callback). The response come from peripheral under few millisecond.</p>\n\n<p>n.b. i know some eyes are bleeding because of the goto statement, no worries, goto has been used here to test quickly the \"reconnect\" approach (which didn't worked) but in the end if the connection has to be restarted it will be in a separate function, goto will never be used in the final implementation.</p>\n\n<p>EDIT:</p>\n\n<p>After rewrite. It works but there are still problems, mainly, when i disconnect the peripheral, Linux will randomly keep the port name or change it. Sometimes it will keep the port name for multiple consecutive disconnect, sometime it will rename it and stick with the new name for a while. So i have to find a way to identify the peripheral from USB and get current port name whatever it is.</p>\n\n<p>On disconnect it throws error 9 from tcgetattr (coming from set_interface_attribs or set_blocking i think) but once it is reconnected and if Linux does not change the port name then it reconnects right away and restart to send and receive as it should, however, when Linux rename the port then it fail.</p>\n\n<pre><code>int fd=-1,retry=0;\nstruct pollfd fds[1];\n\nint connect(void){\n\n    if(fd==-1) fd = open(MODEMDEVICE, O_RDWR | O_NOCTTY | O_NONBLOCK);\n    else return 0; // already opened\n    printf(\"Connecting to fd #%d\\n\",fd);\n    if (fd==0){\n        perror(MODEMDEVICE);\n        printf(\"Failed to open %s\\n\",MODEMDEVICE);\n        retry++;\n        sleepms(2000);\n        return -1;\n    }\n    set_interface_attribs (fd, BAUDRATE, 0);    // 8n1 no parity\n    set_blocking (fd, 0);                       // not blocking\n    fds[0].fd = fd;                             // streams\n    fds[0].events = POLLERR|POLLHUP|POLLRDNORM;\n    return 0;\n}\nint handlePoll(){\n\n    int ret=0,res=0;\n    char buf[255];\n\n    ret = poll(fds, 1, 1000); // 1000ms\n    if (ret &gt; 0){\n        if (fds[0].revents &amp; POLLERR){ close(fd); fd=-1; return -1; } // IO error\n        if (fds[0].revents &amp; POLLHUP){ close(fd); fd=-1; return -2; } // interface closed\n        if (fds[0].revents &amp; POLLRDNORM){\n            res = read(fd,buf,255);\n            if(!res){ close(fd); return -3; } // data receive error\n            buf[res-2]=0;\n            printf(\"Received %d bytes : %s\\n\",res,buf);\n            return 0;\n        }\n        return -4; // unknown error\n    }\n    return -5; // timeout\n}\nint sendCMD(char* cmd){\n\n    int res=1;\n    retry=0;\n\n    while(res &amp;&amp; retry&lt;5){ res=connect(); }\n    if(res) return -7;\n    if(retry&gt;5) return -8;\n    int len = strlen(cmd);\n    int count = write(fd, cmd, len);\n    if(count&lt;len){ return -6;}\n    return handlePoll();\n}\nint main(void){\n\n    while(1){\n        switch(sendCMD(DATA)){\n        case -1: printf(\"IO error\\n\"); break;\n        case -2: printf(\"Interface closed error\\n\"); break;\n        case -3: printf(\"data receive error\\n\"); break;\n        case -4: printf(\"Unknown error\\n\"); break;\n        case -5: printf(\"Timeout\\n\"); break;\n        case -6: printf(\"Command send error\\n\"); sleepms(200); break;\n        case -7: printf(\"Interface open error\\n\"); break;\n        case -8: printf(\"Cannot open interface after 5 try\\n\"); break;\n        default: break;\n        }\n    }\n}\n</code></pre>\n\n<p>I think there should be a better way to deal with disconnect (<a href=\"https://stackoverflow.com/questions/34170350/detecting-if-a-character-device-has-disconnected-in-linux-in-with-termios-api-c\">Detecting if a character device has disconnected in Linux in with termios api (c++)</a>)</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1558557428, "post_id": 56264609, "comment_id": 99145639, "body": "<code>int *w[2];</code> -&gt; <code>int w[2];</code> and <code>mult(*w, u, v);</code> -&gt; <code>mult(w, u, v);</code>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1558559558, "post_id": 56264609, "comment_id": 99146510, "body": "Please explain your code. What e.g. do you think this does <code>int *w[2];</code>? And <code>mult(*w, u, v);</code>? In each case explain especially what the <code>*</code> before the <code>w</code> means. We need to make sure that there is some thought behind your code, because fixing &quot;guessed&quot; code is futile."}], "answers": [{"tags": [], "owner": {"reputation": 421, "user_id": 11521482, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QIrZ4uBKGpc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfy52SQZZoz_RBLxJ0jRvF-_uNwbQ/mo/photo.jpg?sz=128", "display_name": "Mathias Schmid", "link": "https://stackoverflow.com/users/11521482/mathias-schmid"}, "is_accepted": false, "score": 0, "last_activity_date": 1558571476, "creation_date": 1558571476, "answer_id": 56266625, "question_id": 56264609, "link": "https://stackoverflow.com/questions/56264609/c-language-pointer-segmentation-fault/56266625#56266625", "title": "c language pointer Segmentation fault", "body": "<p>You pass an uninitialized pointer to function mult() and try to assign a value to memory referenced by that pointer. No surprise that you get a segmentation fault.\nWhat's the intention of your code ?</p>\n"}], "owner": {"reputation": 1, "user_id": 11541538, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q-PCL8s4vK0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdAYeXlcITsLcncJm59D3Emp--Y1A/mo/photo.jpg?sz=128", "display_name": "Sceng", "link": "https://stackoverflow.com/users/11541538/sceng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "closed_date": 1558594340, "answer_count": 1, "score": 0, "last_activity_date": 1558571476, "creation_date": 1558557242, "question_id": 56264609, "link": "https://stackoverflow.com/questions/56264609/c-language-pointer-segmentation-fault", "closed_reason": "Duplicate", "title": "c language pointer Segmentation fault", "body": "<p>Segmentation fault. I get the error when I try to run code in C. \nI am not getting errors in similar instances when using pointer.</p>\n\n<pre><code> #include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nint mult(int *w, int u, int v) {\n    w[0] = u;\n    w[1] = v;\n    return 0;\n}\n\n\nint main() {\n    int u = 8;\n    int v = 2;                \n    int *w[2];\n    mult(*w, u, v);\n    printf(\"%d%d\", w[0], w[1]);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "ascii"], "answers": [{"tags": [], "owner": {"reputation": 3805, "user_id": 3845803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aG57R.jpg?s=128&g=1", "display_name": "Kon", "link": "https://stackoverflow.com/users/3845803/kon"}, "is_accepted": false, "score": 0, "last_activity_date": 1558556595, "creation_date": 1558556595, "answer_id": 56264468, "question_id": 56264426, "link": "https://stackoverflow.com/questions/56264426/what-does-toascii-do/56264468#56264468", "title": "What does toascii do?", "body": "<p>It converts and <code>int</code> sized parameter (<code>c</code>) to a 7-bit ascii value by clearing higher order bits.  Effectively it returns <code>c &amp; 0x7f</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1558556763, "post_id": 56264476, "comment_id": 99145368, "body": "Ah. It only keeps the lowest seven bits. That makes sense."}, {"owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 2, "creation_date": 1558557535, "post_id": 56264476, "comment_id": 99145685, "body": "As a side note, I should mention that as of POSIX 2008, <code>toascii</code> is considered an obsolete function."}], "tags": [], "owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "is_accepted": true, "score": 3, "last_activity_date": 1558556623, "creation_date": 1558556623, "answer_id": 56264476, "question_id": 56264426, "link": "https://stackoverflow.com/questions/56264426/what-does-toascii-do/56264476#56264476", "title": "What does toascii do?", "body": "<p>Assuming you are talking about the POSIX <code>toascii</code>, it says what it does right in the <code>man</code> page.</p>\n\n<blockquote>\n  <p>toascii() converts c to a 7-bit unsigned char value that fits into the ASCII character set, by clearing the high-order bits.</p>\n</blockquote>\n\n<p>If you need to ensure a value only uses the lowest seven bits, then you have a use for it, but you're probably more likely to bitwise-AND the value with <code>0x7F</code>.</p>\n"}], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 56264476, "answer_count": 2, "score": 1, "last_activity_date": 1558556623, "creation_date": 1558556434, "question_id": 56264426, "link": "https://stackoverflow.com/questions/56264426/what-does-toascii-do", "title": "What does toascii do?", "body": "<p>What does the function <code>toascii()</code> do?</p>\n\n<p>Is there any practical use for it?</p>\n\n<p>Note: This is not about the Windows function <code>ToAscii</code>.</p>\n"}, {"tags": ["c", "linux-kernel", "linux-device-driver", "fwrite"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1558554461, "post_id": 56263774, "comment_id": 99144321, "body": "1. You shouldn&#39;t copy <code>MAX</code> bytes from <code>buffer</code>, but at max <code>length</code>. <code>copy_from_user(temp_str, buffer , max(sizeof(temp_str), length))</code>. 2. You should return <code>length</code> in case of success."}, {"owner": {"reputation": 820, "user_id": 1935655, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/743ead27b3f8a771dc27218e96cf7236?s=128&d=identicon&r=PG", "display_name": "LUser", "link": "https://stackoverflow.com/users/1935655/luser"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1558624812, "post_id": 56263774, "comment_id": 99170983, "body": "yeah I changed this  I still receive the weird behaviour."}], "owner": {"reputation": 820, "user_id": 1935655, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/743ead27b3f8a771dc27218e96cf7236?s=128&d=identicon&r=PG", "display_name": "LUser", "link": "https://stackoverflow.com/users/1935655/luser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558553656, "creation_date": 1558553656, "question_id": 56263774, "link": "https://stackoverflow.com/questions/56263774/linux-kernel-driver-development-how-to-write-to-device", "title": "Linux Kernel Driver Development - How to write to device", "body": "<p>I am learning Kernel dev for Linux and I always choose a project to learn development .</p>\n\n<p>I am wanting to make a driver that will take in input that is written to it and log it or echo it. I.E echo \"FOOBAR\" > /dev/hello </p>\n\n<p>I created a device in /dev/hello . I have a function that is called when the device is written to that acts weirdly. To me it looks like the memory isn't cleared correctly and memset seems to have no effect . </p>\n\n<p>Weird output</p>\n\n<pre><code>May 22 20:59:20 codeM kernel: [ 3541.839497] I was assigned major number 510\nMay 22 20:59:20 codeM kernel: [ 3541.839500] Please create device with name  \nMay 22 20:59:20 codeM kernel: [ 3541.839500]  mknod /dev/hello c 510 0 \nMay 22 20:59:43 codeM kernel: [ 3565.604818] DATA: ZZZZZZZZZ\nMay 22 20:59:43 codeM kernel: [ 3565.604818] t-check is\ufffd \nMay 22 20:59:43 codeM kernel: [ 3565.604818] \nMay 22 20:59:43 codeM kernel: [ 3565.604829] I am Sorry Dave, But I cannot Let you do that !\n</code></pre>\n\n<p>Here is my code :</p>\n\n<pre><code> #include \"functs.h\"\n\n\n\nMODULE_LICENSE(\"GPL\");\n\n#define DRIVER_AUTHOR \"projecter\"\n#define DRIVER_DESC \"Some echo driver\"\nMODULE_AUTHOR(DRIVER_AUTHOR);\nMODULE_DESCRIPTION(DRIVER_DESC);\n\nint Major;\nstatic int Device_Open = 0;\nstatic char msg[BUF_LEN];\nstatic char *msg_Ptr;\n\n\nstatic struct file_operations fops = {\n    .read    = device_read,\n    .write   = device_write,\n    .open    = device_open,\n    .release = device_release\n};\n\n\n\n//init _module functions\n\nint init_module(void){\n\nMajor = register_chrdev(0, DEVICE_NAME, &amp;fops);\n\nif (Major &lt; 0){\n    printk(KERN_ALERT \"I have failed to load!\\n\");\n    return Major;\n}\n\nprintk (KERN_ALERT \"I was assigned major number %d\\n\" , Major);\nprintk (KERN_ALERT \"Please create device with name  \\n mknod /dev/%s c %d 0 \\n\" ,DEVICE_NAME , Major );\nreturn 0;\n\n\n}\n\n\nint device_open(struct inode * inode, struct file *file){\n\nstatic int counter = 0;\nif (Device_Open){\n    return -EBUSY;\n\n}\nDevice_Open++;\n\nsprintf(msg, \"Good morning Dave, I was opened %d times\", counter++);\nmsg_Ptr = msg;\ntry_module_get(THIS_MODULE);\nreturn 0;\n}\n\n\n\nint device_release(struct inode  * inode, struct file *file){\n    Device_Open--;\n\n    module_put(THIS_MODULE);\n    return 0;\n}\n\n\nssize_t device_read(struct file  * file,  char * buffer, size_t length, loff_t *offset){\n    int bytes_read = 0;\n    if(*msg_Ptr == 0){\n        return 0;\n    }\n\n    while(length &amp;&amp; *msg_Ptr){\n        put_user(* (msg_Ptr++), buffer++ );\n        length--;\n        bytes_read++;\n}\n        return bytes_read;\n\n\n\n}\n\nchar temp_str[20] = {};\nssize_t device_write(struct file * file , const char * buffer, size_t length, loff_t *offset){\n    static int MAX = 20;\n\n\n\n    if (buffer){\n        if(copy_from_user(temp_str, buffer , MAX) !=0 ){\n            return -EFAULT;\n        }\n    else{\n        printk(KERN_ALERT \"DATA: %s \\n\\n\", temp_str);\n\n\n\n      }\n   }\n\n\n\n    printk(KERN_ALERT \"I am Sorry Dave, But I cannot Let you do that !\\n\");\n    memset(temp_str, 0, 20);\n    return 1 ; \n  // return -EINVAL;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "typedef"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 2, "creation_date": 1558553483, "post_id": 56263708, "comment_id": 99143901, "body": "This has a lot of disadvantages, and no real benefits. If it&#39;s any version of a language where booleans exist, those should be used instead. This typedef means that you can have different true values not equal to each other."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1558553484, "post_id": 56263708, "comment_id": 99143902, "body": "Some people don&#39;t even bother to <code>typedef</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 9, "creation_date": 1558553492, "post_id": 56263708, "comment_id": 99143907, "body": "C++ and C are two different languages."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1558553495, "post_id": 56263708, "comment_id": 99143910, "body": "Before <code>bool</code> was added to standard C it was fashionable to define your own. There&#39;s heaps of legacy code with it still. Cleaning it completely out is just never a priority."}, {"owner": {"reputation": 337, "user_id": 8952646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd2b924ba57e7db4a4029b0a9bf510b?s=128&d=identicon&r=PG&f=1", "display_name": "isragram", "link": "https://stackoverflow.com/users/8952646/isragram"}, "edited": false, "score": 0, "creation_date": 1558553578, "post_id": 56263708, "comment_id": 99143943, "body": "No advantage at all. Better  #include &lt;stdbool.h&gt;"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1558554157, "post_id": 56263708, "comment_id": 99144185, "body": "Fun anecdote: until recently <code>bool b = false; b++;</code> was legal - because obviously you can increment a <code>bool</code> like an <code>int</code> ;) Luckily we recently got rid of that. Compatibility and legacy concerns never fail to surprise and screw you over."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1558554298, "post_id": 56263708, "comment_id": 99144236, "body": "@JesperJuhl Still legal... it&#39;s just that <code>b</code> is casted back to <code>bool</code>, so you will get <code>1</code> even after many increments."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1558554436, "post_id": 56263708, "comment_id": 99144306, "body": "@EugeneSh. I can&#39;t check right now (on my phone), but I&#39;m <i>fairly</i> sure that as of C++17 &quot;bool increment&quot; is no longer just deprecated, but actually invalid.."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1558554455, "post_id": 56263708, "comment_id": 99144318, "body": "@JesperJuhl Oh.. I am talking about C."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1558554643, "post_id": 56263708, "comment_id": 99144390, "body": "@EugeneSh. Just goes to show that C and C++ are <i>very</i> different languages these days :)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1558555337, "post_id": 56263708, "comment_id": 99144703, "body": "One can do some funny tricks applying arithmetic and bitwise operators on (the standard) <code>bool</code> (in C). <a href=\"https://ideone.com/PrRY2D\" rel=\"nofollow noreferrer\">ideone.com/PrRY2D</a>"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1558555421, "post_id": 56263708, "comment_id": 99144741, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/193790/discussion-between-jesper-juhl-and-eugene-sh\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1558554848, "post_id": 56263773, "comment_id": 99144481, "body": "@melpomene I&#39;ll take your word on that. My memory of when <code>_Bool</code> was introduced is a bit fuzzy ;) it was a fair number of years ago."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1558555000, "post_id": 56263773, "comment_id": 99144542, "body": "I can give you a citation. :-) ISO 9899:1999, 6.2.5 Types, 2 &quot;An object declared as type <code>_Bool</code> is large enough to store the values 0 and 1.&quot;"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1558555112, "post_id": 56263773, "comment_id": 99144588, "body": "@melpomene Thanks :)"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 4, "creation_date": 1558556049, "post_id": 56263773, "comment_id": 99145016, "body": "C didn&#39;t want to adopt <code>bool</code> because so much legacy code had already defined their own versions of <code>bool</code> and they didn&#39;t want to invalidate all of that code.  Instead, they made another type from a reserved namespace (that is, a name beginning with an underscore followed by a capital letter).  They still made it really easy to use <code>bool</code> by just including <code>&lt;stdbool.h&gt;</code> if you weren&#39;t handcuffed by legacy code.  Seems like a reasonable compromise to me."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1558556411, "post_id": 56263773, "comment_id": 99145176, "body": "@ChristianGibbons the whole _ + capital == reserved name I know well enough and I can see why they did that. Not breaking old code also makes sense - somewhat. Sometimes you have to break eggs to make an omelet and C++ had already established <code>bool</code> as a keyword. So I <i>get</i> their reasons, but I just think that when looking towards the future (where <i>most</i> code is written) it would have made sense to make a clean break and just adopt <code>bool</code>. But, that&#39;s just <i>my</i> opinion and not what happened."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1558567084, "post_id": 56263773, "comment_id": 99148497, "body": "@JesperJuhl  It is not for the standards body to choose to break my eggs!  As a compiler vendor (who have seats in the standardisation committee), it would be commercially foolish to introduce changes that break your customer&#39;s existing code.  Moreover most of the code I am using now was written in the past (and none of it was written in the future!).  GCC has to compile the Linux code base, and VC++ Windows neither GNU nor Microsoft would needlessly break their own code bases."}], "tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": true, "score": 6, "last_activity_date": 1558554338, "last_edit_date": 1558554338, "creation_date": 1558553648, "answer_id": 56263773, "question_id": 56263708, "link": "https://stackoverflow.com/questions/56263708/why-would-someone-use-int-instead-of-bool-data-type/56263773#56263773", "title": "Why would someone use int instead of bool data type?", "body": "<p>One might do so if they were interfacing a lot with C code. Since C does not have a <code>bool</code> type - at least not untill C11 (I think it was, or maybe C99) introduced the <code>_Bool</code> type - which I can't honestly remember if is compatible with C++ <code>bool</code> - they should have just adopted the <code>bool</code> keyword (IMHO), but I digress.</p>\n\n<p>Also, it is common in old C++ code bases that pre-date the C++98 standard where C++ gained <code>bool</code>. </p>\n\n<p>So <em>legacy</em> and <em>C compatibility</em> is the answer.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 1, "last_activity_date": 1558560491, "creation_date": 1558560491, "answer_id": 56265243, "question_id": 56263708, "link": "https://stackoverflow.com/questions/56263708/why-would-someone-use-int-instead-of-bool-data-type/56265243#56265243", "title": "Why would someone use int instead of bool data type?", "body": "<p>C did not have a dedicated Boolean type until the 1999 standard - any scalar with a non-zero value was considered \"true\", while a zero value was considered \"false\".  A common <em>convention</em> was to use macros and/or typedefs to create Boolean values:</p>\n\n<pre><code>#define BOOL int\n#define TRUE (1)\n#define FALSE (0)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>typedef int bool;\nstatic const bool true = 1;\nstatic const bool false = 0;\n</code></pre>\n\n<p>or something similar.</p>\n\n<p>So what you're looking at is either old (pre-C99) C code, or code written by someone who learned C before that standard came out.  </p>\n\n<p>Note that C still considers <em>any</em> non-zero scalar value to be \"true\", and control expressions in <code>if</code> and <code>for</code> and <code>while/do while</code> statements do not specifically have to have Boolean types.  Since it was derived from C, the same is true in C++, even though it also has dedicated Boolean types and operators.  </p>\n"}], "owner": {"reputation": 123, "user_id": 3310193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee55be569e8707bdfd21c5a748e86efe?s=128&d=identicon&r=PG&f=1", "display_name": "Infinity", "link": "https://stackoverflow.com/users/3310193/infinity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 56263773, "answer_count": 2, "score": 0, "last_activity_date": 1558560491, "creation_date": 1558553359, "last_edit_date": 1558554543, "question_id": 56263708, "link": "https://stackoverflow.com/questions/56263708/why-would-someone-use-int-instead-of-bool-data-type", "title": "Why would someone use int instead of bool data type?", "body": "<p>Recently I saw in one project where they typedef int as BOOL and used it in place of bool. Does doing so provides any advantages?</p>\n\n<pre><code>typedef int BOOL;\n</code></pre>\n"}, {"tags": ["c", "geometry"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1558552594, "post_id": 56263496, "comment_id": 99143462, "body": "This code is not readable. The error suggest that you are corrupting your allocated memory somehow or changing the pointer value."}, {"owner": {"reputation": 3, "user_id": 11541089, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "ari lp", "link": "https://stackoverflow.com/users/11541089/ari-lp"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1558552703, "post_id": 56263496, "comment_id": 99143514, "body": "How I can solved it?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1558552731, "post_id": 56263496, "comment_id": 99143533, "body": "See the first part of my comment."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1558552747, "post_id": 56263496, "comment_id": 99143544, "body": "Without validation of the return from <code>scanf</code> on EVERY user input, it is impossible to know whether <code>scanf(&quot;%d&quot;,&amp;n);</code> succeeded and whether <code>malloc((n+1)*sizeof(point));</code> allocated anything at all -- which could easily lead to your error."}, {"owner": {"reputation": 2673, "user_id": 11292489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cucr6.jpg?s=128&g=1", "display_name": "Gilles-Philippe Paill&#233;", "link": "https://stackoverflow.com/users/11292489/gilles-philippe-paill%c3%a9"}, "edited": false, "score": 3, "creation_date": 1558552928, "post_id": 56263496, "comment_id": 99143639, "body": "@arilp Look at this line: <code>t=(triangle*)malloc((n+1)*sizeof(point));</code>. You allocate points while you wanted to allocate triangles. Then, you write into memory that you do not own and you corrupt it."}], "answers": [{"comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1558553285, "post_id": 56263651, "comment_id": 99143802, "body": "Better still: <code>t = malloc((n+1) * sizeof *t);</code>, which (a) fixes the problem, (b) is arguably more readable, and (c) honors what all C programs should strive for: <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">not casting <code>malloc</code></a>. More characters on-screen does not necessarily equate to better code."}, {"owner": {"reputation": 2673, "user_id": 11292489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cucr6.jpg?s=128&g=1", "display_name": "Gilles-Philippe Paill&#233;", "link": "https://stackoverflow.com/users/11292489/gilles-philippe-paill%c3%a9"}, "reply_to_user": {"reputation": 3, "user_id": 11541089, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "ari lp", "link": "https://stackoverflow.com/users/11541089/ari-lp"}, "edited": false, "score": 0, "creation_date": 1558553316, "post_id": 56263651, "comment_id": 99143820, "body": "@arilp Great! Glad that I could help. Please consider accepting the answer if it solved your problem."}, {"owner": {"reputation": 2673, "user_id": 11292489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cucr6.jpg?s=128&g=1", "display_name": "Gilles-Philippe Paill&#233;", "link": "https://stackoverflow.com/users/11292489/gilles-philippe-paill%c3%a9"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1558553408, "post_id": 56263651, "comment_id": 99143865, "body": "@WhozCraig Thanks for the tip, I will add it to the answer."}], "tags": [], "owner": {"reputation": 2673, "user_id": 11292489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cucr6.jpg?s=128&g=1", "display_name": "Gilles-Philippe Paill&#233;", "link": "https://stackoverflow.com/users/11292489/gilles-philippe-paill%c3%a9"}, "is_accepted": true, "score": 2, "last_activity_date": 1558553552, "last_edit_date": 1558553552, "creation_date": 1558553055, "answer_id": 56263651, "question_id": 56263496, "link": "https://stackoverflow.com/questions/56263496/transform-a-triangle-and-sort-them-in-c/56263651#56263651", "title": "transform a triangle and sort them in C", "body": "<p>Change the following line:</p>\n\n<p><code>t=(triangle*)malloc((n+1)*sizeof(point));</code> to</p>\n\n<p><code>t=(triangle*)malloc((n+1)*sizeof(triangle));</code> or even</p>\n\n<p><code>t = malloc((n+1) * sizeof *t);</code> to avoid casting and dealing with the type of <code>t</code>.</p>\n\n<p>You allocate points while you wanted to allocate triangles. Then, you write into memory that you do not own and you corrupt it. This could have lead to a segmentation fault. In your case, you were lucky (or unlucky if you consider that you would have caught the bug before) and you got the error when freeing the allocated memory. From my experience, an error when freeing memory is almost always memory corruption and sometimes a double free if you are not careful.</p>\n"}], "owner": {"reputation": 3, "user_id": 11541089, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "ari lp", "link": "https://stackoverflow.com/users/11541089/ari-lp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 56263651, "answer_count": 1, "score": 0, "last_activity_date": 1558587167, "creation_date": 1558552384, "last_edit_date": 1558587167, "question_id": 56263496, "link": "https://stackoverflow.com/questions/56263496/transform-a-triangle-and-sort-them-in-c", "title": "transform a triangle and sort them in C", "body": "<p>Given a triangle, I have to transform a triangle into another in the following way: rotate a given angle the vertex with respect to the origin, and then applied a homothety with respect to the origin. And save every triangle in n+1 vector, and then sort the vector according to the argument (angle between 0 and 2\u03c0) of the vertex a, with direct insertion. </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;math.h&gt;\ntypedef struct{\nfloat x;\nfloat y; }point;\ntypedef struct {\npoint a;\npoint b;\npoint c; }triangle;\n\n      float angle(triangle *t,int i){\n\nfloat a,b,c,alpha;\n a=(t[i].b.x-t[i].c.x)*(t[i].b.x-t[i].c.x)+(t[i].b.y-t[i].c.y)*(t[i].b.y-t[i].c.y);\n b=(t[i].a.x-t[i].b.x)*(t[i].a.x-t[i].b.x)+(t[i].a.y-t[i].b.y)*(t[i].a.y-t[i].b.y);\n   c=(t[i].a.x-t[i].c.x)*(t[i].a.x-t[i].c.x)+(t[i].a.y-t[i].c.y)*(t[i].a.y-t[i].c.y);\n  alpha=acos((b*b+c*c-a*a)/(2*b*c));\n return alpha;} \n\n   void move(int r,float angle,triangle *t,int i){\n\nfloat alpha;\n // rotation\n     alpha=angle*M_PI/180;\n        t[i+1].a.x=t[i].a.x*cos(alpha)-t[i].a.y*sin(alpha);\n        t[i+1].a.y=t[i].a.x*sin(alpha)+t[i].a.y*cos(alpha);\n    t[i+1].b.x=t[i].b.x*cos(alpha)-t[i].b.y*sin(alpha);\n    t[i+1].b.y=t[i].b.x*sin(alpha)+t[i].b.y*cos(alpha);\n    t[i+1].c.x=t[i].c.x*cos(alpha)-t[i].c.y*sin(alpha);\n    t[i+1].c.y=t[i].c.x*sin(alpha)+t[i].c.y*cos(alpha);\n\n// homotecy\n    t[i+1].a.x=t[i+1].a.x*r;\n    t[i+1].a.y=t[i+1].a.y*r;\n    t[i+1].b.x=t[i+1].b.x*r;\n    t[i+1].b.y=t[i+1].b.y*r;\n    t[i+1].c.x=t[i+1].c.x*r;\n     t[i+1].c.y=t[i+1].c.y*r;\n       return;}\n\nvoid sort(triangle *t,int n){\n\nfloat a,b;\nint k,i;\nfor(i=1;i&lt;=n-1;i++){\n    a=angle(t,i);\n    k=i-1;\n    b=angle(t,k);\n    while(a&gt;=0 &amp;&amp; a&lt;=(M_PI*2) &amp;&amp; b&gt;a){\n        t[k+1]=t[k];\n        k--;\n    }\n    t[k+1]=t[i];\n}\nreturn;}\n\n int main(void){\n\ntriangle *t;\nfloat angle;\nint r,n,i;\nchar so[50];\nFILE *s;\n\nprintf(\"n?\\n\");\nscanf(\"%d\",&amp;n);\nprintf(\"r?\\n\");\nscanf(\"%d\",&amp;r);\nprintf(\"angle?\\n\");\nscanf(\"%f\",&amp;angle);\nt=(triangle*)malloc((n+1)*sizeof(point));\nif(t==NULL) exit(1);\nprintf(\"Triangle?\\n\");\nscanf(\"%f %f %f %f %f %f\",&amp;t[0].a.x,&amp;t[0].a.y,&amp;t[0].b.x,&amp;t[0].b.y,&amp;t[0].c.x,&amp;t[0].c.y);\nfor(i=0;i&lt;n;i++){\n    move(r,angle,t,i);\n    sort(t,n);\n}\nprintf(\"file?\\n\");\nscanf(\"%s\",so);\ns=fopen(so,\"w\");\nif(s==NULL) exit(1);\nfor(i=0;i&lt;n;i++){\n    fprintf(s,\"%9.5f %9.5f %19.5f %9.5f %9.5f %9.5f\\n\",t[i].a.x,t[i].a.y,t[i].b.x,t[i].b.y,t[i].c.x,t[i].c.y);\n}\nfclose(s);  \nfree(t);\n   return 0;}\n</code></pre>\n\n<p>When executing it says: </p>\n\n<pre><code>free(): invalid next size (normal)\n</code></pre>\n"}, {"tags": ["c", "assembly", "compiler-construction", "x86-64"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 4, "creation_date": 1558549732, "post_id": 56262889, "comment_id": 99142238, "body": "Just because it&#39;s accessed relative to <code>rip</code> doesn&#39;t mean it&#39;s in the <code>.text</code> segment (rather section). As you can clearly see in your assembly code, it&#39;s preceded by a <code>.data</code> so it&#39;s there not in <code>.text</code>. It&#39;s just a position independent way to address memory, which is frequently enabled by default nowadays due to ASLR."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1558557006, "post_id": 56264497, "comment_id": 99145473, "body": "Modern Linux distros make gcc default to the small PIC code-model, for PIE executables.  x64 is Windows terminology, not generally used in Linux or GCC.   Otherwise, nice answer."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1558558336, "post_id": 56264497, "comment_id": 99146010, "body": "The &quot;small&quot; code mode is position-dependent, so all addresses are link-time constants.  Your point about needing a pointer to the .data section would only apply for the small PIC/PIE model, where absolute static address aren&#39;t known at link time."}], "tags": [], "owner": {"reputation": 7117, "user_id": 1245420, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c5a428623702851ce5f462822483fc6c?s=128&d=identicon&r=PG", "display_name": "phonetagger", "link": "https://stackoverflow.com/users/1245420/phonetagger"}, "is_accepted": false, "score": 4, "last_activity_date": 1558558236, "last_edit_date": 1558558236, "creation_date": 1558556712, "answer_id": 56264497, "question_id": 56262889, "link": "https://stackoverflow.com/questions/56262889/why-are-global-variables-in-x86-64-accessed-relative-to-the-instruction-pointer/56264497#56264497", "title": "Why are global variables in x86-64 accessed relative to the instruction pointer?", "body": "<p>Although the .data and .text segments are independent of one another, once linked, their offsets relative to one another are fixed (at least in the gcc x86-64 <code>-mcmodel=small</code> code model, which is the default code model and works for all programs whose code+data is less than 2GB).</p>\n\n<p>So wherever the system loads an executable in the process's address space, the instructions and the data they reference will have fixed offsets relative to one another.</p>\n\n<p>For these reasons, x86-64 programs compiled for the (default) small code model use RIP-relative addressing for both code and global data. Doing so means the compiler doesn't need to dedicate a register to point to wherever the system loaded the executable's .data section; the program already knows its own RIP value and the offset between that and the global data it wants to access, so the most efficient way of accessing it is via a 32-bit fixed offset from RIP.</p>\n\n<p>(Absolute 32-bit addressing modes would take more space, and 64-bit absolute addressing modes are even less efficient, and only available for RAX/EAX/AX/AL.)</p>\n\n<p>You can find more info about this on Eli Bendersky's website: <a href=\"https://eli.thegreenplace.net/2012/01/03/understanding-the-x64-code-models\" rel=\"nofollow noreferrer\">Understanding the x64 code models</a></p>\n"}, {"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 14, "last_activity_date": 1607116460, "last_edit_date": 1607116460, "creation_date": 1558556888, "answer_id": 56264536, "question_id": 56262889, "link": "https://stackoverflow.com/questions/56262889/why-are-global-variables-in-x86-64-accessed-relative-to-the-instruction-pointer/56264536#56264536", "title": "Why are global variables in x86-64 accessed relative to the instruction pointer?", "body": "<p><strong>The offsets between different sections of your executable are link-time constants</strong>, so RIP-relative addressing is usable for any section (including <code>.data</code> where your non-<code>const</code> globals are).  Note the <code>.data</code> in your asm output.</p>\n<p>This applies even in a PIE executable or shared library, where the absolute addresses are <em>not</em> known until runtime (ASLR).</p>\n<p>Runtime ASLR for position-independent executables (PIE) randomizes one base address for the entire program, not individual segment start addresses relative to each other.</p>\n<p><strong>All access to static variables uses RIP-relative addressing because that's most efficient, even in a position-dependent executable where absolute addressing is an option</strong> (because absolute addresses of static code/data are link-time constants, not relocated by dynamic linking).</p>\n<hr />\n<p><strong>Related</strong> and maybe duplicates:</p>\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/40329260/why-is-the-address-of-static-variables-relative-to-the-instruction-pointer\">Why is the address of static variables relative to the Instruction Pointer?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/44967075/why-does-this-movss-instruction-use-rip-relative-addressing\">Why does this MOVSS instruction use RIP-relative addressing?</a></li>\n</ul>\n<hr />\n<p>In 32-bit x86, there are 2 redundant ways to encode an addressing mode with no registers and a <code>disp32</code> absolute address.\n(With and without a SIB byte).  x86-64 repurposed the shorter one as <code>RIP+rel32</code>, so <code>mov foo, %eax</code> is 1 byte longer than <code>mov foo(%rip), %eax</code>.</p>\n<p>64-bit absolute addressing would take even more space, and is only available for <code>mov</code> to/from RAX/EAX/AX/AL unless you use a separate instruction to get the address into a register first.</p>\n<p>(In x86-64 Linux PIE/PIC, 64-bit absolute addressing is allowed, and handled via load-time fixups to put the right address into the code or jump table or statically-initialized function pointer.  So code doesn't technically <em>have</em> to be position-independent, but normally it's more efficient to be.  And 32-bit absolute addressing isn't allowed, because ASLR isn't limited to the low 31 bits of virtual address space.)</p>\n<hr />\n<p>Note that in a non-PIE Linux executable, <strong>gcc will use 32-bit absolute addressing</strong> for putting the address of static data in a register.  e.g. <code>puts(&quot;hello&quot;);</code> will typically compile as</p>\n<pre><code>mov   $.LC0, %edi     # mov r32, imm32\ncall  puts\n</code></pre>\n<p>In the default non-PIE memory model, static code and data get linked into the low 32 bits of virtual address space, so 32-bit absolute addresses work whether they're zero- or sign-extended to 64-bit.  This is handy for <strong>indexing static arrays</strong>, too, like <code>mov array(%rax), %edx</code> ; <code>add $4, %eax</code> for example.</p>\n<p>See <a href=\"https://stackoverflow.com/questions/43367427/32-bit-absolute-addresses-no-longer-allowed-in-x86-64-linux\">32-bit absolute addresses no longer allowed in x86-64 Linux?</a> for more about PIE executables, which use position-independent code for everything, including RIP-relative LEA like 7-byte <code>lea .LC0(%rip), %rdi</code> instead of 5-byte <code>mov $.LC0, %edi</code>.  See <a href=\"https://stackoverflow.com/questions/57212012/how-to-load-address-of-function-or-label-into-register/57212627#57212627\">How to load address of function or label into register</a></p>\n<p>I mention Linux because it looks from the <code>.cfi</code> directives like you're compiling for a non-Windows platform.</p>\n"}], "owner": {"reputation": 407, "user_id": 7870784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b620ec2fb060d76bc73b291c4459439b?s=128&d=identicon&r=PG&f=1", "display_name": "roy cabouly", "link": "https://stackoverflow.com/users/7870784/roy-cabouly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1657, "favorite_count": 1, "accepted_answer_id": 56264536, "answer_count": 2, "score": 7, "last_activity_date": 1607116460, "creation_date": 1558549609, "last_edit_date": 1558557134, "question_id": 56262889, "link": "https://stackoverflow.com/questions/56262889/why-are-global-variables-in-x86-64-accessed-relative-to-the-instruction-pointer", "title": "Why are global variables in x86-64 accessed relative to the instruction pointer?", "body": "<p>I have tried to compile c code to assembly code using <code>gcc -S -fasm foo.c</code>.\nThe c code declare global variable and variable in the main function as shown below:</p>\n\n<pre><code>int y=6;\nint main()\n{\n        int x=4;\n        x=x+y;\n        return 0;\n}\n</code></pre>\n\n<p>now I looked in the assembly code that has been generated from this C code and I saw, that the global variable y is stored using the value of the rip instruction pointer.</p>\n\n<p>I thought that only const global variable stored in the text segment but, looking at this example it seems that also regular global variables are stored in the text segment which is very weird.</p>\n\n<p>I guess that some assumption i made is wrong, so can someone please explain it to me?</p>\n\n<p>the assembly code generated by c compiler:</p>\n\n<pre><code>        .file   \"foo.c\"\n        .text\n        .globl  y\n        .data\n        .align 4\n        .type   y, @object\n        .size   y, 4\ny:\n        .long   6\n        .text\n        .globl  main\n        .type   main, @function\n\nmain:\n.LFB0:\n        .cfi_startproc\n        pushq   %rbp\n        .cfi_def_cfa_offset 16\n        .cfi_offset 6, -16\n        movq    %rsp, %rbp\n        .cfi_def_cfa_register 6\n        movl    $4, -4(%rbp)\n        movl    y(%rip), %eax\n        addl    %eax, -4(%rbp)\n        movl    $0, %eax\n        popq    %rbp\n        .cfi_def_cfa 7, 8\n        ret\n        .cfi_endproc\n.LFE0:\n</code></pre>\n"}, {"tags": ["c", "bit", "parity"], "comments": [{"owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "edited": false, "score": 2, "creation_date": 1558549170, "post_id": 56262768, "comment_id": 99141986, "body": "Don&#39;t forget the last <code>&amp; 1</code>. Only the rightmost bit matters in the end."}, {"owner": {"reputation": 1676, "user_id": 8796240, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Frmc2F7AVDs/AAAAAAAAAAI/AAAAAAAAQLM/B_xiXHfq_Ss/photo.jpg?sz=128", "display_name": "yaho cho", "link": "https://stackoverflow.com/users/8796240/yaho-cho"}, "edited": false, "score": 0, "creation_date": 1558550225, "post_id": 56262768, "comment_id": 99142458, "body": "<code>01001001 &amp; 1 == 1</code>. I can&#39;t understand why you expect it as <code>0</code>."}, {"owner": {"reputation": 106, "user_id": 4409108, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HlfZM.jpg?s=128&g=1", "display_name": "rallen911", "link": "https://stackoverflow.com/users/4409108/rallen911"}, "edited": false, "score": 0, "creation_date": 1558555958, "post_id": 56262768, "comment_id": 99144975, "body": "Your manual walk through doesn&#39;t appear to carry over the value to the next row.  The &quot;^=&quot; does the XOR and then sets the value to the result of the XOR."}], "answers": [{"tags": [], "owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "is_accepted": true, "score": 2, "last_activity_date": 1558550704, "last_edit_date": 1558550704, "creation_date": 1558550394, "answer_id": 56263063, "question_id": 56262768, "link": "https://stackoverflow.com/questions/56262768/check-even-parity-from-byte/56263063#56263063", "title": "Check even parity from byte", "body": "<p>Each step combines two bitsets L and R such that L's parity is merged with R's. R ends up having the same parity as L+R did originally.</p>\n\n<p>In step 1 we take 8 bits and produce a 4-bit number with the same parity as the 8-bit one. In step 2 we produce a 2-bit number with the same parity as the 4. In the last step we produce a 1-bit number with the same parity as the 2. That means in three steps we get a single bit with the same parity as the original 8.</p>\n\n<p>Let me show you what I mean one step at a time.</p>\n\n<ol>\n<li><p>Let's start with the first step where L is the left 4 bits (0110) and R is the right 4 (1101).</p>\n\n<pre><code>xxxx1101 (R)\nxxxx0110 (L)\n--------\nxxxx1011 (R^L)\n</code></pre>\n\n<p>I've gone ahead and x'ed out the left half of each number. Those bits don't matter. You'll see why as we progress: fewer and fewer bits will be relevant each step.</p>\n\n<p>L is even and R is odd, which means L+R is odd. R ^= L should therefore leave R with odd parity. Does it? It does indeed. 0110 has two set bits, so R ^= 0110 flips two of R's bits. Flipping an even number of bits won't change parity. R remains <strong>odd</strong>.</p></li>\n<li><p>In the second step, L is the left 2 bits (10) and R is the right 2 (11). </p>\n\n<pre><code>xxxxxx11 (R)\nxxxxxx10 (L)\n--------\nxxxxxx01 (L^R)\n</code></pre>\n\n<p>Now six bits are x'ed out. We're only concerned with two bits from each number.</p>\n\n<p>This time L is odd and R is even. Combined, L+R is odd, so this time we need to flip R's parity. Does R ^= L do that? Again, it does. L has an odd number of bits set, so XORing it will flip an odd number of bits of R, guaranteeing that R's parity is switched. R becomes <strong>odd</strong>.</p></li>\n<li><p>In the final step, L and R are just 1 bit apiece. </p>\n\n<pre><code>xxxxxxx1 (L)\nxxxxxxx0 (R)\n--------\nxxxxxxx1 (L^R)\n</code></pre>\n\n<p>L is 1, R is 0. Just like in the previous steps, we're hoping that R ^= L is odd, and it is. R is <strong>odd</strong>.</p></li>\n</ol>\n\n<p>Wonderful. We started with 8 bits with odd parity and by successfully merging two halves together we got down to 1 bit with the same odd parity.</p>\n"}, {"tags": [], "owner": {"reputation": 190, "user_id": 4016231, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Aviv Goll", "link": "https://stackoverflow.com/users/4016231/aviv-goll"}, "is_accepted": false, "score": 2, "last_activity_date": 1558551380, "creation_date": 1558551380, "answer_id": 56263283, "question_id": 56262768, "link": "https://stackoverflow.com/questions/56262768/check-even-parity-from-byte/56263283#56263283", "title": "Check even parity from byte", "body": "<p>I would like to propose a metaphor that may give some intuition:</p>\n\n<p>Imagine you have 4 cards lying in front of you, which you need to pile up. As a person with 2 hands, you can pick up a card in each hand simultaneously and place them on top of the other 2, then pick up one of the pairs and put it on top of the other.</p>\n\n<p>This piles 4 cards in 2 moves.</p>\n\n<p>Now imagine you need to pile 32 cards and have 16 hands (or more). You can use the same technique: create 16 piles of 2 cards, than 8 piles of 4 cards, 4 piles of 8 cards, 2 piles of 16 cards and finally a single pile of 32 cards.</p>\n\n<p>This piles 32 cards in 5 moves.</p>\n\n<p>Now replace 'pile' with 'xor', 'cards' with 'bits' and 'hands' with the capability of the processor. In 5 shifts and xors, you get the 32 bits of a number xor-ed together, which gives you 0 if the number have even parity and 1 otherwise.</p>\n"}], "owner": {"reputation": 205, "user_id": 9050988, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/2a9a2de704578635a71ed7fbd34344f7?s=128&d=identicon&r=PG&f=1", "display_name": "MrEmper", "link": "https://stackoverflow.com/users/9050988/mremper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 601, "favorite_count": 0, "accepted_answer_id": 56263063, "answer_count": 2, "score": 1, "last_activity_date": 1558551380, "creation_date": 1558549088, "question_id": 56262768, "link": "https://stackoverflow.com/questions/56262768/check-even-parity-from-byte", "title": "Check even parity from byte", "body": "<p>I've found a piece of code on Stackoverflow and edited it to my needs. source: <a href=\"https://stackoverflow.com/questions/21617970/how-to-check-if-value-has-even-parity-of-bits-or-odd\">How to check if value has even parity of bits or odd?</a></p>\n\n<p>It works like a charm, but I can't get my head around WHY it works.</p>\n\n<p>I tried writing it out, with example byte 0b01101101.</p>\n\n<pre><code>   01101101\n   00000110\n   -------- ^\n   01101011\n   00011010\n   -------- ^\n   01110001\n   00111000\n   -------- ^\n   01001001\n</code></pre>\n\n<p>While my unit test gives the answer; 1 </p>\n\n<pre><code>uint8_t check_even_parity(uint8_t value){\n     value ^= value &gt;&gt; 4;\n     value ^= value &gt;&gt; 2;\n     value ^= value &gt;&gt; 1;\n\n     return value &amp; 1;\n}\n</code></pre>\n\n<p>Expected is; 0\nActual result when trying to write it out; 01001001</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 5, "creation_date": 1558548763, "post_id": 56262630, "comment_id": 99141777, "body": "Just after the existing <code>sscanf()</code>, use <code>x %= 100;</code>.  Will that work for you?"}, {"owner": {"reputation": 9866, "user_id": 1105805, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7a694594978a256520ac4d5b938aea5b?s=128&d=identicon&r=PG", "display_name": "Rasmi Ranjan Nayak", "link": "https://stackoverflow.com/users/1105805/rasmi-ranjan-nayak"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1558549186, "post_id": 56262630, "comment_id": 99141997, "body": "@chux: That works and currently I am doing in that way only. But are there any way we can evaluate it in <code>sscanf</code>?"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1558549301, "post_id": 56262630, "comment_id": 99142053, "body": "Another option is <code>if (sscanf(str, &quot;%*2d%2d&#47;%2d&#47;%2d&quot;, &amp;y, &amp;m, &amp;d) != 3) goto err;</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1558549564, "post_id": 56262630, "comment_id": 99142157, "body": "Yet another option is to pass <code>str + 2</code> like <code>sscanf(str + 2, &quot;%d&#47;%d&#47;%d&quot;, &amp;x, &amp;y, &amp;z);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 9866, "user_id": 1105805, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7a694594978a256520ac4d5b938aea5b?s=128&d=identicon&r=PG", "display_name": "Rasmi Ranjan Nayak", "link": "https://stackoverflow.com/users/1105805/rasmi-ranjan-nayak"}, "edited": false, "score": 0, "creation_date": 1558549806, "post_id": 56262868, "comment_id": 99142269, "body": "you are right. but if char* str = &quot;319/05/12&quot;; then reads 9. which should not happen"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 9866, "user_id": 1105805, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7a694594978a256520ac4d5b938aea5b?s=128&d=identicon&r=PG", "display_name": "Rasmi Ranjan Nayak", "link": "https://stackoverflow.com/users/1105805/rasmi-ranjan-nayak"}, "edited": false, "score": 0, "creation_date": 1558550006, "post_id": 56262868, "comment_id": 99142361, "body": "@RasmiRanjanNayak Well, I assumed from the question, that it was a standard date. Specify what kind of data you will receive, and what to do with unexpected data."}, {"owner": {"reputation": 9866, "user_id": 1105805, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7a694594978a256520ac4d5b938aea5b?s=128&d=identicon&r=PG", "display_name": "Rasmi Ranjan Nayak", "link": "https://stackoverflow.com/users/1105805/rasmi-ranjan-nayak"}, "edited": false, "score": 0, "creation_date": 1558550154, "post_id": 56262868, "comment_id": 99142428, "body": "In case of unexpected data, sscanf should fail."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 9866, "user_id": 1105805, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7a694594978a256520ac4d5b938aea5b?s=128&d=identicon&r=PG", "display_name": "Rasmi Ranjan Nayak", "link": "https://stackoverflow.com/users/1105805/rasmi-ranjan-nayak"}, "edited": false, "score": 0, "creation_date": 1558550718, "post_id": 56262868, "comment_id": 99142669, "body": "@RasmiRanjanNayak And what is unexpected data?"}], "tags": [], "owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "is_accepted": true, "score": 2, "last_activity_date": 1558551621, "last_edit_date": 1558551621, "creation_date": 1558549524, "answer_id": 56262868, "question_id": 56262630, "link": "https://stackoverflow.com/questions/56262630/read-digits-from-a-number-using-sscanf/56262868#56262868", "title": "Read digits from a number using sscanf", "body": "<p>Given that you want it done in <code>sscanf</code>, it can be done this way:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>if (sscanf(str, \"%*2d%2d/%2d/%2d\", &amp;y, &amp;m, &amp;d) != 3)\n        goto err;\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>Add some check as an example:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>if (sscanf(str, \"%*2d%2d/%2d/%2d\", &amp;y, &amp;m, &amp;d) != 3)\n        goto err;\nif (sscanf(str, \"%4d\", &amp;tmp) != 1)\n        goto err;\nif (tmp &lt; 1900)\n        goto err_year;\n</code></pre>\n\n<p><code>sscanf</code> has a maximum width field, not an exact width field, so you have to check manually if the user inputs a 3 digit year, and think about what to do if so</p>\n\n<p>I wouldn't use it in this case because you still need to read the four digits for the check, so <strong>@chux</strong>'s solution is the best one in this case:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>if (sscanf(str, \"%4d/%2d/%2d\", &amp;year, &amp;m, &amp;d) != 3)\n        goto err;\nif (year &lt; 1900)\n        goto err_year;\ny = year % 100;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 716, "user_id": 6507170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EdjYE.png?s=128&g=1", "display_name": "priojeet priyom", "link": "https://stackoverflow.com/users/6507170/priojeet-priyom"}, "is_accepted": false, "score": 1, "last_activity_date": 1558549779, "creation_date": 1558549779, "answer_id": 56262931, "question_id": 56262630, "link": "https://stackoverflow.com/questions/56262630/read-digits-from-a-number-using-sscanf/56262931#56262931", "title": "Read digits from a number using sscanf", "body": "<p>Use x\u2105=100 to get the last two digits of the year.</p>\n\n<p>Use a check like y&lt;100 to make sure that y is less than or equals to 3 digits. More precisely yoy can write (y&lt;=12). One thing to notice here is, integer ignores leading zeros. So input \"05\" will be converted to 5.</p>\n\n<pre><code>char* str = \"2019/05/28\"; int x,y,z; \nsscanf(str, \"%d/%d/%d\", &amp;x, &amp;y, &amp;z);\n\nx%=100;\nif(y&lt;=12) {\n    //valid\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1558570231, "last_edit_date": 1558570231, "creation_date": 1558569840, "answer_id": 56266457, "question_id": 56262630, "link": "https://stackoverflow.com/questions/56262630/read-digits-from-a-number-using-sscanf/56266457#56266457", "title": "Read digits from a number using sscanf", "body": "<p>Read using <code>\"%n\"</code> to record the offset of the scan.</p>\n\n<p><code>\" %n%d%n\", &amp;n1, &amp;i, &amp;n2</code> leads to <code>n2-n1</code> is the character width of the numeric text for <code>x</code>.</p>\n\n<pre><code>int x1, x2;\nint y1, y2;\nint n = 0;\nsscanf(str, \" %n%d%n/ %n%d%n/%d %n\", &amp;x1, &amp;x, &amp;x2, &amp;y1, &amp;y, &amp;y2, &amp;z, &amp;n);\n\n// Was the string fully parsed with no trailing text?\nif (n &gt; 0 &amp;&amp; str[n] == 0) {\n  switch (x2-x1) {\n    case 2: /* 2 character date */ break;\n    case 4: /* 4 character date */ x %= 100; break;\n    default: return error;\n  }\n  if (y2 - y1 != 2) {  // I need to check the months are also in two digits  \n    return error;\n  }\n} else {\n  return error; \n}\n</code></pre>\n"}], "owner": {"reputation": 9866, "user_id": 1105805, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7a694594978a256520ac4d5b938aea5b?s=128&d=identicon&r=PG", "display_name": "Rasmi Ranjan Nayak", "link": "https://stackoverflow.com/users/1105805/rasmi-ranjan-nayak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 56262868, "answer_count": 3, "score": 0, "last_activity_date": 1558570231, "creation_date": 1558548492, "last_edit_date": 1558549927, "question_id": 56262630, "link": "https://stackoverflow.com/questions/56262630/read-digits-from-a-number-using-sscanf", "title": "Read digits from a number using sscanf", "body": "<p>I am trying to read/extract two digits number using <code>sscanf</code>.\nfacing some issues.</p>\n\n<pre><code>char* str = \"2019/05/28\";\nint x,y,z;\nsscanf(str, \"%d/%d/%d\", &amp;x, &amp;y, &amp;z);\nIt reurns me o/p as 2019, 05, 28 which is ok.\n</code></pre>\n\n<p>But <code>from 2019</code> I would like to extract only <code>19</code>.</p>\n\n<p>I tried <code>%2d</code> it returns <code>20</code>. And also I need to check the months are also in two digits i tried all possible ways but no luck yet.</p>\n\n<p>Please help.</p>\n\n<p>Update:\n<code>I also tried %2d%d -&gt; which gives me 19</code>.\nBut it is not sure whether I will be <code>getting 4 digits or 2 digits always</code>.</p>\n\n<p>Input could be <code>char* str = \"19/05/28\";</code></p>\n"}, {"tags": ["c++", "c", "shared-libraries", "static-libraries"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1558546190, "post_id": 56262079, "comment_id": 99140728, "body": "You need headers to see the declarations, a static stub library for the linker, and a dynamic library that can be accessed and loaded at runtime."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1558548303, "post_id": 56262079, "comment_id": 99141581, "body": "Short answer: Yes (and for both dynamic and static libraries)."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 1, "creation_date": 1558548435, "post_id": 56262079, "comment_id": 99141643, "body": "Your conclusion is almost correct. The compiler uses the declarations in .h to set up the calling structure, but you if you know them you can simply declare them yourself. :-)... Now when the compiler outputs the .o for a .c or a .cc you still have stubs (except the call stack for function calls is relatively okay). When the linker gets invoked, all .o and .a and even the .so (dynamic linking at runtime) resolve the &quot;relative addresses&quot; to actual addresses in memory of the final &quot;linked executable&quot; as it&#39;s loaded by the kernel upon <code>exec</code> using symbol lookups and other techniques."}, {"owner": {"reputation": 1599, "user_id": 9948091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JANyt.png?s=128&g=1", "display_name": "HAL9000", "link": "https://stackoverflow.com/users/9948091/hal9000"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1558548508, "post_id": 56262079, "comment_id": 99141675, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 a static stub library is as far as I know only needed on windows."}, {"owner": {"reputation": 471, "user_id": 2678241, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/us5mu.png?s=128&g=1", "display_name": "Dimitris Pantelis", "link": "https://stackoverflow.com/users/2678241/dimitris-pantelis"}, "reply_to_user": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1558602507, "post_id": 56262079, "comment_id": 99158373, "body": "@AhmedMasud thanks for the clear explanation. It was very useful :)"}], "owner": {"reputation": 471, "user_id": 2678241, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/us5mu.png?s=128&g=1", "display_name": "Dimitris Pantelis", "link": "https://stackoverflow.com/users/2678241/dimitris-pantelis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "closed_date": 1558546350, "answer_count": 0, "score": 0, "last_activity_date": 1558546102, "creation_date": 1558546102, "question_id": 56262079, "link": "https://stackoverflow.com/questions/56262079/to-use-shared-libraries-in-c-c-both-the-h-and-so-files-are-needed", "closed_reason": "Duplicate", "title": "To use shared libraries in C/C++, both the .h and .so files are needed?", "body": "<p>I have seen the answer to my question heavily implied but have not seen it somewhere written, hence I am making these questions (just to be sure I am correct).</p>\n\n<p>To use a shared library in a C/C++ program you need both the <strong>.h file</strong> and the <strong>.so file</strong>? (if I understand correctly, the compiler needs the .h file and the linker needs the .so file)</p>\n\n<p>As a bonus question, is this true for static (.a) libraries?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c", "time", "timer", "milliseconds", "seconds"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1558546538, "post_id": 56262069, "comment_id": 99140866, "body": "Have you looked into the <code>select()</code> function?"}, {"owner": {"reputation": 3305, "user_id": 1428695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a843c704cdb7e32a93769cddfed4747?s=128&d=identicon&r=PG", "display_name": "yhyrcanus", "link": "https://stackoverflow.com/users/1428695/yhyrcanus"}, "edited": false, "score": 0, "creation_date": 1558546580, "post_id": 56262069, "comment_id": 99140884, "body": "Have you tried using <code>clock</code> instead of <code>time</code>? You can calculate how much TIMEOUT is in cycles and use that instead."}, {"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1558546642, "post_id": 56262069, "comment_id": 99140906, "body": "sorry, but why do you need to call time? trying to send as fast as possible does not need a time... I don&#39;t get the question..."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1558546661, "post_id": 56262069, "comment_id": 99140914, "body": "You are only sending 1 byte at time, can you send a whole message? The UART should be able to hold at least 2 bytes: one being shifted, another in the output register."}, {"owner": {"reputation": 2016, "user_id": 5141989, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/3dPUW.jpg?s=128&g=1", "display_name": "Mike -- No longer here", "link": "https://stackoverflow.com/users/5141989/mike-no-longer-here"}, "edited": false, "score": 0, "creation_date": 1558726172, "post_id": 56262069, "comment_id": 99209394, "body": "I am able to do that because my target hardware waits to receive the whole message. I&#39;ll look into the clock function to see if it helps"}], "owner": {"reputation": 2016, "user_id": 5141989, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/3dPUW.jpg?s=128&g=1", "display_name": "Mike -- No longer here", "link": "https://stackoverflow.com/users/5141989/mike-no-longer-here"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558546040, "creation_date": 1558546040, "question_id": 56262069, "link": "https://stackoverflow.com/questions/56262069/setting-a-timeout-on-synchronous-file-write-without-wasting-microseconds-with-ti", "title": "Setting a timeout on synchronous file write without wasting microseconds with time()", "body": "<p>I'm currently interfacing my PC with a microcontroller that is very sensitive with timing. In fact, I'll be lucky if I have a couple dozen microseconds to play with between sending the last byte and waiting for a byte in return.</p>\n\n<p>What I am trying to do on the PC side is send the data to the microcontroller as fast as possible. This is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;fcntl.h&gt;\n\n#define TIMEOUT 5 //give the PC 5 seconds\n\nint main(){\n  int nwrite=0;\n  int fd=open(\"/dev/ttyS0\",O_NOCTTY | O_WRONLY); //open port\n  if (fd &gt; -1){\n    int start=time(NULL); //start clock\n    while (time(NULL)-start &lt; TIMEOUT &amp;&amp; nwrite == 0){\n      nwrite=write(fd,\"\\n\",1); //try outputting enter\n      if (nwrite &lt; 0){\n        close(fd); //close file because writing returned error\n        printf(\"Write Error\");\n        return -1;\n      }\n    }\n    close(fd); \n    if (nwrite != 0){\n       printf(\"Byte sent out\");\n    }\n  }else{\n    printf(\"Bad file\");\n  }\n  return 0;\n}\n</code></pre>\n\n<p>Even though this does the job, it doesn't do it fast enough. Here's my strace of the program from open to close:</p>\n\n<pre><code>13:22:04.160431 open(\"/dev/ttyS0\", O_WRONLY|O_NOCTTY) = 3\n13:22:04.160738 time(NULL)              = 1558545724\n13:22:04.160913 time(NULL)              = 1558545724\n13:22:04.161088 write(3, \"\\n\"..., 1)    = 1\n13:22:04.161278 time(NULL)              = 1558545724\n13:22:04.161450 close(3)                = 0\n</code></pre>\n\n<p>I noticed that those time commands take at least 100 microseconds each to process. Is there a different function I can use in place of time() to abort a write sequence if a timeout occurred? But that function needs to execute faster than the time() function.</p>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1558547706, "post_id": 56261893, "comment_id": 99141323, "body": "<code>while (!feof(fp))</code> is wrong: <a href=\"https://stackoverflow.com/q/5431941\">stackoverflow.com/q/5431941</a>"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1558548843, "post_id": 56261893, "comment_id": 99141819, "body": "You should check the return value of <code>fopen</code>: <code>if (!fp) goto err:</code>"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1558548871, "post_id": 56261893, "comment_id": 99141833, "body": "main should be <code>int main(void)</code>"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1558548889, "post_id": 56261893, "comment_id": 99141846, "body": "Please indent your code"}], "answers": [{"tags": [], "owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "is_accepted": false, "score": 0, "last_activity_date": 1558548719, "last_edit_date": 1558548719, "creation_date": 1558547603, "answer_id": 56262432, "question_id": 56261893, "link": "https://stackoverflow.com/questions/56261893/printing-specific-lines/56262432#56262432", "title": "Printing specific lines", "body": "<pre class=\"lang-c prettyprint-override\"><code>while (true) {\n        if (!fgets(str, sizeof(str), fp))\n                break;\n        if (sscanf(str, \"%d\u00b0%c\", &amp;n, &amp;c) != 2)\n                continue;\n        if (n &lt;= prev)\n                continue;\n        printf(\"%i%c\\n\", n, c);\n        prev = n;\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11421335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eccee62365dda6cde4041e7502576b5?s=128&d=identicon&r=PG&f=1", "display_name": "Corot", "link": "https://stackoverflow.com/users/11421335/corot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558549172, "creation_date": 1558545152, "last_edit_date": 1558549172, "question_id": 56261893, "link": "https://stackoverflow.com/questions/56261893/printing-specific-lines", "title": "Printing specific lines", "body": "<p>having a problem when trying to print specific lines of a .txt file.</p>\n\n<p>The contents of the file are</p>\n\n<pre><code>1\u00baAmsterdao\n\n1.1 PDI\nCasa de Anne Frank\n-Descricao: Museu biografico localizado na cidade de Amsterdao, capital dos Paises Baixos.\n-Horario de funcionamento: Abertura*7h Fecho*19h\n\n1.2 PDI\nMuseu Van Gogh\n-Descricao: Museu em Amsterdao, nos Paises Baixos. \n-Horario de funcionamento: Abertura*8h Fecho*18h\n\n1.3 PDI\nMuseu da Heineken\n-Descricao: Visita interativa pela historia da conhecida marca numa antiga cervejaria que termina numa sala de degusta\u00e7ao.\n-Horario de funcionamento: Abertura*10h Fecho*19\n\n2\u00baBangkok\n\n2.1 PDI\nGrande Palacio de Bangkok\n-Descricao: Conjunto de edificios em Bangkok, Tailandia, que serviu     como residencia oficial do rei de Tailandia.\n-Horario de funcionamento: Abertura*8h Fecho*15h\n</code></pre>\n\n<p>.\n.\n.</p>\n\n<p>And it goes up to the 20\u00ba. What I'm trying to print, is the first letter of the word in every line with the \"2\u00baBangkok\" format. The issue is that the file can me modified and can be added more of the \"PDI's\" like 1.4, 1.5 etc. so there is no way to know how many lines are in between.</p>\n\n<p>The way I'm trying to go about, is to get each char of a line, use atoi(), and then compare it to the number of line i printed earlier, so it will only print when the number is bigger.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n\n#define MAX_LENGTH 500\n\n\nint main () \n{\n\n    FILE *fp = fopen(\"save_projeto.txt\", \"r\");\n\n    char s[MAX_LENGTH];\n    int numero;\n    int numero_2;\n\n    while (!feof(fp)) {\n        fscanf(fp, \"%d\", &amp;numero);\n        printf(\"%d\", numero);\n        fgets(s, MAX_LENGTH, fp);\n        numero_2 = s[0];\n        printf(\"%c\\n\", s[1]);\n        while(numero_2 != (numero + 1)){\n            fgets(s, MAX_LENGTH, fp);\n            numero_2 = s[0];\n            atoi(numero_2);\n        }\n    }\n    fclose(fp);\n}\n</code></pre>\n\n<p>The output i expected was \"1A \\n 2B \\n 3C...\", and instead, the output I'm getting is \"1A \\n\".</p>\n"}, {"tags": ["c", "string", "buffer-overflow"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1558542694, "post_id": 56261333, "comment_id": 99139201, "body": "Make sure all your <code>char</code> arrays have enough room for the null terminator."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1558542731, "post_id": 56261333, "comment_id": 99139214, "body": "If <code>godiste</code> is a year, then it needs to be <code>char godiste[5]</code>. It needs 4 characters for the year, and 1 character for the null."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1558542920, "post_id": 56261333, "comment_id": 99139293, "body": "BTW, <code>(pok+i)-&gt;ime</code> and <code>(*(pok+i)).ime</code> are more simply written as <code>pok[i].ime</code>."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1558543455, "post_id": 56261333, "comment_id": 99139529, "body": "Your program, <b>with no changes</b> (other than adding the return type of <code>main</code>) appears to <a href=\"https://ideone.com/0c4eTg\" rel=\"nofollow noreferrer\">work as expected in ideone</a>"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1558544037, "post_id": 56261333, "comment_id": 99139801, "body": "Suggest this: <code>void upis(ptrdiff_t n, struct futbaler pok[static n])</code> so that you don&#39;t get crazy with pointers."}, {"owner": {"reputation": 2295, "user_id": 792779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99528e625676b23a593f5a3daa005793?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/792779/john"}, "edited": false, "score": 0, "creation_date": 1558544092, "post_id": 56261333, "comment_id": 99139834, "body": "Are you providing inputs that are longer than the number of characters allocated for each field? Keep in mind the terminating null characters. For example, <code>ime[15]</code> can only hold 14 characters of actual information, since the last character is a terminating null. If you put 15 characters into <code>ime</code> and then <code>printf</code> it, you&#39;ll see <code>ime</code> concatenated with <code>prezime</code> as you&#39;ve overwritten the separating null, as they are next to each other in your struct and in memory."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1558544125, "post_id": 56261333, "comment_id": 99139850, "body": "You don&#39;t need <code>pok</code>.  <code>igraci</code> can be passed to the functions as it decays to a pointer to its first element."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1558544395, "post_id": 56261333, "comment_id": 99139980, "body": "You should always use <code>BUFSIZ</code> as your standard buffer size, unless you have special needs such as a very big buffer, or little memory in an embedded system. That way you will not have to think about how much size you assign to a string. It is defined in <code>&lt;stdio.h&gt;</code> and is (around) 4096 if I remember well, so more than enough usually. If you need to fix a different size for the arrays, use a <code>#define</code> with an adequate name; that will make you think twice about the size you choose."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1558544706, "post_id": 56261333, "comment_id": 99140098, "body": "main should be <code>int main(void)</code>.  Compile with high warnings always, and only remove them when you know why.  In GCC that will be: <code>gcc -std=c17 -Wpedantic -Wall -Wextra -Werror</code>"}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1558588410, "post_id": 56268217, "comment_id": 99152170, "body": "<code>while (*s++ = *t++)</code>, suggest parentheses around assignment, <code>error: \u2018FALSE\u2019 undeclared</code>, suggest <code>#ifndef TRUE enum {FALSE = 0, TRUE = !FALSE} #endif</code> (<code>stdbool.h</code> defines <code>true</code> and <code>false</code> but not <code>TRUE</code> and <code>FALSE</code>), <code>void strncpy_</code> should be <code>char *strncpy_</code>. In <code>void clear_buffer()</code>, <code>n</code> is unused, it appears you intended <code>memset(buffer, 0, n);</code>. Last in <code>strtol</code> validation <code>errno != NULL</code> is a <code>comparison between integer and pointer</code>. Probably mostly copy/paste errors. Good effort."}, {"owner": {"reputation": 1053, "user_id": 7885081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZvVb.png?s=128&g=1", "display_name": "Jose Fernando Lopez Fernandez", "link": "https://stackoverflow.com/users/7885081/jose-fernando-lopez-fernandez"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1558590648, "post_id": 56268217, "comment_id": 99152778, "body": "Can&#39;t believe I missed all that; thank you for the corrections though, I appreciate it. Hopefully I didn&#39;t miss anything"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1558595892, "post_id": 56268217, "comment_id": 99154745, "body": "No problem, happens to us all. I just ran it through a compiler and let it help me find the issues <code>:)</code>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1558601336, "post_id": 56268217, "comment_id": 99157696, "body": "Another tweak to your <code>strdup_</code> function. Don&#39;t scan for end-of-string twice and don&#39;t call <code>realloc</code> in <code>strncpy_</code>, simply use <code>memcpy</code> in <code>strdup_</code>. You calculate <code>strlen(s)</code> with your <code>calloc</code> call. Move <code>size_t len = strlen (s);</code> above on its own, then <code>char *str = malloc (len + 1);</code> (no need for <code>calloc</code> you have the <i>nul-character</i> in <code>s</code>). Now just <code>return memcpy (str, s, len + 1);</code>."}, {"owner": {"reputation": 1053, "user_id": 7885081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZvVb.png?s=128&g=1", "display_name": "Jose Fernando Lopez Fernandez", "link": "https://stackoverflow.com/users/7885081/jose-fernando-lopez-fernandez"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1558625638, "post_id": 56268217, "comment_id": 99171421, "body": "Okay, I made the changes again. I removed the <code>strncpy_</code> function, which turned out to be superfluous after your changes, and I added the <code>munch</code> function, which eats the newline character in the input buffer after <code>fgets</code>. I really like your points on the <code>strdup_</code> refactor, I definitely didn&#39;t write that as cleanly as I could/should have."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1558633587, "post_id": 56268217, "comment_id": 99174979, "body": "That is one of the great things about this site. The little tips you get really help deepen and refine your understanding of C. All the tips I&#39;ve passed along were those that have been passed along to me over the past few years. Keep up the good work."}, {"owner": {"reputation": 1053, "user_id": 7885081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZvVb.png?s=128&g=1", "display_name": "Jose Fernando Lopez Fernandez", "link": "https://stackoverflow.com/users/7885081/jose-fernando-lopez-fernandez"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1558641212, "post_id": 56268217, "comment_id": 99178108, "body": "Thank you again for the code review, I really appreciate the insight"}], "tags": [], "owner": {"reputation": 1053, "user_id": 7885081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZvVb.png?s=128&g=1", "display_name": "Jose Fernando Lopez Fernandez", "link": "https://stackoverflow.com/users/7885081/jose-fernando-lopez-fernandez"}, "is_accepted": false, "score": 2, "last_activity_date": 1558625375, "last_edit_date": 1558625375, "creation_date": 1558586907, "answer_id": 56268217, "question_id": 56261333, "link": "https://stackoverflow.com/questions/56261333/structure-pointer-c-language/56268217#56268217", "title": "Structure pointer C language", "body": "<p>Edited for corrections pointed out by David C. Rankin.</p>\n\n<hr />\n\n<p>The compiler needs to know the length of your array at compile time in order to know how much memory to allocate on the stack. Otherwise, if you do it the way you're doing it right now, by asking the user how big to make the array and then stack-allocating it, you're using a feature known as Variable-Length Arrays (VLAs). This is not a good idea for security reasons.</p>\n\n<p>Having said that, your problem seems to stem from the fact that your year field is a four-character array. Character arrays are strings in C, and by convention they must be nul-terminated to indicate where they stop. Since you're writing a four character value (the year) in a space that can only hold four characters, the result is that the program isn't actually assigning the first element to the last of the previous; what's happening is that when it reads the last field of a struct, it doesn't find a nul terminator and reads right through it. Consequently, an array is a contiguous block of memory, and therefore it sees those two fields as one.</p>\n\n<p>Lastly, I highly recommend you use the more traditional way of dereferencing arrays. <code>arr[i]</code> is just syntactic sugar for <code>*(arr + i)</code>, but it's a lot easier to read. Not saying it's the root of the problem, but anything that makes your life easier is probably a good idea.</p>\n\n<hr />\n\n<p>This is my implementation of your problem.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stddef.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;limits.h&gt;\n\n#ifndef TRUE\nenum { FALSE= 0, TRUE = !FALSE };\n#endif\n\n#define MAX_LINE_LENGTH 80\n\n/* munch: remove newline from input buffer */\nvoid munch(char* s) {\n    size_t len = strlen(s);\n\n    for (size_t i = len - 1; i &gt;= 0; --i) {\n        if (s[i] == '\\n') {\n            s[i] = '\\0';\n            break;\n        }\n    }\n}\n\nvoid strcpy_(char* s, const char* t) {\n    while ((*s++ = *t++) != '\\0')\n        ;\n}\n\nchar* strdup_(const char* s) {\n    size_t len = strlen(s);\n    char* str = malloc((len + 1) * sizeof (char));\n\n    if (str == NULL) {\n        fprintf(stderr, \"[Error] Memory allocation failure\\n\");\n\n        exit(EXIT_FAILURE);\n    }\n\n    return memcpy(str, s, len + 1);\n}\n\nenum position_t {\n    POSITION_UNDEFINED,\n    POSITION_STRIKER,\n    POSITION_MIDFIELDER,\n    POSITION_DEFENDER,\n    POSITION_GOALKEEPER\n};\n\nconst char* position_striker_strings[] = {\n    \"Striker\",\n    \"striker\",\n    \"False 9\",\n    \"false 9\"\n};\n\nconst char* position_midfielder_strings[] = {\n    \"Midfielder\",\n    \"midfielder\",\n    \"Centerback\",\n    \"centerback\"\n};\n\nconst char* position_defender_strings[] = {\n    \"Defender\",\n    \"defender\",\n    \"Fullback\",\n    \"fullback\"\n};\n\nconst char* position_goalkeeper_strings[] = {\n    \"Goalkeeper\",\n    \"goalkeeper\",\n    \"Goalie\",\n    \"goalie\"\n};\n\nint position_read(const char* s) {\n    for (size_t i = 0; i &lt; (sizeof (position_striker_strings) / sizeof(const char*)); ++i) {\n        if (strcmp(s, position_striker_strings[i]) == 0)\n            return POSITION_STRIKER;\n    }\n\n    for (size_t i = 0; i &lt; (sizeof (position_midfielder_strings) / sizeof(const char*)); ++i) {\n        if (strcmp(s, position_midfielder_strings[i]) == 0)\n            return POSITION_MIDFIELDER;\n    }\n\n    for (size_t i = 0; i &lt; (sizeof (position_defender_strings) / sizeof(const char*)); ++i) {\n        if (strcmp(s, position_defender_strings[i]) == 0)\n            return POSITION_DEFENDER;\n    }\n\n    for (size_t i = 0; i &lt; (sizeof (position_goalkeeper_strings) / sizeof(const char*)); ++i) {\n        if (strcmp(s, position_goalkeeper_strings[i]) == 0)\n            return POSITION_GOALKEEPER;\n    }\n\n    return POSITION_UNDEFINED;\n}\n\nchar* position_str(int position) {\n    switch (position) {\n        case POSITION_STRIKER: {\n            return \"Striker\";\n        } break;\n\n        case POSITION_MIDFIELDER: {\n            return \"Midfielder\";\n        } break;\n\n        case POSITION_DEFENDER: {\n            return \"Defender\";\n        } break;\n\n        case POSITION_GOALKEEPER: {\n            return \"Goalkeeper\";\n        } break;\n\n        default: {\n            return \"Unknown Position Code\";\n        }\n    }\n}\n\nstruct player_t {\n    char* first_name;\n    char* last_name;\n    int position;\n    int year;\n};\n\nstruct player_t* player_allocate() {\n    struct player_t* player = calloc(1, sizeof(struct player_t));\n\n    if (player == NULL) {\n        fprintf(stderr, \"[Error] Memory allocation failure\\n\");\n\n        exit(EXIT_FAILURE);\n    }\n\n    return player;\n}\n\nstruct player_t* player_new(const char* first_name, const char* last_name, int position, int year) {\n    struct player_t* p = player_allocate();\n\n    p-&gt;first_name = strdup_(first_name);\n    p-&gt;last_name = strdup_(last_name);\n    p-&gt;position = position;\n    p-&gt;year = year;\n\n    return p;\n}\n\nvoid player_print(struct player_t* player) {\n    if (player == NULL)\n        return;\n\n    printf(\"\\t%s, %s\\n\", player-&gt;last_name, player-&gt;first_name);\n    printf(\"\\t\\tPosition: %s\\n\", position_str(player-&gt;position));\n    printf(\"\\t\\tYear: %d\\n\", player-&gt;year);\n}\n\nvoid player_list_print(struct player_t** player_list, size_t n) {\n    if (player_list == NULL)\n        return;\n\n    printf(\"\\n\\nPlayer List: \\n\\n\");\n\n    for (size_t i = 0; i &lt; n; ++i) {\n        if (player_list[i] == NULL)\n            continue;\n\n        player_print(player_list[i]);\n    }\n\n    printf(\"\\n\\n\");\n}\n\nvoid clear_buffer(char* buffer, size_t n) {\n    memset(buffer, 0, n * sizeof(char));\n}\n\nint main(void)\n{\n    char input_buffer[MAX_LINE_LENGTH];\n    clear_buffer(input_buffer, MAX_LINE_LENGTH);\n\n    printf(\"How many players would you like to enter? \");\n    fgets(input_buffer, MAX_LINE_LENGTH, stdin);\n\n    errno = 0;\n    char* endptr = NULL;\n    long n = strtol(input_buffer, &amp;endptr, 10);\n\n    if ((errno == ERANGE &amp;&amp; (n == LONG_MAX || n == LONG_MIN)) || (errno != 0 &amp;&amp; n == 0)) {\n        perror(\"strtol\");\n\n        return EXIT_FAILURE;\n    }\n\n    if (endptr == input_buffer) {\n        fprintf(stderr, \"No digits were found\\n\");\n\n        return EXIT_FAILURE;\n    }\n\n    printf(\"Enter %ld player(s).\\n\", n);\n\n    struct player_t** player_list = calloc(n, sizeof (struct player_t *));\n\n    for (size_t i = 0; i &lt; (size_t) n; ++i) {\n        player_list[i] = player_allocate();\n\n        printf(\"\\nFirst Name: \");\n        clear_buffer(input_buffer, MAX_LINE_LENGTH);\n        fgets(input_buffer, MAX_LINE_LENGTH, stdin);\n        munch(input_buffer);\n        player_list[i]-&gt;first_name = strdup_(input_buffer);\n\n        printf(\"Last Name: \");\n        clear_buffer(input_buffer, MAX_LINE_LENGTH);\n        fgets(input_buffer, MAX_LINE_LENGTH, stdin);\n        munch(input_buffer);\n        player_list[i]-&gt;last_name = strdup_(input_buffer);\n\n        printf(\"Position: \");\n        clear_buffer(input_buffer, MAX_LINE_LENGTH);\n        fgets(input_buffer, MAX_LINE_LENGTH, stdin);\n        munch(input_buffer);\n        player_list[i]-&gt;position = position_read(strdup_(input_buffer));\n\n        printf(\"Year: \");\n        clear_buffer(input_buffer, MAX_LINE_LENGTH);\n        fgets(input_buffer, MAX_LINE_LENGTH, stdin);\n        munch(input_buffer);\n        player_list[i]-&gt;year = atoi(input_buffer);\n    }\n\n    player_list_print(player_list, n);\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Program Execution:</p>\n\n<pre><code>How many players would you like to enter? 2\nEnter 2 player(s).\n\nFirst Name: Christiano \nLast Name: Ronaldo\nPosition: Striker\nYear: 1985\n\nFirst Name: Lionel\nLast Name: Messi\nPosition: striker\nYear: 1986\n\n\nPlayer List: \n\n    Ronaldo, Christiano\n        Position: Striker\n        Year: 1985\n    Messi, Lionel\n        Position: Striker\n        Year: 1986\n</code></pre>\n\n<p>You'll notice I wrote my own <code>strdup_</code> and <code>strcpy_</code> functions. I thought it would be interesting to see how they're implemented, and I also added some functionality to much newline and tab characters. This is because I prefer not to use <code>scanf</code>, and so I also included both <code>atoi</code> and <code>strtol</code> uses in this example.</p>\n\n<p>You'll also notice that <code>strtol</code> has a lot of error-checking involved while <code>atoi</code> does not; this is precisely why <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/atoi.html\" rel=\"nofollow noreferrer\">using atoi is not recommended</a>.</p>\n\n<p>Regarding the implementation, since the number of players in the list is indeterminate at compile time I used a double pointer called <code>player_list</code> to dynamically allocate each player. To do this, you have to first allocate the <code>player_list</code> pointer itself, then iterate through each pointer, individually allocating each player structure in turn.</p>\n\n<p>I also used an integer value for the position and an enumeration for the valid position values. When reading user input I then checked the valid position strings for a match, only adding a specific position if there was indeed a match. This is for data-validation purposes, so that users can't simply add new positions; that would be a database admin's job. Instead the player position is simply set to <code>POSITION_UNDEFINED</code> if a match is not found.</p>\n\n<p>The number of valid position strings is calculated based on the number of positions in the array, so you're free to add more valid strings in each position array without worrying about changing the position string matching code.</p>\n\n<hr />\n\n<p>If you simply wanted a basic implementation, you could actually just modify your code slightly to handle the year/terminator problem, and maybe change the name fields to pointers to handle names of any size. As it stands you're vulnerable to a stack overflow. I didn't look too carefully at your input mechanism, but I'm pretty sure there should be superfluous newlines in your input because of the newline character in the input buffer after a call to <code>scanf</code>. Might be something to look out for.</p>\n\n<p>Hope this helps, man. I translated the names in your code and if google translate is correct, it was Croatian. If that's true, congrats on getting to the Final last year. Good luck </p>\n"}], "owner": {"reputation": 21, "user_id": 11540508, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DFfrv7GjU8U/AAAAAAAAAAI/AAAAAAAAAps/Fc1Qq36BAOA/photo.jpg?sz=128", "display_name": "Petar Krstic", "link": "https://stackoverflow.com/users/11540508/petar-krstic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1558625375, "creation_date": 1558542615, "last_edit_date": 1558596220, "question_id": 56261333, "link": "https://stackoverflow.com/questions/56261333/structure-pointer-c-language", "title": "Structure pointer C language", "body": "<p>I\"m trying to load values into my structure but it's attaching the first element of every new structure to the last of the previous.</p>\n\n<p>Initially I had the 'godiste' field as an int and noticed it wasn't working so I changed it to a char and noticed that for some reason my input function 'upis' was attaching the value of the second member of igraci's 'Ime' to the first member's 'godiste'. Can't seem to figure out why this is happening.</p>\n\n<p>I put a printf in main that just prints the 'godiste' of igraci member 0 to make sure it wasn't an issue with my writing function 'ispis' and it is in fact making the value of 'godiste' the 'godiste' of member 0 + the 'ime' of member 1.</p>\n\n<p>'ime' is the player name\n'prezime' is the players last name\n'pozicija' is the players position\n'godiste' is the players birth year</p>\n\n<p>and 'igraci' is a list of players.</p>\n\n<p>The program first asks for the number of players you'd like to input then asks you for their details and prints out what you put in.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct futbaler\n    {\n        char ime[15];\n        char prezime[20];\n        char pozicija[15];\n        char godiste[4];\n    };\n\nvoid upis(struct futbaler* pok, int n)\n{\n    int i;\n\n    for(i=0; i&lt;n;i++)\n    {\n        printf(\"Ime igraca #%d: \",i+1);\n        scanf(\"%s\",(pok+i)-&gt;ime);\n        printf(\"Prezime igraca #%d: \",i+1);\n        scanf(\"%s\",(pok+i)-&gt;prezime);\n        printf(\"Pozicija igraca #%d: \",i+1);\n        scanf(\"%s\",(pok+i)-&gt;pozicija);\n        printf(\"Godiste igraca #%d: \",i+1);\n        scanf(\"%s\",(pok+i)-&gt;godiste);\n    }\n}\n\nvoid ispis(struct futbaler* pok, int n)\n{\n    int i;\n\n    for(i=0; i&lt;n;i++)\n    {\n        printf(\"\\nIme igraca #%d je: %s\\n\",i+1,(*(pok+i)).ime);\n        printf(\"\\nPrezime igraca #%d je: %s\\n\",i+1,(*(pok+i)).prezime);\n        printf(\"\\nPozicija igraca #%d je: %s\\n\",i+1,(*(pok+i)).pozicija);\n        printf(\"\\nGodiste igraca #%d je: %s\\n\",i+1,(*(pok+i)).godiste);\n    }\n}\n\nmain()\n{\n    int n;\n    printf(\"Koliko bi igraca uneli? \");\n    scanf(\"%d\",&amp;n);\n    struct futbaler* pok;\n    struct futbaler igraci[n];\n    pok = igraci;\n    upis(pok,n);\n    ispis(pok,n);\n\n    printf(\"%s\",igraci[0].godiste);\n}\n</code></pre>\n\n<p>I just want to figgure out why and how it's attaching these values that have nothing to do with eachother together.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1558542601, "post_id": 56261306, "comment_id": 99139159, "body": "Its <code>p-&gt;name[n]</code>"}, {"owner": {"reputation": 21, "user_id": 11525191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3089673346d744420a8199e3dd8f3a7?s=128&d=identicon&r=PG&f=1", "display_name": "seltkirk", "link": "https://stackoverflow.com/users/11525191/seltkirk"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1558542790, "post_id": 56261306, "comment_id": 99139241, "body": "@EugeneSh. I have to use pointers, I cannot use [] operator"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1558543079, "post_id": 56261306, "comment_id": 99139370, "body": "Then <code>*(p-&gt;name + n)</code>. Pretty stupid restriction I would say when working with arrays..."}, {"owner": {"reputation": 21, "user_id": 11525191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3089673346d744420a8199e3dd8f3a7?s=128&d=identicon&r=PG&f=1", "display_name": "seltkirk", "link": "https://stackoverflow.com/users/11525191/seltkirk"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1558543150, "post_id": 56261306, "comment_id": 99139404, "body": "@EugeneSh. It&#39;s work , thanks"}], "answers": [{"tags": [], "owner": {"reputation": 1804, "user_id": 11641278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2b7b58c2f619284b8f54d78b0b985e?s=128&d=identicon&r=PG", "display_name": "One Lyner", "link": "https://stackoverflow.com/users/11641278/one-lyner"}, "is_accepted": true, "score": 0, "last_activity_date": 1561626920, "creation_date": 1561626920, "answer_id": 56787764, "question_id": 56261306, "link": "https://stackoverflow.com/questions/56261306/how-can-i-get-access-to-single-chars-in-strings-that-are-saved-in-structure-whil/56787764#56787764", "title": "How can I get access to single chars in strings that are saved in structure while I only have pointer to this structure", "body": "<p>As EugeneSh commented: <code>*(p-&gt;name + n)</code></p>\n"}], "owner": {"reputation": 21, "user_id": 11525191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3089673346d744420a8199e3dd8f3a7?s=128&d=identicon&r=PG&f=1", "display_name": "seltkirk", "link": "https://stackoverflow.com/users/11525191/seltkirk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 56787764, "answer_count": 1, "score": 0, "last_activity_date": 1561626920, "creation_date": 1558542533, "question_id": 56261306, "link": "https://stackoverflow.com/questions/56261306/how-can-i-get-access-to-single-chars-in-strings-that-are-saved-in-structure-whil", "title": "How can I get access to single chars in strings that are saved in structure while I only have pointer to this structure", "body": "<p>I know title sounds weird but I didn't know how to write it. I have simple structure: </p>\n\n<pre><code>     struct student_t\n    {\n     char name[20];\n     char surname[40];\n     int index;\n    };\n</code></pre>\n\n<p>I also have function that have only one argument and it's pointer to this structure. I want to check single chars from string in structure but I don't know how to get to them.</p>\n\n<p>I tried few things       </p>\n\n<pre><code>      p-&gt;name\n</code></pre>\n\n<p>Prints whole string.</p>\n\n<pre><code>    *p-&gt;name \n</code></pre>\n\n<p>Prints first letter of string.</p>\n\n<p>I thought that by adding numbers to pointer , I can move through string.\nBut when I try to use </p>\n\n<pre><code>     *(p+n)-&gt;name \n</code></pre>\n\n<p>it prints 0. </p>\n\n<p>I'm new in C, feel free to hate.</p>\n"}, {"tags": ["c", "matlab"], "answers": [{"tags": [], "owner": {"reputation": 1814, "user_id": 3297440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b9a3c27ffed7a206aa03f34cde4bce?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Livingston", "link": "https://stackoverflow.com/users/3297440/ryan-livingston"}, "is_accepted": false, "score": 0, "last_activity_date": 1558739811, "creation_date": 1558739811, "answer_id": 56300423, "question_id": 56261276, "link": "https://stackoverflow.com/questions/56261276/how-to-display-matlab-variable-values-in-visual-studio-after-using-matlab-coder/56300423#56300423", "title": "How to display Matlab variable values in Visual Studio after using Matlab Coder?", "body": "<p>Try to use <code>fprintf</code> to print values in the generated code: <code>fprintf('Hello, World');</code>. <code>disp</code> and printing output by omitting a semicolon don't work in the generated code.</p>\n"}], "owner": {"reputation": 1430, "user_id": 5739619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dc9137cd10cc63c14d4c774bc81ef98a?s=128&d=identicon&r=PG&f=1", "display_name": "user5739619", "link": "https://stackoverflow.com/users/5739619/user5739619"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558739811, "creation_date": 1558542390, "question_id": 56261276, "link": "https://stackoverflow.com/questions/56261276/how-to-display-matlab-variable-values-in-visual-studio-after-using-matlab-coder", "title": "How to display Matlab variable values in Visual Studio after using Matlab Coder?", "body": "<p>I have a very basic Matlab program:</p>\n\n<p><code>hello.m</code>:</p>\n\n<pre><code>sprintf('hello')\ndisp(\"hello\")\n</code></pre>\n\n<p>I then convert it to C code using <code>codegen -config:dll hello -report</code> and <code>codegen -config:lib hello -report</code> </p>\n\n<p>I then run it in Visual Studio following the steps at : <a href=\"https://www.mathworks.com/help/coder/ug/use-a-c-dynamic-library-in-microsoft-visual-studio-project.html\" rel=\"nofollow noreferrer\">https://www.mathworks.com/help/coder/ug/use-a-c-dynamic-library-in-microsoft-visual-studio-project.html</a></p>\n\n<p>However, after I build and run it in VS, nothing is outputted. I have this as an example because I was hoping there was a way display the Matlab variables in VS. Is this possible?</p>\n"}, {"tags": ["c", "fopen"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1558540506, "post_id": 56260685, "comment_id": 99138014, "body": "Please state the environment. Depending on which OS you use, it might offer convenient help, e.g. <code>basename()</code>. Have look through Q/As here mentioning it."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 1473, "user_id": 4896472, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-okq5ETw24NA/AAAAAAAAAAI/AAAAAAAAAAk/BsBfA9ermIQ/photo.jpg?sz=128", "display_name": "TheChubbyPanda", "link": "https://stackoverflow.com/users/4896472/thechubbypanda"}, "edited": false, "score": 0, "creation_date": 1558540556, "post_id": 56260685, "comment_id": 99138035, "body": "@TheChubbyPanda Asking for a MCVE in case of a &quot;no idea&quot; or &quot;howto&quot; question is inappropriate. What gives you the impression that OP has any code?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1558540573, "post_id": 56260685, "comment_id": 99138044, "body": "I don&#39;t think standard C has any functions for parsing pathnames. You need to code your own or use OS-specific libraries."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1558540657, "post_id": 56260685, "comment_id": 99138088, "body": "@Yunnosch StackOverflow is not a free coding service. They&#39;re expected to <a href=\"https://meta.stackoverflow.com/questions/261592/how-much-research-effort-is-expected-of-stack-overflow-users\">try to solve the problem first</a>. So if they don&#39;t have an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, they haven&#39;t done the work to ask a proper question."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1558540718, "post_id": 56260685, "comment_id": 99138124, "body": "That&#39;s basic string manipulation that any beginner&#39;s C text book should cover. <a href=\"http://idownvotedbecau.se/noattempt/\" rel=\"nofollow noreferrer\">idownvotedbecau.se/noattempt</a>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1558540799, "post_id": 56260685, "comment_id": 99138187, "body": "@Barmar While you are generally right, it is not true that you cannot ask an appropriate question without an MCVE."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1558540938, "post_id": 56260685, "comment_id": 99138270, "body": "@Yunnosch True in general, but not for this kind of question."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1558540995, "post_id": 56260685, "comment_id": 99138294, "body": "@Barmar I am also trying to get OP to talk about their attempts..."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 1473, "user_id": 4896472, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-okq5ETw24NA/AAAAAAAAAAI/AAAAAAAAAAk/BsBfA9ermIQ/photo.jpg?sz=128", "display_name": "TheChubbyPanda", "link": "https://stackoverflow.com/users/4896472/thechubbypanda"}, "edited": false, "score": 0, "creation_date": 1558541390, "post_id": 56260685, "comment_id": 99138532, "body": "@TheChubbyPanda comments removed, you can remove your comment, I&#39;ll remove this comment too"}, {"owner": {"reputation": 31255, "user_id": 28494, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/c14ME.gif?s=128&g=1", "display_name": "qrdl", "link": "https://stackoverflow.com/users/28494/qrdl"}, "edited": false, "score": 0, "creation_date": 1558593681, "post_id": 56260685, "comment_id": 99153817, "body": "check <code>man strrchr</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1473, "user_id": 4896472, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-okq5ETw24NA/AAAAAAAAAAI/AAAAAAAAAAk/BsBfA9ermIQ/photo.jpg?sz=128", "display_name": "TheChubbyPanda", "link": "https://stackoverflow.com/users/4896472/thechubbypanda"}, "edited": false, "score": 2, "creation_date": 1558541128, "post_id": 56260843, "comment_id": 99138362, "body": "Avoid link centric questions. Perhaps you could provide some code to explain how this can be achieved."}, {"owner": {"reputation": 638, "user_id": 11510314, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pMx1ynQj3gg/AAAAAAAAAAI/AAAAAAAACAM/rrPnaXw0PRo/photo.jpg?sz=128", "display_name": "jsarbour", "link": "https://stackoverflow.com/users/11510314/jsarbour"}, "reply_to_user": {"reputation": 1473, "user_id": 4896472, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-okq5ETw24NA/AAAAAAAAAAI/AAAAAAAAAAk/BsBfA9ermIQ/photo.jpg?sz=128", "display_name": "TheChubbyPanda", "link": "https://stackoverflow.com/users/4896472/thechubbypanda"}, "edited": false, "score": 0, "creation_date": 1558541752, "post_id": 56260843, "comment_id": 99138734, "body": "I feel like I would only be taking code from the link (or others). Should I still do so?  Noting also the discussion above about MCVE, is it not wise to let the questioner read some documentation themselves?"}, {"owner": {"reputation": 1473, "user_id": 4896472, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-okq5ETw24NA/AAAAAAAAAAI/AAAAAAAAAAk/BsBfA9ermIQ/photo.jpg?sz=128", "display_name": "TheChubbyPanda", "link": "https://stackoverflow.com/users/4896472/thechubbypanda"}, "edited": false, "score": 0, "creation_date": 1558541932, "post_id": 56260843, "comment_id": 99138836, "body": "You can keep the link there but for others who find the post, it&#39;s more helpful for them if they have an actual answer on site."}, {"owner": {"reputation": 31255, "user_id": 28494, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/c14ME.gif?s=128&g=1", "display_name": "qrdl", "link": "https://stackoverflow.com/users/28494/qrdl"}, "edited": false, "score": 0, "creation_date": 1558593627, "post_id": 56260843, "comment_id": 99153790, "body": "Very inefficient, and modifies original string, which may not be acceptable for OP."}, {"owner": {"reputation": 638, "user_id": 11510314, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pMx1ynQj3gg/AAAAAAAAAAI/AAAAAAAACAM/rrPnaXw0PRo/photo.jpg?sz=128", "display_name": "jsarbour", "link": "https://stackoverflow.com/users/11510314/jsarbour"}, "reply_to_user": {"reputation": 31255, "user_id": 28494, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/c14ME.gif?s=128&g=1", "display_name": "qrdl", "link": "https://stackoverflow.com/users/28494/qrdl"}, "edited": false, "score": 0, "creation_date": 1558613982, "post_id": 56260843, "comment_id": 99164555, "body": "@qrdl how can I make it better?"}, {"owner": {"reputation": 31255, "user_id": 28494, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/c14ME.gif?s=128&g=1", "display_name": "qrdl", "link": "https://stackoverflow.com/users/28494/qrdl"}, "edited": false, "score": 0, "creation_date": 1558642686, "post_id": 56260843, "comment_id": 99178664, "body": "@jsarbour <code>strrchr()</code>"}], "tags": [], "owner": {"reputation": 638, "user_id": 11510314, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pMx1ynQj3gg/AAAAAAAAAAI/AAAAAAAACAM/rrPnaXw0PRo/photo.jpg?sz=128", "display_name": "jsarbour", "link": "https://stackoverflow.com/users/11510314/jsarbour"}, "is_accepted": true, "score": 1, "last_activity_date": 1558545534, "last_edit_date": 1558545534, "creation_date": 1558540738, "answer_id": 56260843, "question_id": 56260685, "link": "https://stackoverflow.com/questions/56260685/how-to-extract-the-final-part-of-the-file-path-in-c/56260843#56260843", "title": "How to extract the final part of the file path in C?", "body": "<p>Splice along a delimiter (here, \"/\"), and then grab the last element. Then create a string to use as the new filename based on that. Paraphrased from the link below;</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    char str[] = \"strtok splits once per call, call many times to split full string\";\n    int init_size = strlen(str);\n    char delim[] = \"/\";\n\n    char *ptr = strtok(str, delim);\n\n    while(ptr != NULL)\n    {\n        last = ptr //[p]oin[t]e[r]\n        ptr = strtok(NULL, delim);\n    }\n    strcat(\"newfile.\", last)\n\n    //open a file with that name, write to it, etc.\n\n    return 0;\n}\n</code></pre>\n\n<p>source: <a href=\"https://www.codingame.com/playgrounds/14213/how-to-play-with-strings-in-c/string-split\" rel=\"nofollow noreferrer\">https://www.codingame.com/playgrounds/14213/how-to-play-with-strings-in-c/string-split</a></p>\n\n<p>This will make \"last\" point at the last portion of the string after the final occurrence of the delimiter, so just the filename. You can then use strcat() to concatenate a string with it.</p>\n\n<p>If you want you have text.newfile.txt instead of newfile.text.txt, you can split the text.txt string again, this time along the \".\", and:</p>\n\n<pre><code>temp = strcat(original_filename, newfile)\nnew_filename = strcat(temp, original_file_extenstion)\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10139363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29409b3172e46e1c8549e74dce6a89d5?s=128&d=identicon&r=PG&f=1", "display_name": "jzpearson", "link": "https://stackoverflow.com/users/10139363/jzpearson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "accepted_answer_id": 56260843, "answer_count": 1, "score": -3, "last_activity_date": 1558545534, "creation_date": 1558540185, "question_id": 56260685, "link": "https://stackoverflow.com/questions/56260685/how-to-extract-the-final-part-of-the-file-path-in-c", "title": "How to extract the final part of the file path in C?", "body": "<p>I want to be able to find the final part of a final path and make a new file based on that. For example</p>\n\n<pre><code>/Users/use/Projects/projectname/test.txt\n</code></pre>\n\n<p>Based on that, i want to be able to create a new file that is called</p>\n\n<pre><code>test.newfile.txt\n</code></pre>\n\n<p>How would I do that?</p>\n"}, {"tags": ["php", "c", "wordpress", "gd"], "answers": [{"comments": [{"owner": {"reputation": 633, "user_id": 4991483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7497b65e89b56f60db16476b2ae491b?s=128&d=identicon&r=PG&f=1", "display_name": "PeteW", "link": "https://stackoverflow.com/users/4991483/petew"}, "edited": false, "score": 0, "creation_date": 1596179221, "post_id": 56261243, "comment_id": 111734511, "body": "Before doing this, check your PHP version <code>php -v</code> and then try (say) <code>apt-get install php7.3-gd</code>. Note you should be logged in as root on the machine to do this. Check it&#39;s installed with <code>php -i | grep gd</code>. Then you will need to run <code>service apache2 restart</code> afterwards"}], "tags": [], "owner": {"reputation": 3843, "user_id": 3112243, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1445506855/picture?type=large", "display_name": "Marc", "link": "https://stackoverflow.com/users/3112243/marc"}, "is_accepted": true, "score": 0, "last_activity_date": 1558542284, "creation_date": 1558542284, "answer_id": 56261243, "question_id": 56260554, "link": "https://stackoverflow.com/questions/56260554/how-to-install-the-gd-image-library-for-wordpress/56261243#56261243", "title": "How to Install the GD Image Library for Wordpress?", "body": "<p>The GD Library will need to be installed on the server that is hosting your website. This is not something that you can simply install in WordPress. The installation will depend on your server configuration and if you have access to do this.</p>\n\n<p>If you do not maintain your server, then you should reach out to your host for help with this issue.</p>\n\n<p>If you do manage your own server, you can install this yourself. Here are the commands that you would use to install the GD Library on an Ubuntu server that is running PHP 7. If your server is set up differently or running a different version of PHP then you would need to find the proper instructions. </p>\n\n<pre><code>$ apt-get update\n$ apt-get install php7.0-gd php7.0\n</code></pre>\n\n<p>Here are some further instructions: <a href=\"https://linoxide.com/linux-how-to/install-php7-gd-ubuntu-16-04/\" rel=\"nofollow noreferrer\">https://linoxide.com/linux-how-to/install-php7-gd-ubuntu-16-04/</a></p>\n"}], "owner": {"reputation": 137, "user_id": 9764728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1292a60ed974640c72fd73c16200e4de?s=128&d=identicon&r=PG&f=1", "display_name": "Tweak", "link": "https://stackoverflow.com/users/9764728/tweak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3381, "favorite_count": 0, "accepted_answer_id": 56261243, "answer_count": 1, "score": 1, "last_activity_date": 1596603267, "creation_date": 1558539788, "last_edit_date": 1558554260, "question_id": 56260554, "link": "https://stackoverflow.com/questions/56260554/how-to-install-the-gd-image-library-for-wordpress", "title": "How to Install the GD Image Library for Wordpress?", "body": "<p>Do you know how can I install <code>GD Library</code> for use it in <code>PHP files</code> of a <code>Wordpress</code> website?</p>\n\n<p>I'm creating my own captcha and I need this library to create my different images.</p>\n"}, {"tags": ["c", "openssl", "x509", "pki", "post-quantum-cryptography"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1570337691, "post_id": 56260518, "comment_id": 102878387, "body": "I don&#39;t think you will be able to do this at the moment. IANA has not reserved the parameters required for this. In particular, there&#39;s no OID for a PQ-safe hash that I am aware. That is, there is nothing standardized, like sha256WithRSAEncryption. Also see IANA&#39;s <a href=\"https://www.iana.org/assignments/smi-numbers/smi-numbers.xhtml\" rel=\"nofollow noreferrer\">smi-numbers</a>."}], "answers": [{"tags": [], "owner": {"reputation": 12010, "user_id": 23235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6281820b28d03f98e85bb3d901ae3f39?s=128&d=identicon&r=PG", "display_name": "Shane Powell", "link": "https://stackoverflow.com/users/23235/shane-powell"}, "is_accepted": true, "score": 1, "last_activity_date": 1558559367, "creation_date": 1558559367, "answer_id": 56265061, "question_id": 56260518, "link": "https://stackoverflow.com/questions/56260518/creating-x509-certificate-in-c-using-post-quantum-public-key-algorithm/56265061#56265061", "title": "Creating X509 certificate in C using post-quantum public key algorithm?", "body": "<p>The <a href=\"https://www.openssl.org/docs/man1.1.1/man7/evp.html\" rel=\"nofollow noreferrer\">EVP</a> API uses a \"ENGINE\" for it's implementation of all the symmetric algorithms (ciphers), digests and asymmetric algorithms (public key algorithms). A ENGINE module can be added / replaced.  See openssl <a href=\"https://www.openssl.org/docs/man1.1.1/man1/engine.html\" rel=\"nofollow noreferrer\">engine</a> command.</p>\n\n<p>I think this is the area you want to look into.  I don't think there is a lot of documentation around this area (that I could find) but there are sample engines you can look into.</p>\n\n<p>If you download the <a href=\"https://www.openssl.org/source/\" rel=\"nofollow noreferrer\">openssl source</a> you can look in the engines folder for sample engines you can use to start to implement you custom algorithm(s).</p>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 3, "user_id": 11109749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79b7716a4a18e6b3fa8d6b05f8ea511e?s=128&d=identicon&r=PG&f=1", "display_name": "LRubens", "link": "https://stackoverflow.com/users/11109749/lrubens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 56265061, "answer_count": 1, "score": 0, "last_activity_date": 1570337534, "creation_date": 1558539691, "last_edit_date": 1570337534, "question_id": 56260518, "link": "https://stackoverflow.com/questions/56260518/creating-x509-certificate-in-c-using-post-quantum-public-key-algorithm", "title": "Creating X509 certificate in C using post-quantum public key algorithm?", "body": "<p>I'm trying to implement a self signed x509 certificate that uses a post-quantum (PQ) public key algorithm as the public key algorithm. I looked at the openssl library in c, and the way it's done using RSA. I'm essentially trying to replicate the same format. From what I've seen in the openssl library, RSA and a couple of other supported algorithms are integrated in the crypto EVP layer (the key is stored as EVP_PKEY). The functions in the openssl library that I'm trying to use are X509_REQ_set_pubkey(X509_REQ *x, EVP_PKEY *pkey), and some other functions that have very similar inputs. Is there a way that I can integrate the PQ algorithm into the EVP layer? If not, is there any way around using the EVP layer that would achieve the same goal?</p>\n\n<p>I have tried looking into the evp source code in the openssl library. It seems it only supports certain algorithms such as RSA, EC... I'm not sure if it's possible to incorporate the PQ algorithm into the EVP layer. I'm following along the example in this link: (<a href=\"https://www.codepool.biz/how-to-use-openssl-to-generate-x-509-certificate-request.html\" rel=\"nofollow noreferrer\">https://www.codepool.biz/how-to-use-openssl-to-generate-x-509-certificate-request.html</a>) to generate the certificate. Instead of RSA key, I just plug in the PQ algorithm key. So far when I create my certificate, it's always outputted in the wrong format. </p>\n\n<p>I'm using this command: <code>openssl x509 -in x509Req.pem -text -noout</code> to read the certificate generate. It always shows the error message</p>\n\n<pre><code>unable to load certificate \\n 140688586052032:error:0906D06C:PEM routines:\nPEM_read_bio:no start line:../crypto/pem/pem_lib.c:691:Expecting: TRUSTED CERTIFICATE\n</code></pre>\n"}, {"tags": ["c", "signals"], "comments": [{"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1558540039, "post_id": 56260431, "comment_id": 99137768, "body": "<code>pause()</code> is the wrong tool for the job. Use <code>sigwait</code>/<code>sigwaitinfo</code>/<code>sigsuspend</code>. A couple more details over here: <a href=\"https://stackoverflow.com/questions/55190460/using-signals-in-a-child-process/55190889\" title=\"using signals in a child process\">stackoverflow.com/questions/55190460/&hellip;</a>"}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1558540234, "post_id": 56260431, "comment_id": 99137880, "body": "At the very least you have the arguments to <code>kill</code> in the wrong order."}], "answers": [{"tags": [], "owner": {"reputation": 51391, "user_id": 132382, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20fc7ee8f405aa42e36eb73e841e5a36?s=128&d=identicon&r=PG", "display_name": "pilcrow", "link": "https://stackoverflow.com/users/132382/pilcrow"}, "is_accepted": true, "score": 0, "last_activity_date": 1558542571, "creation_date": 1558542571, "answer_id": 56261321, "question_id": 56260431, "link": "https://stackoverflow.com/questions/56260431/i-try-using-signals-and-the-pause-function-in-c-in-my-college-homework-but-to/56261321#56261321", "title": "I try using signals and the pause() function in c in my college homework but to no avail", "body": "<p><strong>Short Answer</strong></p>\n\n<p>Your arguments to <code>kill</code> are swapped, as <a href=\"https://stackoverflow.com/users/204883/arkku\">@Arkku</a> noted in the comments.  Your \"main process\" waits forever for a SIGUSR2 from its very first child, which it never receives.</p>\n\n<hr>\n\n<p><strong>Aside</strong></p>\n\n<p>Ha! An assignment about race conditions given in the language of races (la carrera, le se\u00f1al de competici\u00f3n).  That's great.</p>\n\n<p>If I understand correctly, the desired flow is something like this:</p>\n\n<pre><code>                         +--&gt; [competitor]\n                         +--&gt; [competitor]\n[starter] --&gt; [manager] -+--&gt; [competitor]\n                         +--&gt; [competitor]\n</code></pre>\n\n<ol>\n<li><em>Starter</em> creates <em>manager</em></li>\n<li><em>Manager</em> gets <em>competitors</em> to the starting line\n\n<ol>\n<li>Create a <em>competitor</em></li>\n<li>Wait for the <em>competitor</em> to indicate it is ready (SIGUSR2)</li>\n<li>Repeat for N_PROC <em>competitors</em> total</li>\n</ol></li>\n<li><em>Manager</em> tells the <em>starter</em> that <em>competitors</em> are ready (SIGUSR2)</li>\n<li><em>Starter</em> fires the <a href=\"https://en.wikipedia.org/wiki/Starting_pistol\" rel=\"nofollow noreferrer\">starting pistol</a> (SIGUSR1 to <em>process group</em>)</li>\n<li><em>Competitors</em> race!</li>\n<li><em>Manager</em> process terminates after reaping all <em>competitors</em>.</li>\n<li><em>Starter</em> terminates after reaping <em>manager</em>.</li>\n</ol>\n\n<p>Several things can go wrong here.  Notably, <a href=\"https://stackoverflow.com/users/1084774/pskocik\">@PSkocik</a>'s comment is right:  <a href=\"https://stackoverflow.com/a/55190889/132382\">you should use <code>sigwait</code> or similar functions to avoid unintended races</a>.  Also, please don't <a href=\"https://stackoverflow.com/questions/16891019/how-to-avoid-using-printf-in-a-signal-handler\">use <code>printf</code> in a signal handler</a>.  </p>\n"}], "owner": {"reputation": 53, "user_id": 11517255, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MOVdfTL4yuE/AAAAAAAAAAI/AAAAAAAAAJI/pYbPMgXOBUk/photo.jpg?sz=128", "display_name": "Veraeldr Atmyrkr", "link": "https://stackoverflow.com/users/11517255/veraeldr-atmyrkr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 56261321, "answer_count": 1, "score": 0, "last_activity_date": 1558542571, "creation_date": 1558539370, "question_id": 56260431, "link": "https://stackoverflow.com/questions/56260431/i-try-using-signals-and-the-pause-function-in-c-in-my-college-homework-but-to", "title": "I try using signals and the pause() function in c in my college homework but to no avail", "body": "<p>The following program is supposed to do this:</p>\n\n<ol>\n<li>The main process should create a child process,which I will refer to as <strong>main child</strong> from now on for convenience,then wait for a SIGUSR2 signal, then send a SIGUSR1 signal to his child and grandchildren, then wait for his child and finally end.</li>\n<li>The main child should do the following 4 times: create a child and wait for SIGUSR2. After that the process should send a SIGUSR2 to his father,then wait for SIGUSR1, then wait for his children to end and finally end.</li>\n<li>The main child's children should print <em>Proceso \"PID\" listo</em>,then send a SIGUSR2 to the main child,then wait for SIGUSR1,then print <em>Se\u00f1al capturada</em> and finally end.</li>\n</ol>\n\n<p>However it just prints one PID and then it never ends unless I use CTRL^C.I've tried changing the order of the pause() fucntions but to no avail. Also this is homework for college and they said we can't use semaphores yet.</p>\n\n<p>If you know Spanish here are the instructions:</p>\n\n<p>\u2022 El proceso padre generar\u00e1 un proceso hijo, que ser\u00e1 el proceso gestor.</p>\n\n<p>\u2022 El proceso gestor crear\u00e1 N_PROC procesos hijos (los participantes en la competici\u00f3n) en un\nbucle, esperando tras crear cada proceso a que \u00e9ste le notifique que est\u00e1 preparado\nenvi\u00e1ndole la se\u00f1al SIGUSR2 .</p>\n\n<p>\u2022 Cada participante en la carrera, una vez activo y con la se\u00f1al armada, imprimir\u00e1 un mensaje\ny avisar\u00e1 al gestor mediante la se\u00f1al SIGUSR2 .</p>\n\n<p>\u2022 El proceso gestor, cuando haya creado los N_PROC procesos hijos y \u00e9stos est\u00e9n listos para la\ncompetici\u00f3n, avisar\u00e1 al proceso padre de que est\u00e1 todo listo envi\u00e1ndole la se\u00f1al SIGUSR2 .</p>\n\n<p>\u2022 El proceso padre mandar\u00e1 al grupo entero de procesos la se\u00f1al\nde la competici\u00f3n).</p>\n\n<p>\u2022 Cuando los participantes en la carrera reciban la se\u00f1al\nya han capturado la se\u00f1al, y terminar\u00e1n.</p>\n\n<p>\u2022 Cuando el proceso gestor reciba SIGUSR1 , terminar\u00e1 su ejecuci\u00f3n sin dejar hijos hu\u00e9rfanos.</p>\n\n<p>\u2022 El proceso padre esperar\u00e1 a que el proceso gestor termine y acabar\u00e1 \u00e9l tambi\u00e9n.</p>\n\n<p>Thanks in advance.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n\n#define N_PROC 4\n\n\nvoid manejador_SIGUSR1(int sig) {\n    printf(\"Se\u00f1al capturada\\n\");\n    exit(EXIT_SUCCESS);\n}\n\nvoid manejador_SIGUSR2(int sig) {\n\n}\n\nint main(void){\n    int i,pid[N_PROC+1];\n    struct sigaction act;\n\n    sigemptyset(&amp;(act.sa_mask));\n    act.sa_flags = 0;\n\n    /* Se arma la se\u00f1al SIGUSR1. */\n    act.sa_handler = manejador_SIGUSR1;\n    if (sigaction(SIGUSR1, &amp;act, NULL) &lt; 0) {\n        perror(\"sigaction\");\n        exit(EXIT_FAILURE);\n    }\n\n    act.sa_handler = manejador_SIGUSR2;\n    if (sigaction(SIGUSR2, &amp;act, NULL) &lt; 0) {\n        perror(\"sigaction\");\n        exit(EXIT_FAILURE);\n    }\n\n\n\n    if((pid[0] = fork()) == -1) {\n        perror(\"fork\");\n        exit(EXIT_FAILURE);\n      }\n\n    if(pid[0] == 0) {\n        for(i=0;i&lt;N_PROC;i++){\n            if((pid[i+1] = fork()) == -1) {\n                perror(\"fork\");\n                exit(EXIT_FAILURE);\n             }\n            if(pid[i+1]==0){\n                printf(\"Proceso %d listo\\n\",getpid());\n                kill(SIGUSR2,getppid());\n                pause();\n\n            }\n\n            else{\n                pause();\n\n            }\n\n        }\n        kill(SIGUSR2,getppid());\n        pause();\n        while(wait(NULL)&gt;0);\n        exit(EXIT_SUCCESS);\n\n    }\n\n    pause();\n    kill(SIGUSR1,0);\n    while(wait(NULL)&gt;0);\n    exit(EXIT_SUCCESS);\n}\n\n</code></pre>\n"}, {"tags": ["c", "gcc", "intermediate-language"], "answers": [{"comments": [{"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1558544786, "post_id": 56260412, "comment_id": 99140130, "body": "You mean, when it arrives in SSA stage the ssa is passed to some semantic analysis tool that is included in GCC to check for <code>&#39;strncpy&#39; output may be truncated</code> ?  How can I know what tool is it and what functionality that tool has ?"}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1558546798, "post_id": 56260412, "comment_id": 99140961, "body": "There are about 60 files <code>tree-ssa-*</code>.  They are part of Standard Library ? The Standard Library is part of the compiler ?"}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1558547315, "post_id": 56260412, "comment_id": 99141172, "body": "I asked as I am interested to understand how the semantic checking is done at that level, not necessarily how gcc does in particular.  If you can detail the logic/algorithm for semantic checking that is used by clang it&#39;s interesting."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1558548154, "post_id": 56260412, "comment_id": 99141523, "body": "The files <code>tree-ssa-*</code> are not the implementations of the standard library functions. Usually these functions are implemented separately as a part of libc (gcc&#39;s version is  glibc and clang inherits from the compiler that was used to compile it). The files I pointed to implementations of specially handling these functions because the compiler identifies these functions and tries to put extra checks or tries to optimize it by replacing it with intrinsics."}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1558548511, "post_id": 56260412, "comment_id": 99141676, "body": "Ah, it tries to replace some calls to standard library with some simpler inline sequences that follow the <code>as-if rule</code> and simulate the behavior of standard library -- correct ?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1558549698, "post_id": 56260412, "comment_id": 99142223, "body": "@alinsoar yes, atleast in clang many standard library functions (including string and memset, memcpy etc) are replaced with builtin intrinsics. The lowering mechanism then decides what is the right way to lower these. For example, for memcpy of fixed size (say 8 bytes), it is better to insert 2 mov instructions rather than insert a call. Or for slightly larger sizes, it sometimes inserts an unrolled loop. All these decisions are based on cost models specific for the target architecture."}], "tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": true, "score": 2, "last_activity_date": 1558539279, "creation_date": 1558539279, "answer_id": 56260412, "question_id": 56260253, "link": "https://stackoverflow.com/questions/56260253/debug-low-level-gcc-intermediate-code-representations/56260412#56260412", "title": "debug low level gcc intermediate code representations", "body": "<p>Your error/warning seems to be originating from <a href=\"https://github.com/gcc-mirror/gcc/blob/917baa6b396855a452d1b2efb3947c43257f83e4/gcc/tree-ssa-strlen.c#L2066\" rel=\"nofollow noreferrer\">here</a>.\nIf I understand correctly, this is from the SSA form generation phase.</p>\n\n<p>Also <a href=\"https://stackoverflow.com/questions/1496497/how-can-i-see-parse-tree-intermediate-code-optimization-code-and-assembly-code\">this</a> question might provide useful hints on how to dump different intermediate representations for <code>gcc</code>. I know how to do it for <code>clang</code>, but your issue seems be to specific to <code>gcc</code>. </p>\n"}], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 56260412, "answer_count": 1, "score": 0, "last_activity_date": 1558539279, "creation_date": 1558538769, "question_id": 56260253, "link": "https://stackoverflow.com/questions/56260253/debug-low-level-gcc-intermediate-code-representations", "title": "debug low level gcc intermediate code representations", "body": "<p>In connection with <a href=\"https://stackoverflow.com/questions/56253996/why-does-gcc-9-1-0-sometimes-complain-about-this-use-of-strncpy\">this question</a> I have another question.</p>\n\n<p>I managed to reproduce it and I do not copy paste the code here again, as you can find the code. I paste only the output of compilation on my computer.</p>\n\n<pre><code>% gcc -std=c11 -O3 -g -Wall -Wextra -Werror -USUPPRESS_BUG  -c  msg_gcc.c\nmsg_gcc.c: In function 'function_under_test':\nmsg_gcc.c:30:9: error: 'strncpy' output may be truncated copying 128 bytes from a string of length 128 [-Werror=stringop-truncation]\n         strncpy(name, name_in_queue, SERVERNAME_LEN);\n         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\ncc1: all warnings being treated as errors\n-root-@ @...| test | stub\n% gcc --version\ngcc (GCC) 8.2.1 20181127\nCopyright (C) 2018 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\n-root-@ @...| test | stub\n% cat /proc/version\nLinux version 5.0.7-arch1-1-ARCH (builduser@heftig-20167) (gcc version 8.2.1 20181127 (GCC)) #1 SMP PREEMPT Mon Apr 8 10:37:08 UTC 2019\n-root-@ @...| test | stub\n</code></pre>\n\n<p>I wish I would understand in which stage the compiler detects this kind of library issue.  I know that the code is transformed in lots of intermediate languages, like generic, gimple, ssa, rtl, combinators, etc, etc but I do not know in which of these representations the code is checked for issues like this one from this compilation command.</p>\n\n<p>If I want to debug the intermediate representations and discover the presence of this issue what parameters should I pass gcc such that it stops the generation of intermediate languages as close as possible before this warning to be generated ?</p>\n"}, {"tags": ["c", "linux", "gtk3"], "comments": [{"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1558542458, "post_id": 56260183, "comment_id": 99139106, "body": "You should consider using <a href=\"https://developer.gnome.org/gtk3/stable/GtkStack.html\" rel=\"nofollow noreferrer\">GtkStack</a>. Also, you should have a <code>GtkMenu</code> and connect the item click/select callbacks to a function that sets the visible child of the stack. I have written an answer <a href=\"https://developer.gnome.org/gtk3/stable/GtkStack.html\" rel=\"nofollow noreferrer\">here</a>   on how to do it with <code>Gtkmm&#47;Gtk::Builder</code>. Hope that helps too."}], "answers": [{"tags": [], "owner": {"reputation": 698, "user_id": 1981374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1afd547bb1f448490439e0093eba3a70?s=128&d=identicon&r=PG", "display_name": "pan-mroku", "link": "https://stackoverflow.com/users/1981374/pan-mroku"}, "is_accepted": false, "score": 2, "last_activity_date": 1558609396, "creation_date": 1558609396, "answer_id": 56273833, "question_id": 56260183, "link": "https://stackoverflow.com/questions/56260183/how-do-i-switch-between-windows-in-c-on-linux-with-gtk3/56273833#56273833", "title": "How do I switch between windows in c on linux with gtk3", "body": "<p>Use <a href=\"https://developer.gnome.org/gtk3/3.24/GtkWidget.html#gtk-widget-show-all\" rel=\"nofollow noreferrer\">gtk_widget_show_all</a> in <a href=\"https://developer.gnome.org/gobject/2.60/howto-signals.html\" rel=\"nofollow noreferrer\">signal handler</a>:</p>\n\n<pre><code>#include &lt;gtk/gtk.h&gt;\n\nvoid clicked(GtkWidget* sender, GtkWindow* window)\n{\n    gtk_widget_hide(gtk_widget_get_toplevel(sender));\n    gtk_widget_show_all(GTK_WIDGET(window));\n}\n\nint main (int argc, char *argv[])\n{\n    gtk_init (&amp;argc, &amp;argv);\n    GtkButton* button1, *button2, *button3, *button4;\n    GtkWindow* window1, *window2, *window3;\n    GtkLabel* label1, *label2, *label3;\n    GtkBox *box1, *box2, *box3;\n\n    window1 = GTK_WINDOW(gtk_window_new(GTK_WINDOW_TOPLEVEL));\n    window2 = GTK_WINDOW(gtk_window_new(GTK_WINDOW_TOPLEVEL));\n    window3 = GTK_WINDOW(gtk_window_new(GTK_WINDOW_TOPLEVEL));\n    //----------------------------------------------------\n    button1 = GTK_BUTTON(gtk_button_new());\n    g_signal_connect(button1, \"clicked\", G_CALLBACK(clicked), window2);\n    button2 = GTK_BUTTON(gtk_button_new());\n    g_signal_connect(button2, \"clicked\", G_CALLBACK(clicked), window3);\n\n    box1 = GTK_BOX(gtk_box_new(GTK_ORIENTATION_VERTICAL, 0));\n    label1 = GTK_LABEL(gtk_label_new(\"splash\"));\n    gtk_container_add(GTK_CONTAINER(box1), GTK_WIDGET(label1));\n    gtk_container_add(GTK_CONTAINER(box1), GTK_WIDGET(button1));\n    gtk_container_add(GTK_CONTAINER(box1), GTK_WIDGET(button2));\n    gtk_container_add(GTK_CONTAINER(window1), GTK_WIDGET(box1));\n    gtk_widget_show_all(GTK_WIDGET(window1));\n\n    //----------------------------------------------------\n    button3 = GTK_BUTTON(gtk_button_new());\n    g_signal_connect(button3, \"clicked\", G_CALLBACK(clicked), window1);\n\n    box2 = GTK_BOX(gtk_box_new(GTK_ORIENTATION_VERTICAL, 0));\n    label2 = GTK_LABEL(gtk_label_new(\"window1\"));\n    gtk_container_add(GTK_CONTAINER(box2), GTK_WIDGET(label2));\n    gtk_container_add(GTK_CONTAINER(box2), GTK_WIDGET(button3));\n    gtk_container_add(GTK_CONTAINER(window2), GTK_WIDGET(box2));\n\n    //----------------------------------------------------\n    button4 = GTK_BUTTON(gtk_button_new());\n    g_signal_connect(button4, \"clicked\", G_CALLBACK(clicked), window1);\n\n    box3 = GTK_BOX(gtk_box_new(GTK_ORIENTATION_VERTICAL, 0));\n    label3 = GTK_LABEL(gtk_label_new(\"window2\"));\n    gtk_container_add(GTK_CONTAINER(box3), GTK_WIDGET(label3));\n    gtk_container_add(GTK_CONTAINER(box3), GTK_WIDGET(button4));\n    gtk_container_add(GTK_CONTAINER(window3), GTK_WIDGET(box3));\n\n    //----------------------------------------------------\n    gtk_main();\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8857347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48dd27a60d4ae248f34fcfed0fc756bf?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/8857347/bill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558609396, "creation_date": 1558538556, "last_edit_date": 1558538812, "question_id": 56260183, "link": "https://stackoverflow.com/questions/56260183/how-do-i-switch-between-windows-in-c-on-linux-with-gtk3", "title": "How do I switch between windows in c on linux with gtk3", "body": "<p>I have a c application running under linux \nit has one window which loads on startup  ( window 0 )\nit is supposed to call any one of 4 windows ( window 1 - 4 )</p>\n\n<p>my problem is I cannot figure out how to call the secondary window and switch to it. </p>\n\n<p>Any help would be appreciated.</p>\n\n<p>in S0.glade I have 4 buttons each calls a diff routine that is supposed to load one of the 4 windows.  </p>\n\n<p>I am just not sure how to do it.  I have been googling for 3 days and have not come up with what I need.  Tried alot but no luck.\nthis is my first attempt at anything with gtk.   Just moving overfrom VB.net under windows and am lost...</p>\n\n<p>my code looks like this  in my main loop</p>\n\n<pre><code>int main(int argc, char * argv[])\n{\n\n    GtkBuilder      *builder; \n\n    /* init threads */\n    gtk_init(&amp;argc, &amp;argv);\n\n    builder = gtk_builder_new();\n    gtk_builder_add_from_file (builder, \"S0.glade\", NULL);\n    gtk_builder_add_from_file (builder, \"S1.glade\", NULL);\n    gtk_builder_add_from_file (builder, \"S2.glade\", NULL);\n    gtk_builder_add_from_file (builder, \"S3.glade\", NULL);\n\n    window = GTK_WIDGET(gtk_builder_get_object(builder, \"Mini\"));\n\n    g_lblStatus1 = GTK_WIDGET(gtk_builder_get_object(builder, \"lblStatus1\"));\n    g_lblStatus2 = GTK_WIDGET(gtk_builder_get_object(builder, \"lblStatus2\"));\n    g_lblStatus3 = GTK_WIDGET(gtk_builder_get_object(builder, \"lblStatus3\"));\n    g_lblStatus4 = GTK_WIDGET(gtk_builder_get_object(builder, \"lblStatus4\"));\n\n    g_T1_Size = GTK_WIDGET(gtk_builder_get_object(builder, \"T1_Size\"));\n    g_T2_Size = GTK_WIDGET(gtk_builder_get_object(builder, \"T2_Size\"));\n    g_T3_Size = GTK_WIDGET(gtk_builder_get_object(builder, \"T3_Size\"));\n    g_T4_Size = GTK_WIDGET(gtk_builder_get_object(builder, \"T4_Size\"));\n    g_T5_Size = GTK_WIDGET(gtk_builder_get_object(builder, \"T5_Size\"));\n    g_T6_Size = GTK_WIDGET(gtk_builder_get_object(builder, \"T6_Size\"));\n\n    g_S_1_Status = GTK_WIDGET(gtk_builder_get_object(builder, \"S_1_Status\"));\n    g_S_2_Status = GTK_WIDGET(gtk_builder_get_object(builder, \"S_2_Status\"));\n    g_S_3_Status = GTK_WIDGET(gtk_builder_get_object(builder, \"S_3_Status\"));\n    g_S_4_Status = GTK_WIDGET(gtk_builder_get_object(builder, \"S_4_Status\"));\n    g_S_5_Status = GTK_WIDGET(gtk_builder_get_object(builder, \"S_5_Status\"));\n    g_S_6_Status = GTK_WIDGET(gtk_builder_get_object(builder, \"S_6_Status\"));\n\n    g_P_1 = GTK_WIDGET(gtk_builder_get_object(builder, \"P_1\"));\n    g_P_2 = GTK_WIDGET(gtk_builder_get_object(builder, \"P_2\"));\n    g_P_3 = GTK_WIDGET(gtk_builder_get_object(builder, \"P_3\"));\n    g_P_4 = GTK_WIDGET(gtk_builder_get_object(builder, \"P_4\"));\n    g_P_5 = GTK_WIDGET(gtk_builder_get_object(builder, \"P_5\"));\n    g_P_6 = GTK_WIDGET(gtk_builder_get_object(builder, \"P_6\"));\n\n    g_V_1 = GTK_WIDGET(gtk_builder_get_object(builder, \"V_1\"));\n    g_V_2 = GTK_WIDGET(gtk_builder_get_object(builder, \"V_2\"));\n    g_V_3 = GTK_WIDGET(gtk_builder_get_object(builder, \"V_3\"));\n    g_V_4 = GTK_WIDGET(gtk_builder_get_object(builder, \"V_4\"));\n    g_V_5 = GTK_WIDGET(gtk_builder_get_object(builder, \"V_5\"));\n    g_V_6 = GTK_WIDGET(gtk_builder_get_object(builder, \"V_6\"));\n\n    g_CSLN = GTK_WIDGET(gtk_builder_get_object(builder, \"CSLN\"));\n    g_CBLN = GTK_WIDGET(gtk_builder_get_object(builder, \"CBLN\"));\n    g_CS_Volume = GTK_WIDGET(gtk_builder_get_object(builder, \"CS_Volume\"));\n    g_CB_Volume = GTK_WIDGET(gtk_builder_get_object(builder, \"CB_Volume\"));\n\n    g_Q_1 = GTK_WIDGET(gtk_builder_get_object(builder, \"Q_1\"));\n    g_Q_2 = GTK_WIDGET(gtk_builder_get_object(builder, \"Q_2\"));\n    g_Q_3 = GTK_WIDGET(gtk_builder_get_object(builder, \"Q_3\"));\n    g_Q_4 = GTK_WIDGET(gtk_builder_get_object(builder, \"Q_4\"));\n    g_Q_5 = GTK_WIDGET(gtk_builder_get_object(builder, \"Q_5\"));\n    g_Q_6 = GTK_WIDGET(gtk_builder_get_object(builder, \"Q_6\"));\n\n     // Images\n    g_img1 = (GtkImage *)gtk_builder_get_object(builder, \"img1\");\n    g_img2 = (GtkImage *)gtk_builder_get_object(builder, \"img2\");\n    g_img3 = (GtkImage *)gtk_builder_get_object(builder, \"img3\");\n    g_img4 = (GtkImage *)gtk_builder_get_object(builder, \"img4\");\n    g_img5 = (GtkImage *)gtk_builder_get_object(builder, \"img5\");\n    g_img6 = (GtkImage *)gtk_builder_get_object(builder, \"img6\");\n    g_img7 = (GtkImage *)gtk_builder_get_object(builder, \"img7\");\n\n    gtk_builder_connect_signals(builder, NULL);\n        g_object_unref(builder);\n        gtk_widget_show(window);                \n\n        Set_Filler_Images();\n\n        gtk_main();\n\n    return 0;\n}\n</code></pre>\n\n<p>I want it to call say window 1 from the button on S0.glade and have it active.<br>\nthe coding I showed is common to S1, s2, and S3 glade files.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1558538423, "post_id": 56260102, "comment_id": 99136866, "body": "To compare against the \\ character, simply use the escape sequence <code>&#39;\\\\&#39;</code>. As demonstrated in the beginner-level C book, chapter strings."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1558538524, "post_id": 56260102, "comment_id": 99136931, "body": "<code>\\t</code> does not result in an escape sequence but the tab character."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1558538978, "post_id": 56260102, "comment_id": 99137187, "body": "Side-note (addressed in <a href=\"https://stackoverflow.com/a/56260141/364696\">my answer</a>): <code>printf</code> takes string literals for the format string, not character literals. Even if you managed to compile this by fixing the &#39;\\&#39; literal and you suppressed all the warnings from your compiler for passing <code>&#39;x&#39;</code>, it would almost certainly segfault (or almost worse, silently print random memory based on whatever stack garbage is added to <code>&#39;x&#39;</code>). You want <code>printf(&quot;x&quot;);</code>, not <code>printf(&#39;x&#39;);</code>."}, {"owner": {"reputation": 23, "user_id": 11540106, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yG0HOmtHzUQ/AAAAAAAAAAI/AAAAAAAAAJE/6fxw65EkxZI/photo.jpg?sz=128", "display_name": "Shivam Kumar Shukla", "link": "https://stackoverflow.com/users/11540106/shivam-kumar-shukla"}, "edited": false, "score": 0, "creation_date": 1558539729, "post_id": 56260102, "comment_id": 99137596, "body": "thank you very much.Your time and knowledge is very much appreciated.thank you again"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11540106, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yG0HOmtHzUQ/AAAAAAAAAAI/AAAAAAAAAJE/6fxw65EkxZI/photo.jpg?sz=128", "display_name": "Shivam Kumar Shukla", "link": "https://stackoverflow.com/users/11540106/shivam-kumar-shukla"}, "edited": false, "score": 0, "creation_date": 1558540033, "post_id": 56260141, "comment_id": 99137763, "body": "thanks again .brother.i have tried comparing differently but just because i was unable to compare&#39;\\&#39; i was stuck.just opened account now.and such  great people.within minutes  help arrived..thank you"}], "tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": true, "score": 1, "last_activity_date": 1558538743, "last_edit_date": 1558538743, "creation_date": 1558538406, "answer_id": 56260141, "question_id": 56260102, "link": "https://stackoverflow.com/questions/56260102/unable-to-compare-integer-variable-containing-ascii-value-by-getchar-with-t/56260141#56260141", "title": "unable to compare integer variable containing ASCII value by getchar() with &#39;\\t&#39;,&#39;\\&#39;;", "body": "<p>Backslash is the escape character, you need to use a double-backslash to make a character literal containing a single backslash:</p>\n\n<pre><code>if (c=='\\\\')\n</code></pre>\n\n<p>Without the extra backslash, the single backslash escapes the closing single quote, so the character literal doesn't end, and the code will not compile (on the rare occasions it does, it's likely compiling garbage).</p>\n\n<p>As for <code>\\t</code>, if you want to compare to an actual tab, <code>if (c=='\\t')</code> works just fine. But if you want to recognize a literal backslash followed by a <code>t</code>, you'll need to recognize it in two pieces, first the backslash, then read another character to see the <code>t</code>, e.g.:</p>\n\n<pre><code>int main()\n{\n    int c;\n    while((c=getchar())!=EOF)\n    {\n        if (c == '\\\\') {\n            printf(\"Found escape beginning\\n\");\n            if ((c = getchar()) == EOF) break;\n            if (c == 't')\n                printf(\"Found backslashed 't'\\n\");\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Note: Your <code>printf</code> was also wrong, as it passed a character literal to <code>printf</code>, not a string literal. I've fixed it in the expanded code above; your original code would change <code>printf('x');</code> to <code>printf(\"x\");</code></p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1558538447, "creation_date": 1558538447, "answer_id": 56260151, "question_id": 56260102, "link": "https://stackoverflow.com/questions/56260102/unable-to-compare-integer-variable-containing-ascii-value-by-getchar-with-t/56260151#56260151", "title": "unable to compare integer variable containing ASCII value by getchar() with &#39;\\t&#39;,&#39;\\&#39;;", "body": "<p>Within a string or character constant, the <code>\\</code> character acts as escape character to give the following character special meaning.  In your case, the <code>\\</code> is escaping the closing <code>'</code> character meaning that the quoted character constant is not closed.</p>\n\n<p>The escape sequence for a literal <code>\\</code> is <code>\\\\</code>.  So what you want is:</p>\n\n<pre><code>if(c=='\\\\')\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11540106, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yG0HOmtHzUQ/AAAAAAAAAAI/AAAAAAAAAJE/6fxw65EkxZI/photo.jpg?sz=128", "display_name": "Shivam Kumar Shukla", "link": "https://stackoverflow.com/users/11540106/shivam-kumar-shukla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 56260141, "answer_count": 2, "score": -3, "last_activity_date": 1558538765, "creation_date": 1558538279, "last_edit_date": 1558538765, "question_id": 56260102, "link": "https://stackoverflow.com/questions/56260102/unable-to-compare-integer-variable-containing-ascii-value-by-getchar-with-t", "title": "unable to compare integer variable containing ASCII value by getchar() with &#39;\\t&#39;,&#39;\\&#39;;", "body": "<p>I am writing a code in c language, with custom input. And having problems to compare an int variable with '\\','\\t'(generally escape sequences). Here integer variable stores the ASCII value of characters. And is acquired by <code>getchar()</code>. </p>\n\n<p>I have tried to change compiler,and also tried to do this with <code>scanf()</code> and storing value on another level. But for every process the take '\\' as a different character and 't' as a different. And cant even compare '\\'. Showing missing terminating character.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int c;\n    while((c=getchar())!=EOF)\n    {\n        if(c=='\\')\n            printf('x');\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I want to print x if <code>c=='\\'</code>. the real code is a bit too long. I am sure no error in the other parts but unable to get this. every code I saw online is working. But not with mine.</p>\n"}, {"tags": ["python", "c++", "c", "python-c-api"], "comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1558539915, "post_id": 56260096, "comment_id": 99137701, "body": "Is your test code supposed to be <code>if &#39;word&#39; in iterable():</code>, or did you mean <code>if &#39;word&#39; in item:</code> as before? As written, <code>if &#39;word&#39; in iterable():</code> is nonsensical."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1558541535, "post_id": 56260096, "comment_id": 99138617, "body": "Never mind; I checked your full code and it makes sense (sort of) now. It&#39;s costing you performance to implement it that way though; I&#39;ve updated <a href=\"https://stackoverflow.com/a/56260851/364696\">my answer</a> to address that."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1558542575, "post_id": 56260096, "comment_id": 99139152, "body": "FYI, <a href=\"https://github.com/evandrocoan/fastfilepackage/blob/c919b6084f4a46ad453b9353bcdb052d502fc278/source/fastfile.cpp#L85\" rel=\"nofollow noreferrer\">this is a memory leak waiting to happen</a>. If <code>next</code> and <code>call</code> aren&#39;t perfectly paired, then <code>next</code> fails to decref the line it discards; you avoid the leak while they&#39;re paired only because <code>call</code> is eventually returning an owned reference to the string (meaning your cache is now a borrowed reference), so the <code>pop_front</code> doesn&#39;t leak. And if you call <code>call</code> more than once, you return the same pointer twice, with only one owning reference, which will lead to double free."}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 1, "creation_date": 1558551538, "post_id": 56260096, "comment_id": 99143009, "body": "100MB log file &#225; 100-300 characters per line result in about 500K lines. This means that about 500K times a zero terminated C string is converted into a Python Unicode string and then processed in Python. If performance is the primary objective, it may be better to either have the processing in C and pass only the result to Python, or to perform the processing entirely in Python. Presumable both variants should be faster than this approach with 500K calls into native C."}, {"owner": {"reputation": 5700, "user_id": 4934640, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f69527ae459cbbda0ab5c2e08686a50?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4934640/user"}, "edited": false, "score": 0, "creation_date": 1558575544, "post_id": 56260096, "comment_id": 99149955, "body": "<b>If <code>next</code> and <code>call</code> aren&#39;t perfectly paired, then next fails to decref the line it discards</b>, Can I fix this just calling <code>Py_XDECREF(linecache[0])</code> before <code>linecache.pop_front()</code>? I did a <a href=\"https://github.com/evandrocoan/fastfilepackage/commit/d0c823bdbb056847143d752d8c455cae90debb96\" rel=\"nofollow noreferrer\">new commit</a> with this change."}, {"owner": {"reputation": 5700, "user_id": 4934640, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f69527ae459cbbda0ab5c2e08686a50?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4934640/user"}, "edited": false, "score": 0, "creation_date": 1558575556, "post_id": 56260096, "comment_id": 99149958, "body": "<b>And if you call <code>call</code> more than once, you return the same pointer twice, with only one owning reference, which will lead to double free</b>, Currently, I am calling <code>Py_XINCREF</code> on every value returned by call on <code>fastfilewrapper.cpp</code>. Would not this fix it?"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1558623831, "post_id": 56260096, "comment_id": 99170482, "body": "@user: &quot;Currently, I am calling Py_XINCREF on every value returned by call on fastfilewrapper.cpp&quot;. Ah, I missed that part. Usually, the person returning the value in the first place increfs it, because borrowed vs. owned is part of the closest level API contract. I&#39;ll note that <code>Py_XDECREF</code> should probably be <code>Py_CLEAR</code> if you want to remove the risk of some other bug causing a double-free (<code>Py_CLEAR</code> is <code>Py_XDECREF</code> followed by setting the value to <code>NULL</code>)."}, {"owner": {"reputation": 5700, "user_id": 4934640, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f69527ae459cbbda0ab5c2e08686a50?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4934640/user"}, "reply_to_user": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 1, "creation_date": 1558628040, "post_id": 56260096, "comment_id": 99172650, "body": "@StephanSchlecht I just benchmarked the <code>std::getline</code> against Posix <code>getline</code> and <code>std::getline</code> is 2.5 times slower than Python builtin readline, while Posix <code>getline</code> (not available on msvc) is only 1.5 times slower than Python builtin <code>getline</code>. On these results, I am excluding the conversion from <code>c string</code> to Python Unicode. When enabling the conversion from <code>c string</code> to Python Unicode, it only added 0.4 of slow down, then <code>std::getline</code> was 2.9 slower, while Posix <code>getline</code> was 1.9 slower. Indeed, the bottleneck is more the getline implementation used other than Python and C interface."}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 0, "creation_date": 1558646105, "post_id": 56260096, "comment_id": 99180022, "body": "That&#39;s interesting. On *nix-like operating systems, when scanning larger text files, I would expect a simple C-loop with &#39;readline&#39; and &#39;strstr&#39; to be almost twice as fast as the Python equivalent shown, where C doesn&#39;t work with Unicode, so Python actually doesn&#39;t do so badly. The functionality on which something like this is based (such as &#39;readline&#39; and &#39;strstr&#39;) is usually highly optimized and is therefore not easy to beat with custom implementations (unless you have special cases). I would therefore assume that additional operations like string conversion etc. can simply slow them down."}, {"owner": {"reputation": 5700, "user_id": 4934640, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f69527ae459cbbda0ab5c2e08686a50?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4934640/user"}, "reply_to_user": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 0, "creation_date": 1558652703, "post_id": 56260096, "comment_id": 99181724, "body": "@StephanSchlecht, I just noticed I forgot to compile the Posix C <code>getline</code> with <code>-O2</code>.  I was compiling it with <code>-O0</code>. Now both Python and Posix C are using <code>-O2</code> they matched the <code>1:1</code>, i.e., no one was faster than the other. When I also set to do the conversion from the <code>C String</code> to <code>Python Object</code> the program runs <code>1.3</code> times slower. That is what I am losing of performance for not building a Python Unicode string from the start, as the builtin Python method <code>for line in file</code> is doing."}, {"owner": {"reputation": 5700, "user_id": 4934640, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f69527ae459cbbda0ab5c2e08686a50?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4934640/user"}, "reply_to_user": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 0, "creation_date": 1558655283, "post_id": 56260096, "comment_id": 99182224, "body": "@StephanSchlecht, I just managed to optimize my Posix C <code>getline</code> usage (by caching the total buffer size instead of always passing 0) and now the Posix C <code>getline</code> beats the Python builtin <code>for line in file</code> by <code>5%</code>. I guess if I remove all Python and C++ code around the Posix C <code>getline</code>, it should gain some more performance."}, {"owner": {"reputation": 5700, "user_id": 4934640, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f69527ae459cbbda0ab5c2e08686a50?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4934640/user"}, "reply_to_user": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 0, "creation_date": 1558657055, "post_id": 56260096, "comment_id": 99182510, "body": "@StephanSchlecht, I also was compiling the benchmarks I did with <code>std::getline</code> using <code>-O0</code> instead of <code>-O2</code>. Sadly, its performance still bad, but now it is only <code>35%</code> slower than the Python builtin C <code>for line in file</code>. However, I manage to improve the C++ performance to only <code>9%</code> slower than the builtin Python C <code>for line in file</code> by replacing the usage of <code>std::getline</code> by <code>std::ifstream.getline()</code>."}, {"owner": {"reputation": 5700, "user_id": 4934640, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f69527ae459cbbda0ab5c2e08686a50?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4934640/user"}, "reply_to_user": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 0, "creation_date": 1558659738, "post_id": 56260096, "comment_id": 99182929, "body": "@StephanSchlecht, I was not caching the <code>std::getline</code> input string, then the performance was bad. Now I posted my codes as <a href=\"https://stackoverflow.com/a/56284547/4934640\">an answer</a> for proper understanding."}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 0, "creation_date": 1558772014, "post_id": 56260096, "comment_id": 99217208, "body": "Quicktest of 10M lines with approx 200 chars parsing, counting bytes and lines containing substring &#39;word&#39;: Simple C with readlines/strstr loop, a pure python solution and the last one with C extension (readline in C, subtring search in Python): simple c: 4.31s (3.46s user / 0.84 sys) vs. pure python: 10.81s (9.99 user / 0.80 sys)  vs c-extension: 11.28s (10.28 user / 0.96 sys) I expected the difference between pure C and Python solutions, interesting for me (as you said before) is that the C extension solution is almost equivalent to the pure Python solution."}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 0, "creation_date": 1558772416, "post_id": 56260096, "comment_id": 99217305, "body": "For me this means, if performance is the most important criterion, I stil would recommend to do the calculation purely on C side and only return the result. Otherwise you can work purely with Python, because I/O is done by highly optimized routines anyway, so you only get (slightly) slower if you only move I/O to C, but have a much more complex code."}], "answers": [{"comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1558542179, "post_id": 56260851, "comment_id": 99138956, "body": "Extremely minor performance tip: As a rule, C++ templates can&#39;t specialize to actual functions, only to function prototypes, which means the function ends up being called through a pointer, which is slightly slower than a direct call. Functors (and lambdas, which are syntactic sugar for functors) are unique types though, and the template fully specializes for them. You may gain a little by changing code like <code>(self-&gt;cppobjectpointer)-&gt;call( PyUnicode_DecodeUTF8 );</code> to <code>(self-&gt;cppobjectpointer)-&gt;call( [](const char *s, Py_ssize_t sz, const char *e) { return PyUnicode_DecodeUTF8(s, sz, e); });</code>"}, {"owner": {"reputation": 5700, "user_id": 4934640, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f69527ae459cbbda0ab5c2e08686a50?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4934640/user"}, "edited": false, "score": 0, "creation_date": 1558575239, "post_id": 56260851, "comment_id": 99149900, "body": "<b>tp_call is not nearly so cheap, going through convoluted general purpose code paths</b>, I use <code>call()</code> because it is much more optimized than a simple <code>object.function()</code> call. But now, I stopped returning None from <code>tp_next</code> and I am actually returning the first object. Thanks!"}], "tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": true, "score": 2, "last_activity_date": 1558541469, "last_edit_date": 1558541469, "creation_date": 1558540784, "answer_id": 56260851, "question_id": 56260096, "link": "https://stackoverflow.com/questions/56260096/how-to-improve-python-c-extensions-file-line-reading/56260851#56260851", "title": "How to improve Python C Extensions file line reading?", "body": "<p>Reading line by line is going to cause unavoidable slowdowns here. Python's built-in text oriented read-only file objects are actually three layers:</p>\n\n<ol>\n<li><code>io.FileIO</code> - Raw, unbuffered access to the file</li>\n<li><code>io.BufferedReader</code> - Buffers the underlying <code>FileIO</code></li>\n<li><code>io.TextIOWrapper</code> - Wraps the <code>BufferedReader</code> to implement buffered decode to <code>str</code></li>\n</ol>\n\n<p>While <code>iostream</code> does perform buffering, it's only doing the job of <code>io.BufferedReader</code>, not <code>io.TextIOWrapper</code>. <code>io.TextIOWrapper</code> adds an extra layer of buffering, reading 8 KB <em>chunks</em> out of the <code>BufferedReader</code> and decoding them in bulk to <code>str</code> (when a chunk ends in an incomplete character, it saves off the remaining bytes to prepend to the next chunk), then yielding individual lines from the decoded chunk on request until it's exhausted (when a decoded chunk ends in a partial line, the remainder is prepended to the next decoded chunk).</p>\n\n<p>By contrast, you're consuming a line at a time with <code>std::getline</code>, then decoding a line at a time with <code>PyUnicode_DecodeUTF8</code>, then yielding back to the caller; by the time the caller requests the next line, odds are at least some of the code associated with your <code>tp_iternext</code> implementation has left the CPU cache (or at least, left the fastest parts of the cache). A tight loop decoding 8 KB of text to UTF-8 is going to go extremely fast; repeatedly leaving the loop and only decoding a 100-300 bytes at a time is going to be slower.</p>\n\n<p>The solution is to do roughly what <code>io.TextIOWrapper</code> does: Read in chunks, not lines, and decode them in bulk (preserving incomplete UTF-8 encoded characters for the next chunk), then search for newlines to fish out substrings from the decoded buffer until it's exhausted (don't trim the buffer each time, just track indices). When no more complete lines remain in the decoded buffer, trim the stuff you've already yielded, and read, decode, and append a new chunk.</p>\n\n<p>There is some room for improvement on <a href=\"https://github.com/python/cpython/blob/3.7/Modules/_io/textio.c#L2014\" rel=\"nofollow noreferrer\">Python's underlying implementation of <code>io.TextIOWrapper.readline</code></a> (e.g. they have to construct a Python level <code>int</code> each time they read a chunk and call indirectly since they can't guarantee they're wrapping a <code>BufferedReader</code>), but it's a solid basis for reimplementing your own scheme.</p>\n\n<p><strong>Update:</strong> On checking your full code (which is wildly different from what you've posted), you've got other issues. Your <code>tp_iternext</code> just repeatedly yields <code>None</code>, requiring you to <em>call</em> your object to retrieve the string. That's... unfortunate. That's more than doubling the Python interpreter overhead per item (<code>tp_iternext</code> is cheap to call, being quite specialized; <code>tp_call</code> is not nearly so cheap, going through convoluted general purpose code paths, requiring the interpreter to pass an empty <code>tuple</code> of args you never use, etc.; side-note, <code>PyFastFile_tp_call</code> should be accepting a third argument for the <code>kwds</code>, which you ignore, but must still be accepted; casting to <code>ternaryfunc</code> is silencing the error, but this will break on some platforms).</p>\n\n<p>Final note (not really relevant to performance for all but the smallest files): The contract for <code>tp_iternext</code> does not require you to set an exception when the iterator is exhausted, just that you <code>return NULL;</code>. You can remove your call to <code>PyErr_SetNone( PyExc_StopIteration );</code>; as long as no other exception is set, <code>return NULL;</code> alone indicates end of iteration, so you can save some work by not setting it at all.</p>\n"}, {"tags": [], "owner": {"reputation": 5700, "user_id": 4934640, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f69527ae459cbbda0ab5c2e08686a50?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4934640/user"}, "is_accepted": false, "score": 0, "last_activity_date": 1558945091, "last_edit_date": 1558945091, "creation_date": 1558658871, "answer_id": 56284547, "question_id": 56260096, "link": "https://stackoverflow.com/questions/56260096/how-to-improve-python-c-extensions-file-line-reading/56284547#56284547", "title": "How to improve Python C Extensions file line reading?", "body": "<p>These results are only for Linux or Cygwin compiler. If you are using <code>Visual Studio Compiler</code>, the results for <code>std::getline</code> and <code>std::ifstream.getline</code> are <code>100%</code> or more slower than Python builtin <code>for line in file</code> iterator.</p>\n\n<p>You will see <code>linecache.push_back( emtpycacheobject )</code> being used around the code because this way I am only benchmarking the time used to read the lines, excluding the time Python would spend converting the input string into a Python Unicode Object. Therefore, I commented out all lines which call <code>PyUnicode_DecodeUTF8</code>.</p>\n\n<p>These are the global definitions used on the examples:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>const char* filepath = \"./myfile.log\";\nsize_t linecachesize = 131072;\n\nPyObject* emtpycacheobject;\nemtpycacheobject = PyUnicode_DecodeUTF8( \"\", 0, \"replace\" );\n</code></pre>\n\n<p>I managed to optimize my Posix C <code>getline</code> usage (by caching the total buffer size instead of always passing 0) and now the Posix C <code>getline</code> beats the Python builtin <code>for line in file</code> by <code>5%</code>. I guess if I remove all Python and C++ code around the Posix C <code>getline</code>, it should gain some more performance:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>char* readline = (char*) malloc( linecachesize );\nFILE* cfilestream = fopen( filepath, \"r\" );\n\nif( cfilestream == NULL ) {\n    std::cerr &lt;&lt; \"ERROR: Failed to open the file '\" &lt;&lt; filepath &lt;&lt; \"'!\" &lt;&lt; std::endl;\n}\n\nif( readline == NULL ) {\n    std::cerr &lt;&lt; \"ERROR: Failed to alocate internal line buffer!\" &lt;&lt; std::endl;\n}\n\nbool getline() {\n    ssize_t charsread;\n    if( ( charsread = getline( &amp;readline, &amp;linecachesize, cfilestream ) ) != -1 ) {\n        fileobj.getline( readline, linecachesize );\n        // PyObject* pythonobject = PyUnicode_DecodeUTF8( readline, charsread, \"replace\" );\n        // linecache.push_back( pythonobject );\n        // return true;\n\n        Py_XINCREF( emtpycacheobject );\n        linecache.push_back( emtpycacheobject );\n        return true;\n    }\n    return false;\n}\n\nif( readline ) {\n    free( readline );\n    readline = NULL;\n}\n\nif( cfilestream != NULL) {\n    fclose( cfilestream );\n    cfilestream = NULL;\n}\n</code></pre>\n\n<p>I also managed to improve the C++ performance to only <code>20%</code> slower than the builtin Python C <code>for line in file</code> by using <code>std::ifstream.getline()</code>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>char* readline = (char*) malloc( linecachesize );\nstd::ifstream fileobj;\nfileobj.open( filepath );\n\nif( fileobj.fail() ) {\n    std::cerr &lt;&lt; \"ERROR: Failed to open the file '\" &lt;&lt; filepath &lt;&lt; \"'!\" &lt;&lt; std::endl;\n}\n\nif( readline == NULL ) {\n    std::cerr &lt;&lt; \"ERROR: Failed to alocate internal line buffer!\" &lt;&lt; std::endl;\n}\n\nbool getline() {\n\n    if( !fileobj.eof() ) {\n        fileobj.getline( readline, linecachesize );\n        // PyObject* pyobj = PyUnicode_DecodeUTF8( readline, fileobj.gcount(), \"replace\" );\n        // linecache.push_back( pyobj );\n        // return true;\n\n        Py_XINCREF( emtpycacheobject );\n        linecache.push_back( emtpycacheobject );\n        return true;\n    }\n    return false;\n}\n\nif( readline ) {\n    free( readline );\n    readline = NULL;\n}\n\nif( fileobj.is_open() ) {\n    fileobj.close();\n}\n</code></pre>\n\n<p>Finally, I also managed to get only <code>10%</code> slower performance than the builtin Python C <code>for line in file</code> with <code>std::getline</code> by caching the <code>std::string</code> it uses as input:</p>\n\n<pre><code>std::string line;\nstd::ifstream fileobj;\nfileobj.open( filepath );\n\nif( fileobj.fail() ) {\n    std::cerr &lt;&lt; \"ERROR: Failed to open the file '\" &lt;&lt; filepath &lt;&lt; \"'!\" &lt;&lt; std::endl;\n}\n\ntry {\n    line.reserve( linecachesize );\n}\ncatch( std::exception error ) {\n    std::cerr &lt;&lt; \"ERROR: Failed to alocate internal line buffer!\" &lt;&lt; std::endl;\n}\n\nbool getline() {\n\n    if( std::getline( fileobj, line ) ) {\n        // PyObject* pyobj = PyUnicode_DecodeUTF8( line.c_str(), line.size(), \"replace\" );\n        // linecache.push_back( pyobj );\n        // return true;\n\n        Py_XINCREF( emtpycacheobject );\n        linecache.push_back( emtpycacheobject );\n        return true;\n    }\n    return false;\n}\n\nif( fileobj.is_open() ) {\n    fileobj.close();\n}\n</code></pre>\n\n<p>After removing all boilerplate from C++, the performance for Posix C <code>getline</code> was 10% inferior to the Python builtin <code>for line in file</code>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>const char* filepath = \"./myfile.log\";\nsize_t linecachesize = 131072;\n\nPyObject* emtpycacheobject = PyUnicode_DecodeUTF8( \"\", 0, \"replace\" );\nchar* readline = (char*) malloc( linecachesize );\nFILE* cfilestream = fopen( filepath, \"r\" );\n\nstatic PyObject* PyFastFile_tp_call(PyFastFile* self, PyObject* args, PyObject *kwargs) {\n    Py_XINCREF( emtpycacheobject );\n    return emtpycacheobject;\n}\n\nstatic PyObject* PyFastFile_iternext(PyFastFile* self, PyObject* args) {\n    ssize_t charsread;\n    if( ( charsread = getline( &amp;readline, &amp;linecachesize, cfilestream ) ) == -1 ) {\n        return NULL;\n    }\n    Py_XINCREF( emtpycacheobject );\n    return emtpycacheobject;\n}\n\nstatic PyObject* PyFastFile_getlines(PyFastFile* self, PyObject* args) {\n    Py_XINCREF( emtpycacheobject );\n    return emtpycacheobject;\n}\n\nstatic PyObject* PyFastFile_resetlines(PyFastFile* self, PyObject* args) {\n    Py_INCREF( Py_None );\n    return Py_None;\n}\n\nstatic PyObject* PyFastFile_close(PyFastFile* self, PyObject* args) {\n    Py_INCREF( Py_None );\n    return Py_None;\n}\n</code></pre>\n\n<p>Values from the last test run where Posix C <code>getline</code> was 10% inferior to Python:</p>\n\n<pre><code>$ /bin/python3.6 fastfileperformance.py fastfile_time 1.15%, python_time 0.87%\nPython   timedifference 0:00:00.695292\nFastFile timedifference 0:00:00.796305\n\n$ /bin/python3.6 fastfileperformance.py fastfile_time 1.13%, python_time 0.88%\nPython   timedifference 0:00:00.708298\nFastFile timedifference 0:00:00.803594\n\n$ /bin/python3.6 fastfileperformance.py fastfile_time 1.14%, python_time 0.88%\nPython   timedifference 0:00:00.699614\nFastFile timedifference 0:00:00.795259\n\n$ /bin/python3.6 fastfileperformance.py fastfile_time 1.15%, python_time 0.87%\nPython   timedifference 0:00:00.699585\nFastFile timedifference 0:00:00.802173\n\n$ /bin/python3.6 fastfileperformance.py fastfile_time 1.15%, python_time 0.87%\nPython   timedifference 0:00:00.703085\nFastFile timedifference 0:00:00.807528\n\n$ /bin/python3.6 fastfileperformance.py fastfile_time 1.17%, python_time 0.85%\nPython   timedifference 0:00:00.677507\nFastFile timedifference 0:00:00.794591\n\n$ /bin/python3.6 fastfileperformance.py fastfile_time 1.20%, python_time 0.83%\nPython   timedifference 0:00:00.670492\nFastFile timedifference 0:00:00.804689\n</code></pre>\n"}], "owner": {"reputation": 5700, "user_id": 4934640, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f69527ae459cbbda0ab5c2e08686a50?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4934640/user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 1, "accepted_answer_id": 56260851, "answer_count": 2, "score": 0, "last_activity_date": 1558945091, "creation_date": 1558538249, "last_edit_date": 1558735406, "question_id": 56260096, "link": "https://stackoverflow.com/questions/56260096/how-to-improve-python-c-extensions-file-line-reading", "title": "How to improve Python C Extensions file line reading?", "body": "<p>Originally asked on <a href=\"https://stackoverflow.com/questions/56249992/are-there-alternative-and-portable-algorithm-implementation-for-reading-lines-fr\">Are there alternative and portable algorithm implementation for reading lines from a file on Windows (Visual Studio Compiler) and Linux?</a> but closed as too abroad, then, I am here trying to reduce its scope with a more concise case usage.</p>\n\n<p>My goal is to implement my own file reading module for Python with Python C Extensions with a line caching policy. The purely Python Algorithm implementation  without any line caching policy is this:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code># This takes 1 second to parse 100MB of log data\nwith open('myfile', 'r', errors='replace') as myfile:\n    for line in myfile:\n        if 'word' in line: \n            pass\n</code></pre>\n\n<p>Resuming the Python C Extensions implementation: (<a href=\"https://github.com/evandrocoan/fastfilepackage/blob/c919b6084f4a46ad453b9353bcdb052d502fc278/source/fastfilewrapper.cpp#L66-L80\" rel=\"nofollow noreferrer\">see here the full code with line caching policy</a>)</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// other code to open the file on the std::ifstream object and create the iterator\n...\n\nstatic PyObject * PyFastFile_iternext(PyFastFile* self, PyObject* args)\n{\n    std::string newline;\n\n    if( std::getline( self-&gt;fileifstream, newline ) ) {\n        return PyUnicode_DecodeUTF8( newline.c_str(), newline.size(), \"replace\" );\n    }\n\n    PyErr_SetNone( PyExc_StopIteration );\n    return NULL;\n}\n\nstatic PyTypeObject PyFastFileType =\n{\n    PyVarObject_HEAD_INIT( NULL, 0 )\n    \"fastfilepackage.FastFile\" /* tp_name */\n};\n\n// create the module\nPyMODINIT_FUNC PyInit_fastfilepackage(void)\n{\n    PyFastFileType.tp_iternext = (iternextfunc) PyFastFile_iternext;\n    Py_INCREF( &amp;PyFastFileType );\n\n    PyObject* thismodule;\n    // other module code creating the iterator and context manager\n    ...\n\n    PyModule_AddObject( thismodule, \"FastFile\", (PyObject *) &amp;PyFastFileType );\n    return thismodule;\n}\n</code></pre>\n\n<p>And this is the Python code which uses the Python C Extensions code to open a file and read its lines one by one:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>from fastfilepackage import FastFile\n\n# This takes 3 seconds to parse 100MB of log data\niterable = fastfilepackage.FastFile( 'myfile' )\nfor item in iterable:\n    if 'word' in iterable():\n        pass\n</code></pre>\n\n<p>Right now the Python C Extensions code <code>fastfilepackage.FastFile</code> with C++ 11 <code>std::ifstream</code> takes 3 seconds to parse 100MB of log data, while the Python implementation presented takes 1 second. </p>\n\n<p>The content of the file <code>myfile</code> are just <code>log lines</code> with around 100~300 characters on each line. The characters are just ASCII (module % 256), but due bugs on the logger engine, it can put invalid ASCII or Unicode characters. Hence, this is why I used the <code>errors='replace'</code> policy while opening the file.</p>\n\n<p>I just wonder if I can replace or improve this Python C Extension implementation, reducing the 3 seconds time to run the Python program.</p>\n\n<p>I used this to do the benchmark:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import time\nimport datetime\nimport fastfilepackage\n\n# usually a file with 100MB\ntestfile = './myfile.log'\n\ntimenow = time.time()\nwith open( testfile, 'r', errors='replace' ) as myfile:\n    for item in myfile:\n        if None:\n            var = item\n\npython_time = time.time() - timenow\ntimedifference = datetime.timedelta( seconds=python_time )\nprint( 'Python   timedifference', timedifference, flush=True )\n# prints about 3 seconds\n\ntimenow = time.time()\niterable = fastfilepackage.FastFile( testfile )\nfor item in iterable:\n    if None:\n        var = iterable()\n\nfastfile_time = time.time() - timenow\ntimedifference = datetime.timedelta( seconds=fastfile_time )\nprint( 'FastFile timedifference', timedifference, flush=True )\n# prints about 1 second\n\nprint( 'fastfile_time %.2f%%, python_time %.2f%%' % ( \n        fastfile_time/python_time, python_time/fastfile_time ), flush=True )\n</code></pre>\n\n<p>Related questions:</p>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/questions/25866045/reading-file-line-by-line-in-c\">Reading file Line By Line in C</a></li>\n<li><a href=\"https://stackoverflow.com/questions/34493913/improving-cs-reading-file-line-by-line\">Improving C++&#39;s reading file line by line?</a></li>\n</ol>\n"}, {"tags": ["c", "unicode", "trie"], "comments": [{"owner": {"reputation": 134, "user_id": 11131523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3O9ngZPKFGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdeFi7656jSqPOfPxvSdL-OboBLdg/mo/photo.jpg?sz=128", "display_name": "Igor Galczak", "link": "https://stackoverflow.com/users/11131523/igor-galczak"}, "edited": false, "score": 0, "creation_date": 1558537082, "post_id": 56259471, "comment_id": 99136003, "body": "In my expirience utf-8 character was reprezent in 2 bytes, 2 chars. Utf first byte begin from 0xC0 - <a href=\"https://en.wikipedia.org/wiki/UTF-8\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/UTF-8</a>, so you must store chars in bytes (uint8 / signed char)"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 134, "user_id": 11131523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3O9ngZPKFGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdeFi7656jSqPOfPxvSdL-OboBLdg/mo/photo.jpg?sz=128", "display_name": "Igor Galczak", "link": "https://stackoverflow.com/users/11131523/igor-galczak"}, "edited": false, "score": 2, "creation_date": 1558537432, "post_id": 56259471, "comment_id": 99136249, "body": "@IgorGalczak UTF-8 characters can be from one to four bytes (if you respect the artificial limitation of Unicode to 0x10FFFF code points) or one to six (if you stick with the original definition of UTF-8).  I suspect OP is actually getting UTF-16 or -32."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 5, "creation_date": 1558537558, "post_id": 56259471, "comment_id": 99136328, "body": "@Mihir By design, every byte of a UTF-8 multibyte sequence has its high bit set, so they can never collide with ASCII characters.  As long as your trie structure does not clobber the high bit, it should be able to work with UTF-8 strings just like it does ASCII, without ever having to know the encoding explicitly.  However, if your Unicode strings <i>consistently</i> have four bytes per character they are probably not UTF-8, but UTF-32, which is much harder to work with.  Please tell us what the numeric value of each of the four bytes in one of the problem characters is."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1558537896, "post_id": 56259471, "comment_id": 99136567, "body": "On the flip side, however, every byte with the high bit clear is a valid single-byte UTF-8 code sequence, and any number of such bytes strung together is valid utf-8 encoded text.  Also, there are many byte sequences containing some with the high bit set that are not valid UTF-8 code sequences."}, {"owner": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1558537923, "post_id": 56259471, "comment_id": 99136595, "body": "@zwol, I see, all I need is that one of those unicode characters to be able to be representable as one of the characters from 0-256, because that\u2019s how my trie is establishing links. It takes the character and converts it to numerical value and proceeds to next link accordingly. I would just need the most accurate and fastest way to achieve this."}, {"owner": {"reputation": 5450, "user_id": 2758823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Nxaq.jpg?s=128&g=1", "display_name": "Giacomo Catenazzi", "link": "https://stackoverflow.com/users/2758823/giacomo-catenazzi"}, "edited": false, "score": 1, "creation_date": 1558538007, "post_id": 56259471, "comment_id": 99136642, "body": "&quot;Unicode string&quot;? In C you have an encoding. So you are meaning &quot;UTF-8&quot;? Or you are doing like python, an unicode interface and you handle (and hide) the details?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1558538097, "post_id": 56259471, "comment_id": 99136689, "body": "@Mihir, I note that you say &quot;Unicode&quot;, but tag [utf-8], and describe behavior that doesn&#39;t seem consistent with UTF-8.  UTF-8 is <i>one way</i> of representing Unicode text, but not the only way."}, {"owner": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "edited": false, "score": 0, "creation_date": 1558538139, "post_id": 56259471, "comment_id": 99136720, "body": "<a href=\"https://stackoverflow.com/questions/3911536/utf-8-unicode-whats-with-0xc0-and-0x80\" title=\"utf 8 unicode whats with 0xc0 and 0x80\">stackoverflow.com/questions/3911536/&hellip;</a>, as per this I see a way to detect if sequence of bytes is a unicode character, but this only seems to be the case in utf-8. If my implementation requires utf-32, what shall I do then?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1558538313, "post_id": 56259471, "comment_id": 99136817, "body": "@Mihir It is impossible to convert an arbitrary Unicode character to a number in <code>[0, 255]</code> without losing information, because of the <a href=\"https://en.wikipedia.org/wiki/Pigeonhole_principle\" rel=\"nofollow noreferrer\">pigeonhole principle</a>.  But nothing will go wrong if you give each byte of a UTF-8 multibyte sequence its own node in the trie."}, {"owner": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1558538885, "post_id": 56259471, "comment_id": 99137139, "body": "@zwol, each byte in multibyte sequence of utf-8 would get node in trie. One problem that I still face is that even after <code>setlocale()</code>, it still reads unicode characters like \u2018?\u2019 \u2018? \u2018?\u2019 \u2018?\u2019. How do I make it read the right character?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1558540818, "post_id": 56259471, "comment_id": 99138198, "body": "@Mihir Two questions: (1) Why does your test program use <code>int a[] = &quot;\u0182&quot;</code>?  That is definitely wrong. It won&#39;t even compile on my computer. (2) What does your program print, <i>on your computer</i>, if you change <code>%c</code> to <code>%02x</code> in the <code>printf</code> call?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1558541215, "post_id": 56259471, "comment_id": 99138420, "body": "If I change <code>a</code>&#39;s element type to <code>char</code> in the code presented, it compiles fine on my machine and prints the expected character when it runs.  I note, however, that the character <code>\u0182</code> is not a member of C&#39;s basic source or execution character set.  It is up to the implementation whether to accept that character appearing as itself in C source code, and to what it corresponds at execution time."}, {"owner": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1558541419, "post_id": 56259471, "comment_id": 99138552, "body": "@zwol, I corrected it, that was by mistake."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1558541436, "post_id": 56259471, "comment_id": 99138558, "body": "@Mihir Still waiting for the numeric values of those bytes..."}, {"owner": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1558541716, "post_id": 56259471, "comment_id": 99138715, "body": "@zwol, it printfs ffffffc6"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1558541775, "post_id": 56259471, "comment_id": 99138751, "body": "<i>unicode string in form of individual ascii chars</i>. That&#39;s an oxymoron right here. Anyway  <a href=\"https://ideone.com/UT3jac\" rel=\"nofollow noreferrer\">your code works just fine</a>. My guess is you have a broken OS with no proper UTF-8 support, but you are not sharing any details of your environment, so no further progress can be made."}, {"owner": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1558541960, "post_id": 56259471, "comment_id": 99138851, "body": "@zwol, maybe I understand it a bit now,  ffffffc6 breaks to index \u201c-58\u201d and there is no index such as that. Does that mean the each node in utf-8 sequence isn\u2019t within range 0-255?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1558542133, "post_id": 56259471, "comment_id": 99138937, "body": "@JohnBollinger a general purpose compiler that does not allow Unicode in source code may be conformant but it doesn&#39;t make it any less broken and useless. Just throw it away and get one that does the right thing. It&#39;s not that there&#39;s any kind of shortage out there."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1558542239, "post_id": 56259471, "comment_id": 99138990, "body": "@Mihir  That looks like unwanted sign extension to me, not actual 0xFF bytes in your string literal.  What does it print if you change that entire <code>printf</code> line to read <code>printf(&quot;%02x&quot;, (unsigned int)(unsigned char)a[i]);</code> ?"}, {"owner": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1558542785, "post_id": 56259471, "comment_id": 99139240, "body": "@zwol, it is now c6. Well my program works finally. That was the reason my data structure was failing. the time I changed it to <code>unsigned char *str</code> it works correctly. Thank you so much for your help."}, {"owner": {"reputation": 42447, "user_id": 1016716, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1c83d772b1c065603c7f20975d8d3552?s=128&d=identicon&r=PG", "display_name": "Mr Lister", "link": "https://stackoverflow.com/users/1016716/mr-lister"}, "edited": false, "score": 1, "creation_date": 1558611831, "post_id": 56259471, "comment_id": 99163415, "body": "@Mihir Warning: hex C6 is only the <i>first</i> character of the multibyte sequence that make op \u0182. You should also get a second byte with value hex 82."}], "answers": [{"comments": [{"owner": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "edited": false, "score": 0, "creation_date": 1558539219, "post_id": 56260290, "comment_id": 99137320, "body": "That answers most of my question. But how should I even enable utf-8? e.g., I pass \u0182 as a string to get inserted. When I traverse through string character by char, it reads it as \u2018?\u2019 \u2018? \u2018?\u2019 \u2018?\u2019. How should I make it read it correctly?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "edited": false, "score": 2, "creation_date": 1558539622, "post_id": 56260290, "comment_id": 99137526, "body": "@Mihir We really can&#39;t help you any further until you tell us the <i>numeric value</i> of each of those four bytes.  I can tell you right now that <code>\u0182</code>, encoded in UTF-8, should produce the <i>two-byte</i> sequence 0xC6 0x82, so that makes it practically certain that you are <i>not</i> getting UTF-8, but I still don&#39;t know what you <i>are</i> getting.  It would also help if you showed us the exact code construct that you mean by &quot;I pass \u0182 as a string to get inserted.&quot;"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1558539695, "post_id": 56260290, "comment_id": 99137568, "body": "@JohnBollinger You should probably also mention that UTF-16 and -32 are incompatible with using C&#39;s one-byte <code>\\0</code> string terminators; you can use U+0000 instead, but then you have to work with code units instead of bytes."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "edited": false, "score": 0, "creation_date": 1558539809, "post_id": 56260290, "comment_id": 99137639, "body": "@Mihir Oh, also, we need to know whether or not you are using Windows.  The answer to your <code>setlocale</code> issues changes depending on that."}, {"owner": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1558540146, "post_id": 56260290, "comment_id": 99137821, "body": "@zwol, I use macOS. I have a string like this, <code>char str[] = \u201c \u0182\u201d;</code>. if i loop through each character in this string until \u2018\\0\u2019 is encountered, it will loop 4 times and print \u2018?\u2019 4 times. So simply, it doesn\u2019t break the unicode character down correctly, instead it produces \u2018?\u2019. Sorry, I am pretty new to this stuff. I will make a short program to depict my problem and post its link here."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "edited": false, "score": 0, "creation_date": 1558540591, "post_id": 56260290, "comment_id": 99138048, "body": "@Mihir, supposing that your compiler conforms to C11 (which might require a command-line option), a good bet <i>for literals</i>, such as you describe, is to use utf8 literals: <code>char str[] = u8&quot;\u0182&quot;;</code>.  For data read from external sources, though, you need to either assume that it will come in UTF-8 encoded, or you must be prepared to transcode it to UTF-8 (which requires knowing and supporting its original encoding)."}, {"owner": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "edited": false, "score": 0, "creation_date": 1558540594, "post_id": 56260290, "comment_id": 99138052, "body": "I tried this on some online compilers and they produce different outputs. On my machine it would print \u2018?&#39; 4 times"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "edited": false, "score": 1, "creation_date": 1558540722, "post_id": 56260290, "comment_id": 99138127, "body": "@Mihir I copied your program into your question.  In the future, please provide example code by editing the question, not by using pastebin; we want questions and answers to make sense years from now, and that doesn&#39;t work if they depend on links to external sites that may no longer be valid.  (Did you know you can edit your question? The tiny gray word <code>edit</code> under the links is a button.  Yes, really.  Yes, it&#39;s bad UI design.  Sorry.)"}, {"owner": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1558540833, "post_id": 56260290, "comment_id": 99138206, "body": "@zwol, I am sorry for that. Didn\u2019t come to my mind. Also its just 1 week I joined stack overflow. I will make sure to do it correctly in future"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "edited": false, "score": 0, "creation_date": 1558540845, "post_id": 56260290, "comment_id": 99138212, "body": "In any case, @Mihir, that what prints on the screen does not match what you see in your source file is reflective of a mismatch between assumed and actual encoding.  If this happens when you have not messed with the locale, then that suggests that your source file&#39;s actual encoding differs from what the compiler expects.  There could be an additional mismatch on the output side, too.  All the way around, cooperating components need to know and agree about the encodings used."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "edited": false, "score": 0, "creation_date": 1558540911, "post_id": 56260290, "comment_id": 99138251, "body": "@Mihir No worries.  We were all new to this site once."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1558540162, "last_edit_date": 1558540162, "creation_date": 1558538907, "answer_id": 56260290, "question_id": 56259471, "link": "https://stackoverflow.com/questions/56259471/how-to-read-a-unicode-string-in-form-of-individual-ascii-chars-and-detect-that-i/56260290#56260290", "title": "How to read a unicode string in form of individual ascii chars and detect that it was actually unicode in the fastest way possible?", "body": "<p>UTF-8 is a mechanism for <em>encoding</em> Unicode character sequences as byte sequences, but not the only way.  Unicode does not imply UTF-8, and, technically, UTF-8 does not imply Unicode, either.</p>\n\n<blockquote>\n  <p>When I insert a unicode string, it breaks down into 4 characters(utf-8)</p>\n</blockquote>\n\n<p>That is a function of how you store the string data, and</p>\n\n<ul>\n<li>it sounds broken</li>\n<li>it is probably <em>not</em> using UTF-8, contrary to your assertion</li>\n</ul>\n\n<blockquote>\n  <p>So all I want is when a unicode string gets inserted, it gets inserted\n  as a unique combination which would make it possible to search that\n  string uniquely.</p>\n</blockquote>\n\n<p>That's relatively easy: encode all your strings the same way.  Encoding all of them in UTF-8 would be my choice, but you may also use any other stateless encoding that supports all the characters that may appear in your strings, such as UTF-16 or UTF-32.  But you must use a consistent encoding for all characters of all strings.</p>\n\n<p>Having done that properly, you don't necessarily need to do anything else special to make your trie work.<sup>*</sup>  If you choose UTF-16 or UTF-32, however, then I would suggest structuring the trie around the size of their code units (16- or 32 bits, respectively).  That's not necessary, but it will likely yield advantages in the form of shallower and therefore better-performing tries.</p>\n\n<hr>\n\n<p><sup>*</sup> Note, however, that UTF-16 and UTF-32 code units include many encompassing bytes with value 0, such as 0x0031 and 0x00000200.  If you do treat these as byte sequences instead of code-unit sequences, then you must account for that.  In particular, you must avoid assuming that individual null bytes serve as terminators.</p>\n"}], "owner": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 56260290, "answer_count": 1, "score": 0, "last_activity_date": 1558541321, "creation_date": 1558536340, "last_edit_date": 1558541321, "question_id": 56259471, "link": "https://stackoverflow.com/questions/56259471/how-to-read-a-unicode-string-in-form-of-individual-ascii-chars-and-detect-that-i", "title": "How to read a unicode string in form of individual ascii chars and detect that it was actually unicode in the fastest way possible?", "body": "<p>I am making a library which lets user insert and search key-value pairs as trie data structure. When I insert a unicode string, it breaks down into 4 characters(utf-8)(which is okay), but each character becomes \u2018?\u2019. So I tried using <code>setlocale(LC_ALL, \"\")</code> which didn\u2019t work (or maybe I just dunno what are the right arguments for my case and where to call it). I don\u2019t really care about printing or reading the character as it is. All I want is that it can somehow be represented uniquely. </p>\n\n<p>In my trie there are links like <code>node *next[256]</code>.</p>\n\n<p>So all I want is when  a unicode string gets inserted, it gets inserted as a unique combination which would make it possible to search that string uniquely. \nAlso I want a way to detect that a unicode character was broken down into 4 individual chars. Thats because, e.g., If in a string \u201cwxyz\" a unicode character \u201cx\u201d is broken down into a,b,c,d then trie would store  \u201cwabcdyz\u201d. But if I was actually searching a string wabcdyz(not unicode), then it would find the entry for that string but that would be a mismatch.</p>\n\n<p>Here is a program that shows the unicode character being broken down into four <code>?</code> characters:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    printf(\"Hello World\");\n\n    char a[] = \"\u0182\";\n\n    int i;\n    for(i = 0 ; a[i] != '\\0' ; ++i)\n    {\n        printf(\"%c\", a[i]);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "windows", "gcc", "mingw"], "comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1558536465, "post_id": 56259440, "comment_id": 99135605, "body": "Can you show your <code>Interface.c</code> file (or rather a shorter file that also includes <code>stdio.h</code> and produces the same error message when compiled)?"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1558536480, "post_id": 56259440, "comment_id": 99135616, "body": "Please show a minimal file <code>Interface.c</code> that can be used to reproduce the problem on your system."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1558537060, "post_id": 56259440, "comment_id": 99135980, "body": "The issue is very likely with code (or a header) appearing <i>before</i> your <code>#include &lt;stdio.h&gt;</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1558537119, "post_id": 56259440, "comment_id": 99136028, "body": "To diagnose in any detail, we need a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> demonstrating the issue."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1558537318, "post_id": 56259440, "comment_id": 99136182, "body": "You probably have a missing <code>;</code> or <code>{</code> or <code>}</code> in your <code>.h</code> code. It&#39;s hard for the compiler to find the exact line sometimes; especially in headers."}, {"owner": {"reputation": 1, "user_id": 6534778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf92f52584ca8ba97f8bc6ab818b678?s=128&d=identicon&r=PG&f=1", "display_name": "Nat", "link": "https://stackoverflow.com/users/6534778/nat"}, "edited": false, "score": 0, "creation_date": 1558537676, "post_id": 56259440, "comment_id": 99136411, "body": "Thank you for your comments.  The problem seems to have been fixed by including stdio.h before the problem code."}, {"owner": {"reputation": 1, "user_id": 6534778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf92f52584ca8ba97f8bc6ab818b678?s=128&d=identicon&r=PG&f=1", "display_name": "Nat", "link": "https://stackoverflow.com/users/6534778/nat"}, "edited": false, "score": 0, "creation_date": 1558537746, "post_id": 56259440, "comment_id": 99136460, "body": "Unsure of the protocol for Stack Overflow... If the problem has been solved this quickly should I delete the question or mark it answered?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1558538140, "post_id": 56259440, "comment_id": 99136722, "body": "If it is just a simple typo you can go ahead and delete the question. Be careful not to delete too many of your own questions when you are new though, the site might think that you are trying to vandalize your own content if you do it too often."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6534778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf92f52584ca8ba97f8bc6ab818b678?s=128&d=identicon&r=PG&f=1", "display_name": "Nat", "link": "https://stackoverflow.com/users/6534778/nat"}, "is_accepted": true, "score": 0, "last_activity_date": 1558539629, "creation_date": 1558539629, "answer_id": 56260498, "question_id": 56259440, "link": "https://stackoverflow.com/questions/56259440/why-does-mingws-stdio-h-file-cause-syntax-errors/56260498#56260498", "title": "Why does MinGW&#39;s stdio.h file cause syntax errors?", "body": "<p>The problem was caused by stdio.h being included in the wrong place.  Including it at the beginning of the file fixed the issue.</p>\n"}], "owner": {"reputation": 1, "user_id": 6534778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf92f52584ca8ba97f8bc6ab818b678?s=128&d=identicon&r=PG&f=1", "display_name": "Nat", "link": "https://stackoverflow.com/users/6534778/nat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "closed_date": 1558607473, "accepted_answer_id": 56260498, "answer_count": 1, "score": 0, "last_activity_date": 1558539629, "creation_date": 1558536215, "question_id": 56259440, "link": "https://stackoverflow.com/questions/56259440/why-does-mingws-stdio-h-file-cause-syntax-errors", "closed_reason": "Not suitable for this site", "title": "Why does MinGW&#39;s stdio.h file cause syntax errors?", "body": "<p>I have a C project in Eclipse compiling with MinGW on Windows 7.  I am getting what appear to be syntax errors originating outside my project in stdio.h:</p>\n\n<pre><code>c:\\mingw\\include\\stdio.h:345:12: error: expected '=', ',', ';', 'asm' or '__attribute__' before '__mingw__snprintf'\n extern int __mingw_stdio_redirect__(snprintf)(char*, size_t, const char*, ...);\n            ^~~~~~~~~~~~~~~~~~~~~~~~\nc:\\mingw\\include\\stdio.h:349:12: error: expected '=', ',', ';', 'asm' or '__attribute__' before '__mingw__vsnprintf'\n extern int __mingw_stdio_redirect__(vsnprintf)(char*, size_t, const char*, __VALIST);\n            ^~~~~~~~~~~~~~~~~~~~~~~~\n</code></pre>\n\n<p>The compile command is</p>\n\n<pre><code>gcc -D_WIN32_WINNT=0x0601 -DprojCOVERAGE_TEST=0 -O0 -g3 -Wall -Wextra -c \n-fmessage-length=0 -Wcast-qual -o \"Interface.o\" \"Interface.c\" \n</code></pre>\n\n<p>I would like to understand what is causing these errors in order to compile without editing stdio.h.</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1558536008, "post_id": 56259219, "comment_id": 99135339, "body": "I don&#39;t quite understand the question. There is no global called <code>test</code> anywhere."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1558536039, "post_id": 56259219, "comment_id": 99135355, "body": "You mean you think the warning is not generated in the first case because of the angle-bracket inclusion? I can&#39;t reproduce that behavior. I get a <code>-Wshadow</code> warning in both cases. What version of gcc are you on?"}, {"owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1558536057, "post_id": 56259219, "comment_id": 99135377, "body": "@EugeneSh. The <code>test</code> is a <code>typedef struct test test</code> included from headers"}, {"owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "reply_to_user": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1558536091, "post_id": 56259219, "comment_id": 99135389, "body": "@PSkocik I use <code>gcc (Ubuntu 7.3.0-27ubuntu1~18.04) 7.3.0</code>. What version did you try?"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1558536135, "post_id": 56259219, "comment_id": 99135419, "body": "<code>gcc version 7.4.0 (Ubuntu 7.4.0-6ubuntu1~18.04~ppa1)</code>."}, {"owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "reply_to_user": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1558536442, "post_id": 56259219, "comment_id": 99135591, "body": "@PSkocik I updated <code>gcc</code>  to <code>gcc (Ubuntu 7.4.0-1ubuntu1~18.04) 7.4.0</code> and still don&#39;t get the warning..."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1558536799, "post_id": 56259219, "comment_id": 99135803, "body": "@St.Anario I had originally tested with the header in a user location (added to the angle-bracket header path with <code>&lt;&gt;</code>). Moving it to <code>&#47;usr&#47;include&#47;lib&#47;</code> hid the warning as in your case. Rest in the answer."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1558536780, "post_id": 56259485, "comment_id": 99135787, "body": "But the OP expects a warning for the code <i>in his own source file</i>, not in a system header.  <code>-Wsystem-headers</code> is (supposed to be) about generating warnings for code found in the headers themselves.  It is sensible because it is reasonable to assume the code in such headers to be correct, and because it is outside ordinary users&#39; ability to change anyway."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1558536932, "post_id": 56259485, "comment_id": 99135895, "body": "@JohnBollinger I&#39;d call it a gcc bug that the <code>-Wshadow</code> problem in user code doesn&#39;t generate a warning iff the symbol originates in a system header, but empirically, <code>-Wsystem-headers</code> fixes the problem."}, {"owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1558537087, "post_id": 56259485, "comment_id": 99136011, "body": "@JohnBollinger Is not a file included with <code>&lt; &gt;</code> treated as system headers? Actually inclusion with <code>&quot; &quot;</code> does not fix the problem unless <code>-Wsystem-headers</code> is specified."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "edited": false, "score": 1, "creation_date": 1558537436, "post_id": 56259485, "comment_id": 99136254, "body": "@St.Antario, whether it is a system header is not directly related to the form of <code>#include</code> directive you use, but that&#39;s wholly beside the point.  I&#39;m not suggesting that the header in question should not be considered a system header.  I&#39;m saying that the header is not the location of the code you want to be warned about, and <code>-Wsystem-headers</code> is supposed to modulate only warnings arising from code <b><i>in</b> system headers</i>.  That&#39;s different from &quot;related to system headers&quot;, which is your case."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 4, "last_activity_date": 1558537799, "last_edit_date": 1558537799, "creation_date": 1558536392, "answer_id": 56259485, "question_id": 56259219, "link": "https://stackoverflow.com/questions/56259219/shadowing-declaration-does-not-produce-any-warnings/56259485#56259485", "title": "Shadowing declaration does not produce any warnings", "body": "<p>Headers in system locations have warnings disabled unless you pass <code>-Wsystem-headers</code>.</p>\n\n<p>With <code>-Wsystem-headers -Wshadow</code>, you should get that warning even if the file is in <code>/usr/include</code>.</p>\n\n<p>The option is documented in <a href=\"https://gcc.gnu.org/onlinedocs/gcc-9.1.0/gcc/Warning-Options.html#Warning-Options\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gcc-9.1.0/gcc/Warning-Options.html#Warning-Options</a>:</p>\n\n<blockquote>\n  <p>-Wsystem-headers </p>\n  \n  <p>Print warning messages for constructs found in system header files. Warnings from system headers are normally suppressed, on\n  the assumption that they usually do not indicate real problems and\n  would only make the compiler output harder to read. Using this\n  command-line option tells GCC to emit warnings from system headers as\n  if they occurred in user code. However, note that using -Wall in\n  conjunction with this option does not warn about unknown pragmas in\n  system headers\u2014for that, -Wunknown-pragmas must also be used.</p>\n</blockquote>\n\n<p>Empirically <code>-Wsystem-headers</code> causes the warning to reappear, but the behavior could be considered a gcc bug since the overshadowing happens in user code, not the system header where the overshadowed global originates. </p>\n"}], "owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 56259485, "answer_count": 1, "score": 1, "last_activity_date": 1558537799, "creation_date": 1558535458, "last_edit_date": 1558535548, "question_id": 56259219, "link": "https://stackoverflow.com/questions/56259219/shadowing-declaration-does-not-produce-any-warnings", "title": "Shadowing declaration does not produce any warnings", "body": "<p><code>gcc (Ubuntu 7.3.0-27ubuntu1~18.04) 7.3.0</code></p>\n\n<p>I have a library dev package installed on my system with headers that I use to compile my binary. The external declarations of one of the header files looks as</p>\n\n<p><code>test.h</code>:</p>\n\n<pre><code>#ifndef AAA\n#define AAA\n\ntypedef struct test test;\n\n#endif\n</code></pre>\n\n<p>My binary is</p>\n\n<p><code>main.c</code></p>\n\n<pre><code>#include &lt;lib/test.h&gt;\n\nint main(void){\n    test *test = NULL; //no warning produced\n    (void) test;\n}\n</code></pre>\n\n<p>When compiling with <code>-Wshadow</code> no warning is produced. However if I include a hand-written file with the same declaration as</p>\n\n<p><code>mytest.h</code>:</p>\n\n<pre><code>#ifndef AAA\n#define AAA\n\ntypedef struct test test;\n\n#endif\n</code></pre>\n\n<p><code>main.c</code></p>\n\n<pre><code>#include \"mytest.h\"\n\nint main(void){\n    //warning: declaration of \u2018test\u2019 shadows a global declaration [-Wshadow]\n    test *test = NULL; \n    (void) test;\n}\n</code></pre>\n\n<p>Is that an expected behavior? I was thinking that the warning would be printed in both of the cases</p>\n"}, {"tags": ["c", "windows", "c89"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1558534727, "post_id": 56258831, "comment_id": 99134529, "body": "<a href=\"http://www.mingw.org/\" rel=\"nofollow noreferrer\">mingw.org</a> is a port of gcc for MS, compile using <code>gcc -std=c89 -o app.exe source.c</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1558534761, "post_id": 56258831, "comment_id": 99134543, "body": "Can you show a C89 <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> you&#39;re having trouble with?"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 5, "creation_date": 1558535198, "post_id": 56258831, "comment_id": 99134828, "body": "If anything, that should be the other way around - VS doesn&#39;t fully support C99, so it may fail to build code using C99 features, but it should be rock solid on C89 code.  What build errors are you getting?  Are you sure it&#39;s being compiled as C and not C++?  Are you sure you have all the code you need?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1558535210, "post_id": 56258831, "comment_id": 99134835, "body": "MSVC is not a conforming C99 compiler.  It does not conform completely to C89, either, but its deviations on that side are small and somewhat obscure.  If building puported-C89 code in MSVS (in C mode, not C++ mode) fails or produces a misbehaving executable, then chances are good that it is the program that is broken, not the compiler."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1558535252, "post_id": 56258831, "comment_id": 99134865, "body": "&quot;such as stdio etc. not necessarily being constant&quot; Que?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1558535593, "post_id": 56258831, "comment_id": 99135074, "body": "@Lundin I&#39;m guessing that meant &quot;<code>stdin</code> etc. not necessarily being constant&quot;."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1558535747, "post_id": 56258831, "comment_id": 99135168, "body": "@SteveSummit How is that any clearer though? What is a &quot;constant header&quot;?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1558535981, "post_id": 56258831, "comment_id": 99135315, "body": "I make no sense out of it still."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1558536043, "post_id": 56258831, "comment_id": 99135362, "body": "The good news: Microsoft are 20 years behind every other C compiler on the market. They only have partial support for C99 still. Their C compiler mostly follows C90.  The bad news: Visual C has bad conformance to <i>any</i> C standard. It is to be regarded as a C++ compiler with some sloppy, partial support for C on the side."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1558536272, "post_id": 56258831, "comment_id": 99135506, "body": "@Lundin see the &quot;answer&quot; I just posted."}, {"owner": {"reputation": 1344, "user_id": 562646, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e1dc86932c17fa61ffd81a0a0e63e6b8?s=128&d=identicon&r=PG", "display_name": "digitig", "link": "https://stackoverflow.com/users/562646/digitig"}, "edited": false, "score": 0, "creation_date": 1558577456, "post_id": 56258831, "comment_id": 99150279, "body": "Yes, I meant stdin (and stdout, and stderr) being constant.  And Lundin: the Googling I did before asking the question indicated that Microsoft attributes stdin, etc, not being constant directly to C99 implementation. So 20 years behind is still too recent."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1558801009, "post_id": 56258831, "comment_id": 99223664, "body": "regarding initializing stdin there are a lot of duplicates: <a href=\"https://stackoverflow.com/q/7623735/995714\">Error initializer element is not constant</a>, <a href=\"https://stackoverflow.com/q/35596220/995714\">FILE * ..=stdout : Error initializer element is not constant</a>, <a href=\"https://stackoverflow.com/q/50430284/995714\">Initialize a <code>FILE *</code> variable in C?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1558536079, "post_id": 56258940, "comment_id": 99135386, "body": "&quot;Perfectly capable&quot; -&gt; &quot;somewhat capable, maybe&quot;. But hey, we support gcc too."}, {"owner": {"reputation": 41, "user_id": 1146348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f56d560955e3376d79fcc62f800bf544?s=128&d=identicon&r=PG", "display_name": "The Storm", "link": "https://stackoverflow.com/users/1146348/the-storm"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1558536585, "post_id": 56258940, "comment_id": 99135682, "body": "A better option for alternative Windows compiler is clang, because of it&#39;s binary compatibility with the MS libraries. :)  Also I haven&#39;t met a C89 portable code that the MS compiler can&#39;t compile."}], "tags": [], "owner": {"reputation": 41, "user_id": 1146348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f56d560955e3376d79fcc62f800bf544?s=128&d=identicon&r=PG", "display_name": "The Storm", "link": "https://stackoverflow.com/users/1146348/the-storm"}, "is_accepted": false, "score": 1, "last_activity_date": 1562164674, "last_edit_date": 1562164674, "creation_date": 1558534594, "answer_id": 56258940, "question_id": 56258831, "link": "https://stackoverflow.com/questions/56258831/is-it-possible-to-compile-c89-code-on-ms-windows/56258940#56258940", "title": "Is it possible to compile C89 code on MS Windows?", "body": "<p>All supported (and even older) versions of Visual Studio are perfectly capable of compiling C89 code. Also C99 is backward compatible with previous revisions of the language, so a C99 compiler should be able to compile just fine C89 code.</p>\n\n<p>Although you might get some warnings, the code should compile and work just fine if the code is portable of course.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1558537215, "post_id": 56259437, "comment_id": 99136082, "body": "There&#39;s no guarantee that stdin is a compile-time constant in any version of C and it has not changed since C90. The standard just says it is of type <code>FILE*</code>."}, {"owner": {"reputation": 1344, "user_id": 562646, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e1dc86932c17fa61ffd81a0a0e63e6b8?s=128&d=identicon&r=PG", "display_name": "digitig", "link": "https://stackoverflow.com/users/562646/digitig"}, "edited": false, "score": 0, "creation_date": 1558575704, "post_id": 56259437, "comment_id": 99149983, "body": "That&#39;s exactly the main issue I&#39;m getting - many many times, across multiple files and buried in data structures, so rewrite probably isn&#39;t a good idea - I&#39;ve nothing to test the rewrite against. It looks as if I need to find a compiler that does support that assumption."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 1344, "user_id": 562646, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e1dc86932c17fa61ffd81a0a0e63e6b8?s=128&d=identicon&r=PG", "display_name": "digitig", "link": "https://stackoverflow.com/users/562646/digitig"}, "edited": false, "score": 0, "creation_date": 1560715384, "post_id": 56259437, "comment_id": 99817358, "body": "@digitig: Some platforms may use data structures for file handling that map nicely to <code>FILE*</code>, but which do not determine where <code>stdin</code> will be until the program is executed.  While it would be possible for an implementation targeting such a platform to make <code>FILE*</code> be a wrapper around the implementation&#39;s internal type, doing so would mean that modules compiled with that implementation would be incompatible with those compiled using others.  That may be a worthwhile trade-off for some purposes, but not one that I would particularly expect implementations to support."}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 2, "last_activity_date": 1558537322, "last_edit_date": 1558537322, "creation_date": 1558536206, "answer_id": 56259437, "question_id": 56258831, "link": "https://stackoverflow.com/questions/56258831/is-it-possible-to-compile-c89-code-on-ms-windows/56259437#56259437", "title": "Is it possible to compile C89 code on MS Windows?", "body": "<p>[This isn't really an answer, but it's too elaborate for a comment.]</p>\n\n<p>If you've got code that does things like</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nFILE *ifp = stdin;\nint main() { ... }\n</code></pre>\n\n<p>and if the problem you're having is errors stating that <code>stdin</code> is not a compile-time constant suitable for a static initializer, I think you're going to have to rewrite that aspect of your code.  I could be wrong, but if I remember correctly, the idea that <code>stdin</code> et al. were compile-time constants was never a guarantee, just a useful property of the earliest Unix implementations.  It wasn't necessarily true of all old implementations, so the \"change\" to the Standard that explicitly said they weren't necessarily constant wasn't a change <em>per se</em>, but rather, more or less a codification of the divergence of existing practice.</p>\n\n<p>(In other words, if you've got a compiler that's rejecting the code, and even if it has a backwards-compatibility mode, I'd be surprised if the backwards-compatibility mode turned <code>stdin</code> into a compile-time constant.)</p>\n"}, {"comments": [{"owner": {"reputation": 1344, "user_id": 562646, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e1dc86932c17fa61ffd81a0a0e63e6b8?s=128&d=identicon&r=PG", "display_name": "digitig", "link": "https://stackoverflow.com/users/562646/digitig"}, "edited": false, "score": 0, "creation_date": 1562113605, "post_id": 56306929, "comment_id": 100272568, "body": "I don&#39;t see anything wrong with it, but it doesn&#39;t solve my problem, because the assumption of the standard streams being constant is woven throughout the legacy code and will be tricky to unravel."}, {"owner": {"reputation": 591, "user_id": 5773004, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1b56505987c4fc700395dc53896785e1?s=128&d=identicon&r=PG&f=1", "display_name": "FlashMcQueen", "link": "https://stackoverflow.com/users/5773004/flashmcqueen"}, "edited": false, "score": 0, "creation_date": 1606984461, "post_id": 56306929, "comment_id": 115130750, "body": "@phuclv is there somewhere a list of the C99 extensions Visual Studio supports in C99?"}], "tags": [], "owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "is_accepted": false, "score": 3, "last_activity_date": 1558803617, "last_edit_date": 1592644375, "creation_date": 1558803617, "answer_id": 56306929, "question_id": 56258831, "link": "https://stackoverflow.com/questions/56258831/is-it-possible-to-compile-c89-code-on-ms-windows/56306929#56306929", "title": "Is it possible to compile C89 code on MS Windows?", "body": "<p>MSVC is a C++ compiler and has just gained C99 support recently. Previously it supports only C89 with some MS extensions. To compile in strict C89 mode use the <code>/Za</code> option. Make sure to also enable <code>/Tc</code> to use C mode</p>\n<blockquote>\n<h1><a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/za-ze-disable-language-extensions?view=vs-2019\" rel=\"nofollow noreferrer\"><code>/Za</code>, <code>/Ze</code> (Disable Language Extensions)</a></h1>\n<p>The <code>/Za</code> compiler option disables and emits errors for Microsoft extensions to C that aren't compatible with ANSI C89/ISO C90. The deprecated <code>/Ze</code> compiler option enables Microsoft extensions. Microsoft extensions are enabled by default.</p>\n</blockquote>\n<p>See <a href=\"https://stackoverflow.com/q/42043078/995714\">Enforce ANSI C Standard in Visual Studio 2015</a></p>\n<p>Most other compilers use other options like <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Standards.html\" rel=\"nofollow noreferrer\"><code>-ansi</code>, <code>-std=c90</code> or <code>-std=iso9899:1990</code></a></p>\n<hr />\n<p>However if this is just about stdin/stdout not being constant while using in a static initializer list then it's completely irrelevant to C89 and is actually an <a href=\"https://meta.stackexchange.com/q/66377/230282\">XY problem</a>. The following snippet compiles without problem in VS2019 C++ mode, so if you don't have any possible conflict just compile the code in C++ mode</p>\n<pre><code>#include &lt;stdio.h&gt;\nFILE* ifp = stdout;\nint main()\n{\n    fprintf(ifp, &quot;test\\n&quot;);\n    return 0;\n}\n</code></pre>\n<p>Otherwise it's easy to fix that to compile in C mode by moving the initialization into <code>main()</code></p>\n<pre><code>FILE* ifp = NULL;\nint main()\n{\n    ifp = stdout;\n    fprintf(ifp, &quot;test\\n&quot;);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1344, "user_id": 562646, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e1dc86932c17fa61ffd81a0a0e63e6b8?s=128&d=identicon&r=PG", "display_name": "digitig", "link": "https://stackoverflow.com/users/562646/digitig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 952, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1562164674, "creation_date": 1558534267, "last_edit_date": 1558576037, "question_id": 56258831, "link": "https://stackoverflow.com/questions/56258831/is-it-possible-to-compile-c89-code-on-ms-windows", "title": "Is it possible to compile C89 code on MS Windows?", "body": "<p>I'm trying to work with some legacy C89 code, and am having trouble getting it to build. My usual environment is Visual Studio, but that only seems to support C99, and some C99 features (such as stdio etc. not necessarily being constant) break the code - a <em>lot</em>. Before I start tampering with the code I want to write some tests, so I don't break the old behaviour, but I can't test the tests, so to speak, before I can get the code to build.</p>\n\n<p>So is there still any way to compile C89 code on Windows?</p>\n\n<p>Edit: Steve Summit has identified that stdio and so on has <em>never</em> been guaranteed; it's just a feature of some compilers that my legacy code happens to depend on, in a rather deeply embedded way. So my question shifts to whether there is any Windows C compiler available (preferably free!) for Windows that supports that assumption. Alternatively, I have an Ubuntu installation in a virtual machine, although I have little experience using it - is there such a compiler available in Ubuntu?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2511, "user_id": 3936476, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/kjSSo.png?s=128&g=1", "display_name": "ventaquil", "link": "https://stackoverflow.com/users/3936476/ventaquil"}, "edited": false, "score": 0, "creation_date": 1558534030, "post_id": 56258698, "comment_id": 99134087, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/840501/how-do-function-pointers-in-c-work\">How do function pointers in C work?</a>"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 3, "creation_date": 1558534034, "post_id": 56258698, "comment_id": 99134090, "body": "In <code>System_Init</code> I do not see anything of <code>System_Handler</code>. So what do you mean?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1558534093, "post_id": 56258698, "comment_id": 99134130, "body": "Please read this: <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>  and show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1558534109, "post_id": 56258698, "comment_id": 99134139, "body": "Is the System_Init argument supposed to be a System_Handler not a Switch_Handler? (And a pointer type?) And if you&#39;re passing in a function pointer then I&#39;m not sure what you&#39;re trying to do in accessing its arguments: the point is you can call the pointer, you&#39;re not implementing the function parameter there."}], "answers": [{"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 3, "last_activity_date": 1558534107, "creation_date": 1558534107, "answer_id": 56258783, "question_id": 56258698, "link": "https://stackoverflow.com/questions/56258698/function-pointer-handler/56258783#56258783", "title": "Function Pointer handler", "body": "<p>Function pointers don't come bundled with a set of function arguments. \nYou have to provide the arguments separately, usually by passing them alongside with the function pointer:</p>\n\n<pre><code>typedef void (*System_Handler)(unsigned int short indx, char val);\n\nvoid System_Init(System_Handler sw_hdl, unsigned short indx, char val)\n{\n  unsigned short int test; \n  test = indx;\n  //...\n  sw_hdl(indx,val);\n}\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 5762169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae6df69ae163889e4dcd73fc335cce0b?s=128&d=identicon&r=PG&f=1", "display_name": "Rajeesh Rarankurissi", "link": "https://stackoverflow.com/users/5762169/rajeesh-rarankurissi"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 1, "closed_date": 1558535174, "answer_count": 1, "score": -5, "last_activity_date": 1558534107, "creation_date": 1558533815, "last_edit_date": 1558533932, "question_id": 56258698, "link": "https://stackoverflow.com/questions/56258698/function-pointer-handler", "closed_reason": "Needs details or clarity", "title": "Function Pointer handler", "body": "<p>I am trying to write function for Initialise system while inserting a function pointer for System triggered handling with System index and the value\nSo How can I access the variables <code>index</code> and <code>val</code> in <code>System_Init</code> function </p>\n\n<pre><code>typedef void (*System_Handler)(unsigned int short indx, char val);\n\nvoid System_Init(Switch_Handler sw_hdl)\n{\n  unsigned short int test; \n  test = indx;\n  /* Need to access variables indx and val  Here . How can we do ?*/\n}\n</code></pre>\n"}, {"tags": ["c", "operator-precedence"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 6, "creation_date": 1558532959, "post_id": 56258385, "comment_id": 99133326, "body": "No, parentheses are used just as much to force operator precedence, exactly as is done in simple math."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1558533096, "post_id": 56258385, "comment_id": 99133425, "body": "<code>parenthesis operator</code>.. interesting, where did you find that?"}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1558533150, "post_id": 56258385, "comment_id": 99133465, "body": "It means that when <code>()</code> is used for a function call (irrelevant of however else it may be used) it has precedence 1. A bit further down you can see <code>(type) Type cast</code> with precedence 2, for instance."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1558533161, "post_id": 56258385, "comment_id": 99133469, "body": "Looks like you missed some chapters from the standard. Ex. 6.5.1p5"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1558533165, "post_id": 56258385, "comment_id": 99133470, "body": "Try searching the C grammar page for <code>&#39;(&#39;</code>. They&#39;re used in many more places than just in postfix expressions (=&gt; function calls)."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1558533274, "post_id": 56258385, "comment_id": 99133558, "body": "<code>x = a * (b+c)-(d*e)</code> is an expression, not a statement. Here <code>(</code> is not an operator. The term &quot;parentheses operator&quot; refers to where <code>()</code> are used as an operator.   Similarly in <code>int *p = 0;</code> the <code>*</code> and <code>=</code> are not operators, even though the same symbols are used for operators in different contexts"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1558533301, "post_id": 56258385, "comment_id": 99133576, "body": "@KamilCuk So what you&#39;re saying is that primary expression and that () is NOT an operator?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1558533321, "post_id": 56258385, "comment_id": 99133591, "body": "<a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.5.1\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.5.1</a>"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1558533384, "post_id": 56258385, "comment_id": 99133627, "body": "@SouravGhosh On the page I linked."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1558533516, "post_id": 56258385, "comment_id": 99133732, "body": "@Broman Re-read that one. It&#39;s function call operator, not parenthesis operator."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1558533562, "post_id": 56258385, "comment_id": 99133768, "body": "@SouravGhosh So regular parenthesis is not an operator?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1558533584, "post_id": 56258385, "comment_id": 99133786, "body": "@Broman Nope, they are not."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1558533793, "post_id": 56258385, "comment_id": 99133919, "body": "The root of the problem is that the linked precedence table is complete and utter trash. There&#39;s so much wrong with it that we should petition to cppreference to shut down that page. It cannot be salvaged."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1558534075, "post_id": 56258385, "comment_id": 99134118, "body": "@Lundin That sounds like a good foundation for a nice answer. I made an answer once based on a rant on tutorialspoint."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1558534133, "post_id": 56258385, "comment_id": 99134152, "body": "It seems that (one of) my misunderstanding is to assume that regular parentheses are considered operators, but no answer below touches that particular issue"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1558534198, "post_id": 56258385, "comment_id": 99134206, "body": "@Lundin Really?  I&#39;ve found it to be a good reference which help the average reader to understand operator precedence without having to grok the full language grammar from the standard."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1558534388, "post_id": 56258385, "comment_id": 99134320, "body": "@Lundin Here it is: <a href=\"https://stackoverflow.com/a/55731680/6699433\">stackoverflow.com/a/55731680/6699433</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1558535095, "post_id": 56258385, "comment_id": 99134758, "body": "I once started some project to provide a reliable precedence table for SO but it stranded. My main objection against the cppreference one is wrong names for almost every operator."}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1558535036, "post_id": 56258439, "comment_id": 99134724, "body": "The grammar for a function call is \u201c<i>postfix-expression</i> <code>(</code> <i>argument-expression-list</i> <code>)</code>\u201d, where the <i>argument-expression-list</i> is optional. The <i>postfix-expression</i> does not need to be an identifier. It can be a pointer to a function, even a function call that returns a pointer to a function."}, {"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1558537749, "post_id": 56258439, "comment_id": 99136461, "body": "@EricPostpischil: You are correct. I took a guess at OP&#39;s level and wrote accordingly."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1558562203, "post_id": 56258439, "comment_id": 99147328, "body": "You can edit your answer. I often face the problem of addressing a novice while also wanting to present the complete truth, and there are various approaches. You can write that \u201c<i>identifer</i> <code>(</code> <i>arguments</i> <code>)</code>\u201d is always a function call, and that parentheses without an expression immediately before them are a parenthesized expression or a cast (and not a function call), and then you can add later that \u201c<i>postfix-expression</i> <code>(</code> <i>arguments</i> <code>)</code>\u201d is also a function call, which is used with pointers to functions as well as function names."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1558562406, "post_id": 56258439, "comment_id": 99147387, "body": "It could also be good to mention that the C grammar, which is a formal description of the structure of C source code, makes it always possible to tell them apart."}], "tags": [], "owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "is_accepted": false, "score": 2, "last_activity_date": 1558574610, "last_edit_date": 1558574610, "creation_date": 1558533060, "answer_id": 56258439, "question_id": 56258385, "link": "https://stackoverflow.com/questions/56258385/are-parentheses-always-considered-a-function-call/56258439#56258439", "title": "Are parentheses always considered a function call?", "body": "<p>No. identifier( calls identifier as a function. If there's no identifier or complete expression immediately left of the parentheses there is no call.</p>\n\n<p>When I was first learning c I had the opposite problem. I couldn't figure out why <code>clrscr;</code> didn't clear the screen. (It's an expression that evaluates to a pointer to <code>clrscr</code> but does nothing with it).</p>\n\n<p>In fact you can have expressions of type pointer to function, and those expressions can be called with (), and the grammar is completely unambiguous between the two. So <code>clrscr();</code> is a function call, and so is <code>(clrscr)()</code>. On reaching function pointers, we can do <code>resolve_function()()</code> as well. The operation is always ( immediately after an expression, not after an operator. If it's after an operatior, it must be grouping parenthesis.</p>\n"}, {"comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1558535770, "post_id": 56258528, "comment_id": 99135180, "body": "Could you add something about the fact that parenthesis is not always considered an operator. That what seems to be (one of) my misunderstandings."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 6, "last_activity_date": 1558537855, "last_edit_date": 1558537855, "creation_date": 1558533329, "answer_id": 56258528, "question_id": 56258385, "link": "https://stackoverflow.com/questions/56258385/are-parentheses-always-considered-a-function-call/56258528#56258528", "title": "Are parentheses always considered a function call?", "body": "<p>Parenthesis can be used as a function call operator, but that's not the only thing they're used for.  They are also used for expression grouping as in your example.</p>\n\n<p>What you're looking for is in section 6.5.1 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a> which discusses Primary Expressions:</p>\n\n<blockquote>\n  <p>Syntax</p>\n  \n  <p><em>1</em></p>\n\n<pre><code>primary-expression:\n  identifier\n  constant\n  string-literal\n  ( expression )\n  generic-selection\n</code></pre>\n  \n  <p>...</p>\n  \n  <p><em>5</em> <strong>A parenthesized  expression  is  a  primary  expression.</strong>   Its type  and  value  are  identical  to those of the unparenthesized\n  expression.  It is an lvalue, a function designator, or a void\n  expression  if  the  unparenthesized  expression  is,  respectively, \n  an  lvalue,  a  function designator, or a void expression.</p>\n</blockquote>\n\n<p>As stated above, parenthesis can be used to group expressions.</p>\n\n<p>The use as a function call operator is detailed in section 6.5.2 on Postfix Expressions:</p>\n\n<blockquote>\n<pre><code>postfix-expression:\n  ...\n  postfix-expression(argument-expression-list opt)\n  ...\n</code></pre>\n</blockquote>\n\n<p>So in your expression:</p>\n\n<pre><code>x = a * (b+c)-(d*e)\n</code></pre>\n\n<p>The use of parenthesis here matches a Primary Expression but not a Postfix Expression.</p>\n\n<p>Also, besides expression grouping, parenthesis are used in other parts of the language grammar.  Section 6.8.4 regarding Selection Statements uses parenthesis in the grammar of <code>if</code> and <code>switch</code> statements:</p>\n\n<blockquote>\n  <ul>\n  <li>if (<em>expression</em>) <em>statement</em></li>\n  <li>if (<em>expression</em>) <em>statement</em> else <em>statement</em></li>\n  <li>switch (<em>expression</em>) <em>statement</em></li>\n  </ul>\n</blockquote>\n\n<p>And section 6.8.5 regarding Iteration Statements also use parenthesis in the grammar of <code>while</code> and <code>for</code> statements.</p>\n\n<blockquote>\n  <ul>\n  <li>while (<em>expression</em>) <em>statement</em></li>\n  <li>do <em>statement</em> while (<em>expression</em>);</li>\n  <li>for (<em>expression<sub>opt</sub></em>; <em>expression<sub>opt</sub></em>; <em>expression<sub>opt</sub></em>) <em>statement</em></li>\n  <li>for (<em>declaration</em>  <em>expression<sub>opt</sub></em>; <em>expression<sub>opt</sub></em> ) <em>statement</em></li>\n  </ul>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1558534508, "post_id": 56258591, "comment_id": 99134396, "body": "<code>(*p)()</code> and <code>(*p)</code> are both <i>postfix-expression</i>, maybe slightly confusing to the newbie. When talking about function calls, the term &quot;the postfix-expression&quot; normally refers to the expression before the function call operator."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 4, "last_activity_date": 1558538042, "last_edit_date": 1558538042, "creation_date": 1558533455, "answer_id": 56258591, "question_id": 56258385, "link": "https://stackoverflow.com/questions/56258385/are-parentheses-always-considered-a-function-call/56258591#56258591", "title": "Are parentheses always considered a function call?", "body": "<p>A function call is a postfix expression.</p>\n\n<p>Here in these expressuins</p>\n\n<pre><code>x = a * (b+c)-(d*e);\n</code></pre>\n\n<p>subexpressioins <code>(b+c)</code> and <code>(d*e)</code> are primary expressions. You may enclose any expression in parentheses and you'll get a primary expression.</p>\n\n<p>For example you could even rewrite the expression statement the following way</p>\n\n<pre><code>( x = ( ( ( a ) * (b+c) )-(d*e) ) );\n</code></pre>\n\n<p>In this expression statement there are the following primary expressions</p>\n\n<pre><code>( a )\n(b+c)\n(d*e)\n( ( a ) * (b+c) )\n( ( ( a ) * (b+c) )-(d*e) )\n( x = ( ( ( a ) * (b+c) )-(d*e) ) )\n</code></pre>\n\n<p>Here are some examples of postfix expressions</p>\n\n<pre><code>( *p )() // a function call\n\na[n] // using the subscript operator\n\nx++; // using the postfix increment operator\n</code></pre>\n\n<p>The definition of a function call is</p>\n\n<pre><code>postfix-expression:\n    primary-expression\n    postfix-expression ( argument-expression-listopt )\n</code></pre>\n\n<p>From the C Standard (6.5.2.2 Function calls)</p>\n\n<blockquote>\n  <p>1 The expression that denotes the called function92) shall have type\n  pointer to function returning void or returning a complete object type\n  other than an array type.</p>\n</blockquote>\n\n<p>Here are some examples of weird function calls.:)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid f( void )\n{\n    printf( \"Hello \" );\n}\n\nvoid g( void )\n{\n    puts( \"Broman\" );\n}    \n\nint main( void )\n{\n    void ( *funcs[] )( void ) = { f, g };\n\n    void ( **p_func )( void ) = funcs;\n\n    ( *p_func++ )();\n    p_func[0]();\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>Hello Broman\n</code></pre>\n\n<p>Take into account that in these calls</p>\n\n<pre><code>    ( *p_func++ )();\n    p_func[0]();\n</code></pre>\n\n<p>expression <code>( *p_func++ )</code> is a primary expression and expression <code>p_func[0]</code> is a postfix expression (See the partial definition of the postfix expression above)</p>\n"}], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 56258528, "answer_count": 3, "score": 4, "last_activity_date": 1558574610, "creation_date": 1558532905, "last_edit_date": 1558534016, "question_id": 56258385, "link": "https://stackoverflow.com/questions/56258385/are-parentheses-always-considered-a-function-call", "title": "Are parentheses always considered a function call?", "body": "<p>I was looking at this page: <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/c/language/operator_precedence</a></p>\n\n<p>What caught my attention was that the <em>only</em> description of the parenthesis operator was <em>function call</em>. Does this mean that the expression <code>x = a * (b+c)-(d*e)</code> has two function calls?</p>\n\n<p>I searched in <a href=\"https://www.lysator.liu.se/c/ANSI-C-grammar-y.html\" rel=\"nofollow noreferrer\">C grammar</a> and <a href=\"https://port70.net/~nsz/c/c11/n1570.html\" rel=\"nofollow noreferrer\">C standard</a> but I was unable to find anything that either supports or contradicts this.</p>\n"}, {"tags": ["c", "permutation", "modulo"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 7, "creation_date": 1558532529, "post_id": 56258266, "comment_id": 99133063, "body": "What is permutation of a number?"}, {"owner": {"reputation": 181, "user_id": 8598112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14Gg-gN2-mT-8olkhAPjq6VQqQkIRgWjwnwgMJ7-dFA=k-s128", "display_name": "Hamza Ince", "link": "https://stackoverflow.com/users/8598112/hamza-ince"}, "edited": false, "score": 0, "creation_date": 1558532622, "post_id": 56258266, "comment_id": 99133115, "body": "Could you please show what you tried?"}, {"owner": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "edited": false, "score": 0, "creation_date": 1558532808, "post_id": 56258266, "comment_id": 99133230, "body": "If I understand correctly, for example, you have an array { 2, 3, 4 } and you&#39;re trying all possible modulo operations like 2%3, 2%4, 3%2, 3%4, 4%2 and 4%3?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1558534553, "post_id": 56258266, "comment_id": 99134422, "body": "Do you mean permutations of a given number <i>of elements</i>?  But even if that&#39;s what you do mean, I&#39;ve no idea how modulo 8 fits in that picture."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1558534889, "post_id": 56258266, "comment_id": 99134628, "body": "I guess that you want numbers that can be obtained from permuting the digits of a given number like {123, 12, 213, 231, 312, 321}. Further, I guess that you get &quot;time limit exceeded&quot; an an online competition. <code>:)</code> If so: 1000 \u2261 0 (<b>mod</b> 8), so if you have long numbers with <i>n</i> digits, it is sufficient to pick all 3-digit combinations, of which there are <i>n</i>! / (<i>n</i> \u2212 3)!"}], "answers": [{"tags": [], "owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "is_accepted": false, "score": 1, "last_activity_date": 1558538012, "creation_date": 1558538012, "answer_id": 56260025, "question_id": 56258266, "link": "https://stackoverflow.com/questions/56258266/highest-modulo-of-a-group-of-numbers/56260025#56260025", "title": "Highest modulo of a group of numbers", "body": "<p>There is no faster way.</p>\n\n<p>If the number wasn't a power of two, it would be slow, but the compiler knows how to handle this, because <code>y = x % 8;</code> is the same as <code>y = x &amp; 0x7;</code>.  So it only needs two operations to do the job: first extract the 3 LSbits, and then compare.</p>\n\n<p>No possible microoptimizations here.</p>\n"}], "owner": {"reputation": 9, "user_id": 11446803, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Z-WLrJPj24E/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehej6eH6zLV419p8Ka09D7f9pdvw/mo/photo.jpg?sz=128", "display_name": "Marin Vilic", "link": "https://stackoverflow.com/users/11446803/marin-vilic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558538012, "creation_date": 1558532477, "question_id": 56258266, "link": "https://stackoverflow.com/questions/56258266/highest-modulo-of-a-group-of-numbers", "title": "Highest modulo of a group of numbers", "body": "<p>I wrote some code that goes through all permutations of a given number and return the one that has the highest modulo of 8.</p>\n\n<p>What I'm wondering now, is there an algorithm/ruleset by which I could automatically exclude permutations that cannot have a modulo of 8 higher than the current number?</p>\n\n<p>I've been mulling it over and can't figure it out, but I feel certain that there is something that can be done to optimize the number of permutations that are checked. </p>\n\n<p>Modular arithmetic isn't really my strong suit. </p>\n\n<p>Thank you in advance if you have any ideas! </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1558531903, "post_id": 56258014, "comment_id": 99132637, "body": "you should read about <code>implicit arithmetic conversions</code>.  <a href=\"https://en.cppreference.com/w/c/language/conversion#Usual_arithmetic_conversions\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/language/&hellip;</a>"}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1558531923, "post_id": 56258014, "comment_id": 99132656, "body": "No variable needs to be widened. You can type <code>c = (uint64_t)a * b * c;</code> as well."}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1558532224, "post_id": 56258014, "comment_id": 99132842, "body": "@user1810087 It&#39;s not &quot;widening&quot; of a variable (in a sense OP uses this term). It just creates a temporary from a casted value of a variable, which remains untouched."}], "answers": [{"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1558532317, "post_id": 56258099, "comment_id": 99132904, "body": "More strictly the type might be <code>int</code> if <code>int</code> is wider than <code>uint32_t</code>."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1558532435, "post_id": 56258099, "comment_id": 99132986, "body": "@eerorika: But an expression consisting of an <code>int</code> and a <code>uint32_t</code> might be a <code>uint32_t</code>."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1558532488, "post_id": 56258099, "comment_id": 99133032, "body": "@Bathsheba oh yea. I was assuming two <code>uint8_t</code> which is not the case here."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1558532522, "post_id": 56258099, "comment_id": 99133055, "body": "@eerorika: Indeed, it&#39;s subtle - one reason why I waded in with an answer."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1558533056, "post_id": 56258099, "comment_id": 99133397, "body": "@Bathsheba Are you sure it will get promoted to a <i>signed</i> int?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1558533207, "post_id": 56258099, "comment_id": 99133495, "body": "@Broman: Yup, the type of <code>unsigned char * unsigned char</code> is an <code>int</code>, for example."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1558534733, "post_id": 56258099, "comment_id": 99134531, "body": "<code>b</code> is not promoted to <code>uint32_t</code>. The <i>integer promotions</i> would make it <code>int</code> at most. After the integer promotions, the <i>usual arithmetic conversions</i> convert it to the type of <code>a</code>, if <code>a</code> is wider than <code>int</code>."}], "tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": 3, "last_activity_date": 1558532550, "last_edit_date": 1558532550, "creation_date": 1558531967, "answer_id": 56258099, "question_id": 56258014, "link": "https://stackoverflow.com/questions/56258014/data-size-definition-in-c-programming-while-using-mathematical-expressions/56258099#56258099", "title": "Data size definition in C programming while using mathematical expressions", "body": "<p>When you perform the multiplication <code>a * b * d</code>, what will happen is that <code>b</code> and <code>d</code> will get <em>promoted</em> to <code>uint32_t</code> (or <code>int</code> if <code>int</code> is wider than <code>uint32_t</code>) to match the type of <code>a</code>. However, this operation might overflow. So what you need to do is to cast at least one of them to <code>uint_64_t</code> to prevent this from happening.</p>\n\n<p>Do note that <code>(uint64_t)(a * b * d)</code> will NOT work. Type casts has lower priority than parenthesis.</p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1558534649, "post_id": 56258177, "comment_id": 99134491, "body": "Actually, I think the <i>crux</i> of the issue is the OP\u2019s belief or hypothesis that the evaluation is affected by the target of the assignment. Stating that expression evaluation is determined by the operands and is not affected by the target of an eventual assignment would put them on the right track."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1558534727, "post_id": 56258177, "comment_id": 99134526, "body": "@EricPostpischil: That&#39;s what I meant to say but presumably it doesn&#39;t come over clearly enough."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1558534755, "last_edit_date": 1558534755, "creation_date": 1558532189, "answer_id": 56258177, "question_id": 56258014, "link": "https://stackoverflow.com/questions/56258014/data-size-definition-in-c-programming-while-using-mathematical-expressions/56258177#56258177", "title": "Data size definition in C programming while using mathematical expressions", "body": "<p><code>a * b * d</code> is an expression of type <code>uint32_t</code>, or <code>int</code> if <code>int</code> is wider than <code>uint32_t</code> (due to the conversion rule for <code>uint8_t</code>).</p>\n\n<p>The fact that this expression is assigned to a wider type is not a factor. <em>That's</em> the crux of the issue.</p>\n\n<p>Writing <code>c = 1ULL * a * b * d</code> is a tractable fix.</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1558535735, "post_id": 56258932, "comment_id": 99135164, "body": "Best answer I&#39;ve seen all week."}, {"owner": {"reputation": 53, "user_id": 6327802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6422b144ef72b0f8eb3740d4902ebb5e?s=128&d=identicon&r=PG&f=1", "display_name": "T.Barta", "link": "https://stackoverflow.com/users/6327802/t-barta"}, "edited": false, "score": 0, "creation_date": 1558621283, "post_id": 56258932, "comment_id": 99168942, "body": "That is a great amount of information, and it took me time to understand, but really appreciate the help. Originally my aim was to save space in an 8 bit microprocessor environment, therefore I tried to use as narrow variables as can store the value of it. In the future I will take the above tips into account."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 2, "last_activity_date": 1558534570, "creation_date": 1558534570, "answer_id": 56258932, "question_id": 56258014, "link": "https://stackoverflow.com/questions/56258014/data-size-definition-in-c-programming-while-using-mathematical-expressions/56258932#56258932", "title": "Data size definition in C programming while using mathematical expressions", "body": "<p>In C, the evaluation of an expression is determined by the operator and its operands, not by where the result will eventually be stored.</p>\n\n<p>The expression <code>a * b * d</code> is structured as <code>(a * b) * d</code>. So <code>a * b</code> is evaluated, and then the result is multiplied by <code>d</code>.</p>\n\n<p>One of the rules for <code>*</code> is in C 2018 6.5.5 3:</p>\n\n<blockquote>\n  <p>The usual arithmetic conversions are performed on the operands.</p>\n</blockquote>\n\n<p>The <em>usual arithmetic conversions</em> are defined in 6.3.1.8 1. They are a bit complicated, and I give most of the details below. Applying them to your example:</p>\n\n<ul>\n<li>In <code>a * b</code>, <code>a</code> is a <code>uint32_t</code> , and <code>b</code> is a <code>uint8_t</code>.</li>\n<li>The <em>integer promotions</em> convert <code>b</code> to an <code>int</code>\u2014essentially all arithmetic in <code>C</code> is done in a width of at least <code>int</code>.</li>\n<li>If <code>int</code> is 32 bits or narrower, <code>a</code> remains <code>uint32_t</code>. Otherwise, <code>a</code> is converted to <code>int</code>.</li>\n<li>If converted types of <code>a</code> and <code>b</code> are both <code>int</code>, the conversions are done, and the multiplication is performed.</li>\n<li>If the converted type of <code>a</code> is <code>uint32_t</code>, <code>b</code> is converted to <code>uint32_t</code>, and the multiplication is performed.</li>\n<li>Then the multiplication with <code>d</code> is performed the same way.</li>\n</ul>\n\n<p>So, if <code>int</code> is 32 bits or narrower, the multiplications are performed with <code>uint32_t</code>, and the result is <code>uint32_t</code>. If <code>int</code> is wider, the multiplications are performed with <code>int</code>, and the result is <code>int</code>.</p>\n\n<p>Casting either operand to <code>uint64_t</code> would cause the arithmetic to be done with <code>uint64_t</code>. (Except it is theoretically possible that <code>int</code> is wider than <code>uint64_t</code>, in which case the arithmetic would be done with <code>int</code>, but that is still satisfactory\u2014performing a cast guarantees the arithmetic will be done with at least that width.)</p>\n\n<p>For real numbers, the usual arithmetic conversions are largely:</p>\n\n<ul>\n<li>If either operand is <code>long double</code>, the other is converted to <code>long double</code>.</li>\n<li>Otherwise, if either is <code>double</code>, the other is converted to <code>double</code>.</li>\n<li>Otherwise, if either is <code>float</code>, the other is converted to <code>float</code>.</li>\n<li>Otherwise, the <em>integer promotions</em> are performed on both operands.</li>\n<li>Then, if both have the same type, no further conversion is performed.</li>\n<li>Otherwise, if both are signed or both are unsigned, the narrower (actually \u201clesser rank\u201d) operand is converted to the type of the other.</li>\n<li>Otherwise, if the unsigned operand is the same width or wider (greater or equal rank), the signed operand is converted to the type of the unsigned operand.</li>\n<li>Otherwise, if the type of the signed operand can represent all the values of the type of the unsigned operand, the unsigned operand is converted to the type of the signed operand.</li>\n<li>Otherwise, both operands are converted to the unsigned type that has the same width as the signed operand.</li>\n</ul>\n\n<p>The integer promotions are defined in 6.3.1.1 2. They apply to all integer types as wide as or narrower than <code>int</code> or <code>unsigned int</code> (technically of rank less than or equal to the rank of <code>int</code> and <code>unsigned int</code>), including bit-fields of type <code>_Bool</code>, <code>int</code>, <code>signed int</code>, or <code>unsigned int</code>.</p>\n\n<blockquote>\n  <p>If an <code>int</code> can represent all values of the original type (as restricted by the width, for a bit-field), the value is converted to an <code>int</code>; otherwise, it is converted to an <code>unsigned int</code>. These are called the integer promotions. All other types are unchanged by the integer promotions.</p>\n</blockquote>\n"}], "owner": {"reputation": 53, "user_id": 6327802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6422b144ef72b0f8eb3740d4902ebb5e?s=128&d=identicon&r=PG&f=1", "display_name": "T.Barta", "link": "https://stackoverflow.com/users/6327802/t-barta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 56258932, "answer_count": 3, "score": 1, "last_activity_date": 1559207010, "creation_date": 1558531717, "last_edit_date": 1559207010, "question_id": 56258014, "link": "https://stackoverflow.com/questions/56258014/data-size-definition-in-c-programming-while-using-mathematical-expressions", "title": "Data size definition in C programming while using mathematical expressions", "body": "<p>When using mathematical operators in c programming, it is very important to use casts or define size of variable properly. I need help in it.</p>\n\n<pre><code>#include  &lt;stdio.h&gt;\n#include  &lt;stdint.h&gt;\n\nint main(void)\n{\n    uint32_t    a;\n    uint8_t     b;\n    uint8_t     d;\n    uint64_t    c;\n    float       cd;\n\n    a = 4294967295;\n    b = 2;\n    d = 2;\n    c = a * b * d;\n    cd = c;\n\n    printf(\"%f\\n\", cd);\n\n    return 0;\n}\n</code></pre>\n\n<p>The result variable is large enough to store the <code>2 * 2 * uint32_max</code>. However I noticed that the <code>b</code> or <code>d</code> variable need to be 64 bit wide (or use cast) to get the proper result. For this time I thought the mathematical operations takes place in the result variable, but it looks like is not true. Can somebody explain me which variable need to be widened (b or d) and what is the theoretical background behind it?</p>\n\n<p>What is the situation in division? Should I consider whether I want to divide a 32 bit number with a 8bit long. will the result be in that case 8 bit only? Does any rule about the type of the denominator?</p>\n"}, {"tags": ["c", "database", "hash"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1558524243, "post_id": 56255196, "comment_id": 99128127, "body": "You are calling <code>Hash</code> on uninitialized pointer <code>int hashIndex = Hash(AM, 19);</code> did you mean to call <code>int hashIndex = Hash(node.AM, 19);</code>?"}, {"owner": {"reputation": 39, "user_id": 9626547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c949ba4b2f5d8092fac70e32a77144a6?s=128&d=identicon&r=PG&f=1", "display_name": "vaskar", "link": "https://stackoverflow.com/users/9626547/vaskar"}, "reply_to_user": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1558525028, "post_id": 56255196, "comment_id": 99128521, "body": "@kiran Biradar  I wrote my code based on this post , so I think that answers your question <a href=\"https://stackoverflow.com/questions/56226055/hashingwith-chains-a-student-database-bit-folding-additive-hashing\" title=\"hashingwith chains a student database bit folding additive hashing\">stackoverflow.com/questions/56226055/&hellip;</a>"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1558526646, "post_id": 56255196, "comment_id": 99129405, "body": "Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1558527465, "post_id": 56255196, "comment_id": 99129794, "body": "It is a good idea to provide a brief, but complete, compilable example showing specific issues you are having.  It this case, you have provided way too much poorly formatted code (that has been edited since), but it does not contain a <code>int main(void)</code> or <code>int main(int argc, char *argv[])</code> function, so it will not compile.  Please edit your post to include how you have written your main function."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1558527977, "post_id": 56255196, "comment_id": 99130076, "body": "For me <code>(line[len - 1] != &#39;\\n&#39;)</code> must be <code>(line[len - 1] == &#39;\\n&#39;)</code>, and you have several other problems, see my answer"}, {"owner": {"reputation": 39, "user_id": 9626547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c949ba4b2f5d8092fac70e32a77144a6?s=128&d=identicon&r=PG&f=1", "display_name": "vaskar", "link": "https://stackoverflow.com/users/9626547/vaskar"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1558529889, "post_id": 56255196, "comment_id": 99131209, "body": "@ryyker I have edited in my main function"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1558530338, "post_id": 56255196, "comment_id": 99131497, "body": "@vaskar you also have problems in your <i>main</i>, I edited my answer"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 9626547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c949ba4b2f5d8092fac70e32a77144a6?s=128&d=identicon&r=PG&f=1", "display_name": "vaskar", "link": "https://stackoverflow.com/users/9626547/vaskar"}, "edited": false, "score": 0, "creation_date": 1558531164, "post_id": 56256536, "comment_id": 99132069, "body": "I think we are making some progress here! Before I make the changes to the main funtion and specifically in the scaf(&quot;%d&quot;, &amp;AM) , when I selected the Display case It would display just the first line of my file but after the change you proposed I get return ld1 exit status"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 39, "user_id": 9626547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c949ba4b2f5d8092fac70e32a77144a6?s=128&d=identicon&r=PG&f=1", "display_name": "vaskar", "link": "https://stackoverflow.com/users/9626547/vaskar"}, "edited": false, "score": 0, "creation_date": 1558531432, "post_id": 56256536, "comment_id": 99132289, "body": "@vaskar I continue to correct your code and currently the display produces the entries I put in the file"}, {"owner": {"reputation": 39, "user_id": 9626547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c949ba4b2f5d8092fac70e32a77144a6?s=128&d=identicon&r=PG&f=1", "display_name": "vaskar", "link": "https://stackoverflow.com/users/9626547/vaskar"}, "edited": false, "score": 0, "creation_date": 1558532896, "post_id": 56256536, "comment_id": 99133282, "body": "I have edited in mu code with the corrections you have provided allong with the contents and form of my .txt file and now , when I choose Display it shows two or three students at the same time as if they are in the same node"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 39, "user_id": 9626547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c949ba4b2f5d8092fac70e32a77144a6?s=128&d=identicon&r=PG&f=1", "display_name": "vaskar", "link": "https://stackoverflow.com/users/9626547/vaskar"}, "edited": false, "score": 0, "creation_date": 1558533025, "post_id": 56256536, "comment_id": 99133373, "body": "@vaskar I continue to edit my answer to correct your code, please wait I finish, I will warn you and also put the full corrected code"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 39, "user_id": 9626547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c949ba4b2f5d8092fac70e32a77144a6?s=128&d=identicon&r=PG&f=1", "display_name": "vaskar", "link": "https://stackoverflow.com/users/9626547/vaskar"}, "edited": false, "score": 0, "creation_date": 1558533813, "post_id": 56256536, "comment_id": 99133938, "body": "@vaskar done, I put the full corrected code and an example of execution, but read all my answer to understand the changes"}, {"owner": {"reputation": 39, "user_id": 9626547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c949ba4b2f5d8092fac70e32a77144a6?s=128&d=identicon&r=PG&f=1", "display_name": "vaskar", "link": "https://stackoverflow.com/users/9626547/vaskar"}, "edited": false, "score": 0, "creation_date": 1558536979, "post_id": 56256536, "comment_id": 99135927, "body": "I implemented your code with my text file and although it works as you describe when I choose the Display option, I get some nodes containing one entry and some 2-3. I have put the results in my original post that I edited! Finally, I have already upvoted your answer which was indeed immensely helpful but due to my reputation, it won&#39;t count :( I have marked your question as accepted!"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1558537765, "post_id": 56256536, "comment_id": 99136471, "body": "Plus one for your extensive effort alone."}, {"owner": {"reputation": 39, "user_id": 9626547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c949ba4b2f5d8092fac70e32a77144a6?s=128&d=identicon&r=PG&f=1", "display_name": "vaskar", "link": "https://stackoverflow.com/users/9626547/vaskar"}, "edited": false, "score": 0, "creation_date": 1558538169, "post_id": 56256536, "comment_id": 99136739, "body": "@bruno I have, yes. Thanks for your help!"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 1, "last_activity_date": 1558534809, "last_edit_date": 1558534809, "creation_date": 1558527145, "answer_id": 56256536, "question_id": 56255196, "link": "https://stackoverflow.com/questions/56255196/hashing-text-file-line-by-line/56256536#56256536", "title": "Hashing text file line by line", "body": "<blockquote>\n  <p>The code simply won't read the text file I have provided</p>\n</blockquote>\n\n<p>your problem probably comes from :</p>\n\n<blockquote>\n<pre><code>   char line[4096];\n   while (fgets(line, sizeof line,fp)) \n   {\n       size_t len = strlen(line);\n       if (len &amp;&amp; (line[len - 1] != '\\n')) \n</code></pre>\n</blockquote>\n\n<p>because of <code>(line[len - 1] != '\\n')</code> which is probably never true because <em>fgets</em> is able to read a large line and considering the <em>fscanf</em> after the lines contains only few data.</p>\n\n<p>Why do you want to work on <em>/* incomplete line */</em>  ?</p>\n\n<p>Work on complete lines with the test</p>\n\n<pre><code>if (len &amp;&amp; (line[len - 1] == '\\n')) \n</code></pre>\n\n<p>You also have an unexpected <em>return</em> in</p>\n\n<blockquote>\n<pre><code> if (!hashTable[hashIndex].head) \n {\n   hashTable[hashIndex].head = newNode;\n   hashTable[hashIndex].count = 1;\n   return;\n }\n</code></pre>\n</blockquote>\n\n<p>because of it you cannot read more than one answer, put the lines after in an <code>else { ... }</code></p>\n\n<p>Note also your code supposes the user ask <em>only one times</em> to insert, if he does several times you will add several times the same elements.</p>\n\n<p>After you read a line you again read in the file doing</p>\n\n<blockquote>\n<pre><code> fscanf(fp,\"%s %s %s %d\",node.AM, node.first_name, node.last_name, &amp;node.grade);\n</code></pre>\n</blockquote>\n\n<p>so you only save the data from half the lines, you wanted to do</p>\n\n<pre><code>sscanf(line,\"%s %s %s %d\",node.AM, node.first_name, node.last_name, &amp;node.grade);\n</code></pre>\n\n<hr>\n\n<p>You have additional problems</p>\n\n<p>In <em>Hash</em> you suppose the identifier has at least 7 characters, if this is not the case you read out of the name (after the null character) with an undefined behavior</p>\n\n<p>Do something like :</p>\n\n<pre><code>int Hash(char *AM, int n)\n{    \n  int i;\n  int hashIndex = 0;\n\n  for (i=0; (i&lt; 8) &amp;&amp; (AM[i] != 0); i++)\n  {\n    hashIndex += AM[i];\n  }\n\n  return hashIndex % n;\n}\n</code></pre>\n\n<p>However your hash is very poor, there are much better ways to hash a string</p>\n\n<p>In</p>\n\n<blockquote>\n<pre><code>        fscanf(fp,\"%s %s %s %d\",node.AM, node.first_name, node.last_name, &amp;node.grade);\n</code></pre>\n</blockquote>\n\n<p>you use the format <em>%d</em> for an <em>int</em> but <code>node.grade</code> is a <em>float</em>, replace <em>%d</em> by <em>%f</em> and also check <em>fscanf</em> returns 4</p>\n\n<p>I also encourage you to limit the size of the read string to not take the risk to write out of the fields, so (in fact the <em>fscanf</em> has to be replaced by a <em>sscanf</em>)</p>\n\n<pre><code>fscanf(fp,\"%99s %99s %99s %f\", ...)\n</code></pre>\n\n<p>In</p>\n\n<blockquote>\n<pre><code>printf(\"Student ID  : %d\\n\", myNode-&gt;AM);\n</code></pre>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n<pre><code>printf(\"%-12d\", myNode-&gt;AM);\n</code></pre>\n</blockquote>\n\n<p>you use the format <em>%d</em> for an <em>int</em> but you give a <code>char*</code></p>\n\n<p>Replace <em>d</em> by <em>s</em> or change the type of <em>AM</em> (and how to read and use it elsewhere of course)</p>\n\n<p>The return at the end of <em>insertToHash</em> is useless, there are some other useless <em>return</em> else where</p>\n\n<p>In </p>\n\n<blockquote>\n<pre><code>printf(\"grade      : %d\\n\", myNode-&gt;grade);\n</code></pre>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n<pre><code>printf(\"%d\\n\", myNode-&gt;grade);\n</code></pre>\n</blockquote>\n\n<p>you use the format <em>%d</em> for an <em>int</em> but you give a double</p>\n\n<p>Replace <em>%d</em> by <em>%lf</em> or <em>%lg</em> etc</p>\n\n<p>In</p>\n\n<blockquote>\n<pre><code>int hashIndex = Hash(AM, 19);\n</code></pre>\n</blockquote>\n\n<p><em>AM</em> is not initialized, the behavior is undefined</p>\n\n<p>You wanted </p>\n\n<pre><code>int hashIndex = Hash(node.AM, 19);\n</code></pre>\n\n<p>In</p>\n\n<blockquote>\n<pre><code>struct node *newnode = createNode(AM, first_name, last_name, grade);\n</code></pre>\n</blockquote>\n\n<p><code>AM</code> and <code>first_name</code> and <code>last_name</code> and <code>grade</code> are not initialized, the behavior is undefined</p>\n\n<p>You wanted</p>\n\n<pre><code>struct node *newnode = createNode(node.AM, node.first_name, node.last_name, node.grade);\n</code></pre>\n\n<p>and remove the useless variables <code>hashIndex, grade, last_name, first_name, AM</code></p>\n\n<p>In <em>deleteFromHash</em>  and <em>searchInHash</em> the test</p>\n\n<blockquote>\n<pre><code> if (myNode-&gt;AM == AM)\n</code></pre>\n</blockquote>\n\n<p>is wrong because you compare pointers, you wanted</p>\n\n<pre><code>if (!strcmp(myNode-&gt;AM, AM))\n</code></pre>\n\n<hr>\n\n<p>In</p>\n\n<blockquote>\n<pre><code>struct node \n{\n  float grade;\n  char AM[100];\n  char first_name[100];\n  char last_name[100];\n  struct node *next;\n}node;\n</code></pre>\n</blockquote>\n\n<p>the same name is used for the struct and the global variable, this is not a good idea. </p>\n\n<p>Also the global variable <em>node</em> is only used in <em>insertToHash</em>, so you do not need it, remove the global variable and add a local variable into <em>insertToHash</em>.</p>\n\n<hr>\n\n<p>After you edit adding <em>main</em></p>\n\n<blockquote>\n<pre><code>scanf(\"%d\", &amp;AM);\n</code></pre>\n</blockquote>\n\n<p>must be (2 times)</p>\n\n<pre><code>scanf(\"%99s\", AM);\n</code></pre>\n\n<p>Your variables <code>first_name, last_name</code> and <code>grade</code> are unused</p>\n\n<hr>\n\n<p>The code taking into account all my remarks is :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nstruct hash *hashTable = NULL;\nint eleCount = 0;\n\nstruct Node \n{\n  float grade;\n  char AM[100];\n  char first_name[100];\n  char last_name[100];\n  struct Node *next;\n};\n\nstruct hash \n{\nstruct Node *head;\nint count;\n};\n\nstruct Node * createNode(char *AM, char *first_name, char *last_name, float grade) \n{\n  struct Node *newNode;\n\n  newNode = (struct Node *) malloc(sizeof(struct Node));\n  strcpy(newNode-&gt;AM, AM);\n  strcpy(newNode-&gt;last_name, last_name);\n  strcpy(newNode-&gt;first_name, first_name);\n  newNode-&gt;grade = grade;\n  newNode-&gt;next = NULL;\n  return newNode;\n}\n\nint Hash(char *AM, int n)\n{    \n  int i;\n  int hashIndex = 0;\n\n  for (i=0; (i&lt; 8) &amp;&amp; (AM[i] != 0); i++)\n  {\n    hashIndex += AM[i];\n  }\n\n  return hashIndex % n;\n}\n\nvoid insertToHash() \n{\n  struct Node node;\n\n  FILE *fp;\n  fp = fopen (\"Foitites-Vathmologio-DS.txt\",\"rb\");\n\n  if (fp == NULL) \n  { \n    fprintf(stderr,\"Could not open file\");  \n    return;\n  } \n\n  char line[4096];\n\n  while (fgets(line, sizeof line,fp)) {\n    size_t len = strlen(line);\n    if (len &amp;&amp; (line[len - 1] == '\\n')) {\n      /* complete line */\n      if (sscanf(line,\"%99s %99s %99s %f\",node.AM, node.first_name, node.last_name, &amp;node.grade) != 4) {\n    puts(\"invalid file\");\n    return;\n      }\n\n      int hashIndex = Hash(node.AM, 19);\n\n      struct Node *newNode = createNode(node.AM, node.first_name, node.last_name, node.grade);\n      /* head of list for the bucket with index \"hashIndex\" */\n\n      if (!hashTable[hashIndex].head) \n      {\n        hashTable[hashIndex].head = newNode;\n        hashTable[hashIndex].count = 1;\n      }\n      else {\n        /* adding new Node to the list */\n        newNode-&gt;next = (hashTable[hashIndex].head);\n        /*\n           * update the head of the list and no of\n           * Nodes in the current bucket\n        */\n        hashTable[hashIndex].head = newNode;\n        hashTable[hashIndex].count++;\n      }\n    }\n  }\n  fclose(fp);\n  printf(\"Done! \\n\");\n}\n\nvoid deleteFromHash(char *AM) \n{\n  /* find the bucket using hash index */\n  int hashIndex = Hash(AM, 19);\n  int flag = 0;\n\n  struct Node *temp, *myNode;\n  /* get the list head from current bucket */\n\n  myNode = hashTable[hashIndex].head;\n\n  if (!myNode) {\n    printf(\"Given data is not present in hash Table!!\\n\");\n\n    return;\n  }\n\n  temp = myNode;\n  while (myNode != NULL) {\n    /* delete the Node with given AM */\n    if (!strcmp(myNode-&gt;AM, AM)) {\n      flag = 1;\n      if (myNode == hashTable[hashIndex].head)\n        hashTable[hashIndex].head = myNode-&gt;next;\n      else\n        temp-&gt;next = myNode-&gt;next;\n\n      hashTable[hashIndex].count--;\n      free(myNode);\n      break;\n    }\n\n    temp = myNode;\n    myNode = myNode-&gt;next;\n  }\n  if (flag)\n    printf(\"Data deleted successfully from Hash Table\\n\");\n  else\n    printf(\"Given data is not present in hash Table!!!!\\n\");\n}\n\nvoid searchInHash(char *AM) {\n  int hashIndex = Hash(AM, 19);\n  int flag = 0;\n  struct Node *myNode;        myNode = hashTable[hashIndex].head;\n  if (!myNode) {\n    printf(\"Search element unavailable in hash table\\n\");\n    return;\n  }\n  while (myNode != NULL) {\n    if (!strcmp(myNode-&gt;AM, AM)) {\n      printf(\"Student ID  : %s\\n\", myNode-&gt;AM);\n      printf(\"First Name     : %s\\n\", myNode-&gt;first_name);\n      printf(\"Last Name     : %s\\n\", myNode-&gt;last_name);\n      printf(\"grade      : %lg\\n\", myNode-&gt;grade);\n      flag = 1;\n      break;\n    }\n    myNode = myNode-&gt;next;\n  }\n  if (!flag)\n    printf(\"Search element unavailable in hash table\\n\");\n}\n\nvoid display() {\n  struct Node *myNode;\n  int i;\n  for (i = 0; i &lt; eleCount; i++) {\n    if (hashTable[i].count == 0)\n      continue;\n    myNode = hashTable[i].head;\n    if (!myNode)\n      continue;\n    printf(\"\\nData at index %d in Hash Table:\\n\", i);\n    printf(\"Student ID    First Name    Last Name      Grade   \\n\");\n    printf(\"--------------------------------\\n\");\n    while (myNode != NULL) {\n      printf(\"%-12s\", myNode-&gt;AM);\n      printf(\"%-15s\", myNode-&gt;first_name);\n      printf(\"%-15s\", myNode-&gt;last_name);\n      printf(\"%lg\\n\", myNode-&gt;grade);\n      myNode = myNode-&gt;next;\n    }\n  }\n}\n\nint main() \n{\n  int n=19, ch;\n  char AM[100];\n  int insertDone = 0;\n\n  eleCount = n;\n  /* create hash table with \"n\" no of buckets */\n  hashTable = (struct hash *) calloc(n, sizeof(struct hash));\n  while (1) {\n    printf(\"\\n1. Insertion\\t2. Deletion\\n\");\n    printf(\"3. Searching\\t4. Display\\n5. Exit\\n\");\n    printf(\"Enter your choice:\");\n    scanf(\"%d\", &amp;ch);\n\n\n    switch (ch) {\n    case 1: \n      if (insertDone)\n        puts(\"Inserton was already done\");\n      else {\n    /*inserting new Node to hash table */\n        insertToHash();\n        insertDone = 1;\n      }\n      break;\n\n    case 2: \n      printf(\"Enter the AM to perform deletion:\");\n      scanf(\"%99s\", AM);\n      /* delete Node with \"AM\" from hash table */\n      deleteFromHash(AM);\n      break;\n\n    case 3: \n      printf(\"Enter the AM to search:\");\n      scanf(\"%99s\", AM);\n      searchInHash(AM);\n      break;\n    case 4: \n      display();\n      break;\n    case 5: \n      exit(0);\n    default: \n      printf(\"U have entered wrong option!!\\n\");\n      break;\n    }\n  }\n  return 0;\n}\n</code></pre>\n\n<p>Compilation and execution :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -g -pedantic -Wextra -Wall c.c\npi@raspberrypi:/tmp $ cat Foitites-Vathmologio-DS.txt\n123 aze qsd 1.23\n456 iop jkl 4.56\npi@raspberrypi:/tmp $ ./a.out\n\n1. Insertion    2. Deletion\n3. Searching    4. Display\n5. Exit\nEnter your choice:4\n\n1. Insertion    2. Deletion\n3. Searching    4. Display\n5. Exit\nEnter your choice:1\nDone! \n\n1. Insertion    2. Deletion\n3. Searching    4. Display\n5. Exit\nEnter your choice:4\n\nData at index 7 in Hash Table:\nStudent ID    First Name    Last Name      Grade   \n--------------------------------\n456         iop            jkl            4.56\n\nData at index 17 in Hash Table:\nStudent ID    First Name    Last Name      Grade   \n--------------------------------\n123         aze            qsd            1.23\n\n1. Insertion    2. Deletion\n3. Searching    4. Display\n5. Exit\nEnter your choice:1\nInserton was already done\n\n1. Insertion    2. Deletion\n3. Searching    4. Display\n5. Exit\nEnter your choice:3\nEnter the AM to search:123\nStudent ID  : 123\nFirst Name     : aze\nLast Name     : qsd\ngrade      : 1.23\n\n1. Insertion    2. Deletion\n3. Searching    4. Display\n5. Exit\nEnter your choice:3\nEnter the AM to search:1234\nSearch element unavailable in hash table\n\n1. Insertion    2. Deletion\n3. Searching    4. Display\n5. Exit\nEnter your choice:2\nEnter the AM to perform deletion:1\nGiven data is not present in hash Table!!\n\n1. Insertion    2. Deletion\n3. Searching    4. Display\n5. Exit\nEnter your choice:2\nEnter the AM to perform deletion:123\nData deleted successfully from Hash Table\n\n1. Insertion    2. Deletion\n3. Searching    4. Display\n5. Exit\nEnter your choice:4\n\nData at index 7 in Hash Table:\nStudent ID    First Name    Last Name      Grade   \n--------------------------------\n456         iop            jkl            4.56\n\n1. Insertion    2. Deletion\n3. Searching    4. Display\n5. Exit\nEnter your choice:2\nEnter the AM to perform deletion:456\nData deleted successfully from Hash Table\n\n1. Insertion    2. Deletion\n3. Searching    4. Display\n5. Exit\nEnter your choice:4\n\n1. Insertion    2. Deletion\n3. Searching    4. Display\n5. Exit\nEnter your choice:5\npi@raspberrypi:/tmp $ \n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 9626547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c949ba4b2f5d8092fac70e32a77144a6?s=128&d=identicon&r=PG&f=1", "display_name": "vaskar", "link": "https://stackoverflow.com/users/9626547/vaskar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 0, "accepted_answer_id": 56256536, "answer_count": 1, "score": 0, "last_activity_date": 1558599870, "creation_date": 1558522393, "last_edit_date": 1558599870, "question_id": 56255196, "link": "https://stackoverflow.com/questions/56255196/hashing-text-file-line-by-line", "title": "Hashing text file line by line", "body": "<p>I am trying to hash a text file that contains 19 lines of student personal information. There is a case based system that I can choose what action I want to do like Insert in Hash, Display, etc. The code simply won't read the text file I have provided and when I press Display as an action it will bring up nothing. The same thing will happen when I press the Insert choice, etc.</p>\n"}, {"tags": ["c", "dynamic-arrays"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 3, "creation_date": 1558519078, "post_id": 56254128, "comment_id": 99125287, "body": "You canot use <code>strcpy</code> to copy <code>int</code>s, as in <code>strcpy(*newtemp,temp);</code> And <code>*newtemp</code> is wrong."}, {"owner": {"reputation": 413, "user_id": 10518032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91471cd13b1f82257c4311a9e213753?s=128&d=identicon&r=PG&f=1", "display_name": "nm_tp", "link": "https://stackoverflow.com/users/10518032/nm-tp"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1558519190, "post_id": 56254128, "comment_id": 99125359, "body": "Instead of <code>strcpy</code>, which,as @PaulOgilvie said cannot be used for copying an array of integers, you can use <code>realloc</code> for re-allocation. It even preserves memory contents so you do not have to copy after expanding."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1558519202, "post_id": 56254128, "comment_id": 99125375, "body": "You leak memory with your <code>int* newtemp = malloc(..</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1558520314, "post_id": 56254128, "comment_id": 99125960, "body": "You need to fix the formatting of your code. And your use of <code>switch&#47;case</code> is questionable."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1558520657, "post_id": 56254128, "comment_id": 99126164, "body": "If you are completely new to C, you should start with some even simpler programs."}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "reply_to_user": {"reputation": 413, "user_id": 10518032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91471cd13b1f82257c4311a9e213753?s=128&d=identicon&r=PG&f=1", "display_name": "nm_tp", "link": "https://stackoverflow.com/users/10518032/nm-tp"}, "edited": false, "score": 0, "creation_date": 1558520662, "post_id": 56254128, "comment_id": 99126166, "body": "@nm_tp Given the exercise instructions, I&#39;m not sure that using <code>realloc</code> is permitted"}, {"owner": {"reputation": 134, "user_id": 11131523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3O9ngZPKFGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdeFi7656jSqPOfPxvSdL-OboBLdg/mo/photo.jpg?sz=128", "display_name": "Igor Galczak", "link": "https://stackoverflow.com/users/11131523/igor-galczak"}, "edited": false, "score": 0, "creation_date": 1558520742, "post_id": 56254128, "comment_id": 99126214, "body": "You no need malloc here, because in specyfication you have &quot;up to 5 temperatures&quot;, just use fixed size array <code>int temp[5] = {0};</code>"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "reply_to_user": {"reputation": 134, "user_id": 11131523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3O9ngZPKFGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdeFi7656jSqPOfPxvSdL-OboBLdg/mo/photo.jpg?sz=128", "display_name": "Igor Galczak", "link": "https://stackoverflow.com/users/11131523/igor-galczak"}, "edited": false, "score": 0, "creation_date": 1558520796, "post_id": 56254128, "comment_id": 99126249, "body": "@IgorGalczak Not true, since the instruction say that old array must be deallocated"}, {"owner": {"reputation": 6031, "user_id": 10871900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-noQwojQppnY/AAAAAAAAAAI/AAAAAAAAACs/59RU8UyHFSk/photo.jpg?sz=128", "display_name": "dan1st", "link": "https://stackoverflow.com/users/10871900/dan1st"}, "edited": false, "score": 0, "creation_date": 1558520880, "post_id": 56254128, "comment_id": 99126301, "body": "Maybe a list would be useful..."}, {"owner": {"reputation": 134, "user_id": 11131523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3O9ngZPKFGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdeFi7656jSqPOfPxvSdL-OboBLdg/mo/photo.jpg?sz=128", "display_name": "Igor Galczak", "link": "https://stackoverflow.com/users/11131523/igor-galczak"}, "reply_to_user": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1558520900, "post_id": 56254128, "comment_id": 99126308, "body": "@Mathieu But there is not a word &quot;dynamically&quot; <code>int temp[5]</code> - allocate 5 * sizeof(int) bytes in stack. On end of function there are deallocated :)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1558521793, "post_id": 56254128, "comment_id": 99126813, "body": "<code>if (i=j){</code> is suspicious.  I&#39;d expect <code>if (i==j){</code>"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 2, "creation_date": 1558523009, "post_id": 56254128, "comment_id": 99127461, "body": "<code>j</code> is a horrible name for storing array size. Ex. <code>tempsize</code> would be a better name."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1558526168, "post_id": 56255519, "comment_id": 99129138, "body": "<code>data = malloc(5 * sizeof(data -&gt; data[0]) + sizeof(data));</code> This is bugged, same bug all over the place. Instead make it a habit to write <code>data = malloc(sizeof(*data) + sizeof(int[5]));</code>. Size of struct plus size of array. In that order, self-documenting code."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1558528103, "post_id": 56255519, "comment_id": 99130137, "body": "@Lundin forgotten <code>*</code> I agree. But the rest you are wrong.  sizeof(data -&gt; data[0]) gives the size of the integer."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1558528262, "post_id": 56255519, "comment_id": 99130213, "body": "sizeof(int[5])) is not good if OP changes the type of the data. You need to replace it everythere. Imagine <code>long long data[];</code> for example"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1558528357, "post_id": 56255519, "comment_id": 99130269, "body": "@Lundin And he does not want to add the another 5 elements only to double the size"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1558533413, "post_id": 56255519, "comment_id": 99133643, "body": "The fact remains that your coding style caused you to write a bug, so there is no arguing about how good it is. Writing correct code is always <i>far</i> more important than avoiding code repetition. As for maintenance, wildly changing types of structure members is not something that should be done at a whim. Especially not if the member is a flexible array member. The <code>5</code> can be replaced with a variable <code>n</code>."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1558528354, "last_edit_date": 1558528354, "creation_date": 1558523483, "answer_id": 56255519, "question_id": 56254128, "link": "https://stackoverflow.com/questions/56254128/dynamically-growing-array-based-on-user-input-in-c/56255519#56255519", "title": "Dynamically Growing Array Based on User Input in C", "body": "<pre><code>#define INITIALSIZE 5\n\ntypedef struct \n{\n    size_t size;\n    size_t index;\n    int data[];\n}DATA_t;\n\nDATA_t *addData(DATA_t *data, int val)\n{\n    if(!data)\n    {\n        data = malloc(INITIALSIZE * sizeof(data -&gt; data[0]) + sizeof(*data));\n        /* malloc result checks */\n        data -&gt; size = 0;\n        data -&gt; index = 0;\n    }\n    if((data -&gt; index + 1) == data -&gt; size)\n    {\n        size_t newsize = data -&gt; size * 2 ;\n        DATA_t *newdata = malloc(newsize * sizeof(data -&gt; data[0]) + sizeof(*data));\n        /* malloc result checks */\n        memcpy(newdata, data, data -&gt; size * sizeof(data -&gt; data[0]) + sizeof(*data));\n        newdata -&gt; size = newsize;\n        free(data);\n        data = newdata;\n    }\n    data -&gt; data[data -&gt; index++] = val;\n    return data;\n}\n</code></pre>\n\n<p>usage:</p>\n\n<pre><code>DATA_t *mydata = NULL;\n\nwhile(condition)\n{\n    mydata = addData(mydata, ReadValue());\n    /* ----- */\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 840, "user_id": 6704493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4c301ad478ef6b75733125f2b3d049d?s=128&d=identicon&r=PG&f=1", "display_name": "Pawe\u0142 Dymowski", "link": "https://stackoverflow.com/users/6704493/pawe%c5%82-dymowski"}, "is_accepted": false, "score": 0, "last_activity_date": 1558530878, "last_edit_date": 1558530878, "creation_date": 1558527372, "answer_id": 56256603, "question_id": 56254128, "link": "https://stackoverflow.com/questions/56254128/dynamically-growing-array-based-on-user-input-in-c/56256603#56256603", "title": "Dynamically Growing Array Based on User Input in C", "body": "<p>You can try to declare two arrays, and switch between them, like that:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void){\n\n    int currentArraySize = 5;\n\n    int* temperatures1 = malloc(sizeof(int)*currentArraySize);\n    int* temperatures2 = NULL;\n    int temperaturesSlot = 0;\n    int temperature = 0;\n    int index = 0;\n\n\n    while(1){\n        if (index == currentArraySize){\n            switch (temperaturesSlot){\n                case 0:\n                    temperatures2 = malloc(sizeof(int)* 2 *currentArraySize);\n                    memcpy(temperatures2, temperatures1, currentArraySize * sizeof(int));\n                    free(temperatures1);\n                    temperatures1 = NULL;\n                    temperaturesSlot = 1;\n                    break;\n                case 1:\n                    temperatures1 = malloc(sizeof(int)* 2 *currentArraySize);\n                    memcpy(temperatures1, temperatures2, currentArraySize * sizeof(int));\n                    free(temperatures2);\n                    temperatures2 = NULL;\n                    temperaturesSlot = 0;\n                    break;\n            }\n            currentArraySize *= 2;\n        }\n\n        printf(\"enter temperature: \");\n        scanf(\"%d\",(&amp;temperature));\n        if (temperature == -100){\n            break;\n        }\n        else if (temperaturesSlot == 0){\n            temperatures1[index] = temperature;\n        }\n        else{\n            temperatures2[index] = temperature;\n        }\n        ++index;\n    }\n\n    for (int i = 0; i &lt; index; ++i){\n        if (temperaturesSlot == 0){\n            printf(\"%d, \", temperatures1[i]);\n        }\n        else{\n            printf(\"%d, \", temperatures2[i]);\n        }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 840, "user_id": 6704493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4c301ad478ef6b75733125f2b3d049d?s=128&d=identicon&r=PG&f=1", "display_name": "Pawe\u0142 Dymowski", "link": "https://stackoverflow.com/users/6704493/pawe%c5%82-dymowski"}, "edited": false, "score": 1, "creation_date": 1558528396, "post_id": 56256842, "comment_id": 99130291, "body": "task is precise, to use new array, copy data, and free not used"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1558528670, "post_id": 56256842, "comment_id": 99130440, "body": "main should be <code>int main(void)</code>"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 840, "user_id": 6704493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4c301ad478ef6b75733125f2b3d049d?s=128&d=identicon&r=PG&f=1", "display_name": "Pawe\u0142 Dymowski", "link": "https://stackoverflow.com/users/6704493/pawe%c5%82-dymowski"}, "edited": false, "score": 1, "creation_date": 1558529065, "post_id": 56256842, "comment_id": 99130656, "body": "@Pawe\u0142Dymowski Well, one could say that&#39;s what realloc does internally. The task doesn&#39;t say you have to do it in three separate function calls.  Tasks should let the learner improve what is asked, so that they really promote learning :-)"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1558529550, "post_id": 56256842, "comment_id": 99130990, "body": "I suggest using <code>void printArray(ptrdiff_t size, double array[size])</code> given that it represents an array:  Even better with <code>static</code> for the size: <code>void printArray(ptrdiff_t size, double array[static size])</code>"}], "tags": [], "owner": {"reputation": 168, "user_id": 11345020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48d3d43d49cd02d98fc22e7036e9c977?s=128&d=identicon&r=PG&f=1", "display_name": "ooj-001", "link": "https://stackoverflow.com/users/11345020/ooj-001"}, "is_accepted": false, "score": 2, "last_activity_date": 1558529121, "last_edit_date": 1558529121, "creation_date": 1558528160, "answer_id": 56256842, "question_id": 56254128, "link": "https://stackoverflow.com/questions/56254128/dynamically-growing-array-based-on-user-input-in-c/56256842#56256842", "title": "Dynamically Growing Array Based on User Input in C", "body": "<p>How about using the realloc tool instead?</p>\n\n<pre><code>void printArray(double *array, int size){\n    for(int i=0; i&lt;size; i++){\n        printf(\"%.1lf \", array[i]);\n    }\n    putchar('\\n');\n}\n\nint main(void){\n    int size = 5;\n    double *array = malloc(size * sizeof(double)); \n    double temperature;\n    int i = 0;\n\n    while(1){\n        if(temperature == -100.0)\n            break;\n        if(i == size){\n            size *= 2;\n            array = realloc(array, size * sizeof(double));\n        }\n        scanf(\"%lf\", &amp;temperature);\n        array[i] = temperature;\n        printArray(array, size);\n        i++;\n    }\n    free(array);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 11508270, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hkNF3V-ugG8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3retmZJHgX6rgHCRLh7qCNX4yA8I6g/mo/photo.jpg?sz=128", "display_name": "user672518", "link": "https://stackoverflow.com/users/11508270/user672518"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1646, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1558537495, "creation_date": 1558518966, "last_edit_date": 1558520744, "question_id": 56254128, "link": "https://stackoverflow.com/questions/56254128/dynamically-growing-array-based-on-user-input-in-c", "title": "Dynamically Growing Array Based on User Input in C", "body": "<p>I need to create a program which:</p>\n\n<blockquote>\n  <ol>\n  <li>initially allocate an array to read in and hold up to 5 temperatures. </li>\n  <li>prompt the user to enter temperatures and type the value -100.0 when they are finished</li>\n  <li>if the user fills up the array your program should\n  dynamically allocate a new array which is double the size.</li>\n  <li>copy the old values across to the new array.\n  deallocate the old array.</li>\n  <li>continue reading into the new array.</li>\n  <li>print the new array out when it's done</li>\n  </ol>\n</blockquote>\n\n<p>I'm completely new to C and I'm kinda stuck. I know how to create a dynamic array, but I don't know how to create a new array which constantly grows once the old array is filled up. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void){\n    int i,k; //loop count\n    int j = 5; //initial array size\n    int* temp = malloc(sizeof(int)*j); \n    int* newtemp;\n\n    for (i = 0; i &lt; j; i++){ //loop to read in temperature\n        printf(\"enter temperature: \");\n        scanf(\"%d\",(temp+i));\n        if (i=j){\n        j = j*2; //double the size of initial array\n        int* newtemp = malloc(sizeof(int)*j);\n        strcpy(*newtemp,temp); // copy string\n        for (k = 0; k &lt; j; k++){ //loop to read in temperature\n            printf(\"enter temperature: \");\n            scanf(\"%d\",(temp+i+k));\n            }\n        }\n        switch (temp[i]){\n            case (-100):\n            temp[i] = '\\0';\n            i = 5; //loop ends\n            break;\n        }    \n    }\n    return 0;\n}\n</code></pre>\n\n<p>The error messages: </p>\n\n<pre><code>tempp.c:18:16: warning: passing argument 1 of \u2018strcpy\u2019 makes pointer from integer without a cast [-Wint-conversion]\n         strcpy(*newtemp,temp);\n                ^\nIn file included from tempp.c:3:0:\n/usr/include/string.h:121:14: note: expected \u2018char * restrict\u2019 but argument is of type \u2018int\u2019\n extern char *strcpy (char *__restrict __dest, const char *__restrict __src)\n              ^~~~~~\ntempp.c:18:25: warning: passing argument 2 of \u2018strcpy\u2019 from incompatible pointer type [-Wincompatible-pointer-types]\n         strcpy(*newtemp,temp);\n                         ^~~~\nIn file included from tempp.c:3:0:\n/usr/include/string.h:121:14: note: expected \u2018const char * restrict\u2019 but argument is of type \u2018int *\u2019\n extern char *strcpy (char *__restrict __dest, const char *__restrict __src)\n</code></pre>\n\n<p>I know that my code is messy and I really don't know the right method to reallocate a new array while it constantly grows. \nPlease help me with this. Thank you!</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1558519963, "post_id": 56253996, "comment_id": 99125783, "body": "In the test code, changing the <code>strncpy()</code> calls to use either <code>SERVERNAME_LEN + 1</code> or <code>sizeof(name)</code> removes the warning.  Sadly, in the &#39;real code&#39;, neither removes the warning (but the error changes to <code>error: \u2018__builtin_strncpy\u2019 specified bound 129 equals destination size [-Werror=stringop-truncation]</code> and points to the second <code>strncpy()</code> instead of the first.  I&#39;ll integrate this into the question later today, probably."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1558520932, "post_id": 56253996, "comment_id": 99126332, "body": "BTW: even gcc 8.1 complains: <a href=\"https://www.godbolt.org/z/YyFJcL\" rel=\"nofollow noreferrer\">godbolt.org/z/YyFJcL</a>. 7.3 and older don&#39;t."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1558521897, "post_id": 56253996, "comment_id": 99126879, "body": "@Jabberwocky: Interesting \u2014 for me, none of GCC 7.3.0, 8.2.0 and 8.3.0 complain about the test code shown when compiled with <code>-USUPPRESS_BUG</code> (or without any definition of <code>SUPPRESS_BUG</code>).  And they are similarly quiet about the &#39;real code&#39;.  These are all compilers I built \u2014 using a recipe I&#39;ve documented elsewhere on SO (<a href=\"https://stackoverflow.com/questions/21173518/install-gnu-gcc-on-mac/21213759#21213759\">Install GNU GCC on Mac</a> \u2014 I use basically the same recipe on Linux too)."}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1558530925, "post_id": 56253996, "comment_id": 99131891, "body": "I have a question: at which stage in processing this message is generated ? When the code is in RTL ? SSA ? Generic ?"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1558521370, "post_id": 56254614, "comment_id": 99126582, "body": "GCC 9.1.0 was released on 2019-05-03.  I&#39;m using release code, not a bleeding edge build before release. But it is interesting that someone else has noticed what seems to be the same problem and complained and got stone-walled about it."}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1558531462, "post_id": 56254614, "comment_id": 99132313, "body": "I have a question: at which stage in processing this message is generated ? When the code is in RTL ? SSA ? Generic ?"}], "tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": true, "score": 1, "last_activity_date": 1558521082, "last_edit_date": 1558521082, "creation_date": 1558520479, "answer_id": 56254614, "question_id": 56253996, "link": "https://stackoverflow.com/questions/56253996/why-does-gcc-9-1-0-sometimes-complain-about-this-use-of-strncpy/56254614#56254614", "title": "Why does GCC 9.1.0 sometimes complain about this use of strncpy()?", "body": "<p>Several compilation warnings related to <code>strncpy</code> were found in GCC 9.0 and reported <a href=\"https://github.com/intel/openlldp/issues/23\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://github.com/intel/openlldp/issues/25\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>One of them is the error mentioned in the question which seems to occur in the file <code>string_fortified.h</code>:</p>\n\n<pre><code>/usr/include/bits/string_fortified.h:106:10: warning: \u2018__builtin_strncpy\u2019 output may be truncated copying 16 bytes from a string of length 16 [-Wstringop-truncation]\n  106 |   return __builtin___strncpy_chk (__dest, __src, __len, __bos (__dest));\n      |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n</code></pre>\n\n<p>The response to this was given on April 15, 2019 was:</p>\n\n<blockquote>\n  <p>Thank you for the report, however as GCC 9 still under development. We do not see the above errors in the current stable GCC 7.4 or GCC 8.3. We appreciate the advanced notice, and will accept PRs to fix issues against GCC 9, but for now our target compiler is gcc stable.</p>\n</blockquote>\n\n<p>So I believe the errors are probably a result of versions 9 and 9.1 being not stable versions. Hopefully they will be eliminated when these versions become stable.</p>\n"}, {"tags": [], "owner": {"reputation": 1872, "user_id": 2104472, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/18805ffb0c3acfbd23cd6c84951afafc?s=128&d=identicon&r=PG&f=1", "display_name": "Vladislav Ivanishin", "link": "https://stackoverflow.com/users/2104472/vladislav-ivanishin"}, "is_accepted": false, "score": 4, "last_activity_date": 1558523792, "last_edit_date": 1558523792, "creation_date": 1558523020, "answer_id": 56255379, "question_id": 56253996, "link": "https://stackoverflow.com/questions/56253996/why-does-gcc-9-1-0-sometimes-complain-about-this-use-of-strncpy/56255379#56255379", "title": "Why does GCC 9.1.0 sometimes complain about this use of strncpy()?", "body": "<p>This is a GCC bug tracked as <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=88780\" rel=\"nofollow noreferrer\">PR88780</a>. According to Martin's <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=88780#c1\" rel=\"nofollow noreferrer\">comment</a>, this warning did not exist prior to GCC 8.</p>\n\n<p>GCC is shipped with this known bug, as it is not deemed release-critical.</p>\n\n<p>To be honest, I am not 100% sure it is <em>the</em> bug. The point is, there are known false-positives. If you feel like helping the GCC project, you can find  the most appropriate bug among <code>strncpy</code> / <code>Wstringop-truncation</code> bugs and post your example there. It would be more helpful if you minimized it further (say, with <code>creduce</code>); minimizing the compile string is also appreciated (that would be rather trivial, I guess).</p>\n"}], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2043, "favorite_count": 0, "accepted_answer_id": 56254614, "answer_count": 2, "score": 6, "last_activity_date": 1558523792, "creation_date": 1558518532, "last_edit_date": 1558518788, "question_id": 56253996, "link": "https://stackoverflow.com/questions/56253996/why-does-gcc-9-1-0-sometimes-complain-about-this-use-of-strncpy", "title": "Why does GCC 9.1.0 sometimes complain about this use of strncpy()?", "body": "<p>This is a 40-line MCVE (<a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, Verifiable Example</a>) \u2014 or something close to minimal \u2014\u00a0cut down from a 1675 line source file that originally included 32 headers (and most of those included multiple other headers \u2014 compiling it with <code>gcc -H</code> lists 464 headers from the project and the system, many of them several times).  That file is working code that previously compiled without warnings (GCC 8.3.0), but not with GCC 9.1.0.  All structure, function, type, variable names have been changed.</p>\n\n<h3><code>pf31.c</code></h3>\n\n<pre><code>#include &lt;string.h&gt;\n\nenum { SERVERNAME_LEN = 128 };\n\ntypedef struct ServerQueue\n{\n    char server_name[SERVERNAME_LEN + 1];\n    struct ServerQueue *next;\n} ServerQueue;\n\nextern int function_under_test(char *servername);\n\n#ifdef SUPPRESS_BUG\nextern int function_using_name(char *name);\n#endif /* SUPPRESS_BUG */\n\nextern int GetServerQueue(const char *servername, ServerQueue *queue);\n\nint\nfunction_under_test(char *servername)\n{\n    ServerQueue queue;\n    char name[SERVERNAME_LEN + 1];\n\n    if (GetServerQueue(servername, &amp;queue) != 0)\n        return -1;\n    char *name_in_queue = queue.server_name;\n\n    if (name_in_queue)\n        strncpy(name, name_in_queue, SERVERNAME_LEN);\n    else\n        strncpy(name, servername, SERVERNAME_LEN);\n    name[SERVERNAME_LEN] = '\\0';\n\n#ifdef SUPPRESS_BUG\n    return function_using_name(name);\n#else\n    return 0;\n#endif /* SUPPRESS_BUG */\n}\n</code></pre>\n\n<h3>Compilation</h3>\n\n<p>When compiled using GCC 9.1.0 (on a Mac running macOS 10.14.5 Mojave, or on a Linux VM running RedHat 5.x \u2014\u00a0don't ask!), with the option <code>-DSUPPRESS_BUG</code> I get no error, but with the option <code>-USUPPRESS_BUG</code>, I get an error:</p>\n\n<pre><code>$ gcc -std=c11 -O3 -g -Wall -Wextra -Werror -DSUPPRESS_BUG  -c pf31.c\n$ gcc -std=c11 -O3 -g -Wall -Wextra -Werror -USUPPRESS_BUG  -c pf31.c\nIn file included from /usr/include/string.h:417,\n                 from pf31.c:1:\npf31.c: In function \u2018function_under_test\u2019:\npf31.c:30:9: error: \u2018__builtin_strncpy\u2019 output may be truncated copying 128 bytes from a string of length 128 [-Werror=stringop-truncation]\n   30 |         strncpy(name, name_in_queue, SERVERNAME_LEN);\n      |         ^~~~~~~\ncc1: all warnings being treated as errors\n$\n</code></pre>\n\n<p>When I compile using GCC 8.3.0, I get no errors reported.</p>\n\n<h3>Question</h3>\n\n<p>Two sides of one question:</p>\n\n<ul>\n<li>Why does GCC 9.1.0 complain about the use of <code>strncpy()</code> when the code is compiled with <code>-USUPPRESS_BUG</code>?</li>\n<li>Why doesn't it complain when the code is compiled with <code>-DSUPPRESS_BUG</code>?\n\n<ul>\n<li>Corollary: is there a way to work around this unwanted warning that works with older GCC versions as well as 9.1.0.  I've not yet found one.  There's also a strong element of \"I don't think it should be necessary, because this is using <code>strncpy()</code> to limit the amount of data copied, which is what it is designed for\".</li>\n</ul></li>\n</ul>\n\n<h3>Another variant</h3>\n\n<p>I have another non-erroring variant, changing the signature of the <code>function_under_test()</code> \u2014 here's a set of diffs:</p>\n\n<pre><code>11c11\n&lt; extern int function_under_test(char *servername);\n---\n&gt; extern int function_under_test(char *servername, ServerQueue *queue);\n20c20\n&lt; function_under_test(char *servername)\n---\n&gt; function_under_test(char *servername, ServerQueue *queue)\n22d21\n&lt;     ServerQueue queue;\n25c24\n&lt;     if (GetServerQueue(servername, &amp;queue) != 0)\n---\n&gt;     if (GetServerQueue(servername, queue) != 0)\n27c26\n&lt;     char *name_in_queue = queue.server_name;\n---\n&gt;     char *name_in_queue = queue-&gt;server_name;\n</code></pre>\n\n<p>This compiles cleanly regardless of whether <code>SUPPRESS_BUG</code> is defined or not.</p>\n\n<p>As you can guess from the <code>SUPPRESS_BUG</code> terminology, I'm tending towards the view that this is bug in GCC, but I'm kinda cautious about claiming it is one just yet.</p>\n\n<hr>\n\n<p>More about the the original code: the function itself was 540 lines long; the <code>strncpy()</code> block occurs about 170 lines into the function; the variable corresponding to <code>name</code> was used further down the function in a number of function call, some of which take <code>name</code> as an argument and supply a return value for the function.  This corresponds more to the <code>-DSUPPRESS_BUG</code> code, except that in the 'real code', the bug is not suppressed.</p>\n"}, {"tags": ["android", "c", "android-ndk"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11044402"}, "edited": false, "score": 1, "creation_date": 1558518150, "post_id": 56253838, "comment_id": 99124809, "body": "This is not Java, this looks like Python code."}, {"owner": {"reputation": 71, "user_id": 11538437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4bc6e9ccc295a347a9405800cdd8ee1?s=128&d=identicon&r=PG&f=1", "display_name": "FaaiqKhan", "link": "https://stackoverflow.com/users/11538437/faaiqkhan"}, "edited": false, "score": 0, "creation_date": 1558519031, "post_id": 56253838, "comment_id": 99125258, "body": "Yes its python code which is working for me but if I try to build my own .so file for my android application it gives above errors."}], "owner": {"reputation": 71, "user_id": 11538437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4bc6e9ccc295a347a9405800cdd8ee1?s=128&d=identicon&r=PG&f=1", "display_name": "FaaiqKhan", "link": "https://stackoverflow.com/users/11538437/faaiqkhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1602760386, "creation_date": 1558518111, "last_edit_date": 1558670949, "question_id": 56253838, "link": "https://stackoverflow.com/questions/56253838/how-to-run-own-object-detector-using-dlib-library-on-android", "title": "How to run own object detector using dlib library on android?", "body": "<p>Using windows 10.\nI am trying to run my own object detector model that trained using dlib library and its working on python perfectly.</p>\n\n<pre><code>`detector = dlib.simple_object_detector(\"mobiledatasetv2/detector.dat\")\n image = cv2.imread(\"test.jpg\")\n image = imutils.resize(image, width=500)\n rects = detector(image)\n for k, d in enumerate(rects):\n print(\"Detection {}: Left: {} Top: {} Right: {} Bottom: {}\".format(k, \n d.left(), d.top(), d.right(), d.bottom()))`\n</code></pre>\n\n<p>After that I try to run on android so I download sample project from here \"<a href=\"https://github.com/tzutalin/dlib-android-app\" rel=\"nofollow noreferrer\">https://github.com/tzutalin/dlib-android-app</a>\" to check how to run dlib on android. It seems that android uses shared object \".so\" file, so I try to build my model's shared object file. I take help from here \"<a href=\"https://github.com/tzutalin/dlib-android\" rel=\"nofollow noreferrer\">https://github.com/tzutalin/dlib-android</a>\" to build it.</p>\n\n<p>I use this command to build \".so\" file\n    <code>python build.py --jobs 1 --android_project \nC:\\Users\\dell\\AppData\\Local\\Android\\Sdk\\ndk\\sources\\third_party\\vulkan\\src\\build-android\\jniLibs --debug</code></p>\n\n<p>After resolving NDK, toolchain and path issues </p>\n\n<p>I stuck on this issue </p>\n\n<blockquote>\n  <p>C:/Users/dell/AppData/Local/Android/Sdk/ndk-bundle/build//../sources/cxx-stl/llvm-libc++/Android.mk:c++_static:\n  LOCAL_MODULE_FILENAME must not contain a file extension\n  C:/Users/dell/AppData/Local/Android/Sdk/ndk-bundle/build//../build/core/build-static-library.mk:26:\n  *** Android NDK: Aborting    .  Stop. Build Error</p>\n</blockquote>\n\n<p>I debug and found that LOCAL_MODULE_FILENAME file is: libc++_static.a which is present in</p>\n\n<blockquote>\n  <p>AppData\\Local\\Android\\Sdk\\ndk-bundle\\sources\\cxx-stl\\llvm-libc++\\libs\\armeabi v7a this folder.</p>\n</blockquote>\n\n<p>If I remove libc++_static.a file extention and make it like libc++_static only then it give this error</p>\n\n<blockquote>\n  <p>C:/Users/dell/AppData/Local/Android/Sdk/ndk-bundle/build//../build/core/prebuilt-library.mk:25:\n  *** Android NDK:  Assertion failure: LOCAL_PREBUILT_SUFFIX is not defined    .  Stop. Build Error </p>\n</blockquote>\n\n<p>If I explicetly set\nLOCAL_PREBUILT_SUFFIX := .a \nthen error comes</p>\n\n<blockquote>\n  <p>ERROR:C:/Users/dell/AppData/Local/Android/Sdk/ndk-bundle/build//../sources/cxx-stl/llvm-libc++/Android.mk:c++_static:\n  LOCAL_SRC_FILES should point to a file ending with \".a\" Android NDK:\n  The following file is unsupported: libs/armeabi-v7a/libc++_static\n  C:/Users/dell/AppData/Local/Android/Sdk/ndk-bundle/build//../build/core/prebuilt-library.mk:41:\n  *** Android NDK: Aborting    .  Stop. Build Error</p>\n</blockquote>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 2184, "user_id": 1112010, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2c06679b27da6bbc84a4bf036da82648?s=128&d=identicon&r=PG", "display_name": "Mukul Gupta", "link": "https://stackoverflow.com/users/1112010/mukul-gupta"}, "edited": false, "score": 2, "creation_date": 1558516984, "post_id": 56253372, "comment_id": 99124113, "body": "Can you provide a link/reference to the interview?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1558516987, "post_id": 56253372, "comment_id": 99124116, "body": "It depends on the general design of the list. Removing a node from a list does not mean that the node may not be used any longer."}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1558517136, "post_id": 56253372, "comment_id": 99124209, "body": "Style aside, isn&#39;t the top example broken?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1558520618, "post_id": 56253372, "comment_id": 99126146, "body": "You can find one question about the pointer-to-pointer linked list processing technique at <a href=\"https://stackoverflow.com/questions/3182733/what-is-the-pointer-to-pointer-technique-for-the-simpler-traversal-of-linked-lis/\">What is the pointer to pointer technique for the simpler traversal of linked lists?</a> which is closed as a duplicate of <a href=\"https://stackoverflow.com/questions/332441/an-interesting-c-linked-list-idiom\">An interesting C linked list idiom</a>."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1558520709, "post_id": 56253372, "comment_id": 99126196, "body": "@500-InternalServerError Both are only pseudo code. I wouldn&#39;t expect any of them to be complete. In a real &quot;good taste&quot; example <code>head</code> would probably not be a global variable. And some <code>NULL</code> checks would also be included."}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1558518503, "post_id": 56253563, "comment_id": 99124998, "body": "<i>and free() it - that would cause a run-time error if the object were static</i>: freeing something that hasn&#39;t been allocated by <code>malloc</code> and friends does not necessarily trigger a runtime error, it&#39;s just UB."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1558527716, "post_id": 56253563, "comment_id": 99129930, "body": "@Jabberwocky It would be a semantic error not  trapped at build time.  In that sense an error occurring at run time.  That is all I meant, not necessarily an error that is explicitly trapped by the runtime environment. I hope that is clear?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1558527875, "post_id": 56253563, "comment_id": 99130018, "body": "It is (and always was) clear to me, but it might not be clear to the OP."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1558527956, "post_id": 56253563, "comment_id": 99130059, "body": "@Jabberwocky Thanks, clarity is served by your comment."}], "tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 3, "last_activity_date": 1558517563, "last_edit_date": 1558517563, "creation_date": 1558517289, "answer_id": 56253563, "question_id": 56253372, "link": "https://stackoverflow.com/questions/56253372/is-free-missing-in-this-good-taste-and-bad-tastecode/56253563#56253563", "title": "Is free() missing in this &quot;good taste&quot; and &quot;bad taste&quot;code?", "body": "<p>It is important also to note the semantics of this function.  It is intended to <em>remove</em> a node from a list, not to <em>delete</em> the node as you suggest in your question.  At least that is implied by the function name.  I would be surprised if it deleted the node without advertising that semantic.</p>\n\n<p>Moreover we have no way of knowing in isolation how the object was allocated, so the function cannot reasonably assume it is a heap object and <code>free()</code> it - that would cause a run-time error if the object were static.  </p>\n\n<p>The caller may be removing the object from the list and continuing to use it, it is the responsibility of this function to maintain the <em>list</em> not the objects in the list which have independent existence.  It is the responsibility of the owner of <code>entry</code> to manage its memory.</p>\n"}, {"tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": false, "score": 1, "last_activity_date": 1558528873, "creation_date": 1558528873, "answer_id": 56257052, "question_id": 56253372, "link": "https://stackoverflow.com/questions/56253372/is-free-missing-in-this-good-taste-and-bad-tastecode/56257052#56257052", "title": "Is free() missing in this &quot;good taste&quot; and &quot;bad taste&quot;code?", "body": "<p>In this context, good taste is being exemplified by minimalism; the second example is less ornate and more to the point than the first.   The bad taste code has a few errors in it, but the point is that the extra variable and if statement are superfluous.</p>\n\n<p>Taste is a subjective quality, and there are many reasons to favour either approach.  To me, taste has always been about readability.  Readability doesn't clear favour either approach -- TLDR vs Too Complex; Didn't Bother (TC;DB).</p>\n\n<p>Compiler technology has a fashion mavens influence on taste.  Long ago, when peep hole optimisation was the thing, the second version was preferred; it generated significantly less code.   In the not-so-old days compilers dallied with data flow analysis, and liked the first version because it the pointer chasing was clearly not a hidden alias (unlike the second).   Modern compilers, so hip with gobs of memory and cpu permit better alias checking, so have gone back to the first.  Even still, in your example, it is 3 instructions different.</p>\n"}], "owner": {"reputation": 53, "user_id": 11452194, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eXg2hhVN-5Y/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf4Lmc9R1Cb61xkhny5K9hMSqnTLA/mo/photo.jpg?sz=128", "display_name": "user11452194", "link": "https://stackoverflow.com/users/11452194/user11452194"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1558528873, "creation_date": 1558516759, "last_edit_date": 1558517337, "question_id": 56253372, "link": "https://stackoverflow.com/questions/56253372/is-free-missing-in-this-good-taste-and-bad-tastecode", "title": "Is free() missing in this &quot;good taste&quot; and &quot;bad taste&quot;code?", "body": "<p>In an interview about Linus Torvalds, he shared about the importance of having \"good taste\". He explained good taste with the following code.</p>\n\n<p>Code with \"bad taste\"\n</p>\n\n<pre><code>remove_list_entry(entry)\n{\n    prev = NULL;\n    walk = head;\n\n    // Walk the list\n\n    while (walk != entry) {\n        prev = walk;\n        walk = walk-&gt;next;\n    }\n\n    // Remove the entry by updating the head\n    // or the previous entry\n\n    if (!entry)\n        head = entry-&gt;next;\n    else\n        prev-next = entry-&gt;next;\n}\n</code></pre>\n\n<p>Code with \"good taste\"\n</p>\n\n<pre><code>remove_list_entry(entry)\n{\n    // The \"indirect\" pointer points to the\n    // *address* of the thing we'll update\n\n    indirect = &amp;head;\n\n    // Walk the list, looking for the thing that\n    // points to the thing we want to remove\n\n    while ((*indirect) != entry)\n        indirect = &amp;(*indirect)-&gt;next;\n\n    // .. and just remove it\n    *indirect = entry-&gt;next;\n}\n</code></pre>\n\n<p>Both examples haven't use <code>free()</code> to release the memory of the node to be deleted. Can someone tell me why the code is written in this way? Or am I having the wrong concept regarding to C or linked list?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1558516806, "post_id": 56253336, "comment_id": 99123999, "body": "As to the title: you can&#39;t. There are an infinite number of natural numbers but computer memory is limited."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 3, "creation_date": 1558516846, "post_id": 56253336, "comment_id": 99124031, "body": "Note: you must declare <code>int special[N];</code> <i>after</i> you have read <code>N</code>."}, {"owner": {"reputation": 855, "user_id": 3659239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b6ed436c73d42ba39748209936b7e7?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/3659239/sandy"}, "edited": false, "score": 3, "creation_date": 1558516862, "post_id": 56253336, "comment_id": 99124036, "body": "This looks like an infinite loop to me <code>for(N;N&gt;0;N++)</code> :)"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1558516914, "post_id": 56253336, "comment_id": 99124074, "body": "Read about integers in C. Thay never have a fractional part."}, {"owner": {"reputation": 855, "user_id": 3659239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b6ed436c73d42ba39748209936b7e7?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/3659239/sandy"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1558516975, "post_id": 56253336, "comment_id": 99124107, "body": "@PaulOgilvie but they can be zero or negative ..."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1558516977, "post_id": 56253336, "comment_id": 99124108, "body": "<code>special[]</code> is not initialized. <code>special[i]</code> can have any integer value. Accessing it can abort your program."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 855, "user_id": 3659239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b6ed436c73d42ba39748209936b7e7?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/3659239/sandy"}, "edited": false, "score": 0, "creation_date": 1558517036, "post_id": 56253336, "comment_id": 99124141, "body": "@Sandy, he says &quot;excluding fractional part&quot;"}, {"owner": {"reputation": 855, "user_id": 3659239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b6ed436c73d42ba39748209936b7e7?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/3659239/sandy"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1558517256, "post_id": 56253336, "comment_id": 99124289, "body": "@PaulOgilvie You are right, I didn&#39;t read thoroughly."}, {"owner": {"reputation": 855, "user_id": 3659239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b6ed436c73d42ba39748209936b7e7?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/3659239/sandy"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1558517326, "post_id": 56253336, "comment_id": 99124330, "body": "@PaulOgilvie Why do you say that accessing elements of uninitialized array can lead to abort of program?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 855, "user_id": 3659239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b6ed436c73d42ba39748209936b7e7?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/3659239/sandy"}, "edited": false, "score": 1, "creation_date": 1558517455, "post_id": 56253336, "comment_id": 99124402, "body": "@Sandy, because some compilers can place trap values in uninitialized variables. Some compilers can even remove all the code that tries to access uninitalized variables."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1558518461, "post_id": 56253336, "comment_id": 99124975, "body": "<b>never</b> do a <i>scanf</i> or equivalent without checking the returned value to know if valid input(s) was enter or not"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 855, "user_id": 3659239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b6ed436c73d42ba39748209936b7e7?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/3659239/sandy"}, "edited": false, "score": 0, "creation_date": 1558521828, "post_id": 56253336, "comment_id": 99126836, "body": "@Sandy Because it&#39;s undefined behavior. It can behave in any way. Including aborting the program."}], "answers": [{"comments": [{"owner": {"reputation": 855, "user_id": 3659239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b6ed436c73d42ba39748209936b7e7?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/3659239/sandy"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1558518656, "post_id": 56253900, "comment_id": 99125065, "body": "@bruno Absolutely correct. I wrote it this way to keep it simpler to understand. Otherwise there is no need to store values in array"}, {"owner": {"reputation": 855, "user_id": 3659239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b6ed436c73d42ba39748209936b7e7?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/3659239/sandy"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1558519651, "post_id": 56253900, "comment_id": 99125615, "body": "@bruno Done. Thanks for motivating me."}], "tags": [], "owner": {"reputation": 855, "user_id": 3659239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b6ed436c73d42ba39748209936b7e7?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/3659239/sandy"}, "is_accepted": false, "score": 3, "last_activity_date": 1558519954, "last_edit_date": 1558519954, "creation_date": 1558518274, "answer_id": 56253900, "question_id": 56253336, "link": "https://stackoverflow.com/questions/56253336/how-do-i-generate-an-array-that-can-contain-all-natural-numbers-that-are-greater/56253900#56253900", "title": "How do I generate an array that can contain all natural numbers that are greater than zero?", "body": "<p>There are several issues with the code as pointed out in the comments.</p>\n\n<p>One way of what you want to achieve is:</p>\n\n<pre><code>#include  &lt;stdio.h&gt;\n\nint main(){\n    int N;\n\n    int ret = scanf(\"%d\",&amp;N);\n    if(1 != ret || N &lt; 0)\n        return 1;\n\n    int special[N] ;\n\n    for(int i=0;i&lt;N;i++){\n        ret = scanf(\"%d\", &amp;special[i]);\n        if(1 != ret)\n            return 1;\n        if(special[i] == 0){ \n            printf(\"array not special\\n\");\n            return 1;\n        }   \n    }   \n\n    printf(\"special array\\n\");\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10664889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b3fa9931ca79c3f911866ffdc86bf57?s=128&d=identicon&r=PG&f=1", "display_name": "a.abed", "link": "https://stackoverflow.com/users/10664889/a-abed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1558519954, "creation_date": 1558516658, "last_edit_date": 1558517389, "question_id": 56253336, "link": "https://stackoverflow.com/questions/56253336/how-do-i-generate-an-array-that-can-contain-all-natural-numbers-that-are-greater", "title": "How do I generate an array that can contain all natural numbers that are greater than zero?", "body": "<p>Natural numbers are the set of positive integers, which ranges from 1 to infinity excluding fractional part. Natural numbers are whole numbers excluding zero. Zero is the only whole number which is not a natural number. An array is special if all the elements are natural numbers. Find whether the given array is special or not.</p>\n\n<p>I've tried to use numbers without using <code>scanf</code> it worked and functioned as its supposed to function.</p>\n\n<p>Ihis is the code I tried to write:</p>\n\n<pre><code>#include  &lt;stdio.h&gt;\n\nint main(){\n int N,special[N] ;\n  scanf(\"%d\",&amp;N);\n\nfor(N;N&gt;0;N++){  \n    if(special[N]&gt;0){\n        printf(\"yes/n\");\n    }else{\n        printf(\"no/n\");\n    }\n}\n    return 0;\n\n}\n</code></pre>\n\n<p>I expect the outout to be yes or no. But the actual output is nothing. There is no output to my code.</p>\n"}, {"tags": ["c", "misra", "safety-critical"], "comments": [{"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 2, "creation_date": 1558516859, "post_id": 56253073, "comment_id": 99124034, "body": "1. <code>MYSuccess</code> is not the same as <code>MySuccess</code>. Capitalization matters in C. 2.  0 is passed to <code>MyUtilsLogError</code> as the parameter <code>_format</code>. What is the type of <code>_format</code>. If it is a pointer the MISRA error is saying you cannot convert <code>0</code> to a pointer"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1558516894, "post_id": 56253073, "comment_id": 99124064, "body": "I&#39;m no expert at MISRA, but isn&#39;t <code>goto</code> and functions with variable number of arguments also prohibited? I don&#39;t see how this would pass even if you&#39;d fix violation errors."}, {"owner": {"reputation": 1769, "user_id": 2708608, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/zPQK0.png?s=128&g=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/2708608/amit-sharma"}, "reply_to_user": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1558517637, "post_id": 56253073, "comment_id": 99124503, "body": "@RishikeshRaje Sory that is type.. let me edit the post."}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1558517987, "post_id": 56253073, "comment_id": 99124719, "body": "I guess yout want to write: uint32_t y and not :uint32_y"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1558522715, "post_id": 56253073, "comment_id": 99127320, "body": "I don&#39;t know if MISRA allows <code>goto</code> or <code>return</code> inside a macro, but macros that affect control flow are a <b>very</b> bad idea. It looks like a function call but exits (or jumps in) the &quot;calling&quot; function; don&#39;t break the internal parsers of those who will read the code."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1558523117, "post_id": 56253073, "comment_id": 99127506, "body": "<code>__FUNCTION__</code> is not standard. If you&#39;re using C99 or later, you should use <code>__func__</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1558525039, "post_id": 56253073, "comment_id": 99128523, "body": "This is very fishy code. Macros like these are fine in debug build, but not in your MISRA-compliant production code. It will be impossible to justify them - you should write a proper error handler instead. Instead of &quot;goto fail&quot; BASIC programming, you could wrap your functions in an error handler wrapper. Such as <code>execute(foo, params);</code> where foo returns an error code upon error and <code>execute</code> contains the error handler."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1558525353, "post_id": 56253073, "comment_id": 99128720, "body": "As for your question, I would guess that in the real code you have <code>static bool foo (...</code>. Also <code>} while (0) fail: return e;</code> is not valid C and will not compile. Post the actual code giving the errors."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1558526026, "post_id": 56253073, "comment_id": 99129053, "body": "Use <code>-std=c99 -pedantic -Wall -Wextra -Werror</code> (or the standard you use) to compile and see what happens :)"}, {"owner": {"reputation": 1040, "user_id": 1614319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff0ff3e7d5ad91f5432ad168d4f4c9f5?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1614319/andrew"}, "edited": false, "score": 0, "creation_date": 1560328896, "post_id": 56253073, "comment_id": 99696096, "body": "As an aside, you can drop the &quot;do { ... } while(0)&quot; guff... MISRA C:2012 rightly dropped that requirement :-)"}], "answers": [{"comments": [{"owner": {"reputation": 1769, "user_id": 2708608, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/zPQK0.png?s=128&g=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/2708608/amit-sharma"}, "edited": false, "score": 0, "creation_date": 1558518723, "post_id": 56253763, "comment_id": 99125098, "body": "I have fixed the typos..Thanks for pointing the typos..  We are already passing one args <code>PROPAGATE_ERROR_FAIL_MY_1(foo(x,y))</code>. <code>foo(x,y)</code> will return MyError type code which is arg here to <code>PROPAGATE_ERROR_FAIL_MY_1</code>.  Am I missing something else here ?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 1769, "user_id": 2708608, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/zPQK0.png?s=128&g=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/2708608/amit-sharma"}, "edited": false, "score": 0, "creation_date": 1558518844, "post_id": 56253763, "comment_id": 99125158, "body": "@AmitSharma &quot;<i>missing something else here</i>&quot; you mean about the missing arg ? yes one is missing in <code>MY_UTILS_LOG_ERROR(e, __FILE__, __FUNCTION__, __LINE__, true, 0);</code> you do not have a warning when you compile ?"}, {"owner": {"reputation": 1769, "user_id": 2708608, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/zPQK0.png?s=128&g=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/2708608/amit-sharma"}, "edited": false, "score": 0, "creation_date": 1558519504, "post_id": 56253763, "comment_id": 99125546, "body": "No.. it compiles fine.. where do you see it is missing arg here ?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 1769, "user_id": 2708608, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/zPQK0.png?s=128&g=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/2708608/amit-sharma"}, "edited": false, "score": 0, "creation_date": 1558519666, "post_id": 56253763, "comment_id": 99125621, "body": "@AmitSharma so your problems are fixed ? Else what is the signature of _MyUtilsLogError ?"}, {"owner": {"reputation": 1769, "user_id": 2708608, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/zPQK0.png?s=128&g=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/2708608/amit-sharma"}, "edited": false, "score": 0, "creation_date": 1558520520, "post_id": 56253763, "comment_id": 99126086, "body": "Actually I&#39;ve just snippet/mimicking  this code here to formulate the problem I&#39;m facing.. And I don&#39;t face any compile issue in my code. <code>MyUtilsLogError</code> doesn&#39;t have to deal with MyError enums etc.. and just dump some debug info on console."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 1769, "user_id": 2708608, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/zPQK0.png?s=128&g=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/2708608/amit-sharma"}, "edited": false, "score": 0, "creation_date": 1558520625, "post_id": 56253763, "comment_id": 99126148, "body": "@AmitSharma again, do you still have problems or not ?"}, {"owner": {"reputation": 1769, "user_id": 2708608, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/zPQK0.png?s=128&g=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/2708608/amit-sharma"}, "edited": false, "score": 0, "creation_date": 1558520675, "post_id": 56253763, "comment_id": 99126176, "body": "yes.. it does report MISRA violation as mentioned in question :/"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 1769, "user_id": 2708608, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/zPQK0.png?s=128&g=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/2708608/amit-sharma"}, "edited": false, "score": 0, "creation_date": 1558520747, "post_id": 56253763, "comment_id": 99126218, "body": "@AmitSharma so you have to edit your question to give more, currently we do not have enough to understand your problem. Again what is the signature of <i>MyUtilsLogError</i> and does it knows the enum ??"}, {"owner": {"reputation": 1769, "user_id": 2708608, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/zPQK0.png?s=128&g=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/2708608/amit-sharma"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1558521667, "post_id": 56253763, "comment_id": 99126747, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/193765/discussion-between-amit-sharma-and-bruno\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 0, "last_activity_date": 1558517902, "creation_date": 1558517902, "answer_id": 56253763, "question_id": 56253073, "link": "https://stackoverflow.com/questions/56253073/how-to-fix-mentioned-misra-2012-10-4-and-10-9-violations-issue-in-this-code/56253763#56253763", "title": "How to fix mentioned MISRA-2012 10.4 and 10.9 violations issue in this code?", "body": "<p>in</p>\n\n<blockquote>\n<pre><code>static MyError foo(uint32_t x, uint32_y) {\n</code></pre>\n</blockquote>\n\n<p>you want</p>\n\n<pre><code>static MyError foo(uint32_t x, uint32_t y) {\n</code></pre>\n\n<p>In</p>\n\n<blockquote>\n<pre><code>     if (e != MYSuccess) \\\n</code></pre>\n</blockquote>\n\n<p>you want</p>\n\n<pre><code>     if (e != MySuccess) \\\n</code></pre>\n\n<p>In</p>\n\n<blockquote>\n<pre><code> MY_UTILS_LOG_ERROR(e, __FILE__, __FUNCTION__, __LINE__, true, 0); \\\n</code></pre>\n</blockquote>\n\n<p>there is not enough args, ISO C99 requires at least one argument for the \"...\" in a variadic macro</p>\n\n<p>warning ISO C does not support <code>__FUNCTION__</code> predefined identifier</p>\n\n<p>Also <em>MyUtilsLogError</em> is not declared/defined of your question, what is its signature ? Does it knows at least what <em>MyError</em> is ?</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1558622116, "post_id": 56276224, "comment_id": 99169465, "body": "This doesn&#39;t answer the question (which can&#39;t be answered since the code doesn&#39;t compile). If the warning says &quot;literal 0 shall not be used as a null pointer constant&quot;, then you can&#39;t just aimlessly replace it with an empty string literal, what does that have to do with anything? You changed the meaning of the code. You should be using NULL. Overall, you are apparently just taking wild chances without knowing what you are doing."}, {"owner": {"reputation": 1769, "user_id": 2708608, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/zPQK0.png?s=128&g=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/2708608/amit-sharma"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1558623193, "post_id": 56276224, "comment_id": 99170116, "body": "@Lundin I agree, we can use NULL too to fix this warning... but using <code>&quot;&quot;</code> is immutable const string and it is OK also to use here ? Can you please explain how I changed the meaning of cide ? I feel using passing <code>&quot;&quot;</code> to const char* is fine ?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1558623260, "post_id": 56276224, "comment_id": 99170164, "body": "I have no idea what the function does, so I have no idea."}, {"owner": {"reputation": 1769, "user_id": 2708608, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/zPQK0.png?s=128&g=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/2708608/amit-sharma"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1558623770, "post_id": 56276224, "comment_id": 99170449, "body": "@Lundin <code>format</code> string is format specifier here as we use in printf() functions.."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1558624186, "post_id": 56276224, "comment_id": 99170650, "body": "You aren&#39;t allowed to use those by MISRA-C. The whole of stdio.h is banned, for very good reasons."}], "tags": [], "owner": {"reputation": 1769, "user_id": 2708608, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/zPQK0.png?s=128&g=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/2708608/amit-sharma"}, "is_accepted": false, "score": -1, "last_activity_date": 1558617667, "creation_date": 1558617667, "answer_id": 56276224, "question_id": 56253073, "link": "https://stackoverflow.com/questions/56253073/how-to-fix-mentioned-misra-2012-10-4-and-10-9-violations-issue-in-this-code/56276224#56276224", "title": "How to fix mentioned MISRA-2012 10.4 and 10.9 violations issue in this code?", "body": "<p>I could solve issues with below approach:</p>\n\n<p><strong>Issue [1]</strong>: misra_c_2012_rule_10_4_violation: Essential type of the left hand operand \"e\" (enum) is not the same as that of the right operand \"MySuccess\"(boolean).</p>\n\n<p><strong>==>Fix:</strong> Rule 10.4 violation fix is:</p>\n\n<pre><code>8  #define PROPAGATE_ERROR_FAIL_MY_1(_err) \\\n9  do { \\\n10    e = (_err); \\\n11  + MyError errSuccess = MySuccess; /* This fixes the 10.4 violations */\\ \n11    if (e != MySuccess) \\\n12   { \\\n13       MY_UTILS_LOG_ERROR(e, __FILE__, __FUNCTION__, __LINE__, true, 0); \\\n14        goto fail; \\\n15    } \\\n16 } while (0)\n</code></pre>\n\n<p>So holding the <code>MySuccess</code> in separate <code>MyError</code> var helps to fix the answer. But I don't know how this is fixing the issue here ? It seems without holding <code>MySuccess</code> in separate var macro expansion simply places its value before comparison and MISRA catches this as violation.</p>\n\n<hr>\n\n<p><strong>Issue [2]:</strong> misra_c_2012_rule_11_9_violation: Literal \"0\" shall not be used as null pointer constant.</p>\n\n<p><strong>==>Fix:</strong> Rule 11.9 violation fix is:</p>\n\n<pre><code>- 13 MY_UTILS_LOG_ERROR(e, __FILE__, __FUNCTION__, __LINE__, true, 0); \\\n+ 13 MY_UTILS_LOG_ERROR(e, __FILE__, __FUNCTION__, __LINE__, true, \"\"); \\\n</code></pre>\n\n<p>This fixes the issue because MyUtilsLogError() function expects format: arg as pointer to a const char (const char*). So we shouldn't pass <code>0</code>, passing <code>\"\"</code> for <code>format</code> arg fixes the Rule 11.9 violations.</p>\n"}], "owner": {"reputation": 1769, "user_id": 2708608, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/zPQK0.png?s=128&g=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/2708608/amit-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 522, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1558617667, "creation_date": 1558515793, "last_edit_date": 1558521638, "question_id": 56253073, "link": "https://stackoverflow.com/questions/56253073/how-to-fix-mentioned-misra-2012-10-4-and-10-9-violations-issue-in-this-code", "title": "How to fix mentioned MISRA-2012 10.4 and 10.9 violations issue in this code?", "body": "<p>There are required pieces to formulate my problem. \nBelow are content of <code>MyError.h</code> header file.</p>\n\n<hr>\n\n<h2><strong>myError.h</strong></h2>\n\n<pre><code>###########################\n# myError.h\n###########################\n\n1  typedef enum\n2  {\n3     MySuccess = 0x00000000,\n4     MyError1  = 0x00000001,\n5     MyError2  = 0x00000003,\n6     MyForce32 = 0x7FFFFFFF\n7  } MyError;\n\n8  #define PROPAGATE_ERROR_FAIL_MY_1(_err) \\\n9  do { \\\n10    e = (_err); \\\n11    if (e != MySuccess) \\\n12   { \\\n13       MY_UTILS_LOG_ERROR(e, __FILE__, __FUNCTION__, __LINE__, true, 0); \\\n14        goto fail; \\\n15    } \\\n16 } while (0)\n\n\n17  #define MY_UTILS_LOG_ERROR(_err, _file, _func, _line, _propagating, _format, ...) \\\n18  do { \\\n19    MyUtilsLogError(MY_UTILS_ERROR_TAG, MY_UTILS_ERROR_PATH, \\\n20                            (_err), (_file), (_func), (_line), \\\n21                            (_propagating), (_format), ##__VA_ARGS__); \\\n22 } \\\n23 while (0)\n\n24 void MyUtilsLogError(const char* tag, const char* path, MyError e, const char* file, const char* func,\n                    uint32_t line, bool propagating, const char* format, ...)\n//Here MyError is passed just to print the String for Error for example if we pass MyError1 then string MyError1 will be printed in logs on console.\n</code></pre>\n\n<p>Below are required pieces from <code>MyError.c</code> file, which simply include above header file and calls the <code>PROPAGATE_ERROR_FAIL_MY_1</code> macro in APIs.</p>\n\n<hr>\n\n<h2><strong>myError.c</strong></h2>\n\n<pre><code>#include \"myerror.h\"\n\nstatic MyError foo(uint32_t x, uint32_t y) {\n    if (x==y) {\n        return MySuccess;\n    } else {\n        return MyError1;\n    }\n}\n\nstatic MyError fooCaller(void) {\n    MyError e = MySuccess;\n    uint32_t x = 1U, y = 1U;\n\n    PROPAGATE_ERROR_FAIL_MY_1(foo(x,y)); //This is where I get all kind of weird MISRA violation [1][2].\n\nfail:\n    return e;\n}\n</code></pre>\n\n<h1>NOTE: FYI MyUtilsLogError() is just a API which helps in dumping the logs on console.</h1>\n\n<p>In <code>myError.c</code> file I see below MISRA 2012 violations:</p>\n\n<p>[1]:  misra_c_2012_rule_10_4_violation: Essential type of the left hand operand \"e\" (enum) is not the same as that of the right operand \"MySuccess\"(boolean).</p>\n\n<p>[2]: misra_c_2012_rule_11_9_violation: Literal \"0\" shall not be used as null pointer constant.</p>\n\n<p>I'm not getting why MISRA is reporting 10.4 violation even though I'm comparing the same enum type at line#11 in <code>myErro.h</code> file ?</p>\n\n<p>Any clue why 10.9 violation is being reported here ?\nIs macro not good to use for MISRA ?</p>\n"}, {"tags": ["c", "pointers", "structure"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1558515556, "post_id": 56252869, "comment_id": 99123298, "body": "You should use <code>sizeof(PixelDataOffset)</code>, not the magic number <code>4</code>, btw."}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1558515272, "creation_date": 1558515272, "answer_id": 56252918, "question_id": 56252869, "link": "https://stackoverflow.com/questions/56252869/can-we-use-address-of-0-in-fread-function/56252918#56252918", "title": "Can we use address of 0 in fread function", "body": "<p>With the address-of operator <code>&amp;</code> you get the address of something, i.e. you get a pointer to something.</p>\n\n<p>So with <code>&amp;PixelDataOffset</code> you get a pointer to the variable <code>PixelDataOffset</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1590, "user_id": 3796272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zqSzP.jpg?s=128&g=1", "display_name": "Kampi", "link": "https://stackoverflow.com/users/3796272/kampi"}, "is_accepted": false, "score": 0, "last_activity_date": 1558515495, "creation_date": 1558515495, "answer_id": 56252981, "question_id": 56252869, "link": "https://stackoverflow.com/questions/56252869/can-we-use-address-of-0-in-fread-function/56252981#56252981", "title": "Can we use address of 0 in fread function", "body": "<p>The fread function needs a address for the buffer as first parameter. So you need the <code>&amp;</code> operator to get the address of the variable <code>PixelDataOffset</code> to get a address to the write data for the file.\nIf you write</p>\n\n<pre><code>fread(PixelDataOffset,4,1,fp);\n</code></pre>\n\n<p>the function will assume that the value of <code>PixelDataOffset</code> is a address and will take data from address 0.\nAnother solution is</p>\n\n<pre><code>int Data = 0;\nint* DataPtr = &amp;Data;\nfread(DataPtr,4,1,fp);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2462, "user_id": 2705907, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e2UTS.jpg?s=128&g=1", "display_name": "Vagish", "link": "https://stackoverflow.com/users/2705907/vagish"}, "is_accepted": false, "score": 0, "last_activity_date": 1558515566, "creation_date": 1558515566, "answer_id": 56253001, "question_id": 56252869, "link": "https://stackoverflow.com/questions/56252869/can-we-use-address-of-0-in-fread-function/56253001#56253001", "title": "Can we use address of 0 in fread function", "body": "<p>Depending on where <code>int PixelDataOffset = 0;</code> is written , <code>PixelDataOffset</code> will be stored either at <code>stack</code> or <code>data</code> segments of your primary memory.</p>\n\n<p>The contents of that location will be <code>0</code>.</p>\n\n<p>Now <code>&amp;PixelDataOffset</code> will returns the address of location where <code>PixelDataOffset</code> is stored.</p>\n\n<p>So to answer your question precisely :   <em>it indicate address for value 0</em> .</p>\n"}, {"tags": [], "owner": {"reputation": 174, "user_id": 5793303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca3f5c1b60217f34afd5233750e4cff6?s=128&d=identicon&r=PG&f=1", "display_name": "Babajan", "link": "https://stackoverflow.com/users/5793303/babajan"}, "is_accepted": false, "score": 0, "last_activity_date": 1558516807, "creation_date": 1558516807, "answer_id": 56253394, "question_id": 56252869, "link": "https://stackoverflow.com/questions/56252869/can-we-use-address-of-0-in-fread-function/56253394#56253394", "title": "Can we use address of 0 in fread function", "body": "<pre><code>int PixelDataOffset = 0;\n</code></pre>\n\n<p>In your code PixelDataOffset is a variable of datatype int.</p>\n\n<p>This variable has some address (Let us say address is 0x1000)</p>\n\n<p>Value assigned to this address at the time of declaration is '0'.</p>\n\n<p>Implies at address 0x1000 value '0' is stored.</p>\n\n<blockquote>\n  <p>Does it indicate address for value 0 or address 0?</p>\n</blockquote>\n\n<p>argument passed to fread is &amp;(PixelDataOffset)</p>\n\n<p>Implies address(0x1000) of variable PixelDataOffset is passed.</p>\n\n<blockquote>\n  <p>I don't understood why PixelDataOffset is used there.</p>\n</blockquote>\n\n<p>Answer is simple, fread first argument is some address.</p>\n\n<p>In this example address of PixelDataOffset is passed</p>\n"}], "owner": {"reputation": 127, "user_id": 7635413, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cc408e1bcc128f7c4afdb088dca2648c?s=128&d=identicon&r=PG&f=1", "display_name": "RAP", "link": "https://stackoverflow.com/users/7635413/rap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "closed_date": 1558692260, "answer_count": 4, "score": 0, "last_activity_date": 1560755863, "creation_date": 1558515120, "last_edit_date": 1560755863, "question_id": 56252869, "link": "https://stackoverflow.com/questions/56252869/can-we-use-address-of-0-in-fread-function", "closed_reason": "Duplicate", "title": "Can we use address of 0 in fread function", "body": "<p>I have gone through <code>fread</code> function where syntax is like when I gone through some examples for <code>fread</code> I found the below code.</p>\n\n<p>I understood that in the <code>fread</code> function first parameter is address of block of memory to store the objects, second parameter is size of each object in bytes, third parameter is no of objects, final parameter is pointer to the file.</p>\n\n<p>Syntax:</p>\n\n<pre><code>size_t fread(void * buffer, size_t size, size_t count, FILE * stream).\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>int a_var= 0;\nFILE *file;\nfread(&amp;(a_var),4,1,file);\n</code></pre>\n\n<p>I don't understood why <code>a_var</code> is used there. Does it indicate address for value 0 or address 0?</p>\n"}, {"tags": ["c", "double"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 4, "creation_date": 1558514505, "post_id": 56252624, "comment_id": 99122652, "body": "<code>x</code> is an <code>int</code>. You can&#39;t make it a <code>double</code> at your will."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1558514512, "post_id": 56252624, "comment_id": 99122656, "body": "Unlike other languages (e.g. python), C does not change the type of a variable to match the value. Instead it changes the type of the value to match the variable. Since <code>x</code> is declared as an <code>int</code>, any value assigned to <code>x</code> will be converted to an <code>int</code>."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1558514635, "post_id": 56252624, "comment_id": 99122728, "body": "<code>3.14</code>?\u034f\u034f\u034f\u034f\u034f\u034f\u034f\u034f\u034f\u034f\u034f\u034f\u034f"}, {"owner": {"reputation": 166, "user_id": 10532707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nyxOb.jpg?s=128&g=1", "display_name": "Nehal Samee", "link": "https://stackoverflow.com/users/10532707/nehal-samee"}, "edited": false, "score": 0, "creation_date": 1558514713, "post_id": 56252624, "comment_id": 99122772, "body": "@Bathsheba...its pi im using"}, {"owner": {"reputation": 320, "user_id": 9892803, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BbRHrblhIfc/AAAAAAAAAAI/AAAAAAAAIz8/KinSdAS0q1o/photo.jpg?sz=128", "display_name": "Pratik Sampat", "link": "https://stackoverflow.com/users/9892803/pratik-sampat"}, "edited": false, "score": 0, "creation_date": 1558514737, "post_id": 56252624, "comment_id": 99122792, "body": "You&#39;re typecasting into double but <code>x</code> is still int and when you print with <code>lf</code> it expects a double but it is still an integer. Compile with the <code>-Wall</code> flag next time to gain better insight."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1558514803, "post_id": 56252624, "comment_id": 99122837, "body": "You&#39;re not using <code>pi</code>. You&#39;re using <code>3.14</code>."}, {"owner": {"reputation": 166, "user_id": 10532707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nyxOb.jpg?s=128&g=1", "display_name": "Nehal Samee", "link": "https://stackoverflow.com/users/10532707/nehal-samee"}, "reply_to_user": {"reputation": 320, "user_id": 9892803, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BbRHrblhIfc/AAAAAAAAAAI/AAAAAAAAIz8/KinSdAS0q1o/photo.jpg?sz=128", "display_name": "Pratik Sampat", "link": "https://stackoverflow.com/users/9892803/pratik-sampat"}, "edited": false, "score": 0, "creation_date": 1558514844, "post_id": 56252624, "comment_id": 99122860, "body": "@Pratik..  Can you provide any insight of how using a -Wall flag?"}, {"owner": {"reputation": 320, "user_id": 9892803, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BbRHrblhIfc/AAAAAAAAAAI/AAAAAAAAIz8/KinSdAS0q1o/photo.jpg?sz=128", "display_name": "Pratik Sampat", "link": "https://stackoverflow.com/users/9892803/pratik-sampat"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1558515062, "post_id": 56252624, "comment_id": 99122986, "body": "@NehalSamee. <code>gcc -Wall program.c</code> will show some insightful warnings you may have not noticed.  Also following @Bathsheba suggestion, if you want to use pi, include <code>math.h</code> and use <code>M_PI</code> instead."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 320, "user_id": 9892803, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BbRHrblhIfc/AAAAAAAAAAI/AAAAAAAAIz8/KinSdAS0q1o/photo.jpg?sz=128", "display_name": "Pratik Sampat", "link": "https://stackoverflow.com/users/9892803/pratik-sampat"}, "edited": false, "score": 1, "creation_date": 1558515507, "post_id": 56252624, "comment_id": 99123261, "body": "@PratikSampat: Except that <code>M_PI</code> is not required by the standard, so your code would not be portable. Oh joy!"}, {"owner": {"reputation": 320, "user_id": 9892803, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BbRHrblhIfc/AAAAAAAAAAI/AAAAAAAAIz8/KinSdAS0q1o/photo.jpg?sz=128", "display_name": "Pratik Sampat", "link": "https://stackoverflow.com/users/9892803/pratik-sampat"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1558515979, "post_id": 56252624, "comment_id": 99123511, "body": "@Bathsheba, or you could just <code># define M_PI 3.14159265358979323846</code> which is what&#39;s in the <code>math.h</code> source?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 320, "user_id": 9892803, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BbRHrblhIfc/AAAAAAAAAAI/AAAAAAAAIz8/KinSdAS0q1o/photo.jpg?sz=128", "display_name": "Pratik Sampat", "link": "https://stackoverflow.com/users/9892803/pratik-sampat"}, "edited": false, "score": 0, "creation_date": 1558516613, "post_id": 56252624, "comment_id": 99123899, "body": "@PratikSampat: See one of my better answers, written on the C++ tag, but the sentiment applies to C: <a href=\"https://stackoverflow.com/questions/49778240/does-c11-14-17-or-20-introduce-a-standard-constant-for-pi/49778493#49778493\" title=\"does c11 14 17 or 20 introduce a standard constant for pi\">stackoverflow.com/questions/49778240/&hellip;</a>"}, {"owner": {"reputation": 320, "user_id": 9892803, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BbRHrblhIfc/AAAAAAAAAAI/AAAAAAAAIz8/KinSdAS0q1o/photo.jpg?sz=128", "display_name": "Pratik Sampat", "link": "https://stackoverflow.com/users/9892803/pratik-sampat"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1558516876, "post_id": 56252624, "comment_id": 99124050, "body": "Ah neat! I&#39;ve learned something new today. Thanks @Bathsheba!"}], "answers": [{"comments": [{"owner": {"reputation": 166, "user_id": 10532707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nyxOb.jpg?s=128&g=1", "display_name": "Nehal Samee", "link": "https://stackoverflow.com/users/10532707/nehal-samee"}, "edited": false, "score": 0, "creation_date": 1558515648, "post_id": 56252898, "comment_id": 99123348, "body": "Is my second  code correct??And should I use 22/7  or 3.1416 instead?"}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 5, "last_activity_date": 1558515770, "last_edit_date": 1558515770, "creation_date": 1558515212, "answer_id": 56252898, "question_id": 56252624, "link": "https://stackoverflow.com/questions/56252624/confusing-result-while-converting-degree-into-radian-in-c/56252898#56252898", "title": "Confusing result while converting degree into radian in C", "body": "<p>There are two problems in your code:</p>\n\n<pre><code>x = (double)((x*3.14)/180);\n</code></pre>\n\n<p><code>(x*3.14)/180</code> is already a <code>double</code> therefore this line is equivalent to:</p>\n\n<pre><code>x = (x*3.14)/180;\n</code></pre>\n\n<p>but anyway the type of <code>x</code> remains <code>int</code>, so if <code>x</code> was e.g <code>300</code>, the new values of <code>x</code> will be <code>300 * 3.14/180 = 5.2333</code> which will be trunacated to <code>5</code>.</p>\n\n<p>The second problem is here:</p>\n\n<pre><code>printf(\"%.6lf\",x);\n</code></pre>\n\n<p>As explained before, the type of <code>x</code> is <code>int</code>, but the <code>\"%.6lf\"</code> format specifier requires a <code>double</code>. If the variable types don't match the format specifier, the behaviour is undefined.</p>\n\n<p>The second version of your code is perfectly correct, but be aware that the user can only enter integer values.</p>\n\n<p>BTW: 3.14 is a very poor approximation of PI, I'm sure you can do better.</p>\n"}], "owner": {"reputation": 166, "user_id": 10532707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nyxOb.jpg?s=128&g=1", "display_name": "Nehal Samee", "link": "https://stackoverflow.com/users/10532707/nehal-samee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 56252898, "answer_count": 1, "score": 0, "last_activity_date": 1558515770, "creation_date": 1558514256, "question_id": 56252624, "link": "https://stackoverflow.com/questions/56252624/confusing-result-while-converting-degree-into-radian-in-c", "title": "Confusing result while converting degree into radian in C", "body": "<pre><code>  int x;\n  scanf(\"%d\",&amp;x);\n  x=(double)((x*3.14)/180);\n  printf(\"%.6lf\",x);\n</code></pre>\n\n<p>When I  run the above code and input x=60, I get -0.000000. </p>\n\n<pre><code>  int x;\n  double a;\n  scanf(\"%d\",&amp;x);\n  a=(x*3.14)/180;\n  printf(\"%.6lf\",a);\n</code></pre>\n\n<p>But when I  run this above code, I get the correct answer. </p>\n\n<p>I want to know where I am doing wrong. Is there problem in my type casting or use of double or any other thing? Any help will be appreciated. Thanks! </p>\n\n<p>N.B. : I need to print output upto 6 digits after decimal.</p>\n"}, {"tags": ["c++", "c", "linux", "audit"], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 10751101, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Y-KNXHt2bpc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g3z21pPucFD2QcV544TW0JDsQ4_g/mo/photo.jpg?sz=128", "display_name": "Alex", "link": "https://stackoverflow.com/users/10751101/alex"}, "is_accepted": true, "score": 1, "last_activity_date": 1560795422, "last_edit_date": 1560795422, "creation_date": 1559483352, "answer_id": 56415644, "question_id": 56252499, "link": "https://stackoverflow.com/questions/56252499/how-to-use-libaudit/56415644#56415644", "title": "How to use libaudit?", "body": "<p>I found a solution. Here is an example of the minimum working code.</p>\n\n<p>The libaudit provides an interface for adding/removing rules:</p>\n\n<pre><code>int fd = audit_open();\nstruct audit_rule_data *rule = new audit_rule_data();\n\n// what directory we will follow.\naudit_add_watch_dir(AUDIT_DIR,\n                    &amp;rule,\n                    \"/etc\");\n\n// setting rule.\naudit_add_rule_data(fd,\n                    rule,\n                    AUDIT_FILTER_EXIT,\n                    AUDIT_ALWAYS);\n\n// or removing rule.\naudit_delete_rule_data(fd,\n                       rule,\n                       AUDIT_FILTER_EXIT,\n                       AUDIT_ALWAYS);\n\naudit_close(fd);\n</code></pre>\n\n<p>To set some specific event and set an additional filter you need to do something like this:</p>\n\n<pre><code>int fd = audit_open();\n\naudit_rule_syscallbyname_data(rule_new, \"open\");\naudit_rule_syscallbyname_data(rule_new, \"close\");\n\n// Set extra filter, for example, follow the user with id=1000.\nchar pair[] = \"uid=1000\";\naudit_rule_fieldpair_data(&amp;rule_new, pair, AUDIT_FILTER_EXIT);\n\naudit_add_rule_data(fd, rule_new, AUDIT_FILTER_EXIT, AUDIT_ALWAYS);\n\naudit_close(fd);\n</code></pre>\n\n<p>To make an exception to the rules you need:</p>\n\n<pre><code>audit_rule_syscallbyname_data(rule, \"mkdir\");\nchar pair[] = \"path=/etc\";\naudit_rule_fieldpair_data(&amp;rule,\n                          pair,\n                          AUDIT_FILTER_EXIT);\naudit_add_rule_data(fd,\n                    rule,\n                    AUDIT_FILTER_EXIT,\n                    AUDIT_NEVER);\n</code></pre>\n\n<p>To receive messages from the audit:</p>\n\n<pre><code>void monitoring(struct ev_loop *loop, struct ev_io *io, int revents)\n{\n    struct audit_reply reply;\n\n    audit_get_reply(fd, &amp;reply, GET_REPLY_NONBLOCKING, 0);\n\n    if (reply.type != AUDIT_EOE &amp;&amp;\n        reply.type != AUDIT_PROCTITLE &amp;&amp;\n        reply.type != AUDIT_PATH)\n    {\n        char *buf = new char[MAX_AUDIT_MESSAGE_LENGTH];\n\n        snprintf(buf,\n                 MAX_AUDIT_MESSAGE_LENGTH,\n                 \"Type=%s Message=%.*s\",\n                 audit_msg_type_to_name(reply.type),\n                 reply.len,\n                 reply.message);\n\n        printf(\"EVENT: %s\\n\", buf);\n\n    }\n}\n\nint main()\n{\n    struct ev_io monitor;\n    fd = audit_open();\n\n    audit_set_pid(fd, getpid(), WAIT_YES);\n\n    loop = ev_default_loop(EVFLAG_NOENV);\n\n    ev_io_init(&amp;monitor, monitoring, fd, EV_READ);\n    ev_io_start(loop, &amp;monitor);\n\n    ev_loop(loop, 0);\n\n    audit_close(fd);\n    return 0;\n}\n</code></pre>\n\n<p>UPD.\nYour audit will not work if you do not write:</p>\n\n<pre><code>audit_set_enabled(audit_fd, 1);\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10751101, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Y-KNXHt2bpc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g3z21pPucFD2QcV544TW0JDsQ4_g/mo/photo.jpg?sz=128", "display_name": "Alex", "link": "https://stackoverflow.com/users/10751101/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1144, "favorite_count": 0, "accepted_answer_id": 56415644, "answer_count": 1, "score": 0, "last_activity_date": 1560795422, "creation_date": 1558513854, "question_id": 56252499, "link": "https://stackoverflow.com/questions/56252499/how-to-use-libaudit", "title": "How to use libaudit?", "body": "<p>I am trying to understand how to work with libaudit.\nI want to recieve events about user actions using C/C++.</p>\n\n<p>I don't understand how to set rules, and how to get information about user actions.</p>\n\n<p>For example, I want to get information when user created directory.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>    int audit_fd = audit_open();\n\n    struct audit_rule_data *rule = (struct audit_rule_data *) malloc(sizeof(struct audit_rule_data));\n    memset(rule, 0, sizeof(struct audit_rule_data));\n\n    audit_rule_syscallbyname_data(rule, \"mkdir\");\n    audit_add_watch_dir(AUDIT_DIR, &amp;rule, \"/tmp\");\n    audit_add_rule_data(audit_fd,\n                        rule,\n                        AUDIT_FILTER_USER,\n                        AUDIT_ALWAYS);\n\n    int rc;\n    fd_set read_mask;\n    FD_ZERO(&amp;read_mask);\n    FD_SET(audit_fd, &amp;read_mask);\n\n    struct timeval t;\n    t.tv_sec  = 0;\n    t.tv_usec = 300 * 1000;\n\n    do\n    {\n        rc = select(audit_fd+1, &amp;read_mask, NULL, NULL, &amp;t /*NULL*/);\n\n        struct audit_reply *rep = NULL;\n        audit_get_reply(audit_fd, rep, GET_REPLY_NONBLOCKING, 0);\n\n        if (rep != NULL)\n        {\n            printf(\"%s\", rep-&gt;message);\n            break;\n        }\n    }\n    while (rc &lt; 0);\n\n\n    audit_close(audit_fd);\n</code></pre>\n\n<p>This code does not work, it does not get reply from libaudit, what is wrong?</p>\n\n<p>Actually, I need to get more information about user: who logged in, what he was running, what he was trying to change, etc.</p>\n"}, {"tags": ["c", "function"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1558513626, "post_id": 56252324, "comment_id": 99122163, "body": "<code>char* fileName; gets(fileName);</code> - there is no memory behind <code>fileName</code> pointer."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1558513956, "post_id": 56252324, "comment_id": 99122352, "body": "<a href=\"https://stackoverflow.com/questions/1694036\">Why you shouldn&#39;t use <code>gets</code></a>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1558514495, "post_id": 56252324, "comment_id": 99122645, "body": "Think about separating interface and implementation. Interface is your interaction with the user. Where you get the file name. Implementation is your check of whether the file exists. You may have other instance where you have the file name and simply want to check if it exists. You don&#39;t want <code>&quot;Please enter a file name: &quot;</code> popping up all the time. So separate your request for a filename into a separate function, then pass the filename as a parameter to your function that checks if it exists."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1558515005, "post_id": 56252324, "comment_id": 99122953, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/230062/whats-the-best-way-to-check-if-a-file-exists-in-c\">What&#39;s the best way to check if a file exists in C?</a>"}, {"owner": {"reputation": 19, "user_id": 11538103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvEqKmrRqhg/AAAAAAAAAAI/AAAAAAAAPE4/-E1A9PBbWm0/photo.jpg?sz=128", "display_name": "EthanCode26", "link": "https://stackoverflow.com/users/11538103/ethancode26"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1558516418, "post_id": 56252324, "comment_id": 99123780, "body": "@bruno, I saw this question before posting my own, that question did not help me because I am trying to pass the file name as an argument into the function. I didn&#39;t know how to do so."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1558516528, "post_id": 56252324, "comment_id": 99123850, "body": "@EthanCode26 a filename is just a <code>char*</code>, it is given in arg in the code of the duplicate question (<code>int exists(const char *fname)</code>), where is the problem ?"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 11538103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvEqKmrRqhg/AAAAAAAAAAI/AAAAAAAAPE4/-E1A9PBbWm0/photo.jpg?sz=128", "display_name": "EthanCode26", "link": "https://stackoverflow.com/users/11538103/ethancode26"}, "edited": false, "score": 0, "creation_date": 1558513965, "post_id": 56252429, "comment_id": 99122356, "body": "Thank you @Keine Lust, how would you recommend allocating space for it. Should I use malloc(fileName* sizeof(char)) ... ?"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 19, "user_id": 11538103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvEqKmrRqhg/AAAAAAAAAAI/AAAAAAAAPE4/-E1A9PBbWm0/photo.jpg?sz=128", "display_name": "EthanCode26", "link": "https://stackoverflow.com/users/11538103/ethancode26"}, "edited": false, "score": 1, "creation_date": 1558514152, "post_id": 56252429, "comment_id": 99122464, "body": "If you don&#39;t know before hand the maximum size of the line then yes, use <code>malloc</code>, some implementations defines the maximum size of a line in <code>stdin</code> with <code>LINE_MAX</code>, you can check if your compiler defines it as an extension and in this case you can use this value with a fixed array."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1558514454, "post_id": 56252429, "comment_id": 99122622, "body": "Just fix some reasonable size for the maximal file name length for example 300."}, {"owner": {"reputation": 19, "user_id": 11538103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvEqKmrRqhg/AAAAAAAAAAI/AAAAAAAAPE4/-E1A9PBbWm0/photo.jpg?sz=128", "display_name": "EthanCode26", "link": "https://stackoverflow.com/users/11538103/ethancode26"}, "edited": false, "score": 0, "creation_date": 1558514556, "post_id": 56252429, "comment_id": 99122676, "body": "Thank you; so I must know how much space to allocate in order not to waste memory. Any suggestions on how to do so?"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 19, "user_id": 11538103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvEqKmrRqhg/AAAAAAAAAAI/AAAAAAAAPE4/-E1A9PBbWm0/photo.jpg?sz=128", "display_name": "EthanCode26", "link": "https://stackoverflow.com/users/11538103/ethancode26"}, "edited": false, "score": 0, "creation_date": 1558514669, "post_id": 56252429, "comment_id": 99122746, "body": "@EthanCode26 in this case you can use <code>getline</code> (or reimplement-it  if not available in your libs), take a look to <a href=\"https://github.com/lattera/freebsd/blob/master/contrib/file/getline.c\" rel=\"nofollow noreferrer\">github.com/lattera/freebsd/blob/master/contrib/file/getline.&zwnj;&#8203;c</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 19, "user_id": 11538103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvEqKmrRqhg/AAAAAAAAAAI/AAAAAAAAPE4/-E1A9PBbWm0/photo.jpg?sz=128", "display_name": "EthanCode26", "link": "https://stackoverflow.com/users/11538103/ethancode26"}, "edited": false, "score": 0, "creation_date": 1558515938, "post_id": 56252429, "comment_id": 99123491, "body": "@EthanCode26 using a fixed size of say 300 bytes it not wasting memory, especially if <code>filename</code> is a local variable. But anyway, if you have functions such as <code>fread</code>, your platform is most likely not very restricted in terms of memory."}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 6, "last_activity_date": 1558513829, "last_edit_date": 1558513829, "creation_date": 1558513685, "answer_id": 56252429, "question_id": 56252324, "link": "https://stackoverflow.com/questions/56252324/check-the-existence-of-a-txt-file-in-c/56252429#56252429", "title": "Check the existence of a .txt file in C", "body": "<p><code>gets</code> wants room, you can not use <code>gets</code> with an unallocated space, should be <code>char filename[SOME_SIZE];</code></p>\n\n<p>On the other hand, do not use <code>gets</code> since it is no longer part of the language, instead use <code>fgets</code>  and strip the trailing newline.</p>\n\n<blockquote>\n  <p>Read this on how to trail the newline \n  <a href=\"https://stackoverflow.com/questions/2693776/removing-trailing-newline-character-from-fgets-input\">Removing trailing newline character from fgets() input</a></p>\n</blockquote>\n"}], "owner": {"reputation": 19, "user_id": 11538103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvEqKmrRqhg/AAAAAAAAAAI/AAAAAAAAPE4/-E1A9PBbWm0/photo.jpg?sz=128", "display_name": "EthanCode26", "link": "https://stackoverflow.com/users/11538103/ethancode26"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558513829, "creation_date": 1558513345, "question_id": 56252324, "link": "https://stackoverflow.com/questions/56252324/check-the-existence-of-a-txt-file-in-c", "title": "Check the existence of a .txt file in C", "body": "<p>I am trying to create a function which takes a file name from the user and checks if it exists, as long as it does not exist I wish to re-ask the user to input a file until it finds a file that does exist. Finally, I wish to return the name of that file to the main in order to use in a different function.</p>\n\n<p>I've created a function which I thought would work but it seems that I may have a problem with calling the variable and not inputting the file name directly. (I'm not positive that that is the issue).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n\nchar* fileCheck();\nchar* fileCheck()\n{\n    char* fileName;\n    printf(\"Please enter a file name: \");\n    gets(fileName);\n    while (access(fileName, F_OK) == -1)\n    {\n        printf(\"The File %s was not Found\\nPlease enter a new file name: \", fileName);\n        gets(fileName);\n    }\n    return fileName;\n}\n\nint main (void)\n{\n    fileCheck();\n    return 0;\n}\n</code></pre>\n\n<p>I expect the output of the function to be the valid (existing) file name. In actuality I am receiving a garbage number exit code.</p>\n"}, {"tags": ["c", "language-lawyer"], "comments": [{"owner": {"reputation": 1585, "user_id": 421550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e7a2292ef4ad3674b556df31e81efce?s=128&d=identicon&r=PG", "display_name": "domen", "link": "https://stackoverflow.com/users/421550/domen"}, "edited": false, "score": 4, "creation_date": 1558510541, "post_id": 56251520, "comment_id": 99120571, "body": "Just so I understand: There&#39;s a warning, and you agree it makes sense, but you&#39;re wondering if standard says anything about it? I don&#39;t think standard mentions what compilers should warn about."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1558510701, "post_id": 56251520, "comment_id": 99120666, "body": "Which compiler complained? Complained how? Post the exact compiler message including line number and filename you got from the compiler, including compiler version and compiler options alongside with the smallest reproducible source code and steps needed to reproduce the issue. We can&#39;t help that some strange compiler &quot;complained&quot; to you."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 1585, "user_id": 421550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e7a2292ef4ad3674b556df31e81efce?s=128&d=identicon&r=PG", "display_name": "domen", "link": "https://stackoverflow.com/users/421550/domen"}, "edited": false, "score": 3, "creation_date": 1558511049, "post_id": 56251520, "comment_id": 99120846, "body": "@domen The C standard states that the compiler must give a diagnostic message for constraint violations - that is, for clear violations of the standard. The terms &quot;warning&quot; and &quot;error&quot; don&#39;t exist in the standard though, nor does the standard say anything about potential binary output from the compiler in case of language violations."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1558513879, "post_id": 56251520, "comment_id": 99122301, "body": "I\u2019d like to state for the record that I did <i>not</i> vote to close the question as \u201ctoo broad\u201d (since it isn\u2019t). I voted to close since it\u2019s unclear what\u2019s being asked her, and no clarifications are forthcoming. As soon as the question is sufficiently clarified I\u2019ll vote to reopen it."}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 1, "last_activity_date": 1558513132, "last_edit_date": 1558513132, "creation_date": 1558512693, "answer_id": 56252150, "question_id": 56251520, "link": "https://stackoverflow.com/questions/56251520/static-function-declaration-without-definition/56252150#56252150", "title": "Static function declaration without definition", "body": "<p>A static function is only visible inside that compilation unit.</p>\n\n<p>A static function <em>declaration</em> provides the prototype (name, return type and parameters) of such a function.</p>\n\n<p>A static function <em>definition</em> gives the implementation of the function.</p>\n\n<p>A static function that is <em>declared</em> but <em>not used</em> and has no implementation, should not cause a warning. Would it be used but not have an implementation (in that compilation unit), then it is an <em>error</em>.</p>\n\n<pre><code>static int NotUsed(int not_used);  // perfectly legal without implementation if not used\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "is_accepted": false, "score": 0, "last_activity_date": 1558512814, "last_edit_date": 1592644375, "creation_date": 1558512814, "answer_id": 56252177, "question_id": 56251520, "link": "https://stackoverflow.com/questions/56251520/static-function-declaration-without-definition/56252177#56252177", "title": "Static function declaration without definition", "body": "<blockquote>\n<p>I wonder if the standard states anything about that.</p>\n</blockquote>\n<p>No, standard doesn't require that:</p>\n<blockquote>\n<h3>5.1.1.3 Diagnostics</h3>\n<ol>\n<li>A conforming implementation <strong>shall produce at least one diagnostic message</strong> (identified in an imple-mentation-defined manner) <strong>if a preprocessing translation unit or translation unit contains a violation\nof any syntax rule or constraint</strong>, even if the behavior is also explicitly specified as undefined or\nimplementation-defined. <strong>Diagnostic messages need not be produced in other circumstances.</strong> <sup>9)</sup></li>\n</ol>\n</blockquote>\n<p>In general, standard doesn't seem to care about issues that are not actively harmful. Unnecessary declaration doesn't prevent a construction of correct program.</p>\n<blockquote>\n<p>From my point of view, it makes sense to complain here as the function cannot be used in another compilation unit and therefore is of no use at all.</p>\n</blockquote>\n<p>As you have seen, some compiler providers agree with you. But it's simply not <em>required</em> by the standard.</p>\n"}], "owner": {"reputation": 1431, "user_id": 1257204, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a013d2a5e5727c3c91c357d95d04f98a?s=128&d=identicon&r=PG", "display_name": "m47h", "link": "https://stackoverflow.com/users/1257204/m47h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "closed_date": 1558513781, "answer_count": 2, "score": 1, "last_activity_date": 1558513132, "creation_date": 1558510275, "last_edit_date": 1558511896, "question_id": 56251520, "link": "https://stackoverflow.com/questions/56251520/static-function-declaration-without-definition", "closed_reason": "Needs more focus", "title": "Static function declaration without definition", "body": "<p>I compiled a program with several compilers and one of them complained about a static function declaration without a definition in a certain compilation unit. I wonder if the standard states anything about that. \nFrom my point of view, it makes sense to complain here as the function cannot be used in another compilation unit and therefore is of no use at all.</p>\n"}, {"tags": ["c", "malloc", "sbrk"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1558510182, "post_id": 56251456, "comment_id": 99120380, "body": "Modern POSIX allocators usually use <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/mmap.html\" rel=\"nofollow noreferrer\"><code>mmap</code></a> for their allocations, not <code>sbrk</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1558510237, "post_id": 56251456, "comment_id": 99120424, "body": "By the way, the proper <a href=\"https://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\"><code>printf</code></a> format to print a pointer (<code>void *</code>) is <code>&quot;%p&quot;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": true, "score": 2, "last_activity_date": 1558512527, "creation_date": 1558512527, "answer_id": 56252107, "question_id": 56251456, "link": "https://stackoverflow.com/questions/56251456/why-malloc-and-sbrk-returns-address-from-seperate-segments/56252107#56252107", "title": "Why malloc and sbrk returns address from seperate segments?", "body": "<p>The standard does not give any guarantee for the contiguity of storage <strong><em>even for</em></strong> memory allocated by successive calls to <code>malloc</code>. So the different calls to <code>malloc</code> in your code need not yield contiguous locations.</p>\n\n<p>The C11 standard states:</p>\n\n<blockquote>\n  <p><strong><a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.22.3\" rel=\"nofollow noreferrer\">7.22.3 Memory management functions</a></strong>  </p>\n  \n  <p><a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.22.3p1\" rel=\"nofollow noreferrer\">1.</a> The order and contiguity of storage allocated by successive calls to the\n  <code>aligned_alloc</code>, <code>calloc</code>, <code>malloc</code>, and <code>realloc</code> functions is unspecified.</p>\n</blockquote>\n\n<p>And the addresses that come from the mixing up of <code>malloc</code> and <code>sbrk</code> calls need not be contiguous either.</p>\n"}, {"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 3, "last_activity_date": 1558516932, "creation_date": 1558516932, "answer_id": 56253441, "question_id": 56251456, "link": "https://stackoverflow.com/questions/56251456/why-malloc-and-sbrk-returns-address-from-seperate-segments/56253441#56253441", "title": "Why malloc and sbrk returns address from seperate segments?", "body": "<p>Assuming you're running on Linux, the reason the memory from <code>malloc()</code> and <code>sbrk()</code> has a relative large difference in location is that the glibc <code>malloc()</code> implementation uses <code>sbrk()</code> internally to obtain the memory that functions such as <code>malloc()</code> return to the caller.  For example, assume the initial internal glibc implementation obtains 32 MB of heap memory via <code>sbrk()</code> and memory returned from <code>malloc()</code> will be in this 32 MB chunk.  If you then use <code>sbrk()</code> to obtain memory, it will be from memory newly allocate at the end of that original 32 MB chunk, so the addresses from <code>malloc()</code> and <code>sbrk()</code> will differ. </p>\n\n<p>Note that you can't safely mix the use of <code>malloc()</code> (and <code>calloc()</code>, <code>realloc()</code>, etc) and <code>sbrk()</code> since the internal implementation of <code>malloc()</code> uses <code>sbrk()</code> to obtain the memory it returns via <code>malloc()</code>.  Per <a href=\"http://man7.org/linux/man-pages/man3/free.3.html\" rel=\"nofollow noreferrer\">the Linux <code>malloc()</code> man page</a>:</p>\n\n<blockquote>\n  <p>Normally, <code>malloc()</code> allocates memory from the heap, and adjusts the\n         size of the heap as required, using <code>sbrk(2)</code>.  When allocating blocks\n         of memory larger than <code>MMAP_THRESHOLD</code> bytes, the glibc <code>malloc()</code>\n         implementation allocates the memory as a private anonymous mapping\n         using <code>mmap(2)</code>.  <code>MMAP_THRESHOLD</code> is 128 kB by default, but is\n         adjustable using <code>mallopt(3)</code>.  Prior to Linux 4.7 allocations\n         performed using <code>mmap(2)</code> were unaffected by the <code>RLIMIT_DATA</code> resource\n         limit; since Linux 4.7, this limit is also enforced for allocations\n         performed using <code>mmap(2)</code>.</p>\n</blockquote>\n\n<p>When you mix <code>malloc()</code> and <code>sbrk()</code> on Linux to obtain memory, you will likely corrupt the process's heap.</p>\n"}], "owner": {"reputation": 329, "user_id": 8584523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/adbKI.jpg?s=128&g=1", "display_name": "Sadaananth Anbucheliyan", "link": "https://stackoverflow.com/users/8584523/sadaananth-anbucheliyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 547, "favorite_count": 0, "accepted_answer_id": 56252107, "answer_count": 2, "score": 2, "last_activity_date": 1558516932, "creation_date": 1558510015, "last_edit_date": 1558511146, "question_id": 56251456, "link": "https://stackoverflow.com/questions/56251456/why-malloc-and-sbrk-returns-address-from-seperate-segments", "title": "Why malloc and sbrk returns address from seperate segments?", "body": "<p>I am trying to implement understand how dynamic memory allocation is happening. So I thought of implementing malloc of my own using <code>sbrk()</code> system call.\nMy Question here is when i try to allocate dynamic memory, sbrk() and malloc() returns different addresses not continuous.</p>\n\n<p>Here is my code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char** argv)\n{\n    printf(\"\\nsbrk(0) %llu \",(unsigned long long)sbrk(0));\n    printf(\"\\nmalloc(8) %llu \",(unsigned long long)malloc(8));\n    printf(\"\\nmalloc(8) %llu \",(unsigned long long)malloc(8));\n    printf(\"\\nsbrk(8) %llu \",(unsigned long long)sbrk(8));\n    printf(\"\\nmalloc(8) %llu \",(unsigned long long)malloc(8));\n    printf(\"\\nmalloc(8) %llu \",(unsigned long long)malloc(8));  \n    printf(\"\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>Output of the above code is</p>\n\n<pre><code>sbrk(0) 30306304 \nmalloc(8) 30306320 \nmalloc(8) 30306352 \nsbrk(8) 30441472 \nmalloc(8) 30306384 \nmalloc(8) 30306416 \n</code></pre>\n\n<p>Can anyone explain why <code>sbrk(8)</code> is not continuous locations.</p>\n"}, {"tags": ["c", "counter"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1558509266, "post_id": 56251095, "comment_id": 99119811, "body": "Well, the first issue is <code>MAIN {</code>. That&#39;s not valid C syntax."}, {"owner": {"reputation": 855, "user_id": 3659239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b6ed436c73d42ba39748209936b7e7?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/3659239/sandy"}, "edited": false, "score": 0, "creation_date": 1558509701, "post_id": 56251095, "comment_id": 99120077, "body": "Why don&#39;t you save the run count too in the same database. That way you could read it at the start of prog, increment it by one and then write that value in database."}, {"owner": {"reputation": 175, "user_id": 9431030, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DiO1cugRDI4/AAAAAAAAAAI/AAAAAAAAALc/TUnnCgQJvBI/photo.jpg?sz=128", "display_name": "Yoni Newman", "link": "https://stackoverflow.com/users/9431030/yoni-newman"}, "edited": false, "score": 1, "creation_date": 1558509717, "post_id": 56251095, "comment_id": 99120085, "body": "its a wierd combination between C and pseudo code"}, {"owner": {"reputation": 101, "user_id": 8923975, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-1Q3jXBcQi-c/AAAAAAAAAAI/AAAAAAAADDc/g94MIMJaZ6c/photo.jpg?sz=128", "display_name": "Sidharth Gokul", "link": "https://stackoverflow.com/users/8923975/sidharth-gokul"}, "edited": false, "score": 0, "creation_date": 1558509721, "post_id": 56251095, "comment_id": 99120088, "body": "It is a combination of C and another inbuilt software"}, {"owner": {"reputation": 175, "user_id": 9431030, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DiO1cugRDI4/AAAAAAAAAAI/AAAAAAAAALc/TUnnCgQJvBI/photo.jpg?sz=128", "display_name": "Yoni Newman", "link": "https://stackoverflow.com/users/9431030/yoni-newman"}, "edited": false, "score": 1, "creation_date": 1558509901, "post_id": 56251095, "comment_id": 99120193, "body": "Insert a counter and when you apply the algorithm just increase it and check if it reaches to 5. if it does, do whatever you want to do like reset it and change the values"}], "answers": [{"tags": [], "owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "is_accepted": true, "score": 1, "last_activity_date": 1558518726, "creation_date": 1558518726, "answer_id": 56254055, "question_id": 56251095, "link": "https://stackoverflow.com/questions/56251095/c-program-to-detect-the-time-change-and-reset-the-counter/56254055#56254055", "title": "C program to detect the time change and reset the counter", "body": "<p>The best way is to use a static local variable, like this:</p>\n\n<pre><code>void foo(void) {\n    static int counter = 0;\n\n    counter++;\n    if(counter &gt; 5) {\n        counter = 0;\n\n        /* Do something every fifth time */\n    }\n}\n</code></pre>\n\n<p>Note that you can't use a normal local variable (e.g. <code>int counter = 0;</code>) because its contents will be lost when the function returns. The <code>static</code> makes it work more like a global variable (so its value isn't lost when the function returns).</p>\n"}], "owner": {"reputation": 101, "user_id": 8923975, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-1Q3jXBcQi-c/AAAAAAAAAAI/AAAAAAAADDc/g94MIMJaZ6c/photo.jpg?sz=128", "display_name": "Sidharth Gokul", "link": "https://stackoverflow.com/users/8923975/sidharth-gokul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "closed_date": 1558534975, "accepted_answer_id": 56254055, "answer_count": 1, "score": -2, "last_activity_date": 1558518726, "creation_date": 1558508728, "last_edit_date": 1558510472, "question_id": 56251095, "link": "https://stackoverflow.com/questions/56251095/c-program-to-detect-the-time-change-and-reset-the-counter", "closed_reason": "Needs details or clarity", "title": "C program to detect the time change and reset the counter", "body": "<p>I have an inbuilt algorithm in my application. Whenever I run the algorithm, it saves that exact run time in the database. For example, if I run the algorithm at 11.00, it saves that time. And again if I run at 11.05, it saves 11.05 in the database. </p>\n\n<p>I want to detect the number of times it Ran. So that once it runs for 5 times, I need to do some action like changing the values and reset the counter to 0.  So that when it reaches 5 iterations, again I should reset the counter.</p>\n\n<p>I am a beginner. It will be helpful if you could help me with the syntax.</p>\n\n<pre><code>MAIN\n{\n\n\n int temp1, temp2, flag = 0, max = 5;\n\n temp1 = GET_INT_VALUE(8,1,84,1,0);\n\n\n if flag = 0;\n while(1)\n {\n     if (templ == temp2)\n         flag++;\n     else\n         flag = 0;\n\n     if (flag == max)\n     {\n        //sprintf(Message,\"SE value is %d\",temp2);             \n        PRINTOUT(\"Message\");\n        flag = 0;\n        break;\n     }\n\n }\n}\nEND\n</code></pre>\n"}, {"tags": ["c", "linker-errors", "undefined-reference"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8465606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33672ceaee8a7edbbc86dafbc59a30d?s=128&d=identicon&r=PG&f=1", "display_name": "Nithin Deepkumar", "link": "https://stackoverflow.com/users/8465606/nithin-deepkumar"}, "edited": false, "score": 0, "creation_date": 1558508545, "post_id": 56250852, "comment_id": 99119501, "body": "I&#39;m following the instructions on this site : <a href=\"https://blog.cloudflare.com/head-start-with-quic/\" rel=\"nofollow noreferrer\">blog.cloudflare.com/head-start-with-quic</a>. The command that gives the error is: make check."}], "tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 0, "last_activity_date": 1558507731, "creation_date": 1558507731, "answer_id": 56250852, "question_id": 56250698, "link": "https://stackoverflow.com/questions/56250698/undefined-reference-to-ev-timer-stop/56250852#56250852", "title": "Undefined reference to ev_timer_stop", "body": "<p>The linker does not know where to find <code>ev_timer_stop</code>.</p>\n\n<p>You might like specifying by providing <code>-lev</code> to the compiler. Do this on the command line after (to the right) having specified the source/object files using stuff from <code>libev</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 8465606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33672ceaee8a7edbbc86dafbc59a30d?s=128&d=identicon&r=PG&f=1", "display_name": "Nithin Deepkumar", "link": "https://stackoverflow.com/users/8465606/nithin-deepkumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "closed_date": 1558509391, "answer_count": 1, "score": 0, "last_activity_date": 1558507731, "creation_date": 1558507095, "last_edit_date": 1558507691, "question_id": 56250698, "link": "https://stackoverflow.com/questions/56250698/undefined-reference-to-ev-timer-stop", "closed_reason": "Duplicate", "title": "Undefined reference to ev_timer_stop", "body": "<p>I'm getting an error undefined reference to <code>ev_timer_stop</code> when I try to run some code. I'm working on kubuntu.</p>\n\n<p>I've  already installed libev-dev.</p>\n\n<p>Here's the error:</p>\n\n<pre><code>client.cc:434: undefined reference to `ev_timer_stop'\n/home/nithin/ngtcp2/examples/client.cc:435: undefined reference to `ev_timer_stop'\n/home/nithin/ngtcp2/examples/client.cc:437: undefined reference to `ev_io_stop'\n/home/nithin/ngtcp2/examples/client.cc:438: undefined reference to `ev_io_stop'\n/home/nithin/ngtcp2/examples/client.cc:440: undefined reference to `ev_signal_stop'\n</code></pre>\n"}, {"tags": ["c", "interpolation", "numerical-methods"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1558505462, "post_id": 56250261, "comment_id": 99118095, "body": "First thing to do: indent your code (like the samples in your C text book)."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1558505667, "post_id": 56250261, "comment_id": 99118183, "body": "Then show your attempt. There is no attempt other than drawing a plain sinusoide."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1558505718, "post_id": 56250261, "comment_id": 99118214, "body": "If you are using <code>std::sin</code>, note that it requires an angle in radians, try <code>i*pi&#47;180.0</code>."}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1558517645, "post_id": 56250261, "comment_id": 99124505, "body": "Do you plan to rely on a library or do you need to implement from scratch ?"}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1558517731, "post_id": 56250261, "comment_id": 99124552, "body": "Your next task is to implement the drawing of a cubic Bezier curve, given four control points. This will be used in both Hermite and Spline interpolations."}], "owner": {"reputation": 53, "user_id": 6926649, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qnaRPo5LM9I/AAAAAAAAAAI/AAAAAAAAHCY/3BEsVx0HJjg/photo.jpg?sz=128", "display_name": "Umair Assad", "link": "https://stackoverflow.com/users/6926649/umair-assad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558505023, "creation_date": 1558505023, "question_id": 56250261, "link": "https://stackoverflow.com/questions/56250261/how-to-use-cubic-hermite-and-cubic-spline-to-interpolate-sinex-with-4-5-non-un", "title": "How to use Cubic Hermite and Cubic Spline to interpolate Sine(x) with 4-5 non uniform samples?", "body": "<p>Task is to draw a curve of Sin(x) and then use Cubic Hermite and Cubic Spline to interpolate the sine wave with 4-5 non-uniform samples.</p>\n\n<p>I've written a code to draw a sine wave but now I'm stuck how to implement the cubic (Hermite and Spline interpolation).</p>\n\n<pre><code>#include &lt;conio.h&gt;\n#include &lt;graphics.h&gt;\n#include &lt;math.h&gt;\n\nint main(){\n\ninitwindow(800,600);\nint x,y;\nline(0,300,getmaxx(),300);\nline(400,0,400,getmaxy());\nfloat pi = 3.14;\n\nfor(int i = -360; i &lt; 360 ; i++){\n\nx = (int) 400+i;\ny = (int) 300 - sin(i*pi/100)*25;\nputpixel(x,y,WHITE);\n\n}\n\ngetch();\nclosegraph();\n\nreturn 0;\n\n}\n</code></pre>\n\n<blockquote>\n  <p>Expected result is to calculate Cubic Hermite and Cubic Spline interpolation on the sine(x) wave.</p>\n</blockquote>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1558503261, "post_id": 56249857, "comment_id": 99117305, "body": "<code>while(fileContent[i] != EOF)</code> = recipe for disaster. not only did you never write an EOF to that sequence, it would be broken logic if you did. The allocation should be one char larger than the file, and the string should be <i>terminated</i> with a nullchar.  You make the same under-allocation mistake in several places btw. If you&#39;re using string lib function, the almost all expect terminated strings, so make sure that&#39;s what you give them."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1558505863, "post_id": 56249857, "comment_id": 99118260, "body": "Browse this site, lately there have been many similar questions dealing with finding capital letters."}], "answers": [{"comments": [{"owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "edited": false, "score": 0, "creation_date": 1558515047, "post_id": 56250789, "comment_id": 99122977, "body": "Do not use identifiers starting with an underscore, like _uppercase. They are almost always reserved for the implementation. In application code they most often cause undefined behavior."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1558525613, "post_id": 56250789, "comment_id": 99128838, "body": "<code>ftell()</code> in a file opened in text mode is not a portable way to get the length of a file.  Per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.21.9.4p2\" rel=\"nofollow noreferrer\"><b>7.21.9.4 The ftell function</b>, &#167;2</a>: &quot;For a text stream, ... the difference between two such return values is not necessarily a meaningful measure of the number of characters written or read.&quot;  And <code>A</code>-<code>Z</code> are not guaranteed to be consecutive, so <code>if(token[0] &gt;= &#39;A&#39; &amp;&amp; token[0] &lt;= &#39;Z&#39;)</code> is also non-portable and should be replaced with <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.4.1.11\" rel=\"nofollow noreferrer\">the <code>isupper()</code> function</a>."}, {"owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 0, "creation_date": 1558526808, "post_id": 56250789, "comment_id": 99129494, "body": "Fixed. I also noticed a small issue where it was adding the initial word to the list even if it wasn&#39;t uppercase. That&#39;s also been fixed. And I understand with ftell if the file contains binary data as well as text data and I&#39;m only reading text data then yes it is correct that ftell would not be an accurate measure of characters."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1558708476, "post_id": 56250789, "comment_id": 99202012, "body": "@Nina you shouldn&#39;t post pictures of text instead of text in an answer."}], "tags": [], "owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "is_accepted": true, "score": 1, "last_activity_date": 1559055389, "last_edit_date": 1559055389, "creation_date": 1558507456, "answer_id": 56250789, "question_id": 56249857, "link": "https://stackoverflow.com/questions/56249857/how-to-find-words-with-capital-letters-in-a-char-using-c/56250789#56250789", "title": "How to find words with capital letters in a char using c?", "body": "<p>You can simplify the process dramatically but utilising functions and learning to manage your memory. I wrote a short example which does not take punctuation into account. It just assumes every word is separated by a space, which you can customise to your discretion. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\nchar* readfile(char* filename){\n    char* data = NULL;\n\n    FILE* file = fopen(filename, \"r\");\n\n    if(file == NULL){\n        return NULL;\n    }\n\n    fseek(file, 0, SEEK_END);\n\n    long size = ftell(file)+1;\n\n    fseek(file, 0, SEEK_SET);\n\n    data = (char*)malloc(size);\n\n    if(data == NULL){\n        return NULL;\n    }\n\n    fgets(data, (int)size, file);\n\n    return data;\n}\ntypedef struct uppercase_t{\n    char** word;\n    int count;\n}uppercase;\n\nvoid copy(uppercase* u,char* token){\n\n    size_t length = strlen(token);\n\n    u-&gt;word[u-&gt;count] = (char*)malloc(length+1);\n\n    if(u-&gt;word[u-&gt;count] == NULL){\n        return;\n    }\n\n    strcpy(u-&gt;word[u-&gt;count], token);\n\n    ++u-&gt;count;\n}\n\nvoid createuppercasedata(uppercase* u, char* data){\n    const char delimeter[] = \" \";\n\n    char* token = strtok(data, delimeter);\n\n    if(token == NULL){\n        return;\n    }\n\n    u-&gt;word = (char**)malloc(u-&gt;count+1);\n\n    if(u-&gt;word == NULL){\n        return;\n    }\n    if(isupper(token[0])){\n        copy(u,token);\n    }\n\n\n    while(token != NULL){\n\n        token = strtok(0, delimeter);\n\n        if(token != NULL)\n\n            if(isupper(token[0])) {\n                char** reallocated = (char**)realloc(u-&gt;word, u-&gt;count+1);\n\n                if(reallocated == NULL){\n                    return;\n                }\n\n                u-&gt;word = reallocated;\n\n                copy(u, token);\n            }\n    }\n}\nvoid destroyuppercasedata(uppercase* u){\n\n    for(int index = 0; index &lt; u-&gt;count; ++index){\n\n        free(u-&gt;word[index]);\n\n    }\n\n    free(u-&gt;word);\n}\nint main(){\n\n    char filename[] = \"textfile\";\n\n    char* data = readfile(filename);\n\n    if(data == NULL){\n        return -1;\n    }\n\n    uppercase u = {0};\n\n    createuppercasedata(&amp;u, data);\n\n    printf(\"found %i uppercase words\\n\",u.count);\n\n    for(int index = 0; index &lt; u.count; ++index){\n        printf(\"%s\\n\", u.word[index]);\n    }\n\n    destroyuppercasedata(&amp;u);\n\n    free(data);\n}\n\n</code></pre>\n\n<p>The code will allocate a new pointer for each uppercase and memory for the word to be copied too. It will free all the memory it allocated in the structure with <code>destroyuppercasedata</code> and it will free the initial data that was read from file. Error checking and memory management in C is really important. So utilise those properly.</p>\n\n<p>This was the test file I used.\ntextfile</p>\n\n<pre><code>How many Uppercase words can Be Found In this text File the answer should be Seven\n</code></pre>\n\n<p>And this was the output to the terminal:\nHow\nUppercase\nBe\nFound\nIn\nFile\nSeven</p>\n"}], "owner": {"reputation": 27, "user_id": 6532992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68125c0119c856c7881f3a8f430816d1?s=128&d=identicon&r=PG&f=1", "display_name": "nutellasandwich", "link": "https://stackoverflow.com/users/6532992/nutellasandwich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 56250789, "answer_count": 1, "score": 0, "last_activity_date": 1559055389, "creation_date": 1558502881, "last_edit_date": 1558508429, "question_id": 56249857, "link": "https://stackoverflow.com/questions/56249857/how-to-find-words-with-capital-letters-in-a-char-using-c", "title": "How to find words with capital letters in a char using c?", "body": "<p>I'm trying to find all the words with capital letters in a string, but am unable to process my data structure. i seem to be able to print out fileContent, indicating that it is loading in successfully, but my second function is not working on the file.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar* loadFile(char* fileName)\n{\n    FILE *inputFile;\n\n    inputFile = fopen(fileName, \"r\");\n\n    //finds the end of the file\n    fseek(inputFile, 0, SEEK_END);\n\n    //stores the size of the file\n    int size = ftell(inputFile);\n\n    //Sets the scan to the start of the file\n    fseek(inputFile, 0, SEEK_SET);\n\n    char *documentStore = (char*)malloc(size);\n\n    int i = 0, c;\n    while((c = fgetc(inputFile)) != EOF)\n    {\n        documentStore[i] = c;\n        i++;\n    }\n\n    return documentStore;\n}\n\nvoid countImportantWords(char* fileContent, char** importantWords, int* frequencyWords)\n{\n    int uniqueWordCount = 0;\n    int lengthWordStore = 10;\n    int i = 0;\n    int recording = 0;\n    char wordBuffer[50];\n    int wordBufferCount = 0;\n    int isWordPresent = 0;\n\n    while(fileContent[i] != EOF)\n    {\n        //To allocate more memory incase the structure is full\n        if(uniqueWordCount == lengthWordStore)\n        {\n            lengthWordStore += 10;\n            char** newWordStore = realloc(importantWords, lengthWordStore * sizeof(char*));\n            int* newFrequencyStore = realloc(frequencyWords, sizeof(int));\n            importantWords = newWordStore;\n            frequencyWords = newFrequencyStore;\n        }\n\n        printf(\"%s\", wordBuffer);\n        //Conditions to fill if its a word\n        if(fileContent[i] &gt;= 'A' &amp;&amp; fileContent[i] &lt;= 'Z' &amp;&amp; recording == 0)\n        {\n            wordBuffer[0] = fileContent[i];\n            recording = 1;\n        }else if(fileContent[i] &gt;= 'a' &amp;&amp; fileContent[i]  &lt;= 'z' &amp;&amp; recording == 1)\n        {\n            //each if is to check if the end of word is reached. Any character that is non alphabetical is considered end of word\n            wordBufferCount += 1;\n            wordBuffer[wordBufferCount] = fileContent[i];\n        } else if (fileContent[i] &gt;= 'A' &amp;&amp; fileContent[i] &lt;= 'Z' &amp;&amp; recording == 1)\n        {\n            wordBufferCount += 1;\n            wordBuffer[wordBufferCount] = fileContent[i];\n        } else {\n\n            //Adding a terminating character so that it strcpy only copies until that point\n            wordBuffer[wordBufferCount + 1] = '\\0';\n            recording = 0;\n\n            //check to see if that word is in the array already, and if it is, it will just increment the frequency\n            for(int j = 0; j &lt; uniqueWordCount; j++){\n                if(strcmp(wordBuffer, importantWords[j]) == 0)\n                {\n                    frequencyWords[j] += 1;\n                    isWordPresent = 1;\n                }\n            }\n\n            //if its not present, it should assign it to the structure\n            if(isWordPresent == 0)\n            {\n                char* wordStore = (char*)malloc(wordBufferCount * sizeof(char));\n                strcpy(wordStore, wordBuffer);\n                uniqueWordCount += 1;\n                importantWords[uniqueWordCount] = wordStore;\n                frequencyWords[uniqueWordCount] = 1;\n\n            }\n        }\n        i++;\n    }\n}\n\n\n\nint main() {\n    char fileName[50];\n    char *fileContent;\n    char **importantWords = (char**)malloc(10*sizeof(char**));\n    int *frequencyWords = (int*)malloc(10*sizeof(int));\n\n    printf(\"Please input the full file path: \");\n    scanf(\"%s\", fileName);\n\n    fileContent = loadFile(fileName);\n\n    countImportantWords(fileContent, importantWords, frequencyWords);\n\n    int i = 0;\n    while(importantWords[i] != '\\0')\n    {\n        printf(\"%s %d\", importantWords[i], frequencyWords[i]);\n        i++;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>I've put in the full file so you can see how the structure was created incase that it is the issue, but ideally what would happen is that the final loop would print out all the words that are important and they're frequency. Currently i'm getting exit code 11, which i'm not sure what it means, but may be worth mentioning. I'd really appreciate any help :)</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1558502793, "post_id": 56249770, "comment_id": 99117139, "body": "<i>&quot;Is not <code>a</code> a <code>int**</code> type?&quot;</i> In no case whatsoever is there an <code>int **</code> in <i>any</i> of this. Wherever you read/inferred/were-told that, they&#39;re wrong."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 1, "creation_date": 1558505140, "post_id": 56249770, "comment_id": 99117980, "body": "Note you should technically cast the arguments corresponding to a <code>%p</code> formatter to <code>void*</code>. On most architectures, passing any pointer type will have the same effects, but this is not guaranteed."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1558506070, "post_id": 56249770, "comment_id": 99118358, "body": "Doing <code>**a</code> may invoke undefined behaviour as it evaluates to <code>a[0][0]</code> which has not been initialised/set before."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1558507460, "post_id": 56249770, "comment_id": 99118981, "body": "@alk Pedantically, <code>a</code> has its address taken and cannot be declared with <code>register</code> qualifier. On mainstream systems without exotic trap representations, this means that the variable takes an unspecified value, but it is not UB. <a href=\"https://stackoverflow.com/a/40674888/584518\">stackoverflow.com/a/40674888/584518</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11537266, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c5UmTR7Ryi4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reWHXBY0Q_Dyj9BN8I4a7xr_GeJ7A/mo/photo.jpg?sz=128", "display_name": "DongRyeong", "link": "https://stackoverflow.com/users/11537266/dongryeong"}, "edited": false, "score": 0, "creation_date": 1558504231, "post_id": 56249848, "comment_id": 99117650, "body": "I inferred <code>a</code> as a pointer type since <code>[]</code> , <code>*</code> operator works same for <code>int**</code> and <code>int arr[][]</code> in most case. Thanks for resolving my misunderstanding."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 21, "user_id": 11537266, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c5UmTR7Ryi4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reWHXBY0Q_Dyj9BN8I4a7xr_GeJ7A/mo/photo.jpg?sz=128", "display_name": "DongRyeong", "link": "https://stackoverflow.com/users/11537266/dongryeong"}, "edited": false, "score": 0, "creation_date": 1558504348, "post_id": 56249848, "comment_id": 99117685, "body": "@DongRyeong I&#39;ve added some elaboration, hope that helps."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 7, "last_activity_date": 1558504328, "last_edit_date": 1558504328, "creation_date": 1558502863, "answer_id": 56249848, "question_id": 56249770, "link": "https://stackoverflow.com/questions/56249770/2d-array-why-ptr-and-ptr-are-same-when-i-declared-ptr-as-int-ptr44/56249848#56249848", "title": "2d array: Why ptr and *ptr are same when i declared ptr as int ptr[4][4];?", "body": "<p>Check the types!!</p>\n\n<p>Given the definition as <code>int a[4][4];</code></p>\n\n<ul>\n<li><code>a</code> is of type <code>int [4][4]</code> - array of an array of 4 integers. It's <strong>not</strong> the same as <code>int **</code>.</li>\n<li><code>a[n]</code> is of type <code>int [4]</code> - array of 4 integers. It's <strong>not</strong> the same as <code>int *</code></li>\n<li><code>a[n][m]</code> is of type <code>int</code>. - integer.</li>\n</ul>\n\n<p>Now, given the fact, that the address of the array is also the address of the first element in the array, the values are same, but they differ in types.</p>\n\n<p>To check it visually</p>\n\n<pre><code>int a[4][4]\n\n      +-------+--------+-------+-----------+\n      |       |        |       |           |\n      |a[0][0]| a[0][1]| a[0][2]   a[0][3] |\n      |       |        |       |           |\n      +------------------------------------+\n      |       |        |       |           |\n      |a[1][0]|        |       |           |\n      |       |        |       |           |\n      +------------------------------------+\n      |       |        |       |           |\n      |a[2][0]|        |       |           |\n      |       |        |       |           |\n      +------------------------------------+\n      |       |        |       |           |\n      |       |        |       |           |\n      |       |        |       |           |\n      |       |        |       |           |\n      +-------+--------+-------+-----------+\n</code></pre>\n\n<p>Then, quoting the <code>C11</code>, \u00a76.3.2.1</p>\n\n<blockquote>\n  <p><em>Except when it is the operand of the <code>sizeof</code> operator, the <code>_Alignof</code> operator, or the\n  unary <code>&amp;</code> operator, or is a string literal used to initialize an array, an expression that has\n  type \u2018\u2018array of type\u2019\u2019 is converted to an expression with type \u2018\u2018pointer to type\u2019\u2019 that points\n  to the initial element of the array object and is not an lvalue. [...]</em></p>\n</blockquote>\n\n<p>So, while passing an argument of type array as a function argument, it decays to the pointer to the first element of the array.</p>\n\n<p>So, let's have a look.</p>\n\n<ul>\n<li><code>a</code>, decays to <code>&amp;(a[0])</code> - the address of the first element of type <code>int (*)[4]</code>.</li>\n<li><code>*a</code>, which is the same as <code>a[0]</code>, decays to an <code>int *</code>, pointer to the first element.</li>\n<li><code>**a</code> which is same as <code>*(*a)</code> == <code>*(a[0])</code> == <code>a[0][0]</code> - that's the <code>int</code> value at that index.</li>\n</ul>\n\n<p>Now once again look carefully at the image above - do you see that the first element of <code>int [0]</code> and <code>int [0][0]</code> are basically residing at the same <strong><em>address</em></strong>? In other words, the starting address are the same.</p>\n\n<p>That's the reason behind the output you see.</p>\n"}], "owner": {"reputation": 21, "user_id": 11537266, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c5UmTR7Ryi4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reWHXBY0Q_Dyj9BN8I4a7xr_GeJ7A/mo/photo.jpg?sz=128", "display_name": "DongRyeong", "link": "https://stackoverflow.com/users/11537266/dongryeong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "closed_date": 1558507408, "accepted_answer_id": 56249848, "answer_count": 1, "score": 1, "last_activity_date": 1558504375, "creation_date": 1558502467, "last_edit_date": 1558504375, "question_id": 56249770, "link": "https://stackoverflow.com/questions/56249770/2d-array-why-ptr-and-ptr-are-same-when-i-declared-ptr-as-int-ptr44", "closed_reason": "Duplicate", "title": "2d array: Why ptr and *ptr are same when i declared ptr as int ptr[4][4];?", "body": "<p>I was testing some codes to find out how 2d array is implemented in c.\nThen I met following problem.</p>\n\n<p>The code is:</p>\n\n<pre><code>int main(){\n   int a[4][4];\n   printf(\"a: %p, *a: %p, **a: 0x%x\\n\",a,*a,**a);\n}\n</code></pre>\n\n<p>I compiled this with 32-bit ubuntu gcc</p>\n\n<p>The result was:</p>\n\n<blockquote>\n  <p>a: 0xbf9d6fdc, *a: 0xbf9d6fdc, **a: 0x0</p>\n</blockquote>\n\n<p>I expected different value for <code>a</code> and <code>*a</code>, but they are same.</p>\n\n<ol>\n<li><p>why <code>a</code> and <code>*a</code> are same in this case?\nIs not <code>a</code> a <code>int**</code> type?</p></li>\n<li><p>Then what is role of <code>*</code>operator in <code>*a</code>?</p></li>\n</ol>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1558502211, "post_id": 56249689, "comment_id": 99116962, "body": "Not sure whether I got this right. To print local maxima, you have to compare a value with its predecessor and successor. If it&#39;s greater than both, you found a local maximum (and could print it immediately i.e. inside the loop)."}, {"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 0, "creation_date": 1558502218, "post_id": 56249689, "comment_id": 99116967, "body": "function getXL() uses C instead of L, I assume ;)"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1558502441, "post_id": 56249689, "comment_id": 99117029, "body": "You want to print a list of all <code>freq</code> (not only the last one) at which the global (not local) maximum occurs? Can you somehow define a maximum number of occurences?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1558504244, "post_id": 56249689, "comment_id": 99117654, "body": "By the way, I assume that this might be a homework assignment to calculate resonance frequency. If that is the case then try using math instead of trying via simulaiton. I.e. do not loop over imaginable frequencies, use the given values to calculate. Feel free to comment on my speculations."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1558504446, "post_id": 56249689, "comment_id": 99117714, "body": "If there is a circuit with resistor, capacity and inductivity involved, consider showing some ascii-art of that circuit. Some people here might know about electrical enginerring and help you with matching the code to the circuit."}], "answers": [{"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1558502798, "post_id": 56249774, "comment_id": 99117140, "body": "What is calculated for each frequency is VO, VOmax is the maximum of that over all frequencies. Resetting it each time is the part of your (otherwise good answer) which I don&#39;t get. It seems to defeat the whole purpose..."}, {"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1558503002, "post_id": 56249774, "comment_id": 99117206, "body": "As I understand (the desired behavior is not excellently described) the OP wants more than one voMax. He can do it in 2 ways: save all voMax somewhere (array, file), or reset voMax for each iteration. In the end he will have to decide what to do with all the values."}, {"owner": {"reputation": 39, "user_id": 11003835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NjxUzU4BOxY/AAAAAAAAAAI/AAAAAAAAABQ/3DvBTGCm_r8/photo.jpg?sz=128", "display_name": "babySteps", "link": "https://stackoverflow.com/users/11003835/babysteps"}, "edited": false, "score": 0, "creation_date": 1558503043, "post_id": 56249774, "comment_id": 99117227, "body": "i feel like an array would be more suitable but its for a school assignment so maybe im just trying to do too much,  im just trying to explore avenues. and ya thank you! were right about the XL function, i changed mine!"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1558503127, "post_id": 56249774, "comment_id": 99117252, "body": "If you find anything unclear about OP, then please use your commenting privilege to clarify. I think this answer is based on a risky assumption."}, {"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 0, "creation_date": 1558503208, "post_id": 56249774, "comment_id": 99117282, "body": "To avoid the risky assumptions, I provided alternatives. OP can choose the suitable one according to his very specific needs."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1558503257, "post_id": 56249774, "comment_id": 99117301, "body": "babySteps If you think doing it by using an array instead of the method here would be better, then I think you did not get the point of this answer."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1558503395, "post_id": 56249774, "comment_id": 99117353, "body": "virolino I could upvote the data-collection via large array (then optimise) idea - though the optimisation would need to be non-trivial. However, the second part (which I consider being a separate and much less helpful answer) prevents me."}, {"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1558503501, "post_id": 56249774, "comment_id": 99117390, "body": "@Yunnosch: to use your own attitude: please use your privileges to provide a better answer. I will not mind if you have a better solution."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1558503536, "post_id": 56249774, "comment_id": 99117406, "body": "I did elaborate as much as I could already in comments here. I did ask for information on the question, which was not answered (hint babySteps) and hence cannot answer. Virolino consider splitting this and making a second answer. BabySteps accepting an answer is supposed to express that it helped you. I get the feeling that this is not applicable - yet. (Sorry virolino.)"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1558503620, "post_id": 56249774, "comment_id": 99117435, "body": "Privileges are not needed for answering. Asking for clarity beforehand needs a minor privilege, which you (virolino) have already."}, {"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 0, "creation_date": 1558503703, "post_id": 56249774, "comment_id": 99117466, "body": "I fail to understand why it is bad to rest voMax for calculating maximums for each frequency, instead of calculating one max for all frequencies - considering that OP wants more than 1 max."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1558503983, "post_id": 56249774, "comment_id": 99117563, "body": "I assume that the background is to determine via simulation the resonance frequency of a capacitor-inductivity circuit. This is what the shown code more or less does. There is no maximum voltage for each frequency, there is nothing more complex you can do for each frequency (there is e.g. no sensible inner loop to do on each). There is only the possibility, in OPs mind, that the maximumm could occur more than once, which is true if OP gets unlucky with the choice of sample frequencies. The only need is to list all (of the few) frequencies which in this simulation have the max voltage."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1558504044, "post_id": 56249774, "comment_id": 99117589, "body": "And the fact that I started with &quot;I assume...&quot; means I need clarification, more info, more explanation, confirmation of my assumption, ... before I can answer. My doubt that resetting at each frequency makes sense for what I assume meanwhile keeps me from upvoting the answer."}, {"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 0, "creation_date": 1558505921, "post_id": 56249774, "comment_id": 99118287, "body": "1. I do not have to ask for clarifications in your name 2. If you have doubts, ask specific questions or clarify them by yourself. 3. You have the freedom to test the code, and verify if it works or not. It is that simple."}], "tags": [], "owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "is_accepted": true, "score": 2, "last_activity_date": 1558503755, "last_edit_date": 1558503755, "creation_date": 1558502496, "answer_id": 56249774, "question_id": 56249689, "link": "https://stackoverflow.com/questions/56249689/how-to-print-multiple-max-values-using-loop/56249774#56249774", "title": "how to print multiple max values using loop", "body": "<p>Well, what you want is to generate \"a lot\" of data, and then make some analysis. I would actually implement it in two steps:</p>\n\n<ol>\n<li>Generate the data (and save it in an array or in a file)</li>\n<li>Do any analysis you need on that data.</li>\n</ol>\n\n<p>After you get the desired result with this clear approach, you can move to the next step and try to optimize the algorithm, according to any optimization rule you need.</p>\n\n<hr>\n\n<blockquote>\n  <p>I want the voltage to print max at multiple freq.</p>\n</blockquote>\n\n<p>I think you need a small code update. You have the following sequence:</p>\n\n<pre><code>voMax = 0;\nfMax = 0;\nresist = getResist();\nfor (freq = 1000000; freq &gt;= 0; freq -= 10)\n{\n</code></pre>\n\n<p>you should probably have:</p>\n\n<pre><code>fMax = 0;\nresist = getResist();\nfor (freq = 1000000; freq &gt;= 0; freq -= 10)\n{\n    voMax = 0;\n</code></pre>\n\n<p>(I moved \"voMax = 0;\" inside the \"for\").</p>\n\n<p>In that way, you can calculate max voltages for all frequencies, without interference from the other frequencies.</p>\n"}], "owner": {"reputation": 39, "user_id": 11003835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NjxUzU4BOxY/AAAAAAAAAAI/AAAAAAAAABQ/3DvBTGCm_r8/photo.jpg?sz=128", "display_name": "babySteps", "link": "https://stackoverflow.com/users/11003835/babysteps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 56249774, "answer_count": 1, "score": 1, "last_activity_date": 1558503755, "creation_date": 1558501946, "last_edit_date": 1558502188, "question_id": 56249689, "link": "https://stackoverflow.com/questions/56249689/how-to-print-multiple-max-values-using-loop", "title": "how to print multiple max values using loop", "body": "<p>Trying to calculate at which frequencies voltage hits max, i am able to print the most recent max but there may be lower values of frequency in which it is able to max voltage.</p>\n\n<p>I am able to get the highest or lowest freq by switching the loop from + to - from or to 1000000 in increments of 10.</p>\n\n<p>Tried nested if statement inside of <code>VO &gt; voMax</code></p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;math.h&gt;\n#define PI 3.14f\n#define Vi 5\n\n#define L 4.3e-4\n#define C 5.1e-6\n\nint getFreq();\nlong getResist();\nfloat getVO(float XL, float XC, int R);\nfloat getXC(int f);\nfloat getXL(int f);\n\nint main()\n{\n    long resist, freq, fMax;\n    float XL, XC, VO, voMax;\n\n    voMax = 0;\n    fMax = 0;\n    resist = getResist();\n    for (freq = 1000000; freq &gt;= 0; freq -= 10)\n    {\n        XL = getXL(freq);\n\n        XC = getXC(freq);\n\n        VO = getVO(XL, XC, resist);\n        if (1000000 == freq)\n        {\n            fMax = freq;\n            voMax = VO;\n\n        }\n        else if (VO &gt; voMax)\n        {\n            fMax = freq;\n            voMax = VO;\n\n        }       \n    }\n    printf(\"VO = %f Frequency = %d\\n\", voMax, fMax);\n    getch();\n    return 0;\n}\n\nfloat getXL(long f)\n{\n    float XL;\n\n    XL = 2 * PI * f * C;\n    return XL;\n}\n\nfloat getXC(long f)\n{\n    float XC;\n\n    XC = 1 / (2 * PI * f * C);\n    return XC;\n\n}\n\nfloat getVO(float XL, float XC, long R)\n{\n    float VO;\n\n    VO = (Vi * R) / sqrt((XL - XC) * (XL - XC) + R * R);\n    return VO;\n}\n\nint getFreq()\n{\n    int freq;\n    freq = 0;\n    printf(\"please enter a frequency:\");\n    scanf(\"%d\", &amp;freq);\n    return freq;\n}\nlong getResist()\n{\n    int resist;\n    resist = 0;\n    printf(\"please enter a resistance:\");\n    scanf(\"%d\", &amp;resist);\n    return resist;\n}\n</code></pre>\n\n<p>I want the voltage to print max at multiple freq.</p>\n"}, {"tags": ["c", "unix", "pipe", "file-descriptor"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1558501655, "post_id": 56249606, "comment_id": 99116804, "body": "You have two readers on the same pipe trying to consume the same data. That won&#39;t work. Either have the <code>wc</code> process read from <code>link[0]</code> or have the parent read from <code>lnk[0]</code>, but having both try won&#39;t work."}, {"owner": {"reputation": 29, "user_id": 6116270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba63dfe30855ba99749139814b829fe?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Spider", "link": "https://stackoverflow.com/users/6116270/curious-spider"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1558513769, "post_id": 56249606, "comment_id": 99122238, "body": "I don&#39;t think I&#39;m using the same pipe - at least from my understanding. I visualize it as <code>ls --&gt; pipe1 --&gt; wc --&gt; pipe2</code>.  All I&#39;m doing is reading from pipe1 and pipe2.  Would you suggest that I do it in different processes - not sure why that would affect things?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1558533697, "post_id": 56249606, "comment_id": 99133858, "body": "You are reading the same end of the same pipe in two different processes. The <code>wc</code> process reads from <code>link[0]</code> since that its standard input. The parent process reads from <code>link[0]</code> because that&#39;s one of the two lines of code that are your point of interest. Either <code>ls</code> can provide <code>wc</code>&#39;s standard input or the parent process can read from its output, but if you do both, you won&#39;t know who will wind up getting what. (Is it clear to you why you can&#39;t get both?)"}, {"owner": {"reputation": 29, "user_id": 6116270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba63dfe30855ba99749139814b829fe?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Spider", "link": "https://stackoverflow.com/users/6116270/curious-spider"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1558565273, "post_id": 56249606, "comment_id": 99148100, "body": "I sort of understand it now. With the commands <code>dup2(link[0], STDIN_FILENO);</code> and <code>dup2(link2[1], STDOUT_FILENO);</code>. I was making a pipe where the input was <code>ls</code> and the output was <code>wc</code>. Reading from <code>ls</code> however, would block the pipe and so <code>wc</code> would receive nothing and return 0."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6116270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba63dfe30855ba99749139814b829fe?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Spider", "link": "https://stackoverflow.com/users/6116270/curious-spider"}, "edited": false, "score": 0, "creation_date": 1558565074, "post_id": 56258756, "comment_id": 99148053, "body": "Thanks for the suggestions. I ended up going with 3. I wrote the results of <code>ls</code> into a file. Then opened the file again but for reading only <code>fd = open(&quot;test.in&quot;, O_RDONLY);</code>. And then passes it as the input <code>dup2(fd, STDIN_FILENO);</code>."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 0, "last_activity_date": 1558534020, "creation_date": 1558534020, "answer_id": 56258756, "question_id": 56249606, "link": "https://stackoverflow.com/questions/56249606/c-cannot-read-from-2-pipe-file-descriptors-without-losing-the-other-one/56258756#56258756", "title": "C: Cannot read from 2 pipe file descriptors without losing the other one", "body": "<pre><code>    if (pid == 0)\n    {\n        dup2(link[0], STDIN_FILENO); // ** HERE **\n        dup2(link2[1], STDOUT_FILENO);\n        close(link[1]);\n        close(link[0]);\n        close(link2[1]);\n        close(link2[0]);\n        execv(WC_PATH, arg2);\n        perror(\"error2\");\n    }\n</code></pre>\n\n<p>Notice that <code>wc</code> reads from <code>link[0]</code>.</p>\n\n<pre><code>        // the following two lines of code is the point of interest\n        read(link[0], buffer1, sizeof(buffer1));   // ls   ** HERE **\n        read(link2[0], buffer2, sizeof(buffer2));  // wc\n</code></pre>\n\n<p>Notice that the parent process also tries to read from <code>link[0]</code>.</p>\n\n<p>You can't get both because data written to a pipe can only be read from it once. If <code>wc</code> reads <code>ls</code>'s output to count its characters, then you can't also read <code>ls</code>'s output in the parent. If the parent reads <code>ls</code>'s output out of the pipe, then <code>wc</code> can't get it also because it's not in the pipe anymore. That's why you can only get one or the other -- if one thing reads the pipe, then it's not in the pipe for the other to read.</p>\n\n<p>There are a lot of ways you can fix this, depending on your requirements.</p>\n\n<ol>\n<li><p>You can use three pipes with the extra pipe being <code>wc</code>'s standard input. The parent process would have to copy data from pipe that has <code>ls</code>'s output to the pipe that is <code>wc</code>'s input.</p></li>\n<li><p>You can add a third process, an instance of <code>tee</code> that duplicates the data.</p></li>\n<li><p>You can have <code>ls</code> write to a temporary file. Both <code>wc</code> and your parent process can read that file. Files allow the same data to be read more than once, unlike pipes.</p></li>\n</ol>\n"}], "owner": {"reputation": 29, "user_id": 6116270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba63dfe30855ba99749139814b829fe?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Spider", "link": "https://stackoverflow.com/users/6116270/curious-spider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 56258756, "answer_count": 1, "score": 0, "last_activity_date": 1558534020, "creation_date": 1558501387, "question_id": 56249606, "link": "https://stackoverflow.com/questions/56249606/c-cannot-read-from-2-pipe-file-descriptors-without-losing-the-other-one", "title": "C: Cannot read from 2 pipe file descriptors without losing the other one", "body": "<p>I have C code that is simulating the bash command <code>ls | wc</code>. One of the things I want to achieve is to be able to to read the output of each command so I can print them - both <code>ls</code> and <code>wc</code> when <code>ls</code> is piped. This issue that I'm facing is whenever I read one of the commands is I somehow lose the other. </p>\n\n<p>Observe the following code</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n\n#define LS_PATH \"/bin/ls\"\n#define WC_PATH \"/usr/bin/wc\"\n\nint main()\n{\n    pid_t pid;\n\n    int link[2], link2[2];\n\n    char *const arg1[] = {\"ls\", NULL};\n    char *const arg2[] = {\"wc\", NULL};\n\n    char *buffer1[4096], buffer2[4096];\n\n    pipe(link);\n    pipe(link2);\n\n    pid = fork();\n\n    if (pid == 0)\n    {\n        dup2(link[1], STDOUT_FILENO);\n        close(link[0]);\n        close(link[1]);\n        execv(LS_PATH, arg1);\n        perror(\"error1\");\n    }\n    else\n    {\n\n        pid = fork();\n\n        if (pid == 0)\n        {\n            dup2(link[0], STDIN_FILENO);\n            dup2(link2[1], STDOUT_FILENO);\n            close(link[1]);\n            close(link[0]);\n            close(link2[1]);\n            close(link2[0]);\n            execv(WC_PATH, arg2);\n            perror(\"error2\");\n        }\n        else\n        {\n\n            close(link[1]);\n\n            close(link2[1]);\n\n            // the following two lines of code is the point of interest\n            read(link[0], buffer1, sizeof(buffer1));   // ls\n            read(link2[0], buffer2, sizeof(buffer2));  // wc\n\n            printf(\"%s\\n\", buffer1);\n\n            printf(\"%s\\n\", buffer2);\n        }\n    }\n}\n</code></pre>\n\n<p>Focus mainly on the following code statements:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>read(link[0], buffer1, sizeof(buffer1));   // ls\nread(link2[0], buffer2, sizeof(buffer2));  // wc\n</code></pre>\n\n<p><code>ls</code> is being read first into <code>buffer1</code>, it prints fine, but then <code>buffer2</code> which is reading <code>wc</code> just returns 0. </p>\n\n<p>If I were to switch the ordering of the above code statements such that I would have the following:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>read(link2[0], buffer2, sizeof(buffer2));  // wc\nread(link[0], buffer1, sizeof(buffer1));   // ls\n</code></pre>\n\n<p>Then <code>wc</code> being read into <code>buffer2</code> works fine as if I ran the command <code>ls | wc</code> in the terminal, however, <code>ls</code> in <code>buffer1</code> would not print.</p>\n\n<p>I can't get both, only one or the other.</p>\n\n<p>How do I get both? </p>\n"}, {"tags": ["c", "function", "gcc"], "comments": [{"owner": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "edited": false, "score": 2, "creation_date": 1558504441, "post_id": 56249509, "comment_id": 99117713, "body": "Why do you want to do this? Do you plan something that can&#39;t be done with a debugger?"}], "answers": [{"tags": [], "owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "is_accepted": false, "score": 1, "last_activity_date": 1558509404, "creation_date": 1558509404, "answer_id": 56251272, "question_id": 56249509, "link": "https://stackoverflow.com/questions/56249509/how-to-trace-specific-functions-files-in-c/56251272#56251272", "title": "How to trace specific functions/files in C?", "body": "<p>GCC does not support this out-of-the-box (it's more a task for your build system). One common hack to achieve what you want is to write a shell wrapper which replaces GCC and adds flags where needed:</p>\n\n<pre><code>$ cat path/to/fake/gcc\n#!/bin/sh\nFLAGS=\nif echo \"$*\" | grep -q 'myfile1.c'; then\n  FLAGS=-finstrument-functions\nfi\nexec /usr/bin/gcc \"$@\" $FLAGS\n$ export PATH=\"path/to/fake:$PATH\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 13801323, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/78b1f417b262dbd6cdfad851bdfc59d0?s=128&d=identicon&r=PG", "display_name": "Herby74", "link": "https://stackoverflow.com/users/13801323/herby74"}, "is_accepted": false, "score": 1, "last_activity_date": 1592982514, "last_edit_date": 1592982514, "creation_date": 1592940732, "answer_id": 62542420, "question_id": 56249509, "link": "https://stackoverflow.com/questions/56249509/how-to-trace-specific-functions-files-in-c/62542420#62542420", "title": "How to trace specific functions/files in C?", "body": "<p>If you use cmake to build your project you may benefit from adding COMPILE_OPTIONS at a specific level. Use</p>\n<pre><code>add_compile_options()\n</code></pre>\n<p>for directory-wide settings</p>\n<pre><code>target_compile_options()\n</code></pre>\n<p>for target-specific settings and</p>\n<pre><code>set_source_files_properties()\n</code></pre>\n<p>for file specific settings.</p>\n<p>In your case</p>\n<pre><code>set_source_files_properties( \n myfile1.cc  PROPERTIES COMPILE_FLAGS  -finstrument-functions)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1592983009, "last_edit_date": 1592983009, "creation_date": 1592982693, "answer_id": 62549607, "question_id": 56249509, "link": "https://stackoverflow.com/questions/56249509/how-to-trace-specific-functions-files-in-c/62549607#62549607", "title": "How to trace specific functions/files in C?", "body": "<p>Recent <a href=\"https://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a> compilers can be extended by <a href=\"https://gcc.gnu.org/onlinedocs/gccint/Plugins.html\" rel=\"nofollow noreferrer\">GCC plugins</a>.</p>\n<blockquote>\n<p>But now I have a lot of files to be compiled and only some of them need to be traced.</p>\n</blockquote>\n<p>You should consider writing your own GCC plugin to do that job. See also <a href=\"http://starynkevitch.net/Basile/bismon-chariot-doc.pdf\" rel=\"nofollow noreferrer\">this draft</a> report.</p>\n<p>You may configure your <a href=\"https://en.wikipedia.org/wiki/Build_automation\" rel=\"nofollow noreferrer\">build automation</a> tool (e.g. <a href=\"https://www.gnu.org/software/make/\" rel=\"nofollow noreferrer\">GNU make</a> or <a href=\"https://ninja-build.org/\" rel=\"nofollow noreferrer\">ninja</a>) to help you.</p>\n<p>At last, some of your C code (e.g. <code>#include</code>-ed files) could be generated. Think of meta-programming approaches (e.g. with <a href=\"https://swig.org/\" rel=\"nofollow noreferrer\">SWIG</a> or <a href=\"https://antlr.org/\" rel=\"nofollow noreferrer\">ANTLR</a> or <a href=\"https://www.gnu.org/software/bison/\" rel=\"nofollow noreferrer\">Bison</a> or <a href=\"https://logological.org/gpp\" rel=\"nofollow noreferrer\">GPP</a> or your own C code generator), perhaps using <a href=\"https://en.wikipedia.org/wiki/X_Macro\" rel=\"nofollow noreferrer\">X-macros</a>.</p>\n"}], "owner": {"reputation": 39, "user_id": 6369406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe84f42859fe3d48203d043930b02450?s=128&d=identicon&r=PG&f=1", "display_name": "leohujx", "link": "https://stackoverflow.com/users/6369406/leohujx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1592983009, "creation_date": 1558500575, "last_edit_date": 1558504015, "question_id": 56249509, "link": "https://stackoverflow.com/questions/56249509/how-to-trace-specific-functions-files-in-c", "title": "How to trace specific functions/files in C?", "body": "<p>I have already known that the GCC's argument <code>-finstrument-functions</code> can hook the functions and the argument <code>-finstrument-functions-exclude-file(functions)-list</code> can exclude some files/functions to be traced. </p>\n\n<p>But now I have a lot of files to be compiled and only some of them need to be traced. I wonder if I can include some specific functions/files to be traced, such as something like <code>-finstrument-functions-include-file(functions)-list</code>?</p>\n\n<p>Thanks a lot!</p>\n"}, {"tags": ["c", "arrays", "function", "pointers", "reference"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1558498884, "post_id": 56249230, "comment_id": 99116232, "body": "It&#39;s because the swap function uses an uninitialized pointer. <code>int* inverter</code> should be <code>int inverter</code>."}, {"owner": {"reputation": 3599, "user_id": 2487517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cRCpa.jpg?s=128&g=1", "display_name": "Tibrogargan", "link": "https://stackoverflow.com/users/2487517/tibrogargan"}, "edited": false, "score": 1, "creation_date": 1558499071, "post_id": 56249230, "comment_id": 99116272, "body": "It&#39;s not crashing for the first version because some non-deterministic behavior of the compiler / environment you&#39;re using makes <code>inverter</code> point to valid memory in that version but not the other."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9383634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40bb8c3b02e7893292a58f289a799b69?s=128&d=identicon&r=PG&f=1", "display_name": "Benuck", "link": "https://stackoverflow.com/users/9383634/benuck"}, "edited": false, "score": 0, "creation_date": 1558500442, "post_id": 56249399, "comment_id": 99116538, "body": "Wow! I got it! Thanks!!"}], "tags": [], "owner": {"reputation": 190, "user_id": 4016231, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Aviv Goll", "link": "https://stackoverflow.com/users/4016231/aviv-goll"}, "is_accepted": false, "score": 1, "last_activity_date": 1558499798, "creation_date": 1558499798, "answer_id": 56249399, "question_id": 56249230, "link": "https://stackoverflow.com/questions/56249230/why-changing-this-arrays-value-in-a-function-using-pointers-is-wrong/56249399#56249399", "title": "Why changing this array&#39;s value, in a function using pointers, is wrong?", "body": "<p>In the following lines:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>     int* inverter;\n     *inverter = *a;\n</code></pre>\n\n<p><code>inverter</code> is declared as a pointer to <code>int</code> but there is no initial address to which it points (the content, i.e address, is undefined).</p>\n\n<p>Should be:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>    int inverter;\n    inverter = *a;\n    *a = *b;\n    *b = inverter;\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9383634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40bb8c3b02e7893292a58f289a799b69?s=128&d=identicon&r=PG&f=1", "display_name": "Benuck", "link": "https://stackoverflow.com/users/9383634/benuck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558499798, "creation_date": 1558498554, "question_id": 56249230, "link": "https://stackoverflow.com/questions/56249230/why-changing-this-arrays-value-in-a-function-using-pointers-is-wrong", "title": "Why changing this array&#39;s value, in a function using pointers, is wrong?", "body": "<p>I was solving a revert array homework and, at some point, the code compiled, suddenly, after an (apparently unrelated) alteration, the code couldn't be compiled anymore.</p>\n\n<p><strong><em>This one compiles</em></strong></p>\n\n<pre><code>#include &lt;iostream&gt;\n#define MAX 100\n#define fori(x, y) for(int i = x; i&lt;y; i++)\nusing namespace std;\n\nint vetor[MAX];\n\nvoid inverterElemento(int* a, int* b){\n     int* inverter;\n     *inverter = *a;\n     *a = *b;\n     *b = *inverter;\n}\n\nint main(){\n    for (int i = 0; i &lt; MAX; i++){\n        vetor[i] = 7*i;\n    }\n    for (int k = 0; k &lt;= MAX/2; k++){\n        int a = vetor[k];\n        int b = vetor[MAX-k-1];\n        inverterElemento(&amp;vetor[k], &amp;vetor[MAX - k - 1]);\n    }\n    fori(0, MAX) cout &lt;&lt; vetor[i] &lt;&lt; \" \"; cout &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p><strong>This one gives <code>Bus error:10</code> issue:</strong></p>\n\n<pre><code>#include &lt;iostream&gt;\n#define MAX 100\n#define fori(x, y) for(int i = x; i&lt;y; i++)\nusing namespace std;\n\nint vetor[MAX];\n\nvoid inverterElemento(int* a, int* b){\n     int* inverter;\n     *inverter = *a;\n     *a = *b;\n     *b = *inverter;\n}\n\nint main(){\n    for (int i = 0; i &lt; MAX; i++){\n        vetor[i] = 7*i;\n    }\n    for (int k = 0; k &lt;= MAX/2; k++){\n\n        inverterElemento(&amp;vetor[k], &amp;vetor[MAX - k - 1]);\n    }\n    fori(0, MAX) cout &lt;&lt; vetor[i] &lt;&lt; \" \"; cout &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>Why this 2 lines changes the outcome?</p>\n\n<pre><code>int a = vetor[k];\nint b = vetor[MAX-k-1];\n</code></pre>\n"}, {"tags": ["c", "arrays", "struct"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1558498603, "post_id": 56249217, "comment_id": 99116178, "body": "Your first program writes 50 garbage structs to the file, your second program reads the file and you are surprised to read garbage?   You say &#39;I would like the ID to be 0&quot;  - you have to include code that sets ID to 0 before writing it, if that is what you want"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1558501596, "post_id": 56249217, "comment_id": 99116797, "body": "If you want the entire structure to be initialized to 0, you can declare <code>tempadd</code> as a global variable."}], "answers": [{"tags": [], "owner": {"reputation": 2462, "user_id": 2705907, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e2UTS.jpg?s=128&g=1", "display_name": "Vagish", "link": "https://stackoverflow.com/users/2705907/vagish"}, "is_accepted": false, "score": 0, "last_activity_date": 1558502319, "creation_date": 1558502319, "answer_id": 56249740, "question_id": 56249217, "link": "https://stackoverflow.com/questions/56249217/struct-array-storing-garbage-upon-declaration/56249740#56249740", "title": "Struct Array storing garbage upon declaration", "body": "<p>The code where you create the file has a issue:</p>\n\n<p><code>tempadd[50]</code> is not initialized, either declare it as global or initialize it with the values you required. e.g. If you want <code>Name</code> to be empty , you can do <code>tempadd[0].name = \"\"</code>.\nMake sure you initialize all array elements.</p>\n\n<p>You can also use <code>memcpy</code> to clear all elements of <code>tempadd</code>.</p>\n"}], "owner": {"reputation": 25, "user_id": 11382110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3397f169ca52db2e0ac8f39e442c98?s=128&d=identicon&r=PG&f=1", "display_name": "Mezzoforte", "link": "https://stackoverflow.com/users/11382110/mezzoforte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558502319, "creation_date": 1558498439, "question_id": 56249217, "link": "https://stackoverflow.com/questions/56249217/struct-array-storing-garbage-upon-declaration", "title": "Struct Array storing garbage upon declaration", "body": "<p>I am creating an array of 50 structs like so, and reading it into a binary file. When I then try to print it, the struct appear empty for the first 24 elements, but start behaving strangely (printing garbage) afterwards. I would like the ID to be 0, in particular, as I will most likely be using it for testing. Short of reducing the size of my struct, I'm dumbfounded.</p>\n\n<p>I am creating the binary file like so:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nstruct record\n{\n   int id;\n   char name[40];\n   char email[50];\n   char course[10];\n   int grade;\n};\n\nint main ();\n{\n    struct record tempadd[50];\n    FILE *in = fopen(\"records.bin\", \"ab\");\n    fwrite(tempadd, sizeof(tempadd), 1, in);\n    fclose(in);\n}\n</code></pre>\n\n<hr>\n\n<p>I'm printing the record with this code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct record\n{\n   int id;\n   char name[40];\n   char email[50];\n   char course[10];\n   int grade;\n};\n\nint main ()\n{\n    struct record record[50];\n    FILE *in = fopen(\"records.bin\", \"rb\");\n    fread(record, sizeof(record), 1, in);\n\n    int i;\n    for (i=0; i&lt;50; i++)\n    {\n       printf(\"Student ID: %d    \", record[i].id);\n       printf(\"Name: %s    \", record[i].name);\n       printf(\"Email: %s    \", record[i].email);\n       printf(\"Course: %s    \", record[i].course);\n       printf(\"Grade: %d\\n\", record[i].grade);\n    }\n    fclose(in);\n}\n</code></pre>\n\n<p>I expect 50 lines of:</p>\n\n<pre><code>Student I: 0    Name:     Email:     Course:     Grade: 0\n</code></pre>\n\n<p>Instead, I see many garbage lines like:</p>\n\n<pre><code>Student ID: 1724372348    Name: =     Email: =     Course:     Grade:\n</code></pre>\n"}, {"tags": ["c", "hex", "ascii", "strace"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1558497852, "post_id": 56249110, "comment_id": 99116050, "body": "You are aware of &quot;Non-Printable&quot; ASCII characters, No? You can use a lookup table for those less than <code>&#39; &#39;</code> (space - <code>0x20</code>) and <code>127</code> (del) and output the description in its place. (e.g. <code>&quot;nul&quot;, &quot;soh&quot;, &quot;stx&quot;, ...</code> for <code>0, 1, 2, ...</code>) See, e.g. <a href=\"http://www.asciitable.com/\" rel=\"nofollow noreferrer\">ASCII Table and Description</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1558497936, "post_id": 56249110, "comment_id": 99116063, "body": "Note: there are only 128 <a href=\"https://en.wikipedia.org/wiki/ASCII\" rel=\"nofollow noreferrer\">ASCII</a> characters."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1558500518, "post_id": 56249110, "comment_id": 99116550, "body": "Also, what do string functions look for to indicate end-of-string? (hint: a <i>nul-character</i>) What is the first character in <code>Q</code>? (hint: a <i>nul-character</i>). How many characters will <code>printf</code> see in the string <code>Q</code> using the <code>&quot;%s&quot;</code> conversion specifier to output string <code>Q</code>? (hint: ... you get the drift...)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1558500865, "post_id": 56249110, "comment_id": 99116620, "body": "Here is an example <a href=\"http://susepaste.org/75357399\" rel=\"nofollow noreferrer\">ASCII Table Generator</a>. Link expires: Tue May 28 23:53:43 CDT 2019"}], "owner": {"reputation": 2016, "user_id": 5141989, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/3dPUW.jpg?s=128&g=1", "display_name": "Mike -- No longer here", "link": "https://stackoverflow.com/users/5141989/mike-no-longer-here"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558497517, "creation_date": 1558497517, "question_id": 56249110, "link": "https://stackoverflow.com/questions/56249110/validating-all-ascii-codes-are-printed-from-compiled-c-program-with-strace", "title": "Validating all ascii codes are printed from compiled C program with strace", "body": "<p>I'm making a program where eventually I can send out any set of ascii codes to a custom external hardware device.</p>\n\n<p>What I want to do is ensure that any set of characters I output are actually outputted. As a test, I made this program to try to output every ascii value:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(){\n  int n;\n  char Q[1000];\n  char V[100];\n  V[1]='\\0';\n  for (n=0;n&lt;256;n++){\n    sprintf(V,\"%c\",n);\n    Q[n]=V[0];\n  }\n  Q[n]=0;\n  printf(\"Result = %s\",Q);\n  return 0;\n}\n</code></pre>\n\n<p>After compiling and running strace on the program, I get this at the end:</p>\n\n<pre><code>mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb7f4f000\nwrite(1, \"Result = \"..., 9Result = )             = 9\nexit_group(0)                           = ?\n</code></pre>\n\n<p>So it sortof is trying to tell me the correct output but how can I make it so all codes are outputted, and therefore I see:</p>\n\n<pre><code>write(1, \"Result = \\00\\01\\02\\03\\04\\05\\....\n</code></pre>\n\n<p>with all codes all the way until \\255 ?</p>\n\n<p>I also changed n from 0 to 1 to skip the null character in hopes that printf will print everything but that did not work.</p>\n"}, {"tags": ["c", "dynamic-arrays"], "comments": [{"owner": {"reputation": 3640, "user_id": 7252989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QysK6.png?s=128&g=1", "display_name": "Gaurang Dave", "link": "https://stackoverflow.com/users/7252989/gaurang-dave"}, "edited": false, "score": 0, "creation_date": 1558495239, "post_id": 56248851, "comment_id": 99115593, "body": "Is it C#? It does not look."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1558496038, "post_id": 56248851, "comment_id": 99115756, "body": "<code>*(number+i) = *(evens+j)</code> is exactly equivalent to <code>number[i] = evens[j]</code>, and probably was intended to be <code>evens[j] = number[i]</code>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1558501399, "post_id": 56248851, "comment_id": 99116737, "body": "When you do <code>*(number+i) = *(evens+j);</code> -- what is the value at <code>evens[j]</code>? Look above the assignment in your code and point out where the <code>evens</code> array values are initialized?"}, {"owner": {"reputation": 75, "user_id": 11508270, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hkNF3V-ugG8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3retmZJHgX6rgHCRLh7qCNX4yA8I6g/mo/photo.jpg?sz=128", "display_name": "user672518", "link": "https://stackoverflow.com/users/11508270/user672518"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1558504752, "post_id": 56248851, "comment_id": 99117834, "body": "@DavidC.Rankin Got it. Thanks for that!"}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1558501469, "post_id": 56249470, "comment_id": 99116763, "body": "Sad coding, <code>(numbers+1)</code> is equivalent to <code>&amp;numbers[i]</code>. What you have is a <i>pointer-to-pointer-to-int</i> (and likely a SegFault)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1558505108, "post_id": 56249470, "comment_id": 99117972, "body": "Welcome to Stack Overflow.  Please read the <a href=\"https://stackoverflow.com/tour\">About</a> and <a href=\"https://stackoverflow.com/questions/how-to-answer\">How to Answer</a> pages soon.  This advice is often correct, but it is not in this case, because <code>number</code> is already a pointer to an integer so <code>(number + i)</code> is also a pointer to an integer \u2014 so your advice is formally wrong.  Please remove this answer (before it gets down-voted and deleted anyway)."}], "tags": [], "owner": {"reputation": 1, "user_id": 11533071, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NLAE_m1KYmw/AAAAAAAAAAI/AAAAAAAAAKs/91dUDusWG8s/photo.jpg?sz=128", "display_name": "Rishab Rahiman", "link": "https://stackoverflow.com/users/11533071/rishab-rahiman"}, "is_accepted": false, "score": 0, "last_activity_date": 1558500269, "creation_date": 1558500269, "answer_id": 56249470, "question_id": 56248851, "link": "https://stackoverflow.com/questions/56248851/dynamic-array-separating-numbers-into-even-and-odd-using-c/56249470#56249470", "title": "Dynamic Array: Separating Numbers into Even and Odd Using C", "body": "<p>While getting the input from user, try putting an '&amp;' symbol before your variable name. I think that should work.</p>\n\n<pre><code>scanf(\"%d\",&amp;(number+i));\n</code></pre>\n\n<p>Happy coding :)</p>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1558505818, "last_edit_date": 1558505818, "creation_date": 1558505461, "answer_id": 56250341, "question_id": 56248851, "link": "https://stackoverflow.com/questions/56248851/dynamic-array-separating-numbers-into-even-and-odd-using-c/56250341#56250341", "title": "Dynamic Array: Separating Numbers into Even and Odd Using C", "body": "<p>Your biggest issues regarding assigning values occurs when you attempt to assign <code>evens[j]</code> and <code>odds[j]</code> to <code>numbers[i]</code> before the elements of either <code>evens</code> or <code>odds</code> have been initialized. Following your call to <code>malloc</code> for each <code>evens</code> and <code>odds</code> the block of memory allocated contains whatever garbage values happen to be in that memory region at the time of allocation. <code>malloc</code> does not initialize the content of the memory in any way and leave the values indeterminate. If you want to both allocate and zero all bytes, you can use <code>calloc</code> instead of <code>malloc</code>.</p>\n\n<p>This problem occurs here:</p>\n\n<pre><code>    if (*(number+i)% 2 ==0){\n        *(number+i) = *(evens+j);\n        j++;\n        //evens_count++;\n    } else {\n        *(number+i) = *(odds+k);\n        k++;\n    }\n</code></pre>\n\n<p>Look carefully, you check whether <code>numbers[i]</code> is even/odd with <code>% 2 == 0</code>, but then attempt to overwrite the value at <code>numbers[i]</code> with either <code>evens[j]</code> or <code>odds[k]</code> -- <strong>this is backwards</strong>. The intent would be to assign the value in <code>numbers[i]</code> to either <code>evens[j]</code> or <code>odds[k]</code>, e.g.</p>\n\n<pre><code>    if (number[i] % 2 ==0){\n        evens[j] = number[i];\n        j++;\n        //evens_count++;\n    } else {\n        odds[k] = number[i];\n        k++;\n    }\n</code></pre>\n\n<p>Next, your use of variables is jumbled. You don't need all the different <code>i, j, k</code> counters declared at the beginning of <code>main()</code>. For the past 20 years, since C99, you can declare the loop variable within the <code>for</code> loop declaration itself. This eliminates the chance that your use of your loop variable will conflict with another use of <code>i, j, k</code> somewhere else in the program.</p>\n\n<p>You have <code>count, odd_count &amp; even_count</code>, those are the only counters you need.</p>\n\n<p>Further, you need to VALIDATE <em>every</em> User Input and <em>every</em> Allocation. Otherwise, you risk invoking <em>Undefined Behavior</em> with the slip of a keystroke or when (not \"if\") an allocation returns <code>NULL</code>. Validate every critical step.</p>\n\n<p>Putting those measures to use, you can simplify your declaration to:</p>\n\n<pre><code>    int count,          /* integer amount from user     */\n        odd_count = 0,  /* odd count (initialized zero) */\n        even_count = 0, /* even count (initialized zero)*/\n        *number,        /* declare pointers             */\n        *evens,\n        *odds; \n</code></pre>\n\n<p>You can validate your input with:</p>\n\n<pre><code>    /* read in integer count from user (VALIDATE every input) */\n    printf(\"enter the amount of numbers: \");\n    if (scanf(\"%d\", &amp;count) != 1) {\n        fputs (\"error: invalid integer input.\\n\", stderr);\n        return 1;\n    }\n    ...\n    for (int i = 0; i &lt; count; i++) {   /* loop count times for input */\n        printf (\"enter number %2d: \", i + 1);\n        if (scanf (\"%d\", &amp;number[i]) != 1) {    /* validate EVERY input */\n            fputs (\"error: invalid integer input.\\n\", stderr);\n            return 1;\n        }\n        if (number[i] % 2 == 0)     /* assign, increment evens count */\n            evens[even_count++] = number[i];\n        else                        /* same for odds */\n            odds[odd_count++] = number[i];\n    }\n</code></pre>\n\n<p>And you can validate your allocations:</p>\n\n<pre><code>    /* allocate count integers each pointer (VALIDATE every allocation) */\n    if ((number = malloc (count * sizeof *number)) == NULL) {\n        perror (\"malloc-number\");\n        return 1;\n    }\n    if ((evens = malloc (count * sizeof *evens)) == NULL) {\n        perror (\"malloc-evens\");\n        return 1;\n    }\n    if ((odds = malloc (count * sizeof *odds)) == NULL) {\n        perror (\"malloc-odds\");\n        return 1;\n    }\n</code></pre>\n\n<p>Then it is simply a matter of looping <code>i = 0; i &lt; count</code> to output the <code>number</code>, <code>i = 0; i &lt; even_count</code> to output <code>evens</code> and finally <code>i = 0; i &lt; odd_count</code> to output <code>odds</code>, e.g.</p>\n\n<pre><code>    puts (\"\\n numbers\\n--------\");      /* output each array on its own */\n    for (int i = 0; i &lt; count; i++)\n        printf (\"%8d\\n\", number[i]);\n\n    puts (\"\\n   evens\\n--------\");\n    for (int i = 0; i &lt; even_count; i++)\n        printf (\"%8d\\n\", evens[i]);\n\n    puts (\"\\n    odds\\n--------\");\n    for (int i = 0; i &lt; odd_count; i++)\n        printf (\"%8d\\n\", odds[i]);\n</code></pre>\n\n<p>And Finally, you can output all 3 arrays at once with:</p>\n\n<pre><code>    /* output all arrays together */\n    puts (\"\\nnumbers      even      odd\\n-------- -------- --------\");\n    for (int i = 0; i &lt; count; i++) {       /* loop printing number */\n        printf (\"%8d\", number[i]);\n        if (i &lt; even_count) {               /* if i &lt; even_count */\n            printf (\" %8d\", evens[i]);      /* output evens */\n            if (i &lt; odd_count)              /* if odds too, output them */\n                printf (\" %8d\\n\", odds[i]);\n            else\n                putchar ('\\n');             /* no more odds output '\\n' */\n        }\n        else if (i &lt; odd_count)             /* if only odds left, output */\n            printf (\"%18d\\n\", odds[i]);\n        else\n            putchar ('\\n');\n    }\n</code></pre>\n\n<p>At the end, don't forget to free the memory you allocate, e.g.</p>\n\n<pre><code>    free (number);  /* don't forget to free what you allocated */\n    free (evens);\n    free (odds);\n</code></pre>\n\n<p>Putting it altogether, you could do:</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n#include &lt;stdlib.h&gt;\n\nint main(void) {\n\n    int count,          /* integer amount from user     */\n        odd_count = 0,  /* odd count (initialized zero) */\n        even_count = 0, /* even count (initialized zero)*/\n        *number,        /* declare pointers             */\n        *evens,\n        *odds; \n\n    /* read in integer count from user (VALIDATE every input) */\n    printf(\"enter the amount of numbers: \");\n    if (scanf(\"%d\", &amp;count) != 1) {\n        fputs (\"error: invalid integer input.\\n\", stderr);\n        return 1;\n    }\n\n    /* allocate count integers each pointer (VALIDATE every allocation) */\n    if ((number = malloc (count * sizeof *number)) == NULL) {\n        perror (\"malloc-number\");\n        return 1;\n    }\n    if ((evens = malloc (count * sizeof *evens)) == NULL) {\n        perror (\"malloc-evens\");\n        return 1;\n    }\n    if ((odds = malloc (count * sizeof *odds)) == NULL) {\n        perror (\"malloc-odds\");\n        return 1;\n    }\n\n    for (int i = 0; i &lt; count; i++) {   /* loop count times for input */\n        printf (\"enter number %2d: \", i + 1);\n        if (scanf (\"%d\", &amp;number[i]) != 1) {    /* validate EVERY input */\n            fputs (\"error: invalid integer input.\\n\", stderr);\n            return 1;\n        }\n        if (number[i] % 2 == 0)     /* assign, increment evens count */\n            evens[even_count++] = number[i];\n        else                        /* same for odds */\n            odds[odd_count++] = number[i];\n    }\n\n    puts (\"\\n numbers\\n--------\");      /* output each array on its own */\n    for (int i = 0; i &lt; count; i++)\n        printf (\"%8d\\n\", number[i]);\n\n    puts (\"\\n   evens\\n--------\");\n    for (int i = 0; i &lt; even_count; i++)\n        printf (\"%8d\\n\", evens[i]);\n\n    puts (\"\\n    odds\\n--------\");\n    for (int i = 0; i &lt; odd_count; i++)\n        printf (\"%8d\\n\", odds[i]);\n\n    /* output all arrays together */\n    puts (\"\\nnumbers      even      odd\\n-------- -------- --------\");\n    for (int i = 0; i &lt; count; i++) {       /* loop printing number */\n        printf (\"%8d\", number[i]);\n        if (i &lt; even_count) {               /* if i &lt; even_count */\n            printf (\" %8d\", evens[i]);      /* output evens */\n            if (i &lt; odd_count)              /* if odds too, output them */\n                printf (\" %8d\\n\", odds[i]);\n            else\n                putchar ('\\n');             /* no more odds output '\\n' */\n        }\n        else if (i &lt; odd_count)             /* if only odds left, output */\n            printf (\"%18d\\n\", odds[i]);\n        else\n            putchar ('\\n');\n    }\n\n    free (number);  /* don't forget to free what you allocated */\n    free (evens);\n    free (odds);\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/number_evens_odds\nenter the amount of numbers: 10\nenter number  1: 21\nenter number  2: 22\nenter number  3: 23\nenter number  4: 24\nenter number  5: 119\nenter number  6: 121\nenter number  7: 131\nenter number  8: 140\nenter number  9: 141\nenter number 10: 143\n\n numbers\n--------\n      21\n      22\n      23\n      24\n     119\n     121\n     131\n     140\n     141\n     143\n\n   evens\n--------\n      22\n      24\n     140\n\n    odds\n--------\n      21\n      23\n     119\n     121\n     131\n     141\n     143\n\nnumbers      even      odd\n-------- -------- --------\n      21       22       21\n      22       24       23\n      23      140      119\n      24               121\n     119               131\n     121               141\n     131               143\n     140\n     141\n     143\n</code></pre>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}], "owner": {"reputation": 75, "user_id": 11508270, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hkNF3V-ugG8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3retmZJHgX6rgHCRLh7qCNX4yA8I6g/mo/photo.jpg?sz=128", "display_name": "user672518", "link": "https://stackoverflow.com/users/11508270/user672518"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1553, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1558505818, "creation_date": 1558495184, "last_edit_date": 1558495329, "question_id": 56248851, "link": "https://stackoverflow.com/questions/56248851/dynamic-array-separating-numbers-into-even-and-odd-using-c", "title": "Dynamic Array: Separating Numbers into Even and Odd Using C", "body": "<p>My program should first ask for the number of integers to read and dynamically allocate an array just big enough to hold the number of values I read. Then, I need to categorize these values into odd and even.   </p>\n\n<p>This is the code I've tried</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n#include &lt;stdlib.h&gt;\nint main(void){\n\n//declare variables\nint i; //loop counter\nint count; //integer amount from user\nint j = 0; int k = 0;\n\n// read in integer count from user\nprintf(\"enter the amount of numbers: \");\nscanf(\"%d\", &amp;count);\n\n// declare pointer \nint *number = malloc(sizeof(int)*count);\nint *evens = malloc(sizeof(int)*count);\nint *odds = malloc(sizeof(int)*count);\n\n// declare variable\n//int odds_count = 0;\n//int evens_count = 0;\n\n//loop to read in numbers from user\nfor (i=0; i&lt;count; i++){\n    printf(\"enter number %02d: \",i+1);\n    scanf(\"%d\",(number+i));\n    printf(\"you entered %d\\n\", *(number+i)); //--- entered values are correct here\n    if (*(number+i)% 2 ==0){\n        *(number+i) = *(evens+j);\n        j++;\n        //evens_count++;\n    } else {\n        *(number+i) = *(odds+k);\n        k++;\n    }\n    printf(\"you entered %d\\n\", *(number+i));  //---entered values become 0\n}\n//print array elements\nprintf(\"\\nEntered array elements are:\\n\");\nfor(i=count;i&gt;0;i--)\n{\n    printf(\"%d \",*(number+i));\n}\nprintf(\"\\n\");\n\n// print out even numbers\nprintf(\"even numbers: \");\nfor (i=0;i&lt;j;i++){\n    printf(\"%5d\",*(evens+i));\n}\nprintf(\"\\n\");\n\n// print out odd numbers\nprintf(\"odd numbers: \");\nfor (i=0;i&lt;k;i++){\n    printf(\"%5d\",*(odds+i));\n}\nprintf(\"\\n\");\n\nreturn 0;\n}\n</code></pre>\n\n<p>No matter what input I enter, the output only displays 0.\nE.g: </p>\n\n<pre><code>Input- 1, 2, 3\nOutput-\nEvens: 0\nOdds: 0 0\n</code></pre>\n\n<p>Please help me with this. Thanks in advance!</p>\n"}, {"tags": ["c", "tic-tac-toe"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1558495380, "post_id": 56248839, "comment_id": 99115622, "body": "As someone who frequents both here and CR I&#39;ll just note: as you&#39;ve written it, it doesn&#39;t really fit in either site; although this is more appropriate for CR. Direct it more towards asking for improvements with your code, show a full runnable example,and it will be appropriate for there. This will likely be considered too broad and opinion based for SO though."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1558497046, "post_id": 56248839, "comment_id": 99115941, "body": "It might be simpler to create an array with 8 entries, with each entry consisting of an array of 3 x, y index pairs for a win (3 horizontal, 3 vertical, and 2 diagonal makes 8 total).  Then all you need is an outer loop that iterates over the 8 top-level entries, and an inner loop that iterates over the 3 entries for that win condition.  Very little code."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1558497607, "post_id": 56248839, "comment_id": 99116016, "body": "Using loops would make a lot of sense if the board size was larger, or user selectable. But the 3x3 board makes the <code>if</code> statement (like the anti-diagonal check) much simpler than the loop (like the main diagonal check). When checking rows and columns, I would compromise: loop through each row and use a simple <code>if</code> to check the row."}], "answers": [{"tags": [], "owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "is_accepted": false, "score": 0, "last_activity_date": 1558506829, "last_edit_date": 1558506829, "creation_date": 1558506521, "answer_id": 56250569, "question_id": 56248839, "link": "https://stackoverflow.com/questions/56248839/tic-tac-toe-determine-winner-algorithm/56250569#56250569", "title": "Tic Tac Toe determine winner algorithm", "body": "<p>A tic-tac-toe board has 9 tiles.</p>\n\n<p>Each tile either has an <code>X</code> in it or it doesn't. This means that you can use a 9-bit unsigned integer to represent if each tile does/doesn't have an <code>X</code>; then use this number in a (512 entry) lookup table to determine if <code>X</code> won.</p>\n\n<p>In the same way; each tile either has an <code>O</code> in it or it doesn't; so you can encode that as a different 9-bit unsigned integer and use it in the same (512 entry) lookup table to determine of <code>O</code> won.</p>\n\n<p>If the board is represented as a pair of 9-bit integers everywhere (avoiding the need to convert the state of the board), then the code becomes:</p>\n\n<pre><code>if( table[XboardState] == WIN) {\n    printf(\"X wins\\n\");\n} else if( table[OboardState] == WIN) {\n    printf(\"O wins\\n\");\n} else {\n    printf(\"No winner\\n\");\n}\n</code></pre>\n\n<p>Note: The lookup table only needs one bit per entry; so by using bitfields (and some shifting/masking to select the right bit) it could be as small as 64 bytes. Of course you could write a crude/temporary utility to generate the table for you, then \"cut &amp; paste\" the table into your game's code.</p>\n"}], "owner": {"reputation": 69, "user_id": 11472889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44bd7cd879a91141a92213148112f717?s=128&d=identicon&r=PG&f=1", "display_name": "fibonaccipistacci", "link": "https://stackoverflow.com/users/11472889/fibonaccipistacci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558506829, "creation_date": 1558495100, "question_id": 56248839, "link": "https://stackoverflow.com/questions/56248839/tic-tac-toe-determine-winner-algorithm", "title": "Tic Tac Toe determine winner algorithm", "body": "<p>I initially intended to post this on the Codereview SE but since I really didn't know if the following code could be considered complete, I thought it would be a better fit here. Feel free to close this if you feel it'd be better posted somewhere else.</p>\n\n<p>Considering a \"valid\" in terms of tic tac toe rules 3x3 array as input called <code>game</code>, how does this algorithm look for finding out the winner? </p>\n\n<p>I'm a noob in C and programming in general and I'd like to know how good is the performance/complexity of this code, since it kind of differs from what I find on other posts in SO. Do the for loops make this unnecessarily complicated?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>if (game[1][3] == game[2][2] &amp;&amp; game[2][2] == game[3][1]) /*antidiagonal check */\n    {\n        w = game[1][3]; /* w is player X or O */\n    }\n\n    t1 = 0;\n\n    for (i=0; i&lt;=2; ++i)\n    {\n        if (game[i][i] == game[i+1][i+1]) /* main diagonal check */\n        {\n            t1 += 1;\n        }\n            if (t1 == 2)\n            {\n                w = game[i][i];\n            }\n    }\n\n    for (i=0; i&lt;=2; ++i)\n    {\n        t2 = 0;\n        for (j=0; j&lt;=1; ++j)\n        {\n            if (game[i][j] == game[i][j+1]) /* row check */\n            {\n                t2 += 1;\n                if (t2 == 2)\n                {\n                    w = game[i][j];\n                }\n            }\n        }\n    }\n\n    for (i=0; i&lt;=1; ++i)\n    {\n        t3=0;\n        for (j=0; j&lt;=2; ++j)\n        {\n            if (game[i][j] == game[i+1][j]) /* column check */\n            {\n                t3 += 1;\n                if (t3 == 2)\n                {\n                    w = game[i][j];\n                }\n            }\n        }\n    }\n\n    if (t1&lt;2 &amp;&amp; t2&lt;2 &amp;&amp; t3&lt;3)\n    {\n        printf(\"No winner\\n\");\n    }\n    else\n    {\n        printf(\"%c wins\\n\", w);\n    }\n</code></pre>\n"}, {"tags": ["c", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1558495079, "post_id": 56248801, "comment_id": 99115570, "body": "It causes a race condition because you have literally asked it to. Updating a variable from multiple threads is the very definition of a race condition. What did you expect?"}, {"owner": {"reputation": 219, "user_id": 5795193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LOLw6.jpg?s=128&g=1", "display_name": "Papaya-Automaton", "link": "https://stackoverflow.com/users/5795193/papaya-automaton"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1558495444, "post_id": 56248801, "comment_id": 99115630, "body": "@n.m which variables? the ones inside the <code>getPrime</code> function?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1558495641, "post_id": 56248801, "comment_id": 99115665, "body": "There is one global variable you update, primeCount."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1558502302, "post_id": 56248801, "comment_id": 99116990, "body": "Side-note: your isPrime() function checks too many values (though I&#39;ve seen many worse functions, too).  After checking 2, it should at most check the odd divisors from 3 upwards.  If you test 2 and 3 specially, then you can check divisors of the form 6N&#177;1 (5, 7; 11, 13; 17; 19; \u2026) only.  That does check composite divisors (the first such is 25), but it cuts down the workload (2/3 of the odd numbers only; 1/3 of odd and even numbers).  That said, you do limit your search to \u221aN, which is an important saving too."}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 1, "creation_date": 1558535349, "post_id": 56248801, "comment_id": 99134928, "body": "Re, &quot;...global integer array with k elements but since k is not defined...&quot; In this case, it&#39;s not reasonable for <code>k</code> to be very large. You could declare a fixed array that&#39;s big enough for any reasonable <code>k</code>, and only use its first <code>k</code> elements. But don&#39;t forget to check the input, and throw an error if the user enters <code>k &gt; MAX_K</code>."}, {"owner": {"reputation": 219, "user_id": 5795193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LOLw6.jpg?s=128&g=1", "display_name": "Papaya-Automaton", "link": "https://stackoverflow.com/users/5795193/papaya-automaton"}, "reply_to_user": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1558543036, "post_id": 56248801, "comment_id": 99139346, "body": "@SolomonSlow yes that fixed my problem. My code works."}, {"owner": {"reputation": 219, "user_id": 5795193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LOLw6.jpg?s=128&g=1", "display_name": "Papaya-Automaton", "link": "https://stackoverflow.com/users/5795193/papaya-automaton"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1558543288, "post_id": 56248801, "comment_id": 99139462, "body": "@JonathanLeffler yes I will check from 3 upwards. In regards to 6N(+-) 1. what does that mean?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1558548614, "post_id": 56248801, "comment_id": 99141721, "body": "6N&#177;1 means that you have (inside <code>isPrime()</code>) a counter that might be called <code>n</code> and you run <code>int n_max = (limit + 5) &#47; 6; for (int n = 1; n  &lt;= n_max; n++) { if (num % (6 * n - 1) == 0) return FALSE; if (num % (6 * n + 1) == 0) return FALSE; }</code>.  Or you might use: <code>for (int n = 6; n &lt; limit; n += 6) { if (num % (n - 1) == 0 || num % (n + 1) == 0) return FALSE; }</code> or something similar.  The basic idea is that you test only those values which are one less than or one greater than a multiple of 6 (hence 5, 7; 11, 13; 17, 19; \u2026 as I noted originally)."}], "answers": [{"comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1558496993, "post_id": 56249033, "comment_id": 99115930, "body": "Better yet, avoid sharing data between threads altogether. Make each thread return its own count, sum them up in the main thread. Atomic operations come with a price tag. Not needed."}, {"owner": {"reputation": 219, "user_id": 5795193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LOLw6.jpg?s=128&g=1", "display_name": "Papaya-Automaton", "link": "https://stackoverflow.com/users/5795193/papaya-automaton"}, "edited": false, "score": 0, "creation_date": 1558497592, "post_id": 56249033, "comment_id": 99116008, "body": "@Davislor would that value be passed as an argument pthread_exit()?"}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1558497886, "post_id": 56249033, "comment_id": 99116055, "body": "You could pass the address of the counter to <code>pthread_exit()</code>. Note that it cannot be local to the thread procedure or the same for every thread. It could be an element of an array of atomic variables."}, {"owner": {"reputation": 219, "user_id": 5795193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LOLw6.jpg?s=128&g=1", "display_name": "Papaya-Automaton", "link": "https://stackoverflow.com/users/5795193/papaya-automaton"}, "edited": false, "score": 0, "creation_date": 1558498181, "post_id": 56249033, "comment_id": 99116104, "body": "But the address of the counter variable cannot be global right or go inside the thread function? So, where would it go? in the argument list for the thread? <code>pthread_create(&amp;threads[i],NULL, void*function, &amp;newCounter[0])</code> something like that?"}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 1, "creation_date": 1558498317, "post_id": 56249033, "comment_id": 99116128, "body": "You\u2019d typically declare an array of them, one per thread, in the procedure that creates the threads. You could also make the array global, but since you only need it to create threads and collect their results, best practice is to declare it only in the scope where it\u2019s used. Pass each thread the address of a different element."}, {"owner": {"reputation": 219, "user_id": 5795193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LOLw6.jpg?s=128&g=1", "display_name": "Papaya-Automaton", "link": "https://stackoverflow.com/users/5795193/papaya-automaton"}, "edited": false, "score": 0, "creation_date": 1558499775, "post_id": 56249033, "comment_id": 99116400, "body": "@Davislor I appreciate the help I will go to sleep and Implement your tips tomorrow. When I get it working I will mark as the correct answer."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 219, "user_id": 5795193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LOLw6.jpg?s=128&g=1", "display_name": "Papaya-Automaton", "link": "https://stackoverflow.com/users/5795193/papaya-automaton"}, "edited": false, "score": 0, "creation_date": 1558505920, "post_id": 56249033, "comment_id": 99118286, "body": "@SimonGarfe &quot;would that value be passed as an argument pthread_exit&quot; You can cast the integer result to <code>void*</code> and pass that to pthread_exit, exactly like you pass the input argument in. Cast it back in <code>main</code>. That would probably the easiest way of doing it."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1558506316, "post_id": 56249033, "comment_id": 99118454, "body": "@n.m. That\u2019s potentially undefined behavior and I don\u2019t recommend it. That said, it\u2019s likely to work on the implementation the OP is using."}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1558535847, "post_id": 56249033, "comment_id": 99135233, "body": "@Davislor, thread-local variables are sometimes useful when you&#39;re trying to port old, thread-unaware code that uses global variables into a multi-threaded system. But if you use thread-local variables in <i>new</i> code, then there&#39;s probably a better way to solve the problem. Thread-local only makes sense when the variable has global extent. If you want your code to be testable, maintainable, portable, etc.; then you should avoid using globals."}], "tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 2, "last_activity_date": 1558499558, "last_edit_date": 1558499558, "creation_date": 1558496794, "answer_id": 56249033, "question_id": 56248801, "link": "https://stackoverflow.com/questions/56248801/why-is-this-c-code-causing-a-race-condition/56249033#56249033", "title": "why is this c code causing a race condition?", "body": "<p>The counter <code>primeCount</code> is modified by multiple threads, and therefore must be atomic.  To fix this using the standard library (which is now supported by POSIX as well), you should <code>#include &lt;stdatomic.h&gt;</code>, declare <code>primeCount</code> as an <code>atomic_int</code>, and increment it with an <code>atomic_fetch_add()</code> or <code>atomic_fetch_add_explicit()</code>.</p>\n\n<p>Better yet, if you don\u2019t care about the result until the end, each thread can store its own count in a separate variable, and the main thread can add all the counts together once the threads finish. You will need to create, in the main thread, an atomic counter per thread (so that updates don\u2019t clobber other data in the same cache line), pass each thread a pointer to its output parameter, and then return the partial tally to the main thread through that pointer.</p>\n\n<p>This looks like an exercise that you want to solve yourself, so I won\u2019t write the code for you, but the approach to use would be to declare an array of counters like the array of thread IDs, and pass <code>&amp;counters[i]</code> as the <code>arg</code> parameter of <code>pthread_create()</code> similarly to how you pass <code>&amp;threads[i]</code>. Each thread would need its own counter.  At the end of the thread procedure, you would write something like, <code>atomic_store_explicit( (atomic_int*)arg, localTally, memory_order_relaxed );</code>.  This should be completely wait-free on all modern architectures.</p>\n\n<p>You might also decide that it\u2019s not worth going to that trouble to avoid a single atomic update per thread, declare <code>primeCount</code> as an <code>atomic_int</code>, and then <code>atomic_fetch_add_explicit( &amp;primeCount, localTally, memory_order_relaxed );</code> once before the thread procedure terminates.</p>\n"}], "owner": {"reputation": 219, "user_id": 5795193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LOLw6.jpg?s=128&g=1", "display_name": "Papaya-Automaton", "link": "https://stackoverflow.com/users/5795193/papaya-automaton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558499558, "creation_date": 1558494783, "last_edit_date": 1558496782, "question_id": 56248801, "link": "https://stackoverflow.com/questions/56248801/why-is-this-c-code-causing-a-race-condition", "title": "why is this c code causing a race condition?", "body": "<p>I'm trying to count the number of prime numbers up to 10 million and I have to do it using multiple threads using Posix threads(so, that each thread computes a subset of 10 million). However, my code is not checking for the condition <code>IsPrime</code>. I'm thinking this is due to a race condition. If it is what can I do to ameliorate this issue?</p>\n\n<p>I've tried using a global integer array with k elements but since k is not defined it won't let me declare that at the file scope.</p>\n\n<p>I'm running my code using gcc -pthread:</p>\n\n<pre><code>/*\nProgram that spawns off \"k\" threads\nk is read in at command line each thread will compute\na subset of the problem domain(check if the number is prime)\n\nto compile: gcc -pthread lab5_part2.c -o lab5_part2\n*/\n#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef int bool;\n#define FALSE 0\n#define TRUE 1\n\n#define N 10000000  // 10 Million\n\nint k; // global variable k willl hold the number of threads\nint primeCount = 0; //it will hold the number of primes.\n\n//returns whether num is prime\nbool isPrime(long num) {\n    long limit = sqrt(num);\n    for(long i=2; i&lt;=limit; i++) {\n        if(num % i == 0) {\n             return FALSE;\n        }\n     }\n     return TRUE;\n}\n\n//function to use with threads\nvoid* getPrime(void* input){\n    //get the thread id\n    long id = (long) input;\n    printf(\"The thread id is: %ld \\n\", id);\n\n    //how many iterations each thread will have to do\n    int numOfIterations = N/k;\n\n  //check the last thread. to make sure is a whole number.\n  if(id == k-1){\n    numOfIterations = N - (numOfIterations * id);\n  }\n\n  long startingPoint = (id * numOfIterations);\n  long endPoint = (id + 1) * numOfIterations;\n  for(long i = startingPoint; i &lt; endPoint; i +=2){\n    if(isPrime(i)){\n      primeCount ++;\n    }\n  }\n  //terminate calling thread.\n  pthread_exit(NULL);\n}\n\nint main(int argc, char** args) {\n    //get the num of threads from command line\n    k = atoi(args[1]);\n    //make sure is working\n   printf(\"Number of threads is: %d\\n\",k );\n\n   struct timespec start,end;\n\n    //start clock\n    clock_gettime(CLOCK_REALTIME,&amp;start);\n\n    //create an array of threads to run\n    pthread_t* threads = malloc(k * sizeof(pthread_t));\n    for(int i = 0; i &lt; k; i++){\n      pthread_create(&amp;threads[i],NULL,getPrime,(void*)(long)i);\n    }\n\n    //wait for each thread to finish\n    int retval;\n    for(int i=0; i &lt; k; i++){\n      int * result = NULL;\n      retval = pthread_join(threads[i],(void**)(&amp;result));\n    }\n\n    //get the time time_spent\n    clock_gettime(CLOCK_REALTIME,&amp;end);\n    double time_spent = (end.tv_sec - start.tv_sec) +\n                    (end.tv_nsec - start.tv_nsec)/1000000000.0f;\n\n    printf(\"Time tasken: %f seconds\\n\", time_spent);\n\n    printf(\"%d primes found.\\n\", primeCount);\n\n}\n</code></pre>\n\n<p>the current output I am getting: (using the 2 threads)</p>\n\n<p><code>Number of threads is: 2</code></p>\n\n<p><code>Time tasken: 0.038641 seconds</code></p>\n\n<p><code>2 primes found.</code></p>\n"}, {"tags": ["c", "microcontroller"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 5231589, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcd9386bbb3108feb3e18493f2214095?s=128&d=identicon&r=PG&f=1", "display_name": "RochNoure", "link": "https://stackoverflow.com/users/5231589/rochnoure"}, "edited": false, "score": 0, "creation_date": 1558494755, "post_id": 56248709, "comment_id": 99115503, "body": "Thank you for responding. I just edited the code, still not interrupting when I push the button. I have the other inputs on pull-down resistor. It&#39;s funny you mentioned that because I experienced electric noise on other inputs and they were reading on and off erratically before I knew about pull-up and pull down resistor set up, which solved that problem."}, {"owner": {"reputation": 57, "user_id": 5231589, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcd9386bbb3108feb3e18493f2214095?s=128&d=identicon&r=PG&f=1", "display_name": "RochNoure", "link": "https://stackoverflow.com/users/5231589/rochnoure"}, "edited": false, "score": 0, "creation_date": 1558502318, "post_id": 56248709, "comment_id": 99116993, "body": "That&#39;s what I have. There is a <code>while (1)</code> loop that contains the entire code and I added the <code>if (interruptFlag == 1)</code> inside it, at the beginning."}, {"owner": {"reputation": 57, "user_id": 5231589, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcd9386bbb3108feb3e18493f2214095?s=128&d=identicon&r=PG&f=1", "display_name": "RochNoure", "link": "https://stackoverflow.com/users/5231589/rochnoure"}, "reply_to_user": {"reputation": 1480, "user_id": 8746648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726e6151726f9d185620a833825b61f3?s=128&d=identicon&r=PG", "display_name": "asynts", "link": "https://stackoverflow.com/users/8746648/asynts"}, "edited": false, "score": 0, "creation_date": 1558515001, "post_id": 56248709, "comment_id": 99122952, "body": "@asynts It does not recognize it. I get the error: Object is missing declaration specifiers."}], "tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 4, "last_activity_date": 1558497053, "last_edit_date": 1558497053, "creation_date": 1558493947, "answer_id": 56248709, "question_id": 56248554, "link": "https://stackoverflow.com/questions/56248554/how-to-implement-interrupt-flags-in-c-using-a-microcontroller/56248709#56248709", "title": "How to implement interrupt flags in C, using a Microcontroller?", "body": "<p>Assuming that the interrupt call works fine..</p>\n\n<ol>\n<li>Change the variable <code>int interruptFlag;</code> to <code>volatile int interruptFlag;</code>. This is to avoid optimizing away the <code>if</code> condition in main by the compiler.</li>\n<li><p>In <code>main</code> you need to reset the <code>interruptFlag</code> on some condition. This is program dependent. Maybe you can do it like this.</p>\n\n<pre><code>if ( interruptFlag == 1)\n{\n      PORTB = (PORTB &amp; 0x00) // Here I'm turning off all the pins in Port B, which includes the pump.\n      interruptFlag = 0;\n}\n</code></pre></li>\n<li><p>If you are using a push button, you should introduce a debounce mechanism to avoid detecting multiple inputs.</p></li>\n<li><p>You need to add the if condition in main inside a while(1) loop as the interrupt can come at any time.</p>\n\n<pre><code>while(1)\n{ \n    if(interruptFlag == 1)\n    {\n        ...\n    }\n}\n</code></pre></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 5231589, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcd9386bbb3108feb3e18493f2214095?s=128&d=identicon&r=PG&f=1", "display_name": "RochNoure", "link": "https://stackoverflow.com/users/5231589/rochnoure"}, "edited": false, "score": 0, "creation_date": 1558514877, "post_id": 56250197, "comment_id": 99122881, "body": "I&#39;m using port P, which I tested and it&#39;s working if I include everything in the function."}], "tags": [], "owner": {"reputation": 67, "user_id": 11321917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2fcb9d6b5dbfe1352947df331a04aaa?s=128&d=identicon&r=PG&f=1", "display_name": "akimata", "link": "https://stackoverflow.com/users/11321917/akimata"}, "is_accepted": false, "score": 0, "last_activity_date": 1558504696, "creation_date": 1558504696, "answer_id": 56250197, "question_id": 56248554, "link": "https://stackoverflow.com/questions/56248554/how-to-implement-interrupt-flags-in-c-using-a-microcontroller/56250197#56250197", "title": "How to implement interrupt flags in C, using a Microcontroller?", "body": "<p>If u still can't get interrupt to fire , after things that other suggested, you should check if you got global interrupts or interrupt for specific part (GPIO) enabled since in most uc setting GPIO to generate interrupts doesn't enable interrupts</p>\n"}], "owner": {"reputation": 57, "user_id": 5231589, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcd9386bbb3108feb3e18493f2214095?s=128&d=identicon&r=PG&f=1", "display_name": "RochNoure", "link": "https://stackoverflow.com/users/5231589/rochnoure"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1558504696, "creation_date": 1558492444, "last_edit_date": 1558492993, "question_id": 56248554, "link": "https://stackoverflow.com/questions/56248554/how-to-implement-interrupt-flags-in-c-using-a-microcontroller", "title": "How to implement interrupt flags in C, using a Microcontroller?", "body": "<p>I have set up a project using a 16-bit Microcontroller called Thunderbird12, similar to the 9s12/Freescale 68HC12 family. It does a few things but mainly turn on an external water pump. Everything works fine except I need to implement an interrupt. I want to be able to stop the motor using an interrupt through a push button.</p>\n\n<p>I have set up the button which sets pin 0 of port P to high when pressed. Using C, I have initialized the hardware and written the code but the flag is not called. Please see code below.</p>\n\n<pre><code>// Interrupt function\nint interruptFlag;\nvoid interrupt 56 WaterPumpRoutine() {\n   if ((PIFP &amp; 0x01) == 0x01) {   // check if pin 0 of port p is high (when button is pressed)\n   interruptFlag = 1; // set the flag to 1           \n} \n\n// Main\nvoid main() {\n\nDDRP = 0x00; // set port P as input\nPIEP = PIEP | 0x01; // enable interrupts on port P, pin 0\nPERP = PERP | 0x01; // enable pull-up/down on port P, pin 0\n\nif ( interruptFlag == 1)\n      PORTB = (PORTB &amp; 0x00) // Here I'm turning off all the pins in Port B, which includes the pump.\n}\n</code></pre>\n\n<p>If I put this code <code>PORTB = (PORTB &amp; 0x00)</code> inside the <code>WaterPumpRoutine()</code> function, it works fine, but I need to be able to call the flag anywhere. I'm not sure what I'm missing. Any help would be appreciated!</p>\n"}, {"tags": ["c", "linux", "timer", "gdb"], "comments": [{"owner": {"reputation": 378, "user_id": 10385483, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dejUK.jpg?s=128&g=1", "display_name": "YunYanan", "link": "https://stackoverflow.com/users/10385483/yunyanan"}, "edited": false, "score": 1, "creation_date": 1558576718, "post_id": 56248403, "comment_id": 99150150, "body": "UPDATE: I replaced the posix timer with timerfd, now the timerfd timer`s 1ms timing is accurate during normal operation and debugging."}], "owner": {"reputation": 378, "user_id": 10385483, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dejUK.jpg?s=128&g=1", "display_name": "YunYanan", "link": "https://stackoverflow.com/users/10385483/yunyanan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1558492632, "creation_date": 1558490925, "question_id": 56248403, "link": "https://stackoverflow.com/questions/56248403/1ms-posix-timer-is-not-timed-correctly-when-debugging-with-gdb", "title": "1ms posix timer is not timed correctly when debugging with GDB", "body": "<p>I wrote a test program that created a 1ms posix timer, When running the program alone or debugging with GDB, the timing is accurate. Then I put the test program into my project code, when I run my project program, the timer is also accurate, but if I'm debugging my project with GDB, the timer is not timed correctly.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;time.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\n#define CLOCKID CLOCK_REALTIME\n\ntimer_t timer_id;\n\nint timer_thread_cnt = 0;\nvoid timer_thread(union sigval v)\n{\n    timer_thread_cnt++;\n    printf(\"timer thread count &lt;%d&gt;\\n\", timer_thread_cnt);\n}\n\nint start_timer(void)\n{\n    struct sigevent evp;\n    int ret;\n\n    memset(&amp;evp, 0, sizeof(struct sigevent));\n    evp.sigev_value.sival_int = 111; /* it can be passed into callback */\n    evp.sigev_notify = SIGEV_THREAD; /* The thread notifying way -- dispatch a new thread. */\n    evp.sigev_notify_function = &amp;timer_thread; /* The thread address */\n\n    if (timer_create(CLOCKID, &amp;evp, &amp;timer_id) == 0) { /* create timer */\n        struct itimerspec it;\n\n        it.it_interval.tv_sec = 0;\n        it.it_interval.tv_nsec = 1000000;\n        it.it_value.tv_sec = 0;\n        it.it_value.tv_nsec = 1000000;\n\n        printf(\"timer start...\");\n        if (timer_settime(timer_id, 0, &amp;it, NULL) == -1) { /* if timer create success, start it */\n            printf(\"start timer failed!\\n\");\n            if (timer_delete(timer_id) == -1) {\n                printf(\"timer delete failed!\\n\");\n            }\n            return -1;\n        }\n    } else {\n        printf(\"fail to timer_create\");\n        return -1;\n    }\n\n    return 0;\n}\n\nint main(void)\n{\n    start_timer();\n    while(1){\n        sleep(1);\n    }\n}\n\n</code></pre>\n\n<p>When the timer is not timed correctly, after the program runs for 10s, the value of the variable <code>timer_thread_cnt</code> in the program is about 2000. By the way, if the timing is 10ms, there will be no problem. Does anyone know what the possible cause of this problem is.</p>\n"}, {"tags": ["c", "syntax", "declaration"], "comments": [{"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 1, "creation_date": 1558490727, "post_id": 56248357, "comment_id": 99114837, "body": "What language is this supposed to be? It is not C++."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1558490743, "post_id": 56248357, "comment_id": 99114839, "body": "Unrelated: <code>main</code> needs a return type of <code>int</code>"}, {"owner": {"reputation": 11, "user_id": 11536805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/433637ccee41a9d6fa3d3e8f6205962b?s=128&d=identicon&r=PG&f=1", "display_name": "Run911", "link": "https://stackoverflow.com/users/11536805/run911"}, "edited": false, "score": 0, "creation_date": 1558490834, "post_id": 56248357, "comment_id": 99114850, "body": "Gtuner IV 1.1 uses C like language will change tags. maybe should of asked on official forum instead of here. also dont need to return type &#39;int&#39; within GTuner, as its C like syntax."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1558491153, "post_id": 56248357, "comment_id": 99114898, "body": "What is <code>combo</code> ?  Where does code define it?"}, {"owner": {"reputation": 11, "user_id": 11536805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/433637ccee41a9d6fa3d3e8f6205962b?s=128&d=identicon&r=PG&f=1", "display_name": "Run911", "link": "https://stackoverflow.com/users/11536805/run911"}, "edited": false, "score": 0, "creation_date": 1558491417, "post_id": 56248357, "comment_id": 99114940, "body": "doesnt define it anywhere, so not really sure if I need to declare it and how. just started on it tonight. code runs but i just wanna see how it could be improved..."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1558493468, "post_id": 56248357, "comment_id": 99115279, "body": "Since this isn&#39;t C (for a large number of different reasons), the C tag should go.  But frankly, if there isn&#39;t a <a href=\"https://www.consoletuner.com/software/gtuner-iv/\" rel=\"nofollow noreferrer\">GTuner IV</a> tag on Stack Overflow (and there doesn&#39;t seem to be one), it&#39;s likely the question should be deleted here and asked elsewhere."}, {"owner": {"reputation": 11, "user_id": 11536805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/433637ccee41a9d6fa3d3e8f6205962b?s=128&d=identicon&r=PG&f=1", "display_name": "Run911", "link": "https://stackoverflow.com/users/11536805/run911"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1558493944, "post_id": 56248357, "comment_id": 99115372, "body": "bye @jonathan ...."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1558494002, "post_id": 56248357, "comment_id": 99115382, "body": "I&#39;d like to help; I&#39;d like you to be able to get help.  But there&#39;s not much precedent for it on SO.  Sorry.  There is always a first time for everything..."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 6496465, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qTQMemRvcYw/AAAAAAAAAAI/AAAAAAAAABU/bw6GBlharAM/photo.jpg?sz=128", "display_name": "Brian", "link": "https://stackoverflow.com/users/6496465/brian"}, "is_accepted": false, "score": 0, "last_activity_date": 1592836124, "creation_date": 1592836124, "answer_id": 62516757, "question_id": 56248357, "link": "https://stackoverflow.com/questions/56248357/declaration-syntax-error-in-gtuner-iv-function-after-compiling/62516757#62516757", "title": "Declaration syntax error in GTuner IV function after compiling", "body": "<p>Combos need to be declared outside of main{}</p>\n<p>`</p>\n<pre><code>bool toggle;\n\nmain {\n    if (event_active (BUTTON_2)) { \n        toggle = !toggle;\n        combo_stop(PressX);\n    }\n    if (toggle) {\n        combo_run(PressX); \n    }\n \n}\n\ncombo PressX {\n        set_val(BUTTON_16, 100.0); \n        wait(100);\n        wait(5000); \n}\n</code></pre>\n<p>`</p>\n"}], "owner": {"reputation": 11, "user_id": 11536805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/433637ccee41a9d6fa3d3e8f6205962b?s=128&d=identicon&r=PG&f=1", "display_name": "Run911", "link": "https://stackoverflow.com/users/11536805/run911"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1592836124, "creation_date": 1558490495, "last_edit_date": 1558493351, "question_id": 56248357, "link": "https://stackoverflow.com/questions/56248357/declaration-syntax-error-in-gtuner-iv-function-after-compiling", "title": "Declaration syntax error in GTuner IV function after compiling", "body": "<p>I'm using the GTuner language and the <a href=\"https://www.consoletuner.com/software/gtuner-iv/\" rel=\"nofollow noreferrer\">GTuner IV</a> 1.1 compiler.  My code seems to keep outputting the warning after compiling</p>\n\n<blockquote>\n  <p>GPC error: PressXInput.gpc(18): Declaration syntax error 'combo'</p>\n</blockquote>\n\n<p>Using GTuner to compile this (Titan Two)</p>\n\n<p>Any help to fix syntax declaration error, or even improvements on my code.</p>\n\n<p>Tried declaring 'combo' as a <code>bool/int</code> etc but still same error.</p>\n\n<pre><code>bool toggle;\n\nmain {\n    if (event_active (BUTTON_2)) { \n        toggle = !toggle;\n        combo_stop(PressX);\n    }\n    if (toggle) {\n        combo_run(PressX); \n    }\n    combo PressX {\n        set_val(BUTTON_16, 100.0); \n        wait(100);\n        wait(5000); \n    }\n}\n</code></pre>\n\n<p>Expected result should show no declaration syntax error with 'combo' after compiling.</p>\n"}, {"tags": ["python", "c"], "comments": [{"owner": {"reputation": 1281, "user_id": 6647585, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cac5dd1f2f2645dcc1dbf1165fed77c6?s=128&d=identicon&r=PG&f=1", "display_name": "Vlam", "link": "https://stackoverflow.com/users/6647585/vlam"}, "edited": false, "score": 0, "creation_date": 1558488590, "post_id": 56248141, "comment_id": 99114493, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1056051/how-do-you-call-python-code-from-c-code\">How do you call Python code from C code?</a>"}, {"owner": {"reputation": 607, "user_id": 1850909, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8dc1e2879e816591f40bdcae849e01d8?s=128&d=identicon&r=PG", "display_name": "lowtex", "link": "https://stackoverflow.com/users/1850909/lowtex"}, "edited": false, "score": 1, "creation_date": 1558489437, "post_id": 56248141, "comment_id": 99114624, "body": "Are you trying to call python on the pi from C code on the Arduino, to call python on the pi from C code on the pi, or run python code on the Arduino from C code also on the Arduino?"}], "answers": [{"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 0, "last_activity_date": 1558488621, "creation_date": 1558488621, "answer_id": 56248194, "question_id": 56248141, "link": "https://stackoverflow.com/questions/56248141/how-to-run-python-script-from-c/56248194#56248194", "title": "How to Run Python Script from C?", "body": "<p>Provided that you have python installed you can just use the <a href=\"http://man7.org/linux/man-pages/man3/system.3.html\" rel=\"nofollow noreferrer\"><code>system()</code></a> function and just call python directly, if you want more control like capturing program's output or giving input, and more interaction <a href=\"http://man7.org/linux/man-pages/man3/popen.3.html\" rel=\"nofollow noreferrer\"><code>popen()</code></a> is available for Arduino.</p>\n\n<p>Otherwise if you can link to the python library just use <a href=\"https://www.linuxjournal.com/article/8497\" rel=\"nofollow noreferrer\"><code>PyRun_SimpleString(code);</code></a>. The previous link has an example of how you need to setup the environment before actually calling this function.</p>\n"}, {"tags": [], "owner": {"reputation": 6521, "user_id": 7583953, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/w0Jkd.jpg?s=128&g=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/7583953/alec"}, "is_accepted": false, "score": 0, "last_activity_date": 1558488746, "creation_date": 1558488746, "answer_id": 56248205, "question_id": 56248141, "link": "https://stackoverflow.com/questions/56248141/how-to-run-python-script-from-c/56248205#56248205", "title": "How to Run Python Script from C?", "body": "<p><code>system()</code> allows you to call anything in python. <a href=\"https://www.linuxjournal.com/article/8497\" rel=\"nofollow noreferrer\">This link</a> goes into more depth if you want to interact with input or output.</p>\n\n<p>A really simple way to run any python script is to wrap it in a shell script and invoke it from within your C application</p>\n\n<p>For more info, view the docs: (<a href=\"https://docs.python.org/3/extending/\" rel=\"nofollow noreferrer\">1</a>, <a href=\"https://docs.python.org/2.0/ext/callingPython.html\" rel=\"nofollow noreferrer\">2</a>)</p>\n"}], "owner": {"reputation": 1, "user_id": 11525703, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cUmpbBWHZI4/AAAAAAAAAAI/AAAAAAAAAvc/Hcf5fH7ML0Q/photo.jpg?sz=128", "display_name": "Joonhyun Kim", "link": "https://stackoverflow.com/users/11525703/joonhyun-kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1558488869, "creation_date": 1558488040, "last_edit_date": 1558488869, "question_id": 56248141, "link": "https://stackoverflow.com/questions/56248141/how-to-run-python-script-from-c", "title": "How to Run Python Script from C?", "body": "<p>Does anybody know how to run a python script from C? </p>\n\n<p>Basically, I'm trying to make it so that when I press a button connected to my arduino, my arduino, which is connected to my raspberry pi 3B+, will run a python script which takes a photo.</p>\n\n<p>Does anybody know how to pull this off? Also, is there any simpler, easier way to do it? I don't know how to use the GPIO on raspberry pi.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1558488368, "post_id": 56248054, "comment_id": 99114465, "body": "It would really help if they told you <i>which</i> macro was already defined.  If you can edit the source, you could try adding <code>#undef  MAX</code> and <code>#undef MIN</code> before those first two defines.  If you still get the error, then the problem is somewhere else."}, {"owner": {"reputation": 29, "user_id": 10073689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce026278a4f20b154a1057d3206f79d?s=128&d=identicon&r=PG&f=1", "display_name": "Curiousmarble", "link": "https://stackoverflow.com/users/10073689/curiousmarble"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1558488653, "post_id": 56248054, "comment_id": 99114495, "body": "Alright, that did something....now im getting a different error from a different file: <a href=\"https://imgur.com/a/IvLjrdZ\" rel=\"nofollow noreferrer\">imgur.com/a/IvLjrdZ</a>"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1558489612, "post_id": 56248054, "comment_id": 99114653, "body": "That&#39;s not how this site works. You can&#39;t post links to off-site code, an image of an error, and expect us to solve the problem for you. You also can&#39;t post additional questions in the same post, whether it&#39;s in comments or the post itself. Please spend some time taking the <a href=\"https://stackoverflow.com/tour\">tour</a> and reading the <a href=\"https://stackoverflow.com/help\">help center</a> pages, particularly <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, to learn how to use this site properly."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1558490470, "post_id": 56248054, "comment_id": 99114792, "body": "C is a very simple language to learn. You can learn it in a few days of reading, if you know how to program. After a few days of work, you&#39;ll be able to understand the C code that you want to compile and to figure out what your error message means. In your case, it is a <i>very</i> simple thing; related to the <a href=\"https://en.wikipedia.org/wiki/C_preprocessor\" rel=\"nofollow noreferrer\">C preprocessor</a>. Start by reading that wikipage."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1558491343, "post_id": 56248054, "comment_id": 99114928, "body": "The most difficult things in C are pointers and <a href=\"https://en.wikipedia.org/wiki/C_dynamic_memory_allocation\" rel=\"nofollow noreferrer\">C dynamic memory allocation</a> and your error message is not related to them. It is a very simple error."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1558491470, "post_id": 56248054, "comment_id": 99114956, "body": "If you are not capable of understanding the <a href=\"https://en.wikipedia.org/wiki/C_preprocessor\" rel=\"nofollow noreferrer\">C preprocessor</a> wikipage, pay someone who can and who will help you. It is probably a one hour job to compile your old code for any person knowing C. You&#39;ll find many of them near you. Propose them 100$ or 100\u20ac for that one hour job. Put an ad in your vicinity offering that."}], "owner": {"reputation": 29, "user_id": 10073689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce026278a4f20b154a1057d3206f79d?s=128&d=identicon&r=PG&f=1", "display_name": "Curiousmarble", "link": "https://stackoverflow.com/users/10073689/curiousmarble"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558487201, "creation_date": 1558487201, "question_id": 56248054, "link": "https://stackoverflow.com/questions/56248054/recompiling-lightspeed-c-program-from-the-80s", "title": "Recompiling Lightspeed-C program from the 80&#39;s", "body": "<p>Im trying to recompile an old program called QLSconvert for the Kurzweil K250 synthesizer.<br>\nThe source code: <a href=\"https://www25.zippyshare.com/v/NLzuTUn6/file.html\" rel=\"nofollow noreferrer\">https://www25.zippyshare.com/v/NLzuTUn6/file.html</a> \nThe application runs in Lightspeed-C 3.0.1 at least in the emulator that im using, Vmac mini, with a mac ii ROM and system 6.<br>\nThe error im getting when trying to recompile is:<br>\n\"macro name is already #define'd\"<br>\nI'm not too familiar with C to be honest, so any tips on how to resolve this error would be super useful.<br>\nI can only share an image of the error and not type it out:<br>\n<a href=\"https://imgur.com/a/j4vleWd\" rel=\"nofollow noreferrer\">https://imgur.com/a/j4vleWd</a><br>\nAnother question I have is, I need to be able to compile this program in 32-bit, as it is currently a 24-bit addressing application.<br>\nI'm not sure if it can be done with Lightspeed-C 3.0.1 or if I would need Think C 5.0.1, which is the first version to apparently be able to create 32-bit apps.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1558487067, "post_id": 56248025, "comment_id": 99114276, "body": "Be sure to read about <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11496422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03abd69d0737a280196edd6e32856365?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Al-Khateeb", "link": "https://stackoverflow.com/users/11496422/ahmed-al-khateeb"}, "edited": false, "score": 0, "creation_date": 1558518040, "post_id": 56248135, "comment_id": 99124759, "body": "I&#39;m really sorry for the unorganized code I did the thing is I cant copy the whole code (or can I) idk its my second time in this page but the guy above answered it"}], "tags": [], "owner": {"reputation": 1463, "user_id": 2299087, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KWtlB.jpg?s=128&g=1", "display_name": "James McPherson", "link": "https://stackoverflow.com/users/2299087/james-mcpherson"}, "is_accepted": false, "score": 0, "last_activity_date": 1558488001, "creation_date": 1558488001, "answer_id": 56248135, "question_id": 56248025, "link": "https://stackoverflow.com/questions/56248025/its-only-displays-one-hotel-reservation/56248135#56248135", "title": "Its only displays one Hotel reservation", "body": "<p>At the start of your function, you initialize <code>rec = count</code> - but at that point <code>count</code> is undefined (as far as can be determined, because you haven't provided the full code - are they both global variables?).</p>\n\n<p>In addition, you're reading from stdin for some parts, but from an open file descriptor (<code>fp</code>) for others - but there's no association between them.</p>\n\n<p>Please rethink your example and update the post - the structure is confusing and salient details are missing.</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 11496422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03abd69d0737a280196edd6e32856365?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Al-Khateeb", "link": "https://stackoverflow.com/users/11496422/ahmed-al-khateeb"}, "edited": false, "score": 0, "creation_date": 1558518098, "post_id": 56249566, "comment_id": 99124782, "body": "Thank you very much and sorry for the unorganized code"}], "tags": [], "owner": {"reputation": 696, "user_id": 4509587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V_piLk0zquY/AAAAAAAAAAI/AAAAAAAAAa0/B8dT_Qc51vA/photo.jpg?sz=128", "display_name": "Samyak Jain", "link": "https://stackoverflow.com/users/4509587/samyak-jain"}, "is_accepted": true, "score": 0, "last_activity_date": 1558501063, "creation_date": 1558501063, "answer_id": 56249566, "question_id": 56248025, "link": "https://stackoverflow.com/questions/56248025/its-only-displays-one-hotel-reservation/56249566#56249566", "title": "Its only displays one Hotel reservation", "body": "<p>your count and rec is undefined and as they were not initialised.</p>\n\n<p>Do read Id first before comparing it.</p>\n\n<pre><code> fread(&amp;temp-&gt;id, sizeof(int), 1, fp); \n  printf(\"\\niD: %d\\n\", temp-&gt;id);\n  if (choice == temp-&gt;id) {\n\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11496422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03abd69d0737a280196edd6e32856365?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Al-Khateeb", "link": "https://stackoverflow.com/users/11496422/ahmed-al-khateeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 56249566, "answer_count": 2, "score": 1, "last_activity_date": 1558503686, "creation_date": 1558486897, "last_edit_date": 1558503686, "question_id": 56248025, "link": "https://stackoverflow.com/questions/56248025/its-only-displays-one-hotel-reservation", "title": "Its only displays one Hotel reservation", "body": "<p>I'm doing a hotel reservation so i'm trying to display the reservation using the iD that the user inserted but I can't get it the program just freezes with no error or anything i tried many things and looked online could not find the answer. i tried doing an while inside the if loop it also did not work cant figur out where the problem is.\nThanks. </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void display(char *a)\n{\n    FILE *fp;\n    rec = count;\n    int choice;\n    fp = fopen(a ,\"r\");\n    struct  hotelStruct *temp = (struct hotelStruct *)malloc(sizeof(struct hotelStruct));\n    temp-&gt;first_name = (char *)malloc(10* sizeof(char));\n    temp-&gt;last_name = (char *)malloc(15*sizeof(char));\n    temp-&gt;passport = (char *)malloc(15*sizeof(char));\n    temp-&gt;nationality = (char *)malloc(30*sizeof(char));\n    temp-&gt;room = (char *)malloc(10*sizeof(char));\n    temp-&gt;email = (char *)malloc(30*sizeof(char));\n    if (fp == NULL)\n        printf(\"Error!!\");\n    printf(\"\\nEnter your Reservations iD:\\n\");\n    scanf(\"%d\", &amp;choice);\n    fseek(fp, 0, 0);\n\n    while (rec)\n    {\n\n\n        if (choice == temp-&gt;id) {\n            fread(&amp;temp-&gt;id, sizeof(int), 1, fp);\n            printf(\"\\niD: %d\\n\", temp-&gt;id);\n\n            fread(temp-&gt;first_name, 10, 1, fp);\n            printf(\"First Name: %s\\n\", temp-&gt;first_name);\n\n            fread(temp-&gt;last_name, 15, 1, fp);\n            printf(\"Last name: %s\\n\", temp-&gt;last_name);\n\n            fread(temp-&gt;passport, 15, 1, fp);\n            printf(\"Passport: %s\\n\", temp-&gt;passport);\n\n            fread(temp-&gt;nationality, 30, 1, fp);\n            printf(\"Nationality: %s\\n\", temp-&gt;nationality);\n\n            fread(temp-&gt;room, 10, 1, fp);\n            printf(\"Room: %s\\n\", temp-&gt;room);\n\n            fread(&amp;temp-&gt;bed, sizeof(int), 1, fp);\n            printf(\"Beds: %d\\n\", temp-&gt;bed);\n\n            fread(temp-&gt;email, 30, 1, fp);\n            printf(\"Email: %s\\n\", temp-&gt;email);\n\n            fread(&amp;temp-&gt;phone_number, sizeof(int), 1, fp);\n            printf(\"Phone number: %d\\n\\n\\n\", temp-&gt;phone_number);\n        }\n        rec--;\n    }\n    fclose(fp);\n    free(temp);\n    free(temp-&gt;first_name);\n    free(temp-&gt;last_name);\n    free(temp-&gt;passport);\n    free(temp-&gt;room);\n    free(temp-&gt;email);\n    free(temp-&gt;nationality);\n}\n</code></pre>\n"}, {"tags": ["c", "unix", "compilation", "solaris"], "comments": [{"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1558485278, "post_id": 56247627, "comment_id": 99113984, "body": "I would not be too optimistic that you can get this to work. See this question for details: <a href=\"https://stackoverflow.com/questions/16197109/generate-header-file-h-for-on-shared-library-file-so\" title=\"generate header file h for on shared library file so\">stackoverflow.com/questions/16197109/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9872609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da006d284f45d9d93f06f4131c28565c?s=128&d=identicon&r=PG&f=1", "display_name": "Abraham Macias", "link": "https://stackoverflow.com/users/9872609/abraham-macias"}, "edited": false, "score": 0, "creation_date": 1558483946, "post_id": 56247660, "comment_id": 99113768, "body": "Thanks for the answer, I have only the libprofile.a file wich is the compilated library, seraching in the server I found the libprofile.h file, but its incomplete because it has only two structs declarated, but it doesn&#180;t have the functions that the program leemsgs.c needs, I tried to compile it with this line cc leemsgs.c -L. -llibprofile -o leemsgs but this is the error    &quot;leemsgs.c&quot;, line 270: warning: implicit function declaration: ReadConfig. Then I need the complete version of libprofile.h file where this and others functions are declarated?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 5, "user_id": 9872609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da006d284f45d9d93f06f4131c28565c?s=128&d=identicon&r=PG&f=1", "display_name": "Abraham Macias", "link": "https://stackoverflow.com/users/9872609/abraham-macias"}, "edited": false, "score": 0, "creation_date": 1558484876, "post_id": 56247660, "comment_id": 99113932, "body": "@AbrahamMacias If you already have the program just provide the adequate prototypes yourself from the functions and it will work provided you link correctly to the library"}, {"owner": {"reputation": 5, "user_id": 9872609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da006d284f45d9d93f06f4131c28565c?s=128&d=identicon&r=PG&f=1", "display_name": "Abraham Macias", "link": "https://stackoverflow.com/users/9872609/abraham-macias"}, "edited": false, "score": 0, "creation_date": 1558564991, "post_id": 56247660, "comment_id": 99148039, "body": "Thanks John, I can understand now."}], "tags": [], "owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "is_accepted": false, "score": 1, "last_activity_date": 1558482824, "creation_date": 1558482824, "answer_id": 56247660, "question_id": 56247627, "link": "https://stackoverflow.com/questions/56247627/can-i-compile-a-c-program-which-depends-of-a-library-but-this-library-isn%c2%b4t-a/56247660#56247660", "title": "Can I compile a C program which depends of a library, but this library isn&#180;t a .h file is a binary file, because it was compiled anteriority?", "body": "<p>If you know the functions in the library you can make your own <code>library.h</code> that will allow the compiler to succeed and then you just need the linker to ensure <code>library.o</code> (or <code>.a</code> or...) is linked in.</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 9872609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da006d284f45d9d93f06f4131c28565c?s=128&d=identicon&r=PG&f=1", "display_name": "Abraham Macias", "link": "https://stackoverflow.com/users/9872609/abraham-macias"}, "edited": false, "score": 0, "creation_date": 1558550297, "post_id": 56247849, "comment_id": 99142483, "body": "Thanks for the answer, Then  I need both things the header file for put it in the code by a #include, and the implementation in this case is in the profile.a file, this can&#180;t  work only with the profile.a file, too is necesary put the #include &quot;profile.h&quot;?"}, {"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "reply_to_user": {"reputation": 5, "user_id": 9872609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da006d284f45d9d93f06f4131c28565c?s=128&d=identicon&r=PG&f=1", "display_name": "Abraham Macias", "link": "https://stackoverflow.com/users/9872609/abraham-macias"}, "edited": false, "score": 0, "creation_date": 1558550936, "post_id": 56247849, "comment_id": 99142780, "body": "Yes, including the header file is necessary. As @John3136 mentioned in his answer, you could create the header file yourself if you knew the functions declarations of the library functions you use in your your code, but typically you should receive this info with the binary of the libarary in a form of a header file."}, {"owner": {"reputation": 5, "user_id": 9872609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da006d284f45d9d93f06f4131c28565c?s=128&d=identicon&r=PG&f=1", "display_name": "Abraham Macias", "link": "https://stackoverflow.com/users/9872609/abraham-macias"}, "edited": false, "score": 1, "creation_date": 1558564875, "post_id": 56247849, "comment_id": 99148019, "body": "That is the problem, they don&#39;t have the profile.h file complete, and I can&#39;t suppose how the functions of this library works because I dont know the functions declarations, I need the complete code to understand how does it works. Well thank you very much to you and @John3136."}], "tags": [], "owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "is_accepted": true, "score": 1, "last_activity_date": 1558484920, "creation_date": 1558484920, "answer_id": 56247849, "question_id": 56247627, "link": "https://stackoverflow.com/questions/56247627/can-i-compile-a-c-program-which-depends-of-a-library-but-this-library-isn%c2%b4t-a/56247849#56247849", "title": "Can I compile a C program which depends of a library, but this library isn&#180;t a .h file is a binary file, because it was compiled anteriority?", "body": "<p>If your program is using a function <code>func()</code> from this external compiled library then you'd need to have:</p>\n\n<ol>\n<li><code>func()</code> <strong>declaration</strong> - typically it will be in a header file, (which typically is provided with the library). If this file is called <code>profile.h</code> you'd <code>#include</code> it from the source code in your program that is calling <code>func()</code>.</li>\n<li><code>func()</code> <strong>definition</strong> - the implementation of this function - although you cannot see it, it must be in the binary of this library. You can verify it by running the <code>nm libprofile.a</code> which will show you the library's functions names (although sometimes it might not display them if its symbols were stripped when compiled).</li>\n</ol>\n\n<p>If you don't have the <strong>declaration</strong> - your code wouldn't compile.</p>\n\n<p>If you don't have the <strong>definition</strong> - your code wouldn't link.</p>\n"}], "owner": {"reputation": 5, "user_id": 9872609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da006d284f45d9d93f06f4131c28565c?s=128&d=identicon&r=PG&f=1", "display_name": "Abraham Macias", "link": "https://stackoverflow.com/users/9872609/abraham-macias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 56247849, "answer_count": 2, "score": 0, "last_activity_date": 1558484920, "creation_date": 1558482507, "question_id": 56247627, "link": "https://stackoverflow.com/questions/56247627/can-i-compile-a-c-program-which-depends-of-a-library-but-this-library-isn%c2%b4t-a", "title": "Can I compile a C program which depends of a library, but this library isn&#180;t a .h file is a binary file, because it was compiled anteriority?", "body": "<p>Hello everyone the problem is the next , I have a program in C (program_a.c) this program deppends some functions that it doesn\u00b4t have declarated in his body, because this functions are in another file (library.h), but I dont have the file .h or file .c only I have the version compilated  wich is a binary file. Can i compile my program and make use of this library that isn\u00b4t a .h or .c file?</p>\n"}, {"tags": ["c", "function", "pointers", "reference"], "comments": [{"owner": {"reputation": 337, "user_id": 8952646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd2b924ba57e7db4a4029b0a9bf510b?s=128&d=identicon&r=PG&f=1", "display_name": "isragram", "link": "https://stackoverflow.com/users/8952646/isragram"}, "edited": false, "score": 0, "creation_date": 1558483514, "post_id": 56247615, "comment_id": 99113703, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/27458825/is-it-possible-to-swap-the-addresses-of-two-variables\">Is it possible to swap the addresses of two variables?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 337, "user_id": 8952646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd2b924ba57e7db4a4029b0a9bf510b?s=128&d=identicon&r=PG&f=1", "display_name": "isragram", "link": "https://stackoverflow.com/users/8952646/isragram"}, "is_accepted": false, "score": 0, "last_activity_date": 1558483354, "creation_date": 1558483354, "answer_id": 56247717, "question_id": 56247615, "link": "https://stackoverflow.com/questions/56247615/can-i-swap-two-matrixes-with-a-function-just-interchanging-its-base-address-wit/56247717#56247717", "title": "Can I swap two matrixes with a function just interchanging its base address, without swapping element by element?", "body": "<p>No, that's not possible. You can't choose the addresses of variables or modify them either. </p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9700571, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oriLxQSf_NI/AAAAAAAAAAI/AAAAAAAAAGQ/d5sw9fMXak4/photo.jpg?sz=128", "display_name": "B-Mo", "link": "https://stackoverflow.com/users/9700571/b-mo"}, "is_accepted": false, "score": 0, "last_activity_date": 1558483748, "creation_date": 1558483748, "answer_id": 56247753, "question_id": 56247615, "link": "https://stackoverflow.com/questions/56247615/can-i-swap-two-matrixes-with-a-function-just-interchanging-its-base-address-wit/56247753#56247753", "title": "Can I swap two matrixes with a function just interchanging its base address, without swapping element by element?", "body": "<p>If M1 and M2 are pointers to your matrices then <code>swapMatrix</code> in option 1 would work except the pointer operations are a bit off. You need to swap the value pointed at by <code>a</code> and <code>b</code> (i.e. the address of each matrix) but you're just swapping the value of <code>a</code> and <code>b</code>(i.e. changing which pointer to matrix your local parameter is pointing to). Try something like:</p>\n\n<pre><code>void swapMatrix(int** a, int** b){\n    int* tmp = *a;\n    *a = *b;\n    *b = tmp;\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9383634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40bb8c3b02e7893292a58f289a799b69?s=128&d=identicon&r=PG&f=1", "display_name": "Benuck", "link": "https://stackoverflow.com/users/9383634/benuck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1558483748, "creation_date": 1558482398, "question_id": 56247615, "link": "https://stackoverflow.com/questions/56247615/can-i-swap-two-matrixes-with-a-function-just-interchanging-its-base-address-wit", "title": "Can I swap two matrixes with a function just interchanging its base address, without swapping element by element?", "body": "<p><strong>Summary</strong></p>\n\n<p>It is just a doubt that came when studying about pointers, can I swap two matrixes using a function without needing to swap element by element in it?</p>\n\n<p>I've created 2 matrixes dynamically, using malloc, and declared its elements` values in main(). So, I could swap like this:</p>\n\n<p>(Swapping element by element)</p>\n\n<pre><code>void swapMatrix(int** a, int** b){\n    for(int i = 0; i&lt; row; i++){\n        for(int j = 0; j&lt; col; j++){\n            int tmp = a[i][j];\n            a[i][j] = b[i][j];\n            b[i][j] = tmp;\n        }\n    }\n}\n...\nint main() {\n...\nprint(M1);\nswapMatrix(M1, M2);\nprint(M1);\n...\n</code></pre>\n\n<p>(Swapping row by row)</p>\n\n<pre><code>void swapMatrix(int** a, int** b){\n    int* tmp = *a;\n    *a = *b;\n    *b = tmp;\n    for (int i = 0; i&lt;col; i++){\n        int* tmp = *(a+i);\n        *(a+i) = *(b+i);\n        *(b+i) = tmp;\n    }\n}\n...\nint main() {\n...\nprint(M1);\nswapMatrix(M1, M2);\nprint(M1);\n...\n</code></pre>\n\n<p><strong>The Attempts</strong></p>\n\n<p>But is there a way to just change the matrix pointer to pointer address? I've attempted the following codes:</p>\n\n<p><strong>I)</strong></p>\n\n<pre><code>void swapMatrix(int** a, int** b){\n    int** tmp = a;\n    a = b;\n    b = tmp;\n}\n...\nint main() {\n...\nprint(M1);\nswapMatrix(M1, M2);\nprint(M1);\n...\n</code></pre>\n\n<p>It compiled but when I verified its elements, none of them really swapped</p>\n\n<p><strong>II)</strong></p>\n\n<pre><code>void swapMatrix(int*** a, int*** b){\n    int*** tmp = a;\n    a = b;\n    b = tmp;\n\n...\nint main() {\n...\nprint(M1);\nswapMatrix(&amp;M1, &amp;M2);\nprint(M1);\n...\n</code></pre>\n\n<p>Again, it compiled but when I verified its elements, none of them really swapped.</p>\n\n<p>How should I implement the function in order to swap the entire matrix just changing a pointer to pointer address? Is it possible? Actually, I don't really understand why the I) attempt didn't work. I would really appreciate if you could explain the details.</p>\n"}, {"tags": ["c", "camera", "computer-vision", "stm32", "vision"], "comments": [{"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1558482375, "post_id": 56247436, "comment_id": 99113506, "body": "Adaptive thresholding is pretty trivial. If you know how it\u2019s done, I bet it would be faster to implement it than porting a big library like OpenCV. Also OpenCV is C++, not C."}, {"owner": {"reputation": 2383, "user_id": 2705382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6648343abb3b27a12cafef7ee1ede72?s=128&d=identicon&r=PG&f=1", "display_name": "andrew", "link": "https://stackoverflow.com/users/2705382/andrew"}, "edited": false, "score": 0, "creation_date": 1558554648, "post_id": 56247436, "comment_id": 99144394, "body": "If you want to make your own adaptive threshold look up &quot;Otsu&#39;s method&quot; It&#39;s a fairly standard algorithm. As background it assumes bimodal data and reduces intra-class variance. Your exact answer is highly dependent on your exact setup. How are you reading the data, is it RGB,HSY? Are you finding blobs by color? grayscale? All this information will change the solution. If you can update your question with details and maybe code of your image buffer this will help others understand your problem"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1558561006, "post_id": 56247436, "comment_id": 99146994, "body": "Stackoverflow.com is not a free design service."}], "answers": [{"comments": [{"owner": {"reputation": 3818, "user_id": 4451521, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/4b19b54142d820aad565ca95f920c11c?s=128&d=identicon&r=PG", "display_name": "KansaiRobot", "link": "https://stackoverflow.com/users/4451521/kansairobot"}, "edited": false, "score": 0, "creation_date": 1573892907, "post_id": 56252166, "comment_id": 104043868, "body": "Yes, that is true. Implementing Adaptive thresholding is not that difficult. (Take into account that I have done it using mbed which makes it easier, and let me focus on implementing the algorithm). Also as Tarick says don&#39;t use dynamic memory"}], "tags": [], "owner": {"reputation": 2568, "user_id": 8548828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C4qkl.png?s=128&g=1", "display_name": "Tarick Welling", "link": "https://stackoverflow.com/users/8548828/tarick-welling"}, "is_accepted": true, "score": 1, "last_activity_date": 1558512750, "creation_date": 1558512750, "answer_id": 56252166, "question_id": 56247436, "link": "https://stackoverflow.com/questions/56247436/processing-an-image-on-stm32-c/56252166#56252166", "title": "Processing an image on STM32 - C", "body": "<p>Writing your own functions is trivial. I have done minor on the subject and we had about 8 weeks to do it. </p>\n\n<p>Porting OpenCV is not a good idea. It uses dynamic memory allocation everywhere which makes conservative use impossible and is written in C++.</p>\n\n<p>Adaptive tresholding would take max a week of effort.</p>\n"}, {"tags": [], "owner": {"reputation": 1609, "user_id": 11530294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Wmx8FmXvssw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rddovKe67tDYNr2B-3B5bFJOj8cZg/mo/photo.jpg?sz=128", "display_name": "Dr Yuan Shenghai", "link": "https://stackoverflow.com/users/11530294/dr-yuan-shenghai"}, "is_accepted": false, "score": 0, "last_activity_date": 1558647515, "creation_date": 1558647515, "answer_id": 56283258, "question_id": 56247436, "link": "https://stackoverflow.com/questions/56247436/processing-an-image-on-stm32-c/56283258#56283258", "title": "Processing an image on STM32 - C", "body": "<p>You shouldn`t try to implement everything from zero</p>\n\n<p>Try the opensource implementation first. If you can think about sth, that means some 1 else already did it. Someone else has done it. </p>\n\n<p>See this link for details.</p>\n\n<p><a href=\"http://shervinemami.info/embeddedVision.html\" rel=\"nofollow noreferrer\">http://shervinemami.info/embeddedVision.html</a></p>\n"}], "owner": {"reputation": 5, "user_id": 11313857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/005e9c559b881ec7a28456d2025ddb97?s=128&d=identicon&r=PG&f=1", "display_name": "ningbo", "link": "https://stackoverflow.com/users/11313857/ningbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1421, "favorite_count": 0, "accepted_answer_id": 56252166, "answer_count": 2, "score": 0, "last_activity_date": 1558647515, "creation_date": 1558480770, "question_id": 56247436, "link": "https://stackoverflow.com/questions/56247436/processing-an-image-on-stm32-c", "title": "Processing an image on STM32 - C", "body": "<p>I am doing some blob analysis on an embedded STM32H7 platform using C.</p>\n\n<p>What do you think would be best way to accomplish this? Would it be possible to port openCV to STM32 and use those functions maybe? Let say I just want to use adaptive thresholding, would it be better to just write my own code for that or use some library that is already there?</p>\n\n<p>Just to point out that I am obligated to use C. I know about some Python libraries for STM32 but I must use C for this project.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c", "arrays", "pointers", "dynamic", "heap-memory"], "comments": [{"owner": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "edited": false, "score": 0, "creation_date": 1558482965, "post_id": 56247427, "comment_id": 99113619, "body": "The last line in changePtr()  looks fishy. You are assigning a pointer to an array that was created locally. When the function returns, the array will go out of scope, thus you are pointing at a memory location that does not belong to your program. Best thing to do is to attach a debugger and run the program step by step."}, {"owner": {"reputation": 1430, "user_id": 5739619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dc9137cd10cc63c14d4c774bc81ef98a?s=128&d=identicon&r=PG&f=1", "display_name": "user5739619", "link": "https://stackoverflow.com/users/5739619/user5739619"}, "reply_to_user": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "edited": false, "score": 0, "creation_date": 1558484533, "post_id": 56247427, "comment_id": 99113876, "body": "I pasted new code into the OP. I am getting garbage values now in <code>ptr</code>. Why is this?"}, {"owner": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "edited": false, "score": 0, "creation_date": 1558485153, "post_id": 56247427, "comment_id": 99113967, "body": "In your printf you use the %f modifier, try using the %lf modifier and check the results again (%f is for floats, doubles need %lf)."}, {"owner": {"reputation": 1430, "user_id": 5739619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dc9137cd10cc63c14d4c774bc81ef98a?s=128&d=identicon&r=PG&f=1", "display_name": "user5739619", "link": "https://stackoverflow.com/users/5739619/user5739619"}, "reply_to_user": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "edited": false, "score": 0, "creation_date": 1558485271, "post_id": 56247427, "comment_id": 99113983, "body": "I still get the garbage values with <code>%lf</code>"}, {"owner": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "edited": false, "score": 1, "creation_date": 1558485580, "post_id": 56247427, "comment_id": 99114029, "body": "Have you tried using printf inside the function right before it returns? Do you still get garbage values?"}, {"owner": {"reputation": 1430, "user_id": 5739619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dc9137cd10cc63c14d4c774bc81ef98a?s=128&d=identicon&r=PG&f=1", "display_name": "user5739619", "link": "https://stackoverflow.com/users/5739619/user5739619"}, "reply_to_user": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "edited": false, "score": 0, "creation_date": 1558485835, "post_id": 56247427, "comment_id": 99114067, "body": "Yes, inside the <code>changePtr</code>, it correctly outputs 11 and 12"}, {"owner": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "edited": false, "score": 0, "creation_date": 1558486051, "post_id": 56247427, "comment_id": 99114092, "body": "Just in case, check the address of ptr before, during and after the function, you might get a dangling pointer after the function returns. Also you have a memory leak in changePtr. You never free the s1 pointer."}, {"owner": {"reputation": 1430, "user_id": 5739619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dc9137cd10cc63c14d4c774bc81ef98a?s=128&d=identicon&r=PG&f=1", "display_name": "user5739619", "link": "https://stackoverflow.com/users/5739619/user5739619"}, "reply_to_user": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "edited": false, "score": 0, "creation_date": 1558486459, "post_id": 56247427, "comment_id": 99114158, "body": "the address of the pointer changes from before and during the function, but then its address after the function is the same as it was before the function"}, {"owner": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "edited": false, "score": 0, "creation_date": 1558487444, "post_id": 56247427, "comment_id": 99114333, "body": "That means the previous values were overwritten with garbage values after you called free. When a memory location is freed, it doesn&#39;t belong to your program anymore and can be overwritten by another application that has claimed that memory location. When the function returns, the pointer that you previously freed returns back to that location and now points at a memory section that does not belong to your program and contains garbage..."}, {"owner": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "edited": false, "score": 0, "creation_date": 1558487462, "post_id": 56247427, "comment_id": 99114337, "body": "... In c/c++ the moment you free/delete a memory location the data it contains can be changed anytime without the ability of recovering it back. If you move the contents of the function in main(), most likely you won&#39;t run in to that problem, it&#39;s just the function that returns the pointer to the old invalid location. BTW if you are using C99 (I think it also applies to C89) you don&#39;t need to cast the result of malloc(). For more details see <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\" title=\"do i cast the result of malloc\">stackoverflow.com/questions/605845/&hellip;</a>"}, {"owner": {"reputation": 1430, "user_id": 5739619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dc9137cd10cc63c14d4c774bc81ef98a?s=128&d=identicon&r=PG&f=1", "display_name": "user5739619", "link": "https://stackoverflow.com/users/5739619/user5739619"}, "reply_to_user": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "edited": false, "score": 0, "creation_date": 1558487618, "post_id": 56247427, "comment_id": 99114359, "body": "how could I change the code so that when the function returns, the pointer doesn&#39;t return to that location I had freed and instead points to the new location?"}, {"owner": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "edited": false, "score": 0, "creation_date": 1558487754, "post_id": 56247427, "comment_id": 99114378, "body": "You could probably try to save the address of the new location in the function and return it either by value or by using a parameter. Not sure if it will work though. Something like returnAddress = &amp;ptr; return returnAddress; Obviously you need to change the return type to int from void."}, {"owner": {"reputation": 205, "user_id": 7938632, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93df02026e4ebe6223ece9b8c02f2002?s=128&d=identicon&r=PG&f=1", "display_name": "John M.", "link": "https://stackoverflow.com/users/7938632/john-m"}, "edited": false, "score": 0, "creation_date": 1558488240, "post_id": 56247427, "comment_id": 99114443, "body": "Sorry I meant int * not int."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1558492017, "post_id": 56247427, "comment_id": 99115059, "body": "C uses pass by value , you are passing <code>ptr</code> by value to the function which means the function receives a copy of <code>ptr</code>. You seem to expect that <code>ptr = bla;</code> in the function will have some effect on <code>main</code>, this is not true"}, {"owner": {"reputation": 1430, "user_id": 5739619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dc9137cd10cc63c14d4c774bc81ef98a?s=128&d=identicon&r=PG&f=1", "display_name": "user5739619", "link": "https://stackoverflow.com/users/5739619/user5739619"}, "edited": false, "score": 0, "creation_date": 1558501315, "post_id": 56247427, "comment_id": 99116718, "body": "so then how do I pass the pointer by reference in C?"}], "answers": [{"comments": [{"owner": {"reputation": 1430, "user_id": 5739619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dc9137cd10cc63c14d4c774bc81ef98a?s=128&d=identicon&r=PG&f=1", "display_name": "user5739619", "link": "https://stackoverflow.com/users/5739619/user5739619"}, "edited": false, "score": 0, "creation_date": 1558484543, "post_id": 56247664, "comment_id": 99113882, "body": "I pasted new code into the OP. I am getting garbage values now in <code>ptr</code>. Why is this?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6576367"}, "reply_to_user": {"reputation": 1430, "user_id": 5739619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dc9137cd10cc63c14d4c774bc81ef98a?s=128&d=identicon&r=PG&f=1", "display_name": "user5739619", "link": "https://stackoverflow.com/users/5739619/user5739619"}, "edited": false, "score": 0, "creation_date": 1558486644, "post_id": 56247664, "comment_id": 99114191, "body": "@user5739619 updated my answer. Please visit the link I provided in Edit 1. Also, here you can find a nice read about <code>pointers</code> in C: <a href=\"https://beginnersbook.com/2014/01/c-pointers/\" rel=\"nofollow noreferrer\">beginnersbook.com/2014/01/c-pointers</a>"}, {"owner": {"reputation": 1430, "user_id": 5739619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dc9137cd10cc63c14d4c774bc81ef98a?s=128&d=identicon&r=PG&f=1", "display_name": "user5739619", "link": "https://stackoverflow.com/users/5739619/user5739619"}, "edited": false, "score": 0, "creation_date": 1558486950, "post_id": 56247664, "comment_id": 99114254, "body": "Thanks for the links. So does <code>ptr</code> now only contain 2 values, right? After I delete that line you mentioned, and then printed out the values in <code>ptr</code>, it shows the correct values for <code>ptr[0]</code> and <code>ptr[1]</code> and then a garbage value for <code>ptr[2]</code>. When I tried to print the size of it with <code>printf(&quot;%d&quot;, sizeof(ptr))</code>, it shows 8 and <code>printf(&quot;%d&quot;, sizeof(ptr)&#47;sizeof(ptr[0])</code> shows 1."}, {"owner": {"reputation": 1430, "user_id": 5739619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dc9137cd10cc63c14d4c774bc81ef98a?s=128&d=identicon&r=PG&f=1", "display_name": "user5739619", "link": "https://stackoverflow.com/users/5739619/user5739619"}, "edited": false, "score": 1, "creation_date": 1558488682, "post_id": 56247664, "comment_id": 99114500, "body": "So if I do <code>free(ptr)</code> and then <code>ptr[i]=s1[i]</code>, that reassigns the address that <code>ptr</code> points to, right? If so, why would doing that without removing <code>ptr = (double *) malloc(sizeof(double) * 2)</code> &quot;have no influence on the previous address which ptr held&quot;?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6576367"}, "reply_to_user": {"reputation": 1430, "user_id": 5739619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dc9137cd10cc63c14d4c774bc81ef98a?s=128&d=identicon&r=PG&f=1", "display_name": "user5739619", "link": "https://stackoverflow.com/users/5739619/user5739619"}, "edited": false, "score": 0, "creation_date": 1558488799, "post_id": 56247664, "comment_id": 99114523, "body": "@user5739619 updated my answer. You should re-read my <b>Edit 2</b> and <b>Edit 3</b>. I would highly recommend you to read about pointers thoroughly. You will then be able to answer all your questions yourself, trust me. :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6576367"}, "is_accepted": false, "score": 2, "last_activity_date": 1558490375, "last_edit_date": 1558490375, "creation_date": 1558482892, "answer_id": 56247664, "question_id": 56247427, "link": "https://stackoverflow.com/questions/56247427/how-to-reassign-pointer-to-smaller-array-in-c/56247664#56247664", "title": "How to reassign pointer to smaller array in C?", "body": "<p><strong>Edit 1</strong></p>\n\n<p>To your original question: </p>\n\n<p>Short answer: Yes, you can reassign a pointer to a smaller array in C.</p>\n\n<p>Long answer: The short answer is misleading. Arrays are also simply pointers in C. And for a better understanding of this concept, you might want to read <a href=\"https://softwareengineering.stackexchange.com/questions/17898/whats-a-nice-explanation-for-pointers\">this thread</a>, especially take a look at <a href=\"https://softwareengineering.stackexchange.com/questions/17898/whats-a-nice-explanation-for-pointers#17905\">this answer</a>.</p>\n\n<hr>\n\n<p>The problem is that you try to de-allocate the memory on <code>stack</code>.</p>\n\n<p>Whenever you create a local variable, \u00e0 la <code>int a = 5</code>, it's pushed on the stack, that is this variable gets memory allocated on stack and after the function call (<code>main()</code>) is over the memory is de-allocated - all this happens automatically! </p>\n\n<p>In your case, here is what happens:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>// memory is allocated automatically on stack for the local variable \"s\"\ndouble s[3]={1,2,3};\n\n// assign the stack address of \"s\" to \"ptr\"\nptr = s;\n\n// de-allocate the managed stack address of \"s\", which is NOT allowed!\nfree(ptr);\n</code></pre>\n\n<p>Creating dynamic memory, e.g. via <code>malloc</code>, on the other hand happens in the <code>heap</code> memory, which needs to be managed by the programmer, that is allocating (<code>malloc()</code>) and de-allocating (<code>free()</code>) memory is allowed and must be done with great care.</p>\n\n<p>So, in your programm when it hits this line <code>free(ptr);</code>, the assertion fails, because the target memory address doesn't meet the requirement -> <code>IsValidHeapPointer</code>: No <code>ptr</code> is not a valid heap pointer, because it holds the stack address of the <code>s</code> variable at that point. :)</p>\n\n<hr>\n\n<p><strong>Edit 2</strong></p>\n\n<blockquote>\n  <p>I get garbage values like -1456815990147....1 when I print out the values of ptr after calling changePtr. Why is this?</p>\n</blockquote>\n\n<p>It's because, you free the memory of <code>ptr</code> in <code>changePtr(ptr)</code> first, that is the content of <code>ptr</code> is written with some \"garbage\" value.</p>\n\n<p>And then here you allocate new memory and assign it to <code>ptr</code>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>ptr = (double *) malloc(sizeof(double) * 2); \n</code></pre>\n\n<p>After this point, the changes you make via <code>ptr</code> (i.e. <code>ptr[i] = 12</code>) has no influence on the previous address which <code>ptr</code> held. So, simply remove the <code>free(ptr)</code> and the above line, you don't need them.</p>\n\n<hr>\n\n<p><strong>Edit 3</strong></p>\n\n<blockquote>\n  <p>So does <code>ptr</code> now only contain 2 values, right? After I delete that line you mentioned, and then printed out the values in ptr, it shows the correct values for ptr[0] and ptr[1] and then a garbage value for ptr[2]. </p>\n</blockquote>\n\n<p>Correct. <code>ptr[2]</code> is freed before, so unless you assign a new value to that address, it will remain a garbage. Also be careful after you have freed heap memory. You should not use the pointer to access memory or assign a new value to it. Consider your pointer \"void\" after you call <code>free</code> on it.</p>\n\n<blockquote>\n  <p>When I tried to print the size of it with printf(\"%d\", sizeof(ptr)), it shows 8 and printf(\"%d\", sizeof(ptr)/sizeof(ptr[0]) shows 1. </p>\n</blockquote>\n\n<p><code>ptr</code> is a pointer. <code>sizeof(ptr)</code> returns <code>8</code> bytes, that's the size of address that a pointer in your system holds. So, it is not the size of array... Further, determining the size of a pointer (which points to an array and passed to a function as reference - like you did <code>changePtr(ptr)</code>) during the runtime is <a href=\"https://stackoverflow.com/questions/492384/how-to-find-the-sizeof-a-pointer-pointing-to-an-array\">programmatically not possible</a>, you have to explicitly pass the array size to a function, if you want to do some loop operations. </p>\n"}, {"comments": [{"owner": {"reputation": 1430, "user_id": 5739619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dc9137cd10cc63c14d4c774bc81ef98a?s=128&d=identicon&r=PG&f=1", "display_name": "user5739619", "link": "https://stackoverflow.com/users/5739619/user5739619"}, "edited": false, "score": 0, "creation_date": 1558484539, "post_id": 56247724, "comment_id": 99113879, "body": "I pasted new code into the OP. I am getting garbage values now in <code>ptr</code>. Why is this?"}, {"owner": {"reputation": 191, "user_id": 4889630, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206836010041352/picture?type=large", "display_name": "Jonathan Arley Monsalve Salaza", "link": "https://stackoverflow.com/users/4889630/jonathan-arley-monsalve-salaza"}, "reply_to_user": {"reputation": 1430, "user_id": 5739619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dc9137cd10cc63c14d4c774bc81ef98a?s=128&d=identicon&r=PG&f=1", "display_name": "user5739619", "link": "https://stackoverflow.com/users/5739619/user5739619"}, "edited": false, "score": 0, "creation_date": 1558556117, "post_id": 56247724, "comment_id": 99145040, "body": "Well in the function changePtr(double* ptr) you free memory, and then allocate memory in a different location. However, in main function ptr stills points to the old address. I think a solution is use &amp; operator in changePtr(double &amp;ptr). Thus ptr is a reference to ptr in main and by changing it in Changeptr function will also modify it in main function"}], "tags": [], "owner": {"reputation": 191, "user_id": 4889630, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206836010041352/picture?type=large", "display_name": "Jonathan Arley Monsalve Salaza", "link": "https://stackoverflow.com/users/4889630/jonathan-arley-monsalve-salaza"}, "is_accepted": false, "score": 1, "last_activity_date": 1558483430, "creation_date": 1558483430, "answer_id": 56247724, "question_id": 56247427, "link": "https://stackoverflow.com/questions/56247427/how-to-reassign-pointer-to-smaller-array-in-c/56247724#56247724", "title": "How to reassign pointer to smaller array in C?", "body": "<p>Well, when you do</p>\n\n<pre><code>double s[3]={1,2,3};\n</code></pre>\n\n<p>That memory is not managed by you, so you can not free it. You can only use free when you allocate memory using malloc or calloc (i.e. dynamically allocated memory). Additionally, you have a memory leak there because</p>\n\n<pre><code>ptr=(double*)malloc(sizeof(double)*3); // here you allocate memory \n...\nptr = s; // here you change the pointer address but allocated memory is never freed\n</code></pre>\n\n<p>a solution would be to use a for loop to copy the values from s to ptr, and do the same in changePtr to copy values from s1 to ptr.</p>\n"}], "owner": {"reputation": 1430, "user_id": 5739619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dc9137cd10cc63c14d4c774bc81ef98a?s=128&d=identicon&r=PG&f=1", "display_name": "user5739619", "link": "https://stackoverflow.com/users/5739619/user5739619"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1558490375, "creation_date": 1558480656, "last_edit_date": 1558484493, "question_id": 56247427, "link": "https://stackoverflow.com/questions/56247427/how-to-reassign-pointer-to-smaller-array-in-c", "title": "How to reassign pointer to smaller array in C?", "body": "<p>Is there a way to have a pointer in C that points to an array be reassigned so that it points to an array of a smaller size? For example, if I have a pointer <code>ptr</code> that originally points to an array <code>s</code> of size 3, and there also exists an array <code>s1</code> of size 2, could I reassign <code>ptr</code> so that it points to <code>s</code> and thus points to a smaller array?</p>\n\n<p>I tried the following code:</p>\n\n<pre><code>void changePtr(double* ptr);\n\nint main()\n{\n    double *ptr;\n    ptr = (double*)malloc(sizeof(double)*3);\n    double s[3]={1,2,3};\n    ptr=s;\n    changePtr(ptr);\n\n    return 0;\n}\n\nvoid changePtr(double* ptr) {\n\n    double s1[2]={4,5};\n    free(ptr);\n    ptr = (double*)malloc(sizeof(double)*2);\n    ptr=s1;\n}\n</code></pre>\n\n<p>But when I run this in VIsual Studio, I get an error at <code>free(ptr)</code> which says <code>Debug Assertion failed! Expression: _CrtIsValidHeapPointer(block)</code></p>\n\n<p>Why is this?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>New code is:</p>\n\n<pre><code>void changePtr(double* ptr);\n\nint main()\n{\n    double *ptr;\n    ptr = (double*)malloc(sizeof(double)*3);\n    double *s;\n    s = (double*)malloc(sizeof(double)*3);\n    s[0]=1; s[1]=2; s[0]=3; \n    for (int i=0; i&lt;3; i++){\n        ptr[i]=s[i];\n    }\n\n    changePtr(ptr);\n\n    for (int i=0; i&lt;2; i++){\n        printf(\"%f\\t\", ptr[i]);\n    }\n\n\n    free(ptr);\n    free(s);\n\n    return 0;\n}\n\nvoid changePtr(double* ptr) {\n    free(ptr);\n    double *s1;\n    s1 = (double*)malloc(sizeof(double)*2);\n    s1[0]=11; s1[1]=12;\n\n    ptr = (double*)malloc(sizeof(double)*2);\n\n    for (int i=0; i&lt;2; i++){\n        ptr[i]=s1[i];\n    }\n}\n</code></pre>\n\n<p>But I get garbage values like <code>-1456815990147....1</code> when I print out the values of <code>ptr</code> after calling <code>changePtr</code>. Why is this?</p>\n"}, {"tags": ["c++", "c", "assembly"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 4, "creation_date": 1558480230, "post_id": 56247372, "comment_id": 99113089, "body": "<code>enum</code> is a type it has no storage in memory hence no address to link against."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1558480667, "post_id": 56247372, "comment_id": 99113180, "body": "(this was going to be an answer).  ## No, there&#39;s no way to export enums via linking, they&#39;re a source-level thing.  <code>enum</code> name -&gt; value mapping only appears in debug info, if anywhere.  It&#39;s not something the linker will be able to fill in for you.  You could imagine a system that abused ELF relocation entries like <code>R_X86_64_32</code> (32-bit absolute address) to hold enum values instead.  Then <code>mov eax, foo</code> would put <code>0</code> into <code>eax</code>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1558480816, "post_id": 56247372, "comment_id": 99113211, "body": "<code>mov eax, [foo]</code> would be a load from address <code>0</code>.  Why would you want that?  That syntax is probably left over from your inefficient version that creates a non-const global variable for every enum value(!!??!?!???), preventing the C compiler from doing constant-propagation or using them as immediates."}, {"owner": {"reputation": 33, "user_id": 9505725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dfcbaa4f91da616d8bb092f1e611f36?s=128&d=identicon&r=PG&f=1", "display_name": "xilef97", "link": "https://stackoverflow.com/users/9505725/xilef97"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1558481521, "post_id": 56247372, "comment_id": 99113361, "body": "@PeterCordes: the assembly code is for my current version, using integers. The integers are non-const because if I declare them const, the linker once again complains about undefined references."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1558481987, "post_id": 56247372, "comment_id": 99113438, "body": "Yeah, exactly, you want the compiler to be able to optimize them away, that&#39;s my point!  If you&#39;re hand-writing asm, obviously efficiency matters.  Anyway, you&#39;re not <i>forced</i> to use this inefficient way.  But you do need some way to translate the enum to NASM source, or like suggested in the answer to the linked duplicate, use some kind of macro language to create C and asm declarations from one source line.  But NASM doesn&#39;t use the C preprocessor, so that exact answer won&#39;t work, you&#39;d need to adapt it.  Maybe have a build script that turns a text file into a <code>.h</code> or <code>.asm</code> include file."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 1, "creation_date": 1558488226, "post_id": 56247372, "comment_id": 99114440, "body": "Enumeration constants are constants and therefore have no linkage. If you are interested in language-lawyer staff this might be useful: <a href=\"https://stackoverflow.com/a/54398736/8990329\">stackoverflow.com/a/54398736/8990329</a>"}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 0, "creation_date": 1558489581, "post_id": 56247372, "comment_id": 99114645, "body": "In the days of Microsoft 16 bit compilers, you could have used <code>h2inc.exe</code> as part of a make process or build batch file to convert <code>.h</code> files for C code to <code>.inc</code> files for assembly code. With some toolsets, the linker supports global absolutes (like defines) similar to masm <code>extern xmpl:abs</code>, which defines <code>xmpl</code> as an absolute value (if it&#39;s defined in the current source file, it&#39;s a public, otherwise it&#39;s an external reference)."}], "owner": {"reputation": 33, "user_id": 9505725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dfcbaa4f91da616d8bb092f1e611f36?s=128&d=identicon&r=PG&f=1", "display_name": "xilef97", "link": "https://stackoverflow.com/users/9505725/xilef97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "closed_date": 1558480640, "answer_count": 0, "score": 3, "last_activity_date": 1558480110, "creation_date": 1558480110, "question_id": 56247372, "link": "https://stackoverflow.com/questions/56247372/extern-c-enum-in-c-for-use-in-assembly", "closed_reason": "Duplicate", "title": "extern &quot;C&quot; enum in C++ for use in assembly", "body": "<p>I want to have some values defined in a C++ module that I can use in an assembly file. I want this in an enum instead of defining a bunch of integers, so I do not have to keep track of all the specific values.</p>\n\n<p>Currently I am simply using the following (which works just fine):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>int foo = 0;\nint bar = 1;\n</code></pre>\n\n<p>But I want to replace it with an enum:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>extern \"C\" enum {\n    foo,\n    bar\n};\n</code></pre>\n\n<p>so that I can use it in an assembly module like this:</p>\n\n<pre><code>[EXTERN foo]\n...\nmov eax, [foo]\n...\n</code></pre>\n\n<p>This compiles successfully, but during linking g++ complains:</p>\n\n<pre><code>undefined reference to `foo'\n</code></pre>\n\n<p>Is there a way to use an enum for this, or am I forced to use simple integers?</p>\n"}, {"tags": ["c", "function", "assembly", "calling-convention"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1558479491, "post_id": 56247270, "comment_id": 99112942, "body": "<code>mov $integer, %rsi</code> puts the <i>address</i> of your integer variable in <code>%rsi</code>, so that&#39;s another bug once you properly flush stdout before making a raw exit system call."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1558479558, "post_id": 56247270, "comment_id": 99112953, "body": "It would nevetheless still print that, except you used an exit system call which doesn&#39;t flush the libc buffers and you did not use a line feed. So just <code>call exit</code> or <code>ret</code> from <code>main</code>. Also you forgot to maintain stack alignment."}], "owner": {"reputation": 1, "user_id": 11536440, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-amimn9UNBSI/AAAAAAAAAAI/AAAAAAAAAxo/EfdkdEw1bzU/photo.jpg?sz=128", "display_name": "Dominika", "link": "https://stackoverflow.com/users/11536440/dominika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "closed_date": 1558479566, "answer_count": 0, "score": 0, "last_activity_date": 1558479391, "creation_date": 1558479260, "last_edit_date": 1558479391, "question_id": 56247270, "link": "https://stackoverflow.com/questions/56247270/why-is-my-program-not-printing-an-integer", "closed_reason": "Duplicate", "title": "Why is my program not printing an integer?", "body": "<p>I am trying to write some code in assembly AT&amp;T that will use a printf function from C language. I send parameters (format and number) through RDI and RSI registers and then call printf. My program compiles but it doesn't print anything in the console.</p>\n\n<pre><code>.data\n\nSYSEXIT = 60\n\nEXIT_SUCCESS = 0\n\ndecimal: .asciz \"%d\"\n\ninteger: .int 123\n\n.text\n\n.global main\n\nmain:\n\nmov $0, %rax\n\nmov $decimal, %rdi\n\nmov $integer, %rsi\n\ncall printf\n\nmovq $SYSEXIT, %rax\n\nmovq $EXIT_SUCCESS, %rdi\n\nsyscall\n</code></pre>\n"}, {"tags": ["c", "gtk", "sdl"], "comments": [{"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1558479776, "post_id": 56246481, "comment_id": 99112993, "body": "Before the GdkPixbuf typedef, the gdk-core.h file states <b>/* All of these are opaque structures */</b>.  So it doesn&#39;t look like they exposed the struct.  I&#39;m not familiar with this library, but I&#39;ll upvote the question and maybe someone else can suggest an alternative to <code>gdk_pixbuf_new</code>.  Perhaps a function that takes the pixel data directly."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1157391"}, "is_accepted": false, "score": 1, "last_activity_date": 1558716212, "last_edit_date": 1558716212, "creation_date": 1558485407, "answer_id": 56247902, "question_id": 56246481, "link": "https://stackoverflow.com/questions/56246481/how-to-convert-sdl-surface-to-gtkimage/56247902#56247902", "title": "How to convert SDL_Surface to GtkImage", "body": "<p>You can't use raw pixel data directly unless it is in the correct format.</p>\n\n<p>The code below takes care of converting the pixel data to the correct format. It works with any SDL surface:</p>\n\n<pre><code>GtkWidget * gtk_image_new_from_sdl_surface (SDL_Surface *surface)\n{\n    Uint32 src_format;\n    Uint32 dst_format;\n\n    GdkPixbuf *pixbuf;\n    gboolean has_alpha;\n    int rowstride;\n    guchar *pixels;\n\n    GtkWidget *image;\n\n    // select format                                                            \n    src_format = surface-&gt;format-&gt;format;\n    has_alpha = SDL_ISPIXELFORMAT_ALPHA(src_format);\n    if (has_alpha) {\n        dst_format = SDL_PIXELFORMAT_RGBA32;\n    }\n    else {\n        dst_format = SDL_PIXELFORMAT_RGB24;\n    }\n\n    // create pixbuf                                                            \n    pixbuf = gdk_pixbuf_new (GDK_COLORSPACE_RGB, has_alpha, 8,\n                             surface-&gt;w, surface-&gt;h);\n    rowstride = gdk_pixbuf_get_rowstride (pixbuf);\n    pixels = gdk_pixbuf_get_pixels (pixbuf);\n\n    // copy pixels                                                              \n    SDL_LockSurface(surface);\n    SDL_ConvertPixels (surface-&gt;w, surface-&gt;h, src_format,\n               surface-&gt;pixels, surface-&gt;pitch,\n               dst_format, pixels, rowstride);\n    SDL_UnlockSurface(surface);\n\n    // create GtkImage from pixbuf                                              \n    image = gtk_image_new_from_pixbuf (pixbuf);\n\n    // release our reference to the pixbuf                                      \n    g_object_unref (pixbuf);\n\n    return image;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1558533920, "post_id": 56256474, "comment_id": 99134017, "body": "Or create &#39;empty&#39; pixbuf and use <code>gdk_pixbuf_get_pixels</code> to fill it later."}], "tags": [], "owner": {"reputation": 12075, "user_id": 2241569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QMrPS.jpg?s=128&g=1", "display_name": "Jussi Kukkonen", "link": "https://stackoverflow.com/users/2241569/jussi-kukkonen"}, "is_accepted": false, "score": 0, "last_activity_date": 1558526914, "creation_date": 1558526914, "answer_id": 56256474, "question_id": 56246481, "link": "https://stackoverflow.com/questions/56246481/how-to-convert-sdl-surface-to-gtkimage/56256474#56256474", "title": "How to convert SDL_Surface to GtkImage", "body": "<p><a href=\"https://developer.gnome.org/gdk-pixbuf/stable/gdk-pixbuf-Image-Data-in-Memory.html#gdk-pixbuf-new-from-data\" rel=\"nofollow noreferrer\">gdk_pixbuf_new_from_data()</a> should work for 8 bit RGB -- you'll just have to find the details of the SDL pixel format to fill in the function arguments. Note that Pixbuf will not make a copy: it will keep using the pixel data you pass it (so make a copy yourself or make sure that the SDL_Surface won't free the data prematurely).</p>\n"}], "owner": {"reputation": 11, "user_id": 11536095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4581567c4a06f3f7ba033f3793545095?s=128&d=identicon&r=PG&f=1", "display_name": "Abespada", "link": "https://stackoverflow.com/users/11536095/abespada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1558716212, "creation_date": 1558473403, "question_id": 56246481, "link": "https://stackoverflow.com/questions/56246481/how-to-convert-sdl-surface-to-gtkimage", "title": "How to convert SDL_Surface to GtkImage", "body": "<p>I'm doing a school project, and I already did a huge part on image processing with SDL, now I'm building a GUI with Glade and I need to convert my SDL_Surface to GtkImage to display every step of my processing on the GUI. How can I do it ?</p>\n\n<p>I tried to convert my SDL_Surface to GdkPixbuf, that can easily be converted to GtkImage, but it didn't worked</p>\n\n<pre><code>struct _GdkPixbuf *convertToGdk(SDL_Surface *img)\n{\n  struct _GdkPixbuf *pb = gdk_pixbuf_new(GDK_COLORSPACE_RGB, FALSE, 8, img-&gt;w, img-&gt;h);\n  pb-&gt;pixels = img-&gt;pixels;\n\n  return pb;\n}\n</code></pre>\n\n<p>Then I call the function</p>\n\n<pre><code>gtk_image_set_from_pixbuf(GTK_IMAGE(user),convertToGdk(sdl_image));\n</code></pre>\n\n<p>It doesn't even compile, I got this error and I don't understand why</p>\n\n<pre><code>main.c: In function \u2018convertToGdk\u2019:\nmain.c:16:5: error: dereferencing pointer to incomplete type \u2018struct _GdkPixbuf\u2019\n   pb-&gt;pixels = img-&gt;pixels;\n     ^~\n</code></pre>\n\n<p>I've included gdk-pixbuf/gdk-pixbuf.h of course</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1558473499, "post_id": 56246469, "comment_id": 99111436, "body": "<code>argv[cutindex+1];</code> doesn&#39;t change in the second loop."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1558473531, "post_id": 56246469, "comment_id": 99111449, "body": "then use <code>char *argv1[10]</code>. array of <i>pointers</i>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1558476912, "post_id": 56246469, "comment_id": 99112393, "body": "It probably doesn&#39;t matter, but if the program is invoked with <code>a.out amy cut bob cut charlie cut denise cut edward</code>, the split will occur at the <code>cut</code> before <code>edward</code>.   That is, the split is made at the last <code>cut</code>.  It also isn&#39;t entirely clear what result you want if the last argument is <code>cut</code>, nor whether intermediate <code>cut</code> arguments should be kept or not."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1558477005, "post_id": 56246469, "comment_id": 99112410, "body": "It would be tempting to replace the pointer to your chosen <code>cut</code> with a <code>NULL</code> pointer (<code>argv[cutindex] = NULL;</code>), and then <code>char **argv1 = &amp;argv[1]; char **argv2 = &amp;argv[cutindex + 1];</code>, giving you two null-pointer terminated lists.  That assumes you don&#39;t need the original argument list after this.  Or simply arrange to copy relevant subsections of the <code>argv</code> array into the new arrays."}], "answers": [{"tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": true, "score": 1, "last_activity_date": 1558493968, "last_edit_date": 1558493968, "creation_date": 1558475346, "answer_id": 56246791, "question_id": 56246469, "link": "https://stackoverflow.com/questions/56246469/store-argv-into-two-arrays-divided-by-a-special-string-c/56246791#56246791", "title": "Store argv[] into two arrays divided by a special string (C)", "body": "<p>There are a couple problems that were pointed out in the comments:</p>\n\n<ol>\n<li><p>In the third loop, the code uses <code>cutindex + 1</code> to index into the <code>argv</code> array. But the loop doesn't change <code>cutindex</code>, so the first argument after \"cut\" (\"amy\" in the example) is repeated for the entire array.</p></li>\n<li><p>The output arrays <code>argv1</code> and <code>argv2</code> should be arrays of pointers. </p></li>\n</ol>\n\n<p>One solution to the first problem is to use a separate index for each array. That way you can increment each index as needed, and don't need to attempt to compute indexes mathematically.</p>\n\n<p>The added benefit is that when the code is finished, the final value of each output index is the count of elements in the corresponding output array.</p>\n\n<p>Another added benefit is that you can limit the number of elements written to the array. Note that in the code below, any arguments after the first 10 are silently dropped. In real code, you might want to alert the user that they entered too many arguments.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#define MAX_ARG 10\n\nint main(int argc, char *argv[])\n{\n    char *argv1[MAX_ARG];   // first array of arguments\n    int n1 = 0;             // index into first array\n\n    char *argv2[MAX_ARG];   // second array of arguments\n    int n2 = 0;             // index into second array\n\n    // copy pointers into the first array until \"cut\" is found\n    int i;\n    for (i = 1; i &lt; argc; i++)\n    {\n        if (strcmp(\"cut\", argv[i]) == 0)\n            break;\n        if (n1 &lt; MAX_ARG)\n            argv1[n1++] = argv[i];\n    }\n\n    // copy any remaining pointers into the second array\n    for (i++; i &lt; argc; i++)\n    {\n        if (n2 &lt; MAX_ARG)\n            argv2[n2++] = argv[i];\n    }\n\n    // print the arrays\n    for (int i = 0; i &lt; n1; i++)\n        printf(\"argv1[%d] = '%s'\\n\", i, argv1[i]);\n    putchar('\\n');\n    for (int i = 0; i &lt; n2; i++)\n        printf(\"argv2[%d] = '%s'\\n\", i, argv2[i]);\n}\n</code></pre>\n\n<p>When run with the command line</p>\n\n<pre><code>./a.out andy bob charlie ned cut amy sophie anna\n</code></pre>\n\n<p>the output of this code is</p>\n\n<pre><code>argv1[0] = 'andy'\nargv1[1] = 'bob'\nargv1[2] = 'charlie'\nargv1[3] = 'ned'\n\nargv2[0] = 'amy'\nargv2[1] = 'sophie'\nargv2[2] = 'anna'\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10558882, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xFw09rXJYSM/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBqqzJwfzTvkGeO98xKyldatCbz_Q/mo/photo.jpg?sz=128", "display_name": "Dinho", "link": "https://stackoverflow.com/users/10558882/dinho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 56246791, "answer_count": 1, "score": 1, "last_activity_date": 1558493968, "creation_date": 1558473344, "question_id": 56246469, "link": "https://stackoverflow.com/questions/56246469/store-argv-into-two-arrays-divided-by-a-special-string-c", "title": "Store argv[] into two arrays divided by a special string (C)", "body": "<p>I want to read the arguments from command line and store them into two arrays. The separation between the arrays will be denoted by \"cut\".</p>\n\n<p>Example: a.out andy bob charlie ned cut amy sophie anna</p>\n\n<p>array1 will be {andy, bob, charlie, ned}</p>\n\n<p>array2 will be {amy, sophie, anna}</p>\n\n<p>I found the argc of the word \"cut\". Then I ran a loop from 0 to that index for the first array. I am having trouble with the second array.</p>\n\n<pre><code>int cutindex, i;\n\nfor(i=1; i&lt;argc; i++) {\n  if(strcmp(\"cut\", argv[i]) == 0){\n    cutindex = i;\n  }\n}\n\nchar argv1[10];\nfor(i=0; i&lt;cutindex-1; i++) {\n  argv1[i] = argv[i+1];\n}\n\nchar argv2[10];\nfor(i=0; i&lt;argc-cutindex-1; i++) {\n  argv2[i] = argv[cutindex+1];\n}\n</code></pre>\n\n<p>For the second array, I am getting a repetition of the first value (amy) for the entire array. What am I doing wrong?</p>\n\n<p>Firstly, is there a better (more efficient) way to do this?</p>\n"}, {"tags": ["c", "function", "virtual"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1558472687, "post_id": 56246086, "comment_id": 99111125, "body": "not every code you see on internet is good"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1558475492, "post_id": 56246086, "comment_id": 99112083, "body": "@P__J__ This is the traditional way to invoke a function through a function pointer.  Later, the explicit dereference was made optional, but many people prefer to keep it since it&#39;s clearer and more consistent with the declarator.  There&#39;s certainly nothing wrong with doing so."}], "answers": [{"comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1558472081, "post_id": 56246218, "comment_id": 99110876, "body": "Truth is, the parenthesis around the pointer don&#39;t appear to be needed either."}, {"owner": {"reputation": 112977, "user_id": 390278, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/84715fec547362389d02f5be0ed12814?s=128&d=identicon&r=PG", "display_name": "Jeff Mercado", "link": "https://stackoverflow.com/users/390278/jeff-mercado"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1558472134, "post_id": 56246218, "comment_id": 99110897, "body": "True, though only if we left out the dereferencing <code>*</code>."}], "tags": [], "owner": {"reputation": 112977, "user_id": 390278, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/84715fec547362389d02f5be0ed12814?s=128&d=identicon&r=PG", "display_name": "Jeff Mercado", "link": "https://stackoverflow.com/users/390278/jeff-mercado"}, "is_accepted": false, "score": 6, "last_activity_date": 1558472240, "last_edit_date": 1558472240, "creation_date": 1558472023, "answer_id": 56246218, "question_id": 56246086, "link": "https://stackoverflow.com/questions/56246086/virtual-function-emulated-in-c/56246218#56246218", "title": "Virtual function emulated in C", "body": "<p>If it's a function pointer, it's not required. It's the same with or without.</p>\n\n<p>The idea is that it's a \"pointer to a function\" so you want to dereference the pointer to be able to use it as a function. But function names are effectively just pointers too and you don't need to dereference those as well, so they are equivalent.</p>\n\n<p><code>(*me-&gt;vptr-&gt;area)(me)</code> is equivalent to <code>(me-&gt;vptr-&gt;area)(me)</code> as is <code>printf(\"foo\")</code> is equivalent to <code>(*printf)(\"foo\")</code> (though you'll never write it this way).</p>\n\n<p>You can keep it in or remove it, it doesn't really matter. Personally if it's specifically a pointer to a function and not a named function itself, I would leave it in to keep with the \"dereference to use it\" idea.</p>\n"}, {"tags": [], "owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "is_accepted": false, "score": 2, "last_activity_date": 1558472982, "creation_date": 1558472982, "answer_id": 56246411, "question_id": 56246086, "link": "https://stackoverflow.com/questions/56246086/virtual-function-emulated-in-c/56246411#56246411", "title": "Virtual function emulated in C", "body": "<p>The function Shape_area() is defined as:</p>\n\n<pre><code>uint32_t Shape_area(Shape const * const me) {\n    return (*me-&gt;vptr-&gt;area)(me);\n}\n</code></pre>\n\n<p>This means the function <code>Shape_area()</code> accepts a pointer to a struct of type Shape.</p>\n\n<p>So in order to get to the actual function pointer for the virtual function the definitions for the various structs are as follows.</p>\n\n<p>First struct is the actual data struct which contains the data along with the virtual function pointer.</p>\n\n<pre><code>typedef struct {\n    struct ShapeVtbl const *vptr; /* &lt;== Shape's Virtual Pointer */\n    int16_t x; /* x-coordinate of Shape's position */\n    int16_t y; /* y-coordinate of Shape's position */\n} Shape; \n</code></pre>\n\n<p>There are two data items, <code>x</code> and <code>y</code>, along with a pointer to the virtual pointer which will contain the pointer to the actual function to be used.</p>\n\n<p>That pointer to the virtual function is enclosed with a struct and is defined as:</p>\n\n<pre><code>struct ShapeVtbl {\n    uint32_t (*area)(Shape const * const me);\n};\n</code></pre>\n\n<p>So if we use one of these data structs it would be something like the following source code snippet.</p>\n\n<pre><code>uint32_t doVirt (Shape const * const me)\n{\n    // do things with the x and y data from variable me.\n    // reference me-&gt;x and me-&gt;y to access those values.\n\n    return 0;\n}\n\nstruct ShapeVtbl myVirt = { doVirt };  // create a struct containing pointer to our function\n\nShape myShape;    // define our data structure\n\nmyShape.x = 32;          // set the x coordinate\nmyShape.y = 45;          // set the y coordinate\nmyShape.vptr = &amp;myVirt;  // set the pointer to the virtual function pointer.\n\nShape_area (&amp;myShape);   // call Shape_area with our struct.\n</code></pre>\n\n<p>The function <code>Shape_area()</code> will take the pointer to the <code>myShape</code> struct and then access the virtual function specified through the function pointer provided.</p>\n\n<p>If we look at <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">operator precedence table</a> we can see that <code>*me-&gt;vptr-&gt;area</code> is the same as <code>*(me-&gt;vptr-&gt;area)</code> or in other words the asterisk is being used to dereference the function pointer using standard pointer dereference syntax.</p>\n\n<p>However with function pointers this syntax is not necessary though it can still be done. So <code>(*me-&gt;vptr-&gt;area)()</code> is the same as <code>(me-&gt;vptr-&gt;area) ()</code> is the same as <code>me-&gt;vptr-&gt;area()</code> due to the operator precedence rules.</p>\n"}], "owner": {"reputation": 41, "user_id": 9725709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/850e08a20bdb7137dcb4098e835ebfd5?s=128&d=identicon&r=PG&f=1", "display_name": "Oreo", "link": "https://stackoverflow.com/users/9725709/oreo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1558472982, "creation_date": 1558471419, "question_id": 56246086, "link": "https://stackoverflow.com/questions/56246086/virtual-function-emulated-in-c", "title": "Virtual function emulated in C", "body": "<p>I have the example of the code in C, which emulates the virtual function Shape_area().</p>\n\n<p>There is one line of code which I don't understand: <code>return (*me-&gt;vptr-&gt;area)(me);</code> </p>\n\n<p>Why do we use '*' before 'me'?</p>\n\n<p>Could You explain to me that part, please?\nThanks</p>\n\n<pre><code>/*shape.h*/\n\nstruct ShapeVtbl; /* forward declaration */\ntypedef struct {\n    struct ShapeVtbl const *vptr; /* &lt;== Shape's Virtual Pointer */\n    int16_t x; /* x-coordinate of Shape's position */\n    int16_t y; /* y-coordinate of Shape's position */\n} Shape;\n\n/* Shape's virtual table */\nstruct ShapeVtbl {\n    uint32_t (*area)(Shape const * const me);\n};\n\n/* Shape's operations (Shape's interface)... */\nvoid Shape_ctor(Shape * const me, int16_t x, int16_t y);\nvoid Shape_moveBy(Shape * const me, int16_t dx, int16_t dy);\n\nuint32_t Shape_area(Shape const * const me) {\n    return (*me-&gt;vptr-&gt;area)(me);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1558479980, "post_id": 56245997, "comment_id": 99113039, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/193735/discussion-on-question-by-francesco-venuti-ive-used-printf-but-when-i-complie-n\">moved to chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 1, "last_activity_date": 1558472588, "last_edit_date": 1558472588, "creation_date": 1558471344, "answer_id": 56246071, "question_id": 56245997, "link": "https://stackoverflow.com/questions/56245997/ive-used-printf-but-when-i-complie-nothing-appears/56246071#56246071", "title": "I&#39;ve used printf but when I complie nothing appears", "body": "<blockquote>\n  <p>for (nc=0; getchar() !=EOF; ++nc);</p>\n</blockquote>\n\n<p>the ';' at the end of the line is perhaps not what you want, because of it the body of the <em>for</em> is empty</p>\n\n<p>so <code>printf(\"%d\\n\", nc);</code> is executed only one time, not several, and for that you need first to go out of the <em>for</em>, so to reach EOF</p>\n\n<p>What is your OS, what are you doing to have EOF ?</p>\n\n<p>If you never reach EOF it is normal to have nothing print</p>\n\n<p>If you are under Linux/Unix you can do <code>echo blahblah | ./yourprog</code> and yes in that case you will print 9 (because of the newline, 8 if <code>echo -n blahblah</code>)</p>\n\n<p>Under Windows do not execute your code through codeblocks, execute it directly in a terminal, codeblocks and other IDE have unexpected behavior on the input/output</p>\n"}], "owner": {"reputation": 13, "user_id": 11536076, "user_type": "registered", "profile_image": "https://graph.facebook.com/2257451844470395/picture?type=large", "display_name": "Francesco Venuti", "link": "https://stackoverflow.com/users/11536076/francesco-venuti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 56246071, "answer_count": 1, "score": 0, "last_activity_date": 1558472644, "creation_date": 1558471004, "last_edit_date": 1558472644, "question_id": 56245997, "link": "https://stackoverflow.com/questions/56245997/ive-used-printf-but-when-i-complie-nothing-appears", "title": "I&#39;ve used printf but when I complie nothing appears", "body": "<p>When I comnpile And run the program nothing appears,i'm using codeblocks 17.12 please help me.\nANSWER: To make the result of printf appear you should end the cycle with ctrl+z or ctrl+d depending if you are using windows or linux.</p>\n\n<pre><code>main()\n{\nint nc;\nfor (nc=0; getchar() !=EOF; ++nc);\nprintf(\"%d\\n\", nc);\n return 0;\n }\n</code></pre>\n"}, {"tags": ["c", "ncurses"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1558470956, "post_id": 56245960, "comment_id": 99110419, "body": "&quot;Printw() is not supposed to display normally, because it bufferize.&quot; What do you mean by this?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 1, "creation_date": 1558471071, "post_id": 56245960, "comment_id": 99110473, "body": "because of <i>refresh</i> ?"}, {"owner": {"reputation": 157, "user_id": 9854362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5945ede330ed0d02c223a2ab56b1653?s=128&d=identicon&r=PG&f=1", "display_name": "Progear", "link": "https://stackoverflow.com/users/9854362/progear"}, "edited": false, "score": 0, "creation_date": 1558471183, "post_id": 56245960, "comment_id": 99110511, "body": "the printw() function is not supposed to display in this case, whereas it does if you execute this code... So I don&#39;t understand why."}, {"owner": {"reputation": 157, "user_id": 9854362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5945ede330ed0d02c223a2ab56b1653?s=128&d=identicon&r=PG&f=1", "display_name": "Progear", "link": "https://stackoverflow.com/users/9854362/progear"}, "edited": false, "score": 0, "creation_date": 1558471221, "post_id": 56245960, "comment_id": 99110520, "body": "Nope, i replace the refresh() by getch() and it&#39;s the same.."}, {"owner": {"reputation": 157, "user_id": 9854362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5945ede330ed0d02c223a2ab56b1653?s=128&d=identicon&r=PG&f=1", "display_name": "Progear", "link": "https://stackoverflow.com/users/9854362/progear"}, "edited": false, "score": 0, "creation_date": 1558471400, "post_id": 56245960, "comment_id": 99110593, "body": "It display too.."}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 9854362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5945ede330ed0d02c223a2ab56b1653?s=128&d=identicon&r=PG&f=1", "display_name": "Progear", "link": "https://stackoverflow.com/users/9854362/progear"}, "edited": false, "score": 0, "creation_date": 1558472348, "post_id": 56246242, "comment_id": 99110981, "body": "Ok ok ok, I did this test to see how cbreak() works. Do you have a test to show that it works? Because I had used refresh() to update the terminal but now I don&#39;t know what to use..."}, {"owner": {"reputation": 14704, "user_id": 908515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f1L9v.png?s=128&g=1", "display_name": "undur_gongor", "link": "https://stackoverflow.com/users/908515/undur-gongor"}, "reply_to_user": {"reputation": 157, "user_id": 9854362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5945ede330ed0d02c223a2ab56b1653?s=128&d=identicon&r=PG&f=1", "display_name": "Progear", "link": "https://stackoverflow.com/users/9854362/progear"}, "edited": false, "score": 0, "creation_date": 1558472763, "post_id": 56246242, "comment_id": 99111154, "body": "So you want to see that output in nocbreak mode is line-buffered? You see this because without <code>refresh</code> nothing is displayed. If you <code>printw(&quot;Blah\\n&quot;);</code> however, it is printed even without the <code>refresh</code>."}, {"owner": {"reputation": 14704, "user_id": 908515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f1L9v.png?s=128&g=1", "display_name": "undur_gongor", "link": "https://stackoverflow.com/users/908515/undur-gongor"}, "reply_to_user": {"reputation": 157, "user_id": 9854362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5945ede330ed0d02c223a2ab56b1653?s=128&d=identicon&r=PG&f=1", "display_name": "Progear", "link": "https://stackoverflow.com/users/9854362/progear"}, "edited": false, "score": 1, "creation_date": 1558473731, "post_id": 56246242, "comment_id": 99111514, "body": "You are right. <code>cbreak</code>/<code>nocbreak</code> is about input: Does the program receive key strokes immediately or only after newline. &quot;Normally, the tty driver buffers typed characters until a newline or carriage return is typed. The cbreak routine disables line buffering and erase/kill character-processing (interrupt and flow control characters are unaffected), making characters typed by the user immediately available to the program.&quot; For the output, you always need a refresh (or similar) to make it visible."}], "tags": [], "owner": {"reputation": 14704, "user_id": 908515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f1L9v.png?s=128&g=1", "display_name": "undur_gongor", "link": "https://stackoverflow.com/users/908515/undur-gongor"}, "is_accepted": true, "score": 1, "last_activity_date": 1558474627, "last_edit_date": 1558474627, "creation_date": 1558472114, "answer_id": 56246242, "question_id": 56245960, "link": "https://stackoverflow.com/questions/56245960/why-printw-does-display-in-this-case/56246242#56246242", "title": "Why printw does display in this case?", "body": "<p>It is because of the call to <code>refresh</code>. </p>\n\n<p>The <a href=\"https://linux.die.net/man/3/refresh\" rel=\"nofollow noreferrer\">refresh man page</a> does not explicitly state it, but it seems to apply the buffered outputs as well. </p>\n\n<p>Without the call to <code>refresh</code>, no output is shown.</p>\n\n<p>If you add a call to <code>getch</code> instead of <code>refresh</code>, you get the output too, because <code>getch</code> does a <code>wrefresh</code>. <a href=\"https://linux.die.net/man/3/getch\" rel=\"nofollow noreferrer\">Man page</a>:</p>\n\n<blockquote>\n  <p>If the window is not a pad, and it has been moved or modified since the last call to wrefresh, wrefresh will be called before another character is read.</p>\n</blockquote>\n\n<p>To see the different behavior for inputs in cbreak/nocbreak mode, you can use this program:</p>\n\n<pre><code>int main(int ac, char **av)\n{\n    char c, i;\n    initscr();\n    noecho();  // switch off display of typed characters by the tty\n\n    printw(\"cbreak\\n\");\n    cbreak();\n    for (i = 0; i &lt; 5; ++i) {\n        c = getch();\n        printw(\"%c\", c);\n    }\n\n    printw(\"\\nnocbreak\\n\");\n    nocbreak();\n    for (i = 0; i &lt; 5; ++i) {\n        c = getch();\n        printw(\"%c\", c);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>In cbreak mode, the program sees the five input characters as you type them (and outputs immediately due to <code>getch</code>). In nocbreak mode, they will be received and output only after you press return.</p>\n"}, {"comments": [{"owner": {"reputation": 157, "user_id": 9854362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5945ede330ed0d02c223a2ab56b1653?s=128&d=identicon&r=PG&f=1", "display_name": "Progear", "link": "https://stackoverflow.com/users/9854362/progear"}, "edited": false, "score": 0, "creation_date": 1558504822, "post_id": 56247067, "comment_id": 99117865, "body": "Ok ok thanks for your answer, but now i don\u2019t know when it might be relevant to use cbreak(), since printw doesn\u2019t act as printf !"}, {"owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "reply_to_user": {"reputation": 157, "user_id": 9854362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5945ede330ed0d02c223a2ab56b1653?s=128&d=identicon&r=PG&f=1", "display_name": "Progear", "link": "https://stackoverflow.com/users/9854362/progear"}, "edited": false, "score": 0, "creation_date": 1558515294, "post_id": 56247067, "comment_id": 99123117, "body": "<code>cbreak</code> tells ncurses (part of) how to simulate cooked versus raw <i>input</i> modes, so it&#39;s not relevant to <code>printw</code> (an <i>output</i> function)."}], "tags": [], "owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "is_accepted": false, "score": 3, "last_activity_date": 1558477517, "creation_date": 1558477517, "answer_id": 56247067, "question_id": 56245960, "link": "https://stackoverflow.com/questions/56245960/why-printw-does-display-in-this-case/56247067#56247067", "title": "Why printw does display in this case?", "body": "<p>Actually, <code>printw</code> is <strong><em>not</em></strong> line-buffered.  ncurses initializes the terminal to <em>raw mode</em> and simulates <em>cooked mode</em> as needed.  But that applies only to <strong><em>input</em></strong>.  For output, ncurses will immediately write the relevant updates to the screen as noted in the <a href=\"https://invisible-island.net/ncurses/man/curs_refresh.3x.html#h3-refresh_wrefresh\" rel=\"nofollow noreferrer\">manual page</a>:</p>\n\n<blockquote>\n  <p>The <strong><code>refresh</code></strong> and <strong><code>wrefresh</code></strong> routines (or <strong><code>wnoutrefresh</code></strong> and  doupdate)  must\n  be called to get actual output to the terminal, as other routines merely manipulate data structures.  <em>The routine <strong><code>wrefresh</code></strong> copies  the  named\n  window  to  the  <strong>physical  screen</strong>,  taking into account what is already\n  there to do optimizations.  The <strong><code>refresh</code></strong> routine is the same, using <strong><code>stdscr</code></strong> as the default window.</em>  Unless <strong><code>leaveok</code></strong> has been enabled, the physical cursor of the terminal is left at the location of  the  cursor  for\n  that window.</p>\n</blockquote>\n\n<p>The <strong><em>physical screen</em></strong> is your terminal, of course.  ncurses remembers what's there by recording it in <a href=\"https://invisible-island.net/ncurses/man/curs_variables.3x.html#h3-The-Current-Screen\" rel=\"nofollow noreferrer\"><strong><code>curscr</code></strong></a>:</p>\n\n<blockquote>\n  <p>This  implementation  of  curses uses a special window <strong><code>curscr</code></strong> to record\n         its updates to the terminal screen.</p>\n  \n  <p>This is referred to as the <strong><em>\"physical screen\"</em></strong>  in  the  <a href=\"https://invisible-island.net/ncurses/man/curs_refresh.3x.html\" rel=\"nofollow noreferrer\">curs_refresh(3x)</a>\n  and <a href=\"https://invisible-island.net/ncurses/man/curs_outopts.3x.html\" rel=\"nofollow noreferrer\">curs_outopts(3x)</a> manual pages.</p>\n</blockquote>\n\n<p>From ncurses' viewpoint, the terminal (that you <em>see</em>) and <strong><code>curscr</code></strong> are the same thing.</p>\n\n<p>For <a href=\"https://invisible-island.net/ncurses/man/curs_printw.3x.html#h2-DESCRIPTION\" rel=\"nofollow noreferrer\"><strong><code>printw</code></strong></a>, the manual page says it acts as if it calls <a href=\"https://invisible-island.net/ncurses/man/curs_addstr.3x.html\" rel=\"nofollow noreferrer\"><strong><code>waddstr</code></strong></a>, and that in turn calls <strong><code>waddch</code></strong>:</p>\n\n<blockquote>\n  <p>These functions write the (null-terminated) character string str on the\n  given window.  It is similar to calling <a href=\"https://invisible-island.net/ncurses/man/curs_addch.3x.html#h3-Adding-characters\" rel=\"nofollow noreferrer\"><strong><code>waddch</code></strong></a> once for each  character\n  in the string.</p>\n</blockquote>\n"}], "owner": {"reputation": 157, "user_id": 9854362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5945ede330ed0d02c223a2ab56b1653?s=128&d=identicon&r=PG&f=1", "display_name": "Progear", "link": "https://stackoverflow.com/users/9854362/progear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 1, "accepted_answer_id": 56246242, "answer_count": 2, "score": 0, "last_activity_date": 1558477517, "creation_date": 1558470807, "last_edit_date": 1558471515, "question_id": 56245960, "link": "https://stackoverflow.com/questions/56245960/why-printw-does-display-in-this-case", "title": "Why printw does display in this case?", "body": "<p>Why in this case, <code>printw</code> displays \"Blah\" ? I use <code>nocbreak</code>. So <code>printw</code> is not supposed to produce output normally, because the output is line-buffered.</p>\n\n<pre><code>int main(int ac, char **av)\n{\n    initscr();\n    nocbreak();\n    printw(\"Blah\");\n    refresh();\n    while (1);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1558470190, "post_id": 56245829, "comment_id": 99110116, "body": "You don&#39;t seem to have time to put spaces, newlines and proper indentation too. Please find this time, if you are asking for ours."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 2, "creation_date": 1558470230, "post_id": 56245829, "comment_id": 99110138, "body": "Hint: add the line <code>fprintf(stderr, &quot;a = %d\\ni = %d\\n&quot;, a, i);</code> to the start of the function <code>abcd</code> and run the program again."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1558493962, "post_id": 56245829, "comment_id": 99115374, "body": "It&#39;s a reasonable rule of thumb that single-letter variable names should never be made into global variables \u2014 and seldom into file scope (<code>static</code> \u2014 linkage and duration) variables.  All your global variables should be local to <code>main()</code>.  If you use GCC or Clang to compile, you can use <code>-Wshadow</code> to spot problems where local variables (such as the <code>a</code> defined in <code>main()</code>) shadow or hide file scope or global variables."}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 11506931, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SfuNVJ4YlhE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reIb4yqCxYZhV7H1oPiFlEVbT8geQ/mo/photo.jpg?sz=128", "display_name": "Daniel C Jacobs", "link": "https://stackoverflow.com/users/11506931/daniel-c-jacobs"}, "edited": false, "score": 0, "creation_date": 1558487602, "post_id": 56245967, "comment_id": 99114358, "body": "I would highly recommend getting rid of the abcd function. Functions should be written either so that the code can be reused, or to increase readability.  In this case, it\u2019s really just a waste of lines and increased runtime for the function call."}], "tags": [], "owner": {"reputation": 131, "user_id": 11506931, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SfuNVJ4YlhE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reIb4yqCxYZhV7H1oPiFlEVbT8geQ/mo/photo.jpg?sz=128", "display_name": "Daniel C Jacobs", "link": "https://stackoverflow.com/users/11506931/daniel-c-jacobs"}, "is_accepted": false, "score": 0, "last_activity_date": 1558471288, "last_edit_date": 1558471288, "creation_date": 1558470834, "answer_id": 56245967, "question_id": 56245829, "link": "https://stackoverflow.com/questions/56245829/simple-if-statement-in-c-always-return-true/56245967#56245967", "title": "Simple if statement in C always return true", "body": "<p>The reason yours doesn't work is because the variable a was declared in a separate scope from the abcd function.  The a variable you use inside the abcd function is automatically set to 0, which is why it returns true every time (0 % anything is 0). \n When you call abcd, you would need to pass a inside the parameters for it to use the correct value.  </p>\n\n<p>But really you don't need the abcd function, you can save a lot of code and directly check if it's divisible.  This code should work:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;time.h&gt;\nint a, b, i;\nchar c;\nint main()\n{\n    srand(time(NULL));\n    int a = rand() % 512;\n    b = sqrt(a);\n    i = 1;\n    do {\n        if (a%i == 0)printf(\"number %d is dividable by %d\\n\", a, i);\n        else printf(\"number %d is not dividable by %d\\n\", a, i);\n        i++;\n    } while (i &lt;= b);\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1558471012, "post_id": 56245981, "comment_id": 99110448, "body": "The behavior is not undefined.  Objects at file scope have <code>static</code> storage duration, and are initialized to 0 if no explicit initializer is present."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1558471078, "post_id": 56245981, "comment_id": 99110474, "body": "you sure you explicitly don&#39;t need &#39;static int a&#39;&#39;?"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1558471142, "post_id": 56245981, "comment_id": 99110499, "body": "objects declared at file scope are <code>static</code> by default."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1558472367, "post_id": 56245981, "comment_id": 99110991, "body": "Be careful, @JohnBode.  You are exactly correct, but your comments are susceptible to being misinterpreted as saying that file-scope variables by default have static <i>linkage</i>, especially since you seem to be referencing the <code>static</code> keyword, which has that effect at file scope."}], "tags": [], "owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "is_accepted": false, "score": 2, "last_activity_date": 1558471249, "last_edit_date": 1558471249, "creation_date": 1558470891, "answer_id": 56245981, "question_id": 56245829, "link": "https://stackoverflow.com/questions/56245829/simple-if-statement-in-c-always-return-true/56245981#56245981", "title": "Simple if statement in C always return true", "body": "<p>When you declare <code>int a</code> inside <code>main</code> as </p>\n\n<pre><code>int a=rand()%512;\n</code></pre>\n\n<p>you are shadowing your global variable <code>a</code>.  The <code>a</code> in main is a different variable that has scope only local to the function <code>main</code>.  Therefore, when you are using the value <code>a</code> inside <code>char abcd(char c)</code>, this value is the global variable <code>a</code> which is <a href=\"https://stackoverflow.com/questions/14049777/why-are-global-variables-always-initialized-to-0-but-not-local-variables\">default initialized to 0.</a></p>\n\n<p>Also, why are you passing a <code>char c</code> variable to function <code>abcd</code>.  You aren't using it.  Please consider renaming your functions to something that more clearly describes their intent.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 0, "last_activity_date": 1558471359, "last_edit_date": 1592644375, "creation_date": 1558471359, "answer_id": 56246075, "question_id": 56245829, "link": "https://stackoverflow.com/questions/56245829/simple-if-statement-in-c-always-return-true/56246075#56246075", "title": "Simple if statement in C always return true", "body": "<p>You have two different variables <code>a</code>:</p>\n<ul>\n<li><p>one declared at file scope</p>\n<blockquote>\n<pre><code>int a,b,i;\n</code></pre>\n</blockquote>\n</li>\n<li><p>and one declared in <code>main()</code>:</p>\n<blockquote>\n<pre><code>int a=rand()%512;\n</code></pre>\n</blockquote>\n</li>\n</ul>\n<p>Within its scope (almost all of <code>main()</code>), the latter shadows the former.  Elsewhere, such as in function <code>abcd()</code>, only the former is visible.  The former is default initialized to 0 and no other value is ever assigned to it, so no matter what value <code>i</code> takes, inside <code>abcd()</code>, the expression <code>a%i</code> evaluates to 0.</p>\n<p>This is a good lesson in avoiding file-scope variables.  Functions should operate on data accessed directly or indirectly through their parameters, or obtained from an external source.  It is poor form for functions to exchange data through file-scope variables.  Moreover, it was a red flag to me that your function <code>abcd()</code> declares a parameter that it never uses.  Suggested variation:</p>\n<pre><code>char abcd(int dividend, int divisor) {\n    return (dividend % divisor) ? 'n' : 'y';\n}\n</code></pre>\n<p>Or even better (because better name and more appropriate return type):</p>\n<pre><code>_Bool is_divisible(int dividend, int divisor) {\n    return !(dividend % divisor);\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11536008, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X6DnysYyv90/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNZeLtNHsLAmaKrBxmzgSfeiX6fQ/mo/photo.jpg?sz=128", "display_name": "Dominik Dobrucky", "link": "https://stackoverflow.com/users/11536008/dominik-dobrucky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 56246075, "answer_count": 3, "score": -2, "last_activity_date": 1558471359, "creation_date": 1558470075, "question_id": 56245829, "link": "https://stackoverflow.com/questions/56245829/simple-if-statement-in-c-always-return-true", "title": "Simple if statement in C always return true", "body": "<p>I dont have time to explain it deeply, its very simple code but the function always return 'y'(=true)\nIt is expected to write each number from 1 to squareroot of the generated random number and decide whether it is dividable or not but when i run it, somehow the if statement in the function always return true</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint a,b,i;\nchar c;\nchar abcd(char c);\nint main()\n{\nsrand(time(NULL));\nint a=rand()%512;\n b=sqrt(a);\n i=1;\n do{\n    if(abcd(c)=='y')printf(\"number %d is dividable by %d\\n\",a,i);\n    else printf(\"number %d is not dividable by %d\\n\",a,i);\n    i++;\n}while(i&lt;=b);\n\nreturn 0;\n}\nchar abcd(char c)\n{\n\n    if(a%i==0)return'y';\n    else return 'n';\n\n}\n</code></pre>\n"}, {"tags": ["c", "avr", "atmega16", "tuner", "codevisionavr"], "comments": [{"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1558473750, "post_id": 56245802, "comment_id": 99111517, "body": "While the sampling theorem dictates &gt;760 samples <i>per second</i>, the DFT however does not require &gt;760 samples - that is you can work with a windows much less that one seconds worth of data.  You need only a few <i>cycles</i>.  128 samples would be more that adequate."}, {"owner": {"reputation": 3, "user_id": 11518107, "user_type": "registered", "profile_image": "https://graph.facebook.com/2184323711675566/picture?type=large", "display_name": "Comaroni Andrei", "link": "https://stackoverflow.com/users/11518107/comaroni-andrei"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1558473915, "post_id": 56245802, "comment_id": 99111580, "body": "Ok, i understand, but i still can&#39;t get past 4 samples without the chip crashing and looping continuously"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1558473993, "post_id": 56245802, "comment_id": 99111607, "body": "Just an aside: did you intend to reset <code>re = 0; im = 0;</code> inside the nested loop, before the inner loop which accumulates their value?"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1558475187, "post_id": 56245802, "comment_id": 99112014, "body": "Well my point was a comment, not an answer.  I have posted an answer."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1558475713, "post_id": 56245802, "comment_id": 99112134, "body": "The high E string is 329.63 Hz BTW."}, {"owner": {"reputation": 3, "user_id": 11518107, "user_type": "registered", "profile_image": "https://graph.facebook.com/2184323711675566/picture?type=large", "display_name": "Comaroni Andrei", "link": "https://stackoverflow.com/users/11518107/comaroni-andrei"}, "edited": false, "score": 0, "creation_date": 1558476498, "post_id": 56245802, "comment_id": 99112304, "body": "The stack size is 1016 bytes. I&#39;m using 56 bytes (down from 9068). I&#39;ve tried 128 samples and allocating x[N] statically without succeding. It still loops unto itself without finishing the code."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1558477400, "post_id": 56245802, "comment_id": 99112511, "body": "Use a debugger to see what is happening.  The part you say you are using has only 1K RAM, so I am not sure how you managed to use 9068 bytes!  If you use a statically allocated buffer, your stack size will necessarily need to reduce.  What is the 56 bytes?  How have you determined that usage?"}, {"owner": {"reputation": 3, "user_id": 11518107, "user_type": "registered", "profile_image": "https://graph.facebook.com/2184323711675566/picture?type=large", "display_name": "Comaroni Andrei", "link": "https://stackoverflow.com/users/11518107/comaroni-andrei"}, "edited": false, "score": 0, "creation_date": 1558477534, "post_id": 56245802, "comment_id": 99112539, "body": "When i first started out the project i used a very bad brute force implementation of DFT, coupled with a Complex structure that  grouped real and imaginary parts of a number into a single variable. That was a LOT of space. The final version that uses just 56 bytes is exactly what you can see in the code i&#39;ve linked in the question. Nothing more"}, {"owner": {"reputation": 3, "user_id": 11518107, "user_type": "registered", "profile_image": "https://graph.facebook.com/2184323711675566/picture?type=large", "display_name": "Comaroni Andrei", "link": "https://stackoverflow.com/users/11518107/comaroni-andrei"}, "edited": false, "score": 0, "creation_date": 1558477666, "post_id": 56245802, "comment_id": 99112578, "body": "I also can&#39;t use CVAVR&#39;s debugger on the freeware program, what i&#39;ve did is i&#39;ve turned on a Led (<code>L0 = 1;</code> for example) for each line of code, and if it worked, i&#39;d move to the next one and so on. With 4 samples, the LED lights up right at the end of the <code>main()</code> function. With 128 samples, the <code>read_adc()</code> function is the one that fails first, and no LEDs light up. If i remove the function <code>read_adc()</code>, the DFT calculation of <code>re</code> an <code>im</code> also produce a loop and no LEDs light up. It simply acts like it&#39;s too much to handle."}], "answers": [{"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 0, "last_activity_date": 1558476819, "last_edit_date": 1558476819, "creation_date": 1558474993, "answer_id": 56246746, "question_id": 56245802, "link": "https://stackoverflow.com/questions/56245802/my-guitar-tuner-code-in-codevisionavr-using-an-atmega164-cant-handle-more-than/56246746#56246746", "title": "My guitar tuner code in CodeVisionAVR using an ATmega164 can&#39;t handle more than 4 samples", "body": "<p>What is the stack size?   Your <code>x[N]</code> is instantiated on the stack and there is probably insufficient space for an array of sufficient size.  </p>\n\n<p>Allocate it statically to avoid the stack-overflow:</p>\n\n<pre><code>static unsigned char x[N] = {0};\n</code></pre>\n\n<p>Even then the ATmega164 has only 1K RAM in total.  You may be able to create an 800 sample buffer, but your stack will have to be no more than around 200 bytes in that case.  However you don't need a buffer that size; you are confusing number of samples with number of samples per second.  What you need for the DFT is only a reasonable number of cycles to achieve your required precision. The resolution in Hz will be equal to F<sub>s</sub>/N, so a 256 sample buffer will yield a precision of around 3Hz which may be accurate enough.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 11518107, "user_type": "registered", "profile_image": "https://graph.facebook.com/2184323711675566/picture?type=large", "display_name": "Comaroni Andrei", "link": "https://stackoverflow.com/users/11518107/comaroni-andrei"}, "edited": false, "score": 0, "creation_date": 1558522110, "post_id": 56254245, "comment_id": 99126997, "body": "<code>Init_initController();</code> is just the microprocessor initialization. The declaration of ports, interrupts, etc. etc. Including another 1000 lines of intialization AVR code in the question would have just been too messy. They are all premade functions given to us by the university as a &quot;test program&quot;, made with the CodeWizardAVR (the intialization, the ADC read, everything). The part that doesn&#39;t work is in the <code>main();</code> function, whenever my <code>#define N &lt;samples&gt;</code> is larger than 4. The processor keeps resetting before finishing the <code>computeDft()</code> function."}, {"owner": {"reputation": 3648, "user_id": 4931630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4290ddd0630dd0091e3b9713a23c3434?s=128&d=identicon&r=PG&f=1", "display_name": "AterLux", "link": "https://stackoverflow.com/users/4931630/aterlux"}, "reply_to_user": {"reputation": 3, "user_id": 11518107, "user_type": "registered", "profile_image": "https://graph.facebook.com/2184323711675566/picture?type=large", "display_name": "Comaroni Andrei", "link": "https://stackoverflow.com/users/11518107/comaroni-andrei"}, "edited": false, "score": 0, "creation_date": 1558524333, "post_id": 56254245, "comment_id": 99128181, "body": "Anyway, since I don&#39;t know what inside <code>Init_initController();</code> I can only suggest. Still you did not confirm and did not refute my suggestion there is a watchdog timer is used."}, {"owner": {"reputation": 3, "user_id": 11518107, "user_type": "registered", "profile_image": "https://graph.facebook.com/2184323711675566/picture?type=large", "display_name": "Comaroni Andrei", "link": "https://stackoverflow.com/users/11518107/comaroni-andrei"}, "edited": false, "score": 0, "creation_date": 1558525566, "post_id": 56254245, "comment_id": 99128819, "body": "I have included <code>Init_initController();</code> in the post. I have tried to use<code>wdogtrig();</code> more often throughout the code and it did indeed finish running the while loop. Thank you! Now i have to work out how is the data from the ADC transmitted so that i can select a variable <code>F = computeDft();</code> that will be compared to light up the LEDs of a tuner."}], "tags": [], "owner": {"reputation": 3648, "user_id": 4931630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4290ddd0630dd0091e3b9713a23c3434?s=128&d=identicon&r=PG&f=1", "display_name": "AterLux", "link": "https://stackoverflow.com/users/4931630/aterlux"}, "is_accepted": false, "score": 1, "last_activity_date": 1558519997, "last_edit_date": 1558519997, "creation_date": 1558519313, "answer_id": 56254245, "question_id": 56245802, "link": "https://stackoverflow.com/questions/56245802/my-guitar-tuner-code-in-codevisionavr-using-an-atmega164-cant-handle-more-than/56254245#56254245", "title": "My guitar tuner code in CodeVisionAVR using an ATmega164 can&#39;t handle more than 4 samples", "body": "<p><strong>1.</strong></p>\n\n<pre><code>float re = 0;\nfloat im = 0;  \n</code></pre>\n\n<p>move the declaration, or do not forget to reset those values to zero inside the loop before the nested loop.</p>\n\n<p><strong>2.</strong>\nNyquist\u2013Shannon theorem (also known as Kotelnikov's theorem) says about sampling rate. To transfer frequencies up to F you have to have at least 2*F sampling rate. It is nothing to do with number of samples. If your MCU is running at 16MHz, i can assume you have the sampling rate about 9kHz = 16MHz / 128 (prescaler of the ADC) / 14 (ADC clock cycles per one sample)</p>\n\n<p><strong>3.</strong>\nWhat is <code>Init_initController();</code> ? There is no such function in your code. What it is doing? Why it <code>must be the first \"init\" action/call!</code>?\nProbably there is an issue. Looking at <code>wdogtrig();</code> I can assume somewhere watchdog timer is initialized. Since float math takes too much long time, The watchdog expires before the loop finished. </p>\n\n<p>Either disable the watchdog, or put <code>wdogtrig();</code> inside the loop in <code>computeDft();</code>, for watchdog timer reset more often.</p>\n\n<p><strong>4.</strong>\nYou can make the declaration</p>\n\n<pre><code>unsigned char x[N] = {0};\n</code></pre>\n\n<p>global, moving it outside the function, the memory will be allocated once and do not refill the stack on each function call</p>\n\n<p><strong>5.</strong>\nPlease, if you asking a question, provide all the information inside the question: what you were expecting, what you got, all custom functions and exact code which does not work.</p>\n"}], "owner": {"reputation": 3, "user_id": 11518107, "user_type": "registered", "profile_image": "https://graph.facebook.com/2184323711675566/picture?type=large", "display_name": "Comaroni Andrei", "link": "https://stackoverflow.com/users/11518107/comaroni-andrei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1558525481, "creation_date": 1558469912, "last_edit_date": 1558525481, "question_id": 56245802, "link": "https://stackoverflow.com/questions/56245802/my-guitar-tuner-code-in-codevisionavr-using-an-atmega164-cant-handle-more-than", "title": "My guitar tuner code in CodeVisionAVR using an ATmega164 can&#39;t handle more than 4 samples", "body": "<p>I'm designing a guitar tuner through CodeVisionAVR and using an ATmega164 microchip for my university project. If i set the number of samples any higher than 4, the chip LEDs will just flash continuously and the code won't get past the pin reading phase of the process (tested with lighting up LEDs after each line of code to see where it stops).</p>\n\n<p>I'm forced by the university to design the code through CVAVR, using a DFT. I have made (with the great help of an answer to a recent question) the code almost 18 times smaller than it was originally. I don't know how i can make it any easier to run so that it can tolerate more than 4 samples (<code>#define N 4</code>)</p>\n\n<pre><code>#define M_PI 3.1415926f\n#define N 4\n\nunsigned char read_adc(void)\n{\nADCSRA |= 0b01000000;  //start conversion;\nwhile (ADCSRA&amp;(0b01000000)); //wait conversion end\nreturn ADCH;\n}\n\nfloat computeDft()\n{      \n    unsigned char x[N] = {0};\n    float max = 0;   \n    float maxi = 0;\n    float magnitude = 0; \n    int k = 0;\n    int n = 0;\n    float re = 0;\n    float im = 0;          \n    for (k = 0; k &lt; N; k++)\n    {       \n        x[k] = read_adc();            \n    }\n    for (n = 0; n &lt; N; n++)\n    {\n        for (k = 0; k &lt; N; k++)\n        {       \n            re += x[k] * cos(n * k * M_PI / N);\n            im -= x[k] * sin(n * k * M_PI / N);\n        }\n        magnitude = sqrt(re * re +  im * im);\n        if (magnitude &gt; maxi) \n        {\n            maxi = magnitude;\n            max = k;   \n        }\n    }                                     \n    return max;   \n}\n\n\n/*\n * main function of program\n */\nvoid main (void)\n{          \nfloat F = 0;\nInit_initController();  // this must be the first \"init\" action/call!\n#asm(\"sei\")             // enable interrupts\n// Crystal Oscillator division factor: 1\n#pragma optsize-\nCLKPR=0x80;\nCLKPR=0x00;\n#ifdef OPTIMIZE_SIZE\n#pragma optsize+\n#endif\n\nTWCR=0x00;\n//adc init\nADMUX = 0b10100111; // set ADC0\nADCSRA = 0b10000111; //set ADEN, precale by 128\nwhile(TRUE)\n{\n    wdogtrig();         // call often else processor will reset\n    F = computeDft();    \n    L2 = 1;\n    if(F &gt; 20 &amp;&amp; F &lt; 100)\n    {\n        L3 = 1;\n    }\n}  \n\n\n}// end main loop \n</code></pre>\n\n<p>A tuner in general should be able to use at least 800 samples because of the Nyquist\u2013Shannon sampling theorem, and the high E guitar string being somewhere around 380 Hz (can't remember exactly).</p>\n\n<pre><code>/* initialization file */\n\n#include &lt;mega164a.h&gt;\n#include \"defs.h\"\n\n\n/*\n * most intialization values are generated using Code Wizard and depend on clock value\n */\nvoid Init_initController(void)\n{\n// Crystal Oscillator division factor: 1\n#pragma optsize-\nCLKPR=0x80;\nCLKPR=0x00;\n#ifdef _OPTIMIZE_SIZE_\n#pragma optsize+\n#endif\n\n// Input/Output Ports initialization\n// Port A initialization\n// Func7=In Func6=In Func5=In Func4=In Func3=In Func2=In Func1=In Func0=In \n// State7=T State6=T State5=T State4=T State3=T State2=T State1=T State0=T \nPORTA=0x00;\nDDRA=0x00;\n\n// Port B initialization\nPORTB=0x00;\nDDRB=0x00;\n\n// Port C initialization\nPORTC=0x00;\nDDRC=0x00;\n\n// Port D initialization\nPORTD=0b00100000; // D.5 needs pull-up resistor\nDDRD= 0b01010000; // D.6 is LED, D.4 is test output\n\n// Timer/Counter 0 initialization\n// Clock source: System Clock\n// Clock value: Timer 0 Stopped\n// Mode: Normal top=FFh\n// OC0 output: Disconnected\nTCCR0A=0x00;\nTCCR0B=0x00;\nTCNT0=0x00;\nOCR0A=0x00;\nOCR0B=0x00;\n\n// Timer/Counter 1 initialization\n// Clock source: System Clock\n// Clock value: 19.531 kHz = CLOCK/256\n// Mode: CTC top=OCR1A\n// OC1A output: Discon.\n// OC1B output: Discon.\n// Noise Canceler: Off\n// Input Capture on Falling Edge\n// Timer 1 Overflow Interrupt: Off\n// Input Capture Interrupt: Off\n// Compare A Match Interrupt: On\n// Compare B Match Interrupt: Off\n\nTCCR1A=0x00;\nTCCR1B=0x0D;\nTCNT1H=0x00;\nTCNT1L=0x00;\nICR1H=0x00;\nICR1L=0x00;\n\n// 1 sec = 19531 counts = 4C41H counts, from 0 to 4C40 \n// 4C40H = 4CH (MSB) and 40H (LSB)\nOCR1AH=0x4C;\nOCR1AL=0x40;\n\nOCR1BH=0x00;\nOCR1BL=0x00;\n\n// Timer/Counter 2 initialization\n// Clock source: System Clock\n// Clock value: Timer2 Stopped\n// Mode: Normal top=0xFF\n// OC2A output: Disconnected\n// OC2B output: Disconnected\nASSR=0x00;\nTCCR2A=0x00;\nTCCR2B=0x00;\nTCNT2=0x00;\nOCR2A=0x00;\nOCR2B=0x00;\n\n// External Interrupt(s) initialization\n// INT0: Off\n// INT1: Off\n// INT2: Off\n// Interrupt on any change on pins PCINT0-7: Off\n// Interrupt on any change on pins PCINT8-15: Off\n// Interrupt on any change on pins PCINT16-23: Off\n// Interrupt on any change on pins PCINT24-31: Off\nEICRA=0x00;\nEIMSK=0x00;\nPCICR=0x00;\n\n// Timer/Counter 0,1,2 Interrupt(s) initialization\nTIMSK0=0x00;\nTIMSK1=0x02;\nTIMSK2=0x00;\n\n// USART0 initialization\n// Communication Parameters: 8 Data, 1 Stop, No Parity\n// USART0 Receiver: On\n// USART0 Transmitter: On\n// USART0 Mode: Asynchronous\n// USART0 Baud rate: 9600\nUCSR0A=0x00;\nUCSR0B=0xD8;\nUCSR0C=0x06;\nUBRR0H=0x00;\nUBRR0L=0x81;\n\n// USART1 initialization\n// USART1 disabled\nUCSR1B=0x00;\n\n\n// Analog Comparator initialization\n// Analog Comparator: Off\n// Analog Comparator Input Capture by Timer/Counter 1: Off\nACSR=0x80;\nADCSRB=0x00;\nDIDR1=0x00;\n\n// Watchdog Timer initialization\n// Watchdog Timer Prescaler: OSC/2048  \n#pragma optsize-\n#asm(\"wdr\")\n// Write 2 consecutive values to enable watchdog\n// this is NOT a mistake !\nWDTCSR=0x18;\nWDTCSR=0x08;\n#ifdef _OPTIMIZE_SIZE_\n#pragma optsize+\n#endif\n\n}\n</code></pre>\n"}, {"tags": ["c", "cmake", "include", "clion", "allegro"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1558470448, "post_id": 56245734, "comment_id": 99110229, "body": "Welcome to Stack Overflow! While you refer to the code in the other SO answer, it is better to include your exact code into your question. It could be that you make some small modification in the code, about which you don&#39;t tell us (intentionally or not). Actually, it is a <b>rule</b> of the Stack Overflow to include the code into the question which asks about problems in that code. As for the linker error, it should be <b>descriptive message</b> about the <b>error</b>, like &quot;undefined reference to &lt;function&gt;&quot;. We need to see that error message too."}, {"owner": {"reputation": 11, "user_id": 11535960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b0cd9cff9d78b6622baa354284b53be?s=128&d=identicon&r=PG&f=1", "display_name": "Bytheway", "link": "https://stackoverflow.com/users/11535960/bytheway"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1558553146, "post_id": 56245734, "comment_id": 99143749, "body": "Hey, thanks for your response. I tried to edit the post to make it as you said."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1558553370, "post_id": 56245734, "comment_id": 99143847, "body": "Please, post also the <code>CMakeLists.txt</code> which you use for build your code."}, {"owner": {"reputation": 11, "user_id": 11535960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b0cd9cff9d78b6622baa354284b53be?s=128&d=identicon&r=PG&f=1", "display_name": "Bytheway", "link": "https://stackoverflow.com/users/11535960/bytheway"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1558555321, "post_id": 56245734, "comment_id": 99144693, "body": "Done. To be honest I&#39;ve never changed CMakeLists.txt before. The only thing that I did here was to copy this CMakeLists.txt (as mentioned in the post) and pasted it."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1558563163, "post_id": 56245734, "comment_id": 99147598, "body": "In the comments to <a href=\"https://stackoverflow.com/questions/22459516/undefined-symbol-main-however-i-do-have-a-main-function\">that question</a> it is suggested to declare <code>int main(void)</code> instead of <code>int main()</code>."}, {"owner": {"reputation": 11, "user_id": 11535960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b0cd9cff9d78b6622baa354284b53be?s=128&d=identicon&r=PG&f=1", "display_name": "Bytheway", "link": "https://stackoverflow.com/users/11535960/bytheway"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1558567908, "post_id": 56245734, "comment_id": 99148648, "body": "I tried it and it didn&#39;t make any difference. I just learned from <a href=\"https://stackoverflow.com/questions/49662382/clion-undefined-symbols-for-architecture-x86-64\">this question</a> that this error means compiler can&#39;t find the library files. do you think the add_executable line of my cmake is wrong? thanks."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1558568487, "post_id": 56245734, "comment_id": 99148729, "body": "No, you &quot;undefined reference&quot; is somehow special: the missed function - <code>_main</code> - is normally an alias to the <code>main</code>. And you definitely have this function in your source file. So the problem not in the linked libraries, but with the compiler or its settings. You may remove everything related to Alegro from both the source file and from the <code>CMakeLists.txt</code>, and the result will be the same (check that!)."}, {"owner": {"reputation": 11, "user_id": 11535960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b0cd9cff9d78b6622baa354284b53be?s=128&d=identicon&r=PG&f=1", "display_name": "Bytheway", "link": "https://stackoverflow.com/users/11535960/bytheway"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1558569172, "post_id": 56245734, "comment_id": 99148844, "body": "Hey there is this path usr/local/Cellar/allegro/5.2.5.0 in my computer, so I changed all the allegro/5.2.1.1_1 to allegro/5.2.5.0. and got this error: dyld: Symbol not found: __al_mangled_main   Referenced from: /usr/local/opt/allegro/lib/liballegro_main.5.2.dylib   Expected in: flat namespace  in /usr/local/opt/allegro/lib/liballegro_main.5.2.dylib  Process finished with exit code 6.am I getting close by doing this? sorry to bother you btw."}], "owner": {"reputation": 11, "user_id": 11535960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b0cd9cff9d78b6622baa354284b53be?s=128&d=identicon&r=PG&f=1", "display_name": "Bytheway", "link": "https://stackoverflow.com/users/11535960/bytheway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558560740, "creation_date": 1558469598, "last_edit_date": 1558560740, "question_id": 56245734, "link": "https://stackoverflow.com/questions/56245734/using-cmake-for-including-allegro-library", "title": "Using Cmake for including allegro library", "body": "<p>I want to work with Allegro library in clion. I used homebrew and \"brew install allegro\" command to install allegro.\nnow when I include , and run just a simple code like this: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;allegro5/allegro.h&gt;\n\nint main() {\n    printf(\"Hello World!\\n\");\n    return 0;\n\n}\n</code></pre>\n\n<p>I get this error: </p>\n\n<pre><code>Undefined symbols for architecture x86_64:\n  \"_main\", referenced from:\n     implicit entry/start for main executable\n     (maybe you meant: __Z16_al_mangled_mainv)\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\nmake[3]: *** [testAllegro] Error 1\nmake[2]: *** [CMakeFiles/testAllegro.dir/all] Error 2\nmake[1]: *** [CMakeFiles/testAllegro.dir/rule] Error 2\nmake: *** [testAllegro] Error 2\n</code></pre>\n\n<p>I have used the cmake in the correct answer of this <a href=\"https://stackoverflow.com/questions/40276737/how-to-add-allegro-library-in-clion-and-cmake\">question</a> which is: </p>\n\n<pre><code>cmake_minimum_required(VERSION 3.5)\nproject(testAllegro)\nset(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -std=c++11\")\nset(SOURCE_FILES main.cpp)\nadd_executable(testAllegro ${SOURCE_FILES})\n\nINCLUDE_DIRECTORIES(  /usr/local/Cellar/allegro/5.2.1.1_1/include )\nLINK_DIRECTORIES(  /usr/local/Cellar/allegro/5.2.1.1_1/lib )\n\nfile(GLOB LIBRARIES \"/usr/local/Cellar/allegro/5.2.1.1_1/lib/*.dylib\")\nmessage(\"LIBRARIES = ${LIBRARIES}\")\n\nTARGET_LINK_LIBRARIES(testAllegro  ${LIBRARIES})\n</code></pre>\n\n<p>and still got the same error.</p>\n"}, {"tags": ["c", "reformatting"], "comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 1, "creation_date": 1558468846, "post_id": 56245563, "comment_id": 99109568, "body": "Find and replace line ending characters for your platform (<code>\\n</code>, <code>\\r\\n</code>, or <code>\\r</code>) with empty strings in your source file(s)?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1558469005, "post_id": 56245563, "comment_id": 99109641, "body": "Are you asking for a tool that does such a thing? (Yuck!) That would be out of scope for SO."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1558469143, "post_id": 56245563, "comment_id": 99109705, "body": "Do your function definitions extend beyond a single statement?"}, {"owner": {"reputation": 140, "user_id": 2253004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8017b6fa040cdc0b5aba40df42a96edc?s=128&d=identicon&r=PG&f=1", "display_name": "Sida", "link": "https://stackoverflow.com/users/2253004/sida"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1558469205, "post_id": 56245563, "comment_id": 99109728, "body": "@Weather Vane yes, they can be multiple lines."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1558469275, "post_id": 56245563, "comment_id": 99109758, "body": "Here is one way to <a href=\"http://www.sourceformat.com/obfuscate-code-cpp.htm\" rel=\"nofollow noreferrer\">obfuscate the code</a>. As you can see from the C example there, it renders code unreadable, although it doesn&#39;t remove every newline, which would make it even harder to read on this site, as posted code has no automatic line-wrap."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1558469670, "post_id": 56245563, "comment_id": 99109891, "body": ".. but having said that, the example code barely needed obfuscating in the first place."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1558480137, "post_id": 56245563, "comment_id": 99113068, "body": "If you are having trouble writing such a program, describe the troublesome part, and present what you attempted."}], "owner": {"reputation": 140, "user_id": 2253004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8017b6fa040cdc0b5aba40df42a96edc?s=128&d=identicon&r=PG&f=1", "display_name": "Sida", "link": "https://stackoverflow.com/users/2253004/sida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558469089, "creation_date": 1558468723, "last_edit_date": 1558469089, "question_id": 56245563, "link": "https://stackoverflow.com/questions/56245563/how-to-reformat-c-code-to-put-every-struct-or-function-definition-in-only-one-li", "title": "How to reformat C code to put every struct or function definition in only one line?", "body": "<p>What I have:</p>\n\n<pre><code>int f() {\n    Stmts....;\n}\nenum t {\n    A,B,C\n};\n</code></pre>\n\n<p>What I want:</p>\n\n<pre><code>int f() { Stmts...; }\nenum t {A, B, C};\n</code></pre>\n\n<p>Also, I want the same effect for structs, unions, etc..\nThanks.</p>\n"}, {"tags": ["c", "ncurses"], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 9854362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5945ede330ed0d02c223a2ab56b1653?s=128&d=identicon&r=PG&f=1", "display_name": "Progear", "link": "https://stackoverflow.com/users/9854362/progear"}, "edited": false, "score": 0, "creation_date": 1558466898, "post_id": 56245112, "comment_id": 99108822, "body": "So cbreak() disable line buffering but we are in blocking mode and nodelay() causes getch in particular to be a non-blocking call ?"}, {"owner": {"reputation": 157, "user_id": 9854362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5945ede330ed0d02c223a2ab56b1653?s=128&d=identicon&r=PG&f=1", "display_name": "Progear", "link": "https://stackoverflow.com/users/9854362/progear"}, "edited": false, "score": 0, "creation_date": 1558470122, "post_id": 56245112, "comment_id": 99110083, "body": "Ok ok but i don&#39;t understand why when i execute that code =&gt; int main(void) {     initscr();     printw(&quot;Blah&quot;);     refresh();     while (1); } It will display Blah although i don&#39;t use cbreak ?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 157, "user_id": 9854362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5945ede330ed0d02c223a2ab56b1653?s=128&d=identicon&r=PG&f=1", "display_name": "Progear", "link": "https://stackoverflow.com/users/9854362/progear"}, "edited": false, "score": 0, "creation_date": 1558474927, "post_id": 56245112, "comment_id": 99111936, "body": "No, but printw flushes after every printout (or something else that has the same effect) which is not the case for printf."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 157, "user_id": 9854362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5945ede330ed0d02c223a2ab56b1653?s=128&d=identicon&r=PG&f=1", "display_name": "Progear", "link": "https://stackoverflow.com/users/9854362/progear"}, "edited": false, "score": 0, "creation_date": 1558476475, "post_id": 56245112, "comment_id": 99112297, "body": "Or maybe it doesn&#39;t. I don&#39;t really know. One important thing here is that this is a typical thing where it works they way it should <i>most of the time</i>. I tried the exact code here: <a href=\"https://stackoverflow.com/q/16877264/6699433\">stackoverflow.com/q/16877264/6699433</a> and I did not manage to reproduce the problem."}], "tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": 1, "last_activity_date": 1558466895, "last_edit_date": 1592644375, "creation_date": 1558466459, "answer_id": 56245112, "question_id": 56245062, "link": "https://stackoverflow.com/questions/56245062/what-is-the-difference-between-nodelay-and-cbreak-in-ncurses/56245112#56245112", "title": "What is the difference between nodelay() and cbreak() in ncurses?", "body": "<p>They are two completely different functions.</p>\n<p>From the documentation:</p>\n<blockquote>\n<p>Normally, the tty driver buffers typed characters until a newline or carriage return is typed. The cbreak routine disables line buffering and erase/kill character-processing (interrupt and flow control characters are unaffected), making characters typed by the user immediately available to the program. The nocbreak routine returns the terminal to normal (cooked) mode.</p>\n<p>...</p>\n<p>The nodelay option causes getch to be a non-blocking call. If no input is ready, getch returns ERR. If disabled (bf is FALSE), getch waits until a key is pressed.</p>\n</blockquote>\n<p>So <code>cbreak</code> is if you want to disable line buffering, which you may want for many reasons. One is to avoid having to use <code>fflush(stdout)</code> after each printout. With line buffering enabled, a printout will normally not be visible on screen until a newline character is printed.</p>\n<p>The description of <code>nodelay</code> is pretty self explanatory. <code>getch</code> will not wait, but return instantly irregardless if any key is pressed or not.</p>\n"}], "owner": {"reputation": 157, "user_id": 9854362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5945ede330ed0d02c223a2ab56b1653?s=128&d=identicon&r=PG&f=1", "display_name": "Progear", "link": "https://stackoverflow.com/users/9854362/progear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 547, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558466895, "creation_date": 1558466173, "last_edit_date": 1558466798, "question_id": 56245062, "link": "https://stackoverflow.com/questions/56245062/what-is-the-difference-between-nodelay-and-cbreak-in-ncurses", "title": "What is the difference between nodelay() and cbreak() in ncurses?", "body": "<p>What is the difference between <code>nodelay()</code> and <code>cbreak()</code> in ncurses ? And why use these functions because we have <code>getch()</code>! If i have understand <code>getch()</code> permits to get the key directly just after the user hit the key. So <code>nodelay</code> and <code>cbreak</code> is useless isn't it ?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1558468170, "post_id": 56244948, "comment_id": 99109314, "body": "You probably want to <code>fflush</code> after the <code>printf</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1558484863, "post_id": 56244948, "comment_id": 99113928, "body": "You&#39;re reading and writing single characters via the read/write calls.  You aren&#39;t checking that the <code>open()</code> calls succeed; you aren&#39;t heeding the values returned by <code>read()</code> or <code>write()</code>.  There&#39;s nothing shown that&#39;s reading from the files mentioned. The random-ish number probably comes from uninitialized data in some form.  Please read about how to create an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>).  What you&#39;ve provided is a bit too minimal, I fear."}, {"owner": {"reputation": 23, "user_id": 11511843, "user_type": "registered", "profile_image": "https://graph.facebook.com/815185545518453/picture?type=large", "display_name": "Theodor3699", "link": "https://stackoverflow.com/users/11511843/theodor3699"}, "edited": false, "score": 0, "creation_date": 1558514640, "post_id": 56244948, "comment_id": 99122729, "body": "David Schwartz thank you, i forgot about the fflush."}, {"owner": {"reputation": 23, "user_id": 11511843, "user_type": "registered", "profile_image": "https://graph.facebook.com/815185545518453/picture?type=large", "display_name": "Theodor3699", "link": "https://stackoverflow.com/users/11511843/theodor3699"}, "edited": false, "score": 0, "creation_date": 1558514692, "post_id": 56244948, "comment_id": 99122759, "body": "Jonathan Leffler, i&#39;m sorry if my question was a bit unclear, it was my first time posting. Anyway, thanks for your help, i&#39;ll keep that in mind in the future!"}], "owner": {"reputation": 23, "user_id": 11511843, "user_type": "registered", "profile_image": "https://graph.facebook.com/815185545518453/picture?type=large", "display_name": "Theodor3699", "link": "https://stackoverflow.com/users/11511843/theodor3699"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558484061, "creation_date": 1558465656, "last_edit_date": 1558484061, "question_id": 56244948, "link": "https://stackoverflow.com/questions/56244948/generating-a-random-number-when-2-exes-are-being-executed-simultaneously", "title": "Generating a random number when 2 exe&#39;s are being executed simultaneously", "body": "<p>I'm trying to solve the following problem : \n2 files are given : \"names.txt\" and \"phone.txt\". In \"names.txt\" there is a name on each line and in \"phone.txt\" there is a phone number on each line.\nname.c reads line by line from \"names.txt\", phone.c reads line by line from \"phone.txt\". Both of name.c and phone.c will need to syncronize their execution(using fifo communication channels) such that there will be printed a name and a phone number.</p>\n\n<p>I've tried swaping fifo1 with fifo2 100 times as this seemed to be the problem the last time, but this time with no success</p>\n\n<p>this it the part of phone.c using fifo channels :</p>\n\n<pre><code>if (-1==mkfifo(\"fifo1\",0600))\n{\n    if (errno!=EEXIST)\n        perror(\"crearea a esuat\");\n}\n\nif (-1==mkfifo(\"fifo2\",0600))\n{\n    if (errno!=EEXIST) perror(\"crearea a esuat\");\n}\n\nfifo1=open(\"fifo1\",O_RDONLY);\nfifo2=open(\"fifo2\",O_WRONLY);\n\nfor (int j=0;j&lt;=n;j++)\n{\n    read(fifo1,&amp;ch,1);\n\n    printf(\"%s\",string[j]);\n\n    write(fifo2,&amp;ch,1);\n}\n</code></pre>\n\n<p>and this is the part using fifo channels from name.c</p>\n\n<pre><code>if (-1==mkfifo(\"fifo1\",0600) )\n{\n    if (errno!=EEXIST)\n        perror(\"crearea a esuat\");\n}\n\nfifo1=open(\"fifo1\",O_WRONLY);\nfifo2=open(\"fifo2\",O_RDONLY);\n\nfor (int j=0;j&lt;=n;j++)\n{\n    printf(\"\\n%s \",string[j]);\n    write(fifo1,&amp;ch,1);\n    read(fifo2,&amp;ch,1);\n}\n</code></pre>\n\n<p>It prints a random number like \"2742\" and then the contents of \"name.txt\", but no phone numbers are printed after each name.</p>\n"}, {"tags": ["c", "cursor", "gtk", "mouse", "gtk3"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1558465060, "post_id": 56244516, "comment_id": 99108014, "body": "Can you do it by changing the cursor to a fully transparent background icon?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 2, "creation_date": 1558465139, "post_id": 56244516, "comment_id": 99108046, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/44453139/how-to-hide-mouse-pointer-in-gtk-c\">How to hide mouse pointer in GTK C</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1558465238, "post_id": 56244516, "comment_id": 99108084, "body": "Love the <code>gdk_cursor_new(GDK_BLANK_CURSOR);</code>."}, {"owner": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "edited": false, "score": 1, "creation_date": 1558505836, "post_id": 56244516, "comment_id": 99118253, "body": "I&#39;d suggest using a game toolkit for making a Minecraft clone. GTK might not be the right tool for this job."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11455768"}, "reply_to_user": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "edited": false, "score": 0, "creation_date": 1558534375, "post_id": 56244516, "comment_id": 99134314, "body": "@ptomato I beg to differ, as cairo (which in my understanding is part of gtk) can draw shapes, including quadriladerals and each minecraft pixel in the game could be a quadriladeral. Other tools would be easier, yes, but I can make GTK work."}, {"owner": {"reputation": 698, "user_id": 1981374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1afd547bb1f448490439e0093eba3a70?s=128&d=identicon&r=PG", "display_name": "pan-mroku", "link": "https://stackoverflow.com/users/1981374/pan-mroku"}, "edited": false, "score": 0, "creation_date": 1559311390, "post_id": 56244516, "comment_id": 99391601, "body": "Why do you need to set it&#39;s position? Would grabbing the pointer inside the window work for you?"}], "owner": {"user_type": "does_not_exist", "display_name": "user11455768"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 213, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1613367299, "creation_date": 1558463895, "last_edit_date": 1558465107, "question_id": 56244516, "link": "https://stackoverflow.com/questions/56244516/how-do-i-hide-the-mouse-cursor-and-set-its-position-in-gtk3", "title": "How do I hide the mouse cursor and set its position in gtk3?", "body": "<p>I am trying to make a game where you move the mouse to change your view but you cannot see the mouse and the mouse needs to be stuck in the center, similar to in minecraft. In fact, this IS for my own personal knockoff of Minecraft. I need to hide cursor, and constantly setting the position of the cursor to the center. BUT I still need to track mouse movement, so I can change the view accordingly. These are my codes for how to find the center of the window.</p>\n\n<pre><code>int CenterY = gtk_widget_get_allocated_height(Window)/2;\nint CenterX = gtk_widget_get_allocated_Width(Window)/2;\n</code></pre>\n\n<p><em>How shall I proceed?</em></p>\n"}, {"tags": ["c", "mqtt", "paho"], "answers": [{"tags": [], "owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "is_accepted": true, "score": 2, "last_activity_date": 1558473718, "creation_date": 1558473718, "answer_id": 56246525, "question_id": 56244510, "link": "https://stackoverflow.com/questions/56244510/what-is-difference-between-mqttasync-onsuccess-and-mqttasync-deliverycomplete-ca/56246525#56246525", "title": "What is difference between MQTTAsync_onSuccess and MQTTAsync_deliveryComplete callbacks?", "body": "<p>Basically MQTTAsync_deliveryComplete and MQTTAsync_onSuccess do the same, they notify you via callback about the delivery of a message. Both callbacks are executed asynchronously on a separate thread to the thread on which the client application is running.</p>\n\n<p>(Both callbacks are even using the same thread in the case of the current version of the Paho client, but this is a non-documented implementation detail. This thread used by MQTTAsync_deliveryComplete and MQTTAsync_onSuccess is of course not the application thread otherwise it would not be an asynchronous callback).</p>\n\n<p>The difference is that MQTTAsync_deliveryComplete callback is set <em>once</em> via MQTTAsync_setCallbacks and then you are informed about <em>every</em> delivery of a message. </p>\n\n<p>In contrast to this, the MQTTAsync_onSuccess informs you <em>once</em> for exactly the message that you send out via MQTTAsync_sendMessage().</p>\n\n<p>You can even define both callbacks, which will <em>both</em> be called when a message is delivered. </p>\n\n<p>This gives you the flexibility to choose the approach that best suits your needs. </p>\n\n<p><strong>Artificial example</strong></p>\n\n<p>Suppose you have three different functions, each sending a specific type of message (e.g. sendTemperature(), sendHumidity(), sendAirPressure()) and in each function you call MQTTAsync_sendMessage, and after each delivery you want to call a matching callback function, then you would choose MQTTAsync_onSuccess. Then you do not need to keep track of MQTTAsync_token and associate that with your callbacks.</p>\n\n<p>For example, if you want to implement a logging function instead, it would be more useful to use MQTTAsync_deliveryComplete because it is called for <em>every</em> delivery. </p>\n\n<p>And of course one can imagine that one would want to have both the specific one with some actions and the generic one for logging, so in this case both variants could be used at the same time.</p>\n\n<p><strong>Documentation</strong></p>\n\n<p>You should note that MQTTAsync_deliveryComplete explicitly states in its documentation that it takes into account the Quality of Service Set. This is not the case in the MQTTAsync_onSuccess documentation, but of course it does not mean that this is not done in the implementation. But if this is important, you should explicitly check the source code.  </p>\n"}], "owner": {"reputation": 3787, "user_id": 5437543, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ad76496c936d384dac2888bae0126dde?s=128&d=identicon&r=PG&f=1", "display_name": "StoneThrow", "link": "https://stackoverflow.com/users/5437543/stonethrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 56246525, "answer_count": 1, "score": 1, "last_activity_date": 1558473718, "creation_date": 1558463874, "question_id": 56244510, "link": "https://stackoverflow.com/questions/56244510/what-is-difference-between-mqttasync-onsuccess-and-mqttasync-deliverycomplete-ca", "title": "What is difference between MQTTAsync_onSuccess and MQTTAsync_deliveryComplete callbacks?", "body": "<p>I'm learning about MQTT (specifically the paho C library) by reading and experimenting with variations on the async <a href=\"https://www.eclipse.org/paho/files/mqttdoc/MQTTAsync/html/publish.html\" rel=\"nofollow noreferrer\">pub</a>/<a href=\"https://www.eclipse.org/paho/files/mqttdoc/MQTTAsync/html/subscribe.html\" rel=\"nofollow noreferrer\">sub</a> examples.</p>\n\n<p>What's the difference between the   <a href=\"https://www.eclipse.org/paho/files/mqttdoc/MQTTAsync/html/_m_q_t_t_async_8h.html#ab10296618e266b3c02fd117d6616b15d\" rel=\"nofollow noreferrer\">MQTTAsync_deliveryComplete</a> callback that you set with <a href=\"https://www.eclipse.org/paho/files/mqttdoc/MQTTAsync/html/_m_q_t_t_async_8h.html#ae9ae8d61023e7029ef5a19f5219c3599\" rel=\"nofollow noreferrer\">MQTTAsync_setCallbacks()</a> vs. the <a href=\"https://www.eclipse.org/paho/files/mqttdoc/MQTTAsync/html/_m_q_t_t_async_8h.html#a7b0c18a0e29e2ce73f3ea109bc32617b\" rel=\"nofollow noreferrer\">MQTTAsync_onSuccess</a> or <a href=\"https://www.eclipse.org/paho/files/mqttdoc/MQTTAsync/html/_m_q_t_t_async_8h.html#a892cf122e6e8d8f6cd38c4c8efe8fb67\" rel=\"nofollow noreferrer\">MQTTAsync_onSuccess5</a> callbacks that you set in the <a href=\"https://www.eclipse.org/paho/files/mqttdoc/MQTTAsync/html/struct_m_q_t_t_async__response_options.html\" rel=\"nofollow noreferrer\">MQTTAsync_responseOptions</a> struct that you pass to <a href=\"https://www.eclipse.org/paho/files/mqttdoc/MQTTAsync/html/_m_q_t_t_async_8h.html#a5687171e67e98f9ea590c9e3b64cde18\" rel=\"nofollow noreferrer\">MQTTAsync_sendMessage()</a> ?</p>\n\n<p>All seem to deal with \"successful delivery\" of published messages, but from reading the example code and doxygen, I can't tell how they relate to or conflict with or supplement each other. Grateful for any guidance.</p>\n"}, {"tags": ["c++", "c", "integer", "c-preprocessor", "suffix"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 9, "creation_date": 1558463054, "post_id": 56244247, "comment_id": 99107213, "body": "C11 <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.10.1p4\" rel=\"nofollow noreferrer\">&#167;6.10.1 Conditional inclusion &#182;4</a>: \u2026 <i>For the purposes of this token conversion and evaluation, all signed integer types and all unsigned integer types act as if they have the same representation as, respectively, the types <code>intmax_t</code> and <code>uintmax_t</code> defined in the header <code>&lt;stdint.h&gt;</code>.</i> \u2026"}], "answers": [{"comments": [{"owner": {"reputation": 605, "user_id": 1281339, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/414306a964d249899754edda720bd057?s=128&d=identicon&r=PG", "display_name": "Michi", "link": "https://stackoverflow.com/users/1281339/michi"}, "edited": false, "score": 0, "creation_date": 1558473054, "post_id": 56244596, "comment_id": 99111262, "body": "About <i>So the expressions that can appear in #if statements are the same as the integer constant expressions that can appear generally in C.</i>: I guess not quite. A footnote in chapter &quot;Constant expressions&quot; reads <i>Further constraints that apply to the integer constant expressions used in conditional-inclusion preprocessing directives are discussed in 6.10.1.</i> and then in a footnote of 6.10.1: <i>Because the controlling constant expression is evaluated during translation phase 4, all identifiers either are or are not macro names \u2014 there simply are no keywords, enumeration constants, etc.</i>"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 605, "user_id": 1281339, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/414306a964d249899754edda720bd057?s=128&d=identicon&r=PG", "display_name": "Michi", "link": "https://stackoverflow.com/users/1281339/michi"}, "edited": false, "score": 0, "creation_date": 1558485560, "post_id": 56244596, "comment_id": 99114027, "body": "@Michi: That is discussed starting with the sentence immediately after where you stopped the quote, beginning \u201cHowever\u201d and concluding \u201cThus, a <code>#if</code> expression can only have operands that are constants and defined expressions.\u201d."}, {"owner": {"reputation": 605, "user_id": 1281339, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/414306a964d249899754edda720bd057?s=128&d=identicon&r=PG", "display_name": "Michi", "link": "https://stackoverflow.com/users/1281339/michi"}, "edited": false, "score": 0, "creation_date": 1558520579, "post_id": 56244596, "comment_id": 99126126, "body": "Ok, now I get what you mean. I was confused by just reading <code>sizeof</code> and <code>_Alignof</code>. I didn&#39;t get the whole meaning before. Anyway, I think we mean the same thing."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 6, "last_activity_date": 1558464659, "last_edit_date": 1592644375, "creation_date": 1558464260, "answer_id": 56244596, "question_id": 56244247, "link": "https://stackoverflow.com/questions/56244247/to-which-degree-does-the-c-preprocessor-regard-integer-literal-suffixes/56244596#56244596", "title": "To which degree does the C preprocessor regard integer literal suffixes?", "body": "<p>C 2018 6.10.1 deals with conditional inclusion (<code>#if</code> and related statements and the <code>defined</code> operator). Paragraph 1 says:</p>\n<blockquote>\n<p>The expression that controls conditional inclusion shall be an integer constant expression except that: identifiers (including those lexically identical to keywords) are interpreted as described below; and it may contain unary operator expressions of the form</p>\n<p><code>defined</code> <em>identifier</em></p>\n<p>or</p>\n<p><code>defined</code> <code>(</code> <em>identifier</em> <code>)</code> \u2026</p>\n</blockquote>\n<p><em>Integer constant expression</em> is defined in 6.6 6:</p>\n<blockquote>\n<p>An <em>integer constant expression</em> shall have integer type and shall only have operands that are integer constants, enumeration constants, character constants, <code>sizeof</code> expressions whose results are integer constants, <code>_Alignof</code> expressions, and floating constants that are the immediate operands of casts. Cast operators in an integer constant expression shall only convert arithmetic types to integer types, except as part of an operand to the <code>sizeof</code> or <code>_Alignof</code> operator.</p>\n</blockquote>\n<p>That paragraph is for C generally, not just the preprocessor. So the expressions that can appear in <code>#if</code> statements are the same as the integer constant expressions that can appear generally in C. However, as stated in the quote above, <code>sizeof</code> and <code>_Alignof</code> are just identifiers; they are not recognized as C operators. In particular, 6.10.1 4 tells us:</p>\n<blockquote>\n<p>\u2026 After all replacements due to macro expansion and the <code>defined</code> unary operator have been performed, all remaining identifiers (including those lexically identical to keywords) are replaced with the pp-number <code>0</code>,\u2026</p>\n</blockquote>\n<p>So, where <code>sizeof</code> or <code>_Alignof</code> appear in a <code>#if</code> expression, it becomes <code>0</code>. Thus, a <code>#if</code> expression can only have operands that are constants and <code>defined</code> expressions.</p>\n<p>Paragraph 4 goes on to say:</p>\n<blockquote>\n<p>\u2026 The resulting tokens compose the controlling constant expression which is evaluated according to the rules of 6.6. For the purposes of this token conversion and evaluation, all signed integer types and all unsigned integer types act as if they have the same representation as, respectively, the types <code>intmax_t</code> and <code>uintmax_t</code> defined in the header <code>&lt;stdint.h&gt;</code>.\u2026</p>\n</blockquote>\n<p>6.6 is the section for constant expressions.</p>\n<p>So, the compiler will accept integer suffixes in <code>#if</code> expressions, and that does not depend on the C implementation (for the suffixes required in the core C language; implementations could allow extensions). However, all the arithmetic will be performed using <code>intmax_t</code> or <code>uintmax_t</code>, and those do depend on the implementation. If your expressions do not depend on the width of integers above the minimum required<sup>1</sup>, they should be evaluated the same in any C implementation.</p>\n<p>Additionally, paragraph 4 goes on to say there may be some variations with character constants and values, which I omit here as it is not relevant to this question.</p>\n<h2>Footnote</h2>\n<p><sup>1</sup> <code>intmax_t</code> designates a signed type capable of representing any value of any signed integer type (7.20.1.5 1), and <code>long long int</code> is a signed type that must be at least 64 bits (5.2.4.2.1 1), so any conforming C implementation must provide 64-bit integer arithmetic in the preprocessor.</p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1558464930, "post_id": 56244625, "comment_id": 99107954, "body": "The preprocessor cannot ignore the suffixes. It might ignore their width effects, but not the signedness."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 6, "last_activity_date": 1558473303, "last_edit_date": 1592644375, "creation_date": 1558464340, "answer_id": 56244625, "question_id": 56244247, "link": "https://stackoverflow.com/questions/56244247/to-which-degree-does-the-c-preprocessor-regard-integer-literal-suffixes/56244625#56244625", "title": "To which degree does the C preprocessor regard integer literal suffixes?", "body": "<p>As I noted in a comment, this is defined in the C standard.  Here's the complete text of  \u00a76.10.1 \u00b64 (and the two footnotes):</p>\n<blockquote>\n<p><strong>C11 <a href=\"https://port70.net/%7Ensz/c/c11/n1570.html#6.10.1\" rel=\"nofollow noreferrer\">\u00a76.10.1 Conditional inclusion</a></strong>\n\u2026</p>\n<p><a href=\"https://port70.net/%7Ensz/c/c11/n1570.html#6.10.1p4\" rel=\"nofollow noreferrer\">\u00b64</a> Prior to evaluation, macro invocations in the list of preprocessing tokens that will become the controlling constant expression are replaced (except for those macro names modified by the <code>defined</code> unary operator), just as in normal text. If the token defined is generated as a result of this replacement process or use of the <code>defined</code> unary operator does not match one of the two specified forms prior to macro replacement, the behavior is undefined. After all replacements due to macro expansion and the <code>defined</code> unary operator have been performed, all remaining identifiers (including those lexically identical to keywords) are replaced with the pp-number 0, and then each preprocessing token is converted into a token. The resulting tokens compose the controlling constant expression which is evaluated according to the rules of <a href=\"https://port70.net/%7Ensz/c/c11/n1570.html#6.6\" rel=\"nofollow noreferrer\">6.6</a>. For the purposes of this token conversion and evaluation, all signed integer types and all unsigned integer types act as if they have the same representation as, respectively, the types <code>intmax_t</code> and <code>uintmax_t</code> defined in the header <code>&lt;stdint.h&gt;</code>.<sup>167)</sup> This includes interpreting character constants, which may involve converting escape sequences into execution character set members. Whether the numeric value for these character constants matches the value obtained when an identical character constant occurs in an expression (other than within a <code>#if</code> or <code>#elif</code> directive) is implementation-defined.<sup>168)</sup> Also, whether a single-character character constant may have a negative value is implementation-defined.</p>\n<p><sup>167</sup> 167) Thus, on an implementation where <code>INT_MAX</code> is <code>0x7FFF</code> and <code>UINT_MAX</code> is <code>0xFFFF</code>, the constant <code>0x8000</code> is signed and positive within a <code>#if</code> expression even though it would be unsigned in translation phase 7.</p>\n<p><sup>168</sup> Thus, the constant expression in the following <code>#if</code> directive and <code>if</code> statement is not guaranteed to evaluate to the same value in these two contexts.</p>\n<pre><code>#if 'z' - 'a' == 25\nif ('z' - 'a' == 25)\n</code></pre>\n</blockquote>\n<p>Section 6.6 is <a href=\"https://port70.net/%7Ensz/c/c11/n1570.html#6.6\" rel=\"nofollow noreferrer\">\u00a76.6 Constant expressions</a>, which details the differences between the full expressions in section <a href=\"https://port70.net/%7Ensz/c/c11/n1570.html#6.5\" rel=\"nofollow noreferrer\">\u00a76.5 Expressions</a> and constant expressions.</p>\n<p>In effect, the preprocessor largely ignores the suffixes.  Hexadecimal constants are unsigned.  The results you show are to be expected on a machine where <code>intmax_t</code> and <code>uintmax_t</code> are 64-bit quantities.  If the limits on the <code>intmax_t</code> and <code>uintmax_t</code> were larger, some of the expressions might change.</p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1558464849, "post_id": 56244695, "comment_id": 99107920, "body": "The suffixes of integer constants are meaningful to the preprocessor because they affect signedness. <code>-1u &lt; 0</code> evaluates to false, but <code>-1l &lt; 0</code> evaluates to true."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1558465267, "post_id": 56244695, "comment_id": 99108093, "body": "Yes, @EricPostpischil, they affect evaluation of the control expressions of <code>#if</code> directives.  I&#39;m perhaps splitting hairs too finely here, but although that&#39;s meaningful to C, I do not consider it meaningful <i>to the preprocessor</i>."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1558466381, "post_id": 56244695, "comment_id": 99108619, "body": "<i>they affect evaluation of the control expressions of #if</i> <b><i>and</i></b> <i>I do not consider it meaningful to the preprocessor</i> seem incongruous."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1558466602, "post_id": 56244695, "comment_id": 99108709, "body": "Clearly the meanings of <code>-1u &lt; 0</code> and <code>-1l &lt; 0</code> in a <code>#if</code> statement are different, since they evaluate to different results, and the selection of which statements to include thus differs. And the only difference is the suffix. Therefore, the suffix is meaningful to preprocessing."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1558468848, "post_id": 56244695, "comment_id": 99109571, "body": "As I said, I am splitting hairs rather finely.  In particular, I am placing the evaluation of the expression outside the scope of the preprocessor proper, on account of (1) it operating on <i>tokens</i>, not preprocessing tokens, and (2) it being governed by the regular C rules for evaluation, as opposed to special rules pertaining to the preprocessor.  This is appropos to the question, which expresses surprise about the C syntax for integer constants being recognized and handled.  Yes it is, because no other is defined for the purpose."}, {"owner": {"reputation": 605, "user_id": 1281339, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/414306a964d249899754edda720bd057?s=128&d=identicon&r=PG", "display_name": "Michi", "link": "https://stackoverflow.com/users/1281339/michi"}, "edited": false, "score": 0, "creation_date": 1558472612, "post_id": 56244695, "comment_id": 99111085, "body": "Though confusing on the first read, I get John&#39;s point. Nicely structured answer!"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 5, "last_activity_date": 1558495451, "last_edit_date": 1558495451, "creation_date": 1558464613, "answer_id": 56244695, "question_id": 56244247, "link": "https://stackoverflow.com/questions/56244247/to-which-degree-does-the-c-preprocessor-regard-integer-literal-suffixes/56244695#56244695", "title": "To which degree does the C preprocessor regard integer literal suffixes?", "body": "<blockquote>\n  <ol>\n  <li>To which degree does the preprocessor regard integer literal suffixes? Or does it just ignore them?</li>\n  </ol>\n</blockquote>\n\n<p>The type suffixes of integer constants are not inherently meaningful to the preprocessor, but they are an inherent part of the corresponding preprocessing tokens, not separate.  The standard has this to say about them:</p>\n\n<blockquote>\n  <p>A preprocessing number begins with a digit optionally preceded by a\n  period (.) and may be followed by valid identifier characters and the\n  character sequences e+, e-, E+, E-, p+, p-, P+, or P-.</p>\n  \n  <p><strong>Preprocessing number tokens lexically include all floating and\n  integer constant tokens.</strong></p>\n</blockquote>\n\n<p>(<a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.4.8p2\" rel=\"nofollow noreferrer\">C11 6.4.8/2-3</a>; emphasis added)</p>\n\n<p>For the most part, the preprocessor doesn't treat preprocessing tokens of this type any differently than any other.  The exception is in the controlling expressions of <code>#if</code> directives, which are evaluated by performing macro expansion, replacing identifiers with 0, and then <em>converting each preprocessing token into a token</em> before evaluating the result according to C rules.  Converting to tokens accounts for the type suffixes, yielding <em>bona fide</em> integer constants.</p>\n\n<p>This does not necessarily produce results identical to those you would get from runtime evaluation of the same expressions, however, because</p>\n\n<blockquote>\n  <p>For the purposes of this token conversion and evaluation, all signed\n  integer types and all unsigned integer types act as if they have the\n  same representation as, respectively, the types <code>intmax_t</code> and <code>uintmax_t</code>.</p>\n</blockquote>\n\n<p>(<a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.10.1p4\" rel=\"nofollow noreferrer\">C2011, 6.10.1/4</a>)</p>\n\n<p>You go on to ask</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>Are there any dependencies or different behaviors with different environments, e.g. different compilers, C vs. C++, 32 bit vs. 64 bit machine, etc.? I.e., what does the preprocessor's behavior depend on?</li>\n  </ol>\n</blockquote>\n\n<p>The only direct dependency is the implementation's definitions of <code>intmax_t</code> and <code>uintmax_t</code>.  These are not directly tied to language choice or machine architecture, though there may be <em>correlations</em> with those.</p>\n\n<blockquote>\n  <ol start=\"3\">\n  <li>Where is all that specified/documented?</li>\n  </ol>\n</blockquote>\n\n<p>In the respective languages' language specifications, of course.  I've cited the two of the more relevant sections of the C11 specification, and linked you to a late draft of that standard.  (The current C is C18, but it hasn't changed in any of these regards.)</p>\n"}, {"tags": [], "owner": {"reputation": 605, "user_id": 1281339, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/414306a964d249899754edda720bd057?s=128&d=identicon&r=PG", "display_name": "Michi", "link": "https://stackoverflow.com/users/1281339/michi"}, "is_accepted": false, "score": 0, "last_activity_date": 1558476278, "creation_date": 1558476278, "answer_id": 56246907, "question_id": 56244247, "link": "https://stackoverflow.com/questions/56244247/to-which-degree-does-the-c-preprocessor-regard-integer-literal-suffixes/56246907#56246907", "title": "To which degree does the C preprocessor regard integer literal suffixes?", "body": "<p>TLDR dumbed down version:</p>\n\n<p><code>l</code> and <code>ll</code> are <strong>effectively</strong> (not literally!) ignored by the preprocessor conditionals (basically, everything is treated as if it had a <code>ll</code> suffix), however <code>u</code> is considered (normally, as for every C integer constant)!</p>\n\n<p>After reading all the marvelous answers, I created some more examples that reveal some expected but yet interesting behavior:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n#if (1 - 2u &gt; 0) // If one operand is unsigned, the result is unsigned.\n                 // Usual implicit type conversion.\n  printf(\"1 - 2u &gt; 0\\n\");\n#endif\n\n#if (0 &lt; 0xFFFFFFFFFFFFFFFF)\n  printf(\"0 &lt; 0xFFFFFFFFFFFFFFFF\\n\");\n#endif\n\n#if (-1 &lt; 0)\n  printf(\"-1 &lt; 0\\n\");\n#endif\n\n#if (-1 &lt; 0xFFFFFFFFFFFFFFFF)\n  printf(\"-1 &lt; 0xFFFFFFFFFFFFFFFF\\n\"); // nope\n#elif (-1 &gt; 0xFFFFFFFFFFFFFFFF)\n  printf(\"-1 &gt; 0xFFFFFFFFFFFFFFFF\\n\"); // nope, obviously\n#endif\n\n#if (-1 == 0xFFFFFFFFFFFFFFFF)\n  printf(\"-1 == 0xFFFFFFFFFFFFFFFF (!!!)\\n\");\n#endif\n}\n</code></pre>\n\n<p>With this output:</p>\n\n<pre><code>1 - 2u &gt; 0\n0 &lt; 0xFFFFFFFFFFFFFFFF\n-1 &lt; 0\n-1 == 0xFFFFFFFFFFFFFFFF (!!!)\n</code></pre>\n"}], "owner": {"reputation": 605, "user_id": 1281339, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/414306a964d249899754edda720bd057?s=128&d=identicon&r=PG", "display_name": "Michi", "link": "https://stackoverflow.com/users/1281339/michi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 527, "favorite_count": 0, "accepted_answer_id": 56244695, "answer_count": 4, "score": 13, "last_activity_date": 1558495451, "creation_date": 1558462679, "last_edit_date": 1558495148, "question_id": 56244247, "link": "https://stackoverflow.com/questions/56244247/to-which-degree-does-the-c-preprocessor-regard-integer-literal-suffixes", "title": "To which degree does the C preprocessor regard integer literal suffixes?", "body": "<p>Today, I stumbled over something like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#define FOO 2u\n\n#if (FOO == 2)\n  unsigned int foo = FOO;\n#endif\n</code></pre>\n\n<p>Regardless of why the code is as it is (let's not question the <code>why</code>), I was wondering to which degree the preprocessor can even handle integer literal suffixes. I was actually surprised that it works at all.\nAfter doing some experiments with <a href=\"https://www.tutorialspoint.com/compile_c99_online.php\" rel=\"noreferrer\">GCC and C99</a> with this code ...</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n  #if (1u == 1)\n    printf(\"1u == 1\\n\");\n  #endif\n\n  #if (1u + 1l == 2ll)\n    printf(\"1u + 1l == 2ll\\n\");\n  #endif\n\n  #if (1ull - 2u == -1)\n    printf(\"1ull - 2u == -1\\n\");\n  #endif\n\n  #if (1u - 2u == 0xFFFFFFFFFFFFFFFF)\n    printf(\"1u - 2u == 0xFFFFFFFFFFFFFFFF\\n\");\n  #endif\n\n  #if (-1 == 0xFFFFFFFFFFFFFFFF)\n    printf(\"-1 == 0xFFFFFFFFFFFFFFFF\\n\");\n  #endif\n\n  #if (-1l == 0xFFFFFFFFFFFFFFFF)\n    printf(\"-1l == 0xFFFFFFFFFFFFFFFF\\n\");\n  #endif\n\n  #if (-1ll == 0xFFFFFFFFFFFFFFFF)\n    printf(\"-1ll == 0xFFFFFFFFFFFFFFFF\\n\");\n  #endif\n}\n</code></pre>\n\n<p>... which just prints all the statements:</p>\n\n<pre><code>1u == 1\n1u + 1l == 2ll\n1ull - 2u == -1\n1u - 2u == 0xFFFFFFFFFFFFFFFF\n-1 == 0xFFFFFFFFFFFFFFFF\n-1l == 0xFFFFFFFFFFFFFFFF\n-1ll == 0xFFFFFFFFFFFFFFFF\n</code></pre>\n\n<p>... I guess the preprocessor simply ignores integer literal suffixes altogether and probably always does arithmetics and comparisons in the native integer size, in this case 64 bit?</p>\n\n<h3>So, here is the stuff I'd like to know:</h3>\n\n<ol>\n<li>To which degree does the preprocessor regard integer literal suffixes? Or does it just ignore them?</li>\n<li>Are there any dependencies or different behaviors with different environments, e.g. different compilers, C vs. C++, 32 bit vs. 64 bit machine, etc.? I.e., what does the preprocessor's behavior depend on?</li>\n<li>Where is all that specified/documented?</li>\n</ol>\n\n<p>I wanted to find out by myself and checked out\n<a href=\"https://en.wikipedia.org/wiki/C_preprocessor\" rel=\"noreferrer\">Wikipedia</a> and <a href=\"http://www.open-std.org/JTC1/SC22/WG14/www/standards\" rel=\"noreferrer\">the C standard (working paper)</a>. I found information about integer suffixes and information about the preprocessor, but none about the combination of these. Obviously, I have also googled it but didn't get any useful results.</p>\n\n<p>I have seen <a href=\"https://stackoverflow.com/questions/34514612/standards-for-the-c-and-or-c-preprocessors\">this Stack&nbsp;Overflow question</a> that clarifies where it <em>should</em> be specified, but yet, I couldn't find an answer for my questions.</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1558463161, "post_id": 56244226, "comment_id": 99107254, "body": "Check which package installs the <code>&#47;usr&#47;bin&#47;zip</code> binary. Then check the information about that package to find out what it&#39;s built from."}, {"owner": {"reputation": 112608, "user_id": 419, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/dySwp.jpg?s=128&g=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/419/kev"}, "edited": false, "score": 1, "creation_date": 1558464276, "post_id": 56244226, "comment_id": 99107705, "body": "I think what you&#39;re looking for is here: <a href=\"http://infozip.sourceforge.net/Zip.html#Sources\" rel=\"nofollow noreferrer\">infozip.sourceforge.net/Zip.html#Sources</a>  and the source code is here: <a href=\"https://sourceforge.net/projects/infozip/files/Zip%203.x%20%28latest%29/3.0/\" rel=\"nofollow noreferrer\">sourceforge.net/projects/infozip/files/Zip%203.x%20%28latest&zwnj;&#8203;%29/&hellip;</a>"}], "owner": {"reputation": 300, "user_id": 8328365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b458863d581d512f897f9bbc0ee42d20?s=128&d=identicon&r=PG&f=1", "display_name": "user8328365", "link": "https://stackoverflow.com/users/8328365/user8328365"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558462580, "creation_date": 1558462580, "question_id": 56244226, "link": "https://stackoverflow.com/questions/56244226/which-library-generates-the-zip-binary-not-libzip-so", "title": "Which library generates the &quot;zip&quot; binary (not libzip.so)?", "body": "<p>I want to compile my own version of <code>/usr/bin/zip</code> binary. I did a search on the web and found source code repo for <code>libzip</code>, but the compilation result is a bunch of <code>libzip.so</code>, missing the <code>/usr/bin/zip</code> binary. Which library should I search instead?</p>\n"}, {"tags": ["c", "errno"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1558461981, "post_id": 56243525, "comment_id": 99106750, "body": "You really don&#39;t want floating-point math functions to set <code>errno</code>. It&#39;s a bad idea and only kept for compatibility with legacy crap. Without it, code generation for modern architectures is much nicer, since the compiler can just use the <code>sqrt</code> instruction of the underlying hardware (causing the somewhat more sane ieee754 exception flag to be set on invalid operands), whereas it needs to emit extra code to set <code>errno</code> (which no sane programmer will use), so there is a compiler flag <code>-fno-math-errno</code> to get sane behavior."}], "answers": [{"tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 8, "last_activity_date": 1558460372, "creation_date": 1558460372, "answer_id": 56243714, "question_id": 56243525, "link": "https://stackoverflow.com/questions/56243525/why-errno-is-not-set-to-edom-even-sqrt-takes-out-of-domain-arguement/56243714#56243714", "title": "Why errno is not set to EDOM even sqrt takes out of domain arguement?", "body": "<p>The math functions are not required to set <code>errno</code>.  They <em>might</em>, but they don't have to.  See <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.12.1\" rel=\"noreferrer\">section 7.12.1 of the C standard</a>.  Theoretically you can inspect the value of the global constant <code>math_errhandling</code> to find out whether they will, but that's not fully reliable on any implementation I know of, and may not even be defined (it's a macro, so you can at least use <code>#ifdef</code> to check for it).</p>\n\n<p>Instead, you can check whether the input is negative before calling <code>sqrt</code>, or (if your implementation properly supports IEEE 754 in detail) you can check whether the output is NaN (using <code>isnan</code>) afterward.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 4, "last_activity_date": 1558462281, "creation_date": 1558462281, "answer_id": 56244152, "question_id": 56243525, "link": "https://stackoverflow.com/questions/56243525/why-errno-is-not-set-to-edom-even-sqrt-takes-out-of-domain-arguement/56244152#56244152", "title": "Why errno is not set to EDOM even sqrt takes out of domain arguement?", "body": "<p>As @zwol observed, the Standard allows implementations some latitude with respect to how (and whether) the math functions signal errors.  In particular:</p>\n\n<blockquote>\n  <p>On a domain error, the function returns an implementation-defined\n  value; if the integer expression <code>math_errhandling &amp; MATH_ERRNO</code> is\n  nonzero, the integer expression <code>errno</code> acquires the value <code>EDOM</code>; if the\n  integer expression <code>math_errhandling &amp; MATH_ERREXCEPT</code> is nonzero, the\n  ''invalid'' floating-point exception is raised.</p>\n</blockquote>\n\n<p>(<a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.12.1p2\" rel=\"nofollow noreferrer\">C11, paragraph 7.12.1/2</a>)</p>\n\n<p>Upon a domain error in <code>sqrt</code>, </p>\n\n<ul>\n<li><p>On Linux with <a href=\"https://linux.die.net/man/3/sqrt\" rel=\"nofollow noreferrer\">glibc</a>, <code>NaN</code> is returned, <code>errno</code> is set to <code>EDOM</code>, and a floating-point exception is raised.</p></li>\n<li><p>On Windows with recent MS runtime library, an indefinite NaN is returned, and a floating-point exception is raised, maybe (<a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/sqrt-sqrtf-sqrtl?view=vs-2019\" rel=\"nofollow noreferrer\">the docs</a> are a bit unclear to me, but definitely some kind of status flag is set that you can subsequently evaluate via the <code>_matherr()</code> function).  There is no mention of setting <code>errno</code>.</p></li>\n</ul>\n"}], "owner": {"reputation": 111, "user_id": 11195189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c9698da99c13d8f5e749a5e0db74d9d?s=128&d=identicon&r=PG&f=1", "display_name": "Tilak_Chad", "link": "https://stackoverflow.com/users/11195189/tilak-chad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1558462281, "creation_date": 1558459546, "question_id": 56243525, "link": "https://stackoverflow.com/questions/56243525/why-errno-is-not-set-to-edom-even-sqrt-takes-out-of-domain-arguement", "title": "Why errno is not set to EDOM even sqrt takes out of domain arguement?", "body": "<p>errno is not being set to EDOM for domain error of sqrt() function in    windows \nIt shows correctly on Linux but failed on windows (Using GCC 7.4) ...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;math.h&gt;\n\nint main () {\ndouble val;\n\nerrno = 0;\nval = sqrt(-10);\n\nif(errno == EDOM) {\nprintf(\"Invalid value \\n\");\n} else {\nprintf(\"Valid value\\n\");\n} \n\nerrno = 0;\nval = sqrt(10);\n\nif(errno == EDOM) {\nprintf(\"Invalid value\\n\");\n} else {\nprintf(\"Valid value\\n\");\n}\n\nreturn(0);\n}\n</code></pre>\n\n<p>Expected result : Invalid value\n                      Valid value\nActual result : Valid value\n                    Valid value</p>\n"}, {"tags": ["c", "type-conversion", "stdint"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1558459429, "post_id": 56243419, "comment_id": 99105618, "body": "<i>I have two variables uint32_t that represent the high and low value of a double</i> ... in your code I see two <code>uint64_t</code> not two <code>uint32_t</code>, is this a typo?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1558459431, "post_id": 56243419, "comment_id": 99105620, "body": "The <code>printf()</code> line converts the integer that represents the bit pattern for a double into a double, which isn&#39;t what you want.  You&#39;ll need to do something like: <code>*(double *)&amp;double_value</code>."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1558459583, "post_id": 56243419, "comment_id": 99105703, "body": "<code>double_value = (high_arg &lt;&lt; 32) | low_arg;</code> takes the bits in <code>high_arg</code> and <code>low_arg</code> and puts them together into one 64-bit integer, and then it assigns that integer <b>value</b> to <code>double_value</code>. Since the bits have bit 62 set (bit 30 in <code>high_arg</code>), the result is 2**32, which is about 4.61169e18. To make a <code>double</code> value from the bits, you need to set the <b>bytes</b> that represent the <code>double</code> to the <b>bytes</b> that are in the <code>Double</code> member. If there are no endianness issues involved, you can do this simply with <code>double x; memcpy(&amp;x, &amp;cp[cpIndex-1].info.Double, sizeof x);</code>."}, {"owner": {"reputation": 35, "user_id": 11535195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VSsqeeLFAjY/AAAAAAAAAAI/AAAAAAAAMJ0/ofacHO5HucU/photo.jpg?sz=128", "display_name": "Gabriel Vasconcelos", "link": "https://stackoverflow.com/users/11535195/gabriel-vasconcelos"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1558460047, "post_id": 56243419, "comment_id": 99105906, "body": "@KeineLust cp[cpIndex-1].info.Double.high_bytes and low_bytes are uint32_t type, and I&#39;m casting it to uint64_t. Sorry for not clarifying that!"}, {"owner": {"reputation": 35, "user_id": 11535195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VSsqeeLFAjY/AAAAAAAAAAI/AAAAAAAAMJ0/ofacHO5HucU/photo.jpg?sz=128", "display_name": "Gabriel Vasconcelos", "link": "https://stackoverflow.com/users/11535195/gabriel-vasconcelos"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1558460115, "post_id": 56243419, "comment_id": 99105940, "body": "@JonathanLeffler That worked out, thanks a lot!!"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1558460303, "post_id": 56243419, "comment_id": 99106020, "body": "Glad it worked.  Don&#39;t turn on &#39;strict aliasing&#39; checks \u2014 that expression will fail them.  You might evade them by going via an intermediate <code>(char *)</code> cast: <code>*(double *)(char *)&amp;double_value</code>, or the compiler might spot what you&#39;re doing and object (or, alternatively, it might not spot what you&#39;re doing and object).  I&#39;ve not investigated.  Beware thin ice."}, {"owner": {"reputation": 35, "user_id": 11535195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VSsqeeLFAjY/AAAAAAAAAAI/AAAAAAAAMJ0/ofacHO5HucU/photo.jpg?sz=128", "display_name": "Gabriel Vasconcelos", "link": "https://stackoverflow.com/users/11535195/gabriel-vasconcelos"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1558460432, "post_id": 56243419, "comment_id": 99106068, "body": "@EricPostpischil Now I see why it was printing that value! Thanks for explaining it so well!!"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1558460703, "post_id": 56243419, "comment_id": 99106191, "body": "The code in the question does not show the definition of <code>cp</code>, particularly the definition of the structure <code>Double</code>. In the future, include <b>all</b> relevant code in the question. Where there is too much code, rework the code into a manageable example. You should provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 35, "user_id": 11535195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VSsqeeLFAjY/AAAAAAAAAAI/AAAAAAAAMJ0/ofacHO5HucU/photo.jpg?sz=128", "display_name": "Gabriel Vasconcelos", "link": "https://stackoverflow.com/users/11535195/gabriel-vasconcelos"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1558460929, "post_id": 56243419, "comment_id": 99106276, "body": "@EricPostpischil Sure, it was my first question, thanks for clearing that out."}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1558461702, "post_id": 56243814, "comment_id": 99106640, "body": "<code>memcpy</code> is a proper way to do this in C. Aliasing via pointer conversion is not. In C, but not C++, reinterpretation can also be done with a union."}], "tags": [], "owner": {"reputation": 35, "user_id": 11535195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VSsqeeLFAjY/AAAAAAAAAAI/AAAAAAAAMJ0/ofacHO5HucU/photo.jpg?sz=128", "display_name": "Gabriel Vasconcelos", "link": "https://stackoverflow.com/users/11535195/gabriel-vasconcelos"}, "is_accepted": false, "score": 1, "last_activity_date": 1558460772, "creation_date": 1558460772, "answer_id": 56243814, "question_id": 56243419, "link": "https://stackoverflow.com/questions/56243419/cant-convert-a-uint64-t-to-a-double-properly-what-am-i-missing/56243814#56243814", "title": "Can&#39;t convert a uint64_t to a double properly. What am I missing?", "body": "<p>The sollution, as @JonathanLeffler wisely pointed out, was to cast the integer that represented the double as double pointer, and them print its content.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>printf(\"%f\", *(double *)&amp;double_value);\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 11535195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VSsqeeLFAjY/AAAAAAAAAAI/AAAAAAAAMJ0/ofacHO5HucU/photo.jpg?sz=128", "display_name": "Gabriel Vasconcelos", "link": "https://stackoverflow.com/users/11535195/gabriel-vasconcelos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558460772, "creation_date": 1558459174, "question_id": 56243419, "link": "https://stackoverflow.com/questions/56243419/cant-convert-a-uint64-t-to-a-double-properly-what-am-i-missing", "title": "Can&#39;t convert a uint64_t to a double properly. What am I missing?", "body": "<p>To give some background, I'm coding the JVM for Java 8 in C, and I'm trying to print the Double value located in the Constant Pool.</p>\n\n<p>I have two variables uint32_t that represent the high and low value of a double. I'm trying to print this double but I can't figure out what is wrong with my code.</p>\n\n<p>I've tried printing all values to check.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>uint64_t high_arg, low_arg, double_value;\n\nhigh_arg = cp[cpIndex-1].info.Double.high_bytes; // value is = 0x0000000040000000\nlow_arg = cp[cpIndex-1].info.Double.low_bytes; // value is = 0x0000000000000000\ndouble_value = (high_arg &lt;&lt; 32) | low_arg; // value is = 0x4000000000000000\nprintf(\"%f\\n\", (double)double_value);\n</code></pre>\n\n<p>It prints <code>double:4.61169e+18</code> but is was supposed to return <code>2</code></p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1558458322, "post_id": 56243156, "comment_id": 99105106, "body": "Like this: <code>if(++seqnum &gt; maxnum) { seqnum = 0; }</code>"}, {"owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 1, "creation_date": 1558458351, "post_id": 56243156, "comment_id": 99105126, "body": "Also <code>int sequence_num = &lt;some negative value, not 0&gt;</code>."}, {"owner": {"reputation": 123, "user_id": 3315702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IdOHa.jpg?s=128&g=1", "display_name": "raj", "link": "https://stackoverflow.com/users/3315702/raj"}, "edited": false, "score": 0, "creation_date": 1558461656, "post_id": 56243156, "comment_id": 99106622, "body": "Thanks, now it makes sense to me."}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 3315702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IdOHa.jpg?s=128&g=1", "display_name": "raj", "link": "https://stackoverflow.com/users/3315702/raj"}, "edited": false, "score": 0, "creation_date": 1558461748, "post_id": 56243367, "comment_id": 99106650, "body": "I agree and that&#39;s what I wanted to know as to how to go about it. You have clarified my doubts.  Thanks..."}], "tags": [], "owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "is_accepted": false, "score": 2, "last_activity_date": 1558458958, "creation_date": 1558458958, "answer_id": 56243367, "question_id": 56243156, "link": "https://stackoverflow.com/questions/56243156/lollipop-sequence-numbering/56243367#56243367", "title": "Lollipop sequence numbering", "body": "<p>You're not starting from a negative number and you're not cycling, where's your lollipop?</p>\n\n<p>As @WeatherVane and @0x5453 suggest, do something like:</p>\n\n<pre><code>const int start_value = -10;  // where you begin\nconst int max_value = 10; // where you loop\n\nint sequence_num = start_value;\n\ngenerate_data_packet();\n\n++sequence_num;\nif (sequence_num &gt; max_value) {\n    sequence_num = 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 3315702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IdOHa.jpg?s=128&g=1", "display_name": "raj", "link": "https://stackoverflow.com/users/3315702/raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1558462050, "creation_date": 1558458026, "last_edit_date": 1558462050, "question_id": 56243156, "link": "https://stackoverflow.com/questions/56243156/lollipop-sequence-numbering", "title": "Lollipop sequence numbering", "body": "<p>I am using an embedded wireless system where it generates data packets at a defined time interval. The aim is to detect when the device/system is rebooted. For this, I read that Lollipop sequence numbering is a numbering scheme best fitted for this.</p>\n\n<p>\"In this numbering scheme, sequence numbers start at a negative value, increase until they reach zero, then cycle through a finite set of positive numbers indefinitely. When a system is rebooted, the sequence is restarted from a negative number again. This allows recently rebooted systems to be distinguished from systems which have simply looped around their numbering space.\"\" </p>\n\n<p>Although, I know the theory of how it works, have not been able to implement in C for my platform.</p>\n\n<p>My algorithm is very simple and works as such:</p>\n\n<pre><code>int sequence_num = 0;\n\ngenerate_data_packet();\n\nsequence_num++;\n</code></pre>\n\n<p>This sequence_num has to be lollipop sequence numbering pattern.</p>\n\n<p>Can anyone provide some code snippets as to how this might look like in C?</p>\n"}, {"tags": ["c", "sockets", "windows-socket-api"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1558457619, "post_id": 56243007, "comment_id": 99104809, "body": "ws2_32.lib is the correct lib. If mingw doesn&#39;t support <code>pragma comment(lib ...)</code> (and it would seem it doesn&#39;t, at least from your results) then you need to add that lib to your link step yourself"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 10846, "user_id": 1673776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0llsY.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/1673776/victor"}, "edited": false, "score": 0, "creation_date": 1558467622, "post_id": 56243007, "comment_id": 99109094, "body": "@Victor filenames are case-insensitive on Windows. <code>&quot;Ws2_32.lib&quot;</code> and <code>&quot;ws2_32.lib&quot;</code> refer to the same file."}, {"owner": {"reputation": 10846, "user_id": 1673776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0llsY.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/1673776/victor"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1558469137, "post_id": 56243007, "comment_id": 99109701, "body": "@RemyLebeau oh my bad. I am not using windows. I just came across and thought I could help so I did a quick Google search. Good luck though!"}, {"owner": {"reputation": 11616, "user_id": 6703783, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af329d320f6609622cc298ccdeb1ace7?s=128&d=identicon&r=PG&f=1", "display_name": "Manu Chadha", "link": "https://stackoverflow.com/users/6703783/manu-chadha"}, "edited": false, "score": 0, "creation_date": 1558471134, "post_id": 56243007, "comment_id": 99110492, "body": "Thanks @WhozCarig. The lib was at <code>C:\\Program Files (x86)\\Windows Kits\\10\\Lib\\10.0.17134.0\\um\\x86</code>. To link it, I opened CodeBlocks-&gt;Settings-&gt;Compiler-&gt;Linker Settings` and added the file there. It changed the compiler command to <code>mingw32-g++.exe  -o C:\\...\\EchoServer.exe C:\\...\\EchoServer.o   &quot;C:\\Program Files (x86)\\Windows Kits\\10\\Lib\\10.0.17134.0\\um\\x86\\WS2_32.lib&quot; </code>"}], "owner": {"reputation": 11616, "user_id": 6703783, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af329d320f6609622cc298ccdeb1ace7?s=128&d=identicon&r=PG&f=1", "display_name": "Manu Chadha", "link": "https://stackoverflow.com/users/6703783/manu-chadha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 211, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558457398, "creation_date": 1558457398, "question_id": 56243007, "link": "https://stackoverflow.com/questions/56243007/what-is-the-name-of-socket-library-in-windows-10", "title": "what is the name of socket library in windows 10", "body": "<p>I am trying to compile an echo server code. I am usinng CodeBlocks IDE on Windows 10. </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;winsock2.h&gt;\n#pragma comment(lib, \u201cws2_32.lib\u201d) //Winsock Library\n\n//Vulnerable Function using strcpy\nint vulnerable_function(char *input)\n{\nchar buffer[128];\nstrcpy(buffer,input);\nreturn 1;\n}\n\n//Main Function\nint main()\n{\nWSADATA wsa;\nSOCKET master , new_socket;\nstruct sockaddr_in server, address;\nint addrlen, valread;\n\n//Size of the receive buffer\nchar *buffer;\nbuffer = (char*) malloc((1024 + 1) * sizeof(char));\nWSAStartup(MAKEWORD(2,2),&amp;wsa);\n\n//Create a socket\nmaster = socket(AF_INET , SOCK_STREAM , 0 );\nprintf(\"Socket created.\\n\");\n\n//Prepare the sockaddr_in structure\nserver.sin_family = AF_INET;\nserver.sin_addr.s_addr = INADDR_ANY;\nserver.sin_port = htons( 10000 );\n\n//Bind\nbind(master ,(struct sockaddr *)&amp;server , sizeof(server));\n\n//Listen for incoming connections\nlisten(master , 1);\n\n//Accept the incoming connection\nputs(\"Waiting for incoming connections\u2026\");\naddrlen = sizeof(struct sockaddr_in);\nnew_socket = accept(master , (struct sockaddr *)&amp;address, (int *)&amp;addrlen);\nprintf(\"New connection , socket fd is %d , ip is : %s , port : %d \\n\" , new_socket , inet_ntoa(address.sin_addr) , ntohs(address.sin_port));\n\nvalread = 1;\n//Receiving Loop\nwhile(valread != 0)\n{\nvalread = recv(new_socket, buffer, 1024, 0);\nif ( valread == 2) //Server close the connection when a return is send from the client\n{\nclosesocket( new_socket );\nexit(0);\n}\nbuffer[valread]=' ';\nvulnerable_function(buffer);\nprintf(\"%s:%d \u2013 %s \\n\" , inet_ntoa(address.sin_addr) , ntohs(address.sin_port), buffer);\nsend( new_socket , buffer , valread , 0 );\n}\nclosesocket(new_socket);\nWSACleanup();\nreturn 0;\n}\n</code></pre>\n\n<p>I am getting several errors</p>\n\n<pre><code>C:\\Users\\manu\\Documents\\manu\\hack_learning\\EchoServer.o:EchoServer.c:(.text+0x60): undefined reference to `WSAStartup@8'\nC:\\Users\\manu\\Documents\\manu\\hack_learning\\EchoServer.o:EchoServer.c:(.text+0x7f): undefined reference to `socket@12'\nC:\\Users\\manu\\Documents\\manu\\hack_learning\\EchoServer.o:EchoServer.c:(.text+0xb0): undefined reference to `htons@4'\nC:\\Users\\manu\\Documents\\manu\\hack_learning\\EchoServer.o:EchoServer.c:(.text+0xd7): undefined reference to `bind@12'\nC:\\Users\\manu\\Documents\\manu\\hack_learning\\EchoServer.o:EchoServer.c:(.text+0xed): undefined reference to `listen@8'\nC:\\Users\\manu\\Documents\\manu\\hack_learning\\EchoServer.o:EchoServer.c:(.text+0x125): undefined reference to `accept@12'\nC:\\Users\\manu\\Documents\\manu\\hack_learning\\EchoServer.o:EchoServer.c:(.text+0x13d): undefined reference to `ntohs@4'\nC:\\Users\\manu\\Documents\\manu\\hack_learning\\EchoServer.o:EchoServer.c:(.text+0x151): undefined reference to `inet_ntoa@4'\nC:\\Users\\manu\\Documents\\manu\\hack_learning\\EchoServer.o:EchoServer.c:(.text+0x19d): undefined reference to `recv@16'\nC:\\Users\\manu\\Documents\\manu\\hack_learning\\EchoServer.o:EchoServer.c:(.text+0x1b4): undefined reference to `closesocket@4'\nC:\\Users\\manu\\Documents\\manu\\hack_learning\\EchoServer.o:EchoServer.c:(.text+0x1eb): undefined reference to `ntohs@4'\nC:\\Users\\manu\\Documents\\manu\\hack_learning\\EchoServer.o:EchoServer.c:(.text+0x1ff): undefined reference to `inet_ntoa@4'\nC:\\Users\\manu\\Documents\\manu\\hack_learning\\EchoServer.o:EchoServer.c:(.text+0x240): undefined reference to `send@16'\nC:\\Users\\manu\\Documents\\manu\\hack_learning\\EchoServer.o:EchoServer.c:(.text+0x258): undefined reference to `closesocket@4'\nC:\\Users\\manu\\Documents\\manu\\hack_learning\\EchoServer.o:EchoServer.c:(.text+0x260): undefined reference to `WSACleanup@0'\ncollect2.exe: error: ld returned 1 exit status\n</code></pre>\n\n<p>The command which is compiling the code is</p>\n\n<pre><code>mingw32-gcc.exe   -c C:\\Users\\manu\\Documents\\manu\\hack_learning\\EchoServer.c -o C:\\Users\\manu\\Documents\\manu\\hack_learning\\EchoServer.o\nmingw32-g++.exe  -o C:\\Users\\manu\\Documents\\manu\\hack_learning\\EchoServer.exe C:\\Users\\manu\\Documents\\manu\\hack_learning\\EchoServer.o \n</code></pre>\n\n<p>I suppose the issue is that the IDE is not linking the library which has the implementation of <code>socket</code> code.</p>\n\n<p>What is the name of the library I should link and how do I acquire it. I have Win 10 SDK installed on my system.</p>\n"}, {"tags": ["c", "ubuntu"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1558457424, "post_id": 56242951, "comment_id": 99104706, "body": "<code>int BufferSize=51200; unsigned char Buf[BufferSize];</code> move from VLA to <code>malloc</code> to better handle out of stack case. As to <code>memcpy(&amp;M-&gt;Data[i*BufferSize], Buf, sizeof(Buf)*sizeof(unsigned char));</code> why don&#39;t you simply check <code>if (i*BufferSize*sizeof(Buf) &gt;= 512000) { error() }</code>? You have some printf in your code <code>printf(&quot;\\n Number Of File Buffers: %d&quot;, NumberOfFileBuffers);</code> - so what do they print? What is the value of <code>NumberOfFileBuffers</code>? <code>FilePosition</code>? <code>CopyableMemorySize</code>? <code>sizeof(Buf)</code>?"}, {"owner": {"reputation": 75, "user_id": 11521763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21fe913ec903c2cdc7d0aaf7e8e03e05?s=128&d=identicon&r=PG&f=1", "display_name": "protik", "link": "https://stackoverflow.com/users/11521763/protik"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1558457514, "post_id": 56242951, "comment_id": 99104753, "body": "@KamilCuk Checking now."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1558457555, "post_id": 56242951, "comment_id": 99104779, "body": "<code>&amp;M-&gt;Data[i*BufferSize]</code> will access outside the <code>Data</code> array when <code>i</code> is not <code>0</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1558457606, "post_id": 56242951, "comment_id": 99104802, "body": "This seems peculiar: <code>memset(M-&gt;Data, &#39;\\0&#39;, strlen(M-&gt;Data));</code> where was a string written there? Better to use the buffer size, or if it is nulling a string, just set the first element to <code>&#39;\\0&#39;</code>."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1558457666, "post_id": 56242951, "comment_id": 99104840, "body": "@protik internal to algorihthms out of memory accesses can be checked with assertions, ie. I would for sure write <code>assert(i * BufferSize * sizeof(Buf) &lt; sizeof(M-&gt;Data));</code>"}, {"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "edited": false, "score": 0, "creation_date": 1558457979, "post_id": 56242951, "comment_id": 99104965, "body": "have you tried running valgrind on it?"}, {"owner": {"reputation": 75, "user_id": 11521763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21fe913ec903c2cdc7d0aaf7e8e03e05?s=128&d=identicon&r=PG&f=1", "display_name": "protik", "link": "https://stackoverflow.com/users/11521763/protik"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1558458104, "post_id": 56242951, "comment_id": 99105022, "body": "@KamilCuk why is this &#39;i&#39; being multiplied? I have put &amp;M-&gt;Data[i*BufferSize] as an offset in the struct."}, {"owner": {"reputation": 75, "user_id": 11521763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21fe913ec903c2cdc7d0aaf7e8e03e05?s=128&d=identicon&r=PG&f=1", "display_name": "protik", "link": "https://stackoverflow.com/users/11521763/protik"}, "reply_to_user": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "edited": false, "score": 0, "creation_date": 1558458193, "post_id": 56242951, "comment_id": 99105058, "body": "@CoffeeTableEspresso No."}, {"owner": {"reputation": 75, "user_id": 11521763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21fe913ec903c2cdc7d0aaf7e8e03e05?s=128&d=identicon&r=PG&f=1", "display_name": "protik", "link": "https://stackoverflow.com/users/11521763/protik"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1558458378, "post_id": 56242951, "comment_id": 99105144, "body": "@KamilCuk, OK, checking."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1558458438, "post_id": 56242951, "comment_id": 99105169, "body": "@protik I am sorry, you are right, it should be <code>+</code> not <code>*</code> there. <code>i * BufferSize + sizeof(Buf)</code>."}, {"owner": {"reputation": 75, "user_id": 11521763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21fe913ec903c2cdc7d0aaf7e8e03e05?s=128&d=identicon&r=PG&f=1", "display_name": "protik", "link": "https://stackoverflow.com/users/11521763/protik"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1558458556, "post_id": 56242951, "comment_id": 99105225, "body": "@KamilCuk for expression i<i>*BufferSize</i>sizeof(Buf)File Size: 1047714  Copyable File Size: 1047714  Number Of File Buffers: 20  Checking: 0  Checking: 2621440000  Checking: 5242880000  Checking: 7864320000  Checking: 10485760000  Checking: 13107200000  Checking: 15728640000  Checking: 18350080000  Checking: 20971520000  Checking: 23592960000 Segmentation fault (core dumped)"}, {"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "edited": false, "score": 1, "creation_date": 1558458709, "post_id": 56242951, "comment_id": 99105288, "body": "@protik you should try running some debugging tools on it, the answer will probably come up pretty easily."}, {"owner": {"reputation": 75, "user_id": 11521763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21fe913ec903c2cdc7d0aaf7e8e03e05?s=128&d=identicon&r=PG&f=1", "display_name": "protik", "link": "https://stackoverflow.com/users/11521763/protik"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1558464079, "post_id": 56242951, "comment_id": 99107631, "body": "@KamilCuk Checking this expression  printf(&quot;\\n Checking: %d&quot;, i**BufferSize); fixed the problem. You are amazing."}], "answers": [{"tags": [], "owner": {"reputation": 421, "user_id": 5306210, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2Z59f.jpg?s=128&g=1", "display_name": "Rajib Hossain Pavel", "link": "https://stackoverflow.com/users/5306210/rajib-hossain-pavel"}, "is_accepted": true, "score": 1, "last_activity_date": 1558468419, "creation_date": 1558468419, "answer_id": 56245504, "question_id": 56242951, "link": "https://stackoverflow.com/questions/56242951/c-memcpy-segmentation-fault/56245504#56245504", "title": "C memcpy() Segmentation Fault", "body": "<p>As the file size is larger than the NumberOfBuffers, then this code requires a Mod Division not to access data outside M->Data array.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/mman.h&gt;\n\nint main(void){\n    struct MemData{\n        char FileName[128];//POINTER PUTS DATA INTO NON-SHARED MEMORY\n        int LastByteLength;\n        int ReadPointer;\n        int WritePointer;\n        char Data[512000];//MEMORY BLOCK SIZE: 500 KB\n    };\n    int SD;\n    struct MemData *M;\n    int NumberOfBuffers=10;\n    int BufferSize=51200;//FILE BUFFER SIZE 50 KB\n    unsigned char Buf[BufferSize];\n\n    SD= shm_open(\"/program.shared\", O_RDWR|O_CREAT, S_IREAD|S_IWRITE);\n    if(SD&lt; 0){\n        printf(\"\\nshm_open() error \\n\");\n        return EXIT_FAILURE;\n    }\n    fchmod(SD, S_IRWXU|S_IRWXG|S_IRWXO);\n    if(ftruncate(SD, sizeof(MemData))&lt; 0){\n        printf (\"ftruncate() error \\n\");\n        return EXIT_FAILURE;\n    }\n    //THE FOLLOWING TYPECASTING AVOIDS THE NEED TO ATTACH THROUGH shmat() in shm.h HEADER I GUESS.\n    M=(struct MemData*)mmap(NULL, sizeof(MemData), PROT_READ|PROT_WRITE, MAP_SHARED, SD, 0);\n    if(M== MAP_FAILED){\n        printf(\"mmap() error\");\n        return EXIT_FAILURE;\n    }else{\n        strcpy(M-&gt;FileName, \"xaa\");\n        M-&gt;LastByteLength=0;\n        M-&gt;ReadPointer=-1;\n        M-&gt;WritePointer=-1;\n        memset(M-&gt;Data, '\\0', strlen(M-&gt;Data));\n    }\n    char FileName[128]=\"xaa\";\n    FILE *FP= fopen(FileName, \"rb\");\n    if(FP!= NULL){\n        struct stat StatBuf;\n        if(stat(FileName, &amp;StatBuf)==-1){\n            printf(\"failed to fstat %s\\n\", FileName);\n            exit(EXIT_FAILURE);\n        }\n        long long FileSize=StatBuf.st_size;\n        printf(\"\\n File Size: %lld\", FileSize);\n        long long FilePosition=ftell(FP);\n        FilePosition=ftell(FP);\n        long long CopyableMemorySize=FileSize-FilePosition;\n        printf(\"\\n Copyable File Size: %lld\", CopyableMemorySize);\n        int NumberOfFileBuffers=CopyableMemorySize/BufferSize;\n        printf(\"\\n Number Of File Buffers: %d\", NumberOfFileBuffers);\n        for(int i=0; i&lt;NumberOfFileBuffers; i++){\n            int BufferModCount=i%NumberOfBuffers;\n            if(abs(M-&gt;WritePointer-M-&gt;ReadPointer)==NumberOfBuffers){\n                //WAIT\n            }else{\n                fseek(FP, i*BufferSize, SEEK_SET);\n                fread(Buf, sizeof(unsigned char), BufferSize, FP);\n                printf(\"\\n Checking: %d\", i*BufferSize);\n\n                memcpy(&amp;M-&gt;Data[BufferModCount*BufferSize], &amp;Buf, sizeof(Buf)*sizeof(unsigned char));\n            }\n        }\n        fclose(FP);\n    }\n    close(SD);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 11521763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21fe913ec903c2cdc7d0aaf7e8e03e05?s=128&d=identicon&r=PG&f=1", "display_name": "protik", "link": "https://stackoverflow.com/users/11521763/protik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 56245504, "answer_count": 1, "score": 2, "last_activity_date": 1558468419, "creation_date": 1558457177, "question_id": 56242951, "link": "https://stackoverflow.com/questions/56242951/c-memcpy-segmentation-fault", "title": "C memcpy() Segmentation Fault", "body": "<p>I have been getting Segmentation Fault again and again.\nMy purpose is to copy a File into a Shared Memory so that another Reader Process can read it.\nTo copy File, I have allocated M size Data Array in a Struct.\nI have used NumberOfBuffers(N) and BufferSize(B) so that M=N*B.\nThe M is half of the file. So File Size is approximately 2M.\nI think in this code memcpy() is generating the Segmentation Fault.\nInitially my target is to full M size in Shared Memory through this Writer.c to see Copy at least is working.\nMy Operating System is Ubuntu.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/mman.h&gt;\n\nint main(void){\n    struct MemData{\n        char FileName[128];//POINTER PUTS DATA INTO NON-SHARED MEMORY\n        int LastByteLength;\n        int ReadPointer;\n        int WritePointer;\n        char Data[512000];//MEMORY BLOCK SIZE: 500 KB\n    };\n    int SD;\n    struct MemData *M;\n    int NumberOfBuffers=10;\n    int BufferSize=51200;//FILE BUFFER SIZE 50 KB\n    unsigned char Buf[BufferSize];\n\n    SD= shm_open(\"/program.shared\", O_RDWR|O_CREAT, S_IREAD|S_IWRITE);\n    if(SD&lt; 0){\n        printf(\"\\nshm_open() error \\n\");\n        return EXIT_FAILURE;\n    }\n    fchmod(SD, S_IRWXU|S_IRWXG|S_IRWXO);\n    if(ftruncate(SD, sizeof(MemData))&lt; 0){\n        printf (\"ftruncate() error \\n\");\n        return EXIT_FAILURE;\n    }\n    //THE FOLLOWING TYPECASTING AVOIDS THE NEED TO ATTACH THROUGH shmat() in shm.h HEADER I GUESS.\n    M=(struct MemData*)mmap(NULL, sizeof(MemData), PROT_READ|PROT_WRITE, MAP_SHARED, SD, 0);\n    if(M== MAP_FAILED){\n        printf(\"mmap() error\");\n        return EXIT_FAILURE;\n    }else{\n        strcpy(M-&gt;FileName, \"xaa\");\n        M-&gt;LastByteLength=0;\n        M-&gt;ReadPointer=-1;\n        M-&gt;WritePointer=-1;\n        memset(M-&gt;Data, '\\0', strlen(M-&gt;Data));\n    }\n    char FileName[128]=\"xaa\";\n    FILE *FP= fopen(FileName, \"rb\");\n    if(FP!= NULL){\n        struct stat StatBuf;\n        if(stat(FileName, &amp;StatBuf)==-1){\n            printf(\"failed to fstat %s\\n\", FileName);\n            exit(EXIT_FAILURE);\n        }\n        long long FileSize=StatBuf.st_size;\n        printf(\"\\n File Size: %lld\", FileSize);\n        long long FilePosition=ftell(FP);\n        FilePosition=ftell(FP);\n        long long CopyableMemorySize=FileSize-FilePosition;\n        printf(\"\\n Copyable File Size: %lld\", CopyableMemorySize);\n        int NumberOfFileBuffers=CopyableMemorySize/BufferSize;\n        printf(\"\\n Number Of File Buffers: %d\", NumberOfFileBuffers);\n        for(int i=0; i&lt;NumberOfFileBuffers; i++){\n            if(abs(M-&gt;WritePointer-M-&gt;ReadPointer)==NumberOfBuffers){\n                //WAIT\n            }else{\n                fseek(FP, i*BufferSize, SEEK_SET);\n                fread(Buf, sizeof(unsigned char), BufferSize, FP);\n                memcpy(&amp;M-&gt;Data[i*BufferSize], Buf, sizeof(Buf)*sizeof(unsigned char));\n           }\n        }\n        fclose(FP);\n    }\n    close(SD);\n    return 0;\n}\n</code></pre>\n"}]