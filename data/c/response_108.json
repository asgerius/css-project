[{"tags": ["c", "unix"], "comments": [{"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 3, "creation_date": 1485993111, "post_id": 41992000, "comment_id": 71160972, "body": "<i>I assume that would involve just adding a &#39;-&#39; in front of the number of bytes N</i> That is <b>adorable</b> (but incorrect). <a href=\"http://stackoverflow.com/questions/8236/how-do-you-determine-the-size-of-a-file-in-c\">How do you determine the size of a file in C?</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1485993140, "post_id": 41992000, "comment_id": 71160985, "body": "You probably need a suitable combination of <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fread.html\" rel=\"nofollow noreferrer\"><code>fread()</code></a>, <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fwrite.html\" rel=\"nofollow noreferrer\"><code>fwrite()</code></a>, and <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fseek.html\" rel=\"nofollow noreferrer\"><code>fseek()</code></a>"}, {"owner": {"reputation": 11, "user_id": 7503262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sRFBg.jpg?s=128&g=1", "display_name": "advan", "link": "https://stackoverflow.com/users/7503262/advan"}, "edited": false, "score": 0, "creation_date": 1486007331, "post_id": 41992000, "comment_id": 71164708, "body": "I tried using fread and fwrite but it will not compile. I do not understand exactly what i am doing wrong, but i think there is a problem with using buffer and file as arguments in fread and fwrite.while (fread(buffer, 1, number, file))                                                  {                                                       fwrite(buffer, 1, number, file);                                                       printf(&quot;%s&quot;, buffer);                                               }"}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 0, "last_activity_date": 1486063312, "creation_date": 1486063312, "answer_id": 42010620, "question_id": 41992000, "link": "https://stackoverflow.com/questions/41992000/c-in-unix-reading-combining-files-based-upon-number-of-bytes/42010620#42010620", "title": "C in UNIX: Reading/combining files based upon number of bytes", "body": "<p>Assuming that you want the first 1000 bytes and the last 1000 bytes of a file, and largely ignoring problems with files smaller than 2000 bytes (it works, but you might want a different result), you could use:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nenum { NUM_BYTES = 1000 };\n\nint main(int argc, char **argv)\n{\n    for (int x = 1; x &lt; argc; x++)\n    {\n        FILE *fp = fopen(argv[x], \"r\");\n        if (fp)\n        {\n            char buffer[NUM_BYTES];\n            int nbytes = fread(buffer, 1, NUM_BYTES, fp);\n            fwrite(buffer, 1, nbytes, stdout);\n            if (fseek(fp, -NUM_BYTES, SEEK_END) == 0)\n            {\n                nbytes = fread(buffer, 1, NUM_BYTES, fp);\n                fwrite(buffer, 1, nbytes, stdout);\n            }\n            fclose(fp);\n        }\n        else\n        {\n            fprintf(stderr, \"%s: could not open file %s\\n\", argv[0], argv[x]);\n        }\n    }\n}\n</code></pre>\n\n<p>This uses <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fread.html\" rel=\"nofollow noreferrer\"><code>fread()</code></a>, <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fwrite.html\" rel=\"nofollow noreferrer\"><code>fwrite()</code></a> and <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fseek.html\" rel=\"nofollow noreferrer\"><code>fseek()</code></a> as suggested in the comments.</p>\n\n<p>It also takes care to close successfully opened files.  It does not demand write permissions on the files since it only reads and does not write those files (using <code>\"r\"</code> instead of <code>\"r+\"</code> in the call to <code>fopen()</code>).</p>\n\n<p>If the file is smaller than 1000 bytes, the <code>fseek()</code> will fail because it tries to seek to a negative offset.  If that happens, don't bother to read or write another 1000 bytes.</p>\n\n<p>I debated whether to use <code>sizeof(buffer)</code> or <code>NUM_BYTES</code> in the function calls.  I decided that <code>NUM_BYTES</code> was better, but the choice is not definitive \u2014 there are cogent arguments for using <code>sizeof(buffer)</code> instead.</p>\n\n<p>Note that <code>buffer</code> becomes a local variable.  There's no need to zero it; only the entries that are written on by <code>fread()</code> will be written by <code>fwrite()</code>, so there is no problem resolved by <code>bzero()</code>.  (There doubly wasn't any point in that when the variable was global; variables with static duration are default initialized to all bytes zero anyway.)</p>\n\n<p>The error message is written to standard error.</p>\n\n<p>The code doesn't check for zero bytes read; arguably, it should.</p>\n\n<p>If the <code>NUM_BYTES</code> becomes a parameter (e.g. you call your program <code>fl19</code> and use <code>fl19 -n 200 file1</code> to print the first and last 200 bytes of <code>file1</code>), then you need to do some tidying up as well as command-line argument handling.</p>\n"}], "owner": {"reputation": 11, "user_id": 7503262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sRFBg.jpg?s=128&g=1", "display_name": "advan", "link": "https://stackoverflow.com/users/7503262/advan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1486063312, "creation_date": 1485992987, "question_id": 41992000, "link": "https://stackoverflow.com/questions/41992000/c-in-unix-reading-combining-files-based-upon-number-of-bytes", "title": "C in UNIX: Reading/combining files based upon number of bytes", "body": "<p>I am trying to fix the code below to only read the first few N bytes. I would also like to do the same thing, but for the last number of N bytes (I assume that would involve just adding a '-' in front of the number of bytes N). I am not sure if using fget is the correct method for doing so. </p>\n\n<p>I tried changing the 1000 in</p>\n\n<pre><code>while(fgets(buffer, 1000, fp)\n</code></pre>\n\n<p>however I do not think changing that value will pick up a certain number of bytes, as I have read that it is only a maximum value.</p>\n\n<pre><code>char buffer[1001];\n\nint main(int argc, char** argv) {\n  bzero(buffer, sizeof(buffer));\n  for(int x=1; x&lt;argc; x++) {\n    FILE *fp = fopen(argv[x], \"r+\");\n    if (fp) {\n      while(fgets(buffer, 1000, fp)) {\n        printf(\"%s\", buffer);\n      }\n    } else {\n      printf(\"could not open file %s\\n\", argv[x]);\n    }\n  }\n} \n</code></pre>\n"}, {"tags": ["c", "file", "writing"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1485993206, "post_id": 41991998, "comment_id": 71161012, "body": "Please post the code by text, not by image."}, {"owner": {"reputation": 10702, "user_id": 2079103, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XlVYy.png?s=128&g=1", "display_name": "clearlight", "link": "https://stackoverflow.com/users/2079103/clearlight"}, "edited": false, "score": 0, "creation_date": 1485996014, "post_id": 41991998, "comment_id": 71161844, "body": "Image only code questions/answers are not acceptable on this site, for various reasons - links go out of date, no one can copy, build, experiment, enhance your code to reply, etc... Please edit your question, cut/paste the actual code into the the Stack Overflow question editor window, indented 4 spaces so it shows up as a formatted code block. if you need to indent with an external editor first that&#39;s fine, or use cmd-K in the Stack Overflow edit window. See the ? help in the icon bar of the edit window to find out how to format questions and answers properly."}, {"owner": {"reputation": 10702, "user_id": 2079103, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XlVYy.png?s=128&g=1", "display_name": "clearlight", "link": "https://stackoverflow.com/users/2079103/clearlight"}, "edited": false, "score": 0, "creation_date": 1485996103, "post_id": 41991998, "comment_id": 71161868, "body": "@BradyWebb Since you are new recommend taking the <a href=\"http://stackoverflow.com/tour\">2 Minute Tour</a> and check the <a href=\"http://stackoverflow.com/help\">Help Center</a> to learn how to ask a good question here (also increases your chances of getting an answer)"}], "answers": [{"tags": [], "owner": {"reputation": 1269, "user_id": 2592879, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7f68f87c8087f7dc52d8ad88761dc5c1?s=128&d=identicon&r=PG", "display_name": "bzrr", "link": "https://stackoverflow.com/users/2592879/bzrr"}, "is_accepted": false, "score": 0, "last_activity_date": 1485995805, "creation_date": 1485995805, "answer_id": 41992412, "question_id": 41991998, "link": "https://stackoverflow.com/questions/41991998/reading-and-writing-from-files-with-a-new-form/41992412#41992412", "title": "Reading and writing from files with a new form", "body": "<p>First of all, you're trying to assign a <em>char string</em> to a variable of type <em>pointer to FILE</em>. The compiler won't let you do that. </p>\n\n<pre><code>// not allowed\nFILE* file = *(argv + 2);\n</code></pre>\n\n<p>Secondly, you're passing a <em>pointer to FILE</em> to <code>fopen()</code>, but <code>fopen()</code> expects it's first argument to be a <em>char string</em> so that won't work either.</p>\n\n<pre><code>// file is FILE*, not allowed\nptr = fopen(file, \"r\"));\n</code></pre>\n\n<p>If you fix those two lines the code should compile.</p>\n"}, {"tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": false, "score": 0, "last_activity_date": 1486002162, "creation_date": 1486002162, "answer_id": 41993236, "question_id": 41991998, "link": "https://stackoverflow.com/questions/41991998/reading-and-writing-from-files-with-a-new-form/41993236#41993236", "title": "Reading and writing from files with a new form", "body": "<p>fix like this</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n//double* read_file(FILE* file, int length);\n//You do not need to pass a file pointer, you need a file name.\n//It opens the file within this function\ndouble *read_file(const char *filename, int length);\n\nint main(int argc, char* argv[]){\n    //if (argc &lt; 4 || argc &gt; 4)\n    //argc &lt; 4 || argc &gt; 4 same as argc != 4\n    //It is thought that it is 3 because only argv[1] and argv[2] are used.\n    //It is necessary to check arguments before using them.\n    if (argc != 3) {\n        printf(\"Usage : %s number_of_elements file_name\\n\", argv[0]);\n        printf(\"Insufficient arguments. Check your command line.\\n\");\n        return 0;\n    }\n\n    //double* array = malloc(10 * sizeof(double));//It is not necessary as it is secured by read_file. Make memory leak.\n    int length = atoi(argv[1]);\n    const char *file = argv[2];\n\n    double *array = read_file(file, length);\n    if(array != NULL){\n        for(int i = 0; i &lt; length; ++i)\n            printf(\"%f\\n\", array[i]);\n        free(array);\n    }\n    return 0;\n}\n\ndouble* read_file (const char *file, int length){\n    FILE *ptr;\n\n    if ((ptr = fopen(file, \"r\")) == NULL){\n        return NULL;\n    }\n    //It causes a memory leak unless you first confirm that the file can be opened\n    double *array = malloc(length * sizeof(double));\n\n    for (int i = 0; i &lt; length; i++){\n        if(1 != fscanf(ptr, \"%lf\", array + i)){\n            printf(\"Failed to read the %ith element.\\n\", i+1);\n            break;\n        }\n    }\n    fclose(ptr);\n\n    return array;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7503241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac9de289c938fcf44db5a8d84525999b?s=128&d=identicon&r=PG&f=1", "display_name": "Brady Webb", "link": "https://stackoverflow.com/users/7503241/brady-webb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1486002162, "creation_date": 1485992985, "last_edit_date": 1485998513, "question_id": 41991998, "link": "https://stackoverflow.com/questions/41991998/reading-and-writing-from-files-with-a-new-form", "title": "Reading and writing from files with a new form", "body": "<p>I'm trying to read from a file and I have to use a new form of it I'm not really certain how to use. I've posted pictures below of what function I have to use and I'm not sure what to do about this error and how to fix it? Help, please!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\ndouble* read_file(FILE* file, int length);\n\nint main(int argc, char* argv[])\n{\n    double* array = malloc(10 * sizeof(double));\n    int length = atoi(*(argv + 1));\n    FILE* file = *(argv + 2);\n\n    if (argc &lt; 4 || argc &gt; 4)\n    {\n        printf(\"Insufficient arguments. Check your command line.\\n\");\n        return 0;\n    }\n\n    array = read_file(file, length);\n    printf(\"%p\", array);\n    return 0;\n}\n\ndouble* read_file (FILE* file, int length)\n{\n    FILE* ptr;\n    double* array = malloc(length * sizeof(double));\n\n    int i = 0;\n\n    if ((ptr = fopen(file, \"r\")) == NULL)\n    {\n        return 0;\n    }\n    else\n    {\n        for (i = 0; i &lt; length; i++)\n        {\n            fscanf(ptr, \"%lf\", (array + i));\n        }\n    }\n\n    fclose(ptr);\n\n    return array;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "memory", "realloc"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1488502394, "post_id": 41990946, "comment_id": 72271465, "body": "You probably read off the end of <code>line</code> later in the code; <code>realloc(line, strlen(line))</code> cuts off the null terminator so there is no way the later code can know when to stop reading"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1488502487, "post_id": 41990946, "comment_id": 72271488, "body": "<code>line = (char *)realloc(line, strlen(line));</code> is a meaningless line. Take the length of the string that is <i>already there</i> and <i>then</i> allocate the space for it? Uh, what?"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1488502567, "post_id": 41990946, "comment_id": 72271514, "body": "Ah, I see, you are <i>reducing</i> the allocation for line. In that case, you forgot the <code>+ 1</code> for the terminating zero on all C strings."}], "answers": [{"comments": [{"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1485990839, "post_id": 41990988, "comment_id": 71160252, "body": "<code>x = realloc(x, ...);</code> is a 99.99% bug!"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1485991071, "post_id": 41990988, "comment_id": 71160323, "body": "@0andriy: <code>x = realloc(x, ...);</code> is definitely bad code, just like not checking the result of <code>malloc</code> for null is bad code. But first things first: the code currently contains more blatant problems that that."}, {"owner": {"reputation": 3, "user_id": 7503002, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AI5AZZZKheo/AAAAAAAAAAI/AAAAAAAADxc/5NLzycxZWaw/photo.jpg?sz=128", "display_name": "Matt Ruetz", "link": "https://stackoverflow.com/users/7503002/matt-ruetz"}, "edited": false, "score": 1, "creation_date": 1486008854, "post_id": 41990988, "comment_id": 71165102, "body": "Thanks guys. Code is far from finished, so i still have to add handles for null pointers.  I&#39;m still quite novice in C also so I&#39;m sorry if you felt like crying while reading through it, haha. Cheers"}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": true, "score": 2, "last_activity_date": 1486026540, "last_edit_date": 1486026540, "creation_date": 1485987958, "answer_id": 41990988, "question_id": 41990946, "link": "https://stackoverflow.com/questions/41990946/realloc-invalid-next-size-after-multiple-successful-runs/41990988#41990988", "title": "&quot;realloc(): invalid next size&quot; after multiple successful runs", "body": "<p>This</p>\n\n<pre><code>poemArray = (char **)realloc(poemArray, count + 1);\n</code></pre>\n\n<p>should actualy be </p>\n\n<pre><code>poemArray = realloc(poemArray, (count + 1) * sizeof(char *));\n</code></pre>\n\n<p>Also, this</p>\n\n<pre><code>line = (char *)realloc(line, strlen(line));\n</code></pre>\n\n<p>should probably be</p>\n\n<pre><code>line = realloc(line, strlen(line) + 1);\n</code></pre>\n\n<p>It is also unclear why you are doing the initial <code>malloc</code> for <code>poemArray</code> <em>before</em> the potential <code>break</code>. That way you might end up with <code>poemArray</code> as an uninitialized array of size 1. What is the point of having it uninitialized?</p>\n\n<hr>\n\n<p>Additionally, note that <code>realloc</code> is designed to properly handle null pointer as its first argument. In such cases <code>realloc</code> is essentially equivalent to <code>malloc</code>. By taking advantage of this feature of <code>realloc</code> you can eliminate dedicated processing for <code>count == 0</code> state, thus ending up with much more compact and elegant code.</p>\n\n<p>P.S. Why some calls to <code>malloc</code> include an explicit cast, while others don't? In any case, there's no point in casing the results of memory allocation functions in C.</p>\n"}], "owner": {"reputation": 3, "user_id": 7503002, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AI5AZZZKheo/AAAAAAAAAAI/AAAAAAAADxc/5NLzycxZWaw/photo.jpg?sz=128", "display_name": "Matt Ruetz", "link": "https://stackoverflow.com/users/7503002/matt-ruetz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 772, "favorite_count": 0, "accepted_answer_id": 41990988, "answer_count": 1, "score": 0, "last_activity_date": 1488502212, "creation_date": 1485987752, "question_id": 41990946, "link": "https://stackoverflow.com/questions/41990946/realloc-invalid-next-size-after-multiple-successful-runs", "title": "&quot;realloc(): invalid next size&quot; after multiple successful runs", "body": "<p>I keep getting this error after the array has already stored multiple lines from user input, which tells me that it's probably corrupted memory due to the line:</p>\n\n<pre><code>    poemArray = (char **)realloc(poemArray, count + 1);\n</code></pre>\n\n<p>Any idea what I'm doing wrong? A specific solution would be much appreciated!</p>\n\n<pre><code>    line = (char *)malloc(MaxLineLen);\n\n    fgets(line, MaxLineLen, stdin);\n    /*Get current line from user input*/\n    if(count == 0)\n    {\n        poemArray = malloc(sizeof(char *));\n        printf(\"1\\n\");\n    }\n    if(line[0]  == '.'){\n        break;\n    }\n    line = (char *)realloc(line, strlen(line));\n\n    printf(\"2\\n\");\n\n    if(count != 0)\n    {\n        poemArray = (char **)realloc(poemArray, count + 1);\n    }\n    poemArray[count] = line;\n\n    ++count;\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1485986830, "post_id": 41990683, "comment_id": 71158576, "body": "&quot;It has an logical error&quot;. It would make sense to tell us what incorrect behaviour you are observing, no?"}, {"owner": {"reputation": 41, "user_id": 5624540, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/40c2a75d8693d5219a3af405ce352b47?s=128&d=identicon&r=PG&f=1", "display_name": "mac", "link": "https://stackoverflow.com/users/5624540/mac"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1485987112, "post_id": 41990683, "comment_id": 71158727, "body": "Right. I updated the post. The program does not out put anything."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1485987229, "post_id": 41990683, "comment_id": 71158785, "body": "Did you read the man page to see what <a href=\"https://linux.die.net/man/3/getchar\" rel=\"nofollow noreferrer\"><code>getchar</code></a> does? Having read that do you think it reads from where you want it to?"}, {"owner": {"reputation": 194, "user_id": 7090192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f0152ee3bf3819e48e6e89b96dbe8f6?s=128&d=identicon&r=PG&f=1", "display_name": "CoderGirl94", "link": "https://stackoverflow.com/users/7090192/codergirl94"}, "edited": false, "score": 0, "creation_date": 1485987315, "post_id": 41990683, "comment_id": 71158832, "body": "Maybe instead of ==1 substitute it with !=EOF"}, {"owner": {"reputation": 41, "user_id": 5624540, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/40c2a75d8693d5219a3af405ce352b47?s=128&d=identicon&r=PG&f=1", "display_name": "mac", "link": "https://stackoverflow.com/users/5624540/mac"}, "edited": false, "score": 0, "creation_date": 1485987365, "post_id": 41990683, "comment_id": 71158860, "body": "Reads a single character"}, {"owner": {"reputation": 41, "user_id": 5624540, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/40c2a75d8693d5219a3af405ce352b47?s=128&d=identicon&r=PG&f=1", "display_name": "mac", "link": "https://stackoverflow.com/users/5624540/mac"}, "edited": false, "score": 0, "creation_date": 1485987613, "post_id": 41990683, "comment_id": 71158968, "body": "I&#39;m assuming from the user?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485987695, "post_id": 41990683, "comment_id": 71159005, "body": "Code is incomplete.  Post more of code.  Tip: for debugging use <code>printf(&quot;%d\\n&quot;,str);</code>"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1485987712, "post_id": 41990683, "comment_id": 71159016, "body": "@mac But are you wanting that to come from <code>stdin</code>? No, right? You want to read the file. How do you think <code>getchar</code> will magically know which file you want it to read from?"}, {"owner": {"reputation": 41, "user_id": 5624540, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/40c2a75d8693d5219a3af405ce352b47?s=128&d=identicon&r=PG&f=1", "display_name": "mac", "link": "https://stackoverflow.com/users/5624540/mac"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1485987961, "post_id": 41990683, "comment_id": 71159139, "body": "Ok @Kaylum. So i&#39;ll pass fpointer into getchar as an argument. If i&#39;m understanding you correctly. However, if that&#39;s thecase i did that and It did not work. getchar(fpointer)?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1485988058, "post_id": 41990683, "comment_id": 71159172, "body": "No don&#39;t just guess at what should be done. Read the man page. Does it say <code>getchar</code> takes any parameter? It should be obvious that <code>getchar</code> is not what you need. Another function is required. <code>fscanf</code> already reads a character. Why not just use its result?"}], "answers": [{"tags": [], "owner": {"reputation": 194, "user_id": 7090192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f0152ee3bf3819e48e6e89b96dbe8f6?s=128&d=identicon&r=PG&f=1", "display_name": "CoderGirl94", "link": "https://stackoverflow.com/users/7090192/codergirl94"}, "is_accepted": true, "score": 2, "last_activity_date": 1485989630, "last_edit_date": 1485989630, "creation_date": 1485987939, "answer_id": 41990981, "question_id": 41990683, "link": "https://stackoverflow.com/questions/41990683/reading-file-content/41990981#41990981", "title": "Reading File content", "body": "<p>Your first while statement is correct. However, you don't use <code>getchar</code> in your second while statement. This will wait for the user to enter a character(this is why nothing is printing on screen for you). Try this method instead.</p>\n\n<pre><code>        while(fscanf(f, \"%c\", &amp;str) == 1)\n        {\n                //while((str=getchar()) != ',')\n            if( str==',')\n            {\n                        printf(\" \");\n            }\n            else\n            {\n                printf(\"%c\",str);\n            }\n        }\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5624540, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/40c2a75d8693d5219a3af405ce352b47?s=128&d=identicon&r=PG&f=1", "display_name": "mac", "link": "https://stackoverflow.com/users/5624540/mac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 41990981, "answer_count": 1, "score": -1, "last_activity_date": 1485989630, "creation_date": 1485986719, "last_edit_date": 1485987029, "question_id": 41990683, "link": "https://stackoverflow.com/questions/41990683/reading-file-content", "title": "Reading File content", "body": "<p>Wrote a short program to read a file, and print the contents of the file on the screen. Below is a snippet of the code. It has an logical error. The program just compiles and prints nothing onto the screen. My thought process was read and print only the characters and skip over commas found.</p>\n\n<pre><code>    Eg file         \n    A,1\n    B,2\n\n    Eg output\n    A 1\n    B 2\n\n    char = str;\n    while(fscanf(fpointer, \"%c\", &amp;str) == 1)\n    {\n            while((str=getchar()) != ',')\n                    printf(\"%c\",str);\n    }\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1485986717, "post_id": 41990564, "comment_id": 71158521, "body": "<code>long data = 0;</code> That&#39;s an initializer. It only sets the value once upon program startup. Move it into the function to have it initialise as a local variable each time the function is executed."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1485986735, "post_id": 41990564, "comment_id": 71158528, "body": "C does not have classes."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1485986746, "post_id": 41990564, "comment_id": 71158534, "body": "And note that C does not have &quot;classes&quot; nor &quot;methods&quot;. You probably mean &quot;file&quot; and &quot;function&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 6801522, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9478bee50171e635716ccc0d01cb0e83?s=128&d=identicon&r=PG&f=1", "display_name": "User 965", "link": "https://stackoverflow.com/users/6801522/user-965"}, "edited": false, "score": 0, "creation_date": 1485986999, "post_id": 41990697, "comment_id": 71158656, "body": "Thank you for the solution and for clarifying why it is happening."}], "tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": true, "score": 1, "last_activity_date": 1485986769, "creation_date": 1485986769, "answer_id": 41990697, "question_id": 41990564, "link": "https://stackoverflow.com/questions/41990564/file-variables-persisting-between-separate-functions-in-c/41990697#41990697", "title": "File variables persisting between separate functions in C", "body": "<p><code>sum</code> adds to the <em>global</em> variable <code>data</code>. After each call from <code>main</code>, it is never reset to zero.</p>\n\n<p>Between each call to <code>sum</code> in <code>main</code>, add <code>data = 0;</code>. Or better yet, rewrite <code>sum</code> as:</p>\n\n<pre><code>long\nsum(struct N *p)\n{\n    long total = 0;\n    if (p != NULL){\n        total += sum(p-&gt;x);\n        total += sum(p-&gt;y);\n        total += sum(p-&gt;z);\n        total += p-&gt;data;\n    }\n    return total;\n}\n</code></pre>\n\n<p>Then, just print the return value of <code>sum</code></p>\n"}], "owner": {"reputation": 179, "user_id": 6801522, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9478bee50171e635716ccc0d01cb0e83?s=128&d=identicon&r=PG&f=1", "display_name": "User 965", "link": "https://stackoverflow.com/users/6801522/user-965"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 41990697, "answer_count": 1, "score": 1, "last_activity_date": 1485986846, "creation_date": 1485986270, "last_edit_date": 1485986846, "question_id": 41990564, "link": "https://stackoverflow.com/questions/41990564/file-variables-persisting-between-separate-functions-in-c", "title": "File variables persisting between separate functions in C", "body": "<p>I have a straight forward c file that creates a simple tree with 3 possible children for each node. My goal is to find the sum of the data within a given node and all of its children. I am doing this with recursion and it works one time but then when it gets ran twice in a row the value of the old method is staying and I am not sure why. Meaning when it is called again the two data values are added instead of it just resetting to 0 like I have at the top of the class. Not sure why this is happening. Here is the code.</p>\n\n<pre><code>struct N *mknode(struct N *xp, struct N *yp, struct N *zp, long n)\n{\nstruct N *p = malloc(sizeof(struct N));\np-&gt;x = xp;\np-&gt;y = yp;\np-&gt;z = zp;\np-&gt;data = n;\nreturn p;\n}\n\nint main(int argc, const char *argv[])\n{\nstruct N *p1, *p2, *p3, *p4, *p5, *p6;\n\n// construct a tree for testing:\n\np1 = mknode(NULL, NULL, NULL, 1);\np2 = mknode(NULL, NULL, NULL, 10);\np3 = mknode(NULL, NULL, NULL, 100);\np4 = mknode(p1, p2, p3, 3000);\np1 = mknode(NULL, NULL, NULL, 1);\np2 = mknode(NULL, NULL, NULL, 10);\np3 = mknode(NULL, NULL, NULL, 100);\np5 = mknode(p1, p2, p3, 4000);\np5 = mknode(p4, p5, NULL, 50000);\np6 = mknode(p5, NULL, NULL, 100000);\n\n// to test only on trees, remove the following\n// assignments that turn the tree into a graph\n//p1-&gt;x = p5;\n//p2-&gt;y = p4;\n//p2-&gt;z = p2;\n//p6-&gt;y = p5;\n//p6-&gt;z = p6;\n\nlong s = sum(p6);\nlong x = sum(p6);\n</code></pre>\n\n<p>s and x should have the same value but x is double s for some reason.\nThis is the function code in a separate class.</p>\n\n<pre><code>long data = 0;\n\nlong sum(struct N *p){\nprintf(\"%ld\\n\", data);\nif (p != NULL){\n    sum(p-&gt;x);\n    sum(p-&gt;y);\n    sum(p-&gt;z);\n    return data += p-&gt;data;\n}\nreturn 0;\n}\n</code></pre>\n\n<p>Here is the initial struct in a header file.</p>\n\n<pre><code>struct N {\nstruct N *x;\nstruct N *y;\nstruct N *z;\nlong data;\n};\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1485986319, "post_id": 41990535, "comment_id": 71158316, "body": "Please indent your code properly.  It&#39;s difficult to read like this."}, {"owner": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "edited": false, "score": 1, "creation_date": 1485986908, "post_id": 41990535, "comment_id": 71158619, "body": "The end of the code is missing."}, {"owner": {"reputation": 10702, "user_id": 2079103, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XlVYy.png?s=128&g=1", "display_name": "clearlight", "link": "https://stackoverflow.com/users/2079103/clearlight"}, "edited": false, "score": 0, "creation_date": 1485987099, "post_id": 41990535, "comment_id": 71158720, "body": "<code>strncmp()</code> is considered generally safer / best practice than <code>strcmp()</code>, by constraining the maximum number of bytes compared to a known length so if someone tampers with the the trailing &#39;\\0&#39; they are less likely to wander way out of bounds and hack in somewhere."}, {"owner": {"reputation": 5, "user_id": 5995306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/831fe27bdb97bb260d9c8a39bd4a1c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Cynthia Garcia", "link": "https://stackoverflow.com/users/5995306/cynthia-garcia"}, "reply_to_user": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "edited": false, "score": 0, "creation_date": 1485987123, "post_id": 41990535, "comment_id": 71158734, "body": "@Martin Broadhurst, i think it is not necessary for the purpose of the question"}, {"owner": {"reputation": 5, "user_id": 5995306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/831fe27bdb97bb260d9c8a39bd4a1c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Cynthia Garcia", "link": "https://stackoverflow.com/users/5995306/cynthia-garcia"}, "reply_to_user": {"reputation": 10702, "user_id": 2079103, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XlVYy.png?s=128&g=1", "display_name": "clearlight", "link": "https://stackoverflow.com/users/2079103/clearlight"}, "edited": false, "score": 0, "creation_date": 1485987230, "post_id": 41990535, "comment_id": 71158786, "body": "@clearlight, well, it doesn&#39;t matter what command to use for me, if it works, then it is perfect"}, {"owner": {"reputation": 10702, "user_id": 2079103, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XlVYy.png?s=128&g=1", "display_name": "clearlight", "link": "https://stackoverflow.com/users/2079103/clearlight"}, "edited": false, "score": 0, "creation_date": 1485987558, "post_id": 41990535, "comment_id": 71158943, "body": "@CynthiaGarcia Hey, great attitude. Obviously you&#39;re the expert here. I&#39;m just telling you what pro-shops beat into people as good habits and why."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 10702, "user_id": 2079103, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XlVYy.png?s=128&g=1", "display_name": "clearlight", "link": "https://stackoverflow.com/users/2079103/clearlight"}, "edited": false, "score": 0, "creation_date": 1485987935, "post_id": 41990535, "comment_id": 71159127, "body": "@clearlight The only <code>strcpy()</code> used in the posted code is immediately after <code>malloc(strlen(word+1))</code>, to copy the string. Given that, the risk is minimal.  It&#39;d be a lot more constructive to point out that <code>malloc()</code> than <code>str[n]cpy()</code> is easily replaced with the <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/strdup.html\" rel=\"nofollow noreferrer\">standard function <code>strdup()</code></a>."}, {"owner": {"reputation": 10702, "user_id": 2079103, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XlVYy.png?s=128&g=1", "display_name": "clearlight", "link": "https://stackoverflow.com/users/2079103/clearlight"}, "edited": false, "score": 0, "creation_date": 1485988017, "post_id": 41990535, "comment_id": 71159156, "body": "Funny you mention that, in one of my most recent answers I did provide that example :-) She&#39;s posted too much code for the question IMO. It just wastes everyone time wading through all the badly formatted (originally) code to try to figure out where the issue is. I&#39;m not wasting anymore time trying to answer this."}, {"owner": {"reputation": 5, "user_id": 5995306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/831fe27bdb97bb260d9c8a39bd4a1c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Cynthia Garcia", "link": "https://stackoverflow.com/users/5995306/cynthia-garcia"}, "reply_to_user": {"reputation": 10702, "user_id": 2079103, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XlVYy.png?s=128&g=1", "display_name": "clearlight", "link": "https://stackoverflow.com/users/2079103/clearlight"}, "edited": false, "score": 0, "creation_date": 1485988193, "post_id": 41990535, "comment_id": 71159230, "body": "@clearlight, i couldn&#39;t found in your recent answers the example you are talking about"}, {"owner": {"reputation": 10702, "user_id": 2079103, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XlVYy.png?s=128&g=1", "display_name": "clearlight", "link": "https://stackoverflow.com/users/2079103/clearlight"}, "edited": false, "score": 0, "creation_date": 1485988258, "post_id": 41990535, "comment_id": 71159253, "body": "@AndrewHenie - If her attitude was  so dismissive out of hand I would have (besides fixing the indentation) been much more comprehensive.  Such as for this answer, where I did mention strdup(), but I didn&#39;t get that far because I didn&#39;t like the way she dealt with the whole thing.  <a href=\"http://stackoverflow.com/questions/41971159/segfault-in-c-program-malloc-call/41971294#41971294\" title=\"segfault in c program malloc call\">stackoverflow.com/questions/41971159/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5995306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/831fe27bdb97bb260d9c8a39bd4a1c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Cynthia Garcia", "link": "https://stackoverflow.com/users/5995306/cynthia-garcia"}, "edited": false, "score": 0, "creation_date": 1485988391, "post_id": 41991041, "comment_id": 71159313, "body": "Excuse me, i forgot to post it too, but the rest is working well"}, {"owner": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "reply_to_user": {"reputation": 5, "user_id": 5995306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/831fe27bdb97bb260d9c8a39bd4a1c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Cynthia Garcia", "link": "https://stackoverflow.com/users/5995306/cynthia-garcia"}, "edited": false, "score": 0, "creation_date": 1485988738, "post_id": 41991041, "comment_id": 71159466, "body": "So do you still have a question?"}, {"owner": {"reputation": 5, "user_id": 5995306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/831fe27bdb97bb260d9c8a39bd4a1c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Cynthia Garcia", "link": "https://stackoverflow.com/users/5995306/cynthia-garcia"}, "edited": false, "score": 0, "creation_date": 1485989785, "post_id": 41991041, "comment_id": 71159872, "body": "sure, by looking the code below, how i need to construct while or if statements to compare words in a file by using double linked list. There is no answer to my question"}, {"owner": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "reply_to_user": {"reputation": 5, "user_id": 5995306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/831fe27bdb97bb260d9c8a39bd4a1c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Cynthia Garcia", "link": "https://stackoverflow.com/users/5995306/cynthia-garcia"}, "edited": false, "score": 0, "creation_date": 1485989856, "post_id": 41991041, "comment_id": 71159904, "body": "You have a program that does that. What else do you want it to do?"}, {"owner": {"reputation": 5, "user_id": 5995306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/831fe27bdb97bb260d9c8a39bd4a1c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Cynthia Garcia", "link": "https://stackoverflow.com/users/5995306/cynthia-garcia"}, "edited": false, "score": 0, "creation_date": 1486010736, "post_id": 41991041, "comment_id": 71165647, "body": "i need to count distinct words, not repeated ones in text file"}], "tags": [], "owner": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "is_accepted": false, "score": 2, "last_activity_date": 1486024380, "last_edit_date": 1486024380, "creation_date": 1485988208, "answer_id": 41991041, "question_id": 41990535, "link": "https://stackoverflow.com/questions/41990535/how-to-compare-words-if-they-are-identical-in-c-linked-list/41991041#41991041", "title": "How to compare words if they are identical in C ?linked list", "body": "<p>You're missing this at the bottom of the outermost <code>while</code> loop of <code>printWordLength()</code>:</p>\n\n<pre><code>temp  = temp-&gt;next;\n</code></pre>\n\n<p>That's why it goes into an infinite loop (which you didn't tell us).</p>\n\n<p>Now, to count distinct words you just need to count every <code>WORD*</code> in every <code>WORDLENGTH*</code>, which you can do while you're printing them in <code>printWordLength()</code>:</p>\n\n<pre><code>void printWordLength()\n{\n    WLENGTH * temp = wordLength;\n    WORD * tempWORD = wordLength-&gt;words;\n    unsigned int unique_words = 0;\n    while(temp != NULL)\n    {\n        WORD * tempWORD = wordLength-&gt;words;\n        tempWORD = temp-&gt;words;\n        printf(\"\\nFor Word Length: %d : There are: %d occurences!\\n\",\n                temp-&gt;length, temp-&gt;count);\n        while(tempWORD != NULL)\n        {\n            printf(\"\\t%s\\toccurs:%d\\n\", tempWORD-&gt;word, tempWORD-&gt;count);\n            unique_words++;\n            tempWORD = tempWORD-&gt;next;\n        }\n        temp  = temp-&gt;next;\n    }\n    printf(\"\\nThere are %u unique words\\n\", unique_words);\n}\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5995306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/831fe27bdb97bb260d9c8a39bd4a1c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Cynthia Garcia", "link": "https://stackoverflow.com/users/5995306/cynthia-garcia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "closed_date": 1486226956, "answer_count": 1, "score": -3, "last_activity_date": 1486024380, "creation_date": 1485986175, "last_edit_date": 1485987887, "question_id": 41990535, "link": "https://stackoverflow.com/questions/41990535/how-to-compare-words-if-they-are-identical-in-c-linked-list", "closed_reason": "Not suitable for this site", "title": "How to compare words if they are identical in C ?linked list", "body": "<p>The code is given. I need to count number of words that are non identical. In order to do that i need to compare them using stcrmp. By looking the code below, how i need to construct while or if statements to compare words in a file by using double linked list? I suppose this condition should be in the main to print it then. My condition doesn't work.  Also, can you give some advice where and how to sort words by their length here?\nTo understand the code some explanation:\nThis program holds a doubly linked list that will read a file that is entered as a command line argument, read each line from file, tokenize each word from line and for each word will place it into a Word Length structure depending on its length and then will place it into a word_count structure dependent on the word's string and count each word's occurrence in a file.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define DELIM \" ,.+-=!?:;\\t\"\n#define MAXLINE 25000\n\ntypedef struct word_count {\n    char *word;\n    int count;\n    struct word_count *next;\n    struct word_count *prev;\n} WORD;\n\ntypedef struct word_length_count {\n    int length;\n    int count;\n    WORD *words;\n    struct word_length_count *next;\n    struct word_length_count *prev;\n} WLENGTH;\n\nint splitIntoWords(char line[]);\nvoid processLength(char *word);\nvoid processWord(char *word, WORD *wordCount);\nvoid printWordLength();\nWLENGTH *createWordLength(char *word);\nWORD *createWordCount(char *word);\n\nWLENGTH *wordLength = NULL;\n\nint main(unsigned int argc, unsigned char *argv[]) {\n    FILE *fpin;\n    char line[MAXLINE];\n    int totalWordCount = 0;\n\n    if ((fpin = fopen(argv[1], \"r\")) == NULL) {\n        printf(\"Can't open input file.\\n\");\n        exit(-1);\n    }\n\n    printf(\"This is the words all tokenized from the input!\\n\");\n    while (fgets(line, MAXLINE, fpin) != NULL) {\n        line[strcspn(line, \"\\n\")] = '\\0';\n        if (line[0] == '\\0')\n        continue;\n        totalWordCount += splitIntoWords(line);\n    }\n    printf(\"Total number of words is: %d\\n\", totalWordCount);\n    printWordLength();\n    printf(\"\\nFINISHED!\");\n}\n\nint splitIntoWords(char line[]) {\n    char *word;\n    int count=0;\n    word = strtok(line, DELIM);\n    for (;word != NULL;) {\n        count++;\n        printf(\"%s\\n\", word);\n        processLength(word);\n        word = strtok(NULL, DELIM);\n    }\n    return count;\n}\n\nvoid processLength(char *word)\n{\n    WLENGTH *wLCounter = NULL;\n    WLENGTH *wLLast = NULL;\n\n    if (wordLength == NULL) {\n        wordLength = createWordLength(word);\n        return;\n    }\n    wLCounter = wordLength;\n    while (wLCounter != NULL) {\n        if (strlen(word) == wLCounter-&gt;length) {\n            ++wLCounter-&gt;count;\n            processWord(word, wLCounter-&gt;words);\n            return;\n        }\n        wLLast = wLCounter;\n        wLCounter = wLCounter-&gt;next;\n    }\n    wLLast-&gt;next = createWordLength(word);\n}\n\nvoid processWord(char *word, WORD *wordCount) {\n    WORD *wCounter = NULL;\n    WORD *wLast = NULL;\n\n    if (wordCount == NULL) {\n        wordCount = createWordCount(word);\n        return;\n    }\n    wCounter = wordCount;\n    while (wCounter != NULL) {\n        if (strcmp(word, wCounter-&gt;word) == 0) {\n            ++wCounter-&gt;count;\n            return;\n        }\n        wLast = wCounter;\n        wCounter = wCounter-&gt;next;\n    }\n    wLast-&gt;next = createWordCount(word);\n}\n\nWLENGTH *createWordLength(char *word) {\n    WLENGTH *wLCounter = NULL;\n    wLCounter = (WLENGTH*)malloc(sizeof(WLENGTH));\n    wLCounter-&gt;words = createWordCount(word);\n    wLCounter-&gt;count = 1;\n    wLCounter-&gt;length = strlen(word);\n    wLCounter-&gt;next = NULL;\n    return wLCounter;\n}\n\nWORD *createWordCount(char *word) {\n    WORD *wCount = NULL;\n    wCount = (WORD*)malloc(sizeof(WORD));\n    wCount-&gt;word = (char*)malloc(strlen(word+1));\n    strcpy(wCount-&gt;word, word);\n    wCount-&gt;count = 1;\n    wCount-&gt;next = NULL;\n    return wCount;\n}\n\nvoid printWordLength() {\n    WLENGTH *temp = wordLength;\n    WORD *tempWORD = wordLength-&gt;words;\n    while (temp != NULL) {\n        WORD *tempWORD = wordLength-&gt;words;\n        tempWORD = temp-&gt;words;\n        printf(\"\\nFor Word Length: %d : There are: %d occurances!\\n\", temp-&gt;length, temp-&gt;count);\n        while (tempWORD != NULL) {\n            printf(\"\\t%s\\toccurs:%d\\n\", tempWORD-&gt;word, tempWORD-&gt;count);\n            tempWORD = tempWORD-&gt;next;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "segmentation-fault", "dynamic-memory-allocation", "realloc"], "comments": [{"owner": {"reputation": 103, "user_id": 7502807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12abc77d1a6e12301c0bd146bbf0a498?s=128&d=identicon&r=PG&f=1", "display_name": "cheesyfluff", "link": "https://stackoverflow.com/users/7502807/cheesyfluff"}, "edited": false, "score": 0, "creation_date": 1485985776, "post_id": 41990269, "comment_id": 71158039, "body": "I&#39;m sorry for earlier, I&#39;ve pasted, compiled, and ran, this is the code as it is and the error still occurs."}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 0, "creation_date": 1485987906, "post_id": 41990269, "comment_id": 71159113, "body": "You would do well to learn how to use GDB. Here is a decent link <a href=\"http://www.delorie.com/gnu/docs/gdb/gdb_toc.html\" rel=\"nofollow noreferrer\">delorie.com/gnu/docs/gdb/gdb_toc.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1485986892, "post_id": 41990469, "comment_id": 71158611, "body": "also, don&#39;t call realloc like this.  when it fails, you have lost the original pointer to the memory.  Save the result of realloc to a temporary variable and assign it on success."}, {"owner": {"reputation": 103, "user_id": 7502807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12abc77d1a6e12301c0bd146bbf0a498?s=128&d=identicon&r=PG&f=1", "display_name": "cheesyfluff", "link": "https://stackoverflow.com/users/7502807/cheesyfluff"}, "edited": false, "score": 0, "creation_date": 1485987048, "post_id": 41990469, "comment_id": 71158692, "body": "Thank you, initializing line[outerIndex] = NULL; prior to the realloc statement seemed to fix the error."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1485985948, "creation_date": 1485985948, "answer_id": 41990469, "question_id": 41990269, "link": "https://stackoverflow.com/questions/41990269/segmentation-fault-when-trying-to-read-stdin-to-a-2d-dynamically-allocated-array/41990469#41990469", "title": "Segmentation fault when trying to read stdin to a 2d dynamically allocated array", "body": "<p>On this line:</p>\n\n<pre><code>lines[outerIndex] = (char*) realloc(lines[outerIndex], (widths+1)*sizeof(char));\n</code></pre>\n\n<p>you supply an uninitialized pointer as the first argument to <code>realloc</code>. You should probably use <code>malloc</code> here instead.</p>\n\n<p>Other issues:</p>\n\n<ul>\n<li><code>char c</code> should be <code>int c</code> (read the documentation for <code>getchar</code> to see why).</li>\n<li>If the input begins with a space then <code>lines[outerIndex][innerIndex]='\\0'</code> writes out of bounds.</li>\n<li>The code block starting <code>if(innerIndex==widths)</code> is repeated twice in your code; it would be better to either make this a function, or restructure your code so there is not this repetition.</li>\n<li>You can simplify your malloc/realloc calls by removing redundant casts and the redundant multiplication by <code>sizeof(char)</code> which is always <code>1</code>.</li>\n<li>You should check malloc/realloc for failure and act accordingly.</li>\n</ul>\n"}], "owner": {"reputation": 103, "user_id": 7502807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12abc77d1a6e12301c0bd146bbf0a498?s=128&d=identicon&r=PG&f=1", "display_name": "cheesyfluff", "link": "https://stackoverflow.com/users/7502807/cheesyfluff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 41990469, "answer_count": 1, "score": 0, "last_activity_date": 1522946590, "creation_date": 1485985184, "last_edit_date": 1522946590, "question_id": 41990269, "link": "https://stackoverflow.com/questions/41990269/segmentation-fault-when-trying-to-read-stdin-to-a-2d-dynamically-allocated-array", "title": "Segmentation fault when trying to read stdin to a 2d dynamically allocated array", "body": "<p>I'm trying to read from stdin to a dynamic array of strings, using spaces as separators. The code is as follows</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nchar** parseInput(size_t *numElements)\n{\n  char **lines;\n  int outerIndex = 0;\n  int innerIndex = 0;\n  int widths = 1;\n  char c=getchar();\n  lines =(char**) malloc((outerIndex+1)*sizeof(char*));\n  lines[0] = (char*) malloc(sizeof(char));\n  while(c!=EOF)\n  {\n    if(innerIndex==widths)//reallocate each strings length, double it\n    {\n      widths+=widths;\n      int i;\n      for(i=0;i&lt;outerIndex+1;i++)\n        lines[i]=(char*)realloc(lines[i],(widths+1)*sizeof(char));\n    }\n    lines[outerIndex][innerIndex]=c;\n    innerIndex++;\n    if(c==' ')//allocate memory for the next string in the array of strings\n    {\n      lines[outerIndex][innerIndex]='\\0';\n      innerIndex=0;\n      outerIndex++;\n      lines =(char**) realloc(lines,(outerIndex+1)*sizeof(char*));\n      lines[outerIndex] = (char*) realloc(lines[outerIndex],(widths+1)*sizeof(char));\n      //the above line in the debugger causes a segfault when outerIndex=19\n    }\n    c=getchar();\n  }\n  if(innerIndex!=0)//if the last character is not a space, append a space\n  {\n    if(innerIndex==widths)\n    {\n      widths+=widths;\n      int i;\n      for(i=0;i&lt;outerIndex+1;i++)\n        lines[i]=(char*)realloc(lines[i],(widths+1)*sizeof(char));\n    }\n    lines[outerIndex][innerIndex]=' ';\n    lines[outerIndex][innerIndex+1]='\\0';\n  }\n  *numElements=(size_t)(outerIndex+1);\n  return lines;\n}\nint main()\n{\n    size_t num =0;\n    char** lines = parseInput(&amp;num);\n}\n</code></pre>\n\n<p>When the outer array size grows to anything more than 20 variables, I get a segmentation fault at the indicated line. For example the following input causes a segfault</p>\n\n<pre><code>1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20\n</code></pre>\n\n<p>but the following does not</p>\n\n<pre><code>1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19\n</code></pre>\n\n<p>The debug error says</p>\n\n<pre><code>Program received signal SIGSEGV, Segmentation fault.\n0x0000003417e7bf4d in realloc () from /lib64/libc.so.6\n</code></pre>\n\n<p>What could this be caused by?</p>\n"}, {"tags": ["c", "linux", "performance", "assembly"], "comments": [{"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1486128018, "post_id": 41990083, "comment_id": 71224376, "body": "You use this library: <a href=\"https://github.com/google/benchmark\" rel=\"nofollow noreferrer\">github.com/google/benchmark</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 0, "creation_date": 1485986539, "post_id": 41990194, "comment_id": 71158440, "body": "Won&#39;t the optimiser eliminate the loop?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 1, "creation_date": 1485987097, "post_id": 41990194, "comment_id": 71158716, "body": "For gcc you can use <code>__attribute__ ((optimize(0)))</code> on the test function to prevent it from being optimized.  Alternately, you put the test function in a different .c file compiled with different optimization settings."}, {"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 0, "creation_date": 1486014529, "post_id": 41990194, "comment_id": 71166826, "body": "You don&#39;t get the assembly in the question if you turn off optimization unless I have misunderstood.  Could you show explicitly how the other solution would work please?"}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 0, "creation_date": 1486632409, "post_id": 41990194, "comment_id": 71432205, "body": "@eleanora You put your test harness into a file <code>harness.c</code> and put the function to test into a file <code>function.c</code>. You can compile both files with <code>-O3</code> if you like. Then you link the results together without optimizations. That way, the optimizer does not see that calling <code>f(x)</code> several times in the test harness is pointless and will not optimize away the loop. However, it will optimize <code>f()</code> as best as it can."}, {"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1486632532, "post_id": 41990194, "comment_id": 71432295, "body": "@cmaster That sounds good. Could you add an answer with some command line example so I can accept it?"}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 0, "creation_date": 1486653097, "post_id": 41990194, "comment_id": 71446601, "body": "@eleanora While I believe that this answer was already good enough (I have upvoted it), I have now formulated a much more comprehensive answer. Hope you like it."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 4, "last_activity_date": 1485984874, "creation_date": 1485984874, "answer_id": 41990194, "question_id": 41990083, "link": "https://stackoverflow.com/questions/41990083/how-to-measure-speed-of-short-piece-of-c-assembly-code/41990194#41990194", "title": "How to measure speed of short piece of C/assembly code?", "body": "<p>You need a test harness that will call this function a large number of times.</p>\n\n<p>That will get the runtime up to a non-trivial level and will average out any differences caused by OS scheduling.</p>\n\n<pre><code>void test_f() \n{\n    complex float x[32] = { 1+2i, 2+3i };    // add as many as needed. \n                                             // here i is a special\n                                             // constant for complex numbers\n    int i;\n    for (i=0; i&lt;10000000; i++) {\n        f(x);\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 0, "creation_date": 1485986584, "post_id": 41990419, "comment_id": 71158456, "body": "How do you avoid the optimiser eliminating the loop if you just repeat it?"}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "reply_to_user": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 1, "creation_date": 1485986850, "post_id": 41990419, "comment_id": 71158583, "body": "@eleanora you can put the function in a different compilation unit (and then don&#39;t use LTO) (then it has to be called in a loop since the optimizer has to assume the function might do something funny), or just write the loop in assembly and be super sure that it does exactly what you want"}, {"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 0, "creation_date": 1486014617, "post_id": 41990419, "comment_id": 71166859, "body": "Would you be able to show the code needed for those ideas?  If it&#39;s possible to add the loop in assembly that looks like best solution but I don&#39;t know how to mix C and assembly."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "reply_to_user": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 0, "creation_date": 1486045404, "post_id": 41990419, "comment_id": 71185295, "body": "@eleanora I could show some example, but it depends on platform details (and the assembler). Combining C and assembly is not hard though, just compile/assembly into object files and link them together with the linker as usual. Calling a C function from assembly needs the right name (probably you need an underscore before the function name) and some form of <code>extern</code> declaration (syntax differs between assemblers)"}, {"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 0, "creation_date": 1486054196, "post_id": 41990419, "comment_id": 71191467, "body": "Thank you. I am on linux and am happy to use any tool that is most convenient for you. I think the assembly I pasted should compile/assembe with <code>gas</code> for example."}], "tags": [], "owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "is_accepted": false, "score": 1, "last_activity_date": 1485986074, "last_edit_date": 1485986074, "creation_date": 1485985687, "answer_id": 41990419, "question_id": 41990083, "link": "https://stackoverflow.com/questions/41990083/how-to-measure-speed-of-short-piece-of-c-assembly-code/41990419#41990419", "title": "How to measure speed of short piece of C/assembly code?", "body": "<p>Repeat it often enough that it takes a long enough time. Too short makes it more vulnerable to minor timing weirdnesses (the overhead of measuring time at all, instructions jumping over the time-reading instruction either into or out of the effectively timed region thanks to OoOE, whatever), too long .. doesn't really matter unless you're a purist. You can usually guess what the actual time should be, the measured time will be just a bit higher due to interrupts and such but you should get a result that's \"near\" a sensible value after you adjust for clock speed (for latency measurements you should get an integer number of cycles for example). Do multiple runs and plot it, ignore weird outliers especially at the top.</p>\n\n<p>Ensure that you're in turbo mode (or disable all frequency scaling in the BIOS settings) and that the vector units are \"awake\" (for AVX code) before timing, so do some warm-ups. The same code that you're intending to time can do that.</p>\n\n<p>Be very careful that you deliberately choose either to make the iterations dependent (measuring latency) or independent (measuring throughput), don't just do something random - you'd have a measurement that you don't know is latency or throughput. Also don't let the compiler optimize it away some or all calls to the thing you're measuring so you end up measuring <em>nothing</em>.</p>\n\n<p>You can use <code>rdtscp</code> for the timing itself, or something less precise - the less precision the longer your timing loop needs to be. You can roughly tell the precision from how the plot looks, if it looks highly discrete with a few \"bins\" that everything lines up in, use more iterations (or a better time measurement).</p>\n\n<p>If you intend to measure under specific cache conditions it gets trickier, because setting up that state requires time too, so it turns a bit into a game of \"guess the overhead\" (which is hard to measure exactly).</p>\n\n<p>FWIW the ICC asm looks faster, GCC is doing a lot of scalar math.</p>\n"}, {"comments": [{"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 0, "creation_date": 1486661910, "post_id": 42140201, "comment_id": 71452814, "body": "How do you compile  with full optimizations but link without optimizations?"}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 0, "creation_date": 1486678225, "post_id": 42140201, "comment_id": 71462073, "body": "You simply use <code>gcc -O3</code> when compiling, and use <code>gcc</code> when linking. The linker will usually just treat the symbols created during compiling as black boxes. However, afaik, there are some link-time optimizations that can be switched on explicitly. Just don&#39;t specify these to the linker command and you should be fine."}], "tags": [], "owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1486652943, "creation_date": 1486652943, "answer_id": 42140201, "question_id": 41990083, "link": "https://stackoverflow.com/questions/41990083/how-to-measure-speed-of-short-piece-of-c-assembly-code/42140201#42140201", "title": "How to measure speed of short piece of C/assembly code?", "body": "<p>There are a few steps you need to do whenever you want to perform a performance measurement:</p>\n\n<ol>\n<li><p>Repeat the operation to be measured often enough to get up to times that you can measure accurately. Usually one to ten seconds are enough. This can be achieved by a simple loop in virtually all cases.</p></li>\n<li><p>Prevent the optimizer from optimizing out the repetitions or optimizing the measured operation out entirely due to its unused results.</p>\n\n<p>There are several possible approaches to this:</p>\n\n<ul>\n<li><p>Modify the input in every iteration and actually use all the results. In your case, this could look something like this:</p>\n\n<pre><code>complex float accu = 0+0i;\nfor(int i = 0; i &lt; 100000000; i++) {\n    x[i%32] += 42+3i;   //different input on each pass\n    accu += f(x);\n}\nprintComplex(accu);    //this depends on the output of all passes\n</code></pre>\n\n<p>Note that this approach is a bit difficult to use, because it's very easy to overlook an optimization possibility and fail to safeguard against it. Your optimizer may understand the effects of too simple input modifications, and compile out significant parts of <code>f()</code> anyway, so be careful. The upside of this is that it allows the optimizer to inline the function, avoiding the function call overhead.</p></li>\n<li><p>Split into independent compilation units: Put the repetition loop into one .c file, and put the function to be tested into another .c file. Compile both separately with full optimizations, and link without optimizations.</p>\n\n<p>That way, the optimizer cannot look into your function when it compiles the repetition loop, and thus cannot know whether it has sideeffects. As such, it cannot optimize away the repetition. Likewise, when it compiles the function to be tested, it does not know that its results are not used, and consequently cannot optimize its body away entirely. The linker then just connects the parts.</p>\n\n<p>The downside of this is, that you cannot get the function call overhead out of the measurement. This may necessitate a reference measurement along the lines of point 3.</p></li>\n<li><p>Use some compiler directives like <code>#pragma</code> or <code>__attribute__(())</code> to avoid harmful optimizations. I have never used this, as either of the two approaches above has served me well in all cases, but it is certainly an option. The details are compiler specific, though.</p></li>\n</ul></li>\n<li><p>Assess the overhead of the measurement itself. If you are measuring high-latency operations like I/O calls, you may be able to skip this, but if you are measuring fast stuff like CPU arithmetic as in your example, you should run a comparison test where you define your function as</p>\n\n<pre><code>complex float f(complex float x[]) {\n    complex float p = 1.0;\n    return p;\n}\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1486652943, "creation_date": 1485984483, "last_edit_date": 1486631718, "question_id": 41990083, "link": "https://stackoverflow.com/questions/41990083/how-to-measure-speed-of-short-piece-of-c-assembly-code", "title": "How to measure speed of short piece of C/assembly code?", "body": "<p>Consider this C code:</p>\n\n<pre><code>#include &lt;complex.h&gt;\ncomplex float f(complex float x[]) {\n  complex float p = 1.0;\n  for (int i = 0; i &lt; 32; i++)\n    p += x[i];\n  return p;\n}\n</code></pre>\n\n<p>The Intel C Compiler run with <code>-O3 -march=core-avx2</code> gives:</p>\n\n<pre><code>f:\n        vmovups   ymm1, YMMWORD PTR [rdi]                       #5.10\n        vmovups   ymm2, YMMWORD PTR [64+rdi]                    #5.10\n        vmovups   ymm5, YMMWORD PTR [128+rdi]                   #5.10\n        vmovups   ymm6, YMMWORD PTR [192+rdi]                   #5.10\n        vmovsd    xmm0, QWORD PTR p.152.0.0.1[rip]              #3.19\n        vaddps    ymm3, ymm1, YMMWORD PTR [32+rdi]              #3.19\n        vaddps    ymm4, ymm2, YMMWORD PTR [96+rdi]              #3.19\n        vaddps    ymm7, ymm5, YMMWORD PTR [160+rdi]             #3.19\n        vaddps    ymm8, ymm6, YMMWORD PTR [224+rdi]             #3.19\n        vaddps    ymm9, ymm3, ymm4                              #3.19\n        vaddps    ymm10, ymm7, ymm8                             #3.19\n        vaddps    ymm11, ymm9, ymm10                            #3.19\n        vextractf128 xmm12, ymm11, 1                            #3.19\n        vaddps    xmm13, xmm11, xmm12                           #3.19\n        vmovhlps  xmm14, xmm13, xmm13                           #3.19\n        vaddps    xmm15, xmm13, xmm14                           #3.19\n        vaddps    xmm0, xmm15, xmm0                             #3.19\n        vzeroupper                                              #6.10\n        ret                                                     #6.10\n</code></pre>\n\n<p>gcc version 7 (snapshot) with <code>-O3 -march=core-avx2 -ffast-math</code> gives:</p>\n\n<pre><code>f:\n        lea     r10, [rsp+8]\n        and     rsp, -32\n        push    QWORD PTR [r10-8]\n        push    rbp\n        mov     rbp, rsp\n        push    r10\n        vmovups ymm0, YMMWORD PTR [rdi+64]\n        vmovaps ymm1, YMMWORD PTR .LC0[rip]\n        vaddps  ymm0, ymm0, YMMWORD PTR [rdi+32]\n        vaddps  ymm1, ymm1, YMMWORD PTR [rdi]\n        vaddps  ymm0, ymm0, ymm1\n        vmovups ymm1, YMMWORD PTR [rdi+128]\n        vaddps  ymm1, ymm1, YMMWORD PTR [rdi+96]\n        vaddps  ymm0, ymm0, ymm1\n        vmovups ymm1, YMMWORD PTR [rdi+192]\n        vaddps  ymm1, ymm1, YMMWORD PTR [rdi+160]\n        vaddps  ymm0, ymm0, ymm1\n        vaddps  ymm0, ymm0, YMMWORD PTR [rdi+224]\n        vunpckhps       xmm3, xmm0, xmm0\n        vshufps xmm2, xmm0, xmm0, 255\n        vshufps xmm1, xmm0, xmm0, 85\n        vaddss  xmm1, xmm2, xmm1\n        vaddss  xmm3, xmm3, xmm0\n        vextractf128    xmm0, ymm0, 0x1\n        vunpckhps       xmm4, xmm0, xmm0\n        vshufps xmm2, xmm0, xmm0, 85\n        vaddss  xmm4, xmm4, xmm0\n        vshufps xmm0, xmm0, xmm0, 255\n        vaddss  xmm0, xmm2, xmm0\n        vaddss  xmm3, xmm3, xmm4\n        vaddss  xmm1, xmm1, xmm0\n        vmovss  DWORD PTR [rbp-24], xmm3\n        vmovss  DWORD PTR [rbp-20], xmm1\n        vzeroupper\n        vmovq   xmm0, QWORD PTR [rbp-24]\n        pop     r10\n        pop     rbp\n        lea     rsp, [r10-8]\n        ret \n</code></pre>\n\n<p>I am interested in which one is faster so it would be great to measure the running time.  </p>\n\n<p>However, I don't know how to measure the running time for code that takes so little time.</p>\n\n<blockquote>\n  <p>Which code is faster and how can one measure it reliably?</p>\n</blockquote>\n"}, {"tags": ["c", "arrays", "arduino", "serial-port"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485987923, "post_id": 41990020, "comment_id": 71159122, "body": "<code>fprintf(file, &quot;%d &quot;, rgb[i]);</code> writes <i>text</i>.  Try just catching text and then convert to <code>int</code>.  Suggest using a non-space delimiter to know when the end of the textual representation of a number is complete."}], "answers": [{"tags": [], "owner": {"reputation": 5508, "user_id": 794749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pfE2l.jpg?s=128&g=1", "display_name": "gre_gor", "link": "https://stackoverflow.com/users/794749/gre-gor"}, "is_accepted": true, "score": 1, "last_activity_date": 1485997825, "creation_date": 1485997825, "answer_id": 41992699, "question_id": 41990020, "link": "https://stackoverflow.com/questions/41990020/reading-ints-from-serial-port-arduino/41992699#41992699", "title": "Reading ints from serial port Arduino", "body": "<p>You need to read the data and put it into a buffer. After you encounter a <code>' '</code> character you terminate the string inside the buffer and convert it into an int.<br>\nWhen you do this three times you have read all three ints.</p>\n\n<pre><code>const uint8_t buff_len = 7; // buffer size\nchar buff[buff_len]; // buffer\nuint8_t buff_i = 0; // buffer index\n\nint arr[3] = {0,0,0}; // number array\nuint8_t arr_i = 0; // number array index\n\nvoid loop() {\n    while (Serial.available() &gt; 0) {\n        char c = Serial.read();\n        if (buff_i &lt; buff_len-1) { // check if buffer is full\n            if (c == ' ') { // check if got number terminator\n                buff[buff_i++] = 0; // terminate the string\n                buff_i = 0; // reset the buffer index\n                arr[arr_i++] = atoi(buff); // convert the string to int\n                if (arr_i == 3) { // if got all three numbers\n                    arr_i = 0; // reset the number array index\n\n                    // do something with the three integers\n                }\n            }\n            else if (c == '-' || ('0' &lt;= c &amp;&amp; c &lt;= '9')) // if negative sign or valid digit\n                buff[buff_i++] = c; // put the char into the buffer\n        }\n    }\n    // maybe do some other stuff\n}\n</code></pre>\n\n<p>Or if you don't mind blocking code<sup>[1]</sup> you can use builtin <a href=\"https://www.arduino.cc/en/Serial/ParseInt\" rel=\"nofollow noreferrer\"><code>ParseInt</code></a>.</p>\n\n<pre><code>void loop() {\n    while (Serial.available() &gt; 0) {\n        arr[0] = Serial.parseInt();\n        arr[1] = Serial.parseInt();\n        arr[2] = Serial.parseInt();\n        Serial.read(); // read off the last space\n\n        // do something with the three integers\n    }\n    // maybe do some other stuff, but might be blocked by serial read\n}\n</code></pre>\n\n<p><sup>[1] If your computer has a hiccup and doesn't send all the data at once, your Arduino code will just wait for data and won't be doing anything else. Read more <a href=\"https://hackingmajenkoblog.wordpress.com/2016/02/01/reading-serial-on-the-arduino/\" rel=\"nofollow noreferrer\">here</a>.</sup></p>\n"}], "owner": {"reputation": 744, "user_id": 6913016, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0b6177616ddaeed18dab5860e52d112a?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/6913016/sergio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1014, "favorite_count": 0, "accepted_answer_id": 41992699, "answer_count": 1, "score": 0, "last_activity_date": 1485997825, "creation_date": 1485984268, "last_edit_date": 1485986494, "question_id": 41990020, "link": "https://stackoverflow.com/questions/41990020/reading-ints-from-serial-port-arduino", "title": "Reading ints from serial port Arduino", "body": "<p>I've done a C program that writes an integer array into the Arduino:</p>\n\n<pre><code>// ...\nFILE* file;\nfile = fopen(\"/dev/ttyuSB0\",\"w\");\nfor (int i = 0; i &lt; 3; i++) {\n    fprintf(file, \"%d \", rgb[i]);\n}\nfclose(file);\n// ...\n</code></pre>\n\n<p>How can I do from my arduino code (.ino) to catch the three integers from the file?</p>\n\n<pre><code>while (Serial.available() &gt; 0) {\n\n    // What can I do here ???\n\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "unix"], "comments": [{"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 1, "creation_date": 1485982657, "post_id": 41989608, "comment_id": 71156527, "body": "If you&#39;re looking for explanations on Linux filesystem permissions, it may be better to look on <a href=\"http://unix.stackexchange.com\">unix.stackexchange.com</a>."}, {"owner": {"reputation": 125, "user_id": 7077615, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DGtI3.jpg?s=128&g=1", "display_name": "metarose", "link": "https://stackoverflow.com/users/7077615/metarose"}, "reply_to_user": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 0, "creation_date": 1485982783, "post_id": 41989608, "comment_id": 71156609, "body": "@AntonH this permission came after a C program. I think it is related here too."}, {"owner": {"reputation": 125, "user_id": 7077615, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DGtI3.jpg?s=128&g=1", "display_name": "metarose", "link": "https://stackoverflow.com/users/7077615/metarose"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1485982866, "post_id": 41989608, "comment_id": 71156660, "body": "@jxh umask is 0002."}, {"owner": {"reputation": 125, "user_id": 7077615, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DGtI3.jpg?s=128&g=1", "display_name": "metarose", "link": "https://stackoverflow.com/users/7077615/metarose"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1485983603, "post_id": 41989608, "comment_id": 71157035, "body": "@jxh # file: open_1.txt # owner: arien # group: arien # flags: -s- user::rw- group::-wx other::---"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1485983836, "post_id": 41989608, "comment_id": 71157156, "body": "open() allows a third argument: the intended mode for if the file needs to be created. --&gt;&gt; <code>fd = open(FILE, O_RDWR | O_CREAT, 0644);</code>"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1485984263, "post_id": 41989608, "comment_id": 71157342, "body": "BTW: <code>#define FILE</code> is asking for trouble. stdio defines FILE (a bad name, agreed)  please use another macroname, like <code>#define FILENAME &quot;omg.txt&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 7077615, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DGtI3.jpg?s=128&g=1", "display_name": "metarose", "link": "https://stackoverflow.com/users/7077615/metarose"}, "edited": false, "score": 0, "creation_date": 1486016528, "post_id": 41990321, "comment_id": 71167655, "body": "What&#39;s that mean S and T?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 125, "user_id": 7077615, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DGtI3.jpg?s=128&g=1", "display_name": "metarose", "link": "https://stackoverflow.com/users/7077615/metarose"}, "edited": false, "score": 1, "creation_date": 1486020944, "post_id": 41990321, "comment_id": 71169697, "body": "@H.Emre, the &#39;S&#39; in the <code>ls</code> output represents the file&#39;s SUID bit.  The &#39;T&#39; represents the sticky bit."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 8, "last_activity_date": 1485985667, "last_edit_date": 1485985667, "creation_date": 1485985346, "answer_id": 41990321, "question_id": 41989608, "link": "https://stackoverflow.com/questions/41989608/unexpected-result-ws-wx-t-on-file-permission-with-open-function-in-c/41990321#41990321", "title": "unexpected result(-wS-wx--T) on file permission with open() function in C", "body": "<p>If you include <code>O_CREAT</code> in the flags passed to <code>open()</code> then you <strong><em>must</em></strong> use the three-arg form of the function, which takes a numeric file mode as the third argument.  This requirement is documented in <a href=\"http://man7.org/linux/man-pages/man2/open.2.html\">the Linux manual page for the function</a> (emphasis added):</p>\n\n<blockquote>\n  <p>The <code>mode</code> argument specifies the file mode bits be applied when   a\n  new file is created.  <strong>This argument must be supplied when   <code>O_CREAT</code> or\n  <code>O_TMPFILE</code> is specified in <code>flags</code></strong>; if neither <code>O_CREAT</code>   nor <code>O_TMPFILE</code> is\n  specified, then mode is ignored.</p>\n</blockquote>\n\n<p>What mode you actually want is unclear, but perhaps <code>S_IRUSR | S_IWUSR | S_IRGRP</code> would be suitable (== <code>0640</code>; read and write for the owner, read only for the owner's group, no permission for anyone else).</p>\n"}, {"tags": [], "owner": {"reputation": 125, "user_id": 7077615, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DGtI3.jpg?s=128&g=1", "display_name": "metarose", "link": "https://stackoverflow.com/users/7077615/metarose"}, "is_accepted": false, "score": 0, "last_activity_date": 1501065961, "last_edit_date": 1501065961, "creation_date": 1486305354, "answer_id": 42053271, "question_id": 41989608, "link": "https://stackoverflow.com/questions/41989608/unexpected-result-ws-wx-t-on-file-permission-with-open-function-in-c/42053271#42053271", "title": "unexpected result(-wS-wx--T) on file permission with open() function in C", "body": "<p>I found two different definition of open function, you can see them with <code>man 2 open</code> and <code>man 3 open</code> in linux terminal.<br /></p>\n\n<p><code>man 2 open</code> for Linux Programmer's Manuel.<br />\n<code>man 3 open</code> for POSIX Programmer's Manuel.<br /></p>\n\n<p>If you use <strong>POSIX Programmer's Manuel</strong> definition(sample code in the question) for open function, you can take unexpected permissions(like -wS-wx--T).<br />\nIf you use <strong>Linux Programmer's Manuel</strong> definition(sample code below) you can take regular permission.<br />\nI am not sure that's true but I noticed it. <br />\nIf I am faulty please correct me.</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;sys/types.h&gt;\n    #include &lt;sys/stat.h&gt;\n    #include &lt;fcntl.h&gt;\n    #include &lt;stdlib.h&gt;\n\n    int main(int argc, char *argv[])\n    {\n\n            int fd;\n\n            if(argc != 2){\n                    printf(\"[usage] %s &lt;file_name&gt;\\n\", argv[0]);\n                    exit(0);\n            }\n\n            fd = open(argv[1], O_RDWR | O_APPEND | O_CREAT, S_IRWXU | S_IRWXG | S_IROTH);\n        if(fd == -1){\n                perror(\"[error] open function\\n\");\n                exit(-1);\n        }else{\n                printf(\"[succeeded]\\n\");\n        }\n\n        return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 7077615, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DGtI3.jpg?s=128&g=1", "display_name": "metarose", "link": "https://stackoverflow.com/users/7077615/metarose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 41990321, "answer_count": 2, "score": 3, "last_activity_date": 1510081559, "creation_date": 1485982570, "last_edit_date": 1510081559, "question_id": 41989608, "link": "https://stackoverflow.com/questions/41989608/unexpected-result-ws-wx-t-on-file-permission-with-open-function-in-c", "title": "unexpected result(-wS-wx--T) on file permission with open() function in C", "body": "<p>I wrote this program to open a file. Everything was OK until I saw this permission(-wS-wx--T) with <code>ls -lh</code></p>\n\n<p><strong>open.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n\n#define FILE \"foo.txt\"\n\nint main()\n{\n        int fd;\n        int errnum;\n\n        fd = open(FILE, O_RDWR | O_CREAT);\n\n        if(fd == -1)\n        {\n                printf(\"[error] The file hasn't opened.\\n\");\n                perror(\"Error printed by perror\");\n        }else {\n                printf(\"The process was succeeded\\n\");\n        }\n\n        return 0;\n}\n</code></pre>\n\n<p>I compiled the program featly, didn't take any error or warning.</p>\n\n<pre><code>$ ./open\nThe process was succeeded\n$ ls -lh\n-rwxrwxr-x 1 hemre hemre 8.5K Feb  1 23:38 open\n--wS-wx--T 1 hemre hemre    0 Feb  1 23:39 foo.txt\n</code></pre>\n\n<p>I haven't ever seen kind of permission. What are 'S' and 'T' meaning in\nthe file permissions section? \n(NOTE: I took the answer to this question in the comments.)</p>\n"}, {"tags": ["c++", "c", "dll", "static-linking", "dynamic-linking"], "answers": [{"comments": [{"owner": {"reputation": 11622, "user_id": 1097451, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1516b785b675ba751aacdc05ae31764b?s=128&d=identicon&r=PG", "display_name": "Martin Drozdik", "link": "https://stackoverflow.com/users/1097451/martin-drozdik"}, "edited": false, "score": 0, "creation_date": 1485983832, "post_id": 41989826, "comment_id": 71157154, "body": "Thank you! By &quot;standard library&quot; do you mean the runtime library, or do you imply that this is included in the standard library?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 11622, "user_id": 1097451, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1516b785b675ba751aacdc05ae31764b?s=128&d=identicon&r=PG", "display_name": "Martin Drozdik", "link": "https://stackoverflow.com/users/1097451/martin-drozdik"}, "edited": false, "score": 1, "creation_date": 1485983911, "post_id": 41989826, "comment_id": 71157182, "body": "Neither C nor C++ standards say anything about a runtime library. malloc and free are part of the standard libraries in both languages."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "is_accepted": true, "score": 4, "last_activity_date": 1485984129, "last_edit_date": 1485984129, "creation_date": 1485983490, "answer_id": 41989826, "question_id": 41989605, "link": "https://stackoverflow.com/questions/41989605/what-problems-can-linking-both-static-and-dynamic-libraries-into-the-same-execut/41989826#41989826", "title": "What problems can linking both static and dynamic libraries into the same executable cause?", "body": "<p>Let's say that A.dll links statically with standard library version 1.0. And it has  a function that looks like this:</p>\n\n<pre><code>  char * f() {\n     return malloc( 100 );   // uses malloc 1.0\n  }\n</code></pre>\n\n<p>Now lets say there is another library B.dll that links dynamically with A.dll and statically with standard library version 1.1. It has  a function that looks like this:</p>\n\n<pre><code>   void g() {\n      char * p = f();  // returns the result of malloc 1.0\n      free( p );   // uses free 1.1\n   }\n</code></pre>\n\n<p>You then probably (I say \"probably\" because none of this is standardised) have a pointer that was dynamically allocated with standard library 1.0, but that was freed with version 1.1. This can often lead to severe and hard to diagnose problems.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1485984946, "post_id": 41990140, "comment_id": 71157672, "body": "There is no such thing as statically or dynamically compiled. And no, you would not have to recompile the .exe - you might have to re-link it."}], "tags": [], "owner": {"reputation": 216, "user_id": 5270951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/912e784fefa1d9205673924a82d8dc1b?s=128&d=identicon&r=PG", "display_name": "jimmytt", "link": "https://stackoverflow.com/users/5270951/jimmytt"}, "is_accepted": false, "score": 1, "last_activity_date": 1485984670, "creation_date": 1485984670, "answer_id": 41990140, "question_id": 41989605, "link": "https://stackoverflow.com/questions/41989605/what-problems-can-linking-both-static-and-dynamic-libraries-into-the-same-execut/41990140#41990140", "title": "What problems can linking both static and dynamic libraries into the same executable cause?", "body": "<p>Because statically compiled dlls are compiled before runtime, if you need to change anything (say functions), you would have to re-compile the .exe. Statically compiled dlls are also larger than dynamically linked dlls. Dynamically linked dlls are linked at runtime, so every program has access to them because the all the functions have special place in memory, without having multiple copies of them (like when they are statically compiled). Hope this helps.</p>\n"}], "owner": {"reputation": 11622, "user_id": 1097451, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1516b785b675ba751aacdc05ae31764b?s=128&d=identicon&r=PG", "display_name": "Martin Drozdik", "link": "https://stackoverflow.com/users/1097451/martin-drozdik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 563, "favorite_count": 1, "accepted_answer_id": 41989826, "answer_count": 2, "score": 2, "last_activity_date": 1485984670, "creation_date": 1485982558, "question_id": 41989605, "link": "https://stackoverflow.com/questions/41989605/what-problems-can-linking-both-static-and-dynamic-libraries-into-the-same-execut", "title": "What problems can linking both static and dynamic libraries into the same executable cause?", "body": "<p>I was asked this question on a job interview today. Unfortunately, I am not sure that I have reproduced it here correctly. I just remember, that I did not understand it very well. The question might have been </p>\n\n<blockquote>\n  <p>\"What problems can loading statically and dynamically compiled dlls\n  cause?\"</p>\n</blockquote>\n\n<p>I did not know the answer, but the interviewer told me that <strong>there are at least two main problems</strong>:</p>\n\n<ol>\n<li><p>The runtime library: there can be some incompatible allocations and de-allocations of memory.</p></li>\n<li><p>Unfortunately here we got interrupted and we did not get back to this question.</p></li>\n</ol>\n\n<p>Please, could you help me understand what this question might have been, as well as what is the answer?</p>\n\n<p>I also did not understand the first point very well. I thought there can be only one <code>malloc</code> in a program, am I wrong?</p>\n"}, {"tags": ["c", "makefile"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1485982580, "post_id": 41989599, "comment_id": 71156468, "body": "Remove the <code>.txt</code>"}], "answers": [{"comments": [{"owner": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "edited": false, "score": 0, "creation_date": 1485983791, "post_id": 41989655, "comment_id": 71157129, "body": "Or you can do <code>make -f makefile.txt</code>."}], "tags": [], "owner": {"reputation": 9345, "user_id": 4237316, "user_type": "registered", "accept_rate": 47, "profile_image": "https://graph.facebook.com/100004533998341/picture?type=large", "display_name": "Harald Nordgren", "link": "https://stackoverflow.com/users/4237316/harald-nordgren"}, "is_accepted": false, "score": 1, "last_activity_date": 1485982785, "creation_date": 1485982785, "answer_id": 41989655, "question_id": 41989599, "link": "https://stackoverflow.com/questions/41989599/make-no-targerts-specified-and-no-makefile-found-stop/41989655#41989655", "title": "Make: *** No targerts specified and no makefile found. Stop", "body": "<p>The makefile should be called <code>Makefile</code>, not <code>makefile.txt</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1514328861, "creation_date": 1514328861, "answer_id": 47984554, "question_id": 41989599, "link": "https://stackoverflow.com/questions/41989599/make-no-targerts-specified-and-no-makefile-found-stop/47984554#47984554", "title": "Make: *** No targerts specified and no makefile found. Stop", "body": "<p>The error message says \u201cno makefile found\u201d. This means it isn\u2019t seeing your file. According to <a href=\"https://www.gnu.org/software/make/manual/make.html#Makefile-Names\" rel=\"nofollow noreferrer\">the GNU Make documentation</a>, it by default looks for <code>GNUmakefile</code>, <code>makefile</code>, and <code>Makefile</code>, in that order; they suggest you call your file <code>Makefile</code>. None of these have an extension.</p>\n\n<p>It also says what to do if you\u2019re sure you want to use a nonstandard name for the makefile:</p>\n\n<blockquote>\n  <p>If you want to use a nonstandard name for your makefile, you can specify the makefile name with the \u2018<code>-f</code>\u2019 or \u2018<code>--file</code>\u2019 option. The arguments \u2018<code>-f</code> <em>name</em>\u2019 or \u2018<code>--file=</code><em>name</em>\u2019 tell make to read the file <em>name</em> as the makefile. If you use more than one \u2018<code>-f</code>\u2019 or \u2018<code>--file</code>\u2019 option, you can specify several makefiles. All the makefiles are effectively concatenated in the order specified. The default makefile names <code>GNUmakefile</code>, <code>makefile</code> and <code>Makefile</code> are not checked automatically if you specify \u2018<code>-f</code>\u2019 or \u2018<code>--file</code>\u2019.</p>\n</blockquote>\n\n<p>Therefore, you should either rename your makefile to <code>Makefile</code> with no extension, or call <code>make</code> with <code>make -f makefile.txt</code>. You should strongly prefer the first option, because anybody else who looks at your code will expect it. Besides a makefile isn\u2019t really a plain-text natural-language file solely for humans like the <code>.txt</code> usually implies.</p>\n"}], "owner": {"reputation": 1, "user_id": 6526015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ab84d31996714283f062d3ca7646bb?s=128&d=identicon&r=PG&f=1", "display_name": "Arman", "link": "https://stackoverflow.com/users/6526015/arman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1514328861, "creation_date": 1485982536, "last_edit_date": 1514323950, "question_id": 41989599, "link": "https://stackoverflow.com/questions/41989599/make-no-targerts-specified-and-no-makefile-found-stop", "title": "Make: *** No targerts specified and no makefile found. Stop", "body": "<pre><code>CC=gcc\nCFLAGS=-Wall -ansi \n\nreversepoetry : reversepoetry.o \n    $(CC) -o reversepoetry reversepoetry.o \n\nreversepoetry.o : reversepoetry.c \n    $(CC) $(CFLAGS) -c reversepoetry.c \nrun: \n    $./reversepoetry  \nclean:\n    rm reversepoetry reversepoetry.o \n</code></pre>\n\n<p>I'm having trouble running this make file. the only things in the directory is makefile.txt and reversepoetry.c \nI type $ make and I get the error posted in the title</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "edited": false, "score": 3, "creation_date": 1485982708, "post_id": 41989528, "comment_id": 71156565, "body": "Please don&#39;t loop over <code>feof()</code> - <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\" title=\"why is while feof file always wrong\">stackoverflow.com/questions/5431941/&hellip;</a>"}, {"owner": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "edited": false, "score": 5, "creation_date": 1485982859, "post_id": 41989528, "comment_id": 71156653, "body": "Show us where you initialise <code>QBoat-&gt;car_id</code>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1485982952, "post_id": 41989528, "comment_id": 71156712, "body": "Post your entire program."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1485983137, "post_id": 41989528, "comment_id": 71156812, "body": "Your typedef doesn&#39;t have a type name."}, {"owner": {"reputation": 29, "user_id": 7502719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/544deef9eb08f87e8df1395c0ba21f65?s=128&d=identicon&r=PG&f=1", "display_name": "UserA", "link": "https://stackoverflow.com/users/7502719/usera"}, "reply_to_user": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "edited": false, "score": 0, "creation_date": 1485983579, "post_id": 41989528, "comment_id": 71157022, "body": "@MartinBroadhurst you mean where i malloc it?"}, {"owner": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "edited": false, "score": 1, "creation_date": 1485983676, "post_id": 41989528, "comment_id": 71157071, "body": "Yes. where you <code>malloc()</code> it. Post a complete code sample that will compile and exhibit the problem,"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1486044165, "post_id": 41990429, "comment_id": 71184370, "body": "With code like <code>queue-&gt;items = malloc( capacity * sizeof(char *) );</code>, I find <code>queue-&gt;items = malloc(capacity * sizeof *(queue-&gt;items) );</code> easier to code, review and maintain."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": false, "score": 3, "last_activity_date": 1486064307, "last_edit_date": 1486064307, "creation_date": 1485985771, "answer_id": 41990429, "question_id": 41989528, "link": "https://stackoverflow.com/questions/41989528/struct-and-char/41990429#41990429", "title": "Struct and char**", "body": "<p>It's very easy to mess up memory allocation and deallocation with a struct. So it's best to always write new and destroy functions for every struct.</p>\n\n<pre><code>/* To avoid confusion, it's best to declare structs as type definitions\n   and name them Something_t. Capital letter to avoid conflict with\n   built in types, _t to note that it is a type, and to avoid conflict\n   with other names. */\ntypedef struct {\n    /* Using size_t means less type casting */\n    size_t capacity;\n    int front;\n    int rear;\n    int size;\n    char **items;\n} Queue_t;\n\nQueue_t *Queue_new( const size_t capacity ) {\n    /* Use calloc because we have to zero everything anyway */\n    Queue_t *queue = calloc( 1, sizeof(Queue_t) );\n\n    /* Allocate enough space to store a list of whatever\n       queue-&gt;items is a list of */\n    queue-&gt;capacity = capacity;\n    queue-&gt;items = malloc( capacity * sizeof(*(queue-&gt;items)) );\n\n    return queue;\n}\n\nvoid Queue_destroy( Queue_t *queue ) {\n    /* Since items were copied into the list, it's the queue's responsibility\n       to free them */\n    for( int i = queue-&gt;front; i &lt; queue-&gt;rear; i++ ) {\n        free( queue-&gt;items[i] );\n    }\n\n    /* Now free the list of items */\n    free( queue-&gt;items );\n\n    /* And finally the struct itself */\n    free( queue );\n}\n</code></pre>\n\n<p>Now that the struct has been allocated, and its list of items, you have to make sure not to add too many items. Your code adding to the queue never checks if it's overrun the queue's capacity. For this reason, it's best to write a function to add items that will correctly check capacity.</p>\n\n<pre><code>void Queue_add( Queue_t *queue, const char *item ) {\n    if( queue-&gt;size &gt;= (int)queue-&gt;capacity ) {\n        fprintf(stderr, \"Queue capacity of %zu exceeded!\\n\", queue-&gt;capacity);\n        exit(1);\n    }\n\n    /* You used strcpy in your example, so I'm following that.\n       You could also not copy and store the original pointer. */\n    queue-&gt;items[ queue-&gt;rear ] = strdup( item );\n\n    /* I don't know if this is right */\n    queue-&gt;rear++;\n    queue-&gt;size++;\n}\n</code></pre>\n\n<p>The queuing logic might be wrong, I'm not good with queues, but you get the idea. You could even later extend the queue to automatically resize itself.</p>\n\n<p>Now you can test those work in isolation. Once you're sure they work, you can try reading from a file and using your queue functions.</p>\n\n<pre><code>int main() {\n    char filename[] = \"car.txt\";\n    FILE *fp = fopen(filename,\"r\");\n    if (fp == NULL) {\n        fprintf(stderr, \"Couldn't read '%s': %s\\n\", filename, strerror(errno));\n        exit(1);\n    }\n\n    /* Just picked a number out of thin air */\n    Queue_t *qboats = Queue_new(256);\n    Queue_t *sboats = Queue_new(256);\n\n    char line[10];\n    while( fgets( line, 10, fp) != NULL ) {\n        size_t len = strlen(line);\n\n        /* Choose the right queue to use */\n        Queue_t *queue;\n        switch ( line[len-2] ) {\n            case 'S':\n                queue = sboats;\n                break;\n            case 'Q':\n                queue = qboats;\n                break;\n            default:\n                fprintf( stderr, \"Can't understand line '%s'\\n\", line );\n                continue;\n                break;\n        }\n\n        /* Chop off the identifier */\n        line[len - 2] = '\\0';\n\n        /* Add to the queue */\n        Queue_add( queue, line );\n    }\n\n    /* Do something with the queues. This should probably be Queue_print(). */\n    for( int i = qboats-&gt;front; i &lt; qboats-&gt;rear; i++ ) {\n        printf(\"qboat: %s\\n\", qboats-&gt;items[i]);\n    }\n\n    for( int i = sboats-&gt;front; i &lt; sboats-&gt;rear; i++ ) {\n        printf(\"sboat: %s\\n\", sboats-&gt;items[i]);\n    }\n\n    /* Now clean them up */\n    Queue_destroy( sboats );\n    Queue_destroy( qboats );\n}\n</code></pre>\n\n<p>Most of the work is now determining which queue to use.</p>\n"}], "owner": {"reputation": 29, "user_id": 7502719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/544deef9eb08f87e8df1395c0ba21f65?s=128&d=identicon&r=PG&f=1", "display_name": "UserA", "link": "https://stackoverflow.com/users/7502719/usera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 619, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1486064460, "creation_date": 1485982284, "last_edit_date": 1486064460, "question_id": 41989528, "link": "https://stackoverflow.com/questions/41989528/struct-and-char", "title": "Struct and char**", "body": "<p>I am completely new in C programming recently I started looking a bit more into pointer and I have encountered a problem with my code.</p>\n\n<p>So I try to pass a string to a <code>char**</code> that is into a struct but I am always getting errors. Thanks in advance here is some code </p>\n\n<p>This is the struct I used.</p>\n\n<pre><code>typedef struct Queue {\nint capacity;\nint front;\nint rear;\nint size;\nchar **car_id;\n};\n</code></pre>\n\n<p>And this is what I try to put into it. Inside the first if you can see I try to <code>strcpy</code> but fails. Even if I put &amp; or *.</p>\n\n<pre><code>    printf(\"Printing the contect of the TXT file\\n\");\nint countS=-1,countQ=-1;\nchar line[10];\nFILE *fp;\nfp = fopen(\"car.txt\",\"r\");\nif (fp == NULL) {\n    printf(\"Error: File doesn't exist exiting the programm!\");\n    exit(1);\n}\nwhile(!feof(fp)){\n      fgets(line,10,fp);\n      printf(\"%s\",line);\n\n       if(line[(strlen(line))-2]=='Q'){\n        countQ++;\n        line[strlen(line)-2] = 0;\n        strcpy(car_id,line);\n        strcpy(QBoat-&gt;car_id[countQ],car_id);\n        QBoat-&gt;rear=countQ;\n        QBoat-&gt;front=0;\n        QBoat-&gt;size=countQ;\n       }else if(line[(strlen(line))-2]=='S'){\n        countS++;\n        line[strlen(line)-2] = 0;\n        SBoat-&gt;top = countS;\n        //strcpy(SBoat-&gt;car_id[countS],line);\n       }\n\n}\nfclose(fp);\n</code></pre>\n"}, {"tags": ["c", "database", "variables", "types", "binaryfiles"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1485981602, "post_id": 41989297, "comment_id": 71155894, "body": "The file should have a known format that tells you the size and type of each record.  Without that, there&#39;s no way to know what&#39;s there."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1485982055, "post_id": 41989297, "comment_id": 71156156, "body": "Data in a binary file has no type. Once you read it into a variable in your program, that variable has whatever type you defined it to be."}, {"owner": {"reputation": 93, "user_id": 6484916, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2e5d26c6f29d13cbab6227f08eb9a144?s=128&d=identicon&r=PG&f=1", "display_name": "mr.Nobody", "link": "https://stackoverflow.com/users/6484916/mr-nobody"}, "edited": false, "score": 0, "creation_date": 1485983270, "post_id": 41989297, "comment_id": 71156885, "body": "But my professor keep saying this is correct, you can find a way :) I don&#39;t have any idea..."}], "answers": [{"tags": [], "owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "is_accepted": false, "score": 0, "last_activity_date": 1485990841, "creation_date": 1485990841, "answer_id": 41991582, "question_id": 41989297, "link": "https://stackoverflow.com/questions/41989297/how-to-check-data-type-of-a-variable-in-binary-file-in-c/41991582#41991582", "title": "How to check data type of a variable in binary file in c", "body": "<p>In one sense there is no answer. You can construct data which looks like it is in one format whilst actually being in a different format.\nIn reality, you can almost always \"eyeball\" it. Print the data  as a stream of double,s float, integers of various width, and one sequence will look sensible and like real data.</p>\n\n<p>But you're helped out by the knowledge that the last member is a double and also a mean. So simply load the data into a memory buffer, cast to int *, float * etc, add up the total, work out the mean, and check.</p>\n"}], "owner": {"reputation": 93, "user_id": 6484916, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2e5d26c6f29d13cbab6227f08eb9a144?s=128&d=identicon&r=PG&f=1", "display_name": "mr.Nobody", "link": "https://stackoverflow.com/users/6484916/mr-nobody"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 931, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485990841, "creation_date": 1485981456, "question_id": 41989297, "link": "https://stackoverflow.com/questions/41989297/how-to-check-data-type-of-a-variable-in-binary-file-in-c", "title": "How to check data type of a variable in binary file in c", "body": "<p>Hi guys I read a binary file which consists of 1000 records of unknown C structure. Structure has these data types char (1 byte) int (4 bytes) \nlong long int (8 bytes)  float (4 bytes) and double (8 bytes) and at the end of each record there is a double variable which keeps average of all other data fields in that record. Maximum data field in the structure can be 11 (including average field).\nfor example </p>\n\n<pre><code>struct data{\nchar v1;\nint v2;\nfloat v3;\ndouble v4;\nlong long int v5;\nint v6;\n\ndouble avg;\n}\n</code></pre>\n\n<p>I could not find a way to check the type of the variable which I read from binary file.Only thing I need is a hint just can you tell me a way how to find data type.</p>\n"}, {"tags": ["c", "hash"], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1485984180, "creation_date": 1485984180, "answer_id": 41990000, "question_id": 41989009, "link": "https://stackoverflow.com/questions/41989009/am-i-doing-right-for-hashing-function/41990000#41990000", "title": "Am I doing right for hashing function?", "body": "<blockquote>\n  <p>But I am not sure if I am doing correctly, Is this really hash function?</p>\n</blockquote>\n\n<p>I take you to be asking whether your code accurately implements the specification you provided.  It does not, at least not in a portable manner, though it's close.  The main issue is its failure to address this provision of the specification:</p>\n\n<blockquote>\n  <blockquote>\n    <p>consider each character as an unsigned 8-bit number</p>\n  </blockquote>\n</blockquote>\n\n<p>C allows the <code>char</code> type to be either signed or unsigned, at the discretion of the implementation.  Signed <code>char</code> is pretty common, and your code does not account for that.</p>\n\n<p>Additionally, although C requires <code>char</code> to be the same size as <code>unsigned char</code>, and it requires <code>unsigned char</code> to have <em>at least</em> 8 bits, none of them padding bits, it does not require <em>exactly</em> 8 bits.  In practice, however, all modern systems use 8-bit <code>char</code>s, and it seems unlikely that the exercise expects you to account for the possibility of larger ones.</p>\n\n<p><strong><em>To address this issue,</em></strong> you need to convert each <code>char</code> in the string to an unsigned 8-bit number before adding it to the accumulator variable.  There are several ways to do that.  If you are willing to assume that <code>unsigned char</code> has exactly 8 bits, then the easiest thing to do is just to cast each character to that type before adding.</p>\n\n<hr>\n\n<p>As a secondary issue, your function does not necessarily implement the modular addition as described in the spec:</p>\n\n<blockquote>\n  <blockquote>\n    <p>The hashing function adds the bytes of a string modulo k.</p>\n  </blockquote>\n</blockquote>\n\n<p>The risk here is that the sum of all the characters in the string is enough to overflow type <code>unsigned</code>.  The maximum value of that type can be as small as 65535 (though in most modern implementations it's much larger), and at that size, it is plausible that the sum of the input string's characters would overflow.  In that case, waiting until the end to compute the remainder will produce the wrong result unless parameter <em>K</em> is a power of 2.</p>\n\n<p>Note also that choosing type <code>unsigned int</code> for the result limits the allowable <em>K</em> to be at most <code>UINT_MAX + 1</code>, and using <code>unsigned int</code> for the internal accumulator variable is inconsistent with values of <em>K</em> between <code>UINT_MAX - 254</code> and <code>UINT_MAX</code> (but <code>UINT_MAX + 1</code> is still ok).</p>\n\n<p><strong><em>To (mostly) address this issue,</em></strong> compute and store the modulus after adding each character, instead of waiting until the end to do so.</p>\n\n<p>If you need to accommodate <em>K</em> close to but less than <code>UINT_MAX + 1</code>, then you'll need also to watch out for the addition overflowing, and to apply a correction in the event that overflow occurs.</p>\n"}], "owner": {"reputation": 522, "user_id": 2507710, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e1972bd20155bc8fd9a5377136ccc13a?s=128&d=identicon&r=PG&f=1", "display_name": "online.0227", "link": "https://stackoverflow.com/users/2507710/online-0227"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 41990000, "answer_count": 1, "score": -1, "last_activity_date": 1485984180, "creation_date": 1485980544, "question_id": 41989009, "link": "https://stackoverflow.com/questions/41989009/am-i-doing-right-for-hashing-function", "title": "Am I doing right for hashing function?", "body": "<p>I am assigned to do following :</p>\n\n<blockquote>\n  <p>The easiest hashing function it to read the string a character by\n  character and consider each character as an unsigned 8-bit number\n  between 0 and 255. Then we add all the characters modulo some integer \n  k resulting in an integer between 0 and k-1. We assume the previous\n  hashing function. The hashing function adds the bytes of a string\n  modulo k. The size of the hash table is k.</p>\n</blockquote>\n\n<p>Thus, I coded like following:</p>\n\n<pre><code>unsigned hash (char *s)\n{\n unsigned hashval;\n\n for (hashval = 0; *s != '\\0'; s++) { \n    hashval += *s;    \n}\n\n return hashval % HASHSIZE;\n}\n</code></pre>\n\n<p>Here, HASHSIZE is equivalent to K in specification.</p>\n\n<p>But I am not sure if I am doing correctly, Is this really hash function?</p>\n\n<p>Thank you very much.</p>\n"}, {"tags": ["c", "unix", "message-queue"], "answers": [{"comments": [{"owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 0, "creation_date": 1485980468, "post_id": 41988937, "comment_id": 71155314, "body": "The <code>char[]</code> is just a placeholder, you can have whatever you want in the structure after the required <code>long mtype</code> field.  The size on the <code>msgsnd()</code> call does NOT include <code>mtype</code>."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "reply_to_user": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 0, "creation_date": 1485980670, "post_id": 41988937, "comment_id": 71155412, "body": "@JohnHascall Is <code>mtype</code> required?"}, {"owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 0, "creation_date": 1485987281, "post_id": 41988937, "comment_id": 71158813, "body": "Yes the struct must begin with a <code>long</code> for the message type.  You don&#39;t have to call it <code>mtype</code> but that&#39;s the normal practice."}], "tags": [], "owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "is_accepted": false, "score": 0, "last_activity_date": 1485980634, "last_edit_date": 1485980634, "creation_date": 1485980312, "answer_id": 41988937, "question_id": 41988823, "link": "https://stackoverflow.com/questions/41988823/is-this-how-message-queues-are-supposed-to-work/41988937#41988937", "title": "Is this how message queues are supposed to work?", "body": "<pre><code>int msgsnd(int msqid, const void *msgp, size_t msgsz, int msgflg);\n</code></pre>\n\n<p>Since the <code>msgp</code> parameter is declared as <code>const void*</code>, you can use whatever data type you want. There is nothing that says it has to be a <code>struct</code> with just a <code>long</code> and a <code>char[]</code>. This means you can just do <code>sizeof(send)</code>. You do not need to adjust for the extra struct member that you are sending. In fact, doing so will cause problems because the entire struct will not be handled. The only thing that matters is that <code>msgrcv()</code> uses the same struct as the previous <code>msgsnd()</code>. See <a href=\"http://tldp.org/LDP/lpg/node35.html\" rel=\"nofollow noreferrer\">this example</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "is_accepted": false, "score": 4, "last_activity_date": 1485985431, "last_edit_date": 1485985431, "creation_date": 1485980624, "answer_id": 41989035, "question_id": 41988823, "link": "https://stackoverflow.com/questions/41988823/is-this-how-message-queues-are-supposed-to-work/41989035#41989035", "title": "Is this how message queues are supposed to work?", "body": "<p>From the <a href=\"http://man7.org/linux/man-pages/man2/msgsnd.2.html\" rel=\"nofollow noreferrer\">man page</a>, in:</p>\n\n<pre><code>int msgsnd(int msqid, const void *msgp, size_t msgsz, int msgflg);\n</code></pre>\n\n<p><code>msgp</code> is defined as:</p>\n\n<blockquote>\n  <p>The msgp argument is a pointer to a <strong>caller-defined</strong> structure of the\n         following general form:</p>\n\n<pre><code>      struct msgbuf {\n           long mtype;       /* message type, must be &gt; 0 */\n           char mtext[1];    /* message data */\n       };\n</code></pre>\n</blockquote>\n\n<p><strong><em>Bold</strong> is mine</em></p>\n\n<p>The major point here being the struct is <em>caller-defined</em>. So as long as the input struct (sent by <code>msgsnd</code>) and output struct (received by <code>msgrcv</code>) are the same, the data following <code>mtype</code> can be anything you want (as long as you specify the size correctly). For your case, you really only need:</p>\n\n<pre><code>msgsnd(qid, (void*)&amp;send, sizeof(send) - sizeof(send.mtype), 0)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>msgrcv(qid, (void*)&amp;recieve, sizeof(recieve) - sizeof(send.mtype), 1, 0)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1843, "user_id": 3185860, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/23e2427bb6481f77d8fb17f990e33ab4?s=128&d=identicon&r=PG&f=1", "display_name": "Toma Radu-Petrescu", "link": "https://stackoverflow.com/users/3185860/toma-radu-petrescu"}, "edited": false, "score": 0, "creation_date": 1485981208, "post_id": 41989118, "comment_id": 71155689, "body": "Thanks for the answer, but I can&#39;t see the difference between your version and mine. Your size_t sz = sizeof(struct msg) - sizeof(long) is the equivalent of my sizeof(recieve) - sizeof(recieve.x). Am I missing something?"}, {"owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "reply_to_user": {"reputation": 1843, "user_id": 3185860, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/23e2427bb6481f77d8fb17f990e33ab4?s=128&d=identicon&r=PG&f=1", "display_name": "Toma Radu-Petrescu", "link": "https://stackoverflow.com/users/3185860/toma-radu-petrescu"}, "edited": false, "score": 0, "creation_date": 1485987177, "post_id": 41989118, "comment_id": 71158762, "body": "It&#39;s only numerically &quot;equivalent&quot; if an <code>int</code> and a <code>long</code> are the same size."}, {"owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "reply_to_user": {"reputation": 1843, "user_id": 3185860, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/23e2427bb6481f77d8fb17f990e33ab4?s=128&d=identicon&r=PG&f=1", "display_name": "Toma Radu-Petrescu", "link": "https://stackoverflow.com/users/3185860/toma-radu-petrescu"}, "edited": false, "score": 0, "creation_date": 1485987668, "post_id": 41989118, "comment_id": 71158994, "body": "Semantically, it is correct to subtract the size of the <code>mtype</code>. It is not correct to subtract off some field you want to send (like <code>x</code>)."}], "tags": [], "owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "is_accepted": true, "score": 1, "last_activity_date": 1485980845, "creation_date": 1485980845, "answer_id": 41989118, "question_id": 41988823, "link": "https://stackoverflow.com/questions/41988823/is-this-how-message-queues-are-supposed-to-work/41989118#41989118", "title": "Is this how message queues are supposed to work?", "body": "<p>The char[] is just a placeholder, you can have whatever you want in the structure after the required long mtype field. The size on the msgsnd() call does NOT include mtype.</p>\n\n<p>You almost had it correct.</p>\n\n<p>Here is a working version:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/msg.h&gt;\n\nint main(void){\n\n    struct msg {\n        long mtype;\n        char text[100];\n        int x;\n    };\n\n    size_t sz = sizeof(struct msg) - sizeof(long);  &lt;=== /* SIZE */\n    int key = ftok(\".\", 10);\n    int qid = msgget(key, 0666|IPC_CREAT);\n\n    int pid = fork();\n\n    if (pid == 0){\n        struct msg send;\n        send.mtype = 1;\n        strcpy(send.text, \"hello\");\n        send.x = 99;\n        if (msgsnd(qid, (void*)&amp;send, sz, 0)&lt;0){\n             perror(\"Error child: \");\n        }\n    } else {\n        struct msg recieve;\n        if(msgrcv(qid, (void*)&amp;recieve, sz, 1, 0)&lt;0){\n             perror(\"Error parent: \");\n        };\n        printf(\"text: %s\\nnumber: %d\\n\", recieve.text, recieve.x);\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1843, "user_id": 3185860, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/23e2427bb6481f77d8fb17f990e33ab4?s=128&d=identicon&r=PG&f=1", "display_name": "Toma Radu-Petrescu", "link": "https://stackoverflow.com/users/3185860/toma-radu-petrescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 357, "favorite_count": 0, "accepted_answer_id": 41989118, "answer_count": 3, "score": 1, "last_activity_date": 1485985431, "creation_date": 1485979931, "question_id": 41988823, "link": "https://stackoverflow.com/questions/41988823/is-this-how-message-queues-are-supposed-to-work", "title": "Is this how message queues are supposed to work?", "body": "<p>I am trying to understand message queues. In the examples I saw, the <code>msg</code> strunct would have only one more attribute except of the first one (the type) which must be <code>long</code>. So, it would be something like <code>struct msg{long mtype; char text[100]};</code>. </p>\n\n<p>I tried to add a new <code>int</code> attribute, <code>x</code> to see if I recieve both the text and the number and it worked.</p>\n\n<p>Is this how message queues are supposed to work? Can I have as many attributes as I want in my <code>struct</code>? </p>\n\n<p>And, also, is it ok to call the <code>msgrcv</code> and <code>msgsnd</code> functions with the length parameter set to <code>sizeof(send) - sizeof(send.x)</code> because I know that the sizeof a struct isn't always the same as the sum of the <code>sizeof</code> of each attribute?\nThank you.</p>\n\n<pre><code>int main(){\n\n    struct msg{\n        long mtype;\n        char text[100];\n        int x;\n    };\n\n    int key = ftok(\".\", 10);\n    int qid = msgget(key, 0666|IPC_CREAT);\n\n    int pid = fork();\n\n    if(pid == 0){\n        struct msg send;\n        send.mtype = 1;\n        strcpy(send.text, \"hello\");\n        send.x = 99;\n        if(msgsnd(qid, (void*)&amp;send, sizeof(send) - sizeof(send.x), 0)&lt;0){\n             printf(\"Error child: \");\n        }\n    }\n    else{\n        struct msg recieve;\n        if(msgrcv(qid, (void*)&amp;recieve, sizeof(recieve) - sizeof(recieve.x), 1, 0)&lt;0){\n             perror(\"Error parent: \");\n        };\n        printf(\"text: %s\\nnumber: %d\", recieve.text, recieve.x);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "avr"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1485976775, "post_id": 41987864, "comment_id": 71153320, "body": "Arduino is not C! And AVR is a harvard architecture and not well suited for dynamically loading code. Also Assembly code has to be translated before usage. If you mean <b>machine</b> code: that&#39;s something very different."}, {"owner": {"reputation": 1383, "user_id": 4696955, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-Bef502HUdvc/AAAAAAAAAAI/AAAAAAAAAA4/xILmyHEn5iU/photo.jpg?sz=128", "display_name": "CodenameLambda", "link": "https://stackoverflow.com/users/4696955/codenamelambda"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1485976929, "post_id": 41987864, "comment_id": 71153402, "body": "@Olaf The Arduino is just using an AVR chip, and I compile C to create the needed bytecode."}, {"owner": {"reputation": 1383, "user_id": 4696955, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-Bef502HUdvc/AAAAAAAAAAI/AAAAAAAAAA4/xILmyHEn5iU/photo.jpg?sz=128", "display_name": "CodenameLambda", "link": "https://stackoverflow.com/users/4696955/codenamelambda"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1485976952, "post_id": 41987864, "comment_id": 71153410, "body": "@Olaf I meant machine code"}, {"owner": {"reputation": 1383, "user_id": 4696955, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-Bef502HUdvc/AAAAAAAAAAI/AAAAAAAAAA4/xILmyHEn5iU/photo.jpg?sz=128", "display_name": "CodenameLambda", "link": "https://stackoverflow.com/users/4696955/codenamelambda"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1485977048, "post_id": 41987864, "comment_id": 71153475, "body": "@MByD Does it really matter? It&#39;s currently an Arduino Uno, but the final project will run under an Arduino Nano."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1485977091, "post_id": 41987864, "comment_id": 71153497, "body": "The you should remove the Arduino-tag and change to AVR and C. &quot;Arduino&quot; implies the language for a software site like this one! The rest of my comments still apply."}, {"owner": {"reputation": 129197, "user_id": 464988, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2b7216361772f42fefdb90cbc8bd7855?s=128&d=identicon&r=PG", "display_name": "MByD", "link": "https://stackoverflow.com/users/464988/mbyd"}, "edited": false, "score": 2, "creation_date": 1485977113, "post_id": 41987864, "comment_id": 71153516, "body": "It actually does. on most AVRs you cannot run code from RAM, and there is separation between code and data, but on ARM based you might be able to do so."}, {"owner": {"reputation": 1383, "user_id": 4696955, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-Bef502HUdvc/AAAAAAAAAAI/AAAAAAAAAA4/xILmyHEn5iU/photo.jpg?sz=128", "display_name": "CodenameLambda", "link": "https://stackoverflow.com/users/4696955/codenamelambda"}, "reply_to_user": {"reputation": 129197, "user_id": 464988, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2b7216361772f42fefdb90cbc8bd7855?s=128&d=identicon&r=PG", "display_name": "MByD", "link": "https://stackoverflow.com/users/464988/mbyd"}, "edited": false, "score": 0, "creation_date": 1485977182, "post_id": 41987864, "comment_id": 71153553, "body": "@MByD Thank you for that information..."}, {"owner": {"reputation": 1383, "user_id": 4696955, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-Bef502HUdvc/AAAAAAAAAAI/AAAAAAAAAA4/xILmyHEn5iU/photo.jpg?sz=128", "display_name": "CodenameLambda", "link": "https://stackoverflow.com/users/4696955/codenamelambda"}, "reply_to_user": {"reputation": 129197, "user_id": 464988, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2b7216361772f42fefdb90cbc8bd7855?s=128&d=identicon&r=PG", "display_name": "MByD", "link": "https://stackoverflow.com/users/464988/mbyd"}, "edited": false, "score": 0, "creation_date": 1485977580, "post_id": 41987864, "comment_id": 71153769, "body": "@MByD Do you think that an Arduino MKRZero (it runs on an ARM architecture) is able to load program code at runtime?"}, {"owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1485977907, "post_id": 41987864, "comment_id": 71153959, "body": "An AVR based Arduino can probably not do this. What actual problem are you trying to solve?"}, {"owner": {"reputation": 1383, "user_id": 4696955, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-Bef502HUdvc/AAAAAAAAAAI/AAAAAAAAAA4/xILmyHEn5iU/photo.jpg?sz=128", "display_name": "CodenameLambda", "link": "https://stackoverflow.com/users/4696955/codenamelambda"}, "reply_to_user": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1486135795, "post_id": 41987864, "comment_id": 71229443, "body": "@AShelly I am trying to be able to adjust a curve that is controlling how much the motor should move from another device."}, {"owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1486156074, "post_id": 41987864, "comment_id": 71240587, "body": "So turn the curve into data instead of code.  Use a combination of variables (and function pointers if needed) to change the control system,"}, {"owner": {"reputation": 1383, "user_id": 4696955, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-Bef502HUdvc/AAAAAAAAAAI/AAAAAAAAAA4/xILmyHEn5iU/photo.jpg?sz=128", "display_name": "CodenameLambda", "link": "https://stackoverflow.com/users/4696955/codenamelambda"}, "reply_to_user": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1486157734, "post_id": 41987864, "comment_id": 71241270, "body": "@AShelly That is what I planned to do instead anyway. But that makes performance worse and limits the amount of possible shapes of the curve."}], "answers": [{"tags": [], "owner": {"reputation": 5508, "user_id": 794749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pfE2l.jpg?s=128&g=1", "display_name": "gre_gor", "link": "https://stackoverflow.com/users/794749/gre-gor"}, "is_accepted": true, "score": 3, "last_activity_date": 1485977443, "creation_date": 1485977443, "answer_id": 41988100, "question_id": 41987864, "link": "https://stackoverflow.com/questions/41987864/insert-machine-code-into-c-code-at-runtime/41988100#41988100", "title": "Insert machine code into C code at runtime", "body": "<p>If you intend to load extra program code over serial, you can't do that.</p>\n\n<p>From the <a href=\"http://playground.arduino.cc/Learning/Memory\" rel=\"nofollow noreferrer\">Arduino docs</a>:</p>\n\n<blockquote>\n  <p>Note: Flash (PROGMEM) memory can only be populated at program burn time. You can\u2019t change the values in the flash after the program has started running.</p>\n</blockquote>\n\n<p>AVR stores programs in separate physical memory (Flash). You can read from it, but can't write at runtime unlike RAM and EEPROM.</p>\n"}], "owner": {"reputation": 1383, "user_id": 4696955, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-Bef502HUdvc/AAAAAAAAAAI/AAAAAAAAAA4/xILmyHEn5iU/photo.jpg?sz=128", "display_name": "CodenameLambda", "link": "https://stackoverflow.com/users/4696955/codenamelambda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 41988100, "answer_count": 1, "score": -1, "last_activity_date": 1485977443, "creation_date": 1485976691, "last_edit_date": 1485977310, "question_id": 41987864, "link": "https://stackoverflow.com/questions/41987864/insert-machine-code-into-c-code-at-runtime", "title": "Insert machine code into C code at runtime", "body": "<p>I am currently building some stuff with an Arduino Uno/Nano using the C language, and I need to insert some already compiled code from outside into the executable at runtime.</p>\n\n<p>I want to be able to use it like a dynamically linked library, that I can exchange within the program.</p>\n\n<p>Here is some code to show what I mean:</p>\n\n<pre><code>int external_code(int); // the external code needs to be called some way\nvoid set_external_code(char*); // set the external code that gets executed\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1485976299, "post_id": 41987730, "comment_id": 71153072, "body": "Put steps 1 and 2 inside the loop?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1485976466, "post_id": 41987730, "comment_id": 71153156, "body": "<code>continue</code> skips the rest of a <code>for</code> loop, essentially returning to the first statement (if the end condition is not true). For nested loops, only the present loop, not the outer loop."}, {"owner": {"reputation": 63, "user_id": 6896337, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a6b2962c5e39187137e4f1e0d19053a6?s=128&d=identicon&r=PG&f=1", "display_name": "Aisha Ashwal", "link": "https://stackoverflow.com/users/6896337/aisha-ashwal"}, "edited": false, "score": 0, "creation_date": 1485976483, "post_id": 41987730, "comment_id": 71153169, "body": "Re putting steps 1 and 2 inside the loop: I already tried that, upon printing the error message the program does not go back to steps 1 and 2."}, {"owner": {"reputation": 3919, "user_id": 3169961, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42c9a71949249cac6172502dfce7da7d?s=128&d=identicon&r=PG", "display_name": "sabbahillel", "link": "https://stackoverflow.com/users/3169961/sabbahillel"}, "edited": false, "score": 0, "creation_date": 1485976995, "post_id": 41987730, "comment_id": 71153438, "body": "Your end brackets are missing in the if statement."}], "answers": [{"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1485976493, "creation_date": 1485976493, "answer_id": 41987803, "question_id": 41987730, "link": "https://stackoverflow.com/questions/41987730/return-to-the-beginning-of-an-if-statement-in-a-loop/41987803#41987803", "title": "return to the beginning of an if-statement in a loop", "body": "<p>The simplest approach is to wrap it in another loop.</p>\n\n<pre><code>bool game_over = false;\n\ndo {\n    printf(\"Prompt for user input\\n\");     //step1\n    //user input                           \n    scanf(\"%s\", &amp;input);                   //step2\n    //check input\n\n    bool input_okay = true;\n    for (i = 0; i &lt; 7; i++) {\n        if (strncmp(input, condition) == 0) {\n          //do something\n        }\n        else{\n              printf(\"error\\n\");\n              input_okay = game_over = false;\n              break;\n    }\n\n    if (!input_okay)\n      continue;   // restart do while\n\n    //\n} while(!game_over);\n</code></pre>\n\n<p>The flags (defined with the <code>bool</code> type from <code>stdbool.h</code>) are required to make sure the continue statement is executed in the correct scope (of the <code>do ... while</code> loop).</p>\n"}, {"tags": [], "owner": {"reputation": 15008, "user_id": 16582, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/febff21383acf755f8b375c322e36f2b?s=128&d=identicon&r=PG", "display_name": "ravenspoint", "link": "https://stackoverflow.com/users/16582/ravenspoint"}, "is_accepted": false, "score": 0, "last_activity_date": 1485976832, "last_edit_date": 1485976832, "creation_date": 1485976519, "answer_id": 41987808, "question_id": 41987730, "link": "https://stackoverflow.com/questions/41987730/return-to-the-beginning-of-an-if-statement-in-a-loop/41987808#41987808", "title": "return to the beginning of an if-statement in a loop", "body": "<pre><code>bool OK = false\nwhile( ! OK ) {\n    printf(\"Prompt for user input\\n\");     //step1\n    //user input                           \n    scanf(\"%s\", &amp;input);                   //step2\n    //check input\n    for (i = 0; i &lt; 7; i++) {\n            if (strncmp(input, condition) == 0)\n            {//do something}\n                OK = true\n            }\n            else\n            {\n                  printf(\"error\\n\");\n                  //need to do steps 1 and 2 again\n                  OK = false;\n            }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 170, "user_id": 4543427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/549e4e00ae03b14d27637074b14e6c4d?s=128&d=identicon&r=PG&f=1", "display_name": "Sweekritee Singh", "link": "https://stackoverflow.com/users/4543427/sweekritee-singh"}, "is_accepted": false, "score": 2, "last_activity_date": 1485978578, "creation_date": 1485978578, "answer_id": 41988417, "question_id": 41987730, "link": "https://stackoverflow.com/questions/41987730/return-to-the-beginning-of-an-if-statement-in-a-loop/41988417#41988417", "title": "return to the beginning of an if-statement in a loop", "body": "<p>From your question i could understand that you are prompting the user to enter value untill he gives correct answer or he completes the 7 chances.</p>\n\n<p>You can use do while loop for the same:</p>\n\n<pre><code> int chanceCount = 0;  //it will keep track of number of chances user gets\n\ndo {\n            printf(\"Prompt for user input\\n\");    \n             //user input                           \n            scanf(\"%s\", &amp;input);  \n\n            if (strncmp(input, condition) == 0)\n            {\n                   //do something\n                   break; /* come out of loop, as user gave correct answer*/\n            }\n           else\n           {\n                 printf(\"error try again \\n\");\n\n             }\n            chanceCount ++;\n     }while(chanceCount != 7);\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 6896337, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a6b2962c5e39187137e4f1e0d19053a6?s=128&d=identicon&r=PG&f=1", "display_name": "Aisha Ashwal", "link": "https://stackoverflow.com/users/6896337/aisha-ashwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1970, "favorite_count": 0, "accepted_answer_id": 41987803, "answer_count": 3, "score": 1, "last_activity_date": 1485978578, "creation_date": 1485976233, "question_id": 41987730, "link": "https://stackoverflow.com/questions/41987730/return-to-the-beginning-of-an-if-statement-in-a-loop", "title": "return to the beginning of an if-statement in a loop", "body": "<p>I'm trying to create a simple game where the user has to go through a maze.  At the beginning of the maze, I give the user possible routes to take, and ask the user which route to take next.  If the user enters a correct route, I take him to the next route.  If the user enters a wrong route, I print an error message, followed by the prompt again, and read his input again.</p>\n\n<p>I'm having trouble figuring out what to do after I print the error message.  How do I go back to the beginning of the loop?  I did some research and am starting to think that I should use a do-while loop instead, but given the iterations in between (repeating this step until the user finds the exit of the maze), I struggle to figure out exactly how to do that. </p>\n\n<p>Here is my original if-else statement:</p>\n\n<pre><code>        printf(\"Prompt for user input\\n\");     //step1\n        //user input                           \n        scanf(\"%s\", &amp;input);                   //step2\n        //check input\n        for (i = 0; i &lt; 7; i++) {\n            if (strncmp(input, condition) == 0){//do something}\n            else{\n                  printf(\"error\\n\");\n                  //need to do steps 1 and 2 again\n        }\n</code></pre>\n\n<p>Thank you for your time, any help would be greatly appreciated!</p>\n"}, {"tags": ["c", "variadic-functions", "calling-convention"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1485975936, "post_id": 41987610, "comment_id": 71152871, "body": "It&#39;s up to ABI I believe.."}, {"owner": {"reputation": 2004, "user_id": 4916831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kIpeA.jpg?s=128&g=1", "display_name": "lcmylin", "link": "https://stackoverflow.com/users/4916831/lcmylin"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1485976205, "post_id": 41987610, "comment_id": 71153017, "body": "@EugeneSh. If that is the case, I&#39;ve updated my question to reflect that I am most concerned with the System V ABI"}, {"owner": {"reputation": 249985, "user_id": 147192, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/E78Vj.png?s=128&g=1", "display_name": "Matthieu M.", "link": "https://stackoverflow.com/users/147192/matthieu-m"}, "edited": false, "score": 1, "creation_date": 1485976277, "post_id": 41987610, "comment_id": 71153055, "body": "This seems a duplicate of <a href=\"http://stackoverflow.com/questions/40216160/variadic-arguements-and-x64\">this question</a> which is also concerned with System V ABI; is there any difference?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1485977397, "post_id": 41987610, "comment_id": 71153665, "body": "There is no single System V ABI!"}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1485977394, "post_id": 41987934, "comment_id": 71153663, "body": "Note also that variadic arguments are subject to type promotions that are not necessarily the same as would be performed in the presence of a non-variadic prototype."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1485977550, "post_id": 41987934, "comment_id": 71153755, "body": "@JohnBollinger: Which is likely the actual reason for requiring the declaration, noit the potentially different ABI. AAPCS for instance uses the same convention as for fixed-parameterlist functions."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1485979324, "post_id": 41987934, "comment_id": 71154702, "body": "@Olaf: But these promotions are identical to the ones that would be performed in context of calling a function with <i>non-prototype declaration</i> or (in case of C89/90) with no declaration in sight at all. Which immediately means that no, this is not the actual reason for requiring a <i>prototype</i>."}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": true, "score": 2, "last_activity_date": 1485976886, "creation_date": 1485976886, "answer_id": 41987934, "question_id": 41987610, "link": "https://stackoverflow.com/questions/41987610/in-c-does-a-caller-ever-treat-variadics-specially/41987934#41987934", "title": "In C, does a caller ever treat variadics specially?", "body": "<p>This is a non-ABI-specific answer.</p>\n\n<p>Yes, formally the caller can (and, in general case, will) treat functions with variadic arguments in a special way. This is actually the reason why from the beginning of standardized times C language required all variadic functions to be <em>declared with prototype</em> before the point of the call. Note that even though it was possible to safely call undeclared functions in C89/90, the permission to do so did not extend to variadic functions: those always had to be declared in advance. Otherwise, the behavior was undefined. </p>\n\n<p>In a slightly different form the rule still stands in modern C. Even though post-C99 C no longer allows calling undeclared functions, it still does not require <em>prototype</em> declarations. Yet, variadic functions have to be <em>declared with prototype</em> before the point of the call. The rationale is the same: the caller has to know that it is calling a variadic function and, possibly, handle the call differently.</p>\n\n<p>And historically, there were implementations that used completely differrent calling conventions when calling variadic functions.</p>\n"}], "owner": {"reputation": 2004, "user_id": 4916831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kIpeA.jpg?s=128&g=1", "display_name": "lcmylin", "link": "https://stackoverflow.com/users/4916831/lcmylin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 41987934, "answer_count": 1, "score": 0, "last_activity_date": 1485977369, "creation_date": 1485975800, "last_edit_date": 1485977369, "question_id": 41987610, "link": "https://stackoverflow.com/questions/41987610/in-c-does-a-caller-ever-treat-variadics-specially", "title": "In C, does a caller ever treat variadics specially?", "body": "<p>It has been my understanding that C variadic arguments are handled entirely on the callee's side, i.e. that if you called a function <code>f</code> with</p>\n\n<pre><code>f(1, 2, 3.0)\n</code></pre>\n\n<p>The compiler would generate the same code for the call, whether you had declared <code>f</code> as</p>\n\n<pre><code>void f(int, int, double);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>void f(int, int, ...);\n</code></pre>\n\n<p>The context for this question is <a href=\"https://github.com/servo/cocoa-rs/pull/74#issuecomment-75492331\" rel=\"nofollow noreferrer\">this issue</a> with calling a not-truly-variadic C function from Rust with a variadic FFI definition. If variadics do not matter from the caller's perspective (aside of course from type checking), then it seems odd to me that Rust would generate different code for a call where the function had been declared as variadic.</p>\n\n<p>If this is not in fact decided by the C specification, but rather ABI-dependant, I would be most interested in the answer for the <a href=\"https://software.intel.com/sites/default/files/article/402129/mpx-linux64-abi.pdf\" rel=\"nofollow noreferrer\">System V ABI</a>, which from what I read of it didn't seem to indicate any special handling of variadics on the caller's side.</p>\n"}, {"tags": ["c", "ch"], "comments": [{"owner": {"reputation": 40086, "user_id": 499581, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1ba2cebc4582467916f2ddd6128447f4?s=128&d=identicon&r=PG", "display_name": "l&#39;L&#39;l", "link": "https://stackoverflow.com/users/499581/lll"}, "edited": false, "score": 1, "creation_date": 1485975733, "post_id": 41987566, "comment_id": 71152767, "body": "Just use <code>c = 3</code>..."}, {"owner": {"reputation": 1104, "user_id": 6296060, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZ37JUkP1Pw/AAAAAAAAAAI/AAAAAAAAAYw/Fp6BfZuv7Ho/photo.jpg?sz=128", "display_name": "greedy52", "link": "https://stackoverflow.com/users/6296060/greedy52"}, "edited": false, "score": 0, "creation_date": 1485975790, "post_id": 41987566, "comment_id": 71152801, "body": "<a href=\"http://stackoverflow.com/questions/21275992/redeclaration-of-global-variable-vs-local-variable\" title=\"redeclaration of global variable vs local variable\">stackoverflow.com/questions/21275992/&hellip;</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1485977867, "post_id": 41987566, "comment_id": 71153938, "body": "If you want to learn C, use a C compiler. It is not clear if ch actually supports standard C or just some older version, possibly the long time outdated C90 only. And if you want to know if something is standard, get a good C book and have the standard under your pillow. C is not a language for trial&amp;error learning."}], "answers": [{"comments": [{"owner": {"reputation": 257, "user_id": 7246472, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e95856ff6ab93d5849e2b149f648e521?s=128&d=identicon&r=PG&f=1", "display_name": "srm", "link": "https://stackoverflow.com/users/7246472/srm"}, "edited": false, "score": 0, "creation_date": 1485975806, "post_id": 41987595, "comment_id": 71152808, "body": "So this means I cannot change the data type of a variable, once declared."}, {"owner": {"reputation": 1081, "user_id": 468603, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d863f374f48bdb8cc516e006dc5196f4?s=128&d=identicon&r=PG", "display_name": "Xofo", "link": "https://stackoverflow.com/users/468603/xofo"}, "edited": false, "score": 0, "creation_date": 1485975884, "post_id": 41987595, "comment_id": 71152842, "body": "You can if you use a language that allows that."}, {"owner": {"reputation": 1562, "user_id": 2789762, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/7d29562a2ce01fbd9bb3e30191aeb251?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2789762/kevin"}, "reply_to_user": {"reputation": 257, "user_id": 7246472, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e95856ff6ab93d5849e2b149f648e521?s=128&d=identicon&r=PG&f=1", "display_name": "srm", "link": "https://stackoverflow.com/users/7246472/srm"}, "edited": false, "score": 1, "creation_date": 1485976074, "post_id": 41987595, "comment_id": 71152945, "body": "@srm If you have a nested scope (you introduce a new scope with braces), you can shadow a variable - essentially, declare a new variable with the same name, and it can have a different type. But the shadowed variable will be inaccessible until you return to the outer scope."}, {"owner": {"reputation": 911, "user_id": 3528539, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/76bcc5c6b40213c8bbee447308334cf4?s=128&d=identicon&r=PG&f=1", "display_name": "Asalle", "link": "https://stackoverflow.com/users/3528539/asalle"}, "reply_to_user": {"reputation": 1562, "user_id": 2789762, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/7d29562a2ce01fbd9bb3e30191aeb251?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2789762/kevin"}, "edited": false, "score": 0, "creation_date": 1485976233, "post_id": 41987595, "comment_id": 71153032, "body": "as @Kevin explained, it&#39;s all about variable scopes in C. Google it or visit <a href=\"https://en.wikibooks.org/wiki/C%2B%2B_Programming/Scope/Examples\" rel=\"nofollow noreferrer\">this page</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 1562, "user_id": 2789762, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/7d29562a2ce01fbd9bb3e30191aeb251?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2789762/kevin"}, "edited": false, "score": 0, "creation_date": 1485977950, "post_id": 41987595, "comment_id": 71153981, "body": "@Kevin: Shadowing any name is bad practice and should never be done intentionally."}, {"owner": {"reputation": 1562, "user_id": 2789762, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/7d29562a2ce01fbd9bb3e30191aeb251?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2789762/kevin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1485978417, "post_id": 41987595, "comment_id": 71154193, "body": "@Olaf Definitely agreed, but shadowing is the closest thing to what the question was asking about. I&#39;m just saying it&#39;s possible, not that it&#39;s a good thing to do."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 1562, "user_id": 2789762, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/7d29562a2ce01fbd9bb3e30191aeb251?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2789762/kevin"}, "edited": false, "score": 0, "creation_date": 1486062634, "post_id": 41987595, "comment_id": 71196284, "body": "@Kevin: It is never wrong to be very explicit about bad practice. Remember this is read mistly by beginners (experience programmers should be aware of it already)."}], "tags": [], "owner": {"reputation": 911, "user_id": 3528539, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/76bcc5c6b40213c8bbee447308334cf4?s=128&d=identicon&r=PG&f=1", "display_name": "Asalle", "link": "https://stackoverflow.com/users/3528539/asalle"}, "is_accepted": false, "score": 1, "last_activity_date": 1485975752, "creation_date": 1485975752, "answer_id": 41987595, "question_id": 41987566, "link": "https://stackoverflow.com/questions/41987566/c-error-on-reclaring-variable/41987595#41987595", "title": "C - error on reclaring variable", "body": "<p>You need to write just <code>c = 3</code>, as far as I understand.</p>\n"}], "owner": {"reputation": 257, "user_id": 7246472, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e95856ff6ab93d5849e2b149f648e521?s=128&d=identicon&r=PG&f=1", "display_name": "srm", "link": "https://stackoverflow.com/users/7246472/srm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1485975752, "creation_date": 1485975653, "question_id": 41987566, "link": "https://stackoverflow.com/questions/41987566/c-error-on-reclaring-variable", "title": "C - error on reclaring variable", "body": "<p>I'm using the <a href=\"http://www.softintegration.com/products/chstandard/\" rel=\"nofollow noreferrer\">Ch C compiler/environment</a> to learn C. I note that when I want to redeclare variables with the same name I get an error:</p>\n\n<pre><code>/Users/srm&gt; int c = 1\n/Users/srm&gt; c++\n/Users/srm&gt; c\n/Users/srm&gt; 2\n/Users/srm&gt; int c = 3\nERROR: identifier 'c' redeclared\nERROR: invalid lvalue of assignment operation\n</code></pre>\n\n<p>Is this is a restriction imposed by Ch or a C language feature?</p>\n"}, {"tags": ["c", "halide", "openvx"], "comments": [{"owner": {"reputation": 2731, "user_id": 3815, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f183f65655329aa4fcf72552261eec7f?s=128&d=identicon&r=PG", "display_name": "jrk", "link": "https://stackoverflow.com/users/3815/jrk"}, "edited": false, "score": 0, "creation_date": 1486111618, "post_id": 41987532, "comment_id": 71214408, "body": "A hopefully-helpful note: this sparked a few replies on the halide-dev mailing list, which didn&#39;t make it back here. See the thread of the same title here: <a href=\"https://lists.csail.mit.edu/pipermail/halide-dev/2017-February/thread.html\" rel=\"nofollow noreferrer\">lists.csail.mit.edu/pipermail/halide-dev/2017-February/&hellip;</a>"}, {"owner": {"reputation": 3361, "user_id": 91208, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e643d47c57b984078c3b67560f7649b6?s=128&d=identicon&r=PG", "display_name": "Lolo", "link": "https://stackoverflow.com/users/91208/lolo"}, "reply_to_user": {"reputation": 2731, "user_id": 3815, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f183f65655329aa4fcf72552261eec7f?s=128&d=identicon&r=PG", "display_name": "jrk", "link": "https://stackoverflow.com/users/3815/jrk"}, "edited": false, "score": 0, "creation_date": 1488504442, "post_id": 41987532, "comment_id": 72272065, "body": "Thank you for mentioning this thread. The last comment still makes me think in the end that Halide and OpenVX (via the graph optimizer) offer the same functionality with the exception that OpenVX allows for nodes accelerated in hardware (as long as they comply to the node APIs) whereas Halide doesn&#39;t. Correct? If so, what prompted the creation of Halide though OpenVX already existed? Said differently: in what ways is Halide not a subset of the functionality provided by OpenVX?"}], "answers": [{"comments": [{"owner": {"reputation": 3361, "user_id": 91208, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e643d47c57b984078c3b67560f7649b6?s=128&d=identicon&r=PG", "display_name": "Lolo", "link": "https://stackoverflow.com/users/91208/lolo"}, "edited": false, "score": 0, "creation_date": 1486067663, "post_id": 41995436, "comment_id": 71199002, "body": "My understanding was that, when properly optimized for a given platform, the OpenVX graph scheduling does specifically address the task of mapping efficiently at runtime the processing blocks onto the appropriate components of the targeted heterogeneous architecture. Am I wrong?"}, {"owner": {"reputation": 1670, "user_id": 754534, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/567f7e1a18f931b5a6e3d88a20c27c67?s=128&d=identicon&r=PG&f=1", "display_name": "JPNotADragon", "link": "https://stackoverflow.com/users/754534/jpnotadragon"}, "edited": false, "score": 0, "creation_date": 1486070475, "post_id": 41995436, "comment_id": 71200482, "body": "I don&#39;t know Haliide (yet). To my understanding, OpenVX does exactly what you describe. The only thing I could add is that everyone seems to emphasize that it is primarily targeting embedded hardware (smartphones etc.)"}], "tags": [], "owner": {"reputation": 11, "user_id": 6451887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4815d50ca9c50188f042c987ecc3ff2d?s=128&d=identicon&r=PG&f=1", "display_name": "KSampat", "link": "https://stackoverflow.com/users/6451887/ksampat"}, "is_accepted": false, "score": 1, "last_activity_date": 1486016331, "creation_date": 1486016331, "answer_id": 41995436, "question_id": 41987532, "link": "https://stackoverflow.com/questions/41987532/halide-vs-openvx/41995436#41995436", "title": "Halide vs. OpenVX", "body": "<p>OpenVX focuses on graph-building and algorithm API standardization \u2013 which are useful, but it doesn\u2019t address the bigger problem (IMO) and time consuming task of mapping algorithms to heterogeneous architectures, which is addressed by Halide quite elegantly. <br>\nI had written down my thoughts some time ago that may be of interest: <a href=\"http://ks-dsp.blogspot.com/2016/09/halide-for-adas.html\" rel=\"nofollow noreferrer\">http://ks-dsp.blogspot.com/2016/09/halide-for-adas.html</a></p>\n"}], "owner": {"reputation": 3361, "user_id": 91208, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e643d47c57b984078c3b67560f7649b6?s=128&d=identicon&r=PG", "display_name": "Lolo", "link": "https://stackoverflow.com/users/91208/lolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 760, "favorite_count": 0, "closed_date": 1573148465, "answer_count": 1, "score": 2, "last_activity_date": 1486066761, "creation_date": 1485975516, "last_edit_date": 1486066761, "question_id": 41987532, "link": "https://stackoverflow.com/questions/41987532/halide-vs-openvx", "closed_reason": "Opinion-based", "title": "Halide vs. OpenVX", "body": "<p>Halide and OpenVX seem to have similar goals.</p>\n\n<p>Can someone comment on where they differ and where they both stand with respect to adoption in the community today?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 1, "creation_date": 1485975522, "post_id": 41987501, "comment_id": 71152651, "body": "You may first try to search some examples of <code>scanf</code> usage?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7468879"}, "edited": false, "score": 0, "creation_date": 1485975539, "post_id": 41987501, "comment_id": 71152664, "body": "Why are you calling <code>scanf</code> before <code>printf</code> ?"}, {"owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 2, "creation_date": 1485975574, "post_id": 41987501, "comment_id": 71152684, "body": "You are using scanf completely wrong, it does not do prompts."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1485975604, "post_id": 41987501, "comment_id": 71152701, "body": "Please remove all the prompts and tabs and newlines and spaces from the <code>scanf</code> format specifiers. For example <code>scanf(&quot;%d&quot;, &amp;s.rollno); </code>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7468879"}, "is_accepted": false, "score": 1, "last_activity_date": 1485976329, "last_edit_date": 1485976329, "creation_date": 1485975860, "answer_id": 41987627, "question_id": 41987501, "link": "https://stackoverflow.com/questions/41987501/why-cant-i-get-the-input-through-scanf-with-this-program/41987627#41987627", "title": "Why can&#39;t I get the input through scanf with this program?", "body": "<p>You are mistaking the function of <code>scanf</code> and <code>printf</code>. Although both calls appear similar, there are significant differences between the two functions.</p>\n\n<p><strong>printf writes output</strong></p>\n\n<p><strong>scanf reads input</strong></p>\n\n<p>In order to prompt a user to enter his name you use the <code>printf</code> function first.\nThen use <code>scanf</code> accordingly to read this input.</p>\n\n<p>In order to read a floating point, you can simply use;</p>\n\n<p><code>scanf(\"%f\" , &amp;marks)</code></p>\n\n<p>I would suggest reading through <a href=\"http://www.sitesbay.com/cprogramming/c-printf-and-scanf\" rel=\"nofollow noreferrer\">scanf and printf basics</a> to get you started.</p>\n"}, {"tags": [], "owner": {"reputation": 1484, "user_id": 6662739, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b3ead54cd5f2928c0e9a65a29c7ce3a4?s=128&d=identicon&r=PG&f=1", "display_name": "Ollaw", "link": "https://stackoverflow.com/users/6662739/ollaw"}, "is_accepted": false, "score": 0, "last_activity_date": 1485976026, "creation_date": 1485976026, "answer_id": 41987672, "question_id": 41987501, "link": "https://stackoverflow.com/questions/41987501/why-cant-i-get-the-input-through-scanf-with-this-program/41987672#41987672", "title": "Why can&#39;t I get the input through scanf with this program?", "body": "<p>You're using scanf in the wrong way.\nTo achieve the result you want, try instead : </p>\n\n<pre><code>int main(){\n    printf(\"Enter name: \\t\");\n    scanf(\"%s\", s.name);\n    printf(\"The name is \", s.name)\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8660, "user_id": 5749570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2d0247d580de0aae4511d84551f10?s=128&d=identicon&r=PG&f=1", "display_name": "VHS", "link": "https://stackoverflow.com/users/5749570/vhs"}, "is_accepted": false, "score": 0, "last_activity_date": 1485976174, "creation_date": 1485976174, "answer_id": 41987713, "question_id": 41987501, "link": "https://stackoverflow.com/questions/41987501/why-cant-i-get-the-input-through-scanf-with-this-program/41987713#41987713", "title": "Why can&#39;t I get the input through scanf with this program?", "body": "<p><code>scanf</code> is typically used to read user input from the standard input using the format specified in its argument. You do not specify the actual message prompt in the method argument; you specify the format of the input you expect from stdin. For message prompts, <code>printf</code> is a better choice. See the following revision in your <code>main</code> function.</p>\n\n<pre><code>void main()\n{     \n   printf(\"\\nenter roll no \\t\");\n   scanf(\"%d\",&amp;s.rollno);    \n   printf(\"\\nenter name\");    \n   scanf(\"%s\",s.name);    \n   printf(\"enter marks\");   \n   scanf(\"%f\",&amp;s.marks);   \n   printf(\"\\n s  actually  are %d \\t %s \\t %f\",s.rollno, s.name , s.marks); \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1575, "user_id": 5169186, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DvwLu.jpg?s=128&g=1", "display_name": "Oghli", "link": "https://stackoverflow.com/users/5169186/oghli"}, "is_accepted": false, "score": 0, "last_activity_date": 1485979032, "last_edit_date": 1485979032, "creation_date": 1485978675, "answer_id": 41988442, "question_id": 41987501, "link": "https://stackoverflow.com/questions/41987501/why-cant-i-get-the-input-through-scanf-with-this-program/41988442#41988442", "title": "Why can&#39;t I get the input through scanf with this program?", "body": "<p>your way in using <code>printf</code> and <code>scanf</code> is wrong </p>\n\n<p><strong>printf</strong> to prompt user input</p>\n\n<p><strong>scanf</strong> to read user input</p>\n\n<p>then you print results in the desired format using <strong>printf</strong></p>\n\n<pre><code>printf(\"enter roll number \");\nscanf(\"%d\",&amp;s.rollno);    \nprintf(\"enter name \");    \nscanf(\"%s\",s.name);    \nprintf(\"enter mark \");   \nscanf(\"%f\",&amp;s.marks);   \nprintf(\"\\n  roll number is: %d\\n\",s.rollno);\nprintf(\"  name is: %s\\n\",s.name);\nprintf(\"  mark is: %.2f\\n\", s.marks);\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4972170, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cafd081d0f9eb20ebc4066610df3ad23?s=128&d=identicon&r=PG&f=1", "display_name": "pratyush choudhary", "link": "https://stackoverflow.com/users/4972170/pratyush-choudhary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "answer_count": 4, "score": -3, "last_activity_date": 1491693095, "creation_date": 1485975380, "last_edit_date": 1491693095, "question_id": 41987501, "link": "https://stackoverflow.com/questions/41987501/why-cant-i-get-the-input-through-scanf-with-this-program", "title": "Why can&#39;t I get the input through scanf with this program?", "body": "<p>Why doesn't this program take any input?\nApparently, ir is skipping all the <code>scanf</code> lines.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nstruct student{  \n    int rollno;    \n    char name[10];    \n    float marks;    \n};\n\nstruct student s;\n\nvoid main()\n{   \n    scanf(\"\\n enter roll no \\t %d\",&amp;s.rollno);    \n    printf(\"enter name\");    \n    scanf(\"\\n name is  \\t %s\",s.name);    \n    printf(\"enter marks\");   \n    scanf(\"\\n  marks are \\t %f\",&amp;s.marks);   \n    printf(\"\\n s  actually  are %d \\t %s \\t %d\",s.rollno, s.name , s.marks);   \n    getch();\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "c-preprocessor", "boost-preprocessor"], "answers": [{"tags": [], "owner": {"reputation": 14872, "user_id": 3919155, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/3034f14bf0b65847592b2c2e08b9253e?s=128&d=identicon&r=PG&f=1", "display_name": "jotik", "link": "https://stackoverflow.com/users/3919155/jotik"}, "is_accepted": true, "score": 1, "last_activity_date": 1485975232, "last_edit_date": 1485975232, "creation_date": 1485974373, "answer_id": 41987223, "question_id": 41987222, "link": "https://stackoverflow.com/questions/41987222/how-to-zip-multiple-boost-preprocessor-sequences/41987223#41987223", "title": "How to zip multiple Boost Preprocessor sequences?", "body": "<p>You can define a <code>SEQ_ZIP</code> macro for this purpose as follows:</p>\n\n<pre><code>#include &lt;boost/preprocessor/control/expr_if.hpp&gt;\n#include &lt;boost/preprocessor/repetition/repeat.hpp&gt;\n#include &lt;boost/preprocessor/seq/elem.hpp&gt;\n#include &lt;boost/preprocessor/seq/for_each.hpp&gt;\n#include &lt;boost/preprocessor/seq/size.hpp&gt;\n\n#define SEQ_ZIP_NTH_(_,d,e) (BOOST_PP_SEQ_ELEM(d, e))\n#define SEQ_ZIP_NTHS_(_,i,ss) (BOOST_PP_SEQ_FOR_EACH(SEQ_ZIP_NTH_,i,ss))\n#define SEQ_ZIP_2(ne,ss) BOOST_PP_REPEAT(ne, SEQ_ZIP_NTHS_, ss)\n#define SEQ_ZIP_(ne,ss) BOOST_PP_EXPR_IF(ne, SEQ_ZIP_2(ne, ss))\n#define SEQ_ZIP(ss) SEQ_ZIP_(BOOST_PP_SEQ_SIZE(BOOST_PP_SEQ_ELEM(0,ss)), ss)\n</code></pre>\n\n<p>And use it to zip your sequences like this:</p>\n\n<pre><code>#define S1 (a)(b)(c)\n#define S2 (1)(2)(3)\n#define S3 (x1)(x2)(x3)\nSEQ_ZIP((S1)(S2)(S3))\n</code></pre>\n"}], "owner": {"reputation": 14872, "user_id": 3919155, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/3034f14bf0b65847592b2c2e08b9253e?s=128&d=identicon&r=PG&f=1", "display_name": "jotik", "link": "https://stackoverflow.com/users/3919155/jotik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 1, "accepted_answer_id": 41987223, "answer_count": 1, "score": 1, "last_activity_date": 1486414691, "creation_date": 1485974373, "last_edit_date": 1486414691, "question_id": 41987222, "link": "https://stackoverflow.com/questions/41987222/how-to-zip-multiple-boost-preprocessor-sequences", "title": "How to zip multiple Boost Preprocessor sequences?", "body": "<p>Given multiple Boost Preprocessor sequences:</p>\n\n<pre><code>#define S1 (a)(b)(c)\n#define S2 (1)(2)(3)\n#define S3 (x1)(x2)(x3)\n</code></pre>\n\n<p>How do I zip them using the preprocessor so the end result would be <code>((a)(1)(x1))((b)(2)(x2))((c)(3)(x3))</code>?</p>\n\n<h2>Notes</h2>\n\n<ul>\n<li>I came up with my own answer, but I'm open to accepting better solutions than provided by my answer below in reasonable time.</li>\n<li>Please refrain from removing the <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> tag since this Boost.Preprocessor works well with C++ as well as C, and my question targets both languages.</li>\n</ul>\n"}, {"tags": ["c", "binary"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 4, "creation_date": 1485972957, "post_id": 41986702, "comment_id": 71151263, "body": "[<i>citation needed</i>] :)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1485973133, "post_id": 41986702, "comment_id": 71151347, "body": "I don&#39;t see it in the <a href=\"http://port70.net/~nsz/c/c11/n1570.html\" rel=\"nofollow noreferrer\">c standard</a>"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1485973243, "post_id": 41986702, "comment_id": 71151412, "body": "Can you give some context as to where you&#39;ve seen this, i.e. a compileable piece of code?  You&#39;ll get a better answer that way."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1485973884, "post_id": 41986702, "comment_id": 71151761, "body": "It would be relevant if the <code>int</code> size is 8 bits. With my 32-bit <code>int</code> the library has <code>#define INT_MIN (-2147483647 - 1)</code> because <code>2147483648</code> is outside <code>int</code> range, so <code>-2147483648</code> does not work."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1485973968, "post_id": 41986702, "comment_id": 71151805, "body": "Related: <a href=\"http://stackoverflow.com/questions/34182672/why-is-0-0x80000000\">stackoverflow.com/questions/34182672/why-is-0-0x80000000</a>"}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1485974621, "post_id": 41986702, "comment_id": 71152168, "body": "@WeatherVane: however, the standard guarantees that <code>int</code> is at least 16 bit."}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1485973217, "post_id": 41986873, "comment_id": 71151394, "body": "Signed &quot;underflow&quot; is UB."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1485973252, "post_id": 41986873, "comment_id": 71151417, "body": "@EugeneSh. the calculation is in <code>unsigned int</code>."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1485973315, "post_id": 41986873, "comment_id": 71151443, "body": "There is no &quot;U&quot; integer type. A <code>U</code> suffix on an integer constant causes it to be of type <code>unsigned int</code> (or of some wider unsigned integer type if the value exceeds <code>UINT_MAX</code>). <code>1</code> is of type <code>int</code>; <code>1U</code> is of type <code>unsigned int</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1485973331, "post_id": 41986873, "comment_id": 71151455, "body": "@mch Yes, but then it won&#39;t &quot;underflow&quot;, but first the <code>-127</code> will be converted to <code>unsigned int</code> by adding <code>UINT_MAX+1</code> and then <code>1u</code> subtracted."}, {"owner": {"reputation": 85, "user_id": 6791841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-B9IWDMhe3bQ/AAAAAAAAAAI/AAAAAAAAAAo/gZSQkRXuVdI/photo.jpg?sz=128", "display_name": "Team. Coco", "link": "https://stackoverflow.com/users/6791841/team-coco"}, "edited": false, "score": 0, "creation_date": 1485973443, "post_id": 41986873, "comment_id": 71151521, "body": "So basically -128 would have caused an underflow, which can be overridden by using -127-1U?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 85, "user_id": 6791841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-B9IWDMhe3bQ/AAAAAAAAAAI/AAAAAAAAAAo/gZSQkRXuVdI/photo.jpg?sz=128", "display_name": "Team. Coco", "link": "https://stackoverflow.com/users/6791841/team-coco"}, "edited": false, "score": 0, "creation_date": 1485973606, "post_id": 41986873, "comment_id": 71151613, "body": "@Team.Coco It is pretty much the same as <code>(unsigned int)(-128)</code> (unless <code>-128</code> is outside of the range of <code>int</code>...)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1485973770, "post_id": 41986873, "comment_id": 71151699, "body": "@EugeneSh.: <code>-128</code> cannot be outside the range of <code>int</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1485973972, "post_id": 41986873, "comment_id": 71151809, "body": "@KeithThompson Can&#39;t it be of 8-bit size with sign-and-magnitude representation? Then it would be [-127, +127] range."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1485974280, "post_id": 41986873, "comment_id": 71151983, "body": "@EugeneSh.: No. The range of <code>int</code> must be at least <code>-32767</code> .. <code>+32767</code>. See <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">N1570</a> 5.2.4.2.1, <code>&lt;limits.h&gt;</code>. ((I think some compilers for very small embedded systems use 8-bit <code>int</code>, but they&#39;re non-conforming.)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1485974438, "post_id": 41986873, "comment_id": 71152061, "body": "@KeithThompson Hm Wasn&#39;t aware of the &quot;<i>Their implementation-defined values shall be equal or greater in magnitude (absolute value) to those shown, with the same sign.</i>&quot; statement. Thanks."}, {"owner": {"reputation": 1074, "user_id": 7381492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t3vPN.png?s=128&g=1", "display_name": "Mike Wodarczyk", "link": "https://stackoverflow.com/users/7381492/mike-wodarczyk"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1485974543, "post_id": 41986873, "comment_id": 71152126, "body": "@Keith Thompson:  Sure in 2011, I would expect that of any C complier or system.  I was writing C code back on 8 bit machines.  I would bet the rule didn&#39;t apply then.  I would also bet that there is plenty of C code left over from when a 2011 specification was not valid."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1485974906, "post_id": 41986873, "comment_id": 71152311, "body": "@MikeWodarczyk But your answer is incorrect even if everything is 8-bit. In that case the expression will result in <code>128</code>."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1485975257, "post_id": 41986873, "comment_id": 71152498, "body": "@MikeWodarczyk: That requirement has been in place at least since 1989. K&amp;R1, published in 1978, doesn&#39;t say that int is at least 16 bits, but the examples it shows are all at least that big. If you were using a compiler with 8-bit int after 1989, then it was non-conforming. (That&#39;s not necessarily a bad thing. A non-conforming compiler can be perfectly useful. Just think of it as a compiler for a non-C language that&#39;s very similar to C.)"}, {"owner": {"reputation": 1074, "user_id": 7381492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t3vPN.png?s=128&g=1", "display_name": "Mike Wodarczyk", "link": "https://stackoverflow.com/users/7381492/mike-wodarczyk"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1485975531, "post_id": 41986873, "comment_id": 71152657, "body": "@Eugene Sh:  You are right, it gives 128.  It doesn&#39;t change the basic idea that using a calculation will give a different result depending on the number of bits."}], "tags": [], "owner": {"reputation": 1074, "user_id": 7381492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t3vPN.png?s=128&g=1", "display_name": "Mike Wodarczyk", "link": "https://stackoverflow.com/users/7381492/mike-wodarczyk"}, "is_accepted": false, "score": -2, "last_activity_date": 1485975695, "last_edit_date": 1485975695, "creation_date": 1485973179, "answer_id": 41986873, "question_id": 41986702, "link": "https://stackoverflow.com/questions/41986702/in-c-programming-standards-what-is-meant-by-integer-127-1u/41986873#41986873", "title": "In C programming standards, what is meant by integer &quot;-127-1U&quot;?", "body": "<p>They may be trying to determine the size of bits used to hold the data on that particular machine or compiler.  Using an 8 bit sign calculation, the calculation will under flow giving 128 or not underflow giving -128.</p>\n"}, {"tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 3, "last_activity_date": 1485973726, "creation_date": 1485973726, "answer_id": 41987029, "question_id": 41986702, "link": "https://stackoverflow.com/questions/41986702/in-c-programming-standards-what-is-meant-by-integer-127-1u/41987029#41987029", "title": "In C programming standards, what is meant by integer &quot;-127-1U&quot;?", "body": "<p><code>-127-1U</code> is a constant expression.</p>\n\n<p><code>127</code> is an <em>integer constant</em>. It is of type <code>int</code> and has the obvious value.  The unary <code>-</code> operator is applied to it, yielding the value <code>-127</code>, also of type <code>int</code>.</p>\n\n<p><code>1U</code> is also an integer constant.  The <code>U</code> suffix causes it to be of type <code>unsigned int</code>.</p>\n\n<p>The second <code>-</code> is a subtraction operator, which takes two operands. Under the rules for resolving binary (two-operand) operators with different types, the <code>int</code> operand is implicitly converted to <code>unsigned int</code>. Converting <code>-127</code> from <code>int</code> to <code>unsigned int</code> (assuming a typical 32-bit 2's complement  representation for <code>int</code>) yields <code>4294967169</code> of type <code>unsigned int</code> (more generally it's <code>UINT_MAX - 126U</code>). Subtracting <code>1U</code> from that yields <code>4294967168</code>, again of type <code>unsigned int</code>.</p>\n\n<p>I have no idea what the purpose of this expression might be. I'd have to see more context to speculate. It would be clearer to write <code>UINT_MAX - 127U</code>.</p>\n"}], "owner": {"reputation": 85, "user_id": 6791841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-B9IWDMhe3bQ/AAAAAAAAAAI/AAAAAAAAAAo/gZSQkRXuVdI/photo.jpg?sz=128", "display_name": "Team. Coco", "link": "https://stackoverflow.com/users/6791841/team-coco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 41987029, "answer_count": 2, "score": -1, "last_activity_date": 1485975695, "creation_date": 1485972560, "question_id": 41986702, "link": "https://stackoverflow.com/questions/41986702/in-c-programming-standards-what-is-meant-by-integer-127-1u", "title": "In C programming standards, what is meant by integer &quot;-127-1U&quot;?", "body": "<p>For some reason I am led to believe that this actually refers to -128 as an integer but why not just write -128? </p>\n"}, {"tags": ["c", "optimization", "mathematical-optimization"], "comments": [{"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1485972204, "post_id": 41986561, "comment_id": 71150857, "body": "<i>Everything</i> is divisible by one without a remainder. Also, if you&#39;re using standard library <code>sqrt</code>, its parameter is always a floating point, so even if you pass in an integer, it will be converted accordingly."}, {"owner": {"reputation": 2640, "user_id": 5195699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f85291bb71f55981b1d412f1efcb7603?s=128&d=identicon&r=PG&f=1", "display_name": "R_Kapp", "link": "https://stackoverflow.com/users/5195699/r-kapp"}, "edited": false, "score": 3, "creation_date": 1485972240, "post_id": 41986561, "comment_id": 71150874, "body": "I assume by &quot;is divisible by <code>1</code> without remainder&quot; you mean &quot;will be an integer, whether it is passed in as an <code>int</code> or a <code>double</code>&quot;?"}, {"owner": {"reputation": 1104, "user_id": 6296060, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZ37JUkP1Pw/AAAAAAAAAAI/AAAAAAAAAYw/Fp6BfZuv7Ho/photo.jpg?sz=128", "display_name": "greedy52", "link": "https://stackoverflow.com/users/6296060/greedy52"}, "edited": false, "score": 0, "creation_date": 1485972301, "post_id": 41986561, "comment_id": 71150910, "body": "How slow is it? What&#39;s wrong with precomputed table? I would put an static std::map&lt;int, double&gt; cached_result in the function."}, {"owner": {"reputation": 164, "user_id": 7485966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784ceb99c59ffe5d4105cc6cc7cdb728?s=128&d=identicon&r=PG&f=1", "display_name": "ttdado", "link": "https://stackoverflow.com/users/7485966/ttdado"}, "edited": false, "score": 0, "creation_date": 1485972550, "post_id": 41986561, "comment_id": 71151053, "body": "Currently I am passing double into it, because I know converting <code>int &lt;-&gt; double</code> takes time. But I just wanted to say, the optimized version parameter may be <code>double</code> or <code>int</code>, whatever will perform better,"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1485972729, "post_id": 41986561, "comment_id": 71151148, "body": "If the square roots are to be the nearest positive integer values, their difference is always either 0 or 1."}, {"owner": {"reputation": 164, "user_id": 7485966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784ceb99c59ffe5d4105cc6cc7cdb728?s=128&d=identicon&r=PG&f=1", "display_name": "ttdado", "link": "https://stackoverflow.com/users/7485966/ttdado"}, "edited": false, "score": 1, "creation_date": 1485972883, "post_id": 41986561, "comment_id": 71151231, "body": "Yes, input will be like <code>1, 2, 3 ...</code> or <code>1.0, 2.0, 3.0, ...</code>, just like integers. Probably may help you I am using it in classic loop <code>for(double i = 0; i &lt; x; i++) { ... }</code>. However precomputed tables are not possible because of unlimited range."}, {"owner": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "edited": false, "score": 10, "creation_date": 1485973021, "post_id": 41986561, "comment_id": 71151292, "body": "If you have a loop incrementing one by one, you could just save last <code>sqrt(n)</code> in a variable and use it again, couldn\u2019t you ?"}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 3, "creation_date": 1485973110, "post_id": 41986561, "comment_id": 71151338, "body": "If you are using gcc, try the <code>-fno-math-errno</code> flag and check if performance improves substantially."}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 2, "creation_date": 1485973243, "post_id": 41986561, "comment_id": 71151411, "body": "@ttdado Remember, you can always <a href=\"https://stackoverflow.com/posts/41986561/edit\">edit</a> your post to make it clearer. This will ultimately benefit <i>you</i> by helping people make better answers."}, {"owner": {"reputation": 164, "user_id": 7485966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784ceb99c59ffe5d4105cc6cc7cdb728?s=128&d=identicon&r=PG&f=1", "display_name": "ttdado", "link": "https://stackoverflow.com/users/7485966/ttdado"}, "edited": false, "score": 0, "creation_date": 1485973663, "post_id": 41986561, "comment_id": 71151643, "body": "Ulysse BN thanks, I really didn&#39;t think about that. such primitive thing... I was using it all the time as function and never got such idea. Many thanks, this will work perfectly."}, {"owner": {"reputation": 6460, "user_id": 6320039, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/U4QjP.jpg?s=128&g=1", "display_name": "Ulysse BN", "link": "https://stackoverflow.com/users/6320039/ulysse-bn"}, "reply_to_user": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1485973951, "post_id": 41986561, "comment_id": 71151792, "body": "Glad to help! As said @anatolyg, think about editing your question with what you told us in comments for latter users."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1485974033, "post_id": 41986561, "comment_id": 71151847, "body": "Many platforms have1 cycle square root and inverse square root estimate functions that are good for 4 or 5 digit places.  It might be worth looking for intrinsics just in case."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 3, "creation_date": 1485974119, "post_id": 41986561, "comment_id": 71151888, "body": "Also if in a loop, you should be able to get some benefit from SIMD stuff."}, {"owner": {"reputation": 164, "user_id": 7485966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784ceb99c59ffe5d4105cc6cc7cdb728?s=128&d=identicon&r=PG&f=1", "display_name": "ttdado", "link": "https://stackoverflow.com/users/7485966/ttdado"}, "edited": false, "score": 0, "creation_date": 1485975195, "post_id": 41986561, "comment_id": 71152458, "body": "Michael Dorgan thanks for response. It&#39;s code for ARM Aarch64 (cpu cortex a53), and when the version will be fine, I would like to rewrite it in assembly. I got limited knowledge, and I am not sure how to get benefits you speak about from that platform."}, {"owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485975587, "post_id": 41986561, "comment_id": 71152695, "body": "I&#39;m not familiar with the ARM architecture. Does this processor have hardware floating point or is an emulator library used?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1486154284, "post_id": 41986561, "comment_id": 71239753, "body": "The <a href=\"https://en.wikipedia.org/wiki/Fast_inverse_square_root\" rel=\"nofollow noreferrer\"><b>Fast Inverse Square Root</b></a> can often be used to provide amazingly fast and accurate approximations in these cases. (after all, it is how Quake was able to run blistering fast on ancient hardware...)"}, {"owner": {"reputation": 164, "user_id": 7485966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784ceb99c59ffe5d4105cc6cc7cdb728?s=128&d=identicon&r=PG&f=1", "display_name": "ttdado", "link": "https://stackoverflow.com/users/7485966/ttdado"}, "edited": false, "score": 0, "creation_date": 1486154342, "post_id": 41986561, "comment_id": 71239782, "body": "Thanks for copying that link from my answer :-)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1486154413, "post_id": 41986561, "comment_id": 71239817, "body": "Why the hell would you think I copied the link from your answer? It actually came from my <b><i>Basket Notepad</i></b>..."}, {"owner": {"reputation": 164, "user_id": 7485966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784ceb99c59ffe5d4105cc6cc7cdb728?s=128&d=identicon&r=PG&f=1", "display_name": "ttdado", "link": "https://stackoverflow.com/users/7485966/ttdado"}, "edited": false, "score": 0, "creation_date": 1486154507, "post_id": 41986561, "comment_id": 71239867, "body": "Heh. But do you think it&#39;s still worth using it on modern cpus? Because it doesn&#39;t looks fast for me when I compare that many instructions to signle fsqrt instruction."}], "answers": [{"comments": [{"owner": {"reputation": 457342, "user_id": 87234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FkjBe.png?s=128&g=1", "display_name": "GManNickG", "link": "https://stackoverflow.com/users/87234/gmannickg"}, "edited": false, "score": 6, "creation_date": 1485972658, "post_id": 41986667, "comment_id": 71151109, "body": "If we&#39;re just going to approximate <code>sqrt(n - 1) == sqrt(n)</code> for large n, we should just simplify the original function to <code>return 0;</code>. ;)"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 457342, "user_id": 87234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FkjBe.png?s=128&g=1", "display_name": "GManNickG", "link": "https://stackoverflow.com/users/87234/gmannickg"}, "edited": false, "score": 2, "creation_date": 1485972712, "post_id": 41986667, "comment_id": 71151141, "body": "@GManNickG - Yeah, well :) I realized the note about the numerical stability was warranted after that suggestion, if nothing else."}, {"owner": {"reputation": 164, "user_id": 7485966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784ceb99c59ffe5d4105cc6cc7cdb728?s=128&d=identicon&r=PG&f=1", "display_name": "ttdado", "link": "https://stackoverflow.com/users/7485966/ttdado"}, "edited": false, "score": 0, "creation_date": 1485973096, "post_id": 41986667, "comment_id": 71151331, "body": "Well I found out approximation myself something like <code>0.5&#47;sqrt(n)</code> or <code>0.5&#47;sqrt(n-1)</code>, but is not good for small numbers. As numbers are bigger, precision is better. But problem is even the range is not limited, this function is mainly called with small numbers in range 1-10."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 164, "user_id": 7485966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784ceb99c59ffe5d4105cc6cc7cdb728?s=128&d=identicon&r=PG&f=1", "display_name": "ttdado", "link": "https://stackoverflow.com/users/7485966/ttdado"}, "edited": false, "score": 1, "creation_date": 1485973217, "post_id": 41986667, "comment_id": 71151395, "body": "@ttdado - Well, than the suggestion by <b>Ulysse BN</b> should work well for you. You don&#39;t need a precomputed table, just cache the last values(s) you computed."}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 4, "creation_date": 1485973694, "post_id": 41986667, "comment_id": 71151663, "body": "For large <code>n</code>, a much better approximation is <code>0.5 &#47; sqrt(n - 0.5)</code>. (This should also be faster because it removes a multiplication operation.)"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 0, "creation_date": 1485973853, "post_id": 41986667, "comment_id": 71151746, "body": "@squeamishossifrage - true, and the single operand to <code>sqrt</code> is as close to both original operands instead of just to one."}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1485972747, "last_edit_date": 1485972747, "creation_date": 1485972417, "answer_id": 41986667, "question_id": 41986561, "link": "https://stackoverflow.com/questions/41986561/optimizing-sqrtn-sqrtn-1/41986667#41986667", "title": "Optimizing sqrt(n) - sqrt(n-1)", "body": "<p>You can try to replace it with the following approximation</p>\n\n<pre><code>sqrt(n) - sqrt(n-1) == \n(sqrt(n) - sqrt(n-1)) * (sqrt(n) + sqrt(n-1)) / (sqrt(n) + sqrt(n-1)) ==\n(n - (n + 1)) / (sqrt(n) + sqrt(n-1)) ==\n1 / (sqrt(n) + sqrt(n-1))\n</code></pre>\n\n<p>For large enough <code>n</code>, the last equation is pretty close to <code>1 / (2 * sqrt(n))</code>. So you only have to call <code>sqrt</code> once. It's also worth noting that even without the approximation, the last expression is more numerically stable in terms of relative error for larger <code>n</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 164, "user_id": 7485966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784ceb99c59ffe5d4105cc6cc7cdb728?s=128&d=identicon&r=PG&f=1", "display_name": "ttdado", "link": "https://stackoverflow.com/users/7485966/ttdado"}, "edited": false, "score": 0, "creation_date": 1486049497, "post_id": 41992557, "comment_id": 71188267, "body": "You should remove <code>&amp;&amp; n == floor(n)</code> as this is always true in this case."}], "tags": [], "owner": {"reputation": 462, "user_id": 4758744, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10205142985987724/picture?type=large", "display_name": "Mateo Hrastnik", "link": "https://stackoverflow.com/users/4758744/mateo-hrastnik"}, "is_accepted": false, "score": 2, "last_activity_date": 1485996761, "creation_date": 1485996761, "answer_id": 41992557, "question_id": 41986561, "link": "https://stackoverflow.com/questions/41986561/optimizing-sqrtn-sqrtn-1/41992557#41992557", "title": "Optimizing sqrt(n) - sqrt(n-1)", "body": "<p>You stated that <code>n</code> is mainly a number smaller than 10. You could possibly use a precomputed table for numbers smaller than 10, or even more since it's cheap, and fallback to real calculations in case of larger numbers.</p>\n\n<p>The code would look something like:</p>\n\n<pre><code>static inline double calculate_scale(double n) { //n may be int or double\n    if (n &lt;= 10.0 &amp;&amp; n == floor(n)) {\n        return precomputed[(int) n]\n    }\n    return sqrt(n) - sqrt(n-1);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 164, "user_id": 7485966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784ceb99c59ffe5d4105cc6cc7cdb728?s=128&d=identicon&r=PG&f=1", "display_name": "ttdado", "link": "https://stackoverflow.com/users/7485966/ttdado"}, "is_accepted": false, "score": 3, "last_activity_date": 1486197936, "last_edit_date": 1495539971, "creation_date": 1486153150, "answer_id": 42032393, "question_id": 41986561, "link": "https://stackoverflow.com/questions/41986561/optimizing-sqrtn-sqrtn-1/42032393#42032393", "title": "Optimizing sqrt(n) - sqrt(n-1)", "body": "<p>First of all, thanks for all suggestions. I've done some research and found some interesting implementations and facts.</p>\n\n<h2>1. In Loop or Using Precomputed table</h2>\n\n<p>(thanks @Ulysse BN)\nYou can optimize loop by simply saving previous <code>sqrt(n)</code> value. \nFollowing example demonstrates this optimization used to setup precomputed table.</p>\n\n<pre><code>    /**\n     * Init variables\n     *      i       counter\n     *      x       number of cycles (size of table)\n     *      sqrtI1  previous square root = sqrt(i-1)\n     *      ptr     Pointer for next value\n     */\n    double i, x = sizeof(precomputed_table) / sizeof(double);\n    double sqrtI1 = 0;\n\n    double* ptr = (double*) precomputed_table;\n\n    /**\n     * Optimized calculation\n     * In short:\n     *      scale = sqrt(i) - sqrt(i-1)\n     */\n    for(i = 1; i &lt;= x; i++) {\n        double sqrtI = sqrt(i);\n        double scale = sqrtI - sqrtI1; \n        *ptr++ = scale;\n        sqrtI1 = sqrtI;\n    }\n</code></pre>\n\n<p>Using precomputed table is\nprobably the fastest method, but it's drawback may be that it's size is limited.</p>\n\n<pre><code>static inline double calculate_scale(int n) {\n    return precomputed_table[n-1];\n}\n</code></pre>\n\n<p><br/></p>\n\n<h2>2. Approximation For BIG numbers using Inverse Square Root</h2>\n\n<p>Required Inverse (reciprocal) Square Root function <code>rsqrt</code></p>\n\n<p>This method has most accurate results with big numbers. With small numbers there are errors:</p>\n\n<pre><code>1    2     3      10       100     1000\n0.29 0.006 0.0016 0.000056 1.58e-7 4.95e-10\n</code></pre>\n\n<p>Here is JS code that I used to calculate results above:</p>\n\n<pre><code>function sqrt(x) { return Math.sqrt(x); } function d(x) { return (sqrt(x)-sqrt(x-1))-(0.5/sqrt(x-0.5));} console.log(d(1), d(2), d(3), d(10), d(100), d(1000));\n</code></pre>\n\n<p>You can also see accuracy compared with two-sqrt version in single graph: <a href=\"https://www.google.com/search?q=(sqrt(x)-sqrt(x-1))-(0.5%2Fsqrt(x-0.5))\" rel=\"nofollow noreferrer\">https://www.google.com/search?q=(sqrt(x)-sqrt(x-1))-(0.5%2Fsqrt(x-0.5))</a></p>\n\n<p>Usage:</p>\n\n<pre><code>static inline double calculate_scale(double n) {\n    //Same as: 0.5 / sqrt(n-0.5)\n    //but lot faster\n    return 0.5 * rsqrt(n-0.5);\n}\n</code></pre>\n\n<p>On some older cpus (with slow or no hardware square root) you may go even faster using <code>float</code>s and <em>Fast inverse square root</em> from Quake:</p>\n\n<pre><code>static inline float calculate_scale(float n) {\n    return 0.5 * Q_rsqrt(n-0.5);\n}\n\nfloat Q_rsqrt( float number )\n{\n    long i;\n    float x2, y;\n    const float threehalfs = 1.5F;\n\n    x2 = number * 0.5F;\n    y  = number;\n    i  = * ( long * ) &amp;y;                       // evil floating point bit level hacking\n    i  = 0x5f3759df - ( i &gt;&gt; 1 );               // what the fuck? \n    y  = * ( float * ) &amp;i;\n    y  = y * ( threehalfs - ( x2 * y * y ) );   // 1st iteration\n//  y  = y * ( threehalfs - ( x2 * y * y ) );   // 2nd iteration, this can be removed\n\n    return y;\n}\n</code></pre>\n\n<p><em>For more info about implementation, see <a href=\"https://en.wikipedia.org/wiki/Fast_inverse_square_root\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Fast_inverse_square_root</a> and <a href=\"http://www.lomont.org/Math/Papers/2003/InvSqrt.pdf\" rel=\"nofollow noreferrer\">http://www.lomont.org/Math/Papers/2003/InvSqrt.pdf</a> . Not recommended to use on <a href=\"https://stackoverflow.com/a/6666843/7485966\">modern cpus with hardware reciprocal square root</a>.</em></p>\n\n<p><strong>Not always solution: 0.5 / sqrt(n-0.5)</strong></p>\n\n<p>Please note that on some processors (eg. <a href=\"http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.ddi0408f/ch02s03s01.html\" rel=\"nofollow noreferrer\">ARM Cortex A9</a>, <a href=\"https://stackoverflow.com/a/7726267/7485966\">Intel Core2</a>) \ndivision takes <em>nearly</em> same time as <em>hardware</em> square root, \nso it's best to use original function with 2 square roots <code>sqrt(n) - sqrt(n-1)</code> OR\nreciprocal square root with multiply instead <code>0.5 * rsqrt(n-0.5)</code> if exist.</p>\n\n<p><br/></p>\n\n<h2>3. Using Precomputed table with fallback</h2>\n\n<p>This method is good compromise between first 2 solutions.\nIt has both good accuracy and performance.</p>\n\n<pre><code>static inline double calculate_scale(double n) {\n    if(n &lt;= sizeof_precomputed_table) {\n        int nIndex = (int) n;\n        return precomputed_table[nIndex-1];\n    }\n    //Multiply + Inverse Square root\n    return 0.5 * rsqrt(n-0.5);\n    //OR\n    return sqrt(n) - sqrt(n-1);\n}\n</code></pre>\n\n<p>In my case I need really accurate numbers, so my precomputed table size is 2048.</p>\n\n<p>Any feedback is welcomed.</p>\n"}], "owner": {"reputation": 164, "user_id": 7485966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784ceb99c59ffe5d4105cc6cc7cdb728?s=128&d=identicon&r=PG&f=1", "display_name": "ttdado", "link": "https://stackoverflow.com/users/7485966/ttdado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 608, "favorite_count": 0, "accepted_answer_id": 41986667, "answer_count": 3, "score": 7, "last_activity_date": 1514731053, "creation_date": 1485972015, "last_edit_date": 1486154270, "question_id": 41986561, "link": "https://stackoverflow.com/questions/41986561/optimizing-sqrtn-sqrtn-1", "title": "Optimizing sqrt(n) - sqrt(n-1)", "body": "<p>Here is function that I call many times per second:</p>\n\n<pre><code>static inline double calculate_scale(double n) { //n may be int or double\n    return sqrt(n) - sqrt(n-1);\n}\n</code></pre>\n\n<p>Called in loop like:</p>\n\n<pre><code>for(double i = 0; i &lt; x; i++) {\n    double scale = calculate_scale(i);\n    ...\n}\n</code></pre>\n\n<p>And it's so slow. What is the best way to optimize this function to get as accurate output as possible?</p>\n\n<p>Parameter <code>n</code>: Starting from 1 up, practically not limited, but mainly used with small numbers in range 1-10. It's integer (whole number), but it may be both <code>int</code> or <code>double</code>, depending on what performs better.</p>\n"}, {"tags": ["c", "performance", "time-measurement"], "comments": [{"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1485984308, "post_id": 41986260, "comment_id": 71157360, "body": "in <code>sumN</code>, <code>sum</code> is unitialized, so the function will return random values. Add <code>sum = 0;</code> before the loop."}], "answers": [{"comments": [{"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1485984937, "post_id": 41989478, "comment_id": 71157667, "body": "Good catch. Also, there could be rollover: start=1.999999 and end=2.000003, so <code>tv_sec</code> should be factored in. And, on modern x86 CPUs, <code>sumN</code> could execute so fast that low values of <code>i</code> in <code>main</code> might show up as zero because <code>sumN</code> executes in under 1us--the granularity of <code>gettimeofday</code> (i.e. <code>clock_gettime</code> might be a better choice as it [typically] has 1ns resolution)"}], "tags": [], "owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "is_accepted": false, "score": 1, "last_activity_date": 1485984008, "last_edit_date": 1485984008, "creation_date": 1485982142, "answer_id": 41989478, "question_id": 41986260, "link": "https://stackoverflow.com/questions/41986260/time-measurement-of-c-program-is-0/41989478#41989478", "title": "Time measurement of C program is 0", "body": "<p>The call of the function <code>sumN(i)</code>is optimized out (I guess you are not compiling with -O0), because the value returned is not used at all. You can see it in the resulting assembly:</p>\n\n<pre><code>...\ncall    gettimeofday\nxorl    %esi, %esi\nmovq    %rsp, %rdi\ncall    gettimeofday\n...\n</code></pre>\n\n<p>as you can see there is no call of <code>sum(N)</code>in between of the <code>gettimeofday</code>.</p>\n\n<p>Use the returned value and it will not be optimized out:</p>\n\n<pre><code>...\ngettimeofday(&amp;start, NULL);\nres=sumN(i);\ngettimeofday(&amp;stop, NULL);\nprintf(\"%d : %d, %lu\\n\",i, res, stop.tv_usec - start.tv_usec);//print the result, avoiding optimization!\n...\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 5947269, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rw83Q.jpg?s=128&g=1", "display_name": "this.shivi", "link": "https://stackoverflow.com/users/5947269/this-shivi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485984008, "creation_date": 1485971076, "last_edit_date": 1485983935, "question_id": 41986260, "link": "https://stackoverflow.com/questions/41986260/time-measurement-of-c-program-is-0", "title": "Time measurement of C program is 0", "body": "<p>The following code was run in codeblocks, gcc compiler.</p>\n\n<pre><code>#include &lt;sys/time.h&gt;\n#include&lt;stdio.h&gt;\nint sumN(int n) {\nint i,sum;\nfor(i=0; i&lt;n; i++) {\n    sum += i;\n}\nreturn sum;\n}\n\nint main() {\nstruct timeval stop, start;\nint i;\n\nfor(i=0; i&lt;10000;i+=100)\n    {\n        gettimeofday(&amp;start, NULL);\n        sumN(i);\n        gettimeofday(&amp;stop, NULL);\n        printf(\"%d : %lu\\n\",i, stop.tv_usec - start.tv_usec);\n    }\nreturn 0;\n}\n</code></pre>\n\n<p>and I get the following output. Is there an issue with the gettimeofday function? Or the output is right? I need to also plot a graph based on multiple input size for function and the time taken for the function execution.\n<a href=\"https://i.stack.imgur.com/deWnV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/deWnV.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1485971241, "post_id": 41986202, "comment_id": 71150280, "body": "<code>row</code> and <code>column</code> are <i>uninitialised variables</i>. Please note too that arrays in C are usually indexed from <code>0</code>. On those occasions (rarely) when it is convenient to index an array from <code>1</code> the array must 1 element larger so the upper bound is not broken."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1485971386, "post_id": 41986202, "comment_id": 71150367, "body": "Your <code>PopulateRandom</code> function will return a value <i>out of bounds</i> of the array. An array it doesn&#39;t really use by the way. The function could just as well contain the only statement <code>return rand() % (M * N) - 1;</code>"}, {"owner": {"reputation": 75, "user_id": 7021861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/be3f3faf9416a24e79a4175663f5e3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Shoaib Ahmed", "link": "https://stackoverflow.com/users/7021861/shoaib-ahmed"}, "edited": false, "score": 0, "creation_date": 1485971464, "post_id": 41986202, "comment_id": 71150409, "body": "I initialized &#39;row&#39; and &#39;column&#39; in the for loops."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1485971496, "post_id": 41986202, "comment_id": 71150429, "body": "That was <i>after</i> <code>while(row &lt;= M &amp;&amp; column &lt;= N)</code>. Please take note of compiler warnings."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1485971659, "post_id": 41986202, "comment_id": 71150544, "body": "The <code>PrintArray2D</code> function doesn&#39;t need an array either, all you use in that function is <code>array[0]</code>."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1485972057, "post_id": 41986202, "comment_id": 71150781, "body": "Once you get past your initialization and array bounds issues, you should also seed the <code>rand</code> function: <a href=\"http://stackoverflow.com/questions/3693511/rand-seeding-with-time-problem\" title=\"rand seeding with time problem\">stackoverflow.com/questions/3693511/&hellip;</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1485973993, "post_id": 41986202, "comment_id": 71151822, "body": "Any reason you don&#39;t use a 2D array? And don&#39;t pass the array to the functions?"}], "answers": [{"tags": [], "owner": {"reputation": 669, "user_id": 7316335, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/48a778c2ad2bf45e9c5d8047630ce127?s=128&d=identicon&r=PG&f=1", "display_name": "Loveen Dyall", "link": "https://stackoverflow.com/users/7316335/loveen-dyall"}, "is_accepted": false, "score": 0, "last_activity_date": 1485971414, "creation_date": 1485971414, "answer_id": 41986365, "question_id": 41986202, "link": "https://stackoverflow.com/questions/41986202/assigning-random-values-to-elements-of-an-array-in-c/41986365#41986365", "title": "Assigning Random Values to Elements of an Array in C", "body": "<p>You're returning a value held at an index outside of your array here</p>\n\n<pre><code>   int PopulateRandom(int M, int N){\n       int i, array[M * N];\n\n       for(i = 0; i &lt; M*N; i++){\n           array[i] = rand() % (M*N) - 1;\n       }\n       return array[i];\n   }\n</code></pre>\n\n<p>i will be equal to M * N when the loop ends, array[i] will be outside of array since the size of array is M*N.</p>\n"}], "owner": {"reputation": 75, "user_id": 7021861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/be3f3faf9416a24e79a4175663f5e3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Shoaib Ahmed", "link": "https://stackoverflow.com/users/7021861/shoaib-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1485971414, "creation_date": 1485970928, "question_id": 41986202, "link": "https://stackoverflow.com/questions/41986202/assigning-random-values-to-elements-of-an-array-in-c", "title": "Assigning Random Values to Elements of an Array in C", "body": "<p>I wrote a program that asks the user to enter two numbers M and N. There will be an array that has M*N elements that need to be assigned random values. These values are then displayed  in a M x N table. The problem is that when I run the program, The assigned value for the first element is always either 0 or some weird number like -2147197728 and the rest of the elements are always 0. Can anybody help me out?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint PopulateRandom(int M, int N);\nint PrintArray2D(int M, int N);\n\n// Prints elements of array in a M x N table\nint PrintArray2D(int M, int N){\nint array[M*N], row, column, i = 0;\n\nwhile(row &lt;= M &amp;&amp; column &lt;= N){\n    for(row = 1; row &lt;= M; row++){\n        for(column = 1; column &lt;= N; column++){\n            array[i] = PopulateRandom(M, N);\n            printf(\"%d  \", array[i]);\n            if(column == 4){\n                break;\n            }\n        }\n        column = 0;\n        printf(\"\\n\");\n    }\n}\nreturn array[i];\n}\n\n//Assigns elements of the array \"array\" random values\nint PopulateRandom(int M, int N){\nint i, array[M * N];\n\nfor(i = 0; i &lt; M*N; i++){\n    array[i] = rand() % (M*N) - 1;\n}\nreturn array[i];\n}\n\nint main(void){\nint option, M, N;\n\nprintf(\"If you would like to search ann array, enter 1 \\n: \");\nprintf(\"If you would like to exit, enter 0 \\n: \");\nscanf(\"%d\", &amp;option);\n\nwhile(option != 0){\n    switch(option){\n        case 1: if(option == 1){\n                printf(\"Enter two numbers M and N: \");                          \n                scanf(\"%d %d\", &amp;M, &amp;N);\n                PrintArray2D(M, N);\n        }\n        case 0: if(option == 0){\n            break;\n        }\n    }\n    printf(\"If you would like to search ann array, enter 1 \\n: \");\n    printf(\"If you would like to exit, enter 0 \\n: \");\n    scanf(\"%d\", &amp;option);\n}\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "algorithm"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1485971293, "post_id": 41986135, "comment_id": 71150312, "body": "Notice there are 8 or more characters after the number: line-feed/space, c,a,c,b,b,b,a,line-feed.  Use <code>printf(&quot;%d&quot;, ar[i]);</code> to see."}, {"owner": {"reputation": 1104, "user_id": 6296060, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZ37JUkP1Pw/AAAAAAAAAAI/AAAAAAAAAYw/Fp6BfZuv7Ho/photo.jpg?sz=128", "display_name": "greedy52", "link": "https://stackoverflow.com/users/6296060/greedy52"}, "edited": false, "score": 1, "creation_date": 1485971639, "post_id": 41986135, "comment_id": 71150525, "body": "Not related to the algorithm, C strings better ends with &#39;\\0&#39; at the end."}], "answers": [{"tags": [], "owner": {"reputation": 8660, "user_id": 5749570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2d0247d580de0aae4511d84551f10?s=128&d=identicon&r=PG&f=1", "display_name": "VHS", "link": "https://stackoverflow.com/users/5749570/vhs"}, "is_accepted": true, "score": 1, "last_activity_date": 1485973492, "last_edit_date": 1485973492, "creation_date": 1485971586, "answer_id": 41986433, "question_id": 41986135, "link": "https://stackoverflow.com/questions/41986135/char-array-rotation-error-in-c-cant-see-reason-why/41986433#41986433", "title": "Char array rotation error in C - can&#39;t see reason why", "body": "<p>You need to consume the 'space' character that you enter after the number. You enter the space to mark the end of the firs input (number). However that space or new line character remains in the input buffer and gets consumed by the next scanf. So when you enter 'cacbbba', the actual input received by your code is \" cacbbb\". The quickest, although not an ideal, thing you can do is consume that extra character before the start of the second input. </p>\n\n<p>Put <code>getchar();</code> just before the start of your first <code>for</code> loop.</p>\n\n<p>Here's the sample working program:</p>\n\n<pre><code>int main() {\n\nint n;\nscanf(\"%d\", &amp;n);\nchar ar[n];\nchar temp[n];\n\nfor (int i=0; i&lt;n; i++) {\n    scanf(\"%c\", &amp;ar[i]);\n}\nint i;\ntemp[0] = ar[0];\ngetchar(); //Consume the extra space or newline char.\nfor (int i=0; i&lt;(n-1); i++) {\n    ar[0+i] = ar[1+i];\n}\nar[n-1] = temp[0];\n\nfor(int i=0; i&lt;n; i++){\n    printf(\"%c\", ar[i]);\n}\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 442, "user_id": 6659523, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/91f8410855afa882ec476850fa133e12?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit Prakash", "link": "https://stackoverflow.com/users/6659523/mohit-prakash"}, "is_accepted": false, "score": -1, "last_activity_date": 1485972225, "creation_date": 1485972225, "answer_id": 41986612, "question_id": 41986135, "link": "https://stackoverflow.com/questions/41986135/char-array-rotation-error-in-c-cant-see-reason-why/41986612#41986612", "title": "Char array rotation error in C - can&#39;t see reason why", "body": "<pre><code>  int main() {\n\nint n;\nscanf(\"%d\", &amp;n);\nchar ar[n];\nchar temp;\n\nfor (int i=0; i&lt;n; i++) {\n    scanf(\"%c\", &amp;ar[i]);\n}\nint i;\ntemp = ar[0];\nfor (int i=0; i&lt;(n-1); i++) {\n    ar[i] = ar[1+i];\n}\nar[n-1] = temp;\n\nfor(int i=0; i&lt;n; i++){\n    printf(\"%c\", ar[i]);\n}\n\nreturn 0;\n}\n</code></pre>\n\n<p>You can  use this code. no need to create temp array.</p>\n"}, {"tags": [], "owner": {"reputation": 1575, "user_id": 5169186, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DvwLu.jpg?s=128&g=1", "display_name": "Oghli", "link": "https://stackoverflow.com/users/5169186/oghli"}, "is_accepted": false, "score": 1, "last_activity_date": 1485975146, "last_edit_date": 1485975146, "creation_date": 1485974712, "answer_id": 41987323, "question_id": 41986135, "link": "https://stackoverflow.com/questions/41986135/char-array-rotation-error-in-c-cant-see-reason-why/41987323#41987323", "title": "Char array rotation error in C - can&#39;t see reason why", "body": "<p>your way is correct but you have logic mistake when reading each character <code>scanf(\"%c\", &amp;ar[i])</code><br>\n<code>scanf</code> will take whitespaces in your inputs \nso when you input <code>7 cacbbba</code> it will read whitespace and save it in array as character so you will notice in your output that one character is missing.</p>\n\n<p>it should be<code>scanf(\" %c\", &amp;ar[i])</code> to ignore whitespaces.</p>\n\n<p>also no need to use <code>temp[n]</code> char array just <code>temp</code> char variable is enough in your case.</p>\n\n<p>your code should be like :</p>\n\n<pre><code>int main(void) {\nint n;\nscanf(\"%d\", &amp;n);\nchar ar[n];\nchar temp;\n\nfor (int i=0; i&lt;n; i++) {\n    scanf(\" %c\", &amp;ar[i]); // ignore whitespaces\n}\nint i;\ntemp = ar[0];\nfor ( i=0; i&lt; n-1; i++) {\n    ar[i] = ar[i+1];\n}\nar[n-1] = temp;\n\nfor(int i=0; i&lt;n; i++){\n    printf(\"%c\", ar[i]);\n}\n\nreturn 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485976637, "post_id": 41987708, "comment_id": 71153244, "body": "<code>char arr[n];  scanf(&quot;%s&quot;, &amp;arr);</code> fails.  <code>arr[n]</code> is 1 too small for <code>&quot;7 cacbbba&quot;</code>."}, {"owner": {"reputation": 1, "user_id": 7502291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd0f09db6b8aa5f6cfabc6cc2cbd002?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitriy Stepin", "link": "https://stackoverflow.com/users/7502291/dmitriy-stepin"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485977427, "post_id": 41987708, "comment_id": 71153680, "body": "You are correct, scanf automatically adds the null-terminator. Should be n+1 for the size so it keeps the null inside the array memory."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1485982803, "post_id": 41987708, "comment_id": 71156619, "body": "<code>scanf(&quot;%s&quot;</code> is equally as bad as <code>gets</code>"}], "tags": [], "owner": {"reputation": 1, "user_id": 7502291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd0f09db6b8aa5f6cfabc6cc2cbd002?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitriy Stepin", "link": "https://stackoverflow.com/users/7502291/dmitriy-stepin"}, "is_accepted": false, "score": -1, "last_activity_date": 1485977579, "last_edit_date": 1485977579, "creation_date": 1485976152, "answer_id": 41987708, "question_id": 41986135, "link": "https://stackoverflow.com/questions/41986135/char-array-rotation-error-in-c-cant-see-reason-why/41987708#41987708", "title": "Char array rotation error in C - can&#39;t see reason why", "body": "<p>Use a string for the input, flush the standard i/o.</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nvoid rotate(char* arr, uint8_t size)\n{\n    printf(\"rotating\\n\");\n    uint32_t last = arr[0];\n    for(uint8_t i = 1; i &lt; size; ++i)\n    {\n        arr[i-1] = arr[i];\n    }\n    arr[size-1] = last;\n}\n\nvoid print_arr(char* arr, uint8_t size)\n{\n    printf(\"array: %s\",arr);\n    printf(\"\\n\");\n}\n\nint main(void)\n{\n\n    uint8_t n;\n    scanf(\"%d\",&amp;n);\n    fflush(stdout);\n    char arr[n+1]; //mallocing for the size is a bit better\n\n    scanf(\"%s\", &amp;arr);\n    fflush(stdout);\n    n = strlen(arr); //Not the best thing to do using strlen\n    print_arr(arr,n);\n\n    for(uint8_t i = 0; i &lt; n; ++i)\n    {\n        rotate(arr,n);\n        print_arr(arr,n);\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 7462165, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a556cc9295e32b1a891e1aba14b43f8?s=128&d=identicon&r=PG&f=1", "display_name": "Rand", "link": "https://stackoverflow.com/users/7462165/rand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 41986433, "answer_count": 4, "score": 0, "last_activity_date": 1485977579, "creation_date": 1485970724, "question_id": 41986135, "link": "https://stackoverflow.com/questions/41986135/char-array-rotation-error-in-c-cant-see-reason-why", "title": "Char array rotation error in C - can&#39;t see reason why", "body": "<p>I'm trying to rotate an array to the left, I am getting really weird results and cannot see the error, maybe I need sleep. Help will be greatly appreciated</p>\n\n<pre><code>int main() {\n\nint n;\nscanf(\"%d\", &amp;n);\nchar ar[n];\nchar temp[n];\n\nfor (int i=0; i&lt;n; i++) {\n    scanf(\"%c\", &amp;ar[i]);\n}\nint i;\ntemp[0] = ar[0];\nfor (int i=0; i&lt;(n-1); i++) {\n    ar[0+i] = ar[1+i];\n}\nar[n-1] = temp[0];\n\nfor(int i=0; i&lt;n; i++){\n    printf(\"%c\", ar[i]);\n}\n\nreturn 0;\n}\n</code></pre>\n\n<p>Example Input:</p>\n\n<p>7\ncacbbba</p>\n\n<p>Example output:</p>\n\n<p>cacbbb</p>\n"}, {"tags": ["c", "printf", "operator-precedence"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1485969857, "post_id": 41985848, "comment_id": 71149408, "body": "Read about operator precedence and <i>short-circuit evaluation</i>. But I would restrict by law to use a computer from the author of this code."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1485970144, "post_id": 41985848, "comment_id": 71149598, "body": "<code>++b</code> increments <code>b</code> to <code>2</code>, so b is now <code>&gt; 1</code>, so the whole expression becomes true, so <code>1</code> is assigned to <code>a</code>. <code>c</code> and <code>d</code> remain unchanged, since there was no need to evaluate the rest of the expression."}, {"owner": {"reputation": 2193, "user_id": 3700524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVsYW.jpg?s=128&g=1", "display_name": "Mohsen_Fatemi", "link": "https://stackoverflow.com/users/3700524/mohsen-fatemi"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1485970151, "post_id": 41985848, "comment_id": 71149607, "body": "@EugeneSh. it doesn&#39;t refer to laziness of the programming language ?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 2193, "user_id": 3700524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVsYW.jpg?s=128&g=1", "display_name": "Mohsen_Fatemi", "link": "https://stackoverflow.com/users/3700524/mohsen-fatemi"}, "edited": false, "score": 0, "creation_date": 1485970213, "post_id": 41985848, "comment_id": 71149659, "body": "@Mohsen_Fatemi that is not laziness but efficiency."}, {"owner": {"reputation": 35, "user_id": 5897316, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/014e2f82c1dcc4259deb93857f036ddb?s=128&d=identicon&r=PG&f=1", "display_name": "gaurav b", "link": "https://stackoverflow.com/users/5897316/gaurav-b"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1485970653, "post_id": 41985848, "comment_id": 71149932, "body": "@WeatherVane you mean to say after checking the first condition it will not evaluate the next expression?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1485970788, "post_id": 41985848, "comment_id": 71150019, "body": "It skips the rest of the tests if the outcome can be known from the first test, which in this case it can. However if <code>++b</code> were not <code>&gt; 1</code> the next test whould be done and so on. The above comment about <i>short-circuit evaluation</i> applies. So be careful about any side-effects that you need and perform them first."}, {"owner": {"reputation": 35, "user_id": 5897316, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/014e2f82c1dcc4259deb93857f036ddb?s=128&d=identicon&r=PG&f=1", "display_name": "gaurav b", "link": "https://stackoverflow.com/users/5897316/gaurav-b"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1485971114, "post_id": 41985848, "comment_id": 71150203, "body": "@WeatherVane Thanks for the explanation"}], "answers": [{"tags": [], "owner": {"reputation": 133, "user_id": 7424291, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dWpdh.jpg?s=128&g=1", "display_name": "rahul_T_T", "link": "https://stackoverflow.com/users/7424291/rahul-t-t"}, "is_accepted": false, "score": 3, "last_activity_date": 1485971037, "creation_date": 1485971037, "answer_id": 41986243, "question_id": 41985848, "link": "https://stackoverflow.com/questions/41985848/can-anyone-exlpain-me-the-answer-of-this-code-in-c/41986243#41986243", "title": "Can anyone exlpain me the answer of this code in c", "body": "<p>here <code>a=++b&gt;1 || ++c&gt;1 &amp;&amp; ++d&gt;1;</code> this line will be executed as</p>\n\n<pre><code>a=((++b&gt;1) || ((++c&gt;1) &amp;&amp; (++d&gt;1))); according to precedence.\n</code></pre>\n\n<p>Associativity of <code>||</code> operation is from left to right, so <code>(++b&gt;1)</code> will be executed first, then <code>b</code> gets incremented to <code>2</code> and left side of <code>||</code> operation will become <code>true</code>, so right side will not get executed and <code>c,d</code> remains unchanged.</p>\n"}], "owner": {"reputation": 35, "user_id": 5897316, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/014e2f82c1dcc4259deb93857f036ddb?s=128&d=identicon&r=PG&f=1", "display_name": "gaurav b", "link": "https://stackoverflow.com/users/5897316/gaurav-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 501, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1486198281, "creation_date": 1485969776, "last_edit_date": 1486198281, "question_id": 41985848, "link": "https://stackoverflow.com/questions/41985848/can-anyone-exlpain-me-the-answer-of-this-code-in-c", "title": "Can anyone exlpain me the answer of this code in c", "body": "<pre><code>#include&lt;stdio.h&gt;\n\nvoid main()\n{\n    int a,b,c,d;\n    a=b=c=d=1;\n    a=++b&gt;1 || ++c&gt;1 &amp;&amp; ++d&gt;1;\n    printf(\"%d%d%d%d\",a ,b ,c ,d);\n}\n</code></pre>\n\n<p>The answer of the above code in gcc compiler is <strong>1211</strong>,can anyone explain me why it is so?</p>\n"}, {"tags": ["c", "sockets", "networking", "tcp"], "comments": [{"owner": {"reputation": 39406, "user_id": 371250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WKvHm.png?s=128&g=1", "display_name": "ninjalj", "link": "https://stackoverflow.com/users/371250/ninjalj"}, "edited": false, "score": 1, "creation_date": 1485996137, "post_id": 41985774, "comment_id": 71161884, "body": "Regarding exceptfds, the Telnet protocol (also used in other protocols, e.g. in the FTP control connection) uses TCP URG (OOB) for some commands. IIRC Ctrl-C&#39;ing a connection causes it to be used."}], "answers": [{"comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 2, "creation_date": 1485985675, "post_id": 41989801, "comment_id": 71157984, "body": "Selecting for writeability should only be used after EAGAIN/EWOULDBLOCK. Otherwise when you have something to write, just write it immediately, and check. Doing that via <code>select()</code> is just a waste of time. Your final paragraph seems somewhat circular:  you only generate output when there is room, and you only test for room when there is output."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1485987174, "post_id": 41989801, "comment_id": 71158760, "body": "@EJP You need to make the distinction between (a) &quot;I have some data structure that I want to serialize into bytes to add to the FIFO&quot; and (b) &quot;I have bytes in my FIFO that I want to send() to the socket&quot;.    You&#39;d serialize and append to the FIFO when (a &amp; !b), and you&#39;d select-for-write and send() when (b)."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1485988411, "post_id": 41989801, "comment_id": 71159321, "body": "@EJP to be clear, my design is to have exactly one call to select() in the entire program, and to never block except in that one call.  So in the case where there is a socket with bytes present in its outgoing-data FIFO, I include that socket in select()&#39;s writefds, so that select() will return as soon as the socket has buffer space available to send() to."}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1506885873, "post_id": 41989801, "comment_id": 79986264, "body": "Nitpick: to avoid extra syscalls, you should still buffer rather than write <i>immediately</i>. But you should try to flush the buffers before the next call to <code>select</code>."}], "tags": [], "owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "is_accepted": true, "score": 5, "last_activity_date": 1485984981, "last_edit_date": 1485984981, "creation_date": 1485983385, "answer_id": 41989801, "question_id": 41985774, "link": "https://stackoverflow.com/questions/41985774/select-practical-use-of-writefds-and-exceptfds-with-non-blocking-tcp-sockets/41989801#41989801", "title": "select() - practical use of writefds and exceptfds with non-blocking TCP sockets?", "body": "<blockquote>\n  <p>Is Apple recommending to use writefds just because it's \"the right\n  official way\" or maybe there are other approaches how to deal with\n  socket writes without writefds?</p>\n</blockquote>\n\n<p>The other approach (that you saw in the tutorials you looked at) is to assume that the write-buffer will always be large enough to immediately hold whatever data you want to send out to it, and just blindly call send() whenever you need to.</p>\n\n<p>It simplifies the code, but it's not a very good approach -- maybe it's good enough for a toy/example program, but I wouldn't want to make that assumption in production-quality code, because it means something bad will happen if/when your program generates enough data at once to fill the socket's output buffer.  Depending on how you (mis)handled the call to send(), either your program would go into a spin loop (calling send() and getting EWOULDBLOCK, over and over again, until there was finally enough room to place all the data), or error out (if you treated EWOULDBLOCK/short-send() as a fatal error condition), or drop some of the outgoing data bytes (if you were just ignoring send()'s return value completely).  None of these is a graceful way to handle the full-output-buffer situation.</p>\n\n<blockquote>\n  <p>If we put the socket into writefds from the very start and then don't\n  write to it for some time, won't select() wake up immediately just\n  because the socket is writable (and that's because we haven't written\n  to it yet)?</p>\n</blockquote>\n\n<p>Yes, absolutely -- which is why you would only place the socket into the writefds set <em>if you currently have some data that you want to write to the socket</em>.  In the case where you currently have no data that you want to write to the socket, you'd leave the socket out of writefds so that select() wouldn't immediately return.</p>\n\n<blockquote>\n  <p>About exceptfds -I haven't yet seen any examples using it with TCP\n  sockets. I have read that it is used for out-of-band data.</p>\n</blockquote>\n\n<p>Generally exceptfds isn't used for much (neither is TCP's out-of-band data feature, AFAIK).  The only other time I've seen it used is when doing asynchronous/non-blocking TCP connects under Windows -- Windows uses the exceptfds to wake up select() when an asynchronous/non-blocking TCP connect attempt has failed.</p>\n\n<blockquote>\n  <p>Then if send fails, I could just queue the data into some internal\n  buffer and send it out later (which means - next time when select()\n  with readfs wakes up). But this seems dangerous - what if next readfs\n  wakeup comes much later and the data to be written just sits in our\n  buffer waiting, theoretically, forever?</p>\n</blockquote>\n\n<p>Since TCP automatically slows the sender down to transmit at roughly the rate the receiver receives it at, it certainly is possible that the receiving program could simply stop calling recv(), eventually reducing the sender's transmission rate to zero.  Or, alternatively, the network in between the sender and the receiver could start dropping so many packets that the transmission rate becomes effectively zero, even though the receiver is calling recv() like it is supposed to.  In either case, that would mean that your queued data could very well sit in your outgoing-data buffer for a long time -- probably not forever in the latter case, since a completely bogged down TCP connection will eventually error out; and in the former case you need to debug the receiving side more than the sending side.</p>\n\n<p>The real problem comes when your sender is generating data faster than your receiver can receive it (or, to put it another way, faster than the network can transport it) -- in that case, if you're queueing the \"excess\" data into a FIFO on the sender's side, that FIFO could grow without bound until eventually your sending process crashes due to memory exhaustion -- definitely not desirable behavior.</p>\n\n<p>There are several ways to handle that; one way would be to simply monitor the number of bytes currently held in the FIFO, and when it reaches a certain threshold (e.g. one megabyte or something; what constitutes a \"reasonable\" threshold would depend on what your app is doing), the server could decide that the client simply can't perform well enough and close the sending socket in self-defense (and free up the associated FIFO queue of course).  That works well in a lot of cases, although if your server ever generated/enqueued more than that amount of data instantaneously, it might suffer from false positives, and end up inappropriately disconnecting clients that were actually performing well.</p>\n\n<p>Another approach (which I prefer, when possible) is to design the server so that it <em>only</em> generates more output data for a socket when there is currently no output-data queued up for that socket.  i.e. when the socket selects as ready-for-write, drain as much existing data as you can from the FIFO queue into the socket.  When the FIFO queue is empty <em>and</em> you have data you want to generate outgoing-bytes from <em>and</em> the socket is ready-for-write, <em>that</em> is the only time to generate some more output data bytes and place them into the FIFO queue.  Repeat that forever, and your FIFO queue's size will never be greater than the amount of data you generated in one iteration of your generate-more-data-bytes step, no matter how slow the client is.</p>\n"}], "owner": {"reputation": 11580, "user_id": 217823, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/198e729c90ed694c9e3dd4e05c9fb17c?s=128&d=identicon&r=PG", "display_name": "JustAMartin", "link": "https://stackoverflow.com/users/217823/justamartin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1001, "favorite_count": 0, "accepted_answer_id": 41989801, "answer_count": 1, "score": 2, "last_activity_date": 1485989413, "creation_date": 1485969557, "question_id": 41985774, "link": "https://stackoverflow.com/questions/41985774/select-practical-use-of-writefds-and-exceptfds-with-non-blocking-tcp-sockets", "title": "select() - practical use of writefds and exceptfds with non-blocking TCP sockets?", "body": "<p>According to <a href=\"http://man7.org/linux/man-pages/man2/select.2.html\" rel=\"nofollow noreferrer\">Linux man pages</a>, <code>select</code> supports three kinds of events for waking up:</p>\n\n<ul>\n<li><code>readfds</code> will be watched to see if characters become available for       reading </li>\n<li><code>writefds</code> will be watched to see if space is available for write</li>\n<li><code>exceptfds</code> will be watched for exceptions</li>\n</ul>\n\n<p>While looking for practical use examples with TCP sockets online and in networking books, I mostly see only <code>readfds</code> being used, even if the code tries to write to the socket later.</p>\n\n<p>But the socket might be not ready for writing because we might have received it only in <code>readfs</code> set but not in <code>writefds</code> set. To avoid blocking on writes, I usually set the fd of the socket in non-block mode. Then if <code>send</code> fails, I could just queue the data into some internal buffer and send it out later (which means - next time when <code>select()</code> with <code>readfs</code> wakes up). But this seems dangerous - what if next <code>readfs</code> wakeup comes much later and the data to be written just sits in our buffer waiting, theoretically, forever? </p>\n\n<p>Apple's documentation also recommends to use <code>writefds</code>: <a href=\"https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/NetworkingTopics/Articles/UsingSocketsandSocketStreams.html#//apple_ref/doc/uid/CH73-SW1\" rel=\"nofollow noreferrer\">Using Sockets and Socket Streams</a>, see section \"Handling Events with Pure POSIX Code\", quoting:</p>\n\n<blockquote>\n  <p>Call select in a loop, passing <strong>two separate copies</strong> of that file\n  descriptor set (created by calling FD_COPY) for the <strong>read and write</strong>\n  descriptor sets.</p>\n</blockquote>\n\n<p>So the questions are:</p>\n\n<ol>\n<li><p>Is Apple recommending to use <code>writefds</code> just because it's \"the right official way\" or maybe there are other approaches how to deal with socket writes without <code>writefds</code>? And Apple's recommendation seems suspicious to me. If we put the socket into <code>writefds</code> from the very start and then don't write to it for some time, won't <code>select()</code> wake up immediately just because the socket is writable (and that's because we haven't written to it yet)?</p></li>\n<li><p>About <code>exceptfds</code> -I haven't yet seen any examples using it with TCP sockets. I have read that it is used for out-of-band data. Does that mean that I can ignore <code>exceptfds</code> for TCP sockets if I deal only with mainstream Internet traffic, such as HTTP, audio/video streaming, game servers etc.?</p></li>\n</ol>\n"}, {"tags": ["c", "malloc", "mpi", "pointer-arithmetic"], "comments": [{"owner": {"reputation": 116, "user_id": 2871665, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/OHgmn.jpg?s=128&g=1", "display_name": "Marta", "link": "https://stackoverflow.com/users/2871665/marta"}, "edited": false, "score": 0, "creation_date": 1485971571, "post_id": 41985758, "comment_id": 71150482, "body": "Adding on my question. I use the variable iter to move the address of the receive buffer in MPI_Gather(). iter may have different values in different processors. Which one is used in the MPI_Gather function? The one for the processor that receives the data? If so, how can I ensure the different processors are waiting for it?"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1485971832, "post_id": 41985758, "comment_id": 71150645, "body": "Please add the exact wording of the specific error message to your question!"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1485972047, "post_id": 41985758, "comment_id": 71150775, "body": "If you add any more questions, please use the edit function and put the additional questions in the question body."}], "answers": [{"comments": [{"owner": {"reputation": 116, "user_id": 2871665, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/OHgmn.jpg?s=128&g=1", "display_name": "Marta", "link": "https://stackoverflow.com/users/2871665/marta"}, "edited": false, "score": 0, "creation_date": 1486041919, "post_id": 41986475, "comment_id": 71182875, "body": "Thank you. I have fixed that, but the errors remain."}, {"owner": {"reputation": 116, "user_id": 2871665, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/OHgmn.jpg?s=128&g=1", "display_name": "Marta", "link": "https://stackoverflow.com/users/2871665/marta"}, "edited": false, "score": 0, "creation_date": 1486042773, "post_id": 41986475, "comment_id": 71183435, "body": "If MPI_Gather does not allow the processes to overtake each other, how can inserting an output line before the MPI_Gather command printf(&quot;iter: %d, processor: %d before MPI_Gather.\\n&quot;, iter, rank); give this output? iter: 0, processor: 0 before MPI_Gather. iter: 0, processor: 1 before MPI_Gather. iter: 0, processor: 2 before MPI_Gather. iter: 0, processor: 3 before MPI_Gather. iter: 1, processor: 0 before MPI_Gather. iter: 1, processor: 1 before MPI_Gather. iter: 2, processor: 1 before MPI_Gather. iter: 3, processor: 1 before MPI_Gather. iter: 4, processor: 1 before MPI_Gathe"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "reply_to_user": {"reputation": 116, "user_id": 2871665, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/OHgmn.jpg?s=128&g=1", "display_name": "Marta", "link": "https://stackoverflow.com/users/2871665/marta"}, "edited": false, "score": 0, "creation_date": 1486044686, "post_id": 41986475, "comment_id": 71184775, "body": "Please edit a fixed <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> (read that page carefully) into your question for any further debugging attempts."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "reply_to_user": {"reputation": 116, "user_id": 2871665, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/OHgmn.jpg?s=128&g=1", "display_name": "Marta", "link": "https://stackoverflow.com/users/2871665/marta"}, "edited": false, "score": 0, "creation_date": 1486044805, "post_id": 41986475, "comment_id": 71184855, "body": "The operations cannot overtake each other, means only that they will match in order. But the control flow on the ranks is not necessarily in sync - <code>MPI_Gather</code> does not imply a barrier. Also there is no guarntee whatsover on how stdout from different ranks is merged."}, {"owner": {"reputation": 116, "user_id": 2871665, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/OHgmn.jpg?s=128&g=1", "display_name": "Marta", "link": "https://stackoverflow.com/users/2871665/marta"}, "edited": false, "score": 0, "creation_date": 1486045918, "post_id": 41986475, "comment_id": 71185679, "body": "That was a small bug that I have since fixed. Thank you for your clarification earlier: that was the main issue I was facing."}], "tags": [], "owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "is_accepted": false, "score": 1, "last_activity_date": 1485971749, "creation_date": 1485971749, "answer_id": 41986475, "question_id": 41985758, "link": "https://stackoverflow.com/questions/41985758/addressing-memory-in-mpi-gather-c/41986475#41986475", "title": "Addressing Memory in MPI_Gather C", "body": "<p>Pointer arithmetic is done on the size of word the pointer is pointing to. Since <code>phie</code> is a <code>float *</code>, the <code>sizeof(float)</code> in <code>phie+iter*20*size*sizeof(float)</code> is redundant and you are going outside of the valid memory.</p>\n\n<p>Remove the <code>sizeof(float</code>), or better change it to a clearer array indexing: <code>&amp;(phie[iter * 20 * size])</code></p>\n\n<p>You should also remove all the pointer casts, they are all redundant and can hide issues. You should only cast when you know that you need it.</p>\n\n<p>Regarding your additional question: The <code>recvbuf</code> parameter of <code>MPI_Gather</code> is only significant at the root process. Therefore only the <code>iter</code> of the root process matters. Nevertheless since all your processes go through the same loop of running <code>MPI_Gather</code>, and they cannot overtake each other, they will always have the same <code>iter</code> during matching gathers.</p>\n"}], "owner": {"reputation": 116, "user_id": 2871665, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/OHgmn.jpg?s=128&g=1", "display_name": "Marta", "link": "https://stackoverflow.com/users/2871665/marta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485971845, "creation_date": 1485969472, "last_edit_date": 1485971845, "question_id": 41985758, "link": "https://stackoverflow.com/questions/41985758/addressing-memory-in-mpi-gather-c", "title": "Addressing Memory in MPI_Gather C", "body": "<p>I am trying to pass on data to <code>MPI_Gather</code>. I allocate memory as follows:</p>\n\n<pre><code>float *phie, *phitemp;\nMPI_Comm_size(MPI_COMM_WORLD, &amp;size);\nMPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);\n\nphitemp=(float *) malloc(20*sizeof(float));\nif (rank==1) phie=(float *) malloc(itermax*20*size*sizeof(float));\n</code></pre>\n\n<p>and then get all processes to send data to rank 1 using <code>MPI_Gather()</code> as below:</p>\n\n<pre><code>for (iter=0;iter&lt;itermax;iter++) {    \n   MPI_Gather((float *) phitemp, 20, MPI_FLOAT, (float *) (phie+iter*20*size*sizeof(float)), 20, MPI_FLOAT, 1, MPI_COMM_WORLD);\n   iter=0;\n</code></pre>\n\n<p>}</p>\n\n<p>I get error messages suggesting I am not allocating memory appropriately.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1485968083, "post_id": 41985300, "comment_id": 71148340, "body": "Have you read the documentation of <code>scanf</code>? It has everything."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1485968219, "post_id": 41985300, "comment_id": 71148418, "body": "Because %c doesn&#39;t skip white space such as newline. This is a duplicate question."}, {"owner": {"reputation": 27, "user_id": 7501603, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GOVRbUmtk8g/AAAAAAAAAAI/AAAAAAAAAAs/su_4C6OXVjk/photo.jpg?sz=128", "display_name": "Rubel Hosen", "link": "https://stackoverflow.com/users/7501603/rubel-hosen"}, "edited": false, "score": 0, "creation_date": 1485968282, "post_id": 41985300, "comment_id": 71148463, "body": "I guess, I didn&#39;t. May i get any link or some kind of information that will help me to know?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1485968376, "post_id": 41985300, "comment_id": 71148532, "body": "<a href=\"https://www.google.com/#q=man+scanf\" rel=\"nofollow noreferrer\">google.com/#q=man+scanf</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3180, "user_id": 4875869, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Et6rMvbhpQ4/AAAAAAAAAAI/AAAAAAAAAIM/tGpQoqm18cs/photo.jpg?sz=128", "display_name": "Kirill Bulygin", "link": "https://stackoverflow.com/users/4875869/kirill-bulygin"}, "is_accepted": false, "score": 0, "last_activity_date": 1485968336, "creation_date": 1485968336, "answer_id": 41985392, "question_id": 41985300, "link": "https://stackoverflow.com/questions/41985300/why-should-i-use-a-space-before-c-while-taking-input-into-an-array/41985392#41985392", "title": "Why should i use a space before %c while taking input into an array?", "body": "<p>In the first case <code>word[0]</code> became <code>\\n</code> (you entered <code>5\\n</code>). In the second case the <code>\\n</code> was skipped because you told scanf to skip whitespace characters (by <code></code>).</p>\n"}], "owner": {"reputation": 27, "user_id": 7501603, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GOVRbUmtk8g/AAAAAAAAAAI/AAAAAAAAAAs/su_4C6OXVjk/photo.jpg?sz=128", "display_name": "Rubel Hosen", "link": "https://stackoverflow.com/users/7501603/rubel-hosen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "closed_date": 1485968370, "answer_count": 1, "score": 2, "last_activity_date": 1485968336, "creation_date": 1485968041, "last_edit_date": 1485968099, "question_id": 41985300, "link": "https://stackoverflow.com/questions/41985300/why-should-i-use-a-space-before-c-while-taking-input-into-an-array", "closed_reason": "Duplicate", "title": "Why should i use a space before %c while taking input into an array?", "body": "<p>I have just written a program to reverse a word. I have first compiled the program as follows:</p>\n\n<pre><code>//This program will reverse a given word\n\n#include &lt;stdio.h&gt;\nint main()\n{\nint letters, i, j;\nprintf(\"Enter the number of letters in your word: \");\nscanf(\"%d\", &amp;letters);\n\nint word[letters];\n\nprintf(\"Enter %d Letters: \", letters);\nfor( i = 0; i &lt; letters; i++){\n    scanf(\"%c\", &amp;word[i]);\n}\n\nfor( j = i - 1; j &gt;= 0; j-- ){\n    printf(\"%c\", word[j]);\n}\n\n\nreturn 0;\n}\n</code></pre>\n\n<p>Then, I inputted 5 to store in letters and the word \"rubel\" (ignore the inverted comma) to reverse. The expected output was \"lebur\". But unfortunately i got ebur. then i recompiled the code as below:</p>\n\n<pre><code>//This program will reverse a given word\n\n#include &lt;stdio.h&gt;\nint main()\n{\nint letters, i, j;\nprintf(\"Enter the number of letters in your word: \");\nscanf(\"%d\", &amp;letters);\n\nint word[letters];\n\nprintf(\"Enter %d Letters: \", letters);\nfor( i = 0; i &lt; letters; i++){\n    scanf(\" %c\", &amp;word[i]);\n}\n\nfor( j = i - 1; j &gt;= 0; j-- ){\n    printf(\"%c\", word[j]);\n}\n\n\nreturn 0;\n}\n</code></pre>\n\n<p>This time i got expected output which is \"lebur\". Now, my question is what was wrong before that i didn't get expected output and what have i just done by putting a space that this time i got the expected result. Thanks in advance.</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 261, "user_id": 7497945, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c70f416b740ab2b614b3bd5cc0010efc?s=128&d=identicon&r=PG&f=1", "display_name": "woshidashen", "link": "https://stackoverflow.com/users/7497945/woshidashen"}, "edited": false, "score": 0, "creation_date": 1485969140, "post_id": 41985455, "comment_id": 71148967, "body": "I defined my array with struct node **hashtable[10000];"}, {"owner": {"reputation": 261, "user_id": 7497945, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c70f416b740ab2b614b3bd5cc0010efc?s=128&d=identicon&r=PG&f=1", "display_name": "woshidashen", "link": "https://stackoverflow.com/users/7497945/woshidashen"}, "edited": false, "score": 0, "creation_date": 1485969188, "post_id": 41985455, "comment_id": 71149005, "body": "so I think I should instead define it like struct node *hashtable[10000]; and rewrite my function accordingly then, thanks again!"}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 1, "last_activity_date": 1485968528, "creation_date": 1485968528, "answer_id": 41985455, "question_id": 41985221, "link": "https://stackoverflow.com/questions/41985221/c-function-passing-array-input/41985455#41985455", "title": "C: Function passing array input", "body": "<p><code>arr[value]=&amp;p</code> is effectively returning a pointer to a local variable, which is never a valid thing to do. Local variables do not exist after the function returns. It looks like what you want is to declare the parameter as <code>node *arr[]</code> and change that line to <code>arr[value]=p</code>. That will correctly save a pointer to the memory you allocated for the node.</p>\n\n<p>You may also want to think about whether it makes more sense to have the function just allocate and initialize the <code>node</code> structure and return that, at which point the caller can add it to the array.</p>\n"}, {"tags": [], "owner": {"reputation": 478, "user_id": 7340799, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/f75d55f4966cd77ddfe2df8db720140e?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamed Amine Ouali", "link": "https://stackoverflow.com/users/7340799/mohamed-amine-ouali"}, "is_accepted": false, "score": 0, "last_activity_date": 1485969480, "creation_date": 1485969480, "answer_id": 41985760, "question_id": 41985221, "link": "https://stackoverflow.com/questions/41985221/c-function-passing-array-input/41985760#41985760", "title": "C: Function passing array input", "body": "<p>In your exemple you are not adding the pointer of node but you are adding a pointeur of a pointeur to the node.\nthe pointeur to the node is p if you save the adresse of p then you are saving the adresse of the pointer. we have p is a local variable so it will dislocate when we return from the function. </p>\n\n<p>Rule: never try to save adresse of a local variable and use it outside the function that declare this variable.</p>\n\n<pre><code>void addhash(int value,struct node * arr[]){\nstruct node *p =(struct node*)malloc(sizeof(struct node));\np-&gt;value=10;\narr[value]=p;\n};\n</code></pre>\n\n<p>I hope that I have answered your question</p>\n"}], "owner": {"reputation": 261, "user_id": 7497945, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c70f416b740ab2b614b3bd5cc0010efc?s=128&d=identicon&r=PG&f=1", "display_name": "woshidashen", "link": "https://stackoverflow.com/users/7497945/woshidashen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 41985455, "answer_count": 2, "score": 1, "last_activity_date": 1485974180, "creation_date": 1485967806, "last_edit_date": 1485974180, "question_id": 41985221, "link": "https://stackoverflow.com/questions/41985221/c-function-passing-array-input", "title": "C: Function passing array input", "body": "<p>i have a beginner question about function in C, say I have a array of pointers to linked list and I want to write a function to add a pointer of a node to the array:</p>\n\n<pre><code>void addhash(int value,struct node ** arr[]){\n    struct node *p =(struct node*)malloc(sizeof(struct node));\n    p-&gt;value=10;\n    arr[value]=&amp;p;\n};\n</code></pre>\n\n<p>Is this the correct way to define the function? when I run this in main, the bucket that I tried to add a node to is somehow still NULL.</p>\n"}, {"tags": ["c", "lex"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1485967766, "post_id": 41984849, "comment_id": 71148132, "body": "Surely you can make a <i>minimal</i>, complete, and verifiable example out of that."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1485968256, "post_id": 41984849, "comment_id": 71148443, "body": "But do note that you appear to have written a rule for <code>Q</code> where you meant to write one for <code>{Q}</code>."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1485972310, "post_id": 41984849, "comment_id": 71150914, "body": "I think @JohnBollinger has it cased. Although, as I&#39;m sure I&#39;ve mentioned before, using <code>\\&quot;</code> <i>directly</i> in the pattern (as you do in the pattern for string literals) is more readable and less error-prone than over-reliance on pattern macros. Anyway, I&#39;d expect <code>&quot;header.h&quot;</code> to match the string literal rule, regardless of Qs. The fact that it din&#39;t combined with the fact that apparently three bad tokens were produced for what appears to be a single quote character makes me wonder if the input wasn&#39;t actually a typographic quote."}, {"owner": {"reputation": 55, "user_id": 6034851, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/54d1e8f3663d22bb77d8535586964f4b?s=128&d=identicon&r=PG&f=1", "display_name": "Hajime", "link": "https://stackoverflow.com/users/6034851/hajime"}, "edited": false, "score": 0, "creation_date": 1486139856, "post_id": 41984849, "comment_id": 71232204, "body": "It still doesn&#39;t work. Does it has a thing to do with the rule priority or something?"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1493806885, "post_id": 41984849, "comment_id": 74555870, "body": "@Hajime I came to the same conclusion like <a href=\"http://stackoverflow.com/users/1566221/rici\">rici</a> and will elaborate it a little bit: Even if you use <code>{Q}</code> or <code>\\&quot;</code> or <code>&quot;\\&quot;&quot;</code> it will not match the <code>&quot;</code> in <code>#include &quot;header.h&quot;</code> because <b>this</b> rule <code>({SP}?\\&quot;([^&quot;\\\\\\n]|{ES})*\\&quot;{WS}*)+   { return STRING_LITERAL; }</code> will match <code>&quot;header.h&quot;</code>. According to the lex/flex manual: 1. The rule is applied which matches the most characters. 2. If two (or more) rules match with equal length then the first (e.g. the upper most in source code) is chosen."}], "owner": {"reputation": 55, "user_id": 6034851, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/54d1e8f3663d22bb77d8535586964f4b?s=128&d=identicon&r=PG&f=1", "display_name": "Hajime", "link": "https://stackoverflow.com/users/6034851/hajime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 755, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1486142711, "creation_date": 1485966703, "last_edit_date": 1486142711, "question_id": 41984849, "link": "https://stackoverflow.com/questions/41984849/write-a-lex-rule-to-detect-the-quote-symbol", "title": "Write a Lex rule to detect the quote symbol", "body": "<p>I want to ask you how to write a Lex code to detect quote symbols ( \" ) This is my Lex code:</p>\n\n<pre><code>%e  1019\n%p  2807\n%n  371\n%k  284\n%a  1213\n%o  1117\n\nQ   \\\"         /* Definition of Quote*/\nO   [0-7]\nD   [0-9]\nNZ  [1-9]\nL   [a-zA-Z_]\nA   [a-zA-Z_0-9]\nH   [a-fA-F0-9]\nHP  (0[xX])\nE   ([Ee][+-]?{D}+)\nP   ([Pp][+-]?{D}+)\nFS  (f|F|l|L)\nIS  (((u|U)(l|L|ll|LL)?)|((l|L|ll|LL)(u|U)?))\nCP  (u|U|L)\nSP  (u8|u|U|L)\nES  (\\\\(['\"\\?\\\\abfnrtv]|[0-7]{1,3}|x[a-fA-F0-9]+))\nWS  [ \\t\\v\\n\\f]\n\n%{\n    #include &lt;stdio.h&gt;\n    #include \"y.tab.h\"\n\n    extern void yyerror(const char *);  \n\n    extern int sym_type(const char *);  \n\n    #define sym_type(identifier) IDENTIFIER \n\n    static void comment(void);\n    static int check_type(void);\n%}\n\n%%\nQ                       {yylval.a=strdup(yytext); return '\"';} /*Rule to detect quotes*/\n\"/*\"                                    { comment(); }\n\"//\".*                                    { }\n\n\"include\"               { yylval.a=strdup(yytext); return(INCLUDE); } /*Line 44*/\n\"void\"                  { yylval.a=strdup(yytext); return(VOID); }\n\"int\"                   { yylval.a=strdup(yytext); return(INT); } \n\"long\"                  { yylval.a=strdup(yytext); return(LONG); }\n\"char\"                  { yylval.a=strdup(yytext); return(CHAR); }\n\"short\"                 { yylval.a=strdup(yytext); return(SHORT); }\n\"signed\"                { yylval.a=strdup(yytext); return(SIGNED); }\n\"double\"                { yylval.a=strdup(yytext); return(DOUBLE); }\n\"unsigned\"              { yylval.a=strdup(yytext); return(UNSIGNED); }\n\"float\"                 { yylval.a=strdup(yytext); return(FLOAT); }\n\n\n\"auto\"                  { yylval.a=strdup(yytext); return(AUTO); } \n\"extern\"                { yylval.a=strdup(yytext); return(EXTERN); }\n\"register\"              { yylval.a=strdup(yytext); return(REGISTER); }\n\"static\"                { yylval.a=strdup(yytext); return(STATIC); }\n\n\n\"const\"                 { yylval.a=strdup(yytext); return(CONST); } \n\"restrict\"              { yylval.a=strdup(yytext); return(RESTRICT); }\n\"volatile\"              { yylval.a=strdup(yytext); return(VOLATILE); }\n\"_Atomic\"               { yylval.a=strdup(yytext); return ATOMIC; }\n\n\n\"break\"                 { yylval.a=strdup(yytext); return(BREAK); }\n\"case\"                  { yylval.a=strdup(yytext); return(CASE); }\n\n\"continue\"              { yylval.a=strdup(yytext); return(CONTINUE); }\n\"default\"               { yylval.a=strdup(yytext); return(DEFAULT); }\n\"do\"                    { yylval.a=strdup(yytext); return(DO); }\n\"else\"                  { yylval.a=strdup(yytext); return(ELSE); }\n\"enum\"                  { yylval.a=strdup(yytext); return(ENUM); }\n\n\"for\"                   { yylval.a=strdup(yytext); return(FOR); }\n\"goto\"                  { yylval.a=strdup(yytext); return(GOTO); }\n\"if\"                    { yylval.a=strdup(yytext); return(IF); }\n\"inline\"                { yylval.a=strdup(yytext); return(INLINE); }\n\n\n\"return\"                { yylval.a=strdup(yytext); return(RETURN); }\n\"sizeof\"                { yylval.a=strdup(yytext); return(SIZEOF); }\n\n\"struct\"                { yylval.a=strdup(yytext); return(STRUCT); }\n\"switch\"                { yylval.a=strdup(yytext); return(SWITCH); }\n\"typedef\"               { yylval.a=strdup(yytext); return(TYPEDEF); }\n\"union\"                 { yylval.a=strdup(yytext); return(UNION); }\n\n\n\n\"while\"                 { yylval.a=strdup(yytext); return(WHILE); }\n\"_Alignas\"              { yylval.a=strdup(yytext); return ALIGNAS; }\n\"_Alignof\"              { yylval.a=strdup(yytext); return ALIGNOF; }\n\n\"_Bool\"                 { yylval.a=strdup(yytext); return BOOL; }\n\"_Complex\"              { yylval.a=strdup(yytext); return COMPLEX; }\n\"_Generic\"              { yylval.a=strdup(yytext); return GENERIC; }\n\"_Imaginary\"            { yylval.a=strdup(yytext); return IMAGINARY; }\n\"_Noreturn\"             { yylval.a=strdup(yytext); return NORETURN; }\n\"_Static_assert\"        { yylval.a=strdup(yytext); return STATIC_ASSERT; }\n\"_Thread_local\"         { yylval.a=strdup(yytext); return THREAD_LOCAL; }\n\"__func__\"              { yylval.a=strdup(yytext); return FUNC_NAME; }\n\n\n{L}{A}*                 {  return check_type(); } /*Line 107*/\n\n{HP}{H}+{IS}?               { yylval.a=strdup(yytext); return I_CONSTANT; }\n{NZ}{D}*{IS}?               { yylval.a=strdup(yytext); return I_CONSTANT; }\n\"0\"{O}*{IS}?                { yylval.a=strdup(yytext); return I_CONSTANT; }\n{CP}?\"'\"([^'\\\\\\n]|{ES})+\"'\"     { return I_CONSTANT; } /**/\n\n{D}+{E}{FS}?                { yylval.a=strdup(yytext); return F_CONSTANT; }\n{D}*\".\"{D}+{E}?{FS}?        { yylval.a=strdup(yytext); return F_CONSTANT; }\n{D}+\".\"{E}?{FS}?            { yylval.a=strdup(yytext); return F_CONSTANT; }\n{HP}{H}+{P}{FS}?            { yylval.a=strdup(yytext);return F_CONSTANT; }\n{HP}{H}*\".\"{H}+{P}{FS}?     { yylval.a=strdup(yytext); return F_CONSTANT; }\n{HP}{H}+\".\"{P}{FS}?         { yylval.a=strdup(yytext); return F_CONSTANT; }\n\n({SP}?\\\"([^\"\\\\\\n]|{ES})*\\\"{WS}*)+   { return STRING_LITERAL; }\n\n\n\"...\"                   { yylval.a=strdup(yytext); return ELLIPSIS; }\n\"&gt;&gt;=\"                   { yylval.a=strdup(yytext); return RIGHT_ASSIGN; }\n\"&lt;&lt;=\"                   { yylval.a=strdup(yytext); return LEFT_ASSIGN; }\n\"+=\"                    { yylval.a=strdup(yytext); return ADD_ASSIGN; }\n\"-=\"                    { yylval.a=strdup(yytext); return SUB_ASSIGN; }\n\"*=\"                    { yylval.a=strdup(yytext); return MUL_ASSIGN; }\n\"/=\"                    { yylval.a=strdup(yytext); return DIV_ASSIGN; }\n\"%=\"                    { yylval.a=strdup(yytext); return MOD_ASSIGN; }\n\"&amp;=\"                    { yylval.a=strdup(yytext); return AND_ASSIGN; }\n\"^=\"                    { yylval.a=strdup(yytext); return XOR_ASSIGN; }\n\"|=\"                    { yylval.a=strdup(yytext); return OR_ASSIGN; }\n\"&gt;&gt;\"                    { yylval.a=strdup(yytext); return RIGHT_OP; }\n\"&lt;&lt;\"                    { yylval.a=strdup(yytext); return LEFT_OP; }\n\"++\"                    { yylval.a=strdup(yytext); return INC_OP; }\n\"--\"                    { yylval.a=strdup(yytext); return DEC_OP; }\n\"-&gt;\"                    { yylval.a=strdup(yytext); return PTR_OP; }\n\"&amp;&amp;\"                    { yylval.a=strdup(yytext); return AND_OP; }\n\"||\"                    { yylval.a=strdup(yytext); return OR_OP; }\n\"&lt;=\"                    { yylval.a=strdup(yytext); return LE_OP; }\n\"&gt;=\"                    { yylval.a=strdup(yytext); return GE_OP; }\n\"==\"                    { yylval.a=strdup(yytext); return EQ_OP; }\n\"!=\"                    { yylval.a=strdup(yytext); return NE_OP; }\n\";\"                     { yylval.a=strdup(yytext); return ';'; }\n(\"{\"|\"&lt;%\")              { yylval.a=strdup(yytext); return '{'; }\n(\"}\"|\"%&gt;\")              { yylval.a=strdup(yytext); return '}'; }\n\",\"                     { yylval.a=strdup(yytext); return ','; }\n\":\"                     { yylval.a=strdup(yytext); return ':'; }\n\"=\"                     { yylval.a=strdup(yytext); return '='; }\n\"(\"                     { yylval.a=strdup(yytext); return '('; }\n\")\"                     { yylval.a=strdup(yytext); return ')'; }\n(\"[\"|\"&lt;:\")              { yylval.a=strdup(yytext); return '['; }\n(\"]\"|\":&gt;\")              { yylval.a=strdup(yytext); return ']'; }\n\".\"                     { yylval.a=strdup(yytext); return '.'; } /*Line 156*/\n\"&amp;\"                     { yylval.a=strdup(yytext); return '&amp;'; }\n\"!\"                     { yylval.a=strdup(yytext); return '!'; }\n\"~\"                     { yylval.a=strdup(yytext); return '~'; }\n\"-\"                     { yylval.a=strdup(yytext); return '-'; }\n\"+\"                     { yylval.a=strdup(yytext); return '+'; }\n\"*\"                     { yylval.a=strdup(yytext); return '*'; }\n\"/\"                     { yylval.a=strdup(yytext); return '/'; }\n\"%\"                     { yylval.a=strdup(yytext); return '%'; }\n\"&lt;\"                     { yylval.a=strdup(yytext); return '&lt;'; }\n\"&gt;\"                     { yylval.a=strdup(yytext); return '&gt;'; }\n\"^\"                     { yylval.a=strdup(yytext); return '^'; }\n\"|\"                     { yylval.a=strdup(yytext); return '|'; }\n\"?\"                     { yylval.a=strdup(yytext); return '?'; }\n\"#\"                     {yylval.a=strdup(yytext); return '#'; }   /*Line 170*/\n\n\n\n\n{WS}+                   { /* whitespace separates tokens */ }\n.                   { /* discard bad characters */ }  /*Line 176*/\n\n%%\n\nint yywrap(void)        /* called at end of input */\n{\n    return 1;           /* terminate now */\n}\n\nstatic void comment(void)\n{\n    int c;\n\n    while ((c = input()) != 0)\n    if (c == '*')\n    {\n        printf(\"1: %d\\n\",c);\n        while ((c = input()) == '*')\n        ;\n        printf(\"2: %d\\n\",c);\n        if (c == '/')\n        return;\n        if (c == 0)\n        printf(\"3: %d\\n\",c);\n        break;\n    }\n    yyerror(\"unterminated comment\");\n}\n\nstatic int check_type(void)\n{\n    switch (sym_type(yytext))\n    {\n        case TYPEDEF_NAME:                /* previously defined */\n            {\n            return TYPEDEF_NAME;\n            }\n        case ENUMERATION_CONSTANT:        /* previously defined */\n        return ENUMERATION_CONSTANT;\n        default:                          /* includes undefined */ /*This is when do normal declaration such as int a=3; in this case it return a*/\n            {\n            yylval.a=strdup(yytext);\n            return IDENTIFIER;\n            }\n    }\n}\n</code></pre>\n\n<p>And this is some relevant part of the Yacc code:</p>\n\n<pre><code>include\n: '#' INCLUDE '&lt;' IDENTIFIER '.' IDENTIFIER '&gt;' {printf(\"The first rule\\n\");}\n| '#' INCLUDE '\"' IDENTIFIER '.' IDENTIFIER '\"' {printf(\"The second rule\\n\");}\n;\n</code></pre>\n\n<p>The problem (I think) is on definition part: <code>Q \\\"</code> When I compiled Lex and ran along with Yacc code. Assume I input a sentence: <code>#include\"header.h\"</code> The output is:</p>\n\n<pre><code>--accepting rule at line 170 (\"#\")\n--accepting rule at line 44 (\"include\")\n--accepting rule at line 176 (\"?\")\n--accepting rule at line 176 (\"?\")\n--accepting rule at line 176 (\"?\")\n--accepting rule at line 107 (\"header\")\n</code></pre>\n\n<p><strong>Note that I wrote a number of line, on the Lex code, corresponding to the error above.</strong> </p>\n\n<p>As you can see the <em># include</em> are tokenized without any problems but <em>header . h</em> aren't okay, it ended up as <code>?</code>. Especially, The comma . should be match in rule \".\" in line 156 but it ended up as rule 176. Also <em>header</em> and <em>h</em> should be matched in rule {L}{A}* of Line 107. What should I do to fix this problem? </p>\n\n<p>And additional question: when I put <code>Q  {yylval.a=strdup(yytext); return '\"';}</code> after line 170, I got error said <code>warning, rule cannot be matched</code> I want to ask why it became like that?</p>\n\n<blockquote>\n  <h2>EDIT</h2>\n</blockquote>\n\n<p><strong>I tried to use {Q}, also rearranged the rules, that is, to put the rules with keyword (such as \"include\",\"void\",\"if\") in the first priority. But it didn't work. Does anyone know how to fix this?</strong> </p>\n"}, {"tags": ["c", "parallel-processing"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1485965098, "post_id": 41984209, "comment_id": 71146416, "body": "You should probably use <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/wait.html\" rel=\"nofollow noreferrer\"><code>wait()</code></a> or  <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/waitpid.html\" rel=\"nofollow noreferrer\"><code>waitpid()</code></a>."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 3, "creation_date": 1485965185, "post_id": 41984209, "comment_id": 71146466, "body": "In your code, &quot;The parent process is done&quot; will be printed as last everytime (since you are using <code>wait()</code>)."}, {"owner": {"reputation": 17, "user_id": 7501319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e3b4fc4a95e3e19d4068d33fb9df369?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Vassilev", "link": "https://stackoverflow.com/users/7501319/mario-vassilev"}, "edited": false, "score": 0, "creation_date": 1485966217, "post_id": 41984209, "comment_id": 71147163, "body": "Thanks a lot, I have managed to fix it. I am going to check mutex and semaphores and how can I improve it."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1485966766, "post_id": 41984209, "comment_id": 71147507, "body": "What makes you think that getting a mutex or a semaphore involved would be an improvement?  Getting rid of the <code>sleep()</code> call would be an improvement.  Having the parent call <code>wait()</code> or <code>waitpid()</code> at the appropriate point relative to its other work would be an improvement.  Given that that can <i>solve</i> the problem as it was presented, and that you do want to call <code>wait()</code> regardless, why would it be better to introduce needless extra complexity?"}], "answers": [{"tags": [], "owner": {"reputation": 58, "user_id": 7494554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed12177ac7f1ba52ae06ec3e5935771?s=128&d=identicon&r=PG&f=1", "display_name": "Kaushik Thakrar", "link": "https://stackoverflow.com/users/7494554/kaushik-thakrar"}, "is_accepted": true, "score": 1, "last_activity_date": 1485969087, "creation_date": 1485969087, "answer_id": 41985627, "question_id": 41984209, "link": "https://stackoverflow.com/questions/41984209/executing-child-before-parent-in-c/41985627#41985627", "title": "Executing child before parent in C", "body": "<p>Try waitpid(-1, NULL, 0); or wait(NULL); This will block parent until all child processes have finished.\nIf it works then you do not need to use sleep.</p>\n\n<p>Slight modification to your code:</p>\n\n<pre><code>else\n{\n    int status =0;\n    printf(\"I am the parent process.%d \\n\", getpid());\n    status= waitpid(-1, NULL, 0); // want to wait until the child is complete\n    //Also check if child process terminated properly\n    if(status==0)\n    {\n        printf(\"Child process terminated properly\");\n    }   \n    else\n    {\n       printf(\"Child process terminated with error\");\n    }\n\n    printf(\"The parent process is done. \\n\");\n\n    fflush(stdout); // it does not write immediately to a disk.\n\n    exit(1);\n}\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7501319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e3b4fc4a95e3e19d4068d33fb9df369?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Vassilev", "link": "https://stackoverflow.com/users/7501319/mario-vassilev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 963, "favorite_count": 0, "accepted_answer_id": 41985627, "answer_count": 1, "score": 1, "last_activity_date": 1485969087, "creation_date": 1485964769, "last_edit_date": 1485965000, "question_id": 41984209, "link": "https://stackoverflow.com/questions/41984209/executing-child-before-parent-in-c", "title": "Executing child before parent in C", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;unistd.h&gt;\n#include&lt;stdlib.h&gt;\n\nint main(int argc, char ** argv)\n{\n\n    int pid;\n    int status;\n    pid = fork();\n\n    if (pid &lt; 0)\n    {\n        printf(\"Cannot create a child process\");\n        exit(1);\n    }\n    else if (pid == 0)\n    {\n\n        printf(\"I am the child process. %d \\n\", getpid());\n        printf(\"The child process is done. \\n\");\n        fflush(stdout); // it does not write immediately to a disk.\n        exit(0);\n    }\n    else\n    {\n\n        printf(\"I am the parent process.%d \\n\", getpid());\n        sleep(5); // sleep does not works\n        pid = wait(&amp;status); // want to wait until the child is complited\n        printf(\"The parent process is done. \\n\");\n        fflush(stdout); // it does not write immediately to a disk.\n        exit(1);\n    }\n}\n</code></pre>\n\n<p>Hi guys, I am currently trying to create a child process. So far so good, however, what I am trying now is to execute the child first and print out and always print out the message \"The parent process is done\" last.</p>\n\n<pre><code>I am the parent process.28847  \nI am the child process. 28848 \nThe child process is done.\nThe parent process is done.\n</code></pre>\n\n<p>Currently is printing this:</p>\n\n<pre><code>I am the parent process.28847 \nThe parent process is done.\nI am the child process. 28848 \nThe child process is done.\n</code></pre>\n\n<p>It is my first time using forking so I am not really confident in what I am doing, I've tried sleep and wait(&amp;status) to try wait until the child process is finished and then execute the parent but something is not working.</p>\n\n<p>P.S. sorry for the bad layout, fist time using stackoverflow.</p>\n"}, {"tags": ["c", "malloc", "mpi"], "comments": [{"owner": {"reputation": 2640, "user_id": 5195699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f85291bb71f55981b1d412f1efcb7603?s=128&d=identicon&r=PG&f=1", "display_name": "R_Kapp", "link": "https://stackoverflow.com/users/5195699/r-kapp"}, "edited": false, "score": 0, "creation_date": 1485964017, "post_id": 41983839, "comment_id": 71145553, "body": "Can you describe the exact nature of your &quot;repeated memory allocation problems&quot;? Do you not get enough memory allocated? Do you get a SIGSEGV for illegal memory access? Do you get a double free?"}, {"owner": {"reputation": 116, "user_id": 2871665, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/OHgmn.jpg?s=128&g=1", "display_name": "Marta", "link": "https://stackoverflow.com/users/2871665/marta"}, "reply_to_user": {"reputation": 2640, "user_id": 5195699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f85291bb71f55981b1d412f1efcb7603?s=128&d=identicon&r=PG&f=1", "display_name": "R_Kapp", "link": "https://stackoverflow.com/users/5195699/r-kapp"}, "edited": false, "score": 0, "creation_date": 1485964209, "post_id": 41983839, "comment_id": 71145698, "body": "Here it is:MPT ERROR: rank:1, function:MPI_GATHER, Message truncated on receive: An application bug caused the sender to send too much data MPT ERROR: Rank 1(g:1) is aborting with error code 0. \tProcess ID: 580144, Host: sgiuv, Program: /home/mv12/Code/Fibrosisnew/example \tMPT Version: SGI MPT 2.15  11/13/16 02:05:30  MPT: --------stack traceback------- MPT: Attaching to program: /proc/580144/exe, process 580144"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1485972076, "post_id": 41983839, "comment_id": 71150792, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/41985758/addressing-memory-in-mpi-gather-c\">Addressing Memory in MPI_Gather C</a> Please do not open multiple questions about the same issue."}], "answers": [{"tags": [], "owner": {"reputation": 143, "user_id": 4774945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28583f114f0445d66ed4dc5edb01297?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Chiang", "link": "https://stackoverflow.com/users/4774945/jonathan-chiang"}, "is_accepted": false, "score": 0, "last_activity_date": 1486062663, "creation_date": 1486062663, "answer_id": 42010438, "question_id": 41983839, "link": "https://stackoverflow.com/questions/41983839/assertion-failure-using-mpi-gather/42010438#42010438", "title": "Assertion failure using MPI_Gather", "body": "<p>Basically, <code>phie</code> is not big enough.</p>\n\n<p>You <code>malloc</code>ed <code>nelecrank*size*gatherfile/gatherphi*sizeof(float)=80*sizeof(float)</code> memory for <code>phie</code>.</p>\n\n<p>But, your <code>MPI_Gather</code> usage requires <code>iter*nelecrank*size*sizeof(float)+nelecrank*size*sizeof(float)</code> memory. <code>iter</code> takes a maximum value of <code>nelecrank*Tmax-1</code>, so <code>phie</code> needs to be <code>(nelecrank*Tmax-1)*nelecrank*size*sizeof(float)+nelecrank*size*sizeof(float)</code>, which is around <code>8000*size*sizeof(float)</code> large.</p>\n\n<p>Maybe you want to reset <code>iter=0</code> in your loop somewhere?</p>\n"}], "owner": {"reputation": 116, "user_id": 2871665, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/OHgmn.jpg?s=128&g=1", "display_name": "Marta", "link": "https://stackoverflow.com/users/2871665/marta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 319, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1486062663, "creation_date": 1485963759, "question_id": 41983839, "link": "https://stackoverflow.com/questions/41983839/assertion-failure-using-mpi-gather", "title": "Assertion failure using MPI_Gather", "body": "<p>I am trying to write MPI C code that repeatedly performs a calculation and saves its outcome into a single array for outputting less frequently. Example code below (the size of var, 200, is sufficient for the number of CPUs in use):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;mpi.h&gt;\n\nint main(int argc, char **argv){\n\nfloat *phie, *phitemp, var[200];\nint time=0, gatherphi=10, gatherfile = 200, j, iter=0, lephie, x;\nint nelecrank = 2, size, rank, Tmax = 2000;\nFILE *out;\n\nMPI_Init(&amp;argc, &amp;argv) ;\n\nMPI_Comm_size(MPI_COMM_WORLD, &amp;size);\nMPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);\n\nlephie = gatherfile/gatherphi; // number of runs of calculation before output\n\n// allocate memory\n//printf(\"%d Before malloc.\\n\", rank);\nif (rank==1) phie=(float *) malloc(nelecrank*size*gatherfile/gatherphi*sizeof(float));\nphitemp=(float *) malloc(nelecrank*sizeof(float));\n//printf(\"%d After malloc.\\n\", rank);\n\nfor(j=0;j&lt;200;j++) var[j]=rank;\n\nfor(time=0;time&lt;Tmax;time++){\nif (!time%gatherphi) {// do calculation\n\n  for (j=0;j&lt;nelecrank;j++) { // each processor does the calculation nelecrank times\n              phitemp[j]=0; \n              for (x = 0; x&lt;=4; x++) {\n                  phitemp[j]=phitemp[j]+var[rank+j*size];\n                  }\n              } \n         } // end of j for loop\n         printf(\"iter: %d, %d Before MPI_Gather.\\n\", iter, rank);\n         MPI_Gather(phitemp, nelecrank, MPI_FLOAT, phie+iter*nelecrank*size*sizeof(float), nelecrank, MPI_FLOAT, 1, MPI_COMM_WORLD);\n         iter++;\n     } // end of gatherphi condition\n\nif (time % gatherfile) { //output result of calculation\n  iter=0;\n  if (rank==1) {\n              out = fopen (\"output.txt\", \"wt+\");\n              if (out == NULL) {\n                  printf(\"Could not open output file.\\n\");\n                  exit(1);\n                  }\n              else  printf(\"Have opened output file.\\n\");\n              for (j=0;j&lt;nelecrank*size*lephie;j++) {\n                      fprintf(out,\"%f \",*(phie+j*sizeof(float)));\n                  }\n              fclose(out);\n              }\n   } // end of file output\n\nif (rank==1) {\n      if (phie) free (phie);\n      }\nif (phitemp) free (phitemp);\nMPI_Finalize();\n\nreturn 0;\n}\n</code></pre>\n\n<p>It gives me repeated memory allocation problems until it finally exits. I am not experienced using memory allocation in MPI - can you help?</p>\n\n<p>Many thanks,\nMarta</p>\n"}, {"tags": ["c", "glibc"], "comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1485962974, "post_id": 41983469, "comment_id": 71144740, "body": "Looks like a substitute for a template."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 3, "creation_date": 1485964962, "post_id": 41983469, "comment_id": 71146312, "body": "In many cases macros express <i>partial</i> code. Look at how this macro is <i>used</i> later in the code to see the complete construct. There, I&#39;m sure, you will see the missing name and all that&#39;s necessary."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1485965269, "post_id": 41983469, "comment_id": 71146519, "body": "Note that the header you referenced directs people to <a href=\"http://man7.org/linux/man-pages/man3/queue.3.html\" rel=\"nofollow noreferrer\">the manual page for <code>queue</code>(3)</a> for usage documentation.  Did you read that page?  It indeed gives explanations, usage instructions, and example code for this macro and the others in that file."}], "answers": [{"comments": [{"owner": {"reputation": 2581, "user_id": 1242646, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2b686cb8d225bf0023e20013bbd3a987?s=128&d=identicon&r=PG", "display_name": "roalz", "link": "https://stackoverflow.com/users/1242646/roalz"}, "edited": false, "score": 0, "creation_date": 1485964155, "post_id": 41983549, "comment_id": 71145649, "body": "Thanks for the comments, edited to provide better and more complete example of usage."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1485964982, "post_id": 41983549, "comment_id": 71146325, "body": "@LightnessRacesinOrbit My comment no longer made sense after the question was edited, so I deleted it."}, {"owner": {"reputation": 2581, "user_id": 1242646, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2b686cb8d225bf0023e20013bbd3a987?s=128&d=identicon&r=PG", "display_name": "roalz", "link": "https://stackoverflow.com/users/1242646/roalz"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1485967884, "post_id": 41983549, "comment_id": 71148213, "body": "@epoxxy If it helped you, please, accept the answer by hitting the tick sign near it"}, {"owner": {"reputation": 109, "user_id": 5104947, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b0897398c4b473adce244a650f5cc36?s=128&d=identicon&r=PG&f=1", "display_name": "epoxxy", "link": "https://stackoverflow.com/users/5104947/epoxxy"}, "edited": false, "score": 0, "creation_date": 1485967890, "post_id": 41983549, "comment_id": 71148217, "body": "Thank you for explaining."}], "tags": [], "owner": {"reputation": 2581, "user_id": 1242646, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2b686cb8d225bf0023e20013bbd3a987?s=128&d=identicon&r=PG", "display_name": "roalz", "link": "https://stackoverflow.com/users/1242646/roalz"}, "is_accepted": true, "score": 9, "last_activity_date": 1485965586, "last_edit_date": 1485965586, "creation_date": 1485962993, "answer_id": 41983549, "question_id": 41983469, "link": "https://stackoverflow.com/questions/41983469/c-programming-define-struct-declaring/41983549#41983549", "title": "c programming #define struct { } declaring", "body": "<p>That is actually a preprocessor macro, that could be expanded (most probably with trailing name) somewhere else.</p>\n\n<p>In the comments at the start of that header file there is a reference to <a href=\"http://man7.org/linux/man-pages/man3/queue.3.html\" rel=\"noreferrer\">queue(3) man page</a> that contains more details on that and other macros:</p>\n\n<blockquote>\n  <p>The macro LIST_ENTRY declares a structure that connects the elements\n  in the list.</p>\n</blockquote>\n\n<p>And an example of use:</p>\n\n<blockquote>\n<pre><code>LIST_HEAD(listhead, entry) head = LIST_HEAD_INITIALIZER(head);  \nstruct listhead *headp;                 /* List head. */\nstruct entry {  \n  ...  \n  LIST_ENTRY(entry) entries;      /* List. */  \n  ...  \n}  \n*n1, *n2, *n3, *np, *np_temp;  \n\nLIST_INIT(&amp;head);                       /* Initialize the list. */  \n\nn1 = malloc(sizeof(struct entry));      /* Insert at the head. */   \nLIST_INSERT_HEAD(&amp;head, n1, entries);\n</code></pre>\n</blockquote>\n\n<p>Being this C code (not C++), and C lacks templates, this preprocessor macro can be used to \"simulate\" templates (note the <code>type</code> parameter).</p>\n"}, {"comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1485964673, "post_id": 41983562, "comment_id": 71146079, "body": "Since you gave the identifier <code>list</code> to the list member in <code>struct foo</code>, you&#39;d need to use <code>fa.list.le_next</code> rather than <code>fa.le_next</code> (and similarly for <code>le_prev</code>). You could, however, make the list member anonymous by declaring it as <code>LIST_ENTRY(foo);</code>, and then you could access <code>fa.le_next</code> and <code>fa.le_prev</code>."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1485964789, "post_id": 41983562, "comment_id": 71146175, "body": "@IanAbbott Thanks! Fixed, of course. Also OMG, aren&#39;t anonymous members C11? :)"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1485964950, "post_id": 41983562, "comment_id": 71146306, "body": "Note that sys/quque.h also comes with macros to add/remove/etc. from such a list (documented at <a href=\"http://man7.org/linux/man-pages/man3/queue.3.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/queue.3.html</a>)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1485964983, "post_id": 41983562, "comment_id": 71146327, "body": "I think the anonymous struct member variation is an even more likely usage model than the named struct variation.  The macro can support both, of course."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1485965385, "post_id": 41983562, "comment_id": 71146595, "body": "I guess the non-anonymous version would be more portable, but several pre-C11 compilers support anonymous members too."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 8, "last_activity_date": 1485964769, "last_edit_date": 1485964769, "creation_date": 1485963051, "answer_id": 41983562, "question_id": 41983469, "link": "https://stackoverflow.com/questions/41983469/c-programming-define-struct-declaring/41983562#41983562", "title": "c programming #define struct { } declaring", "body": "<p>It's a macro that is used to declare a struct type, with <code>next</code> and <code>prev</code>  pointers to instances of a second struct type. That second type can be a parent type, so you can make a \"linkable struct\" like this:</p>\n\n<pre><code>struct foo {\n  LIST_ENTRY(foo) list;\n  int value;\n};\n</code></pre>\n\n<p>This creates a <code>struct foo</code> containing a member called <code>list</code> which in turn is the structure in the question, with the pointers pointing at <code>struct foo</code>.</p>\n\n<p>We can now create a little linked list of <code>struct foo</code>s like so:</p>\n\n<pre><code>struct foo fa, fb;\nfa.value = 47;\nfa.list.le_next = &amp;fb;\nfa.list.le_prev = NULL;\nfb.value = 11;\nfb.list.le_next = NULL;\nfb.list.le_prev = &amp;fa.list.le_next;\n</code></pre>\n\n<p>I'm not 100% sure about the last line, but I think it kind of makes sense.</p>\n"}], "owner": {"reputation": 109, "user_id": 5104947, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b0897398c4b473adce244a650f5cc36?s=128&d=identicon&r=PG&f=1", "display_name": "epoxxy", "link": "https://stackoverflow.com/users/5104947/epoxxy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 1, "accepted_answer_id": 41983549, "answer_count": 2, "score": 5, "last_activity_date": 1486052128, "creation_date": 1485962803, "last_edit_date": 1486052128, "question_id": 41983469, "link": "https://stackoverflow.com/questions/41983469/c-programming-define-struct-declaring", "title": "c programming #define struct { } declaring", "body": "<p>I was looking at Glibc codes. Some codes of glibc's queue caught my attention. I couldn't give a meaning to this struct definition. This struct doesn't have a name. Why? How does it work?</p>\n\n<pre><code>#define LIST_ENTRY(type)                        \\\nstruct {                                \\\n    struct type *le_next;   /* next element */          \\\n    struct type **le_prev;  /* address of previous next element */  \\\n}\n</code></pre>\n\n<p><a href=\"https://github.com/lattera/glibc/blob/master/misc/sys/queue.h#L92\" rel=\"nofollow noreferrer\">Source</a></p>\n"}, {"tags": ["c", "audio", "ms-media-foundation", "mft"], "comments": [{"owner": {"reputation": 64286, "user_id": 868014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PoaTp.png?s=128&g=1", "display_name": "Roman R.", "link": "https://stackoverflow.com/users/868014/roman-r"}, "edited": false, "score": 1, "creation_date": 1485964530, "post_id": 41983374, "comment_id": 71145962, "body": "At least, <code>pdwStatus</code> thing is not okay. You should have <code>DWORD dwStatus</code> variable and <code>&amp;dwStatus</code> as the argument."}, {"owner": {"reputation": 1778, "user_id": 2440728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1fWyQ.jpg?s=128&g=1", "display_name": "VuVirt", "link": "https://stackoverflow.com/users/2440728/vuvirt"}, "edited": false, "score": 1, "creation_date": 1485979384, "post_id": 41983374, "comment_id": 71154738, "body": "@Alex Telon Try to ZeroMemory the pOutputSamples prior to pOutputSamples[0].pSample = pOutSample; call. Have you also checked if the value of pStreamInfo-&gt;cbSize is not 0?"}, {"owner": {"reputation": 817, "user_id": 1723886, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/28aed430fc37a11b744c6fa5ab677120?s=128&d=identicon&r=PG", "display_name": "Alex Telon", "link": "https://stackoverflow.com/users/1723886/alex-telon"}, "reply_to_user": {"reputation": 64286, "user_id": 868014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PoaTp.png?s=128&g=1", "display_name": "Roman R.", "link": "https://stackoverflow.com/users/868014/roman-r"}, "edited": false, "score": 0, "creation_date": 1486029239, "post_id": 41983374, "comment_id": 71174532, "body": "@RomanR. yes, thanks an obvious error now that you mention it!  I no longer get the E_INVALIDARG error but now a E_FAIL which I have to dig into. But your answer solved the problem. If you add it as an answer I can accept it."}, {"owner": {"reputation": 817, "user_id": 1723886, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/28aed430fc37a11b744c6fa5ab677120?s=128&d=identicon&r=PG", "display_name": "Alex Telon", "link": "https://stackoverflow.com/users/1723886/alex-telon"}, "reply_to_user": {"reputation": 1778, "user_id": 2440728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1fWyQ.jpg?s=128&g=1", "display_name": "VuVirt", "link": "https://stackoverflow.com/users/2440728/vuvirt"}, "edited": false, "score": 0, "creation_date": 1486030243, "post_id": 41983374, "comment_id": 71175187, "body": "Thanks @VuVirt Though Roman&#39;s answer fixed the issue, I tried what you suggested in case I had missed something more. I tried <code>ZeroMemory(pOutputSamples, sizeof(MFT_OUTPUT_DATA_BUFFER))</code>, but no change in behaviour.  pStreamInfo-&gt;cbSize is <code>0x0000c000</code>, dwFlags is <code>MFT_OUTPUT_STREAM_WHOLE_SAMPLES</code> and cbAlignment is <code>0</code>."}], "answers": [{"tags": [], "owner": {"reputation": 64286, "user_id": 868014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PoaTp.png?s=128&g=1", "display_name": "Roman R.", "link": "https://stackoverflow.com/users/868014/roman-r"}, "is_accepted": true, "score": 2, "last_activity_date": 1486038167, "creation_date": 1486038167, "answer_id": 42002195, "question_id": 41983374, "link": "https://stackoverflow.com/questions/41983374/imftransformprocessoutput-returns-e-invalidarg/42002195#42002195", "title": "IMFTransform::ProcessOutput returns E_INVALIDARG", "body": "<p><code>ProcessOutput</code> needs a valid pointer as the last argument, so this does not work:</p>\n\n<pre><code>DWORD *pdwStatus = NULL;\npDecoder-&gt;lpVtbl-&gt;ProcessOutput(..., pdwStatus);\n</code></pre>\n\n<p>This is okay:</p>\n\n<pre><code>DWORD dwStatus;\npDecoder-&gt;lpVtbl-&gt;ProcessOutput(..., &amp;dwStatus);\n</code></pre>\n\n<p>Regarding further <code>E_FAIL</code> - your findings above, in general, looks good. It is not that I see something obvious, and also the error code does not suggest that the problem is with MFT data flow. Perhaps it could be bad data or data not matching media types set. </p>\n"}], "owner": {"reputation": 817, "user_id": 1723886, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/28aed430fc37a11b744c6fa5ab677120?s=128&d=identicon&r=PG", "display_name": "Alex Telon", "link": "https://stackoverflow.com/users/1723886/alex-telon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 0, "accepted_answer_id": 42002195, "answer_count": 1, "score": 2, "last_activity_date": 1486038193, "creation_date": 1485962572, "last_edit_date": 1486038193, "question_id": 41983374, "link": "https://stackoverflow.com/questions/41983374/imftransformprocessoutput-returns-e-invalidarg", "title": "IMFTransform::ProcessOutput returns E_INVALIDARG", "body": "<h1>The problem</h1>\n\n<p>I am trying to get call <code>ProcessOutput</code> to get decoded data from my decoder and get the following error:</p>\n\n<blockquote>\n  <p><code>E_INVALIDARG</code> One or more arguments are invalid.</p>\n</blockquote>\n\n<h1>What I have tried</h1>\n\n<p>As <code>ProcessOutput</code> has many arguments I have tried to pinpoint what the error might be. <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms704014(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Documentation for <code>ProcessOutput</code></a> does not mention <code>E_INVALIDARG</code>. However, the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms697247(v=vs.85).aspx\" rel=\"nofollow noreferrer\">documentation for <code>MFT_OUTPUT_DATA_BUFFER</code></a>, the datatype for one of the arguments, mentions in its Remarks section that:</p>\n\n<blockquote>\n  <p>Any other combinations are invalid and cause <code>ProcessOutput</code> to return <code>E_INVALIDARG</code></p>\n</blockquote>\n\n<p>What it talks about there is how the <code>MFT_OUTPUT_DATA_BUFFER</code> struct is setup. So an incorrectly setup <code>MFT_OUTPUT_DATA_BUFFER</code> might cause that error. I have however tried to set it up correctly. </p>\n\n<p>By calling GetOutputStreamInfo I find that I need to allocate the sample sent to ProcessOutput which is what I do. I'm using pretty much the same method that worked for ProcessInput so I don't know what I am doing wrong here.</p>\n\n<p>I have also tried to make sure that the other arguments, who logically should also be able to cause an <code>E_INVALIDARG</code>. They look good to me and I have not been able to find any other leads to which of my arguments to <code>ProcessOutput</code> might be invalid.</p>\n\n<h1>The code</h1>\n\n<p>I have tried to post only the relevant parts of the code below. I have removed or shortened many of the error checks for brevity. Note that I am using plain C.</p>\n\n<h3>\"Prelude\"</h3>\n\n<pre class=\"lang-c prettyprint-override\"><code>...\nhr = pDecoder-&gt;lpVtbl-&gt;SetOutputType(pDecoder, dwOutputStreamID, pMediaOut, dwFlags);\n...\n// Send input to decoder\nhr = pDecoder-&gt;lpVtbl-&gt;ProcessInput(pDecoder, dwInputStreamID, pSample, dwFlags);\nif (FAILED(hr)) { /* did not fail */ }\n</code></pre>\n\n<p>So before the interesting code below I have successfully setup things (I hope) and sent them to ProcessInput which did not fail. I have 1 input stream and 1 output stream, AAC in, PCM out.</p>\n\n<h3>Code directly leading to the error</h3>\n\n<pre class=\"lang-c prettyprint-override\"><code>// Input has now been sent to the decoder\n// To extract a sample from the decoder we need to create a strucure to hold the output\n// First we ask the OutputStream for what type of output sample it will produce and who should allocate it\n// Then we create both the sample in question (if we should allocate it that is) and the MFT_OUTPUT_DATA_BUFFER\n// which holds the sample and some other information that the decoder will fill in.\n\n#define SAMPLES_PER_BUFFER 1 // hardcoded here, should depend on GetStreamIDs results, which right now is 1\n\nMFT_OUTPUT_DATA_BUFFER pOutputSamples[SAMPLES_PER_BUFFER];\nDWORD *pdwStatus = NULL;\n\n// There are different allocation models, find out which one is required here.\nMFT_OUTPUT_STREAM_INFO streamInfo = { 0,0,0 };\nMFT_OUTPUT_STREAM_INFO *pStreamInfo = &amp;streamInfo;\n\nhr = pDecoder-&gt;lpVtbl-&gt;GetOutputStreamInfo(pDecoder, dwOutputStreamID, pStreamInfo);\nif (FAILED(hr)) { ... }\n\nif (pStreamInfo-&gt;dwFlags == MFT_OUTPUT_STREAM_PROVIDES_SAMPLES) { ... }\nelse if (pStreamInfo-&gt;dwFlags == MFT_OUTPUT_STREAM_CAN_PROVIDE_SAMPLES) { ... }\nelse {  \n    // default, the client must allocate the output samples for the stream\n    IMFSample *pOutSample = NULL;\n    DWORD minimumSizeOfBuffer = pStreamInfo-&gt;cbSize;\n    IMFMediaBuffer *pBuffer = NULL;\n\n    // CreateMediaSample is explained further down. \n    hr = CreateMediaSample(minimumSizeOfBuffer, sampleDuration, &amp;pBuffer, &amp;pOutSample);\n        if (FAILED(hr)) {\n            BGLOG_ERROR(\"error\");\n        }\n\n    pOutputSamples[0].pSample = pOutSample;\n}\n\n// since GetStreamIDs return E_NOTIMPL then dwStreamID does not matter\n// but its recomended that it is set to the array index, 0 in this case.\n// dwOutputStreamID will be 0 when E_NOTIMPL is returned by GetStremIDs\npOutputSamples[0].dwStreamID = dwOutputStreamID; // = 0\npOutputSamples[0].dwStatus = 0;\npOutputSamples[0].pEvents = NULL; // have tried init this myself, but MFT_OUTPUT_DATA_BUFFER documentation says not to.\n\nhr = pDecoder-&gt;lpVtbl-&gt;ProcessOutput(pDecoder, dwFlags, outputStreamCount, pOutputSamples, pdwStatus);\nif (FAILED(hr)) {\n    // here E_INVALIDARG is found.\n}\n</code></pre>\n\n<p>CreateMediaSample that is used in the code is derived from <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb530106(v=vs.85).aspx\" rel=\"nofollow noreferrer\">an example</a> from the official documentation but modified to call SetSampleDuration and SetSampleTime. I get the same error by not setting those two though so it should be something else causing the problem.</p>\n\n<h3>Some of the actual data that was sent to ProcessOutput</h3>\n\n<p>In case I might have missed something which is easy to see from the actual data:\n</p>\n\n<pre><code>hr = pDecoder-&gt;lpVtbl-&gt;ProcessOutput(\n    pDecoder, // my decoder\n    dwFlags, // 0\n    outputStreamCount, // 1 (from GetStreamCount)\n    pOutputSamples, // se comment below\n    pdwStatus // NULL\n);\n// pOutputSamples[0] holds this struct:\n// dwStreamID = 0, \n// pSample = SampleDefinedBelow \n// dwStatus = 0, \n// pEvents = NULL\n\n// SampleDefinedBelow:\n// time = 0\n// duration = 0.9523..\n// buffer = with max length set correctly \n// attributes[] = NULL\n</code></pre>\n\n<h1>Question</h1>\n\n<p>So anyone have any ideas on what I am doing wrong or how I could debug this further?</p>\n"}, {"tags": ["c#", "c", "shared-libraries", "artoolkit", "nm"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1485961090, "post_id": 41982796, "comment_id": 71143347, "body": "Just because something is stored in the text segment doesn&#39;t automatically mean it&#39;s a function or some code. Compile-time constants usually also end up in the text segment, as does e.g. string literals."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 2, "creation_date": 1485961279, "post_id": 41982796, "comment_id": 71143485, "body": "I don&#39;t see any symbols here appearing twice. <code>Java_org_artoolkit_ar_base_NativeInterface_arwCapture</code> and <code>arwCapture</code> are two wildly different symbols. The output does not mention any <code>arwAcceptVideoImage</code> symbol, so it&#39;s quite natural you cannot call it,"}, {"owner": {"reputation": 1953, "user_id": 1609929, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Bvq1G.jpg?s=128&g=1", "display_name": "Jethro", "link": "https://stackoverflow.com/users/1609929/jethro"}, "edited": false, "score": 0, "creation_date": 1485961855, "post_id": 41982796, "comment_id": 71143896, "body": "Thanks, so the distinction is the ones that appear twice are defined as both functions and JNI calls, but the one that appears once is only defined as a JNI call.  Makes sense now, thankyou!"}], "answers": [{"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 1, "last_activity_date": 1485961089, "creation_date": 1485961089, "answer_id": 41982859, "question_id": 41982796, "link": "https://stackoverflow.com/questions/41982796/nm-shared-library-symbol-appearing-twice-or-once/41982859#41982859", "title": "nm: shared library symbol appearing twice or once", "body": "<p>In the posted output from <code>nm</code> there is no evidence of what you state (<em><code>arwCapture()</code> does not appear twice</em>). One is the JNI function which is surely a wrapper that calls <code>arwCapture()</code> at some point.</p>\n\n<p>Presumably <code>arwCapture()</code> is a c function which is why you can call it from C#, but in the shared object, there is no <code>arwAcceptVideoImage()</code> anywhere although there is a Java <code>arwAcceptVideoImage()</code> method defined.</p>\n\n<p>If this shared object is intended as a JNI object, you should avoid calling it from another language but Java. Instead find the original library and use it.</p>\n"}], "owner": {"reputation": 1953, "user_id": 1609929, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Bvq1G.jpg?s=128&g=1", "display_name": "Jethro", "link": "https://stackoverflow.com/users/1609929/jethro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 41982859, "answer_count": 1, "score": 0, "last_activity_date": 1485963360, "creation_date": 1485960928, "last_edit_date": 1485963360, "question_id": 41982796, "link": "https://stackoverflow.com/questions/41982796/nm-shared-library-symbol-appearing-twice-or-once", "title": "nm: shared library symbol appearing twice or once", "body": "<p>I have a shared library (<em>libARWrapper.so</em>) which includes the following two entries, shown using nm (<em>nm -D --defined-only libARWrapper.so</em>)</p>\n\n\n\n<pre class=\"lang-none prettyprint-override\"><code>00075854 T Java_org_artoolkit_ar_base_NativeInterface_arwAcceptVideoImage\n00074d54 T Java_org_artoolkit_ar_base_NativeInterface_arwCapture\n...\n00072d54 T arwCapture\n</code></pre>\n\n<p>I know that <a href=\"https://sourceware.org/binutils/docs/binutils/nm.html\" rel=\"nofollow noreferrer\">T means</a> \"The symbol is in the text (code) section.\"</p>\n\n<p><strong>What is the distinction between arwCapture appearing twice, and arwAcceptVideoImage, which appears only once.</strong></p>\n\n<p>I am able to call <em>arwCapture</em> from a C# DllImport, but not <em>arwAcceptVideoImage</em>.<br>\nThere are also many other functions appearing the same as arwCapture, all under org.artoolkit.ar.bash.NativeInterface, which I can use OK.<br>\nOther (Java) code is able to call all functions through the NDK.</p>\n"}, {"tags": ["c++", "c", "boost", "c-preprocessor", "boost-preprocessor"], "comments": [{"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 0, "creation_date": 1485960999, "post_id": 41982791, "comment_id": 71143290, "body": "Why not a single sequence of tuples? E.g. <code>((int, AddInt), (double, AddDouble))</code>..."}, {"owner": {"reputation": 1893, "user_id": 6153683, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/433c8247303c42b6fe5cef5821f79a5a?s=128&d=identicon&r=PG", "display_name": "skgbanga", "link": "https://stackoverflow.com/users/6153683/skgbanga"}, "reply_to_user": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 0, "creation_date": 1485961274, "post_id": 41982791, "comment_id": 71143483, "body": "I actually have 3-4 sequences and I have read this question: <a href=\"http://stackoverflow.com/questions/26475453/how-to-use-boostpreprocessor-to-unzip-a-sequence\" title=\"how to use boostpreprocessor to unzip a sequence\">stackoverflow.com/questions/26475453/&hellip;</a>  I guess this potentially can be done, but was wondering if there is a way for iterating over multiple sequences because those macros sequences are already defined."}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1485961417, "post_id": 41982791, "comment_id": 71143589, "body": "A quick search shows me there&#39;s a library out there with a zip macro: <a href=\"https://github.com/mcinglis/libpp/blob/master/zip.h\" rel=\"nofollow noreferrer\">github.com/mcinglis/libpp/blob/master/zip.h</a>"}], "answers": [{"tags": [], "owner": {"reputation": 14872, "user_id": 3919155, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/3034f14bf0b65847592b2c2e08b9253e?s=128&d=identicon&r=PG&f=1", "display_name": "jotik", "link": "https://stackoverflow.com/users/3919155/jotik"}, "is_accepted": true, "score": 5, "last_activity_date": 1485975197, "last_edit_date": 1495542258, "creation_date": 1485964903, "answer_id": 41984254, "question_id": 41982791, "link": "https://stackoverflow.com/questions/41982791/how-to-iterate-over-two-boost-preprocessor-sequences-at-the-same-time/41984254#41984254", "title": "How to iterate over two Boost Preprocessor sequences at the same time?", "body": "<p>You could use <a href=\"http://www.boost.org/doc/libs/1_62_0/libs/preprocessor/doc/ref/seq_for_each_i.html\" rel=\"nofollow noreferrer\"><code>BOOST_PP_SEQ_FOR_EACH_I</code></a> and <a href=\"http://www.boost.org/doc/libs/1_62_0/libs/preprocessor/doc/ref/seq_elem.html\" rel=\"nofollow noreferrer\"><code>BOOST_PP_SEQ_ELEM</code></a> to do it as follows:</p>\n\n<pre><code>#include &lt;boost/preprocessor/seq/elem.hpp&gt;\n#include &lt;boost/preprocessor/seq/for_each_i.hpp&gt;\n\n#define types (int)(double)\n#define funcs (AddInt)(AddDouble)\n\n#define MACRO(_,funcs,i,type) \\\n    void add(type val) { obj.BOOST_PP_SEQ_ELEM(i, funcs)(val); }\n\nBOOST_PP_SEQ_FOR_EACH_I(MACRO, funcs, types)\n</code></pre>\n\n<p>The <code>BOOST_PP_SEQ_FOR_EACH_I</code> macro iterates over the sequence <code>types</code>, applying <code>MACRO</code> to each element. The second argument to <code>BOOST_PP_SEQ_FOR_EACH_I</code> is passed as the second argument to each invocation of <code>MACRO</code>, and <code>i</code> denotes the zero-based index of the current element being iterated over. Therefore, when <code>MACRO</code> is being expanded, <code>type</code> is the <code>i</code>-th element of <code>types</code> and <code>BOOST_PP_SEQ_ELEM(i, funcs)</code> is the <code>i</code>-th element of <code>funcs</code>.</p>\n\n<p>For a more general solution, you can do something like:</p>\n\n<pre><code>#define ITERATE_OVER_TWO_SEQ_(_,data,i,e2) \\\n   BOOST_PP_SEQ_ELEM(0,data)(BOOST_PP_SEQ_ELEM(i, BOOST_PP_SEQ_ELEM(1,data)), e2)\n#define ITERATE_OVER_TWO_SEQ(macro, s1, s2) \\\n    BOOST_PP_SEQ_FOR_EACH_I(ITERATE_OVER_TWO_SEQ_, (macro)(s1), s2)\n</code></pre>\n\n<p>and use it as follows:</p>\n\n<pre><code>#define MACRO(type,func) void add(type val) { obj.func(val); }\nITERATE_OVER_TWO_SEQ(MACRO, types, funcs)\n</code></pre>\n\n<p>An even more generic way would be to use <code>SEQ_ZIP</code> from <a href=\"https://stackoverflow.com/a/41987223/3919155\">this answer</a>, <code>BOOST_PP_SEQ_FOR_EACH</code> and <code>BOOST_PP_SEQ_ELEM</code>. For example:</p>\n\n<pre><code>#include &lt;boost/preprocessor/seq/for_each.hpp&gt;\n#define MACRO(_,d,seq) \\\n    void add(BOOST_PP_SEQ_ELEM(0,seq) val) \\\n    { obj.BOOST_PP_SEQ_ELEM(1, seq)(val); }\n\nBOOST_PP_SEQ_FOR_EACH(MACRO, _, SEQ_ZIP((types)(funcs))\n</code></pre>\n"}], "owner": {"reputation": 1893, "user_id": 6153683, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/433c8247303c42b6fe5cef5821f79a5a?s=128&d=identicon&r=PG", "display_name": "skgbanga", "link": "https://stackoverflow.com/users/6153683/skgbanga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 797, "favorite_count": 1, "accepted_answer_id": 41984254, "answer_count": 1, "score": 5, "last_activity_date": 1485975197, "creation_date": 1485960915, "last_edit_date": 1485965726, "question_id": 41982791, "link": "https://stackoverflow.com/questions/41982791/how-to-iterate-over-two-boost-preprocessor-sequences-at-the-same-time", "title": "How to iterate over two Boost Preprocessor sequences at the same time?", "body": "<p>I was wondering if the following can be done via Boost Preprocessor sequences. (Most of the SO questions as well as Boost Preprocessor examples talk about only 1 sequence)</p>\n\n<pre><code>#define seq1 (a)(b)(c)\n#define seq2 (1)(2)(3)\n\n// Now iterate over both of them at the same time\n</code></pre>\n\n<p>Here is my motivation. I have to define few functions for a lot of types e.g.</p>\n\n<pre><code>void add(int val) { obj.AddInt(val); }\nvoid add(double val) { obj.AddDouble(val); }\n</code></pre>\n\n<p>I was thinking of defining two sequences like</p>\n\n<pre><code>#define types (int)(double)...\n#define funcs (AddInt)(AddDouble)...\n</code></pre>\n\n<p>and then write a macro for the function add, and iterate over the two sequences.</p>\n"}, {"tags": ["c", "variables", "types"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485960631, "post_id": 41982615, "comment_id": 71143005, "body": "Try <code>int size = 0; uint8_t * address = take_picture(&amp; size);</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1485960692, "post_id": 41982615, "comment_id": 71143052, "body": "If you want to convert a pointer to an integer (why BTW?), its type should be <code>uintptr_t</code>."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1485960816, "post_id": 41982615, "comment_id": 71143140, "body": "@EugeneSh. There are legitimate cases where this is useful, for example to pass it to a Java class method from and to JNI."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1485960855, "post_id": 41982615, "comment_id": 71143164, "body": "@IharobAlAsimi I know there are. Not sure about this specific case."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 6, "creation_date": 1485960900, "post_id": 41982615, "comment_id": 71143206, "body": "Do <b>not</b> use casts if you don&#39;t understand them. Why don&#39;t you use the correct types? Your code invokes undefined behaviour."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1485960958, "post_id": 41982615, "comment_id": 71143253, "body": "Whyever would you intentionally choose to use data types that disagree with the function declaration in the first place?  Casts are occasionally appropriate, but they are far more often a sign that you&#39;re doing something wrong."}, {"owner": {"reputation": 67, "user_id": 5065678, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/03599bf4c3c9a50b8f28f86c3b3e031d?s=128&d=identicon&r=PG&f=1", "display_name": "riverrock", "link": "https://stackoverflow.com/users/5065678/riverrock"}, "edited": false, "score": 0, "creation_date": 1485964314, "post_id": 41982615, "comment_id": 71145794, "body": "Hi - I updated my question to be more specific."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1485965227, "post_id": 41982615, "comment_id": 71146497, "body": "Do you really want an address, or just a pointer to the array contents?"}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1486034984, "post_id": 41984248, "comment_id": 71178351, "body": "<i>unsigned int address; //it is capable of storing a pointer size.</i>  No, it is <b>NOT</b>.  That <i>may</i> work on older architectures.  That will fail on <a href=\"https://en.wikipedia.org/wiki/64-bit_computing#64-bit_data_models\" rel=\"nofollow noreferrer\">every common 64-bit architecture currently extant</a>.  Never try to put a pointer value into an <code>int</code>."}], "tags": [], "owner": {"reputation": 58, "user_id": 7494554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed12177ac7f1ba52ae06ec3e5935771?s=128&d=identicon&r=PG&f=1", "display_name": "Kaushik Thakrar", "link": "https://stackoverflow.com/users/7494554/kaushik-thakrar"}, "is_accepted": false, "score": -1, "last_activity_date": 1486033896, "last_edit_date": 1486033896, "creation_date": 1485964892, "answer_id": 41984248, "question_id": 41982615, "link": "https://stackoverflow.com/questions/41982615/c-program-unsigned-int-or-uint8-t/41984248#41984248", "title": "c program unsigned int or uint8_t", "body": "<p>unsigned int size; // As the image size is always positive and is large.</p>\n\n<p>uintptr_t address; // if this is available in stdint.h</p>\n\n<p>or </p>\n\n<p>unsigned int address; //it is capable of storing a pointer size.</p>\n\n<p>address = take_picture(&amp;size); //take_picture if returns uintptr_t</p>\n\n<p>If you do not know what take_picture returns, then you cast it like what you have done:</p>\n\n<p>address = (unsigned *int)take_picture(&amp; size);</p>\n"}, {"comments": [{"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 1, "creation_date": 1485965345, "post_id": 41984354, "comment_id": 71146574, "body": "I think the 2nd one should take a <code>uint8_t**</code> rather than a <code>uint8_t*</code> so that <code>*picture</code> will point to whatever was allocated."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 1, "creation_date": 1486019693, "post_id": 41984354, "comment_id": 71169097, "body": "@Kevin It isn&#39;t obvious what the function does. &quot;The function will make a camera take a picture and store the data in an array&quot; could mean anything. It is best to leave allocation to the caller if that&#39;s an option."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1485965214, "creation_date": 1485965214, "answer_id": 41984354, "question_id": 41982615, "link": "https://stackoverflow.com/questions/41982615/c-program-unsigned-int-or-uint8-t/41984354#41984354", "title": "c program unsigned int or uint8_t", "body": "<blockquote>\n  <p>My question is what would be the correct/logical data types for the function return type and the argument? considering that they store an address and size of an array? </p>\n</blockquote>\n\n<p>The function return type should be a pointer to an array item. If it is an array of <code>uint8_t</code>, then the return type should be <code>uint8_t*</code>. This is also the most correct/safe type for an array of bytes (\"raw data\").</p>\n\n<p>The most correct type used to describe the size of an array is <code>size_t</code>, an unsigned integer type that exists specifically for this purpose, and is guaranteed portably to be large enough to hold an array size of the given system.</p>\n\n<pre><code>uint8_t* take_picture (size_t* piclength);\n</code></pre>\n\n<p>or alternatively</p>\n\n<pre><code>void take_picture (uint8_t* picture, size_t* piclength);\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 5065678, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/03599bf4c3c9a50b8f28f86c3b3e031d?s=128&d=identicon&r=PG&f=1", "display_name": "riverrock", "link": "https://stackoverflow.com/users/5065678/riverrock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 760, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1486033896, "creation_date": 1485960463, "last_edit_date": 1485964272, "question_id": 41982615, "link": "https://stackoverflow.com/questions/41982615/c-program-unsigned-int-or-uint8-t", "title": "c program unsigned int or uint8_t", "body": "<p>I am writing a function called <code>take_picture()</code>. The function will make a camera take a picture and store the data in an array.</p>\n\n<p>I want the function to return the address where the array is located and to return the size of the array.</p>\n\n<p>So this is my function declaration:</p>\n\n<pre><code>uint8_t * take_picture(int *piclength)\n</code></pre>\n\n<p>My question is what would be the correct/logical data types for the function return type and the argument? considering that they store an address and size of an array? Does a <code>uint8_t</code> and <code>int</code> make sense?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "linux", "operating-system", "fork"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 6, "creation_date": 1485960160, "post_id": 41982472, "comment_id": 71142709, "body": "Draw a graph, spawning with a square for each process."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1485960692, "post_id": 41982472, "comment_id": 71143054, "body": "We are not a quiz-site. State your problem, what you expect and why."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 4, "creation_date": 1485960818, "post_id": 41982472, "comment_id": 71143142, "body": "Note that if <code>fork()</code> returns <code>-1</code>, that&#39;s also considered true in C."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1485968427, "post_id": 41982472, "comment_id": 71148558, "body": "Draw a directed graph, representing the start, forks, and end as nodes, and the execution paths as weighted edges, the weight being the number of processes that follow that path. The &#39;start&#39; node has a single output edge with weight 1. A &#39;fork&#39; node has one or more input edges and two output edges. Set the weight of each output edge to the sum of the weights of the input edges. The &#39;end&#39; node has one or more input edges. The sum of the weights of the input edges at the &#39;end&#39; is the total number of processes. Subtract 1 to get the number of spawned processes (not counting the original process)."}], "answers": [{"tags": [], "owner": {"reputation": 34, "user_id": 7449344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca65a07ac4dfc676ad6dbc19cc28b2e8?s=128&d=identicon&r=PG&f=1", "display_name": "sivasathish", "link": "https://stackoverflow.com/users/7449344/sivasathish"}, "is_accepted": false, "score": 0, "last_activity_date": 1485974009, "creation_date": 1485974009, "answer_id": 41987104, "question_id": 41982472, "link": "https://stackoverflow.com/questions/41982472/what-is-the-number-of-processes-that-the-following-code-will-create/41987104#41987104", "title": "What is the number of processes that the following code will create?", "body": "<pre><code>We have to validate fork return values. Actually based on return only we can able to check no of process on your program.\n\n\nfork Return Value :\n\n-1                  =&gt; Failure.\n0                   =&gt; Return value for child process.\nChild process id    =&gt; Return value for parent process.\n</code></pre>\n"}], "owner": {"reputation": 681, "user_id": 5594633, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/df57cddb88cae749606d7f67da0b84f6?s=128&d=identicon&r=PG&f=1", "display_name": "kauray", "link": "https://stackoverflow.com/users/5594633/kauray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1485974009, "creation_date": 1485960088, "question_id": 41982472, "link": "https://stackoverflow.com/questions/41982472/what-is-the-number-of-processes-that-the-following-code-will-create", "title": "What is the number of processes that the following code will create?", "body": "<p>What will be the total number of processes that are spawned by the following code?</p>\n\n<pre><code>if(fork() &amp;&amp; fork()){\n    fork();\n}\n\nif(fork() ||fork()){\n    fork();\n    fork();\n}\n</code></pre>\n\n<p>AND would behave as a short circuit operator, thus the second fork would only be executed for the parent and not the child. How to proceed after that?</p>\n"}, {"tags": ["c++", "c", "macros"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 3, "creation_date": 1485958594, "post_id": 41981928, "comment_id": 71141622, "body": "avoid training semicolon in your macro definition."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1485958610, "post_id": 41981928, "comment_id": 71141634, "body": "<code>printf</code> doesn&#39;t recursively format strings"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1485958633, "post_id": 41981928, "comment_id": 71141655, "body": "Macros and <code>printf</code> tend to be very C-oriented and less C++. Please try to refrain to add language tags that you don&#39;t actually use. If you&#39;re programming in C then don&#39;t add the C++ even if the solution or the code could be used in C++."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1485958672, "post_id": 41981928, "comment_id": 71141676, "body": "As for a solution to your problem, consider using a two-step process: One to format the output according to your arguments, and then one to actually print the output."}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 2, "creation_date": 1485958706, "post_id": 41981928, "comment_id": 71141711, "body": "However, considering this is C++, how about taking advantage of a library like <a href=\"https://github.com/fmtlib/fmt\" rel=\"nofollow noreferrer\">fmt</a> that offers proper type safety?"}, {"owner": {"reputation": 1962, "user_id": 2789815, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XkN7a.png?s=128&g=1", "display_name": "scx", "link": "https://stackoverflow.com/users/2789815/scx"}, "edited": false, "score": 0, "creation_date": 1485958943, "post_id": 41981928, "comment_id": 71141851, "body": "Thx Jean-Francois Fabre, I do not make macros often. For libraries and such, I have specific requirements that means I am coding in the c++ language only, no stl, no libraries."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1485959290, "post_id": 41981928, "comment_id": 71142096, "body": "But <code>printf</code> <i>is</i> part of the standard library. What is the reason you then can&#39;t use the rest of the standard library (since it will be linked in with whatever application your building anyway)? If you program in C++, then your life will be so much easier if you use the standard facilities that come with the language."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1485960159, "post_id": 41981928, "comment_id": 71142708, "body": "@scx, I&#39;m not following what you&#39;re willing to use and what not.  Are you trying to say that you are actually writing C, <i>which is a different language from C++</i>?  Or are you perhaps saying that you are restricting yourself to the common subset of C and C++?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1485965428, "post_id": 41981928, "comment_id": 71146634, "body": "@scx, writing for the common subset of C and C++ is <i>very different</i> and considerably more difficult than writing normally for either one language or the other.  The reason these comments went the direction they did is largely that the question does not clearly state the true question."}], "answers": [{"tags": [], "owner": {"reputation": 471, "user_id": 5592711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Ctul.jpg?s=128&g=1", "display_name": "A. Monti", "link": "https://stackoverflow.com/users/5592711/a-monti"}, "is_accepted": true, "score": 0, "last_activity_date": 1485965391, "creation_date": 1485965391, "answer_id": 41984418, "question_id": 41981928, "link": "https://stackoverflow.com/questions/41981928/string-variable-expansion-in-debug-macro/41984418#41984418", "title": "String variable expansion in debug macro", "body": "<p>I think you're looking to define a macro prepending some debugging information to your formatted log.</p>\n\n<p>To achieve this, you can use the following macro :</p>\n\n<pre><code>#define LOG(format, ...) \\\nprintf(\"%s(%d) : %s() \" format, __FILE__, __LINE__, __FUNCTION__, ##__VA_ARGS__)\n</code></pre>\n\n<p>This way <code>LOG(\"%d\", 123)</code> will expand to <code>printf(\"%s(%d) : %s() \" \"%s\", __FILE__, __LINE__, __FUNCTION__, 123)</code>.\nAs consecutive string literals are merged (<code>\"a\" \"b\"</code> is equivalent to <code>\"ab\"</code>), the <code>printf</code> format is correctly built.</p>\n\n<p>Also note the use of <code>, ## __VA_ARGS__</code>. This is a GNU extension (see <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Variadic-Macros.html\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/cpp/Variadic-Macros.html</a>) that allows empty variadic arguments.</p>\n\n<p>This technique will however fail if <code>format</code> is not a string literal.\nSee an example here : <a href=\"http://ideone.com/gMnaES\" rel=\"nofollow noreferrer\">http://ideone.com/gMnaES</a></p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1485976948, "last_edit_date": 1485976948, "creation_date": 1485966073, "answer_id": 41984642, "question_id": 41981928, "link": "https://stackoverflow.com/questions/41981928/string-variable-expansion-in-debug-macro/41984642#41984642", "title": "String variable expansion in debug macro", "body": "<p>It seems to me that you're trying to cram too much into one <code>printf()</code> call.  You don't need to do that.  In particular, to support usage such as your first example:</p>\n\n<blockquote>\n<pre><code>OUTPUT_ERROR(\"%s was broken\", my_var);\n</code></pre>\n</blockquote>\n\n<p>you could easily split the output over multiple <code>printf()</code> calls with a macro like this:</p>\n\n<pre><code>#define OUTPUT_ERROR(...) do { \\\n  printf(\"%s(%d) : %s() : \", __FILE__, __LINE__, __func__); \\\n  printf(__VA_ARGS__); \\\n  putchar('\\n'); \\\n} while (0)\n</code></pre>\n"}], "owner": {"reputation": 1962, "user_id": 2789815, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XkN7a.png?s=128&g=1", "display_name": "scx", "link": "https://stackoverflow.com/users/2789815/scx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 41984418, "answer_count": 2, "score": -1, "last_activity_date": 1485976948, "creation_date": 1485958507, "last_edit_date": 1485965578, "question_id": 41981928, "link": "https://stackoverflow.com/questions/41981928/string-variable-expansion-in-debug-macro", "title": "String variable expansion in debug macro", "body": "<p>I am trying to write a debug macro in the common subset of C and C++.  This is what I've come up with so far:</p>\n\n<pre><code>#define OUTPUT_ERROR(...) printf(\"%s(%d) : %s() : %s\\n\", __FILE__, __LINE__, __func__, #__VA_ARGS__)\n</code></pre>\n\n<p>Unfortunately, I cannot figure out how to give it variables to output. Is there any way to force a variable to be expanded at runtime? For example:</p>\n\n<pre><code>OUTPUT_ERROR(\"%s was broken\", my_var);\n</code></pre>\n\n<p>or simply in place</p>\n\n<pre><code>OUTPUT_ERROR(my_var + \"some text\");\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15105, "user_id": 3768871, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Wxgi0.jpg?s=128&g=1", "display_name": "OmG", "link": "https://stackoverflow.com/users/3768871/omg"}, "edited": false, "score": 3, "creation_date": 1485957611, "post_id": 41981565, "comment_id": 71140943, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/11888528/how-to-take-command-line-argument-in-codeblock-10-05\">How to take command line argument in Codeblock 10.05?</a>"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1485957791, "post_id": 41981565, "comment_id": 71141047, "body": "Don&#39;t use <code>sscanf()</code> for that. Use <code>strtol()</code> and check the <code>endptr</code> to confirm that it was a valid integer or to find out if it wasn&#39;t. Try to compile from the command line. You see, you say command line but you are not using it, you are using an IDE. I am sure that you can set them in the IDE so that it passes the parameters when it executes the program. But it would be much simpler if you compile from the command line like <code>gcc -Wall -Werror -O0 -g3 my_source.c -o my_executable &amp;&amp; .&#47;my_executable</code>."}], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1485958079, "post_id": 41981723, "comment_id": 71141249, "body": "Except if the program is invoked with <code>exec()</code> from another program where you can decide what the first parameter will be. It&#39;s normally the program name or more precisely the value used in the command line. For instance if you call the program with the absolute path the path will be included in <code>argv[0]</code>."}, {"owner": {"reputation": 11, "user_id": 7441878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/shSFJ.jpg?s=128&g=1", "display_name": "DAN", "link": "https://stackoverflow.com/users/7441878/dan"}, "edited": false, "score": 0, "creation_date": 1485958111, "post_id": 41981723, "comment_id": 71141278, "body": "it may seem like a dumb question, but how do i invoke from terminal?"}, {"owner": {"reputation": 3890, "user_id": 3626078, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/SBXjb.jpg?s=128&g=1", "display_name": "magicleon94", "link": "https://stackoverflow.com/users/3626078/magicleon94"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1485958212, "post_id": 41981723, "comment_id": 71141342, "body": "@IharobAlAsimi didn&#39;t know that!  DAN are you on Windows?"}, {"owner": {"reputation": 3890, "user_id": 3626078, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/SBXjb.jpg?s=128&g=1", "display_name": "magicleon94", "link": "https://stackoverflow.com/users/3626078/magicleon94"}, "edited": false, "score": 0, "creation_date": 1485958416, "post_id": 41981723, "comment_id": 71141483, "body": "Well, I&#39;m not a windows user, but this should help: <a href=\"http://stackoverflow.com/questions/16367190/how-to-run-a-c-program-using-command-prompt\" title=\"how to run a c program using command prompt\">stackoverflow.com/questions/16367190/&hellip;</a> And, even though I&#39;m not a codeblock user, this should help too: <a href=\"http://stackoverflow.com/questions/11888528/how-to-take-command-line-argument-in-codeblock-10-05\" title=\"how to take command line argument in codeblock 10 05\">stackoverflow.com/questions/11888528/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 7441878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/shSFJ.jpg?s=128&g=1", "display_name": "DAN", "link": "https://stackoverflow.com/users/7441878/dan"}, "edited": false, "score": 0, "creation_date": 1485958562, "post_id": 41981723, "comment_id": 71141597, "body": "Thanks!! i&#39;ll look it up!"}, {"owner": {"reputation": 3890, "user_id": 3626078, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/SBXjb.jpg?s=128&g=1", "display_name": "magicleon94", "link": "https://stackoverflow.com/users/3626078/magicleon94"}, "edited": false, "score": 0, "creation_date": 1485958610, "post_id": 41981723, "comment_id": 71141635, "body": "Yeah, let me know!"}, {"owner": {"reputation": 11, "user_id": 7441878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/shSFJ.jpg?s=128&g=1", "display_name": "DAN", "link": "https://stackoverflow.com/users/7441878/dan"}, "edited": false, "score": 0, "creation_date": 1485959161, "post_id": 41981723, "comment_id": 71142022, "body": "Ok, finally i think iunderstood how to use how to use them, and what are they for, thanks!"}, {"owner": {"reputation": 3890, "user_id": 3626078, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/SBXjb.jpg?s=128&g=1", "display_name": "magicleon94", "link": "https://stackoverflow.com/users/3626078/magicleon94"}, "edited": false, "score": 0, "creation_date": 1485959209, "post_id": 41981723, "comment_id": 71142052, "body": "Pleased to have been helpful :)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485960377, "post_id": 41981723, "comment_id": 71142834, "body": "&quot;name of the program is always passed automatically.&quot; --&gt; not always.  <code>argc</code> may be 0.  Even if <code>argc &gt; 0</code>, &quot;argv[0][0] shall be the null character if the program name is not available from the host environment.&quot; is possible."}], "tags": [], "owner": {"reputation": 3890, "user_id": 3626078, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/SBXjb.jpg?s=128&g=1", "display_name": "magicleon94", "link": "https://stackoverflow.com/users/3626078/magicleon94"}, "is_accepted": true, "score": 8, "last_activity_date": 1485957910, "last_edit_date": 1485957910, "creation_date": 1485957867, "answer_id": 41981723, "question_id": 41981565, "link": "https://stackoverflow.com/questions/41981565/clarification-on-argc-and-argv/41981723#41981723", "title": "clarification on argc and argv", "body": "<ul>\n<li><p><code>argc</code> is the number of parameters passed to your program when it's invoked from command line.</p></li>\n<li><p><code>argv</code> is the array of received parameters, and it is an array of strings.</p></li>\n</ul>\n\n<p>Note that the name of the program is always passed automatically.\nAssuming your program executable is <code>test</code>, when you invoke from terminal:</p>\n\n<pre><code>./text 145 643\n</code></pre>\n\n<p><code>argc</code> will be 3: program name and the two numbers <br>\n<code>argv</code> will be the <code>char*</code> array <code>{\"./text\",\"145\",\"643\"}</code></p>\n"}, {"tags": [], "owner": {"reputation": 108, "user_id": 4093247, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ezB85.jpg?s=128&g=1", "display_name": "Mihir Khandekar", "link": "https://stackoverflow.com/users/4093247/mihir-khandekar"}, "is_accepted": false, "score": 0, "last_activity_date": 1555376756, "last_edit_date": 1555376756, "creation_date": 1485959394, "answer_id": 41982231, "question_id": 41981565, "link": "https://stackoverflow.com/questions/41981565/clarification-on-argc-and-argv/41982231#41982231", "title": "clarification on argc and argv", "body": "<p>When you write a code, say <code>hello.c</code>, you can run it from the terminal, by going to that directory/folder from the terminal, and compile it using a compiler like gcc. </p>\n\n<p><code>gcc hello.c -o hello</code></p>\n\n<p>If you are using Windows, with a compiler like Turbo C or Visual Studio, then it would create a <code>.exe</code> file. This creates an executable file.</p>\n\n<p>When you run the file from command line, you can give command-line arguments as a way of input to the program.</p>\n\n<p>On terminal, you could <code>./hello arg1 arg2</code>, where <code>arg1</code> and <code>arg2</code> are the command line arguments to it. To see how to do this in Windows using a compiler like Turbo C, <a href=\"https://stackoverflow.com/a/6256205/4093247\">see this link too</a>.</p>\n\n<p>So what are <code>argc</code> and <code>argv[]</code>?\nYour <code>main</code> functions uses <code>main(int argc, char *argv[])</code>, to take the command line arguments.</p>\n\n<ul>\n<li><code>argc</code> is the number of command line arguments passed. In the above case, that is 3.</li>\n<li><code>argv[]</code> is an array of strings, which in this case are 3 strings. <code>argv[1]</code> will be equal to \"arg1\" and <code>argv[2]</code> will be equal to \"arg2\". \"./hello\" will be in <code>argv[0]</code>.</li>\n</ul>\n\n<p>So you give your command line arguments in the command line, be it Linux or Windows. The above explanation was more for Linux. See <a href=\"http://codingfox.com/15-9-command-line-arguments/\" rel=\"nofollow noreferrer\">this</a> and <a href=\"http://www.c4learn.com/c-programs/c-program-to-add-two-numbers-using-command-line-arguments-parameters.html\" rel=\"nofollow noreferrer\">this</a> for command line arguments in Turbo C (I do not recommend Turbo C), and <a href=\"https://stackoverflow.com/a/3697320/4093247\">this</a> in case of Visual C.</p>\n\n<p>To know more about command line arguments, you can read <a href=\"http://www.cs.utah.edu/~germain/PPS/Topics/C_Language/command_line_args.html\" rel=\"nofollow noreferrer\">this</a>.</p>\n"}], "owner": {"reputation": 11, "user_id": 7441878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/shSFJ.jpg?s=128&g=1", "display_name": "DAN", "link": "https://stackoverflow.com/users/7441878/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3845, "favorite_count": 0, "accepted_answer_id": 41981723, "answer_count": 2, "score": 0, "last_activity_date": 1555376756, "creation_date": 1485957363, "last_edit_date": 1485958418, "question_id": 41981565, "link": "https://stackoverflow.com/questions/41981565/clarification-on-argc-and-argv", "title": "clarification on argc and argv", "body": "<p>I have some doubts on what are argc and argv, i cant seem to grasp the concept, for what should i use them and how should i use them?</p>\n\n<p>like i have this program that receives from the command line two integers between -100000 and 100000 computes thir addition and prints the result, while performing all needed check about te number of paramenters and their correctness. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char *argv[])\n{\n    int a, b;\n    char ch;\n\n    if (argc != 4)\n    {\n        printf(\"ERROR - Wrong number of command line parameters.\\n\");\n        exit(1);\n\n    }\n\n    if (sscanf(argv[1], \"%d\", &amp;a) != 1)\n    {\n        printf(\"ERROR - the first parameter (%s) is not a valid integer.\\n\",\n                argv[1]);\n        exit(2);\n    }\n\n    if (sscanf(argv[2], \"%d\", &amp;b) != 1)\n    {\n        printf(\"ERROR - the second parameter (%s) is not a valid integer.\\n\",\n                argv[2]);\n        exit(2);\n    }\n    ch = argv[3][0];\n\n    if (ch == 'a')\n        printf(\"The sum result is %d\\n\", a + b);\n    else if (ch == 'b')\n        printf(\"The subtraction result is %d\\n\", a - b);\n    else if (ch == 'c')\n        printf(\"The multiplication result is %d\\n\", a * b);\n    else if (ch == 'd')\n    {\n        if (b != 0)\n            printf(\"The division result is %d\\n\", a / b);\n        else\n            printf(\"ERROR the second value shoulb be different than 0 \\n\");\n    }\n    else\n        printf(\"ERROR parameter (%c) does not correspond to a valid value.\\n\",\n                ch);\n    return 0;\n}\n</code></pre>\n\n<p>but how does the program receive from the command line two arguments?? where do i input them?? i am using codeblocks.</p>\n"}, {"tags": ["c", "openmp"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1485959404, "post_id": 41981533, "comment_id": 71142179, "body": "Have you  seen <i><a href=\"http://supercomputingblog.com/openmp/tutorial-parallel-for-loops-with-openmp/\" rel=\"nofollow noreferrer\">this</a></i>?"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1485960210, "post_id": 41981533, "comment_id": 71142745, "body": "What&#39;s the typical <code>n</code> in your case? Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> such that one can test if a parallel version provides a speedup and runs correctly."}, {"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "reply_to_user": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1485960818, "post_id": 41981533, "comment_id": 71143143, "body": "@Zulan n is typically in the range 32 to 36.  I put 32 in the example code.   In order to give a version we can test for speed I just need to produce sample input data, right?  I can&#39;t do that right now but I will as soon as possible."}, {"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1485960915, "post_id": 41981533, "comment_id": 71143217, "body": "@ryyker Thank you. There are slight subtleties here in <code>s = -s; p += s*prod;</code> but maybe it can be done straightforwardly?"}], "answers": [{"comments": [{"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 0, "creation_date": 1485966885, "post_id": 41984097, "comment_id": 71147589, "body": "Thank you for this. I will improve the question in a few days and hopefully some of these issues will become clearer."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 3, "last_activity_date": 1485966262, "last_edit_date": 1485966262, "creation_date": 1485964408, "answer_id": 41984097, "question_id": 41981533, "link": "https://stackoverflow.com/questions/41981533/how-to-parallelize-a-loop-with-openmp/41984097#41984097", "title": "How to parallelize a loop with openmp?", "body": "<blockquote>\n  <p>It seems that this ought not to be too hard but I am not really sure where to start.</p>\n</blockquote>\n\n<p>If it seems that it ought not to be hard then you have not properly appreciated the task.  Not all high-iteration-count loops are good candidates for parallel computation.</p>\n\n<blockquote>\n  <p>j = __builtin_ctzl(counter) is just giving the ruler sequence. It is tempting to use #pragma omp parallel for but the way j is calculated seems to cause a problem.</p>\n</blockquote>\n\n<p>It's not so much the way <code>j</code> is calculated, but how it is used and the values it takes over the course of the serial computation that presents a problem.  Note in particular that</p>\n\n<ul>\n<li>each loop iteration uses the value of <code>delta[j]</code></li>\n<li>each loop iteration also <em>modifies</em> the value of <code>delta[j]</code></li>\n<li><code>j</code> takes the same values repeatedly, many times over the course of the overall computation</li>\n</ul>\n\n<p>Thus, your use of <code>delta</code> and <code>j</code> creates many dependencies between different iterations of your loop.  Iterations cannot be reordered or run in parallel unless relative order is preserved for iterations that use the same value of <code>j</code> -- otherwise, the result of the computation may be altered.</p>\n\n<p>And that's not all.  Each iteration of your inner loop both uses and modifies <code>s</code> and all the elements of array <code>v</code>.  These are more serious problems for parallelization, because they make every iteration of the outer loop dependent on <em>all</em> previous iterations.</p>\n\n<blockquote>\n  <p>How can one do this?</p>\n</blockquote>\n\n<p>You need to deal with the dependency problems before this computation can make use of parallelism.  If the problem were just with <code>delta</code> and <code>j</code> then perhaps you could rearrange the computation to handle all computations involving each <code>j</code> value together.  If it were just with <code>s</code> then it's very likely that you could split the computation into <code>s == 1</code> and <code>s == -1</code> blocks, and then parallelize away.  I'm having trouble, however, seeing how you could deal with both of those simultaneously, or how you could deal with the dependency involving <code>v</code> at all.</p>\n\n<p>Perhaps you have some insight into the nature of the computation that will enable you reimplement it in a form more suitable for parallel computation.  The form it's in now is inherently serial, however.</p>\n"}, {"tags": [], "owner": {"reputation": 143, "user_id": 4774945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28583f114f0445d66ed4dc5edb01297?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Chiang", "link": "https://stackoverflow.com/users/4774945/jonathan-chiang"}, "is_accepted": false, "score": 1, "last_activity_date": 1485967510, "creation_date": 1485967510, "answer_id": 41985126, "question_id": 41981533, "link": "https://stackoverflow.com/questions/41981533/how-to-parallelize-a-loop-with-openmp/41985126#41985126", "title": "How to parallelize a loop with openmp?", "body": "<p>Parallelization is a good idea when variables that are computed inside a loop are only the counter and external unchanging variables.</p>\n\n<p>Parallelization is a bad idea when variables that are computed inside a loop depend on the same variables from a previous iteration.</p>\n\n<p>A simple exercise to check if a serial loop is suitable for parallelization is to try reversing the order of the loop. If the counter is in ascending order, try it in descending order. If the loop produces the same results, parallelization is well-suited to your problem.</p>\n\n<p>In your problem, many of the variables are dependent on their values from previous iterations: <code>v</code>, <code>delta</code>, <code>s</code>, and <code>p</code>.</p>\n\n<p>Since the intermediate values of <code>p</code> don't matter, it's not a problem. <code>omp parallel reduction</code> can handle this.</p>\n\n<p><code>s</code> can be redefined so that it does not depend on its previous value. <code>if (counter % 2 == 0){s = 1;}else{s = -1;}</code></p>\n\n<p>However, I don't see a good way to handle <code>delta</code> and <code>v</code>. This requires more familiarity with the specifics of this problem than I have. If you can find a way to define these quantities in a non-recursive manner, then OpenMP will become very useful. Good luck!</p>\n"}], "owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 3, "answer_count": 2, "score": 2, "last_activity_date": 1485967510, "creation_date": 1485957257, "last_edit_date": 1485958612, "question_id": 41981533, "link": "https://stackoverflow.com/questions/41981533/how-to-parallelize-a-loop-with-openmp", "title": "How to parallelize a loop with openmp?", "body": "<p>Consider the following code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\nfloat f(float M[32][32]) { \n  int counter, s = 1, i, j, n = 32;\n  float *delta = malloc(n * sizeof *delta);\n  float *v = malloc(n * sizeof *v);\n  float prod = 1, p = 0;\n  for (i = 0; i &lt; n; i++) {\n      v[i] = 0;\n      delta[i] = 1;\n  }\n  for(counter=1; counter &lt; pow(2,n-1); counter++) { \n      prod = 1.;\n      j = __builtin_ctzl(counter);\n      for (i = 0; i &lt; n; i++) {\n        v[i] -= 2.*delta[j]*M[j][i];\n        prod *= v[i];\n      }\n      delta[j] = -delta[j];\n      s = -s;            \n      p += s*prod;    \n    }\n  return p;\n}\n</code></pre>\n\n<p>I would like to parallelize the outer loop involving <code>counter</code> using openmp.</p>\n\n<p>It seems that this ought not to be too hard but I am not really sure where to start.  j = __builtin_ctzl(counter) is just giving the <a href=\"https://oeis.org/A001511\" rel=\"nofollow noreferrer\">ruler sequence</a>.  It is tempting to use <code>#pragma omp parallel for</code> but the way <code>j</code> is calculated seems to cause a problem.</p>\n\n<p>How can one do this?</p>\n"}, {"tags": ["c", "linux", "file-handling", "temp"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1485957331, "post_id": 41981517, "comment_id": 71140753, "body": "Is there any information or data store in the file?"}, {"owner": {"reputation": 13, "user_id": 3713840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8aefa80a2e7d8f8977f6b83e16108c?s=128&d=identicon&r=PG&f=1", "display_name": "Manoj", "link": "https://stackoverflow.com/users/3713840/manoj"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1485964849, "post_id": 41981517, "comment_id": 71146227, "body": "@AndrewHenle No there is no information in the file, it&#39;ll just be used as a way to find out if its the the process spawned for the first time after boot or re-spawned after a crash"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1485966337, "post_id": 41981517, "comment_id": 71147244, "body": "(create and) attach a shared memory segment. These are persistent after process  temination (or crash), but don&#39;t survive reboot."}], "answers": [{"comments": [{"owner": {"reputation": 7450, "user_id": 657700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb044bd9a9f6548b9a9bae44617c97c7?s=128&d=identicon&r=PG", "display_name": "fjardon", "link": "https://stackoverflow.com/users/657700/fjardon"}, "edited": false, "score": 1, "creation_date": 1485957598, "post_id": 41981582, "comment_id": 71140932, "body": "I think the idea is that another process will check for the existence of the file to decide if the process is already spawned. By deleting the file you prevent this scheme to work..."}, {"owner": {"reputation": 13, "user_id": 3713840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8aefa80a2e7d8f8977f6b83e16108c?s=128&d=identicon&r=PG&f=1", "display_name": "Manoj", "link": "https://stackoverflow.com/users/3713840/manoj"}, "edited": false, "score": 0, "creation_date": 1485968006, "post_id": 41981582, "comment_id": 71148289, "body": "The idea is, the file existence will only help me to determine whether boot-time function( function X w.r.t to the question asked) need to be called or the run-time function need to be called. So I&#39;m not going to write anything to the file, I would merely use its existence to decide which function need to be called."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 0, "last_activity_date": 1485957429, "creation_date": 1485957429, "answer_id": 41981582, "question_id": 41981517, "link": "https://stackoverflow.com/questions/41981517/what-is-the-best-way-to-create-a-non-persistent-file-in-linux/41981582#41981582", "title": "What is the best way to create a non-persistent file in linux", "body": "<p>Create the file using e.g. <code>open</code>, then immediately remove the file (with <code>unlink</code>). Since you have it open the file will still be available to you, but as soon as it it closed (explicitly with <code>close</code> or because the OS closes it when the process exits (crash or not)) then it will be like it never existed.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 3713840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8aefa80a2e7d8f8977f6b83e16108c?s=128&d=identicon&r=PG&f=1", "display_name": "Manoj", "link": "https://stackoverflow.com/users/3713840/manoj"}, "edited": false, "score": 0, "creation_date": 1486050109, "post_id": 41981715, "comment_id": 71188702, "body": "Actually the application under development is a embedded application having powerpc architecture.. some script had to be run to delete the files in /tmp directory everytime the system reboots, which was not run, thereby causing the files in the /tmp directory to be persistent. Anyways thanks for the suggestion @Ezequiel Garcia. It worked out :)"}, {"owner": {"reputation": 948, "user_id": 728333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf4315965a1b11f74402717e4ef30a4?s=128&d=identicon&r=PG", "display_name": "Ezequiel Garcia", "link": "https://stackoverflow.com/users/728333/ezequiel-garcia"}, "reply_to_user": {"reputation": 13, "user_id": 3713840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8aefa80a2e7d8f8977f6b83e16108c?s=128&d=identicon&r=PG&f=1", "display_name": "Manoj", "link": "https://stackoverflow.com/users/3713840/manoj"}, "edited": false, "score": 0, "creation_date": 1486052762, "post_id": 41981715, "comment_id": 71190473, "body": "Well, I guess that depends on what you want <code>&#47;tmp</code> to be. You want a disk-backed temporary storage, and you want to remove it upon reboots? Then fine. On my embedded platforms, I mount tmpfs on <code>&#47;tmp</code> so I don&#39;t use disk for it (and don&#39;t need to remove anything on reboot)."}], "tags": [], "owner": {"reputation": 948, "user_id": 728333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf4315965a1b11f74402717e4ef30a4?s=128&d=identicon&r=PG", "display_name": "Ezequiel Garcia", "link": "https://stackoverflow.com/users/728333/ezequiel-garcia"}, "is_accepted": true, "score": 2, "last_activity_date": 1485958302, "last_edit_date": 1485958302, "creation_date": 1485957854, "answer_id": 41981715, "question_id": 41981517, "link": "https://stackoverflow.com/questions/41981517/what-is-the-best-way-to-create-a-non-persistent-file-in-linux/41981715#41981715", "title": "What is the best way to create a non-persistent file in linux", "body": "<p><code>mktemp</code> creates files in <code>/tmp</code> (by default). In many distributions, <code>/tmp</code> is persistent (i.e. disk-backed, not memory-backed).</p>\n\n<p>What you are looking for is to create a file in a memory-backed mount. Typically these are the <code>tmpfs</code> mounts. For example, on my Arch Linux laptop, my tmpfs mounts are:</p>\n\n<pre><code>$ mount | grep tmpfs\n[..]\nrun on /run type tmpfs (rw,nosuid,nodev,relatime,mode=755)\nshm on /dev/shm type tmpfs (rw,nosuid,nodev,noexec,relatime)\n</code></pre>\n\n<p>So on this system, I can open and write to files in <code>/dev/shm/</code> on <code>/run</code> and they will be backed by my memory, they won't persist across boots and the access will be fast and cheap.</p>\n\n<p>Back to your question, it seems that you can change the directory used by <code>mktemp</code>. Quoting the man page:</p>\n\n<pre><code>-p DIR, --tmpdir[=DIR]\n              interpret  TEMPLATE relative to DIR; if DIR is not specified, use $TMPDIR if set, else /tmp.  With this option, TEMPLATE must not be\n              an absolute name; unlike with -t, TEMPLATE may contain slashes, but mktemp creates only the final component\n</code></pre>\n\n<p>EDIT - few more things:</p>\n\n<ul>\n<li>this is all distribution-dependent; other distributions may mount <code>tmpfs</code> at <code>/tmp</code>.</li>\n<li>interestingly, /dev/shm is where shared memory objects created with <code>shm_open</code> are stored.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 3713840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8aefa80a2e7d8f8977f6b83e16108c?s=128&d=identicon&r=PG&f=1", "display_name": "Manoj", "link": "https://stackoverflow.com/users/3713840/manoj"}, "edited": false, "score": 0, "creation_date": 1485964939, "post_id": 41982624, "comment_id": 71146293, "body": "But the crash of the process is unpredictable so cant rely on the timestamp concept to determine if the process is spawned the first time or spawned after a crash."}, {"owner": {"reputation": 1314, "user_id": 2938149, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9b2d6e2cfcb23de95f6efc35816c1afb?s=128&d=identicon&r=PG", "display_name": "Bruno9779", "link": "https://stackoverflow.com/users/2938149/bruno9779"}, "reply_to_user": {"reputation": 13, "user_id": 3713840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8aefa80a2e7d8f8977f6b83e16108c?s=128&d=identicon&r=PG&f=1", "display_name": "Manoj", "link": "https://stackoverflow.com/users/3713840/manoj"}, "edited": false, "score": 0, "creation_date": 1485970188, "post_id": 41982624, "comment_id": 71149633, "body": "Why not? If the difference between boot time and creation time is longer than ej 2*booting time, you know it is a respawn"}], "tags": [], "owner": {"reputation": 1314, "user_id": 2938149, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9b2d6e2cfcb23de95f6efc35816c1afb?s=128&d=identicon&r=PG", "display_name": "Bruno9779", "link": "https://stackoverflow.com/users/2938149/bruno9779"}, "is_accepted": false, "score": 2, "last_activity_date": 1485964412, "last_edit_date": 1485964412, "creation_date": 1485960479, "answer_id": 41982624, "question_id": 41981517, "link": "https://stackoverflow.com/questions/41981517/what-is-the-best-way-to-create-a-non-persistent-file-in-linux/41982624#41982624", "title": "What is the best way to create a non-persistent file in linux", "body": "<p>I don't see the problem with persistent /tmp. You can check timestamps and compare them with boot time.</p>\n\n<p>boot time in epoch:</p>\n\n<pre><code>stat -c %Y /proc/1\n</code></pre>\n\n<p>file creation time in epoch:</p>\n\n<pre><code>stat -c %Y filename.tmp\n</code></pre>\n\n<p>The biggest advantage of this approach is portability, since it is not dependent on distro-specific tmpfs settings</p>\n"}], "owner": {"reputation": 13, "user_id": 3713840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8aefa80a2e7d8f8977f6b83e16108c?s=128&d=identicon&r=PG&f=1", "display_name": "Manoj", "link": "https://stackoverflow.com/users/3713840/manoj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1085, "favorite_count": 0, "closed_date": 1485984275, "accepted_answer_id": 41981715, "answer_count": 3, "score": -1, "last_activity_date": 1485964412, "creation_date": 1485957218, "question_id": 41981517, "link": "https://stackoverflow.com/questions/41981517/what-is-the-best-way-to-create-a-non-persistent-file-in-linux", "closed_reason": "Needs more focus", "title": "What is the best way to create a non-persistent file in linux", "body": "<p>In my application, I have a C process created which will be re-spawned if the process dies. Now I have a requirement to know if the process is spawned for the first time(after system reboot), due to which function X will be called, or if the process got re-spawned after a crash(runtime) due to which function Y will be called.</p>\n\n<p>I tried creating temp files by the use of command mktemp() but the files seemed to be persistent even after the reboot.</p>\n\n<p>So what would be best way to do it?</p>\n"}, {"tags": ["c", "cs50", "caesar-cipher"], "comments": [{"owner": {"reputation": 933, "user_id": 2995527, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xEWfR.jpg?s=128&g=1", "display_name": "Daniel Puiu", "link": "https://stackoverflow.com/users/2995527/daniel-puiu"}, "edited": false, "score": 2, "creation_date": 1485956548, "post_id": 41981235, "comment_id": 71140163, "body": "<code>plain[key]</code> would be a <code>string</code> not an <code>int</code>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1485957135, "post_id": 41981235, "comment_id": 71140618, "body": "<code>plain[key]</code> is probably out of bounds. You should check what parameters are passed to <code>main</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1485958569, "post_id": 41981235, "comment_id": 71141602, "body": "C does not have a <code>string</code> type. What is that? The signature of <code>main</code> shall be <code>int main(int, int *[])</code> or the last aprameter can be <code>int **</code> which is identical."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1485961538, "post_id": 41981235, "comment_id": 71143657, "body": "@Olaf, you probably wanted to write <code>char *[]</code> or <code>char**</code>"}, {"owner": {"reputation": 1, "user_id": 7490716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57eaa2681eb21dca143c789996ba556a?s=128&d=identicon&r=PG&f=1", "display_name": "dn3000", "link": "https://stackoverflow.com/users/7490716/dn3000"}, "edited": false, "score": 0, "creation_date": 1485961639, "post_id": 41981235, "comment_id": 71143731, "body": "The course I&#39;m doing made string work in C, I suppose to make C a bit easier to start to work with. They made their own library that includes string. But anyways, I got that to work now, and now I bump into my second problem.. I know as per the assignment that the second char in argv (so that is argv[1]) is going to be an int. I need that int later in the code. So how do I turn argv[1] into an integer that I can use further down in my code? If I simply declare a new int and say: int key = argv[1]; the compiler doesn&#39;t accept it.. Any ideas how to fix this?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1485961866, "post_id": 41981235, "comment_id": 71143905, "body": "@Gerhardh: Of course! Thanks for the correction. Stupid flaw of me."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1485962063, "post_id": 41981235, "comment_id": 71144051, "body": "@dn3000 We are not a tutoring site. You should read a C book or your course documentation or ask your teacher. And you cannot add new types to the C language. That cs50 library <code>typedef char *string</code> which is bad practice, as one should never <code>typedef</code> a data pointer. Youi cannot change this, but it sheds a bad light at that course."}], "answers": [{"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1485957052, "last_edit_date": 1485957052, "creation_date": 1485956486, "answer_id": 41981278, "question_id": 41981235, "link": "https://stackoverflow.com/questions/41981235/command-line-argument-condition-pset2-caesar/41981278#41981278", "title": "Command line argument condition pset2 caesar", "body": "<p>You misunderstood the purpose of the arguments to <code>main</code>. The first <code>int</code> argument (usually named <code>argc</code>) is the number of items in the array argument.</p>\n\n<p>And the array argument (usually called <code>argv</code>) contains all the arguments to your program (including the executable name) as text.</p>\n\n<p>So if your executable is called <code>foo</code>, and you invoked it as <code>foo 1 a bar</code>, the arguments to main will be as follows:</p>\n\n<pre><code>int    argc == 4\nchar **argv =&gt; {\"foo\", \"1\", \"a\", \"bar\"}\n</code></pre>\n\n<p>So if your program must accept a single argument, it must hold that <code>argc == 2</code> and <code>argv[1]</code> is the argument, that you must convert to a number from a string.</p>\n"}, {"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 0, "last_activity_date": 1485956664, "last_edit_date": 1485956664, "creation_date": 1485956588, "answer_id": 41981310, "question_id": 41981235, "link": "https://stackoverflow.com/questions/41981235/command-line-argument-condition-pset2-caesar/41981310#41981310", "title": "Command line argument condition pset2 caesar", "body": "<p><code>plain[key]</code> access the key element of <code>plain</code> array of string pointers (<code>argv</code>).</p>\n\n<p>The size of that array is expressed by key (<code>argc</code>).</p>\n\n<p>So what you want is </p>\n\n<pre><code>if (key &gt; 1)\n{\n   //..\n}\n</code></pre>\n\n<p>Moreover plain last element is <code>key-1</code>, 'cause is <code>0</code> based index.</p>\n"}], "owner": {"reputation": 1, "user_id": 7490716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57eaa2681eb21dca143c789996ba556a?s=128&d=identicon&r=PG&f=1", "display_name": "dn3000", "link": "https://stackoverflow.com/users/7490716/dn3000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 375, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1485957052, "creation_date": 1485956368, "question_id": 41981235, "link": "https://stackoverflow.com/questions/41981235/command-line-argument-condition-pset2-caesar", "title": "Command line argument condition pset2 caesar", "body": "<p>I'm just started with a course for learning C, and am bumping in a problem with command line arguments. The assignment is this (there is more, but this is the part about the command line argument at the start): <br>\n- Your program must accept a single command-line argument, a non-negative integer.<br>\n- <strong>If your program is executed without any command-line arguments or with more than one command-line argument, your program should print an error message of your choice and return 1.</strong><br>\n- You can assume that, if a user does provide a command-line argument, it will be a non-negative integer (e.g., 1). No need to check that it\u2019s indeed numeric.</p>\n\n<p>So I came up with this code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;cs50.h&gt;\n#include &lt;string.h&gt;\n\n\n    int main(int key, string plain[]) {\n\n        if (key &lt; 0 || plain[key] &gt; 1)\n        {\n            printf(\"error\\n\");\n            return 1;\n        }\n        else\n</code></pre>\n\n<p>etc...code continues.</p>\n\n<p>Now I've tried several things, but I'm running into a wall.The compiler doesn't want to accept the if-condition I came up with, saying there is an error with comparison between pointer and integer which refers to the bold condition on the list of the assignment. So I understood that the argv part of the command line argument is the array of strings that the user put in. So my thought was to tell the compiler that when the user gives more than one string it should give an error message, so I wrote \"plain[key] > 1)\". Or is my understanding of command line arguments completely off here? Thanks.</p>\n"}, {"tags": ["c", "fork", "semaphore"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1485955916, "post_id": 41981010, "comment_id": 71139710, "body": "<code>fork</code> creates an entirely new process, with its own memory space. The two don&#39;t see the same <code>mem</code> by default."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1485955925, "post_id": 41981010, "comment_id": 71139715, "body": "I assume you want the mutex to inhibit changes of <code>mem-&gt;counter</code> before it is copied for the call to <code>foo</code>? Then why not copy it yourself into a separate variable, release the mutex and <i>then</i> call <code>foo</code> with your copied value?"}, {"owner": {"reputation": 1103, "user_id": 5987899, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/c5cc248e55c258a3dc58c390512c53e1?s=128&d=identicon&r=PG&f=1", "display_name": "jam", "link": "https://stackoverflow.com/users/5987899/jam"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1485956440, "post_id": 41981010, "comment_id": 71140083, "body": "@Someprogrammerdude correctly, this is what I try to achive."}, {"owner": {"reputation": 1103, "user_id": 5987899, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/c5cc248e55c258a3dc58c390512c53e1?s=128&d=identicon&r=PG&f=1", "display_name": "jam", "link": "https://stackoverflow.com/users/5987899/jam"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1485956751, "post_id": 41981010, "comment_id": 71140338, "body": "@Someprogrammerdude I did as you said and it is working. Thank you. Can you answer it so I can close the question ?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1485956872, "post_id": 41981010, "comment_id": 71140420, "body": "Something like that yes, but you might want <code>row = ++mem-&gt;row</code> instead. Will make the <code>foo</code> function more stand-alone. However, it might not solve your problem if you have deadlocks or other problems. It&#39;s really hard to say anything with only the little code you show or the vague failure description."}, {"owner": {"reputation": 1103, "user_id": 5987899, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/c5cc248e55c258a3dc58c390512c53e1?s=128&d=identicon&r=PG&f=1", "display_name": "jam", "link": "https://stackoverflow.com/users/5987899/jam"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1485957941, "post_id": 41981010, "comment_id": 71141159, "body": "@Someprogrammerdude it actualy solved the problem."}], "owner": {"reputation": 1103, "user_id": 5987899, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/c5cc248e55c258a3dc58c390512c53e1?s=128&d=identicon&r=PG&f=1", "display_name": "jam", "link": "https://stackoverflow.com/users/5987899/jam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485955680, "creation_date": 1485955680, "question_id": 41981010, "link": "https://stackoverflow.com/questions/41981010/how-to-interleave-a-semaphore-on-a-function", "title": "How to interleave a semaphore on a function?", "body": "<p>I am struggling with a part of my multi-process code,\nwhere I share a variable and increment it for a function call.</p>\n\n<pre><code>Struct ShMem{\n  int counter;\n  sem_t mutex;\n};\n\nvoid foo(int counter){\n    sem_post(&amp;mem-&gt;mutex);\n    // complex calculation\n}\n\nShMem *mem;\nvoid main(){\n    for(...){\n        switch(fork()){\n            case 0:\n                sem_wait(&amp;mem-&gt;mutex);\n                mem-&gt;counter++;\n                // no interruption between these steps wanted\n                foo(mem-&gt;counter);\n                exit(0);\n        }\n    }       \n}\n</code></pre>\n\n<p>I split the wait and post function of the mutex on main and foo. </p>\n\n<p>My intension is to not get interrupted between the increment of the\ncounter and the function call and let the complex part of foo run in paralell. </p>\n\n<p>This aproach isn't working, since it hangs anywhere.\nMaybe I use the wrong mechanism here, any suggestions ?</p>\n"}, {"tags": ["c", "bit-manipulation"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1485955239, "post_id": 41980814, "comment_id": 71139265, "body": "Copy the seven first bits of what to where? And why do you mention &quot;stdio&quot;? That only have to do with input and output (like the <code>printf</code> or <code>scanf</code> functions), it has nothing to do with bit manipulations. Can you perhaps elaborate a little? Like telling us some specific input, and showing us what the output should be (and what the output currently is)? And of course try to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> of what you currently have and show us?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 1562, "user_id": 2789762, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/7d29562a2ce01fbd9bb3e30191aeb251?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2789762/kevin"}, "edited": false, "score": 0, "creation_date": 1485955461, "post_id": 41980814, "comment_id": 71139401, "body": "@Kevin That&#39;s wrong."}, {"owner": {"reputation": 1469, "user_id": 1421659, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f92825e0ea44cf5bed741a9d9369e91f?s=128&d=identicon&r=PG", "display_name": "Joe Caraccio", "link": "https://stackoverflow.com/users/1421659/joe-caraccio"}, "reply_to_user": {"reputation": 1562, "user_id": 2789762, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/7d29562a2ce01fbd9bb3e30191aeb251?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2789762/kevin"}, "edited": false, "score": 0, "creation_date": 1485955478, "post_id": 41980814, "comment_id": 71139411, "body": "@Kevin ah, okay that makes sense. DO you have any sort of idea for how I would combine like say 7 bits from 1 byte, and 1 bit from another? if that makes sense.. like if I want the first 5 bits from 0xAE and then the last 3 bits from 0XE1"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1485955562, "post_id": 41980814, "comment_id": 71139467, "body": "@JoeCaraccio we are not a tutoring site. Bit-ops are explained in every good C book or a lot of online sites, including SO."}, {"owner": {"reputation": 1469, "user_id": 1421659, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f92825e0ea44cf5bed741a9d9369e91f?s=128&d=identicon&r=PG", "display_name": "Joe Caraccio", "link": "https://stackoverflow.com/users/1421659/joe-caraccio"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1485955595, "post_id": 41980814, "comment_id": 71139486, "body": "i updated what I was trying to figure out how to do, if you don&#39;t want to help me thats fine @Olaf"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1485955787, "post_id": 41980814, "comment_id": 71139618, "body": "<code>c = (0xE1u &amp; 0x07u) | (0xA1u &amp; 0xF8u);</code>"}, {"owner": {"reputation": 1562, "user_id": 2789762, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/7d29562a2ce01fbd9bb3e30191aeb251?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2789762/kevin"}, "edited": false, "score": 1, "creation_date": 1485955880, "post_id": 41980814, "comment_id": 71139681, "body": "<code>(a &amp; 0xE0) | (b &amp; 0x1F)</code> will get the most significant 3-bits of <code>a</code> and least significant 5-bits of <code>b</code>."}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 1, "creation_date": 1485955886, "post_id": 41980814, "comment_id": 71139686, "body": "@JoeCaraccio What do you call &quot;first&quot; bits? Standard names are &quot;least-significant&quot; and &quot;most-significant&quot;."}, {"owner": {"reputation": 1469, "user_id": 1421659, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f92825e0ea44cf5bed741a9d9369e91f?s=128&d=identicon&r=PG", "display_name": "Joe Caraccio", "link": "https://stackoverflow.com/users/1421659/joe-caraccio"}, "edited": false, "score": 0, "creation_date": 1485955958, "post_id": 41980814, "comment_id": 71139737, "body": "Thanks everyone. that is basically what I was trying to accomplish"}, {"owner": {"reputation": 1469, "user_id": 1421659, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f92825e0ea44cf5bed741a9d9369e91f?s=128&d=identicon&r=PG", "display_name": "Joe Caraccio", "link": "https://stackoverflow.com/users/1421659/joe-caraccio"}, "reply_to_user": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 1, "creation_date": 1485956127, "post_id": 41980814, "comment_id": 71139866, "body": "@anatolyg didn&#39;t realize that.. I&#39;ll refer to them like that in the future"}, {"owner": {"reputation": 1469, "user_id": 1421659, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f92825e0ea44cf5bed741a9d9369e91f?s=128&d=identicon&r=PG", "display_name": "Joe Caraccio", "link": "https://stackoverflow.com/users/1421659/joe-caraccio"}, "reply_to_user": {"reputation": 1562, "user_id": 2789762, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/7d29562a2ce01fbd9bb3e30191aeb251?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2789762/kevin"}, "edited": false, "score": 0, "creation_date": 1485957243, "post_id": 41980814, "comment_id": 71140691, "body": "@kevin , nevermind, that works perfectly"}], "answers": [{"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1485955975, "last_edit_date": 1485955975, "creation_date": 1485955316, "answer_id": 41980894, "question_id": 41980814, "link": "https://stackoverflow.com/questions/41980814/c-bit-manipulation/41980894#41980894", "title": "C bit manipulation", "body": "<p>Extracting bits from integral values can be done with the bitwise <em>and</em> and <em>shift</em> operations.</p>\n\n<pre><code>unsigned int c = 23;\n\nc &amp; 0xF  // extract the lowest 4 bits, 0xF is binary 1111\nc &amp; 0x7F // extract the lowest 7 bits, 0x7F is binary 1111111\n(c &gt;&gt; 4) &amp; 0x3 // extract 2 bits starting at bit 4 (0 indexed). \n</code></pre>\n"}], "owner": {"reputation": 1469, "user_id": 1421659, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f92825e0ea44cf5bed741a9d9369e91f?s=128&d=identicon&r=PG", "display_name": "Joe Caraccio", "link": "https://stackoverflow.com/users/1421659/joe-caraccio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 41980894, "answer_count": 1, "score": 0, "last_activity_date": 1485956756, "creation_date": 1485955055, "last_edit_date": 1485955826, "question_id": 41980814, "link": "https://stackoverflow.com/questions/41980814/c-bit-manipulation", "title": "C bit manipulation", "body": "<p>I have to accomplish bit manipulation.</p>\n\n<p>My task is to iterate through many one byte values, and pull out certain amount of bits from each byte (sometimes odd, sometimes even) and be able to combine all those together. Is there a good way to accomplish this?</p>\n\n<p>Here's a better explanation. My goal is to allow me to take certain bits from one byte and combine them with bits from another byte.</p>\n\n<p>So for example, combine the first 3 bits from 0xE1, with the last 5 bits from 0xA1.</p>\n"}, {"tags": ["c", "malloc", "sbrk", "brk"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1485955647, "post_id": 41980791, "comment_id": 71139518, "body": "If you <code>#include &lt;stdlib.h</code>, the name <code>malloc</code> is reserved and must not be used by user code. Use a different name."}, {"owner": {"reputation": 21, "user_id": 7256648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271c79c5b90df2d4bd723caadd317eec?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Nonnen", "link": "https://stackoverflow.com/users/7256648/jack-nonnen"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1485955810, "post_id": 41980791, "comment_id": 71139634, "body": "<code>stdlib.h</code> is of course not included"}, {"owner": {"reputation": 21, "user_id": 7256648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271c79c5b90df2d4bd723caadd317eec?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Nonnen", "link": "https://stackoverflow.com/users/7256648/jack-nonnen"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1485956010, "post_id": 41980791, "comment_id": 71139780, "body": "Because i include it nowhere in my program."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1485958141, "post_id": 41980791, "comment_id": 71141297, "body": "1) Correct capitatilsation makes reading posts easier. It is &quot;I&quot;, not &quot;i&quot;. Wrong orthography is not cool. Similar for using markdown 2) <b>You</b> did not include it - sure not even indirectly? And sure it is not linked? See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and all relevant information."}, {"owner": {"reputation": 1432, "user_id": 5036612, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bf1ceca4bda9dba7776ffa4917e537c1?s=128&d=identicon&r=PG&f=1", "display_name": "Adalcar", "link": "https://stackoverflow.com/users/5036612/adalcar"}, "edited": false, "score": 0, "creation_date": 1485958900, "post_id": 41980791, "comment_id": 71141832, "body": "this code segment has no heads or tails, can you please show the full function? We cannot answer a question if we don&#39;t know what you are asking."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7256648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271c79c5b90df2d4bd723caadd317eec?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Nonnen", "link": "https://stackoverflow.com/users/7256648/jack-nonnen"}, "edited": false, "score": 0, "creation_date": 1486028278, "post_id": 41982374, "comment_id": 71173915, "body": "&quot;data being a pointer to the second part of the allocated zone&quot;. That&#39;s what I don&#39;t understand how you can find the pointer of the second zone. If I want to to a <code>malloc(10)</code> I&#39;ll do a <code>sbrk(4096)</code> from 0x0000 to 0x4096 for exemple, and I want to take some of this allocated space for my malloc for exemple 0x0000 to 0x0010 so my free space will be 0x0011 to 0x4096 after the malloc"}, {"owner": {"reputation": 1432, "user_id": 5036612, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bf1ceca4bda9dba7776ffa4917e537c1?s=128&d=identicon&r=PG&f=1", "display_name": "Adalcar", "link": "https://stackoverflow.com/users/5036612/adalcar"}, "reply_to_user": {"reputation": 21, "user_id": 7256648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271c79c5b90df2d4bd723caadd317eec?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Nonnen", "link": "https://stackoverflow.com/users/7256648/jack-nonnen"}, "edited": false, "score": 0, "creation_date": 1486029353, "post_id": 41982374, "comment_id": 71174616, "body": "If the allocated space is 10, then the next zone starts at base + 10, no?"}, {"owner": {"reputation": 21, "user_id": 7256648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271c79c5b90df2d4bd723caadd317eec?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Nonnen", "link": "https://stackoverflow.com/users/7256648/jack-nonnen"}, "edited": false, "score": 0, "creation_date": 1486029588, "post_id": 41982374, "comment_id": 71174750, "body": "In this case, if I have a <code>size_t size = 10</code> and a <code>void *data = 0x0000</code> (start of my <code>sbrk(4096)</code> ) doing <code>void *new_end = data + size</code> doesn&#39;t work and I can&#39;t find out why"}, {"owner": {"reputation": 1432, "user_id": 5036612, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bf1ceca4bda9dba7776ffa4917e537c1?s=128&d=identicon&r=PG&f=1", "display_name": "Adalcar", "link": "https://stackoverflow.com/users/5036612/adalcar"}, "reply_to_user": {"reputation": 21, "user_id": 7256648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271c79c5b90df2d4bd723caadd317eec?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Nonnen", "link": "https://stackoverflow.com/users/7256648/jack-nonnen"}, "edited": false, "score": 0, "creation_date": 1486030063, "post_id": 41982374, "comment_id": 71175056, "body": "That is probably due to the pointer type: a void* cannot be used in arithmetics since its size is unknown"}, {"owner": {"reputation": 21, "user_id": 7256648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271c79c5b90df2d4bd723caadd317eec?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Nonnen", "link": "https://stackoverflow.com/users/7256648/jack-nonnen"}, "edited": false, "score": 0, "creation_date": 1486030455, "post_id": 41982374, "comment_id": 71175359, "body": "How cant I set the my new_end at start + size I want to malloc then?"}], "tags": [], "owner": {"reputation": 1432, "user_id": 5036612, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bf1ceca4bda9dba7776ffa4917e537c1?s=128&d=identicon&r=PG&f=1", "display_name": "Adalcar", "link": "https://stackoverflow.com/users/5036612/adalcar"}, "is_accepted": false, "score": 0, "last_activity_date": 1485959833, "last_edit_date": 1495541801, "creation_date": 1485959833, "answer_id": 41982374, "question_id": 41980791, "link": "https://stackoverflow.com/questions/41980791/splitting-an-sbrk-into-2/41982374#41982374", "title": "splitting an sbrk into 2", "body": "<p>If I understand your question, It seems you want to do one big <code>sbrk()</code> and then split a new piece everytime you malloc.</p>\n\n<p>The idea is good due to the load sbrk takes on your program, but it seems you misunderstand something conscerning malloc.</p>\n\n<p>Malloc in its simplest implementation allocates a certain amount of space looking like this: </p>\n\n<pre><code>struct metadata\n{\n   size_t size;\n   int free;\n   struct metadata *next;\n   void *data; \n}\n</code></pre>\n\n<p>data being a pointer to the second part of the allocated zone, containing the actual space.\nnext is the pointer to the end of the allocated zone.</p>\n\n<p>When you <code>malloc</code> a certain space, you create this struct and return the data pointer.\nThen, to free you just have to return set the \"free\" value to 1.</p>\n\n<p>This generates a linked list containing all your data, and all in your sbrk'd zone.</p>\n\n<p>for more info on different malloc implementations, see <a href=\"https://stackoverflow.com/a/41151828/5036612\">this answer</a>\nwhich uses mmap but can just as well use sbrk</p>\n"}], "owner": {"reputation": 21, "user_id": 7256648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271c79c5b90df2d4bd723caadd317eec?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Nonnen", "link": "https://stackoverflow.com/users/7256648/jack-nonnen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 556, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542607493, "creation_date": 1485954992, "last_edit_date": 1542607493, "question_id": 41980791, "link": "https://stackoverflow.com/questions/41980791/splitting-an-sbrk-into-2", "title": "splitting an sbrk into 2", "body": "<p>To recode the malloc function, I do a <code>sbrk(stack)</code> where :</p>\n\n<pre><code>void *malloc(size_t size)\n{\n  stack = 0;\n  while (stack &lt; size)\n    stack += 4096;\n}\n</code></pre>\n\n<p>I malloc always more than I need then I want to take some of this allocated area of size <code>size</code> and return it, and if I want to do another malloc after I already have allocated memory so I dont have to do multiple call of sbrk.\nHow can i do that, i tried to go back with <code>brk(start_of_the_allocated_space)</code> , <code>sbrk(size)</code> to have the start and end of the space i need but it segfault.</p>\n\n<p>EDIT:</p>\n\n<pre><code>struct s_block {\nsize_t size;\nstruct s_block *next;\nstruct s_block *prev;\nvoid *start;\nvoid *end;\n}\n</code></pre>\n\n<p>Here is my structure.\nThen I have a func who create a block</p>\n\n<pre><code>struct s_block   *create_block(size_t size, unsigned int stack)\n{\nstruct s_block *block;\nblock = sbrk(sizeof(s_block));\nblock-&gt;start = sbrk(stack);\nblock-&gt;size = stack;\nblock-&gt;end = sbrk(0);\nblock-&gt;next = set_free_space(size, block);\nblock-&gt;size -= size;\nblock-&gt;next-&gt;prev = block;\nblock-&gt;prev = NULL;\nreturn (block-&gt;next);\n}\n\nstruct s_block *set_free_space(size_t size, struct s_block *block)\n{ \nstruct s_block new_block;\nnew_block = sbrk(sizeof(s_block));\nnew_block-&gt;start = block-&gt;start;\nnew_block-&gt;next = NULL;\nnew_block-&gt;size = size;\nnew_block-&gt;end = ???; // this is where I want to split the first sbrk\n// I tried new_block-&gt;end = new_block-&gt;start + size; but it doesn't work either\nblock-&gt;start = new_block-&gt;end + 1; // and i set the new start of the big block at the end of the one i use\nreturn (new_block);\n}\n</code></pre>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 2, "creation_date": 1485954825, "post_id": 41980644, "comment_id": 71138976, "body": "Do you think that <code>[]</code> works as a kind of modifier to the <code>%c</code> conversion? If so, that&#39;s not how it works."}, {"owner": {"reputation": 15105, "user_id": 3768871, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Wxgi0.jpg?s=128&g=1", "display_name": "OmG", "link": "https://stackoverflow.com/users/3768871/omg"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1485955259, "post_id": 41980644, "comment_id": 71139275, "body": "you can debug and see the behavior is as what I said, in the front side."}], "owner": {"reputation": 15105, "user_id": 3768871, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Wxgi0.jpg?s=128&g=1", "display_name": "OmG", "link": "https://stackoverflow.com/users/3768871/omg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "closed_date": 1485954677, "answer_count": 0, "score": 0, "last_activity_date": 1485954574, "creation_date": 1485954574, "question_id": 41980644, "link": "https://stackoverflow.com/questions/41980644/misbehavior-of-scanf-function-in-c", "closed_reason": "Duplicate", "title": "Misbehavior of Scanf function in C", "body": "<p>Consider the following code:</p>\n\n\n\n<pre><code>#include&lt;stdio.h&gt;\n\nvoid main()\n{\n    int p = 0;\n    char a = 0;\n    while(p == 0)\n    {\n        p = scanf(\"%[abc]c\",&amp;a);\n    }\n    printf(\"%c\",a);\n}\n</code></pre>\n\n<p>I know if you enter a character except <code>'a'</code>, <code>'b'</code>, or <code>'c'</code>, value of the getting character from input would not be set into the variable <code>a</code>. </p>\n\n<p>The <strong>problem</strong> is if you enter a value except the specified characters, the above loop never and never terminates. Apparently, after getting a not specified character in <code>scanf</code>, it will not get any character in the following loop iteration. <em>Where is the origin of this problem?</em></p>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1485954233, "post_id": 41980535, "comment_id": 71138524, "body": "did you check <a href=\"https://cs50.stackexchange.com\">CS50</a>?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1485954685, "post_id": 41980535, "comment_id": 71138861, "body": "<code>&gt;= 25</code> --&gt; <code>&gt;= 0</code> and so on. or simply <code>(amount-25) &gt;= 25</code> --&gt; <code>amount &gt;= 25</code>"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7235747, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-cMwc0j9LGz0/AAAAAAAAAAI/AAAAAAAAAjw/__CutDP2EAA/photo.jpg?sz=128", "display_name": "Xavier Tan", "link": "https://stackoverflow.com/users/7235747/xavier-tan"}, "edited": false, "score": 1, "creation_date": 1486227809, "post_id": 42008839, "comment_id": 71259257, "body": "thank you so much for your detailed answers, helped me alot."}], "tags": [], "owner": {"reputation": 86, "user_id": 7182981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/636ea154c8f34452b865c476716e91ce?s=128&d=identicon&r=PG&f=1", "display_name": "Tiago Alves", "link": "https://stackoverflow.com/users/7182981/tiago-alves"}, "is_accepted": true, "score": 0, "last_activity_date": 1486057202, "creation_date": 1486057202, "answer_id": 42008839, "question_id": 41980535, "link": "https://stackoverflow.com/questions/41980535/cs50-greedy-algorithm/42008839#42008839", "title": "CS50 greedy algorithm", "body": "<p>Firstly, you could try running your program with values for <code>change</code> that return simple answers, like 1 coin, using, for example, <code>change = 0.25</code>. If that works, then you should start trying with some few coins, repeating one type, like you did with <code>1.00</code>, or joining a few types, like <code>0.06</code> . And after that, try big numbers and values with higher floating inaccuracy, like <code>4.10</code>. Following this should lead you to your answers.</p>\n\n<p>If, after trying that, you still can't find the problem, then here is the answer: the problem is with the <code>if</code>/<code>else if</code> expressions. When you are trying to count the quarters, for example, the <code>(amount-25) &gt;= 25</code> doesn't work properly. You're trying to take away a quarter while <code>amount</code> is bigger or equal to 25, but your code just do that until it gets to less than 50. Developing your expression may help you see it: <code>(amount-25) &gt;= 25</code> -> <code>(amount-25) + 25 &gt;= 25 + 25</code> -> <code>amount &gt;= 50</code>.</p>\n\n<p>Another problem you may find is with that <code>break</code> statement. It might get out from the loop earlier than expected. If you try running numbers like <code>0.04</code> and <code>0.03</code> you'll see the count stuck at <code>1</code>. After removing the first penny, the code breaks out of the loop leaving <code>amount</code> still bigger than 0. <code>break</code>s make it harder to see when the code is getting out of the loop and that's why many programmers recommend avoiding it whenever possible.</p>\n"}], "owner": {"reputation": 43, "user_id": 7235747, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-cMwc0j9LGz0/AAAAAAAAAAI/AAAAAAAAAjw/__CutDP2EAA/photo.jpg?sz=128", "display_name": "Xavier Tan", "link": "https://stackoverflow.com/users/7235747/xavier-tan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1887, "favorite_count": 0, "accepted_answer_id": 42008839, "answer_count": 1, "score": 0, "last_activity_date": 1486057202, "creation_date": 1485954214, "last_edit_date": 1485957685, "question_id": 41980535, "link": "https://stackoverflow.com/questions/41980535/cs50-greedy-algorithm", "title": "CS50 greedy algorithm", "body": "<p>I just started C programming with cs50. </p>\n\n<p>I tried to do the problem set about the greedy algorithm but can't seem to find the bug. My code is below.</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\n\nint main (void)\n{\n\nint count = 0;\n\nprintf(\"how much is the change?: \");\n\nfloat change = get_float();\n\nwhile(change &lt; 0)\n{\n   printf(\"change is to be more than 0\");\n   change = get_float();\n }\n\nint amount = lroundf(change*100);\n\nwhile(amount &gt; 0)\n{\n  if ((amount-25) &gt;= 25)\n  {\n      amount  =  amount - 25;\n      count++;\n  }\n\n  else if ((amount-10) &gt;= 10)\n  {\n      amount =  amount - 10;\n      count++;\n  }\n\n  else if ((amount-5) &gt;= 5)\n  {\n      amount = amount -5;\n      count++;\n  }\n\n  else if((amount-1) &gt;= 1)\n  {\n      amount = amount -1;\n      count ++;\n      break;\n  }\n\n  else\n  {\n   printf(\"you have no change \\n\");   \n  }\n  }\n  printf(\"your number of coins is %i\\n\", count);\n\n  }\n</code></pre>\n\n<p>When I input my change as 1, I am given back 8 coins. Can't seem to find where the bug is. Can anyone help me?</p>\n"}, {"tags": ["c", "arrays", "variable-assignment"], "comments": [{"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 1, "creation_date": 1485953720, "post_id": 41980337, "comment_id": 71138175, "body": "Yes, you&#39;ve said it pretty clearly yourself - using just a for-loop (of some sort)."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7468879"}, "edited": false, "score": 0, "creation_date": 1485954104, "post_id": 41980384, "comment_id": 71138427, "body": "Hi, is <code>memcpy(a,b, sizeof (a));</code> a simpler version of what you are doing ?"}, {"owner": {"reputation": 8765, "user_id": 3417069, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/1504657819/picture?type=large", "display_name": "omri_saadon", "link": "https://stackoverflow.com/users/3417069/omri-saadon"}, "edited": false, "score": 0, "creation_date": 1485954429, "post_id": 41980384, "comment_id": 71138672, "body": "You still need to allocate memory to <code>a</code> and multiply the <code>sizeof</code> with the size of the data type."}], "tags": [], "owner": {"reputation": 8765, "user_id": 3417069, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/1504657819/picture?type=large", "display_name": "omri_saadon", "link": "https://stackoverflow.com/users/3417069/omri-saadon"}, "is_accepted": false, "score": 1, "last_activity_date": 1485953775, "creation_date": 1485953775, "answer_id": 41980384, "question_id": 41980337, "link": "https://stackoverflow.com/questions/41980337/error-message-if-i-try-to-copy-one-array-into-another-in-c/41980384#41980384", "title": "Error message if I try to copy one array into another in C", "body": "<p>In case of an int array, don't forget to include <code>&lt;string.h&gt;</code>:</p>\n\n<pre><code>int * intdup(int const * src, size_t len)\n{\n   int * p = malloc(len * sizeof(int));\n   memcpy(p, src, len * sizeof(int));\n   return p;\n}\n</code></pre>\n\n<p>You can't directly do array1 = array2. Because in this case you would manipulate the addresses of the arrays and not their values</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7468879"}, "edited": false, "score": 0, "creation_date": 1485954041, "post_id": 41980385, "comment_id": 71138387, "body": "Hi, thanks for your contribution, is <code>memcpy(a,b, sizeof (a));</code> acceptable in such a case ?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1485954101, "post_id": 41980385, "comment_id": 71138424, "body": "@Rizzo Yes, most likely"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1485954149, "post_id": 41980385, "comment_id": 71138464, "body": "@Rizzo; It depends on the size of destination array."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 3, "last_activity_date": 1485954562, "last_edit_date": 1485954562, "creation_date": 1485953779, "answer_id": 41980385, "question_id": 41980337, "link": "https://stackoverflow.com/questions/41980337/error-message-if-i-try-to-copy-one-array-into-another-in-c/41980385#41980385", "title": "Error message if I try to copy one array into another in C", "body": "<blockquote>\n  <p>.. <em>Even though this looks good to me,</em></p>\n</blockquote>\n\n<p>Wait, stop there. Arrays are not assignable. You cannot use an array type variable as LHS operand of assignment operator.</p>\n\n<p>With my emphasis, quoting <code>C11</code>, chapter \u00a76.5.16</p>\n\n<blockquote>\n  <p>An assignment operator shall have a <strong>modifiable lvalue as its left operand</strong>.</p>\n</blockquote>\n\n<p>and, from \u00a76.3.2.1</p>\n\n<blockquote>\n  <p>.... A <strong>modifiable lvalue is an lvalue that\n  does not have array type</strong>, does not have an incomplete type, does not have a const-qualified\n  type, and if it is a structure or union, does not have any member (including,\n  recursively, any member or element of all contained aggregates or unions) with a const-qualified\n  type.</p>\n</blockquote>\n\n<p>You need to either</p>\n\n<ul>\n<li>Loop over individual array elements and assign them one by one (in case the elements are arrays themselves, use this theory recursively)</li>\n<li>Use <code>memcpy()</code>.</li>\n</ul>\n\n<p>That said, <em>\"is memcpy preferred over a loop in case of small arrays?\"</em> does not have a definitive answer. You need to check the generated assembly code to make sure. With proper optimization enabled, compiler is likely to choose the best within the two most of the cases.</p>\n"}, {"tags": [], "owner": {"reputation": 968, "user_id": 7012517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a259636ec5ea90c4b7bc376c32f5c24f?s=128&d=identicon&r=PG", "display_name": "Shobhit", "link": "https://stackoverflow.com/users/7012517/shobhit"}, "is_accepted": true, "score": 0, "last_activity_date": 1485954128, "creation_date": 1485954128, "answer_id": 41980498, "question_id": 41980337, "link": "https://stackoverflow.com/questions/41980337/error-message-if-i-try-to-copy-one-array-into-another-in-c/41980498#41980498", "title": "Error message if I try to copy one array into another in C", "body": "<pre><code>/* Copying data from array 'a' to array 'b */\n   for (i = 0; i &lt; num; i++) {\n  arr2[i] = arr1[i];\n }\n</code></pre>\n\n<p>Arrays can't be assigned to or initialized from another array object in C++ because they can't in C, and they can't in C for historical reasons that aren't really relevant any more.</p>\n\n<p>In very early proto-C, there would have be some confusion whether an assignment like int a[] = {0}; int b[] = {0}; a = b; should copy the contents of array b to a, or re-seat the name a to refer to b. Likewise with initialization, whether a should be a copy of b or an alias. This ambiguity hasn't existed for 40 years: it soon became clear that if it were to be allowed then the sensible meaning in C (and C++) would be that it should copy, but arrays in C were never made into \"proper\" value types.</p>\n\n<p>There's no technical reason why it's impossible, and for example you can assign a struct type that has an array as a data member. The standard simply doesn't define your code to be correct C++.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7468879"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 531, "favorite_count": 0, "closed_date": 1485954176, "accepted_answer_id": 41980498, "answer_count": 3, "score": 2, "last_activity_date": 1485954562, "creation_date": 1485953617, "last_edit_date": 1485954528, "question_id": 41980337, "link": "https://stackoverflow.com/questions/41980337/error-message-if-i-try-to-copy-one-array-into-another-in-c", "closed_reason": "Duplicate", "title": "Error message if I try to copy one array into another in C", "body": "<p>The compiler gives me an error message if I try to copy one array into another by using the assignment operator. Why is that?</p>\n\n<p>Even though this looks good to me, the assignment,</p>\n\n<p><code>a = b;</code>   //a and b are arrays </p>\n\n<p>is illegal. Is there a simple way to copy one array into another using just a for-loop of some sort?</p>\n\n<p><strong>EDIT</strong> Is memcpy preferred over a loop in case of small arrays?</p>\n"}, {"tags": ["java", "c", "pic", "raspberry-pi3", "rs485"], "comments": [{"owner": {"reputation": 42880, "user_id": 982161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/kutcC.png?s=128&g=1", "display_name": "\u03a6Xoc\u0119 \uc6c3 \u041fepe&#250;pa \u30c4", "link": "https://stackoverflow.com/users/982161/%ce%a6xoc%c4%99-%ec%9b%83-%d0%9fepe%c3%bapa-%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1485953324, "post_id": 41980056, "comment_id": 71137934, "body": "how are you multiplexing that serial communication? can you upload the block diagram or some schematic of the circuit...?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1485954120, "post_id": 41980056, "comment_id": 71138440, "body": "&quot;when I send from the rpi an address that doesn&#39;t exist in the pics, no one replies to the rpi&quot; Isn&#39;t that according to specification though? If you try to address something which doesn&#39;t exist, your system is misconfigured."}], "answers": [{"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1485954381, "creation_date": 1485954381, "answer_id": 41980589, "question_id": 41980056, "link": "https://stackoverflow.com/questions/41980056/rpi-with-multiple-pics-over-rs485-ccs-compiler/41980589#41980589", "title": "RPI with multiple pics over rs485 - CCS compiler", "body": "<p>One obvious problem is that sending 10 bytes of data over UART with 9600 takes longer than 10ms. You shouldn't use some home-brewed dead-wait delay, but instead poll the UART rx flag in a loop.</p>\n\n<p>1 byte data = 1 start bit, 8 data bits, 1 stop bit (no partity, 1 stop bit) = 10 bits</p>\n\n<p>It takes 9600^-1 us to send one bit.</p>\n\n<p>9600^-1 * 10bits * 10 bytes = 10.42ms best case scenario</p>\n"}, {"tags": [], "owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1485963462, "creation_date": 1485963462, "answer_id": 41983719, "question_id": 41980056, "link": "https://stackoverflow.com/questions/41980056/rpi-with-multiple-pics-over-rs485-ccs-compiler/41983719#41983719", "title": "RPI with multiple pics over rs485 - CCS compiler", "body": "<p>On the PIC side, fgets() waits for a CR character, <strong>but you don't send it</strong> from RPI. Another problem is probably</p>\n\n<blockquote>\n  <p>while (serial.available() > 0) {\n                          data = serial.read();\n                      }</p>\n</blockquote>\n\n<p>It seems to me that you keep on overwriting the variable <code>data</code>.</p>\n"}], "owner": {"reputation": 349, "user_id": 5996498, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ebf58169d5bd216d4675a0530911c743?s=128&d=identicon&r=PG&f=1", "display_name": "Galilo Galilo", "link": "https://stackoverflow.com/users/5996498/galilo-galilo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 519, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1485963462, "creation_date": 1485952718, "question_id": 41980056, "link": "https://stackoverflow.com/questions/41980056/rpi-with-multiple-pics-over-rs485-ccs-compiler", "title": "RPI with multiple pics over rs485 - CCS compiler", "body": "<p>I am Trying to delpoy rpi3 as a master, pic as slave, and rs485 as a network medium.\nThe rpi loops over slaves' ids, it sends them one by one, and waits for a reply from the specified slave (pic).\nEvery pic reads the received data (address) and compares it to it's address, if it is the one, the pic must reply to the rpi.</p>\n\n<p>On rpi I am using pi4j java library, while on the pics I am coding with CCS compiler.</p>\n\n<p>The first problem is that when I send from the rpi an address that doesn't exist in the pics, no one replies to the rpi, and the pic I send it's address in the following instruction will also not reply.</p>\n\n<p><strong>The code for RPI is:</strong></p>\n\n<pre><code>import com.pi4j.io.gpio.GpioController;\nimport com.pi4j.io.gpio.GpioFactory;\nimport com.pi4j.io.gpio.GpioPinDigitalOutput;\nimport com.pi4j.io.gpio.PinState;\nimport com.pi4j.io.gpio.RaspiPin;\nimport com.pi4j.io.serial.*;\nimport com.pi4j.util.Console;\n\nimport java.io.IOException;\nimport java.nio.ByteBuffer;\nimport java.sql.Time;\n\n\npublic class SerialExample {\n\n    public void tryIt() throws InterruptedException, IOException {\n\n        final Console console = new Console();\n\n        // print program title/header\n        console.title(\"&lt;-- The Pi4J Project --&gt;\", \"Serial Communication Example\");\n\n        // allow for user to exit program using CTRL-C\n        console.promptForExit();\n\n        // create an instance of the serial communications class\n        final Serial serial = SerialFactory.createInstance();\n\n        try {\n            // create serial config object\n            SerialConfig config = new SerialConfig();\n\n            config.device(\"/dev/ttyAMA0\")\n                    .baud(Baud._9600)\n                    .dataBits(DataBits._8)\n                    .parity(Parity.NONE)\n                    .stopBits(StopBits._1)\n                    .flowControl(FlowControl.NONE);\n\n\n            // open the default serial device/port with the configuration settings\n            serial.open(config);\n            final GpioController gpio = GpioFactory.getInstance();\n\n            // provision gpio pin #01 as an output pin and turn on\n            final GpioPinDigitalOutput cts = gpio.provisionDigitalOutputPin(RaspiPin.GPIO_04, \"CTS\", PinState.HIGH);\n\n            while (true) {\n                short i = 1; // pic ids\n                while (i &lt; 5) {\n                    cts.high();\n                    serial.write(String.valueOf(i));\n                     System.out.println(\"to slave: \" + i);\n                    Thread.sleep(15);\n                    cts.low();\n                    Thread.sleep(150);\n                    byte[] data = null;\n\n                    while (serial.available() &gt; 0) {\n                        data = serial.read();\n                    }\n                    if (data == null) {\n                        System.out.println(\"[null data]\");\n                    } else {\n                        String myData = new String(data);\n                        System.out.println(\"reply from slave: \" + myData);\n                    }\n                    i++;\n                    Thread.sleep(1000);\n                }\n            }\n        } catch (IOException ex) {\n            console.println(\" ==&gt;&gt; SERIAL SETUP FAILED : \" + ex.getMessage());\n            return;\n        }\n    }\n}\n</code></pre>\n\n<p>The code of the pic is common among all pics, the only difference is the ids.\n<strong>Pic code is</strong></p>\n\n<pre><code>#include &lt;12F1822.h&gt;\n#include &lt;String.h&gt;\n#fuses NOMCLR INTRC_IO PLL_SW\n#use delay(clock=32000000)\n\n#use rs232(baud=9600, xmit=Pin_A0, rcv=Pin_A1,enable=Pin_A2, bits=8, errors, stream=RS485)\n\nvoid clear_usart_receiver(void) {\n    char c;\n    c = getc();\n    c = getc();\n}\nint id [] = {0, 2};\n\nvoid main() {\n\n    while (1) {\n        byte message[10];\n        fgets(message, RS485);\n        delay_ms(10);\n        if (message[0] == '2')\n\n        {\n            fputs(\"s2 reply\", RS485);\n        }\n        delay_ms(10);\n        clear_usart_receiver();\n    }\n}\n</code></pre>\n\n<p>I have tried removing the clear_usart_receiver(); from my pic code, then when a pic replies, the following one will not, the next one prints as planned, the following will print nothing also and so on.</p>\n"}, {"tags": ["c", "arrays", "function", "pointers", "return"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1485948369, "post_id": 41978575, "comment_id": 71134716, "body": "I want to make sure I understand. You pass the addresses of the four integers, and want to return an array containing their values sorted? Why pass addresses?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1485948403, "post_id": 41978575, "comment_id": 71134741, "body": "Are you sure it won&#39;t be simpler to sort the four integers so that <code>*n1 &lt;= *n2 &lt;= *n3 &lt;= *n4</code>?"}, {"owner": {"reputation": 368, "user_id": 7231592, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh5.googleusercontent.com/-pqtvxM0bnQM/AAAAAAAAAAI/AAAAAAAAAFc/BGT7D-FZXDU/photo.jpg?sz=128", "display_name": "Yellowfun", "link": "https://stackoverflow.com/users/7231592/yellowfun"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1485948501, "post_id": 41978575, "comment_id": 71134787, "body": "<a href=\"https://codeshare.io/5Pdd7X\" rel=\"nofollow noreferrer\">codeshare.io/5Pdd7X</a>"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1485948625, "post_id": 41978575, "comment_id": 71134866, "body": "You want the variables you passed to be sorted in the end or not?"}, {"owner": {"reputation": 368, "user_id": 7231592, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh5.googleusercontent.com/-pqtvxM0bnQM/AAAAAAAAAAI/AAAAAAAAAFc/BGT7D-FZXDU/photo.jpg?sz=128", "display_name": "Yellowfun", "link": "https://stackoverflow.com/users/7231592/yellowfun"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1485948785, "post_id": 41978575, "comment_id": 71134975, "body": "Yes, and they are sorted. if you print Arr they are sorted. But how can I return the entire array back to the calling routine? @ StoryTeller"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1485948827, "post_id": 41978575, "comment_id": 71134997, "body": "They aren&#39;t sorted. The array that contains the <b>copies of their values</b> is sorted."}, {"owner": {"reputation": 368, "user_id": 7231592, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh5.googleusercontent.com/-pqtvxM0bnQM/AAAAAAAAAAI/AAAAAAAAAFc/BGT7D-FZXDU/photo.jpg?sz=128", "display_name": "Yellowfun", "link": "https://stackoverflow.com/users/7231592/yellowfun"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1485948891, "post_id": 41978575, "comment_id": 71135036, "body": "no way to do I want?@StoryTeller"}], "answers": [{"comments": [{"owner": {"reputation": 368, "user_id": 7231592, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh5.googleusercontent.com/-pqtvxM0bnQM/AAAAAAAAAAI/AAAAAAAAAFc/BGT7D-FZXDU/photo.jpg?sz=128", "display_name": "Yellowfun", "link": "https://stackoverflow.com/users/7231592/yellowfun"}, "edited": false, "score": 0, "creation_date": 1485949294, "post_id": 41978782, "comment_id": 71135301, "body": "Thank you! If I wanted to return entire Arr[4]  back to main? void sort4 function  end with this last line of code ( return Arr; ). Is it possible?"}, {"owner": {"reputation": 368, "user_id": 7231592, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh5.googleusercontent.com/-pqtvxM0bnQM/AAAAAAAAAAI/AAAAAAAAAFc/BGT7D-FZXDU/photo.jpg?sz=128", "display_name": "Yellowfun", "link": "https://stackoverflow.com/users/7231592/yellowfun"}, "edited": false, "score": 0, "creation_date": 1485949462, "post_id": 41978782, "comment_id": 71135413, "body": "sort4 function would be no longer void it would be int that return array or pointer to array Arr."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 368, "user_id": 7231592, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh5.googleusercontent.com/-pqtvxM0bnQM/AAAAAAAAAAI/AAAAAAAAAFc/BGT7D-FZXDU/photo.jpg?sz=128", "display_name": "Yellowfun", "link": "https://stackoverflow.com/users/7231592/yellowfun"}, "edited": false, "score": 1, "creation_date": 1485949465, "post_id": 41978782, "comment_id": 71135415, "body": "@Yellowfun - No. It will decay into an address to the first element. And you will return an address to something that goes out of scope, a dangling pointer. You can try just accepting an array to fill from the calling code."}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 0, "last_activity_date": 1485948894, "creation_date": 1485948894, "answer_id": 41978782, "question_id": 41978575, "link": "https://stackoverflow.com/questions/41978575/function-that-returns-int-array-or-pointer-to-int-array-back-to-calling-rout/41978782#41978782", "title": "Function that returns int array[] or pointer to int array[] back to calling routine in C", "body": "<p>If you want to sort four individual integers in ascending order, and you pass their addresses, you need to make sure that you swap the <strong>pointees</strong>. Here's your code amended with the correct pointer arithmetic:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid sort4(int *n1, int *n2, int *n3, int *n4)\n{\n    int *Arr[] = { n1, n2, n3, n4 };\n    int **i = Arr, **j, temp;\n    int  ** const arrayEnd = Arr + 4;\n\n    for (; i != arrayEnd - 1; i++)\n        for (j = i + 1; j != arrayEnd; j++)\n            if (**i &gt; **j) {\n                temp = **i;\n                **i = **j;\n                **j = temp;\n            }  \n}\n\nint main(void)\n{\n    int i1 = 125;\n    int i2 = 100;\n    int i3 = 10;\n    int i4 = 50;\n\n    printf(\"i1 = %i, i2 = %i, i3 = %i, i4 = %i\\n\", i1, i2, i3, i4);\n\n    sort4(&amp;i1, &amp;i2, &amp;i3, &amp;i4);\n\n    printf(\"i1 = %i, i2 = %i, i3 = %i, i4 = %i\\n\", i1, i2, i3, i4);\n\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"http://ideone.com/YvKlMW\" rel=\"nofollow noreferrer\">Output</a>:</p>\n\n<blockquote>\n  <p>i1 = 125, i2 = 100, i3 = 10, i4 = 50<br>\n  i1 = 10, i2 = 50, i3 = 100, i4 = 125</p>\n</blockquote>\n"}], "owner": {"reputation": 368, "user_id": 7231592, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh5.googleusercontent.com/-pqtvxM0bnQM/AAAAAAAAAAI/AAAAAAAAAFc/BGT7D-FZXDU/photo.jpg?sz=128", "display_name": "Yellowfun", "link": "https://stackoverflow.com/users/7231592/yellowfun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 41978782, "answer_count": 1, "score": -1, "last_activity_date": 1485948894, "creation_date": 1485948238, "question_id": 41978575, "link": "https://stackoverflow.com/questions/41978575/function-that-returns-int-array-or-pointer-to-int-array-back-to-calling-rout", "title": "Function that returns int array[] or pointer to int array[] back to calling routine in C", "body": "<p>How can I make this function return <code>int array[4]</code> or pointer to <code>*array[4]</code> ? \nThis array with 4 integers is calculated in ascending order via pointers and bubble sort in the scope of this function and then returns to main to print.</p>\n\n<p>I can print this array in the scope of this fuction but I'm wondering can I pass it back to main (calling function)?</p>\n\n<p><code>void sort4(int *n1, int *n2, int *n3, int *n4)</code> if I change it to \n<code>int X[4] sort4(int *n1, int *n2, int *n3, int *n4)</code> doesn't work. And this too</p>\n\n<pre><code>int *X[4] sort4(int *n1, int *n2, int *n3, int *n4)\n</code></pre>\n"}, {"tags": ["c", "network-programming"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7499930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a2ee130ceba664272ca1b441e61b0fc?s=128&d=identicon&r=PG&f=1", "display_name": "Freddy Unicorn", "link": "https://stackoverflow.com/users/7499930/freddy-unicorn"}, "edited": false, "score": 0, "creation_date": 1485969269, "post_id": 41979934, "comment_id": 71149040, "body": "Thanks, I&#39;ll try if wpa_supplicant is quicker.  With system or popen I&#39;m having the same issues (tried them before I got to my current solution) as my call already does not wait for command execution. The problem is not that I have to wait for command execution, the problem is that the command execution of a new thread takes more time than the time I wait between starting another thread."}, {"owner": {"reputation": 349, "user_id": 2465256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/204a77228ae535805653a77ded02ae9c?s=128&d=identicon&r=PG&f=1", "display_name": "metamorphling", "link": "https://stackoverflow.com/users/2465256/metamorphling"}, "reply_to_user": {"reputation": 3, "user_id": 7499930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a2ee130ceba664272ca1b441e61b0fc?s=128&d=identicon&r=PG&f=1", "display_name": "Freddy Unicorn", "link": "https://stackoverflow.com/users/7499930/freddy-unicorn"}, "edited": false, "score": 0, "creation_date": 1486003596, "post_id": 41979934, "comment_id": 71163812, "body": "@FreddyUnicorn maybe, the problem is actually about thread management rather than &quot;a better way to send probe requests&quot;? I don&#39;t remember seeing any regulations on minimal probe request intervals, it means that it heavily depends on module/driver/interface tool. If you no matter what need those fast requests, maybe try to build another driver for your module. If it won&#39;t won&#39;t help, guess you have to hold your threads: wait for request to end and join thread cleanly."}, {"owner": {"reputation": 349, "user_id": 2465256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/204a77228ae535805653a77ded02ae9c?s=128&d=identicon&r=PG&f=1", "display_name": "metamorphling", "link": "https://stackoverflow.com/users/2465256/metamorphling"}, "reply_to_user": {"reputation": 3, "user_id": 7499930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a2ee130ceba664272ca1b441e61b0fc?s=128&d=identicon&r=PG&f=1", "display_name": "Freddy Unicorn", "link": "https://stackoverflow.com/users/7499930/freddy-unicorn"}, "edited": false, "score": 0, "creation_date": 1486003939, "post_id": 41979934, "comment_id": 71163894, "body": "@FreddyUnicorn also, I have had my share of problems with iwlist scanning. What I was doing: every 10 secs a thread spawned, called an iwlist scan and closed afterwards. It worked flawlessly for 4-5 hours, no unneeded processes in &quot;top&quot;. I left my board for overnight testing and in the morning I&#39;ve had a bunch of shells with iwlist stuck inside them. That was ugly, good God my driver had a special interface to set background scan with interval(min was 3 seconds though, but I needed it once per 10 secs so it was ok). Not much of a help, just my experience."}, {"owner": {"reputation": 3, "user_id": 7499930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a2ee130ceba664272ca1b441e61b0fc?s=128&d=identicon&r=PG&f=1", "display_name": "Freddy Unicorn", "link": "https://stackoverflow.com/users/7499930/freddy-unicorn"}, "edited": false, "score": 0, "creation_date": 1492518970, "post_id": 41979934, "comment_id": 73999457, "body": "Sorry for the long delay of my answer: I tried to use wpa_supplicant, but unfortunately, I have to use the same interface for other uses as well (a software access point for example) and this seems to be not working with wpa_supplicant. I&#39;ll accept your answer, because it seems to work if you want to use the interface with wpa_supplicant only, but I will keep on looking for a better answer."}], "tags": [], "owner": {"reputation": 349, "user_id": 2465256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/204a77228ae535805653a77ded02ae9c?s=128&d=identicon&r=PG&f=1", "display_name": "metamorphling", "link": "https://stackoverflow.com/users/2465256/metamorphling"}, "is_accepted": true, "score": 0, "last_activity_date": 1485952366, "creation_date": 1485952366, "answer_id": 41979934, "question_id": 41978457, "link": "https://stackoverflow.com/questions/41978457/send-probe-requests-without-waiting-for-an-answer-in-c/41979934#41979934", "title": "Send probe requests without waiting for an answer in C", "body": "<p>There are a few options. As far as I know popen() with \"w\" parameter does not wait for command execution, though it forks the process and pclose() will wait until command executes. system() just waits for command execution, but you might try feeding it to shell like this</p>\n\n<pre><code>system(\"iwlist wlan0 scan &amp;\")\n</code></pre>\n\n<p>That is, if you are stuck with iwlist. \nAs an alternative you can try using wpa_supplicant. It has a \"scan\" interface and \"scan_results\", first one sends request while the later gives out results.</p>\n\n<pre><code>  for (;;)\n  {\n    FILE *fp = popen (\"wpa_cli -i wlan0 scan\", \"w\");\n    if (fp)\n      pclose (fp);\n    sleep (1);\n  }\n</code></pre>\n\n<p>(implying wpa_supplicant is up and running).</p>\n\n<p>Last but not least, there are drivers which allow doing background scanning with their own interfaces, have seen it on proprietary Redpine driver.</p>\n"}], "owner": {"reputation": 3, "user_id": 7499930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a2ee130ceba664272ca1b441e61b0fc?s=128&d=identicon&r=PG&f=1", "display_name": "Freddy Unicorn", "link": "https://stackoverflow.com/users/7499930/freddy-unicorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 41979934, "answer_count": 1, "score": 0, "last_activity_date": 1485952366, "creation_date": 1485947885, "question_id": 41978457, "link": "https://stackoverflow.com/questions/41978457/send-probe-requests-without-waiting-for-an-answer-in-c", "title": "Send probe requests without waiting for an answer in C", "body": "<p>for a project I am working on, I have to regularly send probe requests (~ 10 every 10 ms) for a chosen SSID.</p>\n\n<p>Currently I am doing this with the following code:</p>\n\n<pre><code>char *args[] = {\"iwlist\", INTERFACE, \"scan\", \"essid\", ssid, (char *) NULL};\nrunQuietlyNonblocking(args);\n</code></pre>\n\n<p>where <code>runQuietlyNonblocking</code> runs the command in args with execvp and fork without waiting for the new thread to finish.</p>\n\n<p>But since iwlist scan waits for probe answers and this takes more time than I need to create new probe requests, the probe requests get send but I got about 10000 threads after about half an hour and the program crashes due to memory shortage.</p>\n\n<p>I am working on a raspberry pi with raspbian lite installed.\nIs there a better way to send probe requests without the need to wait for an answer? Can i send probe requests manually or tell iwlist not to look for responses?</p>\n"}, {"tags": ["c", "arrays", "pointers", "byte", "cortex-m"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1485947715, "post_id": 41978340, "comment_id": 71134311, "body": "Describe how it <i>fails</i>. Is <code>c</code> pointing to another integer?"}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 3, "creation_date": 1485947813, "post_id": 41978405, "comment_id": 71134370, "body": "There might still be an endianness issue with that solution."}, {"owner": {"reputation": 105, "user_id": 5667764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d69ca044c148150ef76bd5b41ab7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Mrmj", "link": "https://stackoverflow.com/users/5667764/mrmj"}, "edited": false, "score": 0, "creation_date": 1485951377, "post_id": 41978405, "comment_id": 71136688, "body": "@someProgrammerDude : Though this can solve the problem, but if u compare the efficiency, My code generates one load instruction yours will generate Hell lot of extra code b/c of memcpy call Furthermore, i dont have memcpy available here :("}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 105, "user_id": 5667764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d69ca044c148150ef76bd5b41ab7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Mrmj", "link": "https://stackoverflow.com/users/5667764/mrmj"}, "edited": false, "score": 2, "creation_date": 1485951832, "post_id": 41978405, "comment_id": 71136999, "body": "@Mrmj Most compilers have special handling of <code>memcpy</code> to make them <i>very</i> efficient, and might even replace them inline with only a few instructions. You say you can code it with only a single instruction? But if the problem is with alignment, then you actually <i>can&#39;t</i> do it with only a single instruction. You should also consider maintainability and the legibility of the code, especially if endianness is not an issue. Lastly, why don&#39;t you try it out? Build with optimization and look at the generated assembly code?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 105, "user_id": 5667764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d69ca044c148150ef76bd5b41ab7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Mrmj", "link": "https://stackoverflow.com/users/5667764/mrmj"}, "edited": false, "score": 0, "creation_date": 1485952193, "post_id": 41978405, "comment_id": 71137261, "body": "@Mrmj And note that unaligned access <i>is</i> invalid on the Cortex-M0 (<a href=\"http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0497a/BABFAIGG.html\" rel=\"nofollow noreferrer\">reference</a>)."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 105, "user_id": 5667764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d69ca044c148150ef76bd5b41ab7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Mrmj", "link": "https://stackoverflow.com/users/5667764/mrmj"}, "edited": false, "score": 1, "creation_date": 1485952677, "post_id": 41978405, "comment_id": 71137558, "body": "@Mrmj Lastly the Cortex M0 is by default little-endian (the <a href=\"http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0497a/Cihehdge.html\" rel=\"nofollow noreferrer\"><code>ENDIANNESS</code> flag of <code>AIRCR</code> register</a> is <a href=\"http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0497a/Cihehdge.html\" rel=\"nofollow noreferrer\">by default zero</a>), meaning that if you communicate with other little-endian systems (which all x86 systems are) then the only possible reasons for a failure will be due to alignment. But we don&#39;t actually know that because your question is to vague."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 105, "user_id": 5667764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d69ca044c148150ef76bd5b41ab7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Mrmj", "link": "https://stackoverflow.com/users/5667764/mrmj"}, "edited": false, "score": 0, "creation_date": 1485952693, "post_id": 41978405, "comment_id": 71137567, "body": "@Mrmj Please take some time to  <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>, and learn how to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a>."}, {"owner": {"reputation": 105, "user_id": 5667764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d69ca044c148150ef76bd5b41ab7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Mrmj", "link": "https://stackoverflow.com/users/5667764/mrmj"}, "edited": false, "score": 0, "creation_date": 1485953610, "post_id": 41978405, "comment_id": 71138109, "body": "@ Some programmer dude : Yes U got it right friend! The problem is b/c unaligned access.  I didn&#39;t say , i can do that with one instr. I said &quot;My code generates one load instruction&quot;,  here i mean , my current code which is working on some archs, generates only one instr(LDR) and job done , So i was looking for something close to it which works for all archs.  +1 for Cortex Link  Surely i&#39;ll try to improve on my qus. :)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 105, "user_id": 5667764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d69ca044c148150ef76bd5b41ab7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Mrmj", "link": "https://stackoverflow.com/users/5667764/mrmj"}, "edited": false, "score": 0, "creation_date": 1485953910, "post_id": 41978405, "comment_id": 71138299, "body": "@Mrmj Glad to have helped, even if answer isn&#39;t exactly what you want to hear. :) However, the only portable way to handle this (without caring about endianness issues) is to use <code>memcpy</code>. It will probably be more efficient than you expect anyway. :)"}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 7, "last_activity_date": 1485949898, "last_edit_date": 1485949898, "creation_date": 1485947734, "answer_id": 41978405, "question_id": 41978340, "link": "https://stackoverflow.com/questions/41978340/how-to-read-4-bytes-of-data-from-a-given-char-pointer-in-c/41978405#41978405", "title": "How to read 4 bytes of data from a given char pointer in C", "body": "<p>The problem <em>could</em> be because of <em>alignment</em>. Some CPU architectures can't read or write non-byte values on unaligned addresses.</p>\n\n<p>The solution is to make unaligned byte-access instead, which can easily be done with <a href=\"http://en.cppreference.com/w/c/string/byte/memcpy\" rel=\"noreferrer\"><code>memcpy</code></a>:</p>\n\n<pre><code>memcpy(&amp;a, c, sizeof a);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105, "user_id": 5667764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d69ca044c148150ef76bd5b41ab7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Mrmj", "link": "https://stackoverflow.com/users/5667764/mrmj"}, "edited": false, "score": 0, "creation_date": 1485951550, "post_id": 41978621, "comment_id": 71136812, "body": "This generates alot (at least from my point of view) of instructions compared to mine which generates only one assembly instruction."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 105, "user_id": 5667764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d69ca044c148150ef76bd5b41ab7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Mrmj", "link": "https://stackoverflow.com/users/5667764/mrmj"}, "edited": false, "score": 0, "creation_date": 1485951740, "post_id": 41978621, "comment_id": 71136948, "body": "As I wrote: if you are aware of endianness issues you are free to use you method.  Otherwise you must take care of it."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1485953945, "post_id": 41978621, "comment_id": 71138322, "body": "Why would he have a pointer to an integer in memory, which is not of the same endianess as the CPU? That seems rather unrelated to the question."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1485955569, "post_id": 41978621, "comment_id": 71139473, "body": "@Lundin I&#39;ve seen too many times code like this accessing payload of bytes packets to extract data (e.g modbus). So probably I am biased ;)"}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 0, "last_activity_date": 1485948350, "creation_date": 1485948350, "answer_id": 41978621, "question_id": 41978340, "link": "https://stackoverflow.com/questions/41978340/how-to-read-4-bytes-of-data-from-a-given-char-pointer-in-c/41978621#41978621", "title": "How to read 4 bytes of data from a given char pointer in C", "body": "<p>Depending on the <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">endianness</a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    unsigned char bytes[] = { 0xAA, 0x55, 0xAA, 0x55 };\n    unsigned int a=0;\n    unsigned char* c = bytes;\n\n    a += (*c++ &amp; 0xFFFFFFFFu) &lt;&lt; 0;\n    a += (*c++ &amp; 0xFFFFFFFFu) &lt;&lt; 8;\n    a += (*c++ &amp; 0xFFFFFFFFu) &lt;&lt; 16;\n    a += (*c &amp; 0xFFFFFFFFu) &lt;&lt; 24;\n\n    printf(\"HEX: %X\\n\", a);\n\n    a = 0;\n    c = bytes;\n\n    a |= (*c++ &amp; 0xFFFFFFFFu) &lt;&lt; 24;\n    a |= (*c++ &amp; 0xFFFFFFFFu) &lt;&lt; 16;\n    a |= (*c++ &amp; 0xFFFFFFFFu) &lt;&lt; 8;\n    a |= (*c &amp; 0xFFFFFFFFu) &lt;&lt; 0;\n\n    printf(\"HEX: %X\\n\", a);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1485953953, "post_id": 41978641, "comment_id": 71138330, "body": "Why would he have a pointer to an integer in memory, which is not of the same endianess as the CPU? That seems rather unrelated to the question."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 1, "last_activity_date": 1485948438, "creation_date": 1485948438, "answer_id": 41978641, "question_id": 41978340, "link": "https://stackoverflow.com/questions/41978340/how-to-read-4-bytes-of-data-from-a-given-char-pointer-in-c/41978641#41978641", "title": "How to read 4 bytes of data from a given char pointer in C", "body": "<p>If endianness is an issue for you:</p>\n\n<p>Instead of:</p>\n\n<pre><code>a = *(int*)c;  // Assembly is LDR    r1, [r6,#0x00]\n</code></pre>\n\n<p>you need this:</p>\n\n<p>On big endian systems:</p>\n\n<pre><code>a = c[0] &lt;&lt; 24 | c[1] &lt;&lt; 16 | c[2] &lt;&lt; 8 | c[3];\n</code></pre>\n\n<p>On little endian systems:</p>\n\n<pre><code>a = c[3] &lt;&lt; 24 | c[2] &lt;&lt; 16 | c[1] &lt;&lt; 8 | c[0];\n\n// probably faster (only on little endian systems) :\nmemcpy(&amp;a, c, sizeof a);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 4, "last_activity_date": 1485954027, "last_edit_date": 1495540389, "creation_date": 1485953121, "answer_id": 41980201, "question_id": 41978340, "link": "https://stackoverflow.com/questions/41978340/how-to-read-4-bytes-of-data-from-a-given-char-pointer-in-c/41980201#41980201", "title": "How to read 4 bytes of data from a given char pointer in C", "body": "<p>There are at many different problems here.</p>\n\n<ul>\n<li>Alignment. The char pointer must point at an aligned address if you wish to read an integer at that address.</li>\n<li>Signedness of <code>char</code>. It is implementation-defined whether <code>char</code> is treated as signed or unsigned. It is therefore a bad type to use for any form of bit/byte manipulation. Instead, use <code>uint8_t</code>.</li>\n<li>Pointer aliasing. Casting a raw address pointed at by a <code>char*</code> to an <code>int*</code> is undefined behavior as it violates the so-called <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">strict aliasing rule</a>. This could cause your code to get incorrectly optimized by the compiler (particularly gcc). The other way around, from <code>int*</code> to <code>char*</code> would have been fine though.</li>\n</ul>\n\n<p>Endianess is <em>not</em> an issue if the stored integer is already in the same endianess format as that of the current system. If not, you'd have to convert it, but that's quite unrelated to the question here...</p>\n\n<p>Example of a portable, safe solution:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;string.h&gt;\n\n#include &lt;stdio.h&gt;\n#include &lt;inttypes.h&gt;\n\n\nint main (void) {\n\n  int x = 123;\n  uint8_t* c = (uint8_t*)&amp;x; // point to something that is an int\n  assert((uintptr_t)c % _Alignof(uint32_t) == 0); // ensure no misalignment\n\n  uint32_t i;\n  memcpy(&amp;i, c, sizeof(i)); // safely copy data without violating strict aliasing\n\n  printf(\"%\"PRIu32, i); // print 123\n\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 5667764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d69ca044c148150ef76bd5b41ab7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Mrmj", "link": "https://stackoverflow.com/users/5667764/mrmj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7162, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1485954027, "creation_date": 1485947563, "question_id": 41978340, "link": "https://stackoverflow.com/questions/41978340/how-to-read-4-bytes-of-data-from-a-given-char-pointer-in-c", "title": "How to read 4 bytes of data from a given char pointer in C", "body": "<p><br>\nScenario is that, i wanna read 4 bytes of data from a given pointer which is of type char.<br>\n<strong>Eg:</strong> Consider the following -</p>\n\n<pre><code>int a=0;\nchar* c; // This will have some address \n</code></pre>\n\n<p>What i wanna do is read 4 bytes starting from c (i.e. the address) and assign them in <code>variable a</code> which is an integer.</p>\n\n<p><strong>My Solution:</strong> <br></p>\n\n<pre><code>a = *(int*)c;  // Assembly is LDR    r1, [r6,#0x00]\n</code></pre>\n\n<p><strong>My Problem:</strong><br>\nAbove solution works well on some architectures but fails on some.\nTo be specific, in my case, it fails on Arm CortexM0.</p>\n\n<p>If any one has any portable, highly efficient(with minimum assembly) replacement of my solution please share, it would be a great help to me and I thank you for that in advance ;)</p>\n\n<p>Please ask if more info needed.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 0, "creation_date": 1485947509, "post_id": 41978257, "comment_id": 71134201, "body": "if grab- and releasesemaphore uses the same semaphore, version 1 should be fine."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1485947514, "post_id": 41978257, "comment_id": 71134203, "body": "As long as you&#39;re talking about the <i>same</i> semaphore in each case, the two versions should be identical."}], "answers": [{"tags": [], "owner": {"reputation": 2331, "user_id": 5563916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2ccad50fd4a22055ffb2ccf0859c5e?s=128&d=identicon&r=PG&f=1", "display_name": "nnovich-OK", "link": "https://stackoverflow.com/users/5563916/nnovich-ok"}, "is_accepted": false, "score": 0, "last_activity_date": 1486665942, "last_edit_date": 1495540892, "creation_date": 1486665942, "answer_id": 42144566, "question_id": 41978257, "link": "https://stackoverflow.com/questions/41978257/semaphores-and-possibly-non-reentrant-function-in-embedded-c/42144566#42144566", "title": "Semaphores and possibly non-reentrant function in embedded C", "body": "<p>These two versions have identical functionality, since call to <code>logmytext</code> is protected. The second one is more error prone, some developer will definitely forget to grab semaphore in future calls to <code>logmytest</code>, so I wouldn't recommend it. Similar topic is described <a href=\"https://stackoverflow.com/questions/41331325/calling-a-function-with-input-arguments-in-multithreading/41331706\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 2924, "user_id": 2066459, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8408d7e5ef47a2e2af09f3c6da6e1a6?s=128&d=identicon&r=PG", "display_name": "Robert Jacobs", "link": "https://stackoverflow.com/users/2066459/robert-jacobs"}, "is_accepted": false, "score": 0, "last_activity_date": 1486665966, "creation_date": 1486665966, "answer_id": 42144574, "question_id": 41978257, "link": "https://stackoverflow.com/questions/41978257/semaphores-and-possibly-non-reentrant-function-in-embedded-c/42144574#42144574", "title": "Semaphores and possibly non-reentrant function in embedded C", "body": "<p>Reason to like version 1.\nIf you call <code>logmytext</code> more than once in each thread, and you want to lock and unlock each time, then it looks better writing the code.</p>\n\n<p>Reason to like version 2.</p>\n\n<pre><code>grabsemaphore(); \nlogmytext(\"Just started A\");\nlogmytext(\"More Text\");\nlogmytext(\"More Text\");\nlogmytext(\"More Text\");\nlogmytext(\"More Text\");\nlogmytext(\"More Text\");\nreleasesemaphore(); \n</code></pre>\n\n<p>You can lock less often if you are calling the same function many times in a row.</p>\n"}], "owner": {"reputation": 44, "user_id": 7499786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d3b43605a46dcbb6cb926a665ce309e?s=128&d=identicon&r=PG&f=1", "display_name": "P Oltergeist", "link": "https://stackoverflow.com/users/7499786/p-oltergeist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1486665966, "creation_date": 1485947343, "last_edit_date": 1486665407, "question_id": 41978257, "link": "https://stackoverflow.com/questions/41978257/semaphores-and-possibly-non-reentrant-function-in-embedded-c", "title": "Semaphores and possibly non-reentrant function in embedded C", "body": "<p>The following worry has come up: two threads can write simultaneously to a flash, so we use semaphores. But will the writing function logmytext() in <strong>version1</strong> below with \"internal\" semaphore be non-reentrant? I.e. is there a chance that the two texts may get jumbled?</p>\n\n<p>So should we use <strong>version2</strong> with \"external\" semaphore (which primarily requires alot of typing). Or are we just worrying too much?\n(Note: this is pseudo-code-C, and \"external\" and \"internal\" are not to be taken literally).</p>\n\n<p><strong>version1:</strong></p>\n\n<pre><code>thread_a() {\n  logmytext(\"Just started A\");\n}\n\nthread_b() {\n  logmytext(\"Just started B\");\n}\n\nvoid logmytext(atextstring) {\n    grabsemaphore(); // has tread_b text overwritten thread_a text now?  \n    writetoflash(atextstring,1,2,3);\n    releasesemaphore();\n}\n</code></pre>\n\n<p><strong>version2:</strong></p>\n\n<pre><code>thread_a() {\n    grabsemaphore(); // stop before the potential danger.\n    logmytext(\"Just started A\");\n    releasesemaphore(); // but a lot of code to type.\n}\n\nthread_b() {\n    grabsemaphore();\n    logmytext(\"Just started B\");\n    releasesemaphore();\n}\nvoid logmytext(atextstring) { // no semaphore in here\n    writetoflash(atextstring,1,2,3);\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "linux", "package-managers", "conan"], "comments": [{"owner": {"reputation": 3796, "user_id": 3215383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yAGNQ.jpg?s=128&g=1", "display_name": "drodri", "link": "https://stackoverflow.com/users/3215383/drodri"}, "edited": false, "score": 0, "creation_date": 1485948631, "post_id": 41978077, "comment_id": 71134871, "body": "Sorry, this question has some issues. First you have to properly describe your folder layout, which files in which folders. Then copy verbatim the command you are typing, from which location (folder, pwd). Don&#39;t do it in an external image file, do it in the question itself. Questions have to be mostly self-contained. CMake is not a compiler, it is a meta-build system, that will typically generate Makefiles (for your Linux distro), that will use gcc or other compiler."}, {"owner": {"reputation": 3796, "user_id": 3215383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yAGNQ.jpg?s=128&g=1", "display_name": "drodri", "link": "https://stackoverflow.com/users/3215383/drodri"}, "edited": false, "score": 0, "creation_date": 1485949160, "post_id": 41978077, "comment_id": 71135197, "body": "There are two types of conanfiles .txt and .py, you have to use an extension to let conan know which type are you using. You can change the filename, but please keep the extension"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7127267"}, "reply_to_user": {"reputation": 3796, "user_id": 3215383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yAGNQ.jpg?s=128&g=1", "display_name": "drodri", "link": "https://stackoverflow.com/users/3215383/drodri"}, "edited": false, "score": 0, "creation_date": 1485949764, "post_id": 41978077, "comment_id": 71135607, "body": "Ok sorry... I modified the question"}, {"owner": {"reputation": 3796, "user_id": 3215383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yAGNQ.jpg?s=128&g=1", "display_name": "drodri", "link": "https://stackoverflow.com/users/3215383/drodri"}, "edited": false, "score": 0, "creation_date": 1485949823, "post_id": 41978077, "comment_id": 71135644, "body": "You have an extra leading &quot;..&quot;, unnecessary to specify the path, you are already using it in the --file argument"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7127267"}, "edited": false, "score": 0, "creation_date": 1485950110, "post_id": 41979117, "comment_id": 71135836, "body": "Another problem :  [user build]$ conan install --file Conanfile.txt .. ERROR: Conanfile: &#39;settings.compiler&#39; value not defined  setting.compiler I don&#39;t find it"}, {"owner": {"reputation": 3796, "user_id": 3215383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yAGNQ.jpg?s=128&g=1", "display_name": "drodri", "link": "https://stackoverflow.com/users/3215383/drodri"}, "edited": false, "score": 0, "creation_date": 1485950606, "post_id": 41979117, "comment_id": 71136183, "body": "Yes, but that is a different issue. You should probably submit a new question, this one regarding the command not locating the Conanfile seems that was already addressed. Also, it seems that your knowledge of conan might be a bit preliminary, I suggest doing a complete execution of the getting started in <a href=\"http://docs.conan.io/en/latest/getting_started.html\" rel=\"nofollow noreferrer\">docs.conan.io/en/latest/getting_started.html</a> focus on #building-with-other-configurations section. It seems in your case detection of your default compiler failed, maybe was not installed? Please submit a new question with details"}], "tags": [], "owner": {"reputation": 3796, "user_id": 3215383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yAGNQ.jpg?s=128&g=1", "display_name": "drodri", "link": "https://stackoverflow.com/users/3215383/drodri"}, "is_accepted": true, "score": 5, "last_activity_date": 1485949923, "creation_date": 1485949923, "answer_id": 41979117, "question_id": 41978077, "link": "https://stackoverflow.com/questions/41978077/building-a-project-with-conan-c-c-package-manager/41979117#41979117", "title": "Building a project with Conan C/C++ Package Manager", "body": "<p>You have an extra leading path. Use either:</p>\n\n<pre><code>[user build]$ conan install --file ../Conanfile.txt\n</code></pre>\n\n<p>or</p>\n\n<pre><code>[user build]$ conan install --file Conanfile.txt ..\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7127267"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2876, "favorite_count": 0, "accepted_answer_id": 41979117, "answer_count": 1, "score": 0, "last_activity_date": 1511878525, "creation_date": 1485946847, "last_edit_date": 1511878525, "question_id": 41978077, "link": "https://stackoverflow.com/questions/41978077/building-a-project-with-conan-c-c-package-manager", "title": "Building a project with Conan C/C++ Package Manager", "body": "<p>Hy all, </p>\n\n<p>I want to build a project with Conan C/C++ Package manager, i have some issues... it can't find the Conanfile but the Conanfile exists! ...</p>\n\n<p>CentOs ...</p>\n\n<p>I have a folder \"mytimer\" : </p>\n\n<pre><code>[user mytimer]$ ls\nbuild  CMakeLists.txt  Conanfile.txt  LICENSE  README.md  timer.cpp\n</code></pre>\n\n<p>and I want to build in \"build\" folder : </p>\n\n<pre><code>[user mytimer]$ cd build\n[user build]$ conan install --file ../Conanfile.txt ..\n**ERROR: Conanfile not found!**\n</code></pre>\n\n<p>How can I fix this ? thank you :)</p>\n"}, {"tags": ["c", "signal-processing", "fixed-point"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1485946476, "post_id": 41977852, "comment_id": 71133512, "body": "How about just clamping when converting to Q6.25?"}, {"owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1485951403, "post_id": 41977852, "comment_id": 71136707, "body": "Could you elaborate?"}, {"owner": {"reputation": 989, "user_id": 6534215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kSf1u.png?s=128&g=1", "display_name": "Mouse On Mars", "link": "https://stackoverflow.com/users/6534215/mouse-on-mars"}, "edited": false, "score": 0, "creation_date": 1485961273, "post_id": 41977852, "comment_id": 71143482, "body": "How about prescaling the input value, i.e.  out_mag_p = 10^(in_db/20/p) and then your final magnitude value becomes:  out_mag = out_mag_p^p"}, {"owner": {"reputation": 820, "user_id": 1675589, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a35386e8014459e87a744f8a00b0f3c1?s=128&d=identicon&r=PG", "display_name": "Michel Rouzic", "link": "https://stackoverflow.com/users/1675589/michel-rouzic"}, "edited": false, "score": 0, "creation_date": 1486207320, "post_id": 41977852, "comment_id": 71252986, "body": "Well what on Earth do you want to do with a 100000 value if you can&#39;t store it? It&#39;s not a question for us, it&#39;s a question for you, you chose a format that doesn&#39;t allow for such large values, why, and then why do you want to store a value so large the format you chose can&#39;t take it?"}, {"owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "reply_to_user": {"reputation": 989, "user_id": 6534215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kSf1u.png?s=128&g=1", "display_name": "Mouse On Mars", "link": "https://stackoverflow.com/users/6534215/mouse-on-mars"}, "edited": false, "score": 0, "creation_date": 1486363664, "post_id": 41977852, "comment_id": 71295536, "body": "Thanks @MichaelC. That&#39;s a good idea, but I think I found a better solution (see my answer)."}, {"owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "reply_to_user": {"reputation": 820, "user_id": 1675589, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a35386e8014459e87a744f8a00b0f3c1?s=128&d=identicon&r=PG", "display_name": "Michel Rouzic", "link": "https://stackoverflow.com/users/1675589/michel-rouzic"}, "edited": false, "score": 0, "creation_date": 1486363858, "post_id": 41977852, "comment_id": 71295629, "body": "@MichelRouzic Thanks. I didn&#39;t choose the formats, they are dictated by the target DSP processor and the 3rd party library."}, {"owner": {"reputation": 820, "user_id": 1675589, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a35386e8014459e87a744f8a00b0f3c1?s=128&d=identicon&r=PG", "display_name": "Michel Rouzic", "link": "https://stackoverflow.com/users/1675589/michel-rouzic"}, "edited": false, "score": 0, "creation_date": 1486378956, "post_id": 41977852, "comment_id": 71303675, "body": "Okay in that case just subtract some dB to your input value (let&#39;s say 20) so you get a result 10 times lower, for instance. If you use division then you have to use an exponent, which is slow."}], "answers": [{"tags": [], "owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "is_accepted": true, "score": 0, "last_activity_date": 1486363926, "last_edit_date": 1486363926, "creation_date": 1486363575, "answer_id": 42061836, "question_id": 41977852, "link": "https://stackoverflow.com/questions/41977852/fixed-point-out-q15-antilog-in-q25-calculation-avoiding-overflow/42061836#42061836", "title": "Fixed-point: out_Q15 = antilog( in_Q25 ) calculation, avoiding overflow?", "body": "<p>I managed to find a solution. It's a bit tricky. </p>\n\n<p>First, a struct that will hold the output result is needed:</p>\n\n<pre><code>typedef struct\n{\n    q15   v; // Value (within the [MIN, MAX] range for Q16.15).\n    int32 s; // Scalefactor.\n} q15_t;\n</code></pre>\n\n<p>The idea is to provide result as Output with Scalefactor, where</p>\n\n<pre><code>Output = 10^y\nScale  = 2^scalefactor\n</code></pre>\n\n<p>Final output is <code>Output</code> shifted left <code>scalefactor</code> times.</p>\n\n<p>Here is the math.</p>\n\n<p>Input Q31 format is dB value scaled to [-1,1] with scale being 2^scalefactor.\nWe need to calculate: </p>\n\n<pre><code>Out = 10^(2^scalefactor * in/20.0)\n\n    = 10^(p+y)                  // rewriting as sum\n    = 10^p          * 10^y      // to enable exponent multiplication\n    = 2^scalefactor * 10^y      // making it power of 2 to be able to just shift\n</code></pre>\n\n<p>This way we are not limited with Q16.15 max value.</p>\n\n<p>We already know <code>2^scalefactor</code>, but need to find <code>y</code>: </p>\n\n<pre><code>2^scalefactor * in = p + y\n\n10^p = 2^scalefactor   =&gt;   p = scalefactor*log(2)   // rewrite as power of 2\n2^scalefactor * in = scalefactor*log(2) + y          // replace p\ny = 2^scalefactor*in - scalefactor*log(2)            // and find y\n</code></pre>\n\n<p>Calculate y, and feed it into <code>antilog</code>.</p>\n\n<p>If input is <code>100 dB</code>, then the output magnitude should be <code>100.000</code>, which doesn't fit into <code>Q16.15</code> format. Using the above solution, <code>Output = 50.000</code> (this fits into <code>Q16.15</code>!) and <code>scalefactor = 1</code>, meaning, the final output is <code>50.000</code> shifted to left <code>1</code> place. This gives <code>100.000</code> as the final result. Depending on your implementation, you might get the same result as <code>25.000</code> with <code>scalefactor = 2</code>, etc. The idea is there. </p>\n"}], "owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 42061836, "answer_count": 1, "score": 0, "last_activity_date": 1486363926, "creation_date": 1485946255, "question_id": 41977852, "link": "https://stackoverflow.com/questions/41977852/fixed-point-out-q15-antilog-in-q25-calculation-avoiding-overflow", "title": "Fixed-point: out_Q15 = antilog( in_Q25 ) calculation, avoiding overflow?", "body": "<p>I am using a 3rd-party fixed-point <code>antilog()</code> function to calculate magnitude from decibel <code>out_mag = 10^( in_db/20 )</code>. The <code>antilog()</code> takes <code>Q6.25</code> format as input, and provides <code>Q16.15</code> at output. </p>\n\n<p>The problem is that <code>antilog()</code> quickly overflows for some higher dB valus, like 100 dB: <code>10^( 100/20 ) = 100000</code>. The highest value <code>Q16.15</code> format can have is <code>2^16-1=65535</code>, so <code>100000</code> doesn't fit.</p>\n\n<p>Is there a trick to avoid the overflow? Prescale input value somehow? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 5, "creation_date": 1485945017, "post_id": 41977366, "comment_id": 71132473, "body": "that&#39;s because <code>Hall_1 ,Hall_2 ,Hall_3</code> are not constant (and not initialized BTW)."}, {"owner": {"reputation": 6633, "user_id": 2378300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/852aed09b52c7514ed23f75f2921f6cc?s=128&d=identicon&r=PG", "display_name": "Jonas", "link": "https://stackoverflow.com/users/2378300/jonas"}, "edited": false, "score": 2, "creation_date": 1485945019, "post_id": 41977366, "comment_id": 71132474, "body": "Why the tag spam? C++ and C are two different languages."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1485945039, "post_id": 41977366, "comment_id": 71132491, "body": "Please post the entire error message."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1485945277, "post_id": 41977366, "comment_id": 71132670, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/3025050/error-initializer-element-is-not-constant-when-trying-to-initialize-variable-w\">Error &quot;initializer element is not constant&quot; when trying to initialize variable with const</a>"}], "answers": [{"comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 3, "creation_date": 1485945170, "post_id": 41977430, "comment_id": 71132584, "body": "They are not array sizes, though. The sizes, <code>6</code> and <code>2</code>, are very constant."}, {"owner": {"reputation": 1, "user_id": 7346901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n6tAv.gif?s=128&g=1", "display_name": "Kamaran Hussini", "link": "https://stackoverflow.com/users/7346901/kamaran-hussini"}, "edited": false, "score": 0, "creation_date": 1485948036, "post_id": 41977430, "comment_id": 71134519, "body": "Hall_1 and so on have contents that changes periodically they have not constant values ."}], "tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": false, "score": 0, "last_activity_date": 1485946465, "last_edit_date": 1485946465, "creation_date": 1485945095, "answer_id": 41977430, "question_id": 41977366, "link": "https://stackoverflow.com/questions/41977366/c-array-initialization-getting-error/41977430#41977430", "title": "C Array Initialization getting error", "body": "<p>When creating an <strong>array</strong> like that, its size must be constant, because <code>C</code> doesn't allow non-constant values for the size of an array.</p>\n\n<p><code>C99</code> standard section 6.7.8 (Initialization), point 4:</p>\n\n<blockquote>\n  <p>All the expressions in an initializer for an object that has static\n  storage duration shall be constant expressions or string literals.</p>\n</blockquote>\n\n<p>I did changes your code. try it.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define Hall_1 10\n#define Hall_2 20\n#define Hall_3 30   \n\nint main() \n{       \nfloat  A,B,C;\n\nA = Hall_1;\nB = Hall_2; \nC = Hall_3;\n\nfloat commutate_sequence[6][2]= {{B,A},{B,C},{A,C},{A,B},{C,B},{C,A}};\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7346901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n6tAv.gif?s=128&g=1", "display_name": "Kamaran Hussini", "link": "https://stackoverflow.com/users/7346901/kamaran-hussini"}, "edited": false, "score": 0, "creation_date": 1485945919, "post_id": 41977482, "comment_id": 71133172, "body": "So what can i do instead of defining an array to hold {B,A},{B,C},{A,C},{A,B},{C,B},{C,A}      how can i use macros instead of arrays?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 1, "user_id": 7346901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n6tAv.gif?s=128&g=1", "display_name": "Kamaran Hussini", "link": "https://stackoverflow.com/users/7346901/kamaran-hussini"}, "edited": false, "score": 1, "creation_date": 1485945978, "post_id": 41977482, "comment_id": 71133208, "body": "@KamaranHussini Define it inside main that it had automatic storage duration."}, {"owner": {"reputation": 1, "user_id": 7346901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n6tAv.gif?s=128&g=1", "display_name": "Kamaran Hussini", "link": "https://stackoverflow.com/users/7346901/kamaran-hussini"}, "edited": false, "score": 0, "creation_date": 1485946397, "post_id": 41977482, "comment_id": 71133466, "body": "Does Arrays just can hold constant array? so it means the whole my initialization of Array is error?! is it not possible to array to hold variables?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 1, "user_id": 7346901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n6tAv.gif?s=128&g=1", "display_name": "Kamaran Hussini", "link": "https://stackoverflow.com/users/7346901/kamaran-hussini"}, "edited": false, "score": 0, "creation_date": 1485946415, "post_id": 41977482, "comment_id": 71133481, "body": "@KamaranHussini The variables Hall_1and and so on also should be initialized with constant expressions."}, {"owner": {"reputation": 1, "user_id": 7346901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n6tAv.gif?s=128&g=1", "display_name": "Kamaran Hussini", "link": "https://stackoverflow.com/users/7346901/kamaran-hussini"}, "edited": false, "score": 0, "creation_date": 1485977632, "post_id": 41977482, "comment_id": 71153806, "body": "I changed code as follow and it works now:         void commutate(unsigned char <i>max_min){  unsigned char X=0, i=0; float</i> comt_sequence[6][2]= {  (&amp;Hall_2,&amp;Hall_1) , (&amp;Hall_2,&amp;Hall_3),                                (&amp;Hall_1,&amp;Hall_3) , (&amp;Hall_1,&amp;Hall_2),                                (&amp;Hall_3,&amp;Hall_2) , (&amp;Hall_3,&amp;Hall_1) }; for (i=0; i&lt;6 ;i++){ \t\tif( (max_min[0] == (*comt_sequence[i][0])) &amp;&amp; (max_min[1] == (*comt_sequence[i][1]))) X=i;}"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1485945565, "last_edit_date": 1485945565, "creation_date": 1485945210, "answer_id": 41977482, "question_id": 41977366, "link": "https://stackoverflow.com/questions/41977366/c-array-initialization-getting-error/41977482#41977482", "title": "C Array Initialization getting error", "body": "<p>You may not initialize arrays in C with static storage duration with non-constant initializers.</p>\n\n<p>From the C Standard (6.7.9 Initialization)</p>\n\n<blockquote>\n  <p>4 All the expressions in an initializer for an object that has static\n  or thread storage duration shall be constant expressions or string\n  literals.</p>\n</blockquote>\n\n<p>It seems your array is declared outside any function. If it is possible declare it in a function for example in main.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7346901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n6tAv.gif?s=128&g=1", "display_name": "Kamaran Hussini", "link": "https://stackoverflow.com/users/7346901/kamaran-hussini"}, "is_accepted": false, "score": 0, "last_activity_date": 1486032973, "creation_date": 1486032973, "answer_id": 42000356, "question_id": 41977366, "link": "https://stackoverflow.com/questions/41977366/c-array-initialization-getting-error/42000356#42000356", "title": "C Array Initialization getting error", "body": "<p>I changed code as follow and it works now: </p>\n\n<pre><code>#define A Hall_1\n#define B Hall_2\n#define C Hall_3\nvoid commutate(unsigned char max_min)\n{ unsigned char X=0, i=0; \nfloat comt_sequence[6][2]= { (&amp;Hall_2,&amp;Hall_1) , (&amp;Hall_2,&amp;Hall_3),(Hall_1,&amp;Hall_3) ,  (&amp;Hall_1,&amp;Hall_2),                                                             &amp;Hall_3,&amp;Hall_2) , (&amp;Hall_3,&amp;Hall_1) };\nfor (i=0; i&lt;6 ;i++)\n{ if( (max_min[0] == (*comt_sequence[i][0])) &amp;&amp; (max_min[1] == (*comt_sequence[i][1]))) X=i;}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7346901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n6tAv.gif?s=128&g=1", "display_name": "Kamaran Hussini", "link": "https://stackoverflow.com/users/7346901/kamaran-hussini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1486032973, "creation_date": 1485944927, "last_edit_date": 1485947917, "question_id": 41977366, "link": "https://stackoverflow.com/questions/41977366/c-array-initialization-getting-error", "title": "C Array Initialization getting error", "body": "<p>I have tried to define a 2 dimension array in c language and initialize it with variables of float types but I have got this error:  </p>\n\n<p><code>\"must be constant expression\"</code><br>\n here is my code:</p>\n\n<pre><code>/*******************************************************\nThis program was created by the\nCodeWizardAVR V3.12 Advanced\nAutomatic Program Generator\n\u00a9 Copyright 1998-2014 Pavel Haiduc, HP InfoTech s.r.l.\nhttp://www.hpinfotech.com\n\nProject : \nVersion : \nDate    : 1/30/2017\nAuthor  : \nCompany : \nComments: \n\n\nChip type               : ATmega8A\nProgram type            : Application\nAVR Core Clock frequency: 8.000000 MHz\nMemory model            : Small\nExternal RAM size       : 0\nData Stack size         : 256\n*******************************************************/\n\n#include &lt;mega8.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;delay.h&gt;\n#include &lt;alcd.h&gt;\n\n#define A Hall_1\n#define B Hall_2\n#define C Hall_3\n\n\n//...........................................................................................\n// Declare your global variables here\nfloat Hall_1 ,Hall_2 ,Hall_3 ;\nint count=0;\n\n//----------------------------------------------------------------------------------------------------\n\n// Timer 0 overflow interrupt service routine\ninterrupt [TIM1_OVF] void timer1_ovf_isr(void)\n{\ncount++;\n\n}\n\n//----------------------------------------------------------------------------------------------\n\n// ADC interrupt service routine\ninterrupt [ADC_INT] void adc_isr(void)\n{\n\n\n}\n//-----------------------------------------------------------------------------------------------\n\nfloat adc_read(unsigned char);\nfloat maxf(float , float , float);\nfloat minf(float , float , float);\nvoid commutate(unsigned char*);\n\n//-----------------------------------------------------------------------------------------------\n\nvoid main(void)\n{\n// Declare your local variables here\n\nfloat comt_sequence[6][2]= {{B,A},{B,C},{A,C},{A,B},{C,B},{C,A}};\n// Timer/Counter 0 initialization\n// Clock source: System Clock\n// Clock value: 8000.000 kHz\nTCCR1B=(0&lt;&lt;CS02) | (0&lt;&lt;CS01) | (0&lt;&lt;CS00);\nTCNT1=0x00;\n\n\n\n// Timer(s)/Counter(s) Interrupt(s) initialization\nTIMSK=(0&lt;&lt;OCIE2) | (0&lt;&lt;TOIE2) | (0&lt;&lt;TICIE1) | (0&lt;&lt;OCIE1A) | (0&lt;&lt;OCIE1B) | (0&lt;&lt;TOIE1) | (0&lt;&lt;TOIE0);\n\n// External Interrupt(s) initialization\n// INT0: Off\n// INT1: Off\nMCUCR=(0&lt;&lt;ISC11) | (0&lt;&lt;ISC10) | (0&lt;&lt;ISC01) | (0&lt;&lt;ISC00);\n\n\n// ADC initialization\n// ADC Clock frequency: 250.000 kHz\n// ADC Voltage Reference: Int., cap. on AREF\n// Only the 8 most significant bits of\n// the AD conversion result are used\nADMUX= (1&lt;&lt;REFS1) | (1&lt;&lt;REFS0) | (1&lt;&lt;ADLAR) ;\nADCSRA=(1&lt;&lt;ADEN) | (0&lt;&lt;ADSC) | (0&lt;&lt;ADFR) | (0&lt;&lt;ADIF) | (0&lt;&lt;ADIE) | (1&lt;&lt;ADPS2) | (0&lt;&lt;ADPS1) | (1&lt;&lt;ADPS0);\nSFIOR=(0&lt;&lt;ACME);\n\n// Alphanumeric LCD initialization\n// Connections are specified in the\n// Project|Configure|C Compiler|Libraries|Alphanumeric LCD menu:\n// RS - PORTD Bit 0\n// RD - PORTD Bit 1\n// EN - PORTD Bit 2\n// D4 - PORTD Bit 4\n// D5 - PORTB Bit 6\n// D6 - PORTB Bit 7\n// D7 - PORTD Bit 5\n// Characters/line: 16\nlcd_init(40);\n\n// Global enable interrupts\n#asm(\"sei\")\n\nlcd_putsf(\"start\");\ndelay_ms(500);\nlcd_clear();\n\nwhile (1)\n      { \n\n       unsigned char buffer[18] , s=0;\n       float m,n=0 , max_min[2]; \n       TCCR1B=1; //start counting cycles\n       Hall_1 = adc_read(5);\n       Hall_2 = adc_read(4);\n       Hall_3 = adc_read(3);\n\n       m=maxf(Hall_1,Hall_2,Hall_3); \n       /*if(m == Hall_1) \n                    lcd_putsf(\"Max= A \");  \n       else if(m == Hall_2)\n                    lcd_putsf(\"Max= B \");\n       else if(m == Hall_3)\n                    lcd_putsf(\"Max= C \");\n       else\n            lcd_putsf(\"Error\"); */\n\n       n=minf(Hall_1,Hall_2,Hall_3);\n       /*if(n == Hall_1) \n                    lcd_putsf(\"Min= A\");  \n       else if(n == Hall_2)\n                    lcd_putsf(\"Min= B\");\n       else if(n == Hall_3)\n                    lcd_putsf(\"Min= C\");\n       else\n            lcd_putsf(\"Error\");*/\n       max_min[0] = m;\n       max_min[1] = n;  \n\n       s=count;\n       sprintf(buffer,\"%5.4f %5.4f %d\",max_min[0],max_min[1] ,TCNT1);\n       lcd_puts(buffer);    \n       delay_ms(1000);\n       lcd_clear();\n      }\n}\n\n\n\n///////////////////////////////////////////////\nfloat adc_read(unsigned char ch)\n{\n\n    unsigned char lcd_buff[18];\n    float adc_data;\n  // select the corresponding channel 0~7\n  // ANDing with \u20197' will always keep the value\n  // of \u2018ch\u2019 between 0 and 5   \"\"ATmega8 has 6 ADC channel 0-5\"\"\n  ch &amp;= 0b00000111;  // AND operation with 5\n  ADMUX = (ADMUX &amp; 0xF8)|ch; // clears the bottom 3 bits before ORing   \n\n  // start single convertion\n  // write \u20191' to ADSC\n  ADCSRA |= (1&lt;&lt;ADSC);\n\n    // Wait for the AD conversion to complete\n    while ((ADCSRA &amp; 0x10)==0);\n    ADCSRA|=0x10;\n\n    // Read the 8 most significant bits\n    // of the AD conversion result\n    adc_data=(ADCH * 2.56)/255;\n    //sprintf(lcd_buff,\" %5.3f \",adc_data);\n    //lcd_puts(lcd_buff);\n    //delay_ms(500);\n    return adc_data;\n}\n\n//------------------------------------------------------------------------------------------------\nfloat maxf(float a , float b , float c) {\n\nfloat m;\nm = (a&gt;b)?a:b;\nm = (m&gt;c)?m:c;\nreturn m;\n}\n\nfloat minf(float a , float b , float c) {\n\nfloat m;\nm = (a&lt;b)?a:b;\nm = (m&lt;c)?m:c;\nreturn m;\n}\n\n//--------------------------------------------------------------------------------------\nvoid commutate(unsigned char *max_min){\n\nunsigned char x=0, i=0;\n\n\n//unsigned char comt_pattern[6][2] = {(\nfor (i=0; i&lt;6 ;i++)\n    if((max_min[0] == comt_sequence[i][0]) &amp;&amp; (max_min[1] == comt_sequence[i][1])) x=i;\nswitch(x){\n    case 0:\n    break;\n    case 1:\n    break;\n    case 2:\n    break;\n    case 3:\n    break;\n    case 4:\n    break;\n    case 5:\n    break;\n    }\n\n}\n</code></pre>\n\n<p>i add my whole code also i mention that Hall variables holds an ADC reading from a sensor and its values changes periodically what is my fault?<br>\nplease help </p>\n"}, {"tags": ["c", "stack", "malloc", "heap", "bare-metal"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1485944422, "post_id": 41977122, "comment_id": 71132067, "body": "Answer to your one question: it depends entirely on the implementation of <code>malloc</code>."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1485945423, "post_id": 41977122, "comment_id": 71132785, "body": "You should ask to Free....NX...Qualcomm support cimmunity."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485955683, "post_id": 41977122, "comment_id": 71139545, "body": "Comment is misleading in <code>for(i=0;i&lt;10;i++)      {          *(pMalloc_data2+i)=i+4000;     &#47;&#47;memory filled with 200 integers</code>.  What is true code&#39;s intent?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485955976, "post_id": 41977122, "comment_id": 71139751, "body": "Unclear about <code>For this array is space in STACK reserved at the beginning of the program</code>,  What can&#39;t the stack space be allocated at that point rather than the beginning of the program?  AFAIK, that allocation failed and not the prior <code>malloc()</code> calls.  A stronger case would put <code>array[10]</code> prior to the <code>malloc()</code> calls and use those values in code prior and post <code>malloc()</code> code.  Perhaps printing the address of various allocations and array would illuminate."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1486042514, "post_id": 41977122, "comment_id": 71183280, "body": "malloc() and baremetal are mutually exclusive."}, {"owner": {"reputation": 716, "user_id": 7231208, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/81a855a691f682ee29aece54720f1615?s=128&d=identicon&r=PG&f=1", "display_name": "BillyJoe", "link": "https://stackoverflow.com/users/7231208/billyjoe"}, "edited": false, "score": 0, "creation_date": 1486052817, "post_id": 41977122, "comment_id": 71190507, "body": "I think baremetal by definition is &quot;without operating system&quot;. So malloc and baremetal are not mutually exclusive, because your development environment provides a C standard library which has malloc, and this is the case with all development environments I have used for Kinetis K70."}], "answers": [{"comments": [{"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1486042481, "post_id": 41985173, "comment_id": 71183261, "body": "malloc and _sbrk are not bare metal, they former doesnt exist the latter is specific to one or more C libraries (which are somewhat by definition not baremetal as many require system calls) but is in general not the answer to why malloc() doesnt work."}], "tags": [], "owner": {"reputation": 716, "user_id": 7231208, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/81a855a691f682ee29aece54720f1615?s=128&d=identicon&r=PG&f=1", "display_name": "BillyJoe", "link": "https://stackoverflow.com/users/7231208/billyjoe"}, "is_accepted": false, "score": 0, "last_activity_date": 1485967649, "creation_date": 1485967649, "answer_id": 41985173, "question_id": 41977122, "link": "https://stackoverflow.com/questions/41977122/malloc-doesnt-return-null-when-overruns-the-heap-bare-metal/41985173#41985173", "title": "malloc() doesn&#39;t return null when overruns the HEAP (bare-metal)", "body": "<p>With a bare metal environment, you need to implement an <code>_sbrk</code> function like this:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n\n// start and end of Heap as defined in the linker script (_heap_start &lt; _heap_end)\nextern unsigned int const _heap_start;\nextern unsigned int const _heap_end;\n\n\n/**\n * @brief                   Changes data segment space allocation (it may be called by malloc) .\n * @details                 It may be called by malloc() .\n * @param[in]   increment   Number of byte to be allocated .\n * @return                  On success the previous program break (program break = beginning of available mem) .\n                            On error -1 .\n */\nvoid *_sbrk(ptrdiff_t increment)\n{\n    static void *heap_free = 0;\n    void *heap_prev;\n\n    if  (heap_free == 0)\n    {\n        heap_free = (void *) &amp;_heap_start;      // First call\n    }\n\n    if ((heap_free + increment) &lt; ((void *) &amp;_heap_end))\n    {\n        heap_prev = heap_free;\n        heap_free += increment;\n        return heap_prev;\n    }\n    else\n    {\n        errno = ENOMEM;\n        return ((void *) -1);\n    }\n}\n</code></pre>\n\n<p>On K70 the stack is growing down while the heap is growing up. With that function, you will never have a collision as long as you set <code>_heap_end = _stack_end</code> in your linker script and your stack size is big enough.</p>\n\n<p>When you have an operating system, <code>_sbrk</code> is provided by it.</p>\n"}], "owner": {"reputation": 1, "user_id": 7495915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae637e1b80ac249117758285180d0fe?s=128&d=identicon&r=PG&f=1", "display_name": "pyfilekW", "link": "https://stackoverflow.com/users/7495915/pyfilekw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 447, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1485967649, "creation_date": 1485944243, "last_edit_date": 1495540392, "question_id": 41977122, "link": "https://stackoverflow.com/questions/41977122/malloc-doesnt-return-null-when-overruns-the-heap-bare-metal", "title": "malloc() doesn&#39;t return null when overruns the HEAP (bare-metal)", "body": "<p>I am debugging a bare-metal project on Kinetis TWRK70M120 using Cross ARM GCC toolchain. (Kinetis Design Studio) <br/><br/>I have one question: <br/>\n<code>Why malloc() doesn't return NULL pointer when it overruns the heap size?</code><br/>\n<code>How is that possible?</code><br/><br/> I would not expect it, but after analyzing different situations it showed up, that malloc() returns NULL pointer only if there is not enough space neither in HEAP nor in STACK. I found this question on StackOverflow forum: <br/><br/>\n<a href=\"https://stackoverflow.com/questions/39113658/when-does-malloc-return-null-in-a-bare-metal-environment\">When does malloc return NULL in a bare-metal environment?</a><br/><br/>\nThey are talking about the HEAP and STACK collision, what could be related with this problem. Although, i am not sure if we can talk about collision even if both (STACK and HEAP) address ranges are managed correctly (it seems to me). For example if i define an local array with 10 integers it will occupy cca 40-48 bytes at the top of the STACK. It means that this part of stack is not available for dynamic allocation and malloc() returns NULL only if you try to allocate address space bigger than cca HEAP+STACK-48bytes. In my project 0x400 + 0x500 - 48bytes(mentioned array) - other local variables. I am really not sure if this is common behavior or i just don't understand correctly to malloc() function.<br/><br/> Here is my code which i used for testing the malloc function.\n<br/>HEAP size = 0x20000400\n<br/>HEAP size = 0x20000500\n<br/> Here is my code which i used for testing the malloc function.</p>\n\n<pre><code>#include \"MK70F12.h\"\n#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nextern uint32_t __HeapBase;\nextern uint32_t __HeapLimit;\nextern uint32_t __StackTop;\nextern uint32_t __StackLimit;\n\n//MY TEST\nstatic int j=0, k=0, i=0;   //Global variables\n\nint main(void)\n{\n    //For testing purposes I defined STACK = 0x0x00000500 (cca 1280bytes) and\n                                    //HEAP = 0x0x00000400 (cca 1024bytes) what means that\n    //I have approximately (theoretically) 2304 bytes available.\n\n    /* Write your code here */\n     void* pHeapBase = ((void*)&amp;__HeapBase);\n     void* pHeapLimit= ((void*)&amp;__HeapLimit);\n     void* pStackTop = ((void*)&amp;__StackTop);\n     void* pStackLimit= ((void*)&amp;__StackLimit);\n     //---------------------------------------------------------------------------------------------------------\n     char* pMalloc_data1=(char*)malloc(1200*sizeof(char));  //Dynamically allocated array which size is bigger\n                                                        //than the HEAP size (beginning address in HEAP space).\n                                                        //It seems, when it overruns the heap size it doesn't\n                                                        //return NULL, but it continues growing into the stack.\n                                                        //Malloc returns NULL pointer only if there is\n                                                        //no space available neither in the HEAP nor in the STACK.\n     if (pMalloc_data1==NULL)\n     {\n         return(1);                     //Allocation failed\n     }\n     for(j=0;j&lt;1200;j++)\n     {\n         *(pMalloc_data1+j)='a'; //just some initialization with character\n                                        //memory filled with 1200 chars\n                                        //address range 0x200000a8 - 0x20000559(0x20000558?)\n     }\n     //---------------------------------------------------------------------------------------------------------\n\n     int *pMalloc_data2 = (int*)malloc(10*sizeof(int)); //Dynamically allocated array\n                                                        //(beginning address in STACK space)!!!.\n                                                        //Malloc returns NULL pointer only if there is\n                                                        //no space available in the STACK (HEAP is already full).\n     if (pMalloc_data2==NULL)\n     {\n         return(1);\n     }\n     for(i=0;i&lt;10;i++)\n     {\n         *(pMalloc_data2+i)=i+4000;     //memory filled with 200 integers\n                                        //address range 0x20000560 - (theoretically)0x20000588 (0x20000590?)\n     }\n\n     int array[10] = {10,15,78,62,80,6528,8,58,64,984};   //Local static array =&gt; in STACK\n                                                          //For this array is space in STACK reserved\n                                                          //at the beginning of the program\n     free(pMalloc_data1);\n     free(pMalloc_data2);\n     for(;;)\n     {\n         k++;\n     }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "system-calls"], "comments": [{"owner": {"reputation": 7071, "user_id": 549010, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/181219cd20b8036ef8ec45b94aed6474?s=128&d=identicon&r=PG", "display_name": "Roger", "link": "https://stackoverflow.com/users/549010/roger"}, "edited": false, "score": 4, "creation_date": 1485944046, "post_id": 41977050, "comment_id": 71131826, "body": "You want your own code? Its not a one size fits all. I did it as-well, and ended-up using different solutions (like parsing /proc/cpuinfo, /proc/meminfo, for hdd info i used the api (ioctl.h)."}, {"owner": {"reputation": 25, "user_id": 7402533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222060df4993e20d0a985c4445a5cee3?s=128&d=identicon&r=PG&f=1", "display_name": "Nivas B", "link": "https://stackoverflow.com/users/7402533/nivas-b"}, "reply_to_user": {"reputation": 7071, "user_id": 549010, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/181219cd20b8036ef8ec45b94aed6474?s=128&d=identicon&r=PG", "display_name": "Roger", "link": "https://stackoverflow.com/users/549010/roger"}, "edited": false, "score": 0, "creation_date": 1485944127, "post_id": 41977050, "comment_id": 71131871, "body": "no any  code which has system call which handles hardware and powering operation of the system."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1485946657, "post_id": 41977050, "comment_id": 71133637, "body": "For CPU info on x86-based chips, there&#39;s a <code>cpuid</code> assembler instruction for you to run after setting registry <code>EAX</code> to a specific value. To implement this in C usually a few lines of assembler code is inserted directly (with <code>asm{ ... }</code>)."}], "owner": {"reputation": 25, "user_id": 7402533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222060df4993e20d0a985c4445a5cee3?s=128&d=identicon&r=PG&f=1", "display_name": "Nivas B", "link": "https://stackoverflow.com/users/7402533/nivas-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485943945, "creation_date": 1485943945, "question_id": 41977050, "link": "https://stackoverflow.com/questions/41977050/system-call-to-read-hardware-info-and-cpu-info-in-linux-c", "title": "System call to read hardware info and cpu info in linux c ?", "body": "<p>I'm learning system call and their behaviour. I have used message ques,IPC,mouse drivers related programs.Actually I need some sample code  in which I should read the hardware(cd fan,cpu status,sensors)and turnoff,restart my system  using systemcall. Can anyone help me out?</p>\n"}, {"tags": ["c#", "c", "crc"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 2, "creation_date": 1485944237, "post_id": 41976957, "comment_id": 71131936, "body": "Just to note: <code>*(pucPtr + 1)</code> is a alternate way of writing <code>pucPtr[1]</code>."}, {"owner": {"reputation": 163, "user_id": 3328467, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f5ae15c519f0b01132b5c4d116f32fb8?s=128&d=identicon&r=PG&f=1", "display_name": "Alex123", "link": "https://stackoverflow.com/users/3328467/alex123"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1485944740, "post_id": 41976957, "comment_id": 71132283, "body": "Thank you @user694733, that is good information. So that means that // unsigned char* pucPtr = (unsigned char*)&amp;usCRC // actually means that usCRC is converted to byte and added to byte[] pucPTR ?"}, {"owner": {"reputation": 18719, "user_id": 1997232, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/y6na2.png?s=128&g=1", "display_name": "Sinatr", "link": "https://stackoverflow.com/users/1997232/sinatr"}, "edited": false, "score": 1, "creation_date": 1485945052, "post_id": 41976957, "comment_id": 71132500, "body": "1+2: <code>pucPtr</code> is used to access high byte of <code>usCRC</code> (to XOR it with current byte in the <code>a_szBufuer</code>); 3: <code>&lt;=7</code> will run cycle 7+1 times, you mix it up with <code>&lt;8</code> (which is absolutely identical, but may produce different ASM/IL) 4: Nope, it&#39;s <a href=\"https://en.wikipedia.org/wiki/Bitwise_operations_in_C#Bitwise_XOR_.22.5E.22\" rel=\"nofollow noreferrer\">XOR</a> again. Search for &quot;crc 16 c#&quot; to get find working C# code instead of transforming someone&#39;s C implementation of it, <a href=\"http://stackoverflow.com/a/22861111/1997232\">here</a> is something (you just have to change polinominal to <code>0x8005</code>)."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 18719, "user_id": 1997232, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/y6na2.png?s=128&g=1", "display_name": "Sinatr", "link": "https://stackoverflow.com/users/1997232/sinatr"}, "edited": false, "score": 0, "creation_date": 1485945249, "post_id": 41976957, "comment_id": 71132644, "body": "@Sinatr sorry misread something, you are right. Comment deleted."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1485945596, "post_id": 41976957, "comment_id": 71132910, "body": "One important thing to note here: Using <code>pucPtr</code> to access second byte of <code>usCRC</code> is not portable solution: It will give different results on little vs big endian systems. You need to know for which architecture this code was originally written for."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1485946730, "post_id": 41976957, "comment_id": 71133690, "body": "Number one is probably to find a code guru who can give you a proper algorithm in C. This code is badly written."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1485946849, "post_id": 41977768, "comment_id": 71133782, "body": "Be aware that <code>rawCrc[1] &lt;&lt; 8</code> causes undefined behavior on 8/16 bit computers, because of implicit integer promotion. You end up shifting data into the sign bits of a temporary <code>int</code>."}, {"owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1485946965, "post_id": 41977768, "comment_id": 71133854, "body": "@Lundin as each time, you see what&#39;s wrong ;) thank you for remark!"}], "tags": [], "owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "is_accepted": false, "score": 2, "last_activity_date": 1485946926, "last_edit_date": 1485946926, "creation_date": 1485945998, "answer_id": 41977768, "question_id": 41976957, "link": "https://stackoverflow.com/questions/41976957/crc-16-0x8005-polynominal-from-c-to-c-sos/41977768#41977768", "title": "CRC-16 0x8005 polynominal, from C to C#. SOS", "body": "<blockquote>\n  <ol>\n  <li>What is pucPTR doing there (it's not beeing used anywhere else)?</li>\n  </ol>\n</blockquote>\n\n<p><code>pucPtr</code> is used to transform <strong><em>uglily</em></strong> an <code>unsigned short</code> to an array of 2 <code>unsigned char</code>. According endianess of platform, <code>pucPtr</code> will point on first byte of <code>unsigned short</code> and <code>pucPtr+1</code> will point on second byte of <code>unsigned short</code> (or vice versa). You have to know if this algorithm is designed for little or big endian.</p>\n\n<p>Code equivalent (and portable, if code have been developed for big endian):</p>\n\n<pre><code>unsigned char rawCrc[2];\nrawCrc[0] = (unsigned char)(usCRC &amp; 0x00FF);\nrawCrc[1] = (unsigned char)((usCRC &gt;&gt; 8) &amp; 0x00FF);\n\nrawCrc[1] = rawCrc[1] ^ *a_szBufuer++;\n\nusCRC = (unsigned short)rawCrc[0] \n       | (unsigned short)((unsigned int)rawCrc[1] &lt;&lt; 8);\n</code></pre>\n\n<p>For little endian, you have to inverse <code>raw[0]</code> and <code>raw[1]</code></p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>What do the 2 lines of code mean, under the first for?</li>\n  </ol>\n</blockquote>\n\n<p>First line does the <strong><em>ugly</em></strong> transformation described in 1.</p>\n\n<p>Second line retrieves value pointed by <code>a_szBufuer</code> and increment it. And does a \"xor\" with second (or first, according endianess) byte of crc (note <code>*(pucPtr +1)</code> is equivalent of <code>pucPtr[1]</code>) and stores results inside second (or first, according endianess) byte of crc.</p>\n\n<pre><code>*(pucPtr + 1) = *(pucPtr + 1) ^ *a_szBufuer++;\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>pucPtr[1] = pucPtr[1] ^ *a_szBufuer++;\n</code></pre>\n\n<blockquote>\n  <ol start=\"3\">\n  <li>Why in the second for the short \"i\" is &lt;=7, shouldn't it be &lt;=8?</li>\n  </ol>\n</blockquote>\n\n<p>You have to do 8 iterations, from 0 to 7. You can change condition to <code>i = 0; i&lt;8</code> or <code>i=1; i&lt;=8</code></p>\n\n<blockquote>\n  <ol start=\"4\">\n  <li>Last line in if statement means that usCRC is in fact ushort 8005?</li>\n  </ol>\n</blockquote>\n\n<p>No, it doesn't. It means that <code>usCRC</code> is now equal to <code>usCRC</code> XOR <code>0x8005</code>. <code>^</code> is <a href=\"https://en.wikipedia.org/wiki/Bitwise_operations_in_C#Bitwise_XOR_.22.5E.22\" rel=\"nofollow noreferrer\">XOR bitwise operation </a> (also called or-exclusive). Example:</p>\n\n<pre><code> 0b1100110\n^0b1001011\n----------\n 0b0101101\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 163, "user_id": 3328467, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f5ae15c519f0b01132b5c4d116f32fb8?s=128&d=identicon&r=PG&f=1", "display_name": "Alex123", "link": "https://stackoverflow.com/users/3328467/alex123"}, "edited": false, "score": 0, "creation_date": 1485947692, "post_id": 41977920, "comment_id": 71134299, "body": "Wow thank you for all the help and information, but my lack of knowledge makes me ask you this question: The puc is an unsigned 8 bit integer which in C# is a byte, any other integer type in C# is 16bit and above. The compiler will not let me convert a ushort (16bit integer) to a byte (8 bit integer). How could that be accomplished?"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 5, "last_activity_date": 1485946492, "creation_date": 1485946492, "answer_id": 41977920, "question_id": 41976957, "link": "https://stackoverflow.com/questions/41976957/crc-16-0x8005-polynominal-from-c-to-c-sos/41977920#41977920", "title": "CRC-16 0x8005 polynominal, from C to C#. SOS", "body": "<p>First of all, please note than in C, the <code>^</code> operator means bitwise XOR.</p>\n\n<blockquote>\n  <ol>\n  <li>What is pucPTR doing there (it's not beeing used anywhere else)?  </li>\n  <li>What do the 2 lines of code mean, under the first for?</li>\n  </ol>\n</blockquote>\n\n<p>Causing bugs, by the looks of it. It is only used to grab one of the two bytes of the FCS, but the code is written in an endianess-dependent way. </p>\n\n<p>Endianess is very important when dealing with checksum algorithms, since they were originally designed for hardware shift registers, that require MSB first, aka big endian. In addition, CRC often means data communication, and data communication means possibly different endianess between the sender, the protocol and the receiver.</p>\n\n<p>I would guess that this code was written for little endian machines only and the intent is to XOR with the ms byte. The code points to the first byte then uses +1 pointer arithmetic to get to the second byte. Corrected code should be something like:</p>\n\n<pre><code>uint8_t puc = (unsigned int)usCRC &gt;&gt; 8;\npuc ^= *a_szBufuer;\nusCRC = (usCRC &amp; 0xFF) | ((unsigned int)puc &lt;&lt; 8);\na_szBufuer++;\n</code></pre>\n\n<p>The casts to unsigned int are there to portably prevent mishaps with implicit integer promotion. </p>\n\n<hr>\n\n<blockquote>\n  <ol start=\"3\">\n  <li>Why in the second for the short \"i\" is &lt;=7, shouldn't it be &lt;=8?</li>\n  </ol>\n</blockquote>\n\n<p>I think it is correct, but more readably it could have been written as <code>i &lt; 8</code>. </p>\n\n<blockquote>\n  <ol start=\"4\">\n  <li>Last line in if statement means that usCRC is in fact ushort 8005?</li>\n  </ol>\n</blockquote>\n\n<p>No, it means to XOR your FCS with the polynomial 0x8005. See <a href=\"https://en.wikipedia.org/wiki/Polynomial_representations_of_cyclic_redundancy_checks\">this</a>.</p>\n\n<blockquote>\n  <p>The document I have been given says that this is a CRC16 IBM</p>\n</blockquote>\n\n<p>Yeah it is sometimes called that. Though from what I recall, \"CRC16 IBM\" also involves some bit inversion of the final result(?). I'd double check that.</p>\n\n<hr>\n\n<p>Overall, be careful with this code. Whoever wrote it didn't have much of a clue about endianess, integer signedness and implicit type promotions. It is amateur-level code. You should be able to find safer, portable professional versions of the same CRC algorithm on the net.</p>\n\n<hr>\n\n<p>Very good reading about the topic is <a href=\"http://www.ross.net/crc/download/crc_v3.txt\">A Painless Guide To CRC</a>.</p>\n"}], "owner": {"reputation": 163, "user_id": 3328467, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f5ae15c519f0b01132b5c4d116f32fb8?s=128&d=identicon&r=PG&f=1", "display_name": "Alex123", "link": "https://stackoverflow.com/users/3328467/alex123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 865, "favorite_count": 0, "accepted_answer_id": 41977920, "answer_count": 2, "score": 0, "last_activity_date": 1485946926, "creation_date": 1485943688, "last_edit_date": 1485946201, "question_id": 41976957, "link": "https://stackoverflow.com/questions/41976957/crc-16-0x8005-polynominal-from-c-to-c-sos", "title": "CRC-16 0x8005 polynominal, from C to C#. SOS", "body": "<p>I have this block of C code that I can not for the life of me understand. I need to calculate the CRC-16 for a certain byte array I send to the method and it should give me the msb(most significant byte) and the lsb(least significant byte). I was also given a C written app to test some functionality and that app also gives me a log of what is sent and what is received via COM port.</p>\n\n<p>What is weird is that I entered the hex string that I found in the log into <a href=\"https://www.lammertbies.nl/comm/info/crc-calculation.html\" rel=\"nofollow noreferrer\">this online calculator</a>, but it gives me a different result.</p>\n\n<p>I took a stab at translating the method to C#, but I don't understand certain aspects:</p>\n\n<ol>\n<li>What is pucPTR doing there (it's not beeing used anywhere else)?</li>\n<li>What do the 2 lines of code mean, under the first for?</li>\n<li>Why in the second for the short \"i\" is &lt;=7, shouldn't it be &lt;=8?</li>\n<li>Last line in if statement means that usCRC is in fact ushort 8005?</li>\n</ol>\n\n<p>Here is the block of code:</p>\n\n<pre><code>unsigned short CalculateCRC(unsigned char* a_szBufuer, short a_sBufferLen)\n{\n    unsigned short usCRC = 0;\n    for (short j = 0; j &lt; a_sBufferLen; j++)\n    {\n        unsigned char* pucPtr = (unsigned char*)&amp;usCRC;\n        *(pucPtr + 1) = *(pucPtr + 1) ^ *a_szBufuer++;\n        for (short i = 0; i &lt;= 7; i++)\n        {\n            if (usCRC &amp; ((short)0x8000))\n            {\n                usCRC = usCRC &lt;&lt; 1;\n                usCRC = usCRC ^ ((ushort)0x8005);\n            }\n            else\n                usCRC = usCRC &lt;&lt; 1;\n        }\n    }\n    return (usCRC);\n}\n</code></pre>\n\n<p>This is the hex string that I convert to byte array and send to the method:\n02 00 04 a0 00 01 01 03</p>\n\n<p>This is the result that should be given from the CRC calculus:\n06 35</p>\n\n<p>The document I have been given says that this is a CRC16 IBM (msb, lsb) of the entire data.</p>\n\n<p>Can anyone please help? I've been stuck on it for a while now.</p>\n\n<p>Any code guru out there capable of translating that C method to C#? Apparently I'm not capable of such sourcery.</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1485943679, "post_id": 41976889, "comment_id": 71131575, "body": "try <code>sprintf(str,&quot;&#47;projects&#47;tfs&#47;users&#47;%s&#47;verification&quot;,getenv(&quot;US&zwnj;&#8203;ER&quot;))</code>."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1485949533, "post_id": 41976889, "comment_id": 71135445, "body": "To help people answer your question, you&#39;ll need to be more specific about the error.  Please <a href=\"https://stackoverflow.com/posts/41976889/edit\">edit</a> your post to incorporate the exact errors you get from your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> (preferably using copy+paste to avoid transcription errors)."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1485950333, "post_id": 41976889, "comment_id": 71136012, "body": "@usr-- that question seems to be more restricted than this one, e.g., it specifies not to use <code>getenv()</code>."}], "answers": [{"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 0, "last_activity_date": 1485944149, "last_edit_date": 1485944149, "creation_date": 1485943814, "answer_id": 41977013, "question_id": 41976889, "link": "https://stackoverflow.com/questions/41976889/c-user-name-in-linux-get-current-user-name/41977013#41977013", "title": "C user name in linux - get current user name", "body": "<p>You can use <a href=\"https://linux.die.net/man/3/getpwuid\" rel=\"nofollow noreferrer\">getpwuid</a> and <a href=\"https://linux.die.net/man/2/geteuid\" rel=\"nofollow noreferrer\">getuid</a> functions do to it:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;pwd.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;linux/limits.h&gt;\n\nint main(void)\n{\n    char path[PATH_MAX] = {0};\n    struct passwd *p = getpwuid(getuid());\n\n    if (p != NULL)\n    {\n        snprintf(path, sizeof(path), \"/projects/tfs/users/%s/verification/.\", p-&gt;pw_name);\n        printf(\"%s\\n\", path);\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 243, "user_id": 1941008, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/b4b354773d3adbc310b4f6db3804c798?s=128&d=identicon&r=PG", "display_name": "user1941008", "link": "https://stackoverflow.com/users/1941008/user1941008"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1485944149, "creation_date": 1485943492, "last_edit_date": 1485943638, "question_id": 41976889, "link": "https://stackoverflow.com/questions/41976889/c-user-name-in-linux-get-current-user-name", "title": "C user name in linux - get current user name", "body": "<p>I would like to import files from the following path  :</p>\n\n<p>import \"/projects/tfs/users/<strong>John</strong>/verification/......</p>\n\n<p>Is there is a way to change \"John\" to $USER in C so it will take the current user \nand not taking John's file always, I tried $USER and I get compilation error.</p>\n\n<p>Is there is a way to do it in c ?</p>\n"}, {"tags": ["c", "arrays", "pointers", "recursion"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1485943761, "post_id": 41976791, "comment_id": 71131623, "body": "Did you try to compile it before posting? Do you think this is a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1485943910, "post_id": 41976791, "comment_id": 71131738, "body": "Great time to learn how to use a debugger. Step through the code and see what happens."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1485944038, "post_id": 41976791, "comment_id": 71131820, "body": "<i>Now my questions are all about the first call : What does  strcpy( n-&gt;c, s++ ); really mean? I read it like &#39; take the string &quot;MNG&quot; and copy it in n-&gt;c. Is it right?</i> Yes, but it also increments <code>s</code> because of <code>s++</code>. <i>I know what happens if I add a number to a character, but I&#39;m very confused about the use in this specif case.</i> It just adds the length of the string to a character. The use case here is just fun, nobody would write a program like this other than for fun."}, {"owner": {"reputation": 11, "user_id": 7499569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1985938b263390f875e23986e9c7902a?s=128&d=identicon&r=PG&f=1", "display_name": "TheHannibal", "link": "https://stackoverflow.com/users/7499569/thehannibal"}, "edited": false, "score": 0, "creation_date": 1485944452, "post_id": 41976791, "comment_id": 71132088, "body": "So *(n-&gt;c) += strlen(s); changes the first letter. I don&#39;t understand the result. Is it M+ 3 = P? Michael you are right, my professor is very funny."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1485945463, "post_id": 41976791, "comment_id": 71132821, "body": "@user7499569 alphabet goes like this &quot;...LMNOPQR....&quot; (remember from 1st grade) therefore &#39;M&#39; + 3 is &#39;P&#39;."}, {"owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "edited": false, "score": 0, "creation_date": 1485953268, "post_id": 41976791, "comment_id": 71137896, "body": "seems like a quite ineffective way to create a list of a characters from a string"}], "answers": [{"tags": [], "owner": {"reputation": 471, "user_id": 5592711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Ctul.jpg?s=128&g=1", "display_name": "A. Monti", "link": "https://stackoverflow.com/users/5592711/a-monti"}, "is_accepted": true, "score": 1, "last_activity_date": 1485944790, "creation_date": 1485944790, "answer_id": 41977313, "question_id": 41976791, "link": "https://stackoverflow.com/questions/41976791/a-bit-of-recursion-array-of-characters-and-strcpy-in-c/41977313#41977313", "title": "A bit of recursion, array of characters and strcpy in C", "body": "<p>The first call <code>strcpy( n-&gt;c, s++ );</code> simply copies <code>s</code> into <code>n-&gt;c</code> until a null character is found, then increments <code>s</code>. It is strictly equivalent to</p>\n\n<pre><code>strcpy( n-&gt;c, s );\ns++;\n</code></pre>\n\n<p>as the post-increment operator <code>s++</code> returns the value of <code>s</code> <I>before</I> incrementing it (as opposed to the pre-increment <code>++s</code> which returns the incremented value).\nThe content of <code>n-&gt;c</code> is by now <code>AMNG\\0</code>.</p>\n\n<p>The second line <code>n-&gt;c[1] = '\\0'</code> effectively shortens the copied string to 1-character long, <code>n-&gt;c</code> equals <code>A\\0NG\\0</code> which, as a null-terminated C string, appears as <code>\"A\"</code></p>\n\n<p>Last, <code>*(n-&gt;c) += strlen(s)</code> is equivalent to <code>n-&gt;c[0] += strlen(s)</code>, as dereferencing an array is equivalent to accessing its first element, thus the ASCII-encoded character <code>'A'</code> is added <code>strlen(s)</code>, which is 3 and turns <code>n-&gt;c[0]</code> to <code>'D'</code> (see <a href=\"http://www.asciitable.com/\" rel=\"nofollow noreferrer\">http://www.asciitable.com/</a>).</p>\n\n<p>Now this process is repeated until <code>s</code> is empty and nodes are chained backward, each one containing a 1-character string, converting the N-characters string into N chained nodes (in reverse order).</p>\n"}], "owner": {"reputation": 11, "user_id": 7499569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1985938b263390f875e23986e9c7902a?s=128&d=identicon&r=PG&f=1", "display_name": "TheHannibal", "link": "https://stackoverflow.com/users/7499569/thehannibal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 41977313, "answer_count": 1, "score": -2, "last_activity_date": 1485944790, "creation_date": 1485943215, "last_edit_date": 1485944121, "question_id": 41976791, "link": "https://stackoverflow.com/questions/41976791/a-bit-of-recursion-array-of-characters-and-strcpy-in-c", "title": "A bit of recursion, array of characters and strcpy in C", "body": "<p>today I've come across an exercise that I think I didn't fully comprend. Here is it:</p>\n\n<pre><code>    typedef struct n { char c[8]; struct n *next; } node;\n\u00a0\nnodo * f( node * x, char * s ) {\n  nodo * n;\n  if( strlen(s) &gt; 0 ) {\n    n = (node *) malloc(sizeof(node));\n    n-&gt;next = x;\n    strcpy( n-&gt;c, s++ );\n    n-&gt;c[1] = '\\0';\n    *(n-&gt;c) += strlen(s);\n    return f( n, s );\n  }\n  return x;       \n}\u00a0\n\u00a0\nvoid printr( node * r ) {\n  if( r ) { \n    printf(\"%s\", r-&gt;c);\n    printr( r-&gt;next );\n  } \n}\n\u00a0\nint main() {\n  char p[] = \"AMNG\" ;   \n  printr( f( NULL, p ) );\n  return 0; \n}\n</code></pre>\n\n<p>Now my questions are all about the first call : \nWhat does   <code>strcpy( n-&gt;c, s++ );</code> really mean? I read it like ' take the string \"MNG\" and copy it in n->c. Is it right?</p>\n\n<p>Then we have    <code>n-&gt;c[1] = '\\0';</code> that make n->c (as a string) \"M /0 G\" .\nAlso   <code>*(n-&gt;c) += strlen(s);</code> is not clear. I know what happens if I add a number to a character, but I'm very confused about the use in this specif case.</p>\n\n<p>Thank for the help guys, really appreciate it!</p>\n"}, {"tags": ["c", "sockets", "pipe", "nonblocking"], "answers": [{"tags": [], "owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "is_accepted": true, "score": 2, "last_activity_date": 1615207745, "last_edit_date": 1615207745, "creation_date": 1485942197, "answer_id": 41976458, "question_id": 41976446, "link": "https://stackoverflow.com/questions/41976446/pipe2-vs-pipe-fcntl-why-different/41976458#41976458", "title": "pipe2(...) vs pipe() + fcntl(...), why different?", "body": "<p><em>(Answering my own question because I figured it out, just posting here for posterity.)</em></p>\n<p>If you're building a binary on a newer compiler for an older system, that runtime probably doesn't know the value for <code>O_CLOEXEC</code> as that flag was introduced with <code>pipe2()</code>.  If it knows anything, it knows <code>FD_CLOEXEC</code>.  And you don't set that using <code>F_SETFL</code>, you use <code>F_SETFD</code> which is a separate <code>fcntl()</code> call.</p>\n<p>The following substitution should work:</p>\n<pre><code>if (pipe(info_pipe) &lt; 0)\n    goto info_pipe_err;\n\nint direction; // 0=READ, 1=WRITE\nfor (direction = 0; direction &lt; 2; ++direction) {\n    int oldflags;\n    oldflags = fcntl(info_pipe[direction], F_GETFL);\n\n    if (oldflags &lt; 0)\n        goto info_pipe_err;\n\n    if (fcntl(info_pipe[direction],\n        F_SETFL, oldflags | O_NONBLOCK) &lt; 0)\n        goto info_pipe_err;\n\n    oldflags = fcntl(info_pipe[direction], F_GETFD);\n    if (oldflags &lt; 0)\n        goto info_pipe_err;\n\n    if (fcntl(info_pipe[direction],\n        F_SETFD, oldflags | FD_CLOEXEC) &lt; 0)\n        goto info_pipe_err;\n}\n</code></pre>\n<p>As noted, this does not have the thread-safety aspect offered by <code>pipe2()</code> allowing all this to be done at once.</p>\n"}], "owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1359, "favorite_count": 0, "accepted_answer_id": 41976458, "answer_count": 1, "score": 1, "last_activity_date": 1615207745, "creation_date": 1485942170, "last_edit_date": 1615207574, "question_id": 41976446, "link": "https://stackoverflow.com/questions/41976446/pipe2-vs-pipe-fcntl-why-different", "title": "pipe2(...) vs pipe() + fcntl(...), why different?", "body": "<p>I'm trying to build a redistributable binary to put on an old NAS that only has glibc 2.3.  So <a href=\"https://man7.org/linux/man-pages/man2/pipe.2.html\" rel=\"nofollow noreferrer\"><code>pipe2()</code></a> isn't available on that machine, but the code I'm trying to build has the following line:</p>\n<pre><code>if (pipe2(info_pipe, O_CLOEXEC | O_NONBLOCK) &lt; 0)\n    goto info_pipe_err;\n</code></pre>\n<p>My understanding is that the reason <code>pipe2()</code> exists is to avoid race conditions by taking the <code>O_CLOEXEC | O_NONBLOCK</code> at the time of opening vs. doing it in two steps.  But there are no threads in the case I'm looking at, so I thought I might just substitute in:</p>\n<pre><code>if (pipe(info_pipe) &lt; 0)\n    goto info_pipe_err;\n\nint direction; // 0=READ, 1=WRITE\nfor (direction = 0; direction &lt; 2; ++direction) {\n    int oldflags;\n    oldflags = fcntl(info_pipe[direction], F_GETFL);\n\n    if (oldflags &lt; 0)\n        goto info_pipe_err;\n\n    if (fcntl(info_pipe[direction], \n        F_SETFL, oldflags | O_NONBLOCK | O_CLOEXEC) &lt; 0)\n        goto info_pipe_err;\n}\n</code></pre>\n<p>But it's seemingly not interchangeable, because the code isn't working.  Why isn't this equivalent?</p>\n"}, {"tags": ["c", "casting"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1485941442, "post_id": 41976147, "comment_id": 71130130, "body": "Why are you casting to <code>char</code> in the first place? Also, your example displays <code>unsigned int</code> but the error mentions <code>unsigned char</code>"}, {"owner": {"reputation": 1837, "user_id": 3681400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EIOOj.png?s=128&g=1", "display_name": "Cristian", "link": "https://stackoverflow.com/users/3681400/cristian"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1485941471, "post_id": 41976147, "comment_id": 71130153, "body": "Actually for no reason"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 2, "creation_date": 1485941548, "post_id": 41976147, "comment_id": 71130194, "body": "Sidenote: Are you using this for serialization purposes? Using structs, and especially bitfields for that is a very bad idea, due to various implementation specific behaviour."}, {"owner": {"reputation": 1837, "user_id": 3681400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EIOOj.png?s=128&g=1", "display_name": "Cristian", "link": "https://stackoverflow.com/users/3681400/cristian"}, "edited": false, "score": 0, "creation_date": 1485941583, "post_id": 41976147, "comment_id": 71130222, "body": "Well actually what has to be done is to substract one natural number from another then represent it as a char, but given the fact that chars are effectively numbers, thats uneccessary"}, {"owner": {"reputation": 1837, "user_id": 3681400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EIOOj.png?s=128&g=1", "display_name": "Cristian", "link": "https://stackoverflow.com/users/3681400/cristian"}, "edited": false, "score": 0, "creation_date": 1485941723, "post_id": 41976147, "comment_id": 71130303, "body": "I&#39;m sure I&#39;ll be in range, but I want to get rid of the error without changing the compiler flags"}], "answers": [{"comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1485941796, "post_id": 41976256, "comment_id": 71130363, "body": "How does this address the specific question?"}, {"owner": {"reputation": 1837, "user_id": 3681400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EIOOj.png?s=128&g=1", "display_name": "Cristian", "link": "https://stackoverflow.com/users/3681400/cristian"}, "edited": false, "score": 0, "creation_date": 1485941802, "post_id": 41976256, "comment_id": 71130367, "body": "I need to I have very limited resources"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1485941880, "post_id": 41976256, "comment_id": 71130417, "body": "This implementation does not increase memory (RAM) footprint. Depending on the compiler the code can be also shorter."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 1837, "user_id": 3681400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EIOOj.png?s=128&g=1", "display_name": "Cristian", "link": "https://stackoverflow.com/users/3681400/cristian"}, "edited": false, "score": 0, "creation_date": 1485941881, "post_id": 41976256, "comment_id": 71130418, "body": "@Cristian ths solution proposed here <i>is</i> minimal, efficient and portable."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1485941930, "post_id": 41976256, "comment_id": 71130454, "body": "@MichaelWalz It is less portable as it assumes a 32 bit int. OP&#39;s code handles all that."}, {"owner": {"reputation": 1837, "user_id": 3681400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EIOOj.png?s=128&g=1", "display_name": "Cristian", "link": "https://stackoverflow.com/users/3681400/cristian"}, "edited": false, "score": 0, "creation_date": 1485941970, "post_id": 41976256, "comment_id": 71130479, "body": "Yes but given the fact that I have very limited resources I have to be sure that my request fits a 32 bit block not less not more"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1485942001, "post_id": 41976256, "comment_id": 71130506, "body": "unsigned int, on a 32 bit platform, is 32 bit long."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 1837, "user_id": 3681400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EIOOj.png?s=128&g=1", "display_name": "Cristian", "link": "https://stackoverflow.com/users/3681400/cristian"}, "edited": false, "score": 1, "creation_date": 1485942004, "post_id": 41976256, "comment_id": 71130510, "body": "@Cristian - If that is the case, you should use <code>uint32_t</code> from <code>stdint.h</code>, for one."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 3, "creation_date": 1485942169, "post_id": 41976256, "comment_id": 71130614, "body": "@2501 It is more portable than using a bitfield and make the code more readable. At a glance you are sure that the variable is bitfiled and you know exactly value positions and width inside the var."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1485942186, "post_id": 41976256, "comment_id": 71130625, "body": "@LPs This is still less portable. OP&#39;s code works on implementations that don&#39;t provie uint32_t, which is optional. Your example doesn&#39;t."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1485942292, "post_id": 41976256, "comment_id": 71130689, "body": "@LPs It is less readable. Just look at the amount of code needed, versus a simple assignment for the bit-fields. The bit-fields also encode the type, the struct, so OP&#39;s code is more type safe. And implementation of bit-fields don&#39;t matter in this example as OP&#39;s code isn&#39;t relying on it."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 4, "creation_date": 1485942387, "post_id": 41976256, "comment_id": 71130749, "body": "@2501 BTW personal opinions on &quot;What is more readable&quot; are OT. So stop trolling the answer. You downvoted it: that&#39;s enough."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 2, "creation_date": 1485942461, "post_id": 41976256, "comment_id": 71130804, "body": "My argumentative responses to your comments are not trolling. Beside the arguments for readability, I have provided several objective arguments, (portability, implementation), which you didn&#39;t address."}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 2, "last_activity_date": 1485942011, "last_edit_date": 1485942011, "creation_date": 1485941569, "answer_id": 41976256, "question_id": 41976147, "link": "https://stackoverflow.com/questions/41976147/cast-char-to-a-bit-field-entry-of-4-bits/41976256#41976256", "title": "Cast char to a bit field entry of 4 bits", "body": "<p>You should avoid bitfield struct.\nUse a simple unsigned int and use bitwise operators to assign values:</p>\n\n<pre><code>#define HEADER_VALUE_MASK 0xFu\n#define HEADER_VALUE_POS  0\n#define HEADER_UID_MASK   0xFu\n#define HEADER_UID_POS    4\n\nuint32_t header;\n\nheader |= (value &amp; HEADER_VALUE_MASK) &lt;&lt; HEADER_VALUE_POS;    \nheader |= (uid &amp; HEADER_UID_MASK) &lt;&lt; HEADER_UID_POS;\n</code></pre>\n\n<p>An implementation like this take also care of endianness and aligments.</p>\n"}, {"tags": [], "owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "is_accepted": true, "score": 9, "last_activity_date": 1485943015, "last_edit_date": 1495535370, "creation_date": 1485942945, "answer_id": 41976699, "question_id": 41976147, "link": "https://stackoverflow.com/questions/41976147/cast-char-to-a-bit-field-entry-of-4-bits/41976699#41976699", "title": "Cast char to a bit field entry of 4 bits", "body": "<p>With gcc, you can get rid of the warning by masking the value to the number of bits in the bitfield you assign to, since <code>type</code> is 4 bits, you can do:</p>\n\n<pre><code>request.header.type = (unsigned)(j[0]-65) &amp; 0xf;\n</code></pre>\n\n<p>(Note that you can find several good arguments as to why you should not use bitfields , see e.g. <a href=\"https://stackoverflow.com/questions/6043483/why-bit-endianness-is-an-issue-in-bitfields\">here</a> , and instead use plain integers and bit twiddling as suggested by @LPs)</p>\n"}], "owner": {"reputation": 1837, "user_id": 3681400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EIOOj.png?s=128&g=1", "display_name": "Cristian", "link": "https://stackoverflow.com/users/3681400/cristian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2922, "favorite_count": 0, "accepted_answer_id": 41976699, "answer_count": 2, "score": 2, "last_activity_date": 1485944087, "creation_date": 1485941264, "last_edit_date": 1485942137, "question_id": 41976147, "link": "https://stackoverflow.com/questions/41976147/cast-char-to-a-bit-field-entry-of-4-bits", "title": "Cast char to a bit field entry of 4 bits", "body": "<p>Hello guys I'm facing another problem, I'm working on single bits and extract data from ascii text. The problem is that the compiler gives me an error about the fact that casting a char (8 bits) to a 4 bit memory field may alter its value.</p>\n\n<p>Obviously that's true but how could I overcome that error?</p>\n\n<pre><code>typedef struct {\nstruct {\n    unsigned int type:        4;\n    unsigned int uid:         8;\n    unsigned int operation:   4; \n    unsigned int reg:         16;\n}header;\nchar *arg_nm;\n} OWL_request;\n</code></pre>\n\n<p>The complete error:</p>\n\n<pre><code> error: conversion to 'unsigned char:4' from 'char' may alter its value [-Werror=conversion]\n</code></pre>\n\n<p>and this is the assignment</p>\n\n<pre><code>request.header.type = (char)(j[0]-65);\n</code></pre>\n\n<p><code>j</code> is <code>*char</code></p>\n\n<p>What I have to do is to get rid of the error without altering compiler flags</p>\n"}, {"tags": ["c", "linux", "encryption", "libgcrypt"], "comments": [{"owner": {"reputation": 1, "user_id": 7499180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e0fbd09d8165113d0a25cc9b9a1ee7?s=128&d=identicon&r=PG&f=1", "display_name": "Silvano", "link": "https://stackoverflow.com/users/7499180/silvano"}, "edited": false, "score": 0, "creation_date": 1485966095, "post_id": 41976038, "comment_id": 71147068, "body": "I have changed algorithm to AES, and I have added the error code evaluation."}, {"owner": {"reputation": 1, "user_id": 7499180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e0fbd09d8165113d0a25cc9b9a1ee7?s=128&d=identicon&r=PG&f=1", "display_name": "Silvano", "link": "https://stackoverflow.com/users/7499180/silvano"}, "edited": false, "score": 0, "creation_date": 1485966222, "post_id": 41976038, "comment_id": 71147168, "body": "[src]$ ./wScriptObfuscator test.sh File size: 34 File type: Bourne/BASH script Key:    sckDLVW!.V!FLVNA Vector: 171298ey39r8y2de Src size: 34 Res size: 48   *** ERROR! FILE=&quot;wScriptObfuscator.c&quot;; LINE=231; PID=1066 *** gcrypt(): Invalid length"}, {"owner": {"reputation": 1, "user_id": 7499180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e0fbd09d8165113d0a25cc9b9a1ee7?s=128&d=identicon&r=PG&f=1", "display_name": "Silvano", "link": "https://stackoverflow.com/users/7499180/silvano"}, "edited": false, "score": 0, "creation_date": 1485966268, "post_id": 41976038, "comment_id": 71147199, "body": "This is what I get:  [src]$ ./wScriptObfuscator test.sh File size: 34 File type: Bourne/BASH script Key:    sckDLVW!.V!FLVNA Vector: 171298ey39r8y2de Src size: 34 Res size: 48   *** ERROR! FILE=&quot;wScriptObfuscator.c&quot;; LINE=231; PID=1066 *** gcrypt(): Invalid length"}], "owner": {"reputation": 1, "user_id": 7499180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e0fbd09d8165113d0a25cc9b9a1ee7?s=128&d=identicon&r=PG&f=1", "display_name": "Silvano", "link": "https://stackoverflow.com/users/7499180/silvano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485941311, "creation_date": 1485940959, "last_edit_date": 1485941311, "question_id": 41976038, "link": "https://stackoverflow.com/questions/41976038/simple-3des-encription-using-gcrypt-library", "title": "Simple 3DES encription using gcrypt library", "body": "<p>I am writing a simple free software to encode and decode bash script, mainly.</p>\n\n<p>The goal is to obtain executable script files where nobody can read the source code inside, root and the owner included. To encode/decode files I choice to use gcrypt library with 3DES algorithm. But unfortunately, the only available documentation is for who already use the library (eg. reference guide).</p>\n\n<p>You can find my code at the following address:\n<a href=\"http://pastebin.com/m3H6HGpc\" rel=\"nofollow noreferrer\">wScriptObfuscator.c</a></p>\n\n<p>At the moment I am stopped at the first of the two step: encode the script file. You can read the core of this step in the following code lines:</p>\n\n<pre><code>char secKey[(WSO_KEYSIZE + 1)];\nchar inVector[(WSO_KEYSIZE + 1)];\n\nmemcpy(secKey, WSO_SYMKEY, WSO_KEYSIZE);\nsecKey[WSO_KEYSIZE] = '\\0';\nmemcpy(inVector, WSO_INIVECTOR, WSO_KEYSIZE);\ninVector[WSO_KEYSIZE] = '\\0';\n#if __DEBUG__ &gt; 0\nprintf(\"Key:    %s\\nVector: %s\\n\", secKey, inVector);\n#endif\n\nresData = malloc(st.st_size + sizeof(char));\n\n// End initialization process\ngcry_control(GCRYCTL_INITIALIZATION_FINISHED, 0);\n\n// This function creates the context handle required for most of the other cipher functions\nif (gcry_cipher_open(&amp;hd, GCRY_CIPHER_3DES, GCRY_CIPHER_MODE_ECB, 0) == GPG_ERR_NO_ERROR) {\n\n  // Set the key used for encryption or decryption operations\n  if (gcry_cipher_setkey(hd, secKey, gcry_cipher_get_algo_keylen(GCRY_CIPHER_3DES)) == GPG_ERR_NO_ERROR) {\n\n    // Set the initialization vector used for encryption or decryption\n    if (gcry_cipher_setiv(hd, inVector, WSO_KEYSIZE) == GPG_ERR_NO_ERROR) {\n\n      // Encription\n      if (\n        gcry_cipher_encrypt(\n          hd,\n          resData, (st.st_size + sizeof(char)),\n          data, (st.st_size + sizeof(char))\n        ) == GPG_ERR_NO_ERROR\n        ) {\n\n        // Encripted data saving...\n        fd = open(sFileName, O_WRONLY);\n        idx = 0;\n        t = 1;\n        if (fd &gt; 0) {\n          while (idx &lt; st.st_size &amp;&amp; t &gt; 0) {\n            t = write(fd, (data + idx), (st.st_size - idx));\n            if (t &gt; 0) idx = idx + t;\n          }\n        }\n        close(fd);\n\n      }\n      else {\n        fprintf(stderr, \"ERROR! Encription procedure failed\\n\");\n        err = WSO_ERROR_ENCRIPTFAILURE;\n      }\n    }\n    else {\n      fprintf(stderr, \"ERROR! gcry_cipher_setiv() failed\\n\");\n      err = WSO_ERROR_ENCRIPTFAILURE;\n    }\n  }\n  else {\n    fprintf(stderr, \"ERROR! Key initialization failed\\n\");\n    err = WSO_ERROR_ENCRIPTFAILURE;\n  }\n\n  gcry_cipher_close(hd);\n\n}\nelse {\n  fprintf(stderr, \"ERROR! Encripted channel opening procedure failed\\n\");\n  err = WSO_ERROR_ENCRIPTFAILURE;\n}\n\nif (resData != NULL) free(resData);\n</code></pre>\n\n<p>Everything looks like fine but not the last encoder process function gcry_cipher_encrypt(). It is very strange because it requires the well initialized gcry_cipher_hd_t structure, an encoded data buffer, its size, a source data buffer, its size, that is all. It looks like easy.... but is does not work.</p>\n\n<p>Unfortunately, I have not found a documentation about the returned error codes.</p>\n\n<p>You can download the code also by sourceforge :</p>\n\n<pre><code>svn checkout https://svn.code.sf.net/p/linuxwoodo/code/trunk linuxwoodo-code\n</code></pre>\n\n<p>The wScriptObfuscator.c file is in the following folder:\ntrunk/prj__wScriptObfuscator/b1/src</p>\n"}, {"tags": ["c", "visual-studio", "abi", "universal-crt"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 2, "creation_date": 1485951573, "post_id": 41975672, "comment_id": 71136830, "body": "Pure <code>C</code> is stable (have found statement in the past - if I can find it again will posts as an answer).  Note that all of the Win32API methods (including COM) are exported as <code>C</code>.  Making a breaking change to the <code>C</code> ABI would break all the calls into the OS."}, {"owner": {"reputation": 17408, "user_id": 2881849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a2fd0122f50f7582be15be3062c5b71?s=128&d=identicon&r=PG&f=1", "display_name": "MikeMB", "link": "https://stackoverflow.com/users/2881849/mikemb"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1485953603, "post_id": 41975672, "comment_id": 71138099, "body": "@RichardCritten: Thank you very much. That was pretty much what I expected, but I couldn&#39;t find official documentation. It would be great, if you could find a source for it, but I would also accept your answer without it."}], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 2023294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58942b9f1f4a8f4955739a53ee5e2f5c?s=128&d=identicon&r=PG", "display_name": "Davide Capodaglio", "link": "https://stackoverflow.com/users/2023294/davide-capodaglio"}, "is_accepted": false, "score": 1, "last_activity_date": 1491400024, "last_edit_date": 1495542370, "creation_date": 1491400024, "answer_id": 43233099, "question_id": 41975672, "link": "https://stackoverflow.com/questions/41975672/abi-compatibility-of-visual-studio-c-libraries/43233099#43233099", "title": "ABI-Compatibility of visual studio c-libraries", "body": "<p>The ABI of pure C is surely stable. You can mix DLLs made with different VisualStudio version, as long as you also have the correct MSVCRT* dependencies (this does not apply if you build them with static libc obviously).</p>\n\n<p>However you have to take special care in passing pointer around (see <a href=\"http://siomsystems.com/mixing-visual-studio-versions/\" rel=\"nofollow noreferrer\">http://siomsystems.com/mixing-visual-studio-versions/</a> and also <a href=\"https://stackoverflow.com/questions/9233118/library-abi-compatibility-between-versions-of-visual-studio\">Library ABI compatibility between versions of Visual Studio</a>)</p>\n"}], "owner": {"reputation": 17408, "user_id": 2881849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a2fd0122f50f7582be15be3062c5b71?s=128&d=identicon&r=PG&f=1", "display_name": "MikeMB", "link": "https://stackoverflow.com/users/2881849/mikemb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1491400024, "creation_date": 1485939797, "last_edit_date": 1485989810, "question_id": 41975672, "link": "https://stackoverflow.com/questions/41975672/abi-compatibility-of-visual-studio-c-libraries", "title": "ABI-Compatibility of visual studio c-libraries", "body": "<p>It is my understanding that (with the notable exception of the switch from VS2015 to VS2017) Microsoft makes ABI breaking changes between each version of the Visual C++ toolchain. So if I want to distribute a binary version of a library, I have to distribute a separate version of that for each new version of VS that I want to support. </p>\n\n<p>Now my questions are:   </p>\n\n<ul>\n<li><strong>Is this is also true for pure c-libraries?</strong></li>\n<li><strong>Does the answer differ between dlls and static libraries?</strong>  </li>\n<li><strong>Is there an official policy from MS on what they aim for in the future?</strong> </li>\n</ul>\n\n<p>(in particular in light of the <a href=\"https://blogs.msdn.microsoft.com/vcblog/2015/03/03/introducing-the-universal-crt/\" rel=\"nofollow noreferrer\">refactoring and stabilization of the crt</a>)</p>\n\n<p>If this is relevant I'd be content with an answer specific to Win10 but I'm also interested in all windows versions since (and including) Win7. Versions of VS Studio that are of interest to me are VS2013/15/17 and - as far as any predictions can be made - future releases.</p>\n"}, {"tags": ["c", "pointers", "function-pointers"], "comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1485940955, "post_id": 41974699, "comment_id": 71129801, "body": "Please note that using empty parameters lists, as seen in the accepted answer, is an obsolescent feature, which means it could be removed from the language in the future. Obsolescent features should not be used, and are left in the language for backwards compatibility."}], "answers": [{"comments": [{"owner": {"reputation": 1837, "user_id": 3681400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EIOOj.png?s=128&g=1", "display_name": "Cristian", "link": "https://stackoverflow.com/users/3681400/cristian"}, "edited": false, "score": 0, "creation_date": 1485937140, "post_id": 41974881, "comment_id": 71127608, "body": "M_callbacks_r[0] = (modbus_read_t*)modbus_read_t;  shouldn&#39;t it be  M_callbacks_r[0] = (modbus_read_t*)callback; ?"}, {"owner": {"reputation": 1837, "user_id": 3681400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EIOOj.png?s=128&g=1", "display_name": "Cristian", "link": "https://stackoverflow.com/users/3681400/cristian"}, "edited": false, "score": 0, "creation_date": 1485937188, "post_id": 41974881, "comment_id": 71127629, "body": "Also what other solution would you adopt without using typedefs?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 1837, "user_id": 3681400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EIOOj.png?s=128&g=1", "display_name": "Cristian", "link": "https://stackoverflow.com/users/3681400/cristian"}, "edited": false, "score": 0, "creation_date": 1485937330, "post_id": 41974881, "comment_id": 71127697, "body": "@Cristian - I wouldn&#39;t work without typedefing something as difficult to type as a function pointer."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1485937628, "post_id": 41974881, "comment_id": 71127835, "body": "Avoiding pointer typedefs is a good rule in general for writing readable code.  With function typedefs there is the added benefit that you can use the typedef to declare matching functions."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1485937977, "post_id": 41974881, "comment_id": 71128017, "body": "@M.M - I never thought about using function typedefs that way. Food for thought, thank you."}, {"owner": {"reputation": 1837, "user_id": 3681400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EIOOj.png?s=128&g=1", "display_name": "Cristian", "link": "https://stackoverflow.com/users/3681400/cristian"}, "edited": false, "score": 0, "creation_date": 1485938169, "post_id": 41974881, "comment_id": 71128100, "body": "I have an error, it tells me that: error: function declaration isn&#39;t a prototype [-Werror=strict-prototypes]  void registerCallback(int systemType,int operationType, void (*callback)()) {"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 1837, "user_id": 3681400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EIOOj.png?s=128&g=1", "display_name": "Cristian", "link": "https://stackoverflow.com/users/3681400/cristian"}, "edited": false, "score": 0, "creation_date": 1485938362, "post_id": 41974881, "comment_id": 71128201, "body": "@Cristian - Seems you are building with <code>-Wstrict-prototypes</code>. So an empty parameter list is not allowed in your configuration. I&#39;ll add a relevant bit to the answer"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1485938759, "post_id": 41974881, "comment_id": 71128429, "body": "Functions with empty parenthesis are objectively a bad suggestion as this is an obsolescent feature."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1485938831, "post_id": 41974881, "comment_id": 71128472, "body": "Also casts are a good thing, as they indicate to the reader that the pointers aren&#39;t compatible."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1485938902, "post_id": 41974881, "comment_id": 71128511, "body": "@2501 - A fair amount of legacy code uses them. I personally doubt they&#39;ll be removed in C2x, maybe in the revision following it. And as for casting, it&#39;s good so long as you aren&#39;t doing it just to silence the compiler."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1485939058, "post_id": 41974881, "comment_id": 71128627, "body": "That is why it is marked as obsolescent. New code is not legacy code. OP is writing new code. Yes casting is good, that was my argument, but your example avoids them."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1485939202, "post_id": 41974881, "comment_id": 71128714, "body": "@2501 - Casting is a subversion the type system. Now, sometimes they cannot be avoided, but code that overuses them will break when an erroneous change successfully passes a cast that was superfluously introduced before."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1485939256, "post_id": 41974881, "comment_id": 71128744, "body": "@StoryTeller The empty parameter list is a subversion (and prone to breakage in the future), to hide casts. What you&#39;re doing is equivalent to casting, except the casts are missing, where they should be."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1485939390, "post_id": 41974881, "comment_id": 71128823, "body": "@2501 - I&#39;m not subverting anything. Implicit conversions are there for a reason. It&#39;s no more a subversion than not casting the return of <code>malloc</code>."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1485939539, "post_id": 41974881, "comment_id": 71128925, "body": "Except that void* is explicitly defined to be convertible between object pointers, whereas such usage of empty parameters lists is exploting a loophole in the language."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1485939688, "post_id": 41974881, "comment_id": 71129014, "body": "@2501 - We&#39;ll agree to disagree about how much of a flaw it is. The designers of C++ considered the conversion from <code>void*</code> a flaw in and of itself, and somehow sold it as more type safe with a similar argument to yours. I disagree with that as well."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1485940377, "post_id": 41974881, "comment_id": 71129396, "body": "I&#39;m giving you a -1 for using an obsolescent feature where it isn&#39;t necessary."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1485940618, "post_id": 41974881, "comment_id": 71129569, "body": "@2501 - Whatever floats your boat"}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1485938515, "last_edit_date": 1485938515, "creation_date": 1485936996, "answer_id": 41974881, "question_id": 41974699, "link": "https://stackoverflow.com/questions/41974699/function-pointer-casting/41974881#41974881", "title": "Function pointer casting", "body": "<p>Well, casting should work. The C standard allows casting between function pointer types, the only thing you shouldn't do is call a function by a function pointer that has the wrong prototype, i.e. cast back to the correct prototype before the call, in order to avoid undefined behavior.</p>\n\n<p>Let's start by simplifying your arrays a little, for readability sake:</p>\n\n<pre><code>modbus_read_t*  M_callbacks_r[2];\nmodbus_write_t* M_callbacks_w[2];\nsystem_read_t*  P_callbacks_r[2];\nsystem_write_t* P_callbacks_w[2];\n</code></pre>\n\n<p>I don't know why you <code>typedef</code>ed the function type instead of the function pointer type, but I'll go along with it.</p>\n\n<p>Now <code>registerCallback</code> can be implemented as follows:</p>\n\n<pre><code>void registerCallback(int systemType,int operationType, void (*callback)()) {\n  // .. determine array by system type and operation type\n  M_callbacks_r[0] = (modbus_read_t*)callback;\n}\n</code></pre>\n\n<p>The reason I deleted the parameter from the <code>callback</code> prototype, is that in standard C, an empty parameter list conveys no information about the expected parameters (as opposed to C++ where it explicitly means \"no parameters\"). That way callbacks can be registered without requiring a cast.</p>\n\n<hr>\n\n<p>As you mentioned in the comments, you are building with <code>-Wstrict-prototypes -Werror</code>. So an empty parameter list will not work for you. You are thus restricted to defining <code>registerCallback</code> like this:</p>\n\n<pre><code>void registerCallback(int systemType,int operationType, void (*callback)(void))\n</code></pre>\n\n<p>Note the explicit <code>void</code> in the parameter list. You will need to cast the callback when passing it to <code>registerCallback</code> as well as casting it back inside the function itself.</p>\n\n<pre><code>registerCallback(type, op, (void(*)(void))func_cb);\n</code></pre>\n\n<hr>\n\n<p>Side note: The <code>_t</code> postfix is reserved on POSIX systems. To be portable, it may be best not to name your types with it.</p>\n"}], "owner": {"reputation": 1837, "user_id": 3681400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EIOOj.png?s=128&g=1", "display_name": "Cristian", "link": "https://stackoverflow.com/users/3681400/cristian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 843, "favorite_count": 0, "accepted_answer_id": 41974881, "answer_count": 1, "score": 2, "last_activity_date": 1485938515, "creation_date": 1485936324, "question_id": 41974699, "link": "https://stackoverflow.com/questions/41974699/function-pointer-casting", "title": "Function pointer casting", "body": "<p>Hello guys I'm currently facing a pretty annoying problem:</p>\n\n<p>I'm writing a system of callback manager that works by using function pointers, now given the fact that far now I've been assigned void function pointers to some other non-void function pointers, I've realized that it's not actually allowed in C.</p>\n\n<p>At the moment I'm thinking about casting the void pointer so that matches the prototype function I have for my each callback, but I cannot understand how to <strong>implement the casting</strong>.</p>\n\n<p>Would it be viable or should I adopt another solution?</p>\n\n<p>Currently these are my callback containers and their typedefs:</p>\n\n<pre><code>typedef void modbus_read_t(unsigned int uid, unsigned int address, unsigned int count, char* response);\ntypedef void modbus_write_t(unsigned int uid, unsigned int address, unsigned int *data, char* response);\n\ntypedef void system_read_t(unsigned int uid, unsigned int var_number, unsigned int count, char* response);\ntypedef void system_write_t(unsigned int uid, unsigned int var_number, struttura_system *storage, char* response );\n\nvoid (*M_callbacks_r[3]) (unsigned int uid, unsigned int address, unsigned int count, char* response);\nvoid (*M_callbacks_w[2]) (unsigned int uid, unsigned int address, unsigned int *data, char* response);\nvoid (*P_callbacks_r[2]) (unsigned int uid, unsigned int var_number, unsigned int count, char* response);\nvoid (*P_callbacks_w[2]) (unsigned int uid, unsigned int var_number, struttura_system *storage, char* response );\n</code></pre>\n\n<p>This is the prototype of the function that registers the callback:</p>\n\n<pre><code>void registerCallback(int systemType,int operationType, void (callback)(void*));\n</code></pre>\n\n<p>What has to be done is to cast <code>void (callback)(void*)</code> to one of the typedefs above.</p>\n"}, {"tags": ["c", "macos", "semaphore"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1485934501, "post_id": 41974248, "comment_id": 71126391, "body": "The value of <code>errno</code> is <i>undefined</i> if a call haven&#39;t failed. Don&#39;t use it unless you have actually determined that a call has failed. And also remember to actually <i>check</i> for failures."}, {"owner": {"reputation": 639, "user_id": 6708910, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/B5pvi.jpg?s=128&g=1", "display_name": "Our", "link": "https://stackoverflow.com/users/6708910/our"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1485934583, "post_id": 41974248, "comment_id": 71126426, "body": "@Someprogrammerdude isn&#39;t the purpose of <i>errno</i> is determine whether there is some error or not, and if there is, what is it ?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1485934599, "post_id": 41974248, "comment_id": 71126432, "body": "Furthermore, what <i>thread</i> are you talking about? I see no thread or process creation."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1485934662, "post_id": 41974248, "comment_id": 71126459, "body": "All calls that can fail will return a special value if they fail, typically <code>-1</code>. You need to check for that and <i>then</i> use <code>errno</code> to determine what the error is. <b><i>Read the manual pages!</i></b>"}, {"owner": {"reputation": 639, "user_id": 6708910, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/B5pvi.jpg?s=128&g=1", "display_name": "Our", "link": "https://stackoverflow.com/users/6708910/our"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1485934719, "post_id": 41974248, "comment_id": 71126485, "body": "@Someprogrammerdude I forgot to add it I guess but still the main process doesn&#39;t wait for the semaphore."}, {"owner": {"reputation": 639, "user_id": 6708910, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/B5pvi.jpg?s=128&g=1", "display_name": "Our", "link": "https://stackoverflow.com/users/6708910/our"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1485934744, "post_id": 41974248, "comment_id": 71126491, "body": "@Someprogrammerdude oh, thanks for the info."}, {"owner": {"reputation": 639, "user_id": 6708910, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/B5pvi.jpg?s=128&g=1", "display_name": "Our", "link": "https://stackoverflow.com/users/6708910/our"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1485935006, "post_id": 41974248, "comment_id": 71126600, "body": "@Someprogrammerdude I added the thread, but the result is the same."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1485935209, "post_id": 41974248, "comment_id": 71126705, "body": "By the way you use the <a href=\"http://man7.org/linux/man-pages/man2/semop.2.html\" rel=\"nofollow noreferrer\"><code>semop</code></a> function wrong, and it will lead to <i>undefined behavior</i>. The third argument is not the size of the structure, but the number of structures in the array you pass to <code>semop</code>. In your case the third argument should be <code>1</code> since you only have a single <code>sembuf</code> structure. And you <i>really</i> should be adding more error checking, to see if any of the functions fail (something you don&#39;t care about now, if there&#39;s a failure you just continue as if nothing happened)."}, {"owner": {"reputation": 639, "user_id": 6708910, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/B5pvi.jpg?s=128&g=1", "display_name": "Our", "link": "https://stackoverflow.com/users/6708910/our"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1485935455, "post_id": 41974248, "comment_id": 71126804, "body": "@Someprogrammerdude, ok after changing it it worked! :), but there is still some questions that I have.I&#39;m going to edit the question."}, {"owner": {"reputation": 639, "user_id": 6708910, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/B5pvi.jpg?s=128&g=1", "display_name": "Our", "link": "https://stackoverflow.com/users/6708910/our"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1485936187, "post_id": 41974248, "comment_id": 71127158, "body": "@Someprogrammerdude By the way, right now the thread doesn&#39;t pass the semop function."}], "owner": {"reputation": 639, "user_id": 6708910, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/B5pvi.jpg?s=128&g=1", "display_name": "Our", "link": "https://stackoverflow.com/users/6708910/our"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485935719, "creation_date": 1485934373, "last_edit_date": 1485935719, "question_id": 41974248, "link": "https://stackoverflow.com/questions/41974248/set-of-counting-semaphores-are-not-working-on-mac-osx", "title": "Set of counting semaphores are not working on Mac OSX", "body": "<p>I have the following code in order to test whether semaphore is working or not;</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/sem.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;sys/mman.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stdlib.h&gt;\n\nint semID;\nint i = -1;\nstruct sembuf sem_buf;\n\nvoid * spawn(void * params){\n\n    printf(\"semID: %d\\n\", semID);\n    semop(semID, &amp;sem_buf, 1);\n    printf(\"i: %d\\n\", i);\n    shmctl(semID, 0, IPC_RMID);\n\n    return NULL;\n}\n\nint main(int argc, char const *argv[])\n{\n\n    sem_buf.sem_num = 0;\n    sem_buf.sem_op = -1;\n    sem_buf.sem_flg = SEM_UNDO;\n\n    semID = semget(IPC_PRIVATE, 4, IPC_CREAT);\n    printf(\"semID: %d\\n\", semID);\n    semctl(semID, 0, SETALL);\n\n    switch(errno){\n        case EACCES:\n        printf(\"EACCES\\n\");\n        shmctl(semID, 0, IPC_RMID);\n        //return 0;\n        break;\n\n        case EEXIST:\n        printf(\"EEXIST\\n\");\n        shmctl(semID, 0, IPC_RMID);\n        return 0;\n        break;\n\n        case EINVAL:\n        printf(\"EINVAL\\n\");\n        shmctl(semID, 0, IPC_RMID);\n        return 0;\n        break;\n\n        case ENOENT:\n        printf(\"ENOENT\\n\");\n        shmctl(semID, 0, IPC_RMID);\n        return 0;\n        break;\n\n        case ENOSPC:\n        printf(\"ENOSPC\\n\");\n        shmctl(semID, 0, IPC_RMID);\n        return 0;\n        break;\n    }\n\n    pthread_t threadID;\n    pthread_create(&amp;threadID, NULL, spawn, NULL);\n\n    sleep(1);\n    printf(\"i is becoming 72.\\n\");\n    i = 72;\n\n    sem_buf.sem_num = 0;\n    sem_buf.sem_op = 1;\n    sem_buf.sem_flg = SEM_UNDO;\n\n    return 0;\n}\n</code></pre>\n\n<p>And I have the following output when I run it as root;</p>\n\n<pre><code>semID: 262144\nsemID: 262144\ni: -1\ni is becoming 72.\n</code></pre>\n\n<p>So the thread is not waiting for the semaphore, but why is that so ? what is wrong with the code ?</p>\n\n<p>I know that unnamed semaphores, i.e <em>sem_init()</em> and <em>sem_destroy()</em>, are not working on Mac OSX, but in here we are using <em>setget()</em> and etc. </p>\n\n<p>Edit:\nAfter changing third argument of <em>semop()</em> function, as @Someprogrammerdude suggested, it worked, but still there is a problem.While creating the semaphore, if I give zero as the second argument, it returns <strong>EINVAL</strong>, but I checked the manage, but none of the cause of EINVAL error is occurring.So what is the problem in this case ?</p>\n"}, {"tags": ["c", "arrays", "undefined-behavior"], "comments": [{"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 4, "creation_date": 1485931733, "post_id": 41973550, "comment_id": 71125066, "body": "That&#39;s undefined behavior!!! The C language standard does not dictate the behavior of your program following this operation (in oppose to Java <code>IndexOutOfBound</code> exception, for example)."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1485932985, "post_id": 41973550, "comment_id": 71125644, "body": "<a href=\"http://stackoverflow.com/questions/15646973/how-dangerous-is-it-to-access-an-array-out-of-bounds\" title=\"how dangerous is it to access an array out of bounds\">stackoverflow.com/questions/15646973/&hellip;</a>"}, {"owner": {"reputation": 569, "user_id": 4181430, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1488320649/picture?type=large", "display_name": "jurhas", "link": "https://stackoverflow.com/users/4181430/jurhas"}, "edited": false, "score": 0, "creation_date": 1485939056, "post_id": 41973550, "comment_id": 71128624, "body": "It fall out the stack, crashes. If you try to read an existent address crashes. If it fall out the heap crashes. If try to write out the bondaryes, damages the memory handler"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 5102882, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-oOKgu8bOP8s/AAAAAAAAAAI/AAAAAAAAABo/Ta3RAAEDYRI/photo.jpg?sz=128", "display_name": "b9703", "link": "https://stackoverflow.com/users/5102882/b9703"}, "edited": false, "score": 0, "creation_date": 1485932005, "post_id": 41973590, "comment_id": 71125192, "body": "So is it certain that this 0 value is unrelated to the program e.g. some quirk of the operating system or compiler"}, {"owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "reply_to_user": {"reputation": 107, "user_id": 5102882, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-oOKgu8bOP8s/AAAAAAAAAAI/AAAAAAAAABo/Ta3RAAEDYRI/photo.jpg?sz=128", "display_name": "b9703", "link": "https://stackoverflow.com/users/5102882/b9703"}, "edited": false, "score": 4, "creation_date": 1485932041, "post_id": 41973590, "comment_id": 71125208, "body": "@b9703 read this well: <a href=\"http://blog.llvm.org/2011/05/what-every-c-programmer-should-know.html\" rel=\"nofollow noreferrer\">blog.llvm.org/2011/05/what-every-c-programmer-should-know.ht&zwnj;&#8203;ml</a>"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 8, "last_activity_date": 1485932074, "last_edit_date": 1485932074, "creation_date": 1485931805, "answer_id": 41973590, "question_id": 41973550, "link": "https://stackoverflow.com/questions/41973550/indexing-past-the-end-of-c-arrays/41973590#41973590", "title": "indexing past the end of C arrays", "body": "<blockquote>\n  <p><em>... just to see what happens when you index past the end of an array</em></p>\n</blockquote>\n\n<p>Trying to access out of bound memory, invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"noreferrer\">undefined behavior</a>. Anything can happen, just anything.</p>\n\n<p>In your case, for <em>some</em> reason, the memory address for upto index 52 is accessible from the process, so it allows the access. Index past 52 points to a memory region not allocated to your process address space and thus, raises the access violation leading to segfault. This is <strong>not</strong> a deterministic behaviour, at all and there's no way you can rely on the output of a program invoking UB.</p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 3, "last_activity_date": 1485934277, "creation_date": 1485934277, "answer_id": 41974230, "question_id": 41973550, "link": "https://stackoverflow.com/questions/41973550/indexing-past-the-end-of-c-arrays/41974230#41974230", "title": "indexing past the end of C arrays", "body": "<p>Accessing array elements beyond array boundaries (before <code>0</code> or from its size up) is undefined behavior. It may or may not produce values, it may cause the program to end abruptly, it may cause your system to stop, restart or catch fire...</p>\n\n<p>Modern systems try to confine undefined behavior within reasonable limits via memory protection, user space limitations etc. but even user space code errors can have dire consequences: </p>\n\n<ul>\n<li>pacemaker messing with its timing values can cause premature death ;</li>\n<li>banking software overflowing array boundaries can overwrite account balance information crediting some random account with untold amounts of dollars.</li>\n<li>your self driving car could behave worse than drunk drivers...</li>\n<li>think of nuclear power-plant control software, airplane instruments, military stuff...</li>\n</ul>\n\n<p>There is no question <em>undefined behavior</em> should be avoided.</p>\n\n<p>Regarding the exit status, your program uses an obsolete syntax for the definition of <code>main()</code>, implicit return type, which is no longer supported in C99 and later, but does not return anything, which means its return value can be any random value, including a different value for every execution. C99 specified a kludge for the <code>main()</code> function and forces an implicit <code>return 0;</code> at the end of <code>main()</code>, but relying on it is bad style.</p>\n\n<p>Similarly, invoking <code>printf()</code> without a proper prototype is undefined behavior. You should include <code>&lt;stdio.h&gt;</code> before the definition of function <code>main()</code>.</p>\n\n<p>Lastly, <code>ar[0]</code> and <code>ar[1]</code> are initialized in <code>main()</code>, but <code>ar[2]</code> and <code>ar[3]</code> are not. Be aware that accessing uninitialized values also has undefined behavior. The values can be anything at all, what you describe as <em>random values</em>, but on some systems, they could be trap values, causing undefined behavior by just reading them.</p>\n\n<p>Some very handy tools are available to track this kind of problems in simple and complex programs, most notably <code>valgrind</code>. If you are curious about this subject, You should definitely look at it.</p>\n"}], "owner": {"reputation": 107, "user_id": 5102882, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-oOKgu8bOP8s/AAAAAAAAAAI/AAAAAAAAABo/Ta3RAAEDYRI/photo.jpg?sz=128", "display_name": "b9703", "link": "https://stackoverflow.com/users/5102882/b9703"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1906, "favorite_count": 0, "closed_date": 1485948279, "answer_count": 2, "score": 1, "last_activity_date": 1486234397, "creation_date": 1485931682, "last_edit_date": 1486234397, "question_id": 41973550, "link": "https://stackoverflow.com/questions/41973550/indexing-past-the-end-of-c-arrays", "closed_reason": "Duplicate", "title": "indexing past the end of C arrays", "body": "<p>I wrote a short program in C just to see what happens when you index past the end of an array.</p>\n\n<p>I found that it mostly produces random values (I know they are not actually random) up until a point (52 indexes past the end in this case) where it produced 0 every single time. Every value past this point and the program crashes. Why is this? is it the end of the programs allocated memory space?</p>\n\n<pre><code>main()\n{\n    int ar[4];\n    ar[0] = 99;\n    ar[1] = 45;\n    printf(\"array: %d, %d   random value: %d\", ar[0], ar[1], ar[55]);\n}\n</code></pre>\n\n<p><strong>Edit:</strong> I also found that if I alter this value that always ends up being 0 (i.e. ar[55] = 1000) then the return code for the program goes up.</p>\n"}, {"tags": ["c", "visual-studio-2010", "c-preprocessor"], "answers": [{"tags": [], "owner": {"reputation": 27011, "user_id": 1490355, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/296f0478cb1b6724e3f862ace601fa99?s=128&d=identicon&r=PG", "display_name": "SingerOfTheFall", "link": "https://stackoverflow.com/users/1490355/singerofthefall"}, "is_accepted": true, "score": 6, "last_activity_date": 1485931879, "creation_date": 1485931879, "answer_id": 41973609, "question_id": 41973491, "link": "https://stackoverflow.com/questions/41973491/what-does-mean-by-inactive-preprocessor-block-in-c/41973609#41973609", "title": "What does mean by &quot;inactive&quot; preprocessor block in C?", "body": "<p>An inactive preprocessor block is a block of code that is deactivated because of a preprocessor directive. The simplest example is:</p>\n\n<pre><code>#if 0\n//everytyhing here is inactive and will be ignored during compilation\n#endif\n</code></pre>\n\n<p>A more common example would be </p>\n\n<pre><code>#ifdef SOME_VAR\n// code\n#else\n// other code\n#endif\n</code></pre>\n\n<p>In this case either the first or the second block of code will be inactive depending on whether <code>SOME_VAR</code> is defined.</p>\n"}, {"tags": [], "owner": {"reputation": 1389, "user_id": 4914757, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xIqlJ.png?s=128&g=1", "display_name": "A.B.", "link": "https://stackoverflow.com/users/4914757/a-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1485932491, "creation_date": 1485932491, "answer_id": 41973757, "question_id": 41973491, "link": "https://stackoverflow.com/questions/41973491/what-does-mean-by-inactive-preprocessor-block-in-c/41973757#41973757", "title": "What does mean by &quot;inactive&quot; preprocessor block in C?", "body": "<p>Please check this hypothetical example created to elaborate your question.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;windef.h&gt;\n\n#define _WIN32\n\nint add(int n1, int n2){return n1 + n2;}\n\nLONGLONG add(LONGLONG n1, LONGLONG n2){return n1 + n2;}\n\nint _tmain(int argc, _TCHAR* argv[])\n{\n#ifdef _WIN32\n    int val = add(10, 12);\n#else\n    LONGLONG = add(100L, 120L);//Inactive code\n#endif // _WIN32\n    return 0;\n}\n</code></pre>\n\n<p>You can see as _WIN32 is defined the code in #else pre-processor directive is disabled and would not be compiled. You can undefine _WIN32 to see reverse in action. See the screen shot of MS Visual Studio attached. The line in red is disabled code.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8SfF0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8SfF0.png\" alt=\"enter image description here\"></a></p>\n\n<p>Hope this would help.</p>\n"}, {"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1485932906, "creation_date": 1485932906, "answer_id": 41973856, "question_id": 41973491, "link": "https://stackoverflow.com/questions/41973491/what-does-mean-by-inactive-preprocessor-block-in-c/41973856#41973856", "title": "What does mean by &quot;inactive&quot; preprocessor block in C?", "body": "<p>The preprocessor is one the earliest stages of a programs translation. It can modify the source of the program before the compilation stage begins. That way you can configure the source to build differently, depending on various constraints.</p>\n\n<p>Uses of preprocessor condition blocks include:</p>\n\n<ol>\n<li><p>Completely commenting out code:</p>\n\n<pre><code>#if 0\n// The code here is never compiled. It's \"commented\" away\n#endif\n</code></pre></li>\n<li><p>Provide different implementations based on various constraints, like platfrom</p>\n\n<pre><code>#if defined(WIN32)\n  //Implement widget with Win32Api\n\n#elif defined(MOTIF)\n  // Implement widget with Motif framework\n\n#else\n  #error \"Unknown platform\"\n#endif\n</code></pre></li>\n<li><p>Have a macro like <a href=\"http://en.cppreference.com/w/c/error/assert\" rel=\"nofollow noreferrer\"><code>assert</code></a> behave in different ways.</p></li>\n<li><p>Make sure a useful abstraction is defined appropriately:</p>\n\n<pre><code>#if PLATFORM_A\n  typedef long int32_t;\n#elif PLATFORM_B\n  typedef int  int32_t;\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 25, "user_id": 7498869, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jirVX9oahLc/AAAAAAAAAAI/AAAAAAAAAQE/z3pJdLyEaQE/photo.jpg?sz=128", "display_name": "Muhammad Ahmed", "link": "https://stackoverflow.com/users/7498869/muhammad-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2748, "favorite_count": 0, "accepted_answer_id": 41973609, "answer_count": 3, "score": 3, "last_activity_date": 1485941196, "creation_date": 1485931471, "last_edit_date": 1485941196, "question_id": 41973491, "link": "https://stackoverflow.com/questions/41973491/what-does-mean-by-inactive-preprocessor-block-in-c", "title": "What does mean by &quot;inactive&quot; preprocessor block in C?", "body": "<p>I found some lines of code, those are dimmed in my preprocessor block of source code in <strong>C</strong>. My compiler, MS Visual Studio, naming it \"inactive preprocessor block\". What does this mean, will my compile do not consider these lines of code,\nand how to make it active block?</p>\n"}, {"tags": ["c", "linux", "file", "io", "linux-kernel"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1485932586, "post_id": 41972971, "comment_id": 71125462, "body": "Have you tried to <b>debug</b> you code, for determine <b>which line of code crashes</b>? For debug kernel code you may add <code>printk()</code> calls after certain points. Also, if code crashes, <code>dmesg</code> may give additional information about that."}, {"owner": {"reputation": 3, "user_id": 7498777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e11ec3570e72db3c0a3203a88908800?s=128&d=identicon&r=PG&f=1", "display_name": "user7498777", "link": "https://stackoverflow.com/users/7498777/user7498777"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1485933514, "post_id": 41972971, "comment_id": 71125892, "body": "dmesg gives RIP  [&lt;ffffffff8120d165&gt;] vfs_read+0x5/0x130 and fbcon_switch: detected unhandled fb_set_par error"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1485934170, "post_id": 41972971, "comment_id": 71126236, "body": "Which branch in your <code>hello_init</code> function is executed? (Is it <code>cat(0)</code>, or <code>cat(f)</code>)? Note, that your module accepts <b>array of pointers</b>, which is probably not what you expect. That is, <code>argv[i]</code> is a pointer to .. garbage, and dereferencing it (e.g. in <code>filp_open()</code> call) is a <b>definite error</b>."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1485936944, "post_id": 41972971, "comment_id": 71127499, "body": "Well, simplified version is clear. The first thing: <code>filp_open()</code> returns <code>struct file*</code> (not an <code>int</code>),  and cheking for success should be <code>!IS_ERR(f)</code>. If <code>filp_open</code> successfull, you may pass value it returns to <code>vfs_read()</code>. Closing the file is performed with <code>fput(f)</code>."}, {"owner": {"reputation": 3, "user_id": 7498777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e11ec3570e72db3c0a3203a88908800?s=128&d=identicon&r=PG&f=1", "display_name": "user7498777", "link": "https://stackoverflow.com/users/7498777/user7498777"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1485947297, "post_id": 41972971, "comment_id": 71134081, "body": "@Tsyvarev Thank you very much, it worked"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7498777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e11ec3570e72db3c0a3203a88908800?s=128&d=identicon&r=PG&f=1", "display_name": "user7498777", "link": "https://stackoverflow.com/users/7498777/user7498777"}, "edited": false, "score": 0, "creation_date": 1485933787, "post_id": 41973822, "comment_id": 71126032, "body": "Thanks a lot. There seems to be another problem in vfs_read. dmesg gives RIP [&lt;ffffffff8120d165&gt;] vfs_read+0x5/0x130 and fbcon_switch: detected unhandled fb_set_par error"}], "tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": true, "score": 1, "last_activity_date": 1485935524, "last_edit_date": 1485935524, "creation_date": 1485932760, "answer_id": 41973822, "question_id": 41972971, "link": "https://stackoverflow.com/questions/41972971/kernel-module-killed-on-using-insmod/41973822#41973822", "title": "kernel module killed on using insmod", "body": "<p>A few things ...</p>\n\n<p>You're trying to do all this from the module init callback.</p>\n\n<p><code>argc/argv</code> have nothing in them, so that's a problem (i.e. you could get a segfault).</p>\n\n<p>You <em>could</em> hardwire <code>argc/argv</code> with valid values, but you'd have to recompile and reload the driver with the different files you want to cat.</p>\n\n<p>But it might be better to accept a module parameter and split it up with a <code>strtok</code> equivalent to populate your <code>argv</code>. This is the closest thing to an <code>argv</code> equivalent for a driver [which doesn't really exist in exactly the same way as it does for <code>main</code> in an application].</p>\n\n<p>You wouldn't have to recompile the module, but, you would <em>still</em> have to reload it each time (giving <code>insmod</code> a different argument each time)</p>\n\n<p>However, the real/correct way to do this would be, in the module init, to register your driver as a character device using the standard mechanism. And, likewise, unregister it in the module cleanup routine.</p>\n\n<p>Then, create a <code>/dev</code> entry (e.g. <code>/dev/mycat</code>).</p>\n\n<p>From an application, open <code>/dev/mycat</code>, and write a list of files you want cat'ed to the file descriptor, one per line.</p>\n\n<p>Have the driver's <code>write</code> callback routine, parse down the data in the buffer you're passed (i.e. as if you were implementing your own <code>fgets</code> in userspace), and process the list it gets, performing the cat operation on each file.</p>\n\n<p>Rather than creating a <code>/dev</code> entry, it <em>might</em> be easier to create a <code>/proc</code> entry (e.g. <code>/proc/mycat</code>)--YMMV</p>\n\n<p>The actual mechanism to communicate the file list to the driver is arbitrary. You could use an <code>AF_UNIX</code> socket, a named pipe, hook up to a SysV message queue, etc. but the <code>/dev</code> or <code>/proc</code> solution is probably easier.</p>\n\n<hr>\n\n<p><strong>UPDATE:</strong></p>\n\n<blockquote>\n  <p>There seems to be another problem in vfs_read. dmesg gives RIP [] vfs_read+0x5/0x130 and fbcon_switch: detected unhandled fb_set_par error</p>\n</blockquote>\n\n<p>Amongst other things, you are passing an <code>int</code> as the first arg to <code>vfs_read</code>. The first arg needs to be <code>struct file *</code> [just like <code>vfs_write</code>].</p>\n\n<p><em>Note:</em> If you're building the driver using the standard mechanism, this would have compiled with <code>-Wall</code> and this would have been flagged at compile time.</p>\n\n<p>Also, you're trying to write [the cat output] to the same file you're reading from, even though you opened it with <code>O_RDONLY</code> (i.e. equivalent to userspace <code>cat foobar &gt; foobar</code>). That's because, for the <code>vfs_write</code>, you did <code>file = fget(f)</code>. What you really wanted to do was <code>file = fget(1)</code></p>\n\n<p>For both <code>vfs_read</code> and <code>vfs_write</code>, you need <code>fget/fput</code> pairings. And, they need to be <em>separate</em>:</p>\n\n<pre><code>file_in = fget(f);\nfile_out = fget(1);\n\n// read/write loop ...\nwhile (1) {\n    ...\n}\n\nfput(file_in);\nfput(file_out);\n</code></pre>\n\n<p>You do <em>not</em> want to put <code>buf</code> on the stack. This produces a race condition. The [kernel] thread could migrate to another processor while I/O is still pending on the <code>vfs_read</code> [AFAIK]. Other drivers that do similar stuff use <code>kmalloc</code> to get the buffer [and <code>kfree</code> to free it].</p>\n"}], "owner": {"reputation": 3, "user_id": 7498777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e11ec3570e72db3c0a3203a88908800?s=128&d=identicon&r=PG&f=1", "display_name": "user7498777", "link": "https://stackoverflow.com/users/7498777/user7498777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3793, "favorite_count": 0, "accepted_answer_id": 41973822, "answer_count": 1, "score": 0, "last_activity_date": 1485935524, "creation_date": 1485929126, "last_edit_date": 1485935384, "question_id": 41972971, "link": "https://stackoverflow.com/questions/41972971/kernel-module-killed-on-using-insmod", "title": "kernel module killed on using insmod", "body": "<p>I am trying to implement cat command as a kernel module. I know file i/o should not be done in a kernel module,. Every time I use <code>insmod module.ko</code> I  get the output as <code>killed</code> . How can I fix it? Also how can I improve the code?\n<br> kernel version - 4.4\n<br>Code:</p>\n\n<pre><code>#include &lt;linux/module.h&gt;   \n#include &lt;linux/kernel.h&gt;\n#include &lt;linux/unistd.h&gt;\n#include &lt;linux/syscalls.h&gt; \n#include &lt;linux/fcntl.h&gt; \n#include &lt;asm/uaccess.h&gt;\n#include &lt;linux/init.h&gt; \n#include &lt;linux/fs.h&gt;\n#include &lt;linux/file.h&gt; \n\nstatic char* argv[10];\nstatic int argc = 1;\nmodule_param_array(argv, int, &amp;argc , 0);\n\nstatic void cat(int f, char *s)\n{\n    char buf[8192];\n    struct file *file;\n    loff_t pos = 0;\n    long n;\n    mm_segment_t old_fs = get_fs();\n    set_fs(KERNEL_DS);\n\n    while((n = vfs_read(f, buf, (long)sizeof buf, &amp;pos)) &gt; 0) \n    {\n        //write(1, buf, n);\n        file = fget(f);\n        if (file) {\n            vfs_write(file, buf, (long)sizeof buf, &amp;pos);\n            fput(file);\n        }\n\n\n    }\n    set_fs(old_fs);\n}\n\nstatic void __init hello_init(void)\n{\n    int f, i;\n    if(argc == 1)\n        cat(0, \"&lt;stdin&gt;\");\n    else for(i=1; i&lt;argc; i++)\n    {\n        f = filp_open(argv[i], O_RDONLY, 0);\n        if(f &lt; 0)\n            printk(\"error\");\n        else{\n            cat(f, argv[i]);\n            filp_close(f);\n        }\n    }\n}\n\nstatic void __exit hello_cleanup(void)\n{\n    printk(KERN_INFO \"Cleaning up module.\\n\");\n}\n\nmodule_init(hello_init);\nmodule_exit(hello_cleanup);\n</code></pre>\n\n<p>Here is a simplified version of the above code which just reads a file. On commenting out the <code>vfs_read</code> part, I'm able to insmod it, but with <code>vfs_read</code> it shows killed.</p>\n\n<pre><code>#include &lt;linux/kernel.h&gt;\n#include &lt;linux/init.h&gt;\n#include &lt;linux/module.h&gt;\n#include &lt;linux/syscalls.h&gt;\n#include &lt;linux/fcntl.h&gt;\n#include &lt;asm/uaccess.h&gt;\n\nstatic void read_file(char *filename)\n{\n  int fd;\n  char buf[1];\n  loff_t f_pos = 0;\n\n  mm_segment_t old_fs = get_fs();\n  set_fs(KERNEL_DS);\n\n  fd = filp_open(filename, O_RDONLY, 0);\n  if (fd &gt;= 0) {\n    printk(KERN_DEBUG);\n    while (vfs_read(fd, buf, 1, &amp;f_pos) == 1) //if this\n      printk(\"%c\", buf[0]);  //and this is removed I'm able to insmod it\n    printk(\"\\n\");\n    sys_close(fd);\n  }\n  set_fs(old_fs);\n}\n\nstatic int __init init(void)\n{\n  read_file(\"/etc/shadow\");\n  return 0;\n}\n\nstatic void __exit exit(void)\n{ }\n\nmodule_init(init);\nmodule_exit(exit);\n</code></pre>\n"}, {"tags": ["c", "printf", "output"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1485928906, "post_id": 41972906, "comment_id": 71123892, "body": "Print to <code>stdout</code>? <code>fprintf()</code> maybe a overkill for that."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1485929041, "post_id": 41972906, "comment_id": 71123958, "body": "Do you know how to use escape sequences? Inside a string literal (<code>&quot;this is a string literal&quot;</code>), <code>\\n</code> represents a newline, <code>\\&quot;</code> represents a double quote, and <code>\\\\</code> represents a backslash. Making use of those representations will let you represent your code as a string literal, which you can then print like anything else (using <code>puts</code> or <code>printf</code> or\u2026)."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 7054252, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5029942d10422ca3d8252f0f5d36b12f?s=128&d=identicon&r=PG&f=1", "display_name": "Moy_Desu", "link": "https://stackoverflow.com/users/7054252/moy-desu"}, "edited": false, "score": 0, "creation_date": 1485965486, "post_id": 41973192, "comment_id": 71146674, "body": "I tried this but what I actually would like to do is to make the program the output. So that when I run the program the actual output is the program above not the degrees to radian conversion."}], "tags": [], "owner": {"reputation": 133, "user_id": 7424291, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dWpdh.jpg?s=128&g=1", "display_name": "rahul_T_T", "link": "https://stackoverflow.com/users/7424291/rahul-t-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1485930140, "creation_date": 1485930140, "answer_id": 41973192, "question_id": 41972906, "link": "https://stackoverflow.com/questions/41972906/write-a-program-using-a-loop-that-outputs-the-following-program/41973192#41973192", "title": "Write a program using a loop that outputs the following program", "body": "<p>Here is how you can use <code>fprintf</code> in your code</p>\n\n<pre><code>int main() {\n    FILE * fp;\n     int degrees =10;\n     double radians;\n     printf(\"Degrees to Radians \\n\");\n    fp = fopen(\"radians.txt\",\"w+\");\n     while( degrees &lt;= 360){\n         radians = degrees*PI/180;\n         printf(\"%6i %9.6f \\n\", degrees, radians);\n         fprintf(fp, \"%6i\\t%9.6f \\n\", degrees, radians);\n        degrees +=10;\n     }\n    return 0;\n}\n</code></pre>\n\n<p>here i added <code>\\t</code> inside fprintf to get a tab space. And <code>\"w+\"</code> in fopen will create new file with the given name, So all your out put will be saved in a file.</p>\n"}], "owner": {"reputation": 19, "user_id": 7054252, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5029942d10422ca3d8252f0f5d36b12f?s=128&d=identicon&r=PG&f=1", "display_name": "Moy_Desu", "link": "https://stackoverflow.com/users/7054252/moy-desu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1485930140, "creation_date": 1485928832, "question_id": 41972906, "link": "https://stackoverflow.com/questions/41972906/write-a-program-using-a-loop-that-outputs-the-following-program", "title": "Write a program using a loop that outputs the following program", "body": "<p>So i have written a program that converts degrees to radians and then prints the result as the output.</p>\n\n<pre><code> CODE (website not phone friendly)\n #include &lt;stdio.h&gt;\n #define PI 3.141593\n int main (){\n     int degrees =10;\n     double radians;\n     printf(\"Degrees to Radians \\n\");\n\n     while( degrees &lt;= 360){\n         radians = degrees*PI/180;\n         printf(\"%6i %9.6f \\n\", degrees, radians);\n        degrees +=10;\n     }\n }\n END CODE\n</code></pre>\n\n<p>So I would like to be able to make this program the actual output that my program creates. I had someone suggest to me fprintf but they did not elaborate. Im new to c programming, can anyone explain how I could use fprintf ( broad idea maybe?). I understand that fprint is another way to print output but thats about it.</p>\n"}, {"tags": ["mysql", "c", "linux", "netbeans", "connector"], "comments": [{"owner": {"reputation": 47988, "user_id": 267540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2v58W.jpg?s=128&g=1", "display_name": "e4c5", "link": "https://stackoverflow.com/users/267540/e4c5"}, "edited": false, "score": 0, "creation_date": 1485928408, "post_id": 41972724, "comment_id": 71123729, "body": "why not the obvious <code>puts (mysql_error(mysql));</code> ??"}, {"owner": {"reputation": 127, "user_id": 1070376, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/685c924ce35a28d0f22f2f0071758807?s=128&d=identicon&r=PG", "display_name": "sax", "link": "https://stackoverflow.com/users/1070376/sax"}, "reply_to_user": {"reputation": 47988, "user_id": 267540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2v58W.jpg?s=128&g=1", "display_name": "e4c5", "link": "https://stackoverflow.com/users/267540/e4c5"}, "edited": false, "score": 1, "creation_date": 1485929459, "post_id": 41972724, "comment_id": 71124125, "body": "HaHa!! Because you are dealing with a C/MySQL noob, and obvious isn&#39;t on the menu ;) But your suggestion did create some new intrigue.  The error printed &quot;Can&#39;t connect to local MySQL server through socket &#39;/tmp/mysql.sock&#39; (2)&quot;.  So it looks like I have a socket problem.  Let me know if you know anything about this, while I dig into the Google machine.  Thx!"}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 1070376, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/685c924ce35a28d0f22f2f0071758807?s=128&d=identicon&r=PG", "display_name": "sax", "link": "https://stackoverflow.com/users/1070376/sax"}, "edited": false, "score": 0, "creation_date": 1485930893, "post_id": 41973153, "comment_id": 71124699, "body": "e4c5, you are a verifiable genius!  I would have searched long and hard and likely would not have come up with this.  I am a windows user, and am converting my database and backend processing to Linux to save money and my head has really been swimming.  I can&#39;t thank you enough for taking the time to help! 127.0.0.1 was the answer for me"}, {"owner": {"reputation": 47988, "user_id": 267540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2v58W.jpg?s=128&g=1", "display_name": "e4c5", "link": "https://stackoverflow.com/users/267540/e4c5"}, "reply_to_user": {"reputation": 127, "user_id": 1070376, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/685c924ce35a28d0f22f2f0071758807?s=128&d=identicon&r=PG", "display_name": "sax", "link": "https://stackoverflow.com/users/1070376/sax"}, "edited": false, "score": 0, "creation_date": 1485930984, "post_id": 41973153, "comment_id": 71124741, "body": "I am delighted to have been of help. All the best with your project."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 1, "creation_date": 1485939083, "post_id": 41973153, "comment_id": 71128644, "body": "Nice answer!!! I didn&#39;t know that 127.0.0.1 and localhost was interpreted in different manner by mysql"}, {"owner": {"reputation": 47988, "user_id": 267540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2v58W.jpg?s=128&g=1", "display_name": "e4c5", "link": "https://stackoverflow.com/users/267540/e4c5"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 1, "creation_date": 1485939613, "post_id": 41973153, "comment_id": 71128974, "body": "glad it proved usefull for more than just the op @KeineLust"}], "tags": [], "owner": {"reputation": 47988, "user_id": 267540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2v58W.jpg?s=128&g=1", "display_name": "e4c5", "link": "https://stackoverflow.com/users/267540/e4c5"}, "is_accepted": true, "score": 2, "last_activity_date": 1485930001, "creation_date": 1485930001, "answer_id": 41973153, "question_id": 41972724, "link": "https://stackoverflow.com/questions/41972724/netbeans-on-linux-to-connect-to-a-mysql-database-in-c/41973153#41973153", "title": "Netbeans on Linux to Connect to a MySQL Database in C", "body": "<p>When using a mysql client library in most languages including C, if the hostname is specified as <code>localhost</code> the client library will attempt to connect through a unix domain socket. You can force connection using TCP/IP by specifying the hostname as <code>127.0.0.1</code> </p>\n\n<p>Yes they are one and the same <a href=\"https://dev.mysql.com/doc/refman/5.7/en/mysql-real-connect.html\" rel=\"nofollow noreferrer\">but</a> </p>\n\n<blockquote>\n  <p>If unix_socket is not NULL, the string specifies the socket or named\n  pipe to use. Note that the host parameter determines the type of the\n  connection.</p>\n</blockquote>\n\n<p>Alternatively you can examine your mysql configuration to find out where the socket has been created when the server starts and use that as the unix_socket parameter. </p>\n\n<p>Third alternative is to change your server configuration to create the socket on /tmp/</p>\n"}], "owner": {"reputation": 127, "user_id": 1070376, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/685c924ce35a28d0f22f2f0071758807?s=128&d=identicon&r=PG", "display_name": "sax", "link": "https://stackoverflow.com/users/1070376/sax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 41973153, "answer_count": 1, "score": 2, "last_activity_date": 1485930001, "creation_date": 1485928059, "last_edit_date": 1485929772, "question_id": 41972724, "link": "https://stackoverflow.com/questions/41972724/netbeans-on-linux-to-connect-to-a-mysql-database-in-c", "title": "Netbeans on Linux to Connect to a MySQL Database in C", "body": "<p>Basically, I am trying to connect to a MySQL Database using Connector C drivers for MySQL. I am writing the code in Netbeans on a Linux system.  But here is the mystery: I can connect to my database in Debug Mode, but not Release Mode??? I am using Netbeans as my IDE on Linux, and I set up all the libraries and include folders using the  dropdown under project properties so it applies the properties to both the Debug Configuration and Release Configuration, and yet it will connect to the database when I execute in Debug, but not when I execute in Run - ??? I simplified the code to show you the actual connection code:</p>\n\n<pre><code>int readDB(void) {\n    MYSQL *mysql = NULL;\n    char *server = \"localhost\";\n    char *user = \"root\";\n    char *password = \"\";\n    char *database = \"myDB\";\n    int port = 3306;\n\n    mysql = mysql_init(mysql);\n\n    if (!mysql) {\n        puts(\"Init failed, out of memory?\");\n        return EXIT_FAILURE;\n    } else {\n        puts(\"SUCCESS!\\n\");\n    }\n\n    if (!mysql_real_connect(mysql,server,user,password,database,port,NULL,0)) {\n        puts(\"Connect failed\\n\");\n    }\n\n    return 1;\n}\n</code></pre>\n\n<p>So when I run it in Debug, it prints \"SUCCESS\" and nothing else. When I run it, it prints \"SUCCESS\" followed by \"Connect failed\". I am at a loss. Could this be a problem with the IDE? Is there another IDE for C that works well on Linux that I should consider? Or am I missing something quite obvious?</p>\n\n<p><strong>Update:</strong>\ncalling mysql_error() revealed</p>\n\n<blockquote>\n  <p>\"Can't connect to local MySQL server through socket '/tmp/mysql.sock'\n  (2)\"</p>\n</blockquote>\n"}, {"tags": ["c", "linux", "io-redirection"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1485962466, "post_id": 41972528, "comment_id": 71144352, "body": "&quot;I don&#39;t get the desired results&quot; is a very bad description of your trouble.  You should show what you get.  You should explain why it isn&#39;t what you think you should get.  You should give a clearer indication of what each of <code>process</code>, <code>procmon</code> and <code>filter</code> do.  Since they&#39;re all run from the current directory, they&#39;re custom programs available only on your machine."}, {"owner": {"reputation": 301, "user_id": 7173509, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a619feaba0eb4504fd0cc920cb1eb2?s=128&d=identicon&r=PG&f=1", "display_name": "gambit20088", "link": "https://stackoverflow.com/users/7173509/gambit20088"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1485962799, "post_id": 41972528, "comment_id": 71144599, "body": "You&#39;re right, sorry. I edited my question."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1485962980, "post_id": 41972528, "comment_id": 71144748, "body": "Is <code>filter</code> known to work?  Is <code>procmon</code> known to work?  I can&#39;t use <code>&#47;proc&#47;PID&#47;stat</code> because macOS Sierra doesn&#39;t have a <code>&#47;proc</code> file system, and I&#39;m not on my machine with a Linux VM available.  What is <code>filter</code> written in \u2014 C, Perl, shell, \u2026?  On the face of it, the problem is as likely to be in <code>filter</code> or perhaps <code>procmon</code> as in the program you showed.  What does <code>process</code> do, come to that?  Does it change state frequently enough?  Does <code>procmon</code> ensure that it flushes its output lines so that the data goes down the pipe properly?"}, {"owner": {"reputation": 301, "user_id": 7173509, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a619feaba0eb4504fd0cc920cb1eb2?s=128&d=identicon&r=PG&f=1", "display_name": "gambit20088", "link": "https://stackoverflow.com/users/7173509/gambit20088"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1485963707, "post_id": 41972528, "comment_id": 71145283, "body": "<code>procmon</code> is definitely known to work, not sure about <code>filter</code>. They are both written in C. I added a description of <code>process</code> in my question."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1485963886, "post_id": 41972528, "comment_id": 71145434, "body": "I strongly recommend concentrating on <code>filter</code>.  Drive it from the command line with <code>procmon</code>, using another terminal to run <code>process</code>.  I&#39;d even run <code>procmon</code> twice, once feeding to <code>filter</code> and once writing to the terminal (another one \u2014 three terminals available for inspection).  The driving program in the question seems to be &#39;OK&#39;, so the culprit is likely one of the others."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1486019101, "post_id": 41972528, "comment_id": 71168779, "body": "If you use <code>dup2</code> system call, you don&#39;t need to close the file descriptor in advance, as it will be closed by it.  Indeed, one could argue vaguely that it&#39;s better to not do it, as it is less error prone."}], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 7173509, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a619feaba0eb4504fd0cc920cb1eb2?s=128&d=identicon&r=PG&f=1", "display_name": "gambit20088", "link": "https://stackoverflow.com/users/7173509/gambit20088"}, "edited": false, "score": 0, "creation_date": 1485962898, "post_id": 41983294, "comment_id": 71144690, "body": "I edited my question with more explanation regarding what i expect from my program."}, {"owner": {"reputation": 301, "user_id": 7173509, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a619feaba0eb4504fd0cc920cb1eb2?s=128&d=identicon&r=PG&f=1", "display_name": "gambit20088", "link": "https://stackoverflow.com/users/7173509/gambit20088"}, "edited": false, "score": 0, "creation_date": 1485963865, "post_id": 41983294, "comment_id": 71145412, "body": "Given my edits and your test, i assume that if it still doesn&#39;t work for me there&#39;s probably a problem with <code>procmon</code> or <code>filter</code>? Given what <code>filter</code> does, how can i test it &quot;individually&quot;?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 301, "user_id": 7173509, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a619feaba0eb4504fd0cc920cb1eb2?s=128&d=identicon&r=PG&f=1", "display_name": "gambit20088", "link": "https://stackoverflow.com/users/7173509/gambit20088"}, "edited": false, "score": 0, "creation_date": 1485964022, "post_id": 41983294, "comment_id": 71145558, "body": "I&#39;ve added suggestions for &#39;how to test (<code>filter</code> in particular, also <code>procmon</code>)&#39; underneath the main question.  One of the reasons I used the test programs I chose is because I know they work reliably.  You should aim to minimize the number of &#39;unknowns&#39; you&#39;re dealing with."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 3, "last_activity_date": 1485963212, "last_edit_date": 1485963212, "creation_date": 1485962354, "answer_id": 41983294, "question_id": 41972528, "link": "https://stackoverflow.com/questions/41972528/c-linux-having-trouble-with-redirecting-stdin-and-stout/41983294#41983294", "title": "C/Linux - having trouble with redirecting stdin and stout", "body": "<p>\"Don't get the desired results\" is not a good description of the problem you are facing.</p>\n\n<p>On the whole, the code is not bad.  I've made some significant changes and a load of insignificant ones (moving variable declarations, initializing variables instead of assigning them, formatting).  The significant changes include:</p>\n\n<ul>\n<li>Checking that the program is called with an argument.</li>\n<li>Not creating the pipe until after the first child is created.</li>\n<li>Reporting errors and exiting if the <code>execv()</code> fails.</li>\n<li>Not redirecting standard error of the <code>procmon</code> process to the pipe.</li>\n</ul>\n\n<p>The pipe creation might be important.  As originally written, the <code>process</code> had both ends of the pipe open, so <code>filter</code> would not get EOF on the pipe while <code>process</code> continued.  Since <code>process</code> is unlikely to use the pipe (it has no formal knowledge of which file descriptors are open for them), there really is no point and could be some harm in keeping the pipe open.</p>\n\n<p>Not redirecting standard error to the pipe allowed me to see an error message from not having a shebang in the test scripts I used.</p>\n\n<p>I used a set of functions from <code>stderr.h</code> and <code>stderr.c</code>, which are available on GitHub at <a href=\"https://github.com/jleffler/soq/tree/master/src/libsoq\" rel=\"nofollow noreferrer\">https://github.com/jleffler/soq/tree/master/src/libsoq</a>.  They simplify error reporting, so most of my programs use them.</p>\n\n<p>This leads to the following code, which is recognizably similar to what you have:</p>\n\n<pre><code>#include \"stderr.h\"\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(int argc, char **argv)\n{\n    err_setarg0(argv[0]);\n    if (argc != 2)\n        err_usage(\"program\");\n\n    pid_t pid = fork();\n    if (pid &lt; 0)\n        err_syserr(\"failed to fork\");\n    else if (pid == 0)\n    {\n        char stringa[1000] = \"\";\n        char    *program = argv[1];\n        sprintf(stringa, \"./%s\", program);\n        char *args[] = {stringa, NULL};\n        execv(args[0], args);\n        err_syserr(\"failed to execute '%s': \", args[0]);\n    }\n    else\n    {\n        int pipefd[2];\n        pipe(pipefd);\n\n        pid_t pid2 = fork();\n        if (pid2 &lt; 0)\n            err_syserr(\"failed to fork\");\n        else if (pid2 == 0)    // launch procmon\n        {\n            int num = pid;\n            char snum[10];\n            sprintf(snum, \"%d\", num);\n            char procmon_str[] = \"./procmon\";\n            char *args2[] = {procmon_str, snum, NULL};\n\n            close(pipefd[0]); // close reading end in the child\n            dup2(pipefd[1], 1); // send stdout to the pipe\n            //dup2(pipefd[1], 2); // send stderr to the pipe\n            close(pipefd[1]); // this descriptor is no longer needed\n            execv(args2[0], args2);\n            err_syserr(\"failed to execute '%s': \", args2[0]);\n        }\n        else\n        {\n            close(pipefd[1]);\n            dup2(pipefd[0], STDIN_FILENO);\n            close(pipefd[0]);\n            char *args3[] = {\"./filter\", NULL};\n            execv(args3[0], args3);\n            err_syserr(\"failed to execute '%s': \", args3[0]);\n        }\n    }\n    /*NOTREACHED*/\n    return 0;\n}\n</code></pre>\n\n<p>I was then faced with the problem of testing this.  I created three shell scripts \u2014 <code>process</code>, <code>procmon</code> and <code>filter</code>.  It seems that it is not critical what <code>process</code> does as long as it takes some time doing it.  The <code>procmon</code> is probably meant to monitor a process's status; it can't be a standard program because you run it in the current directory.  Similarly, <code>filter</code> is presumably meant to modify what it reads from its input.  So, I invented scripts to do those jobs:</p>\n\n<p><strong>process</strong></p>\n\n<pre><code>#!/bin/sh\nexec timeout -t 2m -- dribbler -m \"$0: PID $$\" -r 0.2 -s 0.5 -t\n</code></pre>\n\n<p><strong>procmon</strong></p>\n\n<pre><code>#!/bin/sh\nexec timeout -t 2m -- dribbler -m \"$0: PID $1\" -r 0.3 -t\n</code></pre>\n\n<p><strong>filter</strong></p>\n\n<pre><code>#!/bin/sh\necho \"$0 at work\"\nexec grep -e '^[0-9]*9[0-9]*:' -- -\n</code></pre>\n\n<p>The <code>dribbler</code> program is a home-brew that writes information slowly, and the <code>timeout</code> program (also home-brew, with versions back to 1989, rather than the GNU program of the same name) stops its process after a designated time.  The <code>-r</code> and <code>-s</code> options to <code>dribbler</code> implement a Gaussian time distribution (<code>-s</code> the mean sleep time, defaulting to one second, <code>-r</code> the standard deviation of the randomness).  The <code>filter</code> script announces that it is busy and then looks for 9s in the first field of the output.</p>\n\n<p>With that infrastructure, I got output like:</p>\n\n<pre><code>$ pp37 process\n./filter at work\n0: ./process: PID 48812\n1: ./process: PID 48812\n2: ./process: PID 48812\n\u2026\n9: ./process: PID 48812\n10: ./process: PID 48812\n\u2026\n20: ./process: PID 48812\n21: ./process: PID 48812\n9: ./procmon: PID 48812\n22: ./process: PID 48812\n23: ./process: PID 48812\n\u2026\n92: ./process: PID 48812\n93: ./process: PID 48812\n49: ./procmon: PID 48812\n94: ./process: PID 48812\n95: ./process: PID 48812\n96: ./process: PID 48812\n97: ./process: PID 48812\n98: ./process: PID 48812\n99: ./process: PID 48812\n100: ./process: PID 48812\n101: ./process: PID 48812\n102: ./process: PID 48812\n\u2026\n116: ./process: PID 48812\n117: ./process: PID 48812\n59: ./procmon: PID 48812\n118: ./process: PID 48812\n119: ./process: PID 48812\n\u2026\n140: ./process: PID 48812\n69: ./procmon: PID 48812\n141: ./process: PID 48812\n\u2026\n161: ./process: PID 48812\n162: ./process: PID 48812\n79: ./procmon: PID 48812\n163: ./process: PID 48812\n\u2026\n179: ./process: PID 48812\n180: ./process: PID 48812\n89: ./procmon: PID 48812\n181: ./process: PID 48812\n182: ./process: PID 48812\n90: ./procmon: PID 48812\n183: ./process: PID 48812\n91: ./procmon: PID 48812\n184: ./process: PID 48812\n185: ./process: PID 48812\n186: ./process: PID 48812\n92: ./procmon: PID 48812\n187: ./process: PID 48812\n188: ./process: PID 48812\n93: ./procmon: PID 48812\n189: ./process: PID 48812\n94: ./procmon: PID 48812\n190: ./process: PID 48812\n191: ./process: PID 48812\n95: ./procmon: PID 48812\n192: ./process: PID 48812\n193: ./process: PID 48812\n96: ./procmon: PID 48812\n194: ./process: PID 48812\n195: ./process: PID 48812\n196: ./process: PID 48812\n97: ./procmon: PID 48812\n197: ./process: PID 48812\n98: ./procmon: PID 48812\n198: ./process: PID 48812\n199: ./process: PID 48812\n200: ./process: PID 48812\n201: ./process: PID 48812\n99: ./procmon: PID 48812\n202: ./process: PID 48812\n\u2026\n220: ./process: PID 48812\n109: ./procmon: PID 48812\n221: ./process: PID 48812\n\u2026\n234: ./process: PID 48812\n235: ./process: PID 48812\n$\n</code></pre>\n\n<p>The output of <code>process</code> is not filtered so every line of that is shown, but the output of <code>procmon</code> is filtered and only lines with a <code>9</code> are shown.  This seems to be behaving correctly.</p>\n"}], "owner": {"reputation": 301, "user_id": 7173509, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a619feaba0eb4504fd0cc920cb1eb2?s=128&d=identicon&r=PG&f=1", "display_name": "gambit20088", "link": "https://stackoverflow.com/users/7173509/gambit20088"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 334, "favorite_count": 0, "accepted_answer_id": 41983294, "answer_count": 1, "score": 1, "last_activity_date": 1485963753, "creation_date": 1485926982, "last_edit_date": 1485963753, "question_id": 41972528, "link": "https://stackoverflow.com/questions/41972528/c-linux-having-trouble-with-redirecting-stdin-and-stout", "title": "C/Linux - having trouble with redirecting stdin and stout", "body": "<p>I have the following program:</p>\n\n<pre><code>int main(int argc, char **argv)\n{\n    char    *program;\n    char     stringa[1000] = \"\";\n    int num = 0;\n    char snum[10];\n    int pipefd[2];\n    pipe(pipefd);\n    program = argv[1];   \n\n    sprintf(stringa, \"./%s\", program);\n\n    pid_t pid = fork();\n    if (pid &lt; 0 ) {\n        perror(\"fork failed.\"); \n        exit(1);\n    }\n    else if (pid == 0) { \n        char* args[] = {stringa, NULL};\n        execv(args[0], args);\n    }\n    else {   \n       char procmon_str[] = \"./procmon\";\n       num = pid;\n       sprintf(snum, \"%d\",num);\n\n       pid_t pid2 = fork();\n       if (pid2 == 0) { //launch procmon\n           char* args2[] = {procmon_str, snum, NULL};\n\n           close(pipefd[0]); //close reading end in the child\n           dup2(pipefd[1], 1); //send stdout to the pipe\n           dup2(pipefd[1], 2); //send stderr to the pipe\n           close(pipefd[1]); //this descriptor is no longer needed\n\n           execv(args2[0], args2);\n       }\n       else { \n           close(pipefd[1]);\n           dup2(pipefd[0], STDIN_FILENO);\n           close(pipefd[0]);\n           char* args3[] = {\"./filter\", NULL};\n           execv(args3[0], args3);    \n       }\n    }\n\n   return 0;\n}\n</code></pre>\n\n<p>I launch it like so:</p>\n\n<pre><code>./myProgram process\n</code></pre>\n\n<p>Then, the following happens:</p>\n\n<ul>\n<li><code>myProgram</code> launches <code>process</code> and determines its <code>PID</code></li>\n<li>It then launches the <code>procmon</code> program with that same <code>PID</code></li>\n<li>It will launch another process that runs the program <code>filter</code></li>\n</ul>\n\n<p>The output of <code>procmon</code> should be sent to the input of <code>filter</code>, meaning - <code>filter</code> will read from its standard input what <code>procmon</code> is writing to its standard output.</p>\n\n<p>For some reason, i don't get the desired results.</p>\n\n<p><code>procmon</code>s job is to take a given process's PID, access the corresponding <code>/proc/PID/stat</code> file and print the process state.\n<code>filter</code> needs to take that and only prints the line where the state changes from one to another. At the moment, i don't get anything from <code>filter</code>.</p>\n\n<p><code>process</code> goes into a loop (10 iterations) that sleeps for 3 seconds, and then starts another loop that increments a variable 400,000 times. </p>\n\n<p>Am i doing it right?</p>\n"}, {"tags": ["c", "performance", "sse", "avx", "avx2"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 2, "creation_date": 1485935369, "post_id": 41972223, "comment_id": 71126765, "body": "I don&#39;t think anyone can help much without some sort of <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 12209, "user_id": 4926757, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-jsLBa8e0dT0/AAAAAAAAAAI/AAAAAAAAAEc/YqNqYlsSjrU/photo.jpg?sz=128", "display_name": "Rotem", "link": "https://stackoverflow.com/users/4926757/rotem"}, "edited": false, "score": 0, "creation_date": 1485958915, "post_id": 41972223, "comment_id": 71141841, "body": "Could be result of Thread Migration, CPU Thermal Throttle, other processes running on background evicting cache (and other reasons I can&#39;t think of)..."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1486043874, "post_id": 41972223, "comment_id": 71184178, "body": "Any weird values, such as denormals?"}], "answers": [{"comments": [{"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1486155638, "post_id": 42032924, "comment_id": 71240384, "body": "Fair enough, I just thought you might be testing random values that changed every time or something like that."}], "tags": [], "owner": {"reputation": 41, "user_id": 6268764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0f798d6ce8c3d3a14d248f1d61890eb?s=128&d=identicon&r=PG&f=1", "display_name": "PineTree", "link": "https://stackoverflow.com/users/6268764/pinetree"}, "is_accepted": false, "score": 0, "last_activity_date": 1486155514, "creation_date": 1486155514, "answer_id": 42032924, "question_id": 41972223, "link": "https://stackoverflow.com/questions/41972223/reason-for-random-slowdown-in-vectorized-code/42032924#42032924", "title": "Reason for random slowdown in vectorized code", "body": "<p>@Paul R Sorry for the question being a bit vague.</p>\n\n<p>@Rotem I think the reason is eviction of cache.</p>\n\n<p>@Harold it cannot be related to denormals because everytime I get the same result and if it was affected by denormals it would affect the process everytime. </p>\n\n<p>I probably found the answer to the question but I am not able to verify it right now. I will post the test results as soon as I can. </p>\n\n<p>What I did in my function was, to reduce array indexing and maximize the use of registers , I put some data from arrays into variables. </p>\n\n<p>For example I want to access Darray[0], Darray[1] ...... Darray[6]; </p>\n\n<p>In the start of the looop I used the code </p>\n\n<p>__m256 D0 = Darray[0];\n  __m256 D1 = Darray[1]; </p>\n\n<p>and so on. Most of the time the compiler generates assembly code where the variables are put into registers and the registers are used but in this case the register pressure was too high and they were not put into registers and instead put into different memory locations. I printed out the address of D0 and the difference in address with the other variables D1 , D2 .... etc </p>\n\n<p>This is the result that I got  (the first number is the address of D0 and the next ones are the offsets from it):</p>\n\n<p>280449315232  -704  -768  -640  -736  -608</p>\n\n<p>Even though I access the variables in my code sequentially, sometimes they are quite far apart.</p>\n\n<p>This is the result of another array (this one is the most surprising)</p>\n\n<p>280449314144  416  512</p>\n\n<p>Another one:</p>\n\n<p>812970176  128  192  256  224  160  1152</p>\n\n<p>Thus when I access one variable it is unlikely I will bring the other one in the cache. But with one iteration of the loop I might bring all the variables in the cache but some other program has the ability to remove them from the cache anytime. If I used an array, even if the variables I fetched into cache  could get removed from the cache, I would end up bringing some elements to the cache when I access other elements. </p>\n\n<p>I will use arrays again for most of the data and try to fit the rest in registers. I will benchmark and report my findings in this post. </p>\n\n<p>Thank you.</p>\n"}], "owner": {"reputation": 41, "user_id": 6268764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0f798d6ce8c3d3a14d248f1d61890eb?s=128&d=identicon&r=PG&f=1", "display_name": "PineTree", "link": "https://stackoverflow.com/users/6268764/pinetree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 245, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1486155514, "creation_date": 1485925299, "last_edit_date": 1485927737, "question_id": 41972223, "link": "https://stackoverflow.com/questions/41972223/reason-for-random-slowdown-in-vectorized-code", "title": "Reason for random slowdown in vectorized code", "body": "<p>I wrote a particular function in a project using AVX2, AVX and SSE compiler intrinsics. I am aware of the penalty when the CPU changes states between AVX/AVX2 and SSE modes so I set the Enhanced Instruction Set to AVX2 in Visual Studio project settings. </p>\n\n<p>In my code I repeatedly use some data in a for loop. The structure of my code is mostly like what is shown below:</p>\n\n<pre><code>//I gather the data that I am going to access again and again and put them \n\n//into variables so that I use minimal array indexing\n\n\n__m256 a = (code to get a) \n\n__m256 b = (code to get b)\n\n.........\n\nfor(int i =0; i &lt; large number; i++)\n{\n\n    c = arrayofc[i];\n\n    //operate with a and b and other variables gathered outside the loop.\n\n    d+= result of operations;\n\n} \n</code></pre>\n\n<p>The problem that I am facing is, this function performs really well but at certain runs of the program it slows down by a factor of 10 to 15, whereas other functions in the same program slow down by a factor of at most 2. </p>\n\n<p>I used boost timers to measure performance, Visual Studio performance profiler and also GPU view. All indicate that at certain runs of my program this function performs horribly slow. My program does not give random results; every time it gives identical results. </p>\n\n<p>GPUview did not show any other thread interfering with this function either.</p>\n\n<p>For once I thought that given I cache my variables, and inside the loop it is just floating point vectorized operations, the Intel Speed Step which was turned on slowed down this function specifically as this function is likely to be more CPU dependent than other functions which are probably more Memory dependent. But my guess turned out to be wrong as I tested with Intel Speed Step disabled and still had the same issue. </p>\n\n<p>I used software prefetch to cache the variable I gather outside the loop too but without benefit.</p>\n\n<p>I am still not sure if it could be caused by virtualization or not. The task manager of the computer I am working on shows CPU utilization is very small ( 1-5 %). Memory utilization is around 40% and sometimes disk utilization is around 100%</p>\n\n<p>Any help regarding this issue will be greatly appreciated. </p>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 894, "user_id": 2051159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a84ff255bf4e6c07b816d83001f7fb30?s=128&d=identicon&r=PG", "display_name": "Enfyve", "link": "https://stackoverflow.com/users/2051159/enfyve"}, "edited": false, "score": 1, "creation_date": 1485925326, "post_id": 41972208, "comment_id": 71122680, "body": "<code>i &lt; 10, i++)</code> the comma should be a semicolon."}], "answers": [{"tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1485925436, "creation_date": 1485925436, "answer_id": 41972241, "question_id": 41972208, "link": "https://stackoverflow.com/questions/41972208/cs50-assignment-issue-expected-identifier-or/41972241#41972241", "title": "CS50 Assignment Issue; expected identifier or &#39;(&#39;", "body": "<p>If that's your <em>entire</em> file, I think you'll find that the code has to go inside a function of some description, probably <code>main</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void) {    \n    for (int i = 0; i &lt; 10; i++) {\n        printf (\"test this\\n\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>You'll see a couple of other changes I've made which should make it \"better\":</p>\n\n<ul>\n<li>Repairing the <code>for</code> loop by replacing the comma with a semicolon.</li>\n<li>Adding a newline to the output string.</li>\n<li>Removing unnecessary headers (at least for <em>this</em> bit of code).</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 7498595, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9f5b131fc649681f1bdccd96e1ad88a6?s=128&d=identicon&r=PG&f=1", "display_name": "rookie", "link": "https://stackoverflow.com/users/7498595/rookie"}, "is_accepted": false, "score": 0, "last_activity_date": 1485926376, "creation_date": 1485926376, "answer_id": 41972400, "question_id": 41972208, "link": "https://stackoverflow.com/questions/41972208/cs50-assignment-issue-expected-identifier-or/41972400#41972400", "title": "CS50 Assignment Issue; expected identifier or &#39;(&#39;", "body": "<p>Thank you - I needed to encase the loop in a function, and had the syntax error in the loop itself (a comma instead of a semi colon).</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 8096050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KWJVH.jpg?s=128&g=1", "display_name": "spacexengineer", "link": "https://stackoverflow.com/users/8096050/spacexengineer"}, "is_accepted": false, "score": 0, "last_activity_date": 1498872523, "creation_date": 1498872523, "answer_id": 44856590, "question_id": 41972208, "link": "https://stackoverflow.com/questions/41972208/cs50-assignment-issue-expected-identifier-or/44856590#44856590", "title": "CS50 Assignment Issue; expected identifier or &#39;(&#39;", "body": "<p>As mentioned before, C syntax requires semi-colons in for loops. Your for should be:</p>\n\n<p>for (int i = 0; i &lt; 10; i++)</p>\n"}, {"tags": [], "owner": {"reputation": 145, "user_id": 14082778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DA3rn.jpg?s=128&g=1", "display_name": "Lost in code", "link": "https://stackoverflow.com/users/14082778/lost-in-code"}, "is_accepted": false, "score": 0, "last_activity_date": 1597169791, "creation_date": 1597169791, "answer_id": 63364117, "question_id": 41972208, "link": "https://stackoverflow.com/questions/41972208/cs50-assignment-issue-expected-identifier-or/63364117#63364117", "title": "CS50 Assignment Issue; expected identifier or &#39;(&#39;", "body": "<p>In for loops like this one, you need to use semicolons not commas. I has to be this:</p>\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n\nfor (int i = 0; i &lt; 10; i++)\n{\nprintf(&quot;test this&quot;);\n}\n</code></pre>\n<p>Not this:</p>\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n\nfor (int i = 0; i &lt; 10, i++)\n{\nprintf(&quot;test this&quot;);\n}\n</code></pre>\n<p>As you can see, you have to use semicolons not commas after the</p>\n<pre class=\"lang-c prettyprint-override\"><code>i &lt; 10\n</code></pre>\n<p>part.</p>\n"}], "owner": {"reputation": 3, "user_id": 7498595, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9f5b131fc649681f1bdccd96e1ad88a6?s=128&d=identicon&r=PG&f=1", "display_name": "rookie", "link": "https://stackoverflow.com/users/7498595/rookie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 4, "score": -2, "last_activity_date": 1603952389, "creation_date": 1485925210, "last_edit_date": 1603952389, "question_id": 41972208, "link": "https://stackoverflow.com/questions/41972208/cs50-assignment-issue-expected-identifier-or", "title": "CS50 Assignment Issue; expected identifier or &#39;(&#39;", "body": "<p>I am copying and pasting this example code into the CS50 IDE,</p>\n<p>file name test.c:</p>\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n\nfor (int i = 0; i &lt; 10, i++)\n{\nprintf(&quot;test this&quot;);\n}\n</code></pre>\n<p>I am getting the following error when I try to compile:</p>\n<pre><code>   ~/workspace/pset1/ $ make test\n\nclang -fsanitize=integer -fsanitize=undefined -ggdb3 -O0 -std=c11 -Wall -Werror -Wextra -Wno-sign-compare -Wshadow    test.c  -lcrypt -lcs50 -lm -o test\ntest.c:4:1: error: expected identifier or '('\n\n\nfor (int i = 0; i &lt; 10, i++)\n\n^\n1 error generated.\nmake: *** [test] Error 1\n</code></pre>\n<p>I have looked and all answers I found contained syntax errors, but I have been copying / pasting example code after hitting this wall.</p>\n"}, {"tags": ["c", "windows", "cygwin"], "owner": {"reputation": 111, "user_id": 4006798, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/OdYG8.jpg?s=128&g=1", "display_name": "Jahir CU", "link": "https://stackoverflow.com/users/4006798/jahir-cu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 524, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1485954232, "creation_date": 1485924942, "question_id": 41972159, "link": "https://stackoverflow.com/questions/41972159/install-and-run-testu01-testing-random-number-generators-on-windows-by-cygwin", "title": "Install and run TestU01: Testing Random Number Generators on windows by cygwin", "body": "<p>I installed Cygwin on my windows 10. I need to run TestU01(Testing Random Number Generators). I already followed the instruction from <a href=\"http://simul.iro.umontreal.ca/testu01/install.html\" rel=\"nofollow noreferrer\">Test01 installation guide</a>. But I can't run the programs from the example directory and I got a <strong>fatal error:'unif01.h: No such file or directory compilation terminated</strong> when running  </p>\n\n<blockquote>\n  <p>gcc birth1.c -o birth1 -ltestu01 -lprobdist -lmylib -lm</p>\n</blockquote>\n\n<p>. Please help me to run an example on windows by using Cygwin.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1104, "user_id": 6296060, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZ37JUkP1Pw/AAAAAAAAAAI/AAAAAAAAAYw/Fp6BfZuv7Ho/photo.jpg?sz=128", "display_name": "greedy52", "link": "https://stackoverflow.com/users/6296060/greedy52"}, "edited": false, "score": 0, "creation_date": 1485923673, "post_id": 41971937, "comment_id": 71122152, "body": "Is <code>switch</code> allowed? It just does normal comparison internally though."}, {"owner": {"reputation": 932, "user_id": 5696201, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53ad9765833b4f98069186ef4a1c2bac?s=128&d=identicon&r=PG&f=1", "display_name": "Logan", "link": "https://stackoverflow.com/users/5696201/logan"}, "reply_to_user": {"reputation": 1104, "user_id": 6296060, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZ37JUkP1Pw/AAAAAAAAAAI/AAAAAAAAAYw/Fp6BfZuv7Ho/photo.jpg?sz=128", "display_name": "greedy52", "link": "https://stackoverflow.com/users/6296060/greedy52"}, "edited": false, "score": 0, "creation_date": 1485923710, "post_id": 41971937, "comment_id": 71122164, "body": "Sadly not! I&#39;m so used to using <code>if</code> and <code>switch</code> statements."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1485923817, "post_id": 41971937, "comment_id": 71122204, "body": "How about an array of function pointers?"}, {"owner": {"reputation": 932, "user_id": 5696201, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53ad9765833b4f98069186ef4a1c2bac?s=128&d=identicon&r=PG&f=1", "display_name": "Logan", "link": "https://stackoverflow.com/users/5696201/logan"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1485923913, "post_id": 41971937, "comment_id": 71122228, "body": "@dbush not that either. It&#39;s really quite intriguing. We can only use +, -, *, /, and %. As well as simple variables."}, {"owner": {"reputation": 1104, "user_id": 6296060, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZ37JUkP1Pw/AAAAAAAAAAI/AAAAAAAAAYw/Fp6BfZuv7Ho/photo.jpg?sz=128", "display_name": "greedy52", "link": "https://stackoverflow.com/users/6296060/greedy52"}, "edited": false, "score": 0, "creation_date": 1485925829, "post_id": 41971937, "comment_id": 71122824, "body": "Is this true: &quot;net force = gravity + drag&quot;? If so, see my answer below."}], "answers": [{"tags": [], "owner": {"reputation": 1104, "user_id": 6296060, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZ37JUkP1Pw/AAAAAAAAAAI/AAAAAAAAAYw/Fp6BfZuv7Ho/photo.jpg?sz=128", "display_name": "greedy52", "link": "https://stackoverflow.com/users/6296060/greedy52"}, "is_accepted": true, "score": 1, "last_activity_date": 1485925197, "last_edit_date": 1485925197, "creation_date": 1485924788, "answer_id": 41972146, "question_id": 41971937, "link": "https://stackoverflow.com/questions/41971937/determine-a-menu-choice-without-using-logical-operators-relational-operators-o/41972146#41972146", "title": "Determine a menu choice without using logical operators, relational operators, or selection constructs", "body": "<p>I assume net force = gravity + drag, and input is one of 1, 2, or 3.</p>\n\n<pre><code>net_force = gravity + drag\nresult = (2 - choice) * gravity + net_force + (choice - 2) * drag\nresult = result / (choice % 2 + 1)\n</code></pre>\n\n<ul>\n<li>choice = 1 => (gravity + gravity + drag - drag) / (2) => gravity</li>\n<li>choice = 2 => (net_force) / (1) => net_force</li>\n<li>choice = 3 => (-gravity + gravity + drag + drag) / (2) => drag</li>\n</ul>\n\n<p>All of <code>+-*/%</code> are used .</p>\n"}, {"tags": [], "owner": {"reputation": 949, "user_id": 3740885, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LOyZ7.jpg?s=128&g=1", "display_name": "Mirwise Khan", "link": "https://stackoverflow.com/users/3740885/mirwise-khan"}, "is_accepted": false, "score": 0, "last_activity_date": 1485925887, "last_edit_date": 1495542812, "creation_date": 1485925552, "answer_id": 41972256, "question_id": 41971937, "link": "https://stackoverflow.com/questions/41971937/determine-a-menu-choice-without-using-logical-operators-relational-operators-o/41972256#41972256", "title": "Determine a menu choice without using logical operators, relational operators, or selection constructs", "body": "<p>Well use String to take input and compare them using <code>strcmp</code> function <a href=\"https://stackoverflow.com/questions/8004237/how-do-i-properly-compare-strings-in-c\">Here is how to compare strings in C</a></p>\n\n<p><strong>Note : I'm using if/else but not using any logical operator, hope this helps</strong></p>\n\n<pre><code>// Take string input\nif(strcmp(\"1\",input))\n     // Calculate with just gravity\nelse if(strcmp(\"2\",input))\n     // Calculate with net force\nelse if(strcmp(\"3\",input))\n     // Calculate with just drag\n</code></pre>\n"}], "owner": {"reputation": 932, "user_id": 5696201, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53ad9765833b4f98069186ef4a1c2bac?s=128&d=identicon&r=PG&f=1", "display_name": "Logan", "link": "https://stackoverflow.com/users/5696201/logan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "accepted_answer_id": 41972146, "answer_count": 2, "score": 0, "last_activity_date": 1485925887, "creation_date": 1485923468, "last_edit_date": 1485924995, "question_id": 41971937, "link": "https://stackoverflow.com/questions/41971937/determine-a-menu-choice-without-using-logical-operators-relational-operators-o", "title": "Determine a menu choice without using logical operators, relational operators, or selection constructs", "body": "<p>I am working on a program for one of my classes, and it contains a simple menu like this:</p>\n\n<pre><code>Please choose an option below:\n--------------------------------\n1) Calculate with just gravity\n2) Calculate with net force\n3) Calculate with just drag\n</code></pre>\n\n<p>Now, usually it would be quite simple to determine what the menu choice is, but we are not allowed to use logical operators, relational operators, or selection constructs. I've been trying to use modulus, but to no avail. Is this even possible? We essentially can only use +, -, *, /, and %. As well as simple variables. Thank you!</p>\n"}, {"tags": ["c", "pointers", "sizeof"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 3, "creation_date": 1485923231, "post_id": 41971837, "comment_id": 71122004, "body": "The first snippet is correct, the second snippet is not, and the third snippet is not. The sizes of <code>double*</code> and <code>double**</code> are not guaranteed to be the same in C (even though they usually are the same) and it\u2019s confusing to use the wrong type in <code>sizeof</code> anyway."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1485923269, "post_id": 41971837, "comment_id": 71122019, "body": "The argument about not having to count stars doesn\u2019t hold much weight, either, because if you\u2019re going beyond <code>**</code> too often you\u2019re probably doing something wrong."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1485923526, "post_id": 41971837, "comment_id": 71122091, "body": "Also <code>i &lt; size_y;</code> --&gt; <code>i &lt; N;</code> or <code>x = malloc(N * sizeof(*x));</code> --&gt; <code>x = malloc(size_y * sizeof(*x));</code>"}, {"owner": {"reputation": 49, "user_id": 1773603, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh6.googleusercontent.com/-UZXqQyyTv38/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmjtkpUxrj9UY16bqdK3OfqQoGwmw/photo.jpg?sz=128", "display_name": "youpilat13", "link": "https://stackoverflow.com/users/1773603/youpilat13"}, "edited": false, "score": 0, "creation_date": 1485923632, "post_id": 41971837, "comment_id": 71122135, "body": "ok thanks. and what about the right syntax for the second snippet ?"}, {"owner": {"reputation": 49, "user_id": 1773603, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh6.googleusercontent.com/-UZXqQyyTv38/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmjtkpUxrj9UY16bqdK3OfqQoGwmw/photo.jpg?sz=128", "display_name": "youpilat13", "link": "https://stackoverflow.com/users/1773603/youpilat13"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1485924229, "post_id": 41971837, "comment_id": 71122318, "body": "@Ryan, so the fourth sinppet is right compared to the second one ?"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1485924738, "post_id": 41971837, "comment_id": 71122491, "body": "@youpilat13: Yes."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 1773603, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh6.googleusercontent.com/-UZXqQyyTv38/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmjtkpUxrj9UY16bqdK3OfqQoGwmw/photo.jpg?sz=128", "display_name": "youpilat13", "link": "https://stackoverflow.com/users/1773603/youpilat13"}, "edited": false, "score": 0, "creation_date": 1490757996, "post_id": 41971944, "comment_id": 73250150, "body": "M.M: could you see my remark into my <b>UPDATE 1</b>, this is for a confirmation, thanks"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 49, "user_id": 1773603, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh6.googleusercontent.com/-UZXqQyyTv38/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmjtkpUxrj9UY16bqdK3OfqQoGwmw/photo.jpg?sz=128", "display_name": "youpilat13", "link": "https://stackoverflow.com/users/1773603/youpilat13"}, "edited": false, "score": 0, "creation_date": 1490758492, "post_id": 41971944, "comment_id": 73250291, "body": "@youpilat13 whitespace does not matter and parentheses are optional"}, {"owner": {"reputation": 49, "user_id": 1773603, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh6.googleusercontent.com/-UZXqQyyTv38/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmjtkpUxrj9UY16bqdK3OfqQoGwmw/photo.jpg?sz=128", "display_name": "youpilat13", "link": "https://stackoverflow.com/users/1773603/youpilat13"}, "edited": false, "score": 0, "creation_date": 1490759025, "post_id": 41971944, "comment_id": 73250450, "body": "thanks, so you valid my snippet code into <b>UPDATE 1</b> ?"}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1485923516, "creation_date": 1485923516, "answer_id": 41971944, "question_id": 41971837, "link": "https://stackoverflow.com/questions/41971837/right-syntax-for-allocation/41971944#41971944", "title": "Right syntax for allocation", "body": "<p>The pattern is:</p>\n\n<pre><code>p = malloc(N * sizeof *p);\n</code></pre>\n\n<p>Replace <code>p</code> with the same thing in both cases.  For example:</p>\n\n<pre><code>x[i] = malloc(N * sizeof *x[i]);\n</code></pre>\n\n<p>Sometimes people abbreviate <code>*x[i]</code> to <code>**x</code> using the knowledge that <code>**x</code> means <code>*x[0]</code>,  and <code>x[0]</code> and <code>x[i]</code> have the same size because all elements of an array must have the same type and therefore the same size.</p>\n\n<p>But if you are not confident about all this then you can stick to the basic pattern and use <code>*x[i]</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 5281071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7afc0bb8cff23464fba11d73df444435?s=128&d=identicon&r=PG&f=1", "display_name": "Salah Uddin", "link": "https://stackoverflow.com/users/5281071/salah-uddin"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1485943227, "post_id": 41973255, "comment_id": 71131277, "body": "d3 holds 3rd reference address. Is the number of bytes not equal for any type of address?"}, {"owner": {"reputation": 23, "user_id": 5281071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7afc0bb8cff23464fba11d73df444435?s=128&d=identicon&r=PG&f=1", "display_name": "Salah Uddin", "link": "https://stackoverflow.com/users/5281071/salah-uddin"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1485943776, "post_id": 41973255, "comment_id": 71131638, "body": "could you pls explain, why can&#39;t I use <code>double *</code> to get size of address."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1485945461, "post_id": 41973255, "comment_id": 71132819, "body": "The outermost array has elements of type <code>double **</code>. When allocating space for an array of <code>T</code>&#39;s you should use <code>sizeof(T)</code> to get the size of each element.  Having <code>T</code> = <code>double **</code> is not a special case."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1485981971, "post_id": 41973255, "comment_id": 71156112, "body": "well you aren&#39;t. The type you specify in <code>sizeof</code> should be the same type as what you are actually allocating for, but your code uses a different type"}, {"owner": {"reputation": 23, "user_id": 5281071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7afc0bb8cff23464fba11d73df444435?s=128&d=identicon&r=PG&f=1", "display_name": "Salah Uddin", "link": "https://stackoverflow.com/users/5281071/salah-uddin"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1486185569, "post_id": 41973255, "comment_id": 71247617, "body": "malloc will allocate number of bytes what I&#39;ve specified. Where number of bytes for address will be same for any type. Then I&#39;ve casted the size of bytes to my needed type."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1486185596, "post_id": 41973255, "comment_id": 71247625, "body": "different pointer types may have different sizes, e.g. <code>char *</code> could be 5 bytes and <code>char **</code> could be 4 bytes"}, {"owner": {"reputation": 23, "user_id": 5281071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7afc0bb8cff23464fba11d73df444435?s=128&d=identicon&r=PG&f=1", "display_name": "Salah Uddin", "link": "https://stackoverflow.com/users/5281071/salah-uddin"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1486189926, "post_id": 41973255, "comment_id": 71248468, "body": "In my machine, <code>char *</code>, <code>char **</code>, <code>float *</code>, <code>double *</code>, <code>int *</code> all takes 4 bytes."}, {"owner": {"reputation": 23, "user_id": 5281071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7afc0bb8cff23464fba11d73df444435?s=128&d=identicon&r=PG&f=1", "display_name": "Salah Uddin", "link": "https://stackoverflow.com/users/5281071/salah-uddin"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1486196273, "post_id": 41973255, "comment_id": 71249862, "body": "My version also works on all machines. The value could differ machine(32 bit operating system or windows or linux) to machine(64 bit operating machine or linux or windows) but should not in same machine."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1486197482, "post_id": 41973255, "comment_id": 71250164, "body": "yours would not work on a machine with <code>sizeof(double *) &lt; sizeof(double **)</code>"}, {"owner": {"reputation": 23, "user_id": 5281071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7afc0bb8cff23464fba11d73df444435?s=128&d=identicon&r=PG&f=1", "display_name": "Salah Uddin", "link": "https://stackoverflow.com/users/5281071/salah-uddin"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1486201298, "post_id": 41973255, "comment_id": 71251186, "body": "after crossing a desert you are telling me <code>sizeof(double *) &lt; sizeof(double **)</code> when I&#39;m telling you whole the way <code>sizeof(double *) == sizeof(double **)</code> in a same machine."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1486276379, "post_id": 41973255, "comment_id": 71271013, "body": "Yes, read the C Standard. It does not say that all pointers are the same size."}, {"owner": {"reputation": 49, "user_id": 1773603, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh6.googleusercontent.com/-UZXqQyyTv38/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmjtkpUxrj9UY16bqdK3OfqQoGwmw/photo.jpg?sz=128", "display_name": "youpilat13", "link": "https://stackoverflow.com/users/1773603/youpilat13"}, "edited": false, "score": 0, "creation_date": 1490758044, "post_id": 41973255, "comment_id": 73250161, "body": "Salah Uddin: could you see my remark into my <b>UPDATE 1</b>, this is for a confirmation, thanks"}], "tags": [], "owner": {"reputation": 23, "user_id": 5281071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7afc0bb8cff23464fba11d73df444435?s=128&d=identicon&r=PG&f=1", "display_name": "Salah Uddin", "link": "https://stackoverflow.com/users/5281071/salah-uddin"}, "is_accepted": false, "score": -1, "last_activity_date": 1485942441, "last_edit_date": 1485942441, "creation_date": 1485930508, "answer_id": 41973255, "question_id": 41971837, "link": "https://stackoverflow.com/questions/41971837/right-syntax-for-allocation/41973255#41973255", "title": "Right syntax for allocation", "body": "<p>There are 2 things, </p>\n\n<ul>\n<li>Pointer holds the address of allocated space and </li>\n<li>malloc() allocates the space what size is provided. so, <strong>malloc(1)</strong> will allocate 1 byte, <strong>malloc(sizeof(double))</strong> will allocate number of bytes(may be 8 bytes) that needs for double, <strong>malloc(sizeof(double *))</strong> will allocate number of bytes(may be 4 bytes) that needs for that address. </li>\n</ul>\n\n<p>So, \nFor 1st reference,</p>\n\n<pre><code>double *d1 = (double *) mallloc(sizeof(double)); // for single value\n</code></pre>\n\n<p>or,</p>\n\n<pre><code>double *d1 = (double *) malloc(N * sizeof(double));  // for array\n</code></pre>\n\n<p>Similiarly for 2nd referenece,</p>\n\n<pre><code>double **d2 = (double **) malloc(N * sizeof(double *));\n</code></pre>\n\n<p>And for 3rd reference,</p>\n\n<pre><code>double ***d3 = (double ***) malloc(N * sizeof(double *));\n</code></pre>\n\n<p>Now, we can consider, </p>\n\n<pre><code>void mallocTest()\n{\n    const int N = 10;\n    double ***x;\n\n    x = (double ***)malloc(N * sizeof(double *));\n    for (int i = 0; i &lt; N; i++) {\n        x[i] = (double **)malloc(N * sizeof(double *));\n        for (int j = 0; j &lt; N; j++) {\n            x[i][j] = (double *)malloc(sizeof(double));       // for single value;\n            //x[i][j] = (double *)malloc(N * sizeof(double));    // for array, here N == 10 elements\n\n            *x[i][j] = i*j;  // or\n            //x[i][j][0] = i*j;\n        }\n    }\n\n    for (int i = 0; i &lt; N; i++){\n        for (int j = 0; j &lt; N; j++){\n            //printf(\"%f \", *x[i][j]);     // or\n            printf(\"%f \", x[i][j][0]);\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 1773603, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh6.googleusercontent.com/-UZXqQyyTv38/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmjtkpUxrj9UY16bqdK3OfqQoGwmw/photo.jpg?sz=128", "display_name": "youpilat13", "link": "https://stackoverflow.com/users/1773603/youpilat13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 41971944, "answer_count": 2, "score": 0, "last_activity_date": 1490753361, "creation_date": 1485922836, "last_edit_date": 1495540925, "question_id": 41971837, "link": "https://stackoverflow.com/questions/41971837/right-syntax-for-allocation", "title": "Right syntax for allocation", "body": "<p>If I take the 2 following snipped codes below (which are equivalent) :</p>\n\n<pre><code>double ***x;\nx = malloc(N * sizeof(*x));\nfor (i = 0; i &lt; size_y; i++) {\n   x[i] = malloc(N * sizeof(**x));\n</code></pre>\n\n<p>and</p>\n\n<pre><code>double ***x;\nx = malloc(N * sizeof(double*));\nfor (i = 0; i &lt; size_y; i++) {\n   x[i] = malloc(N * sizeof(double**));\n</code></pre>\n\n<p>Does the syntax for the first one above should be rather :</p>\n\n<pre><code>double ***x;\nx = malloc(N * sizeof(*x));\nfor (i = 0; i &lt; size_y; i++) {\n   x[i] = malloc(N * sizeof(*x));\n</code></pre>\n\n<p>I mean, for <code>x</code>, <code>x[i]</code> and <code>x[i][j]</code> <code>malloc</code> allocation, syntax will stay \"<code>sizeof(*x)</code>\", is this right ?</p>\n\n<p>??</p>\n\n<p>and does the second one should be :</p>\n\n<pre><code>double ***x;\nx = malloc(N * sizeof(double**));\nfor (i = 0; i &lt; size_y; i++) {\n   x[i] = malloc(N * sizeof(double*));\n</code></pre>\n\n<p>??</p>\n\n<p>I saw this syntax from <a href=\"https://stackoverflow.com/questions/17258647/why-is-it-safer-to-use-sizeofpointer-in-malloc\">this link</a></p>\n\n<blockquote>\n  <p>It is safer becuse you don't have to mention the type name twice and\n  don't have to build the proper spelling for \"dereferenced\" version of\n  the type. For example, you don't have to \"count the stars\" in</p>\n  \n  <p>int *****p = malloc(100 * sizeof *p);</p>\n  \n  <p>Compare that to the type-based sizeof in</p>\n  \n  <p>int *****p = malloc(100 * sizeof(int ****));</p>\n  \n  <p>where you have too make sure you used the right number of * under\n  sizeof.</p>\n</blockquote>\n\n<p>regards</p>\n\n<p><strong>UPDATE 1 :</strong></p>\n\n<p>I have got in one answer below the syntax as a pattern :</p>\n\n<pre><code>p = malloc(N * sizeof *p);\n</code></pre>\n\n<p>Does spaces (between <code>N</code>, <code>sizeof</code> and <code>*p</code>) and the abscence of parenthsesis for <code>sizeof *p</code> (instead of <code>sizeof(*p)</code>) have to be strictly applied for syntax of this allocation ?</p>\n\n<p>In my code, I did :</p>\n\n<pre><code> /* Arrays */\n  double**  x;\n  double**  x0;\n\n/* Allocation of 2D arrays */\n  x =  malloc(size_tot_y*sizeof(*x));\n  x0 =  malloc(size_tot_y*sizeof(*x0));\n\n  for(i=0;i&lt;=size_tot_y-1;i++)\n  {\n    x[i] = malloc(size_tot_x*sizeof(**x));\n    x0[i] = malloc(size_tot_x*sizeof(**x0));\n  }\n</code></pre>\n\n<p>As you can see, I used parenthesis for <code>sizeof</code> and didn't use spaces between <code>size_tot_*</code>, <code>sizeof</code> and <code>*p</code>. </p>\n\n<p>Does my syntax change anything to respect the pattern mentioned above ? </p>\n\n<p>It may be a silly question but I would like to get a confirmation.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "pointers", "struct", "scanf"], "comments": [{"owner": {"reputation": 1533, "user_id": 7361580, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/yu1so.png?s=128&g=1", "display_name": "synchronizer", "link": "https://stackoverflow.com/users/7361580/synchronizer"}, "edited": false, "score": 0, "creation_date": 1485920261, "post_id": 41971423, "comment_id": 71121230, "body": "For each room struct you could use north, south, east, and west pointers to corresponding room structs."}], "owner": {"reputation": 11, "user_id": 5369220, "user_type": "registered", "profile_image": "https://graph.facebook.com/1071083086235571/picture?type=large", "display_name": "Marcello Cierro", "link": "https://stackoverflow.com/users/5369220/marcello-cierro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1497875369, "creation_date": 1485919789, "last_edit_date": 1497875369, "question_id": 41971423, "link": "https://stackoverflow.com/questions/41971423/connecting-user-inputted-data-into-arrays-in-structs", "title": "Connecting User inputted Data into array&#39;s in Structs", "body": "<p>Im creating a text based game in C, which uses user input to determine rooms and creatures. Rooms can only have 4 doors max, north south east and west, and creatures will eventually be associated to rooms I'd like to take the user input and store it in my struct array(s) as a means to easily connect rooms and creatures.</p>\n\n<pre><code> #include &lt;cstdlib&gt;\n #include &lt;stdio.h&gt;\n #include &lt;stdlib.h&gt;\n\nusing namespace std;\n\n/*\n * \n */\n\nstruct Rooms {\n  int roomProperties[5];\n};\n\nstruct Creatures {\n  int creatureProperties[2];\n};\n\nint main(int argc, char** argv) {\n\n  //creates rooms from user input\n  int roomNums;\n\n  printf(\"Enter rooms \");\n  scanf(\"%d\", &amp;roomNums);\n  printf(\"rooms declared %d\\n\", roomNums);\n\n  //defines room properties with correlation to numbers entered\n  int roomState;\n  int northRoom;\n  int southRoom;\n  int eastRoom;\n  int westRoom;\n\n  //cycles for input until properties = # of rooms\n  for (int i = 0; i &lt; roomNums; i++) {\n    scanf(\"%d %d %d %d %d\", &amp;roomState, &amp;northRoom, &amp;southRoom,    &amp;eastRoom, &amp;westRoom);\n    printf(\"stuff declared %d, %d, %d, %d, %d\\n\", roomState, northRoom, southRoom, eastRoom, westRoom);\n  }\n\n//spawns creatures based on user input\n\n  int monsterCount;\n  printf(\"Enter Monsters \");\n  scanf(\"%d\", &amp;monsterCount);\n  printf(\"monsters declared %d\\n\", monsterCount);\n\n  //creature properties with correlation to numbers entered\n  int creatureType;\n  int creatureLocation;\n\n  //prompts for information to match creatures spawned\n  for (int j = 0; j &lt; monsterCount; j++) {\n    scanf(\"%d %d\", &amp;creatureType, &amp;creatureLocation);\n    printf(\"monster stuff %d, %d\\n\", creatureType, creatureLocation);\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>Im trying to connect <code>roomState</code>, <code>northRoom</code>, <code>southRoom</code>, <code>eastRoom</code>, and <code>westRoom</code> to the struct <code>Rooms</code>, specifically <code>roomState</code> --> <code>roomProperties[0]</code>, and so forth. Im not sure how to go about that.</p>\n"}, {"tags": ["c#", "c", "date", "datetime"], "comments": [{"owner": {"reputation": 112977, "user_id": 390278, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/84715fec547362389d02f5be0ed12814?s=128&d=identicon&r=PG", "display_name": "Jeff Mercado", "link": "https://stackoverflow.com/users/390278/jeff-mercado"}, "edited": false, "score": 0, "creation_date": 1485920813, "post_id": 41971326, "comment_id": 71121369, "body": "Your <code>time_t</code> conversion looks fine to me, but I don&#39;t see how that expected date is related to the actual bytes."}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 3, "creation_date": 1485929024, "post_id": 41971326, "comment_id": 71123945, "body": "The MS-DOS date format is documented <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms724247(v=vs.85).aspx\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "edited": false, "score": 0, "creation_date": 1485957545, "post_id": 41971326, "comment_id": 71140900, "body": "Don&#39;t forget time zone and daylight savings."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485958302, "post_id": 41971326, "comment_id": 71141396, "body": "Even having one more sample set of data and expected date would be very useful."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485958808, "post_id": 41971326, "comment_id": 71141773, "body": "Note: <code>time_t t = 0x3b77008b;   puts(asctime(gmtime(&amp;t))); </code> --&gt; &quot;Sun Aug 12 22:17:47 2001&quot;.  11 days off of &quot;01/08/2001&quot;.  Hmmmm"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485959677, "post_id": 41971326, "comment_id": 71142383, "body": "The date <code>01&#47;08&#47;2001</code> is not in MS_DOS date format as <code>0x0D2B</code> nor <code>0x2B0D</code>.  <code>0x2B0D</code> in MS-DOS format is 2002 Aug 13th.  More hmmmm."}, {"owner": {"reputation": 38404, "user_id": 1838048, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/cb5NP.png?s=128&g=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/1838048/oliver"}, "edited": false, "score": 0, "creation_date": 1485960711, "post_id": 41971326, "comment_id": 71143069, "body": "Is there maybe a legacy tool which can read that file format and which you could use? If yes, you could manipulate your sample file and inspect in the legacy tool what it will show (so doing a reverse engineering)."}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 7498335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f05e7921677721f7e37a07e61d78f4?s=128&d=identicon&r=PG&f=1", "display_name": "Phil Lethbridge", "link": "https://stackoverflow.com/users/7498335/phil-lethbridge"}, "is_accepted": false, "score": 0, "last_activity_date": 1486004620, "creation_date": 1486004620, "answer_id": 41993539, "question_id": 41971326, "link": "https://stackoverflow.com/questions/41971326/how-do-i-convert-a-2-byte-c-date-into-net-datetime-using-c/41993539#41993539", "title": "How do I convert a 2 byte C date into .NET DateTime using C#?", "body": "<p>Many thanks for the replies! Based on the link by Raymond Chen, I have implemented the code below as a starting point. It returns a date of 13/08/2001 which is very close to the expected date. Thanks Oliver, I found a contact with a legacy application and they confirmed the date to be 13/08/2001 (contradicting the assumption that files were named based on collection date).</p>\n\n<p>Thanks again. </p>\n\n<p>In case it helps someone else my code and unit test are:</p>\n\n<pre><code>    internal struct Systime\n    {\n        internal UInt16 Year;\n        internal UInt16 Month;\n        internal UInt16 DayOfWeek;\n        internal UInt16 Day;\n        internal UInt16 Hour;\n        internal UInt16 Minute;\n        internal UInt16 Second;\n        internal UInt16 Milliseconds;\n    }\n\n    internal struct FileTime\n    {\n        internal UInt32 dwLowDateTime;\n        internal UInt32 dwHighDateTime;\n    }\n\n[DllImport(\"Kernel32.dll\", CharSet = CharSet.Ansi)]\nprivate static extern bool DosDateTimeToFileTime(UInt16 wFatDate, UInt16 wFatTime, ref FileTime lpFileTime);\n\n[DllImport(\"Kernel32.dll\", CharSet = CharSet.Ansi)]\nprivate static extern bool FileTimeToSystemTime(ref FileTime lpFileTime, ref Systime lpSystemTime);\n\n[DllImport(\"Kernel32.dll\", CharSet = CharSet.Ansi)]\nprivate static extern bool FileTimeToDosDateTime(ref FileTime lpFileTime, ref UInt16 wFatDate, ref UInt16 wFatTime);\n\n[DllImport(\"Kernel32.dll\", CharSet = CharSet.Ansi)]\nprivate static extern bool SystemTimeToFileTime(ref Systime lpSystemTime, ref FileTime lpFileTime);\n\n\npublic static DateTime FromMSDosDate(UInt16 toConvert)\n{\n    FileTime fileTime = new FileTime();\n    Systime systemTime = new Systime();\n\n    DosDateTimeToFileTime(toConvert, 0, ref fileTime);\n    FileTimeToSystemTime(ref fileTime, ref systemTime);\n\n    return new DateTime(systemTime.Year, systemTime.Month, systemTime.Day, 0, 0, 0);\n}\n\npublic static UInt16 ToMSDosDate(DateTime toConvert)\n{\n    Systime systemTime = new Systime();\n    FileTime fileTime = new FileTime();\n    UInt16 fatDate = 0;\n    UInt16 fatTime = 0;\n\n    systemTime.Day = (UInt16)toConvert.Day;\n    systemTime.Month = (UInt16)toConvert.Month;\n    systemTime.Year = (UInt16)toConvert.Year;\n\n    SystemTimeToFileTime(ref systemTime, ref fileTime);\n    FileTimeToDosDateTime(ref fileTime, ref fatDate, ref fatTime);\n\n    return fatDate;\n}\n\n[TestMethod]\npublic void Test_MSDos_Date()\n{\n    UInt16 testDate = 11021; // int value read from binary test file...\n    DateTime expected = new DateTime(2001, 8, 13, 0, 0, 0);\n    Assert.AreEqual(expected, Utils.FromMSDosDate(testDate));\n    Assert.AreEqual(testDate, Utils.ToMSDosDate(expected));\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7498335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f05e7921677721f7e37a07e61d78f4?s=128&d=identicon&r=PG&f=1", "display_name": "Phil Lethbridge", "link": "https://stackoverflow.com/users/7498335/phil-lethbridge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 204, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1486004620, "creation_date": 1485919005, "last_edit_date": 1485957598, "question_id": 41971326, "link": "https://stackoverflow.com/questions/41971326/how-do-i-convert-a-2-byte-c-date-into-net-datetime-using-c", "title": "How do I convert a 2 byte C date into .NET DateTime using C#?", "body": "<p>I am having trouble reading/writing a binary file containing date information. The struct covering the relevant portion of the file is:</p>\n\n<pre><code>typedef struct {\n    short int  blah1;       \n    short int  blah2;        \n    short int  blah3;        \n    short int  blah4;  \n    short int  blah5;   \n    WORD       date_created;   /* Creation date, packed as in a directory */\n    time_t     time;           /* Creation time, from bios interrupt 1Ah */\n    etc\n</code></pre>\n\n<p>From this I believe that 2 bytes (WORD) are being used to store the date and 4 bytes to store the time_t.</p>\n\n<p>I have a sample file that should contain the date 01/08/2001 (dd/mm/yyyy). The 2 byte values I read from the <i>date_created</i> portion of the file are decimal 0x0D and 0x2B.</p>\n\n<p>In case I have extracted the incorrect values, the file's first 80 bytes are <a href=\"https://dl.dropboxusercontent.com/u/25102974/20010801%20Fragment.bin\" rel=\"nofollow noreferrer\">here</a> and dump as follows</p>\n\n<pre><code>od -t x1 \"20010801 Fragment.bin\"     \n0000000 01 00 1c 01 00 00 bc 02 00 00 0d 2b 8b 00 77 3b\n0000020 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n*\n0000120\n</code></pre>\n\n<p>I have searched around but can't find anything that deals with storing date as a WORD. Perhaps I'm misinterpreting the problem and therefore not searching properly or not recognising the answers when I see them - sorry - not a C programmer.</p>\n\n<p>Many thanks in advance to anyone who can help.</p>\n\n<p>re: the time_t, I think I am converting it correctly using:</p>\n\n<pre><code>public static UInt32 To_time_t(DateTime toConvert)\n{\n    return (UInt32)(toConvert - new DateTime(1970, 1, 1)).TotalSeconds;\n}\n\npublic static DateTime From_time_t(UInt32 toConvert)\n{\n    DateTime epoch = new DateTime(1970, 1, 1, 0, 0, 0, DateTimeKind.Utc);\n    return epoch.AddSeconds(toConvert);\n}\n</code></pre>\n\n<p>...but please let me know if this is the wrong approach..</p>\n"}, {"tags": ["c", "gdb", "valgrind"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 3, "creation_date": 1485917943, "post_id": 41971159, "comment_id": 71120678, "body": "<code>Use of uninitialised value [...] at 0x400EB0: dest</code>"}, {"owner": {"reputation": 10702, "user_id": 2079103, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XlVYy.png?s=128&g=1", "display_name": "clearlight", "link": "https://stackoverflow.com/users/2079103/clearlight"}, "edited": false, "score": 0, "creation_date": 1485922098, "post_id": 41971159, "comment_id": 71121703, "body": "I had to fix my answer so dest wasn&#39;t statically allocated on the stack (e.g. inside a function), because when the function returns the stack allocated variables are undefined/garbage, reused immediately for anything the compiler wants to. So I changed it to malloc() the array of pointers, and added a free for that level too in main."}, {"owner": {"reputation": 10702, "user_id": 2079103, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XlVYy.png?s=128&g=1", "display_name": "clearlight", "link": "https://stackoverflow.com/users/2079103/clearlight"}, "edited": false, "score": 0, "creation_date": 1485988633, "post_id": 41971159, "comment_id": 71159421, "body": "One other thing - in functions that allocate memory with malloc, zalloc, calloc, strdup, etc... it is always advised to put a comment block above the function mentioning it is up to the caller to free any allocated memory returned to reduce risk of misuse and memory leaks. A common problem is that people may come back later to make changes &quot;borrow&quot; a function for quick use in another feature of the program or another solution and miss that fact and introduce a leak. So it&#39;s a good precautionary action."}], "answers": [{"comments": [{"owner": {"reputation": 1533, "user_id": 7361580, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/yu1so.png?s=128&g=1", "display_name": "synchronizer", "link": "https://stackoverflow.com/users/7361580/synchronizer"}, "reply_to_user": {"reputation": 10702, "user_id": 2079103, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XlVYy.png?s=128&g=1", "display_name": "clearlight", "link": "https://stackoverflow.com/users/2079103/clearlight"}, "edited": false, "score": 0, "creation_date": 1485920421, "post_id": 41971216, "comment_id": 71121258, "body": "I cannot take all the credit. In the comments above, @tkausl had a shorter answer but I felt that it should be explained."}, {"owner": {"reputation": 10702, "user_id": 2079103, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XlVYy.png?s=128&g=1", "display_name": "clearlight", "link": "https://stackoverflow.com/users/2079103/clearlight"}, "edited": false, "score": 0, "creation_date": 1485920482, "post_id": 41971216, "comment_id": 71121275, "body": "I uv&#39;d your answer anyway. At least you&#39;re in here swinging the bat :-)"}], "tags": [], "owner": {"reputation": 1533, "user_id": 7361580, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/yu1so.png?s=128&g=1", "display_name": "synchronizer", "link": "https://stackoverflow.com/users/7361580/synchronizer"}, "is_accepted": false, "score": 2, "last_activity_date": 1485918876, "last_edit_date": 1485918876, "creation_date": 1485918146, "answer_id": 41971216, "question_id": 41971159, "link": "https://stackoverflow.com/questions/41971159/segfault-in-c-program-malloc-call/41971216#41971216", "title": "Segfault in C program, malloc call", "body": "<pre><code>    dest[i] = malloc(srclen + 1);\n</code></pre>\n\n<p>You need to allocate memory for the pointer to char pointers (dest) as well as each char pointer stored in dest. In the code you provided, neither step is taken.</p>\n"}, {"tags": [], "owner": {"reputation": 10702, "user_id": 2079103, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XlVYy.png?s=128&g=1", "display_name": "clearlight", "link": "https://stackoverflow.com/users/2079103/clearlight"}, "is_accepted": true, "score": 2, "last_activity_date": 1485921985, "last_edit_date": 1485921985, "creation_date": 1485918752, "answer_id": 41971294, "question_id": 41971159, "link": "https://stackoverflow.com/questions/41971159/segfault-in-c-program-malloc-call/41971294#41971294", "title": "Segfault in C program, malloc call", "body": "<p>Use <a href=\"https://linux.die.net/man/3/strdup\" rel=\"nofollow noreferrer\">strdup()</a>. Saves steps (accounts for \n'\\0' too).  You have to allocate some memory before hand for the approach you're using. Otherwise you might want a linked list and allocate packets instead of using the array pattern. When you say <code>dest[i] = &lt;ptr value&gt;</code> you're indexing to an offset of unallocated memory and storing something there, so it's a segvio.</p>\n\n<pre><code>#include &lt;string.h&gt;\n#define MAXTOKENS  10000\n\nchar **get_dest(char *name) {\n    // Since dest has to be exposed/persist beyond this function all\n    // need dynamically allocate (malloc()) rather than stack allocate\n    // of the form of: char *dest[MAXTOKENS]. \n    char *dest = malloc(MAXTOKENS * sizeof (char *));  // &lt;--- need to allocate storage for the pointers\n    char *vp;\n    if ((vp = getenv(name)) == NULL)\n        exit(-1); // -1 is err exit on UNIX, 0 is success\n\n    int i = 0;\n    char *token = strtok(vp, \":\");\n    while (token != NULL) {\n        dest[i] = strdup(token); // &lt;=== strdup()\n        token = strtok(NULL, \":\");\n        i++;\n    }\n\n//  dest[i] = NULL;  // Why are you setting this to NULL after adding token?\n    return dest;\n\n}\n</code></pre>\n\n<p>It's better if main() takes care of passing a proper null-terminated string to the get_dest() function because main is where the finicky fgets() is handled. Generally you want to do things locally where it makes the most sense and is most relevant. If you ever took your get_dest() function and used it somewhere where the strings were not read by fgets() it would just be a wasted step to overwrite the terminator there.  So by initializing the char array to zeroes before fgets() you don't have to worry about setting the trailing byte to '\\0'.</p>\n\n<p>And finally probably not good to have your function name dest the same name as the variable it returns dest. In some situations having multiple symbols in your program with the same name can get you into trouble.</p>\n\n<pre><code>#include \"executables.h\"\nint main(int argc, char **argv) {\n    char *path;\n    char name[BUFSIZ] = { 0 };  // You could initialize it to zero this way\n    printf(\"enter name of environment variable:\\n\");\n//  bzero(name, BUFSIZ); //... or you could initialize it to zero this way then\n    fgets(name, BUFSIZ, stdin);\n    char **p = get_dest(name);\n    int j = 0;\n    while(p[j] != NULL) {\n        printf(\"%s\\n\", p[j]);\n        j++;\n        free(p[j]);  // like malloc(), strdup'd() strings must be free'd when done\n    }\n    free(p);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": false, "score": 1, "last_activity_date": 1485941208, "creation_date": 1485941208, "answer_id": 41976129, "question_id": 41971159, "link": "https://stackoverflow.com/questions/41971159/segfault-in-c-program-malloc-call/41976129#41976129", "title": "Segfault in C program, malloc call", "body": "<p>From the manpage of getenv:</p>\n\n<blockquote>\n  <p>Notes\n  ...\n  As typically implemented, getenv() returns a pointer to a string\n  within the environment list. <strong>The caller must take care not to modify\n  this string, since that would change the environment of the process.</strong></p>\n</blockquote>\n\n<p>Your code violates that rule:</p>\n\n<pre><code>vp=getenv(name);\n...\ntoken =strtok(vp,s);\n</code></pre>\n\n<p>This is an illegal memory write operation.</p>\n"}], "owner": {"reputation": 49, "user_id": 3022048, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72e9a313aa4215c656ee2b0b3e5b71d9?s=128&d=identicon&r=PG&f=1", "display_name": "user3022048", "link": "https://stackoverflow.com/users/3022048/user3022048"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 41971294, "answer_count": 3, "score": 1, "last_activity_date": 1485941208, "creation_date": 1485917611, "question_id": 41971159, "link": "https://stackoverflow.com/questions/41971159/segfault-in-c-program-malloc-call", "title": "Segfault in C program, malloc call", "body": "<p>I am writing a program that takes a list of path ( environmental variable), splits the paths and prints it. When compiling it I get a segfault. The following is my output on GDB :</p>\n\n<pre><code>Program received signal SIGSEGV, Segmentation fault.\n0x0000000000400eb0 in dest (name=0x7fffffffbce0 \"PATH\") at executables.c:100\n100     dest[i] = malloc(srclen+1);\n</code></pre>\n\n<p>On valgrind: </p>\n\n<pre><code>==21574== 1 errors in context 2 of 3:\n==21574== Use of uninitialised value of size 8\n==21574==    at 0x400EB0: dest (executables.c:100)\n==21574==    by 0x400B5B: main (main.c:9)\n</code></pre>\n\n<p>This is my function: </p>\n\n<pre><code>char** dest(char *name){\n    int i=0;\n    char *vp;\n    const char s[2]=\":\";\n    char *token;\n    char **dest;\n    name[strlen(name)-1]='\\0';\n    vp=getenv(name);\n    if(vp == NULL){\n        exit(1);\n    }\n    token =strtok(vp,s);\n    while( token != NULL ){\n        size_t srclen = strlen(token);\n        dest[i] = malloc(srclen+1);\n        strcpy(dest[i], token);\n        token = strtok(NULL, s);\n        i++;\n    }\n    dest[i]=NULL;\n    return dest;\n}\n</code></pre>\n\n<p>And this is my main:</p>\n\n<pre><code>#include \"executables.h\"\nint main(int argc, char **argv){\n    char *path;\n    char name[BUFSIZ];\n    printf(\"enter name of environment variable:\\n\");\n    fgets(name,BUFSIZ,stdin);\n    char **p=dest(name);\n    int j=0;\n    while(p[j]!=NULL){\n        printf(\"%s\\n\",p[j]);\n        j++;\n    }\n    return(0);\n}\n</code></pre>\n"}, {"tags": ["c", "format", "logic"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1485918574, "post_id": 41971004, "comment_id": 71120833, "body": "Have you come across arrays yet?  The use of <code>p1</code> .. <code>p9</code> strongly hints at an array. The fact that you don&#39;t really use <code>p3</code> .. <code>p9</code> hints at trouble to come."}, {"owner": {"reputation": 883, "user_id": 2987084, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/j8gAR.png?s=128&g=1", "display_name": "Shinji-san", "link": "https://stackoverflow.com/users/2987084/shinji-san"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1485922768, "post_id": 41971004, "comment_id": 71121890, "body": "Thanks but we can&#39;t use arrays for this project :("}], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 7492042, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Jns91.jpg?s=128&g=1", "display_name": "J. Laderoute", "link": "https://stackoverflow.com/users/7492042/j-laderoute"}, "is_accepted": true, "score": 1, "last_activity_date": 1485918320, "last_edit_date": 1485918320, "creation_date": 1485917992, "answer_id": 41971201, "question_id": 41971004, "link": "https://stackoverflow.com/questions/41971004/peg-puzzle-formatting-output/41971201#41971201", "title": "Peg Puzzle formatting output", "body": "<p>Something looks odd with your curly braces. I usually include curly braces even for single line else statements to make the code more clear.  </p>\n\n<p>Try surrounding your else if() code block with {} braces and recompile. See if that helps.</p>\n\n<p>Actually, it looks like you are missing an ending curly brace for one of your for loops. </p>\n"}], "owner": {"reputation": 883, "user_id": 2987084, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/j8gAR.png?s=128&g=1", "display_name": "Shinji-san", "link": "https://stackoverflow.com/users/2987084/shinji-san"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 41971201, "answer_count": 1, "score": 0, "last_activity_date": 1485918320, "creation_date": 1485916527, "question_id": 41971004, "link": "https://stackoverflow.com/questions/41971004/peg-puzzle-formatting-output", "title": "Peg Puzzle formatting output", "body": "<p>I'm trying to create a peg jump puzzle and I'm doing the format specifiers and I realize the algorithm is not done yet, but can someone explain why my condition is being ignored? It's running format specification, even when column is more than one. For example, each '+' for every row after the first one in the peg jump puzzle game has 7 spaces before each column's '+', when I want only the very first column to have format specification and then each row thereafter have descending spaces.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n\n    //variables for pieceboard\n\n    char p1, p2, p3, p4, p5, p6, p7, p8, p9;\n    int row = 1;\n    int column = 1;\n\n    p1 = 'o';\n    p2 = p3 = p4 = p5 = p6 = p7 = p8 = p9 = '+';\n\n    for ( row =1 ; row &lt;= 5; row++ ){\n        for ( column = 1; column &lt;= row; column++ ) {\n            if ( row == 1 ) {\n                printf(\"%+8c\", p1);\n            }\n            else if( row &gt; 1 &amp;&amp; column == row )\n                printf(\"%+7c\", p2);\n\n        printf(\"\\n\");\n}\n    system(\"PAUSE\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 33, "user_id": 7498152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50a0d9a592f466fdd6cd8aa654f4d22?s=128&d=identicon&r=PG&f=1", "display_name": "Slightly_Stoopid_23", "link": "https://stackoverflow.com/users/7498152/slightly-stoopid-23"}, "edited": false, "score": 0, "creation_date": 1485916052, "post_id": 41970939, "comment_id": 71120239, "body": "ive also tried it like if(!isdigit(*tokens[i])) || *tokens[i] % 1 != 0)"}, {"owner": {"reputation": 40865, "user_id": 10431, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/22aac6106c44ae4078bd4c0a564714e0?s=128&d=identicon&r=PG", "display_name": "Keith Nicholas", "link": "https://stackoverflow.com/users/10431/keith-nicholas"}, "edited": false, "score": 0, "creation_date": 1485916191, "post_id": 41970939, "comment_id": 71120274, "body": "isdigit works on a single character"}, {"owner": {"reputation": 40865, "user_id": 10431, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/22aac6106c44ae4078bd4c0a564714e0?s=128&d=identicon&r=PG", "display_name": "Keith Nicholas", "link": "https://stackoverflow.com/users/10431/keith-nicholas"}, "edited": false, "score": 0, "creation_date": 1485916218, "post_id": 41970939, "comment_id": 71120279, "body": "you are just checking the first digit of every token"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485916251, "post_id": 41970939, "comment_id": 71120297, "body": "To detect if a string is an <code>int</code>, perhaps call a helper function that uses <code>strtol()</code>?"}, {"owner": {"reputation": 875, "user_id": 6918481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/949bc6de647c79a6a432bc8ed1a51b5b?s=128&d=identicon&r=PG&f=1", "display_name": "Shiping", "link": "https://stackoverflow.com/users/6918481/shiping"}, "edited": false, "score": 0, "creation_date": 1485916298, "post_id": 41970939, "comment_id": 71120307, "body": "i&#39;m afraid isdigit() only checked the first character of the token."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485917229, "post_id": 41970939, "comment_id": 71120528, "body": "&quot;right now im doing it like this:&quot;  Hmmm, code does not compile."}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1485917015, "last_edit_date": 1485917015, "creation_date": 1485916626, "answer_id": 41971017, "question_id": 41970939, "link": "https://stackoverflow.com/questions/41970939/c-splitting-a-user-input-up-into-tokens-and-identify-format-them-in-output/41971017#41971017", "title": "C - Splitting a user input up into tokens and identify/format them in output", "body": "<p><code>isdigit(*tokens[i])</code> only looks at the first character, not the entire token/string.</p>\n\n<hr>\n\n<p>To detect if a token is an integer, form a simple helper function.  Adjust as needed.  </p>\n\n<pre><code>// Look for an optional sign, at least 1 digit and then a null character.\nint IsInteger(const char *s) {\n  if (*s == '+' || *s == '-') s++;\n  int digit_found = false;\n  while (isdigit((unsigned char) *s) {\n    s++; \n    digit_found = 1;\n  }\n  // end with null character?\n  return *s == '\\0' &amp;&amp; digit_found;\n}\n</code></pre>\n\n<p>Could instead use <code>strtol()</code>, etc.</p>\n\n<pre><code>int IsInteger(const char *s) {\n  char *endptr;\n  strtol(s, &amp;endptr, 10);  // no need to save result, just need to detect conversion.\n  return s != endptr &amp;&amp; *endptr == '\\0';\n}\n</code></pre>\n\n<p>...</p>\n\n<pre><code>for(int i = 0; i &lt; counter; i++){\n  if(IsInteger(tokens[i])) {\n    printf(\"str\");\n  } else{\n    printf(\"int\");\n  }\n}\n</code></pre>\n\n<hr>\n\n<p>Also, increment <code>counter</code>, not <code>i</code>.</p>\n\n<pre><code>while(ptr != NULL){\n    // tokens[i++] = ptr;\n    tokens[counter++] = ptr;\n    ptr = strtok(NULL, \" \\n\");\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7498152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50a0d9a592f466fdd6cd8aa654f4d22?s=128&d=identicon&r=PG&f=1", "display_name": "Slightly_Stoopid_23", "link": "https://stackoverflow.com/users/7498152/slightly-stoopid-23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 41971017, "answer_count": 1, "score": 2, "last_activity_date": 1485917015, "creation_date": 1485916035, "question_id": 41970939, "link": "https://stackoverflow.com/questions/41970939/c-splitting-a-user-input-up-into-tokens-and-identify-format-them-in-output", "title": "C - Splitting a user input up into tokens and identify/format them in output", "body": "<p>Ok so my question to clarify is, a user input, i.e.\n\"Hey there 5 buddy 3.15 tonight 65\"</p>\n\n<p>I need to split this string up into tokens using a space delimiter, which i can do fine. My issue is on the 3.15, where im stuck is, in my assignment its declared that if its not an integer i must identify it as a string and output the result which would look like this.</p>\n\n<p>\"str str int str str str int\"</p>\n\n<p>as 5 and 65 are the only integers.</p>\n\n<p>right now im doing it like this:</p>\n\n<pre><code>int main(int argc, char **argv)\n{\n    char arr[66];\n    char *tokens[10];\n    int counter = 0;\n    char *ptr = strtok(arr, \" \\n\");\n\n    while(ptr != NULL){\n        tokens[i++] = ptr;\n        ptr = strtok(NULL, \" \\n\");\n    }\n\n    for(int i = 0; i &lt; counter; i++){\n         if(!isdigit(*tokens[i])){\n              printf(\"str\");\n         }else{\n              printf(\"int\");\n         }\n   }\n   return 0;\n}\n</code></pre>\n\n<p>my issue is that the isdigit function thinks that 3.14 is and integer, do i need to use a modifier or something to make it identify as a str?</p>\n"}, {"tags": ["c++", "c", "bitwise-operators"], "comments": [{"owner": {"reputation": 41, "user_id": 7498170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e33629bb8ce8c2d057f5370f6ae1990a?s=128&d=identicon&r=PG", "display_name": "yeates", "link": "https://stackoverflow.com/users/7498170/yeates"}, "edited": false, "score": 0, "creation_date": 1485915970, "post_id": 41970814, "comment_id": 71120220, "body": "Thank a lot, i get it. I may forgot the operator priority."}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 4, "last_activity_date": 1485915207, "creation_date": 1485915207, "answer_id": 41970833, "question_id": 41970814, "link": "https://stackoverflow.com/questions/41970814/whats-the-difference-between-if-s-i-and-if-si-0/41970833#41970833", "title": "What&#39;s the difference between if( !(s &amp; i) ) and if( s&amp;i == 0 )?", "body": "<p>The first condition</p>\n\n<pre><code>if(s &amp; i == 0)   cout &lt;&lt; (s &amp; i) &lt;&lt; endl;\n</code></pre>\n\n<p>is equivalent to this condition</p>\n\n<pre><code>if(s &amp; ( i == 0 ) )   cout &lt;&lt; (s &amp; i) &lt;&lt; endl;\n</code></pre>\n\n<p>and has nothing common with this condition</p>\n\n<pre><code>if(!(s &amp; i))    cout &lt;&lt; (s &amp; i) &lt;&lt; endl;\n</code></pre>\n\n<p>I think you mean</p>\n\n<pre><code>if( ( s &amp; i ) == 0)   cout &lt;&lt; (s &amp; i) &lt;&lt; endl;\n</code></pre>\n\n<p>In this case the both conditions are equivalent.</p>\n"}, {"tags": [], "owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "is_accepted": false, "score": 4, "last_activity_date": 1485915233, "creation_date": 1485915233, "answer_id": 41970838, "question_id": 41970814, "link": "https://stackoverflow.com/questions/41970814/whats-the-difference-between-if-s-i-and-if-si-0/41970838#41970838", "title": "What&#39;s the difference between if( !(s &amp; i) ) and if( s&amp;i == 0 )?", "body": "<p>The equality comparison operator (<code>==</code>) has a higher precedence than the bitwise and operator (<code>&amp;</code>), so the first expression is equivalent to:</p>\n\n<pre><code>if(s &amp; (i == 0))   cout &lt;&lt; (s &amp; i) &lt;&lt; endl;\n</code></pre>\n\n<p>Since <code>i</code> is set to <code>3</code>, <code>(i == 0)</code> is <code>false</code>, which is converted to <code>0</code> when bitwise and'ed.  <code>4 &amp; 0</code> equals <code>0</code>, so nothing is printed.</p>\n"}, {"tags": [], "owner": {"reputation": 538, "user_id": 7455774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WBGNz.jpg?s=128&g=1", "display_name": "Greg Kikola", "link": "https://stackoverflow.com/users/7455774/greg-kikola"}, "is_accepted": true, "score": 7, "last_activity_date": 1485915306, "creation_date": 1485915306, "answer_id": 41970848, "question_id": 41970814, "link": "https://stackoverflow.com/questions/41970814/whats-the-difference-between-if-s-i-and-if-si-0/41970848#41970848", "title": "What&#39;s the difference between if( !(s &amp; i) ) and if( s&amp;i == 0 )?", "body": "<p><code>==</code> has higher precedence than <code>&amp;</code>. So</p>\n\n<pre><code>if (s &amp; i == 0)\n</code></pre>\n\n<p>is actually equivalent to</p>\n\n<pre><code>if (s &amp; (i == 0))\n</code></pre>\n\n<p>In other words, you're checking if <code>i</code> is <code>0</code> and then <code>&amp;</code>ing the result (0 or 1) with <code>s</code>. You probably wanted</p>\n\n<pre><code>if ((s &amp; i) == 0)\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7498170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e33629bb8ce8c2d057f5370f6ae1990a?s=128&d=identicon&r=PG", "display_name": "yeates", "link": "https://stackoverflow.com/users/7498170/yeates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 396, "favorite_count": 0, "accepted_answer_id": 41970848, "answer_count": 3, "score": 2, "last_activity_date": 1485915306, "creation_date": 1485915011, "question_id": 41970814, "link": "https://stackoverflow.com/questions/41970814/whats-the-difference-between-if-s-i-and-if-si-0", "title": "What&#39;s the difference between if( !(s &amp; i) ) and if( s&amp;i == 0 )?", "body": "<p>eg.</p>\n\n<pre><code>int main(){\n    int s = 4, i = 3;\n    if(s &amp; i == 0)   cout &lt;&lt; (s &amp; i) &lt;&lt; endl;\n    if(!(s &amp; i))    cout &lt;&lt; (s &amp; i) &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>Output only one zero.\nWhy not no print or print two zero?</p>\n"}, {"tags": ["c", "arrays", "string", "algorithm", "unique"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1485914462, "post_id": 41970727, "comment_id": 71119839, "body": "<code>aircraft_array[k+1]</code> is out of bounds, isn&#39;t it?"}, {"owner": {"reputation": 34704, "user_id": 1746118, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/a4a3P.png?s=128&g=1", "display_name": "Naman", "link": "https://stackoverflow.com/users/1746118/naman"}, "edited": false, "score": 0, "creation_date": 1485914480, "post_id": 41970727, "comment_id": 71119843, "body": "What is <code>aircraft_array</code> and please check its bounds?"}, {"owner": {"reputation": 499, "user_id": 5339899, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ebf68221eb3e8ff1037314f300217549?s=128&d=identicon&r=PG&f=1", "display_name": "TheQAGuy", "link": "https://stackoverflow.com/users/5339899/theqaguy"}, "edited": false, "score": 0, "creation_date": 1485914484, "post_id": 41970727, "comment_id": 71119844, "body": "I cant say for sure as you didnt post some important code however if I were to guess I would say you are probably writing to memory that your program does not own. probably to do with the strpcpy"}, {"owner": {"reputation": 153, "user_id": 3479629, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0171c4f9547feebc484ca26c30d2a97a?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie", "link": "https://stackoverflow.com/users/3479629/newbie"}, "reply_to_user": {"reputation": 499, "user_id": 5339899, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ebf68221eb3e8ff1037314f300217549?s=128&d=identicon&r=PG&f=1", "display_name": "TheQAGuy", "link": "https://stackoverflow.com/users/5339899/theqaguy"}, "edited": false, "score": 0, "creation_date": 1485914568, "post_id": 41970727, "comment_id": 71119865, "body": "@JackVanier How should  I approach removing duplicate strings from *aircraft_array[10000] ?"}, {"owner": {"reputation": 2467, "user_id": 888715, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/5ee3d698e7783a4fda1a307695a2154b?s=128&d=identicon&r=PG", "display_name": "awiebe", "link": "https://stackoverflow.com/users/888715/awiebe"}, "edited": false, "score": 0, "creation_date": 1485914581, "post_id": 41970727, "comment_id": 71119872, "body": "Trap, means you entered the debugger, probably because you overstepped a buffer."}, {"owner": {"reputation": 153, "user_id": 3479629, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0171c4f9547feebc484ca26c30d2a97a?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie", "link": "https://stackoverflow.com/users/3479629/newbie"}, "reply_to_user": {"reputation": 34704, "user_id": 1746118, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/a4a3P.png?s=128&g=1", "display_name": "Naman", "link": "https://stackoverflow.com/users/1746118/naman"}, "edited": false, "score": 0, "creation_date": 1485914603, "post_id": 41970727, "comment_id": 71119876, "body": "@nullpointer it is an array that is storing strings;  char *aircraft_array[10000]"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1485914773, "post_id": 41970727, "comment_id": 71119925, "body": "@Newbie  There are many bad codes in the internet.:) My congratulations. You found one more.:)"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1485914843, "post_id": 41970727, "comment_id": 71119942, "body": "@Newbie  If it is an array of string literals then you may not modify them."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1485914924, "post_id": 41970727, "comment_id": 71119957, "body": "@Newbie  Also could you say why should we discuss this bad code that you found in the internet?!"}, {"owner": {"reputation": 153, "user_id": 3479629, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0171c4f9547feebc484ca26c30d2a97a?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie", "link": "https://stackoverflow.com/users/3479629/newbie"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1485915051, "post_id": 41970727, "comment_id": 71119981, "body": "@VladfromMoscow Oh I am not saying we need to discuss bad code. I am new to C and just wanted some help from better people."}, {"owner": {"reputation": 153, "user_id": 3479629, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0171c4f9547feebc484ca26c30d2a97a?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie", "link": "https://stackoverflow.com/users/3479629/newbie"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1485915422, "post_id": 41970727, "comment_id": 71120055, "body": "@VladfromMoscow And I do not think the code is bad because the original code works fine integers. It breaks when adapting to string for some reason I cant put my finger on"}, {"owner": {"reputation": 1343, "user_id": 2205845, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a1dea1209ebf27edf4244bbef686d366?s=128&d=identicon&r=PG", "display_name": "KC Wong", "link": "https://stackoverflow.com/users/2205845/kc-wong"}, "edited": false, "score": 0, "creation_date": 1485915503, "post_id": 41970727, "comment_id": 71120076, "body": "@Newbie Stackoverflow is a Q&amp;A site, learning through this format is not ideal (<a href=\"http://meta.stackexchange.com/questions/19590/is-stack-overflow-an-effective-platform-for-studying-programming\" title=\"is stack overflow an effective platform for studying programming\">meta.stackexchange.com/questions/19590/&hellip;</a>). I would recommend Bruce Eckel&#39;s Thinking in C++ (<a href=\"http://www.mindview.net/Books/TICPP/ThinkingInCPP2e.html\" rel=\"nofollow noreferrer\">mindview.net/Books/TICPP/ThinkingInCPP2e.html</a>)."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1485915614, "post_id": 41970727, "comment_id": 71120111, "body": "@Newbie Who are &quot;better people&quot;? :) Nevertheless it is a bad code. Even if it will be written correctly it is inefficient."}, {"owner": {"reputation": 153, "user_id": 3479629, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0171c4f9547feebc484ca26c30d2a97a?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie", "link": "https://stackoverflow.com/users/3479629/newbie"}, "reply_to_user": {"reputation": 1343, "user_id": 2205845, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a1dea1209ebf27edf4244bbef686d366?s=128&d=identicon&r=PG", "display_name": "KC Wong", "link": "https://stackoverflow.com/users/2205845/kc-wong"}, "edited": false, "score": 0, "creation_date": 1485915621, "post_id": 41970727, "comment_id": 71120115, "body": "@KCWong Yes and I asked a question."}, {"owner": {"reputation": 153, "user_id": 3479629, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0171c4f9547feebc484ca26c30d2a97a?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie", "link": "https://stackoverflow.com/users/3479629/newbie"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1485915653, "post_id": 41970727, "comment_id": 71120129, "body": "@VladfromMoscow You guys. You are proficient at what you do."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1485915716, "post_id": 41970727, "comment_id": 71120146, "body": "@Newbie In writing comments?:)"}, {"owner": {"reputation": 153, "user_id": 3479629, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0171c4f9547feebc484ca26c30d2a97a?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie", "link": "https://stackoverflow.com/users/3479629/newbie"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1485916339, "post_id": 41970727, "comment_id": 71120317, "body": "@VladfromMoscow idk dude. My guess would be drinking vodka."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1485946802, "post_id": 41970727, "comment_id": 71133744, "body": "&quot;the original code works fine integers&quot;. It doesn&#39;t. You have tested it and didn&#39;t find an error. It doesn&#39;t mean there are no errors"}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1485944518, "last_edit_date": 1485944518, "creation_date": 1485917252, "answer_id": 41971114, "question_id": 41970727, "link": "https://stackoverflow.com/questions/41970727/abort-trap-6-with-loop-in-c/41971114#41971114", "title": "Abort trap: 6 with loop in c", "body": "<p>In this statement</p>\n\n<pre><code>strcpy(aircraft_array[k],aircraft_array[k+1]);\n                                       ^^^^^\n</code></pre>\n\n<p>there is an attempt to access memory beyond the array when <code>k</code> is equal to <code>size-1</code>. </p>\n\n<p>This increment</p>\n\n<pre><code>        } else\n            j++;\n            ^^^^\n</code></pre>\n\n<p>does not make sense because the variable also is incremented in the loop statement</p>\n\n<pre><code> for (int j = i + 1; j &lt; size; j++) {\n                               ^^^^\n</code></pre>\n\n<p>that is it is incremented twice. Moreover when a subarray was copied the variable <code>j</code> shall not be incremented. </p>\n\n<p>And it is inefficient to copy a whole subarray when a duplicate is found.</p>\n\n<p>The function can look differently depending on whether it deals with a two dimensional character array or an array of pointers to strings.</p>\n\n<p>In case when there is a two-dimensional array the function can look the following way as it is shown in the demonstrative program below</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nsize_t remove_duplicates( size_t m, size_t n, char s[static const m][n] )\n{\n    size_t i = 0;\n\n    for ( size_t j = 0; j &lt; m; j++ )\n    {\n        size_t k = 0;\n        while ( k != i &amp;&amp; strcmp( s[k], s[j] ) != 0 ) k++;\n\n        if ( k == i )\n        {\n            if ( i != j ) strcpy( s[i], s[j] );\n            ++i;\n        }\n    }\n\n    return i;\n}\n\nint main(void) \n{\n    char s[][2] = { \"A\", \"B\", \"A\", \"C\", \"D\", \"A\" };\n    size_t N = sizeof( s ) / sizeof( *s );\n\n    for ( size_t i = 0; i &lt; N; i++ ) printf( \"%s \", s[i] );\n    printf( \"\\n\" );\n\n    size_t n = remove_duplicates( N, 2, s );\n\n    for ( size_t i = 0; i &lt; n; i++ ) printf( \"%s \", s[i] );\n    printf( \"\\n\" );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>A B A C D A \nA B C D \n</code></pre>\n\n<p>If there is an array of pointers then the function can look the following way.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nsize_t remove_duplicates( char * s[], size_t n )\n{\n    size_t i = 0;\n\n    for ( size_t j = 0; j &lt; n; j++ )\n    {\n        size_t k = 0;\n        while ( k != i &amp;&amp; strcmp( s[k], s[j] ) != 0 ) k++;\n\n        if ( k == i )\n        {\n            if ( i != j ) s[i] = s[j];\n            ++i;\n        }\n    }\n\n    return i;\n}\n\nint main(void) \n{\n    char * s[] = { \"A\", \"B\", \"A\", \"C\", \"D\", \"A\" };\n    size_t N = sizeof( s ) / sizeof( *s );\n\n    for ( size_t i = 0; i &lt; N; i++ ) printf( \"%s \", s[i] );\n    printf( \"\\n\" );\n\n    size_t n = remove_duplicates( s, N );\n\n    for ( size_t i = 0; i &lt; n; i++ ) printf( \"%s \", s[i] );\n    printf( \"\\n\" );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is the same as shown above</p>\n\n<pre><code>A B A C D A \nA B C D \n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 3479629, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0171c4f9547feebc484ca26c30d2a97a?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie", "link": "https://stackoverflow.com/users/3479629/newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 320, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1485944518, "creation_date": 1485914235, "last_edit_date": 1485917693, "question_id": 41970727, "link": "https://stackoverflow.com/questions/41970727/abort-trap-6-with-loop-in-c", "title": "Abort trap: 6 with loop in c", "body": "<pre><code>for (int i = 0; i &lt; size; i++) {\n\n        for (int j = i + 1; j &lt; size; j++) {\n\n            if (strcmp(aircraft_array[j], aircraft_array[i])==0) {\n\n                for (int k = j; k &lt; size; k++) {\n                    strcpy(aircraft_array[k],aircraft_array[k+1]);\n                }\n                size--;\n            } else\n                j++;\n        }\n    }\n</code></pre>\n\n<p>Hello guys</p>\n\n<p>I have copied this code from <code>http://www.c4learn.com/c-programs/to-delete-duplicate-elements-in-array.html</code>. However the code is giving me the error <strong>Abort code 6</strong>. I am not entirely sure what that means.</p>\n\n<p>Any help is appreciated.</p>\n\n<p>PS: I tested the code by putting print statements and the code breaks right here.</p>\n"}, {"tags": ["c", "file", "output", "reverse"], "comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1485913974, "post_id": 41970634, "comment_id": 71119717, "body": "What do you want when there&#39;s more than one line?"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1485914234, "post_id": 41970634, "comment_id": 71119781, "body": "<code>My name is Hello</code> is not backwards from <code>Hello My name is</code>. Did you mean <code>is name My Hello</code>?"}, {"owner": {"reputation": 29, "user_id": 7484656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d852a62081493d44d67578cccee4d91?s=128&d=identicon&r=PG&f=1", "display_name": "JsmileyJ", "link": "https://stackoverflow.com/users/7484656/jsmileyj"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1485914341, "post_id": 41970634, "comment_id": 71119813, "body": "Say the multiple lines are Hello and My name is, I want My name is printed first and the next line to be Hello, almost like they switched places"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 7484656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d852a62081493d44d67578cccee4d91?s=128&d=identicon&r=PG&f=1", "display_name": "JsmileyJ", "link": "https://stackoverflow.com/users/7484656/jsmileyj"}, "edited": false, "score": 1, "creation_date": 1485916823, "post_id": 41970906, "comment_id": 71120431, "body": "Thank you for your answer, I very much appreciate it, sorry I edited my initial question, I am new to stack overflow and didn&#39;t know how to format my question properly :p"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 29, "user_id": 7484656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d852a62081493d44d67578cccee4d91?s=128&d=identicon&r=PG&f=1", "display_name": "JsmileyJ", "link": "https://stackoverflow.com/users/7484656/jsmileyj"}, "edited": false, "score": 0, "creation_date": 1485929100, "post_id": 41970906, "comment_id": 71123991, "body": "@JsmileyJ No worries, it was interesting exercise. I&#39;ve edited the answer with a solution to your clarified question. It&#39;s not the most efficient, but it works."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 1, "last_activity_date": 1485929662, "last_edit_date": 1485929662, "creation_date": 1485915763, "answer_id": 41970906, "question_id": 41970634, "link": "https://stackoverflow.com/questions/41970634/print-contents-of-a-file-in-reverse-line-order/41970906#41970906", "title": "Print contents of a file in reverse line order", "body": "<p>How you're doing it, reading a character and seeking backwards one, is inefficient.</p>\n\n<p>The Perl module <a href=\"https://metacpan.org/pod/File::ReadBackwards\" rel=\"nofollow noreferrer\">File::Readbackwards</a> is a good read. Perl's IO is very close to C, and the code is well commented.</p>\n\n<p>The basic algorithm is to read and buffer blocks, and find lines within that block, but starting at the end of the file and going backwards. </p>\n\n<ol>\n<li>Open the file.</li>\n<li>Seek to the end.</li>\n<li>Seek backwards to the previous block.</li>\n<li>Read that block into a buffer.</li>\n</ol>\n\n<p>Once you have that buffer, scan backwards through the buffer until you find a newline. Now you have a complete line. If you fail to find a newline, read the previous block and try again.</p>\n\n<hr>\n\n<p>That's non-trivial, so here's how you'd do it reading backwards one character at a time until you see a newline. I've used the <code>fgets</code> interface to get one line at a time.</p>\n\n<pre><code>char *fgets_backwards( char *str, int size, FILE *fp ) {\n    /* Stop if we're at the beginning of the file */\n    if( ftell(fp) == 0 ) {\n        return NULL;\n    }\n\n    int i;\n    /* Be sure not to overflow the string nor read past the start of the file */\n    for( i = 0; ftell(fp) != 0 &amp;&amp; i &lt; size; i++ ) {\n        /* Back up one character */\n        fseek(fp, -1, SEEK_CUR);\n        /* Read that character */\n        str[i] = (char)fgetc(fp);\n\n        /* We have the whole line if we see a newline, except at the start.\n           This happens before we back up a character so the newline will\n           appear on the next line. */\n        if( str[i] == '\\n' &amp;&amp; i != 0 ) {\n            break;\n        }\n\n        /* Back up the character we read. */\n        fseek(fp, -1, SEEK_CUR);\n    }\n\n    /* Null terminate, overwriting the previous line's newline */\n    str[i] = '\\0';\n\n    return str;\n}\n</code></pre>\n\n<p>These lines will come out backwards, so reverse them. That's simple enough.</p>\n\n<pre><code>void reverse( char *start ) {\n    size_t len = strlen(start);\n\n    for( char *end = &amp;start[len-1]; start &lt; end; start++, end-- ) {\n        char tmp = start[0];\n        start[0] = end[0];\n        end[0] = tmp;\n    }\n}\n</code></pre>\n\n<p>Putting it all together...</p>\n\n<pre><code>fseek( fp, 0, SEEK_END );\n\nchar line[1024];\nwhile( fgets_backwards( line, 1024, fp ) != NULL ) {\n    reverse(line);\n    printf(\"%s\", line);\n}\n</code></pre>\n\n<p>Note, I was sloppy about error checking. Each call to <code>fseek</code> should be checked.</p>\n\n<hr>\n\n<p><strong>NOTE</strong>: <em>I wrote this part before the OP clarified what they wanted. Oh well, it's still pretty cool.</em></p>\n\n<p>Now that you have a complete line, you can tackle reversing it separate from reading the file.</p>\n\n<pre><code>char *reverse_by_word( char *string ) {\n    size_t len = strlen(string);\n\n    /* Allocate enough space to store string, and a null */\n    char *reversed = malloc( len * sizeof(char) );\n\n    /* Initialize reversed to be an empty string so strcat knows where to start */\n    /* There's no need to initialize the rest of the string,\n    /* the garbage from malloc will be overwritten */\n    reversed[0] = '\\0';\n\n    /* Read the string backwards, character by characer */\n    for( int i = (int)len - 1; i &gt;= 0; i-- ) {\n        /* If we see a space... */\n        if( isspace( string[i] ) ) {\n            /* Add the word after it to reversed */\n            strcat( reversed, &amp;string[i+1] );\n            /* Faithfully reproduce the whitespace after the word */\n            strncat( reversed, &amp;string[i], 1 );\n            /* Chop the string off at the space */\n            string[i] = '\\0';\n        }\n    }\n\n    return reversed;\n}\n</code></pre>\n\n<p>This is the destructive version, <code>string</code> gets chopped up with null bytes. It's possible to do this non-destructively and I might edit it later.</p>\n\n<p>Since <code>input</code> and <code>reversed</code> are the same length, using <code>strcpy</code> with no bounds is safe.</p>\n\n<p>We can test this works and faithfully reproduces all the whitespace.</p>\n\n<pre><code>#include &lt;assert.h&gt;\n\nint main() {\n    char input[] = \" Hello  My\\tname is \";\n\n    char *reversed = reverse_by_word(input);\n    printf( \"'%s'\\n\", reversed );\n    assert( strcmp(reversed, \" is name\\tMy  Hello \") == 0 );\n}\n</code></pre>\n\n<hr>\n\n<p>Here's the non-destructive version. Basically the same idea, but instead of marking where we've already printed with null bytes, we remember it in <code>last_idx</code>.</p>\n\n<pre><code>char *reverse_by_word( const char *string ) {\n    size_t len = strlen(string);\n\n    char *reversed = malloc( len * sizeof(char) );\n    reversed[0] = '\\0';\n\n    /* Read the string backwards, character by characer */\n    int last_idx = (int)len;\n    for( int i = (int)len - 1; i &gt;= 0; i-- ) {\n        /* If we see a space... */\n        if( isspace( string[i] ) ) {\n            /* Add the word before it, stop at the last word we saw. */\n            strncat( reversed, &amp;string[i+1], last_idx - i - 1);\n            /* Faithfully reproduce the whitespace. */\n            strncat( reversed, &amp;string[i], 1 );\n\n            /* Remember the last place we printed up to. */\n            last_idx = i;\n        }\n    }\n\n    return reversed;\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7484656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d852a62081493d44d67578cccee4d91?s=128&d=identicon&r=PG&f=1", "display_name": "JsmileyJ", "link": "https://stackoverflow.com/users/7484656/jsmileyj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2743, "favorite_count": 0, "accepted_answer_id": 41970906, "answer_count": 1, "score": 2, "last_activity_date": 1485929662, "creation_date": 1485913606, "last_edit_date": 1485914979, "question_id": 41970634, "link": "https://stackoverflow.com/questions/41970634/print-contents-of-a-file-in-reverse-line-order", "title": "Print contents of a file in reverse line order", "body": "<p>So i've been running into issues trying to get my program to print output correctly. I have a text file with some content in it, and want to print it from the bottom up.</p>\n\n<pre><code>    fptr = fopen(\"file.txt\", \"r\");\n\n    fseek(fptr, 0, SEEK_END);\n    count = ftell(fptr);\n\n    while (i &lt; count)\n    {\n            i++;\n            fseek(fptr, -i, SEEK_END);\n            printf(\"%c\", fgetc(fptr));\n    }\n\n    printf(\"\\n\");\n    fclose(fptr);\n</code></pre>\n\n<p>A sample output from this would be</p>\n\n<p><strong>Input:</strong></p>\n\n\n\n<pre class=\"lang-none prettyprint-override\"><code>Hello\nMy name is\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre class=\"lang-none prettyprint-override\"><code>si eman yM\nolleH\n</code></pre>\n\n<p>What I want the output to be:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>My name is\nHello\n</code></pre>\n"}, {"tags": ["c", "printf", "fork"], "comments": [{"owner": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "edited": false, "score": 1, "creation_date": 1485911485, "post_id": 41970272, "comment_id": 71119026, "body": "Only twice, with that many fork calls!! Did you try adding some <code>printf</code>s to trace the control flow?"}, {"owner": {"reputation": 8090, "user_id": 4032392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "manishg", "link": "https://stackoverflow.com/users/4032392/manishg"}, "edited": false, "score": 1, "creation_date": 1485911535, "post_id": 41970272, "comment_id": 71119035, "body": "This looks like a school assignment to me. What&#39;s the purpose of this question?"}, {"owner": {"reputation": 103, "user_id": 4103270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86e373b859cc3b85f408870416ec98c2?s=128&d=identicon&r=PG&f=1", "display_name": "Doug LN", "link": "https://stackoverflow.com/users/4103270/doug-ln"}, "edited": false, "score": 0, "creation_date": 1485911692, "post_id": 41970272, "comment_id": 71119073, "body": "Yep, it&#39;s a school assignment. I have to identify how many times the text is printed."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1485912614, "post_id": 41970272, "comment_id": 71119309, "body": "<code>void main()</code> is an invalid signature for a hosted environment, invoking undefined behaviour. The simplest legal signature is <code>int main(void)</code>."}, {"owner": {"reputation": 103, "user_id": 4103270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86e373b859cc3b85f408870416ec98c2?s=128&d=identicon&r=PG&f=1", "display_name": "Doug LN", "link": "https://stackoverflow.com/users/4103270/doug-ln"}, "edited": false, "score": 0, "creation_date": 1485912677, "post_id": 41970272, "comment_id": 71119320, "body": "Paul Rooney I didn&#39;t add prints to trace, but it was a good idea."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 4103270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86e373b859cc3b85f408870416ec98c2?s=128&d=identicon&r=PG&f=1", "display_name": "Doug LN", "link": "https://stackoverflow.com/users/4103270/doug-ln"}, "edited": false, "score": 0, "creation_date": 1485912585, "post_id": 41970352, "comment_id": 71119300, "body": "ok elikatsis, I didn&#39;t know that each process had its own variable y with 0 value, That was the confusion. Thank you."}, {"owner": {"reputation": 439, "user_id": 7082135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac2bcd4d746c03f2a960fccd5b13e88?s=128&d=identicon&r=PG&f=1", "display_name": "elikatsis", "link": "https://stackoverflow.com/users/7082135/elikatsis"}, "reply_to_user": {"reputation": 103, "user_id": 4103270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86e373b859cc3b85f408870416ec98c2?s=128&d=identicon&r=PG&f=1", "display_name": "Doug LN", "link": "https://stackoverflow.com/users/4103270/doug-ln"}, "edited": false, "score": 0, "creation_date": 1485914306, "post_id": 41970352, "comment_id": 71119802, "body": "Have in mind that every forked process gets a copy of the parent&#39;s memory as it is right before the execution of fork! :-)"}], "tags": [], "owner": {"reputation": 439, "user_id": 7082135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac2bcd4d746c03f2a960fccd5b13e88?s=128&d=identicon&r=PG&f=1", "display_name": "elikatsis", "link": "https://stackoverflow.com/users/7082135/elikatsis"}, "is_accepted": true, "score": 4, "last_activity_date": 1485911755, "creation_date": 1485911755, "answer_id": 41970352, "question_id": 41970272, "link": "https://stackoverflow.com/questions/41970272/could-anyone-explain-why-this-fork-execution-prints-8-times-my-text/41970352#41970352", "title": "Could anyone explain why this fork execution prints 8 times my text?", "body": "<p><code>x = fork();</code> is executed and 2 processes are running.</p>\n\n<p><code>if (y&gt;0) fork();</code> will never be executed.</p>\n\n<p><code>if (x==0) y=fork();</code> will be executed by the child process so now there are 3 processes running. For the initial parent <code>y</code> is still <code>0</code>. For the child it's <code>y == child_child's pid</code> and for the child's child it's <code>y==0</code>.</p>\n\n<p>All 3 processes will execute <code>fork()</code> so there are 6 processes in total, 4 of these have <code>y==0</code> in their memory.</p>\n\n<p>These 4 processes fork again, so there are 8 processes and they execute that <code>printf(...);</code></p>\n"}, {"tags": [], "owner": {"reputation": 1104, "user_id": 6296060, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZ37JUkP1Pw/AAAAAAAAAAI/AAAAAAAAAYw/Fp6BfZuv7Ho/photo.jpg?sz=128", "display_name": "greedy52", "link": "https://stackoverflow.com/users/6296060/greedy52"}, "is_accepted": false, "score": 1, "last_activity_date": 1485913925, "last_edit_date": 1485913925, "creation_date": 1485912963, "answer_id": 41970531, "question_id": 41970272, "link": "https://stackoverflow.com/questions/41970272/could-anyone-explain-why-this-fork-execution-prints-8-times-my-text/41970531#41970531", "title": "Could anyone explain why this fork execution prints 8 times my text?", "body": "<p>I modify the code to have more debugging print.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"unistd.h\"\nint main() {\n    pid_t x=0;\n    pid_t y=0;\n\n    printf(\"FORK X \\n\");\n    x=fork();\n\n    if(y&gt;0) {\n        printf(\"FORK 1 \\n\");\n        fork();\n    }\n\n    if(x==0) {\n        printf(\"FORK 2 \\n\");\n        y=fork();\n    }\n\n    printf(\"FORK 3 \\n\");\n    fork();\n    if(y==0){\n        printf(\"FORK 4 \\n\");\n        fork();\n        printf(\"Some text\\n\");\n    }\n}\n</code></pre>\n\n<p>Here is the output, and every \"FORK 4\" will result TWO \"Some text\" since there is a fork afterwards:</p>\n\n<p>Pancake:tmp greedy52$ ./a.out </p>\n\n<pre><code>FORK X \nFORK 3 \nFORK 4 \nFORK 2 \nFORK 4 \nSome text\nSome text\nFORK 3 \nFORK 3 \nSome text\nSome text\nFORK 4 \nSome text\nFORK 4 \nSome text\nSome text\nSome text\n</code></pre>\n\n<p>The 4 \"FORK 4\" are reached by (each successful fork() call creates two process A and B):</p>\n\n<ol>\n<li>@x=fork() -> x != 0 and @FORK 3 fork A</li>\n<li>@x=fork() -> x != 0 and @FORK 3 fork B</li>\n<li>@x=fork() -> x = 0 and @y=fork() -> y = 0 and @FORK 3 fork A</li>\n<li>@x=fork() -> x = 0 and @y=fork() -> y = 0 and @FORK 3 fork B</li>\n</ol>\n\n<p>The @x=fork() -> x = 0 and @y=fork() -> y!= 0 branch doesn't generate any \"Some text\".</p>\n\n<pre><code>FORK X --------&gt; x != 0 -------------------------------&gt; FORK 3 A -----&gt; FORK 4 A (Some text)\n          |              |                                          |--&gt; FORK 4 B (Some text)\n          |              |\n          |              |-----------------------------&gt; FORK 3 B -----&gt; FORK 4 A (Some text)\n          |                                                         |--&gt; FORK 4 B (Some text)\n          |\n          |\n          |----&gt; x == 0 -----&gt; FORK 2 A ( y = 0 ) -----&gt; FORK 3 A -----&gt; FORK 4 A (Some text)\n                         |                                          |--&gt; FORK 4 B (Some text)\n                         |                         |---&gt; FORK 3 B -----&gt; FORK 4 A (Some text)\n                         |                                          |--&gt; FORK 4 B (Some text)\n                         |\n                         |---&gt; FORK 2 B (y != 0 ) -----&gt; FORK 3 A -----&gt; XXX bad end\n                                                   |---&gt; FORK 3 B -----&gt; XXX bad end\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 4103270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86e373b859cc3b85f408870416ec98c2?s=128&d=identicon&r=PG&f=1", "display_name": "Doug LN", "link": "https://stackoverflow.com/users/4103270/doug-ln"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 41970352, "answer_count": 2, "score": 4, "last_activity_date": 1485913925, "creation_date": 1485911158, "last_edit_date": 1485912734, "question_id": 41970272, "link": "https://stackoverflow.com/questions/41970272/could-anyone-explain-why-this-fork-execution-prints-8-times-my-text", "title": "Could anyone explain why this fork execution prints 8 times my text?", "body": "<p>I can't understand why it prints 8 times the text. In my conception it should prints just 2 times.\nCould anynone help me?</p>\n\n<p>The code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint main(void) {\n    pid_t x=0;\n    pid_t y=0;\n    x=fork();\n    if(y&gt;0)\n        fork();\n    if(x==0)\n        y=fork();\n    fork();\n    if(y==0){\n        fork();\n        printf(\"Some text\\n\");\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "linker", "clang", "libtool"], "answers": [{"tags": [], "owner": {"reputation": 67, "user_id": 4798333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-O2BEtlZF_KI/AAAAAAAAAAI/AAAAAAAAAPg/9AWdyvIoFXM/photo.jpg?sz=128", "display_name": "LT &#39;syreal&#39; Jones", "link": "https://stackoverflow.com/users/4798333/lt-syreal-jones"}, "is_accepted": true, "score": 0, "last_activity_date": 1486199830, "creation_date": 1486199830, "answer_id": 42038584, "question_id": 41969962, "link": "https://stackoverflow.com/questions/41969962/libtool-clang-let-me-pass-arguments-to-compiler-but-not-linker/42038584#42038584", "title": "Libtool/clang: let me pass arguments to compiler but not linker", "body": "<p>I was trying to avoid this but I ended up modifying the libtool script to drop -mllvm like the other obfuscation options during linking.</p>\n\n<pre><code>sed -i \"s/-m\\*|/-mtune=*|-march=*|-mcpu=*|-mfpmath=*|-masm=*|-mieee-fp|-mno-ieee-fp|-msoft-float|-mno-fp-ret-in-387|-mno-fancy-math-387|-malign-double|-mno-align-double|-m96bit-long-double|-m128bit-long-double|-mlarge-data-threshold=*|-mrtd|-mregparm=*|-msseregparm|-mpc32|-mpc64|-mpc80|-mstackrealign|-mpreferred-stack-boundary=*|-mincoming-stack-boundary=*|-mmmx|-mno-mmx|-msse|-mno-sse|-msse2|-mno-sse2|-msse3|-mno-sse3|-mssse3|-mno-ssse3|-msse4.1|-mno-sse4.1|-msse4.2|-mno-sse4.2|-msse4|-mno-sse4|-mavx|-mno-avx|-maes|-mno-aes|-mpclmul|-mno-pclmul|-msse4a|-mno-sse4a|-mfma4|-mno-fma4|-mxop|-mno-xop|-mlwp|-mno-lwp|-m3dnow|-mno-3dnow|-mpopcnt|-mno-popcnt|-mabm|-mno-abm|-mfused-madd|-mno-fused-madd|-mcld|-mcx16|-msahf|-mmovbe|-mcrc32|-mrecip|-mveclibabi=*|-mabi=*|-mpush-args|-mno-push-args|-maccumulate-outgoing-args|-mthreads|-mno-align-stringops|-minline-all-stringops|-minline-stringops-dynamically|-mstringop-strategy=*|-momit-leaf-frame-pointer|-mtls-direct-seg-refs|-mno-tls-direct-seg-refs|-msse2avx|-mno-sse2avx|-m32|-m64|-mno-red-zone|-mcmodel=*|-mcmodel=*|-mcmodel=*|-mcmodel=*|/g\" libtool\n</code></pre>\n\n<p>Basically, expand -m* with every possible value from the gcc manual, minus -mllvm which is solely a clang thing. Now I can automatically compile <a href=\"https://github.com/syreal17/vlc\" rel=\"nofollow noreferrer\">vlc</a> with arbitrary invocations using different compilers as part of the <a href=\"https://github.com/syreal17/Chimera\" rel=\"nofollow noreferrer\">Chimera</a> corpus.</p>\n"}], "owner": {"reputation": 67, "user_id": 4798333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-O2BEtlZF_KI/AAAAAAAAAAI/AAAAAAAAAPg/9AWdyvIoFXM/photo.jpg?sz=128", "display_name": "LT &#39;syreal&#39; Jones", "link": "https://stackoverflow.com/users/4798333/lt-syreal-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1065, "favorite_count": 0, "accepted_answer_id": 42038584, "answer_count": 1, "score": 0, "last_activity_date": 1486199830, "creation_date": 1485908734, "question_id": 41969962, "link": "https://stackoverflow.com/questions/41969962/libtool-clang-let-me-pass-arguments-to-compiler-but-not-linker", "title": "Libtool/clang: let me pass arguments to compiler but not linker", "body": "<p>I'm obfuscating many GitHub projects with <a href=\"https://github.com/syreal17/obfuscator\" rel=\"nofollow noreferrer\">o-llvm</a>. It's a compile time linker implemented in clang. With o-llvm, I'm trying to compile/obfuscate a GitHub project that uses libtool, but the flags needed to specify the obfuscation transform mess up the linker.</p>\n\n<p>The extra flags that I'm passing in are like:</p>\n\n<pre><code>/path/to/obfuscator/clang -O0 -mllvm -bcf -mllvm -boguscf-loop=1 -mllvm -ann\n</code></pre>\n\n<p>-bcf means apply bogus control flow transformation, -boguscf-loop limits how many times it runs per basic block and -ann indicates to annotate the basic blocks with printf statements.</p>\n\n<p>At first, I tried doing this at the make step after configure:</p>\n\n<pre><code>make CC=/path/to/obfuscator/clang CFLAGS=\"-O0 -mllvm -bcf -mllvm -boguscf-loop=1 -mllvm -ann\n</code></pre>\n\n<p>But then gcc was the linker and it failed because it did not know the \"-mllvm\" option. Libtool also automatically removed the \"-bcf\" \"-boguscf-loop=1\" and \"-ann\" options</p>\n\n<p>In another project, dropping back to configure and specifying CFLAGS in CC worked:</p>\n\n<pre><code>./configure CC=\"/path/to/obfuscator/clang -O0 -mllvm -bcf -mllvm -boguscf-loop=1 -mllvm -ann\"\n</code></pre>\n\n<p>This makes the \"linker\" be clang, which recognizes the \"-mllvm\" option, but libtool removing the corresponding flags still messes up the invocation:</p>\n\n<pre><code>[...] -O0 -mllvm -mllvm -mllvm -Wl,-z -Wl,defs   -Wl,-soname [...]\nclang: warning: argument unused during compilation: '-mllvm -bcf'\nclang: warning: argument unused during compilation: '-mllvm -boguscf-loop=1'\nclang: warning: argument unused during compilation: '-mllvm -ann'\nclang: warning: argument unused during compilation: '-mllvm -mllvm'\nclang: warning: argument unused during compilation: '-mllvm -Wl,-z'\n/usr/bin/ld: error: cannot open defs: No such file or directory\n</code></pre>\n\n<p>I tried prepending my compiler-only arguments with -Wc,<em>flag</em> or -Xcompile but clang recognizes neither of those.</p>\n\n<p>Is there some other way to tell Libtool or Clang to only use the obfuscation arguments for compilation and not linking?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "sockets", "posix"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1485911341, "post_id": 41969868, "comment_id": 71119001, "body": "Once <code>connect()</code> fails, there is no guarantee that it can be called again on the same socket. It is usually best to destroy and recreate the socket on each <code>connect()</code> attempt.  However, either way, once <code>connect()</code> is successful, your client is not closing the connected socket before calling <code>connect()</code> again on the next loop iteration."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1486209727, "post_id": 41969868, "comment_id": 71253686, "body": "If you remove all error handling from the code how can you possibly expect to be able to debug it? This is not a rational strategy. It also isn&#39;t an answerable question until you provide an error code, and you can&#39;t do that until you put the error handling back; and you can&#39;t prove there was no error code until ditto."}], "answers": [{"tags": [], "owner": {"reputation": 8411, "user_id": 1410465, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/jIdfh.png?s=128&g=1", "display_name": "svarog", "link": "https://stackoverflow.com/users/1410465/svarog"}, "is_accepted": true, "score": 2, "last_activity_date": 1486209157, "creation_date": 1486209157, "answer_id": 42040022, "question_id": 41969868, "link": "https://stackoverflow.com/questions/41969868/c-posix-sockets-cant-send-data-from-client-to-server/42040022#42040022", "title": "C posix sockets, can&#39;t send data from client to server", "body": "<p>I don't know just how you've compiled your code but if you had set up the warning flag (<code>-Wall</code> in gcc) you would have gotten this warning </p>\n\n<pre><code>server.c: In function \u2018main\u2019:\nserver.c:33:44: warning: suggest parentheses around assignment used as truth value [-Wparentheses]\n if (newsockfd = accept(sockfd, (struct sockaddr *) &amp;cli_addr,&amp;clilen) &gt;= 0) {\n</code></pre>\n\n<p>Acting by it, I changed, this .. </p>\n\n<pre><code>if (newsockfd = accept(sockfd, (struct sockaddr *) &amp;cli_addr,&amp;clilen) &gt;= 0) {\n</code></pre>\n\n<p>To .. (notice the extra parentheses)</p>\n\n<pre><code>if ((newsockfd = accept(sockfd, (struct sockaddr *) &amp;cli_addr,&amp;clilen)) &gt;= 0) {\n</code></pre>\n\n<p>I got no more additional warnings, and the server caught the client's message.</p>\n\n<p>Here is the server I ran while debugging this (This is basically your code with slight alterations)</p>\n\n<pre><code>int sockfd, newsockfd;\nsocklen_t clilen;\nchar buffer[256];\nint nbytes = 0;\nstruct sockaddr_in serv_addr, cli_addr;\nsockfd = socket(AF_INET, SOCK_STREAM, 0);\nserv_addr.sin_family = AF_INET;\n//serv_addr.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\nserv_addr.sin_addr.s_addr = INADDR_ANY;\nserv_addr.sin_port = htons(5007);\nbind(sockfd, (struct sockaddr *) &amp;serv_addr, sizeof(serv_addr));\n\n\nif (listen(sockfd, 5) &lt;0) { }\n\nclilen = sizeof(cli_addr);\nif ((newsockfd = accept(sockfd, (struct sockaddr *) &amp;cli_addr,&amp;clilen)) &gt;= 0) { \n\n    while ((nbytes = read(newsockfd, buffer, sizeof(buffer)))&lt;0) {\n        sleep(1);\n    }\n\n    printf(\"client sent: %s\", buffer);\n}\nclose(newsockfd);\nclose(sockfd);\nreturn 0;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8411, "user_id": 1410465, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/jIdfh.png?s=128&g=1", "display_name": "svarog", "link": "https://stackoverflow.com/users/1410465/svarog"}, "edited": false, "score": 0, "creation_date": 1486283931, "post_id": 42049782, "comment_id": 71272559, "body": "you should only have one socket and reuse it (unless you want to concurrently connect to more than 1 server point) you are also not breaking properly from the while loop so you will never have the chance to properly close your sockets. it will hurt your testing because you will have to wait for the OS to free that port after you exit"}], "tags": [], "owner": {"reputation": 179, "user_id": 3735495, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cc64218c69712d3cc371d5ceff48d242?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir", "link": "https://stackoverflow.com/users/3735495/vladimir"}, "is_accepted": false, "score": 0, "last_activity_date": 1486281666, "creation_date": 1486281666, "answer_id": 42049782, "question_id": 41969868, "link": "https://stackoverflow.com/questions/41969868/c-posix-sockets-cant-send-data-from-client-to-server/42049782#42049782", "title": "C posix sockets, can&#39;t send data from client to server", "body": "<p>Another problem was that we have to create socket each time we do connect in client, like:</p>\n\n<pre><code>while (1) {\n    sockfd = socket(AF_INET, SOCK_STREAM, 0);\n    while ((connect(sockfd,(struct sockaddr *)  &amp;serv_addr,sizeof(serv_addr)) &lt; 0)) {\n       printf(\"trying to connect\\n\");\n       sleep(1);\n    }\n    printf(\"connected\\nplease, enter a message\\n\");\n    scanf(\"%s\", buffer);\n     write(sockfd, buffer, strlen(buffer));\n}\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 3735495, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cc64218c69712d3cc371d5ceff48d242?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir", "link": "https://stackoverflow.com/users/3735495/vladimir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 42040022, "answer_count": 2, "score": 0, "last_activity_date": 1486281666, "creation_date": 1485908096, "last_edit_date": 1486210320, "question_id": 41969868, "link": "https://stackoverflow.com/questions/41969868/c-posix-sockets-cant-send-data-from-client-to-server", "title": "C posix sockets, can&#39;t send data from client to server", "body": "<p>I want to make a client and connect it to a server. I know that client process starts running before server so I do connection in infinite loop until it will be accept. Then I want to enter messages to client and send them to server, which will print them on screen. I removed all error detection from code to make it shorter, I know they have to be there. I am trying to do it like this, but server receives nothing and client can't do second connection.</p>\n\n<p><strong><em>Server</em></strong></p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    int sockfd, newsockfd;\n    socklen_t clilen;\n    char buffer[256];\n    struct sockaddr_in serv_addr, cli_addr;\n    sockfd = socket(AF_INET, SOCK_STREAM, 0);\n    serv_addr.sin_family = AF_INET;\n    serv_addr.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\n    serv_addr.sin_port = htons(5000);\n    bind(sockfd, (struct sockaddr *) &amp;serv_addr, sizeof(serv_addr));\n    listen(sockfd, 5);\n    clilen = sizeof(cli_addr);\n    while (newsockfd = accept(sockfd, (struct sockaddr *) &amp;cli_addr,&amp;clilen) &gt;= 0)\n    {\n        read(newsockfd, buffer, 255);\n        close(newsockfd);\n    }\n    close(sockfd);\n    return 0;\n}\n</code></pre>\n\n<p><strong><em>Client</em></strong></p>\n\n<pre><code>int main(int argc, char *argv[])\n    {\n    int sockfd;\n    struct sockaddr_in serv_addr;\n\n    char buffer[256];\n    sockfd = socket(AF_INET, SOCK_STREAM, 0);\n    serv_addr.sin_family = AF_INET;\n    serv_addr.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\n    serv_addr.sin_port = htons(5000);\n    while (1) {\n        while ((connect(sockfd,(struct sockaddr *)  &amp;serv_addr,sizeof(serv_addr)) &lt; 0)) {\n           printf(\"trying to connect\\n\");\n           sleep(1);\n        }\n        printf(\"connected\\nplease, enter a message\\n\");\n        scanf(\"%s\", buffer);\n        write(sockfd, buffer, strlen(buffer));\n    }\n    close(sockfd);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["java", "c", "thrift"], "comments": [{"owner": {"reputation": 2002, "user_id": 814304, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bb5a57aef64da898ac42004c1b4054a5?s=128&d=identicon&r=PG", "display_name": "iMysak", "link": "https://stackoverflow.com/users/814304/imysak"}, "edited": false, "score": 0, "creation_date": 1485908590, "post_id": 41969640, "comment_id": 71118302, "body": "do you reuse connection from C client or create new one each time ? After server been hang - can you check open connections ? something like   sudo netstat -anp | grep :&lt;server_port&gt; in *nix"}, {"owner": {"reputation": 19, "user_id": 7112656, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MhWPeQsk5pU/AAAAAAAAAAI/AAAAAAAAOZk/9wpTC1nTPHI/photo.jpg?sz=128", "display_name": "Mahesh Datt", "link": "https://stackoverflow.com/users/7112656/mahesh-datt"}, "reply_to_user": {"reputation": 2002, "user_id": 814304, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bb5a57aef64da898ac42004c1b4054a5?s=128&d=identicon&r=PG", "display_name": "iMysak", "link": "https://stackoverflow.com/users/814304/imysak"}, "edited": false, "score": 0, "creation_date": 1485917282, "post_id": 41969640, "comment_id": 71120545, "body": "attached the netstat data to the question. My java server is running on 9090. Earlier I was re-using the connections but just to rule out the stale connection issue, now I open/close connection every time. But in both cases I observe the server hang issue."}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 7112656, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MhWPeQsk5pU/AAAAAAAAAAI/AAAAAAAAOZk/9wpTC1nTPHI/photo.jpg?sz=128", "display_name": "Mahesh Datt", "link": "https://stackoverflow.com/users/7112656/mahesh-datt"}, "is_accepted": false, "score": 0, "last_activity_date": 1486074744, "creation_date": 1486074744, "answer_id": 42013566, "question_id": 41969640, "link": "https://stackoverflow.com/questions/41969640/thrift-java-tnonblockingserver-hangs-randomly/42013566#42013566", "title": "Thrift Java TNonBlockingServer hangs randomly", "body": "<p>I m going to close this issue since this may not be related to Thrift. Will add any details if I get it later.</p>\n"}], "owner": {"reputation": 19, "user_id": 7112656, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MhWPeQsk5pU/AAAAAAAAAAI/AAAAAAAAOZk/9wpTC1nTPHI/photo.jpg?sz=128", "display_name": "Mahesh Datt", "link": "https://stackoverflow.com/users/7112656/mahesh-datt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1486074744, "creation_date": 1485906668, "last_edit_date": 1485917208, "question_id": 41969640, "link": "https://stackoverflow.com/questions/41969640/thrift-java-tnonblockingserver-hangs-randomly", "title": "Thrift Java TNonBlockingServer hangs randomly", "body": "<p>I have a Thrift server implemented in Java like the following:    </p>\n\n<pre><code>TNonblockingServerTransport serverTransport = new TNonblockingServerSocket(getThriftPort(), 100);\n\nTServer tserver = new TNonblockingServer(new TNonblockingServer.Args(serverTransport).processor(processor)\n                    .inputProtocolFactory(new TBinaryProtocol.Factory())\n                    .outputProtocolFactory(new TBinaryProtocol.Factory())\n                    .transportFactory(new TFramedTransport.Factory()));\n</code></pre>\n\n<p>And my client is implemented in C. This server is primary used to serve bytes from the disk. The requests seem to be answered for a while before the server decides to hang randomly. Any tips on how I can debug this further? </p>\n\n<p>After the process is stuck, if I run netstat, I see the data like the following: </p>\n\n<pre><code>tcp        0      0 0.0.0.0:9090            0.0.0.0:*               LISTEN      186002/java     \ntcp        0      0 127.0.0.1:9090          127.0.0.1:51813             ESTABLISHED 186002/java     \ntcp        0      0 127.0.0.1:51814         127.0.0.1:9090          ESTABLISHED 186210/client \ntcp        0      0 127.0.0.1:51813         127.0.0.1:9090          ESTABLISHED 186210/client \ntcp        1      0 127.0.0.1:52515         127.0.0.1:9090          CLOSE_WAIT  -               \ntcp        1      0 127.0.0.1:52514         127.0.0.1:9090          CLOSE_WAIT  -               \ntcp       51      0 127.0.0.1:9090          127.0.0.1:51814         ESTABLISHED - \n</code></pre>\n"}, {"tags": ["c", "arrays", "function", "output"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1485906462, "post_id": 41969575, "comment_id": 71117637, "body": "<code>PopulateRandom</code> has no function prototype (forward reference), therefore the compiler can only make assumptions about its argument and return types."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 0, "creation_date": 1485906653, "post_id": 41969575, "comment_id": 71117705, "body": "... and <code>array[int M...</code> is not correct. Did you mean <code>int PopulateRandom(int array[M * N])</code>?"}, {"owner": {"reputation": 75, "user_id": 7021861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/be3f3faf9416a24e79a4175663f5e3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Shoaib Ahmed", "link": "https://stackoverflow.com/users/7021861/shoaib-ahmed"}, "edited": false, "score": 0, "creation_date": 1485906727, "post_id": 41969575, "comment_id": 71117732, "body": "Sorry, which line number are you refering too?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1485909857, "post_id": 41969575, "comment_id": 71118654, "body": "@Shoaib Ahmed  Where is there the 2D array?:)"}], "answers": [{"tags": [], "owner": {"reputation": 1287, "user_id": 5767099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1144731518892203/picture?type=large", "display_name": "Claudio Cortese", "link": "https://stackoverflow.com/users/5767099/claudio-cortese"}, "is_accepted": false, "score": 0, "last_activity_date": 1485908354, "last_edit_date": 1485908354, "creation_date": 1485907395, "answer_id": 41969751, "question_id": 41969575, "link": "https://stackoverflow.com/questions/41969575/printing-random-elements-of-an-array-in-c/41969751#41969751", "title": "Printing random elements of an array in C", "body": "<p>The compiler is complaining about the implicit declaration of function <code>PopulateRandom</code> because you are calling it before declaring/defining it before. Simply define <code>PopulateRandom</code> before calling it in <code>PrintArray2D</code>.\nRegarding that, you may find <a href=\"https://en.m.wikipedia.org/wiki/Scope_(computer_science)\" rel=\"nofollow noreferrer\">this</a> interesting.\nThe second problem may be caused by this line of code : </p>\n\n<pre><code>while(i = 0; i &lt; M*N; i++)\n</code></pre>\n\n<p>If you want to concatenate more conditions you should use either logical and (&amp;&amp;) <em>or/and</em> logical or (||).</p>\n\n<p>The way you used this while loop make that's not the right one.\nThe while loop is not the for-loop, the syntax is different. </p>\n\n<p>for-loop syntax :</p>\n\n<pre><code>for (init; condition; increment)\n</code></pre>\n\n<p>While-loop syntax :</p>\n\n<pre><code>while (cond1 &amp;&amp; cond2 || cond3)\n</code></pre>\n\n<p>Other problem I can see are :</p>\n\n<ul>\n<li>The switch case:\nYou <em>should</em> drop in a <code>default</code>, just in case.\nAlso you <strong>ALWAYS</strong> have to break cases. You didn't break <code>case 1</code>.</li>\n</ul>\n\n<p>General syntax of <code>switch statement</code> :</p>\n\n<pre><code>switch  (x)\n{\n      case 1 :\n             break;\n\n      case n :\n              break;\n\n      default:\n              break;\n}\n</code></pre>\n\n<ul>\n<li><p>In <code>PopulateRandom</code>:</p>\n\n<p><code>int array[int M * int N]</code></p>\n\n<p>should be </p>\n\n<p><code>int array []</code></p>\n\n<p>or</p>\n\n<p><code>int *array</code></p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1485912217, "creation_date": 1485912217, "answer_id": 41970414, "question_id": 41969575, "link": "https://stackoverflow.com/questions/41969575/printing-random-elements-of-an-array-in-c/41970414#41970414", "title": "Printing random elements of an array in C", "body": "<p>In this function</p>\n\n<pre><code>int PrintArray2D(int M, int N){\n    int array[M*N], row, column, i;\n\n    while(row &lt;= M &amp;&amp; column &lt;= N){\n    for(row = 0; row &lt;= M; row++){\n        for(column = 0; column &lt;= N; column++){\n            array[i] = PopulateRandom(array[M * N]);\n            printf(\"%d\", array[i]);\n            if(column == 4){\n                break;\n            }\n        }\n        column = 0;\n        printf(\"\\n\");\n        }\n    }\n    return array[i];\n}\n</code></pre>\n\n<p>variables <code>row</code>, <code>column</code> and <code>i</code> are not initialized</p>\n\n<pre><code>int array[M*N], row, column, i;\n                ^^^^^^^^^^^^^^\n</code></pre>\n\n<p>however as such they are used correspondingly in the loop</p>\n\n<pre><code>while(row &lt;= M &amp;&amp; column &lt;= N){\n</code></pre>\n\n<p>and in this expression statement</p>\n\n<pre><code>array[i] = PopulateRandom(array[M * N]);\n</code></pre>\n\n<p>Also in this statement there is used name <code>PopulateRandom</code> in the function call postfix expression that was not declared yet. And moreover in this expression <code>array[M * N]</code> there is an attempt to access memory beyond the array. </p>\n\n<p>It is not clear what this magic number 4 means in this statement</p>\n\n<pre><code>if(column == 4){\n            ^^^\n</code></pre>\n\n<p>Also it is entirely unclear what is the meaning of this return statement with uninitialized variable <code>i</code></p>\n\n<pre><code>return array[i];\n</code></pre>\n\n<p>This function declaration</p>\n\n<pre><code>int PopulateRandom(int array[int M * int N]){\n    int i;\n\n    while(i = 0; i &lt; M*N; i++){\n    array[i] = rand() % (M*N);\n    }\n    return array[i];\n}\n</code></pre>\n\n<p>is invalid. You could write for example</p>\n\n<pre><code>int PopulateRandom(int M, int N, int array[M * N]){\n//...\n</code></pre>\n\n<p>Again it is not clear the purpose of the return statement</p>\n\n<pre><code>return array[i];\n</code></pre>\n\n<p>that tries to return a non-existent element of the array.</p>\n\n<p>In the switch statement for the label <code>case 1:</code> you should append <code>break</code> statement.</p>\n\n<p>The loop can be written for example the following way</p>\n\n<pre><code>do\n{\n    printf(\"If you would like to search an array, enter 1 \\n: \");\n    //                                  ^^^ \n    printf(\"If you would like to exit, enter 0 \\n: \");\n\n    option = 0;\n    scanf(\"%d\", &amp;option);\n\n    switch( option )\n    {\n        case 1: \n        {\n            printf(\"Enter two numbers M and N: \");                          \n            scanf(\"%d %d\", &amp;M, &amp;N);\n            int a[M][N];\n            PrintArray2D( M, N, a );\n            break;\n        }\n    }\n} while ( option != 0 );\n</code></pre>\n\n<p>The functions themselves can be written as it is shown in the following demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nvoid PopulateRandom( int m, int n, int a[static const  m * n] )\n{\n    const int N = m * n;\n\n    srand( ( unsigned int )time( NULL ) );\n\n    for( int i = 0; i &lt; N; i++ ) a[i] = rand() % N; \n}\n\nvoid PrintArray2D( int m, int n, int a[static const m * n] )\n{\n    PopulateRandom( m, n, a );\n\n    for ( int i = 0; i &lt; m; i++ )\n    {\n        for ( int j = 0; j &lt; n; j++ )\n        {\n            printf( \"%3d \", a[i * n + j] );\n        }\n        printf( \"\\n\" );\n    }\n}\n\nint main(void) \n{\n    int m = 2;\n    int n = 3;\n    int a[m * n];\n\n    PrintArray2D( m, n, a );\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output might look like</p>\n\n<pre><code>  1   2   2 \n  3   5   0 \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7497229, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1nCH4.jpg?s=128&g=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/7497229/phantom"}, "reply_to_user": {"reputation": 1287, "user_id": 5767099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1144731518892203/picture?type=large", "display_name": "Claudio Cortese", "link": "https://stackoverflow.com/users/5767099/claudio-cortese"}, "edited": false, "score": 0, "creation_date": 1485950107, "post_id": 41970681, "comment_id": 71135833, "body": "I have comment before function, SWITCH isn&#39;t usefull, he can only use IF. while (option != 0){ if (option == 1){"}, {"owner": {"reputation": 1287, "user_id": 5767099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1144731518892203/picture?type=large", "display_name": "Claudio Cortese", "link": "https://stackoverflow.com/users/5767099/claudio-cortese"}, "edited": false, "score": 0, "creation_date": 1485950802, "post_id": 41970681, "comment_id": 71136311, "body": "Right, my bad. I read that very early this morning and was a little bit confused! I&#39;m going to delete my comment, as it&#39;s not useful to anyone"}], "tags": [], "owner": {"reputation": 1, "user_id": 7497229, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1nCH4.jpg?s=128&g=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/7497229/phantom"}, "is_accepted": false, "score": 0, "last_activity_date": 1485913959, "creation_date": 1485913959, "answer_id": 41970681, "question_id": 41969575, "link": "https://stackoverflow.com/questions/41969575/printing-random-elements-of-an-array-in-c/41970681#41970681", "title": "Printing random elements of an array in C", "body": "<p>It's my first answer in this forum. Be gentle with my explications or corrections. Have a nice day !\n(It's more simple of just comment prog)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n/*\n-You need to use prototype or just set function \"int PopulateRandom\" before \"int PrintArray2D\"\n-Try to change your way to process at this application, it's really so complicated.\n-Try to use debug for understand what is going on your program.\n*/\n\nint PrintArray2D(int M, int N){\n    int array[M*N], row, column, i; // Use \"static int\" for row, column and i for auto init at 0, or do it manually. \n\n    while(row &lt;= M &amp;&amp; column &lt;= N){ // Like i have said in top, you use variable but they're not initialized\n    for(row = 0; row &lt;= M; row++){\n        for(column = 0; column &lt;= N; column++){\n            array[i] = PopulateRandom(array[M * N]); // use directly \"array[i] = (int) rand();\" for change with random value\n            printf(\"%d\", array[i]); // you can directly print a random value, you save value, but when you leave this function, your array is destroy.\n            if(column == 4){\n                break;\n            }\n        }\n        column = 0;\n        printf(\"\\n\");\n        }\n    }\n    return array[i]; // return is useless for your usage, becaus you don't catch return value in your main. (void PrintArray2D if no return)\n}\n\n/*\n-Your function need other params : int array[], int M, int N (don't forget to send M and N when you call this function)\n-You need to change your algo, because this function take M and N for change just ONE element of this array.\n-This function is useless in this context, check comment in \"PrintArray2D\" for more informations\n*/\nint PopulateRandom(int array[int M * int N]){\n    int i;\n\n    while(i = 0; i &lt; M*N; i++){ // It's a FOR and not WHILE\n    array[i] = rand() % (M*N);\n    }\n    return array[i];\n}\n\n/*\n-Duplicate code isn't good, you can use printf and scanf just one time, just after your while, and set option = 1 before.\n-Donc use case, but just an if, because your condition in your while check the value.\n*/\nint main(void){\n    int option, M, N;\n\n    printf(\"If you would like to search ann array, enter 1 \\n: \");\n    printf(\"If you would like to exit, enter 0 \\n: \");\n    scanf(\"%d\", &amp;option);\n\n    while(option != 0){\n    switch(option){\n        case 1: if(option == 1){\n                printf(\"Enter two numbers M and N: \");                          \n                scanf(\"%d %d\", &amp;M, &amp;N);\n                PrintArray2D(M, N);\n        }\n        case 0: if(option == 0){\n            break;\n        }\n    }\n    printf(\"If you would like to search ann array, enter 1 \\n: \");\n    printf(\"If you would like to exit, enter 0 \\n: \");\n    scanf(\"%d\", &amp;option);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 7021861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/be3f3faf9416a24e79a4175663f5e3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Shoaib Ahmed", "link": "https://stackoverflow.com/users/7021861/shoaib-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 298, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1485923002, "creation_date": 1485906306, "last_edit_date": 1485923002, "question_id": 41969575, "link": "https://stackoverflow.com/questions/41969575/printing-random-elements-of-an-array-in-c", "title": "Printing random elements of an array in C", "body": "<p>I have written a program that has M*N elements where variables M and N are entered by the user. The program prints the elements in an M x N table and assigns random values to each element. When I try compiling the program, two errors keep popping up. The first says that there is a implicit declaration of function \"PopulateRandom\" in line 12. The second message says that there is a missing expression expected before \"int\" in line 25.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n// Prints elements of array in a M x N table\nint PrintArray2D(int M, int N){\n    int array[M*N], row, column, i;\n\n    while(row &lt;= M &amp;&amp; column &lt;= N){\n    for(row = 0; row &lt;= M; row++){\n        for(column = 0; column &lt;= N; column++){\n            array[i] = PopulateRandom(array[M * N]);\n            printf(\"%d\", array[i]);\n            if(column == 4){\n                break;\n            }\n        }\n        column = 0;\n        printf(\"\\n\");\n        }\n    }\n    return array[i];\n}\n\n//Assigns elements of the array \"array\" random values\nint PopulateRandom(int array[int M * int N]){\n    int i;\n\n    while(i = 0; i &lt; M*N; i++){\n    array[i] = rand() % (M*N);\n    }\n    return array[i];\n}\n\nint main(void){\n    int option, M, N;\n\n    printf(\"If you would like to search ann array, enter 1 \\n: \");\n    printf(\"If you would like to exit, enter 0 \\n: \");\n    scanf(\"%d\", &amp;option);\n\n    while(option != 0){\n    switch(option){\n        case 1: if(option == 1){\n                printf(\"Enter two numbers M and N: \");                          \n                scanf(\"%d %d\", &amp;M, &amp;N);\n                PrintArray2D(M, N);\n        }\n        case 0: if(option == 0){\n            break;\n        }\n    }\n    printf(\"If you would like to search ann array, enter 1 \\n: \");\n    printf(\"If you would like to exit, enter 0 \\n: \");\n    scanf(\"%d\", &amp;option);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "sockets", "udp"], "comments": [{"owner": {"reputation": 21, "user_id": 7363654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b5641a3ea1b4599b7bf29721d28d1e?s=128&d=identicon&r=PG&f=1", "display_name": "RSH2000", "link": "https://stackoverflow.com/users/7363654/rsh2000"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1485907770, "post_id": 41969421, "comment_id": 71118060, "body": "Yes, and I set PORT_REUSE option to 0 to be able to track the response from the server. so each send involves a call to socket(), bind() and sendto() functions. The times shown in the graph is only for sendto() call. bind() and socket calls usually takes around 7 usec."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1485908136, "post_id": 41969421, "comment_id": 71118173, "body": "Why? Why not use the same socket for the life of the application?"}, {"owner": {"reputation": 21, "user_id": 7363654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b5641a3ea1b4599b7bf29721d28d1e?s=128&d=identicon&r=PG&f=1", "display_name": "RSH2000", "link": "https://stackoverflow.com/users/7363654/rsh2000"}, "edited": false, "score": 0, "creation_date": 1485908465, "post_id": 41969421, "comment_id": 71118267, "body": "That&#39;s because of the nature of the application, the application should be able to measure the round trip time for each packet. Initially i was reusing the ports but it caused conflict for the measurements. When the response to two requests sent from the same port were arriving out of order, my application didn`t have a mechanism to figure out which response was for which request."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1485908526, "post_id": 41969421, "comment_id": 71118287, "body": "Can you show the C code as to what your application send loop looks like?"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1485909016, "post_id": 41969421, "comment_id": 71118427, "body": "To rule out changing ports being an issue, can you adjust your protocol to not need distinct ports?"}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1485915684, "post_id": 41969421, "comment_id": 71120140, "body": "This sounds like normal behavior for a non-real-time thread... every so often, some part of the UDP transmission path gets held off as the system attends to some other task instead.  If you need hard real-time performance guarantees, you&#39;ll need to use a hard-real-time thread (e.g. via Xenomai or similar)"}, {"owner": {"reputation": 21, "user_id": 7363654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b5641a3ea1b4599b7bf29721d28d1e?s=128&d=identicon&r=PG&f=1", "display_name": "RSH2000", "link": "https://stackoverflow.com/users/7363654/rsh2000"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1485918850, "post_id": 41969421, "comment_id": 71120904, "body": "Thanks @jxh, I ran a test with port reuse and the result didn`t change. Still the same pattern for the delays."}, {"owner": {"reputation": 21, "user_id": 7363654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b5641a3ea1b4599b7bf29721d28d1e?s=128&d=identicon&r=PG&f=1", "display_name": "RSH2000", "link": "https://stackoverflow.com/users/7363654/rsh2000"}, "reply_to_user": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1485919122, "post_id": 41969421, "comment_id": 71120972, "body": "Thanks @JeremyFriesner. Even with the CPU affinity the system switches into other tasks? I also set the flag for the sendto() function to be non-blocking. But  these results confirm that it is occasionally blocking!"}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1485920800, "post_id": 41969421, "comment_id": 71121363, "body": "Is it blocking, or is it just not returning as quickly as usual, e.g. because the thread has been pre-empted by some other activity?  (Btw if you aren&#39;t already calling sched_setscheduler() to make your thread real-time-ish, you might want to try that; it might help keep your thread on the CPU more reliably.  It&#39;s only &quot;soft real-time&quot; though, so you still might see holdoffs occasionally)"}, {"owner": {"reputation": 21, "user_id": 7363654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b5641a3ea1b4599b7bf29721d28d1e?s=128&d=identicon&r=PG&f=1", "display_name": "RSH2000", "link": "https://stackoverflow.com/users/7363654/rsh2000"}, "reply_to_user": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1485933078, "post_id": 41969421, "comment_id": 71125686, "body": "@JeremyFriesner You were right, the problem is related to scheduling not the UDP sendto(). I used the sched_setscheduler(), the maximum delay didn`t change much but the pattern we see in the above graph is gone and replace by an irregular shape. I probably need to rephrase the question and ask it with modified tags but I am still curious when I use CPU affinity and no other process is running on this core, and i know that there is no context switch for my process, what causes those delays? are the system calls run on other CPUs? what else is running during delay time?"}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1485965692, "post_id": 41969421, "comment_id": 71146813, "body": "Are you sure no other process is running on the core?  AFAIK pinning a process keeps that process on the core, but doesn&#39;t necessarily keep other processes off of the core.  Anyway, I&#39;m not expert enough on the subject to give details, but generally unless the scheduler was designed very carefully from the ground up to be hard-real-time, there are various things that can cause holdoffs; e.g. servicing an interrupt, or waiting for a mutex that is locked by another part of the kernel."}], "owner": {"reputation": 21, "user_id": 7363654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b5641a3ea1b4599b7bf29721d28d1e?s=128&d=identicon&r=PG&f=1", "display_name": "RSH2000", "link": "https://stackoverflow.com/users/7363654/rsh2000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 721, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1485934346, "creation_date": 1485905603, "last_edit_date": 1485934346, "question_id": 41969421, "link": "https://stackoverflow.com/questions/41969421/udp-client-periodic-sendto-delay-in-c-in-linux", "title": "UDP client periodic sendto() delay in C in Linux", "body": "<p>I am developing a UDP client in C in Linux with glibc 2.23. My application sends small packets (11 bytes) in a loop with a rate of 20,000 packets/sec. </p>\n\n<p>To ensure that the client met its promised send rate, I instrumented my application to measure UDP send timings when I saw a strange behavior. The time it takes to send a packet (a call to <code>sendto()</code> function) is \"usually\" around 13 usec. </p>\n\n<p>But approximately every 30 msec, there is a call which takes around 50 usec and approximately every 1500 ms, there is a call which takes 160 usec. The numbers are approximate and are average of a long 1 minute run. </p>\n\n<p>The graph below shows the delay values for 5 second run of the application.\n<img src=\"https://i.stack.imgur.com/Wlhox.png\" alt=\"sendto() call delay as a function of runtime\"></p>\n\n<p>Here are the things that I tried:</p>\n\n<ul>\n<li>Using affinity to pin my application to a core to avoid context switch</li>\n<li>Changing the UDP send/receive buffer size from 100K to 1G (smaller buffer sizes slightly reduces the amount of delay but not the frequency)</li>\n<li>Changing form IPV4 to IPV6 (no difference)</li>\n</ul>\n\n<p>Also tried:</p>\n\n<ul>\n<li>Disabled <code>arp</code> (address resolution protocol) </li>\n<li>Ran the test while the server and client were at the same machine as well as two different machines (connected via a switch), no difference in the results</li>\n<li>switched between the 10G and 1G NICs, no difference in the results</li>\n<li>Ran client and server on two docker instances on the same machine connected via a virtual bridge, no difference in the results. </li>\n</ul>\n\n<p>I was wondering if anyone experienced such behavior? </p>\n\n<p>I appreciate any suggestion about the cause or solution to avoid the costly calls? </p>\n"}, {"tags": ["c", "microchip", "trigonometry", "pwm", "pic32"], "answers": [{"comments": [{"owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "edited": false, "score": 0, "creation_date": 1560971712, "post_id": 41978328, "comment_id": 99916248, "body": "AFAIK, not all PIC32MX&#39;s are capable of an 80MHz SYSCLK, for example, PIC32MX1XX/2XX/5XX are only capable of 50MHz (source: <a href=\"http://ww1.microchip.com/downloads/en/DeviceDoc/60001290E.pdf\" rel=\"nofollow noreferrer\">ww1.microchip.com/downloads/en/DeviceDoc/60001290E.pdf</a>)"}, {"owner": {"reputation": 414, "user_id": 660867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c61bbbe4455a0faf0a5bb004513be15?s=128&d=identicon&r=PG", "display_name": "blsmit5728", "link": "https://stackoverflow.com/users/660867/blsmit5728"}, "reply_to_user": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "edited": false, "score": 0, "creation_date": 1561120088, "post_id": 41978328, "comment_id": 99970080, "body": "@bigwillydos The 7XX series are very much capable of 80MHz"}], "tags": [], "owner": {"reputation": 414, "user_id": 660867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c61bbbe4455a0faf0a5bb004513be15?s=128&d=identicon&r=PG", "display_name": "blsmit5728", "link": "https://stackoverflow.com/users/660867/blsmit5728"}, "is_accepted": false, "score": 1, "last_activity_date": 1485947535, "creation_date": 1485947535, "answer_id": 41978328, "question_id": 41969364, "link": "https://stackoverflow.com/questions/41969364/pic32-pwm-and-sin-wave/41978328#41978328", "title": "PIC32 - PWM and Sin-wave", "body": "<p>More than likely you are not running the PIC fast enough to get audible tones. You're PWM rates are probably in the low kHz or Hz range and thus sound terrible. Read about the OSC family reference manual and use the config bits to set up your PIC for 80MHz (if you're on a PIC32MX). <a href=\"http://ww1.microchip.com/downloads/en/DeviceDoc/61112H.pdf\" rel=\"nofollow noreferrer\">http://ww1.microchip.com/downloads/en/DeviceDoc/61112H.pdf</a> </p>\n"}], "owner": {"reputation": 54, "user_id": 7003864, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210456676602157/picture?type=large", "display_name": "tomaswandahl", "link": "https://stackoverflow.com/users/7003864/tomaswandahl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1485947535, "creation_date": 1485905320, "question_id": 41969364, "link": "https://stackoverflow.com/questions/41969364/pic32-pwm-and-sin-wave", "title": "PIC32 - PWM and Sin-wave", "body": "<p>I am trying to make a program that generates sin-waves that i will output through a passive summer and thus make the microcontroller play sounds when i press buttons.</p>\n\n<p>I have got the PWM to work, and can play notes using constant values, but I would like to use Sin-waves instead of constants.</p>\n\n<p>Heres the code that ive come up with so far:</p>\n\n<pre><code>#include &lt;pic32mx.h&gt;\n#include &lt;stdint.h&gt;\n\nextern void _enable_interrupt();\n\n//Change length of the Steps.\n#define step 0.00000000000000000001\n\n\nstruct Note{\nint number;\nint freq;\ndouble A;\ndouble x;\nint play;\n}Note;\n\nstruct Note array[12];\n\nvoid gen(int i){\n float pi = 3.141592;\n double x = array[i].x;\n double freq = array[i].freq;\n double A = sin(freq*x*step*2*pi);\n x++;\n array[i].A = A;\n array[i].x = x;\n}\n\nvoid initNotes(){\n\n\n\n struct Note C = {0, 200, 0.0, 0.0, 0};\n struct Note Ciss = {1, 200, 0.0, 0.0, 0};\n struct Note D = {2, 200, 0.0, 0.0, 0};\n struct Note Diss = {3, 4100, 0.0, 0.0, 0};\n struct Note E = {4, 3900, 0.0, 0.0, 0};\n struct Note F = {5, 3700, 0.0, 0.0, 0};\n struct Note Fiss = {6, 3500, 0.0, 0.0, 0};\n struct Note G = {7, 3300, 0.0, 0.0, 0};\n struct Note Giss = {8, 3100, 0.0, 0.0, 0};\n struct Note B = {9, 2900, 0.0, 0.0, 0};\n struct Note Biss = {10, 2700, 0.0, 0.0, 0};\n\n array[0] = C;\n array[1] = Ciss;\n array[2] = D;\n array[3] = Diss;\n array[4] = E;\n array[5] = F;\n array[6] = Fiss;\n array[7] = G;\n array[8] = Giss;\n array[9] = B;\n array[10] = Biss;\n\n\n}\nvoid initSynth() {\n for(;;) {\n  int btns = getBtns();\n\n  // Check buttons. If button is pressed, corresponding note's play-value will be set to 1 (true)\n  if((PORTD &amp; 0b000000100000) == 0b000000100000){\n       array[0].play = 1; \n\n  }else{\n        array[0].play = 0;\n  }\n  if((PORTD &amp; 0b000001000000) == 0b000001000000){\n            array[1].play = 1;\n  }\n  else{\n      array[1].play = 0;\n  }\n  if((PORTD &amp; 0b000010000000) == 0b000010000000){\n            array[2].play = 1;\n  }else {\n      array[2].play = 0;\n  }\n  // Check note-array for notes with play-value 1 (true). These are added together.\n\n  int c;\n  int nr;\n  int i;\n  for(i = 0; i &lt; 11; i++){\n   if(array[i].play == 1){\n    c = c + array[i].A;\n    gen(i);\n    nr++;\n   }\n        }\n\n  // Set PWM to previously calculated value.\n  if((c/nr) &gt; 0){\n        setPwm((c/nr), 50);\n  } else setPwm(0,0);\n }\n}\n\nint getBtns(void) {\n  return((PORTD &gt;&gt;5) &amp;0x7); /* Port D bits 5 through 8 is used for the Buttons and is set to 1 (input) */\n }\n\n int getSwitches(void) {\n  return((PORTD&gt;&gt;8) &amp;0xF); /* Port D bits 8 through 12 is used for the Switches and is set to 1 (input) */\n }\n\n int getbtn(void) {\n  return(PORTD &amp;0x1);\n }\n\n\nvoid initPwm(){\n T2CON = 0x070; // Clear timer2, prescale at 1:1\n TMR2 = 0x0; // Timer2 value starts at 0\n OC1CON = 0x0000; // Turn off and clear pwm\n OC1R = 0x0001;\n OC1RS = 0; // Dutycycle\n OC1CON = 0x0006; // Configure for PWM mode without Fault pin\n PR2 = 0; // Set dutycycle, H\u00c4R \u00c4NDRAR MAN TONER!\n IECSET(0) = 0x0100; // Enable T2 interrupt\n IPCSET(2) = 0x01C; // Set T2 interrupt priority to 7\n enable_interrupt();\n OC1CONSET = 0x08000; // Enable OC1\n T2CONSET |= 0x08000; // Enable Timer2\n}\n\nvoid setPwm(int pwm, int duty){\n    int dutycycle = 0xFFFFFFFF * (duty / 100);\n OC1RS = duty;\n PR2 = pwm;\n}\n\nint main(void) {\n TRISE = 0x00; /* Port E bits 0 through 7 is used for the LED and is set to 0 (output) */\n PORTE = 0x00;\n initNotes();\n initPwm();\n initSynth();\n return 0;\n}\n\nvoid user_isr( void ) {\n if((IFS(0)&amp;0x0100)==0x0100){\n  IFSCLR(0) = 0x0100;\n }\n}\n</code></pre>\n\n<p>When i press the button the summer starts to buzz and tick at different speed each time i press the button. Sometimes I get clean tones, so I get the feeling that I am somewhat close to a solution. Is the problem that the computer runs at an alternating speed? Maybe the solution is adding another timer somewhere?</p>\n"}, {"tags": ["c", "binary", "division", "signed-integer"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1485903352, "post_id": 41968998, "comment_id": 71116582, "body": "FYI, the division operator <code>&#47;</code> is binary too. &quot;Binary&quot; means it has two operands as opposed to &quot;unary&quot; and &quot;ternary&quot;."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1485903405, "post_id": 41968998, "comment_id": 71116605, "body": "Just compensate for the round-down that <code>&gt;&gt;</code> has"}, {"owner": {"reputation": 55, "user_id": 5886457, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6f6cd211f8449990f6e4ca610b66ad01?s=128&d=identicon&r=PG&f=1", "display_name": "pootyy", "link": "https://stackoverflow.com/users/5886457/pootyy"}, "edited": false, "score": 0, "creation_date": 1485903619, "post_id": 41968998, "comment_id": 71116688, "body": "I specified which binary operators i am allowed to use, and / is not one of them. Also, i dont think its so straight-forward as to round, because then if n = 0 the output will be wrong."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485904122, "post_id": 41968998, "comment_id": 71116868, "body": "&quot;does not work with odd negative integers.&quot; --&gt;&gt; Hmmm, first thing I&#39;d try is to negate the number (with <code>~</code> and others), shift, and negate again - which certainly should work except for maybe corner cases. Then I would post looking for simplifications."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485904204, "post_id": 41968998, "comment_id": 71116895, "body": "@chux Negating it will make it much more dependent on the implementation."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485905004, "post_id": 41968998, "comment_id": 71117175, "body": "Can code use operators like <code>&lt;</code> or <code>&gt;</code> as part of the solution?"}, {"owner": {"reputation": 55, "user_id": 5886457, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6f6cd211f8449990f6e4ca610b66ad01?s=128&d=identicon&r=PG&f=1", "display_name": "pootyy", "link": "https://stackoverflow.com/users/5886457/pootyy"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485905481, "post_id": 41968998, "comment_id": 71117331, "body": "sadly, no @chux"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485905656, "post_id": 41968998, "comment_id": 71117381, "body": "Can code assume 2&#39;s compleiment?  Can code assume a 32-bit <code>int</code>?"}, {"owner": {"reputation": 55, "user_id": 5886457, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6f6cd211f8449990f6e4ca610b66ad01?s=128&d=identicon&r=PG&f=1", "display_name": "pootyy", "link": "https://stackoverflow.com/users/5886457/pootyy"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485906168, "post_id": 41968998, "comment_id": 71117547, "body": "yes, 2&#39;s complement and 32 bit int @chux"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1485907118, "post_id": 41968998, "comment_id": 71117864, "body": "@EugeneSh.  How about <code>return (~(x &gt;&gt; 31) &amp; (x &gt;&gt; n)) | ((x &gt;&gt; 31) &amp; (~((1 + ~(x+0u)) &gt;&gt; n) + 1));</code>?  Suppose the final <code>unsigned</code> to <code>int</code> is ID or UB."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 5886457, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6f6cd211f8449990f6e4ca610b66ad01?s=128&d=identicon&r=PG&f=1", "display_name": "pootyy", "link": "https://stackoverflow.com/users/5886457/pootyy"}, "edited": false, "score": 0, "creation_date": 1485905586, "post_id": 41969392, "comment_id": 71117363, "body": "ok, thanks! I cant use loops, so ill try and figure out how to do this without them."}, {"owner": {"reputation": 55, "user_id": 5886457, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6f6cd211f8449990f6e4ca610b66ad01?s=128&d=identicon&r=PG&f=1", "display_name": "pootyy", "link": "https://stackoverflow.com/users/5886457/pootyy"}, "edited": false, "score": 0, "creation_date": 1485908770, "post_id": 41969392, "comment_id": 71118353, "body": "oh ok this makes sense! Thank you so much!"}, {"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "reply_to_user": {"reputation": 55, "user_id": 5886457, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6f6cd211f8449990f6e4ca610b66ad01?s=128&d=identicon&r=PG&f=1", "display_name": "pootyy", "link": "https://stackoverflow.com/users/5886457/pootyy"}, "edited": false, "score": 0, "creation_date": 1485912474, "post_id": 41969392, "comment_id": 71119276, "body": "@Bailey: I made a typo with operator precedence, it&#39;s fixed. Also, I noticed that <code>-</code> operator is apparently not allowed, so <code>- 1</code> is now replaced with <code>+ ~0</code>."}], "tags": [], "owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "is_accepted": false, "score": 3, "last_activity_date": 1485912774, "last_edit_date": 1485912774, "creation_date": 1485905449, "answer_id": 41969392, "question_id": 41968998, "link": "https://stackoverflow.com/questions/41968998/how-can-i-divide-a-signed-integer-using-only-binary-operators/41969392#41969392", "title": "How can I divide a signed integer using only binary operators?", "body": "<p>Assuming <a href=\"https://en.wikipedia.org/wiki/Two&#39;s_complement\" rel=\"nofollow noreferrer\">two's complement</a> representation of signed integers and <a href=\"https://en.wikipedia.org/wiki/Arithmetic_shift\" rel=\"nofollow noreferrer\">arithmetic shift</a> behaviour of <code>&gt;&gt;</code> operator, the answer could be:</p>\n\n<pre><code>int dl18(int x, int n) {\n    if (x &lt; 0) {\n        x += (1 &lt;&lt; n) - 1;\n    }\n    return x &gt;&gt; n;\n}\n</code></pre>\n\n<p>The addition is necessary, because <code>&gt;&gt;</code> rounds for negative numbers towards negative infinity. By adding <code>2^n - 1</code>, the result is always truncated towards zero, just like it happens for <code>/</code> operator.</p>\n\n<p>Due to your requirements, assuming that <code>int</code> has <code>4</code> bytes (and to be extra pedantic <code>CHAR_BIT = 8</code>), the expression may be rewritten (obfuscated) as:</p>\n\n<pre><code>(x + ((x &gt;&gt; 31) &amp; ((1 &lt;&lt; n) + ~0))) &gt;&gt; n\n</code></pre>\n\n<p>The idea of <code>x &gt;&gt; 31</code> is to replicate MSB bit, so the mask becomes either all ones (i.e. <code>0xFFFFFFFF</code>), or all zeros, which is then used to either preserve or eliminate <code>((1 &lt;&lt; n) - 1)</code> from addition. Parentheses around <code>&amp;</code> are necessary, because addition has <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">higher precedence</a> than bitwise AND.</p>\n\n<p>This algorithm is also used by GCC compiler. For instance:</p>\n\n<pre><code>int dl18_4(int x) { return x / 4; }\n</code></pre>\n\n<p>translates with <code>-O1</code> into:</p>\n\n<pre><code>dl18_4:\n        lea     eax, [rdi+3]    ; eax = rdi + 3\n        test    edi, edi        ; set sign flag if edi &lt; 0\n        cmovns  eax, edi        ; eax = edi if SF = 0\n        sar     eax, 2          ; eax = eax &gt;&gt; 2\n        ret\n</code></pre>\n\n<p>Note that shifting by negative number invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>, so it may be safer to declare second parameter as <code>unsigned int</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485915510, "post_id": 41970767, "comment_id": 71120078, "body": "Code uses <code>-</code> in <code>(1UL &lt;&lt; n_bits) - (unsigned)(x)</code>.  I do not see <code>-</code> in &quot;can only use ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;&quot;"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485915793, "post_id": 41970767, "comment_id": 71120173, "body": "Curious, why <code>L</code> in <code>1UL</code>.  <code>unsigned long</code> may not be any wider than <code>unsigned</code>.  Perhaps <code>(1UL &lt;&lt; n_bits) - (unsigned)(x)</code> --&gt; <code>~(unsigned)(x) + 1;</code>?  As in my <a href=\"http://stackoverflow.com/questions/41968998/how-can-i-divide-a-signed-integer-using-only-binary-operators#comment71117864_41968998\">comment</a>"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485918023, "post_id": 41970767, "comment_id": 71120702, "body": "@chux-- I have updated my answer. It seems to me that the cast to <code>unsigned</code> is not necessary at all. In other words, <code>~(unsigned)(x) + 1</code> --&gt; <code>~x + 1</code>. Am I missing something here?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485918269, "post_id": 41970767, "comment_id": 71120764, "body": "<code>~(unsigned)(some_int) + 1</code> in itself will not cause UB for all values of <code>some_int</code>.  <code>~some_int</code> is UB on select machines, maybe in a computer graveyard.  <code>~</code> on non-2&#39;s complement does not lend itself to arithmetic negation.   IAC, it is all a learning exercise.  &quot;If the implementation does not support negative zeros, the behavior of the &amp;, |, ^, ~, &lt;&lt;, and &gt;&gt; operators with operands that would produce such a value is unde\ufb01ned. &quot; C11 &#167;6.2.6.2 4"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485918965, "post_id": 41970767, "comment_id": 71120929, "body": "@chux-- Appreciate the informative comments. Final question: I changed my code to cast <code>x</code> before the first transformation to a positive magnitude, but if negative zero representations are the only issue, could we not instead test for zero before applying <code>~</code>, and proceed accordingly?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1485919227, "post_id": 41970767, "comment_id": 71121002, "body": "<code>INT_MIN</code> is an issue.  Consider <code>x = ~(unsigned)(INT_MIN) + 1;</code>.  Suggest using well behaved <code>unsigned</code> for the <code>&gt;&gt;</code> shift rather than <code>int x</code> with its ID behavior."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1485920682, "post_id": 41970767, "comment_id": 71121330, "body": "@chux-- you are suggesting <code>x &gt;&gt;= n</code> --&gt; <code>x = (unsigned)x &gt;&gt; n</code>? When I changed this the code worked for <code>x = INT_MIN</code>; without the cast the sign was lost on my machine. Will have to think about this some more. Good tip."}], "tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": false, "score": 1, "last_activity_date": 1485922377, "last_edit_date": 1495540390, "creation_date": 1485914569, "answer_id": 41970767, "question_id": 41968998, "link": "https://stackoverflow.com/questions/41968998/how-can-i-divide-a-signed-integer-using-only-binary-operators/41970767#41970767", "title": "How can I divide a signed integer using only binary operators?", "body": "<p>Here is a solution that avoids bit-shifting negative values. It does assume twos-complement representation, but it does not use the unary negative operator.</p>\n\n<p>A bitmask is used to set <code>neg</code> to a non-zero value if <code>x</code> is negative, or to zero if <code>x</code> is non-negative. Here a trick suggested by <a href=\"https://stackoverflow.com/users/586873/grzegorz-szpetkowski\">@Grzegorz Szpetkowski</a> is used to avoid subtraction by 1: adding <code>~0</code> instead. If <code>x</code> is negative, the value of <code>x</code> is changed to the magnitude of <code>x</code>. To avoid using the unary negative here, using a trick suggested by <a href=\"https://stackoverflow.com/questions/41968998/how-can-i-divide-a-signed-integer-using-only-binary-operators/41970767?noredirect=1#comment71120173_41970767\">@chux</a>, we take advantage of the fact that for a negative value in twos-complement, the corresponding positive value is equal to the bitwise negation of the negative representation plus 1.</p>\n\n<p>This magnitude of <code>x</code> can be bit-shifted without encountering implementation-dependent behavior. After performing the division, the result is converted back to a negative value if the original value was negative, by performing the same transformation as before.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n\nint divide_2n(int x, unsigned n);\n\nint main(void)\n{\n    printf(\"-7 / 4 = %d\\n\", divide_2n(-7, 2));\n    printf(\"27 / 8 = %d\\n\", divide_2n(27, 3));\n    printf(\"-27 / 8 = %d\\n\", divide_2n(-27, 3));\n    printf(\"-9 / 2 = %d\\n\", divide_2n(-9, 1));\n    printf(\"-9 / 1 = %d\\n\", divide_2n(-9, 0));\n\n    return 0;\n}\n\nint divide_2n(int x, unsigned n)\n{\n    unsigned n_bits = CHAR_BIT * sizeof(int);\n    unsigned neg = x &amp; (1U &lt;&lt; (n_bits + ~0));\n\n    if (neg) {\n        x = ~(unsigned)x + 1;\n    }\n\n    x = (unsigned)x &gt;&gt; n;\n\n    if (neg) {\n        x = ~x + 1;\n    }\n\n    return x;\n}\n\n-7 / 4 = -1\n27 / 8 = 3\n-27 / 8 = -3\n-9 / 2 = -4\n-9 / 1 = -9\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 5886457, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6f6cd211f8449990f6e4ca610b66ad01?s=128&d=identicon&r=PG&f=1", "display_name": "pootyy", "link": "https://stackoverflow.com/users/5886457/pootyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1485922377, "creation_date": 1485903236, "last_edit_date": 1485904684, "question_id": 41968998, "link": "https://stackoverflow.com/questions/41968998/how-can-i-divide-a-signed-integer-using-only-binary-operators", "title": "How can I divide a signed integer using only binary operators?", "body": "<p>I can only use ! ~ &amp; ^ | + &lt;&lt; >></p>\n\n<p>I am writing this in C.</p>\n\n<p>I am trying to divide a number x by 2^n.\nSo i thought if I shift x >> n that would work, but it does not work with odd negative integers. It originally looked like this:</p>\n\n<pre><code>int dl18(int x, int n) {\n   return (x &gt;&gt; n);\n }\n</code></pre>\n\n<p>but if x = -9 and n = 1 the output should be -4 but it is -5.\nand if x = -9 and n = 0 the output is correct (-9).</p>\n\n<p>Thanks in advance.</p>\n\n<p>So I figured out doing this makes it work for everything unless n = 0 and x is a negative number:</p>\n\n<pre><code>return (~(x &gt;&gt; 31) &amp; (x &gt;&gt; n)) | ((x &gt;&gt; 31) &amp; ((x &gt;&gt; n) + 1));\n</code></pre>\n"}, {"tags": ["c", "character", "ascii"], "answers": [{"comments": [{"owner": {"reputation": 465, "user_id": 4109266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fA4Tx.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4109266/michael"}, "edited": false, "score": 0, "creation_date": 1485903669, "post_id": 41969058, "comment_id": 71116708, "body": "I thought getchar just read one character and stopped reading. I guess the stream of characters dont stop. Can you give me a link where i can learn how does this thing work exactly? I want to learn. I am studying the book C programming language at the moment."}, {"owner": {"reputation": 382, "user_id": 1366263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65963e2413e2724dc8fae2cc1676049e?s=128&d=identicon&r=PG", "display_name": "odin", "link": "https://stackoverflow.com/users/1366263/odin"}, "reply_to_user": {"reputation": 465, "user_id": 4109266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fA4Tx.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4109266/michael"}, "edited": false, "score": 0, "creation_date": 1485903827, "post_id": 41969058, "comment_id": 71116763, "body": "It does only read one character, but then your loop runs a second time and automatically reads in the next character.  <a href=\"http://www.cplusplus.com/reference/cstdio/getchar/\" rel=\"nofollow noreferrer\">Here is the reference page</a>. It explains that getchar() reads a character from stdin. You stdin input looks like &quot;1\\n&quot; so in your first loop through it reads the 1, then in the next loop it reads the &#39;\\n&#39;. If you change EOF to &#39;\\n&#39; it will fix the issue."}], "tags": [], "owner": {"reputation": 382, "user_id": 1366263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65963e2413e2724dc8fae2cc1676049e?s=128&d=identicon&r=PG", "display_name": "odin", "link": "https://stackoverflow.com/users/1366263/odin"}, "is_accepted": true, "score": 1, "last_activity_date": 1485903533, "creation_date": 1485903533, "answer_id": 41969058, "question_id": 41968918, "link": "https://stackoverflow.com/questions/41968918/c-getchar-eof-prints-0-or-1/41969058#41969058", "title": "c = getchar() != EOF; prints 0 or 1", "body": "<p>Your problem is that a '\\n' character is not equal to EOF. The '\\n' is being read in as a second character.</p>\n"}], "owner": {"reputation": 465, "user_id": 4109266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fA4Tx.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4109266/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 41969058, "answer_count": 1, "score": -2, "last_activity_date": 1573031461, "creation_date": 1485902916, "last_edit_date": 1573031461, "question_id": 41968918, "link": "https://stackoverflow.com/questions/41968918/c-getchar-eof-prints-0-or-1", "title": "c = getchar() != EOF; prints 0 or 1", "body": "<p>When i run this code it prints the dos 0 character(space) once, puts a space and prints dos 1 character(smiley face with white eyes and mouth). </p>\n\n<p><a href=\"https://i.stack.imgur.com/NaByN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NaByN.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>int c = 0, b = 1;\nprintf(\"%c %c\", c, b);\n</code></pre>\n\n<p>But when i run this code below the result is being printed twice. I either get 2 spaces or 2 smiley faces. </p>\n\n<p><a href=\"https://i.stack.imgur.com/yB881.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yB881.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>while(c != -1)\n{\n    c = getchar() != EOF;\n    putchar(c);\n}\n</code></pre>\n\n<p>Edit: My code doesnt have paranthesis so it compares every single entered character with EOF and assigns the result (0 or 1) to c and then prints c as a char. In order to prevent this, we can use paranthesis to force the program to do c = getchar() first and then compare that value with EOF.</p>\n\n<pre><code>while((c = getchar()) != EOF)\n</code></pre>\n"}]