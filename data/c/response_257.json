[{"tags": ["c", "synchronization", "semaphore"], "comments": [{"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 0, "creation_date": 1576109358, "post_id": 59295681, "comment_id": 104796196, "body": "This post includes a lot of code having nothing to do with the problem at hand, so that makes it harder for us to focus in on the problem. Recommend you create a minimal example that we can build ourselves. But the buffer <code>args[3]</code> is one byte too small. Recommend `args[3] = malloc(strlen(fileName) + 1);"}], "answers": [{"tags": [], "owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "is_accepted": true, "score": 0, "last_activity_date": 1576109715, "creation_date": 1576109715, "answer_id": 59295979, "question_id": 59295681, "link": "https://stackoverflow.com/questions/59295681/numerical-result-out-of-range-semctl-c/59295979#59295979", "title": "Numerical result out of range semctl c", "body": "<p><code>arg</code> members have not been initialised nor assigned any value. So they contain random/junk values. Need to set it like so:</p>\n\n<pre><code>arg.value = MY_SEM_VALUE;\nint res = semctl(semID, 0, SETVAL, arg);\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 12317406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62e3205661006c31810c00fb349e9e63?s=128&d=identicon&r=PG&f=1", "display_name": "Fel", "link": "https://stackoverflow.com/users/12317406/fel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 59295979, "answer_count": 1, "score": 0, "last_activity_date": 1576119170, "creation_date": 1576107262, "last_edit_date": 1576119170, "question_id": 59295681, "link": "https://stackoverflow.com/questions/59295681/numerical-result-out-of-range-semctl-c", "title": "Numerical result out of range semctl c", "body": "<p>I am trying to create a program that will have synchronization but I am running into an issue where I am creating a set of semaphores with a value of 3 for size.</p>\n\n<p>I am getting the numerical result out of range strerror when trying to execute the semctl to set the values of the semaphore set to 0. I don't understand what is causing this issue.</p>\n\n<p>Here is the code that it is generating the error from:</p>\n\n<pre><code>int main(int argc, char *argv[]){\n\n    char *fileName = argv[0];\n    int value = 0;\n\n    int semID, memID;\n    int status = 0;\n\n    int pipe1[2], pipe2[2], pipe3[2], pipe4[2], pipe5[2], pipe6[2], pipe7[2], pipe8[2], pipe9[2];\n    pid_t PID1, PID2, PID3, PID4, PID5, PID6, PID7, PID8, PID9, waitPID;\n    char *buffer;\n    int check = 0;\n\n    struct sembuf operations[1];\n\n    int argCount = 4;\n    int size = 20;\n    char **args = (char **) malloc( (argCount) * (sizeof (char *) ));\n    args[0] =     (char *)  malloc( (size)     * (sizeof (char  ) ));\n    args[1] =     (char *)  malloc( (size)     * (sizeof (char  ) ));\n    args[2] =     (char *)  malloc( (size)     * (sizeof (char  ) ));\n    args[3] =     (char *)  malloc( (strlen(fileName))     * (sizeof (char  ) ));\n\n    union semun {\n        int value;\n        struct semid_ds *buffer;\n        ushort *array;\n    } arg;\n\n    char *fileNameOutput = (char *)  \"output.txt\";\n    FILE *fPTR = fopen(fileNameOutput, \"w\");\n\n    /*\n    *   Create a set of 3 semaphores to control the correct synchronization\n    *   then set all semaphores to value of 0\n    */\n\n    semID = semget(key, 3, 0666 | IPC_CREAT);\n\n    if(semID &lt; 0){\n        fprintf(stderr, \"Semaphore not created\\n\" );\n        exit(0);\n    }\n\n    printf(\"value of semaphore after creation: %d, %d , %d\\n\", semctl(semID, 0, SETVAL, arg), semctl(semID, 1, SETVAL, arg), semctl(semID, 2, SETVAL, arg) );\n\n    if(semctl(semID, 0, SETVAL, arg) &lt; 0){\n        printf( \"%s\\n\", strerror(errno) );\n        fprintf(stderr, \"was unable to set value of sempahore 0\\n\" );\n        exit(0);\n    }\n    if(semctl(semID, 1, SETVAL, arg) &lt; 0){\n        fprintf(stderr, \"was unable to set value of sempahore 1\\n\" );\n        exit(0);\n    }\n\n    if(semctl(semID, 2, SETVAL, arg) &lt; 0){\n        fprintf(stderr, \"was unable to set value of sempahore 2\\n\" );\n        exit(0);\n    }\n</code></pre>\n"}, {"tags": ["c", "gtk", "gtk3"], "answers": [{"tags": [], "owner": {"reputation": 694, "user_id": 8627962, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4f-Yq3BvCaA/AAAAAAAAAAI/AAAAAAAAARM/NeJoNAwQHT0/photo.jpg?sz=128", "display_name": "Siva Guru", "link": "https://stackoverflow.com/users/8627962/siva-guru"}, "is_accepted": false, "score": 3, "last_activity_date": 1576134630, "creation_date": 1576134630, "answer_id": 59299407, "question_id": 59295481, "link": "https://stackoverflow.com/questions/59295481/gtk-3-0-text-view-resizable/59299407#59299407", "title": "Gtk 3.0 Text View Resizable", "body": "<p>By settings wrap mode you stop the text from expanding the window</p>\n\n<pre><code>gtk_text_view_set_wrap_mode(GTK_TEXT_VIEW(largeEntry), GTK_WRAP_WORD_CHAR);\n</code></pre>\n\n<p>But this will only stop it from horizontally expanding the window. to stop it from vertically expanding the window you have to put the text view inside a scrolled window.</p>\n\n<pre><code>#include &lt;gtk/gtk.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstatic GtkTextBuffer *buffer;\n\nvoid checkEndLine(GtkWidget *text, gpointer data)\n{\n  //g_print(\":%d \", gtk_text_buffer_get_char_count(GTK_TEXT_BUFFER(buffer)));\n}\n\nstatic void activate(GtkApplication *app, gpointer user_data)\n{\n\n  GtkWidget *window, *grid, *calculate;\n\n  //Create Grid and Window\n  window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n  gtk_window_set_title(GTK_WINDOW(window), \"Menu Test\");\n  gtk_window_resize(GTK_WINDOW(window), 600, 600);\n  g_signal_connect(window, \"destroy\", G_CALLBACK(gtk_main_quit), NULL);\n  gtk_window_set_resizable(GTK_WINDOW(window), FALSE);\n  grid = gtk_grid_new();\n  gtk_container_add(GTK_CONTAINER(window), grid);\n\n  //Text Field\n\n  GtkWidget *largeEntry = gtk_text_view_new();\n  GtkWidget *box = gtk_box_new(GTK_ORIENTATION_VERTICAL, 1);\n\n  GtkWidget *swindow = gtk_scrolled_window_new(NULL, NULL);\n  gtk_scrolled_window_set_policy(GTK_SCROLLED_WINDOW(swindow), GTK_POLICY_NEVER, GTK_POLICY_AUTOMATIC);\n\n  gtk_container_add(GTK_CONTAINER(swindow), largeEntry);\n\n  gtk_widget_set_size_request(GTK_WIDGET(swindow), 100, 100);\n  gtk_widget_set_size_request(GTK_WIDGET(largeEntry), 100, 100);\n  gtk_widget_set_size_request(GTK_WIDGET(grid), 300, 300);\n\n  gtk_box_pack_start(GTK_BOX(box), largeEntry, 1, 1, 1);\n  gtk_text_view_set_wrap_mode(GTK_TEXT_VIEW(largeEntry), GTK_WRAP_WORD_CHAR);\n  buffer = gtk_text_view_get_buffer(GTK_TEXT_VIEW(largeEntry));\n  gtk_text_buffer_set_text(buffer, \"He\", -1);\n\n  gtk_grid_attach(GTK_GRID(grid), swindow, 0, 1, 1, 1);\n  gtk_widget_set_hexpand_set(GTK_WIDGET(largeEntry), FALSE);\n\n  g_signal_connect(GTK_TEXT_BUFFER(buffer), \"changed\", G_CALLBACK(checkEndLine), NULL);\n\n  //Showing widgets\n  gtk_widget_show_all(window);\n  gtk_main();\n}\n\nint main(int argc, char **argv)\n{\n  GtkApplication *app;\n  int status;\n\n  app = gtk_application_new(\"com.calculate\", G_APPLICATION_FLAGS_NONE);\n  g_signal_connect(app, \"activate\", G_CALLBACK(activate), NULL);\n  status = g_application_run(G_APPLICATION(app), argc, argv);\n  g_object_unref(app);\n\n  return status;\n}\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10130532, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-B_Abp3uGJVU/AAAAAAAAAAI/AAAAAAAAAHU/EumFGcg9NCQ/photo.jpg?sz=128", "display_name": "Gabe Koleszar", "link": "https://stackoverflow.com/users/10130532/gabe-koleszar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576134630, "creation_date": 1576105642, "question_id": 59295481, "link": "https://stackoverflow.com/questions/59295481/gtk-3-0-text-view-resizable", "title": "Gtk 3.0 Text View Resizable", "body": "<p>I am attempting to create a text area so that I can create a text editor but when ever the text reaches the end of the window, it just expands and becomes bigger and looks bad. </p>\n\n<p>I have tried multiple things in my code to prevent this resizing and none of it has worked. Would a window with scrolling functionality be easier for this? (I just want to keep my code simple)</p>\n\n<p>code:</p>\n\n<pre><code>#include &lt;gtk/gtk.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstatic GtkTextBuffer *buffer;\n\nvoid checkEndLine(GtkWidget *text, gpointer data){\n    //g_print(\":%d \", gtk_text_buffer_get_char_count(GTK_TEXT_BUFFER(buffer)));\n}\n\nstatic void activate (GtkApplication *app, gpointer user_data){\n\n    GtkWidget *window, *grid, *calculate;\n\n//Create Grid and Window\n    window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n    gtk_window_set_title(GTK_WINDOW(window), \"Menu Test\");\n    gtk_window_resize(GTK_WINDOW(window), 600, 600);\n    g_signal_connect(window, \"destroy\", G_CALLBACK(gtk_main_quit), NULL);\n    gtk_window_set_resizable(GTK_WINDOW(window), FALSE);\n    grid = gtk_grid_new();\n    gtk_container_add(GTK_CONTAINER(window), grid);\n\n//Text Field\n\n    GtkWidget *largeEntry = gtk_text_view_new ();\n    GtkWidget *box = gtk_box_new(GTK_ORIENTATION_VERTICAL, 1);\n\n    gtk_widget_set_size_request(GTK_WIDGET(box), 100, 100);\n    gtk_widget_set_size_request(GTK_WIDGET(largeEntry), 100, 100);\n    gtk_widget_set_size_request(GTK_WIDGET(grid), 300, 300);\n\n    gtk_box_pack_start(GTK_BOX(box), largeEntry, 1, 1, 1);  \n\n    buffer = gtk_text_view_get_buffer (GTK_TEXT_VIEW (largeEntry));\n    gtk_text_buffer_set_text (buffer, \"He\", -1);\n\n\n    gtk_grid_attach(GTK_GRID(grid), box, 0, 1, 1, 1);\n    gtk_widget_set_hexpand_set(GTK_WIDGET(largeEntry), FALSE);\n\n    g_signal_connect(GTK_TEXT_BUFFER(buffer), \"changed\", G_CALLBACK(checkEndLine), NULL);\n\n//Showing widgets \n    gtk_widget_show_all(window);\n    gtk_main();\n}\n\nint main(int argc, char **argv){\n    GtkApplication *app;\n    int status;\n\n    app = gtk_application_new(\"com.calculate\", G_APPLICATION_FLAGS_NONE);\n    g_signal_connect(app, \"activate\", G_CALLBACK (activate), NULL);\n    status = g_application_run (G_APPLICATION (app), argc, argv);\n    g_object_unref(app);\n\n    return status;\n}\n</code></pre>\n\n<p>Compiled with:</p>\n\n<pre><code>gcc note.c `pkg-config --cflags gtk+-3.0` -o out `pkg-config --libs gtk+-3.0`\n</code></pre>\n"}, {"tags": ["c", "gcc", "static-libraries", "libc"], "comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 1, "creation_date": 1576106544, "post_id": 59295473, "comment_id": 104795498, "body": "Can you clarify what you&#39;re trying to achieve? If you want a static-linked binary why aren&#39;t you using <code>-static</code>?"}, {"owner": {"reputation": 2337, "user_id": 2356635, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a5797203c9697ebe2570a58b5bdc2b1d?s=128&d=identicon&r=PG", "display_name": "Sam D20", "link": "https://stackoverflow.com/users/2356635/sam-d20"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1576108154, "post_id": 59295473, "comment_id": 104795927, "body": "@R.. I need this binary to be portable to another system running an older glibc version (glibc cannot be upgraded on this system, and the binary cannot be compiled on this system. This is quite a niche problem). I&#39;m not sure how to use <code>-static</code>, but I am assuming that my method achieves the same thing, no?"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1576110684, "post_id": 59295473, "comment_id": 104796475, "body": "No, it doesn&#39;t achieve the same thing."}, {"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 0, "creation_date": 1576112051, "post_id": 59295473, "comment_id": 104796713, "body": "One thing to try, perhaps, is to run <code>gcc</code> with the <code>-static</code> parameter along with <code>-v</code> so you can see what GNU would be doing to build this so you could tailor the command for your unique situation."}, {"owner": {"reputation": 2525, "user_id": 1283273, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/4kBME.jpg?s=128&g=1", "display_name": "Alexander Perechnev", "link": "https://stackoverflow.com/users/1283273/alexander-perechnev"}, "edited": false, "score": 0, "creation_date": 1578427892, "post_id": 59295473, "comment_id": 105433058, "body": "Where this <code>libc.a</code> came from?"}], "answers": [{"tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 3, "last_activity_date": 1576110780, "creation_date": 1576110780, "answer_id": 59296078, "question_id": 59295473, "link": "https://stackoverflow.com/questions/59295473/statically-linking-libc-into-my-binary-causes-it-to-segfault/59296078#59296078", "title": "Statically linking libc into my binary causes it to segfault", "body": "<p>If you want to produce a static-linked binary, just add <code>-static</code> to the command line. You do not need <code>libc.a</code> there at all. What you're doing, adding <code>libc.a</code> without <code>-static</code>, produces a dynamic-linked binary, but pulls in some functions/files (whatever you reference, and everything those reference, recursively) from <code>libc.a</code>, and still also has the shared <code>libc.so</code> participating in your program. These are not generally able to work together.</p>\n"}], "owner": {"reputation": 2337, "user_id": 2356635, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a5797203c9697ebe2570a58b5bdc2b1d?s=128&d=identicon&r=PG", "display_name": "Sam D20", "link": "https://stackoverflow.com/users/2356635/sam-d20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1576110780, "creation_date": 1576105606, "question_id": 59295473, "link": "https://stackoverflow.com/questions/59295473/statically-linking-libc-into-my-binary-causes-it-to-segfault", "title": "Statically linking libc into my binary causes it to segfault", "body": "<p>I need to build a binary with libc statically linked. I have libc.a available in the same directory as the source code. To compile, I tried the following: </p>\n\n<pre><code>gcc -o foo foo.c libc.a \n</code></pre>\n\n<p>This resulted in the following issue: </p>\n\n<pre><code>/usr/bin/ld: dynamic STT_GNU_IFUNC symbol `strcmp' with pointer equality in `libc.a(strcmp.o)' can not be used when making an executable\n</code></pre>\n\n<p>In researching this, I found the following question: <a href=\"https://stackoverflow.com/questions/26161332/linking-partially-static-and-partially-dynamic-in-gcc\">Linking partially static and partially dynamic in GCC</a></p>\n\n<p>Following the solution in the top answer, I created my own string comparison function in <code>my_strcmp.c</code> and tried the following compilation: </p>\n\n<pre><code>gcc -o foo foo.c mystrcmp.c libc.a \n</code></pre>\n\n<p>And it works, <em>but</em> the binary now segfaults quite early. This doesn't happen without libc statically linked. Here's the GDB trace: </p>\n\n<pre><code>(gdb) backtrace                                \n#0  0x00000000004fe48e in generic_start_main ()\n#1  0x00000000004fe891 in __libc_start_main () \n#2  0x0000000000406b56 in _start ()  \n</code></pre>\n\n<p>Not really sure how to interpret this. Anyone have any ideas? </p>\n"}, {"tags": ["c", "linux-kernel", "virtualization", "hypervisor"], "comments": [{"owner": {"reputation": 103, "user_id": 10013007, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-a--Yg6NSJ_s/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0EUc440l43DVYt1hkQbtc7qdK84A/mo/photo.jpg?sz=128", "display_name": "Paul", "link": "https://stackoverflow.com/users/10013007/paul"}, "reply_to_user": {"reputation": 9461, "user_id": 8422330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0f90445d03447c587d1e595d531f69?s=128&d=identicon&r=PG&f=1", "display_name": "prl", "link": "https://stackoverflow.com/users/8422330/prl"}, "edited": false, "score": 0, "creation_date": 1576130323, "post_id": 59295306, "comment_id": 104800616, "body": "1. CPU_BASED_CTL2_ENABLE_EPT = 0x2, I&#39;ll use kernel primitives next time (elixir.bootlin.com/linux/v4.6/source/arch/x86/include/asm/\u2026&zwnj;&#8203;)  2. I do check for vmcs errors, and panic if they happen (added to main question)  3. This would be my 12 lower EPTP bits, which I fill in alloc_ept: <code>u64 memtype : 3;                 u64 page_walk : 3;                 u64 accessed_and_dirty_flags_enabled : 1;                 u64 shadow_stack_access_rights_enforced : 1;                 u64 reserved1 : 4;</code>"}, {"owner": {"reputation": 103, "user_id": 10013007, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-a--Yg6NSJ_s/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0EUc440l43DVYt1hkQbtc7qdK84A/mo/photo.jpg?sz=128", "display_name": "Paul", "link": "https://stackoverflow.com/users/10013007/paul"}, "reply_to_user": {"reputation": 9461, "user_id": 8422330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0f90445d03447c587d1e595d531f69?s=128&d=identicon&r=PG&f=1", "display_name": "prl", "link": "https://stackoverflow.com/users/8422330/prl"}, "edited": false, "score": 0, "creation_date": 1576232272, "post_id": 59295306, "comment_id": 104840992, "body": "@prl Thanks a lot! I added the VMCS dump"}, {"owner": {"reputation": 103, "user_id": 10013007, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-a--Yg6NSJ_s/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0EUc440l43DVYt1hkQbtc7qdK84A/mo/photo.jpg?sz=128", "display_name": "Paul", "link": "https://stackoverflow.com/users/10013007/paul"}, "reply_to_user": {"reputation": 9461, "user_id": 8422330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0f90445d03447c587d1e595d531f69?s=128&d=identicon&r=PG&f=1", "display_name": "prl", "link": "https://stackoverflow.com/users/8422330/prl"}, "edited": false, "score": 0, "creation_date": 1576265979, "post_id": 59295306, "comment_id": 104857049, "body": "@prl Model 42 (Intel(R) Core(TM) i3-2130 CPU @ 3.40GHz), I forgot to mention I was using KVM nested virtualization however."}, {"owner": {"reputation": 103, "user_id": 10013007, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-a--Yg6NSJ_s/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0EUc440l43DVYt1hkQbtc7qdK84A/mo/photo.jpg?sz=128", "display_name": "Paul", "link": "https://stackoverflow.com/users/10013007/paul"}, "reply_to_user": {"reputation": 9461, "user_id": 8422330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0f90445d03447c587d1e595d531f69?s=128&d=identicon&r=PG&f=1", "display_name": "prl", "link": "https://stackoverflow.com/users/8422330/prl"}, "edited": false, "score": 0, "creation_date": 1576266167, "post_id": 59295306, "comment_id": 104857114, "body": "@prl Could you tell me your setup or point me to a guide to how to test hypervisors on real hosts? I&#39;m afraid to fry my computer with kernel panics and force reboots."}, {"owner": {"reputation": 9461, "user_id": 8422330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0f90445d03447c587d1e595d531f69?s=128&d=identicon&r=PG&f=1", "display_name": "prl", "link": "https://stackoverflow.com/users/8422330/prl"}, "edited": false, "score": 0, "creation_date": 1576266303, "post_id": 59295306, "comment_id": 104857164, "body": "I have a test machine. I agree, I wouldn&#39;t run such code on a system that I care about."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 10013007, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-a--Yg6NSJ_s/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0EUc440l43DVYt1hkQbtc7qdK84A/mo/photo.jpg?sz=128", "display_name": "Paul", "link": "https://stackoverflow.com/users/10013007/paul"}, "edited": false, "score": 0, "creation_date": 1576268352, "post_id": 59329129, "comment_id": 104857931, "body": "I checked the physical address assigned to eptp.fields.pml4_phys_addr and it was 0x3a203000, which is 30 bit long. EPTP itself is a 64 bit long construct, isn&#39;t it supposed to be above the processor physical address width?"}, {"owner": {"reputation": 103, "user_id": 10013007, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-a--Yg6NSJ_s/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0EUc440l43DVYt1hkQbtc7qdK84A/mo/photo.jpg?sz=128", "display_name": "Paul", "link": "https://stackoverflow.com/users/10013007/paul"}, "edited": false, "score": 0, "creation_date": 1576268476, "post_id": 59329129, "comment_id": 104857977, "body": "When trying to shift left 12 I am getting kernel panics (sometimes on page requests, sometimes on TLB flushes), I presume because I apply virt_to_phys later (I think because information is being lost on those shifts?)"}, {"owner": {"reputation": 103, "user_id": 10013007, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-a--Yg6NSJ_s/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0EUc440l43DVYt1hkQbtc7qdK84A/mo/photo.jpg?sz=128", "display_name": "Paul", "link": "https://stackoverflow.com/users/10013007/paul"}, "edited": false, "score": 0, "creation_date": 1576268763, "post_id": 59329129, "comment_id": 104858100, "body": "This is the struct I&#39;m using: ` typedef union EPTP {         u64 value;         struct {                 u64 memtype : 3;                 u64 page_walk : 3;                 u64 accessed_and_dirty_flags_enabled : 1;                 u64 shadow_stack_access_rights_enforced : 1;                 u64 reserved1 : 4;                 u64 pml4_phys_addr : 36;                 u64 reserved2 : 16;         } fields; } EPTP; `"}, {"owner": {"reputation": 103, "user_id": 10013007, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-a--Yg6NSJ_s/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0EUc440l43DVYt1hkQbtc7qdK84A/mo/photo.jpg?sz=128", "display_name": "Paul", "link": "https://stackoverflow.com/users/10013007/paul"}, "edited": false, "score": 0, "creation_date": 1576270257, "post_id": 59329129, "comment_id": 104858610, "body": "I see, EPT pointer is now set to 0x000000003ca8605e after applying the fixes but I&#39;m still getting the same error (0x21)"}, {"owner": {"reputation": 9461, "user_id": 8422330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0f90445d03447c587d1e595d531f69?s=128&d=identicon&r=PG&f=1", "display_name": "prl", "link": "https://stackoverflow.com/users/8422330/prl"}, "reply_to_user": {"reputation": 103, "user_id": 10013007, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-a--Yg6NSJ_s/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0EUc440l43DVYt1hkQbtc7qdK84A/mo/photo.jpg?sz=128", "display_name": "Paul", "link": "https://stackoverflow.com/users/10013007/paul"}, "edited": false, "score": 0, "creation_date": 1576270747, "post_id": 59329129, "comment_id": 104858795, "body": "Hmm, maybe this was a red herring. It needed to be fixed, but it might not have been the cause of your original symptom. I&#39;ll keep looking."}, {"owner": {"reputation": 103, "user_id": 10013007, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-a--Yg6NSJ_s/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0EUc440l43DVYt1hkQbtc7qdK84A/mo/photo.jpg?sz=128", "display_name": "Paul", "link": "https://stackoverflow.com/users/10013007/paul"}, "edited": false, "score": 0, "creation_date": 1577057319, "post_id": 59329129, "comment_id": 105080212, "body": "Hi, I finally got around to switching to VMWare for virtualizing (it really seemed to have really been an issue I only encountered on KVM) and after fixing the EPTP issue and the other page structures I am now receiving error 48 (EPT violation) on the guest linear address which is the same as the RIP address with a qualification of 0x81 (read violation). Did you encounter this during your test?"}, {"owner": {"reputation": 9461, "user_id": 8422330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0f90445d03447c587d1e595d531f69?s=128&d=identicon&r=PG&f=1", "display_name": "prl", "link": "https://stackoverflow.com/users/8422330/prl"}, "reply_to_user": {"reputation": 103, "user_id": 10013007, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-a--Yg6NSJ_s/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0EUc440l43DVYt1hkQbtc7qdK84A/mo/photo.jpg?sz=128", "display_name": "Paul", "link": "https://stackoverflow.com/users/10013007/paul"}, "edited": false, "score": 0, "creation_date": 1577060667, "post_id": 59329129, "comment_id": 105080783, "body": "Since bit 7 of exit-qual is 1 and bit 8 is 0, it means this EPT violation was caused by an access to a page table entry during a page table walk. You should check that your guest CR3 is correct, that the guest page tables are set up correctly, and that all the pages comprising the guest page tables are mapped in EPT."}], "tags": [], "owner": {"reputation": 9461, "user_id": 8422330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0f90445d03447c587d1e595d531f69?s=128&d=identicon&r=PG&f=1", "display_name": "prl", "link": "https://stackoverflow.com/users/8422330/prl"}, "is_accepted": true, "score": 2, "last_activity_date": 1576270387, "last_edit_date": 1576270387, "creation_date": 1576267425, "answer_id": 59329129, "question_id": 59295306, "link": "https://stackoverflow.com/questions/59295306/enabling-ept-in-vmx-causes-failed-entry-due-to-guest-state/59329129#59329129", "title": "Enabling EPT in VMX causes failed entry due to guest state", "body": "<p>The problem is that EPTP has non-zero bits above the processor physical address width. (The physical address width for i3-2130 is 36 bits, I think.)</p>\n\n<p>This should not be reported as an invalid guest state error. Instead it should be an invalid control field error (failed VM entry with error code 7), which is what I see when I test this on real hardware. I think KVM is virtualizing this error incorrectly.</p>\n\n<p>The only way that enabling EPT can cause an invalid guest state error is if the PDPTEs are invalid, which can only happen if the guest paging mode is PAE, not ia32e. (Section 26.3.1.6.)</p>\n\n<p>The problem in the code is that it needs to right shift the address by 12 before storing it into the phys_addr field.\nSee the definition of EPTP in section 24.6.11. The pml4_phys_addr field should contain bits 35:12 of the physical address. Bits 11:0 are not represented (since they are all 0).\nYou can use one of these solutions:</p>\n\n<p>Option A:</p>\n\n<pre><code>eptp.fields.memtype = 6;\neptp.fields.page_walk = 3;\neptp.fields.accessed_and_dirty_flags_enabled = 1;\neptp.fields.pml4_phys_addr = virt_to_phys(ept_pml4) &gt;&gt; 12;\n</code></pre>\n\n<p>Option B:</p>\n\n<pre><code>eptp.fields.memtype = 6;\neptp.fields.page_walk = 3;\neptp.fields.accessed_and_dirty_flags_enabled = 1;\neptp.value |= virt_to_phys(ept_pml4);\n</code></pre>\n\n<p>Option C:</p>\n\n<pre><code>eptp.value = virt_to_phys(ept_pml4);\neptp.fields.memtype = 6;\neptp.fields.page_walk = 3;\neptp.fields.accessed_and_dirty_flags_enabled = 1;\n</code></pre>\n\n<p>Make a similar change to all the code that initializes EPT entries.</p>\n"}], "owner": {"reputation": 103, "user_id": 10013007, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-a--Yg6NSJ_s/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0EUc440l43DVYt1hkQbtc7qdK84A/mo/photo.jpg?sz=128", "display_name": "Paul", "link": "https://stackoverflow.com/users/10013007/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "accepted_answer_id": 59329129, "answer_count": 1, "score": 0, "last_activity_date": 1576270387, "creation_date": 1576104474, "last_edit_date": 1576232162, "question_id": 59295306, "link": "https://stackoverflow.com/questions/59295306/enabling-ept-in-vmx-causes-failed-entry-due-to-guest-state", "title": "Enabling EPT in VMX causes failed entry due to guest state", "body": "<p>I'm building a hypervisor at home and I'm having an issue with entering VMX when enabling EPT.\nThe following code is used to set the guest mode, and it successfully enters VMX.\nHowever, when I enable EPT I'm getting a VMX entry failure with exception no. 33 (vm entry failure due to guest state). This is when I uncomment the following code:</p>\n\n<pre><code>vmcs_write(SECONDARY_VM_EXEC_CONTROL, adjust_msr_control(\n        MSR_IA32_VMX_PROCBASED_CTLS2, CPU_BASED_CTL2_RDTSCP | CPU_BASED_CTL2_ENABLE_INVPCID /* | CPU_BASED_CTL2_ENABLE_VPID | CPU_BASED_CTL2_ENABLE_XSAVE_XRSTORS */ | CPU_BASED_CTL2_ENABLE_EPT\n    )); &lt;--- I add CPU_BASED_CTL2_ENABLE_EPT\nvmcs_write64(EPT_POINTER, vms-&gt;eptp.value);\n</code></pre>\n\n<p>I checked with the Intel manual numerous times to make sure I'm following guest state checks and I don't see why my entry fails only when I enable EPT.\nAny suggestion/help would help, thanks :)</p>\n\n<pre><code>static noinline void vmwrite_error(unsigned long field, unsigned long value){\n         printk(KERN_ERR \"vmwrite error: reg %lx value %lx (err %d)\\n\",\n                field, value, (int)(vmcs_read(VM_INSTRUCTION_ERROR)));\n         dump_stack();\n         BUG_ON(1);\n}\n\nstatic void vmcs_write(unsigned long field, unsigned long value){\n        uint8_t err;\n        __asm__ __volatile__(\n                \"vmwrite %[value],%[field]; setna %[err]\"\n                : [err]\"=rm\"(err)\n                : [field]\"r\"(field), [value]\"r\"(value)\n               : \"cc\", \"memory\"\n        );\n        if(err)\n                vmwrite_error(field, value);\n        else\n                printk(KERN_INFO \"vmwrite log: reg %lx value %lx\\n\", field, value);\n}\n\nEPTP alloc_ept(int initial_pages_count){\n    int i;\n    EPTP eptp;\n    EPT_PML4E *ept_pml4;\n    EPT_PDPTE *ept_pdpt;\n    EPT_PDE *ept_pd;\n    EPT_PTE *ept_pt;\n    eptp.value = 0;\n\n    ept_pml4 = kzalloc(4096, GFP_KERNEL | GFP_NOWAIT);\n    if(!ept_pml4)\n        goto pml4err;\n    ept_pdpt = kzalloc(4096, GFP_KERNEL | GFP_NOWAIT);\n    if(!ept_pdpt)\n        goto pdpterr;\n    ept_pd = kzalloc(4096, GFP_KERNEL | GFP_NOWAIT);\n    if(!ept_pd)\n        goto pderr;\n    ept_pt = kzalloc(4096, GFP_KERNEL | GFP_NOWAIT);\n    if(!ept_pt)\n        goto pterr; \n\n    for(i = 0; i &lt; initial_pages_count; i++){\n        ept_pt[i].fields.read_access = 1;\n        ept_pt[i].fields.write_access = 1;\n        ept_pt[i].fields.execute_access = 1;\n        ept_pt[i].fields.ept_memtype = 6;\n        ept_pt[i].fields.phys_addr = virt_to_phys(kzalloc(4096, GFP_KERNEL | GFP_NOWAIT));\n    }\n\n    ept_pd-&gt;fields.read_access = 1;\n    ept_pd-&gt;fields.write_access = 1;\n    ept_pd-&gt;fields.execute_access = 1;\n    ept_pd-&gt;fields.phys_addr = virt_to_phys(ept_pt);    \n\n    ept_pdpt-&gt;fields.read_access = 1;\n    ept_pdpt-&gt;fields.write_access = 1;\n    ept_pdpt-&gt;fields.execute_access = 1;\n    ept_pdpt-&gt;fields.phys_addr = virt_to_phys(ept_pd);\n\n    ept_pml4-&gt;fields.read_access = 1;\n    ept_pml4-&gt;fields.write_access = 1;\n    ept_pml4-&gt;fields.execute_access = 1;\n    ept_pml4-&gt;fields.phys_addr = virt_to_phys(ept_pdpt);\n\n    eptp.fields.memtype = 6;\n    eptp.fields.page_walk = 3;\n    eptp.fields.accessed_and_dirty_flags_enabled = 1;\n    eptp.fields.pml4_phys_addr = virt_to_phys(ept_pml4);\n\n    return eptp;\n\n    pterr:\n    kfree(ept_pd);\n    pderr:\n    kfree(ept_pdpt);\n    pdpterr:\n    kfree(ept_pml4);\n    pml4err:\n    panic(\"EPT ALLOC ERROR!\");\n}\n\nstatic void setup_vm_code(vmstate *vms){\n    int i;\n        EPT_PML4E *pml = phys_to_virt(vms-&gt;eptp.fields.pml4_phys_addr);\n        EPT_PDPTE *pdpt = phys_to_virt(pml-&gt;fields.phys_addr);\n        EPT_PDE *pd = phys_to_virt(pdpt-&gt;fields.phys_addr);\n        EPT_PTE *pt = phys_to_virt(pd-&gt;fields.phys_addr);\n\n    vms-&gt;initial_rip = (unsigned long)phys_to_virt(pt[0].fields.phys_addr);\n    for(i = 0; i &lt; 4096; i++){  \n        // hlt\n        *(char*)(vms-&gt;initial_rip+i) = 0xf4;\n    }\n    printk(KERN_INFO \"INITIAL_RIP: %lu\", vms-&gt;initial_rip);\n    // Stack grows down\n    vms-&gt;initial_rsp = (unsigned long)phys_to_virt(pt[9].fields.phys_addr) + 4095;\n}\n\nstatic void prepare_vmx_cpu(void *info){\n    uint32_t vmcs_revid = 0;\n    uint32_t hi = 0;\n    vmstate *vms = per_cpu(cpu_vms, smp_processor_id());\n\n    // Populate VMCS revision id in vmxon region\n    rdmsr_safe(MSR_IA32_VMX_BASIC, &amp;vmcs_revid, &amp;hi);\n    memcpy(vms-&gt;vmxon_region, &amp;vmcs_revid, 4);\n    memcpy(vms-&gt;vmcs_region, &amp;vmcs_revid, 4);\n\n    vms-&gt;eptp = alloc_ept(10);\n    setup_vm_code(vms);\n\n    vmx_enable();   \n}\n\n//static void handle_vmexit(void) __attribute__((used));\nstatic void handle_vmexit(void){\n    int exit_reason = vmcs_read32(VM_EXIT_REASON);\n    int basic_exit_code = exit_reason &amp; 0xffff;\n    int exit_qualification = vmcs_read32(EXIT_QUALIFICATION);\n    int vm_entry_failure = exit_reason &amp; 0x80000000;\n    panic(\"VMEXIT WITH CODE %d, VM ENTRY FAILURE: %s, QUAL: %d\", basic_exit_code, vm_entry_failure ? \"true\" : \"false\", exit_qualification);\n    vmx_dump_cpu();\n    panic(\"ERR\");\n    VMRESUME();\n    //TODO: switch error reasons\n}\n\nstatic void vmx_setup_vm_controls(void){\n    // VM Execution Controls\n    vmcs_write(PIN_BASED_VM_EXEC_CONTROL, adjust_msr_control(MSR_IA32_VMX_PINBASED_CTLS, 0));\n    vmcs_write(CPU_BASED_VM_EXEC_CONTROL, adjust_msr_control(\n        MSR_IA32_VMX_PROCBASED_CTLS, CPU_BASED_HLT_EXITING | CPU_BASED_ACTIVATE_SECONDARY_CONTROLS));\n    vmcs_write(SECONDARY_VM_EXEC_CONTROL, adjust_msr_control(\n        MSR_IA32_VMX_PROCBASED_CTLS2, CPU_BASED_CTL2_RDTSCP | CPU_BASED_CTL2_ENABLE_INVPCID /* | CPU_BASED_CTL2_ENABLE_VPID | CPU_BASED_CTL2_ENABLE_XSAVE_XRSTORS */ | CPU_BASED_CTL2_ENABLE_EPT\n    ));\n\n    //vmcs_write64(TSC_OFFSET, 0);  \n\n    vmcs_write(CR0_READ_SHADOW, read_cr0());\n    vmcs_write(CR4_READ_SHADOW, __read_cr4());\n    vmcs_write(CR0_GUEST_HOST_MASK, ~0ul);\n    vmcs_write(CR4_GUEST_HOST_MASK, ~0ul);\n\n    // How many CR3_TARGET_VALUEs are considered without VM exit when MOV CR3, VAL\n    vmcs_write(CR3_TARGET_COUNT, 0);\n\n    // VM Entry &amp; Exit Controls\n    vmcs_write(VM_EXIT_CONTROLS, adjust_msr_control(MSR_IA32_VMX_EXIT_CTLS, VM_EXIT_IA32E_MODE | VM_EXIT_LOAD_IA32_EFER | VM_EXIT_HOST_ADDR_SPACE_SIZE));\n    vmcs_write(VM_ENTRY_CONTROLS, adjust_msr_control(MSR_IA32_VMX_ENTRY_CTLS, VM_ENTRY_IA32E_MODE | VM_ENTRY_LOAD_IA32_EFER));\n}\n\nstatic void vmx_setup_initial_host_state(vmstate *vms){\n    struct desc_ptr gdtptr, idt;\n\n    vmcs_write(HOST_CR0, read_cr0());\n    vmcs_write(HOST_CR3, __read_cr3());\n    vmcs_write(HOST_CR4, __read_cr4());\n    vmcs_write(HOST_RSP, (unsigned long)vms-&gt;vmm_handle_stack + vms-&gt;vmm_handle_stack_size - 1);\n    vmcs_write(HOST_RIP, (unsigned long)handle_vmexit);\n\n    /* An explanation of segment selectors: https://medium.com/hungys-blog/linux-kernel-memory-addressing-a0d304283af3 */\n    // Segment Selectors\n    vmcs_write(HOST_CS_SELECTOR, __KERNEL_CS);\n    vmcs_write(HOST_DS_SELECTOR, __KERNEL_DS);\n    vmcs_write(HOST_ES_SELECTOR, __KERNEL_DS);\n    vmcs_write(HOST_SS_SELECTOR, __KERNEL_DS);\n    vmcs_write(HOST_FS_SELECTOR, 0);\n    vmcs_write(HOST_GS_SELECTOR, 0);\n    vmcs_write(HOST_TR_SELECTOR, GDT_ENTRY_TSS*8);\n\n    // Segment Base Adresses\n    vmcs_write(HOST_FS_BASE, native_read_msr(MSR_FS_BASE));\n    vmcs_write(HOST_GS_BASE, native_read_msr(MSR_GS_BASE));\n    vmcs_write(HOST_TR_BASE, read_tr_base());\n    native_store_gdt(&amp;gdtptr);\n    vmcs_write(HOST_GDTR_BASE, gdtptr.address);\n    store_idt(&amp;idt);\n    vmcs_write(HOST_IDTR_BASE, idt.address);\n\n    // MSRs\n    vmcs_write(HOST_IA32_SYSENTER_CS, native_read_msr(MSR_IA32_SYSENTER_CS));\n    vmcs_write(HOST_IA32_SYSENTER_ESP, native_read_msr(MSR_IA32_SYSENTER_ESP));\n    vmcs_write(HOST_IA32_SYSENTER_EIP, native_read_msr(MSR_IA32_SYSENTER_EIP));\n    vmcs_write64(HOST_IA32_EFER, native_read_msr(MSR_EFER));\n}\n\nstatic void RIPTEST(void) __attribute__((used));\nstatic void RIPTEST(void){\n    __asm__ __volatile__(\"hlt; hlt; hlt; hlt; hlt; hlt\");\n}\n\nstatic void vmx_setup_initial_guest_state(vmstate *vms){\n    vmcs_write(GUEST_CR0, read_cr0());\n    vmcs_write(GUEST_CR3, __read_cr3());\n    vmcs_write(GUEST_CR4, __read_cr4());\n    vmcs_write(GUEST_DR7, 0);\n\n    vmcs_write(GUEST_RIP, vms-&gt;initial_rip);\n    //vmcs_write(GUEST_RIP, (unsigned long)RIPTEST);\n    vmcs_write(GUEST_RSP, vms-&gt;initial_rsp);\n    vmcs_write(GUEST_RFLAGS, 0x2); // Reserved flag\n\n    // Setup selectors\n    vmcs_write(GUEST_CS_SELECTOR, 0);\n    vmcs_write(GUEST_SS_SELECTOR, 0);\n    vmcs_write(GUEST_DS_SELECTOR, 0);\n    vmcs_write(GUEST_ES_SELECTOR, 0);\n    vmcs_write(GUEST_FS_SELECTOR, 0);\n    vmcs_write(GUEST_GS_SELECTOR, 0);\n    vmcs_write(GUEST_LDTR_SELECTOR, 0);\n    vmcs_write(GUEST_TR_SELECTOR, 0);\n\n    // Setup base addresses\n    vmcs_write(GUEST_CS_BASE, 0);\n    vmcs_write(GUEST_SS_BASE, 0);\n    vmcs_write(GUEST_DS_BASE, 0);\n    vmcs_write(GUEST_ES_BASE, 0);\n    vmcs_write(GUEST_FS_BASE, native_read_msr(MSR_FS_BASE));\n    vmcs_write(GUEST_GS_BASE, native_read_msr(MSR_GS_BASE));\n    vmcs_write(GUEST_LDTR_BASE, 0);\n    vmcs_write(GUEST_TR_BASE, 0);\n\n    // Setup guest segment limits   \n    vmcs_write(GUEST_CS_LIMIT, 0xFFFFFFFF);\n    vmcs_write(GUEST_SS_LIMIT, 0xFFFFFFFF);\n    vmcs_write(GUEST_DS_LIMIT, 0xFFFFFFFF);\n    vmcs_write(GUEST_ES_LIMIT, 0xFFFFFFFF);\n    vmcs_write(GUEST_FS_LIMIT, 0xFFFFFFFF);\n    vmcs_write(GUEST_GS_LIMIT, 0xFFFFFFFF);\n    vmcs_write(GUEST_LDTR_LIMIT, 0);\n    vmcs_write(GUEST_TR_LIMIT, 0xFF);\n\n    // Setup guest segment access rights\n    // https://www.amd.com/system/files/TechDocs/24593.pdf#G10.910849\n    vmcs_write(GUEST_CS_AR_BYTES, 0xA09B);\n    vmcs_write(GUEST_SS_AR_BYTES, 0xA093);\n    vmcs_write(GUEST_DS_AR_BYTES, 0xA093);\n    vmcs_write(GUEST_ES_AR_BYTES, 0xA093);\n    vmcs_write(GUEST_FS_AR_BYTES, 0xA093);\n    vmcs_write(GUEST_GS_AR_BYTES, 0xA093);\n    vmcs_write(GUEST_LDTR_AR_BYTES, 0x0082);\n    vmcs_write(GUEST_TR_AR_BYTES, 0x008B);\n\n    // Setup GDTR &amp; IDTR\n    vmcs_write(GUEST_GDTR_BASE, 0);\n    vmcs_write(GUEST_IDTR_BASE, 0);\n    vmcs_write(GUEST_GDTR_LIMIT, 0);\n    vmcs_write(GUEST_IDTR_LIMIT, 0);\n\n    vmcs_write(GUEST_IA32_EFER, native_read_msr(MSR_EFER));\n    vmcs_write64(GUEST_IA32_DEBUGCTL, 0);\n\n    // Setup sysenter primitives\n    vmcs_write(GUEST_SYSENTER_CS, 0);\n    vmcs_write(GUEST_SYSENTER_ESP, 0);\n    vmcs_write(GUEST_SYSENTER_EIP, 0);\n}\n\nstatic void init_vmcs(vmstate *vms){\n    VMPTRLD(vms-&gt;vmcs_physical);\n    vmx_setup_vm_controls();\n    vmx_setup_initial_guest_state(vms);\n    vmx_setup_initial_host_state(vms);\n\n    vmcs_write64(VMCS_LINK_POINTER, -1ull);\n\n    //vmcs_write(EXCEPTION_BITMAP, 8192);\n\n    vmcs_write64(EPT_POINTER, vms-&gt;eptp.value);\n    //vmcs_write(VIRTUAL_PROCESSOR_ID, vms-&gt;vpid);\n}\n\nint vmx_launch(void){\n    int cpu = smp_processor_id();\n    vmstate *vms = per_cpu(cpu_vms, smp_processor_id());\n\n    printk(KERN_INFO \"Launching VM on CPU %d\\n\", cpu);\n    init_vmcs(vms);\n    VMLAUNCH();\n\n    put_cpu();\n    return 0;\n}\n\nint vmx_setup(void){\n    int i;\n    vmstate* vms;\n    printk(KERN_INFO \"NUM CPUS: %d\\n\", num_online_cpus());\n\n    for_each_online_cpu(i){\n        vms = create_vmstate();\n        vms-&gt;vmxon_region = kmalloc(4096, GFP_KERNEL);\n        vms-&gt;vmxon_physical = virt_to_phys(vms-&gt;vmxon_region);\n        vms-&gt;vmcs_region = kzalloc(4096, GFP_KERNEL);\n        vms-&gt;vmcs_physical = virt_to_phys(vms-&gt;vmcs_region);\n        vms-&gt;vmm_handle_stack_size = 4096;\n        vms-&gt;vmm_handle_stack = kmalloc(vms-&gt;vmm_handle_stack_size, GFP_KERNEL);\n        vms-&gt;vpid = get_free_vpid();\n        per_cpu(cpu_vms, i) = vms;\n    }\n\n    on_each_cpu(prepare_vmx_cpu, NULL, 1);\n    printk(KERN_INFO \"CPUS prepared!\");\n\n    for_each_online_cpu(i){\n        vms = per_cpu(cpu_vms, i);\n        if(vms-&gt;vmx_enabled == false) {\n            printk(KERN_ALERT \"Tearing down after VMXON failed!\");\n            vmx_teardown();\n            return -1;\n        }\n    }\n    printk(KERN_INFO \"VMX turned on for all CPUs!\");\n    return 0;\n}\n</code></pre>\n\n<p>VMCS dump:</p>\n\n<pre><code>***Guest State***\n[   72.414906] CR0: actual=0x0000000080050033, shadow=0x0000000080050033, gh_mask=ffffffffffffffff\n[   72.416865] CR4: actual=0x00000000000626e0, shadow=0x00000000000626e0, gh_mask=ffffffffffffffff\n[   72.419147] CR3 = 0x00000000307ce004\n[   72.419950] PDPTR0 = 0x0000000000000000  PDPTR1 = 0x0000000000000000\n[   72.421384] PDPTR2 = 0x0000000000000000  PDPTR3 = 0x0000000000000000\n[   72.422753] RSP = 0xffff9c9cb31f8fff  RIP = 0xffff9c9cb5005000\n[   72.424510] RFLAGS=0x00000002         DR7 = 0x0000000000000000\n[   72.426501] Sysenter RSP=0000000000000000 CS:RIP=0000:0000000000000000\n[   72.428141] CS:   sel=0x0000, attr=0x0a09b, limit=0xffffffff, base=0x0000000000000000\n[   72.430162] DS:   sel=0x0000, attr=0x0a093, limit=0xffffffff, base=0x0000000000000000\n[   72.432075] SS:   sel=0x0000, attr=0x0a093, limit=0xffffffff, base=0x0000000000000000\n[   72.433982] ES:   sel=0x0000, attr=0x0a093, limit=0xffffffff, base=0x0000000000000000\n[   72.436152] FS:   sel=0x0000, attr=0x0a093, limit=0xffffffff, base=0x00007f8e51f0c4c0\n[   72.438437] GS:   sel=0x0000, attr=0x0a093, limit=0xffffffff, base=0xffff9c9cbeb00000\n[   72.440579] GDTR:                           limit=0x00000000, base=0x0000000000000000\n[   72.442241] LDTR: sel=0x0000, attr=0x00082, limit=0x00000000, base=0x0000000000000000\n[   72.443414] IDTR:                           limit=0x00000000, base=0x0000000000000000\n[   72.444591] TR:   sel=0x0000, attr=0x0008b, limit=0x000000ff, base=0x0000000000000000\n[   72.447023] EFER =     0x0000000000000d01  PAT = 0x0000000000000000\n[   72.448999] DebugCtl = 0x0000000000000000  DebugExceptions = 0x0000000000000000\n[   72.451813] PerfGlobCtl = 0x0000000000000000\n[   72.453316] BndCfgS = 0x0000000000000000\n[   72.454528] Interruptibility = 00000000  ActivityState = 00000000\n[   72.456302] InterruptStatus = 0000\n[   72.456997] *** Host State ***\n[   72.457622] RIP = 0xffffffffc0789b90  RSP = 0xffff9c9cb5019fff\n[   72.458766] CS=0010 SS=0018 DS=0018 ES=0018 FS=0000 GS=0000 TR=0040\n[   72.460007] FSBase=00007f8e51f0c4c0 GSBase=ffff9c9cbeb00000 TRBase=0000000000000000\n[   72.461588] GDTBase=fffffe000002c000 IDTBase=fffffe0000000000\n[   72.462711] CR0=0000000080050033 CR3=00000000307ce004 CR4=00000000000626e0\n[   72.464083] Sysenter RSP=fffffe000002d200 CS:RIP=0010:ffffffff848015f0\n[   72.465472] EFER = 0x0000000000000d01  PAT = 0x0000000000000000\n[   72.467041] PerfGlobCtl = 0x0000000000000000\n[   72.468110] *** Control State ***\n[   72.469024] PinBased=00000016 CPUBased=8401e1f2 SecondaryExec=0000000a\n[   72.470863] EntryControls=000093ff ExitControls=00236fff\n[   72.472268] ExceptionBitmap=00000000 PFECmask=00000000 PFECmatch=00000000\n[   72.474137] VMEntry: intr_info=00000000 errcode=00000000 ilen=00000000\n[   72.475580] VMExit: intr_info=00000000 errcode=00000000 ilen=00000000\n[   72.477230]         reason=80000021 qualification=0000000000000000\n[   72.478806] IDTVectoring: info=00000000 errcode=00000000\n[   72.480156] TSC Offset = 0x0000000000000000\n[   72.481316] SVI|RVI = 00|00 TPR Threshold = 0x00\n[   72.482305] APIC-access addr = 0x0000000000000000 virt-APIC addr = 0x0000000000000000\n[   72.484216] PostedIntrVec = 0x00\n[   72.484928] EPT pointer = 0x000003500200005e\n[   72.485835] Virtual processor ID = 0x0000\n</code></pre>\n"}, {"tags": ["c", "xcode", "gtk"], "comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1576190792, "post_id": 59295215, "comment_id": 104829351, "body": "Have you considered to try <a href=\"http://codeblocks.org\" rel=\"nofollow noreferrer\">CodeBlocks</a>. <a href=\"https://www.youtube.com/playlist?list=PLN_MPJUQgPVpC2HcWuWqMiVbAlzHdl8TM\" rel=\"nofollow noreferrer\">Take a Look also here, it is about LinuxMint but you can make you an idea.</a>. There are lots of GTK3 Tutorials as well."}, {"owner": {"reputation": 746, "user_id": 12126234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b10a7b87642cedea860405eebe2625b2?s=128&d=identicon&r=PG&f=1", "display_name": "lb90", "link": "https://stackoverflow.com/users/12126234/lb90"}, "edited": false, "score": 0, "creation_date": 1576258022, "post_id": 59295215, "comment_id": 104853731, "body": "Hi! Take a look at homebrew: <a href=\"https://brew.sh/\" rel=\"nofollow noreferrer\">brew.sh</a> <a href=\"https://formulae.brew.sh/formula/gtk+3\" rel=\"nofollow noreferrer\">formulae.brew.sh/formula/gtk+3</a>"}], "owner": {"reputation": 1, "user_id": 12097222, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDgkkbiCAOgXenjwTPUr9VXIXgZ9b4TgKBcIayQwA=k-s128", "display_name": "Cl0ser", "link": "https://stackoverflow.com/users/12097222/cl0ser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576104011, "creation_date": 1576104011, "question_id": 59295215, "link": "https://stackoverflow.com/questions/59295215/gtk-for-c-in-xcode", "title": "GTK for C in Xcode", "body": "<p>My setup: MacOS 10.15.2, Xcode 11.3\nPlease help me to install gtk for C in Xcode\nI've already tried but always get \"file not found\"\nOn their website there is an information about installation: they offer to use an installation file but link for it doesn't work and it can't help with installation to Xcode\nWhat should I do?</p>\n"}, {"tags": ["c", "scanf", "codeblocks"], "comments": [{"owner": {"reputation": 378, "user_id": 2620017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517078d0e5e19b98b4b8c7228da5aadf?s=128&d=identicon&r=PG", "display_name": "hko", "link": "https://stackoverflow.com/users/2620017/hko"}, "edited": false, "score": 2, "creation_date": 1576103139, "post_id": 59294972, "comment_id": 104794490, "body": "scanf doesn&#39;t consume the input if it can&#39;t parse it. So it will parse y over and over again."}, {"owner": {"reputation": 378, "user_id": 2620017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517078d0e5e19b98b4b8c7228da5aadf?s=128&d=identicon&r=PG", "display_name": "hko", "link": "https://stackoverflow.com/users/2620017/hko"}, "edited": false, "score": 1, "creation_date": 1576103245, "post_id": 59294972, "comment_id": 104794523, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/58434411/how-to-fix-infinite-loops-when-user-enters-wrong-data-type-in-scanf\">How to fix infinite loops when user enters wrong data type in scanf()?</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 378, "user_id": 2620017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517078d0e5e19b98b4b8c7228da5aadf?s=128&d=identicon&r=PG", "display_name": "hko", "link": "https://stackoverflow.com/users/2620017/hko"}, "edited": false, "score": 2, "creation_date": 1576104433, "post_id": 59294972, "comment_id": 104794882, "body": "@hko \u2014 thanks for the duplicate search.  I used the second (much older) question that you found as the reference."}], "answers": [{"tags": [], "owner": {"reputation": 495, "user_id": 5791141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f68cd2ee477fc0cf910e7400935670c3?s=128&d=identicon&r=PG&f=1", "display_name": "foreverska", "link": "https://stackoverflow.com/users/5791141/foreverska"}, "is_accepted": false, "score": 0, "last_activity_date": 1576103234, "creation_date": 1576103234, "answer_id": 59295074, "question_id": 59294972, "link": "https://stackoverflow.com/questions/59294972/c-programming-scanf-will-not-read-input-twice/59295074#59295074", "title": "c programming scanf will not read input twice", "body": "<p>One way to approach this kind of thing is to take in a string (pick you poison on function) and then use sscanf to try and parse it.</p>\n"}, {"tags": [], "owner": {"reputation": 1692, "user_id": 12433504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/667a21f48cc9b08d6adf0005669d9955?s=128&d=identicon&r=PG", "display_name": "VillageTech", "link": "https://stackoverflow.com/users/12433504/villagetech"}, "is_accepted": true, "score": 0, "last_activity_date": 1576103687, "creation_date": 1576103687, "answer_id": 59295163, "question_id": 59294972, "link": "https://stackoverflow.com/questions/59294972/c-programming-scanf-will-not-read-input-twice/59295163#59295163", "title": "c programming scanf will not read input twice", "body": "<p>In case of bad input entry, the input buffer is not consumed by <code>scanf()</code>, so you must read it additionaly in the way which guarantee successfull reading - for example as string.</p>\n\n<p>See below:</p>\n\n<pre><code>int main()\n{\n    float a = 0;\n\n    while (scanf(\" %f\", &amp; a) == 0)\n    {\n        scanf(\"%*s\"); // additional \"blind\" read\n\n        printf(\"reenter\");\n    }\n\n    printf(\"%f\", a);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 12440042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61b131fe4ed01b842deafaa1f97e7774?s=128&d=identicon&r=PG&f=1", "display_name": "Maverick", "link": "https://stackoverflow.com/users/12440042/maverick"}, "is_accepted": false, "score": 0, "last_activity_date": 1576104016, "creation_date": 1576104016, "answer_id": 59295217, "question_id": 59294972, "link": "https://stackoverflow.com/questions/59294972/c-programming-scanf-will-not-read-input-twice/59295217#59295217", "title": "c programming scanf will not read input twice", "body": "<p>You need to clean the input. Try with this </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt; \n\nint main()\n{\n    float a = 0;\n\n    while(scanf(\"%f\", &amp;a) == 0) {\n        printf(\"reenter\\n\");\n        while((getchar()) != '\\n'); \n    }\n\n    printf(\"%f\", a);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5492561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53c1f5b64e64fea12c5be5adb49e5dde?s=128&d=identicon&r=PG&f=1", "display_name": "uri2563", "link": "https://stackoverflow.com/users/5492561/uri2563"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "closed_date": 1576104390, "accepted_answer_id": 59295163, "answer_count": 3, "score": 0, "last_activity_date": 1576104016, "creation_date": 1576102743, "last_edit_date": 1576103628, "question_id": 59294972, "link": "https://stackoverflow.com/questions/59294972/c-programming-scanf-will-not-read-input-twice", "closed_reason": "Duplicate", "title": "c programming scanf will not read input twice", "body": "<p>I am writing a program in CodeBlocks in C. I want to check if the input is in the right type and if not try to get it again.</p>\n\n<p>My problem is whenever I'm trying to get the input with scanf and the input is incorrect it won't enter scanf again and just keep looping as if the input is always incorrect.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt; \n\nint main()\n{\n    float a = 0;\n\n    while(scanf(\" %f\", &amp; a) == 0)\n    {\n        printf(\"reenter\");\n    }\n\n    printf(\"%f\", a);\n\n    return 0;\n}\n</code></pre>\n\n<p>When I tried to enter incorrect value as 'y' the loop will go on:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cgRql.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cgRql.png\" alt=\"enter image description here\"></a></p>\n\n<p>If I will enter a current value it will get it as it should.</p>\n"}, {"tags": ["c", "format"], "comments": [{"owner": {"reputation": 1080, "user_id": 11890657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e128d9b341fa1abad09bab0576aacd7f?s=128&d=identicon&r=PG&f=1", "display_name": "Chelmy88", "link": "https://stackoverflow.com/users/11890657/chelmy88"}, "edited": false, "score": 0, "creation_date": 1576102253, "post_id": 59294819, "comment_id": 104794205, "body": "String in C is not straightforward, you can start by having a look here: <a href=\"https://www.tutorialspoint.com/cprogramming/c_strings.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/cprogramming/c_strings.htm</a>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1576143270, "post_id": 59294819, "comment_id": 104805855, "body": "If glib and dynamic memory allocation are an option four you, you could take a look at <a href=\"https://developer.gnome.org/glib/stable/glib-String-Utility-Functions.html#g-strdup-printf\" rel=\"nofollow noreferrer\">g_strdup_printf</a>"}], "answers": [{"tags": [], "owner": {"reputation": 495, "user_id": 5791141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f68cd2ee477fc0cf910e7400935670c3?s=128&d=identicon&r=PG&f=1", "display_name": "foreverska", "link": "https://stackoverflow.com/users/5791141/foreverska"}, "is_accepted": true, "score": 2, "last_activity_date": 1576102429, "creation_date": 1576102429, "answer_id": 59294919, "question_id": 59294819, "link": "https://stackoverflow.com/questions/59294819/snprintf-with-unknown-size-of-the-char/59294919#59294919", "title": "snprintf with unknown size of the char[]", "body": "<p>At some point you must know how long your string will be.  Simple examples like this you can just choose a sufficiently big number.  You're doing the right thing using snprintf if you happen to be wrong at some point.  In cases where this isn't possible snprintf returns the number of characters it will use if the first two parameters are NULL and 0.  From there you malloc and free buffers determined at runtime.</p>\n\n<pre><code>size_t size = snprintf(NULL, 0, ...);\nchar* str = malloc(size);\nsnprintf(str, size, ...);\n//After doing what you want with the string\nfree(str);\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12340167"}, "edited": false, "score": 0, "creation_date": 1576141992, "post_id": 59301049, "comment_id": 104805166, "body": "thank you for tour answer. I would save this string struct somewhere so I can use and improve it."}], "tags": [], "owner": {"reputation": 1109, "user_id": 1887602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5520b4adf006e9c93ccbcca0036b4e94?s=128&d=identicon&r=PG&f=1", "display_name": "Koldar", "link": "https://stackoverflow.com/users/1887602/koldar"}, "is_accepted": false, "score": 0, "last_activity_date": 1576141666, "creation_date": 1576141666, "answer_id": 59301049, "question_id": 59294819, "link": "https://stackoverflow.com/questions/59294819/snprintf-with-unknown-size-of-the-char/59301049#59301049", "title": "snprintf with unknown size of the char[]", "body": "<p>C doesn't work like your typical high-level language.\nYou are required to alloc every bit of memory you want to use (either be it on the stack or on the heap). That's why on the internet people usually do stuff like <code>char str[100]</code>: they are saying: I'm not expecting a string longer than 99 characters (+ '\\0' char at the end of the string).</p>\n\n<p>If you want your typical Java <code>string</code>, you need to create it yourself from scratch. Here's a demo of an implementation with no-so-good performances. variadic string api is left to the reader :)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;string.h&gt;\n\nstruct string_t {\n    ///number of bytes of the string (\\0 included)\n    size_t capacity;\n    ///strlen of the string\n    size_t len;\n    ///pointer to the actual string\n    char* str;\n};\n\nstruct string_t* newString(const char* str);\nvoid initString(struct string_t* this);\nvoid destroyString(const struct string_t* this);\nbool isEmpty(const struct string_t* this);\nvoid tryExpand(struct string_t* this, size_t additionalSpace);\nchar* getNullTerminatorAddress(const struct string_t* this);\nvoid setString(struct string_t* this, const char* other);\n\nstruct string_t* newString(const char* str) {\n    struct string_t* result = malloc(sizeof(struct string_t));\n    if (result == NULL) {\n        fprintf(stderr, \"error!\\n\");\n        exit(1);\n    }\n    initString(result);\n    setString(result, str);\n    return result;\n}\n\nvoid initString(struct string_t* this) {\n    this-&gt;len = 0;\n    this-&gt;capacity;\n    this-&gt;str = 0;\n}\n\nvoid destroyString(const struct string_t* this) {\n    if (this-&gt;str != NULL) {\n        free((char*)this-&gt;str);\n    }\n    free((char*)this);\n}\n\nbool isEmpty(const struct string_t* this) {\n    return this-&gt;len == 0;\n}\n\nvoid tryExpand(struct string_t* this, size_t additionalSpace) {\n    if ((this-&gt;len + additionalSpace) &gt; this-&gt;capacity) {\n        if (this-&gt;str != NULL) {\n            int newcapacity = this-&gt;len + additionalSpace;\n            this-&gt;str = realloc(this-&gt;str, newcapacity);\n            this-&gt;capacity = newcapacity;\n        } else {\n            this-&gt;str = malloc(sizeof(char) * additionalSpace);\n            if (this-&gt;str == NULL) {\n                exit(1);\n            }\n        }\n    }\n}\n\nvoid trySetting(struct string_t* this, size_t spaceRequired) {\n    if ((spaceRequired) &gt; this-&gt;capacity) {\n        if (this-&gt;str != NULL) {\n            int newcapacity = spaceRequired;\n            this-&gt;str = realloc(this-&gt;str, newcapacity);\n            this-&gt;capacity = newcapacity;\n        } else {\n            this-&gt;str = malloc(sizeof(char) * spaceRequired);\n            if (this-&gt;str == NULL) {\n                exit(1);\n            }\n            this-&gt;capacity = spaceRequired;\n        }\n    }\n}\n\nchar* getNullTerminatorAddress(const struct string_t* this) {\n    if (this-&gt;str != NULL) {\n        return &amp;this-&gt;str[this-&gt;len];\n    } else {\n        exit(2);\n    }\n}\n\nvoid setString(struct string_t* this, const char* other) {\n    int alen = strlen(other);\n    trySetting(this, alen + 1);\n    //beware of buffer overrun\n    strcpy(this-&gt;str, other);\n    this-&gt;len = alen;\n}\n\nvoid appendString(struct string_t* this, const char* other) {\n    int alen = strlen(other);\n    tryExpand(this, alen + 1);\n    //beware of buffer overrun\n    strcpy(getNullTerminatorAddress(this), other);\n    this-&gt;len += alen;\n}\n\nvoid appendInt(struct string_t* this, int other) {\n    int bytes = snprintf( NULL, 0, \"%d\", other); //0 not considered\n    tryExpand(this, bytes + 1);\n    snprintf(getNullTerminatorAddress(this), bytes+1, \"%d\", other);\n    this-&gt;len += bytes;\n}\n\nconst char* getString(const struct string_t* this) {\n    return (const char*)this-&gt;str;\n}\n\nint getLength(const struct string_t* this) {\n    return this-&gt;len;\n}\n\nint getCapacity(const struct string_t* this) {\n    return this-&gt;capacity;\n}\n\nint main() {\n    int points = 5;\n    int total = 10;\n    struct string_t* str = newString(\"You have \");\n    appendInt(str, points);\n    appendString(str, \" points (total: \");\n    appendInt(str, total);\n    appendString(str, \")\");\n\n    printf(\"%s\\n\", getString(str));\n    destroyString(str);\n    return 0;\n}\n\n</code></pre>\n\n<p>Note you can retrieve the number of bytes to write in <code>snprintf</code> thanks to the trick of <a href=\"https://stackoverflow.com/a/32819876/1887602\">user2622016</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12340167"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 59294919, "answer_count": 2, "score": 0, "last_activity_date": 1576141666, "creation_date": 1576101979, "question_id": 59294819, "link": "https://stackoverflow.com/questions/59294819/snprintf-with-unknown-size-of-the-char", "title": "snprintf with unknown size of the char[]", "body": "<p>How one can create a char array with an unspecified size and then pass it to <code>snprint</code> for formatting it?<br>\nFor example:  </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char str[];\nint total = 100;\nint points = 20;\nsnprintf(str, sizeof(str), \"You have %d points (total: %d)\", points, total);\nprintf(\"%s\\n\",str);\n</code></pre>\n\n<p>This code is going certainly send me an error because first line is wrong.<br>\nAll the examples I saw on internet had something like <code>str[100]</code>.<br>\nI am new to C programming and I would appreciate it if you don't down vote this post.<br>\nThank you</p>\n"}, {"tags": ["c", "assembly", "x86", "shellcode"], "comments": [{"owner": {"reputation": 495, "user_id": 5791141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f68cd2ee477fc0cf910e7400935670c3?s=128&d=identicon&r=PG&f=1", "display_name": "foreverska", "link": "https://stackoverflow.com/users/5791141/foreverska"}, "edited": false, "score": 0, "creation_date": 1576103958, "post_id": 59294813, "comment_id": 104794742, "body": "Is <code>decrypted(&quot;HI&quot;);</code> a typo?  You went through all the trouble to cast it to <code>func</code> and didn&#39;t bother to use your newfound pointer."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1576104769, "post_id": 59294813, "comment_id": 104794987, "body": "Do you really mean &quot;convert to hex&quot;, or did you really mean simply the binary machine code of the compiled function? The hexadecimal representation is simply a presentation on the binary data for convenience and readability - it is not actually stored as hex digits.  Either way there are a number of issues with what you are trying to do; you assume that the compiled machine code is position independent, and you are trying to execute <i>data</i> which modern operating systems on processors with an MMU will normally prevent you from doing for security reasons."}, {"owner": {"reputation": 105, "user_id": 8257360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c96a1bb9e939d87d047710ed944ec22a?s=128&d=identicon&r=PG&f=1", "display_name": "user282909", "link": "https://stackoverflow.com/users/8257360/user282909"}, "reply_to_user": {"reputation": 495, "user_id": 5791141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f68cd2ee477fc0cf910e7400935670c3?s=128&d=identicon&r=PG&f=1", "display_name": "foreverska", "link": "https://stackoverflow.com/users/5791141/foreverska"}, "edited": false, "score": 0, "creation_date": 1576104833, "post_id": 59294813, "comment_id": 104795006, "body": "@foreverska yep that was a typo. It;s corrected now."}, {"owner": {"reputation": 105, "user_id": 8257360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c96a1bb9e939d87d047710ed944ec22a?s=128&d=identicon&r=PG&f=1", "display_name": "user282909", "link": "https://stackoverflow.com/users/8257360/user282909"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1576104901, "post_id": 59294813, "comment_id": 104795027, "body": "@Clifford yeah I basically mean binary machine code. Say a shellcode for example how would I convert func() into a <code>shellcode</code> so I can exec it at runtime without exposing the instructions."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1576105353, "post_id": 59294813, "comment_id": 104795154, "body": "Use an assembler to generate machine code. To run it make sure you place it into executable memory."}, {"owner": {"reputation": 495, "user_id": 5791141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f68cd2ee477fc0cf910e7400935670c3?s=128&d=identicon&r=PG&f=1", "display_name": "foreverska", "link": "https://stackoverflow.com/users/5791141/foreverska"}, "edited": false, "score": 2, "creation_date": 1576105354, "post_id": 59294813, "comment_id": 104795155, "body": "@user282909 as an aside the idea is interesting but will not survive serious static analysis.  I assume the &quot;key&quot; lives in the binary so it will annoy the RE but not stop them.  Even if you found an impenetrable keystore the function does exist in the clear when being executed so it can be lifted.  But cool question all the same."}, {"owner": {"reputation": 105, "user_id": 8257360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c96a1bb9e939d87d047710ed944ec22a?s=128&d=identicon&r=PG&f=1", "display_name": "user282909", "link": "https://stackoverflow.com/users/8257360/user282909"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1576107147, "post_id": 59294813, "comment_id": 104795649, "body": "@Jester updated the question. That&#39;s essentially what I did, but does the plt address change when merging this binary into another?"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1576110304, "post_id": 59294813, "comment_id": 104796394, "body": "You should not try to call libc functions. If you want to print something, go for direct system calls. The fault at <code>push rbp</code> is due to the memory not being executable, which I told you about. In the meantime @mevets posted an answer about how you can fix that."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 8257360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c96a1bb9e939d87d047710ed944ec22a?s=128&d=identicon&r=PG&f=1", "display_name": "user282909", "link": "https://stackoverflow.com/users/8257360/user282909"}, "edited": false, "score": 0, "creation_date": 1576105124, "post_id": 59295238, "comment_id": 104795092, "body": "Ok I kinda didn&#39;t explain that part enough I guess. prog1.c has the func() and then I compile it position independently diassemble it and extract the binary for the instructions in func. After that; I take that binary and throw it in a new program (prog2.c) called like how it is in main."}], "tags": [], "owner": {"reputation": 1692, "user_id": 12433504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/667a21f48cc9b08d6adf0005669d9955?s=128&d=identicon&r=PG", "display_name": "VillageTech", "link": "https://stackoverflow.com/users/12433504/villagetech"}, "is_accepted": false, "score": 0, "last_activity_date": 1576104141, "creation_date": 1576104141, "answer_id": 59295238, "question_id": 59294813, "link": "https://stackoverflow.com/questions/59294813/how-do-i-run-a-function-from-its-hex-version-in-c/59295238#59295238", "title": "How do I run a function from its hex version in C?", "body": "<p>Answer for 1. : It is near impossible to do it automatically, because there is no simple way for determining the length of function code - it depends to machine CPU, compiler optimizations etc. Only way is \"manual\" analysis of disassembled binary.</p>\n"}, {"tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": false, "score": 0, "last_activity_date": 1576107446, "creation_date": 1576107446, "answer_id": 59295705, "question_id": 59294813, "link": "https://stackoverflow.com/questions/59294813/how-do-i-run-a-function-from-its-hex-version-in-c/59295705#59295705", "title": "How do I run a function from its hex version in C?", "body": "<p>If you want to execute a binary blob; then you need to do something like this:</p>\n\n<pre><code>void *p = mmap(0, blob_size, PROT_WRITE, MAP_ANON, NOFD, 0);\nread(blob_file, p, blob_size);\nmprotect(p, blob_size, PROT_EXEC);\nvoid (*UndefinedBehaviour)(char *x) = p;\nUndefinedBehaviour(\"HI\");\n</code></pre>\n\n<p>The allocates some memory, copies a blob into it, changes the memory to be PROT_EXEC, then invokes the blob at its beginning.   You need to add some error checking, and depending upon what sort of system you are on, it may be running malware monitors to prevent you from doing this.</p>\n"}, {"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 0, "last_activity_date": 1576121245, "creation_date": 1576121245, "answer_id": 59297305, "question_id": 59294813, "link": "https://stackoverflow.com/questions/59294813/how-do-i-run-a-function-from-its-hex-version-in-c/59297305#59297305", "title": "How do I run a function from its hex version in C?", "body": "<p><strong>You can't for those instructions because they're not fully position-independent and self-contained.</strong></p>\n\n<p><code>e8 df fe ff ff</code> is a <code>call rel32</code> (with a little-endian relative displacement as the call target).  It only works if that displacement reaches the <code>puts@plt</code> stub, and that only happens in the executable you're disassembling, where this code appears at a fixed distance from the PLT.  (So the executable itself is position-independent when relocated <em>as a whole</em>, but taking the machine code for one function and trying to run it from some other address will break.)</p>\n\n<hr>\n\n<p>In theory you could fixup the <code>call</code> target using a function pointer to <code>puts</code> in some code that included this machine code in an array, but if you're trying to make shellcode you can't depend on the \"target\" process helping you that way.</p>\n\n<p>Instead you should use system calls directly via the <code>syscall</code> instruction, for example Linux <code>syscall</code> with RAX=1=__NR_write is <code>write</code>.  (Not via their libc wrapper functions like <code>write()</code>, that would have exactly the same problem as <code>puts</code>).</p>\n\n<hr>\n\n<p><strong>Then you can refer to <a href=\"https://stackoverflow.com/questions/9960721/how-to-get-c-code-to-execute-hex-bytecode/55893781#55893781\">How to get c code to execute hex bytecode?</a></strong> for how to put machine code in a C array, <strong>make sure that's in an executable page</strong> (e.g. <code>gcc -z execstack</code> or mprotect or mmap), and cast that to a function pointer + call it like you're doing here.</p>\n\n<blockquote>\n  <p>ends with SIGSEGV at push %rbp</p>\n</blockquote>\n\n<p>Yup, code-fetch from a page without EXEC permission will do that.  <code>gcc -z execstack</code> is an easy way to fix <em>that</em>, or mmap like other answers suggest, at which point execution will get as far as the <code>call -289</code> and fault or run bad instructions.</p>\n"}], "owner": {"reputation": 105, "user_id": 8257360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c96a1bb9e939d87d047710ed944ec22a?s=128&d=identicon&r=PG&f=1", "display_name": "user282909", "link": "https://stackoverflow.com/users/8257360/user282909"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1576121245, "creation_date": 1576101955, "last_edit_date": 1576118683, "question_id": 59294813, "link": "https://stackoverflow.com/questions/59294813/how-do-i-run-a-function-from-its-hex-version-in-c", "title": "How do I run a function from its hex version in C?", "body": "<p>Say I want to convert a certain function into hex</p>\n\n<pre><code>void func(char* string) {\n    puts(string);\n}\n</code></pre>\n\n<pre><code>    1139:   55                      push   %rbp\n    113a:   48 89 e5                mov    %rsp,%rbp\n    113d:   48 83 ec 10             sub    $0x10,%rsp\n    1141:   48 89 7d f8             mov    %rdi,-0x8(%rbp)\n    1145:   48 8b 45 f8             mov    -0x8(%rbp),%rax\n    1149:   48 89 c7                mov    %rax,%rdi\n    114c:   e8 df fe ff ff          callq  1030 &lt;puts@plt&gt;\n    1151:   90                      nop\n    1152:   c9                      leaveq \n    1153:   c3                      retq   \n</code></pre>\n\n<p>This is what I got on x86_64: <code>\\x55\\x48\\x89\\xe5\\x48\\x83\\xec\\x10\\x48\\x89\\x7d\\xf8\\x48\\x8b\\x45\\xf8\\x48\\x89\\xc7\\xe8\\xdf\\xfe\\xff\\xff\\x90\\xc9\\xc3</code></p>\n\n<p>encrypt it and use it in this program. A decryptor at the start to decrypt these instructions at run time so it can't be analyzed statically. </p>\n\n<p>Converting the above function into hex and creating a function pointer for it doesn't run and ends with <code>SIGSEGV</code> at <code>push %rbp</code>. </p>\n\n<p>My aim is to make this code print Hi.</p>\n\n<pre><code>int main() {\n    char* decrypted = decrypt(hexcode);\n    void (*func)(char*) = (void)(*)(char)) decrypted;\n    func(\"HI\");\n}\n</code></pre>\n\n<p>My questions are: </p>\n\n<ol>\n<li>How do I convert a function into hex properly.</li>\n<li>How do I then run this hex code from main as shown above?</li>\n</ol>\n"}, {"tags": ["c", "undefined-behavior", "bit-shift"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1576101543, "post_id": 59294683, "comment_id": 104793957, "body": "The behavior is undefined. <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.7p3\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.5.7p3</a> <i>If the value of the right operand is negative or is greater than or equal to the width of the promoted left operand, the behavior is undefined.</i>"}, {"owner": {"reputation": 1692, "user_id": 12433504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/667a21f48cc9b08d6adf0005669d9955?s=128&d=identicon&r=PG", "display_name": "VillageTech", "link": "https://stackoverflow.com/users/12433504/villagetech"}, "edited": false, "score": 0, "creation_date": 1576101550, "post_id": 59294683, "comment_id": 104793960, "body": "What is type of <code>addr</code>?"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1576101674, "post_id": 59294683, "comment_id": 104793999, "body": "This kind of question would greatly benefit from a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 2, "creation_date": 1576101713, "post_id": 59294683, "comment_id": 104794012, "body": "@hyde Why? It is pretty clear without it. Should be a duplicate though"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576101797, "post_id": 59294683, "comment_id": 104794042, "body": "@EugeneSh. and you&#39;re right!"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576101839, "post_id": 59294683, "comment_id": 104794056, "body": "@EugeneSh. See the edit to see what I think was missing in the first version of the Q. Asker avoids such omissions most easily by providing a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1576102484, "post_id": 59294683, "comment_id": 104794275, "body": "In case you wonder why it is undefined behaviour, consider the hardware.  For example on x86 (and probably lots of others) <code>The destination operand can be a register or a memory location. The count operand can be an immediate value or register CL. The count is masked to 5 bits, which limits the count range to 0 to 31.</code>  So you cannot shift by 32 bits because it is the same as shifting by 0 bits once the hardware masks the count value."}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1576101658, "creation_date": 1576101658, "answer_id": 59294764, "question_id": 59294683, "link": "https://stackoverflow.com/questions/59294683/unexpected-bitshift-behavior-in-c/59294764#59294764", "title": "Unexpected bitshift behavior in C", "body": "<p>From the C standard (6.5.7 Bitwise shift operators)</p>\n\n<blockquote>\n  <p>3 The integer promotions are performed on each of the operands. The\n  type of the result is that of the promoted left operand. If the value\n  of the right operand is negative or <strong>is greater than or equal to the\n  width of the promoted left operand, the behavior is unde\ufb01ned</strong></p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1576106175, "post_id": 59294765, "comment_id": 104795397, "body": "@Clifford If <code>x</code> is 1 then we have <code>mask &gt;&gt; 31</code> == <code>0xffffffff &gt;&gt; 31</code> == 1"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1576109236, "post_id": 59294765, "comment_id": 104796169, "body": "I need more sleep (comment deleted)!  An alternative is <code>addr &amp; ((mask &gt;&gt; (31 - x)) &gt;&gt; 1)</code> then the check for x==0 is unnecessary (I think - still need sleep!)"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1576101666, "creation_date": 1576101666, "answer_id": 59294765, "question_id": 59294683, "link": "https://stackoverflow.com/questions/59294683/unexpected-bitshift-behavior-in-c/59294765#59294765", "title": "Unexpected bitshift behavior in C", "body": "<p>You're performing an illegal bitshift.  </p>\n\n<p>Shifting by a value greater or equal than the size in bits of the left operand results in <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.  This is documented in section 6.5.7p3 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a>:</p>\n\n<blockquote>\n  <p>The integer promotions are performed on each of the operands. The type\n  of the result is that of the promoted left operand. If the value of\n  the right operand is negative <strong>or is greater than or equal to the width\n  of the promoted left operand</strong>, the behavior is undefined.</p>\n</blockquote>\n\n<p>This means you need to check the value of x, and if it is 0 then just use 0 for the bitmask.</p>\n\n<pre><code>int x = 0;\nuint32_t mask = 0xFFFFFFFF;\n...\nif (x == 0) {\n    result = 0;\n} else {\n    result = addr &amp; (mask &gt;&gt; (32 - x));\n}\n</code></pre>\n"}], "owner": {"reputation": 467, "user_id": 9848908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5eaa6bef8ce5e1c90d6a9b6c184e2b11?s=128&d=identicon&r=PG&f=1", "display_name": "DanielJomaa", "link": "https://stackoverflow.com/users/9848908/danieljomaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "closed_date": 1576101765, "answer_count": 2, "score": 3, "last_activity_date": 1576108439, "creation_date": 1576101243, "last_edit_date": 1576108439, "question_id": 59294683, "link": "https://stackoverflow.com/questions/59294683/unexpected-bitshift-behavior-in-c", "closed_reason": "Duplicate", "title": "Unexpected bitshift behavior in C", "body": "<p>I am currently trying to extract some bits from an address called <code>addr</code> with a 32 bit mask called <code>mask</code> into another variable called <code>result</code> as follows</p>\n\n<pre><code>int addr = 7;\nint x = 0;\nuint32_t mask = 0xFFFFFFFF;\nresult = addr &amp; (mask &gt;&gt; (32 - x));\n</code></pre>\n\n<p>I am expecting result to be 0 when x = 0, and this is confirmed on online bitshift calculators. however in C code, <code>result</code> is 1. Why is that?</p>\n"}, {"tags": ["c", "gcc", "binutils", "rom"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576100123, "post_id": 59294407, "comment_id": 104793453, "body": "Are you asking how to get the function address or what?"}, {"owner": {"reputation": 742, "user_id": 6271889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d2f217c1e060d40fca9e619528ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo", "link": "https://stackoverflow.com/users/6271889/leonardo"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576100197, "post_id": 59294407, "comment_id": 104793477, "body": "I can see the function address from the map file. I want to create a stub library I can link against my application and I&#39;m asking if objcopy can help me with that."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576100261, "post_id": 59294407, "comment_id": 104793504, "body": "It might be possible to do as a part of the &quot;ROM code&quot; build. Is that an option?"}, {"owner": {"reputation": 742, "user_id": 6271889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d2f217c1e060d40fca9e619528ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo", "link": "https://stackoverflow.com/users/6271889/leonardo"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576100322, "post_id": 59294407, "comment_id": 104793533, "body": "I&#39;m sorry, what do you mean by &quot;&#39;ROM code&#39; build&quot;?"}, {"owner": {"reputation": 1320, "user_id": 5495906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b319c1b73d80f4155fbdd4fcb81525?s=128&d=identicon&r=PG&f=1", "display_name": "LegendofPedro", "link": "https://stackoverflow.com/users/5495906/legendofpedro"}, "edited": false, "score": 0, "creation_date": 1576100374, "post_id": 59294407, "comment_id": 104793557, "body": "Can you recompile your ROM code (i.e. as a library)?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576100401, "post_id": 59294407, "comment_id": 104793569, "body": "You have some functions in ROM, right? Means that you have some code compiling into the binary sitting in the ROM.  Do you own it? Can you change its build process?"}, {"owner": {"reputation": 742, "user_id": 6271889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d2f217c1e060d40fca9e619528ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo", "link": "https://stackoverflow.com/users/6271889/leonardo"}, "reply_to_user": {"reputation": 1320, "user_id": 5495906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b319c1b73d80f4155fbdd4fcb81525?s=128&d=identicon&r=PG&f=1", "display_name": "LegendofPedro", "link": "https://stackoverflow.com/users/5495906/legendofpedro"}, "edited": false, "score": 0, "creation_date": 1576100815, "post_id": 59294407, "comment_id": 104793727, "body": "@LegendofPedro, If I turn the ROM into a library, my final application image will have the implementation of the ROM functions. I&#39;m trying to avoid that to save application space."}, {"owner": {"reputation": 742, "user_id": 6271889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d2f217c1e060d40fca9e619528ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo", "link": "https://stackoverflow.com/users/6271889/leonardo"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576100864, "post_id": 59294407, "comment_id": 104793745, "body": "@EugeneSh. I can recompile the ROM, but I can&#39;t change it as it is already implemented in silicon."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576101123, "post_id": 59294407, "comment_id": 104793819, "body": "Then I don&#39;t think you can do any better than some script to parse either the linker map file or objdump or some other tool output."}, {"owner": {"reputation": 742, "user_id": 6271889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d2f217c1e060d40fca9e619528ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo", "link": "https://stackoverflow.com/users/6271889/leonardo"}, "edited": false, "score": 0, "creation_date": 1576101267, "post_id": 59294407, "comment_id": 104793867, "body": "@EugeneSh.OK, thanks!"}, {"owner": {"reputation": 1669, "user_id": 12396017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nk8xz.png?s=128&g=1", "display_name": "Maxim Sagaydachny", "link": "https://stackoverflow.com/users/12396017/maxim-sagaydachny"}, "edited": false, "score": 0, "creation_date": 1576101834, "post_id": 59294407, "comment_id": 104794053, "body": "use sed to convert function declarations from headers into typedefs, i.e.:  typedef int (*some_rom_function_t)(void). and another sed to convert &quot;0x00001234  some_function&quot; into static variables - pointers to functions: &quot;some_function_t some_function =0x00001234;&quot; the rest is usual stuff - just call function as usual."}, {"owner": {"reputation": 742, "user_id": 6271889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d2f217c1e060d40fca9e619528ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo", "link": "https://stackoverflow.com/users/6271889/leonardo"}, "reply_to_user": {"reputation": 1669, "user_id": 12396017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nk8xz.png?s=128&g=1", "display_name": "Maxim Sagaydachny", "link": "https://stackoverflow.com/users/12396017/maxim-sagaydachny"}, "edited": false, "score": 0, "creation_date": 1576102173, "post_id": 59294407, "comment_id": 104794170, "body": "@MaximSagaydachny OK, but that is essentially what I&#39;m doing. Can I use objcopy to create a library from the ROM (ELF) image?"}, {"owner": {"reputation": 1320, "user_id": 5495906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b319c1b73d80f4155fbdd4fcb81525?s=128&d=identicon&r=PG&f=1", "display_name": "LegendofPedro", "link": "https://stackoverflow.com/users/5495906/legendofpedro"}, "edited": false, "score": 1, "creation_date": 1576108231, "post_id": 59294407, "comment_id": 104795943, "body": "Could you <a href=\"https://sourceware.org/binutils/docs/ld/REGION_005fALIAS.html#REGION_005fALIAS\" rel=\"nofollow noreferrer\">use a linker script</a> to put your library into a dummy section (hex file) but with the <code>ORIGIN</code> of your ROM addresses?"}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "reply_to_user": {"reputation": 1320, "user_id": 5495906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b319c1b73d80f4155fbdd4fcb81525?s=128&d=identicon&r=PG&f=1", "display_name": "LegendofPedro", "link": "https://stackoverflow.com/users/5495906/legendofpedro"}, "edited": false, "score": 0, "creation_date": 1576134570, "post_id": 59294407, "comment_id": 104802061, "body": "I&#39;d try a way @LegendofPedro kind of points to: Since your ROM is &quot;written in stone&quot; you could write a linker script that includes definitions of all function entry points by their name and with their fixed addresses. Additionally you write a header file that declares these functions, as usual, but you don&#39;t need an implementation file. Unfortunately I don&#39;t have more time right now to prepare an answer. :-( Would you mind to provide the (minimalized) linker script that you use now for your application(s)? And perhaps some <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}], "owner": {"reputation": 742, "user_id": 6271889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d2f217c1e060d40fca9e619528ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo", "link": "https://stackoverflow.com/users/6271889/leonardo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1576103034, "creation_date": 1576099921, "last_edit_date": 1576103034, "question_id": 59294407, "link": "https://stackoverflow.com/questions/59294407/create-stub-library-object-from-application-code-rom-using-binutils-for-bare-m", "title": "Create stub library/object from application code (ROM) using binutils for bare-metal ARM", "body": "<p>I have some C code that is implemented in a ROM. I'd like to link an application against that code, so I can save some space (as my application won't have to include the ROM code as it's already in the ROM). My question is about how to do this in an efficient way. I'm using the GCC toolchain for ARM (arm-none-eabi-*)</p>\n\n<p>The long explanation:</p>\n\n<p>I'll quote <a href=\"https://docs.oracle.com/cd/E23824_01/html/819-0690/chapter2-22.html\" rel=\"nofollow noreferrer\">Oracle's definition</a> of a stub object:</p>\n\n<blockquote>\n  <p>A stub object is a shared object, built entirely from mapfiles, that supplies the same linking interface as the real object, while containing no code or data.</p>\n</blockquote>\n\n<p>As a normal part of the linking process, we can link against libraries, either static or dynamic. As I'm using an embedded target with no MMU, I'm using static libraries. When linking against static libraries, the library code is copied to my final application image. In my problem here, I have code that is implemented in a ROM. I have the final binary and the map file of this ROM. What I want is to call this ROM code from my application, so I don't have to include it again. </p>\n\n<p>So, let's say that I have the following code <strong>in ROM</strong></p>\n\n<pre><code>int some_rom_function(void)\n{\n    // do something here, doesn't really matter what\n}\n</code></pre>\n\n<p>I go to the map file and see that <code>some_rom_function</code> lives at <code>0x1234</code>:</p>\n\n<pre><code> .text.some_rom_function\n                0x00001234       0x94 ./source/mysource.o\n                0x00001234                some_rom_function\n</code></pre>\n\n<p>My current solution is to use a header with inline functions, like so:</p>\n\n<pre><code>#define SOME_ROM_FUNCTION_ADDR    0x00001234\n\nstatic inline int some_rom_function(void)\n{\n    return (*((int (**)())SOME_ROM_FUNCTION_ADDR))();\n}\n</code></pre>\n\n<p>So that in my application code I can just do</p>\n\n<pre><code>int main( void )\n{\n    some_rom_function();\n}\n</code></pre>\n\n<p>My question is: <strong>is there a better way to do this</strong>, especially for a large application?  Do I really have to manually go through every single function?</p>\n\n<p><strong>Can the binutils applications (ld, objcopy, etc, etc) be used to achieve the same result</strong>, assuming that I have the final binary (non-relocatable code)?</p>\n\n<p>Caveats:\n1. I do own the original ROM code. So I have access to the source, the final binary, and the map file.</p>\n\n<ol start=\"2\">\n<li>The ROM has already been implemented. This means that it literally is written in stone (silicon in my case), so I can't change anything about the ROM itself.</li>\n</ol>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "pointers", "memory-management"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1576098822, "post_id": 59294123, "comment_id": 104792902, "body": "You should use integer offsets for everything within the memory chunk, not try to convert the pointers to integers."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1576098840, "post_id": 59294123, "comment_id": 104792911, "body": "&quot;need a way to convert memory address into long int&quot;. You only need frame numbers if equal sized frames or offsets if not. In fact, for equal sized frames you can even save alot of space with a bit map for the free list."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1576098876, "post_id": 59294123, "comment_id": 104792924, "body": "That&#39;s right, just treat it as an array of frames."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1576099056, "post_id": 59294123, "comment_id": 104792999, "body": "Another common alternative is to put a small fixed sized header in front of each managed block and use that to chain up blocks."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1576099067, "post_id": 59294123, "comment_id": 104793003, "body": "All that said, this isn&#39;t really an appropriate question for SO. We&#39;re not a design discussion forum, you need to ask questions about specific code that you&#39;ve written. So take the above advice and try to code something. If you can&#39;t get it to work, post what you wrote and we&#39;ll help you fix it."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1576099257, "post_id": 59294123, "comment_id": 104793085, "body": "<a href=\"https://github.com/zyfjeff/C-HOW-TO/blob/master/c-malloc/Malloc_tutorial.pdf\" rel=\"nofollow noreferrer\">awkwardly written, but good basic malloc/realloc introduction</a> Note, current implementations actually use <code>mmap</code> instead of <code>brk&#47;sbrk</code> for managing the memory, but for a basic understanding how to approach the problems this isn&#39;t bad. If you are careful, you can extend to support 64-bit as well."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1576099602, "post_id": 59294123, "comment_id": 104793240, "body": "@Barmar: Stack Overflow is <b>not</b> a site \u201cto ask questions about specific code that you&#39;ve written.\u201d That is a <b>subset</b> of what questions can be asked. The <a href=\"https://stackoverflow.com/help/on-topic\">Help Center</a> says that, generally, questions about specific programming problems, software algorithms, software tools commonly used by programmers, and practical, answerable problems unique to software development are appropriate. Certainly questions about algorithm design are within those general areas, although it is better if they are somewhat more specific than this one."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1576099747, "post_id": 59294123, "comment_id": 104793290, "body": "@EricPostpischil My description may be a bit terse, but the point is that he needs to show something more specific that we can help correct, rather than asking for a general design."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1576100048, "post_id": 59294123, "comment_id": 104793414, "body": "Related: <a href=\"https://stackoverflow.com/questions/59291857/user-implemented-memory-management\" title=\"user implemented memory management\">stackoverflow.com/questions/59291857/&hellip;</a>"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1576100586, "post_id": 59294123, "comment_id": 104793654, "body": "@Barmar: The question does not ask for a general design. It asks \u201cTo do that, I need a way to convert memory address into long int so I can save them into the array and my search so far yielded nothing. Is there any way to accomplish that?\u201d In this case, you can determine the question being asked by looking for the sentence with the question mark.The preceding part of the question sets context; it does not ask the question. (And, in fact, that preceding part of the question sketches a potential design; it does not request one.)"}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 1, "last_activity_date": 1576100390, "last_edit_date": 1592644375, "creation_date": 1576100390, "answer_id": 59294516, "question_id": 59294123, "link": "https://stackoverflow.com/questions/59294123/memory-management-with-pointers/59294516#59294516", "title": "Memory Management with pointers", "body": "<blockquote>\n<p>To do that, I need a way to convert memory address into long int so I can save them into the array and my search so far yielded nothing.</p>\n<p>Is there any way to accomplish that?</p>\n</blockquote>\n<p>Generally, you do not need to convert memory addresses to an integer type merely to keep track of them. Options include:</p>\n<ul>\n<li>Work with pointers within the memory chunk you are given, using <code>char *</code> to perform arithmetic.</li>\n<li>Subtract the base address of the memory (again with <code>char *</code>) from pointers within it to get offsets of type <code>ptrdiff_t</code> (defined in <code>&lt;stddef.h&gt;</code>) and use those.</li>\n<li>Convert the addresses to the integer type <code>uintptr_t</code> (defined in <code>&lt;stdint.h&gt;</code>). Unlike the other options, this has implementation-dependent behavior. In common C implementations, the result of conversion will be a simple memory address that you can perform arithmetic on as expected. But, in some C implementations, the result will be more complicated, so the code will not be fully portable.</li>\n</ul>\n"}], "owner": {"reputation": 21, "user_id": 9718251, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Berk Erzin", "link": "https://stackoverflow.com/users/9718251/berk-erzin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576101174, "creation_date": 1576098603, "question_id": 59294123, "link": "https://stackoverflow.com/questions/59294123/memory-management-with-pointers", "title": "Memory Management with pointers", "body": "<p>I am developing a C library which has three functions. Init function takes a (void*) pointer to a memory chunk. I need to develop functions to allocate and deallocate memory blocks from that said chunk. What this means is that I have to keep track of which parts of the memory chunk I have allocated and which parts are free. Problem is, the structure I will implement to track the memory also has to be part of said memory chunk. I am not allowed to allocate new memory for my management structure.</p>\n\n<p>And I have no idea how to do that.</p>\n\n<p>Currently, I am planning to designate first few hundred bytes as header space and divide the rest into frames of equal size. I will use header space to create an array which will keep track of which frames are allocated. To do that, I need a way to convert memory address into long int so I can save them into the array and my search so far yielded nothing.</p>\n\n<p>Is there any way to accomplish that? \nFailing that is there any other way to implement a management structure in this situation.</p>\n"}, {"tags": ["c", "function", "bit"], "comments": [{"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 1, "creation_date": 1576098329, "post_id": 59294026, "comment_id": 104792715, "body": "This can already not work if you are trying to return a <code>int</code>. A representation of a number is a sequence of characters (digits), so what you want is to construct and return a string. Please also be aware that C++ is a different language than C. Don&#39;t tag unrelated languages."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1576098526, "post_id": 59294026, "comment_id": 104792798, "body": "An unsigned char can only hold numbers up to 255.  You need to use int for your binary representation.  <code>reverse</code> will not work on the binary number, only the unsigned char."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1576098671, "post_id": 59294026, "comment_id": 104792853, "body": "Re &quot;<i>An unsigned char can only hold numbers up to 255</i>&quot;, ...on conventional modern systems."}], "answers": [{"tags": [], "owner": {"reputation": 2040, "user_id": 7449706, "user_type": "registered", "profile_image": "https://graph.facebook.com/1302265936460934/picture?type=large", "display_name": "Kevin Ng", "link": "https://stackoverflow.com/users/7449706/kevin-ng"}, "is_accepted": false, "score": 0, "last_activity_date": 1576111932, "last_edit_date": 1576111932, "creation_date": 1576109914, "answer_id": 59295998, "question_id": 59294026, "link": "https://stackoverflow.com/questions/59294026/binary-representation-starting-with-a-least-significant-bit-in-c/59295998#59295998", "title": "Binary representation starting with a least significant bit in C", "body": "<p>When reversing the bits, all you have to do is check the LSB. Add that value to an output variable. Then shift the output variable by one to the left and shift the original number by one to the right. In the mathematical example below, I do a first 0 shift so it become easier on the eye with the formatting.</p>\n\n<p>In your example of 10010:</p>\n\n<pre><code>Round 1: output = (00000 &lt;&lt; 1) + (10010 &amp; 1) = 00000\n         N      = 10010 &gt;&gt; 1                 = 01001\n\nRound 2: output = (00000 &lt;&lt; 1) + (01001 &amp; 1) = 00001\n         N      = 01001 &gt;&gt; 1                 = 00100\n\nRound 3: output = (00001 &lt;&lt; 1) + (00100 &amp; 1) = 00010\n         N      = 00100 &gt;&gt; 1                 = 00010\n\nRound 4: output = (00010 &lt;&lt; 1) + (0010 &amp; 1)  = 00100\n         N      = 00010 &gt;&gt; 1                 = 00001\n\nRound 5: output = (00100 &lt;&lt; 1) + (00001 &amp; 1) = 01001\n         N      = 00001 &gt;&gt; 1                 = 00000\n</code></pre>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint binary(int n)\n{\n    int output = 0;\n\n    if ( n == 0 ) return 0;\n\n    // Save one left shift    \n    output += n &amp; 1; \n    n = n &gt;&gt; 1;\n\n    while( n != 0 ){\n        output = output &lt;&lt; 1;\n        output += n &amp; 1; \n        n = n &gt;&gt; 1;\n        printf(\"%d\\n\", output);\n    }\n\n    return output;\n}\n\nvoid printBin(int n){\n    char bin[33] = {0};\n\n    for (int i = 31; i &gt; -1; i-- ){\n        bin[i] = (char)((n &amp; 1) ^ 48);\n        n = n &gt;&gt; 1;\n    }\n    puts(bin);\n}\n\n\nint main()\n{\n    int n; int rb;\n    printf(\"Enter a decimal number: \");\n    scanf(\"%d\", &amp;n);\n\n    rb = binary(n);\n\n    printf(\"The binary equivalent of %d is %d\\n\", n, rb);\n\n    printf(\"%11d:\", n);\n    printBin(n);\n\n    printf(\"%11d:\", rb);\n    printBin(rb);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 10630449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a950cb8fc10e6983c43a37ef0bc83a7a?s=128&d=identicon&r=PG&f=1", "display_name": "Lowly0palace", "link": "https://stackoverflow.com/users/10630449/lowly0palace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1576111932, "creation_date": 1576098158, "last_edit_date": 1576110234, "question_id": 59294026, "link": "https://stackoverflow.com/questions/59294026/binary-representation-starting-with-a-least-significant-bit-in-c", "title": "Binary representation starting with a least significant bit in C", "body": "<p>I'm trying to make a binary representation of an integer using <code>binary()</code> function and then use <code>reverse()</code> function to get bit reversal as can be seen below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nunsigned char reverse(unsigned char b) {\n    b = (b &amp; 0xF0) &gt;&gt; 4 | (b &amp; 0x0F) &lt;&lt; 4;\n    b = (b &amp; 0xCC) &gt;&gt; 2 | (b &amp; 0x33) &lt;&lt; 2;\n    b = (b &amp; 0xAA) &gt;&gt; 1 | (b &amp; 0x55) &lt;&lt; 1;\n    return b;\n}\n\nint binary(int n)\n{\n    int b;\n\n    if (n == 0)\n    {\n        return 0;\n    }\n    else\n    {\n        b = (n % 2) + 10 * binary(n / 2);\n        unsigned char i = (unsigned char)b;\n        return reverse(i);\n\n    }\n\n}\n\nint main()\n{\n  int n;\n  printf(\"Enter a decimal number: \");\n  scanf(\"%d\", &amp;n);\n  printf(\"The binary equivalent of %d is %d\\n\", n, binary(n));\n  return 0;\n}\n</code></pre>\n\n<p>The issue I'm having is that I expect <code>binary()</code> to produce a binary number (for example, a binary representation fo <code>18</code> would be <code>10010</code>), and then <code>reverse()</code> function to take this number and produce a reversed binary representation starting with the least significant bit (LSB) which should be <code>01001</code> in this case. However, when I try to run it, I get returned 0. </p>\n\n<p>I'm new to C and I'm thinking maybe the issue is in the <code>unsigned char</code> datatype, but when, why if I convert <code>b</code> into <code>unsigned char</code> it still doesn't work? </p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1576097262, "post_id": 59293803, "comment_id": 104792274, "body": "<code>Are arrays a specific case?</code> Yes, together with functions. Arrays &quot;decay&quot; (look that up) to a pointer to their first element."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 1, "creation_date": 1576097380, "post_id": 59293803, "comment_id": 104792330, "body": "Is not a cast, is an assignment. In your first example <code>ages</code> (an array) decays into a pointer to the first element (like if <code>&amp;a[0]</code> was written) when assigned to <code>agesPointer</code>. In the second example you need to use the address-of operator because <code>age</code> is not an array."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1576097388, "post_id": 59293803, "comment_id": 104792335, "body": "Similarly with arguments for <code>scanf</code> for example <code>res = scanf(&quot;%d%s&quot;, &amp;myInt, myStr);</code>"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1576099110, "post_id": 59293803, "comment_id": 104793022, "body": "By the C standard, if &quot;ages&quot; is an array of int, then just &quot;ages&quot; in a pointer context means &quot;pointer to the first int at the address of the array&quot;, while &quot;&amp;ages&quot; means &quot;pointer to the whole array of ints at the address of the array&quot;. Both are the same physical address; the type is only important when you try to do pointer arithmetic."}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1576097648, "post_id": 59293848, "comment_id": 104792439, "body": "Why are you putting \u201cdecay\u201d in bold? It is jargon, not a term being defined. That also means it is sloppy and imprecise. When you are teaching people, it is better to use correct terminology. Per C 2018 6.3.2.1 3, an expression with array type is <i>converted</i> to a pointer to its initial element, except when it is the operand of <code>sizeof</code> or unary <code>&amp;</code> or is a string literal used to initialize an array."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1576097780, "post_id": 59293848, "comment_id": 104792506, "body": "@EricPostpischil Fair enough.  Switched to italics so as not to infer a formal definition."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1576106622, "post_id": 59293848, "comment_id": 104795519, "body": "@EricPostpischil: The Standard is rather sloppy with its terminology, vastly overloading terms like &quot;conversion&quot; and &quot;object&quot; to refer to multiple concepts.  I&#39;m not sure when and by whom the term &quot;decay&quot; was first applied to the implicit conversion of an array-type lvalue into a first-element pointer, but it&#39;s been around for a long time and--unlike the term &quot;conversion&quot;--refers to one particular identifiable concept."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1576108059, "post_id": 59293848, "comment_id": 104795898, "body": "@supercat: The terms are fine here, and, regardless of your feelings about them, the standard is authoritative."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1576109057, "post_id": 59293848, "comment_id": 104796130, "body": "@EricPostpischil: The authority of the Standard is limited to classifying certain things as conforming C implementations, certain things as Strictly Conforming C Programs, certain things as Conforming (but not Strictly Conforming) C Programs, and everything else as none of the above."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1576109368, "post_id": 59293848, "comment_id": 104796197, "body": "@supercat: The classifications and specifications of the C standard are the standard for questions with the C tag, per the description of the tag. Hence it is authoritative for answers here unless specifically stated otherwise or requested otherwise in the question."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1576180768, "post_id": 59293848, "comment_id": 104825707, "body": "@EricPostpischil: While it would make sense to avoid using terms that are defined by the Standard, in ways contrary to such definitions, that doesn&#39;t mean that the Standard&#39;s failure to recognize a term that is commonly used for something should be interpreted as a prohibition on the use of that term.  If the function of a definition for X is to partition the universe into things that are unambiguously X, things that are unambiguously not X, and things that cannot be unambiguously classified as being X nor as being not X, and if a <i>good</i> definition is one that minimizes the latter set, ..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1576180839, "post_id": 59293848, "comment_id": 104825734, "body": "...then by that measure the C Standard is severely lacking in good definitions for things.  Do you think I&#39;m being at all unreasonable in what I expect from good definitions?"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1576097714, "last_edit_date": 1576097714, "creation_date": 1576097351, "answer_id": 59293848, "question_id": 59293803, "link": "https://stackoverflow.com/questions/59293803/why-do-arrays-not-need-to-be-cast-to-pointers/59293848#59293848", "title": "Why do arrays not need to be cast to pointers", "body": "<p>An array, when used in an expression, will in most cases <em>decay</em> to a pointer to the first element of the array.  So this:</p>\n\n<pre><code>int *agesPointer = ages;\n</code></pre>\n\n<p>Is the same as:</p>\n\n<pre><code>int *agesPointer = &amp;ages[0];\n</code></pre>\n\n<p>This only works however with arrays.  For variables of other types you need to explicitly take its address.</p>\n\n<p>The reason you can't assign <code>&amp;ages</code> to <code>agesPointer</code> is because the types are different.  This is one of those cases where the array does <em>not</em> decay.  The expression <code>&amp;ages</code> has type <code>int (*)[3]</code>, i.e. a pointer to an array of <code>int</code> of size 3.</p>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 1, "last_activity_date": 1576097768, "creation_date": 1576097768, "answer_id": 59293940, "question_id": 59293803, "link": "https://stackoverflow.com/questions/59293803/why-do-arrays-not-need-to-be-cast-to-pointers/59293940#59293940", "title": "Why do arrays not need to be cast to pointers", "body": "<p>The 2018 C standard says in clause 6.3.2.1, paragraph 3:</p>\n\n<blockquote>\n  <p>Except when it is the operand of the <code>sizeof</code> operator, or the unary <code>&amp;</code> operator, or is a string literal used to initialize an array, an expression that has type \u201carray of <em>type</em>\u201d is converted to an expression with type \u201cpointer to <em>type</em>\u201d that points to the initial element of the array object\u2026</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": -1, "last_activity_date": 1576099864, "last_edit_date": 1576099864, "creation_date": 1576098281, "answer_id": 59294053, "question_id": 59293803, "link": "https://stackoverflow.com/questions/59293803/why-do-arrays-not-need-to-be-cast-to-pointers/59294053#59294053", "title": "Why do arrays not need to be cast to pointers", "body": "<p>For starters in this declaration</p>\n\n<pre><code>int *agePointer = &amp;age;\n</code></pre>\n\n<p>there is no casting. There is used the unary operator <code>&amp;</code> that yields the address of an object to which the operator is applied.</p>\n\n<p>Now here is an answer to your question from the C Standard (6.3.2.1 Lvalues, arrays, and function designators)</p>\n\n<blockquote>\n  <p>2 Except when it is the operand of the sizeof operator, the unary &amp;\n  operator, the ++ operator, the -- operator, or the left operand of the\n  . operator or an assignment operator, an lvalue that does not have\n  array type is converted to the value stored in the designated object\n  (and is no longer an lvalue); <strong>this is called lvalue conversion</strong>.</p>\n</blockquote>\n\n<p>That is if for example you are using the variable age in the right side of the assignment operator like</p>\n\n<pre><code>person_age = age;\n</code></pre>\n\n<p>then the age yields the value stored in the object named <code>age</code>. This is called lvalue conversion.</p>\n\n<p>In case of arrays </p>\n\n<blockquote>\n  <p>3 Except when it is the operand of the sizeof operator or the unary &amp;\n  operator, or is a string literal used to initialize an array, an\n  expression that has type <strong>\u2018\u2018array of type\u2019\u2019 is converted to an\n  expression with type \u2018\u2018pointer to type\u2019\u2019</strong> that points to the initial\n  element of the array object and is not an lvalue. If the array object\n  has register storage class, the behavior is unde\ufb01ned.</p>\n</blockquote>\n\n<p>So in this declaration </p>\n\n<pre><code>int *agesPointer = ages;\n</code></pre>\n\n<p><code>ages</code> is automatically implicitly converted to pointer to its first element. </p>\n\n<p>To get the value as in the case of scalar objects you should dereference the pointer as for example like</p>\n\n<pre><code>int person_age = *ages;\n</code></pre>\n\n<p>To get a pointer to the array itself you should write</p>\n\n<pre><code>int ages[] = { 1, 2, 3 };\nint ( *agesPointer )[3] = &amp;ages;\n</code></pre>\n\n<p>That is now the pointer <code>agesPointer</code> points to an object of the size <code>3 * sizeof( int )</code>.</p>\n\n<p>In this declaration</p>\n\n<pre><code>int ages[] = { 1, 2, 3 };\nint *agesPointer = ages;\n</code></pre>\n\n<p>the pointer <code>agesPointer</code> points to an object of the size <code>sizeof( int )</code> because the pointer points to the first element of the array.</p>\n\n<p>Consider the following demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) \n{\n    {\n        int ages[] = { 1, 2, 3 };\n        int *agesPointer = ages;\n\n        printf( \"sizeof( *agesPointer ) =  %zu\\n\", sizeof( *agesPointer ) );\n    }\n\n    {\n        int ages[] = { 1, 2, 3 };\n        int ( *agesPointer )[3] = &amp;ages;\n\n        printf( \"sizeof( *agesPointer ) =  %zu\\n\", sizeof( *agesPointer ) );\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>sizeof( *agesPointer ) =  4\nsizeof( *agesPointer ) =  12\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9374901, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IcqGO0kxLzI/AAAAAAAAAAI/AAAAAAAAAA4/LqG9iQ94euw/photo.jpg?sz=128", "display_name": "Peter Wave", "link": "https://stackoverflow.com/users/9374901/peter-wave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1576108408, "creation_date": 1576097124, "last_edit_date": 1576108408, "question_id": 59293803, "link": "https://stackoverflow.com/questions/59293803/why-do-arrays-not-need-to-be-cast-to-pointers", "title": "Why do arrays not need to be cast to pointers", "body": "<p>I'm trying to learn how pointers work in C and I'm facing a confusing situation.</p>\n\n<p>So basically I have two fields, and a pointer for each. </p>\n\n<pre><code>int ages[] = { 1, 2, 3 };\nint *agesPointer = ages;\n\n// Some printfs I didn't judge useful to keep\n\nint age = 1;\nint *agePointer = &amp;age;\n\n</code></pre>\n\n<p>So <code>ages</code> has 3 ints stored in it, which are 1, 2 and 3 and <code>agesPointer</code> is pointing to <code>ages</code>'s address, right?</p>\n\n<p>Same goes for <code>age</code> and <code>agePointer</code>, but why do I have to cast <code>age</code> to a pointer while I don't for <code>ages</code>? I tried adding the cast to <code>age</code>s and gets a compiling error, same goes when I remove the cast from <code>age</code>, did I miss something? Are arrays a specific case? Thanks to anyone who will help me understanding.</p>\n"}, {"tags": ["c", "gcc", "makefile"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1576097006, "post_id": 59293758, "comment_id": 104792180, "body": "So it is optimized out because not being used in your program."}, {"owner": {"reputation": 3880, "user_id": 271594, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b6d0554634ccfb064a26c6de5faf6b4?s=128&d=identicon&r=PG", "display_name": "iter", "link": "https://stackoverflow.com/users/271594/iter"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1576097176, "post_id": 59293758, "comment_id": 104792248, "body": "Yes. I want to prevent this optimization. I could add some code that would twiddle some of these bytes, but I wonder if there&#39;s a way to tell the linker directly what I&#39;m trying to do."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576097318, "post_id": 59293758, "comment_id": 104792299, "body": "Not sure if it will help... but you can try to place it into some separate section and then <code>keep</code> it."}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 1, "creation_date": 1576097536, "post_id": 59293758, "comment_id": 104792403, "body": "Your compiler has some pragma which turns off optimization for just a part of the code. Or else make the array volatile."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 1, "creation_date": 1576097674, "post_id": 59293758, "comment_id": 104792454, "body": "@Fredrik Looks like the compiler is not optimizing it, but the linker is. Not sure compiler flags/pragmas will help with that."}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576097738, "post_id": 59293758, "comment_id": 104792482, "body": "@Eugene You\u2019re right, then maybe volatile will work?"}, {"owner": {"reputation": 3880, "user_id": 271594, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b6d0554634ccfb064a26c6de5faf6b4?s=128&d=identicon&r=PG", "display_name": "iter", "link": "https://stackoverflow.com/users/271594/iter"}, "edited": false, "score": 0, "creation_date": 1576097789, "post_id": 59293758, "comment_id": 104792511, "body": "Just tried with volatile. Same result."}, {"owner": {"reputation": 2138, "user_id": 1919896, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7da069e9930c3bdcc9b7af581c0de4eb?s=128&d=identicon&r=PG", "display_name": "Icarus3", "link": "https://stackoverflow.com/users/1919896/icarus3"}, "edited": false, "score": 1, "creation_date": 1576100784, "post_id": 59293758, "comment_id": 104793716, "body": "After --gc-sections try -Wl,--gc-keep-exported This should prevent removal of global symbols. In your case that would be &#39;rev&#39;"}, {"owner": {"reputation": 1320, "user_id": 5495906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b319c1b73d80f4155fbdd4fcb81525?s=128&d=identicon&r=PG&f=1", "display_name": "LegendofPedro", "link": "https://stackoverflow.com/users/5495906/legendofpedro"}, "edited": false, "score": 0, "creation_date": 1576101141, "post_id": 59293758, "comment_id": 104793824, "body": "Perhaps initialising as <code>extern</code> would prevent the linker removing the variable, and make the string available to all compilation units."}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "reply_to_user": {"reputation": 1320, "user_id": 5495906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b319c1b73d80f4155fbdd4fcb81525?s=128&d=identicon&r=PG&f=1", "display_name": "LegendofPedro", "link": "https://stackoverflow.com/users/5495906/legendofpedro"}, "edited": false, "score": 1, "creation_date": 1576133190, "post_id": 59293758, "comment_id": 104801537, "body": "@LegendofPedro extern means it exists somewhere else, so if you make it extern there will be no variable to begin with."}], "answers": [{"tags": [], "owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "is_accepted": false, "score": 0, "last_activity_date": 1576333016, "creation_date": 1576333016, "answer_id": 59335934, "question_id": 59293758, "link": "https://stackoverflow.com/questions/59293758/embed-revision-number-in-executable-binary/59335934#59335934", "title": "Embed revision number in executable binary", "body": "<p>You could either compile file with <code>rev</code> with <code>-fno-data-sections</code> or simply add a dummy use of it somewhere:</p>\n\n<pre><code>volatile int x = 0;\nif (x)\n  memcpy(NULL, rev, 1);\n</code></pre>\n"}], "owner": {"reputation": 3880, "user_id": 271594, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b6d0554634ccfb064a26c6de5faf6b4?s=128&d=identicon&r=PG", "display_name": "iter", "link": "https://stackoverflow.com/users/271594/iter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576333016, "creation_date": 1576096903, "question_id": 59293758, "link": "https://stackoverflow.com/questions/59293758/embed-revision-number-in-executable-binary", "title": "Embed revision number in executable binary", "body": "<p>I want to embed a git revision marker in my binary, but the linker appears to strip it away.</p>\n\n<p>Makefile:</p>\n\n<pre><code>CPPFLAGS += -DREV=$(shell git describe)\n</code></pre>\n\n<p>file.c:</p>\n\n<pre><code>#define xstr(s) str(s)\n#define str(s) #s\nconst char rev[]=\"rev[\" xstr(REV) \"]\";\n</code></pre>\n\n<p>The marker is present in file.o:</p>\n\n<pre><code>$ strings file.o | grep rev\nrev[v1.0.1-5-ga45db7f-dirty]\nGCC: (15:7-2018-q2-6) 7.3.1 20180622 (release) [ARM/embedded-7-branch revision 261907]\n</code></pre>\n\n<p>But missing from file.elf:</p>\n\n<pre><code>$ strings file.elf | grep rev\nGCC: (15:7-2018-q2-6) 7.3.1 20180622 (release) [ARM/embedded-7-branch revision 261907]\nGCC: (15:7-2018-q2-5) 7.3.1 20180622 (release) [ARM/embedded-7-branch revision 261907]\nGNU C11 7.3.1 20180622 (release) [ARM/embedded-7-branch revision 261907] -mthumb -march=armv6s-m -g -g -g -O2 -O2 -O2 -fbuilding-libgcc -fno-stack-protector -fno-inline -fvisibility=hidden\nGNU C11 7.3.1 20180622 (release) [ARM/embedded-7-branch revision 261907] -mthumb -march=armv6s-m -g -g -g -O2 -O2 -O2 -fbuilding-libgcc -fno-stack-protector -fno-inline -fexceptions -fvisibility=hidden\nGNU C11 7.3.1 20180622 (release) [ARM/embedded-7-branch revision 261907] -mthumb -march=armv6s-m -mthumb -march=armv6s-m -g -O2 -fno-builtin\nprev_tzenv\nLoopForever\nprev_tzenv\n.debug_abbrev\n</code></pre>\n\n<p>Linker command line:</p>\n\n<pre><code>arm-none-eabi-gcc -std=c99 -O3 -Wall -ffunction-sections -mcpu=cortex-m0 -mthumb -mfloat-abi=soft  -Tst/stm32f0xx-32-6.ld -Wl,-Map=dtc_main.map -Wl,--gc-sections  -specs=nano.specs -o file.elf file.o startup_stm32f0xx.o system_stm32f0xx.ao syscalls.o\n</code></pre>\n"}, {"tags": ["c", "opengl", "modeling"], "comments": [{"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1576097297, "post_id": 59293526, "comment_id": 104792284, "body": "So <a href=\"https://linas.org/gle/\" rel=\"nofollow noreferrer\">GLE</a>-style <a href=\"https://linas.org/gle/helixtex.gif\" rel=\"nofollow noreferrer\">helix output</a>?"}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1576225279, "post_id": 59293526, "comment_id": 104837738, "body": "see <a href=\"https://stackoverflow.com/a/35055911/2521214\">Morph a cube to coil</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2550, "user_id": 191012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5cd6859716d64ed0a877c7a8e8969135?s=128&d=identicon&r=PG", "display_name": "prideout", "link": "https://stackoverflow.com/users/191012/prideout"}, "is_accepted": false, "score": 2, "last_activity_date": 1576097723, "creation_date": 1576097723, "answer_id": 59293933, "question_id": 59293526, "link": "https://stackoverflow.com/questions/59293526/model-3d-spring-from-points/59293933#59293933", "title": "Model 3D spring from points", "body": "<p>You probably want to treat these as generalized cylinders and tessellate a triangle mesh. This can be done by sweeping a circle along the path. Some of the details are tricky since undefined tangents can lead to unexpected twists in your triangle mesh. You might want to study the GLE library or the <code>TubeGeometry</code> implementation in ThreeJS.</p>\n\n<p>For simplestic rendering, note that OpenGL has <code>GL_LINE_STRIP</code>. It also has <code>glLineWidth</code>, although many platforms have a max width of 1. You would need to take care to use separate draw calls for seperate springs, otherwise they'll be connected.</p>\n"}], "owner": {"reputation": 39, "user_id": 9442444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53224aad92def3667923ef1f071c2c54?s=128&d=identicon&r=PG&f=1", "display_name": "Paveli Tripo", "link": "https://stackoverflow.com/users/9442444/paveli-tripo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "closed_date": 1576165271, "answer_count": 1, "score": 0, "last_activity_date": 1576097723, "creation_date": 1576095868, "last_edit_date": 1576097221, "question_id": 59293526, "link": "https://stackoverflow.com/questions/59293526/model-3d-spring-from-points", "closed_reason": "Needs more focus", "title": "Model 3D spring from points", "body": "<p>I have generated points like this and now I what to connect all these points into one model - spring. How can I achieve this? I've tried iterating through each point and build it from polygons or triangles but I have failed. </p>\n\n<p>I have set of rings where each ring was build from points which coords I have.</p>\n\n<p><a href=\"https://i.stack.imgur.com/3pI3W.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3pI3W.png\" alt=\"\"></a></p>\n"}, {"tags": ["c", "memory", "memory-management", "valgrind", "generic-programming"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1576098181, "post_id": 59293506, "comment_id": 104792659, "body": "There&#39;s way too much code here to follow. You must not be copying the keys correctly."}], "owner": {"reputation": 65, "user_id": 12234699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MNT7C.jpg?s=128&g=1", "display_name": "Yahav Boneh", "link": "https://stackoverflow.com/users/12234699/yahav-boneh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576095757, "creation_date": 1576095757, "question_id": 59293506, "link": "https://stackoverflow.com/questions/59293506/valgrind-invalid-read-of-size-4-8-bytes-in-1-blocks-are-definitely-lost-in-los", "title": "Valgrind: Invalid read of size 4, 8 bytes in 1 blocks are definitely lost in loss record in C", "body": "<p>I am trying to make a generic map in C, using the following code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include \"map.h\"\n\n//Declaring our function, More detailed explanation at the bottom of the document\n\nstatic MapResult mapPutAll(Map srcMap, Map destMap);\nstatic MapResult freePair(Map map, int i);\nstatic MapResult replacePair(Map map, int i, MapDataElement dataElement, MapKeyElement keyElement);\nstatic int mapFind(Map map, MapKeyElement element);\n\nstruct Map_t{\n    MapDataElement *values;\n    MapKeyElement *keys;\n    int iterator;\n    int size;\n    copyMapDataElements copy_value;\n    copyMapKeyElements copy_key;\n    freeMapDataElements free_value;\n    freeMapKeyElements free_key;\n    compareMapKeyElements compare;\n};\n\nMap mapCreate(copyMapDataElements copyDataElement,\n              copyMapKeyElements copyKeyElement,\n              freeMapDataElements freeDataElement,\n              freeMapKeyElements freeKeyElement,\n              compareMapKeyElements compareKeyElements) {\n\n    if (copyDataElement == NULL || copyKeyElement == NULL ||\n        freeDataElement == NULL || freeKeyElement == NULL || compareKeyElements == NULL) {\n        return NULL;\n    }\n\n    Map map = malloc(sizeof(*map));\n    if (map==NULL) {\n        return NULL;\n    }\n\n    map-&gt;values = malloc(sizeof(MapDataElement));\n    if (map-&gt;values==NULL){\n        return NULL;\n    }\n    map-&gt;keys = malloc(sizeof(MapKeyElement));\n    if (map-&gt;keys==NULL){\n        return NULL;\n    }\n    map-&gt;iterator = 0;\n    map-&gt;size = 0;\n    map-&gt;copy_value = copyDataElement;\n    map-&gt;copy_key = copyKeyElement;\n    map-&gt;free_value = freeDataElement;\n    map-&gt;free_key = freeKeyElement;\n    map-&gt;compare = compareKeyElements;\n\n    return(map);\n}\n\n\nvoid mapDestroy(Map map) {\n    if (map == NULL) {\n        return;\n    }\n    if (mapGetSize(map)==0){\n        free(map-&gt;values);\n        free(map-&gt;keys);\n    }\n    mapClear(map);\n    free(map);\n}\n\nMap mapCopy(Map map) {\n\n    if (map == NULL) {\n        return NULL;\n    }\n    Map map_copy = mapCreate(map-&gt;copy_value, map-&gt;copy_key, map-&gt;free_value, map-&gt;free_key, map-&gt;compare);\n    if (map_copy == NULL) {\n        return NULL;\n    }\n    map_copy-&gt;iterator = map-&gt;iterator;\n    map_copy-&gt;size = map-&gt;size;\n    MapResult result = mapPutAll(map, map_copy);\n    if (result != MAP_SUCCESS) {\n        return NULL;\n    }\n    return map_copy;\n}\n\nint mapGetSize(Map map){\n    return (map==NULL)? -1 : map-&gt;size;\n}\n\nbool mapContains(Map map, MapKeyElement element) {\n    return (mapFind(map,element)&lt;0) ? false : true;\n}\n\nMapResult mapPut(Map map, MapKeyElement keyElement, MapDataElement dataElement){\n    if (map==NULL || keyElement==NULL || dataElement==NULL) {\n        return MAP_NULL_ARGUMENT;\n    }\n    if (mapGetSize(map) == 0){\n        map-&gt;values[0] = dataElement;\n        map-&gt;keys = keyElement;\n        map-&gt;size++;\n        return MAP_SUCCESS;\n    }\n    if (mapContains(map, keyElement)) { //If key exists, replace corresponding value.\n        int index = mapFind(map,keyElement);\n        map-&gt;values[index] = dataElement;\n        return MAP_SUCCESS;\n    }\n    for (int i=0; i&lt;mapGetSize(map); i++){\n        if (map-&gt;compare(keyElement, map-&gt;keys[i])&lt;0) {\n            int new_last_index = mapGetSize(map);\n            MapDataElement ptr_temporary_values;\n            MapKeyElement ptr_temporary_keys;\n\n\n            ptr_temporary_values = realloc(map-&gt;values, sizeof(*map-&gt;values)*(new_last_index+1));\n            map-&gt;values = ptr_temporary_values;\n\n            ptr_temporary_keys = realloc(map-&gt;keys, sizeof(*map-&gt;keys)*(new_last_index+1));\n            map-&gt;keys = ptr_temporary_keys;\n\n\n            if (map-&gt;values==NULL || map-&gt;keys==NULL) return MAP_OUT_OF_MEMORY;\n\n\n            for (int j=new_last_index; j&gt;i; j--){\n                map-&gt;values[j] = map-&gt;values[j-1];\n                map-&gt;keys[j] = map-&gt;keys[j-1];\n            }\n            replacePair(map, i, dataElement, keyElement);\n\n\n            if (map-&gt;values[i]==NULL || map-&gt;keys[i]==NULL) return MAP_OUT_OF_MEMORY;\n\n\n            map-&gt;size++;\n            return MAP_SUCCESS;\n        }\n    }\n    int new_last_index = mapGetSize(map);\n    MapDataElement ptr_temporary_values;\n    MapKeyElement ptr_temporary_keys;\n\n\n    ptr_temporary_values = realloc(map-&gt;values, sizeof(*map-&gt;values)*(new_last_index+1));\n    map-&gt;values = ptr_temporary_values;\n\n    ptr_temporary_keys = realloc(map-&gt;keys, sizeof(*map-&gt;keys)*(new_last_index+1));\n    map-&gt;keys = ptr_temporary_keys;\n\n\n    if (map-&gt;values==NULL || map-&gt;keys==NULL) return MAP_OUT_OF_MEMORY;\n\n\n    map-&gt;values[new_last_index] = map-&gt;copy_value(dataElement);\n    map-&gt;keys[new_last_index] = map-&gt;copy_key(keyElement);\n\n\n    if (map-&gt;values[new_last_index]==NULL || map-&gt;keys[new_last_index]==NULL){\n        return MAP_OUT_OF_MEMORY;\n    }\n\n\n    map-&gt;size++;\n    return MAP_SUCCESS;\n}\n\nMapDataElement mapGet(Map map, MapKeyElement keyElement) {\n    if (map == NULL || keyElement == NULL) {\n        return NULL;\n    }\n\n    if (mapContains(map, keyElement) == false) {\n        return NULL;\n    }\n\n    for (int i = 0; i &lt; map-&gt;size; i++) {\n        if(map-&gt;compare(map-&gt;keys[i], keyElement)  == 0) {\n            return map-&gt;values[i];\n        }\n    }\n\n    return NULL; //Should not get here.\n}\n\nMapResult mapRemove(Map map, MapKeyElement keyElement){\n    if(map==NULL || keyElement==NULL){\n        return MAP_NULL_ARGUMENT;\n    }\n    int size = mapGetSize(map);\n    for (int i=0; i&lt;size; i++){\n        if (map-&gt;compare(map-&gt;keys[i], keyElement)==0){\n            for (int j=i; j&lt;size-1; j++){\n                map-&gt;values[j] = map-&gt;values[j+1];\n                map-&gt;keys[j] = map-&gt;keys[j+1];\n            }\n            freePair(map, size+1);\n            map-&gt;size--;\n            return MAP_SUCCESS;\n        }\n    }\n    return MAP_ITEM_DOES_NOT_EXIST;\n}\n\nMapKeyElement mapGetFirst(Map map){\n    if (map==NULL){\n        return NULL;\n    }\n    map-&gt;iterator=0;\n    return (mapGetSize(map)==0)? NULL : map-&gt;keys[map-&gt;iterator];\n}\n\nMapKeyElement mapGetNext(Map map){\n    if (map==NULL || map-&gt;iterator==mapGetSize(map)-1){\n        return NULL;\n    }\n    map-&gt;iterator++;\n    return map-&gt;keys[map-&gt;iterator];\n}\n\nMapResult mapClear(Map map) {\n    if (map == NULL) {\n        return MAP_NULL_ARGUMENT;\n    }\n    int index = map-&gt;size-1;\n    while(map-&gt;size!=0) {\n        mapRemove(map, map-&gt;keys[index]);\n        index = map-&gt;size-1;\n    }\n    return MAP_SUCCESS;\n}\n\n/**\n * mapPutAll - copies all key-value pairs from one map to another map.\n * Iterator's value is undefined after this operation.\n * @param srcMap - Map that will be copied from.\n * @param destMap - Map that will be copied to.\n * @return\n *  MAP_NULL_ARGUMENT - if a NULL was sent as map\n *  MAP_OUT_OF_MEMORY - if an allocation failed (Meaning the function for copying\n *  an element failed)\n *  MAP_SUCCESS - all the pairs of elements had been inserted successfully\n */\nstatic MapResult mapPutAll(Map srcMap, Map destMap) {\n    if (srcMap==NULL || destMap==NULL){\n        return MAP_NULL_ARGUMENT;\n    }\n    MapResult result=MAP_SUCCESS;\n    for(int i = 0; i &lt; srcMap-&gt;size; i++) {\n        result = mapPut(destMap, srcMap-&gt;keys[i], mapGet(srcMap, srcMap-&gt;keys[i]));/**problem here in first iteration*/\n        if(result != MAP_SUCCESS) {\n            return result;\n        }\n    }\n    return result;\n}\n\n/**\n * freePair - frees the i th pair in the map.\n * @param map - The map to free the pair from.\n * @param i - The index of the pair to be freed.\n * @return\n *  MAP_NULL_ARGUMENT - if a NULL was sent as map.\n *  MAP_SUCCESS - all the pairs of elements had been inserted successfully\n *  or i is out of range.\n */\nstatic MapResult freePair(Map map, int i){\n    if (map==NULL){\n        return MAP_NULL_ARGUMENT;\n    }\n    if (i&lt;0 || i&gt;mapGetSize(map)){\n        return MAP_SUCCESS;\n    }\n    map-&gt;free_value(map-&gt;values[i]);\n    map-&gt;free_key(map-&gt;keys[i]);\n    return MAP_SUCCESS;\n}\n\n/**\n * replacePair - replace the i th pair in map with a new pair and frees the old pair.\n * @param map - The map to replace the pair from.\n * @param i - The index of the pair to be freed.\n * @param dataElement - The data element to replace the old value with.\n * @param keyElement - The key element to replace the old value with.\n * @return\n *  MAP_NULL_ARGUMENT - if a NULL was sent as map.\n *  MAP_OUT_OF_MEMORY - if an allocation failed.\n *  MAP_SUCCESS - all the pairs of elements had been inserted successfully\n *  or i is out of range.\n */\nstatic MapResult replacePair(Map map, int i, MapDataElement dataElement, MapKeyElement keyElement){\n    if (map==NULL || dataElement==NULL || keyElement==NULL){\n        return MAP_NULL_ARGUMENT;\n    }\n    map-&gt;values[i] = dataElement;\n    map-&gt;keys[i] = keyElement;\n    return MAP_SUCCESS;\n}\n\n/**\n* mapFind: Checks if a key element exists in the map, and returns its index in the array.\n* The key element will be considered in the map if one of the key elements in the map it determined equal\n* using the comparison function used to initialize the map.\n*\n* @param map - The map to search in.\n* @param element - The element to look for. Will be compared using the\n*       comparison function.\n* @return\n*   -1 - if one or more of the inputs is null, or if the key element was not found.\n*   index of the element in the array of the map - if the key element was found in the map.\n*/\nstatic int mapFind(Map map, MapKeyElement element) {\n    if(map == NULL || element == NULL) {\n        return -1;\n    }\n    for (int i=0; i&lt;mapGetSize(map); i++) {\n        if (map-&gt;compare(element, map-&gt;keys[i]) == 0) {\n            return i;\n        }\n    }\n    return -1;\n}\n</code></pre>\n\n<p>But when I am trying to run the following test:</p>\n\n<pre><code>#include \"test1.h\"\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include \"map.h\"\n\n/** Function to be used for copying an int as a key to the map */\nstatic MapKeyElement copyKeyInt(MapKeyElement n) {\n    if (!n) {\n        return NULL;\n    }\n    int *copy = malloc(sizeof(*copy));\n    if (!copy) {\n        return NULL;\n    }\n    *copy = *(int *) n;\n    return copy;\n}\n\n/** Function to be used for copying a char as a data to the map */\nstatic MapDataElement copyDataChar(MapDataElement n) {\n    if (!n) {\n        return NULL;\n    }\n    char *copy = malloc(sizeof(*copy));\n    if (!copy) {\n        return NULL;\n    }\n    *copy = *(char *) n;\n    return (MapDataElement) copy;\n}\n\n/** Function to be used by the map for freeing elements */\nstatic void freeInt(MapKeyElement n) {\n    free(n);\n}\n\n/** Function to be used by the map for freeing elements */\nstatic void freeChar(MapDataElement n) {\n    free(n);\n}\n\n/** Function to be used by the map for comparing elements */\nstatic int compareInts(MapKeyElement n1, MapKeyElement n2) {\n    return (*(int *) n1 - *(int *) n2);\n}\n\nbool testMapCreateDestroy() {\n    Map map = mapCreate(copyDataChar, copyKeyInt, freeChar, freeInt,\n                        compareInts);\n    ASSERT_TEST(map != NULL);\n    ASSERT_TEST(mapGetSize(map) == 0);\n    ASSERT_TEST(mapGetFirst(map) == NULL);\n    mapDestroy(map);\n    return true;\n\n}\n\nbool testMapAddAndSize() {\n    Map map = mapCreate(copyDataChar, copyKeyInt, freeChar, freeInt,\n                        compareInts);\n    for (int i = 1; i &lt; 1000; ++i) {\n        char j = (char) i;\n        ++j;\n        ASSERT_TEST(mapPut(map, &amp;i, &amp;j) == MAP_SUCCESS);\n        ASSERT_TEST(mapGetSize(map) == i);\n    }\n    printf(\"\\n%d\\n\",__LINE__);\n    mapDestroy(map);\n    return true;\n}\n\nbool testMapGet() {\n    Map map = mapCreate(copyDataChar, copyKeyInt, freeChar, freeInt,\n                        compareInts);\n    for (int i = 1; i &lt; 1000; ++i) {\n        char j = (char) i;\n        ++j;\n        ASSERT_TEST(mapPut(map, &amp;i, &amp;j) == MAP_SUCCESS);\n        ASSERT_TEST(mapGetSize(map) == i);\n    }\n\n    for (int i = 1; i &lt; 1000; ++i) {\n        char j = (char) i;\n        ++j;\n        char *getVal = (char *) mapGet(map, &amp;i);\n        ASSERT_TEST(*getVal == j);\n    }\n    int i = 0;\n    ASSERT_TEST(mapGet(map, &amp;i) == NULL);\n    i = 1000;\n    ASSERT_TEST(mapGet(map, &amp;i) == NULL);\n    mapDestroy(map);\n    return true;\n}\n\nbool testIterator() {\n    Map map = mapCreate(copyDataChar, copyKeyInt, freeChar, freeInt,\n                        compareInts);\n    for (int i = 1; i &lt; 400; ++i) {\n        char j = (char) i;\n        ++j;\n        ASSERT_TEST(mapPut(map, &amp;i, &amp;j) == MAP_SUCCESS);\n    }\n    for (int i = 800; i &gt;= 400; --i) {\n        char j = (char) i;\n        ++j;\n        ASSERT_TEST(mapPut(map, &amp;i, &amp;j) == MAP_SUCCESS);\n    }\n\n    for (int i = 801; i &lt; 1000; ++i) {\n        char j = (char) i;\n        ++j;\n        ASSERT_TEST(mapPut(map, &amp;i, &amp;j) == MAP_SUCCESS);\n    }\n\n    int i = 1;\n    MAP_FOREACH(int *, iter, map) {\n        ASSERT_TEST(*iter == i);\n        i++;\n    }\n\n    mapDestroy(map);\n    return true;\n}\n\nvoid runTest1() {\n    RUN_TEST(testMapCreateDestroy);\n    RUN_TEST(testMapAddAndSize);\n    RUN_TEST(testMapGet);\n    RUN_TEST(testIterator);\n}\n</code></pre>\n\n<p>note:\ntest1.h is:</p>\n\n<pre><code>#ifndef TEST1_H_\n#define TEST1_H_\n\n#include &lt;stdbool.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid runTest1();\n\n/**\n * These macros are here to help you create tests more easily and keep them\n * clear\n *\n * The basic idea with unit-testing is create a test function for every real\n * function and inside the test function declare some variables and execute the\n * function under test.\n *\n * Use the ASSERT_TEST to verify correctness of values.\n */\n\n/**\n * Evaluates b and continues if b is true.\n * If b is false, ends the test by returning false and prints a detailed\n * message about the failure.\n */\n#define ASSERT_TEST(b) do { \\\n        if (!(b)) { \\\n                printf(\"\\nAssertion failed at %s:%d %s \",__FILE__,__LINE__,#b); \\\n                return false; \\\n        } \\\n} while (0)\n\n/**\n * Macro used for running a test from the main function\n */\n#define RUN_TEST(test) do { \\\n        printf(\"Running \"#test\"... \"); \\\n        if (test()) { \\\n            printf(\"[OK]\\n\");\\\n        } else { \\\n                printf(\"[Failed]\\n\"); \\\n        } \\\n} while(0)\n#endif /* TEST1_H_ */\n</code></pre>\n\n<p>There is an error.\nWhen I used valgrind to see where is the mistake (I ran it with --leak-check=full --track-origins=yes), I got this:</p>\n\n<pre><code>==649== Memcheck, a memory error detector\n==649== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==649== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==649== Command: ./mtm_test1\n==649==\n==649== error calling PR_SET_PTRACER, vgdb might block\nRunning testMapCreateDestroy... [OK]\n==649== Invalid read of size 4\n==649==    at 0x108F10: compareInts (test1.c:44)\n==649==    by 0x108937: mapFind (map.c:321)\n==649==    by 0x1089B6: mapContains (map.c:95)\n==649==    by 0x108A2F: mapPut (map.c:108)\n==649==    by 0x1090DE: testMapAddAndSize (test1.c:64)\n==649==    by 0x109612: runTest1 (test1.c:128)\n==649==    by 0x1087B7: main (main.c:5)\n==649==  Address 0x418a150000000002 is not stack'd, malloc'd or (recently) free'd\n==649==\n==649==\n==649== Process terminating with default action of signal 11 (SIGSEGV)\n==649==  General Protection Fault\n==649==    at 0x108F10: compareInts (test1.c:44)\n==649==    by 0x108937: mapFind (map.c:321)\n==649==    by 0x1089B6: mapContains (map.c:95)\n==649==    by 0x108A2F: mapPut (map.c:108)\n==649==    by 0x1090DE: testMapAddAndSize (test1.c:64)\n==649==    by 0x109612: runTest1 (test1.c:128)\n==649==    by 0x1087B7: main (main.c:5)\nRunning testMapAddAndSize... ==649==\n==649== HEAP SUMMARY:\n==649==     in use at exit: 80 bytes in 3 blocks\n==649==   total heap usage: 7 allocs, 4 frees, 672 bytes allocated\n==649==\n==649== 8 bytes in 1 blocks are definitely lost in loss record 2 of 3\n==649==    at 0x4C2FB0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==649==    by 0x108889: mapCreate (map.c:44)\n==649==    by 0x1090AB: testMapAddAndSize (test1.c:59)\n==649==    by 0x109612: runTest1 (test1.c:128)\n==649==    by 0x1087B7: main (main.c:5)\n==649==\n==649== LEAK SUMMARY:\n==649==    definitely lost: 8 bytes in 1 blocks\n==649==    indirectly lost: 0 bytes in 0 blocks\n==649==      possibly lost: 0 bytes in 0 blocks\n==649==    still reachable: 72 bytes in 2 blocks\n==649==         suppressed: 0 bytes in 0 blocks\n==649== Reachable blocks (those to which a pointer was found) are not shown.\n==649== To see them, rerun with: --leak-check=full --show-leak-kinds=all\n==649==\n==649== For counts of detected and suppressed errors, rerun with: -v\n==649== ERROR SUMMARY: 2 errors from 2 contexts (suppressed: 0 from 0)\nSegmentation fault (core dumped)\n</code></pre>\n\n<p>But I do not understand why is this happening and how to fix it.</p>\n\n<p>Can anybody help me please?</p>\n"}, {"tags": ["c", "pointers", "memory-address"], "comments": [{"owner": {"reputation": 3305, "user_id": 1428695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a843c704cdb7e32a93769cddfed4747?s=128&d=identicon&r=PG", "display_name": "yhyrcanus", "link": "https://stackoverflow.com/users/1428695/yhyrcanus"}, "edited": false, "score": 0, "creation_date": 1576095983, "post_id": 59293317, "comment_id": 104791771, "body": "My bet is that the book writers were trying to say that *p == i  Which is a true statement."}, {"owner": {"reputation": 17597, "user_id": 2016408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/TVba8.jpg?s=128&g=1", "display_name": "Leeor", "link": "https://stackoverflow.com/users/2016408/leeor"}, "edited": false, "score": 1, "creation_date": 1576096145, "post_id": 59293317, "comment_id": 104791844, "body": "Try to switch between the two assignments and see what happens"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1576097155, "post_id": 59293317, "comment_id": 104792241, "body": "Completely different. The first assigns the address, the second assigns the value."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1576098237, "post_id": 59293317, "comment_id": 104792680, "body": "A pointer is simply a normal variable that holds the <i>address of</i> something else as its value. In other words, a pointer <i>points to</i> the address in memory where something else can be found. <code>p = &amp;i;</code> assigns the address in memory where <code>i</code> is stored as the value held by pointer <code>p</code>. (<code>p</code> now points to the memory where <code>i</code> is stored) To reference the value at the address held by a pointer you <i>dereference</i> the pointer by using the unary <code>&#39;*&#39;</code> character before the pointer name. <code>*p = i;</code> would set the value at the memory location held (pointed to) by <code>p</code> to the value of <code>i</code>."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1576104249, "post_id": 59293317, "comment_id": 104794827, "body": "The order of the assignments is <i>completely</i> relevant.  Switching them results in using an undefined pointer, which invokes undefined behavior."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1576095301, "post_id": 59293357, "comment_id": 104791496, "body": "In the question example <code>*p = i;</code> doesn&#39;t do anything because it assigns the value of  <code>i</code> to where <code>p</code> is pointing, which is <code>i</code>."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1576095370, "post_id": 59293357, "comment_id": 104791532, "body": "@WeatherVane Yes, if you do <code>p = &amp;i</code> and then <code>*p = i;</code> immediately afterwards is pointless. My answer is attempting to explain the two syntaxes in isolation. Do you have any suggestions how to make that more clear?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1576095661, "post_id": 59293357, "comment_id": 104791631, "body": "My comment was an attempt to illustrate what is happening, and I voted you up."}, {"owner": {"reputation": 17597, "user_id": 2016408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/TVba8.jpg?s=128&g=1", "display_name": "Leeor", "link": "https://stackoverflow.com/users/2016408/leeor"}, "edited": false, "score": 0, "creation_date": 1576095988, "post_id": 59293357, "comment_id": 104791777, "body": "I would also simplify the second part - <code>assign the value of i to the value at the address that is stored in p</code> --&gt; <code>store the value of i in the memory address pointed to by p</code>, but maybe i&#39;m just nitpicking :)"}, {"owner": {"reputation": 31, "user_id": 10582991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f72818d2eb063900449408d5323ca9?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/10582991/billy"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1576096221, "post_id": 59293357, "comment_id": 104791869, "body": "@WeatherVane This piece of code is all about the concept of the pointer... so <code>p = &amp;i</code> and <code>*p = i</code> come together..."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "reply_to_user": {"reputation": 31, "user_id": 10582991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f72818d2eb063900449408d5323ca9?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/10582991/billy"}, "edited": false, "score": 0, "creation_date": 1576096354, "post_id": 59293357, "comment_id": 104791912, "body": "@Billy The problem is that they do two different things. When you have those two statements in a row, you won&#39;t see anything happen and will have a difficult time understanding what they each do. Hopefully my answer clarifies the difference by using two different variables <code>i</code> and <code>j</code>."}, {"owner": {"reputation": 31, "user_id": 10582991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f72818d2eb063900449408d5323ca9?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/10582991/billy"}, "edited": false, "score": 0, "creation_date": 1576096447, "post_id": 59293357, "comment_id": 104791954, "body": "So <code>p</code> in <code>*p = i</code> will have its own address but point to the value of <code>i</code> while <code>p</code> in <code>p = &amp;i</code> will just give the address of <code>i</code>... am I right?"}, {"owner": {"reputation": 31, "user_id": 10582991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f72818d2eb063900449408d5323ca9?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/10582991/billy"}, "edited": false, "score": 0, "creation_date": 1576099557, "post_id": 59293357, "comment_id": 104793223, "body": "@Billy I proved to myself by doing some experiments about it... I am right.  &lt;br/&gt;<code>p</code> in <code>*p = i</code> will have the address that assigned to the <code>p</code>, although <code>p</code> will have the value of <code>i</code>, <code>p</code> will reserve the address it got.   &lt;br/&gt;And <code>p</code> in <code>p = &amp;i</code> will simply make the <code>p</code> have the address of <code>i</code>.   &lt;br/&gt;@Code-Apprentice Thank you for your help!"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "reply_to_user": {"reputation": 31, "user_id": 10582991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f72818d2eb063900449408d5323ca9?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/10582991/billy"}, "edited": false, "score": 0, "creation_date": 1576100260, "post_id": 59293357, "comment_id": 104793501, "body": "@Billy Yes, in order to use <code>*p</code>, <code>p</code> must already be initialized to a valid address. This is the same as initializing any variable such as <code>int i;</code> before you try to use <code>i</code>. So if you assign <code>p</code> to an address, for example with <code>&amp;p = j</code> in my example in this answer, then you can assign the value at that address to the value of <code>i</code> with <code>*p = i</code>."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "reply_to_user": {"reputation": 31, "user_id": 10582991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f72818d2eb063900449408d5323ca9?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/10582991/billy"}, "edited": false, "score": 1, "creation_date": 1576100342, "post_id": 59293357, "comment_id": 104793547, "body": "@Billy &quot;although p will have the value of i, p will reserve the address it got&quot; More accurately, <b>the memory that <code>p</code> points to</b> will have the value of <code>i</code>. <code>p</code> itself doesn&#39;t change; it just has an address."}], "tags": [], "owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "is_accepted": true, "score": 9, "last_activity_date": 1576096100, "last_edit_date": 1576096100, "creation_date": 1576095121, "answer_id": 59293357, "question_id": 59293317, "link": "https://stackoverflow.com/questions/59293317/is-there-any-differences-between-p-i-and-p-i-while-assigning-the-addre/59293357#59293357", "title": "Is there any differences between &quot;p = &amp;i&quot; and &quot;*p = i&quot; while assigning the address int &quot;i&quot; to a pointer &quot;p&quot;", "body": "<blockquote>\n  <p>Is there any differences between \u201cp = &amp;i\u201d and \u201c*p = i\u201d while assigning the address int \u201ci\u201d to a pointer \u201cp\u201d</p>\n</blockquote>\n\n<p>Yes, there is a huge difference. Only <code>p = &amp;i</code> means \"assign the address of <code>i</code> to <code>p</code>\".</p>\n\n<p>On the other hand <code>*p = i</code> means \"assign the value of <code>i</code> to the value at the address that is stored in <code>p</code>\". You can see the results with a simple example:</p>\n\n<pre><code>int i = 42;\nint* p;\n\np = &amp;i;\nprintf(\"%d\", i);\n*p = 5;\nprintf(\"%d\", i);\n\nint j = 3;\nprintf(\"%d %d\", i, j);\np = &amp;j;\n*p = i;\nprintf(\"%d %d\", i, j);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 1, "last_activity_date": 1576100520, "creation_date": 1576100520, "answer_id": 59294544, "question_id": 59293317, "link": "https://stackoverflow.com/questions/59293317/is-there-any-differences-between-p-i-and-p-i-while-assigning-the-addre/59294544#59294544", "title": "Is there any differences between &quot;p = &amp;i&quot; and &quot;*p = i&quot; while assigning the address int &quot;i&quot; to a pointer &quot;p&quot;", "body": "<p>First, a quick summary - given the declaration</p>\n\n<pre><code>int i, *p;\n</code></pre>\n\n<p>and the statement</p>\n\n<pre><code>p = &amp;i;\n</code></pre>\n\n<p>then the following are true:</p>\n\n<pre><code> p == &amp;i // int * == int *\n*p ==  i // int   == int\n</code></pre>\n\n<p>You've assigned the <em>address</em> of <code>i</code> to <code>p</code>.  Thus, the <em>expressions</em> <code>*p</code> and <code>i</code> evaluate to the same thing.  Assigning a value to <code>*p</code> is the same as assigning a value to <code>i</code>, reading a value from <code>*p</code> is the same as reading a value from <code>i</code>.  If you later did something like</p>\n\n<pre><code>*p = 10;\n</code></pre>\n\n<p>Then this is the same things as writing</p>\n\n<pre><code>i = 10;\n</code></pre>\n\n<p>IOW, you're assigning a new value to the thing <code>p</code> <em>points to</em>.  </p>\n\n<p>If we introduce multiple levels of indirection, like:</p>\n\n<pre><code>int i;\nint *p = &amp;i;\nint **q = &amp;p;\n</code></pre>\n\n<p>then the following are all true:</p>\n\n<pre><code>  q == &amp;p         // int ** == int **\n *q ==  p == &amp;i   // int *  == int *  == int *\n**q == *p ==  i   // int    == int    == int\n</code></pre>\n\n<p>Thus, writing to <code>**q</code> is the same as writing to <code>*p</code> is the same as writing to <code>i</code>.  Writing to <code>*q</code> is the same as writing to <code>p</code>.  </p>\n\n<hr>\n\n<p>The following may or may not be helpful.</p>\n\n<p>I've written a small utility that displays the contents of various items in memory, and I'm going to use that to illustrate the difference between <code>p = &amp;i</code> and <code>*p = i</code>.</p>\n\n<p>First, here's the test program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"dumper.h\"\n\nint main( void )\n{\n  int i = 0, j = 0, *p = NULL;\n  char *names[] = { \"i\", \"j\", \"p\", \"*p\"};\n  void *addrs[] = { &amp;i, &amp;j, &amp;p, NULL };\n  size_t sizes[] = { sizeof i, sizeof j, sizeof p, sizeof *p };\n\n  puts( \"Before any assignments: \");\n  dumper( names, addrs, sizes, 3, stdout );\n\n  p = &amp;i;\n  addrs[3] = p;\n\n  puts( \"After p = &amp;i: \" );\n  dumper( names, addrs, sizes, 4, stdout );\n\n  *p = 42;\n  puts( \"After *p = 42: \" );\n  dumper( names, addrs, sizes, 4, stdout );\n\n  p = &amp;j;\n  addrs[3] = p;\n\n  puts( \"After p = &amp;j: \" );\n  dumper( names, addrs, sizes, 4, stdout );\n\n  *p = 10;\n  puts( \"After *p = 10: \" );\n  dumper( names, addrs, sizes, 4, stdout );\n\n  return 0;\n}\n</code></pre>\n\n<p>The <code>dumper</code> function displays the state of the various objects in memory at that time.  </p>\n\n<p>So, we start with the declarations:</p>\n\n<pre><code>int i = 0, j = 0, *p = 0;\n</code></pre>\n\n<p><code>i</code> and <code>j</code> are regular <code>int</code>s, <code>p</code> is a <em>pointer</em> to <code>int</code>.  That means the values stored in <code>p</code> are the addresses of other <code>int</code> objects.  Here's what things look like in memory at this point:</p>\n\n<pre><code>       Item         Address   00   01   02   03\n       ----         -------   --   --   --   --\n          i  0x7ffee3d07a28   00   00   00   00    ....\n\n          j  0x7ffee3d07a24   00   00   00   00    ....\n\n          p  0x7ffee3d07a18   00   00   00   00    ....\n             0x7ffee3d07a1c   00   00   00   00    ....\n</code></pre>\n\n<p><code>i</code> occupies 4 bytes starting at address <code>0x7ffee3d07a28</code><sup>1</sup>, <code>j</code> occupies four bytes starting at address <code>0x7ffee3d07a24</code>, and <code>p</code> occupies <em>eight</em> bytes starting at address <code>0x7ffee3d07a18</code>.  All three objects currently store 0 values.</p>\n\n<p>Next, we execute the statement</p>\n\n<pre><code>p = &amp;i;\n</code></pre>\n\n<p>This stores the <em>address</em> of <code>i</code> to <code>p</code>.  Here's how things look afterward:</p>\n\n<pre><code>       Item         Address   00   01   02   03\n       ----         -------   --   --   --   --\n          i  0x7ffee3d07a28   00   00   00   00    ....\n\n          j  0x7ffee3d07a24   00   00   00   00    ....\n\n          p  0x7ffee3d07a18   28   7a   d0   e3    (z..\n             0x7ffee3d07a1c   fe   7f   00   00    ....\n\n         *p  0x7ffee3d07a28   00   00   00   00    ....\n</code></pre>\n\n<p>Instead of storing all zeros, <code>p</code> now stores the address of <code>i</code><sup>2</sup>.  Notice that the <em>expression</em> <code>*p</code> has the same effective address as the <em>object</em> <code>i</code><sup>3</sup>.  </p>\n\n<p>Now we execute the statement</p>\n\n<pre><code>*p = 42;\n</code></pre>\n\n<p>Here's how our memory looks now:</p>\n\n<pre><code>       Item         Address   00   01   02   03\n       ----         -------   --   --   --   --\n          i  0x7ffee3d07a28   2a   00   00   00    *...\n\n          j  0x7ffee3d07a24   00   00   00   00    ....\n\n          p  0x7ffee3d07a18   28   7a   d0   e3    (z..\n             0x7ffee3d07a1c   fe   7f   00   00    ....\n\n         *p  0x7ffee3d07a28   2a   00   00   00    *...\n</code></pre>\n\n<p>The least significant byte of <code>i</code> now stores the value <code>0x2a</code>, which is <code>42</code> in hexadecimal.  Note that <code>*p</code> shows the same thing.  Again, in most circumstances, <code>*p</code> is equivalent to <code>i</code>.  </p>\n\n<p>Now, we assign the address of <code>j</code> to <code>p</code>:</p>\n\n<pre><code>p = &amp;j;\n</code></pre>\n\n<p>Here's the state of the world now:</p>\n\n<pre><code>       Item         Address   00   01   02   03\n       ----         -------   --   --   --   --\n          i  0x7ffee3d07a28   2a   00   00   00    *...\n\n          j  0x7ffee3d07a24   00   00   00   00    ....\n\n          p  0x7ffee3d07a18   24   7a   d0   e3    $z..\n             0x7ffee3d07a1c   fe   7f   00   00    ....\n\n         *p  0x7ffee3d07a24   00   00   00   00    ....\n</code></pre>\n\n<p><code>p</code> now stores <code>j</code>'s address, and <code>*p</code> is now equivalent to <code>j</code>.  We finish up by assigning <code>10</code> to <code>*p</code>:</p>\n\n<pre><code>*p = 10;\n</code></pre>\n\n<p>which leaves us with</p>\n\n<pre><code>       Item         Address   00   01   02   03\n       ----         -------   --   --   --   --\n          i  0x7ffee3d07a28   2a   00   00   00    *...\n\n          j  0x7ffee3d07a24   0a   00   00   00    ....\n\n          p  0x7ffee3d07a18   24   7a   d0   e3    $z..\n             0x7ffee3d07a1c   fe   7f   00   00    ....\n\n         *p  0x7ffee3d07a24   0a   00   00   00    ....\n</code></pre>\n\n<p><code>j</code> now stores the value <code>0x0a</code>, which is hex for <code>10</code>. Again, the <em>expression</em> <code>*p</code> is equivalent to <code>j</code>.  </p>\n\n<p><hr>\n<sup></p>\n\n<ol>\n<li>On most systems, the address will change from run to run, so don't get too hung up on the exact address value.\n<li>x86 is little-endian, so the <em>least</em> significant byte is the addressed byte.  This means values read \"backwards\" - left to right, bottom to top.\n<li>This is a bit of dramatic license - <em>expressions</em> don't have addresses as such.  This is just to illustrate that the expression <code>*p</code> is effectively the same as <code>i</code> in most circumstances.\n</ol>\n\n<p></sup></p>\n"}], "owner": {"reputation": 31, "user_id": 10582991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f72818d2eb063900449408d5323ca9?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/10582991/billy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 1, "accepted_answer_id": 59293357, "answer_count": 2, "score": 2, "last_activity_date": 1576100520, "creation_date": 1576094943, "last_edit_date": 1576097141, "question_id": 59293317, "link": "https://stackoverflow.com/questions/59293317/is-there-any-differences-between-p-i-and-p-i-while-assigning-the-addre", "title": "Is there any differences between &quot;p = &amp;i&quot; and &quot;*p = i&quot; while assigning the address int &quot;i&quot; to a pointer &quot;p&quot;", "body": "<p>I found this piece of code in my C programming book:</p>\n\n<pre><code>int i = 42;\nint *p;\n\np = &amp;i;    // &amp; is address of sign\n*p = i;    // * is dereference sign\n</code></pre>\n\n<p>Is there any difference between \"p = &amp;i\" and \"*p = i\"??\nWill \"p\" have different characteristics while using these two expressions???</p>\n\n<p>Edit: Because this code is just trying to explain the concept of the pointer, it is not runnable... So the order of these two assignments is not relevant in this case... Sorry for making things vague...</p>\n"}, {"tags": ["c", "data-structures", "hash", "ip"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1576094927, "post_id": 59293255, "comment_id": 104791325, "body": "IP addresses are just 4 byte numbers, so store them in a sorted list and do a binary search."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1576099779, "post_id": 59293255, "comment_id": 104793303, "body": "Interval trees are nice."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1576107262, "post_id": 59293255, "comment_id": 104795678, "body": "BTW: you dont <i>need</i> to store a value. So: hashmap/bitmask, or hashtab, or interval-tree."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1576113951, "post_id": 59293255, "comment_id": 104797099, "body": "The fastest way will probably be to allocate half a gigabyte of RAM (2^32 bits) and treat it as a set."}], "answers": [{"tags": [], "owner": {"reputation": 399, "user_id": 1012668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1393d74f12d82dc0b549f41e731e0b?s=128&d=identicon&r=PG", "display_name": "Ariel", "link": "https://stackoverflow.com/users/1012668/ariel"}, "is_accepted": true, "score": 0, "last_activity_date": 1577178404, "last_edit_date": 1577178404, "creation_date": 1577178065, "answer_id": 59466291, "question_id": 59293255, "link": "https://stackoverflow.com/questions/59293255/fast-lookup-ipv4-set/59466291#59466291", "title": "Fast lookup IPv4 Set", "body": "<p>Usually, with very little work you can change the structure to treat the key as the value itself. Such sorted-set, which might be based on a skip-list, will be leaner.</p>\n"}], "owner": {"reputation": 13, "user_id": 11853789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e496b765be7b1731b7c92bb2c582f79?s=128&d=identicon&r=PG&f=1", "display_name": "bin", "link": "https://stackoverflow.com/users/11853789/bin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 59466291, "answer_count": 1, "score": 0, "last_activity_date": 1577178404, "creation_date": 1576094705, "question_id": 59293255, "link": "https://stackoverflow.com/questions/59293255/fast-lookup-ipv4-set", "title": "Fast lookup IPv4 Set", "body": "<p>I've been doing some homework on which data structure is best for optimized lookup of IPv4 addresses to implement in C.  I don't need key-value, just to check if it's present in a set.  I can't have false positives, so no bloom filter.  Most of the options recommended (radix tree, y-fast tree) are for key-value storage.  I've considered a hash table, but don' t need to store a value, just a key.  What's the best way to do this with fast lookups as the foremost concern?  </p>\n"}, {"tags": ["c", "arrays", "malloc", "scanf"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1576094002, "post_id": 59293037, "comment_id": 104790873, "body": "<code>board=malloc(n*sizeof(int));</code> -&gt; <code>board=malloc(n*sizeof(*board));</code>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1576107278, "post_id": 59293037, "comment_id": 104795685, "body": "Or at least <code>board=malloc(n*sizeof(int*));</code>"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1576094044, "creation_date": 1576094044, "answer_id": 59293094, "question_id": 59293037, "link": "https://stackoverflow.com/questions/59293037/segmentation-fault-in-a-two-dimensional-array-using-scanf/59293094#59293094", "title": "Segmentation fault in a two dimensional array using scanf", "body": "<p>You're not allocating the right amount of memory:</p>\n\n<pre><code>board=malloc(n*sizeof(int));\n</code></pre>\n\n<p>You're setting up <code>board</code> as an array of <code>int *</code>, but you're only allocating space for an array of <code>int</code>.  Most likely an <code>int</code> is smaller than an <code>int *</code> on your system, so you're not allocating enough.  You subsequently write past the end of allocated memory resulting in <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>Change this allocation to:</p>\n\n<pre><code>board=malloc(n*sizeof(int *));\n</code></pre>\n\n<p>Or better yet:</p>\n\n<pre><code>board=malloc(n*sizeof(*board));\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10118494, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-t56uYNAT2HY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oCGJfvjtTMC4h_Pq29YCpPqsvIRQ/mo/photo.jpg?sz=128", "display_name": "John Kal", "link": "https://stackoverflow.com/users/10118494/john-kal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576107117, "creation_date": 1576093747, "last_edit_date": 1576107117, "question_id": 59293037, "link": "https://stackoverflow.com/questions/59293037/segmentation-fault-in-a-two-dimensional-array-using-scanf", "title": "Segmentation fault in a two dimensional array using scanf", "body": "<p>I've been getting segmentation fault in this piece of code, in the part where I <code>scanf</code> for the values of the board. In the beginning, I scan two times for the dimensions. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"maxsum.h\"\nint main() {\n    int x,y,n,m,**board;\n    scanf(\"%d %d\",&amp;n,&amp;m);\n    board=malloc(n*sizeof(int));\n    if (board==NULL)  {\n        printf(\"Unable to allocate memory \\n\");\n        return 1;\n    }\n    for (x=0;x&lt;n;x++)  {\n        *(board+x)=malloc(m*sizeof(int));\n        if (*(board+x)==NULL)  {\n            printf(\"Unable to allocate memory \\n\");\n            return 1;\n        } \n    } \n    for (x=0;x&lt;n;x++)  {\n        for (y=0;y&lt;m;y++)  {\n            scanf(\"%d\",&amp;board[x][y]); // the error happens in this line ,and only when variable x is about to become n-1 when n&gt;4 (very confused as to why)// \n        }\n    }\n    printf(\"%d \\n\",Solve(n,m,board)); //not relevant //\n    return 0;\n}\n\n</code></pre>\n"}, {"tags": ["c", "arrays", "function", "pointers"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1576093068, "post_id": 59292853, "comment_id": 104790433, "body": "There must be a duplicate Q for returning a pointer to a local variable..."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1576093197, "post_id": 59292853, "comment_id": 104790488, "body": "Perhaps <a href=\"https://stackoverflow.com/questions/4570366/how-to-access-a-local-variable-from-a-different-function-using-pointers\">How to access a local variable from a different function using pointers?</a>"}, {"owner": {"reputation": 23, "user_id": 12121012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Z27l.jpg?s=128&g=1", "display_name": "Levent Kaya", "link": "https://stackoverflow.com/users/12121012/levent-kaya"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1576093214, "post_id": 59292853, "comment_id": 104790495, "body": "where? At the expoBin part?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1576093254, "post_id": 59292853, "comment_id": 104790517, "body": "<code>int binAr[100]</code> dies immediately after <code>return binAr;</code> it no longer exists although an unreliable ghost might linger for a while."}, {"owner": {"reputation": 23, "user_id": 12121012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Z27l.jpg?s=128&g=1", "display_name": "Levent Kaya", "link": "https://stackoverflow.com/users/12121012/levent-kaya"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1576093306, "post_id": 59292853, "comment_id": 104790546, "body": "So should I open memory with malloc function?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1576093323, "post_id": 59292853, "comment_id": 104790553, "body": "Yes, use <code>malloc</code> and <code>free</code> the memory later."}, {"owner": {"reputation": 23, "user_id": 12121012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Z27l.jpg?s=128&g=1", "display_name": "Levent Kaya", "link": "https://stackoverflow.com/users/12121012/levent-kaya"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1576093671, "post_id": 59292853, "comment_id": 104790715, "body": "It didnt fix &#39;&#39;&#39;  int  *binAr = malloc(sizeof(int) * 100); &#39;&#39;&#39; I used like that but the outpu is still the same"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1576094237, "post_id": 59292853, "comment_id": 104790989, "body": "Well, if <code>expoBin[0]</code> is <code>0</code> then you won&#39;t &quot;get any output&quot;. And if <code>num</code> is <i>even</i> then it will be <code>0</code>."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1576094276, "post_id": 59292853, "comment_id": 104791007, "body": "Please update your code and provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal verifiable example</a>. That is, provide a <code>main</code> and show the inputs the functions are being called with."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1576094320, "post_id": 59292853, "comment_id": 104791028, "body": "Did you intend <code>binAr[i] = num % 2 + &#39;0&#39;;</code> and a <code>char</code> array, followed by <code>printf(&quot;%c&quot;, expoBin[i])</code> ?"}, {"owner": {"reputation": 23, "user_id": 12121012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Z27l.jpg?s=128&g=1", "display_name": "Levent Kaya", "link": "https://stackoverflow.com/users/12121012/levent-kaya"}, "edited": false, "score": 0, "creation_date": 1576094617, "post_id": 59292853, "comment_id": 104791181, "body": "well its worked but when i enter &#39;2&#39; the output is 0. But it should be 10"}], "owner": {"reputation": 23, "user_id": 12121012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Z27l.jpg?s=128&g=1", "display_name": "Levent Kaya", "link": "https://stackoverflow.com/users/12121012/levent-kaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576092929, "creation_date": 1576092929, "question_id": 59292853, "link": "https://stackoverflow.com/questions/59292853/array-returning-issues-with-pointers", "title": "Array returning issues with pointers", "body": "<p>I know that I can return an array with pointers. But when try to make this in two functions like that;</p>\n\n<pre><code>    int* decToBin(int num){\n    int binAr[100], i = 0;\n    while(num != 0){\n        binAr[i] = num % 2;\n        num /= 2;\n        i++;\n    }\n    binAr[i+1] = '\\0';\n\n    return binAr;\n}\n\nint modExp(int b, int e, int m){\n    int* expoBin = decToBin(e);\n    int i = 0;\n    while(expoBin[i] != '\\0'){\n        printf(\"%d\", expoBin[i]);\n        i++;\n    }\n\n    return expoBin;\n\n}\n</code></pre>\n\n<p>I cant get any output. I know that I'm missing a silly point but I can't figure out.</p>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 1404, "user_id": 10496710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cb3d11da053d8e1e94ef99a27ca6af?s=128&d=identicon&r=PG&f=1", "display_name": "B. Go", "link": "https://stackoverflow.com/users/10496710/b-go"}, "edited": false, "score": 0, "creation_date": 1576092193, "post_id": 59292578, "comment_id": 104790077, "body": "(2 because of widthtwo + 1 the next line) *2 because of width"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 12374167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22bb6c8161e891436fcfb01ebc06848b?s=128&d=identicon&r=PG&f=1", "display_name": "Trifonas-Kaoulla", "link": "https://stackoverflow.com/users/12374167/trifonas-kaoulla"}, "edited": false, "score": 0, "creation_date": 1576092500, "post_id": 59292673, "comment_id": 104790195, "body": "In what order does the compiler execute the code? For example, will it read a = 0 first, check the boolean next, execute the first printf, then execute the second printf, then increment a, and do that over?  If it does that, then 4 # marks are produced. After executing that code, will it then run the int j part, producing two more # marks?  If it does it in that order, I think I see why 6 # marks are produced."}, {"owner": {"reputation": 1340, "user_id": 7218062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e0d5a2d3c49c93f1aafd67adaaca59?s=128&d=identicon&r=PG&f=1", "display_name": "jmq", "link": "https://stackoverflow.com/users/7218062/jmq"}, "reply_to_user": {"reputation": 31, "user_id": 12374167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22bb6c8161e891436fcfb01ebc06848b?s=128&d=identicon&r=PG&f=1", "display_name": "Trifonas-Kaoulla", "link": "https://stackoverflow.com/users/12374167/trifonas-kaoulla"}, "edited": false, "score": 0, "creation_date": 1576093023, "post_id": 59292673, "comment_id": 104790414, "body": "I updated my answer with some information that hopefully helps you.  The 2nd printf will be called after the &quot;a&quot; loop is completed.  Since this printf is not needed just get rid of it and your code will work correctly."}], "tags": [], "owner": {"reputation": 1340, "user_id": 7218062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e0d5a2d3c49c93f1aafd67adaaca59?s=128&d=identicon&r=PG&f=1", "display_name": "jmq", "link": "https://stackoverflow.com/users/7218062/jmq"}, "is_accepted": false, "score": 1, "last_activity_date": 1576092882, "last_edit_date": 1576092882, "creation_date": 1576092110, "answer_id": 59292673, "question_id": 59292578, "link": "https://stackoverflow.com/questions/59292578/why-are-6-marks-being-produced-in-this-code/59292673#59292673", "title": "Why are 6 # Marks Being Produced in This Code?", "body": "<p>Remove the 2nd printf(\"#\"); line.  This is adding the two extra # since it is called every time in the j loop.</p>\n\n<pre><code>for (int i = 0; i &lt; height; i++)\n{\n    for (int j = 0; j &lt; width; j++)\n    {   \n        for (int a = 0; a &lt; widthtwo; a++)\n        {\n            printf(\"#\");   // Executed 1*2*2 times \n        }\n\n        printf(\"#\");       // Executed 1*2 times - Remove this line\n    }\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>This may help you visualize it:</p>\n\n<pre><code>i j a\n0 0 0 #\n0 0 1 ##\n0 0 1 ### (last # is from 2nd printf)\n0 1 0 ####\n0 1 1 #####\n0 1 1 ###### (last # is from 2nd print)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1543, "user_id": 2356315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c10a97a2ed38b2a913e47c64ebe2fa?s=128&d=identicon&r=PG", "display_name": "Hektor", "link": "https://stackoverflow.com/users/2356315/hektor"}, "is_accepted": false, "score": 0, "last_activity_date": 1576092698, "creation_date": 1576092698, "answer_id": 59292798, "question_id": 59292578, "link": "https://stackoverflow.com/questions/59292578/why-are-6-marks-being-produced-in-this-code/59292798#59292798", "title": "Why are 6 # Marks Being Produced in This Code?", "body": "<p>The outer loop runs once - only when i = 0.\nSo all the other code enclosed in the block (and inside that loop) will run once.</p>\n\n<p>The inner 'j' loop will run twice in total, when j=0 and when j=1. Each time it runs,\nthe innermost 'a' loop runs twice, and it prints '#' once each time. That would be (2 x 2)  4 '#'s printed. </p>\n\n<p>But after the 'a' loop has run twice, each time the program will execute the printf(\"#\") line which is inside the 'j' loop, and which runs after the 'a' loop. So once for each time the 'j' loop iterates - i.e. twice - and that means another 2 x '#'.</p>\n"}], "owner": {"reputation": 31, "user_id": 12374167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22bb6c8161e891436fcfb01ebc06848b?s=128&d=identicon&r=PG&f=1", "display_name": "Trifonas-Kaoulla", "link": "https://stackoverflow.com/users/12374167/trifonas-kaoulla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1576097563, "creation_date": 1576091709, "last_edit_date": 1576097563, "question_id": 59292578, "link": "https://stackoverflow.com/questions/59292578/why-are-6-marks-being-produced-in-this-code", "title": "Why are 6 # Marks Being Produced in This Code?", "body": "<p>I have a problem that needs some explaining. </p>\n\n<p>When I run the code below, I will be asked for 3 values: height, width, and widthtwo. If I enter 1 for height, 2 for width, and 2 for widthtwo, 6 # marks are produced on just one line, like this \"######\"--without the quotations marks, obviously. I don't understand why 6 are being produced. I would expect 4 # marks to be the product. Please help!</p>\n\n<p>After running with the aforementioned values, ###### will be the product. </p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int height = get_int(\"Height of Pyramid?\");\n    int width = get_int(\"Length of Width?\");\n    int widthtwo = get_int(\"Length of Widthtwo?\");\n    for (int i = 0; i &lt; height; i++)\n    {\n        for (int j = 0; j &lt; width; j++)\n        {   \n            for (int a = 0; a &lt; widthtwo; a++)\n            {\n                printf(\"#\");\n            }\n\n            printf(\"#\");\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n"}, {"tags": ["linux", "c"], "comments": [{"owner": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "edited": false, "score": 3, "creation_date": 1576092147, "post_id": 59372740, "comment_id": 104938094, "body": "Those are c99 <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Designated-Inits.html\" rel=\"nofollow noreferrer\">designated initializers</a>. You will initialize your struct as <code>struct employee foo = { .salary = -.001, .name = &quot;bar&quot;, .empId = 1334 };</code>"}, {"owner": {"reputation": 85, "user_id": 1560718, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/33aa1e754b571e2f4d791cf8e456c8af?s=128&d=identicon&r=PG", "display_name": "Aruna Hewapathirane", "link": "https://stackoverflow.com/users/1560718/aruna-hewapathirane"}, "reply_to_user": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "edited": false, "score": 0, "creation_date": 1576115858, "post_id": 59372740, "comment_id": 104938095, "body": "@mosvy Things are starting to become very clear to me now. Thank you very much for the clarification and example What is the benefit or advantage of doing things this way using designated initialization compared to the normal way ? And how do I select your comment as the correct answer though ?"}], "answers": [{"tags": [], "owner": {"reputation": 2021, "user_id": 4500798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a935dafe246dd0e2c216542f50073cbe?s=128&d=identicon&r=PG", "display_name": "Stephen Kitt", "link": "https://stackoverflow.com/users/4500798/stephen-kitt"}, "is_accepted": true, "score": 3, "last_activity_date": 1576138967, "creation_date": 1576138967, "answer_id": 59372741, "question_id": 59372740, "link": "https://stackoverflow.com/questions/59372740/linux-netlink-struct-member-definition/59372741#59372741", "title": "linux netlink struct member definition", "body": "<p>As <a href=\"https://unix.stackexchange.com/users/308316/mosvy\">mosvy</a> said in a comment, these are <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Designated-Inits.html\" rel=\"nofollow noreferrer\">C99 designated initialisers</a>.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>struct netlink_kernel_cfg cfg = {\n    .input  = scsi_nl_rcv_msg,\n    .groups = SCSI_NL_GRP_CNT,\n};\n</code></pre>\n\n<p>doesn\u2019t declare a structure (as your <code>employee</code> example does), it declares a variable, <code>cfg</code>, of type <code>struct netlink_kernel_cfg</code>, and initialises two of its members, <code>input</code> and <code>groups</code>.</p>\n\n<p>The main advantages of this syntax are that the declaration order no longer matters, that members can be omitted (and are initialised in the same way as static variables), and that it\u2019s easier to read.</p>\n"}], "migrated_from": {"other_site": {"aliases": ["http://linux.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1294871917, "open_beta_date": 1282071600, "closed_beta_date": 1281466800, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/unix/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon.png", "audience": "users of Linux, FreeBSD and other Un*x-like operating systems", "site_url": "https://unix.stackexchange.com", "api_site_parameter": "unix", "logo_url": "https://cdn.sstatic.net/Sites/unix/Img/logo.png", "name": "Unix &amp; Linux", "site_type": "main_site"}, "on_date": 1576580177, "question_id": 556768}, "owner": {"reputation": 85, "user_id": 1560718, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/33aa1e754b571e2f4d791cf8e456c8af?s=128&d=identicon&r=PG", "display_name": "Aruna Hewapathirane", "link": "https://stackoverflow.com/users/1560718/aruna-hewapathirane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 59372741, "answer_count": 1, "score": 2, "last_activity_date": 1576580177, "creation_date": 1576090696, "question_id": 59372740, "link": "https://stackoverflow.com/questions/59372740/linux-netlink-struct-member-definition", "title": "linux netlink struct member definition", "body": "<p>I recently came across this while browsing the Linux kernel source:</p>\n\n<pre><code>struct netlink_kernel_cfg cfg = {\n    .input  = scsi_nl_rcv_msg,\n    .groups = SCSI_NL_GRP_CNT,\n};\n</code></pre>\n\n<p>The full source is <a href=\"https://elixir.bootlin.com/linux/latest/source/drivers/scsi/scsi_netlink.c#L128\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>I am trying to understand how the member definitions <code>.input</code> and <code>.groups</code> work? The C <code>struct</code>s I am familiar with are similar to:</p>\n\n<pre><code>struct employee{\n       char    name[30];\n       int     empId;\n       float   salary;\n};\n</code></pre>\n\n<p>So how do <code>.input</code> and <code>.groups</code> work? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2236, "user_id": 11384392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5bfH.jpg?s=128&g=1", "display_name": "Das_Geek", "link": "https://stackoverflow.com/users/11384392/das-geek"}, "edited": false, "score": 0, "creation_date": 1576089711, "post_id": 59291939, "comment_id": 104789010, "body": "Welcome to Stack Overflow! Please <a href=\"https://stackoverflow.com/posts/59291939/edit\">edit your question</a> to include <i>exactly</i> what your problem is. Just quickly looking at your code, it seems as though you&#39;re missing an opening parentheses after your <code>if (number==999)</code>. But I can&#39;t know if that will fix your issue <i>unless you explain it</i>. Please include your <i>specific</i> error message or incorrect behavior, as well as what you&#39;ve done to try to fix it yourself."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 2236, "user_id": 11384392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5bfH.jpg?s=128&g=1", "display_name": "Das_Geek", "link": "https://stackoverflow.com/users/11384392/das-geek"}, "edited": false, "score": 1, "creation_date": 1576090091, "post_id": 59291939, "comment_id": 104789171, "body": "@Das_Geek Fixing indentation (though normally a noble endeavor) is risky in the presence of asymmetric <code>{}</code>."}, {"owner": {"reputation": 2236, "user_id": 11384392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5bfH.jpg?s=128&g=1", "display_name": "Das_Geek", "link": "https://stackoverflow.com/users/11384392/das-geek"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1576090473, "post_id": 59291939, "comment_id": 104789339, "body": "@Yunnosch Agreed. Though in this case I believe I am correct, as otherwise there&#39;s nowhere else for the second <code>else</code> to go."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1576090488, "post_id": 59291939, "comment_id": 104789344, "body": "Dexter11 Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of your code. That requires at least to fix the questionable structure of <code>{}</code>."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 2236, "user_id": 11384392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5bfH.jpg?s=128&g=1", "display_name": "Das_Geek", "link": "https://stackoverflow.com/users/11384392/das-geek"}, "edited": false, "score": 0, "creation_date": 1576090737, "post_id": 59291939, "comment_id": 104789436, "body": "@Das_Geek I think so, too. But the indentation you applied (though convincing) practically implies inserting the <code>{</code> and is (only in my opinion) borderline code-changing. Note that I did not reject your edit, but won&#39;t accept it either. Maybe others like it and that would be fine with me. But ideally Dexter does the code fixing themselves. If not, then spending more time on this question is pointless anyway."}, {"owner": {"reputation": 1, "user_id": 12520235, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9HCr3SND_BM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3ren6ieiTN3FKdF8oTOt4ueWisKkhA/photo.jpg?sz=128", "display_name": "Dexter11", "link": "https://stackoverflow.com/users/12520235/dexter11"}, "edited": false, "score": 0, "creation_date": 1576090822, "post_id": 59291939, "comment_id": 104789462, "body": "Just wanna fix all the mistakes in this code. And also find a way to mitigate buffer overflows and invalid inputs. So if someone could help me change the function and logic only and keep the body."}, {"owner": {"reputation": 2236, "user_id": 11384392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5bfH.jpg?s=128&g=1", "display_name": "Das_Geek", "link": "https://stackoverflow.com/users/11384392/das-geek"}, "edited": false, "score": 0, "creation_date": 1576091215, "post_id": 59291939, "comment_id": 104789639, "body": "@Dexter11 What mistakes does your compiler say that you have? Please include the errors and highlight what lines they&#39;re being thrown on."}, {"owner": {"reputation": 2040, "user_id": 7449706, "user_type": "registered", "profile_image": "https://graph.facebook.com/1302265936460934/picture?type=large", "display_name": "Kevin Ng", "link": "https://stackoverflow.com/users/7449706/kevin-ng"}, "edited": false, "score": 0, "creation_date": 1576091923, "post_id": 59291939, "comment_id": 104789948, "body": "@Dexter11 - Your code does not have any buffer overflow vulnerability. You reading a digit value into an integer variable. There is nothing that can over flow that."}, {"owner": {"reputation": 2040, "user_id": 7449706, "user_type": "registered", "profile_image": "https://graph.facebook.com/1302265936460934/picture?type=large", "display_name": "Kevin Ng", "link": "https://stackoverflow.com/users/7449706/kevin-ng"}, "edited": false, "score": 0, "creation_date": 1576092333, "post_id": 59291939, "comment_id": 104790132, "body": "@Dexter11 - Buffer overflow is when you use a fixed-length memory block as a buffer to get variable length data and that variable-length data was written beyond the bound of your fixed-length array. The extra data that your fixed-length memory couldn&#39;t handle, will go into another region of your program memory unintended and corrupt your program memory and cause vulnerability in your software.  When it comes to the OS, it used to be bad, but now a day OS usually does not allow you to write to another&#39;s software region of memory."}, {"owner": {"reputation": 2040, "user_id": 7449706, "user_type": "registered", "profile_image": "https://graph.facebook.com/1302265936460934/picture?type=large", "display_name": "Kevin Ng", "link": "https://stackoverflow.com/users/7449706/kevin-ng"}, "edited": false, "score": 0, "creation_date": 1576092476, "post_id": 59291939, "comment_id": 104790184, "body": "@Dexter11 - Also, you already guarded against invalid input by checking scanf return value."}, {"owner": {"reputation": 1, "user_id": 12520235, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9HCr3SND_BM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3ren6ieiTN3FKdF8oTOt4ueWisKkhA/photo.jpg?sz=128", "display_name": "Dexter11", "link": "https://stackoverflow.com/users/12520235/dexter11"}, "edited": false, "score": 0, "creation_date": 1576092765, "post_id": 59291939, "comment_id": 104790304, "body": "Can anyone edit the code and show me where i should make changes to make it work?"}], "answers": [{"tags": [], "owner": {"reputation": 2040, "user_id": 7449706, "user_type": "registered", "profile_image": "https://graph.facebook.com/1302265936460934/picture?type=large", "display_name": "Kevin Ng", "link": "https://stackoverflow.com/users/7449706/kevin-ng"}, "is_accepted": false, "score": -1, "last_activity_date": 1576121954, "last_edit_date": 1576121954, "creation_date": 1576101336, "answer_id": 59294700, "question_id": 59291939, "link": "https://stackoverflow.com/questions/59291939/fixing-code-to-mitigate-against-buffer-overflows-and-invalid-inputs/59294700#59294700", "title": "Fixing code to mitigate against buffer overflows and invalid inputs", "body": "<p>For your code, you are parsing an integer value to an integer variable. Thus, your code does not contain a buffer overflow vulnerability.</p>\n\n<p>For formatting, your code can disregard input such as alpha before number values, but it can't check whether if there are invalid inputs after the parse-able integer value. Thus, strings that are 999abc will work with your original code.</p>\n\n<p>To prevent, that, I make scanf() parse 1 additional character after the integer value. That character could be anything, just not an end of line character. if scanf() could read that character, that means the input is invalid. Some examples of invalid inputs are \"999 \", \"999abc\", and \"999-assdf\".</p>\n\n<p>Thus, scanf() return value is 0 if invalid characters are preceding the integer value or when there are only invalid inputs, 2 if invalid characters are succeeding the integer value, 1 if it is only the integer that you intended to read. Thus, scanf() return value should only be 1 for a successful parse case of a valid integer value.</p>\n\n<p>For when it fails, stdin has to be flushed. Thus, I flush stdin with getchar(). Otherwise, those unparsable characters will be read by the next scanf().</p>\n\n<p>Updated: I just remembered that you could also read that character without an array. Thus, I updated the answer code. Also, the most noticeable nuisance of scanf() that can sometimes become a vulnerability is when parsing numbers, scanf() does not check for overflow and there is no way to fix that. Unless you limit the amount of digit parsing to 9 digits for int32. Although for int32 there are 10 digits, it can overflow multiple times with just 9999999999. So with the example code below, giving this number 2014339662823, it will pass your password as 999. </p>\n\n<p>There are a few methods to beat that overflow nuisance and one of those is to parse a number into a higher data type. For example, if you need an int value of 32 bits. Parse it into an int64. Then check the result. But then what happens if you wanted to parse the number into the highest data type. Like if available, int128. Then the only way is to parse the input as a string and then check and parse the input to an int type by yourself. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nvoid password();\nint main(){\n  password();\n  return 0;\n} \n\nvoid password(){\n  int number, c;\n  char voidChar;\n  printf(\"PLEASE ENTER YOUR PASSWORD \\n\"); \n\n  while (1){\n    if((scanf(\"%d%[^\\n]c\",&amp;number, &amp;voidChar)) != 1){\n      printf(\"Wrong input(Integer Only):\\n\");\n      while((c = getchar()) != EOF &amp;&amp; c != '\\n');\n      continue;\n    } else {\n      if (number==999){\n        printf(\"\\n----PASSWORD IS CORRECT-----\\n\\n\");\n        break;\n      }\n      printf(\"\\n Please enter a valid password\\n\");\n    } \n\n  }\n}\n</code></pre>\n\n<p>Since you don't know what is a buffer overflow. This code below is to demonstrate a simple example of a buffer overflow. Run the code below and for input, put \"abcdefghijklmnopqrstuvwxyz012456Hello_World\" without quotes. After you run that, you will still be able to free the memory allocated for the \"user\" variable. However, you won't be able to free the memory that was allocated for the \"thisWillChange\" variable. Its block of memory is corrupted after scanf() wrote beyond the bound of memory that was reserved by malloc for the \"user\" variable.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {           \n  char * user = (char * ) malloc(10);\n  char * thisWillChange = (char *) malloc(10);\n\n  puts(\"Please enter your password\");\n  scanf(\"%s\", user);\n\n  puts(thisWillChange);\n\n  // abcdefghijklmnopqrstuvwxyz012456Hello_World\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12520235, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9HCr3SND_BM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3ren6ieiTN3FKdF8oTOt4ueWisKkhA/photo.jpg?sz=128", "display_name": "Dexter11", "link": "https://stackoverflow.com/users/12520235/dexter11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1576121954, "creation_date": 1576088862, "last_edit_date": 1576094069, "question_id": 59291939, "link": "https://stackoverflow.com/questions/59291939/fixing-code-to-mitigate-against-buffer-overflows-and-invalid-inputs", "title": "Fixing code to mitigate against buffer overflows and invalid inputs", "body": "<p>How can the following code be made robust against buffer overflows and invalid inputs?\nCan you please edit which parts I should change!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nvoid password();\nint main()\n{\npassword();\nreturn 0;\n}\nvoid password()\n{\nint number;\nprintf(\"PLEASE ENTER YOUR PASSWORD \\n\");\nwhile (1){\nif((scanf(\"%d\",&amp;number)) != 1)\n{\n printf(\"wrong input\\n\");\n}\nelse {\n if (number==999)\n printf(\"\\n----PASSWORD IS CORRECT-----\\n\\n\");\n break;\n }\n else\n printf(\"\\n Please enter a valid password (integer)\\n\");\n }\n }\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "memory-management"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1576088473, "post_id": 59291857, "comment_id": 104788462, "body": "This is pretty much how the common <code>malloc</code> implementation is working. Try reading about it."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1576089016, "post_id": 59291857, "comment_id": 104788726, "body": "Be careful with your wording.  You say &quot;a chunk of memory allocated by another C program&quot; \u2014 that&#39;s unusual right there.  It would have to be shared memory if another program allocates the chunk of memory (or it would be memory allocated prior to a <code>fork()</code> and inherited by the child before an <code>exec*()</code> operation).  Otherwise, you can&#39;t directly access memory allocated by another process.  I&#39;m not sure whether you mean &quot;other C functions&quot; or something else.  But the basic process for memory managers is normally to allocate a big chunk and dole out smaller pieces on demand."}, {"owner": {"reputation": 21, "user_id": 9718251, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Berk Erzin", "link": "https://stackoverflow.com/users/9718251/berk-erzin"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576089854, "post_id": 59291857, "comment_id": 104789067, "body": "@Eugene Sh. I did. It didn&#39;t help."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1576093976, "post_id": 59291857, "comment_id": 104790863, "body": "Are you at least allowed a pointer or two outside the chunks to know where the list(s) of memory start?  I would assume so, but you should double check."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1576094109, "post_id": 59291857, "comment_id": 104790925, "body": "Also, a header (or footer) per allocated memory block that sits outside of the returned pointer to the user is a very common way of doing this.  Someone wants 32 bytes, you allocate <code>sizeof(YourHeader)+32</code> bytes, setup your linked lists to block or whatever, then return a pointer to the area the user is allowed to use."}, {"owner": {"reputation": 21, "user_id": 9718251, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Berk Erzin", "link": "https://stackoverflow.com/users/9718251/berk-erzin"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1576095044, "post_id": 59291857, "comment_id": 104791380, "body": "@Michael Dorgan I am allowed a static array and some global variables but that is it. What I have in mind is to simply use to first n bytes of the chunk for a long int array then divide the rest of the chunk into frames of equal size. Long int array will have length equal to the number of frames whenever I pass a block(which may consist of multiple frames) I will write the pointer I passed into the array. So lets say I allocated 3rd, 4th, 5th frames and passed a pointer pointing to the start of the 3rd frame. Array[3] = Array[4] = Array[5] = pointer I passed."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9718251, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Berk Erzin", "link": "https://stackoverflow.com/users/9718251/berk-erzin"}, "edited": false, "score": 0, "creation_date": 1576091998, "post_id": 59292304, "comment_id": 104789986, "body": "How would you even deallocate memory blocks in such a structure or keep track of just which parts are currently allocated? Is it possible to use best-fit/worst-fit methods with such a structure?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 21, "user_id": 9718251, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Berk Erzin", "link": "https://stackoverflow.com/users/9718251/berk-erzin"}, "edited": false, "score": 1, "creation_date": 1576093251, "post_id": 59292304, "comment_id": 104790513, "body": "@BerkErzin You could either have a flag in the struct saying whether the memory is available or in use, or you could maintain one list for available memory and one list for used memory.  In either case, you&#39;d need some way to consolidate free blocks to reduce fragmentation."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1576093827, "post_id": 59292304, "comment_id": 104790795, "body": "If you want best fit (not great for fragmentation over time BTW), instead of finding the first free block that could possibly fit your memory, you search until you find an exact fit or until you hit the end of the free list and have the closest sized block that fulfills your needs."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1576094199, "post_id": 59292304, "comment_id": 104790972, "body": "worst fit is same as best-fit accept that you always grab the biggest chunk available I would guess."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 3, "last_activity_date": 1576093141, "last_edit_date": 1576093141, "creation_date": 1576090550, "answer_id": 59292304, "question_id": 59291857, "link": "https://stackoverflow.com/questions/59291857/user-implemented-memory-management/59292304#59292304", "title": "User-implemented memory management", "body": "<p>Here's a rough idea of what you would need to do:</p>\n\n<p>The memory segment should be structured as a linked list of blocks.  Each block starts with a copy of your management structure followed by the memory that you allocate.</p>\n\n<p>On initialization, point the head of the linked list to the start of the given memory segment.  Set the size to the size of the segment minus the size of the management structure, and set the next pointer to NULL.</p>\n\n<p>When the first allocation request is made, set the size of the head block to the requested size, then set the next pointer to the memory immediately after that.  Set the size of the new block to the old head size minus the requested size and the size of the management struct.</p>\n\n<p>For a deallocation, you would need to find the block prior to the one you're about to release.  Change the size of the prior block to the size of the freed block plus the struct size, then change the next pointer to the freed block's next pointer.</p>\n\n<p>That should be enough to get you started.</p>\n"}], "owner": {"reputation": 21, "user_id": 9718251, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Berk Erzin", "link": "https://stackoverflow.com/users/9718251/berk-erzin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "closed_date": 1576097370, "answer_count": 1, "score": 0, "last_activity_date": 1576094461, "creation_date": 1576088410, "last_edit_date": 1576094461, "question_id": 59291857, "link": "https://stackoverflow.com/questions/59291857/user-implemented-memory-management", "closed_reason": "Needs more focus", "title": "User-implemented memory management", "body": "<p>I am given a C project assignment in which I am asked to implement a simple memory management library. The way it works is that it has init function which takes a pointer(void*) to a chunk of memory allocated by another c program along with the size of the chunk and has two other functions to allocate a block of requested size from the said chunk and deallocate a block when passed back the pointer pointing to it.</p>\n\n<p>Problem is that I am asked to keep my management structures inside the chunk itself and I have zero idea on how to do that. I thought about dividing the chunk into frames but how can I keep track of which frames are allocated without using anything from outside the chunk?</p>\n\n<p>Edit: Init function is used like this. There is this program which will call the library I am going to write. It will allocate a chunk of memory using either malloc or calloc. Then it will call the init function from the library and pass the pointer to that memory chunk along with the size of the chunk to it.</p>\n\n<p>What my library will do with that chunk is to allocate blocks from it on demand. So my library's allocate function actually is a call to request a block of memory(size is passed as an argument) from the chunk. And it will return a (void *) pointer pointing to the allocated memory block.</p>\n\n<p>Edit2: To make the situation more clear, my library has to be able to allocate and deallocate which means holes will appear in the chunk it is managing and it will employ either first-fit, best-fit or worst-fit. </p>\n\n<p>Edit3: Is there a way to convert memory addresses into long int?</p>\n"}, {"tags": ["c", "pointers", "memory", "stack"], "comments": [{"owner": {"reputation": 4915, "user_id": 10686048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bffd06d00a80b9b69e83f561ee5a392?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisMM", "link": "https://stackoverflow.com/users/10686048/chrismm"}, "edited": false, "score": 4, "creation_date": 1576086476, "post_id": 59291361, "comment_id": 104787556, "body": "What you are doing is <i>undefined</i>, since you are going outside the bounds of the array..."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 2, "creation_date": 1576086500, "post_id": 59291361, "comment_id": 104787570, "body": "You left no space for the null terminator also."}, {"owner": {"reputation": 1990, "user_id": 12326421, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JbJl27mnzzQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reae_Gn8hEX-jZUqSenBmr_v-zCaw/photo.jpg?sz=128", "display_name": "Himanshu Singh", "link": "https://stackoverflow.com/users/12326421/himanshu-singh"}, "edited": false, "score": 0, "creation_date": 1576086505, "post_id": 59291361, "comment_id": 104787572, "body": "how did it even compile?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1576087077, "post_id": 59291361, "comment_id": 104787855, "body": "Why are you using C-style arrays rather than <code>std::array</code> or <code>std::vector</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6621120"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1576087328, "post_id": 59291361, "comment_id": 104787960, "body": "@JesperJuhl - it&#39;s C-language, not c++. Just string value is c++."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6621120"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1576087399, "post_id": 59291361, "comment_id": 104787991, "body": "@drescherjm - I did that on purpose, I was experimenting with pointers."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 2, "creation_date": 1576087538, "post_id": 59291361, "comment_id": 104788054, "body": "Once you hit Undefined Behavior the result of the program is meaningless."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1576087555, "post_id": 59291361, "comment_id": 104788063, "body": "@Mirror That&#39;s very much <i>not</i> obvious. As soon as you use <i>any</i> C++ feature, your code becomes C++ and can no longer be compiled as C. And once your code is C++ <i>anyway</i> you might as well take advantage and not stick with C stuff.. C and C++ are not variations of the same language; they are <i>very much</i> different languages and you need to decide which one you are using."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6621120"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1576087809, "post_id": 59291361, "comment_id": 104788180, "body": "@JesperJuhl - read the code again, I haven&#39;t used a single c++ feature. It&#39;s pure C."}, {"owner": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "edited": false, "score": 3, "creation_date": 1576087872, "post_id": 59291361, "comment_id": 104788207, "body": "So don&#39;t tag your question with the C++ language tag..."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1576088083, "post_id": 59291361, "comment_id": 104788295, "body": "@Mirror &quot;read the code again, I haven&#39;t used a single c++ feature&quot;. Then why did you A) tag the question as C++? B) Comment &quot;it&#39;s C-language, not c++. Just string value is c++.&quot;, which implies that it <i>is</i> C++."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6621120"}, "edited": false, "score": 0, "creation_date": 1576087640, "post_id": 59291427, "comment_id": 104788100, "body": "I know about null byte, and array declarations. Here I was just experimenting with pointers. I was surprised only because I got &#39;r&#39;, which happens as &#39;q&#39; got incremented. If it would have resulted in compilation error or dirty result, I wouldn&#39;t have cared this much."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1576087845, "post_id": 59291427, "comment_id": 104788196, "body": "@Mirror UB can result in literally <i>anything</i>. The program is broken because you broke the rules of the language and <i>any</i> result is valid as far as the compiler is concerned."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1576088053, "post_id": 59291427, "comment_id": 104788282, "body": "@Mirror Most likely, <code>*pointer += &#39;q&#39;</code> changed the pointer because the pointer was pointing to itself, <code>pointer += 1</code> incremented q to r, then <code>*pointer = &#39;d&#39;;</code> set some random memory location to <code>d</code>, and you were lucky enough that this all worked in a relatively understandable way and didn&#39;t just crash or fly off into orbit."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1576088054, "post_id": 59291427, "comment_id": 104788283, "body": "@Mirror The fact that you got &quot;r&quot; at the end of the string <i>is</i> a dirty result.  It&#39;s how UB manifested itself in this particular case."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1576086547, "creation_date": 1576086547, "answer_id": 59291427, "question_id": 59291361, "link": "https://stackoverflow.com/questions/59291361/what-will-happen-if-pointer-is-incremented-after-assigning-value-to-its-memory-l/59291427#59291427", "title": "What will happen if pointer is incremented after assigning value to its memory location?", "body": "<p><code>charArr</code> is only big enough to hold the three characters it is initialized with.  The array can't hold any other characters, and it even doesn't have space for a terminating null byte to make it a proper string.</p>\n\n<p>That means that you're writing past the end of the array.  Doing so invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>, which in this case manifests as unexpected output.</p>\n\n<p>The array should be at least 6 bytes in length so it can hold the additional characters plus a terminating null byte to make it a string.  You also need to add that null byte.</p>\n\n<pre><code>char charArr[6] = \"c++\";\nchar *pointer = charArr;\npointer+=3;\n*pointer = 'q';\npointer+=1;\n*pointer = 'd';\npointer+=1;\n*pointer = 0;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10, "user_id": 12222482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb9f4a727f0d6fc20c986b90447b8160?s=128&d=identicon&r=PG&f=1", "display_name": "Zain Ahmad ", "link": "https://stackoverflow.com/users/12222482/zain-ahmad"}, "is_accepted": false, "score": 0, "last_activity_date": 1576086818, "creation_date": 1576086818, "answer_id": 59291499, "question_id": 59291361, "link": "https://stackoverflow.com/questions/59291361/what-will-happen-if-pointer-is-incremented-after-assigning-value-to-its-memory-l/59291499#59291499", "title": "What will happen if pointer is incremented after assigning value to its memory location?", "body": "<p>Pointers are just to point out the location, you are entering the data in less space, so simply increase the length of char array first and then process, however your pointers working well.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6621120"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1576087930, "creation_date": 1576086312, "last_edit_date": 1576087930, "question_id": 59291361, "link": "https://stackoverflow.com/questions/59291361/what-will-happen-if-pointer-is-incremented-after-assigning-value-to-its-memory-l", "title": "What will happen if pointer is incremented after assigning value to its memory location?", "body": "<p>Consider the following example,</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    char charArr[3] = \"c++\";\n    char *pointer = charArr;\n    pointer+=3;\n    *pointer = 'q';\n    pointer+=1;\n    *pointer = 'd';\n    printf(\"%s\", charArr);\n    return 0;\n}\n</code></pre>\n\n<p>I hoped that I would get,\n<strong>c++qd</strong>\nbut I got <strong>c++r</strong></p>\n\n<p>The value of q gets incremented by 1 and turns to 'r', I tried with other increments and it reflects as per ASCII.</p>\n"}, {"tags": ["c", "linker", "function-pointers"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1576084176, "post_id": 59290662, "comment_id": 104786460, "body": "I do not see any conflicts."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1576084598, "post_id": 59290662, "comment_id": 104786650, "body": "Are you sure it&#39;s because of that instruction, and not something else? Do you have a statement like <code>Key[48].fn_ptr = &amp;NullFunct_1;</code>? Because that would overwrite Units."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1576084677, "post_id": 59290662, "comment_id": 104786684, "body": "I would have added an extra pair of curly brackets around the initializer of <code>Key</code> to make it clear that you are only initializing the first element of the array of <code>struct tp_key</code> explicitly (with default initialization for the remaining elements)."}, {"owner": {"reputation": 15, "user_id": 1607715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acbccb861e0c8e3255ec72c402150941?s=128&d=identicon&r=PG", "display_name": "Makkun", "link": "https://stackoverflow.com/users/1607715/makkun"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1576085650, "post_id": 59290662, "comment_id": 104787174, "body": "@user253751, thank you for the suggestion, The cause is what you suggested"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1576085750, "post_id": 59290662, "comment_id": 104787230, "body": "@Makkun maybe you can post your solution as an answer so that people who find this question know it&#39;s not a compiler bug :)"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 1607715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acbccb861e0c8e3255ec72c402150941?s=128&d=identicon&r=PG", "display_name": "Makkun", "link": "https://stackoverflow.com/users/1607715/makkun"}, "edited": false, "score": 0, "creation_date": 1576084647, "post_id": 59290890, "comment_id": 104786671, "body": "Thank you @P__J__, then why the variable Units is compromised?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 15, "user_id": 1607715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acbccb861e0c8e3255ec72c402150941?s=128&d=identicon&r=PG", "display_name": "Makkun", "link": "https://stackoverflow.com/users/1607715/makkun"}, "edited": false, "score": 0, "creation_date": 1576084753, "post_id": 59290890, "comment_id": 104786725, "body": "@Makkun what? It is where it should be. I"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1576085720, "post_id": 59290890, "comment_id": 104787218, "body": "I found a compiler bug that overwrote memory <i>once</i>. So it&#39;s possible. But it&#39;s not very likely. Most compiler bugs just seem to crash the compiler."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1576084695, "last_edit_date": 1576084695, "creation_date": 1576084522, "answer_id": 59290890, "question_id": 59290662, "link": "https://stackoverflow.com/questions/59290662/memory-conflict-in-embedded-system/59290890#59290890", "title": "Memory conflict in embedded system", "body": "<p>There are no \"conflicts\" here.</p>\n\n<p>sizeof(struct tp_key) [24] * 48 in hex is 0x480. So everything is 100% fine.</p>\n\n<p>My advice: do not focus on chasing \"compiler errors\". Assume that the compilers were tested and are used by millions of programmers. </p>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 1607715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acbccb861e0c8e3255ec72c402150941?s=128&d=identicon&r=PG", "display_name": "Makkun", "link": "https://stackoverflow.com/users/1607715/makkun"}, "is_accepted": false, "score": 0, "last_activity_date": 1576086939, "creation_date": 1576086939, "answer_id": 59291526, "question_id": 59290662, "link": "https://stackoverflow.com/questions/59290662/memory-conflict-in-embedded-system/59291526#59291526", "title": "Memory conflict in embedded system", "body": "<p><code>Key</code> has 48 elements but in my source code I assigned variable Key[48] and it is, of course, incorrect.\nThe cause of the error in the code is </p>\n\n<pre><code>for ( i=0; i &lt;= 48; i++) \n{ \n     Key[i].fn_ptr = &amp;NullFunct_1; \n}\n</code></pre>\n\n<p>To fix the problem I changed the for loop as follow </p>\n\n<pre><code>for ( i=0; i &lt; 48; i++) \n{ \n     Key[i].fn_ptr = &amp;NullFunct_1; \n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 1607715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acbccb861e0c8e3255ec72c402150941?s=128&d=identicon&r=PG", "display_name": "Makkun", "link": "https://stackoverflow.com/users/1607715/makkun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1576086939, "creation_date": 1576083564, "last_edit_date": 1576084098, "question_id": 59290662, "link": "https://stackoverflow.com/questions/59290662/memory-conflict-in-embedded-system", "title": "Memory conflict in embedded system", "body": "<p>I am building an application with Diab compiler for PowerPC. I am having an issue with memory conflict.</p>\n\n<p>In <code>header1.h</code> I have declared</p>\n\n<pre><code>...\nvoid NullFunct_1 (int);\n...\n</code></pre>\n\n<p>The function <code>NullFunct_1</code> is then defined in <code>main.c</code></p>\n\n<pre><code>    #include \"header1.h\"\n...\n           void NullFunct_1 (int f)\n           {\n              return;\n           }\n</code></pre>\n\n<p>In <code>header2.h</code> I have declared</p>\n\n<pre><code>    struct tp_key \n    {\n        int a;                    \n        void (*fn_ptr)(int);     // function pointer    \n        unsigned int b;             \n        unsigned int c;                \n        int d;                  \n        int e;                 \n    };\n</code></pre>\n\n<p>In <code>header2.c</code> I initialize the array <code>Key</code> as follow</p>\n\n<pre><code>struct tp_key Key[48] = {0, &amp;NullFunct_1, 0, 0, 0, 0};\n</code></pre>\n\n<p>In <code>header3.h</code> I declare the global variable <code>Units</code></p>\n\n<pre><code>extern int Units;\n</code></pre>\n\n<p>In <code>header3.c</code> I define and initialize the variable <code>Units</code></p>\n\n<pre><code>int Units = 0; //Units variable can then assume the values of 0, 1000 or 10000 only.\n</code></pre>\n\n<p>The program is compiled and linked without errors generating the executable.</p>\n\n<p>The Link Editor Memory Map generated is the following</p>\n\n<pre><code>    input           virtual                        \n    section         address     size     file\n...\n    .data           50036adc    00000484 header2.o\n           Key      50036adc    00000480\n           Xxxx     50036f5c    00000004\n\n    .data           50036f60    00000170 header3.o\n           Units    50036f60    00000004\n...\n...\n        NullFunct_1 500038b8    0000000c main.o\n...\n</code></pre>\n\n<p>You may notice the variables <code>Key</code> and <code>Units</code> are memory \"neighbors\" <code>0x50036adc + 0x480 = 0x50036f5c</code>.</p>\n\n<p>In some cases the variable <code>Units</code> contains value <code>1342191800</code> <code>(0x500038B8 in hex)</code> that corresponds to the memory address of the variable <code>Null_Funct_1</code></p>\n\n<p>This happens because of the instruction</p>\n\n<pre><code>struct tp_key Key[48] = {0, &amp;NullFunct_1, 0, 0, 0, 0};\n</code></pre>\n\n<p>Is this a linker problem that did not calculate the memory size of the variable Key correctly? or did I make a mistake?\nEven if there is a linker problem then may you suggest how to avoid such kind of problems, please?</p>\n"}, {"tags": ["c", "loops", "fgets"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1576083794, "post_id": 59290646, "comment_id": 104786256, "body": "Your <code>validateInput</code> will consider ^D as &quot;malformd input&quot; as it stands. Also you can&#39;t input anything after you passed EOF. So what is the surprise? You should <i>terminate</i> the program once EOF is detected, not retry."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1576084048, "post_id": 59290646, "comment_id": 104786386, "body": "Control-D is used by Unix shells/terminals/systems to send any currently typed input to the program immediately, instead of holding it for Enter or another event. When you type text and control-D, the program receives the text. When you type control-D at the start of the line, the terminal immediately sends the input typed so far (none) to the program. So the program receives zero characters, which it interprets as end-of-file. Control-V is commonly used as a quoting mechanism, so typing control-V then control-D may send a literal control-D to the program, rather than sending pending input."}, {"owner": {"reputation": 281, "user_id": 5525128, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-err0Rv9lxmk/AAAAAAAAAAI/AAAAAAAAABU/9Jm4Ot_2MAU/photo.jpg?sz=128", "display_name": "adam", "link": "https://stackoverflow.com/users/5525128/adam"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1576084565, "post_id": 59290646, "comment_id": 104786631, "body": "@EricPostpischil So when CTRL+D is used, it not only sends any typed input immediately (in this case nothing) but also for any future inputs until the program exits?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1576085773, "post_id": 59290646, "comment_id": 104787243, "body": "If you really need to, you can call <code>clearerr(stdin)</code> to clear the end-of-file condition."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1576092369, "post_id": 59290646, "comment_id": 104790146, "body": "@adam: No, control-D just sends the current input immediately."}], "owner": {"reputation": 281, "user_id": 5525128, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-err0Rv9lxmk/AAAAAAAAAAI/AAAAAAAAABU/9Jm4Ot_2MAU/photo.jpg?sz=128", "display_name": "adam", "link": "https://stackoverflow.com/users/5525128/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576083509, "creation_date": 1576083509, "question_id": 59290646, "link": "https://stackoverflow.com/questions/59290646/handling-input-of-ctrld-with-fgets-in-c", "title": "Handling input of CTRL+D with fgets() in C", "body": "<p>I am taking standard input from the user with a do-while loop and have included basic error handling:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nint validateInput(char *buffer, int bufferSize)\n{\n    if (fgets(buffer, bufferSize, stdin) == NULL) /* If fgets() errors */\n    {   \n        fprintf(stderr, \"ERROR: Malformed input\\n\");\n        return 1;\n    }\n\n    return 0;\n}\n\nint main()\n{\n    char buffer[1024];\n\n    do\n    {\n        printf(\"\\nInput stuff: \");\n    } while (validateInput(buffer, sizeof(buffer)) == 1);\n\n    return 0;\n}\n</code></pre>\n\n<p>The code runs fine, and there's a second <code>if</code> statement (not shown but hence the second argument to the function) after the first checking for buffer overflow which works perfectly fine too.</p>\n\n<p>The issue is if I input <code>CTRL+D</code> on it's own (<code>&lt;some input&gt; then CTRL+D</code> works fine), the code will output the <code>printf</code> and <code>fprintf</code> indefinitely, not allowing any further user input.</p>\n\n<p>I suspect it's a quirk with not correctly flushing the input stream or something, but so far my solutions haven't worked.</p>\n"}, {"tags": ["c", "algorithm", "binary", "logic", "logical-operators"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1576083107, "post_id": 59290455, "comment_id": 104785941, "body": "What is your criteria for identifying a repeating pattern?"}, {"owner": {"reputation": 31, "user_id": 9052389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lfRq1.jpg?s=128&g=1", "display_name": "Forrest Baer", "link": "https://stackoverflow.com/users/9052389/forrest-baer"}, "reply_to_user": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1576083925, "post_id": 59290455, "comment_id": 104786330, "body": "Since these are created via logical operations, I would say the criteria is that the pattern is detected at least twice, initial and second repeat would confirm that the first pattern could provide the start/end indexes from which I could get length and initial offset. (offset because an unknown number of initial bits would not likely be a part of the repeated pattern).  The lines above mark where a pattern starts/ends."}, {"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1576084149, "post_id": 59290455, "comment_id": 104786444, "body": "So &quot;1001&quot; would be a repeating pattern in &quot;111100110011001111111&quot; ?  In fact, any string <i>x</i> would be considered a repeating pattern if <i>xxx</i> appears?"}, {"owner": {"reputation": 349, "user_id": 5076774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b534aeeef0c7bdf167bf9cb64a34e3fd?s=128&d=identicon&r=PG&f=1", "display_name": "scg", "link": "https://stackoverflow.com/users/5076774/scg"}, "edited": false, "score": 0, "creation_date": 1576084454, "post_id": 59290455, "comment_id": 104786583, "body": "Unless I&#39;m making a mistake (which is possible), it seems like for any combination of M and N bits, either M*N or the first positive integer that can be evenly divided by both M and N should give you a number of bits that&#39;s guaranteed to fit the repetition evenly, e.g. 210 bits for &#39;7 XOR (5 OR 6)&#39;. (The actual repetition may of course be shorter than that.) I don&#39;t know exactly what the goals and constraints are, but maybe that could be leveraged in some way."}, {"owner": {"reputation": 31, "user_id": 9052389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lfRq1.jpg?s=128&g=1", "display_name": "Forrest Baer", "link": "https://stackoverflow.com/users/9052389/forrest-baer"}, "edited": false, "score": 0, "creation_date": 1576084544, "post_id": 59290455, "comment_id": 104786615, "body": "Good point, thanks for your brain cycles! Additional parameters would be that that pattern would need to repeat until the end of the array but allow for part of the pattern to be truncated near the end of the array.. I&#39;m wondering if maybe just trying to pre-compute all variations of logic/divisions might be a better approach. But there are a ton of variations. .. I&#39;ve added a little more context to the message above."}, {"owner": {"reputation": 31, "user_id": 9052389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lfRq1.jpg?s=128&g=1", "display_name": "Forrest Baer", "link": "https://stackoverflow.com/users/9052389/forrest-baer"}, "reply_to_user": {"reputation": 349, "user_id": 5076774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b534aeeef0c7bdf167bf9cb64a34e3fd?s=128&d=identicon&r=PG&f=1", "display_name": "scg", "link": "https://stackoverflow.com/users/5076774/scg"}, "edited": false, "score": 0, "creation_date": 1576084885, "post_id": 59290455, "comment_id": 104786794, "body": "Oh wow @scg, I&#39;m going to test this out you may be right! If thats the case, that leaves the question, how to determine the initial offset so everything lines up."}, {"owner": {"reputation": 31, "user_id": 9052389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lfRq1.jpg?s=128&g=1", "display_name": "Forrest Baer", "link": "https://stackoverflow.com/users/9052389/forrest-baer"}, "edited": false, "score": 0, "creation_date": 1576085172, "post_id": 59290455, "comment_id": 104786929, "body": "Yikes, I think I may need to re-think the depth of nesting I&#39;m allowing, creating patterns that don&#39;t repeat for 200+ or 2000+ bits seems not terribly musical anyway.."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 1, "creation_date": 1576085415, "post_id": 59290455, "comment_id": 104787045, "body": "I think you need to start from the longest possible repeating pattern and check from there on down to the shortest, otherwise you may mistake a short repetition for the pattern while the actual pattern is longer (e.g., 1010110010101100 has two repetions of 10 but the pattern is 10101100). So first check if the second half is equal to the first. If it is, recursively continue halving to find the minimal length. If not, the pattern is either offset or truncated..."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1576086818, "post_id": 59290455, "comment_id": 104787736, "body": "The repeating pattern should be no longer than the least common multiple of M and N, but it could be shorter than that, depending on the logical operation (e.g. repeating 01 OR repeating 0001 will produce repeating 01, but repeating 01 AND repeating 0001 will produce repeating 0001)."}], "answers": [{"tags": [], "owner": {"reputation": 20860, "user_id": 2034787, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/78471a5b1bfa8b48d2056ff99a875f50?s=128&d=identicon&r=PG", "display_name": "\u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df", "link": "https://stackoverflow.com/users/2034787/%d7%92%d7%9c%d7%a2%d7%93-%d7%91%d7%a8%d7%a7%d7%9f"}, "is_accepted": false, "score": 0, "last_activity_date": 1576159415, "creation_date": 1576159415, "answer_id": 59306345, "question_id": 59290455, "link": "https://stackoverflow.com/questions/59290455/how-to-determine-repeating-pattern-of-bits-in-a-single-array/59306345#59306345", "title": "How to determine repeating pattern of bits in a single array", "body": "<p>Ian Abbott commented that the \"repeating pattern should be no longer than the least common multiple of M and N\" (M and N being the two <a href=\"https://en.wikipedia.org/wiki/Metre_(music)\" rel=\"nofollow noreferrer\">metres</a>, I assume, although you've shown examples combining more than two). In fact, the naive combination of more than one metre is <em>exactly</em> a repeating pattern of length equal to their <a href=\"https://en.wikipedia.org/wiki/Least_common_multiple\" rel=\"nofollow noreferrer\">least common multiple</a>.</p>\n\n<p>But it looks like you are making additional, arbitrary choices, indicated by the lines in the examples, about where you'd like the \"downbeat.\" On the face of it, without more clarification, we would be hard pressed to tell a computer what these criteria are. What are you thinking about (or better yet, <em>hearing</em>) that advises you to place the downbeats where you did, rather than at the start in the examples? Or is the issue that we don't have access to the original metres that were combined?</p>\n\n<pre><code>3/4 x . x|x . x|x . x|x . x\n4/4 x . x x|x . x x|x . x x\n(lcm = 12)\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9052389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lfRq1.jpg?s=128&g=1", "display_name": "Forrest Baer", "link": "https://stackoverflow.com/users/9052389/forrest-baer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1576159415, "creation_date": 1576082755, "last_edit_date": 1576084644, "question_id": 59290455, "link": "https://stackoverflow.com/questions/59290455/how-to-determine-repeating-pattern-of-bits-in-a-single-array", "title": "How to determine repeating pattern of bits in a single array", "body": "<p>So here is the problem, I'm building arrays of 128 bits, in C, to represent beat divisions, those divisions can be logically AND/OR/XOR'd against one another, so you can have results like below.  The problem I'm having is, how to determine when a pattern repeats, and what the start/end index of the first repeated section are, so that I can loop over just that section to prevent strange things happening when I reach the max (currently 128).  </p>\n\n<p>It seems like i'm going to need to increase the size to 256 or larger to account for situations where the more complex nested logic creates patterns that don't repeat for a while..  Looking for advice on how to detect the pattern algorithmic-ally within an array of bits.</p>\n\n<pre><code>2:              01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101\n3:              00100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100\n3 OR  2:        01110101110101110101110101110101110101110101110101110101110101110101110101110101110101110101110101110101110101110101110101110101\n3 AND 2:        00000100000100000100000100000100000100000100000100000100000100000100000100000100000100000100000100000100000100000100000100000100\n3 XOR 2:        01110001110001110001110001110001110001110001110001110001110001110001110001110001110001110001110001110001110001110001110001110001\n                   ||    ||    ||    ||    || ...\n5:              00001000010000100001000010000100001000010000100001000010000100001000010000100001000010000100001000010000100001000010000100001000\n5 OR (3 XOR 2): 01111001110001110001110011110101111001110001110001110011110101111001110001110001110011110101111001110001110001110011110101111001\n                    ||                            ||                            ||                            ||                            ||\n5 OR (3 OR 2):  01111101110101110101110111110101111101110101110101110111110101111101110101110101110111110101111101110101110101110111110101111101\n                     ||                            ||                            ||                            ||\n5:              00001000010000100001000010000100001000010000100001000010000100001000010000100001000010000100001000010000100001000010000100001000\n6:              00000100000100000100000100000100000100000100000100000100000100000100000100000100000100000100000100000100000100000100000100000100\n5 OR 6:         00001100010100100101000110000100001100010100100101000110000100001100010100100101000110000100001100010100100101000110000100001100\n                    ||                            ||                            ||                            ||                            ||\n7:              00000010000001000000100000010000001000000100000010000001000000100000010000001000000100000010000001000000100000010000001000000100\n7 XOR (5 OR 6): 00001110010101100101100110010100000100010000100111000111000100101100000100101101000110000110001101010100000101010110001100001000\n                shoot, 7 XOR (5 OR 6) doesn't repeat within 128 bits..\n8:              00000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001\n16:             00000000000000010000000000000001000000000000000100000000000000010000000000000001000000000000000100000000000000010000000000000001\n</code></pre>\n\n<p>to provide a little more context, this is for a logical clock divider that i've written for a musical module (<a href=\"https://llllllll.co/t/chrono-sage-meadowphysics-logical-clock-divider-v1-2-5/27182\" rel=\"nofollow noreferrer\">https://llllllll.co/t/chrono-sage-meadowphysics-logical-clock-divider-v1-2-5/27182</a>) and the issue I'm trying to solve is the ability to have these logical/nested logic combinations of beat divisions line up so there is no stutter when a pattern wraps around.</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 3, "creation_date": 1576082721, "post_id": 59290442, "comment_id": 104785732, "body": "<code>scanf (&quot;%d&quot;,&amp;date[11]);</code> -&gt; <code>scanf (&quot;%d&quot;, date);</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1576082828, "post_id": 59290442, "comment_id": 104785792, "body": "And instead of <code>days[0] = *(my_pointer)</code> etc. you can write simply <code>days[0] = date[0]</code> ; <code>days[1] = date[1]</code>, <code>days[2] = date[2]</code> etc."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1576082868, "post_id": 59290442, "comment_id": 104785809, "body": "I&#39;m assuming you really want something like <code>scanf(&quot;%10s&quot;, date)</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1576082871, "post_id": 59290442, "comment_id": 104785812, "body": "<i>&quot; but it kept raising error&quot;</i>: who raises which error when you do what?"}, {"owner": {"reputation": 9, "user_id": 5355481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27536fed708eff2587037f49e3f4681a?s=128&d=identicon&r=PG&f=1", "display_name": "drvenom", "link": "https://stackoverflow.com/users/5355481/drvenom"}, "edited": false, "score": 0, "creation_date": 1576083067, "post_id": 59290442, "comment_id": 104785920, "body": "The compiler kept raising the error: array size missing in &#39;date&#39;"}, {"owner": {"reputation": 728, "user_id": 1451345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d2e42c1a92c5068a94f7f2932c2b05?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/1451345/steve"}, "edited": false, "score": 0, "creation_date": 1576083321, "post_id": 59290442, "comment_id": 104786036, "body": "Your array is 11 characters long, and the indexes run from 0 to 10.  date[11] is one character beyond the end of the array."}], "answers": [{"tags": [], "owner": {"reputation": 1990, "user_id": 12326421, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JbJl27mnzzQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reae_Gn8hEX-jZUqSenBmr_v-zCaw/photo.jpg?sz=128", "display_name": "Himanshu Singh", "link": "https://stackoverflow.com/users/12326421/himanshu-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1576083243, "creation_date": 1576083243, "answer_id": 59290570, "question_id": 59290442, "link": "https://stackoverflow.com/questions/59290442/how-to-use-scanf-function-for-an-array/59290570#59290570", "title": "How to use scanf function for an array", "body": "<p>Your scanf should have been like this <code>scanf (\"%s\",date);</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    char date [11];\n\n    char days []=\"DD\";\n    char month[]=\"MM\";\n    char year []=\"YYYY\";\n\n    printf(\"Enter the year that you want \\n\");\n    scanf (\"%s\",date);\n\n\n    char *my_pointer = date;\n    days[0] = *(my_pointer);\n    days[1] = *(my_pointer+1);\n\n\n    month[0]=*(my_pointer+2);\n    month[1]=*(my_pointer+3);\n\n    year [0]=*(my_pointer+4);\n    year [1]=*(my_pointer+5);\n    year [2]=*(my_pointer+6);\n    year [3]=*(my_pointer+7);\n\nprintf(\"Today the day is %s,the month is %s and the year is %s\",days,month,year);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 0, "last_activity_date": 1576084638, "creation_date": 1576084638, "answer_id": 59290933, "question_id": 59290442, "link": "https://stackoverflow.com/questions/59290442/how-to-use-scanf-function-for-an-array/59290933#59290933", "title": "How to use scanf function for an array", "body": "<p>You probably want this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n  char date[11];\n\n  char days[] = \"DD\";\n  char month[] = \"MM\";\n  char year[] = \"YYYY\";\n\n  printf(\"Enter the year that you want \\n\");\n  scanf(\"%10s\", date);  // limit input to 10 chars to prevent buffer overflow\n\n  days[0] = date[0];\n  days[1] = date[1];\n\n  month[0] = date[2];\n  month[1] = date[3];\n\n  year[0] = date[4];\n  year[1] = date[5];\n  year[2] = date[6];\n  year[3] = date[7];\n\n  printf(\"Today the day is %s, the month is %s and the year is %s\", days, month, year);\n  return 0;\n}\n</code></pre>\n\n<p>or even simpler:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n  char date[11];\n\n  char days[] = \"DD\";\n  char month[] = \"MM\";\n  char year[] = \"YYYY\";\n\n  printf(\"Enter the year that you want \\n\");\n  scanf(\"%10s\", date);\n\n  memcpy(days,  date + 0, 2);\n  memcpy(month, date + 2, 2);\n  memcpy(year,  date + 4, 4);\n\n  printf(\"Today the day is %s, the month is %s and the year is %s\", days, month, year);\n  return 0;\n}\n</code></pre>\n\n<p>Example:</p>\n\n<blockquote>\n  <p>Enter the year that you want<br>\n  01022019<br>\n  Today the day is 01, the month is 02 and the year is 2019<br></p>\n</blockquote>\n\n<p>But be aware that this is very incovenient, because you don't check at all if the input is plausible, try to enter <code>abcdefg</code> instead of <code>01022019</code> and see what happens.</p>\n"}], "owner": {"reputation": 9, "user_id": 5355481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27536fed708eff2587037f49e3f4681a?s=128&d=identicon&r=PG&f=1", "display_name": "drvenom", "link": "https://stackoverflow.com/users/5355481/drvenom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1576084638, "creation_date": 1576082692, "question_id": 59290442, "link": "https://stackoverflow.com/questions/59290442/how-to-use-scanf-function-for-an-array", "title": "How to use scanf function for an array", "body": "<p>I want to find the date,month and year through a given set of numbers using the array and pointers.I am writing the program to learn C.</p>\n\n<p>Below is the output:</p>\n\n<p>Enter the number : 22102013\nToday is the day is 22,month is 10 and the year is 2013.</p>\n\n<p>And i have wrote the following code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    char date [11];\n\n    char days []=\"DD\";\n    char month[]=\"MM\";\n    char year []=\"YYYY\";\n\n    printf(\"Enter the year that you want \\n\");\n    scanf (\"%d\",&amp;date[11]);\n\n\n    char *my_pointer = date;\n    days[0] = *(my_pointer);\n    days[1] = *(my_pointer+1);\n\n\n    month[0]=*(my_pointer+2);\n    month[1]=*(my_pointer+3);\n\n    year [0]=*(my_pointer+4);\n    year [1]=*(my_pointer+5);\n    year [2]=*(my_pointer+6);\n    year [3]=*(my_pointer+7);\n\nprintf(\"Today the day is %s,the month is %s and the year is %s\",days,month,year);\n    return 0;\n}\n</code></pre>\n\n<p>Also i had not initialized the array size but it kept raising error for declaration of the array.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576082160, "post_id": 59290229, "comment_id": 104785411, "body": "<code>(*p)[NUM_COLS]</code> is a <i>pointer to array of <code>int</code></i>. So if you do a <code>sizeof(*p)</code> you will get <code>sizeof(int)*NUM_COLS</code>. And this is the amount of bytes the pointer will be incremented by if doing pointer addition with <code>1</code>."}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1576082202, "post_id": 59290229, "comment_id": 104785435, "body": "<a href=\"https://cdecl.org/?q=int+%28%2Ap%29%5B8%5D\" rel=\"nofollow noreferrer\">This is what the pointer means</a> (I had to substitute <code>NUM_COLS</code> for a literal <code>8</code>)"}, {"owner": {"reputation": 23, "user_id": 10618040, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uPhNX4qa0M4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBqHyynYcBbAoo3vCFr9qyX0jq3dg/mo/photo.jpg?sz=128", "display_name": "dotthor", "link": "https://stackoverflow.com/users/10618040/dotthor"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576082378, "post_id": 59290229, "comment_id": 104785535, "body": "@EugeneSh. actually sizeof(*p) gives 8 byte, like normal pointers"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576082598, "post_id": 59290229, "comment_id": 104785664, "body": "@dotthor Are you sure? <a href=\"https://ideone.com/4OdaDF\" rel=\"nofollow noreferrer\">ideone.com/4OdaDF</a> . What&#39;s your <code>NUM_COLS</code>?"}, {"owner": {"reputation": 23, "user_id": 10618040, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uPhNX4qa0M4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBqHyynYcBbAoo3vCFr9qyX0jq3dg/mo/photo.jpg?sz=128", "display_name": "dotthor", "link": "https://stackoverflow.com/users/10618040/dotthor"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576082922, "post_id": 59290229, "comment_id": 104785841, "body": "@EugeneSh. you are putting an asterisk before the pointer in the sizeof call, is that right?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1576082954, "post_id": 59290229, "comment_id": 104785862, "body": "sizeof is not the function and it is not called only evaluated compile time"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1576082961, "post_id": 59290229, "comment_id": 104785867, "body": "<a href=\"https://onlinegdb.com/Skg_6cRpS\" rel=\"nofollow noreferrer\">onlinegdb.com/Skg_6cRpS</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576082963, "post_id": 59290229, "comment_id": 104785868, "body": "Yes. It&#39;s the syntax to get the size of the type the pointer is pointing to."}, {"owner": {"reputation": 23, "user_id": 10618040, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uPhNX4qa0M4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBqHyynYcBbAoo3vCFr9qyX0jq3dg/mo/photo.jpg?sz=128", "display_name": "dotthor", "link": "https://stackoverflow.com/users/10618040/dotthor"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1576083402, "post_id": 59290229, "comment_id": 104786074, "body": "@EugeneSh. True. Eureka! So the pointer is pointing to an array of NUM_COLS size instead of an int. It&#39;s stupidly simple but I couldn&#39;t figure it out."}, {"owner": {"reputation": 23, "user_id": 10618040, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uPhNX4qa0M4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBqHyynYcBbAoo3vCFr9qyX0jq3dg/mo/photo.jpg?sz=128", "display_name": "dotthor", "link": "https://stackoverflow.com/users/10618040/dotthor"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576084372, "post_id": 59290229, "comment_id": 104786548, "body": "@EugeneSh. thanks to your comments I&#39;m almost getting it, one last question: you say that the amount of space taken by what&#39;s pointed by the pointer is the amount incremented by doing pointer addition with 1; it is the same as always happen, even with pointers to int, right?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576084631, "post_id": 59290229, "comment_id": 104786663, "body": "If <code>p</code> is defined as pointer to type <code>T</code>: <code>T *p;</code> then <code>p + 1</code> will increment <code>p</code> by <code>sizeof(T)</code> always."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10618040, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uPhNX4qa0M4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBqHyynYcBbAoo3vCFr9qyX0jq3dg/mo/photo.jpg?sz=128", "display_name": "dotthor", "link": "https://stackoverflow.com/users/10618040/dotthor"}, "edited": false, "score": 0, "creation_date": 1576083099, "post_id": 59290282, "comment_id": 104785938, "body": "You say &quot;it can be used as&quot; but if i declared a normal pointer like *p, i could&#39;ve used it to store &quot;&amp;arr&quot;, right? So what&#39;s really the difference?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 23, "user_id": 10618040, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uPhNX4qa0M4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBqHyynYcBbAoo3vCFr9qyX0jq3dg/mo/photo.jpg?sz=128", "display_name": "dotthor", "link": "https://stackoverflow.com/users/10618040/dotthor"}, "edited": false, "score": 0, "creation_date": 1576083564, "post_id": 59290282, "comment_id": 104786161, "body": "@dotthor No, the types would not match."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1576082183, "creation_date": 1576082183, "answer_id": 59290282, "question_id": 59290229, "link": "https://stackoverflow.com/questions/59290229/what-it-entails-to-declare-and-initialize-a-pointer-in-this-way-int-pn/59290282#59290282", "title": "What it entails to declare and initialize a pointer in this way: int (*p)[n]", "body": "<p>A syntax like</p>\n\n<pre><code> int (*p)[NUM_COLS];\n</code></pre>\n\n<p>essentially defines a pointer <code>p</code> which is a pointer to an array of <code>int</code>s with <code>NUM_COLS</code> element.</p>\n\n<p>So, it can be used as</p>\n\n<pre><code> int arr[NUM_COLS] = {0};\n p = &amp;arr;\n</code></pre>\n\n<p>This has the same properties like all other pointers,</p>\n\n<ul>\n<li>the type of the pointer is <code>int (*)[NUM_COLS]</code></li>\n<li>the size of the instance pointed to by this pointer is <code>int [NUM_COLS]</code>, i.e., size of an <code>int</code>, multiplied by the <code>NUM_COLS</code>.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1576082916, "creation_date": 1576082916, "answer_id": 59290495, "question_id": 59290229, "link": "https://stackoverflow.com/questions/59290229/what-it-entails-to-declare-and-initialize-a-pointer-in-this-way-int-pn/59290495#59290495", "title": "What it entails to declare and initialize a pointer in this way: int (*p)[n]", "body": "<p>As @SouravHhosh wrote it defines the pointer to the array of integers. Any pointer arithmetics is of the multiplication of size of the array.</p>\n\n<p><a href=\"https://onlinegdb.com/Skg_6cRpS\" rel=\"nofollow noreferrer\">https://onlinegdb.com/Skg_6cRpS</a></p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1576166012, "creation_date": 1576166012, "answer_id": 59308364, "question_id": 59290229, "link": "https://stackoverflow.com/questions/59290229/what-it-entails-to-declare-and-initialize-a-pointer-in-this-way-int-pn/59308364#59308364", "title": "What it entails to declare and initialize a pointer in this way: int (*p)[n]", "body": "<pre><code>T (*p)[N];\n</code></pre>\n\n<p>declares <code>p</code> as a pointer to an N-element array of <code>T</code>.  You mainly see them in the following contexts:</p>\n\n<ul>\n<li>As the result of a higher-dimensioned array expression \"decaying\" to a pointer expression;</li>\n<li>When allocating memory for a higher-dimensioned array;</li>\n</ul>\n\n<p>As an example of the former, consider the following code:</p>\n\n<pre><code>void foo( int (*p)[3] )\n{\n  // do something with p\n}\n\nint main( void )\n{\n  int arr[2][3];\n\n  foo( arr );\n}\n</code></pre>\n\n<p>Except when it is the operand of the <code>sizeof</code> or unary <code>&amp;</code> operators, or is a string literal used to initialize a character array in a declaration, an <em>expression</em> of type \"N-element array of <code>T</code>\" will be converted (\"decay\") to an expression of type \"pointer to <code>T</code>\", and the value of the expression will be the address of the first element of the array.</p>\n\n<p>When you pass the <em>expression</em> <code>arr</code> as a parameter to <code>foo</code> it is converted from type \"2-element array of 3-element array of <code>int</code>\" (<code>int [2][3]</code>) to \"pointer to 3-element array of <code>int</code>\" (<code>int (*)[3]</code>).  So the function actually receives a pointer value, not an array.  </p>\n\n<p>Because pointer to array syntax is a bit ugly and cumbersome, you can alternately use</p>\n\n<pre><code>void foo( int p[][3] ) { ... }\n</code></pre>\n\n<p>for the declaration, but <em>only</em> in a function parameter declaration. </p>\n\n<p>As an example of the latter, if you want to dynamically declare a 2D array, you can do this:</p>\n\n<pre><code>int (*p)[3] = malloc( 2 * sizeof *p );\n</code></pre>\n\n<p>which allocates space for a 2x3 array of <code>int</code> and assigns a pointer to that space to <code>p</code>.  The type of the <em>expression</em> <code>p</code> is \"pointer to 3-element array of <code>int</code>\", so it follows that the type of <code>*p</code> is \"3-element array of <code>int</code>\".  </p>\n\n<p>Remember that the array subscript operation <code>a[i]</code> is defined as <code>*(a + i)</code> - given a starting address <code>a</code>, offset <code>i</code> elements (<strong>not bytes</strong>) from that address and dereference the result<sup>1</sup>.  Therefore, it follows that</p>\n\n<pre><code>*p == *(p + 0) == p[0]\n</code></pre>\n\n<p>meaning</p>\n\n<pre><code>(*p)[i] == (*(p + 0))[i] == (p[0])[i] == p[0][i]\n</code></pre>\n\n<p>So after you've allocated the memory for <code>p</code>, you can index into it like any 2D array:</p>\n\n<pre><code>for ( size_t i = 0; i &lt; 2; i++ )\n  for ( size_t j = 0; j &lt; 3; j++ )\n    p[i][j] = some_value;\n</code></pre>\n\n<p>General rules:</p>\n\n<pre><code>T *a[N];    // a is an N-element array of pointer to T\nT (*a)[N];  // a is a pointer to an N-element array of T\nT *f();     // f is a function returning a pointer to T\nT (*f)();   // f is a pointer to a function returning T\n</code></pre>\n\n<p>Since the subscript <code>[]</code> and function call <code>()</code> operators have higher precedence than unary <code>*</code>, <code>*a[i]</code> will be parsed as <code>*(a[i])</code> and <code>*f()</code> will be parsed as <code>*(f())</code>.  If you want to treat <code>a</code> as a pointer to an array and <code>f</code> as a pointer to a function, you must explicitly group the <code>*</code> operator with the identifier using parentheses - <code>(*a)[i]</code> and <code>(*f)()</code>.  </p>\n\n<p><hr>\n<sup></p>\n\n<ol>\n<li>C was derived from an earlier language called B.  In B, arrays had an explicit pointer to the first element, and that pointer was bound to the array variable.  So, in B, the <code>*(a + i)</code> syntax made sense because <code>a</code> was always a pointer.  When Ritchie was designing C, he didn't want to keep that explicit pointer in the array, so instead he introduced the rule that array expressions \"decay\" to pointers except in specific circumstances.  \n</ol>\n\n<p></sup></p>\n"}], "owner": {"reputation": 23, "user_id": 10618040, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uPhNX4qa0M4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBqHyynYcBbAoo3vCFr9qyX0jq3dg/mo/photo.jpg?sz=128", "display_name": "dotthor", "link": "https://stackoverflow.com/users/10618040/dotthor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1576166012, "creation_date": 1576081984, "last_edit_date": 1576082216, "question_id": 59290229, "link": "https://stackoverflow.com/questions/59290229/what-it-entails-to-declare-and-initialize-a-pointer-in-this-way-int-pn", "title": "What it entails to declare and initialize a pointer in this way: int (*p)[n]", "body": "<p>I'm learning about pointers arithmetic and there's an example about processing the columns of a 2D array exploiting pointers, precisely. In order to do that, the code shows a new-to-me declaration of a pointer, here's the snippet:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int a[NUM_ROWS][NUM_COLS], (*p) [NUM_COLS], i;\n...\nfor (p = &amp;a[0]; p &lt; &amp;a[NUM_ROWS]; p++)\n    (*p)[i] = 0;\n</code></pre>\n\n<p>The behavior of this pointer (<strong>(*p) [NUM_COLS]</strong>) is odd to me, since I just learnt that incrementing a pointer acts like incrementing an array subscript allowing you to process the array which is pointed by that pointer. So this is not a regular pointer?</p>\n\n<p>The size (in byte) is the same but what is involved in that declaration given that it represent an entire row while assigned in the <em>for loop</em>?</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1576081418, "post_id": 59290065, "comment_id": 104785063, "body": "I am not completely sure what you are trying to do, but it sounds impossible."}, {"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 8, "creation_date": 1576081505, "post_id": 59290065, "comment_id": 104785113, "body": "Plain C has no reflexion or introspection capabilities. (Types &quot;don&#39;t exist&quot; at runtime.)"}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 3, "creation_date": 1576081512, "post_id": 59290065, "comment_id": 104785117, "body": "There is no reflection in C, so you can&#39;t do this at runtime as the needed information is compiled out. Doing stuff at build time is possible, but would need to look for an easy to use C/C++ parser (and pre-processor)."}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1576081689, "post_id": 59290065, "comment_id": 104785198, "body": "@LPs  Can it? I was under the impression would still need manual code to pass each field?"}, {"owner": {"reputation": 18197, "user_id": 4183191, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ce0d78cc78f51ee79cec5088effe3ed?s=128&d=identicon&r=PG", "display_name": "Tasos Papastylianou", "link": "https://stackoverflow.com/users/4183191/tasos-papastylianou"}, "edited": false, "score": 0, "creation_date": 1576081699, "post_id": 59290065, "comment_id": 104785205, "body": "it&#39;s not clear what you&#39;re trying to do. Can you give an example what the output of such a <code>universal function</code> would look like for a variety of inputs?"}, {"owner": {"reputation": 18197, "user_id": 4183191, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ce0d78cc78f51ee79cec5088effe3ed?s=128&d=identicon&r=PG", "display_name": "Tasos Papastylianou", "link": "https://stackoverflow.com/users/4183191/tasos-papastylianou"}, "edited": false, "score": 0, "creation_date": 1576081782, "post_id": 59290065, "comment_id": 104785249, "body": "Sounds horribly like an [XY Problem](xyproblem.info) ... but still worth rephrasing the question to make it clear. There&#39;s usually learning to be had in that alone."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1576081825, "post_id": 59290065, "comment_id": 104785269, "body": "@FireLancer I didn&#39;t read <i>types and names are not passed to the function</i>...so impossible"}, {"owner": {"reputation": 18197, "user_id": 4183191, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ce0d78cc78f51ee79cec5088effe3ed?s=128&d=identicon&r=PG", "display_name": "Tasos Papastylianou", "link": "https://stackoverflow.com/users/4183191/tasos-papastylianou"}, "edited": false, "score": 1, "creation_date": 1576081902, "post_id": 59290065, "comment_id": 104785301, "body": "btw, trivial point, but, there&#39;s no need for <code>_anyStruct_t</code> vs <code>anyStruct_t</code>; the <code>struct</code> namespace does not conflict with the global namespace, so you can use the same identifiers without problems. (i.e. <code>typedef struct foo {...} foo;</code>)"}, {"owner": {"reputation": 4837, "user_id": 9769953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f14a586643a20c8d68010f7a329f5a04?s=128&d=identicon&r=PG", "display_name": "0 0", "link": "https://stackoverflow.com/users/9769953/0-0"}, "edited": false, "score": 0, "creation_date": 1576083811, "post_id": 59290065, "comment_id": 104786266, "body": "From the two subquestions, I&#39;d hazard a guess you actually want/need some kind of hashmap for what you&#39;re trying to do (or completely rethink your approach). A hashmap will know it number of items, and, using appropriate keys, you can validate the ranges of various items."}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1576084627, "post_id": 59290065, "comment_id": 104786661, "body": "@airplanepillow Do you know what structs you need to do stuff with when you go to build your program?"}], "answers": [{"tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": false, "score": 0, "last_activity_date": 1576081970, "creation_date": 1576081970, "answer_id": 59290223, "question_id": 59290065, "link": "https://stackoverflow.com/questions/59290065/function-to-look-though-any-struct-in-c/59290223#59290223", "title": "Function to look though any struct in C", "body": "<blockquote>\n  <p>look through any struct and check if the item values are within certain range for given types: (E.G. item 1 should be within 10~35, item 3 should be either 0/1). Note that the struct's item types and names are not passed to the function, just the struct(any struct)</p>\n</blockquote>\n\n<p>This is not possible in C. If you only have a pointer to an unknown struct, there is no way to find out which fields the struct has.</p>\n"}, {"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1576083113, "post_id": 59290424, "comment_id": 104785944, "body": "Even reimplementing all of C++ probably isn&#39;t enough as C++ doesn&#39;t have reflection either."}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1576084546, "post_id": 59290424, "comment_id": 104786616, "body": "I don&#39;t think its as bad as &quot;re-implement a good chunk of X&quot;, if the required types are known at compile time, parsing the source code and spitting out a small piece of code is a lot less than what a full tool chain has to do, although certainly not simple for even C. e.g. code doc generators do basically what is needed."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 2, "last_activity_date": 1576083582, "last_edit_date": 1576083582, "creation_date": 1576082639, "answer_id": 59290424, "question_id": 59290065, "link": "https://stackoverflow.com/questions/59290065/function-to-look-though-any-struct-in-c/59290424#59290424", "title": "Function to look though any struct in C", "body": "<p>What you are asking for is effectively impossible in C.  </p>\n\n<p>First of all, struct types contain no metadata about their contents.  At runtime, a struct object is just a sludge of bytes.  There's no way to determine at runtime the number or types of members in a struct object.</p>\n\n<p>Secondly, if you want to do this for <em>any</em> struct type, you will have to pass its address to the function as a <code>void *</code>, meaning you have <em>no</em> way of knowing whether it's a struct type <em>at all</em>.</p>\n\n<p>You would basically have to create your own \"class\" type that a) stores metadata about its members and b) supports some form of inheritance such that you can pass a pointer to the <em>base</em> \"class\" type and use that to access the metadata and members.  </p>\n\n<p>IOW, you'd have to re-implement a good chunk of C++.  </p>\n\n<p><strong>Edit</strong></p>\n\n<p>Actually, as Andrew mentions below, even C++ doesn't support reflection.  You'd have to go even further.  </p>\n"}, {"tags": [], "owner": {"reputation": 499, "user_id": 10985965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3217875dbbfea368cc9b4d48cf8c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Atrens", "link": "https://stackoverflow.com/users/10985965/andrew-atrens"}, "is_accepted": false, "score": 1, "last_activity_date": 1576086777, "creation_date": 1576086777, "answer_id": 59291485, "question_id": 59290065, "link": "https://stackoverflow.com/questions/59290065/function-to-look-though-any-struct-in-c/59291485#59291485", "title": "Function to look though any struct in C", "body": "<p>As others have said, C doesn't support reflection and so there is no universal way to figure out what attributes exist in C data structure.</p>\n\n<p>In the past I've seen folks write a meta-compiler which from some description language can be taught to generate C data structures and accessor methods.</p>\n\n<p>Usually this is done if you're trying to write code that will iterate over and fill in data structures without needing to know all the details of the structures being processed - this can be useful in building messaging frameworks. But always feels cumbersome because some of your source code files are generated at build time (think lex and yacc).</p>\n\n<p>Of course the other application for something like this is gdb.  In that case the compiler, given '-g', generates the metadata about the data structures and embeds that in it the stabs (or gstabs, or some other) information in the object file. Your program could use /proc/self/ to find its object code on disk, open it and process through all of the stabs info.  While clever, that would be very platform specific and probably pretty brittle.</p>\n"}, {"tags": [], "owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "is_accepted": false, "score": 0, "last_activity_date": 1576098021, "creation_date": 1576098021, "answer_id": 59293997, "question_id": 59290065, "link": "https://stackoverflow.com/questions/59290065/function-to-look-though-any-struct-in-c/59293997#59293997", "title": "Function to look though any struct in C", "body": "<p>As mentioned, one needs more information about what is <strong>in</strong> the <code>struct</code>. <code>C</code>, as opposed to <code>C++</code>, <em>etc</em>, wasn't designed around this abstraction. However, it's not <em>impossible</em>; nothing is stopping one from defining one's own virtual table.</p>\n\n<pre><code>#include &lt;stdlib.h&gt; /* EXIT rand */\n#include &lt;string.h&gt; /* strcpy */\n#include &lt;stdio.h&gt;  /* sprintf, printf */\n#include &lt;assert.h&gt; /* assert */\n#include &lt;stdint.h&gt; /* (C99) uint8_t uint16_t */\n#include &lt;stdbool.h&gt; /* (C99) bool */\n\nunion AllTypes {\n    bool boolean;\n    char letter;\n    uint8_t byte;\n    uint16_t word;\n};\n\n/* `is_valid` functions. */\n\nstatic bool is_valid_boolean(const union AllTypes all) {\n    /* Not sure this will ever be false. */\n    return all.boolean == true || all.boolean == false;\n}\n\nstatic bool is_valid_letter(const union AllTypes all) {\n    return (all.letter &gt;= 'a' &amp;&amp; all.letter &lt;= 'z')\n        || (all.letter &gt;= 'A' &amp;&amp; all.letter &lt;= 'Z');\n}\n\nstatic bool is_valid_byte(const union AllTypes all) {\n    return all.byte &lt;= 35 &amp;&amp; all.byte &gt;= 10;\n}\n\nstatic bool is_valid_word(const union AllTypes all) {\n    return all.word &lt; 1000;\n}\n\n/* `to_string` functions */\n\nstatic void boolean_to_string(const union AllTypes all, char (*const a)[12]) {\n    strcpy(*a, all.boolean ? \"true\" : \"false\");\n}\n\nstatic void letter_to_string(const union AllTypes all, char (*const a)[12]) {\n    sprintf(*a, \"'%c'\", all.letter);\n}\n\nstatic void byte_to_string(const union AllTypes all, char (*const a)[12]) {\n    sprintf(*a, \"b%u\", all.byte);\n}\n\nstatic void word_to_string(const union AllTypes all, char (*const a)[12]) {\n    sprintf(*a, \"w%u\", all.word);\n}\n\ntypedef void (*ToString)(const union AllTypes all, char (*const a)[12]);\n\n/* The virtual-table. */\n\nstatic const struct VTable {\n    ToString to_string;\n    bool (*is_valid)(const union AllTypes);\n} vt_boolean = { &amp;boolean_to_string, &amp;is_valid_boolean },\n    vt_letter = { &amp;letter_to_string, &amp;is_valid_letter },\n    vt_byte = { &amp;byte_to_string, &amp;is_valid_byte },\n    vt_word = { &amp;word_to_string, &amp;is_valid_word };\n\n/* The data has an extra `vt`; this would be implicit in C++. */\n\nstruct Data {\n    const struct VTable *vt;\n    union AllTypes all;\n};\n\nstatic void to_string(const struct Data *const data, char (*const a)[12]) {\n    data-&gt;vt-&gt;to_string(data-&gt;all, a);\n}\n\nstatic bool is_valid(const struct Data *const data) {\n    return data-&gt;vt-&gt;is_valid(data-&gt;all);\n}\n\n/* Testing. */\n\nstatic void fill(struct Data *const data) {\n    assert(data);\n    switch(rand() / (RAND_MAX / 4 + 1)) {\n    case 0: data-&gt;vt = &amp;vt_boolean;\n        data-&gt;all.boolean = rand() / (RAND_MAX / 2); break;\n    case 1: data-&gt;vt = &amp;vt_letter;\n        data-&gt;all.letter = rand() / (RAND_MAX / 26 + 1) + 'a'; break;\n    case 2: data-&gt;vt = &amp;vt_byte;\n        data-&gt;all.byte = rand() / (RAND_MAX / 25 + 1) + 10; break;\n    case 3: data-&gt;vt = &amp;vt_word;\n        data-&gt;all.word = rand() / (RAND_MAX / 999 + 1); break;\n    }\n}\n\nint main(void) {\n    struct Data data[32], *d, *const d_end = data + sizeof data / sizeof *data;\n    char a[12];\n    /* Fill the data with random values. */\n    for(d = data; d &lt; d_end; d++) {\n        fill(d);\n        if(!is_valid(d)) return fprintf(stderr, \"Impossible!\\n\"), assert(0),\n            EXIT_FAILURE;\n    }\n    /* Print. */\n    fputs(\"{ \", stdout);\n    for(d = data; d &lt; d_end; d++) {\n        if(d != data) fputs(\", \", stdout);\n        to_string(d, &amp;a);\n        fputs(a, stdout);\n    }\n    fputs(\" }.\\n\", stdout);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Prints out on my machine,</p>\n\n<blockquote>\n  <p>{ false, w458, b15, true, b33, 'n', w34, true, b10, 'b', 'r', b33,\n  w526, true, 's', w761, 'b', b18, b28, w364, true, b28, b11, b32, 'l',\n  w477, false, 'e', 'x', w60, w504, b17 }.</p>\n</blockquote>\n"}], "owner": {"reputation": 37, "user_id": 12221500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ed73026b4ad66d17409d633fead4ef?s=128&d=identicon&r=PG&f=1", "display_name": "airplanepillow", "link": "https://stackoverflow.com/users/12221500/airplanepillow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1576098021, "creation_date": 1576081350, "last_edit_date": 1576081930, "question_id": 59290065, "link": "https://stackoverflow.com/questions/59290065/function-to-look-though-any-struct-in-c", "title": "Function to look though any struct in C", "body": "<p>I have a struct with variety of data types. I want to create a universal function\nthat can:</p>\n\n<ol>\n<li>look through any struct and check if the item values are within\ncertain range for given types: (E.G. item 1 should be within 10~35,\nitem 3 should be either 0/1). <strong>Note that the struct's item types and\nnames are not passed to the function, just the struct(any struct)</strong></li>\n<li>Count how many items are in the struct given any structure</li>\n</ol>\n\n<p>Example:</p>\n\n<pre><code>typedef struct _anyStruct_t\n{\n    uint8_t item1;\n    uint16_t item2;\n    bool item3;\n    char item4;\n}anyStruct_t\n</code></pre>\n"}, {"tags": ["c", "linux-kernel", "linux-device-driver", "device-driver"], "comments": [{"owner": {"reputation": 2138, "user_id": 1919896, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7da069e9930c3bdcc9b7af581c0de4eb?s=128&d=identicon&r=PG", "display_name": "Icarus3", "link": "https://stackoverflow.com/users/1919896/icarus3"}, "edited": false, "score": 0, "creation_date": 1576085124, "post_id": 59289897, "comment_id": 104786898, "body": "Check the return values of your scull_read and scull_write functions. Those function should return the number of bytes processed from the input &#39;buf&#39;. If those functions return 0 the user mode process may try to invoke it repeatedly until the &#39;count&#39; bytes are processed."}], "answers": [{"tags": [], "owner": {"reputation": 68, "user_id": 4040742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb2d4d315ec2ecd86f101f46c50eb187?s=128&d=identicon&r=PG&f=1", "display_name": "josh798", "link": "https://stackoverflow.com/users/4040742/josh798"}, "is_accepted": true, "score": 1, "last_activity_date": 1576086719, "creation_date": 1576086719, "answer_id": 59291471, "question_id": 59289897, "link": "https://stackoverflow.com/questions/59289897/the-call-back-function-scull-read-for-read-system-call-of-a-custum-character-d/59291471#59291471", "title": "The call-back function (scull_read) for read system call of a custum character device being called infinity times while reading using $cat", "body": "<p><code>cat</code> (and presumably <code>echo</code>) will call your read function in a loop and terminate once your read function returns 0, indicating that the end of the file has been reached. <a href=\"https://github.com/coreutils/coreutils/blob/master/src/cat.c#L165\" rel=\"nofollow noreferrer\">You can check the source here.</a></p>\n\n<p>It is up to you to determine when the \"end of file\" has been reached. Typically, this is done by updating the file offset each time your read function is called. (This is the parameter you call <code>f_pos</code>.)</p>\n\n<p>So, you need to do something like <code>*f_pos += count</code> in <code>scull_read</code>. Then, when a program calls <code>scull_read</code> again on the same file, you can check <code>*f_pos</code> to determine whether or not there is still data to be read. If there is no data left to read, <code>scull_read</code> should return 0. </p>\n\n<p>Perhaps you will find <a href=\"https://linux-kernel-labs.github.io/master/labs/device_drivers.html#read-and-write\" rel=\"nofollow noreferrer\">this</a> useful.</p>\n"}], "owner": {"reputation": 13, "user_id": 12247010, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Vo3vaWnDqEI/AAAAAAAAAAI/AAAAAAAAADU/yKRP3RMLvas/photo.jpg?sz=128", "display_name": "Gururprasad Prusty", "link": "https://stackoverflow.com/users/12247010/gururprasad-prusty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "closed_date": 1576118236, "accepted_answer_id": 59291471, "answer_count": 1, "score": -1, "last_activity_date": 1576086719, "creation_date": 1576080760, "last_edit_date": 1576083202, "question_id": 59289897, "link": "https://stackoverflow.com/questions/59289897/the-call-back-function-scull-read-for-read-system-call-of-a-custum-character-d", "closed_reason": "Duplicate", "title": "The call-back function (scull_read) for read system call of a custum character device being called infinity times while reading using $cat", "body": "<p>I have written a character device driver to toggle two GPIO pins. For reading the device, callback function is <code>scull_read()</code>. The normal operations of the device open, read, write and close is functioning normally, If I am performing everything from the C program, but while performing the above operations from terminal using <em><code>echo</code></em> and <em><code>cat</code></em>, the callback functions for read and write (<code>scull_read()</code> and <code>scull_write()</code>) are being called for infinity times. At this stage, the kill signal <code>^c</code> to stop the process is not working for <code>scull_write()</code>.</p>\n\n<p>A test code is already available with name: <strong><em>strong text</em></strong></p>\n\n<p>Can you please help me with this.</p>\n\n<p>Here is a github link: <a href=\"https://github.com/guruprasad-92/Device-Driver.git\" rel=\"nofollow noreferrer\">https://github.com/guruprasad-92/Device-Driver.git</a></p>\n"}, {"tags": ["c", "cryptography"], "comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 3, "creation_date": 1576081090, "post_id": 59289892, "comment_id": 104784889, "body": "In <code>set_key</code>, <code>key = malloc(sizeof(&amp;key));</code> should be <code>key = malloc(sizeof(*key));</code>."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1576081237, "post_id": 59289892, "comment_id": 104784969, "body": "Also, you can simplify <code>memset(key, 0, 4 * sizeof(u_int64_t) + 8 * sizeof(u_int32_t));</code> to <code>memset(key, 0, sizeof(*key));</code>."}, {"owner": {"reputation": 23, "user_id": 12519514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bccf9073eb293835106dbb0055e6497?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Frost", "link": "https://stackoverflow.com/users/12519514/greg-frost"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1576081241, "post_id": 59289892, "comment_id": 104784970, "body": "Right, thanks! But the problem is still the same. I made the memset this way just to make it explicit"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1576081625, "post_id": 59289892, "comment_id": 104785166, "body": "When you add an integer to a pointer, the address in the pointer is increased by the integer multiplied by the size of the thing pointed to, so the pointer arithmetic in <code>key_to_round_keys</code> is all wrong."}, {"owner": {"reputation": 23, "user_id": 12519514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bccf9073eb293835106dbb0055e6497?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Frost", "link": "https://stackoverflow.com/users/12519514/greg-frost"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1576081882, "post_id": 59289892, "comment_id": 104785292, "body": "@IanAbbott, uhh, So i just need to add &amp; before every pointer there?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1576082076, "post_id": 59289892, "comment_id": 104785372, "body": "@GregFrost He&#39;s saying that the compiler adds <code>*sizeof(u_uint32_t)</code> for you. When you do <code>key-&gt;key + 2*sizeof(u_uint32_t)</code> for example, the compiler actually does <code>key-&gt;key + 2*sizeof(u_uint32_t)*sizeof(u_uint64_t)</code> which is all wrong."}, {"owner": {"reputation": 23, "user_id": 12519514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bccf9073eb293835106dbb0055e6497?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Frost", "link": "https://stackoverflow.com/users/12519514/greg-frost"}, "edited": false, "score": 0, "creation_date": 1576082931, "post_id": 59289892, "comment_id": 104785851, "body": "Understood. So i just can write <code>memcpy(key-&gt;round_keys + 1, key-&gt;key + 1, 1);</code>?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1576083503, "post_id": 59289892, "comment_id": 104786129, "body": "<code>memcpy(key-&gt;round_keys + 1, key-&gt;key + 1, 1);</code> would only copy a single byte."}, {"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 0, "creation_date": 1576119625, "post_id": 59289892, "comment_id": 104798182, "body": "Please don&#39;t beat the keys. They&#39;re trying their best to keep your secrets secure."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 12519514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bccf9073eb293835106dbb0055e6497?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Frost", "link": "https://stackoverflow.com/users/12519514/greg-frost"}, "edited": false, "score": 0, "creation_date": 1576083614, "post_id": 59290558, "comment_id": 104786176, "body": "Thanks! It works! But i can&#39;t understand, why should we use <code>&amp; 0xFFFFFFFFu</code>;"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 23, "user_id": 12519514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bccf9073eb293835106dbb0055e6497?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Frost", "link": "https://stackoverflow.com/users/12519514/greg-frost"}, "edited": false, "score": 0, "creation_date": 1576083874, "post_id": 59290558, "comment_id": 104786299, "body": "<code>&amp; 0xFFFFFFFFu</code> applies a bit mask that strips off everything above the first 32 bits. It isn&#39;t needed in this case since <code>round_keys[x]</code> is only 32 bits wide so everything above the first 32 bits will be stripped off anyway. But I like to use a bit mask anyway."}], "tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": true, "score": 2, "last_activity_date": 1576083180, "creation_date": 1576083180, "answer_id": 59290558, "question_id": 59289892, "link": "https://stackoverflow.com/questions/59289892/problems-with-beating-256bit-key-into-32bit-round-keys/59290558#59290558", "title": "Problems with beating 256bit key into 32bit round keys", "body": "<p>The pointer arithmetic in <code>key_to_round_keys</code> is all wrong. For pointer addition, <code>((p) + (i))</code> is equivalent to <code>(&amp;((p)[i]))</code>.</p>\n\n<p>Let's assume <code>sizeof(u_int32_t)</code> is 4 on your system (which is quite likely), then:</p>\n\n<pre><code>memcpy(key-&gt;round_keys + 7 * sizeof(u_int32_t), key-&gt;key + 7 * sizeof(u_int32_t), sizeof(u_int32_t));\n</code></pre>\n\n<p>would be equivalent to:</p>\n\n<pre><code>memcpy(&amp;key-&gt;round_keys[7 * 4], &amp;key-&gt;key[7 * 4], sizeof(u_int32_t));\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>memcpy(&amp;key-&gt;round_keys[28], &amp;key-&gt;key[28], sizeof(u_int32_t));\n</code></pre>\n\n<p>However, the <code>round_keys</code> array member is only 8 elements long, and the <code>key</code> array member is only 4 elements long, so both the source and destination of this <code>memcpy</code> call are out of bounds.</p>\n\n<hr>\n\n<p>Since your <code>set_key</code> function initializes the <code>key</code> array member of the <code>struct key</code> to <code>{1, 1, 1, 1}</code> (four 64-bit numbers), and you have indicated that you desire the <code>key_to_round_keys</code> function to copy that to the <code>round_keys</code> array member as <code>{0, 1, 0, 1, 0, 1, 0, 1}</code>, it seems that you want <code>round_keys[0]</code> to contain the upper 32 bits of <code>key[0]</code> and <code>round_keys[1]</code> to contain the lower 32 bits of <code>key[0]</code>. Or in general, <code>round_keys[2*n]</code> should contain the upper 32 bits of <code>key[n]</code>, and <code>round_keys[2*n+1]</code> should contain the lower 32 bits of <code>key[n]</code>. That can be done as follows:</p>\n\n<pre><code>void key_to_round_keys(struct key *key)\n{\n    key-&gt;round_keys[0] = key-&gt;key[0] &gt;&gt; 32;\n    key-&gt;round_keys[1] = key-&gt;key[0] &amp; 0xFFFFFFFFu;\n    key-&gt;round_keys[2] = key-&gt;key[1] &gt;&gt; 32;\n    key-&gt;round_keys[3] = key-&gt;key[1] &amp; 0xFFFFFFFFu;\n    key-&gt;round_keys[4] = key-&gt;key[2] &gt;&gt; 32;\n    key-&gt;round_keys[5] = key-&gt;key[2] &amp; 0xFFFFFFFFu;\n    key-&gt;round_keys[6] = key-&gt;key[3] &gt;&gt; 32;\n    key-&gt;round_keys[7] = key-&gt;key[3] &amp; 0xFFFFFFFFu;\n};\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>void key_to_round_keys(struct key *key)\n{\n    for (int n = 0; n &lt; 4; n++)\n    {\n        key-&gt;round_keys[2*n] = key-&gt;key[n] &gt;&gt; 32;\n        key-&gt;round_keys[2*n+1] = key-&gt;key[n] &amp; 0xFFFFFFFFu;\n    }\n};\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 12519514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bccf9073eb293835106dbb0055e6497?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Frost", "link": "https://stackoverflow.com/users/12519514/greg-frost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 59290558, "answer_count": 1, "score": 2, "last_activity_date": 1576083180, "creation_date": 1576080732, "last_edit_date": 1576081266, "question_id": 59289892, "link": "https://stackoverflow.com/questions/59289892/problems-with-beating-256bit-key-into-32bit-round-keys", "title": "Problems with beating 256bit key into 32bit round keys", "body": "<p>I'm trying to beat key into round keys.\nI use the struct to keep keys:</p>\n\n<pre><code>struct key\n{\n    u_int64_t key[4];\n    u_int32_t round_keys[8];\n};\n</code></pre>\n\n<p>Using the func to initialize the struct values:</p>\n\n<pre><code>struct key *set_key()\n{\n    struct key *key = malloc(sizeof(*key));\n    memset(key, 0, 4 * sizeof(u_int64_t) + 8 * sizeof(u_int32_t));\n    key-&gt;key[0] = 0x1;\n    key-&gt;key[1] = 0x1;\n    key-&gt;key[2] = 0x1;\n    key-&gt;key[3] = 0x1;\n    return key;\n};\n</code></pre>\n\n<p>And using the func to beat key into round keys:</p>\n\n<pre><code>void key_to_round_keys(struct key *key)\n{\n    memcpy(key-&gt;round_keys, key-&gt;key, sizeof(u_int32_t));\n    memcpy(key-&gt;round_keys + sizeof(u_int32_t), key-&gt;key + sizeof(u_int32_t), sizeof(u_int32_t));\n    memcpy(key-&gt;round_keys + 2 * sizeof(u_int32_t), key-&gt;key + 2 * sizeof(u_int32_t), sizeof(u_int32_t));\n    memcpy(key-&gt;round_keys + 3 * sizeof(u_int32_t), key-&gt;key + 3 * sizeof(u_int32_t), sizeof(u_int32_t));\n    memcpy(key-&gt;round_keys + 4 * sizeof(u_int32_t), key-&gt;key + 4 * sizeof(u_int32_t), sizeof(u_int32_t));\n    memcpy(key-&gt;round_keys + 5 * sizeof(u_int32_t), key-&gt;key + 5 * sizeof(u_int32_t), sizeof(u_int32_t));\n    memcpy(key-&gt;round_keys + 6 * sizeof(u_int32_t), key-&gt;key + 6 * sizeof(u_int32_t), sizeof(u_int32_t));\n    memcpy(key-&gt;round_keys + 7 * sizeof(u_int32_t), key-&gt;key + 7 * sizeof(u_int32_t), sizeof(u_int32_t));\n};\n</code></pre>\n\n<p>My main func is</p>\n\n<pre><code>int main() {\n    struct key *key = set_key();\n    key_to_round_keys(key);\n    printf(\"Key[1]: %llu\\nRound key 1: %d\", key-&gt;key[0], key-&gt;round_keys[0]);\n    delete_key(key);\n}\n</code></pre>\n\n<p>The problem is that during beating the key into round keys i've got the values \n{1, 0, 0, 0, 1, 0, 0, 0} for my round keys. but it should be like {0, 1, 0, 1, 0, 1, 0, 1}.\nWhy could it happen so?</p>\n"}, {"tags": ["c", "multithreading", "pointers"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 12519407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43d7fedfe9cf9203ef1a2a3c37dd0755?s=128&d=identicon&r=PG&f=1", "display_name": "aalang", "link": "https://stackoverflow.com/users/12519407/aalang"}, "edited": false, "score": 0, "creation_date": 1576084438, "post_id": 59290330, "comment_id": 104786577, "body": "So in the second example, i have to cast (long *)threadid because i&#39;m passing in the pointer to t, in other words the address of t?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 35, "user_id": 12519407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43d7fedfe9cf9203ef1a2a3c37dd0755?s=128&d=identicon&r=PG&f=1", "display_name": "aalang", "link": "https://stackoverflow.com/users/12519407/aalang"}, "edited": false, "score": 0, "creation_date": 1576084552, "post_id": 59290330, "comment_id": 104786620, "body": "@aalang Yes. I hope you also understand why it prints the final value in all threads."}, {"owner": {"reputation": 35, "user_id": 12519407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43d7fedfe9cf9203ef1a2a3c37dd0755?s=128&d=identicon&r=PG&f=1", "display_name": "aalang", "link": "https://stackoverflow.com/users/12519407/aalang"}, "edited": false, "score": 0, "creation_date": 1576085116, "post_id": 59290330, "comment_id": 104786894, "body": "I kinda get why, but is it because i called sleep(1), and by the time it finishes sleep, the t value is already the final value, and so it only starts assigning taskid to the threadid?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 35, "user_id": 12519407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43d7fedfe9cf9203ef1a2a3c37dd0755?s=128&d=identicon&r=PG&f=1", "display_name": "aalang", "link": "https://stackoverflow.com/users/12519407/aalang"}, "edited": false, "score": 0, "creation_date": 1576087903, "post_id": 59290330, "comment_id": 104788222, "body": "Yes, that is the reason. (I&#39;m not sure what &quot;it only starts assigning taskid to the threadid&quot; means but the rest of what you said is correct)"}, {"owner": {"reputation": 35, "user_id": 12519407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43d7fedfe9cf9203ef1a2a3c37dd0755?s=128&d=identicon&r=PG&f=1", "display_name": "aalang", "link": "https://stackoverflow.com/users/12519407/aalang"}, "edited": false, "score": 0, "creation_date": 1576089260, "post_id": 59290330, "comment_id": 104788836, "body": "I mean after it sleeps, then only executes the rest of the code from taskid = threadid, which by then is already final value"}], "tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": false, "score": 2, "last_activity_date": 1576082327, "creation_date": 1576082327, "answer_id": 59290330, "question_id": 59289853, "link": "https://stackoverflow.com/questions/59289853/trying-to-understand-pointers-and-threads/59290330#59290330", "title": "Trying to understand pointers and threads", "body": "<p>To get an address of a variable you have to use <code>&amp;</code>.</p>\n\n<p><code>(void*)t</code> does not get the address of <code>t</code>. It takes the value of <code>t</code>, and treats that value as a <code>void*</code> value instead. So you have a pointer to memory address 0, 1, 2, ... up to NUM_THREADS-1.</p>\n\n<p>You can't use these pointers because they don't point to valid addresses. But you can treat them as numbers again by using <code>(long)threadid</code>.</p>\n\n<p>The only reason you need to make the type <code>void*</code> is because that's what pthreads uses as the parameter to the thread function. If you used <code>void *PrintHello(long threadid)</code> then you would get an error when calling <code>pthread_create</code>, which would say that the function had the wrong type.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 12519407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43d7fedfe9cf9203ef1a2a3c37dd0755?s=128&d=identicon&r=PG&f=1", "display_name": "aalang", "link": "https://stackoverflow.com/users/12519407/aalang"}, "edited": false, "score": 0, "creation_date": 1576084340, "post_id": 59290344, "comment_id": 104786535, "body": "taskid = *(long *)threadid; so on this line i am casting it back to long, but since it&#39;s a pointer to t, i have to use * outside the brackets to get the value, and casting (long *) because it is a pointer? Otherwise it wouldn&#39;t work if i just cast (long) because t is a pointer?"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 35, "user_id": 12519407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43d7fedfe9cf9203ef1a2a3c37dd0755?s=128&d=identicon&r=PG&f=1", "display_name": "aalang", "link": "https://stackoverflow.com/users/12519407/aalang"}, "edited": false, "score": 0, "creation_date": 1576084703, "post_id": 59290344, "comment_id": 104786700, "body": "Not quite. You&#39;re casting it to <code>long *</code> and then dereferencing that. You can&#39;t dereference <code>void *</code> pointers."}, {"owner": {"reputation": 35, "user_id": 12519407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43d7fedfe9cf9203ef1a2a3c37dd0755?s=128&d=identicon&r=PG&f=1", "display_name": "aalang", "link": "https://stackoverflow.com/users/12519407/aalang"}, "edited": false, "score": 0, "creation_date": 1576085418, "post_id": 59290344, "comment_id": 104787048, "body": "Got it, thank you very much for the explanation, i understand it better now :)"}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": true, "score": 2, "last_activity_date": 1576082368, "creation_date": 1576082368, "answer_id": 59290344, "question_id": 59289853, "link": "https://stackoverflow.com/questions/59289853/trying-to-understand-pointers-and-threads/59290344#59290344", "title": "Trying to understand pointers and threads", "body": "<p>Putting a type in brackets before something is casting that value into that data type. So in your examples <code>(void *) t</code> converts the value of <code>t</code> from a <code>long</code> to a <code>void *</code>. This is done because the <code>pthread_create</code> is expecting a pointer.</p>\n\n<p>Putting a <code>&amp;</code> in front of something gets the address of it. So <code>&amp;t</code> gets the address of <code>t</code>. It's then being cast to <code>void *</code> as described above, although it isn't really needed as any pointer will be automatically cast to <code>void *</code> if required.</p>\n\n<p>So in the first version of your code you're passing the actual value of <code>t</code> into your thread by casting it to make it look like it is a pointer and then casting it back again inside the thread to get the <code>long</code> value.</p>\n\n<p>The second version is passing a pointer to <code>t</code> in, so each thread will print out the value of <code>t</code> at the time the reach this line:</p>\n\n<pre><code>taskid = *(long *)threadid;\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 12519407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43d7fedfe9cf9203ef1a2a3c37dd0755?s=128&d=identicon&r=PG&f=1", "display_name": "aalang", "link": "https://stackoverflow.com/users/12519407/aalang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 59290344, "answer_count": 2, "score": 2, "last_activity_date": 1576082368, "creation_date": 1576080587, "last_edit_date": 1576080856, "question_id": 59289853, "link": "https://stackoverflow.com/questions/59289853/trying-to-understand-pointers-and-threads", "title": "Trying to understand pointers and threads", "body": "<p>I am fairly new to C and trying to understand threads and pointers. As far as i know, this line creates a thread</p>\n\n<pre><code>rc = pthread_create(&amp;threads[t], NULL, PrintHello, (void *)t); \n</code></pre>\n\n<p>The fourth arg is taking the argument for the pointer function <code>(void *)t</code>, and this is a pointer to the address of variable <code>t</code> which is a <code>long</code> type? And the pointer function takes the argument of void pointer to a variable, which is <code>(void *)t</code>. </p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define NUM_THREADS 20\n\nvoid *PrintHello(void *threadid)\n{\n   long tid;\n   tid = (long)threadid;\n   printf(\"Hello World! It's me, thread #%ld!\\n\", tid);\n   pthread_exit(NULL);\n}\n\nint main(int argc, char *argv[])\n{\n   pthread_t threads[NUM_THREADS];\n   int rc;\n   long t;\n   for(t=0;t&lt;NUM_THREADS;t++){\n     printf(\"In main: creating thread %ld\\n\", t);\n     rc = pthread_create(&amp;threads[t], NULL, PrintHello, (void *)t);\n     if (rc){\n       printf(\"ERROR; return code from pthread_create() is %d\\n\", rc);\n       exit(-1);\n       }\n     }\n\n   /* Last thing that main() should do */\n   pthread_exit(NULL);\n}\n</code></pre>\n\n<p>After that, I changed the pointer function and the <code>pthread_create</code> to this:</p>\n\n<pre><code>{\n   long taskid;\n   sleep(1);\n   taskid = *(long *)threadid;\n   printf(\"Hello from thread %ld\\n\", taskid);\n   pthread_exit(NULL);\n}\n\n rc = pthread_create(&amp;threads[t], NULL, PrintHello, (void *) &amp;t);\n</code></pre>\n\n<p>So now the void pointer is still pointing to the address of variable <code>t</code>?</p>\n\n<p>And  <code>*(long *)threadid</code> is de-referencing the variable <code>t</code>?\nAnd it outputs the final value of <code>t</code> in all threads.</p>\n\n<p>I'm not sure if I understand it correctly, if I misunderstood somewhere I appreciate any advice. My question is for the <code>(void *)t</code> and <code>(void *) &amp;t</code>, they are both pointers to the address of variable <code>t</code>, and I read pointers can only be point to addresses but not values, so why is the <code>(void *)t</code> outputting the incrementing values of <code>t</code>? <code>taskid = *(long *)threadid;</code> And if I just do <code>taskid = threadid</code> it prints out the address of <code>t</code>, what does <code>*(long *)</code> do? The <code>*</code> outside the brackets is de-referencing?</p>\n"}, {"tags": ["c", "serial-port", "texas-instruments", "device-manager"], "comments": [{"owner": {"reputation": 2034, "user_id": 2486496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Rpd3r.jpg?s=128&g=1", "display_name": "gravity", "link": "https://stackoverflow.com/users/2486496/gravity"}, "edited": false, "score": 0, "creation_date": 1576087878, "post_id": 59289715, "comment_id": 104788210, "body": "Can you not iterate through all devices, find the UID of the device you&#39;re attempting to I/O with through some method?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12479162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a6f2497cad8d0530fa897f024f430c?s=128&d=identicon&r=PG&f=1", "display_name": "kibblesnbytes", "link": "https://stackoverflow.com/users/12479162/kibblesnbytes"}, "edited": false, "score": 0, "creation_date": 1579513895, "post_id": 59289868, "comment_id": 105778464, "body": "Thank you, this has provided some clarity as to why the pins don&#39;t function correctly. Do you know if communication via COM port is possible? Using the USB Mini A cable? As I understand this utilizes SCIAxT/SCIAxR, and none of the other SCI protocols. I&#39;ve tried this as well, having synchronized Baud rates of PC &amp; controller via Simulink and sending a simple message (binary 1), but to no avail. The number received at the PC is in hexadecimal and with an abnormally large margin of error."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 1, "user_id": 12479162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a6f2497cad8d0530fa897f024f430c?s=128&d=identicon&r=PG&f=1", "display_name": "kibblesnbytes", "link": "https://stackoverflow.com/users/12479162/kibblesnbytes"}, "edited": false, "score": 0, "creation_date": 1579516324, "post_id": 59289868, "comment_id": 105779836, "body": "@kibblesnbytes I do not know about this particular microcontroller. But you can buy a USB to serial (COM port) adapter cable and you should be able to connect that to your microcontroller. The fact that you&#39;re receiving <i>something</i> means you&#39;re probably on the right track."}], "tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": false, "score": 2, "last_activity_date": 1576080636, "creation_date": 1576080636, "answer_id": 59289868, "question_id": 59289715, "link": "https://stackoverflow.com/questions/59289715/microcontroller-not-recognized-at-usb-port-when-connected-via-pins/59289868#59289868", "title": "Microcontroller not recognized at USB port when connected via pins", "body": "<p>The SCIBRxD and SCIBTxD pins belong to the <a href=\"http://www.ti.com/lit/ug/sprufz5a/sprufz5a.pdf\" rel=\"nofollow noreferrer\">SCI peripheral</a> in the microcontroller. This peripheral implements a UART port (a.k.a. COM port, a.k.a. TTL serial port). It is not a USB port. Nothing useful will happen if you connect it to a USB port, because it is not compatible with USB in any way.</p>\n\n<p>USB-to-UART adapters (a.k.a. USB-to-serial adapters) do exist. There is one built into the LaunchPad. The UART side of the adapter is connected to the SCIB pins, and the USB side of the adapter is connected to the USB port.</p>\n"}], "owner": {"reputation": 1, "user_id": 12479162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a6f2497cad8d0530fa897f024f430c?s=128&d=identicon&r=PG&f=1", "display_name": "kibblesnbytes", "link": "https://stackoverflow.com/users/12479162/kibblesnbytes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1576498014, "creation_date": 1576080096, "last_edit_date": 1576498014, "question_id": 59289715, "link": "https://stackoverflow.com/questions/59289715/microcontroller-not-recognized-at-usb-port-when-connected-via-pins", "title": "Microcontroller not recognized at USB port when connected via pins", "body": "<p>Im having issues with my TI LAUNCHXL-F28379D. I have it connected to the laptop I am trying to send data to/from via pins P19 (SCIBRxD) and P18 (SCIBTxD), as well as GND and 5V via J16, using a USB Type B cord to which I sautered pin connectors. I'm sure power is being supplied to the board as when I plug the 5V cable of the USB cable, the RGB lights and 3 other small ones turn on. However, the Computer does not recognize ithe controller at the port - it only recognizes if if it is connected via the board's Mini-USB port. I've also written a C Program which opens the COM port and reads data - but this does not work without my knowledge of the COM port number, usually found in Device Manager. I cannot get any further in my project without the port number and it is very annoying. I will attempt to resauter a new USB cable, but if there are any other possible solutions, or if I'm doing something wrong, please let me know. </p>\n\n<p>Absolutely all feedback is appreciated!</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1576078681, "post_id": 59289180, "comment_id": 104783511, "body": "Your code is atrociously formatted. Please reformat it consistently, and so you only have one statement per line."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 3, "creation_date": 1576079517, "post_id": 59289180, "comment_id": 104783976, "body": "Your <code>function</code> expects a 20x20 array, but you are passing it a 10x10 array and a 15x20 array. The compiler probably output some warnings about incompatible pointer types."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1576079706, "post_id": 59289180, "comment_id": 104784094, "body": "OK, so maybe I&#39;m &quot;blowing my own trumpet&quot; here, but an answer I gave a few days ago may help you understand why you need to be <b><i>consistent</i></b> with your array dimensions, between <code>main</code> and <code>function</code>; see here: <a href=\"https://stackoverflow.com/a/59216754/10871073\">stackoverflow.com/a/59216754/10871073</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1576093554, "post_id": 59289180, "comment_id": 104790667, "body": "<code>void function(int Z[20][20], int z)</code>, <code>int A[10][10]</code> and <code>function(A,n);</code> is troubling code.  Enable all compiler warnings."}], "answers": [{"comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1576079962, "post_id": 59289431, "comment_id": 104784241, "body": "<i>you&#39;ll write in some other variable which you don&#39;t know</i> might better be stated <i>you&#39;ll write in memory which you do not own</i>"}, {"owner": {"reputation": 31, "user_id": 12519287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29275ebd76d0576669d31f4a00460a54?s=128&d=identicon&r=PG&f=1", "display_name": "Yespi", "link": "https://stackoverflow.com/users/12519287/yespi"}, "edited": false, "score": 0, "creation_date": 1576080969, "post_id": 59289431, "comment_id": 104784828, "body": "I&#39;ve arranged the code but the problem still persists. I&#39;ve used <code>count[10]</code> as a limit for the arrays. Also it shows me warning like this <code>passing argument 1 of &#39;function&#39; from incompatible pointer type [-Wincompatible-pointer-types]</code>"}], "tags": [], "owner": {"reputation": 1, "user_id": 12517438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24bc51eceda78c087e28d9923e2567de?s=128&d=identicon&r=PG&f=1", "display_name": "Martino", "link": "https://stackoverflow.com/users/12517438/martino"}, "is_accepted": false, "score": 0, "last_activity_date": 1576137363, "last_edit_date": 1576137363, "creation_date": 1576079298, "answer_id": 59289431, "question_id": 59289180, "link": "https://stackoverflow.com/questions/59289180/counting-negative-numbers-in-each-column-in-an-2d-array/59289431#59289431", "title": "Counting negative numbers in each column in an 2d array", "body": "<p><strong>[EDITED]</strong></p>\n\n<p>I think you have a problem with <code>int count[10];</code>, I assume you are assuming all your arrays are 20 long, so you're declaring it 10 long, and in c you can do it but you'll write in memory which you do not own.</p>\n\n<p>Try something like:</p>\n\n<pre><code>void function(int inputArray[20][20], int arrayLength) {\n    int i,j;\n    int count[arrayLength];\n    for (i = 0; i &lt; arrayLength; i++){\n        count[i] = 0;\n        for(j = 0; j &lt; arrayLength; j++){\n            if(inputArray[i][j] &lt; 0){\n                count[i]++; \n            }\n        }\n    }\n    for(i = 0; i &lt; arrayLength; i++){\n        printf(\"\\n Col %d = %d\", i, count[i]);\n    } \n}\n</code></pre>\n\n<p>Also try to write ordered code, which is easier to read and debug.</p>\n"}, {"tags": [], "owner": {"reputation": 2462, "user_id": 5293112, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JGyvU.png?s=128&g=1", "display_name": "kuro", "link": "https://stackoverflow.com/users/5293112/kuro"}, "is_accepted": false, "score": 4, "last_activity_date": 1576080249, "last_edit_date": 1576080249, "creation_date": 1576079867, "answer_id": 59289632, "question_id": 59289180, "link": "https://stackoverflow.com/questions/59289180/counting-negative-numbers-in-each-column-in-an-2d-array/59289632#59289632", "title": "Counting negative numbers in each column in an 2d array", "body": "<p>You are trying to find count of negative numbers in each column. But in your function you are counting the negative numbers in each row (not column). You can verify this by counting the negative numbers and matching it with output of your program. You can fix it by simply changing the index in your function like - </p>\n\n<pre><code>void function(int Z[20][20], int z) {\n    int i,j;\n    int count[10];\n    for (i=0; i&lt;z; i++) {\n        count[i]=0;\n        for(j=0; j&lt;z; j++) {\n            if (Z[j][i]&lt;0)\n                count[i]++;\n        }\n    }\n    for (i=0; i&lt;z; i++) {\n        printf(\"\\n Col %d = %d\",i,count[i]);\n    }\n}\n</code></pre>\n\n<p>Notice the change in if condition from <code>if (Z[i][j]&lt;0)</code> to <code>if (Z[j][i]&lt;0)</code>. That way when say <code>i</code> is 0 in inner loop you are accessing <code>Z[0][0]</code>, <code>Z[1][0]</code> and <code>Z[2][0]</code> giving you the numbers in column 0. Same for column 1 and 2.</p>\n\n<p>In your question you have mentioned that your code gave right answer for second array. But if you look closely, it is giving wrong value for column 1 and 2.</p>\n\n<p>Also, change your code according to the advises everyone else has given.</p>\n"}, {"tags": [], "owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "is_accepted": true, "score": 0, "last_activity_date": 1576160342, "last_edit_date": 1576160342, "creation_date": 1576148248, "answer_id": 59303042, "question_id": 59289180, "link": "https://stackoverflow.com/questions/59289180/counting-negative-numbers-in-each-column-in-an-2d-array/59303042#59303042", "title": "Counting negative numbers in each column in an 2d array", "body": "<blockquote>\n  <p>I'm trying to count the negative numbers in each column of a square matrix (2D array) and I'm doing it on two arrays.</p>\n</blockquote>\n\n<p>Here is the first problem, because one of the arrays showed in the posted snippet isn't <em>square</em>:</p>\n\n<pre><code>int A[10][10], B[15][20];\n//               ^^  ^^\n</code></pre>\n\n<p>They also have different numbers of columns (one 10, the other 20), but the function <code>function</code> is declared as</p>\n\n<pre><code>void function(int Z[20][20], int z)\n{ //                    ^^       ^  Expects an int [][20] and a number of columns\n    int i, j;\n    int count[10];\n    //        ^^   Only 10, while you pass a matrix with 15 columns\n    for (i = 0; i &lt; z; i++)\n    {\n        count[i] = 0;\n        //    ^          Out of bounds if i &gt;= 10\n// ...\n</code></pre>\n\n<p>You can fix it by changing the function signature and using a Variable Length Array to store the values</p>\n\n<pre><code>void function(size_t rows, size_t cols, int Z[rows][cols])\n{ //                 ^^^^         ^^^^        ^^^^  ^^^^\n    size_t count[cols];\n    //           ^^^^\n    for (size_t i = 0; i &lt; cols; ++i)\n        count[i] = 0;   // This is a job for memset, though\n\n    for (size_t i = 0; i &lt; rows; ++i)\n    {\n        for (size_t j = 0; j &lt; cols; ++j)\n        {\n            if( Z[i][j] &lt; 0 )\n            { //  ^  ^\n                ++count[j];\n                //      ^\n            }\n        }\n    }\n// ...\n</code></pre>\n\n<p>Note, though, that this task doesn't require an array to store the sums. You could print those value as soon as they are calculated, you just need to traverse the arrays in column-major order:</p>\n\n<pre><code>void function(size_t rows, size_t cols, int Z[rows][cols])\n{\n    for (size_t col = 0; col &lt; cols; ++col)\n    { \n        size_t count = 0;\n        for (size_t row = 0; row &lt; rows; ++row)\n        {\n            if( Z[row][col] &lt; 0 )\n            { \n                ++count;\n            }\n        }\n        printf(\"Col %zu = %zu\\n\", col, count);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 12519287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29275ebd76d0576669d31f4a00460a54?s=128&d=identicon&r=PG&f=1", "display_name": "Yespi", "link": "https://stackoverflow.com/users/12519287/yespi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 59303042, "answer_count": 3, "score": 2, "last_activity_date": 1576160342, "creation_date": 1576078426, "last_edit_date": 1576082222, "question_id": 59289180, "link": "https://stackoverflow.com/questions/59289180/counting-negative-numbers-in-each-column-in-an-2d-array", "title": "Counting negative numbers in each column in an 2d array", "body": "<p>I'm trying to count the negative numbers in each column of a square matrix (2D array), and I'm doing it on two arrays. My problem is that my program seems to read rows, not columns, and the results it gives for the first array is incorrect, even though the second array's results are fine.</p>\n\n<p>This is the code I have:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid function(int Z[20][20], int z)\n{\n    int i, j;\n    int count[10];\n\n    for (i = 0; i &lt; z; i++)\n    {\n        count[i] = 0;\n        for (j = 0; j &lt; z; j++)\n        {\n            if(Z[i][j] &lt; 0)\n            {\n                count[i]++;\n            }\n        }\n    }\n    for (i = 0; i &lt; z; i++)\n    {\n        printf(\"\\n Col %d = %d\", i, count[i]);\n    }\n}\n\nint main()\n{\n    int A[10][10], B[15][20];\n    int i, j, n = 3;\n\n    printf(\"\\n Table A: \");\n    for (i = 0; i &lt; n; i++)\n    {\n        for (j = 0; j &lt; n; j++)\n        {\n            scanf(\"%d\",&amp;A[i][j]);\n        }\n    }\n\n    printf(\"\\n Table B: \");\n    for (i = 0; i &lt; n; i++)\n    {\n        for (j = 0; j &lt; n; j++){\n            scanf(\"%d \",&amp;B[i][j]);\n        }\n    }\n    for (i = 0; i &lt; n; i++)\n    {\n        for (j = 0; j &lt; n; j++)\n        {\n            printf(\"%d \",A[i][j]);\n        }\n        printf(\"\\n\");\n    }\n    printf(\"\\n\");\n\n    for (i = 0; i &lt; n; i++)\n    {\n        for (j = 0; j &lt; n; j++)\n        {\n            printf(\"%d \",B[i][j]);\n        }\n        printf(\"\\n\");\n    }\n\n    function(A,n);\n    function(B,n);\n    return 0;\n}\n</code></pre>\n\n<p>My matrices are:</p>\n\n<pre><code>A:             B:\n 3 -4 -5        3 -5  2\n-2  1  3       -3 -1  6\n 5 -7 -4        8 -5  4\n</code></pre>\n\n<p>And this is the output I get:</p>\n\n<pre><code> Table A:\n3\n-4\n-5\n-2\n1\n3\n5\n-7\n-4\n\n Table B: 3\n-5\n2\n-3\n-1\n6\n8\n-5\n4\n3\n3 -4 -5\n-2 1 3\n5 -7 -4\n\n3 -5 2\n-3 -1 6\n8 -5 4\n\n Col 0 = 2\n Col 1 = 2\n Col 2 = 0\n Col 0 = 1\n Col 1 = 2\n Col 2 = 1\n</code></pre>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1576077458, "post_id": 59288805, "comment_id": 104782700, "body": "As for a possible way to understand what&#39;s happening, use pen and paper to draw your initial list (using squares as the nodes, and arrows as the pointers). Also draw (and for each recursive call erase and redraw) an arrow for <code>F</code> <i>and</i> <code>*F</code>, where it points in each call."}, {"owner": {"reputation": 141, "user_id": 7857462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ab7619cbcb32e4e82d4bf7865400c3?s=128&d=identicon&r=PG", "display_name": "user7857462", "link": "https://stackoverflow.com/users/7857462/user7857462"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1576078636, "post_id": 59288805, "comment_id": 104783476, "body": "@Someprogrammerdude I tried drawing but one question remained: when *F is pointing to Node2, is saying Node1-&gt;Next=P equivalent to *F=P since the next element of Node1 points to Node2 and to *F?"}, {"owner": {"reputation": 829, "user_id": 9152997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MHecL.png?s=128&g=1", "display_name": "Orestis Zekai", "link": "https://stackoverflow.com/users/9152997/orestis-zekai"}, "edited": false, "score": 0, "creation_date": 1576078787, "post_id": 59288805, "comment_id": 104783560, "body": "I think you should compare with <code>(*F)-&gt;Next-&gt;V</code> and not with <code>(*F)-&gt;V</code>"}, {"owner": {"reputation": 141, "user_id": 7857462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ab7619cbcb32e4e82d4bf7865400c3?s=128&d=identicon&r=PG", "display_name": "user7857462", "link": "https://stackoverflow.com/users/7857462/user7857462"}, "reply_to_user": {"reputation": 829, "user_id": 9152997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MHecL.png?s=128&g=1", "display_name": "Orestis Zekai", "link": "https://stackoverflow.com/users/9152997/orestis-zekai"}, "edited": false, "score": 0, "creation_date": 1576079170, "post_id": 59288805, "comment_id": 104783775, "body": "@OrestisZekai when I tried solving it I really wrote this and in the if statement I wrote P-&gt;Next=*F-&gt;Next and *F-&gt;Next=P. But when I saw the solution written by the professor I wanted to understand it so this is not my code."}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 1, "creation_date": 1576079177, "post_id": 59288805, "comment_id": 104783783, "body": "This bit <code>&amp;(*F)-&gt;Next</code> in the recursive call actually calls it with a <i>pointer</i> to the member field <code>Next</code>, which can then be modified - personally, I don&#39;t like it even if it works."}, {"owner": {"reputation": 141, "user_id": 7857462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ab7619cbcb32e4e82d4bf7865400c3?s=128&d=identicon&r=PG", "display_name": "user7857462", "link": "https://stackoverflow.com/users/7857462/user7857462"}, "reply_to_user": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1576079234, "post_id": 59288805, "comment_id": 104783819, "body": "@500-InternalServerError should it be written as: &amp;(*F-&gt;Next)?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1576080534, "post_id": 59288805, "comment_id": 104784574, "body": "@user7857462 No, <code>&amp;(*F-&gt;Next)</code> won&#39;t compile because by the operator precedence rules, that is equivalent to <code>&amp;(*(F-&gt;Next))</code> and <code>F</code> does not have type <code>Node *</code>."}], "answers": [{"tags": [], "owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "is_accepted": false, "score": 2, "last_activity_date": 1576141550, "last_edit_date": 1576141550, "creation_date": 1576079632, "answer_id": 59289547, "question_id": 59288805, "link": "https://stackoverflow.com/questions/59288805/confusion-in-adding-an-element-to-a-sorted-list-of-integers/59289547#59289547", "title": "Confusion in adding an element to a sorted list of integers", "body": "<p>The variable <code>F</code> is a pointer to a pointer to a Node. </p>\n\n<p>Things might be clearer with this figure:</p>\n\n<pre><code>      Node1 {\n        V\n F ---&gt; Next ----&gt; Node2 {\n      }              V\n                     Next\n                   }\n</code></pre>\n\n<p>As you see, F is a pointer on the field Next of the previous Node. If <code>*F</code> is NULL, the end of list is reached and a node may be inserted. The value in <code>*F</code> is assigned to the field <code>Next</code> of the new node. The address of the new node is stored in <code>*F</code> which is the field <code>Next</code> of Node1.  </p>\n\n<p>The new node will thus be \"inserted\" after Node1 and \"before\" whatever is after it, NULL or Node2. </p>\n\n<p>Note that it works also when starting the insertion. We pass the address of <code>head</code> instead of the address of the field <code>Next</code> of the previous block. The nice thing is that the code of the function remains the same. By testing <code>*F</code> we test the content of <code>head</code>. If it\u2019s NULL (the list is empty), we create a new node and store its address in <code>*F</code> which is <code>head</code>. </p>\n\n<p>By making <code>F</code> a pointer to a pointer to a node, we have an elegant way to insert a node in a list. It also works for deletion. </p>\n"}], "owner": {"reputation": 141, "user_id": 7857462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ab7619cbcb32e4e82d4bf7865400c3?s=128&d=identicon&r=PG", "display_name": "user7857462", "link": "https://stackoverflow.com/users/7857462/user7857462"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1576141550, "creation_date": 1576077092, "last_edit_date": 1576078438, "question_id": 59288805, "link": "https://stackoverflow.com/questions/59288805/confusion-in-adding-an-element-to-a-sorted-list-of-integers", "title": "Confusion in adding an element to a sorted list of integers", "body": "<p>In the problem we want to write a recursive C function that adds a node to a sorted linked list. I am trying to understand the solution which is:</p>\n\n<pre><code>typedef struct Node{\n    int V;\n    struct Node *Next;\n} Node;\n\nvoid Insert_R(Node **F, int x)\n{ \n    Node *P;\n    if(*F == NULL || (*F)-&gt;V &gt; x)\n    {\n        P = (Node*)malloc(sizeof(Node));\n        P-&gt;V = x;\n        P-&gt;Next = *F;\n       *F = P;\n    }\n    else\n        Insert_R(&amp;(*F)-&gt;Next, x);\n}\n</code></pre>\n\n<p>What I understood: call the first element containing an integer greater than x Node 2 and Node 1 its predecessor. So we want to add a new node before Node 2 and after Node 1. So the Next pointer of the new node must point to the current position of <code>*F</code> which is at Node 2.</p>\n\n<p>But in this case how did we manage to let the Next pointer in Node 1 point to the new node?</p>\n"}, {"tags": ["c++", "c", "linux", "networking", "epoll"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1576077064, "post_id": 59288735, "comment_id": 104782471, "body": "It sounds like the answer is yes. Well, you can make your program deal with it however you want. That is one way. You could also consider using epoll_ctl to disable EPOLLOUT when you&#39;re not waiting to write data."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1576077416, "post_id": 59288735, "comment_id": 104782674, "body": "@demonatic Is there a good reason for using edge-triggered semantics? A cleaner and more robust way would be to use level-triggered polling and modify the event sets as you need them at the moment."}, {"owner": {"reputation": 67, "user_id": 8735688, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-N-hjHp-odOg/AAAAAAAAAAI/AAAAAAAAAA0/ZBJnbIvM0DY/photo.jpg?sz=128", "display_name": "demonatic", "link": "https://stackoverflow.com/users/8735688/demonatic"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1576077932, "post_id": 59288735, "comment_id": 104783013, "body": "@Ctx  I use edge trigger mainly to reduce system calls and the number of fds possibly returns from epoll_wait"}], "answers": [{"tags": [], "owner": {"reputation": 5431, "user_id": 212264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1d6c9fc211a9cda08a289aedb76814f2?s=128&d=identicon&r=PG", "display_name": "Ron Burk", "link": "https://stackoverflow.com/users/212264/ron-burk"}, "is_accepted": false, "score": 0, "last_activity_date": 1602657515, "creation_date": 1602657515, "answer_id": 64347850, "question_id": 59288735, "link": "https://stackoverflow.com/questions/59288735/epoll-wait-return-epollout-even-with-epollet-flag/64347850#64347850", "title": "epoll_wait return EPOLLOUT even with EPOLLET flag", "body": "<p>What a great question (since I had pretty much the same question)! I'll just summarize what I think I know now wrt to your informative question/description and your helpful links and hopefully smarter folk will correct any mistakes.</p>\n<p>Yes, the if/else handling of event flags is definitely bogus. For sure at least two can events can arrive at effectively the same time. E.g., both the read and write sides might have become unblocked since last you called <code>epoll_wait()</code>. And, of course, as soon as you <code>accept()</code> the connection, both reading and writing suddenly become possible, so you get an &quot;event&quot; of <code>EPOLLIN|EPOLLOUT</code>.</p>\n<p>I really didn't grok that <code>epoll_wait()</code> is always delivering the entire current state, rather than only the parts of the state that changed -- thanks for clearing that up. To be perhaps clearer, <code>epoll_wait()</code> won't return an fd unless <em>something</em> changed on that socket, but if something did change, it returns all the flags representing the current state. So, I found myself staring at a stream of <code>EPOLLIN|EPOLLOUT</code> events wondering why it was claiming there was an &quot;output&quot; event, even though I hadn't written anything yet. Your answer being correct: it's just telling me the output side is <em>still</em> writeable.</p>\n<p>&quot;Should I maintain a flag...&quot; Yes, but I would imagine that in all but the most trivial situations you were probably going to end up maintaining at least one bit of &quot;am I currently blocked&quot; state for your readers/writers anyway. For example, if you ever want to process data in an order different than how it arrives (e.g., prioritize responses over requests to make your server more resistant to overload) you instantly have to give up the simplicity of just having the arrival of I/O drive everything. In the particular case of writing, epoll simply doesn't have enough information to notify you at the &quot;right&quot; time. As soon as you accept a connection, there's an event that says &quot;you can write now&quot;--but you probably have nothing to write if you're a server who couldn't possibly have already gotten a request from the client. epoll just can't know whether you have something to write or not, so you were always going to have to either suffer essentially &quot;extraneous&quot; events, or maintain your own state.</p>\n<p>In all but the simplest cases, the socket file descriptor ends up being insufficient information for handling I/O events, so you invariably have to associate some data structure with it, or object if you prefer. So, my C++ looks something like:</p>\n<pre><code>nAwake = epoll_wait(epollFd, events, 100, milliseconds);\nif(nAwake &lt; 0)\n    {\n    perror(&quot;epoll_wait failed&quot;);\n    assert(false);\n    }\nfor(int iSocket=0; iSocket &lt; nAwake; ++iSocket)\n    {\n    auto This = static_cast&lt;Eventable*&gt;(events[iSocket].data.ptr);\n    auto eventFlags = events[iSocket].events;\n    fprintf(stderr, &quot;%s event on socket [%d] -&gt; %s\\n&quot;,\n        This-&gt;ClassName(), This-&gt;fd, DumpEvent(eventFlags));\n\n    This-&gt;Event(eventFlags);\n    }\n</code></pre>\n<p>Where <code>Eventable</code> is a C++ class (or derivative thereof) that has all the state needed to decide how to handle the flags epoll delivers. (Of course, this is letting the kernel store a pointer to a C++ object, requiring a design that is very clear about pointer ownership/lifetimes.)</p>\n<p>And since you're writing low-level code on Linux, you may also care about <code>EPOLLRDHUP</code>. This not-highly-portable flag lets you save one call to <code>read()</code>. If the client (curl seems pretty good at evoking this behavior) closes its write side of the connection (sends a FIN), you normally discover that when epoll tells you <code>EPOLLIN</code>, but <code>read()</code> returns zero bytes. However, Linux maintains an extra bit to indicate your client's write side (your read side) has been closed. So, if you tell epoll you want the <code>EPOLLRDHUP</code> event you can use it to avoid doing a <code>read()</code> whose sole purpose will turn out to be telling you the writer closed their side.</p>\n<p>Note that <code>EPOLLIN</code> will still be turned on whenever <code>EPOLLRDHUP</code> is, AFAIK. Even after you do a <code>shutdown(fd, SHUT_RD)</code>. Another example of how you will usually be driven to maintain your own idea of the state of the connection. You care more about clients who are kind enough to do half-shutdowns <a href=\"https://apenwarr.ca/log/20090814\" rel=\"nofollow noreferrer\">if you are implementing HTTP</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8313907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08895f85baa06e35e9e6c16f151c4a4c?s=128&d=identicon&r=PG&f=1", "display_name": "\u738b\u4f20\u4e49", "link": "https://stackoverflow.com/users/8313907/%e7%8e%8b%e4%bc%a0%e4%b9%89"}, "is_accepted": false, "score": 0, "last_activity_date": 1613977697, "creation_date": 1613977697, "answer_id": 66311372, "question_id": 59288735, "link": "https://stackoverflow.com/questions/59288735/epoll-wait-return-epollout-even-with-epollet-flag/66311372#66311372", "title": "epoll_wait return EPOLLOUT even with EPOLLET flag", "body": "<p>When used as an edge-triggered interface, <strong>for performance  reasons,</strong><br />\nit\nis  possible  to  add  the  file  descriptor inside the epoll interface\n(EPOLL_CTL_ADD) once by specifying (EPOLLIN|EPOLLOUT).<br />\nThis allows you\nto  avoid  continuously  <strong>switching</strong> between EPOLLIN and EPOLLOUT calling\nepoll_ctl(2) with EPOLL_CTL_MOD.\n<a href=\"https://i.stack.imgur.com/GgVtd.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GgVtd.jpg\" alt=\"enter image description here\" /></a></p>\n"}], "owner": {"reputation": 67, "user_id": 8735688, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-N-hjHp-odOg/AAAAAAAAAAI/AAAAAAAAAA0/ZBJnbIvM0DY/photo.jpg?sz=128", "display_name": "demonatic", "link": "https://stackoverflow.com/users/8735688/demonatic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 535, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1613977697, "creation_date": 1576076887, "last_edit_date": 1576081705, "question_id": 59288735, "link": "https://stackoverflow.com/questions/59288735/epoll-wait-return-epollout-even-with-epollet-flag", "title": "epoll_wait return EPOLLOUT even with EPOLLET flag", "body": "<p>I am using linux epoll in edge trigger mode.\nEach time a new connection is incoming, I add the file descriptor to epoll with EPOLLIN|EPOLLOUT|EPOLLET flag. My first question is: What's the right way to check which kind of event(s) occur for each ready file descriptor after the epoll_wait returns? I mean, I see some example code e.g from <a href=\"https://github.com/yedf/handy/blob/master/raw-examples/epoll-et.cc\" rel=\"nofollow noreferrer\">https://github.com/yedf/handy/blob/master/raw-examples/epoll-et.cc</a> line 124 do it like this:</p>\n\n<pre><code>for (int i = 0; i &lt; n; i++) {\n    //...\n    if (events &amp; (EPOLLIN | EPOLLERR)) {\n        if (fd == lfd) {\n            handleAccept(efd, fd);\n        } else {\n            handleRead(efd, fd);\n        }\n    } else if (events &amp; EPOLLOUT) {\n        if (output_log)\n            printf(\"handling epollout\\n\");\n        handleWrite(efd, fd);\n    } else {\n        exit_if(1, \"unknown event\");\n    }\n}\n</code></pre>\n\n<p>What caught my attention is: it uses \"if and else if and else\" to check which event occurs, which means if it handleRead, then it can't handleWrite at the same time. And I think this may cause loss of event in the following condition: Both socket read and write operation have meet EAGAIN and then the remote end both read and send some data, thus the epoll wait may set both EPOLLIN and EPOLLOUT, but it can only handleRead, and the data remaining in output buffer can't be sent since handleWrite is not being called. \nSo is the above usage wrong?</p>\n\n<p>According man 7 epoll QA:</p>\n\n<blockquote>\n  <ol start=\"7\">\n  <li><p>If more than one event occurs between epoll_wait(2) calls, are\n         they combined or reported separately?</p>\n  \n  <p>They will be combined.</p></li>\n  </ol>\n</blockquote>\n\n<p>If i got it right, several events can occur on a single file descriptor between epoll_wait calls. So I think I should use multiple \"if if and if\" to check on by one whether readable/writable/error events occur instead of using \"if and else if\". I went to see how nginx epoll module do, from <a href=\"https://github.com/nginx/nginx/blob/953f53921505a884f3912f2d8db5217a71c0479a/src/event/modules/ngx_epoll_module.c#L867\" rel=\"nofollow noreferrer\">https://github.com/nginx/nginx/blob/953f53921505a884f3912f2d8db5217a71c0479a/src/event/modules/ngx_epoll_module.c#L867</a> I see the following code:</p>\n\n<pre><code>    if (revents &amp; (EPOLLERR|EPOLLHUP)) {\n        //...\n    }\n    if ((revents &amp; EPOLLIN) &amp;&amp; rev-&gt;active) {\n        //....\n        rev-&gt;handler(rev);\n    }\n    if ((revents &amp; EPOLLOUT) &amp;&amp; wev-&gt;active) {\n        //....\n        wev-&gt;handler(wev);\n    }\n</code></pre>\n\n<p>It seems to adhere to my thoughts of checking all EPOLLERR..,EPOLLIN,EPOLLOUT events one after another.\nThen I do the same kind of thing as nginx do in my application. But What I realized after experiment is: if I add the file descriptor to epoll with EPOLLIN|EPOLLOUT|EPOLLET flag, and I didn't fill up the output buffer, I will always get EPOLLOUT flag set after epoll_wait returns due to some data arrives and this fd becomes readable, therefore redundant write_handler would be called, which is not what I expect.</p>\n\n<p>I did some search and found that this situation indeed exists and not caused by any bug in my application. According to the top voted answer at <a href=\"https://stackoverflow.com/questions/12892286/epoll-with-edge-triggered-event\">epoll with edge triggered event</a> says:</p>\n\n<blockquote>\n  <p>On a somewhat related note: if you register for EPOLLIN and EPOLLOUT events and assuming you never fill up the send buffer, you still get the EPOLLOUT flag set in the event returned by epoll_wait each time EPOLLIN is triggered - see <a href=\"https://lkml.org/lkml/2011/11/17/234\" rel=\"nofollow noreferrer\">https://lkml.org/lkml/2011/11/17/234</a> for a more detailed explanation.</p>\n</blockquote>\n\n<p>And the link in this answer says:</p>\n\n<blockquote>\n  <p>It's doesn't mean there's an EPOLLOUT \"event\", it just means a message\n  is triggered (by the socket becoming readable) so you get a status\n  update.  In theory the program doesn't need to be told about EPOLLOUT\n  here (it should be assuming the socket is writable already), but it\n  doesn't do any harm.</p>\n</blockquote>\n\n<p>So far What I understand about epoll <strong>edge trigger</strong> mode is:</p>\n\n<ul>\n<li><p>the epoll_wait return when the state of any fd being monitored has changed, e.g from nothing to read -> readable or buffer is full-> buffer can write</p></li>\n<li><p>the epoll_wait may return one or several event(flags) for each fd in the ready list. </p></li>\n<li><p>the flags in sturct epoll_event.events field indicate the current state of this fd. Even if we don't fill out the output buffer, the EPOLLOUT flag would be set when epoll_wait return due to readable, because the current state of the fd is just writable.</p></li>\n</ul>\n\n<p>Please correct me if I am wrong.\nThen my question would be: Should I maintain a flag in each connection to indicate whether EAGAIN occurs when write to output buffer, if it is not set, don't call write_handler/handleWrite in \"if (events &amp; EPOLLOUT)\" branch, so that my upper layer program would not be told about EPOLLOUT here?</p>\n"}, {"tags": ["c", "function", "pointers", "math"], "comments": [{"owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 0, "creation_date": 1576076425, "post_id": 59288492, "comment_id": 104782120, "body": "One issue with your code is your naming conventions. Don&#39;t give your functions and variables the same name."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1576076513, "post_id": 59288492, "comment_id": 104782164, "body": "<code>return 1;</code> and <code>return 0;</code>?  A <code>void</code> function can not return values of any type."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1576078337, "post_id": 59288492, "comment_id": 104783280, "body": "And from now on, turn warnings of your compiler on!"}], "answers": [{"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1576076558, "post_id": 59288550, "comment_id": 104782191, "body": "...and to turn warnings of the compiler on. (Any question/error that could have been prevented if warnings were turned on should be punishable with a downvote of the question)"}, {"owner": {"reputation": 41, "user_id": 12480417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d13124e4341a8c5e11e18a6bbb4d44?s=128&d=identicon&r=PG&f=1", "display_name": "ConfusedChicken4", "link": "https://stackoverflow.com/users/12480417/confusedchicken4"}, "edited": false, "score": 0, "creation_date": 1576076706, "post_id": 59288550, "comment_id": 104782261, "body": "The code does not return errors tho, if I for example remove a &quot;;&quot; I would get and error/warning"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1576076732, "post_id": 59288550, "comment_id": 104782279, "body": "@PaulOgilvie: Although it wouldn&#39;t be the first time that a school used a C compiler from the 1970s."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1576076894, "last_edit_date": 1576076894, "creation_date": 1576076293, "answer_id": 59288550, "question_id": 59288492, "link": "https://stackoverflow.com/questions/59288492/pointers-and-functions-for-calculating-the-squareroot-of-a-number-in-c/59288550#59288550", "title": "Pointers and functions for calculating the squareroot of a number in C", "body": "<p><code>squareRoot</code> is the address of the function, not any particular return value of the function. Didn't your compiler warn of you of this in any way? The fact that it apparently compiles a <code>void</code> function with integral return values is a concern too. Perhaps now might be a good time to (i) see if you can get the compiler to warn you of such things, or (ii) convince your school to upgrade to a newer one. Like love and nature, excellent C compilers are available for free.</p>\n\n<p>The address of the function is not allowed to be 0 by the C standard (ignore this technicality for now), and it's very likely not 1 either, hence neither <code>if</code> statement conditional evaluates to 1, and this accounts for the lack of output.</p>\n\n<p>Your best bet is to perform the validation check on the input <code>n1</code> <em>before</em> attempting to evaluate the square root. Don't forget to check the return value of <code>scanf_s</code> too - it should be 1 if a <code>float</code> value was read successfully from standard input.</p>\n"}, {"comments": [{"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1576076581, "post_id": 59288632, "comment_id": 104782201, "body": "<code>squareRoot</code> is declared <code>void</code>.  It cannot return values."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1576076657, "post_id": 59288632, "comment_id": 104782238, "body": "@abelenky Yes, it missed that at first.  Fixed."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1576076982, "last_edit_date": 1576076982, "creation_date": 1576076534, "answer_id": 59288632, "question_id": 59288492, "link": "https://stackoverflow.com/questions/59288492/pointers-and-functions-for-calculating-the-squareroot-of-a-number-in-c/59288632#59288632", "title": "Pointers and functions for calculating the squareroot of a number in C", "body": "<p>You're not checking the right thing:</p>\n\n<pre><code>squareRoot(n1, &amp;squareRootResult);\n\nif (squareRoot == 1) \n{\n    printf(\"The squareroot of the entered number is: %f\", squareRootResult);\n}\nelse if (squareRoot == 0)\n{\n    printf(\"It is not possible to calculate thesquare root of a negative number\u200b\");\n}\n</code></pre>\n\n<p><code>squareRoot</code> is the actual function, not the return value.  What you're actually doing is checking if the function's pointer is 1 or 0.</p>\n\n<p>You need to assign the return value of the function a another variable and check that.</p>\n\n<pre><code>int rval = squareRoot(n1, &amp;squareRootResult);\n\nif (rval == 1) \n{\n    printf(\"The squareroot of the entered number is: %f\", squareRootResult);\n}\nelse if (rval == 0)\n{\n    printf(\"It is not possible to calculate thesquare root of a negative number\u200b\");\n}\n</code></pre>\n\n<p>Also, you need to change the definition of <code>squareRoot</code>:</p>\n\n<pre><code>void squareRoot(float number1, float *squareroot)\n</code></pre>\n\n<p>In the function you attempt to return a value but the function is declared to not return anything.  You need to set the return type to <code>int</code>:</p>\n\n<pre><code>int squareRoot(float number1, float *squareroot)\n</code></pre>\n\n<p>Finally, your <code>squareRoot</code> function doesn't handle the case where <code>number1</code> is 0 and will fail to return a value.  This can be fixed by changing this:</p>\n\n<pre><code>if (number1 &gt; 0)\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>if (number1 &gt;= 0)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 12480417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d13124e4341a8c5e11e18a6bbb4d44?s=128&d=identicon&r=PG&f=1", "display_name": "ConfusedChicken4", "link": "https://stackoverflow.com/users/12480417/confusedchicken4"}, "edited": false, "score": 0, "creation_date": 1576076869, "post_id": 59288633, "comment_id": 104782355, "body": "Changed that, as you said I asked myself how something that returns nothing would be able to return an int. Thanks"}, {"owner": {"reputation": 41, "user_id": 12480417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d13124e4341a8c5e11e18a6bbb4d44?s=128&d=identicon&r=PG&f=1", "display_name": "ConfusedChicken4", "link": "https://stackoverflow.com/users/12480417/confusedchicken4"}, "edited": false, "score": 0, "creation_date": 1576077195, "post_id": 59288633, "comment_id": 104782547, "body": "Tried to run the code after I added/changed what you said and the program now works. Thanks :D"}], "tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": true, "score": 2, "last_activity_date": 1576076953, "last_edit_date": 1576076953, "creation_date": 1576076536, "answer_id": 59288633, "question_id": 59288492, "link": "https://stackoverflow.com/questions/59288492/pointers-and-functions-for-calculating-the-squareroot-of-a-number-in-c/59288633#59288633", "title": "Pointers and functions for calculating the squareroot of a number in C", "body": "<p>There are many problems in here, starting with:</p>\n\n<p>You declared the function <code>squareRoot</code> to return <code>void</code> (ie: <strong><em>nothing</em></strong>).</p>\n\n<p>Then you try to return integers:</p>\n\n<pre><code>{ ...return 1;.... return 0;  }\n</code></pre>\n\n<p>Ask yourself how a function that returns nothing should return an <code>int</code> of <code>1</code> or <code>0</code>.</p>\n\n<hr>\n\n<h3>Fixup:</h3>\n\n<pre><code>// Change return value to int\nint squareRoot(float number1, float *squareroot)\n{  [....] }\n\nint main(void)\n{\n    [...]\n\n    // Declare a variable to hold the return value.\n    int retValue;\n    float squareRootResult;\n\n    // Put the return value in variable retValue\n    retValue = squareRoot(n1, &amp;squareRootResult);\n\n    // Check the value that was returned!\n    if (retValue == 1)\n    {\n        printf(\"The squareroot of the entered number is: %f\", squareRootResult);\n    }\n    else if (retValue == 0)\n    {\n        printf(\"It is not possible to calculate thesquare root of a negative number\u200b\");\n    }\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 12480417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d13124e4341a8c5e11e18a6bbb4d44?s=128&d=identicon&r=PG&f=1", "display_name": "ConfusedChicken4", "link": "https://stackoverflow.com/users/12480417/confusedchicken4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 810, "favorite_count": 0, "accepted_answer_id": 59288633, "answer_count": 3, "score": 0, "last_activity_date": 1576077110, "creation_date": 1576076133, "question_id": 59288492, "link": "https://stackoverflow.com/questions/59288492/pointers-and-functions-for-calculating-the-squareroot-of-a-number-in-c", "title": "Pointers and functions for calculating the squareroot of a number in C", "body": "<p>Currently working on an school assignment that requires us to write a program that takes user input. As long as the input is positive the squareroot should be calculated, but if the input is negative the squareroot should not be calculated and the program shall print out a message telling the user that its not possible to calculate the squareroot if a negative number.</p>\n\n<p>Quote from the assignment: </p>\n\n<p>\"If \u200bnumber\u200b is non-negative, the function should calculate the square root and place theresult in the pointer argument and return the value 1.If \u200bnumber\u200b is negative the function should \u200bnot\u200b calculate the square root at all, but insteadonly return the value 0.\"</p>\n\n<p>Here is what i have so far, but when ever I've entered a number the program just shuts down as if it's finished the task but it does not print out anything, help is appriciated. (First programming course i take)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nvoid squareRoot(float number1, float *squareroot)\n{\n\n\n    if (number1 &gt; 0)\n    {\n        *squareroot = sqrt(number1);\n        return 1;\n    }\n    else if (number1 &lt; 0)\n    {\n        return 0;\n    }\n}\nint main(void)\n{\n    float n1;\n    printf(\"Enter a number to calculate the squareroot of the number: \");\n    scanf_s(\"%f\", &amp;n1);\n\n    float squareRootResult;\n    squareRoot(n1, &amp;squareRootResult);\n\n    if (squareRoot == 1) \n    {\n        printf(\"The squareroot of the entered number is: %f\", squareRootResult);\n    }\n    else if (squareRoot == 0)\n    {\n        printf(\"It is not possible to calculate thesquare root of a negative number\u200b\");\n    }\n\n\n    return 0;\n}\n\n</code></pre>\n"}, {"tags": ["c", "opengl"], "answers": [{"comments": [{"owner": {"reputation": 979, "user_id": 10311873, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-U6bx1OxX8qs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNd_9-45wwusxC1gms2M0Q8UEE1AA/mo/photo.jpg?sz=128", "display_name": "Irbis", "link": "https://stackoverflow.com/users/10311873/irbis"}, "edited": false, "score": 0, "creation_date": 1576077511, "post_id": 59288687, "comment_id": 104782735, "body": "Could you please explain how memory mapping works for such scenario ? Let&#39;s assume that I have 32 bit process with 2GB memory limit. Some amount of the process memory is initially reserved by the opengl driver. Due to memory fragmentation I can&#39;t call malloc with a block size specified in glBufferData (it returns null). Is it possible that glMapBuffer will work somehow ?"}, {"owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "reply_to_user": {"reputation": 979, "user_id": 10311873, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-U6bx1OxX8qs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNd_9-45wwusxC1gms2M0Q8UEE1AA/mo/photo.jpg?sz=128", "display_name": "Irbis", "link": "https://stackoverflow.com/users/10311873/irbis"}, "edited": false, "score": 0, "creation_date": 1576077720, "post_id": 59288687, "comment_id": 104782862, "body": "@Irbis: If the <code>glMapBuffer</code> happens to map a piece of buffer, for that&#39;s there already a shadow buffer allocated, then all it does is return a pointer to that, and increase a reference counter; no new memory or address space must be allocated then. But if there&#39;s no contiguous region of address space left to map a new allocation or DMA region, then the mapping will fail."}, {"owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "reply_to_user": {"reputation": 979, "user_id": 10311873, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-U6bx1OxX8qs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNd_9-45wwusxC1gms2M0Q8UEE1AA/mo/photo.jpg?sz=128", "display_name": "Irbis", "link": "https://stackoverflow.com/users/10311873/irbis"}, "edited": false, "score": 0, "creation_date": 1576077857, "post_id": 59288687, "comment_id": 104782965, "body": "However if your program suffers from heavy memory fragmentation, you&#39;re doing &quot;something&quot; wrong. Normal malloc should operate from a preallocated buffer region. Could it, by perchance be, that you&#39;re creating lots of small OpenGL buffer objects? One for each piece of geometry you want to draw? If so, don&#39;t do that. Allocate a large buffer object from which you slice subsets for your data, and use appropriate offsets when setting the vertex attribute pointers."}, {"owner": {"reputation": 979, "user_id": 10311873, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-U6bx1OxX8qs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNd_9-45wwusxC1gms2M0Q8UEE1AA/mo/photo.jpg?sz=128", "display_name": "Irbis", "link": "https://stackoverflow.com/users/10311873/irbis"}, "edited": false, "score": 0, "creation_date": 1576077991, "post_id": 59288687, "comment_id": 104783065, "body": "So the memory mapping takes place in the 2GB memory which is available for the process or glMapBuffer may return a pointer to the memory which is located outside the process ?"}, {"owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "reply_to_user": {"reputation": 979, "user_id": 10311873, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-U6bx1OxX8qs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNd_9-45wwusxC1gms2M0Q8UEE1AA/mo/photo.jpg?sz=128", "display_name": "Irbis", "link": "https://stackoverflow.com/users/10311873/irbis"}, "edited": false, "score": 2, "creation_date": 1576080499, "post_id": 59288687, "comment_id": 104784553, "body": "@Irbis: Of course any mapping must take place inside the address space of the process. How do you imagine would a pointer of limited size be able to point outside of the value range it can take on. A process address space is literally just an enumeration of all bytes from 0 to <code>${WHATEVER_THE_MAXIMUM_VALUE_OF_A_POINTER_IS}</code>. There are no &quot;magic&quot; pointers of &quot;imaginary&quot; numbers, that are capable to point into wonderland."}], "tags": [], "owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "is_accepted": true, "score": 3, "last_activity_date": 1576076763, "creation_date": 1576076763, "answer_id": 59288687, "question_id": 59288424, "link": "https://stackoverflow.com/questions/59288424/glmapbuffer-and-malloc/59288687#59288687", "title": "glMapBuffer and malloc", "body": "<p>The specific details on how glMapBuffer works are left open to the OpenGL implementation being used. It may, or may not use an additional shadow allocation.</p>\n\n<p>However you must be careful about interpreting the number reported by Windows' \"Task Manager\": The number it reports in plain sight is the amount of address space allocated, not the actual amount of memory being used; the later can be much, much smaller.</p>\n\n<blockquote>\n  <p>Does glMapBuffer may also use a memory mapping for the above scenario (GL_WRTIE_ONLY)?</p>\n</blockquote>\n\n<p>Yes of course.</p>\n"}], "owner": {"reputation": 979, "user_id": 10311873, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-U6bx1OxX8qs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNd_9-45wwusxC1gms2M0Q8UEE1AA/mo/photo.jpg?sz=128", "display_name": "Irbis", "link": "https://stackoverflow.com/users/10311873/irbis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 59288687, "answer_count": 1, "score": 0, "last_activity_date": 1576076763, "creation_date": 1576075918, "question_id": 59288424, "link": "https://stackoverflow.com/questions/59288424/glmapbuffer-and-malloc", "title": "glMapBuffer and malloc", "body": "<p>Here is an example code: </p>\n\n<pre><code>glBindBuffer(GL_PIXEL_UNPACK_BUFFER, pboId[pboCounter]);\nglBufferData(GL_PIXEL_UNPACK_BUFFER, dataSize, 0, GL_STREAM_DRAW);\nGLubyte* p = (GLubyte*)glMapBuffer(GL_PIXEL_UNPACK_BUFFER, GL_WRITE_ONLY);\nglUnmapBuffer(GL_PIXEL_UNPACK_BUFFER);\nglBindBuffer(GL_PIXEL_UNPACK_BUFFER, 0);\n</code></pre>\n\n<p>I have noticed that task manager(windows 10) shows increased memory usage after glMapBuffer call. I have read that glMapBuffer may use malloc or \"memory mapping\" ? It it an evidence that malloc has been used ? Does glMapBuffer may also use a memory mapping for the above scenario (GL_WRTIE_ONLY) ? </p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 1, "creation_date": 1576076018, "post_id": 59288362, "comment_id": 104781880, "body": "The C language itself defines that <code>p[i]</code> and <code>*(p + i)</code> are <i>exactly</i> identical and interchangeable with each other; whatever alignment concerns there are work the same way either way."}, {"owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 0, "creation_date": 1576076073, "post_id": 59288362, "comment_id": 104781911, "body": "* and [] is the same depending on the type of pointer it is. For instance if the pointer is of type <code>int</code> then <code>pointer[1]</code> is <code>sizeof(int)</code> passed the first index. Likewise <code>*(pointer+1)</code> is also <code>sizeof(int)</code> passed the first index. And I&#39;m not exactly sure how you&#39;re checking the memory isn&#39;t alligned. If you want to target a specific byte after index 0 you can cast it to char then add your offset."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1576076822, "post_id": 59288362, "comment_id": 104782328, "body": "When you say &quot;aligned&quot; do you really mean <a href=\"https://www.dictionary.com/browse/adjacent\" rel=\"nofollow noreferrer\">&quot;adjacent&quot;</a>?"}, {"owner": {"reputation": 2255, "user_id": 1036082, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a291efdfec6f8802d64589cd992131fb?s=128&d=identicon&r=PG", "display_name": "\u0141ukasz Przenios\u0142o", "link": "https://stackoverflow.com/users/1036082/%c5%81ukasz-przenios%c5%82o"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1576077942, "post_id": 59288362, "comment_id": 104783017, "body": "@Someprogrammerdude indeed. Fixed, thank you."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1576076102, "creation_date": 1576076102, "answer_id": 59288481, "question_id": 59288362, "link": "https://stackoverflow.com/questions/59288362/pointers-dereferencing-differences-between-and/59288481#59288481", "title": "Pointers dereferencing differences between [] and *", "body": "<p>The two methods are exactly equivalent.  Section 6.5.2.1p2 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a> regarding array subscripting states:</p>\n\n<blockquote>\n  <p>A postfix expression followed by an expression in square brackets <code>[]</code>\n  is a subscripted designation of an element of an array object. The\n  definition of the subscript operator <code>[]</code> is that <code>E1[E2]</code> is identical to\n  <code>(*((E1)+(E2)))</code>. Because of the conversion rules that apply to the\n  binary <code>+</code> operator, if <code>E1</code> is an array object (equivalently, a pointer\n  to the initial element of an array object) and <code>E2</code> is an integer,\n  <code>E1[E2]</code> designates the <code>E2</code>-th element of <code>E1</code> (counting from zero).</p>\n</blockquote>\n\n<p>The fact that you have a pointer-to-pointer, where each pointer points to a distinct array, as opposed to a true 2D array doesn't change this.</p>\n"}], "owner": {"reputation": 2255, "user_id": 1036082, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a291efdfec6f8802d64589cd992131fb?s=128&d=identicon&r=PG", "display_name": "\u0141ukasz Przenios\u0142o", "link": "https://stackoverflow.com/users/1036082/%c5%81ukasz-przenios%c5%82o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 59288481, "answer_count": 1, "score": 0, "last_activity_date": 1576108518, "creation_date": 1576075716, "last_edit_date": 1576108518, "question_id": 59288362, "link": "https://stackoverflow.com/questions/59288362/pointers-dereferencing-differences-between-and", "title": "Pointers dereferencing differences between [] and *", "body": "<p>I have come across an opinion that in case we have a pointer to a pointer, we can dereference it via <code>[][]</code> in case the allocated memory is adjacent. In case its not, only dereferencing via pointers arithmetic can be used. But I cannot quite reproduce that situation, i.e. here is an example code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define ITEMS_NO    3\n#define LETTERS_NO  4\n\nint main(void)\n{\n    char* theArray[ITEMS_NO];\n    char* dummyArr[ITEMS_NO];\n\n    for (int i = 0; i &lt; ITEMS_NO; ++i)\n    {\n        theArray[i] = malloc(LETTERS_NO);\n        dummyArr[i] = malloc(LETTERS_NO); // make sure mem is not adjecent\n\n        for (int k = 0; k &lt; LETTERS_NO - 1; ++k)\n        {\n            theArray[i][k] = '0' + i;\n            dummyArr[i][k] = 'z';\n        }\n\n        theArray[i][LETTERS_NO - 1] = 0;\n        dummyArr[i][LETTERS_NO - 1] = 0;\n    }\n\n    for (int i = 0; i &lt; ITEMS_NO; ++i)\n    {\n        printf(\"item by square bracket %i = %c \\n\", i, theArray[i][1]);\n        printf(\"item by ptr %i = %c \\n\", i, *((*(theArray + i)) + 1));\n        free(theArray[i]);\n        free(dummyArr[i]);\n    }\n}\n</code></pre>\n\n<p>In this example i allocate the <code>dummyArr</code> in order to make sure that the allocated memory for the <code>theArray</code> is not adjacentnext to each other. Both <code>printf</code> calls give the same results. Am I not getting something here or do both dereferencing methods work exactly the same way?</p>\n"}, {"tags": ["c++", "c", "googletest", "automake"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 2, "creation_date": 1576075427, "post_id": 59287962, "comment_id": 104781570, "body": "I do not understand why the close vote.  Although I am not  <code>C++</code> conversant (and so cannot answer), this question appears to be well researched, well presented and includes clear problem statement.  And in case the close voter checks back, please leave a comment letting OP know how to fix problem.  And IMO, <i>This question does not appear to be about programming within the scope defined in the help center.</i> does not describe this post in the least."}], "answers": [{"tags": [], "owner": {"reputation": 848, "user_id": 3087555, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/fe453dd9d1b38e7fcc19dc5f71e3cc4a?s=128&d=identicon&r=PG&f=1", "display_name": "ZeppRock", "link": "https://stackoverflow.com/users/3087555/zepprock"}, "is_accepted": true, "score": 1, "last_activity_date": 1576138753, "creation_date": 1576138753, "answer_id": 59300287, "question_id": 59287962, "link": "https://stackoverflow.com/questions/59287962/fff-fake-function-with-google-test/59300287#59300287", "title": "FFF fake function with google test", "body": "<p>I have a solution but I'm not sure if it's the best one.</p>\n\n<p>When I compile my library I want to test it generates <code>.o</code> files for every <code>.c</code> file I have. As I only want to test <code>libmylib.c</code> I linked only <code>libmylib_la-libmylib.o</code> instead of the <code>.la</code> file.</p>\n\n<p>The generated <code>.o</code> files in <code>src/libmylib/</code> were:</p>\n\n<pre><code>libmylib_la-libmylib.o\nlibmylib_la-private_functions.o\n</code></pre>\n\n<p>My updated <code>MakeFile.am</code> in <code>./test/libmylib_test/</code> looks like this now:</p>\n\n<pre><code>LIBSRC = $(top_srcdir)/src/libstorage\n\ncheck_PROGRAMS = libmylib_test\nlibstorage_test_SOURCES = test.cc\nlibstorage_test_CFLAGS = $(AM_CFLAGS)\nlibstorage_test_CXXFLAGS = -I$(top_srcdir)/include -I$(LIBSRC) -std=c++11 $(AM_CPPFLAGS)\nlibstorage_test_LDFLAGS = $(AM_LDFLAGS) -static -pthread\nlibstorage_test_LDADD = $(top_srcdir)/src/libmylib/libmylib_la-libmylib.o\n</code></pre>\n\n<p>As I had another function in the <code>private_functions.h</code> I had to mock that one too because it was not defined elsewhere.</p>\n\n<p>After these updates the tests compiled without problems and ran fine. </p>\n\n<p>Test file now looks like this:</p>\n\n<pre><code>#include \"gtest/gtest.h\"\n#include \"public_header.h\"\n#include \"fff.h\"\n\nextern \"C\" {\n    #include \"private_functions.h\"\n}\n\nDEFINE_FFF_GLOBALS;\n\nFAKE_VALUE_FUNC(int, function, char *, char *);\nFAKE_VOID_FUNC(other_func, char *);\n...\n</code></pre>\n"}], "owner": {"reputation": 848, "user_id": 3087555, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/fe453dd9d1b38e7fcc19dc5f71e3cc4a?s=128&d=identicon&r=PG&f=1", "display_name": "ZeppRock", "link": "https://stackoverflow.com/users/3087555/zepprock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1073, "favorite_count": 0, "accepted_answer_id": 59300287, "answer_count": 1, "score": 3, "last_activity_date": 1576138753, "creation_date": 1576074369, "question_id": 59287962, "link": "https://stackoverflow.com/questions/59287962/fff-fake-function-with-google-test", "title": "FFF fake function with google test", "body": "<p>I am trying to test my C library with google test but I'm having trouble mocking functions with the <code>fff.h</code> framework. This is my file structure:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 Makefile.am\n\u251c\u2500\u2500 configure.ac\n\u251c\u2500\u2500 include\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Makefile.am\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 public_header.h\n\u251c\u2500\u2500 src\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 libmylib\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 Makefile.am\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 private_functions.c\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 private_functions.h\n\u2502       \u251c\u2500\u2500 libmylib.la\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 libmylib.c\n\u2514\u2500\u2500 test\n    \u2514\u2500\u2500 libmylib_test\n        \u251c\u2500\u2500 Makefile.am\n        \u251c\u2500\u2500 fff.h\n        \u2514\u2500\u2500 test.cc\n</code></pre>\n\n<p>I want to mock a function from the header <code>private_functions.h</code> which is used in a function from the <code>public_header.h</code> using the <code>fff.h</code> framework.</p>\n\n<pre><code>public_function()\n{\n        private_function(); //This function is the one I want to mock.\n}\n</code></pre>\n\n<p>My test looks like this:</p>\n\n<pre><code>#include \"gtest/gtest.h\"\n#include \"public_header.h\"\n#include \"fff.h\"\n\nextern \"C\" {\n    #include \"private_functions.h\"\n}\n\nDEFINE_FFF_GLOBALS;\n\nFAKE_VALUE_FUNC(int, function, char *, char *);\n\nclass libtest : public testing::Test\n{\npublic:       \n    virtual void SetUp()\n    {\n        RESET_FAKE(function);\n    }\n\n    virtual void TearDown()\n    {\n    }\n};\n\nTEST_F(libtest, test_fff)\n{\n    public_function(\"val1\", \"val2\");\n    EXPECT_EQ(function_fake.call_count, 1);\n}\n...\n</code></pre>\n\n<p>When I run make it says that the <code>private_function()</code> is defined multiple times. </p>\n\n<p>My <code>test/libmylib_test/MakeFile.am</code> looks like this:</p>\n\n<pre><code>LIBSRC = $(top_srcdir)/src/libstorage\n\ncheck_PROGRAMS = libmylib_test\nlibstorage_test_SOURCES = test.cc\nlibstorage_test_CFLAGS = $(AM_CFLAGS)\nlibstorage_test_CXXFLAGS = -I$(top_srcdir)/include -I$(LIBSRC) -std=c++11 $(AM_CPPFLAGS)\nlibstorage_test_LDFLAGS = $(AM_LDFLAGS) -static -pthread\nlibstorage_test_LDADD = $(top_srcdir)/src/libmylib/libmylib.la\n</code></pre>\n"}, {"tags": ["c", "windows", "printf"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 3, "creation_date": 1576074279, "post_id": 59287900, "comment_id": 104780891, "body": "Although this is not the issue here, the second argument to <code>snprintf()</code> should be <code>sizeof(cmd)</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1576074312, "post_id": 59287900, "comment_id": 104780918, "body": "The size (second) argument to <a href=\"https://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\"><code>snprintf</code></a> is the size of the <i>destination buffer</i>, typically something like <code>sizeof cmd</code> (in your case)."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1576074385, "post_id": 59287900, "comment_id": 104780964, "body": "@ctx <code>sizeof(cmd)&#47;sizeof(cmd[0])</code> always better. It doesn&#39;t matter in this case but... ;)"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1576074488, "post_id": 59287900, "comment_id": 104781020, "body": "@LPs Hm, for array sizes in terms of number of elements in general, you are right, but I cannot imagine a situation where this might do anything good with <code>snprintf()</code> or string functions in general... However, it works of course"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1576074521, "post_id": 59287900, "comment_id": 104781035, "body": "@LPs: Absolutely not for something that takes a size in <i>bytes</i>, like <code>snprintf</code>."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1576074755, "post_id": 59287900, "comment_id": 104781169, "body": "@FredLarson Only my opinion: &quot;teaching&quot; OP to use that semantic to avoid problem in future..."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1576074846, "post_id": 59287900, "comment_id": 104781221, "body": "@LPs: And run headlong into other problems."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1576075480, "post_id": 59287900, "comment_id": 104781604, "body": "While it&#39;s normally discouraged to have images of text, this is a good example of a question where a screenshot of the console window would help. Please take a screenshot of the &quot;completely broken&quot; console window and edit your question to include it. And while editing your question, please include a proper <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, as well as tell us the exact arguments you pass to your program (or perhaps even hardcode the value of <code>argv[1]</code>)."}, {"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 0, "creation_date": 1576075490, "post_id": 59287900, "comment_id": 104781608, "body": "Fomr a C perspective, I think the variable <code>cmd</code>cannot be modified by the call to <code>system</code>, whatever this function is doing. You can confirm by printing the address of <code>cmd</code>, in addition to its content. Is <code>cmd</code>on the stack ?"}, {"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 0, "creation_date": 1576075678, "post_id": 59287900, "comment_id": 104781707, "body": "Might be a subtlety of Windows printf buffering ? try to add a <code>fflush</code>in between <code>printf</code>"}, {"owner": {"reputation": 330, "user_id": 7812564, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/d25007809f953a1bdbdafa12ccb3d917?s=128&d=identicon&r=PG&f=1", "display_name": "Luigi", "link": "https://stackoverflow.com/users/7812564/luigi"}, "edited": false, "score": 0, "creation_date": 1576138612, "post_id": 59287900, "comment_id": 104803570, "body": "Thank you for the feedback, i thought that snprintf length was about the length of data one wants to write. cmd has a fixed length which is the maximum allowed size. According to the info i found online &quot;size&quot; is the maximum number of bytes(characters) that will be written to the buffer so in my case 12 should be the correct number and not sizeof(cmd), am i wrong?"}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1576079188, "last_edit_date": 1576079188, "creation_date": 1576078069, "answer_id": 59289088, "question_id": 59287900, "link": "https://stackoverflow.com/questions/59287900/printf-unexpected-behaviour-when-printing-after-system-call/59289088#59289088", "title": "printf unexpected behaviour when printing after System() call", "body": "<ul>\n<li>One problem: off-by-one</li>\n</ul>\n\n<p><code>strlen(argv[1]) + 12</code> is the expected <em>length</em> of the output, yet it is the needed <em>size</em> that should be passed to <code>snprintf()</code> - a plus one is needed.  Current code is certain to lop off the last character <code>'\\\"'</code> in printing to <code>cmd</code>.</p>\n\n<pre><code>//                                   12345678901   2\nsnprintf(cmd, strlen(argv[1]) + 12, \"@RD /S /Q \\\"%s\\\"\", argv[1]);\n// better\nsnprintf(cmd, strlen(argv[1]) + 12 + 1, \"@RD /S /Q \\\"%s\\\"\", argv[1]);\n</code></pre>\n\n<p>This does not well explain the <code>\\0x041f</code>, perhaps <a href=\"https://unicode-search.net/unicode-namesearch.pl?term=U%2B041F\" rel=\"nofollow noreferrer\">\u041f</a>, at the end of OP's output, yet is certainly a problem.</p>\n\n<hr>\n\n<ul>\n<li><p>Correct to use size of <code>cmd</code> and best to test result before doing a system command with a potentially truncated string.</p>\n\n<pre><code>int len = snprintf(cmd, sizeof cmd, \"@RD /S /Q \\\"%s\\\"\", argv[1]);\nif (len &lt; 0 || (unsigned) len &gt;= sizeof cmd) {\n  fprintf(stderr, \"Forming `cmd` failed\\n\");\n} else {\n  printf(\"cmd: %s\\r\\n\", cmd);\n  system(cmd);\n}\n</code></pre></li>\n</ul>\n\n<hr>\n\n<p>Other issue may exist in the unposted code.</p>\n"}], "owner": {"reputation": 330, "user_id": 7812564, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/d25007809f953a1bdbdafa12ccb3d917?s=128&d=identicon&r=PG&f=1", "display_name": "Luigi", "link": "https://stackoverflow.com/users/7812564/luigi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1576696632, "creation_date": 1576074167, "last_edit_date": 1576139805, "question_id": 59287900, "link": "https://stackoverflow.com/questions/59287900/printf-unexpected-behaviour-when-printing-after-system-call", "title": "printf unexpected behaviour when printing after System() call", "body": "<p>I have the following \"main\" function with the related console output.</p>\n\n<pre><code>argv[1] = \"C:\\\\Program Files (x86)\\\\InstallShield Installation Information\\\\0x041f.txt\"\n\nint main(int argc, char **argv){\n    if (argc &lt; 2)\n    {\n        printf(\"Please provide a file name with extension\\r\\n\");\n        return 1;\n    }\n    unsigned char buf[LEN_NORM];\n    char filename[230];\n    char ali_dirname[200];\n    char bli_dirname[200];\n\n    FILE *fp_obj, *fp_det, *fp_txt = fopen(argv[1], \"rb\");\n    //dirty?\n    *(argv[1] + strlen(argv[1]) + 1 - 5) = '\\0';\n    snprintf(ali_dirname, strlen(argv[1]) + 4, \"%s/ali\", argv[1]);\n    snprintf(bli_dirname, strlen(argv[1]) + 4, \"%s/bli\", argv[1]);\n\n    char cmd[200];\n    snprintf(cmd, strlen(argv[1]) + 12, \"@RD /S /Q \\\"%s\\\"\", argv[1]);\n    printf(\"cmd: %s\\r\\n\", cmd);\n    system(cmd);\n    printf(\"cmd: %s\\r\\n\", cmd);\n}\n</code></pre>\n\n<blockquote>\n  <p>cmd: @RD /S /Q \"C:\\Program Files (x86)\\InstallShield Installation Information\\0x041f\"</p>\n  \n  <p>The filename, directory name, or volume label syntax is incorrect.</p>\n  \n  <p>tion Information\\0x041f\"\n  iles (x86)\\InstallShield Installa</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/CxHs5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CxHs5.png\" alt=\"Console output\"></a></p>\n\n<p>As you can see after the system call the console is completely broken.\nI really cannot understand why this is happening. Any idea?</p>\n\n<p>EDIT:\nThank you for the feedback, i thought that snprintf length was about the length of data one wants to write. \"cmd\" has a fixed length which is the maximum allowed size. According to the info i found online \"size\" is the maximum number of bytes(characters) that will be written to the buffer so in my case 12 should be the correct number (i checked with the debugger and the \\\" is correctly written) and not sizeof(cmd), am i wrong? I've tried with \"12 + 1\" (4 + 1) and with \"sizeof\" in all the \"snprintf\" cases but nothing changes</p>\n\n<p>The code runs in the \"main\" (i've updated it)</p>\n\n<p>If i remove the \"System(cmd)\" call the console output is fine!</p>\n"}, {"tags": ["c++", "c", "windows", "winapi"], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 2, "last_activity_date": 1576078726, "last_edit_date": 1576078726, "creation_date": 1576078569, "answer_id": 59289219, "question_id": 59287731, "link": "https://stackoverflow.com/questions/59287731/windows-wmi-what-is-the-difference-and-order-between-win32-processstarttrace/59289219#59289219", "title": "Windows WMI - What is the difference (and order) between Win32_ProcessStartTrace and __InstanceCreationEvent?", "body": "<p><code>_InstanceCreationEvent</code> has a <code>TargetInstance</code> field, which for a new process is a <a href=\"https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-process\" rel=\"nofollow noreferrer\"><code>Win32_Process</code></a> object, which has most of the same fields (and more) that <code>Win32_ProcessStartTrace</code> provides. </p>\n"}], "owner": {"reputation": 1041, "user_id": 6583298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5xZmG.jpg?s=128&g=1", "display_name": "Norbert Boros", "link": "https://stackoverflow.com/users/6583298/norbert-boros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 1, "accepted_answer_id": 59289219, "answer_count": 1, "score": 1, "last_activity_date": 1576078726, "creation_date": 1576073663, "question_id": 59287731, "link": "https://stackoverflow.com/questions/59287731/windows-wmi-what-is-the-difference-and-order-between-win32-processstarttrace", "title": "Windows WMI - What is the difference (and order) between Win32_ProcessStartTrace and __InstanceCreationEvent?", "body": "<p>Just getting started with WMI, and I am trying to understand what is the difference between <strong>Win32_ProcessStartTrace</strong> and <strong>__InstanceCreationEvent</strong>. They both are available when a new process starts, however which one is first ?</p>\n\n<p>I have tested several examples provided by Microsoft and I cannot see any major difference like performance issues, besides the fact that one provides some useful=l information and the other does not. (or does it?)</p>\n\n<p>From the documentantion for <a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/desktop/krnlprov/win32-processstarttrace\" rel=\"nofollow noreferrer\">Win32_ProcessStartTrace</a> and <a href=\"https://docs.microsoft.com/en-us/windows/win32/wmisdk/--instancecreationevent\" rel=\"nofollow noreferrer\">__InstanceCreationEvent</a>  we can see quite a difference, as the Win32_ provides more details like ProcessID whilst __Instance does not.</p>\n\n<p>If one wants to monitor process creation effectively (asynchronously) which one of these 2 should be used ?</p>\n\n<p>Getting information about the process is a must, at least the ProcessID.</p>\n\n<p>A good explanation is much appreciated, I`m sure others are interested as well.</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1576073623, "post_id": 59287484, "comment_id": 104780508, "body": "What is the actual result?"}, {"owner": {"reputation": 1669, "user_id": 12396017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nk8xz.png?s=128&g=1", "display_name": "Maxim Sagaydachny", "link": "https://stackoverflow.com/users/12396017/maxim-sagaydachny"}, "edited": false, "score": 0, "creation_date": 1576075827, "post_id": 59287484, "comment_id": 104781787, "body": "why do you reset ringdev_len at write? I suppose your purpose would be accumulation of data, right?"}, {"owner": {"reputation": 1, "user_id": 12518732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d180819f898c5dc13eaa60f750e260d3?s=128&d=identicon&r=PG&f=1", "display_name": "MCnisz", "link": "https://stackoverflow.com/users/12518732/mcnisz"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1576092095, "post_id": 59287484, "comment_id": 104790038, "body": "@Ctx i can write and read in 1 terminal, i cant write in first terminal and read it in second"}, {"owner": {"reputation": 1, "user_id": 12518732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d180819f898c5dc13eaa60f750e260d3?s=128&d=identicon&r=PG&f=1", "display_name": "MCnisz", "link": "https://stackoverflow.com/users/12518732/mcnisz"}, "reply_to_user": {"reputation": 1669, "user_id": 12396017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nk8xz.png?s=128&g=1", "display_name": "Maxim Sagaydachny", "link": "https://stackoverflow.com/users/12396017/maxim-sagaydachny"}, "edited": false, "score": 0, "creation_date": 1576092098, "post_id": 59287484, "comment_id": 104790039, "body": "@MaximSagaydachny no, everytime you use write function the previous information should be deleted"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1576093000, "post_id": 59287484, "comment_id": 104790403, "body": "@MCnisz What is the exact result of <code>cat &#47;tmp&#47;ringdev</code>"}, {"owner": {"reputation": 1, "user_id": 12518732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d180819f898c5dc13eaa60f750e260d3?s=128&d=identicon&r=PG&f=1", "display_name": "MCnisz", "link": "https://stackoverflow.com/users/12518732/mcnisz"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1576094892, "post_id": 59287484, "comment_id": 104791307, "body": "@Ctx across 2 terminals nothing is returned from command. It outputs what I have written before only in the same terminal."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1576251237, "post_id": 59287484, "comment_id": 104850502, "body": "@MCnisz What happens if you write in both terminals and then read in both terminals?"}], "owner": {"reputation": 1, "user_id": 12518732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d180819f898c5dc13eaa60f750e260d3?s=128&d=identicon&r=PG&f=1", "display_name": "MCnisz", "link": "https://stackoverflow.com/users/12518732/mcnisz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1576074556, "creation_date": 1576072897, "last_edit_date": 1576074556, "question_id": 59287484, "link": "https://stackoverflow.com/questions/59287484/character-device-i-o-across-users", "title": "Character device I/O across users", "body": "<p>I'm learning Linux and I have the task that I can't handle. I have to create character device and make possible to read and write across users. For instance, I open first terminal and I use <code>echo 'test' &gt; /tmp/ringdev</code> (where <code>ringdev</code> is my character device). I also open second terminal and I use <code>cat /tmp/ringdev</code> and I expect that output will be <em><code>test</code></em>. I have already read some example snippets, but all of them are just about the basics which I already have.</p>\n\n<p>The question is how to read from / write to character device across users?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#define pr_fmt(fmt) \"ringdev: \" fmt\n#include &lt;linux/kernel.h&gt;\n#include &lt;linux/module.h&gt;\n#include &lt;linux/fs.h&gt;\n#include &lt;linux/miscdevice.h&gt;\n#include &lt;linux/sched.h&gt;\n#include &lt;linux/uaccess.h&gt;\n#include &lt;linux/wait.h&gt;\n#include &lt;linux/sched.h&gt;\n\n\nDECLARE_WAIT_QUEUE_HEAD(head);\n/*                                  \n * mutex used for access synchronization to buffer (ringdev_buf and ringdev_len)\n */ \nstatic struct mutex ringdev_lock;\n\n/*          \n * buffer and number of written bytes in the buffer\n */         \nstatic char ringdev_buf[4096];\nstatic size_t ringdev_len;\n\nstatic int ringdev_open(struct inode *inode, struct file *filp)\n{             \n    printk(\"device_open called \\n\");    \n    return 0;\n}\n\nstatic ssize_t ringdev_read(struct file *filp, char __user *buf, size_t count,\n        loff_t *off)\n{                                           \n    ssize_t ret = 0;\n\n     printk(\"device_read called \\n\");                  \n    /*\n     * access to ringdev_buf i ringdev_len is protected by ringdev_lock,\n     * take that lock\n     */\n\n\n    //wait_event_interruptible(head,ringdev_len!=0);\n    mutex_lock(&amp;ringdev_lock);\n\n    if (*off &gt; ringdev_len)\n        count = 0;\n    else if (count &gt;= ringdev_len - *off)\n        count = ringdev_len - *off;\n\n    /*\n     * for access to user memory special functions must be used,\n     * to copy to user memory copy_to_user must be used.\n     */\n    ret = -EFAULT;\n    if (copy_to_user(buf, ringdev_buf + *off, count))\n        goto out_unlock;\n    ret = count;\n    *off += ret;\n\nout_unlock:\n    mutex_unlock(&amp;ringdev_lock);\n    ringdev_len=0;\n    return ret;\n\n}                            \nstatic ssize_t ringdev_write(struct file *filp, const char __user *buf,\n        size_t count, loff_t *off)\n{                    \n    ssize_t ret=0;\n    ringdev_len=0;\n    printk(\"device_write called \\n\");\n    mutex_lock(&amp;ringdev_lock);\n    ret=-EFAULT;\n\n\n    if(copy_from_user(ringdev_buf+ringdev_len ,buf, count)==0){\n        ringdev_len= ringdev_len + count;\n        ret=count;\n        wake_up_interruptible(&amp;head);\n        goto out_unlock;\n    }\n    else{\n      ret=-ENOSPC;\n    }\n    /*\n     * not supported yet. Do not forget about copy_from_user().\n     */\n\nout_unlock:\n    mutex_unlock(&amp;ringdev_lock);\n    return ret;\n\n}\n\nstatic int ringdev_release(struct inode *inode, struct file *filp)\n{                                      \n    mutex_unlock(&amp;ringdev_lock);\n    printk(\"device_release called \\n\");\n    return 0;\n}\n\nstatic const struct file_operations ringdev_fops = {\n    .owner = THIS_MODULE,\n    .open = ringdev_open,\n    .read = ringdev_read,\n    .write = ringdev_write,\n    .release = ringdev_release,\n};\n\nstatic struct miscdevice ringdev_miscdevice = {\n    .minor = MISC_DYNAMIC_MINOR,\n    .name = \"ringdev\",\n    .fops = &amp;ringdev_fops\n};\n\nstatic int __init ringdev_init(void)\n{                                         \n    int ret;\n\n    mutex_init(&amp;ringdev_lock);\n\n    ret = misc_register(&amp;ringdev_miscdevice);\n    if (ret &lt; 0) {\n        pr_err(\"can't register miscdevice.\\n\");\n        return ret;\n    }\n\n    pr_info(\"minor %d\\n\", ringdev_miscdevice.minor);\n\n    return 0;\n}\n\nstatic void __exit ringdev_exit(void)\n{                                                       \n    misc_deregister(&amp;ringdev_miscdevice);\n    mutex_destroy(&amp;ringdev_lock);\n}\n\nmodule_init(ringdev_init);\nmodule_exit(ringdev_exit);\n\nMODULE_DESCRIPTION(\"Device\");\nMODULE_AUTHOR(\"xxx\");\nMODULE_LICENSE(\"GPL\");\n</code></pre>\n"}, {"tags": ["c", "gcc", "error-handling", "io", "stack-smash"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1576072536, "post_id": 59287338, "comment_id": 104779929, "body": "A good ideom is to use <code>fgets(line, sizeof(line), fp);</code> if <code>line</code> is an array (does not work if it is a pointer). Then it cannot write out of bounds because the specified size does not correspond to the array size."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1576072610, "post_id": 59287338, "comment_id": 104779972, "body": "Please read <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1576072695, "post_id": 59287338, "comment_id": 104780017, "body": "Lastly, C doesn&#39;t have any kind of bounds checking. Going out of bounds leads to <i>undefined behavior</i>, so just don&#39;t do it."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 4, "creation_date": 1576072881, "post_id": 59287338, "comment_id": 104780125, "body": "What&#39;s the declaration of <code>line</code>? Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1576073388, "post_id": 59287338, "comment_id": 104780384, "body": "If you see &quot;stack smashing detected&quot; this usually means you write beyond the end of a locally declared array."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 1, "creation_date": 1576094230, "post_id": 59287338, "comment_id": 104790987, "body": "@ryyker: Well, that certainly removes any question that might have lingered about buffer overflow, doesn&#39;t it?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1576094611, "post_id": 59287338, "comment_id": 104791176, "body": "@FredLarson -  no doubts at all"}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 12048128, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDXj9YnLcP-qdWits_MNLcG8XQdOgYHv_Gd36dE=k-s128", "display_name": "Pierpaolo Vesce", "link": "https://stackoverflow.com/users/12048128/pierpaolo-vesce"}, "edited": false, "score": 0, "creation_date": 1576080027, "post_id": 59287469, "comment_id": 104784278, "body": "I defined line as a pointer, I forgot to include the declaration in the question"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 133, "user_id": 12048128, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDXj9YnLcP-qdWits_MNLcG8XQdOgYHv_Gd36dE=k-s128", "display_name": "Pierpaolo Vesce", "link": "https://stackoverflow.com/users/12048128/pierpaolo-vesce"}, "edited": false, "score": 1, "creation_date": 1576080261, "post_id": 59287469, "comment_id": 104784412, "body": "@PierpaoloVesce - If you include that declaration in your original post, it will remove the reason your question was closed, and I will vote to re-open.  In the mean time, I will edit my answer to address how you can use the pointer with <code>malloc</code> to make your code work.  By the way, if you did not allocate memory before using your pointer, that would explain the undefined behavior that people (including me) were citing."}, {"owner": {"reputation": 133, "user_id": 12048128, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDXj9YnLcP-qdWits_MNLcG8XQdOgYHv_Gd36dE=k-s128", "display_name": "Pierpaolo Vesce", "link": "https://stackoverflow.com/users/12048128/pierpaolo-vesce"}, "edited": false, "score": 1, "creation_date": 1576080367, "post_id": 59287469, "comment_id": 104784475, "body": "I would have defined line as a pointer but I changed into an array and yes if you can tell me how to use the pointer with malloc I would be so grateful, I&#39;m so used to C++ that programming in C seems terrible"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 133, "user_id": 12048128, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDXj9YnLcP-qdWits_MNLcG8XQdOgYHv_Gd36dE=k-s128", "display_name": "Pierpaolo Vesce", "link": "https://stackoverflow.com/users/12048128/pierpaolo-vesce"}, "edited": false, "score": 1, "creation_date": 1576087572, "post_id": 59287469, "comment_id": 104788069, "body": "@PierpaoloVesce - Have updated my answer, and voted to reopen your post.  Thank you for updating."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": true, "score": 3, "last_activity_date": 1576093994, "last_edit_date": 1576093994, "creation_date": 1576072839, "answer_id": 59287469, "question_id": 59287338, "link": "https://stackoverflow.com/questions/59287338/stack-smashing-detected-with-fgets-function-in-c/59287469#59287469", "title": "Stack smashing detected with fgets() function in C", "body": "<p><em>Why with 8 it's ok and it's not with 20?</em>  </p>\n\n<p>This suggests the possibility that <code>line</code> has not been defined with enough space for containing 20 <code>char</code>. To be in line with your code snippet, <code>line</code> should be defined as:</p>\n\n<pre><code>char line[20];  \n</code></pre>\n\n<p>Depending on your actual definition of <code>line</code>, you could be seeing results of <a href=\"https://www.google.com/search?client=firefox-b-1-d&amp;q=buffer+overflow+in+C\" rel=\"nofollow noreferrer\">buffer overflow</a>.  The reason it <em>seems</em> to work, then <em>not work</em> is <em><a href=\"https://www.google.com/search?client=firefox-b-1-d&amp;sxsrf=ACYBGNS7NTinf_xNYpfwWvrRgpkY_LwbgQ%3A1576073518835&amp;ei=LvnwXcDDMsG20PEPnPuFuAY&amp;q=undefined+behavior+in+c&amp;oq=undefined+behavior&amp;gs_l=psy-ab.1.1.35i39l2j0l8.32176.35436..38531...0.2..0.68.941.18......0....1..gws-wiz.......0i71j0i273j0i131j0i67j0i10.aQyTuQdw5gk\" rel=\"nofollow noreferrer\">undefined behavior</a></em>, which means any behavior is possible, and at unexpected times.  </p>\n\n<p>Also, you should consider replacing  <code>while(!feof(fp))</code> with <code>while(fgets(line, 20, fp))</code> which checks the return of <code>fgets</code> as a test, and exits upon seeing <code>NULL</code>.   <code>feof()</code> (<a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">is broken</a>)</p>\n\n<pre><code>while(fgets(line, 20, fp))//will exit loop upon a null return\n{\n   //do something with line;\n   puts(line);\n}  \n</code></pre>\n\n<p><strong><em>EDIT</em></strong> to address clarification in comment:</p>\n\n<p>If you declared <code>line</code> as a pointer:</p>\n\n<p>char *line;</p>\n\n<p>Then before using it in the rest of your code the pointer needs to be given an address with corresponding memory sufficient to contain 20 <code>char</code>.  This statement (and test to ensure memory was allocated) will do both:</p>\n\n<pre><code>line = calloc(20, 1);\nif(line)\n{\n    //use line as described above  \n</code></pre>\n\n<p><strong><em>EDIT 2</em></strong> to address new information in OP.</p>\n\n<p>Since <code>line</code> was defined as (edited into OP later)</p>\n\n<pre><code>char line[] = \" \";\n</code></pre>\n\n<p>It has room for only 1 character.  This <em>will</em> cause <em><a href=\"https://stackoverflow.com/questions/6220212/buffer-overflow-in-c\">buffer overflow</a></em>, and explains the inconsistent behavior that was observed (and written about in the post.)    </p>\n\n<p>The suggested way to define <code>line</code> to support what the code shown in your post needs is:</p>\n\n<pre><code>char line[20] = {0}; //space for 20 char, initialized to all zeros.\n</code></pre>\n\n<p>This, along with the other suggestions about replacing <code>feof</code> with <code>fgets</code> will improve the performance you see, and eliminate undefined behavior due to buffer overflow</p>\n"}], "owner": {"reputation": 133, "user_id": 12048128, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDXj9YnLcP-qdWits_MNLcG8XQdOgYHv_Gd36dE=k-s128", "display_name": "Pierpaolo Vesce", "link": "https://stackoverflow.com/users/12048128/pierpaolo-vesce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 59287469, "answer_count": 1, "score": 0, "last_activity_date": 1576111262, "creation_date": 1576072461, "last_edit_date": 1576080232, "question_id": 59287338, "link": "https://stackoverflow.com/questions/59287338/stack-smashing-detected-with-fgets-function-in-c", "title": "Stack smashing detected with fgets() function in C", "body": "<p>I got this code:</p>\n\n<pre><code>while(!feof(fp))\n{\n   fgets(line,20,fp);\n   puts(line);\n}\n</code></pre>\n\n<p><code>fp</code> is this file:</p>\n\n<pre><code>prova1\nprova2\nprova3prova4\nprova5\n</code></pre>\n\n<p>The fact is: if the count parameter of the fgets function it's a lower number than 10 it works everything ok, but if it's greater it gives me a <code>stack smashing detected</code> error.</p>\n\n<p>I think it's because I'm trying to read after EOF, but why when I'm trying to read just after it  works (like 8 characters per line) but when I put a count parameter of like 20 it gives me an error?</p>\n\n<p><strong>NB:</strong> the last line \"prova5\" is formed by 6 characters plus the '\\0' I think, so 7. Why with 8 it's ok and it's not with 20?</p>\n\n<p>EDIT:\nI'm sorry, I forgot to include this declaration:</p>\n\n<pre><code>char line[] = \" \";\n</code></pre>\n"}, {"tags": ["c", "gcc", "compiler-errors"], "comments": [{"owner": {"reputation": 2138, "user_id": 1919896, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7da069e9930c3bdcc9b7af581c0de4eb?s=128&d=identicon&r=PG", "display_name": "Icarus3", "link": "https://stackoverflow.com/users/1919896/icarus3"}, "edited": false, "score": 0, "creation_date": 1576082664, "post_id": 59287273, "comment_id": 104785699, "body": "May be this is helpful? <a href=\"https://askubuntu.com/questions/226918/undefined-reference-to-xshmqueryversion\" title=\"undefined reference to xshmqueryversion\">askubuntu.com/questions/226918/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 11550587, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218832627194940/picture?type=large", "display_name": "Alexandre de Temmerman", "link": "https://stackoverflow.com/users/11550587/alexandre-de-temmerman"}, "edited": false, "score": 0, "creation_date": 1576209531, "post_id": 59292185, "comment_id": 104833174, "body": "Thanks a lot for having taking time to explain. Now I understand it good ! :)"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 1, "last_activity_date": 1576136837, "last_edit_date": 1576136837, "creation_date": 1576089986, "answer_id": 59292185, "question_id": 59287273, "link": "https://stackoverflow.com/questions/59287273/how-do-i-compile-using-minilibx/59292185#59292185", "title": "How do I compile using minilibx?", "body": "<p><strong>Rule of Thumb</strong>: On a linking command line, libraries go after object files, not before them.</p>\n\n<p>If you put the libraries before the object files, some systems will not record the symbols defined by the libraries because there were no outstanding undefined references to any of the functions in the libraries as the command line was processed left-to-right, so when the object files are scanned, the libraries are not rescanned.</p>\n\n<p>Change this:</p>\n\n<pre><code>gcc -Wall -Werror -Wextra -std=gnu99 -I. -g -lm -lGLEW -lglfw -lGL ${OBJS} \\\n    minilibx/libmlx_Linux.a -o ${NAME}\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>gcc -Wall -Werror -Wextra -std=gnu99 -I. -g ${OBJS} -lm -lGLEW -lglfw -lGL \\\n    minilibx/libmlx_Linux.a -o ${NAME}\n</code></pre>\n\n<p>Now you stand a chance of the functions being linked.  On a Mac, using <code>-lm</code> is unnecessary but harmless; the maths functions are in the main system library.  Other systems, notably Linux, still have a separate maths library \u2014 mainly for hysterical raisins (\u2026err, historical reasons\u2026).</p>\n\n<p>I'd not be surprised to find that you need to place the <code>minilibx/libmlx_Linux.a</code> argument earlier in the command line too \u2014 immediately after the <code>${OBJS}</code>.</p>\n"}], "owner": {"reputation": 107, "user_id": 11550587, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218832627194940/picture?type=large", "display_name": "Alexandre de Temmerman", "link": "https://stackoverflow.com/users/11550587/alexandre-de-temmerman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2267, "favorite_count": 0, "accepted_answer_id": 59292185, "answer_count": 1, "score": 1, "last_activity_date": 1576136837, "creation_date": 1576072228, "question_id": 59287273, "link": "https://stackoverflow.com/questions/59287273/how-do-i-compile-using-minilibx", "title": "How do I compile using minilibx?", "body": "<p>I'm working on an exercice at school (Mac OSX), and would like to continue at home (Ubuntu 16.04).\nTo do this project I need to use a library : Minilibx (<a href=\"https://github.com/ttshivhula/minilibx\" rel=\"nofollow noreferrer\">https://github.com/ttshivhula/minilibx</a>)\nI met a problem when I try to gcc. Here is what gcc tells me : \"mlx_init.c:(.text+0x2c) : r\u00e9f\u00e9rence ind\u00e9finie vers \u00ab XShmQueryVersion \u00bb\" (undefined reference in english).\nThere are a lot of these error, for each library (even math.h).\nAt school there is no problem when compiling, but at home it doesn't work.</p>\n\n<p>I compile with this line : </p>\n\n<pre><code>gcc -Wall -Werror -Wextra -std=gnu99 -I. -g -lm -lGLEW -lglfw -lGL ${OBJS} minilibx/libmlx_Linux.a -o ${NAME}\n</code></pre>\n\n<p>With : </p>\n\n<pre><code>OBJS = ${SRC:%.c=%.o}\n\nSRC = cub3d.c ${addprefix ${GNL_PATH}, $(GNL_FILE)} ${addprefix ${LIB_PATH}, $(LIB_FILE)}\n</code></pre>\n\n<p>GNL and LIB are my two personnal librairies.</p>\n\n<p>I tried to change my way of compiling but I cannot find what's wrong.</p>\n"}, {"tags": ["c", "linux-kernel", "linux-device-driver"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 2, "creation_date": 1576071761, "post_id": 59287111, "comment_id": 104779454, "body": "Yes, <code>printk()</code>. It&#39;s used many many times all over the kernel code, I wonder how you couldn&#39;t have been stumbled across it yet"}, {"owner": {"reputation": 4173, "user_id": 4450651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l6IMB.jpg?s=128&g=1", "display_name": "red0ct", "link": "https://stackoverflow.com/users/4450651/red0ct"}, "edited": false, "score": 2, "creation_date": 1576072014, "post_id": 59287111, "comment_id": 104779609, "body": "N.B.: <a href=\"https://stackoverflow.com/questions/1184274/read-write-files-within-a-linux-kernel-module\">Read/write files within a Linux kernel module</a>, <a href=\"https://www.linuxjournal.com/article/8110\" rel=\"nofollow noreferrer\">Things You Never Should Do in the Kernel</a>"}, {"owner": {"reputation": 375, "user_id": 11958500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808134f06cedf9957a27a924d1589f3a?s=128&d=identicon&r=PG&f=1", "display_name": "gaston", "link": "https://stackoverflow.com/users/11958500/gaston"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1576072084, "post_id": 59287111, "comment_id": 104779660, "body": "@Ctx I think that <code>printk</code> is equivalent for <code>printf</code> ( for just printing message on the console ). Does it used also as an equiavalent for <code>fprintf</code> ?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1576072141, "post_id": 59287111, "comment_id": 104779691, "body": "@gaston No, most messages from <code>printk()</code> do <i>not</i> end up in the console (that would be a mess!) but is distributed to files according to the rules of the syslog daemon (i.e. most ends up in /var/log/kern.log)"}, {"owner": {"reputation": 375, "user_id": 11958500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808134f06cedf9957a27a924d1589f3a?s=128&d=identicon&r=PG&f=1", "display_name": "gaston", "link": "https://stackoverflow.com/users/11958500/gaston"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1576072624, "post_id": 59287111, "comment_id": 104779978, "body": "@Ctx Yes you are right. However, FYI, <code>printk</code> does not work here."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1576074406, "post_id": 59287111, "comment_id": 104780971, "body": "You can print to a buffer first (e.g. using <code>snprintf</code> or <code>scnprintf</code>) and then write the buffer contents to a file."}, {"owner": {"reputation": 375, "user_id": 11958500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808134f06cedf9957a27a924d1589f3a?s=128&d=identicon&r=PG&f=1", "display_name": "gaston", "link": "https://stackoverflow.com/users/11958500/gaston"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1576074993, "post_id": 59287111, "comment_id": 104781296, "body": "@IanAbbott Which function I must use to write the buffer contents to a file kernel mode ?"}, {"owner": {"reputation": 4173, "user_id": 4450651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l6IMB.jpg?s=128&g=1", "display_name": "red0ct", "link": "https://stackoverflow.com/users/4450651/red0ct"}, "edited": false, "score": 0, "creation_date": 1576075139, "post_id": 59287111, "comment_id": 104781393, "body": "@gaston Did you read the first post from my comment? There are some examples in it (depending on Linux kernel version)."}, {"owner": {"reputation": 375, "user_id": 11958500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808134f06cedf9957a27a924d1589f3a?s=128&d=identicon&r=PG&f=1", "display_name": "gaston", "link": "https://stackoverflow.com/users/11958500/gaston"}, "reply_to_user": {"reputation": 4173, "user_id": 4450651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l6IMB.jpg?s=128&g=1", "display_name": "red0ct", "link": "https://stackoverflow.com/users/4450651/red0ct"}, "edited": false, "score": 0, "creation_date": 1576075529, "post_id": 59287111, "comment_id": 104781634, "body": "@red0ct Yes I am reading it now thank you."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1576078954, "post_id": 59287111, "comment_id": 104783664, "body": "You shouldn&#39;t do that to begin with. If you need some information to be in the file, use DebugFS."}], "owner": {"reputation": 375, "user_id": 11958500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808134f06cedf9957a27a924d1589f3a?s=128&d=identicon&r=PG&f=1", "display_name": "gaston", "link": "https://stackoverflow.com/users/11958500/gaston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 260, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576071642, "creation_date": 1576071642, "question_id": 59287111, "link": "https://stackoverflow.com/questions/59287111/equivalent-of-fprintf-function-in-linux-kernel-module", "title": "Equivalent of fprintf function in Linux Kernel Module", "body": "<p>I am developing a <strong>Linux Kernel Module</strong> and I need to use an equivalent of <code>fprintf</code> function to print some informations in a file.</p>\n\n<p>I wonder if there is an equivalent of this function in kernel mode.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1576071505, "post_id": 59287035, "comment_id": 104779264, "body": "<i>&quot;The function is &quot;int cadastrarPedido(int Cad);&quot;</i> In the enormous amount of code that you posted there seems to be everything but a function called &quot;cadastrarPedido&quot;."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1576071518, "post_id": 59287035, "comment_id": 104779276, "body": "Please try to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to show us, with emphasis on the <b><i>minimal</i></b> part. I guess most of the code you show isn&#39;t really needed to replicate the problem you have? Also please refresh <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1576071626, "post_id": 59287035, "comment_id": 104779360, "body": "And please don&#39;t call <code>main</code> recursively. While it&#39;s not forbidden in C (unlike in C++) it&#39;s really bad behavior. Just return from your functions and use loops."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1576071763, "post_id": 59287035, "comment_id": 104779456, "body": "After a little more quick checking you seem to go out of bounds of your arrays. For example in <code>verifica_pos</code> you will use <code>200</code> as index of the <code>log</code> array, while the max valid index is <code>199</code>. It&#39;s possible that such indexing (which leads to <i>undefined behavior</i>) could be the root of your problem."}, {"owner": {"reputation": 15, "user_id": 11499813, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wKsk5_Q8jug/AAAAAAAAAAI/AAAAAAAAG_E/OHAtR0eGu0I/photo.jpg?sz=128", "display_name": "Thomas Mendes", "link": "https://stackoverflow.com/users/11499813/thomas-mendes"}, "edited": false, "score": 0, "creation_date": 1576071789, "post_id": 59287035, "comment_id": 104779479, "body": "My bad, just fixed the question"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1576071854, "post_id": 59287035, "comment_id": 104779521, "body": "Lastly, your indentation and code-style is inconsistent, making it very hard to read and understand the flow of your code. It also seems that <code>cadastroPedido</code> could end without you actually returning anything, which is another case of <i>undefined behavior</i> if you try to use the returned value."}, {"owner": {"reputation": 15, "user_id": 11499813, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wKsk5_Q8jug/AAAAAAAAAAI/AAAAAAAAG_E/OHAtR0eGu0I/photo.jpg?sz=128", "display_name": "Thomas Mendes", "link": "https://stackoverflow.com/users/11499813/thomas-mendes"}, "edited": false, "score": 0, "creation_date": 1576072164, "post_id": 59287035, "comment_id": 104779705, "body": "sorry guys, im new to programming, i never wrote anything in c, its for a college project"}, {"owner": {"reputation": 808, "user_id": 11028959, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bcnno.png?s=128&g=1", "display_name": "lucasgcb", "link": "https://stackoverflow.com/users/11028959/lucasgcb"}, "edited": false, "score": 0, "creation_date": 1576073935, "post_id": 59287035, "comment_id": 104780670, "body": "Reminder that the code snippet must be reproducible. This snippet is missing the definitions for your <code>log</code> array, which I&#39;m assuming is a global array of structs that are missing as well."}, {"owner": {"reputation": 15, "user_id": 11499813, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wKsk5_Q8jug/AAAAAAAAAAI/AAAAAAAAG_E/OHAtR0eGu0I/photo.jpg?sz=128", "display_name": "Thomas Mendes", "link": "https://stackoverflow.com/users/11499813/thomas-mendes"}, "edited": false, "score": 0, "creation_date": 1576078836, "post_id": 59287035, "comment_id": 104783590, "body": "fixed it, now there&#39;s a perfect scenario"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11499813, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wKsk5_Q8jug/AAAAAAAAAAI/AAAAAAAAG_E/OHAtR0eGu0I/photo.jpg?sz=128", "display_name": "Thomas Mendes", "link": "https://stackoverflow.com/users/11499813/thomas-mendes"}, "edited": false, "score": 0, "creation_date": 1576078588, "post_id": 59288128, "comment_id": 104783444, "body": "i just tested your code and it really works, but when i try to use it like this it doesnt : <a href=\"https://repl.it/@thzmendes/UnwrittenHorizontalStructs\" rel=\"nofollow noreferrer\">repl.it/@thzmendes/UnwrittenHorizontalStructs</a>"}, {"owner": {"reputation": 808, "user_id": 11028959, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bcnno.png?s=128&g=1", "display_name": "lucasgcb", "link": "https://stackoverflow.com/users/11028959/lucasgcb"}, "reply_to_user": {"reputation": 15, "user_id": 11499813, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wKsk5_Q8jug/AAAAAAAAAAI/AAAAAAAAG_E/OHAtR0eGu0I/photo.jpg?sz=128", "display_name": "Thomas Mendes", "link": "https://stackoverflow.com/users/11499813/thomas-mendes"}, "edited": false, "score": 1, "creation_date": 1576082511, "post_id": 59288128, "comment_id": 104785612, "body": "@ThomasMendes that does work, however when you do <code>printf(&quot;\\n Valor total : %d&quot;,&amp;vlr_T)</code> you&#39;re printing the memory position of <code>vlr_T</code> in int form. To print the int value stored in <code>vlr_T</code> you do <code>printf(&quot;\\n Valor total : %d&quot;,vlr_T)</code>, without the <code>&amp;</code> specifier."}], "tags": [], "owner": {"reputation": 808, "user_id": 11028959, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bcnno.png?s=128&g=1", "display_name": "lucasgcb", "link": "https://stackoverflow.com/users/11028959/lucasgcb"}, "is_accepted": true, "score": 1, "last_activity_date": 1576074940, "creation_date": 1576074940, "answer_id": 59288128, "question_id": 59287035, "link": "https://stackoverflow.com/questions/59287035/strange-int-returned-from-a-function/59288128#59288128", "title": "strange int returned from a function", "body": "<p>I've slapped your code a little bit. This code snippet was enough to reproduce your \"bug\".</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint cadastroPedido(int Cad);\nint main(void) {\n  int valor = cadastroPedido(1);\n  printf(\"%d\",valor);\n  return 0;\n}\n\nint cadastroPedido(int Cad){ \n    int Option;\n    int OpcaoPedido;\n    int valor;\n    if(1==Cad)\n    {\n      do\n      {\n        printf(\"\\nEscolha o seu pedido: \");\n        printf(\"\\n1- Pizza de Calabresa -50 reais\");\n        printf(\"\\n2- Pizza de Frango - 40 reais\");\n        scanf(\"%d\", &amp;OpcaoPedido);\n        if(OpcaoPedido == 1)\n        {\n            printf(\"\\nPressione 1 para continuar pedindo ou 2 para volar ao menu principal: \");\n            valor +=50;\n            scanf(\"%d\", &amp;Option);\n        }\n        else \n          if(OpcaoPedido == 2)\n          {\n            printf(\"\\nPressione 1 para continuar pedindo ou 2 para volar ao menu principal: \");\n            scanf(\"%d\", &amp;Option);\n            valor +=40;\n          }\n      }while(Option == 1);\n    }\n    return valor;\n}\n</code></pre>\n\n<p>You'll see that the local variable of cadastroPedido <code>valor</code> is uninitialized when the function is called. This means that the program will pick a position in memory. Due to RAM shenanigans, that position in memory may have a random value already in it. </p>\n\n<p>You can avoid this by explicitly declaring it like <code>int value = 0</code>, so you will always know the starting value of that variable and so that you aren't at the mercy of preexisting memory states.</p>\n\n<p>If you don't initialize variables when you declare them in C, you're at risk of tripping into these inconsistencies, specially during <code>+=</code> operations. </p>\n"}], "owner": {"reputation": 15, "user_id": 11499813, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wKsk5_Q8jug/AAAAAAAAAAI/AAAAAAAAG_E/OHAtR0eGu0I/photo.jpg?sz=128", "display_name": "Thomas Mendes", "link": "https://stackoverflow.com/users/11499813/thomas-mendes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 1, "accepted_answer_id": 59288128, "answer_count": 1, "score": -1, "last_activity_date": 1576078796, "creation_date": 1576071398, "last_edit_date": 1576078796, "question_id": 59287035, "link": "https://stackoverflow.com/questions/59287035/strange-int-returned-from-a-function", "title": "strange int returned from a function", "body": "<p>im facing one strange scenario when the output of my function return a ENORMOUS int (4225528), when im trying to sum simple values in a var and return that var to store in a struct.</p>\n\n<p>Whats hapenning ? I tried a simple pointer func that i saw here, didnt work, heres my code, anyone has idea how to solve this ?</p>\n\n<p>The function is \"int cadastrarPedido(int Cad);\"</p>\n\n<p>Executable : <a href=\"https://repl.it/@thzmendes/UnwrittenHorizontalStructs\" rel=\"nofollow noreferrer\">https://repl.it/@thzmendes/UnwrittenHorizontalStructs</a></p>\n\n<p>Here is where i call and the func</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint cadastroPedido(int Cad);\nint main(void) {\n  printf(\"Voce selecionou a opcao 4 - Cadastrar Pedido\\n\");\n            int Cad;\n            int vlr_T=0;\n            printf(\"\\nDigite numero do cadastro: \");\n            scanf(\"%d\",&amp;Cad);\n\n            vlr_T = cadastroPedido(Cad);\n            printf(\"\\n Valor total : %d\",&amp;vlr_T);\n  return 0;\n}\n\nint cadastroPedido(int Cad){\n    int Option;\n    int OpcaoPedido;\n    int valor=0;\n    if(Cad&gt;0)\n    {\n      do\n      {\n        printf(\"\\nEscolha o seu pedido: \");\n        printf(\"\\n1- Pizza de Calabresa -50 reais\");\n        printf(\"\\n2- Pizza de Frango - 40 reais\");\n        printf(\"\\n2- Pizza de Mussarela - 30 reais\");\n        printf(\"\\n2- Coca Cola- 10 reais\");\n        printf(\"\\n2- Guarana- 10 reais\");\n        scanf(\"%d\", &amp;OpcaoPedido);\n        if(OpcaoPedido == 1)\n        {\n            printf(\"\\nPressione 1 para continuar pedindo ou 2 para volar ao menu principal: \");\n            valor +=50;\n            scanf(\"%d\", &amp;Option);\n        }\n        else\n          if(OpcaoPedido == 2)\n          {\n            printf(\"\\nPressione 1 para continuar pedindo ou 2 para volar ao menu principal: \");\n            scanf(\"%d\", &amp;Option);\n            valor +=40;\n          }\n        else\n          if(OpcaoPedido == 3)\n          {\n            printf(\"\\nPressione 1 para continuar pedindo ou 2 para volar ao menu principal: \");\n            scanf(\"%d\", &amp;Option);\n            valor +=30;\n          }\n        else\n          if(OpcaoPedido == 4)\n          {\n            printf(\"\\nPressione 1 para continuar pedindo ou 2 para volar ao menu principal: \");\n            scanf(\"%d\", &amp;Option);\n            valor +=10;\n          }\n          else\n          if(OpcaoPedido == 5)\n          {\n            printf(\"\\nPressione 1 para continuar pedindo ou 2 para volar ao menu principal: \");\n            scanf(\"%d\", &amp;Option);\n            valor +=10;\n          }\n      }while(Option == 1);\n    }\n    return valor;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 13906, "user_id": 1187220, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/AwroB.jpg?s=128&g=1", "display_name": "Michel Keijzers", "link": "https://stackoverflow.com/users/1187220/michel-keijzers"}, "edited": false, "score": 1, "creation_date": 1576072190, "post_id": 59288231, "comment_id": 104781510, "body": "Asked to move the question to stackoverflow as it is not related to Arduino."}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 12519068, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dCpMxZ5EVwA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfblx1JQGmv880Np3Ws3eo44bo8oA/photo.jpg?sz=128", "display_name": "luke cross", "link": "https://stackoverflow.com/users/12519068/luke-cross"}, "edited": false, "score": 0, "creation_date": 1576075617, "post_id": 59288232, "comment_id": 104781677, "body": "To save space and time, should I create a function that does this automatically, passing the integer as a parameter? Does the function independent of the total amount of digits (eg 200 or 2000)."}, {"owner": {"reputation": 13906, "user_id": 1187220, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/AwroB.jpg?s=128&g=1", "display_name": "Michel Keijzers", "link": "https://stackoverflow.com/users/1187220/michel-keijzers"}, "reply_to_user": {"reputation": 157, "user_id": 12519068, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dCpMxZ5EVwA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfblx1JQGmv880Np3Ws3eo44bo8oA/photo.jpg?sz=128", "display_name": "luke cross", "link": "https://stackoverflow.com/users/12519068/luke-cross"}, "edited": false, "score": 0, "creation_date": 1576080970, "post_id": 59288232, "comment_id": 104784829, "body": "Yes, create one function that does all these 5 steps and call it for every digit you want to change (if you want to changer every digit, you better can write simply a = 100 * x + 10 * y + z).  I haven&#39;t tested it but digit 0 is the most right one (the least significant), and it should work for all numbers (as long as it fits in an integer)."}], "tags": [], "owner": {"reputation": 13906, "user_id": 1187220, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/AwroB.jpg?s=128&g=1", "display_name": "Michel Keijzers", "link": "https://stackoverflow.com/users/1187220/michel-keijzers"}, "is_accepted": false, "score": 0, "last_activity_date": 1576072158, "creation_date": 1576072158, "answer_id": 59288232, "question_id": 59288231, "link": "https://stackoverflow.com/questions/59288231/how-i-can-separate-integer-number-in-3-houses-hundred-ten-and-unity/59288232#59288232", "title": "How I can separate integer number in 3 &quot;houses&quot;? Hundred, Ten and Unity", "body": "<p>Yes, you can do that, e.g. by using a function to change the digit.</p>\n\n<p>Use the following steps:</p>\n\n<ol>\n<li>What you do, is first shifting the digit right until it is the most right digit and remember the part removed</li>\n<li>Clear the last digit.</li>\n<li>Add the new digit</li>\n<li>Shift left</li>\n<li>Add the remembered part</li>\n</ol>\n\n<p>Example (same steps as above) to change 321 to 351:</p>\n\n<ol>\n<li>Shift right gives 32. Remember 1</li>\n<li>Use the modulo operator and remove it: 32 - (32 % 10) = 32 - 2 = 30</li>\n<li>30 + 5 = 35</li>\n<li>35 -> after shift gives 350 </li>\n<li>350 + 1 = 351</li>\n</ol>\n\n<p>I will leave the implementation up to you.</p>\n"}, {"tags": [], "owner": {"reputation": 1025, "user_id": 5390321, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LrGkNdM2eKQ/AAAAAAAAAAI/AAAAAAAAAgM/lXdKCYkiOzs/photo.jpg?sz=128", "display_name": "Adriano", "link": "https://stackoverflow.com/users/5390321/adriano"}, "is_accepted": false, "score": 3, "last_activity_date": 1576153707, "last_edit_date": 1576153707, "creation_date": 1576072257, "answer_id": 59288233, "question_id": 59288231, "link": "https://stackoverflow.com/questions/59288231/how-i-can-separate-integer-number-in-3-houses-hundred-ten-and-unity/59288233#59288233", "title": "How I can separate integer number in 3 &quot;houses&quot;? Hundred, Ten and Unity", "body": "<p>This has nothing to do with Arduino, it is C.</p>\n\n<p>You can for example convert this to an array with <code>itoa()</code> (see <a href=\"https://playground.arduino.cc/Code/PrintingNumbers/\" rel=\"nofollow noreferrer\">https://playground.arduino.cc/Code/PrintingNumbers/</a>)</p>\n\n<p>And then convert it back to int with <code>atoi()</code> (see <a href=\"http://www.cplusplus.com/reference/cstdlib/atoi/\" rel=\"nofollow noreferrer\">http://www.cplusplus.com/reference/cstdlib/atoi/</a>)</p>\n"}], "migrated_from": {"other_site": {"markdown_extensions": ["Prettify"], "launch_date": 1500324502, "open_beta_date": 1393435951, "closed_beta_date": 1392145200, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/arduino/Img/apple-touch-icon@2.png", "twitter_account": "StackArduino", "favicon_url": "https://cdn.sstatic.net/Sites/arduino/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/arduino/Img/apple-touch-icon.png", "audience": "developers of open-source hardware and software that is compatible with Arduino", "site_url": "https://arduino.stackexchange.com", "api_site_parameter": "arduino", "logo_url": "https://cdn.sstatic.net/Sites/arduino/Img/logo.png", "name": "Arduino", "site_type": "main_site"}, "on_date": 1576075321, "question_id": 70891}, "owner": {"reputation": 157, "user_id": 12519068, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dCpMxZ5EVwA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfblx1JQGmv880Np3Ws3eo44bo8oA/photo.jpg?sz=128", "display_name": "luke cross", "link": "https://stackoverflow.com/users/12519068/luke-cross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1577019102, "creation_date": 1576071319, "last_edit_date": 1577019102, "question_id": 59288231, "link": "https://stackoverflow.com/questions/59288231/how-i-can-separate-integer-number-in-3-houses-hundred-ten-and-unity", "title": "How I can separate integer number in 3 &quot;houses&quot;? Hundred, Ten and Unity", "body": "<p>I have, for example, a variable</p>\n\n<p><code>int number = 300;</code></p>\n\n<p>And I need modify \"number\" by \"number\", I wonder if I need separate in 3 variables for hundred, ten, unity or if there a method for divide that enable to me change a unique variable \"number' by \"number\", \"house\" by \"house\", a hundred, a ten and unity (3 - 2 - 1).</p>\n\n<p>Example: The user need only change number \"2\" of 3'2'1, and he want that \"2\" to being \"5\", as \"321\" must become to \"351\". In other words, the number 3 and 0 not will modified, only number 2 from 321, turning 3-5-1.</p>\n"}, {"tags": ["c", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 2, "creation_date": 1576071189, "post_id": 59286893, "comment_id": 104779089, "body": "Sounds like a use case for condition variables and pthread_cond_timedwait"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 12518463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52b8a5695aed3297fc3313eee5f2d27?s=128&d=identicon&r=PG&f=1", "display_name": "dvjawgvdhawgvbda", "link": "https://stackoverflow.com/users/12518463/dvjawgvdhawgvbda"}, "edited": false, "score": 0, "creation_date": 1576071605, "post_id": 59286982, "comment_id": 104779347, "body": "When our process gets signal from outside of our process isn&#39;t <code>singal()</code> function still registers it to signal handler function? Like when you send signal with <code>htop</code> or <code>top</code> program"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 23, "user_id": 12518463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52b8a5695aed3297fc3313eee5f2d27?s=128&d=identicon&r=PG&f=1", "display_name": "dvjawgvdhawgvbda", "link": "https://stackoverflow.com/users/12518463/dvjawgvdhawgvbda"}, "edited": false, "score": 0, "creation_date": 1576072022, "post_id": 59286982, "comment_id": 104779614, "body": "@dvjawgvdhawgvbda I still am not sure if I understand what you mean. You wrote, that the signal is sent from another thread; this is, where <code>pthread_kill()</code> comes into play."}, {"owner": {"reputation": 23, "user_id": 12518463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52b8a5695aed3297fc3313eee5f2d27?s=128&d=identicon&r=PG&f=1", "display_name": "dvjawgvdhawgvbda", "link": "https://stackoverflow.com/users/12518463/dvjawgvdhawgvbda"}, "edited": false, "score": 0, "creation_date": 1576072154, "post_id": 59286982, "comment_id": 104779699, "body": "Yes but we are still able to trigger it from outside and isn&#39;t it problem? can&#39;t other programs send <code>SIGUSR1</code> to our program?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 23, "user_id": 12518463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52b8a5695aed3297fc3313eee5f2d27?s=128&d=identicon&r=PG&f=1", "display_name": "dvjawgvdhawgvbda", "link": "https://stackoverflow.com/users/12518463/dvjawgvdhawgvbda"}, "edited": false, "score": 0, "creation_date": 1576072201, "post_id": 59286982, "comment_id": 104779734, "body": "@dvjawgvdhawgvbda Yes, of course. Or a SIGINT, SIGTERM or SIGKILL. Why is this an issue?"}, {"owner": {"reputation": 23, "user_id": 12518463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52b8a5695aed3297fc3313eee5f2d27?s=128&d=identicon&r=PG&f=1", "display_name": "dvjawgvdhawgvbda", "link": "https://stackoverflow.com/users/12518463/dvjawgvdhawgvbda"}, "edited": false, "score": 0, "creation_date": 1576072358, "post_id": 59286982, "comment_id": 104779828, "body": "If we get false triggers can&#39;t we process jobs wrong delayed? like early than expected"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 23, "user_id": 12518463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52b8a5695aed3297fc3313eee5f2d27?s=128&d=identicon&r=PG&f=1", "display_name": "dvjawgvdhawgvbda", "link": "https://stackoverflow.com/users/12518463/dvjawgvdhawgvbda"}, "edited": false, "score": 0, "creation_date": 1576072460, "post_id": 59286982, "comment_id": 104779883, "body": "@dvjawgvdhawgvbda Well, if someone is able to inadvertedly or even maliciously send signals to a critical process, this is always a problem. You can limit the possibilities for that by using another user id for your process; then only root or the same userid may send signals to that process. Note, however, that this is not specific to your problem here."}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": false, "score": 1, "last_activity_date": 1576071215, "last_edit_date": 1592644375, "creation_date": 1576071215, "answer_id": 59286982, "question_id": 59286893, "link": "https://stackoverflow.com/questions/59286893/canceling-nanosleep-from-another-thread/59286982#59286982", "title": "Canceling nanosleep() from another thread", "body": "<p>You can possibly use <code>pthread_kill()</code> to deliver the <code>SIGUSR1</code> to a single thread</p>\n<p>From the manpage:</p>\n<blockquote>\n<p>The pthread_kill() function sends the signal sig to thread, a thread in the same process as the caller.  The signal is asynchronously directed to thread.</p>\n<p>If sig is 0, then no signal is sent, but error checking is still performed.</p>\n</blockquote>\n<p>This should only have an effect to the single thread you target.</p>\n"}, {"tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 1, "last_activity_date": 1576074360, "creation_date": 1576074360, "answer_id": 59287960, "question_id": 59286893, "link": "https://stackoverflow.com/questions/59286893/canceling-nanosleep-from-another-thread/59287960#59287960", "title": "Canceling nanosleep() from another thread", "body": "<p>You have a big XY problem here. Sleeping and signals are not the way to implement coordination between threads. I'd go so far as to say that sleeping in a multithreaded program is almost always indicative of some sort of bug.</p>\n\n<p>The tool for what you are trying to do is <em>Condition Variables</em>. If you're not familiar with them, I'd highly recommend <a href=\"https://computing.llnl.gov/tutorials/pthreads/#ConditionVariables\" rel=\"nofollow noreferrer\">the Condition Variables part</a> of <a href=\"https://computing.llnl.gov/tutorials/pthreads/\" rel=\"nofollow noreferrer\">this tutorial</a>. Instead of sleeping, your workers should be doing a <em>timed wait</em> on the condition variable, called in a loop, and exiting from the loop when the condition they're waiting for is true.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 12518463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52b8a5695aed3297fc3313eee5f2d27?s=128&d=identicon&r=PG&f=1", "display_name": "dvjawgvdhawgvbda", "link": "https://stackoverflow.com/users/12518463/dvjawgvdhawgvbda"}, "is_accepted": true, "score": 0, "last_activity_date": 1579454453, "creation_date": 1579454453, "answer_id": 59812530, "question_id": 59286893, "link": "https://stackoverflow.com/questions/59286893/canceling-nanosleep-from-another-thread/59812530#59812530", "title": "Canceling nanosleep() from another thread", "body": "<p>Lets say we have two mutexes one is called <code>x</code> other one is <code>y</code></p>\n\n<p><code>x</code> is used for general locking like don't try access in same time with multiple threads. <code>pthread_mutex_lock</code> and <code>pthread_mutex_unlock</code></p>\n\n<p><code>y</code> is used for <code>nanosleep</code>. <code>pthread_cond_wait</code>, <code>pthread_cond_timedwait</code> and <code>pthread_cond_signal</code></p>\n\n<p>For suspend I use <code>cond_wait</code> <code>y</code> then resume with <code>cond_signal</code> <code>y</code>. If I need suspend for some time like <code>nanosleep</code> I use <code>cond_timedwait</code> <code>y</code> and resume it with same way <code>cond_signal</code> <code>y</code>.</p>\n\n<p>Source:\nstackoverflow.com/questions/59286893/canceling-nanosleep-from-another-thread#comment104779089_59286893</p>\n"}], "owner": {"reputation": 23, "user_id": 12518463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52b8a5695aed3297fc3313eee5f2d27?s=128&d=identicon&r=PG&f=1", "display_name": "dvjawgvdhawgvbda", "link": "https://stackoverflow.com/users/12518463/dvjawgvdhawgvbda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 59812530, "answer_count": 3, "score": 0, "last_activity_date": 1579454453, "creation_date": 1576070930, "question_id": 59286893, "link": "https://stackoverflow.com/questions/59286893/canceling-nanosleep-from-another-thread", "title": "Canceling nanosleep() from another thread", "body": "<p>I'm trying code multi threaded worker and job giver program\nJob giver thread pushes jobs to array with random delayed data it can be processed 1 second later or 10000... second later all depends to job giver.\nWorker thread <code>nanosleep()</code>s till get shortest delayed job, then process it and remove it from job array.\nAll works fine except if job giver pushes shorter delayed job to array and worker thread still <code>nanosleep()</code>s to old shortest job, so its get delayed more than expected.</p>\n\n<p>For now as quick fix I made signal handler with <code>signal()</code> that handling <code>SIGUSR1</code> signal.\nWhen job giver pushes new shortest it sends <code>SIGUSR1</code> to whole program and cancels worker's <code>nanosleep()</code>.\nBut I don't think it's best way to do it since it sends to whole program and I just want to cancel one thread's <code>nanosleep()</code>.</p>\n\n<p>So in summary how I can cancel other thread's <code>nanosleep()</code> from main thread without touching signals?</p>\n\n<p>Note; I'm using pthread on linux with C language.</p>\n\n<p>Note; Delays are in nanoseconds. With current setup I'm able to hit 50\u00b5s loss.</p>\n"}, {"tags": ["c++", "c", "stepper"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1576070067, "post_id": 59286531, "comment_id": 104778441, "body": "Unfortunately your question doesn&#39;t have clearly defined problem that could be answered in a few paragraphs. Question in it&#39;s current state will most likely require lenghty tutorial to be any useful, and such things are off topic here. Please narrow your question somekind of concrete problem that can be answered."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1576070237, "post_id": 59286531, "comment_id": 104778553, "body": "tooooooooo broad. Start studing something about microstepping and PIDs andtrajectory generation. Google it."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1576071043, "post_id": 59286531, "comment_id": 104778996, "body": "If you edit this post to <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">include the code</a> you have used in an attempt to do what you have described, and in the post also pointed out specifically where it is deficient, (buggy, bad performance, etc., which you have kind of done ) this question would get a much more usable response."}, {"owner": {"reputation": 51, "user_id": 7889829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PnrpX.jpg?s=128&g=1", "display_name": "GSerum_", "link": "https://stackoverflow.com/users/7889829/gserum"}, "edited": false, "score": 0, "creation_date": 1576071533, "post_id": 59286531, "comment_id": 104779292, "body": "Thanks for the reply, I&#39;ve attached the code and hopefully narrowed down my question."}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1576135349, "post_id": 59286531, "comment_id": 104802342, "body": "Some 20 years ago I worked on such a stepper software for a 3D machine. We didn&#39;t use trigonomy functions, but simple linear acceleration and deceleration. So it was easy to calculate the frequency and its changes for each axis. Note, that especially for the final ramp you need to do some calculation <i>before</i> you start your vector."}], "owner": {"reputation": 51, "user_id": 7889829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PnrpX.jpg?s=128&g=1", "display_name": "GSerum_", "link": "https://stackoverflow.com/users/7889829/gserum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576078029, "creation_date": 1576069653, "last_edit_date": 1576077912, "question_id": 59286531, "link": "https://stackoverflow.com/questions/59286531/smooth-movement-of-stepper-motor", "title": "Smooth movement of stepper motor", "body": "<p>So I tried to implement an S-Curve for the movement of my stepper motor; however, I feel like this is way too complicated for the simple thing I want the stepper motor to do: Smooth movement. It doesn't have to go from a to b within the blink of an eye, just smoothly. Also, the function overshoots by a gigantic amount of steps (pos_err is almost 40% of steps, always).</p>\n\n<pre><code>void stepper_t::step(int32_t steps, direction dir)\n{\n\n    float32_t pulse_delay;      /* Stepper pulse delay [microsec] */\n\n    int8_t count = 0;           /* Count the number of pulses */\n    int32_t pos_err = 0;        /* Error in position */\n\n    int16_t speed = 3200;       /* Steady state velocity [pulse/s] */\n\n    int8_t var = 0;\n\n    int32_t move_time = (steps / (speed / 1000000));                    /* Total time moving */\n    int32_t accel_time = move_time &lt; 30000 ? (move_time / 2) : 30000;   /* Acceleration time [microsec] */\n    int32_t decel_time = move_time &lt; 30000 ? (move_time / 2) : 30000;   /* Deceleration time [microsec] */\n    int32_t constant_speed = move_time - (accel_time + decel_time);     /* Time during constant velocity [microsec] */\n\n    int32_t curr_time = decel_time / 30; /* Current time     [microsec] \n                                            You need to seed the initial time \n                                            with something &gt; 0 so you don't \n                                            calculate too long of a delay */\n\n    this-&gt;set_direction(dir);\n\n    while (var &lt; 1) {         \n        if (curr_time &lt; accel_time) {  \n            /* Acceleration */                                     \n            pulse_delay = ((float32_t) accel_time / (2.f * ((float32_t) speed / 1000000.f) * (float32_t) curr_time));\n        } else if ((curr_time &gt;= accel_time) &amp;&amp; (curr_time &lt; (accel_time + constant_speed))) {      \n            /* Constant velocity */\n            pulse_delay = (1.f / (2.f * ((float32_t) speed / 1000000.f)));\n        } else if ((curr_time &gt;= (accel_time + constant_speed)) &amp;&amp; (curr_time &lt; (accel_time + constant_speed + decel_time))) {    \n            /* Deceleration */\n            pulse_delay = (1.f / (2.f * (((float32_t) speed / 1000000.f) - ((float32_t) speed / (1000000.f * (float32_t) decel_time)) * ((float32_t) curr_time - (float32_t) accel_time - (float32_t) constant_speed))));\n        }\n\n        /* Time is incremented by pulse delay twice due to the pin going\n        high, then low, delaying twice */\n        curr_time = curr_time + (int32_t) (float32_t) (2.f * pulse_delay);\n\n        /* Send pulse with calculated delay */\n        Chip_GPIO_SetPinState(LPC_GPIO_PORT, this-&gt;GPIO_step_port, this-&gt;GPIO_step_pin, true);\n        OS_Delayus((OS_U16) pulse_delay);\n        Chip_GPIO_SetPinState(LPC_GPIO_PORT, this-&gt;GPIO_step_port, this-&gt;GPIO_step_pin, false);\n        OS_Delayus((OS_U16) pulse_delay);\n\n        count++;\n\n        /* Correct for any position error due to rounding */\n        if (curr_time &gt; (accel_time + constant_speed + decel_time)) {\n            pos_err = steps - count;\n\n            if (pos_err &lt; 0) {\n                pos_err = -1 * pos_err;\n\n                if (dir == OUTWARD) {\n                    this-&gt;set_direction(INWARD);\n                } else {\n                    this-&gt;set_direction(OUTWARD);\n                }\n            }\n\n            for (; pos_err &gt; 0; pos_err--) {\n                Chip_GPIO_SetPinState(LPC_GPIO_PORT, this-&gt;GPIO_step_port, this-&gt;GPIO_step_pin, true);\n                OS_Delayus((OS_U16) pulse_delay);\n                Chip_GPIO_SetPinState(LPC_GPIO_PORT, this-&gt;GPIO_step_port, this-&gt;GPIO_step_pin, false);\n                OS_Delayus((OS_U16) pulse_delay);\n            }\n\n            count = 0;\n            curr_time = decel_time / 9;\n            var++;\n        }\n    }\n}\n</code></pre>\n\n<p>Why wouldn't I just use a cosine to calculate the delays in between like this?</p>\n\n<pre><code>void step2(int32_t steps) {\n\n    int8_t count = 0;\n    float32_t delay;\n\n    while (count &lt; steps) {\n        delay = (cos ( (PI * 2 * count)/steps ) + 1) * 5000 + 10000;\n        Chip_GPIO_SetPinState(LPC_GPIO_PORT, this-&gt;GPIO_step_port, this-&gt;GPIO_step_pin, true);\n        OS_Delayus((OS_U16) delay);\n        Chip_GPIO_SetPinState(LPC_GPIO_PORT, this-&gt;GPIO_step_port, this-&gt;GPIO_step_pin, false);\n        OS_Delayus((OS_U16) delay);\n        count++;\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "c++11", "makefile", "header"], "comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 2, "creation_date": 1576069578, "post_id": 59286470, "comment_id": 104778149, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\">What is an undefined reference/unresolved external symbol error and how do I fix it?</a>"}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 3, "creation_date": 1576069614, "post_id": 59286470, "comment_id": 104778174, "body": "Two <code>main</code> functions?"}, {"owner": {"reputation": 2357, "user_id": 5954825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46e345831a9b1beeb8bfee5cbf70b6f?s=128&d=identicon&r=PG&f=1", "display_name": "mfnx", "link": "https://stackoverflow.com/users/5954825/mfnx"}, "edited": false, "score": 0, "creation_date": 1576069754, "post_id": 59286470, "comment_id": 104778269, "body": "Try to specify the exact error you are getting in future questions."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 2, "creation_date": 1576069825, "post_id": 59286470, "comment_id": 104778312, "body": "Make sure you don&#39;t get totally unrelated errors in your example code before you post it. Example: <code>CFLAGS = -I</code> will make <code>$&lt;</code> be treated as an include directory rather than a source file."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5551302, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1214556038558296/picture?type=large", "display_name": "Augusto Celis", "link": "https://stackoverflow.com/users/5551302/augusto-celis"}, "edited": false, "score": 0, "creation_date": 1576087630, "post_id": 59287025, "comment_id": 104788093, "body": "Unless I am misspelling something, which I don&#39;t think I am, I am still getting an undefined reference to &#39;initalize&#39; error. I do want to thank you for being so thorough with your answer though, it is greatly appreciated!"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 21, "user_id": 5551302, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1214556038558296/picture?type=large", "display_name": "Augusto Celis", "link": "https://stackoverflow.com/users/5551302/augusto-celis"}, "edited": false, "score": 0, "creation_date": 1576088773, "post_id": 59287025, "comment_id": 104788602, "body": "@AugustoCelis If you just copy the files from my answer (and make sure the <code>makefile</code> get &lt;tab&gt; characters where it should), you will not get any undefined references. You misspelled &quot;<i>initialize</i>&quot; but I let that be and it&#39;s spelled &quot;<i>initalize</i>&quot; in all 3 files - so, no undefined reference."}, {"owner": {"reputation": 21, "user_id": 5551302, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1214556038558296/picture?type=large", "display_name": "Augusto Celis", "link": "https://stackoverflow.com/users/5551302/augusto-celis"}, "edited": false, "score": 1, "creation_date": 1578951065, "post_id": 59287025, "comment_id": 105599348, "body": "It did work. I am sorry for such a late response, but thank you very much!"}], "tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": true, "score": 1, "last_activity_date": 1576071363, "creation_date": 1576071363, "answer_id": 59287025, "question_id": 59286470, "link": "https://stackoverflow.com/questions/59286470/undefined-reference-when-compiling-a-c-and-c-file-with-same-header/59287025#59287025", "title": "Undefined reference when compiling a C and C++ file with same header", "body": "<p>[<a href=\"http://eel.is/c++draft/basic.start.main#3\" rel=\"nofollow noreferrer\">basic.start.main</a>]</p>\n\n<blockquote>\n  <p>A program that declares a variable <code>main</code> at global scope, or that declares a function <code>main</code> at global scope attached to a named module, <strong>or that declares the name <code>main</code> with C language linkage</strong> (in any namespace) is ill-formed.</p>\n</blockquote>\n\n<p>So, as a <code>C++</code> program, it's ill-formed. Remove the <code>C</code> <code>main</code> function.  </p>\n\n<p>Other problems:  </p>\n\n<p>In the makefile you have<br>\n<code>CFLAGS = -I</code><br>\nand whatever comes after that when compiling will be treated as a directory to search for header files in. In your makefile, that's the source file. Correction:<br>\n<code>CFLAGS =</code><br>\nor<br>\n<code>CFLAGS = -I.</code>  </p>\n\n<p>Your header file is missing a header guard and header files that are supposed to be used by both C and C++ code usually contain the <code>extern \"C\"</code> part themselves to not burden C++ users to add it.</p>\n\n<p><em>cpp_code.cpp</em></p>\n\n<pre><code>#include \"header_code.h\"\n#include &lt;iostream&gt;\n\nint main() {\n    initalize(); // call the C function\n    std::cout &lt;&lt; \"Hello\" &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p><em>c_code.c</em></p>\n\n<pre><code>#include \"header_code.h\"\n#include &lt;stdio.h&gt;\n\nvoid initalize(){\n    printf(\"Initilized\");\n}\n</code></pre>\n\n<p><em>header_code.h</em></p>\n\n<pre><code>#ifndef HEADER_CODE_H_\n#define HEADER_CODE_H_\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nextern void initalize();\n\n#ifdef __cplusplus\n}\n#endif\n\n#endif\n</code></pre>\n\n<p><em>makefile</em></p>\n\n<pre><code>CXX = g++\nCXXFLAGS = -std=c++11\nCC = gcc\nDEPS = header_code.h\nCFLAGS = -I.\nOBJS = cpp_code.o c_code.o\n\nc: $(OBJS) \n    $(CXX) -o $@ $^ $(CXXFLAGS)\n\n%.o : %.cpp\n    $(CXX) -c $(CXXFLAGS) $&lt;\n\n%.o : %.c $(DEPS)\n    $(CC) -c $(CFLAGS) $&lt;\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5551302, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1214556038558296/picture?type=large", "display_name": "Augusto Celis", "link": "https://stackoverflow.com/users/5551302/augusto-celis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 59287025, "answer_count": 1, "score": -1, "last_activity_date": 1576071363, "creation_date": 1576069419, "question_id": 59286470, "link": "https://stackoverflow.com/questions/59286470/undefined-reference-when-compiling-a-c-and-c-file-with-same-header", "title": "Undefined reference when compiling a C and C++ file with same header", "body": "<p>To make this short, I have a CPP and C code, and my CPP code is trying to reference functions from the C code with a header file. Whenever I run the make command, I end up getting \"undefined reference\" errors. Here are my codes:</p>\n\n<p>cpp_code.cpp:</p>\n\n<pre><code>extern \"C\"{\n    #include \"header_code.h\";\n}\n\nint main(){\n    cout &lt;&lt; \"Hello\" &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>c_code.c:</p>\n\n<pre><code>#include \"header_code.h\"\n\nint main(){\n    printf(\"Hello\");\n    return 0;\n}\n\nvoid initalize(){\n    printf(\"Initilized\");\n}\n</code></pre>\n\n<p>header_code.h:</p>\n\n<pre><code>extern void initalize();\n</code></pre>\n\n<p>makefile:</p>\n\n<pre><code>CXX = g++\nCXXFLAGS = -std=c++11\nCC = gcc\nDEPS = header_code.h\nCFLAGS = -I\nOBJS = cpp_code.o c_code.o\n\nc: $(OBJS) \n    $(CXX) -o $@ $^ $(CXXFLAGS)\n\n%.o : %.cpp\n    $(CXX) -c $(CXXFLAGS) $&lt;\n\n%.o : %.c $(DEPS)\n    $(CC) -c $(CFLAGS) $&lt;\n</code></pre>\n\n<p>Whenever running make it always gives me problems. Can anyone please help me? Thank you for your time reading all of this!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1576068522, "post_id": 59286173, "comment_id": 104777564, "body": "By adding every value to e.g. <code>sum</code> (after you suitably initialized it of course)?"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 2, "creation_date": 1576068563, "post_id": 59286173, "comment_id": 104777583, "body": "What have you tried? This doesn&#39;t look like &quot;sum of a table&quot; code."}, {"owner": {"reputation": 1894, "user_id": 8473031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4878bfc9d6a80397a8446111fffa4dd?s=128&d=identicon&r=PG&f=1", "display_name": "RoQuOTriX", "link": "https://stackoverflow.com/users/8473031/roquotrix"}, "edited": false, "score": 1, "creation_date": 1576068632, "post_id": 59286173, "comment_id": 104777618, "body": "You have to save the result of <code>i*no</code> into sum and print it after the loop"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1576068740, "post_id": 59286173, "comment_id": 104777666, "body": "Initialize <code>sum</code>  to 0. Then inside the loop add <code>i*no</code> to <code>sum</code> and print <code>sum</code> at the very end..."}, {"owner": {"reputation": 1894, "user_id": 8473031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4878bfc9d6a80397a8446111fffa4dd?s=128&d=identicon&r=PG&f=1", "display_name": "RoQuOTriX", "link": "https://stackoverflow.com/users/8473031/roquotrix"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1576068804, "post_id": 59286173, "comment_id": 104777697, "body": "@Jabberwocky &quot;You have to save the result of <code>i*no</code> AND ADD IT TO <code>sum</code> and print it after the loop&quot; better?:D"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 1894, "user_id": 8473031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4878bfc9d6a80397a8446111fffa4dd?s=128&d=identicon&r=PG&f=1", "display_name": "RoQuOTriX", "link": "https://stackoverflow.com/users/8473031/roquotrix"}, "edited": false, "score": 0, "creation_date": 1576068876, "post_id": 59286173, "comment_id": 104777732, "body": "@RoQuOTriX that&#39;s what I was writing. Read my comment closely again."}, {"owner": {"reputation": 1894, "user_id": 8473031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4878bfc9d6a80397a8446111fffa4dd?s=128&d=identicon&r=PG&f=1", "display_name": "RoQuOTriX", "link": "https://stackoverflow.com/users/8473031/roquotrix"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1576069017, "post_id": 59286173, "comment_id": 104777824, "body": "@Jabberwocky I understood the problem very well, thanks. I corrected my comment"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 1894, "user_id": 8473031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4878bfc9d6a80397a8446111fffa4dd?s=128&d=identicon&r=PG&f=1", "display_name": "RoQuOTriX", "link": "https://stackoverflow.com/users/8473031/roquotrix"}, "edited": false, "score": 0, "creation_date": 1576069083, "post_id": 59286173, "comment_id": 104777863, "body": "@RoQuOTriX yes, now your comment says <i>exactly</i> the same as mine..."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1576132812, "post_id": 59286173, "comment_id": 104801412, "body": "the resulting value &#39;sum&#39; could easily overflow.  Even the <code>i*no</code> would overflow if the resulting value is greater than 2gig.  Suggest checking for overflow and modifying the working values to be <code>long int</code> or even <code>long long int</code>"}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1576068915, "post_id": 59286260, "comment_id": 104777757, "body": "The variable <code>tmp</code> is absolutely not necessary."}, {"owner": {"reputation": 1894, "user_id": 8473031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4878bfc9d6a80397a8446111fffa4dd?s=128&d=identicon&r=PG&f=1", "display_name": "RoQuOTriX", "link": "https://stackoverflow.com/users/8473031/roquotrix"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1576069049, "post_id": 59286260, "comment_id": 104777842, "body": "@Jabberwocky How to print it without <code>tmp</code> without calculating twice?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1576069192, "post_id": 59286260, "comment_id": 104777913, "body": "@RoQuOTriX if it&#39;s calculated twice in the C code, it doesn&#39;t imply that the generated code will do the calculation twice. Modern compilers will optimize this automatically."}, {"owner": {"reputation": 1894, "user_id": 8473031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4878bfc9d6a80397a8446111fffa4dd?s=128&d=identicon&r=PG&f=1", "display_name": "RoQuOTriX", "link": "https://stackoverflow.com/users/8473031/roquotrix"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1576069447, "post_id": 59286260, "comment_id": 104778070, "body": "@Jabberwocky even the tmp gets optimized out, so why bothering? <a href=\"https://godbolt.org/z/z6sbqv\" rel=\"nofollow noreferrer\">godbolt.org/z/z6sbqv</a>"}], "tags": [], "owner": {"reputation": 1894, "user_id": 8473031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4878bfc9d6a80397a8446111fffa4dd?s=128&d=identicon&r=PG&f=1", "display_name": "RoQuOTriX", "link": "https://stackoverflow.com/users/8473031/roquotrix"}, "is_accepted": false, "score": 0, "last_activity_date": 1576068717, "creation_date": 1576068717, "answer_id": 59286260, "question_id": 59286173, "link": "https://stackoverflow.com/questions/59286173/how-to-calculate-the-total-sum-of-the-multiplication-table/59286260#59286260", "title": "How to calculate the total sum of the multiplication table", "body": "<p>Maybe this helps to understand</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include&lt;conio.h&gt;\n\nint main()\n{\n  int no, i, mult, sum, tmp;\n\n  printf(\"Enter the number you wish to multiply: \\n\");\n  scanf(\"%d\", &amp;no);\n\n  printf(\"Enter how many times you want to multiply the number: \\n\");\n  scanf(\"%d\", &amp;mult);\n\n  printf(\"Multiplication is as follows: \\n\");\n\n  sum = 0;\n  for(i = 1; i &lt;= mult; i++)\n  {\n      tmp = i*no;\n      printf(\"%d X %d = %d\\n\", no,i,tmp);\n      sum += tmp;\n  }\n\n  printf(\"The sum is: %d\\n\", sum);\n\n  return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1894, "user_id": 8473031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4878bfc9d6a80397a8446111fffa4dd?s=128&d=identicon&r=PG&f=1", "display_name": "RoQuOTriX", "link": "https://stackoverflow.com/users/8473031/roquotrix"}, "edited": false, "score": 0, "creation_date": 1576068908, "post_id": 59286301, "comment_id": 104777750, "body": "Consider the &quot;performance&quot; problem, because you calculate <code>i*no</code> twice per loop"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 1894, "user_id": 8473031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4878bfc9d6a80397a8446111fffa4dd?s=128&d=identicon&r=PG&f=1", "display_name": "RoQuOTriX", "link": "https://stackoverflow.com/users/8473031/roquotrix"}, "edited": false, "score": 3, "creation_date": 1576068951, "post_id": 59286301, "comment_id": 104777780, "body": "@RoQuOTriX your compiler will take care of that problem, unless of course you&#39;re using an antiquated compiler."}, {"owner": {"reputation": 768, "user_id": 5091507, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DnZgW.png?s=128&g=1", "display_name": "Alaleh Ahmadian", "link": "https://stackoverflow.com/users/5091507/alaleh-ahmadian"}, "reply_to_user": {"reputation": 1894, "user_id": 8473031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4878bfc9d6a80397a8446111fffa4dd?s=128&d=identicon&r=PG&f=1", "display_name": "RoQuOTriX", "link": "https://stackoverflow.com/users/8473031/roquotrix"}, "edited": false, "score": 1, "creation_date": 1576068978, "post_id": 59286301, "comment_id": 104777802, "body": "@RoQuOTriX I know, I just wanted to change their own code as little as possible. Also as @ Jabberwocky said it is not a problem in modern compilers"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1576069366, "post_id": 59286301, "comment_id": 104778029, "body": "Just don&#39;t trust &quot;modern compilers&quot; too much - nowadays, programmers have a tendency to think that compilers can do magic. Had the printf call been a function taking any integer address as parameter, the compiler might have to assume that the function could have change the value of the variable. It will then not only be forced to re-read the variable, it will have to perform the calculation once more."}], "tags": [], "owner": {"reputation": 768, "user_id": 5091507, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DnZgW.png?s=128&g=1", "display_name": "Alaleh Ahmadian", "link": "https://stackoverflow.com/users/5091507/alaleh-ahmadian"}, "is_accepted": false, "score": 1, "last_activity_date": 1576068832, "creation_date": 1576068832, "answer_id": 59286301, "question_id": 59286173, "link": "https://stackoverflow.com/questions/59286173/how-to-calculate-the-total-sum-of-the-multiplication-table/59286301#59286301", "title": "How to calculate the total sum of the multiplication table", "body": "<p>Initialize <code>sum = 0</code> in the beginning and then everytime you print a value add it to the sum.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include&lt;conio.h&gt;\n\nint main()\n{\n  int no,i,mult,sum=0;\n\n  printf(\"Enter the number you wish to multiply: \\n\");\n  scanf(\"%d\", &amp;no);\n\n  printf(\"Enter how many times you want to multiply the number: \\n\");\n  scanf(\"%d\", &amp;mult);\n\n  printf(\"Multiplication is as follows: \\n\");\n\n  for(i = 1; i &lt;= mult; i++)\n  {\n      printf(\"%d X %d = %d\\n\", no,i,i*no);\n      sum = sum + i*no\n  }\n  printf(\"sum = %d\", sum);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "is_accepted": false, "score": 0, "last_activity_date": 1576073863, "creation_date": 1576073863, "answer_id": 59287805, "question_id": 59286173, "link": "https://stackoverflow.com/questions/59286173/how-to-calculate-the-total-sum-of-the-multiplication-table/59287805#59287805", "title": "How to calculate the total sum of the multiplication table", "body": "<blockquote>\n  <p>How can I get the total sum of the overall table?</p>\n</blockquote>\n\n<p>By initializing the variable <code>sum</code> that you already have declared (zero is usually a good start) and updating its value while calculating the products.</p>\n\n<p>I took the liberty, in the code below, of adding some input checks and perform the calculation without any actual product, but that's immaterial to the matter of the question. Feel free to experiment it <a href=\"https://wandbox.org/permlink/BPiS4Cp59Rnuyqb9\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint ask_int(const char *str);\n\nint main(void)\n{\n    int number = ask_int(\"Enter the number you wish to multiply:\");\n    int mult = ask_int(\"Enter how many times you want to multiply the number:\");\n\n    puts(\"Multiplication is as follows:\");\n\n    int sum = 0;  // &lt;--------------------------------------  Initialize the accumulator.\n\n    for(int i = 1, tmp = number; i &lt;= mult; ++i, tmp += number)\n    {\n        printf(\"%d X %d = %d\\n\", number, i, tmp);\n\n        sum += tmp; // &lt;------------------------------------- Update.\n    }\n    printf(\"sum = %d\", sum);\n}\n\nint ask_int(const char *str)\n{\n    int number = 0;\n    for (;;)\n    {\n        puts(str);\n        int ret = scanf(\"%d\", &amp;number);\n        if ( ret == 1 )\n            break;\n        if ( ret == EOF )\n        {\n            fprintf(stderr, \"Error: Unexpected end of input.\\n\");\n            break;\n        }\n        puts(\"That's not a number.\");\n    }\n    return number;\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 12518367, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA3GAIz8hCkupFf9I-oiGDabX0UXB1m5m6-MOsN9A=k-s128", "display_name": "Aryan Aher", "link": "https://stackoverflow.com/users/12518367/aryan-aher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2216, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1576073863, "creation_date": 1576068407, "last_edit_date": 1576068664, "question_id": 59286173, "link": "https://stackoverflow.com/questions/59286173/how-to-calculate-the-total-sum-of-the-multiplication-table", "title": "How to calculate the total sum of the multiplication table", "body": "<p>I have generated the table and want to find the total sum of the table.</p>\n\n<p>The code is as follows: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int no, i, mult, sum;\n\n    printf(\"Enter the number you wish to multiply: \\n\");\n    scanf(\"%d\", &amp;no);\n\n    printf(\"Enter how many times you want to multiply the number: \\n\");\n    scanf(\"%d\", &amp;mult);\n\n    printf(\"Multiplication is as follows: \\n\");\n\n    for( i = 1; i &lt;= mult; i++ )\n    {\n        printf(\"%d X %d = %d\\n\", no, i, i * no);\n    }\n}\n</code></pre>\n\n<p>How can I get the total sum of the overall table?</p>\n"}, {"tags": ["c", "clang-format"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1576068378, "post_id": 59285714, "comment_id": 104777491, "body": "<code>IndentWidth:4</code> and <code>TabWidth:4</code> leading to exactly one tab at the beginning is what I would expect."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1576068645, "post_id": 59285714, "comment_id": 104777626, "body": "If you do not want tabs, you have to specify <code>UseTab: Never</code>"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1576068724, "post_id": 59285714, "comment_id": 104777662, "body": "Change <code>UseTab: ForIndentation</code> to <code>UseTab: Never</code>"}, {"owner": {"reputation": 2198, "user_id": 2476219, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/89yiG.jpg?s=128&g=1", "display_name": "Aart Stuurman", "link": "https://stackoverflow.com/users/2476219/aart-stuurman"}, "edited": false, "score": 1, "creation_date": 1576069354, "post_id": 59285714, "comment_id": 104778021, "body": "To clarify: I actually want tabs for indentation and spaces for alignment. In my eyes this piece of code should contain no indentation, only alignment. Am I incorrect?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1576070623, "post_id": 59285714, "comment_id": 104778769, "body": "@AartStuurman Yes, since the struct initialization spreads over multiple lines, all lines but the first one are to be indented."}, {"owner": {"reputation": 2198, "user_id": 2476219, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/89yiG.jpg?s=128&g=1", "display_name": "Aart Stuurman", "link": "https://stackoverflow.com/users/2476219/aart-stuurman"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1576071320, "post_id": 59285714, "comment_id": 104779160, "body": "@Ctx Okay that makes sense. But why are all the spaces present after the indentation? I presume to make the indentation &#39;start&#39; from somewhere around the &#39;=&#39; symbol? 4 column tabs does not look like clear indentation to me(more like alignment), while 8 column tabs does."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1576071485, "post_id": 59285714, "comment_id": 104779251, "body": "@AartStuurman The first tab is for regular code indention, the following spaces are another kind of indention to make it look &quot;nicer&quot;. And remember: How the tabs are displayed depends on <i>your editor</i>, not on clang. You <i>tell</i> clang, that your editor will display it with 4 columns. When it indeed displays a tab as 8 colums, set TabWidth and IndentWidth to 8"}, {"owner": {"reputation": 2198, "user_id": 2476219, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/89yiG.jpg?s=128&g=1", "display_name": "Aart Stuurman", "link": "https://stackoverflow.com/users/2476219/aart-stuurman"}, "edited": false, "score": 0, "creation_date": 1576072505, "post_id": 59285714, "comment_id": 104779905, "body": "I understand that. My team uses different tab size settings, so I&#39;m trying to find a good middleground. I think in this case the best option is to put the complete rvalue on the next line(not keeping the first line on there), in case it doesn&#39;t fit."}, {"owner": {"reputation": 2198, "user_id": 2476219, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/89yiG.jpg?s=128&g=1", "display_name": "Aart Stuurman", "link": "https://stackoverflow.com/users/2476219/aart-stuurman"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1576073179, "post_id": 59285714, "comment_id": 104780275, "body": "@Ctx Okay sorry for asking this again, but do you by chance know if there is a setting for that? In the docs I see nothing on breaking after assignment."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1576073243, "post_id": 59285714, "comment_id": 104780306, "body": "@AartStuurman I have already looked the options through, but at first glance I couldn&#39;t find something in this regard."}, {"owner": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "edited": false, "score": 0, "creation_date": 1576077183, "post_id": 59285714, "comment_id": 104782538, "body": "@AartStuurman &quot;<i>My team uses different tab size settings</i>&quot; if that&#39;s the case, the NO formatting involving TABs is going to work. If you tell <code>clang-format</code> that TABs will take up 4 spaces, but for <i>some</i> people they take up 8 spaces, it will look wrong. Similarly telling clang TABs occupy 8 spaces when for some people it&#39;s 4 will look wrong. <i>Either</i> get everyone to use the same tab-size setting <i>or</i> to not use TABs in formatted source."}, {"owner": {"reputation": 2198, "user_id": 2476219, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/89yiG.jpg?s=128&g=1", "display_name": "Aart Stuurman", "link": "https://stackoverflow.com/users/2476219/aart-stuurman"}, "reply_to_user": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "edited": false, "score": 0, "creation_date": 1576078152, "post_id": 59285714, "comment_id": 104783172, "body": "@TripeHound This is only a problem in this specific formatting case. If you use tabs for just indentation, and space for alignment, there is no issue when people use different tab size(allowing them to choose themselves how much indentation is good for their eyes). The problem with the current case is that we call the continuation &#39;indentation&#39;, while I want to achieve alignment at the same time. This is impossible with tab indentation. Either continuation indentation should be done with spaces, or the text to indent to should also be on it&#39;s own line, so it uses the same tab indentation."}, {"owner": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "edited": false, "score": 0, "creation_date": 1576079574, "post_id": 59285714, "comment_id": 104784020, "body": "@AartStuurman What happens if you have <code>static struct option long_options[] = {</code> and the corresponding <code>};</code> on separate lines?  The horizontal <i>positions</i> of the four option lines in between might be different for different users, but they should, I&#39;m guessing, be the same for all four lines. (And in passing, it&#39;s presumably being inside the <code>long_options[] = { ... };</code> block that makes clang treat those lines as being indented, not simply aligned)."}], "answers": [{"tags": [], "owner": {"reputation": 2198, "user_id": 2476219, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/89yiG.jpg?s=128&g=1", "display_name": "Aart Stuurman", "link": "https://stackoverflow.com/users/2476219/aart-stuurman"}, "is_accepted": false, "score": 1, "last_activity_date": 1576146364, "creation_date": 1576146364, "answer_id": 59302466, "question_id": 59285714, "link": "https://stackoverflow.com/questions/59285714/clang-format-unwanted-indentation/59302466#59302466", "title": "Clang format unwanted indentation", "body": "<p>My solution was to use <code>Cpp11BracedListStyle: true</code> and <code>UseTab: ForIndentation</code>. This slightly changes to the look of braced lists, but forces the use of spaces when aligning them.</p>\n"}], "owner": {"reputation": 2198, "user_id": 2476219, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/89yiG.jpg?s=128&g=1", "display_name": "Aart Stuurman", "link": "https://stackoverflow.com/users/2476219/aart-stuurman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576146364, "creation_date": 1576066852, "last_edit_date": 1576068036, "question_id": 59285714, "link": "https://stackoverflow.com/questions/59285714/clang-format-unwanted-indentation", "title": "Clang format unwanted indentation", "body": "<p>I'm automating enforcing coding style using clang-format. Everything formats correctly, except for one unwanted artifact. The reduced version of my .clang-format config file is:</p>\n\n<pre><code>ColumnLimit: 120\nCpp11BracedListStyle: false\nIndentWidth: 4\nStandard: Auto\nTabWidth: 4\nUseTab: ForIndentation\n</code></pre>\n\n<p>The code in question after formatting is:</p>\n\n<pre><code>static struct option long_options[] = { { \"str1\", no_argument, NULL, 'h' },\n                                            { \"str2\", no_argument, NULL, 'v' },\n                                            { \"str3\", required_argument, NULL, 's' },\n                                            { NULL, 0, NULL, 0 } };\n</code></pre>\n\n<p>It is hard to display on Stackoverflow, but this is how it displays using 8 column tabs. All whitespace is spaces, except for the first character, which is a tab(but displays here as 8 spaces). So:</p>\n\n<pre><code>static struct option long_options[] = { { \"str1\", no_argument, NULL, 'h' },\n&lt;__tab_&gt;                                    { \"str2\", no_argument, NULL, 'v' },\n&lt;__tab_&gt;                                    { \"str3\", required_argument, NULL, 's' },\n&lt;__tab_&gt;                                    { NULL, 0, NULL, 0 } };\n</code></pre>\n\n<p>This is not the formatting I'm looking for. Displaying with 4 column tabs gives the output I expect:</p>\n\n<pre><code>static struct option long_options[] = { { \"str1\", no_argument, NULL, 'h' },\n&lt;tb&gt;                                    { \"str2\", no_argument, NULL, 'v' },\n&lt;tb&gt;                                    { \"str3\", required_argument, NULL, 's' },\n&lt;tb&gt;                                    { NULL, 0, NULL, 0 } };\n</code></pre>\n\n<p>However, I feel like there should not be a tab at all, and the alignment should be done by spaces alone, preventing the whole display tab size problem.</p>\n\n<p>How can I setup clang-format to solve this?</p>\n"}, {"tags": ["c", "linux", "unix", "terminal"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 3, "creation_date": 1576065027, "post_id": 59285143, "comment_id": 104775819, "body": "buffering, use <code>fflush(stdout);</code> after each <code>printf()</code> (or at least before each <code>sleep()</code>)"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 3, "creation_date": 1576065294, "post_id": 59285143, "comment_id": 104775947, "body": "If <code>fflush()</code> looks too clumsy, you can also <code>setvbuf(stdout, NULL, _IONBF, 0);</code> before the first <code>printf()</code>."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 2, "creation_date": 1576072278, "post_id": 59285143, "comment_id": 104779781, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/338273/608639\">Why does printf() not print anything before sleep()?</a>, <a href=\"https://stackoverflow.com/q/25627535/608639\">Printf and sleep inside for loop?</a> and friends. Also see <a href=\"https://stackoverflow.com/q/1716296/608639\">Why does printf not flush after the call unless a newline is in the format string?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 11336884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff2a47007a4bf0193137c9cebac182ad?s=128&d=identicon&r=PG&f=1", "display_name": "Arus23", "link": "https://stackoverflow.com/users/11336884/arus23"}, "edited": false, "score": 0, "creation_date": 1576065740, "post_id": 59285224, "comment_id": 104776153, "body": "Thank you for further explanation :)"}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 4, "last_activity_date": 1576065173, "creation_date": 1576065173, "answer_id": 59285224, "question_id": 59285143, "link": "https://stackoverflow.com/questions/59285143/moving-the-cursor-and-printing-characters-in-console-doesnt-work-with-sleep/59285224#59285224", "title": "Moving the cursor and printing characters in console doesn&#39;t work with sleep", "body": "<p>Output to <code>stdout</code> (which is where <code>printf</code> writes) is by default (when connected to a terminal) <em>line buffered</em>. That means output is flushed (actually written to the terminal) either when the buffer is full, when you print a newline, or when you explicitly flush it (with <a href=\"https://en.cppreference.com/w/c/io/fflush\" rel=\"nofollow noreferrer\"><code>fflush</code></a>).</p>\n\n<p>In your case, since you never fill the buffer and don't print newlines, you need to explicitly call <code>fflush(stdout)</code> before each call to <code>sleep</code>.</p>\n"}], "owner": {"reputation": 67, "user_id": 11336884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff2a47007a4bf0193137c9cebac182ad?s=128&d=identicon&r=PG&f=1", "display_name": "Arus23", "link": "https://stackoverflow.com/users/11336884/arus23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "closed_date": 1576076129, "answer_count": 1, "score": 1, "last_activity_date": 1576072235, "creation_date": 1576064903, "last_edit_date": 1576072235, "question_id": 59285143, "link": "https://stackoverflow.com/questions/59285143/moving-the-cursor-and-printing-characters-in-console-doesnt-work-with-sleep", "closed_reason": "Duplicate", "title": "Moving the cursor and printing characters in console doesn&#39;t work with sleep", "body": "<p>I want to print a sequence of characters one by one in the same place. I print one letter, then wait 1 second with sleep, move cursor one column left using console code, print next letter and so on. The problem is as a result program waits the sum of all sleeps (2s in my example) and then prints only the last character ('y'). Same goes with nanosleep, waiting for a signal instead of sleeping. How to make it work?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\nint main()\n{\n    printf( \"H\" );\n    sleep( 1 );\n    printf( \"\\033[1D\" );\n    printf( \"e\" );\n    sleep( 1 );\n    printf( \"\\033[1D\" );\n    printf( \"y\" );\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 37861, "user_id": 506796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e648659dd573c1161a370efa0f5e10d6?s=128&d=identicon&r=PG", "display_name": "Tenfour04", "link": "https://stackoverflow.com/users/506796/tenfour04"}, "edited": false, "score": 0, "creation_date": 1576077481, "post_id": 59284811, "comment_id": 104782720, "body": "LibGDX is a Java-based game engine. I think you have the wrong tag."}, {"owner": {"reputation": 1, "user_id": 5234305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ec03bcc6bffe03dfc080c634dd8b518?s=128&d=identicon&r=PG&f=1", "display_name": "Koral", "link": "https://stackoverflow.com/users/5234305/koral"}, "reply_to_user": {"reputation": 37861, "user_id": 506796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e648659dd573c1161a370efa0f5e10d6?s=128&d=identicon&r=PG", "display_name": "Tenfour04", "link": "https://stackoverflow.com/users/506796/tenfour04"}, "edited": false, "score": 0, "creation_date": 1576102234, "post_id": 59284811, "comment_id": 104794197, "body": "Oh..I see. thank you. I saw something was wrong when posted. It would not give me libgd tag without &#39;x&#39;."}, {"owner": {"reputation": 37861, "user_id": 506796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e648659dd573c1161a370efa0f5e10d6?s=128&d=identicon&r=PG", "display_name": "Tenfour04", "link": "https://stackoverflow.com/users/506796/tenfour04"}, "edited": false, "score": 0, "creation_date": 1576102286, "post_id": 59284811, "comment_id": 104794216, "body": "I would tag it with the language(s) you&#39;re using at least, so it will get more attention."}], "owner": {"reputation": 1, "user_id": 5234305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ec03bcc6bffe03dfc080c634dd8b518?s=128&d=identicon&r=PG&f=1", "display_name": "Koral", "link": "https://stackoverflow.com/users/5234305/koral"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576102856, "creation_date": 1576063642, "last_edit_date": 1576102856, "question_id": 59284811, "link": "https://stackoverflow.com/questions/59284811/libgd-error-no-png-support-when-compiling-example", "title": "libGD error &quot;no PNG support&quot; when compiling example", "body": "<p>Don't know how to tell the compiler to find PNG.</p>\n\n<p>The example \"arc.c\" is from libgd-2.2.5/examples directory. I installed gd-devel: # yum install gd-devel. I even did try to install libgd-2.2.5 with ./configure, make, make install; which was installed in \"/usr/local\". And still, I get this error: \"no PNG support\" when compiling \"arc.c\" like this: </p>\n\n<pre><code>[none@localhost ~]$ gcc arc.c -I/usr/local/include -L/usr/local/include -lgd\n\n[none@localhost ~]$ ls\n\na.out arc.c arc.o\n\n[none@localhost ~]$ ./a.out\n\nno PNG support\n</code></pre>\n\n<p>content of /usr/local/lib: &lt;&lt; libgd.a  libgd.la  libgd.so  libgd.so.3  libgd.so.3.0.5 >></p>\n\n<p>also, checking if there is PNG support, with:</p>\n\n<pre><code>[none@localhost ~]$ ldconfig -p | grep libpng\n\nlibpng16.so.16 (libc6,x86-64) =&gt; /lib64/libpng16.so.16\n\n</code></pre>\n\n<p>which says \"PNG support\" is installed.</p>\n\n<p>arc.c</p>\n\n<pre><code>01  #include \"gd.h\"\n02  #include &lt;stdio.h&gt;\n03  #include &lt;stdlib.h&gt;\n04\n05  int main()\n06  {\n07      gdImagePtr im;\n08      FILE *fp;\n09      int cor_rad = 60;\n10      im = gdImageCreateTrueColor(400, 400);\n11      gdImageFilledRectangle(im, 0, 0, 399, 399, 0x00FFFFFF);\n12\n13      gdImageFilledArc (im, cor_rad, 399 - cor_rad, cor_rad *2, cor_rad *2, 90, 180, 0x0, gdPie);\n14\n15      fp = fopen(\"b.png\", \"wb\");\n16      if (!fp) {\n17          fprintf(stderr, \"Can't save png image.\\n\");\n18          gdImageDestroy(im);\n19          return 1;\n20      }\n21  #ifdef HAVE_LIBPNG\n22      gdImagePng(im, fp);\n23  #else\n24      printf(\"No PNG support. Cannot save image.\\n\");  \n25  #endif\n26      fclose(fp);\n27\n28      gdImageDestroy(im);\n29      return 0;\n30  }\n</code></pre>\n\n<p>Clearly, the error comes from line: 21 and 24. Where \"#ifdef HAVE_LIBPNG\" is verified?</p>\n\n<p>How do I tell the compiler to find PNG support?</p>\n"}, {"tags": ["c", "arrays", "struct"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 2, "creation_date": 1576061789, "post_id": 59284181, "comment_id": 104774123, "body": "Why are you overwriting <code>outNeighbour</code> and <code>inNeighbour</code> immediately after mallocing?"}, {"owner": {"reputation": 490, "user_id": 7602674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/193276783eb09a4a1b8c7f18b74a731a?s=128&d=identicon&r=PG&f=1", "display_name": "jjh", "link": "https://stackoverflow.com/users/7602674/jjh"}, "edited": false, "score": 0, "creation_date": 1576061896, "post_id": 59284181, "comment_id": 104774163, "body": "I would recommend separating your allocation and your initialisation."}, {"owner": {"reputation": 23, "user_id": 9493541, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204570025486550/picture?type=large", "display_name": "Stoxhorn", "link": "https://stackoverflow.com/users/9493541/stoxhorn"}, "reply_to_user": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1576062381, "post_id": 59284181, "comment_id": 104774425, "body": "@kiranbiradar from an earliyer part that bugged me, thanks for pointing it out."}, {"owner": {"reputation": 23, "user_id": 9493541, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204570025486550/picture?type=large", "display_name": "Stoxhorn", "link": "https://stackoverflow.com/users/9493541/stoxhorn"}, "reply_to_user": {"reputation": 490, "user_id": 7602674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/193276783eb09a4a1b8c7f18b74a731a?s=128&d=identicon&r=PG&f=1", "display_name": "jjh", "link": "https://stackoverflow.com/users/7602674/jjh"}, "edited": false, "score": 0, "creation_date": 1576062402, "post_id": 59284181, "comment_id": 104774440, "body": "@jjh Are you referring to the Linkedlist allocation?"}, {"owner": {"reputation": 141, "user_id": 5551818, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-h1fV-zpnnKg/AAAAAAAAAAI/AAAAAAAAAC4/cXngmigAfxs/photo.jpg?sz=128", "display_name": "ram914", "link": "https://stackoverflow.com/users/5551818/ram914"}, "edited": false, "score": 0, "creation_date": 1576062790, "post_id": 59284181, "comment_id": 104774670, "body": "Instead of doing this, Vertex list[n];  , do Vertex* list; and allocate memory to list by doing, list = (Vertex*) malloc(n*sizeof(Vertex));  and then add each vertex to list as you did. then assign list pointer to vertices pointer. When you declare list as an array, it will be created in stack, which can not be accessed outside Graph_new."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9493541, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204570025486550/picture?type=large", "display_name": "Stoxhorn", "link": "https://stackoverflow.com/users/9493541/stoxhorn"}, "edited": false, "score": 0, "creation_date": 1576062948, "post_id": 59284504, "comment_id": 104774758, "body": "So how would i then save the list of vertex? I&#39;m assuming you mean i would save it directly to grf-&gt;vertices, but i&#39;m not sure how to iterate through it"}, {"owner": {"reputation": 23, "user_id": 9493541, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204570025486550/picture?type=large", "display_name": "Stoxhorn", "link": "https://stackoverflow.com/users/9493541/stoxhorn"}, "edited": false, "score": 0, "creation_date": 1576063110, "post_id": 59284504, "comment_id": 104774839, "body": "As a pointer, i just exchanged list with grf-vertices, and somehow it gave me the correct output for all my prints statements so far. If that was it, you are a god"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 23, "user_id": 9493541, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204570025486550/picture?type=large", "display_name": "Stoxhorn", "link": "https://stackoverflow.com/users/9493541/stoxhorn"}, "edited": false, "score": 0, "creation_date": 1576063173, "post_id": 59284504, "comment_id": 104774870, "body": "@Stoxhorn You need to allocate memory to <code>verices</code> --&gt; <code>grf-&gt;vertices = malloc(sizeof(Vertex ) *n) ;</code> before accessing it."}, {"owner": {"reputation": 23, "user_id": 9493541, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204570025486550/picture?type=large", "display_name": "Stoxhorn", "link": "https://stackoverflow.com/users/9493541/stoxhorn"}, "edited": false, "score": 0, "creation_date": 1576063368, "post_id": 59284504, "comment_id": 104774980, "body": "Already did that, but it was really just the whole assigning to list instead of grf-&gt;vertices."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 23, "user_id": 9493541, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204570025486550/picture?type=large", "display_name": "Stoxhorn", "link": "https://stackoverflow.com/users/9493541/stoxhorn"}, "edited": false, "score": 0, "creation_date": 1576063432, "post_id": 59284504, "comment_id": 104775016, "body": "@Stoxhorn  You are allocating wrongly, <code>grf-&gt;vertices = malloc(sizeof(Vertex*)*n);</code> --&gt; <code>grf-&gt;vertices = malloc(sizeof(Vertex)*n);</code>. Also consider my point about memory leak."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 3, "last_activity_date": 1576062635, "creation_date": 1576062635, "answer_id": 59284504, "question_id": 59284181, "link": "https://stackoverflow.com/questions/59284181/how-do-i-copy-a-struct-from-an-array-of-structs/59284504#59284504", "title": "How do i copy a struct from an array of structs?", "body": "<pre><code>Graph *Graph_new(int n){\n    \u2026\n\n    Vertex list[n];\n    grf-&gt;vertices = malloc(sizeof(Vertex*)*n);\n\n    for(int i = 0; i &lt; n;i++){\n        list[i] = *Vertex_new(i);\n    }\n    grf-&gt;vertices = list;\n\n    \u2026\n\n    return grf;\n}\n</code></pre>\n\n<p><code>list</code> array is local to <code>Graph_new</code> function and will be destroyed once control exits the function, thus you cannot take reference of <code>list</code> out of <code>Graph_new</code> it is undefined behavior.</p>\n\n<p>Also <code>*Vertex_new(i);</code> has memory leaks, as you are loosing reference to the allocation.</p>\n"}], "owner": {"reputation": 23, "user_id": 9493541, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204570025486550/picture?type=large", "display_name": "Stoxhorn", "link": "https://stackoverflow.com/users/9493541/stoxhorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 1, "accepted_answer_id": 59284504, "answer_count": 1, "score": 2, "last_activity_date": 1576065534, "creation_date": 1576061557, "last_edit_date": 1576065534, "question_id": 59284181, "link": "https://stackoverflow.com/questions/59284181/how-do-i-copy-a-struct-from-an-array-of-structs", "title": "How do i copy a struct from an array of structs?", "body": "<p>I realize it gets kind of long with all the <code>printf</code>, but I didn't really know how to present my issue better.</p>\n\n<p>I am having problems initializing a struct in c properly. I have tried debugging with <code>printf</code> to show my issue. Essentially I'm creating a list of structs, using the following function:</p>\n\n<pre><code>Vertex *Vertex_new(int n){\n    Vertex *vert = malloc(sizeof(Vertex));\n    if(!vert){return NULL;}\n\n    vert-&gt;id = n;\n    vert-&gt;outNeighbours = malloc(sizeof(LinkedList));\n    vert-&gt;outNeighbours = LinkedList_new();\n    vert-&gt;inNeighbours = malloc(sizeof(LinkedList));\n    vert-&gt;inNeighbours = LinkedList_new();\n\n    return vert;\n}\n\nstruct Vertex {\n    int id; // a number in [0; numVertices[\n    LinkedList *outNeighbours; // A linked list of vertices.\n    LinkedList *inNeighbours; // A linked list of vertices\n};\n</code></pre>\n\n<p>And that is used for the creation of the following struct, with function right after. The function after, called <code>Graph_new()</code>, I have an issue with saving the <code>Vertex</code>, properly inside the list. I don't know which part I'm doing wrong, but I'm assuming it's something to do with how I'm initializing the list, and as such made a bunch of print statements to try and understand the problem:</p>\n\n<pre><code>struct Graph {\n    int numVertices;\n    int numEdges;\n    Vertex *vertices; // An array of numVertices vertices\n};\n\n\n\nGraph *Graph_new(int n){\n    Graph *grf = malloc(sizeof(Graph));\n    if(!grf){return NULL;}\n\n    grf-&gt;numEdges = 0;\n    grf-&gt;numVertices = n;\n\n    Vertex list[n];\n    grf-&gt;vertices = malloc(sizeof(Vertex*)*n);\n\n    for(int i = 0; i &lt; n;i++){\n        list[i] = *Vertex_new(i);\n    }\n    grf-&gt;vertices = list;\n\n    // My attempt at debugging, `grf` is simply returned after these print statements:\n    printf(\"Inside graph_new for list:\\n\");\n    printf(\"%d \",list[0].id);\n    printf(\"%d \",list[1].id);\n    printf(\"%d \",list[2].id);\n    printf(\"%d \",list[3].id);\n    printf(\"%d \\n\",list[4].id);\n    // Det her virker herinde, men ikke uden for\n    // er der et problem i hvordan jeg gemmer listen?\n    printf(\"Inside graph_new for grf-&gt;vertices:\\n\");\n    printf(\"%d \",grf-&gt;vertices[0].id);\n    printf(\"%d \",grf-&gt;vertices[1].id);\n    printf(\"%d \",grf-&gt;vertices[2].id);\n    printf(\"%d \",grf-&gt;vertices[3].id);\n    printf(\"%d \\n\",grf-&gt;vertices[4].id);\n\n    printf(\"%d \",grf-&gt;vertices[0].id);\n    printf(\"%d \",grf-&gt;vertices[1].id);\n    printf(\"%d \",grf-&gt;vertices[2].id);\n    printf(\"%d \",grf-&gt;vertices[3].id);\n    printf(\"%d \\n\",grf-&gt;vertices[4].id);\n\n\n\n    return grf;\n}\n</code></pre>\n\n<p>In another function, I call <code>graph_new(n)</code>. <code>n</code> is here read from a file, <code>n</code> in this case is 5, which I have tested, to make sure it reads it correctly, so it's a guaranteed 5.\nI tested two way of printing, in order to understand what is happening. The first:</p>\n\n<pre><code>Graph *newG = Graph_new(n);\n\n\n// outside of graph_new:\nprintf(\"outside of graph_new, newG-&gt;vertices:\\n\");\nprintf(\"%d \",newG-&gt;vertices[0].id);\nprintf(\"%d \",newG-&gt;vertices[1].id);\nprintf(\"%d \",newG-&gt;vertices[2].id);\nprintf(\"%d \",newG-&gt;vertices[3].id);\nprintf(\"%d \\n\",newG-&gt;vertices[4].id);\nprintf(\"%d \",newG-&gt;vertices[0].id);\nprintf(\"%d \",newG-&gt;vertices[1].id);\nprintf(\"%d \",newG-&gt;vertices[2].id);\nprintf(\"%d \",newG-&gt;vertices[3].id);\nprintf(\"%d \\n\",newG-&gt;vertices[4].id);\n</code></pre>\n\n<p>Gives the output:</p>\n\n<pre><code>Inside graph_new for list:\n0 1 2 3 4 \nInside graph_new for grf-&gt;vertices:\n0 1 2 3 4 \n0 1 2 3 4 \noutside of graph_new, newG-&gt;vertices:\n0 -285208794 -603392624 -603392624 0 \n0 -285208794 -603392624 -603392624 0\n</code></pre>\n\n<p>So at first I assumed it was because the list was not saved properly, or the vertices was not saved properly inside the list.</p>\n\n<p>But if I then print this outside of <code>Graph_new</code>:</p>\n\n<pre><code>Vertex vert1 = newG-&gt;vertices[0];\nVertex vert2 = newG-&gt;vertices[1];\nVertex vert3 = newG-&gt;vertices[2];\nVertex vert4 = newG-&gt;vertices[3];\nVertex vert5 = newG-&gt;vertices[4];\nprintf(\"works outside:\\n\");\nprintf(\"%d \", vert1.id);\nprintf(\"%d \", vert2.id);\nprintf(\"%d \", vert3.id);\nprintf(\"%d \", vert4.id);\nprintf(\"%d \\n\", vert5.id);  \n\n// Saving the vertices back in the array works\nnewG-&gt;vertices[0] = vert1;\nnewG-&gt;vertices[1] = vert2;\nnewG-&gt;vertices[2] = vert3;\nnewG-&gt;vertices[3] = vert4;\nnewG-&gt;vertices[4] = vert5;\n\nVertex vert11 = newG-&gt;vertices[0];\nVertex vert22 = newG-&gt;vertices[1];\nVertex vert33 = newG-&gt;vertices[2];\nVertex vert44 = newG-&gt;vertices[3];\nVertex vert55 = newG-&gt;vertices[4];  \nprintf(\"Works again\\n\");\nprintf(\"%d \", vert11.id);\nprintf(\"%d \", vert22.id);\nprintf(\"%d \", vert33.id);\nprintf(\"%d \", vert44.id);\nprintf(\"%d \\n\", vert55.id);\n// ------------------------------\n\nprintf(\"Doesn't work: \\n\");\nVertex vvert1 = newG-&gt;vertices[0];\nVertex vvert2 = newG-&gt;vertices[1];\nVertex vvert3 = newG-&gt;vertices[2];\nVertex vvert4 = newG-&gt;vertices[3];\nVertex vvert5 = newG-&gt;vertices[4];\nprintf(\"%d \", vvert1.id);\nprintf(\"%d \", vvert2.id);\nprintf(\"%d \", vvert3.id);\nprintf(\"%d \", vvert4.id);\nprintf(\"%d \\n\", vvert5.id);\n</code></pre>\n\n<p>I get the following output:</p>\n\n<pre><code>Inside graph_new for list:\n0 1 2 3 4 \nInside graph_new for grf-&gt;vertices:\n0 1 2 3 4 \n0 1 2 3 4 \nworks outside:\n0 1 2 3 4 \nWorks again\n0 1 2 3 4 \nDoesn't work: \n0 -2035597530 519880720 -2031896736 -1398417392\n</code></pre>\n\n<p>If anyone is has the time to understand it and give a helping hand, I'd REALLY appreciate it. I might not make it in time for the exam, but at least I'd know what I did wrong.</p>\n"}, {"tags": ["c", "tty", "libudev"], "owner": {"reputation": 19, "user_id": 12517581, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MBj3Ubna6VU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3Rr5duEQ6Ld0amImlAVzoafKWTQ/photo.jpg?sz=128", "display_name": "jwoodw", "link": "https://stackoverflow.com/users/12517581/jwoodw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1576060488, "creation_date": 1576060488, "question_id": 59283788, "link": "https://stackoverflow.com/questions/59283788/how-can-i-detect-usb-serial-port-connections-in-c-on-windows-and-macos", "title": "How can I detect USB serial port connections in C on Windows and macOS?", "body": "<p>Using libudev in Linux I am able to add a handle to an event manger to detect on boot and upon plugging in a USB serial device by monitoring tty events.</p>\n\n<pre><code>self-&gt;udev_monitor = udev_monitor_new_from_netlink(self-&gt;udev, \"udev\");\nudev_monitor_filter_add_match_subsystem_devtype(self-&gt;udev_monitor, \"tty\", NULL);\nudev_monitor_enable_receiving(self-&gt;udev_monitor);\n\nself-&gt;event_manager-&gt;addFD(\n    self-&gt;event_manager\n    ,_udevDeviceAnnounce\n    ,udev_monitor_get_fd(self-&gt;udev_monitor)\n    ,self\n);\n\n_findUdevDevices(self);\n</code></pre>\n\n<p>How can I achieve the same thing on Windows and macOS? I am trying to make a single service written in C compiled for each Windows, Mac and Linux.</p>\n"}, {"tags": ["c", "visual-studio-2019", "realloc"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1576058443, "post_id": 59283107, "comment_id": 104772209, "body": "so, remove the <code>- 1</code>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1576058499, "post_id": 59283107, "comment_id": 104772240, "body": "<code>cnt++</code> and <code>cnt - 1</code>? You increase the value of <code>cnt</code> by one, but then you use the old value of <code>cnt</code> for the reallocation."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1576058533, "post_id": 59283107, "comment_id": 104772255, "body": "The value -842150451 suggests you&#39;re reading uninitialized allocated heap memory."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1576058637, "post_id": 59283107, "comment_id": 104772320, "body": "And <code>if (cnt == 1) arr = NULL;</code> means you will have a memory leak. I think you need to sit down after a good night sleep, and rethink the logic about <code>arr</code> and how you handle it and its reallocations."}, {"owner": {"reputation": 23, "user_id": 9846231, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7HSJiMSazBo/AAAAAAAAAAI/AAAAAAAAlS8/PFJmJMBehPo/photo.jpg?sz=128", "display_name": "David Frucht", "link": "https://stackoverflow.com/users/9846231/david-frucht"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1576059142, "post_id": 59283107, "comment_id": 104772617, "body": "@Someprogrammerdude, thank you for your advice. one of the task i need to do is that if there is no value, then i need to return NULL to arr. that was the task. cnt will increase only when a condition is met. i initated cnt with 1, because i used for malloc."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1576059228, "post_id": 59283107, "comment_id": 104772667, "body": "Could you please explain what this snippet is supposed to do (output given a certain input, logic steps of the algorithm)?"}, {"owner": {"reputation": 23, "user_id": 9846231, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7HSJiMSazBo/AAAAAAAAAAI/AAAAAAAAlS8/PFJmJMBehPo/photo.jpg?sz=128", "display_name": "David Frucht", "link": "https://stackoverflow.com/users/9846231/david-frucht"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1576060018, "post_id": 59283107, "comment_id": 104773089, "body": "@Bob__, yes, it suppose to find the highest value in a row, and then check if it also the highest in the col. if yes, send the value to a dynamic allocated array. if there is no value, then send a NULL pointer to the malloced array."}, {"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1576073010, "post_id": 59283107, "comment_id": 104780190, "body": "What do you mean by &quot;if there is no value, then send a NULL pointer to the malloced array&quot;  ? The confusing part is &quot;if there is no value&quot;. Do you mean &quot;if the highest value in a row is not the highest value in its column&quot; ?"}, {"owner": {"reputation": 23, "user_id": 9846231, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7HSJiMSazBo/AAAAAAAAAAI/AAAAAAAAlS8/PFJmJMBehPo/photo.jpg?sz=128", "display_name": "David Frucht", "link": "https://stackoverflow.com/users/9846231/david-frucht"}, "reply_to_user": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1576073408, "post_id": 59283107, "comment_id": 104780402, "body": "@chmike, yes. You are correct. Sorry for that"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9846231, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7HSJiMSazBo/AAAAAAAAAAI/AAAAAAAAlS8/PFJmJMBehPo/photo.jpg?sz=128", "display_name": "David Frucht", "link": "https://stackoverflow.com/users/9846231/david-frucht"}, "edited": false, "score": 0, "creation_date": 1576078498, "post_id": 59288612, "comment_id": 104783391, "body": "Dear chmike, thank you very much for your detailed and professional help. indeed, it seems to be that the problem was the ptrArr. i certainly learned a lot from your comment."}], "tags": [], "owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "is_accepted": true, "score": 0, "last_activity_date": 1576076782, "last_edit_date": 1576076782, "creation_date": 1576076454, "answer_id": 59288612, "question_id": 59283107, "link": "https://stackoverflow.com/questions/59283107/im-getting-unexpected-behavior-using-realloc/59288612#59288612", "title": "i&#39;m getting unexpected behavior using realloc", "body": "<p>You initially allocate an array with room for one integer, but you never set that integer value. I guess it is because allocating a block of 0 bytes returned NULL which you assume is an error.</p>\n\n<hr>\n\n<p>Another confusing code fragment is </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>cnt++;                                       // this is a counter for realloctaing.\narr = realloc(arr, (cnt - 1) * sizeof(int)); // every iteration the arr is increasing by 1\n</code></pre>\n\n<p>Why initializing <code>cnt</code> to 1 if you want that the size of the allocated array is the number of times we had <code>flag == 1</code> ?</p>\n\n<p>Beside, you never write any value in this array. Assigning a value to <code>*ptrArr</code> would at best overwrite the first value of the array. </p>\n\n<hr>\n\n<p>Another problem it that you initially copy <code>arr</code> to <code>ptrArr</code>. Later, if <code>flag == 1</code> you reallocate <code>arr</code>. A reallocation implies that the input array may be deallocated (free) and a new bigger block is allocated. In this case, when you later assign a value to <code>*ptrArr</code> you won\u2019t write in <code>arr</code>. You will write in deallocated space where you should not write. Worse, if that space is reallocated in the mean time, you may override valid data by mistake, which is a very nasty problem to debug. </p>\n\n<p>I have the impression that you assume that reallocation creates space in front of the block. That is not correct. ralloc, extends the block. So room is added at the end of the block when its size grows. </p>\n\n<p>This implies that you have to <em>append</em> <code>mat[row][indexCol]</code> to the array <code>arr</code> when <code>flag ==\u00a01</code>.</p>\n\n<hr>\n\n<p>Here is how you should handle your array. </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>// initialize the array as empty\nint cnt = 0;\nint *arr = NULL;\n</code></pre>\n\n<p>Note that allocating a block of 0 bytes is implementation dependent. It may or may not return NULL. Here we decide that an empty array is NULL\u00a0and has <code>cnt == 0</code>. </p>\n\n<p>The following code appends the value <code>mat[row][indexCol]</code> to the array:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>// append mat[row][indexCol] to the array arr\narr = realloc(arr, (cnt+1)*sizeof(int));\narr[cnt++] = mat[row][indexCol];\n</code></pre>\n\n<p>This works when <code>arr</code> is NULL because realloc will allocate a new block.</p>\n\n<p>To print all values in the array:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>for(int i = 0; i &lt; cnt; i++)\n    printf(\"%d\\t\", arr[i]);\n</code></pre>\n\n<p>It doesn\u2019t matter if <code>arr == NULL</code> when <code>cnt == 0</code> because <code>arr</code> is never accessed when <code>cnt == 0</code>. </p>\n\n<hr>\n\n<p>There is also a mistake in the code that locates the biggest value in a row. </p>\n\n<p>You initialize <code>tempCol</code> with 0, and compare values with it. If the row contains only negative values that are all smaller than 0, your algorithm will fail to find the biggest value in the row. </p>\n\n<p>In order to find the biggest value in a row, you have two options. </p>\n\n<ol>\n<li><p>Initialize tempCol with the smallest possible value\u00a0:\u00a0INT_MIN (#include &lt;limits.h>). </p></li>\n<li><p>Use the following code that removes the need of <code>tempCol</code>. </p></li>\n</ol>\n\n<pre class=\"lang-c prettyprint-override\"><code>indexCol = 0;\nfor (col = 1; col &lt; COL; col++)\n    if (mat[row][col] &gt; mat[row][indexCol])\n        indexCol = col;\n// here, indexCol is the index of biggest value in the row\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": 0, "last_activity_date": 1576076493, "creation_date": 1576076493, "answer_id": 59288617, "question_id": 59283107, "link": "https://stackoverflow.com/questions/59283107/im-getting-unexpected-behavior-using-realloc/59288617#59288617", "title": "i&#39;m getting unexpected behavior using realloc", "body": "<p>Your problem is mostly likely due to using <code>ptrAtr</code>. You initialise it to the start of <code>arr</code>, but later on you <code>realloc</code> <code>arr</code> and there is no guarantee that <code>arr</code> will remain at the same memory location which means that <code>ptrArr</code> will no longer point into it.</p>\n\n<p>You'd be better off with using an index into <code>arr</code> like this..</p>\n\n<pre><code>int cnt = 0;\narr = (int*)malloc(cnt * sizeof(int));\n\n// stuff happens\n\nif (flag == 1)\n    {\n        arr = realloc(arr, (cnt + 1) * sizeof(int));\n        printf(\"mat[%d][%d] = %d\\n\", row, indexCol, mat[row][indexCol]);\n        arr[cnt++] = mat[row][indexCol];\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9846231, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7HSJiMSazBo/AAAAAAAAAAI/AAAAAAAAlS8/PFJmJMBehPo/photo.jpg?sz=128", "display_name": "David Frucht", "link": "https://stackoverflow.com/users/9846231/david-frucht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 59288612, "answer_count": 2, "score": 0, "last_activity_date": 1576076782, "creation_date": 1576058288, "last_edit_date": 1576064879, "question_id": 59283107, "link": "https://stackoverflow.com/questions/59283107/im-getting-unexpected-behavior-using-realloc", "title": "i&#39;m getting unexpected behavior using realloc", "body": "<p>for some reason, every 2-3 times that i run the program i get unexpected values, such as -842150451 -842150451, and every other time i get the correct result: 7 9.</p>\n\n<p>i'm a student, so sorry if the code is a little academic. </p>\n\n<p>please see code:</p>\n\n<pre><code>int mat[ROW][COL] = {\n    {2,-3,5,1,2},\n    {2,4,7,7,1},\n    {1,9,7,3,0}\n};\n\nint row, col, tempRow = 0, tempCol = 0, indexCol, indexRow = 0, loopTempRow, flag = 0, cnt = 1, loopTempCol = 0;\nint* arr;\nint* ptrArr;\n\narr = (int*)malloc(cnt * sizeof(int)); // mallocating an array with size 1 * int\nptrArr = arr;\n\nif (arr == NULL)    // checking allocation done succefully\n{\n    printf(\"Error Allocating Memory\\n\");\n    exit(1);\n}\n\n\nfor (row = 0; row &lt; ROW; row++) // starting from row 0 we will wheck col 0,1,2,3,4 for the highest val.\n{\n    flag = 1;\n    tempCol = 0;\n\n    for (col = 0; col &lt; COL; col++)\n    {\n        if (mat[row][col] &gt; tempCol)\n        {\n            tempCol = mat[row][col];\n            indexCol = col;\n        }\n    }\n    for (loopTempRow = 0; loopTempRow &lt; ROW; loopTempRow++) // then we will check the row of the col index\n    {\n\n        if (mat[loopTempRow][indexCol] &gt; tempCol)\n        {\n            flag = 0;\n            break;\n        }\n    }\n\n    if (flag == 1)\n    {\n        cnt++;                                                      // this is a counter for realloctaing.\n        arr = realloc(arr, (cnt - 1) * sizeof(int));                            // every iteration the arr is increasing by 1\n        printf(\"mat[%d][%d] = %d\\n\", row, indexCol, mat[row][indexCol]);\n        *ptrArr = mat[row][indexCol];                                       // inserting the element into the arr\n        ptrArr++;\n    }\n}\n\nif (cnt == 1)                                           // if the cnt = 1, it means that flag didn't became 1. which meant no value inserted to the arr\n    arr = NULL;\n\n\n\n\nfor (ptrArr = arr; ptrArr - arr &lt; cnt - 1; ptrArr++)                        // print arr\n    printf(\"%d\\t\", *ptrArr);\n\nfree(arr);\n</code></pre>\n\n<p>}</p>\n\n<p>i suspect that the problem is with the realloc block:</p>\n\n<pre><code>if (flag == 1)\n    {\n        cnt++;                                                      // this is a counter for realloctaing.\n        arr = realloc(arr, (cnt - 1) * sizeof(int));                            // every iteration the arr is increasing by 1\n        printf(\"mat[%d][%d] = %d\\n\", row, indexCol, mat[row][indexCol]);\n        *ptrArr = mat[row][indexCol];                                       // inserting the element into the arr\n        ptrArr++;\n    }\n}\n</code></pre>\n"}, {"tags": ["javascript", "c", "clang", "webassembly"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1576058054, "post_id": 59282861, "comment_id": 104772013, "body": "<code>int add_ptr() { return (int) add; }</code> is invalid. You can&#39;t convert a pointer to an <code>int</code>. It might work on a 32-bit system where both <code>int</code> and pointers are 32 bits wide (but it&#39;s still incorrect) but on a 64-bit system where <code>int</code> is <i>still</i> 32 bits but pointers are 64 bits, you will most likely get some really bad results."}, {"owner": {"reputation": 8032, "user_id": 1414809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/63e622128f1f2b74858a10c1a60707fb?s=128&d=identicon&r=PG", "display_name": "Ebrahim Byagowi", "link": "https://stackoverflow.com/users/1414809/ebrahim-byagowi"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1576058544, "post_id": 59282861, "comment_id": 104772263, "body": "Correct, fixed, thanks for the tip :) The intention here is to avoid having such function of course"}], "answers": [{"tags": [], "owner": {"reputation": 64343, "user_id": 249933, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/458f2e0d08d4114f8b323798cfea141d?s=128&d=identicon&r=PG", "display_name": "ColinE", "link": "https://stackoverflow.com/users/249933/coline"}, "is_accepted": true, "score": 3, "last_activity_date": 1576058794, "creation_date": 1576058794, "answer_id": 59283267, "question_id": 59282861, "link": "https://stackoverflow.com/questions/59282861/get-address-of-a-webassembly-exported-function/59283267#59283267", "title": "Get address of a WebAssembly exported function?", "body": "<p>With WebAssembly functions, and the executable code they contain, live in a different namespace from data. As a result, you cannot obtain an address / pointer to a function and use that as an indirect mechanism for calling it.</p>\n\n<p>What I think you are seeing in your code is the indices of the functions within the WebAssembly module's <a href=\"https://webassembly.org/docs/modules/#function-and-code-sections\" rel=\"nofollow noreferrer\">function section</a>.</p>\n\n<pre><code>add_ptr: 1\nmul_ptr: 2\nop_ptr: 3\n</code></pre>\n\n<p>It is possible to perform dynamic function invocation via the underlying <code>call_indirect</code> WebAssembly operation. This allows you to call functions that are stored in the <a href=\"https://webassembly.org/docs/modules/#table-section\" rel=\"nofollow noreferrer\">table section</a>.</p>\n\n<p>However, I'm unsure whether the clang compiler supports a way to capitalise on this feature in order to support the behaviour you are looking for.</p>\n"}], "owner": {"reputation": 8032, "user_id": 1414809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/63e622128f1f2b74858a10c1a60707fb?s=128&d=identicon&r=PG", "display_name": "Ebrahim Byagowi", "link": "https://stackoverflow.com/users/1414809/ebrahim-byagowi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 1, "accepted_answer_id": 59283267, "answer_count": 1, "score": 4, "last_activity_date": 1577015950, "creation_date": 1576057561, "last_edit_date": 1577015950, "question_id": 59282861, "link": "https://stackoverflow.com/questions/59282861/get-address-of-a-webassembly-exported-function", "title": "Get address of a WebAssembly exported function?", "body": "<p>Assuming having this C code,</p>\n\n<pre><code>int add(int a, int b) { return a + b; }\nint mul(int a, int b) { return a * b; }\nvoid *add_ptr() { return add; }\nvoid *mul_ptr() { return mul; }\nint op(int a, int b, int (*op) (int a, int b)) { return op(a, b); }\nvoid *op_ptr() { return op; }\n</code></pre>\n\n<p>And compile it using a regular clang 8/9 to build a wasm file,</p>\n\n<p><code>clang --target=wasm32 a.c -nostdlib -Wl,--no-entry -Wl,--export=add -Wl,--export=mul -Wl,--export=mul_ptr -Wl,--export=add_ptr -Wl,--export=op -Wl,--export=op_ptr -o a.wasm</code></p>\n\n<p>And run it using a html page like,</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;script&gt;\nWebAssembly.instantiateStreaming(fetch('a.wasm')).then(result =&gt; alert(`\nadd: ${result.instance.exports.add(2, 3)}\nmul: ${result.instance.exports.mul(2, 3)}\n\nop_add: ${result.instance.exports.op(2, 3, result.instance.exports.add_ptr())}\nop_mul: ${result.instance.exports.op(2, 3, result.instance.exports.mul_ptr())}\n\nadd_ptr: ${result.instance.exports.add_ptr()}\nmul_ptr: ${result.instance.exports.mul_ptr()}\nop_ptr: ${result.instance.exports.op_ptr()}\n\nadd.name: ${result.instance.exports.add.name}\nmul.name: ${result.instance.exports.mul.name}\nadd_ptr.name: ${result.instance.exports.add_ptr.name}\nmul_ptr.name: ${result.instance.exports.mul_ptr.name}\nop.name: ${result.instance.exports.op.name}\n`));\n&lt;/script&gt;\n</code></pre>\n\n<p>Which gives,</p>\n\n<pre><code>add: 5\nmul: 6\n\nop_add: 5\nop_mul: 6\n\nadd_ptr: 1\nmul_ptr: 2\nop_ptr: 3\n\nadd.name: 0\nmul.name: 1\nadd_ptr.name: 2\nmul_ptr.name: 3\nop.name: 4\n</code></pre>\n\n<p>What is the reliable way to get pointer address of <code>add</code>/<code>mul</code> in WebAssembly instance without having <code>{add|mul}_ptr</code> like functions? It can't be <code>.name</code> as <code>op.name</code> is different from <code>op_ptr</code> result.</p>\n\n<p>The final intention here (I've reduced my usecase to this snippet) is to have <code>add</code> or <code>mul</code> address and pass it to <code>op</code> like function that gets a function pointer. </p>\n"}, {"tags": ["c", "encryption", "aes"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1576057693, "post_id": 59282772, "comment_id": 104771827, "body": "Basically you create a parent function that fetches all filenames and calls your encryption routine for each file. The base path is <code>argv[0]</code> less the program name."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1576057822, "post_id": 59282772, "comment_id": 104771898, "body": "Instead of the <code>FILE</code> pointers, pass a single filename. The function encrypts to a temporary file, upon success removes the input file and renames the temporary file to the input filename. You may also want to set the file dates to the original - the contents hasn&#39;t changed."}], "owner": {"reputation": 587, "user_id": 2627859, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7723ae4b92dab7513fa9e6c98ef5d1ca?s=128&d=identicon&r=PG", "display_name": "rshah", "link": "https://stackoverflow.com/users/2627859/rshah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "closed_date": 1576058357, "answer_count": 0, "score": 0, "last_activity_date": 1576057238, "creation_date": 1576057238, "question_id": 59282772, "link": "https://stackoverflow.com/questions/59282772/encryption-function-for-all-files-in-same-directory-as-program", "closed_reason": "Duplicate", "title": "Encryption function for all files in same directory as program", "body": "<p>I currently am using the following program for encrypting files using AES:</p>\n\n<pre><code>#include &lt;openssl/aes.h&gt;\n\nvoid encrypt(FILE *ifp, FILE *ofp){\n  int bytes_read, bytes_written;\n  unsigned char indata[AES_BLOCK_SIZE];\n  unsigned char outdata[AES_BLOCK_SIZE];\n\n  /* ckey and ivec are the two 128-bits keys necesary to\n     en- and recrypt your data. Note that ckey can be\n     192 or 256 bits as well */\n  unsigned char ckey[] =  \"thiskeyisverybad\";\n  unsigned char ivec[] = \"dontusethisinput\";\n\n  /* data structure that contains the key itself */\n  AES_KEY key;\n\n  /* set the encryption key */\n  AES_set_encrypt_key(ckey, 128, &amp;key);\n\n  /* set where on the 128 bit encrypted block to begin encryption*/\n  int num = 0;\n\n  while (1) {\n    bytes_read = fread(indata, 1, AES_BLOCK_SIZE, ifp);\n\n    AES_cfb128_encrypt(indata, outdata, bytes_read, &amp;key, ivec, &amp;num,\n           AES_ENCRYPT);\n\n    bytes_written = fwrite(outdata, 1, bytes_read, ofp);\n    if (bytes_read &lt; AES_BLOCK_SIZE)\n  break;\n  }\n}\n</code></pre>\n\n<p>However, how can I make this program encrypt all the files in the same folder as the running program itself, instead of taking a file as input?</p>\n"}, {"tags": ["c", "stm32", "interrupt-handling", "stm32cubeide"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1576056904, "post_id": 59282628, "comment_id": 104771364, "body": "How is this related to the C# language? And are you really programming in C++ and not plain C?"}, {"owner": {"reputation": 338, "user_id": 3181761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5106e5769492b5c84b9abb97afb5ef48?s=128&d=identicon&r=PG&f=1", "display_name": "Nefrin", "link": "https://stackoverflow.com/users/3181761/nefrin"}, "edited": false, "score": 0, "creation_date": 1576056977, "post_id": 59282628, "comment_id": 104771410, "body": "this is also not related to C++. This is (Embedded) C"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1576059046, "post_id": 59282628, "comment_id": 104772553, "body": "So just move the declaration of <code>lcd</code> from inside <code>main</code> block scope to file scope, make it a symbol with external linkage and make it visible in the function that you need to use that symbol. What exactly is your question? <code>STM32F1xx_it.h</code> - why do you define a function in a <code>.h</code> file?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1576059491, "post_id": 59282628, "comment_id": 104772791, "body": "Turns out that hiding pointers behind a typedef was a bad idea. <code>void Display(Lcd_HandleTypeDef lcd) {    Lcd_cursor(&amp;lcd..</code> is major code smell. How does that even compile? Get rid of <code>Lcd_HandleTypeDef </code> and replace it with some sane API that doesn&#39;t use &quot;handles&quot;. Then all your bugs will surface by themselves."}], "owner": {"reputation": 1, "user_id": 7786619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29ae3ea736f7e6ecb64a7cf85fddebbd?s=128&d=identicon&r=PG&f=1", "display_name": "milad Chalipa", "link": "https://stackoverflow.com/users/7786619/milad-chalipa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576058957, "creation_date": 1576056753, "last_edit_date": 1576058957, "question_id": 59282628, "link": "https://stackoverflow.com/questions/59282628/use-of-created-lcd-instance-in-an-interrupt-routine", "title": "Use of created LCD instance in an Interrupt routine", "body": "<p>I'm working on a project which uses <code>STM32F103C8T6</code> and <code>HD44780 LCD (2x16)</code> to produce variable frequency <code>PWM</code>. I use the <code>\"4ilo HD44780 LCD library\"</code> and create an instance of LCD in the main.c called <code>\"&amp;lcd\"</code>. </p>\n\n<p>The problem is when trying to use print something to LCD in the Interrupt routine, I got some errors about undeclaring &amp;lcd because the declaration of LCD is in the <code>main.c</code> file not <code>STM32F1xx_it.h</code>. I tried to place the Interrupt handler in <code>main.c</code> but not a success. \nany help would be appreciated</p>\n\n<p>this is <code>STM32F1xx_it.h</code> :</p>\n\n<pre><code>void EXTI0_IRQHandler(void)\n{\n  /* USER CODE BEGIN EXTI0_IRQn 0 */\nif(EXTI-&gt;PR &amp; EXTI_PR_PR0)\n        {\n            EXTI-&gt;PR |= EXTI_PR_PR0;\n            if(GPIOA-&gt;IDR &amp; 0x0002) //0000 0000 0000 0010 -&gt; check A1 status\n            {\n                power+=IncDec_Power_value;\n                if (power &gt; maxpowerlimit) power = maxpowerlimit;\n            }\n            else\n            {\n                power-=IncDec_Power_value;\n                if (power &lt; minpowerlimit) power = minpowerlimit;\n            }\n        }\n  /* USER CODE END EXTI0_IRQn 0 */\n  HAL_GPIO_EXTI_IRQHandler(GPIO_PIN_0);\n  /* USER CODE BEGIN EXTI0_IRQn 1 */\n\n  /* USER CODE END EXTI0_IRQn 1 */\n}\n</code></pre>\n\n<p>and main.c</p>\n\n<pre><code>/* Includes ------------------------------------------------------------------*/\n#include \"main.h\"\n\n/* Private includes ----------------------------------------------------------*/\n/* USER CODE BEGIN Includes */\n#include \"stm32f1xx.h\"\n#include \"lcd.h\"\n/* USER CODE END Includes */\n\n/* Private typedef -----------------------------------------------------------*/\n/* USER CODE BEGIN PTD */\n\n/* USER CODE END PTD */\n\n/* Private define ------------------------------------------------------------*/\n/* USER CODE BEGIN PD */\n#define LCDD4Port GPIOB\n#define LCDD4Pin GPIO_PIN_12\n#define LCDD5Port GPIOB\n#define LCDD5Pin GPIO_PIN_13\n#define LCDD6Port GPIOB\n#define LCDD6Pin GPIO_PIN_14\n#define LCDD7Port GPIOB\n#define LCDD7Pin GPIO_PIN_15\n#define LCDRegisterSelectPort GPIOB\n#define LCDRegisterSelectPin GPIO_PIN_5\n#define LCDEnablePort GPIOB\n#define LCDEnablePin GPIO_PIN_7\n/* USER CODE END PD */\n\n/* Private macro -------------------------------------------------------------*/\n/* USER CODE BEGIN PM */\n\n/* USER CODE END PM */\n\n/* Private variables ---------------------------------------------------------*/\n\n/* USER CODE BEGIN PV */\nextern volatile float power;\nextern volatile float time;\n/* USER CODE END PV */\n\n/* Private function prototypes -----------------------------------------------*/\nvoid SystemClock_Config(void);\nstatic void MX_GPIO_Init(void);\n/* USER CODE BEGIN PFP */\n/* USER CODE END PFP */\n\n/* Private user code ---------------------------------------------------------*/\n/* USER CODE BEGIN 0 */\nvoid Display(Lcd_HandleTypeDef lcd)\n{\n      Lcd_cursor(&amp;lcd, 1, 2);\n      Lcd_float(&amp;lcd, power, sizeof(power)+1);\n      Lcd_string(&amp;lcd, \" \");\n      Lcd_cursor(&amp;lcd, 1, 10);\n      Lcd_float(&amp;lcd, time, sizeof(time)+1);\n      Lcd_string(&amp;lcd, \" \");\n}\n\n/* USER CODE END 0 */\n\n/**\n  * @brief  The application entry point.\n  * @retval int\n  */\nint main(void)\n{\n  /* USER CODE BEGIN 1 */\n  /* USER CODE END 1 */\n\n\n  /* MCU Configuration--------------------------------------------------------*/\n\n  /* Reset of all peripherals, Initializes the Flash interface and the Systick. */\n  HAL_Init();\n\n  /* USER CODE BEGIN Init */\n\n  /* USER CODE END Init */\n\n  /* Configure the system clock */\n  SystemClock_Config();\n\n  /* USER CODE BEGIN SysInit */\n\n  /* USER CODE END SysInit */\n\n  /* Initialize all configured peripherals */\n  MX_GPIO_Init();\n  /* USER CODE BEGIN 2 */\n\n  Lcd_PortType ports[] ={LCDD4Port, LCDD5Port, LCDD6Port, LCDD7Port};\n  Lcd_PinType pins[] = {LCDD4Pin, LCDD5Pin, LCDD6Pin, LCDD7Pin};\n  Lcd_HandleTypeDef lcd;\n  lcd = Lcd_create(ports, pins, LCDRegisterSelectPort, LCDRegisterSelectPin, LCDEnablePort, \n  LCDEnablePin, LCD_4_BIT_MODE);\n  Lcd_clear_Display(&amp;lcd);\n  Lcd_cursor(&amp;lcd, 0, 2);\n  Lcd_string(&amp;lcd, \"POWER\");\n  Lcd_cursor(&amp;lcd, 0, 10);\n  Lcd_string(&amp;lcd, \"TIME\");\n  Lcd_cursor(&amp;lcd, 1, 2);\n  Lcd_float(&amp;lcd, power, sizeof(power)+1);\n  Lcd_string(&amp;lcd, \" \");\n  Lcd_cursor(&amp;lcd, 1, 10);\n  Lcd_float(&amp;lcd, time, sizeof(time)+1);\n  Lcd_string(&amp;lcd, \" \");\n  /* USER CODE END 2 */\n\n  /* Infinite loop */\n  /* USER CODE BEGIN WHILE */\n  while (1)\n  {\n      Lcd_cursor(&amp;lcd, 1, 2);\n      Lcd_float(&amp;lcd, power, sizeof(power)+1);\n      Lcd_string(&amp;lcd, \" \");\n      Lcd_cursor(&amp;lcd, 1, 10);\n      Lcd_float(&amp;lcd, time, sizeof(time)+1);\n      Lcd_string(&amp;lcd, \" \");\n    /* USER CODE END WHILE */\n\n    /* USER CODE BEGIN 3 */\n  }\n  /* USER CODE END 3 */\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 1, "creation_date": 1576056462, "post_id": 59282432, "comment_id": 104771120, "body": "Where is your <code>pCurrentMenu;</code> pointing?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1576056710, "post_id": 59282432, "comment_id": 104771271, "body": "And where/how do you allocate memory. Post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 7, "user_id": 12512855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf494f0ddcd14c53061ba6bd788f562a?s=128&d=identicon&r=PG&f=1", "display_name": "PyTwi", "link": "https://stackoverflow.com/users/12512855/pytwi"}, "edited": false, "score": 0, "creation_date": 1576056797, "post_id": 59282432, "comment_id": 104771304, "body": "Yes, my bad, edited"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1576057323, "post_id": 59282432, "comment_id": 104771630, "body": "<code>NAV_MainMenuItems</code> is not an array of pointers."}], "answers": [{"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 0, "last_activity_date": 1576057473, "creation_date": 1576057473, "answer_id": 59282839, "question_id": 59282432, "link": "https://stackoverflow.com/questions/59282432/flexible-array-of-structure-in-a-structure-in-c/59282839#59282839", "title": "Flexible array of structure in a structure in C", "body": "<pre><code>/* Menu structure */\ntypedef struct _NAV_Menu\n{\n    const char*             Header;     /* Title */\n    const uint8_t           NbItems;    /* Number of choices in the menu */\n    void (*callbackFnct)(void);         /* Selected item function */\n    const s_LCD_MenuItem*   Items[];    /* Menu array of Items */\n} s_NAV_Menu; \n</code></pre>\n\n<p><code>Items</code> is array of pointers of type <code>s_LCD_MenuItem</code>. </p>\n\n<p>Maybe you wanted pointer to array of type <code>s_LCD_MenuItem</code>.</p>\n\n<pre><code>typedef struct _NAV_Menu\n{\n    const char*             Header;     /* Title */\n    const uint8_t           NbItems;    /* Number of choices in the menu */\n    void (*callbackFnct)(void);         /* Selected item function */\n    const s_LCD_MenuItem*   Items;    /* Menu array of Items */\n} s_NAV_Menu; \n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 12512855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf494f0ddcd14c53061ba6bd788f562a?s=128&d=identicon&r=PG&f=1", "display_name": "PyTwi", "link": "https://stackoverflow.com/users/12512855/pytwi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 59282839, "answer_count": 1, "score": -2, "last_activity_date": 1576058332, "creation_date": 1576056177, "last_edit_date": 1576057047, "question_id": 59282432, "link": "https://stackoverflow.com/questions/59282432/flexible-array-of-structure-in-a-structure-in-c", "title": "Flexible array of structure in a structure in C", "body": "<p>As written in the title, i might have a problem with flexible array in structure.\nI am simply trying to move a pointeur from a const menu to an other. I want to extract some data from the current menu and send them out:</p>\n\n<pre><code>    static void DoMainMenuAction(void);\n\n    /* Type */\n    typedef enum _LCD_ItemType\n    {\n        E_LCD_ITEM_TYPE_BOOL,\n        E_LCD_ITEM_TYPE_EXPANDABLE,\n        E_LCD_ITEM_TYPE_ACTION      \n    }e_LCD_ItemType;\n\n    /* Menu Item */\n    typedef struct _LCD_MenuItem\n    {\n        char*           Name;\n        e_LCD_ItemType  Type;\n    }s_LCD_MenuItem;\n\n    /* Menu structure */\n    typedef struct _NAV_Menu\n    {\n        const char*             Header;     /* Title */\n        const uint8_t           NbItems;    /* Number of choices in the menu */\n        void (*callbackFnct)(void);         /* Selected item function */\n        const s_LCD_MenuItem*   Items[];    /* Menu array of Items */\n    } s_NAV_Menu; \n\n    /* Main Menu */\n    static const s_LCD_MenuItem NAV_MainMenuItems[] = {\n        { \"&lt;&lt; Back\",            E_LCD_ITEM_TYPE_ACTION      },\n        { \"General Settings\",   E_LCD_ITEM_TYPE_EXPANDABLE  },\n        { \"About\",              E_LCD_ITEM_TYPE_ACTION      }\n    };\n    static const s_NAV_Menu NAV_MainMenu = {\n       \"Menu\",\n        3,\n        &amp;DoMainMenuAction,\n        (s_LCD_MenuItem*)&amp;NAV_MainMenuItems\n    };\n\n    /* Pointer of current menu */\n    static s_NAV_Menu* pCurrentMenu;\n\n    static void NAV_LcdDisplay()\n    {    \n        uint8_t indexItem = 0;\n\n        /* Move to the Main Menu */             \n        pCurrentMenu = (s_NAV_Menu*)&amp;NAV_MainMenu;\n\n        s_LCD_MenuItem NAV_LCD_MenuItems[pCurrentMenu-&gt;NbItems];\n\n        for ( indexItem = 0; indexItem &lt; pCurrentMenu-&gt;NbItems; indexItem++ )\n        {\n            NAV_LCD_MenuItems[indexItem].Name = pCurrentMenu-&gt;Items[indexItem]-&gt;Name;\n            NAV_LCD_MenuItems[indexItem].Type = pCurrentMenu-&gt;Items[indexItem]-&gt;Type;       \n        }\n\n        LCD_Send(NAV_LCD_MenuItems);\n    }\n</code></pre>\n\n<p>My problem appears during the second iteration of the FOR loop:</p>\n\n<p>First loop, i obtain:\n<a href=\"https://i.stack.imgur.com/Sewsh.png\" rel=\"nofollow noreferrer\">1st iteration</a></p>\n\n<p>At second iteration, when i try to read Items Name, i jump to the Dummy Handler.</p>\n\n<p>Can someone help please?</p>\n"}, {"tags": ["c", "gtk", "gtk3", "gdk", "gtkscrolledwindow"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1576053757, "post_id": 59281749, "comment_id": 104769670, "body": "<a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask</a>"}, {"owner": {"reputation": 694, "user_id": 8627962, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4f-Yq3BvCaA/AAAAAAAAAAI/AAAAAAAAARM/NeJoNAwQHT0/photo.jpg?sz=128", "display_name": "Siva Guru", "link": "https://stackoverflow.com/users/8627962/siva-guru"}, "edited": false, "score": 0, "creation_date": 1576135357, "post_id": 59281749, "comment_id": 104802346, "body": "There are a lot of scroll function in GtkTextView documentation. please refer to them (<a href=\"https://developer.gnome.org/gtk3/stable/GtkTextView.html#gtk-text-view-scroll-mark-onscreen\" rel=\"nofollow noreferrer\">developer.gnome.org/gtk3/stable/&hellip;</a>)"}, {"owner": {"reputation": 3, "user_id": 7930976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71dc2521a4cc9212aaaab6a40c82ffe0?s=128&d=identicon&r=PG&f=1", "display_name": "Archith", "link": "https://stackoverflow.com/users/7930976/archith"}, "edited": false, "score": 0, "creation_date": 1578025506, "post_id": 59281749, "comment_id": 105313689, "body": "thanks, but there is no textview ,it&#39;s a scrolled window with a few labels in a grid"}], "owner": {"reputation": 3, "user_id": 7930976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71dc2521a4cc9212aaaab6a40c82ffe0?s=128&d=identicon&r=PG&f=1", "display_name": "Archith", "link": "https://stackoverflow.com/users/7930976/archith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576834406, "creation_date": 1576053633, "last_edit_date": 1576834406, "question_id": 59281749, "link": "https://stackoverflow.com/questions/59281749/how-to-scroll-a-scrolledwindow-with-arrow-keys-in-gtk-3-24-5", "title": "How to Scroll a ScrolledWindow with arrow keys in Gtk 3.24.5?", "body": "<p>I have a gtk entry right below the scrolled window which has the default focus , left and right keys move the cursor in the entry ,I am able to catch the key press events for up and down arrow keys but don't know how to scroll the scrolled window, referred many websites none of them were clear or explained only in parts.</p>\n\n<p>Below are some of the pages I went through:\n<a href=\"https://mail.gnome.org/archives/gtk-devel-list/2002-February/msg00104.html\" rel=\"nofollow noreferrer\">https://mail.gnome.org/archives/gtk-devel-list/2002-February/msg00104.html</a></p>\n\n<p><a href=\"https://developer.gnome.org/gtkmm-tutorial/stable/sec-keyboardevents-overview.html.en\" rel=\"nofollow noreferrer\">https://developer.gnome.org/gtkmm-tutorial/stable/sec-keyboardevents-overview.html.en</a></p>\n\n<p>tried using gtk_scrolled_window_set_vadjustment() couldn't get it working.\nThe official page says GTK_SCROLL_STEP_UP is deprecated but doesn't say what should be used instead.</p>\n\n<p>Every answer would be very appreciated.Thanks</p>\n\n<pre><code>bool MethodSelect::cb_MPWindowKeyPress(GtkWidget *wgt, GdkEventKey *event, MethodSelect *ms)\n{\n    if(event-&gt;keyval == GDK_KEY_Up || event-&gt;keyval == GDK_KEY_Down)\n    {  \n    // METH_SEL_INFO_DEBUG(\"%s\",gdk_keyval_name (event-&gt;keyval));\n        g_signal_emit_by_name(ms-&gt;ScrolledWindow, \"scroll-child\",(event-&gt;keyval == GDK_KEY_Up)?GTK_SCROLL_STEP_UP:GTK_SCROLL_STEP_DOWN);\n//The above line works in gtk 3.14.5 but crashes the app in 3.24.5 \n        return TRUE;\n    }\n\n    return FALSE;\n}\n</code></pre>\n"}, {"tags": ["c", "assembly", "clang", "x86-64", "callstack"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1576053429, "post_id": 59281598, "comment_id": 104769500, "body": "The documentation seems to say it\u2019s only supported on AARCH64 in the later versions so it might be there was something wrong on x86 earlier"}, {"owner": {"reputation": 41, "user_id": 12516742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/034805159654557a14d47fd4a458360f?s=128&d=identicon&r=PG&f=1", "display_name": "lonelyBit", "link": "https://stackoverflow.com/users/12516742/lonelybit"}, "reply_to_user": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1576053921, "post_id": 59281598, "comment_id": 104769744, "body": "I notices that this feature has performance and security issues in x64. But I think in my situation this feature can not even work. My target is to test it in x64. So I&#39;m still trying to enable it."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1576061635, "post_id": 59282564, "comment_id": 104774041, "body": "Insecure?  Is it <i>worse</i> than just using the callstack for automatic storage?  (I&#39;m somewhat curious about the design, but not enough to go digging through design documents or the code myself.  If you have any links to a useful summary of the design and/or what&#39;s wrong with it on x86-64, that&#39;d be neat.)"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1576062314, "post_id": 59282564, "comment_id": 104774392, "body": "@PeterCordes No, it is probably a bit better, but as I read between the lines it is not worth the performance penalty and may lead to a false sense of security. As for the design: Not more than the linked <code>Clang</code> documentation: At the top is a counter with the size of the shadow call stack, which gets incremented and decremented. The values are put and fetched from the offset there. Quite simple. When you are - as an attacker - able to write to arbitrary memory locations, it depends on the choice/randomness of the memory location how easy the exploitation is."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1576062343, "post_id": 59282564, "comment_id": 104774407, "body": "@PeterCordes I could not find a comprehensive evaluation how it is particularly insecure or inefficient."}, {"owner": {"reputation": 41, "user_id": 12516742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/034805159654557a14d47fd4a458360f?s=128&d=identicon&r=PG&f=1", "display_name": "lonelyBit", "link": "https://stackoverflow.com/users/12516742/lonelybit"}, "edited": false, "score": 0, "creation_date": 1576062755, "post_id": 59282564, "comment_id": 104774647, "body": "@Ctx What should I put in baseaddr? The address of main()?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 41, "user_id": 12516742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/034805159654557a14d47fd4a458360f?s=128&d=identicon&r=PG&f=1", "display_name": "lonelyBit", "link": "https://stackoverflow.com/users/12516742/lonelybit"}, "edited": false, "score": 0, "creation_date": 1576063398, "post_id": 59282564, "comment_id": 104774994, "body": "@lonelyBit No, the address of the shadow call stack (which has to be valid somehow)."}, {"owner": {"reputation": 41, "user_id": 12516742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/034805159654557a14d47fd4a458360f?s=128&d=identicon&r=PG&f=1", "display_name": "lonelyBit", "link": "https://stackoverflow.com/users/12516742/lonelybit"}, "edited": false, "score": 0, "creation_date": 1576063775, "post_id": 59282564, "comment_id": 104775197, "body": "@Ctx How can I get the address of shadow call stack? Is it specified in _start() function by myself? If yes, how can I verify if the address is valid? I&#39;m a beginner in this field and sorry for cosuming your time."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 41, "user_id": 12516742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/034805159654557a14d47fd4a458360f?s=128&d=identicon&r=PG&f=1", "display_name": "lonelyBit", "link": "https://stackoverflow.com/users/12516742/lonelybit"}, "edited": false, "score": 0, "creation_date": 1576064518, "post_id": 59282564, "comment_id": 104775565, "body": "@lonelyBit: from the return value of a big (like 8MiB) <code>malloc</code> or <code>mmap</code> to allocate space for this second stack.  Or just use static storage, like a big static <code>char</code> array that can go in the BSS."}, {"owner": {"reputation": 41, "user_id": 12516742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/034805159654557a14d47fd4a458360f?s=128&d=identicon&r=PG&f=1", "display_name": "lonelyBit", "link": "https://stackoverflow.com/users/12516742/lonelybit"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1576065164, "post_id": 59282564, "comment_id": 104775883, "body": "@PeterCordes I failed with <code>linker command failed with exit code 1</code>. Does it mean the address is invalid? My code is: <code>char * addr = (char *) malloc(sizeof(char)*100);</code>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 41, "user_id": 12516742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/034805159654557a14d47fd4a458360f?s=128&d=identicon&r=PG&f=1", "display_name": "lonelyBit", "link": "https://stackoverflow.com/users/12516742/lonelybit"}, "edited": false, "score": 0, "creation_date": 1576065592, "post_id": 59282564, "comment_id": 104776094, "body": "@lonelyBit: oh, are you trying to write your own <code>_start</code> in C?  It&#39;s not a function, you need some inline asm (or <i>very</i> dirty hacks).  And if you replace the CRT&#39;s <code>_start</code>, it&#39;s up to you to call <code>atexit</code> functions after <code>main</code> returns, and so on...    <a href=\"//stackoverflow.com/q/50260855\">How Get arguments value using inline assembly in C without Glibc?</a> shows how to write your own minimal <code>_start</code> which you can link <i>instead</i> of the normal CRT, using <code>-nostartfiles</code>.  Don&#39;t use this for anything but experimentation, and definitely not unless / until you&#39;re an asm expert."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1576065722, "post_id": 59282564, "comment_id": 104776141, "body": "The easiest is probably to disassemble crt1.o, put it in your own, custom mycrt1.S, add the commands to 1) allocate space for the callstack, 2) set the gs register accordingly, assemble it and use it instead of the default crt1.o. This is not an easy task, all in all!"}, {"owner": {"reputation": 41, "user_id": 12516742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/034805159654557a14d47fd4a458360f?s=128&d=identicon&r=PG&f=1", "display_name": "lonelyBit", "link": "https://stackoverflow.com/users/12516742/lonelybit"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1576069799, "post_id": 59282564, "comment_id": 104778294, "body": "@PeterCordes I checked again and found that once I use <code>arch_prctl</code> even if in a normal function Clang will throw <code>linker command failed with exit code 1</code>. I don&#39;t know why."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 41, "user_id": 12516742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/034805159654557a14d47fd4a458360f?s=128&d=identicon&r=PG&f=1", "display_name": "lonelyBit", "link": "https://stackoverflow.com/users/12516742/lonelybit"}, "edited": false, "score": 0, "creation_date": 1576069904, "post_id": 59282564, "comment_id": 104778354, "body": "@lonelyBit As I said, the syscall is not wrapped by the libc, you have to use the syscall-macro or call it directly from asm."}, {"owner": {"reputation": 41, "user_id": 12516742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/034805159654557a14d47fd4a458360f?s=128&d=identicon&r=PG&f=1", "display_name": "lonelyBit", "link": "https://stackoverflow.com/users/12516742/lonelybit"}, "edited": false, "score": 0, "creation_date": 1576070073, "post_id": 59282564, "comment_id": 104778445, "body": "@Ctx Do you have any guide or link about that?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 41, "user_id": 12516742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/034805159654557a14d47fd4a458360f?s=128&d=identicon&r=PG&f=1", "display_name": "lonelyBit", "link": "https://stackoverflow.com/users/12516742/lonelybit"}, "edited": false, "score": 0, "creation_date": 1576070256, "post_id": 59282564, "comment_id": 104778558, "body": "<a href=\"https://gist.github.com/MerryMage/f22e75d5128c07d77630ca01c4272937\" rel=\"nofollow noreferrer\">gist.github.com/MerryMage/f22e75d5128c07d77630ca01c4272937</a> &lt;- This  might give you an idea @lonelyBit"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 41, "user_id": 12516742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/034805159654557a14d47fd4a458360f?s=128&d=identicon&r=PG&f=1", "display_name": "lonelyBit", "link": "https://stackoverflow.com/users/12516742/lonelybit"}, "edited": false, "score": 0, "creation_date": 1576071477, "post_id": 59282564, "comment_id": 104779249, "body": "@lonelyBit: if your CPU supports <a href=\"https://www.felixcloutier.com/x86/wrfsbase:wrgsbase\" rel=\"nofollow noreferrer\"><code>wrgsbase</code></a> (I think since Broadwell or Skylake?), you can just use that instruction if the kernel enables it for use by user-space. But honestly, if you don&#39;t even know enough to post the actual linker error message about which symbol it couldn&#39;t find, instead of <i>failed with exit code 1</i> from some wrapper that ran it, let alone debug it yourself, writing your own <code>_start</code> to set GS base and then playing with clang&#39;s shadow stacks is probably out of reach until you get more experience with asm and tools."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1576078378, "post_id": 59282564, "comment_id": 104783308, "body": "&quot;However, the shadow call stack feature is considered not only inefficient, but also insecure on x86_64 and it was removed in later versions&quot; &lt;-- do you have a citation for this? I don&#39;t doubt your claim but I would like to read about it."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 1, "creation_date": 1576078504, "post_id": 59282564, "comment_id": 104783395, "body": "@R.. See the latest version 10: <a href=\"https://clang.llvm.org/docs/ShadowCallStack.html\" rel=\"nofollow noreferrer\">clang.llvm.org/docs/ShadowCallStack.html</a> (<i>An x86_64 implementation was evaluated using Chromium and was found to have critical performance and security deficiencies\u2013it was removed in LLVM 9.0.</i>). Unfortunately, no details on this evaluation can be found (at least not easily)"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 1, "creation_date": 1576079853, "post_id": 59282564, "comment_id": 104784174, "body": "@R.. I have digged up this with some numbers, not much either, though: <a href=\"https://www.phoronix.com/scan.php?page=news_item&amp;px=LLVM-Drops-ShadowCallStack-x64\" rel=\"nofollow noreferrer\">phoronix.com/&hellip;</a>"}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": false, "score": 5, "last_activity_date": 1576057747, "last_edit_date": 1576057747, "creation_date": 1576056572, "answer_id": 59282564, "question_id": 59281598, "link": "https://stackoverflow.com/questions/59281598/how-can-i-use-shadow-call-stack-feature-of-clang-8-in-x86-64/59282564#59282564", "title": "how can I use &quot;shadow call stack&quot; feature of clang-8 in x86_64?", "body": "<p>The problem is, that the <em>runtime environment</em> has to initialize the <code>gs</code> register to point to a location, where the shadow call stack can be stored. This is not said very explicitly, but can be derived from <a href=\"https://releases.llvm.org/7.0.1/tools/clang/docs/ShadowCallStack.html\" rel=\"nofollow noreferrer\">the Clang documentation</a>:</p>\n\n<blockquote>\n  <p>ShadowCallStack currently only supports x86_64 and aarch64. A runtime is not currently provided in compiler-rt so one must be provided by the compiled application.</p>\n</blockquote>\n\n<p>With the standard runtime, the <code>gs</code> register points nowhere, so the write access fails with a segmentation fault. Android libc provides such a runtime.</p>\n\n<p>However, the shadow call stack feature is considered not only inefficient, but also insecure on x86_64 and it was removed in later versions. You should think carefully if you really want to use this feature. If you still do, then you have to prepare the runtime environment with the <code>gs</code> register properly initialized.</p>\n\n<p>There is a syscall <code>arch_prctl()</code> (not wrapped by libc), which can be used to set the <code>gs</code> register:</p>\n\n<pre><code>arch_prctl(ARCH_SET_GS, baseaddr);\n</code></pre>\n\n<p>This could be a good start, but it has to be called, <em>before</em> the shadow call stack is populated (i.e. before <code>main()</code>). A good point is to initialize it in the <code>_start()</code> function, which is usually located in the unit <code>crt1.o</code> or similar.</p>\n"}], "owner": {"reputation": 41, "user_id": 12516742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/034805159654557a14d47fd4a458360f?s=128&d=identicon&r=PG&f=1", "display_name": "lonelyBit", "link": "https://stackoverflow.com/users/12516742/lonelybit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 2, "answer_count": 1, "score": 4, "last_activity_date": 1576061558, "creation_date": 1576053088, "last_edit_date": 1576061558, "question_id": 59281598, "link": "https://stackoverflow.com/questions/59281598/how-can-i-use-shadow-call-stack-feature-of-clang-8-in-x86-64", "title": "how can I use &quot;shadow call stack&quot; feature of clang-8 in x86_64?", "body": "<p>Recently, I'm trying to test the \"shadow call stack\" feature of clang-8 in x86_64. But when I run the \"shadowed\" program, it keeps throwing out segmentation fault even if it's a \"Hello_World\" program.\nMy compiling command is \"clang-8 -fsanitize=shadow-call-stack normal.c\".\n\"normal.c\" is just a simple hello_world c program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(int argc, char *argv[])\n{\n    printf(\"Hello World!\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>The assembler codes for main function are here:</p>\n\n<pre><code>   0x0000000000401130 &lt;+0&gt;: mov    (%rsp),%r10\n   0x0000000000401134 &lt;+4&gt;: xor    %r11,%r11\n   0x0000000000401137 &lt;+7&gt;: addq   $0x8,%gs:(%r11)\n   0x000000000040113c &lt;+12&gt;:    mov    %gs:(%r11),%r11\n   0x0000000000401140 &lt;+16&gt;:    mov    %r10,%gs:(%r11)\n   0x0000000000401144 &lt;+20&gt;:    push   %rbp\n   0x0000000000401145 &lt;+21&gt;:    mov    %rsp,%rbp\n   0x0000000000401148 &lt;+24&gt;:    sub    $0x20,%rsp\n   0x000000000040114c &lt;+28&gt;:    movl   $0x0,-0x4(%rbp)\n   0x0000000000401153 &lt;+35&gt;:    mov    %edi,-0x8(%rbp)\n   0x0000000000401156 &lt;+38&gt;:    mov    %rsi,-0x10(%rbp)\n   0x000000000040115a &lt;+42&gt;:    movabs $0x402004,%rdi\n   0x0000000000401164 &lt;+52&gt;:    mov    $0x0,%al\n   0x0000000000401166 &lt;+54&gt;:    callq  0x401030 &lt;printf@plt&gt;\n   0x000000000040116b &lt;+59&gt;:    xor    %ecx,%ecx\n   0x000000000040116d &lt;+61&gt;:    mov    %eax,-0x14(%rbp)\n   0x0000000000401170 &lt;+64&gt;:    mov    %ecx,%eax\n   0x0000000000401172 &lt;+66&gt;:    add    $0x20,%rsp\n   0x0000000000401176 &lt;+70&gt;:    pop    %rbp\n   0x0000000000401177 &lt;+71&gt;:    xor    %r11,%r11\n   0x000000000040117a &lt;+74&gt;:    mov    %gs:(%r11),%r10\n   0x000000000040117e &lt;+78&gt;:    mov    %gs:(%r10),%r10\n   0x0000000000401182 &lt;+82&gt;:    subq   $0x8,%gs:(%r11)\n   0x0000000000401187 &lt;+87&gt;:    cmp    %r10,(%rsp)\n   0x000000000040118b &lt;+91&gt;:    jne    0x401192 &lt;main+98&gt;\n   0x0000000000401191 &lt;+97&gt;:    retq   \n   0x0000000000401192 &lt;+98&gt;:    ud2\n</code></pre>\n\n<p>When I run this program, it throws:</p>\n\n<pre><code>Program received signal SIGSEGV, Segmentation fault.\n0x0000000000401137 in main ()\n</code></pre>\n\n<p>In <a href=\"https://releases.llvm.org/8.0.0/tools/clang/docs/ShadowCallStack.html\" rel=\"nofollow noreferrer\">clang-8 documentation</a>, it identifies this feature makes use of x86's gs register. But the actual run shows there is some issue. Is it the problem of gs register? Can anyone help me? Thanks in advance.</p>\n"}, {"tags": ["c", "char", "wchar"], "comments": [{"owner": {"reputation": 8251, "user_id": 2912665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XrRhd.jpg?s=128&g=1", "display_name": "CinCout", "link": "https://stackoverflow.com/users/2912665/cincout"}, "edited": false, "score": 0, "creation_date": 1576043592, "post_id": 59279603, "comment_id": 104765779, "body": "this is C, not C++"}, {"owner": {"reputation": 810, "user_id": 3711083, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Jc853.png?s=128&g=1", "display_name": "inputforcolor", "link": "https://stackoverflow.com/users/3711083/inputforcolor"}, "reply_to_user": {"reputation": 8251, "user_id": 2912665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XrRhd.jpg?s=128&g=1", "display_name": "CinCout", "link": "https://stackoverflow.com/users/2912665/cincout"}, "edited": false, "score": 1, "creation_date": 1576044292, "post_id": 59279603, "comment_id": 104765986, "body": "Welcome to Stack Overflow _ As suggested by @CinCout, you should tag your past properly with &#39;C&#39;. Also, I just Googled the title of your question and found 4-5 SO answers that already exist... You should do the same, in case one of them helps you."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1576052828, "post_id": 59280877, "comment_id": 104769239, "body": "<code>gets</code> and <code>gets_s</code> are both discouraged, use <code>fgets</code>/<code>fgetws</code>."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1576069440, "last_edit_date": 1576069440, "creation_date": 1576049917, "answer_id": 59280877, "question_id": 59279603, "link": "https://stackoverflow.com/questions/59279603/cannot-convert-lpcwstr-aka-const-wchar-t-to-const-char-for-argument-1/59280877#59280877", "title": "cannot convert &#39;LPCWSTR {aka const wchar_t*}&#39; to &#39;const char*&#39; for argument &#39;1&#39; to &#39;int printf(const char*, ...)&#39;", "body": "<p>Depending on your project configuration, <code>_tprintf()</code> maps to either <code>printf()</code> when <code>TCHAR</code> maps to <code>char</code>, or maps to <code>wprintf()</code> for <code>wchar_t</code>. Clearly your project is set to map <code>TCHAR</code> to <code>char</code>, which is why you are getting an error about passing a <code>wchar_t*</code> to <code>printf()</code>. </p>\n\n<p>But, the code you showed is not using <code>TCHAR</code>, so you should not be using  <code>_tprintf()</code> at all. <code>m_szFilename</code> is explicitly a <code>wchar_t[]</code>, so just use <code>wprintf()</code> directly instead:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>wprintf(m_szFilename);\n</code></pre>\n\n<p>Also, consider using <code>wscanf()</code> to read the input as a <code>wchar_t[]</code> to begin with and not use an intermediate <code>char[]</code>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>WCHAR szExePath[MAX_PATH]; //\n//L\"C:\\\\Program Files (x86)\\\\Application Verifier\\\\vrfauto.dll\"\nprintf(\"Please input the execution file path:\\n\");\nwscanf(L\"%259s\", szExePath);\n\nsetlocale(LC_ALL, \"chs\");\nwprintf(szExePath);\n</code></pre>\n\n<p>Note, however, that whether you use <code>scanf()</code> or <code>wscanf()</code>, reading stops on whitespace, so if the user enters a path like <code>\"C:\\Program Files (x86)\\Application Verifier\\vrfauto.dll\"</code>, your buffer will receive only <code>\"C:\\Program</code>. To account for that, you would need to use <code>gets()</code>/<code>_getws()</code> (or the safer <code>gets_s()</code>/<code>_getws_s()</code>) or <code>fgets()</code>/<code>fgetws()</code> instead.</p>\n"}], "owner": {"reputation": 1, "user_id": 7477339, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-n1tay2PZxKY/AAAAAAAAAAI/AAAAAAAAABU/dY-CBiTf__8/photo.jpg?sz=128", "display_name": "zakir shah", "link": "https://stackoverflow.com/users/7477339/zakir-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576069440, "creation_date": 1576043534, "last_edit_date": 1576050904, "question_id": 59279603, "link": "https://stackoverflow.com/questions/59279603/cannot-convert-lpcwstr-aka-const-wchar-t-to-const-char-for-argument-1", "title": "cannot convert &#39;LPCWSTR {aka const wchar_t*}&#39; to &#39;const char*&#39; for argument &#39;1&#39; to &#39;int printf(const char*, ...)&#39;", "body": "<p>I never try coding in C for the last four or five years so I don't know how to solve this problem.</p>\n\n<p>My code is like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char szExePath[MAX_PATH]; //\n//\"C:\\\\Program Files (x86)\\\\Application Verifier\\\\vrfauto.dll\"\nprintf(\"Please input the execution file path:\\n\");\nscanf(\"%s\", szExePath);\n//char LPCWSTR\nWCHAR wsz[64];\nswprintf(wsz, L\"%S\", szExePath);\nLPCWSTR m_szFilename = wsz;\n\nsetlocale(LC_ALL, \"chs\");\n_tprintf(m_szFilename);\n</code></pre>\n"}, {"tags": ["c", "malloc"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1576042595, "post_id": 59279372, "comment_id": 104765472, "body": "I think you meant <code>(n+1) * sizeof(int)</code>"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 1, "creation_date": 1576042813, "post_id": 59279372, "comment_id": 104765525, "body": "@r0bin_dood Operator precedence. <code>malloc(n + 1 * sizeof(int));</code> --&gt; <code>malloc((n + 1) * sizeof(int));</code>"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1576042846, "post_id": 59279372, "comment_id": 104765536, "body": "Multiplication has higher precedence, so <code>n + 1 * sizeof(int)</code> is the same as <code>n + sizeof(int)</code>"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1576042907, "post_id": 59279372, "comment_id": 104765557, "body": "@user3386109 That&#39;s good catch by the way."}, {"owner": {"reputation": 41, "user_id": 12145703, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NgmAQ.jpg?s=128&g=1", "display_name": "r0bin_dood", "link": "https://stackoverflow.com/users/12145703/r0bin-dood"}, "edited": false, "score": 0, "creation_date": 1576042926, "post_id": 59279372, "comment_id": 104765563, "body": "Yes I know, but I totally didn&#39;t think that was the problem, it completely flew over my head!!"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1576043002, "post_id": 59279372, "comment_id": 104765587, "body": "The answer is in the first error message from valgrind. It tells you the line number where the memory was allocated (test.c:46), and the line number where the code writes past the end of the array (test.c:49)."}, {"owner": {"reputation": 41, "user_id": 12145703, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NgmAQ.jpg?s=128&g=1", "display_name": "r0bin_dood", "link": "https://stackoverflow.com/users/12145703/r0bin-dood"}, "edited": false, "score": 0, "creation_date": 1576043149, "post_id": 59279372, "comment_id": 104765631, "body": "Ooooooooh, I see, thank you so much!! This was such a headache for such a simple problem"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1576043301, "post_id": 59279372, "comment_id": 104765672, "body": "You did a great job writing the question. It&#39;s not often that a question has all of the necessary information. Well done!"}, {"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 1, "creation_date": 1576043444, "post_id": 59279372, "comment_id": 104765714, "body": "Am I the only one seeing that in the <code>swap()</code> routine, the return value from <code>malloc()</code> is thrown away on the second statement?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 0, "creation_date": 1576043731, "post_id": 59279372, "comment_id": 104765832, "body": "@SteveFriedl Good point, that should still show up in the leak report from valgrind."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1576050096, "post_id": 59279372, "comment_id": 104768023, "body": "This program appears to have major memory leaks all over it."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1576058511, "post_id": 59279372, "comment_id": 104772247, "body": "What is special about <code>11</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 12145703, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NgmAQ.jpg?s=128&g=1", "display_name": "r0bin_dood", "link": "https://stackoverflow.com/users/12145703/r0bin-dood"}, "is_accepted": false, "score": 2, "last_activity_date": 1576042961, "last_edit_date": 1576042961, "creation_date": 1576042885, "answer_id": 59279494, "question_id": 59279372, "link": "https://stackoverflow.com/questions/59279372/malloc-assertion-failed/59279494#59279494", "title": "malloc Assertion Failed", "body": "<p>fixed by changing line, </p>\n\n<p>from: </p>\n\n<p><code>m = malloc(n + 1 * sizeof(int));</code> </p>\n\n<p>to </p>\n\n<pre><code>m = malloc((n + 1) * sizeof(int));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "is_accepted": false, "score": 2, "last_activity_date": 1576043839, "creation_date": 1576043839, "answer_id": 59279667, "question_id": 59279372, "link": "https://stackoverflow.com/questions/59279372/malloc-assertion-failed/59279667#59279667", "title": "malloc Assertion Failed", "body": "<p>An additional point:</p>\n\n<pre><code>void swap(char **s, int a, int b) \n{\n    char *t;\n    t = malloc(11 * sizeof(char));\n\n    t = s[a];    // Memory leak occurs at this point\n    s[a] = s[b];\n    s[b] = t;\n}\n</code></pre>\n\n<p>The <code>malloc()</code> call allocates 11 bytes and assigns it to the <code>t</code> local variable, but <em>on the next line</em> that value is thrown away by assigning <code>s[a]</code> to it, and this is guaranteed to be a memory leak if <code>swap()</code> is ever called.</p>\n"}], "owner": {"reputation": 41, "user_id": 12145703, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NgmAQ.jpg?s=128&g=1", "display_name": "r0bin_dood", "link": "https://stackoverflow.com/users/12145703/r0bin-dood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1576043839, "creation_date": 1576042169, "question_id": 59279372, "link": "https://stackoverflow.com/questions/59279372/malloc-assertion-failed", "title": "malloc Assertion Failed", "body": "<p>I wrote a program that takes lexicographically ordered strings and performs the next lexicographically ordered permutation of those strings, ex:</p>\n\n<pre><code>strings: a b c d\na b c d\na b d c\na c b d\na c d b\na d b c\na d c b\n...\nd c b a\n</code></pre>\n\n<p>If a string is repeated you gotta make sure steps aren't, ex:</p>\n\n<pre><code>strings: a bc bc\nNOT GOOD   GOOD\na bc bc    a bc bc\na bc bc    bc a bc\nbc a bc    bc bc a\nbc bc a\nbc bc a\nbc a bc\n</code></pre>\n\n<p>This programs works great for n number of strings up to 5, but it has to work up to 9.\nOn 6 however, the program aborts and I don't know how to fix it. I know what the problem is, at least I think I do, but this is already long enough, here's the code and the errors I get when running the program normally, with pwngdb, and valgrind.</p>\n\n<p>****SPOILERS**** This problem is from HackerRank, if you have yet to figure it out refrain from looking at this, answers, and comments.</p>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid \nswap(char **s, int a, int b) \n{\n    char *t;\n    t = malloc(11 * sizeof(char));\n\n    t = s[a];\n    s[a] = s[b];\n    s[b] = t;\n}\n\nvoid \nsort(char **s, int d, int n) \n{\n    int i, k;\n\n    for(k = 0; k &lt;= n; k++)\n        for(i = d + 1; i &lt; n; i++)\n            if(strcmp(s[i-1], s[i]) &gt; 0)\n                swap(s, i-1, i);\n}\n\nvoid \nto_string(char **s, char *t, int n) \n{\n    int i;\n    for(i = 0; i &lt; n; i++)\n        if(i == 0)\n            strcpy(t, s[i]);\n        else\n            strcat(t, s[i]);\n}\n\nint next_permutation(int n, char **s)\n{\n    /**\n    * Complete this method\n    * Return 0 when there is no next permutation and 1 otherwise\n    * Modify array s to its next permutation\n    */\n    int i;\n\n    static unsigned int *p, p_step, *m, lock;\n\n    if(!lock) {\n        p       = calloc(n + 1, sizeof(int));\n        p_step  = 1;\n        m       = malloc(n + 1 * sizeof(int));\n        m[0]    = 0;\n        for(i = 1; i &lt;= n; i++)\n            m[i] = n;\n\n        p[0]    = 1;\n        for(i = 1; i &lt;= n; i++)\n            p[i] = p[i - 1] * i;\n\n        lock    = 1;\n    }\n\n    if(p_step &gt;= p[n])\n        return 0;\n\n    char *pre, *post;\n    pre     = malloc(11 * n * sizeof(char)); // I think these two are the trouble makers, maybe not\n    post    = malloc(11 * n * sizeof(char));\n\n    to_string(s, pre, n);\n\n    int d = 1;\n    for(i = 1; i &lt;= n; i++)\n        if(!(p_step % p[i]))\n            d = i;\n\n    if((n - d - 1) &gt;= --m[d])\n        m[d] = n - 1;\n\n    swap(s, n - d - 1 , m[d]);\n\n    to_string(s, post, n);\n\n    p_step++;\n    if(!strcmp(pre, post)) \n    {\n        if(p_step &gt;= p[n] - 1)\n            return 0;\n        next_permutation(n, s);\n    }\n\n    sort(s, n - d, n);\n\n    return 1;\n}\n\nint main()\n{\n    char **s;\n    int n;\n    scanf(\"%d\", &amp;n);\n    s = calloc(n, sizeof(char*));\n    for (int i = 0; i &lt; n; i++)\n    {\n        s[i] = calloc(11, sizeof(char));\n        scanf(\"%s\", s[i]);\n    }\n    do\n    {\n        for (int i = 0; i &lt; n; i++)\n            printf(\"%s%c\", s[i], i == n - 1 ? '\\n' : ' ');\n    } while (next_permutation(n, s));\n    for (int i = 0; i &lt; n; i++)\n        free(s[i]);\n    free(s);\n    return 0;\n}\n</code></pre>\n\n<pre><code>$ ./a.out\n6\na\nb\nc\nd\ne\nf\na b c d e f\na.out: malloc.c:2379: sysmalloc: Assertion `(old_top == initial_top (av) &amp;&amp; old_size == 0) || ((unsigned long) (old_size) &gt;= MINSIZE &amp;&amp; prev_inuse (old_top) &amp;&amp; ((unsigned long) old_end &amp; (pagesize - 1)) == 0)' failed.\nAborted (core dumped)\n</code></pre>\n\n<pre><code>pwndbg&gt; run\nStarting program: /home/TESTS/a.out \n6\na\nb\nc\nd\ne\nf\na b c d e f\na.out: malloc.c:2379: sysmalloc: Assertion `(old_top == initial_top (av) &amp;&amp; old_size == 0) || ((unsigned long) (old_size) &gt;= MINSIZE &amp;&amp; prev_inuse (old_top) &amp;&amp; ((unsigned long) old_end &amp; (pagesize - 1)) == 0)' failed.\n\nProgram received signal SIGABRT, Aborted.\n__GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:50\n50  ../sysdeps/unix/sysv/linux/raise.c: No such file or directory.\nLEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500[ REGISTERS ]\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n RAX  0x0\n RBX  0x7ffff7f96540 \u25c2\u2014 0x7ffff7f96540\n RCX  0x7ffff7dea3eb (raise+203) \u25c2\u2014 mov    rax, qword ptr [rsp + 0x108]\n RDX  0x0\n RDI  0x2\n RSI  0x7fffffffd960 \u25c2\u2014 0x0\n R8   0x0\n R9   0x7fffffffd960 \u25c2\u2014 0x0\n R10  0x8\n R11  0x246\n R12  0x0\n R13  0x1000\n R14  0x555555559c00 \u25c2\u2014 0x600000006\n R15  0x3\n RBP  0x50\n RSP  0x7fffffffd960 \u25c2\u2014 0x0\n RIP  0x7ffff7dea3eb (raise+203) \u25c2\u2014 mov    rax, qword ptr [rsp + 0x108]\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500[ DISASM ]\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n \u25ba 0x7ffff7dea3eb &lt;raise+203&gt;    mov    rax, qword ptr [rsp + 0x108]\n   0x7ffff7dea3f3 &lt;raise+211&gt;    xor    rax, qword ptr fs:[0x28]\n   0x7ffff7dea3fc &lt;raise+220&gt;    jne    raise+260 &lt;0x7ffff7dea424&gt;\n    \u2193\n   0x7ffff7dea424 &lt;raise+260&gt;    call   __stack_chk_fail &lt;0x7ffff7ed6dd0&gt;\n\n   0x7ffff7dea429                nop    dword ptr [rax]\n   0x7ffff7dea430 &lt;killpg&gt;       endbr64 \n   0x7ffff7dea434 &lt;killpg+4&gt;     test   edi, edi\n   0x7ffff7dea436 &lt;killpg+6&gt;     js     killpg+16 &lt;0x7ffff7dea440&gt;\n\n   0x7ffff7dea438 &lt;killpg+8&gt;     neg    edi\n   0x7ffff7dea43a &lt;killpg+10&gt;    jmp    kill &lt;0x7ffff7dea6e0&gt;\n\n   0x7ffff7dea43f &lt;killpg+15&gt;    nop    \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500[ STACK ]\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n00:0000\u2502 rsi r9 rsp  0x7fffffffd960 \u25c2\u2014 0x0\n01:0008\u2502             0x7fffffffd968 \u2014\u25b8 0x7ffff7f959d8 \u2014\u25b8 0x7ffff7fd0a06 \u25c2\u2014 'GLIBC_PRIVATE'\n02:0010\u2502             0x7fffffffd970 \u2014\u25b8 0x7ffff7ffd9e8 (_rtld_global+2440) \u2014\u25b8 0x7ffff7fd0000 \u25c2\u2014 0x10102464c457f\n03:0018\u2502             0x7fffffffd978 \u2014\u25b8 0x7ffff7ffe4f0 \u2014\u25b8 0x7ffff7ffe450 \u2014\u25b8 0x7ffff7f95520 \u2014\u25b8 0x7ffff7ffe190 \u25c2\u2014 ...\n04:0020\u2502             0x7fffffffd980 \u25c2\u2014 0x0\n05:0028\u2502             0x7fffffffd988 \u2014\u25b8 0x7ffff7dc8aa8 \u25c2\u2014 0x1ea020\n06:0030\u2502             0x7fffffffd990 \u25c2\u2014 0x7fff00000001\n07:0038\u2502             0x7fffffffd998 \u2014\u25b8 0x7ffff7dc8ac0 \u25c2\u2014 0x1ea018\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500[ BACKTRACE ]\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n \u25ba f 0     7ffff7dea3eb raise+203\n   f 1     7ffff7dc9899 abort+299\n   f 2     7ffff7e3c4ba\n   f 3     7ffff7e3eb0f sysmalloc+1855\n   f 4     7ffff7e3f963 _int_malloc+3363\n   f 5     7ffff7e41304 malloc+116\n   f 6     555555555531 next_permutation+318\n   f 7     5555555557dd main+283\n   f 8     7ffff7dcb1e3 __libc_start_main+243\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nProgram received signal SIGABRT\npwndbg&gt; backtrace\n#0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:50\n#1  0x00007ffff7dc9899 in __GI_abort () at abort.c:79\n#2  0x00007ffff7e3c4ba in __malloc_assert (assertion=assertion@entry=0x7ffff7f5f2d8 \"(old_top == initial_top (av) &amp;&amp; old_size == 0) || ((unsigned long) (old_size) &gt;= MINSIZE &amp;&amp; prev_inuse (old_top) &amp;&amp; ((unsigned long) old_end &amp; (pagesize - 1)) == 0)\", file=file@entry=0x7ffff7f5b43f \"malloc.c\", line=line@entry=2379, function=function@entry=0x7ffff7f5fa60 &lt;__PRETTY_FUNCTION__.13032&gt; \"sysmalloc\") at malloc.c:298\n#3  0x00007ffff7e3eb0f in sysmalloc (nb=nb@entry=80, av=av@entry=0x7ffff7f8eb80 &lt;main_arena&gt;) at malloc.c:2379\n#4  0x00007ffff7e3f963 in _int_malloc (av=av@entry=0x7ffff7f8eb80 &lt;main_arena&gt;, bytes=bytes@entry=66) at malloc.c:4141\n#5  0x00007ffff7e41304 in __GI___libc_malloc (bytes=66) at malloc.c:3058\n#6  0x0000555555555531 in next_permutation (n=6, s=0x5555555596b0) at test.c:62\n#7  0x00005555555557dd in main () at test.c:106\n#8  0x00007ffff7dcb1e3 in __libc_start_main (main=0x5555555556c2 &lt;main&gt;, argc=1, argv=0x7fffffffde78, init=&lt;optimized out&gt;, fini=&lt;optimized out&gt;, rtld_fini=&lt;optimized out&gt;, stack_end=0x7fffffffde68) at ../csu/libc-start.c:308\n#9  0x000055555555518e in _start ()\npwndbg&gt; \n</code></pre>\n\n<pre><code>$ valgrind --leak-check=full --show-leak-kinds=all ./a.out\n==23746== Memcheck, a memory error detector\n==23746== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==23746== Using Valgrind-3.15.0 and LibVEX; rerun with -h for copyright info\n==23746== Command: ./a.out\n==23746== \n6\na\nb\nc\nd\ne\nf\na b c d e f\n==23746== Invalid write of size 4\n==23746==    at 0x10947F: next_permutation (test.c:49)\n==23746==    by 0x1097DC: main (test.c:106)\n==23746==  Address 0x4a72b78 is 8 bytes inside a block of size 10 alloc'd\n==23746==    at 0x483A7F3: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n==23746==    by 0x10944A: next_permutation (test.c:46)\n==23746==    by 0x1097DC: main (test.c:106)\n==23746== \na b c d f e\n==23746== Invalid write of size 4\n==23746==    at 0x1095D6: next_permutation (test.c:72)\n==23746==    by 0x1097DC: main (test.c:106)\n==23746==  Address 0x4a72b78 is 8 bytes inside a block of size 10 alloc'd\n==23746==    at 0x483A7F3: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n==23746==    by 0x10944A: next_permutation (test.c:46)\n==23746==    by 0x1097DC: main (test.c:106)\n==23746== \n==23746== Conditional jump or move depends on uninitialised value(s)\n==23746==    at 0x1095DC: next_permutation (test.c:72)\n==23746==    by 0x1097DC: main (test.c:106)\n==23746== \n==23746== Use of uninitialised value of size 8\n==23746==    at 0x1092B1: swap (test.c:10)\n==23746==    by 0x10962A: next_permutation (test.c:75)\n==23746==    by 0x1097DC: main (test.c:106)\n==23746== \n==23746== Use of uninitialised value of size 8\n==23746==    at 0x1092CF: swap (test.c:11)\n==23746==    by 0x10962A: next_permutation (test.c:75)\n==23746==    by 0x1097DC: main (test.c:106)\n==23746== \na b c e d f\na b c e f d\na b c f d e\na b c f e d\n==23746== Invalid read of size 4\n==23746==    at 0x1095D1: next_permutation (test.c:72)\n==23746==    by 0x1097DC: main (test.c:106)\n==23746==  Address 0x4a72b7c is 2 bytes after a block of size 10 alloc'd\n==23746==    at 0x483A7F3: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n==23746==    by 0x10944A: next_permutation (test.c:46)\n==23746==    by 0x1097DC: main (test.c:106)\n==23746== \n==23746== Invalid read of size 4\n==23746==    at 0x1095D8: next_permutation (test.c:72)\n==23746==    by 0x1097DC: main (test.c:106)\n==23746==  Address 0x4a72b7c is 2 bytes after a block of size 10 alloc'd\n==23746==    at 0x483A7F3: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n==23746==    by 0x10944A: next_permutation (test.c:46)\n==23746==    by 0x1097DC: main (test.c:106)\n==23746== \n==23746== Invalid read of size 4\n==23746==    at 0x109610: next_permutation (test.c:75)\n==23746==    by 0x1097DC: main (test.c:106)\n==23746==  Address 0x4a72b7c is 2 bytes after a block of size 10 alloc'd\n==23746==    at 0x483A7F3: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n==23746==    by 0x10944A: next_permutation (test.c:46)\n==23746==    by 0x1097DC: main (test.c:106)\n==23746== \na b d c e f\na b d c f e\n==23746== Invalid write of size 4\n==23746==    at 0x1095FA: next_permutation (test.c:73)\n==23746==    by 0x1097DC: main (test.c:106)\n==23746==  Address 0x4a72b78 is 8 bytes inside a block of size 10 alloc'd\n==23746==    at 0x483A7F3: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n==23746==    by 0x10944A: next_permutation (test.c:46)\n==23746==    by 0x1097DC: main (test.c:106)\n==23746== \na b d e c f\na b d e f c\na b d f c e\na b d f e c\na b e c d f\na b e c f d\na b e d c f\na b e d f c\na b e f c d\na b e f d c\na b f c d e\na b f c e d\na b f d c e\na b f d e c\na b f e c d\na b f e d c\na c b d e f\na c b d f e\na c b e d f\na c b e f d\na c b f d e\na c b f e d\na c d b e f\na c d b f e\na c d e b f\na c d e f b\na c d f b e\na c d f e b\na c e b d f\na c e b f d\na c e d b f\na c e d f b\na c e f b d\na c e f d b\na c f b d e\na c f b e d\na c f d b e\na c f d e b\na c f e b d\na c f e d b\na d b c e f\na d b c f e\na d b e c f\na d b e f c\na d b f c e\na d b f e c\na d c b e f\na d c b f e\na d c e b f\na d c e f b\na d c f b e\na d c f e b\na d e b c f\na d e b f c\na d e c b f\na d e c f b\na d e f b c\na d e f c b\na d f b c e\na d f b e c\na d f c b e\na d f c e b\na d f e b c\na d f e c b\na e b c d f\na e b c f d\na e b d c f\na e b d f c\na e b f c d\na e b f d c\na e c b d f\na e c b f d\na e c d b f\na e c d f b\na e c f b d\na e c f d b\na e d b c f\na e d b f c\na e d c b f\na e d c f b\na e d f b c\na e d f c b\na e f b c d\na e f b d c\na e f c b d\na e f c d b\na e f d b c\na e f d c b\na f b c d e\na f b c e d\na f b d c e\na f b d e c\na f b e c d\na f b e d c\na f c b d e\na f c b e d\na f c d b e\na f c d e b\na f c e b d\na f c e d b\na f d b c e\na f d b e c\na f d c b e\na f d c e b\na f d e b c\na f d e c b\na f e b c d\na f e b d c\na f e c b d\na f e c d b\na f e d b c\na f e d c b\nb a c d e f\nb a c d f e\nb a c e d f\nb a c e f d\nb a c f d e\nb a c f e d\nb a d c e f\nb a d c f e\nb a d e c f\nb a d e f c\nb a d f c e\nb a d f e c\nb a e c d f\nb a e c f d\nb a e d c f\nb a e d f c\nb a e f c d\nb a e f d c\nb a f c d e\nb a f c e d\nb a f d c e\nb a f d e c\nb a f e c d\nb a f e d c\nb c a d e f\nb c a d f e\nb c a e d f\nb c a e f d\nb c a f d e\nb c a f e d\nb c d a e f\nb c d a f e\nb c d e a f\nb c d e f a\nb c d f a e\nb c d f e a\nb c e a d f\nb c e a f d\nb c e d a f\nb c e d f a\nb c e f a d\nb c e f d a\nb c f a d e\nb c f a e d\nb c f d a e\nb c f d e a\nb c f e a d\nb c f e d a\nb d a c e f\nb d a c f e\nb d a e c f\nb d a e f c\nb d a f c e\nb d a f e c\nb d c a e f\nb d c a f e\nb d c e a f\nb d c e f a\nb d c f a e\nb d c f e a\nb d e a c f\nb d e a f c\nb d e c a f\nb d e c f a\nb d e f a c\nb d e f c a\nb d f a c e\nb d f a e c\nb d f c a e\nb d f c e a\nb d f e a c\nb d f e c a\nb e a c d f\nb e a c f d\nb e a d c f\nb e a d f c\nb e a f c d\nb e a f d c\nb e c a d f\nb e c a f d\nb e c d a f\nb e c d f a\nb e c f a d\nb e c f d a\nb e d a c f\nb e d a f c\nb e d c a f\nb e d c f a\nb e d f a c\nb e d f c a\nb e f a c d\nb e f a d c\nb e f c a d\nb e f c d a\nb e f d a c\nb e f d c a\nb f a c d e\nb f a c e d\nb f a d c e\nb f a d e c\nb f a e c d\nb f a e d c\nb f c a d e\nb f c a e d\nb f c d a e\nb f c d e a\nb f c e a d\nb f c e d a\nb f d a c e\nb f d a e c\nb f d c a e\nb f d c e a\nb f d e a c\nb f d e c a\nb f e a c d\nb f e a d c\nb f e c a d\nb f e c d a\nb f e d a c\nb f e d c a\nc a b d e f\nc a b d f e\nc a b e d f\nc a b e f d\nc a b f d e\nc a b f e d\nc a d b e f\nc a d b f e\nc a d e b f\nc a d e f b\nc a d f b e\nc a d f e b\nc a e b d f\nc a e b f d\nc a e d b f\nc a e d f b\nc a e f b d\nc a e f d b\nc a f b d e\nc a f b e d\nc a f d b e\nc a f d e b\nc a f e b d\nc a f e d b\nc b a d e f\nc b a d f e\nc b a e d f\nc b a e f d\nc b a f d e\nc b a f e d\nc b d a e f\nc b d a f e\nc b d e a f\nc b d e f a\nc b d f a e\nc b d f e a\nc b e a d f\nc b e a f d\nc b e d a f\nc b e d f a\nc b e f a d\nc b e f d a\nc b f a d e\nc b f a e d\nc b f d a e\nc b f d e a\nc b f e a d\nc b f e d a\nc d a b e f\nc d a b f e\nc d a e b f\nc d a e f b\nc d a f b e\nc d a f e b\nc d b a e f\nc d b a f e\nc d b e a f\nc d b e f a\nc d b f a e\nc d b f e a\nc d e a b f\nc d e a f b\nc d e b a f\nc d e b f a\nc d e f a b\nc d e f b a\nc d f a b e\nc d f a e b\nc d f b a e\nc d f b e a\nc d f e a b\nc d f e b a\nc e a b d f\nc e a b f d\nc e a d b f\nc e a d f b\nc e a f b d\nc e a f d b\nc e b a d f\nc e b a f d\nc e b d a f\nc e b d f a\nc e b f a d\nc e b f d a\nc e d a b f\nc e d a f b\nc e d b a f\nc e d b f a\nc e d f a b\nc e d f b a\nc e f a b d\nc e f a d b\nc e f b a d\nc e f b d a\nc e f d a b\nc e f d b a\nc f a b d e\nc f a b e d\nc f a d b e\nc f a d e b\nc f a e b d\nc f a e d b\nc f b a d e\nc f b a e d\nc f b d a e\nc f b d e a\nc f b e a d\nc f b e d a\nc f d a b e\nc f d a e b\nc f d b a e\nc f d b e a\nc f d e a b\nc f d e b a\nc f e a b d\nc f e a d b\nc f e b a d\nc f e b d a\nc f e d a b\nc f e d b a\nd a b c e f\nd a b c f e\nd a b e c f\nd a b e f c\nd a b f c e\nd a b f e c\nd a c b e f\nd a c b f e\nd a c e b f\nd a c e f b\nd a c f b e\nd a c f e b\nd a e b c f\nd a e b f c\nd a e c b f\nd a e c f b\nd a e f b c\nd a e f c b\nd a f b c e\nd a f b e c\nd a f c b e\nd a f c e b\nd a f e b c\nd a f e c b\nd b a c e f\nd b a c f e\nd b a e c f\nd b a e f c\nd b a f c e\nd b a f e c\nd b c a e f\nd b c a f e\nd b c e a f\nd b c e f a\nd b c f a e\nd b c f e a\nd b e a c f\nd b e a f c\nd b e c a f\nd b e c f a\nd b e f a c\nd b e f c a\nd b f a c e\nd b f a e c\nd b f c a e\nd b f c e a\nd b f e a c\nd b f e c a\nd c a b e f\nd c a b f e\nd c a e b f\nd c a e f b\nd c a f b e\nd c a f e b\nd c b a e f\nd c b a f e\nd c b e a f\nd c b e f a\nd c b f a e\nd c b f e a\nd c e a b f\nd c e a f b\nd c e b a f\nd c e b f a\nd c e f a b\nd c e f b a\nd c f a b e\nd c f a e b\nd c f b a e\nd c f b e a\nd c f e a b\nd c f e b a\nd e a b c f\nd e a b f c\nd e a c b f\nd e a c f b\nd e a f b c\nd e a f c b\nd e b a c f\nd e b a f c\nd e b c a f\nd e b c f a\nd e b f a c\nd e b f c a\nd e c a b f\nd e c a f b\nd e c b a f\nd e c b f a\nd e c f a b\nd e c f b a\nd e f a b c\nd e f a c b\nd e f b a c\nd e f b c a\nd e f c a b\nd e f c b a\nd f a b c e\nd f a b e c\nd f a c b e\nd f a c e b\nd f a e b c\nd f a e c b\nd f b a c e\nd f b a e c\nd f b c a e\nd f b c e a\nd f b e a c\nd f b e c a\nd f c a b e\nd f c a e b\nd f c b a e\nd f c b e a\nd f c e a b\nd f c e b a\nd f e a b c\nd f e a c b\nd f e b a c\nd f e b c a\nd f e c a b\nd f e c b a\ne a b c d f\ne a b c f d\ne a b d c f\ne a b d f c\ne a b f c d\ne a b f d c\ne a c b d f\ne a c b f d\ne a c d b f\ne a c d f b\ne a c f b d\ne a c f d b\ne a d b c f\ne a d b f c\ne a d c b f\ne a d c f b\ne a d f b c\ne a d f c b\ne a f b c d\ne a f b d c\ne a f c b d\ne a f c d b\ne a f d b c\ne a f d c b\ne b a c d f\ne b a c f d\ne b a d c f\ne b a d f c\ne b a f c d\ne b a f d c\ne b c a d f\ne b c a f d\ne b c d a f\ne b c d f a\ne b c f a d\ne b c f d a\ne b d a c f\ne b d a f c\ne b d c a f\ne b d c f a\ne b d f a c\ne b d f c a\ne b f a c d\ne b f a d c\ne b f c a d\ne b f c d a\ne b f d a c\ne b f d c a\ne c a b d f\ne c a b f d\ne c a d b f\ne c a d f b\ne c a f b d\ne c a f d b\ne c b a d f\ne c b a f d\ne c b d a f\ne c b d f a\ne c b f a d\ne c b f d a\ne c d a b f\ne c d a f b\ne c d b a f\ne c d b f a\ne c d f a b\ne c d f b a\ne c f a b d\ne c f a d b\ne c f b a d\ne c f b d a\ne c f d a b\ne c f d b a\ne d a b c f\ne d a b f c\ne d a c b f\ne d a c f b\ne d a f b c\ne d a f c b\ne d b a c f\ne d b a f c\ne d b c a f\ne d b c f a\ne d b f a c\ne d b f c a\ne d c a b f\ne d c a f b\ne d c b a f\ne d c b f a\ne d c f a b\ne d c f b a\ne d f a b c\ne d f a c b\ne d f b a c\ne d f b c a\ne d f c a b\ne d f c b a\ne f a b c d\ne f a b d c\ne f a c b d\ne f a c d b\ne f a d b c\ne f a d c b\ne f b a c d\ne f b a d c\ne f b c a d\ne f b c d a\ne f b d a c\ne f b d c a\ne f c a b d\ne f c a d b\ne f c b a d\ne f c b d a\ne f c d a b\ne f c d b a\ne f d a b c\ne f d a c b\ne f d b a c\ne f d b c a\ne f d c a b\ne f d c b a\nf a b c d e\nf a b c e d\nf a b d c e\nf a b d e c\nf a b e c d\nf a b e d c\nf a c b d e\nf a c b e d\nf a c d b e\nf a c d e b\nf a c e b d\nf a c e d b\nf a d b c e\nf a d b e c\nf a d c b e\nf a d c e b\nf a d e b c\nf a d e c b\nf a e b c d\nf a e b d c\nf a e c b d\nf a e c d b\nf a e d b c\nf a e d c b\nf b a c d e\nf b a c e d\nf b a d c e\nf b a d e c\nf b a e c d\nf b a e d c\nf b c a d e\nf b c a e d\nf b c d a e\nf b c d e a\nf b c e a d\nf b c e d a\nf b d a c e\nf b d a e c\nf b d c a e\nf b d c e a\nf b d e a c\nf b d e c a\nf b e a c d\nf b e a d c\nf b e c a d\nf b e c d a\nf b e d a c\nf b e d c a\nf c a b d e\nf c a b e d\nf c a d b e\nf c a d e b\nf c a e b d\nf c a e d b\nf c b a d e\nf c b a e d\nf c b d a e\nf c b d e a\nf c b e a d\nf c b e d a\nf c d a b e\nf c d a e b\nf c d b a e\nf c d b e a\nf c d e a b\nf c d e b a\nf c e a b d\nf c e a d b\nf c e b a d\nf c e b d a\nf c e d a b\nf c e d b a\nf d a b c e\nf d a b e c\nf d a c b e\nf d a c e b\nf d a e b c\nf d a e c b\nf d b a c e\nf d b a e c\nf d b c a e\nf d b c e a\nf d b e a c\nf d b e c a\nf d c a b e\nf d c a e b\nf d c b a e\nf d c b e a\nf d c e a b\nf d c e b a\nf d e a b c\nf d e a c b\nf d e b a c\nf d e b c a\nf d e c a b\nf d e c b a\nf e a b c d\nf e a b d c\nf e a c b d\nf e a c d b\nf e a d b c\nf e a d c b\nf e b a c d\nf e b a d c\nf e b c a d\nf e b c d a\nf e b d a c\nf e b d c a\nf e c a b d\nf e c a d b\nf e c b a d\nf e c b d a\nf e c d a b\nf e c d b a\nf e d a b c\nf e d a c b\nf e d b a c\nf e d b c a\nf e d c a b\nf e d c b a\n==23746== \n==23746== HEAP SUMMARY:\n==23746==     in use at exit: 110,599 bytes in 2,863 blocks\n==23746==   total heap usage: 2,872 allocs, 9 frees, 112,761 bytes allocated\n==23746== \n==23746== 10 bytes in 1 blocks are still reachable in loss record 1 of 6\n==23746==    at 0x483A7F3: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n==23746==    by 0x10944A: next_permutation (test.c:46)\n==23746==    by 0x1097DC: main (test.c:106)\n==23746== \n==23746== 28 bytes in 1 blocks are still reachable in loss record 2 of 6\n==23746==    at 0x483CD99: calloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n==23746==    by 0x109428: next_permutation (test.c:44)\n==23746==    by 0x1097DC: main (test.c:106)\n==23746== \n==23746== 7,744 bytes in 704 blocks are definitely lost in loss record 3 of 6\n==23746==    at 0x483A7F3: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n==23746==    by 0x109268: swap (test.c:7)\n==23746==    by 0x109352: sort (test.c:20)\n==23746==    by 0x1096BA: next_permutation (test.c:86)\n==23746==    by 0x1097DC: main (test.c:106)\n==23746== \n==23746== 7,909 bytes in 719 blocks are definitely lost in loss record 4 of 6\n==23746==    at 0x483A7F3: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n==23746==    by 0x109268: swap (test.c:7)\n==23746==    by 0x10962A: next_permutation (test.c:75)\n==23746==    by 0x1097DC: main (test.c:106)\n==23746== \n==23746== 47,454 bytes in 719 blocks are definitely lost in loss record 5 of 6\n==23746==    at 0x483A7F3: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n==23746==    by 0x109530: next_permutation (test.c:62)\n==23746==    by 0x1097DC: main (test.c:106)\n==23746== \n==23746== 47,454 bytes in 719 blocks are definitely lost in loss record 6 of 6\n==23746==    at 0x483A7F3: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n==23746==    by 0x10954C: next_permutation (test.c:63)\n==23746==    by 0x1097DC: main (test.c:106)\n==23746== \n==23746== LEAK SUMMARY:\n==23746==    definitely lost: 110,561 bytes in 2,861 blocks\n==23746==    indirectly lost: 0 bytes in 0 blocks\n==23746==      possibly lost: 0 bytes in 0 blocks\n==23746==    still reachable: 38 bytes in 2 blocks\n==23746==         suppressed: 0 bytes in 0 blocks\n==23746== \n==23746== Use --track-origins=yes to see where uninitialised values come from\n==23746== For lists of detected and suppressed errors, rerun with: -s\n==23746== ERROR SUMMARY: 1598 errors from 13 contexts (suppressed: 0 from 0)\n</code></pre>\n"}, {"tags": ["c", "io", "synchronization"], "comments": [{"owner": {"reputation": 104, "user_id": 12246590, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UbCUVYdKvhw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcwJIdXH8pLRIim5on1bHdeCbIf8A/photo.jpg?sz=128", "display_name": "Willy Cole", "link": "https://stackoverflow.com/users/12246590/willy-cole"}, "edited": false, "score": 0, "creation_date": 1576045831, "post_id": 59279329, "comment_id": 104766492, "body": "make a shared memory between two processes and put file pointer into that"}, {"owner": {"reputation": 15, "user_id": 12317406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62e3205661006c31810c00fb349e9e63?s=128&d=identicon&r=PG&f=1", "display_name": "Fel", "link": "https://stackoverflow.com/users/12317406/fel"}, "reply_to_user": {"reputation": 104, "user_id": 12246590, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UbCUVYdKvhw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcwJIdXH8pLRIim5on1bHdeCbIf8A/photo.jpg?sz=128", "display_name": "Willy Cole", "link": "https://stackoverflow.com/users/12246590/willy-cole"}, "edited": false, "score": 0, "creation_date": 1576055260, "post_id": 59279329, "comment_id": 104770433, "body": "To do then I would take it I would have to make the size of the mmap be sizeof(FILE)? The. It would just update the filepointer location every time I would end up reading the character than I suppose."}, {"owner": {"reputation": 104, "user_id": 12246590, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UbCUVYdKvhw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcwJIdXH8pLRIim5on1bHdeCbIf8A/photo.jpg?sz=128", "display_name": "Willy Cole", "link": "https://stackoverflow.com/users/12246590/willy-cole"}, "edited": false, "score": 0, "creation_date": 1576057367, "post_id": 59279329, "comment_id": 104771655, "body": "no! just put the file pointer on shared memory, i.e. u need to allocate a memory in shm with sizeof(FILE *) which is just an integer value; but beware of shm concurrency when two processes want to access it. u can do this with semaphores"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 12317406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62e3205661006c31810c00fb349e9e63?s=128&d=identicon&r=PG&f=1", "display_name": "Fel", "link": "https://stackoverflow.com/users/12317406/fel"}, "edited": false, "score": 0, "creation_date": 1576084991, "post_id": 59285280, "comment_id": 104786835, "body": "Awesome, sounds good. Seems like a pretty easy solution to my problem. Thanks. Now that I already know how to use the shared memory"}, {"owner": {"reputation": 15, "user_id": 12317406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62e3205661006c31810c00fb349e9e63?s=128&d=identicon&r=PG&f=1", "display_name": "Fel", "link": "https://stackoverflow.com/users/12317406/fel"}, "edited": false, "score": 0, "creation_date": 1576085673, "post_id": 59285280, "comment_id": 104787188, "body": "Okay so then how do I assign the file pointer to the memory address? That one is kinda weird to me."}, {"owner": {"reputation": 104, "user_id": 12246590, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UbCUVYdKvhw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcwJIdXH8pLRIim5on1bHdeCbIf8A/photo.jpg?sz=128", "display_name": "Willy Cole", "link": "https://stackoverflow.com/users/12246590/willy-cole"}, "reply_to_user": {"reputation": 15, "user_id": 12317406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62e3205661006c31810c00fb349e9e63?s=128&d=identicon&r=PG&f=1", "display_name": "Fel", "link": "https://stackoverflow.com/users/12317406/fel"}, "edited": false, "score": 0, "creation_date": 1576133775, "post_id": 59285280, "comment_id": 104801750, "body": "@Fel u should use <code>shm</code> apis like <code>shm_open</code> and <code>mmap</code>; see <a href=\"https://stackoverflow.com/questions/43923518/how-to-put-a-variable-in-a-shared-memory\" title=\"how to put a variable in a shared memory\">stackoverflow.com/questions/43923518/&hellip;</a>"}], "tags": [], "owner": {"reputation": 104, "user_id": 12246590, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UbCUVYdKvhw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcwJIdXH8pLRIim5on1bHdeCbIf8A/photo.jpg?sz=128", "display_name": "Willy Cole", "link": "https://stackoverflow.com/users/12246590/willy-cole"}, "is_accepted": false, "score": 0, "last_activity_date": 1576065339, "creation_date": 1576065339, "answer_id": 59285280, "question_id": 59279329, "link": "https://stackoverflow.com/questions/59279329/how-to-synchronize-file-reading-for-reading-the-same-file/59285280#59285280", "title": "how to synchronize file reading for reading the same file", "body": "<p>make a shared memory between two processes and put file pointer into that.</p>\n\n<p>to do so, just put the file pointer on shared memory, i.e. u need to allocate a memory in shm with sizeof(FILE *) which is just an integer value; but beware of shm concurrency when two processes want to access it. u can do this with semaphores.</p>\n"}], "owner": {"reputation": 15, "user_id": 12317406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62e3205661006c31810c00fb349e9e63?s=128&d=identicon&r=PG&f=1", "display_name": "Fel", "link": "https://stackoverflow.com/users/12317406/fel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576065339, "creation_date": 1576041796, "last_edit_date": 1576042080, "question_id": 59279329, "link": "https://stackoverflow.com/questions/59279329/how-to-synchronize-file-reading-for-reading-the-same-file", "title": "how to synchronize file reading for reading the same file", "body": "<p><strong><em>Question</em></strong> <br/><br/>\nHello guys, I am trying to make two processes read the same file. That is easy, but I need the two processes to read the file in such a way that they will not read the same data, aka when one process reads and changes the position of the pointer, it then changes the pointer on the other process till EOF. How do I achieve this?</p>\n\n<p>My current implementation will read the file for each process but it then reads from a-z on both.</p>\n\n<p>I want the input of </p>\n\n<blockquote>\n  <p>acdef</p>\n</blockquote>\n\n<p>to then give the output of </p>\n\n<blockquote>\n  <p>program1 read: a<br/>\n  program2 read: b<br/>\n  program1 read: c<br/>\n  program2 read: d<br/>\n  program1 read: e<br/>\n  program2 read: f<br/>\n  EOF found, exiting program</p>\n</blockquote>\n\n<p><strong><em>Background</em></strong>\n<br/></p>\n\n<p>the of background of the project I am building for this operating systems course. This project will execute a program named program1 then that program will create 9 pipes one semaphore, one shared memory which counts the numbers of characters that have been read and then also takes in command line arguments for the filename. The first program will also after creating everything else spawn 9 children and pass them all the previous information, one pipe going from program1 to the specific child, the semaphore, the shared memory location, the filename.</p>\n\n<p>Each child will have synchronized access to a file, shared memory. Each child will then read 1-10 characters at random and then increment the shared memory by that amount. The children then will send the name of the program that currently has access and the characters that were read and write them into the pipe. If they get to end of line they will then also write the total number of read character read in the same string that gotten written into the pipe. When the specific child does this it will then pass the execution to program1 for execution.</p>\n\n<p>When program one gets execution privileges by the semaphore then it will read the string sent through all the nonblocking pipes. Then writes that string to the output file and then frees the semaphore for any of the children to use again till the eof has been reached.<br/><br/></p>\n\n<p><strong><em>Program Attempt</em></strong> <br/><br/>\nThis is a sample program to show what is going wrong. I am trying to pass the file name to the child Then both the parent and the child are trying to read the file at the same time in synchronous. </p>\n\n<blockquote>\n  <p>Parent</p>\n</blockquote>\n\n<pre><code>#define  key (3000)\n\nint main() \n{ \n\n\n    FILE *fPTR;\n    int c, semID;\n\n    struct sembuf operations[1];\n\n\n    pid_t PID1;\n\n    int argCount = 2;\n    int size = 20;\n\n    union semun {\n\n\n        int value;\n        struct semid_ds *buffer;\n        ushort *array;\n\n    } arg;\n\n\n    char **args = (char **) malloc( (argCount) * (sizeof (char *) ));\n    args[0] =     (char *)  malloc( (size)     * (sizeof (char  ) ));\n    args[1] =     (char *)\"inputTest.txt\";\n\n\n\n    semID = semget(key, 3, 0666 | IPC_CREAT);\n\n\n    fPTR = fopen(\"inputTest.txt\", \"r\");\n\n\n    if(semctl(semID, 0, SETVAL, arg) &lt; 0){\n\n\n        fprintf(stderr, \"was unable to set value of sempahore 0\" );\n        exit(0);\n    }\n\n\n\n    PID1 = fork();\n\n\n\n    if(PID1 == 0){\n\n        sprintf(args[0], \"%d\", semID);\n\n\n        if(execvp(\"./TestReadingChild\", args) == -1){\n\n            printf(\"failed to execute TestReadingChild\\n\");\n            exit(0);\n        }\n\n    }\n\n    if(PID1 &gt;= 0){\n\n\n        while(1){\n\n\n            if(semctl(semID, 0, GETVAL, arg) == 0){\n\n                if((c = fgetc(fPTR)) != EOF){\n\n                    printf(\"Program1 read: %c\\n\", (char) c);\n                }else{\n\n                    fclose(fPTR);\n                    break;\n                }\n\n\n\n\n\n                operations[0].sem_num = 0;\n                operations[0].sem_op = 1;\n                operations[0].sem_flg = 0;\n\n                semop(semID, operations, 1);\n\n\n            }\n\n\n        }\n    }\n\n\n}\n</code></pre>\n\n<blockquote>\n  <p>Child</p>\n</blockquote>\n\n<pre><code>#define  key (3000)\n\nint main(int argc, char *argv[]) \n{ \n\n    char *fileName = argv[1];\n    FILE *fPTR;\n    int semID = atoi(argv[0]);\n    int c;\n\n    struct sembuf operations[1];\n\n    pid_t PID1;\n\n    int argCount = 2;\n    int size = 20;\n\n    union semun {\n\n\n        int value;\n        struct semid_ds *buffer;\n        ushort *array;\n\n    } arg;\n\n    char **args = (char **) malloc( (argCount) * (sizeof (char *) ));\n    args[0] =     (char *)  malloc( (size)     * (sizeof (char  ) ));\n    args[1] =     (char *)  fileName;\n\n\n    semID = semget(key, 3, 0666 | IPC_CREAT);\n    fPTR = fopen(fileName, \"r\");\n\n\n    while(1){\n\n\n        if(semctl(semID, 0, GETVAL, arg) == 1){\n\n            if((c = fgetc(fPTR)) != EOF){\n\n                printf(\"Program2 read: %c\\n\", (char) c);\n            }else{\n                fclose(fPTR);\n                break;\n            }\n\n\n\n\n\n            operations[0].sem_num = 0;\n            operations[0].sem_op = -1;\n            operations[0].sem_flg = 0;\n\n            semop(semID, operations, 1);\n        }\n\n\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "struct"], "answers": [{"tags": [], "owner": {"reputation": 16676, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "is_accepted": false, "score": 3, "last_activity_date": 1576040545, "creation_date": 1576040545, "answer_id": 59279155, "question_id": 59279136, "link": "https://stackoverflow.com/questions/59279136/array-of-structs-inside-of-another-struct-in-c/59279155#59279155", "title": "Array of structs inside of another struct in C", "body": "<p><code>struct Songs *songs;</code> forward declares a struct named <code>Songs</code>, which stays as an incomplete type. What you probably meant is <code>struct Song *songs;</code>.</p>\n"}], "owner": {"reputation": 13643, "user_id": 1315565, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QXtqX.jpg?s=128&g=1", "display_name": "ILikeTacos", "link": "https://stackoverflow.com/users/1315565/iliketacos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 1, "closed_date": 1576040856, "answer_count": 1, "score": 0, "last_activity_date": 1576040545, "creation_date": 1576040381, "question_id": 59279136, "link": "https://stackoverflow.com/questions/59279136/array-of-structs-inside-of-another-struct-in-c", "closed_reason": "Not suitable for this site", "title": "Array of structs inside of another struct in C", "body": "<p>I've browser all the similar questions but they're either too specific or not related enough to my problem at hand. </p>\n\n<p>I'm going to try to make it as general as possible. </p>\n\n<p>The problem: I have a \"Playlist\" struct and a \"Song\" struct. One of the elements of my \"Playlist\" struct is an array of Songs. I want to be able to hardcode an X number of songs and append them to the array of songs within the Playlist struct. </p>\n\n<p>This is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct Song {\n    int id;\n    char *artist;\n    float duration;\n    char *album;\n} Song;\n\nstruct Playlist {\n    char *name;\n    int id;\n    char *author;\n    struct Songs *songs;\n};\n\nint main(int argc, char const *argv[])\n{\n    struct Playlist spotify;\n    spotify.name = \"Your Top Songs 2019\";\n    spotify.id = 1;\n    spotify.author = \"Spotify\";\n    spotify.songs = malloc(5 * sizeof(struct Song));\n    Song s;\n    s.id = 1;\n    spotify.songs[0] = s;\n    return 0;\n}\n</code></pre>\n\n<p>When I try to compile it, I get the following error:</p>\n\n<pre><code>test.c:27:18: error: subscript of pointer to incomplete type 'struct Songs'\n    spotify.songs[0] = s;\n    ~~~~~~~~~~~~~^\ntest.c:15:12: note: forward declaration of 'struct Songs'\n    struct Songs *songs;\n           ^\n1 error generated.\n</code></pre>\n\n<p>and I'm not sure what it means or how to solve it. Any guidance would be greatly appreciated. </p>\n"}, {"tags": ["c", "fopen"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 3, "creation_date": 1576038109, "post_id": 59278830, "comment_id": 104764386, "body": "Please provide an example of the file contents. For starters, check the return values of <code>fopen</code> and <code>fscanf</code>. Also, when a program doesn&#39;t work as expected what you should do is to debug it by running in a debugger or adding debug print statements. Have you done any of that and if so what did you find out about where things start going wrong?"}, {"owner": {"reputation": 94, "user_id": 6625422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd174255eb17c254506526bc4c8720f3?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Fung", "link": "https://stackoverflow.com/users/6625422/henry-fung"}, "edited": false, "score": 1, "creation_date": 1576038124, "post_id": 59278830, "comment_id": 104764388, "body": "If you are not sure if the file is actually being opened, try <code>if (!aLire) { &#47;* error *&#47; }</code> after <code>fopen</code> to check if <code>aLire</code> points to an address instead of NULL."}, {"owner": {"reputation": 748, "user_id": 5381184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da66272a60130c5f545312f67e16d9a3?s=128&d=identicon&r=PG&f=1", "display_name": "BobRun", "link": "https://stackoverflow.com/users/5381184/bobrun"}, "edited": false, "score": 0, "creation_date": 1576038357, "post_id": 59278830, "comment_id": 104764435, "body": "You could check for value of   nb at the end of function lire() , a simple printf to check if that&#39;s working as expected. Then check it again inside afficher(). Bon courage."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1576039937, "post_id": 59278830, "comment_id": 104764780, "body": "Welcome to Stack Overflow! <a href=\"https://stackoverflow.com/questions/5431941/while-feof-file-is-always-wrong\">Why <code>while(!feof(file))</code> is always wrong</a>"}, {"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 1, "creation_date": 1576040055, "post_id": 59278830, "comment_id": 104764804, "body": "In your <code>partitionner</code> function, it seems unlikely that <code>while ( G &lt;= D ) ;</code> is correct - this is an infinite loop (or a no-op). Does the <code>;</code> at the end belong."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12515171"}, "edited": false, "score": 1, "creation_date": 1576044778, "post_id": 59279124, "comment_id": 104766140, "body": "Thank you so much! I changed <code>char nom</code> and <code>char prenom</code> to <code>char nom[MAX_LENGTH]</code> and  <code>char prenom[MAX_LENGTH]</code> and now it finally works. Had been stuck for two days, thank you!"}], "tags": [], "owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "is_accepted": false, "score": 0, "last_activity_date": 1576040315, "creation_date": 1576040315, "answer_id": 59279124, "question_id": 59278830, "link": "https://stackoverflow.com/questions/59278830/file-not-being-read/59279124#59279124", "title": "File not being read", "body": "<p>Verify <code>fopen</code> return result, as it returns <code>NULL</code> in case opening fail for some reason.</p>\n\n<p>don't rely on <code>!feof</code> for detecting the end of the file, as your file can end partially, use <code>fscanf</code> return value instead (number of entry parsed/read )</p>\n\n<p>then in your structure your are using <code>char</code> (one character) for name, where you should either have <code>char[some length]</code> or <code>char*</code> </p>\n\n<pre><code>int numero;\nfloat  note;\nchar[MAX_LENGTH] nom;\nchar[MAX_LENGTH] prenom;\n// assuming that field are separated by space\nwhile(fscanf(\n\"%d %\"MAX_LENGTH\"s %\"MAX_LENGTH\"s %f\",\n&amp;numero,\nnom,\nprenom,\n&amp;note) == 4) {\n   // copy data in new row in array\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12515171"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576040315, "creation_date": 1576037844, "question_id": 59278830, "link": "https://stackoverflow.com/questions/59278830/file-not-being-read", "title": "File not being read", "body": "<p>Disclaimer: some words in my code are in French.</p>\n\n<p>When I compile my code there is no bug, but when I run it the only thing that appears is the sentence \"Contenu du tableau avant le tri\". I think the file I need to read (notes.txt) isn't being read. Anyone has any idea what the problem is? Here's my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX_PERS 200\n\n\n\ntypedef struct\n{\n    int numero;\n    float note;\n    char nom, prenom;\n}   donnees;\n\ndonnees tab[MAX_PERS];\nint nbPers=0;\n\n\n\nvoid lire(donnees tab[], int *n)\n{\n    FILE *aLire = fopen(\"notes.txt\", \"r\");\n\n    int nb=0;\n\n    while(!feof(aLire))\n    {\n        fscanf(aLire, \"%d%s%s%f\\n\", &amp;tab[nb].numero, &amp;tab[nb].nom, &amp;tab[nb].prenom, &amp;tab[nb].note);\n        nb++;  \n    }   \n    fclose(aLire);\n    *n = nb;   \n}\n\n\n\nvoid afficher(donnees tab[], int nb, char *quand)\n{\n    int i;\n\n    printf(\"Contenu du tableau %s le tri\\n\\n\", quand);\n\n    for(i=0; i&lt;nb; i++)\n        printf( \"%4d %15s %15s %2.2f\\n\", tab[i].numero, tab[i].nom, tab[i].prenom, tab[i].note);\n}\n\n\n\nvoid echanger (donnees *P1, donnees *P2)\n{ \n    donnees tempo;\n\n    tempo = *P1 ;\n    *P1 = *P2;\n    *P2 = tempo;\n}\n\n\n\nvoid  partitionner ( donnees tab[], int debut, int fin, int *P )\n{ \n    int G = debut , D = fin  ;\n\n    float Val_Pivot = tab[debut].note;\n\n    while ( G &lt;= D  &amp;&amp;  tab[G].note &lt;= Val_Pivot) G++;\n\n    while ( tab[D].note &gt; Val_Pivot) D--;\n\n        if ( G &lt; D ) echanger(&amp;tab[G], &amp;tab[D]);\n\n    while ( G &lt;= D ) ;\n\n        *P = D ;\n\n        echanger (&amp;tab[debut], &amp;tab[D]);\n}\n\n\n\nvoid quickSort ( donnees tab[], int gauche, int droite )\n{ \n    int indPivot ;\n\n    if (droite &gt; gauche)\n        {\n            partitionner ( tab, gauche, droite, &amp;indPivot);\n            quickSort ( tab, gauche, indPivot - 1 );\n            quickSort ( tab, indPivot + 1, droite);\n        }\n}\n\n\n\n\nint main()\n{\n    donnees tab[MAX_PERS];\n\n    lire(tab, &amp;nbPers);\n\n    afficher(tab, nbPers, \"avant\");\n\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["python", "c", "macos", "gcc", "compiler-errors"], "answers": [{"comments": [{"owner": {"reputation": 917, "user_id": 1667423, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3ff1fb6d7b142bca9bb38ec7abd66184?s=128&d=identicon&r=PG", "display_name": "user76284", "link": "https://stackoverflow.com/users/1667423/user76284"}, "edited": false, "score": 0, "creation_date": 1576108065, "post_id": 59292985, "comment_id": 104795899, "body": "Thanks, I\u2019ll try this when I have the chance. Is this approach new for Python 3? For Python 2, I could just gcc my C file to a .so file and, in the same directory, import the module."}, {"owner": {"reputation": 2138, "user_id": 1919896, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7da069e9930c3bdcc9b7af581c0de4eb?s=128&d=identicon&r=PG", "display_name": "Icarus3", "link": "https://stackoverflow.com/users/1919896/icarus3"}, "reply_to_user": {"reputation": 917, "user_id": 1667423, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3ff1fb6d7b142bca9bb38ec7abd66184?s=128&d=identicon&r=PG", "display_name": "user76284", "link": "https://stackoverflow.com/users/1667423/user76284"}, "edited": false, "score": 0, "creation_date": 1576112267, "post_id": 59292985, "comment_id": 104796757, "body": "You still can use gcc but distutils is a standard way of building and distributing modules. It invokes the gcc with the correct flags and link relevant libraries. Distutils has been there since python 1.6"}, {"owner": {"reputation": 917, "user_id": 1667423, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3ff1fb6d7b142bca9bb38ec7abd66184?s=128&d=identicon&r=PG", "display_name": "user76284", "link": "https://stackoverflow.com/users/1667423/user76284"}, "edited": false, "score": 0, "creation_date": 1576114329, "post_id": 59292985, "comment_id": 104797173, "body": "Do you know why this creates two folders under the created <code>build</code> directory? (For me it&#39;s <code>lib.macosx-10.15-x86_64-3.7</code> which contains <code>hello.cpython-37m-darwin.so</code> and <code>temp.macosx-10.15-x86_64-3.7</code> which contains <code>hello.o</code>.)"}, {"owner": {"reputation": 2138, "user_id": 1919896, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7da069e9930c3bdcc9b7af581c0de4eb?s=128&d=identicon&r=PG", "display_name": "Icarus3", "link": "https://stackoverflow.com/users/1919896/icarus3"}, "reply_to_user": {"reputation": 917, "user_id": 1667423, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3ff1fb6d7b142bca9bb38ec7abd66184?s=128&d=identicon&r=PG", "display_name": "user76284", "link": "https://stackoverflow.com/users/1667423/user76284"}, "edited": false, "score": 0, "creation_date": 1576116720, "post_id": 59292985, "comment_id": 104797637, "body": "The temp directory holds the object files. Think of it as a temporary work area used by distutil to build the python module. The other one contains the final python module: <a href=\"https://docs.python.org/2.0/inst/how-build-works.html\" rel=\"nofollow noreferrer\">docs.python.org/2.0/inst/how-build-works.html</a>"}, {"owner": {"reputation": 917, "user_id": 1667423, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3ff1fb6d7b142bca9bb38ec7abd66184?s=128&d=identicon&r=PG", "display_name": "user76284", "link": "https://stackoverflow.com/users/1667423/user76284"}, "edited": false, "score": 0, "creation_date": 1576119555, "post_id": 59292985, "comment_id": 104798168, "body": "It seems I can access the module even from a different directory. Is it being installed globally? If so, how can I keep it local for testing purposes, or uninstall it?"}, {"owner": {"reputation": 2138, "user_id": 1919896, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7da069e9930c3bdcc9b7af581c0de4eb?s=128&d=identicon&r=PG", "display_name": "Icarus3", "link": "https://stackoverflow.com/users/1919896/icarus3"}, "reply_to_user": {"reputation": 917, "user_id": 1667423, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3ff1fb6d7b142bca9bb38ec7abd66184?s=128&d=identicon&r=PG", "display_name": "user76284", "link": "https://stackoverflow.com/users/1667423/user76284"}, "edited": false, "score": 0, "creation_date": 1576120107, "post_id": 59292985, "comment_id": 104798285, "body": "instead of &#39;install&#39; use &#39;build&#39; flag. That will just build the module and not install it in site-package. To uninstall you will have to record the path where it installed the module into. That will be &quot;python setup.py install --record files.txt&quot;. Then delete the files that are listed in files.txt. <a href=\"https://stackoverflow.com/questions/1550226/python-setup-py-uninstall\" title=\"python setup py uninstall\">stackoverflow.com/questions/1550226/python-setup-py-uninstal&zwnj;&#8203;l</a>"}, {"owner": {"reputation": 917, "user_id": 1667423, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3ff1fb6d7b142bca9bb38ec7abd66184?s=128&d=identicon&r=PG", "display_name": "user76284", "link": "https://stackoverflow.com/users/1667423/user76284"}, "edited": false, "score": 0, "creation_date": 1576121375, "post_id": 59292985, "comment_id": 104798547, "body": "I don&#39;t know if you&#39;re familiar with the Numpy C API, but do you by any chance know why I&#39;m getting the warning <i>&quot;Using deprecated NumPy API, disable it with #define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION&quot;</i>, even though Homebrew says my numpy is up-to-date (1.17.4)? I&#39;m following the example here: <a href=\"https://scipy-lectures.org/advanced/interfacing_with_c/interfacing_with_c.html#id1\" rel=\"nofollow noreferrer\">scipy-lectures.org/advanced/interfacing_with_c/&hellip;</a>"}, {"owner": {"reputation": 2138, "user_id": 1919896, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7da069e9930c3bdcc9b7af581c0de4eb?s=128&d=identicon&r=PG", "display_name": "Icarus3", "link": "https://stackoverflow.com/users/1919896/icarus3"}, "reply_to_user": {"reputation": 917, "user_id": 1667423, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3ff1fb6d7b142bca9bb38ec7abd66184?s=128&d=identicon&r=PG", "display_name": "user76284", "link": "https://stackoverflow.com/users/1667423/user76284"}, "edited": false, "score": 0, "creation_date": 1576121726, "post_id": 59292985, "comment_id": 104798605, "body": "Never used it. But the doc says you can ignore it. Visit this link and search for numpy <a href=\"http://docs.cython.org/en/latest/src/userguide/source_files_and_compilation.html#warnings\" rel=\"nofollow noreferrer\">docs.cython.org/en/latest/src/userguide/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2138, "user_id": 1919896, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7da069e9930c3bdcc9b7af581c0de4eb?s=128&d=identicon&r=PG", "display_name": "Icarus3", "link": "https://stackoverflow.com/users/1919896/icarus3"}, "is_accepted": true, "score": 1, "last_activity_date": 1576093517, "creation_date": 1576093517, "answer_id": 59292985, "question_id": 59278688, "link": "https://stackoverflow.com/questions/59278688/compiling-python-3-extension-module-on-mac/59292985#59292985", "title": "Compiling Python 3 extension module on Mac", "body": "<p>Use distutils</p>\n\n<p>create setup.py. e.g.</p>\n\n<pre><code>from distutils.core import setup, Extension\n\ndef main():\n    setup(name=\"hello\",\n            version=\"1.0.0\",\n            description=\"desc\",\n            author=\"&lt;your name&gt;\",\n            author_email=\"a@b.com\",\n            ext_modules=[Extension(\"hello\",[\"hello.c\"])])\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>\n\n<p>in c file change include to:</p>\n\n<pre><code>#include &lt;Python.h&gt;\n</code></pre>\n\n<p>Assuming your c file name is hello.c and setup.py is placed in the same directory:</p>\n\n<pre><code>python3 setup.py install\n</code></pre>\n\n<p>In your case, verify whether it is \"python3\" or \"python\".\nThis should build your module and install it, you should be able to see the compiler and linker commands </p>\n"}], "owner": {"reputation": 917, "user_id": 1667423, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3ff1fb6d7b142bca9bb38ec7abd66184?s=128&d=identicon&r=PG", "display_name": "user76284", "link": "https://stackoverflow.com/users/1667423/user76284"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 357, "favorite_count": 0, "accepted_answer_id": 59292985, "answer_count": 1, "score": 1, "last_activity_date": 1576093517, "creation_date": 1576036568, "last_edit_date": 1576091634, "question_id": 59278688, "link": "https://stackoverflow.com/questions/59278688/compiling-python-3-extension-module-on-mac", "title": "Compiling Python 3 extension module on Mac", "body": "<p>I'm trying to write a <a href=\"https://docs.python.org/3/extending/extending.html\" rel=\"nofollow noreferrer\">Python extension module</a> in C. I'm running macOS Catalina and have a Homebrew installation of Python 3 (with default installation settings). When I try to compile the following file:</p>\n\n<pre><code>#include &lt;Python/Python.h&gt;\n\nstatic PyObject* world(PyObject* self, PyObject* args)\n{\n    printf(\"Hello world!\\n\");\n    Py_RETURN_NONE;\n}\n\nstatic PyMethodDef methods[] = {\n    {\"world\", world, METH_VARARGS, \"Prints \\\"Hello world!\\\"\"},\n    {NULL, NULL, 0, NULL}\n};\n\nstatic struct PyModuleDef module = {\n    PyModuleDef_HEAD_INIT,\n    \"name for the module\",\n    \"docstring for the module\",\n    -1,\n    methods\n};\n\nPyMODINIT_FUNC PyInit_hello(void)\n{\n    return PyModule_Create(&amp;module);\n}\n</code></pre>\n\n<p>by running <code>gcc hello.c</code> in my terminal, I get the following messages:</p>\n\n<pre><code>hello.c:15:5: error: use of undeclared identifier\n      'PyModuleDef_HEAD_INIT'\n    PyModuleDef_HEAD_INIT,\n    ^\nhello.c:14:27: error: variable has incomplete type\n      'struct PyModuleDef'\nstatic struct PyModuleDef module = {\n                          ^\nhello.c:14:15: note: forward declaration of 'struct PyModuleDef'\nstatic struct PyModuleDef module = {\n              ^\nhello.c:24:12: warning: implicit declaration of function\n      'PyModule_Create' is invalid in C99\n      [-Wimplicit-function-declaration]\n    return PyModule_Create(&amp;module);\n           ^\n1 warning and 2 errors generated.\n</code></pre>\n\n<p>Is there a way to fix this? I've tried playing around with the <code>-L</code> and <code>-I</code> flags to no avail. I think this might be happening because it\u2019s using the header for Python 2 rather than Python 3.</p>\n"}, {"tags": ["c", "rest", "http", "uri"], "comments": [{"owner": {"reputation": 378, "user_id": 2620017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517078d0e5e19b98b4b8c7228da5aadf?s=128&d=identicon&r=PG", "display_name": "hko", "link": "https://stackoverflow.com/users/2620017/hko"}, "edited": false, "score": 0, "creation_date": 1576037187, "post_id": 59278685, "comment_id": 104764199, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal-reproducible-example</a>"}, {"owner": {"reputation": 27, "user_id": 12515558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2839044af4b597c0023d9c003e31043a?s=128&d=identicon&r=PG&f=1", "display_name": "Arza", "link": "https://stackoverflow.com/users/12515558/arza"}, "reply_to_user": {"reputation": 378, "user_id": 2620017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517078d0e5e19b98b4b8c7228da5aadf?s=128&d=identicon&r=PG", "display_name": "hko", "link": "https://stackoverflow.com/users/2620017/hko"}, "edited": false, "score": 0, "creation_date": 1576049421, "post_id": 59278685, "comment_id": 104767759, "body": "i have added the source file, and the image which shows the endpoints."}, {"owner": {"reputation": 378, "user_id": 2620017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517078d0e5e19b98b4b8c7228da5aadf?s=128&d=identicon&r=PG", "display_name": "hko", "link": "https://stackoverflow.com/users/2620017/hko"}, "edited": false, "score": 0, "creation_date": 1576093705, "post_id": 59278685, "comment_id": 104790731, "body": "This seems a lot of effort to debug for someone, that&#39;s probably why you don&#39;t get any responses. Did you try to use valgrind to find the segfault yourself?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12387551, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vviK6kImOJ4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re78SDEMpRqYBhdRpWujCAqR5HLnA/photo.jpg?sz=128", "display_name": "arzahomes", "link": "https://stackoverflow.com/users/12387551/arzahomes"}, "is_accepted": false, "score": 0, "last_activity_date": 1576314158, "creation_date": 1576314158, "answer_id": 59333705, "question_id": 59278685, "link": "https://stackoverflow.com/questions/59278685/rest-api-implementation-using-ulfius-uri-definition/59333705#59333705", "title": "REST API implementation using Ulfius - URI definition", "body": "<p>I was able to figure out what was the endpoint definition in these lines :\n  ulfius_add_endpoint_by_val(&amp;instance, \"GET\", PREFIX, \"/multiple/:multiple/:multiple/:not_multiple\", 0, &amp;callback_all_test_foo, NULL);</p>\n\n<p>Its working now, and I am not able to reproduce the segmentation fault now. Don't know what went wrong. Thanks hko (I cant tag you?)</p>\n"}], "owner": {"reputation": 27, "user_id": 12515558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2839044af4b597c0023d9c003e31043a?s=128&d=identicon&r=PG&f=1", "display_name": "Arza", "link": "https://stackoverflow.com/users/12515558/arza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 311, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576314158, "creation_date": 1576036517, "last_edit_date": 1576049353, "question_id": 59278685, "link": "https://stackoverflow.com/questions/59278685/rest-api-implementation-using-ulfius-uri-definition", "title": "REST API implementation using Ulfius - URI definition", "body": "<p>I am trying to test the Ulfius library for implementing REST API. My application is in C, so Ulfius made a right choice. I have little to no knowledge about how URI is formulated or HTTP works.\nI compiled the simple_example.c file and while testing it, I get a seg fault when I do a POST with URL <a href=\"http://localhost:8537/test\" rel=\"nofollow noreferrer\">http://localhost:8537/test</a> with key as name and value Arza (using postman app)\n<a href=\"https://i.stack.imgur.com/74Ms6.jpg\" rel=\"nofollow noreferrer\">enter image description here</a>\nI know I am doing something wrong, please help.<br>\nThis is the sample source file : <a href=\"https://github.com/babelouest/ulfius/blob/master/example_programs/simple_example/simple_example.c\" rel=\"nofollow noreferrer\">https://github.com/babelouest/ulfius/blob/master/example_programs/simple_example/simple_example.c</a></p>\n"}, {"tags": ["python", "c", "api", "raspberry-pi3", "sensors"], "comments": [{"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1576036048, "post_id": 59278605, "comment_id": 104763928, "body": "Either <a href=\"https://docs.python.org/3/extending/building.html\" rel=\"nofollow noreferrer\">build a shim to interface between your C and python</a> or use <a href=\"https://docs.python.org/3.8/library/ctypes.html#module-ctypes\" rel=\"nofollow noreferrer\">ctypes</a> to dynamically load the library and use the library"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1576036235, "post_id": 59278605, "comment_id": 104763974, "body": "Find out more by using your favourite search engine and typing in &quot;Call C function from python&quot;."}, {"owner": {"reputation": 67, "user_id": 6820366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537b4a010f6de70a997a5c3fd6df1d77?s=128&d=identicon&r=PG&f=1", "display_name": "LeafTeaNeko", "link": "https://stackoverflow.com/users/6820366/leafteaneko"}, "edited": false, "score": 0, "creation_date": 1576036967, "post_id": 59278605, "comment_id": 104764135, "body": "Can Ctypes be used to load API&#39;s? Because I have an API from the manufacturer written in C but I cant use this in python."}, {"owner": {"reputation": 330, "user_id": 8504592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A0lBH.jpg?s=128&g=1", "display_name": "PunyCode", "link": "https://stackoverflow.com/users/8504592/punycode"}, "edited": false, "score": 0, "creation_date": 1576037823, "post_id": 59278605, "comment_id": 104764312, "body": "<a href=\"https://github.com/pimoroni/vl53l1x-python\" rel=\"nofollow noreferrer\">github.com/pimoroni/vl53l1x-python</a>  I did a google search and found this. there are instruction on how to install and use."}, {"owner": {"reputation": 67, "user_id": 6820366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537b4a010f6de70a997a5c3fd6df1d77?s=128&d=identicon&r=PG&f=1", "display_name": "LeafTeaNeko", "link": "https://stackoverflow.com/users/6820366/leafteaneko"}, "edited": false, "score": 0, "creation_date": 1576039807, "post_id": 59278605, "comment_id": 104764749, "body": "I tried to use the same library but it doesn&#39;t work, I tried the sample example in the GitHub but it only outputs the device info, rev number, general device data. I tried contacting the dev too but I received no response."}, {"owner": {"reputation": 330, "user_id": 8504592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A0lBH.jpg?s=128&g=1", "display_name": "PunyCode", "link": "https://stackoverflow.com/users/8504592/punycode"}, "edited": false, "score": 0, "creation_date": 1576046214, "post_id": 59278605, "comment_id": 104766620, "body": "You need to enable i2c first."}, {"owner": {"reputation": 67, "user_id": 6820366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537b4a010f6de70a997a5c3fd6df1d77?s=128&d=identicon&r=PG&f=1", "display_name": "LeafTeaNeko", "link": "https://stackoverflow.com/users/6820366/leafteaneko"}, "edited": false, "score": 0, "creation_date": 1576048210, "post_id": 59278605, "comment_id": 104767349, "body": "I did, I enabled the I2C in Raspi cofiguration, I tested if the I2C was working with sudo i2cdetect -y 1 and its says I&#39;m connected on 0x29 but I still cant get the sensor to output the data"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 6820366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537b4a010f6de70a997a5c3fd6df1d77?s=128&d=identicon&r=PG&f=1", "display_name": "LeafTeaNeko", "link": "https://stackoverflow.com/users/6820366/leafteaneko"}, "edited": false, "score": 0, "creation_date": 1576044234, "post_id": 59279043, "comment_id": 104765966, "body": "So this is what I&#39;ve been trying to do for the last couple of hours, I create a shared object then import the created .o file to python and use a wrapper but the program I write doesn&#39;t read the shared object file, it throws in errors. I&#39;ll try working on it and post any updates/questions by tomorrow."}], "tags": [], "owner": {"reputation": 330, "user_id": 8504592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A0lBH.jpg?s=128&g=1", "display_name": "PunyCode", "link": "https://stackoverflow.com/users/8504592/punycode"}, "is_accepted": false, "score": 1, "last_activity_date": 1576039610, "creation_date": 1576039610, "answer_id": 59279043, "question_id": 59278605, "link": "https://stackoverflow.com/questions/59278605/using-a-c-library-with-python-on-raspi/59279043#59279043", "title": "Using a C library with Python on Raspi", "body": "<p>Making a simple python wrapper for a c library.</p>\n\n<p>I got the following files in my work directory</p>\n\n<p><strong><code>mylib.c</code></strong> : </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint sumof(int a, int b)\n{\n    return a+b;\n}\n</code></pre>\n\n<p><strong><code>wrapper.py</code></strong> :</p>\n\n<pre><code>from ctypes import CDLL\nso_file = \"/path/to/my/work/dir/mylib.so\"\nmy_c_lib = CDLL(so_file)\n\ndef sumof_fun(a,b):\n    return my_c_lib.sumof(a,b)\n</code></pre>\n\n<p>As you can see we are using a shared library (<code>.so</code> file) in the python wrapper for creating that shared library we use following command:</p>\n\n<p><strong><code>$</code></strong><code>gcc -fPIC -shared -o mylib.so mylib.c</code></p>\n\n<p>Now in python I could use following:</p>\n\n<pre><code>&gt;&gt;&gt; import wrapper\n&gt;&gt;&gt; \n&gt;&gt;&gt; wrapper.sumof_fun(4,5)\n9\n</code></pre>\n\n<p>Ref: <a href=\"https://www.journaldev.com/31907/calling-c-functions-from-python\" rel=\"nofollow noreferrer\">https://www.journaldev.com/31907/calling-c-functions-from-python</a></p>\n\n<p>PS : But in your case I still believe its better to go for <a href=\"https://github.com/pimoroni/vl53l1x-python\" rel=\"nofollow noreferrer\">pimoroni vl53l1x-python package</a></p>\n"}], "owner": {"reputation": 67, "user_id": 6820366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537b4a010f6de70a997a5c3fd6df1d77?s=128&d=identicon&r=PG&f=1", "display_name": "LeafTeaNeko", "link": "https://stackoverflow.com/users/6820366/leafteaneko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576039870, "creation_date": 1576035712, "last_edit_date": 1576039870, "question_id": 59278605, "link": "https://stackoverflow.com/questions/59278605/using-a-c-library-with-python-on-raspi", "title": "Using a C library with Python on Raspi", "body": "<p>I'm trying to use a time of flight sensor on a Raspi (Pololu VL53L1X) but there are no libraries for the sensor in python. The original manufacturer has provided with a C API for the sensor but I dont know how to use the API functions in my python code. Can someone help me understand what I can do use the sensor on Raspi without having to write the library from scratch? I've done some research and almost everyone suggests wrapping C libraries(API in this case?) in python but Im not sure how to do that. Any ideas or suggestions would be valuable. </p>\n\n<p>P.S. There are libraries for the sensors for Arduino but I cant use Arduino and I need it to run on Raspi and using python if possible. I'm a beginner to Raspi and Python so a little explanation on your idea would be helpful.</p>\n"}, {"tags": ["c", "file-io"], "comments": [{"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1576034615, "post_id": 59278444, "comment_id": 104763589, "body": "<code>fopen</code> can fail for many reasons.  Let the system tell you why it failed.  <code>FILE* myFile = fopen(name, &quot;r&quot;); if ( myFile == NULL ) {perror(name) ...</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1576034738, "post_id": 59278444, "comment_id": 104763619, "body": "We need to see <code>createNode</code>. I suspect it&#39;s not making copies of the strings when it puts them into the <code>Node</code> structure, so you&#39;re saving pointers to local strings."}, {"owner": {"reputation": 99, "user_id": 4415253, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b49cf97ad1ed7119fef4bbe9a8593d61?s=128&d=identicon&r=PG&f=1", "display_name": "Jadon Steinmetz", "link": "https://stackoverflow.com/users/4415253/jadon-steinmetz"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1576034910, "post_id": 59278444, "comment_id": 104763661, "body": "@Barmar -- Edited to show createNode"}, {"owner": {"reputation": 99, "user_id": 4415253, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b49cf97ad1ed7119fef4bbe9a8593d61?s=128&d=identicon&r=PG&f=1", "display_name": "Jadon Steinmetz", "link": "https://stackoverflow.com/users/4415253/jadon-steinmetz"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1576035162, "post_id": 59278444, "comment_id": 104763714, "body": "@WilliamPursell Dully noted - Thanks! :). Modified with perror"}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 4415253, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b49cf97ad1ed7119fef4bbe9a8593d61?s=128&d=identicon&r=PG&f=1", "display_name": "Jadon Steinmetz", "link": "https://stackoverflow.com/users/4415253/jadon-steinmetz"}, "edited": false, "score": 0, "creation_date": 1576035484, "post_id": 59278533, "comment_id": 104763780, "body": "WOW... All those hours spent debugging for it to be as simple as a one line fix. Your timely manner of responding is much appreciated. Thank you so much!"}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1576035133, "creation_date": 1576035133, "answer_id": 59278533, "question_id": 59278444, "link": "https://stackoverflow.com/questions/59278444/c-reading-data-from-one-file-and-writing-it-into-another-file/59278533#59278533", "title": "C Reading data from one file and writing it into another file", "body": "<p><code>createNode</code> is just saving pointers to the strings that it's given. <code>addFile</code> overwrites the same strings each time through the loop, so every node has the same pointers. Also, these are local variables, so the pointers become invalid after <code>addFile</code> returns.</p>\n\n<p>You need to make copies of the strings.</p>\n\n<pre><code>        addNode(tempId, strdup(firstName), strdup(lastName), GPA, strdup(major));\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 4415253, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b49cf97ad1ed7119fef4bbe9a8593d61?s=128&d=identicon&r=PG&f=1", "display_name": "Jadon Steinmetz", "link": "https://stackoverflow.com/users/4415253/jadon-steinmetz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 59278533, "answer_count": 1, "score": 0, "last_activity_date": 1576035133, "creation_date": 1576034428, "last_edit_date": 1576034881, "question_id": 59278444, "link": "https://stackoverflow.com/questions/59278444/c-reading-data-from-one-file-and-writing-it-into-another-file", "title": "C Reading data from one file and writing it into another file", "body": "<h2>The Problem:</h2>\n\n<p>I have a project I'm working on that works with Binary Search Trees and file input/output. The binary search tree seems to functioning properly, however one of the requirements is to be able to add data to the binary tree via input from a file (And later output all the binary tree data). I used the fgets+sscanf method to look through the file, and it appears that it grabs all the items correctly, but the strings get drastically altered. I suspect it to be a null terminator issue but cannot pinpoint where exactly I could fix it at. When I add nodes to the binary tree manually (not from the file), they are added without issue, and are written to a new text file without issue. The only issue comes from reading the data from a file, which is throwing some odd errors that modify my data (E.G. strings appear in weird formats like \u00e9@\u2014\u00c7 as opposed to the expected output of FirstName1 LastName1).</p>\n\n<p>Also would like to apologize, I am still fairly new to C. So it may appear a little messy.</p>\n\n<hr>\n\n<h2>My (futile) attempts:</h2>\n\n<p>As noted in the code below, I attempted manually adding null terminators to the strings since I believed that to be the issue. I've attempted changing the file contents and adding null terminators there, and I've tried using fscanf method of reading the file instead as well. I researched other stackoverflow pages searching for something I might be missing, but I haven't found anything. I'm sure it's something silly that I've overlooked.</p>\n\n<hr>\n\n<h2>My text files:</h2>\n\n<p>Again, these below text file contents are only concerning from what is added from the file. Anything I manually add by calling the addNode function with string literals works without problem</p>\n\n<p>My 'input' text file that I tried adding students from (aka that addFile uses in my tests):</p>\n\n<pre><code>400085 FirstName1 LastName1 3.88 CompSci\n400076 FirstName2 LastName2 2.77 LibertyArts\n</code></pre>\n\n<p>My 'output' text file that writeFile uses:</p>\n\n<pre><code>400085  \u00e9@\u2014\u00c7 3.880000 \u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff \n400076  \u00e9@\u2014\u00c7 2.770000 \u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff \n</code></pre>\n\n<hr>\n\n<h2>The Code:</h2>\n\n<p><strong>addFile</strong>\nTakes a string name, finds the file, and opens its contents</p>\n\n<pre><code>void addFile(char* name) {\n    FILE* myFile = fopen(name, \"r\");\n    if (myFile == NULL) {\n        perror(name);\n        return;\n    }\n    int tempId = 0;\n    char firstName[100];\n    char lastName[100];\n    double GPA = 0.0;\n    char major[100];\n    int res = 0;\n    char line[10000];\n\n    while (fgets(line, 1000, myFile) != NULL) {\n        res = sscanf(line, \"%d %s %s %lf %s\", &amp;tempId, firstName, lastName, &amp;GPA, major);\n        firstName[99] = '\\0';\n        lastName[99] = '\\0';\n        major[99] = '\\0';\n        addNode(tempId, firstName, lastName, GPA, major);\n    }\n\n    fclose(myFile);\n}\n</code></pre>\n\n<p><strong>WriteFile</strong>\nWrites into the text file, testFile.txt the contents of the binary search tree</p>\n\n<pre><code>void preorder(struct Node* nodeAt) {\n    char buffer[10000];\n    snprintf(buffer, sizeof(buffer), \"%d %s %s %lf %s \\n\", nodeAt-&gt;id, nodeAt-&gt;firstName, nodeAt-&gt;lastName, nodeAt-&gt;GPA, nodeAt-&gt;major);\n    strcat(tempString, buffer);\n    if (nodeAt-&gt;leftChild != NULL)\n        preorder(nodeAt-&gt;leftChild);\n    if (nodeAt-&gt;rightChild != NULL)\n        preorder(nodeAt-&gt;rightChild);\n}\n\nvoid writeFile() {\n    FILE* fp = fopen(\"testFile.txt\", \"w\");\n    tempString = (char*) malloc(sizeof(char*) * 10000);\n    preorder(root);\n    fprintf(fp, \"%s\", tempString);\n    free(tempString);\n    tempString = \"\";\n}\n</code></pre>\n\n<p><strong>Other related functions that addFile calls</strong></p>\n\n<pre><code>/*\ncreateNode() method\n\"safe\" way of creating the node. Also cleans up the code.\n*/\nstruct Node* createNode(int id, char* firstName, char* lastName, double GPA, char* major) {\n    struct Node* myNode = (struct Node*) malloc(sizeof(struct Node));\n\n    if (myNode != NULL) {\n        myNode-&gt;id = id;\n        myNode-&gt;firstName = firstName;\n        myNode-&gt;lastName = lastName;\n        myNode-&gt;GPA = GPA;\n        myNode-&gt;major = major;\n        myNode-&gt;rightChild = NULL;\n        myNode-&gt;leftChild = NULL;\n        myNode-&gt;parent = NULL;\n        return myNode;\n    }\n    else\n        return NULL;\n}\n\n/*\naddNode() + addNodeHelper() methods\nAdds a node to the binary tree. The helper method is just recursive to make searching easier\n*/\nstruct Node* addNodeHelper(struct Node* nodeAt, int id, struct Node* nodeToAdd) {\n    struct Node* temp = nodeAt;\n\n    if (temp-&gt;leftChild == NULL &amp;&amp; id &lt; temp-&gt;id) {\n        nodeAt-&gt;leftChild = nodeToAdd;\n        nodeAt-&gt;leftChild-&gt;parent = nodeAt;\n    }\n    else if (temp-&gt;rightChild == NULL &amp;&amp; id &gt; temp-&gt;id) {\n        nodeAt-&gt;rightChild = nodeToAdd;\n        nodeAt-&gt;rightChild-&gt;parent = nodeAt;\n    }\n\n    if (id &lt; temp-&gt;id)\n        addNodeHelper(temp-&gt;leftChild, id, nodeToAdd);\n    else if (id &gt; temp-&gt;id)\n        addNodeHelper(temp-&gt;rightChild, id, nodeToAdd);\n}\n\nvoid addNode(int id, char* firstName, char* lastName, double GPA, char* major) {\n    struct Node* myNode = createNode(id, firstName, lastName, GPA, major);\n    if (myNode != NULL) {\n        struct Node* findTheNode = findNode(root, myNode-&gt;id);\n        if (root == NULL) {\n            root = myNode;\n            return;\n        }\n        if (findTheNode != NULL) {\n            printf(\"ERROR: Student ID must be unique!\\n\");\n            return;\n        } else\n            addNodeHelper(root, myNode-&gt;id, myNode);\n    }\n}\n</code></pre>\n\n<p>Any hints/recommendations are much appreciated :)</p>\n"}, {"tags": ["c++", "c", "opencv", "wrapper"], "answers": [{"tags": [], "owner": {"reputation": 6746, "user_id": 8185995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02d69271095c22ec7a2f5cad43ea3ac0?s=128&d=identicon&r=PG&f=1", "display_name": "robthebloke", "link": "https://stackoverflow.com/users/8185995/robthebloke"}, "is_accepted": false, "score": 4, "last_activity_date": 1576040013, "creation_date": 1576040013, "answer_id": 59279089, "question_id": 59278403, "link": "https://stackoverflow.com/questions/59278403/how-to-wrap-opencv-c-function-in-c-code/59279089#59279089", "title": "How to wrap OpenCV C++ function in C code", "body": "<p>To wrap C++ code so that it's callable by C can be done with a few C++ functions that present themselves as C funcs. As an example, Let's imagine I have a class called MyObj.... </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// MyObj.h\n#pragma once\n#include &lt;iostream&gt;\n\nclass MyObj\n{\n  int m_thing = 42;\npublic: \n  MyObj() = default;\n  ~MyObj() = default;\n\n  void printThing() const {\n    std::cout &lt;&lt; \"MyObj: \" &lt;&lt; m_thing &lt;&lt; std::endl;\n  }\n  int getThing() const {\n    return m_thing;\n  }\n  void setThing(int v) {\n    m_thing = v;\n  }\n};\n</code></pre>\n\n<p>I need to wrap this in some C functions (declared with C-linkage).</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// MyObjWrapper.h\n#pragma once\n\n/* \n * use C name mangling if compiling as C++ code. \n * When compiling as C, this is ignored. \n */\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nstruct ObjWrapper;\n\n/* return a newly created object */\nstruct ObjWrapper* createObj();\n\n/* delete an object */\nvoid deleteObj(struct ObjWrapper*);\n\n/* do something on an object */\nvoid printThing(const struct ObjWrapper*);\n\n/* get value from object */\nint getThing(const struct ObjWrapper*);\n\n/* set value on object */\nvoid setThing(struct ObjWrapper*, int);\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<p>Now in the C++ wrapper file, we can encapsulate all of the C++, leaving only a C interface.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// MyObjWrapper.cpp\n#include \"MyObj.h\"\n#include \"MyObjWrapper.h\"\n#include &lt;cassert&gt;\n\n/* use C name mangling */\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nstruct ObjWrapper\n{\n  MyObj obj;\n};\n\n/* return a newly created object */\nstruct ObjWrapper* createObj()\n{\n  return new ObjWrapper;\n}\n\n/* delete an object */\nvoid deleteObj(struct ObjWrapper* wrapper)\n{\n  assert(wrapper);\n  delete wrapper;\n}\n\n/* do something on an object */\nvoid printThing(const struct ObjWrapper* wrapper)\n{\n  assert(wrapper);\n  wrapper-&gt;obj.printThing();\n}\n\n/* get value from object */\nint getThing(const struct ObjWrapper* wrapper)\n{\n  assert(wrapper);\n  return wrapper-&gt;obj.getThing();\n}\n\n/* set value on object */\nvoid setThing(struct ObjWrapper* wrapper, int thing)\n{\n  assert(wrapper);\n  wrapper-&gt;obj.setThing(thing);\n}\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n"}], "owner": {"reputation": 198, "user_id": 12122412, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214973835401903/picture?type=large", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/12122412/gabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 425, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1576040013, "creation_date": 1576034031, "question_id": 59278403, "link": "https://stackoverflow.com/questions/59278403/how-to-wrap-opencv-c-function-in-c-code", "title": "How to wrap OpenCV C++ function in C code", "body": "<p>I am able to run my C++ code to display the image, but am trying to integrate it with some other C code.</p>\n\n<p>I'm looking for a walkthrough of how to write a C wrapper for my C++ code in OpenCV. I will need to be able to call this C++ method in my C code in future!</p>\n\n<pre><code>#include &lt;opencv2/core/core.hpp&gt;\n#include &lt;opencv2/highgui/highgui.hpp&gt;\n#include &lt;iostream&gt;\n\nusing namespace cv;\nusing namespace std;\n\nint main( int argc, char** argv )\n{\n    if( argc != 2)\n    {\n     cout &lt;&lt;\" Usage: display_image ImageToLoadAndDisplay\" &lt;&lt; endl;\n     return -1;\n    }\n\n    Mat image;\n    image = imread(argv[1], CV_LOAD_IMAGE_COLOR);   // Read the file\n\n    if(! image.data )                              // Check for invalid input\n    {\n        cout &lt;&lt;  \"Could not open or find the image\" &lt;&lt; std::endl ;\n        return -1;\n    }\n\n    namedWindow( \"Display window\", WINDOW_AUTOSIZE );// Create a window for display.\n    imshow( \"Display window\", image );                   // Show our image inside it.\n\n    waitKey(0);                                          // Wait for a keystroke in the window\n    return 0;\n}\n</code></pre>\n\n<p>Here is a sample OpenCV C++ code I am currently working with first.</p>\n"}, {"tags": ["c", "c-strings"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12515389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80516173af63a624c8d0ada138b27d6?s=128&d=identicon&r=PG&f=1", "display_name": "hateheapallocator", "link": "https://stackoverflow.com/users/12515389/hateheapallocator"}, "edited": false, "score": 0, "creation_date": 1576057316, "post_id": 59278294, "comment_id": 104771622, "body": "why does it stop at Tessi though? if buggy_substring doesn&#39;t do anything, shouldn&#39;t it print the whole thing (Tessier-Lavigne)?"}, {"owner": {"reputation": 738, "user_id": 11218205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea0f36074b704f686940881088809458?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Phil", "link": "https://stackoverflow.com/users/11218205/dr-phil"}, "edited": false, "score": 1, "creation_date": 1576075242, "post_id": 59278294, "comment_id": 104781464, "body": "Oh it does modify the string buffer where you put the zero to the the setting. But the head of the buffer telling the same"}, {"owner": {"reputation": 1, "user_id": 12515389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80516173af63a624c8d0ada138b27d6?s=128&d=identicon&r=PG&f=1", "display_name": "hateheapallocator", "link": "https://stackoverflow.com/users/12515389/hateheapallocator"}, "reply_to_user": {"reputation": 738, "user_id": 11218205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea0f36074b704f686940881088809458?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Phil", "link": "https://stackoverflow.com/users/11218205/dr-phil"}, "edited": false, "score": 0, "creation_date": 1576093502, "post_id": 59278294, "comment_id": 104790641, "body": "@DrPhil why is that updated but not the head? I&#39;m confused"}, {"owner": {"reputation": 738, "user_id": 11218205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea0f36074b704f686940881088809458?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Phil", "link": "https://stackoverflow.com/users/11218205/dr-phil"}, "edited": false, "score": 0, "creation_date": 1576152587, "post_id": 59278294, "comment_id": 104811004, "body": "i have updated my answer to give a trace of the code and how the buffer changes. The key is that the original pointer to the buffer doesn&#39;t change but the contents of the buffer do change"}], "tags": [], "owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "is_accepted": false, "score": 1, "last_activity_date": 1576033135, "creation_date": 1576033135, "answer_id": 59278294, "question_id": 59278258, "link": "https://stackoverflow.com/questions/59278258/why-does-this-print-the-wrong-part-of-the-string/59278294#59278294", "title": "Why does this print the wrong part of the string?", "body": "<p>C is a pass-by-value language. Your <code>input += pos</code> in your substring function doesn't change anything about <code>name</code> in <code>main</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 12515389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80516173af63a624c8d0ada138b27d6?s=128&d=identicon&r=PG&f=1", "display_name": "hateheapallocator", "link": "https://stackoverflow.com/users/12515389/hateheapallocator"}, "edited": false, "score": 0, "creation_date": 1576057291, "post_id": 59278297, "comment_id": 104771609, "body": "why does it stop at Tessi though? if buggy_substring doesn&#39;t do anything, shouldn&#39;t it print the whole thing?"}], "tags": [], "owner": {"reputation": 738, "user_id": 11218205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea0f36074b704f686940881088809458?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Phil", "link": "https://stackoverflow.com/users/11218205/dr-phil"}, "is_accepted": false, "score": 2, "last_activity_date": 1576174399, "last_edit_date": 1576174399, "creation_date": 1576033149, "answer_id": 59278297, "question_id": 59278258, "link": "https://stackoverflow.com/questions/59278258/why-does-this-print-the-wrong-part-of-the-string/59278297#59278297", "title": "Why does this print the wrong part of the string?", "body": "<p>You change the start position only in the function. However, when printing you are still passing the original head of the  string to printf.</p>\n\n<p>Try passing name+3 to printf . </p>\n\n<pre><code>\n    int main(int argc, char *argv[])\n    {\n     char name[16];\n    // allocated a buffer of 16 bytes on the stack (called name)\n    // note that an array of chars and a pointer to a char is NOT the same thing\n     strcpy(name, \"Tessier-Lavigne\");\n    // copies from a const null-terminated string \n    // now char* name contains\n    // ['T','e','s','s','i','e','r','-','L','a','v','i','g','n','e','\\0']\n     buggy_substring(name, 3, 2);\n    // name is passed as an immutable number \"by value\", \n    // the value of name is not changed\n    // however, the contents name points to can be\n    // now name is\n    // ['T','e','s','s','\\0','e','r','-','L','a','v','i','g','n','e','\\0']\n\n\n     printf(\"%s\\n\", name);\n    //output 'T','e','s','s' + new line\n     return 0;\n    } \n\n\n\n    void buggy_substring(char *input, size_t pos, size_t len)\n    {\n    //local pointer input\n    // points to ['T','e','s','s','i','e','r','-','L','a','v','i','g','n','e','\\0']\n    //pos=3\n    //len=2\n     input += pos;\n    // input points to 's' (original name still points to 'T'\n\n     input[len] = '\\0';\n    //equivalent code\n     char * p=input;\n     p+=len;\n     *p='\\0';\n    // input+2 points to 'i'\n    // 'i' is replaced with zero\n    // the original buffer looks like\n    //['T','e','s','s','\\0','e','r','-','L','a','v','i','g','n','e','\\0']\n    } \n\n</code></pre>\n\n<p><em>Disclaimer</em>: Of course you should he using library string manipulation functions for more serious code and don't try to reinvent the wheel.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 12515389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80516173af63a624c8d0ada138b27d6?s=128&d=identicon&r=PG&f=1", "display_name": "hateheapallocator", "link": "https://stackoverflow.com/users/12515389/hateheapallocator"}, "edited": false, "score": 0, "creation_date": 1576057321, "post_id": 59278351, "comment_id": 104771626, "body": "why does it stop at Tessi though? if buggy_substring doesn&#39;t do anything, shouldn&#39;t it print the whole thing (Tessier-Lavigne)?"}], "tags": [], "owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "is_accepted": false, "score": 1, "last_activity_date": 1576033647, "creation_date": 1576033647, "answer_id": 59278351, "question_id": 59278258, "link": "https://stackoverflow.com/questions/59278258/why-does-this-print-the-wrong-part-of-the-string/59278351#59278351", "title": "Why does this print the wrong part of the string?", "body": "<p>You need to pass a pointer <em>to the pointer</em> so that way the <em>pointer</em> gets modified, rather than the object being referenced.</p>\n\n<pre><code>void substring(char **input, size_t pos, size_t len)\n{\n *input += pos;\n (*input)[len] = '\\0';\n} \n</code></pre>\n\n<p>Also would work if you pass pointer to array <code>char (*pa)[]</code></p>\n"}, {"tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": false, "score": 0, "last_activity_date": 1576107296, "creation_date": 1576107296, "answer_id": 59295690, "question_id": 59278258, "link": "https://stackoverflow.com/questions/59278258/why-does-this-print-the-wrong-part-of-the-string/59295690#59295690", "title": "Why does this print the wrong part of the string?", "body": "<p>Since C is pass-by-value, <em>copies</em> of the values which are provided as arguments are bound to the formal parameters in the function call. This means that, within <code>buggy_substring()</code>, <code>input</code> is a <em>copy</em> of the pointer value identified by <code>name</code> in <code>main()</code>. (Of course, <code>name</code> is an array of <code>char</code>, which decays to a pointer to <code>char</code> in the function call.)</p>\n\n<p>Since <code>input</code> is but a copy of <code>name</code> (the pointer), any changes made to <code>input</code> (which is a pointer) cannot affect the value of <code>name</code> back in <code>main()</code>. But, <code>input</code> still points to the same location in memory as <code>name</code>, so changes made <em>through</em> <code>input</code> (a pointer) affect the same region of memory pointed to by <code>name</code> (the pointer).</p>\n\n<p>The upshot of all this is that when the value of <code>input</code> is incremented it no longer points to the same memory location as <code>name</code> (the pointer). The incremented pointer can be used to write to memory with <code>input[len] = '\\0'</code>, but when the <code>buggy_substring()</code> function returns, the lifetime of <code>input</code> ends (<code>input</code> is an <em>automatic variable</em>) and when back in <code>main()</code> <code>name</code> remains unchanged. So, when <code>printf()</code> is called, the string pointed to by <code>name</code> (the pointer: remember that array identifiers decay to pointers to their first elements in most cases) is printed from the beginning up to the newly inserted null-terminator.</p>\n"}], "owner": {"reputation": 1, "user_id": 12515389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80516173af63a624c8d0ada138b27d6?s=128&d=identicon&r=PG&f=1", "display_name": "hateheapallocator", "link": "https://stackoverflow.com/users/12515389/hateheapallocator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1576174399, "creation_date": 1576032849, "question_id": 59278258, "link": "https://stackoverflow.com/questions/59278258/why-does-this-print-the-wrong-part-of-the-string", "title": "Why does this print the wrong part of the string?", "body": "<pre><code>void buggy_substring(char *input, size_t pos, size_t len)\n{\n input += pos;\n input[len] = '\\0';\n} \n\nint main(int argc, char *argv[])\n{\n char name[16];\n strcpy(name, \"Tessier-Lavigne\");\n buggy_substring(name, 3, 2);\n printf(\"%s\\n\", name);\n return 0;\n} \n</code></pre>\n\n<p>Why does this print \"Tessi\" instead of 'si'?\nIs this an issue of mingling size_t with char? </p>\n"}, {"tags": ["c", "assembly", "x86", "disassembly"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 4, "creation_date": 1576029780, "post_id": 59277882, "comment_id": 104762611, "body": "Yes you are correct. <code>0x405064</code> is the address of the string, but that is in a different section that you did not dump. Would not make sense to disassemble, but you can view the data. It&#39;s stored at <code>[esp]</code> because that&#39;s going to be the first argument to <code>printf</code>."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1576030248, "post_id": 59277882, "comment_id": 104762698, "body": "In addition to what @Jester said: 1) <code>printf</code> is in a standard C library, which is in a library file (not a DLL file), and the code for it is linked into your executable. Code in a DLL file is loaded at runtime. 2)  <code>printf</code> is a terrible function to try to work out in disassembly because it accepts a variable number of arguments after the first one depending on the format string (specified in the first argument)."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 2, "creation_date": 1576030996, "post_id": 59277882, "comment_id": 104762837, "body": "The code for <code>printf</code> is only linked into your executable if you use static linking. Normally it is in a DLL/shared object, e.g. <code>libc.so</code> and it is loaded at runtime."}, {"owner": {"reputation": 25, "user_id": 10807168, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LbA4usjpUaU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jRv2UJoUZ9AY5SfwgqXB4jOCay9g/mo/photo.jpg?sz=128", "display_name": "Constantine Freak", "link": "https://stackoverflow.com/users/10807168/constantine-freak"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1576031231, "post_id": 59277882, "comment_id": 104762889, "body": "@Jester How would I go about dumping that section with objdump or gdb?"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 2, "creation_date": 1576031338, "post_id": 59277882, "comment_id": 104762909, "body": "gdb can show it to you using <code>x&#47;s 0x405064</code>. Or <code>objdump -s -j .rodata</code> assuming your compiler put it into that section, could also be <code>.data</code>. Alternatively pass an address range, e.g. <code>objdump -s --start-address=0x405064 --stop-address=0x405069</code> or similar."}, {"owner": {"reputation": 87, "user_id": 11837920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a63446cdf9e7f3ddcadccc5ea1147326?s=128&d=identicon&r=PG&f=1", "display_name": "user338717", "link": "https://stackoverflow.com/users/11837920/user338717"}, "edited": false, "score": 0, "creation_date": 1576275587, "post_id": 59277882, "comment_id": 104860284, "body": "If you use a better disassembler than objdump/GDB then it would have detected that a string of ascii bytes exists at the address being moved into [esp] and could have labelled the asm with a comment indicating the content of the string at the address 0x405064. I suggest IDA free or radare2 or ghidra"}], "owner": {"reputation": 25, "user_id": 10807168, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LbA4usjpUaU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jRv2UJoUZ9AY5SfwgqXB4jOCay9g/mo/photo.jpg?sz=128", "display_name": "Constantine Freak", "link": "https://stackoverflow.com/users/10807168/constantine-freak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576029505, "creation_date": 1576029505, "question_id": 59277882, "link": "https://stackoverflow.com/questions/59277882/confused-as-to-how-printf-and-strings-are-handled-when-disassembling-a-c-program", "title": "Confused as to how printf and strings are handled when disassembling a C program", "body": "<p>I'm writing small C programs and disassembling them using objdump and gdb to see what the assembly looks like. I don't understand how functions like printf work on an assembly level. The C program I last compiled is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n\n    printf(\"test\");\n    return 0;\n}\n</code></pre>\n\n<p>A gdb disassembly of the program produces the following:</p>\n\n<pre><code>Dump of assembler code for function main:\n   0x00401460 &lt;+0&gt;:     push   ebp\n   0x00401461 &lt;+1&gt;:     mov    ebp,esp\n   0x00401463 &lt;+3&gt;:     and    esp,0xfffffff0\n   0x00401466 &lt;+6&gt;:     sub    esp,0x10\n   0x00401469 &lt;+9&gt;:     call   0x4019c0 &lt;__main&gt;\n   0x0040146e &lt;+14&gt;:    mov    DWORD PTR [esp],0x405064\n   0x00401475 &lt;+21&gt;:    call   0x403a60 &lt;printf&gt;\n   0x0040147a &lt;+26&gt;:    mov    eax,0x0\n   0x0040147f &lt;+31&gt;:    leave\n   0x00401480 &lt;+32&gt;:    ret\n   0x00401481 &lt;+33&gt;:    nop\n   0x00401482 &lt;+34&gt;:    nop\n   0x00401483 &lt;+35&gt;:    nop\n   0x00401484 &lt;+36&gt;:    xchg   ax,ax\n   0x00401486 &lt;+38&gt;:    xchg   ax,ax\n   0x00401488 &lt;+40&gt;:    xchg   ax,ax\n   0x0040148a &lt;+42&gt;:    xchg   ax,ax\n   0x0040148c &lt;+44&gt;:    xchg   ax,ax\n   0x0040148e &lt;+46&gt;:    xchg   ax,ax\nEnd of assembler dump.\n</code></pre>\n\n<p>I understand that the printf function is part of the standard C library, which is a precompiled DLL. However the string I'm passing to printf is not precompiled and should be found somewhere in my program. Where is it? </p>\n\n<p>The only place I can think of is main+14. I run 405064 into a hexadecimal to ascii and utf converter, neither of which produced \"test\". Does that mean 0x405064 is the address where the \"test\" string is stored? If so, why is it in a random address rather than one relative to the main function? Or is text encoded differently in memory and my hex to ascii converter is pointless?</p>\n\n<p>Also, if the stack is allocated 16 bytes, why is the string stored in [esp]? Aren't characters 1 byte long, and therefore the string should be stored in [ebp-4]?</p>\n"}, {"tags": ["c", "arrays", "structure"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1576026894, "post_id": 59277591, "comment_id": 104762066, "body": "Yes, this is what <code>realloc</code> is for and is how resizable vectors work in other languages (e.g. <code>ArrayList</code> in Java, <code>List&lt;T&gt;</code> in .NET, <code>vector&lt;T&gt;</code> in C++ STL). Use a heap-allocated array (<code>struct Person* people = calloc( sizeof(struct Person), 10 )</code> instead of an automatic array."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1576027123, "post_id": 59277591, "comment_id": 104762119, "body": "Tip: Use <code>char*</code> instead of fixed-length character buffers and then dynamically allocate using <code>calloc</code> or <code>malloc</code> or <code>strdup</code>. Also <b>use loops</b> and don&#39;t just spam-paste a bunch of largely identical lines."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1576027190, "post_id": 59277591, "comment_id": 104762135, "body": "Note you&#39;re passing in a pointer to the <i>fourth entry</i> in a three-element array. This code will crash and crash hard. You should pass in <code>&amp;person[0]</code>. An array defined as <code>x[3]</code> has entries numbered with indexes<code>0</code>..<code>2</code>."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 12303289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/965bdd413da4e195ad4b71df06ac932e?s=128&d=identicon&r=PG&f=1", "display_name": "yeebyeeb", "link": "https://stackoverflow.com/users/12303289/yeebyeeb"}, "edited": false, "score": 0, "creation_date": 1576074661, "post_id": 59277822, "comment_id": 104781119, "body": "Wow thanks for the tips. This is all very helpful. The solution I was able to come up with last night instead of the &quot;malloc&quot; bit was to include an if statement: &quot;if(feof)){break;}&quot; after the fscanf, and simply removing the exit condition for the for loop. Is this an acceptable solution as well? What kind of disadvantages am I presenting to myself by failing to use malloc?"}, {"owner": {"reputation": 1472, "user_id": 6942918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EzNAX.png?s=128&g=1", "display_name": "kyriakosSt", "link": "https://stackoverflow.com/users/6942918/kyriakosst"}, "reply_to_user": {"reputation": 29, "user_id": 12303289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/965bdd413da4e195ad4b71df06ac932e?s=128&d=identicon&r=PG&f=1", "display_name": "yeebyeeb", "link": "https://stackoverflow.com/users/12303289/yeebyeeb"}, "edited": false, "score": 0, "creation_date": 1576075325, "post_id": 59277822, "comment_id": 104781513, "body": "without malloc, or rather, realloc, you have to know in advance how many lines you will read from the file. i.e. if you declare <code>struct Person person[3];</code> but in your loop, you read 4 lines you will get an error."}], "tags": [], "owner": {"reputation": 1472, "user_id": 6942918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EzNAX.png?s=128&g=1", "display_name": "kyriakosSt", "link": "https://stackoverflow.com/users/6942918/kyriakosst"}, "is_accepted": true, "score": 1, "last_activity_date": 1576029039, "creation_date": 1576029039, "answer_id": 59277822, "question_id": 59277591, "link": "https://stackoverflow.com/questions/59277591/learning-to-process-files-trying-to-pass-array-of-structures-by-reference-to-a/59277822#59277822", "title": "Learning to process files, trying to pass array of structures by reference to a fcn", "body": "<blockquote>\n  <p>Currently I do not get any errors for this program but it simply does not process the file into the structure at the fscanf. Am I referencing the structure wrong?</p>\n</blockquote>\n\n<p>You are almost there, there are just a few things you missed:</p>\n\n<ul>\n<li><code>for(int i=0;i&lt;2;i++)</code> should be <code>for(int i=0;i&lt;3;i++)</code> as you will never read the third line the way it is now.</li>\n<li>Drop the <code>&amp;</code> when reading with scanf and storing in a string. That is, change <code>fscanf(cfPtr,\"...\",&amp;array[i].lastname,...);</code> to <code>fscanf(cfPtr,\"...\",array[i].lastname,...);</code>. A string (i.e. <code>char lastname[30];</code>) is already an array and when using arrays by their names you essentially get a pointer on its first element, so there is no need for that <code>&amp;</code>.</li>\n<li>The call of the function (<code>function(&amp;person[3]);</code>) is not correct: <code>&amp;person[3]</code> means that you are getting the address of the 4th (out of bounds) element of the person array. What you need to pass is the array itself which is simply <code>function(person)</code>. This is for the same reason as in the previous bullet.  </li>\n<li>Also, why do you have your function returning an <code>int</code> when you are not returning anything?</li>\n</ul>\n\n<hr>\n\n<blockquote>\n  <p>I was also wondering if there was a way to make the for loop work for any size of array of structures-- meaning what could I replace the \"2\" condition in my for loop with in order for it to just continually fill an array of adequate size until it ran out of information to process?</p>\n</blockquote>\n\n<p>There is a way, namely using a dynamic array of type <code>struct Person</code> and allocating space to it at first with <code>malloc</code> and then by calling <code>realloc</code> in every iteration inside the function. Of course, you need to keep a counter of how many objects/lines you have read. You can find more about what you are asking by following <a href=\"https://stackoverflow.com/questions/12990723/dynamic-array-of-structs-in-c\">this</a> or <a href=\"https://stackoverflow.com/questions/260915/how-can-i-create-a-dynamically-sized-array-of-structs\">this</a> SO question, or searching and reading about dynamic arrays in C.</p>\n"}], "owner": {"reputation": 29, "user_id": 12303289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/965bdd413da4e195ad4b71df06ac932e?s=128&d=identicon&r=PG&f=1", "display_name": "yeebyeeb", "link": "https://stackoverflow.com/users/12303289/yeebyeeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 59277822, "answer_count": 1, "score": 2, "last_activity_date": 1576029039, "creation_date": 1576026791, "last_edit_date": 1576027094, "question_id": 59277591, "link": "https://stackoverflow.com/questions/59277591/learning-to-process-files-trying-to-pass-array-of-structures-by-reference-to-a", "title": "Learning to process files, trying to pass array of structures by reference to a fcn", "body": "<p>I am trying to pass an array of structures to a function, and then have that function process a file and fill the array of structures with values. The file is a text file containing:</p>\n\n<pre><code>Gates M 60\nJobs M 55\nJane F 45\n</code></pre>\n\n<p>which would fill the structure of arrays. ex. person[0] should contain Gates M 60. \nCurrently I do not get any errors for this program but it simply does not process the file into the structure at the fscanf. Am I referencing the structure wrong?</p>\n\n<p>I was also wondering if there was a way to make the for loop work for any size of array of structures-- meaning what could I replace the \"2\" condition in my for loop with in order for it to just continually fill an array of adequate size until it ran out of information to process?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct Person\n{\n    char lastname[30];\n    char gender;\n    unsigned int age;\n};\n\nint function(struct Person array[])\n{\n    FILE *cfPtr;\n    if((cfPtr = fopen(\"C:\\\\Users\\\\Nick\\\\Desktop\\\\textfile\",\"r\"))==NULL)\n    {\n        printf(\"File cannot be opened\");\n    }\n    else\n    {\n        for(int i=0;i&lt;2;i++)\n        {\n            fscanf(cfPtr,\"%10s %c %3d\",&amp;array[i].lastname,&amp;array[i].gender,&amp;array[i].age);\n        }\n    }\n}\nint main(void)\n{\n    struct Person person[3];\n    function(&amp;person[3]);\n    printf(\"%s %c %d\\n\",person[0].lastname, person[0].gender, person[0].age);\n    printf(\"%s %c %d\\n\",person[1].lastname, person[1].gender, person[1].age);\n    printf(\"%s %c %d\\n\",person[2].lastname, person[2].gender, person[2].age);\n}\n</code></pre>\n"}, {"tags": ["c", "arm", "neon", "nxp-microcontroller", "imx7"], "comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 2, "creation_date": 1576025733, "post_id": 59277416, "comment_id": 104761811, "body": "Double check your assembly output to see if it is doing what you expect. Better yet, see if you can convince your compiler to do the work for you by giving hints to the vectorizer.  Ah, they are floats.  Ok."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1576025939, "post_id": 59277416, "comment_id": 104761851, "body": "Any memory caching on the system?  You are spending most of your time basically loading and saving memory.  If you have no cache on this memory, that would explain the lack of perf.  Ok, specs say L1/L2."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1576026148, "post_id": 59277416, "comment_id": 104761899, "body": "Basically then, all the NEON can give you is 2 multiplies at a time since the loads and stores are going to be bus bound.  I am guess this works out to the small gain you are seeing in perf."}, {"owner": {"reputation": 4932, "user_id": 1021504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dbd1ccace98a4e6473cc18c38dbb6d4?s=128&d=identicon&r=PG", "display_name": "Jake &#39;Alquimista&#39; LEE", "link": "https://stackoverflow.com/users/1021504/jake-alquimista-lee"}, "edited": false, "score": 1, "creation_date": 1576051923, "post_id": 59277416, "comment_id": 104768828, "body": "Most probably your C version gets auto-vectorized."}], "owner": {"reputation": 11, "user_id": 12514911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd92cc6fe5eabc73a41232725bde9b7?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandre Caron", "link": "https://stackoverflow.com/users/12514911/alexandre-caron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576041739, "creation_date": 1576025325, "last_edit_date": 1576041739, "question_id": 59277416, "link": "https://stackoverflow.com/questions/59277416/neon-has-same-performance-as-c-on-imx7", "title": "NEON has same performance as C on IMX7", "body": "<p>Hi I'm developing and image processing application on the Nxp imx7 and I want to compare performance of NEON instrutions vs pure C.</p>\n\n<p>c: a,b,c are float32. Take 11ms to run</p>\n\n<pre><code>for(int pixIndex = 0; pixIndex&lt;(640*480); pixIndex++)\n{\n    a[pixIndex] = (a[pixIndex] * b[pixIndex]) + c[pixIndex];\n}\n</code></pre>\n\n<p>NEON: Take 10ms to run</p>\n\n<pre><code>for(int pixIndex = 0; pixIndex &lt; (640*480)/2; pixIndex++)\n{\n    float32x2_t dVect1, dVect2,dVect3;\n\n    dVect1 = vld1_f32(a);\n    dVect2 = vld1_f32(b);\n    dVect3 = vld1_f32(c);\n    dVect1 = vmla_f32(dVect3, dVect1, dVect2);\n    vst1_f32(a, dVect1);\n    a += 2;\n    b += 2;\n    c += 2;\n}\n</code></pre>\n\n<p>Why NEON is only 1ms faster than c ? Do I miss something here ?</p>\n"}, {"tags": ["java", "c", "stack"], "comments": [{"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 2, "creation_date": 1576021108, "post_id": 59276896, "comment_id": 104760693, "body": "1. The languages fundamentally differ. 2. Java uses memory management through garbage collection, while C does not. 3. Your C code invokes undefined behavior; Java has defined behavior."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1576021289, "post_id": 59276896, "comment_id": 104760748, "body": "Your functions for Java and C are not equivalent.  The C variant is taking use input to fill in a local array.  The Java variant is simply assigning a value to a String.  <code>char *name = &quot;A name&quot;;</code> would be a closer analog to your Java function, and it would work fine."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1576022097, "post_id": 59276896, "comment_id": 104760967, "body": "It&#39;s better to compare C++ (<code>std::string name</code>) vs. Java as they both have memory management facilities C completely lacks. This is largely a product of C being designed to be low-level while C++ and Java have significant and deep abstraction layers built on lower-level primitives."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1576024824, "post_id": 59276896, "comment_id": 104761596, "body": "The stack IS clobbered in Java. It&#39;s just that function-local variables that get returned are placed on the heap, where they will be preserved until there are no longer any references, then garbage collected. That&#39;s part of the language."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1576050261, "post_id": 59276896, "comment_id": 104768091, "body": "Java barely uses the stack. All objects are silently heap allocated. And the reason the C code won&#39;t work is not because of some &quot;clobber&quot; but because you are returning an invalid pointer to the caller."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1576050408, "post_id": 59276896, "comment_id": 104768161, "body": "The equivalent C code to the Java example would be something like <code>String* getName(void) { String* name; name = StringInit(); return name; }</code>. Where &quot;String&quot; and &quot;StringInit&quot; is some string library using malloc()."}, {"owner": {"reputation": 34123, "user_id": 16012, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a96d7d4f942af97c61081d92fa074ca3?s=128&d=identicon&r=PG", "display_name": "JoelFan", "link": "https://stackoverflow.com/users/16012/joelfan"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1576089047, "post_id": 59276896, "comment_id": 104788739, "body": "@Lundin that is NOT true... Java uses the stack constantly.... just not for object memory allocation... references, primitives and return values are stored on the stack.... see <a href=\"https://www.geeksforgeeks.org/java-virtual-machine-jvm-stack-area/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/java-virtual-machine-jvm-stack-area</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 34123, "user_id": 16012, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a96d7d4f942af97c61081d92fa074ca3?s=128&d=identicon&r=PG", "display_name": "JoelFan", "link": "https://stackoverflow.com/users/16012/joelfan"}, "edited": false, "score": 0, "creation_date": 1576137807, "post_id": 59276896, "comment_id": 104803257, "body": "@JoelFan Obviously, and that&#39;s what I meant with barely using the stack. High level computers cannot function without a stack."}, {"owner": {"reputation": 34123, "user_id": 16012, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a96d7d4f942af97c61081d92fa074ca3?s=128&d=identicon&r=PG", "display_name": "JoelFan", "link": "https://stackoverflow.com/users/16012/joelfan"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1576186689, "post_id": 59276896, "comment_id": 104827995, "body": "@Lundin... &#175;_(\u30c4)_/&#175; ... I guess I assumed by &quot;barely&quot; you didn&#39;t mean on every method call, method return, method parameter access and scoped variable access.... my bad, I guess.  And there were/are plenty of IBM mainframe architectures that function perfectly well without stacks... the main drawback is the lack of recursive calls.. you store the return addresses and parameters in the code memory"}], "answers": [{"comments": [{"owner": {"reputation": 30143, "user_id": 12299000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0pja9.png?s=128&g=1", "display_name": "kaya3", "link": "https://stackoverflow.com/users/12299000/kaya3"}, "edited": false, "score": 0, "creation_date": 1576021460, "post_id": 59276916, "comment_id": 104760788, "body": "The local variable is allocated on the stack; it is what holds the reference to the string object."}], "tags": [], "owner": {"reputation": 34123, "user_id": 16012, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a96d7d4f942af97c61081d92fa074ca3?s=128&d=identicon&r=PG", "display_name": "JoelFan", "link": "https://stackoverflow.com/users/16012/joelfan"}, "is_accepted": false, "score": 2, "last_activity_date": 1576021105, "creation_date": 1576021105, "answer_id": 59276916, "question_id": 59276896, "link": "https://stackoverflow.com/questions/59276896/stack-usage-in-c-vs-in-java/59276916#59276916", "title": "Stack usage in C vs in Java", "body": "<p>In Java, the memory for local variables is not allocated on the stack... only the reference is put on the stack.  The object itself is put on the heap.</p>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 1, "last_activity_date": 1576036624, "last_edit_date": 1576036624, "creation_date": 1576021145, "answer_id": 59276922, "question_id": 59276896, "link": "https://stackoverflow.com/questions/59276896/stack-usage-in-c-vs-in-java/59276922#59276922", "title": "Stack usage in C vs in Java", "body": "<p>You are returning a pointer to a local variable, which goes out of scope once the function returns. Dereferencing that pointer then is undefined behaviour in C.</p>\n\n<p>In Java, <code>String</code> is a managed object and is subject to garbage collection. So it will be retained until no more references to it exists. </p>\n\n<p>C, in contrast, does not have managed objects nor a garbage collector. You have to take care of the life time of \"objects\" on your own. </p>\n"}, {"tags": [], "owner": {"reputation": 30143, "user_id": 12299000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0pja9.png?s=128&g=1", "display_name": "kaya3", "link": "https://stackoverflow.com/users/12299000/kaya3"}, "is_accepted": false, "score": 0, "last_activity_date": 1576021226, "creation_date": 1576021226, "answer_id": 59276928, "question_id": 59276896, "link": "https://stackoverflow.com/questions/59276896/stack-usage-in-c-vs-in-java/59276928#59276928", "title": "Stack usage in C vs in Java", "body": "<p>In Java the string is allocated on the heap, not the stack, and new memory is allocated for each string. It is actually not possible to clobber a string in Java, because Java's strings are immutable.</p>\n"}, {"tags": [], "owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 1, "last_activity_date": 1576028026, "last_edit_date": 1576028026, "creation_date": 1576022913, "answer_id": 59277141, "question_id": 59276896, "link": "https://stackoverflow.com/questions/59276896/stack-usage-in-c-vs-in-java/59277141#59277141", "title": "Stack usage in C vs in Java", "body": "<p>In Java, <code>new String</code> creates an object on the <em>heap</em>, not the <em>stack</em>. As such, <code>new</code> in Java is akin to <code>malloc</code> in C. </p>\n\n<p>The equivalent of</p>\n\n<pre><code>// Java\npublic static String getName() {\n    String name = \"A name\";\n    return name; \n}\n</code></pre>\n\n<p>would be</p>\n\n<pre><code>// C\nstatic String *getName() {\n    String *name = String_new(\"A name\");\n    return name; \n}\n</code></pre>\n\n<p>where the <code>String</code> \"class\" would be defined something like the following:</p>\n\n<pre><code>typedef struct {\n   char *buf;\n} String;\n\nString *String_new(const char* src) {\n   String *string = malloc(sizeof(String));\n   string-&gt;buf = strdup(src);\n   return string;\n}\n\nvoid String_free(String *this) {\n   free(this-&gt;buf);\n   free(this);\n}\n</code></pre>\n\n<p>There is no equivalent to C's <code>char name[32];</code> (an array where the elements are on the stack) in Java.</p>\n"}], "owner": {"reputation": 67, "user_id": 12329849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f42fac8d87ac9e0744cd07614367f866?s=128&d=identicon&r=PG&f=1", "display_name": "randomtrekker", "link": "https://stackoverflow.com/users/12329849/randomtrekker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 59277141, "answer_count": 4, "score": -3, "last_activity_date": 1576036624, "creation_date": 1576020942, "question_id": 59276896, "link": "https://stackoverflow.com/questions/59276896/stack-usage-in-c-vs-in-java", "title": "Stack usage in C vs in Java", "body": "<p>I am learning about the usage of stack and I notice that they are used differently, or apparently so, in C and Java. For example, the code below written in C will not work because it will clobber \"name\"</p>\n\n<pre><code>char* getName(){\nchar name[32];\nscanf( \"%s\",name);\nreturn name;\n}\n\nint main (int argc, char *argv[]){\nchar *myName = getName();\n\nprintf(\"%s\", myName);\n}    \n</code></pre>\n\n<p>However, if I write something similar in Java, it works just fine:</p>\n\n<pre><code>public static String getName(){\nString name = \"A name\";\nreturn name ; \n\n}\n\nstatic void main(String[] args){\nString name = getName();\nSystem.out.print(name);\n}\n</code></pre>\n\n<p>I want to know why. Why does the stack not clobber in Java but does so in C ?</p>\n"}, {"tags": ["c", "linux-kernel", "system-calls"], "comments": [{"owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 0, "creation_date": 1576028751, "post_id": 59276859, "comment_id": 104762437, "body": "<a href=\"http://man7.org/linux/man-pages/man2/syscalls.2.html\" rel=\"nofollow noreferrer\">man 2 syscalls</a> could be of interest."}], "answers": [{"tags": [], "owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "is_accepted": true, "score": 5, "last_activity_date": 1576031875, "last_edit_date": 1576031875, "creation_date": 1576031492, "answer_id": 59278088, "question_id": 59276859, "link": "https://stackoverflow.com/questions/59276859/where-is-source-code-for-linux-kernel-syscall-service-routines/59278088#59278088", "title": "Where is source code for linux kernel syscall service routines?", "body": "<p>The kernel does indeed define a function called <code>sys_read</code> that behaves as you said.  It's just a little hard to find with searching, because it's defined through a helper macro using <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Concatenation.html\" rel=\"noreferrer\">token concatenation</a>.  See <a href=\"https://github.com/torvalds/linux/blob/3c2edc36a77420d8be05d656019dbc8c31535992/fs/read_write.c#L595\" rel=\"noreferrer\"><code>fs/read_write.c</code> line 595</a>:</p>\n\n<pre><code>SYSCALL_DEFINE3(read, unsigned int, fd, char __user *, buf, size_t, count)\n{\n    return ksys_read(fd, buf, count);\n}\n</code></pre>\n\n<p>This has the effect of:</p>\n\n<ul>\n<li><p>declaring a function named <code>sys_read</code>, <a href=\"https://stackoverflow.com/questions/34892601/what-does-the-weak-alias-function-do-and-where-is-it-defined\">aliased</a> to <code>__se_sys_read</code></p></li>\n<li><p>defining <code>__se_sys_read</code>, which apparently sign-extends any 32-bit arguments and then calls <code>__do_sys_read</code></p></li>\n<li><p>defining <code>__do_sys_read</code> whose body is as shown (i.e. calling <code>ksys_read</code> which does the actual work).</p></li>\n</ul>\n\n<p>You can see the definition of the <code>SYSCALL_DEFINEx</code> macros at <a href=\"https://github.com/torvalds/linux/blob/ceb307474506f888e8f16dab183405ff01dffa08/include/linux/syscalls.h#L206\" rel=\"noreferrer\"><code>include/linux/syscalls.h</code> line 206</a>.</p>\n"}], "owner": {"reputation": 667, "user_id": 2762678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee48142c79e0272fef5875126ebe6912?s=128&d=identicon&r=PG&f=1", "display_name": "QnA", "link": "https://stackoverflow.com/users/2762678/qna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 1, "accepted_answer_id": 59278088, "answer_count": 1, "score": 2, "last_activity_date": 1576031875, "creation_date": 1576020680, "last_edit_date": 1576028979, "question_id": 59276859, "link": "https://stackoverflow.com/questions/59276859/where-is-source-code-for-linux-kernel-syscall-service-routines", "title": "Where is source code for linux kernel syscall service routines?", "body": "<p>My understanding of a syscall (high level) workflow is:</p>\n\n<ol>\n<li>User calls libc wrapper</li>\n<li>wrapper puts syscall number and arguments in the right place, registers or stack</li>\n<li>wrapper executes syscall or int 0x80 instruction</li>\n<li>kernel interrupt handler calls sys_xxx() service routine</li>\n</ol>\n\n<p>If that is the case, then there should be a bunch of sys_xxx() functions in kernel source. For example, for <code>read()</code>, in kernel 2.6 code, I found <a href=\"https://elixir.bootlin.com/linux/v2.6.11/source/fs/read_write.c#L312\" rel=\"nofollow noreferrer\">sys_read</a>. However, in kernel 5.4 code, I did not find such service routine code, the only <a href=\"https://elixir.bootlin.com/linux/v5.4/source/tools/include/nolibc/nolibc.h#L1631\" rel=\"nofollow noreferrer\">sys_read</a> I found is acting like a drop in replacement for the libc wrapper. So I am confused..</p>\n\n<p>A related question - the reason that kernel puts the implementation in sys_xxx() is that kernel space can also call these functions, is that correct?</p>\n"}, {"tags": ["c", "struct", "unions"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1576020983, "post_id": 59276786, "comment_id": 104760668, "body": "Why are you doing 8-bit bitfields on 16-bit fixed width types instead of just using 8-bit fixed width types (<code>uint8_t</code>)?"}, {"owner": {"reputation": 177, "user_id": 2487785, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d5e8d56488c80d81d782bb5c3ed7c2a6?s=128&d=identicon&r=PG", "display_name": "beeflobill", "link": "https://stackoverflow.com/users/2487785/beeflobill"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1576021218, "post_id": 59276786, "comment_id": 104760736, "body": "I hadn&#39;t considered doing it like that.  However, the ultimate goal is to build a table that will be written to registers that are 16 bits wide per address.  So, I was just thinking of things in terms of 16-bits."}, {"owner": {"reputation": 1320, "user_id": 5495906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b319c1b73d80f4155fbdd4fcb81525?s=128&d=identicon&r=PG&f=1", "display_name": "LegendofPedro", "link": "https://stackoverflow.com/users/5495906/legendofpedro"}, "edited": false, "score": 0, "creation_date": 1576021503, "post_id": 59276786, "comment_id": 104760798, "body": "FYI, <code>sizeof(BIG_VALUE)</code> will be &gt;= 48-bits (because of padding). Also it&#39;s technically invalid to access a different member of a union than the one which was instantiated."}, {"owner": {"reputation": 1320, "user_id": 5495906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b319c1b73d80f4155fbdd4fcb81525?s=128&d=identicon&r=PG&f=1", "display_name": "LegendofPedro", "link": "https://stackoverflow.com/users/5495906/legendofpedro"}, "edited": false, "score": 0, "creation_date": 1576021626, "post_id": 59276786, "comment_id": 104760828, "body": "I would use <code>malloc</code> (guaranteed contiguous memory) for an array of <code>uint8_t</code> and write getter/setter functions that shift and mask as appropriate. You could then use <code>memcpy</code> with a pointer to the base address."}, {"owner": {"reputation": 177, "user_id": 2487785, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d5e8d56488c80d81d782bb5c3ed7c2a6?s=128&d=identicon&r=PG", "display_name": "beeflobill", "link": "https://stackoverflow.com/users/2487785/beeflobill"}, "reply_to_user": {"reputation": 1320, "user_id": 5495906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b319c1b73d80f4155fbdd4fcb81525?s=128&d=identicon&r=PG&f=1", "display_name": "LegendofPedro", "link": "https://stackoverflow.com/users/5495906/legendofpedro"}, "edited": false, "score": 0, "creation_date": 1576022641, "post_id": 59276786, "comment_id": 104761106, "body": "@LegendofPedro  I see how the padding is problematic, but perhaps careful use of the &quot;packing&quot; pragma can make this work.  But, I&#39;m getting the sense that what I&#39;m trying to do here is wishful thinking."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 1320, "user_id": 5495906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b319c1b73d80f4155fbdd4fcb81525?s=128&d=identicon&r=PG&f=1", "display_name": "LegendofPedro", "link": "https://stackoverflow.com/users/5495906/legendofpedro"}, "edited": false, "score": 1, "creation_date": 1576026209, "post_id": 59276786, "comment_id": 104761917, "body": "@LegendofPedro It&#39;s only illegal in C++ to access unions that way.  It&#39;s fine in C.  There&#39;s a footnote somewhere in the C11 standard that clarifies this point, but I don&#39;t have it in front of me right now."}, {"owner": {"reputation": 1320, "user_id": 5495906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b319c1b73d80f4155fbdd4fcb81525?s=128&d=identicon&r=PG&f=1", "display_name": "LegendofPedro", "link": "https://stackoverflow.com/users/5495906/legendofpedro"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1576034281, "post_id": 59276786, "comment_id": 104763521, "body": "@christiangibbons that&#39;s good to know! I looked into it, it&#39;s called type-punning. <a href=\"https://stackoverflow.com/a/11996970/5495906\">stackoverflow.com/a/11996970/5495906</a> : c11 standard 6.5.2.3 Structure and union members 95"}], "owner": {"reputation": 177, "user_id": 2487785, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d5e8d56488c80d81d782bb5c3ed7c2a6?s=128&d=identicon&r=PG", "display_name": "beeflobill", "link": "https://stackoverflow.com/users/2487785/beeflobill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576020176, "creation_date": 1576020176, "question_id": 59276786, "link": "https://stackoverflow.com/questions/59276786/modeling-hardware-registers-with-out-of-order-data-fields", "title": "Modeling hardware registers with out of order data fields", "body": "<p>I have the following memory structure:</p>\n\n<pre><code>struct {\n   uint16_t MSB_VALUE : 8;\n   uint16_t : 8;\n   uint16_t LSB_VALUE;\n} BIG_VALUE;\n</code></pre>\n\n<p>This structure, all together, represents a 32-bit section of memory that is fixed by hardware.  The value of BIG_VALUE can be represented using Verilog concatenation notation thus:</p>\n\n<pre><code>BIG_VALUE = { MSB_VALUE[7:0], LSB_VALUE[15:0] } \n</code></pre>\n\n<p>I would like to be able to write a union (or something) such that I can access the value of BIG_VALUE using dot notation.  Maybe something stupid like this:</p>\n\n<pre><code>union {\n   uint32_t val;\n   struct {\n      uint16_t MSB_VALUE : 8;\n      uint16_t : 8;\n      uint16_t LSB_VALUE;\n   } sub;\n} BIG_VALUE;\n</code></pre>\n\n<p>But, the issue is that the MSB comes before the LSB in memory (with an 8-bit gap too), and so calling BIG_VALUE.val isn't going to get the hoped-for value.</p>\n\n<p>I have a vague idea of something to try, but I'm just confusing myself.  Is there a way to do this within the union/struct formalism, or should I give up now?  Giving up, I guess, means having to manually split up the 24-bit value and then to store those into the appropriate fields.  Maybe I could write a function to do that later, if it makes sense.</p>\n\n<p>Having this work means that I could store a 24-bit value using dot notation and have the data go into the appropriate locations in memory.  For example:</p>\n\n<pre><code>BIG_VALUE.val = 0x0031FFFE\nThen \nBIG_VALUE.MSB_VALUE == 0x31\nand\nBIG_VALUE.LSB_VALUE == 0xFFFE\n\nBut the memory layout would be\naddr    : 0x0031\naddr +4 : 0xFFFE\n</code></pre>\n"}, {"tags": ["c", "function", "recursion"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1576020773, "post_id": 59276719, "comment_id": 104760608, "body": "<code>return check_order(n &#47; 10); if (n == 0)</code>. That&#39;s obviously a problem. Any code after a <code>return</code> will never get executed."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1576020776, "post_id": 59276719, "comment_id": 104760609, "body": "Note that the code <code>if (n == 0) { return 1; }</code> following <code>return check_order(n &#47; 10);</code> simply isn&#39;t ever executed."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1576020868, "post_id": 59276719, "comment_id": 104760638, "body": "Suggest you run your program in a debugger and step through it line by line to see what it is doing. Start with the simplest input of <code>10</code>."}, {"owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1576021015, "post_id": 59276719, "comment_id": 104760674, "body": "Add <code>printf(&quot;n%%10=%d  n&#47;10%%10=%d\\n&quot;, n%10, n&#47;10%10);</code> as the first line of the function, immediately after the opening <code>{</code>. You might find the results interesting."}, {"owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "edited": false, "score": 0, "creation_date": 1576024725, "post_id": 59276719, "comment_id": 104761572, "body": "You have  few return&#39;s in the wrong places. And what result do you expect if n \u2264 9?"}, {"owner": {"reputation": 20860, "user_id": 2034787, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/78471a5b1bfa8b48d2056ff99a875f50?s=128&d=identicon&r=PG", "display_name": "\u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df", "link": "https://stackoverflow.com/users/2034787/%d7%92%d7%9c%d7%a2%d7%93-%d7%91%d7%a8%d7%a7%d7%9f"}, "edited": false, "score": 0, "creation_date": 1576205918, "post_id": 59276719, "comment_id": 104832482, "body": "What&#39;s the expected output for 3333?"}], "answers": [{"comments": [{"owner": {"reputation": 3971, "user_id": 2840714, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/s9vli.jpg?s=128&g=1", "display_name": "ChuckCottrill", "link": "https://stackoverflow.com/users/2840714/chuckcottrill"}, "edited": false, "score": 0, "creation_date": 1576134615, "post_id": 59276924, "comment_id": 104802077, "body": "note that my answer explained how to analyze and the problem and reach a solution... too much emphasis is often placed upon clever numeric tricks at the expense of readability."}], "tags": [], "owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "is_accepted": false, "score": 0, "last_activity_date": 1576134114, "last_edit_date": 1576134114, "creation_date": 1576021208, "answer_id": 59276924, "question_id": 59276719, "link": "https://stackoverflow.com/questions/59276719/recursive-function-in-c-to-determine-if-digits-of-an-integer-are-sorted-ascendin/59276924#59276924", "title": "Recursive function in C to determine if digits of an integer are sorted ascending, descending or neither", "body": "<p>Code after a <code>return</code> statement like this is unreachable:</p>\n\n<pre><code>return check_order(n / 10);\nif (n == 0)\n{\n    return -1;\n}\n</code></pre>\n\n<p>Beyond this, you're on the right track of checking the current digit against the next digit, but I don't see a clear base case (when <code>n &lt; 10</code>, that is, a single digit).</p>\n\n<p>Trying to check ascending and descending in one recursive function is difficult to manage. In particular, communicating state between stack frames and determining which cases are still valid at a given call suggests that the return value is overworked.</p>\n\n<p>To save having to return a struct or use an enum or magic numbers as flags, I'd write two general helper functions, <code>ascending_digits</code> and <code>descending_digits</code>. </p>\n\n<pre><code>#include &lt;stdbool.h&gt;\n#include &lt;stdio.h&gt;\n\nbool ascending_digits(int n) {\n    if (n &lt; 10) return true;\n    if (n % 10 &lt; n / 10 % 10) return false;\n    return ascending_digits(n / 10);\n}\n\nbool descending_digits(int n) {\n    if (n &lt; 10) return true;\n    if (n % 10 &gt; n / 10 % 10) return false;\n    return descending_digits(n / 10);\n}\n\nint check_order(int n) {\n    if (ascending_digits(n)) return 1;\n    if (descending_digits(n)) return -1;\n    return 0;\n}\n\nint main() {\n    printf(\"12345: %d\\n\", check_order(12345));\n    printf(\"54321: %d\\n\", check_order(54321));\n    printf(\"54323: %d\\n\", check_order(54323));\n    printf(\"454321: %d\\n\", check_order(454321));\n    printf(\"1: %d\\n\", check_order(1));\n    printf(\"12: %d\\n\", check_order(12));\n    printf(\"21: %d\\n\", check_order(21));\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>12345: 1\n54321: -1\n54323: 0\n454321: 0\n1: 1\n12: 1\n21: -1\n</code></pre>\n\n<p>Not only are these functions easier to understand and maintain individually, they're also more reusable than if they were inseparably tied together.</p>\n\n<p>This doesn't handle negative numbers--you could apply <code>abs</code> and go from there if you want. Same goes for handling equal values; this implementation accepts numbers such as <code>1223</code> but you could use <code>&lt;=</code> to enforce strict ordering.</p>\n"}, {"tags": [], "owner": {"reputation": 3971, "user_id": 2840714, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/s9vli.jpg?s=128&g=1", "display_name": "ChuckCottrill", "link": "https://stackoverflow.com/users/2840714/chuckcottrill"}, "is_accepted": false, "score": 0, "last_activity_date": 1576043718, "last_edit_date": 1576043718, "creation_date": 1576022258, "answer_id": 59277056, "question_id": 59276719, "link": "https://stackoverflow.com/questions/59276719/recursive-function-in-c-to-determine-if-digits-of-an-integer-are-sorted-ascendin/59277056#59277056", "title": "Recursive function in C to determine if digits of an integer are sorted ascending, descending or neither", "body": "<p>Explain your algorithm?</p>\n\n<p>Suppose you use the following:</p>\n\n<ul>\n<li>You are given a number.</li>\n<li>You need to turn that number into a sequence of digits.\n\n<ul>\n<li>If you are given a number, you can convert that number to a sequence of digits.</li>\n<li>If you are given a sequence of digits, use\nthat.</li>\n</ul></li>\n<li>Compare each pair of digits -> ascending, descending, or neither.</li>\n<li>Combine the results from each pair, sequentially/recursively.</li>\n</ul>\n\n<p>We can use a string to make the digit comparisons easier, and accept very long sequences of digits.</p>\n\n<p>We can use an enum(erated) type to represent the ordering.</p>\n\n<p>How do you combine the results? Define a function that combines the order of two adjacent, overlapping pairs, then you can combine results.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\ntypedef enum { descending=-1, other=0, ascending=1 } order_t;\n\norder_t pair_order(int a, int b) {\n    if( a &lt; b ) return ascending;\n    if( a &gt; b ) return descending;\n    return other;\n}\n\n//strict (increasing/decreasing)\norder_t strict_order( order_t x, order_t y ) {\n    if( x == y ) return x;\n    return other;\n}\n\n//monotone (increasing/decreasing)\norder_t monotone_order( order_t x, order_t y ) {\n    if( x == y ) return x;\n    if( other == x ) return y;\n    if( other == y ) return x;\n    return other;\n}\n\norder_t check_order( char* p, int remain ) {\n    //printf(\"p:%s\\n\",p); //uncomment to watch progress\n    if( remain&lt;2 ) return other;\n    if( remain==2 ) return pair_order(p[0], p[1]);\n    return strict_order( pair_order(p[0], p[1]), check_order(p+1, remain-1) );\n    //return monotone_order( pair_order(p[0], p[1]), check_order(p+1, remain-1) );\n}\n\nchar* order_name[] = {\n    \"descending\",\n    \"other\",\n    \"ascending\"\n    \"\"\n};\n\nint main()\n{\n    char line[666] = \"none\";\n    while ( strlen(line) &gt; 0 ) {\n    printf(\"enter a number (at least 2 digits):\");\n    fgets(stdin,line,sizeof(line)-1);\n    if( strlen(line) &gt; 0 &amp;&amp; line[strlen(line)-1] == '\\n' )\n        line[strlen(line)-1] = '\\0';\n    order_t order = check_order(line);\n    printf(\"function returned: (%d)%s\\n\", order, order_name[order+1]);\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1576084434, "post_id": 59279837, "comment_id": 104786574, "body": "I think it&#39;s a bit silly to worry about multiple passes--integers can never have more than 10 digits, so it&#39;s well worth the extremely minor performance hit to greatly improve function readability. Even if the numbers were huge, it&#39;s theoretically all linear time complexity. Performance isn&#39;t a good reason for playing into OP&#39;s questionable design of trying to pack everything into one function."}, {"owner": {"reputation": 3971, "user_id": 2840714, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/s9vli.jpg?s=128&g=1", "display_name": "ChuckCottrill", "link": "https://stackoverflow.com/users/2840714/chuckcottrill"}, "edited": false, "score": 0, "creation_date": 1576134800, "post_id": 59279837, "comment_id": 104802133, "body": "Note that OP posted an X-Y problem - it is often the case that new programmers assume type when told to handle &#39;numbers&#39;... challenge assumptions."}], "tags": [], "owner": {"reputation": 32921, "user_id": 5771269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be6a5b618f5bd197150a6186318beba7?s=128&d=identicon&r=PG&f=1", "display_name": "cdlane", "link": "https://stackoverflow.com/users/5771269/cdlane"}, "is_accepted": false, "score": 0, "last_activity_date": 1576045044, "creation_date": 1576045044, "answer_id": 59279837, "question_id": 59276719, "link": "https://stackoverflow.com/questions/59276719/recursive-function-in-c-to-determine-if-digits-of-an-integer-are-sorted-ascendin/59279837#59279837", "title": "Recursive function in C to determine if digits of an integer are sorted ascending, descending or neither", "body": "<p>I think you were started on the right track but need to flesh out your code more.  My solution borrows on that of @ChuckCottrill as I like his <code>enum</code> but I don't like that he doesn't play the ball as it lays (i.e. converts to a string instead of dealing with the <code>int</code>.)  I also borrow the nice test examples of @ggorlen but I don't like that solution either as it can take multiple passes through the number to figure out the answer when only one pass should be needed:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef enum { descending=-1, other=0, ascending=1 } order_t; // a la @ChuckCottrill\n\norder_t check_order(int n)\n{\n    if (n &gt; 9) {\n        int right = n % 10;\n        int left = n / 10 % 10;\n\n        if (right &gt; left) {\n            n /= 10;\n\n            if (n &gt; 9) {\n                return (ascending == check_order(n)) ? ascending : other;\n            }\n\n            return ascending;\n        }\n\n        if (right &lt; left) {\n            n /= 10;\n\n            if (n &gt; 9) {\n                return (descending == check_order(n)) ? descending : other;\n            }\n\n            return descending;\n        }\n    }\n\n    return other;\n}\n\nint main() { // a la @ggorlen\n    printf(\"12345: %d\\n\", check_order(12345));\n    printf(\"54321: %d\\n\", check_order(54321));\n    printf(\"54323: %d\\n\", check_order(54323));\n    printf(\"454321: %d\\n\", check_order(454321));\n    printf(\"1: %d\\n\", check_order(1));\n    printf(\"12: %d\\n\", check_order(12));\n    printf(\"21: %d\\n\", check_order(21));\n}\n</code></pre>\n\n<p><strong>OUTPUT</strong></p>\n\n<pre><code>&gt; ./a.out\n12345: 1\n54321: -1\n54323: 0\n454321: 0\n1: 0\n12: 1\n21: -1\n&gt; \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "is_accepted": false, "score": 0, "last_activity_date": 1576051584, "creation_date": 1576051584, "answer_id": 59281262, "question_id": 59276719, "link": "https://stackoverflow.com/questions/59276719/recursive-function-in-c-to-determine-if-digits-of-an-integer-are-sorted-ascendin/59281262#59281262", "title": "Recursive function in C to determine if digits of an integer are sorted ascending, descending or neither", "body": "<p>A version that works for any length since it takes the string as parameter.\nAnd feeding the recursive function with previous status (ascending or descending) allows for some shorter code and less functions.</p>\n\n<pre><code>int check_order(char *str, int index, int previous) {\n     char current = str[index];       // char at index\n     char next = str[index+1];        // char at index+1\n     if (current == 0 || next == 0) {\n          return previous;            // End of string\n     }\n     // Ascending or descending?\n     int status = next &gt; current ? 1 : (next &lt; current ? -1 : 0); \n     if (status == 0 || index &gt; 0 &amp;&amp; status != previous) {\n          // If neither -1/1 nor status == previous (while not initial call)\n          return 0;\n     }\n     return check_order(str, index+1, status); // Check from next index\n}\n</code></pre>\n\n<p>The <em>main</em> function must ensure the string is at least 2 chars</p>\n\n<pre><code>int main(int argc, char **argv) {\n     char *str = *++argv;\n     // Some optional checks on str here... (like this is a number)\n     int status = 0; // Default value if string length &lt; 2\n     if (strlen(str) &gt;= 2) {\n        status = check_order(str, 0, 0);\n     }\n     printf(\"Check order for %s is %d\\n\", str, status);\n     return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20860, "user_id": 2034787, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/78471a5b1bfa8b48d2056ff99a875f50?s=128&d=identicon&r=PG", "display_name": "\u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df", "link": "https://stackoverflow.com/users/2034787/%d7%92%d7%9c%d7%a2%d7%93-%d7%91%d7%a8%d7%a7%d7%9f"}, "is_accepted": false, "score": 1, "last_activity_date": 1576207276, "last_edit_date": 1576207276, "creation_date": 1576206409, "answer_id": 59315602, "question_id": 59276719, "link": "https://stackoverflow.com/questions/59276719/recursive-function-in-c-to-determine-if-digits-of-an-integer-are-sorted-ascendin/59315602#59315602", "title": "Recursive function in C to determine if digits of an integer are sorted ascending, descending or neither", "body": "<p>Here's a simple recursion:</p>\n\n<pre><code>int f(int n){\n  if (n &lt; 10)\n    return 0;\n\n  int dr = n % 10; // rightmost digit\n  n = n / 10;\n  int dl = n % 10; // second digit from the right \n  int curr = dl &lt; dr ? 1 : -1; // current comparison \n  if (dl == dr) curr = 0; // keep strict order\n\n  if (n &lt; 10)\n    return curr;\n\n  return curr == f(n) ? curr : 0; // are the comparisons consistent?\n}\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 12514651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wJ8vT.jpg?s=128&g=1", "display_name": "Tiran", "link": "https://stackoverflow.com/users/12514651/tiran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1165, "favorite_count": 1, "answer_count": 5, "score": 3, "last_activity_date": 1576207276, "creation_date": 1576019775, "last_edit_date": 1576022668, "question_id": 59276719, "link": "https://stackoverflow.com/questions/59276719/recursive-function-in-c-to-determine-if-digits-of-an-integer-are-sorted-ascendin", "title": "Recursive function in C to determine if digits of an integer are sorted ascending, descending or neither", "body": "<p>I need to write a recursive function that returns 1 if digits of a whole number are ascending (left to right), return -1 if descending or return 0 if neither.</p>\n\n<p>My solution attempt returns 0 every time and I know why but I don't know how to get around it.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint check_order(int n)\n{\n    if (n % 10 &gt; n / 10 % 10)\n    {\n        return check_order(n / 10);\n        if (n == 0)\n        {           \n            return 1;\n        }\n    }\n    else if (n % 10 &lt; n / 10 % 10)\n    {\n        return check_order(n / 10);\n        if (n == 0)\n        {\n            return -1;\n        }\n    }\n    else\n    {\n        return 0;\n    }\n}\n\nint main()\n{\n    int n;\n    printf(\"enter a whole number (n &gt; 9):\");\n    scanf_s(\"%d\", &amp;n);\n    printf(\"function returned: %d\\n\", check_order(n));\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "memory", "memory-management", "heap-memory"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 6, "creation_date": 1576020542, "post_id": 59276714, "comment_id": 104760541, "body": "The difference in memory management between C and C++ is that C++ pretends to have some. :-)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1576025667, "post_id": 59276714, "comment_id": 104761794, "body": "in C++ <code>std::vector&lt;const char *&gt; v(N);</code> . Although it would be bad style to use <code>const char *</code> in the first place"}, {"owner": {"reputation": 5790, "user_id": 3258851, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fUPld.jpg?s=128&g=1", "display_name": "Marc.2377", "link": "https://stackoverflow.com/users/3258851/marc-2377"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1576026016, "post_id": 59276714, "comment_id": 104761870, "body": "As evidence of what @M.M just said, consider <a href=\"https://gitlab.freedesktop.org/pulseaudio/pulseaudio/issues/773\" rel=\"nofollow noreferrer\">this issued I opened</a> for <a href=\"https://www.freedesktop.org/wiki/Software/PulseAudio/\" rel=\"nofollow noreferrer\">pulseaudio</a> just a couple of days ago (the fix is <a href=\"https://gitlab.freedesktop.org/pulseaudio/pulseaudio/merge_requests/216/diffs?commit_id=b94dba9dafe41caf374e55fba2af242a41f97e5b\" rel=\"nofollow noreferrer\">here</a>)."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1576020466, "post_id": 59276801, "comment_id": 104760525, "body": "C is also devoid of conveniences like <code>std::vector</code> and <code>std::map</code> which can do a lot of memory management for you."}, {"owner": {"reputation": 544, "user_id": 11073848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e8744d4dd30d03927f67c96c823feb1?s=128&d=identicon&r=PG&f=1", "display_name": "Drake Johnson", "link": "https://stackoverflow.com/users/11073848/drake-johnson"}, "edited": false, "score": 0, "creation_date": 1576020954, "post_id": 59276801, "comment_id": 104760659, "body": "Thank you very much for your answer; it&#39;s written well and straightforward. Is there any way you could also include the deallocation process?"}, {"owner": {"reputation": 4915, "user_id": 10686048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bffd06d00a80b9b69e83f561ee5a392?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisMM", "link": "https://stackoverflow.com/users/10686048/chrismm"}, "reply_to_user": {"reputation": 544, "user_id": 11073848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e8744d4dd30d03927f67c96c823feb1?s=128&d=identicon&r=PG&f=1", "display_name": "Drake Johnson", "link": "https://stackoverflow.com/users/11073848/drake-johnson"}, "edited": false, "score": 1, "creation_date": 1576021301, "post_id": 59276801, "comment_id": 104760751, "body": "@DrakeJohnson added."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1576025725, "post_id": 59276801, "comment_id": 104761808, "body": "Howcome you check the result of the first malloc but not the later ones?"}, {"owner": {"reputation": 4915, "user_id": 10686048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bffd06d00a80b9b69e83f561ee5a392?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisMM", "link": "https://stackoverflow.com/users/10686048/chrismm"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1576028165, "post_id": 59276801, "comment_id": 104762353, "body": "@M.M., no particular reason. Was just an example."}], "tags": [], "owner": {"reputation": 4915, "user_id": 10686048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bffd06d00a80b9b69e83f561ee5a392?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisMM", "link": "https://stackoverflow.com/users/10686048/chrismm"}, "is_accepted": true, "score": 3, "last_activity_date": 1576021292, "last_edit_date": 1576021292, "creation_date": 1576020287, "answer_id": 59276801, "question_id": 59276714, "link": "https://stackoverflow.com/questions/59276714/what-are-the-differences-between-memory-management-in-c-and-c/59276801#59276801", "title": "What are the differences between memory management in C and C++", "body": "<p>To allocate the array, you would do something like this:</p>\n\n<pre><code>const char **array = malloc( x * sizeof( char * ) );\n</code></pre>\n\n<p>Then allocate each element of the array. </p>\n\n<pre><code>if ( array )\n    for ( int i = 0; i &lt; x; ++i )\n        array[i] = malloc( y * sizeof( char ) );\nelse\n    printf( \"malloc failed :(\" );\n</code></pre>\n\n<p><code>malloc</code> returns a <code>void*</code> but it's compatible with other pointer types. </p>\n\n<p>In both C and C++ you need to manage the memory yourself, but C does not have things like <code>unique_ptr</code> -- also, no <code>new</code> and <code>delete</code>, use <code>malloc</code> and <code>free</code>. There's also <code>calloc</code> and <code>realloc</code>.</p>\n\n<p><code>malloc</code> can return <code>NULL</code> in the case when it fails, so you <em>should</em> check for that too. Note that it doesn't throw like <code>new</code> can in C++. More information on <code>malloc</code> can be found <a href=\"https://en.cppreference.com/w/c/memory/malloc\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>As requested, when freeing up the array, you basically just do the same thing in reverse. Noting that <a href=\"https://en.cppreference.com/w/c/memory/free\" rel=\"nofollow noreferrer\"><code>free</code></a> does not take in a size, just the pointer. The <code>free</code> function will ignore <code>NULL</code> pointers, so you don't have to worry about that here. </p>\n\n<pre><code>for ( int i = 0; i &lt; x; ++i )\n   free( array[i] );\nfree( array );\n</code></pre>\n\n<p>Of course, as in C++, don't double <code>free</code> memory. That is bad. :)</p>\n"}, {"comments": [{"owner": {"reputation": 5790, "user_id": 3258851, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fUPld.jpg?s=128&g=1", "display_name": "Marc.2377", "link": "https://stackoverflow.com/users/3258851/marc-2377"}, "edited": false, "score": 0, "creation_date": 1576026247, "post_id": 59277033, "comment_id": 104761928, "body": "For those unfamiliar with the concept, this is what&#39;s referred to as <a href=\"https://en.cppreference.com/w/cpp/language/raii\" rel=\"nofollow noreferrer\">RAII</a> (I know, the name doesn&#39;t help)."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1576051419, "post_id": 59277033, "comment_id": 104768601, "body": "&quot;it is good practice to run dynamic memory de allocation in the destructor&quot; And not only there. &quot;Rule of three&quot;."}], "tags": [], "owner": {"reputation": 138, "user_id": 2806717, "user_type": "registered", "profile_image": "https://graph.facebook.com/1166888526/picture?type=large", "display_name": "Ademi", "link": "https://stackoverflow.com/users/2806717/ademi"}, "is_accepted": false, "score": 1, "last_activity_date": 1576025449, "last_edit_date": 1576025449, "creation_date": 1576022049, "answer_id": 59277033, "question_id": 59276714, "link": "https://stackoverflow.com/questions/59276714/what-are-the-differences-between-memory-management-in-c-and-c/59277033#59277033", "title": "What are the differences between memory management in C and C++", "body": "<p>Another Memory management aspect that is present in C++ but not in C, is that C++ have object oriented approach to classes . When an instance gets created the constructor of that instance is called, when that instance goes out of scope the destructor is called, this behavior is automated by the compiler, and is transparent to the programmer.</p>\n\n<p>Therefore, it is good practice to run dynamic memory de allocation in the destructor, to ensure that any dynamic memory allocated by the instance is freed when the instance is no longer in scope.</p>\n\n<p>Constructor and desctructor concept only present in C++ and not in C.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 3, "last_activity_date": 1576051079, "creation_date": 1576051079, "answer_id": 59281149, "question_id": 59276714, "link": "https://stackoverflow.com/questions/59276714/what-are-the-differences-between-memory-management-in-c-and-c/59281149#59281149", "title": "What are the differences between memory management in C and C++", "body": "<p>The main difference between <code>malloc</code> and <code>new</code> is that <code>new</code> will call the default constructor for the allocated object, if applicable. This is one reason why mixing these two in C++ is very bad practice.</p>\n\n<p><code>malloc</code> requires you to check the return value for NULL to check if it fails, whereas <code>new</code> will throw a <code>std::bad_alloc</code> exception out in the wild when it fails.</p>\n\n<p>Another big difference is that C++ has the memory leak operator <code>new[]</code>, which allocates an array that will leak when one yet again accidentally uses <code>delete</code> rather than <code>delete[]</code>.</p>\n\n<p>C++ also allows you to overload these operators - valid cases of when you need to do this exist, but mostly it is wildly questionable practice. </p>\n\n<p>Manual memory allocation in C++ is mostly frowned upon, for good reasons. You'd rather use <code>std::string</code> in this case and let that class worry about memory allocation. Alterntatively you could use a smart pointer class to do the deallocation for you.</p>\n"}], "owner": {"reputation": 544, "user_id": 11073848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e8744d4dd30d03927f67c96c823feb1?s=128&d=identicon&r=PG&f=1", "display_name": "Drake Johnson", "link": "https://stackoverflow.com/users/11073848/drake-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "accepted_answer_id": 59276801, "answer_count": 3, "score": 1, "last_activity_date": 1576051079, "creation_date": 1576019741, "last_edit_date": 1576026122, "question_id": 59276714, "link": "https://stackoverflow.com/questions/59276714/what-are-the-differences-between-memory-management-in-c-and-c", "title": "What are the differences between memory management in C and C++", "body": "<p>How does one dynamically allocate memory for an array of <code>const char*</code>s? That is, for example, <code>const char** array = /* ??? */</code>. I know <code>malloc</code> is similar to <code>new</code> in C++, but always returns a <code>void*</code>. </p>\n\n<p>More broadly, what are the differences between how memory management is handled in C vs C++? For example, what things do I have to watch out for in C that someone may not think about in C++?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 0, "creation_date": 1576019883, "post_id": 59276687, "comment_id": 104760361, "body": "are you looking for <code>sprintf</code>?"}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1576022509, "post_id": 59276687, "comment_id": 104761085, "body": "<code>array</code> has only 10 chars, so the best you could put in it is &quot;Bravo vou&quot;, You either need need a 2D array, or you need to make <code>array</code> large enough to hold the entire content."}], "answers": [{"tags": [], "owner": {"reputation": 748, "user_id": 5381184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da66272a60130c5f545312f67e16d9a3?s=128&d=identicon&r=PG&f=1", "display_name": "BobRun", "link": "https://stackoverflow.com/users/5381184/bobrun"}, "is_accepted": true, "score": 0, "last_activity_date": 1576020093, "creation_date": 1576020093, "answer_id": 59276775, "question_id": 59276687, "link": "https://stackoverflow.com/questions/59276687/how-to-assign-a-string-containing-multiple-variable-to-char-array/59276775#59276775", "title": "how to assign a string containing multiple variable to char array?", "body": "<p>You want to use sprintf(array, \"Bravo vous avez gagne le yoyo et %d points\", valeur);\nYou can add any variables like in printf.\nsprintf(array, \"Bravo vous avez gagne %d points et le score est %d\", valeur, score);</p>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 0, "last_activity_date": 1576020131, "creation_date": 1576020131, "answer_id": 59276779, "question_id": 59276687, "link": "https://stackoverflow.com/questions/59276687/how-to-assign-a-string-containing-multiple-variable-to-char-array/59276779#59276779", "title": "how to assign a string containing multiple variable to char array?", "body": "<p>You can use <code>sprintf</code> to write formatted output to a string (or better <code>snprintf</code> to avoid buffer overflows):</p>\n\n<pre><code>int main() {\n    int valeur=5;\n    int score=10;\n    char array[100];\n    snprintf(array, sizeof(array), \"Bravo vous avez gagn\u00e9 %d points (total: %d)\",valeur,score);\n    printf(\"%s\\n\",array);\n\n    //output :\n    //Bravo vous avez gagn\u00e9 5 points (total: 10)\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11125753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406edce5e5771e1686d6644987bc6fcb?s=128&d=identicon&r=PG&f=1", "display_name": "William Kh", "link": "https://stackoverflow.com/users/11125753/william-kh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 59276775, "answer_count": 2, "score": 0, "last_activity_date": 1576024266, "creation_date": 1576019594, "last_edit_date": 1592644375, "question_id": 59276687, "link": "https://stackoverflow.com/questions/59276687/how-to-assign-a-string-containing-multiple-variable-to-char-array", "title": "how to assign a string containing multiple variable to char array?", "body": "<p>Is it possible to assign a string wirth multiple variable to a char array ?</p>\n<h2>For example :</h2>\n<pre><code>char array[100];\nint valeur=5;\nint score=10;\narray=(&quot;Bravo vous avez gagn\u00e9 %d points (total: %d)&quot;,valeur,score);\nprintf(&quot;%s\\n&quot;,array);\n</code></pre>\n<ul>\n<li>output :\n<strong>Bravo vous avez gagn\u00e9 5 points (total: 10)</strong></li>\n</ul>\n"}, {"tags": ["c", "if-statement", "integer"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576018855, "post_id": 59276574, "comment_id": 104760097, "body": "because any non-zero is <code>true</code>"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1576018984, "post_id": 59276574, "comment_id": 104760123, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/17348622/how-and-works\">How || and &amp;&amp; works</a>"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1576019018, "post_id": 59276574, "comment_id": 104760132, "body": "Relevant: the spec links in kennytm\u2019s answer to <a href=\"https://stackoverflow.com/questions/37291681/does-the-c-standard-explicitly-indicate-truth-value-as-0-or-1\" title=\"does the c standard explicitly indicate truth value as 0 or 1\">stackoverflow.com/questions/37291681/&hellip;</a>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1576019142, "post_id": 59276574, "comment_id": 104760162, "body": "<code>||</code> will give <code>0</code> if both operands equal <code>0</code>  ; otherwise will give <code>1</code>."}], "answers": [{"comments": [{"owner": {"reputation": 351, "user_id": 4604759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de599df6671db42349c8b438ec7a350?s=128&d=identicon&r=PG&f=1", "display_name": "MiCo", "link": "https://stackoverflow.com/users/4604759/mico"}, "edited": false, "score": 0, "creation_date": 1576019184, "post_id": 59276608, "comment_id": 104760178, "body": "Since there is actually no true value in C, I would better say that every value !=0 evaluates to 1."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 351, "user_id": 4604759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de599df6671db42349c8b438ec7a350?s=128&d=identicon&r=PG&f=1", "display_name": "MiCo", "link": "https://stackoverflow.com/users/4604759/mico"}, "edited": false, "score": 0, "creation_date": 1576019296, "post_id": 59276608, "comment_id": 104760202, "body": "@MiCo Well that is not true either. <code>3</code> for example doesn&#39;t evaluate to <code>1</code> . (nor does it evaluate to <code>true</code>), it evaluates to <code>3</code>"}, {"owner": {"reputation": 351, "user_id": 4604759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de599df6671db42349c8b438ec7a350?s=128&d=identicon&r=PG&f=1", "display_name": "MiCo", "link": "https://stackoverflow.com/users/4604759/mico"}, "edited": false, "score": 0, "creation_date": 1576019793, "post_id": 59276608, "comment_id": 104760338, "body": "OK, you are right. To be more precise I meant it like this: every expression (value!=0) evaluates to 1, if value is not zero, for example (3 != 0) evaluates to 1."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 351, "user_id": 4604759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de599df6671db42349c8b438ec7a350?s=128&d=identicon&r=PG&f=1", "display_name": "MiCo", "link": "https://stackoverflow.com/users/4604759/mico"}, "edited": false, "score": 0, "creation_date": 1576034586, "post_id": 59276608, "comment_id": 104763581, "body": "@MiCo C has had <code>_Bool</code> for 20 years.  Yes C has a <i>true</i> value."}], "tags": [], "owner": {"reputation": 6651, "user_id": 996815, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2058dcdbff2ea9ea04aa1b42217a1fce?s=128&d=identicon&r=PG&f=1", "display_name": "Vertexwahn", "link": "https://stackoverflow.com/users/996815/vertexwahn"}, "is_accepted": true, "score": 2, "last_activity_date": 1576020189, "last_edit_date": 1576020189, "creation_date": 1576018908, "answer_id": 59276608, "question_id": 59276574, "link": "https://stackoverflow.com/questions/59276574/c-programming-why-does-0-1-1/59276608#59276608", "title": "C Programming: Why does (0 || -1) == 1?", "body": "<p>Every expression <code>value != 0</code> evaluates to <code>1</code>, if <code>value</code> is not equal to zero. (see comment from @MiCo and @M.M.)</p>\n\n<p><code>||</code> is an or operation with two operands. If the left or the right operand is not zero the or operation evaluates to <code>1</code>.</p>\n\n<p>Since <code>-1</code> is not <code>0</code> it evaluates to <code>1</code>,</p>\n"}], "owner": {"reputation": 293, "user_id": 7789984, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c2b503d5090fd4a4e10b5d588898981?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Lee", "link": "https://stackoverflow.com/users/7789984/adam-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "closed_date": 1576019061, "accepted_answer_id": 59276608, "answer_count": 1, "score": 1, "last_activity_date": 1576020189, "creation_date": 1576018686, "question_id": 59276574, "link": "https://stackoverflow.com/questions/59276574/c-programming-why-does-0-1-1", "closed_reason": "Duplicate", "title": "C Programming: Why does (0 || -1) == 1?", "body": "<p>I am having trouble understanding why the following code:</p>\n\n<pre><code>0 || -1\n</code></pre>\n\n<p>Evaluates to <code>1</code>? More specifically, I am confused as to what the || and &amp;&amp; operators mean when applied to integers.</p>\n"}, {"tags": ["c++", "c", "tensorflow", "gnu-make"], "comments": [{"owner": {"reputation": 2385, "user_id": 2592309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37821a72a13ebec51830ca9aeb57dcf7?s=128&d=identicon&r=PG", "display_name": "raspy", "link": "https://stackoverflow.com/users/2592309/raspy"}, "edited": false, "score": 0, "creation_date": 1576146323, "post_id": 59276548, "comment_id": 104807631, "body": "Are you able to find in which files are <code>AttsCccEnabled</code> and <code>AttsHandleValueNtf</code> defined?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5952476, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001519603661/picture?type=large", "display_name": "Majd Shahin", "link": "https://stackoverflow.com/users/5952476/majd-shahin"}, "is_accepted": false, "score": 0, "last_activity_date": 1592831028, "creation_date": 1592831028, "answer_id": 62515122, "question_id": 59276548, "link": "https://stackoverflow.com/questions/59276548/building-tensorflow-lite-micro-with-c-code/62515122#62515122", "title": "Building Tensorflow lite micro with C code", "body": "<p>i am using TFlite to make a project using AmbiqSDK too ,i will explain to you how i made the interface :\nbut first you have to know that TF is written in C++ , it is better to compile it so .</p>\n<p>for example in PDM .h/.c</p>\n<pre><code>PDM_mein.c -&gt; write your code exactly in C\n\n        void pdm_data_get(void)\n{\n    am_hal_pdm_transfer_t sTransfer;\n    sTransfer.ui32TargetAddr = (uint32_t )  g_ui32PDMDataBuffer;\n    \n    sTransfer.ui32TotalCount = PDM_FFT_BYTES;\n    am_hal_pdm_enable(PDMHandle);\n    am_hal_sysctrl_sleep(AM_HAL_SYSCTRL_SLEEP_DEEP);\n    am_hal_pdm_fifo_flush(PDMHandle);\n    am_hal_pdm_dma_start(PDMHandle, &amp;sTransfer);\n}\n////////////////////////////////////\nPDM_mein.h\n\n#ifdef __cplusplus\nextern &quot;C&quot;\n{\n#endif\n\nvoid pdm_data_get(void);\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n<p>when you write like this , you can use C function in C++ program\nand dont forget to add .c and .h files in Makefile.inc</p>\n"}], "owner": {"reputation": 2575, "user_id": 2212461, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/654e61b024c8523447cce77c382de3ec?s=128&d=identicon&r=PG&f=1", "display_name": "user2212461", "link": "https://stackoverflow.com/users/2212461/user2212461"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 283, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592831028, "creation_date": 1576018534, "question_id": 59276548, "link": "https://stackoverflow.com/questions/59276548/building-tensorflow-lite-micro-with-c-code", "title": "Building Tensorflow lite micro with C code", "body": "<p>I want to use some C code in my tensorflow lite project, but all the example projects provided in the tensorflow lite repository are C++ examples.</p>\n\n<p>In particular, I am using the AmbiqSDK repository, which provides examples for the apollo3 platform, and all the examples are in C, which I want to merge now with one of the tensorflow lite examples.</p>\n\n<p>The relevant makefile parts are here:</p>\n\n<pre><code>MICRO_SPEECH_SRCS := \\\ntensorflow/lite/experimental/micro/examples/micro_speech/main.cc \\\n...\ntensorflow/lite/experimental/micro/examples/micro_speech/command_responder.cc \\\nnew_c_file_here.c \\ ----&gt;&gt; HERE I LINK MY ADDITIONAL C CODE\n$(MICRO_FEATURES_GENERATOR_SRCS)\n...\n# Builds a standalone speech command recognizer binary.\n$(eval $(call microlite_test,micro_speech,\\\n$(MICRO_SPEECH_SRCS),$(MICRO_SPEECH_HDRS)))\n...\n# For normal manually-created TensorFlow C++ source files.\n$(OBJDIR)%.o: %.cc third_party_downloads\n    @mkdir -p $(dir $@)\n    $(CXX) $(CXXFLAGS) $(INCLUDES) -c $&lt; -o $@\n...\n# For normal manually-created TensorFlow C source files.\n$(OBJDIR)%.o: %.c third_party_downloads\n    @mkdir -p $(dir $@)\n    $(CC) $(CCFLAGS) $(INCLUDES) -c $&lt; -o $@\n</code></pre>\n\n<p>and in my new_c_file_here.c file, I've wrapped everything in extern \"C\"{}.</p>\n\n<p>But I am still getting linker errors that I don't get when compiling the C++ tensorflow lite example project or the C apollo3 example project with their respective compiler: </p>\n\n<blockquote>\n  <p>....</p>\n  \n  <p>tensorflow/lite/experimental/micro/tools/make/gen/sparkfun_edge_cortex-m4/obj//Users/macuser/Desktop/tf115/tensorflow/lite/experimental/micro/tools/make/downloads/AmbiqSuite-Rel2.0.0/third_party/exactle/sw/hci/ambiq/apollo3/hci_drv_apollo3.o:\n  In function <code>HciDrvHandler':\n  /Users/macuser/Desktop/tf115/tensorflow/lite/experimental/micro/tools/make/downloads/AmbiqSuite-Rel2.0.0/third_party/exactle/sw/hci/ambiq/apollo3/hci_drv_apollo3.c:1099: undefined reference to</code>DmDevReset'\n  tensorflow/lite/experimental/micro/tools/make/gen/sparkfun_edge_cortex-m4/obj//Users/macuser/Desktop/tf115/tensorflow/lite/experimental/micro/tools/make/downloads/AmbiqSuite-Rel2.0.0/third_party/exactle/sw/profiles/hrps/hrps_main.o:\n  In function <code>hrpsFindNextToSend':\n  /Users/macuser/Desktop/tf115/tensorflow/lite/experimental/micro/tools/make/downloads/AmbiqSuite-Rel2.0.0/third_party/exactle/sw/profiles/hrps/hrps_main.c:125:\n  undefined reference to</code>AttsCccEnabled'\n  tensorflow/lite/experimental/micro/tools/make/gen/sparkfun_edge_cortex-m4/obj//Users/macuser/Desktop/tf115/tensorflow/lite/experimental/micro/tools/make/downloads/AmbiqSuite-Rel2.0.0/third_party/exactle/sw/profiles/hrps/hrps_main.o:\n  In function <code>hrpsSendHrmNtf':\n  /Users/macuser/Desktop/tf115/tensorflow/lite/experimental/micro/tools/make/downloads/AmbiqSuite-Rel2.0.0/third_party/exactle/sw/profiles/hrps/hrps_main.c:204:\n  undefined reference to</code>AttsHandleValueNtf' </p>\n  \n  <p>....</p>\n</blockquote>\n\n<p>How can I compile the C code in my tensorflow lite C++ project correctly?</p>\n\n<p>I am using Tensorflow 1.15.0.</p>\n"}, {"tags": ["c", "arrays", "string", "linked-list", "malloc"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1576018487, "post_id": 59276505, "comment_id": 104759999, "body": "Where did you see your segfault? I assume you were running in a debug environment...  (Mark it in your post next to the line where you think it occurred.)"}, {"owner": {"reputation": 1340, "user_id": 7218062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e0d5a2d3c49c93f1aafd67adaaca59?s=128&d=identicon&r=PG&f=1", "display_name": "jmq", "link": "https://stackoverflow.com/users/7218062/jmq"}, "edited": false, "score": 0, "creation_date": 1576018773, "post_id": 59276505, "comment_id": 104760079, "body": "You should probably move the malloc outside the while loop.  It doesn&#39;t make sense to allocate and free the same buffer over and over."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1576026104, "post_id": 59276505, "comment_id": 104761886, "body": "<code>new_node-&gt;name = (char*)malloc(100*sizeof(char));</code> better as <code>new_node-&gt;name = malloc (strlen (n_m) + 1);</code> <code>n_m[++i] = &#39;\\0&#39;;</code> should be <code>n_m[i] = &#39;\\0&#39;;</code>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1576027892, "post_id": 59276505, "comment_id": 104762293, "body": "<code>character</code> should be type <code>int</code> not <code>char</code>."}], "answers": [{"tags": [], "owner": {"reputation": 4286, "user_id": 1440105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QxCty.jpg?s=128&g=1", "display_name": "Dweeberly", "link": "https://stackoverflow.com/users/1440105/dweeberly"}, "is_accepted": false, "score": 0, "last_activity_date": 1576024867, "creation_date": 1576024867, "answer_id": 59277362, "question_id": 59276505, "link": "https://stackoverflow.com/questions/59276505/adding-strings-to-a-linked-list-result-in-seg-fault/59277362#59277362", "title": "Adding strings to a linked list result in seg fault", "body": "<p>You need to guard against reading beyond the end of file and against going beyond the memory you've allocated.  It may also be possible that your file had a \"long line\" right at 100 characters by both postfixing and prefixing <code>i</code> you went passed your end of buffer.</p>\n\n<pre><code>  while ((character = fgetc(fp)) != EOF) {\n      char *n_m;\n      n_m = (char*)malloc(100 * sizeof(char));\n      if(n_m == NULL)\n          printf(\"Fehler bei Speicher reservierung...\");\n      int i = 0;\n      while ((character != ' ') \n         &amp;&amp;  (character != EOF)\n         &amp;&amp;  (i &lt; 100)) {\n          n_m[i++] = character;\n          character = fgetc(fp);\n          }\n      // don't postfix add about then prefix add below\n      if (i &gt;= 100) {\n         \u2026 there is a problem \u2026\n          }   \n      n_m[i] = '\\0';   // NULL-terminate\n      head = add(head, n_m);\n      free(n_m);\n      }\n</code></pre>\n\n<p>You might consider something more like this</p>\n\n<pre><code>  #define BUFF_SIZE 100  \n  char buff[BUFF_SIZE];\n  buff[0] = '\\0';\n  int i = 0;\n  while (((character = fgetc(fp)) != EOF) \n     &amp;&amp;  (i &lt; BUFF_SIZE)) {\n      buff[i++] = character;\n      character = fgetc(fp);\n      if (character = ' ') {\n          buff[i] = '\\0';   // NULL-terminate\n          head = add(head, buff);   \n          i = 0;\n          buff[0] = '\\0';\n          }\n      }\n   if (i &gt;= BUFF_SIZE) { \u2026 there is a problem \u2026 }\n</code></pre>\n\n<p>This does a couple of useful things.  One is your buffer is statically allocated and it's size is controlled by a single #define.  Second, it reduces the number of loops involved which can improve readability. </p>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 0, "last_activity_date": 1576033593, "creation_date": 1576033593, "answer_id": 59278348, "question_id": 59276505, "link": "https://stackoverflow.com/questions/59276505/adding-strings-to-a-linked-list-result-in-seg-fault/59278348#59278348", "title": "Adding strings to a linked list result in seg fault", "body": "<p>Your biggest issue is your read of characters does not trap <code>EOF</code> and will continue reading after <code>EOF</code> is encountered, causing <code>i</code> to exceed your array bounds invoking <em>Undefined Behavior</em> leading to your SegFault. The code in question is:</p>\n\n<pre><code>  while (character != ' ') {\n     n_m[i++] = character;\n     character = fgetc(fp);\n  }\n</code></pre>\n\n<p>Since POSIX files do not end with a <code>' '</code> (space), but instead a <code>'\\n'</code>, your read of the last word in the file does not stop at <code>EOF</code>. You further have problems with multiple spaces together repeatedly writing nodes containing the <em>empty-string</em> to your list. </p>\n\n<p>You also fail to handle any other whitespace other than <code>space</code>, meaning you are including <code>'\\t'</code>, <code>'\\n'</code>, <em>vertical tab</em>, etc.. within the words you store. Instead of checking <code>space</code> with <code>' '</code>, use the <code>isspace()</code> macro included in <code>ctype.h</code>.</p>\n\n<p><code>n_m[++i] = '\\0';</code> should be <code>n_m[i] = '\\0';</code>. You increment <code>i</code> with <code>n_m[i++] = character;</code>. You do NOT want to increment <code>i</code> again with the pre-increment operator before <em>nul-terminating</em> your string. That results in the last character in the string being indeterminate (again invoking <em>undefined behavior</em> when a read of the string is attempted)</p>\n\n<p>Fixing those issues (and using <code>c</code> instead of <code>character</code>, <code>ndx</code> instead of <code>i</code> and <code>buf</code> instead of <code>n_m</code>), your read and <code>add()</code> to your list would resemble:</p>\n\n<pre><code>    while ((c = fgetc(fp)) != EOF) {            /* read each char in file */\n        if (isspace(c) || ndx == MAXC - 1) {    /* is space or buf full? */\n            if (in) {                           /* were we within word? */\n                buf[ndx] = 0;                   /* nul-terminate */\n                head = add (head, buf);         /* add node to list */\n            }\n            if (ndx &lt; MAXC - 1)     /* buffer not full */ \n                in = 0;             /* set in flag zero */\n            ndx = 0;                /* reset index zero */\n        }\n        else {  /* otherwise */\n            buf[ndx++] = c;         /* add char to buf */\n            in = 1;                 /* set in flag 1 */\n        }\n    }\n</code></pre>\n\n<p>(<strong>note:</strong> using the variable <code>in</code> as an <code>in/out</code> flag to keep track of whether you are within a word reading characters, or between words reading whitespace solves the problem you would have with multiple whitespace characters in sequences, e.g. <code>\"hello   world\"</code>)</p>\n\n<p>Optional, but helpful, when allocating nodes that also contain members that need to be allocated is to write a <code>createnode()</code> function that fully <em>Allocates</em> and <em>Initializes</em> all node members rather than putting that code in <code>add()</code>. It keeps things clean and ensures every node you allocate is fully initialized before its use in <code>add()</code>. For example:</p>\n\n<pre><code>/** create new node, allocate and initialize all member values,\n *  return pointer to node on success, NULL otherwise.\n */\nnode *createnode (char *s)\n{\n    node *new_node;\n\n    new_node = malloc (sizeof *new_node);       /* allocate/validate node */\n    if (new_node == NULL) {\n        perror (\"malloc-Fehler bei Speicher reservierung...\");\n        return NULL;\n    }\n\n    new_node-&gt;name = malloc (strlen (s) + 1);   /* allocate/validate name */\n    if (new_node-&gt;name == NULL) {\n        perror (\"malloc-Fehler bei Speicher reservierung...\");\n        return NULL;;\n    }\n\n    strcpy (new_node-&gt;name, s);     /* initialize all node values */\n    new_node-&gt;age = 0;\n    new_node-&gt;next = NULL;\n\n    return new_node;    /* return newly allocated/initialized node */\n}\n</code></pre>\n\n<p>Then your <code>add()</code> function reduces to:</p>\n\n<pre><code>/** add node containing allocated string 'n_m' to list, return pointer\n *  to 1st node in list on success, exit with failure otherwise.\n */\nnode *add (node *head, char *n_m)\n{\n    node *new_node = createnode (n_m);  /* allocate/initialize new node */\n    node *current = head;               /* pointer to current head */\n\n    if (new_node == NULL)               /* validate allocation */\n        exit (EXIT_FAILURE);\n\n    if (!head)                          /* handle 1st node */\n        return new_node;\n\n    while (current-&gt;next != NULL)       /* iterate to end of list */\n        current = current-&gt;next;\n\n    current-&gt;next = new_node;           /* set next node to new_node */\n\n    return head;                        /* return pointer to head */\n}\n</code></pre>\n\n<p>Putting it altogether and adding a <code>del_list()</code> function to free all allocated memory for the list, you could do the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\n#define MAXC 1024\n\ntypedef struct node {\n    char *name;\n    int age;\n    struct node *next;\n} node;\n\n/** create new node, allocate and initialize all member values,\n *  return pointer to node on success, NULL otherwise.\n */\nnode *createnode (char *s)\n{\n    node *new_node;\n\n    new_node = malloc (sizeof *new_node);       /* allocate/validate node */\n    if (new_node == NULL) {\n        perror (\"malloc-Fehler bei Speicher reservierung...\");\n        return NULL;\n    }\n\n    new_node-&gt;name = malloc (strlen (s) + 1);   /* allocate/validate name */\n    if (new_node-&gt;name == NULL) {\n        perror (\"malloc-Fehler bei Speicher reservierung...\");\n        return NULL;;\n    }\n\n    strcpy (new_node-&gt;name, s);     /* initialize all node values */\n    new_node-&gt;age = 0;\n    new_node-&gt;next = NULL;\n\n    return new_node;    /* return newly allocated/initialized node */\n}\n\n/** add node containing allocated string 'n_m' to list, return pointer\n *  to 1st node in list on success, exit with failure otherwise.\n */\nnode *add (node *head, char *n_m)\n{\n    node *new_node = createnode (n_m);  /* allocate/initialize new node */\n    node *current = head;               /* pointer to current head */\n\n    if (new_node == NULL)               /* validate allocation */\n        exit (EXIT_FAILURE);\n\n    if (!head)                          /* handle 1st node */\n        return new_node;\n\n    while (current-&gt;next != NULL)       /* iterate to end of list */\n        current = current-&gt;next;\n\n    current-&gt;next = new_node;           /* set next node to new_node */\n\n    return head;                        /* return pointer to head */\n}\n\nvoid print (node * head)\n{\n    node *current;\n    current = head;\n\n    while (current != NULL) {\n        printf (\"%s\\n\", current-&gt;name);\n        current = current-&gt;next;\n    }\n}\n\n/** delete all nodes in list */\nvoid del_list (node *head)\n{\n    node *pn = head;                /* pointer to iterate */\n\n    while (pn) {                    /* iterate over each node */\n        node *victim = pn;          /* set victim to current */\n        pn = pn-&gt;next;              /* advance pointer to next */\n        free (victim-&gt;name);        /* free current string */\n        free (victim);              /* free current node */\n    }\n}\n\nint main (int argc, char **argv) {\n\n    char buf[MAXC];\n    int c = 0, in = 0, ndx = 0;\n    node *head = NULL;\n    /* use filename provided as 1st argument (stdin by default) */\n    FILE *fp = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n\n    if (!fp) {  /* validate file open for reading */\n        perror (\"file open failed\");\n        return 1;\n    }\n\n    while ((c = fgetc(fp)) != EOF) {            /* read each char in file */\n        if (isspace(c) || ndx == MAXC - 1) {    /* is space or buf full? */\n            if (in) {                           /* were we within word? */\n                buf[ndx] = 0;                   /* nul-terminate */\n                head = add (head, buf);         /* add node to list */\n            }\n            if (ndx &lt; MAXC - 1)     /* buffer not full */ \n                in = 0;             /* set in flag zero */\n            ndx = 0;                /* reset index zero */\n        }\n        else {  /* otherwise */\n            buf[ndx++] = c;         /* add char to buf */\n            in = 1;                 /* set in flag 1 */\n        }\n    }\n    if (fp != stdin)        /* close file if not stdin */\n        fclose (fp);\n\n    print (head);           /* print list */\n    del_list (head);        /* free all allocated memory */\n}\n</code></pre>\n\n<p><strong>Example Input File</strong></p>\n\n<pre><code>$ cat dat/captnjack.txt\nThis is a tale\nOf Captain Jack Sparrow\nA Pirate So Brave\nOn the Seven Seas.\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/ll_name_age dat/captnjack.txt\nThis\nis\na\ntale\nOf\nCaptain\nJack\nSparrow\nA\nPirate\nSo\nBrave\nOn\nthe\nSeven\nSeas.\n</code></pre>\n\n<p><strong>Memory Use/Error Check</strong></p>\n\n<p>In any code you write that dynamically allocates memory, you have 2 <em>responsibilities</em> regarding any block of memory allocated: (1) <em>always preserve a pointer to the starting address</em> for the block of memory so, (2) it can be <em>freed</em> when it is no longer needed.</p>\n\n<p>It is imperative that you use a memory error checking program to ensure you do not attempt to access memory or write beyond/outside the bounds of your allocated block, attempt to read or base a conditional jump on an uninitialized value, and finally, to confirm that you free all the memory you have allocated. </p>\n\n<p>For Linux <code>valgrind</code> is the normal choice. There are similar memory checkers for every platform. They are all simple to use, just run your program through it.</p>\n\n<pre><code>$ valgrind ./bin/ll_name_age dat/captnjack.txt\n==18265== Memcheck, a memory error detector\n==18265== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==18265== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==18265== Command: ./bin/ll_name_age dat/captnjack.txt\n==18265==\nThis\nis\na\ntale\nOf\nCaptain\nJack\nSparrow\nA\nPirate\nSo\nBrave\nOn\nthe\nSeven\nSeas.\n==18265==\n==18265== HEAP SUMMARY:\n==18265==     in use at exit: 0 bytes in 0 blocks\n==18265==   total heap usage: 35 allocs, 35 frees, 6,132 bytes allocated\n==18265==\n==18265== All heap blocks were freed -- no leaks are possible\n==18265==\n==18265== For counts of detected and suppressed errors, rerun with: -v\n==18265== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Always confirm that you have freed all memory you have allocated and that there are no memory errors.</p>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}], "owner": {"reputation": 81, "user_id": 10370361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28ec310349d936707041271b1f8fc482?s=128&d=identicon&r=PG&f=1", "display_name": "momonosuke", "link": "https://stackoverflow.com/users/10370361/momonosuke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 59278348, "answer_count": 2, "score": 0, "last_activity_date": 1576033593, "creation_date": 1576018301, "question_id": 59276505, "link": "https://stackoverflow.com/questions/59276505/adding-strings-to-a-linked-list-result-in-seg-fault", "title": "Adding strings to a linked list result in seg fault", "body": "<p>I am trying to add strings that I am reading from a text file to a linked list.\nSince I don't know how long the file or the string is , I want to do this dynamically.\nBut somewhere along the line I get a segmentation fault.\nI have tried everything but I think I overlooked something crucial.\nCould someone tell me what I am doing wrong?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct node {\n        char *name;\n        int age;\n        struct node* next;\n    }node;\n\n\nnode *add(node *head, char* n_m){\n   node *new_node;\n   new_node = (node*)malloc(sizeof(node));\n   if(new_node == NULL)\n      printf(\"Fehler bei Speicher reservierung...\");\n   new_node-&gt;name = (char*)malloc(100*sizeof(char));\n   if(new_node-&gt;name == NULL)\n      printf(\"Fehler bei Speicher reservierung...\");\n\n   strcpy(new_node-&gt;name, n_m);\n\n\n   if(head == NULL){\n      head = new_node;\n      head-&gt;next = NULL;\n      return head;\n   }\n\n   node *current;\n   current = head;\n\n   while(current-&gt;next != NULL){\n      current = current-&gt;next;\n   }\n\n   current-&gt;next = new_node;\n   new_node-&gt;next = NULL;\n   return head;\n }\n\n void print(node *head){\n   node *current;\n   current = head;\n\n   while(current != NULL){\n     printf(\"%s\\n\", current-&gt;name);\n     current = current-&gt;next;\n    }\n   }\n\nint main(){\n\n  node *head = NULL;\n\n  char character;\n\n  FILE *fp;\n  fp = fopen(\"test.txt\", \"r\");\n\n  while ((character = fgetc(fp)) != EOF) {\n  char *n_m;\n  n_m = (char*)malloc(100 * sizeof(char));\n  if(n_m == NULL)\n     printf(\"Fehler bei Speicher reservierung...\");\n\n\n  int i = 0;\n  while (character != ' ') {\n     n_m[i++] = character;\n     character = fgetc(fp);\n  }\n  n_m[++i] = '\\0';   // NULL-terminate\n\n  head = add(head, n_m);   \n\n  free(n_m);\n\n }\n print(head);\n return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "ptrace", "systems-programming"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1576022106, "post_id": 59276496, "comment_id": 104760969, "body": "FWIW, your code ran fine on my Linux 5.4 kernel. What kernel version are you on?"}, {"owner": {"reputation": 127, "user_id": 5781079, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-p6fEVLJjskk/AAAAAAAAAAI/AAAAAAAAAMI/ias3mr1ibc4/photo.jpg?sz=128", "display_name": "NotAPro", "link": "https://stackoverflow.com/users/5781079/notapro"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1576022321, "post_id": 59276496, "comment_id": 104761025, "body": "Linux version 4.4.0-18362-Microsoft (Microsoft@Microsoft.com) (gcc version 5.4.0 (GCC) ) #476-Microsoft Fri Nov 01 16:53:00 PST 2019"}, {"owner": {"reputation": 127, "user_id": 5781079, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-p6fEVLJjskk/AAAAAAAAAAI/AAAAAAAAAMI/ias3mr1ibc4/photo.jpg?sz=128", "display_name": "NotAPro", "link": "https://stackoverflow.com/users/5781079/notapro"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1576022376, "post_id": 59276496, "comment_id": 104761043, "body": "I&#39;m using Kali Linux on Windows Subsystem for Linux. I did cat /proc/version and that&#39;s what it printed out."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1576022992, "post_id": 59276496, "comment_id": 104761179, "body": "Oh you are using WSL. That&#39;s important info and suggest you update the question with that. There are known issues with <code>ptrace</code> in WSL. I can&#39;t see a specific bug report for this option but it wouldn&#39;t be surprising if it either isn&#39;t supported or is buggy. Do you have to use WSL? For this kind of experimentation it may be better to use native or VM Linux."}, {"owner": {"reputation": 127, "user_id": 5781079, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-p6fEVLJjskk/AAAAAAAAAAI/AAAAAAAAAMI/ias3mr1ibc4/photo.jpg?sz=128", "display_name": "NotAPro", "link": "https://stackoverflow.com/users/5781079/notapro"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1576024354, "post_id": 59276496, "comment_id": 104761496, "body": "If you don&#39;t mind me asking, could you point me to a quick and easy way to run a Linux terminal in a VM? Preferably one where I can scroll the terminal with my mouse, and can scroll when using <code>less</code>. (I ran a Linux VM before using VirtualBox and it didn&#39;t let me do either)."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1576025510, "post_id": 59276496, "comment_id": 104761756, "body": "Stackoverflow comments is not a suitable forum for helping you get Linux VM working. But I can say that I use Virtual Box with Linux Mint (Ubuntu derivative) and mouse scrolling works fine. So there isn&#39;t any inherent reason why that won&#39;t work. But I can&#39;t tell you what your specific problem is. It may be a Linux distro setting or something else. Best to try it again and if you hit the same problem then ask on <a href=\"https://superuser.com/\">Superuser</a>."}], "owner": {"reputation": 127, "user_id": 5781079, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-p6fEVLJjskk/AAAAAAAAAAI/AAAAAAAAAMI/ias3mr1ibc4/photo.jpg?sz=128", "display_name": "NotAPro", "link": "https://stackoverflow.com/users/5781079/notapro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 376, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576023391, "creation_date": 1576018263, "last_edit_date": 1576023391, "question_id": 59276496, "link": "https://stackoverflow.com/questions/59276496/ptrace-setoptions-with-ptrace-o-exitkill-not-working-invalid-argument", "title": "PTRACE_SETOPTIONS with PTRACE_O_EXITKILL not working: invalid argument", "body": "<p>I'm learning how to use <code>ptrace</code> and wrote some code to test it out. However, I am getting a problem when I am trying to use the <code>PTRACE_SETOPTIONS</code> request to set the <code>PTRACE_O_EXITKILL</code> option to kill the tracee process if the tracer process terminates.</p>\n\n<p>For reference, I am using Windows Subsystem for Linux's Kali Linux, running kernel version 4.4.0. </p>\n\n<pre><code>void child_code();\nvoid parent_code(pid_t pid);\n\nint main(const int argc, char *argv[])\n{\n    pid_t pid;\n    switch (pid = fork())\n    {\n        case -1:\n            perror(\"fork\");\n            break;\n        case 0:\n            child_code();\n            break;\n        default: //parent code\n            parent_code(pid);\n    }\n\n    return 0;\n}\n\nvoid parent_code(pid_t pid)\n{\n    printf(\"Parent code\\n\");\n    int status;\n    if (wait(&amp;status) == -1)\n    {\n        perror(\"parent wait one\");\n    }\n    printf(\"Finished waiting\\n\");\n    printf(\"PTRACE_O_EXITKILL is %x\\n\", PTRACE_O_EXITKILL); //0x100000\n    printf(\"PTRACE_O_TRACEEXEC is %x\\n\", PTRACE_O_TRACEEXEC); //0x10\n    printf(\"PTRACE_O_TRACEFORK is %x\\n\", PTRACE_O_TRACEFORK); //0x2\n    printf(\"My PID is     %d\\n\", getpid());\n    err_wrap(\n        ptrace(PTRACE_SETOPTIONS, pid, 0, PTRACE_O_EXITKILL), \n        0, \"ptrace-set-options\");\n    //This is returning EINVAL error and prints \"Invalid argument\" and I don't know why.\n\n}\n\n\nvoid child_code() {\n    printf(\"Child code\\n\");\n    printf(\"Parent is:   %d\\n\", getppid());\n    err_wrap(ptrace(PTRACE_TRACEME, 0,0,0), 0, \"ptrace-traceme\");\n    err_wrap(raise(SIGSTOP), 0, \"raise\");\n\n    unsigned int pleb = 0xffbbcde8;\n    int x = 0;\n    printf(\"Hello WoRld\\n\");\n\n    printf(\"Pleb is:     %llx\\n\", pleb);\n    printf(\"x is:        %d\\n\", x);\n}\n\n</code></pre>\n\n<p>err_wrap is defined here</p>\n\n<pre><code>void err_wrap(const int ret, const int success, const char *msg)\n{\n    if (ret != success)\n    {\n        perror(msg);\n    }\n}\n</code></pre>\n\n<p>When I call <code>PTRACE_SETOPTIONS</code> with <code>PTRACE_O_EXITKILL</code>, it's saying invalid argument, but I do not know why. When I try other options like <code>PTRACE_O_TRACEEXEC</code>, it works fine. I haven't tried all other options though.</p>\n\n<p>I can't understand why it's not working. As <code>PTRACE_O_EXITKILL</code> is defined, and it's not a macro/variable that I've made, I would presume that the <code>ptrace</code> would recognize it, but for some reason it doesn't. I printed it out and it matches the value that I see in <code>ptrace</code> source code (<code>0x100000</code>).</p>\n\n<p>Any help would be much appreciated, thanks.</p>\n"}, {"tags": ["c", "linux-kernel"], "comments": [{"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1576079404, "post_id": 59276180, "comment_id": 104783913, "body": "Which version of kernel do you use? Does the problem occur on v5.5-rc1 (read: latest vanilla release / release candidate)?"}, {"owner": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1576082972, "post_id": 59276180, "comment_id": 104785874, "body": "Debian10 with kernel v4.14.151. Yes"}], "owner": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1576066155, "creation_date": 1576016220, "last_edit_date": 1576066155, "question_id": 59276180, "link": "https://stackoverflow.com/questions/59276180/registering-a-module-load-tracepoint-using-the-exported-kernel-symbol", "title": "Registering a module_load tracepoint using the exported kernel symbol", "body": "<p>While debugging a 3rd party debugging tool, I came across this problematic piece of code:</p>\n\n<pre><code>tracepoint_probe_register((struct tracepoint *)kallsyms_lookup_name(\"__tracepoint_module_load\"), hook_module_load, NULL);\n</code></pre>\n\n<p>This code crashes the Loadable Kernel module it is in, because the kernel symbol <code>__tracepoint_module_load</code> is not defined in <code>/proc/kallsyms</code>.</p>\n\n<p>Normally, this symbol is defined in the kernel's code <strong><a href=\"https://elixir.bootlin.com/linux/v4.14.151/source/include/trace/events/module.h#L32\" rel=\"nofollow noreferrer\">in this macro</a></strong>.\nI can see that <code>CONFIG_MODULES</code> needs to be defined in order for the <code>__tracepoint_module_load</code> to become defined in that code.</p>\n\n<p>Does the kernel need to be built with some other options for this symbol to become defined in <code>/proc/kallsyms</code>?  Is <code>CONFIG_KALLSYMS_ALL</code> required or something else ?</p>\n"}, {"tags": ["c", "bit-manipulation", "bitwise-operators"], "comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1576013815, "post_id": 59275620, "comment_id": 104758400, "body": "Which way is right, higher addresses in memory or lower? Do you really only want to insert bits at indices with a power of 2\u20141, 2, 4, 8, 16, 32, and so on? You never want to insert a bit at an index that is 17 or 26? Or are you saying, at one time, you have six bits that you want to insert at indices 1, 2, 4, 8, 16, and 32? There is no point in converting the array to a <code>char</code> array; an array of <code>uint8_t</code> is effectively a <code>char</code> array, except for sign issues (for which <code>uint8_t</code> is better anyway). There will not be a good way of dealing with this; you will have to shift at the bit level."}, {"owner": {"reputation": 19, "user_id": 12366166, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9k2Da1aAyXY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3relMRelAnPu3mI__Vi6ElCN7Qbn8Q/photo.jpg?sz=128", "display_name": "Chanaka Perera", "link": "https://stackoverflow.com/users/12366166/chanaka-perera"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1576014808, "post_id": 59275620, "comment_id": 104758783, "body": "So if i take a uint8_t array at a time lets say at index 0 for the example I get 00010001 which represents 8 bits. I would need to insert a bit I have computed at indexes 0, 2 and 4. Which means I need to right shift by 3 places. But after I right shift once then I lose the 8th bit which needs to carry over. This is not the only problem. The next time I need to right shift by 1 so I can insert a bit at index 2, I lose the bit at index 1 which needs to be non changed"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1576016676, "post_id": 59275620, "comment_id": 104759428, "body": "@ChanakaPerera First figure out where all the bits need to go. Start with <code>aaaaaaaa bbbbbbbb ... gggggggg hhhhhhhh</code> and then insert bits. For example <code>gggggggg hhhhhhhh</code> becomes <code>ggghhhh8 hhh4h210</code>. So you need to chop the <code>h</code> byte into three pieces and shift the pieces to the correct positions."}, {"owner": {"reputation": 19, "user_id": 12366166, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9k2Da1aAyXY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3relMRelAnPu3mI__Vi6ElCN7Qbn8Q/photo.jpg?sz=128", "display_name": "Chanaka Perera", "link": "https://stackoverflow.com/users/12366166/chanaka-perera"}, "edited": false, "score": 0, "creation_date": 1576017115, "post_id": 59275620, "comment_id": 104759577, "body": "I found a method by using a char array of 72 size to get the solution using 0 and 1&#39;s. Now I need to somehow transform it back into a uint8_t array of size 9."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1576017494, "post_id": 59275620, "comment_id": 104759707, "body": "<code>uint8_t result=0; for (int i=0; i &lt; 8; i++) result= (result &lt;&lt; 1) | array[i];</code> will convert an array of size 8 into a single <code>uint8_t</code>."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 12366166, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9k2Da1aAyXY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3relMRelAnPu3mI__Vi6ElCN7Qbn8Q/photo.jpg?sz=128", "display_name": "Chanaka Perera", "link": "https://stackoverflow.com/users/12366166/chanaka-perera"}, "edited": false, "score": 0, "creation_date": 1576020790, "post_id": 59276573, "comment_id": 104760615, "body": "Doesnt src[0] &amp; oxFE result in either 0 or 1. Doesnt it get rid of all other binary values. Also I dont understand how you can insert to position 100 as there are only 72 bits total."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 19, "user_id": 12366166, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9k2Da1aAyXY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3relMRelAnPu3mI__Vi6ElCN7Qbn8Q/photo.jpg?sz=128", "display_name": "Chanaka Perera", "link": "https://stackoverflow.com/users/12366166/chanaka-perera"}, "edited": false, "score": 0, "creation_date": 1576020892, "post_id": 59276573, "comment_id": 104760645, "body": "Re &quot;<i>Doesnt src[0] &amp; oxFE result in either 0 or 1.</i>&quot;, No. <code>&amp; 1</code> would do that. /// Re &quot;<i>Doesn&#39;t it get rid of all other binary values</i>&quot;, Yes. All bits not set in 0xFE aka 0b11111110 are cleared, so bit 0 is cleared"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 19, "user_id": 12366166, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9k2Da1aAyXY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3relMRelAnPu3mI__Vi6ElCN7Qbn8Q/photo.jpg?sz=128", "display_name": "Chanaka Perera", "link": "https://stackoverflow.com/users/12366166/chanaka-perera"}, "edited": false, "score": 0, "creation_date": 1576020944, "post_id": 59276573, "comment_id": 104760658, "body": "100 octal = 64 decimal. Note how the digits of the positions go from 0-7 instead of 0-9"}, {"owner": {"reputation": 19, "user_id": 12366166, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9k2Da1aAyXY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3relMRelAnPu3mI__Vi6ElCN7Qbn8Q/photo.jpg?sz=128", "display_name": "Chanaka Perera", "link": "https://stackoverflow.com/users/12366166/chanaka-perera"}, "edited": false, "score": 0, "creation_date": 1576025442, "post_id": 59276573, "comment_id": 104761740, "body": "So I changed the code a bit since dst[0] needs to be the one with with indexes of 0,1 and 2 so the whole thing needs to be in reverse. But I cant seem to get it to work."}, {"owner": {"reputation": 19, "user_id": 12366166, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9k2Da1aAyXY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3relMRelAnPu3mI__Vi6ElCN7Qbn8Q/photo.jpg?sz=128", "display_name": "Chanaka Perera", "link": "https://stackoverflow.com/users/12366166/chanaka-perera"}, "edited": false, "score": 0, "creation_date": 1576025475, "post_id": 59276573, "comment_id": 104761748, "body": "mine looks like, (*pH).bits[0] = (pBits[0])&lt;&lt; 4 | ((pBits[0] &amp; 0x10) &lt;&lt; 3); I just started learning bitwise. Is there something wrong with this"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 19, "user_id": 12366166, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9k2Da1aAyXY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3relMRelAnPu3mI__Vi6ElCN7Qbn8Q/photo.jpg?sz=128", "display_name": "Chanaka Perera", "link": "https://stackoverflow.com/users/12366166/chanaka-perera"}, "edited": false, "score": 0, "creation_date": 1576027944, "post_id": 59276573, "comment_id": 104762304, "body": "If the bytes are reversed, just change <code>src[x]</code> to <code>src[7-x]</code> and <code>dst[x]</code> to <code>dst[8-x]</code>"}], "tags": [], "owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 3, "last_activity_date": 1576021483, "last_edit_date": 1576021483, "creation_date": 1576018686, "answer_id": 59276573, "question_id": 59275620, "link": "https://stackoverflow.com/questions/59275620/adding-bits-at-specific-indexes-for-a-uint8-t-block/59276573#59276573", "title": "Adding bits at specific indexes for a uint8_t block", "body": "<p>Say you start with the following:</p>\n\n<pre><code>src[0]   src[1]   src[2]   src[3]   src[4]   src[5]   src[6]   src[7]\n-------- -------- -------- -------- -------- -------- -------- --------\n       7        6        5        4        3        2        1\n76543210 76543210 76543210 76543210 76543210 76543210 76543210 76543210\naaaaaaaa bbbbbbbb cccccccc dddddddd eeeeeeee ffffffff gggggggg hhhhhhhh\n</code></pre>\n\n<p>You want to insert at the following positions (octal):\n0, 1, 2, 4, 10, 20, 40, 100</p>\n\n<p>That means you want the following:</p>\n\n<pre><code>dst[0]   dst[1]   dst[2]   dst[3]   dst[4]   dst[5]   dst[6]   dst[7]   dst[8]\n-------- -------- -------- -------- -------- -------- -------- -------- --------\n       1\n       0        7        6        5        4        3        2        1\n76543210 76543210 76543210 76543210 76543210 76543210 76543210 76543210 76543210\naaaaaaa0 abbbbbbb bccccccc cddddddd deeeeee0 eeffffff ffggggg0 ggghhhh0 hhh0h000\n</code></pre>\n\n<p>So,</p>\n\n<pre><code>dst[0] = src[0] &amp; 0xFE;\ndst[1] = ((src[0]       ) &lt;&lt; 7) | ((src[1]       ) &gt;&gt; 1);\ndst[2] = ((src[1]       ) &lt;&lt; 7) | ((src[2]       ) &gt;&gt; 1);\ndst[3] = ((src[2]       ) &lt;&lt; 7) | ((src[3]       ) &gt;&gt; 1);\ndst[4] = ((src[3]       ) &lt;&lt; 7) | ((src[4] &amp; 0xFC) &gt;&gt; 1);\ndst[5] = ((src[4]       ) &lt;&lt; 6) | ((src[5]       ) &gt;&gt; 2);\ndst[6] = ((src[5]       ) &lt;&lt; 6) | ((src[6] &amp; 0xFC) &gt;&gt; 2);\ndst[7] = ((src[6]       ) &lt;&lt; 5) | ((src[7] &amp; 0xFC) &gt;&gt; 3);\ndst[8] = ((src[7] &amp; 0x0E) &lt;&lt; 5) | ((src[7] &amp; 0x01) &lt;&lt; 3);\n</code></pre>\n\n<p>(Useless masks omitted.)</p>\n"}, {"tags": [], "owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1605198094, "last_edit_date": 1605198094, "creation_date": 1588258618, "answer_id": 61526409, "question_id": 59275620, "link": "https://stackoverflow.com/questions/59275620/adding-bits-at-specific-indexes-for-a-uint8-t-block/61526409#61526409", "title": "Adding bits at specific indexes for a uint8_t block", "body": "<p>You can treat the input array as a 64-bit int to make it faster. Suppose the input and output values are like this</p>\n<pre><code>array  = aaaaaaaa bbbbbbbb cccccccc dddddddd eeeeeeee ffffffff gggggggg hhhhhhhh\nnewArr = aaaaaaa0 abbbbbbb bccccccc cddddddd deeeeee0 eeffffff ffggggg0 ggghhhh0 hhh0h000\n</code></pre>\n<p>Then you can get the desired result using this way</p>\n<pre><code>uin64_t src = htobe64(*(uint64_t*)array); // operate on big endian\nuint64_t* dst = (uint64_t*)newArr;\n\n*dst  = (src &amp; 0xFE00'0000'0000'0000) &gt;&gt; 0; // aaaaaaa\n*dst |= (src &amp; 0x01FF'FFFF'FC00'0000) &gt;&gt; 1; // abbbbbbbbccccccccddddddddeeeeee\n*dst |= (src &amp; 0x0000'0000'03FF'F800) &gt;&gt; 2; // eeffffffffggggg\n*dst |= (src &amp; 0x0000'0000'0000'07F0) &gt;&gt; 3; // ggghhhh\n*dst  = be64toh(*dst); // convert back to the native endian\nnewArr[8] = ((array[7] &amp; 0x0E) &lt;&lt; 4) | ((array[7] &amp; 0x01) &lt;&lt; 3); // hhh0h000\n</code></pre>\n<p>To avoid strict aliasing you can change to memcpy to copy from <code>array</code> to <code>src</code> and from <code>dst</code> to <code>newArr</code></p>\n<p>Of course you may need to align the input and output arrays for better performance. On many modern architectures it's also a must</p>\n<pre><code>#ifdef _MSC_VER\n__declspec(align(8)) uint8_t array[8]; #64 bit array\n__declspec(align(8)) uint8_t newArr[9];\n#else\nuint8_t array[8] __attribute__((aligned(8))); #64 bit array\nuint8_t newArr[9] __attribute__((aligned(8)));\n#endif\n</code></pre>\n<p>On modern x86 with <a href=\"https://en.wikipedia.org/wiki/Bit_manipulation_instruction_set\" rel=\"nofollow noreferrer\">BMI2</a> you can use the new <a href=\"https://www.felixcloutier.com/x86/pdep\" rel=\"nofollow noreferrer\">bit deposit instruction</a> to get the first 8 bytes directly</p>\n<pre><code>uint64_t src;\nmemcpy(&amp;src, &amp;array, sizeof src); // avoid strict aliasing\nuin64_t src = htobe64(src);\n\nuint64_t dst = _pdep_u64(src &gt;&gt; 4,\n   // aaaaaaa0 abbbbbbb bccccccc cddddddd deeeeee0 eeffffff ffggggg0 ggghhhh0\n    0b11111110'11111111'11111111'11111111'11111110'11111111'11111110'11111110);\n                          // hhh0h000\nnewArr[8] = _pdep_u32(src, 0b11101000);\n\n*dst  = be64toh(*dst); // convert back to the native endian\nmemcpy(&amp;newArr, &amp;dst, sizeof dst); // avoid strict aliasing\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 12366166, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9k2Da1aAyXY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3relMRelAnPu3mI__Vi6ElCN7Qbn8Q/photo.jpg?sz=128", "display_name": "Chanaka Perera", "link": "https://stackoverflow.com/users/12366166/chanaka-perera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1605198094, "creation_date": 1576013316, "last_edit_date": 1588289808, "question_id": 59275620, "link": "https://stackoverflow.com/questions/59275620/adding-bits-at-specific-indexes-for-a-uint8-t-block", "title": "Adding bits at specific indexes for a uint8_t block", "body": "<p>So I have a pointer to a <code>uint8_t</code> array in the form of:</p>\n\n<pre><code>uint8_t* array; // 64-bit array\n</code></pre>\n\n<p>I need to modify this array by shifting bits to the right and inserting a bit of 0 or 1 at indexes with a power of 2. Thereby generating a 72-bit array.</p>\n\n<pre><code>uint8_t newArr[9];\n</code></pre>\n\n<p>What is the best way to modify an array so I can add the bits at the specific places I computed. I thought of converting the array to a a char array and then adding the bits one by one. However, is there a faster and more easier method than this. </p>\n\n<p>So if I have a pointer to a bit array in the form of <code>uint8_t</code> like:</p>\n\n<pre><code>000100001 11001111 01101101 11000001 11100000 00101111 11111001 10010010\n</code></pre>\n\n<p>I would need to modify it into a <code>uint8_t[9]</code> array so that I insert bits I have specified at 0, 1, 2, 4, 8, 16, 32, 64 of the new array to look like: (answer is wrong)</p>\n\n<pre><code>00000000 11001111 11001111 11001111 11001111 01101101 01101101 10010010 00100001\n</code></pre>\n\n<p>But I don't know how to shift a particular bit to the right without shifting all the bits. For example if I shift all bits starting at index 2 1 to the right and then all bits starting from index 4 to the right by one. </p>\n"}, {"tags": ["c++", "c", "winapi", "ole"], "comments": [{"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 2, "creation_date": 1576011570, "post_id": 59275209, "comment_id": 104757574, "body": "What happens if you re-order the includes?  Include order can sometimes mess things up.  Also, I&#39;d put windows.h first as the most general set of definitions that other includes are going to expect to exist."}, {"owner": {"reputation": 53, "user_id": 2537157, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/de52f308585a929b16b95604bb877c66?s=128&d=identicon&r=PG", "display_name": "user2537157", "link": "https://stackoverflow.com/users/2537157/user2537157"}, "reply_to_user": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1576011918, "post_id": 59275209, "comment_id": 104757710, "body": "@DaveS unfortunately reordering the includes doesn&#39;t help"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1576012057, "post_id": 59275209, "comment_id": 104757763, "body": "Does using <code>#pragma once</code> at the very begin of guiddef.h help?"}, {"owner": {"reputation": 53, "user_id": 2537157, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/de52f308585a929b16b95604bb877c66?s=128&d=identicon&r=PG", "display_name": "user2537157", "link": "https://stackoverflow.com/users/2537157/user2537157"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1576012363, "post_id": 59275209, "comment_id": 104757863, "body": "@DavidRanieri <code>guiddef.h</code> is not my file, it&#39;s provided by the win32 API (<a href=\"https://docs.microsoft.com/en-us/windows/win32/api/guiddef/\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows/win32/api/guiddef</a>)"}, {"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 1, "creation_date": 1576012857, "post_id": 59275209, "comment_id": 104758058, "body": "Try a search on &quot;multiple definition&quot; for other posts with suggestions.  I&#39;d still move <code>shobjidl.h</code> to last in your include order, with <code>windows.h</code> first."}, {"owner": {"reputation": 53, "user_id": 2537157, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/de52f308585a929b16b95604bb877c66?s=128&d=identicon&r=PG", "display_name": "user2537157", "link": "https://stackoverflow.com/users/2537157/user2537157"}, "reply_to_user": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1576013157, "post_id": 59275209, "comment_id": 104758161, "body": "@DaveS I moved <code>windows.h</code> to be first in the import list -- thank you! The problem with other solutions I&#39;ve found to this problem is it requires editing of one of the files that contains the colliding function, which I am not able to."}, {"owner": {"reputation": 6168, "user_id": 10611792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r727s.jpg?s=128&g=1", "display_name": "Drake Wu", "link": "https://stackoverflow.com/users/10611792/drake-wu"}, "edited": false, "score": 0, "creation_date": 1576035212, "post_id": 59275209, "comment_id": 104763724, "body": "I use the latest MinGW gcc-8.1.0 but can&#39;t reproduce this error. In addition, <code>CoCreateInstance(CLSID_TaskbarList, NULL, CLSCTX_INPROC_SERVER,IID_ITaskbarList3, (void**)&amp;tbl);</code>, remove the &quot;&amp;&quot; since the parameter type is reference, and you don&#39;t have to declare IID_ITaskbarList3, but just pass <code>-luuid</code> to the compiler."}, {"owner": {"reputation": 53, "user_id": 2537157, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/de52f308585a929b16b95604bb877c66?s=128&d=identicon&r=PG", "display_name": "user2537157", "link": "https://stackoverflow.com/users/2537157/user2537157"}, "reply_to_user": {"reputation": 6168, "user_id": 10611792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r727s.jpg?s=128&g=1", "display_name": "Drake Wu", "link": "https://stackoverflow.com/users/10611792/drake-wu"}, "edited": false, "score": 0, "creation_date": 1576083877, "post_id": 59275209, "comment_id": 104786303, "body": "@DrakeWu-MSFT I have determined the error arises from having both DWrite and OLE32 linked. I.e., if I just have <code>-ldwrite</code> or <code>-lole32</code>, the program compiles fine, but if I have both, I get the error in the post."}, {"owner": {"reputation": 6168, "user_id": 10611792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r727s.jpg?s=128&g=1", "display_name": "Drake Wu", "link": "https://stackoverflow.com/users/10611792/drake-wu"}, "edited": false, "score": 1, "creation_date": 1576130587, "post_id": 59275209, "comment_id": 104800707, "body": "Still cannot reproduce it with both <code>-ldwrite</code> and <code>-lole32</code>, with the same header file(same order), and an empty main function. <code>gcc test.cpp -ldwrite -lole32 -luuid</code>. Could you provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">Minimal, Reproducible Example</a>?"}], "owner": {"reputation": 53, "user_id": 2537157, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/de52f308585a929b16b95604bb877c66?s=128&d=identicon&r=PG", "display_name": "user2537157", "link": "https://stackoverflow.com/users/2537157/user2537157"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1576083999, "creation_date": 1576011291, "last_edit_date": 1576083999, "question_id": 59275209, "link": "https://stackoverflow.com/questions/59275209/ole32-link-error-with-multiple-definitions-of-isequalguid", "title": "OLE32 Link Error with multiple definitions of IsEqualGuid", "body": "<p>When I try to compile a COM based application with the following code on Windows, I get the following error when I pass <code>-lole32</code> to my compiler:</p>\n\n<p>Code:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;shobjidl.h&gt;\n#include &lt;windows.h&gt;\n#include &lt;stdio.h&gt;\n\nconst IID IID_ITaskbarList3 = {0xea1afb91, 0x9e28, 0x4b86, {0x90, 0xe9, 0x9e, 0x9f, 0x8a, 0x5e, 0xef, 0xaf}};\n\nvoid *revery_register_icon_progress_win32() {\n    ITaskbarList3 *tbl;\n    CoCreateInstance(&amp;CLSID_TaskbarList, NULL, CLSCTX_INPROC_SERVER,\n                     &amp;IID_ITaskbarList3, (void**)&amp;tbl);\n    return (void *)tbl;\n}\n</code></pre>\n\n<p>Error: </p>\n\n<pre><code>/usr/x86_64-w64-mingw32/sys-root/mingw/include/guiddef.h:161: multiple definition of `IsEqualGUID'\nC:/Users/Admin/AppData/Roaming/npm/node_modules/esy/node_modules/esy-bash/.cygwin/usr/x86_64-w64-mingw32/sys-root/mingw/lib/libole32.a(dwzns00301.o):(.text+0x0): first defined here\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>I'm not sure how to solve this, because it appears that the error isn't with my code, but with the library itself. If the file is completely empty I still get this error. Is there anything I can do to fix this?</p>\n\n<p><strong>EDIT</strong>: I have determined that this arises from linking both DWrite and OLE32 in my program, i.e. if I compile with just <code>-ldwrite</code> or <code>-lole32</code>, the program compiles and works fine, but if I include both I end up with the aforementioned compile error. This is a problem, because I need both in my program.</p>\n"}, {"tags": ["c", "arrays", "function", "pointers"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 1, "creation_date": 1576008594, "post_id": 59274599, "comment_id": 104756339, "body": "<code>array[j][i]=GetInteger();</code> I think you want <code>array[i][j]=GetInteger();</code>, otherwise you write outside of the bounds of the array."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1576008658, "post_id": 59274599, "comment_id": 104756367, "body": "<code>colAvg[j] = sum &#47; row;</code> Um... why is that in the <i>inner</i> for loop in <code>columnEarnings</code> ?"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1576008765, "post_id": 59274599, "comment_id": 104756409, "body": "Your code would be easier to follow if you changed <code>row</code> to <code>hall</code> and <code>col</code> to <code>month</code> - or something similar. Also, fix the indentation."}, {"owner": {"reputation": 25, "user_id": 12363180, "user_type": "registered", "profile_image": "https://graph.facebook.com/2586976721396188/picture?type=large", "display_name": "Vaggelis Davios", "link": "https://stackoverflow.com/users/12363180/vaggelis-davios"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1576008989, "post_id": 59274599, "comment_id": 104756507, "body": "@WhozCraig should it not be in the inner loop? When I put it outside that loop, it has the same effect as when it was in the inner. If I get it completely out of both of the loops it goes crazy."}, {"owner": {"reputation": 25, "user_id": 12363180, "user_type": "registered", "profile_image": "https://graph.facebook.com/2586976721396188/picture?type=large", "display_name": "Vaggelis Davios", "link": "https://stackoverflow.com/users/12363180/vaggelis-davios"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1576009062, "post_id": 59274599, "comment_id": 104756543, "body": "@DavidRanieri Sorry I forgot to mention that I need help with the &quot;columnEarnings&quot;. The rest is working fine."}, {"owner": {"reputation": 25, "user_id": 12363180, "user_type": "registered", "profile_image": "https://graph.facebook.com/2586976721396188/picture?type=large", "display_name": "Vaggelis Davios", "link": "https://stackoverflow.com/users/12363180/vaggelis-davios"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1576009114, "post_id": 59274599, "comment_id": 104756555, "body": "@JohnnyMopp Ah yeah that would definitely make it look much better. Could you elaborate on the &quot;fix the indentation&quot;?"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1576009313, "post_id": 59274599, "comment_id": 104756627, "body": "@VaggelisDavios WhozCraig has already fixed the indentation for you. Notice how the brackets line up and the code inside the loops is tabbed over to the right to show it is part of the loop. This doesn&#39;t affect how the code runs. It just makes it easier to read."}, {"owner": {"reputation": 25, "user_id": 12363180, "user_type": "registered", "profile_image": "https://graph.facebook.com/2586976721396188/picture?type=large", "display_name": "Vaggelis Davios", "link": "https://stackoverflow.com/users/12363180/vaggelis-davios"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1576009672, "post_id": 59274599, "comment_id": 104756780, "body": "@JohnnyMopp ah now I get it. Thank you so much @WhozCraig! Anything else you guys would suggest?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1576014570, "post_id": 59274599, "comment_id": 104758676, "body": "@VaggelisDavios <code>colAvg[j] = sum &#47; row</code> should be done inside the outer <code>j</code> loop, but outside the inner <code>i</code> loop.  The inner loop has one purpose: compute the sum. The outer loop has two purposes: use the inner loop to compute the sum, then use that resulting sum to compute the column average, storing it in <code>colAvg[j]</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2858, "user_id": 12491175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mPSJY.png?s=128&g=1", "display_name": "Zig Razor", "link": "https://stackoverflow.com/users/12491175/zig-razor"}, "is_accepted": true, "score": 1, "last_activity_date": 1576070148, "creation_date": 1576070148, "answer_id": 59286664, "question_id": 59274599, "link": "https://stackoverflow.com/questions/59274599/function-showing-only-one-column-average/59286664#59286664", "title": "Function showing only one column average..?", "body": "<p>ColumnErnings function has a basic error on index. Look at last for loop, you loop on index \"i\" and the use index \"j\" on \"colAvg[j]\". The correct function is the following:</p>\n\n<pre><code>void columnEarnings(int array[row][col], int colAvg[]){\n\n    int i,j;\n    double sum;\n\n    for (j=0; j&lt;col; j++){\n        sum = 0;\n        for (i=0; i&lt;row; i++){\n            sum+=array[i][j];\n            colAvg[j] = sum / row;\n        }\n    }\n    for (i=0; i&lt;col; i++){\n        printf(\"\\naverage for month number %d is : %d\",i+1, colAvg[i]);\n    }\n}\n</code></pre>\n\n<p>in addition you can move \"colAvg[j] = sum / row;\" instruction outside the nested for in this way:</p>\n\n<pre><code>void columnEarnings(int array[row][col], int colAvg[]){\n\n        int i,j;\n        double sum;\n\n        for (j=0; j&lt;col; j++){\n            sum = 0;\n            for (i=0; i&lt;row; i++){\n                sum+=array[i][j];                    \n            }\n            colAvg[j] = sum / row;\n        }\n        for (i=0; i&lt;col; i++){\n            printf(\"\\naverage for month number %d is : %d\",i+1, colAvg[i]);\n        }\n    }\n</code></pre>\n\n<p>in this way you avoid to update a variable that has no sense in intermediate step.</p>\n"}], "owner": {"reputation": 25, "user_id": 12363180, "user_type": "registered", "profile_image": "https://graph.facebook.com/2586976721396188/picture?type=large", "display_name": "Vaggelis Davios", "link": "https://stackoverflow.com/users/12363180/vaggelis-davios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 59286664, "answer_count": 1, "score": 0, "last_activity_date": 1576070148, "creation_date": 1576008416, "last_edit_date": 1576008578, "question_id": 59274599, "link": "https://stackoverflow.com/questions/59274599/function-showing-only-one-column-average", "title": "Function showing only one column average..?", "body": "<p>A little backstory: \nI have this homework that requires you to write a program using functions and pointers. You are supposed to enter the money each cinema hall earned throughout the summer. At one point, you need to find the average for each cinema hall and after that the average for each month (for example that would be summing up all the earning from July and dividing them by 5). I've done an okay job so far but I am stuck... The program works just fine but I cannot get it to show the values of all the 3 months. It just shows the average of the first month 3 times.. any suggestions to what I could change? Thank you so much for reading through this, here's a cookie and the code below.</p>\n\n<pre><code>#include \"genlib.h\"\n#include &lt;stdio.h&gt;\n#include \"simpio.h\"\n#define row 5\n#define col 3\n\nvoid array(int array[row][col]);\nvoid cinemaEarnings(int array[row][col], double *sum);\nvoid columnEarnings(int array[row][col], int colAvg[]);\n\n\nint main(){\n\n    double sum;\n\n    int array1[row][col];\n    int array2[col];\n\n\n    array(array1);\n\n    cinemaEarnings(array1,&amp;sum);\n\n    columnEarnings(array1,array2);\n\n    return 0;\n}\n\nvoid array(int array[row][col]){\n\n    int i;\n    int j;\n\n    for (i=0; i&lt;row; i++){\n        printf(\"CINEMA HALL NUMBER %d\\n\", i+1);\n        for (j=0; j&lt;col; j++){\n            printf(\"Monthly earnings for month number %d: \", j+1);\n            array[j][i]=GetInteger();\n        }\n    }\n}\n\nvoid cinemaEarnings(int array[row][col], double *sum){\n\n    int total;\n    int i,j;\n    *sum =0;\n\n    for (j=0; j&lt;row; j++){\n        for (i=0; i&lt;col; i++){\n            *sum += array[i][j];\n        }\n        total = *sum / 3;\n        printf(\"\\nAverage earnings for hall %d: %d\\n\",j+1, total);\n        *sum = 0;\n    }\n}\n\nvoid columnEarnings(int array[row][col], int colAvg[]){\n\n    int i,j;\n    double sum;\n\n    for (j=0; j&lt;col; j++){\n        sum = 0;\n        for (i=0; i&lt;row; i++){\n            sum+=array[i][j];\n            colAvg[j] = sum / row;\n        }\n    }\n    for (i=0; i&lt;col; i++){\n        printf(\"\\naverage for month number %d is : %d\",i+1, colAvg[j]);\n    }\n}\n\n</code></pre>\n"}, {"tags": ["c", "scope", "declaration"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1576008200, "post_id": 59274515, "comment_id": 104756168, "body": "I don&#39;t see any compound declaration here. Anyway, local variables are allowed to <i>shadow</i> the global ones."}, {"owner": {"reputation": 109, "user_id": 12465244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d616f22be9ccb1e0b34b694afa84c5?s=128&d=identicon&r=PG&f=1", "display_name": "1729_SR", "link": "https://stackoverflow.com/users/12465244/1729-sr"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576008610, "post_id": 59274515, "comment_id": 104756343, "body": "Hi @EugeneSh., thanks very much for pointing me in the right direction. &quot;Shadow&quot; is exactly what I was looking for, I didn&#39;t know what to look up previously. Quick question for you then. The nmax declared in main() here is then <b>different</b> than the global nmax, right? And were we to want to change that global nmax to 25, we could either simply write (in main() ) nmax = 25; on another line, or extern nmax = 25; on the same line? Or would the latter not work because then we have effectively written int extern nmax = 25; which is the wrong order for int and extern?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576008698, "post_id": 59274515, "comment_id": 104756378, "body": "Check this out: <a href=\"https://stackoverflow.com/questions/618769/how-can-i-access-a-shadowed-global-variable-in-c\" title=\"how can i access a shadowed global variable in c\">stackoverflow.com/questions/618769/&hellip;</a>"}, {"owner": {"reputation": 109, "user_id": 12465244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d616f22be9ccb1e0b34b694afa84c5?s=128&d=identicon&r=PG&f=1", "display_name": "1729_SR", "link": "https://stackoverflow.com/users/12465244/1729-sr"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1576008828, "post_id": 59274515, "comment_id": 104756443, "body": "Thanks for the reference. It would seem then that the answers to my above questions are all yes. Thanks again!"}], "owner": {"reputation": 109, "user_id": 12465244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d616f22be9ccb1e0b34b694afa84c5?s=128&d=identicon&r=PG&f=1", "display_name": "1729_SR", "link": "https://stackoverflow.com/users/12465244/1729-sr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "closed_date": 1576008146, "answer_count": 0, "score": 0, "last_activity_date": 1576008024, "creation_date": 1576008024, "question_id": 59274515, "link": "https://stackoverflow.com/questions/59274515/c-rules-for-compound-declaration-and-global-variables", "closed_reason": "Duplicate", "title": "C Rules for Compound Declaration and Global Variables", "body": "<p>I'm a little bit confused about why the below compiles. I've tried looking into some resources to explain it (Kernighan's <em>The C Programming Language</em>) but to no avail. My confusion arises from why the last part of the compound declaration works. My understanding is that the \"int\" at the start of the line applies to every subsequent variable (hence why they are all initialized as ints). If this is so, then why is it not illegal to redefine nmax which has global scope?</p>\n\n<pre><code>int  nmax  =  20; \n/* The  main()  function  */ \nint  main ( int  argc ,  char  ** argv ){  // entry  point \n   int a = 0, b = 1, c, n, nmax = 25;  \n   printf ( \"%3d: %d\\n\",1 ,a );  \n   printf ( \"%3d: %d\\n\",2 ,b ); \n   for  (n  = 3;  n &lt;=  nmax;  n++)  { \n      c = a + b;  a = b;  b = c;  \n      printf ( \"%3d: %d\\n\",n, c ); \n   } \n}\n</code></pre>\n"}, {"tags": ["c", "file", "csv"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1576006513, "post_id": 59274171, "comment_id": 104755504, "body": "<code>dataX</code> in your code are <i>file descriptors</i> and not a data or pointer to data you can dereference. You use the descriptors with other file operations such as <code>fread</code>."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1576007180, "post_id": 59274171, "comment_id": 104755759, "body": "Or <code>fscanf</code> if the files are text files. Showing a sample of your files would help us understand the question. There&#39;s also the issue that the temperature changes. I wouldn&#39;t expect three temperature readings  to match perfectly. I&#39;d expect them to occasionally differ by a degree or two."}, {"owner": {"reputation": 19, "user_id": 12239529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d874e3d982db860010d06cccc9a8df37?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie P", "link": "https://stackoverflow.com/users/12239529/charlie-p"}, "edited": false, "score": 0, "creation_date": 1576007339, "post_id": 59274171, "comment_id": 104755812, "body": "Data1: 72 83 92 84 etc.  Data2: 72 84 91 84 etc. Data3: 72 83 92 81 etc."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1576007668, "post_id": 59274171, "comment_id": 104755960, "body": "So the first thing to do is write code that opens one file, reads the file and prints the values. You can read the numbers with code like: <code>int temperature; while (fscanf(data1, &quot;%d&quot;, &amp;temperature) == 1) { dosomething() }</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1576008145, "post_id": 59274171, "comment_id": 104756155, "body": "@CharlieP the question title says &quot;CSV files&quot; which means &quot;comma separated values&quot;. Please post the actual input <i>in the question.</i>"}], "answers": [{"comments": [{"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "reply_to_user": {"reputation": 19, "user_id": 12239529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d874e3d982db860010d06cccc9a8df37?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie P", "link": "https://stackoverflow.com/users/12239529/charlie-p"}, "edited": false, "score": 1, "creation_date": 1576009500, "post_id": 59274352, "comment_id": 104756713, "body": "@CharlieP I would not recommend this approach of reading the files into memory (it is almost always unnecessary, needs more memory, prevents using pipes and devices as input, etc), but if you do it, you need to add error checking (which is completely missing here). But rather just read from the files directly instead of this."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1576009611, "post_id": 59274352, "comment_id": 104756755, "body": "Also, as a stylistic note, multiplying by <code>sizeof char</code> is unneccessary, since it is 1 by definition. And the space between function name and <code>(</code> when calling is quite unusual."}], "tags": [], "owner": {"reputation": 668, "user_id": 6895840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BAA5Q.jpg?s=128&g=1", "display_name": "Anteino", "link": "https://stackoverflow.com/users/6895840/anteino"}, "is_accepted": false, "score": 0, "last_activity_date": 1576017603, "last_edit_date": 1576017603, "creation_date": 1576007286, "answer_id": 59274352, "question_id": 59274171, "link": "https://stackoverflow.com/questions/59274171/comparing-int-values-of-two-data-files-in-c/59274352#59274352", "title": "Comparing int values of two data files in C", "body": "<p>Indeed, like Eugene suggested, you need first need to read all your files to a character array and then read from that. I wrote a piece of code for an assignment that I am willing to share:</p>\n\n<pre><code>void readFile(const char *fileName, char **text, int *filelen)\n{\n    FILE *f;\n\n    f = fopen(fileName, \"rb\");\n    fseek(f, 0, SEEK_END);\n    *filelen = ftell (f);\n\n    fseek(f, 0, SEEK_SET);\n    *text = malloc((*filelen + 1) * sizeof(char));\n    if(*text)\n    {\n        fread(*text, 1, *filelen, f);\n    }\n    fclose(f);\n    (*text)[*filelen] = '\\0';\n}\n</code></pre>\n\n<p>You can then initialize all the variables and do the function call like this (for example):</p>\n\n<pre><code>char *fileText;\nint filelen;\n\nreadFile(\"filename.txt\", &amp;fileText, &amp;filelen);\n</code></pre>\n\n<p>Only, you should make several <em>fileText</em> and <em>filelen</em> variables when you're working with several files and change <em>\"filename.txt\"</em> to the correct filename(s).</p>\n\n<p>If you only need the data once and want to discard of it after that you don't need to save to a character array first. You can directly use fgetc or fscanf to analyze your data.</p>\n"}], "owner": {"reputation": 19, "user_id": 12239529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d874e3d982db860010d06cccc9a8df37?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie P", "link": "https://stackoverflow.com/users/12239529/charlie-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576017603, "creation_date": 1576006418, "last_edit_date": 1576008667, "question_id": 59274171, "link": "https://stackoverflow.com/questions/59274171/comparing-int-values-of-two-data-files-in-c", "title": "Comparing int values of two data files in C", "body": "<p>I am given 3 files of integers representing three different readings of temperatures for different days. I need to compare the three integers each day to find out if theres a faulty reading if one does not match the other two. I keep getting an error that says </p>\n\n<pre><code>invalid operands to binary expression ('FILE'\n      (aka 'struct __sFILE') and 'FILE'\n if(*(data1+i)==*(data2+i) &amp;&amp; data3[i]!=data1[i])\n</code></pre>\n\n<p>my Code is </p>\n\n<pre><code>int main(int argc, char** argv){\n  FILE *data1, *data2, *data3;\n\n  data1=fopen(argv[2], \"r\");\n  data2=fopen(argv[3], \"r\");\n  data3=fopen(argv[4], \"r\");\n\n  int c1=0; int c2=0; int c3=0; int unkown=0;\n\n  for(int i=0; i&lt;argc; i++){\n    if(*(data1+i)==*(data2+i) &amp;&amp; data3[i]!=data1[i])\n      c3++;\n    if(data1[i]==data3[i] &amp;&amp; data2[i]!=data1[i])\n      c2++;\n    if(data3[i]==data2[i] &amp;&amp; data1[i]!=data2[i])\n      c1++;\n    if(data1[i]!=data2[i] &amp;&amp; data1[i]!=data3[i] &amp;&amp; data3[i]!=data2[i])\n      unkown++;\n  }\n  printf(\"Data1 has %d possible bad values\\nData2 has %d possible bad values\\nData3 has %d possible bad values\\nThere are %d unkown cases\\n\", c1, c2, c3, unkown);\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "kernel"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1576008068, "post_id": 59273880, "comment_id": 104756124, "body": "Could something else be calling <code>init_module()</code> between writes?"}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1576008521, "post_id": 59273880, "comment_id": 104756310, "body": "Note: the <code>try_module_put</code> should be handled by setting the owner field; then the VFS will take care of holding a reference to the module"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1576009104, "post_id": 59273880, "comment_id": 104756554, "body": "Please, add the log into the <b>question post</b> itself, as <i>text</i>. You may format inserted log in the same way as a code."}, {"owner": {"reputation": 77, "user_id": 7231624, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LaAF1Z6ceec/AAAAAAAAAAI/AAAAAAAAKx0/MIi37xgnvZs/photo.jpg?sz=128", "display_name": "Surya K", "link": "https://stackoverflow.com/users/7231624/surya-k"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1576009657, "post_id": 59273880, "comment_id": 104756776, "body": "@Barmar I don&#39;t think anything else is calling it. I have a test file and I am using it to test output. It calls read directly after write."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1576012707, "post_id": 59273880, "comment_id": 104757997, "body": "Probably not related to your problem but you have a memory leak in <code>device_read</code>. <code>msgTemp</code> is allocated memory but then the function either exits on error or overwrite <code>msgTemp</code> with <code>pop</code> results. <code>device_write</code> also has memory leaks as it does not free in error paths."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1576012795, "post_id": 59273880, "comment_id": 104758029, "body": "&quot;top&quot; pointer of my stack becomes null at the starting of device_write&quot;. Do you mean <code>device_read</code> and not <code>device_write</code> there?"}, {"owner": {"reputation": 77, "user_id": 7231624, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LaAF1Z6ceec/AAAAAAAAAAI/AAAAAAAAKx0/MIi37xgnvZs/photo.jpg?sz=128", "display_name": "Surya K", "link": "https://stackoverflow.com/users/7231624/surya-k"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1576025678, "post_id": 59273880, "comment_id": 104761798, "body": "@kaylum Yes, in my device_read it&#39;s happening. Not device_read. Edited my question. Thank you for noticing it."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1576026174, "post_id": 59273880, "comment_id": 104761906, "body": "May want to check the return value of <code>kmalloc</code> in <code>push</code> in case it is returning NULL for some reason. Also, not sure why you are using GFP_USER for internal data structures."}, {"owner": {"reputation": 77, "user_id": 7231624, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LaAF1Z6ceec/AAAAAAAAAAI/AAAAAAAAKx0/MIi37xgnvZs/photo.jpg?sz=128", "display_name": "Surya K", "link": "https://stackoverflow.com/users/7231624/surya-k"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1576027168, "post_id": 59273880, "comment_id": 104762130, "body": "@kaylum kmalloc is not returning null but I used GFP_USER because I wasn&#39;t sure of which to use. What would be the correct flag?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1576027785, "post_id": 59273880, "comment_id": 104762274, "body": "I suspect you have a buffer overflow in some other code, and it&#39;s overwriting <code>top</code>."}], "owner": {"reputation": 77, "user_id": 7231624, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LaAF1Z6ceec/AAAAAAAAAAI/AAAAAAAAKx0/MIi37xgnvZs/photo.jpg?sz=128", "display_name": "Surya K", "link": "https://stackoverflow.com/users/7231624/surya-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1513, "favorite_count": 1, "answer_count": 0, "score": 5, "last_activity_date": 1607460231, "creation_date": 1576005085, "last_edit_date": 1576027416, "question_id": 59273880, "link": "https://stackoverflow.com/questions/59273880/read-and-write-to-char-device-in-linux", "title": "Read and Write to Char Device in Linux", "body": "<p><strong>EDITED</strong> Previously I said it became null at device_write but it's actually\ndevice_read.</p>\n\n<p>I am trying to write a simple program which read and writes to the character device. The problem I have is \"top\" pointer of my stack becomes null at the starting of device_read somehow even though \"push\" is working properly.</p>\n\n<p>This is my stack declaration.</p>\n\n<pre><code>static struct Node {\n    char* data;\n    struct Node *next;\n};\n</code></pre>\n\n<p>This is my full charDeviceDriver.c code</p>\n\n<pre><code>\n#include &lt;linux/kernel.h&gt;\n#include &lt;linux/module.h&gt;\n#include &lt;linux/fs.h&gt;\n#include &lt;asm/uaccess.h&gt;    \n#include &lt;charDeviceDriver.h&gt;\n#include&lt;linux/slab.h&gt;\n\nMODULE_LICENSE(\"GPL\");\n\n/* \n * This function is called whenever a process tries to do an ioctl on our\n * device file. We get two extra parameters (additional to the inode and file\n * structures, which all device functions get): the number of the ioctl called\n * and the parameter given to the ioctl function.\n *\n * If the ioctl is write or read/write (meaning output is returned to the\n * calling process), the ioctl call returns the output of this function.\n *\n */\n\n\nDEFINE_MUTEX  (devLock);\n\nstatic int counter = 0;\nint size = 0;\nstruct Node* top;\n\n\n\n/*\n * This function is called when the module is loaded\n */\nint init_module(void)\n{\n    Major = register_chrdev(0, DEVICE_NAME, &amp;fops);\n\n    if (Major &lt; 0) {\n      printk(KERN_ALERT \"Registering char device failed with %d\\n\", Major);\n      return Major;\n    }\n\ntop = NULL;\n\n    printk(KERN_INFO \"I was assigned major number %d. To talk to\\n\", Major);\n    printk(KERN_INFO \"the driver, create a dev file with\\n\");\n    printk(KERN_INFO \"'mknod /dev/%s c %d 0'.\\n\", DEVICE_NAME, Major);\n    printk(KERN_INFO \"Try various minor numbers. Try to cat and echo to\\n\");\n    printk(KERN_INFO \"the device file.\\n\");\n    printk(KERN_INFO \"Remove the device file and module when done.\\n\");\n\n    return SUCCESS;\n}\n\n/*\n * This function is called when the module is unloaded\n */\nvoid cleanup_module(void)\n{\n    unregister_chrdev(Major, DEVICE_NAME);\n}\n\n/* \n * Called when a process tries to open the device file, like\n * \"cat /dev/mycharfile\"\n */\nstatic int device_open(struct inode *inode, struct file *file)\n{\n\n    mutex_lock (&amp;devLock);\n    if (Device_Open) {\n    mutex_unlock (&amp;devLock);\n    return -EBUSY;\n    }\n    Device_Open++;\n    mutex_unlock (&amp;devLock);\n    sprintf(msg, \"I already told you %d times Hello world!\\n\", counter++);\n    msg_Ptr = msg;\n    try_module_get(THIS_MODULE);\n\n    return SUCCESS;\n}\n\n/* Called when a process closes the device file. */\nstatic int device_release(struct inode *inode, struct file *file)\n{\n    empty();\n    mutex_lock (&amp;devLock);\n    Device_Open--;      /* We're now ready for our next caller */\n    mutex_unlock (&amp;devLock);\n    /* \n     * Decrement the usage count, or else once you opened the file, you'll\n     * never get get rid of the module. \n     */\n    module_put(THIS_MODULE);\n\n    return 0;\n}\n\n/* \n * Called when a process, which already opened the dev file, attempts to\n * read from it.\n */\nstatic ssize_t device_read(struct file *filp,   /* see include/linux/fs.h   */\n               char *buffer,    /* buffer to fill with data */\n               size_t length,   /* length of the buffer     */\n               loff_t * offset)\n{\n    printk(KERN_INFO \"INSIDE DEVICE READ\\n\");\n    char* msgTemp = (char*)kmalloc(sizeof(char)*length,GFP_USER);\n\n    if(!top) {\n        printk(KERN_INFO \"TOP BEOMES NULL AT DEVICE_READ \\n\" );\n    }\n\n    if(size == 0) {\n        printk(KERN_INFO \"INSIDE DEVICE READ IF EMPTY LIST\");\n        return -EAGAIN;\n    }\n    else {\n        printk(KERN_INFO \"INSIDE DEVICE READ IF LIST NOT EMPTY\");\n        msgTemp = pop();\n        printk(KERN_INFO \"MESSAGE POPPED IS %s\", msgTemp);\n        if (copy_to_user(buffer,msgTemp,length) == 0) {\n            return length;\n        }\n    }\n\n    return 0;\n}\n\n/* Called when a process writes to dev file: echo \"hi\" &gt; /dev/hello  */\nstatic ssize_t\ndevice_write(struct file *filp, const char *buff, size_t len, loff_t * off)\n{\n    char* msgTemp = (char*)kmalloc(sizeof(char)*len,GFP_USER);\n\n    printk(KERN_ALERT \"THIS IS THE STARTING OF DEVICE WRITE.\\n\");\n\n\n    if(len &gt; 6144) {\n        printk(KERN_ALERT \"FIRST IF CONDITION.\\n\");\n        return -EINVAL;\n    }\n    else if (totalSize() + len &gt; 4 * 1024 * 1024) {\n        printk(KERN_ALERT \"SECOND IF CONDITION.\\n\");\n        return -EAGAIN;\n    }\n    else if (copy_from_user(msgTemp,buff,len) == 0) {\n        printk(KERN_ALERT \"THIRD IF CONDITION.\\n\");\n        printk(KERN_ALERT \"WRITTEN MESSAGE IS %s\",msgTemp);\n        push(msgTemp);\n        return len;\n    }\n\n    printk(KERN_ALERT \"Sorry, this operation isn't supported.\\n\");\n    return EAGAIN;\n}\n\nvoid push(char* dataS)\n{\n    // char* tempCheck;\n\n    struct Node* newNode = (struct Node*) kmalloc(sizeof(struct Node),GFP_USER);\n    newNode-&gt;data = dataS;\n    newNode-&gt;next = top;        \n    top = newNode;\n    size++;\n    printk(KERN_ALERT \"THE SIZE IS AFTER PUSHING IS %d.\\n\",size);\n    printk(KERN_ALERT \"THE MESSAGE PUSHED IS %s\\n\",dataS); \n}\n\nchar* pop()\n{\n    printk(KERN_INFO \"INSIDE POP METHOD\\n\");\n    char* dataS;\n    struct Node* topNode;\n    // Check stack underflow\n    if (size &lt;= 0 || !top)\n    {\n        printk(KERN_INFO \"INSIDE POP IF METHOD ABOUT UNDERFLOW\\n\");\n        //printf(\"Stack is empty.\\n\");\n\n        // Throw empty stack error/exception\n        // Since C does not have concept of exception\n        // Hence return minimum integer value as error value\n        // Later in code check if return value is INT_MIN, then\n        // stack is empty\n        return NULL;\n    }\n\n    topNode = top;\n    dataS = top-&gt;data;\n    top = top-&gt;next;\n    kfree(topNode);\n    size--;\n    printk(KERN_INFO \"THE ELEMENT THAT GOT POPPED IS %s\",dataS);\n    return dataS;\n}\n\n\nsize_t totalSize()\n{\n\n    struct Node* temp;\n    size_t total;\n    int i;\n    temp = top;\n\n    for(i = 0;i&lt;size;i++){\n        total += sizeof(*temp-&gt;data)/sizeof(char);\n        temp = temp -&gt; next;\n    }\n\n    return total;\n}\n\nvoid empty()\n{  \n  struct Node* cur = top;\n  struct Node* next;\n  while (cur != NULL) {\n    next = cur-&gt;next;\n    kfree(cur);\n    cur = next;\n  }\n  top = NULL;\n}\n</code></pre>\n\n<p>These are my log messages.</p>\n\n<p><a href=\"https://i.stack.imgur.com/9tI23.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9tI23.png\" alt=\"log\"></a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 3, "creation_date": 1576004692, "post_id": 59273783, "comment_id": 104754700, "body": "Don&#39;t hide stuff behind macros if your goals is readability. People reading C code don&#39;t have issues parsing normal function declarations."}, {"owner": {"reputation": 182, "user_id": 2045380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHkVI.jpg?s=128&g=1", "display_name": "Bobby Tables", "link": "https://stackoverflow.com/users/2045380/bobby-tables"}, "edited": false, "score": 4, "creation_date": 1576004700, "post_id": 59273783, "comment_id": 104754706, "body": "This is doing the opposite of making anything readable for anybody. To define your function just use void waitingfor(double seconds); Also simply wrapping a function with another function with no other logic used is a detriment to readability."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 2, "creation_date": 1576004957, "post_id": 59273783, "comment_id": 104754822, "body": "<code>WAITINGFUNC(3);</code> expands to <code>void waitingfor(3);</code>. You have to remove that <code>void</code>..."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1576005468, "post_id": 59273783, "comment_id": 104755070, "body": "Hiding important details such as the return type of a function <i>hinders</i> readability."}], "answers": [{"tags": [], "owner": {"reputation": 16676, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "is_accepted": false, "score": 5, "last_activity_date": 1576005022, "creation_date": 1576005022, "answer_id": 59273874, "question_id": 59273783, "link": "https://stackoverflow.com/questions/59273783/is-it-possible-to-define-a-function-name-with-define/59273874#59273874", "title": "Is it possible to define a function name with #define?", "body": "<p>In your code <code>WAITINGFUNC</code> expands to <code>void waitingfor</code>. This is as expected when you're declaring a function, but isn't when you're calling it. So, in <code>main</code> function, you essentially have this:</p>\n\n<pre><code>void main()\n{\n    void waitingfor(3);\n}\n</code></pre>\n\n<p>Aside from the fact that <code>main</code> <em>must</em> return <code>int</code>, not <code>void</code>, <code>void waitingfor(3);</code> is a syntax error as it doesn't mean anything. Using MACROS for function declarations isn't a bright idea and it doesn't improve the code readability in any meaningful way. You'd better stick to the normal function declaration as almost all C programmers are very good at reading and understanding most function declarations anyway.</p>\n"}], "owner": {"reputation": 61, "user_id": 12252557, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YKhXzD9GqbI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdmpB__wiEcMkMTQy_K6Wo9wDV7Bg/photo.jpg?sz=128", "display_name": "Ryuulan", "link": "https://stackoverflow.com/users/12252557/ryuulan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576012611, "creation_date": 1576004584, "last_edit_date": 1576012611, "question_id": 59273783, "link": "https://stackoverflow.com/questions/59273783/is-it-possible-to-define-a-function-name-with-define", "title": "Is it possible to define a function name with #define?", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define WAITINGFUNC void waitingfor\n\nWAITINGFUNC(double seconds)\n{\n    sleep(seconds);\n}\n\nvoid main()\n{\n    WAITINGFUNC(3);\n}\n</code></pre>\n\n<p>Is it possible to give a function name like that? About making the code readable stuff for anybody.</p>\n\n<p>Also, I got this error: <code>expected declaration specifiers or '...' before numeric constant</code>.</p>\n"}, {"tags": ["c", "arrays", "string", "struct", "segmentation-fault"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 4, "creation_date": 1576004731, "post_id": 59273753, "comment_id": 104754714, "body": "Well, you have to show <i>a lot</i> more then a single function. Each one of the pointers you dereference can be invalid, and the variable length array may not be enough fot the stack. Show enough code for others to reproduce the  error you are getting. <code>It does not seem to go out of the array bounds and memory usage seem also fine, am I missing something?</code> - your memory usage is definitely wrong, in <code>championship_array[pos]-&gt;</code> you are derefencing uninitialized pointer. Because exactly such cases are hard to spot, pointer typedefs are discouraged.Where do you think <code>championship_array[pos]</code> points?"}, {"owner": {"reputation": 6053, "user_id": 11336762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGPr6.jpg?s=128&g=1", "display_name": "Roberto Caboni", "link": "https://stackoverflow.com/users/11336762/roberto-caboni"}, "edited": false, "score": 1, "creation_date": 1576005810, "post_id": 59273753, "comment_id": 104755209, "body": "Your <code>championship_node</code> array is actually an array of pointers to <code>championship</code>. None of them is initialized."}], "answers": [{"tags": [], "owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "is_accepted": false, "score": 1, "last_activity_date": 1576006640, "last_edit_date": 1576006640, "creation_date": 1576006201, "answer_id": 59274146, "question_id": 59273753, "link": "https://stackoverflow.com/questions/59273753/segmentation-fault-when-reading-in-to-an-array/59274146#59274146", "title": "Segmentation fault when reading in to an array", "body": "<pre><code>championship_node championship_array[num_races*PLACES]; \n</code></pre>\n\n<p>Since <code>championship_node</code> is an alias for a <strong>pointer</strong> type you're declaring an array of pointers here. None of them is initialised; none of them points to a valid object.</p>\n\n<p>Thus when you use / dereference one of these you get undefined behavior; in your case a segmentation fault.</p>\n\n<p>Normally I make suggestions on how to fix the issue ... but I'm not sure here what you wanted to achieve (the print function isn't printing after all?).  You could either use <code>championship</code> instead to have an variable size array of such objects on the stack or allocate memory using <code>malloc</code> to initialise the pointers. </p>\n"}], "owner": {"reputation": 25, "user_id": 12352431, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eROS7U5k0Gw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrRQ9SfvCsSC6ngwLBN339e7Z_uQ/photo.jpg?sz=128", "display_name": "Filip Mi\u010d&#225;nek", "link": "https://stackoverflow.com/users/12352431/filip-mi%c4%8d%c3%a1nek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1576010574, "creation_date": 1576004422, "last_edit_date": 1576010574, "question_id": 59273753, "link": "https://stackoverflow.com/questions/59273753/segmentation-fault-when-reading-in-to-an-array", "title": "Segmentation fault when reading in to an array", "body": "<p>I have this function for printing results. Now, I am trying to store names in to the array of structs, but for some reason I am getting a segmentation fault. According to debbuger the segmentation error occurs at the first entry when <code>pos</code> is still 0;</p>\n\n<p>When I try to print the <code>name</code> from <code>races</code> it displays as expected.</p>\n\n<pre><code>race_node print_championship(race_node *races, int num_races, member_node tree_top) {\n\n    championship_node championship_array[num_races*PLACES];\n    int pos=0;\n    for (int i = 0; i &lt; num_races; i++) {\n        for (int j = 0; j &lt; PLACES; j++) {\n            strcpy(championship_array[pos]-&gt;name, races[i]-&gt;rd_arr[j].name);\n            pos++;\n        }\n    }\n}\n</code></pre>\n\n<p>structs definitions:</p>\n\n<pre><code>typedef struct race_details * race_details_node;\ntypedef struct race * race_node;\ntypedef struct championship * championship_node;\n\ntypedef struct race{\n    char date[DATE];\n    char race_date[RACE_DATE];\n    int boats_num;\n    struct race_details * rd_arr;\n\n}race;\n\ntypedef struct race_details{\n    int mem_id;\n    int points;\n    char boat_class[BOAT_CLASS];\n    char name[NAME];\n    int time;\n\n}race_details;\n\ntypedef struct championship{\n    int total_points;\n    char boat_name[BOAT_NAME];\n    char name[NAME];\n\n}championship;\n</code></pre>\n\n<p>It does not seem to go out of the array bounds and memory usage seem also fine, am I missing something?</p>\n"}, {"tags": ["c", "int", "sizeof"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 12, "creation_date": 1576003863, "post_id": 59273622, "comment_id": 104754373, "body": "<code>6.5</code> is not a float, it&#39;s a <code>double</code>"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1576003957, "post_id": 59273622, "comment_id": 104754405, "body": "<code>printf(&quot;%d&quot;,sizeof(6.5f));</code> to make it a <code>float</code>."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 2, "creation_date": 1576004162, "post_id": 59273622, "comment_id": 104754488, "body": "&quot;why the output is differen0t here?&quot; why it should be the same? The fact that you can assign one to another does not mean they have exactly the same type."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 5, "creation_date": 1576004358, "post_id": 59273622, "comment_id": 104754577, "body": "The format specifier should be, for example, <code>printf(&quot;%zu&quot;, sizeof(6.5));</code>"}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 8, "last_activity_date": 1576004717, "last_edit_date": 1576004717, "creation_date": 1576003901, "answer_id": 59273641, "question_id": 59273622, "link": "https://stackoverflow.com/questions/59273622/why-is-the-size-of-the-data-type-different-when-the-value-is-directly-passed-to/59273641#59273641", "title": "Why is the size of the data type different when the value is directly passed to the sizeof operator?", "body": "<p>Character constants in C (opposite to C++) have the type <code>int</code>. So this call </p>\n\n<pre><code>printf(\"%d\",sizeof('A'));\n</code></pre>\n\n<p>outputs 4. That is <code>sizeof( 'A' )</code> is equal to <code>sizeof( int )</code>.</p>\n\n<p>From the C Standard (6.4.4.4 Character constants)</p>\n\n<blockquote>\n  <p>10 <strong>An integer character constant has type int</strong>....</p>\n</blockquote>\n\n<p>On the other hand (6.5.3.4  The sizeof and alignof operators)</p>\n\n<blockquote>\n  <p>4 When sizeof is applied to an operand that has type char, unsigned\n  char, or signed char, (or a quali\ufb01ed version thereof) the result is 1.</p>\n</blockquote>\n\n<p>So the operand of the <code>sizeof</code> operator in this expression <code>sizeof( 'A' )</code> has the type int while in this expression <code>sizeof( a )</code> where a is declared like</p>\n\n<pre><code>char a = 'A';\n</code></pre>\n\n<p>the operand has the type <code>char</code>.</p>\n\n<p>Pay attention to that calls like this</p>\n\n<pre><code>printf(\"%d\",sizeof(6.5));\n</code></pre>\n\n<p>use incorrect conversion format specifier. You have to write</p>\n\n<pre><code>printf(\"%zu\",sizeof(6.5));\n</code></pre>\n\n<p>Also in the above call there is used a constant of the type <code>double</code> while in this call</p>\n\n<pre><code>printf(\"%zu\",sizeof(c));\n</code></pre>\n\n<p>the variable <code>c</code> has the type <code>float</code>.</p>\n\n<p>You could get the same result for these calls if the first call used a constant of the type float like</p>\n\n<pre><code>printf(\"%zu\",sizeof(6.5f));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 18, "last_activity_date": 1576005390, "last_edit_date": 1576005390, "creation_date": 1576003962, "answer_id": 59273653, "question_id": 59273622, "link": "https://stackoverflow.com/questions/59273622/why-is-the-size-of-the-data-type-different-when-the-value-is-directly-passed-to/59273653#59273653", "title": "Why is the size of the data type different when the value is directly passed to the sizeof operator?", "body": "<p>Constants, like variables, have a type of their own:</p>\n\n<ul>\n<li><code>6.5</code>   : A floating point constant of type <code>double</code></li>\n<li><code>90000</code> : An integer constant of type <code>int</code> (if <code>int</code> is 32 bits) or <code>long</code> (if <code>int</code> is 16 bits)</li>\n<li><code>'A'</code>   : A character constant of type <code>int</code> in C and <code>char</code> in C++</li>\n</ul>\n\n<p>The sizes that are printed are the sizes of the above types.</p>\n\n<p>Also, the result of the <code>sizeof</code> operator has type <code>size_t</code>.  So when printing the proper format specifier to use is <code>%zu</code>, not <code>%d</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 1, "last_activity_date": 1576068838, "creation_date": 1576068838, "answer_id": 59286310, "question_id": 59273622, "link": "https://stackoverflow.com/questions/59273622/why-is-the-size-of-the-data-type-different-when-the-value-is-directly-passed-to/59286310#59286310", "title": "Why is the size of the data type different when the value is directly passed to the sizeof operator?", "body": "<p>Because the values don't matter to <code>sizeof</code>. It's the size of the types.</p>\n\n<ul>\n<li><p>character constants are <code>int</code>s, not <code>char</code>s.</p></li>\n<li><p>floating-point constants are by default <code>double</code>s unless you suffix them with <code>f</code> or <code>l</code>.</p></li>\n</ul>\n"}], "owner": {"reputation": 187, "user_id": 11806802, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OD7b179xLy8/AAAAAAAAAAI/AAAAAAAAAGg/aa1NX-BH09U/photo.jpg?sz=128", "display_name": "j s", "link": "https://stackoverflow.com/users/11806802/j-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 867, "favorite_count": 0, "accepted_answer_id": 59273641, "answer_count": 3, "score": 15, "last_activity_date": 1576069374, "creation_date": 1576003788, "last_edit_date": 1576069374, "question_id": 59273622, "link": "https://stackoverflow.com/questions/59273622/why-is-the-size-of-the-data-type-different-when-the-value-is-directly-passed-to", "title": "Why is the size of the data type different when the value is directly passed to the sizeof operator?", "body": "<pre><code>#include &lt;stdio.h&gt;\nint main() {\n    char a = 'A';\n    int b = 90000;\n    float c = 6.5;\n    printf(\"%d \",sizeof(6.5));\n    printf(\"%d \",sizeof(90000));\n    printf(\"%d \",sizeof('A'));\n    printf(\"%d \",sizeof(c));\n    printf(\"%d \",sizeof(b));\n    printf(\"%d\",sizeof(a));\n    return 0;\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>8 4 4 4 4 1\n</code></pre>\n\n<p>Why is the output different for the same values?</p>\n"}]