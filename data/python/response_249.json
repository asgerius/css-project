[{"tags": ["python", "python-decorators", "jit", "pypy"], "owner": {"reputation": 18268, "user_id": 5218354, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-NEO9rZKeffY/AAAAAAAAAAI/AAAAAAAAAKc/9IttO1jUOr4/photo.jpg=k-s128", "display_name": "norok2", "link": "https://stackoverflow.com/users/5218354/norok2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1571270633, "creation_date": 1571269507, "last_edit_date": 1571270633, "question_id": 58423020, "link": "https://stackoverflow.com/questions/58423020/how-to-run-a-single-python-function-using-pypy-from-a-cpython-interpreter", "title": "How to run a single Python function using Pypy from a CPython interpreter?", "body": "<p>Is it possible to run a single Python function (or module) using Pypy from a CPython interpreter?</p>\n\n<p>I imagine some use-case similar to a Numba decorator e.g.:</p>\n\n<pre><code>@pypy\ndef elem_sum(*containers):\n    for items in zip(*containers):\n        yield sum(items)\n</code></pre>\n\n<p>but enjoying the much wider support for Python code that Pypy has compared to Numba.</p>\n\n<p>This is somewhat discussed <a href=\"https://stackoverflow.com/questions/15878223/forcing-modules-to-run-in-pypy-from-a-cpython-script-run-pypy-on-part-of-the-co\">here</a>, but some 6 years ago, and at a multiprocessing level, where this may not be generally efficient.\nAlso the interaction method proposed in the answer, <a href=\"https://github.com/pytest-dev/execnet\" rel=\"nofollow noreferrer\"><code>execnet</code></a>, is deprecated. <a href=\"https://pypi.org/project/Pyro5/\" rel=\"nofollow noreferrer\"><code>Pyro5</code></a> seems to be a modern alternative to <code>execnet</code> (which would still promote execution at multiprocessing level).</p>\n"}, {"tags": ["python", "list", "text-files"], "comments": [{"owner": {"reputation": 9070, "user_id": 6817835, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/8GBAa.jpg?s=128&g=1", "display_name": "gold_cy", "link": "https://stackoverflow.com/users/6817835/gold-cy"}, "edited": false, "score": 0, "creation_date": 1571269936, "post_id": 58423016, "comment_id": 103188327, "body": "it looks like a tab character so you should split the line on that character"}, {"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 1, "creation_date": 1571270072, "post_id": 58423016, "comment_id": 103188347, "body": "Should you be doing <code>split(&#39;\\t&#39;)</code> as the <code>---&gt;</code> might be your editor&#39;s way of displaying tabs?"}, {"owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1571270336, "post_id": 58423016, "comment_id": 103188387, "body": "Instead of <code>lst = list(map(int,line.strip(&#39;\\n&#39;).strip(&#39;t&#39;).split(&#39;,&#39;)))</code>, try <code>lst = [int(number) for number in line.split(&quot;\\t&quot;)]</code>. As others have mentioned <code>\\t</code> is an escape sequence for the tab character. I&#39;ve also replace you <code>map</code> with a list comprehension which is the ore standard way to do this in Python. You also need some outer list that you append to i.e. <code>outer_list.append(lst)</code> in your loop and be sure to initialise it as <code>outer_list = []</code> <i>before</i> your loop."}, {"owner": {"reputation": 27, "user_id": 10234375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1f57c3dbd86a6be843d6e030c5409d?s=128&d=identicon&r=PG&f=1", "display_name": "tyc_8991", "link": "https://stackoverflow.com/users/10234375/tyc-8991"}, "edited": false, "score": 0, "creation_date": 1571271760, "post_id": 58423016, "comment_id": 103188657, "body": "It works! Thank you all very much"}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1571277850, "post_id": 58423016, "comment_id": 103189838, "body": "@Dan: <code>map</code> is perfectly standard; as what is admittedly an opinion I\u2019d even call it preferable to introducing a variable name that could be, but isn\u2019t, used in a non-trivial way.  If you want a list comprehension, use it for the outer list and avoid the loop entirely."}], "answers": [{"tags": [], "owner": {"reputation": 762, "user_id": 12460195, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBJYch5CXM_Hy0GBMYApqmXAEGb3dEegfJsNgUt=k-s128", "display_name": "Ali Hasan Ahmed Khan", "link": "https://stackoverflow.com/users/12460195/ali-hasan-ahmed-khan"}, "is_accepted": false, "score": 0, "last_activity_date": 1591181439, "creation_date": 1591181439, "answer_id": 62171063, "question_id": 58423016, "link": "https://stackoverflow.com/questions/58423016/putting-integers-into-a-list-from-a-text-file/62171063#62171063", "title": "Putting integers into a list from a text file", "body": "<p>You can use regex to achieve your expected output.</p>\n\n<pre><code>import re\nfile1 = open(\"names_file.txt\", \"r\")\nl = file1.readlines()\nnew_list = []\nfor i in l:\n    m = re.findall(r'\\d+', i)\n    new_list.append(m)\nprint(new_list)\n</code></pre>\n\n<p>Above code will give a list containing strings, if you want to convert it into integer type then add this code. This will give your expected output.</p>\n\n<pre><code>for j in range(len(new_list)):\n    for k in range(2):\n        new_list[j][k] = int(new_list[j][k])\nprint(new_list)\n</code></pre>\n\n<p>There are two print statement in above code one will give list of list of string, and after conversion it will give list of list of integers.\n<a href=\"https://i.stack.imgur.com/aGvhJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aGvhJ.png\" alt=\"Output\"></a></p>\n"}], "owner": {"reputation": 27, "user_id": 10234375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1f57c3dbd86a6be843d6e030c5409d?s=128&d=identicon&r=PG&f=1", "display_name": "tyc_8991", "link": "https://stackoverflow.com/users/10234375/tyc-8991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1591181439, "creation_date": 1571269454, "last_edit_date": 1571272640, "question_id": 58423016, "link": "https://stackoverflow.com/questions/58423016/putting-integers-into-a-list-from-a-text-file", "title": "Putting integers into a list from a text file", "body": "<p>I have a text file and I need to put the numbers in this file into a list like this: <code>[[123,456],[234,567],[345,678]...]</code> but I don't know how to do this as I ran into some error messages shown below.</p>\n\n<p>My text file looks something like this (the <code>--&gt;</code> are arrows in the original text file, but I don't know what they look like if I read the file using <code>with open</code>:</p>\n\n<pre><code># These are the ids for blablabla\n# put the ids into a list like this [[123,456],[234,567],[345,678]...]\n#id1 --&gt; id2\n#123 --&gt; 456\n#234 --&gt; 567\n#345 --&gt; 678\n#456 --&gt; 789\n</code></pre>\n\n<p>What I tried to do initially was</p>\n\n<pre><code>with open('mytxt.txt', 'r') as f:\n    for line in range(3):\n        next(f)\n    for line in f:\n        lst = list(map(int,line.split(',')))\n        print(lst)[:10]\n</code></pre>\n\n<p>After running this, I got an error message <code>&lt;!-- language: lang-js --&gt; invalid literal for int() with base 10: '123\\t456\\n'</code> so I thought about stripping the <code>'\\n'</code> and the <code>'t'</code> at the end of each line by running the following code:</p>\n\n<pre><code>with open('ca-GrQc.txt', 'r') as f:\n    for line in range(4):\n        next(f)\n    for line in f:\n        lst = list(map(int,line.strip('\\n').strip('t').split(',')))\n        print(lst)[:10]\n</code></pre>\n\n<p>After running that I still got an error message <code>invalid literal for int() with base 10: '123\\t456'</code> which I have no idea where the <code>'t'</code> comes from (and I am sure that <code>'t'</code> was not in the orginal file).</p>\n\n<p><strong>Does anyone know why that happens and how to solve it, or is there a more efficient way of putting the numbers from the text file into a list?</strong></p>\n"}, {"tags": ["python", "gmail-api"], "comments": [{"owner": {"reputation": 92215, "user_id": 1832058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/relWs.jpg?s=128&g=1", "display_name": "furas", "link": "https://stackoverflow.com/users/1832058/furas"}, "edited": false, "score": 0, "creation_date": 1571269766, "post_id": 58423007, "comment_id": 103188286, "body": "maybe text is not in <code>UTF-8</code> but in <code>Latin1</code>, <code>cp1250</code> (popular in Windows) or other encoding. For example <code>b&#39;\\x89&#39;.decode(&#39;cp1250&#39;)</code> gives me <code>\u2030</code> - per mille sign. Wikipedia: <a href=\"https://en.wikipedia.org/wiki/Per_mille\" rel=\"nofollow noreferrer\">Per mille</a>"}, {"owner": {"reputation": 637, "user_id": 2471539, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/JRpBB.jpg?s=128&g=1", "display_name": "Norman Benbrahim", "link": "https://stackoverflow.com/users/2471539/norman-benbrahim"}, "reply_to_user": {"reputation": 92215, "user_id": 1832058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/relWs.jpg?s=128&g=1", "display_name": "furas", "link": "https://stackoverflow.com/users/1832058/furas"}, "edited": false, "score": 0, "creation_date": 1571271964, "post_id": 58423007, "comment_id": 103188701, "body": "@furas I&#39;ve tried 10 different encodings so far, nothing works"}, {"owner": {"reputation": 92215, "user_id": 1832058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/relWs.jpg?s=128&g=1", "display_name": "furas", "link": "https://stackoverflow.com/users/1832058/furas"}, "edited": false, "score": 0, "creation_date": 1571273226, "post_id": 58423007, "comment_id": 103188957, "body": "error shows problem with code <code>0x89</code> which exists in <code>cp1250</code> so you should start with this encoding. And some messages can use <code>cp1250</code>, other <code>utf-8</code> and other different encoding so you can&#39;t use one encoding for all messages. You should use `try/except with different encodings till you get result. And if you don&#39;t get result then you should print this message to check it directly in Gmail - maybe it can show what ending it uses."}, {"owner": {"reputation": 92215, "user_id": 1832058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/relWs.jpg?s=128&g=1", "display_name": "furas", "link": "https://stackoverflow.com/users/1832058/furas"}, "edited": false, "score": 0, "creation_date": 1571273458, "post_id": 58423007, "comment_id": 103188995, "body": "you use UTF-8 in different places so you should show full error message to see which one makes problem. always put full error message (starting at word &quot;Traceback&quot;) in question (not comment) as text (not screenshot). There are other useful information."}], "owner": {"reputation": 637, "user_id": 2471539, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/JRpBB.jpg?s=128&g=1", "display_name": "Norman Benbrahim", "link": "https://stackoverflow.com/users/2471539/norman-benbrahim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571269352, "creation_date": 1571269352, "question_id": 58423007, "link": "https://stackoverflow.com/questions/58423007/get-message-and-then-send-to-another-email-using-gmail-api-with-python", "title": "Get message and then send to another email using Gmail API with Python", "body": "<p>I'm following the advice on <a href=\"https://stackoverflow.com/questions/30995341/forward-mail-using-gmail-api\">this thread</a> to set up bulk forwarding using Python. I'm trying to search for messages in the inbox with specific keywords, get the message IDs of those messages, and send those messages to a different person.</p>\n\n<p>The search and getting IDs part works fine. Here's the code:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>def search_message(service, user_id, search_string):\n    # initiate the list for returning\n    list_ids = []\n\n    # get the id of all messages that are in the search string\n    search_ids = service.users().messages().list(userId=user_id, q=search_string).execute()\n\n    # if there were no results, print warning and return empty string\n    try:\n        ids = search_ids['messages']\n\n    except KeyError:\n        print(\"WARNING: the search queried returned 0 results\")\n        print(\"returning an empty string\")\n        return \"\"\n\n    if len(ids)&gt;1:\n        for msg_id in ids:\n            list_ids.append(msg_id['id'])\n        return(list_ids)\n\n    else:\n        list_ids.append(ids['id'])\n        return list_ids\n</code></pre>\n\n<p>It's when I try to send a message that things get hairy. I'm testing this on a single message ID at the moment, and here's what I've tried:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>message_raw = service.users().messages().get(userId=user_id, id=msg_id,format='raw').execute()\nmessage_full = service.users().messages().get(userId=\"me\", id=msg_id, format=\"full\", metadataHeaders=None).execute()\n\n## get the subject line\nmsg_header = message_full['payload']['headers']\n\n# this is a little faster then a loop\nsubj = [i['value'] for i in msg_header if i[\"name\"]==\"Subject\"]\nsubject = subj[0] \n\nmsg_str = base64.urlsafe_b64decode(message_raw['raw'].encode('UTF-8'))\nmsg_bytes = email.message_from_bytes(msg_str)\n\n# get content type for msg\ncontent_type = msg_bytes.get_content_maintype()\n\nif content_type == 'multipart':\n    # there will usually be 2 parts: the first will be the body as a raw string,\n    # the second will be the body as html\n    parts = msg_bytes.get_payload()\n\n    # return the encoded text\n    send_string = parts[0].get_payload()\n\n    # force utf-8 encoding on the string\n    send_string = send_string.encode('utf-8').decode('utf-8')\n\n# now that we have the body in raw string, we will build a new mime object and\n# send it via gmail\nfinal_message = MIMEText(send_string)\n\n# set send-to and subject line in the msg\nfinal_message['to'] = to\nfinal_message['subject'] = subject\nfinal_message['from'] = 'tradethenewsapi@gmail.com'\n\n# turn back into raw format and return\nraw = base64.urlsafe_b64decode(final_message.as_bytes())\nbody = {'raw': raw}\n</code></pre>\n\n<p>However, when I go to send the actual email (as <a href=\"https://github.com/googleapis/google-api-python-client/issues/93\" rel=\"nofollow noreferrer\">this thread</a> suggests), </p>\n\n<pre class=\"lang-py prettyprint-override\"><code>message_sent = (service.users().messages().send(userId='me', body=body).execute())\n</code></pre>\n\n<p>I keep getting this error</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte\n</code></pre>\n\n<p>No matter what I do to <code>search_string</code>, it won't work and keeps giving me the unicode error. </p>\n"}, {"tags": ["python", "selenium", "web-scraping", "dynamic"], "comments": [{"owner": {"reputation": 92215, "user_id": 1832058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/relWs.jpg?s=128&g=1", "display_name": "furas", "link": "https://stackoverflow.com/users/1832058/furas"}, "edited": false, "score": 0, "creation_date": 1571270526, "post_id": 58422998, "comment_id": 103188420, "body": "use <code>find_elements_by_class_name(&quot;jobtitle&quot;)</code>"}, {"owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "edited": false, "score": 0, "creation_date": 1571281319, "post_id": 58422998, "comment_id": 103190486, "body": "Simply you have to replace the spaces between class names with <code>.</code>, find more explanation in my answer below."}], "answers": [{"tags": [], "owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "is_accepted": false, "score": 0, "last_activity_date": 1571272446, "creation_date": 1571272446, "answer_id": 58423331, "question_id": 58422998, "link": "https://stackoverflow.com/questions/58422998/selenium-python-find-elements-by-class-name-returns-nothing/58423331#58423331", "title": "Selenium Python | &#39;find_elements_by_class_name&#39; returns nothing", "body": "<p>Seems like a bug?\nThis works:</p>\n\n<pre><code>jobs = driver.execute_script(\"\"\"\n  return document.getElementsByClassName(\"col-md-8 jobtitle\")\n\"\"\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 12229772, "user_type": "registered", "profile_image": "https://graph.facebook.com/2769064476450948/picture?type=large", "display_name": "Lucas Aguiar", "link": "https://stackoverflow.com/users/12229772/lucas-aguiar"}, "is_accepted": false, "score": 1, "last_activity_date": 1571288874, "last_edit_date": 1571288874, "creation_date": 1571279458, "answer_id": 58424045, "question_id": 58422998, "link": "https://stackoverflow.com/questions/58422998/selenium-python-find-elements-by-class-name-returns-nothing/58424045#58424045", "title": "Selenium Python | &#39;find_elements_by_class_name&#39; returns nothing", "body": "<p>Try:</p>\n\n<pre><code>jobs = driver.find_elements_by_xpath(\"//div[@class='col-md-8 jobtitle']/a\")\n</code></pre>\n\n<p>I've switched the find element by class for xpath, this way you have more flexibility and it generally works better, I suggest you look into it!</p>\n"}, {"comments": [{"owner": {"reputation": 34075, "user_id": 5168011, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eb70c32e1e533e7c0cb2f9317a6b2aa3?s=128&d=identicon&r=PG&f=1", "display_name": "Guy", "link": "https://stackoverflow.com/users/5168011/guy"}, "edited": false, "score": 0, "creation_date": 1571288725, "post_id": 58424200, "comment_id": 103192164, "body": "This will work, but only because the webdriver add <code>.</code> to the expression internally <a href=\"https://github.com/SeleniumHQ/selenium/blob/master/py/selenium/webdriver/remote/webdriver.py\" rel=\"nofollow noreferrer\">line 1006</a>. The uses is <code>find_element_by_class_name(&#39;col-md-8&#39;)</code> or <code>find_element_by_class_name(&#39;jobtitle&#39;)</code>, or for multiple classes use <code>css_selector</code> directly with <code>&#39;.col-md-8.jobtitle&#39;</code>"}], "tags": [], "owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "is_accepted": true, "score": 1, "last_activity_date": 1571281214, "last_edit_date": 1571281214, "creation_date": 1571280759, "answer_id": 58424200, "question_id": 58422998, "link": "https://stackoverflow.com/questions/58422998/selenium-python-find-elements-by-class-name-returns-nothing/58424200#58424200", "title": "Selenium Python | &#39;find_elements_by_class_name&#39; returns nothing", "body": "<p><strong>Root Cause:</strong></p>\n\n<p><code>col-md-8</code> and <code>jobtitle</code> are 2 different classes. When you use <code>find_element_by_class_name</code> it will internally convert the class name to a css selector and try to find the element.</p>\n\n<p>Below is the evidence where <code>find_element_by_class_name</code> uses the <code>css</code> internally.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Virxl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Virxl.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Solution:</strong></p>\n\n<p>As Selenium internally uses the <code>css</code> you have to make sure the classes are clubbed together meaning <code>class1.class2.class3</code>. In simple terms <code>replace all white spaces with single dot</code> in the class name from UI.</p>\n\n<p><strong>How to implement this to your situation:</strong></p>\n\n<p>You have to use the below syntax.</p>\n\n<pre><code>driver.find_element_by_class_name('col-md-8.jobtitle')\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11652755, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158528467195558/picture?type=large", "display_name": "Frankie Alex", "link": "https://stackoverflow.com/users/11652755/frankie-alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 964, "favorite_count": 0, "accepted_answer_id": 58424200, "answer_count": 3, "score": 1, "last_activity_date": 1571288874, "creation_date": 1571269218, "question_id": 58422998, "link": "https://stackoverflow.com/questions/58422998/selenium-python-find-elements-by-class-name-returns-nothing", "title": "Selenium Python | &#39;find_elements_by_class_name&#39; returns nothing", "body": "<p>I am trying to scrape job titles from a dynamic job listing. When I use the function find_elements_by_class_name, the function doesn't return anything. I'm new to selenium so i'm not sure if i'm simply doing something incorrectly or misunderstanding the functionality. </p>\n\n<p>The page im trying to scrape is: <a href=\"https://recruit.hirebridge.com/v3/CareerCenter/v2/?cid=7724\" rel=\"nofollow noreferrer\">https://recruit.hirebridge.com/v3/CareerCenter/v2/?cid=7724</a></p>\n\n<pre><code>from selenium import webdriver\nimport time\n\n#define the path for the chrome webdriver\nchrome_path = r\"C:/web/jobListing/chromedriver.exe\"\n\n#create a instance of the webdriver\ndriver = webdriver.Chrome(chrome_path)\n\ndriver.get(\"https://recruit.hirebridge.com/v3/CareerCenter/v2/?cid=7724\")\ntime.sleep(10)\njobs = driver.find_elements_by_class_name(\"col-md-8 jobtitle\")\n\nprint(\"starting print\")\nfor job in jobs:\n    print(job.text)\n</code></pre>\n"}, {"tags": ["python", "pivot-table", "data-science", "crosstab"], "comments": [{"owner": {"reputation": 86481, "user_id": 2411802, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/RA92x.jpg?s=128&g=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/2411802/alexander"}, "edited": false, "score": 0, "creation_date": 1571269970, "post_id": 58422965, "comment_id": 103188332, "body": "<code>df.loc[:, &#39;B&#39;]</code> Also, what do you mean by &quot;How can I do&quot;? Do what?  Given the image, I assume select all columns for <code>B</code>."}], "answers": [{"tags": [], "owner": {"reputation": 86481, "user_id": 2411802, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/RA92x.jpg?s=128&g=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/2411802/alexander"}, "is_accepted": false, "score": 1, "last_activity_date": 1571290921, "last_edit_date": 1571290921, "creation_date": 1571270351, "answer_id": 58423101, "question_id": 58422965, "link": "https://stackoverflow.com/questions/58422965/multi-indexed-row-and-columns/58423101#58423101", "title": "Multi-indexed row and columns", "body": "<p><a href=\"https://pandas.pydata.org/pandas-docs/stable/user_guide/advanced.html#advanced-indexing-with-hierarchical-index\" rel=\"nofollow noreferrer\">https://pandas.pydata.org/pandas-docs/stable/user_guide/advanced.html#advanced-indexing-with-hierarchical-index</a></p>\n\n<pre><code>import pandas as pd  # Pandas isn't mentioned in the tags, but the image looks like a pandas dataframe.\n\nidx = pd.MultiIndex.from_product([[f'System {s}' for s in 'ABC'], list('FM')], names=[None, 'Sex'])\ncols = pd.MultiIndex.from_tuples([('A', 1), ('A', 2), ('B', 1), ('B', 2), ('B', 3), ('C', 1), ('C', 2)])\ndf = pd.DataFrame(data=1, columns=cols, index=idx)\n\n&gt;&gt;&gt; df\n              A     B        C   \n              1  2  1  2  3  1  2\n         Sex                     \nSystem A F    1  1  1  1  1  1  1\n         M    1  1  1  1  1  1  1\nSystem B F    1  1  1  1  1  1  1\n         M    1  1  1  1  1  1  1\nSystem C F    1  1  1  1  1  1  1\n         M    1  1  1  1  1  1  1\n\n&gt;&gt;&gt; df.loc[:, 'B']\n              1  2  3\n         Sex         \nSystem A F    1  1  1\n         M    1  1  1\nSystem B F    1  1  1\n         M    1  1  1\nSystem C F    1  1  1\n         M    1  1  1\n</code></pre>\n\n<p>Or using IndexSlice.</p>\n\n<pre><code>&gt;&gt;&gt; df.loc[:, pd.IndexSlice['B', :]]\n              B      \n              1  2  3\n         Sex         \nSystem A F    1  1  1\n         M    1  1  1\nSystem B F    1  1  1\n         M    1  1  1\nSystem C F    1  1  1\n         M    1  1  1\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12229441, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB2ZepiJjmhr_Yopx3r87d1nE8xced2mHmMfV7j8w=k-s128", "display_name": "Vic", "link": "https://stackoverflow.com/users/12229441/vic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571290921, "creation_date": 1571268942, "last_edit_date": 1571269288, "question_id": 58422965, "link": "https://stackoverflow.com/questions/58422965/multi-indexed-row-and-columns", "title": "Multi-indexed row and columns", "body": "<p>How can I do multi index of rows and columns in python?</p>\n\n<p><img src=\"https://i.stack.imgur.com/avpw0.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["python", "numpy", "integer", "2d", "numpy-ndarray"], "comments": [{"owner": {"reputation": 11092, "user_id": 3066077, "user_type": "registered", "profile_image": "https://graph.facebook.com/1666991815/picture?type=large", "display_name": "DarrylG", "link": "https://stackoverflow.com/users/3066077/darrylg"}, "edited": false, "score": 3, "creation_date": 1571269363, "post_id": 58422957, "comment_id": 103188188, "body": "np.zeros((10, 10), dtype = int)  <a href=\"https://www.geeksforgeeks.org/numpy-zeros-python/\" rel=\"nofollow noreferrer\">from</a>"}], "answers": [{"tags": [], "owner": {"reputation": 28727, "user_id": 9959152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XSjIJ.jpg?s=128&g=1", "display_name": "Deadpool", "link": "https://stackoverflow.com/users/9959152/deadpool"}, "is_accepted": false, "score": 2, "last_activity_date": 1571269857, "last_edit_date": 1571269857, "creation_date": 1571269364, "answer_id": 58423009, "question_id": 58422957, "link": "https://stackoverflow.com/questions/58422957/how-can-i-create-a-2d-array-of-integers/58423009#58423009", "title": "How can I create a 2d array of integers?", "body": "<p>You can use <a href=\"https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.full.html\" rel=\"nofollow noreferrer\">numpy.full</a></p>\n\n<blockquote>\n  <p>numpy.full(shape, fill_value, dtype=None, order='C')</p>\n</blockquote>\n\n<pre><code>np.full((10, 10), 0, dtype=int)\n</code></pre>\n\n<p>Or <a href=\"https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.zeros.html#numpy.zeros\" rel=\"nofollow noreferrer\">numpy.zeros</a></p>\n\n<blockquote>\n  <p>numpy.zeros(shape, dtype=float, order='C')</p>\n</blockquote>\n\n<pre><code>numpy.zeros((10, 10), dtype = int)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 12174626, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PY0X0.jpg?s=128&g=1", "display_name": "Connor", "link": "https://stackoverflow.com/users/12174626/connor"}, "is_accepted": false, "score": 0, "last_activity_date": 1571270623, "creation_date": 1571270623, "answer_id": 58423130, "question_id": 58422957, "link": "https://stackoverflow.com/questions/58422957/how-can-i-create-a-2d-array-of-integers/58423130#58423130", "title": "How can I create a 2d array of integers?", "body": "<p>A line like this should also work: <code>[[0 for i in range(10)] for i in range(10)]</code></p>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 12223843, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAmTYgqdmQx2olsaOAGI5YpIZSeBdm_hRtXfXNr=k-s128", "display_name": "Yassine HAMDAOUI", "link": "https://stackoverflow.com/users/12223843/yassine-hamdaoui"}, "is_accepted": false, "score": 1, "last_activity_date": 1571274613, "creation_date": 1571274613, "answer_id": 58423550, "question_id": 58422957, "link": "https://stackoverflow.com/questions/58422957/how-can-i-create-a-2d-array-of-integers/58423550#58423550", "title": "How can I create a 2d array of integers?", "body": "<p>You can use full method </p>\n\n<pre><code>import numpy as np\narr = np.full((3,4),10) # will return a 3 X 4 array setting values to 10\n</code></pre>\n\n<p>There is also full_like , the main difference is to use the shape of  an existing array and create another with the same shape but you can put any setting value \nhere an example :\nimport numpy as np</p>\n\n<pre><code>x = np.arange(6).reshape(2,3) # so x =np.array([[1,2,3],\n                                                [4,5,6]) \n</code></pre>\n\n<p>and you want an array with the same shape (2,3) but with 10 values</p>\n\n<pre><code>arr = np.full_like(x,10) # arr=np.array([10,10,10],\n                                        [10,10,10])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 89, "user_id": 10539119, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AwfYX9TXidQ/AAAAAAAAAAI/AAAAAAAAAAc/2AA4Xm8UcFQ/photo.jpg?sz=128", "display_name": "b m gevariya", "link": "https://stackoverflow.com/users/10539119/b-m-gevariya"}, "is_accepted": false, "score": 0, "last_activity_date": 1571314071, "creation_date": 1571314071, "answer_id": 58432308, "question_id": 58422957, "link": "https://stackoverflow.com/questions/58422957/how-can-i-create-a-2d-array-of-integers/58432308#58432308", "title": "How can I create a 2d array of integers?", "body": "<p>by using \"<code>*</code>\" operator, replicate the list.<br>\n<code>np.reshape([data]*row*column, (row, column))</code>  </p>\n\n<p>in your case data = 0, row &amp; column = 10.  </p>\n\n<pre><code>np.reshape([0]*100, (10, 10))\n</code></pre>\n\n<p>applying another solution which contain loops, consume more time.</p>\n"}], "owner": {"reputation": 9, "user_id": 12032629, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCJLj_coxK9MI9KEKPd2MSgIGgdDIaQUV25ivS2qA=k-s128", "display_name": "Paroma Chatterjee", "link": "https://stackoverflow.com/users/12032629/paroma-chatterjee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1571314071, "creation_date": 1571268886, "last_edit_date": 1571270492, "question_id": 58422957, "link": "https://stackoverflow.com/questions/58422957/how-can-i-create-a-2d-array-of-integers", "title": "How can I create a 2d array of integers?", "body": "<p>How do I create a 2D array of zeros that will be stored as integers and not floats in python? <code>np.zeros((10,10))</code> creates floats.</p>\n"}, {"tags": ["python", "scikit-learn", "text-mining", "text-classification"], "comments": [{"owner": {"reputation": 7246, "user_id": 8160718, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/fFhDh.jpg?s=128&g=1", "display_name": "Gambit1614", "link": "https://stackoverflow.com/users/8160718/gambit1614"}, "edited": false, "score": 0, "creation_date": 1571297776, "post_id": 58422929, "comment_id": 103195759, "body": "Please post the complete the stack trace. Also what is <code>unique_labels</code> ?"}, {"owner": {"reputation": 65, "user_id": 7644734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c658cd0b951d66e5fac76798f122761?s=128&d=identicon&r=PG&f=1", "display_name": "rayyar", "link": "https://stackoverflow.com/users/7644734/rayyar"}, "reply_to_user": {"reputation": 7246, "user_id": 8160718, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/fFhDh.jpg?s=128&g=1", "display_name": "Gambit1614", "link": "https://stackoverflow.com/users/8160718/gambit1614"}, "edited": false, "score": 0, "creation_date": 1571312028, "post_id": 58422929, "comment_id": 103203824, "body": "hi, I already add the traceback, and about unique_labels, it is a module from multiclass sklearn to return an array with unique variables"}], "owner": {"reputation": 65, "user_id": 7644734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c658cd0b951d66e5fac76798f122761?s=128&d=identicon&r=PG&f=1", "display_name": "rayyar", "link": "https://stackoverflow.com/users/7644734/rayyar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571311962, "creation_date": 1571268745, "last_edit_date": 1571311962, "question_id": 58422929, "link": "https://stackoverflow.com/questions/58422929/sklearn-target-data-only-integer-scalars-can-be-converted-to-a-scalar-index", "title": "Sklearn Target Data - Only Integer Scalars Can be Converted to A Scalar Index", "body": "<p>I am following this <a href=\"https://scikit-learn.org/stable/auto_examples/model_selection/plot_confusion_matrix.html\" rel=\"nofollow noreferrer\">tutorial</a> to generate the plot confusion matrix, based on this data:</p>\n\n<pre><code>from sklearn.utils.multiclass import unique_labels\n\ntwenty_train = fetch_20newsgroups(subset='train', remove=('headers', 'footers', 'quotes'), shuffle=True, random_state=42)\ntwenty_test = fetch_20newsgroups(subset='test', remove=('headers', 'footers', 'quotes'), shuffle=True, random_state=42)\n\nvect = CountVectorizer()\ntrain_vect = vect.fit_transform(twenty_train.data)\ntest_vect = vect.transform(twenty_test.data)\n\nmnb_clf = MultinomialNB().fit(train_vect, twenty_train.target)\nmnb_prd = mnb_clf.predict(test_vect)\n\nplot_confusion_matrix(twenty_test.target, mnb_prd, twenty_test.target_names) \n</code></pre>\n\n<pre><code>def plot_confusion_matrix(y_true, y_pred, classes)\n    classes = classes[unique_labels(y_true, y_pred)]\n</code></pre>\n\n<p>In plot_confusion_matrix function, I have to pass the true target of test data (twenty_test.target), predicted target of test data (mnb_prd, I am using Naive Bayes Classifier), and the true target names of test data (twenty_test.target).</p>\n\n<p>However, in redefining variable classes, it returned error only integer scalars. I think I already set the passing variables right based on the tutorial, so maybe there is something that needs to be add. \nAny help appreciated. Thank you.</p>\n\n<p><strong>THE STACK TRACE</strong></p>\n\n<pre><code>Traceback (most recent call last):\n\n  File \"&lt;ipython-input-1-32abf4cde70d&gt;\", line 1, in &lt;module&gt;\n    runfile('C:/Users/Literatures/Text Mining/Exercises/text_mining_assignment.py', wdir='C:/Users/Literatures/Text Mining/Exercises')\n\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\spyder_kernels\\customize\\spydercustomize.py\", line 827, in runfile\n    execfile(filename, namespace)\n\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\spyder_kernels\\customize\\spydercustomize.py\", line 110, in execfile\n    exec(compile(f.read(), filename, 'exec'), namespace)\n\n  File \"C:/Users/Literatures/Text Mining/Exercises/text_mining_assignment.py\", line 115, in &lt;module&gt;\n    plot_confusion_matrix(twenty_test.target, mnb_prd, twenty_test.target_names, cm_mnb, 'Naive Bayes Confusion matrix')\n\n  File \"C:/Users/Literatures/Text Mining/Exercises/text_mining_assignment.py\", line 32, in plot_confusion_matrix\n    classes = classes[unique_labels(y_true, y_pred)]\n\nTypeError: only integer scalar arrays can be converted to a scalar index\n</code></pre>\n"}, {"tags": ["python"], "comments": [{"owner": {"reputation": 263603, "user_id": 674039, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/leoFi.gif?s=128&g=1", "display_name": "wim", "link": "https://stackoverflow.com/users/674039/wim"}, "edited": false, "score": 2, "creation_date": 1571268768, "post_id": 58422920, "comment_id": 103188086, "body": "Consider using <a href=\"https://en.wikipedia.org/wiki/Cron\" rel=\"nofollow noreferrer\">cron</a>"}, {"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 1, "creation_date": 1571268851, "post_id": 58422920, "comment_id": 103188098, "body": "You can also get the current time, then time.sleep() till the next multiple of 5 minutes."}], "answers": [{"tags": [], "owner": {"reputation": 377, "user_id": 11530809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JuCH7.jpg?s=128&g=1", "display_name": "Ben Rauzi", "link": "https://stackoverflow.com/users/11530809/ben-rauzi"}, "is_accepted": false, "score": 0, "last_activity_date": 1571271000, "creation_date": 1571271000, "answer_id": 58423168, "question_id": 58422920, "link": "https://stackoverflow.com/questions/58422920/run-a-script-at-specific-time-intervals/58423168#58423168", "title": "Run a script at specific time intervals", "body": "<p>I would use datetime like you have to get the difference in time (multiply to get seconds) from now to when you want to run the script and then use <code>time.sleep()</code> for that number of seconds.</p>\n\n<p><a href=\"https://www.pythoncentral.io/pythons-time-sleep-pause-wait-sleep-stop-your-code/\" rel=\"nofollow noreferrer\">https://www.pythoncentral.io/pythons-time-sleep-pause-wait-sleep-stop-your-code/</a></p>\n"}], "owner": {"reputation": 1362, "user_id": 4701426, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/859849924075240/picture?type=large", "display_name": "Saeed", "link": "https://stackoverflow.com/users/4701426/saeed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "closed_date": 1571272692, "answer_count": 1, "score": -1, "last_activity_date": 1571271000, "creation_date": 1571268605, "question_id": 58422920, "link": "https://stackoverflow.com/questions/58422920/run-a-script-at-specific-time-intervals", "closed_reason": "Duplicate", "title": "Run a script at specific time intervals", "body": "<p>How can I run some code, say every 5 minutes, at exact minutes (seconds=0). \nI know I can get the time with <code>datetime.datetime.now()</code> every second and check to see if its minutes is a multiple of 5 and seconds is equal to 0 but isn't there any other way that does not require me to check the time every second?</p>\n"}, {"tags": ["python", "pandas", "logic"], "answers": [{"tags": [], "owner": {"reputation": 4321, "user_id": 2851685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c20f3273fea79265e19e3aafd2d11aeb?s=128&d=identicon&r=PG", "display_name": "Dev Khadka", "link": "https://stackoverflow.com/users/2851685/dev-khadka"}, "is_accepted": true, "score": 1, "last_activity_date": 1572255602, "creation_date": 1572255602, "answer_id": 58588594, "question_id": 58422902, "link": "https://stackoverflow.com/questions/58422902/dynamic-assignment-of-unique-values-python/58588594#58588594", "title": "Dynamic assignment of unique values - Python", "body": "<p>Here is my solution for the question, please find the detail in comment</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import pandas as pd\nimport numpy as np\n\ndf = pd.DataFrame({\n    'Period' : [1,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,6,6],  \n    'Place' : ['CLUB','CLUB','CLUB','HOME','HOME','AWAY','AWAY','WORK','WORK','AWAY','AWAY','GOLF','GOLF','CLUB','CLUB','POOL','POOL','HOME','HOME','WORK','WORK','AWAY','AWAY','POOL','POOL','TENNIS','TENNIS'],                                \n    'Total' : [1,1,1,2,2,3,3,4,4,4,4,5,5,4,4,4,4,4,4,4,4,4,4,4,4,5,5],                            \n    'Available Group' : ['1','2','1','2','1','2','1','2','1','1','2','1','2','2','1','2','1','2','1','2','1','1','2','1','2','2','1'],                           \n    })\n\n# df to store all unique places\nuniquePlaces = pd.DataFrame(df[\"Place\"].unique(), columns=[\"Place\"])\n\n# Start stores index of df where the place appears 1st\nuniquePlaces[\"Start\"] = -1\n\n# End stores index of df where the place appears last \nuniquePlaces[\"End\"] = -1\n\ndef assign_place_label(group):\n\n    ''' Create a label column that calculates the amount of unique meetings \n        throughout the racing schedule '''\n\n    label = uniquePlaces[uniquePlaces[\"Place\"] == group.name].index[0]\n    group[\"Place Label\"] = label\n    uniquePlaces.loc[label, \"Start\"] = group.index.min()\n    uniquePlaces.loc[label, \"End\"] = group.index.max()+1\n    return group\n\ndf2 = df.groupby(\"Place\").apply(assign_place_label)\n\n\ndef calc_groups(uniquePlaces, df2):\n\n    ## group need to be changed only when a group starts or finishes\n    change_points = np.sort(uniquePlaces[[\"Start\", \"End\"]].values.ravel()).reshape(-1,1)\n\n    ## for each change points find boolean indxes for places (True if place is in use at that point)\n    inds = (change_points&gt;=uniquePlaces[\"Start\"].values) &amp; (change_points&lt;uniquePlaces[\"End\"].values)\n\n    ## all available indexes for place\n    all_ind = set(uniquePlaces.index.values+1)\n    prev_ind = np.array([0]*len(all_ind))\n\n    result = []\n    for ind in inds:\n        ## copy prev_ind where place exists\n        new_ind = prev_ind * ind\n        ## mark places with index greater than available places with -1\n        new_ind[new_ind&gt;sum(ind)] = -1\n        ## mark existing places with index 0 with -1\n        new_ind[(new_ind==0) &amp; ind] = -1\n\n        available_ind = all_ind - set(new_ind[new_ind&gt;0])\n\n        ## replace indxes marked by -1 with minimum values from available_ind\n        for i in range(len(new_ind)):\n            if new_ind[i]==-1:\n                new_ind[i] = min(available_ind)\n                available_ind.remove(new_ind[i])\n\n        result.append(new_ind)\n        prev_ind = new_ind\n\n    result = np.r_[result]\n    repeats = np.r_[change_points[1:] - change_points[:-1], [[0]]].ravel()\n\n    ## place index calculated only for change points, now fill the gap between change points\n    ## by repeating index in the gap\n    result = np.repeat(result, repeats, axis=0)\n\n    df2[\"group\"] = (result[np.arange(len(result)), df2[\"Place Label\"].values]-1)//3 + 1\n    return df2\n\n\ndf2 = calc_groups(uniquePlaces, df2)\ndf2.drop_duplicates(subset=['Period','Place'])\n</code></pre>\n\n<p><strong>Result</strong></p>\n\n<pre><code>Period   Place  Total Available Group  Place Label  group\n0        1    CLUB      1               1            0      1\n1        2    CLUB      1               2            0      1\n3        2    HOME      2               2            1      1\n5        2    AWAY      3               2            2      1\n7        3    WORK      4               2            3      2\n9        3    AWAY      4               1            2      1\n11       3    GOLF      5               1            4      2\n13       4    CLUB      4               2            0      1\n15       4    POOL      4               2            5      1\n17       4    HOME      4               2            1      1\n19       5    WORK      4               2            3      1\n21       5    AWAY      4               1            2      1\n23       5    POOL      4               1            5      1\n25       6  TENNIS      5               2            6      1\n</code></pre>\n"}], "owner": {"reputation": 556, "user_id": 10964685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbbfc3c9b4878cb5064b260dcbdd98de?s=128&d=identicon&r=PG&f=1", "display_name": "jonboy", "link": "https://stackoverflow.com/users/10964685/jonboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "accepted_answer_id": 58588594, "answer_count": 1, "score": 4, "last_activity_date": 1572255602, "creation_date": 1571268426, "question_id": 58422902, "link": "https://stackoverflow.com/questions/58422902/dynamic-assignment-of-unique-values-python", "title": "Dynamic assignment of unique values - Python", "body": "<p>I am trying to assign unique values to a specific allocation or group. What makes it tricky is these unique values are dynamically starting and finishing. So the groups will be holding previously seen values and taking new unique values at various time periods. In regards to the <code>df</code>, unique values are located in <code>Place</code> and the groups to pick from are found in <code>Available Group</code> for each period of time <code>Period</code>. </p>\n\n<p>The broad guidelines I'm trying to adhere to is:</p>\n\n<p>1) Each <code>Group</code> can hold no more than 3 unique <code>Places</code> <strong>at any one time</strong></p>\n\n<p>2) Current unique <code>Places</code> should be evenly distributed across each <code>Group</code> </p>\n\n<p>3) Once <code>Places</code> get assigned to <code>Group</code>, keep until <code>Group</code> finishes. <strong>Unless <code>Group</code> becomes NA or uneven allocation of meetings</strong></p>\n\n<p>To understand how many <code>Places</code> are currently occuring I've included <code>Total</code>, which is based on if the <code>Place</code> value appears again. I'm meeting my first two guidelines and partially the third. When a <code>Place</code> is assigned to a <code>Group</code> it is held at the same <code>Group</code> until the <code>Place</code> is finished (does not appear again).</p>\n\n<p>However, I'm not referencing <code>Available Group</code> to understand if that <code>Group</code> is available. When the <code>Group</code> becomes unavailable I'd like to rearrange those <code>Places</code> across the other <code>Available Group</code>. Using the <code>df</code> below, the assigning of places works well the unique places increases. But as soon as they start to finish and Group 2 becomes unavailable those places arent re-assigned to group 1. At this point there are only 3 places occurring.</p>\n\n<pre><code>df = pd.DataFrame({\n    'Period' : [1,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,6,6],  \n    'Place' : ['CLUB','CLUB','CLUB','HOME','HOME','AWAY','AWAY','WORK','WORK','AWAY','AWAY','GOLF','GOLF','CLUB','CLUB','POOL','POOL','HOME','HOME','WORK','WORK','AWAY','AWAY','POOL','POOL','TENNIS','TENNIS'],                                \n    'Total' : [1,1,1,2,2,3,3,4,4,4,4,5,5,4,4,4,4,4,4,4,4,4,4,4,4,5,5],                            \n    'Available Group' : ['1','2','1','2','1','2','1','2','1','1','2','1','2','2','1','2','1','2','1','2','1','1','2','1','2','2','1'],                           \n    })\n</code></pre>\n\n<p>Attempt:</p>\n\n<pre><code># df to store all unique places\nuniquePlaces = pd.DataFrame(df[\"Place\"].unique(), columns=[\"Place\"])\n\n# Start stores index of df where the place appears 1st\nuniquePlaces[\"Start\"] = -1\n\n# End stores index of df where the place appears last \nuniquePlaces[\"End\"] = -1\n\ndef assign_place_label(group):\n\n    ''' Create a label column that calculates the amount of unique meetings \n        throughout the racing schedule '''\n\n    label = uniquePlaces[uniquePlaces[\"Place\"] == group.name].index[0]\n    group[\"Place Label\"] = label\n    uniquePlaces.loc[label, \"Start\"] = group.index.min()\n    uniquePlaces.loc[label, \"End\"] = group.index.max()\n    return group\n\n# Based on Start and End of each place, assign index to each place.\n# when 'freed' the index is reused to new place appearing after that\ndef Assign_Meetings_group(up):\n    up[\"Index\"] = 0\n    up[\"Freed\"] = False\n    max_ind=0\n    free_indx = []\n    for i in range(len(up)):\n        ind_freed = up.index[(up[\"End\"]&lt;up.iloc[i][\"Start\"]) &amp; (~up[\"Freed\"])]\n\n        free = list(up.loc[ind_freed, \"Index\"])\n        free_indx += free\n\n        up.loc[ind_freed, \"Freed\"] = True\n\n        if len(free_indx)&gt;0:\n            m = min(free_indx)\n            up.loc[i, \"Index\"] = m\n            free_indx.remove(m)\n\n        else:\n            up.loc[i, \"Index\"] = max_ind\n            max_ind+=1\n\n    up[\"Group\"] = up[\"Index\"]//3+1\n\n    return up  \n\ndf2 = df.groupby(\"Place\").apply(assign_place_label)\nuniquePlaces = Assign_Meetings_group(uniquePlaces)\n\ndf3 = df2[df2['Period']!=0].drop_duplicates(subset = ['Period','Place'])\nresult = df3.merge(uniquePlaces[[\"Group\"]], how=\"left\", left_on=\"Place Label\", right_index=True, sort=False)\n</code></pre>\n\n<p>Out:</p>\n\n<pre><code>    Period Place  Total Available Group  Place Label  Group\n0   1       CLUB  1      1               0            1    \n1   2       CLUB  1      1               0            1    \n3   2       HOME  2      1               1            1    \n5   2       AWAY  3      1               2            1    \n7   3       WORK  4      1               3            2    \n9   3       AWAY  4      1               2            1    \n11  3       GOLF  5      1               4            2    \n13  3       HOME  5      1               1            1    \n15  4       CLUB  4      1               0            1    \n17  4       AWAY  3      1               2            1    \n19  4       POOL  3      1               5            1    \n21  5       WORK  3      1               3            2    \n23  5       POOL  2      1               5            1    \n25  6       GOLF  1      1               4            2 \n</code></pre>\n\n<p>Intended Output:</p>\n\n<pre><code>    Period Place  Total Available Group  Place Label  Group\n0   1       CLUB  1      1               0            1    \n1   2       CLUB  1      1               0            1    \n3   2       HOME  2      1               1            1    \n5   2       AWAY  3      1               2            1    \n7   3       WORK  4      1               3            2    \n9   3       AWAY  4      1               2            1    \n11  3       GOLF  5      1               4            2    \n13  3       HOME  5      1               1            1    \n15  4       CLUB  4      1               0            1    \n17  4       AWAY  3      1               2            1    \n19  4       POOL  3      1               5            1    \n21  5       WORK  3      1               3            1    \n23  5       POOL  2      1               5            1    \n25  6       GOLF  1      1               4            1 \n</code></pre>\n"}, {"tags": ["python", "image", "opencv", "image-processing", "contour"], "answers": [{"comments": [{"owner": {"reputation": 365, "user_id": 7657721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32ad6774bc4add4cf934a174eee60ddd?s=128&d=identicon&r=PG&f=1", "display_name": "mashedpotatoes", "link": "https://stackoverflow.com/users/7657721/mashedpotatoes"}, "edited": false, "score": 0, "creation_date": 1571332038, "post_id": 58423570, "comment_id": 103215135, "body": "Why does it need to be rotated another 90 degrees? I mean, why is the output like that? Is it always needed to be rotated only by -90 degrees? Will there not be cases where it needs to be rotated another way to be right side up, or hard-coding the rotation okay? I need to account for a lot of stuff.."}, {"owner": {"reputation": 25800, "user_id": 11162165, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5kgh.png?s=128&g=1", "display_name": "nathancy", "link": "https://stackoverflow.com/users/11162165/nathancy"}, "reply_to_user": {"reputation": 365, "user_id": 7657721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32ad6774bc4add4cf934a174eee60ddd?s=128&d=identicon&r=PG&f=1", "display_name": "mashedpotatoes", "link": "https://stackoverflow.com/users/7657721/mashedpotatoes"}, "edited": false, "score": 1, "creation_date": 1571343014, "post_id": 58423570, "comment_id": 103219780, "body": "Its due to the way the points are ordered when obtaining the 4 corner points of the box to transform. It should always be rotated -90 degrees since when the points are obtained, they are ordered clockwise, so a -90 degree rotation is necessary. I believe it should be a fixed -90 but I haven&#39;t tested it on multiple images. Check the updated code, I merged it into the function"}], "tags": [], "owner": {"reputation": 25800, "user_id": 11162165, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5kgh.png?s=128&g=1", "display_name": "nathancy", "link": "https://stackoverflow.com/users/11162165/nathancy"}, "is_accepted": true, "score": 1, "last_activity_date": 1571342896, "last_edit_date": 1571342896, "creation_date": 1571274825, "answer_id": 58423570, "question_id": 58422868, "link": "https://stackoverflow.com/questions/58422868/how-to-warp-a-rectangular-object-to-fit-its-larger-bounding-box/58423570#58423570", "title": "How to warp a rectangular object to fit its larger bounding box", "body": "<p>Try this approach:</p>\n\n<ul>\n<li>Convert image to grayscale and blur with bilateral filter</li>\n<li>Otsu's threshold</li>\n<li>Find contours</li>\n<li>Perform contour approximation for largest square contour</li>\n<li>Perspective transform and rotate</li>\n</ul>\n\n<hr>\n\n<p>Result</p>\n\n<p><a href=\"https://i.stack.imgur.com/DdHsw.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DdHsw.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>import cv2\nimport numpy as np\nimport imutils\n\ndef perspective_transform(image, corners):\n    def order_corner_points(corners):\n        # Separate corners into individual points\n        # Index 0 - top-right\n        #       1 - top-left\n        #       2 - bottom-left\n        #       3 - bottom-right\n        corners = [(corner[0][0], corner[0][1]) for corner in corners]\n        top_r, top_l, bottom_l, bottom_r = corners[0], corners[1], corners[2], corners[3]\n        return (top_l, top_r, bottom_r, bottom_l)\n\n    # Order points in clockwise order\n    ordered_corners = order_corner_points(corners)\n    top_l, top_r, bottom_r, bottom_l = ordered_corners\n\n    # Determine width of new image which is the max distance between \n    # (bottom right and bottom left) or (top right and top left) x-coordinates\n    width_A = np.sqrt(((bottom_r[0] - bottom_l[0]) ** 2) + ((bottom_r[1] - bottom_l[1]) ** 2))\n    width_B = np.sqrt(((top_r[0] - top_l[0]) ** 2) + ((top_r[1] - top_l[1]) ** 2))\n    width = max(int(width_A), int(width_B))\n\n    # Determine height of new image which is the max distance between \n    # (top right and bottom right) or (top left and bottom left) y-coordinates\n    height_A = np.sqrt(((top_r[0] - bottom_r[0]) ** 2) + ((top_r[1] - bottom_r[1]) ** 2))\n    height_B = np.sqrt(((top_l[0] - bottom_l[0]) ** 2) + ((top_l[1] - bottom_l[1]) ** 2))\n    height = max(int(height_A), int(height_B))\n\n    # Construct new points to obtain top-down view of image in \n    # top_r, top_l, bottom_l, bottom_r order\n    dimensions = np.array([[0, 0], [width - 1, 0], [width - 1, height - 1], \n                    [0, height - 1]], dtype = \"float32\")\n\n    # Convert to Numpy format\n    ordered_corners = np.array(ordered_corners, dtype=\"float32\")\n\n    # Find perspective transform matrix\n    matrix = cv2.getPerspectiveTransform(ordered_corners, dimensions)\n\n    # Transform the image\n    transformed = cv2.warpPerspective(image, matrix, (width, height))\n\n    # Rotate and return the result\n    return imutils.rotate_bound(transformed, angle=-90)\n\nimage = cv2.imread('1.png')\noriginal = image.copy()\nblur = cv2.bilateralFilter(image,9,75,75)\ngray = cv2.cvtColor(blur, cv2.COLOR_BGR2GRAY)\nthresh = cv2.threshold(gray,0,255, cv2.THRESH_BINARY_INV + cv2.THRESH_OTSU)[1]\n\ncnts = cv2.findContours(thresh, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)\ncnts = cnts[0] if len(cnts) == 2 else cnts[1]\n\nfor c in cnts:\n    peri = cv2.arcLength(c, True)\n    approx = cv2.approxPolyDP(c, 0.015 * peri, True)\n\n    if len(approx) == 4:\n        cv2.drawContours(image,[c], 0, (36,255,12), 3)\n        transformed = perspective_transform(original, approx)\n\ncv2.imshow('thresh', thresh)\ncv2.imshow('image', image)\ncv2.imshow('transformed', transformed)\ncv2.waitKey()\n</code></pre>\n"}], "owner": {"reputation": 365, "user_id": 7657721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32ad6774bc4add4cf934a174eee60ddd?s=128&d=identicon&r=PG&f=1", "display_name": "mashedpotatoes", "link": "https://stackoverflow.com/users/7657721/mashedpotatoes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 788, "favorite_count": 1, "accepted_answer_id": 58423570, "answer_count": 1, "score": 2, "last_activity_date": 1571342896, "creation_date": 1571268109, "last_edit_date": 1571274948, "question_id": 58422868, "link": "https://stackoverflow.com/questions/58422868/how-to-warp-a-rectangular-object-to-fit-its-larger-bounding-box", "title": "How to warp a rectangular object to fit its larger bounding box", "body": "<p>Given this image:</p>\n\n<p><img src=\"https://imgur.com/Jmp528z.png\" alt=\"1\"></p>\n\n<p>I'd like to make it such that it will rotate and stretch to fully fit in the bounding box with no whitespace on the outside of the largest rectangular box. It should also account for worse perspective case, like in the links I list later on.</p>\n\n<p>Basically, while it is not noticeable, the rectangle is rotated a little bit, and I'd like to fix that distortion.</p>\n\n<p>However, I got an error when attempting to retrieve the four points of the contour. I have made sure and utilized contour approximation to isolate and get only relevant looking contours and as you can see in the image it's successful, though I can't use perspective warp on it.</p>\n\n<p>I've already tried the links here:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/11627362/how-to-straighten-a-rotated-rectangle-area-of-an-image-using-opencv-in-python/54823710#54823710\">How to straighten a rotated rectangle area of an image using opencv in python?</a></li>\n<li><a href=\"https://www.pyimagesearch.com/2014/05/05/building-pokedex-python-opencv-perspective-warping-step-5-6/\" rel=\"nofollow noreferrer\">https://www.pyimagesearch.com/2014/05/05/building-pokedex-python-opencv-perspective-warping-step-5-6/</a></li>\n<li><a href=\"https://www.pyimagesearch.com/2014/09/01/build-kick-ass-mobile-document-scanner-just-5-minutes/\" rel=\"nofollow noreferrer\">https://www.pyimagesearch.com/2014/09/01/build-kick-ass-mobile-document-scanner-just-5-minutes/</a></li>\n</ul>\n\n<p>And followed them, with only minor modifications (like not downscaling the image and then upscaling it) and different input image.</p>\n\n<p>There is a similar error encountered by a reader there in the comments, but the author just said to use contour approximation. I did that but I still receive the same error.</p>\n\n<p>I have already retrieved the contour (which along with its bounding box, is the image illustrated earlier), and used this code to attempt persective warp:</p>\n\n<pre><code>def warp_perspective(cnt):\n    # reshape cnt to get tl, tr, br, bl points\n    pts = cnt.reshape(4, 2)\n    rect = np.zeros((4, 2), dtype=\"float32\")\n\n    s = pts.sum(axis=1)\n    rect[0] = pts[np.argmin(s)]\n    rect[2] = pts[np.argmin(s)]\n\n    diff = np.diff(pts, axis=1)\n    rect[1] = pts[np.argmin(diff)]\n    rect[2] = pts[np.argmax(diff)]\n\n    # solve for the width of the image\n    (tl, tr, br, bl) = rect\n    widthA = np.sqrt(((br[0] - bl[0]) ** 2) + ((br[1] - bl[1]) ** 2))\n    widthB = np.sqrt(((tr[0] - tl[0]) ** 2) + ((tr[1] - tl[1]) ** 2))\n\n    # solve for the height of the image\n    heightA = np.sqrt(((tr[0] - br[0]) ** 2) + ((tr[1] - br[1]) ** 2))\n    heightB = np.sqrt(((tl[0] - bl[0]) ** 2) + ((tl[1] - bl[1]) ** 2))\n\n    # get the final dimensions\n    maxWidth = max(int(widthA), int(widthB))\n    maxHeight = max(int(heightA), int(heightB))\n\n    # construct the dst image\n    dst = np.array([\n        [0, 0],\n        [maxWidth - 1, 0],\n        [maxWidth - 1, maxHeight - 1],\n        [0, maxHeight - 1]], dtype=\"float32\")\n\n    # calculate perspective transform matrix\n    # warp the perspective\n    M = cv2.getPerspectiveTransform(rect, dst)\n    warp = cv2.warpPerspective(orig, M, (maxWidth, maxHeight))\n\n    cv2.imshow(\"warped\", warp)\n\n    return warp\n</code></pre>\n\n<p>The function accepts <code>cnt</code> as a single contour.</p>\n\n<p>Upon running I ran into this error I mentioned earlier:</p>\n\n<pre><code>in warp_perspective\n    pts = cnt.reshape(4, 2)\nValueError: cannot reshape array of size 2090 into shape (4,2)\n</code></pre>\n\n<p>Which I do not understand at all. I have successfully isolated and retrieved the correct contour and bounding box, and the only thing I did differently was to skip downscaling..</p>\n"}, {"tags": ["python", "string-formatting"], "comments": [{"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 2, "creation_date": 1571268129, "post_id": 58422836, "comment_id": 103187903, "body": "Think about it.  When <code>%</code> is used as a control character for substitutions in the string (<i>e.g.</i> <code>%s</code>), then you need a way to handle an <i>actual</i> <code>%</code> character.  A single one indicates that the next character should indicate what data type is being substituted.  If that next character is a <code>%</code>, then it&#39;s interpreted as a <code>%</code> character with no substitution."}, {"owner": {"reputation": 16677, "user_id": 1092820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc78da24118b403595f62fa7856e1b6c?s=128&d=identicon&r=PG", "display_name": "Ruzihm", "link": "https://stackoverflow.com/users/1092820/ruzihm"}, "edited": false, "score": 1, "creation_date": 1573526145, "post_id": 58422836, "comment_id": 103901632, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/28343745/how-do-i-print-a-sign-using-string-formatting\">How do I print a &#39;%&#39; sign using string formatting?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 1, "creation_date": 1579510579, "post_id": 58884803, "comment_id": 105776777, "body": "No part of your answer addresses the case the question is actually asking about, which is <code>%%</code>. (Just adding a <code>%%</code> example isn&#39;t going to help, because the question already has a <code>%%</code> example. You&#39;re going to need to actually explain things.)"}], "tags": [], "owner": {"reputation": 1020, "user_id": 12119282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BvAPB.jpg?s=128&g=1", "display_name": "Samuel Muldoon", "link": "https://stackoverflow.com/users/12119282/samuel-muldoon"}, "is_accepted": false, "score": -1, "last_activity_date": 1573852671, "creation_date": 1573852671, "answer_id": 58884803, "question_id": 58422836, "link": "https://stackoverflow.com/questions/58422836/why-is-later-double-converted-to-single/58884803#58884803", "title": "Why is later double %% converted to single %", "body": "<p>The percent sign <code>%</code> is a special meta-character. I have described some examples below:</p>\n\n<h1>INPUTS:</h1>\n\n<pre><code>print(\"Hello %s %s. Your current balance is %.2f\" % (\"John\", \"Doe\", 53.4423123123))\nprint(\"Hello, %s!\" % \"Bob\")\nprint(\"%s is %d years old.\" % (\"Sarah\", 43))\nprint(\"Ian scored %.0f%s on the quiz.\" % (98.7337, \"%\"))\nlyst = [1, 2, 3]\nprint(\"id(lyst) == %d\" % id(lyst))\nprint(\"id(lyst) in hexadecimal format is %x\" % id(lyst))\n</code></pre>\n\n<h1>OUTPUTS:</h1>\n\n<pre><code>Hello John Doe. Your current balance is 53.44\nHello, Bob!\nSarah is 43 years old.\nIan scored 99% on the quiz.\nid(lyst) == 58322152\nid(lyst) in hexadecimal format is 379ece8\n</code></pre>\n\n<h1>NOTES:</h1>\n\n<pre><code>+------+----------------------------------------------+\n| %s   | String                                       |\n| %d   | Integer                                      |\n| %f   | Floating point number                        |\n| %.2f | float with 2 digits to the right of the dot. |\n| %.4f | float with 4 digits to the right of the dot. |\n| %x   | Integers in hex representation               |\n+------+----------------------------------------------+\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12229413, "user_type": "registered", "profile_image": "https://graph.facebook.com/401758210508808/picture?type=large", "display_name": "Pawan Goyal", "link": "https://stackoverflow.com/users/12229413/pawan-goyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "closed_date": 1579510425, "answer_count": 1, "score": 0, "last_activity_date": 1573852671, "creation_date": 1571267800, "last_edit_date": 1573525338, "question_id": 58422836, "link": "https://stackoverflow.com/questions/58422836/why-is-later-double-converted-to-single", "closed_reason": "Duplicate", "title": "Why is later double %% converted to single %", "body": "<pre><code>l='a'     \nr='%sbb%%'%l    \nprint(r)\n</code></pre>\n\n<p>I expected the output <code>abb%%</code>, but the actual output is <code>abb%</code>.<br>\nCan someone explain why?</p>\n"}, {"tags": ["python", "windows", "jupyter-notebook", "tornado"], "comments": [{"owner": {"reputation": 92215, "user_id": 1832058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/relWs.jpg?s=128&g=1", "display_name": "furas", "link": "https://stackoverflow.com/users/1832058/furas"}, "edited": false, "score": 3, "creation_date": 1571274394, "post_id": 58422817, "comment_id": 103189158, "body": "Python 3.8 is very fresh so better go back to 3.7 and wait some time till it will be better tested and modules will be create specially for 3.8."}, {"owner": {"reputation": 11257, "user_id": 10197418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/be8Y6.jpg?s=128&g=1", "display_name": "MrFuppes", "link": "https://stackoverflow.com/users/10197418/mrfuppes"}, "edited": false, "score": 1, "creation_date": 1572973650, "post_id": 58422817, "comment_id": 103725665, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/54805213/jupyter-notebook-cannot-start-with-python-3-8-in-windows-10\">Jupyter notebook cannot start with python 3.8 in Windows 10</a>"}, {"owner": {"reputation": 33388, "user_id": 2437514, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/8QN0K.jpg?s=128&g=1", "display_name": "Rick supports Monica", "link": "https://stackoverflow.com/users/2437514/rick-supports-monica"}, "edited": false, "score": 3, "creation_date": 1576786281, "post_id": 58422817, "comment_id": 105019967, "body": "still broken in 3.8.1 (released today)."}, {"owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "edited": false, "score": 2, "creation_date": 1579696396, "post_id": 58422817, "comment_id": 105851095, "body": "This is now fixed in version 6.0.3 of jupyter notebook. Upgrade with <code>pip install notebook --upgrade</code>"}], "answers": [{"comments": [{"owner": {"reputation": 650, "user_id": 3022982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3040ac2e9831e96a5e524ae5e435fd20?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/3022982/andrew"}, "edited": false, "score": 7, "creation_date": 1571390535, "post_id": 58430041, "comment_id": 103233643, "body": "Do not expect a fix from Tornado team: <a href=\"https://github.com/tornadoweb/tornado/issues/2608\" rel=\"nofollow noreferrer\">github.com/tornadoweb/tornado/issues/2608</a>"}, {"owner": {"reputation": 170, "user_id": 2695407, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2669bcba72fdaa56c72634492634d81?s=128&d=identicon&r=PG&f=1", "display_name": "Behnam Heydari", "link": "https://stackoverflow.com/users/2695407/behnam-heydari"}, "edited": false, "score": 9, "creation_date": 1573467911, "post_id": 58430041, "comment_id": 103879403, "body": "if you were looking for asyncio.py, take a look at &quot;C:\\Python3\\Lib\\site-packages\\tornado\\platform&quot;"}, {"owner": {"reputation": 1948, "user_id": 1157905, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/eceaedd9e55ca442d8bc5a8571dd397d?s=128&d=identicon&r=PG", "display_name": "Omri374", "link": "https://stackoverflow.com/users/1157905/omri374"}, "edited": false, "score": 2, "creation_date": 1574242672, "post_id": 58430041, "comment_id": 104158445, "body": "Thanks! If you&#39;re using a conda env, Make sure to change the version in the env and not only the global one. Second, make sure you add this change after the <code>import asyncio</code> statement :)"}, {"owner": {"reputation": 83, "user_id": 4330957, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-l3EYv0RadF4/AAAAAAAAAAI/AAAAAAAAABQ/yhbjXOgzh4w/photo.jpg?sz=128", "display_name": "Isaiah Hines", "link": "https://stackoverflow.com/users/4330957/isaiah-hines"}, "edited": false, "score": 1, "creation_date": 1576377266, "post_id": 58430041, "comment_id": 104879132, "body": "This fixed it for me. In particular: 1. You can get the file location from the stack trace if you run: jupyter -m notebook 2. On my system the file is located here: C:\\Users_NAME_\\AppData\\Roaming\\Python\\Python38\\site-packages&zwnj;&#8203;\\tornado\\platform\\as&zwnj;&#8203;yncio.py"}, {"owner": {"reputation": 615, "user_id": 12010205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fJTIU.jpg?s=128&g=1", "display_name": "Andi Schroff", "link": "https://stackoverflow.com/users/12010205/andi-schroff"}, "edited": false, "score": 0, "creation_date": 1578933065, "post_id": 58430041, "comment_id": 105591527, "body": "This worked for me. If you use virtualenv, this fix needs be applied only to your environment in ENV-DIRECTORY\\Lib\\site-packages\\tornado\\platform\\asyncio.py"}, {"owner": {"reputation": 915, "user_id": 8589340, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef2d962081c54ed75eb759d09b0fc92b?s=128&d=identicon&r=PG&f=1", "display_name": "Worm", "link": "https://stackoverflow.com/users/8589340/worm"}, "edited": false, "score": 2, "creation_date": 1579776433, "post_id": 58430041, "comment_id": 105883276, "body": "This didn&#39;t work for me January 2020, Python3.8 but Mirwise Khan&#39;s answer below did"}, {"owner": {"reputation": 134, "user_id": 10474024, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XkmSm8phXlA/AAAAAAAAAAI/AAAAAAAAAAc/Nr8e7Y7s05U/photo.jpg?sz=128", "display_name": "ProsperousHeart", "link": "https://stackoverflow.com/users/10474024/prosperousheart"}, "edited": false, "score": 0, "creation_date": 1585168507, "post_id": 58430041, "comment_id": 107672362, "body": "I have the latest and it is not fixed."}, {"owner": {"reputation": 11257, "user_id": 10197418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/be8Y6.jpg?s=128&g=1", "display_name": "MrFuppes", "link": "https://stackoverflow.com/users/10197418/mrfuppes"}, "edited": false, "score": 1, "creation_date": 1587707616, "post_id": 58430041, "comment_id": 108620944, "body": "the &#39;notebook --upgrade&#39; might fix Jupyter Notebook; however, the tornado/asyncio modification for windows platform is still needed e.g. to <a href=\"https://stackoverflow.com/questions/58557238/spyder-ide-fails-to-start-on-windows-10-with-python-3-8\">run the latest version of Spyder</a>, so you might want to keep the workaround in the answer."}, {"owner": {"reputation": 345, "user_id": 6136361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c188d10b2ac2b1e65dd0799176a7362f?s=128&d=identicon&r=PG&f=1", "display_name": "theFrok", "link": "https://stackoverflow.com/users/6136361/thefrok"}, "edited": false, "score": 0, "creation_date": 1589353266, "post_id": 58430041, "comment_id": 109256165, "body": "I tried the notebook upgrade, and even delete it and reinstall, but I still got the problem. I finally used the fix in the <code>tornado\\platform\\asyncio.py</code>."}, {"owner": {"reputation": 85, "user_id": 4772764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c333b66462cdf1a1d57b360c599e7c1?s=128&d=identicon&r=PG&f=1", "display_name": "Nihat", "link": "https://stackoverflow.com/users/4772764/nihat"}, "edited": false, "score": 0, "creation_date": 1589373697, "post_id": 58430041, "comment_id": 109267211, "body": "may I ask how to update python version <b>from</b> 3.7.7 <b>to</b> 3.8 via <b>conda</b> command or manually within anaconda app on macOS?"}, {"owner": {"reputation": 491, "user_id": 3353857, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AFa1x.jpg?s=128&g=1", "display_name": "caoanan", "link": "https://stackoverflow.com/users/3353857/caoanan"}, "edited": false, "score": 0, "creation_date": 1593592329, "post_id": 58430041, "comment_id": 110831907, "body": "Tornado 6.0.4,  Note that it is still necessary to use asyncio.set_event_loop_policy(asyncio.WindowsSelectorEventLo&zwnj;&#8203;opPolicy()) for this platform/version.    <a href=\"https://www.tornadoweb.org/en/stable/releases/v6.0.4.html#general-changes\" rel=\"nofollow noreferrer\">tornadoweb.org/en/stable/releases/v6.0.4.html#general-change&zwnj;&#8203;s</a>"}, {"owner": {"reputation": 111, "user_id": 4597161, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1136a6df3f93a403d2154d4b272f770f?s=128&d=identicon&r=PG&f=1", "display_name": "Mac C.", "link": "https://stackoverflow.com/users/4597161/mac-c"}, "edited": false, "score": 0, "creation_date": 1602769784, "post_id": 58430041, "comment_id": 113829899, "body": "Upgrading only jupyter didn&#39;t do it for me. I also had to update <code>ipykernel</code> seperately."}, {"owner": {"reputation": 181, "user_id": 10034523, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_vHAHz0-4Rk/AAAAAAAAAAI/AAAAAAAAAnQ/fLIFKLVhzRY/photo.jpg?sz=128", "display_name": "Crispy13", "link": "https://stackoverflow.com/users/10034523/crispy13"}, "edited": false, "score": 0, "creation_date": 1606721669, "post_id": 58430041, "comment_id": 115036495, "body": "Updating notebook did not work in my case, inserting the code block solved it instead."}], "tags": [], "owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "is_accepted": true, "score": 194, "last_activity_date": 1582871751, "last_edit_date": 1582871751, "creation_date": 1571306816, "answer_id": 58430041, "question_id": 58422817, "link": "https://stackoverflow.com/questions/58422817/jupyter-notebook-with-python-3-8-notimplementederror/58430041#58430041", "title": "Jupyter Notebook with Python 3.8 - NotImplementedError", "body": "<p><strong>EDIT</strong></p>\n\n<p>This issue exists in older versions of Jupyter Notebook and was fixed in version <strong>6.0.3</strong> (released 2020-01-21).  To upgrade to the latest version run:</p>\n\n<pre><code>pip install notebook --upgrade\n</code></pre>\n\n<hr>\n\n<p><strike>Following on this issue through GitHub, it seems the problem is related to the <code>tornado</code> server that jupyter uses.</p>\n\n<p>For those that can't wait for an official fix, I was able to get it working by editing the file <code>tornado/platform/asyncio.py</code>, by adding:</p>\n\n<pre><code>import sys\n\nif sys.platform == 'win32':\n    asyncio.set_event_loop_policy(asyncio.WindowsSelectorEventLoopPolicy())\n</code></pre>\n\n<p>After the main imports. </p>\n\n<p>I expect an official fix for this soon, however.</p>\n\n<p></strike></p>\n"}, {"comments": [{"owner": {"reputation": 1254, "user_id": 375093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/138a0a46ecf849e5aebb653568f5e797?s=128&d=identicon&r=PG", "display_name": "Sundeep", "link": "https://stackoverflow.com/users/375093/sundeep"}, "edited": false, "score": 1, "creation_date": 1577843609, "post_id": 59512181, "comment_id": 105268231, "body": "Both the question and accepted answer were from October 2019 and the solution worked for me"}, {"owner": {"reputation": 956, "user_id": 3744997, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/KiTfT.png?s=128&g=1", "display_name": "Abhishek Agarwal", "link": "https://stackoverflow.com/users/3744997/abhishek-agarwal"}, "edited": false, "score": 2, "creation_date": 1578716895, "post_id": 59512181, "comment_id": 105539362, "body": "The accepted answer didn&#39;t work for me. this did. Thanks!"}, {"owner": {"reputation": 150, "user_id": 5222312, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wKUwRiRI-ZY/AAAAAAAAAAI/AAAAAAAAAOE/_DAXwF1aWRw/photo.jpg?sz=128", "display_name": "fuomag9", "link": "https://stackoverflow.com/users/5222312/fuomag9"}, "edited": false, "score": 7, "creation_date": 1579175411, "post_id": 59512181, "comment_id": 105681810, "body": "Worked for me too, python 3.8 in jan 2020"}, {"owner": {"reputation": 881859, "user_id": 100297, "user_type": "moderator", "profile_image": "https://www.gravatar.com/avatar/24780fb6df85a943c7aea0402c843737?s=128&d=identicon&r=PG", "display_name": "Martijn Pieters", "link": "https://stackoverflow.com/users/100297/martijn-pieters"}, "edited": false, "score": 3, "creation_date": 1580659743, "post_id": 59512181, "comment_id": 106161597, "body": "I would <b>not</b> go and alter Python&#39;s standard library source code."}, {"owner": {"reputation": 949, "user_id": 3740885, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LOyZ7.jpg?s=128&g=1", "display_name": "Mirwise Khan", "link": "https://stackoverflow.com/users/3740885/mirwise-khan"}, "reply_to_user": {"reputation": 881859, "user_id": 100297, "user_type": "moderator", "profile_image": "https://www.gravatar.com/avatar/24780fb6df85a943c7aea0402c843737?s=128&d=identicon&r=PG", "display_name": "Martijn Pieters", "link": "https://stackoverflow.com/users/100297/martijn-pieters"}, "edited": false, "score": 0, "creation_date": 1580659892, "post_id": 59512181, "comment_id": 106161638, "body": "@MartijnPieters make a copy of the file somewhere, try the above solution, if it works &gt; well n good, otherwise just replace the file with old one &gt;&gt; Kinda Win-Win situation"}, {"owner": {"reputation": 881859, "user_id": 100297, "user_type": "moderator", "profile_image": "https://www.gravatar.com/avatar/24780fb6df85a943c7aea0402c843737?s=128&d=identicon&r=PG", "display_name": "Martijn Pieters", "link": "https://stackoverflow.com/users/100297/martijn-pieters"}, "edited": false, "score": 1, "creation_date": 1580659950, "post_id": 59512181, "comment_id": 106161662, "body": "You can do this <b>anywhere else</b>, like in <a href=\"https://docs.python.org/3/library/site.html\" rel=\"nofollow noreferrer\"><code>site.py</code></a>."}, {"owner": {"reputation": 85, "user_id": 5591550, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/hvJfN.png?s=128&g=1", "display_name": "Blank\u7a7a\u767d", "link": "https://stackoverflow.com/users/5591550/blank%e7%a9%ba%e7%99%bd"}, "edited": false, "score": 0, "creation_date": 1587542906, "post_id": 59512181, "comment_id": 108548779, "body": "I was having the same issue using Pycharm with Python38 (trying to start localhost:8521 and getting the NotImplementedError) and this solved it. Thank you!"}], "tags": [], "owner": {"reputation": 949, "user_id": 3740885, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LOyZ7.jpg?s=128&g=1", "display_name": "Mirwise Khan", "link": "https://stackoverflow.com/users/3740885/mirwise-khan"}, "is_accepted": false, "score": 43, "last_activity_date": 1580659891, "last_edit_date": 1580659891, "creation_date": 1577546598, "answer_id": 59512181, "question_id": 58422817, "link": "https://stackoverflow.com/questions/58422817/jupyter-notebook-with-python-3-8-notimplementederror/59512181#59512181", "title": "Jupyter Notebook with Python 3.8 - NotImplementedError", "body": "<p>Revising the answer in 2019</p>\n\n<p>Change the end part of the file\n<code>C:\\Users\\{USER-NAME}\\AppData\\Local\\Programs\\Python\\Python38\\Lib\\asyncio\\__init__.py</code></p>\n\n<p>From </p>\n\n<pre><code>if sys.platform == 'win32':  # pragma: no cover\n    from .windows_events import *\n    __all__ += windows_events.__all__\nelse:\n    from .unix_events import *  # pragma: no cover\n    __all__ += unix_events.__all__\n</code></pre>\n\n<p>To </p>\n\n<pre><code>import asyncio\n\nif sys.platform == 'win32':\n    from .windows_events import *\n    asyncio.set_event_loop_policy(asyncio.WindowsSelectorEventLoopPolicy())\n    __all__ += windows_events.__all__\nelse:\n    from .unix_events import *  # pragma: no cover\n    __all__ += unix_events.__all__\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48, "user_id": 11980840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/165c3e4bcd2c4b58706231b41a42aff5?s=128&d=identicon&r=PG&f=1", "display_name": "penguins", "link": "https://stackoverflow.com/users/11980840/penguins"}, "is_accepted": false, "score": 1, "last_activity_date": 1604344498, "creation_date": 1604344498, "answer_id": 64651878, "question_id": 58422817, "link": "https://stackoverflow.com/questions/58422817/jupyter-notebook-with-python-3-8-notimplementederror/64651878#64651878", "title": "Jupyter Notebook with Python 3.8 - NotImplementedError", "body": "<p>For me, I had to reinstall asyncio</p>\n<pre><code>pip install asyncio --upgrade\n</code></pre>\n<p>And upgrade the kernel package</p>\n<pre><code>pip install ipykernel --upgrade\n</code></pre>\n"}], "owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46064, "favorite_count": 33, "protected_date": 1577159104, "accepted_answer_id": 58430041, "answer_count": 3, "score": 76, "last_activity_date": 1604344498, "creation_date": 1571267575, "last_edit_date": 1572976811, "question_id": 58422817, "link": "https://stackoverflow.com/questions/58422817/jupyter-notebook-with-python-3-8-notimplementederror", "title": "Jupyter Notebook with Python 3.8 - NotImplementedError", "body": "<p>Upgraded recently to Python 3.8, and installed <code>jupyter</code>. However, when trying to run <code>jupyter notebook</code> getting the following error:</p>\n\n<pre><code>  File \"c:\\users\\user\\appdata\\local\\programs\\python\\python38\\lib\\site-packages\\tornado\\platform\\asyncio.py\", line 99, in add_handler\n    self.asyncio_loop.add_reader(fd, self._handle_events, fd, IOLoop.READ)\n  File \"c:\\users\\user\\appdata\\local\\programs\\python\\python38\\lib\\asyncio\\events.py\", line 501, in add_reader\n    raise NotImplementedError\nNotImplementedError\n</code></pre>\n\n<p>I know Python 3.8 on windows switched to <code>ProactorEventLoop</code> by default, so I suspect it is related to this.</p>\n\n<p>Jupyter does not support Python 3.8 at the moment? Is there a work around?</p>\n"}, {"tags": ["python", "c++"], "comments": [{"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 2, "creation_date": 1571268251, "post_id": 58422804, "comment_id": 103187944, "body": "When you compile a C++ source file, the output is a binary.  <code>g++</code> by default will write that to <code>a.out</code> unless you specify a different target with <code>-o</code> option.  You certainly do not execute the C++ source file itself."}, {"owner": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "reply_to_user": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1571268535, "post_id": 58422804, "comment_id": 103188018, "body": "Can you suggueste to me an exemple please !"}, {"owner": {"reputation": 92215, "user_id": 1832058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/relWs.jpg?s=128&g=1", "display_name": "furas", "link": "https://stackoverflow.com/users/1832058/furas"}, "edited": false, "score": 1, "creation_date": 1571268558, "post_id": 58422804, "comment_id": 103188027, "body": "example: <code>subprocess.call(&quot;a.out&quot;, shell=True)</code>"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 3, "creation_date": 1571268882, "post_id": 58422804, "comment_id": 103188105, "body": "You should also check the return code from <code>g++</code> to make sure it succeeded.  If there are errors, the output won&#39;t exist or if it does it&#39;ll be from a previous successful compilation."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 2, "creation_date": 1571269468, "post_id": 58422804, "comment_id": 103188209, "body": "Python will never directly execute C++ code (well, there are library bindings I suppose...) so you are talking about writing a script in Python to automate the C++ compile/run cycle? What is it, in context, that you are actually trying to accomplish?"}, {"owner": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "edited": false, "score": 0, "creation_date": 1571271533, "post_id": 58422804, "comment_id": 103188614, "body": "I want to create a python script that can run c++ code"}, {"owner": {"reputation": 92215, "user_id": 1832058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/relWs.jpg?s=128&g=1", "display_name": "furas", "link": "https://stackoverflow.com/users/1832058/furas"}, "edited": false, "score": 1, "creation_date": 1571274736, "post_id": 58422804, "comment_id": 103189235, "body": "Python can&#39;t run directly C++, you would have to create parser and interpreter for C++. It can execute C++ compiled to machine code (.exe file) - and you already did it. You compiled C++ to machine code using <code>g++ main.cpp</code> and you should get machine code in file <code>a.out</code> and now you can execute it <code>subprocess.call(&quot;a.out&quot;, shell=True)</code>."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1571316567, "post_id": 58422804, "comment_id": 103206575, "body": "@ITWorld That&#39;s just repeating the question&#39;s opener. I&#39;m asking for more detail, more context, more explanation of what you&#39;re trying to do and why. What is your goal? &quot;Run C++ code&quot; in what way? What sort of C++ code? Why should Python do this? In what manner? To accomplish what? We cannot adequately answer your question without the proper context."}, {"owner": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1571317139, "post_id": 58422804, "comment_id": 103206933, "body": "@LightnessRacesinOrbit So what I am trying to is to run c++ functions or files code using a python script. Why or for what? It&#39;s something that I don&#39;t know either because my boss who know the reason. He&#39;s the one who need it and ask me to search how to do it He did not specify why or for what so I can&#39;t answer that question"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1571319224, "post_id": 58422804, "comment_id": 103208266, "body": "Then it sounds like you need to get a more detailed requirements specification from your boss, because at present you do not have sufficient information to properly complete your task. <i>&quot;run c++ functions or files code using a python script&quot;</i> is extremely vague."}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1571268222, "post_id": 58422861, "comment_id": 103187926, "body": "Also worth testing the the ages of the cpp file and the executable. If the executable is newer than the cpp file, there&#39;s not much point to recompiling the cpp file. On second thought, this assumes stable monotonic time."}, {"owner": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "edited": false, "score": 0, "creation_date": 1571268677, "post_id": 58422861, "comment_id": 103188056, "body": "Can you suggueste to me an example  please ! Or if you know where i can find a simple tutorial please !"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "edited": false, "score": 1, "creation_date": 1571278976, "post_id": 58422861, "comment_id": 103190069, "body": "@ITWorld this specific case isn&#39;t the sort of thing where you are likely to find a tutorial. You should be able to find a general tutorial for running external processes, and you&#39;ll have to adapt from there."}, {"owner": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "edited": false, "score": 0, "creation_date": 1571307333, "post_id": 58422861, "comment_id": 103201090, "body": "@bem22 I want to run c++ code using python script and not call a command that run the .exe file"}, {"owner": {"reputation": 117, "user_id": 7056603, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZmOm.png?s=128&g=1", "display_name": "bem22", "link": "https://stackoverflow.com/users/7056603/bem22"}, "edited": false, "score": 1, "creation_date": 1571321918, "post_id": 58422861, "comment_id": 103209902, "body": "When you said run C++ code I assumed you want to run C++ compiled code. My answer describes how you can compile and run the code. This requires the GNU g++ compiler and a unix environment. What I suggested was a solution that only runs in Unix or bash supporting systems. Basically ./ means &quot;run this script&quot;. You can run different scripts: For example ./hello where ./hello is the output from g++ of hello.cpp (you compile it by using the following command: g++ -o hello hello.cpp)"}, {"owner": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "edited": false, "score": 0, "creation_date": 1571322258, "post_id": 58422861, "comment_id": 103210122, "body": "@bem22 yes but it&#39;s not answering the whole question. Is there a way to convert a c++ to python or run a c++ using python without using commands"}, {"owner": {"reputation": 117, "user_id": 7056603, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZmOm.png?s=128&g=1", "display_name": "bem22", "link": "https://stackoverflow.com/users/7056603/bem22"}, "edited": false, "score": 1, "creation_date": 1571322824, "post_id": 58422861, "comment_id": 103210449, "body": "It is virtually impossible. C has many features that Python does not, such as pointers, access to direct syscalls and file descriptors etc."}], "tags": [], "owner": {"reputation": 117, "user_id": 7056603, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZmOm.png?s=128&g=1", "display_name": "bem22", "link": "https://stackoverflow.com/users/7056603/bem22"}, "is_accepted": false, "score": 0, "last_activity_date": 1571268031, "creation_date": 1571268031, "answer_id": 58422861, "question_id": 58422804, "link": "https://stackoverflow.com/questions/58422804/how-can-i-run-a-hello-world-c-code-using-python/58422861#58422861", "title": "How can I run a Hello world c++ code using python", "body": "<p>You can use the .os module of python to run os commands.</p>\n\n<pre><code>import os\nmyCmd1 = 'ls -la'\nos.system(myCmd)\n</code></pre>\n\n<p>Your command can be 'g++ main.cpp second.cpp -o run', then you can use the same mechanism to call the <code>./run</code> shell. </p>\n\n<p>Make sure you have the right permissions </p>\n"}, {"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 2, "creation_date": 1571269422, "post_id": 58422966, "comment_id": 103188202, "body": "Why do you compile on the commandline if your script does it too?"}, {"owner": {"reputation": 884, "user_id": 9238288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbf252a32c63647e64ea7b1a534be4a?s=128&d=identicon&r=PG&f=1", "display_name": "jackw11111", "link": "https://stackoverflow.com/users/9238288/jackw11111"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1571269796, "post_id": 58422966, "comment_id": 103188291, "body": "Yes true, only one is necessary"}, {"owner": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "edited": false, "score": 0, "creation_date": 1571307411, "post_id": 58422966, "comment_id": 103201139, "body": "I want to run c++ code using python script and not call a command that run the .exe file"}, {"owner": {"reputation": 884, "user_id": 9238288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbf252a32c63647e64ea7b1a534be4a?s=128&d=identicon&r=PG&f=1", "display_name": "jackw11111", "link": "https://stackoverflow.com/users/9238288/jackw11111"}, "edited": false, "score": 0, "creation_date": 1571310457, "post_id": 58422966, "comment_id": 103202918, "body": "Do you mean that you want a c++ function eg. foo in a class bar that you can use in python like , import bar; bar.foo() ?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1571316539, "post_id": 58422966, "comment_id": 103206557, "body": "Will you update the answer then to remove the excess compilation?"}, {"owner": {"reputation": 884, "user_id": 9238288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbf252a32c63647e64ea7b1a534be4a?s=128&d=identicon&r=PG&f=1", "display_name": "jackw11111", "link": "https://stackoverflow.com/users/9238288/jackw11111"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1571342532, "post_id": 58422966, "comment_id": 103219573, "body": "@LightnessRacesinOrbit Sure thing"}, {"owner": {"reputation": 884, "user_id": 9238288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbf252a32c63647e64ea7b1a534be4a?s=128&d=identicon&r=PG&f=1", "display_name": "jackw11111", "link": "https://stackoverflow.com/users/9238288/jackw11111"}, "reply_to_user": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "edited": false, "score": 1, "creation_date": 1571349387, "post_id": 58422966, "comment_id": 103222059, "body": "@ITWorld I have added an example with boost python, take a look"}, {"owner": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "edited": false, "score": 1, "creation_date": 1571390452, "post_id": 58422966, "comment_id": 103233585, "body": "@jackw11111 Thank you for your example, but the boost folder has to be in my project folder or where ? Because I did put it in &quot;C:\\Python36\\Lib\\site-packages\\boost&quot; but I have an error pointing on #include &lt;boost/python.hpp&gt; that says it didn&#39;t find the file"}, {"owner": {"reputation": 884, "user_id": 9238288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbf252a32c63647e64ea7b1a534be4a?s=128&d=identicon&r=PG&f=1", "display_name": "jackw11111", "link": "https://stackoverflow.com/users/9238288/jackw11111"}, "reply_to_user": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "edited": false, "score": 1, "creation_date": 1571394082, "post_id": 58422966, "comment_id": 103235527, "body": "@ITWorld You might need to link to the folder where the header files when you compile something like <code>g++ -I C:\\Python36\\Lib\\site-packages</code> etc ..."}, {"owner": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "edited": false, "score": 0, "creation_date": 1571399441, "post_id": 58422966, "comment_id": 103238222, "body": "@jackw11111 I had the error &quot;ValueError: Unknown MS Compiler version 1900&quot;"}, {"owner": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "edited": false, "score": 0, "creation_date": 1571866369, "post_id": 58422966, "comment_id": 103386312, "body": "Thank you for your answer, I did use ctypes instead"}], "tags": [], "owner": {"reputation": 884, "user_id": 9238288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbf252a32c63647e64ea7b1a534be4a?s=128&d=identicon&r=PG&f=1", "display_name": "jackw11111", "link": "https://stackoverflow.com/users/9238288/jackw11111"}, "is_accepted": false, "score": 3, "last_activity_date": 1595468667, "last_edit_date": 1595468667, "creation_date": 1571268977, "answer_id": 58422966, "question_id": 58422804, "link": "https://stackoverflow.com/questions/58422804/how-can-i-run-a-hello-world-c-code-using-python/58422966#58422966", "title": "How can I run a Hello world c++ code using python", "body": "<p>A simple example would be to create a <code>.cpp</code> file:</p>\n<pre><code>// cpy.cpp\n#include &lt;iostream&gt;\n\nint main()\n{\n    std::cout &lt;&lt; &quot;Hello World! from C++&quot; &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n<p>And a Python script:</p>\n<pre><code>// cpy.py\nimport subprocess\ncmd = &quot;cpy.cpp&quot;\nsubprocess.call([&quot;g++&quot;, cmd])\nsubprocess.call(&quot;./a.out&quot;)\n</code></pre>\n<p>Then in the terminal, run the Python script:</p>\n<pre><code>~ python cpy.py\n~ Hello World! from C++\n</code></pre>\n<p><strong>EDIT:</strong></p>\n<p>If you want control of calling C++ functions from Python, you will need to create bindings to extend Python with C++. This can be done a number of ways, the Python docs has a thorough raw implementation of how it can be done for simple cases, but also there are libraries such as pybind and boost.Python that can do this for you.</p>\n<p>An example with boost.Python:</p>\n<pre><code>// boost-example.cpp\n#include &lt;iostream&gt;\n#include &lt;boost/python.hpp&gt;\n\nusing namespace boost::python;\n\nint printHello()\n{\n    std::cout &lt;&lt; &quot;Hello, World! from C++&quot; &lt;&lt; std::endl;\n}\n\nBOOST_PYTHON_MODULE(hello)\n{\n        def(&quot;print_hello&quot;, printHello);\n}\n</code></pre>\n<p>You will need to create a shared object file (.so) and make sure to link the appropriate Python headers and libraries. An example might look like:</p>\n<pre><code>g++ printHello.cpp -fPIC -shared -L/usr/lib/python2.7/config-3.7m-x86_64-linux-gnu/ -I/usr/include/python2.7 -lpython2.7 -lboost_python -o hello.so\n</code></pre>\n<p>And in the same directory that you created the <code>hello.so</code> file:</p>\n<pre><code>python\n&gt;&gt;&gt; import hello\n&gt;&gt;&gt; hello.print_hello()\nHello, World! from C++\n</code></pre>\n<p>Boost.Python can be used to do some pretty magic things, including exposing classes, wrapping overloaded functions, exposing global and class variables for reading and writing, hybrid Python/C++ inheritance heirarchies, all with the utility of dramatic performance gains.\nI recommend going through <a href=\"https://www.boost.org/doc/libs/1_68_0/libs/python/doc/html/tutorial/index.html\" rel=\"nofollow noreferrer\">these</a> docs and getting to know the API if you are looking to go down this route.</p>\n"}, {"tags": [], "owner": {"reputation": 2343, "user_id": 9448377, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Wim Lavrijsen", "link": "https://stackoverflow.com/users/9448377/wim-lavrijsen"}, "is_accepted": false, "score": 2, "last_activity_date": 1571763286, "creation_date": 1571763286, "answer_id": 58509029, "question_id": 58422804, "link": "https://stackoverflow.com/questions/58422804/how-can-i-run-a-hello-world-c-code-using-python/58509029#58509029", "title": "How can I run a Hello world c++ code using python", "body": "<p>As an alternative to compiling the C++ code into a separate program and executing that, you can also use cppyy (<a href=\"http://cppyy.org\" rel=\"nofollow noreferrer\">http://cppyy.org</a>) to run the C++ code directly, through a JIT, within the same program.</p>\n\n<p>Example:</p>\n\n<pre><code>import cppyy\ncppyy.cppdef('''\nvoid hello() {\n    std::cout &lt;&lt; \"Hello, World!\" &lt;&lt; std::endl;\n}''')\ncppyy.gbl.hello()   # calls the C++ function 'hello' defined above\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 10591725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jfu5OShbIC0/AAAAAAAAAAI/AAAAAAAAABM/iNW-EufqVHA/photo.jpg?sz=128", "display_name": "IT World", "link": "https://stackoverflow.com/users/10591725/it-world"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1286, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1595468667, "creation_date": 1571267460, "last_edit_date": 1571267795, "question_id": 58422804, "link": "https://stackoverflow.com/questions/58422804/how-can-i-run-a-hello-world-c-code-using-python", "title": "How can I run a Hello world c++ code using python", "body": "<p>I want to know how can I create a python script that run c++ code.</p>\n\n<p>I did find some talks about subprocess module but it's used to run commands \nI did find some talks about Boost and Swig but I didn't understand as a beginner how to use them</p>\n\n<p>Testing subprocess:</p>\n\n<pre><code>import subprocess\nsubprocess.call([\"g++\", \"main.cpp\"],shell = True)\ntmp=subprocess.call(\"main.cpp\",shell = True)\nprint(\"printing result\")\nprint(tmp)\n</code></pre>\n\n<p>Can any one help me please!</p>\n"}, {"tags": ["python", "z3", "sat", "satisfiability"], "comments": [{"owner": {"reputation": 6681, "user_id": 6024122, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uiRWa4coXLs/AAAAAAAAAAI/AAAAAAAAJUs/5BxfhSS1bUY/photo.jpg?sz=128", "display_name": "Patrick Trentin", "link": "https://stackoverflow.com/users/6024122/patrick-trentin"}, "edited": false, "score": 0, "creation_date": 1571321585, "post_id": 58422778, "comment_id": 103209702, "body": "Is there any reason why you are using <code>z3</code> rather than, let&#39;s say, <code>nuXmv</code> or <code>minizinc</code>? The problem would be much more easily solved using one of the last two tools. The problem with <code>SMT</code> tools is that operations like addition/assignment can only be encoded with an increasing number of variables, one for each intermediate stage of the operations. This effort takes the focus away from the real problem."}, {"owner": {"reputation": 125, "user_id": 12229319, "user_type": "registered", "profile_image": "https://graph.facebook.com/2666098840101502/picture?type=large", "display_name": "Anoop Krishna", "link": "https://stackoverflow.com/users/12229319/anoop-krishna"}, "reply_to_user": {"reputation": 6681, "user_id": 6024122, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uiRWa4coXLs/AAAAAAAAAAI/AAAAAAAAJUs/5BxfhSS1bUY/photo.jpg?sz=128", "display_name": "Patrick Trentin", "link": "https://stackoverflow.com/users/6024122/patrick-trentin"}, "edited": false, "score": 0, "creation_date": 1571324106, "post_id": 58422778, "comment_id": 103211192, "body": "My understanding is that NuSMV gives an counter example when the water is above 7.0 but I am not sure if that is the minimum number of steps. In z3 I coded one iteration (filling and emptying)to see if the model is SAT. If unSAT, I kept on adding the iterations until it gives a SAT. This way I can be sure that the water is overflowing in minimum number of steps. Yes it was quite a work to encode the variables in each iteration.  Moreover it was a requirement to implement it on Z3 rather than the other 2"}, {"owner": {"reputation": 6681, "user_id": 6024122, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uiRWa4coXLs/AAAAAAAAAAI/AAAAAAAAJUs/5BxfhSS1bUY/photo.jpg?sz=128", "display_name": "Patrick Trentin", "link": "https://stackoverflow.com/users/6024122/patrick-trentin"}, "edited": false, "score": 0, "creation_date": 1571327481, "post_id": 58422778, "comment_id": 103213054, "body": "One technique to discover short counter-examples with <code>nuXmv</code> is <i>Bounded Model Checking</i>."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 12229319, "user_type": "registered", "profile_image": "https://graph.facebook.com/2666098840101502/picture?type=large", "display_name": "Anoop Krishna", "link": "https://stackoverflow.com/users/12229319/anoop-krishna"}, "edited": false, "score": 0, "creation_date": 1571312514, "post_id": 58424588, "comment_id": 103204120, "body": "Thank you very much, it indeed answered my question"}, {"owner": {"reputation": 125, "user_id": 12229319, "user_type": "registered", "profile_image": "https://graph.facebook.com/2666098840101502/picture?type=large", "display_name": "Anoop Krishna", "link": "https://stackoverflow.com/users/12229319/anoop-krishna"}, "edited": false, "score": 0, "creation_date": 1571332461, "post_id": 58424588, "comment_id": 103215332, "body": "can you please give me an idea on how to find three max&#39;s of cups using if then else condition"}, {"owner": {"reputation": 18055, "user_id": 936310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/302ec54987694b9746abf8e2e0ad8caf?s=128&d=identicon&r=PG&f=1", "display_name": "alias", "link": "https://stackoverflow.com/users/936310/alias"}, "reply_to_user": {"reputation": 125, "user_id": 12229319, "user_type": "registered", "profile_image": "https://graph.facebook.com/2666098840101502/picture?type=large", "display_name": "Anoop Krishna", "link": "https://stackoverflow.com/users/12229319/anoop-krishna"}, "edited": false, "score": 0, "creation_date": 1571340987, "post_id": 58424588, "comment_id": 103218913, "body": "I&#39;m not exactly sure what you&#39;re asking. It&#39;s best to ask a separate question showing what you tried and what happened. Please pose a new question following the MCVE guidelines: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">stackoverflow.com/help/minimal-reproducible-example</a>"}], "tags": [], "owner": {"reputation": 18055, "user_id": 936310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/302ec54987694b9746abf8e2e0ad8caf?s=128&d=identicon&r=PG&f=1", "display_name": "alias", "link": "https://stackoverflow.com/users/936310/alias"}, "is_accepted": true, "score": 3, "last_activity_date": 1571283807, "creation_date": 1571283807, "answer_id": 58424588, "question_id": 58422778, "link": "https://stackoverflow.com/questions/58422778/finding-max-of-the-numbers-in-z3-using-smtlib2/58424588#58424588", "title": "finding max of the numbers in z3 using SMTLIB2", "body": "<p>Sure. Here it is in SMTLib:</p>\n\n<pre><code>; declare the cups\n(declare-const c1 Real)\n(declare-const c2 Real)\n(declare-const c3 Real)\n(declare-const c4 Real)\n(declare-const c5 Real)\n(declare-const c6 Real)\n(declare-const c7 Real)\n\n; each cup has a non-negative units of water\n(assert (&gt;= c1 0))\n(assert (&gt;= c2 0))\n(assert (&gt;= c3 0))\n(assert (&gt;= c4 0))\n(assert (&gt;= c5 0))\n(assert (&gt;= c6 0))\n(assert (&gt;= c7 0))\n\n; each amount is different\n(assert (distinct c1 c2 c3 c4 c5 c6 c7))\n\n; find maximum, helper function\n(define-fun max ((a Real) (b Real)) Real (ite (&gt; a b) a b))\n\n; find the cup with maximum water in it\n(define-fun maxC () Real (max c1 (max c2 (max c3 (max c4 (max c5 (max c6 c7)))))))\n\n; make sure there's at least 2 units in the max, per the problem\n(assert (&gt;= maxC 2))\n\n; final value\n(define-fun finalRes () Real (- maxC 2))\n\n; solve\n(check-sat)\n(get-value (c1 c2 c3 c4 c5 c6 c7 maxC finalRes))\n</code></pre>\n\n<p>z3 says:</p>\n\n<pre><code>sat\n((c1 2.0)\n (c2 (/ 11.0 6.0))\n (c3 (/ 19.0 12.0))\n (c4 (/ 7.0 4.0))\n (c5 (/ 3.0 2.0))\n (c6 (/ 23.0 12.0))\n (c7 (/ 5.0 3.0))\n (maxC 2.0)\n (finalRes 0.0))\n</code></pre>\n\n<p>So, looks like it put <code>2</code> units in <code>c1</code>, less than <code>2</code> on all the others, so you ended up with a final value of <code>0</code> left.</p>\n\n<p>Your question is rather vague in what other constraints might be at play here, but hopefully this will get you started.</p>\n"}, {"comments": [{"owner": {"reputation": 18055, "user_id": 936310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/302ec54987694b9746abf8e2e0ad8caf?s=128&d=identicon&r=PG&f=1", "display_name": "alias", "link": "https://stackoverflow.com/users/936310/alias"}, "edited": false, "score": 0, "creation_date": 1571316861, "post_id": 58431728, "comment_id": 103206757, "body": "Nice! I wonder what the performance implications are when you don\u2019t use if-then-else but just resort to comparisons like this."}, {"owner": {"reputation": 6681, "user_id": 6024122, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uiRWa4coXLs/AAAAAAAAAAI/AAAAAAAAJUs/5BxfhSS1bUY/photo.jpg?sz=128", "display_name": "Patrick Trentin", "link": "https://stackoverflow.com/users/6024122/patrick-trentin"}, "reply_to_user": {"reputation": 18055, "user_id": 936310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/302ec54987694b9746abf8e2e0ad8caf?s=128&d=identicon&r=PG&f=1", "display_name": "alias", "link": "https://stackoverflow.com/users/936310/alias"}, "edited": false, "score": 0, "creation_date": 1571318009, "post_id": 58431728, "comment_id": 103207507, "body": "@alias I guess it depends on the solver, and whether there are symmetries in the problem, like in this case, or not."}, {"owner": {"reputation": 125, "user_id": 12229319, "user_type": "registered", "profile_image": "https://graph.facebook.com/2666098840101502/picture?type=large", "display_name": "Anoop Krishna", "link": "https://stackoverflow.com/users/12229319/anoop-krishna"}, "edited": false, "score": 0, "creation_date": 1571319577, "post_id": 58431728, "comment_id": 103208495, "body": "yes  it helped!!  Is it possible to define a function in Z3 such a way that it will take the 7 cups and find the three cups with highest value and remove  a specific different amount from each cup?? 1stmax -2.0 ; 2nd max- 1.5 ; 3rd max -1.0  for a better understanding, I have attached the problem statement to the question"}, {"owner": {"reputation": 6681, "user_id": 6024122, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uiRWa4coXLs/AAAAAAAAAAI/AAAAAAAAJUs/5BxfhSS1bUY/photo.jpg?sz=128", "display_name": "Patrick Trentin", "link": "https://stackoverflow.com/users/6024122/patrick-trentin"}, "reply_to_user": {"reputation": 125, "user_id": 12229319, "user_type": "registered", "profile_image": "https://graph.facebook.com/2666098840101502/picture?type=large", "display_name": "Anoop Krishna", "link": "https://stackoverflow.com/users/12229319/anoop-krishna"}, "edited": false, "score": 0, "creation_date": 1571327630, "post_id": 58431728, "comment_id": 103213141, "body": "@AnoopKrishna it is definitely possible, albeit not efficient. The second-maximum   <code>max_2</code> must be smaller or equal all <code>c_i</code>, strictly smaller than the absolute maximum <code>max_1</code>, and larger or equal all-but-one variables <code>c_1</code>."}], "tags": [], "owner": {"reputation": 6681, "user_id": 6024122, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uiRWa4coXLs/AAAAAAAAAAI/AAAAAAAAJUs/5BxfhSS1bUY/photo.jpg?sz=128", "display_name": "Patrick Trentin", "link": "https://stackoverflow.com/users/6024122/patrick-trentin"}, "is_accepted": false, "score": 2, "last_activity_date": 1571312199, "creation_date": 1571312199, "answer_id": 58431728, "question_id": 58422778, "link": "https://stackoverflow.com/questions/58422778/finding-max-of-the-numbers-in-z3-using-smtlib2/58431728#58431728", "title": "finding max of the numbers in z3 using SMTLIB2", "body": "<p>Here's an alternative approach for finding <code>max</code> that doesn't use <code>ITE</code>.</p>\n\n<pre><code>; declare the cups\n(declare-const c1 Real)\n(declare-const c2 Real)\n(declare-const c3 Real)\n(declare-const c4 Real)\n(declare-const c5 Real)\n(declare-const c6 Real)\n(declare-const c7 Real)\n\n; each cup has a non-negative units of water\n(assert (&gt;= c1 0))\n(assert (&gt;= c2 0))\n(assert (&gt;= c3 0))\n(assert (&gt;= c4 0))\n(assert (&gt;= c5 0))\n(assert (&gt;= c6 0))\n(assert (&gt;= c7 0))\n\n; each amount is different\n(assert (distinct c1 c2 c3 c4 c5 c6 c7))\n\n(declare-fun max () Real)\n\n(assert (and (&lt;= c1 max) (&lt;= c2 max) (&lt;= c3 max) (&lt;= c4 max) (&lt;= c5 max) (&lt;= c6 max) (&lt;= c7 max)))\n\n(assert (or (&lt;= max c1) (&lt;= max c2) (&lt;= max c3) (&lt;= max c4) (&lt;= max c5) (&lt;= max c6) (&lt;= max c7) ))\n\n; make sure there's at least 2 units in the max, per the problem\n(assert (&lt;= 2 max))\n\n; final value\n(define-fun finalRes () Real (- max 2))\n\n; solve\n(check-sat)\n(get-value (c1 c2 c3 c4 c5 c6 c7 maxC finalRes))\n</code></pre>\n\n<p>And the result:</p>\n\n<pre><code>sat\n((c1 2.0)\n (c2 (/ 4.0 3.0))\n (c3 0.0)\n (c4 (/ 1.0 3.0))\n (c5 1.0)\n (c6 (/ 2.0 3.0))\n (c7 (/ 5.0 3.0))\n (max 2.0)\n (finalRes 0.0))\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 12229319, "user_type": "registered", "profile_image": "https://graph.facebook.com/2666098840101502/picture?type=large", "display_name": "Anoop Krishna", "link": "https://stackoverflow.com/users/12229319/anoop-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 58424588, "answer_count": 2, "score": 2, "last_activity_date": 1597362149, "creation_date": 1571267246, "last_edit_date": 1597362149, "question_id": 58422778, "link": "https://stackoverflow.com/questions/58422778/finding-max-of-the-numbers-in-z3-using-smtlib2", "title": "finding max of the numbers in z3 using SMTLIB2", "body": "<p>I have 7 cups which contains some water. I need to program these cups to have different amounts of water. Once this is done I need to measure the cup which has the highest amount of water and then remove some quantity (say 2 units of water).</p>\n<p>c implementations:</p>\n<pre><code>float c1=2.0, c2= 2.6, c3 = 2.8, c4=4.4 , c5 = 2.4, c6 = 2.1, c7 = 5.8;\n\nif((c1 &gt; c2) &amp;&amp; (c1 &gt; c3) &amp;&amp; (c1 &gt; c4) &amp;&amp; (c1 &gt; c5) &amp;&amp; (c1 &gt; c6) &amp;&amp; (c1 &gt; c7)); c1=c1-2;\n\nif((c2 &gt; c1) &amp;&amp; (c2 &gt; c3) &amp;&amp; (c2 &gt; c4) &amp;&amp; (c2 &gt; c5) &amp;&amp; (c2 &gt; c6) &amp;&amp; (c2 &gt; c7)); c2=c2-2;\n\nif((c3 &gt; c2) &amp;&amp; (c3 &gt; c1) &amp;&amp; (c3 &gt; c4) &amp;&amp; (c3 &gt; c5) &amp;&amp; (c3 &gt; c6) &amp;&amp; (c3 &gt; c7)); c3=c3-2;\n\nif((c4 &gt; c2) &amp;&amp; (c4 &gt; c3) &amp;&amp; (c4 &gt; c1) &amp;&amp; (c4 &gt; c5) &amp;&amp; (c4 &gt; c6) &amp;&amp; (c4 &gt; c7)); c4=c4-2;\n\nif((c5 &gt; c2) &amp;&amp; (c5 &gt; c3) &amp;&amp; (c5 &gt; c4) &amp;&amp; (c5 &gt; c1) &amp;&amp; (c5 &gt; c6) &amp;&amp; (c5 &gt; c7)); c5=c5-2;\n\nif((c6 &gt; c2) &amp;&amp; (c6 &gt; c3) &amp;&amp; (c6 &gt; c4) &amp;&amp; (c6 &gt; c5) &amp;&amp; (c6 &gt; c1) &amp;&amp; (c6 &gt; c7)); c6=c6-2;\n\nif((c7 &gt; c2) &amp;&amp; (c7 &gt; c3) &amp;&amp; (c7 &gt; c4) &amp;&amp; (c7 &gt; c5) &amp;&amp; (c7 &gt; c6) &amp;&amp; (c7 &gt; c1)); c7=c7-2; \n</code></pre>\n<p>This will give an answer as <code>c7 = 3.8</code></p>\n<p>I was trying to implement this in z3 and I assigned the values to c1....c7</p>\n<pre><code>ite( (and((&gt; c1  c2) (&gt; c1  c3) (&gt; c1  c4) (&gt; c1  c5) (&gt; c1  c6) (&gt; c1  c7)))  (= c1_1 (- c1 2)  (= c1_1 c1))\n.\n.\n.repeated till c7_1\n</code></pre>\n<p>and when I get the model values it should give c7_1 as 3.8</p>\n<p>Is it possible to define this in z3? When I am using the and's of different conditions in if condition (in ite) its giving me an error. Can it not be defined like this? Is there someway around this?</p>\n<p>Thanks in advance</p>\n<p>[problem description][1]</p>\n<p>I am experimenting with the Z3 tool, It was easy to get he first part However for the second part is being a bit difficult.</p>\n"}, {"tags": ["python", "python-3.x"], "comments": [{"owner": {"reputation": 373, "user_id": 8887463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dc014308635f1f5b9569b8600f511b7?s=128&d=identicon&r=PG&f=1", "display_name": "Anubhav", "link": "https://stackoverflow.com/users/8887463/anubhav"}, "edited": false, "score": 1, "creation_date": 1571267571, "post_id": 58422777, "comment_id": 103187782, "body": "I think I see what&#39;s going on now. The minus sign is being evaluated after the power sign by python. So (-5)**0.333 will return the same complex number as operator.pow"}, {"owner": {"reputation": 753, "user_id": 12055383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d06db026197c4978ac0fdfef63891b?s=128&d=identicon&r=PG&f=1", "display_name": "askaroni", "link": "https://stackoverflow.com/users/12055383/askaroni"}, "edited": false, "score": 0, "creation_date": 1571267641, "post_id": 58422777, "comment_id": 103187798, "body": "That&#39;s not it. Fractional powers of negative numbers are just weird."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1571268484, "post_id": 58422777, "comment_id": 103188007, "body": "<code>pow()</code> has, correctly, returned a complex result. You can&#39;t expect a complex result and a scalar result to have the same numbers in them, let alone the same value"}, {"owner": {"reputation": 263603, "user_id": 674039, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/leoFi.gif?s=128&g=1", "display_name": "wim", "link": "https://stackoverflow.com/users/674039/wim"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1571274041, "post_id": 58422777, "comment_id": 103189101, "body": "@user207421  try <code>-3**2</code> then.  The power operator binds more tightly than unary operators on its left; it binds less tightly than unary operators on its right (see <a href=\"https://docs.python.org/3/reference/expressions.html#the-power-operator\" rel=\"nofollow noreferrer\">docs</a>)"}, {"owner": {"reputation": 263603, "user_id": 674039, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/leoFi.gif?s=128&g=1", "display_name": "wim", "link": "https://stackoverflow.com/users/674039/wim"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1571274887, "post_id": 58422777, "comment_id": 103189263, "body": "@user207421 Huh? Are you talking about a different language?  The grammar for Python is <a href=\"https://docs.python.org/3/reference/grammar.html\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 263603, "user_id": 674039, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/leoFi.gif?s=128&g=1", "display_name": "wim", "link": "https://stackoverflow.com/users/674039/wim"}, "edited": false, "score": 0, "creation_date": 1571294601, "post_id": 58422777, "comment_id": 103194219, "body": "It seems I am totally wrong about this: my apologies to @wim. The question remains why the Python authors overturned centuries of mathematics and six decades of programming language implementations by changing the precedence of exponentiation. One wonders whether they got the associavity wrong as well: it should be right-associative."}], "answers": [{"tags": [], "owner": {"reputation": 263603, "user_id": 674039, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/leoFi.gif?s=128&g=1", "display_name": "wim", "link": "https://stackoverflow.com/users/674039/wim"}, "is_accepted": true, "score": 3, "last_activity_date": 1571294639, "last_edit_date": 1571294639, "creation_date": 1571274349, "answer_id": 58423525, "question_id": 58422777, "link": "https://stackoverflow.com/questions/58422777/operator-pow-returns-a-different-value-than/58423525#58423525", "title": "operator pow() returns a different value than **", "body": "<p>In Python the power operator <code>**</code> binds more tightly than unary operators on its left; it binds less tightly than unary operators on its right (see <a href=\"https://docs.python.org/3/reference/expressions.html#the-power-operator\" rel=\"nofollow noreferrer\">docs</a>).</p>\n\n<p>Therefore the correct equivalence to <code>pow(-5, 0.333)</code> is <code>(-5)**0.333</code>. And the correct equivalance to <code>-5**0.333</code> is <code>-pow(5, 0.333)</code>.</p>\n\n<p>You may verify the operator precedence with an abstract syntax tree parse / dump:</p>\n\n<pre><code>&gt;&gt;&gt; import ast\n&gt;&gt;&gt; ast.dump(ast.parse(\"-5**0.333\"), annotate_fields=False)\n'Module([Expr(UnaryOp(USub(), BinOp(Num(5), Pow(), Num(0.333))))])'\n&gt;&gt;&gt; astdump.indented(\"-5**0.333\")  # pip install astdump\nModule\n  Expr\n    UnaryOp\n      USub\n      BinOp\n        Num\n        Pow\n        Num\n</code></pre>\n"}], "owner": {"reputation": 373, "user_id": 8887463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dc014308635f1f5b9569b8600f511b7?s=128&d=identicon&r=PG&f=1", "display_name": "Anubhav", "link": "https://stackoverflow.com/users/8887463/anubhav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 58423525, "answer_count": 1, "score": 0, "last_activity_date": 1571294639, "creation_date": 1571267243, "last_edit_date": 1571270310, "question_id": 58422777, "link": "https://stackoverflow.com/questions/58422777/operator-pow-returns-a-different-value-than", "title": "operator pow() returns a different value than **", "body": "<p>Facing a weird issue here where python's operator.pow is returning a different value than **</p>\n\n<pre><code>import operator\npow(-5,0.333)\n&gt;&gt; (0.856078889075021+1.4791926873843961j)\n\n-5**0.333\n&gt;&gt; -1.709058826000847\n</code></pre>\n\n<p>What am I missing here? I need it to say -1.709 instead of the complex number to work with the rest of my code structure.</p>\n"}, {"tags": ["python", "go"], "comments": [{"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1571268239, "post_id": 58422762, "comment_id": 103187938, "body": "If you want to copy environment variable sets around, I&#39;d suggest the canonical NUL-delimited-list format used by <code>&#47;proc&#47;&lt;pid&gt;&#47;environ</code>. It&#39;s easy to parse in <i>any</i> language, Python or Go included, and you don&#39;t need any custom tools to generate it if you&#39;re running on the Linux kernel, since the OS itself exports the set (at least, as it existed at process startup time)."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1571268531, "post_id": 58422762, "comment_id": 103188017, "body": "(and if you <i>do</i> need to generate it yourself, <code>for k, v in os.environ.items(): print(&#39;%s=%s\\0&#39;  % (k,v), end=&#39;&#39;)</code> ain&#39;t hard)."}, {"owner": {"reputation": 129, "user_id": 1498043, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/PyxIy.jpg?s=128&g=1", "display_name": "olivier.va", "link": "https://stackoverflow.com/users/1498043/olivier-va"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1571268653, "post_id": 58422762, "comment_id": 103188049, "body": "I am not looking to work with environment variables here, just the variables defined in global scope of a Python script. Your comment did remind me that it needs to be cross platform."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1571268750, "post_id": 58422762, "comment_id": 103188080, "body": "I&#39;m used to &quot;exported&quot; meaning &quot;exported&quot; <i>to the environment</i>, as performed by the <code>export</code> shell command, various <code>setenv()</code> calls, etc. If you&#39;re using it in a different context, it&#39;s not clear to me what the intent is."}, {"owner": {"reputation": 263603, "user_id": 674039, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/leoFi.gif?s=128&g=1", "display_name": "wim", "link": "https://stackoverflow.com/users/674039/wim"}, "edited": false, "score": 0, "creation_date": 1571269128, "post_id": 58422762, "comment_id": 103188146, "body": "What do you mean by &quot;the information should remain in memory only&quot; and &quot;variables exposed by Python scripts&quot;? Scripts don&#39;t expose variables - they just run, maybe print some stuff to stdout or stderr, and then exit with an integer return code. The way that that Python objects are stored in memory is not so simple for go code to just reach in and read them..."}, {"owner": {"reputation": 129, "user_id": 1498043, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/PyxIy.jpg?s=128&g=1", "display_name": "olivier.va", "link": "https://stackoverflow.com/users/1498043/olivier-va"}, "edited": false, "score": 0, "creation_date": 1571270639, "post_id": 58422762, "comment_id": 103188444, "body": "I edited my description to address the questions you have and added a small example of a python script that contains the variables to which I want access in Golang. I am not looking to intertwine Golang and Python at all, I just want to run the Python script with Golang and get the values of those variables in Golang after running the script. I hope this clarifies things!"}, {"owner": {"reputation": 263603, "user_id": 674039, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/leoFi.gif?s=128&g=1", "display_name": "wim", "link": "https://stackoverflow.com/users/674039/wim"}, "edited": false, "score": 1, "creation_date": 1571277990, "post_id": 58422762, "comment_id": 103189864, "body": "Now, that sounds much more reasonable. So, you can just do as you originally suggested - json dump the relevant keys and values to stdout at the end of the Python script (you would need to modify the script directly, or write a wrapper around it)"}, {"owner": {"reputation": 6154, "user_id": 372172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e3e64f71bb0a748cffdf0baec8b95cb?s=128&d=identicon&r=PG", "display_name": "Koala Yeung", "link": "https://stackoverflow.com/users/372172/koala-yeung"}, "edited": false, "score": 1, "creation_date": 1571286028, "post_id": 58422762, "comment_id": 103191517, "body": "They are of different runtime environments. Golang cannot directly access variables in Python&#39;s runtime. Vica versa. You can, however, program them to pass on variable values through standard I/O or environment variables. The key is to determine the proper format for information exchanges."}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 1498043, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/PyxIy.jpg?s=128&g=1", "display_name": "olivier.va", "link": "https://stackoverflow.com/users/1498043/olivier-va"}, "edited": false, "score": 1, "creation_date": 1571310075, "post_id": 58425076, "comment_id": 103202690, "body": "Exactly the solution that I created yesterday as well, but I accept your answer nonetheless as it is correct and works. The dump_globals() you demonstrated here is something I did not think about. It gave me the idea to provide a python module which exposes a function like that which users could simply import and call. Thanks!"}], "tags": [], "owner": {"reputation": 6154, "user_id": 372172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e3e64f71bb0a748cffdf0baec8b95cb?s=128&d=identicon&r=PG", "display_name": "Koala Yeung", "link": "https://stackoverflow.com/users/372172/koala-yeung"}, "is_accepted": true, "score": 2, "last_activity_date": 1571289027, "last_edit_date": 1571289027, "creation_date": 1571287527, "answer_id": 58425076, "question_id": 58422762, "link": "https://stackoverflow.com/questions/58422762/how-do-i-make-variables-from-a-python-module-available-in-go/58425076#58425076", "title": "How do I make variables from a Python module available in Go?", "body": "<p>They are of different runtime environments. Golang cannot directly access variables in Python's runtime. Vica versa. You can, however, program them to pass on variable values through standard I/O or environment variables. The key is to determine the proper format for information exchanges. </p>\n\n<p>For example, if the python script takes arguments as input and print the result, encoded as JSON, to the stdout. Then you can call the script with proper arguments, and decode the stdout as JSON.</p>\n\n<p>Such as:</p>\n\n<h3>range.py</h3>\n\n<pre class=\"lang-py prettyprint-override\"><code>import json\nimport sys\n\ndef toNum(str):\n    return int(str)\n\ndef main(argv):\n    # Basically called range() with all the arguments from script call\n    print(json.dumps(list(range(*map(toNum, argv)))))\n\nif __name__ == '__main__':\n    main(sys.argv[1:])\n</code></pre>\n\n<h3>main.go</h3>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"os/exec\"\n)\n\nfunc pythonRange(start, stop, step int) (c []byte, err error) {\n    return exec.Command(\n        \"python3\",\n        \"./range.py\",\n        fmt.Sprintf(\"%d\", start),\n        fmt.Sprintf(\"%d\", stop),\n        fmt.Sprintf(\"%d\", step),\n    ).Output()\n}\n\nfunc main() {\n    var arr []int\n\n    // get the output of the python script\n    result, err := pythonRange(1, 10, 1)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // decode the stdout of the python script\n    // as a json array of integer\n    err = json.Unmarshal(result, &amp;arr)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // show the result with log.Printf\n    log.Printf(\"%#v\", arr)\n}\n</code></pre>\n\n<h2>Output global variables</h2>\n\n<p>To output global variables in Python as JSON object:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import json\n\ndef dump_globals():\n    # Basically called range() with all the arguments from script call\n    vars = dict()\n    for (key, value) in globals().items():\n        if key.startswith(\"__\") and key.endswith(\"__\"):\n            continue # skip __varname__ variables\n        try:\n            json.dumps(value) # test if value is json serializable\n            vars[key] = value\n        except:\n            continue\n    print(json.dumps(vars))\n\nfoo = \"foo\"\nbar = \"bar\"\n\ndump_globals()\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{\"foo\": \"foo\", \"bar\": \"bar\"}\n</code></pre>\n\n<p>You can use a main() similar to the last one for this script:</p>\n\n<pre><code>\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"os/exec\"\n)\n\nfunc pythonGetVars() (c []byte, err error) {\n    return exec.Command(\n        \"python3\",\n        \"./dump_globals.py\",\n    ).Output()\n}\n\nfunc main() {\n    var vars map[string]interface{}\n\n    // get the output of the python script\n    result, err := pythonGetVars()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // decode the json object\n    err = json.Unmarshal(result, &amp;vars)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // show the result with log.Printf\n    fmt.Printf(\"%#v\", vars)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>map[string]interface {}{\"bar\":\"bar\", \"foo\":\"foo\"}\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 1498043, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/PyxIy.jpg?s=128&g=1", "display_name": "olivier.va", "link": "https://stackoverflow.com/users/1498043/olivier-va"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 1, "accepted_answer_id": 58425076, "answer_count": 1, "score": 0, "last_activity_date": 1571289027, "creation_date": 1571267109, "last_edit_date": 1571270851, "question_id": 58422762, "link": "https://stackoverflow.com/questions/58422762/how-do-i-make-variables-from-a-python-module-available-in-go", "title": "How do I make variables from a Python module available in Go?", "body": "<p>I am building a tool in Go which needs to provide a way to resolve variables declared in the global scope of Python scripts. In the future I would like to extend this to Node.js as well. It needs to be cross-platform.</p>\n\n<p>Basically, if someone were to have the following Python code:</p>\n\n<pre><code>#!/usr/bin/env python\n\nhello = \"world\"\nsome_var = \"one\"\nanother_var = \"two\"\nvar_three = some_func()\n</code></pre>\n\n<p>I would like to have access to these variable keys and values in my Golang code. In case of the function, I would like to have access to the value it returns.</p>\n\n<p>My current idea is to run the script with the Golang <code>exec.Command</code> function and have the variables printed to its stdout in some format (e.g. JSON), which in turn can be parsed with Golang. Thoughts?</p>\n"}, {"tags": ["python", "string", "pandas", "dtype"], "answers": [{"comments": [{"owner": {"reputation": 1069, "user_id": 1143539, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/812727270ca069468a11ef94c5c2d6ef?s=128&d=identicon&r=PG", "display_name": "Roobie Nuby", "link": "https://stackoverflow.com/users/1143539/roobie-nuby"}, "edited": false, "score": 0, "creation_date": 1571307696, "post_id": 58424326, "comment_id": 103201325, "body": "If you had tried that code you would have seen that it does not work. Similarly, <code>d[&#39;a&#39;] = d[&#39;a&#39;].astype(str)</code> does not do anything different."}, {"owner": {"reputation": 259, "user_id": 9656161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb3b539d3d6629f561412d1e0a41988?s=128&d=identicon&r=PG&f=1", "display_name": "T D", "link": "https://stackoverflow.com/users/9656161/t-d"}, "reply_to_user": {"reputation": 1069, "user_id": 1143539, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/812727270ca069468a11ef94c5c2d6ef?s=128&d=identicon&r=PG", "display_name": "Roobie Nuby", "link": "https://stackoverflow.com/users/1143539/roobie-nuby"}, "edited": false, "score": 0, "creation_date": 1571329477, "post_id": 58424326, "comment_id": 103214071, "body": "I tried that code, or else would not have posted. As stated, maybe not understanding the question. Apologies"}, {"owner": {"reputation": 1069, "user_id": 1143539, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/812727270ca069468a11ef94c5c2d6ef?s=128&d=identicon&r=PG", "display_name": "Roobie Nuby", "link": "https://stackoverflow.com/users/1143539/roobie-nuby"}, "edited": false, "score": 0, "creation_date": 1571374082, "post_id": 58424326, "comment_id": 103226964, "body": "Apologies for jumping to conclusions, but when I did it, <code>d.dtypes</code> only had <code>object</code> types and not <code>str</code> or <code>|S1</code>."}, {"owner": {"reputation": 259, "user_id": 9656161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb3b539d3d6629f561412d1e0a41988?s=128&d=identicon&r=PG&f=1", "display_name": "T D", "link": "https://stackoverflow.com/users/9656161/t-d"}, "reply_to_user": {"reputation": 1069, "user_id": 1143539, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/812727270ca069468a11ef94c5c2d6ef?s=128&d=identicon&r=PG", "display_name": "Roobie Nuby", "link": "https://stackoverflow.com/users/1143539/roobie-nuby"}, "edited": false, "score": 0, "creation_date": 1571394650, "post_id": 58424326, "comment_id": 103235838, "body": "I was under the impression that pandas stores str as object. All of my string formats come out dtype object. What are you trying to do with the string that object dtype does not suffice? Also have you tried astype(&#39;str&#39;) in addition to str without quotes?"}, {"owner": {"reputation": 1069, "user_id": 1143539, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/812727270ca069468a11ef94c5c2d6ef?s=128&d=identicon&r=PG", "display_name": "Roobie Nuby", "link": "https://stackoverflow.com/users/1143539/roobie-nuby"}, "edited": false, "score": 0, "creation_date": 1571395204, "post_id": 58424326, "comment_id": 103236123, "body": "If you note, when you convert the entire dataframe to <code>|S1</code>, then the dtypes are not <code>object</code>s, but are <code>|S1</code>. So it is possible to have an <code>|S1</code> dtype in a dataframe column. This does not work for <code>str</code> which is always an object. As to why, an <code>|S1</code> is a single byte and takes much less space. I have a huge dataframe."}, {"owner": {"reputation": 259, "user_id": 9656161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb3b539d3d6629f561412d1e0a41988?s=128&d=identicon&r=PG&f=1", "display_name": "T D", "link": "https://stackoverflow.com/users/9656161/t-d"}, "reply_to_user": {"reputation": 1069, "user_id": 1143539, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/812727270ca069468a11ef94c5c2d6ef?s=128&d=identicon&r=PG", "display_name": "Roobie Nuby", "link": "https://stackoverflow.com/users/1143539/roobie-nuby"}, "edited": false, "score": 0, "creation_date": 1571580054, "post_id": 58424326, "comment_id": 103280635, "body": "I see... Have you checked around to see if |S1 is even available to return as a value via .dtypes?"}, {"owner": {"reputation": 1069, "user_id": 1143539, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/812727270ca069468a11ef94c5c2d6ef?s=128&d=identicon&r=PG", "display_name": "Roobie Nuby", "link": "https://stackoverflow.com/users/1143539/roobie-nuby"}, "edited": false, "score": 0, "creation_date": 1571658858, "post_id": 58424326, "comment_id": 103302279, "body": "As noted in the post, when you convert the whole dataframe, then the dtype <code>|S1</code> shows up (look at the last dtype printout)."}], "tags": [], "owner": {"reputation": 259, "user_id": 9656161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb3b539d3d6629f561412d1e0a41988?s=128&d=identicon&r=PG&f=1", "display_name": "T D", "link": "https://stackoverflow.com/users/9656161/t-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1571281718, "creation_date": 1571281718, "answer_id": 58424326, "question_id": 58422754, "link": "https://stackoverflow.com/questions/58422754/pandas-convert-object-column-to-string-type/58424326#58424326", "title": "pandas convert object column to string type", "body": "<p>Hopefully this helps if I understand the issue:</p>\n\n<p>Try overwriting the column instead of assigning it to s</p>\n\n<pre><code>d = pd.DataFrame({'a':['x', 'y'], 'b': ['s', 't']})\nd['a'] = d['a'].astype('|S1')\n</code></pre>\n\n<p>I have always been accustomed to using .astype(str), but not sure of your specific situation. </p>\n"}], "owner": {"reputation": 1069, "user_id": 1143539, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/812727270ca069468a11ef94c5c2d6ef?s=128&d=identicon&r=PG", "display_name": "Roobie Nuby", "link": "https://stackoverflow.com/users/1143539/roobie-nuby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 769, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571281718, "creation_date": 1571267018, "last_edit_date": 1571268183, "question_id": 58422754, "link": "https://stackoverflow.com/questions/58422754/pandas-convert-object-column-to-string-type", "title": "pandas convert object column to string type", "body": "<p>I don't understand the following strange conversion behavior in pandas:</p>\n\n<pre><code>d = pd.DataFrame({'a':['x', 'y'], 'b': ['s', 't']})\ns = d['a'].astype('|S1')\nprint(s.dtypes)\nd['a'] = s\nprint(d.dtypes)\nprint(s.dtypes)\nprint(d.astype('|S1').dtypes)\n</code></pre>\n\n<p>produced the output:</p>\n\n<pre><code>|S1\na    object\nb    object\ndtype: object\n|S1\na    |S1\nb    |S1\ndtype: object\n</code></pre>\n\n<p>When I convert a column as a <code>pd.Series</code> it gets converted, but when put back into the <code>DataFrame</code>, it reverts back to <code>Object</code>. But the whole 'DataFrame` can be converted. What gives?</p>\n\n<p>I have been scouring the documentation to find some reference to this behavior, but didn't find any clue.</p>\n\n<p>Just for completeness, here is an abbreviated version:</p>\n\n<pre><code>python           : 3.7.3.final.0\npython-bits      : 64\nOS               : Windows\nOS-release       : 10\nmachine          : AMD64\nprocessor        : Intel64 Family 6 Model 158 Stepping 9, GenuineIntel\n\npandas           : 0.25.1\nnumpy            : 1.17.1\n</code></pre>\n"}, {"tags": ["python", "pandas"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1571267159, "post_id": 58422742, "comment_id": 103187694, "body": "Numeric strings default to <code>float</code> when writing CSV."}, {"owner": {"reputation": 8358, "user_id": 946137, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KoJf3.jpg?s=128&g=1", "display_name": "Ratha", "link": "https://stackoverflow.com/users/946137/ratha"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1571267190, "post_id": 58422742, "comment_id": 103187698, "body": "@Barmar, how to avoid that?Due to that issue i was changing all columns datatype to string"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1571267236, "post_id": 58422742, "comment_id": 103187711, "body": "Set the <code>dtype</code> to <code>int64</code> or <code>str</code>"}, {"owner": {"reputation": 8358, "user_id": 946137, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KoJf3.jpg?s=128&g=1", "display_name": "Ratha", "link": "https://stackoverflow.com/users/946137/ratha"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1571267272, "post_id": 58422742, "comment_id": 103187718, "body": "@Barmar, I think i do that in my above code. Changing all columns datatype to string. astype(str)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1571267363, "post_id": 58422742, "comment_id": 103187736, "body": "I think there are options to <code>.to_csv()</code> that will specify the types in the file."}, {"owner": {"reputation": 370, "user_id": 5703092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0YuUi.jpg?s=128&g=1", "display_name": "the_good_pony", "link": "https://stackoverflow.com/users/5703092/the-good-pony"}, "edited": false, "score": 0, "creation_date": 1571267433, "post_id": 58422742, "comment_id": 103187751, "body": "hey! do you you have nulls in your data? &quot;Because NaN is a float, this forces an array of integers with any missing values to become floating point.&quot; <a href=\"https://pandas.pydata.org/pandas-docs/stable/user_guide/integer_na.html\" rel=\"nofollow noreferrer\">pandas.pydata.org/pandas-docs/stable/user_guide/integer_na.h&zwnj;&#8203;tml</a>"}, {"owner": {"reputation": 8358, "user_id": 946137, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KoJf3.jpg?s=128&g=1", "display_name": "Ratha", "link": "https://stackoverflow.com/users/946137/ratha"}, "reply_to_user": {"reputation": 370, "user_id": 5703092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0YuUi.jpg?s=128&g=1", "display_name": "the_good_pony", "link": "https://stackoverflow.com/users/5703092/the-good-pony"}, "edited": false, "score": 0, "creation_date": 1571267492, "post_id": 58422742, "comment_id": 103187765, "body": "@the_good_pony no NULLS. all data like numerics convreted as float"}, {"owner": {"reputation": 8358, "user_id": 946137, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KoJf3.jpg?s=128&g=1", "display_name": "Ratha", "link": "https://stackoverflow.com/users/946137/ratha"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1571267687, "post_id": 58422742, "comment_id": 103187806, "body": "@Barmar Any example?i couldn&#39;t find. Even though I change the type before writing to a file, again do we need to specify?"}, {"owner": {"reputation": 370, "user_id": 5703092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0YuUi.jpg?s=128&g=1", "display_name": "the_good_pony", "link": "https://stackoverflow.com/users/5703092/the-good-pony"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1571267822, "post_id": 58422742, "comment_id": 103187826, "body": "@Barmar are you refering to the float_format option in to_csv()?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1571268076, "post_id": 58422742, "comment_id": 103187888, "body": "No, that&#39;s not it. I helped someone a couple of weeks ago with something similar, but I can&#39;t find it now. I&#39;m not really a pandas expert."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1571268239, "post_id": 58422742, "comment_id": 103187937, "body": "Related: <a href=\"https://stackoverflow.com/questions/42543131/pandas-automatically-converting-my-string-column-to-float\" title=\"pandas automatically converting my string column to float\">stackoverflow.com/questions/42543131/&hellip;</a> This is about reading excel files. I can&#39;t find something similar when writing CSV."}, {"owner": {"reputation": 8358, "user_id": 946137, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KoJf3.jpg?s=128&g=1", "display_name": "Ratha", "link": "https://stackoverflow.com/users/946137/ratha"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1571271052, "post_id": 58422742, "comment_id": 103188518, "body": "@Barmar I added the answer"}], "answers": [{"tags": [], "owner": {"reputation": 8358, "user_id": 946137, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KoJf3.jpg?s=128&g=1", "display_name": "Ratha", "link": "https://stackoverflow.com/users/946137/ratha"}, "is_accepted": false, "score": 0, "last_activity_date": 1571271034, "creation_date": 1571271034, "answer_id": 58423172, "question_id": 58422742, "link": "https://stackoverflow.com/questions/58422742/why-pandas-adding-0-at-the-end-of-strings/58423172#58423172", "title": "Why pandas adding &#39;.0&#39; at the end of strings?", "body": "<p>I fixed like this;\nI added converters parameter and making sure all those problematic columns should remain as strings in my case.</p>\n\n<pre><code> data = pd.read_csv(filepath, converters={\"SiteCode\":str,'Date':str,'Tank ID':str,'SIRA RECORD ID':str}\n....\n data.to_csv(neo_path,index=False)\n</code></pre>\n\n<p>In this case I get rid of, converting all column types as string as pointed in my quetsion.</p>\n\n<pre><code> for col in data.columns:\n        data[col] = data[col].astype(str) \n</code></pre>\n\n<p>: This didnt work when writing the output to csv. It converts string back again to float</p>\n"}], "owner": {"reputation": 8358, "user_id": 946137, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KoJf3.jpg?s=128&g=1", "display_name": "Ratha", "link": "https://stackoverflow.com/users/946137/ratha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 234, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1571289124, "creation_date": 1571266959, "last_edit_date": 1571289124, "question_id": 58422742, "link": "https://stackoverflow.com/questions/58422742/why-pandas-adding-0-at-the-end-of-strings", "title": "Why pandas adding &#39;.0&#39; at the end of strings?", "body": "<p>I'm processing a csv file. Source file contain value as '20190801'. Pandas detects it as <code>int</code> or <code>float</code> for different files. But before writing the output, I convert all columns to string and datatype shows all columns as object. But the output containing <code>.0</code> at the end. Why is that?</p>\n\n<p>e.g: 20190801.0</p>\n\n<pre><code>   for col in data.columns:\n        data[col] = data[col].astype(str)\n    print(data.dtypes) &lt;-- prints all columns datatypes as object\n\n    data.to_csv(neo_path, index=False)\n</code></pre>\n"}, {"tags": ["python", "numpy", "cython", "numba"], "comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1571268985, "post_id": 58422690, "comment_id": 103188123, "body": "Option #1 is completely different from options 2 &amp; 3. It returns a new array of booleans (cast to the original <code>dtype</code>), not a new filtered array."}, {"owner": {"reputation": 18268, "user_id": 5218354, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-NEO9rZKeffY/AAAAAAAAAAI/AAAAAAAAAKc/9IttO1jUOr4/photo.jpg=k-s128", "display_name": "norok2", "link": "https://stackoverflow.com/users/5218354/norok2"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1571269135, "post_id": 58422690, "comment_id": 103188151, "body": "@ShadowRanger Thanks for spotting that, fixed now."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 2, "creation_date": 1571270264, "post_id": 58422690, "comment_id": 103188376, "body": "K. One additional note: <code>numpy</code>&#39;s own docs discourage using <code>numpy.where</code> with just a condition. <code>numpy.where(condition)</code> (only a condition, no <code>x</code>/<code>y</code> args) is equivalent to <code>numpy.asarray(condition).nonzero()</code>; the recommended approach is to call <code>.nonzero()</code> directly, e.g. <code>arr[(arr &lt; k).nonzero()]</code>. Handles subclasses correctly, and runs a little faster that way to boot."}, {"owner": {"reputation": 2479, "user_id": 11301900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8826c4b7675bd83127fddefc109b7f5d?s=128&d=identicon&r=PG&f=1", "display_name": "AMC", "link": "https://stackoverflow.com/users/11301900/amc"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1571278634, "post_id": 58422690, "comment_id": 103190004, "body": "@ShadowRanger do you have any idea what the difference between <code>arr[(arr &gt; k).nonzero()]</code> and <code>arr[arr &gt; k]</code> would be? They perform identically on some simple tests."}, {"owner": {"reputation": 18268, "user_id": 5218354, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-NEO9rZKeffY/AAAAAAAAAAI/AAAAAAAAAKc/9IttO1jUOr4/photo.jpg=k-s128", "display_name": "norok2", "link": "https://stackoverflow.com/users/5218354/norok2"}, "reply_to_user": {"reputation": 2479, "user_id": 11301900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8826c4b7675bd83127fddefc109b7f5d?s=128&d=identicon&r=PG&f=1", "display_name": "AMC", "link": "https://stackoverflow.com/users/11301900/amc"}, "edited": false, "score": 0, "creation_date": 1571398106, "post_id": 58422690, "comment_id": 103237555, "body": "@AlexanderC&#233;cile I have included it in the tests and the short answer is &quot;not so much&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 47088, "user_id": 7207392, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dadc9567dde5f02b09a29695eca1ce40?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Panzer", "link": "https://stackoverflow.com/users/7207392/paul-panzer"}, "edited": false, "score": 4, "creation_date": 1571274706, "post_id": 58422691, "comment_id": 103189224, "body": "Nice effort---I have long suspected that passing a mask through <code>where</code> is typically faster (though it shouldn&#39;t be), so thanks for confirming that. I don&#39;t think, though, that the Cython and numba implementations are fair. Both basically leak the over allocated memory, something a proper library function isn&#39;t allowed to do."}, {"owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1571286063, "post_id": 58422691, "comment_id": 103191527, "body": "The differences between cython and numba for medium-sizes are probably due to gcc vs clang, gcc seems to have problems to get best out of such filtering functions (see also <a href=\"https://stackoverflow.com/q/52046301/5769463\">stackoverflow.com/q/52046301/5769463</a>). For larger sizes, i.e. other cache-levels, the task becomes more and more memory-bound and thus there are less differences between cython and numba."}, {"owner": {"reputation": 18268, "user_id": 5218354, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-NEO9rZKeffY/AAAAAAAAAAI/AAAAAAAAAKc/9IttO1jUOr4/photo.jpg=k-s128", "display_name": "norok2", "link": "https://stackoverflow.com/users/5218354/norok2"}, "reply_to_user": {"reputation": 47088, "user_id": 7207392, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dadc9567dde5f02b09a29695eca1ce40?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Panzer", "link": "https://stackoverflow.com/users/7207392/paul-panzer"}, "edited": false, "score": 0, "creation_date": 1571298766, "post_id": 58422691, "comment_id": 103196246, "body": "@PaulPanzer I have added an extra call to <code>.copy()</code> before returning the results. This should make sure no memory leaks."}, {"owner": {"reputation": 5208, "user_id": 4045774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c23c0c730b6a9cb71d1ce17838f2beb7?s=128&d=identicon&r=PG&f=1", "display_name": "max9111", "link": "https://stackoverflow.com/users/4045774/max9111"}, "edited": false, "score": 1, "creation_date": 1571323189, "post_id": 58422691, "comment_id": 103210644, "body": "It would be almost in every case faster to run the for loop twice. (Fist run to get the final array size, Second run to copy the data which fulfills the condition to the output array allocated with the final size from the first run)"}, {"owner": {"reputation": 5208, "user_id": 4045774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c23c0c730b6a9cb71d1ce17838f2beb7?s=128&d=identicon&r=PG&f=1", "display_name": "max9111", "link": "https://stackoverflow.com/users/4045774/max9111"}, "edited": false, "score": 1, "creation_date": 1571325249, "post_id": 58422691, "comment_id": 103211822, "body": "As the code gets a bit longer, it maybe also useful to write a function which generates the custom filter based on a given condition (&gt;,&lt;,==,..) instead of hard-coding the condition. eg. <a href=\"https://stackoverflow.com/a/58418715/4045774\">stackoverflow.com/a/58418715/4045774</a> Small functions are getting inlined, so there shouldn&#39;t be any decrease in performance."}, {"owner": {"reputation": 18268, "user_id": 5218354, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-NEO9rZKeffY/AAAAAAAAAAI/AAAAAAAAAKc/9IttO1jUOr4/photo.jpg=k-s128", "display_name": "norok2", "link": "https://stackoverflow.com/users/5218354/norok2"}, "reply_to_user": {"reputation": 5208, "user_id": 4045774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c23c0c730b6a9cb71d1ce17838f2beb7?s=128&d=identicon&r=PG&f=1", "display_name": "max9111", "link": "https://stackoverflow.com/users/4045774/max9111"}, "edited": false, "score": 0, "creation_date": 1571332270, "post_id": 58422691, "comment_id": 103215249, "body": "@max9111 thanks for your inputs, your comments hint towards useful modification. I am running the new benchmarks and will update the answer accordingly. Passing functions instead of hardcoding the condition does decrease the performances, but it is only noticeable for the smallest input sizes. The two-passes approach goes from slower to faster than single-pass as the input size increases."}, {"owner": {"reputation": 5208, "user_id": 4045774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c23c0c730b6a9cb71d1ce17838f2beb7?s=128&d=identicon&r=PG&f=1", "display_name": "max9111", "link": "https://stackoverflow.com/users/4045774/max9111"}, "edited": false, "score": 0, "creation_date": 1571333910, "post_id": 58422691, "comment_id": 103215985, "body": "Don&#39;t use global variables, default values like <code>smaller_than(x, k=K)</code> or passing the condition on every call (generate the function only once). This will lead to recompilation on every call and therefore to decreased performance especially on small input sizes."}, {"owner": {"reputation": 3773, "user_id": 1838257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/540386102f92985c85ced9c6b237dd60?s=128&d=identicon&r=PG", "display_name": "jorijnsmit", "link": "https://stackoverflow.com/users/1838257/jorijnsmit"}, "edited": false, "score": 0, "creation_date": 1608068794, "post_id": 58422691, "comment_id": 115469006, "body": "Was hoping for a TL;DR somewhere."}], "tags": [], "owner": {"reputation": 18268, "user_id": 5218354, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-NEO9rZKeffY/AAAAAAAAAAI/AAAAAAAAAKc/9IttO1jUOr4/photo.jpg=k-s128", "display_name": "norok2", "link": "https://stackoverflow.com/users/5218354/norok2"}, "is_accepted": true, "score": 53, "last_activity_date": 1571351950, "last_edit_date": 1571351950, "creation_date": 1571266589, "answer_id": 58422691, "question_id": 58422690, "link": "https://stackoverflow.com/questions/58422690/filtering-a-numpy-array-what-is-the-best-approach/58422691#58422691", "title": "Filtering a NumPy Array: what is the best approach?", "body": "<h1>Definitions</h1>\n\n<ol>\n<li>Using generators:</li>\n</ol>\n\n<pre class=\"lang-py prettyprint-override\"><code>def filter_fromiter(arr, k):\n    return np.fromiter((x for x in arr if x &lt; k), dtype=arr.dtype)\n</code></pre>\n\n<ol start=\"2\">\n<li>Using boolean mask slicing:</li>\n</ol>\n\n<pre class=\"lang-py prettyprint-override\"><code>def filter_mask(arr, k):\n    return arr[arr &lt; k]\n</code></pre>\n\n<ol start=\"3\">\n<li>Using <code>np.where()</code>:</li>\n</ol>\n\n<pre class=\"lang-py prettyprint-override\"><code>def filter_where(arr, k):\n    return arr[np.where(arr &lt; k)]\n</code></pre>\n\n<ol start=\"4\">\n<li>Using <code>np.nonzero()</code></li>\n</ol>\n\n<pre class=\"lang-py prettyprint-override\"><code>def filter_nonzero(arr, k):\n    return arr[np.nonzero(arr &lt; k)]\n</code></pre>\n\n<ol start=\"5\">\n<li>Using a Cython-based custom implementation(s):\n\n<ul>\n<li>single-pass <code>filter_cy()</code></li>\n<li>two-passes <code>filter2_cy()</code></li>\n</ul></li>\n</ol>\n\n<pre><code>%%cython -c-O3 -c-march=native -a\n#cython: language_level=3, boundscheck=False, wraparound=False, initializedcheck=False, cdivision=True, infer_types=True\n\n\ncimport numpy as cnp\ncimport cython as ccy\n\nimport numpy as np\nimport cython as cy\n\n\ncdef long NUM = 1048576\ncdef long MAX_VAL = 1048576\ncdef long K = 1048576 // 2\n\n\ncdef int smaller_than_cy(long x, long k=K):\n    return x &lt; k\n\n\ncdef size_t _filter_cy(long[:] arr, long[:] result, size_t size, long k):\n    cdef size_t j = 0\n    for i in range(size):\n        if smaller_than_cy(arr[i]):\n            result[j] = arr[i]\n            j += 1\n    return j\n\n\ncpdef filter_cy(arr, k):\n    result = np.empty_like(arr)\n    new_size = _filter_cy(arr, result, arr.size, k)\n    return result[:new_size].copy()\n\n\ncdef size_t _filtered_size(long[:] arr, size_t size, long k):\n    cdef size_t j = 0\n    for i in range(size):\n        if smaller_than_cy(arr[i]):\n            j += 1\n    return j\n\n\ncpdef filter2_cy(arr, k):\n    cdef size_t new_size = _filtered_size(arr, arr.size, k)\n    result = np.empty(new_size, dtype=arr.dtype)\n    new_size = _filter_cy(arr, result, arr.size, k)\n    return result\n</code></pre>\n\n<ol start=\"6\">\n<li>Using a Numba-based custom implementation\n\n<ul>\n<li>single-pass <code>filter_np_nb()</code></li>\n<li>two-passes <code>filter2_np_nb()</code></li>\n</ul></li>\n</ol>\n\n<pre class=\"lang-py prettyprint-override\"><code>import numba as nb\n\n\n@nb.jit\ndef filter_func(x, k=K):\n    return x &lt; k\n\n\n@nb.jit\ndef filter_np_nb(arr):\n    result = np.empty_like(arr)\n    j = 0\n    for i in range(arr.size):\n        if filter_func(arr[i]):\n            result[j] = arr[i]\n            j += 1\n    return result[:j].copy()\n\n\n@nb.jit\ndef filter2_np_nb(arr):\n    j = 0\n    for i in range(arr.size):\n        if filter_func(arr[i]):\n            j += 1\n    result = np.empty(j, dtype=arr.dtype)\n    j = 0\n    for i in range(arr.size):\n        if filter_func(arr[i]):\n            result[j] = arr[i]\n            j += 1\n    return result\n</code></pre>\n\n<hr>\n\n<h1>Timing Benchmarks</h1>\n\n<p>The generator-based <code>filter_fromiter()</code> method is much slower than the others (by approx. 2 orders of magnitude and it is therefore omitted in the charts).</p>\n\n<p>The timing would depend on both the input array size and the percent of filtered items.</p>\n\n<h2>As a function of input size</h2>\n\n<p>The first graph addresses the timings as a function of the input size (for ~50% filtered out elements):</p>\n\n<p><a href=\"https://i.stack.imgur.com/sTJlv.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/sTJlv.png\" alt=\"bm_size\"></a></p>\n\n<p>In general, the Numba based approach is consistently the fastest, closely followed by the Cython approach. Within them, the two-passes approaches are fastest for medium and larger inputs. Within NumPy, the <code>np.where()</code>-based and <code>np.nonzero()</code>-based approaches are basically the same (except for very small inputs for which <code>np.nonzero()</code> seems to be slightly slower), and they are both faster than the boolean mask slicing, except for very small inputs (below ~100 elements) where the boolean mask slicing is faster.\nMoreover, for very small inputs, the Cython based solution are slower than NumPy-based ones.</p>\n\n<h2>As a function of filling</h2>\n\n<p>The second graph addresses the timings as a function of items passing through the filter (for a fixed input size of ~1 million elements):</p>\n\n<p><a href=\"https://i.stack.imgur.com/gRqIH.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/gRqIH.png\" alt=\"bm_filling\"></a></p>\n\n<p>The first observation is that all methods are slowest when approaching a ~50% filling and with less, or more filling they are faster, and fastest towards no filling (highest percent of filtered-out values, lowest percent of passing through values as indicated in the x-axis of the graph).\nAgain, both Numba and Cython version are typically faster than the NumPy-based counterparts, with Numba being fastest almost always and Cython winning over Numba for the outermost right part of the graph.\nThe notable exception to this is when the filling is close to 100%, when single-pass Numba/Cython versions gets basically copied approx. twice and the boolean mask slicing solution eventually outperforms them.\nThe two-passes approaches have increasing marginal speed gains for larger filling vaules.\nWithin NumPy, the <code>np.where()</code>-based and <code>np.nonzero()</code>-based approaches are again basically the same.\nWhen comparing NumPy-based solution, the <code>np.where()</code>/<code>np.nonzero()</code> solutions outperform the boolean mask slicing almost always, except for the outermost right part of the graph, where boolean mask slicing becomes the fastest.</p>\n\n<p>(Full code available <a href=\"https://colab.research.google.com/drive/1SkZhw7wJrPTPWEJbhi1NWQZpScoG8918\" rel=\"noreferrer\">here</a>)</p>\n\n<hr>\n\n<h1>Memory Considerations</h1>\n\n<p>The generator-based <code>filter_fromiter()</code> method requires only minimal temporary storage, independently of the size of the input.\nMemory-wise this is the most efficient method.\nOf similar memory efficiency are the Cython / Numba two-passes methods, because the size of the output is determined during the first pass.</p>\n\n<p>On the memory side, the single-pass solutions for both Cython and Numba require a temporary array of the size of the input.\nHence, these are the least memory-efficient methods.</p>\n\n<p>The boolean mask slicing solution requires a temporary array of the size of the input but of type <code>bool</code>, which in NumPy is 1 bit, so this is ~64 times smaller than the default size of a NumPy array on a typical 64-bit system.</p>\n\n<p>The <code>np.where()</code> based solution has the same requirement as the boolean mask slicing in the first step (inside <code>np.where()</code>), which gets converted to a series of <code>int</code>s (typically <code>int64</code> on a 64-but system) in the second step (the output of <code>np.where()</code>). This second step, therefore, has variable memory requirements, depending on the number of filtered elements.</p>\n\n<hr>\n\n<h1>Remarks</h1>\n\n<ul>\n<li>the generator method is also the most flexible when it comes to specifying a different filtering condition</li>\n<li>the Cython solution requires specifying the data types for it to be fast</li>\n<li>for both Numba and Cython, the filtering condition can be specified as a generic function (and therefore does not need to be hardcoded), but it must be specified within their respective environment, and care must be taken to make sure that this is properly compiled for speed, or substantial slowdowns are observed</li>\n<li>the single-pass solutions DO require an extra <code>.copy()</code> right before return to avoid wasting memory</li>\n<li>the NumPy methods do <em>NOT</em> return a view of the input, but a copy, as a result of <a href=\"https://docs.scipy.org/doc/numpy-1.13.0/reference/arrays.indexing.html#advanced-indexing\" rel=\"noreferrer\">advanced indexing</a>:</li>\n</ul>\n\n<pre class=\"lang-py prettyprint-override\"><code>arr = np.arange(100)\nk = 50\nprint('`arr[arr &gt; k]` is a copy: ', arr[arr &gt; k].base is None)\n# `arr[arr &gt; k]` is a copy:  True\nprint('`arr[np.where(arr &gt; k)]` is a copy: ', arr[np.where(arr &gt; k)].base is None)\n# `arr[np.where(arr &gt; k)]` is a copy:  True\nprint('`arr[:k]` is a copy: ', arr[:k].base is None)\n# `arr[:k]` is a copy:  False\n</code></pre>\n\n<hr>\n\n<p>(EDITED: Included <code>np.nonzero()</code>-based solutions and fixed memory leaks in the single-pass Cython/Numba versions, included two-passes Cython/Numba versions -- based on @ShadowRanger, @PaulPanzer and @max9111 comments.)</p>\n"}], "owner": {"reputation": 18268, "user_id": 5218354, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-NEO9rZKeffY/AAAAAAAAAAI/AAAAAAAAAKc/9IttO1jUOr4/photo.jpg=k-s128", "display_name": "norok2", "link": "https://stackoverflow.com/users/5218354/norok2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34660, "favorite_count": 8, "accepted_answer_id": 58422691, "answer_count": 1, "score": 19, "last_activity_date": 1571351950, "creation_date": 1571266589, "last_edit_date": 1571350483, "question_id": 58422690, "link": "https://stackoverflow.com/questions/58422690/filtering-a-numpy-array-what-is-the-best-approach", "title": "Filtering a NumPy Array: what is the best approach?", "body": "<p>Suppose I have a NumPy array <code>arr</code> that I want to element-wise filter, e.g.\nI want to get only values below a certain threshold value <code>k</code>.</p>\n\n<p>There are a couple of methods, e.g.:</p>\n\n<ol>\n<li>Using generators: <code>np.fromiter((x for x in arr if x &lt; k), dtype=arr.dtype)</code></li>\n<li>Using boolean mask slicing: <code>arr[arr &lt; k]</code></li>\n<li>Using <code>np.where()</code>: <code>arr[np.where(arr &lt; k)]</code></li>\n<li>Using <code>np.nonzero()</code>: <code>arr[np.nonzero(arr &lt; k)]</code></li>\n<li>Using a Cython-based custom implementation(s)</li>\n<li>Using a Numba-based custom implementation(s)</li>\n</ol>\n\n<p>Which is the fastest? What about memory efficiency?</p>\n\n<hr>\n\n<p>(EDITED: Added <code>np.nonzero()</code> based on @ShadowRanger comment)</p>\n"}, {"tags": ["python"], "comments": [{"owner": {"reputation": 4102, "user_id": 10366273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1c2BX.jpg?s=128&g=1", "display_name": "MyNameIsCaleb", "link": "https://stackoverflow.com/users/10366273/mynameiscaleb"}, "edited": false, "score": 0, "creation_date": 1571267031, "post_id": 58422686, "comment_id": 103187670, "body": "And you&#39;re running this from the command line and not from an IDE of some sort?"}, {"owner": {"reputation": 3, "user_id": 12229223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e368e3f5acf6e5858e4773578100328a?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Campbell", "link": "https://stackoverflow.com/users/12229223/mark-campbell"}, "reply_to_user": {"reputation": 4102, "user_id": 10366273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1c2BX.jpg?s=128&g=1", "display_name": "MyNameIsCaleb", "link": "https://stackoverflow.com/users/10366273/mynameiscaleb"}, "edited": false, "score": 0, "creation_date": 1571316753, "post_id": 58422686, "comment_id": 103206696, "body": "yes, it&#39;s being run from the command line on the pi."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12229223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e368e3f5acf6e5858e4773578100328a?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Campbell", "link": "https://stackoverflow.com/users/12229223/mark-campbell"}, "edited": false, "score": 0, "creation_date": 1571318741, "post_id": 58422758, "comment_id": 103207965, "body": "I adjusted my subroutine to match yours, and removed the blank last line, it got stuck on mouthbreather again.  as soon as I added the blank line, it did the blank line 3 times in a row, and started doing others again.  I am wondering if it has something to do with the timing in how long it takes to display the mouthbreather vs the blank line.  But I&#39;m just reaching at this point."}, {"owner": {"reputation": 711, "user_id": 10734880, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VqInoFdU3M8/AAAAAAAAAAI/AAAAAAAAAA4/KLtzLyk_ZJ0/photo.jpg?sz=128", "display_name": "Nick Martin", "link": "https://stackoverflow.com/users/10734880/nick-martin"}, "reply_to_user": {"reputation": 4102, "user_id": 10366273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1c2BX.jpg?s=128&g=1", "display_name": "MyNameIsCaleb", "link": "https://stackoverflow.com/users/10366273/mynameiscaleb"}, "edited": false, "score": 0, "creation_date": 1571328216, "post_id": 58422758, "comment_id": 103213452, "body": "@MyNameIsCaleb that&#39;s just so you can run the snippet in repl.it in isolation..."}, {"owner": {"reputation": 711, "user_id": 10734880, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VqInoFdU3M8/AAAAAAAAAAI/AAAAAAAAAA4/KLtzLyk_ZJ0/photo.jpg?sz=128", "display_name": "Nick Martin", "link": "https://stackoverflow.com/users/10734880/nick-martin"}, "reply_to_user": {"reputation": 3, "user_id": 12229223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e368e3f5acf6e5858e4773578100328a?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Campbell", "link": "https://stackoverflow.com/users/12229223/mark-campbell"}, "edited": false, "score": 0, "creation_date": 1571328495, "post_id": 58422758, "comment_id": 103213591, "body": "@MarkCampbell Strange, it works fine for me... Here&#39;s a working example: <a href=\"https://repl.it/@n1ckdm/CooperativeUniqueOop\" rel=\"nofollow noreferrer\">repl.it/@n1ckdm/CooperativeUniqueOop</a>"}, {"owner": {"reputation": 3, "user_id": 12229223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e368e3f5acf6e5858e4773578100328a?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Campbell", "link": "https://stackoverflow.com/users/12229223/mark-campbell"}, "edited": false, "score": 0, "creation_date": 1571329404, "post_id": 58422758, "comment_id": 103214026, "body": "@NickMartin The main differences that I&#39;m seeing between this, and what I have to make it work, is the following: 1) it&#39;s not in a function 2) the timer is different (1 vs 10), 3) it&#39;s not calling the display function.  I don&#39;t think that there&#39;s anything in the display function that&#39;s altering anything, but rather, I&#39;m pointing it out that the larger spacing in time seems to be a factor."}, {"owner": {"reputation": 4102, "user_id": 10366273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1c2BX.jpg?s=128&g=1", "display_name": "MyNameIsCaleb", "link": "https://stackoverflow.com/users/10366273/mynameiscaleb"}, "reply_to_user": {"reputation": 3, "user_id": 12229223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e368e3f5acf6e5858e4773578100328a?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Campbell", "link": "https://stackoverflow.com/users/12229223/mark-campbell"}, "edited": false, "score": 0, "creation_date": 1571329458, "post_id": 58422758, "comment_id": 103214055, "body": "What is the display function? @MarkCampbell"}, {"owner": {"reputation": 3, "user_id": 12229223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e368e3f5acf6e5858e4773578100328a?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Campbell", "link": "https://stackoverflow.com/users/12229223/mark-campbell"}, "edited": false, "score": 0, "creation_date": 1571329691, "post_id": 58422758, "comment_id": 103214157, "body": "Also, I&#39;m finding it to not be very random at all--I&#39;m finding this pattern to be repeating: ``` demogorgon is coming /! friends dont lie im trapped in the upside down &lt;blank&gt; mouthbreather &lt;blank&gt; &lt;blank&gt; &lt;blank&gt; ``` which turns out to be 8, 4, 2, 10, 9, 10, 10, 10."}, {"owner": {"reputation": 3, "user_id": 12229223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e368e3f5acf6e5858e4773578100328a?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Campbell", "link": "https://stackoverflow.com/users/12229223/mark-campbell"}, "reply_to_user": {"reputation": 4102, "user_id": 10366273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1c2BX.jpg?s=128&g=1", "display_name": "MyNameIsCaleb", "link": "https://stackoverflow.com/users/10366273/mynameiscaleb"}, "edited": false, "score": 0, "creation_date": 1571330305, "post_id": 58422758, "comment_id": 103214407, "body": "@MyNameIsCaleb, the pi is connected to a string of neopixel style lights, and the display function takes the line of text, and converts each letter to a corresponding light, and lights them one letter at a time.  As a result, when you pass a 10 character phrase to the display function, it will take about 10 secs to run the display before returning."}, {"owner": {"reputation": 711, "user_id": 10734880, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VqInoFdU3M8/AAAAAAAAAAI/AAAAAAAAAA4/KLtzLyk_ZJ0/photo.jpg?sz=128", "display_name": "Nick Martin", "link": "https://stackoverflow.com/users/10734880/nick-martin"}, "reply_to_user": {"reputation": 3, "user_id": 12229223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e368e3f5acf6e5858e4773578100328a?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Campbell", "link": "https://stackoverflow.com/users/12229223/mark-campbell"}, "edited": false, "score": 0, "creation_date": 1571333873, "post_id": 58422758, "comment_id": 103215971, "body": "@MarkCampbell I&#39;ve used a function call and increased the sleep time to 10 seconds. I still find that it works fine. I&#39;ve added <code>random.seed()</code> call so and also used <code>splitlines()</code> to remove the newlines - perhaps try that on the pi?"}, {"owner": {"reputation": 3, "user_id": 12229223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e368e3f5acf6e5858e4773578100328a?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Campbell", "link": "https://stackoverflow.com/users/12229223/mark-campbell"}, "edited": false, "score": 0, "creation_date": 1571341166, "post_id": 58422758, "comment_id": 103218995, "body": "Found the issue.  Dan D&#39;s comment below.  I didn&#39;t realize that separate uses of random could be tied together like that, and it seems that that was the culprit."}], "tags": [], "owner": {"reputation": 711, "user_id": 10734880, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VqInoFdU3M8/AAAAAAAAAAI/AAAAAAAAAA4/KLtzLyk_ZJ0/photo.jpg?sz=128", "display_name": "Nick Martin", "link": "https://stackoverflow.com/users/10734880/nick-martin"}, "is_accepted": false, "score": 0, "last_activity_date": 1571335050, "last_edit_date": 1571335050, "creation_date": 1571267053, "answer_id": 58422758, "question_id": 58422686, "link": "https://stackoverflow.com/questions/58422686/python-random-randint-stops-randomizing-after-a-few-loops/58422758#58422758", "title": "Python random.randint stops randomizing after a few loops", "body": "<p>This appears to work for me. Note that I'm seeding the RNG.</p>\n\n<pre><code>import time\nimport random\nfrom datetime import datetime\n\ndef preloaded_messages():\n  print(\"Preloaded Messages thread is loaded.\")\n  displaying = False\n  while True:\n    if not displaying:\n      with open('preloaded_messages.txt') as f:\n        random.seed(datetime.utcnow())\n        text = f.read().splitlines()\n        msg = random.choice(text)\n        print(\"line: \", msg)\n      # print(\"displaying from preloaded_messages.txt: \", msg)\n    time.sleep(10)\n\nif __name__ == \"__main__\":\n  preloaded_messages()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 12229223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e368e3f5acf6e5858e4773578100328a?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Campbell", "link": "https://stackoverflow.com/users/12229223/mark-campbell"}, "edited": false, "score": 0, "creation_date": 1571341084, "post_id": 58438179, "comment_id": 103218963, "body": "Holy smokes, it worked!  Thank you!  I had no idea that the random generator would be tied together like that to other uses of it in the code.  I am finding that it repeats some more than others, but it is far and away better than it was, and isn&#39;t getting stuck on the same one for more than twice in a row.."}, {"owner": {"reputation": 67048, "user_id": 388787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f786b1ad349a30e02802ae61b4518fc?s=128&d=identicon&r=PG", "display_name": "Dan D.", "link": "https://stackoverflow.com/users/388787/dan-d"}, "reply_to_user": {"reputation": 3, "user_id": 12229223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e368e3f5acf6e5858e4773578100328a?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Campbell", "link": "https://stackoverflow.com/users/12229223/mark-campbell"}, "edited": false, "score": 0, "creation_date": 1571341477, "post_id": 58438179, "comment_id": 103219127, "body": "The generator is uniform. It only appear to generate some more than others because you are looking at a small sample. If you do a few thousand samples and graph them on a histogram the divergence from uniform will decrease with increasing numbers of samples. The output of MT isn&#39;t complete decorrelated as it is sampling points from the surface of a 24-sphere. But at least it isn&#39;t as bad as RANDU."}], "tags": [], "owner": {"reputation": 67048, "user_id": 388787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f786b1ad349a30e02802ae61b4518fc?s=128&d=identicon&r=PG", "display_name": "Dan D.", "link": "https://stackoverflow.com/users/388787/dan-d"}, "is_accepted": true, "score": 0, "last_activity_date": 1571334535, "creation_date": 1571334535, "answer_id": 58438179, "question_id": 58422686, "link": "https://stackoverflow.com/questions/58422686/python-random-randint-stops-randomizing-after-a-few-loops/58438179#58438179", "title": "Python random.randint stops randomizing after a few loops", "body": "<p>It is reseeding the random generator. See line 49 of stranger.py in the <a href=\"https://github.com/CalebKussmaul/Stranger-Things-Integrated\" rel=\"nofollow noreferrer\">https://github.com/CalebKussmaul/Stranger-Things-Integrated</a>: <code>random.seed(i)</code>.</p>\n\n<p>The <code>color_of</code> function should be written as:</p>\n\n<pre><code>def color_of(i):\n    \"\"\"\n    This function generates a color based on the index of an LED. This will always return the same color for a given\n    index. This allows the lights to function more like normal christmas lights where the color of one bulb wont change.\n\n    :param i: index of LED to get color of\n    :return: a pseudorandom color based on the index of the light\n    \"\"\"\n    _random = random.Random(i)\n    rgb = colorsys.hsv_to_rgb(_random.random(), 1, 1)\n    return int(rgb[0] * 255), int(rgb[1] * 255), int(rgb[2] * 255)\n</code></pre>\n\n<p>To create its own <code>Random</code> instance with the given seed rather than reseeding the <code>Random</code> instance that is a singleton in the <code>random</code> module.</p>\n"}], "owner": {"reputation": 3, "user_id": 12229223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e368e3f5acf6e5858e4773578100328a?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Campbell", "link": "https://stackoverflow.com/users/12229223/mark-campbell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 58438179, "answer_count": 2, "score": 0, "last_activity_date": 1571335050, "creation_date": 1571266556, "question_id": 58422686, "link": "https://stackoverflow.com/questions/58422686/python-random-randint-stops-randomizing-after-a-few-loops", "title": "Python random.randint stops randomizing after a few loops", "body": "<p>I'm running a python script that will display messages on a board.  One of the subroutines that I've created is supposed to grab a random line from a small text file, and display that line.  It mostly works, except after looping a few times, it gets stuck on the same number, and just displays the same thing over and over.</p>\n\n<p>I am running this in Python 2.7, on a Raspberry Pi in Raspbian.  I am using this github as the base for the project, and added lines of my own to it: \n        <a href=\"https://github.com/CalebKussmaul/Stranger-Things-Integrated\" rel=\"nofollow noreferrer\">https://github.com/CalebKussmaul/Stranger-Things-Integrated</a>\nThis is part of a halloween display that will be Stranger Things-themed, so the preloaded messages have a reference to the show.  I noticed this issue the other day, and have been pouring over the internet to try and figure out what the problem could be.  I've tried doing different methods of selecting a randomized number, including some in some similar (but different) threads on this site.  All of them produce exactly the same issue.</p>\n\n<p>Below is the subroutine I created:</p>\n\n<pre><code>def preloaded_messages():\n    print \"Preloaded Messages thread is loaded.\"\n    global displaying\n    while True:\n        if not displaying:\n            with open('preloaded_messages.txt') as f:\n                lines = len(f.readlines())\n                rgn = random.randint(1,lines)\n                msg = linecache.getline('preloaded_messages.txt', rgn)\n                print \"rng: \", rgn\n                print \"total lines: \", lines\n                print \"line: \", msg\n            print \"displaying from preloaded_messages.txt: \", msg\n            display(msg)\n        time.sleep(10)\n</code></pre>\n\n<p>And here's my preloaded_messages.txt file:</p>\n\n<pre><code>help me\nim trapped in the upside down\nleggo my eggo\nfriends dont lie\nrun /!\nhopper is alive\nrip barb\ndemogorgon is coming /!\nmouthbreather\n</code></pre>\n\n<p>When I run it, my output is like this:</p>\n\n<pre><code>rng:  6\ntotal lines:  9\nline:  hopper is alive\n\nrng:  2\ntotal lines:  9\nline:  im trapped in the upside down\n\nrng:  9\ntotal lines:  9\nline:  mouthbreather\n\n...\n\nrng:  9\ntotal lines:  9\nline:  mouthbreather\n</code></pre>\n\n<p>the first few times are always random (and the number of times it successfully randomizes varies), but when it gets on 9, it just stays there for as long as I let it run.  I am at a loss as to why it works the first few times, but not once it gets to 9.</p>\n\n<p>EDIT: Interestingly, as I've been writing this, I also tried adding a blank line at the end, and while it looked like it'd be stuck again, as it did that one three times in a row, then it finally moved to others.  I'm not sure how that changes things. And ideally, I'd rather not have the blank line in there, as it eats up time displaying nothing.  So it'd be nice to fix the issue.  Anyone have any ideas?</p>\n"}, {"tags": ["python", "tensorflow", "neural-network", "deep-learning", "artificial-intelligence"], "answers": [{"tags": [], "owner": {"reputation": 1305, "user_id": 3128109, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dad8185d23a2a3e3c0a12ce1fde5f522?s=128&d=identicon&r=PG&f=1", "display_name": "usernumber", "link": "https://stackoverflow.com/users/3128109/usernumber"}, "is_accepted": true, "score": 1, "last_activity_date": 1579109361, "creation_date": 1579109361, "answer_id": 59756706, "question_id": 58422670, "link": "https://stackoverflow.com/questions/58422670/tensorflow-valueerror-failed-to-find-data-adapter-that-can-handle-input/59756706#59756706", "title": "Tensorflow ValueError: Failed to find data adapter that can handle input", "body": "<p>After </p>\n\n<pre><code>for features, label in training_data:\n    X.append(features)\n    y.append(label)\n</code></pre>\n\n<p>you have to add</p>\n\n<pre><code>y = np.array(y)\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9878488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3823c5d0e91a644f2e19a3d78388f16?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian yo", "link": "https://stackoverflow.com/users/9878488/adrian-yo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2291, "favorite_count": 0, "accepted_answer_id": 59756706, "answer_count": 1, "score": 1, "last_activity_date": 1579109361, "creation_date": 1571266423, "question_id": 58422670, "link": "https://stackoverflow.com/questions/58422670/tensorflow-valueerror-failed-to-find-data-adapter-that-can-handle-input", "title": "Tensorflow ValueError: Failed to find data adapter that can handle input", "body": "<p>Hello I'm trying to make the basic example of tensorflow minst using data from images on my pc.\nBut I run into this error all the time: \"ValueError: Failed to find data adapter that can handle input: , ( containing values of types {\"\"})\"</p>\n\n<p>here's how i generate data:</p>\n\n<pre><code>import numpy as np # for array operations\nimport matplotlib.pyplot as plt # to show image\nimport os # to move through directories\nimport cv2 # to make image operations\nimport random\nimport pickle\n\nDATADIR=r\"C:\\Users\\...\\mnist_png\\training\"\nDIGITS = [\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\"]\n\ntraining_data = []\n\nfor digit in DIGITS:\n    path = os.path.join(DATADIR, digit)\n    class_num = DIGITS.index(digit)\n    for img in os.listdir(path):  \n        img_array = cv2.imread(os.path.join(path,img), cv2.IMREAD_GRAYSCALE)               \n        training_data.append([img_array, class_num])        \n\nrandom.shuffle(training_data)\n\nX = []\ny = []\n\nfor features, label in training_data:\n    X.append(features)\n    y.append(label)\n\nX = np.array(X).reshape(-1, 28, 28, 1) \n\npickle_out = open(\"X.pickle\", \"wb\")\npickle.dump(X, pickle_out)\npickle_out.close()\n\npickle_out = open(\"y.pickle\", \"wb\")\npickle.dump(y, pickle_out)\npickle_out.close()\n</code></pre>\n\n<p>and here's the tensorflow model that I get error from:</p>\n\n<pre><code>import tensorflow as tf\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense, Dropout, Activation, Flatten, Conv2D, MaxPooling2D\nimport pickle\n\nX = pickle.load(open(\"X.pickle\", \"rb\"))\ny = pickle.load(open(\"y.pickle\", \"rb\"))\n\nX=X/255.0\n\nmodel = Sequential()\n\nmodel.add(Conv2D(64, (3,3), input_shape = X.shape[1:]))\nmodel.add(Activation(\"relu\"))\nmodel.add(MaxPooling2D(pool_size=(2,2)))\n\nmodel.add(Conv2D(64, (3,3)))\nmodel.add(Activation(\"relu\"))\nmodel.add(MaxPooling2D(pool_size=(2,2)))\n\nmodel.add(Flatten())\nmodel.add(Dense(64))\n\nmodel.add(Dense(10))\nmodel.add(Activation('sigmoid'))\n\n\nmodel.compile(\n    loss=\"sparse_categorical_crossentropy\",\n    optimizer=\"adam\",\n    metrics=['accuracy']\n    )\n\nmodel.fit(X, y, batch_size=32, validation_split=0.1)\n</code></pre>\n\n<p>Please help me</p>\n"}, {"tags": ["python", "arduino", "serial-port"], "comments": [{"owner": {"reputation": 323, "user_id": 8371691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DRgCN.png?s=128&g=1", "display_name": "Kani", "link": "https://stackoverflow.com/users/8371691/kani"}, "edited": false, "score": 0, "creation_date": 1571271675, "post_id": 58422660, "comment_id": 103188643, "body": "Have you tried increasing the Baud rate? That is change <code>9600</code> to <code>115200</code> on both Arduino code and the Python code. Can you check if this improves your results?"}, {"owner": {"reputation": 323, "user_id": 8371691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DRgCN.png?s=128&g=1", "display_name": "Kani", "link": "https://stackoverflow.com/users/8371691/kani"}, "edited": false, "score": 0, "creation_date": 1571272461, "post_id": 58422660, "comment_id": 103188789, "body": "Forgot to mention, if you are opening the serial monitor while the Python program is running, it is also going to slow it down.   Also, what is the output of &quot;print(bytes(num.encode())&quot; in your Python code?"}], "answers": [{"tags": [], "owner": {"reputation": 17633, "user_id": 2858170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4263428b9b0e0aed365e264c7a2b044?s=128&d=identicon&r=PG&f=1", "display_name": "Piglet", "link": "https://stackoverflow.com/users/2858170/piglet"}, "is_accepted": true, "score": 0, "last_activity_date": 1571293233, "creation_date": 1571293233, "answer_id": 58426114, "question_id": 58422660, "link": "https://stackoverflow.com/questions/58422660/reducing-delay-on-raspberry-pi-to-arduino-serial-communication/58426114#58426114", "title": "reducing delay on raspberry pi to arduino serial communication", "body": "<p>Serial communication is always done in Bytes. So whatever you send through your interface will be received as a sequence of Bytes. As you encoded your \"3\" as UTF-8 it will be sent as 0x33 (51). Your \"2\" is 0x32 (50) respectively.</p>\n\n<p>Increasing the baudrate as suggested in a comment won't help you as it will only increase the speed data is transmitted/received. Without a measurement you won't notice a difference betweeen sending a single byte with 9600 or 115200 baud.</p>\n\n<p>As long as both device operate on the same baudrate and you do not exceed the max baudrate of any device (somewhere around 2 million baud for Arduino Uno) you cannot send to fast. (given a suitable cable and distance)</p>\n\n<p>You might run into problems with too long cables but that's several meters for 9600 baud even in noisy industrial environment.</p>\n\n<p>Usually you wait for data to be available in the receive buffer befor you read.</p>\n\n<pre><code>void loop() {\n  // send data only when you receive data:\n  if (Serial.available() &gt; 0) {\n    // read the incoming byte:\n    incomingByte = Serial.read();\n\n    // say what you got:\n    Serial.print(\"I received: \");\n    Serial.println(incomingByte, DEC);\n  }\n}\n</code></pre>\n\n<p>Maybe not doing so causes some delay. I cannot tell for sure as you did not provide the length of the observed delay.</p>\n\n<p>If the Arduino is already running when you execute your Python code I don't see any other issue with your code. If it is booting while you send you might observe some delay because of the Arduino bootloader. It will wait some time for possible firmware updates befor it starts the actual application code.</p>\n"}, {"tags": [], "owner": {"reputation": 59, "user_id": 6051459, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jE-5C-A7VuY/AAAAAAAAAAI/AAAAAAAAAGM/-z1gQhUmCgo/photo.jpg?sz=128", "display_name": "Roger Irwin", "link": "https://stackoverflow.com/users/6051459/roger-irwin"}, "is_accepted": false, "score": 0, "last_activity_date": 1571294686, "creation_date": 1571294686, "answer_id": 58426414, "question_id": 58422660, "link": "https://stackoverflow.com/questions/58422660/reducing-delay-on-raspberry-pi-to-arduino-serial-communication/58426414#58426414", "title": "reducing delay on raspberry pi to arduino serial communication", "body": "<p>Small pieces of data may sit around in the output buffer before being sent. Try using Serial.flush() after write to let the os know you want the data sent asap.</p>\n"}], "owner": {"reputation": 13, "user_id": 12229327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2e86247236ef62cf6eb8b2306552fa8?s=128&d=identicon&r=PG&f=1", "display_name": "anceint", "link": "https://stackoverflow.com/users/12229327/anceint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 462, "favorite_count": 0, "accepted_answer_id": 58426114, "answer_count": 2, "score": -1, "last_activity_date": 1571294686, "creation_date": 1571266379, "question_id": 58422660, "link": "https://stackoverflow.com/questions/58422660/reducing-delay-on-raspberry-pi-to-arduino-serial-communication", "title": "reducing delay on raspberry pi to arduino serial communication", "body": "<p>I'm currently trying to rotate a motor on my Arduino Uno through serial communication from my Raspberry Pi 3. My code itself currently works however sometimes when running the python script the motor will not turn or indicate any response. From what I've been able to find online, I feel like I'm sending signals faster than the Arduino is reading them, and I can't seem to find a way to minimize the delay and make my motor response consistent. </p>\n\n<p>Here is my Arduino code:</p>\n\n<pre><code>#include &lt;Stepper.h&gt;\n\n#define STEPS 128 \n\nStepper stepper(STEPS, 8, 10, 9, 11);\n\nvoid setup() {\n  Serial.begin(9600);\n}\nvoid loop() {\nif (Serial.read() == 50) {\nstepper.setSpeed(8); //  rpm\nstepper.step(128); // do n steps -- corresponds to one revolution in one minute\n}\nelse if (Serial.read() == 51) {\nstepper.setSpeed(8); //  rpm\nstepper.step(-128); // do n steps -- corresponds to one revolution in one minute\n}\n}\n</code></pre>\n\n<p>Here is my Python code</p>\n\n<pre><code>import serial\nimport time\n\nser = serial.Serial('/dev/ttyACM0', 9600)\n\ntime.sleep(1)\nnum=\"3\"\nser.write(bytes(num.encode()))\n\n</code></pre>\n\n<p>Also I'm not sure how Arduino is reading my ser.write, as when num = 2, I see \"50\" in my Serial Monitor, when num = 3, \"51\" appears in my Serial Monitor, and so forth.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["python", "tensorflow", "pytorch", "tensorboard"], "comments": [{"owner": {"reputation": 5106, "user_id": 13465258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af312ebdf3daf22a61af97062eccf2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Tensorflow Warrior", "link": "https://stackoverflow.com/users/13465258/tensorflow-warrior"}, "edited": false, "score": 0, "creation_date": 1590044467, "post_id": 58422652, "comment_id": 109532547, "body": "Can you please explain your question by adding some code so that community can understand it and we can try to help you. Thanks!"}, {"owner": {"reputation": 1859, "user_id": 2235936, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/bea00ebd01a0907ac8ba22ce87179a56?s=128&d=identicon&r=PG", "display_name": "avocado", "link": "https://stackoverflow.com/users/2235936/avocado"}, "reply_to_user": {"reputation": 5106, "user_id": 13465258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af312ebdf3daf22a61af97062eccf2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Tensorflow Warrior", "link": "https://stackoverflow.com/users/13465258/tensorflow-warrior"}, "edited": false, "score": 0, "creation_date": 1607790588, "post_id": 58422652, "comment_id": 115386144, "body": "@TensorflowWarrior I&#39;m having the same question here, and I think it&#39;s pretty straightforward. For example, this is the function signature: <code>writer.add_graph(model, input_to_model=None, verbose=False)</code>,  you can see there is an <code>input_to_model</code> arg, and I have to pass this arg to this function, otherwise this function raises an error. And how can we just visualize the graph, WITHOUT passing any input args?"}], "owner": {"reputation": 1737, "user_id": 5511906, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NJfrg.jpg?s=128&g=1", "display_name": "Yu Gu", "link": "https://stackoverflow.com/users/5511906/yu-gu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1571267175, "creation_date": 1571266305, "last_edit_date": 1571267175, "question_id": 58422652, "link": "https://stackoverflow.com/questions/58422652/why-do-we-need-the-second-parameter-for-add-graph-when-using-tensorboard", "title": "Why do we need the second parameter for add_graph() when using tensorboard?", "body": "<p>As we know, there are two parameters for <code>add_graph()</code>, a first parameter is an object of the model that we want to visualize, and the second parameter is just an input for the model. The input can be quite casual, i.e., we can simply randomly generate an input with the shape we want and feed it to <code>add_graph()</code>. So what\u2019s the point to have the input as a parameter? It seems to me that this parameter only provides the shape information of an input tensor, but we can directly get this information from the model definition, right? And no matter what input we feed to <code>add_graph()</code>, the computation graph printed by tensorboard is always the same. I am really confused about this.</p>\n"}, {"tags": ["python", "python-3.x"], "comments": [{"owner": {"reputation": 4102, "user_id": 10366273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1c2BX.jpg?s=128&g=1", "display_name": "MyNameIsCaleb", "link": "https://stackoverflow.com/users/10366273/mynameiscaleb"}, "edited": false, "score": 0, "creation_date": 1571266428, "post_id": 58422648, "comment_id": 103187531, "body": "<a href=\"https://docs.python.org/3.8/library/stdtypes.html#str.split\" rel=\"nofollow noreferrer\">split</a> is linked here in the docs."}, {"owner": {"reputation": 19246, "user_id": 494134, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/3XHKr.png?s=128&g=1", "display_name": "John Gordon", "link": "https://stackoverflow.com/users/494134/john-gordon"}, "edited": false, "score": 1, "creation_date": 1571266531, "post_id": 58422648, "comment_id": 103187556, "body": "<i>I have a list of tuples</i> Those aren&#39;t tuples."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1571266546, "post_id": 58422648, "comment_id": 103187558, "body": "I suggest that you start by simplifying the problem: given a single string, remove the top level domain and just print out the part before the dot. Can you figure out how to do that? Once you figure that out, make it a function that returns the part before the dot. Then figure out how to apply that function to each element of a list."}, {"owner": {"reputation": 13, "user_id": 12217897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f097bc96f19c513903f0fee47c6a967e?s=128&d=identicon&r=PG&f=1", "display_name": "picklemaster", "link": "https://stackoverflow.com/users/12217897/picklemaster"}, "edited": false, "score": 0, "creation_date": 1571266890, "post_id": 58422648, "comment_id": 103187647, "body": "I&#39;m sorry, my asignment used the words &quot;list of tuples&quot;, not sure what it actually is. As long as its returned in that format."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1571266961, "post_id": 58422648, "comment_id": 103187663, "body": "I suspect that the words &quot;list of tuples&quot; was used in a specific context. However, those details are probably not important here. What you show here is a list of strings."}], "answers": [{"comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1571266847, "post_id": 58422706, "comment_id": 103187632, "body": "Modifying the list you iterate over won&#39;t work the way you want. It would be better to build a new list of unique entries instead. Or better yet use <code>set()</code>."}], "tags": [], "owner": {"reputation": 2289, "user_id": 10475068, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9L6sS.jpg?s=128&g=1", "display_name": "Legorooj", "link": "https://stackoverflow.com/users/10475068/legorooj"}, "is_accepted": false, "score": -1, "last_activity_date": 1571266715, "creation_date": 1571266715, "answer_id": 58422706, "question_id": 58422648, "link": "https://stackoverflow.com/questions/58422648/how-to-remove-characters-in-a-string-after-a-given-character/58422706#58422706", "title": "How to remove characters in a string AFTER a given character?", "body": "<p>This will only work if all items are strings:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>for i in range(len(my_list)):\n    my_list[i] = my_list[I].split('.')[0]\nalready_in_list = []\nfor item in my_list:\n    if item in already_in_list:\n        my_list.pop(item)\n    else:\n        already_in_list.append(item)\nprint(my_list)\n</code></pre>\n\n<p>I did do this from memory so if there is a bug please let me know.</p>\n"}, {"tags": [], "owner": {"reputation": 1438, "user_id": 10089811, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fQrp1.jpg?s=128&g=1", "display_name": "Jakob", "link": "https://stackoverflow.com/users/10089811/jakob"}, "is_accepted": true, "score": 1, "last_activity_date": 1571267823, "last_edit_date": 1571267823, "creation_date": 1571267407, "answer_id": 58422797, "question_id": 58422648, "link": "https://stackoverflow.com/questions/58422648/how-to-remove-characters-in-a-string-after-a-given-character/58422797#58422797", "title": "How to remove characters in a string AFTER a given character?", "body": "<p>This <code>def</code> removes url extensions:</p>\n\n<pre><code>def removeurlextensions(L):\n    L2 = []\n    for x in range(len(L)):\n        L2.append(L[x].split('.')[0])\n    return L2\n</code></pre>\n\n<p>To print your list:</p>\n\n<pre><code>L = ['google.com', 'google.ru', 'google.ca']\nprint(removeurlextensions(L))\n#prints ['google', 'google', 'google']\n</code></pre>\n\n<p>To remove duplicates you can use <code>list(set())</code>:</p>\n\n<pre><code>L = ['google.com', 'google.ru', 'google.ca']\nprint(list(set(removeurlextensions(L))))\n#prints ['google']\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 390, "user_id": 3124658, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/vX0No.jpg?s=128&g=1", "display_name": "metaphor", "link": "https://stackoverflow.com/users/3124658/metaphor"}, "is_accepted": false, "score": 0, "last_activity_date": 1571267791, "last_edit_date": 1571267791, "creation_date": 1571267427, "answer_id": 58422798, "question_id": 58422648, "link": "https://stackoverflow.com/questions/58422648/how-to-remove-characters-in-a-string-after-a-given-character/58422798#58422798", "title": "How to remove characters in a string AFTER a given character?", "body": "<p>You can simply use <code>split</code>.</p>\n\n<pre><code>ls = ['google.com', 'google.ru', 'google.ca']\nprint([i.split('.', 1)[0] for i in ls])\n# result = ['google', 'google', 'google']\n</code></pre>\n\n<p>And to remove the duplicate, you might want to use <code>set</code>.</p>\n\n<pre><code>mod = [i.split('.', 1)[0] for i in ls]\nprint(list(set(mod)))\n# result = ['google']\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12217897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f097bc96f19c513903f0fee47c6a967e?s=128&d=identicon&r=PG&f=1", "display_name": "picklemaster", "link": "https://stackoverflow.com/users/12217897/picklemaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 58422797, "answer_count": 3, "score": 0, "last_activity_date": 1571267823, "creation_date": 1571266252, "question_id": 58422648, "link": "https://stackoverflow.com/questions/58422648/how-to-remove-characters-in-a-string-after-a-given-character", "title": "How to remove characters in a string AFTER a given character?", "body": "<p>I have a list of tuples that I want to remove the url extensions from. Here's what it looks like</p>\n\n<pre><code>['google.com', 'google.ru', 'google.ca']\n</code></pre>\n\n<p>Basically, I want to remove everything <em>after</em> the \"<strong>.</strong>\" in each one so that I'm returned with something like this</p>\n\n<pre><code>['google', 'google', 'google']\n</code></pre>\n\n<p>My instructions specifically tell me to use the <code>split()</code> function, but I'm confused with that as well. If it's also possible, I need to remove duplicates, so my final result would be:</p>\n\n<pre><code>['google']\n</code></pre>\n\n<p>Thanks for the help, sorry if my specifications are odd.</p>\n"}, {"tags": ["python", "pandas", "dataframe"], "comments": [{"owner": {"reputation": 2479, "user_id": 11301900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8826c4b7675bd83127fddefc109b7f5d?s=128&d=identicon&r=PG&f=1", "display_name": "AMC", "link": "https://stackoverflow.com/users/11301900/amc"}, "edited": false, "score": 0, "creation_date": 1571281628, "post_id": 58422591, "comment_id": 103190546, "body": "Please edit your question to be a bit clearer. Forget the idea of \u201coverwriting the csv\u201d, what matters is which DataFrame you\u2019re modifying, and which one is written to a csv file. If you want to make a copy of a DataFrame, you can just do <code>df_copy = df.copy()</code> Another thing, writing <code>export = df.to_csv(&quot;set1_output.csv\u201d)</code> is useless in the code you shared above. I have a few ideas of what might help, but I can\u2019t do much without more information from you."}], "answers": [{"tags": [], "owner": {"reputation": 338, "user_id": 7152553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K1zzfrQU5WU/AAAAAAAAAAI/AAAAAAAABig/AqMD13sY074/photo.jpg?sz=128", "display_name": "eshanrh", "link": "https://stackoverflow.com/users/7152553/eshanrh"}, "is_accepted": false, "score": 0, "last_activity_date": 1571266031, "creation_date": 1571266031, "answer_id": 58422620, "question_id": 58422591, "link": "https://stackoverflow.com/questions/58422591/write-to-a-specific-value-in-dataframe-without-overwriting-the-csv/58422620#58422620", "title": "Write to a specific value in dataframe without overwriting the csv", "body": "<p>If I understand your question correctly, you want to append the new data to the csv.</p>\n\n<p>Make a copy of the dataframe, do your operations, append the new array to the old array, and save the whole copy.</p>\n\n<pre><code>dfcopy = df.copy()\ndfcopy.at[1,\"Comments\"] = \"Test Comment\"\ndf.append(dfcopy)\nexport = df.to_csv('set1_output.csv')\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9424719, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155982879994404/picture?type=large", "display_name": "kidchae", "link": "https://stackoverflow.com/users/9424719/kidchae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 353, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1571266031, "creation_date": 1571265773, "question_id": 58422591, "link": "https://stackoverflow.com/questions/58422591/write-to-a-specific-value-in-dataframe-without-overwriting-the-csv", "title": "Write to a specific value in dataframe without overwriting the csv", "body": "<p>I have a dataframe like such:</p>\n\n<pre><code> master_contact_id  Agent_Disposition        QA_Disposition Comments\n0           37284773    Not Serviceable       Not Serviceable      NaN\n1           37284829  Existing Customer      Customer Service      NaN\n2           37284880      Closed - Sale         Closed - Sale      NaN\n3           37284887  Existing Customer  Hang up/Disconnected      NaN\n4           37284943      Closed - Sale         Closed - Sale      NaN\n</code></pre>\n\n<p>I'm going through each contact id, finding the specific index, and writing a comment to replace \"NaN\" with:</p>\n\n<pre><code>df.at[1, 'Comments'] = \"Test Comment\"\n</code></pre>\n\n<p>However, when I write to csv, with</p>\n\n<pre><code>export = df.to_csv('set1_output.csv')\n</code></pre>\n\n<p>the exported csv keeps overwriting. I want to be able to append comments continually.</p>\n"}, {"tags": ["python", "longest-substring"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9748187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f15c7a540e9f173956f00eeb461ea11?s=128&d=identicon&r=PG", "display_name": "CodeEnthusiast", "link": "https://stackoverflow.com/users/9748187/codeenthusiast"}, "edited": false, "score": 0, "creation_date": 1571268193, "post_id": 58422808, "comment_id": 103187915, "body": "Thanks @neutrino_logic. Works like a baby."}], "tags": [], "owner": {"reputation": 1219, "user_id": 11547576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8YD74.jpg?s=128&g=1", "display_name": "neutrino_logic", "link": "https://stackoverflow.com/users/11547576/neutrino-logic"}, "is_accepted": true, "score": 0, "last_activity_date": 1571267495, "creation_date": 1571267495, "answer_id": 58422808, "question_id": 58422586, "link": "https://stackoverflow.com/questions/58422586/longest-substring-without-repeating-characters-code-works-during-run-but-fai/58422808#58422808", "title": "Longest Substring without repeating characters - Code works during run , but fails on submit for the same testcase", "body": "<p>This is a problem that appears because of the way Python handles mutable default arguments in function definitions, in this case <code>unique=[]</code>. The suggested fix for this is:</p>\n\n<pre><code>def lengthOfLongestSubstring(self, s: str,unique=None) -&gt; int:\n    if unique is None:\n        unique = []\n</code></pre>\n\n<p>This is rather strange behavior, but since everything is an object in Python, what it appears to mean is that such arguments result in the function remembering its state after each call (behaving rather like a function with a static variable inside it in other languages). I ran the code with the changed statement and it seems to solve the problem. Here is a more complete discussion of the issue:</p>\n\n<p><a href=\"https://docs.python-guide.org/writing/gotchas/\" rel=\"nofollow noreferrer\">https://docs.python-guide.org/writing/gotchas/</a></p>\n"}], "owner": {"reputation": 13, "user_id": 9748187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f15c7a540e9f173956f00eeb461ea11?s=128&d=identicon&r=PG", "display_name": "CodeEnthusiast", "link": "https://stackoverflow.com/users/9748187/codeenthusiast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 58422808, "answer_count": 1, "score": 1, "last_activity_date": 1571267495, "creation_date": 1571265732, "question_id": 58422586, "link": "https://stackoverflow.com/questions/58422586/longest-substring-without-repeating-characters-code-works-during-run-but-fai", "title": "Longest Substring without repeating characters - Code works during run , but fails on submit for the same testcase", "body": "<pre><code>   class Solution:\n        def lengthOfLongestSubstring(self, s: str,unique=[]) -&gt; int:\n            i=0\n            m=0\n            j=0\n            l=0\n            while(i&lt;len(s)):\n\n                if(s[i] not in unique):\n                    unique.append(s[i])\n                    m=m+1\n                    l = max(l,m)\n                    i=i+1\n\n                else:\n                    unique=[]\n                    j=j+1\n                    i=j\n                    m=0\n\n            print(l)\n            return\n</code></pre>\n\n<p>Input = \"c\"\noutput = \"1\" during runcode but fails(0) on submit. It also works during the playground debug for the same testcase. unable to figure it out.</p>\n"}, {"tags": ["python", "image-processing", "neural-network", "pytorch", "scikit-image"], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 3467942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a126e92ba0cbbfad95c08142a97e32c?s=128&d=identicon&r=PG&f=1", "display_name": "Igor", "link": "https://stackoverflow.com/users/3467942/igor"}, "is_accepted": false, "score": 1, "last_activity_date": 1571575241, "creation_date": 1571575241, "answer_id": 58473065, "question_id": 58422569, "link": "https://stackoverflow.com/questions/58422569/feed-multi-resolution-images-to-neural-network-pytorch/58473065#58473065", "title": "Feed multi resolution images to Neural Network Pytorch", "body": "<p>There are two types of Neural Networks: First one that can process variable input size and second that requires fixed input size.</p>\n\n<p>Good example for first kind is Fully Convolutional Network (FCN). They are widely used for object detection and semantic segmentation. Next code snippet is minimal example of testing pre-trained keypointrcnn from PyTorch. This is improvement of previous state of the art <a href=\"https://arxiv.org/abs/1703.06870\" rel=\"nofollow noreferrer\">Mask R-CNN</a></p>\n\n<pre><code>import torch\nimport torchvision\nfrom PIL import Image\n\nmodel_rcnn = torchvision.models.detection.keypointrcnn_resnet50_fpn(pretrained=True)\nmodel_rcnn.eval()\n\nimage1 = Image.open('image122\u200a\u00d7\u200a430.jpg')\nimage2 = Image.open('image448\u200a\u00d7\u200a465.jpg')\n\nimage_tensor1 = torchvision.transforms.functional.to_tensor(image1)\nimage_tensor2 = torchvision.transforms.functional.to_tensor(image2)\n\noutput1 = model_rcnn([image_tensor1])\noutput2 = model_rcnn([image_tensor2])\nprint(output1, output2)\n</code></pre>\n\n<p>Second kind of Neural Networks require fixed size input, for example ResNet. <strong>Standard solution is using Resize transform</strong> before feeding images to the network. Minimal example:</p>\n\n<pre><code>import torch\nimport torchvision\nfrom torchvision import transforms\nfrom PIL import Image\n\nmodel_imagnet = torchvision.models.resnet50(pretrained=True)\nmodel_imagnet.eval()\n\n# don't forget to use the same normalization as in training, \n# if you are using pre-trained model\nnormalize = transforms.Normalize(mean=[0.485, 0.456, 0.406],\n                                 std=[0.229, 0.224, 0.225])\nmy_transforms = transforms.Compose([transforms.Resize(224), \n                                   transforms.ToTensor(),\n                                   normalize])\n\nimage1 = Image.open('image122\u200a\u00d7\u200a430.jpg')\nimage2 = Image.open('image448\u200a\u00d7\u200a465.jpg')\n\nimage_tensor1 = my_transforms(image1)\nimage_tensor2 = my_transforms(image2)\n\n\noutput1 = model_imagnet(torch.unsqueeze(image_tensor1, 0))\noutput2 = model_imagnet(torch.unsqueeze(image_tensor2, 0))\n</code></pre>\n\n<p>For more details about the models and there usage you may refer to PyTorch <a href=\"https://pytorch.org/docs/stable/torchvision/models.html\" rel=\"nofollow noreferrer\">documentation</a></p>\n"}], "owner": {"reputation": 629, "user_id": 7432133, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1219059728141207/picture?type=large", "display_name": "Tahjid Ashfaque", "link": "https://stackoverflow.com/users/7432133/tahjid-ashfaque"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1571575241, "creation_date": 1571265563, "question_id": 58422569, "link": "https://stackoverflow.com/questions/58422569/feed-multi-resolution-images-to-neural-network-pytorch", "title": "Feed multi resolution images to Neural Network Pytorch", "body": "<p>I am new in this area so pardon if my question seems stupid.\nI have created a multiresolution image pyramid using </p>\n\n<blockquote>\n  <p>skimage.transform.pyramid_gaussian</p>\n</blockquote>\n\n<p>The images are 2D. Now I want to feed these images to a neural network. The structure of the neural network is not fixed. But I can't do that since the images are not of the same size. Can anyone guide me to any resource regarding if this can be done?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["python", "python-3.x", "celery", "aiohttp", "sockjs"], "comments": [{"owner": {"reputation": 15566, "user_id": 876497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2713233cc2e49a4db53ff08d6c114255?s=128&d=identicon&r=PG", "display_name": "DejanLekic", "link": "https://stackoverflow.com/users/876497/dejanlekic"}, "edited": false, "score": 0, "creation_date": 1571299242, "post_id": 58422547, "comment_id": 103196490, "body": "Keep your Celery workers and aiohttp-based web service separate. It makes no sense to have them all in one big application. Blocking code should be executed in a separate thread so it does not block the main event loop."}, {"owner": {"reputation": 858, "user_id": 2217746, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5f4e74a54a6fc8d20f96b168dbe222fc?s=128&d=identicon&r=PG", "display_name": "shay te", "link": "https://stackoverflow.com/users/2217746/shay-te"}, "reply_to_user": {"reputation": 15566, "user_id": 876497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2713233cc2e49a4db53ff08d6c114255?s=128&d=identicon&r=PG", "display_name": "DejanLekic", "link": "https://stackoverflow.com/users/876497/dejanlekic"}, "edited": false, "score": 0, "creation_date": 1571301796, "post_id": 58422547, "comment_id": 103197824, "body": "@DejanLekic thank you for the comment. how can i make tasks run on the aiohttp side. where i have the needed data in memory ?"}, {"owner": {"reputation": 15566, "user_id": 876497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2713233cc2e49a4db53ff08d6c114255?s=128&d=identicon&r=PG", "display_name": "DejanLekic", "link": "https://stackoverflow.com/users/876497/dejanlekic"}, "edited": false, "score": 0, "creation_date": 1571303398, "post_id": 58422547, "comment_id": 103198777, "body": "Your Celery task would be then extremely trivial - an HTTP request to your aiohttp-based service, and return whatever was returned by the web-service."}, {"owner": {"reputation": 858, "user_id": 2217746, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5f4e74a54a6fc8d20f96b168dbe222fc?s=128&d=identicon&r=PG", "display_name": "shay te", "link": "https://stackoverflow.com/users/2217746/shay-te"}, "reply_to_user": {"reputation": 15566, "user_id": 876497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2713233cc2e49a4db53ff08d6c114255?s=128&d=identicon&r=PG", "display_name": "DejanLekic", "link": "https://stackoverflow.com/users/876497/dejanlekic"}, "edited": false, "score": 0, "creation_date": 1571305014, "post_id": 58422547, "comment_id": 103199719, "body": "thanks again @DejanLekic. if i understand correctly the celery worker should notify aiohttp server using http request ? (the aiohttp need to push data to the client)"}], "owner": {"reputation": 858, "user_id": 2217746, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5f4e74a54a6fc8d20f96b168dbe222fc?s=128&d=identicon&r=PG", "display_name": "shay te", "link": "https://stackoverflow.com/users/2217746/shay-te"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571265355, "creation_date": 1571265355, "question_id": 58422547, "link": "https://stackoverflow.com/questions/58422547/run-celery-and-aiohttp-in-the-same-service", "title": "run celery and aiohttp in the same service", "body": "<p>my goal is to send live notifications to the user.<br>\nthe message will arrive from a <code>celery</code> worker.<br>\nand will be sent to the user using <code>aiohttp</code> through <code>sockjs</code>. </p>\n\n<p>how can i run both on the same app ? or receive the messages on the <code>aiohttp</code> instance where i have data of the authenticated users in memory ?\nwhat is the best approach to achieve that  ?</p>\n\n<p>i have tried running them together using the <code>aiohttp</code> <code>on_startup</code>. but celery is blocking the main thread so its not possible.</p>\n\n<pre><code>async def run_celery(app):\n    .... run celery\napp = web.Application(loop=asyncio.get_event_loop())\napp.on_startup.append(run_celery)\nsockjs.add_endpoint(app, msg_handler, name='messeging', prefix='/sockjs/')\n</code></pre>\n\n<p>thank you very much.<br>\nshay</p>\n"}, {"tags": ["python", "multiprocessing", "python-multiprocessing"], "owner": {"reputation": 22670, "user_id": 955273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/79903a88026b021e89735578bb71fd22?s=128&d=identicon&r=PG", "display_name": "Steve Lorimer", "link": "https://stackoverflow.com/users/955273/steve-lorimer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1571410306, "creation_date": 1571265252, "last_edit_date": 1571410306, "question_id": 58422531, "link": "https://stackoverflow.com/questions/58422531/how-to-fan-out-multiple-processes-from-multiple-processes", "title": "how to fan out multiple processes from multiple processes", "body": "<p>I have a task which needs to run a number of subtasks, each on their own vm, and then when all subtasks are complete, merge the results and present them back to the caller.</p>\n\n<p>I have implemented this using a <code>multiprocessing.Pool</code>, and it's working great.</p>\n\n<p>I now want to scale up, running multiple of these tasks in parallel.</p>\n\n<p>My initial design was to wrap my task running in another <code>multiprocessing.Pool</code>, where each task runs in its process, effectively fanning out as follows:</p>\n\n<pre><code>job\n+----- task_a\n|      +------ subtask_a1\n|      +------ subtask_a2\n|      +------ subtask_a3\n+----- task_b\n       +------ subtask_b1\n       +------ subtask_b2\n       +------ subtask_b3\n</code></pre>\n\n<ul>\n<li><code>job</code> starts a <code>multiprocessing.Pool</code> with 2 processes, one for <code>task_a</code> and one for <code>task_b</code>.</li>\n<li>in turn, <code>task_a</code> and <code>task_b</code> each start a <code>multiprocessing.Pool</code> with 3 processes, one for each of their subtasks.</li>\n</ul>\n\n<p>When I tried to run my code, I hit an assertion error:</p>\n\n<pre><code>AssertionError: daemonic processes are not allowed to have children\n</code></pre>\n\n<p>Searching online for details, I found the <a href=\"https://mail.python.org/pipermail/python-list/2011-March/600152.html\" rel=\"nofollow noreferrer\">following thread</a>, an excerpt of which reads:</p>\n\n<blockquote>\n  <p>As for allowing children threads to spawn off children of its own using \n  subprocess runs the risk of creating a little army of zombie \n  'grandchildren' if either the parent or child threads terminate before \n  the subprocess completes and returns</p>\n</blockquote>\n\n<p>I have also found <a href=\"https://stackoverflow.com/a/8963618/955273\">workarounds</a> which allow this kind of \"pool within a pool\" use:</p>\n\n<pre><code>class NoDaemonProcess(multiprocessing.Process):\n    @property\n    def daemon(self):\n        return False\n\n    @daemon.setter\n    def daemon(self, value):\n        pass\n\nclass NoDaemonContext(type(multiprocessing.get_context())):\n    Process = NoDaemonProcess\n\nclass MyPool(multiprocessing.pool.Pool):\n    def __init__(self, *args, **kwargs):\n        kwargs['context'] = NoDaemonContext()\n        super(MyPool, self).__init__(*args, **kwargs)\n</code></pre>\n\n<p>However, given the above quote about \"zombie grandchildren\", it seems perhaps this is not a good design.</p>\n\n<p>So I guess my question is:</p>\n\n<ul>\n<li>What is the pythonic way to \"fan out\" multiple processes within multiple processes\"?</li>\n</ul>\n"}, {"tags": ["python", "selenium"], "comments": [{"owner": {"reputation": 855, "user_id": 4744568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125cdb7d43927756913b920de016f420?s=128&d=identicon&r=PG", "display_name": "pcalkins", "link": "https://stackoverflow.com/users/4744568/pcalkins"}, "edited": false, "score": 0, "creation_date": 1571265991, "post_id": 58422511, "comment_id": 103187416, "body": "not sure it&#39;s the issue here but &quot;((By.XPATH, &quot;//div[@class=&#39;hm-Login_PasswordWrapper &#39;]//input[@type=&#39;text&#39;]&quot;)))&quot; looks like too many parenthesis.  When you manually type in that field, is it showing the letters or is it a password type?"}, {"owner": {"reputation": 23, "user_id": 12225974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24a974ed5abf5114b477b67a43f45851?s=128&d=identicon&r=PG&f=1", "display_name": "KMC", "link": "https://stackoverflow.com/users/12225974/kmc"}, "reply_to_user": {"reputation": 855, "user_id": 4744568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125cdb7d43927756913b920de016f420?s=128&d=identicon&r=PG", "display_name": "pcalkins", "link": "https://stackoverflow.com/users/4744568/pcalkins"}, "edited": false, "score": 0, "creation_date": 1571266292, "post_id": 58422511, "comment_id": 103187499, "body": "masked text\\password type.    i took out the extra parenthesis, still no success"}, {"owner": {"reputation": 855, "user_id": 4744568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125cdb7d43927756913b920de016f420?s=128&d=identicon&r=PG", "display_name": "pcalkins", "link": "https://stackoverflow.com/users/4744568/pcalkins"}, "edited": false, "score": 0, "creation_date": 1571267267, "post_id": 58422511, "comment_id": 103187717, "body": "probably need to see more of the markup, but seems like something is switching the hidden class from one input to the other.  Hard to tell when that happens without seeing the script(s) on the page.  Try switching to //input[@type=&#39;password&#39;]"}, {"owner": {"reputation": 23, "user_id": 12225974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24a974ed5abf5114b477b67a43f45851?s=128&d=identicon&r=PG&f=1", "display_name": "KMC", "link": "https://stackoverflow.com/users/12225974/kmc"}, "reply_to_user": {"reputation": 855, "user_id": 4744568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125cdb7d43927756913b920de016f420?s=128&d=identicon&r=PG", "display_name": "pcalkins", "link": "https://stackoverflow.com/users/4744568/pcalkins"}, "edited": false, "score": 0, "creation_date": 1571269643, "post_id": 58422511, "comment_id": 103188259, "body": "<a href=\"https://www.bet365.com.au\" rel=\"nofollow noreferrer\">bet365.com.au</a> is the website."}, {"owner": {"reputation": 23, "user_id": 12225974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24a974ed5abf5114b477b67a43f45851?s=128&d=identicon&r=PG&f=1", "display_name": "KMC", "link": "https://stackoverflow.com/users/12225974/kmc"}, "reply_to_user": {"reputation": 855, "user_id": 4744568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125cdb7d43927756913b920de016f420?s=128&d=identicon&r=PG", "display_name": "pcalkins", "link": "https://stackoverflow.com/users/4744568/pcalkins"}, "edited": false, "score": 0, "creation_date": 1571270581, "post_id": 58422511, "comment_id": 103188429, "body": "Try switching to //input[@type=&#39;password&#39;]     -- tried this...no success"}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 8370300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b35353a644bcf216256e338fb508062?s=128&d=identicon&r=PG&f=1", "display_name": "Chirag S", "link": "https://stackoverflow.com/users/8370300/chirag-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1571271511, "last_edit_date": 1571271511, "creation_date": 1571271176, "answer_id": 58423184, "question_id": 58422511, "link": "https://stackoverflow.com/questions/58422511/elementnotinteractableexception-python-selenium-not-duplicate/58423184#58423184", "title": "ElementNotInteractableException - Python / selenium not duplicate", "body": "<p>XPATH which you are using is getting an element with type=text. As soon as you click on this element class name gets \"Hidden\" appended, that's why when tried to enter a text in this element you get this error. Try below solution, First you click element with type=text and then clear and send keys to it's sibling element (type=password)</p>\n\n<pre><code>WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, \"//div[@class='hm-Login_PasswordWrapper ']//input[@type='text']\"))).click() \n\n# Now, Enter text into element with type=password attribute\nWebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, \"//div[contains(@class,'hm-Login_PasswordWrapper ')]//input[@type='password']\"))).clear()\ndriver.find_element_by_xpath(\"//div[@class='hm-Login_PasswordWrapper ']//input[@type='text']\").send_keys(\"xxxxx!\")\n</code></pre>\n\n<p>I tested this with Java and works fine. Sorry, I do not have Python currently but this should work.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 12225974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24a974ed5abf5114b477b67a43f45851?s=128&d=identicon&r=PG&f=1", "display_name": "KMC", "link": "https://stackoverflow.com/users/12225974/kmc"}, "is_accepted": false, "score": 0, "last_activity_date": 1571271418, "creation_date": 1571271418, "answer_id": 58423213, "question_id": 58422511, "link": "https://stackoverflow.com/questions/58422511/elementnotinteractableexception-python-selenium-not-duplicate/58423213#58423213", "title": "ElementNotInteractableException - Python / selenium not duplicate", "body": "<p>adding the following after specifying the driver seems to have done the trick and .send_keys(\"xxxx\")  is now working </p>\n\n<p>driver.implicitly_wait(15)</p>\n\n<p><a href=\"http://allselenium.info/wait-for-elements-python-selenium-webdriver/\" rel=\"nofollow noreferrer\">http://allselenium.info/wait-for-elements-python-selenium-webdriver/</a></p>\n"}], "owner": {"reputation": 23, "user_id": 12225974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24a974ed5abf5114b477b67a43f45851?s=128&d=identicon&r=PG&f=1", "display_name": "KMC", "link": "https://stackoverflow.com/users/12225974/kmc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1571284954, "creation_date": 1571265155, "question_id": 58422511, "link": "https://stackoverflow.com/questions/58422511/elementnotinteractableexception-python-selenium-not-duplicate", "title": "ElementNotInteractableException - Python / selenium not duplicate", "body": "<p>Having trouble .sendkeys  to the password text box  after it has been selected and i can see the cursor flashing waiting for some text input</p>\n\n<p>This is the html</p>\n\n<pre><code>&lt;div class=\"hm-Login \"&gt;\n    &lt;div class=\"hm-Login_UserNameWrapper \"&gt;\n        &lt;input type=\"text\" class=\"hm-Login_InputField \"&gt;\n        &lt;div class=\"hm-Login_InputText \"&gt;Join&lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div class=\"hm-Login_PasswordWrapper \"&gt;\n        &lt;input type=\"text\" class=\"hm-Login_InputField \"&gt;\n        &lt;input type=\"password\" class=\"hm-Login_InputField Hidden \"&gt;\n        &lt;button tabindex=\"0\" class=\"hm-Login_LoginBtn \"&gt;GO&lt;/button&gt;\n        &lt;div class=\"hm-Login_InputText \"&gt;Lost Login?&lt;/div&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>this is my code</p>\n\n<pre><code>from selenium import webdriver\nfrom selenium.webdriver.common.keys import Keys\nfrom bs4 import BeautifulSoup\nfrom selenium.webdriver.common.by import By\nfrom selenium.webdriver.support.ui import WebDriverWait\nfrom selenium.webdriver.support import expected_conditions as EC\n\nimport time\nfrom selenium import webdriver\n\ndriver = webdriver.Chrome(\"xxxxx/chromedriver\")\n\ndriver.get('https://www.bet365.com.au/#/HO/');\ndriver.find_element_by_xpath(\"//*[@id='TopPromotionBetNow']\").click()\n\nWebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.XPATH, \"//input[@type='text']\"))).click()\n\ndriver.find_element_by_class_name(\"hm-Login_InputField\").click()                                          \n#time.sleep(5) # Let the user actually see something!\n\n#username\nelem = driver.find_element_by_class_name(\"hm-Login_InputField\")\nelem.click()\nelem.clear() \nelem.send_keys(\"xxxx\")\n\n#password\nelem = driver.find_element_by_xpath(\"//div[@class='hm-Login_PasswordWrapper ']//input[@type='text']\")\n#elem = driver.find_element_by_xpath(\"//input[@type='text']\")\nelem.clear() \nelem.click()\n\n#attempt 1\nWebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, \"//div[@class='hm-Login_PasswordWrapper ']//input[@type='text']\"))).send_keys(\"xx\")\n\n#attempt 2\ndriver.implicitly_wait(10) # seconds\nelem.send_keys(\"xxxxx!\")\n</code></pre>\n\n<p>this is the error    <strong>ElementNotInteractableException: element not interactable</strong></p>\n\n<p>any help is appreciated..\nyou can see my attempts at the bottom of the code...</p>\n"}, {"tags": ["python", "django", "authentication"], "comments": [{"owner": {"reputation": 1254, "user_id": 8382028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715c51e1e2fe595daef9d377f0f1f323?s=128&d=identicon&r=PG&f=1", "display_name": "ViaTech", "link": "https://stackoverflow.com/users/8382028/viatech"}, "edited": false, "score": 0, "creation_date": 1571265524, "post_id": 58422508, "comment_id": 103187297, "body": "We need to see the declaration of <code>NewNewsForm()</code> it looks as if you aren&#39;t setting the attribute before save"}, {"owner": {"reputation": 57, "user_id": 12229283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52e16ec4371f90ee68af8e263793c541?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/12229283/brian"}, "reply_to_user": {"reputation": 1254, "user_id": 8382028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715c51e1e2fe595daef9d377f0f1f323?s=128&d=identicon&r=PG&f=1", "display_name": "ViaTech", "link": "https://stackoverflow.com/users/8382028/viatech"}, "edited": false, "score": 0, "creation_date": 1571266295, "post_id": 58422508, "comment_id": 103187500, "body": "The form worked before I tested it then I went to add the author field to it now I get the error I mentioned in the post. @ViaTech"}, {"owner": {"reputation": 1254, "user_id": 8382028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715c51e1e2fe595daef9d377f0f1f323?s=128&d=identicon&r=PG&f=1", "display_name": "ViaTech", "link": "https://stackoverflow.com/users/8382028/viatech"}, "edited": false, "score": 0, "creation_date": 1571273295, "post_id": 58422508, "comment_id": 103188967, "body": "@Brain wait a sec... <code>fields = [&#39;title&#39;, &#39;short_desc&#39;, &#39;content&#39;, &#39;category&#39;, &#39;tags&#39;, &#39;slug&#39;]</code> in your model form does not have <code>author_id</code> this is your issue and it is why you are obviously getting the error... If you post your <code>News</code> model too it will likely show that field is required, thus the error. Quickly speaking, after <code>form.isValid()</code> assign the <code>author_id</code> to the object and then save it and your error should be gone"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 12229283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52e16ec4371f90ee68af8e263793c541?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/12229283/brian"}, "edited": false, "score": 0, "creation_date": 1571272495, "post_id": 58423027, "comment_id": 103188801, "body": "Thank you but I get this error: <code>name &#39;user&#39; is not defined</code> also where do I add the last bit of code to my forms.py or views.py file?"}, {"owner": {"reputation": 1777, "user_id": 4018463, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2cda53800bf82ad95bc36b18c7e38ee?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/4018463/alex"}, "reply_to_user": {"reputation": 57, "user_id": 12229283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52e16ec4371f90ee68af8e263793c541?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/12229283/brian"}, "edited": false, "score": 0, "creation_date": 1571275555, "post_id": 58423027, "comment_id": 103189384, "body": "Last bit of code goes in your forms.py. Where do you get that error?"}, {"owner": {"reputation": 57, "user_id": 12229283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52e16ec4371f90ee68af8e263793c541?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/12229283/brian"}, "edited": false, "score": 0, "creation_date": 1571276241, "post_id": 58423027, "comment_id": 103189517, "body": "Ok thats what I thought but the error shows after the form is submitted"}, {"owner": {"reputation": 1777, "user_id": 4018463, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2cda53800bf82ad95bc36b18c7e38ee?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/4018463/alex"}, "reply_to_user": {"reputation": 57, "user_id": 12229283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52e16ec4371f90ee68af8e263793c541?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/12229283/brian"}, "edited": false, "score": 0, "creation_date": 1571276479, "post_id": 58423027, "comment_id": 103189561, "body": "@Brian just updated my answer with a simpler solution. I think this will solve your problems."}], "tags": [], "owner": {"reputation": 1777, "user_id": 4018463, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2cda53800bf82ad95bc36b18c7e38ee?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/4018463/alex"}, "is_accepted": true, "score": 0, "last_activity_date": 1571276456, "last_edit_date": 1571276456, "creation_date": 1571269527, "answer_id": 58423027, "question_id": 58422508, "link": "https://stackoverflow.com/questions/58422508/link-username-to-post-created-by-user/58423027#58423027", "title": "Link Username To Post Created By User", "body": "<p>You are not passing the user.</p>\n\n<p><em>Later edit with a simpler solution:</em></p>\n\n<p>Simply pass <code>commit=False</code> when saving the form. Which will create your <code>News</code> object without commiting it to DB. Simply set the author afterwards and save the object.</p>\n\n<pre><code>def new_news_form_view(request):\n    if request.method == \"POST\":\n        form_data = request.POST or None\n        form = NewNewsForm(form_data)\n        if form.is_valid():\n            news = form.save(commit=False)\n            news.author = request.user\n            news.save()\n            return redirect('/news')\n    else:\n        form = NewNewsForm()\n\n    context = {\n        'form': form\n    }\n    return render(request, \"news/news_form.html\", context)\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 12229283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52e16ec4371f90ee68af8e263793c541?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/12229283/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 58423027, "answer_count": 1, "score": 0, "last_activity_date": 1571276456, "creation_date": 1571265133, "last_edit_date": 1571268762, "question_id": 58422508, "link": "https://stackoverflow.com/questions/58422508/link-username-to-post-created-by-user", "title": "Link Username To Post Created By User", "body": "<p>I would like to link the user who created the post by their username that way people know who it was posted by but I can't seem to get it to work and yes I am logged in and I have a working register and login form already.</p>\n\n<p>Every time I go to submit some news from the form when logged in I get this error <code>NOT NULL constraint failed: news_news.author_id</code></p>\n\n<p>models.py</p>\n\n<pre><code>from django.db import models\nfrom django.contrib.auth.models import User\nfrom markdownx.models import MarkdownxField\nfrom markdownx.utils import markdownify\nfrom taggit.managers import TaggableManager\n\nclass News(models.Model):\n    author = models.ForeignKey(User, unique=True, on_delete=models.CASCADE)\n    title = models.CharField(max_length=150)\n    short_desc = models.CharField(max_length=500)\n    content = MarkdownxField()\n    tags = TaggableManager()\n    slug = models.SlugField(unique=True)\n    created_at = models.DateTimeField(auto_now_add=True)\n    updated_at = models.DateTimeField(auto_now=True)\n\n    def __str__(self):\n        return self.title\n</code></pre>\n\n<p>views.py</p>\n\n<pre><code>from django.shortcuts import render, redirect, get_object_or_404\nfrom .models import Category, News\nfrom .forms import NewNewsForm\nfrom django.shortcuts import render\n\ndef show_news_view(request):\n    news = News.objects.values('author', 'title', 'short_desc', 'tags', 'created_at', 'updated_at')\n\n    context = {\n        'news': news\n    }\n    return render(request, \"news/news_home.html\", context)\n\ndef new_news_form_view(request):\n    if request.method == \"POST\":\n        form = NewNewsForm(request.POST or None)\n        if form.is_valid():\n            form.save()\n            form = NewNewsForm()\n\n            return redirect('/news')\n    else:\n        form = NewNewsForm()\n\n    context = {\n        'form': form\n    }\n    return render(request, \"news/news_form.html\", context)\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>forms.py</p>\n\n<pre><code>from django import forms\nfrom .models import News\n\nclass NewNewsForm(forms.ModelForm):\n    class Meta:\n        model = News\n        fields = ['title', 'short_desc', 'content', 'category', 'tags', 'slug']\n</code></pre>\n\n<p>news_form.html</p>\n\n<pre><code>{% extends \"base.html\" %}\n\n{% block content %}\n\n{% if user.is_authenticated %}\n&lt;form action=\"\" method=\"POST\"&gt;\n    {% csrf_token %}\n    {{ form.as_p }}\n\n    &lt;button type=\"submit\"&gt;Submit&lt;/button&gt;\n&lt;/form&gt;\n{% else %}\n    &lt;p&gt;Please login before you can submit a news story.&lt;/p&gt;\n{% endif %}\n\n{% endblock content %}\n</code></pre>\n"}, {"tags": ["python", "regex", "replace"], "comments": [{"owner": {"reputation": 481672, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1571265380, "post_id": 58422505, "comment_id": 103187260, "body": "Have you noticed your <code>pattern</code>? It is extremely inefficient. Also, the terms can be space separated phrases, so your word boundary approach will work partially, without sorting the terms first. Eg. if you have both <code>Mercedes Benz</code> and <code>Mercedes</code>, then the former will never be matched."}, {"owner": {"reputation": 481672, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1571265642, "post_id": 58422505, "comment_id": 103187333, "body": "Please explain why you chose <code>\\w*(?&lt;![A-Za-z-;:,&#47;|])</code> and not a plain <code>\\b</code>?"}, {"owner": {"reputation": 383, "user_id": 10605468, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--KZ7Ipc7XHY/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBF4zl74sPltQb6hO8QPQEnB4Ka-w/mo/photo.jpg?sz=128", "display_name": "ABY", "link": "https://stackoverflow.com/users/10605468/aby"}, "reply_to_user": {"reputation": 481672, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1571266085, "post_id": 58422505, "comment_id": 103187442, "body": "Just to make sure if the terms beside special characters like Cars; are considered while replacing."}, {"owner": {"reputation": 481672, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1571266346, "post_id": 58422505, "comment_id": 103187513, "body": "So, basically, <code>\\b(?:term1|term2)\\b</code> should work after sorting."}, {"owner": {"reputation": 383, "user_id": 10605468, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--KZ7Ipc7XHY/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBF4zl74sPltQb6hO8QPQEnB4Ka-w/mo/photo.jpg?sz=128", "display_name": "ABY", "link": "https://stackoverflow.com/users/10605468/aby"}, "reply_to_user": {"reputation": 481672, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1571266628, "post_id": 58422505, "comment_id": 103187576, "body": "Meaning add \\b(?:term1|term2)\\b as part of pattern?"}, {"owner": {"reputation": 481672, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1571266724, "post_id": 58422505, "comment_id": 103187606, "body": "No, build it like this."}], "answers": [{"comments": [{"owner": {"reputation": 383, "user_id": 10605468, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--KZ7Ipc7XHY/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBF4zl74sPltQb6hO8QPQEnB4Ka-w/mo/photo.jpg?sz=128", "display_name": "ABY", "link": "https://stackoverflow.com/users/10605468/aby"}, "edited": false, "score": 0, "creation_date": 1571267767, "post_id": 58422749, "comment_id": 103187816, "body": "Thank you. Let me try. Is there a way we can exclude replacement beside a couple of special characters? Say, we had a term way and sentence had four-way. The replacement should not happen as it&#39;s substring. or if the term is part of a URL <a href=\"https://ford.com\" rel=\"nofollow noreferrer\">ford.com</a>. This just messes up the existing URLs."}, {"owner": {"reputation": 481672, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 383, "user_id": 10605468, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--KZ7Ipc7XHY/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBF4zl74sPltQb6hO8QPQEnB4Ka-w/mo/photo.jpg?sz=128", "display_name": "ABY", "link": "https://stackoverflow.com/users/10605468/aby"}, "edited": false, "score": 0, "creation_date": 1571267937, "post_id": 58422749, "comment_id": 103187861, "body": "@ABY That is a matter of what you consider a word boundary. If you want it to be any non-word char except a <code>-</code> on the left, just add <code>(?&lt;!-)</code> after the first <code>\\b</code>. If you need whitespace boundaries, use <code>r&#39;(?i)(?&lt;!\\S)(?:{})(?!\\S)&#39;.format(&#39;|&#39;.join(map(re.escape, sorted(df[&quot;term&quot;],key=len,reverse=True))))</code>. Note that if you have thousands of terms, you need to create a <a href=\"https://stackoverflow.com/a/42789508/3832970\">regex trie</a>."}, {"owner": {"reputation": 383, "user_id": 10605468, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--KZ7Ipc7XHY/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBF4zl74sPltQb6hO8QPQEnB4Ka-w/mo/photo.jpg?sz=128", "display_name": "ABY", "link": "https://stackoverflow.com/users/10605468/aby"}, "edited": false, "score": 1, "creation_date": 1571301169, "post_id": 58422749, "comment_id": 103197467, "body": ":) Your explanation was really helpful. Thanks again. I have posted another question (58428167) which is a slight modification from this. Appreciate any help, if possible."}], "tags": [], "owner": {"reputation": 481672, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 2, "last_activity_date": 1571266993, "creation_date": 1571266993, "answer_id": 58422749, "question_id": 58422505, "link": "https://stackoverflow.com/questions/58422505/what-could-be-the-better-approach-for-pattern-match-and-replace-in-python/58422749#58422749", "title": "What could be the better approach for pattern match and replace in Python?", "body": "<p>Your pattern is very inefficient since it has many unanchored alternatives starting with an identical pattern that can backtrack a lot. Besides, the word boundaries that you want to use you also need to sort the terms by length in descending order to find the longest terms in case they overlap (like, say, <code>Merceded</code> and <code>Mercedes Benz</code>).</p>\n\n<p>So, use</p>\n\n<pre><code>pattern = r'(?i)\\b(?:{})\\b'.format('|'.join(sorted(df[\"term\"],key=len,reverse=True)))\n</code></pre>\n\n<p>Or, if you have spcial chars in the terms,</p>\n\n<pre><code>pattern = r'(?i)(?&lt;!\\w)(?:{})(?!\\w)'.format('|'.join(map(re.escape, sorted(df[\"term\"],key=len,reverse=True))))\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>df[\"words\"]= df[\"sentence\"].str.findall(pattern)\ndf[\"sentence\"].replace(pattern, r\"\\g&lt;0&gt;|present\", inplace=True, regex=True)\n</code></pre>\n\n<p>The pattern will look like <code>(?i)\\b(?:Mercedes Benz|EXpensive|electric|TOYOTA|Ford|cars)\\b</code>, it will match - in a case insensitive way due to <code>(?i)</code> - whole words <code>Mercedes Benz</code>, <code>EXpensive</code>, <code>electric</code>, <code>TOYOTA</code>, <code>Ford</code>, <code>cars</code> and in <code>df[\"sentence\"].str.findall(pattern)</code>, it will find all non-overlapping occurrences of the pattern match and in <code>df[\"sentence\"].replace(pattern, r\"\\g&lt;0&gt;|present\", inplace=True, regex=True)</code>, all matches will be replaced with themselves (<code>\\g&lt;0&gt;</code> is a backreference to the whole match) + <code>|present</code> appended to them.</p>\n"}], "owner": {"reputation": 383, "user_id": 10605468, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--KZ7Ipc7XHY/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBF4zl74sPltQb6hO8QPQEnB4Ka-w/mo/photo.jpg?sz=128", "display_name": "ABY", "link": "https://stackoverflow.com/users/10605468/aby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 58422749, "answer_count": 1, "score": 2, "last_activity_date": 1571266993, "creation_date": 1571265114, "last_edit_date": 1571266152, "question_id": 58422505, "link": "https://stackoverflow.com/questions/58422505/what-could-be-the-better-approach-for-pattern-match-and-replace-in-python", "title": "What could be the better approach for pattern match and replace in Python?", "body": "<p>I have a flat file with terms and sentences. If any term is found in the sentence, I need to append |present (term|present). Basically, pattern match (case insensitive) and append |present. Also, we need to retain the same case as in the sentence. What approach would be feasible and faster in Python. I tried this using Oracle regex, this takes days to process 70k records.</p>\n\n<p>Right now I am using the below code. Is there a better approach. And also with the current approach, it works fine for the 50 records but the df['words'] is empty when run for the entire 70k records. Not sure what the reason could be.</p>\n\n<pre><code>from pandas import DataFrame\n\ndf = {'term': ['Ford', 'EXpensive', 'TOYOTA', 'Mercedes Benz', 'electric', 'cars'],\n        'sentence': ['Ford is less expensive than Mercedes Benz.' ,'toyota, hyundai mileage is good compared to ford','tesla is an electric-car','toyota too has electric cars','CARS','CArs are expensive.']\n        }\nfrom pandas import DataFrame\nimport re\ndf = DataFrame(df,columns= ['term','sentence'])\n\npattern = \"|\".join(f\"\\w*(?&lt;![A-Za-z-;:,/|]){i}\\\\b\" for i in df[\"term\"])\n\ndf[\"words\"]= df['sentence'].str.findall(pattern, flags=re.IGNORECASE)\n\ndef replace_values(row):\n    if len(row.words)&gt;0:\n        pat = r\"(\\b\"+\"|\".join(row.words) +r\")(\\b)\"\n        row.sentence = re.sub(pat, \"\\\\1|present\\\\2\", row.sentence)\n    return row\n\ndf = df.apply(replace_values, axis=1)\n\n\n</code></pre>\n"}, {"tags": ["python", "python-internals"], "comments": [{"owner": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 6, "creation_date": 1571264984, "post_id": 58422466, "comment_id": 103187157, "body": "Python <b>is not</b> C. <code>sys.getsizeof(int)</code> returns the size of the object referenced by <code>int</code>, which in this case, is the class-object for the built-in type <code>int</code>. That is not the same as the size of any of its instances. Note, integer objects <i>can have different sizes</i>. So compare <code>sys.getsizeof(0), sys.getsizeof(1), sys.getsizeof(10000000000)</code>"}, {"owner": {"reputation": 4102, "user_id": 10366273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1c2BX.jpg?s=128&g=1", "display_name": "MyNameIsCaleb", "link": "https://stackoverflow.com/users/10366273/mynameiscaleb"}, "edited": false, "score": 0, "creation_date": 1571265029, "post_id": 58422466, "comment_id": 103187167, "body": "Check <a href=\"https://stackoverflow.com/a/30316760/10366273\">this answer</a>"}, {"owner": {"reputation": 4102, "user_id": 10366273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1c2BX.jpg?s=128&g=1", "display_name": "MyNameIsCaleb", "link": "https://stackoverflow.com/users/10366273/mynameiscaleb"}, "edited": false, "score": 1, "creation_date": 1571265481, "post_id": 58422466, "comment_id": 103187283, "body": "<code>int</code> is of type <code>&lt;class &#39;type&#39;&gt;</code> and so are your other examples which is why they are all the same size and <code>1</code> is of type <code>&lt;class &#39;int&#39;&gt;</code> which is why it&#39;s sized 28."}], "answers": [{"tags": [], "owner": {"reputation": 4102, "user_id": 10366273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1c2BX.jpg?s=128&g=1", "display_name": "MyNameIsCaleb", "link": "https://stackoverflow.com/users/10366273/mynameiscaleb"}, "is_accepted": true, "score": 3, "last_activity_date": 1571266337, "last_edit_date": 1571266337, "creation_date": 1571265550, "answer_id": 58422568, "question_id": 58422466, "link": "https://stackoverflow.com/questions/58422466/actual-size-of-an-integer-object-in-python/58422568#58422568", "title": "Actual size of an integer object in python", "body": "<p>These objects aren't the same type which is why they aren't the same size:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>&gt;&gt;&gt; type(int)\n&lt;class 'type'&gt;\n&gt;&gt;&gt; sys.getsizeof(type)\n416\n&gt;&gt;&gt; type(object)\n&lt;class 'type'&gt;\n&gt;&gt;&gt; type(type)\n&lt;class 'type'&gt;\n\n&gt;&gt;&gt; type(1)\n&lt;class 'int'&gt;\n&gt;&gt;&gt; sys.getsizeof(1)\n28\n</code></pre>\n\n<p>There is a good answer on the general sizes of most objects and how they scale <a href=\"https://stackoverflow.com/a/30316760/10366273\">here</a>.</p>\n\n<p>And for the record, <code>&lt;class 'type'&gt;</code> is a <a href=\"https://docs.python.org/3/reference/datamodel.html#metaclasses\" rel=\"nofollow noreferrer\">metaclass</a> and there is a super long answer <a href=\"https://stackoverflow.com/questions/100003/what-are-metaclasses-in-python/6581949#6581949\">here</a> on what those are and why.</p>\n"}], "owner": {"reputation": 96308, "user_id": 651174, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2e2d79b9350ef4ebf04ac0ad5816a5c3?s=128&d=identicon&r=PG", "display_name": "David542", "link": "https://stackoverflow.com/users/651174/david542"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "closed_date": 1571269696, "accepted_answer_id": 58422568, "answer_count": 1, "score": -1, "last_activity_date": 1571266337, "creation_date": 1571264884, "question_id": 58422466, "link": "https://stackoverflow.com/questions/58422466/actual-size-of-an-integer-object-in-python", "closed_reason": "Duplicate", "title": "Actual size of an integer object in python", "body": "<p>Why does the following produce such different results?</p>\n\n<pre><code>&gt;&gt;&gt; sys.getsizeof(int) # same as sys.getsizeof(object), sys.getsizeof(type)\n400\n\n&gt;&gt;&gt; sys.getsizeof(1)\n28\n</code></pre>\n\n<p>Is the actual size of the item <code>1</code> equal to the size of the object (400) + the size of the actual integer value (28) = 428, or how exactly does the integer/object creation work here?</p>\n"}, {"tags": ["python", "math", "geometry"], "comments": [{"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 0, "creation_date": 1571265222, "post_id": 58422446, "comment_id": 103187212, "body": "Since this is a rectangular display, I recommend that you use a rectangular approach: draw horizontal lines as close as needed for the screen resolution. Even better, look for a &quot;shape fill&quot; capability in the package you&#39;re using."}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1571293303, "post_id": 58422446, "comment_id": 103193669, "body": "Why don&#39;t you use draw.ellipse ???"}, {"owner": {"reputation": 711, "user_id": 10734880, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VqInoFdU3M8/AAAAAAAAAAI/AAAAAAAAAA4/KLtzLyk_ZJ0/photo.jpg?sz=128", "display_name": "Nick Martin", "link": "https://stackoverflow.com/users/10734880/nick-martin"}, "edited": false, "score": 0, "creation_date": 1571362957, "post_id": 58422446, "comment_id": 103224911, "body": "@Jacek Potpaczuk can you accept the answer below? I think it answers your question?"}, {"owner": {"reputation": 29, "user_id": 10727351, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3j1WS9w3okc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iic14mX_v2gqYMUS0Wh5qorOwM0Q/mo/photo.jpg?sz=128", "display_name": "Jacek Potapczuk", "link": "https://stackoverflow.com/users/10727351/jacek-potapczuk"}, "edited": false, "score": 0, "creation_date": 1572278924, "post_id": 58422446, "comment_id": 103501805, "body": "yes, my bad. I think there is a better way but this one is good enough. Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 711, "user_id": 10734880, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VqInoFdU3M8/AAAAAAAAAAI/AAAAAAAAAA4/KLtzLyk_ZJ0/photo.jpg?sz=128", "display_name": "Nick Martin", "link": "https://stackoverflow.com/users/10734880/nick-martin"}, "is_accepted": true, "score": 1, "last_activity_date": 1571266191, "last_edit_date": 1571266191, "creation_date": 1571265598, "answer_id": 58422571, "question_id": 58422446, "link": "https://stackoverflow.com/questions/58422446/how-to-draw-the-best-ellipse-given-number-of-points/58422571#58422571", "title": "How to draw the best ellipse given number of points?", "body": "<p>Perhaps create the points uniformly and then filter out the ones outside the ellipse?</p>\n\n<pre><code>import numpy as np\nfrom math import sqrt\nimport matplotlib.pyplot as plt\n\ndef filter_points(h, k, a, b, x, y): \n  mask = ((x-h)**2)/(a**2) + ((y-k)**2)/(b**2) &lt;= 1\n  return x[mask], y[mask]\n\nh = 0\nk = 0\na = 4\nb = 5\nN = 10000\nn = int(sqrt(N))\n\nX, Y = np.meshgrid(\n  np.linspace(-a,a,n),\n  np.linspace(-b,b,n)\n)\n\nX, Y = filter_points(h, k, a, b, X[:], Y[:])\npoints = np.asarray([X, Y]).T\n\nplt.figure\nplt.plot(X,Y,'.')\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/s0r2q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s0r2q.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 29, "user_id": 10727351, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3j1WS9w3okc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iic14mX_v2gqYMUS0Wh5qorOwM0Q/mo/photo.jpg?sz=128", "display_name": "Jacek Potapczuk", "link": "https://stackoverflow.com/users/10727351/jacek-potapczuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 58422571, "answer_count": 1, "score": 1, "last_activity_date": 1571266191, "creation_date": 1571264747, "question_id": 58422446, "link": "https://stackoverflow.com/questions/58422446/how-to-draw-the-best-ellipse-given-number-of-points", "title": "How to draw the best ellipse given number of points?", "body": "<p>Given the vectors p,q and number of points n I want to approximate shape of the ellipse with these n points as best as possible. To do this I use parametric equation of ellipse and change radius and angle in a double for loop:</p>\n\n<pre><code>n = 10000\npoints = []\np = [300, 0]\nq = [0, 200]\nroot = int(math.sqrt(n))\nfor a in range(root):\n    for b in range(root):\n        x = 400 + (a/root)*(p[0] - q[0])*math.cos(2*math.pi*b/root)\n        y = 300 - (a/root)*(p[1] - q[1])*math.sin(2*math.pi*b/root)\n        points.append([x, y])\nfor w in points:\n    pygame.draw.circle(screen, (200, 50, 75), (int(w[0]), int(w[1])), 1)\n</code></pre>\n\n<p>Here I'm using pygame to draw but it doesn't really matter. Given these parameters my ellipse looks like this:</p>\n\n<p><img src=\"https://i.imgur.com/EPj9ULx.png\" alt=\"ellipse 1\"></p>\n\n<p>with n = 100000. It looks like this:\n<img src=\"https://i.imgur.com/EPj9ULx.png\" alt=\"ellipse 2\"></p>\n\n<p>Given the nature of the ellipse there are more points in the middle using basic parametrization of the radious and angle. Because of that I need very large n to get good picture. How can I change parameterization to make points better spread on the whole area?</p>\n"}, {"tags": ["python"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 5, "creation_date": 1571264795, "post_id": 58422436, "comment_id": 103187118, "body": "<code>not object</code> will be true if object is <code>0</code>, <code>False</code>, etc."}, {"owner": {"reputation": 4102, "user_id": 10366273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1c2BX.jpg?s=128&g=1", "display_name": "MyNameIsCaleb", "link": "https://stackoverflow.com/users/10366273/mynameiscaleb"}, "edited": false, "score": 3, "creation_date": 1571264809, "post_id": 58422436, "comment_id": 103187123, "body": "Some things are <i>falsy</i> which will trigger on <code>not</code> where as only <code>None</code> is <code>None</code>"}], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 10281572, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N0oYg7hgGGM/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMlsLl0oVPj1OXarJx8eTDBbo40sg/mo/photo.jpg?sz=128", "display_name": "Teh Ki", "link": "https://stackoverflow.com/users/10281572/teh-ki"}, "edited": false, "score": 0, "creation_date": 1571268787, "post_id": 58422483, "comment_id": 103188091, "body": "So I guess it is alright for me to presume that it is a matter of simplification?"}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 2, "last_activity_date": 1571264984, "creation_date": 1571264984, "answer_id": 58422483, "question_id": 58422436, "link": "https://stackoverflow.com/questions/58422436/testing-for-none-in-if-statements/58422483#58422483", "title": "Testing for None in if statements", "body": "<p><code>not object</code> is true when <code>object</code> has any falsey value, such as <code>0</code> or <code>False</code>.</p>\n\n<p>If you know a priori that the variable contains either a <code>QListWidgetItem</code> or <code>None</code>, then <code>None</code> is the only falsey possibility, so <code>if not object:</code> is a simpler way to write the condition.</p>\n\n<p>You just have to be careful about this in other context. Consider a variable that can contain a number or <code>None</code>. I've seen many errors due to not considering the possibility that the number might be <code>0</code>.</p>\n"}], "owner": {"reputation": 375, "user_id": 10281572, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N0oYg7hgGGM/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMlsLl0oVPj1OXarJx8eTDBbo40sg/mo/photo.jpg?sz=128", "display_name": "Teh Ki", "link": "https://stackoverflow.com/users/10281572/teh-ki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "closed_date": 1571265051, "accepted_answer_id": 58422483, "answer_count": 1, "score": 0, "last_activity_date": 1571264984, "creation_date": 1571264706, "question_id": 58422436, "link": "https://stackoverflow.com/questions/58422436/testing-for-none-in-if-statements", "closed_reason": "Duplicate", "title": "Testing for None in if statements", "body": "<p>What is the differences between using <code>if object is None</code> versus <code>if not object</code>?</p>\n\n<p>So while I was doing some coding where I messed up the signals in the QListWidget, where in a selection instance, it is returning me 2 signals, where it returns 2 objects - QListWidgetItem and None.</p>\n\n<p>To address to the None return, I used <code>if object is None</code>, but I was told that <code>if not object</code> would be better. Even so, it seems that using either of the 2 <code>if</code> would still allow me to achieve the same result.</p>\n\n<p>Is there a better case scenario as to when to use either?</p>\n"}, {"tags": ["python", "json", "selenium", "pickle"], "comments": [{"owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1571270050, "post_id": 58422427, "comment_id": 103188343, "body": "More simple is to use selenium in the main script. What&#39;s the point of subprocess here?"}, {"owner": {"reputation": 119, "user_id": 9594269, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mjHhZ.jpg?s=128&g=1", "display_name": "mdkb", "link": "https://stackoverflow.com/users/9594269/mdkb"}, "reply_to_user": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1571271083, "post_id": 58422427, "comment_id": 103188525, "body": "@pguardiario I think merging the scripts might be the best way to address it but it will require re-designing the entire process just to pass a variable. Regardless of that, I think it important for me to learn the principle of how to achieve this simple transfer of data between scripts, in case it is required in a future project."}, {"owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1571271448, "post_id": 58422427, "comment_id": 103188596, "body": "It&#39;s more useful to learn how to make a module, using subprocess for this is bad design."}, {"owner": {"reputation": 119, "user_id": 9594269, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mjHhZ.jpg?s=128&g=1", "display_name": "mdkb", "link": "https://stackoverflow.com/users/9594269/mdkb"}, "reply_to_user": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1571274790, "post_id": 58422427, "comment_id": 103189246, "body": "are you certain of that? what about if script2 needed to remain seperate and be called by script1. or script3, or many other scripts. maybe that is what you mean by module, but could you explain that if so. I am learning python, not an expert in it."}, {"owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1571276327, "post_id": 58422427, "comment_id": 103189531, "body": "It&#39;s too much to get into here, but you should look for some tutorials."}, {"owner": {"reputation": 119, "user_id": 9594269, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mjHhZ.jpg?s=128&g=1", "display_name": "mdkb", "link": "https://stackoverflow.com/users/9594269/mdkb"}, "reply_to_user": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1571276911, "post_id": 58422427, "comment_id": 103189641, "body": "I will do that thanks for the tip. probably explains why searching for a solution my way was proving fruitless on this topic."}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 9594269, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mjHhZ.jpg?s=128&g=1", "display_name": "mdkb", "link": "https://stackoverflow.com/users/9594269/mdkb"}, "is_accepted": true, "score": 0, "last_activity_date": 1571281283, "creation_date": 1571281283, "answer_id": 58424263, "question_id": 58422427, "link": "https://stackoverflow.com/questions/58422427/how-to-pass-python-data-back-to-the-calling-script-about-a-browser-window-left-o/58424263#58424263", "title": "How to pass python data back to the calling script about a browser window left open when the called script closes", "body": "<p>Thanks to pguardiario in the comments for setting me on the right track. The answer to this is to use script2 as a module. </p>\n\n<p>I had actually tried to do this already, but it was crashing my script1 because I had dashes in the naming of my scripts, which works fine when they are scripts, but for some reason does not work when they are used as modules and yet gives you no error either. It just bombs out of the script altogether (on my linux/python 3 setup this is the case).</p>\n\n<p>The solution was surprisingly simple once I resolved the file naming issues.</p>\n\n<p>in script1.py I now have </p>\n\n<pre><code>import script2\n</code></pre>\n\n<p>then I call the main() function from the second script with</p>\n\n<pre><code>script2.main\n</code></pre>\n\n<p>I did not have to make any changes to script2, it runs from the local folder so needs no additional path setting, and I can now remove all the script calling code as well. </p>\n\n<p>The main point being don't use dashes in the naming of modules as it gives you no error warnings but wont import them.</p>\n"}], "owner": {"reputation": 119, "user_id": 9594269, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mjHhZ.jpg?s=128&g=1", "display_name": "mdkb", "link": "https://stackoverflow.com/users/9594269/mdkb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 58424263, "answer_count": 1, "score": 1, "last_activity_date": 1571281283, "creation_date": 1571264634, "question_id": 58422427, "link": "https://stackoverflow.com/questions/58422427/how-to-pass-python-data-back-to-the-calling-script-about-a-browser-window-left-o", "title": "How to pass python data back to the calling script about a browser window left open when the called script closes", "body": "<p>I am trying to find the best method to pass data from python script2.py back to the calling script (script1.py). I am using Python 3 on Linux.</p>\n\n<p>Script1 calls script2.py which then uses Selenium to open a browser window and do something things. When script2 ends, the browser remains open and script1 continues. What I want is to then be able to work on the browser window that was opened in script2, from within script1.</p>\n\n<p>So far I have failed to find a suitable way to pass the information about the open browser window from script2 back to script1. I believe part of the issue is because when script2 is called, script1 waits until it has closed before continuing on, so there is no way to grab the variables open in script2. I do not want to change this aspect either.</p>\n\n<p>in script1.py the below code calls script2 like this: </p>\n\n<pre><code>cmd = ['python3', '/home/admin/Desktop/Python_stuff/live-scripts/script2.py']\n        subprocess.Popen(cmd).wait() # Python will now wait for script to end before continuing\n</code></pre>\n\n<p>in script2 the below code opens the browser initially (which currently stays open after script2 closes) like this:</p>\n\n<pre><code>driver.get(targetURL)\n</code></pre>\n\n<p>I have looked at Pickle but could not get it to work how I wanted and will probably next try to use import JSON. But I wondered if I am missing a more simple method to achieve what I want here.</p>\n"}, {"tags": ["python", "python-internals"], "comments": [{"owner": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 3, "creation_date": 1571264900, "post_id": 58422426, "comment_id": 103187141, "body": "Where do you imagine objects <i>are converted</i> to class objects?"}, {"owner": {"reputation": 4102, "user_id": 10366273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1c2BX.jpg?s=128&g=1", "display_name": "MyNameIsCaleb", "link": "https://stackoverflow.com/users/10366273/mynameiscaleb"}, "edited": false, "score": 2, "creation_date": 1571265199, "post_id": 58422426, "comment_id": 103187205, "body": "I don&#39;t understand what you are getting at with this question."}, {"owner": {"reputation": 96308, "user_id": 651174, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2e2d79b9350ef4ebf04ac0ad5816a5c3?s=128&d=identicon&r=PG", "display_name": "David542", "link": "https://stackoverflow.com/users/651174/david542"}, "reply_to_user": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 0, "creation_date": 1571265294, "post_id": 58422426, "comment_id": 103187233, "body": "@juanpa.arrivillaga I thought creating a class is the same as doing <code>class NewClass(object):</code>, where it converts from the object type?"}, {"owner": {"reputation": 15430, "user_id": 4518341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eVuAv.png?s=128&g=1", "display_name": "wjandrea", "link": "https://stackoverflow.com/users/4518341/wjandrea"}, "edited": false, "score": 0, "creation_date": 1571265351, "post_id": 58422426, "comment_id": 103187249, "body": "@David542 That&#39;s inheritance, not conversion. But correct me if I&#39;m wrong."}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 0, "creation_date": 1571265368, "post_id": 58422426, "comment_id": 103187254, "body": "That is not a conversion from <code>object</code>; it&#39;s giving <code>object</code> as the parent class from which to inherit."}, {"owner": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 0, "creation_date": 1571265508, "post_id": 58422426, "comment_id": 103187292, "body": "@David542 no, that is not what the class definition statement does at all. <code>class NewClass(object): ...</code> says &quot;create a class NewClass that inherits from object&quot;"}, {"owner": {"reputation": 96308, "user_id": 651174, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2e2d79b9350ef4ebf04ac0ad5816a5c3?s=128&d=identicon&r=PG", "display_name": "David542", "link": "https://stackoverflow.com/users/651174/david542"}, "reply_to_user": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 0, "creation_date": 1571265638, "post_id": 58422426, "comment_id": 103187331, "body": "@juanpa.arrivillaga I see, thanks for the explanation. Is it possible then to &quot;create that class&quot; from the interpreter without using the <code>class NewClass: pass</code> statement? I&#39;m basically just trying to understand what python is doing behind the scenes to create the new class from a base object/class."}, {"owner": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 4, "creation_date": 1571265956, "post_id": 58422426, "comment_id": 103187408, "body": "class objects are created using a metaclass, a class of a class. Unless you specifically choose an alternate, that will be <code>type</code>, and you can create classes dynamically using the three argument form of <code>type</code>. So, <code>NewClass = type(&quot;NewClass&quot;, (object,), {})</code> would be the equivalent thing to your class definition. Note, classes aren&#39;t <i>created from</i> a base class. They <i>inherit</i> from them."}, {"owner": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 2, "creation_date": 1571266141, "post_id": 58422426, "comment_id": 103187462, "body": "@David542 some good reading about what goes on during class creation: <a href=\"https://docs.python.org/3/reference/datamodel.html#metaclasses\" rel=\"nofollow noreferrer\">docs.python.org/3/reference/datamodel.html#metaclasses</a>"}], "answers": [{"comments": [{"owner": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 1, "creation_date": 1571265029, "post_id": 58422488, "comment_id": 103187166, "body": "I don&#39;t <i>think</i> that is what the OP is asking, but it isn&#39;t super clear."}], "tags": [], "owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "is_accepted": false, "score": 0, "last_activity_date": 1571264996, "creation_date": 1571264996, "answer_id": 58422488, "question_id": 58422426, "link": "https://stackoverflow.com/questions/58422426/how-is-an-object-converted-into-a-class-object/58422488#58422488", "title": "How is an object converted into a class object?", "body": "<p>In general, you cannot simply \"convert\" an object of one class into another; they are, by default, incompatible types.  Rather, you write a conversion method for the old class that returns your desired object of the new class.  For instance ...</p>\n\n<pre><code>class new_obj:\n    def __init__(self, value=13):\n        self.value = value\n\n\nclass old_obj:\n    def __init__(self, value=7):\n        self.value = value\n\n    def to_new(self):\n        return new_obj(value * value)\n</code></pre>\n\n<p>Your \"conversion\" sequence would then be</p>\n\n<pre><code>old_thing = old_obj(5)\nnew_thing = old_thing.to_new()\n</code></pre>\n"}], "owner": {"reputation": 96308, "user_id": 651174, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2e2d79b9350ef4ebf04ac0ad5816a5c3?s=128&d=identicon&r=PG", "display_name": "David542", "link": "https://stackoverflow.com/users/651174/david542"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1571264996, "creation_date": 1571264624, "question_id": 58422426, "link": "https://stackoverflow.com/questions/58422426/how-is-an-object-converted-into-a-class-object", "title": "How is an object converted into a class object?", "body": "<p>How is an <code>object</code> transformed into a class object? For example:</p>\n\n<pre><code>&gt;&gt;&gt; object\n&lt;type 'object'&gt;\n\n&gt;&gt;&gt; class NewClass:\n...     pass\n</code></pre>\n\n<p>If someone were to start with:</p>\n\n<pre><code>&gt;&gt;&gt; o=object\n</code></pre>\n\n<p>What would need to be done in the interpreter to \"convert\" that object into <code>NewClass</code>? (Or is it not possible to do without the class syntax?).</p>\n"}, {"tags": ["python", "pandas", "api"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11941237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d71b26ece183437e9f872ed5010b282?s=128&d=identicon&r=PG&f=1", "display_name": "kerrie", "link": "https://stackoverflow.com/users/11941237/kerrie"}, "edited": false, "score": 0, "creation_date": 1571266112, "post_id": 58422492, "comment_id": 103187453, "body": "Yes exactly but there are 50 rows"}], "tags": [], "owner": {"reputation": 683, "user_id": 11220780, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ubIXaw71rPY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reTNbPdx6BDLRY2TCGVZDXEhNhHWQ/mo/photo.jpg?sz=128", "display_name": "Benoit de Menthi&#232;re", "link": "https://stackoverflow.com/users/11220780/benoit-de-menthi%c3%a8re"}, "is_accepted": true, "score": 0, "last_activity_date": 1571265020, "creation_date": 1571265020, "answer_id": 58422492, "question_id": 58422395, "link": "https://stackoverflow.com/questions/58422395/separate-column-data-with-a-comma-to-two-columns-for-dataframe/58422492#58422492", "title": "Separate column data with a comma to two columns for dataframe", "body": "<p>is it what you are looking for:</p>\n\n<p><code>d = ([['Date', 'Value']],\n [[['2019-08-31', 445000.0],\n   ['2019-07-31', 450000.0],\n   ['2019-06-30', 450000.0]]])</code></p>\n\n<p><code>pd.DataFrame(d[1][0], columns=d[0][0])</code></p>\n\n<p>return:</p>\n\n<p><a href=\"https://i.stack.imgur.com/HkInD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HkInD.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 11941237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d71b26ece183437e9f872ed5010b282?s=128&d=identicon&r=PG&f=1", "display_name": "kerrie", "link": "https://stackoverflow.com/users/11941237/kerrie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 58422492, "answer_count": 1, "score": 0, "last_activity_date": 1571265020, "creation_date": 1571264407, "question_id": 58422395, "link": "https://stackoverflow.com/questions/58422395/separate-column-data-with-a-comma-to-two-columns-for-dataframe", "title": "Separate column data with a comma to two columns for dataframe", "body": "<p>The data set I pulled from an API return looks like this: </p>\n\n<pre><code>([['Date', 'Value']],\n [[['2019-08-31', 445000.0],\n   ['2019-07-31', 450000.0],\n   ['2019-06-30', 450000.0]]])\n</code></pre>\n\n<p>I'm trying to create a DataFrame with two columns from the data: \nDate &amp; Value </p>\n\n<p>Here's what I've tried:</p>\n\n<pre><code>df = pd.DataFrame(city_data, index =['a', 'b'], columns =['Names'] . \n    ['Names1'])\n</code></pre>\n\n<pre><code>city_data[['Date','Value']] = \n    city_data['Date'].str.split(',',expand=True)\n    city_data\n</code></pre>\n\n<pre><code>city_data.append({\"header\": column_value, \n                    \"Value\": date_value})\n    city_data = pd.DataFrame()\n</code></pre>\n\n<p>This code was used to create the dataset. I pulled the lists from the API return: </p>\n\n<pre><code>column_value = data[\"dataset\"][\"column_names\"]\n    date_value = data[\"dataset\"][\"data\"]\n\n    city_data = ([column_value], [date_value])\n    city_data\n</code></pre>\n\n<p>Instead of creating a dataframe with two columns from the data, in most cases I get the \"TypeError: list indices must be integers or slices, not str\"</p>\n"}, {"tags": ["python", "pandas", "fillna"], "comments": [{"owner": {"reputation": 683, "user_id": 11220780, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ubIXaw71rPY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reTNbPdx6BDLRY2TCGVZDXEhNhHWQ/mo/photo.jpg?sz=128", "display_name": "Benoit de Menthi&#232;re", "link": "https://stackoverflow.com/users/11220780/benoit-de-menthi%c3%a8re"}, "edited": false, "score": 0, "creation_date": 1571265285, "post_id": 58422361, "comment_id": 103187231, "body": "this should work, can you provide a data sample?"}, {"owner": {"reputation": 3552, "user_id": 4240413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54298e0142978d385309d265b585c818?s=128&d=identicon&r=PG&f=1", "display_name": "Davide Fiocco", "link": "https://stackoverflow.com/users/4240413/davide-fiocco"}, "edited": false, "score": 0, "creation_date": 1571265362, "post_id": 58422361, "comment_id": 103187252, "body": "This is an almost duplicate of <a href=\"https://stackoverflow.com/questions/38134012/pandas-dataframe-fillna-only-some-columns-in-place\" title=\"pandas dataframe fillna only some columns in place\">stackoverflow.com/questions/38134012/&hellip;</a> you can find loads of useful variants there."}, {"owner": {"reputation": 291, "user_id": 5408352, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/76a6aa39763df6454516440c4b9db861?s=128&d=identicon&r=PG&f=1", "display_name": "RJL", "link": "https://stackoverflow.com/users/5408352/rjl"}, "edited": false, "score": 0, "creation_date": 1571328646, "post_id": 58422361, "comment_id": 103213667, "body": "This is not a duplicate because the posting you mentioned is referring to the columns by name. My question was referring to the columns by position backward. As I mentioned in my original question, my code works when I referred to the columns by specific names."}], "answers": [{"comments": [{"owner": {"reputation": 291, "user_id": 5408352, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/76a6aa39763df6454516440c4b9db861?s=128&d=identicon&r=PG&f=1", "display_name": "RJL", "link": "https://stackoverflow.com/users/5408352/rjl"}, "edited": false, "score": 0, "creation_date": 1571265812, "post_id": 58422496, "comment_id": 103187371, "body": "just out of curiosity, why doesn&#39;t &#39;inplace=True&#39; work?"}, {"owner": {"reputation": 3552, "user_id": 4240413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54298e0142978d385309d265b585c818?s=128&d=identicon&r=PG&f=1", "display_name": "Davide Fiocco", "link": "https://stackoverflow.com/users/4240413/davide-fiocco"}, "reply_to_user": {"reputation": 291, "user_id": 5408352, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/76a6aa39763df6454516440c4b9db861?s=128&d=identicon&r=PG&f=1", "display_name": "RJL", "link": "https://stackoverflow.com/users/5408352/rjl"}, "edited": false, "score": 0, "creation_date": 1571266132, "post_id": 58422496, "comment_id": 103187460, "body": "I&#39;d refer you to <a href=\"https://stackoverflow.com/questions/55744015/iloc-fillna-inplace-true-vs-inplace-false\" title=\"iloc fillna inplace true vs inplace false\">stackoverflow.com/questions/55744015/&hellip;</a> and links therein! As far as I understand, that inplace is updating a copy and not the original <code>df</code>"}], "tags": [], "owner": {"reputation": 3552, "user_id": 4240413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54298e0142978d385309d265b585c818?s=128&d=identicon&r=PG&f=1", "display_name": "Davide Fiocco", "link": "https://stackoverflow.com/users/4240413/davide-fiocco"}, "is_accepted": true, "score": 1, "last_activity_date": 1571265071, "creation_date": 1571265071, "answer_id": 58422496, "question_id": 58422361, "link": "https://stackoverflow.com/questions/58422361/how-to-apply-fillna-to-last-n-columns-of-a-pandas-dataframe/58422496#58422496", "title": "How to apply fillna to last N columns of a pandas dataframe?", "body": "<p>A recipe that should work here is</p>\n\n<pre><code>df.iloc[:, -x:] = df.iloc[:, -x:].fillna(value=0)\n</code></pre>\n\n<p>A reproducible example here is</p>\n\n<pre><code>import pandas as pd\ndf = pd.DataFrame({'col1':range(10),\n                   'col2':range(1, 11), \n                   'col3':range(2, 12),\n                   'col4':range(3, 13),\n                   'col5':range(4, 14)})\n\n# pepper with NaNs\ndf.iloc[8, 2] = None\ndf.iloc[8, 3] = None\ndf.iloc[8, 4] = None\n\n# apply fillna change to last 2 cols\nx = 2\ndf.iloc[:, -x:] = df.iloc[:, -x:].fillna(value=0)\n\nprint(df)\n</code></pre>\n"}], "owner": {"reputation": 291, "user_id": 5408352, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/76a6aa39763df6454516440c4b9db861?s=128&d=identicon&r=PG&f=1", "display_name": "RJL", "link": "https://stackoverflow.com/users/5408352/rjl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "accepted_answer_id": 58422496, "answer_count": 1, "score": 0, "last_activity_date": 1605985300, "creation_date": 1571264174, "last_edit_date": 1605985300, "question_id": 58422361, "link": "https://stackoverflow.com/questions/58422361/how-to-apply-fillna-to-last-n-columns-of-a-pandas-dataframe", "title": "How to apply fillna to last N columns of a pandas dataframe?", "body": "<p>I have a data frame with many columns. I would like to fill the nan's with 0's for the last x number of columns. I used the following code but it doesn't seem to work.</p>\n\n<pre><code>df.iloc[:, -10:-1].fillna(value=0, inplace=True)\n</code></pre>\n\n<p>What am I doing wrong? when I specifically refer to a column by name:</p>\n\n<pre><code>df['column_a'].fillna(value=0, inplace=True)\n</code></pre>\n\n<p>it works, but I'd rather not do it one column at a time.</p>\n"}, {"tags": ["python", "loops", "parameters", "list-comprehension"], "comments": [{"owner": {"reputation": 19246, "user_id": 494134, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/3XHKr.png?s=128&g=1", "display_name": "John Gordon", "link": "https://stackoverflow.com/users/494134/john-gordon"}, "edited": false, "score": 0, "creation_date": 1571264330, "post_id": 58422344, "comment_id": 103186999, "body": "The only thing <code>accum2()</code> does is add up the total and return it.  Why would you expect it to also print the larger items, when it clearly has no code to do that work?"}, {"owner": {"reputation": 85, "user_id": 12211700, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAEJjbGEbBJ3VEedN_J38lCTkcTEuADcYJkPikE=k-s128", "display_name": "snk", "link": "https://stackoverflow.com/users/12211700/snk"}, "reply_to_user": {"reputation": 19246, "user_id": 494134, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/3XHKr.png?s=128&g=1", "display_name": "John Gordon", "link": "https://stackoverflow.com/users/494134/john-gordon"}, "edited": false, "score": 0, "creation_date": 1571264488, "post_id": 58422344, "comment_id": 103187046, "body": "Sorry should&#39;ve been more clear with what I meant to say. I know that the code is only able to add up the total, I need help getting started with the rest of the code."}, {"owner": {"reputation": 19246, "user_id": 494134, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/3XHKr.png?s=128&g=1", "display_name": "John Gordon", "link": "https://stackoverflow.com/users/494134/john-gordon"}, "edited": false, "score": 0, "creation_date": 1571264588, "post_id": 58422344, "comment_id": 103187077, "body": "Break the problem down into steps.  The first step is to calculate the average of the sequence.  You already have the total sum of the sequence, so you&#39;re halfway there -- you also need the number of items in the sequence.  Do you know how to get that?"}, {"owner": {"reputation": 85, "user_id": 12211700, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAEJjbGEbBJ3VEedN_J38lCTkcTEuADcYJkPikE=k-s128", "display_name": "snk", "link": "https://stackoverflow.com/users/12211700/snk"}, "reply_to_user": {"reputation": 19246, "user_id": 494134, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/3XHKr.png?s=128&g=1", "display_name": "John Gordon", "link": "https://stackoverflow.com/users/494134/john-gordon"}, "edited": false, "score": 0, "creation_date": 1571264772, "post_id": 58422344, "comment_id": 103187114, "body": "I know that the count() method can count how many elements are in the list, but I&#39;m not sure how to plug it into the existing code to divide it with the total."}], "answers": [{"tags": [], "owner": {"reputation": 1219, "user_id": 11547576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8YD74.jpg?s=128&g=1", "display_name": "neutrino_logic", "link": "https://stackoverflow.com/users/11547576/neutrino-logic"}, "is_accepted": false, "score": 0, "last_activity_date": 1571264660, "creation_date": 1571264660, "answer_id": 58422432, "question_id": 58422344, "link": "https://stackoverflow.com/questions/58422344/a-function-that-calculates-the-average-of-a-list-and-returns-the-elements-that-a/58422432#58422432", "title": "A function that calculates the average of a list and returns the elements that are greater than the mathematical average of the entire list", "body": "<p>The simplest way to get the average value of a list of numeric values is to use the methods:</p>\n\n<pre><code>average = sum(seq) / len(seq)\n</code></pre>\n\n<p>From there just use a conditional statement (you might have to sort the list first, if it is unsorted). From there you should be able to build a new list using the built in list methods.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 12207833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e15cb9ab532d3b0c32a5b73a1f14f91?s=128&d=identicon&r=PG&f=1", "display_name": "Turdle", "link": "https://stackoverflow.com/users/12207833/turdle"}, "is_accepted": false, "score": 0, "last_activity_date": 1571264988, "creation_date": 1571264988, "answer_id": 58422485, "question_id": 58422344, "link": "https://stackoverflow.com/questions/58422344/a-function-that-calculates-the-average-of-a-list-and-returns-the-elements-that-a/58422485#58422485", "title": "A function that calculates the average of a list and returns the elements that are greater than the mathematical average of the entire list", "body": "<p>heres some simple code which should work. \nI have added comments. </p>\n\n<pre><code>    originallist = [1,2,3,4,5,6] #This is your original list\n    outputlist = [] #This is the list which you can add correct values to\n\n    x = sum(originallist) / len(originallist) #This effectively finds you the average\n\n    for item in originallist: #Checks which items are greater than average\n        if item &gt; x:\n            outputlist.append(item) #If greater, add to the final list\n\n\n    print(outputlist)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 3308179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/671dc58c7e1fc00274070bf13edd18be?s=128&d=identicon&r=PG", "display_name": "Boyana Norris", "link": "https://stackoverflow.com/users/3308179/boyana-norris"}, "is_accepted": false, "score": 0, "last_activity_date": 1571265530, "creation_date": 1571265530, "answer_id": 58422566, "question_id": 58422344, "link": "https://stackoverflow.com/questions/58422344/a-function-that-calculates-the-average-of-a-list-and-returns-the-elements-that-a/58422566#58422566", "title": "A function that calculates the average of a list and returns the elements that are greater than the mathematical average of the entire list", "body": "<p>There are many correct ways to do this, one of which is shown below (Python 3). </p>\n\n<pre><code>lst = [1,2,3,4,5,6]\navg = sum(lst)/len(lst)\nres = list(filter(lambda x: x &gt; avg, lst))\nprint(res)\n</code></pre>\n\n<p>will produce\n    [4,5,6].</p>\n\n<p>I prefer this approach because it's less verbose than loops and also can be more easily translated to a framework like Pandas or an eventual parallel implementation if such a need arises in the future (e.g., using Spark).</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 14250122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GjvUbktdgrapGvjBrE2TDw8b_cFGjQq9HVzaYid=k-s128", "display_name": "Retro", "link": "https://stackoverflow.com/users/14250122/retro"}, "is_accepted": false, "score": 0, "last_activity_date": 1599830290, "creation_date": 1599830290, "answer_id": 63847894, "question_id": 58422344, "link": "https://stackoverflow.com/questions/58422344/a-function-that-calculates-the-average-of-a-list-and-returns-the-elements-that-a/63847894#63847894", "title": "A function that calculates the average of a list and returns the elements that are greater than the mathematical average of the entire list", "body": "<p>This is the extended version of your work:</p>\n<pre><code>def accum2(seq):\n total = 0\n\n for x in seq:\n  total += x\n\n L=[]\n\n for x in seq:\n   if x&gt;total/len(seq):\n      L.append(x)\n\n return L\n\n\nprint (accum2([1,2,3,4,5,6]))\n</code></pre>\n<p>But you could simply the previous one in this code:</p>\n<pre><code>    def accum2(seq):\n\n      return [x for x in seq if x&gt;(sum(y for y in seq)/len(seq))]\n\n    print (accum2([1,2,3,4,5,6]))\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 12211700, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAEJjbGEbBJ3VEedN_J38lCTkcTEuADcYJkPikE=k-s128", "display_name": "snk", "link": "https://stackoverflow.com/users/12211700/snk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 894, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1599830290, "creation_date": 1571264079, "last_edit_date": 1571264238, "question_id": 58422344, "link": "https://stackoverflow.com/questions/58422344/a-function-that-calculates-the-average-of-a-list-and-returns-the-elements-that-a", "title": "A function that calculates the average of a list and returns the elements that are greater than the mathematical average of the entire list", "body": "<p>I'm trying to make a function that would calculate the average of a given list then returns all the elements within that list which are greater than the mathematical average of that list. Example:\n if the given list is [1,2,3,4,5,6], the average would be 3.5. So the function should print out the numbers (4,5,6).</p>\n\n<p>I've gotten as far as adding all the numbers up within the list but no matter what I do, I can't figure out how to get the average or get it to print out the numbers that are greater than the mathematical average.</p>\n\n<p>This is what i have so far to add all the elements of any given list:</p>\n\n<pre><code>def accum2(seq):\n\n\n  total = 0\n\n  for x in seq:\n    total += x\n\n\n\n  return total\n\n\nprint (accum2([1,2,3,4,5,6]))\n</code></pre>\n\n<p>The expected result of print (accum2([1,2,3,4,5,6])) should be (4,5,6) but so far I just get an answer where it just adds up all the number in the given list.</p>\n\n<p>Any help is greatly appreciated and thank you in advance.</p>\n"}, {"tags": ["python", "ftp", "travis-ci", "mkdocs"], "answers": [{"tags": [], "owner": {"reputation": 3002, "user_id": 5508719, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh6.googleusercontent.com/-qc0j-8go0Y4/AAAAAAAAAAI/AAAAAAAAXak/yxGNYUSCsFY/photo.jpg?sz=128", "display_name": "Julian Schmuckli", "link": "https://stackoverflow.com/users/5508719/julian-schmuckli"}, "is_accepted": true, "score": 0, "last_activity_date": 1571381330, "last_edit_date": 1571381330, "creation_date": 1571345493, "answer_id": 58440570, "question_id": 58422338, "link": "https://stackoverflow.com/questions/58422338/travis-ci-only-uploads-empty-files-from-the-build-script/58440570#58440570", "title": "Travis CI only uploads empty files from the build script", "body": "<p>I have found now something interesting on the <a href=\"https://blog.travis-ci.com/2018-07-23-the-tale-of-ftp-at-travis-ci\" rel=\"nofollow noreferrer\">Travis CI Blog</a>. They are describing, that the FTP protocol is no longer supported on a normal Travis CI environment. The fact that it uses different NATs on the deployment, makes the FTP server unsure about the requests and it will block the content requests. </p>\n\n<p><strong>Solution</strong></p>\n\n<p>Therefore you have to use SFTP or a VPN connection to your FTP server in order to deploy the files on Travis CI. But there are also a lot of other CI/CD solutions. I personally use now Github Actions, which works very well. There is even an <a href=\"https://github.com/SamKirkland/FTP-Deploy-Action\" rel=\"nofollow noreferrer\">FTP Upload</a> module for that.</p>\n\n<p>This might be the reason why it does not upload the files because it writes it somewhere where the FTP server already has blocked the request. </p>\n"}], "owner": {"reputation": 3002, "user_id": 5508719, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh6.googleusercontent.com/-qc0j-8go0Y4/AAAAAAAAAAI/AAAAAAAAXak/yxGNYUSCsFY/photo.jpg?sz=128", "display_name": "Julian Schmuckli", "link": "https://stackoverflow.com/users/5508719/julian-schmuckli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 58440570, "answer_count": 1, "score": 0, "last_activity_date": 1571381330, "creation_date": 1571264031, "question_id": 58422338, "link": "https://stackoverflow.com/questions/58422338/travis-ci-only-uploads-empty-files-from-the-build-script", "title": "Travis CI only uploads empty files from the build script", "body": "<p>I'm currently trying to set up a documentation project on Travis CI. The build script uses the mkdocs library to generate markdown files to HTML files. I've tried now many hours to automate the deploy process with Travis CI. It should generate the files directly on Travis CI and upload it then to an FTP server.</p>\n\n<p><strong>What I've tried</strong></p>\n\n<p>So I had committed this .travis.yml file to my Github repo.</p>\n\n<pre><code>language: python\npython: \n  - \"2.7\"\nenv:\n  global:\n    #FTP_USERNAME\n    - secure: \"N9knL6LsuiZ.....\"\n    #FTP_PASSWORD\n    - secure: \"NrRpwCeay7Y0s.....\"\ninstall: \n  - pip install mkdocs\n  - mkdocs --version\nscript:\n  - mkdocs build\nafter_success:\n  - find documentation -type f -exec curl -u \"${FTP_USERNAME}:${FTP_PASSWORD}\" --verbose --progress-bar --ftp-create-dirs --max-time 30 -T {} ftp://my.ftp-server.com/{} \\;\n</code></pre>\n\n<p>The mkdocs build script does output the generated files in the root folder \"documentation\". Actually this code works unless the directory on the FTP server does not exist. </p>\n\n<p><strong>What does not work</strong></p>\n\n<p>I have tried the same code locally (just ran the after_success command) and there it uploads the files correctly with content. When Travis-CI now starts uploading the files to my FTP server, then it begins with the transfer but does not end it until the timeout exception will be thrown. When I check the files on the server, then it only has created empty files.</p>\n\n<p>Can maybe someone help me why this problem occurs?</p>\n"}, {"tags": ["python", "python-2.7", "compression", "tar", "stringio"], "answers": [{"tags": [], "owner": {"reputation": 489, "user_id": 7507925, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10212060276686137/picture?type=large", "display_name": "Cdhippen", "link": "https://stackoverflow.com/users/7507925/cdhippen"}, "is_accepted": false, "score": 0, "last_activity_date": 1571277175, "creation_date": 1571277175, "answer_id": 58423821, "question_id": 58422334, "link": "https://stackoverflow.com/questions/58422334/tarfile-extractall-processes-fine-but-doesnt-create-any-new-files-or-director/58423821#58423821", "title": "TarFile.extractall() processes fine but doesn&#39;t create any new files or directories", "body": "<p>Answered here : <a href=\"https://www.reddit.com/r/learnpython/comments/dix37i/tarfileextractall_processes_fine_but_doesnt/f3zq1j4?utm_source=share&amp;utm_medium=web2x\" rel=\"nofollow noreferrer\">https://www.reddit.com/r/learnpython/comments/dix37i/tarfileextractall_processes_fine_but_doesnt/f3zq1j4?utm_source=share&amp;utm_medium=web2x</a></p>\n\n<blockquote>\n  <p>I found another example that included a call to BytesIO.seek(0) to\n  reset the file pointer to the start:</p>\n  \n  <p>If fileobj is specified, it is used as an alternative to a file object\n  opened in binary mode for name. It is supposed to be at position 0.</p>\n  \n  <p><a href=\"https://docs.python.org/3/library/tarfile.html\" rel=\"nofollow noreferrer\">https://docs.python.org/3/library/tarfile.html</a></p>\n  \n  <p>So you should add a call to zipData.seek(0) before calling\n  tarfile.open.</p>\n</blockquote>\n"}], "owner": {"reputation": 489, "user_id": 7507925, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10212060276686137/picture?type=large", "display_name": "Cdhippen", "link": "https://stackoverflow.com/users/7507925/cdhippen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 528, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571277175, "creation_date": 1571263995, "last_edit_date": 1571265131, "question_id": 58422334, "link": "https://stackoverflow.com/questions/58422334/tarfile-extractall-processes-fine-but-doesnt-create-any-new-files-or-director", "title": "TarFile.extractall() processes fine but doesn&#39;t create any new files or directories", "body": "<p>Version: Python 2.7 \nOS: MacOS Mojave \nIDE: Pycharm Community 2019.2</p>\n\n<p>I'm having trouble downloading tar.gz files from <code>pypi.org/project</code> and unzipping them. The use case for this is that we can't use any actual package management, so we have to manually put packages where we need them in the local folders. My solution to this is to read a requirements file and pull the tar.gz and .zip files for the given versions and then write to local files.</p>\n\n<p>I've got it working for zip files, and it works exactly how I want it to. Zip files are handled by the 'elif' statement, tar files are handled by the 'if' statement. For some reason, for the tar file links I pass in, no directories are created, no files are extracted.</p>\n\n<p>I did a test by putting the path to my local copy of a tar file directly in this line <code>tarData = tarfile.open(fileobj=zipData, mode='r:*')</code> instead of <code>zipData</code> and it worked, so I think it has something to do with the format the file is being either downloaded in or handled in StringIO, but I'm not getting any exceptions so I have no way to narrow down what the issue could be.</p>\n\n<p>The below is the slice of code I'm using to unzip these files.</p>\n\n<pre><code>import os\nimport bs4 as bs\nimport urllib2\nimport re\nfrom StringIO import StringIO\nimport zipfile\nimport tarfile\nimport requests\n\n\ndef install_packages_locally(compressed_link, directory):\n    file_name = '_'.join(compressed_link.split('/')[-1].split('-')[:-1])\n    file_ext = compressed_link.split('-')[-1]\n    response = requests.get(compressed_link, stream=True)\n\n    if file_name in os.listdir(directory):\n        print('Skipping %s' % file_name)\n        return True\n\n    zipData = StringIO()\n\n    if file_ext.endswith('.tar.gz'):\n        zipData.write(response.raw.read())\n        print('writing %s to %s' % (file_name, directory))\n        tarData = tarfile.open(fileobj=zipData, mode='r:*')\n        tarData.extractall(path=directory)\n        tarData.close()\n        zipData.close()\n        return True\n\n    elif file_ext.endswith('.zip'):\n        zipData.write(response.content)\n        print('writing %s to %s' % (file_name, directory))\n        unzipData = zipfile.ZipFile(zipData)\n        unzipData.extractall(path=directory)\n        unzipData.close()\n        zipData.close()\n        return True\n</code></pre>\n"}, {"tags": ["python", "tensorflow", "out-of-memory"], "comments": [{"owner": {"reputation": 6608, "user_id": 867889, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/766cbf5cffe9872f58f00c994cd34a3f?s=128&d=identicon&r=PG", "display_name": "y.selivonchyk", "link": "https://stackoverflow.com/users/867889/y-selivonchyk"}, "edited": false, "score": 0, "creation_date": 1571281045, "post_id": 58422226, "comment_id": 103190435, "body": "Did you try setting higher value for &#39;gpu_usage&#39; which is used as per_process_gpu_memory_fraction? Regarding randomness, BFC although being quite efficient can have some flactuation of memory usage inbetween runs due to different mapping of data into buckets. Another reason might be variable image size if your model allows that"}, {"owner": {"reputation": 7481, "user_id": 2666270, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8b08ff3f628c4d11f81fe113c6eda6b9?s=128&d=identicon&r=PG", "display_name": "pceccon", "link": "https://stackoverflow.com/users/2666270/pceccon"}, "reply_to_user": {"reputation": 6608, "user_id": 867889, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/766cbf5cffe9872f58f00c994cd34a3f?s=128&d=identicon&r=PG", "display_name": "y.selivonchyk", "link": "https://stackoverflow.com/users/867889/y-selivonchyk"}, "edited": false, "score": 0, "creation_date": 1571689940, "post_id": 58422226, "comment_id": 103317332, "body": "Yes, I tried, @y.selivonchyk, but it seemed to be useless. The images are captured by a camera, so they all have the same size. Thanks for the tips."}], "owner": {"reputation": 7481, "user_id": 2666270, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8b08ff3f628c4d11f81fe113c6eda6b9?s=128&d=identicon&r=PG", "display_name": "pceccon", "link": "https://stackoverflow.com/users/2666270/pceccon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 661, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1571263249, "creation_date": 1571263249, "question_id": 58422226, "link": "https://stackoverflow.com/questions/58422226/allocator-gpu-0-bfc-ran-out-of-memory-trying-to-allocate", "title": "Allocator (GPU_0_bfc) ran out of memory trying to allocate", "body": "<p>I know this is recurrent problem and question, and I'm aware of some solutions, specially if this problem occurs during training (reducing batch size, setting gpu option <code>allow_grouth=True</code>), but I'm facing this problem when using the <em>already trained</em> model to predict an outcome. \nSo, I was able to train the model (a Faster RCNN from the <a href=\"https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/detection_model_zoo.md\" rel=\"nofollow noreferrer\">TensorFlow Object Detection Model Zoo</a> with a batch size of 1 -- otherwise I would receive OOM error during training). </p>\n\n<p>To apply the trained model, I load it with the following code:</p>\n\n<pre><code>class Model:\n\n    def __init__(self, conf):\n        self.threshold = conf[\"threshold\"]\n        self.gpu = conf['gpu']\n        self.scope = conf['scope']\n        self.frozen_inference_graph = conf['frozen_inference_graph']\n        self.detection_graph = self.load_model(self.gpu, self.scope, self.frozen_inference_graph)\n\n        gpu_options = tf.GPUOptions(per_process_gpu_memory_fraction=conf['gpu_usage'], allocator_type='BFC')\n        self.session = tf.Session(graph=self.detection_graph,\n                                  config=tf.ConfigProto(gpu_options=gpu_options,\n                                                        log_device_placement=True,\n                                                        allow_soft_placement=True)\n\n    def load_model(gpu, scope, frozen_inference_graph):\n        detection_graph = tf.Graph()\n        with detection_graph.device(gpu):\n            with detection_graph.as_default():\n                od_graph_def = tf.GraphDef()\n\n                with tf.gfile.GFile(frozen_inference_graph, 'rb') as fid:\n                    serialized_graph = fid.read()\n                    od_graph_def.ParseFromString(serialized_graph)\n                    tf.import_graph_def(od_graph_def, name=scope)\n                    return detection_graph\n\n</code></pre>\n\n<p>Where my conf file looks like:</p>\n\n<pre><code>{\n    \"frozen_inference_graph\": \"/config/plate_detector/faster_rcnn/frozen_inference_graph.pb\",\n    \"gpu\": \"/gpu:0\",\n    \"gpu_usage\": 0.05,\n    \"threshold\": 0.5,\n    \"scope\": \"testing\"\n  }\n</code></pre>\n\n<p>To apply the model, the class <code>Model</code> has the following method:</p>\n\n<pre><code>    def detect(self, image):\n        image_tensor = self.detection_graph.get_tensor_by_name(self.scope + \"/image_tensor:0\")\n        detection_boxes = self.detection_graph.get_tensor_by_name(self.scope + \"/detection_boxes:0\")\n        detection_scores = self.detection_graph.get_tensor_by_name(self.scope + \"/detection_scores:0\")\n        detection_classes = self.detection_graph.get_tensor_by_name(self.scope + \"/detection_classes:0\")\n        num_detections = self.detection_graph.get_tensor_by_name(self.scope + \"/num_detections:0\")\n\n        height, width = image.shape[:2]\n        image_np = image.copy()\n        # Expands dimensions since the model expects images to have shape: [1, None, None, 3]\n        image_np_expanded = np.expand_dims(image_np, axis=0)\n        # Actual detection\n        boxes, scores, classes, num = self.session.run(\n            [detection_boxes, detection_scores, detection_classes, num_detections],\n            feed_dict={image_tensor: image_np_expanded}\n        )\n\n        output_dict = dict()\n        output_dict[\"num_dets\"] = int(num[0])\n        output_dict[\"classes\"] = classes[0].astype(np.uint8)\n        output_dict[\"bboxes\"] = boxes[0]\n        output_dict[\"confidences\"] = scores[0]\n\n        detections = []\n        for i, b in enumerate(output_dict[\"bboxes\"]):\n            if output_dict[\"confidences\"][i] &gt;= self.threshold:\n                x1 = int(output_dict[\"bboxes\"][i][1] * width)\n                y1 = int(output_dict[\"bboxes\"][i][0] * height)\n                x2 = int(output_dict[\"bboxes\"][i][3] * width)\n                y2 = int(output_dict[\"bboxes\"][i][2] * height)\n                label = self.class_mapping.get(output_dict[\"classes\"][i].astype(str))\n                confidence = output_dict[\"confidences\"][i]\n                detections.append(detection.Detection([x1, y1, x2, y2, confidence, label]))\n\n        # Sort based on x1 to return the right order\n        detections = sorted(detections, key=lambda x: x.x1)\n\n        return detections\n</code></pre>\n\n<p>In my <code>main.py</code> file, I simply do (pseudo code):</p>\n\n<pre><code>model = Model(*path to config*)\nimages = fetch_images()\nfor image in images:\n    detections = model.detect(image)\n    // processing over the detections\n</code></pre>\n\n<p>However, sometimes, in the middle of the process, I get a message such as:</p>\n\n<blockquote>\n  <p>2019-10-16 21:42:32.394227: W tensorflow/core/common_runtime/bfc_allocator.cc:314] Allocator (GPU_0_bfc) ran out of memory trying to allocate 76.56MiB (rounded to 80281600).  Current allocation summary follows.</p>\n</blockquote>\n\n<p><strong>This doesn't happens all the time, it seems to happen at random, which I don't understand.</strong></p>\n\n<p>I've tried using <code>allow_growth=True</code>, which causes the error to happens when I load the model, and also <code>allocator_type='BFC'</code>, which didn't help (OOM still happens randomly).</p>\n\n<p><code>watch -n 1 nvidia-smi</code> looks like this:</p>\n\n<pre><code>+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 435.21       Driver Version: 435.21       CUDA Version: 10.1     |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|===============================+======================+======================|\n|   0  Quadro RTX 4000     Off  | 00000000:01:00.0  On |                  N/A |\n| 30%   40C    P0    96W / 125W |   1589MiB /  7979MiB |     83%      Default |\n+-------------------------------+----------------------+----------------------+\n</code></pre>\n"}, {"tags": ["python", "pandas"], "comments": [{"owner": {"reputation": 4102, "user_id": 10366273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1c2BX.jpg?s=128&g=1", "display_name": "MyNameIsCaleb", "link": "https://stackoverflow.com/users/10366273/mynameiscaleb"}, "edited": false, "score": 1, "creation_date": 1571263339, "post_id": 58422224, "comment_id": 103186711, "body": "Providing your data as code would be more helpful than the images you have given and will help you get an answer to your question more quickly."}, {"owner": {"reputation": 41, "user_id": 12229134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e03c707a332cbacdb6a30a33a6d1c55?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Jo", "link": "https://stackoverflow.com/users/12229134/jimmy-jo"}, "reply_to_user": {"reputation": 4102, "user_id": 10366273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1c2BX.jpg?s=128&g=1", "display_name": "MyNameIsCaleb", "link": "https://stackoverflow.com/users/10366273/mynameiscaleb"}, "edited": false, "score": 0, "creation_date": 1571263811, "post_id": 58422224, "comment_id": 103186846, "body": "Sorry this is my first time on this site.  Did I do it correctly?"}, {"owner": {"reputation": 4102, "user_id": 10366273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1c2BX.jpg?s=128&g=1", "display_name": "MyNameIsCaleb", "link": "https://stackoverflow.com/users/10366273/mynameiscaleb"}, "edited": false, "score": 0, "creation_date": 1571263850, "post_id": 58422224, "comment_id": 103186858, "body": "Looks much better, thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 12229134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e03c707a332cbacdb6a30a33a6d1c55?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Jo", "link": "https://stackoverflow.com/users/12229134/jimmy-jo"}, "edited": false, "score": 0, "creation_date": 1571321279, "post_id": 58422409, "comment_id": 103209507, "body": "Is there a way to reverse the process?  Combining the &#39;Score1&#39; and &#39;Score2&#39; back into the Category Column and then setting the Value elements back?"}, {"owner": {"reputation": 1435, "user_id": 3866678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7yZyO.png?s=128&g=1", "display_name": "Michael Gardner", "link": "https://stackoverflow.com/users/3866678/michael-gardner"}, "reply_to_user": {"reputation": 41, "user_id": 12229134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e03c707a332cbacdb6a30a33a6d1c55?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Jo", "link": "https://stackoverflow.com/users/12229134/jimmy-jo"}, "edited": false, "score": 1, "creation_date": 1571321458, "post_id": 58422409, "comment_id": 103209616, "body": "@NathanLam <code>df.melt(id_vars=[&#39;Name&#39;,&#39;Month&#39;], var_name=&#39;Category&#39;, value_name=&#39;Value&#39;)</code>"}], "tags": [], "owner": {"reputation": 1435, "user_id": 3866678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7yZyO.png?s=128&g=1", "display_name": "Michael Gardner", "link": "https://stackoverflow.com/users/3866678/michael-gardner"}, "is_accepted": false, "score": 1, "last_activity_date": 1571264500, "creation_date": 1571264500, "answer_id": 58422409, "question_id": 58422224, "link": "https://stackoverflow.com/questions/58422224/python-splitting-a-column-into-two-columns-based-off-its-value/58422409#58422409", "title": "Python: Splitting a column into two Columns based off its value", "body": "<p>You can use <a href=\"https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html\" rel=\"nofollow noreferrer\">Pivot Table</a></p>\n\n<pre><code>df.pivot_table(index=['Name', 'Month'],values='Value', columns='Category').rename_axis(None, axis=1).reset_index()\n\nOut[1]: \n    Name Month  Score1  Score2\n0   Jack  Jan.     1.0     2.0\n1  Sarah  Feb.     3.0     4.0\n2   Zack  Feb.     5.0     NaN\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17765, "user_id": 9375102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8yBw3.jpg?s=128&g=1", "display_name": "Umar.H", "link": "https://stackoverflow.com/users/9375102/umar-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1571264956, "creation_date": 1571264956, "answer_id": 58422478, "question_id": 58422224, "link": "https://stackoverflow.com/questions/58422224/python-splitting-a-column-into-two-columns-based-off-its-value/58422478#58422478", "title": "Python: Splitting a column into two Columns based off its value", "body": "<p>one way is with <code>groupby</code> and <code>unstack</code></p>\n\n<pre><code>new_df = (df.groupby(['Name','Month','Category'])\n ['Value'].first().unstack().reset_index())\nprint(new_df)\nCategory   Name Month  Score1  Score2\n0          Jack  Jan.     1.0     2.0\n1         Sarah  Feb.     3.0     4.0\n2          Zack  Feb.     5.0     NaN\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 12229134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e03c707a332cbacdb6a30a33a6d1c55?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Jo", "link": "https://stackoverflow.com/users/12229134/jimmy-jo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1571281429, "creation_date": 1571263238, "last_edit_date": 1571263783, "question_id": 58422224, "link": "https://stackoverflow.com/questions/58422224/python-splitting-a-column-into-two-columns-based-off-its-value", "title": "Python: Splitting a column into two Columns based off its value", "body": "<p>I am trying to get from My Starting DataFrame</p>\n\n<p><img src=\"https://i.stack.imgur.com/dTzen.png\" alt=\"My Starting DataFrame\"></p>\n\n<p>to My Desired Results</p>\n\n<p><img src=\"https://i.stack.imgur.com/eR98H.png\" alt=\"My Desired Results\">. </p>\n\n<p>I am trying to do a groupby on two columns (Name, Month) and I have a column (Category) that has either the value 'Score1' or 'Score2'.  I want to create two columns with the name of values from the Category column and set their values to a value determined from another column.</p>\n\n<pre><code>pd.crosstab([df.Name, df.Month], df.Category)\n</code></pre>\n\n<p>is the closest I've got to create the desire data frame however I can't figure out how to get the values from my \"Value\" column to populate the dataframe. </p>\n\n<p>Results from crosstab</p>\n\n<p><img src=\"https://i.stack.imgur.com/Zu9e4.png\" alt=\"Results from crosstab\"></p>\n\n<p>The Dataframe in code form</p>\n\n<pre><code>df = pd.DataFrame(columns=['Name', 'Month', 'Category', 'Value'])\ndf['Name'] = ['Jack','Jack','Sarah','Sarah','Zack']\ndf['Month'] = ['Jan.','Jan.','Feb.','Feb.','Feb.']\ndf['Category'] = ['Score1','Score2','Score1','Score2','Score1']\ndf['Value'] = [1,2,3,4,5]\n</code></pre>\n\n<p>Thanks!  </p>\n"}, {"tags": ["python", "xml", "elementtree"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 10438587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38825a8fdba82893152aae3097b1ab2e?s=128&d=identicon&r=PG&f=1", "display_name": "zer0fool", "link": "https://stackoverflow.com/users/10438587/zer0fool"}, "edited": false, "score": 0, "creation_date": 1571323498, "post_id": 58422726, "comment_id": 103210813, "body": "Using xml.minidom&#39;s parseString() solved my problem of not being able to see the entire XML while debugging, but it&#39;s still weird that ET doesn&#39;t show everything while debugging. I would like to know why I can easily debug minidom, but not ET."}], "tags": [], "owner": {"reputation": 370, "user_id": 5703092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0YuUi.jpg?s=128&g=1", "display_name": "the_good_pony", "link": "https://stackoverflow.com/users/5703092/the-good-pony"}, "is_accepted": false, "score": 0, "last_activity_date": 1571266852, "creation_date": 1571266852, "answer_id": 58422726, "question_id": 58422211, "link": "https://stackoverflow.com/questions/58422211/debugging-xml-elementtrees-in-python/58422726#58422726", "title": "Debugging xml ElementTrees in Python", "body": "<p>It sounds like you want to be able to see the available elements in the XML document you want to parse.</p>\n\n<p>This will list <strong>all</strong> the child tags of the root element </p>\n\n<pre><code>all_children = list(root_element.iter())\n</code></pre>\n\n<p>This will produce</p>\n\n<pre><code>[&lt;Element 'Foo' at 0x11b315908&gt;, &lt;Element 'Bar' at 0x11b315c28&gt;]\n</code></pre>\n\n<p>This output, however, doesn't respect the 'shape' of the XML. </p>\n\n<p>When I want to parse XML, I find it easier to use ElementTree but my first experiences parsing XML was with BeautifulSoup. I still like the prettify() function.</p>\n\n<p>This code, </p>\n\n<pre><code>pretty = \"\"\nsoup = BeautifulSoup(xml_str, 'html.parser') \nfor value in soup.find_all(\"foo\"):\n    pretty += value.prettify()\n</code></pre>\n\n<p>produces this output</p>\n\n<pre><code>print(pretty)\n\n&lt;foo&gt;\n &lt;bar&gt;\n  burp\n &lt;/bar&gt;\n&lt;/foo&gt;\n</code></pre>\n\n<p>You can replace the find_all() with specific elements you might be looking for. </p>\n"}], "owner": {"reputation": 61, "user_id": 10438587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38825a8fdba82893152aae3097b1ab2e?s=128&d=identicon&r=PG&f=1", "display_name": "zer0fool", "link": "https://stackoverflow.com/users/10438587/zer0fool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 287, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1571266852, "creation_date": 1571263126, "question_id": 58422211, "link": "https://stackoverflow.com/questions/58422211/debugging-xml-elementtrees-in-python", "title": "Debugging xml ElementTrees in Python", "body": "<p>I have an XML string</p>\n\n<pre><code>xml_str = '&lt;Foo&gt;&lt;Bar&gt;burp&lt;/Bar&gt;&lt;/Foo&gt;'\n</code></pre>\n\n<p>I'm parsing it with xml etree</p>\n\n<pre><code>import xml.etree.ElementTree as ET\nroot_element = ET.fromstring(xml_str)\n</code></pre>\n\n<p>This creates an Element object(root_element) with a tag, tail, text, and attrib values within it. I can see all of them when debugging. However, I can't see any children Elements while debugging. I know the children are there because I can access them in a for loop.</p>\n\n<pre><code>for child in root_element:\n    *break point here*\n</code></pre>\n\n<p>Below is a screenshot of what I'm seeing</p>\n\n<p><a href=\"https://i.stack.imgur.com/UYcIF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UYcIF.png\" alt=\"debugger\"></a></p>\n\n<p>Is there a way to see all elements at once while debugging? And is this issue because the XML parser is a JIT parser or something? </p>\n"}, {"tags": ["python", "list", "numbers", "range", "combinations"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10560496, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J22Z3.jpg?s=128&g=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/10560496/pete"}, "edited": false, "score": 0, "creation_date": 1571265400, "post_id": 58422247, "comment_id": 103187267, "body": "This is perfect!!! Thank you so much! It&#39;s so amazing to spend all day on something and have it complete the task in 0.4388279914855957  seconds, hahaha Thank you so much!"}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "reply_to_user": {"reputation": 17, "user_id": 10560496, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J22Z3.jpg?s=128&g=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/10560496/pete"}, "edited": false, "score": 0, "creation_date": 1571265494, "post_id": 58422247, "comment_id": 103187289, "body": "You&#39;re welcome.  Be <i>careful</i> with the list sizes.  If you have very long lists, look up the <code>chain</code> method to link the <code>combinations</code> and <code>product</code> generators."}, {"owner": {"reputation": 17, "user_id": 10560496, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J22Z3.jpg?s=128&g=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/10560496/pete"}, "edited": false, "score": 0, "creation_date": 1571278075, "post_id": 58422247, "comment_id": 103189892, "body": "Ok awesome! Thank you so much for the advice! I&#39;ll take a look into the chain method."}], "tags": [], "owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "is_accepted": true, "score": 0, "last_activity_date": 1571263333, "creation_date": 1571263333, "answer_id": 58422247, "question_id": 58422163, "link": "https://stackoverflow.com/questions/58422163/how-to-print-all-number-combinations-from-specific-set-of-numbers/58422247#58422247", "title": "How to print all number combinations from specific set of numbers?", "body": "<p>This is a direct substitution of operands:</p>\n\n<pre><code>from itertools import combinations, product\nlarge = [2,3,5,7,9,12,13,15,19]\nsmall = [3,7,8,10]\n\nfor range_numbers in combinations(large, 5):\n    for nums in combinations(small, 1):\n        ...\n</code></pre>\n\n<p>Perhaps better, use <code>product</code> to do this in a single loop, as Guido intended:</p>\n\n<pre><code>for combined in product( [list(combinations(large, 5)),\n                          list(combinations(small, 1))] ):\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10560496, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J22Z3.jpg?s=128&g=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/10560496/pete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 58422247, "answer_count": 1, "score": 0, "last_activity_date": 1571265790, "creation_date": 1571262890, "last_edit_date": 1571265790, "question_id": 58422163, "link": "https://stackoverflow.com/questions/58422163/how-to-print-all-number-combinations-from-specific-set-of-numbers", "title": "How to print all number combinations from specific set of numbers?", "body": "<p>I'm trying to get every number combination from a list of numbers. </p>\n\n<p>Currently I can easily get this as a range, and I get every number combination I want within a set of 5 numbers (printed in 5 separate columns). What I can't figure out how to do is how to get every number combination from a very specific list of numbers that prints this exact same format from the existing code.</p>\n\n<p>Below is what I have as the code to find the numbers within a range, and it works well:</p>\n\n<pre><code>for range_numbers in combinations(list(range(1,20)), 5): #This gives me every 5 number combination without repeating numbers.\n    for nums in combinations(list(range(1,10)), 1): #this adds every combination of this range without repeating numbers, in a single column.\n        combined = range_numbers + nums\n        file_writer.writerow(combined)\n        count += 1\n</code></pre>\n\n<p>What I want is to produce exactly the same results but from a list of specific numbers such as [2,3,5,7,9,12,13,15,19] for the 5 number combinations, and [3,7,8,10] for the 1 number combination added on.</p>\n\n<p>Any help is appreciated, I've spent the last 8hrs googling and trying to figure this one out, which feels like it should be easy but my brain is just mush now..</p>\n"}, {"tags": ["python", "tar"], "comments": [{"owner": {"reputation": 1057, "user_id": 8206522, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u8mRt.jpg?s=128&g=1", "display_name": "Kacper Floria\u0144ski", "link": "https://stackoverflow.com/users/8206522/kacper-floria%c5%84ski"}, "edited": false, "score": 0, "creation_date": 1571263865, "post_id": 58422133, "comment_id": 103186866, "body": "Why can&#39;t you just <code>tar.extractall(path=destination)</code>, where <code>tar</code> comes from <code>tarfile.open(FolderB_path)</code>"}, {"owner": {"reputation": 31, "user_id": 10214213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e6c436201ecdb31fae70a695c6d8e82?s=128&d=identicon&r=PG&f=1", "display_name": "Andy S.", "link": "https://stackoverflow.com/users/10214213/andy-s"}, "reply_to_user": {"reputation": 1057, "user_id": 8206522, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u8mRt.jpg?s=128&g=1", "display_name": "Kacper Floria\u0144ski", "link": "https://stackoverflow.com/users/8206522/kacper-floria%c5%84ski"}, "edited": false, "score": 0, "creation_date": 1571272408, "post_id": 58422133, "comment_id": 103188778, "body": "If I were the only consumer of this .tar.gz, I could certainly do this, but I&#39;m creating a .tar.gz for others to use that needs to have a specific structure."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10214213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e6c436201ecdb31fae70a695c6d8e82?s=128&d=identicon&r=PG&f=1", "display_name": "Andy S.", "link": "https://stackoverflow.com/users/10214213/andy-s"}, "edited": false, "score": 0, "creation_date": 1571272306, "post_id": 58423085, "comment_id": 103188764, "body": "Thanks for responding. The key thing is (and sorry if I did a poor job conveying this), FolderB and FileB are in the same directory level, they&#39;re both directly in C:\\FolderA. So your 1st example will extract FolderA and its contents; your 2nd example will extract FolderB and its contents; but I want FolderA&#39;s contents without FolderA appearing at all. I have tried with arcname=os.path.basename(source_dir) but FolderA always gets included."}], "tags": [], "owner": {"reputation": 370, "user_id": 5703092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0YuUi.jpg?s=128&g=1", "display_name": "the_good_pony", "link": "https://stackoverflow.com/users/5703092/the-good-pony"}, "is_accepted": false, "score": 0, "last_activity_date": 1571270205, "creation_date": 1571270205, "answer_id": 58423085, "question_id": 58422133, "link": "https://stackoverflow.com/questions/58422133/how-to-create-tar-gz-archive-in-python-tar-without-include-parent-directory/58423085#58423085", "title": "How to create tar.gz archive in Python/tar without include parent directory?", "body": "<p>I've tried to provide some examples of how changes to the source directory makes a difference to what finally gets extracted. </p>\n\n<p>As per your example, I have this folder structure </p>\n\n<p><a href=\"https://i.stack.imgur.com/BhoHm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BhoHm.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have this python to generate the tar file (lifted from <a href=\"https://stackoverflow.com/questions/2032403/how-to-create-full-compressed-tar-file-using-python\">here</a>)</p>\n\n<pre><code>import tarfile\nimport os\n\ndef make_tarfile(output_filename, source_dir):\n    with tarfile.open(output_filename, \"w:gz\") as tar:\n        tar.add(source_dir, arcname=os.path.basename(source_dir))\n</code></pre>\n\n<p>What data and structure is included in the tar file depends on what location I provide as a parameter.</p>\n\n<p>So this location parameter,</p>\n\n<pre><code>make_tarfile('folder.tar.gz','folder_A/' )\n</code></pre>\n\n<p>will generate this result when extracted</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZgJ6k.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZgJ6k.png\" alt=\"enter image description here\"></a></p>\n\n<p>If I move into folder_A and reference folder_B,</p>\n\n<pre><code>make_tarfile('folder.tar.gz','folder_A/folder_B' )\n</code></pre>\n\n<p>This is what the extract will be,  </p>\n\n<p><a href=\"https://i.stack.imgur.com/Shsod.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Shsod.png\" alt=\"enter image description here\"></a></p>\n\n<p>Notice that folder_B is the root of this extract.</p>\n\n<p>Now finally,</p>\n\n<pre><code>make_tarfile('folder.tar.gz','folder_A/folder_B/' )\n</code></pre>\n\n<p>Will extract to this </p>\n\n<p><a href=\"https://i.stack.imgur.com/Vzu1f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vzu1f.png\" alt=\"enter image description here\"></a></p>\n\n<p>Just the file is included in the extract.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 10214213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e6c436201ecdb31fae70a695c6d8e82?s=128&d=identicon&r=PG&f=1", "display_name": "Andy S.", "link": "https://stackoverflow.com/users/10214213/andy-s"}, "edited": false, "score": 0, "creation_date": 1571425745, "post_id": 58439950, "comment_id": 103250810, "body": "Hi Kacper, thanks for the reply! I was able to use 7zip CLI to achieve what I needed, but I&#39;d definitely like to find time to give your solution a try too. I posted my findings in a different question: <a href=\"https://stackoverflow.com/questions/58423574/python-created-tar-gz-file-contains-folder-how-to-remove/\" title=\"python created tar gz file contains folder how to remove\">stackoverflow.com/questions/58423574/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1057, "user_id": 8206522, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u8mRt.jpg?s=128&g=1", "display_name": "Kacper Floria\u0144ski", "link": "https://stackoverflow.com/users/8206522/kacper-floria%c5%84ski"}, "is_accepted": false, "score": 0, "last_activity_date": 1571342463, "creation_date": 1571342463, "answer_id": 58439950, "question_id": 58422133, "link": "https://stackoverflow.com/questions/58422133/how-to-create-tar-gz-archive-in-python-tar-without-include-parent-directory/58439950#58439950", "title": "How to create tar.gz archive in Python/tar without include parent directory?", "body": "<p>Here is a function to perform the task. I have had some issues extracting the tar on Windows (with <em>WinRar</em>) as it seemed to try to extract the same file twice, but I think it will work fine when extracting the archive properly.</p>\n\n<pre><code>\"\"\"\nThe directory structure I have is as follows:\n\n\u251c\u2500\u2500\u2500FolderA\n\u2502   \u2502   FileB\n\u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500FolderB\n\u2502           FileC\n\"\"\"\n\nimport tarfile\nimport os\n\n# This is where I stored FolderA on my computer\nROOT = os.path.join(os.path.dirname(__file__), \"FolderA\")\n\n\ndef make_tarfile(output_filename: str, source_dir: str) -&gt; bool:\n    \"\"\" \n    :return: True on success, False otherwise\n    \"\"\"\n\n    # This is where the path to each file and folder will be saved\n    paths_to_tar = set()\n\n    # os.walk over the root folder (\"FolderA\") - note it will never get added\n    for dirpath, dirnames, filenames in os.walk(source_dir):\n\n        # Resolve path issues, for example for Windows\n        dirpath = os.path.normpath(dirpath)\n\n        # Add each folder and path in the current directory\n        # Probably could use zip here instead of set unions but can't be bothered to try to figure it out\n        paths_to_tar = paths_to_tar.union(\n            {os.path.join(dirpath, d) for d in dirnames}).union(\n            {os.path.join(dirpath, f) for f in filenames})\n\n    try:\n        # This will create the tar file in the current directory\n        with tarfile.open(output_filename, \"w:gz\") as tar:\n\n            # Change the directory to treat all paths relatively\n            os.chdir(source_dir)\n\n            # Finally add each path using the relative path\n            for path in paths_to_tar:\n                tar.add(os.path.relpath(path, source_dir))\n            return True\n\n    except (tarfile.TarError, OSError) as e:\n        print(f\"An error occurred - {e}\")\n        return False\n\n\nif __name__ == '__main__':\n    make_tarfile(\"tarred_files.tar.gz\", ROOT)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1939, "user_id": 1495323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/562b035c4de737014bdde5447893a9ab?s=128&d=identicon&r=PG", "display_name": "driedler", "link": "https://stackoverflow.com/users/1495323/driedler"}, "is_accepted": false, "score": 0, "last_activity_date": 1611195077, "creation_date": 1611195077, "answer_id": 65820259, "question_id": 58422133, "link": "https://stackoverflow.com/questions/58422133/how-to-create-tar-gz-archive-in-python-tar-without-include-parent-directory/65820259#65820259", "title": "How to create tar.gz archive in Python/tar without include parent directory?", "body": "<p>This works for me:</p>\n<pre><code>with tarfile.open(output_filename, &quot;w:gz&quot;) as tar:\n    for fn in os.listdir(source_dir):\n        p = os.path.join(source_dir, fn)\n        tar.add(p, arcname=fn)\n</code></pre>\n<p>i.e. Just list the root of the source dir and add each entry to the archive. No need for walking the source dir as adding a directory via tar.add() is automatically recursive.</p>\n"}], "owner": {"reputation": 31, "user_id": 10214213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e6c436201ecdb31fae70a695c6d8e82?s=128&d=identicon&r=PG&f=1", "display_name": "Andy S.", "link": "https://stackoverflow.com/users/10214213/andy-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1133, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1611195077, "creation_date": 1571262650, "last_edit_date": 1572102459, "question_id": 58422133, "link": "https://stackoverflow.com/questions/58422133/how-to-create-tar-gz-archive-in-python-tar-without-include-parent-directory", "title": "How to create tar.gz archive in Python/tar without include parent directory?", "body": "<p>I have a FolderA which contains FolderB and FileB. How can I create a tar.gz archive which ONLY contains FolderB and FileB, removing the parent directory FolderA? I'm using Python and I'm running this code on a Windows machine.</p>\n\n<p>The best lead I found was: <a href=\"https://stackoverflow.com/questions/2032403/how-to-create-full-compressed-tar-file-using-python\">How to create full compressed tar file using Python?</a></p>\n\n<p>In the most upvoted answer, people discuss ways to remove the parent directory, but none of them work for me. I've tried arcname, os.walk, and running the tar command via subprocess.call ().</p>\n\n<p>I got close with os.walk, but in the code below, it still drops a \" _ \" directory in with FolderB and FileB. So, the file structure is ARCHIVE.tar.gz > ARCHIVE.tar > \"_\" directory, FolderB, FileB.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>def make_tarfile(output_filename, source_dir):\n    with tarfile.open(output_filename, \"w:gz\") as tar:\n        length = len(source_dir)\n        for root, dirs, files in os.walk(source_dir):\n            folder = root[length:]  # path without \"parent\"\n            for file in files:\n                tar.add(os.path.join(root, folder), folder)\n</code></pre>\n\n<p>I make the archive using:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>make_tarfile('ARCHIVE.tar.gz', 'C:\\FolderA')\n</code></pre>\n\n<p>Should I carry on using os.walk, or is there any other way to solve this?</p>\n\n<h2>Update</h2>\n\n<p><a href=\"https://i.stack.imgur.com/lQ1w3.png\" rel=\"nofollow noreferrer\">Here is an image showing the contents of my archive.</a> As you can see, there is a \" _ \" folder in my archive that I want to get rid of--oddly enough, when I extract, only FolderA and FileB.html appear as archived. In essence, the behavior is correct, but if I could go the last step of removing the \" _ \" folder from the archive, that would be perfect. I'm going to ask an updated question to limit confusion.</p>\n"}, {"tags": ["python", "pandas", "dataframe"], "comments": [{"owner": {"reputation": 17765, "user_id": 9375102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8yBw3.jpg?s=128&g=1", "display_name": "Umar.H", "link": "https://stackoverflow.com/users/9375102/umar-h"}, "edited": false, "score": 0, "creation_date": 1571263713, "post_id": 58422129, "comment_id": 103186815, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/40498463/python-splitting-dataframe-into-multiple-dataframes-based-on-column-values-and\">Python - splitting dataframe into multiple dataframes based on column values and naming them with those values</a>"}, {"owner": {"reputation": 31, "user_id": 11799259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e4439a4692be82d4135e1be0335dc35?s=128&d=identicon&r=PG&f=1", "display_name": "Analyst", "link": "https://stackoverflow.com/users/11799259/analyst"}, "reply_to_user": {"reputation": 17765, "user_id": 9375102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8yBw3.jpg?s=128&g=1", "display_name": "Umar.H", "link": "https://stackoverflow.com/users/9375102/umar-h"}, "edited": false, "score": 0, "creation_date": 1571323167, "post_id": 58422129, "comment_id": 103210632, "body": "@Datanovice: I tried using the similar code but I am not getting the expected output!"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 2, "creation_date": 1571323757, "post_id": 58422129, "comment_id": 103210977, "body": "<a href=\"https://meta.stackoverflow.com/a/285557/1422451\">You should not post code as an image because...</a>"}, {"owner": {"reputation": 31, "user_id": 11799259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e4439a4692be82d4135e1be0335dc35?s=128&d=identicon&r=PG&f=1", "display_name": "Analyst", "link": "https://stackoverflow.com/users/11799259/analyst"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1571328278, "post_id": 58422129, "comment_id": 103213483, "body": "@Parfait: Sure! I don&#39;t know about that.  Thanks for suggestion."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 11799259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e4439a4692be82d4135e1be0335dc35?s=128&d=identicon&r=PG&f=1", "display_name": "Analyst", "link": "https://stackoverflow.com/users/11799259/analyst"}, "edited": false, "score": 0, "creation_date": 1571328862, "post_id": 58435445, "comment_id": 103213772, "body": "If I want to iterate through Index values and dictionary (d--&gt; dictionary of df) How can I do that? For Example: If I want to count how many times &#39;cal&#39; column values are exceeding &#39;70&#39; per day! Expected output from your dataframe should be:     on 23 --&gt; 4 Times, on 24--&gt; 2 times and on25--&gt; 1Time"}, {"owner": {"reputation": 17765, "user_id": 9375102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8yBw3.jpg?s=128&g=1", "display_name": "Umar.H", "link": "https://stackoverflow.com/users/9375102/umar-h"}, "reply_to_user": {"reputation": 31, "user_id": 11799259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e4439a4692be82d4135e1be0335dc35?s=128&d=identicon&r=PG&f=1", "display_name": "Analyst", "link": "https://stackoverflow.com/users/11799259/analyst"}, "edited": false, "score": 0, "creation_date": 1571329487, "post_id": 58435445, "comment_id": 103214076, "body": "@Analyst updated for you - but this is basic for looping and working with python data types, I suggest you look at some basic tutorials for python and maybe search SO a little :) ask a new question if things get to complex but always post your data as text, show your code and paste any errors."}, {"owner": {"reputation": 31, "user_id": 11799259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e4439a4692be82d4135e1be0335dc35?s=128&d=identicon&r=PG&f=1", "display_name": "Analyst", "link": "https://stackoverflow.com/users/11799259/analyst"}, "edited": false, "score": 1, "creation_date": 1571330955, "post_id": 58435445, "comment_id": 103214676, "body": "Yeah Thanks. I will do that from next for sure. I am trying out. I will post my code and error too for reference as well.  Thanks for suggestions. Appreciate for that."}], "tags": [], "owner": {"reputation": 17765, "user_id": 9375102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8yBw3.jpg?s=128&g=1", "display_name": "Umar.H", "link": "https://stackoverflow.com/users/9375102/umar-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1571329431, "last_edit_date": 1571329431, "creation_date": 1571324018, "answer_id": 58435445, "question_id": 58422129, "link": "https://stackoverflow.com/questions/58422129/creating-multiple-dataframes-from-single-dataframe-based-on-different-values-of/58435445#58435445", "title": "Creating Multiple DataFrames from single DataFrame based on different values of single column", "body": "<p>Unsure if your saving your variable into a csv or keep it in memory for further use, </p>\n\n<p>you could pass each unique value into a dict and access by it's value : </p>\n\n<pre><code>    print(df)\n     Cal  Dates\n0    85     23\n1    75     23\n2    74     23\n3    97     23\n4    54     24\n5    10     24\n6    77     24\n7    95     24\n8    58     25\n9    53     25\n10   44     25\n11   94     25\n\n\n\nd = {}\n\nfor frame, data in df.groupby('Dates'):\n    d[f'df{frame}'] = data\n\n\nprint(d['df23'])\n    Cal  Dates\n0   85     23\n1   75     23\n2   74     23\n3   97     23\n</code></pre>\n\n<p>edit updated request : </p>\n\n<pre><code>for k,v in d.items():\n    i = (v['Cal'].loc[v['Cal'] &gt; 70].count())\n    print(f\"{v['Dates'].unique()[0]} --&gt; {i} times\")\n23 --&gt; 4 times\n24 --&gt; 2 times\n25 --&gt; 1 times\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11799259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e4439a4692be82d4135e1be0335dc35?s=128&d=identicon&r=PG&f=1", "display_name": "Analyst", "link": "https://stackoverflow.com/users/11799259/analyst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1027, "favorite_count": 1, "accepted_answer_id": 58435445, "answer_count": 1, "score": 0, "last_activity_date": 1571329431, "creation_date": 1571262627, "last_edit_date": 1571323074, "question_id": 58422129, "link": "https://stackoverflow.com/questions/58422129/creating-multiple-dataframes-from-single-dataframe-based-on-different-values-of", "title": "Creating Multiple DataFrames from single DataFrame based on different values of single column", "body": "<p>I have 3 days of time series data with multiple columns in it. I have one single DataFrame which includes all 3 days data.  I want 3 different DataFrames based on Column name \"Dates\" i.e df[\"Dates\"]</p>\n\n<p>For Example:</p>\n\n<p>Available Dataframe is: df</p>\n\n<p><a href=\"https://i.stack.imgur.com/RaqFU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RaqFU.png\" alt=\"enter image description here\"></a></p>\n\n<p>Expected Output: Based on Three different Dates</p>\n\n<p>First DataFrame: df_23</p>\n\n<p><a href=\"https://i.stack.imgur.com/3KrWz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3KrWz.png\" alt=\"enter image description here\"></a></p>\n\n<p>Second DataFrame: df_24</p>\n\n<p><a href=\"https://i.stack.imgur.com/XiwjZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XiwjZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Third DataFrame: df_25</p>\n\n<p><a href=\"https://i.stack.imgur.com/dyAHj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dyAHj.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want to use these all three DataFrames separately for analysis.</p>\n\n<p>I tried below code but I am not able to use those three dataframes (Rather I don't know how to use.) Can anybody help me to work my code better. Thank you.</p>\n\n<p><a href=\"https://i.stack.imgur.com/OmgxT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OmgxT.png\" alt=\"enter image description here\"></a></p>\n\n<p>Above code is just printing the DataFrame in three DataFrames that too not as expected as per code!</p>\n\n<p><a href=\"https://i.stack.imgur.com/q0q7l.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/q0q7l.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["python", "dictionary", "nested"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 5650705, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Yifangt", "link": "https://stackoverflow.com/users/5650705/yifangt"}, "edited": false, "score": 0, "creation_date": 1571270615, "post_id": 58422850, "comment_id": 103188439, "body": "Thanks! I overthought the problem as <b>7 lines as a single record</b> must be read in at once. One more question, my input file is very big (~30GB), is readlines() good for that?"}, {"owner": {"reputation": 338, "user_id": 7152553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K1zzfrQU5WU/AAAAAAAAAAI/AAAAAAAABig/AqMD13sY074/photo.jpg?sz=128", "display_name": "eshanrh", "link": "https://stackoverflow.com/users/7152553/eshanrh"}, "reply_to_user": {"reputation": 73, "user_id": 5650705, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Yifangt", "link": "https://stackoverflow.com/users/5650705/yifangt"}, "edited": false, "score": 0, "creation_date": 1571272239, "post_id": 58422850, "comment_id": 103188752, "body": "I think you have bigger problems than readlines() then. Do you have a computer that as over 30gb of RAM? If not, the computer won&#39;t be able to hold the file in memory. I&#39;d suggest splitting your data file up into manageable chunks. I&#39;m not too sure about the performance of readlines() vs other methods though."}, {"owner": {"reputation": 73, "user_id": 5650705, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Yifangt", "link": "https://stackoverflow.com/users/5650705/yifangt"}, "edited": false, "score": 0, "creation_date": 1571321712, "post_id": 58422850, "comment_id": 103209777, "body": "That&#39;s why I call the  &#39;next()&#39; function many times hoping to read multiple lines for a single record."}], "tags": [], "owner": {"reputation": 338, "user_id": 7152553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K1zzfrQU5WU/AAAAAAAAAAI/AAAAAAAABig/AqMD13sY074/photo.jpg?sz=128", "display_name": "eshanrh", "link": "https://stackoverflow.com/users/7152553/eshanrh"}, "is_accepted": true, "score": 1, "last_activity_date": 1571267958, "creation_date": 1571267958, "answer_id": 58422850, "question_id": 58422124, "link": "https://stackoverflow.com/questions/58422124/read-in-record-of-multiple-lines-from-file-into-nested-dictionary-in-python/58422850#58422850", "title": "Read in record of multiple lines from file into nested dictionary in python", "body": "<pre><code>data = {}\nwith open(\"data.txt\",'r') as fh:\n    for line in fh.readlines(): #read in multiple lines\n        if len(line.strip())==0:\n            continue\n\n        if line.startswith('Sample Name'):\n            nameLine = line.strip()\n            name = nameLine.split(\": \")[1]\n            data[name] = {}\n        else:\n            splitLine = line.split(\":\")\n            variableName = splitLine[0].strip()\n            value = splitLine[1].strip()\n            data[name][variableName] = value\n\nprint(data)\n</code></pre>\n\n<ol>\n<li>Make sure that the line you're reading in is not empty. If you strip all the empty space from an empty line, you'll get a string with length zero. We just check for this.</li>\n<li>If the line starts with <code>Sample Name</code>, we know that the id will come after a colon and a space. We can split by these characters. The id will be the second part of the split line, and so we just get the item at index one.</li>\n<li>Keep track of the current id, in a variable (I call it <code>name</code>). Create an empty nested dictionary entry for that id.</li>\n<li>If the line is not an ID line, then it must be a data line associated with the last entered ID. </li>\n<li>We get the line, split it by <code>:</code>. The name of the variable will be on the left, the first item, and the value will be on the right, so the second item. Make sure we strip all the extra spaces on either side.</li>\n<li>Add the variable and value pair to the dictionary entry for the ID.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 5650705, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Yifangt", "link": "https://stackoverflow.com/users/5650705/yifangt"}, "is_accepted": false, "score": 0, "last_activity_date": 1571635175, "last_edit_date": 1571635175, "creation_date": 1571600054, "answer_id": 58476585, "question_id": 58422124, "link": "https://stackoverflow.com/questions/58422124/read-in-record-of-multiple-lines-from-file-into-nested-dictionary-in-python/58476585#58476585", "title": "Read in record of multiple lines from file into nested dictionary in python", "body": "<p>Spent more time on the question and got a solution, which seems <strong>NOT</strong> \"pythonic\" as my code handling the first \"record\" (8 lines of data including the blank line at the bottom) are redundant of the rest.</p>\n\n<pre><code>import itertools\ndata = {}\nwith open(\"vcfstats.txt\", 'r') as f:\n    for line in f:\n        if line.strip():                #Non blank line\n            if line.startswith('Sample Name'):\n                nameLine = line.strip()\n                name = nameLine.split(\": \")[1].strip()\n                data[name] = {}\n            else:\n                splitLine = line.split(\": \")\n                variableName = splitLine[0].strip()\n                values = splitLine[1].strip().split(\" \")\n                data[name][variableName] = values[0]        #Only take the first item as value\n        else:\n             continue\n\n    for line in itertools.islice(f, 8):\n        lines = (line.rstrip() for line in f)          # including blank lines\n        lines = list(line for line in lines if line)   # skip blank lines\n\n        for line in lines:\n            if line.startswith('Sample Name'):\n                nameLine = line.strip()\n                name = nameLine.split(\": \")[1].strip()\n                data[name] = {}\n            else:\n                splitLine = line.split(\": \")\n                variableName = splitLine[0].strip()\n                values = splitLine[1].strip().split(\" \")\n                data[name][variableName] = values[0]        #Only take the first item as value\n</code></pre>\n\n<p>What did I miss? Thanks a lot!</p>\n"}], "owner": {"reputation": 73, "user_id": 5650705, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Yifangt", "link": "https://stackoverflow.com/users/5650705/yifangt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 58422850, "answer_count": 2, "score": 0, "last_activity_date": 1571635175, "creation_date": 1571262606, "last_edit_date": 1571265386, "question_id": 58422124, "link": "https://stackoverflow.com/questions/58422124/read-in-record-of-multiple-lines-from-file-into-nested-dictionary-in-python", "title": "Read in record of multiple lines from file into nested dictionary in python", "body": "<p>This is to practice nested dictionary, or, array of dictionaries, list of dictionary etc.\nThe data structure can be best described as array of struct/class in C/C++, and each struct has multiple members. The challenge to me: <br>\n1). There is string \"<strong>Sample Name</strong>\" as separator at the beginning of each record followed by multi-members; <br>\n2). 6 members of the record in each row separate by colon \":\"; <br>\n3). how to read multiple lines (instead of multiple fields of the same line, which is easier to parse) into the member of the record; <br>\n4). The <strong>record</strong> separator may not be preceded with a blank line.<br>\nI put sample input and the expected output for testing.<br>\nExample: <strong>input.txt</strong></p>\n\n<pre>\n\nSample Name: CanNAM1_192\nSNPs                         : 5392\nMNPs                         : 0\nInsertions                   : 248\nDeletions                    : 359\nPhased Genotypes             : 8.8% (2349/26565)\nMNP Het/Hom ratio            : - (0/0)\n\nSample Name: CanNAM2_195\nSNPs                         : 5107\nMNPs                         : 0\nInsertions                   : 224\nDeletions                    : 351\nPhased Genotypes             : 8.9% (2375/26560)\nMNP Het/Hom ratio            : - (0/0)\n\nSample Name: CanNAM3_196\nSNPs                         : 4926\nMNPs                         : 0\nInsertions                   : 202\nDeletions                    : 332\nPhased Genotypes             : 8.0% (2138/26582)\nMNP Het/Hom ratio            : - (0/0)\n</pre>\n\n<p>In awk there is RECORD separator RS and FIELD separator FS that can be set at beginning, but no such function in python to my knowledge.</p>\n\n<p><strong>Output.tab:</strong></p>\n\n<pre>\nCanNAM1_192  5392  0  248  359  8.8%  - \nCanNAM2_195  5107  0  224  351  8.9%  - \nCanNAM3_196  4926  0  202  332  8.0%  - \n</pre>\n\n<p>Tried search some example code for my case like this <a href=\"https://stackoverflow.com/questions/46985556/read-text-file-lines-and-create-a-dictionary-using-python\">one</a>, <a href=\"https://stackoverflow.com/questions/1657299/how-do-i-read-two-lines-from-a-file-at-a-time-using-python\">this one</a></p>\n\n<pre><code>import sys\n\nfilename=sys.argv[1]\n\nDictn = {}\n\nwith open(filename, 'r') as fh:\n    for line in fh:\n        while True:\n            if line.startswith('Sample Name'):\n                nameLine = line.strip()\n                ID = nameLine.split(':')\n            else:\n                line2 = next(fh).strip()\n                line2 = line2.split(':')\n                print (line2[0], line2[1]) # For debugging to see the parsing result\n                line3 = next(fh).strip().split(':')\n                line4 = next(fh).strip().split(':')\n                line5 = next(fh).strip().split(':')\n                line6 = next(fh).strip().split(':')\n                line7 = next(fh).strip().split(':')\n                Dictn.update({\n                            ID[1]: {\n                                line2[0]: line2[1],\n                                line3[0]: line3[1],\n                                line4[0]: line4[1],\n                                line5[0]: line5[1],\n                                line6[0]: line6[1],\n                                line7[0]: line7[1],\n                                }\n                             })\n                break\nprint(Dictn)\n\nDictn.get('CanNAM1_192')\n# {CanNAM1_192:{ {'SNPs' : '5392'}, {'MNPs' : '0'}, {'Insertions' : '248'}, {'Deletions' : '359'}, {'Phased Genotypes' : '8.8%'}, {'MNP Het/Hom ratio' : '-'} }}\n</code></pre>\n\n<p>I am stuck with the parsing each record by reading 7 lines at a time, then push/update the record into the dictionary. Not good at Python, and I really appreciate any help!</p>\n"}, {"tags": ["python", "pandas", "clickhouse"], "comments": [{"owner": {"reputation": 8507, "user_id": 303298, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ss7YE.jpg?s=128&g=1", "display_name": "vladimir", "link": "https://stackoverflow.com/users/303298/vladimir"}, "edited": false, "score": 0, "creation_date": 1571272319, "post_id": 58422110, "comment_id": 103188766, "body": "Are you using <a href=\"https://github.com/cloudflare/sqlalchemy-clickhouse\" rel=\"nofollow noreferrer\">clickhouse</a>-dialect for sqlalchemy? Could you provide the schema description for <i>test_humans</i>-table?"}, {"owner": {"reputation": 3004, "user_id": 1266985, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5ab21122a6d6e231d4bde605ce87c72b?s=128&d=identicon&r=PG", "display_name": "Jabb", "link": "https://stackoverflow.com/users/1266985/jabb"}, "reply_to_user": {"reputation": 8507, "user_id": 303298, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ss7YE.jpg?s=128&g=1", "display_name": "vladimir", "link": "https://stackoverflow.com/users/303298/vladimir"}, "edited": false, "score": 0, "creation_date": 1571289803, "post_id": 58422110, "comment_id": 103192446, "body": "Yes I am. When using to_sql(), pandas will usually create a schema automatically. I guess it has to do with exactly that. The create schema sql statement that the dialect is creating misses some proprietary command regarding &quot;ENGINE&quot;."}, {"owner": {"reputation": 3004, "user_id": 1266985, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5ab21122a6d6e231d4bde605ce87c72b?s=128&d=identicon&r=PG", "display_name": "Jabb", "link": "https://stackoverflow.com/users/1266985/jabb"}, "reply_to_user": {"reputation": 8507, "user_id": 303298, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ss7YE.jpg?s=128&g=1", "display_name": "vladimir", "link": "https://stackoverflow.com/users/303298/vladimir"}, "edited": false, "score": 0, "creation_date": 1571289956, "post_id": 58422110, "comment_id": 103192501, "body": "See my update.. some log information about the issued queries."}, {"owner": {"reputation": 889, "user_id": 1204665, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/96bc8cdbaf78a0ff513534e4cba22e9d?s=128&d=identicon&r=PG", "display_name": "Slach", "link": "https://stackoverflow.com/users/1204665/slach"}, "edited": false, "score": 1, "creation_date": 1571379693, "post_id": 58422110, "comment_id": 103228633, "body": "which driver you use exacly <a href=\"https://github.com/mymarilyn/clickhouse-driver\" rel=\"nofollow noreferrer\">github.com/mymarilyn/clickhouse-driver</a> or  <a href=\"https://github.com/cloudflare/sqlalchemy-clickhouse\" rel=\"nofollow noreferrer\">github.com/cloudflare/sqlalchemy-clickhouse</a> ?"}], "answers": [{"tags": [], "owner": {"reputation": 7191, "user_id": 4929646, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/HWc5G.jpg?s=128&g=1", "display_name": "Danila Ganchar", "link": "https://stackoverflow.com/users/4929646/danila-ganchar"}, "is_accepted": false, "score": 0, "last_activity_date": 1578496473, "creation_date": 1578496473, "answer_id": 59648796, "question_id": 58422110, "link": "https://stackoverflow.com/questions/58422110/pandas-how-to-insert-dataframe-into-clickhouse/59648796#59648796", "title": "Pandas: How to insert dataframe into Clickhouse", "body": "<p>You can do it without <code>sqlalchemy</code>.</p>\n\n<blockquote>\n  <p>pip install clickhouse-driver</p>\n</blockquote>\n\n<pre><code>from clickhouse_driver import Client\n\nclient = Client('localhost')\ndf = pandas.DataFrame.from_records([\n    {'year': 1994, 'first_name': 'Vova'},\n    {'year': 1995, 'first_name': 'Anja'},\n    {'year': 1996, 'first_name': 'Vasja'},\n    {'year': 1997, 'first_name': 'Petja'},\n])\n# df processing blablabla...\nclient.execute(\"INSERT INTO your_table VALUES\", df.to_dict('records'))\n</code></pre>\n\n<p>Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8276964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee17ce7add7d9a58e5c569800ff9aa8b?s=128&d=identicon&r=PG&f=1", "display_name": "stifstyle", "link": "https://stackoverflow.com/users/8276964/stifstyle"}, "is_accepted": false, "score": 1, "last_activity_date": 1579716871, "creation_date": 1579716871, "answer_id": 59865933, "question_id": 58422110, "link": "https://stackoverflow.com/questions/58422110/pandas-how-to-insert-dataframe-into-clickhouse/59865933#59865933", "title": "Pandas: How to insert dataframe into Clickhouse", "body": "<p>You can also use <a href=\"https://github.com/kszucs/pandahouse\" rel=\"nofollow noreferrer\">https://github.com/kszucs/pandahouse</a> to insert your dataframe without extra conversions.</p>\n\n<blockquote>\n  <p>pip install pandahouse</p>\n</blockquote>\n\n<pre><code>import pandahouse as ph\n\npdf = pandas.DataFrame.from_records([\n    {'year': 1994, 'first_name': 'Vova'},\n    {'year': 1995, 'first_name': 'Anja'},\n    {'year': 1996, 'first_name': 'Vasja'},\n    {'year': 1997, 'first_name': 'Petja'},\n])\n\nconnection = dict(database='default',\n                  host='localhost',\n                  user='default',\n                  password='')\n\nph.to_clickhouse(pdf, 'test_humans', index=False, chunksize=100000, connection=connection)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8507, "user_id": 303298, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ss7YE.jpg?s=128&g=1", "display_name": "vladimir", "link": "https://stackoverflow.com/users/303298/vladimir"}, "is_accepted": false, "score": 0, "last_activity_date": 1587124628, "last_edit_date": 1587124628, "creation_date": 1587123980, "answer_id": 61270873, "question_id": 58422110, "link": "https://stackoverflow.com/questions/58422110/pandas-how-to-insert-dataframe-into-clickhouse/61270873#61270873", "title": "Pandas: How to insert dataframe into Clickhouse", "body": "<p><a href=\"https://github.com/cloudflare/sqlalchemy-clickhouse\" rel=\"nofollow noreferrer\">sqlalchemy-clickhouse</a> cannot create table automatically (at least until version <em>0.1.5.post0</em> inclusively) and interprets any sql-query of table creation as <em>SELECT</em>-query that always tail by <em>FORMAT TabSeparatedWithNamesAndTypes</em>-clause.</p>\n\n<p>To work around this issue need to create a table manually using the <a href=\"https://github.com/Infinidat/infi.clickhouse_orm\" rel=\"nofollow noreferrer\">infi.clickhouse_orm</a>-api (this module delivered with <em>sqlalchemy-clickhouse</em>):</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import pandas as pd\nfrom infi.clickhouse_orm.engines import Memory\nfrom infi.clickhouse_orm.fields import UInt16Field, StringField\nfrom infi.clickhouse_orm.models import Model\nfrom sqlalchemy import create_engine\n\n\n# define the ClickHouse table schema\nclass Test_Humans(Model):\n    year = UInt16Field()\n    first_name = StringField()\n    engine = Memory()\n\n\nengine = create_engine('clickhouse://default:@localhost/test')\n\n# create table manually\nwith engine.connect() as conn:\n    conn.connection.create_table(Test_Humans) # https://github.com/Infinidat/infi.clickhouse_orm/blob/master/src/infi/clickhouse_orm/database.py#L142\n\npdf = pd.DataFrame.from_records([\n    {'year': 1994, 'first_name': 'Vova'},\n    {'year': 1995, 'first_name': 'Anja'},\n    {'year': 1996, 'first_name': 'Vasja'},\n    {'year': 1997, 'first_name': 'Petja'},\n    # ! sqlalchemy-clickhouse ignores the last item so add fake one\n    {}\n])\n\npdf.to_sql('test_humans', engine, if_exists='append', index=False)\n</code></pre>\n\n<p>Take into account that <em>sqlalchemy-clickhouse</em> ignores the last item so add fake one (see <a href=\"https://github.com/cloudflare/sqlalchemy-clickhouse/blob/v0.1.5/connector.py#L238\" rel=\"nofollow noreferrer\">source code</a> and related <a href=\"https://github.com/cloudflare/sqlalchemy-clickhouse/issues/10\" rel=\"nofollow noreferrer\">issue 10</a>).</p>\n\n<p>Let's check this table in DB:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT *\nFROM test.test_humans\n\n\u250c\u2500year\u2500\u252c\u2500first_name\u2500\u2510\n\u2502 1994 \u2502 Vova       \u2502\n\u2502 1995 \u2502 Anja       \u2502\n\u2502 1996 \u2502 Vasja      \u2502\n\u2502 1997 \u2502 Petja      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n4 rows in set. Elapsed: 0.003 sec.\n*/\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 375, "user_id": 1189783, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9d67ff993af0fc453355aa72be364ac2?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1189783/alex"}, "is_accepted": false, "score": 0, "last_activity_date": 1617018662, "creation_date": 1617018662, "answer_id": 66853698, "question_id": 58422110, "link": "https://stackoverflow.com/questions/58422110/pandas-how-to-insert-dataframe-into-clickhouse/66853698#66853698", "title": "Pandas: How to insert dataframe into Clickhouse", "body": "<p>Starting with version 0.2.0 clickhouse_driver implements method <code>insert_dataframe</code>. See: <a href=\"https://clickhouse-driver.readthedocs.io/en/latest/api.html#clickhouse_driver.Client.insert_dataframe\" rel=\"nofollow noreferrer\">https://clickhouse-driver.readthedocs.io/en/latest/api.html#clickhouse_driver.Client.insert_dataframe</a></p>\n"}], "owner": {"reputation": 3004, "user_id": 1266985, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5ab21122a6d6e231d4bde605ce87c72b?s=128&d=identicon&r=PG", "display_name": "Jabb", "link": "https://stackoverflow.com/users/1266985/jabb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4246, "favorite_count": 2, "answer_count": 4, "score": 3, "last_activity_date": 1617018662, "creation_date": 1571262549, "last_edit_date": 1571289978, "question_id": 58422110, "link": "https://stackoverflow.com/questions/58422110/pandas-how-to-insert-dataframe-into-clickhouse", "title": "Pandas: How to insert dataframe into Clickhouse", "body": "<p>I am trying to insert a Pandas dataframe into Clickhouse.</p>\n\n<p>This is my code</p>\n\n<pre><code>import pandas\nimport sqlalchemy as sa\n\nuri = 'clickhouse://default:@localhost/default'\nch_db = sa.create_engine(uri)\n\npdf = pandas.DataFrame.from_records([\n    {'year': 1994, 'first_name': 'Vova'},\n    {'year': 1995, 'first_name': 'Anja'},\n    {'year': 1996, 'first_name': 'Vasja'},\n    {'year': 1997, 'first_name': 'Petja'},\n])\n\npdf.to_sql('test_humans', ch_db, if_exists='append', index=False)\n</code></pre>\n\n<p>And this is the error that I am receiving. Does this have to do with some missing extra arguments regarding the ENGINE? How can I fix this?</p>\n\n<blockquote>\n  <p>Exception: Code: 62, e.displayText() = DB::Exception: Syntax error:\n  failed at position 65 (line 7, col 2): FORMAT\n  TabSeparatedWithNamesAndTypes. Expected one of: ENGINE, storage\n  definition (version 19.15.2.2 (official build))</p>\n</blockquote>\n\n<p>Logging</p>\n\n<blockquote>\n  <p>INFO:sqlalchemy.engine.base.Engine:EXISTS TABLE test_humans\n  INFO:sqlalchemy.engine.base.Engine:{}\n  INFO:sqlalchemy.engine.base.Engine: CREATE TABLE test_humans (\n          first_name TEXT,\n          year BIGINT )</p>\n  \n  <p>INFO:sqlalchemy.engine.base.Engine:{}\n  INFO:sqlalchemy.engine.base.Engine:ROLLBACK</p>\n</blockquote>\n"}, {"tags": ["python", "google-drive-api"], "answers": [{"tags": [], "owner": {"reputation": 9460, "user_id": 11551468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ZwJZ.jpg?s=128&g=1", "display_name": "Rafa Guillermo", "link": "https://stackoverflow.com/users/11551468/rafa-guillermo"}, "is_accepted": true, "score": 1, "last_activity_date": 1571297128, "last_edit_date": 1592644375, "creation_date": 1571297128, "answer_id": 58427081, "question_id": 58422028, "link": "https://stackoverflow.com/questions/58422028/how-to-speed-up-a-google-drive-api-search/58427081#58427081", "title": "How to Speed up a Google Drive API Search", "body": "<h3>Answer:</h3>\n<p><em>Unfortunately, there isn't anything you can do here. Your code is about as optimised as it can get.</em></p>\n<h3>Further Information:</h3>\n<p>As far as your code goes, there's only one line of code that is interacting with the Google Drive API. For best practice reasons I would personally define your parameters separately and send them that way:</p>\n<pre class=\"lang-py prettyprint-override\"><code>mime = 'application/vnd.google-apps.presentation'\ngSlideFolder = 'folderId of presentations folder'\nq = f&quot;'{gSlideFolder}' in parents and mimeType='{mime}' and trashed=false&quot;\ns = 'drive'\nf = 'nextPageToken, files(id, name)'\n\nresults = service.files().list(q=q, spaces=s, fields=f).execute()\n</code></pre>\n<p>However in terms of your actual API call there's not really anything you can do here - you're waiting for the request to be sent to Google's servers, Google's servers to process and run the request, and send the result back to your application. 2 seconds isn't that long for a <code>Files: list</code> request.</p>\n"}], "owner": {"reputation": 157, "user_id": 1112760, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cf8abdbeb546ddb5c9310232cdcde604?s=128&d=identicon&r=PG", "display_name": "grahama", "link": "https://stackoverflow.com/users/1112760/grahama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 58427081, "answer_count": 1, "score": 1, "last_activity_date": 1571303621, "creation_date": 1571262001, "last_edit_date": 1571303621, "question_id": 58422028, "link": "https://stackoverflow.com/questions/58422028/how-to-speed-up-a-google-drive-api-search", "title": "How to Speed up a Google Drive API Search", "body": "<p>The below code takes about 2 seconds to query a specific folder containing ~5 google slide presentations within. \nQuestion: Is there a way to speed up / optimize the Google Drive API search? \nFor my use case (drop down menu), 2 seconds is a little too long for live feedback. I think users would have an aneurysm ;)</p>\n\n<pre class=\"lang-py prettyprint-override\"><code># all the credentials stuff....\n\nmime = 'application/vnd.google-apps.presentation'\ngSlideFolder = 'folderId of presentations folder'\nresults = service.files().list(q=f\"'{gSlideFolder}' in parents and mimeType='{mime}' and trashed=false\",\n                                  spaces='drive',\n                                  fields='nextPageToken, files(id, name)'\n                                  ).execute()\n\nitems = results.get('files', [])\n\n# Print results in items.....\n</code></pre>\n\n<p>I'm very new to this API...so it could be (is) something dumb. Apologies in advance.</p>\n"}, {"tags": ["python", "macos", "amazon-web-services", "deep-learning", "macos-catalina"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11283404, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GljDV6wBZH8/AAAAAAAAAAI/AAAAAAAAAKM/f3x3gn-E8W4/photo.jpg?sz=128", "display_name": "Ajay Patel", "link": "https://stackoverflow.com/users/11283404/ajay-patel"}, "edited": false, "score": 0, "creation_date": 1571279662, "post_id": 58422158, "comment_id": 103190192, "body": "Pretty much follow the first link&#39;s guide?"}, {"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "reply_to_user": {"reputation": 11, "user_id": 11283404, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GljDV6wBZH8/AAAAAAAAAAI/AAAAAAAAAKM/f3x3gn-E8W4/photo.jpg?sz=128", "display_name": "Ajay Patel", "link": "https://stackoverflow.com/users/11283404/ajay-patel"}, "edited": false, "score": 0, "creation_date": 1571279856, "post_id": 58422158, "comment_id": 103190233, "body": "Well, read the 2 guides and decide what makes most sense to you. I\u2019d install brew then use brew to install awscli and ultimately Python 3, assuming that you need Python."}], "tags": [], "owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "is_accepted": false, "score": 1, "last_activity_date": 1571262878, "creation_date": 1571262878, "answer_id": 58422158, "question_id": 58422023, "link": "https://stackoverflow.com/questions/58422023/trying-to-install-aws-cli-on-my-mac-os-catalina/58422158#58422158", "title": "Trying to Install AWS CLI on my Mac OS (Catalina)", "body": "<p>It's common to <a href=\"https://docs.python-guide.org/starting/install3/osx/\" rel=\"nofollow noreferrer\">install homebrew (aka brew) on Mac</a>, as a general-purpose software package manager, and then you can <code>brew install awscli</code>.</p>\n\n<p>As a general rule, I think you should also leave the default Mac Python alone (especially at v2.x) and go ahead and <a href=\"https://opensource.com/article/19/5/python-3-default-mac#targetText=Use%20Python%203%20as%20the,usr%2Flocal%2Fbin%2F.\" rel=\"nofollow noreferrer\">install the latest Python v3.x</a>. Again, you can use brew to do this.</p>\n"}], "owner": {"reputation": 11, "user_id": 11283404, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GljDV6wBZH8/AAAAAAAAAAI/AAAAAAAAAKM/f3x3gn-E8W4/photo.jpg?sz=128", "display_name": "Ajay Patel", "link": "https://stackoverflow.com/users/11283404/ajay-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 949, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1571263045, "creation_date": 1571261939, "last_edit_date": 1571263045, "question_id": 58422023, "link": "https://stackoverflow.com/questions/58422023/trying-to-install-aws-cli-on-my-mac-os-catalina", "title": "Trying to Install AWS CLI on my Mac OS (Catalina)", "body": "<p>ERROR: </p>\n\n<pre><code>Could not install packages due to an EnvironmentError: [Errno 13] Permission denied: '/Library/Python/2.7/site-packages/PyYAML-5.1.2.dist-info'\nConsider using the `--user` option or check the permissions.\n</code></pre>\n\n<p>This is the message I keep getting from my terminal... Should I upgrade my python to the most current (could someone give me suggestions on how to do that w/ Mac, do I just go to python's website lol?) </p>\n\n<p>What do I do to get the AWS CLI package installed? I'm trying to learn AWS to up myself and further my career</p>\n\n<p>Thank you.         </p>\n"}, {"tags": ["python"], "comments": [{"owner": {"reputation": 1661, "user_id": 1927583, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fc9a6c4f6d819f019db6d48264f47dae?s=128&d=identicon&r=PG", "display_name": "ba_ul", "link": "https://stackoverflow.com/users/1927583/ba-ul"}, "edited": false, "score": 2, "creation_date": 1571261664, "post_id": 58421973, "comment_id": 103186181, "body": "What is the output or error you&#39;re getting?"}, {"owner": {"reputation": 1661, "user_id": 1927583, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fc9a6c4f6d819f019db6d48264f47dae?s=128&d=identicon&r=PG", "display_name": "ba_ul", "link": "https://stackoverflow.com/users/1927583/ba-ul"}, "edited": false, "score": 3, "creation_date": 1571261859, "post_id": 58421973, "comment_id": 103186224, "body": "Can you describe the logic of how you&#39;re trying to compare?"}, {"owner": {"reputation": 1068, "user_id": 7211815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qt3B.png?s=128&g=1", "display_name": "codrelphi", "link": "https://stackoverflow.com/users/7211815/codrelphi"}, "edited": false, "score": 1, "creation_date": 1571261939, "post_id": 58421973, "comment_id": 103186261, "body": "The logic is not well described..."}, {"owner": {"reputation": 418, "user_id": 2394647, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/524339edce21ef3c24f8e2d9391ebe82?s=128&d=identicon&r=PG", "display_name": "sethuv", "link": "https://stackoverflow.com/users/2394647/sethuv"}, "edited": false, "score": 0, "creation_date": 1571262258, "post_id": 58421973, "comment_id": 103186364, "body": "modified the description to describe the logic."}, {"owner": {"reputation": 21133, "user_id": 1084416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/RLhZZ.jpg?s=128&g=1", "display_name": "Peter Wood", "link": "https://stackoverflow.com/users/1084416/peter-wood"}, "edited": false, "score": 0, "creation_date": 1571262337, "post_id": 58421973, "comment_id": 103186392, "body": "Why shouldn&#39;t <code>[1, &#39;F&#39;, 606, 400]</code> be in the output?"}, {"owner": {"reputation": 311, "user_id": 4741735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf5743715a1342ce13d780d0a457f5cb?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Braun", "link": "https://stackoverflow.com/users/4741735/florian-braun"}, "edited": false, "score": 1, "creation_date": 1571262656, "post_id": 58421973, "comment_id": 103186488, "body": "Looks to me as if all items are meeting your criteria not just what you expect. You are comparing all items to each other. Is your intend to only compare to the first?"}, {"owner": {"reputation": 418, "user_id": 2394647, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/524339edce21ef3c24f8e2d9391ebe82?s=128&d=identicon&r=PG", "display_name": "sethuv", "link": "https://stackoverflow.com/users/2394647/sethuv"}, "edited": false, "score": 0, "creation_date": 1571262973, "post_id": 58421973, "comment_id": 103186594, "body": "<code>[1, &#39;F&#39;, 606, 399]</code> should be in the output as it is unique compared to the item <code>[0, &#39;F&#39;, 537, 187]</code>"}, {"owner": {"reputation": 1068, "user_id": 7211815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qt3B.png?s=128&g=1", "display_name": "codrelphi", "link": "https://stackoverflow.com/users/7211815/codrelphi"}, "edited": false, "score": 0, "creation_date": 1571263162, "post_id": 58421973, "comment_id": 103186649, "body": "@SetV: So, the logic is to compared all items to the first item: is it that ?"}, {"owner": {"reputation": 418, "user_id": 2394647, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/524339edce21ef3c24f8e2d9391ebe82?s=128&d=identicon&r=PG", "display_name": "sethuv", "link": "https://stackoverflow.com/users/2394647/sethuv"}, "reply_to_user": {"reputation": 1068, "user_id": 7211815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qt3B.png?s=128&g=1", "display_name": "codrelphi", "link": "https://stackoverflow.com/users/7211815/codrelphi"}, "edited": false, "score": 0, "creation_date": 1571263251, "post_id": 58421973, "comment_id": 103186687, "body": "@codrelphi That is not the requirement. Pick the unique items and add to a new list."}, {"owner": {"reputation": 711, "user_id": 10734880, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VqInoFdU3M8/AAAAAAAAAAI/AAAAAAAAAA4/KLtzLyk_ZJ0/photo.jpg?sz=128", "display_name": "Nick Martin", "link": "https://stackoverflow.com/users/10734880/nick-martin"}, "edited": false, "score": 0, "creation_date": 1571263422, "post_id": 58421973, "comment_id": 103186743, "body": "@SetV that doesn&#39;t make any sense, according to your logic the output list should contain 5 items (4 &quot;unique&quot; plus the first)"}, {"owner": {"reputation": 418, "user_id": 2394647, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/524339edce21ef3c24f8e2d9391ebe82?s=128&d=identicon&r=PG", "display_name": "sethuv", "link": "https://stackoverflow.com/users/2394647/sethuv"}, "reply_to_user": {"reputation": 711, "user_id": 10734880, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VqInoFdU3M8/AAAAAAAAAAI/AAAAAAAAAA4/KLtzLyk_ZJ0/photo.jpg?sz=128", "display_name": "Nick Martin", "link": "https://stackoverflow.com/users/10734880/nick-martin"}, "edited": false, "score": 0, "creation_date": 1571263541, "post_id": 58421973, "comment_id": 103186771, "body": "@NickMartin Unique is defined if the points are more than 5 points"}, {"owner": {"reputation": 25595, "user_id": 202229, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6cc1d82c11563b440c57280ad587ee47?s=128&d=identicon&r=PG", "display_name": "smci", "link": "https://stackoverflow.com/users/202229/smci"}, "edited": false, "score": 0, "creation_date": 1571263565, "post_id": 58421973, "comment_id": 103186775, "body": "You always arbitrarily choose whichever first input item you see. So you can replace the redundant code <code>if len(outList) == 0: outList.append(item); continue</code> with simply initializing <code>outList = inputList[0]</code>, then just iterate over <code>inputList[1:]</code>"}, {"owner": {"reputation": 711, "user_id": 10734880, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VqInoFdU3M8/AAAAAAAAAAI/AAAAAAAAAA4/KLtzLyk_ZJ0/photo.jpg?sz=128", "display_name": "Nick Martin", "link": "https://stackoverflow.com/users/10734880/nick-martin"}, "edited": false, "score": 0, "creation_date": 1571263643, "post_id": 58421973, "comment_id": 103186798, "body": "@SetV this is the &quot;delta&quot; list compared to the first element: <code>deltaList = [[0, &#39;F&#39;, 0, 0],[1, &#39;F&#39;, 69, 212],[0, &#39;F&#39;, 0, 0],[1, &#39;F&#39;, 69, 213],[0, &#39;F&#39;, 69, 212],[0, &#39;F&#39;, 0, 1],[0, &#39;F&#39;, 0, 1],[0, &#39;F&#39;, 68, 213]]</code> there are 4 elements that meet your criteria..."}, {"owner": {"reputation": 25595, "user_id": 202229, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6cc1d82c11563b440c57280ad587ee47?s=128&d=identicon&r=PG", "display_name": "smci", "link": "https://stackoverflow.com/users/202229/smci"}, "edited": false, "score": 0, "creation_date": 1571263947, "post_id": 58421973, "comment_id": 103186887, "body": "It&#39;s much more user-friendly and makes for shorter code to refer to your columns as A,B,C,D instead of <code>item[0],[1],[2],[3]...</code>"}], "answers": [{"comments": [{"owner": {"reputation": 418, "user_id": 2394647, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/524339edce21ef3c24f8e2d9391ebe82?s=128&d=identicon&r=PG", "display_name": "sethuv", "link": "https://stackoverflow.com/users/2394647/sethuv"}, "edited": false, "score": 0, "creation_date": 1571263160, "post_id": 58422078, "comment_id": 103186647, "body": "<code>[1, &#39;F&#39;, 606, 399]</code> should be in the output as it is unique compared to the item <code>[0, &#39;F&#39;, 537, 187]</code>"}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "reply_to_user": {"reputation": 418, "user_id": 2394647, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/524339edce21ef3c24f8e2d9391ebe82?s=128&d=identicon&r=PG", "display_name": "sethuv", "link": "https://stackoverflow.com/users/2394647/sethuv"}, "edited": false, "score": 0, "creation_date": 1571263657, "post_id": 58422078, "comment_id": 103186804, "body": "By that criterion, your original output seems to be correct: each of the elements is unique compared to at least one other."}], "tags": [], "owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "is_accepted": false, "score": 0, "last_activity_date": 1571262320, "creation_date": 1571262320, "answer_id": 58422078, "question_id": 58421973, "link": "https://stackoverflow.com/questions/58421973/list-subset-based-on-element-values/58422078#58422078", "title": "List subset based on element values", "body": "<p>Your error is in your comparison logic:</p>\n\n<pre><code>for item2 in inputList.copy():\n    if abs(item[2] - item2[2]) &gt; 5 and abs(item[3] - item2[3]) &gt; 5:\n        if item not in outList:\n            outList.append(item)\n</code></pre>\n\n<p>If <code>item</code> differs from <em>any</em> element by 5 points, then you consider it a separate item.  You have to iterate through <em>all</em> of the items -- and fail to find a match -- before you add it to <code>outList</code>.</p>\n\n<pre><code>for item2 in inputList.copy():\n    if abs(item[2] - item2[2]) &lt;= 5 and abs(item[3] - item2[3]) &lt;= 5:\n        break\nelse:\n    outList.append(item)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[[0, 'F', 537, 187]]\n</code></pre>\n\n<p>According to your description, the other element in your \"expected output\" is wrong: <code>606, 399</code> matches <code>605, 400</code>.  If the difference in the first element is supposed to differentiate these, then you must add that to your description and to your code.</p>\n\n<pre><code>    if item[0] == item2[0] and          \\\n       abs(item[2] - item2[2]) &lt;= 5 and \\\n       abs(item[3] - item2[3]) &lt;= 5:\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25595, "user_id": 202229, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6cc1d82c11563b440c57280ad587ee47?s=128&d=identicon&r=PG", "display_name": "smci", "link": "https://stackoverflow.com/users/202229/smci"}, "is_accepted": false, "score": 1, "last_activity_date": 1571269193, "last_edit_date": 1571269193, "creation_date": 1571263407, "answer_id": 58422255, "question_id": 58421973, "link": "https://stackoverflow.com/questions/58421973/list-subset-based-on-element-values/58422255#58422255", "title": "List subset based on element values", "body": "<p>I recommend <code>pandas</code> package for non-trivial manipulations of 2D data (dataframe), instead of what you're doing. The code will be cleaner and clearer.</p>\n\n<pre><code>import pandas as pd      \n\ndf = pd.DataFrame(inputList, columns=['A','B','C','D']) # name the columns instead of `item[2],[3]...`\ndf.sort_values(by=['A','B','C','D'], inplace=True)\n\n&gt;&gt;&gt; df\n   A  B    C    D\n5  0  F  537  186\n6  0  F  537  186\n0  0  F  537  187\n2  0  F  537  187\n7  0  F  605  400\n4  0  F  606  399\n1  1  F  606  399\n3  1  F  606  400\n</code></pre>\n\n<p>Now you can apply whatever manipulations you want. In your case you will always (arbitrarily) choose the first input item you see, i.e. <code>inputList[0]</code> or <code>df.iloc[0]</code>; let's call that <code>row0</code>. You then also (iteratively) choose any items whose C and D values are both larger/smaller by > 5 than the C,D values of the first item. But it is possible to formulate this non-iteratively rather than your existing iterative method which is going to be O(N^2). For example:</p>\n\n<pre><code>row0 = df.iloc[0]\n\ndf[ df.apply(lambda r: abs(r.C - row0.C)&gt;5 and abs(r.D - row0.D)&gt;5,  axis=1) ]\n\n   A  B    C    D\n1  1  F  606  399\n3  1  F  606  400\n4  0  F  606  399\n7  0  F  605  400\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>&gt;&gt;&gt; df.groupby('C').head(1)\n   A  B    C    D\n5  0  F  537  186\n7  0  F  605  400\n4  0  F  606  399\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 418, "user_id": 2394647, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/524339edce21ef3c24f8e2d9391ebe82?s=128&d=identicon&r=PG", "display_name": "sethuv", "link": "https://stackoverflow.com/users/2394647/sethuv"}, "edited": false, "score": 0, "creation_date": 1571264570, "post_id": 58422269, "comment_id": 103187070, "body": "Understood my mistake."}], "tags": [], "owner": {"reputation": 1190, "user_id": 9714791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hpV5X.png?s=128&g=1", "display_name": "Mehrdad Dowlatabadi", "link": "https://stackoverflow.com/users/9714791/mehrdad-dowlatabadi"}, "is_accepted": true, "score": 2, "last_activity_date": 1571263879, "last_edit_date": 1571263879, "creation_date": 1571263486, "answer_id": 58422269, "question_id": 58421973, "link": "https://stackoverflow.com/questions/58421973/list-subset-based-on-element-values/58422269#58422269", "title": "List subset based on element values", "body": "<p>I think you are looking for something as follows :</p>\n\n<pre><code>inputList = [[0, 'F', 537, 187], [1, 'F', 606, 399], [0, 'F', 537, 187],\n    [1, 'F', 606, 400], [0, 'F', 606, 399], [0, 'F', 537, 186],\n    [0, 'F', 537, 186], [0, 'F', 605, 400]] \n\noutList = []\nfor item in inputList:\n    if len(outList) == 0:\n        outList.append(item)\n        continue\n    #indicator flag for new element is initialized to true\n    isnew=True\n    for item2 in outList.copy():\n        if abs(item[2] - item2[2]) &lt;= 5 or abs(item[3] - item2[3]) &lt;= 5:\n                isnew=False\n                break\n     #if all elements have enough distant (5) from current element, flag maintains true and element is inserted\n    if isnew and  item not in outList:\n        outList.append(item)\n\nprint(outList)\n</code></pre>\n\n<p>output:</p>\n\n<pre><code> [[0, 'F', 537, 187], [1, 'F', 606, 399]]\n</code></pre>\n"}], "owner": {"reputation": 418, "user_id": 2394647, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/524339edce21ef3c24f8e2d9391ebe82?s=128&d=identicon&r=PG", "display_name": "sethuv", "link": "https://stackoverflow.com/users/2394647/sethuv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 1, "accepted_answer_id": 58422269, "answer_count": 3, "score": 0, "last_activity_date": 1571269193, "creation_date": 1571261509, "last_edit_date": 1571262606, "question_id": 58421973, "link": "https://stackoverflow.com/questions/58421973/list-subset-based-on-element-values", "title": "List subset based on element values", "body": "<p>I have a Python list where list elements need to be compared to create a subset list.</p>\n\n<p>List item element 3 and 4 should be greater than 5 points to consider it as a unique item else the item can be treated as the same item.</p>\n\n<pre><code>inputList = [[0, 'F', 537, 187], [1, 'F', 606, 399], [0, 'F', 537, 187], \\ \n    [1, 'F', 606, 400], [0, 'F', 606, 399], [0, 'F', 537, 186], \\\n    [0, 'F', 537, 186], [0, 'F', 605, 400]] \n</code></pre>\n\n<p>Expected output list</p>\n\n<pre><code>outList = [[0, 'F', 537, 187], [1, 'F', 606, 399]]\n</code></pre>\n\n<p>Following is the Python3 code, I am not sure where the error is, the expected output is not received.</p>\n\n<pre><code>outList = []\nfor item in inputList:\n    if len(outList) == 0:\n        outList.append(item)\n        continue\n\n    for item2 in inputList.copy():\n        if abs(item[2] - item2[2]) &gt; 5 and abs(item[3] - item2[3]) &gt; 5:\n            if item not in outList:\n                outList.append(item)\n</code></pre>\n\n<p>Received output</p>\n\n<pre><code>[[0, 'F', 537, 187], [1, 'F', 606, 399], [1, 'F', 606, 400], \\\n[0, 'F', 606, 399], [0, 'F', 537, 186], [0, 'F', 605, 400]]\n</code></pre>\n\n<p>Let me know where I am doing a mistake.</p>\n"}, {"tags": ["python", "numpy", "soundfile"], "answers": [{"comments": [{"owner": {"reputation": 178, "user_id": 8521526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf2444d0af05573de33bc03f86f70ab?s=128&d=identicon&r=PG&f=1", "display_name": "mathew gunther", "link": "https://stackoverflow.com/users/8521526/mathew-gunther"}, "edited": false, "score": 1, "creation_date": 1571494719, "post_id": 58464434, "comment_id": 103264252, "body": "this assumes the OP&#39;s  &quot;audio_signal&quot; has no noise to begin with, but otherwise a very good answer"}, {"owner": {"reputation": 2946, "user_id": 6659511, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh5.googleusercontent.com/-cl0nfkTWr20/AAAAAAAAAAI/AAAAAAAABi4/PFJScYlYuao/photo.jpg?sz=128", "display_name": "ma3oun", "link": "https://stackoverflow.com/users/6659511/ma3oun"}, "reply_to_user": {"reputation": 178, "user_id": 8521526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf2444d0af05573de33bc03f86f70ab?s=128&d=identicon&r=PG&f=1", "display_name": "mathew gunther", "link": "https://stackoverflow.com/users/8521526/mathew-gunther"}, "edited": false, "score": 0, "creation_date": 1571496641, "post_id": 58464434, "comment_id": 103264748, "body": "@mathewgunther Indeed. Taking into account the noise already present in the audio file is a whole different story!"}], "tags": [], "owner": {"reputation": 2946, "user_id": 6659511, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh5.googleusercontent.com/-cl0nfkTWr20/AAAAAAAAAAI/AAAAAAAABi4/PFJScYlYuao/photo.jpg?sz=128", "display_name": "ma3oun", "link": "https://stackoverflow.com/users/6659511/ma3oun"}, "is_accepted": true, "score": 4, "last_activity_date": 1571493456, "creation_date": 1571493456, "answer_id": 58464434, "question_id": 58421942, "link": "https://stackoverflow.com/questions/58421942/how-can-i-add-gaussian-noise-with-a-specified-snr-to-an-audio-file-with-soundfil/58464434#58464434", "title": "How can I add gaussian noise with a specified SNR to an audio file with Soundfile in Python?", "body": "<p>First, some <a href=\"https://en.wikipedia.org/wiki/Signal-to-noise_ratio\" rel=\"nofollow noreferrer\">theory</a>:</p>\n\n<p>You can compute the SNR by dividing the average power of the signal by the average power of the noise.</p>\n\n<p>For any given signal, you can estimate its average power using its <a href=\"https://en.wikipedia.org/wiki/Spectral_density\" rel=\"nofollow noreferrer\">power spectral density</a>. In brief, it's the averaged amplitude of its FFT.</p>\n\n<p>Here's a working example using numpy FFT:</p>\n\n<pre><code>import numpy as np\nimport soundfile as sf\n\n\nsampling_rate = 42000 #42kHz sampling rate is enough for audio\nNsamples = 100000 # a bit more than 2 seconds of signal at the current sampling rate\nfreq = 440 # musical A\nA = 5\nnoiseAmplitude = 5\nnoiseSigma = 0.1\n\nnoise = noiseAmplitude * np.random.normal(0, noiseSigma, Nsamples)\n\n# Generate a pure sound sampled at our sampling_rate for a duration of roughly 2s\ncleanSound = A*np.sin(2*np.pi*freq/sampling_rate*np.arange(Nsamples))\n\nsampleSound = cleanSound + noise\n\n# For a pure sine and a white noise, the theoretical SNR in dB is:\ntheoreticalSNR = 20*np.log10(A/(np.sqrt(2)*noiseAmplitude*noiseSigma)) # the sqrt of 2 is because of root-mean square amplitude\n\n## Experimental measurement using FFT (we use sampling_rate//2 points for Nyquist)\n# power spectrum of the clean sound (averaged spectral density)\ncleanPS = np.sum(np.abs(np.fft.fft(cleanSound,sampling_rate//2)/Nsamples)**2)\n\n# same for noise\nnoisePS = np.sum(np.abs(np.fft.fft(noise,sampling_rate//2)/Nsamples)**2)\n\n# 10 instead of 20 because we're using power instead of RMS amplitude\nmeasuredSNR = 10*np.log10(cleanPS/noisePS)\n\n# write to output sound file\nsf.write('/tmp/sample.wav',sampleSound,sampling_rate)\n</code></pre>\n\n<p>With the values from above, I get a theoretical SNR of 16.989 dB and a measured SNR of 16.946 dB.\nTherefore, if you want to add white noise with a given SNR to any given audio signal, you can compute the white noise power by reversing the formula: <code>SNR = 10*np.log10(cleanPS/noisePS)</code> and chose the noiseAmplitude and noiseSigma accordingly.</p>\n"}], "owner": {"reputation": 33403, "user_id": 239879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9e2d7ef70e61ce1c509e556c453626d?s=128&d=identicon&r=PG", "display_name": "Shamoon", "link": "https://stackoverflow.com/users/239879/shamoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1335, "favorite_count": 1, "accepted_answer_id": 58464434, "answer_count": 1, "score": 1, "last_activity_date": 1571493456, "creation_date": 1571261336, "question_id": 58421942, "link": "https://stackoverflow.com/questions/58421942/how-can-i-add-gaussian-noise-with-a-specified-snr-to-an-audio-file-with-soundfil", "title": "How can I add gaussian noise with a specified SNR to an audio file with Soundfile in Python?", "body": "<pre><code>    print('Processing: ', filepath)\n    path, file = os.path.split(filepath)\n    noisy_path = path.replace('dev-clean', 'dev-noise-gassian')\n    print(path, file)\n    if not os.path.exists(noisy_path):\n        os.makedirs(noisy_path)\n\n    noisy_filepath = os.path.join(noisy_path, file)\n    audio_signal, samplerate = sf.read(filepath)\n    noise = np.random.normal(0, 0.1, audio_signal.shape[0])\n\n    noisy_signal = audio_signal + noise\n\n    print(audio_signal)\n    print(noisy_signal)\n    sf.write(noisy_filepath, noisy_signal, samplerate)\n\n    quit()\n</code></pre>\n\n<p>That's what I'm doing, and it adds noise, but I don't know what the SNR of the noise is. How do I calibrate the addition of noise to match a specified SNR?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["python", "selenium", "selenium-chromedriver", "google-image-search"], "answers": [{"comments": [{"owner": {"reputation": 488, "user_id": 11218701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84e3f8dd7779845dca98f110d785da6a?s=128&d=identicon&r=PG&f=1", "display_name": "Philip", "link": "https://stackoverflow.com/users/11218701/philip"}, "edited": false, "score": 0, "creation_date": 1571314406, "post_id": 58422017, "comment_id": 103205231, "body": "If that doesn&#39;t work, then hardcode line 177 of google_images_download.py where it says browser = webdriver.Chrome(chromedriver, chromeoptions=options) and set the chromedriver variable to the absolute path such as &quot;C:/Users\\YourUserName\\Desktop\\google-images-download-master&zwnj;&#8203;\\google_images_downl&zwnj;&#8203;oad\\chromedriver.exe&zwnj;&#8203;&quot;"}, {"owner": {"reputation": 23, "user_id": 11891046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc601420862b262d5236beeadfcc995?s=128&d=identicon&r=PG&f=1", "display_name": "Jerel", "link": "https://stackoverflow.com/users/11891046/jerel"}, "edited": false, "score": 0, "creation_date": 1571330491, "post_id": 58422017, "comment_id": 103214493, "body": "MyNameIsCaleb&#39;s response is working perfectly.  Thank you."}, {"owner": {"reputation": 4102, "user_id": 10366273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1c2BX.jpg?s=128&g=1", "display_name": "MyNameIsCaleb", "link": "https://stackoverflow.com/users/10366273/mynameiscaleb"}, "reply_to_user": {"reputation": 23, "user_id": 11891046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc601420862b262d5236beeadfcc995?s=128&d=identicon&r=PG&f=1", "display_name": "Jerel", "link": "https://stackoverflow.com/users/11891046/jerel"}, "edited": false, "score": 0, "creation_date": 1571330521, "post_id": 58422017, "comment_id": 103214502, "body": "@Jerel glad it is working. Please hit the checkmark next to my answer. :)"}], "tags": [], "owner": {"reputation": 4102, "user_id": 10366273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1c2BX.jpg?s=128&g=1", "display_name": "MyNameIsCaleb", "link": "https://stackoverflow.com/users/10366273/mynameiscaleb"}, "is_accepted": true, "score": 2, "last_activity_date": 1571261881, "creation_date": 1571261881, "answer_id": 58422017, "question_id": 58421926, "link": "https://stackoverflow.com/questions/58421926/using-chromedriver-with-google-images-download/58422017#58422017", "title": "Using Chromedriver with Google Images download", "body": "<p>There are some additional steps to take to get more than 100 images. From the <a href=\"https://google-images-download.readthedocs.io/en/latest/troubleshooting.html#installing-the-chromedriver-with-selenium\" rel=\"nofollow noreferrer\">docs</a>:</p>\n\n<blockquote>\n  <p>If you would want to download more than 100 images per keyword, then you will need to install \u2018selenium\u2019 library along with \u2018chromedriver\u2019 extension.</p>\n</blockquote>\n\n<p>And then your <code>arguments</code> will need to be updated as:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>arguments = {\"keywords\":\"foxes, shiba inu outside\",\n             \"limit\":2000,\n             \"print_urls\":True,\n             \"chromedriver\":\"/Users/jerelnovick/Desktop/Projects/Image_Recognition/chromedriver\"}\n</code></pre>\n\n<p>Also make sure the chromedriver you download is the proper one for mac.</p>\n"}], "owner": {"reputation": 23, "user_id": 11891046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc601420862b262d5236beeadfcc995?s=128&d=identicon&r=PG&f=1", "display_name": "Jerel", "link": "https://stackoverflow.com/users/11891046/jerel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2350, "favorite_count": 0, "accepted_answer_id": 58422017, "answer_count": 1, "score": 1, "last_activity_date": 1610299551, "creation_date": 1571261212, "last_edit_date": 1571565725, "question_id": 58421926, "link": "https://stackoverflow.com/questions/58421926/using-chromedriver-with-google-images-download", "title": "Using Chromedriver with Google Images download", "body": "<p>I am trying to run the following code to pull in some images:</p>\n\n<pre><code>from google_images_download import google_images_download   #importing the library\n\nresponse = google_images_download.googleimagesdownload()   #class instantiation\n\narguments = {\"keywords\":\"foxes, shiba inu outside\",\"limit\":2000,\"print_urls\":True}   #creating list of arguments\npaths = response.download(arguments)   #passing the arguments to the function\nprint(paths)   #printing absolute paths of the downloaded images\n</code></pre>\n\n<p>Because I am trying to do over 100 images I am getting a message saying </p>\n\n<blockquote>\n  <p>Looks like we cannot locate the path the 'chromedriver' (use the '--chromedriver' argument to specify the path to the executable.) or google chrome browser is not installed on your machine (exception: expected str, bytes or os.PathLike object, not NoneType)</p>\n</blockquote>\n\n<p>I am unsure how to integrate the chromedriver piece into my code and set the path.  I searched around but I cannot find a clear answer.  I tried adding the line </p>\n\n<pre><code>browser = webdriver.Chrome(executable_path=r\"/Users/jerelnovick/Desktop/Projects/Image_Recognition/chromedriver.exe\")\n</code></pre>\n\n<p>as I read in one post but that gave me a message saying </p>\n\n<blockquote>\n  <p>WebDriverException: Message: 'Image_Recognitionchromedriver.exe' executable needs to be in PATH. Please see <a href=\"https://sites.google.com/a/chromium.org/chromedriver/home\" rel=\"nofollow noreferrer\">https://sites.google.com/a/chromium.org/chromedriver/home</a></p>\n</blockquote>\n\n<p>I am using a Mac.</p>\n"}, {"tags": ["python", "pdoc"], "comments": [{"owner": {"reputation": 6802, "user_id": 9609843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9ceb913f05e91861333b367e0379a8e?s=128&d=identicon&r=PG&f=1", "display_name": "sanyassh", "link": "https://stackoverflow.com/users/9609843/sanyassh"}, "edited": false, "score": 0, "creation_date": 1571262371, "post_id": 58421891, "comment_id": 103186406, "body": "Can you please describe what do you want to achieve, i.e what is this <i>something diffferent</i>?"}, {"owner": {"reputation": 6802, "user_id": 9609843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9ceb913f05e91861333b367e0379a8e?s=128&d=identicon&r=PG&f=1", "display_name": "sanyassh", "link": "https://stackoverflow.com/users/9609843/sanyassh"}, "edited": false, "score": 0, "creation_date": 1571262412, "post_id": 58421891, "comment_id": 103186421, "body": "You want pdoc to include type hints maybe?"}, {"owner": {"reputation": 9754, "user_id": 288341, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/iSup0.jpg?s=128&g=1", "display_name": "ubiquibacon", "link": "https://stackoverflow.com/users/288341/ubiquibacon"}, "reply_to_user": {"reputation": 6802, "user_id": 9609843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9ceb913f05e91861333b367e0379a8e?s=128&d=identicon&r=PG&f=1", "display_name": "sanyassh", "link": "https://stackoverflow.com/users/9609843/sanyassh"}, "edited": false, "score": 0, "creation_date": 1571263788, "post_id": 58421891, "comment_id": 103186840, "body": "@sanyash, I added a new picture to my question to better describe what I&#39;m expecting from pdoc."}], "answers": [{"comments": [{"owner": {"reputation": 9754, "user_id": 288341, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/iSup0.jpg?s=128&g=1", "display_name": "ubiquibacon", "link": "https://stackoverflow.com/users/288341/ubiquibacon"}, "edited": false, "score": 1, "creation_date": 1571264148, "post_id": 58422317, "comment_id": 103186952, "body": "I would like to keep using the restructuredtext format.  Maybe that isn&#39;t possible."}, {"owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "reply_to_user": {"reputation": 9754, "user_id": 288341, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/iSup0.jpg?s=128&g=1", "display_name": "ubiquibacon", "link": "https://stackoverflow.com/users/288341/ubiquibacon"}, "edited": false, "score": 0, "creation_date": 1571264294, "post_id": 58422317, "comment_id": 103186993, "body": "@ubiquibacon, I am not sure on restructured text. Yo may check <a href=\"https://www.python.org/dev/peps/pep-0287/\" rel=\"nofollow noreferrer\">python.org/dev/peps/pep-0287</a>"}, {"owner": {"reputation": 9754, "user_id": 288341, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/iSup0.jpg?s=128&g=1", "display_name": "ubiquibacon", "link": "https://stackoverflow.com/users/288341/ubiquibacon"}, "edited": false, "score": 0, "creation_date": 1571264534, "post_id": 58422317, "comment_id": 103187059, "body": "I think my answer is on the <a href=\"https://pdoc3.github.io/pdoc/\" rel=\"nofollow noreferrer\">pdoc website</a>: <code>Common docstring formats: Out-of-the-box support for markdown, numpydoc, Google-style docstrings, Napoleon, and some common reST directives.</code>  Apparently &quot;some common reST directives&quot; doesn&#39;t include the ones I want to use."}], "tags": [], "owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "is_accepted": true, "score": 1, "last_activity_date": 1571264171, "last_edit_date": 1571264171, "creation_date": 1571263863, "answer_id": 58422317, "question_id": 58421891, "link": "https://stackoverflow.com/questions/58421891/method-parameters-not-formatted-correctly-in-pdoc-generated-html/58422317#58422317", "title": "Method parameters not formatted correctly in pdoc generated HTML", "body": "<p>If you are after further clarity then you may try something like below</p>\n\n<pre><code>def my_method(self, a: str = None, b: str = None) -&gt; typing.Set[str]:\n    \"\"\"\n    Do something\n\n    Args:\n        a (str): The first parameter.\n        b (str): The second parameter.\n\n    Returns:\n        Set: The return value. If result has values then Set of string, otherwise empty set.\n\n    \"\"\"\n    s._parse_hh_mm_ss_ff()\n    return {a, b}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Xh9Os.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xh9Os.png\" alt=\"when called\"></a></p>\n"}], "owner": {"reputation": 9754, "user_id": 288341, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/iSup0.jpg?s=128&g=1", "display_name": "ubiquibacon", "link": "https://stackoverflow.com/users/288341/ubiquibacon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 0, "accepted_answer_id": 58422317, "answer_count": 1, "score": 1, "last_activity_date": 1571264171, "creation_date": 1571261001, "last_edit_date": 1571263749, "question_id": 58421891, "link": "https://stackoverflow.com/questions/58421891/method-parameters-not-formatted-correctly-in-pdoc-generated-html", "title": "Method parameters not formatted correctly in pdoc generated HTML", "body": "<p>I have a method in a class defined as shown below:</p>\n\n<pre><code>def my_method(self, a: str = None, b: str = None) -&gt; typing.Set[str]:\n    \"\"\"\n    Do something\n\n    :param a: A string to represent something.\n\n    :param b: A string to represent something else.\n\n    :return: A set of strings.\n    \"\"\"\n\n    return {a, b}\n</code></pre>\n\n<p>And pdoc generates the HTML in the picture below for that method:</p>\n\n<p><a href=\"https://i.stack.imgur.com/b0gEh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/b0gEh.png\" alt=\"enter image description here\"></a></p>\n\n<p>What do I need to do to make pdoc generate something different for the <code>param</code> and <code>return</code> portions of the docstring?  Seems like <em>something</em> would be done by pdoc to differentiate params and return statements from each other in the docstring.  That something could be a highlight of the parameter and return statements, italic font, or bold font like seen below.  Whatever happens, I would like to see the text <code>:param</code> and <code>:return</code> removed from the docstring:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1MEOR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1MEOR.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["python", "list", "loops", "pdf", "pdf-generation"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 4732184, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/aef995076078c0b0c70ed5ab13d30678?s=128&d=identicon&r=PG&f=1", "display_name": "pjhollow", "link": "https://stackoverflow.com/users/4732184/pjhollow"}, "edited": false, "score": 0, "creation_date": 1571319346, "post_id": 58421939, "comment_id": 103208359, "body": "Almost works! yours splits it...but it adding/appending everything from the beginning every time it hits a match. So say there&#39;s 4 Dermatology reports. The combined report takes report (1) then adds report (1)(2), then (1)(2)(3), then reports (1)(2)(3)(4) &lt;-- (just this last iteration is what i&#39;d want) . So I end up with 10 in the bundle...not just 4. Any thoughts? Once again, thanks for looking into this to even begin with."}, {"owner": {"reputation": 3909, "user_id": 50003, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6703354d2d48c2e605bbe68ab1ff65ff?s=128&d=identicon&r=PG", "display_name": "Gnudiff", "link": "https://stackoverflow.com/users/50003/gnudiff"}, "reply_to_user": {"reputation": 85, "user_id": 4732184, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/aef995076078c0b0c70ed5ab13d30678?s=128&d=identicon&r=PG&f=1", "display_name": "pjhollow", "link": "https://stackoverflow.com/users/4732184/pjhollow"}, "edited": false, "score": 1, "creation_date": 1571329172, "post_id": 58421939, "comment_id": 103213913, "body": "@pjhollow please edit your post to include some example of actual file names with directories. You can obscure any confidential information, but I would like to see examples of directories and filenames that contain department"}, {"owner": {"reputation": 85, "user_id": 4732184, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/aef995076078c0b0c70ed5ab13d30678?s=128&d=identicon&r=PG&f=1", "display_name": "pjhollow", "link": "https://stackoverflow.com/users/4732184/pjhollow"}, "edited": false, "score": 1, "creation_date": 1573068033, "post_id": 58421939, "comment_id": 103764325, "body": "got it to work. merger.write at the end just had an extra tab in it."}], "tags": [], "owner": {"reputation": 3909, "user_id": 50003, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6703354d2d48c2e605bbe68ab1ff65ff?s=128&d=identicon&r=PG", "display_name": "Gnudiff", "link": "https://stackoverflow.com/users/50003/gnudiff"}, "is_accepted": true, "score": 1, "last_activity_date": 1573080345, "last_edit_date": 1573080345, "creation_date": 1571261316, "answer_id": 58421939, "question_id": 58421873, "link": "https://stackoverflow.com/questions/58421873/how-to-combine-append-pdfs-according-to-name-of-file/58421939#58421939", "title": "How to combine / append PDFs according to name of file?", "body": "<p>You are going through files and check, if they belong in the department.</p>\n\n<p>However, you are creating a single file_dict which keeps <em>all</em> files belonging to <em>different</em> departments instead of only files for a single department.</p>\n\n<p>You need to move merging out of the loop which assigns files to departments. A more elegant solution would match files already by department initally via glob.glob() and avoid double looping, but that would also mean some rewrite.</p>\n\n<p>The simplest way to change your existing code (but it could be improved):</p>\n\n<pre><code>file_dict={ dept:{} for dept in department_list } # seed file_dict with departments\nfor subdir, dirs, files in os.walk(\"C:/Users/username/Documents/Tests\"):\n    for file in files:\n        filepath = os.path.join(subdir,file) # note changed check\n        for dept in department_list: \n            if dept in filepath: #note changed from __contains__. Usually you needn't call __ funcs in your code\n                file_dict[dept][file] = filepath\n\nfor dept in department_list:\n    merger = PdfFileMerger(strict=False)\n    for k, v in file_dict[dept].items():\n       print(k, v)\n       merger.append(v)\n    merger.write(dept + ' combined_result.pdf')\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 4732184, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/aef995076078c0b0c70ed5ab13d30678?s=128&d=identicon&r=PG&f=1", "display_name": "pjhollow", "link": "https://stackoverflow.com/users/4732184/pjhollow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 58421939, "answer_count": 1, "score": 0, "last_activity_date": 1573080345, "creation_date": 1571260921, "last_edit_date": 1571262098, "question_id": 58421873, "link": "https://stackoverflow.com/questions/58421873/how-to-combine-append-pdfs-according-to-name-of-file", "title": "How to combine / append PDFs according to name of file?", "body": "<p>I have a bunch of files that all start with department name. I want to have one file for each department, so instead of 4 anesthesia files and  4 dermatology files, I have 1 big files of anesthesia and 1 big file of dermatology.</p>\n\n<p>Right now the code below will know how to make two files. But not know when to properly stop appending one department and start a new department. I get two files right now. One that has all of Anesthesia (and looks good) and stops. And one file of Dermatology, but it contains both the anesthesia files and derm files. </p>\n\n<p>Is there a way to restart the append start point in my loops. I apologize, I'm not very good at lists/loops here:</p>\n\n<pre><code>import os\nfrom PyPDF2 import PdfFileMerger\n\n\ndepartment_list =['Anesthesiology','Dermatology']\nfile_dict = {}\nfor subdir, dirs, files in os.walk(\"C:/Users/username/Documents/Tests\"):\n    for file in files:\n        filepath = subdir + os.sep + file\n        for dept in department_list:\n            if filepath.__contains__(dept):\n                file_dict[file] = filepath\n                merger = PdfFileMerger(strict=False)\n                for k, v in file_dict.items():\n                    print(k, v)\n                    merger.append(v)\n                    merger.write(dept + ' combined_result.pdf')\n</code></pre>\n"}, {"tags": ["python", "pandas", "dataframe"], "comments": [{"owner": {"reputation": 462, "user_id": 12081954, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCny9pyWN5BhoN3035PNaRoL0JGqksQg8yvRcP-kQ=k-s128", "display_name": "mayosten", "link": "https://stackoverflow.com/users/12081954/mayosten"}, "edited": false, "score": 0, "creation_date": 1571261243, "post_id": 58421837, "comment_id": 103186047, "body": "have you tried <code>df[&#39;a&#39;].apply(lambda x: &#39;abc&#39; in x)</code>? <code>apply</code> is what you want to use for a series."}, {"owner": {"reputation": 462, "user_id": 12081954, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCny9pyWN5BhoN3035PNaRoL0JGqksQg8yvRcP-kQ=k-s128", "display_name": "mayosten", "link": "https://stackoverflow.com/users/12081954/mayosten"}, "edited": false, "score": 0, "creation_date": 1571261326, "post_id": 58421837, "comment_id": 103186082, "body": "or just <code>df[&#39;a&#39;].str.contains(&#39;abc&#39;)</code>"}, {"owner": {"reputation": 1661, "user_id": 1927583, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fc9a6c4f6d819f019db6d48264f47dae?s=128&d=identicon&r=PG", "display_name": "ba_ul", "link": "https://stackoverflow.com/users/1927583/ba-ul"}, "edited": false, "score": 1, "creation_date": 1571261575, "post_id": 58421837, "comment_id": 103186162, "body": "You have <code>None</code> values in <code>df[a]</code>, which are causing the problem. The solutions suggested will work, but note that <code>df[b]</code> will be <code>None</code> when <code>df[a]</code> is <code>None</code>. If that&#39;s not something you like, you can first replace all the <code>None</code> values in <code>df[a]</code> with empty string."}, {"owner": {"reputation": 711, "user_id": 10734880, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VqInoFdU3M8/AAAAAAAAAAI/AAAAAAAAAA4/KLtzLyk_ZJ0/photo.jpg?sz=128", "display_name": "Nick Martin", "link": "https://stackoverflow.com/users/10734880/nick-martin"}, "edited": false, "score": 0, "creation_date": 1571261681, "post_id": 58421837, "comment_id": 103186184, "body": "<code>df[&#39;a&#39;].apply(lambda x: &#39;abc&#39; in x)</code> wont work, <code>df[&#39;b&#39;] = df.apply(lambda x: x.str.contains(&#39;abc&#39;), axis=1)</code> will if you want to use <code>apply</code>, but your answer is the &quot;cleanest&quot; method"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 8809728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac04385dae7414761c82c544b3c3b0b?s=128&d=identicon&r=PG&f=1", "display_name": "just4lizzy", "link": "https://stackoverflow.com/users/8809728/just4lizzy"}, "edited": false, "score": 0, "creation_date": 1571282266, "post_id": 58421944, "comment_id": 103190708, "body": "thanks! So in an earlier step, i had converted the empty strings to None for them to properly be treated as nulls. Is it better to keep them as empty strings? or converted those None back to empty strings just for that column?"}, {"owner": {"reputation": 1435, "user_id": 3866678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7yZyO.png?s=128&g=1", "display_name": "Michael Gardner", "link": "https://stackoverflow.com/users/3866678/michael-gardner"}, "reply_to_user": {"reputation": 95, "user_id": 8809728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac04385dae7414761c82c544b3c3b0b?s=128&d=identicon&r=PG&f=1", "display_name": "just4lizzy", "link": "https://stackoverflow.com/users/8809728/just4lizzy"}, "edited": false, "score": 1, "creation_date": 1571283721, "post_id": 58421944, "comment_id": 103191030, "body": "@just4lizzy If you convert empty strings to null you want to use <code>np.nan</code> and not <code>None</code>.  <code>np.nan</code> allows for vectorized operations; its a float value, while <code>None</code>, by definition, forces object type, which basically disables all efficiency in numpy."}], "tags": [], "owner": {"reputation": 2389, "user_id": 7348030, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7PmbNFJwfPc/AAAAAAAAAAI/AAAAAAAAAJE/5lDuTFQtNpQ/photo.jpg?sz=128", "display_name": "Florian Bernard", "link": "https://stackoverflow.com/users/7348030/florian-bernard"}, "is_accepted": false, "score": 4, "last_activity_date": 1571261724, "last_edit_date": 1571261724, "creation_date": 1571261337, "answer_id": 58421944, "question_id": 58421837, "link": "https://stackoverflow.com/questions/58421837/create-new-pandas-dataframe-column-containing-boolean-output-from-searching-for/58421944#58421944", "title": "Create new pandas dataframe column containing boolean output from searching for substrings", "body": "<p>This how to do it.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>df[\"b\"] = df[\"a\"].str.contains(\"abc\")\n</code></pre>\n\n<p>Regarding your error.</p>\n\n<p>It's seems that you have np.nan value in your column a, then the method str.contain will return np.nan for those value, as you try to index with an array containing np.nan value, pandas tell you that is not possible. </p>\n"}, {"tags": [], "owner": {"reputation": 598, "user_id": 8333806, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbIJB.jpg?s=128&g=1", "display_name": "abdoulsn", "link": "https://stackoverflow.com/users/8333806/abdoulsn"}, "is_accepted": false, "score": 0, "last_activity_date": 1571262368, "creation_date": 1571262368, "answer_id": 58422089, "question_id": 58421837, "link": "https://stackoverflow.com/questions/58421837/create-new-pandas-dataframe-column-containing-boolean-output-from-searching-for/58422089#58422089", "title": "Create new pandas dataframe column containing boolean output from searching for substrings", "body": "<p>Your first code is ok, here is the output on my sample.</p>\n\n<pre><code>s = pd.Series(['cat','hat','dog','fog','pet'])\nd = pd.DataFrame(s, columns=['test'])\nd['b'] = d['test'].map(lambda x: True if 'og' in x else False)\nd\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Bayg1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Bayg1.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1435, "user_id": 3866678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7yZyO.png?s=128&g=1", "display_name": "Michael Gardner", "link": "https://stackoverflow.com/users/3866678/michael-gardner"}, "is_accepted": true, "score": 2, "last_activity_date": 1571263669, "last_edit_date": 1571263669, "creation_date": 1571263299, "answer_id": 58422239, "question_id": 58421837, "link": "https://stackoverflow.com/questions/58421837/create-new-pandas-dataframe-column-containing-boolean-output-from-searching-for/58422239#58422239", "title": "Create new pandas dataframe column containing boolean output from searching for substrings", "body": "<p>Not the best solution but you can check for null values with <code>pd.isnull()</code> or convert null values to a string with <code>str()</code>.</p>\n\n<pre><code>df = pd.DataFrame({'a':['zabc', None, 'abcy', 'defg']})\n\n\ndf['a'].map(lambda x: True if 'abc' in str(x) else False)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>df['a'].map(lambda x: False if pd.isnull(x) or 'abc' not in x else True)\n</code></pre>\n\n<p>Reuslt:</p>\n\n<pre><code>    0     True\n    1    False\n    2     True\n    3    False\n    Name: a, dtype: bool\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 8809728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac04385dae7414761c82c544b3c3b0b?s=128&d=identicon&r=PG&f=1", "display_name": "just4lizzy", "link": "https://stackoverflow.com/users/8809728/just4lizzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1195, "favorite_count": 0, "accepted_answer_id": 58422239, "answer_count": 3, "score": 0, "last_activity_date": 1571263669, "creation_date": 1571260691, "question_id": 58421837, "link": "https://stackoverflow.com/questions/58421837/create-new-pandas-dataframe-column-containing-boolean-output-from-searching-for", "title": "Create new pandas dataframe column containing boolean output from searching for substrings", "body": "<p>I'd like to create a new column where if a substring is found in an existing column, it will return True and vice versa. </p>\n\n<p>So in this example, I'd like to search for the substring \"abc\" in column a and create a Boolean column b whether column a contained the string or not.</p>\n\n<pre><code>a      b\nzabc   True\nwxyz   False\nabcy   True\ndefg   False\n</code></pre>\n\n<p>I've tried something like</p>\n\n<pre><code>df['b'] = df['a'].map(lambda x: True if 'abc' in x else False)\n</code></pre>\n\n<p>But this gave me an error saying \"argument of type 'NoneType' is not iterable\"</p>\n\n<p>I also tried</p>\n\n<pre><code>df['b'] = False\ndf['b'][df['a'].str.contains('abc')] = True\n</code></pre>\n\n<p>But I got the error \"cannot index with vector containing NA / NaN values\"</p>\n\n<p>Can someone explain the errors and what I can do about it. I have confirmed that ['a'] exists and contains values. But there are rows that contain None values.</p>\n"}, {"tags": ["python"], "answers": [{"tags": [], "owner": {"reputation": 4859, "user_id": 7431860, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/P6Jko.jpg?s=128&g=1", "display_name": "Nick Reed", "link": "https://stackoverflow.com/users/7431860/nick-reed"}, "is_accepted": false, "score": 0, "last_activity_date": 1571260564, "creation_date": 1571260564, "answer_id": 58421825, "question_id": 58421800, "link": "https://stackoverflow.com/questions/58421800/how-can-i-add-an-exit-for-users-with-int-inputs/58421825#58421825", "title": "How can I add an exit for users with int inputs", "body": "<p>You can first get the user's input into a variable, like with <code>inStr = input('Enter input: ')</code>. Then, you can check it to see if it's <code>'x'</code>; if it is, you can use <code>sys.exit()</code> (or some other function), and if it's not, you can then cast it to a number and use it. <code>inNum = int(inStr)</code></p>\n\n<p>By checking the variable first and <em>then</em> casting it, you don't have to worry about what happens if your code tries to run <code>int('x')</code>. </p>\n\n<p>If you really want to cast your input to <code>int</code> right away, though, <a href=\"https://stackoverflow.com/a/8075959/7431860\">you can use <code>try</code> and <code>except</code> to catch a <code>ValueError</code>,</a> which is what <code>int()</code> will throw if you give it a non-number input. This won't specifically check for <code>'x'</code> - just for some invalid input.</p>\n"}, {"tags": [], "owner": {"reputation": 4057, "user_id": 8285811, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C38qo.jpg?s=128&g=1", "display_name": "Akaisteph7", "link": "https://stackoverflow.com/users/8285811/akaisteph7"}, "is_accepted": true, "score": 0, "last_activity_date": 1571261040, "creation_date": 1571261040, "answer_id": 58421897, "question_id": 58421800, "link": "https://stackoverflow.com/questions/58421800/how-can-i-add-an-exit-for-users-with-int-inputs/58421897#58421897", "title": "How can I add an exit for users with int inputs", "body": "<p>Just use a <code>try</code> block to see whether the input is a number and change what you do. Something like this:</p>\n\n<pre><code>is_int = false\nuser_ans = input()\n\ntry: \n  ans_int = int(user_ans)\n  is_int = true\nexcept:\n  is_int = false\n\nif is_int:\n  # Do what you need with the integer\n  if ans_int == 1:\n    solution = number_one + number_two\n    print(\"What is\", number_one, \"plus\", number_two)\n    user_ans = int(input())\nelif user_ans == solution:\n  print(\"Correct\")\n  number_one = random.randrange(1,10)\n  number_two = random.randrange(1,10)\n  rounds = rounds + 1\nelif user_ans == \"x\":\n  # Do what you need to do if it is an \"x\"\nelse:\n   print(\"Try again\")\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11531120, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bVKnlhKSHyk/AAAAAAAAAAI/AAAAAAAAAKc/LQq_gcYDlJ0/photo.jpg?sz=128", "display_name": "Ben Jones", "link": "https://stackoverflow.com/users/11531120/ben-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 58421897, "answer_count": 2, "score": 0, "last_activity_date": 1571261040, "creation_date": 1571260445, "question_id": 58421800, "link": "https://stackoverflow.com/questions/58421800/how-can-i-add-an-exit-for-users-with-int-inputs", "title": "How can I add an exit for users with int inputs", "body": "<p>I need users to be able to type x to exit if they get a question wrong.</p>\n\n<p>I've tried changing the input to a string and then if the answer isn't x then convert the string to an integer with int(user_ans) and even making another value and with ans_string == int(user_ans).  Is there any way to add a break to the end if they type x?</p>\n\n<pre><code>if level == 1:\n    solution = number_one + number_two\n    print(\"What is\", number_one, \"plus\", number_two)\n    user_ans = int(input())\n\nif user_ans == solution:\n    print(\"Correct\")\n    number_one = random.randrange(1,10)\n    number_two = random.randrange(1,10)\n    rounds = rounds + 1\nelse:\n    print(\"Try again\")\n</code></pre>\n\n<p>I expect the program to still function but also be for the user to quit.</p>\n"}, {"tags": ["python", "function", "csv"], "comments": [{"owner": {"reputation": 4057, "user_id": 8285811, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C38qo.jpg?s=128&g=1", "display_name": "Akaisteph7", "link": "https://stackoverflow.com/users/8285811/akaisteph7"}, "reply_to_user": {"reputation": 4859, "user_id": 7431860, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/P6Jko.jpg?s=128&g=1", "display_name": "Nick Reed", "link": "https://stackoverflow.com/users/7431860/nick-reed"}, "edited": false, "score": 0, "creation_date": 1571261167, "post_id": 58421748, "comment_id": 103186014, "body": "@NickReed That&#39;s not how that works.."}, {"owner": {"reputation": 37, "user_id": 12090938, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AmDyYOAsopw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfZpMHYh3NSlrJ-wEAMLLbCJxeu6g/photo.jpg?sz=128", "display_name": "Keshab Gautam", "link": "https://stackoverflow.com/users/12090938/keshab-gautam"}, "reply_to_user": {"reputation": 4057, "user_id": 8285811, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C38qo.jpg?s=128&g=1", "display_name": "Akaisteph7", "link": "https://stackoverflow.com/users/8285811/akaisteph7"}, "edited": false, "score": 0, "creation_date": 1571414246, "post_id": 58421748, "comment_id": 103246102, "body": "Hey guys, on the code above if i want to employ a dictionary and combine those two code together how would i go about it, also the two functions are almost identical, is there a way to add argument in the function and just make it one"}], "answers": [{"tags": [], "owner": {"reputation": 4057, "user_id": 8285811, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C38qo.jpg?s=128&g=1", "display_name": "Akaisteph7", "link": "https://stackoverflow.com/users/8285811/akaisteph7"}, "is_accepted": false, "score": 0, "last_activity_date": 1572580396, "last_edit_date": 1572580396, "creation_date": 1571260412, "answer_id": 58421793, "question_id": 58421748, "link": "https://stackoverflow.com/questions/58421748/why-is-my-second-function-not-returning-anything/58421793#58421793", "title": "Why is my second function not returning anything?", "body": "<p>File readers don't work quite the way you think. Once you open and read through the contents of the file, you cannot automatically go over them again. So, these lines:</p>\n\n<pre><code>f = open('C:\\\\Users\\\\keshabg\\\\Desktop\\\\sql_testing\\\\table_1.csv')\ncsv_f = csv.reader(f)\n</code></pre>\n\n<p>create a file reader that iterates over the contents of the file once. If you want to do that various times, you should probably just store the file's content in an array first, then iterate over that.</p>\n"}, {"tags": [], "owner": {"reputation": 620, "user_id": 6800111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ppGib.jpg?s=128&g=1", "display_name": "tjholub", "link": "https://stackoverflow.com/users/6800111/tjholub"}, "is_accepted": true, "score": 1, "last_activity_date": 1571260431, "creation_date": 1571260431, "answer_id": 58421797, "question_id": 58421748, "link": "https://stackoverflow.com/questions/58421748/why-is-my-second-function-not-returning-anything/58421797#58421797", "title": "Why is my second function not returning anything?", "body": "<p>You need to reset your file pointer. Try this before running the 2nd function:</p>\n\n<pre><code>f.seek(0)\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 12090938, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AmDyYOAsopw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfZpMHYh3NSlrJ-wEAMLLbCJxeu6g/photo.jpg?sz=128", "display_name": "Keshab Gautam", "link": "https://stackoverflow.com/users/12090938/keshab-gautam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 58421797, "answer_count": 2, "score": 1, "last_activity_date": 1572580396, "creation_date": 1571260207, "last_edit_date": 1571260599, "question_id": 58421748, "link": "https://stackoverflow.com/questions/58421748/why-is-my-second-function-not-returning-anything", "title": "Why is my second function not returning anything?", "body": "<p>My first function gives me the desired result but the 2nd function just gives me an empty list just as I made it. But if I comment out the first function and just run the 2nd function it works. What am I doing wrong? </p>\n\n<pre><code>import csv\n\nf = open('C:\\\\Users\\\\keshabg\\\\Desktop\\\\sql_testing\\\\table_1.csv')\ncsv_f = csv.reader(f)\n\ndef units_by_level():\n    lev1=[]\n    lev2=[]\n    lev3=[]\n    lev4=[]\n    lev5=[]\n    for row in csv_f:\n        if row[4]=='Level 1':\n           lev1.append(row[5]) \n        if row[4]=='Level 2':\n            lev2.append(row[5])\n        if row[4]=='Level 3':\n            lev3.append(row[5])\n        if row[4]=='Level 4':\n            lev4.append(row[5])\n        if row[4]=='Level 5':\n            lev5.append(row[5])\n    return lev1,lev2,lev3,lev4,lev5   \n\na=units_by_level()\nprint(\"Level 1:\",a[0],\"Level 2:\",a[1],\"Level 3:\",a[2],\"Level 4:\",a[3],\"Level 5:\",a[4])\n\n\ndef hours_by_level():\n    lev1=[]\n    lev2=[]\n    lev3=[]\n    lev4=[]\n    lev5=[]\n    for row in csv_f:\n        if row[4]=='Level 1':\n            lev1.append(row[6])\n\n        if row[4]=='Level 2':\n            lev2.append(row[6])\n        if row[4]=='Level 3':\n            lev3.append(row[6])\n        if row[4]=='Level 4':\n            lev4.append(row[6])\n        if row[4]=='Level 5':\n            lev5.append(row[6])\n    return lev1,lev2,lev3,lev4,lev5\n\n\n\nb=hours_by_level()\nprint(\"Level 1:\",b[0],\"Level 2:\",b[1],\"Level 3:\",b[2],\"Level 4:\",b[3],\"Level 5:\",b[4])\n</code></pre>\n"}, {"tags": ["python", "python-3.x", "pandas", "nltk"], "comments": [{"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 1, "creation_date": 1571260305, "post_id": 58421737, "comment_id": 103185692, "body": "Welcome to StackOverflow. Please read and follow the posting guidelines in the help documentation, as suggested when you created this account. <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">Minimal, complete, verifiable example</a> applies here. We cannot effectively help you until you post your MCVE code and accurately specify the problem. We should be able to paste your posted code into a text file and reproduce the problem you specified."}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 8472226, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/ffb2a081b2dc65a17ee0217315193c0f?s=128&d=identicon&r=PG", "display_name": "Yaroslav", "link": "https://stackoverflow.com/users/8472226/yaroslav"}, "edited": false, "score": 0, "creation_date": 1571264289, "post_id": 58421966, "comment_id": 103186991, "body": "Thanks a lot!!!! Right! As always, I got confused in indexes)"}], "tags": [], "owner": {"reputation": 683, "user_id": 11220780, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ubIXaw71rPY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reTNbPdx6BDLRY2TCGVZDXEhNhHWQ/mo/photo.jpg?sz=128", "display_name": "Benoit de Menthi&#232;re", "link": "https://stackoverflow.com/users/11220780/benoit-de-menthi%c3%a8re"}, "is_accepted": false, "score": 1, "last_activity_date": 1571262552, "last_edit_date": 1571262552, "creation_date": 1571261484, "answer_id": 58421966, "question_id": 58421737, "link": "https://stackoverflow.com/questions/58421737/keyerror-1-2-not-in-index-in-pandas/58421966#58421966", "title": "KeyError: &#39;[1 2] not in index&#39; in Pandas", "body": "<p>I guess what you want is </p>\n\n<p><code>dataset = dataset.iloc[:,[1, 2]]</code></p>\n\n<p>which select 2nd and 3rd columns?</p>\n"}], "owner": {"reputation": 77, "user_id": 8472226, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/ffb2a081b2dc65a17ee0217315193c0f?s=128&d=identicon&r=PG", "display_name": "Yaroslav", "link": "https://stackoverflow.com/users/8472226/yaroslav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1571262552, "creation_date": 1571260151, "last_edit_date": 1571260973, "question_id": 58421737, "link": "https://stackoverflow.com/questions/58421737/keyerror-1-2-not-in-index-in-pandas", "title": "KeyError: &#39;[1 2] not in index&#39; in Pandas", "body": "<p>I'm trying to tokenize reviews (good and bad), but Pandas crashes with KeyError error: \"[1 2] not in index\". <a href=\"https://i.stack.imgur.com/BgVdc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BgVdc.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is my code:</p>\n\n<pre><code>from nltk.tokenize import RegexpTokenizer\nfrom nltk.corpus import stopwords\nfrom pymorphy2 import tokenizers\nimport nltk, string, json, pymorphy2\nimport pandas as pd\n\np_data = pd.read_json(open('C:\\\\Creme\\\\good.json'))\nn_data = pd.read_json(open('C:\\\\Creme\\\\bad.json'))\n\ndataset = pd.concat([p_data, n_data])\ndataset = dataset[[1, 2]]\n\ndataset.columns = ['text', 'label']\n\nmorph = pymorphy2.MorphAnalyzer()\n\ndef tokenize_me(file_text):\n    file_text = file_text.lower()\n    tokens = tokenizers.simple_word_tokenize(file_text)\n\n    tokens = [morph.parse(w)[0].normal_form for w in tokens]\n\n    #deleting punctuation symbols\n    tokens = [i for i in tokens if (i not in string.punctuation)]\n\n    #deleting stop_words\n    stop_words = stopwords.words('russian')\n    stop_words.extend(['\u0447\u0442\u043e', '\u044d\u0442\u043e', '\u0442\u0430\u043a', '\u0432\u043e\u0442', '\u0431\u044b\u0442\u044c', '\u043a\u0430\u043a', '\u0432', '\u2014', '\u043a', '\u043d\u0430', '...'])\n    tokens = [i for i in tokens if (i not in stop_words)]\n\n    return ' '.join(tokens)\n\ndataset['text'] = dataset['text'].apply(tokenize_me)\ndataset.to_csv('C:\\\\Creme\\\\cleaned_data2.csv')\n</code></pre>\n\n<p>Help me fix the error and fix the code.</p>\n"}, {"tags": ["python", "pandas", "dataframe"], "answers": [{"tags": [], "owner": {"reputation": 614, "user_id": 1072246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b7fe892ad6e2a6ee00ae845906e7053?s=128&d=identicon&r=PG", "display_name": "rcriii", "link": "https://stackoverflow.com/users/1072246/rcriii"}, "is_accepted": true, "score": 2, "last_activity_date": 1571261187, "creation_date": 1571261187, "answer_id": 58421924, "question_id": 58421731, "link": "https://stackoverflow.com/questions/58421731/finding-pairs-of-rows-with-matching-column-sub-strings-in-pandas-dataframe/58421924#58421924", "title": "Finding pairs of rows with matching column sub-strings in pandas dataframe", "body": "<p>You can use <a href=\"https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.split.html\" rel=\"nofollow noreferrer\">pandas.Series.str.split</a>, and <a href=\"https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html\" rel=\"nofollow noreferrer\">pandas.groupby</a>:</p>\n\n<pre><code>In [10]: df = pd.DataFrame({'log':['Device remove ID#xxx',\n    ...:                           'Device remove ID#yyy',\n    ...:                           'Device remove ID#zzz',\n    ...:                           'Device arrive ID#xxx',\n    ...:                           'Device arrive ID#yyy',\n    ...:                           'Device arrive ID#zzz',],\n                            'other_row':[1,2,3,42,54,6]})\n\nIn [11]: df\nOut[11]:\n                    log  other_row\n0  Device remove ID#xxx          1\n1  Device remove ID#yyy          2\n2  Device remove ID#zzz          3\n3  Device arrive ID#xxx         42\n4  Device arrive ID#yyy         54\n5  Device arrive ID#zzz          6\n\nIn [14]: df_splits = df['log'].str.split(expand=True)\n\nIn [16]: df['action'] = df_splits[1]\n\nIn [17]: df['user'] = df_splits[2]\n\nIn [18]: df\nOut[18]:\n                    log  other_row  action    user\n0  Device remove ID#xxx          1  remove  ID#xxx\n1  Device remove ID#yyy          2  remove  ID#yyy\n2  Device remove ID#zzz          3  remove  ID#zzz\n3  Device arrive ID#xxx         42  arrive  ID#xxx\n4  Device arrive ID#yyy         54  arrive  ID#yyy\n5  Device arrive ID#zzz          6  arrive  ID#zzz\n\n\nIn [22]: for i, d in df.groupby('user'):\n    ...:     print i\n    ...:     print d\n    ...:     print d['other_row'].sum()\n    ...:     print\n    ...:\n    ...:\nID#xxx\n                    log  other_row  action    user\n0  Device remove ID#xxx          1  remove  ID#xxx\n3  Device arrive ID#xxx         42  arrive  ID#xxx\n43\n\nID#yyy\n                    log  other_row  action    user\n1  Device remove ID#yyy          2  remove  ID#yyy\n4  Device arrive ID#yyy         54  arrive  ID#yyy\n56\n\nID#zzz\n                    log  other_row  action    user\n2  Device remove ID#zzz          3  remove  ID#zzz\n5  Device arrive ID#zzz          6  arrive  ID#zzz\n9\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314, "user_id": 11506290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MFgsr.jpg?s=128&g=1", "display_name": "Nicko", "link": "https://stackoverflow.com/users/11506290/nicko"}, "is_accepted": false, "score": 0, "last_activity_date": 1571261324, "creation_date": 1571261324, "answer_id": 58421940, "question_id": 58421731, "link": "https://stackoverflow.com/questions/58421731/finding-pairs-of-rows-with-matching-column-sub-strings-in-pandas-dataframe/58421940#58421940", "title": "Finding pairs of rows with matching column sub-strings in pandas dataframe", "body": "<p>If you need to keep the original column and just want to sort on the last 3 characters, you can create a separate column just for this purpose.  </p>\n\n<pre><code>df1['group'] = df1['log_text'].str[-3::]\n</code></pre>\n\n<p>This will create a copy of the 'log_text' column but only keep the last three characters.</p>\n"}, {"tags": [], "owner": {"reputation": 17765, "user_id": 9375102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8yBw3.jpg?s=128&g=1", "display_name": "Umar.H", "link": "https://stackoverflow.com/users/9375102/umar-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1571262434, "last_edit_date": 1571262434, "creation_date": 1571261426, "answer_id": 58421957, "question_id": 58421731, "link": "https://stackoverflow.com/questions/58421731/finding-pairs-of-rows-with-matching-column-sub-strings-in-pandas-dataframe/58421957#58421957", "title": "Finding pairs of rows with matching column sub-strings in pandas dataframe", "body": "<p>IIUC, </p>\n\n<p>I think you can use <code>.str.count</code> and <code>.loc</code> to do further operations </p>\n\n<p>for example: </p>\n\n<pre><code>rows_to_filter = ['Device remove ID#xxx','Device remove ID#yyy',\n'Device remove ID#zzz','Device arrive ID#xxx',\n'Device arrive ID#yyy','Device arrive ID#zzz']\n\ndf.loc[df['log_text'].str.count('|'.join(rows_to_filter)) &gt; 1, 'col'] = 'do something'\n</code></pre>\n\n<p>This will return a dataframe slice with anything with more than one occurance of your list above in any given row, you might need to tinker around with the logic as I'm not 100% what you need without a sample output. </p>\n"}], "owner": {"reputation": 83, "user_id": 718005, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4dd6e4faec434e7289c536b041d1ef72?s=128&d=identicon&r=PG", "display_name": "Liz Z", "link": "https://stackoverflow.com/users/718005/liz-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 58421924, "answer_count": 3, "score": 0, "last_activity_date": 1571321639, "creation_date": 1571260135, "last_edit_date": 1571321639, "question_id": 58421731, "link": "https://stackoverflow.com/questions/58421731/finding-pairs-of-rows-with-matching-column-sub-strings-in-pandas-dataframe", "title": "Finding pairs of rows with matching column sub-strings in pandas dataframe", "body": "<p>I have a dataframe with several columns. One of them is named <code>'log_text'.</code>  I want to find pairs of rows that have matching strings in this column.</p>\n\n<p>For example, if <code>'log_text'</code> has these strings</p>\n\n<pre><code> Device remove ID#xxx  \n Device remove ID#yyy  \n Device remove ID#zzz  \n Device arrive ID#xxx  \n Device arrive ID#yyy \n Device arrive ID#zzz \n</code></pre>\n\n<p>Goal:\nI would like to get the rows containing <code>'Device remove ID#xxx'</code> and <code>'Device arrive ID#xxx'</code> and be able to do stuff with their other columns, then repeat this for rows containing <code>'Device remove ID#yyy'</code> and <code>'Device arrive ID#yyy'</code>, etc.</p>\n\n<p>What I've tried is using <code>iterrows()</code>, find the <code>ID#</code> of the current row, drop that row from the table, and find the first row that contains the matching ID# string.</p>\n\n<pre><code>    for index, row in temp_df.iterrows():\n        log_string = row['log_text']\n        id_text = log_string.partition(\"ID#\")[2]\n        temp_df.drop(row)\n        match = temp_df[temp_df['log_text'].str.contains(id_text)]\n        # Somehow stash the 2 rows together somewhere? \n            # like stash[index,1] = row; stash[index,2] = match;\n        temp_df.drop(match)\n</code></pre>\n"}, {"tags": ["python", "django", "django-models"], "comments": [{"owner": {"reputation": 2324, "user_id": 6144626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w5zgz.jpg?s=128&g=1", "display_name": "Ari Cooper-Davis", "link": "https://stackoverflow.com/users/6144626/ari-cooper-davis"}, "edited": false, "score": 0, "creation_date": 1571261056, "post_id": 58421665, "comment_id": 103185973, "body": "What is the code supposed to do? It might be helpful if you could go over <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask the perfect question</a> and try to follow some of the steps to make it easier for us to help you :-)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11545851, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-r8y0ndU5_rY/AAAAAAAAAAI/AAAAAAAAAu8/bW_Vfjl4SO0/photo.jpg?sz=128", "display_name": "Martin", "link": "https://stackoverflow.com/users/11545851/martin"}, "edited": false, "score": 0, "creation_date": 1571263376, "post_id": 58421734, "comment_id": 103186725, "body": "I&#39;m getting an error saying:  IntegrityError at /accounts/profile/ NOT NULL constraint failed: accounts_profile.user_id  do you know what it means?"}, {"owner": {"reputation": 8696, "user_id": 10746224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/znUL5.jpg?s=128&g=1", "display_name": "Lord Elrond", "link": "https://stackoverflow.com/users/10746224/lord-elrond"}, "reply_to_user": {"reputation": 1, "user_id": 11545851, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-r8y0ndU5_rY/AAAAAAAAAAI/AAAAAAAAAu8/bW_Vfjl4SO0/photo.jpg?sz=128", "display_name": "Martin", "link": "https://stackoverflow.com/users/11545851/martin"}, "edited": false, "score": 0, "creation_date": 1571263922, "post_id": 58421734, "comment_id": 103186881, "body": "@Martin yeah, sorry.  I added an update that should explain it and fix the problem."}, {"owner": {"reputation": 1, "user_id": 11545851, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-r8y0ndU5_rY/AAAAAAAAAAI/AAAAAAAAAu8/bW_Vfjl4SO0/photo.jpg?sz=128", "display_name": "Martin", "link": "https://stackoverflow.com/users/11545851/martin"}, "edited": false, "score": 0, "creation_date": 1571304393, "post_id": 58421734, "comment_id": 103199338, "body": "Sorry, I&#39;m really new to this, I updated the code, but it still doesn&#39;t work. The View sends me to profile.html where I can see and fill out the form and when I submit the form it sends me back to the homepage without error. But it still doesn&#39;t update the profile. (I added print and some of the command-line so you can see)"}], "tags": [], "owner": {"reputation": 8696, "user_id": 10746224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/znUL5.jpg?s=128&g=1", "display_name": "Lord Elrond", "link": "https://stackoverflow.com/users/10746224/lord-elrond"}, "is_accepted": false, "score": 0, "last_activity_date": 1571263902, "last_edit_date": 1571263902, "creation_date": 1571260143, "answer_id": 58421734, "question_id": 58421665, "link": "https://stackoverflow.com/questions/58421665/trying-to-update-a-user-profile-in-django/58421734#58421734", "title": "Trying to update a user profile in django", "body": "<p>You should save the model using the form instead:</p>\n\n<pre><code>@login_required\ndef profile_update(request):\n    user = request.user\n    form = ProfileUpdateForm(request.POST or None, initial={'profile_image': user.profile.profile_image,\n                                                      'portfolio_site': user.profile.portfolio_site})\n    if request.method == 'POST':\n        if form.is_valid():\n            form.save()\n            return HttpResponseRedirect(reverse('home'))\n        else:\n            print(\"Fist me daddy!\")\n    else:\n        print(request.method)\n    context = {\n        \"profile_updateform\":form,\n    }\n    return render(request, 'profile.html', context)\n</code></pre>\n\n<h2>Update</h2>\n\n<p>When you call <code>form.save()</code>, the form object attempts to update the existing model if you have an instance defined, otherwise it tries to create one; since you are manually adding data using <code>initial</code>, the form is trying to a create a new <code>Profile</code> row in your database, but it doesn't have the required <code>user_id</code> (which is the <code>user</code> field), and throws that error.  To fix this, you should use <code>instance</code> in your form instead of <code>initial</code>:</p>\n\n<pre><code>form = ProfileUpdateForm(request.POST or None, instance=user.profile)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11545851, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-r8y0ndU5_rY/AAAAAAAAAAI/AAAAAAAAAu8/bW_Vfjl4SO0/photo.jpg?sz=128", "display_name": "Martin", "link": "https://stackoverflow.com/users/11545851/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 347, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571309329, "creation_date": 1571259728, "last_edit_date": 1592644375, "question_id": 58421665, "link": "https://stackoverflow.com/questions/58421665/trying-to-update-a-user-profile-in-django", "title": "Trying to update a user profile in django", "body": "<p>I would like it to be possible to update the portfolie_site field and the profile_image, so I created the ProfileUpdateForm but I'm having problems saving the inputs</p>\n<p>I would love some help, I have no idea what I'm doing. :)</p>\n<h1>Update!</h1>\n<h3>NOW: So I can update the urlfield, but not the imagefield</h3>\n<p>I updated the code and added print to see more clearly what is happening.\nThis is what I'm getting in the command-line now:</p>\n<h3>Command-line</h3>\n<pre><code>GET profile.html\n[17/Oct/2019 11:12:51] &quot;GET /accounts/profile/ HTTP/1.1&quot; 200 1600\nPOST sending you back HOME\n[17/Oct/2019 11:12:59] &quot;POST /accounts/profile/ HTTP/1.1&quot; 302 0\n[17/Oct/2019 11:12:59] &quot;GET / HTTP/1.1&quot; 200 1100\n</code></pre>\n<h1>Models.py</h1>\n<pre><code>class Profile(models.Model):\n    user = models.OneToOneField(User, on_delete=models.CASCADE)\n    portfolio_site = models.URLField(blank=True)\n    profile_image = models.ImageField(upload_to='swap_me/profile_image',blank=True)\n    def __str__(self):\n        return self.user.username\n</code></pre>\n<h1>Forms.py</h1>\n<pre><code>class ProfileUpdateForm(forms.ModelForm):\n    class Meta():\n        model = Profile\n        fields = (&quot;portfolio_site&quot;,&quot;profile_image&quot;)\n    def __init__(self, *args, **kwargs):\n        super().__init__(*args, **kwargs)\n        self.fields[&quot;portfolio_site&quot;].label = &quot;Site&quot;\n        self.fields[&quot;profile_image&quot;].label = &quot;Image&quot;\n</code></pre>\n<h1>Views.py</h1>\n<pre><code>@login_required\ndef profile_update(request):\n    user = request.user\n    form = ProfileUpdateForm(request.POST or None, instance=user.profile)\n    if request.method == 'POST':\n        if form.is_valid():\n            form.save()\n            print(&quot;POST sending you back HOME&quot;)\n            return HttpResponseRedirect(reverse('home'))\n        else:\n            print(&quot;error&quot;)\n    else:\n        print(&quot;GET profile.html&quot;)\n    context = {\n        &quot;profile_updateform&quot;:form,\n    }\n    return render(request, 'profile.html', context)\n</code></pre>\n<h1>Profile.html</h1>\n<pre><code>{% extends &quot;base.html&quot; %}\n{% load staticfiles %}\n{% block body_block %}\n\n{% if user.is_authenticated %}\n  &lt;form enctype=&quot;multipart/form-data&quot; method=&quot;POST&quot;&gt;\n    {% csrf_token %}\n    {{ profile_updateform.as_p }}\n    &lt;input type=&quot;submit&quot; name=&quot;&quot; value=&quot;Update&quot;&gt;\n  &lt;/form&gt;\n{% else %}\n  &lt;h1&gt;You need to login!&lt;/h1&gt;\n{% endif %}\n\n{% endblock %}\n</code></pre>\n"}, {"tags": ["python"], "comments": [{"owner": {"reputation": 2389, "user_id": 7348030, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7PmbNFJwfPc/AAAAAAAAAAI/AAAAAAAAAJE/5lDuTFQtNpQ/photo.jpg?sz=128", "display_name": "Florian Bernard", "link": "https://stackoverflow.com/users/7348030/florian-bernard"}, "edited": false, "score": 0, "creation_date": 1571261176, "post_id": 58421647, "comment_id": 103186019, "body": "Look at django source code, or flask-XXX both of them have login/register system implemented, this will give you all the informations you want."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 10976143, "user_type": "registered", "profile_image": "https://graph.facebook.com/130771251288689/picture?type=large", "display_name": "Dziu Gas", "link": "https://stackoverflow.com/users/10976143/dziu-gas"}, "edited": false, "score": 0, "creation_date": 1571260733, "post_id": 58421768, "comment_id": 103185843, "body": "I don&#39;t need to store my passwords, I also will not use Django as a webserver, I would use flask or aiohttp."}, {"owner": {"reputation": 110, "user_id": 12209040, "user_type": "registered", "profile_image": "https://graph.facebook.com/2989227071092137/picture?type=large", "display_name": "Drilon Hametaj", "link": "https://stackoverflow.com/users/12209040/drilon-hametaj"}, "reply_to_user": {"reputation": 45, "user_id": 10976143, "user_type": "registered", "profile_image": "https://graph.facebook.com/130771251288689/picture?type=large", "display_name": "Dziu Gas", "link": "https://stackoverflow.com/users/10976143/dziu-gas"}, "edited": false, "score": 0, "creation_date": 1571261074, "post_id": 58421768, "comment_id": 103185982, "body": "Your problem is if many people try to login in same time which is the value of variables?"}, {"owner": {"reputation": 45, "user_id": 10976143, "user_type": "registered", "profile_image": "https://graph.facebook.com/130771251288689/picture?type=large", "display_name": "Dziu Gas", "link": "https://stackoverflow.com/users/10976143/dziu-gas"}, "edited": false, "score": 0, "creation_date": 1571261243, "post_id": 58421768, "comment_id": 103186046, "body": "Maybe that&#39;s it, that&#39;s what I&#39;m asking, should I use these classes somehow or what should I use. For now I&#39;m working on a CMD and for DB I use PostgreSQL. I would like to start aiohttp or flask with vue.js"}, {"owner": {"reputation": 110, "user_id": 12209040, "user_type": "registered", "profile_image": "https://graph.facebook.com/2989227071092137/picture?type=large", "display_name": "Drilon Hametaj", "link": "https://stackoverflow.com/users/12209040/drilon-hametaj"}, "reply_to_user": {"reputation": 45, "user_id": 10976143, "user_type": "registered", "profile_image": "https://graph.facebook.com/130771251288689/picture?type=large", "display_name": "Dziu Gas", "link": "https://stackoverflow.com/users/10976143/dziu-gas"}, "edited": false, "score": 1, "creation_date": 1571261624, "post_id": 58421768, "comment_id": 103186174, "body": "If many people doing same action in same time there will be for each one a differente request, so there will not be overwriting of variables"}, {"owner": {"reputation": 45, "user_id": 10976143, "user_type": "registered", "profile_image": "https://graph.facebook.com/130771251288689/picture?type=large", "display_name": "Dziu Gas", "link": "https://stackoverflow.com/users/10976143/dziu-gas"}, "edited": false, "score": 0, "creation_date": 1571261722, "post_id": 58421768, "comment_id": 103186192, "body": "That&#39;s what I was asking for:)"}], "tags": [], "owner": {"reputation": 110, "user_id": 12209040, "user_type": "registered", "profile_image": "https://graph.facebook.com/2989227071092137/picture?type=large", "display_name": "Drilon Hametaj", "link": "https://stackoverflow.com/users/12209040/drilon-hametaj"}, "is_accepted": true, "score": 1, "last_activity_date": 1571260274, "creation_date": 1571260274, "answer_id": 58421768, "question_id": 58421647, "link": "https://stackoverflow.com/questions/58421647/making-strong-login-register-login-system-with-classes/58421768#58421768", "title": "Making strong Login / Register Login system with classes", "body": "<p>you can think to use cookies or session with django:</p>\n\n<p>Session: <a href=\"https://developer.mozilla.org/it/docs/Learn/Server-side/Django/Sessions\" rel=\"nofollow noreferrer\">https://developer.mozilla.org/it/docs/Learn/Server-side/Django/Sessions</a></p>\n\n<p>Cookie: <a href=\"https://www.tangowithdjango.com/book/chapters/cookie.html\" rel=\"nofollow noreferrer\">https://www.tangowithdjango.com/book/chapters/cookie.html</a></p>\n\n<p>Session i think it's what you want, beacause cookie can be store for long time, you need to create a new session with user's data when user login, and destroy when logout. Session and coockie are differently for each user, so nothing is overwritten</p>\n"}], "owner": {"reputation": 45, "user_id": 10976143, "user_type": "registered", "profile_image": "https://graph.facebook.com/130771251288689/picture?type=large", "display_name": "Dziu Gas", "link": "https://stackoverflow.com/users/10976143/dziu-gas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "closed_date": 1571307023, "accepted_answer_id": 58421768, "answer_count": 1, "score": 0, "last_activity_date": 1571262429, "creation_date": 1571259628, "last_edit_date": 1571262429, "question_id": 58421647, "link": "https://stackoverflow.com/questions/58421647/making-strong-login-register-login-system-with-classes", "closed_reason": "Needs more focus", "title": "Making strong Login / Register Login system with classes", "body": "<p>I'm trying to do a strong login / register system with PostgreSQL. And one thing that doesn't let me do the job is thinking about client-side application working principle.</p>\n\n<p>Imagine this app is running by 1000 people and how do I have to define the variables? Recently I was talking with my friend programmer, he said that I should use some sort of <code>self.email</code>, <code>self.password</code> variables in classes. But I didn't understand this. Besides I can do register, login system easily without any classes and <code>self</code> references, I would just used the global variables, but my friend said that with each new user the global variables overwrite.</p>\n\n<p>So what's the best way to create login/register system without overwriting anyone's user?</p>\n\n<p>Here's my code which I tried to do with classes.</p>\n\n<p>This is Client-Side application.</p>\n\n<p><code>Main.py</code>:</p>\n\n<pre><code>from Account import Register\n\nclass Main():\n    def __init__(self):\n        self.isregistered = input('Registered or no? (Y/N) : ')\n        if self.isregistered == 'Y':\n            print('logg in...')\n            pass\n        else:\n            self.register_name = Register()\n            print(self.register_name)\n\n    def return_register_name(self):\n        print(self.register_name)\n\nMain()\n</code></pre>\n\n<p>This is the <code>Account.py</code> module which includes <code>Register()</code>:</p>\n\n<pre><code>import getpass\n\ndef Register():\n    a = input('enter your name ')\n    b = getpass.getpass('enter your psw ')\n    return a, b\n\ndef Login():\n    login_user = input('Login name ')\n    login_psw = getpass.getpass('Login pass ')\n</code></pre>\n"}, {"tags": ["python", "dictionary", "tuples"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1571259684, "post_id": 58421630, "comment_id": 103185483, "body": "It doesn&#39;t affect the answer."}, {"owner": {"reputation": 133, "user_id": 12085180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x7Nlb.jpg?s=128&g=1", "display_name": "Muts", "link": "https://stackoverflow.com/users/12085180/muts"}, "edited": false, "score": 1, "creation_date": 1571259785, "post_id": 58421630, "comment_id": 103185530, "body": "You&#39;d need to slightly modify the answer. Unfortunately, you&#39;d have to traverse the dictionary with tuple keys."}, {"owner": {"reputation": 398, "user_id": 10311199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62cd43923007e6e5ae89d47f1d9e1231?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Myer", "link": "https://stackoverflow.com/users/10311199/jacob-myer"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1571259887, "post_id": 58421630, "comment_id": 103185563, "body": "@Barmar I don&#39;t mean the &quot;answer&quot; as far as the output goes, but rather the solution for <i>how</i> to achieve <code>c</code>.  I am asking how to modify that solution to handle the tuple key"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1571259984, "post_id": 58421630, "comment_id": 103185597, "body": "That&#39;s what I meant -- the solution should be the same."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1571260019, "post_id": 58421630, "comment_id": 103185604, "body": "Try it and see if it works."}, {"owner": {"reputation": 398, "user_id": 10311199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62cd43923007e6e5ae89d47f1d9e1231?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Myer", "link": "https://stackoverflow.com/users/10311199/jacob-myer"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1571260343, "post_id": 58421630, "comment_id": 103185711, "body": "@Barmar It doesn&#39;t make any sense to me why am getting this result, but when I use the method in the link I get an empty dictionary <code>{}</code>"}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 0, "creation_date": 1571260398, "post_id": 58421630, "comment_id": 103185730, "body": "Welcome to StackOverflow. Please read and follow the posting guidelines in the help documentation, as suggested when you created this account. <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">Minimal, complete, verifiable example</a> applies here. We cannot effectively help you until you post your MCVE code and accurately specify the problem. We should be able to paste your posted code into a text file and reproduce the problem you specified. StackOverflow is not a design, coding, research, or tutorial resource."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1571260576, "post_id": 58421630, "comment_id": 103185785, "body": "Oh, I just noticed that you only have tuples as the keys in one dictionary, not both. That question is about having the same keys in both dictionaries."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1571260681, "post_id": 58421630, "comment_id": 103185820, "body": "<code>a</code> is a dictionary, do you really mean to have <code>(a, a)</code> as a key in itself?"}, {"owner": {"reputation": 398, "user_id": 10311199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62cd43923007e6e5ae89d47f1d9e1231?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Myer", "link": "https://stackoverflow.com/users/10311199/jacob-myer"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1571260758, "post_id": 58421630, "comment_id": 103185857, "body": "No, these are simply watered down versions of what I&#39;m actually working with for the purpose of this example. Perhaps I should share the actual dictionaries @Barmar"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1571260868, "post_id": 58421630, "comment_id": 103185902, "body": "Just share something that&#39;s valid code, like <code>(&#39;a&#39;, &#39;a&#39;)</code>"}, {"owner": {"reputation": 1068, "user_id": 7211815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qt3B.png?s=128&g=1", "display_name": "codrelphi", "link": "https://stackoverflow.com/users/7211815/codrelphi"}, "edited": false, "score": 0, "creation_date": 1571448231, "post_id": 58421630, "comment_id": 103256175, "body": "@JacobMyer: if you got your answer, you should vote/accept it, so others people can benefit from your question..."}], "answers": [{"comments": [{"owner": {"reputation": 10928, "user_id": 1358308, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d9448dee25fd2278def77cb7f0353574?s=128&d=identicon&r=PG", "display_name": "Sam Mason", "link": "https://stackoverflow.com/users/1358308/sam-mason"}, "edited": false, "score": 2, "creation_date": 1571260470, "post_id": 58421789, "comment_id": 103185754, "body": "could you just use <code>b.get(k[1], 1)</code>?"}], "tags": [], "owner": {"reputation": 683, "user_id": 11220780, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ubIXaw71rPY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reTNbPdx6BDLRY2TCGVZDXEhNhHWQ/mo/photo.jpg?sz=128", "display_name": "Benoit de Menthi&#232;re", "link": "https://stackoverflow.com/users/11220780/benoit-de-menthi%c3%a8re"}, "is_accepted": true, "score": 2, "last_activity_date": 1571261222, "last_edit_date": 1571261222, "creation_date": 1571260396, "answer_id": 58421789, "question_id": 58421630, "link": "https://stackoverflow.com/questions/58421630/how-can-i-multiply-dictionaries-of-different-sizes-where-their-keys-match/58421789#58421789", "title": "How can I multiply dictionaries of different sizes where their keys match?", "body": "<p>should do it:</p>\n\n<p><code>{k:y.get(k[1], 1)*v for k,v in x.items()}</code></p>\n\n<p><code>{('a', 'a'): 1,\n ('a', 'b'): 0,\n ('a', 'c'): 9,\n ('a', 'd'): 2,\n ('b', 'a'): 3,\n ('b', 'b'): 4,\n ('b', 'c'): 6,\n ('b', 'd'): 1}</code></p>\n\n<p><em>edited to reflect the change in dictionary names</em></p>\n"}, {"comments": [{"owner": {"reputation": 10928, "user_id": 1358308, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d9448dee25fd2278def77cb7f0353574?s=128&d=identicon&r=PG", "display_name": "Sam Mason", "link": "https://stackoverflow.com/users/1358308/sam-mason"}, "edited": false, "score": 0, "creation_date": 1571328186, "post_id": 58421925, "comment_id": 103213429, "body": "note that it&#39;s more conventional/idiomatic to write <code>k[1] in dict2.keys()</code> as <code>k[1] in dict2</code>..."}, {"owner": {"reputation": 1068, "user_id": 7211815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qt3B.png?s=128&g=1", "display_name": "codrelphi", "link": "https://stackoverflow.com/users/7211815/codrelphi"}, "reply_to_user": {"reputation": 10928, "user_id": 1358308, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d9448dee25fd2278def77cb7f0353574?s=128&d=identicon&r=PG", "display_name": "Sam Mason", "link": "https://stackoverflow.com/users/1358308/sam-mason"}, "edited": false, "score": 0, "creation_date": 1571330916, "post_id": 58421925, "comment_id": 103214661, "body": "@SamMason, perhaps you didn&#39;t read my code. Get a look again, you will note that I use <code>if k[1] in dict2.keys(): </code>."}, {"owner": {"reputation": 10928, "user_id": 1358308, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d9448dee25fd2278def77cb7f0353574?s=128&d=identicon&r=PG", "display_name": "Sam Mason", "link": "https://stackoverflow.com/users/1358308/sam-mason"}, "edited": false, "score": 0, "creation_date": 1571331334, "post_id": 58421925, "comment_id": 103214843, "body": "I don&#39;t understand your comment! try removing your call to  <code>.keys()</code>, you should get the same output."}, {"owner": {"reputation": 1068, "user_id": 7211815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qt3B.png?s=128&g=1", "display_name": "codrelphi", "link": "https://stackoverflow.com/users/7211815/codrelphi"}, "reply_to_user": {"reputation": 10928, "user_id": 1358308, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d9448dee25fd2278def77cb7f0353574?s=128&d=identicon&r=PG", "display_name": "Sam Mason", "link": "https://stackoverflow.com/users/1358308/sam-mason"}, "edited": false, "score": 0, "creation_date": 1571331588, "post_id": 58421925, "comment_id": 103214934, "body": "@SamMason, I finally get your point. I update and comment the code."}, {"owner": {"reputation": 10928, "user_id": 1358308, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d9448dee25fd2278def77cb7f0353574?s=128&d=identicon&r=PG", "display_name": "Sam Mason", "link": "https://stackoverflow.com/users/1358308/sam-mason"}, "edited": false, "score": 0, "creation_date": 1571331911, "post_id": 58421925, "comment_id": 103215078, "body": "no probs! it&#39;s a useful shortcut and most codebases I&#39;ve read rely on it"}, {"owner": {"reputation": 1068, "user_id": 7211815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qt3B.png?s=128&g=1", "display_name": "codrelphi", "link": "https://stackoverflow.com/users/7211815/codrelphi"}, "reply_to_user": {"reputation": 10928, "user_id": 1358308, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d9448dee25fd2278def77cb7f0353574?s=128&d=identicon&r=PG", "display_name": "Sam Mason", "link": "https://stackoverflow.com/users/1358308/sam-mason"}, "edited": false, "score": 0, "creation_date": 1571332452, "post_id": 58421925, "comment_id": 103215328, "body": "Yeah, I know this syntax, but I wrote the first one (<code>k[1] in dict2.keys()</code>) to specify to @JacobMyer that the comparision is based on the key.... Thank you, he will have the choice."}], "tags": [], "owner": {"reputation": 1068, "user_id": 7211815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qt3B.png?s=128&g=1", "display_name": "codrelphi", "link": "https://stackoverflow.com/users/7211815/codrelphi"}, "is_accepted": false, "score": 1, "last_activity_date": 1571331683, "last_edit_date": 1571331683, "creation_date": 1571261205, "answer_id": 58421925, "question_id": 58421630, "link": "https://stackoverflow.com/questions/58421630/how-can-i-multiply-dictionaries-of-different-sizes-where-their-keys-match/58421925#58421925", "title": "How can I multiply dictionaries of different sizes where their keys match?", "body": "<p>Here's a simple way to achieve your goal without using <code>dict-comprehension</code>:</p>\n\n<pre><code>dict1 = {('a', 'a'): 1,\n ('a', 'b'): 0,\n ('a', 'c'): 3,\n ('a', 'd'): 2,\n ('b', 'a'): 3,\n ('b', 'b'): 2,\n ('b', 'c'): 2,\n ('b', 'd'): 1}\n\ndict2 = {'a': 1,\n     'b': 2,\n     'c': 3}\n\ndict3 = {} # the result dictionary\nfor k, v in dict1.items():\n    if k[1] in dict2: # it is the same as: if k[1] in dict2.keys()\n        dict3[k] = v * dict2[k[1]]\n    else:\n        dict3[k] = v\n\nprint(dict3)\n</code></pre>\n\n<blockquote>\n  <p><strong>*Output:</strong></p>\n\n<pre><code>{('a', 'a'): 1, ('a', 'b'): 0, ('a', 'c'): 9, ('a', 'd'): 2, ('b', 'a'): 3, ('b', 'b'): 4, ('b', 'c'): 6, ('b', 'd'): 1}\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 398, "user_id": 10311199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62cd43923007e6e5ae89d47f1d9e1231?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Myer", "link": "https://stackoverflow.com/users/10311199/jacob-myer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 58421789, "answer_count": 2, "score": -2, "last_activity_date": 1571331683, "creation_date": 1571259543, "last_edit_date": 1571261046, "question_id": 58421630, "link": "https://stackoverflow.com/questions/58421630/how-can-i-multiply-dictionaries-of-different-sizes-where-their-keys-match", "title": "How can I multiply dictionaries of different sizes where their keys match?", "body": "<p>I need to multiply a dictionary <code>x</code> that has a tuple key by another dictionary <code>y</code>.  The dictionary <code>x</code> has somewhere around 1000 items while <code>y</code> has 12.  I want to multiply the values of the two dictionaries where the keys of <code>y</code> are the same as the second element of the tuple in <code>x</code>'s keys.  </p>\n\n<p>The dictionaries look like this, I've made these ones here shorter for this example:</p>\n\n<pre><code>x = {('a', 'a'): 1,\n     ('a', 'b'): 0,\n     ('a', 'c'): 3,\n     ('a', 'd'): 2,\n     ('b', 'a'): 3,\n     ('b', 'b'): 2,\n     ('b', 'c'): 2,\n     ('b', 'd'): 1}\n\ny = {'a': 1,\n     'b': 2,\n     'c': 3}\n\n# Expected output when the two are multiplied:\n\nz = {('a', 'a'): 1,\n     ('a', 'b'): 0,\n     ('a', 'c'): 9,\n     ('a', 'd'): 2,\n     ('b', 'a'): 3,\n     ('b', 'b'): 4,\n     ('b', 'c'): 6,\n     ('b', 'd'): 1}\n</code></pre>\n\n<p>I have seen the solution here: <a href=\"https://stackoverflow.com/questions/15334783/multiplying-values-from-two-different-dictionaries-together-in-python\">Multiplying values from two different dictionaries together in Python</a> but my situation has tuple keys in one dictionary and I'm not entirely sure how that affects the answer. </p>\n"}, {"tags": ["python", "flask", "thread-safety"], "comments": [{"owner": {"reputation": 9070, "user_id": 6817835, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/8GBAa.jpg?s=128&g=1", "display_name": "gold_cy", "link": "https://stackoverflow.com/users/6817835/gold-cy"}, "edited": false, "score": 0, "creation_date": 1571261914, "post_id": 58421621, "comment_id": 103186247, "body": "have you looked in to using a shared resource manager, something like Redis perhaps?"}, {"owner": {"reputation": 145, "user_id": 10237506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9888f19e5b9fa62a6a8b21a067edceb?s=128&d=identicon&r=PG&f=1", "display_name": "rv.kvetch", "link": "https://stackoverflow.com/users/10237506/rv-kvetch"}, "reply_to_user": {"reputation": 9070, "user_id": 6817835, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/8GBAa.jpg?s=128&g=1", "display_name": "gold_cy", "link": "https://stackoverflow.com/users/6817835/gold-cy"}, "edited": false, "score": 0, "creation_date": 1571319654, "post_id": 58421621, "comment_id": 103208543, "body": "is not a duplicate, that question is asking something different! (this is specifically about flask context)"}], "owner": {"reputation": 145, "user_id": 10237506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9888f19e5b9fa62a6a8b21a067edceb?s=128&d=identicon&r=PG&f=1", "display_name": "rv.kvetch", "link": "https://stackoverflow.com/users/10237506/rv-kvetch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "closed_date": 1571274608, "answer_count": 0, "score": 0, "last_activity_date": 1571319804, "creation_date": 1571259506, "last_edit_date": 1571319804, "question_id": 58421621, "link": "https://stackoverflow.com/questions/58421621/how-to-use-flask-request-context-within-any-sub-threads", "closed_reason": "Duplicate", "title": "How to use flask request context within any sub-threads?", "body": "<p>I want to use current request context when spawning multiple threads in my application - is this easy way to make this possible without using the <code>@copy_current_request_context</code> around each inner function?</p>\n\n<p>basically I can have lots of inner functions and some of these can be global function too (will be share between multiple application requests). So I want easy way to pass the request context between them.</p>\n\n<p>currently I have decorate the outer function, but I guess I need to decorate each inner function every time i spawn another new thread. Otherwise i seem to get the <code>Working outside of request context</code> message.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>@app.route('/my_endpoint', methods=['POST'])\ndef my_endpoint_handler():\n    #do stuff in sub-thread that need the request context\n    @copy_current_request_context\n    def handle_sub_view():\n        from flask import request\n        req = request\n        # Do work with current request context\n    t = threading.Thread(target=handle_sub_view)\n    t.start()\n    t.join()\n\n</code></pre>\n\n<p>that works, but the following does not:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>@app.route('/my_endpoint', methods=['POST'])\ndef my_endpoint_handler():\n    #do stuff in sub-thread that need the request context\n    @copy_current_request_context\n    def handle_sub_view():\n        from flask import request\n        req = request\n\n        def handle_sub_sub_view():\n            from flask import request\n            print('Data is: %s' % request.data)\n            # Do some other work with current request context\n\n        t = threading.Thread(target=handle_sub_sub_view)\n        t.start()\n        t.join()\n        # Do work with current request context\n\n    t = threading.Thread(target=handle_sub_view)\n    t.start()\n    t.join()\n</code></pre>\n\n<p>^ this is just example, my meaning is that I can have many level of nested threads happening and I will need the current request context to be same for them all - any easy way to share the flask request between them?</p>\n\n<p>EDIT: It's not a duplicate I'm asking something different, and specially about flask here.</p>\n"}, {"tags": ["python", "while-loop"], "comments": [{"owner": {"reputation": 2103, "user_id": 7554868, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_q0V6XZcS5c/AAAAAAAAAAI/AAAAAAAABeM/Bmdf1MpnjTQ/photo.jpg?sz=128", "display_name": "Jammy Dodger", "link": "https://stackoverflow.com/users/7554868/jammy-dodger"}, "edited": false, "score": 1, "creation_date": 1571259381, "post_id": 58421576, "comment_id": 103185367, "body": "Is this Python 2 or 3?"}, {"owner": {"reputation": 203, "user_id": 8279593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PTQ4A.jpg?s=128&g=1", "display_name": "El Sheikh", "link": "https://stackoverflow.com/users/8279593/el-sheikh"}, "edited": false, "score": 1, "creation_date": 1571259437, "post_id": 58421576, "comment_id": 103185390, "body": "you can change your while to <code>while True:</code> and add an if condition <code>if gallons == -1: break</code>, assuming that you are coding in <code>python3</code>"}], "answers": [{"comments": [{"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "reply_to_user": {"reputation": 38630, "user_id": 1324033, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/PaonW.png?s=128&g=1", "display_name": "Sayse", "link": "https://stackoverflow.com/users/1324033/sayse"}, "edited": false, "score": 1, "creation_date": 1571259746, "post_id": 58421617, "comment_id": 103185517, "body": "Granted, but the specific question is why the program goes <i>straight</i> to asking for miles, even when the input is -1.  However, it does warrant clarification."}], "tags": [], "owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "is_accepted": false, "score": 2, "last_activity_date": 1571259855, "last_edit_date": 1571259855, "creation_date": 1571259483, "answer_id": 58421617, "question_id": 58421576, "link": "https://stackoverflow.com/questions/58421576/how-to-fix-a-while-loop-that-is-not-functioning-correctly-in-python/58421617#58421617", "title": "How to fix a while loop that is not functioning correctly in Python", "body": "<pre><code>gallons = float(gallons)\n...\nwhile gallons != \"-1\":\n</code></pre>\n\n<p>Your converted input is <code>float</code>; you compared against a string.  These can never be equal.  Use one or the other.</p>\n\n<p>Within the loop, you've kept <code>gallons</code> as a string.  However, you ask for <code>miles</code> before you loop back to check the value of <code>gallons</code> and exit the loop.  In short, your loop exit logic is out of order: you need the <code>gallons</code> input at the <em>bottom</em> of the loop.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 12228838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b090d58b9c9ff11a9b844a1a39da8557?s=128&d=identicon&r=PG&f=1", "display_name": "RMGonza", "link": "https://stackoverflow.com/users/12228838/rmgonza"}, "edited": false, "score": 0, "creation_date": 1571273979, "post_id": 58421683, "comment_id": 103189088, "body": "So it worked! It stops once i enter -1 but another issue is that when it asks me to enter the second input for the gallons and miles it gives me the same calculation as the first mpg."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 1, "user_id": 12228838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b090d58b9c9ff11a9b844a1a39da8557?s=128&d=identicon&r=PG&f=1", "display_name": "RMGonza", "link": "https://stackoverflow.com/users/12228838/rmgonza"}, "edited": false, "score": 0, "creation_date": 1571275476, "post_id": 58421683, "comment_id": 103189369, "body": "@RMGonza You&#39;re calculating <code>mpg</code> only once before the loop. <code>mpg</code> won&#39;t automatically update itself when <code>gallons</code> changes. If you want <code>mpg</code> to change, you have to manually reassign it again."}], "tags": [], "owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "is_accepted": true, "score": 0, "last_activity_date": 1571259830, "creation_date": 1571259830, "answer_id": 58421683, "question_id": 58421576, "link": "https://stackoverflow.com/questions/58421576/how-to-fix-a-while-loop-that-is-not-functioning-correctly-in-python/58421683#58421683", "title": "How to fix a while loop that is not functioning correctly in Python", "body": "<p><code>while gallons != \"-1\":</code> doesn't mean that as soon as <code>gallons</code> becomes <code>\"-1\"</code> the loop will exit. The condition is only checked at the start of each iteration.</p>\n\n<p>If you want to do the check after <code>gallons</code> is assigned, you need to manually handle that:</p>\n\n<pre><code>while True:\n\n   mpg_value = float(mpg)\n   totalMPG += mpg_value\n   gallons = input(\"Enter gallons used (-1 to end): \")\n\n   if gallons == \"-1\":  # Tell it to break from the loop here\n       break\n\n   miles_driven = input(\"Enter the miles driven: \")\n   print ('Your miles per gallon is: ', mpg)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3370, "user_id": 5410779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KoKUW.jpg?s=128&g=1", "display_name": "Phoenix", "link": "https://stackoverflow.com/users/5410779/phoenix"}, "is_accepted": false, "score": 1, "last_activity_date": 1571263803, "last_edit_date": 1571263803, "creation_date": 1571261441, "answer_id": 58421958, "question_id": 58421576, "link": "https://stackoverflow.com/questions/58421576/how-to-fix-a-while-loop-that-is-not-functioning-correctly-in-python/58421958#58421958", "title": "How to fix a while loop that is not functioning correctly in Python", "body": "<blockquote>\n  <p>It's better to use <code>while True</code> and <code>break some_condition</code> expression.</p>\n</blockquote>\n\n<p><strong>Debug:</strong></p>\n\n<pre><code>print(type(gallons)) # output: int\n</code></pre>\n\n<p>So <code>gallons</code> never be <code>\"-1\"</code></p>\n\n<p><strong>Code:</strong></p>\n\n<pre class=\"lang-py prettyprint-override\"><code># python3.x\n# This program calculates miles per gallon the user enter\n\ndef calculate_mpg():\n    _GET_GALLONS_MSG = \"Enter gallons used (-1 to end): \"\n    _GET_MILES_DRIVEN_MSG = \"Enter the miles driven: \"\n    _MPG_FINAL_MSG = \"Your miles per gallon is: \"\n    _MPG_AVG_MSG = \"You're average miles per gallons is \"\n\n    total_mpg, counter = 0.0, 0\n\n    while True:\n\n        try:\n            gallons = float(input(_GET_GALLONS_MSG))\n\n            if gallons == -1:\n                break\n            miles_driven = float(input(_GET_MILES_DRIVEN_MSG))\n\n            total_mpg += round(gallons/miles_driven, 2)\n            counter += 1\n\n        except ValueError as e:\n            print(e)\n\n    avg_mpg = total_mpg / counter\n\n    print(_MPG_FINAL_MSG, total_mpg)\n    print(_MPG_AVG_MSG, avg_mpg)\n\n\nif __name__ == '__main__':\n    calculate_mpg()\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12228838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b090d58b9c9ff11a9b844a1a39da8557?s=128&d=identicon&r=PG&f=1", "display_name": "RMGonza", "link": "https://stackoverflow.com/users/12228838/rmgonza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 58421683, "answer_count": 3, "score": -2, "last_activity_date": 1571263803, "creation_date": 1571259299, "last_edit_date": 1571259382, "question_id": 58421576, "link": "https://stackoverflow.com/questions/58421576/how-to-fix-a-while-loop-that-is-not-functioning-correctly-in-python", "title": "How to fix a while loop that is not functioning correctly in Python", "body": "<p>So im writing a prorgram that calculates the mpg a user inputs, but my while loop is not working. Here's what i got so far: </p>\n\n<pre><code>#This program calculates miles per gallon the user enter\ntotalMPG = 0.0\n\n#Ask user for the gallons used\ngallons = input ('Enter gallons used(-1 to end): ')\n#convert gallons to int\ngallons = float(gallons)\n#Ask user for the miles driven \nmiles_driven = input(\"Enter the miles driven: \")\n#convert miles to a float number\nmiles_driven = float(miles_driven)\n\n\n# calculate miles/gallon and round \nmpg = miles_driven / gallons\nmpg = round(mpg,2)\n\n#print out mpg\nprint('Your miles per gallon is: ', mpg)\n\n\n#while gallons does not equal -1\nwhile gallons != \"-1\":\n\n   mpg_value = float(mpg)\n   totalMPG += mpg_value\n   gallons = input(\"Enter gallons used (-1 to end): \")\n   miles_driven = input(\"Enter the miles driven: \")\n   print ('Your miles per gallon is: ', mpg)\n\nprint(\"Your total miles per gallons is: \", totalMPG)\n\navg = totalMPG / mpg\nprint (\"You're average miles per gallons is \", avg)\n</code></pre>\n\n<p>when i enter -1 to exit the program, it just goes straight to asking to enter the miles.</p>\n"}, {"tags": ["python", "unit-testing", "mocking"], "comments": [{"owner": {"reputation": 153, "user_id": 6560237, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4Jr5oWpcaVo/AAAAAAAAAAI/AAAAAAAAAF4/FxLUni5VSN8/photo.jpg?sz=128", "display_name": "Rushikesh Raut", "link": "https://stackoverflow.com/users/6560237/rushikesh-raut"}, "edited": false, "score": 0, "creation_date": 1571327088, "post_id": 58421569, "comment_id": 103212849, "body": "Can you please describe your problem as it is not clear from the given information"}], "answers": [{"tags": [], "owner": {"reputation": 2230, "user_id": 5574689, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2883b3fdb7276b30d733cfc0241bc689?s=128&d=identicon&r=PG&f=1", "display_name": "Gang", "link": "https://stackoverflow.com/users/5574689/gang"}, "is_accepted": false, "score": 0, "last_activity_date": 1571314126, "last_edit_date": 1571314126, "creation_date": 1571313660, "answer_id": 58432165, "question_id": 58421569, "link": "https://stackoverflow.com/questions/58421569/mock-a-function-call-on-a-class-you-mocked/58432165#58432165", "title": "Mock a function call on a class you mocked", "body": "<p>One way to catch the get_value of <code>StringIO</code> is to patch the <code>sys.stdout</code> in the proper scope, not directly mocking the <code>StringIO</code> itself.</p>\n\n<pre><code>with mock.patch('sys.stdout', new=io.StringIO('xxx')) as fakeOutput:\n   self.assertEqual('xxx', fakeOutput.getvalue().strip())\n   # add your real test here, as no details provided\n</code></pre>\n"}], "owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571314126, "creation_date": 1571259276, "question_id": 58421569, "link": "https://stackoverflow.com/questions/58421569/mock-a-function-call-on-a-class-you-mocked", "title": "Mock a function call on a class you mocked", "body": "<p>How do I mock</p>\n\n<pre><code>    with closing(StringIO()) as screenshot_stringio:\n        screenshot.save(screenshot_stringio, format=\"PNG\")\n        screenshot_as_bytes = screenshot_stringio.getvalue()\n</code></pre>\n\n<p>assuming 'screenshot' is already Mocked.</p>\n\n<p>I tried different permutations of:</p>\n\n<pre><code>    moduleiamtesting.classiamtesting.StringIO = Mock()\n    moduleiamtesting.classiamtesting.StringIO.getvalue = Mock(return_value=\"test_bytes\")\n</code></pre>\n\n<p>but cannot get it to work. the return value in my debugger is another mock</p>\n"}, {"tags": ["python", "pandas", "postgresql"], "comments": [{"owner": {"reputation": 898, "user_id": 1786967, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/bdb37f71889f136513c7b42f9805666f?s=128&d=identicon&r=PG", "display_name": "timmur", "link": "https://stackoverflow.com/users/1786967/timmur"}, "edited": false, "score": 0, "creation_date": 1571261219, "post_id": 58421568, "comment_id": 103186033, "body": "you can use <code>on conflict do nothing</code> on target able provided you have primary keys defined."}, {"owner": {"reputation": 545, "user_id": 8945408, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0b0f521586b89f3ddc15a5887a03de4e?s=128&d=identicon&r=PG&f=1", "display_name": "AlanPear", "link": "https://stackoverflow.com/users/8945408/alanpear"}, "reply_to_user": {"reputation": 898, "user_id": 1786967, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/bdb37f71889f136513c7b42f9805666f?s=128&d=identicon&r=PG", "display_name": "timmur", "link": "https://stackoverflow.com/users/1786967/timmur"}, "edited": false, "score": 0, "creation_date": 1571261343, "post_id": 58421568, "comment_id": 103186088, "body": "What about the actual values I need to update?"}, {"owner": {"reputation": 898, "user_id": 1786967, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/bdb37f71889f136513c7b42f9805666f?s=128&d=identicon&r=PG", "display_name": "timmur", "link": "https://stackoverflow.com/users/1786967/timmur"}, "edited": false, "score": 0, "creation_date": 1571261709, "post_id": 58421568, "comment_id": 103186189, "body": "assuming two rows with same value have same primary key -- natural key as primary key. Keys can be based on multiple columns. Sample data would be helpful."}, {"owner": {"reputation": 545, "user_id": 8945408, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0b0f521586b89f3ddc15a5887a03de4e?s=128&d=identicon&r=PG&f=1", "display_name": "AlanPear", "link": "https://stackoverflow.com/users/8945408/alanpear"}, "reply_to_user": {"reputation": 898, "user_id": 1786967, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/bdb37f71889f136513c7b42f9805666f?s=128&d=identicon&r=PG", "display_name": "timmur", "link": "https://stackoverflow.com/users/1786967/timmur"}, "edited": false, "score": 0, "creation_date": 1571262494, "post_id": 58421568, "comment_id": 103186438, "body": "added some example data."}, {"owner": {"reputation": 898, "user_id": 1786967, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/bdb37f71889f136513c7b42f9805666f?s=128&d=identicon&r=PG", "display_name": "timmur", "link": "https://stackoverflow.com/users/1786967/timmur"}, "edited": false, "score": 0, "creation_date": 1571270960, "post_id": 58421568, "comment_id": 103188502, "body": "from what i understand, you would like to only update some fields are changed. unfortunately, that is not quite possible since postgres changes entire tuple/row for every updates. You might want to break main table to smaller tables with subset of fields for what you are trying to achieve."}], "owner": {"reputation": 545, "user_id": 8945408, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0b0f521586b89f3ddc15a5887a03de4e?s=128&d=identicon&r=PG&f=1", "display_name": "AlanPear", "link": "https://stackoverflow.com/users/8945408/alanpear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 314, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571263472, "creation_date": 1571259272, "last_edit_date": 1571263472, "question_id": 58421568, "link": "https://stackoverflow.com/questions/58421568/python-pandas-upsert", "title": "Python Pandas Upsert", "body": "<p>I have daily data pipelines that need read a file and write the data to a postgres database. Some of theses files may be a mix of new and old data. </p>\n\n<p>My current process is to take the file and write it to Dataframe, dump the Dataframe to a staging table, than execute and upsert. This works, but I am potentially updating values that are exactly the same. I would have compare all the columns in a row to see if theres a new value, which seems like more trouble than its worth (some tables might have 30+ columns).</p>\n\n<p>Is there a better or more optimal way to do this? I feel like the larger my table or source files get the more time this process will take. Here is some example code of my process:</p>\n\n<pre><code>def example_import(file_path, engine):\n    '''\n    ETL example\n    '''\n\n    df_demo = download_from_ftp(file_path)\n\n    if df_demo.empty:\n        return\n\n    # some cleaning might happen here\n\n    df_demo.to_sql(con = engine, name = 'tbl', schema = 'staging', if_exists = 'replace', index = False, method = 'multi')\n\n    with open('/somefolder/upsert.sql') as fp:\n        upsert = fp.read()\n\n    result = engine.execute(upsert)\n    print('Inserted/Updated {} Records From {}'.format(result.rowcount, file_path))\n</code></pre>\n\n<p><strong>Example Data</strong>:</p>\n\n<p>Current Table (in reality have many more columns)</p>\n\n<p><a href=\"https://i.stack.imgur.com/dz8re.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dz8re.png\" alt=\"Current Table\"></a></p>\n\n<p>Incoming Data (mix of new and old. some old PK have new values)</p>\n\n<p><a href=\"https://i.stack.imgur.com/476DE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/476DE.png\" alt=\"enter image description here\"></a></p>\n\n<p>Data After Upsert</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ika9N.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ika9N.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Upsert Example</strong></p>\n\n<pre><code>INSERT INTO public.\"tbl\" (\"colA\",\n                                 \"colB\",\n                                 \"colC\",\n                                 \"colD\",\n                                 \"colE\",\n                                 \"colF\",\n                                 \"colG\",\n                                 \"colH\",\n                                 \"colI\",\n                                 \"colJ\",\n                                 \"colK\",\n                                 \"colL\",\n                                 \"colM\",\n                                 \"colN\",\n                                 \"colO\",\n                                 \"colP\",\n                                 \"colQ\",\n                                 \"colR\",\n                                 \"colS\",\n                                 \"colT\",\n                                 \"colU\",\n                                 \"colV\"\nSELECT \"colA\",\n         \"colB\",\n         \"colC\",\n         \"colD\",\n         \"colE\"::DATE,\n         \"colF\",\n         \"colG\"::DATE,\n         \"colH\",\n         \"colI\"::DATE,\n         \"colJ\"::DATE,\n         \"colK\",\n         \"colL\",\n         \"colM\",\n         \"colN\",\n         \"colO\",\n         \"colP\",\n         \"colQ\",\n         \"colR\",\n         \"colS\",\n         \"colT\",\n         \"colU\",\n         \"colV\"\nFROM staging.\"tbl\"\nON CONFLICT (\"colA\") DO UPDATE \n    SET \"colB\" = excluded.\"colB\",\n         \"colC\" = excluded.\"colC\",\n         \"colD\" = excluded.\"colD\",\n         \"colE\" = excluded.\"colE\",\n         \"colF\" = excluded.\"colF\",\n         \"colG\" = excluded.\"colG\",\n         \"colH\" = excluded.\"colH\",\n         \"colI\" = excluded.\"colI\",\n         \"colJ\" = excluded.\"colJ\",\n         \"colK\" = excluded.\"colK\",\n         \"colL\" = excluded.\"colL\",\n         \"colM\" = excluded.\"colM\",\n         \"colN\" = excluded.\"colN\",\n         \"colO\" = excluded.\"colO\",\n         \"colP\" = excluded.\"colP\",\n         \"colQ\" = excluded.\"colQ\",\n         \"colR\" = excluded.\"colR\",\n         \"colS\" = excluded.\"colS\",\n         \"colT\" = excluded.\"colT\",\n         \"colU\" = excluded.\"colU\",\n         \"colV\" = excluded.\"colV\"\n</code></pre>\n"}, {"tags": ["python", "instance", "memory-address", "construct"], "comments": [{"owner": {"reputation": 6802, "user_id": 9609843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9ceb913f05e91861333b367e0379a8e?s=128&d=identicon&r=PG&f=1", "display_name": "sanyassh", "link": "https://stackoverflow.com/users/9609843/sanyassh"}, "edited": false, "score": 1, "creation_date": 1571262278, "post_id": 58421562, "comment_id": 103186371, "body": "Looks like a custom <code>__str__</code>. Can you please check what returns <code>print(repr(self))</code> of the same object?"}, {"owner": {"reputation": 225, "user_id": 12071685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce9707fac0bb74c37a35d37a7a1ce4ef?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/12071685/robert"}, "reply_to_user": {"reputation": 6802, "user_id": 9609843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9ceb913f05e91861333b367e0379a8e?s=128&d=identicon&r=PG&f=1", "display_name": "sanyassh", "link": "https://stackoverflow.com/users/9609843/sanyassh"}, "edited": false, "score": 0, "creation_date": 1571262650, "post_id": 58421562, "comment_id": 103186485, "body": "Yes, it looks like I get the same result: <code>&lt;bpy_struct, WM_OT_fbxg_ovr(&quot;WM_OT_fbxg_ovr&quot;)&gt;</code> (where <code>WM_OT_fbxg_ovr</code> is my class name). Later on I get <code>&lt;bpy_struct, WM_OT_fbxg_ovr at 0x0000022E62420468&gt;</code>"}, {"owner": {"reputation": 6802, "user_id": 9609843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9ceb913f05e91861333b367e0379a8e?s=128&d=identicon&r=PG&f=1", "display_name": "sanyassh", "link": "https://stackoverflow.com/users/9609843/sanyassh"}, "edited": false, "score": 1, "creation_date": 1571262712, "post_id": 58421562, "comment_id": 103186505, "body": "How do you get it <i>later</i>? It can be important."}, {"owner": {"reputation": 225, "user_id": 12071685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce9707fac0bb74c37a35d37a7a1ce4ef?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/12071685/robert"}, "reply_to_user": {"reputation": 6802, "user_id": 9609843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9ceb913f05e91861333b367e0379a8e?s=128&d=identicon&r=PG&f=1", "display_name": "sanyassh", "link": "https://stackoverflow.com/users/9609843/sanyassh"}, "edited": false, "score": 0, "creation_date": 1571263820, "post_id": 58421562, "comment_id": 103186848, "body": "During <code>__init__()</code> and another function <code>def invoke(self, context, event):</code> (used as a sort of setup function - see <a href=\"https://docs.blender.org/api/2.80/bpy.types.Operator.html?highlight=invoke#bpy.types.Operator.invoke\" rel=\"nofollow noreferrer\">docs.blender.org/api/2.80/&hellip;</a>), the instance prints like the constructor string, then all functions afterward seem to print normal instance addresses."}, {"owner": {"reputation": 225, "user_id": 12071685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce9707fac0bb74c37a35d37a7a1ce4ef?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/12071685/robert"}, "reply_to_user": {"reputation": 6802, "user_id": 9609843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9ceb913f05e91861333b367e0379a8e?s=128&d=identicon&r=PG&f=1", "display_name": "sanyassh", "link": "https://stackoverflow.com/users/9609843/sanyassh"}, "edited": false, "score": 0, "creation_date": 1571264241, "post_id": 58421562, "comment_id": 103186981, "body": "If its not obvious, it&#39;s probably something very Blender specific"}, {"owner": {"reputation": 6802, "user_id": 9609843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9ceb913f05e91861333b367e0379a8e?s=128&d=identicon&r=PG&f=1", "display_name": "sanyassh", "link": "https://stackoverflow.com/users/9609843/sanyassh"}, "edited": false, "score": 1, "creation_date": 1571266272, "post_id": 58421562, "comment_id": 103187496, "body": "I guess that if it is something very Blender specific you shouldn&#39;t worry about it much. Normally every class prints its instances as you expect: <code>ClassName instance at 0X00address</code>. It is possible to know the instance address after returning the instance from <code>__new__</code> method (which is really a constructor in Python, not <code>__init__</code>). I can&#39;t think of any reason to print it in a way like <code>CLASS_NAME(&quot;CLASS_NAME&quot;)</code>"}, {"owner": {"reputation": 225, "user_id": 12071685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce9707fac0bb74c37a35d37a7a1ce4ef?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/12071685/robert"}, "reply_to_user": {"reputation": 6802, "user_id": 9609843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9ceb913f05e91861333b367e0379a8e?s=128&d=identicon&r=PG&f=1", "display_name": "sanyassh", "link": "https://stackoverflow.com/users/9609843/sanyassh"}, "edited": false, "score": 0, "creation_date": 1571268758, "post_id": 58421562, "comment_id": 103188084, "body": "Thanks, knowing that helps a lot. I was trying to attach members to the instance, and they were not available in the later functions, which lead to (confusion, then to) me printing the instance address to compare them. I&#39;ve changed my setup to store states in an external object, which should hopefully have more predictable instancing."}, {"owner": {"reputation": 225, "user_id": 12071685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce9707fac0bb74c37a35d37a7a1ce4ef?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/12071685/robert"}, "reply_to_user": {"reputation": 6802, "user_id": 9609843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9ceb913f05e91861333b367e0379a8e?s=128&d=identicon&r=PG&f=1", "display_name": "sanyassh", "link": "https://stackoverflow.com/users/9609843/sanyassh"}, "edited": false, "score": 0, "creation_date": 1571347064, "post_id": 58421562, "comment_id": 103221342, "body": "Just an FYI, I&#39;m now seeing this constructor-like instance string in all functions, all the time. I&#39;ve been changing the class here and there, so I have no idea what caused it yet. I will add another comment if I ever figure out what it means."}], "owner": {"reputation": 225, "user_id": 12071685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce9707fac0bb74c37a35d37a7a1ce4ef?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/12071685/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571260781, "creation_date": 1571259243, "last_edit_date": 1571260781, "question_id": 58421562, "link": "https://stackoverflow.com/questions/58421562/printed-instance-address-looks-like-constructor", "title": "Printed instance address looks like constructor", "body": "<p>I'm developing a Blender add-on with Python, and I'm trying to understand what this printed instance address represents. I asked this question in the Blender forum (<a href=\"https://blender.stackexchange.com/questions/155614/add-on-dev-different-memory-address-of-operator-instance\">https://blender.stackexchange.com/questions/155614/add-on-dev-different-memory-address-of-operator-instance</a>), but there are not a lot of developers looking at this, so I'm hoping this is more of a general Python concept.</p>\n\n<p>During a few functions of a class, when I try to <code>print(str(self))</code>, I get the following string printed:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>&lt;bpy_struct, CLASS_NAME(\"CLASS_NAME\")&gt;\n</code></pre>\n\n<p>This is the type of string I would expect to see, and actually do see in later functions:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>&lt;bpy_struct, CLASS_NAME at 0x0000027E223B95C8&gt;\n</code></pre>\n\n<p>I've never used Python anywhere other than within the Blender environment, so my perspective and relative knowledge is very limited. If you are very familiar with Python and this doesn't make sense, then it is likely something very Blender-specific. My guess is that Blender is doing something weird with my class instance, like copying it from one memory location to another, or possibly that the instance is not fully constructed yet.</p>\n"}, {"tags": ["python", "c", "python-3.x", "scipy", "numba"], "comments": [{"owner": {"reputation": 451, "user_id": 4276112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/361b5255525c16f7049a5644295c7d2c?s=128&d=identicon&r=PG&f=1", "display_name": "mosegui", "link": "https://stackoverflow.com/users/4276112/mosegui"}, "reply_to_user": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1571823219, "post_id": 58421549, "comment_id": 103365176, "body": "Yes. In the meantime I got to understand that there is no such concept in C as a shaped array, so I would need to pass the array value-by-value, by occupying contiguous memory addresses just like the regular way the other scalar arguments are passed (packed in the form of the <code>xx</code> array) .  It would be nice if someone got some advice on how to implement this from the design perspective. Sticking to <code>numba</code> stays my preferred option. Thanks!"}, {"owner": {"reputation": 5208, "user_id": 4045774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c23c0c730b6a9cb71d1ce17838f2beb7?s=128&d=identicon&r=PG&f=1", "display_name": "max9111", "link": "https://stackoverflow.com/users/4045774/max9111"}, "edited": false, "score": 0, "creation_date": 1571992221, "post_id": 58421549, "comment_id": 103429291, "body": "Maybe it does make sense to ask this question (passing arguments to a compiled integrate func) in a more general way (eg. using C) at the scipy github site. If the problem is solved for plain C, it should be straight forward to do this using Numba."}, {"owner": {"reputation": 5208, "user_id": 4045774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c23c0c730b6a9cb71d1ce17838f2beb7?s=128&d=identicon&r=PG&f=1", "display_name": "max9111", "link": "https://stackoverflow.com/users/4045774/max9111"}, "edited": false, "score": 0, "creation_date": 1572168468, "post_id": 58421549, "comment_id": 103471305, "body": "Are your array sizes changing on every iteration? If not, you don&#39;t have to recompile the function on every call. I implemented &#39;jit_with_dummy_data&#39; to be called only once."}, {"owner": {"reputation": 451, "user_id": 4276112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/361b5255525c16f7049a5644295c7d2c?s=128&d=identicon&r=PG&f=1", "display_name": "mosegui", "link": "https://stackoverflow.com/users/4276112/mosegui"}, "reply_to_user": {"reputation": 5208, "user_id": 4045774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c23c0c730b6a9cb71d1ce17838f2beb7?s=128&d=identicon&r=PG&f=1", "display_name": "max9111", "link": "https://stackoverflow.com/users/4045774/max9111"}, "edited": false, "score": 0, "creation_date": 1572182106, "post_id": 58421549, "comment_id": 103474192, "body": "@max9111 NO they are not :D! You are right. I have been through your solution again and I see now I was not understanding it properly all involved concepts. Indeed I can build the <code>LowLevelCallable</code> once in the beginning (which adds about one second to the total calculation time) and then iterate faster with more efficient integration (which saves me about two seconds time). All in all, my overall calculation time got reduced to about the half!! (ca. two secs instead of four). Thank you very much!"}, {"owner": {"reputation": 5208, "user_id": 4045774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c23c0c730b6a9cb71d1ce17838f2beb7?s=128&d=identicon&r=PG&f=1", "display_name": "max9111", "link": "https://stackoverflow.com/users/4045774/max9111"}, "edited": false, "score": 0, "creation_date": 1572284701, "post_id": 58421549, "comment_id": 103504583, "body": "I have opened an issue on this topic at the Numba Github site. <a href=\"https://github.com/numba/numba/issues/4754\" rel=\"nofollow noreferrer\">github.com/numba/numba/issues/4754</a> Even if my solution works for you there should be an easy way to do this in a more general way (without recompilation if array shapes changes)."}, {"owner": {"reputation": 5208, "user_id": 4045774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c23c0c730b6a9cb71d1ce17838f2beb7?s=128&d=identicon&r=PG&f=1", "display_name": "max9111", "link": "https://stackoverflow.com/users/4045774/max9111"}, "edited": false, "score": 0, "creation_date": 1588692126, "post_id": 58421549, "comment_id": 108993122, "body": "I have added a version, which doesn&#39;t need recompilation if the array shape changes."}], "answers": [{"comments": [{"owner": {"reputation": 451, "user_id": 4276112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/361b5255525c16f7049a5644295c7d2c?s=128&d=identicon&r=PG&f=1", "display_name": "mosegui", "link": "https://stackoverflow.com/users/4276112/mosegui"}, "edited": false, "score": 0, "creation_date": 1572167477, "post_id": 58561573, "comment_id": 103471126, "body": "max9111 thank you very much for your time and help. Your solution worked. See my edit above."}], "tags": [], "owner": {"reputation": 5208, "user_id": 4045774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c23c0c730b6a9cb71d1ce17838f2beb7?s=128&d=identicon&r=PG&f=1", "display_name": "max9111", "link": "https://stackoverflow.com/users/4045774/max9111"}, "is_accepted": false, "score": 2, "last_activity_date": 1588692097, "last_edit_date": 1588692097, "creation_date": 1572017595, "answer_id": 58561573, "question_id": 58421549, "link": "https://stackoverflow.com/questions/58421549/passing-numpy-arrays-as-arguments-to-numba-cfunc/58561573#58561573", "title": "Passing NumPy arrays as arguments to numba.cfunc", "body": "<h2>You can use the user_data Input to pass arrays</h2>\n\n<p>As I understood the documentation of <a href=\"https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad\" rel=\"nofollow noreferrer\">scipy.integrate.quad</a> it isn't possible to pass arrays with the <code>args</code> parameter when using a <a href=\"https://docs.scipy.org/doc/scipy/reference/generated/scipy.LowLevelCallable.html#scipy.LowLevelCallable\" rel=\"nofollow noreferrer\">scipy.LowLevelCallable</a>, but you can pass abitrary user_data.</p>\n\n<p>In the following example I used this signature.</p>\n\n<blockquote>\n  <p>double func(double x, void *user_data) </p>\n</blockquote>\n\n<p><strong>Edit Arbitrary shapes of arrays without recompilation</strong></p>\n\n<p>Using this <a href=\"https://stackoverflow.com/a/61550054/4045774\">answer</a> it is also possible to compile the function once for arbitrary array shapes (only the number of dimensions is fixed).</p>\n\n<pre><code>import numpy as np\nimport numba as nb\nfrom numba import types\nfrom scipy import integrate, LowLevelCallable\nimport ctypes\n\n#Void Pointer from Int64\n@nb.extending.intrinsic\ndef address_as_void_pointer(typingctx, src):\n    \"\"\" returns a void pointer from a given memory address \"\"\"\n    from numba import types, cgutils\n    sig = types.voidptr(src)\n\n    def codegen(cgctx, builder, sig, args):\n        return builder.inttoptr(args[0], cgutils.voidptr_t)\n    return sig, codegen\n\ndef create_jit_integrand_function(integrand_function,args_dtype):\n    jitted_function = nb.njit(integrand_function)\n\n    #double func(double x, void *user_data)\n    @nb.cfunc(types.float64(types.float64,types.CPointer(args_dtype)))\n    def wrapped(x1,user_data_p):\n        #Array of structs\n        user_data = nb.carray(user_data_p, 1)\n\n        #Extract the data\n        x2=user_data[0].a\n        array1=nb.carray(address_as_void_pointer(user_data[0].foo_p),(user_data[0].foo_s1,user_data[0].foo_s2),dtype=np.float64)\n        array2=nb.carray(address_as_void_pointer(user_data[0].bar_p),(user_data[0].bar_s1,user_data[0].bar_s2),dtype=np.float64)\n\n        return jitted_function(x1, x2, array1, array2)\n    return wrapped\n\ndef function_using_arrays(x1, x2, array1, array2):\n    res1 = np.interp(x1, array1[0], array1[1])\n    res2 = np.interp(x2, array2[0], array2[1])\n\n    return res1 + res2\n\ndef do_integrate_w_arrays(func,args,lolim=0, hilim=1):\n    integrand_func=LowLevelCallable(func.ctypes,user_data=args.ctypes.data_as(ctypes.c_void_p))\n    return integrate.quad(integrand_func, lolim, hilim)\n\n#Define the datatype of the struct array\n#Pointers are not allowed, therefore we use int64\nargs_dtype = types.Record.make_c_struct([\n    ('a', types.float64),\n    ('foo_p',  types.int64),\n    ('foo_s1', types.int64),\n    ('foo_s2', types.int64),\n    ('bar_p',  types.int64),\n    ('bar_s1', types.int64),\n    ('bar_s2', types.int64),])\n\n#creating some sample data\n#The arrays must be c-contigous\n#To ensure that you can use np.ascontiguousarray\n\na=3\nfoo = np.ascontiguousarray(np.arange(200, dtype=np.float64).reshape(2, -1))\nbar = np.ascontiguousarray(np.arange(600, dtype=np.float64).reshape(2, -1))\n\n\nargs=np.array((a,foo.ctypes.data,foo.shape[0],foo.shape[1],\n                 bar.ctypes.data,bar.shape[0],bar.shape[1]),dtype=args_dtype)\n\n#compile the integration function (array-shapes are fixed)\n#There is only a structured array like args allowed\nfunc=create_jit_integrand_function(function_using_arrays,args_dtype)\n\n\nprint(do_integrate_w_arrays(func,args, lolim=0, hilim=1))\n</code></pre>\n\n<p><strong>Old version</strong></p>\n\n<p>As I am passing a <a href=\"https://docs.scipy.org/doc/numpy-1.15.0/user/basics.rec.html\" rel=\"nofollow noreferrer\">Structured array</a> a recompilation is needed if the array shapes or datatypes changes. This isn't a limitation of the API itself. \nThere must a way how to do this in an easier way (Maybe using Tuples?)</p>\n\n<p><strong>Implementation</strong></p>\n\n<pre><code>import numpy as np\nimport numba as nb\nfrom numba import types\nfrom scipy import integrate, LowLevelCallable\nimport ctypes\n\ndef create_jit_integrand_function(integrand_function,args,args_dtype):\n    jitted_function = nb.njit(integrand_function)\n\n    @nb.cfunc(types.float64(types.float64,types.CPointer(args_dtype)))\n    def wrapped(x1,user_data_p):\n        #Array of structs\n        user_data = nb.carray(user_data_p, 1)\n\n        #Extract the data\n        x2=user_data[0].a\n        array1=user_data[0].foo\n        array2=user_data[0].bar\n\n        return jitted_function(x1, x2, array1, array2)\n    return wrapped\n\ndef function_using_arrays(x1, x2, array1, array2):\n    res1 = np.interp(x1, array1[0], array1[1])\n    res2 = np.interp(x2, array2[0], array2[1])\n\n    return res1 + res2\n\ndef jit_with_dummy_data(args,args_dtype):\n    func=create_jit_integrand_function(function_using_arrays,args,args_dtype)\n    return func\n\ndef do_integrate_w_arrays(func,args,lolim=0, hilim=1):\n    integrand_func=LowLevelCallable(func.ctypes,user_data=args.ctypes.data_as(ctypes.c_void_p))\n    return integrate.quad(integrand_func, lolim, hilim)\n</code></pre>\n\n<p><strong>Using the Implementation</strong></p>\n\n<pre><code>#creating some sample data\na=3\nfoo = np.arange(200, dtype=np.float64).reshape(2, -1)\nbar = np.arange(600, dtype=np.float64).reshape(2, -1)\n\nargs_dtype = types.Record.make_c_struct([\n    ('a', types.float64),\n    ('foo', types.NestedArray(dtype=types.float64, shape=foo.shape)),\n    ('bar', types.NestedArray(dtype=types.float64, shape=bar.shape)),])\n\nargs=np.array((a,foo,bar),dtype=args_dtype)\n\n#compile the integration function (array-shapes are fixed)\n#There is only a structured array like args allowed\nfunc=jit_with_dummy_data(args,args_dtype)\n\n\nprint(do_integrate_w_arrays(func,args, lolim=0, hilim=1))\n</code></pre>\n"}], "owner": {"reputation": 451, "user_id": 4276112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/361b5255525c16f7049a5644295c7d2c?s=128&d=identicon&r=PG&f=1", "display_name": "mosegui", "link": "https://stackoverflow.com/users/4276112/mosegui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1234, "favorite_count": 3, "answer_count": 1, "score": 4, "last_activity_date": 1588692097, "creation_date": 1571259149, "last_edit_date": 1572184463, "question_id": 58421549, "link": "https://stackoverflow.com/questions/58421549/passing-numpy-arrays-as-arguments-to-numba-cfunc", "title": "Passing NumPy arrays as arguments to numba.cfunc", "body": "<p>I have been fighting with an issue that I am having trouble wrapping my head around, and therefore don't quite know how to start solving it. My experience in programming C is very limited and that is, I think, the reason for which I cannot make progress.</p>\n\n<p>I have some function that uses <code>numpy.interp</code> and <code>scipy.integrate.quad</code> to carry out a certain integral. Since I use <code>quad</code> for the integration, and according to its documentation:</p>\n\n<blockquote>\n  <p>A Python function or method to integrate. If <code>func</code> takes many\n  arguments, it is integrated along the axis corresponding to the first\n  argument.</p>\n  \n  <p>If the user desires improved integration performance, then <code>f</code> may be a\n  <code>scipy.LowLevelCallable</code> with one of the signatures:</p>\n\n<pre><code>double func(double x)\ndouble func(double x, void *user_data) \ndouble func(int n, double *xx) \ndouble func(int n, double *xx, void *user_data) \n</code></pre>\n  \n  <p>The user_data is the data contained in the <code>scipy.LowLevelCallable</code>. In the\n  call forms with <code>xx</code>, <code>n</code> is the length of\n  the <code>xx</code> array which contains <code>xx[0] == x</code> and the rest of the items are\n  numbers contained in the args argument of quad.</p>\n  \n  <p>In addition, certain ctypes call signatures are supported for backward\n  compatibility, but those should not be used in new code.</p>\n</blockquote>\n\n<p>I need to use the <code>scipy.LowLevelCallable</code> objects for speeding up my code, and I need to stick my function design to one of the above signatures. Moreover, since I do not want to be complicating the whole thing with C libraries and compilers, I want to solve this \"on the fly\" with the tools available from <code>numba</code>, in particular <code>numba.cfunc</code>, which allows me to by-pass the Python C API.</p>\n\n<p>I have been able to solve this for an integrand that takes as an input the integration variable and an arbitrary number of scalar parameters:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>    from scipy import integrate, LowLevelCallable\n    from numba import njit, cfunc\n    from numba.types import intc, float64, CPointer\n\n\n    def jit_integrand_function(integrand_function):\n        jitted_function = njit(integrand_function)\n\n        @cfunc(float64(intc, CPointer(float64)))\n        def wrapped(n, xx):\n            return jitted_function(xx[0], xx[1], xx[2], xx[3])\n        return LowLevelCallable(wrapped.ctypes)\n\n    @jit_integrand_function\n    def regular_function(x1, x2, x3, x4):\n        return x1 + x2 + x3 + x4\n\n    def do_integrate_wo_arrays(a, b, c, lolim=0, hilim=1):\n        return integrate.quad(regular_function, lolim, hilim, (a, b, c))\n\n    &gt;&gt;&gt; print(do_integrate_wo_arrays(1,2,3,lolim=2, hilim=10))\n    (96.0, 1.0658141036401503e-12)\n</code></pre>\n\n<p>This code works just fine. I am able to jit the integrand function and return the jitted function as a <code>LowLevelCallable</code> object. However, I actually need to pass to my integrand two <code>numpy.array</code>s, and the above construction breaks:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>    from scipy import integrate, LowLevelCallable\n    from numba import njit, cfunc\n    from numba.types import intc, float64, CPointer\n\n\n    def jit_integrand_function(integrand_function):\n        jitted_function = njit(integrand_function)\n\n        @cfunc(float64(intc, CPointer(float64)))\n        def wrapped(n, xx):\n            return jitted_function(xx[0], xx[1], xx[2], xx[3])\n        return LowLevelCallable(wrapped.ctypes)\n\n    @jit_integrand_function\n    def function_using_arrays(x1, x2, array1, array2):\n        res1 = np.interp(x1, array1[0], array1[1])\n        res2 = np.interp(x2, array2[0], array2[1])\n\n        return res1 + res2\n\n    def do_integrate_w_arrays(a, lolim=0, hilim=1):\n        foo = np.arange(20, dtype=np.float).reshape(2, -1)\n        bar = np.arange(60, dtype=np.float).reshape(2, -1)\n\n        return integrate.quad(function_using_arrays, lolim, hilim, (a, foo, bar))\n\n\n    &gt;&gt;&gt; print(do_integrate_w_arrays(3, lolim=2, hilim=10))\n    Traceback (most recent call last):\n      File \"C:\\ProgramData\\Miniconda3\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 3267, in run_code\n        exec(code_obj, self.user_global_ns, self.user_ns)\n      File \"&lt;ipython-input-63-69c0074d4936&gt;\", line 1, in &lt;module&gt;\n        runfile('C:/Users/mosegui/Desktop/fos4x_pkg_develop/python-packages/fos4x_tec/fos4x_tec/test_scipy_numba.py', wdir='C:/Users/mosegui/Desktop/fos4x_pkg_develop/python-packages/fos4x_tec/fos4x_tec')\n      File \"C:\\Program Files\\JetBrains\\PyCharm Community Edition 2018.3.4\\helpers\\pydev\\_pydev_bundle\\pydev_umd.py\", line 197, in runfile\n        pydev_imports.execfile(filename, global_vars, local_vars)  # execute the script\n      File \"C:\\Program Files\\JetBrains\\PyCharm Community Edition 2018.3.4\\helpers\\pydev\\_pydev_imps\\_pydev_execfile.py\", line 18, in execfile\n        exec(compile(contents+\"\\n\", file, 'exec'), glob, loc)\n      File \"C:/Users/mosegui/Desktop/fos4x_pkg_develop/python-packages/fos4x_tec/fos4x_tec/test_scipy_numba.py\", line 29, in &lt;module&gt;\n        @jit_integrand_function\n      File \"C:/Users/mosegui/Desktop/fos4x_pkg_develop/python-packages/fos4x_tec/fos4x_tec/test_scipy_numba.py\", line 13, in jit_integrand_function\n        @cfunc(float64(intc, CPointer(float64)))\n      File \"C:\\Users\\mosegui\\AppData\\Roaming\\Python\\Python36\\site-packages\\numba\\decorators.py\", line 260, in wrapper\n        res.compile()\n      File \"C:\\Users\\mosegui\\AppData\\Roaming\\Python\\Python36\\site-packages\\numba\\compiler_lock.py\", line 32, in _acquire_compile_lock\n        return func(*args, **kwargs)\n      File \"C:\\Users\\mosegui\\AppData\\Roaming\\Python\\Python36\\site-packages\\numba\\ccallback.py\", line 69, in compile\n        cres = self._compile_uncached()\n      File \"C:\\Users\\mosegui\\AppData\\Roaming\\Python\\Python36\\site-packages\\numba\\ccallback.py\", line 82, in _compile_uncached\n        cres = self._compiler.compile(sig.args, sig.return_type)\n      File \"C:\\Users\\mosegui\\AppData\\Roaming\\Python\\Python36\\site-packages\\numba\\dispatcher.py\", line 81, in compile\n        raise retval\n      File \"C:\\Users\\mosegui\\AppData\\Roaming\\Python\\Python36\\site-packages\\numba\\dispatcher.py\", line 91, in _compile_cached\n        retval = self._compile_core(args, return_type)\n      File \"C:\\Users\\mosegui\\AppData\\Roaming\\Python\\Python36\\site-packages\\numba\\dispatcher.py\", line 109, in _compile_core\n        pipeline_class=self.pipeline_class)\n      File \"C:\\Users\\mosegui\\AppData\\Roaming\\Python\\Python36\\site-packages\\numba\\compiler.py\", line 528, in compile_extra\n        return pipeline.compile_extra(func)\n      File \"C:\\Users\\mosegui\\AppData\\Roaming\\Python\\Python36\\site-packages\\numba\\compiler.py\", line 326, in compile_extra\n        return self._compile_bytecode()\n      File \"C:\\Users\\mosegui\\AppData\\Roaming\\Python\\Python36\\site-packages\\numba\\compiler.py\", line 385, in _compile_bytecode\n        return self._compile_core()\n      File \"C:\\Users\\mosegui\\AppData\\Roaming\\Python\\Python36\\site-packages\\numba\\compiler.py\", line 365, in _compile_core\n        raise e\n      File \"C:\\Users\\mosegui\\AppData\\Roaming\\Python\\Python36\\site-packages\\numba\\compiler.py\", line 356, in _compile_core\n        pm.run(self.state)\n      File \"C:\\Users\\mosegui\\AppData\\Roaming\\Python\\Python36\\site-packages\\numba\\compiler_machinery.py\", line 328, in run\n        raise patched_exception\n      File \"C:\\Users\\mosegui\\AppData\\Roaming\\Python\\Python36\\site-packages\\numba\\compiler_machinery.py\", line 319, in run\n        self._runPass(idx, pass_inst, state)\n      File \"C:\\Users\\mosegui\\AppData\\Roaming\\Python\\Python36\\site-packages\\numba\\compiler_lock.py\", line 32, in _acquire_compile_lock\n        return func(*args, **kwargs)\n      File \"C:\\Users\\mosegui\\AppData\\Roaming\\Python\\Python36\\site-packages\\numba\\compiler_machinery.py\", line 281, in _runPass\n        mutated |= check(pss.run_pass, internal_state)\n      File \"C:\\Users\\mosegui\\AppData\\Roaming\\Python\\Python36\\site-packages\\numba\\compiler_machinery.py\", line 268, in check\n        mangled = func(compiler_state)\n      File \"C:\\Users\\mosegui\\AppData\\Roaming\\Python\\Python36\\site-packages\\numba\\typed_passes.py\", line 94, in run_pass\n        state.locals)\n      File \"C:\\Users\\mosegui\\AppData\\Roaming\\Python\\Python36\\site-packages\\numba\\typed_passes.py\", line 66, in type_inference_stage\n        infer.propagate()\n      File \"C:\\Users\\mosegui\\AppData\\Roaming\\Python\\Python36\\site-packages\\numba\\typeinfer.py\", line 951, in propagate\n        raise errors[0]\n    numba.errors.TypingError: Failed in nopython mode pipeline (step: nopython frontend)\n    Failed in nopython mode pipeline (step: nopython frontend)\n    Invalid use of Function(&lt;built-in function getitem&gt;) with argument(s) of type(s): (float64, Literal[int](0))\n     * parameterized\n    In definition 0:\n        All templates rejected with literals.\n    In definition 1:\n        All templates rejected without literals.\n    In definition 2:\n        All templates rejected with literals.\n    In definition 3:\n        All templates rejected without literals.\n    In definition 4:\n        All templates rejected with literals.\n    In definition 5:\n        All templates rejected without literals.\n    In definition 6:\n        All templates rejected with literals.\n    In definition 7:\n        All templates rejected without literals.\n    In definition 8:\n        All templates rejected with literals.\n    In definition 9:\n        All templates rejected without literals.\n    In definition 10:\n        All templates rejected with literals.\n    In definition 11:\n        All templates rejected without literals.\n    In definition 12:\n        All templates rejected with literals.\n    In definition 13:\n        All templates rejected without literals.\n    This error is usually caused by passing an argument of a type that is unsupported by the named function.\n    [1] During: typing of intrinsic-call at C:/Users/mosegui/Desktop/fos4x_pkg_develop/python-packages/fos4x_tec/fos4x_tec/test_scipy_numba.py (32)\n    [2] During: typing of static-get-item at C:/Users/mosegui/Desktop/fos4x_pkg_develop/python-packages/fos4x_tec/fos4x_tec/test_scipy_numba.py (32)\n    File \"test_scipy_numba.py\", line 32:\n    def diff_moment_edge(radius, alpha, chord_df, aerodyn_df):\n        &lt;source elided&gt;\n        # # calculate blade twist for radius\n        # sensor_twist = np.arctan((2 * rated_wind_speed) / (3 * rated_rotor_speed * (sensor_radius / 30.0) * radius)) * (180.0 / np.pi)\n        ^\n    [1] During: resolving callee type: type(CPUDispatcher(&lt;function function_using_arrays at 0x0000020C811827B8&gt;))\n    [2] During: typing of call at C:/Users/mosegui/Desktop/fos4x_pkg_develop/python-packages/fos4x_tec/fos4x_tec/test_scipy_numba.py (15)\n    [3] During: resolving callee type: type(CPUDispatcher(&lt;function function_using_arrays at 0x0000020C811827B8&gt;))\n    [4] During: typing of call at C:/Users/mosegui/Desktop/fos4x_pkg_develop/python-packages/fos4x_tec/fos4x_tec/test_scipy_numba.py (15)\n    File \"test_scipy_numba.py\", line 15:\n    def jit_integrand_function(integrand_function):\n        &lt;source elided&gt;\n        jitted_function = njit(integrand_function)\n     ^\n\n</code></pre>\n\n<p>Well now, obviously this doesn't work, because in this example I have not modified the design of the decorator. But that is exactly the core of my question: I do not fully understand this situation and therefore don't know how to modify the <code>cfunc</code> arguments for passing an array as parameter and still complying with the <code>scipy.integrate.quad</code> signature requirements. In the <code>numba</code> documentation that introduces <code>CPointers</code> there is an example of how to pass an array to a <code>numba.cfunc</code>:</p>\n\n<blockquote>\n  <p>Native platform ABIs as used by C or C++ don\u2019t have the notion of a\n  shaped array as in Numpy. One common solution is to pass a raw data\n  pointer and one or several size arguments (depending on\n  dimensionality). Numba must provide a way to rebuild an array view of\n  this data inside the callback.</p>\n  \n  <pre class=\"lang-py prettyprint-override\"><code>    from numba import cfunc, carray\n    from numba.types import float64, CPointer, void, intp\n\n    # A callback with the C signature `void(double *, double *, size_t)`\n\n    @cfunc(void(CPointer(float64), CPointer(float64), intp))\n    def invert(in_ptr, out_ptr, n):\n        in_ = carray(in_ptr, (n,))\n        out = carray(out_ptr, (n,))\n        for i in range(n):\n            out[i] = 1 / in_[i] ```\n</code></pre>\n</blockquote>\n\n<p>I somehow understand that the <code>CPointer</code> is used for building the array in C, as in the signature of my decorator example <code>CPointer(float64)</code> gathers all the floats passed as arguments and puts them into an array. However, I am still not able to put it together and see how I can use it for passing an array, not for making an array out of the collection of <code>float</code> arguments I pass.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>The answer by <code>@max9111</code> worked, in the sense that was able to pass to the <code>scipy.integrate.quad</code> a <code>LowLevelCallable</code> that improved the time efficiency of the calculation. This is very valuable, as now it is much clearer how management of memory addresses work in C. Even though the concept of structured array does not exist in native C, I can create a structured array in Python with data that C is going to store in a contiguous memory region and access it/point to it through a unique memory address. The mapping provided by the structured array allows for identifying the different components of that memory region.</p>\n\n<p>Even though the solution by <code>@max9111</code> works and solves the question I posted originally, from the Python perspective this approach introduces a certain overhead that, under certain conditions, might be more time consuming than the time gained by now calling the <code>scipy.integrate.quad</code> integration function via a <code>LowLevelCallable</code>. </p>\n\n<p>In my real case I am using the integration as a step of a two-dimensional optimization problem. Each step of the optimization requires to integrate twice, and the integral requires nine scalar parameters ad two arrays. As long as I have not been able to solve the integration via a <code>LowLevelCallable</code>, the only thing I could do to speed up the code was to simply <code>njit</code> the integrand function. And that worked decently even though the integration was still being fired via the Python API.</p>\n\n<p>In my case, implementing <code>@max9111</code>'s solution has greatly improved the efficiency in the integration time (from about 0.0009s per step to about 0.0005 ). Nevertheless, the step of creating the structured array, C-unpacking the data, pass it to the jitted integrand and return a <code>LowLevelCallable</code> has added an extra 0.3s on average per iteration, thereby worsening my situation.</p>\n\n<p>Here there is some toy code for showing how the <code>LowLevelCallable</code> approach becomes the worse option the more one goes for an iterative process:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>    import ctypes\n    import timeit\n\n    from tqdm import tqdm\n    import numpy as np\n    from scipy import integrate, LowLevelCallable\n    import numba as nb\n    from numba import types\n    import matplotlib.pyplot as plt\n\n\n    ##################################################\n    # creating some sample data and parameters\n    a = 3\n    foo = np.arange(200, dtype=np.float64).reshape(2, -1)\n    bar = np.arange(600, dtype=np.float64).reshape(2, -1)\n\n    lim1 = 0\n    lim2 = 1\n\n    @nb.njit\n    def function_using_arrays(x1, x2, array1, array2):\n        res1 = np.interp(x1, array1[0], array1[1])\n        res2 = np.interp(x2, array2[0], array2[1])\n\n        return res1 + res2\n\n\n    ##################################################\n    # JIT INTEGRAND\n\n    def do_integrate_w_arrays_jit(a, array1, array2, lolim=0, hilim=1):\n        return integrate.quad(function_using_arrays, lolim, hilim, (a, array1, array2))\n\n    def process_jit_integrand():\n        do_integrate_w_arrays_jit(a, foo, bar, lolim=lim1, hilim=lim2)\n\n\n    ##################################################\n    # LOWLEV CALLABLE\n\n    def create_jit_integrand_function(integrand_function,args,args_dtype):\n        @nb.cfunc(types.float64(types.float64,types.CPointer(args_dtype)))\n        def wrapped(x1,user_data_p):\n            #Array of structs\n            user_data = nb.carray(user_data_p, 1)\n\n            #Extract the data\n            x2=user_data[0].a\n            array1=user_data[0].foo\n            array2=user_data[0].bar\n\n            return integrand_function(x1, x2, array1, array2)\n        return wrapped\n\n\n    def do_integrate_w_arrays_lowlev(func,args,lolim=0, hilim=1):\n        integrand_func = LowLevelCallable(func.ctypes,user_data=args.ctypes.data_as(ctypes.c_void_p))\n        return integrate.quad(integrand_func, lolim, hilim)\n\n\n    def process_lowlev_callable():\n        args_dtype = types.Record.make_c_struct([\n            ('a', types.float64),\n            ('foo', types.NestedArray(dtype=types.float64, shape=foo.shape)),\n            ('bar', types.NestedArray(dtype=types.float64, shape=bar.shape)),])\n\n        args=np.array((a, foo, bar), dtype=args_dtype)\n\n        func = create_jit_integrand_function(function_using_arrays,args,args_dtype)\n\n        do_integrate_w_arrays_lowlev(func, args, lolim=0, hilim=1)\n\n\n    ##################################################\n\n    repetitions = range(100)\n\n    jit_integrand_delays = [timeit.timeit(stmt=process_jit_integrand, \n    number=repetition) for repetition in tqdm(repetitions)]\n    lowlev_callable_delays = [timeit.timeit(stmt=process_lowlev_callable, \n    number=repetition) for repetition in tqdm(repetitions)]\n\n    fig, ax = plt.subplots()\n    ax.plot(repetitions, jit_integrand_delays, label=\"jit_integrand\")\n    ax.plot(repetitions, lowlev_callable_delays, label=\"lowlev_callable\")\n    ax.set_xlabel('number of repetitions')\n    ax.set_ylabel('calculation time (s)')\n    ax.set_title(\"Comparison calculation time\")\n    plt.tight_layout()\n    plt.legend()\n    plt.savefig(f'calculation_time_comparison_{repetitions[-1]}_reps.png')\n</code></pre>\n\n<p>Here the two options (only jitting the integrand vs. <code>@max9111</code>'s solution) are compared. In a modified version of <code>@max9111</code>'s solution, I have permanently jitted the integrand function (<code>function_using_arrays</code>) and removed that step from <code>create_jit_integrand_function</code>, which reduces the \"overhead\" time by a neat 20%. Moreover, also for the sake of speed, I have suppressed the <code>jit_with_dummy_data</code> function and included its functionality in the body of <code>process_lowlev_callable</code>, basically for avoiding an unnecessary function call. Find in the following the calculation time for both solutions for a series of up to 100 cycles:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Kgvxn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kgvxn.png\" alt=\"Calculation time ellapsed for only jitting the integrand vs building a LowLevelCallable\"></a> </p>\n\n<p>As you can see, if you are in an iterative process, the time saved in each single calculation (30+ %!!) does not pay off the overhead carried by the couple extra functions that you need to implement for building the LowLevelCallable (functions that are as well called iteratively and run over the Python C API).</p>\n\n<p>Bottom line: this solution is very good for reducing calculation time in one single very heavy integral, but just jitting the integrand seems to be better off when solving average integrals within an iterative process, since the extra functions required by the LowlevelCallable, that need to be called as much often as the integration itself, take their toll.</p>\n\n<p>Anyway, thank you very much. Even though this solution will not work for me, I learned valuable things and I consider my question solved.</p>\n\n<p><strong>EDIT 2:</strong></p>\n\n<p>I misunderstood parts of <code>@max9111</code>'s solution and the role played by the function <code>create_jit_integrand_function</code>, and I was wrongly compiling the <code>LowLevelCallable</code> in each step of my optimization (which I do not need to do beacuse, even though the parameters and arrays passed to the integral change each iteration, their shape, and therefore that of the C struct remains constant).</p>\n\n<p>The refactored version of the code from the above <strong>EDIT</strong> that makes sense:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>\n    import ctypes\n    import timeit\n\n    from tqdm import tqdm\n    import numpy as np\n    from scipy import integrate, LowLevelCallable\n    import numba as nb\n    from numba import types\n    import matplotlib.pyplot as plt\n\n\n    ##################################################\n    # creating some sample data and parameters\n    a = 3\n    foo = np.arange(200, dtype=np.float64).reshape(2, -1)\n    bar = np.arange(600, dtype=np.float64).reshape(2, -1)\n\n    lim1 = 0\n    lim2 = 1\n\n\n    def function_using_arrays(x1, x2, array1, array2):\n        res1 = np.interp(x1, array1[0], array1[1])\n        res2 = np.interp(x2, array2[0], array2[1])\n\n        return res1 + res2\n\n\n    ##################################################\n    # JIT INTEGRAND\n\n    def do_integrate_w_arrays_jit(a, array1, array2, lolim=0, hilim=1):\n        return integrate.quad(nb.njit(function_using_arrays), lolim, hilim, (a, array1, array2))\n\n    def process_jit_integrand():\n        do_integrate_w_arrays_jit(a, foo, bar, lolim=lim1, hilim=lim2)\n\n\n    ##################################################\n    # LOWLEV CALLABLE\n\n    def create_jit_integrand_function(integrand_function, args_dtype):\n        jitted_function = nb.njit(integrand_function)\n\n        @nb.cfunc(types.float64(types.float64,types.CPointer(args_dtype)))\n        def wrapped(x1,user_data_p):\n            #Array of structs\n            user_data = nb.carray(user_data_p, 1)\n\n            #Extract the data\n            x2=user_data[0].a\n            array1=user_data[0].foo\n            array2=user_data[0].bar\n\n            return jitted_function(x1, x2, array1, array2)\n        return wrapped\n\n\n    def do_integrate_w_arrays_lowlev(func,args,lolim=0, hilim=1):\n        integrand_func=LowLevelCallable(func.ctypes,user_data=args.ctypes.data_as(ctypes.c_void_p))\n        return integrate.quad(integrand_func, lolim, hilim)\n\n\n    def process_lowlev_callable():\n        do_integrate_w_arrays_lowlev(func, np.array((a, foo, bar), dtype=args_dtype), lolim=0, hilim=1)\n\n\n    ##################################################\n\n    repetitions = range(100)\n\n    jit_integrand_delays = [timeit.timeit(stmt=process_jit_integrand, number=repetition) for repetition in tqdm(repetitions)]\n\n\n    args_dtype = types.Record.make_c_struct([\n            ('a', types.float64),\n            ('foo', types.NestedArray(dtype=types.float64, shape=foo.shape)),\n            ('bar', types.NestedArray(dtype=types.float64, shape=bar.shape)),])\n    func = create_jit_integrand_function(function_using_arrays, args_dtype)\n\n\n    lowlev_callable_delays = [timeit.timeit(stmt=process_lowlev_callable, number=repetition) for repetition in tqdm(repetitions)]\n\n    fig, ax = plt.subplots()\n    ax.plot(repetitions, jit_integrand_delays, label=\"jit_integrand\")\n    ax.plot(repetitions, lowlev_callable_delays, label=\"lowlev_callable\")\n    ax.set_xlabel('number of repetitions')\n    ax.set_ylabel('calculation time (s)')\n    ax.set_title(\"Comparison calculation time\")\n    plt.tight_layout()\n    plt.legend()\n    plt.savefig(f'calculation_time_comparison_{repetitions[-1]}_reps.png')\n\n</code></pre>\n\n<p>In this configuration, the building of the <code>LowLevelCallable</code> (which indeed costs a bit of time) only has to be carried out once, and the overall process is orders of magnitude faster:</p>\n\n<p><a href=\"https://i.stack.imgur.com/80ANT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/80ANT.png\" alt=\"enter image description here\"></a></p>\n\n<p>and the close-up for the <code>lowlev_callable</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/PmlQf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PmlQf.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["python", "flask", "server"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 5916686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c94b3bb6ee8bf3bb5630bc098be6b88?s=128&d=identicon&r=PG&f=1", "display_name": "kibe", "link": "https://stackoverflow.com/users/5916686/kibe"}, "edited": false, "score": 0, "creation_date": 1571260425, "post_id": 58421670, "comment_id": 103185742, "body": "Mmm, thanks. Do you by any chance know if there is a way to have multiple sessions at the same time? Because I already have one for the user&#39;s ID."}, {"owner": {"reputation": 4107, "user_id": 9770840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/984adcd06e81b4ed593225545018aacb?s=128&d=identicon&r=PG&f=1", "display_name": "Attersson", "link": "https://stackoverflow.com/users/9770840/attersson"}, "edited": false, "score": 1, "creation_date": 1571260861, "post_id": 58421670, "comment_id": 103185897, "body": "A session is a cookie stored on the client&#39;s computer. On the user&#39;s machine. Sessions are already supposed to be multiple... <a href=\"https://www.tutorialspoint.com/flask/flask_sessions.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/flask/flask_sessions.htm</a> Record some username or generate a random hash to differentiate them and store in the database (with the user key) if you must."}], "tags": [], "owner": {"reputation": 620, "user_id": 6800111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ppGib.jpg?s=128&g=1", "display_name": "tjholub", "link": "https://stackoverflow.com/users/6800111/tjholub"}, "is_accepted": true, "score": 2, "last_activity_date": 1571259758, "creation_date": 1571259758, "answer_id": 58421670, "question_id": 58421542, "link": "https://stackoverflow.com/questions/58421542/when-are-context-processors-called/58421670#58421670", "title": "When are context processors called?", "body": "<p>Per the <a href=\"https://flask.palletsprojects.com/en/1.1.x/templating/#context-processors\" rel=\"nofollow noreferrer\">docs</a>:</p>\n\n<blockquote>\n  <p>Context processors run before the template is rendered and have the ability to \n  inject new values into the template context</p>\n</blockquote>\n\n<p>If you're not rendering a template I wouldn't expect to have the context processor run.</p>\n\n<p>If you don't want to hit your database on every rendered template, you could use <code>flask.session</code> to store a user's cash, then update the session value appropriately.</p>\n"}, {"comments": [{"owner": {"reputation": 620, "user_id": 6800111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ppGib.jpg?s=128&g=1", "display_name": "tjholub", "link": "https://stackoverflow.com/users/6800111/tjholub"}, "edited": false, "score": 0, "creation_date": 1571261086, "post_id": 58421818, "comment_id": 103185987, "body": "As long as the <code>session[&#39;cash&#39;]</code> is updated when needed, I would stick with the context_processor and just grab it from the session"}, {"owner": {"reputation": 4107, "user_id": 9770840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/984adcd06e81b4ed593225545018aacb?s=128&d=identicon&r=PG&f=1", "display_name": "Attersson", "link": "https://stackoverflow.com/users/9770840/attersson"}, "reply_to_user": {"reputation": 620, "user_id": 6800111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ppGib.jpg?s=128&g=1", "display_name": "tjholub", "link": "https://stackoverflow.com/users/6800111/tjholub"}, "edited": false, "score": 0, "creation_date": 1571261173, "post_id": 58421818, "comment_id": 103186017, "body": "I think the context processor just binds it when it loads the page.... However please try and let me know"}, {"owner": {"reputation": 620, "user_id": 6800111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ppGib.jpg?s=128&g=1", "display_name": "tjholub", "link": "https://stackoverflow.com/users/6800111/tjholub"}, "edited": false, "score": 0, "creation_date": 1571261264, "post_id": 58421818, "comment_id": 103186057, "body": "context processor passes the value into the template context, we&#39;re just pulling it out of the session instead of the database"}, {"owner": {"reputation": 73, "user_id": 5916686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c94b3bb6ee8bf3bb5630bc098be6b88?s=128&d=identicon&r=PG&f=1", "display_name": "kibe", "link": "https://stackoverflow.com/users/5916686/kibe"}, "reply_to_user": {"reputation": 620, "user_id": 6800111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ppGib.jpg?s=128&g=1", "display_name": "tjholub", "link": "https://stackoverflow.com/users/6800111/tjholub"}, "edited": false, "score": 0, "creation_date": 1571262327, "post_id": 58421818, "comment_id": 103186387, "body": "@afro I think I&#39;m just over complicating stuff but thanks you guys. I think my solution is just to set <code>session[&quot;user_cash&quot;] = #getUser&#39;sCashFromDatabase...</code> only ONCE when the user logs in and then whenever the user buys or sells something, I just update it with: <code>session[&quot;user_cash&quot;] = #newValue</code>. I feel dumb now"}, {"owner": {"reputation": 620, "user_id": 6800111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ppGib.jpg?s=128&g=1", "display_name": "tjholub", "link": "https://stackoverflow.com/users/6800111/tjholub"}, "edited": false, "score": 0, "creation_date": 1571262458, "post_id": 58421818, "comment_id": 103186430, "body": "that&#39;s pretty much the idea"}, {"owner": {"reputation": 73, "user_id": 5916686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c94b3bb6ee8bf3bb5630bc098be6b88?s=128&d=identicon&r=PG&f=1", "display_name": "kibe", "link": "https://stackoverflow.com/users/5916686/kibe"}, "reply_to_user": {"reputation": 620, "user_id": 6800111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ppGib.jpg?s=128&g=1", "display_name": "tjholub", "link": "https://stackoverflow.com/users/6800111/tjholub"}, "edited": false, "score": 0, "creation_date": 1571264197, "post_id": 58421818, "comment_id": 103186965, "body": "@afro Just one last question: is it dangerous to call <code>session[&quot;user_cash&quot;]</code> in front end using Javascript? Say: <code>alert({{ session[&quot;user_cash&quot;) }});</code>"}, {"owner": {"reputation": 4107, "user_id": 9770840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/984adcd06e81b4ed593225545018aacb?s=128&d=identicon&r=PG&f=1", "display_name": "Attersson", "link": "https://stackoverflow.com/users/9770840/attersson"}, "reply_to_user": {"reputation": 73, "user_id": 5916686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c94b3bb6ee8bf3bb5630bc098be6b88?s=128&d=identicon&r=PG&f=1", "display_name": "kibe", "link": "https://stackoverflow.com/users/5916686/kibe"}, "edited": false, "score": 0, "creation_date": 1571309813, "post_id": 58421818, "comment_id": 103202541, "body": "@kibe I will answer to you... Javascript has no access to that variable."}, {"owner": {"reputation": 4107, "user_id": 9770840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/984adcd06e81b4ed593225545018aacb?s=128&d=identicon&r=PG&f=1", "display_name": "Attersson", "link": "https://stackoverflow.com/users/9770840/attersson"}, "reply_to_user": {"reputation": 73, "user_id": 5916686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c94b3bb6ee8bf3bb5630bc098be6b88?s=128&d=identicon&r=PG&f=1", "display_name": "kibe", "link": "https://stackoverflow.com/users/5916686/kibe"}, "edited": false, "score": 0, "creation_date": 1571310094, "post_id": 58421818, "comment_id": 103202702, "body": "@kibe Also your original point and the way I understood your question and answered it, was supposed to implement persistency. Sessions are volatile, if the cookie expires or is lost. That way changes are lost. With persistency every single change that had actually made a difference would have been saved to the database for that user. While for your case it proved unnecessary, it is a whole new feature, which I assumed you needed :)"}], "tags": [], "owner": {"reputation": 4107, "user_id": 9770840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/984adcd06e81b4ed593225545018aacb?s=128&d=identicon&r=PG&f=1", "display_name": "Attersson", "link": "https://stackoverflow.com/users/9770840/attersson"}, "is_accepted": false, "score": 1, "last_activity_date": 1571310241, "last_edit_date": 1571310241, "creation_date": 1571260525, "answer_id": 58421818, "question_id": 58421542, "link": "https://stackoverflow.com/questions/58421542/when-are-context-processors-called/58421818#58421818", "title": "When are context processors called?", "body": "<p>(Note: the answer below assumed the need for persistency of changes)</p>\n\n<p>Context processors will run before resolving your template and bind the value of <code>getUserCash</code> to that returned by your function and therefore that value will persist until the template is reloaded.</p>\n\n<p>So context processors are not what you are looking for.</p>\n\n<p>You can however define two flask.session variables <code>session['cash_changed'] = True</code> and <code>session['cash'] = 0</code> to cache the user cash value to be used with a getter and a setter like this:</p>\n\n<pre><code>def getUserCash():\n        if session.get('cash_changed',True):        \n            session['cash'] = # Getter query here to get cash for the specific user\n            session['cash_changed'] = False\n        return session.get('cash',0)\n\ndef setUserCash(value):\n        session['cash_changed'] = True\n        session['cash'] = value\n        # setter query to write the new cash value to the database for the user\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 5916686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c94b3bb6ee8bf3bb5630bc098be6b88?s=128&d=identicon&r=PG&f=1", "display_name": "kibe", "link": "https://stackoverflow.com/users/5916686/kibe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 58421670, "answer_count": 2, "score": 0, "last_activity_date": 1571310241, "creation_date": 1571259104, "last_edit_date": 1571259495, "question_id": 58421542, "link": "https://stackoverflow.com/questions/58421542/when-are-context-processors-called", "title": "When are context processors called?", "body": "<p>I am using context processors (<code>@app.context.processor</code>) to store the user's cash. I am doing this because the user's cash is always going to be displayed on the top of the page, so I don't want to pass it as an argument every single time.</p>\n\n<p>I have this:</p>\n\n<pre><code>@app.context_processor\ndef global_variables():\n    def getUserCash():\n        return Decimal(db.execute(\"SELECT cash FROM users WHERE id = :id\", id=session[\"user_id\"])[0].get(\"cash\", None))\n    return dict(getUserCash=getUserCash)\n</code></pre>\n\n<p>My question is: are context processors functions only updated when the user opens the website for the first time? Or does it get updated every time there's a request in the server (<code>GET</code> and/or <code>POST</code>)?</p>\n\n<p>I am asking this because, for efficiency and optimization, I only want Flask to get the user's cash only once (when the user logs in), and only updates it when the user buys or sells something (not when changing pages).</p>\n\n<p>Is that possible?</p>\n"}, {"tags": ["python", "pandas", "openpyxl"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 12164001, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-35DbySHFP6k/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdgsNazATlU9Ms_NiP_1ktAoSG0_w/photo.jpg?sz=128", "display_name": "Mahmoud Al-Haroon", "link": "https://stackoverflow.com/users/12164001/mahmoud-al-haroon"}, "edited": false, "score": 0, "creation_date": 1571259776, "post_id": 58421602, "comment_id": 103185529, "body": "thanks a lot for your support, but could you specify your answer with details according to my <code>Data Example</code> excel :)"}, {"owner": {"reputation": 7, "user_id": 12164001, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-35DbySHFP6k/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdgsNazATlU9Ms_NiP_1ktAoSG0_w/photo.jpg?sz=128", "display_name": "Mahmoud Al-Haroon", "link": "https://stackoverflow.com/users/12164001/mahmoud-al-haroon"}, "edited": false, "score": 0, "creation_date": 1571260340, "post_id": 58421602, "comment_id": 103185709, "body": "as I have Windows for my case :)"}], "tags": [], "owner": {"reputation": 788, "user_id": 8721389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0310a1c658a91ef2b8876a759d01f23?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Zeldin", "link": "https://stackoverflow.com/users/8721389/adam-zeldin"}, "is_accepted": true, "score": 0, "last_activity_date": 1571259417, "creation_date": 1571259417, "answer_id": 58421602, "question_id": 58421508, "link": "https://stackoverflow.com/questions/58421508/how-to-copy-and-paste-multiple-sheet-for-columns-data-with-the-same-column-name/58421602#58421602", "title": "How to copy and paste multiple sheet for column&#39;s data with the same column name to another excel file", "body": "<p>If you want to copy and paste the data itself, you might consider use of the pywin32 package (if you have Windows)</p>\n\n<pre><code>from win32com.client import Dispatch\nxl = Dispatch(\"Excel.Application\")\nwb1 = xl.Workbooks.Open(Filename=file_name)\nws1 = wb1.Worksheets(sheet_1)\nws2 = wb1.Worksheets(sheet_2)\nws1.Columns(index_number).Copy(ws2.Columns(index_number))\n</code></pre>\n\n<p>If you don't want to use pywin32, you might just import the various columns using </p>\n\n<pre><code>pd.read_excel()\n</code></pre>\n\n<p>and append or concatenate the objects. From there you can save the new dataframe using to_excel.</p>\n"}], "owner": {"reputation": 7, "user_id": 12164001, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-35DbySHFP6k/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdgsNazATlU9Ms_NiP_1ktAoSG0_w/photo.jpg?sz=128", "display_name": "Mahmoud Al-Haroon", "link": "https://stackoverflow.com/users/12164001/mahmoud-al-haroon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 58421602, "answer_count": 1, "score": 0, "last_activity_date": 1571260568, "creation_date": 1571258942, "last_edit_date": 1571260568, "question_id": 58421508, "link": "https://stackoverflow.com/questions/58421508/how-to-copy-and-paste-multiple-sheet-for-columns-data-with-the-same-column-name", "title": "How to copy and paste multiple sheet for column&#39;s data with the same column name to another excel file", "body": "<p>I have two different Excel files One is the master I need to update and the second one contains the data I need to copy and paste So....</p>\n\n<p>This is my master excel file I want to update looks like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/Vq781.png\" rel=\"nofollow noreferrer\">Excel Master</a></p>\n\n<p>and this excel which contains column data I need to copy it to the <code>master file</code>, as thee's are three sheets called <code>GSM_CDDData</code>, <code>UMTS_CDDData</code>, and <code>LTE_CDDData</code> and the three sheets contains the same column name which I need to copy it's data and add them to the <code>Master Excel</code>, as the columns name is <code>CELLNAME</code></p>\n\n<p>and this excel looks like</p>\n\n<p><a href=\"https://i.stack.imgur.com/pMY8X.png\" rel=\"nofollow noreferrer\">Source</a></p>\n\n<p>After Copying this data ,I want to paste them in the <code>Master Excel</code> in column called <code>CELL</code></p>\n\n<p>So any Ideas how to do that?.....</p>\n\n<p>as I know the supported library <code>pandas</code> and <code>openpyxl</code></p>\n"}, {"tags": ["python", "csv"], "comments": [{"owner": {"reputation": 3962, "user_id": 9462829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dd68e18954cab2275b2cc02845a37d9?s=128&d=identicon&r=PG&f=1", "display_name": "Juan C", "link": "https://stackoverflow.com/users/9462829/juan-c"}, "edited": false, "score": 0, "creation_date": 1571259145, "post_id": 58421492, "comment_id": 103185265, "body": "is there any reason you&#39;re not using pandas&#39; <code>read_csv()</code> ?"}, {"owner": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "reply_to_user": {"reputation": 3962, "user_id": 9462829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dd68e18954cab2275b2cc02845a37d9?s=128&d=identicon&r=PG&f=1", "display_name": "Juan C", "link": "https://stackoverflow.com/users/9462829/juan-c"}, "edited": false, "score": 1, "creation_date": 1571259228, "post_id": 58421492, "comment_id": 103185304, "body": "@JuanC well, for starters, it is totally unnecessary and a giant dependency simply to read a csv."}, {"owner": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 2, "creation_date": 1571259303, "post_id": 58421492, "comment_id": 103185334, "body": "You should be using the <a href=\"https://docs.python.org/3.7/library/csv.html\" rel=\"nofollow noreferrer\"><code>csv</code></a> module to parse csv data."}, {"owner": {"reputation": 3962, "user_id": 9462829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dd68e18954cab2275b2cc02845a37d9?s=128&d=identicon&r=PG&f=1", "display_name": "Juan C", "link": "https://stackoverflow.com/users/9462829/juan-c"}, "edited": false, "score": 0, "creation_date": 1571259483, "post_id": 58421492, "comment_id": 103185410, "body": "Thank you for speaking on behalf of @ccf913. They seem to be new, and working on a leisure project, so they&#39;ll probably be installing pandas anyways, which is the easiest way for someone that is new to python.."}], "answers": [{"comments": [{"owner": {"reputation": 1812, "user_id": 11432434, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lYnbtUu9EOU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf-9ybhwxbzBDHJNyQWMDDx97hP7g/mo/photo.jpg?sz=128", "display_name": "SimonN", "link": "https://stackoverflow.com/users/11432434/simonn"}, "reply_to_user": {"reputation": 1, "user_id": 12092229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8940967fb5fe2cd9350654502d5e29fc?s=128&d=identicon&r=PG&f=1", "display_name": "ccf913", "link": "https://stackoverflow.com/users/12092229/ccf913"}, "edited": false, "score": 0, "creation_date": 1573031402, "post_id": 58421550, "comment_id": 103744396, "body": "Please accept my answer if it fully solved your problem."}], "tags": [], "owner": {"reputation": 1812, "user_id": 11432434, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lYnbtUu9EOU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf-9ybhwxbzBDHJNyQWMDDx97hP7g/mo/photo.jpg?sz=128", "display_name": "SimonN", "link": "https://stackoverflow.com/users/11432434/simonn"}, "is_accepted": false, "score": 2, "last_activity_date": 1571259158, "creation_date": 1571259158, "answer_id": 58421550, "question_id": 58421492, "link": "https://stackoverflow.com/questions/58421492/skipping-lines-and-selecting-wrong-cells-while-reading-csv-file/58421550#58421550", "title": "Skipping lines and selecting wrong cells while reading CSV file", "body": "<p>There are commas inside some of the cells and you are splitting on these. When you opened the CSV in Excel (or whatever you used) it knew not to split on these as they are surrounded by quotes. I'd suggest using the Python csv module so you can do the same.</p>\n"}], "owner": {"reputation": 1, "user_id": 12092229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8940967fb5fe2cd9350654502d5e29fc?s=128&d=identicon&r=PG&f=1", "display_name": "ccf913", "link": "https://stackoverflow.com/users/12092229/ccf913"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571262544, "creation_date": 1571258889, "last_edit_date": 1571262544, "question_id": 58421492, "link": "https://stackoverflow.com/questions/58421492/skipping-lines-and-selecting-wrong-cells-while-reading-csv-file", "title": "Skipping lines and selecting wrong cells while reading CSV file", "body": "<p>So I have a csv file that has tons of games and info about them and I'm trying to save the game's publisher and the ESRB rating. But for some reason when I print them out it'll randomly skip games and chose wrong cells.</p>\n\n<p>My code:</p>\n\n<pre><code>def simpleLoop(file_name):\noutput = []\ninput_file = open(file_name, \"r\")\nfor line in input_file:\n    cells = line.split(\",\")\n    output.append((cells[7], cells[13]))\ni = 0\nwhile (i &lt;= 10):\n    print(output[i]) # testing what values i get\n    i += 1\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Fm9Pi.png\" rel=\"nofollow noreferrer\">Screenshot of csv</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/1mOlX.png\" rel=\"nofollow noreferrer\">Output</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/v6Lcp.png\" rel=\"nofollow noreferrer\">Expected Output</a></p>\n\n<p>Any help is appreciated thanks!</p>\n\n<p><strong>Edit: Solved with the help of SimoN</strong></p>\n\n<p>For anyone else facing a similar issue make sure you specify exactly where you want to split. In my case I split at commas but there were commas inside some of the cells. So to fix this I changed:</p>\n\n<pre><code>cells = line.split(\",\")\n</code></pre>\n\n<p>To</p>\n\n<pre><code>cells = line.split('\",\"')\n</code></pre>\n\n<p>Which makes python split after each cell because cells end with a double quote then a comma and the next cell starts with a double quote</p>\n"}, {"tags": ["python", "pip", "cl", "cl.exe", "gmpy"], "comments": [{"owner": {"reputation": 7851, "user_id": 1040452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9090a2be282c8d75dab9cc07c25fb316?s=128&d=identicon&r=PG", "display_name": "Klemen Tusar", "link": "https://stackoverflow.com/users/1040452/klemen-tusar"}, "edited": false, "score": 0, "creation_date": 1571258852, "post_id": 58421429, "comment_id": 103185140, "body": "<code>gmpy</code> looks dead. Try <code>pip install gmpy2</code> maybe? <a href=\"https://pypi.org/project/gmpy2/\" rel=\"nofollow noreferrer\">pypi.org/project/gmpy2</a>"}, {"owner": {"reputation": 3851, "user_id": 4652358, "user_type": "registered", "accept_rate": 92, "profile_image": "https://lh6.googleusercontent.com/-kT5qFfxGmcg/AAAAAAAAAAI/AAAAAAAAAWY/vVkJXBMAmko/photo.jpg?sz=128", "display_name": "Francesco Mantovani", "link": "https://stackoverflow.com/users/4652358/francesco-mantovani"}, "reply_to_user": {"reputation": 7851, "user_id": 1040452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9090a2be282c8d75dab9cc07c25fb316?s=128&d=identicon&r=PG", "display_name": "Klemen Tusar", "link": "https://stackoverflow.com/users/1040452/klemen-tusar"}, "edited": false, "score": 0, "creation_date": 1571259004, "post_id": 58421429, "comment_id": 103185202, "body": "same problem with gmpy2"}], "answers": [{"comments": [{"owner": {"reputation": 3851, "user_id": 4652358, "user_type": "registered", "accept_rate": 92, "profile_image": "https://lh6.googleusercontent.com/-kT5qFfxGmcg/AAAAAAAAAAI/AAAAAAAAAWY/vVkJXBMAmko/photo.jpg?sz=128", "display_name": "Francesco Mantovani", "link": "https://stackoverflow.com/users/4652358/francesco-mantovani"}, "edited": false, "score": 0, "creation_date": 1571258985, "post_id": 58421484, "comment_id": 103185191, "body": "I have the same problem with gmpy2"}, {"owner": {"reputation": 1133, "user_id": 5717792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9202e38570333e9b5b1722042e552e6?s=128&d=identicon&r=PG&f=1", "display_name": "bgfvdu3w", "link": "https://stackoverflow.com/users/5717792/bgfvdu3w"}, "reply_to_user": {"reputation": 3851, "user_id": 4652358, "user_type": "registered", "accept_rate": 92, "profile_image": "https://lh6.googleusercontent.com/-kT5qFfxGmcg/AAAAAAAAAAI/AAAAAAAAAWY/vVkJXBMAmko/photo.jpg?sz=128", "display_name": "Francesco Mantovani", "link": "https://stackoverflow.com/users/4652358/francesco-mantovani"}, "edited": false, "score": 0, "creation_date": 1571262688, "post_id": 58421484, "comment_id": 103186497, "body": "@FrancescoMantovani I&#39;ve updated the answer to link to wheels built for more recent Python versions."}], "tags": [], "owner": {"reputation": 1133, "user_id": 5717792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9202e38570333e9b5b1722042e552e6?s=128&d=identicon&r=PG&f=1", "display_name": "bgfvdu3w", "link": "https://stackoverflow.com/users/5717792/bgfvdu3w"}, "is_accepted": true, "score": 5, "last_activity_date": 1571262650, "last_edit_date": 1571262650, "creation_date": 1571258862, "answer_id": 58421484, "question_id": 58421429, "link": "https://stackoverflow.com/questions/58421429/python-pip-install-gmpy-on-windows-10-returns-cl-exe-failed-with-exit-statu/58421484#58421484", "title": "Python: &quot;pip install gmpy&quot; on Windows 10 returns &quot;cl.exe&#39; failed with exit status 2&quot;", "body": "<p>Well the actual problem is that you are missing some header file <code>gmp.h</code>:</p>\n\n<pre><code>C:\\Users\\franc\\AppData\\Local\\Temp\\pip-install-du1j9u7s\\gmpy\\src\\gmpy.h(30): fatal error C1083: Cannot open include file: 'gmp.h': No such file or directory\n</code></pre>\n\n<p>I suggest you try <a href=\"https://pypi.org/project/gmpy2/\" rel=\"nofollow noreferrer\"><code>gmpy2</code></a>, which is a newer version. It has wheels for Windows on PyPI but they are for older versions of Python unfortunately. Pre-built wheels for more recent Python versions are available <a href=\"https://www.lfd.uci.edu/~gohlke/pythonlibs/#gmpy\" rel=\"nofollow noreferrer\">here</a>. The files are named after the Python version (e.g. <code>cp37</code> for CPython 3.7) and architecture (e.g. <code>amd64</code> for 64-bit)</p>\n\n<p>A wheel can be installed like so:</p>\n\n<pre><code>pip install gmpy2\u20112.0.8\u2011cp37\u2011cp37m\u2011win_amd64.whl\n</code></pre>\n"}], "owner": {"reputation": 3851, "user_id": 4652358, "user_type": "registered", "accept_rate": 92, "profile_image": "https://lh6.googleusercontent.com/-kT5qFfxGmcg/AAAAAAAAAAI/AAAAAAAAAWY/vVkJXBMAmko/photo.jpg?sz=128", "display_name": "Francesco Mantovani", "link": "https://stackoverflow.com/users/4652358/francesco-mantovani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2351, "favorite_count": 0, "accepted_answer_id": 58421484, "answer_count": 1, "score": 2, "last_activity_date": 1571262650, "creation_date": 1571258607, "last_edit_date": 1571259069, "question_id": 58421429, "link": "https://stackoverflow.com/questions/58421429/python-pip-install-gmpy-on-windows-10-returns-cl-exe-failed-with-exit-statu", "title": "Python: &quot;pip install gmpy&quot; on Windows 10 returns &quot;cl.exe&#39; failed with exit status 2&quot;", "body": "<p>I've installed Pyhton 3.7 on Windows10 and when I run <code>pip install gmpy</code> the console return me this error: </p>\n\n<pre><code>Collecting gmpy\n  Using cached https://files.pythonhosted.org/packages/26/37/2184c13cee81e1dbeaebbb13570195247e73ab2138a3db0c9d2c5347e372/gmpy-1.17.zip\nBuilding wheels for collected packages: gmpy\n  Building wheel for gmpy (setup.py) ... error\n  ERROR: Command errored out with exit status 1:\n   command: 'c:\\python37\\python.exe' -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'C:\\\\Users\\\\franc\\\\AppData\\\\Local\\\\Temp\\\\pip-install-du1j9u7s\\\\gmpy\\\\setup.py'\"'\"'; __file__='\"'\"'C:\\\\Users\\\\franc\\\\AppData\\\\Local\\\\Temp\\\\pip-install-du1j9u7s\\\\gmpy\\\\setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' bdist_wheel -d 'C:\\Users\\franc\\AppData\\Local\\Temp\\pip-wheel-nz4_kuat' --python-tag cp37\n       cwd: C:\\Users\\franc\\AppData\\Local\\Temp\\pip-install-du1j9u7s\\gmpy\\\n  Complete output (12 lines):\n  running bdist_wheel\n  running build\n  running build_ext\n  building 'gmpy' extension\n  creating build\n  creating build\\temp.win-amd64-3.7\n  creating build\\temp.win-amd64-3.7\\Release\n  creating build\\temp.win-amd64-3.7\\Release\\src\n  C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\BuildTools\\VC\\Tools\\MSVC\\14.23.28105\\bin\\HostX86\\x64\\cl.exe /c /nologo /Ox /W3 /GL /DNDEBUG /MT -Ic:\\python37\\include -Ic:\\python37\\include \"-IC:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\BuildTools\\VC\\Tools\\MSVC\\14.23.28105\\include\" \"-IC:\\Program Files (x86)\\Windows Kits\\NETFXSDK\\4.7.2\\include\\um\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\ucrt\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\shared\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\um\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\winrt\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\cppwinrt\" /Tcsrc/gmpy.c /Fobuild\\temp.win-amd64-3.7\\Release\\src/gmpy.obj\n  gmpy.c\n  C:\\Users\\franc\\AppData\\Local\\Temp\\pip-install-du1j9u7s\\gmpy\\src\\gmpy.h(30): fatal error C1083: Cannot open include file: 'gmp.h': No such file or directory\n  error: command 'C:\\\\Program Files (x86)\\\\Microsoft Visual Studio\\\\2019\\\\BuildTools\\\\VC\\\\Tools\\\\MSVC\\\\14.23.28105\\\\bin\\\\HostX86\\\\x64\\\\cl.exe' failed with exit status 2\n  ----------------------------------------\n  ERROR: Failed building wheel for gmpy\n  Running setup.py clean for gmpy\nFailed to build gmpy\nInstalling collected packages: gmpy\n    Running setup.py install for gmpy ... error\n    ERROR: Command errored out with exit status 1:\n     command: 'c:\\python37\\python.exe' -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'C:\\\\Users\\\\franc\\\\AppData\\\\Local\\\\Temp\\\\pip-install-du1j9u7s\\\\gmpy\\\\setup.py'\"'\"'; __file__='\"'\"'C:\\\\Users\\\\franc\\\\AppData\\\\Local\\\\Temp\\\\pip-install-du1j9u7s\\\\gmpy\\\\setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' install --record 'C:\\Users\\franc\\AppData\\Local\\Temp\\pip-record-q7ltkyyx\\install-record.txt' --single-version-externally-managed --compile\n         cwd: C:\\Users\\franc\\AppData\\Local\\Temp\\pip-install-du1j9u7s\\gmpy\\\n    Complete output (12 lines):\n    running install\n    running build\n    running build_ext\n    building 'gmpy' extension\n    creating build\n    creating build\\temp.win-amd64-3.7\n    creating build\\temp.win-amd64-3.7\\Release\n    creating build\\temp.win-amd64-3.7\\Release\\src\n    C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\BuildTools\\VC\\Tools\\MSVC\\14.23.28105\\bin\\HostX86\\x64\\cl.exe /c /nologo /Ox /W3 /GL /DNDEBUG /MT -Ic:\\python37\\include -Ic:\\python37\\include \"-IC:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\BuildTools\\VC\\Tools\\MSVC\\14.23.28105\\include\" \"-IC:\\Program Files (x86)\\Windows Kits\\NETFXSDK\\4.7.2\\include\\um\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\ucrt\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\shared\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\um\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\winrt\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\cppwinrt\" /Tcsrc/gmpy.c /Fobuild\\temp.win-amd64-3.7\\Release\\src/gmpy.obj\n    gmpy.c\n    C:\\Users\\franc\\AppData\\Local\\Temp\\pip-install-du1j9u7s\\gmpy\\src\\gmpy.h(30): fatal error C1083: Cannot open include file: 'gmp.h': No such file or directory\n    error: command 'C:\\\\Program Files (x86)\\\\Microsoft Visual Studio\\\\2019\\\\BuildTools\\\\VC\\\\Tools\\\\MSVC\\\\14.23.28105\\\\bin\\\\HostX86\\\\x64\\\\cl.exe' failed with exit status 2\n    ----------------------------------------\nERROR: Command errored out with exit status 1: 'c:\\python37\\python.exe' -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'C:\\\\Users\\\\franc\\\\AppData\\\\Local\\\\Temp\\\\pip-install-du1j9u7s\\\\gmpy\\\\setup.py'\"'\"'; __file__='\"'\"'C:\\\\Users\\\\franc\\\\AppData\\\\Local\\\\Temp\\\\pip-install-du1j9u7s\\\\gmpy\\\\setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' install --record 'C:\\Users\\franc\\AppData\\Local\\Temp\\pip-record-q7ltkyyx\\install-record.txt' --single-version-externally-managed --compile Check the logs for full command output.\n</code></pre>\n\n<p>The error is in this line:</p>\n\n<pre><code>error: command 'C:\\\\Program Files (x86)\\\\Microsoft Visual Studio\\\\2019\\\\BuildTools\\\\VC\\\\Tools\\\\MSVC\\\\14.23.28105\\\\bin\\\\HostX86\\\\x64\\\\cl.exe' failed with exit status 2\n</code></pre>\n\n<p>Basically it means that Python needs <code>cl.exe</code> and it expect it at:</p>\n\n<pre><code>C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\BuildTools\\VC\\Tools\\MSVC\\14.23.28105\\bin\\Hostx86\\x64\n</code></pre>\n\n<p>No problem, I go to the Environment Variable and i add that path both for my user and for the system: </p>\n\n<p><a href=\"https://i.stack.imgur.com/hlfIJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hlfIJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then I check if <code>cl.exe</code> is successfully in the path by typing <code>cl</code> in the terminal and it works: </p>\n\n<p><a href=\"https://i.stack.imgur.com/Vxpfu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vxpfu.png\" alt=\"enter image description here\"></a></p>\n\n<p>But when I run again <code>pip install gmpy</code> I have the same error. </p>\n\n<p><strong>EDIT:</strong> I also tried with <code>pip install gmpy2</code> and I receive the same error.</p>\n\n<p>Where am I wrong?</p>\n"}, {"tags": ["python"], "comments": [{"owner": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "edited": false, "score": 7, "creation_date": 1571258693, "post_id": 58421423, "comment_id": 103185075, "body": "You need to fix indents."}, {"owner": {"reputation": 6690, "user_id": 4225229, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/2YfJM.jpg?s=128&g=1", "display_name": "JacobIRR", "link": "https://stackoverflow.com/users/4225229/jacobirr"}, "edited": false, "score": 1, "creation_date": 1571258698, "post_id": 58421423, "comment_id": 103185079, "body": "add print statements to every line and that will reveal the behavior to you"}, {"owner": {"reputation": 8368, "user_id": 4669778, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-Iz_f3T23jC4/AAAAAAAAAAI/AAAAAAAADVQ/_H_y2EUoF7c/photo.jpg?sz=128", "display_name": "Ofer Sadan", "link": "https://stackoverflow.com/users/4669778/ofer-sadan"}, "edited": false, "score": 4, "creation_date": 1571258702, "post_id": 58421423, "comment_id": 103185080, "body": "in python, indentation matters a lot. You&#39;ve copied some of the code over-indented and it runs in the loop"}, {"owner": {"reputation": 1563, "user_id": 3404040, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JrNTUKgimeo/AAAAAAAAAAI/AAAAAAAAACw/-9QAfnVSUDs/photo.jpg?sz=128", "display_name": "Take_Care_", "link": "https://stackoverflow.com/users/3404040/take-care"}, "edited": false, "score": 0, "creation_date": 1571259044, "post_id": 58421423, "comment_id": 103185217, "body": "ok, so. You are using the <code>return</code> statement. After the fist non matching pair Your function will hit the return and just return what is in result. You must allow the both loops to end and then return the result."}, {"owner": {"reputation": 165, "user_id": 12058871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cf1af7581e45868b2240ae4f68f1006?s=128&d=identicon&r=PG", "display_name": "John Iskra", "link": "https://stackoverflow.com/users/12058871/john-iskra"}, "reply_to_user": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "edited": false, "score": 0, "creation_date": 1571259094, "post_id": 58421423, "comment_id": 103185244, "body": "@GSazheniuk:  Can you tell me what about the indents need fixing?  (Or, give me a hint if you think it&#39;s better for me to try to figure this out myself)  Edit:  I see what you&#39;re all talking about, I think:  It didn&#39;t copy as I had typed it into VSC for some reason.  Everything is indented below the def intersect line"}, {"owner": {"reputation": 165, "user_id": 12058871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cf1af7581e45868b2240ae4f68f1006?s=128&d=identicon&r=PG", "display_name": "John Iskra", "link": "https://stackoverflow.com/users/12058871/john-iskra"}, "reply_to_user": {"reputation": 1563, "user_id": 3404040, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JrNTUKgimeo/AAAAAAAAAAI/AAAAAAAAACw/-9QAfnVSUDs/photo.jpg?sz=128", "display_name": "Take_Care_", "link": "https://stackoverflow.com/users/3404040/take-care"}, "edited": false, "score": 0, "creation_date": 1571259309, "post_id": 58421423, "comment_id": 103185337, "body": "@Take_Care_:  I think I kind of understand what you&#39;re saying here.  I&#39;ll look into it.  thank you"}, {"owner": {"reputation": 165, "user_id": 12058871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cf1af7581e45868b2240ae4f68f1006?s=128&d=identicon&r=PG", "display_name": "John Iskra", "link": "https://stackoverflow.com/users/12058871/john-iskra"}, "edited": false, "score": 0, "creation_date": 1571259435, "post_id": 58421423, "comment_id": 103185389, "body": "Thank you to all who answered!  I see now my mistake (it was indents)  Ugh. I&#39;m getting better at this but very slowly..."}], "answers": [{"comments": [{"owner": {"reputation": 394, "user_id": 2023321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1iHEw.jpg?s=128&g=1", "display_name": "Eduardo Fernandes", "link": "https://stackoverflow.com/users/2023321/eduardo-fernandes"}, "edited": false, "score": 0, "creation_date": 1571259053, "post_id": 58421494, "comment_id": 103185225, "body": "The code now works perfectly, though it misses a print call to show the result: <code>print(intersect(S,T)</code>"}], "tags": [], "owner": {"reputation": 15468, "user_id": 321772, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c03247f45c9f291391b894375c2709ca?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/321772/adam"}, "is_accepted": true, "score": 3, "last_activity_date": 1571259266, "last_edit_date": 1571259266, "creation_date": 1571258890, "answer_id": 58421494, "question_id": 58421423, "link": "https://stackoverflow.com/questions/58421423/i-dont-understand-why-the-for-loop-is-not-working/58421494#58421494", "title": "I don&#39;t understand why the for loop is not working", "body": "<p>Python uses indentation to mark the beginning and end a block of code such as a function or loop body:</p>\n\n<pre><code>for condition:\n    statement_in_loop()\n    statement_in_loop()\n\nstatement_outside_of_loop()\n</code></pre>\n\n<p>If you were to indent that last line it would be inside the loop. Some languages use braces to mark the body of a loop, Python doesn't.</p>\n\n<p>Be especially careful when copy/pasting code. Often editors will try to helpfully fix your indentation for you and end up changing the logic.</p>\n\n<p>Your code appears to over-indent the final loop, which makes it run too many times. </p>\n\n<p>Try this:</p>\n\n<pre><code>def intersect(L1,L2):\n    tmp = []\n    for e1 in L1:\n        for e2 in L2:\n            if e1 == e2:\n                tmp.append(e1)\n                break\n    result = []\n    for e in tmp:\n        if e not in result:\n            result.append(e)\n    return result\n\nS = [2,3]\nT = [2,3,4]\nintersect(S,T)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 665, "user_id": 10610632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb8dce0aefdec2cde25c0a79c32739?s=128&d=identicon&r=PG&f=1", "display_name": "RoyM", "link": "https://stackoverflow.com/users/10610632/roym"}, "is_accepted": false, "score": 1, "last_activity_date": 1571263670, "creation_date": 1571263670, "answer_id": 58422296, "question_id": 58421423, "link": "https://stackoverflow.com/questions/58421423/i-dont-understand-why-the-for-loop-is-not-working/58422296#58422296", "title": "I don&#39;t understand why the for loop is not working", "body": "<p>Now that Adam has given you a working solution, there's also something to be said about the efficiency of your algorithm. Be aware that <strong>this will go beyond the scope of your question</strong>.</p>\n\n<p>Notice that for every element in your first list, there's a check against every element in your second list. That means if both lists have n elements, you will do at least n^2 comparisons. Imagine that n gets large, say 100000, and the range of sizes in which the elements may appear be sufficiently large, will your algorithm be able to handle this? Generally you want to try to avoid nested for loops, if possible. And in this case it is:</p>\n\n<p>Let's start by importing a tool to give us random numbers because I'm way too lazy to generate 100000 numbers by hand:</p>\n\n<pre><code>from random import randrange as rr\n</code></pre>\n\n<p>Now let's set some high parameters to test the algorithm:</p>\n\n<pre><code>list_length = 10000\nrandom_space = 200000\n</code></pre>\n\n<p>Let's create two lists using these parameters:</p>\n\n<pre><code>l1 = [rr(0,random_space,1) for i in range(list_length)]\nl2 = [rr(0,random_space,1) for i in range(list_length)]\n</code></pre>\n\n<p>Now here's your correctly indented algorithm, with one variable <code>checks</code> added with tells us roughly how many times we compare two elements:</p>\n\n<pre><code>def intersect(L1,L2):\n    tmp = []\n    checks = 0\n    for e1 in L1:\n        for e2 in L2:\n            checks += 1\n            if e1 == e2:\n                tmp.append(e1)\n                break\n    result = []\n    for e in tmp:\n        if e not in result:\n            result.append(e)\n    return result, checks\n</code></pre>\n\n<p>Let's print out our result:</p>\n\n<pre><code>res, checks = intersect(l1, l2)\nprint(res)\nprint(\"Number of comparisons: \"+str(checks))\n</code></pre>\n\n<p>Now run the code. I think you'll find that everything works, but it takes a bit of time and the number of comparisons is probably close to 100 million! Try changing the <code>list_length</code> from <code>10000</code> to <code>100000</code>, will the code even finish when you run it now?</p>\n\n<p>Now let's make a few changes. We delete the last three lines. Then we introduce a modified version of the intersect-function:</p>\n\n<pre><code>def intersect_v2(L1, L2):\n    dict = {}\n    checks = 0\n    for e1 in L1:\n        checks += 1\n        dict[e1] = 1\n    for e2 in L2:\n        checks += 1\n        if e2 in dict:\n            dict[e2] += 1\n    return [e for e in dict if dict[e] &gt; 1], checks\n</code></pre>\n\n<p>Notice that we only run through each lists once here. How big of a difference does that make?</p>\n\n<p>Let's test it. Change <code>list_length</code> back to <code>10000</code>. Then add the last three lines back in, using the modified intersect-function:</p>\n\n<pre><code>res, checks = intersect_v2(l1, l2)\nprint(res)\nprint(\"Number of comparisons: \"+str(checks))\n</code></pre>\n\n<p>Run the code and see. Then try changing the <code>list_length</code> back to <code>100000</code> and run it again. Does it complete in a reasonable time now?</p>\n\n<p>There's probably even more efficient ways to do this. But getting rid of the nested for-loop is often a big deal.</p>\n"}], "owner": {"reputation": 165, "user_id": 12058871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cf1af7581e45868b2240ae4f68f1006?s=128&d=identicon&r=PG", "display_name": "John Iskra", "link": "https://stackoverflow.com/users/12058871/john-iskra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 58421494, "answer_count": 2, "score": 3, "last_activity_date": 1571263670, "creation_date": 1571258571, "last_edit_date": 1571258899, "question_id": 58421423, "link": "https://stackoverflow.com/questions/58421423/i-dont-understand-why-the-for-loop-is-not-working", "title": "I don&#39;t understand why the for loop is not working", "body": "<p>I'm running python 3.7.3 on ubuntu 19.04 using visual studio code 1.39.1.  I'm a bit of a noob so please be patient with me.  </p>\n\n<p>I'm working my way through computation and programming using Python.  The authors give this example which I typed into VSC, I'm 99% sure, accurately, but it's not doing what the program is supposed to, namely finding the intersection of two lists:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>def intersect(L1,L2):\n    tmp = []\n    for e1 in L1:\n        for e2 in L2:\n            if e1 == e2:\n                tmp.append(e1)\n                break\n            result = []\n            for e in tmp:\n                if e not in result:\n                    result.append(e)\n            return result\n\nS = [2,3]\nT = [2,3,4]\nintersect(S,T)\n</code></pre>\n\n<p>The output is <code>[2]</code> rather than <code>[2,3]</code>, so it seems like the program is not running through <code>S</code>, but I can't figure out why.</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["python", "numpy", "multidimensional-array"], "comments": [{"owner": {"reputation": 6812, "user_id": 7371893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ris3Z.png?s=128&g=1", "display_name": "&#226;\u0144\u014d\u014b\u0177Xmo\u016f\u015c", "link": "https://stackoverflow.com/users/7371893/%c3%a2%c5%84%c5%8d%c5%8b%c5%b7xmo%c5%af%c5%9c"}, "edited": false, "score": 1, "creation_date": 1571258517, "post_id": 58421382, "comment_id": 103184995, "body": "please give us sample data and values of sortcolindex and g_index. thanks."}, {"owner": {"reputation": 59, "user_id": 7897666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6aeb3332adc9e3f2d138abd9d98c5c8?s=128&d=identicon&r=PG&f=1", "display_name": "user1120", "link": "https://stackoverflow.com/users/7897666/user1120"}, "reply_to_user": {"reputation": 6812, "user_id": 7371893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ris3Z.png?s=128&g=1", "display_name": "&#226;\u0144\u014d\u014b\u0177Xmo\u016f\u015c", "link": "https://stackoverflow.com/users/7371893/%c3%a2%c5%84%c5%8d%c5%8b%c5%b7xmo%c5%af%c5%9c"}, "edited": false, "score": 0, "creation_date": 1571259068, "post_id": 58421382, "comment_id": 103185232, "body": "see the post again, thanks"}, {"owner": {"reputation": 6812, "user_id": 7371893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ris3Z.png?s=128&g=1", "display_name": "&#226;\u0144\u014d\u014b\u0177Xmo\u016f\u015c", "link": "https://stackoverflow.com/users/7371893/%c3%a2%c5%84%c5%8d%c5%8b%c5%b7xmo%c5%af%c5%9c"}, "edited": false, "score": 0, "creation_date": 1571259239, "post_id": 58421382, "comment_id": 103185306, "body": "what is the purpose of DivideColumns?"}, {"owner": {"reputation": 25081, "user_id": 4804629, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vGzEm.jpg?s=128&g=1", "display_name": "splash58", "link": "https://stackoverflow.com/users/4804629/splash58"}, "edited": false, "score": 0, "creation_date": 1571259245, "post_id": 58421382, "comment_id": 103185309, "body": "you call <code>Numberofoccurences(iris_array,0,0)</code> with last zero, but in function expecting  multi-dim list <code>g_index[[i],[4]]</code> which <i>s not subscriptable</i>"}], "answers": [{"tags": [], "owner": {"reputation": 4630, "user_id": 3381305, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e9bb4c57a03583c724f0fe037344a2cd?s=128&d=identicon&r=PG", "display_name": "kwinkunks", "link": "https://stackoverflow.com/users/3381305/kwinkunks"}, "is_accepted": true, "score": 1, "last_activity_date": 1571259393, "creation_date": 1571259393, "answer_id": 58421596, "question_id": 58421382, "link": "https://stackoverflow.com/questions/58421382/i-am-unable-to-access-and-make-some-operation-in-3d-array-in-python/58421596#58421596", "title": "I am unable to access and make some operation in 3D array in Python", "body": "<p>'Not subscriptable' means you cannot index into it. So <code>g_index[i]</code> is not allowed.</p>\n\n<p>Maybe you want:</p>\n\n<pre><code>element = df[g_index, i, 4]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6812, "user_id": 7371893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ris3Z.png?s=128&g=1", "display_name": "&#226;\u0144\u014d\u014b\u0177Xmo\u016f\u015c", "link": "https://stackoverflow.com/users/7371893/%c3%a2%c5%84%c5%8d%c5%8b%c5%b7xmo%c5%af%c5%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1571260172, "creation_date": 1571260172, "answer_id": 58421741, "question_id": 58421382, "link": "https://stackoverflow.com/questions/58421382/i-am-unable-to-access-and-make-some-operation-in-3d-array-in-python/58421741#58421741", "title": "I am unable to access and make some operation in 3D array in Python", "body": "<p>Here is the fix on your function.  So you do a loop on each element in data[g_index] and to get the last element, you put each[-1] where -1 means last element of the list.</p>\n\n<pre><code>def Numberofoccurences(data,sortcolindex,g_index):\n    df =  DivideColumns(data,sortcolindex)\n    num_Iris_setosa = 0\n    num_Iris_versicolor = 0\n    num_Iris_virginica = 0\n    for each in df[g_index]:\n        element = each[-1]\n        if(element == 'Setosa'):\n            num_Iris_setosa+=1\n        elif(element == 'Versicolor'):\n            num_Iris_versicolor+=1\n        elif (element == 'Virginica'):\n            num_Iris_virginica+=1\n    array1D_for_occ = np.array([num_Iris_virginica,num_Iris_versicolor,num_Iris_setosa])\n    return array1D_for_occ\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 7897666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6aeb3332adc9e3f2d138abd9d98c5c8?s=128&d=identicon&r=PG&f=1", "display_name": "user1120", "link": "https://stackoverflow.com/users/7897666/user1120"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 58421596, "answer_count": 2, "score": 0, "last_activity_date": 1571260172, "creation_date": 1571258387, "last_edit_date": 1571258907, "question_id": 58421382, "link": "https://stackoverflow.com/questions/58421382/i-am-unable-to-access-and-make-some-operation-in-3d-array-in-python", "title": "I am unable to access and make some operation in 3D array in Python", "body": "<p><code>df</code> is a <code>3D</code> array mentioned below and which consists of 3 2D array and I should access last column of <code>2D</code> array along all rows. </p>\n\n<pre><code>array([[[4.3, 3.0, 1.1, 0.1, 'Setosa'],\n        [4.4, 3.2, 1.3, 0.2, 'Setosa'],\n        [4.4, 3.0, 1.3, 0.2, 'Setosa'],\n        [4.4, 2.9, 1.4, 0.2, 'Setosa'],\n        [4.5, 2.3, 1.3, 0.3, 'Setosa'],\n        [4.6, 3.6, 1.0, 0.2, 'Setosa'],\n        [4.6, 3.1, 1.5, 0.2, 'Setosa'],\n        [4.6, 3.4, 1.4, 0.3, 'Setosa'],\n        [4.6, 3.2, 1.4, 0.2, 'Setosa'],\n        [4.7, 3.2, 1.3, 0.2, 'Setosa'],\n        [4.7, 3.2, 1.6, 0.2, 'Setosa'],\n        [4.8, 3.0, 1.4, 0.1, 'Setosa'],\n        [4.8, 3.0, 1.4, 0.3, 'Setosa'],\n        [4.8, 3.4, 1.9, 0.2, 'Setosa'],\n        [4.8, 3.4, 1.6, 0.2, 'Setosa'],\n        [4.8, 3.1, 1.6, 0.2, 'Setosa'],\n        [4.9, 2.4, 3.3, 1.0, 'Versicolor'],\n        [4.9, 2.5, 4.5, 1.7, 'Virginica'],\n        [4.9, 3.1, 1.5, 0.2, 'Setosa'],\n        [4.9, 3.1, 1.5, 0.1, 'Setosa'],\n        [4.9, 3.6, 1.4, 0.1, 'Setosa'],\n        [4.9, 3.0, 1.4, 0.2, 'Setosa'],\n        [5.0, 3.5, 1.3, 0.3, 'Setosa'],\n        [5.0, 3.4, 1.6, 0.4, 'Setosa'],\n        [5.0, 3.3, 1.4, 0.2, 'Setosa'],\n        [5.0, 3.2, 1.2, 0.2, 'Setosa'],\n        [5.0, 3.5, 1.6, 0.6, 'Setosa'],\n        [5.0, 2.0, 3.5, 1.0, 'Versicolor'],\n        [5.0, 3.4, 1.5, 0.2, 'Setosa'],\n        [5.0, 2.3, 3.3, 1.0, 'Versicolor'],\n        [5.0, 3.6, 1.4, 0.2, 'Setosa'],\n        [5.0, 3.0, 1.6, 0.2, 'Setosa'],\n        [5.1, 3.8, 1.9, 0.4, 'Setosa'],\n        [5.1, 3.8, 1.6, 0.2, 'Setosa'],\n        [5.1, 2.5, 3.0, 1.1, 'Versicolor'],\n        [5.1, 3.5, 1.4, 0.2, 'Setosa'],\n        [5.1, 3.4, 1.5, 0.2, 'Setosa'],\n        [5.1, 3.5, 1.4, 0.3, 'Setosa'],\n        [5.1, 3.3, 1.7, 0.5, 'Setosa'],\n        [5.1, 3.7, 1.5, 0.4, 'Setosa'],\n        [5.1, 3.8, 1.5, 0.3, 'Setosa'],\n        [5.2, 4.1, 1.5, 0.1, 'Setosa'],\n        [5.2, 3.4, 1.4, 0.2, 'Setosa'],\n        [5.2, 3.5, 1.5, 0.2, 'Setosa'],\n        [5.2, 2.7, 3.9, 1.4, 'Versicolor'],\n        [5.3, 3.7, 1.5, 0.2, 'Setosa'],\n        [5.4, 3.0, 4.5, 1.5, 'Versicolor'],\n        [5.4, 3.9, 1.7, 0.4, 'Setosa'],\n        [5.4, 3.4, 1.7, 0.2, 'Setosa'],\n        [5.4, 3.4, 1.5, 0.4, 'Setosa']],\n\n       [[5.4, 3.7, 1.5, 0.2, 'Setosa'],\n        [5.4, 3.9, 1.3, 0.4, 'Setosa'],\n        [5.5, 3.5, 1.3, 0.2, 'Setosa'],\n        [5.5, 2.6, 4.4, 1.2, 'Versicolor'],\n        [5.5, 4.2, 1.4, 0.2, 'Setosa'],\n        [5.5, 2.3, 4.0, 1.3, 'Versicolor'],\n        [5.5, 2.4, 3.7, 1.0, 'Versicolor'],\n        [5.5, 2.4, 3.8, 1.1, 'Versicolor'],\n        [5.5, 2.5, 4.0, 1.3, 'Versicolor'],\n        [5.6, 3.0, 4.1, 1.3, 'Versicolor'],\n        [5.6, 2.8, 4.9, 2.0, 'Virginica'],\n        [5.6, 3.0, 4.5, 1.5, 'Versicolor'],\n        [5.6, 2.5, 3.9, 1.1, 'Versicolor'],\n        [5.6, 2.7, 4.2, 1.3, 'Versicolor'],\n        [5.6, 2.9, 3.6, 1.3, 'Versicolor'],\n        [5.7, 2.6, 3.5, 1.0, 'Versicolor'],\n        [5.7, 2.9, 4.2, 1.3, 'Versicolor'],\n        [5.7, 2.8, 4.1, 1.3, 'Versicolor'],\n        [5.7, 4.4, 1.5, 0.4, 'Setosa'],\n        [5.7, 2.8, 4.5, 1.3, 'Versicolor'],\n        [5.7, 2.5, 5.0, 2.0, 'Virginica'],\n        [5.7, 3.8, 1.7, 0.3, 'Setosa'],\n        [5.7, 3.0, 4.2, 1.2, 'Versicolor'],\n        [5.8, 2.7, 4.1, 1.0, 'Versicolor'],\n        [5.8, 4.0, 1.2, 0.2, 'Setosa'],\n        [5.8, 2.6, 4.0, 1.2, 'Versicolor'],\n        [5.8, 2.8, 5.1, 2.4, 'Virginica'],\n        [5.8, 2.7, 5.1, 1.9, 'Virginica'],\n        [5.8, 2.7, 3.9, 1.2, 'Versicolor'],\n        [5.8, 2.7, 5.1, 1.9, 'Virginica'],\n        [5.9, 3.0, 5.1, 1.8, 'Virginica'],\n        [5.9, 3.0, 4.2, 1.5, 'Versicolor'],\n        [5.9, 3.2, 4.8, 1.8, 'Versicolor'],\n        [6.0, 2.9, 4.5, 1.5, 'Versicolor'],\n        [6.0, 2.7, 5.1, 1.6, 'Versicolor'],\n        [6.0, 3.0, 4.8, 1.8, 'Virginica'],\n        [6.0, 3.4, 4.5, 1.6, 'Versicolor'],\n        [6.0, 2.2, 4.0, 1.0, 'Versicolor'],\n        [6.0, 2.2, 5.0, 1.5, 'Virginica'],\n        [6.1, 3.0, 4.9, 1.8, 'Virginica'],\n        [6.1, 2.6, 5.6, 1.4, 'Virginica'],\n        [6.1, 2.8, 4.0, 1.3, 'Versicolor'],\n        [6.1, 2.9, 4.7, 1.4, 'Versicolor'],\n        [6.1, 2.8, 4.7, 1.2, 'Versicolor'],\n        [6.1, 3.0, 4.6, 1.4, 'Versicolor'],\n        [6.2, 2.2, 4.5, 1.5, 'Versicolor'],\n        [6.2, 2.9, 4.3, 1.3, 'Versicolor'],\n        [6.2, 3.4, 5.4, 2.3, 'Virginica'],\n        [6.2, 2.8, 4.8, 1.8, 'Virginica'],\n        [6.3, 2.5, 4.9, 1.5, 'Versicolor']],\n\n       [[6.3, 2.7, 4.9, 1.8, 'Virginica'],\n        [6.3, 2.5, 5.0, 1.9, 'Virginica'],\n        [6.3, 3.3, 4.7, 1.6, 'Versicolor'],\n        [6.3, 2.8, 5.1, 1.5, 'Virginica'],\n        [6.3, 3.3, 6.0, 2.5, 'Virginica'],\n        [6.3, 2.3, 4.4, 1.3, 'Versicolor'],\n        [6.3, 3.4, 5.6, 2.4, 'Virginica'],\n        [6.3, 2.9, 5.6, 1.8, 'Virginica'],\n        [6.4, 2.8, 5.6, 2.2, 'Virginica'],\n        [6.4, 2.8, 5.6, 2.1, 'Virginica'],\n        [6.4, 3.1, 5.5, 1.8, 'Virginica'],\n        [6.4, 3.2, 4.5, 1.5, 'Versicolor'],\n        [6.4, 3.2, 5.3, 2.3, 'Virginica'],\n        [6.4, 2.9, 4.3, 1.3, 'Versicolor'],\n        [6.4, 2.7, 5.3, 1.9, 'Virginica'],\n        [6.5, 3.0, 5.8, 2.2, 'Virginica'],\n        [6.5, 3.0, 5.5, 1.8, 'Virginica'],\n        [6.5, 3.0, 5.2, 2.0, 'Virginica'],\n        [6.5, 2.8, 4.6, 1.5, 'Versicolor'],\n        [6.5, 3.2, 5.1, 2.0, 'Virginica'],\n        [6.6, 2.9, 4.6, 1.3, 'Versicolor'],\n        [6.6, 3.0, 4.4, 1.4, 'Versicolor'],\n        [6.7, 3.1, 4.7, 1.5, 'Versicolor'],\n        [6.7, 3.1, 5.6, 2.4, 'Virginica'],\n        [6.7, 2.5, 5.8, 1.8, 'Virginica'],\n        [6.7, 3.0, 5.0, 1.7, 'Versicolor'],\n        [6.7, 3.1, 4.4, 1.4, 'Versicolor'],\n        [6.7, 3.3, 5.7, 2.5, 'Virginica'],\n        [6.7, 3.0, 5.2, 2.3, 'Virginica'],\n        [6.7, 3.3, 5.7, 2.1, 'Virginica'],\n        [6.8, 3.2, 5.9, 2.3, 'Virginica'],\n        [6.8, 2.8, 4.8, 1.4, 'Versicolor'],\n        [6.8, 3.0, 5.5, 2.1, 'Virginica'],\n        [6.9, 3.1, 5.4, 2.1, 'Virginica'],\n        [6.9, 3.1, 5.1, 2.3, 'Virginica'],\n        [6.9, 3.1, 4.9, 1.5, 'Versicolor'],\n        [6.9, 3.2, 5.7, 2.3, 'Virginica'],\n        [7.0, 3.2, 4.7, 1.4, 'Versicolor'],\n        [7.1, 3.0, 5.9, 2.1, 'Virginica'],\n        [7.2, 3.0, 5.8, 1.6, 'Virginica'],\n        [7.2, 3.2, 6.0, 1.8, 'Virginica'],\n        [7.2, 3.6, 6.1, 2.5, 'Virginica'],\n        [7.3, 2.9, 6.3, 1.8, 'Virginica'],\n        [7.4, 2.8, 6.1, 1.9, 'Virginica'],\n        [7.6, 3.0, 6.6, 2.1, 'Virginica'],\n        [7.7, 2.8, 6.7, 2.0, 'Virginica'],\n        [7.7, 2.6, 6.9, 2.3, 'Virginica'],\n        [7.7, 3.8, 6.7, 2.2, 'Virginica'],\n        [7.7, 3.0, 6.1, 2.3, 'Virginica'],\n        [7.9, 3.8, 6.4, 2.0, 'Virginica']]], dtype=object)\n</code></pre>\n\n<p>I tried:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>  element = df[g_index[[i],[4]]]\n</code></pre>\n\n<p>but it returns an error</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>def Numberofoccurences(data,sortcolindex,g_index):\n    df =  DivideColumns(data,sortcolindex)\n    num_Iris_setosa = 0\n    num_Iris_versicolor = 0\n    num_Iris_virginica = 0\n    for i in range(0,50):\n           element = df[g_index[[i],[4]]]\n           if(element == 'Setosa'):\n               num_Iris_setosa+=1\n           elif(element == 'Versicolor'):\n               num_Iris_versicolor+=1\n           elif (element == 'Virginica'):\n               num_Iris_virginica+=1\n    array1D_for_occ = np.array([num_Iris_virginica,num_Iris_versicolor,num_Iris_setosa])\n    return array1D_for_occ ;\n\n\nnumberofocc = Numberofoccurences(iris_array,0,0)\n\n</code></pre>\n\n<p>The error I get is </p>\n\n<blockquote>\n  <p>TypeError: 'int' object is not subscriptable</p>\n</blockquote>\n"}, {"tags": ["python", "pandas", "time-series"], "answers": [{"tags": [], "owner": {"reputation": 114459, "user_id": 4238408, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RWkmO.jpg?s=128&g=1", "display_name": "Quang Hoang", "link": "https://stackoverflow.com/users/4238408/quang-hoang"}, "is_accepted": false, "score": 0, "last_activity_date": 1571259190, "creation_date": 1571259190, "answer_id": 58421555, "question_id": 58421370, "link": "https://stackoverflow.com/questions/58421370/search-for-intervals-of-equal-values-in-n-time-series/58421555#58421555", "title": "Search for intervals of equal values in n time series", "body": "<p>IIUC, you can just use <code>max</code>:</p>\n\n<pre><code>pd.concat([df1,df2,df3], sort=False).max()\n</code></pre>\n\n<p>Or if your want to align the data frames by index:</p>\n\n<pre><code>pd.concat([df1,df2,df3], sort=False).groupby(level=0).max()\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>   2018-01-01 00:00:00  2018-01-01 00:01:00  2018-01-01 00:03:00  \\\n0                    1                  0.0                    0   \n</code></pre>\n"}], "owner": {"reputation": 3500, "user_id": 4102977, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/3b4fded2b2ca091478fd07788510a428?s=128&d=identicon&r=PG&f=1", "display_name": "wenzul", "link": "https://stackoverflow.com/users/4102977/wenzul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571260121, "creation_date": 1571258338, "last_edit_date": 1571260121, "question_id": 58421370, "link": "https://stackoverflow.com/questions/58421370/search-for-intervals-of-equal-values-in-n-time-series", "title": "Search for intervals of equal values in n time series", "body": "<p>I try to search for time intervals (e.g. 1 minute) where all data frames holds the same value (e.g. 1).</p>\n\n<p>Given <em>n</em> time series (<code>df1</code>, <code>df2</code>, <code>df3</code>, ...) that could have different time stamps. The time series have discrete state values <code>0</code> and <code>1</code>. From these jump functions I want to gernerate a single series where the values should never be >1. I think about somehow sum all frames and apply max(x, 1).</p>\n\n<pre><code>import pandas as pd\n\ndf1 = pd.DataFrame({'2018-01-01 00:00:00': [1],\n                    '2018-01-01 00:01:00': [0],\n                    '2018-01-01 00:03:00': [0],\n                    '2018-01-01 00:04:00': [1]})\n\ndf2 = pd.DataFrame({'2018-01-01 00:00:00': [0],\n                    '2018-01-01 00:01:30': [1],\n                    '2018-01-01 00:03:00': [0],\n                    '2018-01-01 00:04:30': [1]})\n\ndf3 = pd.DataFrame({'2018-01-01 00:00:00': [1],\n                    '2018-01-01 00:01:15': [1],\n                    '2018-01-01 00:03:00': [0],\n                    '2018-01-01 00:04:45': [0]})\n\nframes = [df1, df2, df3]\nresult = pd.concat(frames)\n\nprint(df1.add(df2.add(df3,axis=\"index\",fill_value=0),axis=\"index\",fill_value=0))\n</code></pre>\n\n<p>Intermediate result:</p>\n\n<pre><code>[3 rows x 8 columns]\n   2018-01-01 00:00:00  2018-01-01 00:01:00  2018-01-01 00:01:15  ...  2018-01-01 00:04:00  2018-01-01 00:04:30  2018-01-01 00:04:45\n0                    2                  0.0                  1.0  ...                  1.0                  1.0                  0.0\n</code></pre>\n\n<p>I guess there is a more comfortable and intuitive way (concat, merge, join...) to do this. I would split my problem in:</p>\n\n<ol>\n<li>gain more knowlege in pandas :)</li>\n<li>add / sum  data frames / time series</li>\n<li>let values 0 or 1</li>\n<li>evaluate durations of changing intervals</li>\n</ol>\n"}, {"tags": ["python", "python-3.x", "pygame"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 11348839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXQHL.png?s=128&g=1", "display_name": "agattis", "link": "https://stackoverflow.com/users/11348839/agattis"}, "edited": false, "score": 0, "creation_date": 1571258617, "post_id": 58421398, "comment_id": 103185037, "body": "tried it just now through powershell in the 3.7 directory and got this error. <code>python3.7 : The term &#39;python3.7&#39; is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again. At line:1 char:1 + python3.7 -m pip install pygame + ~~~~~~~~~     + CategoryInfo          : ObjectNotFound: (python3.7:String) [], CommandNotFoundException     + FullyQualifiedErrorId : CommandNotFoundException</code>"}, {"owner": {"reputation": 10088, "user_id": 21028, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/996a5828870fa84ad3a597f7935a9a5e?s=128&d=identicon&r=PG", "display_name": "csl", "link": "https://stackoverflow.com/users/21028/csl"}, "reply_to_user": {"reputation": 55, "user_id": 11348839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXQHL.png?s=128&g=1", "display_name": "agattis", "link": "https://stackoverflow.com/users/11348839/agattis"}, "edited": false, "score": 0, "creation_date": 1571258684, "post_id": 58421398, "comment_id": 103185069, "body": "For Windows, I&#39;d specify the full path to the 3.7 python.exe file."}, {"owner": {"reputation": 55, "user_id": 11348839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXQHL.png?s=128&g=1", "display_name": "agattis", "link": "https://stackoverflow.com/users/11348839/agattis"}, "edited": false, "score": 0, "creation_date": 1571258802, "post_id": 58421398, "comment_id": 103185115, "body": "right now i have the terminal at <code>PS C:\\Users\\alexa\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Python 3.7&gt;</code>. Does it need to be more specific?"}, {"owner": {"reputation": 10088, "user_id": 21028, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/996a5828870fa84ad3a597f7935a9a5e?s=128&d=identicon&r=PG", "display_name": "csl", "link": "https://stackoverflow.com/users/21028/csl"}, "reply_to_user": {"reputation": 55, "user_id": 11348839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXQHL.png?s=128&g=1", "display_name": "agattis", "link": "https://stackoverflow.com/users/11348839/agattis"}, "edited": false, "score": 1, "creation_date": 1571258944, "post_id": 58421398, "comment_id": 103185178, "body": "You may have python.exe under there or under a <code>bin</code> directory below. I&#39;d try using that."}, {"owner": {"reputation": 55, "user_id": 11348839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXQHL.png?s=128&g=1", "display_name": "agattis", "link": "https://stackoverflow.com/users/11348839/agattis"}, "edited": false, "score": 1, "creation_date": 1571259853, "post_id": 58421398, "comment_id": 103185557, "body": "Figured it out. It apparently wanted me to type out <code>.&#47;python</code> instead of just python. Thank you!"}], "tags": [], "owner": {"reputation": 10088, "user_id": 21028, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/996a5828870fa84ad3a597f7935a9a5e?s=128&d=identicon&r=PG", "display_name": "csl", "link": "https://stackoverflow.com/users/21028/csl"}, "is_accepted": false, "score": 1, "last_activity_date": 1571258464, "creation_date": 1571258464, "answer_id": 58421398, "question_id": 58421368, "link": "https://stackoverflow.com/questions/58421368/installing-pygame-when-i-have-2-different-python-versions-installed/58421398#58421398", "title": "Installing Pygame when I have 2 different Python versions installed", "body": "<p>If you are using pip, you could always try specifying the exact Python versions to install for:</p>\n\n<pre><code>$ python2.7 -m pip install pygame\n$ python3.7 -m pip install pypgame\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 11348839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXQHL.png?s=128&g=1", "display_name": "agattis", "link": "https://stackoverflow.com/users/11348839/agattis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1571258464, "creation_date": 1571258323, "question_id": 58421368, "link": "https://stackoverflow.com/questions/58421368/installing-pygame-when-i-have-2-different-python-versions-installed", "title": "Installing Pygame when I have 2 different Python versions installed", "body": "<p>I have two versions of python installed. 2.7 and 3.7.4. I want to install Pygame to 3.7 but am failing.</p>\n\n<p>I've tried multiple tutorials and methods but no luck. Python 2.7 has all the files but 3.7 has only exes but still works perfectly fine.</p>\n"}, {"tags": ["python", "regex"], "comments": [{"owner": {"reputation": 2237, "user_id": 8347081, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C2gg5Z3zU2w/AAAAAAAAAAI/AAAAAAAABXE/M2GK2Eixhms/photo.jpg?sz=128", "display_name": "mypetlion", "link": "https://stackoverflow.com/users/8347081/mypetlion"}, "edited": false, "score": 0, "creation_date": 1571258728, "post_id": 58421351, "comment_id": 103185088, "body": "<code>for groups in phoneRegex.findall(&#39;input.txt&#39;):</code> You&#39;re comparing the regex to the literal string <code>&quot;input.txt&quot;</code>. The regex engine is not taking that string, finding a file with that name, and matching the pattern against the text within that file, which is what it looks like you&#39;re expecting it to do.  Change that line to <code>for groups in phoneRegex.findall(open(&quot;input.txt&quot;).read()):</code>"}], "answers": [{"tags": [], "owner": {"reputation": 311, "user_id": 12188100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11d40878af10139c21d72589b3c6b49b?s=128&d=identicon&r=PG&f=1", "display_name": "tst", "link": "https://stackoverflow.com/users/12188100/tst"}, "is_accepted": false, "score": 0, "last_activity_date": 1571646613, "creation_date": 1571646613, "answer_id": 58482507, "question_id": 58421351, "link": "https://stackoverflow.com/questions/58421351/python-how-to-write-the-output-of-regex-matches-to-a-new-text-file/58482507#58482507", "title": "Python How to write the output of regex matches to a new text file?", "body": "<p>Like one of the commentors stated</p>\n\n<pre><code>for groups in emailRegex.findall('input.txt'):\n</code></pre>\n\n<p>does not look for matches in the input.txt file, but in the string \"input.txt\".</p>\n\n<p>You need to read in the file as a string first (maybe do some post-processing if necessary) and save it to a variable, which you can then pass as the argument here.</p>\n"}], "owner": {"reputation": 1, "user_id": 12228943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ecaa762b9918cfe1dd01eee38c5e5d6?s=128&d=identicon&r=PG&f=1", "display_name": "thecodeman0135", "link": "https://stackoverflow.com/users/12228943/thecodeman0135"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571646613, "creation_date": 1571258274, "question_id": 58421351, "link": "https://stackoverflow.com/questions/58421351/python-how-to-write-the-output-of-regex-matches-to-a-new-text-file", "title": "Python How to write the output of regex matches to a new text file?", "body": "<p>I have an input text I'm scanning for matches.</p>\n\n<p>I then create a new text file based on a user given name.</p>\n\n<p>Then I run 2 regex scans on the input text, and only the matches are copied to the new text file.</p>\n\n<p>Thats how it should go but nothing happens. No error, nothing. The output text file gets created, but it is empty.</p>\n\n<p>Regexes:</p>\n\n<pre><code>phoneRegex = re.compile(r'''(\n\n(\\d{3}|\\(\\d{3}\\))? # area code\n\n(\\s|-|\\.)? # separator\n\n(\\d{3}) # first 3 digits\n\n(\\s|-|\\.) # separator\n\n(\\d{4}) # last 4 digits\n\n(\\s*(ext|x|ext.)\\s*(\\d{2,5}))? # extension\n\n)''', re.VERBOSE)\n\nemailRegex = re.compile(r'''(\n\n[a-zA-Z0-9._%+-]+ # username\n\n@ # @ symbol\n\n[a-zA-Z0-9.-]+ # domain name\n\n(\\.[a-zA-Z]{2,4}) # dot-something\n\n)''', re.VERBOSE)\n</code></pre>\n\n<p>Broken code to identify matches and paste to separate text file:</p>\n\n<pre><code>matches = []\n\nfor groups in phoneRegex.findall('input.txt'):\n\nphone = groups[0]\n\noutputFile.write(str(phone))\n\noutputFile.write('\\n')\n\n\n\nfor groups in emailRegex.findall('input.txt'):\n\nemail = groups[0]\n\noutputFile.write(str(email))\n\noutputFile.write('\\n')\n</code></pre>\n\n<p><a href=\"https://pastebin.com/3pTy2K8P\" rel=\"nofollow noreferrer\">https://pastebin.com/3pTy2K8P</a></p>\n"}, {"tags": ["python", "tensorflow", "runtime-error", "conv-neural-network"], "comments": [{"owner": {"reputation": 14244, "user_id": 10133797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLiLn.png?s=128&g=1", "display_name": "OverLordGoldDragon", "link": "https://stackoverflow.com/users/10133797/overlordgolddragon"}, "edited": false, "score": 0, "creation_date": 1571258629, "post_id": 58421343, "comment_id": 103185044, "body": "See <a href=\"https://stackoverflow.com/questions/58053509/why-does-my-keras-model-train-after-i-load-it-even-though-i-have-not-actually-s/58160270#58160270\">this answer</a>; order of installation matters, and so do the versions of CUDA &amp; cuDNN in relation to TensorFlow and operating system. May or may not solve your problem."}, {"owner": {"reputation": 6608, "user_id": 867889, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/766cbf5cffe9872f58f00c994cd34a3f?s=128&d=identicon&r=PG", "display_name": "y.selivonchyk", "link": "https://stackoverflow.com/users/867889/y-selivonchyk"}, "reply_to_user": {"reputation": 14244, "user_id": 10133797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLiLn.png?s=128&g=1", "display_name": "OverLordGoldDragon", "link": "https://stackoverflow.com/users/10133797/overlordgolddragon"}, "edited": false, "score": 0, "creation_date": 1571281234, "post_id": 58421343, "comment_id": 103190477, "body": "Agree with @OverLordGoldDragon. Try removing every TF installation, than installing recommended versions of CUDA as mentioned on TF install page and than running tensorflow. Or you may try conda installation for a change - it might help you handle cuda installs, but be sure to update your nvidia driver before that."}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 7626921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2266019fd5af5976d0cac57d719b665?s=128&d=identicon&r=PG&f=1", "display_name": "Riya208", "link": "https://stackoverflow.com/users/7626921/riya208"}, "edited": false, "score": 0, "creation_date": 1571680151, "post_id": 58429159, "comment_id": 103313306, "body": "Hi. I uninstalled CUDA 10.1, but when I type nvidia-smi in the terminal, it shows that I have CUDA 10.1. Is this normal behaviour?"}, {"owner": {"reputation": 137, "user_id": 7626921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2266019fd5af5976d0cac57d719b665?s=128&d=identicon&r=PG&f=1", "display_name": "Riya208", "link": "https://stackoverflow.com/users/7626921/riya208"}, "edited": false, "score": 0, "creation_date": 1571680181, "post_id": 58429159, "comment_id": 103313321, "body": "<b>When I type</b>: ldconfig -p | grep cuda <b>Output is this</b>:  \tlibicudata.so.60 (libc6,x86-64) =&gt; /usr/lib/x86_64-linux-gnu/libicudata.so.60 \tlibicudata.so (libc6,x86-64) =&gt; /usr/lib/x86_64-linux-gnu/libicudata.so \tlibcudart.so.9.1 (libc6,x86-64) =&gt; /usr/lib/x86_64-linux-gnu/libcudart.so.9.1 \tlibcuda.so.1 (libc6,x86-64) =&gt; /usr/lib/x86_64-linux-gnu/libcuda.so.1 \tlibcuda.so.1 (libc6) =&gt; /usr/lib/i386-linux-gnu/libcuda.so.1 \tlibcuda.so (libc6,x86-64) =&gt; /usr/lib/x86_64-linux-gnu/libcuda.so \tlibcuda.so (libc6) =&gt; /usr/lib/i386-linux-gnu/libcuda.so Based on this output, is CUDA installed?"}, {"owner": {"reputation": 1744, "user_id": 8842694, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1s4AN1_hjqE/AAAAAAAAAAI/AAAAAAAAAfI/3zXyhP8eIEs/photo.jpg=k-s128", "display_name": "Rishabh Sahrawat", "link": "https://stackoverflow.com/users/8842694/rishabh-sahrawat"}, "reply_to_user": {"reputation": 137, "user_id": 7626921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2266019fd5af5976d0cac57d719b665?s=128&d=identicon&r=PG&f=1", "display_name": "Riya208", "link": "https://stackoverflow.com/users/7626921/riya208"}, "edited": false, "score": 0, "creation_date": 1571680588, "post_id": 58429159, "comment_id": 103313499, "body": "Yes that is fine. It is also like this on my machine maybe because we both installed Cuda10.1 first and then had to go back to 10.0 which somehow didn\u2019t change some file for \u2018nvidia -smi\u2019 . You can confirm your Cuda version in other ways like by, \u2018nvcc \u2014version\u2019. For more exhaustive list read <a href=\"https://arnon.dk/check-cuda-installed/\" rel=\"nofollow noreferrer\">here</a>. Please accept my answer if it has solved your problem. :)"}, {"owner": {"reputation": 137, "user_id": 7626921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2266019fd5af5976d0cac57d719b665?s=128&d=identicon&r=PG&f=1", "display_name": "Riya208", "link": "https://stackoverflow.com/users/7626921/riya208"}, "edited": false, "score": 0, "creation_date": 1571680750, "post_id": 58429159, "comment_id": 103313584, "body": "Great! Thanks :) nvcc --version is giving me the output  <b>command &#39;nvcc&#39; not found, but can be installed with:  sudo apt install nvidia-cuda-toolkit</b>  So, well CUDA 10.1 is not installed."}, {"owner": {"reputation": 1744, "user_id": 8842694, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1s4AN1_hjqE/AAAAAAAAAAI/AAAAAAAAAfI/3zXyhP8eIEs/photo.jpg=k-s128", "display_name": "Rishabh Sahrawat", "link": "https://stackoverflow.com/users/8842694/rishabh-sahrawat"}, "reply_to_user": {"reputation": 137, "user_id": 7626921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2266019fd5af5976d0cac57d719b665?s=128&d=identicon&r=PG&f=1", "display_name": "Riya208", "link": "https://stackoverflow.com/users/7626921/riya208"}, "edited": false, "score": 0, "creation_date": 1571680978, "post_id": 58429159, "comment_id": 103313664, "body": "That might be a path file problem. Did you set the path for CuDNN?"}, {"owner": {"reputation": 137, "user_id": 7626921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2266019fd5af5976d0cac57d719b665?s=128&d=identicon&r=PG&f=1", "display_name": "Riya208", "link": "https://stackoverflow.com/users/7626921/riya208"}, "edited": false, "score": 0, "creation_date": 1571681430, "post_id": 58429159, "comment_id": 103313856, "body": "Edit: I opened the bashrc and found the following command:  export LD_LIBRARY_PATH=&quot;$LD_LIBRARY_PATH:/usr/local/cuda/lib64:/usr&zwnj;&#8203;/local/cuda/extras/C&zwnj;&#8203;UPTI/lib64&quot;  export CUDA_HOME=/usr/local/cuda export PATH=&quot;/usr/local/cuda/bin:$PATH&quot; # Virtual Environment Wrapper export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/cuda-10.1/lib64/  Should I remove the above command? I am just following the instruction from the link that you provided and what you said (i.e. to uninstall the cuda 10.1) I haven&#39;t installed CUDA 10.0 yet."}, {"owner": {"reputation": 1744, "user_id": 8842694, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1s4AN1_hjqE/AAAAAAAAAAI/AAAAAAAAAfI/3zXyhP8eIEs/photo.jpg=k-s128", "display_name": "Rishabh Sahrawat", "link": "https://stackoverflow.com/users/8842694/rishabh-sahrawat"}, "reply_to_user": {"reputation": 137, "user_id": 7626921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2266019fd5af5976d0cac57d719b665?s=128&d=identicon&r=PG&f=1", "display_name": "Riya208", "link": "https://stackoverflow.com/users/7626921/riya208"}, "edited": false, "score": 0, "creation_date": 1571681482, "post_id": 58429159, "comment_id": 103313874, "body": "Ah okay. Ja then the error was reasonable haha. Install 10.0 and check"}, {"owner": {"reputation": 137, "user_id": 7626921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2266019fd5af5976d0cac57d719b665?s=128&d=identicon&r=PG&f=1", "display_name": "Riya208", "link": "https://stackoverflow.com/users/7626921/riya208"}, "edited": false, "score": 0, "creation_date": 1571833489, "post_id": 58429159, "comment_id": 103370708, "body": "Thank you @Rishabh Sahrawat."}], "tags": [], "owner": {"reputation": 1744, "user_id": 8842694, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1s4AN1_hjqE/AAAAAAAAAAI/AAAAAAAAAfI/3zXyhP8eIEs/photo.jpg=k-s128", "display_name": "Rishabh Sahrawat", "link": "https://stackoverflow.com/users/8842694/rishabh-sahrawat"}, "is_accepted": true, "score": 3, "last_activity_date": 1571304137, "creation_date": 1571304137, "answer_id": 58429159, "question_id": 58421343, "link": "https://stackoverflow.com/questions/58421343/why-is-the-python-code-not-implementing-on-gpu-tensorflow-gpu-cuda-cudann-ins/58429159#58429159", "title": "Why is the Python code not implementing on GPU? Tensorflow-gpu, CUDA, CUDANN installed", "body": "<p>If you look here-</p>\n\n<pre><code>2019-10-16 22:11:15.786826: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/ros/melodic/lib:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/cuda-10.1/lib64/\n2019-10-16 22:11:15.787053: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/ros/melodic/lib:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/cuda-10.1/lib64/\n2019-10-16 22:11:15.787266: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/ros/melodic/lib:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/cuda-10.1/lib64/\n2019-10-16 22:11:15.787474: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/ros/melodic/lib:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/cuda-10.1/lib64/\n2019-10-16 22:11:15.787682: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/ros/melodic/lib:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/cuda-10.1/lib64/\n2019-10-16 22:11:15.787950: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/ros/melodic/lib:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/cuda-10.1/lib64/\n</code></pre>\n\n<p>It says, it is looking for files with <code>Cuda 10.0</code> however, what it found are <code>Cuda 10.1</code> files. So, first step would be to uninstall and remove Cuda 10.1 version and install Cuda 10.0. Also remove tensorflow, and just keep tensorflow-gpu. \nFor all the other versions follow the exact suggestions <a href=\"https://www.tensorflow.org/install/gpu#software_requirements\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Let us know if that solves your issue.</p>\n"}, {"tags": [], "owner": {"reputation": 137, "user_id": 7626921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2266019fd5af5976d0cac57d719b665?s=128&d=identicon&r=PG&f=1", "display_name": "Riya208", "link": "https://stackoverflow.com/users/7626921/riya208"}, "is_accepted": false, "score": 0, "last_activity_date": 1571833979, "last_edit_date": 1571833979, "creation_date": 1571833261, "answer_id": 58522757, "question_id": 58421343, "link": "https://stackoverflow.com/questions/58421343/why-is-the-python-code-not-implementing-on-gpu-tensorflow-gpu-cuda-cudann-ins/58522757#58522757", "title": "Why is the Python code not implementing on GPU? Tensorflow-gpu, CUDA, CUDANN installed", "body": "<p>Rishabh Sahrawat's answer worked for me. It took me a very long time to figure out how to uninstall CUDA 10.1 and install CUDA 10.0. While <a href=\"https://www.tensorflow.org/install/gpu#software_requirements\" rel=\"nofollow noreferrer\">this</a> is pretty informative, I was still struggling to get all the installation's right as I was getting package error (<em>sigh</em>), NVIDIA driver error, dpkg error, etc. I thought it would be nice to gather everything in one place and guide others (beginner's like me) who are probably facing the same difficulties. I tried the following command to fix the error and it worked for me. Some of them are already mentioned in the question, but nevertheless I have mentioned it here too. I hope this helps.</p>\n\n<p><strong>1. How to uninstall CUDA?</strong></p>\n\n<pre><code>dpkg -l | grep cuda- | awk '{print $2}' | xargs -n1 sudo dpkg --purge --force-all\nsudo apt-get remove cuda-*\n</code></pre>\n\n<p><strong>2. How to check if CUDA is uninstalled/ installed?</strong></p>\n\n<p><em>Command:</em></p>\n\n<pre><code>nvcc --version\n</code></pre>\n\n<p><em>Output (if uninstalled)</em></p>\n\n<pre><code>command 'nvcc' not found, but can be installed with sudo apt install nvidia-cuda-toolkit\n</code></pre>\n\n<p><em>Output (<a href=\"https://stackoverflow.com/questions/9727688/how-to-get-the-cuda-version\">if installed</a>)</em></p>\n\n<pre><code>nvcc: NVIDIA (R) Cuda compiler driver\nCopyright (c) 2005-2018 NVIDIA Corporation\nBuilt on Sat_Aug_25_21:08:01_CDT_2018\nCuda compilation tools, release 10.0, V10.0.130\n</code></pre>\n\n<p><strong>3. In case of the error bash: /usr/bin/nvcc: No such file or directory</strong></p>\n\n<p><a href=\"https://askubuntu.com/questions/885610/nvcc-version-command-says-nvcc-is-not-installed\">Check the path in .bashrc</a>. One can also refer to this <a href=\"https://devtalk.nvidia.com/default/topic/457664/nvcc-quot-no-command-nvcc-found-quot-/\" rel=\"nofollow noreferrer\">link</a></p>\n\n<p><strong>4. How to remove NVIDIA driver old version?</strong></p>\n\n<p><em>Command</em></p>\n\n<pre><code>sudo apt-get --purge remove \"*nvidia*\"\n</code></pre>\n\n<p><strong>5. How to check if the driver is installed?</strong></p>\n\n<p><em>Command</em></p>\n\n<pre><code>nvidia-smi\n</code></pre>\n\n<p><strong>6. In the case of Error message \u201cSub-process /usr/bin/dpkg returned an error code (1)\u201d</strong></p>\n\n<p><a href=\"https://phoenixnap.com/kb/fix-sub-process-usr-bin-dpkg-returned-error-code-1\" rel=\"nofollow noreferrer\">dpkg error</a></p>\n\n<p>One can also try:</p>\n\n<pre><code>sudo apt-get install freeglut3 freeglut3-dev libxi-dev libxmu-dev\napt --fix-broken install # (if it doesn't work, try it in root)\n</code></pre>\n\n<p><strong>7. How to install CUDA?</strong></p>\n\n<p>I used the following command instead of step 4 in <a href=\"https://developer.nvidia.com/cuda-10.0-download-archive?target_os=Linux&amp;target_arch=x86_64&amp;target_distro=Ubuntu&amp;target_version=1804&amp;target_type=debnetwork\" rel=\"nofollow noreferrer\">CUDA installation</a></p>\n\n<pre><code>sudo apt-get install cuda-10-0\n</code></pre>\n\n<p><strong>8. How to install CUDANN?</strong></p>\n\n<p><a href=\"https://developer.nvidia.com/rdp/cudnn-download\" rel=\"nofollow noreferrer\">Download cuDNN Library for Linux</a></p>\n\n<pre><code># Unpack the archive\n\ntar -zxvf cudnn-10.0-linux-x64-v7.6.4.38.tgz\n\n# Move the unpacked contents to your CUDA directory\n\nsudo cp -P cuda/lib64/libcudnn* /usr/local/cuda-10.0/lib64/\nsudo cp  cuda/include/cudnn.h /usr/local/cuda-10.0/include/\n\n# Give read access to all users\n\nsudo chmod a+r /usr/local/cuda-10.0/include/cudnn.h /usr/local/cuda/lib64/libcudnn*\n</code></pre>\n\n<p>One can also use the following links (it did not work for me, but they are worth trying):</p>\n\n<ol>\n<li>I ended up installing CUDA 10.1 by following the steps in the <a href=\"https://gist.github.com/bogdan-kulynych/f64eb148eeef9696c70d485a76e42c3a\" rel=\"nofollow noreferrer\">link</a>.</li>\n<li>I could not <strong>create a new file,\n/etc/profile.d/cuda.sh</strong> as suggested in this <a href=\"https://gist.github.com/pliablepixels/f0f86d8f8a8d2ddcbe9b9d4e25088af4\" rel=\"nofollow noreferrer\">link</a></li>\n<li>This <a href=\"https://gist.github.com/pliablepixels/f0f86d8f8a8d2ddcbe9b9d4e25088af4\" rel=\"nofollow noreferrer\">link</a> is good too.</li>\n</ol>\n\n<p>Once everything is installed, and tensorflow is uninstalled (just keep tensorflow-gpu), the code will run on GPU</p>\n\n<p><a href=\"https://stackoverflow.com/questions/51114771/how-to-ensure-tensorflow-is-using-the-gpu\">How to ensure tensorflow is using the GPU</a></p>\n\n<p><strong>Note:</strong> if you face an import error while importing tensorflow, I did this and it worked for me</p>\n\n<pre><code>pip uninstall tensorflow\npip uninstall tensorflow-gpu\n\npip install tensorflow-gpu\n</code></pre>\n\n<p><strong><em>Additional information:</em></strong> </p>\n\n<p><em>1. To check Ubuntu kernel version:</em></p>\n\n<pre><code>uname -sr\nuname -r\nuname -a\n</code></pre>\n\n<p><em>2. <a href=\"https://linuxize.com/post/how-to-install-gcc-compiler-on-ubuntu-18-04/\" rel=\"nofollow noreferrer\">To install the GCC</a></em></p>\n\n<p>Enjoy :) </p>\n"}, {"tags": [], "owner": {"reputation": 1984, "user_id": 3590384, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/z8txH.jpg?s=128&g=1", "display_name": "salhin", "link": "https://stackoverflow.com/users/3590384/salhin"}, "is_accepted": false, "score": 0, "last_activity_date": 1594110076, "creation_date": 1594110076, "answer_id": 62770987, "question_id": 58421343, "link": "https://stackoverflow.com/questions/58421343/why-is-the-python-code-not-implementing-on-gpu-tensorflow-gpu-cuda-cudann-ins/62770987#62770987", "title": "Why is the Python code not implementing on GPU? Tensorflow-gpu, CUDA, CUDANN installed", "body": "<p>If any of the above doesn't work, try installing <code>tensorflow-gpu</code> with <code>conda</code> instead of <code>pip</code>. For some reason <code>pip install tensorflow-gpu</code> doesn't work as expected.</p>\n<pre><code>conda install tensorflow-gpu\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 7626921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2266019fd5af5976d0cac57d719b665?s=128&d=identicon&r=PG&f=1", "display_name": "Riya208", "link": "https://stackoverflow.com/users/7626921/riya208"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1888, "favorite_count": 0, "accepted_answer_id": 58429159, "answer_count": 3, "score": 0, "last_activity_date": 1594110076, "creation_date": 1571258251, "last_edit_date": 1571258798, "question_id": 58421343, "link": "https://stackoverflow.com/questions/58421343/why-is-the-python-code-not-implementing-on-gpu-tensorflow-gpu-cuda-cudann-ins", "title": "Why is the Python code not implementing on GPU? Tensorflow-gpu, CUDA, CUDANN installed", "body": "<p>I am a beginner when it comes to executing the python code on GPU. I have a CNN code which I would like to run on GPU. I have tensorflow-gpu, CUDA and CUDANN installed on my laptop, but the Python code doesn't execute on GPU.</p>\n\n<p><a href=\"https://i.stack.imgur.com/N3x1n.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/N3x1n.png\" alt=\"nvidia-smi\"></a></p>\n\n<p>I will just write here everything that I tried and post the output</p>\n\n<ol>\n<li><p>Code:</p>\n\n<pre><code>pip freeze | grep tensorflow\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>tensorflow==2.0.0\ntensorflow-estimator==2.0.0\ntensorflow-gpu==2.0.0\n</code></pre></li>\n<li><p>Code:</p>\n\n<pre><code>nvcc --version\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>nvcc: NVIDIA (R) Cuda compiler driver\nCopyright (c) 2005-2019 NVIDIA Corporation\nBuilt on Fri_Feb__8_19:08:17_PST_2019\nCuda compilation tools, release 10.1, V10.1.105\n</code></pre></li>\n<li><p>Code</p>\n\n<pre><code>cat /usr/local/cuda/include/cudnn.h | grep CUDNN_MAJOR -A 2\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>define CUDNN_MAJOR 7\ndefine CUDNN_MINOR 5\ndefine CUDNN_PATCHLEVEL 0\ndefine CUDNN_VERSION (CUDNN_MAJOR * 1000 + CUDNN_MINOR * 100 + CUDNN_PATCHLEVEL)\ninclude \"driver_types.h\"\n</code></pre></li>\n<li><p>Code:</p>\n\n<pre><code>from __future__ import absolute_import, division, print_function, unicode_literals\nimport tensorFlow as tf\n\nprint(\"Num GPUs Available: \", len(tf.config.experimental.list_physical_devices('GPU')))\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Num GPUs Available:  0\n</code></pre></li>\n<li><p>Code</p>\n\n<pre><code>import tensorflow\nfrom tensorflow.python.client import device_lib\nprint(device_lib.list_local_devices())\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>2019-10-16 22:11:15.280922: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\n2019-10-16 22:11:15.484734: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2808000000 Hz\n2019-10-16 22:11:15.508127: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x45d4c60 executing computations on platform Host. Devices:\n2019-10-16 22:11:15.508212: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version\n2019-10-16 22:11:15.784006: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1006] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2019-10-16 22:11:15.785226: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x45d6ad0 executing computations on platform CUDA. Devices:\n2019-10-16 22:11:15.785278: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): GeForce GTX 1060, Compute Capability 6.1\n2019-10-16 22:11:15.785605: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1006] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n2019-10-16 22:11:15.786528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: \nname: GeForce GTX 1060 major: 6 minor: 1 memoryClockRate(GHz): 1.6705\npciBusID: 0000:01:00.0\n2019-10-16 22:11:15.786826: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/ros/melodic/lib:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/cuda-10.1/lib64/\n2019-10-16 22:11:15.787053: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/ros/melodic/lib:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/cuda-10.1/lib64/\n2019-10-16 22:11:15.787266: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/ros/melodic/lib:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/cuda-10.1/lib64/\n2019-10-16 22:11:15.787474: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/ros/melodic/lib:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/cuda-10.1/lib64/\n2019-10-16 22:11:15.787682: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/ros/melodic/lib:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/cuda-10.1/lib64/\n2019-10-16 22:11:15.787950: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/ros/melodic/lib:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/cuda-10.1/lib64/\n2019-10-16 22:11:15.788010: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7\n2019-10-16 22:11:15.788036: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.\nSkipping registering GPU devices...\n2019-10-16 22:11:15.788073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] \nDevice interconnect StreamExecutor with strength 1 edge matrix:\n2019-10-16 22:11:15.788094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 \n2019-10-16 22:11:15.788111: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N \n[name: \"/device:CPU:0\"\ndevice_type: \"CPU\"\nmemory_limit: 268435456\nlocality {\n}\nincarnation: 7400412130462543104\n,name: \"/device:XLA_CPU:0\"\n\ndevice_type: \"XLA_CPU\"\nmemory_limit: 17179869184\nlocality {\n}\nincarnation: 10419596086097903998\nphysical_device_desc: \"device: XLA_CPU device\"\n,name: \"/device:XLA_GPU:0\"\ndevice_type: \"XLA_GPU\"\nmemory_limit: 17179869184\nlocality {\n}\nincarnation: 10970348491339008844\nphysical_device_desc: \"device: XLA_GPU device\"\n]\n</code></pre></li>\n</ol>\n\n<p>I have referred to several websites which basically says that if you have GPU and tensorflow-gpu installed then the program will automatically detect the GPU and run the code. I also know that there are similar questions on StackOverflow, and the above code is implemented after finding answers to similar question. The official website of <a href=\"https://www.tensorflow.org/guide/gpu\" rel=\"nofollow noreferrer\">tensorflow 2.0</a> </p>\n\n<pre><code>tf.debugging.set_log_device_placement(True)\n\n# Create some tensors\na = tf.constant([[1.0, 2.0, 3.0], [4.0, 5.0, 6.0]])\nb = tf.constant([[1.0, 2.0], [3.0, 4.0], [5.0, 6.0]])\nc = tf.matmul(a, b)\n\nprint(c)\n</code></pre>\n\n<p>Output is:</p>\n\n<pre><code>RuntimeError: Device placement logging must be set at program startup\n</code></pre>\n\n<p>Why is my program not executing on gpu?</p>\n"}, {"tags": ["python", "pandas", "scikit-learn", "sklearn-pandas"], "comments": [{"owner": {"reputation": 43491, "user_id": 4001592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HWyjo.jpg?s=128&g=1", "display_name": "Dani Mesejo", "link": "https://stackoverflow.com/users/4001592/dani-mesejo"}, "edited": false, "score": 0, "creation_date": 1571258795, "post_id": 58421332, "comment_id": 103185108, "body": "Can you define the list of items beforehand?"}, {"owner": {"reputation": 6972, "user_id": 3731467, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ba1b20a3d2de4a97b893058a4673510a?s=128&d=identicon&r=PG&f=1", "display_name": "emehex", "link": "https://stackoverflow.com/users/3731467/emehex"}, "reply_to_user": {"reputation": 43491, "user_id": 4001592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HWyjo.jpg?s=128&g=1", "display_name": "Dani Mesejo", "link": "https://stackoverflow.com/users/4001592/dani-mesejo"}, "edited": false, "score": 0, "creation_date": 1571258932, "post_id": 58421332, "comment_id": 103185173, "body": "@DanielMesejo sure! I&#39;m imagining a <code>fit()</code> step that will memorize a list of all the possible items (sort of like LabelEncoder)"}, {"owner": {"reputation": 2967, "user_id": 4828815, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/--CqgH2V98Jg/AAAAAAAAAAI/AAAAAAAAABY/lilOgpMEIEs/photo.jpg?sz=128", "display_name": "Poojan", "link": "https://stackoverflow.com/users/4828815/poojan"}, "edited": false, "score": 1, "creation_date": 1571260010, "post_id": 58421332, "comment_id": 103185602, "body": "@emehex Check out my answer. Fixed few more errors. Sorry jupyer using previous variables. Found bugs after restarting. BTW good question."}], "answers": [{"comments": [{"owner": {"reputation": 6972, "user_id": 3731467, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ba1b20a3d2de4a97b893058a4673510a?s=128&d=identicon&r=PG&f=1", "display_name": "emehex", "link": "https://stackoverflow.com/users/3731467/emehex"}, "edited": false, "score": 0, "creation_date": 1571431445, "post_id": 58421626, "comment_id": 103252873, "body": "Hey @Poojan, thanks for your work! I&#39;ve been mulling over the problem a bunch more and just posted the solution I landed on. Might perhaps be of some interest!"}, {"owner": {"reputation": 2967, "user_id": 4828815, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/--CqgH2V98Jg/AAAAAAAAAAI/AAAAAAAAABY/lilOgpMEIEs/photo.jpg?sz=128", "display_name": "Poojan", "link": "https://stackoverflow.com/users/4828815/poojan"}, "reply_to_user": {"reputation": 6972, "user_id": 3731467, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ba1b20a3d2de4a97b893058a4673510a?s=128&d=identicon&r=PG&f=1", "display_name": "emehex", "link": "https://stackoverflow.com/users/3731467/emehex"}, "edited": false, "score": 0, "creation_date": 1571518730, "post_id": 58421626, "comment_id": 103270300, "body": "@emehex That&#39;s a good solution. But since you didn&#39;t mention the use of sklearn i provided on with pandas."}], "tags": [], "owner": {"reputation": 2967, "user_id": 4828815, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/--CqgH2V98Jg/AAAAAAAAAAI/AAAAAAAAABY/lilOgpMEIEs/photo.jpg?sz=128", "display_name": "Poojan", "link": "https://stackoverflow.com/users/4828815/poojan"}, "is_accepted": false, "score": 2, "last_activity_date": 1571261821, "last_edit_date": 1571261821, "creation_date": 1571259521, "answer_id": 58421626, "question_id": 58421332, "link": "https://stackoverflow.com/questions/58421332/transform-users-repeated-over-multiple-rows-and-items-in-a-dataframe-into-a-la/58421626#58421626", "title": "Transform users (repeated over multiple rows) and items in a dataframe into a label binarized dataframe", "body": "<ul>\n<li>Oh boy. Here is what i came up with.</li>\n<li>Long Chaining. I will break it down.</li>\n</ul>\n\n<pre class=\"lang-py prettyprint-override\"><code>import pandas as pd\ndef encode(l):\n    return pd.DataFrame(l, columns=['item', 'user'])['item'].unique()\n\n# create dataframe\n# group by and get dummies\n# remove unncessary colums which are not part of encoding class\n# apply to create list\ndef add_user(l, _key_):\n    return  pd.DataFrame(l, columns=['item', 'user']).\\\n            groupby('user')['item'].apply('|'.join).str.get_dummies().\\\n            reindex(columns=_key_).fillna(0).astype('int').\\\n            apply(lambda x: list(x), axis=1)\n\n_key_ = encode ([\n    ['a', 1], \n    ['b', 1],\n    ['c', 1],\n    ['a', 2], \n    ['c', 3], \n    ['b', 4], \n    ['c', 4]\n])\n</code></pre>\n\n<pre><code>add_user([\n    ['a', 1], \n    ['b', 1],\n    ['c', 1],\n    ['a', 2], \n    ['c', 3], \n    ['b', 4], \n    ['c', 4]\n], _key_)\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>user\n1    [1, 1, 1]\n2    [1, 0, 0]\n3    [0, 0, 1]\n4    [0, 1, 1]\n</code></pre>\n\n<pre><code>add_user([['b',5],['d', 5]], _key_)\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>user\n5    [0, 1, 0]\n</code></pre>\n\n<ul>\n<li><code>encode</code> will generate initial <code>keys</code> for your encoder.</li>\n<li><code>add_user</code> you can call this function for each new user.</li>\n<li>Note you can <code>reset_index</code> to get <code>user</code> column.    </li>\n</ul>\n\n<p><strong>Soulution 2:</strong></p>\n\n<ul>\n<li>inspired from @WeNYoBen's Answer.</li>\n</ul>\n\n<pre class=\"lang-py prettyprint-override\"><code>import pandas as pd\ndf = pd.DataFrame([\n    ['a', 1], \n    ['b', 1],\n    ['c', 1],\n    ['a', 2], \n    ['c', 3], \n    ['b', 4], \n    ['c', 4]\n], columns=['item', 'user'])\n_key_ = df.item.unique()\ndef add_user(l, _key_):\n    df = pd.DataFrame(l, columns=['item','user'])\n    return pd.crosstab(df.user, df.item).reindex(columns=_key_.tolist()).fillna(0).astype('int').apply(list, axis=1)\n\nadd_user([['b',5],['d', 5]], _key_)\n</code></pre>\n\n<ul>\n<li>Not readable version of <code>add_user</code> function.</li>\n</ul>\n\n<pre class=\"lang-py prettyprint-override\"><code>def add_user(l, _key_):\n    return pd.crosstab(*[[list(x)] for x in list(zip(*l))[::-1]]).reindex(columns=_key_.tolist()).fillna(0).astype('int').apply(list, axis=1)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6972, "user_id": 3731467, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ba1b20a3d2de4a97b893058a4673510a?s=128&d=identicon&r=PG&f=1", "display_name": "emehex", "link": "https://stackoverflow.com/users/3731467/emehex"}, "edited": false, "score": 1, "creation_date": 1571431484, "post_id": 58421781, "comment_id": 103252893, "body": "Hey @Daniel Mesejo, I&#39;ve been mulling over the problem a bunch more and just posted the solution I landed on. Might be of some interest!"}], "tags": [], "owner": {"reputation": 43491, "user_id": 4001592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HWyjo.jpg?s=128&g=1", "display_name": "Dani Mesejo", "link": "https://stackoverflow.com/users/4001592/dani-mesejo"}, "is_accepted": false, "score": 1, "last_activity_date": 1571260347, "creation_date": 1571260347, "answer_id": 58421781, "question_id": 58421332, "link": "https://stackoverflow.com/questions/58421332/transform-users-repeated-over-multiple-rows-and-items-in-a-dataframe-into-a-la/58421781#58421781", "title": "Transform users (repeated over multiple rows) and items in a dataframe into a label binarized dataframe", "body": "<p>For this problem I would create a class <code>Encoder</code>, like the following:</p>\n\n<pre><code>class Encoder:\n\n    def __init__(self):\n        self.items = None\n\n    def transform(self, lst):\n        \"\"\"Returns a dictionary where the keys are the users_ids and the values are the encoded items\"\"\"\n        if self.items is None:\n            self.items = self.__items(lst)\n\n        users = {}\n        for item, user in lst:\n            users.setdefault(user, set()).add(item)\n\n        return {user: np.array([item in basket for item in self.items], dtype=np.uint8) for user, basket in users.items()}\n\n    def reset(self):\n        self.items = None\n\n    @staticmethod\n    def __items(lst):\n        seen = set()\n        items = []\n        for item, _ in lst:\n            if item not in seen:\n                items.append(item)\n                seen.add(item)\n        return items\n</code></pre>\n\n<p>Then, you could use it like this:</p>\n\n<pre><code>encoder = Encoder()\nresult = encoder.transform(df.values.tolist())  # here df is your original DataFrame\ndf_result = pd.DataFrame(data=result.values(), columns=encoder.items, index=result.keys())\nprint(df_result)\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>   a  b  c\n1  1  1  1\n2  1  0  0\n3  0  0  1\n4  0  1  1\n</code></pre>\n\n<p>Notice that the index in the <code>df_result</code> are the users. Then the new case could be handled like this:</p>\n\n<pre><code>new_user = pd.DataFrame([\n    ['c', 5],\n    ['d', 5]\n], columns=['item', 'user'])\nnew_user_result = encoder.transform(new_user.values.tolist())\nprint(pd.DataFrame(data=new_user_result.values(), columns=encoder.items, index=new_user_result.keys()))\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>   a  b  c\n5  0  0  1\n</code></pre>\n\n<p>Receiving a list and returning a dictionary is a more flexible approach, at least in my opinion. Also returning a dictionary will handle the case were the users are not consecutive integers (they can be UUIDs, for example). Finally in the <code>Encoder</code> class, you also has a reset method, essentially to <em>forget</em> the items.</p>\n"}, {"tags": [], "owner": {"reputation": 6972, "user_id": 3731467, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ba1b20a3d2de4a97b893058a4673510a?s=128&d=identicon&r=PG&f=1", "display_name": "emehex", "link": "https://stackoverflow.com/users/3731467/emehex"}, "is_accepted": true, "score": 1, "last_activity_date": 1571432357, "last_edit_date": 1571432357, "creation_date": 1571431343, "answer_id": 58457932, "question_id": 58421332, "link": "https://stackoverflow.com/questions/58421332/transform-users-repeated-over-multiple-rows-and-items-in-a-dataframe-into-a-la/58457932#58457932", "title": "Transform users (repeated over multiple rows) and items in a dataframe into a label binarized dataframe", "body": "<p>A solution with some standard scikit-learn:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>from sklearn.feature_extraction.text import CountVectorizer\n\ndef squish(df, user='user', item='item'):\n    df = df.groupby([user])[item].apply(lambda x: ','.join(x))\n    X = pd.DataFrame(df)[item]\n    return X\n\ncv = CountVectorizer(tokenizer=lambda x: x.split(','))\nX = squish(df)\ncv.fit_transform(X).todense()\n</code></pre>\n\n<p>Which will produce:</p>\n\n<pre><code># matrix([[1, 1, 1],\n#         [1, 0, 0],\n#         [0, 0, 1],\n#         [0, 1, 1]], dtype=int64)\n</code></pre>\n\n<p>It also solves for the new user case:</p>\n\n<pre><code>new_user = pd.DataFrame([\n    ['c', 5],\n    ['d', 5]\n], columns=['item', 'user'])\n\nX_new = squish(new_user)\ncv.transform(X_new).todense()\n</code></pre>\n\n<p>Correctly yielding:</p>\n\n<pre><code># matrix([[0, 0, 1]])\n</code></pre>\n"}], "owner": {"reputation": 6972, "user_id": 3731467, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ba1b20a3d2de4a97b893058a4673510a?s=128&d=identicon&r=PG&f=1", "display_name": "emehex", "link": "https://stackoverflow.com/users/3731467/emehex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 58457932, "answer_count": 3, "score": 3, "last_activity_date": 1571432357, "creation_date": 1571258213, "last_edit_date": 1571258874, "question_id": 58421332, "link": "https://stackoverflow.com/questions/58421332/transform-users-repeated-over-multiple-rows-and-items-in-a-dataframe-into-a-la", "title": "Transform users (repeated over multiple rows) and items in a dataframe into a label binarized dataframe", "body": "<p>I have a DataFrame that looks like this</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>df = pd.DataFrame([\n    ['a', 1], \n    ['b', 1],\n    ['c', 1],\n    ['a', 2], \n    ['c', 3], \n    ['b', 4], \n    ['c', 4]\n], columns=['item', 'user'])\n</code></pre>\n\n<p>Where each user is repeated across multiple rows (with different items).</p>\n\n<p>I would like to perform a LabelEncoder/LabelBinarizer like transform (??) to convert the DataFrame into something that looks like this:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>pd.DataFrame([\n    [1, 1, 1], #user 1\n    [1, 0, 0], #user 2\n    [0, 0, 1], #user 3\n    [0, 1, 1]  #user 4\n], columns=['a', 'b', 'c'])\n</code></pre>\n\n<p>I likely don't want to use pandas (<code>pivot</code>, <code>get_dummies</code>, <code>crosstab</code>), because I want to pass a new user to the transformer:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>new_user = pd.DataFrame([\n    ['c', 5], \n    ['d', 5]\n], columns=['item', 'user'])\n</code></pre>\n\n<p>And get back something like this:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>[0, 0, 1]\n</code></pre>\n\n<p><strong>Important</strong>: solution must solve for the new user case (and dropped 'd' item), and preserve column order as well as dimensions</p>\n"}, {"tags": ["python", "stream", "pcap", "pcap-ng", "kismet-wireless"], "comments": [{"owner": {"reputation": 2466, "user_id": 1596750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AUl9X.jpg?s=128&g=1", "display_name": "Ross Jacobs", "link": "https://stackoverflow.com/users/1596750/ross-jacobs"}, "edited": false, "score": 0, "creation_date": 1571259450, "post_id": 58421323, "comment_id": 103185402, "body": "&quot;getting useful data out of the stream&quot; =&gt; How does expectation differ from actual? Can you <a href=\"https://stackoverflow.com/posts/58421323/edit\">provide</a> both in your question?"}, {"owner": {"reputation": 2466, "user_id": 1596750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AUl9X.jpg?s=128&g=1", "display_name": "Ross Jacobs", "link": "https://stackoverflow.com/users/1596750/ross-jacobs"}, "edited": false, "score": 0, "creation_date": 1571259673, "post_id": 58421323, "comment_id": 103185479, "body": "Also keep in mind that python&#39;s <code>print</code> will automatically add a newline char much like bash&#39;s <code>echo</code> (this may or may not be relevant, depending on what <code>print(line.hex())</code> is standing in for)."}, {"owner": {"reputation": 55, "user_id": 7537973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/560fcb0e0a693406a070291d3e303572?s=128&d=identicon&r=PG&f=1", "display_name": "b-rad15", "link": "https://stackoverflow.com/users/7537973/b-rad15"}, "reply_to_user": {"reputation": 2466, "user_id": 1596750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AUl9X.jpg?s=128&g=1", "display_name": "Ross Jacobs", "link": "https://stackoverflow.com/users/1596750/ross-jacobs"}, "edited": false, "score": 0, "creation_date": 1571273890, "post_id": 58421323, "comment_id": 103189072, "body": "Edited to add that I need to find the start of a packet and then can more easily follow the standard and also the print is essentially standing in for <code>line[bytenumbers]</code> so no newline affecting anything."}, {"owner": {"reputation": 2466, "user_id": 1596750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AUl9X.jpg?s=128&g=1", "display_name": "Ross Jacobs", "link": "https://stackoverflow.com/users/1596750/ross-jacobs"}, "edited": false, "score": 0, "creation_date": 1571275640, "post_id": 58421323, "comment_id": 103189400, "body": "Normally, a pcapng file will have a pcapng header (Section Header Block), and packets (Enhanced Packet Block). &#39;is not consistent with the format&#39; =&gt; Please elaborate."}, {"owner": {"reputation": 55, "user_id": 7537973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/560fcb0e0a693406a070291d3e303572?s=128&d=identicon&r=PG&f=1", "display_name": "b-rad15", "link": "https://stackoverflow.com/users/7537973/b-rad15"}, "reply_to_user": {"reputation": 2466, "user_id": 1596750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AUl9X.jpg?s=128&g=1", "display_name": "Ross Jacobs", "link": "https://stackoverflow.com/users/1596750/ross-jacobs"}, "edited": false, "score": 0, "creation_date": 1571344807, "post_id": 58421323, "comment_id": 103220511, "body": "So i did some more research today and the first issue is that there is no block type on the section header block. After assuming block 1 was the shb I was able to read it fine for the most part but now about half of the blocks have lengths inconsistent with the defined lengths in bytes 4-8. I also did a test and simply did line.split(b&#39;\\x06\\x00\\x00\\x00&#39;) assuming every block was a packet and going from there the blocks with inconsistent lengths were off by 1 or 6 bytes no more no less."}, {"owner": {"reputation": 2466, "user_id": 1596750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AUl9X.jpg?s=128&g=1", "display_name": "Ross Jacobs", "link": "https://stackoverflow.com/users/1596750/ross-jacobs"}, "edited": false, "score": 0, "creation_date": 1571345067, "post_id": 58421323, "comment_id": 103220621, "body": "Sounds like a Kismet has a bug with its pcapng implementation - I would <a href=\"https://github.com/kismetwireless/kismet/issues/new\" rel=\"nofollow noreferrer\">raise an issue</a>."}], "answers": [{"tags": [], "owner": {"reputation": 55, "user_id": 7537973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/560fcb0e0a693406a070291d3e303572?s=128&d=identicon&r=PG&f=1", "display_name": "b-rad15", "link": "https://stackoverflow.com/users/7537973/b-rad15"}, "is_accepted": true, "score": 1, "last_activity_date": 1571687605, "creation_date": 1571687605, "answer_id": 58493242, "question_id": 58421323, "link": "https://stackoverflow.com/questions/58421323/how-to-read-pcapng-file-stream-from-kismet/58493242#58493242", "title": "How to read pcapng file stream from kismet", "body": "<p>It looks like the error was that the python requests module was not capturing the entire stream and certain bytes were missing. By using </p>\n\n<pre><code>curlSubProcess = subprocess.Popen(['curl', 'url/pcap/all_packets.pcapng'], stdout=subprocess.PIPE, bufsize=1)\ncurlSubProcess.stdout.read(lengthnext)\n</code></pre>\n\n<p>in a while loop where <code>lengthnext</code> is the length of the next packet I was able to read it correctly. I then parsed this binary block data with a class I wrote and the packet data with scapy and it is working as expected.</p>\n"}], "owner": {"reputation": 55, "user_id": 7537973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/560fcb0e0a693406a070291d3e303572?s=128&d=identicon&r=PG&f=1", "display_name": "b-rad15", "link": "https://stackoverflow.com/users/7537973/b-rad15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 485, "favorite_count": 0, "accepted_answer_id": 58493242, "answer_count": 1, "score": 0, "last_activity_date": 1571687605, "creation_date": 1571258138, "last_edit_date": 1571273736, "question_id": 58421323, "link": "https://stackoverflow.com/questions/58421323/how-to-read-pcapng-file-stream-from-kismet", "title": "How to read pcapng file stream from kismet", "body": "<p>I am using kismet running on a raspberry pi to capture network data that I need to analyze in real time on another device. Kismet's api has an endpoint to <a href=\"https://www.kismetwireless.net/docs/devel/webui_rest/packet_capture/\" rel=\"nofollow noreferrer\">receive a stream of binary data in the pcapng format</a>. I have successfully been able to read the stream but I cannot find any documentation on getting useful data out of the stream besides the actual pcapng standard. This would be fine but the data coming in is not consistent with the format and I have found no libraries that have been able to successfully parse this stream. I think that the issue is that when reading the stream extra data is inserted between each captured packet so determining the start of the packet is the main issue. I am currently using python but am open to other languages if they can easily solve this problem or have libraries already written.</p>\n\n<p>This is the code I am using to get the data into python where <code>print(line.hex())</code> would be where I accessed the relevant data.</p>\n\n<pre><code>import requests\nr = requests.get(url, stream=True)\nfor line in r.iter_lines():\n    print(line.hex())\n</code></pre>\n"}, {"tags": ["python", "pandas", "dataframe", "series"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1571258241, "post_id": 58421316, "comment_id": 103184880, "body": "<code>processed_df</code> is a list, not a dataframe."}, {"owner": {"reputation": 143, "user_id": 8867239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/226e07b65977b2e9eab910488e0ce7bd?s=128&d=identicon&r=PG&f=1", "display_name": "yaw", "link": "https://stackoverflow.com/users/8867239/yaw"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1571258347, "post_id": 58421316, "comment_id": 103184926, "body": "@Barmar <code>type(processed_df)</code> <code>Out[3]: pandas.core.frame.DataFrame</code> so already it&#39;s a df"}, {"owner": {"reputation": 1083, "user_id": 4739755, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/-xGt648wZsco/AAAAAAAAAAI/AAAAAAAAAGo/EfA-KvgfzKo/photo.jpg?sz=128", "display_name": "b_c", "link": "https://stackoverflow.com/users/4739755/b-c"}, "edited": false, "score": 1, "creation_date": 1571258419, "post_id": 58421316, "comment_id": 103184954, "body": "The message <code>&#39;List indices must be integers or slices, not string&#39;</code> refers to the index you&#39;re using to access elements, not the element itself. Since <code>processed_df</code> is a list, putting <code>processed_df[&#39;x&#39;]</code> means &quot;Give me the element at index &#39;x&#39;&quot;, which doesn&#39;t make any sense in the context of a list."}, {"owner": {"reputation": 143, "user_id": 8867239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/226e07b65977b2e9eab910488e0ce7bd?s=128&d=identicon&r=PG&f=1", "display_name": "yaw", "link": "https://stackoverflow.com/users/8867239/yaw"}, "edited": false, "score": 0, "creation_date": 1571258540, "post_id": 58421316, "comment_id": 103185009, "body": "Okay, you are correct. How can I access it as a dataframe?"}, {"owner": {"reputation": 143, "user_id": 8867239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/226e07b65977b2e9eab910488e0ce7bd?s=128&d=identicon&r=PG&f=1", "display_name": "yaw", "link": "https://stackoverflow.com/users/8867239/yaw"}, "edited": false, "score": 0, "creation_date": 1571258717, "post_id": 58421316, "comment_id": 103185085, "body": "Why on the variables list and in console it displays as a dataframe, while already in code(I printed it in my runner) it is a type: list?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1571258742, "post_id": 58421316, "comment_id": 103185091, "body": "You must be reassigning it somewhere. You need to post more of the code."}, {"owner": {"reputation": 573, "user_id": 3911355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac5a661e8c2c34e2e0b0fa6c57bfd513?s=128&d=identicon&r=PG", "display_name": "mgrollins", "link": "https://stackoverflow.com/users/3911355/mgrollins"}, "edited": false, "score": 0, "creation_date": 1571261508, "post_id": 58421316, "comment_id": 103186144, "body": "Are you sure about the type for &quot;PERIOD&quot; and that it isn&#39;t messing up your slice?"}, {"owner": {"reputation": 6232, "user_id": 509977, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/DxOt0.jpg?s=128&g=1", "display_name": "Pitto", "link": "https://stackoverflow.com/users/509977/pitto"}, "edited": false, "score": 0, "creation_date": 1571262998, "post_id": 58421316, "comment_id": 103186602, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}], "owner": {"reputation": 143, "user_id": 8867239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/226e07b65977b2e9eab910488e0ce7bd?s=128&d=identicon&r=PG&f=1", "display_name": "yaw", "link": "https://stackoverflow.com/users/8867239/yaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571262802, "creation_date": 1571258112, "question_id": 58421316, "link": "https://stackoverflow.com/questions/58421316/list-indices-must-be-integers-or-slices-not-string-but-they-actually-are-inte", "title": "&#39;List indices must be integers or slices, not string&#39; but they actually are integers", "body": "<p>As in question title, I've got problem with below code:</p>\n\n<pre><code>for index in range(0, len(processed_df) - PERIOD, STEP):\n    print(index)\n    print(type(index))\n    x_samples = processed_df['x'].iloc[index:index + PERIOD]\n    y_samples = processed_df['y'].iloc[index:index + PERIOD]\n    z_samples = processed_df['z'].iloc[index:index + PERIOD]\n    label = stats.mode(processed_df['activity'][index:index + PERIOD])[0][0]\n    fragments.append([x_samples, y_samples, z_samples])\n    fragments_labels.append(label)\n</code></pre>\n\n<p>Print output:</p>\n\n<pre><code>0\n&lt;class 'int'&gt;\n</code></pre>\n\n<p>I've tried parsing indices to integers, without success. I really don't know what's happening at the moment and why I'm getting an error:</p>\n\n<pre><code>TypeError: list indices must be integers or slices, not str\n</code></pre>\n\n<p>On the line:</p>\n\n<pre><code>x_samples = processed_df['x'].iloc[index:index + PERIOD]\n</code></pre>\n"}, {"tags": ["python", "numpy"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 12109772, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LTdou.png?s=128&g=1", "display_name": "Smile", "link": "https://stackoverflow.com/users/12109772/smile"}, "edited": false, "score": 0, "creation_date": 1571258879, "post_id": 58421399, "comment_id": 103185152, "body": "Thank you! Can you please show me how to use np.apply_along_axis? Specifically how to supply the argument via **kwargs?"}, {"owner": {"reputation": 711, "user_id": 10734880, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VqInoFdU3M8/AAAAAAAAAAI/AAAAAAAAAA4/KLtzLyk_ZJ0/photo.jpg?sz=128", "display_name": "Nick Martin", "link": "https://stackoverflow.com/users/10734880/nick-martin"}, "reply_to_user": {"reputation": 69, "user_id": 12109772, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LTdou.png?s=128&g=1", "display_name": "Smile", "link": "https://stackoverflow.com/users/12109772/smile"}, "edited": false, "score": 0, "creation_date": 1571259084, "post_id": 58421399, "comment_id": 103185238, "body": "@Smile, can you provide an example of P? I&#39;m finding it difficult to know how it&#39;s created"}, {"owner": {"reputation": 69, "user_id": 12109772, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LTdou.png?s=128&g=1", "display_name": "Smile", "link": "https://stackoverflow.com/users/12109772/smile"}, "edited": false, "score": 0, "creation_date": 1571259407, "post_id": 58421399, "comment_id": 103185380, "body": "for example P = np.array([[0,0,1],[1,0,0],[0,1,0]])"}], "tags": [], "owner": {"reputation": 711, "user_id": 10734880, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VqInoFdU3M8/AAAAAAAAAAI/AAAAAAAAAA4/KLtzLyk_ZJ0/photo.jpg?sz=128", "display_name": "Nick Martin", "link": "https://stackoverflow.com/users/10734880/nick-martin"}, "is_accepted": true, "score": 0, "last_activity_date": 1571261735, "last_edit_date": 1571261735, "creation_date": 1571258466, "answer_id": 58421399, "question_id": 58421295, "link": "https://stackoverflow.com/questions/58421295/numpy-randomly-choose-1-sample-from-each-of-the-n-discrete-probability-distribu/58421399#58421399", "title": "Numpy: randomly choose 1 sample from each of the N discrete probability distributions", "body": "<p>I think you probably want <a href=\"https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.apply_along_axis.html\" rel=\"nofollow noreferrer\"><code>np.apply_along_axis</code></a></p>\n\n<pre><code>import numpy as np\n\nP = np.array([[0,1/2,1/2],[1,0,0],[1/3,1/3,1/3]])\n\ndef rand_choice(c):\n  return np.random.choice(c.size, p=c)\n\nsamples = np.apply_along_axis(rand_choice, 1, P)\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 12109772, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LTdou.png?s=128&g=1", "display_name": "Smile", "link": "https://stackoverflow.com/users/12109772/smile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 58421399, "answer_count": 1, "score": 3, "last_activity_date": 1571261735, "creation_date": 1571258010, "last_edit_date": 1571258318, "question_id": 58421295, "link": "https://stackoverflow.com/questions/58421295/numpy-randomly-choose-1-sample-from-each-of-the-n-discrete-probability-distribu", "title": "Numpy: randomly choose 1 sample from each of the N discrete probability distributions", "body": "<p>I have a 2-D Numpy array <code>P</code> where each <code>P[ii,:]</code> is a discrete probability distribution over 0,1,...,M-1. I would like to sample from each of the <code>P[ii,:]</code>'s once. I've tried to use the <code>numpy.random.choice</code> function:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>for ii in range(N):\n    samples[ii] = np.random.choice(np.arange(M), p=P[ii,:])\n</code></pre>\n\n<p>How can I do the same thing without for loop? </p>\n\n<p>Thank you.</p>\n"}, {"tags": ["python", "dataframe", "indexing"], "comments": [{"owner": {"reputation": 43491, "user_id": 4001592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HWyjo.jpg?s=128&g=1", "display_name": "Dani Mesejo", "link": "https://stackoverflow.com/users/4001592/dani-mesejo"}, "edited": false, "score": 2, "creation_date": 1571258045, "post_id": 58421266, "comment_id": 103184796, "body": "What is <code>df</code>, from the error it seems is a boolean."}, {"owner": {"reputation": 711, "user_id": 10734880, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VqInoFdU3M8/AAAAAAAAAAI/AAAAAAAAAA4/KLtzLyk_ZJ0/photo.jpg?sz=128", "display_name": "Nick Martin", "link": "https://stackoverflow.com/users/10734880/nick-martin"}, "edited": false, "score": 1, "creation_date": 1571258051, "post_id": 58421266, "comment_id": 103184801, "body": "Can you set up an example to show this failing on <a href=\"https://repl.it\" rel=\"nofollow noreferrer\">repl.it</a>? Doesn&#39;t look like <code>df</code> is actually of Type DataFrame"}, {"owner": {"reputation": 462, "user_id": 12081954, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCny9pyWN5BhoN3035PNaRoL0JGqksQg8yvRcP-kQ=k-s128", "display_name": "mayosten", "link": "https://stackoverflow.com/users/12081954/mayosten"}, "edited": false, "score": 0, "creation_date": 1571269974, "post_id": 58421266, "comment_id": 103188334, "body": "Specifically, we need a snippet of how you create df with dummy data. Not the whole df = pd.read_csv(...) but a sample that includes data, like <code>df = pd.DataFrame({&#39;col1&#39;: [1,2,3], &#39;col2&#39;: [4,5,6]})</code>. I would refresh your notebook and start from scratch in case <code>df</code> got overwritten at some point executing other cells."}], "answers": [{"tags": [], "owner": {"reputation": 471, "user_id": 6801991, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MGoA91yGouk/AAAAAAAAAAI/AAAAAAAABmQ/XdaNdU--HxE/photo.jpg?sz=128", "display_name": "hilton92", "link": "https://stackoverflow.com/users/6801991/hilton92"}, "is_accepted": true, "score": 0, "last_activity_date": 1571333219, "creation_date": 1571333219, "answer_id": 58437860, "question_id": 58421266, "link": "https://stackoverflow.com/questions/58421266/dropping-keeping-dataframe-columns/58437860#58437860", "title": "Dropping / Keeping Dataframe columns", "body": "<p>To extract those columns from the dataframe you can do either</p>\n\n<p><code>result = df[['code', 'proc', 'All procedures']]</code></p>\n\n<p>or</p>\n\n<p><code>result = df.loc[:, ['code', 'proc', 'All procedures']]</code></p>\n\n<p>See pandas docs <a href=\"https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html\" rel=\"nofollow noreferrer\">here</a> for info on this - known as slicing</p>\n\n<p>Your issue was not including the columns in one list passed into the dataframe - only <code>'code'</code> was passed into the actual <code>df</code> selector</p>\n"}], "owner": {"reputation": 169, "user_id": 11795964, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wJ7Tx9viE_Y/AAAAAAAAAAI/AAAAAAAAAIE/sEm5TrIKe64/photo.jpg?sz=128", "display_name": "capnahab", "link": "https://stackoverflow.com/users/11795964/capnahab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 58437860, "answer_count": 1, "score": 0, "last_activity_date": 1571333219, "creation_date": 1571257901, "last_edit_date": 1571330458, "question_id": 58421266, "link": "https://stackoverflow.com/questions/58421266/dropping-keeping-dataframe-columns", "title": "Dropping / Keeping Dataframe columns", "body": "<p>I have a dataframe imported from a csv file using Pandas read_csv. Its shape is 735, 36. I need to drop the last 33 columns - keeping the first 3. \nThe columns are <code>'code'</code>,<code>'proc'</code>, <code>'All procedures'</code></p>\n\n<p>I have tried all the suggestions <a href=\"https://stackoverflow.com/a/29319200/11795964\">here</a></p>\n\n<p>Whatever I do I get the following error: </p>\n\n<pre><code>TypeError: 'bool' object is not subscriptable\n</code></pre>\n\n<p>For example: </p>\n\n<pre class=\"lang-py prettyprint-override\"><code>df1=df[['code','proc', 'All procedures']]\n</code></pre>\n\n<pre><code>TypeError                                 Traceback (most recent call last)\n&lt;ipython-input-37-350994f9b7c6&gt; in &lt;module&gt;\n----&gt; 1 df[['code','proc', 'All procedures']]\n\nTypeError: 'bool' object is not subscriptable\n</code></pre>\n\n<p>I have started again. The \u2018bool object is not subscriptable\u2019 error has gone away, I  think df had been overwritten. </p>\n\n<p>I am  trying to use some publicly available data on hospital activity and extract data from it.I am a neurosurgeon so you may have to be patient. The data is here \n<a href=\"https://files.digital.nhs.uk/77/0C8B3F/hosp-epis-stat-admi-proc-2018-19-tab.xlsx\" rel=\"nofollow noreferrer\">https://files.digital.nhs.uk/77/0C8B3F/hosp-epis-stat-admi-proc-2018-19-tab.xlsx</a></p>\n\n<p>I want to extract the first three columns of the CSV in the code below, and output as excel. </p>\n\n<p>My new problem is that I can\u2019t extract the columns 'proc' and  \u2018All procedures\u2019.</p>\n\n<p>Here is my working</p>\n\n<pre><code>import matplotlib.pyplot as plt\nimport pandas as pd\nimport pygal\nimport os\nimport webbrowser\n</code></pre>\n\n<p>This imports one tab of the spreadsheet which I have converted to csv and renamed</p>\n\n<pre><code>df = pd.read_csv('neuro_spine_craino_just_all4.csv')\ndf.head(5) \n</code></pre>\n\n<pre><code>code    proc    All procedures  Main procedure  Male    Female  Gender Unknown  Mean age    Age 0   Age 1-4 ... Age 65-69   Age 70-74   Age 75-79   Age 80-84   Age 85-89   Age 90+ Day case    Emergency   Elective    Other\n</code></pre>\n\n<p>0   A01.1   Hemispherectomy 20  20  8   12  0   11.0    0   7   ... 0   0   0   0   0   0   0   0   0   0\n1   A01.2   Total lobectomy of brain    53  53  37  16  0   40.0    1   1   ... 4   4   1   0   0   0   0   1   0   0\n2   A01.3   Partial lobectomy of brain  174 148 95  79  0   41.0    1   5   ... 12  14  3   1   0   0   0   1   1   0\n3   A01.8   Other specified major excision of tissue of brain   20  15  12  8   0   34.0    1   0   ... 0   0   0   0   0   0   0   0   0   0\n4   A01.9   Unspecified major excision of tissue of brain   3   3   0   3   0   39.0    0   0   ... </p>\n\n<pre><code>df.info\n</code></pre>\n\n<p>\n      code                                             proc   All procedures<br>\n\\\n0    A01.1                                    Hemispherectomy             20<br>\n1    A01.2                           Total lobectomy of brain             53<br>\n2    A01.3                         Partial lobectomy of brain            174<br>\n3    A01.8  Other specified major excision of tissue of brain             20<br>\n4    A01.9      Unspecified major excision of tissue of brain              3   </p>\n\n<pre><code>df.columns\n</code></pre>\n\n<p>Index(['code', 'proc', 'All procedures', 'Main procedure', 'Male', 'Female',\n       'Gender Unknown', ' Mean age ', 'Age 0', 'Age 1-4', 'Age 5-9',\n       'Age 10-14', 'Age 15', 'Age 16', 'Age 17', 'Age 18', 'Age 19',\n       'Age 20-24', 'Age 25-29', 'Age 30-34', 'Age 35-39', 'Age 40-44',\n       'Age 45-49', 'Age 50-54', 'Age 55-59', 'Age 60-64', 'Age 65-69',\n       'Age 70-74', 'Age 75-79', 'Age 80-84', 'Age 85-89', 'Age 90+',\n       'Day case', 'Emergency', 'Elective', 'Other'],\n      dtype='object')</p>\n\n<pre><code>df['code'], ['proc'], ['All procedures']\n</code></pre>\n\n<p>This will only give me the first \ncolumn and index. </p>\n\n<p>(0      A01.1\n 1      A01.2\n 2      A01.3\n 3      A01.8\n 4      A01.9\n 5      A02.1\n 6      A02.2\n 7      A02.3\n 8      A02.4\n 9      A02.5\n 10     A02.6\n 11     A02.7\n 12     A02.8\n 13     A02.9\n 14     A03.1\n 15     A03.2\n 16     A03.3</p>\n"}, {"tags": ["python", "docker"], "comments": [{"owner": {"reputation": 38630, "user_id": 1324033, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/PaonW.png?s=128&g=1", "display_name": "Sayse", "link": "https://stackoverflow.com/users/1324033/sayse"}, "edited": false, "score": 0, "creation_date": 1571257957, "post_id": 58421206, "comment_id": 103184758, "body": "What is <code>SMTP_HOST</code> defined as?"}, {"owner": {"reputation": 35, "user_id": 4145952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b318ccec73db772177d3645bec00b1?s=128&d=identicon&r=PG&f=1", "display_name": "Cornwallace", "link": "https://stackoverflow.com/users/4145952/cornwallace"}, "reply_to_user": {"reputation": 38630, "user_id": 1324033, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/PaonW.png?s=128&g=1", "display_name": "Sayse", "link": "https://stackoverflow.com/users/1324033/sayse"}, "edited": false, "score": 0, "creation_date": 1571260846, "post_id": 58421206, "comment_id": 103185887, "body": "see edited post"}, {"owner": {"reputation": 38630, "user_id": 1324033, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/PaonW.png?s=128&g=1", "display_name": "Sayse", "link": "https://stackoverflow.com/users/1324033/sayse"}, "edited": false, "score": 0, "creation_date": 1571261111, "post_id": 58421206, "comment_id": 103185993, "body": "That would be in your docker-compose... are these included within your dockerfile too? (i.e <code>ENV SMTP_HOST ${SMTP_HOST}</code>)?"}, {"owner": {"reputation": 3667, "user_id": 6789321, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-B5oSDMyNAyc/AAAAAAAAAAI/AAAAAAAAT6s/i6ZRf_boOu4/photo.jpg?sz=128", "display_name": "accdias", "link": "https://stackoverflow.com/users/6789321/accdias"}, "edited": false, "score": 0, "creation_date": 1571261155, "post_id": 58421206, "comment_id": 103186011, "body": "Add an entry on <code>&#47;etc&#47;hosts</code> for <code>smtp.strato.de</code> inside the container. To debug it ping <code>smtp.strato.de</code> inside and outside the container."}, {"owner": {"reputation": 38630, "user_id": 1324033, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/PaonW.png?s=128&g=1", "display_name": "Sayse", "link": "https://stackoverflow.com/users/1324033/sayse"}, "edited": false, "score": 0, "creation_date": 1571261160, "post_id": 58421206, "comment_id": 103186012, "body": "Essentially I believe your error relates to incorrect values for the host or the port (possibly both if the above). Perhaps include a couple print statements or some other form of debugging to check their value within the container"}, {"owner": {"reputation": 38630, "user_id": 1324033, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/PaonW.png?s=128&g=1", "display_name": "Sayse", "link": "https://stackoverflow.com/users/1324033/sayse"}, "reply_to_user": {"reputation": 3667, "user_id": 6789321, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-B5oSDMyNAyc/AAAAAAAAAAI/AAAAAAAAT6s/i6ZRf_boOu4/photo.jpg?sz=128", "display_name": "accdias", "link": "https://stackoverflow.com/users/6789321/accdias"}, "edited": false, "score": 0, "creation_date": 1571261222, "post_id": 58421206, "comment_id": 103186034, "body": "@accdias - strato.de appears to be a german mail provider, it shouldn&#39;t need a host entry"}, {"owner": {"reputation": 3667, "user_id": 6789321, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-B5oSDMyNAyc/AAAAAAAAAAI/AAAAAAAAT6s/i6ZRf_boOu4/photo.jpg?sz=128", "display_name": "accdias", "link": "https://stackoverflow.com/users/6789321/accdias"}, "reply_to_user": {"reputation": 38630, "user_id": 1324033, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/PaonW.png?s=128&g=1", "display_name": "Sayse", "link": "https://stackoverflow.com/users/1324033/sayse"}, "edited": false, "score": 0, "creation_date": 1571261307, "post_id": 58421206, "comment_id": 103186076, "body": "@Sayse the error clearly is about name resolution. My suggestion is an workaround for a bad dns (<code>&#47;etc&#47;resolv.conf</code>) configuration inside the container."}, {"owner": {"reputation": 34972, "user_id": 3288890, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/sSQpx.jpg?s=128&g=1", "display_name": "Adiii", "link": "https://stackoverflow.com/users/3288890/adiii"}, "edited": false, "score": 0, "creation_date": 1571276224, "post_id": 58421206, "comment_id": 103189512, "body": "how you run the container? did you check <code>printenv</code> inside contianer? also update the code you are not consuming value-form env, <code>smtplib.SMTP(host= os.environ[&#39;SMTP_HOST&#39;], port=os.environ[&#39;SMTP_PORT&#39;])</code>"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4145952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b318ccec73db772177d3645bec00b1?s=128&d=identicon&r=PG&f=1", "display_name": "Cornwallace", "link": "https://stackoverflow.com/users/4145952/cornwallace"}, "edited": false, "score": 1, "creation_date": 1571335070, "post_id": 58425416, "comment_id": 103216450, "body": "you&#180;re somewhat right, I do have this already in my script, but, a simple print shows that the default values from the dockerfile were catched, but I really don&#39;t understand why."}, {"owner": {"reputation": 35, "user_id": 4145952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b318ccec73db772177d3645bec00b1?s=128&d=identicon&r=PG&f=1", "display_name": "Cornwallace", "link": "https://stackoverflow.com/users/4145952/cornwallace"}, "edited": false, "score": 2, "creation_date": 1571337079, "post_id": 58425416, "comment_id": 103217292, "body": "Solved. the spaces around the = sing in the docker-compose needed to be erased... no works great. thanks alot"}], "tags": [], "owner": {"reputation": 12305, "user_id": 8192635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcaf44c9ff9eeeb51fc78c816891d75a?s=128&d=identicon&r=PG&f=1", "display_name": "LinPy", "link": "https://stackoverflow.com/users/8192635/linpy"}, "is_accepted": true, "score": 1, "last_activity_date": 1571289790, "creation_date": 1571289790, "answer_id": 58425416, "question_id": 58421206, "link": "https://stackoverflow.com/questions/58421206/python-error-only-in-docker-environment-name-or-service-not-known/58425416#58425416", "title": "Python error only in docker environment (Name or service not known)", "body": "<p>the problem is that you do not get the values from the <code>ENV</code> you provide try this:</p>\n\n<pre><code>import os\nhost = os.environ['SMTP_HOST']\nport = os.environ['SMTP_PORT']\ns = smtplib.SMTP(host=host, port=port)\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4145952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b318ccec73db772177d3645bec00b1?s=128&d=identicon&r=PG&f=1", "display_name": "Cornwallace", "link": "https://stackoverflow.com/users/4145952/cornwallace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 618, "favorite_count": 1, "accepted_answer_id": 58425416, "answer_count": 1, "score": 3, "last_activity_date": 1571335352, "creation_date": 1571257537, "last_edit_date": 1571335352, "question_id": 58421206, "link": "https://stackoverflow.com/questions/58421206/python-error-only-in-docker-environment-name-or-service-not-known", "title": "Python error only in docker environment (Name or service not known)", "body": "<p>I've running a python script in a docker container, which should send me an email with its results.</p>\n\n<p>On the local machine without an docker environment it works, but in the container it gives me this:</p>\n\n<pre><code>grab_immo    | Traceback (most recent call last):\ngrab_immo    |   File \"./main.py\", line 236, in &lt;module&gt;\ngrab_immo    |     main()\ngrab_immo    |   File \"./main.py\", line 229, in main\ngrab_immo    |     sendmail(item['link'], item['price'], item['titel'], item['description'])\ngrab_immo    |   File \"./main.py\", line 76, in sendmail\ngrab_immo    |     s = smtplib.SMTP(host=SMTP_HOST, port=SMTP_PORT)\ngrab_immo    |   File \"/usr/local/lib/python3.7/smtplib.py\", line 251, in __init__\ngrab_immo    |     (code, msg) = self.connect(host, port)\ngrab_immo    |   File \"/usr/local/lib/python3.7/smtplib.py\", line 336, in connect\ngrab_immo    |     self.sock = self._get_socket(host, port, self.timeout)\ngrab_immo    |   File \"/usr/local/lib/python3.7/smtplib.py\", line 307, in _get_socket\ngrab_immo    |     self.source_address)\ngrab_immo    |   File \"/usr/local/lib/python3.7/socket.py\", line 707, in create_connection\ngrab_immo    |     for res in getaddrinfo(host, port, 0, SOCK_STREAM):\ngrab_immo    |   File \"/usr/local/lib/python3.7/socket.py\", line 748, in getaddrinfo\ngrab_immo    |     for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\ngrab_immo    | socket.gaierror: [Errno -2] Name or service not known\ngrab_immo exited with code 0\n</code></pre>\n\n<p>the part causing the error:</p>\n\n<pre><code>def sendmail(link, price, titel, description):\n    logger.info('Attempt to send mails with object %s', link)\n    names, emails = get_contacts(newPath + 'contacts') # read contacts\n    message_template = read_template(newPath + 'template')\n\n    # set up the SMTP server\n    s = smtplib.SMTP(host=SMTP_HOST, port=SMTP_PORT)\n    s.starttls()\n    s.login(MY_ADDRESS, PASSWORD)\n\n    # For each contact, send the email:\n    for name, email in zip(names, emails):\n        msg = MIMEMultipart()       # create a message\n\n        # add in the actual person name to the message template\n        message = message_template.substitute(PERSON_NAME=name.title(), LINK=link, PRICE=price, TITEL=titel, DESCRIPTION=description)\n\n        # setup the parameters of the message\n        msg['From']=MY_ADDRESS\n        msg['To']=email\n        msg['Subject']=\"yyy\"\n\n        # add in the message body\n        msg.attach(MIMEText(message, 'plain'))\n\n        # send the message via the server set up earlier.\n        s.send_message(msg)\n        del msg\n        logger.info('Mail sent to  %s', name)\n\n    # Terminate the SMTP session and close the connection\n    s.quit()\n</code></pre>\n\n<p>ENV part:</p>\n\n<pre><code>MY_ADDRESS = os.environ['MY_ADDRESS']\nPASSWORD = os.environ['PASSWORD']\nSMTP_HOST = os.environ['SMTP_HOST']\nSMTP_PORT = os.environ['SMTP_PORT']\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/58367480/dockerfile-added-files-wont-be-copied-to-volume\">I had another problem before, but I dont think it's related</a></p>\n\n<p>Thanks for reading!</p>\n\n<p>edit: docker-compose part</p>\n\n<pre><code>environment:\n    - MY_ADDRESS = yyy@yyy.com\n    - PASSWORD = yyy\n    - SMTP_HOST = smtp.strato.de\n    - SMTP_PORT = 587\n</code></pre>\n\n<p>taken from <a href=\"https://www.strato.de/faq/mail/so-lauten-die-strato-e-mail-server/\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>dockerfile:</p>\n\n<pre><code>FROM python:3\n\nCOPY grab_immo /grab_immo\n\nRUN mkdir /data\n\nADD ./data/contacts /data\nADD ./data/run.log /data\nADD ./data/template /data\n\nVOLUME /data\n\nWORKDIR /grab_immo\n\nRUN pip install -r requirements.txt\n\nENV MY_ADDRESS=value \\\n    PASSWORD=value \\\n    SMTP_HOST=value \\\n    SMTP_PORT=587\n\nCMD [ \"python\", \"./main.py\" ]\n</code></pre>\n\n<p>docker-compose.yml</p>\n\n<pre><code>---\nversion: \"2\"\nservices:\n  grab_immo:\n    build: .\n    image: yyy/grab_immo\n    container_name: grab_immo\n    environment:\n    - MY_ADDRESS = 'stuff'\n    - PASSWORD = stuff\n    - SMTP_HOST = smtp.strato.de\n    - SMTP_PORT = 587\n    volumes:\n      - /home/yyy/grab_immo_config:/data\n    restart: unless-stopped\n</code></pre>\n"}, {"tags": ["python", "tensorflow", "keras", "tensorflow2.0"], "comments": [{"owner": {"reputation": 14244, "user_id": 10133797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLiLn.png?s=128&g=1", "display_name": "OverLordGoldDragon", "link": "https://stackoverflow.com/users/10133797/overlordgolddragon"}, "edited": false, "score": 0, "creation_date": 1571262319, "post_id": 58421182, "comment_id": 103186381, "body": "There isn&#39;t an API-way (i.e. specifiable as arguments) to do it, but it can be done - one way involves modifying optimizer source code, namely the gradients, effectively freezing weights in place selectively. Is such a solution acceptable?"}], "answers": [{"comments": [{"owner": {"reputation": 14244, "user_id": 10133797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLiLn.png?s=128&g=1", "display_name": "OverLordGoldDragon", "link": "https://stackoverflow.com/users/10133797/overlordgolddragon"}, "edited": false, "score": 0, "creation_date": 1571265001, "post_id": 58422250, "comment_id": 103187159, "body": "What is <code>frozen_kernel</code> an attribute of, and how does it prevent gradients being applied to weights?"}, {"owner": {"reputation": 619, "user_id": 774331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9072fcd934b3f54c4c5658d93843fa?s=128&d=identicon&r=PG", "display_name": "simon", "link": "https://stackoverflow.com/users/774331/simon"}, "reply_to_user": {"reputation": 14244, "user_id": 10133797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLiLn.png?s=128&g=1", "display_name": "OverLordGoldDragon", "link": "https://stackoverflow.com/users/10133797/overlordgolddragon"}, "edited": false, "score": 0, "creation_date": 1571265211, "post_id": 58422250, "comment_id": 103187209, "body": "I meant implement that as a constant, or as a non-trainable variable so that it won&#39;t be changed during training. So than you get a structure for the kernel like m * k1 + (1-m) * k2 where m contains only 0&#39;s and 1&#39;s and where k1 is trainable and k2 is not."}, {"owner": {"reputation": 14244, "user_id": 10133797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLiLn.png?s=128&g=1", "display_name": "OverLordGoldDragon", "link": "https://stackoverflow.com/users/10133797/overlordgolddragon"}, "edited": false, "score": 0, "creation_date": 1571267322, "post_id": 58422250, "comment_id": 103187727, "body": "This approach would require a custom callback to  call <code>freeze_kernel</code>, involves overwriting weight matrices, which would slow down training. It may work, but the answer&#39;s incomplete to this end - regardless, OP&#39;s yet to reply in clarification"}, {"owner": {"reputation": 619, "user_id": 774331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9072fcd934b3f54c4c5658d93843fa?s=128&d=identicon&r=PG", "display_name": "simon", "link": "https://stackoverflow.com/users/774331/simon"}, "reply_to_user": {"reputation": 14244, "user_id": 10133797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLiLn.png?s=128&g=1", "display_name": "OverLordGoldDragon", "link": "https://stackoverflow.com/users/10133797/overlordgolddragon"}, "edited": false, "score": 0, "creation_date": 1571267649, "post_id": 58422250, "comment_id": 103187799, "body": "@OverLordGoldDragon OP says he wants to lock the weights after the training process, so no callback needed. But if you&#39;d want to freeze weights during training, a callback would indeed be necessary.   I&#39;m not sure how this would affect training speed. Matrices are only being overwritten when new weights are frozen which should presumably be a relatively uncommon event (or else you&#39;ll have a completely frozen layer in no time)."}, {"owner": {"reputation": 14244, "user_id": 10133797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLiLn.png?s=128&g=1", "display_name": "OverLordGoldDragon", "link": "https://stackoverflow.com/users/10133797/overlordgolddragon"}, "edited": false, "score": 0, "creation_date": 1571267838, "post_id": 58422250, "comment_id": 103187828, "body": "What&#39;s the point of freezing weights <i>after</i> training? They&#39;re already all &quot;frozen&quot;. In-training, I&#39;d see your approach working by updating the &quot;non-trainable&quot; copy of weights every iteration, so an overwrite would be involved. -- regarding frozen, feel free to clarify, maybe I&#39;m missing an application"}, {"owner": {"reputation": 619, "user_id": 774331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9072fcd934b3f54c4c5658d93843fa?s=128&d=identicon&r=PG", "display_name": "simon", "link": "https://stackoverflow.com/users/774331/simon"}, "reply_to_user": {"reputation": 14244, "user_id": 10133797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLiLn.png?s=128&g=1", "display_name": "OverLordGoldDragon", "link": "https://stackoverflow.com/users/10133797/overlordgolddragon"}, "edited": false, "score": 0, "creation_date": 1571267972, "post_id": 58422250, "comment_id": 103187869, "body": "Well OP posted this in the context of the lottery ticket hypothesis where you train a network, decide what channels you want to drop, and then train a pruned network with the same weights as the previous one had on initialisation."}, {"owner": {"reputation": 14244, "user_id": 10133797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLiLn.png?s=128&g=1", "display_name": "OverLordGoldDragon", "link": "https://stackoverflow.com/users/10133797/overlordgolddragon"}, "edited": false, "score": 0, "creation_date": 1571268287, "post_id": 58422250, "comment_id": 103187954, "body": "In that case, the problem concerns selectively saving existing weights, building a smaller network, and assigning those weights - correct? Masking, as I initially figured, and as your answer implements, is entirely irrelevant. If alternatively weights are to be dropped <i>without</i> remaking a model, then weights to be pruned are to be set to zero and then frozen - which <i>would</i> involve a mask approach (but former&#39;s preferable for performance - smaller model, faster training)"}, {"owner": {"reputation": 619, "user_id": 774331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9072fcd934b3f54c4c5658d93843fa?s=128&d=identicon&r=PG", "display_name": "simon", "link": "https://stackoverflow.com/users/774331/simon"}, "reply_to_user": {"reputation": 14244, "user_id": 10133797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLiLn.png?s=128&g=1", "display_name": "OverLordGoldDragon", "link": "https://stackoverflow.com/users/10133797/overlordgolddragon"}, "edited": false, "score": 0, "creation_date": 1571268686, "post_id": 58422250, "comment_id": 103188061, "body": "No, you use the initialisation weights of the original network, not the weights after training, for the initialisation of the weights in the pruned network. The reason I use masking is because you can&#39;t just drop units, since that&#39;s more like setting an entire row in a matrix to zero, whereas we might only want to set some of the elements in a row to zero (and keep them at zero)."}, {"owner": {"reputation": 14244, "user_id": 10133797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLiLn.png?s=128&g=1", "display_name": "OverLordGoldDragon", "link": "https://stackoverflow.com/users/10133797/overlordgolddragon"}, "edited": false, "score": 0, "creation_date": 1571269516, "post_id": 58422250, "comment_id": 103188224, "body": "What a strange technique - but if results back it, so be it. As you describe, however, wouldn&#39;t a callback still be involved to reset updated weights back to frozen?"}, {"owner": {"reputation": 619, "user_id": 774331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9072fcd934b3f54c4c5658d93843fa?s=128&d=identicon&r=PG", "display_name": "simon", "link": "https://stackoverflow.com/users/774331/simon"}, "reply_to_user": {"reputation": 14244, "user_id": 10133797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLiLn.png?s=128&g=1", "display_name": "OverLordGoldDragon", "link": "https://stackoverflow.com/users/10133797/overlordgolddragon"}, "edited": false, "score": 0, "creation_date": 1571269792, "post_id": 58422250, "comment_id": 103188289, "body": "That depends on how OP wants to implement those things. It could be done through a callback, but could also be done by using multiple training loops."}, {"owner": {"reputation": 25, "user_id": 12228795, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XRu5t.jpg?s=128&g=1", "display_name": "Ot&#225;vio Augusto Silva", "link": "https://stackoverflow.com/users/12228795/ot%c3%a1vio-augusto-silva"}, "edited": false, "score": 0, "creation_date": 1571272877, "post_id": 58422250, "comment_id": 103188891, "body": "@simon and OverLordGoldDragon, thank you for your answers, it was very helpful! I will try to use this in my code first trying to write my own custom layers as the example code, because my final goal is to apply the lottery ticket hypothesis to neural machine translation in a transfer learning context, so I will have to try and model this using LSTM and Embedding layers in an encoder-decoder architecture (I still don&#39;t know how to do this very well, but simon&#39;s code looks like a good starting point) and see how it goes. Thank you again for your answers."}, {"owner": {"reputation": 25, "user_id": 12228795, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XRu5t.jpg?s=128&g=1", "display_name": "Ot&#225;vio Augusto Silva", "link": "https://stackoverflow.com/users/12228795/ot%c3%a1vio-augusto-silva"}, "edited": false, "score": 1, "creation_date": 1572099656, "post_id": 58422250, "comment_id": 103459932, "body": "@simon I implemented your code <a href=\"https://github.com/luizhemelo/DeepLearningAlgorithms_FinalProject\" rel=\"nofollow noreferrer\">here</a> (your second edit) fixing just your kernel property that the parenthesis is on the wrong place, and it seems to be working alright, but i I&#39;m having a little trouble understanding what is the purpose of the variables <code>_kernel2</code> and <code>_bias2</code>, could you clarify a little more?"}, {"owner": {"reputation": 619, "user_id": 774331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9072fcd934b3f54c4c5658d93843fa?s=128&d=identicon&r=PG", "display_name": "simon", "link": "https://stackoverflow.com/users/774331/simon"}, "reply_to_user": {"reputation": 25, "user_id": 12228795, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XRu5t.jpg?s=128&g=1", "display_name": "Ot&#225;vio Augusto Silva", "link": "https://stackoverflow.com/users/12228795/ot%c3%a1vio-augusto-silva"}, "edited": false, "score": 0, "creation_date": 1572124889, "post_id": 58422250, "comment_id": 103465733, "body": "@Ot&#225;vioAugustoSilva I put some more explanation into edit 4."}], "tags": [], "owner": {"reputation": 619, "user_id": 774331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9072fcd934b3f54c4c5658d93843fa?s=128&d=identicon&r=PG", "display_name": "simon", "link": "https://stackoverflow.com/users/774331/simon"}, "is_accepted": true, "score": 2, "last_activity_date": 1572209209, "last_edit_date": 1572209209, "creation_date": 1571263372, "answer_id": 58422250, "question_id": 58421182, "link": "https://stackoverflow.com/questions/58421182/how-to-lock-specific-values-of-a-tensor-in-tensorflow/58422250#58422250", "title": "How to lock specific values of a Tensor in TensorFlow?", "body": "<p>Maybe you could subclass the Dense layer? Something like</p>\n\n<pre><code>class PrunableDense(keras.layers.Dense):\n\n\n    def __init__(self, *args, **kwargs):\n        super().__init__(*args, **kwargs)\n        self.deleted_channels = None\n        self.deleted_bias = None\n        self._kernel=None\n        self._bias=None\n\n\n    def build(self, input_shape):\n        last_dim = input_shape[-1]\n        self._kernel = self.add_weight(\n            'kernel',\n            shape=[last_dim, self.units],\n            initializer=self.kernel_initializer,\n            regularizer=self.kernel_regularizer,\n            constraint=self.kernel_constraint,\n            dtype=self.dtype,\n            trainable=True)\n        self.deleted_channels = tf.ones([last_dim, self.units]) # we'll use this to prune the network\n        if self.use_bias:\n            self._bias = self.add_weight(\n                'bias',\n                shape=[self.units,],\n                initializer=self.bias_initializer,\n                regularizer=self.bias_regularizer,\n                constraint=self.bias_constraint,\n                dtype=self.dtype,\n                trainable=True)\n            self.deleted_bias = tf.ones([self.units,])\n\n    @property\n    def kernel(self):\n        \"\"\"gets called whenever self.kernel is used\"\"\"\n        # only the weights that haven't been deleted should be non-zero\n        # deleted weights are 0.'s in self.deleted_channels\n        return self.deleted_channels * self._kernel  \n\n    @property\n    def bias(self):\n        #similar to kernel\n        if not self.use_bias:\n            return None\n        else:\n            return self.deleted_bias * self._bias\n\n    def prune_kernel(self, to_be_deleted):\n        \"\"\"\n        Delete some channels\n        to_be_deleted should be a tensor or numpy array of shape kernel.shape\n        containing 1's at the locations where weights should be kept, and 0's \n        at the locations where weights should be deleted.\n        \"\"\"\n        self.deleted_channels *= to_be_deleted\n\n    def prune_bias(self, to_be_deleted):\n        assert(self.use_bias)\n        self.deleted_bias *= to_be_deleted\n\n    def prune_kernel_below_threshold(self, threshold=0.01):\n        to_be_deleted = tf.cast(tf.greater(self.kernel, threshold), tf.float32)\n        self.deleted_channels *= to_be_deleted\n\n    def prune_bias_below_threshold(self, threshold=0.01):\n        assert(self.use_bias)\n        to_be_deleted = tf.cast(tf.greater(self.bias, threshold), tf.float32)\n        self.deleted_bias *= to_be_deleted\n</code></pre>\n\n<p>I haven't tested this too extensively, and it definitely needs some polishing but I think the idea should work.</p>\n\n<p>Edit: I wrote the above assuming you want to prune the network as in the lottery ticket hypothesis, but in case you want to just freeze part of the weights you could do something similar, but adding a frozen_kernel attribute with non-zero entries only on the places where self.deleted_channels is 0, and adding it to the trainable kernel.</p>\n\n<p>Edit 2: with the previous edit I meant something like the following:</p>\n\n<pre><code>class FreezableDense(keras.layers.Dense):\n\n\n    def __init__(self, *args, **kwargs):\n        super().__init__(*args, **kwargs)\n        self.trainable_channels = None\n        self.trainable_bias = None\n        self._kernel1 = None\n        self._bias1 = None\n        self._kernel2 = None\n        self._bias2 = None\n\n\n    def build(self, input_shape):\n        last_dim = input_shape[-1]\n        self._kernel1 = self.add_weight(\n            'kernel1',\n            shape=[last_dim, self.units],\n            initializer=self.kernel_initializer,\n            regularizer=self.kernel_regularizer,\n            constraint=self.kernel_constraint,\n            dtype=self.dtype,\n            trainable=True)\n        self._kernel2 = tf.zeros([last_dim, self.units])\n        self.trainable_channels = tf.ones([last_dim, self.units]) # we'll use this to freeze parts of the network\n        if self.use_bias:\n            self._bias1 = self.add_weight(\n                'bias',\n                shape=[self.units,],\n                initializer=self.bias_initializer,\n                regularizer=self.bias_regularizer,\n                constraint=self.bias_constraint,\n                dtype=self.dtype,\n                trainable=True)\n            self._bias2 = tf.zeros([self.units,])\n            self.trainable_bias = tf.ones([self.units,])\n\n    @property\n    def kernel(self):\n        \"\"\"gets called whenever self.kernel is used\"\"\"\n        # frozen \n        return self.trainable_channels * self._kernel1 + (1 - self.trainable_channels) * self._kernel2\n\n    @property\n    def bias(self):\n        #similar to kernel\n        if not self.use_bias:\n            return None\n        else:\n            return self.trainable_bias * self._bias1 + (1 - self.trainable_bias) * self._bias2\n\n    def freeze_kernel(self, to_be_frozen):\n        \"\"\"\n        freeze some channels\n        to_be_frozen should be a tensor or numpy array of shape kernel.shape\n        containing 1's at the locations where weights should be kept trainable, and 0's \n        at the locations where weights should be frozen.\n        \"\"\"\n        # we want to do two things: update the weights in self._kernel2 \n        # and update self.trainable_channels\n        # first we update self._kernel2 with all newly frozen weights\n        newly_frozen = 1 - tf.maximum((1 - to_be_frozen) - (1 - self.trainable_channels), 0)\n        # the above should have 0 only where to_be_frozen is 0 and self.trainable_channels is 1\n        # if I'm not mistaken that is\n        newly_frozen_weights = (1-newly_frozen)*self._kernel1\n        self._kernel2 += newly_frozen_weights\n\n        # now we update self.trainable_channels:\n        self.trainable_channels *= to_be_frozen\n\n    def prune_bias(self, to_be_deleted):\n        assert(self.use_bias)\n        newly_frozen = 1 - tf.maximum((1 - to_be_frozen) - (1 - self.trainable_bias), 0)\n        newly_frozen_bias = (1-newly_frozen)*self._bias1\n        self._bias2 += newly_frozen_bias\n        self.trainable_bias *= to_be_frozen\n\n</code></pre>\n\n<p>(Again not too elaborately tested and definitely needs some polishing but I think the idea should work)</p>\n\n<p>Edit 3:\nGoogling more got me what I initially couldn't find: <a href=\"https://www.tensorflow.org/model_optimization/api_docs/python/tfmot/sparsity/keras\" rel=\"nofollow noreferrer\">https://www.tensorflow.org/model_optimization/api_docs/python/tfmot/sparsity/keras</a> migth provide tools to more easily build a pruned model.</p>\n\n<p>Edit 4 (further explanation of the role of _kernel2 and _bias2):</p>\n\n<p>For simplicity I'll do the explanation for no bias, but mutatis mutandis everything works the same with bias. Suppose the input to your dense layer is n dimensional, and your output is m dimensional, then what a dense layer does is multiply the input by an m-by-n matrix, which we'll call K for short (it's the kernel). </p>\n\n<p>Usually we want to learn the right entries of K through some gradient based optimisation method, but in your case, you want to keep certain entries fixed. That's why in this custom Dense layer, we split K as follows:</p>\n\n<p>K = T * K1 + (1 - T) * K2, </p>\n\n<p>where </p>\n\n<ul>\n<li>T is an m-by-n matrix consisting of 0's and 1's,</li>\n<li>the asterisk denotes element wise multiplication</li>\n<li>1 is the m-by-n matrix with 1 for every entry</li>\n<li>K1 is an m-by-n matrix which can be learned</li>\n<li>K2 is an m-by-n matrix which is fixed (constant) during training.</li>\n</ul>\n\n<p>If we look at the entries of K, then K[i,j] = T[i,j]*K1[i,j] + (1-T[i,j])*K2[i,j] = K1[i,j] if T[i,j]==1 else K2[i,j]. Since in the latter case the value of K1[i,j] has no influence on the outcome of multiplication by K, its gradient is 0 and shouldn't change (and even if it does change due to numerical errors, that shouldn't have an effect on the value of K[i,j]). </p>\n\n<p>So essentially, the entries K[i,j] of K for which T[i,j]==0 are fixed (with value stored in K2), and those for which T[i,j]==1 can be trained.</p>\n"}], "owner": {"reputation": 25, "user_id": 12228795, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XRu5t.jpg?s=128&g=1", "display_name": "Ot&#225;vio Augusto Silva", "link": "https://stackoverflow.com/users/12228795/ot%c3%a1vio-augusto-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 405, "favorite_count": 0, "accepted_answer_id": 58422250, "answer_count": 1, "score": 2, "last_activity_date": 1572209209, "creation_date": 1571257453, "question_id": 58421182, "link": "https://stackoverflow.com/questions/58421182/how-to-lock-specific-values-of-a-tensor-in-tensorflow", "title": "How to lock specific values of a Tensor in TensorFlow?", "body": "<p>I'm trying to apply the lottery ticket hypothesis to a simple neural network written in TensorFlow 2.0 (using the Keras interface) as seen below:</p>\n\n<pre><code>net = models.Sequential()\nnet.add(layers.Dense(256, activation=\"softsign\", name=\"Dense0\", bias_initializer=\"ones\"))\nnet.add(layers.Dense(128, activation=\"softsign\", name=\"Dense1\", bias_initializer=\"ones\"))\nnet.add(layers.Dense(64, activation=\"softsign\", name=\"Dense2\", bias_initializer=\"ones\"))\nnet.add(layers.Dense(32, activation=\"softsign\", name=\"Dense3\", bias_initializer=\"ones\"))\nnet.add(layers.Dense(1, activation=\"tanh\", name=\"Output\", bias_initializer=\"ones\"))\n</code></pre>\n\n<p>And then I train my network using Adam optimizer and binary crossentropy loss:</p>\n\n<pre><code>net.compile(optimizer=optimizers.Adam(learning_rate=0.001),\n            loss=losses.BinaryCrossentropy(), metrics=[\"accuracy\"])\nnet.fit(x_train, y_train, epochs=10, batch_size=32, validation_data=(x_test, y_test))\n</code></pre>\n\n<p>After the training process, I want to lock specific weights in my network. The problem is, I can only lock a Tensor as non-trainable (as fas as I know) with <code>tensorflow.Variable(..., trainable=False)</code>, but by doing that I'm setting the entire node of my graph as non-trainable, and I want only specific edges. I can iterate over all Tensor instances of my network with the code below:</p>\n\n<pre><code>for i in range(len(net.layers)):\n    for j in range(net.layers[i].variables[0].shape[0]):\n        for k in range(net.layers[i].variables[0][j].shape[0]):\n            ...\n</code></pre>\n\n<p>But I don't know what to next. Does someone know a simple way I can do this?</p>\n"}, {"tags": ["python", "string", "list", "for-loop"], "comments": [{"owner": {"reputation": 43491, "user_id": 4001592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HWyjo.jpg?s=128&g=1", "display_name": "Dani Mesejo", "link": "https://stackoverflow.com/users/4001592/dani-mesejo"}, "edited": false, "score": 2, "creation_date": 1571257434, "post_id": 58421171, "comment_id": 103184528, "body": "Could you, please, add your code. From the output it seems that your are iterating over the string itself. Also please be more specific about your input, exactly what do you mean by <code>column of lists</code>?"}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 0, "creation_date": 1571257552, "post_id": 58421171, "comment_id": 103184590, "body": "We aren&#39;t sure what you mean.  The &quot;column of lists&quot; you posted is not legal Python syntax; <code>column</code> is not a built-in type."}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 0, "creation_date": 1571257569, "post_id": 58421171, "comment_id": 103184601, "body": "Welcome to StackOverflow. Please read and follow the posting guidelines in the help documentation, as suggested when you created this account. <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">Minimal, complete, verifiable example</a> applies here. We cannot effectively help you until you post your MCVE code and accurately specify the problem. We should be able to paste your posted code into a text file and reproduce the problem you specified."}, {"owner": {"reputation": 1375, "user_id": 9307263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/defcaa944843f58d4f4befbed4a9c77c?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Joseph", "link": "https://stackoverflow.com/users/9307263/brian-joseph"}, "edited": false, "score": 0, "creation_date": 1571257607, "post_id": 58421171, "comment_id": 103184616, "body": "Regardless of what code you&#39;ve written, you might want to look into <code>chain</code> from <a href=\"https://docs.python.org/2/library/itertools.html#itertools.chain\" rel=\"nofollow noreferrer\">itertools</a>."}, {"owner": {"reputation": 8368, "user_id": 4669778, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-Iz_f3T23jC4/AAAAAAAAAAI/AAAAAAAADVQ/_H_y2EUoF7c/photo.jpg?sz=128", "display_name": "Ofer Sadan", "link": "https://stackoverflow.com/users/4669778/ofer-sadan"}, "edited": false, "score": 0, "creation_date": 1571257615, "post_id": 58421171, "comment_id": 103184619, "body": "You basically have a 2D list to flatten, but my guess is that you&#39;re treating at as if it&#39;s 3D, causing the last iteration to be over the letters of the strings.  Without seeing your code, hard to know"}], "answers": [{"comments": [{"owner": {"reputation": 27625, "user_id": 32538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/u8ueG.png?s=128&g=1", "display_name": "Kirk Strauser", "link": "https://stackoverflow.com/users/32538/kirk-strauser"}, "edited": false, "score": 0, "creation_date": 1571259828, "post_id": 58421297, "comment_id": 103185546, "body": "You can write that inner loop like <code>new_list.extend(res)</code>."}], "tags": [], "owner": {"reputation": 47, "user_id": 9430938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f227db2c1c2335b055877f55b7a59166?s=128&d=identicon&r=PG&f=1", "display_name": "user9430938", "link": "https://stackoverflow.com/users/9430938/user9430938"}, "is_accepted": false, "score": 0, "last_activity_date": 1571298444, "last_edit_date": 1571298444, "creation_date": 1571258028, "answer_id": 58421297, "question_id": 58421171, "link": "https://stackoverflow.com/questions/58421171/how-to-use-for-loop-over-a-list-of-strings/58421297#58421297", "title": "How to use &quot;for&quot; loop over a list of strings?", "body": "<p>try something like this:</p>\n\n<pre><code> Restaurant_Type = [['Dessert Parlor', 'Quick Bites'], ['Casual Dining', 'Bar'], ['Casual Dining', 'Bar'],['Fine Dining'],['Casual Dining', 'Bar']]\n\n\n new_list = []\n for res in Restaurant_Type: \n     new_list.extend(res)\n print(new_list)\n</code></pre>\n\n<p>the output should be like this:</p>\n\n<pre><code>['Dessert Parlor', 'Quick Bites', 'Casual Dining', 'Bar', 'Casual Dining', 'Bar', 'Fine Dining', 'Casual Dining', 'Bar']\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 11321707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd5da0f3b1808b5f8ad44b222448c1d6?s=128&d=identicon&r=PG&f=1", "display_name": "Devesh", "link": "https://stackoverflow.com/users/11321707/devesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "closed_date": 1571260062, "answer_count": 1, "score": -2, "last_activity_date": 1571298444, "creation_date": 1571257410, "last_edit_date": 1571259349, "question_id": 58421171, "link": "https://stackoverflow.com/questions/58421171/how-to-use-for-loop-over-a-list-of-strings", "closed_reason": "Duplicate", "title": "How to use &quot;for&quot; loop over a list of strings?", "body": "<p>I have this list of lists named <code>Restaurant_Type</code>:</p>\n\n<pre><code>Restaurant_Type = [['Dessert Parlor', 'Quick Bites'],\n                   ['Casual Dining', 'Bar'],\n                   ['Casual Dining', 'Bar'],\n                   ['Fine Dining'],\n                   ['Casual Dining', 'Bar']]\n</code></pre>\n\n<p>of 180 rows. I want to loop through each list and enter every value in a new list. For example,</p>\n\n<pre><code>new_list = ['Dessert Parlor', 'Quick Bites', 'Casual Dining', 'Bar','Casual Dining',\n            'Bar',.....]\n</code></pre>\n\n<p>So that I can calculate the frequency of each restaurant type.</p>\n\n<p>I tried using for loop but I'm getting list of words like this,</p>\n\n<pre><code>  \"'\",\n  'D',\n  'e',\n  's',\n  's',\n  'e',\n  'r',\n  't',\n  ' ',\n  'P',\n  'a',\n  'r',\n  'l',\n  'o',\n  'r',\n  ...\n</code></pre>\n"}, {"tags": ["python", "python-3.x"], "comments": [{"owner": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 1, "creation_date": 1571257648, "post_id": 58421156, "comment_id": 103184634, "body": "Your <code>__next__</code> function returns a generator... it is a generator function. That&#39;s what you wrote it to do."}, {"owner": {"reputation": 21232, "user_id": 550094, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7CAou.jpg?s=128&g=1", "display_name": "Thierry Lathuille", "link": "https://stackoverflow.com/users/550094/thierry-lathuille"}, "edited": false, "score": 0, "creation_date": 1571257787, "post_id": 58421156, "comment_id": 103184695, "body": "Short answer: <code>return self.cur_ref, self.ref_arr</code> instead of <code>yield ...</code>, see the duplicate for more details."}], "owner": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 1, "closed_date": 1571257896, "answer_count": 0, "score": 0, "last_activity_date": 1571257388, "creation_date": 1571257333, "last_edit_date": 1571257388, "question_id": 58421156, "link": "https://stackoverflow.com/questions/58421156/generator-only-returns-the-next-value-if-next-is-called-explicitly", "closed_reason": "Duplicate", "title": "Generator only returns the next value if __next__() is called explicitly", "body": "<p>I have a class defined that holds the data necessary for its generator function, as well as the generator itself:</p>\n\n<pre><code>class LinkedEncs():\n    def __init__(self, ref_ids, all_encs, max_encs=3, data_len=7, front_trim=3):\n        self.ref_ids = ref_ids\n        self.all_encs = all_encs\n        self.max_encs = max_encs\n        self.data_len = data_len\n        self.front_trim = front_trim\n        self.ref_num = 0  \n        self.cur_ref = self.ref_ids[self.ref_num]\n\n    def __iter__(self):\n        return self\n\n    def __next__(self):\n        try:\n            self.cur_ref = self.ref_ids[self.ref_num]\n            self.ref_arr = np.hstack((np.zeros((365, 1)), np.empty((365, int(self.max_encs * self.data_len)), dtype=np.object)))\n            self.ref_num += 1\n            matched_rows = self.all_encs.loc[self.all_encs['ref_id'] == self.cur_ref]\n            for _, row in matched_rows.iterrows():\n                self.ref_arr[row['days_ago']][0] += 1\n                day_n = self.ref_arr[row['days_ago']][0]\n                col_shift = self.data_len * (day_n - 1) - 2\n                if self.ref_arr[row['days_ago']][0] &gt; self.max_encs:\n                    continue\n                for i in range(self.front_trim, self.front_trim + self.data_len):\n                    self.ref_arr[row['days_ago']][i + int(col_shift)] = row[i]    \n            self.ref_num += 1\n            yield self.cur_ref, self.ref_arr\n        except(IndexError):\n            print('end of list')\n</code></pre>\n\n<p>My understanding is that the correct way to load the data and get the generated values is to use <code>next()</code>, like this:</p>\n\n<pre><code>linked_enc_generator = LinkedEncs(ref_enc_ids, linked_encs)\n\nwhile True:\n    try:\n        print(next(linked_enc_generator))\n    except(StopIteration):\n        print('done')\n        break\n</code></pre>\n\n<p>But that doesn't work. Instead, it results in an infinite loop that returns <code>&lt;generator object LinkedEncs.__next__ at 0x0000019B9DB7C3C8&gt;</code> over and over.</p>\n\n<p>What <em>does</em> work is replacing <code>next(linked_enc_generator)</code> with an explicit call of <code>__next__()</code>:</p>\n\n<pre><code>while True:\n    try:\n        print(next(linked_enc_generator.__next__()))\n    except(StopIteration):\n        print('done')\n        break\n</code></pre>\n\n<p>Also, it doesn't seem to matter whether I have an <code>__iter__</code> function or not, which doesn't match my understanding either.</p>\n\n<p>What's going on here?</p>\n"}, {"tags": ["python", "pandas", "pandas-groupby", "fractions"], "comments": [{"owner": {"reputation": 114459, "user_id": 4238408, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RWkmO.jpg?s=128&g=1", "display_name": "Quang Hoang", "link": "https://stackoverflow.com/users/4238408/quang-hoang"}, "edited": false, "score": 1, "creation_date": 1571257491, "post_id": 58421080, "comment_id": 103184550, "body": "Please do not include your data as picture. Copy/Paste them in the question as text."}], "answers": [{"tags": [], "owner": {"reputation": 86481, "user_id": 2411802, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/RA92x.jpg?s=128&g=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/2411802/alexander"}, "is_accepted": true, "score": 1, "last_activity_date": 1571258922, "last_edit_date": 1571258922, "creation_date": 1571258239, "answer_id": 58421337, "question_id": 58421080, "link": "https://stackoverflow.com/questions/58421080/percent-of-total-cells-that-have-positive-values/58421337#58421337", "title": "Percent of total cells that have positive values", "body": "<pre><code># Sample data.\ndf = pd.DataFrame({\n    'RIC': ['RSG.AX'] * 12 + ['IBM'] * 2, \n    'Date': list(range(2007, 2019)) + list(range(2000, 2002)), \n    'FCF': [4.66, -2.36, -9.3, -5.7, 7.7, 1.2, -2.6, -2.4, -4.3, 1.1, 4.22, np.nan, 1, -2]\n})\n</code></pre>\n\n<p>Note that I chose to ignore <code>NaN</code> valuess rather than have the result become <code>NaN</code>.</p>\n\n<pre><code>df = df.sort_values(['RIC', 'Date']).reset_index(drop=True)\npct_profitable = df.groupby('RIC')['FCF'].transform(\n    lambda s: s.gt(0).cumsum() / s.notnull().cumsum())\n&gt;&gt;&gt; df.assign(pct_profitable=pct_profitable)\n       RIC  Date   FCF  pct_profitable\n0      IBM  2000  1.00        1.000000\n1      IBM  2001 -2.00        0.500000\n2   RSG.AX  2007  4.66        1.000000\n3   RSG.AX  2008 -2.36        0.500000\n4   RSG.AX  2009 -9.30        0.333333\n5   RSG.AX  2010 -5.70        0.250000\n6   RSG.AX  2011  7.70        0.400000\n7   RSG.AX  2012  1.20        0.500000\n8   RSG.AX  2013 -2.60        0.428571\n9   RSG.AX  2014 -2.40        0.375000\n10  RSG.AX  2015 -4.30        0.333333\n11  RSG.AX  2016  1.10        0.400000\n12  RSG.AX  2017  4.22        0.454545\n13  RSG.AX  2018   NaN        0.454545\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 12132087, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RtrME.jpg?s=128&g=1", "display_name": "nlieb7", "link": "https://stackoverflow.com/users/12132087/nlieb7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 58421337, "answer_count": 1, "score": 0, "last_activity_date": 1571258922, "creation_date": 1571256938, "question_id": 58421080, "link": "https://stackoverflow.com/questions/58421080/percent-of-total-cells-that-have-positive-values", "title": "Percent of total cells that have positive values", "body": "<p>I am looking to calculate the percent of years a company has had positive earnings. My dataframe has thousands of companies, and so I am trying to figure out how to isolate each company to perform this calculation.</p>\n\n<p><a href=\"https://i.stack.imgur.com/DlbgU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DlbgU.png\" alt=\"Sample Data\"></a></p>\n\n<p>Using the sample data of one company above and assuming RSG.AX was founded in 2007, I want the resulting column to read:</p>\n\n<pre><code>             percentPositiveEarnings\n(NaN/12) =   NaN\n(5/11)   =   0.45\n(4/10)   =   0.4\n(3/9)    =   0.33\n(3/8)    =   0.375\n(3/7)    =   0.429\n(3/6)    =   0.5\n(2/5)    =   0.4\n(1/4)    =   0.25\n(1/3)    =   0.33\n(1/2)    =   0.5\n(1/1)    =   1\n</code></pre>\n\n<p>Each cell in this column should calculate the number of years the company has had positive earnings divided by the total number of years since it was founded.</p>\n\n<p>I am not sure if I have to use <code>.groupby()</code> to separate each company's data, as I have never used it before. Any help is appreciated!</p>\n"}, {"tags": ["python", "pandas"], "answers": [{"tags": [], "owner": {"reputation": 10088, "user_id": 21028, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/996a5828870fa84ad3a597f7935a9a5e?s=128&d=identicon&r=PG", "display_name": "csl", "link": "https://stackoverflow.com/users/21028/csl"}, "is_accepted": false, "score": 0, "last_activity_date": 1571258594, "creation_date": 1571258594, "answer_id": 58421426, "question_id": 58421078, "link": "https://stackoverflow.com/questions/58421078/unicodedecodeerror-utf-8-codec-cant-decode-byte-0xc9-in-position-388-invali/58421426#58421426", "title": "UnicodeDecodeError: &#39;utf-8&#39; codec can&#39;t decode byte 0xc9 in position 388: invalid continuation byte", "body": "<p>Figure out what encoding the CSV file uses. Seems it doesn't use UTF-8. Say it's latin1, then you can try with <code>read_csv(..., encoding=\"latin1\")</code>.</p>\n\n<p>If you are on a UNIX system, you can use the <code>file</code> command to try to detect the encoding.</p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 12228862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fe1a6c235c27ac77ec78ed3ff06b812?s=128&d=identicon&r=PG&f=1", "display_name": "costas", "link": "https://stackoverflow.com/users/12228862/costas"}, "is_accepted": false, "score": 0, "last_activity_date": 1571263193, "creation_date": 1571263193, "answer_id": 58422219, "question_id": 58421078, "link": "https://stackoverflow.com/questions/58421078/unicodedecodeerror-utf-8-codec-cant-decode-byte-0xc9-in-position-388-invali/58422219#58422219", "title": "UnicodeDecodeError: &#39;utf-8&#39; codec can&#39;t decode byte 0xc9 in position 388: invalid continuation byte", "body": "<p>I found that I had to add :encoding='cp1252'\nbut thank you for your time </p>\n"}], "owner": {"reputation": 43, "user_id": 12228862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fe1a6c235c27ac77ec78ed3ff06b812?s=128&d=identicon&r=PG&f=1", "display_name": "costas", "link": "https://stackoverflow.com/users/12228862/costas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1290, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1571263193, "creation_date": 1571256937, "last_edit_date": 1571258412, "question_id": 58421078, "link": "https://stackoverflow.com/questions/58421078/unicodedecodeerror-utf-8-codec-cant-decode-byte-0xc9-in-position-388-invali", "title": "UnicodeDecodeError: &#39;utf-8&#39; codec can&#39;t decode byte 0xc9 in position 388: invalid continuation byte", "body": "<p>I am really beginning at python, but I am hours in this line, can't go anywhere without fixing it. </p>\n\n<pre><code>cadastro_2019_10= pd.read_csv(\"inf_cadastral_fi_20191015.csv\",delimiter=\";\")[[\"CNPJ_FUNDO\",\"DENOM_SOCIAL\",\"CLASSE\"]]\n</code></pre>\n\n<blockquote>\n  <p>UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 49: invalid continuation byte</p>\n</blockquote>\n\n<pre><code>cadastro_2019_10= pd.read_csv(\"inf_cadastral_fi_20191015.csv\",delimiter=\";\")[[\"CNPJ_FUNDO\",\"DENOM_SOCIAL\",\"CLASSE\"]]\n</code></pre>\n\n<p>again: </p>\n\n<blockquote>\n  <p>UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 388: invalid continuation byte</p>\n</blockquote>\n"}, {"tags": ["python", "python-2.6"], "comments": [{"owner": {"reputation": 1937, "user_id": 8397835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34f4c7ffe73a543d514724899d4518d?s=128&d=identicon&r=PG&f=1", "display_name": "Cataster", "link": "https://stackoverflow.com/users/8397835/cataster"}, "edited": false, "score": 0, "creation_date": 1572756026, "post_id": 58421043, "comment_id": 103655637, "body": "so although i havent figured out yet how i can get the traceback, the issue apparently was that the subporcess call was expecting an argument to be passed along. also, we ran into the nonetype issue in another script and the solution apparently was we needed to add python script1...to the subprocess call. the python part was the solution. weird how it is not required in other subprocess calls we made."}], "owner": {"reputation": 1937, "user_id": 8397835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34f4c7ffe73a543d514724899d4518d?s=128&d=identicon&r=PG&f=1", "display_name": "Cataster", "link": "https://stackoverflow.com/users/8397835/cataster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1571256808, "creation_date": 1571256808, "question_id": 58421043, "link": "https://stackoverflow.com/questions/58421043/how-to-get-a-traceback-from-a-subprocess-calling-another-script", "title": "How to get a traceback from a subprocess calling another script?", "body": "<p>suppose i have <code>script1.py</code> and <code>script2.py</code></p>\n\n<p>i am calling script1.py inside <code>script2.py</code> using <code>subprocess.call()</code></p>\n\n<pre><code>import subprocess\n\ndef refresh_groups(app, scenario, refresh_mode, refresh_file):\n              try:\n                             subprocess.call('script1.py',shell=True)\n              except Exception, e:\n                             raise Exception('ERROR - [' + str(e) + '] - Failed to refresh groups.')\n</code></pre>\n\n<p>both scripts work just fine standalone. however, i have a need to use the subprocess call but i get an error:</p>\n\n<pre><code>Error reported from main():\n'NoneType' object is not iterable\n</code></pre>\n\n<p>I am not sure if that error is from script1 or script2. I think a traceback would REALLY help me debug whats going on, hence why im looking for detailed stacktrace. </p>\n\n<p>I looked into Popen but tat didnt help. </p>\n"}, {"tags": ["python", "string", "control-characters"], "comments": [{"owner": {"reputation": 15430, "user_id": 4518341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eVuAv.png?s=128&g=1", "display_name": "wjandrea", "link": "https://stackoverflow.com/users/4518341/wjandrea"}, "edited": false, "score": 0, "creation_date": 1571257045, "post_id": 58421027, "comment_id": 103184348, "body": "For reference, <code>\\x0b</code> is Unicode U+B &quot;Line Tabulation&quot; AKA &quot;vertical tab&quot;, and <code>\\x0c</code> is U+C &quot;Form Feed&quot;."}, {"owner": {"reputation": 15430, "user_id": 4518341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eVuAv.png?s=128&g=1", "display_name": "wjandrea", "link": "https://stackoverflow.com/users/4518341/wjandrea"}, "edited": false, "score": 0, "creation_date": 1571257362, "post_id": 58421027, "comment_id": 103184504, "body": "Correction, Line Tabulation is ^K and Form Feed is ^L"}], "answers": [{"tags": [], "owner": {"reputation": 4102, "user_id": 10366273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1c2BX.jpg?s=128&g=1", "display_name": "MyNameIsCaleb", "link": "https://stackoverflow.com/users/10366273/mynameiscaleb"}, "is_accepted": false, "score": 4, "last_activity_date": 1571257526, "last_edit_date": 1571257526, "creation_date": 1571257092, "answer_id": 58421115, "question_id": 58421027, "link": "https://stackoverflow.com/questions/58421027/what-is-the-use-for-control-characters-in-string-printable/58421115#58421115", "title": "What is the use for control characters in string.printable?", "body": "<p>These are types of whitespace characters:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>&gt;&gt;&gt; string.whitespace\n' \\t\\n\\r\\x0b\\x0c'\n</code></pre>\n\n<p>From the <a href=\"https://docs.python.org/3.8/library/string.html#string.whitespace\" rel=\"nofollow noreferrer\">docs</a>:</p>\n\n<blockquote>\n  <p>A string containing all ASCII characters that are considered whitespace. This includes the characters space, tab, linefeed, return, formfeed, and vertical tab.</p>\n</blockquote>\n\n<p>We know this by following the <a href=\"https://docs.python.org/3.8/library/string.html#string.printable\" rel=\"nofollow noreferrer\">docs</a> for printable:</p>\n\n<blockquote>\n  <p>String of ASCII characters which are considered printable. This is a combination of digits, ascii_letters, punctuation, and <strong>whitespace</strong>.</p>\n</blockquote>\n\n<p>And we know what these whitespace characters are by referencing <a href=\"https://en.wikipedia.org/wiki/Control_character\" rel=\"nofollow noreferrer\">unicode control characters</a>:<br>\n<code>\\x0b</code> is a <a href=\"https://en.wikipedia.org/wiki/Tab_key#Tab_characters\" rel=\"nofollow noreferrer\">vertical tab</a><br>\n<code>\\x0c</code> is a <a href=\"https://en.wikipedia.org/wiki/Page_break#Form_feed\" rel=\"nofollow noreferrer\">form feed</a></p>\n"}, {"tags": [], "owner": {"reputation": 38630, "user_id": 1324033, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/PaonW.png?s=128&g=1", "display_name": "Sayse", "link": "https://stackoverflow.com/users/1324033/sayse"}, "is_accepted": false, "score": 0, "last_activity_date": 1571257155, "creation_date": 1571257155, "answer_id": 58421124, "question_id": 58421027, "link": "https://stackoverflow.com/questions/58421027/what-is-the-use-for-control-characters-in-string-printable/58421124#58421124", "title": "What is the use for control characters in string.printable?", "body": "<p>From the docs for <a href=\"https://docs.python.org/2/library/string.html#string.printable\" rel=\"nofollow noreferrer\">string.printable</a></p>\n\n<blockquote>\n  <p>String of characters which are considered printable. This is a combination of digits, letters, punctuation, and whitespace.</p>\n</blockquote>\n\n<p>where whitespace is defined as</p>\n\n<blockquote>\n  <p>A string containing all characters that are considered whitespace. On most systems this includes the characters space, tab, linefeed, return, formfeed, and vertical tab.</p>\n</blockquote>\n\n<p>These are whitespace characters.</p>\n"}, {"tags": [], "owner": {"reputation": 3877, "user_id": 7732200, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/xOslk.jpg?s=128&g=1", "display_name": "Oleh Rybalchenko", "link": "https://stackoverflow.com/users/7732200/oleh-rybalchenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1571257589, "last_edit_date": 1571257589, "creation_date": 1571257194, "answer_id": 58421132, "question_id": 58421027, "link": "https://stackoverflow.com/questions/58421027/what-is-the-use-for-control-characters-in-string-printable/58421132#58421132", "title": "What is the use for control characters in string.printable?", "body": "<p>Those symbols are printable whitespaces (can also be obtained by <code>string.whitespace</code>). <code>\\x0b</code> or <code>\\v</code> is vertical tab and <code>\\x0c</code> (<code>\\f</code>) which is form feed (<a href=\"https://docs.python.org/3/library/string.html#string.whitespace\" rel=\"nofollow noreferrer\">docs</a>).</p>\n\n<p>In various terminals the representation can be different, but usually <code>\\v</code> looks like following:</p>\n\n<pre><code>&gt;&gt;&gt; print(\"some\\vtext\\vhere\")\nsome\n    text\n        here\n</code></pre>\n\n<p><code>\\f</code> forces the printer to eject the current page and to continue printing at the top of another. In terminal often displays as an empty line. Sometimes can be used to clear the screen.</p>\n\n<p>That's why these symbols are considered as printable. However, representation and behavior may be quite different</p>\n"}, {"tags": [], "owner": {"reputation": 2416, "user_id": 12188799, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-x2Us7lDjK_k/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbvJBo6jnFH2eAReBMTWM_XkFHSw/photo.jpg?sz=128", "display_name": "Javier Silva Ort&#237;z", "link": "https://stackoverflow.com/users/12188799/javier-silva-ort%c3%adz"}, "is_accepted": false, "score": 0, "last_activity_date": 1571257360, "creation_date": 1571257360, "answer_id": 58421162, "question_id": 58421027, "link": "https://stackoverflow.com/questions/58421027/what-is-the-use-for-control-characters-in-string-printable/58421162#58421162", "title": "What is the use for control characters in string.printable?", "body": "<p>Those characters belong to the family of <code>whitespace</code> characters (you can check <code>&gt;&gt;&gt; string.whitespace</code> and <a href=\"https://docs.python.org/3.8/library/string.html#string.whitespace\" rel=\"nofollow noreferrer\">python documentation</a> for it). Specifically, \\x0b is Unicode U+B for \"Line Tabulation\" and the \\x0c is Unicode U+C for \"Form Feed\".</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 7, "last_activity_date": 1571258233, "creation_date": 1571258233, "answer_id": 58421336, "question_id": 58421027, "link": "https://stackoverflow.com/questions/58421027/what-is-the-use-for-control-characters-in-string-printable/58421336#58421336", "title": "What is the use for control characters in string.printable?", "body": "<p><code>\\x0b</code> is the U+000B, LINE TABULATION, and <code>\\x0c</code> is U+000C, FORM FEED (FF).</p>\n\n<p>Great. What does that mean, and why are they considered printable?</p>\n\n<p>Back in the days of teletypes, ASCII provided these characters for advancing a sheet of paper through the printer. The line tabulation character was to a line feed like a horizontal tab was to a space. The printer could have a set of defined vertical tab stops, and a line tabulation character would be interpreted as a request to advance to the next one following the current line.</p>\n\n<p>A form feed would advance to the top of the next page, however the device defined a page. (If it used a continuous paper feed, a \"page\" would be considered, say, 66 lines, and if you were currently on line 60, a form feed would simply advance 7 lines, to line 1 of the next page.)</p>\n\n<p>On a modern terminal emulator, they tend not to have any particular meaning. Simple tests indicate that on an <code>xterm</code>, they both appear to be treated the same as a line feed followed by a space:</p>\n\n<pre><code>&gt;&gt;&gt; print(\"x\\x0cy\")\nx\n y\n&gt;&gt;&gt; print(\"x\\x0by\")\nx\n y\n&gt;&gt;&gt;\n</code></pre>\n\n<p>Update: after seeing <a href=\"https://stackoverflow.com/a/58421132/1126841\">https://stackoverflow.com/a/58421132/1126841</a>, it would appear isn't not just a space following the line feed, but rather a line feed <em>not</em> followed by a carriage return, i.e., the cursor advances one line without returning to the beginning of that line; compare with <code>print(\"\\n\")</code>, which advances to the beginning of the next line, regardless of where the cursor currently is. (That makes more sense, and I should have remembered that.)</p>\n"}], "owner": {"reputation": 109, "user_id": 12228741, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XiOGZtDlgMk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf21aGJ3y___QTAgvWbJygqj6xkaQ/photo.jpg?sz=128", "display_name": "Richard Haley", "link": "https://stackoverflow.com/users/12228741/richard-haley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 936, "favorite_count": 3, "answer_count": 5, "score": 9, "last_activity_date": 1571396018, "creation_date": 1571256730, "last_edit_date": 1571396018, "question_id": 58421027, "link": "https://stackoverflow.com/questions/58421027/what-is-the-use-for-control-characters-in-string-printable", "title": "What is the use for control characters in string.printable?", "body": "<p>I was learning about the format mini-language and I scrolled up to view some string things, and I wondered what Python considered <em>printable</em>, so I checked: </p>\n\n<pre><code>&gt;&gt;&gt; string.printable\n'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!\"#$%&amp;\\'()*+,-./:;&lt;=&gt;?@[\\\\]^_`{|}~ \\t\\n\\r\\x0b\\x0c'\n</code></pre>\n\n<p>Note at the end, along with other normal printable control-type characters like ^I, ^J, and ^M, there's also ^B and ^C.</p>\n\n<p>What would be the use for these?</p>\n"}, {"tags": ["python", "pygame"], "comments": [{"owner": {"reputation": 2070, "user_id": 1044698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KWnHV.png?s=128&g=1", "display_name": "Energya", "link": "https://stackoverflow.com/users/1044698/energya"}, "edited": false, "score": 1, "creation_date": 1571257601, "post_id": 58421021, "comment_id": 103184614, "body": "Can you try to reduce your code to a minimum working example of your error? This is too long for me to want to search where you&#39;re removing your <code>projectile</code> from your <code>bullets</code> list"}, {"owner": {"reputation": 31, "user_id": 12217451, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCxvqeRv2rNfXJ_1JbZDI-th-BzNgraOiHwj4ht=k-s128", "display_name": "Jacob Elzingacheng", "link": "https://stackoverflow.com/users/12217451/jacob-elzingacheng"}, "reply_to_user": {"reputation": 2070, "user_id": 1044698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KWnHV.png?s=128&g=1", "display_name": "Energya", "link": "https://stackoverflow.com/users/1044698/energya"}, "edited": false, "score": 0, "creation_date": 1571312773, "post_id": 58421021, "comment_id": 103204265, "body": "im very sorry, i don&#39;t know really how to do that, im an extremely new programmer"}, {"owner": {"reputation": 31, "user_id": 12217451, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCxvqeRv2rNfXJ_1JbZDI-th-BzNgraOiHwj4ht=k-s128", "display_name": "Jacob Elzingacheng", "link": "https://stackoverflow.com/users/12217451/jacob-elzingacheng"}, "reply_to_user": {"reputation": 2070, "user_id": 1044698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KWnHV.png?s=128&g=1", "display_name": "Energya", "link": "https://stackoverflow.com/users/1044698/energya"}, "edited": false, "score": 0, "creation_date": 1571313650, "post_id": 58421021, "comment_id": 103204768, "body": "never mind i figured it out, thx for answering"}], "owner": {"reputation": 31, "user_id": 12217451, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCxvqeRv2rNfXJ_1JbZDI-th-BzNgraOiHwj4ht=k-s128", "display_name": "Jacob Elzingacheng", "link": "https://stackoverflow.com/users/12217451/jacob-elzingacheng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571256716, "creation_date": 1571256716, "question_id": 58421021, "link": "https://stackoverflow.com/questions/58421021/in-the-second-stage-i-get-an-error-when-i-hit-the-enemy", "title": "In the second stage i get an error when i hit the enemy", "body": "<p>(Please note that i am an extremely new programmer so please explain everything you do in depth)\nso whats happening is that on the first stage the bullets can hit the goblin normally but once i get to stage two and the bullet hits the goblin i get an error that says:</p>\n\n<pre><code> Traceback (most recent call last):\n  File \"C:\\Users\\jacob\\Desktop\\Game\\something.py\", line 220, in &lt;module&gt;\nbullets.pop(bullets.index(bullet))\nValueError: &lt;__main__.projectile object at 0x06D0DBD0&gt; is not in list\n</code></pre>\n\n<p>here is my code(note the indents are wrong):</p>\n\n<pre><code>import pygame\nimport random\npygame.init()\n\nwin = pygame.display.set_mode((500,480))\n\npygame.display.set_caption(\"First Game\")\n\nwalkRight = [pygame.image.load('R1.png'), pygame.image.load('R2.png'), pygame.image.load('R3.png'), \npygame.image.load('R4.png'), pygame.image.load('R5.png'), pygame.image.load('R6.png'), \npygame.image.load('R7.png'), pygame.image.load('R8.png'), pygame.image.load('R9.png')]\nwalkLeft = [pygame.image.load('L1.png'), pygame.image.load('L2.png'), pygame.image.load('L3.png'), \npygame.image.load('L4.png'), pygame.image.load('L5.png'), pygame.image.load('L6.png'), \npygame.image.load('L7.png'), pygame.image.load('L8.png'), pygame.image.load('L9.png')]\nbg = pygame.image.load('bg.jpg')\nchar = pygame.image.load('standing.png')\n\nclock = pygame.time.Clock()\n\nbulletSound = pygame.mixer.Sound('bullet.wav')\nhitSound = pygame.mixer.Sound('hit.wav')\nstage = 1\nprintStage = True\nmusic = pygame.mixer.music.load('music.mp3')\npygame.mixer.music.play(-1)\ngoblinAlive = True\nscore = 0\n\n\n\nclass player(object):\ndef __init__(self,x,y,width,height):\n    self.x = x\n    self.y = y\n    self.width = width\n    self.height = height\n    self.vel = 5\n    self.isJump = False\n    self.left = False\n    self.right = False\n    self.walkCount = 0\n    self.jumpCount = 10\n    self.standing = True\n    self.hitbox = (self.x + 17, self.y + 11, 29, 52)\n\ndef draw(self, win):\n    if self.walkCount + 1 &gt;= 27:\n        self.walkCount = 0\n\n    if not(self.standing):\n        if self.left:\n            win.blit(walkLeft[self.walkCount//3], (self.x,self.y))\n            self.walkCount += 1\n        elif self.right:\n            win.blit(walkRight[self.walkCount//3], (self.x,self.y))\n            self.walkCount +=1\n    else:\n        if self.right:\n            win.blit(walkRight[0], (self.x, self.y))\n        else:\n            win.blit(walkLeft[0], (self.x, self.y))\n    self.hitbox = (self.x + 17, self.y + 11, 29, 52)\n    #pygame.draw.rect(win, (255,0,0), self.hitbox,2)\n\ndef hit(self):\n    self.x = 60\n    self.y = 410\n    self.walkCount = 0\n    font1 = pygame.font.SysFont('comicsans', 100)\n    text = font1.render('-5', 1, (255,0,0))\n    win.blit(text, (250 - (text.get_width()/2),200))\n    pygame.display.update()\n    i = 0\n    while i &lt; 200:\n        pygame.time.delay(10)\n        i += 1\n        for event in pygame.event.get():\n            if event.type == pygame.QUIT:\n                i = 201\n                pygame.quit()\n\n\n\nclass projectile(object):\ndef __init__(self,x,y,radius,color,facing):\n    self.x = x\n    self.y = y\n    self.radius = radius\n    self.color = color\n    self.facing = facing\n    self.vel = 8 * facing\n\ndef draw(self,win):\n    pygame.draw.circle(win, self.color, (self.x,self.y), self.radius)\n\n\nclass enemy(object):\nwalkRight = [pygame.image.load('R1E.png'), pygame.image.load('R2E.png'), \npygame.image.load('R3E.png'), pygame.image.load('R4E.png'), pygame.image.load('R5E.png'), \npygame.image.load('R6E.png'), pygame.image.load('R7E.png'), pygame.image.load('R8E.png'), \npygame.image.load('R9E.png'), pygame.image.load('R10E.png'), pygame.image.load('R11E.png')]\nwalkLeft = [pygame.image.load('L1E.png'), pygame.image.load('L2E.png'), \n pygame.image.load('L3E.png'), pygame.image.load('L4E.png'), pygame.image.load('L5E.png'), \npygame.image.load('L6E.png'), pygame.image.load('L7E.png'), pygame.image.load('L8E.png'), \npygame.image.load('L9E.png'), pygame.image.load('L10E.png'), pygame.image.load('L11E.png')]\n\ndef __init__(self, x, y, width, height, end):\n    self.x = x\n    self.y = y\n    self.width = width\n    self.height = height\n    self.end = end\n    self.path = [self.x, self.end]\n    self.walkCount = 0\n    self.vel = 3\n    self.hitbox = (self.x + 17, self.y + 2, 31, 57)\n    self.health = 10\n    self.visible = True\n\ndef draw(self,win):\n    self.move()\n    if self.visible:\n        if self.walkCount + 1 &gt;= 33:\n            self.walkCount = 0\n\n        if self.vel &gt; 0:\n            win.blit(self.walkRight[self.walkCount //3], (self.x, self.y))\n            self.walkCount += 1\n        else:\n            win.blit(self.walkLeft[self.walkCount //3], (self.x, self.y))\n            self.walkCount += 1\n\n        pygame.draw.rect(win, (255,0,0), (self.hitbox[0], self.hitbox[1] - 20, 50, 10))\n        pygame.draw.rect(win, (0,128,0), (self.hitbox[0], self.hitbox[1] - 20, 50 - (5 * (10 - self.health)), 10))\n        self.hitbox = (self.x + 17, self.y + 2, 31, 57)\n        #pygame.draw.rect(win, (255,0,0), self.hitbox,2)\n\ndef move(self):\n    if self.vel &gt; 0:\n        if self.x + self.vel &lt; self.path[1]:\n            self.x += self.vel\n        else:\n            self.vel = self.vel * -1\n            self.walkCount = 0\n    else:\n        if self.x - self.vel &gt; self.path[0] - y:\n            self.x += self.vel\n        else:\n            self.vel = self.vel * -1\n            self.walkCount = 0\n\ndef hit(self):\n    for goblin in goblins:\n        if self.health &gt; 0:\n            self.health -= 1\n        else:\n            self.visible = False\n        print('hit')\n\n\n\ndef redrawGameWindow():\nwin.blit(bg, (0,0))\ntext = font.render('You Are On Stage: ' + str(stage), 1, (0,0,0))\nwin.blit(text, (10, 10))\ntext = font.render('Score: ' + str(score), 1, (0,0,0))\nwin.blit(text, (370, 10))\nman.draw(win)\nfor goblin in goblins:\n    goblin.draw(win)\n\nfor bullet in bullets:\n    bullet.draw(win)\n\npygame.display.update()\n\n\n\n\n\n\n#mainloop\nfont = pygame.font.SysFont('comicsans', 30, True)\nprintStageFont = pygame.font.SysFont('comicsans', 20, True)\nman = player(30, 410, 64,64)\ngoblin = enemy(random.randint(100, 200), 410, 64, 64, random.randint(201, 490))\nshootLoop = 0\ngoblins = []\nbullets = []\nrun = True\nwhile run:\nclock.tick(27)\n\nif man.y &gt; 410:\n    man.y = 410\n\n\nwhile (len(goblins)) &lt; stage:\n    y = random.randint(100,200)\n    goblins.append( enemy(y, 410, 64, 64, random.randint(201,490)) )\n\nfor goblin in goblins:                   \n    if goblin.visible:\n        if man.hitbox[1] &lt; goblin.hitbox[1] + goblin.hitbox[3] and man.hitbox[1] + man.hitbox[3] &gt; goblin.hitbox[1]:\n            if man.hitbox[0] + man.hitbox[2] &gt; goblin.hitbox[0] and man.hitbox[0] &lt; goblin.hitbox[0] + goblin.hitbox[2]:\n                man.hit()\n                score -= 5\n                goblin.x = 100\nvel = 5\nif shootLoop &gt; 0:\n    shootLoop += 1\nif shootLoop &gt; 15:\n    shootLoop = 0\n\nfor event in pygame.event.get():\n    if event.type == pygame.QUIT:\n        run = False\n\nfor bullet in bullets:\n    for goblin in goblins:\n\n        if goblin.visible == True:\n\n            for goblin in goblins: \n                if bullet.y - bullet.radius &lt; goblin.hitbox[1] + goblin.hitbox[3] and bullet.y + bullet.radius &gt; goblin.hitbox[1]:\n                    if bullet.x + bullet.radius &gt; goblin.hitbox[0] and bullet.x - bullet.radius &lt; goblin.hitbox[0] + goblin.hitbox[2]:\n                        hitSound.play()\n                        goblin.hit()\n                        score += 1\n                        bullets.pop(bullets.index(bullet))\n\n    if bullet.x &lt; 500 and bullet.x &gt; 0:\n        bullet.x += bullet.vel\n    else:\n        bullets.pop(bullets.index(bullet))\n\nkeys = pygame.key.get_pressed()\n\nif keys[pygame.K_z] and shootLoop == 0:\n    bulletSound.play()\n    if man.left:\n        facing = -1\n    else:\n        facing = 1\n    bullets.append(projectile(round(man.x + man.width //2), round(man.y + man.height//2), 6, (0,0,0), facing))\n\n    shootLoop = 1\n\nif keys[pygame.K_LEFT] and man.x &gt; man.vel:\n    man.x -= man.vel\n    man.left = True\n    man.right = False\n    man.standing = False\nelif keys[pygame.K_RIGHT]:\n\n    if man.x == 500 and goblin.visible == False:\n        man.x = 30\n        stage += 1\n        goblins = []\n    if man.x &gt; 500 - man.width - man.vel and goblin.visible == True:\n        vel = 0\n    else:\n\n        man.x += man.vel\n        man.right = True\n        man.left = False\n        man.standing = False\nelse:\n    man.standing = True\n    man.walkCount = 0\n\nif not(man.isJump):\n    if keys[pygame.K_SPACE]:\n        man.isJump = True\n        man.right = False\n        man.left = False\n        man.walkCount = 0\nelse:\n    if man.jumpCount &gt;= -10:\n        neg = 1\n        if man.jumpCount &lt; 0:\n            neg = -1\n        man.y -= (man.jumpCount ** 2) * 0.5 * neg\n        man.jumpCount -= 1\n    else:\n        man.isJump = False\n        man.jumpCount = 10\n\nredrawGameWindow()\n\npygame.quit()\n</code></pre>\n"}, {"tags": ["python", "matplotlib", "colorbar"], "comments": [{"owner": {"reputation": 246762, "user_id": 4124317, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/wsHAV.png?s=128&g=1", "display_name": "ImportanceOfBeingErnest", "link": "https://stackoverflow.com/users/4124317/importanceofbeingernest"}, "edited": false, "score": 1, "creation_date": 1571258552, "post_id": 58421012, "comment_id": 103185014, "body": "There seem to be different problems here. The error is due to no argument given to <code>fig.colorbar</code>.  This should be the <code>QuadMesh</code> object created (but not returned) by heatmap. For this you need to dig in the axes children, <code>ax.collections[0]</code>. However, usually you get a colorbar for a seaborn heatmap by default. You can use <code>cbar=True, cbar_kws={...}</code> supplying any arguments to the colorbar."}], "owner": {"reputation": 609, "user_id": 9682236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SHbQdxPyduc/AAAAAAAAAAI/AAAAAAAAAII/mZRrgTh7xK4/photo.jpg?sz=128", "display_name": "Mark McGown", "link": "https://stackoverflow.com/users/9682236/mark-mcgown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1571256659, "creation_date": 1571256659, "question_id": 58421012, "link": "https://stackoverflow.com/questions/58421012/how-do-i-properly-handle-the-colorbar", "title": "How do I properly handle the colorbar?", "body": "<p>I have long struggled with matplotlib understanding when to use fig/ax/plt after reading the documentation. Right now, I'd like to just give a title to the colorbar, but I always get stuck knowing which objects to store everything in and which to use later.</p>\n\n<p>Could I get a general explanation to avoid going down such a path? Is there a more proper way I should be passing heatmap into ax so I don't run into this trouble again?</p>\n\n<pre><code>activity = 'Downstairs'\nlayer = 1\n\nseg_x = create_segments_and_labels(df[df['ActivityEncoded']==mapping[activity]],TIME_PERIODS,STEP_DISTANCE,LABEL)[0]\nget_layer_output = K.function([model_m.layers[0].input],[model_m.layers[layer].output])\nlayer_output = get_layer_output([seg_x])[0]\n\ntry: \n    ax = sns.heatmap(layer_output[0].transpose())\nexcept:\n    ax = sns.heatmap(layer_output.transpose())\n\n\nax.set_xlabel('Kernels',fontsize=30)\nax.set_yticks(range(0,len(layer_output[0][0])+1,10))\nax.set_yticklabels(range(0,len(layer_output[0][0])+1,10))\nax.set_xticks(range(0,len(layer_output[0])+1,5))\nax.set_xticklabels(range(0,len(layer_output[0])+1,5))\nax.set_ylabel('Filters',fontsize=30)\nax.xaxis.labelpad = 10\nax.set_title('Filters vs. Kernels\\n (Layer=' + model_m.layers[layer].name + ')(Activity=' + activity + ')',fontsize=35)\n\n#I'd like to add text to the colorbar but I don't know how to get it here. Fig/plt/ax.colorbar() don't work\n\nclb = fig.colorbar()\n\n</code></pre>\n\n<p>Error:\ncolorbar() missing 1 required positional argument: 'mappable'</p>\n"}, {"tags": ["python", "database", "sqlite"], "comments": [{"owner": {"reputation": 2211, "user_id": 788833, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/WJfHU.png?s=128&g=1", "display_name": "dmigo", "link": "https://stackoverflow.com/users/788833/dmigo"}, "edited": false, "score": 0, "creation_date": 1571257206, "post_id": 58421008, "comment_id": 103184426, "body": "What happens when you run this code?"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1571269714, "post_id": 58421008, "comment_id": 103188275, "body": "That&#39;s an... interesting... way to read your file. See <a href=\"https://stackoverflow.com/questions/3277503/how-to-read-a-file-line-by-line-into-a-list\">how to read a file line-by-line into a list</a> for more idiomatic python approaches. You might also read up on <code>executemany()</code> in the python sqlite3 bindings documentation."}, {"owner": {"reputation": 3, "user_id": 12224495, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220835510144413/picture?type=large", "display_name": "Tomahawk", "link": "https://stackoverflow.com/users/12224495/tomahawk"}, "reply_to_user": {"reputation": 2211, "user_id": 788833, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/WJfHU.png?s=128&g=1", "display_name": "dmigo", "link": "https://stackoverflow.com/users/788833/dmigo"}, "edited": false, "score": 0, "creation_date": 1571270018, "post_id": 58421008, "comment_id": 103188340, "body": "@dmigo it runs but doesn&#180;t make changes to the database"}, {"owner": {"reputation": 3, "user_id": 12224495, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220835510144413/picture?type=large", "display_name": "Tomahawk", "link": "https://stackoverflow.com/users/12224495/tomahawk"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1571270053, "post_id": 58421008, "comment_id": 103188345, "body": "Thank you so much ! @shawn"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12224495, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220835510144413/picture?type=large", "display_name": "Tomahawk", "link": "https://stackoverflow.com/users/12224495/tomahawk"}, "edited": false, "score": 0, "creation_date": 1571270140, "post_id": 58421405, "comment_id": 103188359, "body": "Thank you !!! It works, it create another table in the database with the info, is there a way to replace or add the information to an existing column in a table ?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1571276329, "post_id": 58421405, "comment_id": 103189533, "body": "Pandas is a data science library and not needed for this trivial task of text file read."}, {"owner": {"reputation": 537, "user_id": 4755625, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/af92678b11751bd870243de898b11087?s=128&d=identicon&r=PG&f=1", "display_name": "topcat", "link": "https://stackoverflow.com/users/4755625/topcat"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1571320189, "post_id": 58421405, "comment_id": 103208856, "body": "Sure @Parfait, it&#39;s a huge overhead, that&#39;s why I&#39;m referring that as naive. Although, if the OP needs to add a column to a table it can easily be updated with <code>pandas</code> and avoiding the possible constrain problems when inserting."}], "tags": [], "owner": {"reputation": 537, "user_id": 4755625, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/af92678b11751bd870243de898b11087?s=128&d=identicon&r=PG&f=1", "display_name": "topcat", "link": "https://stackoverflow.com/users/4755625/topcat"}, "is_accepted": false, "score": 0, "last_activity_date": 1571273603, "last_edit_date": 1571273603, "creation_date": 1571258504, "answer_id": 58421405, "question_id": 58421008, "link": "https://stackoverflow.com/questions/58421008/python-script-to-pass-txt-file-to-sqlite3-database/58421405#58421405", "title": "python script to pass txt file to sqlite3 database", "body": "<p>This might be a pretty naive way of doing it, but have you try <code>pandas</code>? Pandas might add a little bit of overhead, but it's definitely useful for this kind of tasks, and it's not particularly slow for sqlite (another story with PostgreSQL).</p>\n\n<pre><code>import pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('prueback.db')\ncur = conn.cursor()\n\n# Don't know which type of file you have. I'm assuming a fixed width column text\ndata = pd.read_fwf('subgenres.txt') \n\n# This will create the table, or add rows if exists (just change the if_exists option to \"append\")\ndata.to_sql('subgenero', conn, if_exists='replace')\n\nconn.close()\n</code></pre>\n\n<p>Now, if you have another table in you database you can pull the data from the database using Pandas:</p>\n\n<pre><code>table_db = pd.read_sql(\"select * from table\", con=conn)\n\n# In case they have identifiers (or if they keep the same row order)\ntable_db['subgenero'] = table_db.merge(suborder, on='id' ,how='inner')\n\ntable_db.to_sql('table', conn, if_exists='replace')\n</code></pre>\n\n<p>Check more information in the <a href=\"https://pandas.pydata.org/pandas-docs/stable/getting_started/index.html\" rel=\"nofollow noreferrer\">Pandas documentation</a>\nand read with particular attention the <code>pd.to_sql</code> <a href=\"https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_sql.html\" rel=\"nofollow noreferrer\">documentation</a>, there is a lot of options that might be particularly helpful depending on your use case. </p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 12224495, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220835510144413/picture?type=large", "display_name": "Tomahawk", "link": "https://stackoverflow.com/users/12224495/tomahawk"}, "edited": false, "score": 0, "creation_date": 1571281622, "post_id": 58423708, "comment_id": 103190543, "body": "It sent me an error NOT NULL constraint failed:, because I got 3 more columns in that table but i only want to fill that one."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 3, "user_id": 12224495, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220835510144413/picture?type=large", "display_name": "Tomahawk", "link": "https://stackoverflow.com/users/12224495/tomahawk"}, "edited": false, "score": 0, "creation_date": 1571317328, "post_id": 58423708, "comment_id": 103207063, "body": "Then you must have added a <code>NOT NULL</code> constraint in the <code>CREATE TABLE subgenero</code> call. This has nothing to do with Python code. Post output of <code>.schema subgenero</code> in SQLite CLI. Otherwise insert some non-NULL value in other required columns here."}, {"owner": {"reputation": 3, "user_id": 12224495, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220835510144413/picture?type=large", "display_name": "Tomahawk", "link": "https://stackoverflow.com/users/12224495/tomahawk"}, "edited": false, "score": 0, "creation_date": 1571523039, "post_id": 58423708, "comment_id": 103271193, "body": "Thanks it works, do you know how can i separate the text to another column ? For example: I got a .txt file with:  Rock also know as:  pop. And i want to put the Rock in a column and pop in another.  Thank you."}, {"owner": {"reputation": 537, "user_id": 4755625, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/af92678b11751bd870243de898b11087?s=128&d=identicon&r=PG&f=1", "display_name": "topcat", "link": "https://stackoverflow.com/users/4755625/topcat"}, "edited": false, "score": 0, "creation_date": 1571666676, "post_id": 58423708, "comment_id": 103306508, "body": "I think that&#39;s part of another question, and you can easily find related solved questions (N.B. That&#39;s why I recommended <code>pandas</code>)."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1571276185, "creation_date": 1571276185, "answer_id": 58423708, "question_id": 58421008, "link": "https://stackoverflow.com/questions/58421008/python-script-to-pass-txt-file-to-sqlite3-database/58423708#58423708", "title": "python script to pass txt file to sqlite3 database", "body": "<p>Simply <code>open</code> file using <code>with</code> context manager and iterate line by line. Never use <code>readlines</code> as it can be memory intensive since you read entire file at once.</p>\n\n<pre><code>with open('subgenres.txt') as f:\n   for line in f:\n       c.execute(\"INSERT INTO subgenero (subgenrename) VALUES (?)\", (line,))\n       conn.commit()\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12224495, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220835510144413/picture?type=large", "display_name": "Tomahawk", "link": "https://stackoverflow.com/users/12224495/tomahawk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1571276185, "creation_date": 1571256647, "last_edit_date": 1571259049, "question_id": 58421008, "link": "https://stackoverflow.com/questions/58421008/python-script-to-pass-txt-file-to-sqlite3-database", "title": "python script to pass txt file to sqlite3 database", "body": "<p>I need to pass the text line per line in a .txt file to a column from a table that got 4 columns, all empty, in a database.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import sqlite3\n\nconn = sqlite3.connect('prueback.db')\nc = conn.cursor()\n\n\nnum_lines = sum(1 for line in open('subgenres.txt'))\nf=open('subgenres.txt')\nlines=f.readlines()\ni=1\nwhile True:\n    subgenrename = (lines[i])\n    c.execute(\"INSERT INTO subgenero (subgenrename) VALUES (?)\", (subgenrename,))\n    conn.commit()\n    i+=1\n    if i == num_lines:\n        break\n\n\nconn.close()\n</code></pre>\n"}, {"tags": ["python", "mongodb", "pymongo"], "answers": [{"tags": [], "owner": {"reputation": 443, "user_id": 8837616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/690d94f0c162dcda1b2eceae25eb8158?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Sant&#39;ana", "link": "https://stackoverflow.com/users/8837616/matheus-santana"}, "is_accepted": false, "score": 0, "last_activity_date": 1571316124, "creation_date": 1571316124, "answer_id": 58432930, "question_id": 58420998, "link": "https://stackoverflow.com/questions/58420998/how-to-remove-duplicated-values-on-mongodb-by-date/58432930#58432930", "title": "How to remove duplicated values on Mongodb by date", "body": "<p>The solution that i've found for that was to make a filter that searches in the current collection for the last duplicated document and compare the slug (unique field, could also be _id) of both objects.</p>\n\n<p>It looks like this:</p>\n\n<pre><code>    def last_duplicated_patient(self, swab):\n        return self.collection.find({'swab': swab}).sort([(\"_id\", pymongo.DESCENDING)]).limit(1)\n\n    def aggregate_result_collection(self):\n        ignore_string = re.compile('coleta', re.IGNORECASE)\n        patients_with_results = list(self.collection.aggregate([\n            {\n                '$lookup': {\n                    'from': 'algoritmo_result',\n                    'localField': 'slug',\n                    'foreignField': 'slug',\n                    'as': 'copies_result'\n                }\n            },\n            {\n                '$match': {\n                    'obs': {'$not': ignore_string},\n                },\n            },\n        ]))\n        patients_with_results = list(filter(\n            lambda x: x.get('slug') == list(self.last_duplicated_patient(x.get('swab')))[0].get('slug'),\n            patients_with_results\n        ))\n</code></pre>\n"}], "owner": {"reputation": 443, "user_id": 8837616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/690d94f0c162dcda1b2eceae25eb8158?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Sant&#39;ana", "link": "https://stackoverflow.com/users/8837616/matheus-santana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571316124, "creation_date": 1571256622, "last_edit_date": 1571257122, "question_id": 58420998, "link": "https://stackoverflow.com/questions/58420998/how-to-remove-duplicated-values-on-mongodb-by-date", "title": "How to remove duplicated values on Mongodb by date", "body": "<p>I have two collections that I want to merge. After merging, I need to remove duplicated values, keeping the newest document and removing older ones.</p>\n\n<p>I have tried to get that done by the aggregate method:</p>\n\n<pre><code>self.collection.aggregate([\n    {\n        '$lookup': {\n            'from': 'algoritmo_result',\n            'localField': 'slug',\n            'foreignField': 'slug',\n            'as': 'copies_result'\n        }\n    },\n    {\n        '$group': {\n            '_id': '$swab', 'count': {'$sum': 1}\n        }\n    },\n    {\n        '$match': {\n            'obs': {'$not': ignore_string},\n            'count': 1\n        },\n    }\n])\n</code></pre>\n\n<p>The problem is that I am removing every duplicated value and not just older values.</p>\n"}, {"tags": ["python", "sockets", "networking", "decode", "packet"], "comments": [{"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 1, "creation_date": 1571256773, "post_id": 58420954, "comment_id": 103184218, "body": "This depends on the application protocol used to transfer the pictures. HTTP - likely possible, HTTPS - very likely impossible since it is encrypted, other protocols - it depends."}, {"owner": {"reputation": 2466, "user_id": 1596750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AUl9X.jpg?s=128&g=1", "display_name": "Ross Jacobs", "link": "https://stackoverflow.com/users/1596750/ross-jacobs"}, "edited": false, "score": 0, "creation_date": 1571257753, "post_id": 58420954, "comment_id": 103184680, "body": "Rolling out the welcome mat - Welcome to Stack Overflow! Please read the <a href=\"https://stackoverflow.com/help\">help pages</a>, take the <a href=\"https://stackoverflow.com/tour\">SO tour</a>, read about <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as this <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">question checklist</a>. Also please learn how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 2466, "user_id": 1596750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AUl9X.jpg?s=128&g=1", "display_name": "Ross Jacobs", "link": "https://stackoverflow.com/users/1596750/ross-jacobs"}, "edited": false, "score": 0, "creation_date": 1571258603, "post_id": 58420954, "comment_id": 103185030, "body": "To add to Steffen&#39;s comment, decrypting files transferred over HTTPS is actually possible <i>IF</i> you can save the TLS keys AND your client/server software is capable of this. See <a href=\"https://tshark.dev/export/export_tls/\" rel=\"nofollow noreferrer\">this article</a> for more info."}, {"owner": {"reputation": 25, "user_id": 11689315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2729ac324654282051f6f39b289ac59?s=128&d=identicon&r=PG&f=1", "display_name": "DoxyTweak", "link": "https://stackoverflow.com/users/11689315/doxytweak"}, "edited": false, "score": 0, "creation_date": 1571260583, "post_id": 58420954, "comment_id": 103185787, "body": "Hello everyone, thank you for the response.   I would like to clarify the following: I have a script that gets all the pictures from every machine through SSH connection (+ SCP).  However, I would like to abandon this approach.    What I want is to:  - Have my workstation connected to a physical port of the Switch  (where the server machine is connected to)   - Receive a copy of all traffic flowing from the Machines--&gt;Server.  - Have a python script on my WKS that listens to incoming traffic directed to the servers process port &amp; decode those messages in order to get the pictures."}, {"owner": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 0, "creation_date": 1571260681, "post_id": 58420954, "comment_id": 103185819, "body": "You would be much better to replace the server with a reliable implementation - then you aren\u2019t doing dodgy things like trying to decrypt passing SSL traffic, and you completely avoid the problem because your replacement server would be outside the encrypted flow."}, {"owner": {"reputation": 25, "user_id": 11689315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2729ac324654282051f6f39b289ac59?s=128&d=identicon&r=PG&f=1", "display_name": "DoxyTweak", "link": "https://stackoverflow.com/users/11689315/doxytweak"}, "reply_to_user": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 0, "creation_date": 1571261480, "post_id": 58420954, "comment_id": 103186136, "body": "@barny I totally agree, but I&#39;m trying to do this more on an educational manner - just to learn a bit more about how things work. Thank you!"}, {"owner": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "edited": false, "score": 1, "creation_date": 1571263415, "post_id": 58420954, "comment_id": 103186737, "body": "Switches only send frames to the destination interface, not all the interfaces, so a device connected to a different switch interface would never see the traffic. <i>Some</i> enterprise-grade switches can be configured to mirror traffic to a particular interface, but that depends on the manufacturer and model, and it is off-topic here."}], "answers": [{"tags": [], "owner": {"reputation": 2466, "user_id": 1596750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AUl9X.jpg?s=128&g=1", "display_name": "Ross Jacobs", "link": "https://stackoverflow.com/users/1596750/ross-jacobs"}, "is_accepted": true, "score": 1, "last_activity_date": 1571259325, "creation_date": 1571259325, "answer_id": 58421579, "question_id": 58420954, "link": "https://stackoverflow.com/questions/58420954/how-to-get-decode-messages-destinated-to-a-specific-port/58421579#58421579", "title": "How to get &amp; decode messages destinated to a specific port", "body": "<h2>Can SSH traffic be decrypted <em>ex post facto</em> with Wireshark?</h2>\n\n<p>No, you cannot <a href=\"https://en.wikipedia.org/wiki/Man-in-the-middle_attack\" rel=\"nofollow noreferrer\">Man-in-the-Middle</a> SSH-encrypted packets if all you have is a capture from a port-mirror. This is unless you are the NSA or nation-state actor and have found a way to circumvent the encryption.</p>\n\n<blockquote>\n  <p>Does anyone have an idea of how to decode these packets to get the pictures? </p>\n</blockquote>\n\n<p>Even if you could decrypt SSH (see below), it is not possible to do this with Wireshark. Per the Wireshark <a href=\"https://wiki.wireshark.org/SSH\" rel=\"nofollow noreferrer\">docs on SSH</a>: </p>\n\n<blockquote>\n  <p>Unlike the SSL dissector, no code has been written to decrypt encrypted SSH packets/payload.</p>\n</blockquote>\n\n<h2>Can Wireshark detect file metadata in encrypted traffic?</h2>\n\n<blockquote>\n  <p>Is it possible to use WireShark to see what's the payload format and from there try to reverse engineer the pictures?</p>\n</blockquote>\n\n<p>No it's encrypted - you can't see anything. The most you will be able to see is SSH setup messages.</p>\n\n<h2>Alternatives</h2>\n\n<p>If you have access to client/server and set this up beforehand, there are <a href=\"https://github.com/trolldbois/sslsnoop\" rel=\"nofollow noreferrer\">solutions</a> to extract the secret keys from memory. Keep in mind that you MUST have this set up beforehand on client or server as these session keys expire with the session (depending on the protocol).</p>\n"}], "owner": {"reputation": 25, "user_id": 11689315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2729ac324654282051f6f39b289ac59?s=128&d=identicon&r=PG&f=1", "display_name": "DoxyTweak", "link": "https://stackoverflow.com/users/11689315/doxytweak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "closed_date": 1571266633, "accepted_answer_id": 58421579, "answer_count": 1, "score": 1, "last_activity_date": 1571263365, "creation_date": 1571256352, "last_edit_date": 1571263365, "question_id": 58420954, "link": "https://stackoverflow.com/questions/58420954/how-to-get-decode-messages-destinated-to-a-specific-port", "closed_reason": "Needs more focus", "title": "How to get &amp; decode messages destinated to a specific port", "body": "<p>I'm currently working with a particular system where a set of machines sends a message (a picture to be more precise) to a server (mainly for storage purposes) when a certain triggering event occurs (real-time).\n<em>These pictures are also stored locally in each equipment.</em></p>\n\n<p>I decided to adventure myself in finding an alternative to this server, just for educational purpose. I made a Python script that accesses each machine every 15 minutes through SSH and with the use of SCP it downloads the latest pictures to my workstation.</p>\n\n<p>I'm happy with this solution but I would like to also implement a way to get those pictures in a real-time fashion. So, I'm thinking about activating 'port mirroring' @ the switch where the server machine is connected to and make a Python script to decode the packets and download the pictures.\n<em>Basically I would have my Workstation connected to a switch port that receives all the traffic coming to the server machine.</em></p>\n\n<p><strong>Does anyone have an idea of how to decode these packets to get the pictures?</strong>\n<strong>How can one decode messages coming from the switch port?</strong>\nUsing the <em>netstat</em> command on CMD I might be able to get the port that identifies the server process - maybe that's a start, right?</p>\n\n<p>Is it possible to use WireShark to see what's the payload format and from there try to reverse engineer the pictures?</p>\n\n<p>Please let me know of any approach you might know and/or find interesting to try.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["python", "python-3.x", "pandas", "dataframe"], "comments": [{"owner": {"reputation": 653, "user_id": 10981911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l3kQk.jpg?s=128&g=1", "display_name": "manesioz", "link": "https://stackoverflow.com/users/10981911/manesioz"}, "edited": false, "score": 1, "creation_date": 1571256919, "post_id": 58420941, "comment_id": 103184285, "body": "Can you please include the full error output? That will help trace back where the error happened in your code."}, {"owner": {"reputation": 585, "user_id": 7852656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4b2c2c512647b6c91eac9e50f81a9879?s=128&d=identicon&r=PG&f=1", "display_name": "user7852656", "link": "https://stackoverflow.com/users/7852656/user7852656"}, "reply_to_user": {"reputation": 653, "user_id": 10981911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l3kQk.jpg?s=128&g=1", "display_name": "manesioz", "link": "https://stackoverflow.com/users/10981911/manesioz"}, "edited": false, "score": 0, "creation_date": 1571258316, "post_id": 58420941, "comment_id": 103184907, "body": "@ZacharyManesiotis, I edited the question. It should be addressing the issue now."}, {"owner": {"reputation": 683, "user_id": 11220780, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ubIXaw71rPY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reTNbPdx6BDLRY2TCGVZDXEhNhHWQ/mo/photo.jpg?sz=128", "display_name": "Benoit de Menthi&#232;re", "link": "https://stackoverflow.com/users/11220780/benoit-de-menthi%c3%a8re"}, "edited": false, "score": 1, "creation_date": 1571259776, "post_id": 58420941, "comment_id": 103185528, "body": "not sure to understand well, but smthg like [x.iloc[:,0] for x in my_y], will return a list of the first column of each df in my-y"}], "answers": [{"tags": [], "owner": {"reputation": 1707, "user_id": 11832127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zsq7r.png?s=128&g=1", "display_name": "ndclt", "link": "https://stackoverflow.com/users/11832127/ndclt"}, "is_accepted": true, "score": 0, "last_activity_date": 1571342120, "creation_date": 1571342120, "answer_id": 58439865, "question_id": 58420941, "link": "https://stackoverflow.com/questions/58420941/pandas-typeerror-list-indices-must-be-integers-or-slices-not-dataframe/58439865#58439865", "title": "Pandas: TypeError: list indices must be integers or slices, not DataFrame", "body": "<p>You can concatenate all your csv in one dataframe. It will be easier to manipulate. It is assuming that all csv have the columns at the same position as you don't have any header. I see you are skipping the first rows when selecting you x and y, you could also use the <code>skiprows</code> option of <code>pd.read_csv</code>.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import pandas as pd\nimport glob\n\nuser_info=[19,20,21,22,23] #number of charge states analyzed using fit.py \n\n\npath = r'C:\\Users\\my_folder' # use your path\nall_files = glob.glob(path + \"/*.csv\")\n\ndata = []\n\nfor filename in all_files:\n    df = pd.read_csv(filename, index_col=None, header=0, skiprows=2)\n    data.append(df)\n\ndataframe = pd.concat(data, axis='columns') # this assumes that x are the same and you only add columns in the different csv\nmy_x = dataframe.iloc[:, 0]\nmy_y = dataframe.iloc[:, 1:]\n</code></pre>\n"}], "owner": {"reputation": 585, "user_id": 7852656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4b2c2c512647b6c91eac9e50f81a9879?s=128&d=identicon&r=PG&f=1", "display_name": "user7852656", "link": "https://stackoverflow.com/users/7852656/user7852656"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 818, "favorite_count": 0, "accepted_answer_id": 58439865, "answer_count": 1, "score": 0, "last_activity_date": 1571342120, "creation_date": 1571256273, "last_edit_date": 1571256953, "question_id": 58420941, "link": "https://stackoverflow.com/questions/58420941/pandas-typeerror-list-indices-must-be-integers-or-slices-not-dataframe", "title": "Pandas: TypeError: list indices must be integers or slices, not DataFrame", "body": "<p>I am working with a lot of input csv files in a specified folder. I am using pandas data frame to store the input file and intend to do more math.</p>\n\n<pre><code>import numpy as np\nimport matplotlib.pyplot as plt\nimport csv\nimport os\nfrom scipy.interpolate import interp1d\nimport pandas as pd\nimport glob\n\nuser_info=[19,20,21,22,23] #number of charge states analyzed using fit.py \n\n\npath = r'C:\\Users\\my_folder' # use your path\nall_files = glob.glob(path + \"/*.csv\")\n\ndata = []\n\nfor filename in all_files:\n    df = pd.read_csv(filename, index_col=None, header=0)\n    data.append(df)\n\nmy_x=data[0].iloc[2:,0] #assuming that all the files have the same list of x for all data(1~200)\n\nmy_y=[]\nfor filenumber in range(len(all_files)):\n    my_y.append(data[filenumber].iloc[2:,1:len(user_info)+1])\n</code></pre>\n\n<p>All the files are analyzed are two csv files in this example.</p>\n\n<pre><code>In[469]: all_files\nOut[469]: \n['C:\\\\Users\\my_folder\\my_csv_file_001.csv',\n 'C:\\\\Users\\my_folder\\my_csv_file_002.csv']\n</code></pre>\n\n<p>'data' is a list of 2 elements. Each element contains the information from each csv file. Each element is read as DataFrame. </p>\n\n<pre><code>In [471]:data[0]\nOut[471]: \n[      -2   8125     7350    6725\n 0     -1   8550     7700    7025\n 1      0      0       51       0\n 2      1      0       20       0\n 3      2      0       57       0\n 4      3      0      196       0\n 5      4      0       92       0\n 6      5      0       91      62\n 7      6      0       52      85\n 8      7      0        0       0\n 9      8      0      201       0\n 10     9      0       36       0\n 11    10      0      104      14\n 12    11      0       96       0\n 13    12     89        0       0\n 14    13     20       94       0\n 15    14    149      120       0\n 16    15      0       54      41\n 17    16     18        0      29\n 18    17      0       61      59\n 19    18    168      285    1375\n 20    19    575    22737   94126\n 21    20   5198   520564  364946\n 22    21  18037  1649117  594484\n 23    22  51229  2189268  198710\n 24    23  45691  1242980   28893\n 25    24  11040   207948    3771\n 26    25   1843    27105    1077\n 27    26    239     9262     863\n 28    27    233     5533     357\n 29    28     91     3159     120\n ..   ...    ...      ...     ...\n 171  170      0      117      47\n 172  171      0       48       0\n 173  172      0      186       0\n 174  173      0       58       0\n 175  174      0       26       0\n 176  175      0        0       0\n 177  176      0        0       0\n 178  177      0        0       0\n 179  178      0        0      32\n 180  179      0      103       0\n 181  180      0       64       0\n 182  181      0       39      82\n 183  182      0       17       0\n 184  183      0       45      58\n 185  184      0        0       0\n 186  185      0        0       0\n 187  186      0       45       0\n 188  187      0        0       0\n 189  188      0       18       0\n 190  189      0        0       0\n 191  190      0       89       0\n 192  191      0      139       0\n 193  192      0       38      28\n 194  193      0      110       0\n 195  194      0      119       0\n 196  195      0        0      83\n 197  196      0       28     123\n 198  197      0        0      56\n 199  198      0       44       0\n 200  199      0       84       0\n\n [201 rows x 4 columns]]\n</code></pre>\n\n<p>my_y values are all the columns excluding the first columns. </p>\n\n<pre><code>In [476]: my_y[0]\nOut[476]: \n[      8125     7350    6725\n 2        0       20       0\n 3        0       57       0\n 4        0      196       0\n 5        0       92       0\n 6        0       91      62\n 7        0       52      85\n 8        0        0       0\n 9        0      201       0\n 10       0       36       0\n 11       0      104      14\n 12       0       96       0\n 13      89        0       0\n 14      20       94       0\n 15     149      120       0\n 16       0       54      41\n 17      18        0      29\n 18       0       61      59\n 19     168      285    1375\n 20     575    22737   94126\n 21    5198   520564  364946\n 22   18037  1649117  594484\n 23   51229  2189268  198710\n 24   45691  1242980   28893\n 25   11040   207948    3771\n 26    1843    27105    1077\n 27     239     9262     863\n 28     233     5533     357\n 29      91     3159     120\n 30      29     1637       0\n 31      64      403      48\n ..     ...      ...     ...\n 171      0      117      47\n 172      0       48       0\n 173      0      186       0\n 174      0       58       0\n 175      0       26       0\n 176      0        0       0\n 177      0        0       0\n 178      0        0       0\n 179      0        0      32\n 180      0      103       0\n 181      0       64       0\n 182      0       39      82\n 183      0       17       0\n 184      0       45      58\n 185      0        0       0\n 186      0        0       0\n 187      0       45       0\n 188      0        0       0\n 189      0       18       0\n 190      0        0       0\n 191      0       89       0\n 192      0      139       0\n 193      0       38      28\n 194      0      110       0\n 195      0      119       0\n 196      0        0      83\n 197      0       28     123\n 198      0        0      56\n 199      0       44       0\n 200      0       84       0\n\n [199 rows x 3 columns]]\n</code></pre>\n\n<p>I want to extract each column and do some math (np.cumsum). But I don't know how to access to the individual columns in the DataFrame in the my_y(list).\nFor instance I want to get the first column of y: </p>\n\n<pre><code>0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n89\n20\n149\n0\n18\n0\n168\n575\n5198\n18037\n51229\n45691\n11040\n1843\n239\n233\n91\n29\n64\n0\n51\n0\n0\n0\n0\n0\n0\n0\n38\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n33\n0\n0\n0\n0\n0\n0\n18\n0\n0\n0\n38\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n32\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n13\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n18\n0\n0\n0\n0\n0\n0\n51\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n</code></pre>\n\n<p>But as shown above, my_y[0] selects all the y values in the first DataFrame.</p>\n\n<p>Any ideas?</p>\n"}]