[{"tags": ["python", "viber", "viber-api", "viber-bot", "viber-bot-python"], "comments": [{"owner": {"reputation": 272, "user_id": 3744622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bb087efa54cac0b82af8e73165ae2f5?s=128&d=identicon&r=PG&f=1", "display_name": "hwak", "link": "https://stackoverflow.com/users/3744622/hwak"}, "edited": false, "score": 0, "creation_date": 1591252490, "post_id": 56369985, "comment_id": 109985686, "body": "as i know, viber api is not supported uploading files feature. for my opinion you should upload photo to third party server and specify URL to viber api &quot;media&quot; parameter"}], "answers": [{"tags": [], "owner": {"reputation": 969, "user_id": 326242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35cde28dc376b1403cf4de6cbebc80e5?s=128&d=identicon&r=PG", "display_name": "Andrew Koster", "link": "https://stackoverflow.com/users/326242/andrew-koster"}, "is_accepted": false, "score": 0, "last_activity_date": 1559177729, "creation_date": 1559177729, "answer_id": 56370311, "question_id": 56369985, "link": "https://stackoverflow.com/questions/56369985/is-there-a-way-to-generate-urls-for-local-files/56370311#56370311", "title": "Is there a way to generate URLs for local files?", "body": "<p>Generate a file URI such as <code>file:///C:/Users/bob/Desktop/avatar.jpg</code> .</p>\n\n<p>How you generate that whole path depends on where you expect these files to be. But this is the syntax:</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/File_URI_scheme\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/File_URI_scheme</a></p>\n\n<p>You should read it and note the 3 slashes before the path, and understand why (because it's shorthand for <code>file://localhost/C:/Users/bob/Desktop/avatar.jpg</code>).</p>\n"}], "owner": {"reputation": 73, "user_id": 11575450, "user_type": "registered", "profile_image": "https://graph.facebook.com/854752624859265/picture?type=large", "display_name": "Bob Wazowski", "link": "https://stackoverflow.com/users/11575450/bob-wazowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 332, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1597390723, "creation_date": 1559174261, "last_edit_date": 1597390723, "question_id": 56369985, "link": "https://stackoverflow.com/questions/56369985/is-there-a-way-to-generate-urls-for-local-files", "title": "Is there a way to generate URLs for local files?", "body": "<p>I'm trying to create a Viber chat-bot that is able to send some pictures. I am required to send URL of an image as a parameter, but the images I want to send are on my desktop and I do not know how to get their URLs.</p>\n<p>I tried using requests:</p>\n<pre class=\"lang-py prettyprint-override\"><code>image = {  &quot;media&quot;: open('test_image.jpg', 'rb')}\n\npayload = { \n  &quot;auth_token&quot;: &quot;my token&quot;,\n  &quot;receiver&quot;: &quot;my chat id&quot;, \n  &quot;type&quot;: &quot;picture&quot;, \n  &quot;text&quot;: &quot;some text&quot;, \n}\n\nrequests.post(&quot;https://chatapi.viber.com/pa/send_message&quot;, json=image, file=image)\n</code></pre>\n<p>I also tried using <code>imgur API</code> but it is a pain getting &quot;pin&quot; authentication all the time using selenium.</p>\n<p>Here is my code:</p>\n<pre class=\"lang-py prettyprint-override\"><code>from viberbot import Api\nfrom viberbot.api.bot_configuration import BotConfiguration\n\nfrom viberbot.api.messages.picture_message import PictureMessage\nfrom viberbot.api.viber_requests import ViberMessageRequest\n\nfrom flask import Flask, request, Response\n\napp = Flask(__name__)\n\nbot_configuration = BotConfiguration(\n    name='name',\n    avatar='http://viber.com/avatar.jpg',\n    auth_token='token'\n)\nviber = Api(bot_configuration)\n\n\n@app.route('/', methods=['POST'])\ndef index():\n  viber_request = viber.parse_request(request.get_data())\n\n  if isinstance(viber_request, ViberMessageRequest):\n    message = viber_request.message\n\n    if message.text == &quot;/pic&quot;:\n\n      viber.send_messages(viber_request.sender.id, [\n        PictureMessage(media=&quot;image url&quot;, text=&quot;Some text&quot;)\n      ])\n\n  return Response(status=200)\n\n\nif __name__ == '__main__':\n  app.run(debug=True)\n</code></pre>\n<p>To sum up:\nIn picture message object <code>PictureMessage(media=&quot;image url&quot;, text=&quot;Some text&quot;)</code> &quot;media&quot; has to be URL of image (only JPEG supported).\nHow would you turn images on your desktop into URLs?</p>\n"}, {"tags": ["python"], "comments": [{"owner": {"reputation": 878, "user_id": 2445273, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7CgrG.jpg?s=128&g=1", "display_name": "LoMaPh", "link": "https://stackoverflow.com/users/2445273/lomaph"}, "edited": false, "score": 0, "creation_date": 1559174449, "post_id": 56369961, "comment_id": 99342428, "body": "Not very clear what you are asking. I suggest edit your question and make it more clear."}, {"owner": {"reputation": 453, "user_id": 10723993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d7e8a4d08cf004d3135ab0d812415c8?s=128&d=identicon&r=PG&f=1", "display_name": "Number70", "link": "https://stackoverflow.com/users/10723993/number70"}, "reply_to_user": {"reputation": 878, "user_id": 2445273, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7CgrG.jpg?s=128&g=1", "display_name": "LoMaPh", "link": "https://stackoverflow.com/users/2445273/lomaph"}, "edited": false, "score": 0, "creation_date": 1559174632, "post_id": 56369961, "comment_id": 99342472, "body": "I will try to make it clear."}, {"owner": {"reputation": 878, "user_id": 2445273, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7CgrG.jpg?s=128&g=1", "display_name": "LoMaPh", "link": "https://stackoverflow.com/users/2445273/lomaph"}, "edited": false, "score": 0, "creation_date": 1559175230, "post_id": 56369961, "comment_id": 99342591, "body": "For the first case (<code>&lt;= 20</code>) use same code as <code>&lt;= 60</code>, just don&#39;t increment the id (<code>ID += 1</code>)."}, {"owner": {"reputation": 453, "user_id": 10723993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d7e8a4d08cf004d3135ab0d812415c8?s=128&d=identicon&r=PG&f=1", "display_name": "Number70", "link": "https://stackoverflow.com/users/10723993/number70"}, "reply_to_user": {"reputation": 878, "user_id": 2445273, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7CgrG.jpg?s=128&g=1", "display_name": "LoMaPh", "link": "https://stackoverflow.com/users/2445273/lomaph"}, "edited": false, "score": 0, "creation_date": 1559175303, "post_id": 56369961, "comment_id": 99342612, "body": "Yes, but there are 20 students. For the first 3 I need the same studentnumbers from 4 to 6 other etc.."}, {"owner": {"reputation": 878, "user_id": 2445273, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7CgrG.jpg?s=128&g=1", "display_name": "LoMaPh", "link": "https://stackoverflow.com/users/2445273/lomaph"}, "edited": false, "score": 0, "creation_date": 1559175442, "post_id": 56369961, "comment_id": 99342638, "body": "Then your example of what you want is incomplete."}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 0, "creation_date": 1559176287, "post_id": 56369961, "comment_id": 99342791, "body": "Please read and follow the posting guidelines in the help documentation, as suggested when you created this account. <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">Minimal, complete, verifiable example</a> applies here. We cannot effectively help you until you post your MCVE code and accurately specify the problem. We should be able to paste your posted code into a text file and reproduce the problem you specified.  Your posted code is missing some variable definitions and a main program.  The code includes <code>try -- except</code> blocks that don&#39;t seem to help the desired result."}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 0, "creation_date": 1559176460, "post_id": 56369961, "comment_id": 99342827, "body": "It appears that you&#39;re trying to program beyond your comfort level in several directions at once.  I recommend incremental programming: start simply, add 2-5 lines of code at a time, and don&#39;t continue until you have tested those lines.  At the moment, you have outstanding issues with <code>try</code>, <code>dict</code>, and data movement."}, {"owner": {"reputation": 453, "user_id": 10723993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d7e8a4d08cf004d3135ab0d812415c8?s=128&d=identicon&r=PG&f=1", "display_name": "Number70", "link": "https://stackoverflow.com/users/10723993/number70"}, "reply_to_user": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 0, "creation_date": 1559176600, "post_id": 56369961, "comment_id": 99342847, "body": "@Prune, well the thing is I cant copy paste everything that I have done. There is sensitive information and that is why I maybe missed something to include. Im trying to include everything but I see that I missed to clarify 1/2 things. Everything in my program is running.."}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 0, "creation_date": 1559176854, "post_id": 56369961, "comment_id": 99342893, "body": "The code you posted is not running.  There are several syntax and semantic errors."}, {"owner": {"reputation": 453, "user_id": 10723993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d7e8a4d08cf004d3135ab0d812415c8?s=128&d=identicon&r=PG&f=1", "display_name": "Number70", "link": "https://stackoverflow.com/users/10723993/number70"}, "reply_to_user": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 0, "creation_date": 1559177834, "post_id": 56369961, "comment_id": 99343079, "body": "@Prune, maybe it works now? Edited the post"}], "answers": [{"tags": [], "owner": {"reputation": 176, "user_id": 11219043, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-l5zSKNJWkU0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfs2p-SFDelF3PpfIbC4V2LQZYhMQ/mo/photo.jpg?sz=128", "display_name": "Kenivia", "link": "https://stackoverflow.com/users/11219043/kenivia"}, "is_accepted": false, "score": 1, "last_activity_date": 1559175217, "creation_date": 1559175217, "answer_id": 56370087, "question_id": 56369961, "link": "https://stackoverflow.com/questions/56369961/how-to-add-same-values-to-different-keys-in-dictionaries/56370087#56370087", "title": "How to add same values to different keys in dictionaries?", "body": "<p>I personally don't like using dictionaries, I just think a class object is much more convenient, although maybe slower in large scale.</p>\n\n<p>I'm not sure what your issue is, I'm not aware that there can't be two same valued things in a dictionary.</p>\n\n<p>here is how I would do it</p>\n\n<pre><code>import random as r\n\nclass student():\n    def __init__(self,ID,numb):\n        self.number = ID\n        self.email = 'example@mail.com'\n        self.name = 'student{}'.format(numb)\n\nstudents = []\nfor i in range(60):\n    x = student(r.randint(10000,99999),i)\n    students.append(x)\ndef test():\n    ID = 0\n    for i in list(students):\n        print(i.name,i.number,i.email)\n\ntest()\n</code></pre>\n\n<p>if you want to set the student number just change the r.randint bit</p>\n\n<p>hope it helps if you have to use a dictionary\nor if you have any problem please ask :)</p>\n"}, {"comments": [{"owner": {"reputation": 453, "user_id": 10723993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d7e8a4d08cf004d3135ab0d812415c8?s=128&d=identicon&r=PG&f=1", "display_name": "Number70", "link": "https://stackoverflow.com/users/10723993/number70"}, "edited": false, "score": 0, "creation_date": 1559178960, "post_id": 56370363, "comment_id": 99343330, "body": "Thank you very much sir. This is something that I was looking for."}, {"owner": {"reputation": 713, "user_id": 7371707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ffd4213f87a6f6ea4d9c6ac0d179978?s=128&d=identicon&r=PG&f=1", "display_name": "ToughMind", "link": "https://stackoverflow.com/users/7371707/toughmind"}, "reply_to_user": {"reputation": 453, "user_id": 10723993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d7e8a4d08cf004d3135ab0d812415c8?s=128&d=identicon&r=PG&f=1", "display_name": "Number70", "link": "https://stackoverflow.com/users/10723993/number70"}, "edited": false, "score": 0, "creation_date": 1559180004, "post_id": 56370363, "comment_id": 99343525, "body": "Glad to help, but I do spend most of my time in understanding your purpose."}, {"owner": {"reputation": 453, "user_id": 10723993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d7e8a4d08cf004d3135ab0d812415c8?s=128&d=identicon&r=PG&f=1", "display_name": "Number70", "link": "https://stackoverflow.com/users/10723993/number70"}, "edited": false, "score": 0, "creation_date": 1559180156, "post_id": 56370363, "comment_id": 99343548, "body": "Hahha, sorry.. for the next question I will take a deep breath before explaining my problem."}], "tags": [], "owner": {"reputation": 713, "user_id": 7371707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ffd4213f87a6f6ea4d9c6ac0d179978?s=128&d=identicon&r=PG&f=1", "display_name": "ToughMind", "link": "https://stackoverflow.com/users/7371707/toughmind"}, "is_accepted": true, "score": 1, "last_activity_date": 1559178289, "creation_date": 1559178289, "answer_id": 56370363, "question_id": 56369961, "link": "https://stackoverflow.com/questions/56369961/how-to-add-same-values-to-different-keys-in-dictionaries/56370363#56370363", "title": "How to add same values to different keys in dictionaries?", "body": "<p>May be the code below can help. I have to figure it out that you can not use int number like 025. So I change it to strings.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code># student numbers\nstudentNunbers = [{\"studentnumber\": '029182', \"ID\": 0}, {\"studentnumber\": '0591238',\"ID\": 1},{\"studentnumber\": '9213189', \"ID\":2}]\n# student\nstudentInfos = [{\"Student1\":'029182', \"e-mail\":'example@.com'}, {\"Student2\":'0591238',\"e-mail\":'example@.com'},\n                {\"Student3\":'9213189',\"e-mail\":'example@.com'}, {\"Student3\":'92189',\"e-mail\":'example@.com'},\n                {\"Student2\":'0538',\"e-mail\":'example@.com'}, {\"Student2\":'238',\"e-mail\":'example@.com'},\n                {\"Student2\":'0598',\"e-mail\":'example@.com'}, {\"Student2\":'08',\"e-mail\":'example@.com'},]\n\nstudents = [list(data.values())[0] for data in studentNunbers]\n\ndef merge(numRep=1):\n    key = \"studentnumber\"\n    stNumberIndex = 0\n    iterInd = numRep\n    for i in range(len(studentInfos)):\n        value = studentNunbers[stNumberIndex][key]\n        studentInfos[i][key] = value\n\n        iterInd -= 1\n        if iterInd == 0:\n            iterInd = numRep\n            stNumberIndex += 1\n\ndef test():\n    if len(studentNunbers) &lt; 20:\n        merge(numRep=3)\n\n    elif len(studentNunbers) &lt; 60:\n        merge(numRep=1)\n    else:\n        pass\n\ntest()\nprint(studentInfos)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27784, "user_id": 4531270, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/uw3pm.png?s=128&g=1", "display_name": "pylang", "link": "https://stackoverflow.com/users/4531270/pylang"}, "is_accepted": false, "score": 2, "last_activity_date": 1559179711, "creation_date": 1559179711, "answer_id": 56370529, "question_id": 56369961, "link": "https://stackoverflow.com/questions/56369961/how-to-add-same-values-to-different-keys-in-dictionaries/56370529#56370529", "title": "How to add same values to different keys in dictionaries?", "body": "<p>It seems you want to conditionally update a list of dicts.</p>\n\n<p><strong>Given</strong></p>\n\n<pre><code>import random\n\n\nstudents = [\n    {\"Student1\": \"029182\", \"e-mail\": \"ex@mail.com\"},\n    {\"Student2\": \"0591238\", \"e-mail\": \"ex@mail.com\"},\n    {\"Student3\": \"9213189\", \"e-mail\": \"ex@mail.com\"},\n]\n</code></pre>\n\n<p><strong>Code</strong></p>\n\n<pre><code>def get_unique_numbers(size=10):\n    \"\"\"Return an a list of unique random values.\"\"\"\n    return random.sample(range(10000, 99999), size)\n\n\ndef update(students):\n    \"\"\"Return a list of updated dicts.\"\"\"\n    n = len(students)\n\n    # Conditionally, generate student numbers\n    if n &lt;= 20:\n        student_numbers = [students[0][\"Student1\"]] * n\n    elif 20 &lt; n &lt;= 60:\n        student_numbers = get_unique_numbers(n)\n\n    # Update dicts w/student numbers\n    return [{**d, \"student_num\": n} for d, n in zip(students, student_numbers)]\n</code></pre>\n\n<p><strong>Demo</strong></p>\n\n<p>A small list of students (<code>n &lt;= 20</code>) returns dicts with the same student number:</p>\n\n<pre><code>update(students)\n# [{'Student1': '029182', 'e-mail': 'ex@mail.com', 'student_num': '029182'},\n#  {'Student2': '0591238', 'e-mail': 'ex@mail.com', 'student_num': '029182'},\n#  {'Student3': '9213189', 'e-mail': 'ex@mail.com', 'student_num': '029182'}]\n</code></pre>\n\n<p>A larger list (<code>n &gt; 20</code>) returns dicts with random student numbers*:</p>\n\n<pre><code>update(students * 7)\n# {'Student1': '029182', 'e-mail': 'ex@mail.com', 'student_num': 28308},\n# {'Student2': '0591238', 'e-mail': 'ex@mail.com', 'student_num': 21986},\n# {'Student3': '9213189', 'e-mail': 'ex@mail.com', 'student_num': 36603},\n# ...\n# {'Student1': '029182', 'e-mail': 'ex@mail.com', 'student_num': 38362},\n# {'Student2': '0591238', 'e-mail': 'ex@mail.com', 'student_num': 99305},\n# {'Student3': '9213189', 'e-mail': 'ex@mail.com', 'student_num': 78360}\n</code></pre>\n\n<p><sup>*Note: implement the random number generator however you wish.  This one returns random integers from a sample population.</sup> </p>\n"}], "owner": {"reputation": 453, "user_id": 10723993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d7e8a4d08cf004d3135ab0d812415c8?s=128&d=identicon&r=PG&f=1", "display_name": "Number70", "link": "https://stackoverflow.com/users/10723993/number70"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 56370363, "answer_count": 3, "score": -1, "last_activity_date": 1559179711, "creation_date": 1559174050, "last_edit_date": 1559177743, "question_id": 56369961, "link": "https://stackoverflow.com/questions/56369961/how-to-add-same-values-to-different-keys-in-dictionaries", "title": "How to add same values to different keys in dictionaries?", "body": "<p>I have 2 JSON files. 1 file with the the student numbers and 1 file with the students.</p>\n\n<p>I have a list of dictionaries with the name, e-mail, and student number of students. </p>\n\n<p>What I want to do is if there are 60 students I want to give them a unique student number. That part is working in the elif statement. The part which I dont know how to implement is:</p>\n\n<p>If there are 20 students, I want to give for example 2 students the same studentnumber(which sounds stupid but I need it). In this case the student is the key and studentnumber is the value.</p>\n\n<p>What I have now:</p>\n\n<pre><code>\n# student\n[{\"Student1\":029182,\"e-mail\":\"example@.com\"},{\"Student2\":0591238,\"e-mail\":\"example@.com\"},{\"Student3\":9213189,\"e-mail\":\"example@.com\"}]\n\n\n\nstudentnumbers = [{\"studentnumber\":\"029182\",\"ID\":0},{\"studentnumber\":\"0591238\",\"ID\":1},{\"studentnumber\":\"9213189\",\"ID\":2}]\n\nstudents = [list(data.values())[0] for data in studentnumbers]\n\n\nID = 0\n# students is a list of studentnumbers\nif len(students) &lt;= 20:\n    # studentInfo is my dictionary with the key and values\n    for data in studentnumbers:\n        try:\n            pass\n\n        except IndexError:\n            pass\n\n\n\nelif len(students) &lt;= 60:\n    for data in studentnumbers:\n        try:   \n            studentnumbers[ID] = students[ID]\n            ID += 1\n            break\n        except IndexError:\n            pass\n    print(\"..\")\nelse:\n    print(\"...\")\n\nwith open('Students.json','w') as instudent:\n    json.dump(studentnumbers,instudent,indent=2)\n\n\n</code></pre>\n\n<p>output what I have now:</p>\n\n<pre><code>[{\"Student1\":029182,\"e-mail\":\"example@.com\",\"studentnumber\":029182},\n{\"Student2\":0591238,\"e-mail\":\"example@.com\",\"studentnumber\":9213189},\n{\"Student3\":9213189,\"e-mail\":\"example@.com\",\"studentnumber\":0591238},\n{\"Student4\":9213189,\"e-mail\":\"example@.com\",\"studentnumber\":0294832},\n{\"Student5\":9213189,\"e-mail\":\"example@.com\",\"studentnumber\":0591823},\n{\"Student6\":9213189,\"e-mail\":\"example@.com\",\"studentnumber\":0501852}]\n</code></pre>\n\n<p>What I want:</p>\n\n<pre><code>[{\"Student1\":029182,\"e-mail\":\"example@.com\",\"studentnumber\":029182},\n{\"Student2\":0591238,\"e-mail\":\"example@.com\",\"studentnumber\":029182},\n{\"Student3\":9213189,\"e-mail\":\"example@.com\",\"studentnumber\":029182},\n{\"Student4\":9213189,\"e-mail\":\"example@.com\",\"studentnumber\":9213189},\n{\"Student5\":9213189,\"e-mail\":\"example@.com\",\"studentnumber\":9213189},\n{\"Student6\":9213189,\"e-mail\":\"example@.com\",\"studentnumber\":9213189}]\n</code></pre>\n"}, {"tags": ["python", "pandas"], "answers": [{"tags": [], "owner": {"reputation": 16300, "user_id": 11015427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JsY7F.jpg?s=128&g=1", "display_name": "gmds", "link": "https://stackoverflow.com/users/11015427/gmds"}, "is_accepted": true, "score": 1, "last_activity_date": 1559174192, "creation_date": 1559174192, "answer_id": 56369980, "question_id": 56369953, "link": "https://stackoverflow.com/questions/56369953/how-can-i-split-a-list-of-comma-separated-words-in-a-pandas-column/56369980#56369980", "title": "How can I split a list of comma separated words in a Pandas column?", "body": "<p>For this purpose, we can use <code>df['Tags'].str.get_dummies(',')</code>, which basically performs <code>split</code> and converts each element to its own one-hot encoded column.</p>\n"}], "owner": {"reputation": 981, "user_id": 1144431, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/30491c94c6f2052234d824c3089cc07f?s=128&d=identicon&r=PG", "display_name": "Amanda_Panda", "link": "https://stackoverflow.com/users/1144431/amanda-panda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 1, "accepted_answer_id": 56369980, "answer_count": 1, "score": 0, "last_activity_date": 1559174192, "creation_date": 1559173998, "question_id": 56369953, "link": "https://stackoverflow.com/questions/56369953/how-can-i-split-a-list-of-comma-separated-words-in-a-pandas-column", "title": "How can I split a list of comma separated words in a Pandas column?", "body": "<p>I was querying Stackoverflow to get some data (<a href=\"https://data.stackexchange.com/stackoverflow/query/new\" rel=\"nofollow noreferrer\">https://data.stackexchange.com/stackoverflow/query/new</a>), and I have a data frame with Tags as a column. The tags originally were of the form</p>\n\n<pre><code>&lt;html&gt;&lt;css&gt;\n</code></pre>\n\n<p>I managed to get them in the form of</p>\n\n<pre><code>html,css\n</code></pre>\n\n<p>I think an image of my Jupyter notebook can display it best:\n<a href=\"https://i.stack.imgur.com/JxCDL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JxCDL.png\" alt=\"Jupyter notebook row\"></a></p>\n\n<p>How can I separate the tags so that they can become categorical variables, and I can transform them using something like get_dummies?\nEverything I've seen refers to actual lists, like [html,css], rather than just comma separated words.</p>\n"}, {"tags": ["python", "tensorflow", "dataset", "tensorflow-datasets", "tensorflow2.0"], "answers": [{"tags": [], "owner": {"reputation": 11416, "user_id": 2455494, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OZBRx.jpg?s=128&g=1", "display_name": "Stewart_R", "link": "https://stackoverflow.com/users/2455494/stewart-r"}, "is_accepted": true, "score": 3, "last_activity_date": 1559199565, "creation_date": 1559199565, "answer_id": 56373256, "question_id": 56369900, "link": "https://stackoverflow.com/questions/56369900/in-tensorflow-2-0-how-can-i-see-the-number-of-elements-in-a-dataset/56373256#56373256", "title": "In TensorFlow 2.0, how can I see the number of elements in a dataset?", "body": "<p>If it's possible to know the length then you could use:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>tf.data.experimental.cardinality(dataset)\n</code></pre>\n\n<p>but the problem is that a TF dataset is inherently lazily loaded. So we might not know the size of the dataset up front. Indeed, it's perfectly possible to have a dataset represent an infinite set of data!</p>\n\n<p>If it is a small enough dataset you could also just iterate over it to get the length. I've used the following ugly little construct before but it depends on the dataset being small enough for us to be happy to load into memory and it's really not an improvement over your <code>for</code> loop above! </p>\n\n<pre class=\"lang-py prettyprint-override\"><code>dataset_length = [i for i,_ in enumerate(dataset)][-1] + 1\n</code></pre>\n"}], "owner": {"reputation": 5303, "user_id": 2191236, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2AlZn.jpg?s=128&g=1", "display_name": "Vahid Mirjalili", "link": "https://stackoverflow.com/users/2191236/vahid-mirjalili"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1809, "favorite_count": 0, "accepted_answer_id": 56373256, "answer_count": 1, "score": 3, "last_activity_date": 1559201176, "creation_date": 1559173537, "last_edit_date": 1559201176, "question_id": 56369900, "link": "https://stackoverflow.com/questions/56369900/in-tensorflow-2-0-how-can-i-see-the-number-of-elements-in-a-dataset", "title": "In TensorFlow 2.0, how can I see the number of elements in a dataset?", "body": "<p>When I load a dataset, I wonder if there is any quick way to find the number of samples or batches in that dataset. I know that if I load a dataset with <code>with_info=True</code>, I can see for example <code>total_num_examples=6000,</code> but this information is not available if I split a dataset. </p>\n\n<p>Currently, I count the number of samples as follows, but wondering if there is any better solution:</p>\n\n<pre><code>train_subsplit_1, train_subsplit_2, train_subsplit_3 = tfds.Split.TRAIN.subsplit(3)\n\ncifar10_trainsub3 = tfds.load(\"cifar10\", split=train_subsplit_3)\n\ncifar10_trainsub3 = cifar10_trainsub3.batch(1000)\n\nn = 0\nfor i, batch in enumerate(cifar10_trainsub3.take(-1)):\n    print(i, n, batch['image'].shape)\n    n += len(batch['image'])\n\nprint(i, n)\n</code></pre>\n"}, {"tags": ["python", "python-3.x", "oop"], "comments": [{"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1559173563, "post_id": 56369881, "comment_id": 99342241, "body": "Can you take a step back and explain why you want to do that? What&#39;s the problem with it?"}, {"owner": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 2, "creation_date": 1559174136, "post_id": 56369881, "comment_id": 99342363, "body": "This is how it <b>always works</b> in Python. variables, rather attributes in this case, don&#39;t exist <i>until you assign to them</i>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 0, "creation_date": 1559174449, "post_id": 56369881, "comment_id": 99342429, "body": "@juanpa.arrivillaga I suspect what they really want is to prevent code outside the class from creating new attributes."}, {"owner": {"reputation": 57, "user_id": 11575478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c1291d91f22454a8a7097bf3bbd66fc?s=128&d=identicon&r=PG&f=1", "display_name": "Vivek.N", "link": "https://stackoverflow.com/users/11575478/vivek-n"}, "reply_to_user": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 0, "creation_date": 1559174580, "post_id": 56369881, "comment_id": 99342467, "body": "@juanpa.arrivillaga - The behavior is same even if I initialize other instance attributes through __init__() method and set undefined variables like in my example. If Python allows us to use undefined attributes w.r.t. a custom class, then how does it supports encapsulation? Kindly clarify."}, {"owner": {"reputation": 16300, "user_id": 11015427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JsY7F.jpg?s=128&g=1", "display_name": "gmds", "link": "https://stackoverflow.com/users/11015427/gmds"}, "edited": false, "score": 0, "creation_date": 1559174649, "post_id": 56369881, "comment_id": 99342478, "body": "@VivekN Python is built on the philosophy that we&#39;re all consenting adults here. You don&#39;t prevent people from doing potentially scary things; you tell them the situations that your class is meant to handle, and if they want to poke around in its internals and possibly cause chaos, that&#39;s on them. Even the <code>__slots__</code> method, which I mentioned in my answer, has the primary objective of <i>saving memory</i>."}, {"owner": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 0, "creation_date": 1559174779, "post_id": 56369881, "comment_id": 99342508, "body": "@VivekN <code>__init__</code> holds no special status. It works <i>exactly the same way in <code>__init__</code></i>. If by &quot;encapsulation&quot; you mean access modifiers, Python doesn&#39;t support that. Of course, it does support encapsulation in the broader sense of &quot;bundling data with the operations that operate on that data&quot;."}, {"owner": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1559175099, "post_id": 56369881, "comment_id": 99342566, "body": "@Barmar well, there probably is not way to accomplish that which isn&#39;t overwrought and probably will be easily subvertable anyway."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 0, "creation_date": 1559175205, "post_id": 56369881, "comment_id": 99342585, "body": "@juanpa.arrivillaga What about the <code>__slots__</code> solution in the answer? It seems to be exactly what the OP asked for. It might be subvertible, but it should prevent inadvertent attribute creation."}, {"owner": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1559175235, "post_id": 56369881, "comment_id": 99342593, "body": "@Barmar you can still assign outside the class with <code>__slots__</code> as well. I tend to use slots to prevent <i>accidental</i> errors, like <code>obj.mt_var = &lt;something&gt;</code> instead of <code>obj.my_var = &lt;something&gt;</code>, although, ever since I started using <code>mypy</code> i&#39;ve not needed that. Generally, I simply avoid interfaces that would require you to do that in the first place. So <code>my_obj.attribute = whatever</code> <i>always</i> looks wrong :)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1559175311, "post_id": 56369881, "comment_id": 99342614, "body": "So the answer is wrong? Usually the purpose of this kind of thing is to catch typos, not to prevent deliberate code."}, {"owner": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1559175360, "post_id": 56369881, "comment_id": 99342621, "body": "@Barmar I would say the question is poorly specified. I can see how your interpretation makes sense, but as it stands, the question is vague"}, {"owner": {"reputation": 57, "user_id": 11575478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c1291d91f22454a8a7097bf3bbd66fc?s=128&d=identicon&r=PG&f=1", "display_name": "Vivek.N", "link": "https://stackoverflow.com/users/11575478/vivek-n"}, "reply_to_user": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 0, "creation_date": 1559176184, "post_id": 56369881, "comment_id": 99342775, "body": "@juanpa.arrivillaga - The answer from Barmar is useful. Between I am not sure what is vague in the question as below?                                                             How do we restrict users from setting undefined instance and class variables in Python. Here, how does Python treat these undefined variables (undefined_variable_1 and undefined_variable_2)? Are these treated as instance variable or class variable or something else?"}, {"owner": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 0, "creation_date": 1559178061, "post_id": 56369881, "comment_id": 99343119, "body": "@Vivek.N because, <b>in Python you always set an attribute that isn&#39;t defined</b>. You must mean something like &quot;how to prevent setting an attribute that isn&#39;t defined in the class definition statement&quot; or &quot;how to prevent the setting of attribute outside a specified range of names&quot;. Because, again, variables (attributes) do <i>not exist until they are assigned to</i>. Python does not have variable declarations."}], "answers": [{"comments": [{"owner": {"reputation": 16300, "user_id": 11015427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JsY7F.jpg?s=128&g=1", "display_name": "gmds", "link": "https://stackoverflow.com/users/11015427/gmds"}, "reply_to_user": {"reputation": 57, "user_id": 11575478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c1291d91f22454a8a7097bf3bbd66fc?s=128&d=identicon&r=PG&f=1", "display_name": "Vivek.N", "link": "https://stackoverflow.com/users/11575478/vivek-n"}, "edited": false, "score": 0, "creation_date": 1559175825, "post_id": 56370005, "comment_id": 99342706, "body": "@VivekN Yes, I noted that in my answer. You need a custom metaclass for that, which I have provided an example of."}], "tags": [], "owner": {"reputation": 16300, "user_id": 11015427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JsY7F.jpg?s=128&g=1", "display_name": "gmds", "link": "https://stackoverflow.com/users/11015427/gmds"}, "is_accepted": true, "score": 1, "last_activity_date": 1559174412, "creation_date": 1559174412, "answer_id": 56370005, "question_id": 56369881, "link": "https://stackoverflow.com/questions/56369881/how-to-restrict-the-access-to-undefined-class-instance-variable/56370005#56370005", "title": "How to restrict the access to undefined class/instance variable?", "body": "<p>For this purpose, you can set <code>__slots__</code>, which constrains the attributes that an instance of a class can have:</p>\n\n<pre><code>class Restricted:\n\n    __slots__ = ('a', 'b')\n\nr = Restricted()\nr.a = 1  # okay\nr.b = 2  # okay\nr.c = 3  # error\n</code></pre>\n\n<p>If you want to have the same functionality for the <em>class object</em>, you can create a custom metaclass and override <code>__setattr__</code>:</p>\n\n<pre><code>class RestrictedMeta(type):\n\n    def __setattr__(self, attr, value):\n        if attr in ('a', 'b'):\n            super().__setattr__(attr, value)\n\n        else:\n            raise TypeError(f\"Can't assign to attribute '{attr}' of class 'Restricted'\")\n\nclass Restricted(metaclass=RestrictedMeta):\n    pass\n\nRestricted.a = 1  # okay\nRestricted.b = 2  # okay\nRestricted.c = 3  # error\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 11575478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c1291d91f22454a8a7097bf3bbd66fc?s=128&d=identicon&r=PG&f=1", "display_name": "Vivek.N", "link": "https://stackoverflow.com/users/11575478/vivek-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 56370005, "answer_count": 1, "score": 2, "last_activity_date": 1559174681, "creation_date": 1559173380, "last_edit_date": 1559174681, "question_id": 56369881, "link": "https://stackoverflow.com/questions/56369881/how-to-restrict-the-access-to-undefined-class-instance-variable", "title": "How to restrict the access to undefined class/instance variable?", "body": "<p>Python allowing access to undefined class/instance variable</p>\n\n<p>I have defined a simple/empty python class as below. Now if I set a value for an undefined variable either with an instance variable or with class name, Python freely allows me to set the value for undefined variable and also allows me to access it like a instance or class variable without throwing any error. So in a nut shell, I am able to set undefined instance &amp; class variables without any issues. </p>\n\n<ol>\n<li><p>How do we restrict users from setting undefined instance and class variables in Python.</p></li>\n<li><p>Here, how does Python treat these undefined variables (<code>undefined_variable_1</code> and <code>undefined_variable_2</code>)? Are these treated as instance variable or class variable or something else?</p></li>\n</ol>\n\n<pre><code>class Test:\n\n  pass\n\n### #Now instantiate the class and try setting &amp; it accessing undefined variables\nt1 = Test()\n\nt1.undefined_variable_1 = \"Undefined class/instance variable being set through instance variable (t1)\"\n\n### #Access the undefined variable through instance variable\nprint(t1.undefined_variable_1) \n\nTest.undefined_variable_2 = \"Undefined class/instance variable being set through Class name (Test)\"\n\n### #Access the undefined variable through Class name\nprint(Test.undefined_variable_2) \n</code></pre>\n\n<p>How do we restrict user from setting/accessing undefined instance/instance variable?</p>\n"}, {"tags": ["python", "pyspark", "pyspark-sql", "snowflake-cloud-data-platform"], "answers": [{"tags": [], "owner": {"reputation": 567, "user_id": 12127815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/762d18061b0286ebfdd1145be4c9ce9a?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel McGuigan", "link": "https://stackoverflow.com/users/12127815/rachel-mcguigan"}, "is_accepted": false, "score": 0, "last_activity_date": 1571433813, "creation_date": 1571433813, "answer_id": 58458384, "question_id": 56369850, "link": "https://stackoverflow.com/questions/56369850/customize-data-type-mapping-from-snowflake-using-the-spark-connector/58458384#58458384", "title": "Customize data type mapping from snowflake using the spark connector", "body": "<p>I hope that you are well, I think you may be looking for the columnmapping parameter. I am not an expert at this though, so I am just going to share the research I found. </p>\n\n<p>Specifically for  Spark table to a Snowflake table\n<a href=\"https://docs.snowflake.net/manuals/user-guide/spark-connector-overview.html#column-mapping\" rel=\"nofollow noreferrer\">https://docs.snowflake.net/manuals/user-guide/spark-connector-overview.html#column-mapping</a></p>\n\n<p>For snowflake ARRAY to spark MapType:\nIs the object stored as an array in a Snowflake table? \nIs this what you were looking for? <a href=\"https://sparkbyexamples.com/spark/spark-sql-map-functions/\" rel=\"nofollow noreferrer\">https://sparkbyexamples.com/spark/spark-sql-map-functions/</a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 12241219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf66ff2fe25a663c00ebe3c6ca6f6e0?s=128&d=identicon&r=PG&f=1", "display_name": "Raymond", "link": "https://stackoverflow.com/users/12241219/raymond"}, "is_accepted": false, "score": 0, "last_activity_date": 1571447389, "creation_date": 1571447389, "answer_id": 58459715, "question_id": 56369850, "link": "https://stackoverflow.com/questions/56369850/customize-data-type-mapping-from-snowflake-using-the-spark-connector/58459715#58459715", "title": "Customize data type mapping from snowflake using the spark connector", "body": "<p>The \"column-mapping\" is used to map column name not column type. For snowflake VARIANT/ARRAY/OBJECT column, JSON string is returned. It should be possible to convert the JSON string to a MapType by an UDF.</p>\n"}], "owner": {"reputation": 1708, "user_id": 5839007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/PJm6v.jpg?s=128&g=1", "display_name": "Anna", "link": "https://stackoverflow.com/users/5839007/anna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 542, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1575914481, "creation_date": 1559173146, "last_edit_date": 1575914481, "question_id": 56369850, "link": "https://stackoverflow.com/questions/56369850/customize-data-type-mapping-from-snowflake-using-the-spark-connector", "title": "Customize data type mapping from snowflake using the spark connector", "body": "<p>When copying a table from snowflake using the snowflake spark connector, the default behavior is to map structured data to spark strings: <a href=\"https://docs.snowflake.net/manuals/user-guide/spark-connector-use.html#from-snowflake-to-spark-sql\" rel=\"nofollow noreferrer\">https://docs.snowflake.net/manuals/user-guide/spark-connector-use.html#from-snowflake-to-spark-sql</a></p>\n\n<p>For example, given a table in snowflake:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>create table schema.table as \nselect \n    array_construct('1','a') as array_col,\n    object_construct('1','a') as obj_col\n</code></pre>\n\n<p>And copying this in pyspark</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>df = snowflake.sql_context.read.format(\"snowflake url\")\\\n    .options(**snowflake_options)\\\n    .load()\n</code></pre>\n\n<p>results in the dataframe:</p>\n\n<pre><code>&gt; df: pyspark.sql.dataframe.DataFrame\n&gt;   ARRAY_COL:string\n&gt;   OBJ_COL:string\n</code></pre>\n\n<p>Is there currently a way to override this default behavior within the connector to map snowflake <code>OBJECT</code> to spark <code>StructType</code> and/or snowflake <code>ARRAY</code> to spark <code>MapType</code>?</p>\n"}, {"tags": ["python", "pandas", "numpy"], "comments": [{"owner": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 3, "creation_date": 1559173194, "post_id": 56369835, "comment_id": 99342166, "body": "<code>nan</code>&#39;s essentially break the contract for hashing: they are never equal to themselves, but they hash to the same value. Note: <code>float(&#39;nan&#39;) == float(&#39;nan&#39;)</code> will always be false. This leads to weird behavior in hashmaps (<code>dict</code> objects) and hash sets, (<code>set</code> objects)."}, {"owner": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 0, "creation_date": 1559173411, "post_id": 56369835, "comment_id": 99342212, "body": "The first case likely has to do with there being a quick object identity test involved in sets (check if identity is the same since that&#39;s cheap, if identical, then assume equality, else, check equality which is potentially expensive). When you just use <code>np.nan</code> three times in a list, that is three references to the same object. When you put those into a series, it creates a <code>numpy</code> array of <code>float64</code> dtype, and when you iterate over it again, it produces 3 distinct <code>nan</code> <code>float</code> objects"}, {"owner": {"reputation": 16300, "user_id": 11015427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JsY7F.jpg?s=128&g=1", "display_name": "gmds", "link": "https://stackoverflow.com/users/11015427/gmds"}, "reply_to_user": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 0, "creation_date": 1559173505, "post_id": 56369835, "comment_id": 99342231, "body": "@juanpa.arrivillaga <code>float(&#39;nan&#39;)</code> produces the 2nd case. Pretty weird."}, {"owner": {"reputation": 173469, "user_id": 901925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bbd70aaeb3a97d0087daf93c2be8804?s=128&d=identicon&r=PG", "display_name": "hpaulj", "link": "https://stackoverflow.com/users/901925/hpaulj"}, "edited": false, "score": 0, "creation_date": 1559173884, "post_id": 56369835, "comment_id": 99342314, "body": "Similar question on <code>nan</code> and <code>set</code> from 4 days ago: <a href=\"https://stackoverflow.com/questions/56290015/inconsistent-behavior-of-nans-in-python-numpy-pandas\" title=\"inconsistent behavior of nans in python numpy pandas\">stackoverflow.com/questions/56290015/&hellip;</a>"}, {"owner": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "reply_to_user": {"reputation": 16300, "user_id": 11015427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JsY7F.jpg?s=128&g=1", "display_name": "gmds", "link": "https://stackoverflow.com/users/11015427/gmds"}, "edited": false, "score": 0, "creation_date": 1559173998, "post_id": 56369835, "comment_id": 99342335, "body": "@gmds yes, because that will create a new object every time."}, {"owner": {"reputation": 39, "user_id": 6171525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/067f1b1c4c20eadb1862f0c32a1e5210?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Dunne", "link": "https://stackoverflow.com/users/6171525/michael-dunne"}, "edited": false, "score": 0, "creation_date": 1559226081, "post_id": 56369835, "comment_id": 99360495, "body": "Thanks! Interesting. For any future interested parties, this can be avoided by using df.drop_duplicates()."}], "owner": {"reputation": 39, "user_id": 6171525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/067f1b1c4c20eadb1862f0c32a1e5210?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Dunne", "link": "https://stackoverflow.com/users/6171525/michael-dunne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "closed_date": 1559174301, "answer_count": 0, "score": 2, "last_activity_date": 1559173558, "creation_date": 1559173030, "last_edit_date": 1559173558, "question_id": 56369835, "link": "https://stackoverflow.com/questions/56369835/python-sets-strange-behaviour-with-nans", "closed_reason": "Duplicate", "title": "Python sets: Strange behaviour with NaNs", "body": "<p>Can anyone explain the following strange behaviour in Python?</p>\n\n<pre><code>&gt;&gt;&gt;set([np.nan, np.nan, np.nan])\n\n{np.nan}\n</code></pre>\n\n<p>as expected, but:</p>\n\n<pre><code>&gt;&gt;&gt;set(pd.Series([np.nan, np.nan, np.nan]))\n\n{np.nan, np.nan, np.nan}\n</code></pre>\n\n<p>They're all just floats:</p>\n\n<pre><code>&gt;&gt;&gt;[type(a) for a in set(pd.Series([np.nan, np.nan, np.nan]))]\n\n[float, float, float]\n</code></pre>\n\n<p>How can this set have three objects that are the same?</p>\n\n<p>Versions:</p>\n\n<ul>\n<li>Python 3.7.0 (default, Jun 28 2018, 08:04:48) [MSC v.1912 64 bit (AMD64)]</li>\n<li>NumPy 1.15.1</li>\n<li>Pandas 0.23.4</li>\n</ul>\n"}, {"tags": ["python", "python-3.x", "logging"], "answers": [{"tags": [], "owner": {"reputation": 3465, "user_id": 803194, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/517b0b537f276b8dcf84c55ed078035a?s=128&d=identicon&r=PG", "display_name": "blues", "link": "https://stackoverflow.com/users/803194/blues"}, "is_accepted": false, "score": 0, "last_activity_date": 1560865132, "creation_date": 1560865132, "answer_id": 56650528, "question_id": 56369816, "link": "https://stackoverflow.com/questions/56369816/python-logging-setting-multiple-loggers-and-switching-between-them/56650528#56650528", "title": "python logging setting multiple loggers and switching between them", "body": "<p>That happens because your <code>initiate_logger</code> function always returns the root logger since it calls getlogger without a name. See the <a href=\"https://docs.python.org/3/library/logging.html#logging.getLogger\" rel=\"nofollow noreferrer\">documentation</a>. What you need to do is give each of them a different name if you want them to be different logger instances. for example <code>logger = logging.getLogger(log_file_name)</code> would work in your code. I would recomment using <a href=\"https://docs.python.org/3/library/logging.html#filter-objects\" rel=\"nofollow noreferrer\">filters</a> instead though.</p>\n"}], "owner": {"reputation": 793, "user_id": 4023639, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ae7123735893bcaa02daacdd7bb2d991?s=128&d=identicon&r=PG", "display_name": "user32147", "link": "https://stackoverflow.com/users/4023639/user32147"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560865132, "creation_date": 1559172889, "question_id": 56369816, "link": "https://stackoverflow.com/questions/56369816/python-logging-setting-multiple-loggers-and-switching-between-them", "title": "python logging setting multiple loggers and switching between them", "body": "<p>I have a program with a loop, and I would like to set up a main logger which logs information from the whole program. I would like to set up a different logger inside a loop  (I will call this a 'logger_instance' going forward) for each loop instance. The main logger also needs to be able to log some information within a loop.  </p>\n\n<p>The issue with my current code is the following: once I initialize a logger_instance inside a loop, the information that I intended to log to the main logger gets logged to the logger_instance instead of the main logger.</p>\n\n<p>Below is the sample code:</p>\n\n<pre><code>class DispatchingFormatter:\n\"\"\"\nThis allows to create several formatter objects with desired formats so that logging outputs can take different\nformats\n\"\"\"\n    def __init__(self, formatters, default_formatter):\n        self._formatters = formatters\n        self._default_formatter = default_formatter\n\n    def format(self, record):\n        formatter_obj = self._formatters.get(record.name, self._default_formatter)\n        return formatter_obj.format(record)\n\ndef initiate_logger(log_file_name):\n\n    # Set logging to display INFO level or above\n    logging.basicConfig(level=logging.INFO)\n\n    # First empty out list of handlers to remove the default handler created by the running basicConfig above\n    # logging.getLogger().handlers.clear()\n    logger = logging.getLogger()\n    logger.handlers.clear()\n    # logger = logging.getLogger().handlers.clear()\n\n    # Set up formatter objects\n    formatter_obj = DispatchingFormatter(\n    # Custom formats - add new desired formats here\n    {\n        # This format allows to print the user and the time - use this log format at the start of the execution\n        'start_log': logging.Formatter('\\n%(levelname)s - %(message)s executed the pipeline at %(asctime)s',\n                                       datefmt='%Y-%m-%d %H:%M:%S'),\n        # This format allows to print the time - use this log format at the end of the execution\n        'end_log': logging.Formatter('\\n%(levelname)s - pipeline execution completed at %(asctime)s',\n                                     datefmt='%Y-%m-%d %H:%M:%S'),\n        # This format allows to print the duration - use this log format at the end of the execution\n        'duration_log': logging.Formatter('\\n%(levelname)s - total time elapsed: %(message)s minutes'),\n        # This is the format of warning messages\n        'warning_log': logging.Formatter('\\n\\t\\t%(levelname)s - %(message)s'),\n        # This is the format of error messages (\n        'error_log': logging.Formatter('\\n%(levelname)s! [%(filename)s:line %(lineno)s - %(funcName)20s()] - '\n                                       'Pipeline terminating!\\n\\t%(message)s')\n    },\n        # Default format - this default is used to print all ESN outputs\n        logging.Formatter('%(message)s'),\n    )\n\n    # Log to console (stdout)\n    c_handler = logging.StreamHandler()\n    c_handler.setFormatter(formatter_obj)\n    # logging.getLogger().addHandler(c_handler)\n    logger.addHandler(c_handler)\n\n    # Log to file in runs folder\n    f_handler = logging.FileHandler(log_file_name, 'w+')\n    f_handler.setFormatter(formatter_obj)\n    # logging.getLogger().addHandler(f_handler)\n\n    logger.addHandler(f_handler)\n\n    # Log user and start time information upon creating the logger\n    logging.getLogger('start_log').info(f'{getpass.getuser()}')\n\n    return logger\n\nif __name__ == '__main__':\n    # Test logging\n\n    # Initial main logger for outside the loop\n    logger_main = initiate_logger('log_main.txt')\n    logger_main.info(f'Started the main logging')\n\n    for i in range(5):\n        # Create logger in a loop\n        this_logger = initiate_logger(f'log_{str(i)}.txt')\n        this_logger.info(f'Logging in a loop - loop #{str(i)}')\n\n        # Log some information to main logger\n        logger_main.info(f'Something happened in loop #{str(i)}')\n\n    # Log more information to main logger after the loop\n    logger_main.info(f'Loop completed!')\n</code></pre>\n\n<p>log_main.txt contains</p>\n\n<pre><code>INFO - this_user executed the pipeline at 2019-05-29 19:15:47\nStarted the main logging\n</code></pre>\n\n<p>log_0.txt contains</p>\n\n<pre><code>INFO - lqk4061 executed the pipeline at 2019-05-29 19:15:47\nLogging in a loop - loop #0\nSomething happened in loop #0\n</code></pre>\n\n<p>Desired output for log_main.txt should be</p>\n\n<pre><code>INFO - this_user executed the pipeline at 2019-05-29 19:15:47\nStarted the main logging\nSomething happened in loop #0\nSomething happened in loop #1\nSomething happened in loop #2\nSomething happened in loop #3\nSomething happened in loop #4\nLoop completed!\n</code></pre>\n\n<p>Desired output for log_0.txt should be</p>\n\n<pre><code>INFO - lqk4061 executed the pipeline at 2019-05-29 19:15:47\nLogging in a loop - loop #0\n</code></pre>\n\n<p>Any help will be greatly appreciated!</p>\n"}, {"tags": ["python", "python-3.7"], "answers": [{"tags": [], "owner": {"reputation": 12117, "user_id": 2745495, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5bbcd267235bab78ec6710ef6654ba87?s=128&d=identicon&r=PG", "display_name": "Gino Mempin", "link": "https://stackoverflow.com/users/2745495/gino-mempin"}, "is_accepted": false, "score": 0, "last_activity_date": 1559178983, "last_edit_date": 1559178983, "creation_date": 1559178271, "answer_id": 56370358, "question_id": 56369781, "link": "https://stackoverflow.com/questions/56369781/matching-user-s-input-with-nested-dictionary-in-python3-7/56370358#56370358", "title": "Matching User &#39;s Input With Nested Dictionary in Python3.7", "body": "<p>You don't need to loop through the dictionary. </p>\n\n<p>You can instead use <a href=\"https://docs.python.org/3/library/stdtypes.html#dict.get\" rel=\"nofollow noreferrer\">get(key, default)</a> to get the entry from the <code>driver_license</code> dictionary using the input license number as the key.  You can then set <code>default</code> to some value to handle the case where the key is not in the <code>dict</code> (here I used <code>None</code>).</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>driver_license = {\n    \"42456\" : {'name': 'jill', 'ethnicity': 'hispanic','eye': 'yellow' ,'height': '6.1'},\n    \"44768\" : {'name': 'cheroky', 'ethnicity': 'native','eye': 'green' ,'height': '6.7'},\n    \"32565\" : {'name': 'valentina', 'ethnicity': 'european','eye': 'fair','height': '4.9'}\n}\n\nid_num = input('Enter your driving license number: ')\n# if user enters \"32565\"\n\nid_info = driver_license.get(id_num, None)  \n# id_info would be:\n#    {'name': 'valentina', 'ethnicity': 'european','eye': 'fair','height': '4.9'}\n\nif id_info:\n    print(f'\\nId number is:{id_num }')\n    print(f'Name: {id_info[\"name\"]}')\n    print(f'Ethnicity: {id_info[\"ethnicity\"]}')\n    print(f'Eyes color: {id_info[\"eye\"]}')\n    print(f'Height: {id_info[\"height\"]}\\n')\nelse:\n    print('Invalid ID')\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 6939487, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XEHqM0xa1fU/AAAAAAAAAAI/AAAAAAAACa0/odrHkbhc1WQ/photo.jpg?sz=128", "display_name": "B.M. Dunn", "link": "https://stackoverflow.com/users/6939487/b-m-dunn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559178983, "creation_date": 1559172552, "last_edit_date": 1559178721, "question_id": 56369781, "link": "https://stackoverflow.com/questions/56369781/matching-user-s-input-with-nested-dictionary-in-python3-7", "title": "Matching User &#39;s Input With Nested Dictionary in Python3.7", "body": "<p>I cannot seem to match the user <code>input(num)</code> to <code>id_num</code> to print out the individual license info. I want that when the user is prompted to enter the license number, the code should loop through the dictionary and find its match and print the info that matches the input.</p>\n\n<p>I tried:</p>\n\n<ol>\n<li>if num in driver_license[id_num]:</li>\n<li>if num==id_num:</li>\n<li>if num==int(id_num):</li>\n</ol>\n\n<pre class=\"lang-py prettyprint-override\"><code>42456 :{'name': 'jill', 'ethnicity': 'hispanic','eye': 'yellow' ,'height': '6.1'},\n\n44768 :{'name': 'cheroky', 'ethnicity': 'native','eye': 'green' ,'height': '6.7'},\n\n32565 :{'name': 'valentina', 'ethnicity': 'european','eye': 'fair','height': '4.9'}}\n\n\nprint('\\n')\nprint('- ' *45)\n\n\nfor id_num, id_info in driver_license.items():\n    num = int(input('Enter your driving license number: '))\n\n    print(f\"Id number: {id_num}\")\n    name=f\"{id_info['name']}\"\n    origin= f\"{id_info ['ethnicity']}\"\n    eye= f\"{id_info['eye']}\"\n    height=f\"{id_info['height']}\"\n\n    if num in driver_license[id_num]:\n        print(f'\\nId number is:{num}')\n        print(f'Name: {name}')\n        print(f'Ethnicity: {origin}')\n        print(f'Eyes color: {eye}')\n        print(f'Height: {height}\\n')\n    else:\n        print('Invalid ID')\n</code></pre>\n\n<p>There is no error but a mismatch of output than expected.</p>\n"}, {"tags": ["python", "pandas"], "comments": [{"owner": {"reputation": 2751, "user_id": 3233017, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2568656c29f0bc7e84480eb0227a304b?s=128&d=identicon&r=PG", "display_name": "Draconis", "link": "https://stackoverflow.com/users/3233017/draconis"}, "edited": false, "score": 1, "creation_date": 1559172486, "post_id": 56369760, "comment_id": 99342027, "body": "Look into the &quot;Knapsack Problem&quot;"}, {"owner": {"reputation": 878, "user_id": 2445273, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7CgrG.jpg?s=128&g=1", "display_name": "LoMaPh", "link": "https://stackoverflow.com/users/2445273/lomaph"}, "edited": false, "score": 0, "creation_date": 1559173997, "post_id": 56369760, "comment_id": 99342334, "body": "If the number of rows is not too big, you can brute-force it. For <code>n</code> rows there are <code>2^n</code> subsets which you need to calculate the sum."}, {"owner": {"reputation": 301, "user_id": 8561057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vQNO9.jpg?s=128&g=1", "display_name": "seanswe", "link": "https://stackoverflow.com/users/8561057/seanswe"}, "edited": false, "score": 0, "creation_date": 1559174750, "post_id": 56369760, "comment_id": 99342499, "body": "Check out the recipe for <i>powerset</i> in the <a href=\"https://docs.python.org/3/library/itertools.html#module-itertools\" rel=\"nofollow noreferrer\">itertools</a> docs. It uses <a href=\"https://docs.python.org/3/library/itertools.html#itertools.chain\" rel=\"nofollow noreferrer\">chain</a> and <a href=\"https://docs.python.org/3/library/itertools.html#itertools.combinations\" rel=\"nofollow noreferrer\">combinations</a>."}], "answers": [{"tags": [], "owner": {"reputation": 156, "user_id": 5684634, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WpEc3etKNjU/AAAAAAAAAAI/AAAAAAAAAAA/VyPSXdC9p2o/photo.jpg?sz=128", "display_name": "Vasu Devan", "link": "https://stackoverflow.com/users/5684634/vasu-devan"}, "is_accepted": true, "score": 0, "last_activity_date": 1559175104, "creation_date": 1559175104, "answer_id": 56370071, "question_id": 56369760, "link": "https://stackoverflow.com/questions/56369760/list-all-possible-combinations-of-pandas-dataframe-values-to-reach-a-certain-sum/56370071#56370071", "title": "List all possible combinations of pandas dataframe values to reach a certain sum", "body": "<p>Since you mentioned \"all combinations\", I think you are not looking at one optimal solution. The only possibility would be to brute-force and generate all combinations of parties and choose the ones that have a sum greater than 51.</p>\n\n<p>Here is one way of doing it.</p>\n\n<pre><code>import pandas as pd\nimport numpy as np\nimport itertools\n\n# Data Generation\nalphabets = [chr(i) for i in range(ord('a'),ord('z')+1)]\nparty_size = 6\nseats = 51\ndf = pd.DataFrame(np.random.randint(20,100,party_size), index=alphabets[:party_size])\n\n#Algo\nparties = df.index\na = []\nfor r in range(parties.shape[0]): # Generate combinations\n    ls = list(itertools.combinations(parties, r))\n    ls1 = [inx for inx in ls if df.loc[inx,:].sum()[0] &gt; seats] # Choose only what qualifies\n    a.extend(ls1) # Generate master list\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11575424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed49b18bfaf246fa7399ba72457693fa?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Cranston", "link": "https://stackoverflow.com/users/11575424/alex-cranston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1313, "favorite_count": 1, "accepted_answer_id": 56370071, "answer_count": 1, "score": 1, "last_activity_date": 1559175104, "creation_date": 1559172388, "last_edit_date": 1559173470, "question_id": 56369760, "link": "https://stackoverflow.com/questions/56369760/list-all-possible-combinations-of-pandas-dataframe-values-to-reach-a-certain-sum", "title": "List all possible combinations of pandas dataframe values to reach a certain sum", "body": "<p>I have a pandas dataframe that looks like this:</p>\n\n<pre><code>party seats\nA      34\nB      26\nC      19\nD      12\nE      10\n</code></pre>\n\n<p>There are always 101 seats in total. I need to get a list of all possible combinations of parties, which have 51 or more seats together.</p>\n\n<p>For instance, </p>\n\n<pre><code>[A, B]\n[A, C]\n[A, B, C]\n[A, B, D]\n...\n[A, B, C, D, E]\n</code></pre>\n\n<p>or something like this. Any help or tips would be much appreciated.</p>\n"}, {"tags": ["python", "neural-network", "pytorch", "control-flow", "deep-residual-networks"], "comments": [{"owner": {"reputation": 113, "user_id": 3029296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643165470c67dd8cc1263fe39d4867c7?s=128&d=identicon&r=PG&f=1", "display_name": "user3029296", "link": "https://stackoverflow.com/users/3029296/user3029296"}, "edited": false, "score": 0, "creation_date": 1559172526, "post_id": 56369748, "comment_id": 99342037, "body": "heres the base version of the xception network im modifying. <a href=\"https://github.com/Cadene/pretrained-models.pytorch/blob/master/pretrainedmodels/models/xception.py\" rel=\"nofollow noreferrer\">github.com/Cadene/pretrained-models.pytorch/blob/master/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 92303, "user_id": 1714410, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a254f486ab076ab1af26162a975e90f9?s=128&d=identicon&r=PG", "display_name": "Shai", "link": "https://stackoverflow.com/users/1714410/shai"}, "is_accepted": false, "score": 1, "last_activity_date": 1559206630, "creation_date": 1559206630, "answer_id": 56374892, "question_id": 56369748, "link": "https://stackoverflow.com/questions/56369748/pytorch-method-for-conditional-use-of-intermediate-layer-instead-of-final-cnn-la/56374892#56374892", "title": "Pytorch method for conditional use of intermediate layer instead of final cnn layer output. ie: allow nn to learn to use more layers or less", "body": "<p>It has already been done and presented in ICLR 2018.</p>\n\n<p>It appears as if in ResNets the first few bottlenecks learn representations (and therefore cannot be skipped) while the remaining bottlenecks refine the features and therefore can be skipped at a moderate loss of accuracy. (<em>Stanis\u0142aw Jastrzebski, Devansh Arpit, Nicolas Ballas, Vikas Verma, Tong Che, Yoshua Bengio</em> <a href=\"https://openreview.net/forum?id=SJa9iHgAZ\" rel=\"nofollow noreferrer\"><strong>Residual Connections Encourage Iterative Inference</strong></a>, ICLR 2018).</p>\n\n<p>This idea was taken to the extreme with <em>sharing</em> weights across bottlenecks in <em>Sam Leroux, Pavlo Molchanov, Pieter Simoens, Bart Dhoedt, Thomas Breuel, Jan Kautz</em> <a href=\"https://openreview.net/forum?id=BkG3_ykDz\" rel=\"nofollow noreferrer\"><strong>IamNN: Iterative and Adaptive Mobile Neural Network for efficient image classification</strong></a>, ICLR 2018.</p>\n"}], "owner": {"reputation": 113, "user_id": 3029296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643165470c67dd8cc1263fe39d4867c7?s=128&d=identicon&r=PG&f=1", "display_name": "user3029296", "link": "https://stackoverflow.com/users/3029296/user3029296"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559206630, "creation_date": 1559172334, "last_edit_date": 1559172793, "question_id": 56369748, "link": "https://stackoverflow.com/questions/56369748/pytorch-method-for-conditional-use-of-intermediate-layer-instead-of-final-cnn-la", "title": "Pytorch method for conditional use of intermediate layer instead of final cnn layer output. ie: allow nn to learn to use more layers or less", "body": "<p>I'm implementing a residual cnn(modified smaller version of xception) in a low latency environment. I've done a lot of manual tuning to minimize the run time speed of my network (reducing number of filters, removing layers, etc).</p>\n\n<p>But now I want to try allowing my network to make its classification prediction(final fcnn layer) on the residual connection after each residual block.</p>\n\n<p>basic logic-</p>\n\n<p>attempt final prediction with residual connection as input</p>\n\n<p>if this fcnn layer predicts a certain class with a probability > a set threshold: </p>\n\n<pre><code>return fcnn output as if it was normal final layer\n</code></pre>\n\n<p>else: </p>\n\n<pre><code>do next residual block like normal and try the previous conditional again unless we are already at final block\n</code></pre>\n\n<p><img src=\"https://i.imgur.com/nWyH6vp.png\" alt=\"basic example\"></p>\n\n<p>My hope is this will allow my network to learn to solve easier problems with less computation while allowing it to still do the additional layers if it is still unsure of the classification. </p>\n\n<p><strong>So my basic question is</strong>: In pytorch, whats the best way to implement this conditional in a way that allows my nn at run time to decide whether to do more processing or not</p>\n\n<p>Currently Ive tested returning the intermediate x's after the blocks in the forward function, but I dont know how best to setup the conditional to chose which x to return </p>\n\n<p>Also side note: I believe I may end up needing another cnn layer between the residual and fcnn to serve as a function to convert the internal representation for processing to a representation the fcnn understands for classification.</p>\n"}, {"tags": ["python", "join"], "answers": [{"tags": [], "owner": {"reputation": 301, "user_id": 8561057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vQNO9.jpg?s=128&g=1", "display_name": "seanswe", "link": "https://stackoverflow.com/users/8561057/seanswe"}, "is_accepted": true, "score": 0, "last_activity_date": 1559192696, "creation_date": 1559192696, "answer_id": 56371918, "question_id": 56369727, "link": "https://stackoverflow.com/questions/56369727/how-to-create-a-new-column-that-returns-value-from-another-table-under-certain-c/56371918#56371918", "title": "How to create a new column that returns value from another table under certain criteria in Python", "body": "<p>I'm assuming you're using pandas. </p>\n\n<p>If you have multiple transaction_amounts per account_id in data2, using <a href=\"https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html\" rel=\"nofollow noreferrer\">merge</a> is probably your best bet:</p>\n\n<pre><code>data1.merge(data2, on='account_id', how='left')\n</code></pre>\n\n<p>This will return np.nan for account_ids in data1 but not in data2. It will also return both date columns--from data1 and data2. And it will return a row for each transaction_amount per account_id. </p>\n\n<p>If there is only one transaction_amount per account_id, you can convert data2 to a dictionary and have it mapped to data1 like this:</p>\n\n<pre><code>data2_dict = data2.set_index('account_id).to_dict()['transaction_amount']\ndata1['transaction_amount'] = data1['account_id'].map(data2_dict)\n</code></pre>\n\n<p>You'll also get np.nan for account_ids in data1 but not data2.</p>\n"}], "owner": {"reputation": 153, "user_id": 8961426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e937ce61ce52c7054b75bc0697a08989?s=128&d=identicon&r=PG&f=1", "display_name": "kyle chan", "link": "https://stackoverflow.com/users/8961426/kyle-chan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "accepted_answer_id": 56371918, "answer_count": 1, "score": 0, "last_activity_date": 1559192696, "creation_date": 1559172202, "question_id": 56369727, "link": "https://stackoverflow.com/questions/56369727/how-to-create-a-new-column-that-returns-value-from-another-table-under-certain-c", "title": "How to create a new column that returns value from another table under certain criteria in Python", "body": "<p>I have two table:</p>\n\n<ul>\n<li>Account Balance</li>\n</ul>\n\n<p>It has three columns: Account_ID, Date, Balance_amount</p>\n\n<ul>\n<li>Account Transaction</li>\n</ul>\n\n<p>It has three columns: Account_ID, date, transaction_amount</p>\n\n<p>These two stables have different rows, and not every account has transaction amount. so i want to create a new column in Account Balance table called transaction_amount that returns transaction_amount if that account is shown in account transaction table otherwise return 0. \nI tried this<code>np.where(data1.account_id.isin(data2._account_id), data2.amount,0)</code>\nbut it says<code>operands could not be broadcast together with shapes (123171,) (668306,) ()</code>\nHow can i solve this in Python?</p>\n"}, {"tags": ["python", "python-3.x", "selenium"], "comments": [{"owner": {"reputation": 1482, "user_id": 10446484, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DPJNPwHB7j0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV7oUQVhckzmNOxsNU7IvVVMLlZ3Q/mo/photo.jpg?sz=128", "display_name": "Nic Laforge", "link": "https://stackoverflow.com/users/10446484/nic-laforge"}, "edited": false, "score": 0, "creation_date": 1559182312, "post_id": 56369719, "comment_id": 99343929, "body": "It is blocking at the alert (I have tried to switch to it without any luck), could you check this solution <a href=\"https://stackoverflow.com/questions/11522434/how-to-handle-login-pop-up-window-using-selenium-webdriver\" title=\"how to handle login pop up window using selenium webdriver\">stackoverflow.com/questions/11522434/&hellip;</a>."}, {"owner": {"reputation": 1482, "user_id": 10446484, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DPJNPwHB7j0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV7oUQVhckzmNOxsNU7IvVVMLlZ3Q/mo/photo.jpg?sz=128", "display_name": "Nic Laforge", "link": "https://stackoverflow.com/users/10446484/nic-laforge"}, "edited": false, "score": 0, "creation_date": 1559184301, "post_id": 56369719, "comment_id": 99344276, "body": "Suggestion in the link is to bypass the login page/ authentication pop-up. Use <code>driver.get(&quot;https:&#47;&#47;username:password@yourUrl&quot;)</code>. yourUrl is not your login page but the next one, which is the one halting the click."}, {"owner": {"reputation": 1, "user_id": 11575458, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ScxPZFBHK-s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBoeiltykniY0-S21Lu11qtqNKCA/mo/photo.jpg?sz=128", "display_name": "Was me It", "link": "https://stackoverflow.com/users/11575458/was-me-it"}, "reply_to_user": {"reputation": 1482, "user_id": 10446484, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DPJNPwHB7j0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV7oUQVhckzmNOxsNU7IvVVMLlZ3Q/mo/photo.jpg?sz=128", "display_name": "Nic Laforge", "link": "https://stackoverflow.com/users/10446484/nic-laforge"}, "edited": false, "score": 0, "creation_date": 1559184595, "post_id": 56369719, "comment_id": 99344326, "body": "It not work, because the link is not changed whether login or not,"}, {"owner": {"reputation": 1482, "user_id": 10446484, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DPJNPwHB7j0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV7oUQVhckzmNOxsNU7IvVVMLlZ3Q/mo/photo.jpg?sz=128", "display_name": "Nic Laforge", "link": "https://stackoverflow.com/users/10446484/nic-laforge"}, "edited": false, "score": 0, "creation_date": 1559184984, "post_id": 56369719, "comment_id": 99344393, "body": "Got it, this is I know issue from chromedriver: <a href=\"https://bugs.chromium.org/p/chromedriver/issues/detail?id=1917&amp;q=authentication&amp;colspec=ID%20Status%20Pri%20Owner%20Summary\" rel=\"nofollow noreferrer\">bugs.chromium.org/p/chromedriver/issues/&hellip;</a>. Can you run with FireFox? I am able to switch to the authentication pop-up."}, {"owner": {"reputation": 1, "user_id": 11575458, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ScxPZFBHK-s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBoeiltykniY0-S21Lu11qtqNKCA/mo/photo.jpg?sz=128", "display_name": "Was me It", "link": "https://stackoverflow.com/users/11575458/was-me-it"}, "reply_to_user": {"reputation": 1482, "user_id": 10446484, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DPJNPwHB7j0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV7oUQVhckzmNOxsNU7IvVVMLlZ3Q/mo/photo.jpg?sz=128", "display_name": "Nic Laforge", "link": "https://stackoverflow.com/users/10446484/nic-laforge"}, "edited": false, "score": 0, "creation_date": 1559195208, "post_id": 56369719, "comment_id": 99346494, "body": "Thanks a lot! I never thought it will be a bug"}], "owner": {"reputation": 1, "user_id": 11575458, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ScxPZFBHK-s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBoeiltykniY0-S21Lu11qtqNKCA/mo/photo.jpg?sz=128", "display_name": "Was me It", "link": "https://stackoverflow.com/users/11575458/was-me-it"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559174618, "creation_date": 1559172161, "last_edit_date": 1559174618, "question_id": 56369719, "link": "https://stackoverflow.com/questions/56369719/why-the-selenium-script-project-can-not-continue-after-click", "title": "Why the Selenium script project can not continue after click()", "body": "<p>This is my code: </p>\n\n<p><strong>myproject.py</strong></p>\n\n<pre class=\"lang-py prettyprint-override\"><code>userName.send_keys(user_name)\npassWord.send_keys(pass_word)\n\nButton.click()\n\nprint(\"1\")\n</code></pre>\n\n<p>When I do <code>Button.click()</code>, the pages can successfully JUMP but it CANNOT continue to the NEXT STEP,  even it is just a <code>print()</code> statement. </p>\n\n<p>The next page is displayed like the image below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ex43M.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ex43M.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/ozEoO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ozEoO.png\" alt=\"enter image description here\"></a></p>\n\n<p>In the next page, it has alert windows up there, and I cannot switch to it. The program gave me an error message:</p>\n\n<blockquote>\n  <p>[20120:10844:0529/150013.017:ERROR:textfield.cc(1773)] NOT IMPLEMENTED</p>\n</blockquote>\n\n<p>And I have used <code>submit()</code> too, it also did not change. I am really confused about this issue so I checked the lib of selenium:</p>\n\n<p><strong>webelement.py from Selenium</strong></p>\n\n<pre class=\"lang-py prettyprint-override\"><code>def click(self):\n    \"\"\"Clicks the element.\"\"\"\n    print(\"1\")\n    self._execute(Command.CLICK_ELEMENT)\n    print(\"2\")\n</code></pre>\n\n<p>Somehow the <code>print(\"2\")</code> cannot be printed. </p>\n\n<p>If someone knows the reason for this, I will appreciate it if you can tell me.</p>\n"}, {"tags": ["python", "django", "amazon-web-services", "amazon-ec2"], "comments": [{"owner": {"reputation": 159902, "user_id": 3297613, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/KHhzd.jpg?s=128&g=1", "display_name": "Avinash Raj", "link": "https://stackoverflow.com/users/3297613/avinash-raj"}, "edited": false, "score": 0, "creation_date": 1559172208, "post_id": 56369708, "comment_id": 99341964, "body": "Just put the data inside this <code>~&#47;.aws&#47;config</code> file. Boto3 automatically loads the config from the above mentioned file. there was nothing to do with django. put apikey and secret inside <code>~&#47;.aws&#47;credentials</code> file"}, {"owner": {"reputation": 921, "user_id": 4310155, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/100004871822797/picture?type=large", "display_name": "Abel Olguin Chavez", "link": "https://stackoverflow.com/users/4310155/abel-olguin-chavez"}, "reply_to_user": {"reputation": 159902, "user_id": 3297613, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/KHhzd.jpg?s=128&g=1", "display_name": "Avinash Raj", "link": "https://stackoverflow.com/users/3297613/avinash-raj"}, "edited": false, "score": 0, "creation_date": 1559172534, "post_id": 56369708, "comment_id": 99342039, "body": "@AvinashRaj Is there another way to set the apikey, like in python class?"}, {"owner": {"reputation": 535, "user_id": 2751680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b286497dd9682447333784f5082bce1?s=128&d=identicon&r=PG", "display_name": "Danilo Akamine", "link": "https://stackoverflow.com/users/2751680/danilo-akamine"}, "edited": false, "score": 1, "creation_date": 1559172778, "post_id": 56369708, "comment_id": 99342086, "body": "Take a look at this topic: <a href=\"https://stackoverflow.com/questions/45981950/how-to-specify-credentials-when-connecting-to-boto3-s3\" title=\"how to specify credentials when connecting to boto3 s3\">stackoverflow.com/questions/45981950/&hellip;</a>"}, {"owner": {"reputation": 921, "user_id": 4310155, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/100004871822797/picture?type=large", "display_name": "Abel Olguin Chavez", "link": "https://stackoverflow.com/users/4310155/abel-olguin-chavez"}, "edited": false, "score": 0, "creation_date": 1559172934, "post_id": 56369708, "comment_id": 99342111, "body": "Thanks a lot, excuse me for this stupid question, but i&#39;m new in python world"}], "owner": {"reputation": 921, "user_id": 4310155, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/100004871822797/picture?type=large", "display_name": "Abel Olguin Chavez", "link": "https://stackoverflow.com/users/4310155/abel-olguin-chavez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "closed_date": 1559175235, "answer_count": 0, "score": 0, "last_activity_date": 1559172027, "creation_date": 1559172027, "question_id": 56369708, "link": "https://stackoverflow.com/questions/56369708/boto3-ec2-django", "closed_reason": "Duplicate", "title": "boto3 ec2 &amp; django", "body": "<p>I'M new using django and python, i try to use aws ec2 API to create, start and stop instances in aws ec2: <a href=\"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/ec2.html#instance\" rel=\"nofollow noreferrer\">https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/ec2.html#instance</a></p>\n\n<p>I found boto3 and i think that's the solution, but i don't know how to install in django framework i try using this in a view:</p>\n\n<pre><code>import boto3 #import directly\n\nec2 = boto3.resource('ec2')\n</code></pre>\n\n<p>I think it's works but i receive the message:</p>\n\n<blockquote>\n  <p>botocore.exceptions.NoRegionError: You must specify a region.</p>\n</blockquote>\n\n<p>According to boto docs i need to set my api keys and the region: <a href=\"https://boto3.amazonaws.com/v1/documentation/api/latest/guide/quickstart.html\" rel=\"nofollow noreferrer\">https://boto3.amazonaws.com/v1/documentation/api/latest/guide/quickstart.html</a>, but where i put this data in django?</p>\n\n<p>For me this is not the best solution because I don't use INSTALLED_APPS in settings, is there a django package or a better solution to do?</p>\n"}, {"tags": ["python", "list", "collections", "iteration", "list-comprehension"], "comments": [{"owner": {"reputation": 31711, "user_id": 4932316, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OL5Si.png?s=128&g=1", "display_name": "Sheldore", "link": "https://stackoverflow.com/users/4932316/sheldore"}, "edited": false, "score": 0, "creation_date": 1559174101, "post_id": 56369646, "comment_id": 99342354, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/26452170/python-multiply-every-other-element-in-a-list\">python - multiply every other element in a list</a>"}], "answers": [{"comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 3, "creation_date": 1559172231, "post_id": 56369691, "comment_id": 99341971, "body": "You can improve this by doing <code>data[2::3] = (x*2 for x in data[2::3])</code>.  This uses a generator, and avoids the creation of a temporary list."}, {"owner": {"reputation": 69906, "user_id": 6890912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d291e4dfbf14dcc8874bd4fa620fac23?s=128&d=identicon&r=PG&f=1", "display_name": "blhsing", "link": "https://stackoverflow.com/users/6890912/blhsing"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1559173862, "post_id": 56369691, "comment_id": 99342309, "body": "@TomKarzes But <code>data[2::3]</code> itself is a temporary list. To truly avoid the creation of a temporary list one should use <code>data[2::3] = (x * 2 for x in itertools.islice(data, 2, None, 3))</code>."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 69906, "user_id": 6890912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d291e4dfbf14dcc8874bd4fa620fac23?s=128&d=identicon&r=PG&f=1", "display_name": "blhsing", "link": "https://stackoverflow.com/users/6890912/blhsing"}, "edited": false, "score": 1, "creation_date": 1559173952, "post_id": 56369691, "comment_id": 99342327, "body": "@blhsing Oh, good point.  I was only looking at the &quot;outer&quot; temporary list.  I guess you could also do <code>data[2::3] = (data[i]*2 for i in range(2, len(data), 3))</code>"}, {"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1559177992, "post_id": 56369691, "comment_id": 99343106, "body": "Actually, <a href=\"https://github.com/python/cpython/blob/v3.7.3/Objects/listobject.c#L606\" rel=\"nofollow noreferrer\">list slice assignment</a> will <a href=\"https://docs.python.org/3/c-api/sequence.html#c.PySequence_Fast\" rel=\"nofollow noreferrer\">materialize</a> the generator to a list anyway, as I learned from the final comment on <a href=\"https://stackoverflow.com/a/55464566/369\">this answer</a>"}], "tags": [], "owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "is_accepted": false, "score": 9, "last_activity_date": 1559171821, "creation_date": 1559171821, "answer_id": 56369691, "question_id": 56369646, "link": "https://stackoverflow.com/questions/56369646/multiply-every-third-element-of-a-list-by-two/56369691#56369691", "title": "Multiply every third element of a list by two", "body": "<p>Yes, you can do it with slice notation:</p>\n\n<pre><code>data[2::3] = [x*2 for x in data[2::3]]\n</code></pre>\n\n<p>The <code>data[2::3]</code> means every 3rd element starting at element index 2 (i.e. the third element). You can reassign back to a slice as well, allowing for this very succinct syntax.</p>\n"}, {"tags": [], "owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "is_accepted": false, "score": 3, "last_activity_date": 1559171854, "creation_date": 1559171854, "answer_id": 56369693, "question_id": 56369646, "link": "https://stackoverflow.com/questions/56369646/multiply-every-third-element-of-a-list-by-two/56369693#56369693", "title": "Multiply every third element of a list by two", "body": "<p>There is a \"step\" parameter on the <code>range</code> iterator:</p>\n\n<pre><code>for index in range(2, len(data), 3):\n    data[index] *= 2\n</code></pre>\n\n<p>Would that do?</p>\n"}, {"tags": [], "owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "is_accepted": false, "score": 3, "last_activity_date": 1559171878, "creation_date": 1559171878, "answer_id": 56369696, "question_id": 56369646, "link": "https://stackoverflow.com/questions/56369646/multiply-every-third-element-of-a-list-by-two/56369696#56369696", "title": "Multiply every third element of a list by two", "body": "<p>Your solution isn't too bad.  It can be improved by simply iterating over the desired indices directly, rather than iterating over all indices and skipping the ones you don't want:</p>\n\n<pre><code>for index in range(2, len(data), 3):\n    data[index] *= 2\n</code></pre>\n\n<p>This produces the desired result:</p>\n\n<pre><code>[1, 2, 6, 4, 5, 12, 7, 8, 18, 10]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 330, "user_id": 10649437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f72e0b3f266b2b12718920816dfcc863?s=128&d=identicon&r=PG&f=1", "display_name": "Manuel Montoya", "link": "https://stackoverflow.com/users/10649437/manuel-montoya"}, "is_accepted": false, "score": 1, "last_activity_date": 1559172597, "creation_date": 1559172597, "answer_id": 56369786, "question_id": 56369646, "link": "https://stackoverflow.com/questions/56369646/multiply-every-third-element-of-a-list-by-two/56369786#56369786", "title": "Multiply every third element of a list by two", "body": "<p>You could organize it a little bit by passing a third argument to the range() function, like this:</p>\n\n<p><code>for index in range(2, len(data), 3):\n        data[index] = data[index]*2</code></p>\n"}, {"tags": [], "owner": {"reputation": 24329, "user_id": 5237560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CO92P.png?s=128&g=1", "display_name": "Alain T.", "link": "https://stackoverflow.com/users/5237560/alain-t"}, "is_accepted": false, "score": 2, "last_activity_date": 1559173060, "creation_date": 1559173060, "answer_id": 56369842, "question_id": 56369646, "link": "https://stackoverflow.com/questions/56369646/multiply-every-third-element-of-a-list-by-two/56369842#56369842", "title": "Multiply every third element of a list by two", "body": "<p>You could use cycle from itertools and zip to pair items with their multipliers:</p>\n\n<pre><code>data   = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n\nfrom itertools import cycle\nresult = [n*m for n,m in zip(data,cycle([1,1,2]))]\n\n# [1, 2, 6, 4, 5, 12, 7, 8, 18, 10]\n</code></pre>\n\n<p>OR, you can use enumerate()</p>\n\n<pre><code>result = [ n*max(1,i%3) for i,n in enumerate(data) ]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 642, "user_id": 2286254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCNnw.jpg?s=128&g=1", "display_name": "Alex Lopatin", "link": "https://stackoverflow.com/users/2286254/alex-lopatin"}, "is_accepted": false, "score": 1, "last_activity_date": 1559176115, "creation_date": 1559176115, "answer_id": 56370158, "question_id": 56369646, "link": "https://stackoverflow.com/questions/56369646/multiply-every-third-element-of-a-list-by-two/56370158#56370158", "title": "Multiply every third element of a list by two", "body": "<p>... and the winner is:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Calculation time in seconds and results validation test.\n1.150 question_by_akrapovich\n0.331 answer_by_Tom_Karzes_and_Prune\n0.333 answer_2_by_Manuel_Montoya\n0.373 answer_by_Blorgbeard\n0.816 answer_1_by_Alain_T\n2.850 answer_2_by_Alain_T\n</code></pre>\n\n<p>Combined code for time testing and results validation:</p>\n\n<pre><code>import time\n\n\ndef question_by_akrapovich(data):\n    for index in range(len(data)):\n        if (index + 1) % 3 == 0:\n            data[index] = data[index] * 2\n    return data\n\n\ndef answer_by_Tom_Karzes_and_Prune(data):\n    for index in range(2, len(data), 3):\n        data[index] *= 2\n    return data\n\n\ndef answer_by_Blorgbeard(data):\n    data[2::3] = [x*2 for x in data[2::3]]\n    return data\n\n\ndef answer_1_by_Alain_T(data):\n    from itertools import cycle\n    return [n * m for n, m in zip(data, cycle([1, 1, 2]))]\n\n\ndef answer_2_by_Alain_T(data):\n    return [ n*max(1,i%3) for i,n in enumerate(data) ]\n\n\ndef answer_2_by_Manuel_Montoya(data):\n    for index in range(2, len(data), 3):\n        data[index] = data[index]*2\n    return  data\n\ndef test(f):\n    n = 10_000_000\n    data = [i + 1 for i in range(n)]\n    start_time = time.perf_counter()\n    data = f(data)\n    run_time = time.perf_counter() - start_time\n    if n != len(data):\n        print('error in list length', n, len(data))\n        exit(1)\n    for i in range(n):\n        j = i + 1\n        m = j * 2 if j % 3 == 0 else j\n        if data[i] != m:\n            print('error in data', i, m, data[i])\n            exit(1)\n    print('%.3f %s' % (run_time, f.__name__))\n\n\nprint('Calculation time in seconds and results validation test.')\nfor f in [question_by_akrapovich, answer_by_Tom_Karzes_and_Prune,\n          answer_2_by_Manuel_Montoya, answer_by_Blorgbeard,\n          answer_1_by_Alain_T, answer_2_by_Alain_T]:\n    test(f)\n</code></pre>\n"}], "owner": {"reputation": 459, "user_id": 8563165, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zrd4p.png?s=128&g=1", "display_name": "akpp2808", "link": "https://stackoverflow.com/users/8563165/akpp2808"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "answer_count": 6, "score": 0, "last_activity_date": 1559176115, "creation_date": 1559171424, "last_edit_date": 1559173651, "question_id": 56369646, "link": "https://stackoverflow.com/questions/56369646/multiply-every-third-element-of-a-list-by-two", "title": "Multiply every third element of a list by two", "body": "<p>Input data: <code>[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</code> <br/>\nOutput data: <code>[1, 2, 6, 4, 5, 12, 7, 8, 18, 10]</code></p>\n\n<p>I have read many answers where were suggested to use slice notation with including first element. But in my case I should take each 3rd element of the list.</p>\n\n<p>Is it possible to improve my realization?</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>for index in range(len(data)):\n    if (index + 1) % 3 == 0:\n        data[index] = data[index] * 2\n</code></pre>\n"}, {"tags": ["python", "email", "imaplib"], "comments": [{"owner": {"reputation": 27241, "user_id": 5320906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NOdNo.jpg?s=128&g=1", "display_name": "snakecharmerb", "link": "https://stackoverflow.com/users/5320906/snakecharmerb"}, "edited": false, "score": 0, "creation_date": 1559463503, "post_id": 56369598, "comment_id": 99423217, "body": "&quot;sometimes will only download 3 of 4 attachments and then won&#39;t even terminate&quot; - this sounds like a network/connectivity issue."}], "answers": [{"tags": [], "owner": {"reputation": 74, "user_id": 8774020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52078028e95e2076b3d2de7179e15b4d?s=128&d=identicon&r=PG&f=1", "display_name": "kalidurge", "link": "https://stackoverflow.com/users/8774020/kalidurge"}, "is_accepted": false, "score": 0, "last_activity_date": 1560448519, "creation_date": 1560448519, "answer_id": 56586108, "question_id": 56369598, "link": "https://stackoverflow.com/questions/56369598/python-download-attachment-from-outlook-w-imaplib4-never-downloads-the-last-att/56586108#56586108", "title": "Python Download Attachment from Outlook w/ Imaplib4 Never downloads the last Attachment", "body": "<p>I can't pinpoint what's wrong but try adopting this code here: <a href=\"https://gist.github.com/cdunklau/9001357\" rel=\"nofollow noreferrer\">https://gist.github.com/cdunklau/9001357</a></p>\n\n<p>It worked for me.</p>\n\n<p>I updated the find_attachments method like this:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>def find_attachments(message):\n    \"\"\"\n    Return a tuple of parsed content-disposition dict, message object\n    for each attachment found.\n    \"\"\"\n    found = []\n    for part in message.walk():\n        if 'content-disposition' not in part:\n            continue\n        cdisp = part['content-disposition'].split(';')\n        cdisp = [x.strip() for x in cdisp]\n        if cdisp[0].lower() != 'attachment':\n            continue\n        parsed = {}\n        for kv in cdisp[1:]:\n            try:\n                key, val = kv.split('=')\n                if val.startswith('\"'):\n                    val = val.strip('\"')\n                elif val.startswith(\"'\"):\n                    val = val.strip(\"'\")\n                parsed[key] = val\n            except Exception as e:\n                parsed['filename']=kv.replace('filename=','')\n        found+=list(parsed.values())\n    return found\n</code></pre>\n"}], "owner": {"reputation": 350, "user_id": 7451580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GNMqM.jpg?s=128&g=1", "display_name": "BrianBeing", "link": "https://stackoverflow.com/users/7451580/brianbeing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560464494, "creation_date": 1559171041, "last_edit_date": 1560464494, "question_id": 56369598, "link": "https://stackoverflow.com/questions/56369598/python-download-attachment-from-outlook-w-imaplib4-never-downloads-the-last-att", "title": "Python Download Attachment from Outlook w/ Imaplib4 Never downloads the last Attachment", "body": "<p>The script I wrote:1) connects to my work Outlook email. The script reads my username and password from a text file which is found in the variable TextFilePath. 2) Looks for attachments based upon a searchterm I choose that would be in the Subject of the email (here, it's \"special_search_term_in_email\"). 3) Downloads the attachments to a specific folder titled 'DownloadFolderPath'.  </p>\n\n<p>The goal for this script is to run everyday and connect to my email and download 4 attachments that will be sent to me everyday. The issue is that the script will sometimes download all 4 attachments, but then sometimes will only download 3 of 4 attachments and then won't even terminate. Appreciate the help.</p>\n\n<pre><code>import email\nimport imaplib\nimport os\nimport datetime\nimport csv\n\n# these 3 variables you need to set to run the code\nmail_server = \"imap-mail.outlook.com\"\nTextFilePath = \"C:/Users/FakeName/PycharmProjects/imaplib_script/unpw.txt\"\nLogFilePath = 'C:/Users/FakeName/PycharmProjects/imaplib_script/downloaded_attachments/logfile.csv'\nDownloadFolderPath = 'C:/Users/FakeName/PycharmProjects/imaplib_script/downloaded_attachments/'\n# below read_input_return_list function reads input from a text file and returns a list\n\ndef read_input_return_list():\n    textunpw = open(TextFilePath, \"r\")\n    lines = textunpw.readlines()\n    username = lines[0].strip('\\n')\n    password = lines[1]\n    textunpw.close()\n    return [username, password]\n\n\nread_input_variable = read_input_return_list()\n\n\nusername = read_input_variable[0]\npassword = read_input_variable[1]\nscript_ran_time=datetime.datetime.today().strftime('%c')\n\nmail = imaplib.IMAP4_SSL(mail_server)\nmail.login(username, password)\nprint(\"{0} Connecting to mailbox via IMAP...\".format(datetime.datetime.today().strftime(\"%Y-%m-%d %H:%M:%S\")))\nmail.select()\n\ntype, data = mail.search(None, '(SUBJECT \"special_search_term_in_email\")')\n\ntotal_count = 0\nwith open(LogFilePath,newline='', encoding='utf-8', mode='a') as csv_file:\n    writer = csv.writer(csv_file, delimiter=',', quotechar='\"', quoting=csv.QUOTE_MINIMAL)\n    for num in data[0].split():\n        type, data = mail.fetch(num, '(RFC822)')\n        raw_email = data[0][1]\n        raw_email_string = raw_email.decode('utf-8')\n        email_message = email.message_from_string(raw_email_string)\n\n        for part in email_message.walk():\n            if part.get_content_maintype() == 'multipart':\n                for part1 in part.walk():\n                    c_type = part.get_content_type()\n                    c_disp0 = str(part.get('Content-Disposition'))\n\n                    # skip any text/plain (txt) attachments\n                    if c_type == 'text/plain' and 'attachment' not in c_disp0:\n                        body = part1.get_payload(decode=True)\n                        break\n            attachment = part.get_filename()\n            if bool(attachment):\n                filePath = os.path.join(DownloadFolderPath, attachment)\n                if os.path.isfile(filePath):\n                    filename, file_extension = os.path.splitext(filePath)\n                    FileDownloadAndWriteTime = '__' + datetime.datetime.today().strftime('%m_%d_%Y %H_%M_%S')\n                    new_fname = \"{}_{}{}\".format(filename, FileDownloadAndWriteTime, file_extension)\n                    while os.path.exists(new_fname):\n                        new_fname = \"{}_{}{}\".format(filename, FileDownloadAndWriteTime, file_extension)\n                    filePath = new_fname\n                filepathopen = open(filePath, 'wb')\n                filepathopen.write(part.get_payload(decode=True))\n                FileDownloadAndWriteTime = datetime.datetime.today().strftime('%m_%d_%Y %H_%M_%S')\n                total_count += 1\n                writer.writerow([filePath,FileDownloadAndWriteTime, script_ran_time])\n                filepathopen.close()\n\n                print('Download file attachment name: ', attachment)\n\nprint(\"Total count of downloaded documents: \", total_count)\nmail.close()\n</code></pre>\n"}, {"tags": ["python", "docker", "aws-lambda", "windows-subsystem-for-linux"], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 7823459, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zDO6JU0AMMo/AAAAAAAAAAI/AAAAAAAAAfQ/ueP5JPSETOQ/photo.jpg?sz=128", "display_name": "Alexander", "link": "https://stackoverflow.com/users/7823459/alexander"}, "is_accepted": false, "score": 0, "last_activity_date": 1559189809, "creation_date": 1559189809, "answer_id": 56371548, "question_id": 56369582, "link": "https://stackoverflow.com/questions/56369582/mounting-volume-using-docker-no-files-being-added/56371548#56371548", "title": "Mounting Volume Using Docker - No Files Being Added", "body": "<p>Okay, it was due to the Windows Credentials, they needed to be updated. In the Docker App,\nSettings -> Shared Drives -> Reset Credentials</p>\n\n<p>Run as Administrator just to make sure.</p>\n"}], "owner": {"reputation": 39, "user_id": 7823459, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zDO6JU0AMMo/AAAAAAAAAAI/AAAAAAAAAfQ/ueP5JPSETOQ/photo.jpg?sz=128", "display_name": "Alexander", "link": "https://stackoverflow.com/users/7823459/alexander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1559189809, "creation_date": 1559170871, "question_id": 56369582, "link": "https://stackoverflow.com/questions/56369582/mounting-volume-using-docker-no-files-being-added", "title": "Mounting Volume Using Docker - No Files Being Added", "body": "<p>I am trying to mount a volume using docker command on WSL (Bash). But the files and folders I need to mount do not show up to Docker, hence, when I run the docker command it says file not found.</p>\n\n<p>I am trying to simply use the Alpine Container to see if I can make it work. But it also fails to recognize all the files/folders I have on the dir I run it on.</p>\n\n<p>The following command:</p>\n\n<p><code>docker run --rm -v /c/Users/alexandrec/Desktop/AWS_Layers/pandas:/data alpine ls /data</code></p>\n\n<p>Returns: </p>\n\n<p><code>test</code></p>\n\n<p>And this command:</p>\n\n<p><code>/mnt/c/Users/alexandrec/Desktop/AWS_Layers/pandas$ ls -la</code></p>\n\n<p>Returns:</p>\n\n<pre><code>-total 2238\n-drwxrwxrwx 0 root root 512 May 29 15:22 .\n-drwxrwxrwx 0 root root 512 May 29 14:56 ..\n-rwxrwxrwx 1 root root 254 May 28 16:52 get_layer_packages.sh\n-rwxrwxrwx 1 root root  85 May 29 11:31 my_module.py\n-drwxrwxrwx 0 root root 512 May 29 15:22 New folder\n-drwxrwxrwx 0 root root 512 May 28 16:49 python\n-rwxrwxrwx 1 root root  28 May 28 14:56 requirements.txt\n-drwxrwxrwx 0 root root 512 May 29 14:56 test\n-drwxrwxrwx 0 root root 512 May 28 20:30 var\n</code></pre>\n\n<p>Somehow most folders/files in the DIR do not get mounted only <code>test</code>.</p>\n\n<p>Eventually I want to be able to run this:</p>\n\n<p><code>docker run --rm -v \"$PWD\":/var/task lambci/lambda:python3.6 my_module.my_handler</code></p>\n\n<p>Which currently returns:</p>\n\n<pre><code>START RequestId: d3df9063-56ea-4c56-b097-2932c633d74f Version: $LATEST\nUnable to import module 'my_module': No module named 'my_module'\nEND RequestId: d3df9063-56ea-4c56-b097-2932c633d74f\nREPORT RequestId: d3df9063-56ea-4c56-b097-2932c633d74f Duration: 0 ms Billed Duration: 100 ms Memory Size: 1536 MB Max Memory Used: 19 MB\n\n{\"errorMessage\": \"Unable to import module 'my_module'\"}\n</code></pre>\n\n<p>I just don't seem to figure out if this is a permission problem or something related to Windows/Docker/Linux interactions.</p>\n\n<p>The following link shows my bash terminal commands: <a href=\"https://imgur.com/4tqpdaR\" rel=\"nofollow noreferrer\">https://imgur.com/4tqpdaR</a></p>\n"}, {"tags": ["python", "python-3.x", "jupyter-notebook", "argparse"], "comments": [{"owner": {"reputation": 173469, "user_id": 901925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bbd70aaeb3a97d0087daf93c2be8804?s=128&d=identicon&r=PG", "display_name": "hpaulj", "link": "https://stackoverflow.com/users/901925/hpaulj"}, "edited": false, "score": 0, "creation_date": 1559197842, "post_id": 56369580, "comment_id": 99347410, "body": "You can also create a <code>args = argparse.Namespace(config_file=&#39;some_file.yaml&#39;, ...)</code> (skipping the <code>parse_args</code> step)."}], "answers": [{"comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1559171647, "post_id": 56369626, "comment_id": 99341837, "body": "You passed non-existent <code>arguments</code> to <code>parse_args</code>. I think you may have misunderstood the documentation; you could have passed the <code>list</code> directly as an argument to <code>parse_args</code> instead of modifying <code>sys.argv</code> at all."}, {"owner": {"reputation": 1115, "user_id": 3625770, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/7Y21o.png?s=128&g=1", "display_name": "Azim", "link": "https://stackoverflow.com/users/3625770/azim"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1559171716, "post_id": 56369626, "comment_id": 99341855, "body": "That was a typo. Thanks. And yes you are right about not needing sys.argv. I will update it."}, {"owner": {"reputation": 173469, "user_id": 901925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bbd70aaeb3a97d0087daf93c2be8804?s=128&d=identicon&r=PG", "display_name": "hpaulj", "link": "https://stackoverflow.com/users/901925/hpaulj"}, "edited": false, "score": 0, "creation_date": 1559173982, "post_id": 56369626, "comment_id": 99342331, "body": "The unit test file for <code>argparse</code> tests both a direct list of strings and a doctored <code>sys.argv</code>."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 173469, "user_id": 901925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bbd70aaeb3a97d0087daf93c2be8804?s=128&d=identicon&r=PG", "display_name": "hpaulj", "link": "https://stackoverflow.com/users/901925/hpaulj"}, "edited": false, "score": 0, "creation_date": 1559174843, "post_id": 56369626, "comment_id": 99342521, "body": "@hpaulj: Yar. It&#39;s perfectly legal, the reason not to do it is that you shouldn&#39;t be using global state to solve a local problem. The contents of <code>sys.argv</code> often mean something, and you shouldn&#39;t mess with them willy-nilly if there is <i>any</i> other way to accomplish your aims."}, {"owner": {"reputation": 173469, "user_id": 901925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bbd70aaeb3a97d0087daf93c2be8804?s=128&d=identicon&r=PG", "display_name": "hpaulj", "link": "https://stackoverflow.com/users/901925/hpaulj"}, "edited": false, "score": 0, "creation_date": 1559176071, "post_id": 56369626, "comment_id": 99342752, "body": "It this case of a jupyter notebook the real sys,argv has already been used by the jupyter server.  So modifying it for &#39;local&#39; use should be fine - though it may affect other notebooks on the same server."}], "tags": [], "owner": {"reputation": 1115, "user_id": 3625770, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/7Y21o.png?s=128&g=1", "display_name": "Azim", "link": "https://stackoverflow.com/users/3625770/azim"}, "is_accepted": false, "score": 1, "last_activity_date": 1559171705, "last_edit_date": 1559171705, "creation_date": 1559171231, "answer_id": 56369626, "question_id": 56369580, "link": "https://stackoverflow.com/questions/56369580/how-to-provide-a-python-argparse-parser-with-arguments-from-inside-the-code-wit/56369626#56369626", "title": "How to provide a python argparse.parser with arguments from inside the code, without command-line arguments?", "body": "<p>Note: As @ShadowRanger mentioned, there is no need to use <code>sys.argv</code>. See his response.</p>\n\n<hr>\n\n<p>One way is to use <code>sys.argv</code> to mimic the command-line arguments:</p>\n\n<pre><code>import sys\n\nsys.argv = [\n    \"--config-file\" , \"some_file.yaml\",\n    \"SOMETHING.subsetting_a\" , \"2\",\n    \"SOMETHING.subsetting_b\" , \"3\"]\n\nargs = parser.parse_args(sys.argv)\n</code></pre>\n\n<p>The content of args is something liek this:</p>\n\n<pre><code>&gt; Namespace(config_file='some_file.yaml', opts=['SOMETHING.subsetting_a', '2', 'SOMETHING.subsetting_b', '3')\n</code></pre>\n\n<p>which is similar to the output of <code>print(parser.parse_args())</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": true, "score": 1, "last_activity_date": 1559171442, "creation_date": 1559171442, "answer_id": 56369650, "question_id": 56369580, "link": "https://stackoverflow.com/questions/56369580/how-to-provide-a-python-argparse-parser-with-arguments-from-inside-the-code-wit/56369650#56369650", "title": "How to provide a python argparse.parser with arguments from inside the code, without command-line arguments?", "body": "<p><a href=\"https://docs.python.org/3/library/argparse.html#argparse.ArgumentParser.parse_args\" rel=\"nofollow noreferrer\"><code>parse_args</code>'s first optional argument is the list of arguments to parse</a>, the signature is:</p>\n\n<blockquote>\n  <p><code>ArgumentParser.parse_args(args=None, namespace=None)</code></p>\n</blockquote>\n\n<p>It just takes <code>args</code> from <code>sys.argv</code> if you don't provide it.</p>\n\n<p>So just call it as:</p>\n\n<pre><code>args = parser.parse_args(['mycode.py', '--config-file', \"some_file.yaml\", 'SOMETHING.subsetting_a', '2', 'SOMETHING.subsetting_a'])\n</code></pre>\n\n<p>(with the <code>list</code> containing whatever you like instead) and it will use it instead of <code>sys.argv</code>.</p>\n"}], "owner": {"reputation": 1115, "user_id": 3625770, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/7Y21o.png?s=128&g=1", "display_name": "Azim", "link": "https://stackoverflow.com/users/3625770/azim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1966, "favorite_count": 0, "accepted_answer_id": 56369650, "answer_count": 2, "score": 0, "last_activity_date": 1559171705, "creation_date": 1559170855, "last_edit_date": 1559171668, "question_id": 56369580, "link": "https://stackoverflow.com/questions/56369580/how-to-provide-a-python-argparse-parser-with-arguments-from-inside-the-code-wit", "title": "How to provide a python argparse.parser with arguments from inside the code, without command-line arguments?", "body": "<p>I have a code that takes the command-line arguments into a <code>parser</code> and modifies some configuration settings. Something like this:</p>\n\n<p>command:</p>\n\n<pre><code>python mycode.py --config-file \"some_file.yaml\" SOMETHING.subsetting_a 2 SOMETHING.subsetting_b 3\n</code></pre>\n\n<p>and then it does:</p>\n\n<pre><code>import argparse\nparser = argparse.ArgumentParser(description=\"Some description here\")\nparser.add_argument(\n    \"--config-file\",\n    default=\"\",\n    metavar=\"FILE\",\n    help=\"path to config file\",\n    type=str,\n)\n//some more 'add_argument' lines here\nargs = parser.parse_args()\n</code></pre>\n\n<p>But as I am using jupyter notebook, it would be easier to provide the arguments directly to the parser, as if they come from the command-line. How can I create a string containing the command (as mentioned above) and pass it to <code>parser</code>?</p>\n"}, {"tags": ["python", "flask"], "answers": [{"tags": [], "owner": {"reputation": 202, "user_id": 2240340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8621371751becbdd0db22dd70efa8aad?s=128&d=identicon&r=PG", "display_name": "Zik", "link": "https://stackoverflow.com/users/2240340/zik"}, "is_accepted": false, "score": 0, "last_activity_date": 1559194350, "last_edit_date": 1559194350, "creation_date": 1559184670, "answer_id": 56371041, "question_id": 56369573, "link": "https://stackoverflow.com/questions/56369573/session-variables-in-flask-keep-changing/56371041#56371041", "title": "session variables in flask keep changing", "body": "<p>If you want to store one value to each session. No sql like <code>redis</code> is recommendation. </p>\n\n<pre><code>import os\nfrom flask import Flask, session, request, redirect, url_for, flash, g\nfrom flask import render_template\nfrom flask_session import Session\nimport redis\n\napp = Flask(__name__)\n\napp.secret_key = b'_5#y2L\"F4Q8z\\n\\xec]/'\n\napp.config['SESSION_TYPE'] = 'redis'\napp.config['SESSION_REDIS'] = redis.from_url('127.0.0.1:6379')\n# Configure session to use filesystem\napp.config[\"SESSION_PERMANENT\"] = False\napp.config[\"SESSION_TYPE\"] = \"filesystem\"\napp.config['logged_in']=True\n\nSession(app)\n\n# Redirect to /login route\n@app.route('/')\ndef index():\n    return redirect(url_for(\"login\"))\n\n# Open main login page\n@app.route(\"/login\", methods=[\"POST\",\"GET\"])\ndef login():\n    return render_template(\"login.html\")\n\n# Verify login credentials\n@app.route(\"/login_check\",methods=[\"POST\"])\ndef login_check():\n    return redirect(url_for(\"main_page\"),code=307) if app.config['logged_in']==True else render_template(\"not_logged_in.html\")\n\n@app.route(\"/main_page\", methods=[\"POST\"])\ndef main_page():\n    return render_template(\"main_page.html\",name=\"Main page\")\n\n\n@app.route(\"/log_out\", methods=[\"POST\"])\ndef log_out():\n    session['key'] = 'False'\n    return redirect(url_for(\"login\"))\n\nif __name__ == '__main__':\n    app.run(debug=True)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 3993689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e46d50d0fc73d1cf92026c9c4195921?s=128&d=identicon&r=PG&f=1", "display_name": "sandrus", "link": "https://stackoverflow.com/users/3993689/sandrus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 720, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559194350, "creation_date": 1559170816, "question_id": 56369573, "link": "https://stackoverflow.com/questions/56369573/session-variables-in-flask-keep-changing", "title": "session variables in flask keep changing", "body": "<p>I have a very basic flask application that I have deployed to Heroku. I am trying to define a variable that I can change when a specific function is executed. For example, if I have a variable <code>logged_in=True</code>, I want to be able to change it to <code>logged_in=False</code> when the route <code>@app.route('/logout')</code> is executed. Here is the code: </p>\n\n<pre><code>import os\nfrom flask import Flask, session, request, redirect, url_for, flash, g\nfrom flask import render_template\nfrom flask_session import Session\n\napp = Flask(__name__)\n\napp.secret_key = b'_5#y2L\"F4Q8z\\n\\xec]/'\n\n# Configure session to use filesystem\napp.config[\"SESSION_PERMANENT\"] = False\napp.config[\"SESSION_TYPE\"] = \"filesystem\"\napp.config['logged_in']=True\n\nSession(app)\n\n# Redirect to /login route\n@app.route('/')\ndef index():\n    return redirect(url_for(\"login\"))\n\n# Open main login page\n@app.route(\"/login\", methods=[\"POST\",\"GET\"])\ndef login():\n    return render_template(\"login.html\")\n\n# Verify login credentials\n@app.route(\"/login_check\",methods=[\"POST\"])\ndef login_check():\n    return redirect(url_for(\"main_page\"),code=307) if app.config['logged_in']==True else render_template(\"not_logged_in.html\")\n\n@app.route(\"/main_page\", methods=[\"POST\"])\ndef main_page():\n    return render_template(\"main_page.html\",name=\"Main page\")\n\n\n@app.route(\"/log_out\", methods=[\"POST\"])\ndef log_out():\n    app.config['logged_in']=False\n    return redirect(url_for(\"login\"))\n\nif __name__ == '__main__':\n    app.run(debug=True)\n</code></pre>\n\n<p>When I launch the app locally, the value of <code>logged_in</code> is set to <code>False</code> when <code>logout</code> is executed and does not change if <code>login</code> is triggered again. However, when I deploy the app to Heroku, the value of <code>logged_in</code> goes back <code>True</code> when <code>login</code> is triggered again (it's weird, the value changes sometimes, but not always).</p>\n\n<p>How can I set the value of <code>logged_in</code> so that it does not change until I update it with a function? I tried to use <code>session.config['logged_in']</code>instead of <code>app.config['logged_in']</code>, but I had the same issue. Ideally, I want the value to be unique for each session. </p>\n\n<p>Thank you</p>\n"}, {"tags": ["python", "sql", "pandas"], "comments": [{"owner": {"reputation": 4079, "user_id": 3259896, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/641c30a7b383022f22b53c8cedb04e3f?s=128&d=identicon&r=PG&f=1", "display_name": "SantoshGupta7", "link": "https://stackoverflow.com/users/3259896/santoshgupta7"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1559431503, "post_id": 56369565, "comment_id": 99419368, "body": "the problem with that is to_csv takes many hours; it won&#39;t be a sustainable practice for me."}], "answers": [{"comments": [{"owner": {"reputation": 4079, "user_id": 3259896, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/641c30a7b383022f22b53c8cedb04e3f?s=128&d=identicon&r=PG&f=1", "display_name": "SantoshGupta7", "link": "https://stackoverflow.com/users/3259896/santoshgupta7"}, "edited": false, "score": 0, "creation_date": 1559411696, "post_id": 56369713, "comment_id": 99415439, "body": "I updated the post with what came out after cntrl c for two rungs, one at the beginning and one right before crash. It&#39;s going into sqlalchemy , so perhaps the bug is there?"}, {"owner": {"reputation": 4079, "user_id": 3259896, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/641c30a7b383022f22b53c8cedb04e3f?s=128&d=identicon&r=PG&f=1", "display_name": "SantoshGupta7", "link": "https://stackoverflow.com/users/3259896/santoshgupta7"}, "edited": false, "score": 0, "creation_date": 1559412152, "post_id": 56369713, "comment_id": 99415562, "body": "I did one more run right before it crashed (tried to catch it before that as an intermediate) it stopped at where you said it would. Not sure what this means."}, {"owner": {"reputation": 287228, "user_id": 1240268, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/RN9Mw.jpg?s=128&g=1", "display_name": "Andy Hayden", "link": "https://stackoverflow.com/users/1240268/andy-hayden"}, "reply_to_user": {"reputation": 4079, "user_id": 3259896, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/641c30a7b383022f22b53c8cedb04e3f?s=128&d=identicon&r=PG&f=1", "display_name": "SantoshGupta7", "link": "https://stackoverflow.com/users/3259896/santoshgupta7"}, "edited": false, "score": 0, "creation_date": 1559418002, "post_id": 56369713, "comment_id": 99416878, "body": "@SantoshGupta7 have you tried in an explicit loop (rather than using chunk), ie. <code>for i in range(100): df.iloc[i * 100000:(i+1):100000].to_sql(...)</code> ?"}, {"owner": {"reputation": 4079, "user_id": 3259896, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/641c30a7b383022f22b53c8cedb04e3f?s=128&d=identicon&r=PG&f=1", "display_name": "SantoshGupta7", "link": "https://stackoverflow.com/users/3259896/santoshgupta7"}, "edited": false, "score": 1, "creation_date": 1559419780, "post_id": 56369713, "comment_id": 99417247, "body": "I&#39;ll try this next. It looks like if I set if_exists = append in to_sql, it&#39;ll just add the new values. I&#39;ll try this soon"}, {"owner": {"reputation": 4079, "user_id": 3259896, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/641c30a7b383022f22b53c8cedb04e3f?s=128&d=identicon&r=PG&f=1", "display_name": "SantoshGupta7", "link": "https://stackoverflow.com/users/3259896/santoshgupta7"}, "edited": false, "score": 0, "creation_date": 1559425159, "post_id": 56369713, "comment_id": 99418295, "body": "@Andry Hayden I have tried this, but it still crashes. It eventually eats up all the RAM, and around halfway through, there is a crash. But now I think it&#39;s a little more clear that the issue is with the database and not pandas to_sql. It looks like it&#39;s continuing to hold all the data in active memory?"}, {"owner": {"reputation": 287228, "user_id": 1240268, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/RN9Mw.jpg?s=128&g=1", "display_name": "Andy Hayden", "link": "https://stackoverflow.com/users/1240268/andy-hayden"}, "reply_to_user": {"reputation": 4079, "user_id": 3259896, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/641c30a7b383022f22b53c8cedb04e3f?s=128&d=identicon&r=PG&f=1", "display_name": "SantoshGupta7", "link": "https://stackoverflow.com/users/3259896/santoshgupta7"}, "edited": false, "score": 0, "creation_date": 1559433567, "post_id": 56369713, "comment_id": 99419641, "body": "@SantoshGupta7 perhaps try a raw connection, rather than using SQLEngine?\\"}, {"owner": {"reputation": 4079, "user_id": 3259896, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/641c30a7b383022f22b53c8cedb04e3f?s=128&d=identicon&r=PG&f=1", "display_name": "SantoshGupta7", "link": "https://stackoverflow.com/users/3259896/santoshgupta7"}, "edited": false, "score": 0, "creation_date": 1559440683, "post_id": 56369713, "comment_id": 99420357, "body": "I&#39;m not too familiar with this, but from my initial search, this would mean using sqlite3 instead of sqlalchemy?"}, {"owner": {"reputation": 287228, "user_id": 1240268, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/RN9Mw.jpg?s=128&g=1", "display_name": "Andy Hayden", "link": "https://stackoverflow.com/users/1240268/andy-hayden"}, "reply_to_user": {"reputation": 4079, "user_id": 3259896, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/641c30a7b383022f22b53c8cedb04e3f?s=128&d=identicon&r=PG&f=1", "display_name": "SantoshGupta7", "link": "https://stackoverflow.com/users/3259896/santoshgupta7"}, "edited": false, "score": 0, "creation_date": 1559445248, "post_id": 56369713, "comment_id": 99420752, "body": "Yes, just an idea"}, {"owner": {"reputation": 4079, "user_id": 3259896, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/641c30a7b383022f22b53c8cedb04e3f?s=128&d=identicon&r=PG&f=1", "display_name": "SantoshGupta7", "link": "https://stackoverflow.com/users/3259896/santoshgupta7"}, "edited": false, "score": 0, "creation_date": 1559508368, "post_id": 56369713, "comment_id": 99433292, "body": "I was able to insert all the data by just continuing where I left off after the memory crash with the <code>for i in range(100): df.iloc[i * 100000:(i+1):100000].to_sql(...)</code> method. But I will do direct insertions next time. I started a new SO question to look into sqlalchemy <a href=\"https://stackoverflow.com/questions/56418825/repeated-insertions-into-sqlite-database-via-sqlalchemy-causing-memory-leak\" title=\"repeated insertions into sqlite database via sqlalchemy causing memory leak\">stackoverflow.com/questions/56418825/&hellip;</a> ."}], "tags": [], "owner": {"reputation": 287228, "user_id": 1240268, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/RN9Mw.jpg?s=128&g=1", "display_name": "Andy Hayden", "link": "https://stackoverflow.com/users/1240268/andy-hayden"}, "is_accepted": true, "score": 3, "last_activity_date": 1559511501, "last_edit_date": 1559511501, "creation_date": 1559172091, "answer_id": 56369713, "question_id": 56369565, "link": "https://stackoverflow.com/questions/56369565/large-6-million-rows-pandas-df-causes-memory-error-with-to-sql-when-chunksi/56369713#56369713", "title": "Large (6 million rows) pandas df causes memory error with `to_sql ` when chunksize =100, but can easily save file of 100,000 with no chunksize", "body": "<p>From stepping through the code I <em>think</em> it's <a href=\"https://github.com/pandas-dev/pandas/blob/a91da0c94e541217865cdf52b9f6ea694f0493d3/pandas/io/sql.py#L676\" rel=\"nofollow noreferrer\">this line</a>, which reads creates a bunch of DataFrames:</p>\n\n<pre><code>chunk_iter = zip(*[arr[start_i:end_i] for arr in data_list])\n</code></pre>\n\n<p>Which looks like it's <em>probably</em> a bug. Specifically this happens prior to database insertion, in preparation.</p>\n\n<p><em>One trick you can do is CTRL-C whilst the memory is rapidly increasing, and see which line is paused on (my bet is this one).</em></p>\n\n<p>User Edit:</p>\n\n<p>Problem was solved by using</p>\n\n<p><code>explicit loop (rather than using chunk), ie. for i in range(100): df.iloc[i * 100000:(i+1):100000].to_sql(...)</code></p>\n\n<p>Which still resulted in memory errors, but allowed the user to continue where loop left off before the crash. </p>\n\n<p>A more robust solution is to \"perhaps try a raw connection, rather than using SQLEngine?\\ \"\nBut user didn't have a chance to try this </p>\n"}, {"comments": [{"owner": {"reputation": 907, "user_id": 4676560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FoinV.jpg?s=128&g=1", "display_name": "Captain Hat", "link": "https://stackoverflow.com/users/4676560/captain-hat"}, "edited": false, "score": 0, "creation_date": 1611271928, "post_id": 65836405, "comment_id": 116405120, "body": "Hi JGDO, welcome to Stack Overflow! Thank you for contributing. I&#39;ve downvoted this post because this question already has a precise answer which has been accepted. Whilst recommendation may be helpful generally, it isn&#39;t the answer to this specific question."}], "tags": [], "owner": {"reputation": 99, "user_id": 7451414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pS2rO.jpg?s=128&g=1", "display_name": "juanjosegdoj", "link": "https://stackoverflow.com/users/7451414/juanjosegdoj"}, "is_accepted": false, "score": 2, "last_activity_date": 1611266627, "creation_date": 1611266627, "answer_id": 65836405, "question_id": 56369565, "link": "https://stackoverflow.com/questions/56369565/large-6-million-rows-pandas-df-causes-memory-error-with-to-sql-when-chunksi/65836405#65836405", "title": "Large (6 million rows) pandas df causes memory error with `to_sql ` when chunksize =100, but can easily save file of 100,000 with no chunksize", "body": "<p>I've used <strong>df.to_sql</strong> for 1 year and now I'm struggling with the fact I running big resources and it wasn't working. I realized that chucksize overload your memory, pandas loaded in memory and after that sent it by chuncks. I had to control directly using sql. (here is where I found the solution -&gt; <a href=\"https://github.com/pandas-dev/pandas/issues/12265\" rel=\"nofollow noreferrer\">https://github.com/pandas-dev/pandas/issues/12265</a> I really encourage you to read untill the end.)</p>\n<p>If you need to read data from your databaset without overloading your memory, check this piece of code:</p>\n<pre><code>def get_data_by_chunks(cls, table, chunksize: int) -&gt; iter:\n    with MysqlClient.get_engine().begin() as conn:\n        query_count = &quot;select COUNT(*) from my_query&quot;\n        row_count = conn.execute(query_count, where).fetchone()[0]\n\n        for i in range(math.ceil(row_count / chunksize)):\n            query = &quot;&quot;&quot;\n               SELECT * FROM my_table\n               WHERE my_filiters\n               LIMIT {offset}, {row_count};\n             &quot;&quot;&quot;\n            yield pd.read_sql(query, conn)\n\nfor df in get_data_by_chunks(cls, table, chunksize: int):\n    print(df.shape)\n</code></pre>\n"}], "owner": {"reputation": 4079, "user_id": 3259896, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/641c30a7b383022f22b53c8cedb04e3f?s=128&d=identicon&r=PG&f=1", "display_name": "SantoshGupta7", "link": "https://stackoverflow.com/users/3259896/santoshgupta7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4286, "favorite_count": 1, "accepted_answer_id": 56369713, "answer_count": 2, "score": 5, "last_activity_date": 1611266627, "creation_date": 1559170753, "last_edit_date": 1559429140, "question_id": 56369565, "link": "https://stackoverflow.com/questions/56369565/large-6-million-rows-pandas-df-causes-memory-error-with-to-sql-when-chunksi", "title": "Large (6 million rows) pandas df causes memory error with `to_sql ` when chunksize =100, but can easily save file of 100,000 with no chunksize", "body": "<p>I created a large database in Pandas, about 6 million rows of text data. I wanted to save this as a SQL database file, but when I try to save it, I get an out of memory RAM error. I even reduced the chuck size to 100 and it still crashes. </p>\n\n<p>However, if I just have smaller version of that dataframe with 100,000 rows, and save it to a database with no chucksize specified, I have no issues saving tha dataframe. </p>\n\n<p>This is my code </p>\n\n<pre><code>from sqlalchemy import create_engine\nengine = sqlalchemy.create_engine(\"sqlite:///databasefile.db\")\ndataframe.to_sql(\"CS_table\", engine, chunksize = 100)\n</code></pre>\n\n<p>My understanding was that since it's only processing 100 rows at a time, the RAM usage should reflect that of a save of 100 rows. Is there something else happening behind the scenes? Perhaps multi-threading?</p>\n\n<p>Before I run this code, I am using 4.8 GB RAM, out of the 12.8 GB RAM available in Google Colab. Running the above code eats up all the RAM until the enviroment crashes. </p>\n\n<p>I would like to be able to save my pandas dataframe to a SQL file without my environment crashing. The environment I am in is Google Colab. The pandas datafame is 2 columns, ~6 million rows. Each cell contains about this much text:</p>\n\n<blockquote>\n  <p>\"The dominant sequence transduction models are based on complex\n  recurrent or convolutional neural networks in an encoder-decoder\n  configuration. The best performing models also connect the encoder and\n  decoder through an attention mechanism. We propose a new simple\n  network architecture, the Transformer, based solely on attention\n  mechanisms, dispensing with recurrence and convolutions entirely.\n  Experiments on two machine translation tasks show these models to be\n  superior in quality while being more parallelizable and requiring\n  significantly less time to train. Our model achieves 28.4 BLEU on the\n  WMT 2014 English-to-German translation task, improving over the\n  existing best results, including ensembles by over 2 BLEU. On the WMT\n  2014 English-to-French translation task, our model establishes a new\n  single-model state-of-the-art BLEU score of 41.8 after training for\n  3.5 days on eight GPUs, a small fraction of the training costs of the best models from the literature. We show that the Transformer\n  generalizes well to other tasks by applying it successfully to English\n  constituency parsing both with large and limited training data.\"</p>\n</blockquote>\n\n<p>Edit:</p>\n\n<p>I did a keyboard interrupts at various stages. Here is the results of a keyboard interrupt after the first jump in RAM</p>\n\n<pre><code>---------------------------------------------------------------------------\nKeyboardInterrupt                         Traceback (most recent call last)\n&lt;ipython-input-22-51b6e444f80d&gt; in &lt;module&gt;()\n----&gt; 1 dfAllT.to_sql(\"CS_table23\", engine, chunksize = 100)\n\n12 frames\n/usr/local/lib/python3.6/dist-packages/pandas/core/generic.py in to_sql(self, name, con, schema, if_exists, index, index_label, chunksize, dtype, method)\n   2529         sql.to_sql(self, name, con, schema=schema, if_exists=if_exists,\n   2530                    index=index, index_label=index_label, chunksize=chunksize,\n-&gt; 2531                    dtype=dtype, method=method)\n   2532 \n   2533     def to_pickle(self, path, compression='infer',\n\n/usr/local/lib/python3.6/dist-packages/pandas/io/sql.py in to_sql(frame, name, con, schema, if_exists, index, index_label, chunksize, dtype, method)\n    458     pandas_sql.to_sql(frame, name, if_exists=if_exists, index=index,\n    459                       index_label=index_label, schema=schema,\n--&gt; 460                       chunksize=chunksize, dtype=dtype, method=method)\n    461 \n    462 \n\n/usr/local/lib/python3.6/dist-packages/pandas/io/sql.py in to_sql(self, frame, name, if_exists, index, index_label, schema, chunksize, dtype, method)\n   1172                          schema=schema, dtype=dtype)\n   1173         table.create()\n-&gt; 1174         table.insert(chunksize, method=method)\n   1175         if (not name.isdigit() and not name.islower()):\n   1176             # check for potentially case sensitivity issues (GH7815)\n\n/usr/local/lib/python3.6/dist-packages/pandas/io/sql.py in insert(self, chunksize, method)\n    684 \n    685                 chunk_iter = zip(*[arr[start_i:end_i] for arr in data_list])\n--&gt; 686                 exec_insert(conn, keys, chunk_iter)\n    687 \n    688     def _query_iterator(self, result, chunksize, columns, coerce_float=True,\n\n/usr/local/lib/python3.6/dist-packages/pandas/io/sql.py in _execute_insert(self, conn, keys, data_iter)\n    597         \"\"\"\n    598         data = [dict(zip(keys, row)) for row in data_iter]\n--&gt; 599         conn.execute(self.table.insert(), data)\n    600 \n    601     def _execute_insert_multi(self, conn, keys, data_iter):\n\n/usr/local/lib/python3.6/dist-packages/sqlalchemy/engine/base.py in execute(self, object_, *multiparams, **params)\n    986             raise exc.ObjectNotExecutableError(object_)\n    987         else:\n--&gt; 988             return meth(self, multiparams, params)\n    989 \n    990     def _execute_function(self, func, multiparams, params):\n\n/usr/local/lib/python3.6/dist-packages/sqlalchemy/sql/elements.py in _execute_on_connection(self, connection, multiparams, params)\n    285     def _execute_on_connection(self, connection, multiparams, params):\n    286         if self.supports_execution:\n--&gt; 287             return connection._execute_clauseelement(self, multiparams, params)\n    288         else:\n    289             raise exc.ObjectNotExecutableError(self)\n\n/usr/local/lib/python3.6/dist-packages/sqlalchemy/engine/base.py in _execute_clauseelement(self, elem, multiparams, params)\n   1105             distilled_params,\n   1106             compiled_sql,\n-&gt; 1107             distilled_params,\n   1108         )\n   1109         if self._has_events or self.engine._has_events:\n\n/usr/local/lib/python3.6/dist-packages/sqlalchemy/engine/base.py in _execute_context(self, dialect, constructor, statement, parameters, *args)\n   1246         except BaseException as e:\n   1247             self._handle_dbapi_exception(\n-&gt; 1248                 e, statement, parameters, cursor, context\n   1249             )\n   1250 \n\n/usr/local/lib/python3.6/dist-packages/sqlalchemy/engine/base.py in _handle_dbapi_exception(self, e, statement, parameters, cursor, context)\n   1466                 util.raise_from_cause(sqlalchemy_exception, exc_info)\n   1467             else:\n-&gt; 1468                 util.reraise(*exc_info)\n   1469 \n   1470         finally:\n\n/usr/local/lib/python3.6/dist-packages/sqlalchemy/util/compat.py in reraise(tp, value, tb, cause)\n    127         if value.__traceback__ is not tb:\n    128             raise value.with_traceback(tb)\n--&gt; 129         raise value\n    130 \n    131     def u(s):\n\n/usr/local/lib/python3.6/dist-packages/sqlalchemy/engine/base.py in _execute_context(self, dialect, constructor, statement, parameters, *args)\n   1222                 if not evt_handled:\n   1223                     self.dialect.do_executemany(\n-&gt; 1224                         cursor, statement, parameters, context\n   1225                     )\n   1226             elif not parameters and context.no_parameters:\n\n/usr/local/lib/python3.6/dist-packages/sqlalchemy/engine/default.py in do_executemany(self, cursor, statement, parameters, context)\n    545 \n    546     def do_executemany(self, cursor, statement, parameters, context=None):\n--&gt; 547         cursor.executemany(statement, parameters)\n    548 \n    549     def do_execute(self, cursor, statement, parameters, context=None):\n\nKeyboardInterrupt: \n</code></pre>\n\n<p>Here is the result if I do a keyboard interrupt just before it crashes</p>\n\n<pre><code>ERROR:root:Internal Python error in the inspect module.\nBelow is the traceback from this internal error.\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/interactiveshell.py\", line 2882, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"&lt;ipython-input-24-68b60fe221fe&gt;\", line 1, in &lt;module&gt;\n    dfAllT.to_sql(\"CS_table22\", engine, chunksize = 100)\n  File \"/usr/local/lib/python3.6/dist-packages/pandas/core/generic.py\", line 2531, in to_sql\n    dtype=dtype, method=method)\n  File \"/usr/local/lib/python3.6/dist-packages/pandas/io/sql.py\", line 460, in to_sql\n    chunksize=chunksize, dtype=dtype, method=method)\n  File \"/usr/local/lib/python3.6/dist-packages/pandas/io/sql.py\", line 1174, in to_sql\n    table.insert(chunksize, method=method)\n  File \"/usr/local/lib/python3.6/dist-packages/pandas/io/sql.py\", line 686, in insert\n    exec_insert(conn, keys, chunk_iter)\n  File \"/usr/local/lib/python3.6/dist-packages/pandas/io/sql.py\", line 599, in _execute_insert\n    conn.execute(self.table.insert(), data)\n  File \"/usr/local/lib/python3.6/dist-packages/sqlalchemy/engine/base.py\", line 988, in execute\n    return meth(self, multiparams, params)\n  File \"/usr/local/lib/python3.6/dist-packages/sqlalchemy/sql/elements.py\", line 287, in _execute_on_connection\n    return connection._execute_clauseelement(self, multiparams, params)\n  File \"/usr/local/lib/python3.6/dist-packages/sqlalchemy/engine/base.py\", line 1107, in _execute_clauseelement\n    distilled_params,\n  File \"/usr/local/lib/python3.6/dist-packages/sqlalchemy/engine/base.py\", line 1248, in _execute_context\n    e, statement, parameters, cursor, context\n  File \"/usr/local/lib/python3.6/dist-packages/sqlalchemy/engine/base.py\", line 1468, in _handle_dbapi_exception\n    util.reraise(*exc_info)\n  File \"/usr/local/lib/python3.6/dist-packages/sqlalchemy/util/compat.py\", line 129, in reraise\n    raise value\n  File \"/usr/local/lib/python3.6/dist-packages/sqlalchemy/engine/base.py\", line 1224, in _execute_context\n    cursor, statement, parameters, context\n  File \"/usr/local/lib/python3.6/dist-packages/sqlalchemy/engine/default.py\", line 547, in do_executemany\n    cursor.executemany(statement, parameters)\nKeyboardInterrupt\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/interactiveshell.py\", line 1823, in showtraceback\n    stb = value._render_traceback_()\nAttributeError: 'KeyboardInterrupt' object has no attribute '_render_traceback_'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/ultratb.py\", line 1132, in get_records\n    return _fixed_getinnerframes(etb, number_of_lines_of_context, tb_offset)\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/ultratb.py\", line 313, in wrapped\n    return f(*args, **kwargs)\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/ultratb.py\", line 358, in _fixed_getinnerframes\n    records = fix_frame_records_filenames(inspect.getinnerframes(etb, context))\n  File \"/usr/lib/python3.6/inspect.py\", line 1488, in getinnerframes\n    frameinfo = (tb.tb_frame,) + getframeinfo(tb, context)\n  File \"/usr/lib/python3.6/inspect.py\", line 1446, in getframeinfo\n    filename = getsourcefile(frame) or getfile(frame)\n  File \"/usr/lib/python3.6/inspect.py\", line 696, in getsourcefile\n    if getattr(getmodule(object, filename), '__loader__', None) is not None:\n  File \"/usr/lib/python3.6/inspect.py\", line 739, in getmodule\n    f = getabsfile(module)\n  File \"/usr/lib/python3.6/inspect.py\", line 708, in getabsfile\n    _filename = getsourcefile(object) or getfile(object)\n  File \"/usr/lib/python3.6/inspect.py\", line 693, in getsourcefile\n    if os.path.exists(filename):\n  File \"/usr/lib/python3.6/genericpath.py\", line 19, in exists\n    os.stat(path)\nKeyboardInterrupt\n</code></pre>\n\n<p>I did another run right before it crashed, and this seemed to give another different result</p>\n\n<pre><code>ERROR:root:Internal Python error in the inspect module.\nBelow is the traceback from this internal error.\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/interactiveshell.py\", line 2882, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"&lt;ipython-input-28-f18004debe33&gt;\", line 1, in &lt;module&gt;\n    dfAllT.to_sql(\"CS_table25\", engine, chunksize = 100)\n  File \"/usr/local/lib/python3.6/dist-packages/pandas/core/generic.py\", line 2531, in to_sql\n    dtype=dtype, method=method)\n  File \"/usr/local/lib/python3.6/dist-packages/pandas/io/sql.py\", line 460, in to_sql\n    chunksize=chunksize, dtype=dtype, method=method)\n  File \"/usr/local/lib/python3.6/dist-packages/pandas/io/sql.py\", line 1174, in to_sql\n    table.insert(chunksize, method=method)\n  File \"/usr/local/lib/python3.6/dist-packages/pandas/io/sql.py\", line 686, in insert\n    exec_insert(conn, keys, chunk_iter)\n  File \"/usr/local/lib/python3.6/dist-packages/pandas/io/sql.py\", line 598, in _execute_insert\n    data = [dict(zip(keys, row)) for row in data_iter]\n  File \"/usr/local/lib/python3.6/dist-packages/pandas/io/sql.py\", line 598, in &lt;listcomp&gt;\n    data = [dict(zip(keys, row)) for row in data_iter]\nKeyboardInterrupt\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/interactiveshell.py\", line 1823, in showtraceback\n    stb = value._render_traceback_()\nAttributeError: 'KeyboardInterrupt' object has no attribute '_render_traceback_'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/ultratb.py\", line 1132, in get_records\n    return _fixed_getinnerframes(etb, number_of_lines_of_context, tb_offset)\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/ultratb.py\", line 313, in wrapped\n    return f(*args, **kwargs)\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/ultratb.py\", line 358, in _fixed_getinnerframes\n    records = fix_frame_records_filenames(inspect.getinnerframes(etb, context))\n  File \"/usr/lib/python3.6/inspect.py\", line 1488, in getinnerframes\n    frameinfo = (tb.tb_frame,) + getframeinfo(tb, context)\n  File \"/usr/lib/python3.6/inspect.py\", line 1446, in getframeinfo\n    filename = getsourcefile(frame) or getfile(frame)\n  File \"/usr/lib/python3.6/inspect.py\", line 696, in getsourcefile\n    if getattr(getmodule(object, filename), '__loader__', None) is not None:\n  File \"/usr/lib/python3.6/inspect.py\", line 742, in getmodule\n    os.path.realpath(f)] = module.__name__\n  File \"/usr/lib/python3.6/posixpath.py\", line 388, in realpath\n    path, ok = _joinrealpath(filename[:0], filename, {})\n  File \"/usr/lib/python3.6/posixpath.py\", line 421, in _joinrealpath\n    newpath = join(path, name)\nKeyboardInterrupt\n---------------------------------------------------------------------------\n</code></pre>\n\n<p>Other things I have tried:</p>\n\n<p>Using dropna to drop all none/nan values</p>\n\n<p>dfAllT = dfAllT.applymap(str) to make sure all my values are strings</p>\n\n<p>dfAllT.reset_index(drop=True, inplace=True) to make sure index is not out of alignment. </p>\n\n<p>Edit:</p>\n\n<p>Like what is mentioned in the comment, I have now tried to use to_sql in a loop. </p>\n\n<pre><code>for i in range(586147):\n    print(i)\n    dfAllT.iloc[i*10000:(i+1)*10000].to_sql('CS_table', engine, if_exists= 'append')\n</code></pre>\n\n<p>This operation eventually eats at my RAM, and eventually causes a crash about halfway through. I wonder if this suggests that sqlite is holding everything in memory, and if there is a work around.  </p>\n\n<p>Edit:</p>\n\n<p>I tried a few more things, shorter chucks, disposing the engine after each step and creating a new one. Still eventually ate of all RAM and crashed.  </p>\n\n<pre><code>for i in range(586147):\n    print(i)\n    engine = sqlalchemy.create_engine(\"sqlite:///CSTitlesSummariesData.db\")\n    dfAllT.iloc[i*10:(i+1)*10].to_sql('CS_table', engine, index = False, if_exists= 'append')\n    engine.dispose() \n    gc.collect \n</code></pre>\n\n<p>My thoughts:</p>\n\n<p>So it looks like somehow the entire database is somehow kept in active memory somehow. </p>\n\n<p>The pandas dataframe from which this is made from was 5 gigs (or at least that's how much RAM is being before I try to convert it to sqlite). My system crashes at around 12.72 gigs. I would imagine the sqlite database takes of less RAM than the pandas dataframe. </p>\n"}, {"tags": ["python", "python-2.7", "flask"], "comments": [{"owner": {"reputation": 5131, "user_id": 7919597, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/905688a3a3921c2f03f4914e943e1915?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7919597/joe"}, "edited": false, "score": 0, "creation_date": 1559203815, "post_id": 56369542, "comment_id": 99350004, "body": "Which error is thrown?"}, {"owner": {"reputation": 5131, "user_id": 7919597, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/905688a3a3921c2f03f4914e943e1915?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7919597/joe"}, "edited": false, "score": 0, "creation_date": 1559204099, "post_id": 56369542, "comment_id": 99350109, "body": "Works fine for me if I change <code>static&#47;poll.lock</code> to <code>&#47;tmp&#47;poll.lock</code>."}, {"owner": {"reputation": 2503, "user_id": 1860317, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/N5IVQ.jpg?s=128&g=1", "display_name": "MoreScratch", "link": "https://stackoverflow.com/users/1860317/morescratch"}, "reply_to_user": {"reputation": 5131, "user_id": 7919597, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/905688a3a3921c2f03f4914e943e1915?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7919597/joe"}, "edited": false, "score": 0, "creation_date": 1559223675, "post_id": 56369542, "comment_id": 99359200, "body": "I added the error. Still throws an exception when moving the lock file to the <code>tmp</code> directory as suggested."}, {"owner": {"reputation": 5131, "user_id": 7919597, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/905688a3a3921c2f03f4914e943e1915?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7919597/joe"}, "edited": false, "score": 0, "creation_date": 1559225419, "post_id": 56369542, "comment_id": 99360142, "body": "<a href=\"https://stackoverflow.com/questions/52427999/python-flask-app-not-exiting-with-sys-exit\" title=\"python flask app not exiting with sys exit\">stackoverflow.com/questions/52427999/&hellip;</a>"}, {"owner": {"reputation": 5131, "user_id": 7919597, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/905688a3a3921c2f03f4914e943e1915?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7919597/joe"}, "edited": false, "score": 0, "creation_date": 1559225523, "post_id": 56369542, "comment_id": 99360203, "body": "The file can stay in <code>static</code>, this won&#39;t change anything. I just used a different path."}, {"owner": {"reputation": 5131, "user_id": 7919597, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/905688a3a3921c2f03f4914e943e1915?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7919597/joe"}, "edited": false, "score": 3, "creation_date": 1559225568, "post_id": 56369542, "comment_id": 99360228, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/52427999/python-flask-app-not-exiting-with-sys-exit\">Python Flask app not exiting with sys exit</a>"}, {"owner": {"reputation": 2503, "user_id": 1860317, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/N5IVQ.jpg?s=128&g=1", "display_name": "MoreScratch", "link": "https://stackoverflow.com/users/1860317/morescratch"}, "reply_to_user": {"reputation": 5131, "user_id": 7919597, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/905688a3a3921c2f03f4914e943e1915?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7919597/joe"}, "edited": false, "score": 0, "creation_date": 1559225636, "post_id": 56369542, "comment_id": 99360263, "body": "I don&#39;t want Flask to exit, I just need the imported function <code>poll</code> to stop executing if a lock file is found."}], "answers": [{"tags": [], "owner": {"reputation": 5131, "user_id": 7919597, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/905688a3a3921c2f03f4914e943e1915?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7919597/joe"}, "is_accepted": true, "score": 0, "last_activity_date": 1559225884, "creation_date": 1559225884, "answer_id": 56380044, "question_id": 56369542, "link": "https://stackoverflow.com/questions/56369542/how-to-exit-a-python-script-called-in-a-flask-app/56380044#56380044", "title": "How to exit a python script called in a Flask app?", "body": "<p>Then just don't do anything or flip the order of your <code>if</code> statement:</p>\n\n<pre><code>import os\nimport sys\n\nif not os.path.exists('static/poll.lock'):\n\n    with open('static/poll.lock', 'w'): \n\n        pass\n\nelse:\n\n    pass\n    # do something\n</code></pre>\n"}], "owner": {"reputation": 2503, "user_id": 1860317, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/N5IVQ.jpg?s=128&g=1", "display_name": "MoreScratch", "link": "https://stackoverflow.com/users/1860317/morescratch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "accepted_answer_id": 56380044, "answer_count": 1, "score": 0, "last_activity_date": 1559225884, "creation_date": 1559170575, "last_edit_date": 1559223606, "question_id": 56369542, "link": "https://stackoverflow.com/questions/56369542/how-to-exit-a-python-script-called-in-a-flask-app", "title": "How to exit a python script called in a Flask app?", "body": "<p>I have a flask app where I am reusing a function in a python script (poll_servers.py). I can import the function and run it but I want to put a check in place that exits the function if it's running.</p>\n\n<p>Here is my code in the python script:</p>\n\n<pre><code>import os\nimport sys\n\n# check if lock file exists, exit\nif os.path.exists('static/poll.lock'):\n    sys.exit(1)\n\nif not os.path.exists('static/poll.lock'):\n    with open('static/poll.lock', 'w'): pass\n</code></pre>\n\n<p>In my app.py I have:</p>\n\n<pre><code>from poll_servers import poll\n\n@app.route('/poll_servers', methods=['GET'])\ndef poll_servers():\n\n    response = json.dumps({'status':'OK'})\n\n    poll()\n\n    return response\n</code></pre>\n\n<p>I get an error on the <code>sys.exit(1)</code> in poll_servers.py:</p>\n\n<pre><code>File \"app.py\", line 109, in poll_servers\n  poll()\nFile \".../poll_servers.py\", line 262, in poll\n  sys.exit(1)\nFile \".../venv/lib/python2.7/site.py\", line 403, in __call__\n  raise SystemExit(code)\nSystemExit: None\n</code></pre>\n\n<p>Any ideas? If I run the poll_servers.py on its own the <code>sys.exit(1)</code> works fine.</p>\n"}, {"tags": ["python", "dictionary", "key"], "comments": [{"owner": {"reputation": 309, "user_id": 11575409, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MYGv2z2J5Aw/AAAAAAAAAAI/AAAAAAAAF50/I64monajDZo/photo.jpg?sz=128", "display_name": "PhantomQuest", "link": "https://stackoverflow.com/users/11575409/phantomquest"}, "reply_to_user": {"reputation": 263603, "user_id": 674039, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/leoFi.gif?s=128&g=1", "display_name": "wim", "link": "https://stackoverflow.com/users/674039/wim"}, "edited": false, "score": 0, "creation_date": 1559170800, "post_id": 56369521, "comment_id": 99341678, "body": "that&#39;s a duplicate. I want to copy, for example, only <code>a</code> over. I hope to iterate through <code>dict</code> and keys that fit a condition are then stored into <code>new_dict</code>."}, {"owner": {"reputation": 63658, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 0, "creation_date": 1559170834, "post_id": 56369521, "comment_id": 99341685, "body": "For starters, the whole point of <code>update</code> is to do: <code>new_dict.update(old_dict)</code>. To assign <i>a single item</i>, use <code>new_dict[some_key] = some_value</code>, if you <i>really</i> must use <code>update</code> (you don&#39;t) then you can do the overwrought <code>new_dict.update({some_key:some_value})</code> or even more overwrought <code>new_dict.update([(some_key, some_value)])</code>"}], "answers": [{"comments": [{"owner": {"reputation": 309, "user_id": 11575409, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MYGv2z2J5Aw/AAAAAAAAAAI/AAAAAAAAF50/I64monajDZo/photo.jpg?sz=128", "display_name": "PhantomQuest", "link": "https://stackoverflow.com/users/11575409/phantomquest"}, "edited": false, "score": 0, "creation_date": 1559171006, "post_id": 56369567, "comment_id": 99341717, "body": "Works like a charm!"}], "tags": [], "owner": {"reputation": 2612, "user_id": 293691, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xte0f.jpg?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/293691/jay"}, "is_accepted": true, "score": 0, "last_activity_date": 1559170777, "creation_date": 1559170777, "answer_id": 56369567, "question_id": 56369521, "link": "https://stackoverflow.com/questions/56369521/use-variable-storing-key-from-dict1-as-new-key-for-dict2/56369567#56369567", "title": "Use variable storing key from dict1 as new key for dict2", "body": "<p>This worked for me:</p>\n\n<pre><code>$ python\nPython 3.7.2 (default, Dec 27 2018, 07:35:06) \n&gt;&gt;&gt; d1 = {'a':1,'b':2}\n&gt;&gt;&gt; d2 = {}\n&gt;&gt;&gt; for k,v in d1.items():\n...     if True:\n...             d2[k] = v\n... \n&gt;&gt;&gt; d2\n{'a': 1, 'b': 2}\n</code></pre>\n\n<p>You would just replace <code>if True</code> with your condition.</p>\n\n<p>See here for some more info on looping over dictionaries: <a href=\"https://docs.python.org/3/tutorial/datastructures.html#looping-techniques\" rel=\"nofollow noreferrer\">https://docs.python.org/3/tutorial/datastructures.html#looping-techniques</a></p>\n"}], "owner": {"reputation": 309, "user_id": 11575409, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MYGv2z2J5Aw/AAAAAAAAAAI/AAAAAAAAF50/I64monajDZo/photo.jpg?sz=128", "display_name": "PhantomQuest", "link": "https://stackoverflow.com/users/11575409/phantomquest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 56369567, "answer_count": 1, "score": 0, "last_activity_date": 1559170852, "creation_date": 1559170396, "last_edit_date": 1559170852, "question_id": 56369521, "link": "https://stackoverflow.com/questions/56369521/use-variable-storing-key-from-dict1-as-new-key-for-dict2", "title": "Use variable storing key from dict1 as new key for dict2", "body": "<p>I want to pull keys and their values from a dictionary that meet conditions, then store them in another dictionary. What I thought of so far was:</p>\n\n<pre><code>dict = {'a': 1, 'b': 2}\nnew_dict = {}\nfor x in dict:\n    new_dict.update(x=dict[x])\nprint (dict)\nprint (new_dict)\n</code></pre>\n\n<p>Here, <code>x</code> stores a key <code>'a'</code> with value <code>1</code>, but when I update <code>new_dict</code>, it stores <code>x: 2</code>, meaning during the first loop it created a new key <code>x</code> and reinitialized the key during the second loop. It means that Python is interpreting <code>x</code> as a literal.</p>\n\n<p>Is there anyway to have <code>new_dict</code> store <code>'a': 1</code> and <code>'b': 2</code>?</p>\n"}, {"tags": ["python", "random-forest", "mse"], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 10930194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xptai.png?s=128&g=1", "display_name": "Freddy Daniel", "link": "https://stackoverflow.com/users/10930194/freddy-daniel"}, "edited": false, "score": 0, "creation_date": 1559184022, "post_id": 56369702, "comment_id": 99344214, "body": "what is the difference between the confusion matrix? i can confide in a confusion matrix from sklearn?"}, {"owner": {"reputation": 79, "user_id": 11384930, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5qgQVaPXLHA/AAAAAAAAAAI/AAAAAAAACrY/mFFSTV1nx0s/photo.jpg?sz=128", "display_name": "Zhendong Cao", "link": "https://stackoverflow.com/users/11384930/zhendong-cao"}, "edited": false, "score": 0, "creation_date": 1559195955, "post_id": 56369702, "comment_id": 99346715, "body": "@Mario, thank you for your quick answer. Your answer is a general explanation of what MSE is. But I think MSE calculation in RF regression is different. MSE here is a split criterion; based on my understanding, this means we have to calculate many MSEs due to various potential split points, and find the split point which results in a minimum MSE. But again, I don&#39;t really know how it is calculated in RF Regression model."}, {"owner": {"reputation": 79, "user_id": 11384930, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5qgQVaPXLHA/AAAAAAAAAAI/AAAAAAAACrY/mFFSTV1nx0s/photo.jpg?sz=128", "display_name": "Zhendong Cao", "link": "https://stackoverflow.com/users/11384930/zhendong-cao"}, "edited": false, "score": 0, "creation_date": 1559229338, "post_id": 56369702, "comment_id": 99362268, "body": "@Mario Let&#39;s make up an example to show my question clearer.  We have a dataset with two features A and B and one target C. At one node (assume we have m numbers of feature A here), we randomly pick feature A for split. What does RF do? It will try each value of A from the m numbers and find the best value of A for split which gives smallest MSE after this split.  I think MSE of one split is the sum of MSEs in the two sub-nodes. You need a comparison of m MSE values, i.e., MSE is calculated per potential split point, not at the end of the tree. Is that correct?"}, {"owner": {"reputation": 821, "user_id": 10452700, "user_type": "registered", "profile_image": "https://graph.facebook.com/2172245999723325/picture?type=large", "display_name": "Mario", "link": "https://stackoverflow.com/users/10452700/mario"}, "reply_to_user": {"reputation": 79, "user_id": 11384930, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5qgQVaPXLHA/AAAAAAAAAAI/AAAAAAAACrY/mFFSTV1nx0s/photo.jpg?sz=128", "display_name": "Zhendong Cao", "link": "https://stackoverflow.com/users/11384930/zhendong-cao"}, "edited": false, "score": 0, "creation_date": 1559233993, "post_id": 56369702, "comment_id": 99364711, "body": "@ZhendongCao Based on documentation in <code>sklearn</code>, RandomForrest Regressor <code>criterion</code> is: <b>The function to measure the quality of a split</b> It&#39;s a performance measure (by default, MSE) which helps the algorithm to decide on a rule for an optimum split on a node in a tree. You can check it out this <a href=\"http://www.jmlr.org/papers/volume13/biau12a/biau12a.pdf\" rel=\"nofollow noreferrer\">paper</a> and its computation for better understanding. I assume that it checks every split point and take average over all of&#39;em."}], "tags": [], "owner": {"reputation": 821, "user_id": 10452700, "user_type": "registered", "profile_image": "https://graph.facebook.com/2172245999723325/picture?type=large", "display_name": "Mario", "link": "https://stackoverflow.com/users/10452700/mario"}, "is_accepted": false, "score": 2, "last_activity_date": 1559211337, "last_edit_date": 1559211337, "creation_date": 1559171945, "answer_id": 56369702, "question_id": 56369519, "link": "https://stackoverflow.com/questions/56369519/how-to-calculate-mse-criteria-in-randomforestregression/56369702#56369702", "title": "How to calculate MSE criteria in RandomForestRegression?", "body": "<p>If I want to answer shortly this metric which is one of cost function methods, if you consider that your model is following green line in below picture and those blue points are your data MSE ast its name suggests is mean of summation of square areas of all data points with respect to line which all in all represents your <strong>model errors</strong>.\n<img src=\"https://i.imgur.com/bnky0uZ.jpg\" alt=\"img\">\nMSE can be calculated by:</p>\n\n<p><img src=\"https://i.imgur.com/SMzQkQG.jpg\" alt=\"img\"></p>\n\n<p>It shows <strong>how good or bad is our medel</strong>. The <strong>smaller</strong> MSE, the <strong>better</strong> model!</p>\n\n<p>More info: </p>\n\n<p><a href=\"https://www.dataquest.io/blog/understanding-regression-error-metrics/\" rel=\"nofollow noreferrer\">Understanding Regression Error Metrics in Python</a></p>\n\n<p><a href=\"https://blog.algorithmia.com/introduction-to-loss-functions/\" rel=\"nofollow noreferrer\">Introduction to Loss Functions</a></p>\n\n<p><strong>Update 30.05.2019:</strong> To verify things, you can dig into documentation and sometimes in codes as well, based on its documentation <a href=\"https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html\" rel=\"nofollow noreferrer\">.RandomForestRegressor</a> , MSE is nothing else than <strong>variance reduction</strong> as feature selection criterion even when you check source code it is used for <strong>measuring the quality of a split</strong>. In another hand , if you are doubtful rather to MSE approach in <code>.RandomForestRegressor</code>  you can use independently by customizing <code>criterion</code> like this:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>from sklearn.metrics import mean_squared_error\nfrom sklearn.ensemble import RandomForestRegressor\n#Feature Selection\ncriterion = mean_squared_error(y, predictions)\nRandomForestRegressor( ...,criterion= criterion,...)\n</code></pre>\n\n<p>or using numpy:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import numpy as np\ncriterion = np.mean((y_test - est.predict(X_test))**2)\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 11384930, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5qgQVaPXLHA/AAAAAAAAAAI/AAAAAAAACrY/mFFSTV1nx0s/photo.jpg?sz=128", "display_name": "Zhendong Cao", "link": "https://stackoverflow.com/users/11384930/zhendong-cao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559211337, "creation_date": 1559170382, "question_id": 56369519, "link": "https://stackoverflow.com/questions/56369519/how-to-calculate-mse-criteria-in-randomforestregression", "title": "How to calculate MSE criteria in RandomForestRegression?", "body": "<p>I'm now using RandomForestRegressor from sklearn.ensemble to analyze a dataset and I select \"mse\" as the function to measure the quality of a split. But I'm not quite clear how the mse is calculated. Could anyone explain it to me here (better with equations) or provide me some references on that? Thank you in advance.</p>\n"}, {"tags": ["python", "dataframe", "pyspark"], "comments": [{"owner": {"reputation": 7150, "user_id": 6664872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b614de34b679a1be4d95c3e22fe82b4e?s=128&d=identicon&r=PG&f=1", "display_name": "cronoik", "link": "https://stackoverflow.com/users/6664872/cronoik"}, "edited": false, "score": 0, "creation_date": 1559172509, "post_id": 56369502, "comment_id": 99342031, "body": "What problem do you face? Currently it sounds like that you have to create two dataframes from your data. Do your transformations on one of the dataframes and do a union with the other dataframe."}, {"owner": {"reputation": 105, "user_id": 8442319, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/228060bf7050b0d679de8b59a77f804b?s=128&d=identicon&r=PG&f=1", "display_name": "iratelilkid", "link": "https://stackoverflow.com/users/8442319/iratelilkid"}, "reply_to_user": {"reputation": 7150, "user_id": 6664872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b614de34b679a1be4d95c3e22fe82b4e?s=128&d=identicon&r=PG&f=1", "display_name": "cronoik", "link": "https://stackoverflow.com/users/6664872/cronoik"}, "edited": false, "score": 0, "creation_date": 1559225540, "post_id": 56369502, "comment_id": 99360212, "body": "I want to update the snapshotEndDate for the old records."}], "answers": [{"tags": [], "owner": {"reputation": 7150, "user_id": 6664872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b614de34b679a1be4d95c3e22fe82b4e?s=128&d=identicon&r=PG&f=1", "display_name": "cronoik", "link": "https://stackoverflow.com/users/6664872/cronoik"}, "is_accepted": false, "score": 0, "last_activity_date": 1559351075, "creation_date": 1559351075, "answer_id": 56403147, "question_id": 56369502, "link": "https://stackoverflow.com/questions/56369502/update-old-records-with-new-information-in-pyspark-without-overwriting/56403147#56403147", "title": "Update old records with new information in pyspark without overwriting", "body": "<p>The first thing you have to do, is to create two dataframes from your data (<code>dfold</code> and <code>dfnew</code> in the following example)</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import datetime\nimport pyspark.sql.functions as F\nl = [\n ('John',      'Doe'    ,  '2017-04-05',  '2017-05-04' ,        '2099-12-31'),\n ('Jane' ,      'Smith'  ,  '2018-04-05',  '2017-05-04' ,        '2099-12-31')\n    ]\n\ncolumns = [     'FirstName' , 'LastName', 'JoinDate'  , 'SnapshotBeginDate' , 'SnapshotEndDate']\n\ndfold=spark.createDataFrame(l, columns)\ndfold = dfold.withColumn('SnapshotBeginDate',   F.to_date(dfold.SnapshotBeginDate,  'yyyy-MM-dd'))\ndfold = dfold.withColumn('SnapshotEndDate',   F.to_date(dfold.SnapshotEndDate,  'yyyy-MM-dd'))\ndfnew = dfold\n</code></pre>\n\n<p>You can update the SnapshotEndDate column of <code>dfold</code> and the SnapshotBeginDate of the <code>dfnew</code> with the <a href=\"http://spark.apache.org/docs/2.2.1/api/python/pyspark.sql.html#pyspark.sql.DataFrame.withColumn\" rel=\"nofollow noreferrer\">withColumn</a> function. This function allows you to apply an operation to a column. You also need the current date to update the values. The python module datetime provides such a functionality (in case you don't need the current date, just specify any other date as string), but doesn't return a column. To turn the return object into a column, we can use the pyspark <a href=\"http://spark.apache.org/docs/2.2.1/api/python/pyspark.sql.html#pyspark.sql.functions.lit\" rel=\"nofollow noreferrer\">lit</a> function.  </p>\n\n<pre class=\"lang-py prettyprint-override\"><code>dfold= dfold.withColumn('SnapshotEndDate', F.lit(datetime.date.today()))\ndfnew= dfnew.withColumn('SnapshotBeginDate', F.lit(datetime.date.today()))\ndfold.union(dfnew).show()\n</code></pre>\n\n<p>Output:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>+---------+--------+----------+-----------------+---------------+ \n|FirstName|LastName|  JoinDate|SnapshotBeginDate|SnapshotEndDate| \n+---------+--------+----------+-----------------+---------------+ \n|     John|     Doe|2017-04-05|       2017-05-04|     2019-06-01| \n|     Jane|   Smith|2018-04-05|       2017-05-04|     2019-06-01| \n|     John|     Doe|2017-04-05|       2019-06-01|     2099-12-31| \n|     Jane|   Smith|2018-04-05|       2019-06-01|     2099-12-31| \n+---------+--------+----------+-----------------+---------------+\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 8442319, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/228060bf7050b0d679de8b59a77f804b?s=128&d=identicon&r=PG&f=1", "display_name": "iratelilkid", "link": "https://stackoverflow.com/users/8442319/iratelilkid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559351075, "creation_date": 1559170284, "question_id": 56369502, "link": "https://stackoverflow.com/questions/56369502/update-old-records-with-new-information-in-pyspark-without-overwriting", "title": "Update old records with new information in pyspark without overwriting", "body": "<p>I want to update the old records based on the information I may or may not get from the new instance of the same record in pyspark.\nThis is what the old table/dataframe looks like</p>\n\n<pre><code>| FirstName | LastName | JoinDate  | SnapshotBeginDate | SnapshotEndDate |           \n-------------------------------------------------------------------------\n| John      | Doe      |2017-04-05 | 2017-05-04        | 2099-12-31      |\n-------------------------------------------------------------------------\n| Jane      | Smith    |2018-04-05 | 2017-05-04        | 2099-12-31 |\n-------------------------------------------------------------------------\n</code></pre>\n\n<p>I do not want to merely append the new data to the existing dataframe. Nor do I want to overwrite the existing record. I would instead want to update the snapshotEndDate of the old record. </p>\n\n<p>For eg:</p>\n\n<pre><code>| FirstName | LastName | JoinDate  | SnapshotBeginDate | SnapshotEndDate |           \n-------------------------------------------------------------------------\n| John      | Doe      |2017-04-05 | 2017-05-04        | 2019-04-03      |\n-------------------------------------------------------------------------\n| Jane      | Smith    |2018-04-05 | 2017-05-04        | 2019-04-03|\n-------------------------------------------------------------------------\n| John      | Doe      |2017-04-05 | 2019-04-03        | 2099-12-31|\n-------------------------------------------------------------------------\n| Jane      | Smith    |2018-04-05 | 2019-04-03        | 2099-12-31|\n-------------------------------------------------------------------------\n</code></pre>\n"}, {"tags": ["python", "pyautogui"], "comments": [{"owner": {"reputation": 1669, "user_id": 9042078, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6avg1.jpg?s=128&g=1", "display_name": "Vasu Deo.S", "link": "https://stackoverflow.com/users/9042078/vasu-deo-s"}, "edited": false, "score": 0, "creation_date": 1559177082, "post_id": 56369494, "comment_id": 99342934, "body": "can this be made such that once the hotkey combination is pressed by the user then the click happens"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11072447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb00aa17d8c4f0bf00a24fee56ba1f1?s=128&d=identicon&r=PG&f=1", "display_name": "yoyojambo", "link": "https://stackoverflow.com/users/11072447/yoyojambo"}, "is_accepted": false, "score": 0, "last_activity_date": 1559172143, "creation_date": 1559172143, "answer_id": 56369717, "question_id": 56369494, "link": "https://stackoverflow.com/questions/56369494/is-it-possible-to-combine-hotkey-and-mouse-click-to-select-a-menu-item/56369717#56369717", "title": "Is it possible to combine HotKey and mouse click to select a menu item?", "body": "<p>Does the code also releases the pressing of the buttons? It seems right to me for the most part, but I don't know if I am getting this right.</p>\n"}, {"tags": [], "owner": {"reputation": 114, "user_id": 3479333, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bycIl.jpg?s=128&g=1", "display_name": "BeHappy", "link": "https://stackoverflow.com/users/3479333/behappy"}, "is_accepted": false, "score": 0, "last_activity_date": 1561150740, "creation_date": 1561150740, "answer_id": 56710396, "question_id": 56369494, "link": "https://stackoverflow.com/questions/56369494/is-it-possible-to-combine-hotkey-and-mouse-click-to-select-a-menu-item/56710396#56710396", "title": "Is it possible to combine HotKey and mouse click to select a menu item?", "body": "<p>Instead of click, I used first MoveTo and then click command. \nTechnically click(x,y) should do both but breaking my work in two solved my problem. </p>\n"}], "owner": {"reputation": 114, "user_id": 3479333, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bycIl.jpg?s=128&g=1", "display_name": "BeHappy", "link": "https://stackoverflow.com/users/3479333/behappy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 204, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1561150740, "creation_date": 1559170205, "last_edit_date": 1559172464, "question_id": 56369494, "link": "https://stackoverflow.com/questions/56369494/is-it-possible-to-combine-hotkey-and-mouse-click-to-select-a-menu-item", "title": "Is it possible to combine HotKey and mouse click to select a menu item?", "body": "<p>I have an app that requires multiple key press AND mouse click at same time, in order to access a menu item.\nI need to automate this part and I tried </p>\n\n<pre><code>pyautogui.click(image1.x, image1.y) AND pyautogui.hotkey('ctrl', 'shft', 'alt')\n</code></pre>\n\n<p>I also tried</p>\n\n<pre><code>            pyautogui.keyDown('shift')  # hold down the shift key\n            pyautogui.keyDown('alt')  # hold down the shift key\n            pyautogui.keyDown('ctrl')  # hold down the shift key\n            pyautogui.click(image1.x, image1.y)\n</code></pre>\n\n<p>I see click operation but not with keys. I need click and keys pressed action at the same time.\nNote that I have access to window.\nIs there any other tool or package I can use for this?\nIs there a way to for me to see what key press is actually happening or events?\nThank you for help</p>\n"}, {"tags": ["python", "csv"], "comments": [{"owner": {"reputation": 924, "user_id": 2738782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5a8be67b32a22ce530c594030050b07?s=128&d=identicon&r=PG&f=1", "display_name": "Maximus", "link": "https://stackoverflow.com/users/2738782/maximus"}, "edited": false, "score": 0, "creation_date": 1559170620, "post_id": 56369488, "comment_id": 99341637, "body": "I ran this and it worked fine for me. CSV output was 1.5458,1.2585,3.5687"}, {"owner": {"reputation": 268354, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "edited": false, "score": 0, "creation_date": 1559170736, "post_id": 56369488, "comment_id": 99341667, "body": "*Excel, *CSV (Comma Separated Values). I can forgive the other grammatical mistakes but you should do your due diligence and at least learn the spellings of the tools you are working with."}, {"owner": {"reputation": 137, "user_id": 11131251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab2863bd579351133ba71c5889eda3dd?s=128&d=identicon&r=PG", "display_name": "chrisis", "link": "https://stackoverflow.com/users/11131251/chrisis"}, "edited": false, "score": 0, "creation_date": 1559647752, "post_id": 56369488, "comment_id": 99479292, "body": "Hi sorry for the late answer and thanks agian for your comment. By the way. My vector is a bit different. It looks like the following one:"}, {"owner": {"reputation": 137, "user_id": 11131251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab2863bd579351133ba71c5889eda3dd?s=128&d=identicon&r=PG", "display_name": "chrisis", "link": "https://stackoverflow.com/users/11131251/chrisis"}, "edited": false, "score": 0, "creation_date": 1559647772, "post_id": 56369488, "comment_id": 99479300, "body": "a=[[16.027 16.027]  [42.427 42.427]  [52.822 52.822]  ]"}, {"owner": {"reputation": 137, "user_id": 11131251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab2863bd579351133ba71c5889eda3dd?s=128&d=identicon&r=PG", "display_name": "chrisis", "link": "https://stackoverflow.com/users/11131251/chrisis"}, "edited": false, "score": 0, "creation_date": 1559647807, "post_id": 56369488, "comment_id": 99479321, "body": "Do you know how to allocate in each excell cell the corresponding number in the vector above?"}], "answers": [{"tags": [], "owner": {"reputation": 76, "user_id": 10762297, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xhpUsiovut8/AAAAAAAAAAI/AAAAAAAAAo4/Y8hPL5JxQ2w/photo.jpg?sz=128", "display_name": "drHodge", "link": "https://stackoverflow.com/users/10762297/drhodge"}, "is_accepted": false, "score": 1, "last_activity_date": 1559171101, "creation_date": 1559171101, "answer_id": 56369603, "question_id": 56369488, "link": "https://stackoverflow.com/questions/56369488/delete-square-brackets-in-the-csv-fie/56369603#56369603", "title": "Delete square brackets in the CSV fie", "body": "<p>Excel can be a bit picky when opening flat text files such as CSV.  Sometimes it will automatically place items into separate columns other times it won't.  It seems the last setting used on \"Text to columns\" feature \"sticks\" until you close Excel.</p>\n\n<p>Close all your open Excel windows then reopen the file.</p>\n\n<p>Also just open the file in notepad to check that it looks ok.  Don't allow the complexity of everything Excel does to complicate things.  Sorry this is an answer and not a comment, I am new to this site and don't have enough points to comment yet :-( </p>\n"}], "owner": {"reputation": 137, "user_id": 11131251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab2863bd579351133ba71c5889eda3dd?s=128&d=identicon&r=PG", "display_name": "chrisis", "link": "https://stackoverflow.com/users/11131251/chrisis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559171101, "creation_date": 1559170119, "last_edit_date": 1559170694, "question_id": 56369488, "link": "https://stackoverflow.com/questions/56369488/delete-square-brackets-in-the-csv-fie", "title": "Delete square brackets in the CSV fie", "body": "<p>I plot the results from python to CSV file. Unfortunately, the data plotted on the CSV file is difficult to edit. In fact each cell of Excel contains a data wrapped by square brackets. How would it be possible to delete the square brackets in the CSV file? </p>\n\n<p>Here below you can find the code. </p>\n\n<pre><code>a=[[1.5458, 1.2585, 3.5687]]\nS=([\"S\"], np.round(a,3), {' [MPa]'})\nwith open('Output.csv', 'w', newline='') as dest:\n    thewriter = csv.writer(dest, delimiter=',')\n    thewriter.writerows(a)\n</code></pre>\n\n<p>The output the I would like to get in the CSV file is the following one:</p>\n\n<pre><code>1.5458 1.2585 3.5687\n</code></pre>\n\n<p>Each number appears in a single cell of Excel.</p>\n"}, {"tags": ["python"], "comments": [{"owner": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "edited": false, "score": 0, "creation_date": 1559170249, "post_id": 56369483, "comment_id": 99341547, "body": "&quot;==;&quot; is getting split 3 times"}, {"owner": {"reputation": 83, "user_id": 10875401, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5lF8CyyAWHA/AAAAAAAAAAI/AAAAAAAAEvw/SH5dyLOzn8E/photo.jpg?sz=128", "display_name": "Dean013", "link": "https://stackoverflow.com/users/10875401/dean013"}, "reply_to_user": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "edited": false, "score": 0, "creation_date": 1559170400, "post_id": 56369483, "comment_id": 99341580, "body": "It should be excluded like * and /n, shouldn&#39;t it? And even then, wouldn&#39;t the for statement remove those empty spots?"}, {"owner": {"reputation": 5701, "user_id": 35812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e663162cefd6ac833e0555933b8583f?s=128&d=identicon&r=PG", "display_name": "Chris Charley", "link": "https://stackoverflow.com/users/35812/chris-charley"}, "edited": false, "score": 0, "creation_date": 1559170573, "post_id": 56369483, "comment_id": 99341624, "body": "<code>a = re.split(&#39;\\W+&#39;, a)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 15297, "user_id": 7631480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zcBMm.png?s=128&g=1", "display_name": "CryptoFool", "link": "https://stackoverflow.com/users/7631480/cryptofool"}, "is_accepted": true, "score": 1, "last_activity_date": 1559170706, "creation_date": 1559170706, "answer_id": 56369561, "question_id": 56369483, "link": "https://stackoverflow.com/questions/56369483/failing-to-split-string/56369561#56369561", "title": "Failing to Split String", "body": "<p>You want to split on groups of any number of your delimiter characters.  The way you're doing it now, you're splitting on only one at a time.  This gives you what you want:</p>\n\n<pre><code>import re\n\na = 'Beautiful, is==; better*than\\nugly'\n\na = re.split(r'[,\\s=;*\\n]+',a)\n\nprint(a)\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>['Beautiful', 'is', 'better', 'than', 'ugly']\n</code></pre>\n\n<p>If you want to split on all non-alphanumeric characters, you can use this expression instead:</p>\n\n<pre><code>a = re.split(r'[^\\w]+',a)\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 10875401, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5lF8CyyAWHA/AAAAAAAAAAI/AAAAAAAAEvw/SH5dyLOzn8E/photo.jpg?sz=128", "display_name": "Dean013", "link": "https://stackoverflow.com/users/10875401/dean013"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 56369561, "answer_count": 1, "score": 0, "last_activity_date": 1559170706, "creation_date": 1559170084, "question_id": 56369483, "link": "https://stackoverflow.com/questions/56369483/failing-to-split-string", "title": "Failing to Split String", "body": "<p>I am having a stupid problem where there are blank items in the list. There are if statements in it to attempt to offset it, but even with them, the output contains empty parts. </p>\n\n<p>I have been playing around with string.split() a lot and found that what it takes is really specific, and each time i attempt to make it work, it fails. What's going wrong?</p>\n\n<pre><code>a = 'Beautiful, is==; better*than\\nugly'\nimport re\n\na = re.split(',|\\s|=|;|\\*|\\n| ',a)\n\nfor x in a:\n    if x == '\\n':\n        a.remove(x)\n    elif x == ' ':\n        a.remove(x)\n    elif x == '':\n        a.remove(x)\n\nprint(a)\nprint(\"REE\")\n</code></pre>\n\n<p>I want the outcome to only be:\n['Beautiful', 'is', 'better', 'than', 'ugly']</p>\n\n<p>But the actual outcome is:\n['Beautiful', '', 'is', '', '', '', 'better', 'than', 'ugly']</p>\n"}, {"tags": ["python", "scikit-learn", "data-science", "knn", "iris-dataset"], "comments": [{"owner": {"reputation": 1689, "user_id": 11523400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tp6tl.png?s=128&g=1", "display_name": "skillsmuggler", "link": "https://stackoverflow.com/users/11523400/skillsmuggler"}, "edited": false, "score": 2, "creation_date": 1559293929, "post_id": 56369481, "comment_id": 99382962, "body": "You are making use of the <code>iris</code> dataset. It&#39;s a well cleaned and model dataset. The features have a strong correlation to the result which results in the <code>kNN</code> model fitting the data really well. To test this you can reduce the size of the training set and this will results in a drop in the accuracy."}, {"owner": {"reputation": 29, "user_id": 9307474, "user_type": "registered", "profile_image": "https://graph.facebook.com/1734003016656176/picture?type=large", "display_name": "Ruben Acevedo", "link": "https://stackoverflow.com/users/9307474/ruben-acevedo"}, "reply_to_user": {"reputation": 1689, "user_id": 11523400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tp6tl.png?s=128&g=1", "display_name": "skillsmuggler", "link": "https://stackoverflow.com/users/11523400/skillsmuggler"}, "edited": false, "score": 0, "creation_date": 1559305526, "post_id": 56369481, "comment_id": 99388614, "body": "so, basically there&#39;s nothing wrong with the model going 100% accuracy? hmm i&#39;ll try that, you&#39;&#39;probably right"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 9307474, "user_type": "registered", "profile_image": "https://graph.facebook.com/1734003016656176/picture?type=large", "display_name": "Ruben Acevedo", "link": "https://stackoverflow.com/users/9307474/ruben-acevedo"}, "edited": false, "score": 0, "creation_date": 1559252758, "post_id": 56371017, "comment_id": 99372052, "body": "The thing is that even with confusion matrix is goes 100% accuracy rate and I&#39;m not sure how or why..."}, {"owner": {"reputation": 175, "user_id": 10930194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xptai.png?s=128&g=1", "display_name": "Freddy Daniel", "link": "https://stackoverflow.com/users/10930194/freddy-daniel"}, "reply_to_user": {"reputation": 29, "user_id": 9307474, "user_type": "registered", "profile_image": "https://graph.facebook.com/1734003016656176/picture?type=large", "display_name": "Ruben Acevedo", "link": "https://stackoverflow.com/users/9307474/ruben-acevedo"}, "edited": false, "score": 0, "creation_date": 1559260885, "post_id": 56371017, "comment_id": 99374028, "body": "read it please: <a href=\"https://www.researchgate.net/post/Multiclass_Confusion_Matrix_Explanation\" rel=\"nofollow noreferrer\">researchgate.net/post/Multiclass_Confusion_Matrix_Explanatio&zwnj;&#8203;n</a>"}], "tags": [], "owner": {"reputation": 175, "user_id": 10930194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xptai.png?s=128&g=1", "display_name": "Freddy Daniel", "link": "https://stackoverflow.com/users/10930194/freddy-daniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1559185000, "last_edit_date": 1559185000, "creation_date": 1559184442, "answer_id": 56371017, "question_id": 56369481, "link": "https://stackoverflow.com/questions/56369481/knn-prediction-going-100-on-y-test/56371017#56371017", "title": "Knn prediction going 100% on y_test", "body": "<p>Try to make a confusion matrix. Test every example of your test data, and check metrics of the specificity, sensibility, accuracy and precision. \n<a href=\"https://i.stack.imgur.com/EpcFi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EpcFi.png\" alt=\"confusion matrix\"></a></p>\n\n<p>where:</p>\n\n<pre><code>TN = True Negative\nFN = False Negative\nFP = False Positive\nTP = True Positive\n</code></pre>\n\n<p>Here you can check what is the difference between specificity and sensibility\n<a href=\"https://dzone.com/articles/ml-metrics-sensitivity-vs-specificity-difference\" rel=\"nofollow noreferrer\">https://dzone.com/articles/ml-metrics-sensitivity-vs-specificity-difference</a></p>\n\n<p>Here you have one example about how you can get one confusion matrix in python using sklearn.</p>\n\n<p>Also try to make a ROC Curve (optional)\n<a href=\"https://en.wikipedia.org/wiki/Receiver_operating_characteristic\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Receiver_operating_characteristic</a></p>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 9307474, "user_type": "registered", "profile_image": "https://graph.facebook.com/1734003016656176/picture?type=large", "display_name": "Ruben Acevedo", "link": "https://stackoverflow.com/users/9307474/ruben-acevedo"}, "is_accepted": true, "score": 0, "last_activity_date": 1559348184, "creation_date": 1559348184, "answer_id": 56402936, "question_id": 56369481, "link": "https://stackoverflow.com/questions/56369481/knn-prediction-going-100-on-y-test/56402936#56402936", "title": "Knn prediction going 100% on y_test", "body": "<p>I found the answer with the explanation of skillsmuggler(user):</p>\n\n<blockquote>\n  <p>You are making use of the iris dataset. It's a well cleaned and model\n  dataset. The features have a strong correlation to the result which\n  results in the kNN model fitting the data really well. To test this\n  you can reduce the size of the training set and this will results in a\n  drop in the accuracy.</p>\n</blockquote>\n\n<p>Prediction model was correct.</p>\n"}], "owner": {"reputation": 29, "user_id": 9307474, "user_type": "registered", "profile_image": "https://graph.facebook.com/1734003016656176/picture?type=large", "display_name": "Ruben Acevedo", "link": "https://stackoverflow.com/users/9307474/ruben-acevedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 56402936, "answer_count": 2, "score": 1, "last_activity_date": 1559348184, "creation_date": 1559170065, "question_id": 56369481, "link": "https://stackoverflow.com/questions/56369481/knn-prediction-going-100-on-y-test", "title": "Knn prediction going 100% on y_test", "body": "<p>I'm trying to implement K-nearest neighbors on Iris dataset but after doing the predictions, yhat goes 100% without errors, there must have something wrong and i have no idea what it is...</p>\n\n<p>I created a column named class_id, where i changed:</p>\n\n<ul>\n<li>setosa = 1.0</li>\n<li>versicolor = 2.0</li>\n<li>virginica = 3.0</li>\n</ul>\n\n<p>that column is type float.</p>\n\n<h2>Getting X an Y</h2>\n\n<pre><code>\n    x = df[['sepal length', 'sepal width', 'petal length', 'petal width']].values\n\n</code></pre>\n\n<p>type(x) shows nparray</p>\n\n<pre><code>\n    y = df['class_id'].values\n\n</code></pre>\n\n<p>type(y) shows nparray</p>\n\n<h2>Normalizing data</h2>\n\n<pre><code>\n    x = preprocessing.StandardScaler().fit(x).transform(x.astype(float))\n\n</code></pre>\n\n<h2>Creating train and test</h2>\n\n<pre><code>\n    x_train, x_test, y_train, y_test = train_test_split(x,y,test_size = 0.2, random_state = 42)\n\n</code></pre>\n\n<h2>Checking best K value:</h2>\n\n<pre><code>\n    Ks = 12\n    for i in range(1,Ks):\n       k = i\n       neigh = KNeighborsClassifier(n_neighbors=k).fit(x_train,y_train)\n       yhat = neigh.predict(x_test)\n       score = metrics.accuracy_score(y_test,yhat)\n       print('K: ', k, ' score: ', score, '\\n')\n\n</code></pre>\n\n<h2>Result:</h2>\n\n<p>K:  1  score:  0.9666666666666667 </p>\n\n<p>K:  2  score:  1.0 </p>\n\n<p>K:  3  score:  1.0 </p>\n\n<p>K:  4  score:  1.0 </p>\n\n<p>K:  5  score:  1.0 </p>\n\n<p>K:  6  score:  1.0 </p>\n\n<p>K:  7  score:  1.0 </p>\n\n<p>K:  8  score:  1.0 </p>\n\n<p>K:  9  score:  1.0 </p>\n\n<p>K:  10  score:  1.0 </p>\n\n<p>K:  11  score:  1.0</p>\n\n<h2>Printing y_test and yhat WITH K = 5</h2>\n\n<pre><code>\n    print(yhat)\n    print(y_test)\n\n</code></pre>\n\n<h2>Result:</h2>\n\n<p>yhat: [2. 1. 3. 2. 2. 1. 2. 3. 2. 2. 3. 1. 1. 1. 1. 2. 3. 2. 2. 3. 1. 3. 1. 3.\n3. 3. 3. 3. 1. 1.]</p>\n\n<p>y_test: [2. 1. 3. 2. 2. 1. 2. 3. 2. 2. 3. 1. 1. 1. 1. 2. 3. 2. 2. 3. 1. 3. 1. 3.\n3. 3. 3. 3. 1. 1.]</p>\n\n<p>all of them shouldn't be 100% correct, there must be something wrong</p>\n"}, {"tags": ["python", "pandas", "dataframe", "pandas-groupby"], "answers": [{"tags": [], "owner": {"reputation": 254200, "user_id": 7964527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HPW8R.jpg?s=128&g=1", "display_name": "BENY", "link": "https://stackoverflow.com/users/7964527/beny"}, "is_accepted": true, "score": 1, "last_activity_date": 1559170289, "creation_date": 1559170289, "answer_id": 56369503, "question_id": 56369475, "link": "https://stackoverflow.com/questions/56369475/returning-the-location-of-the-first-value-at-a-dataframe-location-that-meets-a-c/56369503#56369503", "title": "returning the location of the first value at a dataframe location that meets a condition in pandas dataframe", "body": "<p>Using <code>transform</code> with <code>sum</code> then <code>groupby</code> again using <code>first</code> </p>\n\n<pre><code>s=df.groupby([\"time\"])['traf'].transform('sum').gt(255)\ndf[s].groupby('time').num.first()\nOut[207]: \ntime\n21:00     5\n22:00    41\nName: num, dtype: int64\n</code></pre>\n\n<p>Or </p>\n\n<pre><code>df.loc[s,'num'].iloc[0]\nOut[211]: 5\n</code></pre>\n"}], "owner": {"reputation": 397, "user_id": 5909849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/877b709dffe000926702aedaa7fc3457?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Man", "link": "https://stackoverflow.com/users/5909849/alex-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 56369503, "answer_count": 1, "score": 0, "last_activity_date": 1559171057, "creation_date": 1559170003, "question_id": 56369475, "link": "https://stackoverflow.com/questions/56369475/returning-the-location-of-the-first-value-at-a-dataframe-location-that-meets-a-c", "title": "returning the location of the first value at a dataframe location that meets a condition in pandas dataframe", "body": "<p>I have this dataframe:</p>\n\n<pre><code>import pandas as pd\ndf = pd.DataFrame({'time': ['20:00', '23:00', '21:00', '21:00', '22:00', '22:00', '20:30'],\n                   'traf': [100, 200, 25, 300, 100, 200, 100],\n                   'num': [5, 3, 5, 6, 41, 34, 10]})\ndf = df.set_index(['time']).sort_index()\nprint(df)\n\n        traf  num\ntime            \n20:00   100    5\n20:30   100   10\n21:00    25    5\n21:00   300    6\n22:00   100   41\n22:00   200   34\n23:00   200    3\n</code></pre>\n\n<p>I am trying to write a function to aggregate my dataframe by values of column <code>df['traf']</code> and then report the 1st value in column <code>df['num']</code> that meets a condition.  </p>\n\n<p>here is example of what I am doing but I am not sure if this a right rough to go. Also, since I am dealing with a very large size dataframe, I am not sure if this way is efficient enough. </p>\n\n<pre><code>filter = df.groupby([\"time\"])['traf'].sum() &gt;= 225\ndf.where(filter, inplace=True)\nprint(df)\n\n         traf   num\ntime              \n20:00    NaN   NaN\n20:30    NaN   NaN\n21:00   25.0   5.0\n21:00  300.0   6.0\n22:00  100.0  41.0\n22:00  200.0  34.0\n23:00    NaN   NaN\n</code></pre>\n\n<p>So from the above result, I want my output to be the first value in column num that is not NaN in this case 5.0.</p>\n"}, {"tags": ["python", "django", "richtext"], "comments": [{"owner": {"reputation": 45099, "user_id": 2011147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FGRgf.jpg?s=128&g=1", "display_name": "Selcuk", "link": "https://stackoverflow.com/users/2011147/selcuk"}, "edited": false, "score": 0, "creation_date": 1559172183, "post_id": 56369460, "comment_id": 99341960, "body": "How do you initialize <code>tinymce</code>? Post your <code>custom.js</code>."}], "answers": [{"tags": [], "owner": {"reputation": 535, "user_id": 2751680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b286497dd9682447333784f5082bce1?s=128&d=identicon&r=PG", "display_name": "Danilo Akamine", "link": "https://stackoverflow.com/users/2751680/danilo-akamine"}, "is_accepted": true, "score": 0, "last_activity_date": 1559172521, "creation_date": 1559172521, "answer_id": 56369778, "question_id": 56369460, "link": "https://stackoverflow.com/questions/56369460/can-not-integrate-my-app-with-a-text-editor-in-django/56369778#56369778", "title": "Can not integrate my app with a text editor in django", "body": "<p>Django CKEditor works very well for me. Here's an example what I had to do:</p>\n\n<p>requirements.txt</p>\n\n<pre><code>django-ckeditor==5.6.1\n</code></pre>\n\n<p>settings.py</p>\n\n<pre><code>INSTALLED_APPS = [\n   ...\n   'ckeditor'\n]\n\nCKEDITOR_CONFIGS = {\n    'default': {\n        'toolbar': 'Custom',\n        'toolbar_Custom': [\n            ['Bold', 'Italic', 'Underline'],\n            ['NumberedList', 'BulletedList', '-', 'Outdent', 'Indent', '-', 'JustifyLeft', 'JustifyCenter', 'JustifyRight', 'JustifyBlock'],\n            ['Link', 'Unlink'],\n            ['RemoveFormat', 'Source']\n        ],\n        'height': 300,\n        'width': 600\n    }\n}\n</code></pre>\n\n<p>models.py</p>\n\n<pre><code>class ExampleModel(models.Model):\n    ....\n    example_field = models.TextField(null=True, blank=True)\n</code></pre>\n\n<p>admin.py</p>\n\n<pre><code>from ckeditor.widgets import CKEditorWidget\n\nclass ExampleForm(forms.ModelForm):\n    class Meta:\n        model = ExampleModel\n        fields = '__all__'\n        widgets = {'example_field': CKEditorWidget()}\n\nclass ExampleAdmin(admin.ModelAdmin):\n    form = ExampleForm\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6428123, "user_type": "registered", "profile_image": "https://graph.facebook.com/1018769168243392/picture?type=large", "display_name": "Rafael Pereira", "link": "https://stackoverflow.com/users/6428123/rafael-pereira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 1, "accepted_answer_id": 56369778, "answer_count": 1, "score": -1, "last_activity_date": 1559175339, "creation_date": 1559169895, "last_edit_date": 1559175339, "question_id": 56369460, "link": "https://stackoverflow.com/questions/56369460/can-not-integrate-my-app-with-a-text-editor-in-django", "title": "Can not integrate my app with a text editor in django", "body": "<p>Although I have tried several richtext editors like tinymce, but I am not being able to make it work, no error appears, the page loads normally, a field appears to be filled, but without any editing option.</p>\n\n<p>Try to use several ways I could find in google, but none was able to help me</p>\n\n<pre><code>----base.html\n\n&lt;head&gt;\n...\n\n&lt;!-- Tinymce Text-Editor (Must be in Head Tag) --&gt;\n  &lt;script src=\"{% static '/tinymce/js/tinymce/tinymce.min.js' %}\"&gt;&lt;/script&gt;\n  &lt;script type=\"text/javascript\" src=\"{% static 'js/custom.js' %}\" &gt;&lt;/script&gt;\n...\n\n&lt;/head&gt;\n</code></pre>\n\n<pre><code>---post_form.html\n\n{% extends \"blog/base.html\" %}\n&lt;!-- {% load crispy_forms_tags %} --&gt;\n{% block content %}\n    &lt;div class=\"content-section\"&gt;\n        &lt;form method=\"POST\"&gt;\n            {% csrf_token %}\n            &lt;fieldset class=\"form-group\"&gt;\n                &lt;legend class=\"border-bottom mb-4\"&gt;Blog Post&lt;/legend&gt;\n                &lt;!-- {{ form|crispy }} --&gt;\n                {{ form.as_p }}\n            &lt;/fieldset&gt;\n            &lt;div class=\"form-group\"&gt;\n                &lt;button class=\"btn btn-outline-info\" type=\"submit\"&gt;Post&lt;/button&gt;\n            &lt;/div&gt;\n        &lt;/form&gt;\n    &lt;/div&gt;\n{% endblock content %}\n</code></pre>\n\n<pre><code>---- models.py\n\nfrom django.db import models\nfrom django.utils import timezone\nfrom django.contrib.auth.models import User\nfrom django.urls import reverse\nfrom simple_history.models import HistoricalRecords\nfrom tinymce.models import HTMLField\n\n\nclass Post(models.Model):\n    title = models.CharField(max_length = 100)\n    versao = models.CharField(max_length=10, default=1)\n    # content = models.TextField()\n    content = HTMLField()\n    resumo_das_mudancas = models.TextField(default='N\u00e3o houve mudan\u00e7as')\n    date_posted = models.DateTimeField(default = timezone.now)\n    author = models.ForeignKey(User, on_delete=models.CASCADE)\n\n    def __str__(self):\n        return self.title\n\n    def get_absolute_url(self):\n        return reverse('post-detail', kwargs ={'pk':self.pk})\n\n.....\n\n</code></pre>\n\n<pre><code>------settings.py\n\n...\n\nINSTALLED_APPS = [\n    'django.contrib.sites',\n    'django.contrib.staticfiles',\n    'django.contrib.contenttypes',\n    'django.contrib.auth',\n    'django.contrib.flatpages',\n    'simple_history',\n    'blog.apps.BlogConfig',\n    'users.apps.UsersConfig',\n    'django.contrib.admin',\n    'django.contrib.sessions',\n    'django.contrib.messages',\n    'crispy_forms',\n    'storages',\n    'tinymce',\n    ]\n\n</code></pre>\n\n<p>There are no error messages, it just does not wor, can you help me?</p>\n"}, {"tags": ["python", "list", "csv", "readfile"], "comments": [{"owner": {"reputation": 2965, "user_id": 4626254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Td_75cnFBl0/AAAAAAAAAAI/AAAAAAAAAC8/COZ0iGRh-Ts/photo.jpg?sz=128", "display_name": "Underoos", "link": "https://stackoverflow.com/users/4626254/underoos"}, "edited": false, "score": 0, "creation_date": 1559206713, "post_id": 56369449, "comment_id": 99351194, "body": "What is the delimiter for your <code>csv</code> file?"}, {"owner": {"reputation": 5, "user_id": 1453795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b098ac494794e4bb035620f293339eff?s=128&d=identicon&r=PG", "display_name": "Jazmaina", "link": "https://stackoverflow.com/users/1453795/jazmaina"}, "reply_to_user": {"reputation": 2965, "user_id": 4626254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Td_75cnFBl0/AAAAAAAAAAI/AAAAAAAAAC8/COZ0iGRh-Ts/photo.jpg?sz=128", "display_name": "Underoos", "link": "https://stackoverflow.com/users/4626254/underoos"}, "edited": false, "score": 0, "creation_date": 1559206802, "post_id": 56369449, "comment_id": 99351232, "body": "it&#39;s just going to be a comma"}], "answers": [{"comments": [{"owner": {"reputation": 2965, "user_id": 4626254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Td_75cnFBl0/AAAAAAAAAAI/AAAAAAAAAC8/COZ0iGRh-Ts/photo.jpg?sz=128", "display_name": "Underoos", "link": "https://stackoverflow.com/users/4626254/underoos"}, "reply_to_user": {"reputation": 5, "user_id": 1453795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b098ac494794e4bb035620f293339eff?s=128&d=identicon&r=PG", "display_name": "Jazmaina", "link": "https://stackoverflow.com/users/1453795/jazmaina"}, "edited": false, "score": 1, "creation_date": 1559207110, "post_id": 56374965, "comment_id": 99351362, "body": "Can you please accept and upvote the answer if it solved your problem. :-)"}, {"owner": {"reputation": 5, "user_id": 1453795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b098ac494794e4bb035620f293339eff?s=128&d=identicon&r=PG", "display_name": "Jazmaina", "link": "https://stackoverflow.com/users/1453795/jazmaina"}, "edited": false, "score": 0, "creation_date": 1559210476, "post_id": 56374965, "comment_id": 99352963, "body": "Just a follow up question. The file will contain numbers but when they are added to the list they seem to be strings. How can I add them to the list as integers?"}, {"owner": {"reputation": 5, "user_id": 1453795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b098ac494794e4bb035620f293339eff?s=128&d=identicon&r=PG", "display_name": "Jazmaina", "link": "https://stackoverflow.com/users/1453795/jazmaina"}, "edited": false, "score": 0, "creation_date": 1559211104, "post_id": 56374965, "comment_id": 99353245, "body": "Cheers, that worked but now facing another related issue. Will try and figure that out."}], "tags": [], "owner": {"reputation": 2965, "user_id": 4626254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Td_75cnFBl0/AAAAAAAAAAI/AAAAAAAAAC8/COZ0iGRh-Ts/photo.jpg?sz=128", "display_name": "Underoos", "link": "https://stackoverflow.com/users/4626254/underoos"}, "is_accepted": false, "score": 0, "last_activity_date": 1559210649, "last_edit_date": 1559210649, "creation_date": 1559206849, "answer_id": 56374965, "question_id": 56369449, "link": "https://stackoverflow.com/questions/56369449/python-add-contents-of-a-csv-file-to-a-list/56374965#56374965", "title": "Python: Add contents of a csv file to a list", "body": "<p>Try this.</p>\n\n<pre><code>your_list = []\nfor i in lineList[-1].split(','):\n    try:your_list.append(int(i))\n    except:your_list.append(i)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4527, "user_id": 8468264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8adc0e0b5afd1ff077dd16a48492c1e0?s=128&d=identicon&r=PG&f=1", "display_name": "d_kennetz", "link": "https://stackoverflow.com/users/8468264/d-kennetz"}, "edited": false, "score": 0, "creation_date": 1559232388, "post_id": 56374988, "comment_id": 99363940, "body": "Hi! Your answer came up in the review queue because of length and content. Posts like this are flagged as low quality because code only answers are generally discouraged on StackOverflow. Please add an explanation to your answer. Thanks!"}, {"owner": {"reputation": 5, "user_id": 1453795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b098ac494794e4bb035620f293339eff?s=128&d=identicon&r=PG", "display_name": "Jazmaina", "link": "https://stackoverflow.com/users/1453795/jazmaina"}, "edited": false, "score": 0, "creation_date": 1559294310, "post_id": 56374988, "comment_id": 99383143, "body": "Sorry about that.. Have added more comments to the code to explain what it&#39;s supposed to do and have added more explanation to the answer."}], "tags": [], "owner": {"reputation": 350, "user_id": 2979314, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/106c4fc4db17398e1b4ca23a59ae4b28?s=128&d=identicon&r=PG&f=1", "display_name": "kashiff007", "link": "https://stackoverflow.com/users/2979314/kashiff007"}, "is_accepted": false, "score": -1, "last_activity_date": 1559206959, "creation_date": 1559206959, "answer_id": 56374988, "question_id": 56369449, "link": "https://stackoverflow.com/questions/56369449/python-add-contents-of-a-csv-file-to-a-list/56374988#56374988", "title": "Python: Add contents of a csv file to a list", "body": "<pre><code>list1 = []\nfor ele in line:\n   list1.append(ele[0])\n\nlist2 = []\nfor ele in line:\n   list2.append(ele[0])\n\nlist3 = []\nfor ele in line:\n   list3.append(ele[0])\n\nyour_list = []\nyour_list.append(list1[-1])\nyour_list.append(list2[-1])\nyour_list.append(list3[-1])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25770, "user_id": 5349916, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/QovYv.jpg?s=128&g=1", "display_name": "MisterMiyagi", "link": "https://stackoverflow.com/users/5349916/mistermiyagi"}, "is_accepted": false, "score": 0, "last_activity_date": 1559207448, "last_edit_date": 1559207448, "creation_date": 1559207134, "answer_id": 56375036, "question_id": 56369449, "link": "https://stackoverflow.com/questions/56369449/python-add-contents-of-a-csv-file-to-a-list/56375036#56375036", "title": "Python: Add contents of a csv file to a list", "body": "<p>You can use the <code>csv</code> module to parse the CSV content row-wise. Simply advance to the last line then, discarding intermediate data:</p>\n\n<pre><code>import csv\n\nwith open('c:\\\\securelog_workfiles\\\\chain_info.txt') as data:\n    for row in csv.reader(data):  # parse each line to a row\n        continue  # skip through the csv row-wise\n    last_line_data = row\n</code></pre>\n\n<p>This works for arbitrarily large files, since it only ever loads individual lines instead of the entire file at once.</p>\n\n<p>If the file is huge and you want to avoid the overhead of parsing discarded lines, advance to the last line and parse only that. You can either use <code>next(csv.reader([row]))</code> to parse the last line, or something like <code>row.split(...)</code> if the format is simple:</p>\n\n<pre><code>with open('c:\\\\securelog_workfiles\\\\chain_info.txt') as data:\n    for row in data:  # do not parse each line\n        continue  # skip through the csv row-wise\n    last_line_data = row.split(',')  # parse the last line explicitly\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5, "user_id": 1453795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b098ac494794e4bb035620f293339eff?s=128&d=identicon&r=PG", "display_name": "Jazmaina", "link": "https://stackoverflow.com/users/1453795/jazmaina"}, "is_accepted": false, "score": 0, "last_activity_date": 1559294255, "last_edit_date": 1559294255, "creation_date": 1559212283, "answer_id": 56376480, "question_id": 56369449, "link": "https://stackoverflow.com/questions/56369449/python-add-contents-of-a-csv-file-to-a-list/56376480#56376480", "title": "Python: Add contents of a csv file to a list", "body": "<p>Thanks to everyone for the help. Eventually got this little piece working. The first line of the file which is always 1,0,0 is being passed into a list called lineList as integers.\nThen the first element of this list which has a value of 1 is incremented and printed to the screen. </p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import os\nimport io\nimport sys\nimport zipfile\nimport shutil\nimport csv\nfrom os import path\nfrom zipfile import ZipFile\nfrom shutil import make_archive\n\n#input file\nchain_file = 'c:\\\\securelog_workfiles\\\\chain_info.txt'\n\n#Check if chain_info.txt exists\nchain_file_exists = os.path.isfile(chain_file)\nif chain_file_exists:\n    if os.stat(chain_file).st_size == 0:\n        print('empty')\n        fileHandle = open (chain_file, 'a')\n        fileHandle.write('1,0,0')\n        fileHandle.close()\n    else:\n        #Read the last line of a file\n        fileHandle = open (chain_file)\n        lineList = fileHandle.readlines()\n        fileHandle.close()\n        print (lineList)\n        print (\"The last line is:\")\n        print (lineList[-1])\n\n        #split the line into separate values using the comma as the delimeter\n        chain_list = lineList[-1].split(',')\n\n        #convert the string characters from the file into integers before adding \n        #to the list\n        chain_list = [int(i) for i in lineList[-1].split(',')]\n        print (chain_list)\n\n        #increment 1 to 2\n        increment_value = (chain_list[0])\n        increment_value = increment_value +1\n\n        #remove the first element from the list\n        chain_list.remove (chain_list[0])\n        #verifying that the 1st element was removd\n        print (chain_list)\n\n        #insert the incremented value into the list\n        chain_list.insert (0,increment_value)\n        print('chain list now is: ' + str(chain_list))\n\nelse:    \n    print ('file does not exist')\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 1453795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b098ac494794e4bb035620f293339eff?s=128&d=identicon&r=PG", "display_name": "Jazmaina", "link": "https://stackoverflow.com/users/1453795/jazmaina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1559294255, "creation_date": 1559169824, "last_edit_date": 1592644375, "question_id": 56369449, "link": "https://stackoverflow.com/questions/56369449/python-add-contents-of-a-csv-file-to-a-list", "title": "Python: Add contents of a csv file to a list", "body": "<p>have a new issue with this that I could do with some help on.\nLike before i am passing a csv (with comma as separator) into a list.\nthe first element in the list will always be an integer but the next two will be strings.\nI'm trying to add a new line to the csv which will have an incremented number in the first element but I will also add hash strings in the other two elements.\nIt works on the first run as the file is empty but when it tries a second run I get an error</p>\n<blockquote>\n<p>chain_list = [int(i) for i in lineList[-1].split(',')]</p>\n<p>ValueError: invalid literal for int() with base 10: '9891b18cf04418b92c0ee611201da47ef00471090aebdfa6667097d81d0832cb2edab83f65a4dc497fbffc4332d7e794'</p>\n</blockquote>\n<p>The first line of the file that i'm passing in contains:</p>\n<blockquote>\n<p>1,0,9891b18cf04418b92c0ee611201da47ef00471090aebdfa6667097d81d0832cb2edab83f65a4dc497fbffc4332d7e794</p>\n</blockquote>\n<p>My code looks like this at the minute. Not sure how to get around this?</p>\n<pre class=\"lang-py prettyprint-override\"><code>#Check if chain_info.txt exists\nCHAIN_FILE_exists = os.path.isfile(CHAIN_FILE)\n#If chainfile is empty set element 0 in list to 1\nif CHAIN_FILE_exists:\n    if os.stat(CHAIN_FILE).st_size == 0:\n        print('empty')\n        fileHandle = open (CHAIN_FILE, 'a')\n        fileHandle.write('1,0,0')\n        fileHandle.close()\n        fileHandle = open (CHAIN_FILE)\n        lineList = fileHandle.readlines()\n        fileHandle.close()       \n        chain_list = lineList[-1].split(',')\n        chain_list = [int(i) for i in lineList[-1].split(',')]\n        increment_value = 1\n        print('1 chain list now is: ' + str(chain_list))\n    else:\n        #Read the last line of a file\n        fileHandle = open (CHAIN_FILE)\n        lineList = fileHandle.readlines()\n        fileHandle.close()\n        #Take last line of file and add to a list called chain_list\n        chain_list = lineList[-1].split(',')\n        chain_list = [int(i) for i in lineList[-1].split(',')]\n        #increment the first value in the list by 1, this will be used to determine the block number\n        increment_value = (chain_list[0])\n        increment_value = increment_value +1\n        chain_list.remove (chain_list[0])\n        chain_list.insert (0,increment_value)\n        print('chain list now is: ' + str(chain_list))\n        #Open file\n        fileHandle = open (CHAIN_FILE, 'a')\n        #Write the contents of the list to the chain file on a new line and separate with a comma\n        fileHandle.write('\\n' + str(chain_list[0]) + ',' + str(chain_list[1]))\n        fileHandle.close()\nelse:    \n    print ('file does not exist')\n</code></pre>\n"}, {"tags": ["python", "eclipse", "robotframework"], "comments": [{"owner": {"reputation": 35, "user_id": 11575233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q00tk.jpg?s=128&g=1", "display_name": "Mel Raymond", "link": "https://stackoverflow.com/users/11575233/mel-raymond"}, "edited": false, "score": 0, "creation_date": 1559169965, "post_id": 56369447, "comment_id": 99341468, "body": "Our site shows to use, you would do this: from gdx import gdx gdx = gdx.gdx(). I&#39;ve gotten this to connect to the GoDirect hardware and collect data, but it was all done outside the context of the IDE (robotframework)."}, {"owner": {"reputation": 721, "user_id": 8124312, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Oh7bIVhwk4w/AAAAAAAAAAI/AAAAAAAAATk/p9n4EV0SH2o/photo.jpg?sz=128", "display_name": "Sameem", "link": "https://stackoverflow.com/users/8124312/sameem"}, "edited": false, "score": 0, "creation_date": 1559173871, "post_id": 56369447, "comment_id": 99342311, "body": "What library are you trying to import? Is it written by you?"}, {"owner": {"reputation": 1772, "user_id": 2421817, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GFWOi.jpg?s=128&g=1", "display_name": "kerwei", "link": "https://stackoverflow.com/users/2421817/kerwei"}, "edited": false, "score": 0, "creation_date": 1559181753, "post_id": 56369447, "comment_id": 99343828, "body": "Why do you think that your package is not imported? <i>I&#39;ve tried importing but when running the test shows that library has warning about no keywords.</i> doesn&#39;t really sound like an import error. A typical module import error goes like <code>ImportError: No module named foo</code>"}, {"owner": {"reputation": 305939, "user_id": 7432, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3e3921ee8a7792e4b5da0244933395e8?s=128&d=identicon&r=PG", "display_name": "Bryan Oakley", "link": "https://stackoverflow.com/users/7432/bryan-oakley"}, "edited": false, "score": 0, "creation_date": 1559187140, "post_id": 56369447, "comment_id": 99344792, "body": "This code has several problems and is not a working test case. Have you read through the user guide? It has some very clear examples of how to create your own keyword libraries which can use any other modules you want."}, {"owner": {"reputation": 35, "user_id": 11575233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q00tk.jpg?s=128&g=1", "display_name": "Mel Raymond", "link": "https://stackoverflow.com/users/11575233/mel-raymond"}, "edited": false, "score": 0, "creation_date": 1559226711, "post_id": 56369447, "comment_id": 99360843, "body": "Sameem: We have a GoDirect package that teachers and students can use to create Python scripts to connect our Go Direct Sensors. It&#39;s the &quot;godirect&quot; Library."}, {"owner": {"reputation": 35, "user_id": 11575233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q00tk.jpg?s=128&g=1", "display_name": "Mel Raymond", "link": "https://stackoverflow.com/users/11575233/mel-raymond"}, "edited": false, "score": 0, "creation_date": 1559226845, "post_id": 56369447, "comment_id": 99360918, "body": "kerwei: The &quot;godirect&quot; Library does import. The point though is I don&#39;t know how to use it to create a Test Case that will let me connect to a Go Direct sensor. I will be experimenting with a GDX Temperature probe which I know works as I&#39;ve done this outside the context of the IDE and configuration I&#39;m using here."}, {"owner": {"reputation": 35, "user_id": 11575233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q00tk.jpg?s=128&g=1", "display_name": "Mel Raymond", "link": "https://stackoverflow.com/users/11575233/mel-raymond"}, "edited": false, "score": 0, "creation_date": 1559227537, "post_id": 56369447, "comment_id": 99361294, "body": "Bryan Oakley: That test case I posted here does work for me. I can run it and get a passing Robotframework output. The problem I&#39;m having here is I don&#39;t understand how to use our external package. I&#39;ve written some Python scripts in the SikuliX project I did, but they were all &quot;inline&quot; functions I had made for Robotframework and SikuliX. What I&#39;m doing now  is working on a Windows 10 system and have gone through a lot of videos from Automation Step by Step - Raghav Pal which helped me get this working in Eclipse with Robotframework. I&#39;m gong to try and update this post with a &quot;pip list&quot;."}, {"owner": {"reputation": 35, "user_id": 11575233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q00tk.jpg?s=128&g=1", "display_name": "Mel Raymond", "link": "https://stackoverflow.com/users/11575233/mel-raymond"}, "edited": false, "score": 0, "creation_date": 1559227785, "post_id": 56369447, "comment_id": 99361438, "body": "Maybe I need to install &quot;PyDev&quot; but I&#39;m not sure. If I did, will it still work with RobotFramework and/or is that the right approach here? Please see the &quot;pip list&quot; I added to the main body of this post. It shows what I&#39;m installed so far and what versions are on the Windows 10 os."}, {"owner": {"reputation": 35, "user_id": 11575233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q00tk.jpg?s=128&g=1", "display_name": "Mel Raymond", "link": "https://stackoverflow.com/users/11575233/mel-raymond"}, "edited": false, "score": 0, "creation_date": 1559228788, "post_id": 56369447, "comment_id": 99361959, "body": "Bryan Oakley: I edited that test case here to try and fix it correctly. It didn&#39;t paste in very well here, but it does run in my IDE."}], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 11575233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q00tk.jpg?s=128&g=1", "display_name": "Mel Raymond", "link": "https://stackoverflow.com/users/11575233/mel-raymond"}, "is_accepted": false, "score": 0, "last_activity_date": 1559336378, "creation_date": 1559336378, "answer_id": 56401679, "question_id": 56369447, "link": "https://stackoverflow.com/questions/56369447/how-do-i-use-external-python-packages-in-this-configuration/56401679#56401679", "title": "How do I use external python packages in this configuration", "body": "<p>OK, solved it myself. I made changes to the original post showing what I did to solve it. </p>\n"}], "owner": {"reputation": 35, "user_id": 11575233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q00tk.jpg?s=128&g=1", "display_name": "Mel Raymond", "link": "https://stackoverflow.com/users/11575233/mel-raymond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559336378, "creation_date": 1559169811, "last_edit_date": 1559336291, "question_id": 56369447, "link": "https://stackoverflow.com/questions/56369447/how-do-i-use-external-python-packages-in-this-configuration", "title": "How do I use external python packages in this configuration", "body": "<p>I can not figure out how to import and/or use a python package. I really need some help getting off the ground with this. I want to accomplish getting 1 smoke test working. I'm now working in Windows 10 1809 os.</p>\n\n<p>I've set up Eclipse to use Robotframework and RED robot. I have a project created with a folder, suite, and working test case (which does not include any Python). I've tried importing our \"GoDirect\" package, but when running the test shows that library has warning about no keywords. So, I'm assuming I have to create an external python.py file, and I tried to get one working but could not figure out how to set that up in the Eclipse Environment and use it.  </p>\n\n<p>My goal is to get a test case working that connects to a sensor, and reads information from it. I currently have no results other than a working skeleton test case. I'm new to Eclipse, but have \"some\" experience working with RobotFramework in the SikuliX IDE for a different application (using Mac Mojave).</p>\n\n<p>This is my working Test case:</p>\n\n<pre><code>*** Settings ***   \n\nSuite Setup       \nLog    I am inside Test Suite Setup\n\nSuite Teardown   \nLog    I am inside Test suite Teardown\n\nTest Setup       \nLog    I am inside Test Setup\n\nTest Teardown     \nLog    I am insied Test Teardown   \n\nDefault Tags        sanity    \n\n*** Test Cases ***\n\ngdx_smoke_test\n\n    [Tags]    smoke\n    Log    Hello World...\n\n\n*** Variables ***\n\n\n*** Keywords ***\n</code></pre>\n\n<p>Below is a \"pip list\" of what I have installed on my Windows 10 1809 os:</p>\n\n<p>Package                         Version      </p>\n\n<hr>\n\n<p>enum-compat                     0.0.2<br>\ngodirect                        1.0.3<br>\nhidapi                          0.7.99.post21\npexpect                         4.7.0<br>\npip                             19.1.1<br>\nptyprocess                      0.6.0<br>\npyserial                        3.4<br>\nrobotframework                  3.1.1<br>\nrobotframework-selenium2library 3.0.0<br>\nrobotframework-seleniumlibrary  3.3.1<br>\nselenium                        3.141.0<br>\nsetuptools                      41.0.1<br>\nurllib3                         1.25.3<br>\nvernierpygatt                   3.2.0<br>\nwheel                           0.33.4       </p>\n\n<p>Below is the website we use for students and teachers to download and use our \"godirect\" python implementations </p>\n\n<p><a href=\"https://www.vernier.com/engineering/python/\" rel=\"nofollow noreferrer\">https://www.vernier.com/engineering/python/</a></p>\n\n<p>05/30/2019 : I'm working on an external python file that creates a class object with a few \"def\" functions in it. I'm thinking I can put that .py someplace in the Eclipse project folder and import it (as a library) into RobotFramework. In theory I should be able to call Keywords into that .py class object. Example of the possible .py: </p>\n\n<p>05/31/2019 : OK guys. I solved it on my own. I mislead myself a lot on our website. There was a few things I ended up doing to solve it. I'll explain below for anyone that's interested. </p>\n\n<p>1) Copied gdx.py to site folder: It turns out I can't just do \"pip install godirect[usb,ble]\" alone. This only installs the site package in a folder that the Robotframework and RED.xml will use. I needed to also download one of their files that had a \"gdx.py\" file in it. That file has keywords in it such as \"open_usb(self)\" and many other ones. So I copied that \"gdx.py\" file to the site folder. </p>\n\n<p>2) Add gdx.py to RED.xml : Double clicked the RED.xml which opens the RED project Referenced Libraries window. and added the gdx.py Library. </p>\n\n<p>3) Added the \"Library gdx\" in the Settings of Robot Framework</p>\n\n<p>4) Added keyword \"open  usb\": In my gdx_smoke_test I added this keyword to it</p>\n\n<p>5) Ran the test suite and it passed! </p>\n\n<p>The passing smoke test for using a custom Python file is below (shows changes I made to the original above)</p>\n\n<pre><code>*** Settings ***   \nLibrary  gdx                       \nSuite Setup       \nLog    I am inside Test Suite Setup\n\nSuite Teardown   \nLog    I am inside Test suite Teardown\n\nTest Setup       \nLog    I am inside Test Setup\n\nTest Teardown     \nLog    I am insied Test Teardown   \n\nDefault Tags        sanity    \n\n*** Test Cases ***\n\ngdx_smoke_test\n\n    [Tags]    smoke\n    Log    Hello World...\n    open . usb\n\n\n*** Variables ***\n\n\n*** Keywords ***\n</code></pre>\n"}, {"tags": ["python", "python-2.7", "matplotlib", "plot", "histogram"], "comments": [{"owner": {"reputation": 81, "user_id": 11068643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tWJot.jpg?s=128&g=1", "display_name": "B Troy", "link": "https://stackoverflow.com/users/11068643/b-troy"}, "edited": false, "score": 2, "creation_date": 1559171777, "post_id": 56369416, "comment_id": 99341866, "body": "If you want smooth lines, you might want a Kernal Density Estimate Plot (KDE).  That would be       &#39;df.plot.kde()&#39;    You can see an example at  <a href=\"https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.plot.density.html\" rel=\"nofollow noreferrer\">link</a>"}], "answers": [{"tags": [], "owner": {"reputation": 60, "user_id": 9115709, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0oKsDjg3RsE/AAAAAAAAAAI/AAAAAAAADeo/eiuW0oz5cZk/photo.jpg?sz=128", "display_name": "Weiyi Yin", "link": "https://stackoverflow.com/users/9115709/weiyi-yin"}, "is_accepted": true, "score": 1, "last_activity_date": 1559171644, "creation_date": 1559171644, "answer_id": 56369674, "question_id": 56369416, "link": "https://stackoverflow.com/questions/56369416/overlapping-density-plots-of-multiple-pandas-data-frame-columns/56369674#56369674", "title": "Overlapping density plots of multiple pandas data frame columns", "body": "<p>I understood your question! Here's how I would do it in matplotlib.</p>\n\n<pre><code>import matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\n\ncol1 = np.random.normal(0, 1, (1000, ))\ncol2 = np.random.normal(1, 1, (1000, ))\ncol3 = np.random.normal(-1, 1, (1000, ))\ndf = pd.DataFrame({'col1':col1, 'col2':col2, 'col3':col3})\n\ndf['col1_bins'] = pd.cut(df['col1'], bins=np.arange(-10, 11, 0.5))\ndf['col2_bins'] = pd.cut(df['col2'], bins=np.arange(-10, 11, 0.5))\ndf['col3_bins'] = pd.cut(df['col3'], bins=np.arange(-10, 11, 0.5))\n\ncol1_counts = df[['col1_bins', 'col1']].groupby(['col1_bins']).count().reset_index()\ncol2_counts = df[['col2_bins', 'col1']].groupby(['col2_bins']).count().reset_index()\ncol3_counts = df[['col3_bins', 'col1']].groupby(['col3_bins']).count().reset_index()\n\nplt.plot(col1_counts['col1_bins'].astype(str), col1_counts['col1'], 'r')\nplt.plot(col2_counts['col2_bins'].astype(str), col2_counts['col1'], 'b')\nplt.plot(col3_counts['col3_bins'].astype(str), col3_counts['col1'], 'g')\n</code></pre>\n\n<p>Basically you have to bin your data points before you can plot them.</p>\n"}], "owner": {"reputation": 146, "user_id": 5530627, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10207698250311751/picture?type=large", "display_name": "Jesse Downing", "link": "https://stackoverflow.com/users/5530627/jesse-downing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 56369674, "answer_count": 1, "score": 0, "last_activity_date": 1559171644, "creation_date": 1559169515, "question_id": 56369416, "link": "https://stackoverflow.com/questions/56369416/overlapping-density-plots-of-multiple-pandas-data-frame-columns", "title": "Overlapping density plots of multiple pandas data frame columns", "body": "<pre><code>import numpy as np\nimport pandas as pd\n\ncol1 = np.random.normal(0, 1, (1000, ))\ncol2 = np.random.normal(0, 1, (1000, ))\ncol3 = np.random.normal(0, 1, (1000, ))\ndf = pd.DataFrame({'col1':col1, 'col2':col2, 'col3':col3})\n</code></pre>\n\n<ul>\n<li>Plot each column as a continuous line</li>\n<li>Plot all 3 columns on same axis</li>\n<li>Use different colored lines (no fill)</li>\n</ul>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["python", "csv"], "comments": [{"owner": {"reputation": 821, "user_id": 10452700, "user_type": "registered", "profile_image": "https://graph.facebook.com/2172245999723325/picture?type=large", "display_name": "Mario", "link": "https://stackoverflow.com/users/10452700/mario"}, "edited": false, "score": 0, "creation_date": 1559169589, "post_id": 56369349, "comment_id": 99341367, "body": "possible duplicate of <a href=\"https://stackoverflow.com/questions/56263851/how-can-pass-the-current-datetime-to-string-in-python\">How can pass the current datetime to string in python?</a> You can convert the timestamp to a string and then can use the <a href=\"https://docs.python.org/3.7/library/stdtypes.html?highlight=replace#str.replace\" rel=\"nofollow noreferrer\">replace()</a> method to change the <code>&#47;</code> : to `` or backspace"}, {"owner": {"reputation": 21, "user_id": 9271576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d10e75f9ca8c6e979b8ce05cc8070a0?s=128&d=identicon&r=PG&f=1", "display_name": "User456p74", "link": "https://stackoverflow.com/users/9271576/user456p74"}, "reply_to_user": {"reputation": 821, "user_id": 10452700, "user_type": "registered", "profile_image": "https://graph.facebook.com/2172245999723325/picture?type=large", "display_name": "Mario", "link": "https://stackoverflow.com/users/10452700/mario"}, "edited": false, "score": 0, "creation_date": 1559170493, "post_id": 56369349, "comment_id": 99341609, "body": "It\u2019s not a duplicate. The column is part of a csv file and is not a timestamp type. Plus also if you remove the \u2018/\u2018 , I still need something that moves the first 4 characters after the last one, meaning 01012019 has to become 20190101. And would be best if it\u2019s code added to the script I already have. This action is performed on the first column in the file. Thanks!"}, {"owner": {"reputation": 821, "user_id": 10452700, "user_type": "registered", "profile_image": "https://graph.facebook.com/2172245999723325/picture?type=large", "display_name": "Mario", "link": "https://stackoverflow.com/users/10452700/mario"}, "edited": false, "score": 0, "creation_date": 1559172544, "post_id": 56369349, "comment_id": 99342041, "body": "I don&#39;t see eye to eye with you. Nevertheless you could use <a href=\"https://docs.python.org/3.7/library/datetime.html#strftime-strptime-behavior\" rel=\"nofollow noreferrer\">strftime()</a> and  modify it from <code>(&quot;%Y-%m-%d %H-%M-%S&quot;)</code> to any form you want to."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5051310"}, "edited": false, "score": 1, "creation_date": 1559172813, "post_id": 56369349, "comment_id": 99342091, "body": "@V.Montr&#233;al seems like you already have a way to do most of what you want. I&#39;d say your question boils down to just &quot;how to change the format of a date string in python?&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 9271576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d10e75f9ca8c6e979b8ce05cc8070a0?s=128&d=identicon&r=PG&f=1", "display_name": "User456p74", "link": "https://stackoverflow.com/users/9271576/user456p74"}, "is_accepted": false, "score": 0, "last_activity_date": 1559174162, "creation_date": 1559174162, "answer_id": 56369977, "question_id": 56369349, "link": "https://stackoverflow.com/questions/56369349/reading-and-parsing-a-csv-file-in-python-with-regex-first-column/56369977#56369977", "title": "Reading and parsing a CSV file in Python with Regex first column", "body": "<p>Thanks guys for the responses.</p>\n\n<p>So with this code I get the following output: </p>\n\n<pre><code>import csv\n\ndef parse_calendar(infile, outfile):\n    with open(outfile, 'w', newline='') as output:\n        with open(infile, newline='') as input:\n            reader = csv.reader(input, delimiter=',', quotechar='\"')\n            next(reader, None)  # skip the headers\n            writer = csv.writer(output, delimiter=',', quotechar='\"')\n            for row in reader: # process each row\n                replaced = row[0].replace('/','')  \n                row[0] = replaced\n                writer.writerow(row)\n</code></pre>\n\n<p>01012018,New Year's Day,N,C,US</p>\n\n<p>01012018,New Year's Day,N,C,CA</p>\n\n<p>01152018,Martin L. King Day,N,C,US</p>\n\n<p>What code do I need to add to the script get the formatting different now from 01012018 to 20180101 given the type is a String? For each line then off course. </p>\n\n<p>Appreciate it alot thanks</p>\n"}], "owner": {"reputation": 21, "user_id": 9271576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d10e75f9ca8c6e979b8ce05cc8070a0?s=128&d=identicon&r=PG&f=1", "display_name": "User456p74", "link": "https://stackoverflow.com/users/9271576/user456p74"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559174162, "creation_date": 1559168997, "question_id": 56369349, "link": "https://stackoverflow.com/questions/56369349/reading-and-parsing-a-csv-file-in-python-with-regex-first-column", "title": "Reading and parsing a CSV file in Python with Regex first column", "body": "<p>I have a CSV file (calendar), 5 columns that I want to read and parse with the following conditions using a script:</p>\n\n<ul>\n<li>Deleting headers (done)</li>\n<li>Change the format of the first column from 01/01/2019 to 20190101 in the First column</li>\n</ul>\n\n<p>The first part of the script is done to skip headers. The second part I think a regex is required but I just don't know how to first remove the / and then move the 0101 from before 2019 to after 2019 so that the result is 20190101</p>\n\n<p>If someone could help that would be great!</p>\n\n<pre><code>def parse_calendar(infile, outfile):\n    with open(outfile, 'w', newline='') as output:\n        with open(infile, newline='') as input:\n            reader = csv.reader(input, delimiter=',', quotechar='\"')\n            next(reader, None)  # skip the headers\n            writer = csv.writer(output, delimiter=',', quotechar='\"')\n            for row in reader:   # process each row\n                writer.writerow(row)\n</code></pre>\n\n<p>I expect the output to be like the following compared to the initial file:</p>\n\n<p>01/01/2019  New Year's Day  N   C   US</p>\n\n<p>20190101    New Year's Day  N   C   US</p>\n"}, {"tags": ["python", "opencv", "compiler-errors", "cv2"], "comments": [{"owner": {"reputation": 116, "user_id": 10964825, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sZtaP4dYrZQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbfIaB9TLF2fbKuRWcBOD4BpyCbkg/mo/photo.jpg?sz=128", "display_name": "Sri Raghu Malireddi", "link": "https://stackoverflow.com/users/10964825/sri-raghu-malireddi"}, "edited": false, "score": 1, "creation_date": 1559179947, "post_id": 56369332, "comment_id": 99343509, "body": "The error says it can&#39;t open the file <code>age_net.caffemodel</code>. To solve this error, you might want to place the above file in the same location as your running script (or) you can initialize the variable <code>ageModel</code> with path followed by the file name."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 11301313, "user_type": "registered", "profile_image": "https://graph.facebook.com/2375162972534750/picture?type=large", "display_name": "Toysan", "link": "https://stackoverflow.com/users/11301313/toysan"}, "is_accepted": false, "score": 0, "last_activity_date": 1559234567, "creation_date": 1559234567, "answer_id": 56382297, "question_id": 56369332, "link": "https://stackoverflow.com/questions/56369332/does-anyone-know-how-to-fix-this-weird-cv2-error-opencv4-1-0/56382297#56382297", "title": "Does anyone know how to fix this weird cv2.error: OpenCV(4.1.0)?", "body": "<p>It turns out that server was overloaded so downloaded files were not compleated.\nAfter I downloaded \"FULL\" package everything began to work. I was missing literally 1 MB of 1 file that unfortunately was crucial for the whole script to work properly.</p>\n\n<p>Thank you for help and sorry for a problem.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11890231, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QF-l1objBl8/AAAAAAAAAAI/AAAAAAAAAAU/tEvRnu_fIhA/photo.jpg?sz=128", "display_name": "HRITIK JAISWAL", "link": "https://stackoverflow.com/users/11890231/hritik-jaiswal"}, "is_accepted": false, "score": 0, "last_activity_date": 1595353271, "creation_date": 1595353271, "answer_id": 63020095, "question_id": 56369332, "link": "https://stackoverflow.com/questions/56369332/does-anyone-know-how-to-fix-this-weird-cv2-error-opencv4-1-0/63020095#63020095", "title": "Does anyone know how to fix this weird cv2.error: OpenCV(4.1.0)?", "body": "<p>Probably there is an error with your file path which you are providing in between this commonds</p>\n<pre class=\"lang-py prettyprint-override\"><code>ageNet = cv.dnn.readNet(ageModel, ageProto)\ngenderNet = cv.dnn.readNet(genderModel, genderProto)\nfaceNet = cv.dnn.readNet(faceModel, faceProto)\n</code></pre>\n<p>I hope it helps :)</p>\n"}], "owner": {"reputation": 31, "user_id": 11301313, "user_type": "registered", "profile_image": "https://graph.facebook.com/2375162972534750/picture?type=large", "display_name": "Toysan", "link": "https://stackoverflow.com/users/11301313/toysan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2557, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1595353271, "creation_date": 1559168806, "question_id": 56369332, "link": "https://stackoverflow.com/questions/56369332/does-anyone-know-how-to-fix-this-weird-cv2-error-opencv4-1-0", "title": "Does anyone know how to fix this weird cv2.error: OpenCV(4.1.0)?", "body": "<p>Ok. I have got a \"simple\" homework from my teacher. Homework was about just changing lanes of command from python.exe .\\AgeGender.py --input .\\sample.jpg to python.exe .\\AgeGender.py --input .\\test.jpg</p>\n\n<p>Link to files library: <a href=\"https://drive.google.com/file/d/1gvIhxmFPvEcbDcPoyjnkcjuxNiiXD1FY/view?usp=sharing\" rel=\"nofollow noreferrer\">https://drive.google.com/file/d/1gvIhxmFPvEcbDcPoyjnkcjuxNiiXD1FY/view?usp=sharing</a></p>\n\n<p>From the beging. Teacher said that all what I have to do is any terminal to run this. Well it turns out I had to learn how to run scripts from cmd after 2 hours of fighting and trying to run this AgeGender.py. Of course at the begginig there was no way to run python.exe from windows command promt so I had to find a way to put all files in to pycharm scripts folder ONLY to find out that script is wrongly written and that I have to find a way to fix it...</p>\n\n<pre><code>import cv2 as cv\nimport math\nimport time\nimport argparse\n\ndef getFaceBox(net, frame, conf_threshold=0.7):\n    frameOpencvDnn = frame.copy()\n    frameHeight = frameOpencvDnn.shape[0]\n    frameWidth = frameOpencvDnn.shape[1]\n    blob = cv.dnn.blobFromImage(frameOpencvDnn, 1.0, (300, 300), [104, \n117, 123], True, False)\n\nnet.setInput(blob)\ndetections = net.forward()\nbboxes = []\nfor i in range(detections.shape[2]):\n    confidence = detections[0, 0, i, 2]\n    if confidence &gt; conf_threshold:\n        x1 = int(detections[0, 0, i, 4] * frameWidth)\n        y1 = int(detections[0, 0, i, 4] * frameHeight)\n        x2 = int(detections[0, 0, i, 5] * frameWidth)\n        y2 = int(detections[0, 0, i, 6] * frameHeight)\n        bboxes.append([x1, y1, x2, y2])\n        cv.rectangle(frameOpencvDnn, (x1, y1), (x2, y2), (0, 255, 0), \nint(round(frameHeight/150)), 8)\nreturn frameOpencvDnn, bboxes\n\n\nparser = argparse.ArgumentParser(description='Use this script to run age             \nand gender recognition using OpenCV.')\nparser.add_argument('--input', help='Path to input image or video file.         \nSkip this argument to capture frames from a camera.')\n\nargs = parser.parse_args()\n\nfaceProto = \"opencv_face_detector.pbtxt\"\nfaceModel = \"opencv_face_detector_uint8.pb\"\n\nageProto = \"age_deploy.prototxt\"\nageModel = \"age_net.caffemodel\"\n\ngenderProto = \"gender_deploy.prototxt\"\ngenderModel = \"gender_net.caffemodel\"\n\nMODEL_MEAN_VALUES = (78.4263377603, 87.7689143744, 114.895847746)\nageList = ['(0-2)', '(4-6)', '(8-12)', '(15-20)', '(25-32)', '(38-43)', '(48-53)', '(60-100)']\ngenderList = ['Male', 'Female']\n\nageNet = cv.dnn.readNet(ageModel, ageProto)\ngenderNet = cv.dnn.readNet(genderModel, genderProto)\nfaceNet = cv.dnn.readNet(faceModel, faceProto)\n\ncap = cv.VideoCapture(args.input if args.input else 0)\npadding = 20\nwhile cv.waitKey(1) &lt; 0:\n# Read frame\nt = time.time()\nhasFrame, frame = cap.read()\nif not hasFrame:\n    cv.waitKey()\n    break\n\nframeFace, bboxes = getFaceBox(faceNet, frame)\nif not bboxes:\n    print(\"No face Detected, Checking next frame\")\n    continue\n\nfor bbox in bboxes:\n    # print(bbox)\n    face = frame[max(0,bbox[1]-        \npadding):min(bbox[3]+padding,frame.shape[0]-1),max(0,bbox[0]-    \npadding):min(bbox[2]+padding, frame.shape[1]-1)]\n\n    blob = cv.dnn.blobFromImage(face, 1.0, (227, 227), MODEL_MEAN_VALUES, \nswapRB=False)\n    genderNet.setInput(blob)\n    genderPreds = genderNet.forward()\n    gender = genderList[genderPreds[0].argmax()]\n    # print(\"Gender Output : {}\".format(genderPreds))\n    print(\"Gender : {}, conf = {:.3f}\".format(gender, \ngenderPreds[0].max()))\n\n    ageNet.setInput(blob)\n</code></pre>\n\n<p>So to the point can someone tell me how to fix this? please</p>\n\n<pre><code>Traceback (most recent call last):\n  File \".\\AgeGender.py\", line 47, in &lt;module&gt;\n    ageNet = cv.dnn.readNet(ageModel, ageProto)\ncv2.error: OpenCV(4.1.0) C:\\projects\\opencv- \npython\\opencv\\modules\\dnn\\src\\caffe\\caffe_io.cpp:1132: error: \n(-2:Unspecified error) FAILED: fs.is_open(). Can't open \n\"age_net.caffemodel\" in function 'cv::dnn::ReadProtoFromBinaryFile'\n</code></pre>\n\n<p>I just want to script to run normally without any errors so I could finish this nightmare</p>\n"}, {"tags": ["python", "sqlalchemy"], "comments": [{"owner": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "edited": false, "score": 1, "creation_date": 1559169218, "post_id": 56369285, "comment_id": 99341284, "body": "&quot;Base.metadata.drop_all(engine) runs but doesn&#39;t return anything&quot; \u2014 I don&#39;t think that method is supposed to return anything.  Did you actually check the database to see whether the tables no longer exist?"}, {"owner": {"reputation": 1079, "user_id": 106589, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/J125w.jpg?s=128&g=1", "display_name": "OpenDataAlex", "link": "https://stackoverflow.com/users/106589/opendataalex"}, "reply_to_user": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "edited": false, "score": 0, "creation_date": 1559169296, "post_id": 56369285, "comment_id": 99341298, "body": "Yes, nothing is actually deleted. I&#39;ve also verified that the user connecting to the database is able to drop objects via jdbc/SQL client."}], "answers": [{"tags": [], "owner": {"reputation": 1079, "user_id": 106589, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/J125w.jpg?s=128&g=1", "display_name": "OpenDataAlex", "link": "https://stackoverflow.com/users/106589/opendataalex"}, "is_accepted": true, "score": 1, "last_activity_date": 1559931959, "creation_date": 1559931959, "answer_id": 56499548, "question_id": 56369285, "link": "https://stackoverflow.com/questions/56369285/sqlalchemy-drop-all-not-dropping-tables/56499548#56499548", "title": "SQLAlchemy drop_all not dropping tables", "body": "<p>The issue turned out to be that because I was using postgresql, the public schema was being used by default because I had not defined a schema in the table models.  Once that was done and the schema was also added to any ForeignKey columns drop_all and create_all worked as documented.</p>\n\n<p>As an example, here is what ended up working:</p>\n\n<pre><code>class MyTable(Base):\n    __tablename__ = \"my_table\"\n    __table_args__ = {\"schema\": \"my_schema\"}\n\n    my_table_fk = Column(Integer, ForeignKey(\"my_schema.my_other_table.my_other_table_id\"))\n</code></pre>\n"}], "owner": {"reputation": 1079, "user_id": 106589, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/J125w.jpg?s=128&g=1", "display_name": "OpenDataAlex", "link": "https://stackoverflow.com/users/106589/opendataalex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1131, "favorite_count": 0, "accepted_answer_id": 56499548, "answer_count": 1, "score": 0, "last_activity_date": 1559931959, "creation_date": 1559168460, "last_edit_date": 1559223839, "question_id": 56369285, "link": "https://stackoverflow.com/questions/56369285/sqlalchemy-drop-all-not-dropping-tables", "title": "SQLAlchemy drop_all not dropping tables", "body": "<p>I'm trying to automate my application's database creation/deletion by using SQLAlchemy.  I have created models and querying via the ORM is working without issue.  However when I want to wipe and recreate the database from scratch, Base.metadata.drop_all(engine) runs but doesn't return anything when I try to troubleshoot via the Python console.  It also doesn't actually delete any of the objects in my data store.  I have also verified that the user account does have DROP privilege.</p>\n\n<p>When I run Base.metadata.sorted_tables I do get a list of tables which matches the models.  I also tried to run a for loop on sorted_tables and perform a drop per table, but got an error stating that the table didn't exist.</p>\n\n<p>My full code repo can be found at:<a href=\"https://github.com/OpenDataAlex/process_tracker_python/tree/master/process_tracker\" rel=\"nofollow noreferrer\">https://github.com/OpenDataAlex/process_tracker_python/tree/master/process_tracker</a>\nThe models are in the models/ directory while the engine creation code is in data_store.py.</p>\n\n<p>I've copied what I think are the relevant bits, but after many hours reading docs and trying to solve this, it's all blurring together x.x </p>\n\n<pre><code># The engine creation code\nengine = create_engine(data_store_type + '://' + data_store_username + ':' + data_store_password\n                                           + '@' + data_store_host + '/' + data_store_name)\n\n\nsession = sessionmaker(bind=engine)\n\nsession = session(expire_on_commit=False)\nsession.execute(\"SET search_path TO %s\" % data_store_name)\n</code></pre>\n\n<pre><code># The drop code, from data_store.py DataStore().initialize_data_store()\nself.logger.warn('ALERT - DATA STORE TO BE OVERWRITTEN - ALL DATA WILL BE LOST')\n\nBase.metadata.drop_all(self.engine)\n</code></pre>\n"}, {"tags": ["python", "python-3.x", "heatmap"], "answers": [{"comments": [{"owner": {"reputation": 38, "user_id": 11495777, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3WmbTx2tTfU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reB9-i0tIWfvSLiO4P5dZvebSy1xA/mo/photo.jpg?sz=128", "display_name": "Js541", "link": "https://stackoverflow.com/users/11495777/js541"}, "edited": false, "score": 0, "creation_date": 1559176393, "post_id": 56369365, "comment_id": 99342813, "body": "Could you please tell me in the above code how can I use your concept?"}, {"owner": {"reputation": 821, "user_id": 10452700, "user_type": "registered", "profile_image": "https://graph.facebook.com/2172245999723325/picture?type=large", "display_name": "Mario", "link": "https://stackoverflow.com/users/10452700/mario"}, "reply_to_user": {"reputation": 38, "user_id": 11495777, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3WmbTx2tTfU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reB9-i0tIWfvSLiO4P5dZvebSy1xA/mo/photo.jpg?sz=128", "display_name": "Js541", "link": "https://stackoverflow.com/users/11495777/js541"}, "edited": false, "score": 0, "creation_date": 1559178418, "post_id": 56369365, "comment_id": 99343200, "body": "call seaborn library by <code>import seaborn as sns</code> and replace right one by <code>df</code>"}], "tags": [], "owner": {"reputation": 821, "user_id": 10452700, "user_type": "registered", "profile_image": "https://graph.facebook.com/2172245999723325/picture?type=large", "display_name": "Mario", "link": "https://stackoverflow.com/users/10452700/mario"}, "is_accepted": false, "score": 1, "last_activity_date": 1559178088, "last_edit_date": 1559178088, "creation_date": 1559169120, "answer_id": 56369365, "question_id": 56369249, "link": "https://stackoverflow.com/questions/56369249/heat-map-generation-using-coordinate-points/56369365#56369365", "title": "Heat map generation using coordinate points", "body": "<p>The question you linked uses plotly. If you don't want to use that and want to simply smooth the way your data looks, I suggest just using a gaussian filter using scipy.</p>\n\n<p>At the top, import:</p>\n\n<pre><code>import seaborn as sns\nfrom scipy.ndimage.filters import gaussian_filter\n</code></pre>\n\n<p>Then use it like this:</p>\n\n<pre><code>df_smooth = gaussian_filter(df, sigma=1)\nsns.heatmap(df_smooth, vmin=-40, vmax=150, cmap =\"coolwarm\" , cbar=True , cbar_kws={\"ticks\":[-40,150,-20,0,25,50,75,100,125]})\n</code></pre>\n\n<p>You can change the amount of smoothing, using e.g. sigma=3, or any other number that gives you the amount of smoothing you want.</p>\n\n<p>Keep in mind that that will also \"smooth out\" any maximum data peaks you have, so your minimum and maximum data will not be the same that you specified in your normalization anymore. To still get good looking heatmaps I would suggest not using fixed values for your vmin and vmax, but:</p>\n\n<pre><code>sns.heatmap(df_smooth, vmin=np.min(df_smooth), vmax=np.max(df_smooth), cmap =\"coolwarm\" , cbar=True , cbar_kws={\"ticks\":[-40,150,-20,0,25,50,75,100,125]})\n</code></pre>\n\n<p>In case that you Gaussian filter fulfill your expectations you mentioned  you can even implement Gaussian normalization on your data directly. </p>\n"}, {"tags": [], "owner": {"reputation": 597, "user_id": 1410665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9130230a96246b71adfec3864633eab7?s=128&d=identicon&r=PG", "display_name": "user1410665", "link": "https://stackoverflow.com/users/1410665/user1410665"}, "is_accepted": true, "score": 1, "last_activity_date": 1559351037, "creation_date": 1559351037, "answer_id": 56403146, "question_id": 56369249, "link": "https://stackoverflow.com/questions/56369249/heat-map-generation-using-coordinate-points/56403146#56403146", "title": "Heat map generation using coordinate points", "body": "<p>Your code is perfect. Just change only one line, then your both issues will be solved.</p>\n\n<p><strong>Before changes</strong>:</p>\n\n<pre><code>ax[1].imshow(heatmap, alpha=.5, cmap='jet')\n</code></pre>\n\n<p><strong>After changes:</strong></p>\n\n<pre><code>ax[1].imshow(heatmap, alpha=.5, cmap='coolwarm', interpolation='gaussian')\n</code></pre>\n\n<p>Though above changes will solve your issue, but if you want then for additional transparency, you can use below function</p>\n\n<pre><code>def transparent_cmap(cmap, N=255):\n    \"Copy colormap and set alpha values\"\n\n    mycmap = cmap\n    mycmap._init()\n    mycmap._lut[:,-1] = np.linspace(0, 0.8, N+4)\n    return mycmap\nmycmap = transparent_cmap(plt.cm.coolwarm) \n</code></pre>\n\n<p>In that case, your previous code line will change like below:</p>\n\n<pre><code>ax[1].imshow(heatmap, alpha=.5, cmap=mycmap, vmin=0, vmax=1)\n</code></pre>\n"}], "owner": {"reputation": 38, "user_id": 11495777, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3WmbTx2tTfU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reB9-i0tIWfvSLiO4P5dZvebSy1xA/mo/photo.jpg?sz=128", "display_name": "Js541", "link": "https://stackoverflow.com/users/11495777/js541"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2108, "favorite_count": 1, "accepted_answer_id": 56403146, "answer_count": 2, "score": 1, "last_activity_date": 1559351037, "creation_date": 1559168201, "question_id": 56369249, "link": "https://stackoverflow.com/questions/56369249/heat-map-generation-using-coordinate-points", "title": "Heat map generation using coordinate points", "body": "<p>I am new in Python. The answer to my question might be available in the StackOverflow, but honestly speaking, I tried almost all the codes and suggestions available in the StackOverflow.  </p>\n\n<p><strong>My problem:</strong> Almost the same as it is described <a href=\"https://stackoverflow.com/questions/55317339/how-to-create-heatmap-over-an-image-using-coordinate-points\">here</a>. I have coordinate points (<code>x</code> and <code>y</code>) and the corresponding value (<code>p</code>) as a <code>.csv</code> file. I am reading that file using <code>pandas</code>.</p>\n\n<pre><code>df = pd.read_csv(\"example.csv\")\n</code></pre>\n\n<p>The <code>example.csv</code> file can be download from <a href=\"http://www.mediafire.com/file/qj2rk7aadkbacgo/stack.csv/file\" rel=\"nofollow noreferrer\">here</a>. Let an image of size <code>2000 x 2000</code>. </p>\n\n<p><strong>Task:</strong></p>\n\n<p>Based on the <code>x</code> and <code>y</code> coordinate points in the excel sheet, I have to locate the point in that image.</p>\n\n<p>Lets, <code>A</code> is an image and <code>A(x,y)</code> is any point within <code>A</code>. Now I have to generate a heat map in such a way so that 50 pixels from <code>x</code> and 50 pixels from<code>y</code> i.e., A(x,y), A(x+50, y), A(x, y+50) and A(x+50, y+50) contains <code>p</code> corresponding to that coordinate points.</p>\n\n<p>I found <a href=\"https://stackoverflow.com/questions/55317339/how-to-create-heatmap-over-an-image-using-coordinate-points\">this link</a> which is very helpful and serves my issue, but the problem is some more modifications are necessary for my datasets.</p>\n\n<p><strong>The code which is available in the above link:</strong></p>\n\n<pre><code>#!/usr/bin/python3\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd\nfrom skimage import io\nfrom skimage.color import rgb2gray\nimport matplotlib as mpl\n# Read original image\nimg = io.imread('img.jpg')\n\n# Get the dimensions of the original image\nx_dim, y_dim, z_dim = np.shape(img)\n\n# Create heatmap\nheatmap = np.zeros((x_dim, y_dim), dtype=float)\n\n# Read CSV with a Pandas DataFrame\ndf = pd.read_csv(\"data.csv\")\n\n# Set probabilities values to specific indexes in the heatmap\nfor index, row in df.iterrows():\n    x = np.int(row[\"x\"])\n    y = np.int(row[\"y\"])\n    x1 = np.int(row[\"x1\"])\n    y1 = np.int(row[\"y1\"])\n    p = row[\"Probability value\"]\n    heatmap[x:x1,y:y1] = p\n\n# Plot images\nfig, axes = plt.subplots(1, 2, figsize=(8, 4))\nax = axes.ravel()\n\nax[0].imshow(img)\nax[0].set_title(\"Original\")\nfig.colorbar(ax[0].imshow(img), ax=ax[0])\n\nax[1].imshow(img, vmin=0, vmax=1)\nax[1].imshow(heatmap, alpha=.5, cmap='jet')\nax[1].set_title(\"Original + heatmap\")\n\n# Specific colorbar\nnorm = mpl.colors.Normalize(vmin=0,vmax=2)\nN = 11\ncmap = plt.get_cmap('jet',N)\nsm = plt.cm.ScalarMappable(cmap=cmap, norm=norm)\nsm.set_array([])\nplt.colorbar(sm, ticks=np.linspace(0,1,N), \n             boundaries=np.arange(0,1.1,0.1)) \n\nfig.tight_layout()\nplt.show()\n</code></pre>\n\n<p><strong>Issues which I am facing when using this code:</strong></p>\n\n<ol>\n<li><p>This code is generating a heat map of square edges, but I am expecting a smooth edge. I know Gaussian distribution might solve this problem. But I am new in python and I don't know how to implement the Gaussian Distribution in my dataset.</p></li>\n<li><p>The regions which don't belong to the coordinate points also generating a layer of color. As a result in an overlayed image those layer covering the background of original images. In one sentence I want the background of the heat map will be transparent so that overlays will not create any problem in showing the regions which are not covered by the coordinate points. </p></li>\n</ol>\n\n<p>Any leads will be highly appreciated. </p>\n"}, {"tags": ["python", "python-3.x", "kivy"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11277150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29d6c7529eaa7ad9e62aeeff45ffc152?s=128&d=identicon&r=PG&f=1", "display_name": "Sheldon Cooper", "link": "https://stackoverflow.com/users/11277150/sheldon-cooper"}, "edited": false, "score": 0, "creation_date": 1559236299, "post_id": 56382472, "comment_id": 99365715, "body": "After adding initial height GridLayout isn&#39;t squeezing previous widget but after overflow Scrollview isn&#39;t working anymore."}, {"owner": {"reputation": 20381, "user_id": 7254633, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XCPaMN6qzA0/AAAAAAAAAAI/AAAAAAAAADs/o9igiVGFyK0/photo.jpg?sz=128", "display_name": "John Anderson", "link": "https://stackoverflow.com/users/7254633/john-anderson"}, "reply_to_user": {"reputation": 3, "user_id": 11277150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29d6c7529eaa7ad9e62aeeff45ffc152?s=128&d=identicon&r=PG&f=1", "display_name": "Sheldon Cooper", "link": "https://stackoverflow.com/users/11277150/sheldon-cooper"}, "edited": false, "score": 0, "creation_date": 1559238141, "post_id": 56382472, "comment_id": 99366468, "body": "You have a typo in your <code>kv</code> file: <code>hight:</code> should be <code>height:</code>"}], "tags": [], "owner": {"reputation": 20381, "user_id": 7254633, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XCPaMN6qzA0/AAAAAAAAAAI/AAAAAAAAADs/o9igiVGFyK0/photo.jpg?sz=128", "display_name": "John Anderson", "link": "https://stackoverflow.com/users/7254633/john-anderson"}, "is_accepted": true, "score": 0, "last_activity_date": 1559235272, "creation_date": 1559235272, "answer_id": 56382472, "question_id": 56369247, "link": "https://stackoverflow.com/questions/56369247/how-to-add-new-widget-in-gridlayout-without-resizing-older-widgets/56382472#56382472", "title": "How to add new widget in GridLayout without resizing older widgets?", "body": "<p>I believe you just need to set the height for each widget that you add to your <code>GridLayout</code>. For example:</p>\n\n<pre><code>    self.my_grid.add_widget(Label(text=title, size_hint=(1, None), height=50))\n</code></pre>\n\n<p>You might need to do the same for the other widgets you are adding. The <code>GridLayout</code> may give the initially added widgets more space than that, but will not squeeze them any any tighter than your specified <code>height</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 11277150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29d6c7529eaa7ad9e62aeeff45ffc152?s=128&d=identicon&r=PG&f=1", "display_name": "Sheldon Cooper", "link": "https://stackoverflow.com/users/11277150/sheldon-cooper"}, "is_accepted": false, "score": 0, "last_activity_date": 1559238413, "last_edit_date": 1559238413, "creation_date": 1559238034, "answer_id": 56383095, "question_id": 56369247, "link": "https://stackoverflow.com/questions/56369247/how-to-add-new-widget-in-gridlayout-without-resizing-older-widgets/56383095#56383095", "title": "How to add new widget in GridLayout without resizing older widgets?", "body": "<p>After applying following changes to kv file  </p>\n\n<pre><code>&lt;Downloading&gt;:\n    size: self.size\n    my_grid: mygrid\n    GridLayout:\n        cols: 1\n        size_hint_y : None\n        row_default_height: '25dp'\n        row_force_default: True\n        id: mygrid\n</code></pre>\n\n<p>And adding this line in the end of constructor (<code>__init__</code>), it is working as expected.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>self.my_grid.bind(minimum_height=self.my_grid.setter('height'))\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11277150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29d6c7529eaa7ad9e62aeeff45ffc152?s=128&d=identicon&r=PG&f=1", "display_name": "Sheldon Cooper", "link": "https://stackoverflow.com/users/11277150/sheldon-cooper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 56382472, "answer_count": 2, "score": 0, "last_activity_date": 1559238413, "creation_date": 1559168190, "last_edit_date": 1559175649, "question_id": 56369247, "link": "https://stackoverflow.com/questions/56369247/how-to-add-new-widget-in-gridlayout-without-resizing-older-widgets", "title": "How to add new widget in GridLayout without resizing older widgets?", "body": "<p>I have added GridLayout to ScrollView, and I'm adding widgets in GridLayout dynamically from python program.Instead of using more space of window it's resizing height of older widgets.What am i doing wrong here?</p>\n\n<p>I tried putting BoxLayout inside GridLayout but it's not working.\nI also tried to add widgets directly to ScrollView but i found out ScrollView only supports one widget.</p>\n\n<p>My kv code:</p>\n\n<pre><code>&lt;Downloading&gt;:\n    my_grid: mygrid\n    GridLayout:\n        cols: 1\n        size_hint_y : None\n        hight: self.minimum_height\n        id: mygrid\n</code></pre>\n\n<p>My python code:</p>\n\n<pre><code>class Downloading(ScrollView):\n    set_text = ObjectProperty()\n    my_grid = ObjectProperty()\n\n    def __init__(self, select, link, path, username, password):\n\n        self.select = select\n        self.link = link\n        self.path = path\n        self.username = username\n        self.password = password\n        self.p_bar = []\n        self.stat = []\n\n        self.parent_conn, self.child_conn = Pipe()\n\n        p = Process(target=main, args=(self.child_conn, self.select,\n                                       self.link, self.path,\n                                       self.username, self.password))\n        p.start()\n\n        super().__init__()\n\n        self.event = Clock.schedule_interval(self.download_GUI, 0.1)\n\n    def newFile(self, title):\n        # self.newId = \"stat\" + str(len(self.p_bar) + 1)\n        self.stat.append(Label(text=''))\n        self.p_bar.append(ProgressBar())\n        self.my_grid.add_widget(Label(text=title))\n        self.my_grid.add_widget(self.stat[-1])\n        self.my_grid.add_widget(self.p_bar[-1])\n\n    def download_GUI(self, a):\n\n        temp = self.parent_conn.recv()\n\n        print(temp)\n\n        if temp == \"new\":\n            self.downloading = True\n            return\n        if self.downloading:\n            self.newFile(temp)\n            self.downloading = False\n            return\n        if type(temp) == type({}):\n            self.complete = temp['complete']\n            if not self.complete:\n                status = \"{0}//{1} @ {2}  ETA: {3}\".format(temp['dl_size'],\n                                                      temp['total_size'],temp['speed'],temp['eta'])\n                self.stat[-1].text = status\n                self.p_bar[-1].value = temp['progress']\n                return\n\n        if temp == \"end\":\n            self.event.cancel()\n            Clock.schedule_once(exit, 3)\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/upO38.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["python", "json", "csv"], "comments": [{"owner": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "edited": false, "score": 0, "creation_date": 1559168494, "post_id": 56369226, "comment_id": 99341097, "body": "Does each file in the tar have 22,673,735 records or is that the total amount of records across all 144,390 files?"}, {"owner": {"reputation": 437, "user_id": 3413699, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vN2gF.jpg?s=128&g=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/3413699/leon"}, "reply_to_user": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "edited": false, "score": 0, "creation_date": 1559169088, "post_id": 56369226, "comment_id": 99341253, "body": "Total amount of records is 22,673,735 across all 144,390 files. @Will"}, {"owner": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "edited": false, "score": 0, "creation_date": 1559169129, "post_id": 56369226, "comment_id": 99341261, "body": "SO you&#39;d except 22,673,735 rows in the CSV right?"}, {"owner": {"reputation": 437, "user_id": 3413699, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vN2gF.jpg?s=128&g=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/3413699/leon"}, "reply_to_user": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "edited": false, "score": 0, "creation_date": 1559169165, "post_id": 56369226, "comment_id": 99341268, "body": "That&#39;s right @Will"}, {"owner": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "edited": false, "score": 0, "creation_date": 1559169287, "post_id": 56369226, "comment_id": 99341294, "body": "Got it. I&#39;ll post below"}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1559169603, "post_id": 56369419, "comment_id": 99341371, "body": "It&#39;s Python, so it&#39;s called a list, not an array."}, {"owner": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1559169778, "post_id": 56369419, "comment_id": 99341415, "body": "array was used in the generic non-coding sense as opposed to the python-data-structure-employed sense. But thank you @Barmar, that was super helpful."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1559169868, "post_id": 56369419, "comment_id": 99341444, "body": "I constantly have to fix my Python answers because I think &quot;array&quot; generically as well. In the Python context, arrays refers to numpy."}, {"owner": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1559170054, "post_id": 56369419, "comment_id": 99341490, "body": "Actually, in Python arrays are a stand library data type. But then we&#39;re getting pedantic."}, {"owner": {"reputation": 437, "user_id": 3413699, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vN2gF.jpg?s=128&g=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/3413699/leon"}, "edited": false, "score": 0, "creation_date": 1559196044, "post_id": 56369419, "comment_id": 99346742, "body": "so silly mistake i made... csv_writer loop should be outside of that loop which appending data to data list. Thanks mate. @Will"}, {"owner": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "reply_to_user": {"reputation": 437, "user_id": 3413699, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vN2gF.jpg?s=128&g=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/3413699/leon"}, "edited": false, "score": 0, "creation_date": 1559198190, "post_id": 56369419, "comment_id": 99347555, "body": "@Leon yeah, only, that list is completely redundant and will just double your memory usage"}], "tags": [], "owner": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "is_accepted": true, "score": 2, "last_activity_date": 1559169634, "last_edit_date": 1559169634, "creation_date": 1559169540, "answer_id": 56369419, "question_id": 56369226, "link": "https://stackoverflow.com/questions/56369226/increased-records-while-reading-tar-file-with-json-formatted-data/56369419#56369419", "title": "Increased Records while reading tar file with JSON formatted Data", "body": "<p>The problem is in the <code>data</code> list. It is keeping memory every time you read lines and then you loop over it again to do the csv write. Not too sure why you need <code>data</code> ...</p>\n\n<p>Try this</p>\n\n<pre><code>if f is not None:\n    for line in f.readlines():\n        print(line.strip())\n        dt = json.loads(line.strip())\n        csv_writer.writerow([dt['c_id'], ..... \n</code></pre>\n"}], "owner": {"reputation": 437, "user_id": 3413699, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vN2gF.jpg?s=128&g=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/3413699/leon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 56369419, "answer_count": 1, "score": 0, "last_activity_date": 1559169634, "creation_date": 1559168041, "question_id": 56369226, "link": "https://stackoverflow.com/questions/56369226/increased-records-while-reading-tar-file-with-json-formatted-data", "title": "Increased Records while reading tar file with JSON formatted Data", "body": "<p>20190528.tar.gz file has 144,390 files and 22,673,735 records. Each file has some thousands JSON formatted data. </p>\n\n<p><strong>One Raw Record in single line [I've structured this to understand better]:</strong></p>\n\n<pre><code>{\n    \"t_id\":\"80740185.1558980000000.120184.121164\",\n    \"s_id\":\"80740185\",\n    \"pt_slot\":\"null:null\",\n    \"ch_id\":1,\"o_id\":121164,\"c_id\":120184,\n    \"msg_type\":1,\n    \"amd\":\"{\n                \\\"msg\\\":\\\" some Bengali text\\\",\n                \\\"mask\\\":\\\"1GB_OFFER\\\",\n                \\\"ec\\\":\\\"1\\\",\n                \\\"time-out\\\":\\\"0\\\",\n                \\\"validity\\\":\\\"30052019 000000\\\"\n           }\",\n    \"time\":1558960217731,\n    \"dlr\":\"1\",\n    \"msisdn\":\"xxxxx\",\n    \"entity\":1\n}\n</code></pre>\n\n<p>I'm reading the tar.gz file and trying to make pipe separated CSV Files. </p>\n\n<p><strong>Here Is My Code</strong></p>\n\n<pre><code>#!/usr/bin/python\nimport json\nimport csv\nimport ast\nimport tarfile\n\ndef write_sms_dat_to_csv_file():\n        tar= tarfile.open('20190528.tar.gz','r:gz')\n        csv_writer = csv.writer(open('csv_data.txt','wb+'),delimiter = '|')\n        for member in tar.getmembers():\n                f = tar.extractfile(member)\n                if f is not None:\n                        data = []\n                        for line in f.readlines():\n                                print(line.strip())\n                                data.append(json.loads(line.strip()))\n                                for dt in data:\n                                        csv_writer.writerow([dt['c_id'],dt['msisdn'],ast.literal_eval(dt['amd'])['mask'],ast.literal_eval(dt['amd'])['ec']])\n\nif __name__==\"__main__\":\n        write_sms_dat_to_csv_file()\n</code></pre>\n\n<p>Above code has no issues, works fine. The problem is its creating the CSV file with more records than it should.  I mean much more records. Code is not finishing even the output records reached 30 million. I had to kill. </p>\n\n<p>I mean output record number should be same as input record number. </p>\n\n<p>I'm failing to find the bug in my code for which record is being duplicated.</p>\n\n<p>Could you help to find the error in logic? Thanks. </p>\n"}, {"tags": ["python", "unicode", "utf-8", "virtualenv", "decode"], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 9230980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/424db5eda7687b9644b3f04700edc1e3?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Marques", "link": "https://stackoverflow.com/users/9230980/miguel-marques"}, "is_accepted": false, "score": 0, "last_activity_date": 1562598153, "last_edit_date": 1562598153, "creation_date": 1562597699, "answer_id": 56937587, "question_id": 56369215, "link": "https://stackoverflow.com/questions/56369215/unicodedecodeerror-while-using-pip-install-in-virtualenv/56937587#56937587", "title": "UnicodeDecodeError while using pip install in virtualenv", "body": "<p>I just moved from Mac to Windows and I was facing the exact same issue when using PowerShell and <code>virtualenv</code>. I have switched to use the command line instead with the built-in <code>venv</code> and it worked. It might be worth giving it a try if you are not fixed on <code>virtualenv</code>. </p>\n"}], "owner": {"reputation": 21, "user_id": 11575138, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uUJRut7rCt0/AAAAAAAAAAI/AAAAAAAAJtk/PCUwZ4-1nzk/photo.jpg?sz=128", "display_name": "Goku", "link": "https://stackoverflow.com/users/11575138/goku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 447, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1562598153, "creation_date": 1559167985, "last_edit_date": 1559169590, "question_id": 56369215, "link": "https://stackoverflow.com/questions/56369215/unicodedecodeerror-while-using-pip-install-in-virtualenv", "title": "UnicodeDecodeError while using pip install in virtualenv", "body": "<p>I am installing Nucypher in a virtual environment and getting the <code>UnicodeDecodeError</code> as shown below: </p>\n\n<p>Command: </p>\n\n<pre><code>python -m pip install nucypher\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>ERROR: Exception:\nTraceback (most recent call last):\n  File \"C:\\Users\\PRANIT\\AppData\\Local\\Programs\\Python\\Python37-32\\lib\\site-packages\\pip\\_internal\\cli\\base_command.py\", line 178, in main\n    status = self.run(options, args)\n  File \"C:\\Users\\PRANIT\\AppData\\Local\\Programs\\Python\\Python37-32\\lib\\site-packages\\pip\\_internal\\commands\\install.py\", line 352, in run\n    resolver.resolve(requirement_set)\n  File \"C:\\Users\\PRANIT\\AppData\\Local\\Programs\\Python\\Python37-32\\lib\\site-packages\\pip\\_internal\\resolve.py\", line 131, in resolve\n    self._resolve_one(requirement_set, req)\n  File \"C:\\Users\\PRANIT\\AppData\\Local\\Programs\\Python\\Python37-32\\lib\\site-packages\\pip\\_internal\\resolve.py\", line 294, in _resolve_one\n    abstract_dist = self._get_abstract_dist_for(req_to_install)\n  File \"C:\\Users\\PRANIT\\AppData\\Local\\Programs\\Python\\Python37-32\\lib\\site-packages\\pip\\_internal\\resolve.py\", line 242, in _get_abstract_dist_for\n    self.require_hashes\n  File \"C:\\Users\\PRANIT\\AppData\\Local\\Programs\\Python\\Python37-32\\lib\\site-packages\\pip\\_internal\\operations\\prepare.py\", line 362, in prepare_linked_requirement\n    abstract_dist.prep_for_dist(finder, self.build_isolation)\n  File \"C:\\Users\\PRANIT\\AppData\\Local\\Programs\\Python\\Python37-32\\lib\\site-packages\\pip\\_internal\\operations\\prepare.py\", line 171, in prep_for_dist\n    self.req.prepare_metadata()\n  File \"C:\\Users\\PRANIT\\AppData\\Local\\Programs\\Python\\Python37-32\\lib\\site-packages\\pip\\_internal\\req\\req_install.py\", line 553, in prepare_metadata\n    metadata_name = canonicalize_name(self.metadata[\"Name\"])\n  File \"C:\\Users\\PRANIT\\AppData\\Local\\Programs\\Python\\Python37-32\\lib\\site-packages\\pip\\_internal\\req\\req_install.py\", line 674, in metadata\n    self._metadata = get_metadata(self.get_dist())\n  File \"C:\\Users\\PRANIT\\AppData\\Local\\Programs\\Python\\Python37-32\\lib\\site-packages\\pip\\_internal\\utils\\packaging.py\", line 48, in get_metadata\n    metadata = dist.get_metadata('METADATA')\n  File \"C:\\Users\\PRANIT\\AppData\\Local\\Programs\\Python\\Python37-32\\lib\\site-packages\\pip\\_vendor\\pkg_resources\\__init__.py\", line 1420, in get_metadata\n    return value.decode('utf-8') if six.PY3 else value\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 185: invalid continuation byte\n</code></pre>\n\n<p>I am using windows 10, pip 19.1.1.\nI didn't get this error while installing <code>Numpy</code> in the same virtual environment. Please suggest as to what needs to be done. Thanks in advance!</p>\n"}, {"tags": ["python", "python-3.x", "subprocess"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 10536726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca374e1c44c6b1a1d36caf1af87f322?s=128&d=identicon&r=PG&f=1", "display_name": "newbie_here", "link": "https://stackoverflow.com/users/10536726/newbie-here"}, "edited": false, "score": 0, "creation_date": 1559169646, "post_id": 56369227, "comment_id": 99341377, "body": "Lighting fast! it indeed solved the problem.  thank you very much!"}], "tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": true, "score": 1, "last_activity_date": 1559168053, "creation_date": 1559168053, "answer_id": 56369227, "question_id": 56369178, "link": "https://stackoverflow.com/questions/56369178/using-subprocess-run-the-program-doesnt-work-but-copying-the-text-from-the-run/56369227#56369227", "title": "using subprocess.run the program doesn&#39;t work, but copying the text from the run([xxx]) does work. any suggestions", "body": "<p>You need to separate <em>all</em> the arguments; <code>\"--cut 20\"</code> passes a single argument containing both the switch and its value (that it, it tells program it received a single switch named <code>cut 20</code>). You'd only pass it as a single argument if, at the command line, you literally passed <code>\"--cut 20\"</code> in quotes to prevent the whitespace from breaking it up into separate pieces of the program's <code>argv</code> (which you clearly don't in your example).</p>\n\n<p>Split it up to <code>\"--cut\", \"20\"</code> and it should work.</p>\n"}, {"tags": [], "owner": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "is_accepted": false, "score": 1, "last_activity_date": 1559168193, "creation_date": 1559168193, "answer_id": 56369248, "question_id": 56369178, "link": "https://stackoverflow.com/questions/56369178/using-subprocess-run-the-program-doesnt-work-but-copying-the-text-from-the-run/56369248#56369248", "title": "using subprocess.run the program doesn&#39;t work, but copying the text from the run([xxx]) does work. any suggestions", "body": "<p>Your code passes <code>--cut 20</code> to cutadapt as a single argument, which it apparently can't handle.  (From cutadapt's argument parser's point of view, it probably thinks you're trying to specify an option named \"<code>cut 20</code>\", which doesn't exist.)  You need to split the argument in two:</p>\n\n<pre><code>subprocess.run([\"cutadapt\", \"--cut\", \"20\", \"-o\", output_file, input_file])\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 10536726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca374e1c44c6b1a1d36caf1af87f322?s=128&d=identicon&r=PG&f=1", "display_name": "newbie_here", "link": "https://stackoverflow.com/users/10536726/newbie-here"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 56369227, "answer_count": 2, "score": 0, "last_activity_date": 1559175740, "creation_date": 1559167734, "last_edit_date": 1559175740, "question_id": 56369178, "link": "https://stackoverflow.com/questions/56369178/using-subprocess-run-the-program-doesnt-work-but-copying-the-text-from-the-run", "title": "using subprocess.run the program doesn&#39;t work, but copying the text from the run([xxx]) does work. any suggestions", "body": "<p>I have written a short bit of code to run a program (cutadapt) on multiple files. however it gives the following error for each of the files it tries to run: \"cutadapt: error: unrecognized arguments\". \nRun on MacOS, python 3.7.3, </p>\n\n<p>If I print the statement in the same program, copy that as a single call in the terminal, then it does work. Does anyone see what I am doing wrong?</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import glob\n\nimport subprocess\n\nfastq_folder = \"/path/2019.01_spades_output_pathodetect/FASTQ_trimming\"\n\nlistoffiles = glob.glob(fastq_folder + \"/*.gz\")\n\nfor fastq in listoffiles:\n    input_file = fastq\n    output_file = fastq.replace(\"_001.fastq.gz\", \"_001CUT20.fastq.gz\")\n    output_file = fastq.replace(\"2019.01_spades_output_pathodetect/FASTQ_trimming/\", \"2019.01_spades_output_pathodetect/FASTQ_trimming/CUT20/\")\n    print(\"cutadapt\", \"--cut 20\", \"-o\", output_file, input_file)\n    subprocess.run([\"cutadapt\", \"--cut 20\", \"-o\", output_file, input_file])\n</code></pre>\n\n<p><strong>so the output in the terminal is:</strong></p>\n\n<pre><code>cutadapt --cut 20 -o /path/2019.01_spades_output_pathodetect/FASTQ_trimming/CUT20/AWGS09281_S20_L001_R2_001.fastq.gz /path/2019.01_spades_output_pathodetect/FASTQ_trimming/AWGS09281_S20_L001_R2_001.fastq.gz\nRun \"cutadapt --help\" to see command-line options.\nSee https://cutadapt.readthedocs.io/ for full documentation.\n\ncutadapt: error: unrecognized arguments: /path/2019.01_spades_output_pathodetect/FASTQ_trimming/AWGS09281_S20_L001_R2_001.fastq.gz\n</code></pre>\n\n<p><strong>Then, when I copy the printed statement, it works:</strong></p>\n\n<pre><code>cutadapt --cut 20 -o /path/2019.01_spades_output_pathodetect/FASTQ_trimming/CUT20/AWGS09281_S20_L001_R2_001.fastq.gz /path/2019.01_spades_output_pathodetect/FASTQ_trimming/AWGS09281_S20_L001_R2_001.fastq.gz\n\n\nThis is cutadapt 2.3 with Python 3.7.3\nCommand line parameters: --cut 20 -o /path/2019.01_spades_output_pathodetect/FASTQ_trimming/CUT20/AWGS09281_S20_L001_R2_001.fastq.gz /path/2019.01_spades_output_pathodetect/FASTQ_trimming/AWGS09281_S20_L001_R2_001.fastq.gz\nProcessing reads on 1 core in single-end mode ...\n[   8&lt;-------] 00:00:06       490,635 reads  @     13.6 \u00b5s/read;   4.42 M reads/minute\nFinished in 6.71 s (14 us/read; 4.39 M reads/minute).\n</code></pre>\n"}, {"tags": ["python", "mysql", "python-3.x", "arduino"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 7659789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d5ba539d07fbc90f8a7d62b6638f5c?s=128&d=identicon&r=PG&f=1", "display_name": "Saul Salcedo", "link": "https://stackoverflow.com/users/7659789/saul-salcedo"}, "edited": false, "score": 0, "creation_date": 1559227548, "post_id": 56372403, "comment_id": 99361300, "body": "Hello, thank you for the answer, this is the string I get: <b>&quot;{&#39;id&#39;: &#39;rx&#39;, &#39;source_addr_long&#39;: b &#39;\\ x00 \\ x13 \\ xa2 \\ x00A \\ x97 \\ xeaT&#39;, &#39;source_addr&#39;: b &#39;\\ xf3 \\ n&#39;, &#39; options&#39;: b &#39;\\ x01&#39;, &#39;rf_data&#39;: b &#39;ArduinoA_BtnA = 1&#39;} &quot;</b>  The data that I need is in &#39;rf_data&#39;, so I change &quot;param&quot; to &#39;rf_data&#39; when I run the code I get this error: &quot;TypeError: not all arguments converted during bytes formatting&quot;. Regards"}, {"owner": {"reputation": 51, "user_id": 7659789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d5ba539d07fbc90f8a7d62b6638f5c?s=128&d=identicon&r=PG&f=1", "display_name": "Saul Salcedo", "link": "https://stackoverflow.com/users/7659789/saul-salcedo"}, "edited": false, "score": 0, "creation_date": 1559227850, "post_id": 56372403, "comment_id": 99361479, "body": "Not yet. Regards."}, {"owner": {"reputation": 4897, "user_id": 6700019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ba979f781d106a9db9b35fc6ff518b2?s=128&d=identicon&r=PG", "display_name": "Masoud Rahimi", "link": "https://stackoverflow.com/users/6700019/masoud-rahimi"}, "reply_to_user": {"reputation": 51, "user_id": 7659789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d5ba539d07fbc90f8a7d62b6638f5c?s=128&d=identicon&r=PG&f=1", "display_name": "Saul Salcedo", "link": "https://stackoverflow.com/users/7659789/saul-salcedo"}, "edited": false, "score": 0, "creation_date": 1559228016, "post_id": 56372403, "comment_id": 99361571, "body": "Can you add full traceback to your question? I mean all the error."}, {"owner": {"reputation": 51, "user_id": 7659789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d5ba539d07fbc90f8a7d62b6638f5c?s=128&d=identicon&r=PG&f=1", "display_name": "Saul Salcedo", "link": "https://stackoverflow.com/users/7659789/saul-salcedo"}, "edited": false, "score": 0, "creation_date": 1559228116, "post_id": 56372403, "comment_id": 99361625, "body": "Yes sure, this is the error: <b>&quot; {&#39;id&#39;: &#39;rx&#39;,  &#39;options&#39;: b&#39;\\x01&#39;,  &#39;rf_data&#39;: b&#39;  ArduinoA_BtnA  =  1  &#39;,  &#39;source_addr&#39;: b&#39;\\xf3\\n&#39;,  &#39;source_addr_long&#39;: b&#39;\\x00\\x13\\xa2\\x00A\\x97\\xeaT&#39;} Traceback (most recent call last):   File &quot;C:\\Users\\User\\AppData\\Local\\Programs\\Python\\Python37\\lib\\si&zwnj;&#8203;te-packages\\MySQLdb\\&zwnj;&#8203;cursors.py&quot;, line 201, in execute     query = query % args TypeError: not all arguments converted during bytes formatting &quot;</b>"}, {"owner": {"reputation": 51, "user_id": 7659789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d5ba539d07fbc90f8a7d62b6638f5c?s=128&d=identicon&r=PG&f=1", "display_name": "Saul Salcedo", "link": "https://stackoverflow.com/users/7659789/saul-salcedo"}, "edited": false, "score": 0, "creation_date": 1559229107, "post_id": 56372403, "comment_id": 99362136, "body": "Now I receive this error: <b>&quot; Now I receive this error: {&#39;id&#39;: &#39;rx&#39;,  &#39;options&#39;: b&#39;\\x01&#39;,  &#39;rf_data&#39;: b&#39;  ArduinoA_BtnA  =  1  &#39;,  &#39;source_addr&#39;: b&#39;\\xf3\\n&#39;,  &#39;source_addr_long&#39;: b&#39;\\x00\\x13\\xa2\\x00A\\x97\\xeaT&#39;} Traceback (most recent call last):   File &quot;C:\\Users\\User\\AppData\\Local\\Programs\\Python\\Python37\\lib\\si&zwnj;&#8203;te-packages\\MySQLdb\\&zwnj;&#8203;cursors.py&quot;, line 201, in execute     query = query % args TypeError: not all arguments converted during bytes formatting &quot;</b> ....."}, {"owner": {"reputation": 51, "user_id": 7659789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d5ba539d07fbc90f8a7d62b6638f5c?s=128&d=identicon&r=PG&f=1", "display_name": "Saul Salcedo", "link": "https://stackoverflow.com/users/7659789/saul-salcedo"}, "edited": false, "score": 0, "creation_date": 1559229133, "post_id": 56372403, "comment_id": 99362152, "body": "<b>&quot; During handling of the above exception, another exception occurred:  Traceback (most recent call last):   File &quot;leerxbee.py&quot;, line 21, in &lt;module&gt;     &quot;INSERT INTO xbeedata (value) VALUES (%s)&quot;, (value[&#39;rf_data&#39;].decode()))   File &quot;C:\\Users\\User\\AppData\\Local\\Programs\\Python\\Python37\\lib\\si&zwnj;&#8203;te-packages\\MySQLdb\\&zwnj;&#8203;cursors.py&quot;, line 203, in execute     raise ProgrammingError(str(m)) MySQLdb._exceptions.ProgrammingError: not all arguments converted during bytes formatting &quot;</b>"}, {"owner": {"reputation": 4897, "user_id": 6700019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ba979f781d106a9db9b35fc6ff518b2?s=128&d=identicon&r=PG", "display_name": "Masoud Rahimi", "link": "https://stackoverflow.com/users/6700019/masoud-rahimi"}, "reply_to_user": {"reputation": 51, "user_id": 7659789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d5ba539d07fbc90f8a7d62b6638f5c?s=128&d=identicon&r=PG&f=1", "display_name": "Saul Salcedo", "link": "https://stackoverflow.com/users/7659789/saul-salcedo"}, "edited": false, "score": 0, "creation_date": 1559229246, "post_id": 56372403, "comment_id": 99362217, "body": "I removed the formatting from your query check the new one it should work now. I also fixed tuple for single element add."}, {"owner": {"reputation": 4897, "user_id": 6700019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ba979f781d106a9db9b35fc6ff518b2?s=128&d=identicon&r=PG", "display_name": "Masoud Rahimi", "link": "https://stackoverflow.com/users/6700019/masoud-rahimi"}, "reply_to_user": {"reputation": 51, "user_id": 7659789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d5ba539d07fbc90f8a7d62b6638f5c?s=128&d=identicon&r=PG&f=1", "display_name": "Saul Salcedo", "link": "https://stackoverflow.com/users/7659789/saul-salcedo"}, "edited": false, "score": 0, "creation_date": 1559230244, "post_id": 56372403, "comment_id": 99362752, "body": "What is the <code>xbeedata</code> table how many columns does it have? I&#39;m not sure about the type of <code>value</code> you are trying to insert. Is it a blob? Can you post the SQL query for the table?"}, {"owner": {"reputation": 51, "user_id": 7659789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d5ba539d07fbc90f8a7d62b6638f5c?s=128&d=identicon&r=PG&f=1", "display_name": "Saul Salcedo", "link": "https://stackoverflow.com/users/7659789/saul-salcedo"}, "edited": false, "score": 0, "creation_date": 1559230604, "post_id": 56372403, "comment_id": 99362976, "body": "The table xbee has 2 columns, id and value, value is of type varchar. This is the structure of the table:    <a href=\"https://drive.google.com/file/d/1o13NDU-_VEP0xQm1aT2SRcRynJ1cjT8g/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/1o13NDU-_VEP0xQm1aT2SRcRynJ1cjT8g/&hellip;</a>"}, {"owner": {"reputation": 4897, "user_id": 6700019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ba979f781d106a9db9b35fc6ff518b2?s=128&d=identicon&r=PG", "display_name": "Masoud Rahimi", "link": "https://stackoverflow.com/users/6700019/masoud-rahimi"}, "reply_to_user": {"reputation": 51, "user_id": 7659789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d5ba539d07fbc90f8a7d62b6638f5c?s=128&d=identicon&r=PG&f=1", "display_name": "Saul Salcedo", "link": "https://stackoverflow.com/users/7659789/saul-salcedo"}, "edited": false, "score": 0, "creation_date": 1559232120, "post_id": 56372403, "comment_id": 99363806, "body": "OK, the value is a string type and the <code>value[&#39;rf_data&#39;]</code> is a byte string. try this <code>cursor.execute(&quot;&quot;&quot;INSERT INTO xbeedata (value) VALUES (&#39;%s&#39;)&quot;&quot;&quot; % (value[&#39;rf_data&#39;].decode()))</code>"}, {"owner": {"reputation": 4897, "user_id": 6700019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ba979f781d106a9db9b35fc6ff518b2?s=128&d=identicon&r=PG", "display_name": "Masoud Rahimi", "link": "https://stackoverflow.com/users/6700019/masoud-rahimi"}, "reply_to_user": {"reputation": 51, "user_id": 7659789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d5ba539d07fbc90f8a7d62b6638f5c?s=128&d=identicon&r=PG&f=1", "display_name": "Saul Salcedo", "link": "https://stackoverflow.com/users/7659789/saul-salcedo"}, "edited": false, "score": 0, "creation_date": 1559233158, "post_id": 56372403, "comment_id": 99364342, "body": "I edited the code but using <code>cursor.execute(&quot;INSERT INTO xbeedata (value) VALUES (%s)&quot;, (value[&#39;rf_data&#39;].decode(),))</code> is a better approach as uses paramtererize sql."}, {"owner": {"reputation": 51, "user_id": 7659789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d5ba539d07fbc90f8a7d62b6638f5c?s=128&d=identicon&r=PG&f=1", "display_name": "Saul Salcedo", "link": "https://stackoverflow.com/users/7659789/saul-salcedo"}, "edited": false, "score": 0, "creation_date": 1559233994, "post_id": 56372403, "comment_id": 99364714, "body": "Thank you, M. R. Regards"}, {"owner": {"reputation": 51, "user_id": 7659789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d5ba539d07fbc90f8a7d62b6638f5c?s=128&d=identicon&r=PG&f=1", "display_name": "Saul Salcedo", "link": "https://stackoverflow.com/users/7659789/saul-salcedo"}, "edited": false, "score": 0, "creation_date": 1559234263, "post_id": 56372403, "comment_id": 99364835, "body": "Another question, the value I get is this: &quot;ArduinoA_BtnA=1&quot;, Is there a way to separate the string and put &quot;1&quot; in another column?"}, {"owner": {"reputation": 4897, "user_id": 6700019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ba979f781d106a9db9b35fc6ff518b2?s=128&d=identicon&r=PG", "display_name": "Masoud Rahimi", "link": "https://stackoverflow.com/users/6700019/masoud-rahimi"}, "reply_to_user": {"reputation": 51, "user_id": 7659789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d5ba539d07fbc90f8a7d62b6638f5c?s=128&d=identicon&r=PG&f=1", "display_name": "Saul Salcedo", "link": "https://stackoverflow.com/users/7659789/saul-salcedo"}, "edited": false, "score": 0, "creation_date": 1559236770, "post_id": 56372403, "comment_id": 99365891, "body": "Why not, you can use <code>result = &#39;ArduinoA_BtnA=1&#39;.split(&quot;=&quot;)</code> then <code>result[0]</code> is string and <code>result[1]</code> is number."}], "tags": [], "owner": {"reputation": 4897, "user_id": 6700019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ba979f781d106a9db9b35fc6ff518b2?s=128&d=identicon&r=PG", "display_name": "Masoud Rahimi", "link": "https://stackoverflow.com/users/6700019/masoud-rahimi"}, "is_accepted": true, "score": 1, "last_activity_date": 1559233226, "last_edit_date": 1559233226, "creation_date": 1559195687, "answer_id": 56372403, "question_id": 56369145, "link": "https://stackoverflow.com/questions/56369145/send-data-to-mysql-received-from-serial-port/56372403#56372403", "title": "Send data to MySQL received from serial port", "body": "<p>There are some problems with your code:</p>\n\n<ol>\n<li><p>You don't need to connect to your MySQL DB each time in a loop.</p></li>\n<li><p>Accordign to <a href=\"https://python-xbee.readthedocs.io/en/latest/#frame-data-format\" rel=\"nofollow noreferrer\">docs</a>:</p>\n\n<blockquote>\n  <p>Information returned from this library is a dictionary in the following format:</p>\n\n<pre><code>{'id':str,\n 'param':binary data,\n ...}\n</code></pre>\n  \n  <p>The id field is always a human-readable name of the packet type\n  received. All following fields, shown above with the key \u2018param\u2019, map\n  binary data to each of the possible fields contained within the\n  received data frame.</p>\n</blockquote></li>\n</ol>\n\n<p>So the <code>value</code> is a dictionary type and you need to use the <code>param</code> key which is your valid data. I'm not sure what is the <code>param</code> in your example but you can simply put a <code>print(value)</code> and see the results. If you still insist on adding <code>value</code> to your table, you need to serialize it like a JSON string.</p>\n\n<pre><code>import serial\nfrom xbee import XBee\nimport MySQLdb\nimport json\nfrom pprint import pprint\n\n\nserial_port = serial.Serial('COM5', 9600)\nxbee = XBee(serial_port)\n\nsql_conn = MySQLdb.connect('localhost', 'root', 'pass', 'XBee')\ncursor = sql_conn.cursor()\n\nwhile True:\n    try:\n        value = xbee.wait_read_frame()\n        if value:\n            pprint(value)\n            # Assumed results in 'rf_data' ('param') key\n            # the 'rf_data' is byte string so it is better to decode it first\n            cursor.execute(\n                \"\"\"INSERT INTO xbeedata (value) VALUES ('%s')\"\"\" % (value['rf_data'].decode()))\n            # or if you want to insert whole value\n            # cursor.execute(\n            #     \"\"\"INSERT INTO xbeedata (value) VALUES ('%s')\"\"\" % (json.dumps(value)))\n            sql_conn.commit()\n\n    except KeyboardInterrupt:\n        break\n\nsql_conn.close()\nserial_port.close()\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 7659789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d5ba539d07fbc90f8a7d62b6638f5c?s=128&d=identicon&r=PG&f=1", "display_name": "Saul Salcedo", "link": "https://stackoverflow.com/users/7659789/saul-salcedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 506, "favorite_count": 0, "accepted_answer_id": 56372403, "answer_count": 1, "score": 0, "last_activity_date": 1559233226, "creation_date": 1559167550, "question_id": 56369145, "link": "https://stackoverflow.com/questions/56369145/send-data-to-mysql-received-from-serial-port", "title": "Send data to MySQL received from serial port", "body": "<p>I have this code in python, what it does is read a data that comes from the serial port; The data is sent from one XBee and received by another XBee, the second XBee is connected to a computer port, and the data it receives is what I read, then I try to send this data to a mysql database, but I send the following error:</p>\n\n<p>\"MySQLdb._exceptions.ProgrammingError: %b requires a bytes-like object, or an object that implements <strong>bytes</strong>, not 'dict'\"</p>\n\n<p><strong>CODE:</strong></p>\n\n<pre><code>import serial\nfrom xbee import XBee\nimport MySQLdb\n\nserial_port = serial.Serial('COM5', 9600)\nxbee = XBee(serial_port)\n\nwhile True:\n    try:\n        value = xbee.wait_read_frame()\n        sql_conn = MySQLdb.connect('localhost', 'root', 'pass', 'XBee')\n        cursor = sql_conn.cursor()\n        cursor.execute(\"INSERT INTO xbeedata (value) VALUES (%s)\", (value))\n        data = cursor.fetchall()\n        cursor.close()\n        print (xbee.wait_read_frame())\n\n\n    except KeyboardInterrupt:\n        break\n\nserial_port.close()\n</code></pre>\n\n<p>Regards.</p>\n"}, {"tags": ["python", "json", "extended-ascii"], "comments": [{"owner": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "edited": false, "score": 0, "creation_date": 1559167442, "post_id": 56369117, "comment_id": 99340827, "body": "The characters are not printed &quot;wrong&quot;; <code>\\uXXXX</code> escapes are a perfectly valid alternative way to represent characters."}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "reply_to_user": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "edited": false, "score": 0, "creation_date": 1559168695, "post_id": 56369117, "comment_id": 99341139, "body": "But I need they be human readable. I hope make sense."}], "answers": [{"comments": [{"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1559169291, "post_id": 56369206, "comment_id": 99341297, "body": "Thanks so much for your help. Your sample code works for me in python2, and this line <code>json.dumps(json_data, ...ensure_ascii=False).encode(&#39;utf-8&#39;)</code>  works for me in Python3. But when I test in Python3 the <code>print(processed_data)</code> looks like this <code>b&#39;{\\n    &quot;data&quot;: [\\n        &quot;\\xc2\\xbb&quot;,\\n ..</code> not like the pretty print in your example."}], "tags": [], "owner": {"reputation": 46350, "user_id": 246616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deb5db496ae1d5e7dbdcaa38f3c9b31b?s=128&d=identicon&r=PG", "display_name": "mVChr", "link": "https://stackoverflow.com/users/246616/mvchr"}, "is_accepted": true, "score": 1, "last_activity_date": 1559167951, "creation_date": 1559167951, "answer_id": 56369206, "question_id": 56369117, "link": "https://stackoverflow.com/questions/56369117/how-to-print-extended-ascii-characters-correctly-with-json-dumps-python/56369206#56369206", "title": "How to print Extended ASCII characters correctly with json.dumps() - Python", "body": "<p>You're looking for the <a href=\"https://docs.python.org/3/library/json.html#json.JSONEncoder\" rel=\"nofollow noreferrer\"><code>ensure_ascii</code></a> parameter.</p>\n\n<pre><code>import json                   \n\nraw_data = '{\"data\": [\"\u00bb\", \"\u2022\", \"\u00f1\", \"\u00d3\", \"\u00c4\"]}'\njson_data = json.loads(raw_data)\n\nprint(json_data)\n# {u'data': [u'\\xbb', u'\\u2022', u'\\xf1', u'\\xd3', u'\\xc4']}\n\nprocessed_data = json.dumps(json_data, indent=4, ensure_ascii=False, encoding='utf-8')\n\nprint(processed_data)\n# {\n#     \"data\": [\n#         \"\u00bb\", \n#         \"\u2022\", \n#         \"\u00f1\", \n#         \"\u00d3\", \n#         \"\u00c4\"\n#     ]\n# }\n</code></pre>\n\n<p>For Python2 you'd do:</p>\n\n<pre><code>processed_data = json.dumps(json_data, indent=4, ensure_ascii=False).encode('utf-8')\n</code></pre>\n"}], "owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 579, "favorite_count": 0, "accepted_answer_id": 56369206, "answer_count": 1, "score": 0, "last_activity_date": 1559167951, "creation_date": 1559167360, "question_id": 56369117, "link": "https://stackoverflow.com/questions/56369117/how-to-print-extended-ascii-characters-correctly-with-json-dumps-python", "title": "How to print Extended ASCII characters correctly with json.dumps() - Python", "body": "<p>I have this JSON file with some characters that belongs to <code>Extended ASCII characters</code>, for example <code>\u00bb, \u2022, \u00f1, \u00d3, \u00c4</code></p>\n\n<pre><code>{\n    \"@index\": \"1\",\n    \"row\": [\n    {\n        \"col\": [\n        {\n            \"text\": {\n            \"@x\": \"1\",\n            \"#text\": \"Text \u00bb 1 A\\\\C\u00d3\"\n            }\n        }\n        ]\n    },\n    {\n        \"col\": [\n        {\n            \"text\": {\n            \"@x\": \"7\",\n            \"#text\": \"Text \u2022 2 W\u00f1\"\n            }\n        }\n        ]\n    }\n    ]\n}\n</code></pre>\n\n<p>I load it in <code>d</code> variable with <code>json.load()</code> as below</p>\n\n<pre><code>import json \n\nwith open('in.json') as f:\n    d = json.load(f)\n</code></pre>\n\n<p>and <code>d</code> looks like this:</p>\n\n<pre><code>d = {'@index': '1', 'row': [{'col': [{'text': {'@x': '1', '#text': 'Text \u00bb 1 A\\\\C\u00d3'}}]}, {'col': [{'text': {'@x': '7', '#text': 'Text \u2022 2 W\u00f1'}}]}]}\n</code></pre>\n\n<p>Then applying the following code, the json stored in <code>d</code> is converted to one level nested json (Until here, the extended ASCII characters are fine) </p>\n\n<pre><code>&gt;&gt;&gt; z = {**d, 'row':[c['text'] for b in d['row'] for c in b['col']]}\n&gt;&gt;&gt; z\n{'@index': '1', 'row': [{'@x': '1', '#text': 'Text \u00bb 1 A\\\\C\u00d3'}, {'@x': '7', '#text': 'Text \u2022 2 W\u00f1'}]}\n&gt;&gt;&gt;\n</code></pre>\n\n<p>The issue comes when I use <code>json.dumps()</code> because the extended ASCII characters are printed wrong as you can see below.</p>\n\n<p>How to fix this? Thanks for any help.   </p>\n\n<pre><code>&gt;&gt;&gt; print(json.dumps(z, indent=4))\n{\n    \"@index\": \"1\",\n    \"row\": [\n        {\n            \"@x\": \"1\",\n            \"#text\": \"Text \\u00bb 1 A\\\\C\\u00d3\"\n        },\n        {\n            \"@x\": \"7\",\n            \"#text\": \"Text \\u2022 2 W\\u00f1\"\n        }\n    ]\n}\n&gt;&gt;&gt;\n</code></pre>\n"}, {"tags": ["python", "matplotlib", "animation", "contour"], "comments": [{"owner": {"reputation": 3144, "user_id": 10640534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25583304ddb01032ed802cbd87b17d53?s=128&d=identicon&r=PG&f=1", "display_name": "Patol75", "link": "https://stackoverflow.com/users/10640534/patol75"}, "edited": false, "score": 0, "creation_date": 1559178430, "post_id": 56369102, "comment_id": 99343206, "body": "Have a look at this answer <a href=\"https://stackoverflow.com/a/42398244/10640534\">stackoverflow.com/a/42398244/10640534</a>"}, {"owner": {"reputation": 246762, "user_id": 4124317, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/wsHAV.png?s=128&g=1", "display_name": "ImportanceOfBeingErnest", "link": "https://stackoverflow.com/users/4124317/importanceofbeingernest"}, "edited": false, "score": 0, "creation_date": 1559406212, "post_id": 56369102, "comment_id": 99414050, "body": "The key is to <code>return CS.collections</code> as shown in the duplicate."}], "answers": [{"tags": [], "owner": {"reputation": 2226, "user_id": 744520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ee4e3d76ce243beec82b15d9d93e0fb?s=128&d=identicon&r=PG", "display_name": "Jacques Kvam", "link": "https://stackoverflow.com/users/744520/jacques-kvam"}, "is_accepted": false, "score": 0, "last_activity_date": 1559291545, "creation_date": 1559291545, "answer_id": 56391451, "question_id": 56369102, "link": "https://stackoverflow.com/questions/56369102/animating-contour-plot-in-matplotlib-with-funcanimation/56391451#56391451", "title": "Animating Contour Plot in Matplotlib with FuncAnimation", "body": "<p>Another option is to use ArtistAnimation. You can use <a href=\"https://github.com/jwkvam/celluloid\" rel=\"nofollow noreferrer\">celluloid</a> (disclaimer: I wrote it), to easily capture plots and then animate them. It uses ArtistAnimation under the hood. The basic idea is that you capture the figure each time you want an image in your animation. Then when you ask celluloid to create the animation it can handle the rest.</p>\n\n<p>Please keep in mind is that while this method may be fewer lines of code it can take much longer to run depending on the length of your animation. It has to keep all those plots in memory unlike FuncAnimation.</p>\n\n<pre><code>import matplotlib.pyplot as plt\nimport numpy as np\nfrom celluloid import Camera\n\nX, Y = np.meshgrid(np.linspace(0, 10, 100), np.linspace(0, 10, 100))\nfig, ax = plt.subplots()\ncamera = Camera(fig)\nfor i in np.linspace(0, 2 * np.pi, 30, endpoint=False):\n    ax.contourf(np.sin(X + i) + np.sin(Y - i))\n    camera.snap()\nanim = camera.animate()\nanim.save('contours.mp4')\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/IQWDo.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IQWDo.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 187, "user_id": 8093698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeba68cec4674cb86bfa92590a1f31c6?s=128&d=identicon&r=PG&f=1", "display_name": "Pecans", "link": "https://stackoverflow.com/users/8093698/pecans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 726, "favorite_count": 0, "closed_date": 1559406137, "answer_count": 1, "score": 0, "last_activity_date": 1559291545, "creation_date": 1559167237, "question_id": 56369102, "link": "https://stackoverflow.com/questions/56369102/animating-contour-plot-in-matplotlib-with-funcanimation", "closed_reason": "Duplicate", "title": "Animating Contour Plot in Matplotlib with FuncAnimation", "body": "<p>I have a simple animation I'm trying to make with MatPlotLib FuncAnimation and a contour plot. Here's what I'm trying so far:</p>\n\n<pre><code># Create Figure and Axes\nfigure, ax = plot.subplots()\n\n# Draw new contour with new data from u\ndef animate(i):\n    a = u[:, :, int(i)]\n    CS = ax.contourf(x.flatten(), y.flatten(), a, colors=['blue', 'white'], levels=0)\n    return CS,\n\n# create animation using the animate() function\nmyAnimation = FuncAnimation(figure, animate, frames=np.arange(0.0, t, t), interval=10, blit=True)\n\nfigure.show()\n</code></pre>\n\n<p>Where u[:, :, i] contains the new Z data I want to plot in my contour. </p>\n\n<p>This works for the very first frame, but then I immediately get the error: <code>AttributeError: 'QuadContourSet' object has no attribute 'get_zorder'</code> from the line <code>CS = ax.contourf(...)</code> for every iteration after that. I do have a crude animation working which is shown below:</p>\n\n<pre><code>figure, ax = plot.subplots()\nfor i in range(0, t):\n        a = u[:, :, i]\n        CS = ax.contourf(x.flatten(), y.flatten(), a, colors=['blue', 'white'], levels=0)\n        figure.show()\n        sleep(0.01)\n</code></pre>\n\n<p>but this implementation creates a new graph for each step and thus is not efficient which is why I'm looking at FuncAnimation. If anyone knows why my FuncAnimation isn't working or if theres another way to animate all my data on one graph I'd be grateful! I've tried plotting it all on one graph using clf(), pause(), and draw() as well but to no avail!</p>\n"}, {"tags": ["python", "selenium", "conditional-statements", "http-status-code-404"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11564988, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wpcvMVQZdvA/AAAAAAAAAAI/AAAAAAAAABY/e1th0Bs2Z-o/photo.jpg?sz=128", "display_name": "Doug Morrow", "link": "https://stackoverflow.com/users/11564988/doug-morrow"}, "edited": false, "score": 1, "creation_date": 1559648209, "post_id": 56377839, "comment_id": 99479516, "body": "Hey, so I spent about 2 days after reading your reply looking through the &#39;this will help&#39; you sent and it lead down a huge rabbit hole. Long story short I switched from selenium to splinter (splinter is used with selenium) and I was able to locate the &quot;href&quot; of the popup which lead to the 404 error. Thank you for the help!  browser.find_link_by_partial_href(&quot;Invalid filename&quot;) = \ud83d\udc4d"}], "tags": [], "owner": {"reputation": 387, "user_id": 2903402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/066b960f16eae88b686a1babd652bcc9?s=128&d=identicon&r=PG", "display_name": "voy", "link": "https://stackoverflow.com/users/2903402/voy"}, "is_accepted": true, "score": 0, "last_activity_date": 1559217275, "creation_date": 1559217275, "answer_id": 56377839, "question_id": 56369077, "link": "https://stackoverflow.com/questions/56369077/python-using-selenium-to-locate-404-error-for-if-else-condition/56377839#56377839", "title": "Python Using Selenium to Locate 404 Error for If Else Condition", "body": "<p>Webdriver wont catch the http404, this is not implemented in the API and it wont be, check <a href=\"https://github.com/seleniumhq/selenium-google-code-issue-archive/issues/141\" rel=\"nofollow noreferrer\">their issue tracker</a>. You could use just python for that, maybe <a href=\"https://stackoverflow.com/questions/2486145/python-check-if-url-to-jpg-exists\">this will help</a>. </p>\n"}], "owner": {"reputation": 5, "user_id": 11564988, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wpcvMVQZdvA/AAAAAAAAAAI/AAAAAAAAABY/e1th0Bs2Z-o/photo.jpg?sz=128", "display_name": "Doug Morrow", "link": "https://stackoverflow.com/users/11564988/doug-morrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 767, "favorite_count": 0, "accepted_answer_id": 56377839, "answer_count": 1, "score": 0, "last_activity_date": 1559217275, "creation_date": 1559167085, "question_id": 56369077, "link": "https://stackoverflow.com/questions/56369077/python-using-selenium-to-locate-404-error-for-if-else-condition", "title": "Python Using Selenium to Locate 404 Error for If Else Condition", "body": "<p>Condition Statement - Try, Except, Else -</p>\n\n<p>I am using Selenium/Python to automate some tasks for downloading and uploading files.</p>\n\n<p>Is there a way to have Selenium/Python recognize if a page is loaded as a 404? ie my \"Try\" attempt below.</p>\n\n<p>My goal is to have the script close out the tab if it loads as a 404 error and loop until a downloadable file is found. The file is a PDF. </p>\n\n<p>I've attempted using XPath to search for specific text such as:</p>\n\n<p>'Additionally, a 404 Not Found error was encountered while trying to use an ErrorDocument to handle the request.' - but am not certain as to the proper coding needed. I'm new to this so thanks for bearing with me.</p>\n\n<p>Below is the bottom portion of the script and it is in a loop as well - (the 'icon' is the download button which shows on the downloadable page, but not on the 404 page)</p>\n\n<pre><code>    try:\n       Download = driver.find_element_by_id('icon')\n       if Download == driver.find_element_by_id('icon'):\n           raise Exception\n\n    except Exception:\n        pyautogui.time.sleep(2)\n        pyautogui.hotkey('ctrl','s')\n        pyautogui.time.sleep(2)\n        pyautogui.hotkey('enter')\n        pyautogui.time.sleep(2)\n        pyautogui.hotkey('ctrl','w')\n        pyautogui.click(771, 374, duration=0.55)\n        pyautogui.click(867, 276, duration=0.55)\n\n\n    else:\n        pyautogui.time.sleep(2)\n        pyautogui.hotkey('ctrl','w')\n        pyautogui.time.sleep(2)\n        pyautogui.doubleClick(79, 136, duration=0.55)\n        pyautogui.time.sleep(15)\n        pyautogui.click(642, 442, duration=0.55)\n        pyautogui.time.sleep(2)\n        pyautogui.hotkey('ctrl','s')\n        pyautogui.time.sleep(2)\n        pyautogui.hotkey('enter')\n        pyautogui.time.sleep(2)\n        pyautogui.hotkey('ctrl','w')\n        pyautogui.click(771, 374, duration=0.55)\n        pyautogui.click(867, 276, duration=0.55)\n</code></pre>\n\n<p>The code above doesn't close out the 404 webpage if it loads. Rather the script saves the webpage 404 instead of attempting the \"Else\" portion of the script. </p>\n\n<p>Thanks for the help! (If I can give an upvote I will.)</p>\n"}, {"tags": ["python", "jenkins", "jenkins-cli"], "comments": [{"owner": {"reputation": 9070, "user_id": 6817835, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/8GBAa.jpg?s=128&g=1", "display_name": "gold_cy", "link": "https://stackoverflow.com/users/6817835/gold-cy"}, "edited": false, "score": 0, "creation_date": 1559167363, "post_id": 56369075, "comment_id": 99340811, "body": "maybe use this --&gt; <a href=\"https://python-jenkins.readthedocs.io/en/latest/\" rel=\"nofollow noreferrer\">python-jenkins.readthedocs.io/en/latest</a>"}, {"owner": {"reputation": 7522, "user_id": 3957754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/lN343.png?s=128&g=1", "display_name": "JRichardsz", "link": "https://stackoverflow.com/users/3957754/jrichardsz"}, "edited": false, "score": 1, "creation_date": 1559177613, "post_id": 56369075, "comment_id": 99343029, "body": "Why are you using python to launch a remote Jenkins build? You could login manually to Jenkins and build the job."}], "answers": [{"comments": [{"owner": {"reputation": 15273, "user_id": 4258008, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/aJHZ7.jpg?s=128&g=1", "display_name": "mainframer", "link": "https://stackoverflow.com/users/4258008/mainframer"}, "edited": false, "score": 0, "creation_date": 1559200126, "post_id": 56370469, "comment_id": 99348453, "body": "exact answer and the latter link is useful too"}], "tags": [], "owner": {"reputation": 7522, "user_id": 3957754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/lN343.png?s=128&g=1", "display_name": "JRichardsz", "link": "https://stackoverflow.com/users/3957754/jrichardsz"}, "is_accepted": false, "score": 2, "last_activity_date": 1559179199, "creation_date": 1559179199, "answer_id": 56370469, "question_id": 56369075, "link": "https://stackoverflow.com/questions/56369075/how-can-i-know-if-a-jenkins-build-has-started-in-python/56370469#56370469", "title": "How can I know if a jenkins build has started in Python?", "body": "<p>You could use this endpoint:</p>\n\n<p><a href=\"http://my-jenkins.com/job/job_name/lastBuild/api/json\" rel=\"nofollow noreferrer\">http://my-jenkins.com/job/job_name/lastBuild/api/json</a></p>\n\n<p>Check this link to view the python implementation:</p>\n\n<p><a href=\"https://serverfault.com/a/309917/490115\">https://serverfault.com/a/309917/490115</a></p>\n"}], "owner": {"reputation": 312, "user_id": 11552516, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qDBFIt0L0wY/AAAAAAAAAAI/AAAAAAAAAAc/tDQReax2Cm0/photo.jpg?sz=128", "display_name": "MagicaNexus", "link": "https://stackoverflow.com/users/11552516/magicanexus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559179199, "creation_date": 1559167065, "last_edit_date": 1559177496, "question_id": 56369075, "link": "https://stackoverflow.com/questions/56369075/how-can-i-know-if-a-jenkins-build-has-started-in-python", "title": "How can I know if a jenkins build has started in Python?", "body": "<p>I wrote a script in Python where I launch a Jenkins build via cli :</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import subprocess\ncommand = \"curl -s -X POST  http://&lt;user&gt;:&lt;token&gt;@&lt;server&gt;/build\"\nsubprocess.Popen(command)\n</code></pre>\n\n<p>I need to find a way to check the build status like :</p>\n\n<pre><code>If not started : Wait to start\nIf started : on progress\nIf ended : Success / Failure\n</code></pre>\n\n<p>by doing :</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>while True:\n    # Check the status of the build\n    # ... &lt;----- I don't know what to do here\n\n    if STATUS == \"on progress\"\n        break\n</code></pre>\n\n<p>Thanks for your suggestions</p>\n"}, {"tags": ["javascript", "python", "web-scraping", "export"], "answers": [{"tags": [], "owner": {"reputation": 1720, "user_id": 1893487, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1ffa6515ba7091f68f688d10a469b823?s=128&d=identicon&r=PG", "display_name": "vrtx54234", "link": "https://stackoverflow.com/users/1893487/vrtx54234"}, "is_accepted": false, "score": 0, "last_activity_date": 1559167995, "creation_date": 1559167995, "answer_id": 56369217, "question_id": 56369067, "link": "https://stackoverflow.com/questions/56369067/how-do-i-use-python-to-trigger-the-download-of-a-file-from-a-website/56369217#56369217", "title": "How do I use Python to trigger the download of a file from a website?", "body": "<p>I would try to identify the API that does 'export to excel' and use that API. You can identify this from the browser's developer tools.  For example, here's what Google Chrome's <em>Copy as Curl</em> gives:</p>\n\n<pre><code>curl 'https://scgenvoy.sempra.com/Public/ViewExternalLowOFO.submitLowOfoSaveAs' -H 'Connection: keep-alive' -H 'Pragma: no-cache' -H 'Cache-Control: no-cache' -H 'Origin: https://scgenvoy.sempra.com' -H 'Upgrade-Insecure-Requests: 1' -H 'DNT: 1' -H 'Content-Type: application/x-www-form-urlencoded' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3' -H 'Referer: https://scgenvoy.sempra.com/index.html' -H 'Accept-Encoding: gzip, deflate, br' -H 'Accept-Language: en-US,en;q=0.9' -H 'Cookie: FAROFFSession=537EB1587E4A063416D5F2206890A2B6.managed2' --data 'FileName=LowOFO05302019Cycle2&amp;Class=com.sempra.krypton.common.saveas.constants.FancyExcelExportType&amp;pageSize=letter&amp;pageOrientation=portrait&amp;HiddenGasFlowDateField=05%2F30%2F2019&amp;HiddenCycleField=2&amp;gasFlowDate=05%2F30%2F2019&amp;cycle=2' --compressed \n</code></pre>\n\n<p>The API url is \n    <a href=\"https://scgenvoy.sempra.com/Public/ViewExternalLowOFO.submitLowOfoSaveAs\" rel=\"nofollow noreferrer\">https://scgenvoy.sempra.com/Public/ViewExternalLowOFO.submitLowOfoSaveAs</a></p>\n\n<p>and the input parameters are:</p>\n\n<pre><code>FileName: LowOFO05302019Cycle2\nClass: com.sempra.krypton.common.saveas.constants.FancyExcelExportType\npageSize: letter\npageOrientation: portrait\nHiddenGasFlowDateField: 05/30/2019\nHiddenCycleField: 2\ngasFlowDate: 05/30/2019\ncycle: 2\n</code></pre>\n\n<p>and the request method is POST.</p>\n\n<p>You can now use python requests library or beautifulsoup library to make this request, passing appropriate values for the parameter.</p>\n\n<p>Providing you an idea, not solving the whole thing myself.</p>\n"}, {"tags": [], "owner": {"reputation": 3717, "user_id": 4286590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aec806c97431f338e396b9a5611bb9b?s=128&d=identicon&r=PG&f=1", "display_name": "bharatk", "link": "https://stackoverflow.com/users/4286590/bharatk"}, "is_accepted": true, "score": 0, "last_activity_date": 1559196872, "last_edit_date": 1559196872, "creation_date": 1559196135, "answer_id": 56372478, "question_id": 56369067, "link": "https://stackoverflow.com/questions/56369067/how-do-i-use-python-to-trigger-the-download-of-a-file-from-a-website/56372478#56372478", "title": "How do I use Python to trigger the download of a file from a website?", "body": "<p>Your <a href=\"https://scgenvoy.sempra.com/index.html#nav=/Public/ViewExternalLowOFO.getLowOFO%3Frand%3D200\" rel=\"nofollow noreferrer\">website</a> is appending dynamic table data with the export button. So basically you need to use <code>Selenium</code> package to handle dynamic data. download selenium web driver as per your browser.</p>\n\n<p><strong>for chrome browser:</strong></p>\n\n<p><a href=\"http://chromedriver.chromium.org/downloads\" rel=\"nofollow noreferrer\">http://chromedriver.chromium.org/downloads</a></p>\n\n<p><strong>Install web driver for chrome browser:</strong></p>\n\n<pre><code>unzip ~/Downloads/chromedriver_linux64.zip -d ~/Downloads\nchmod +x ~/Downloads/chromedriver\nsudo mv -f ~/Downloads/chromedriver /usr/local/share/chromedriver\nsudo ln -s /usr/local/share/chromedriver /usr/local/bin/chromedriver\nsudo ln -s /usr/local/share/chromedriver /usr/bin/chromedriver\n</code></pre>\n\n<p><strong>selenium tutorial</strong></p>\n\n<p><a href=\"https://selenium-python.readthedocs.io/\" rel=\"nofollow noreferrer\">https://selenium-python.readthedocs.io/</a></p>\n\n<p><strong>Export Excel file:</strong></p>\n\n<pre><code>from selenium import webdriver\nimport time\n\ndriver = webdriver.Chrome('/usr/bin/chromedriver')\ndriver.get('https://scgenvoy.sempra.com/index.html#nav=/Public/ViewExternalLowOFO.getLowOFO%3Frand%3D200')\ntime.sleep(3)\nexcel_button = driver.find_element_by_xpath(\"//div[@id='content']/form/div[2]/div/table/tbody/tr/td[4]/table/tbody/tr/td[2]/a\")\n\nprint(excel_button.click())\n</code></pre>\n\n<p>where <code>\"/usr/bin/chromedriver\"</code> chrome web driver path.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 10787300, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pSFagAolBRw/AAAAAAAAAAI/AAAAAAAAC80/WENYkpLKpsw/photo.jpg?sz=128", "display_name": "Todd Ryan", "link": "https://stackoverflow.com/users/10787300/todd-ryan"}, "is_accepted": false, "score": 0, "last_activity_date": 1559327487, "creation_date": 1559327487, "answer_id": 56400162, "question_id": 56369067, "link": "https://stackoverflow.com/questions/56369067/how-do-i-use-python-to-trigger-the-download-of-a-file-from-a-website/56400162#56400162", "title": "How do I use Python to trigger the download of a file from a website?", "body": "<p>Here is the code I got working: </p>\n\n<pre><code>## Input parameters\nstart_date = '5/28/19'\nend_date = '5/31/19'\n\n#### Loops through date range and pulls data\n## Date Range ##\ndatelist = pd.date_range(start=start_date, end=end_date, \nfreq='D',dtype='datetime64[ns]')\nprint(datelist)\n\nfrom selenium import webdriver\nfrom selenium.webdriver.common.keys import Keys\nimport time\n\n# opens chrome and opens up Gas Envoy\ndriver =webdriver.Chrome('C:/Users/tmrt/Documents/chromedriver_win32/chromedriver.exe')\n</code></pre>\n\n<p><code>driver.get('https://scgenvoy.sempra.com/index.html#nav=/Public/ViewExternalLowOFO.getLowOFO%3Frand%3D200')</code></p>\n\n<pre><code># pause to give time to think load\ntime.sleep(5)\n\n# Loops through the dates\nfor d in datelist:\n     # Finds Date Box and Date Box Go Button\n     date_box = driver.find_element_by_xpath('//*[@id=\"content\"]/form/div[2]/table/tbody/tr/td[1]/table/tbody/tr/td[2]/input')\n     date_clicker = driver.find_element_by_xpath('//*[@id=\"content\"]/form/div[2]/table/tbody/tr/td[2]/table/tbody/tr/td/a')\n\n    # Input date into datebox\n    date_box.clear()\n    date_box.send_keys(d.strftime(\"%m/%d/%Y\"))\n\n    # Click date_box\n    date_clicker.click()\n\n    # Pause to allow to load\n    time.sleep(5)\n\n    # Clicks download\n     csv_button = driver.find_element_by_xpath('//*[@id=\"content\"]/form/div[2]/div/table/tbody/tr/td[4]/table/tbody/tr/td[1]/a')   \n    csv_button.click()\n\ndriver.close()\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10787300, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pSFagAolBRw/AAAAAAAAAAI/AAAAAAAAC80/WENYkpLKpsw/photo.jpg?sz=128", "display_name": "Todd Ryan", "link": "https://stackoverflow.com/users/10787300/todd-ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 56372478, "answer_count": 3, "score": 2, "last_activity_date": 1559327487, "creation_date": 1559167025, "last_edit_date": 1559169151, "question_id": 56369067, "link": "https://stackoverflow.com/questions/56369067/how-do-i-use-python-to-trigger-the-download-of-a-file-from-a-website", "title": "How do I use Python to trigger the download of a file from a website?", "body": "<p>I'm trying to set up a script to pull data from a website on a daily basis and I'm having trouble getting Python to actually read the table - I'm not a professional coder. I've tried two methods:</p>\n\n<p>1) Scrape the table (headers, rows, etc) using Beautiful Soup, and </p>\n\n<p>2) Use the website's export with excel button</p>\n\n<p>Here is the precise website:\n<a href=\"https://scgenvoy.sempra.com/index.html#nav=/Public/ViewExternalLowOFO.getLowOFO%3Frand%3D200\" rel=\"nofollow noreferrer\">https://scgenvoy.sempra.com/index.html#nav=/Public/ViewExternalLowOFO.getLowOFO%3Frand%3D200</a></p>\n\n<p>So far my code is: </p>\n\n<pre class=\"lang-py prettyprint-override\"><code>#Imports\nimport requests\nimport urllib.request\nimport pandas as pd\nfrom lxml import html\nimport lxml.html as lh\nfrom bs4 import BeautifulSoup\n`URL ='https://scgenvoy.sempra.com/index.html#nav=/Public/ViewExternalLowOFO.getLowOFO%3Frand%3D200'`\n\n#Create a handle, page, to handle the contents of the website\nrequests.packages.urllib3.disable_warnings()\npage = requests.get(URL, verify=False)\n</code></pre>\n\n<p>I think the easiest method would be to trigger the \"export\" function with the </p>\n\n<pre><code>xpath //*[@id=\"content\"]/form/div[2]/div/table/tbody/tr/td[4]/table/tbody/tr/td[1]/a\n</code></pre>\n\n<p>All help is greatly appreciated!</p>\n"}, {"tags": ["python", "multithreading", "python-multithreading"], "comments": [{"owner": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "edited": false, "score": 0, "creation_date": 1559167187, "post_id": 56369062, "comment_id": 99340756, "body": "How are your threads supposed to &quot;end&quot;? Do you signal them or do they just complete by themselves after doing one thing?"}, {"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1559167295, "post_id": 56369062, "comment_id": 99340790, "body": "Are you sure the thread is not actually running when the timeout occurs? Maybe the work is actually just taking a long time."}, {"owner": {"reputation": 33, "user_id": 9407559, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nicholas Hernandez", "link": "https://stackoverflow.com/users/9407559/nicholas-hernandez"}, "reply_to_user": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "edited": false, "score": 0, "creation_date": 1559167397, "post_id": 56369062, "comment_id": 99340816, "body": "I forgot to mention, the <code>run()</code> method is overridden and as per docs, when reaching the end of the <code>run()</code> method the thread will stop @Will"}, {"owner": {"reputation": 33, "user_id": 9407559, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nicholas Hernandez", "link": "https://stackoverflow.com/users/9407559/nicholas-hernandez"}, "reply_to_user": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1559167686, "post_id": 56369062, "comment_id": 99340888, "body": "The strange thing is it shouldn&#39;t be. The code isn&#39;t implemented correctly as it is, so only Thread0 does all the work which takes some amount of time. Thread2 &amp; Thread3 don&#39;t do any work, and autoexit, but since the call to <code>Thread2&#47;3.start()</code> is either delayed or missing, it leads me to believe that that may not be the issue @Blorgbeard"}, {"owner": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "edited": false, "score": 0, "creation_date": 1559167785, "post_id": 56369062, "comment_id": 99340917, "body": "In which case Thread0 is taking too long. Also, remember each thread will get scheduled by the os so run() won&#39;t happen synchronously"}, {"owner": {"reputation": 33, "user_id": 9407559, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nicholas Hernandez", "link": "https://stackoverflow.com/users/9407559/nicholas-hernandez"}, "reply_to_user": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "edited": false, "score": 0, "creation_date": 1559168305, "post_id": 56369062, "comment_id": 99341055, "body": "Could you write up an explanation of that to serve as an answer? @Will"}, {"owner": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "edited": false, "score": 0, "creation_date": 1559168602, "post_id": 56369062, "comment_id": 99341121, "body": "<a href=\"https://realpython.com/intro-to-python-threading/\" rel=\"nofollow noreferrer\">Dan</a> does it better than I ever could"}], "owner": {"reputation": 33, "user_id": 9407559, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nicholas Hernandez", "link": "https://stackoverflow.com/users/9407559/nicholas-hernandez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559166995, "creation_date": 1559166995, "question_id": 56369062, "link": "https://stackoverflow.com/questions/56369062/threading-start-does-not-always-begin-the-threads-process", "title": "Threading.start() does not always begin the thread&#39;s process", "body": "<p>I have a program that I need to gather and display data and I'm dealing with vast amounts of data, so I am using threading to speed it up.</p>\n\n<p>Problem is, when debugging sometimes running <code>thread.start()</code> will not immediately call <code>thread.run()</code>, as it should.</p>\n\n<p>Sometimes <code>thread.start()</code> will immediately call <code>thread.run()</code>, other times thread.run() will be called after <code>thread2.run()</code> finishes executing for example.</p>\n\n<p>Sometimes it seems like <code>thread.run()</code> is never called and the program times out when trying to join the threads.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>def do_work(self, values, toSearch):\n    threads = []\n    for i in range(3):\n        query = MyThreadClass(values, toSearch)\n        query.start()\n        threads.append(query)\n\n    for t in threads:\n        t.join()\n        if t.is_alive():\n            print \"Thread is still alive!\"\n#           At this point at least one thread is still alive often, however\n#           not ALL the time\n</code></pre>\n\n<p>I would expect each call to <code>query.start()</code> to run <code>query.run()</code> immediately, except that's not the case. </p>\n\n<p>By the time I get to <code>.join()</code> and there's still a thread alive, my program will timeout.</p>\n\n<p>Debugging shows that each one that calls <code>run()</code> will be stopped, as it should, but ones that never called <code>run()</code> will not be stopped, and hang up on <code>join()</code>.</p>\n\n<p>Why does this happen/how can I fix timeouts on <code>join()</code>?</p>\n"}, {"tags": ["python", "matplotlib"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 11422798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271d9058227d783dc55afba2ed89011d?s=128&d=identicon&r=PG&f=1", "display_name": "Mason", "link": "https://stackoverflow.com/users/11422798/mason"}, "edited": false, "score": 0, "creation_date": 1559167987, "post_id": 56369149, "comment_id": 99340966, "body": "There seems to be an issue:  ticks = np.arange(low, high + 1) * step + best_vmin + offset  TypeError: &#39;list&#39; object is not callable"}, {"owner": {"reputation": 31711, "user_id": 4932316, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OL5Si.png?s=128&g=1", "display_name": "Sheldore", "link": "https://stackoverflow.com/users/4932316/sheldore"}, "reply_to_user": {"reputation": 79, "user_id": 11422798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271d9058227d783dc55afba2ed89011d?s=128&d=identicon&r=PG&f=1", "display_name": "Mason", "link": "https://stackoverflow.com/users/11422798/mason"}, "edited": false, "score": 0, "creation_date": 1559168194, "post_id": 56369149, "comment_id": 99341027, "body": "@Mason : What is this low and high and all these variables? You do realize that if you just provide half information without the details of what is going wrong on your screen, what data you are using, what code you are using etc., there is no way for me or any other person to find out the error. Please read <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>"}, {"owner": {"reputation": 79, "user_id": 11422798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271d9058227d783dc55afba2ed89011d?s=128&d=identicon&r=PG&f=1", "display_name": "Mason", "link": "https://stackoverflow.com/users/11422798/mason"}, "edited": false, "score": 0, "creation_date": 1559168492, "post_id": 56369149, "comment_id": 99341095, "body": "Sorry, I don&#39;t think I understand what you mean? I just tried your code with my file but it returns with the above error. I don&#39;t have a clue what the error implies."}, {"owner": {"reputation": 31711, "user_id": 4932316, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OL5Si.png?s=128&g=1", "display_name": "Sheldore", "link": "https://stackoverflow.com/users/4932316/sheldore"}, "reply_to_user": {"reputation": 79, "user_id": 11422798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271d9058227d783dc55afba2ed89011d?s=128&d=identicon&r=PG&f=1", "display_name": "Mason", "link": "https://stackoverflow.com/users/11422798/mason"}, "edited": false, "score": 0, "creation_date": 1559168572, "post_id": 56369149, "comment_id": 99341114, "body": "@Mason : There is no <code>ticks = np.arange(low, high + 1) * step + best_vmin + offset</code> in my code. Where is this line coming from? Can you include the exact code which gives you this error in your question?"}, {"owner": {"reputation": 79, "user_id": 11422798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271d9058227d783dc55afba2ed89011d?s=128&d=identicon&r=PG&f=1", "display_name": "Mason", "link": "https://stackoverflow.com/users/11422798/mason"}, "edited": false, "score": 0, "creation_date": 1559168841, "post_id": 56369149, "comment_id": 99341185, "body": "This is what shows up in my console:  File &quot;C:\\ProgramData\\Anaconda2\\lib\\site-packages\\matplotlib\\ticke&zwnj;&#8203;r.py&quot;, line 1937, in _raw_ticks     ticks = np.arange(low, high + 1) * step + best_vmin + offset  TypeError: &#39;list&#39; object is not callable  &lt;Figure size 432x288 with 1 Axes&gt;"}, {"owner": {"reputation": 31711, "user_id": 4932316, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OL5Si.png?s=128&g=1", "display_name": "Sheldore", "link": "https://stackoverflow.com/users/4932316/sheldore"}, "reply_to_user": {"reputation": 79, "user_id": 11422798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271d9058227d783dc55afba2ed89011d?s=128&d=identicon&r=PG&f=1", "display_name": "Mason", "link": "https://stackoverflow.com/users/11422798/mason"}, "edited": false, "score": 0, "creation_date": 1559169010, "post_id": 56369149, "comment_id": 99341230, "body": "@Mason: Try restarting your kernel and see if the error still persists. I am unaware of this error"}, {"owner": {"reputation": 79, "user_id": 11422798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271d9058227d783dc55afba2ed89011d?s=128&d=identicon&r=PG&f=1", "display_name": "Mason", "link": "https://stackoverflow.com/users/11422798/mason"}, "edited": false, "score": 0, "creation_date": 1559169724, "post_id": 56369149, "comment_id": 99341402, "body": "Restarting the kernel worked. Thanks! However, it seems like it did not plot my data as the line is linear. I have added an image of the graph in my original post. It didn&#39;t plot my data at all. What could be the reason for this?"}, {"owner": {"reputation": 31711, "user_id": 4932316, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OL5Si.png?s=128&g=1", "display_name": "Sheldore", "link": "https://stackoverflow.com/users/4932316/sheldore"}, "reply_to_user": {"reputation": 79, "user_id": 11422798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271d9058227d783dc55afba2ed89011d?s=128&d=identicon&r=PG&f=1", "display_name": "Mason", "link": "https://stackoverflow.com/users/11422798/mason"}, "edited": false, "score": 0, "creation_date": 1559169774, "post_id": 56369149, "comment_id": 99341413, "body": "@Mason: What is your expected output? How does your data inside the file look like? Can you include some data in your question."}, {"owner": {"reputation": 31711, "user_id": 4932316, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OL5Si.png?s=128&g=1", "display_name": "Sheldore", "link": "https://stackoverflow.com/users/4932316/sheldore"}, "reply_to_user": {"reputation": 79, "user_id": 11422798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271d9058227d783dc55afba2ed89011d?s=128&d=identicon&r=PG&f=1", "display_name": "Mason", "link": "https://stackoverflow.com/users/11422798/mason"}, "edited": false, "score": 0, "creation_date": 1559170363, "post_id": 56369149, "comment_id": 99341570, "body": "@Mason: You see, that&#39;s the problem. Your question says &quot;two rows of x and y&quot; but what you actually have is two columns. I will modify my answer but from next time, make sure you read <a href=\"https://stackoverflow.com/help/how-to-ask\">How do I ask a good question?</a>"}, {"owner": {"reputation": 31711, "user_id": 4932316, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OL5Si.png?s=128&g=1", "display_name": "Sheldore", "link": "https://stackoverflow.com/users/4932316/sheldore"}, "reply_to_user": {"reputation": 79, "user_id": 11422798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271d9058227d783dc55afba2ed89011d?s=128&d=identicon&r=PG&f=1", "display_name": "Mason", "link": "https://stackoverflow.com/users/11422798/mason"}, "edited": false, "score": 0, "creation_date": 1559170466, "post_id": 56369149, "comment_id": 99341596, "body": "@Mason: And if the answer solved your problem, you should read <a href=\"https://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a>"}, {"owner": {"reputation": 79, "user_id": 11422798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271d9058227d783dc55afba2ed89011d?s=128&d=identicon&r=PG&f=1", "display_name": "Mason", "link": "https://stackoverflow.com/users/11422798/mason"}, "edited": false, "score": 0, "creation_date": 1559170538, "post_id": 56369149, "comment_id": 99341615, "body": "I apolgize for that, I should have been clearer. I appreciate your effort. Thanks again."}, {"owner": {"reputation": 79, "user_id": 11422798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271d9058227d783dc55afba2ed89011d?s=128&d=identicon&r=PG&f=1", "display_name": "Mason", "link": "https://stackoverflow.com/users/11422798/mason"}, "edited": false, "score": 0, "creation_date": 1559227069, "post_id": 56369149, "comment_id": 99361029, "body": "I should have asked this last night, but how would I add labels to my data? I now have seven different lines on the same graph. I want to assign a label to each of those lines. I apologize asking you this, but I forgot so last night."}, {"owner": {"reputation": 31711, "user_id": 4932316, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OL5Si.png?s=128&g=1", "display_name": "Sheldore", "link": "https://stackoverflow.com/users/4932316/sheldore"}, "reply_to_user": {"reputation": 79, "user_id": 11422798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271d9058227d783dc55afba2ed89011d?s=128&d=identicon&r=PG&f=1", "display_name": "Mason", "link": "https://stackoverflow.com/users/11422798/mason"}, "edited": false, "score": 0, "creation_date": 1559229442, "post_id": 56369149, "comment_id": 99362315, "body": "@Mason : Edited."}], "tags": [], "owner": {"reputation": 31711, "user_id": 4932316, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OL5Si.png?s=128&g=1", "display_name": "Sheldore", "link": "https://stackoverflow.com/users/4932316/sheldore"}, "is_accepted": true, "score": 1, "last_activity_date": 1559229434, "last_edit_date": 1559229434, "creation_date": 1559167575, "answer_id": 56369149, "question_id": 56369053, "link": "https://stackoverflow.com/questions/56369053/storing-columns-from-a-text-file-in-an-array/56369149#56369149", "title": "Storing columns from a text file in an array", "body": "<p>You can use NumPy's <code>loadtxt</code> to read the data and then use a for loop to plot the x and the y coordinates in batches of 7. Below is a sample answer. Just replace <code>sample.txt</code> by your actual file name (including the directory where the file is located).</p>\n\n<pre><code>import numpy as np\nimport matplotlib.pyplot as plt\n\nx, y = np.loadtxt('sample.txt', unpack=True)\n\nfor i in range(0, 49, 7):\n    plt.plot(x[i:i+7], y[i:i+7])\n\nplt.show()    \n</code></pre>\n\n<p><strong>EDIT</strong> Adding labels</p>\n\n<pre><code>for lab, i in enumerate(range(0, 49, 7)):\n    plt.plot(x[i:i+7], y[i:i+7], label='group %d' %lab)\nplt.legend()\nplt.show()    \n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 11422798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271d9058227d783dc55afba2ed89011d?s=128&d=identicon&r=PG&f=1", "display_name": "Mason", "link": "https://stackoverflow.com/users/11422798/mason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 56369149, "answer_count": 1, "score": 1, "last_activity_date": 1559229434, "creation_date": 1559166954, "last_edit_date": 1559170793, "question_id": 56369053, "link": "https://stackoverflow.com/questions/56369053/storing-columns-from-a-text-file-in-an-array", "title": "Storing columns from a text file in an array", "body": "<p>I am trying to plot a range of data. My data consists of 49 variables and I want to split this into 7. I have my data stored in a text file consisting of two rows of x and y as following:\n<a href=\"https://i.stack.imgur.com/WZTpO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WZTpO.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want to split both rows by 7 and create an x,y plot so that it gives me seven lines on my graph. I tried doing this:</p>\n\n<pre><code>lines = f.readlines()\nlines1 = lines1[0:6]\nlines2 = lines2[7:14]\nlines3 = lines3[15:21]\nlines4 = lines4[21:28]\nlines5 = lines5[28:35]\nlines6 = lines6[35:42]\nlines7 = lines7[43:49]\n</code></pre>\n\n<p>I would then put all of the above data in an array and the same process for the y values as well. Finally, I would plot the variables. But this is inefficient and requires alot of time. There must be an easier way, but I cannot think of it. Could someone help?</p>\n\n<p><a href=\"https://i.stack.imgur.com/ekYDs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ekYDs.png\" alt=\"Wrong plot\"></a></p>\n"}, {"tags": ["python", "python-3.x", "python-2.7", "machine-learning", "computer-vision"], "comments": [{"owner": {"reputation": 6626, "user_id": 4907913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c2769a366bde01ddbf60008819e371c?s=128&d=identicon&r=PG&f=1", "display_name": "thewaywewere", "link": "https://stackoverflow.com/users/4907913/thewaywewere"}, "edited": false, "score": 0, "creation_date": 1559202313, "post_id": 56369030, "comment_id": 99349375, "body": "Edited the question for clarity."}, {"owner": {"reputation": 849, "user_id": 11643124, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dXhYR.jpg?s=128&g=1", "display_name": "Bandoleras", "link": "https://stackoverflow.com/users/11643124/bandoleras"}, "edited": false, "score": 0, "creation_date": 1596008199, "post_id": 56369030, "comment_id": 111667478, "body": "@Joshua can you mark my answer as valid, if it has helped? thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 4021, "user_id": 1279459, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/6d94da0b2f5f78c36e5d66c184c5982e?s=128&d=identicon&r=PG", "display_name": "cerebrou", "link": "https://stackoverflow.com/users/1279459/cerebrou"}, "edited": false, "score": 1, "creation_date": 1572879565, "post_id": 56380168, "comment_id": 103688426, "body": "This may not be the case. I get this problem although I run the model on the same GPU machine that was trained on."}, {"owner": {"reputation": 4551, "user_id": 4212158, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-MeijoBfHUlw/AAAAAAAAAAI/AAAAAAAAIUo/hFq1fS9ga6U/photo.jpg?sz=128", "display_name": "crypdick", "link": "https://stackoverflow.com/users/4212158/crypdick"}, "edited": false, "score": 1, "creation_date": 1587161220, "post_id": 56380168, "comment_id": 108410813, "body": "I&#39;m also seeing this error on a GPU machine, <code>torch.cuda.is_available() --&gt; True</code>"}], "tags": [], "owner": {"reputation": 10159, "user_id": 306739, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mILId.jpg?s=128&g=1", "display_name": "stan0", "link": "https://stackoverflow.com/users/306739/stan0"}, "is_accepted": false, "score": 1, "last_activity_date": 1559226293, "creation_date": 1559226293, "answer_id": 56380168, "question_id": 56369030, "link": "https://stackoverflow.com/questions/56369030/runtimeerror-attempting-to-deserialize-object-on-a-cuda-device/56380168#56380168", "title": "RuntimeError: Attempting to deserialize object on a CUDA device", "body": "<p>As you state the problem hints you are trying to use a cuda-model on non-cuda machine. Pay attention to the details of the error message - <code>please use torch.load with map_location='cpu' to map your storages to the CPU</code>. I've had similar problem when I tried to load (from a checkpoint) pre-trained model on my cpu-only machine. The model was trained on a cuda machine so it couldn't be properly loaded. Once I added the <code>map_location='cpu'</code> argument to the <code>load</code> method everything worked.</p>\n"}, {"tags": [], "owner": {"reputation": 849, "user_id": 11643124, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dXhYR.jpg?s=128&g=1", "display_name": "Bandoleras", "link": "https://stackoverflow.com/users/11643124/bandoleras"}, "is_accepted": false, "score": 23, "last_activity_date": 1568386853, "creation_date": 1568386853, "answer_id": 57926042, "question_id": 56369030, "link": "https://stackoverflow.com/questions/56369030/runtimeerror-attempting-to-deserialize-object-on-a-cuda-device/57926042#57926042", "title": "RuntimeError: Attempting to deserialize object on a CUDA device", "body": "<p>Just giving a smaller answer. To solve this, you could change the parameters of the function named <code>load()</code> in the <code>serialization.py</code> file. This is stored in: <code>./site-package/torch/serialization.py</code></p>\n\n<p>Write:</p>\n\n<pre><code>def load(f, map_location='cpu', pickle_module=pickle, **pickle_load_args):\n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>def load(f, map_location=None, pickle_module=pickle, **pickle_load_args):\n</code></pre>\n\n<p>Hope it helps.</p>\n"}, {"tags": [], "owner": {"reputation": 411, "user_id": 11913986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a2089aaceadbfa305d4080bdbc656a?s=128&d=identicon&r=PG&f=1", "display_name": "Strayhorn", "link": "https://stackoverflow.com/users/11913986/strayhorn"}, "is_accepted": false, "score": 4, "last_activity_date": 1577444286, "creation_date": 1577444286, "answer_id": 59499754, "question_id": 56369030, "link": "https://stackoverflow.com/questions/56369030/runtimeerror-attempting-to-deserialize-object-on-a-cuda-device/59499754#59499754", "title": "RuntimeError: Attempting to deserialize object on a CUDA device", "body": "<p>You can remap the Tensor location at load time using the map_location argument to torch.load.</p>\n\n<p>On the following repository,in file \"test.py\", model = loadmodel() calls the model_loader.py file to load the model with torch.load().</p>\n\n<p>While this will only map storages from GPU0, add the map_location:</p>\n\n<pre><code>torch.load(settings.MODEL_FILE, map_location={'cuda:0': 'cpu'})\n</code></pre>\n\n<p>In the model_loader.py file, add, map_location={'cuda:0': 'cpu'} whereever, torch.load() function is called.</p>\n"}, {"tags": [], "owner": {"reputation": 1174, "user_id": 10327223, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j39UdhjJ8GU/AAAAAAAAAAI/AAAAAAAAAAo/at62ZgsNfSg/photo.jpg?sz=128", "display_name": "Biplob Das", "link": "https://stackoverflow.com/users/10327223/biplob-das"}, "is_accepted": false, "score": 16, "last_activity_date": 1591888131, "creation_date": 1591888131, "answer_id": 62327502, "question_id": 56369030, "link": "https://stackoverflow.com/questions/56369030/runtimeerror-attempting-to-deserialize-object-on-a-cuda-device/62327502#62327502", "title": "RuntimeError: Attempting to deserialize object on a CUDA device", "body": "<p>If you don't have gpu then use <strong>map_location=torch.device('cpu')</strong> with load model.load()    </p>\n\n<pre><code>my_model = net.load_state_dict(torch.load('classifier.pt', map_location=torch.device('cpu')))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 591, "user_id": 8040193, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b66993aab255e3d84e7a3a38d8f8f7df?s=128&d=identicon&r=PG&f=1", "display_name": "Prasad", "link": "https://stackoverflow.com/users/8040193/prasad"}, "is_accepted": false, "score": 1, "last_activity_date": 1594357867, "creation_date": 1594357867, "answer_id": 62827698, "question_id": 56369030, "link": "https://stackoverflow.com/questions/56369030/runtimeerror-attempting-to-deserialize-object-on-a-cuda-device/62827698#62827698", "title": "RuntimeError: Attempting to deserialize object on a CUDA device", "body": "<p>I faced the same problem, Instead of modifying the existing code, which was running good yesterday, First I checked whether my GPU is free or not running</p>\n<p><code>nvidia-smi</code></p>\n<p>I could see that, its under utilized, therefore as traditional solution, I shutdown the laptop and restarted it and it got working.</p>\n<p>(One thing I kept in mind that, earlier it was working and I haven't changed anything in code therefore it should work once I restart it and it got working and I was able to use the GPU)</p>\n"}, {"comments": [{"owner": {"reputation": 1748, "user_id": 863923, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ffba53faa0cbb432da0657c2c63e39fd?s=128&d=identicon&r=PG&f=1", "display_name": "Hamman Samuel", "link": "https://stackoverflow.com/users/863923/hamman-samuel"}, "edited": false, "score": 0, "creation_date": 1614358743, "post_id": 65592570, "comment_id": 117370380, "body": "This worked for me. Was trying to serialize and deserialize a PyTorch model as a pickle, which got the error in the OP&#39;s question, and led me to this answer"}], "tags": [], "owner": {"reputation": 31, "user_id": 8317261, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TMWhY6wnEuc/AAAAAAAAAAI/AAAAAAAAAAo/1nFh_xuWiNQ/photo.jpg?sz=128", "display_name": "Charmve", "link": "https://stackoverflow.com/users/8317261/charmve"}, "is_accepted": false, "score": 3, "last_activity_date": 1609922236, "creation_date": 1609922236, "answer_id": 65592570, "question_id": 56369030, "link": "https://stackoverflow.com/questions/56369030/runtimeerror-attempting-to-deserialize-object-on-a-cuda-device/65592570#65592570", "title": "RuntimeError: Attempting to deserialize object on a CUDA device", "body": "<p>&quot;If you are running on a CPU-only machine, please use torch.load with map_location=torch.device('cpu') to map your storages to the CPU.&quot;</p>\n<pre><code>model = torch.load('model/pytorch_resnet50.pth',map_location ='cpu')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 521, "user_id": 7411958, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCCBJ.png?s=128&g=1", "display_name": "Bendemann", "link": "https://stackoverflow.com/users/7411958/bendemann"}, "is_accepted": false, "score": 0, "last_activity_date": 1618469693, "creation_date": 1618469693, "answer_id": 67103603, "question_id": 56369030, "link": "https://stackoverflow.com/questions/56369030/runtimeerror-attempting-to-deserialize-object-on-a-cuda-device/67103603#67103603", "title": "RuntimeError: Attempting to deserialize object on a CUDA device", "body": "<p>For some reason, this also happens with <a href=\"https://www.portainer.io/\" rel=\"nofollow noreferrer\">portainer</a>, even though your machines have GPUs. A crude solution would be to just restart it. It usually happens if you fiddle with the state of the container after it has been deployed (e.g. you change the restart policies while the container is running), which makes me think it's some portainer issue.</p>\n"}], "owner": {"reputation": 177, "user_id": 11574709, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_R6mV-EvUmU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdcIVK7sbmfZP_jre7a77cg4VNYyw/mo/photo.jpg?sz=128", "display_name": "Joshua ", "link": "https://stackoverflow.com/users/11574709/joshua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25717, "favorite_count": 3, "answer_count": 7, "score": 16, "last_activity_date": 1618469693, "creation_date": 1559166841, "last_edit_date": 1559202313, "question_id": 56369030, "link": "https://stackoverflow.com/questions/56369030/runtimeerror-attempting-to-deserialize-object-on-a-cuda-device", "title": "RuntimeError: Attempting to deserialize object on a CUDA device", "body": "<p>I encounter a <code>RunTimeError</code> while I am trying to run the code in my machine's CPU instead of GPU. The code is originally from this GitHub project - <a href=\"https://github.com/CSAILVision/IBD\" rel=\"noreferrer\">IBD: Interpretable Basis Decomposition for Visual Explanation</a>. This is for a research project. I tried putting the CUDA as <code>false</code> and looked at other solutions on this website. </p>\n\n<pre><code>GPU = False               # running on GPU is highly suggested\nCLEAN = False             # set to \"True\" if you want to clean the temporary large files after generating result\nAPP = \"classification\"    # Do not change! mode choide: \"classification\", \"imagecap\", \"vqa\". Currently \"imagecap\" and \"vqa\" are not supported.\nCATAGORIES = [\"object\", \"part\"]   # Do not change! concept categories that are chosen to detect: \"object\", \"part\", \"scene\", \"material\", \"texture\", \"color\"\n\nCAM_THRESHOLD = 0.5                 # the threshold used for CAM visualization\nFONT_PATH = \"components/font.ttc\"   # font file path\nFONT_SIZE = 26                      # font size\nSEG_RESOLUTION = 7                  # the resolution of cam map\nBASIS_NUM = 7                       # In decomposition, this is to decide how many concepts are used to interpret the weight vector of a class.\n</code></pre>\n\n<p>Here is the error:</p>\n\n<pre><code>Traceback (most recent call last):\n  File \"test.py\", line 22, in &lt;module&gt;\n    model = loadmodel()\n  File \"/home/joshuayun/Desktop/IBD/loader/model_loader.py\", line 48, in loadmodel\n    checkpoint = torch.load(settings.MODEL_FILE)\n  File \"/home/joshuayun/.local/lib/python3.6/site-packages/torch/serialization.py\", line 387, in load\n    return _load(f, map_location, pickle_module, **pickle_load_args)\n  File \"/home/joshuayun/.local/lib/python3.6/site-packages/torch/serialization.py\", line 574, in _load\n    result = unpickler.load()\n  File \"/home/joshuayun/.local/lib/python3.6/site-packages/torch/serialization.py\", line 537, in persistent_load\n    deserialized_objects[root_key] = restore_location(obj, location)\n  File \"/home/joshuayun/.local/lib/python3.6/site-packages/torch/serialization.py\", line 119, in default_restore_location\n    result = fn(storage, location)\n  File \"/home/joshuayun/.local/lib/python3.6/site-packages/torch/serialization.py\", line 95, in _cuda_deserialize\n    device = validate_cuda_device(location)\n  File \"/home/joshuayun/.local/lib/python3.6/site-packages/torch/serialization.py\", line 79, in validate_cuda_device\n    raise RuntimeError('Attempting to deserialize object on a CUDA '\nRuntimeError: Attempting to deserialize object on a CUDA device but \n  torch.cuda.is_available() is False. If you are running on a CPU-only machine, \n  please use torch.load with map_location='cpu' to map your storages to the CPU.\n</code></pre>\n"}, {"tags": ["python", "pandas", "dataframe"], "comments": [{"owner": {"reputation": 450, "user_id": 7692562, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1a943ccab242bc2219020a87c729c3b6?s=128&d=identicon&r=PG&f=1", "display_name": "foobarbaz", "link": "https://stackoverflow.com/users/7692562/foobarbaz"}, "edited": false, "score": 0, "creation_date": 1559166962, "post_id": 56369021, "comment_id": 99340684, "body": "I would try reading the csv file into a list of dictionaries, where each element in the list is a row of the table."}, {"owner": {"reputation": 63, "user_id": 10729497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d5d19196f2dcf622458b4afc5f79d8?s=128&d=identicon&r=PG&f=1", "display_name": "user10729497", "link": "https://stackoverflow.com/users/10729497/user10729497"}, "reply_to_user": {"reputation": 450, "user_id": 7692562, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1a943ccab242bc2219020a87c729c3b6?s=128&d=identicon&r=PG&f=1", "display_name": "foobarbaz", "link": "https://stackoverflow.com/users/7692562/foobarbaz"}, "edited": false, "score": 0, "creation_date": 1559167627, "post_id": 56369021, "comment_id": 99340870, "body": "Even then, how do you emulate Pandas aggregate functions?"}, {"owner": {"reputation": 2424, "user_id": 10286422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec8eee83d47bbcbfaf55bb18f7077890?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Pap", "link": "https://stackoverflow.com/users/10286422/ben-pap"}, "edited": false, "score": 1, "creation_date": 1559168915, "post_id": 56369021, "comment_id": 99341207, "body": "Unless you really have to, I wouldn&#39;t bother. Don&#39;t reinvent the wheel as they would say. If a library for a specific purpose exists use the library."}], "answers": [{"tags": [], "owner": {"reputation": 788, "user_id": 103254, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/50340ae4bf8708f20388bf582dcf5366?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/103254/mike"}, "is_accepted": true, "score": 1, "last_activity_date": 1559220529, "last_edit_date": 1559220529, "creation_date": 1559177641, "answer_id": 56370301, "question_id": 56369021, "link": "https://stackoverflow.com/questions/56369021/parse-this-csv-file-and-create-without-using-pandas/56370301#56370301", "title": "Parse this CSV file and create without using Pandas?", "body": "<p>Well, you can. It just takes a lot of work:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>from collections import defaultdict\nimport pandas as pd\n\ns1 = '''order_id,product_id,add_to_cart_order,reordered\n2,33120,1,1\n2,28985,2,1\n2,9327,3,0\n2,45918,4,1\n3,17668,1,1\n3,46667,2,1\n3,17461,4,1\n3,32665,3,1\n4,46842,1,0'''\ns2 = '''product_id,product_name,aisle_id,department_id\n9327,Garlic Powder,104,13\n17461,Air Chilled Organic Boneless Skinless Chicken Breasts,35,12\n17668,Unsweetened Chocolate Almond Breeze Almond Milk,91,16\n28985,Michigan Organic Kale,83,4\n32665,Organic Ezekiel 49 Bread Cinnamon Raisin,112,3\n33120,Organic Egg Whites,86,16\n45918,Coconut Butter,19,13\n46667,Organic Ginger Root,83,4\n46842,Plain Pre-Sliced Bagels,93,3'''\nresult = '''department_id,number_of_orders,number_of_first_orders,percentage\n3,2,1,0.50\n4,2,0,0.00\n12,1,0,0.00\n13,2,1,0.50\n16,2,0,0.00'''\n\nlines = s1.split('\\n')\n# lines\n# ['order_id,product_id,add_to_cart_order,reordered', '2,33120,1,1', '2,28985,2,1', '2,9327,3,0', '2,45918,4,1',\n#  '3,17668,1,1', '3,46667,2,1', '3,17461,4,1', '3,32665,3,1', '4,46842,1,0']\n\nsplitlines = [x.split(',') for x in lines]\n# splitlines\n# [['order_id', 'product_id', 'add_to_cart_order', 'reordered'], ['2', '33120', '1', '1'], ['2', '28985', '2', '1'],\n#  ['2', '9327', '3', '0'], ['2', '45918', '4', '1'], ['3', '17668', '1', '1'], ['3', '46667', '2', '1'],\n#  ['3', '17461', '4', '1'], ['3', '32665', '3', '1'], ['4', '46842', '1', '0']]\n\norders = {}\nfor j, k in enumerate(splitlines[0]):\n    orders[k] = [int(splitlines[i][j]) for i in range(1, len(splitlines))]\n\n# orders\n# {'order_id': [2, 2, 2, 2, 3, 3, 3, 3, 4], 'product_id': [33120, 28985, 9327, 45918, 17668, 46667, 17461, 32665, 46842],\n#  'add_to_cart_order': [1, 2, 3, 4, 1, 2, 4, 3, 1], 'reordered': [1, 1, 0, 1, 1, 1, 1, 1, 0]}\n\nlines = s2.split('\\n')\n# lines\n# ['product_id,product_name,aisle_id,department_id', '9327,Garlic Powder,104,13',\n#  '17461,Air Chilled Organic Boneless Skinless Chicken Breasts,35,12',\n#  '17668,Unsweetened Chocolate Almond Breeze Almond Milk,91,16', '28985,Michigan Organic Kale,83,4',\n#  '32665,Organic Ezekiel 49 Bread Cinnamon Raisin,112,3', '33120,Organic Egg Whites,86,16', '45918,Coconut Butter,19,13',\n#  '46667,Organic Ginger Root,83,4', '46842,Plain Pre-Sliced Bagels,93,3']\nsplitlines = [x.split(',') for x in lines]\n# splitlines\n# [['product_id', 'product_name', 'aisle_id', 'department_id'], ['9327', 'Garlic Powder', '104', '13'],\n#  ['17461', 'Air Chilled Organic Boneless Skinless Chicken Breasts', '35', '12'],\n#  ['17668', 'Unsweetened Chocolate Almond Breeze Almond Milk', '91', '16'],\n#  ['28985', 'Michigan Organic Kale', '83', '4'], ['32665', 'Organic Ezekiel 49 Bread Cinnamon Raisin', '112', '3'],\n#  ['33120', 'Organic Egg Whites', '86', '16'], ['45918', 'Coconut Butter', '19', '13'],\n#  ['46667', 'Organic Ginger Root', '83', '4'], ['46842', 'Plain Pre-Sliced Bagels', '93', '3']]\nproducts = {}\nfor j, k in enumerate(splitlines[0]):\n    products[k] = [splitlines[i][j] for i in range(1, len(splitlines))]\n\n# products\n# {'product_id': ['9327', '17461', '17668', '28985', '32665', '33120', '45918', '46667', '46842'],\n#  'product_name': ['Garlic Powder', 'Air Chilled Organic Boneless Skinless Chicken Breasts',\n#                   'Unsweetened Chocolate Almond Breeze Almond Milk', 'Michigan Organic Kale',\n#                   'Organic Ezekiel 49 Bread Cinnamon Raisin', 'Organic Egg Whites', 'Coconut Butter',\n#                   'Organic Ginger Root', 'Plain Pre-Sliced Bagels'],\n#  'aisle_id': ['104', '35', '91', '83', '112', '86', '19', '83', '93'],\n#  'department_id': ['13', '12', '16', '4', '3', '16', '13', '4', '3']}\n\ndepartments = list(set(products['department_id']))\n# departments\n# ['13', '16', '12', '3', '4']\n\n\norder_counts = defaultdict(int)\nfor thing in products['department_id']:\n    order_counts[thing] += 1\n\n# order_counts\n# defaultdict( &lt; class 'int'&gt;, {'13': 2, '12': 1, '16': 2, '4': 2, '3': 2})\n\nreport = {}\ndepartments.sort(key=lambda x: int(x))\n# departments\n# ['3', '4', '12', '13', '16']\nreport['department_id'] = departments\nreport['number_of_orders'] = [order_counts[dep] for dep in report['department_id']]\n# report\n# {'department_id': ['3', '4', '12', '13', '16'], 'number_of_orders': [2, 2, 1, 2, 2]}\nfirst_order_count = defaultdict(int)\ndepartment_product = defaultdict(list)\nfor i in range(len(products['product_id'])):\n    if products['department_id'][i] in departments:\n        department_product[products['department_id'][i]].append(products['product_id'][i])\n\n# department_product\n# defaultdict( &lt;class 'list'&gt;, {'13': ['9327', '45918'], '12': ['17461'], '16': ['17668', '33120'], '4': ['28985', '46667'], '3': ['32665', '46842']})\n\norder_first_counts = defaultdict(int)\n\nproduct_department = {}\nfor dep, prodlist in department_product.items():\n    for prod in prodlist:\n        product_department[prod] = dep\n\n# product_department\n# {'9327': '13', '45918': '13', '17461': '12', '17668': '16', '33120': '16', '28985': '4', '46667': '4', '32665': '3',\n#  '46842': '3'}\n\nfirst_order_count = defaultdict(int)\nfor prod, reordered in zip(orders['product_id'], orders['reordered']):\n    if product_department[str(prod)] in departments and int(reordered) == 0:\n        first_order_count[product_department[str(prod)]] += 1\n# first_order_count\n# defaultdict(&lt;class 'int'&gt;, {'13': 1, '3': 1})\n\nreport['number_of_first_orders'] = [first_order_count[dep] for dep in report['department_id']]\nreport['first_order_ratio'] = [q[0] / q[1] for q in zip(report['number_of_first_orders'], report['number_of_orders'])]\n# report\n# {'department_id': ['3', '4', '12', '13', '16'], 'number_of_orders': [2, 2, 1, 2, 2],\n#  'number_of_first_orders': [1, 0, 0, 1, 0], 'first_order_ratio': [0.5, 0.0, 0.0, 0.5, 0.0]}\nreportdf = pd.DataFrame.from_dict(report)\n\n#   department_id  number_of_orders  number_of_first_orders  first_order_ratio\n# 0             3                 2                       1                0.5\n# 1             4                 2                       0                0.0\n# 2            12                 1                       0                0.0\n# 3            13                 2                       1                0.5\n# 4            16                 2                       0                0.0\n</code></pre>\n\n<p>Presented for your amusement. I may come back and put some strategic comments in where I built dictionaries to represent FKeys and so on</p>\n\n<p>Cheers!</p>\n"}], "owner": {"reputation": 63, "user_id": 10729497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d5d19196f2dcf622458b4afc5f79d8?s=128&d=identicon&r=PG&f=1", "display_name": "user10729497", "link": "https://stackoverflow.com/users/10729497/user10729497"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 56370301, "answer_count": 1, "score": -1, "last_activity_date": 1559220529, "creation_date": 1559166764, "question_id": 56369021, "link": "https://stackoverflow.com/questions/56369021/parse-this-csv-file-and-create-without-using-pandas", "title": "Parse this CSV file and create without using Pandas?", "body": "<p>I was able to figure out how to do this with Pandas, but without, I'm totally lost: I'm given two CSV files:</p>\n\n<p>order_products:</p>\n\n<pre><code>order_id,product_id,add_to_cart_order,reordered\n2,33120,1,1\n2,28985,2,1\n2,9327,3,0\n2,45918,4,1\n3,17668,1,1\n3,46667,2,1\n3,17461,4,1\n3,32665,3,1\n4,46842,1,0\n</code></pre>\n\n<p>products:</p>\n\n<pre><code>product_id,product_name,aisle_id,department_id\n9327,Garlic Powder,104,13\n17461,Air Chilled Organic Boneless Skinless Chicken Breasts,35,12\n17668,Unsweetened Chocolate Almond Breeze Almond Milk,91,16\n28985,Michigan Organic Kale,83,4\n32665,Organic Ezekiel 49 Bread Cinnamon Raisin,112,3\n33120,Organic Egg Whites,86,16\n45918,Coconut Butter,19,13\n46667,Organic Ginger Root,83,4\n46842,Plain Pre-Sliced Bagels,93,3\n</code></pre>\n\n<p>I'm to then create a new table that lists for each department, the number of orders created for this department, the number of first orders, and the ratio of (number of first orders / number of orders) for that department</p>\n\n<p>So the resulting table would look like:</p>\n\n<pre><code>department_id,number_of_orders,number_of_first_orders,percentage\n3,2,1,0.50\n4,2,0,0.00\n12,1,0,0.00\n13,2,1,0.50\n16,2,0,0.00\n</code></pre>\n\n<p>My solution involving Pandas:</p>\n\n<pre><code>orders = pd.read_csv(\"../insight_testsuite/tests/test_1/input/order_products.csv\")\nproducts = pd.read_csv(\"../insight_testsuite/tests/test_1/input/products.csv\")\n\norders.drop(['add_to_cart_order'], axis=1, inplace=True)\nproducts.drop(['aisle_id', 'product_name'], axis=1, inplace=True)\n\ndep = pd.merge(orders, products)\n\ndep = (dep.groupby('department_id')['reordered']\n         .agg([('number_of_orders','size'), \n               ('number_of_first_orders', lambda x: x.eq(0).sum())\n               ])\n         .reset_index())\n\ndep['percentage'] = (\"%.2f\" % \n   round((dep['number_of_first_orders'] / dep['number_of_orders']), 2))\n</code></pre>\n\n<p>But with regular Python, AFAIK, you can only go through the CSV file line by line and evaluate from there. So I'm not sure how you can perform that kind of analysis without using Pandas. </p>\n"}, {"tags": ["python", "python-3.x", "web-scraping", "beautifulsoup"], "comments": [{"owner": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "edited": false, "score": 0, "creation_date": 1559167167, "post_id": 56368970, "comment_id": 99340744, "body": "Cannot reproduce; when I run this code under Python 3.7.3, there&#39;s a warning from BeautifulSoup about not specifying <code>features=&#39;lxml&#39;</code>, but there&#39;s no error about encoding."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11541840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c13f8daae4da2a22f46ab68b7fef8d2?s=128&d=identicon&r=PG&f=1", "display_name": "rignpm04", "link": "https://stackoverflow.com/users/11541840/rignpm04"}, "edited": false, "score": 0, "creation_date": 1559174636, "post_id": 56369028, "comment_id": 99342475, "body": "Hello, I&#39;m getting the following error    &quot;The code that caused this warning is on line 14 of the file C:/Users/prigs/PycharmProjects/untitled1/venv/scrapingtest.p&zwnj;&#8203;y. To get rid of this warning, pass the additional argument &#39;features=&quot;lxml&quot;&#39; to the BeautifulSoup constructor.    soup = bs4.BeautifulSoup(page_content)&quot;"}, {"owner": {"reputation": 1311, "user_id": 10766766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SqW5t.jpg?s=128&g=1", "display_name": "Raphael", "link": "https://stackoverflow.com/users/10766766/raphael"}, "reply_to_user": {"reputation": 21, "user_id": 11541840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c13f8daae4da2a22f46ab68b7fef8d2?s=128&d=identicon&r=PG&f=1", "display_name": "rignpm04", "link": "https://stackoverflow.com/users/11541840/rignpm04"}, "edited": false, "score": 0, "creation_date": 1559208023, "post_id": 56369028, "comment_id": 99351824, "body": "you can specify the parser explicit: soup = BeautifulSoup(content, &quot;html.parser&quot;) or if you have lxml installed soup = BeautifulSoup(content, &quot;lxml&quot;)"}], "tags": [], "owner": {"reputation": 1311, "user_id": 10766766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SqW5t.jpg?s=128&g=1", "display_name": "Raphael", "link": "https://stackoverflow.com/users/10766766/raphael"}, "is_accepted": false, "score": 0, "last_activity_date": 1559208049, "last_edit_date": 1559208049, "creation_date": 1559166826, "answer_id": 56369028, "question_id": 56368970, "link": "https://stackoverflow.com/questions/56368970/scraping-code-found-when-viewing-page-source/56369028#56369028", "title": "Scraping code found when viewing page source", "body": "<pre><code>import requests\nimport bs4\nurl = \"https://www.geodatadirect.com/SearchResults/SuffolkSearchResults.aspx?state=NY&amp;id=Suffolk&amp;type=Sales\"\n\npage_content = requests.get(url).content\nsoup = bs4.BeautifulSoup(page_content, 'html.parser')\nprint(soup.prettify())\n</code></pre>\n\n<p>this prints</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n &lt;head&gt;\n  &lt;title&gt;\n   Nationwide Property Data, Reports, Sales Comps\n  &lt;/title&gt;\n  &lt;meta charset=\"utf-8\"/&gt;\n...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1311, "user_id": 10766766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SqW5t.jpg?s=128&g=1", "display_name": "Raphael", "link": "https://stackoverflow.com/users/10766766/raphael"}, "edited": false, "score": 1, "creation_date": 1559208135, "post_id": 56373336, "comment_id": 99351889, "body": "selenium can be very useful if the page is js rendered. Otherwise I think it would be a big overhead just for pulling the html code."}], "tags": [], "owner": {"reputation": 3717, "user_id": 4286590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aec806c97431f338e396b9a5611bb9b?s=128&d=identicon&r=PG&f=1", "display_name": "bharatk", "link": "https://stackoverflow.com/users/4286590/bharatk"}, "is_accepted": false, "score": 0, "last_activity_date": 1559199878, "creation_date": 1559199878, "answer_id": 56373336, "question_id": 56368970, "link": "https://stackoverflow.com/questions/56368970/scraping-code-found-when-viewing-page-source/56373336#56373336", "title": "Scraping code found when viewing page source", "body": "<p>Try <code>selenium library</code> to the download web page. selenium library is also helpful for download dynamic data content. </p>\n\n<p><strong>for chrome browser:</strong></p>\n\n<p><a href=\"http://chromedriver.chromium.org/downloads\" rel=\"nofollow noreferrer\">http://chromedriver.chromium.org/downloads</a></p>\n\n<p><strong>Install web driver for chrome browser:</strong></p>\n\n<pre><code>unzip ~/Downloads/chromedriver_linux64.zip -d ~/Downloads\nchmod +x ~/Downloads/chromedriver\nsudo mv -f ~/Downloads/chromedriver /usr/local/share/chromedriver\nsudo ln -s /usr/local/share/chromedriver /usr/local/bin/chromedriver\nsudo ln -s /usr/local/share/chromedriver /usr/bin/chromedriver\n</code></pre>\n\n<p><strong>selenium tutorial</strong></p>\n\n<p><a href=\"https://selenium-python.readthedocs.io/\" rel=\"nofollow noreferrer\">https://selenium-python.readthedocs.io/</a></p>\n\n<p>Replace your code to this. </p>\n\n<pre><code>from selenium import webdriver\nfrom bs4 import BeautifulSoup\nimport time\n\ndriver = webdriver.Chrome('/usr/bin/chromedriver')\ndriver.get('https://www.geodatadirect.com/SearchResults/SuffolkSearchResults.aspx?state=NY&amp;id=Suffolk&amp;type=Sales')\ntime.sleep(3)\n\nsoup = BeautifulSoup(driver.page_source,'html.parser')\n\nprint(soup.prettify())\n</code></pre>\n\n<p>O/P:</p>\n\n<pre><code>&lt;html&gt;\n &lt;head&gt;\n  &lt;title&gt;\n   Nationwide Property Data, Reports, Sales Comps\n  &lt;/title&gt;\n  &lt;meta charset=\"utf-8\"/&gt;\n  &lt;meta content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" name=\"viewport\"/&gt;\n  &lt;meta content=\"--XLC17oYuQE6UEhT-9_rC13L639t4C53w40_nWSbDM\" name=\"google-site-verification\"/&gt;\n  &lt;meta content=\"GeoData Plus provides nationwide property reports, sales comparables, foreclosures, mortgages. Property data for residential and commercial real estate.\" name=\"description\"/&gt;\n  &lt;meta content=\"GeoData Plus\" property=\"og:title\"/&gt;\n  &lt;meta content=\"https://www.geodataplus.com\" property=\"og:url\"/&gt;\n  &lt;link href=\"https://www.geodataplus.com\" rel=\"canonical\"/&gt;\n  &lt;meta content=\"website\" property=\"og:type\"/&gt;\n  &lt;link href=\"/favicon.ico?v=Kx5JMIU84bo6i-lOxVlIH29IO5Qc9QPT6ENpVMaN-JE\" rel=\"shortcut icon\"/&gt;\n  &lt;link href=\"/css/master.css?v=Liu7xdmA3BH167YXbnG76LfxA58TPHQR1J4L4ZzM5Qk\" rel=\"stylesheet\"/&gt;\n  &lt;link href=\"/fonts/stylesheet.css?v=3NqqVyD10iq4848EK3FrA0HOaygo2MyDfL49n8ftRB0\" rel=\"stylesheet\"/&gt;\n  &lt;link href=\"/css/Jquery-ui-auto.css?v=Nul8_ltyyt4O0iNe5la8BhlJ-Z84SOdeInfup2plryA\" media=\"all\" onload=\"if(media!='all')media='all'\" rel=\"stylesheet\"/&gt;\n  &lt;noscript&gt;\n   &lt;link href=\"/css/Jquery-ui-auto.css?v=Nul8_ltyyt4O0iNe5la8BhlJ-Z84SOdeInfup2plryA\" rel=\"stylesheet\"/&gt;\n  &lt;/noscript&gt;\n  &lt;link href=\"theme/default/style.css\" rel=\"stylesheet\" type=\"text/css\"/&gt;\n &lt;/head&gt;\n &lt;body data-offset=\"200\" data-spy=\"scroll\" data-target=\".navbar\"&gt;\n  &lt;div class=\"\" id=\"mainDiv\"&gt;\n   &lt;div class=\"load-complete\" id=\"site-loader\"&gt;\n      .........\n      ..........\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Where <code>'/usr/bin/chromedriver'</code> chrome driver path.</p>\n"}], "owner": {"reputation": 21, "user_id": 11541840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c13f8daae4da2a22f46ab68b7fef8d2?s=128&d=identicon&r=PG&f=1", "display_name": "rignpm04", "link": "https://stackoverflow.com/users/11541840/rignpm04"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1559208049, "creation_date": 1559166416, "question_id": 56368970, "link": "https://stackoverflow.com/questions/56368970/scraping-code-found-when-viewing-page-source", "title": "Scraping code found when viewing page source", "body": "<p>I'm trying to scrape code from a website that is found when right-clicking and selecting \"view page source.\" My code below scrapes from the output found when you right click then select \"inspect\" I think. I get an error that says \"file was loaded in the wrong encoding: 'UTF-8' I'm data mining based upon the raw page source info and I don't know how to pull that in.</p>\n\n<p>See below</p>\n\n<pre><code>from bs4 import BeautifulSoup\nimport requests\nimport urllib.request\nimport urllib.error\nimport os, os.path, csv\nimport sys\nfrom lxml import html\nimport requests\n\nsys.stdout = open('scrapingoutput', 'a')\nprint(sys.stdout)\n\n\nurl= \"https://www.geodatadirect.com/SearchResults/SuffolkSearchResults.aspx?state=NY&amp;id=Suffolk&amp;type=Sales\"\n\nurllib.request.urlopen(\"https://www.geodatadirect.com/SearchResults/SuffolkSearchResults.aspx?state=NY&amp;id=Suffolk&amp;type=Sales\").read()\n\ncontent = urllib.request.urlopen(url).read()\n\nsoup = BeautifulSoup(content)\n\nprint(soup.prettify())\n</code></pre>\n"}, {"tags": ["python", "django", "django-models"], "comments": [{"owner": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "edited": false, "score": 0, "creation_date": 1559167027, "post_id": 56368968, "comment_id": 99340701, "body": "I think you&#39;re comparing properties so the types are equal. Printing new_value won&#39;t show you this as it will print the representation of the object."}, {"owner": {"reputation": 3487, "user_id": 6843153, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/10207079768572690/picture?type=large", "display_name": "HuLu ViCa", "link": "https://stackoverflow.com/users/6843153/hulu-vica"}, "reply_to_user": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "edited": false, "score": 0, "creation_date": 1559175179, "post_id": 56368968, "comment_id": 99342579, "body": "I found that instances of the same model have different type in the same field (one is datetime and the other string), but I don&#39;t know why it happens"}, {"owner": {"reputation": 36561, "user_id": 2395796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8786484468219bcf403bbdce5eb37c8d?s=128&d=identicon&r=PG", "display_name": "Kevin Christopher Henry", "link": "https://stackoverflow.com/users/2395796/kevin-christopher-henry"}, "edited": false, "score": 0, "creation_date": 1559176745, "post_id": 56368968, "comment_id": 99342874, "body": "Try <code>getattr</code> instead of accessing <code>__dict__</code>."}], "owner": {"reputation": 3487, "user_id": 6843153, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/10207079768572690/picture?type=large", "display_name": "HuLu ViCa", "link": "https://stackoverflow.com/users/6843153/hulu-vica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559166408, "creation_date": 1559166408, "question_id": 56368968, "link": "https://stackoverflow.com/questions/56368968/django-date-fields-never-evaluate-equal-when-compared", "title": "Django date fields never evaluate equal when compared", "body": "<p>I have two instances of a model object, and I want to do something if they differ in one field, that happens to be a <strong>DateField</strong> but, when I evaluate wether they are different, they always are, even when they have the same date.</p>\n\n<p>This is the code that performs the comparison:</p>\n\n<pre><code>for field in fields:\n    if 'name' in field.__dict__:\n        field_name = field.__dict__['name']\n\n        if field_name in instance.__dict__:\n            new_value = instance.__dict__[field_name]\n            old_value = old_instance.__dict__[field_name]\n\n            if new_value != old_value: # This line always avaluates true when fields are DateField\n                print(\"{} - {}\".format(old_value, new_value))\n                if first:\n                    first = None\n                else:\n                    detail = detail + '\\n'\n\n                    detail = detail + field_name + ' = ' + str(old_value) + ' --&gt; ' + str(new_value)\n</code></pre>\n\n<p>I am printing <code>new_value</code> and <code>old_value</code> for debugging, and I find that date fields always evaluate different, even when they have the same date:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0Dkqn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0Dkqn.png\" alt=\"enter image description here\"></a></p>\n\n<p>I don't know if there is an specific way for comparing date values.</p>\n"}, {"tags": ["python", "apache-spark", "kubernetes", "pyspark", "jupyter"], "answers": [{"tags": [], "owner": {"reputation": 136, "user_id": 3266634, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d4f516062c6034fd8ef71e32e06ba665?s=128&d=identicon&r=PG&f=1", "display_name": "theMJof91", "link": "https://stackoverflow.com/users/3266634/themjof91"}, "is_accepted": false, "score": 1, "last_activity_date": 1573089486, "creation_date": 1573089486, "answer_id": 58740627, "question_id": 56368948, "link": "https://stackoverflow.com/questions/56368948/change-root-path-for-spark-web-ui/58740627#58740627", "title": "Change root path for Spark Web UI?", "body": "<p>Yes, you can achieve this. Specifically you can do this by setting the spark.ui.proxyBase property within spark-defaults.conf or at the run-time. </p>\n\n<p>Example:</p>\n\n<p>echo \"spark.ui.proxyBase                 $SPARK_UI_PROXYBASE\" >> /opt/spark/conf/spark-defaults.conf;</p>\n\n<p>Then this should work.</p>\n"}, {"comments": [{"owner": {"reputation": 432, "user_id": 2338451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X4z4a.jpg?s=128&g=1", "display_name": "Kishor V", "link": "https://stackoverflow.com/users/2338451/kishor-v"}, "edited": false, "score": 0, "creation_date": 1603095854, "post_id": 63460174, "comment_id": 113917268, "body": "Can you please suggest how this can be used with spark-on-k8s-operator ?"}, {"owner": {"reputation": 115, "user_id": 2333780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d872b423224113a0661f6ae9bb29ed3?s=128&d=identicon&r=PG", "display_name": "Pascal GILLET", "link": "https://stackoverflow.com/users/2333780/pascal-gillet"}, "edited": false, "score": 0, "creation_date": 1606414465, "post_id": 63460174, "comment_id": 114962908, "body": "Would you have an equivalent configuration with Traefik ingress controller? (as asked in the original question)"}], "tags": [], "owner": {"reputation": 73, "user_id": 7113189, "user_type": "registered", "profile_image": "https://graph.facebook.com/1327926120575501/picture?type=large", "display_name": "Will Wang", "link": "https://stackoverflow.com/users/7113189/will-wang"}, "is_accepted": false, "score": 2, "last_activity_date": 1597709642, "creation_date": 1597709642, "answer_id": 63460174, "question_id": 56368948, "link": "https://stackoverflow.com/questions/56368948/change-root-path-for-spark-web-ui/63460174#63460174", "title": "Change root path for Spark Web UI?", "body": "<p>1: set your spark config</p>\n<pre><code>spark.ui.proxyBase: /foo\n</code></pre>\n<p>2: Set the nginx annotations in Ingress</p>\n<pre><code>annotations:\n  nginx.ingress.kubernetes.io/proxy-redirect-from: http://$host/\n  nginx.ingress.kubernetes.io/proxy-redirect-to: http://$host/foo/\n</code></pre>\n<p>3:Annotation to rewrite target:</p>\n<pre><code>annotations:\n  nginx.ingress.kubernetes.io/rewrite-target: /$2\n\nspec:\n  rules:\n  - host: &lt;host&gt;\n    http:\n      paths:\n      - backend:\n          serviceName: &lt;service&gt;\n          servicePort: &lt;port&gt;\n        path: /foo(/|$)(.*)\n</code></pre>\n"}], "owner": {"reputation": 3891, "user_id": 4585713, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0163e6ba41d9dfd2c9d13c528c87e1f5?s=128&d=identicon&r=PG&f=1", "display_name": "PMende", "link": "https://stackoverflow.com/users/4585713/pmende"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1116, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1597709642, "creation_date": 1559166282, "last_edit_date": 1559195474, "question_id": 56368948, "link": "https://stackoverflow.com/questions/56368948/change-root-path-for-spark-web-ui", "title": "Change root path for Spark Web UI?", "body": "<p>I'm working to setup Jupyter notebook servers on Kubernetes that are able to launch <code>pyspark</code>. Each user is able to have a multiple servers running at once, and would access each by navigating to the appropriate host combined with a path to the server's fully-qualified name. For example: <code>http://&lt;hostname&gt;/&lt;username&gt;/&lt;notebook server name&gt;</code>.</p>\n\n<p>I have a top-level function defined that allows a user create a <code>SparkSession</code> that points to the Kubernetes master URL and sets their pod to be the Spark driver.</p>\n\n<p>This is all well and good, but I would like to enable end users to access the URL for the Spark Web UI so that they can track their jobs. The <a href=\"https://spark.apache.org/docs/latest/running-on-kubernetes.html#accessing-driver-ui\" rel=\"nofollow noreferrer\">Spark on Kubernetes documentation</a> has port forwarding as their recommended scheme for achieving this. It seems to be that for any security-minded organization, allowing any random user to setup port forwarding in this way would be unacceptable.</p>\n\n<p>I would like to use an <code>Ingress</code> Kubernetes definition to allow external access to the driver's Spark Web UI. I've setup something like the following:</p>\n\n<pre><code># Service\napiVersion: v1\nkind: Service\nmetadata:\n  namespace: &lt;notebook namespae&gt;\n  name: &lt;username&gt;-&lt;notebook server name&gt;-svc\nspec:\n  type: ClusterIP\n  sessionAffinity: None\n  selector:\n    app: &lt;username&gt;-&lt;notebook server name&gt;-notebook\n  ports:\n  - name: app-svc-port\n    protocol: TCP\n    port: 8888\n    targetPort: 8888\n  - name: spark-ui-port\n    protocol: TCP\n    port: 4040\n    targetPort: 4040\n\n# Ingress\napiVersion: extensions/v1beta1\nkind: Ingress\nmetadata:\n  namespace: workspace\n  name: &lt;username&gt;-&lt;notebook server name&gt;-ing\n  annotations:\n    kubernetes.io/ingress.class: traefik\nspec:\n  rules:\n  - host: &lt;hostname&gt;\n    http:\n      paths:\n      - path: /&lt;username&gt;/&lt;notebook server name&gt;\n        backend:\n          serviceName: &lt;username&gt;-&lt;notebook server name&gt;-svc\n          servicePort: app-svc-port\n      - path: /&lt;username&gt;/&lt;notebook server name&gt;/spark-ui\n        backend:\n          serviceName: &lt;username&gt;-&lt;notebook server name&gt;-svc\n          servicePort: spark-ui-port\n</code></pre>\n\n<p>However, under this setup, when I navigate to <code>http://&lt;hostname&gt;/&lt;username&gt;/&lt;notebook server name&gt;/spark-ui/</code>, I'm redirected to <code>http://&lt;hostname&gt;/jobs</code>. This is because <code>/jobs</code> is the default entry point to Spark's Web UI. However, I don't have an ingress rule for that path, and can't set such a rule since every user's Web UI would collide with each other in the load balancer (unless I have a  misunderstanding, which is totally possible).</p>\n\n<p>Under the <a href=\"https://spark.apache.org/docs/latest/configuration.html#spark-ui\" rel=\"nofollow noreferrer\">Spark UI configuration</a> settings, there doesn't seem to be a way to set a root path for the Spark session. You can change the port on which it runs, but what I'd like to do make the UI serve at something like: <code>http://&lt;hostname&gt;/&lt;username&gt;/&lt;notebook server name&gt;/spark-ui/&lt;jobs, stages, etc&gt;</code>. Is there really no way of changing what comes after the hostname of the URL and before the last part?</p>\n"}, {"tags": ["python", "cmd", "pycharm", "tar", "geohashing"], "comments": [{"owner": {"reputation": 1215, "user_id": 5875276, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10108283776627117/picture?type=large", "display_name": "DiamondJoe12", "link": "https://stackoverflow.com/users/5875276/diamondjoe12"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1559175629, "post_id": 56368943, "comment_id": 99342675, "body": "This is not a duplicate.  It&#39;s a question regarding where to install a package when using Pycharm with an existing version of Python 2.7 in the ArcGIS environment."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1559175691, "post_id": 56368943, "comment_id": 99342685, "body": "The question shows how to resolve the error that you get when trying to run setup."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1559175817, "post_id": 56368943, "comment_id": 99342705, "body": "Except that it appears you are using a virtual environment. You have to activate the environment in order to use python from the command line. Google &quot;python virtual environment&quot; for more details."}], "owner": {"reputation": 1215, "user_id": 5875276, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10108283776627117/picture?type=large", "display_name": "DiamondJoe12", "link": "https://stackoverflow.com/users/5875276/diamondjoe12"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "closed_date": 1559180346, "answer_count": 0, "score": 0, "last_activity_date": 1559166254, "creation_date": 1559166254, "question_id": 56368943, "link": "https://stackoverflow.com/questions/56368943/adding-external-library-to-pycharm-when-using-python-in-arcgis", "closed_reason": "Duplicate", "title": "Adding external library to Pycharm when using Python in ArcGIS", "body": "<p>I've installed arcGIS, which uses Python 2.7.  It's sitting here:</p>\n\n<pre><code>c:\\python27\\arcgis10.7\n</code></pre>\n\n<p>I am using PyCharm, and trying to install python-geohash which unfortunately, I cannot do because the interpreter is set to 2.7.  To solve this, I've downloaded the tar.gz file and extracted it:  </p>\n\n<pre><code>python-geohash-0.8.5\n</code></pre>\n\n<p>The extracted folder is sitting in my PyCharm projects folder:  </p>\n\n<pre><code>C:\\Users\\me\\PycharmProjects\\GeoHash\\venv\\Lib\\site-packages\n</code></pre>\n\n<p>Though, when I navigate here:</p>\n\n<pre><code>C:\\Users\\me\\PycharmProjects\\GeoHash\\venv\\Lib\\site-packages\\python-geohash-0.8.5\n</code></pre>\n\n<p>And run:</p>\n\n<pre><code>python setup.py install\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>'python' is not recognized as an internal or external command,\noperable program or batch file.\n</code></pre>\n\n<p>What is best practice here?  Where do I drop the python-geohash-0.8.5 extracted folder, and where do I run the python setup.py command so that I can utilize this library in PyCharm?  Thank you.</p>\n"}, {"tags": ["python", "django", "django-rest-framework"], "answers": [{"tags": [], "owner": {"reputation": 1689, "user_id": 2877180, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/182c941bc3d53ce90c1bba28ee6b718c?s=128&d=identicon&r=PG&f=1", "display_name": "Programmingjoe", "link": "https://stackoverflow.com/users/2877180/programmingjoe"}, "is_accepted": false, "score": 0, "last_activity_date": 1560384030, "creation_date": 1560384030, "answer_id": 56571762, "question_id": 56368907, "link": "https://stackoverflow.com/questions/56368907/whats-the-fastest-way-to-filter-a-django-queryset-based-on-a-custom-method/56571762#56571762", "title": "What&#39;s the fastest way to filter a django queryset based on a custom method?", "body": "<p>The solution I ended up going with was to filter the stores  that I needed and to get the organizations rather than to filter the organizations based on store properties.</p>\n\n<p><strong>Filter the stores</strong><br>\nvarious ways to do this</p>\n\n<p><strong>Get all the parents of the stores</strong></p>\n\n<pre><code>all_orgs = []\nfor store in store_queryset:\n  all_orgs.push(store.get_all_parents())\n</code></pre>\n\n<p><strong>Get all the orgs</strong> </p>\n\n<pre><code>queryset = Organizations.objects.filter(organization__in=all_orgs)\n</code></pre>\n\n<p>Then return the orgs</p>\n"}], "owner": {"reputation": 1689, "user_id": 2877180, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/182c941bc3d53ce90c1bba28ee6b718c?s=128&d=identicon&r=PG&f=1", "display_name": "Programmingjoe", "link": "https://stackoverflow.com/users/2877180/programmingjoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 229, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560384030, "creation_date": 1559166085, "last_edit_date": 1559166163, "question_id": 56368907, "link": "https://stackoverflow.com/questions/56368907/whats-the-fastest-way-to-filter-a-django-queryset-based-on-a-custom-method", "title": "What&#39;s the fastest way to filter a django queryset based on a custom method?", "body": "<p>I have a model that's recursive. Let's call it <code>Organization</code>. I have another model that is a child of <code>Organization</code> called <code>Store</code>.</p>\n\n<p>When <code>Store</code>'s are listed in the application it is in a hierarchical format so we actually get the <code>Organization</code>'s and include the recursive hierarchy below them. In the serializer we pass in parameters to filter the <code>Store</code> and we return <code>None</code> if the store does not match the filters.</p>\n\n<p>However, the catch is that the <code>Organization</code> will be still be returned even if it has no <code>Stores</code> which causes the table to have a bunch of empty pages if the <code>Store</code> does not match the filters.</p>\n\n<p>To counter this, in the viewset I want to filter the organizations based on whether or not they will have a store.</p>\n\n<p><code>queryset = [x for x in queryset if x.will_have_store()]</code></p>\n\n<pre><code>def will_have_store(self):\n        willHaveStore = False\n        for organization in self.organizations.all():\n            willHaveStore = organization.will_have_store()\n            if (willHaveStore):\n                return True\n            if (hasattr(organization, 'store') and organization.store.id ):\n                willHaveStore = True\n        return willHaveStore\n</code></pre>\n\n<p>This is really close to working but it's painfully slow because it does a recursive check on every row in the database for every query. Is there anyway to make this faster?</p>\n"}, {"tags": ["python", "pandas", "dataframe"], "comments": [{"owner": {"reputation": 516, "user_id": 2197372, "user_type": "registered", "profile_image": "https://graph.facebook.com/649904191/picture?type=large", "display_name": "Robin Nicole", "link": "https://stackoverflow.com/users/2197372/robin-nicole"}, "edited": false, "score": 0, "creation_date": 1559165885, "post_id": 56368853, "comment_id": 99340374, "body": "you should replace <code>df[Value]&#39; by x[&#39;value&#39;]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 380, "user_id": 10608268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62035fb4025a79d53ade742e46afb1b2?s=128&d=identicon&r=PG&f=1", "display_name": "teoeme139", "link": "https://stackoverflow.com/users/10608268/teoeme139"}, "edited": false, "score": 0, "creation_date": 1559166081, "post_id": 56368877, "comment_id": 99340427, "body": "Does where allow me to use more than one condition?"}, {"owner": {"reputation": 788, "user_id": 103254, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/50340ae4bf8708f20388bf582dcf5366?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/103254/mike"}, "reply_to_user": {"reputation": 380, "user_id": 10608268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62035fb4025a79d53ade742e46afb1b2?s=128&d=identicon&r=PG&f=1", "display_name": "teoeme139", "link": "https://stackoverflow.com/users/10608268/teoeme139"}, "edited": false, "score": 0, "creation_date": 1559166386, "post_id": 56368877, "comment_id": 99340524, "body": "@teoeme139 You can stack conditions with the logical operators: <code>~(df.Name == &#39;John&#39;) | (df.Horse == &#39;Bountiful Leap&#39;)</code>. Be sure to use parentheses to propagate the conversions to Series to propagate."}, {"owner": {"reputation": 287228, "user_id": 1240268, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/RN9Mw.jpg?s=128&g=1", "display_name": "Andy Hayden", "link": "https://stackoverflow.com/users/1240268/andy-hayden"}, "reply_to_user": {"reputation": 380, "user_id": 10608268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62035fb4025a79d53ade742e46afb1b2?s=128&d=identicon&r=PG&f=1", "display_name": "teoeme139", "link": "https://stackoverflow.com/users/10608268/teoeme139"}, "edited": false, "score": 0, "creation_date": 1559166467, "post_id": 56368877, "comment_id": 99340546, "body": "@teoeme139 or use .isin so, <code>df.Name.isin([&quot;John&quot;, &quot;Mike&quot;])</code>"}], "tags": [], "owner": {"reputation": 287228, "user_id": 1240268, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/RN9Mw.jpg?s=128&g=1", "display_name": "Andy Hayden", "link": "https://stackoverflow.com/users/1240268/andy-hayden"}, "is_accepted": false, "score": 1, "last_activity_date": 1559165990, "last_edit_date": 1559165990, "creation_date": 1559165893, "answer_id": 56368877, "question_id": 56368853, "link": "https://stackoverflow.com/questions/56368853/cant-figure-out-the-correct-way-to-implement-if-statement-on-dataframe-with-app/56368877#56368877", "title": "Can&#39;t figure out the correct way to implement if statement on dataframe with apply lambda", "body": "<p>You can use <a href=\"https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.where.html\" rel=\"nofollow noreferrer\">where</a> to do this:</p>\n\n<pre><code>df['New Value'] = (df['Value'] * 2).where(df['Name'] == 'John',  df['Value'])\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 380, "user_id": 10608268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62035fb4025a79d53ade742e46afb1b2?s=128&d=identicon&r=PG&f=1", "display_name": "teoeme139", "link": "https://stackoverflow.com/users/10608268/teoeme139"}, "edited": false, "score": 0, "creation_date": 1559215817, "post_id": 56369015, "comment_id": 99355358, "body": "Both answers work fine. I&#39;ll use the one that best suits to my needs. Thanks"}], "tags": [], "owner": {"reputation": 3227, "user_id": 4572274, "user_type": "registered", "profile_image": "https://graph.facebook.com/420310811459015/picture?type=large", "display_name": "yardstick17", "link": "https://stackoverflow.com/users/4572274/yardstick17"}, "is_accepted": true, "score": 1, "last_activity_date": 1559166710, "creation_date": 1559166710, "answer_id": 56369015, "question_id": 56368853, "link": "https://stackoverflow.com/questions/56368853/cant-figure-out-the-correct-way-to-implement-if-statement-on-dataframe-with-app/56369015#56369015", "title": "Can&#39;t figure out the correct way to implement if statement on dataframe with apply lambda", "body": "<p>You are applying the operation on a dataframe of column only <code>'Name'</code> and when working with row wise operation, set <code>axis=1</code></p>\n\n<p>Try this for your usecase.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>df['New Value'] = df.apply(lambda x: x['Value'] * 2 if x['Name'] == 'John' else x['Value'], axis=1)\n</code></pre>\n\n<p>Solution</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>In [49]: df\nOut[49]:\n    Name  Value\n0   John      5\n1  Kevin      5\n\nIn [50]: df['New Value'] = df.apply(lambda x: x['Value'] * 2 if x['Name'] == 'John' else x['Value'], axis=1)\n\nIn [51]: df\nOut[51]:\n    Name  Value  New Value\n0   John      5         10\n1  Kevin      5          5\n</code></pre>\n"}], "owner": {"reputation": 380, "user_id": 10608268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62035fb4025a79d53ade742e46afb1b2?s=128&d=identicon&r=PG&f=1", "display_name": "teoeme139", "link": "https://stackoverflow.com/users/10608268/teoeme139"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 56369015, "answer_count": 2, "score": 1, "last_activity_date": 1559166710, "creation_date": 1559165755, "last_edit_date": 1559166023, "question_id": 56368853, "link": "https://stackoverflow.com/questions/56368853/cant-figure-out-the-correct-way-to-implement-if-statement-on-dataframe-with-app", "title": "Can&#39;t figure out the correct way to implement if statement on dataframe with apply lambda", "body": "<p>Say I have a simple dataframe (df) with two columns (Name and Value). I want to add a third column (New Value) based on Name.</p>\n\n<p>I have tried:</p>\n\n<pre><code>df['New Value'] = df[['Name ']].apply((lambda x: df['Value'] * 2 if x == 'John' else df['Value']) , axis=0)\n</code></pre>\n\n<p>By doing this I get the following error:</p>\n\n<p>ValueError: ('The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().', 'occurred at index Name')</p>\n\n<p>What I understand is that x is a Series and I cannot compare to a string, is this correct? If not, what does it mean?</p>\n\n<p>In any case, how do I go around this problem?</p>\n"}, {"tags": ["python", "python-3.x", "pandas", "dataframe"], "comments": [{"owner": {"reputation": 1924, "user_id": 5516874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ioXgB.jpg?s=128&g=1", "display_name": "Jessica", "link": "https://stackoverflow.com/users/5516874/jessica"}, "edited": false, "score": 0, "creation_date": 1559166147, "post_id": 56368852, "comment_id": 99340451, "body": "<a href=\"https://www.programiz.com/python-programming/shallow-deep-copy\" rel=\"nofollow noreferrer\">programiz.com/python-programming/shallow-deep-copy</a>"}, {"owner": {"reputation": 239, "user_id": 9538252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/555f00012b2fb6980a5676bd9c86b96a?s=128&d=identicon&r=PG&f=1", "display_name": "ByRequest", "link": "https://stackoverflow.com/users/9538252/byrequest"}, "reply_to_user": {"reputation": 1924, "user_id": 5516874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ioXgB.jpg?s=128&g=1", "display_name": "Jessica", "link": "https://stackoverflow.com/users/5516874/jessica"}, "edited": false, "score": 0, "creation_date": 1559173330, "post_id": 56368852, "comment_id": 99342195, "body": "So even if the operation is made within a variable in a function it&#39;s still just a reference and will alter the original database outside of the function?"}], "owner": {"reputation": 239, "user_id": 9538252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/555f00012b2fb6980a5676bd9c86b96a?s=128&d=identicon&r=PG&f=1", "display_name": "ByRequest", "link": "https://stackoverflow.com/users/9538252/byrequest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "closed_date": 1559166226, "answer_count": 0, "score": 0, "last_activity_date": 1559165752, "creation_date": 1559165752, "question_id": 56368852, "link": "https://stackoverflow.com/questions/56368852/python-and-pandas-appear-to-be-changing-a-dataframe-assigned-to-a-variable-even", "closed_reason": "Duplicate", "title": "Python and Pandas appear to be changing a Dataframe assigned to a variable even though I have not explicitly changed the variable", "body": "<p>I have a Python 3.x script utilizing Pandas running in Jupityr notebook.  The script makes heavy use of Pandas Dataframes.  Today, I encountered some erratic errors as multiple columns were being added to my Dataframe.  Upon testing the issue, I noticed, if I rerun the script in Jupityr, changes were being made to an original Dataframe I returned despite the Dataframe being in a function which returns none and despite multiple variable names being assigned to the Dataframe.</p>\n\n<p>From what I read, the variables might simply act as pointers back to the original Dataframe meaning the original Dataframe is being modified regardless of the variable I am performing the operation on.  It appears the only way around this is to perform a copy of the Dataframe when assigning a new variable.  This is confusing, as I thought the operation would be local to whatever variables I am using in the function, AND this does not appear to be consistently modifying my original Dataframes when I perform operations on them in other functions.  I set up the following test:</p>\n\n<pre><code>#dataframe passed in here, print the dataframe to verify accuracy - columns are ColumnA and ColumnB\nprint(mydataframe)\n#assign a new variable to the existing dataframe\ntest_the_dataframe1=mydataframe\n#assign a BACKUP of the dataframe to print in case the original is modified\nMY_BACKUP_1=mydataframe\n#add a column to the new dataframe variable that subtracts ColumnB from ColumnA\ntest_the_dataframe1['Diff'] = test_the_dataframe1['ColumnA'] - test_the_dataframe1['ColumnB']\n#print the untouched backup of the dataframe\nprint(MY_BACKUP_1)\n</code></pre>\n\n<p>MY_BACKUP_1 is modified by the operations being performed on test_the_dataframe1.  I would expect MY_BACKUP_1 to have my original columns only (ColumnA and ColumnB) and not the additional \"Diff\" column\".  If I run this three times, it adds three columns to any reference of the Dataframe.  Again, since this is not consistent with other modifications I have made (unfortunately, I do not have any specific examples off hand but I believe the difference to be based on whatever method I am using), can someone please explain what operations may alter my Dataframe through ALL Variables vs. what might not (and stay local to the variable)?  I am GUESSING the use case for different variables simply pointing back to one Dataframe might be to contain something like a sort or filter you need to reuse?</p>\n\n<p>Additionally, I am running this in Jupityr - so I am wondering if some of the inconsistencies I am experiencing are due to caching.</p>\n\n<p>The reason why an answer to this is important for my use case is because this script reads from a database, where the server load should be kept down - so as I test it, I need to run the script as few times as possible.</p>\n\n<p>Also, since I am new to Python and programming in general, would this same behavior be encountered on all mutable objects?</p>\n"}, {"tags": ["python", "csv", "matplotlib", "slice", "axes"], "comments": [{"owner": {"reputation": 246762, "user_id": 4124317, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/wsHAV.png?s=128&g=1", "display_name": "ImportanceOfBeingErnest", "link": "https://stackoverflow.com/users/4124317/importanceofbeingernest"}, "edited": false, "score": 0, "creation_date": 1559165894, "post_id": 56368836, "comment_id": 99340376, "body": "Well, first of all, <code>ax.set_xlabel(&#39;KPI&#39;s&#39;)</code>  is not valid python. Maybe you meant to use <code>ax.set_xlabel(&quot;KPI&#39;s&quot;)</code> or <code>ax.set_xlabel(&#39;KPI&#180;s&#39;)</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11339512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783d47d380da168dc7440ca4931dd42a?s=128&d=identicon&r=PG&f=1", "display_name": "GWKing", "link": "https://stackoverflow.com/users/11339512/gwking"}, "edited": false, "score": 0, "creation_date": 1560169625, "post_id": 56386568, "comment_id": 99636376, "body": "Thank you very much for this, I followed your instruction and it works perfectly! I will attempt the Seaborn approach soon, it is something I had found in my research but had to provide a solution using only python code. Thanks again!"}], "tags": [], "owner": {"reputation": 9302, "user_id": 8300135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eaa9ded8087b3af42dd463c95696733?s=128&d=identicon&r=PG&f=1", "display_name": "SpghttCd", "link": "https://stackoverflow.com/users/8300135/spghttcd"}, "is_accepted": true, "score": 0, "last_activity_date": 1559268806, "last_edit_date": 1559268806, "creation_date": 1559256422, "answer_id": 56386568, "question_id": 56368836, "link": "https://stackoverflow.com/questions/56368836/loading-lines-from-csv-files-into-heatmap-axes-in-python/56386568#56386568", "title": "Loading lines from csv files into heatmap axes in Python", "body": "<p><strong><em>Short answer:</em></strong></p>\n\n<p>Use pandas and seaborn:</p>\n\n<pre><code>import pandas as pd\nimport seaborn as sns\ndf = pd.read_csv('CARS.csv', index_col=0)\nsns.heatmap(df)\n</code></pre>\n\n<p><strong><em>Long answer:</em></strong></p>\n\n<p>You <em>can</em> get your code to run by correcting some mistakes...</p>\n\n<pre><code>fileObj = open(\"CARS.csv\").readlines()\nlines = [line.strip().split(\",\") for line in fileObj]\ncars = [line[0] for line in lines[1:]]\nkpis = lines[0][1:]              \nscoring = np.array([line[1:-1] for line in lines[1:]], dtype=float)\n\nfig=plt.figure(figsize=(6,3))   \nax=fig.add_subplot(111)         \nax.set_title('Sportscar KPI Data')\nax.set_xlabel(\"KPI\")\nax.set_ylabel('Sports car')\nax.set_xticks(range(len(kpis)))\nax.set_xticklabels(kpis)\nax.set_yticks(range(len(cars)))\nax.set_yticklabels(cars)\nim = ax.imshow(scoring, interpolation='nearest', aspect='auto')\nplt.show()\n</code></pre>\n\n<p><em>However</em>,<br>\nthere are a lot of things which wouldn't be done like this in python (besides all the indentation errors and the fact, that you try to plot <code>scores</code> although your variable was introduced as <code>scoring</code>):</p>\n\n<p>First of all, if opening a file, you would do this in a first line and then begin to access it:  </p>\n\n<pre><code>fileObj = open(\"CARS.csv\")\nlines = [line.strip().split(\",\") for line in fileObj.readlines()]\n</code></pre>\n\n<p>Then you can closr the file properly after reading it by</p>\n\n<pre><code>fileObj.close()\n</code></pre>\n\n<p>because now <code>fileObj</code> really <em>is</em> a file object, <code>fileObj.readlines()</code> is not, it is a list of strings.</p>\n\n<p>Anyway, it would be even better to use a <code>with</code> block for that file handling task, which does closing automatically for you:</p>\n\n<pre><code>with(open('CARS.csv')) as fileObj:\n    lines = [line.strip().split(\",\") for line in fileObj.readlines()]\n</code></pre>\n\n<p><em>(Note that <strong>here</strong> indentation is needed for everything which should be handled by the with block)</em></p>\n\n<p>But still, even if this is already better, noone would do this step by step this way, reading the file line by line, extract labels by hand and convert a subsection to a numpy array.<br>\nEven if you for whatever reason cannot/do not want to use pandas and seaborn as suggested above, numpy has several well written importers itself like e.g. <code>np.genfromtxt</code>.</p>\n"}], "owner": {"reputation": 25, "user_id": 11339512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783d47d380da168dc7440ca4931dd42a?s=128&d=identicon&r=PG&f=1", "display_name": "GWKing", "link": "https://stackoverflow.com/users/11339512/gwking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 56386568, "answer_count": 1, "score": 0, "last_activity_date": 1559268806, "creation_date": 1559165681, "question_id": 56368836, "link": "https://stackoverflow.com/questions/56368836/loading-lines-from-csv-files-into-heatmap-axes-in-python", "title": "Loading lines from csv files into heatmap axes in Python", "body": "<p>I am new to python and have a piece of coursework to generate a heatmap from data in a csv file. Across the top are performance indicators of cars, and down the side are names of cars. I have also sliced the headings of rows and columns into arrays. I am unsure as to how I can load these values into axes ticks.</p>\n\n<p>I am using the code ax.set_xticks() and the same for y but unsure of what to put into the brackets. The ax.get_xticks() also doesn't work. I have tried multiple varieties of things and all of them throw an error, chiefly the name of the slice; see code below.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>if __name__ == \"__main__\":\n    # Load the data.\n    fileObj = open(\"CARS.csv\").readlines()\n    lines = [line.strip().split(\",\") for line in fileObj]\n    # Reads the data into a list,\n    # then slicing to extract a list of cars, kpis and scoring.\n    cars = [line[0] for line in lines[1:]]      #array storing car names\n    kpis = lines[0][1:]                         #array storing kpis\n    scoring = np.array([line[1:-1] for line in lines[1:]], dtype=float)\n</code></pre>\n\n<pre class=\"lang-py prettyprint-override\"><code>fig=plt.figure(figsize=(6,3))   \n    ax=fig.add_subplot(111)         \n    ax.set_xlim([0,9])\n    ax.set_xticks(kpis[lines[0][1:]])\n    ax.set_yticks(cars)\n    ax.set_title('Sportscar KPI Data')\n    ax.set_xlabel('KPI's')\n    ax.set_ylabel('Sportscars')\n    im = ax.imshow(scores, interpolation='nearest', aspect='auto')\n    plt.show()\n</code></pre>\n\n<p>I am hoping to have the sportscar names from the slice put into the ticks section, and an error brings up the list of names that could not be carried across. The same for kpi's.</p>\n"}, {"tags": ["python", "machine-learning", "scikit-learn"], "answers": [{"tags": [], "owner": {"reputation": 45172, "user_id": 4685471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/327dc718c142e3ea70e5db4b38050a36?s=128&d=identicon&r=PG", "display_name": "desertnaut", "link": "https://stackoverflow.com/users/4685471/desertnaut"}, "is_accepted": true, "score": 3, "last_activity_date": 1559251549, "creation_date": 1559251549, "answer_id": 56385838, "question_id": 56368785, "link": "https://stackoverflow.com/questions/56368785/running-gridsearch-over-voting-classifier/56385838#56385838", "title": "Running GridSearch over voting classifier", "body": "<p>Looking more closely, you'll see that the actual name of the parameter is <code>n_estimators</code> (plural); so, your <code>params</code> should be:</p>\n\n<pre><code>params = [{'gdb__n_estimators':[10,20]}]\n</code></pre>\n\n<p>i.e. it is just a typo.</p>\n"}], "owner": {"reputation": 1604, "user_id": 7158458, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209106524837718/picture?type=large", "display_name": "Emm", "link": "https://stackoverflow.com/users/7158458/emm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "accepted_answer_id": 56385838, "answer_count": 1, "score": 0, "last_activity_date": 1559251549, "creation_date": 1559165364, "question_id": 56368785, "link": "https://stackoverflow.com/questions/56368785/running-gridsearch-over-voting-classifier", "title": "Running GridSearch over voting classifier", "body": "<p>Trying to run gridsearch over a voting ensemble combining a few classifiers. I keep encountering the same error when running my code</p>\n\n<pre><code>ValueError: Invalid parameter n_estimator for estimator GradientBoostingClassifier(criterion='friedman_mse', init=None,\n              learning_rate=0.1, loss='deviance', max_depth=3,\n              max_features=None, max_leaf_nodes=None,\n              min_impurity_decrease=0.0, min_impurity_split=None,\n              min_samples_leaf=1, min_samples_split=2,\n              min_weight_fraction_leaf=0.0, n_estimators=100,\n              n_iter_no_change=None, presort='auto', random_state=1,\n              subsample=1.0, tol=0.0001, validation_fraction=0.1,\n              verbose=0, warm_start=False). Check the list of available parameters with `estimator.get_params().keys()`.\n</code></pre>\n\n<p>Here is the code I have:</p>\n\n<pre><code>dtc = DecisionTreeClassifier(random_state=1)\nrfc = RandomForestClassifier(random_state=1)\nada = AdaBoostClassifier(random_state=1)\ngdb = GradientBoostingClassifier(random_state=1)\neclf = VotingClassifier(estimators=[('dtc',dtc),('rfc',rfc),\n                                          ('ada',ada),('gdb',gdb)],voting='hard')\n#tuning parameters with gridsearch\nparams = [{'gdb__n_estimator':[10,20]}]\ngrid_search = GridSearchCV(eclf,params,cv=5,scoring='accuracy')\ngrid_search.fit(X_train,y_train)\n</code></pre>\n"}, {"tags": ["java", "python", "tensorflow", "deep-learning"], "comments": [{"owner": {"reputation": 5550, "user_id": 7389608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QKeuI.jpg?s=128&g=1", "display_name": "giser_yugang", "link": "https://stackoverflow.com/users/7389608/giser-yugang"}, "edited": false, "score": 0, "creation_date": 1559181062, "post_id": 56368761, "comment_id": 99343708, "body": "I don&#39;t quite understand your question. What&#39;s mean with <code>when the corresponding value is 1</code>? What&#39;s your <code>output[x,y]</code>?"}, {"owner": {"reputation": 467, "user_id": 7418127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c1e192f272ff6cd3c67e389b40f4e8?s=128&d=identicon&r=PG&f=1", "display_name": "user3285099", "link": "https://stackoverflow.com/users/7418127/user3285099"}, "reply_to_user": {"reputation": 5550, "user_id": 7389608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QKeuI.jpg?s=128&g=1", "display_name": "giser_yugang", "link": "https://stackoverflow.com/users/7389608/giser-yugang"}, "edited": false, "score": 0, "creation_date": 1559182092, "post_id": 56368761, "comment_id": 99343890, "body": "is it clearer now? I want a sampling function"}, {"owner": {"reputation": 5550, "user_id": 7389608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QKeuI.jpg?s=128&g=1", "display_name": "giser_yugang", "link": "https://stackoverflow.com/users/7389608/giser-yugang"}, "edited": false, "score": 0, "creation_date": 1559182820, "post_id": 56368761, "comment_id": 99344017, "body": "What if the number of the 3rd dimension equal to 1 is less than 4?"}, {"owner": {"reputation": 4732, "user_id": 1475962, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/290f7d594f9c8fbfdf148c62de9f755c?s=128&d=identicon&r=PG&f=1", "display_name": "raju", "link": "https://stackoverflow.com/users/1475962/raju"}, "reply_to_user": {"reputation": 5550, "user_id": 7389608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QKeuI.jpg?s=128&g=1", "display_name": "giser_yugang", "link": "https://stackoverflow.com/users/7389608/giser-yugang"}, "edited": false, "score": 0, "creation_date": 1559196395, "post_id": 56368761, "comment_id": 99346864, "body": "sample with repitation @giser_yugang"}], "answers": [{"tags": [], "owner": {"reputation": 5550, "user_id": 7389608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QKeuI.jpg?s=128&g=1", "display_name": "giser_yugang", "link": "https://stackoverflow.com/users/7389608/giser-yugang"}, "is_accepted": false, "score": 0, "last_activity_date": 1560134202, "creation_date": 1560134202, "answer_id": 56519891, "question_id": 56368761, "link": "https://stackoverflow.com/questions/56368761/select-random-number-of-points-along-an-axis-in-tensorflow/56519891#56519891", "title": "select random number of points along an axis in tensorflow", "body": "<p>I found out you might be looking for <a href=\"https://www.tensorflow.org/api_docs/python/tf/random/multinomial\" rel=\"nofollow noreferrer\"><code>tf.multinomial</code></a>. You just keep the probability equal when the value is <code>1</code> and the probability is <code>tf.log(0.0)</code> when the value is <code>0</code>.</p>\n\n<pre><code>import tensorflow as tf\n\nsamples = tf.multinomial(tf.log([[1., 1., 0.0]]), 4)\n\nwith tf.Session() as sess:\n    print(sess.run(samples))\n\n#print\n[[0 1 1 1]]\n</code></pre>\n\n<p>And you also need to use <code>tf.map_fn</code> to wrap <code>tf.multinomial</code> since the log-probabilities of <code>tf.multinomial</code> requires 2-D Tensor.</p>\n\n<pre><code>import tensorflow as tf\n\nX, Y, N = 10, 10, 10\nar = tf.random.uniform((X, Y, N), maxval=2, seed=1, name=None, dtype=tf.int32)\n\nsamples = tf.map_fn(lambda x:tf.multinomial(tf.log(x), 4,output_dtype=tf.int32)\n                    ,tf.cast(ar,tf.float32)\n                    ,dtype=tf.int32)\n\nwith tf.Session() as sess:\n    val1,val2 = sess.run([ar,samples])\n    print('ar[0]: \\n',val1[0])\n    print('samples[0]: \\n',val2[0])\n\nar[0]: \n [[1 1 1 0 1 0 0 1 1 0]\n [0 1 1 0 0 1 1 1 1 0]\n [0 1 0 1 1 1 1 1 0 1]\n [0 1 0 0 1 0 0 1 1 0]\n [0 0 0 1 0 0 0 1 1 0]\n [1 1 0 0 1 0 1 1 0 1]\n [0 0 1 1 1 0 0 1 1 1]\n [1 1 1 1 1 1 0 0 1 1]\n [1 1 1 1 1 0 0 1 1 0]\n [0 1 1 1 0 1 1 1 1 0]]\nsamples[0]: \n [[0 1 0 4]\n [6 7 5 2]\n [4 4 4 7]\n [1 8 7 4]\n [8 7 7 3]\n [7 7 6 0]\n [7 4 3 9]\n [1 5 0 3]\n [4 1 1 7]\n [7 7 1 6]]\n</code></pre>\n\n<p><em>Note that <code>tf.multinomial</code> will be removed in new version. Instructions for updating: Use tf.random.categorical instead.</em></p>\n"}], "owner": {"reputation": 467, "user_id": 7418127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c1e192f272ff6cd3c67e389b40f4e8?s=128&d=identicon&r=PG&f=1", "display_name": "user3285099", "link": "https://stackoverflow.com/users/7418127/user3285099"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1560134202, "creation_date": 1559165225, "last_edit_date": 1559203262, "question_id": 56368761, "link": "https://stackoverflow.com/questions/56368761/select-random-number-of-points-along-an-axis-in-tensorflow", "title": "select random number of points along an axis in tensorflow", "body": "<p>I have a 3-dimensional array of the mask of size (X, Y, N) with each value 1 or 0. We want to collect indices in the last dimension when the value is 1. </p>\n\n<pre><code>X, Y, N = 10, 10, 10\n# Each point in ar is 1 or 0\nar = tf.random.uniform((X, Y, N), maxval=2, seed=1, name=None, dtype=tf.int32)\n# We now want to collect 4 point indices along last dimension if the corresponding value is 1\n</code></pre>\n\n<p>I want to sample n(=4) indices along 3rd dimension when the corresponding value is 1. How can I do that in tensorflow? The output of my function should be of shape (X, Y, 4)</p>\n\n<pre><code>if output[x, y] = [n1, n2, n3, n4] then\nar[x,y, n1] = 1\nar[x,y, n2] = 1\nar[x,y, n3] = 1\nar[x,y, n4] = 1\n...\n...\n...\n</code></pre>\n"}, {"tags": ["python", "python-3.x"], "comments": [{"owner": {"reputation": 8218, "user_id": 2615940, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/9a6Qc.jpg?s=128&g=1", "display_name": "skrrgwasme", "link": "https://stackoverflow.com/users/2615940/skrrgwasme"}, "edited": false, "score": 1, "creation_date": 1559165788, "post_id": 56368752, "comment_id": 99340352, "body": "Code improvement questions are on topic for Stack Overflow, but you may get better feedback on <a href=\"https://codereview.stackexchange.com/\">Code Review</a>"}, {"owner": {"reputation": 27, "user_id": 11547692, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OmRDh_B4y64/AAAAAAAAAAI/AAAAAAAAAho/BgABAsZirbc/photo.jpg?sz=128", "display_name": "Elijah", "link": "https://stackoverflow.com/users/11547692/elijah"}, "reply_to_user": {"reputation": 8218, "user_id": 2615940, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/9a6Qc.jpg?s=128&g=1", "display_name": "skrrgwasme", "link": "https://stackoverflow.com/users/2615940/skrrgwasme"}, "edited": false, "score": 0, "creation_date": 1559166319, "post_id": 56368752, "comment_id": 99340503, "body": "@skrrgwasme Thanks, if crossposting is allowed, I&#39;ll ask it there too. If not, I&#39;ll just leave it here."}, {"owner": {"reputation": 8218, "user_id": 2615940, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/9a6Qc.jpg?s=128&g=1", "display_name": "skrrgwasme", "link": "https://stackoverflow.com/users/2615940/skrrgwasme"}, "edited": false, "score": 0, "creation_date": 1559166447, "post_id": 56368752, "comment_id": 99340538, "body": "<a href=\"https://meta.stackexchange.com/questions/64068/is-cross-posting-a-question-on-multiple-stack-exchange-sites-permitted-if-the-qu\">Avoiding crossposting would be appreciated</a>."}, {"owner": {"reputation": 30484, "user_id": 2875563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/umbJB.jpg?s=128&g=1", "display_name": "Reblochon Masque", "link": "https://stackoverflow.com/users/2875563/reblochon-masque"}, "edited": false, "score": 0, "creation_date": 1559166617, "post_id": 56368752, "comment_id": 99340586, "body": "Sets are unordered; you are casting sets to tuples prior to comparing them... Should you sort them before comparing? Maybe your problem can be solved with connected components algorithms like union find? <a href=\"https://en.wikipedia.org/wiki/Disjoint-set_data_structure\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Disjoint-set_data_structure</a>"}, {"owner": {"reputation": 27, "user_id": 11547692, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OmRDh_B4y64/AAAAAAAAAAI/AAAAAAAAAho/BgABAsZirbc/photo.jpg?sz=128", "display_name": "Elijah", "link": "https://stackoverflow.com/users/11547692/elijah"}, "reply_to_user": {"reputation": 30484, "user_id": 2875563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/umbJB.jpg?s=128&g=1", "display_name": "Reblochon Masque", "link": "https://stackoverflow.com/users/2875563/reblochon-masque"}, "edited": false, "score": 0, "creation_date": 1559167162, "post_id": 56368752, "comment_id": 99340741, "body": "@ReblochonMasque I am casting back to sets before calling any methods, so I&#39;m not sure that sorting would do anything - or am I misunderstanding you? I don&#39;t like casting back and forth as I have, but was having hashability issues when trying to do: <code>set_list = [set(x) for x in tup_list]; superset = set(tuplist)</code>"}, {"owner": {"reputation": 30484, "user_id": 2875563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/umbJB.jpg?s=128&g=1", "display_name": "Reblochon Masque", "link": "https://stackoverflow.com/users/2875563/reblochon-masque"}, "edited": false, "score": 1, "creation_date": 1559167692, "post_id": 56368752, "comment_id": 99340891, "body": "<code>new_member = tuple(set(i).union(set(j)))</code> the order of new member is not known. <code>new_member not in superset:</code> compares a potentially randomly ordered tuple to other potentially randomly ordered tuples... The same goes with <code>if i in superset and i != new_member:</code>"}, {"owner": {"reputation": 30484, "user_id": 2875563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/umbJB.jpg?s=128&g=1", "display_name": "Reblochon Masque", "link": "https://stackoverflow.com/users/2875563/reblochon-masque"}, "edited": false, "score": 1, "creation_date": 1559168186, "post_id": 56368752, "comment_id": 99341021, "body": "On my machine, with python 3.7, the following input gives two different outputs: <code>print(overlap([(1,2,3),(1,2,3),(4,6,5),(10,11),]))</code> and <code>print(overlap([(1,3,2),(1,2,3),(4,6,5),(10,11),]))</code> gives respectively: <code>{(10, 11), (4, 6, 5), (1, 2, 3)}</code> and <code>{(10, 11), (1, 3, 2), (4, 6, 5), (1, 2, 3)}</code> where the two outputs should be the same."}, {"owner": {"reputation": 27, "user_id": 11547692, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OmRDh_B4y64/AAAAAAAAAAI/AAAAAAAAAho/BgABAsZirbc/photo.jpg?sz=128", "display_name": "Elijah", "link": "https://stackoverflow.com/users/11547692/elijah"}, "reply_to_user": {"reputation": 30484, "user_id": 2875563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/umbJB.jpg?s=128&g=1", "display_name": "Reblochon Masque", "link": "https://stackoverflow.com/users/2875563/reblochon-masque"}, "edited": false, "score": 0, "creation_date": 1559168779, "post_id": 56368752, "comment_id": 99341165, "body": "@ReblochonMasque Good point on the ordering! I will look into that."}, {"owner": {"reputation": 27, "user_id": 11547692, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OmRDh_B4y64/AAAAAAAAAAI/AAAAAAAAAho/BgABAsZirbc/photo.jpg?sz=128", "display_name": "Elijah", "link": "https://stackoverflow.com/users/11547692/elijah"}, "edited": false, "score": 0, "creation_date": 1559173026, "post_id": 56368752, "comment_id": 99342131, "body": "I&#39;ve added sorting order to the elements being compared: <code>set_list = [tuple(sorted(set(x))) for x in tup_list]</code>. Also note that there was a typo in the originally posted code: <code>superset = set(tup_list)</code> is now <code>superset = set(set_list)</code> as it should be."}], "owner": {"reputation": 27, "user_id": 11547692, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OmRDh_B4y64/AAAAAAAAAAI/AAAAAAAAAho/BgABAsZirbc/photo.jpg?sz=128", "display_name": "Elijah", "link": "https://stackoverflow.com/users/11547692/elijah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "closed_date": 1559166813, "answer_count": 0, "score": 1, "last_activity_date": 1559172838, "creation_date": 1559165166, "last_edit_date": 1559172838, "question_id": 56368752, "link": "https://stackoverflow.com/questions/56368752/how-to-merge-all-intersecting-tuples-in-a-list", "closed_reason": "Duplicate", "title": "How to merge all intersecting tuples in a list?", "body": "<p>I have a list of tuples, and would like to merge together any tuples that intersect. Mathematically speaking, each tuple is a set, but is not typed as such in the higher-level code.</p>\n\n<p>My current solution involves comparing every tuple to every other tuple, and merging until no overlap exists. Is there a more efficient or Pythonic way to accomplish this?</p>\n\n<p>Current solution (works as intended):</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>    def overlap(tup_list): #pass a list of tuples\n        \"\"\"\n        For a list of tuples, merge together any tuples that intersect at at least one element.\n        Returns a reduced set of tuples.\n        \"\"\"\n        set_list = [tuple(sorted(set(x))) for x in tup_list] #first-order cleanup: reduce duplication within elements by making each element a set. Sorted for consistent order of tuple elements. Then converted back to tuple so hashable.\n        superset = set(set_list) #second-order clean up: reduce duplication of tuples by making governing list a set\n        reduced = False #init \"reduced\" bool\n        while reduced == False: #run until fully reduced\n            op = False #init/reset \"operations performed\" bool\n            for i in superset.copy():\n                for j in superset.copy():\n                    if set(i) == set(j): #if same set, skip\n                        continue\n                    elif set(i).isdisjoint(set(j)): #if sets don't overlap, skip\n                        continue\n                    else: #sets do overlap, append union; remove individuals\n                        new_member = tuple(set(i).union(set(j))) #union tuple\n                        if new_member not in superset:\n                            superset.add(new_member)\n                            op = True\n                        if i in superset and i != new_member:\n                            superset.remove(i)\n                            op = True\n                        if j in superset and j != new_member:\n                            superset.remove(j)\n                            op = True\n            if op == False:\n                reduced = True #if no operations performed, consider to be fully reduced\n        return(superset)\n</code></pre>\n\n<p>Examples:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>input: [(1,2,3),(4,5),(6,7,1)]\nreturns: {(4, 5), (1, 2, 3, 6, 7)}\n</code></pre>\n\n<pre class=\"lang-py prettyprint-override\"><code>input: [(1,2,3),(1,2,3),(4,5,6),(3,4),(10,)]\nreturns: {(10,), (1, 2, 3, 4, 5, 6)}\n</code></pre>\n\n<p>(as expected)</p>\n"}, {"tags": ["python", "python-3.x", "argv"], "comments": [{"owner": {"reputation": 41878, "user_id": 257465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/882a999c825707d8bfa799ee20bda1f2?s=128&d=identicon&r=PG", "display_name": "tzaman", "link": "https://stackoverflow.com/users/257465/tzaman"}, "edited": false, "score": 2, "creation_date": 1559165826, "post_id": 56368749, "comment_id": 99340356, "body": "This is much better handled using a library like <a href=\"https://docs.python.org/3/library/argparse.html\" rel=\"nofollow noreferrer\"><code>argparse</code></a> or <a href=\"https://click.palletsprojects.com/en/7.x/\" rel=\"nofollow noreferrer\"><code>Click</code></a>"}, {"owner": {"reputation": 22847, "user_id": 1290438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b689dcfa3833cb016dfbc4cc82bb0eae?s=128&d=identicon&r=PG", "display_name": "zmo", "link": "https://stackoverflow.com/users/1290438/zmo"}, "edited": false, "score": 0, "creation_date": 1559168152, "post_id": 56368749, "comment_id": 99341008, "body": "beware that you&#39;ve got a typo in your example <code>user_input = True</code> is not valid ;)"}, {"owner": {"reputation": 7, "user_id": 11564203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd465451104694823db3c8b63323afd?s=128&d=identicon&r=PG&f=1", "display_name": "virulenceFactor", "link": "https://stackoverflow.com/users/11564203/virulencefactor"}, "reply_to_user": {"reputation": 22847, "user_id": 1290438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b689dcfa3833cb016dfbc4cc82bb0eae?s=128&d=identicon&r=PG", "display_name": "zmo", "link": "https://stackoverflow.com/users/1290438/zmo"}, "edited": false, "score": 0, "creation_date": 1559192723, "post_id": 56368749, "comment_id": 99345876, "body": "@zmo Thank you for pointing that out. I actually wasn&#39;t sure if that passed as an acceptable Boolean expression or not How would you phrase the bool expression, &quot;if has any value&quot; then?"}, {"owner": {"reputation": 22847, "user_id": 1290438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b689dcfa3833cb016dfbc4cc82bb0eae?s=128&d=identicon&r=PG", "display_name": "zmo", "link": "https://stackoverflow.com/users/1290438/zmo"}, "edited": false, "score": 0, "creation_date": 1560007595, "post_id": 56368749, "comment_id": 99602749, "body": "The typo is in the fact that you use an assignment in an if condition expression. it should be <code>if user_input == True</code>. Given the way you set it up, the fact that you did not get an exception at assignment shows that the variable contains a value (the assignment of three variables on the left hand side excepts a list of length 3). A variable in python always contains a value (even if the value is <code>None</code>). Whether the value is valid is another thing, and shall be checked explicitely. <code>user_input == True</code> checks that the variable <code>user_input</code> containing a thruthy boolean, nothing else."}, {"owner": {"reputation": 7, "user_id": 11564203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd465451104694823db3c8b63323afd?s=128&d=identicon&r=PG&f=1", "display_name": "virulenceFactor", "link": "https://stackoverflow.com/users/11564203/virulencefactor"}, "reply_to_user": {"reputation": 22847, "user_id": 1290438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b689dcfa3833cb016dfbc4cc82bb0eae?s=128&d=identicon&r=PG", "display_name": "zmo", "link": "https://stackoverflow.com/users/1290438/zmo"}, "edited": false, "score": 0, "creation_date": 1560267019, "post_id": 56368749, "comment_id": 99675985, "body": "@zmo I can&#39;t believe I overlooked that :P Fixed. But, I didn&#39;t know that about variables. Is perhaps <code>if user_input:</code> more what I should have put to mean what I was trying to say?"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 11564203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd465451104694823db3c8b63323afd?s=128&d=identicon&r=PG&f=1", "display_name": "virulenceFactor", "link": "https://stackoverflow.com/users/11564203/virulencefactor"}, "edited": false, "score": 0, "creation_date": 1559193297, "post_id": 56369116, "comment_id": 99346010, "body": "Thank you for that last line especially, which I was wondering what the shortest form syntax you could use to use to have the conditional. I didn&#39;t know it could be written like this. I&#39;m still very new if you didn&#39;t notice and still am reading my first programing (LP3THW) book. So... I&#39;ll have to apologize for asking for a &quot;comment out translation&quot; (that&#39;s what I call explaining syntax I don&#39;t yet know well in plan English) `  x = args[args.index(&#39;-x&#39;) + 1] if &#39;-x&#39; in args else None<code>, which is the only part I&#39;m not sure about. Is </code>args` a list? Was it before this line?"}, {"owner": {"reputation": 69, "user_id": 11546654, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZBtrNSdvzdo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdwsbjRgOnGQzMKpKcD82TE0LWgPw/mo/photo.jpg?sz=128", "display_name": "Jason Shaffner", "link": "https://stackoverflow.com/users/11546654/jason-shaffner"}, "reply_to_user": {"reputation": 7, "user_id": 11564203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd465451104694823db3c8b63323afd?s=128&d=identicon&r=PG&f=1", "display_name": "virulenceFactor", "link": "https://stackoverflow.com/users/11564203/virulencefactor"}, "edited": false, "score": 0, "creation_date": 1559228546, "post_id": 56369116, "comment_id": 99361817, "body": "Yes, &#39;args&#39; is tied to &#39;sys.argv&#39; which in your code is equivalent to &#39;argv&#39; So, the line that assigns &#39;x&#39; is looking through the list for the index of &#39;-x&#39; in the list, then adding one, assuming the next arg is the variable that should be &#39;x&#39;. Using the &#39;if else&#39; statement &quot;short-circuits&quot; if &#39;-x&#39; is not in args so we don&#39;t hit an exception with args.index, and instead assigns None to &#39;x&#39;. &quot;short-circuiting&quot; comes from python&#39;s lazy evaluation of &quot;if else&quot; statements, in this case &quot;if &#39;-x&#39; in args&quot; is False, then &quot;args[args.index(&#39;-x&#39;) + 1]&quot; won&#39;t be evaluated."}], "tags": [], "owner": {"reputation": 69, "user_id": 11546654, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZBtrNSdvzdo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdwsbjRgOnGQzMKpKcD82TE0LWgPw/mo/photo.jpg?sz=128", "display_name": "Jason Shaffner", "link": "https://stackoverflow.com/users/11546654/jason-shaffner"}, "is_accepted": false, "score": 0, "last_activity_date": 1559167351, "creation_date": 1559167351, "answer_id": 56369116, "question_id": 56368749, "link": "https://stackoverflow.com/questions/56368749/how-can-you-design-a-script-that-is-prepared-to-take-varied-possible-quantity-of/56369116#56369116", "title": "How can you design a script that is prepared to take varied possible quantity of arguments as argv?", "body": "<p>Sure, there's some arg parsing packages out there, but, if you want to do it from scratch, you could try something like:</p>\n\n<pre><code>args = sys.argv\nif args:\n    #Verbose would be a boolean, true if -v in args, false if not\n    verbose = '-v' in args\n    #Same thing here, making a boolean based on existence\n    help = '--help' in args\n    #Here we are assuming the arg after '-x' is some variable we want to store\n    x = args[args.index('-x') + 1] if '-x' in args else None\n</code></pre>\n\n<p>For your conditionals, if 'verbose' is a boolean, you only need to use:</p>\n\n<pre><code>if verbose:\n   do_something\n</code></pre>\n\n<p>Or you could do something like:</p>\n\n<pre><code>print('Hello') if verbose else None\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 11564203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd465451104694823db3c8b63323afd?s=128&d=identicon&r=PG&f=1", "display_name": "virulenceFactor", "link": "https://stackoverflow.com/users/11564203/virulencefactor"}, "edited": false, "score": 0, "creation_date": 1559193479, "post_id": 56369236, "comment_id": 99346052, "body": "Thank you for giving me multiple things to think about. The concept of an <code>env</code> variable is one I haven&#39;t read much on, but I will. The only env variables I know are the BASH ones like $PATH and $HOME. I don&#39;t know why I didn&#39;t assume there would be specific libs for this that I had not yet encountered, but trying to solve problems with code that you know before you move on to better ways seems to be how I have learned what I do know."}, {"owner": {"reputation": 22847, "user_id": 1290438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b689dcfa3833cb016dfbc4cc82bb0eae?s=128&d=identicon&r=PG", "display_name": "zmo", "link": "https://stackoverflow.com/users/1290438/zmo"}, "reply_to_user": {"reputation": 7, "user_id": 11564203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd465451104694823db3c8b63323afd?s=128&d=identicon&r=PG&f=1", "display_name": "virulenceFactor", "link": "https://stackoverflow.com/users/11564203/virulencefactor"}, "edited": false, "score": 0, "creation_date": 1560007228, "post_id": 56369236, "comment_id": 99602658, "body": "naming that variable <code>env</code> is just a conventional way to store all the data that makes up the environment of your algorithm. You could call it however you like (<code>context</code>, <code>params</code>...), but using that convention shows the intent: provide some environmental settings (things provided outside of the code) to set up your code. The shell&#39;s env (you can get through <code>os.environ</code>) expresses the same concept (things provide outside of the code). So <code>env</code> is no magic, it&#39;s just a variable that&#39;s fully under <i>your</i> control! \ud83d\ude09"}, {"owner": {"reputation": 22847, "user_id": 1290438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b689dcfa3833cb016dfbc4cc82bb0eae?s=128&d=identicon&r=PG", "display_name": "zmo", "link": "https://stackoverflow.com/users/1290438/zmo"}, "reply_to_user": {"reputation": 7, "user_id": 11564203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd465451104694823db3c8b63323afd?s=128&d=identicon&r=PG&f=1", "display_name": "virulenceFactor", "link": "https://stackoverflow.com/users/11564203/virulencefactor"}, "edited": false, "score": 0, "creation_date": 1560007723, "post_id": 56369236, "comment_id": 99602785, "body": "Finally, don&#39;t be afraid of using libraries, you will learn a lot by implementing them, and reading their source code (and the thinking that went to build them). And doing so, will help you focus on what you&#39;re trying to achieve and the learning path you&#39;re following doing so."}], "tags": [], "owner": {"reputation": 22847, "user_id": 1290438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b689dcfa3833cb016dfbc4cc82bb0eae?s=128&d=identicon&r=PG", "display_name": "zmo", "link": "https://stackoverflow.com/users/1290438/zmo"}, "is_accepted": true, "score": 0, "last_activity_date": 1559168425, "last_edit_date": 1559168425, "creation_date": 1559168120, "answer_id": 56369236, "question_id": 56368749, "link": "https://stackoverflow.com/questions/56368749/how-can-you-design-a-script-that-is-prepared-to-take-varied-possible-quantity-of/56369236#56369236", "title": "How can you design a script that is prepared to take varied possible quantity of arguments as argv?", "body": "<p>You can iterate over the arguments that way:</p>\n\n<pre><code>def handle_arguments(argv):\n    env = {'user_input': []}\n    for arg in argv:\n        if arg in ['-v', '--verbose']\n            env['verbose'] = True\n        elif arg in ['-h', '--help']\n            display_help()\n            sys.exit(0)\n        else\n            env['user_input'] += [arg]\n\n    if length(env['user_input']) == 0\n        env['user_input'] = input('&gt; ')\n    else\n        env['user_input'].join(' ')\n\n    return env\n</code></pre>\n\n<p>there you've got a function that takes arguments and returns a well formed <code>env</code> variable.</p>\n\n<p>So then you can pass sys.argv to handle_arguments by removing the useless sys.argv[0] (useless in this context)</p>\n\n<pre><code>import sys\n\nif __name__ == \"__main__\":\n    env = handle_arguments(sys.argv[1:])\n    do_stuff(**env)\n</code></pre>\n\n<p>where stuff is either a function with the following prototype:</p>\n\n<pre><code>def do_stuff(user_input='', verbose=False):\n</code></pre>\n\n<p>or you can make it take any argument:</p>\n\n<pre><code>def do_stuff(**kwargs):\n</code></pre>\n\n<p>That being said, it's more or less the basic inner working of an argument parsing library. And to make it right, expectable by CLI users, you'd better use one, like <a href=\"https://click.palletsprojects.com/en/7.x/\" rel=\"nofollow noreferrer\">Click</a>, <a href=\"https://docs.python.org/3/library/argparse.html\" rel=\"nofollow noreferrer\">argparse</a> or my personal favourite <a href=\"https://docopt.org\" rel=\"nofollow noreferrer\">docopt</a>.</p>\n"}], "owner": {"reputation": 7, "user_id": 11564203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd465451104694823db3c8b63323afd?s=128&d=identicon&r=PG&f=1", "display_name": "virulenceFactor", "link": "https://stackoverflow.com/users/11564203/virulencefactor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 56369236, "answer_count": 2, "score": 0, "last_activity_date": 1560266587, "creation_date": 1559165145, "last_edit_date": 1560266587, "question_id": 56368749, "link": "https://stackoverflow.com/questions/56368749/how-can-you-design-a-script-that-is-prepared-to-take-varied-possible-quantity-of", "title": "How can you design a script that is prepared to take varied possible quantity of arguments as argv?", "body": "<p>When you give a function a set of needed arguments or assign argv, the code demands that you give the correct number of args or it goes on to give, \"expected number of things to unpack from a tuple is wrong\", sorts of errors. </p>\n\n<p>But I use scripts everyday that are very dynamic in how specifically the arguments can be given and in which types orders, etc.</p>\n\n<p>I eventually imagine making scripts with a --help switch that list all the possible argv and options you can add, but for now as I am beginning, lets keep it <strong>very</strong>, <em>somewhat</em> simple:</p>\n\n<p>I want the following to not raise error and to not EXPECT arguments to be given but to take them when they are there:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>#!/usr/bin/env python3\n\nfrom sys import argv\n\nscript, verbose_option, user_input = argv\n\nif \"verbose\" in verbose_option:\n    verbose_option = True\nelse:\n    verbose_option = False\n\nx = value\nif verbose_option == True:\n    print(\"var x is set to value...\")\nelse:\n    pass\n\nif user_input == True: # if true, the var contains any value, correct?\n    print(user_input)\nelse:\n    print(\"user_input not given but, ... no problem!\")\n    user_input = input(\"&gt; \") # or maybe it has a default value that can be changed from argv\n\nif verbose_option == True:\n    print(\"Would I really need this conditional on every line I left a verbose explanation on?\")\nelse:\n    pass\n</code></pre>\n\n<p>Somehow it has to know that user_input is not intended as verbose just because verbose isn't there, so... maybe a conditional branch that tests the <code>len()</code> of the tuple of arguments and figures, \"well, that must be this and not that based on that number. OR.... is that overly complex and there is a better way?</p>\n\n<p>This is a less important: how messy a verbose option must make the code if there isn't a better way than I imagined in the example code, but that's a bonus question. I want to not error and have default values for things or means of getting the data if not given as argv despite being able to be taken as argv.</p>\n"}, {"tags": ["python", "scala", "apache-spark", "pyspark"], "answers": [{"comments": [{"owner": {"reputation": 1898, "user_id": 11286588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481401ed4b60fbd46601275743949c5b?s=128&d=identicon&r=PG&f=1", "display_name": "thePurplePython", "link": "https://stackoverflow.com/users/11286588/thepurplepython"}, "edited": false, "score": 0, "creation_date": 1559169274, "post_id": 56369342, "comment_id": 99341291, "body": "thank you for the tips!  will try this tomorrow and let you know what happens ... any documentation you are aware of explaining why spark doesn&#39;t do well w many cols?"}, {"owner": {"reputation": 1549, "user_id": 11394329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WmL18_5TbK8/AAAAAAAAAAI/AAAAAAAAAMI/vYk8yTm4Cjs/photo.jpg?sz=128", "display_name": "Richard Nemeth", "link": "https://stackoverflow.com/users/11394329/richard-nemeth"}, "reply_to_user": {"reputation": 1898, "user_id": 11286588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481401ed4b60fbd46601275743949c5b?s=128&d=identicon&r=PG&f=1", "display_name": "thePurplePython", "link": "https://stackoverflow.com/users/11286588/thepurplepython"}, "edited": false, "score": 0, "creation_date": 1559170003, "post_id": 56369342, "comment_id": 99341479, "body": "Unfortunately no documentation, sorry :( It is just my experience when working with dataframes with 1000 and more columns. However I believe it&#39;s because Spark doesn&#39;t scale well in regards to number of columns, Spark mainly scales on Rows and Spark partitions dataframes on Rows, not on columns. But each Row contains all the columns selected, hence the performance degrades. Also if you have a lot of columns, you might hit the JVM limit as mentioned here <a href=\"https://stackoverflow.com/questions/44557739/maximum-number-of-columns-we-can-have-in-dataframe-spark-scala\" title=\"maximum number of columns we can have in dataframe spark scala\">stackoverflow.com/questions/44557739/&hellip;</a>"}, {"owner": {"reputation": 1549, "user_id": 11394329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WmL18_5TbK8/AAAAAAAAAAI/AAAAAAAAAMI/vYk8yTm4Cjs/photo.jpg?sz=128", "display_name": "Richard Nemeth", "link": "https://stackoverflow.com/users/11394329/richard-nemeth"}, "reply_to_user": {"reputation": 1898, "user_id": 11286588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481401ed4b60fbd46601275743949c5b?s=128&d=identicon&r=PG&f=1", "display_name": "thePurplePython", "link": "https://stackoverflow.com/users/11286588/thepurplepython"}, "edited": false, "score": 1, "creation_date": 1559170449, "post_id": 56369342, "comment_id": 99341590, "body": "You are right, alias is missing. I&#39;ve just updated the code, is it still returning that nonsense?"}, {"owner": {"reputation": 1898, "user_id": 11286588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481401ed4b60fbd46601275743949c5b?s=128&d=identicon&r=PG&f=1", "display_name": "thePurplePython", "link": "https://stackoverflow.com/users/11286588/thepurplepython"}, "edited": false, "score": 0, "creation_date": 1559170847, "post_id": 56369342, "comment_id": 99341687, "body": "Thanks!  I see alias working well now ... will test this on the big dataset tomorrow.  What is the purpose of <code>missing_cols</code>?  Ideally I don&#39;t want to impute on my partitioned cols so for output I changed to this <code>df2 = forwardFillImputer(df, cols=[i for i in df.columns[1:]])</code>"}, {"owner": {"reputation": 1898, "user_id": 11286588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481401ed4b60fbd46601275743949c5b?s=128&d=identicon&r=PG&f=1", "display_name": "thePurplePython", "link": "https://stackoverflow.com/users/11286588/thepurplepython"}, "edited": false, "score": 0, "creation_date": 1559170952, "post_id": 56369342, "comment_id": 99341713, "body": "added possible solution to question"}, {"owner": {"reputation": 1549, "user_id": 11394329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WmL18_5TbK8/AAAAAAAAAAI/AAAAAAAAAMI/vYk8yTm4Cjs/photo.jpg?sz=128", "display_name": "Richard Nemeth", "link": "https://stackoverflow.com/users/11394329/richard-nemeth"}, "reply_to_user": {"reputation": 1898, "user_id": 11286588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481401ed4b60fbd46601275743949c5b?s=128&d=identicon&r=PG&f=1", "display_name": "thePurplePython", "link": "https://stackoverflow.com/users/11286588/thepurplepython"}, "edited": false, "score": 0, "creation_date": 1559171350, "post_id": 56369342, "comment_id": 99341786, "body": "Well missing_cols are all the columns which were not imputed, i.e. columns present in the dataframe but not present in the <code>cols</code> list. Because we switched withColumn to select, we need to select all columns, so that we won&#39;t drop columns we want to keep."}, {"owner": {"reputation": 1898, "user_id": 11286588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481401ed4b60fbd46601275743949c5b?s=128&d=identicon&r=PG&f=1", "display_name": "thePurplePython", "link": "https://stackoverflow.com/users/11286588/thepurplepython"}, "edited": false, "score": 0, "creation_date": 1559223155, "post_id": 56369342, "comment_id": 99358865, "body": "makes sense ... unfortunately getting the same error on the 300+ cols dataset"}, {"owner": {"reputation": 1549, "user_id": 11394329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WmL18_5TbK8/AAAAAAAAAAI/AAAAAAAAAMI/vYk8yTm4Cjs/photo.jpg?sz=128", "display_name": "Richard Nemeth", "link": "https://stackoverflow.com/users/11394329/richard-nemeth"}, "reply_to_user": {"reputation": 1898, "user_id": 11286588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481401ed4b60fbd46601275743949c5b?s=128&d=identicon&r=PG&f=1", "display_name": "thePurplePython", "link": "https://stackoverflow.com/users/11286588/thepurplepython"}, "edited": false, "score": 0, "creation_date": 1559228966, "post_id": 56369342, "comment_id": 99362056, "body": "what is your <code>spark.driver.memory</code> configuration?"}, {"owner": {"reputation": 1898, "user_id": 11286588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481401ed4b60fbd46601275743949c5b?s=128&d=identicon&r=PG&f=1", "display_name": "thePurplePython", "link": "https://stackoverflow.com/users/11286588/thepurplepython"}, "edited": false, "score": 0, "creation_date": 1559263017, "post_id": 56369342, "comment_id": 99374365, "body": "standard config ... not pulling anything back to driver though ... I was able to do the imputing on my skinny table and then pivot into the wide table."}, {"owner": {"reputation": 1549, "user_id": 11394329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WmL18_5TbK8/AAAAAAAAAAI/AAAAAAAAAMI/vYk8yTm4Cjs/photo.jpg?sz=128", "display_name": "Richard Nemeth", "link": "https://stackoverflow.com/users/11394329/richard-nemeth"}, "reply_to_user": {"reputation": 1898, "user_id": 11286588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481401ed4b60fbd46601275743949c5b?s=128&d=identicon&r=PG&f=1", "display_name": "thePurplePython", "link": "https://stackoverflow.com/users/11286588/thepurplepython"}, "edited": false, "score": 0, "creation_date": 1559286477, "post_id": 56369342, "comment_id": 99379550, "body": "so 1g, try boosting it up anyway, for example to <code>10g</code>. Sometimes a lot of more hidden things happen on the driver than one expects. It is a long shot though."}, {"owner": {"reputation": 1898, "user_id": 11286588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481401ed4b60fbd46601275743949c5b?s=128&d=identicon&r=PG&f=1", "display_name": "thePurplePython", "link": "https://stackoverflow.com/users/11286588/thepurplepython"}, "edited": false, "score": 0, "creation_date": 1559705983, "post_id": 56369342, "comment_id": 99500552, "body": "unfortunately this didn&#39;t make a difference ... wish the <code>Caused by: java.lang.StackOverflowError     at org.apache.spark.sql.execution.SparkPlan.prepare(SparkPlan.s&zwnj;&#8203;cala:200)</code> error was more straight-forward to identify the actual root cause"}], "tags": [], "owner": {"reputation": 1549, "user_id": 11394329, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WmL18_5TbK8/AAAAAAAAAAI/AAAAAAAAAMI/vYk8yTm4Cjs/photo.jpg?sz=128", "display_name": "Richard Nemeth", "link": "https://stackoverflow.com/users/11394329/richard-nemeth"}, "is_accepted": false, "score": 3, "last_activity_date": 1559170405, "last_edit_date": 1559170405, "creation_date": 1559168905, "answer_id": 56369342, "question_id": 56368747, "link": "https://stackoverflow.com/questions/56368747/spark-caused-by-java-lang-stackoverflowerror-window-function/56369342#56369342", "title": "Spark Caused by: java.lang.StackOverflowError Window Function?", "body": "<p>By the stacktrace provided I believe the error comes from preparation of the execution plan, as it says:</p>\n\n<pre><code>Caused by: java.lang.StackOverflowError\n    at org.apache.spark.sql.execution.SparkPlan.prepare(SparkPlan.scala:200)\n</code></pre>\n\n<p>I believe that the reason for that is because you call the method <code>.withColumn</code> twice in the loop. What <code>.withColumn</code> does in the Spark execution plan is basically a <code>select</code> statement of all columns with 1 column changed as specified in the method. If you have 325 columns, then for single iteration this will call select on 325 columns twice -> 650 columns passed into the planner. Doing this 325 times you can see how it can create an overhead.</p>\n\n<p>However it is very interesting though that you do not receive this error for a small sample, I'd expect otherwise.</p>\n\n<p>Anyway you can try replacing your forwardFillImputer like this:</p>\n\n<pre><code>def forwardFillImputer(df, cols=[], partitioner=\"date\", value=\"UNKNOWN\"):\n    window = Window \\\n     .partitionBy(F.month(partitioner)) \\\n     .orderBy(partitioner) \\\n     .rowsBetween(-sys.maxsize, 0)\n\n    imputed_cols = [F.last(stringReplacer(F.col(i), value), ignorenulls=True).over(window).alias(i) \n                    for i in cols]\n\n    missing_cols = [F.col(i) for i in df.columns if i not in cols]\n\n    return df.select(missing_cols + imputed_cols)\n</code></pre>\n\n<p>This way you basically just parse into planner a single select statement, which should be easier to handle.</p>\n\n<p>Just as a warning, generally Spark doesn't do well with high number of columns, so you might see other <em>strange</em> issues along the way.</p>\n"}], "owner": {"reputation": 1898, "user_id": 11286588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481401ed4b60fbd46601275743949c5b?s=128&d=identicon&r=PG&f=1", "display_name": "thePurplePython", "link": "https://stackoverflow.com/users/11286588/thepurplepython"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4416, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1559170940, "creation_date": 1559165144, "last_edit_date": 1559170940, "question_id": 56368747, "link": "https://stackoverflow.com/questions/56368747/spark-caused-by-java-lang-stackoverflowerror-window-function", "title": "Spark Caused by: java.lang.StackOverflowError Window Function?", "body": "<p>Running into an error I think being caused by the Window Function.</p>\n\n<p>When I apply this script and persist just a few sample rows it works fine however when I apply it to my whole dataset (only a few GB)\nit fails with this bizarre error on the last step when trying to persist to hdfs ... the script works when I persist w/o the Window Function so the problem must be from that (<strong>I have around 325 feature columns running through the for loop</strong>).</p>\n\n<p>Any idea what could be causing the problem?  My goal is to just impute time series data via forward fill method on every variable in my dataframe.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>from pyspark.sql import SparkSession\nfrom pyspark.sql import functions as F\nfrom pyspark.sql import types as T\nfrom pyspark.sql import Window\nimport sys\nprint(spark.version)\n'2.3.0'\n\n# sample data\ndf = spark.createDataFrame([('2019-05-10 7:30:05', '1', '10', '0.5', 'FALSE'),\\\n                            ('2019-05-10 7:30:10', '2', 'UNKNOWN', '0.24', 'FALSE'),\\\n                            ('2019-05-10 7:30:15', '3', '6', 'UNKNOWN', 'TRUE'),\\\n                            ('2019-05-10 7:30:20', '4', '7', 'UNKNOWN', 'UNKNOWN'),\\\n                            ('2019-05-10 7:30:25', '5', '10', '1.1', 'UNKNOWN'),\\\n                            ('2019-05-10 7:30:30', '6', 'UNKNOWN', '1.1', 'NULL'),\\\n                            ('2019-05-10 7:30:35', '7', 'UNKNOWN', 'UNKNOWN', 'TRUE'),\\\n                            ('2019-05-10 7:30:49', '8', '50', 'UNKNOWN', 'UNKNOWN')], [\"date\", \"id\", \"v1\", \"v2\", \"v3\"])\n\ndf = df.withColumn(\"date\", F.col(\"date\").cast(\"timestamp\"))\n\n# imputer process / all cols that need filled are strings\ndef stringReplacer(x, y):\n    return F.when(x != y, x).otherwise(F.lit(None)) # replace with NULL\n\ndef forwardFillImputer(df, cols=[], partitioner=\"date\", value=\"UNKNOWN\"):\n  for i in cols:\n    window = Window\\\n    .partitionBy(F.month(partitioner))\\\n    .orderBy(partitioner)\\\n    .rowsBetween(-sys.maxsize, 0)\n\n    df = df\\\n    .withColumn(i, stringReplacer(F.col(i), value))\n    fill = F.last(df[i], ignorenulls=True).over(window)\n    df = df.withColumn(i,  fill)\n  return df\ndf2 = forwardFillImputer(df, cols=[i for i in df.columns])\n\n# errors here\ndf2\\\n.write\\\n.format(\"csv\")\\\n.mode(\"overwrite\")\\\n.option(\"header\", \"true\")\\\n.save(\"test_window_func.csv\")\n</code></pre>\n\n<pre class=\"lang-py prettyprint-override\"><code>Py4JJavaError: An error occurred while calling o13504.save.\n: org.apache.spark.SparkException: Job aborted.\n    at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:224)\n    at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:154)\n    at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:104)\n    at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:102)\n    at org.apache.spark.sql.execution.command.DataWritingCommandExec.doExecute(commands.scala:122)\n    at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:131)\n    at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:127)\n    at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:155)\n    at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n    at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:152)\n    at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:127)\n    at org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:80)\n    at org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:80)\n    at org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:654)\n    at org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:654)\n    at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n    at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:654)\n    at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:273)\n    at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:267)\n    at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:225)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:498)\n    at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n    at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n    at py4j.Gateway.invoke(Gateway.java:282)\n    at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n    at py4j.commands.CallCommand.execute(CallCommand.java:79)\n    at py4j.GatewayConnection.run(GatewayConnection.java:238)\n    at java.lang.Thread.run(Thread.java:748)\nCaused by: java.lang.StackOverflowError\n    at org.apache.spark.sql.execution.SparkPlan.prepare(SparkPlan.scala:200)\n    at org.apache.spark.sql.execution.SparkPlan$$anonfun$prepare$1.apply(SparkPlan.scala:200)\n    at org.apache.spark.sql.execution.SparkPlan$$anonfun$prepare$1.apply(SparkPlan.scala:200)\n    at scala.collection.immutable.List.foreach(List.scala:381)\n</code></pre>\n\n<h3>possible working solution</h3>\n\n<pre><code>def forwardFillImputer(df, cols=[], partitioner=\"date\", value=\"UNKNOWN\"):\n    window = Window \\\n     .partitionBy(F.month(partitioner)) \\\n     .orderBy(partitioner) \\\n     .rowsBetween(-sys.maxsize, 0)\n    imputed_cols = [F.last(stringReplacer(F.col(i), value), ignorenulls=True).over(window).alias(i) \n                    for i in cols]\n    missing_cols = [i for i in df.columns if i not in cols]\n    return df.select(missing_cols+imputed_cols)\n\ndf2 = forwardFillImputer(df, cols=[i for i in df.columns[1:]])\n\ndf2.printSchema()\nroot\n |-- date: timestamp (nullable = true)\n |-- id: string (nullable = true)\n |-- v1: string (nullable = true)\n |-- v2: string (nullable = true)\n |-- v3: string (nullable = true)\n\ndf2.show()\n+-------------------+---+---+----+-----+\n|               date| id| v1|  v2|   v3|\n+-------------------+---+---+----+-----+\n|2019-05-10 07:30:05|  1| 10| 0.5|FALSE|\n|2019-05-10 07:30:10|  2| 10|0.24|FALSE|\n|2019-05-10 07:30:15|  3|  6|0.24| TRUE|\n|2019-05-10 07:30:20|  4|  7|0.24| TRUE|\n|2019-05-10 07:30:25|  5| 10| 1.1| TRUE|\n|2019-05-10 07:30:30|  6| 10| 1.1| NULL|\n|2019-05-10 07:30:35|  7| 10| 1.1| TRUE|\n|2019-05-10 07:30:49|  8| 50| 1.1| TRUE|\n+-------------------+---+---+----+-----+\n</code></pre>\n"}, {"tags": ["python", "python-3.x", "tkinter"], "comments": [{"owner": {"reputation": 305939, "user_id": 7432, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3e3921ee8a7792e4b5da0244933395e8?s=128&d=identicon&r=PG", "display_name": "Bryan Oakley", "link": "https://stackoverflow.com/users/7432/bryan-oakley"}, "edited": false, "score": 2, "creation_date": 1559166419, "post_id": 56368746, "comment_id": 99340532, "body": "Did you create a global variable named <code>str</code> somewhere in your code?"}, {"owner": {"reputation": 46136, "user_id": 3890632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNkgF.png?s=128&g=1", "display_name": "khelwood", "link": "https://stackoverflow.com/users/3890632/khelwood"}, "edited": false, "score": 1, "creation_date": 1559166458, "post_id": 56368746, "comment_id": 99340541, "body": "This does not appear to be a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 19, "user_id": 6395277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d078b287a2b3ee053eca9a11a6ef4333?s=128&d=identicon&r=PG&f=1", "display_name": "Adam_O", "link": "https://stackoverflow.com/users/6395277/adam-o"}, "reply_to_user": {"reputation": 305939, "user_id": 7432, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3e3921ee8a7792e4b5da0244933395e8?s=128&d=identicon&r=PG", "display_name": "Bryan Oakley", "link": "https://stackoverflow.com/users/7432/bryan-oakley"}, "edited": false, "score": 0, "creation_date": 1559168459, "post_id": 56368746, "comment_id": 99341088, "body": "@BryanOakley: Yes, I did accidentally. That fixed the issue. Thank you so much. That explains why sometimes it would work and then suddenly it would freak out - I must have triggered one of the str = accidentally. Thanks again."}], "answers": [{"comments": [{"owner": {"reputation": 6961, "user_id": 1248974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ClqC2.jpg?s=128&g=1", "display_name": "davedwards", "link": "https://stackoverflow.com/users/1248974/davedwards"}, "edited": false, "score": 0, "creation_date": 1559168897, "post_id": 56369293, "comment_id": 99341202, "body": "thanks for following up on your question, when the green tick on the left is available, consider checking it to mark your answer as accepted and clear the question from the unanswered queue."}], "tags": [], "owner": {"reputation": 19, "user_id": 6395277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d078b287a2b3ee053eca9a11a6ef4333?s=128&d=identicon&r=PG&f=1", "display_name": "Adam_O", "link": "https://stackoverflow.com/users/6395277/adam-o"}, "is_accepted": true, "score": 2, "last_activity_date": 1559168500, "creation_date": 1559168500, "answer_id": 56369293, "question_id": 56368746, "link": "https://stackoverflow.com/questions/56368746/typeerror-entry-object-is-not-callable/56369293#56369293", "title": "TypeError: &#39;Entry&#39; object is not callable", "body": "<p>Just wanted to mark that it was solved by Bryan Oakley. </p>\n\n<p>I had variables called str accidentally.</p>\n"}], "owner": {"reputation": 19, "user_id": 6395277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d078b287a2b3ee053eca9a11a6ef4333?s=128&d=identicon&r=PG&f=1", "display_name": "Adam_O", "link": "https://stackoverflow.com/users/6395277/adam-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 1, "accepted_answer_id": 56369293, "answer_count": 1, "score": -2, "last_activity_date": 1559168500, "creation_date": 1559165144, "question_id": 56368746, "link": "https://stackoverflow.com/questions/56368746/typeerror-entry-object-is-not-callable", "title": "TypeError: &#39;Entry&#39; object is not callable", "body": "<p>I am building an Python with Tkinter application, and one of the things it does is take input (from Entry boxes) and saves it. However, recently it has started creating this error code in multiple places: </p>\n\n<pre><code>Exception in Tkinter callback\nTraceback (most recent call last):\nFile \"C:\\Users\\Adam\\AppData\\Local\\Programs\\Python\\Python37-32\\lib\\tkinter\\__init__.py\", line 1705, in __call__\nreturn self.func(*args)\nFile \"C:\\Users\\Adam\\Desktop\\paintersinventory.py\", line 2773, in grabpaintingname\nsaveedit()\nFile \"C:\\Users\\Adam\\Desktop\\paintersinventory.py\", line 2736, in saveedit\nw = str(title[pnttoedit]) + \" (\" + str(copyat) + \")\"\nTypeError: 'Entry' object is not callable\n</code></pre>\n\n<p>Here is the related code, excluding the Tkinter box that pops up to ask for the information, which exists and correctly, after a button press sends the code to the grabpaintingname def: </p>\n\n<pre><code>painter = {}\ntitle = {}\nnames = []\npnttoedit = ''\ncopyat = 1\n\ndef saveedit(): \n    w = str(title[pnttoedit]) + \" (\" + str(copyat) + \")\"\n    names.append(w)\n    v = painter[pnttoedit]\n    painter[w] = v\n    messagebox.showinfo(\"Painter's Inventory\", \"Copy of \" + str(pnttoedit) + \" created.\")\n    print(str(pnttoedit))\n\ndef grabpaintingname():\n     global pnttoedit\n     pnttoedit = tvkare.get()\n     saveedit()\n\ntvkare = StringVar(editers)\ntvkare.set(names[0])\ne2 = OptionMenu(mainframe, tvkare, *names)\ne2.grid(row=3, column=1)\ndef change_dropdown(*args):\n    pnttoedit = tvkare.get()\n</code></pre>\n\n<p>Any help with how to solve this problem or information on why it might be occurring would be very much appreciated. Thank you in advance!</p>\n"}, {"tags": ["python", "pandas", "dataframe"], "comments": [{"owner": {"reputation": 560, "user_id": 3121548, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c8ec25db2b7220d1b30f107fa2601736?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Liu", "link": "https://stackoverflow.com/users/3121548/dave-liu"}, "edited": false, "score": 0, "creation_date": 1559252589, "post_id": 56368717, "comment_id": 99372000, "body": "Sorry, ironically StackOverflow indentation sucks, and I can only toggle 1-level deep indents. get_max_score() is within the add_labels_to_dataframe() function, so it receives variables outside of its function scope."}], "answers": [{"tags": [], "owner": {"reputation": 287228, "user_id": 1240268, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/RN9Mw.jpg?s=128&g=1", "display_name": "Andy Hayden", "link": "https://stackoverflow.com/users/1240268/andy-hayden"}, "is_accepted": false, "score": 0, "last_activity_date": 1559165800, "creation_date": 1559165800, "answer_id": 56368867, "question_id": 56368717, "link": "https://stackoverflow.com/questions/56368717/select-and-add-column-values-from-another-dataframe-based-on-if-the-index-exists/56368867#56368867", "title": "Select and add column values from another dataframe based on if the index exists in both", "body": "<p>I think* you're going to be able to do this with a <a href=\"https://pandas.pydata.org/pandas-docs/stable/user_guide/groupby.html#transformation\" rel=\"nofollow noreferrer\">groupby transform</a>:</p>\n\n<pre><code>df[label_name] = df.groupby(\"person_id\").transform(\"max\")\n</code></pre>\n\n<p>* It's a little hard to read precisely what your code is attempting to do...</p>\n"}], "owner": {"reputation": 560, "user_id": 3121548, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c8ec25db2b7220d1b30f107fa2601736?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Liu", "link": "https://stackoverflow.com/users/3121548/dave-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559252655, "creation_date": 1559164998, "last_edit_date": 1559252655, "question_id": 56368717, "link": "https://stackoverflow.com/questions/56368717/select-and-add-column-values-from-another-dataframe-based-on-if-the-index-exists", "title": "Select and add column values from another dataframe based on if the index exists in both", "body": "<p>I have two dataframes, let's call them <code>A</code> and <code>B</code>, with the same indexes (person IDs), but some IDs might be in A and not B, and vice versa. Additionally, the IDs are Non-Unique in <code>B</code>, while unique in dataframe <code>A</code>, so I want to </p>\n\n<p>I want to check <code>B</code> to see if there exists certain IDs, then add a column of the max B-Label into A, for that specific ID.</p>\n\n<p>I tried writing the function below as an argument to the pandas .apply() function.</p>\n\n<pre><code>def add_labels_to_dataframe(train_df,\n                        id_col_name='person_id',\n                        label_name=\"max_progress\",\n                        label_filepath=LABELS_SRC_FILE,\n                        default_value=-1,\n                        save=True):\n\"\"\"\nAdd labels column to train_df\n\n:param train_df: (DataFrame)\n    the training dataframe that needs labels\n:param id_col_name: (str)\n    name of the ID column to use\n:param label_name: (str)\n    the column name of the label to use (score/progress/is_X/etc)\n:param label_filepath: (str)\n    filepath with IDs and associated labels\n:param default_value: (int, or anything)\n    The default label to give when a person_id has no associated label\n:return: (DataFrame)\n    updated dataframe with labels\n\"\"\"\nlabels_df = pd.read_csv(label_filepath)\n\ndef get_max_score(row):\n    \"\"\"\n    DataFrame function to select max score when multiple exist per ID\n\n    :param row: (DataFrame)\n        A single row of the dataframe being modified\n    :return: (int)\n        returns elements of a Series that becomes a new column of the DataFrame\n    \"\"\"\n    # if person_id is in labels, then get max of labels\n    pdb.set_trace()\n    pid_labels_df = labels_df[row[id_col_name].isin(labels_df[id_col_name])]\n\n    if not pid_labels_df.empty and not pd.isnull(pid_labels_df[label_name].max()):\n        return 1 + pid_labels_df[label_name].max()\n\n    return default_value\n\n\ntrain_df[label_name] = train_df.apply(get_max_score, axis=1)\n\nif save:\n    train_df.to_csv(LABELED_TRAIN_DF_PATH)\n\nreturn train_df\n</code></pre>\n\n<blockquote>\n  <p>ValueError: ('Can only compare identically-labeled Series objects', 'occurred at index 0')</p>\n</blockquote>\n\n<p>I know I could just convert both dataframe indexes into Python lists, check if value exists, then create a new DataFrame mapping old rows to either labeled values or some default -1, but I'm trying to do this all within Pandas, in order to utilize the vectorization.</p>\n\n<p>Can someone help me figure out a concise way to use only dataframe operations instead of casting to Python lists here?</p>\n"}, {"tags": ["python", "list"], "comments": [{"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 1, "creation_date": 1559165093, "post_id": 56368713, "comment_id": 99340161, "body": "Can you define &quot;peak&quot;? Number &gt;= 6000? Number higher than x% of items?"}, {"owner": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "edited": false, "score": 0, "creation_date": 1559165107, "post_id": 56368713, "comment_id": 99340168, "body": "What is your criteria for identifying the window? A certain width from the highest value|median|mode?"}, {"owner": {"reputation": 79, "user_id": 8093662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca56c01f721184dc51f7cecdb4b415dc?s=128&d=identicon&r=PG&f=1", "display_name": "the_reaper", "link": "https://stackoverflow.com/users/8093662/the-reaper"}, "edited": false, "score": 0, "creation_date": 1559165248, "post_id": 56368713, "comment_id": 99340213, "body": "i mean i cannot hardcode it to be a certain value like above 6000."}, {"owner": {"reputation": 1311, "user_id": 10766766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SqW5t.jpg?s=128&g=1", "display_name": "Raphael", "link": "https://stackoverflow.com/users/10766766/raphael"}, "edited": false, "score": 0, "creation_date": 1559165256, "post_id": 56368713, "comment_id": 99340215, "body": "one way would be to use the standard deviation of your list: Then lets say take a peak as a value &gt; 2 * std.  You could do that on the absolute values or on the slope. <a href=\"https://docs.scipy.org/doc/numpy/reference/generated/numpy.std.html\" rel=\"nofollow noreferrer\">docs.scipy.org/doc/numpy/reference/generated/numpy.std.html</a>"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1559165366, "post_id": 56368713, "comment_id": 99340245, "body": "If you can&#39;t hard-wire it, you need to specify what you would use instead."}, {"owner": {"reputation": 79, "user_id": 8093662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca56c01f721184dc51f7cecdb4b415dc?s=128&d=identicon&r=PG&f=1", "display_name": "the_reaper", "link": "https://stackoverflow.com/users/8093662/the-reaper"}, "edited": false, "score": 0, "creation_date": 1559165432, "post_id": 56368713, "comment_id": 99340264, "body": "what I was thinking of basically is to iterate till I reach a certain percentage increase , and continue iterating till i reach a certain percentage decrease from maximum value"}, {"owner": {"reputation": 1311, "user_id": 10766766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SqW5t.jpg?s=128&g=1", "display_name": "Raphael", "link": "https://stackoverflow.com/users/10766766/raphael"}, "edited": false, "score": 0, "creation_date": 1559165563, "post_id": 56368713, "comment_id": 99340298, "body": "and instead of this &quot;certain percentage&quot; you could use the standard deviation of your slopes. Might be still not perfect sure worth a try"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1559165584, "post_id": 56368713, "comment_id": 99340303, "body": "Then why would your window include 0? Surely 6500 to 0 is a large percentage decrease. In any event, once you specify a criterion it will probably be easy enough to code; but only you can specify the criterion since we don&#39;t know what you are trying to do with all this."}, {"owner": {"reputation": 79, "user_id": 8093662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca56c01f721184dc51f7cecdb4b415dc?s=128&d=identicon&r=PG&f=1", "display_name": "the_reaper", "link": "https://stackoverflow.com/users/8093662/the-reaper"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1559166023, "post_id": 56368713, "comment_id": 99340410, "body": "@JohnColeman &quot;till I reach a certain percentage increase&quot; which means I may not encounter zero at all since I am not moving inside my desired block"}, {"owner": {"reputation": 2121, "user_id": 6676101, "user_type": "registered", "accept_rate": 11, "profile_image": "https://i.stack.imgur.com/GdQJN.jpg?s=128&g=1", "display_name": "Toothpick Anemone", "link": "https://stackoverflow.com/users/6676101/toothpick-anemone"}, "edited": false, "score": 0, "creation_date": 1559167068, "post_id": 56368713, "comment_id": 99340723, "body": "@the_reaper If you like Matlab, the <code>numpy</code> package for python is very very similar to Matlab."}], "answers": [{"tags": [], "owner": {"reputation": 2121, "user_id": 6676101, "user_type": "registered", "accept_rate": 11, "profile_image": "https://i.stack.imgur.com/GdQJN.jpg?s=128&g=1", "display_name": "Toothpick Anemone", "link": "https://stackoverflow.com/users/6676101/toothpick-anemone"}, "is_accepted": false, "score": 0, "last_activity_date": 1559172240, "last_edit_date": 1559172240, "creation_date": 1559170546, "answer_id": 56369539, "question_id": 56368713, "link": "https://stackoverflow.com/questions/56368713/how-to-select-a-window-of-values-from-the-list/56369539#56369539", "title": "How to select a window of values from the list?", "body": "<p>Below is a plot of your data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vZEHEm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vZEHEm.png\" alt=\"plot of points without line\"></a></p>\n\n<p>The traditional way to do what you're talking about would be to interpolate the data. This means adding a curve of best fit, such as a <strong><em>cubic spline</em></strong>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Z4B3Am.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Z4B3Am.png\" alt=\"plot with line\"></a></p>\n\n<p>After finding a differentiable curve passing through the points, you find the first derivative (rate of change). Wherever the first derivative has a local maximum is where your data suddenly went uphill or downhill.</p>\n\n<p>However, all of that maybe overkill for your purposes. I think the following code will do what you want:</p>\n\n<pre><code>class OnOffRecorder:\n    \"\"\"\n    \"\"\"\n    def __init__(self, is_active = False):\n        \"\"\"\n        By default, is not recording data\n        \"\"\"\n        self.is_active = is_active\n        self.data = dict()\n\n    def turn_recording_on(self):\n        self.is_active = True\n\n    def turn_recording_off(self):\n        self.is_active = False\n\n    def toggle_recording(self):\n        self.is_active = not(self.is_active)\n\n    def push(self, key, value):\n        if self.is_active:\n            self.data[key] = value\n        return\n\n    def pop(self):\n        old_data = self.data\n        self.data = dict()\n        return old_data\n\ndef get_peak_data(data, delta):\n    \"\"\"\n    `delta` represents percentage distance between\n            minimum and maximum of the data.\n\n            if data suddenly increases by delta, then begin recording\n            if data suddenly decreases by delta, then stop recording\n    \"\"\"\n    mind = min(data)\n    maxd = max(data)\n    raynge = maxd - mind\n    # `li` == `left index`\n    # `ri` == `right index`\n    record = OnOffRecorder()\n    record.turn_recording_off()\n    for li in range(0, -1 + len(data)):\n        ri = li + 1\n        ld = data[li] # left data\n        rd = data[ri] # right data\n        if abs(rd-ld)/raynge &gt; delta:\n            if rd &gt; ld :\n                record.turn_recording_on()\n            elif rd &lt; ld:\n                record.turn_recording_off()\n        record.push(ri, rd)\n    return record.pop()\n\ndata = [22 , 15 , 6 ,12 ,30 , 45, 200 , 238 ,\n        220 , 6000, 6250 , 6900, 6700, 6500,\n        0 , 250 , 6000 ,6800,220, 250, 200]\n\n# if data suddenly increases, then begin recording that data\n# if data suddenly decreases, then stop recording that data.\ndelta = .25\npeak_data = get_peak_data(data, delta)\nprint(peak_data.values()) \n</code></pre>\n\n<h2>EDIT:</h2>\n\n<p>I developed a second/different approach which does not require you to manually specify a <code>delta</code> value. This is described below:</p>\n\n<ol>\n<li>Sort the data.</li>\n<li>traverse the sorted data from minimum to maximum</li>\n<li>record differences/jumps.</li>\n<li>find maximum of the jumps.</li>\n<li>That maximimum jump is where low signals transition to high signals    </li>\n</ol>\n\n<p>Below is code which implements the step-by-step process outlined above:</p>\n\n<pre><code>def get_dividing_line(data):\n    sdata = sorted(data)\n    jumps = [sdata[i+1] - sdata[i] for i in range(0, -1 + len(sdata))]\n    jumps_max = max(jumps)\n    jumps_max_left = jumps.index(jumps_max)\n    jumps_max_right = [x for x in reversed(jumps)].index(jumps_max)\n    jumps_max_right = len(sdata) - jumps_max_right\n    jump_start = sdata[jumps_max_left]\n    jump_end = sdata[jumps_max_right]\n    return (jump_start + jump_end)/2\n\ndef get_high_signals(data):\n    threshold = get_dividing_line(data)\n    return [x for x in data if x &gt;= threshold]\n\ndata = [22 , 15 , 6 ,12 ,30 , 45, 200 , 238 ,\n        220 , 6000, 6250 , 6900, 6700, 6500,\n        0 , 250 , 6000 ,6800,220, 250, 200]\n\nhigh_signals = get_high_signals(data)\nprint(high_signals)\n# prints [6000, 6250, 6900, 6700, 6500, 6000, 6800]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24329, "user_id": 5237560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CO92P.png?s=128&g=1", "display_name": "Alain T.", "link": "https://stackoverflow.com/users/5237560/alain-t"}, "is_accepted": true, "score": 0, "last_activity_date": 1559174165, "creation_date": 1559174165, "answer_id": 56369978, "question_id": 56368713, "link": "https://stackoverflow.com/questions/56368713/how-to-select-a-window-of-values-from-the-list/56369978#56369978", "title": "How to select a window of values from the list?", "body": "<p>You could establish a treshold between the highest and lowest values in the data, then find the first and last indexes of entries that are over the treshold to form a range in the list:</p>\n\n<pre><code>data     = [22 , 15 , 6 ,12 ,30 , 45, 200 , 238 , 220 , 6000, 6250 , 6900, 6700,6500, 0 , 250 , 6000 ,6800,220, 250,200]\ntreshold = (min(data)+max(data))/2\nstart    = next(i for i,v in enumerate(data) if v &gt;= treshold)\nend      = len(data) - next(i for i,v in enumerate(data[::-1]) if v &gt;= treshold)\nresult   = data[start:end]\n\nprint(result)\n# [6000, 6250, 6900, 6700, 6500, 0, 250, 6000, 6800]\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 8093662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca56c01f721184dc51f7cecdb4b415dc?s=128&d=identicon&r=PG&f=1", "display_name": "the_reaper", "link": "https://stackoverflow.com/users/8093662/the-reaper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 56369978, "answer_count": 2, "score": -1, "last_activity_date": 1559174165, "creation_date": 1559164958, "last_edit_date": 1559165115, "question_id": 56368713, "link": "https://stackoverflow.com/questions/56368713/how-to-select-a-window-of-values-from-the-list", "title": "How to select a window of values from the list?", "body": "<p>I have a stream of data which is of the type</p>\n\n<pre><code>list  = [22 , 15 , 6 ,12 ,30 , 45, 200 , 238 , 220 , 6000, 6250 , 6900, 6700,6500, 0 , 250 , 6000 ,6800,220, 250,200]\n</code></pre>\n\n<p>As you can see the stream of data has some very high values in the middle which is what we desire to extract. This block can also contain low values (0 and 250 in the above list) but definitely higher values at the start and end of block ( 6000,6500). How can we extract this particular window of data.</p>\n\n<p>The output should be </p>\n\n<pre><code>new_list = [6000,6250,6900,600,6500,0, 250 , 6000 , 6800]\n</code></pre>\n\n<p>I usually work on MATLAB. So the way i would do this is by finding the first and the last peak in the data</p>\n"}, {"tags": ["python", "pandas"], "comments": [{"owner": {"reputation": 2162, "user_id": 3014097, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/47193d2bbe5b654700776fd2a7d14868?s=128&d=identicon&r=PG&f=1", "display_name": "dan_g", "link": "https://stackoverflow.com/users/3014097/dan-g"}, "edited": false, "score": 0, "creation_date": 1559164442, "post_id": 56368552, "comment_id": 99339967, "body": "You&#39;re trying to index in to an empty dataframe, which you can&#39;t do. You can catch the exception and have it print a string if you want, but there&#39;s no way around the IndexError itself when doing what you&#39;re trying to do"}], "answers": [{"tags": [], "owner": {"reputation": 509, "user_id": 7423325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Pdsu.jpg?s=128&g=1", "display_name": "Pasindu Gamarachchi", "link": "https://stackoverflow.com/users/7423325/pasindu-gamarachchi"}, "is_accepted": true, "score": 2, "last_activity_date": 1559164593, "creation_date": 1559164593, "answer_id": 56368632, "question_id": 56368552, "link": "https://stackoverflow.com/questions/56368552/how-to-select-a-value-from-a-dataframe-even-if-there-is-no-entry/56368632#56368632", "title": "How to select a value from a DataFrame (even if there is no entry)", "body": "<p>The following does what you are looking for:</p>\n\n<pre><code>keyname = 'Key2' # Key3\ntry:\n    print(df.loc[(df['ID']==1) &amp; (df['Key'] == keyname)].iloc[-1,-1])\nexcept IndexError:\n    print(\"\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "reply_to_user": {"reputation": 67, "user_id": 10018878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/611ab8b1b440257c3670781b0ac892f0?s=128&d=identicon&r=PG&f=1", "display_name": "pybert", "link": "https://stackoverflow.com/users/10018878/pybert"}, "edited": false, "score": 0, "creation_date": 1559165896, "post_id": 56368694, "comment_id": 99340379, "body": "It won&#39;t hide any inadvertent index errors but the other solution is also great"}], "tags": [], "owner": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "is_accepted": false, "score": 1, "last_activity_date": 1559164853, "creation_date": 1559164853, "answer_id": 56368694, "question_id": 56368552, "link": "https://stackoverflow.com/questions/56368552/how-to-select-a-value-from-a-dataframe-even-if-there-is-no-entry/56368694#56368694", "title": "How to select a value from a DataFrame (even if there is no entry)", "body": "<p>Trying this a bit more explicitly using a mask that you can inspect.</p>\n\n<pre><code>mask = (df['ID']==1) &amp; (df['Key'] == 'Key3')\nif mask.any():\n    print(df[mask].Value.iloc[0])\nelse:\n    print(\"\")\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 10018878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/611ab8b1b440257c3670781b0ac892f0?s=128&d=identicon&r=PG&f=1", "display_name": "pybert", "link": "https://stackoverflow.com/users/10018878/pybert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 56368632, "answer_count": 2, "score": 0, "last_activity_date": 1559164853, "creation_date": 1559164206, "question_id": 56368552, "link": "https://stackoverflow.com/questions/56368552/how-to-select-a-value-from-a-dataframe-even-if-there-is-no-entry", "title": "How to select a value from a DataFrame (even if there is no entry)", "body": "<p>I'm trying to select an entry from a DataFrame structure based on some conditions. It works - as long as there is an entry that fits to the query (first example in code shown below)</p>\n\n<p>But sometimes, there is no proper entry, so the return value should be an empty string (not an error message). This I cannot achieve.</p>\n\n<pre><code>from pandas import DataFrame\n\ndata = {'ID': [1, 1, 2, 2],\n        'Key': ['Key1','Key2','Key1','Key2'],\n        'Value': ['Value1', 'Value2', 'Value3', 'Value4']\n        }\n\ndf = DataFrame(data,columns= ['ID', 'Key','Value'])\n\nprint(df.loc[(df['ID']==1) &amp; (df['Key'] == 'Key2')].iloc[-1,-1])\n# shows \"Value2\" (correct)\n\nprint(df.loc[(df['ID']==1) &amp; (df['Key'] == 'Key3')].iloc[-1,-1])\n# should show \"\" (desired output)\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["python", "airflow"], "answers": [{"comments": [{"owner": {"reputation": 2154, "user_id": 1070310, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e14bb63a5e0bca2518d943ef6cc465bd?s=128&d=identicon&r=PG", "display_name": "pinas", "link": "https://stackoverflow.com/users/1070310/pinas"}, "edited": false, "score": 0, "creation_date": 1559290486, "post_id": 56370441, "comment_id": 99381368, "body": "Hi, yes this is working, thx. Unfortunately the whole dag run is then marked as failed what makes it hard to identify runs which failed because of other - real - reasons."}, {"owner": {"reputation": 621, "user_id": 10627150, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NRFrc.jpg?s=128&g=1", "display_name": "jdimella", "link": "https://stackoverflow.com/users/10627150/jdimella"}, "reply_to_user": {"reputation": 2154, "user_id": 1070310, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e14bb63a5e0bca2518d943ef6cc465bd?s=128&d=identicon&r=PG", "display_name": "pinas", "link": "https://stackoverflow.com/users/1070310/pinas"}, "edited": false, "score": 0, "creation_date": 1559353290, "post_id": 56370441, "comment_id": 99404737, "body": "Glad it helped! Please, consider accepting my answer. Also - have a look into Trigger rules (<a href=\"https://airflow.apache.org/concepts.html#trigger-rules\" rel=\"nofollow noreferrer\">airflow.apache.org/concepts.html#trigger-rules</a>). You might find some useful information to help control the behaviour of the DAG."}], "tags": [], "owner": {"reputation": 621, "user_id": 10627150, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NRFrc.jpg?s=128&g=1", "display_name": "jdimella", "link": "https://stackoverflow.com/users/10627150/jdimella"}, "is_accepted": true, "score": 4, "last_activity_date": 1559178944, "creation_date": 1559178944, "answer_id": 56370441, "question_id": 56368548, "link": "https://stackoverflow.com/questions/56368548/how-to-stop-a-airflow-dag-run-from-task/56370441#56370441", "title": "How to stop a Airflow DAG run from task", "body": "<p>Assuming you have no downstream tasks that ignore the failure of a previous task, raising an exception from within the task will cause the DAG to stop processing and be marked as failed.</p>\n\n<p>So in your case, you can raise an exception when you find that the file has already been processed.</p>\n"}], "owner": {"reputation": 2154, "user_id": 1070310, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e14bb63a5e0bca2518d943ef6cc465bd?s=128&d=identicon&r=PG", "display_name": "pinas", "link": "https://stackoverflow.com/users/1070310/pinas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2023, "favorite_count": 0, "accepted_answer_id": 56370441, "answer_count": 1, "score": 3, "last_activity_date": 1559178944, "creation_date": 1559164175, "question_id": 56368548, "link": "https://stackoverflow.com/questions/56368548/how-to-stop-a-airflow-dag-run-from-task", "title": "How to stop a Airflow DAG run from task", "body": "<p>so I have an airflow DAG task which performs several checks on a file (e.g., if it was already processed in the past) and I want the whole DAG run to stop completely if one of the checks fails. How can I do that?</p>\n\n<p>Basically the checks are done in a python script.</p>\n\n<p>Thx :</p>\n"}, {"tags": ["python", "opencv", "camera-calibration"], "comments": [{"owner": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 1, "creation_date": 1559166400, "post_id": 56368537, "comment_id": 99340527, "body": "try to increase the contrast"}, {"owner": {"reputation": 830, "user_id": 4945948, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/7eb29ca42fb0303ab8e12ef8e0046549?s=128&d=identicon&r=PG&f=1", "display_name": "Will.Evo", "link": "https://stackoverflow.com/users/4945948/will-evo"}, "reply_to_user": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 0, "creation_date": 1559167552, "post_id": 56368537, "comment_id": 99340854, "body": "I tried a couple of thresholding techniques with no success. I tried doing a binary threshold with an adaptive gaussian method and also binary thresholding using otsu&#39;s method. I played with parameters in the guassian method but couldn&#39;t really find something that worked really well.  I also tried clipping the data between some min max value to highlight the chess board but again had no luck."}, {"owner": {"reputation": 6641, "user_id": 3163618, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bfab3078ba21206c78750d088cae76cf?s=128&d=identicon&r=PG&f=1", "display_name": "qwr", "link": "https://stackoverflow.com/users/3163618/qwr"}, "edited": false, "score": 0, "creation_date": 1559234660, "post_id": 56368537, "comment_id": 99365024, "body": "the contrast here is still way too low."}, {"owner": {"reputation": 6641, "user_id": 3163618, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bfab3078ba21206c78750d088cae76cf?s=128&d=identicon&r=PG&f=1", "display_name": "qwr", "link": "https://stackoverflow.com/users/3163618/qwr"}, "edited": false, "score": 2, "creation_date": 1559234664, "post_id": 56368537, "comment_id": 99365026, "body": "&gt; The function requires white space (like a square-thick border, the wider the better) around the board to make the detection more robust in various environments. Otherwise, if there is no border and the background is dark, the outer black squares cannot be segmented properly and so the square grouping and ordering algorithm fails."}, {"owner": {"reputation": 830, "user_id": 4945948, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/7eb29ca42fb0303ab8e12ef8e0046549?s=128&d=identicon&r=PG&f=1", "display_name": "Will.Evo", "link": "https://stackoverflow.com/users/4945948/will-evo"}, "edited": false, "score": 0, "creation_date": 1559236694, "post_id": 56368537, "comment_id": 99365859, "body": "I can see that and will keep that in mind for a future test however, even IF I had that border, clearly openCV corner detection is having a hard time finding the corners in the chess board. Even if I manually black everything out that isn&#39;t the chess board, drastically increase the contrast, AND clip the frame to the data range of the chessboard chunks, openCV refuses to find the corners."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 13041493, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/dc28afe15c6aa0258a4c0e50fd78005b?s=128&d=identicon&r=PG", "display_name": "Ethan Frantz", "link": "https://stackoverflow.com/users/13041493/ethan-frantz"}, "is_accepted": false, "score": 1, "last_activity_date": 1583880450, "last_edit_date": 1583880450, "creation_date": 1583872847, "answer_id": 60625610, "question_id": 56368537, "link": "https://stackoverflow.com/questions/56368537/opencv-fails-to-find-chess-board-corners/60625610#60625610", "title": "OpenCV fails to find chess board corners", "body": "<p>I got <code>findChessboardCorners</code> to work with 2 adjustments. </p>\n\n<ol>\n<li><p>As said in one of the comments, <strong>openCV</strong> expects a white boarder\naround the chessboard. To achieve that you can 'invert' the image,\nessentially creating the equivalent to a photographic negative.\nBefore I called <code>findChessboardCorners</code>, I did: <code>image_inverted = \nnumpy.array(256 \u2013 image_original, dtype=uint8)</code></p></li>\n<li><p>Only use the <code>cv2.CALIB_CB_ADAPTIVE_THREASH</code> flag when calling\n<code>findChessboardCorners</code>. <code>CALIB_CB_FAST_CHECK</code> and\n<code>CALIB_CB_NORMALIZE_IMAGE</code> flags seem to make <code>findChessboardCorners</code>\nnot find the corners.</p></li>\n</ol>\n\n<p>Good Luck</p>\n"}], "owner": {"reputation": 830, "user_id": 4945948, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/7eb29ca42fb0303ab8e12ef8e0046549?s=128&d=identicon&r=PG&f=1", "display_name": "Will.Evo", "link": "https://stackoverflow.com/users/4945948/will-evo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1455, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1583880450, "creation_date": 1559164120, "last_edit_date": 1559675762, "question_id": 56368537, "link": "https://stackoverflow.com/questions/56368537/opencv-fails-to-find-chess-board-corners", "title": "OpenCV fails to find chess board corners", "body": "<p>I am working with an IR camera and am trying to find out if we have any lens distortion. I am using the example from OpenCV <a href=\"https://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_calib3d/py_calibration/py_calibration.html\" rel=\"nofollow noreferrer\">here</a> to guide my work. I used a chessboard template from <a href=\"https://markhedleyjones.com/projects/calibration-checkerboard-collection\" rel=\"nofollow noreferrer\">here</a> and attached it to the back of a book. Before taking any images I heated the book/paper and observed that the checkerboard pattern was coming in very clear. </p>\n\n<p>I took ~50 still frames with the chessboard pattern tilted/moved so that every part of the frame contained some part of the pattern. An example of one of my images is below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JRpBY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JRpBY.png\" alt=\"example calibration image\"></a></p>\n\n<p>I used the following code which resulted in False for every image. I tried every combination of grid pattern sizes from (5-9, 5-9). </p>\n\n<pre><code>import numpy as np\nimport cv2\nimport glob2 as glob\nimport matplotlib.pyplot as plt\n\nbase = 'pathtoimages/'\nfiles = glob.glob(base + '*.png')\n\nfor file in files:\n    img = cv2.imread(file)\n    gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)\n    ret, corners = cv2.findChessboardCorners(gray, (6,8), None)\n\n    print (ret)\n</code></pre>\n\n<p>I can't figure out why the algorithm is not finding the corners. Any ideas?</p>\n\n<p><strong>Edit May 30, 2019:</strong></p>\n\n<p>Today I took some more images with the camera. I took the photos in a more controlled environment without any external light sources present. These new images still fail the findchessboard corner detection. I tried increasing the contrast and brightness using cv2.convertScaleAbs to produce the following image as an example. </p>\n\n<p><a href=\"https://i.stack.imgur.com/CfD4u.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CfD4u.png\" alt=\"Increased Contrast\"></a></p>\n\n<p>This also fails. If I use cv2.goodFeaturesToTrack to find corners I get the following result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wWu3L.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wWu3L.png\" alt=\"corners\"></a></p>\n\n<p>It seems like the Opencv corner detection algorithm is actively avoiding my chess board corners. It will find any corner it can before finding one on the chessboard. I am truly stumped here. </p>\n\n<p>As a sanity check I made sure that openCV can find the corners on the original chessboard I am using and it worked perfectly. </p>\n\n<p>Any ideas?</p>\n\n<p><strong>Edit June 4, 2019:</strong></p>\n\n<p>I ended up writing a script that allows me to manually assign each of the corners. I was able to get the camera distortion model successfully. I still have no solution for why the corners couldn't automatically be found by openCV. I think if I were to do this again in IR, I would make a custom grid that increases the contrast between grid cells simply due to differing thermal properties between \"white\" and \"black\" grid cells (use different materials). </p>\n"}, {"tags": ["python", "windows", "scrapy"], "comments": [{"owner": {"reputation": 2916, "user_id": 939364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cceb4bd730bda5e8464b76de4d1d6dc5?s=128&d=identicon&r=PG", "display_name": "Gallaecio", "link": "https://stackoverflow.com/users/939364/gallaecio"}, "edited": false, "score": 0, "creation_date": 1559208865, "post_id": 56368516, "comment_id": 99352234, "body": "Please, keep different questions separate."}, {"owner": {"reputation": 2916, "user_id": 939364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cceb4bd730bda5e8464b76de4d1d6dc5?s=128&d=identicon&r=PG", "display_name": "Gallaecio", "link": "https://stackoverflow.com/users/939364/gallaecio"}, "edited": false, "score": 0, "creation_date": 1559209000, "post_id": 56368516, "comment_id": 99352285, "body": "Have you seen <a href=\"https://github.com/scrapy/scrapy/issues/3447\" rel=\"nofollow noreferrer\">github.com/scrapy/scrapy/issues/3447</a>?"}, {"owner": {"reputation": 79, "user_id": 10173282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCtCi.jpg?s=128&g=1", "display_name": "ripfreeworld", "link": "https://stackoverflow.com/users/10173282/ripfreeworld"}, "reply_to_user": {"reputation": 2916, "user_id": 939364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cceb4bd730bda5e8464b76de4d1d6dc5?s=128&d=identicon&r=PG", "display_name": "Gallaecio", "link": "https://stackoverflow.com/users/939364/gallaecio"}, "edited": false, "score": 0, "creation_date": 1559210675, "post_id": 56368516, "comment_id": 99353048, "body": "@Gallaecio Thank you but I think that&#39;s a different problem, because my installation was successful"}, {"owner": {"reputation": 2916, "user_id": 939364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cceb4bd730bda5e8464b76de4d1d6dc5?s=128&d=identicon&r=PG", "display_name": "Gallaecio", "link": "https://stackoverflow.com/users/939364/gallaecio"}, "edited": false, "score": 0, "creation_date": 1559210957, "post_id": 56368516, "comment_id": 99353172, "body": "<code>from lxml import etree</code> seems to fail in your system. Did you get any error during the <code>lxml</code> installation? Could you try reinstalling <code>lxml</code>?"}], "owner": {"reputation": 79, "user_id": 10173282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCtCi.jpg?s=128&g=1", "display_name": "ripfreeworld", "link": "https://stackoverflow.com/users/10173282/ripfreeworld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 307, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559215396, "creation_date": 1559164008, "last_edit_date": 1559215396, "question_id": 56368516, "link": "https://stackoverflow.com/questions/56368516/scrapy-with-importerror-dll-load-failed-on-windows", "title": "`Scrapy` with `ImportError: DLL load failed` on Windows", "body": "<p>Thank you all! Although I still don't know why, I reinstalled the whole <code>anaconda</code> using all setting as default and it works now...</p>\n\n<hr>\n\n<p>I installed Anaconda not in drive <code>C:</code> as default path in my system but in self-created path <code>D:\\Ana</code>. And I installed Scrapy with <code>conda install -c conda-forge scrapy</code>.</p>\n\n<p>When I use <code>scrapy startproject tutorial</code>, I got following error:</p>\n\n<pre><code>    &gt; C:\\Users\\zhang&gt;scrapy startproject tutorial Traceback (most recent\n    &gt; call last):   File \"D:\\Ana\\Scripts\\scrapy-script.py\", line 6, in\n    &gt; &lt;module&gt;\n    &gt;     from scrapy.cmdline import execute   File \"D:\\Ana\\lib\\site-packages\\scrapy\\__init__.py\", line 34, in &lt;module&gt;\n    &gt;     from scrapy.spiders import Spider   File \"D:\\Ana\\lib\\site-packages\\scrapy\\spiders\\__init__.py\", line 10, in\n    &gt; &lt;module&gt;\n    &gt;     from scrapy.http import Request   File \"D:\\Ana\\lib\\site-packages\\scrapy\\http\\__init__.py\", line 11, in\n    &gt; &lt;module&gt;\n    &gt;     from scrapy.http.request.form import FormRequest   File \"D:\\Ana\\lib\\site-packages\\scrapy\\http\\request\\form.py\", line 11, in\n    &gt; &lt;module&gt;\n    &gt;     import lxml.html   File \"D:\\Ana\\lib\\site-packages\\lxml\\html\\__init__.py\", line 53, in &lt;module&gt;\n    &gt;     from .. import etree ImportError: DLL load failed: \u627e\u4e0d\u5230\u6307\u5b9a\u7684\u6a21\u5757\u3002(translate: cannot found the module)\n</code></pre>\n\n<p>I tried to remove and install <code>scrapy</code> again but it still doesn't work.\nCould you give some advice?</p>\n\n<p>Thank you!</p>\n\n<p><strong>update</strong>:</p>\n\n<p>I reinstalled <code>lxml</code> and then it seems better, because when I type <code>scrapy</code> in <code>cmd</code> it shows:</p>\n\n<pre><code>&gt; C:\\Users\\zhang&gt;scrapy Scrapy 1.6.0 - no active project\n&gt; \n&gt; Usage:   scrapy &lt;command&gt; [options] [args]\n&gt; \n&gt; Available commands:   bench         Run quick benchmark test   fetch  \n&gt; Fetch a URL using the Scrapy downloader   genspider     Generate new\n&gt; spider using pre-defined templates   runspider     Run a\n&gt; self-contained spider (without creating a project)   settings      Get\n&gt; settings values   shell         Interactive scraping console  \n&gt; startproject  Create new project   version       Print Scrapy version \n&gt; view          Open URL in browser, as seen by Scrapy\n&gt; \n&gt;   [ more ]      More commands available when run from project\n&gt; directory\n&gt; \n&gt; Use \"scrapy &lt;command&gt; -h\" to see more info about a command\n</code></pre>\n\n<p>However if I type in <code>scrapy startproject XXX</code> it shows:</p>\n\n<pre><code>&gt; C:\\Users\\zhang&gt;scrapy startproject Traceback (most recent call last): \n&gt; File \"D:\\Ana\\Scripts\\scrapy-script.py\", line 10, in &lt;module&gt;\n&gt;     sys.exit(execute())   File \"D:\\Ana\\lib\\site-packages\\scrapy\\cmdline.py\", line 149, in execute\n&gt;     cmd.crawler_process = CrawlerProcess(settings)   File \"D:\\Ana\\lib\\site-packages\\scrapy\\crawler.py\", line 254, in __init__\n&gt;     log_scrapy_info(self.settings)   File \"D:\\Ana\\lib\\site-packages\\scrapy\\utils\\log.py\", line 149, in\n&gt; log_scrapy_info\n&gt;     for name, version in scrapy_components_versions()   File \"D:\\Ana\\lib\\site-packages\\scrapy\\utils\\versions.py\", line 35, in\n&gt; scrapy_components_versions\n&gt;     (\"pyOpenSSL\", _get_openssl_version()),   File \"D:\\Ana\\lib\\site-packages\\scrapy\\utils\\versions.py\", line 43, in\n&gt; _get_openssl_version\n&gt;     import OpenSSL   File \"D:\\Ana\\lib\\site-packages\\OpenSSL\\__init__.py\", line 8, in &lt;module&gt;\n&gt;     from OpenSSL import crypto, SSL   File \"D:\\Ana\\lib\\site-packages\\OpenSSL\\crypto.py\", line 16, in &lt;module&gt;\n&gt;     from OpenSSL._util import (   File \"D:\\Ana\\lib\\site-packages\\OpenSSL\\_util.py\", line 6, in &lt;module&gt;\n&gt;     from cryptography.hazmat.bindings.openssl.binding import Binding   File\n&gt; \"D:\\Ana\\lib\\site-packages\\cryptography\\hazmat\\bindings\\openssl\\binding.py\",\n&gt; line 195, in &lt;module&gt;\n&gt;     Binding.init_static_locks()   File \"D:\\Ana\\lib\\site-packages\\cryptography\\hazmat\\bindings\\openssl\\binding.py\",\n&gt; line 142, in init_static_locks\n&gt;     __import__(\"_ssl\") ImportError: DLL load failed: \u627e\u4e0d\u5230\u6307\u5b9a\u7684\u7a0b\u5e8f\u3002(translate: cannot find program)\n</code></pre>\n"}, {"tags": ["python", "pandas", "csv", "numpy", "dataframe"], "comments": [{"owner": {"reputation": 254200, "user_id": 7964527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HPW8R.jpg?s=128&g=1", "display_name": "BENY", "link": "https://stackoverflow.com/users/7964527/beny"}, "edited": false, "score": 0, "creation_date": 1559164173, "post_id": 56368511, "comment_id": 99339888, "body": "did you check with max ?"}, {"owner": {"reputation": 1924, "user_id": 5516874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ioXgB.jpg?s=128&g=1", "display_name": "Jessica", "link": "https://stackoverflow.com/users/5516874/jessica"}, "edited": false, "score": 0, "creation_date": 1559164211, "post_id": 56368511, "comment_id": 99339897, "body": "<a href=\"https://stackoverflow.com/questions/44300989/get-max-value-from-row-of-a-dataframe-in-python\" title=\"get max value from row of a dataframe in python\">stackoverflow.com/questions/44300989/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 447, "user_id": 8921989, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1278814405557809/picture?type=large", "display_name": "Bilgin", "link": "https://stackoverflow.com/users/8921989/bilgin"}, "edited": false, "score": 0, "creation_date": 1559167319, "post_id": 56368593, "comment_id": 99340801, "body": "thank you for your good comment. I am now able to get the highest value found and printed in a new column, but for the second part that you mentioned to use <code>top_prob = df.idxmax(axis=1)</code>, in my case where in my first column is the name of the country (and the column head is unnamed), it is preventing the process and i am getting error as: <code>TypeError: reduction operation &#39;argmax&#39; not allowed for this dtype</code> do you have any suggestion to fix this. thank you"}], "tags": [], "owner": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "is_accepted": false, "score": 2, "last_activity_date": 1559164370, "creation_date": 1559164370, "answer_id": 56368593, "question_id": 56368511, "link": "https://stackoverflow.com/questions/56368511/how-to-find-the-highest-value-of-the-each-row-with-number-of-columns-and-print-t/56368593#56368593", "title": "How to find the highest value of the each row with number of columns and print them?", "body": "<p>Work on <code>axis=1</code> (rows) and assign a new column using <code>max</code></p>\n\n<pre><code>df[\"highest\"] = df.max(axis=1)\n</code></pre>\n\n<p>Using <code>idxmax</code> will tell you <em>where</em> the max lies</p>\n\n<pre><code>top_prob = df.idxmax(axis=1)\n</code></pre>\n"}], "owner": {"reputation": 447, "user_id": 8921989, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1278814405557809/picture?type=large", "display_name": "Bilgin", "link": "https://stackoverflow.com/users/8921989/bilgin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1559164376, "creation_date": 1559163980, "last_edit_date": 1559164279, "question_id": 56368511, "link": "https://stackoverflow.com/questions/56368511/how-to-find-the-highest-value-of-the-each-row-with-number-of-columns-and-print-t", "title": "How to find the highest value of the each row with number of columns and print them?", "body": "<p>I have a csv file that has over 1000 rows and 50 columns. Each row has values (i.e. 0.554562) and each column has the same type of values:</p>\n\n<p>As an example of my csv file ():</p>\n\n<pre><code>       Albany  Ukraine  Germany  Swiss   England\n\nkevin  0.5655  0.5777   0.3232   0.1212  0.9595\n\nbrayan 0.4655  0.2777   0.1232,  0.9212  0.5595\n\nalex   0.1655  0.2777   0.3232   0.1212  0.9795\n\n</code></pre>\n\n<p>Now I want to find the highest values in each row and create new column and added there like:</p>\n\n<pre><code>        Albany Ukraine Germany Swiss  England highest\n\nkevin   0.5655 0.5777  0.3232  0.1212 0.9595  0.9595\n\nbrayan  0.4655 0.2777  0.1232  0.9212 0.5595  0.9212\n\nalex    0.1655 0.2777  0.3232  0.1212 0.9795  0.9795\n\n</code></pre>\n\n<p>I already checked a few posts here such as <a href=\"https://stackoverflow.com/questions/44743512/finding-the-sum-of-each-column-and-combined-them-to-find-the-top-3-highest-value\">1</a> <a href=\"https://stackoverflow.com/questions/41990566/numpy-python-find-the-highest-value-from-a-column-for-each-unique-value-in-anot\">2</a>, but none of them helped me.</p>\n\n<p>It would be great if you can provide your help with code that I can run in my side and learn. Thanks</p>\n\n<p>Addition: Also is there any way to say like Kevin with the highest prob of [0.9595] is belong to England?</p>\n"}, {"tags": ["python", "command-line-interface", "python-click"], "answers": [{"tags": [], "owner": {"reputation": 1728, "user_id": 4967694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6bb32e6094783ec9fc40f63e24ef2b1?s=128&d=identicon&r=PG", "display_name": "djnz", "link": "https://stackoverflow.com/users/4967694/djnz"}, "is_accepted": true, "score": 0, "last_activity_date": 1559172675, "creation_date": 1559172675, "answer_id": 56369795, "question_id": 56368473, "link": "https://stackoverflow.com/questions/56368473/passing-zero-or-variable-number-of-values-to-click-option/56369795#56369795", "title": "Passing zero or variable number of values to Click.Option", "body": "<p>It doesn't appear to be supported, in the way that you want, by Click:</p>\n\n<p>According to the docs <a href=\"https://click.palletsprojects.com/en/7.x/options/#multi-value-options\" rel=\"nofollow noreferrer\">Multi Value Options</a> must have the number of options provided as specified in <code>nargs</code>, so <code>nargs=2</code> requires 2 values.</p>\n\n<p>additionally, <a href=\"https://click.palletsprojects.com/en/7.x/options/#multiple-options\" rel=\"nofollow noreferrer\">multiple options</a> will not negate the need to pass the option multiple times.</p>\n\n<p>Your most likely solution is to pass a string and split, although I haven't used Click too deeply, so someone may have a better solution.</p>\n"}], "owner": {"reputation": 13, "user_id": 11575100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f6988bc2d706cc6677f74103c85d432?s=128&d=identicon&r=PG&f=1", "display_name": "ufg", "link": "https://stackoverflow.com/users/11575100/ufg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "closed_date": 1559174102, "accepted_answer_id": 56369795, "answer_count": 1, "score": 1, "last_activity_date": 1559173227, "creation_date": 1559163799, "last_edit_date": 1559173227, "question_id": 56368473, "link": "https://stackoverflow.com/questions/56368473/passing-zero-or-variable-number-of-values-to-click-option", "closed_reason": "Duplicate", "title": "Passing zero or variable number of values to Click.Option", "body": "<p>Suppose we have the following function, which\nhas an optional parameter <code>exclude</code>, which is expected\nto be a list of strings:</p>\n\n<pre><code>@group.command()\n@click.option(???)\ndef load(exclude = None):\n    # ...\n</code></pre>\n\n<p>I want the user to be able to execute the script like so:</p>\n\n<pre><code>python script.py load --exclude one two three\n</code></pre>\n\n<p>or</p>\n\n<pre><code>python script.py load --exclude something\n</code></pre>\n\n<p>In which case, I would expect <code>exclude</code> to be\n<code>['one', 'two', 'three']</code> and <code>['something']</code>, respectively.\nBut I want the number of values in <code>--exclude</code> to be variable, including 0. I.e. The user should be able to execute</p>\n\n<pre><code>python script.py load\n</code></pre>\n\n<p>In which case <code>exclude</code> should be <code>None</code> (or <code>[]</code>, does not matter).</p>\n\n<p>How can I do that using click?</p>\n\n<p>My only viable option so far is forcing the user to use</p>\n\n<pre><code>python script.py load --exclude \"one two three\"\n</code></pre>\n\n<p>and then calling <code>exclude.split()</code>, but something cleaner would be better.</p>\n"}, {"tags": ["python", "django", "database", "django-models"], "comments": [{"owner": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "edited": false, "score": 0, "creation_date": 1559164118, "post_id": 56368472, "comment_id": 99339869, "body": "Are you creating a short lived one-time-pin?"}, {"owner": {"reputation": 14380, "user_id": 8508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ae2a9b4870d3fb51871eb93b1313beec?s=128&d=identicon&r=PG", "display_name": "Matthew Scouten", "link": "https://stackoverflow.com/users/8508/matthew-scouten"}, "reply_to_user": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "edited": false, "score": 0, "creation_date": 1559164506, "post_id": 56368472, "comment_id": 99339989, "body": "Yes that is the intent. It should not live more then 5-10 minutes, and will be deleted once it is accepted."}, {"owner": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "edited": false, "score": 0, "creation_date": 1559164975, "post_id": 56368472, "comment_id": 99340132, "body": "In that case, try <a href=\"https://github.com/pyauth/pyotp\" rel=\"nofollow noreferrer\">pyotp</a> and you won&#39;t have to worry about entropy etc."}], "owner": {"reputation": 14380, "user_id": 8508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ae2a9b4870d3fb51871eb93b1313beec?s=128&d=identicon&r=PG", "display_name": "Matthew Scouten", "link": "https://stackoverflow.com/users/8508/matthew-scouten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 15, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559163788, "creation_date": 1559163788, "question_id": 56368472, "link": "https://stackoverflow.com/questions/56368472/creating-model-instance-with-a-randomly-generated-human-sized-unique-id", "title": "Creating Model instance with a randomly generated, human sized, unique id", "body": "<p>I need a Model that has a field with a Random, Human-Sized, Unique key. We intend to use this for a human to brain-net the id to another computer and recall the data.</p>\n\n<p>What I have: </p>\n\n<pre><code>def make_code():\n    numbers = \"\".join(random.choice(string.digits) for x in range(4))\n    letters = \"\".join(random.choice(string.ascii_lowercase) for x in range(2))\n    return numbers + letters\n\nclass PinRecord(models.Model):\n    pin = models.CharField(max_length=16, primary_key=True)\n    data = models.TextField(blank=False, null=False)\n    created = models.DateTimeField(auto_now_add=True)\n\n    @classmethod\n    def create_uniq(cls, action, data):\n        created = False\n        while not created:\n            pin, created = cls.objects.get_or_create(pin=make_code(), defaults={'data':data})\n        return pin.pin\n</code></pre>\n\n<p>Is there a better way to do create_uniq? </p>\n\n<p>Right now, there is a small chance that it loops for a long time, especially if the PinRecords don't get cleaned up properly or traffic is higher then expected. An alternate version that limits attempts to a finite number leaves us with nothing to give the user except a middle finger error. </p>\n\n<p>The recommended solution to the Random, Unique key problem seems to be uuid, but the users will object to writing down and retyping a uuid. </p>\n"}, {"tags": ["python", "pygame", "lag", "pygame-clock", "pygame-tick"], "comments": [{"owner": {"reputation": 7155, "user_id": 6486738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10205523648805608/picture?type=large", "display_name": "Ted Klein Bergman", "link": "https://stackoverflow.com/users/6486738/ted-klein-bergman"}, "edited": false, "score": 2, "creation_date": 1559206139, "post_id": 56368464, "comment_id": 99350919, "body": "<code>clock.tick(60)</code> will halt your game to keep a steady 60 FPS. It should only be called once each game loop. My guess is that you have this code in more places which interfere with each other."}, {"owner": {"reputation": 7155, "user_id": 6486738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10205523648805608/picture?type=large", "display_name": "Ted Klein Bergman", "link": "https://stackoverflow.com/users/6486738/ted-klein-bergman"}, "edited": false, "score": 1, "creation_date": 1559206180, "post_id": 56368464, "comment_id": 99350947, "body": "Documentation: <a href=\"https://www.pygame.org/docs/ref/time.html#pygame.time.Clock.tick\" rel=\"nofollow noreferrer\">pygame.org/docs/ref/time.html#pygame.time.Clock.tick</a>"}, {"owner": {"reputation": 87, "user_id": 11436836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/915d47fa54e075481c73fd80d4df1861?s=128&d=identicon&r=PG&f=1", "display_name": "NorwegianNoob", "link": "https://stackoverflow.com/users/11436836/norwegiannoob"}, "reply_to_user": {"reputation": 7155, "user_id": 6486738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10205523648805608/picture?type=large", "display_name": "Ted Klein Bergman", "link": "https://stackoverflow.com/users/6486738/ted-klein-bergman"}, "edited": false, "score": 0, "creation_date": 1559221002, "post_id": 56368464, "comment_id": 99357697, "body": "Thanks! You were right, I had to move clock.tick(60) outside of the function and the lag disappeared  :)"}], "answers": [{"tags": [], "owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": false, "score": 0, "last_activity_date": 1609005100, "creation_date": 1609005100, "answer_id": 65459112, "question_id": 56368464, "link": "https://stackoverflow.com/questions/56368464/pygame-suddenly-lagging-after-adding-a-bit-of-code-but-why/65459112#65459112", "title": "Pygame suddenly lagging after adding a bit of code, but why?", "body": "<p>The method <a href=\"https://www.pygame.org/docs/ref/time.html#pygame.time.Clock.tick\" rel=\"nofollow noreferrer\"><code>tick()</code></a> of a <a href=\"https://www.pygame.org/docs/ref/time.html#pygame.time.Clock\" rel=\"nofollow noreferrer\"><code>pygame.time.Clock</code></a> object, delays the game in that way, that every iteration of the loop consumes the same period of time. See <a href=\"https://www.pygame.org/docs/ref/time.html#pygame.time.Clock.tick\" rel=\"nofollow noreferrer\"><code>pygame.time.Clock.tick()</code></a>:</p>\n<blockquote>\n<p>This method should be called once per frame.</p>\n</blockquote>\n<p>You need to call <code>clock.tick(60)</code> once per frame, not once for each updated object. If you have more than one object, the method will be called more than once per frame and the game slows down as the number of objects increases.</p>\n"}], "owner": {"reputation": 87, "user_id": 11436836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/915d47fa54e075481c73fd80d4df1861?s=128&d=identicon&r=PG&f=1", "display_name": "NorwegianNoob", "link": "https://stackoverflow.com/users/11436836/norwegiannoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1609266076, "creation_date": 1559163739, "last_edit_date": 1609266076, "question_id": 56368464, "link": "https://stackoverflow.com/questions/56368464/pygame-suddenly-lagging-after-adding-a-bit-of-code-but-why", "title": "Pygame suddenly lagging after adding a bit of code, but why?", "body": "<p>I have a game I made with Pygame and I added a \"small\" update to where a sprite changes to another sprite for 80ms when pressing space, this makes the whole game lag (not just when pressing space but all the time). Can anyone help? :)</p>\n\n<p>Here is SOME of the code BEFORE the \"update\":</p>\n\n<p>man.py</p>\n\n<pre><code>class Man(Sprite):\n    def __init__(self, ai_settings, screen):\n        super().__init__()\n        self.screen = screen\n\n        # Load the image of the man and get its rect.\n        self.image = pygame.image.load('images/man_gun_large.bmp')\n        self.rect = self.image.get_rect()\n        self.screen_rect = screen.get_rect()\n\n        # Man firing gun sprite\n        self.fire = pygame.image.load('images/man_gun_large_fire.bmp')\n        self.fire_rect = self.fire.get_rect()\n        self.screen_fire_rect = self.screen.get_rect()\n\n        self.ai_settings = ai_settings\n\n        # Start each new man at the bottom center of the screen.\n        self.rect.centerx = self.screen_rect.centerx\n        self.rect.bottom = self.screen_rect.bottom\n\n        self.fire_rect.centerx = self.screen_rect.centerx\n        self.fire_rect.top = self.screen_rect.bottom\n\n        # Store a decimal value for the man's center.\n        self.center = float(self.rect.centerx)\n\n        # Movement flags\n        self.moving_right = False\n        self.moving_left = False\n\n        self.orientation = False\n\n    def update(self):\n        # Update the man's center value, not the rect\n        if self.moving_right and self.rect.right &lt; self.screen_rect.right:\n            self.center += self.ai_settings.man_speed_factor\n        if self.moving_left and self.rect.left &gt; 0:\n            self.center -= self.ai_settings.man_speed_factor\n\n        # Update rect object from self.center.\n        self.rect.centerx = self.center\n\n    def blitme(self):\n        # Draw sprite\n        self.screen.blit(self.image, self.rect)\n\n        # Flip sprite depending on right/left key\n        if self.orientation == \"Right\":\n            self.screen.blit(self.image, self.rect)\n        elif self.orientation == \"Left\":\n            self.screen.blit(pygame.transform.flip(self.image, True, False), \n            self.rect)\n</code></pre>\n\n<p>game_functions.py</p>\n\n<pre><code>def fire_bullet(ai_settings, bullets, screen, man):\n    # Fire a bullet as long as max bullets is not reached\n    # Create a new bullet and add it to the bullets group.\n    if len(bullets) &lt; ai_settings.bullets_allowed:\n        fire_sound.play()\n        new_bullet = Bullet(ai_settings, screen, man)\n        bullets.add(new_bullet)\n</code></pre>\n\n<p>And here is the same code AFTER the \"update\":</p>\n\n<p>man.py</p>\n\n<pre><code>class Man(Sprite):\n    # --- SNIP ---\n\n        # A field to keep track of timeout\n        self.timeout = 0\n\n    def update(self):\n        # --- SNIP ---\n\n        clock = pygame.time.Clock()\n        dt = clock.tick(60)\n\n        if self.timeout &gt; 0:\n            self.timeout = max(self.timeout - dt, 0)\n\n    def blitme(self):\n        # --- SNIP ---\n\n        # Change into firesprite when pressing space\n        elif self.timeout &gt; 0 and self.orientation == 'Right':\n            self.screen.blit(self.fire, self.rect)\n        elif self.timeout &gt; 0 and self.orientation == 'Left':\n            self.screen.blit(pygame.transform.flip(self.fire, True, False), \n            self.rect)\n</code></pre>\n\n<p>game_functions.py</p>\n\n<pre><code>def fire_bullet(ai_settings, bullets, screen, man):\n    # --- SNIP ---\n        man.timeout = 80\n</code></pre>\n"}, {"tags": ["python", "docker", "kubernetes", "flask-restful", "connection-refused"], "comments": [{"owner": {"reputation": 4058, "user_id": 9928809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e7fd6b31a4a41febaef7ff868edc57?s=128&d=identicon&r=PG&f=1", "display_name": "Nick_Kh", "link": "https://stackoverflow.com/users/9928809/nick-kh"}, "edited": false, "score": 0, "creation_date": 1559293928, "post_id": 56368456, "comment_id": 99382959, "body": "Can you share command output: <code>kubectl describe svc python-app-service</code>?"}, {"owner": {"reputation": 3368, "user_id": 2006347, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b3d72f0aec25b8d154d11dd6e3cd312?s=128&d=identicon&r=PG&f=1", "display_name": "ShadyBears", "link": "https://stackoverflow.com/users/2006347/shadybears"}, "reply_to_user": {"reputation": 4058, "user_id": 9928809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e7fd6b31a4a41febaef7ff868edc57?s=128&d=identicon&r=PG&f=1", "display_name": "Nick_Kh", "link": "https://stackoverflow.com/users/9928809/nick-kh"}, "edited": false, "score": 0, "creation_date": 1559324338, "post_id": 56368456, "comment_id": 99397553, "body": "@mk_sta I added the output at the end of the original post"}, {"owner": {"reputation": 4058, "user_id": 9928809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e7fd6b31a4a41febaef7ff868edc57?s=128&d=identicon&r=PG&f=1", "display_name": "Nick_Kh", "link": "https://stackoverflow.com/users/9928809/nick-kh"}, "edited": false, "score": 0, "creation_date": 1559725141, "post_id": 56368456, "comment_id": 99506503, "body": "Can you reach Pod&#39;s endpoint 10.244.3.24:5000?"}], "answers": [{"tags": [], "owner": {"reputation": 3368, "user_id": 2006347, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b3d72f0aec25b8d154d11dd6e3cd312?s=128&d=identicon&r=PG&f=1", "display_name": "ShadyBears", "link": "https://stackoverflow.com/users/2006347/shadybears"}, "is_accepted": true, "score": 3, "last_activity_date": 1559742869, "creation_date": 1559742869, "answer_id": 56461970, "question_id": 56368456, "link": "https://stackoverflow.com/questions/56368456/python-flask-restful-application-with-kubernetes-connection-refused/56461970#56461970", "title": "Python Flask-Restful application with Kubernetes - Connection refused", "body": "<p>So the reason I was unable to connect was because I never exposed the port in my Dockerfile.</p>\n\n<p>My Dockerfile should have been:</p>\n\n<pre><code>FROM python:3\nWORKDIR  /usr/src/app\nRUN  pip install flask\nRUN  pip install flask_restful\nRUN  pip install jsonpickle\nCOPY  . .\nEXPOSE 5000\nCMD  python restful.py\n</code></pre>\n"}], "owner": {"reputation": 3368, "user_id": 2006347, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b3d72f0aec25b8d154d11dd6e3cd312?s=128&d=identicon&r=PG&f=1", "display_name": "ShadyBears", "link": "https://stackoverflow.com/users/2006347/shadybears"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 899, "favorite_count": 1, "accepted_answer_id": 56461970, "answer_count": 1, "score": 1, "last_activity_date": 1559742869, "creation_date": 1559163705, "last_edit_date": 1559324300, "question_id": 56368456, "link": "https://stackoverflow.com/questions/56368456/python-flask-restful-application-with-kubernetes-connection-refused", "title": "Python Flask-Restful application with Kubernetes - Connection refused", "body": "<p>I first ssh into the Master Node.</p>\n\n<p>When I run <code>kubectl get svc</code></p>\n\n<p>I get the output for NAME, TYPE, CLUSTER-IP, EXTERNAL-IP, PORT(S), AGE:</p>\n\n<pre><code>python-app-service   LoadBalancer   10.110.157.42    &lt;pending&gt;     5000:30008/TCP   68m\n</code></pre>\n\n<p>I then run <code>curl 10.110.157.52:5000</code>\nand I get the following message:</p>\n\n<p><code>curl: (7) Failed connect to 10.110.157.42:5000; Connection refused</code></p>\n\n<p>Below I posted my Dockerfile, deployment file, service file, and python application file. When I run the docker image, it works fine. However when I try to apply a Kubernetes service to the pod, I am unable to make calls. What am I doing wrong? Also please let me know if I left out any necessary information. Thank you!</p>\n\n<p>Kubernetes was created with KubeAdm using Flannel CNI</p>\n\n<p>Deployment yaml file:</p>\n\n<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: python-api\n  labels:\n    app: my-python-app\n    type: back-end\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: my-python-app\n      type: backend\n  template:\n    metadata:\n      name: python-api-pod\n      labels:\n        app: my-python-app\n        type: backend\n    spec:\n      containers:\n      - name: restful-python-example\n        image: mydockerhub/restful-python-example\n        ports:\n        - containerPort: 5000\n</code></pre>\n\n<p>Service yaml file:</p>\n\n<pre><code>apiVersion: v1\nkind: Service\nmetadata:\n  name: python-app-service\nspec:\n  type: LoadBalancer\n  ports:\n  - port: 5000\n    targetPort: 5000\n    nodePort: 30008\n  selector:\n    app: my-python-app\n    type: backend\n</code></pre>\n\n<p>Python application source - restful.py:</p>\n\n<pre><code>#!/usr/bin/python3\n\nfrom flask import Flask, jsonify, request, abort\nfrom flask_restful import Api, Resource\nimport jsonpickle\n\napp = Flask(__name__)\napi = Api(app)\n\n# Creating an empty dictionary and initializing user id to 0.. will increment every time a person makes a POST request.\n# This is bad practice but only using it for the example. Most likely you will be pulling this information from a\n# database.\nuser_dict = {}\nuser_id = 0\n\n\n# Define a class and pass it a Resource. These methods require an ID\nclass User(Resource):\n    @staticmethod\n    def get(path_user_id):\n        if path_user_id not in user_dict:\n            abort(400)\n\n        return jsonify(jsonpickle.encode(user_dict.get(path_user_id, \"This user does not exist\")))\n\n    @staticmethod\n    def put(path_user_id):\n        update_and_add_user_helper(path_user_id, request.get_json())\n\n    @staticmethod\n    def delete(path_user_id):\n        user_dict.pop(path_user_id, None)\n\n\n# Get all users and add new users\nclass UserList(Resource):\n    @staticmethod\n    def get():\n        return jsonify(jsonpickle.encode(user_dict))\n\n    @staticmethod\n    def post():\n        global user_id\n        user_id = user_id + 1\n        update_and_add_user_helper(user_id, request.get_json())\n\n\n# Since post and put are doing pretty much the same thing, I extracted the logic from both and put it in a separate\n# method to follow DRY principles.\ndef update_and_add_user_helper(u_id, request_payload):\n    name = request_payload[\"name\"]\n    age = request_payload[\"age\"]\n    address = request_payload[\"address\"]\n    city = request_payload[\"city\"]\n    state = request_payload[\"state\"]\n    zip_code = request_payload[\"zip\"]\n    user_dict[u_id] = Person(name, age, address, city, state, zip_code)\n\n\n# Represents a user's information\nclass Person:\n    def __init__(self, name, age, address, city, state, zip_code):\n        self.name = name\n        self.age = age\n        self.address = address\n        self.city = city\n        self.state = state\n        self.zip_code = zip_code\n\n\n# Add a resource to the api. You need to give the class name and the URI.\napi.add_resource(User, \"/users/&lt;int:path_user_id&gt;\")\napi.add_resource(UserList, \"/users\")\n\nif __name__ == \"__main__\":\n    app.run()\n</code></pre>\n\n<p>Dockerfile:</p>\n\n<pre><code>FROM python:3\nWORKDIR  /usr/src/app\nRUN  pip install flask\nRUN  pip install flask_restful\nRUN  pip install jsonpickle\nCOPY  . .\nCMD  python restful.py\n</code></pre>\n\n<p><code>kubectl describe svc python-app-service</code></p>\n\n<pre><code>Name:                     python-app-service\nNamespace:                default\nLabels:                   &lt;none&gt;\nAnnotations:              &lt;none&gt;\nSelector:                 app=my-python-app,type=backend\nType:                     LoadBalancer\nIP:                       10.110.157.42\nPort:                     &lt;unset&gt;  5000/TCP\nTargetPort:               5000/TCP\nNodePort:                 &lt;unset&gt;  30008/TCP\nEndpoints:                10.244.3.24:5000\nSession Affinity:         None\nExternal Traffic Policy:  Cluster\nEvents:                   &lt;none&gt;\n</code></pre>\n"}, {"tags": ["python", "pandas", "matplotlib"], "answers": [{"comments": [{"owner": {"reputation": 404, "user_id": 8315879, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7c9fd6231001a4615cfb153d20e7917b?s=128&d=identicon&r=PG&f=1", "display_name": "Bn.F76", "link": "https://stackoverflow.com/users/8315879/bn-f76"}, "edited": false, "score": 0, "creation_date": 1559164939, "post_id": 56368605, "comment_id": 99340119, "body": "Unfortunately for some weeks there is no data for certain hours so the index approach is not exact / robust."}, {"owner": {"reputation": 74, "user_id": 4730972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2f2fef633aaa372cf31437cd33bcc35?s=128&d=identicon&r=PG&f=1", "display_name": "Teuszie", "link": "https://stackoverflow.com/users/4730972/teuszie"}, "reply_to_user": {"reputation": 404, "user_id": 8315879, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7c9fd6231001a4615cfb153d20e7917b?s=128&d=identicon&r=PG&f=1", "display_name": "Bn.F76", "link": "https://stackoverflow.com/users/8315879/bn-f76"}, "edited": false, "score": 0, "creation_date": 1559221568, "post_id": 56368605, "comment_id": 99357996, "body": "So then yeah you need to reformat your data as the other answer mentioned. Working with separate columns for hours, days, months, etc. is no bueno and you ought to concatenate them into a datetime object."}], "tags": [], "owner": {"reputation": 74, "user_id": 4730972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2f2fef633aaa372cf31437cd33bcc35?s=128&d=identicon&r=PG&f=1", "display_name": "Teuszie", "link": "https://stackoverflow.com/users/4730972/teuszie"}, "is_accepted": false, "score": 1, "last_activity_date": 1559164409, "creation_date": 1559164409, "answer_id": 56368605, "question_id": 56368411, "link": "https://stackoverflow.com/questions/56368411/how-to-plot-data-per-hour-grouped-by-days/56368605#56368605", "title": "How to plot data per hour, grouped by days?", "body": "<p>Assuming your data is ordered by index (e.g., 0 - 24 is day 3, 25 - 48 is day 4, etc.) you can plot the index values rather than hours in your code:</p>\n\n<pre><code>ax1.plot(data.index.values, df.Casual, color='g')\nax1.plot(data.index.values, df.Registered, color='b')\n</code></pre>\n\n<p>This will yield a graph similar to what you're looking for as an end product (note I used fake data):</p>\n\n<p><a href=\"https://i.stack.imgur.com/jXBTl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jXBTl.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 404, "user_id": 8315879, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7c9fd6231001a4615cfb153d20e7917b?s=128&d=identicon&r=PG&f=1", "display_name": "Bn.F76", "link": "https://stackoverflow.com/users/8315879/bn-f76"}, "edited": false, "score": 0, "creation_date": 1559222946, "post_id": 56378328, "comment_id": 99358760, "body": "Yes the <code>DataFrame</code> (already holding values for &#39;13 June 3-9) has a <code>datetime</code> variable <code>s_datetime</code> and I did: <code>data = df.groupby([df[&#39;s_timedate&#39;].dt.day, df[&#39;s_timedate&#39;].dt.hour, df.user_type]).agg({&#39;hubway_id&#39;:&#39;count&#39;})</code> to get the count per day &amp; hour. But if I understand correctly I should get the count keeping the datetime variable having columns: <code>date_time</code>, <code>Casual</code>, <code>Registered</code> ?"}, {"owner": {"reputation": 1780, "user_id": 9161389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wgvbi.png?s=128&g=1", "display_name": "Lante Dellarovere", "link": "https://stackoverflow.com/users/9161389/lante-dellarovere"}, "reply_to_user": {"reputation": 404, "user_id": 8315879, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7c9fd6231001a4615cfb153d20e7917b?s=128&d=identicon&r=PG&f=1", "display_name": "Bn.F76", "link": "https://stackoverflow.com/users/8315879/bn-f76"}, "edited": false, "score": 1, "creation_date": 1559223777, "post_id": 56378328, "comment_id": 99359262, "body": "@Bn.F76  Yes, you should keep datetime variable. In order to achieve a time grouping, you could also use pandas <code>resample</code>. Look for example at this question <a href=\"https://stackoverflow.com/questions/49344899/resample-dataframe-for-every-hour\" title=\"resample dataframe for every hour\">stackoverflow.com/questions/49344899/&hellip;</a>"}, {"owner": {"reputation": 404, "user_id": 8315879, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7c9fd6231001a4615cfb153d20e7917b?s=128&d=identicon&r=PG&f=1", "display_name": "Bn.F76", "link": "https://stackoverflow.com/users/8315879/bn-f76"}, "edited": false, "score": 0, "creation_date": 1559228453, "post_id": 56378328, "comment_id": 99361779, "body": "Thank you! Last thing, what does <code>mdates.DateFormatter(&quot;\\n\\n%A&quot;)</code>  mean ? I know <code>%H</code> gets hour,  <code>%Y</code> year, etc. but I don&#39;t understand your expression and I want to play around so I get ticks for every hour within the 24h window"}, {"owner": {"reputation": 1780, "user_id": 9161389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wgvbi.png?s=128&g=1", "display_name": "Lante Dellarovere", "link": "https://stackoverflow.com/users/9161389/lante-dellarovere"}, "reply_to_user": {"reputation": 404, "user_id": 8315879, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7c9fd6231001a4615cfb153d20e7917b?s=128&d=identicon&r=PG&f=1", "display_name": "Bn.F76", "link": "https://stackoverflow.com/users/8315879/bn-f76"}, "edited": false, "score": 1, "creation_date": 1559230289, "post_id": 56378328, "comment_id": 99362780, "body": "@Bn.F76 in <code>&quot;\\n\\n%A&quot;</code>, <code>\\n\\n</code> simply put weekdays two lines below hour ticks, while <code>%A</code>  gets &quot;Weekday as locale\u2019s full name&quot;. Look at <a href=\"http://strftime.org/\" rel=\"nofollow noreferrer\">strftime.org</a>"}], "tags": [], "owner": {"reputation": 1780, "user_id": 9161389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wgvbi.png?s=128&g=1", "display_name": "Lante Dellarovere", "link": "https://stackoverflow.com/users/9161389/lante-dellarovere"}, "is_accepted": true, "score": 4, "last_activity_date": 1559219246, "creation_date": 1559219246, "answer_id": 56378328, "question_id": 56368411, "link": "https://stackoverflow.com/questions/56368411/how-to-plot-data-per-hour-grouped-by-days/56378328#56378328", "title": "How to plot data per hour, grouped by days?", "body": "<p>I think this should be easier if you work on <code>datetime</code> objects rather than <code>Day</code>, <code>Hour</code> strings.<br>\nThis way, you'll be able to use <a href=\"https://matplotlib.org/3.1.0/gallery/text_labels_and_annotations/date.html\" rel=\"nofollow noreferrer\">date tick locators and formatters</a>\n along with <a href=\"https://matplotlib.org/3.1.0/gallery/ticks_and_spines/major_minor_demo.html\" rel=\"nofollow noreferrer\">major and minor ticks</a>.  </p>\n\n<p>Even if you didn't mention it, I assume you can use <code>pandas</code> to deal with dataframes.<br>\nI created a new dataframe by copying many times data you provided and cutting some of them (this is not so important).<br>\nHere I rebuilt dates from infos you provided, but I suggest to work directly on them (I suppose the original dataframe has some kind of date-like field in it).</p>\n\n<pre><code>import pandas as pd\nimport matplotlib.pyplot as plt \nimport matplotlib.dates as mdates\n\ndf = pd.read_csv(\"mydataframe.csv\")\ndf[\"timestamp\"] = \"2013-06-\" + df[\"Day\"].astype(str).str.zfill(2) + \"-\" + df[\"Hour\"].astype(str).str.zfill(2)\ndf[\"timestamp\"] = pd.to_datetime(df[\"timestamp\"], format=\"%Y-%m-%d-%H\")\n\n\nfig, ax1 = plt.subplots(figsize=(10, 5))\nax1.set(xlabel='', ylabel='Total # of trips started')\nax1.plot(df[\"timestamp\"], df.Casual, color='g')\nax1.plot(df[\"timestamp\"], df.Registered, color='b')\n\nax1.xaxis.set(\n    major_locator=mdates.DayLocator(),\n    major_formatter=mdates.DateFormatter(\"\\n\\n%A\"),\n    minor_locator=mdates.HourLocator((0, 12)),\n    minor_formatter=mdates.DateFormatter(\"%H\"),\n)\nplt.show()\n</code></pre>\n\n<p>Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/c42Lz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c42Lz.png\" alt=\"formatted dataframe\"></a></p>\n"}], "owner": {"reputation": 404, "user_id": 8315879, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7c9fd6231001a4615cfb153d20e7917b?s=128&d=identicon&r=PG&f=1", "display_name": "Bn.F76", "link": "https://stackoverflow.com/users/8315879/bn-f76"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3748, "favorite_count": 2, "accepted_answer_id": 56378328, "answer_count": 2, "score": 1, "last_activity_date": 1559221093, "creation_date": 1559163472, "last_edit_date": 1559221093, "question_id": 56368411, "link": "https://stackoverflow.com/questions/56368411/how-to-plot-data-per-hour-grouped-by-days", "title": "How to plot data per hour, grouped by days?", "body": "<p>Background: from a large <code>DataFrame</code> I filtered out entries for <code>year=2013</code>, <code>month=June</code>, week of the 3rd - 9th (Monday to Sunday). Then, I grouped the data by <code>day</code>, <code>hour</code>, and <code>user_type</code>, and pivoted the table to get a <code>DataFrame</code> which looks like:</p>\n\n<pre><code>   Day  Hour  Casual  Registered  Casual_percentage\n0  3    0     14      19          42.42\n1  3    1     8       8           50.00\n2  3    2     1       3           25.00\n3  3    3     2       1           66.67\n4  3    4     1       3           25.00\n5  3    5     1       17          5.56\n.  .    .     .       .           .\n</code></pre>\n\n<p>For each day I have 24 hours so for day 4 (Tuesday), the data starts like:</p>\n\n<pre><code>.  .    .     .       .           .  \n21 3    21    32      88          26.67\n22 3    22    26      64          28.89\n23 3    23    23      30          43.40\n24 4    0     10      11          47.62\n25 4    1     1       5           16.67\n26 4    2     1       1           50.00\n.  .    .     .       .           .\n</code></pre>\n\n<p>How can I plot <code>Casual</code> and <code>Registered</code> variables per <code>Hour</code>, for each of the 7 <code>Day</code>s? Would I need to create 7 different plots and align them in 1 figure?</p>\n\n<p>Current code. I feel I'm way off. I also tried to create a <a href=\"https://matplotlib.org/examples/pylab_examples/multiple_yaxis_with_spines.html\" rel=\"nofollow noreferrer\">second x-axis</a> (for <code>Days</code>) using the <a href=\"https://matplotlib.org/gallery/api/two_scales.html\" rel=\"nofollow noreferrer\">documentation</a>.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>def make_patch_spines_invisible(ax):\n    ax.set_frame_on(True)\n    ax.patch.set_visible(False)\n    for sp in ax.spines.values():\n        sp.set_visible(False)\n\nfig, ax1 = plt.subplots(figsize=(10, 5))\nax1.set(xlabel='Hours', ylabel='Total # of trips started')\n\nax1.plot(data.Hour, data.Casual, color='g')\nax1.plot(data.Hour, data.Registered, color='b')\n\n\n\"\"\"This part is trying to create the 2nd x-axis (Days)\"\"\"\nax2 = ax1.twinx()\n#offset the bottom spine\nax2.spines['bottom'].set_position(('axes', -.5))\nmake_patch_spines_invisible(ax2)\n#show bottomm spine\nax2.spines['bottom'].set_visible(True)\nax2.set_xlabel(\"Days\")\n\n\nplt.show()\n</code></pre>\n\n<p>Output:\n<a href=\"https://i.stack.imgur.com/KsiK6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KsiK6.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://imgur.com/a/qi2rjln\" rel=\"nofollow noreferrer\">End goal</a></p>\n"}, {"tags": ["python", "pandas"], "comments": [{"owner": {"reputation": 970, "user_id": 10620028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76e9c6ed74b548534059fec223fcc94?s=128&d=identicon&r=PG&f=1", "display_name": "iamchoosinganame", "link": "https://stackoverflow.com/users/10620028/iamchoosinganame"}, "edited": false, "score": 0, "creation_date": 1559163547, "post_id": 56368397, "comment_id": 99339685, "body": "You want to check the column names, which you can access with <code>df.columns</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1415, "user_id": 2314391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7e52c232ca81d0d7bf28f2609e15d1?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/2314391/will"}, "is_accepted": false, "score": 0, "last_activity_date": 1559163776, "creation_date": 1559163776, "answer_id": 56368469, "question_id": 56368397, "link": "https://stackoverflow.com/questions/56368397/python-pandas-series-str-contains/56368469#56368469", "title": "Python Pandas Series.str.contains", "body": "<p>Work on the columns of the dataframe.</p>\n\n<pre><code>mask = df.columns.isin(['OAT', 'MAT', 'RAT'])\n</code></pre>\n\n<p><code>mask</code> is now a boolean <code>numpy.ndarray</code> with <code>True</code> for any column position \nthat matches your 'isin' list.</p>\n"}, {"tags": [], "owner": {"reputation": 758, "user_id": 4168399, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c51d6c4473126f12ad667d0dc76793b5?s=128&d=identicon&r=PG&f=1", "display_name": "kudeh", "link": "https://stackoverflow.com/users/4168399/kudeh"}, "is_accepted": true, "score": 0, "last_activity_date": 1559164212, "last_edit_date": 1559164212, "creation_date": 1559163811, "answer_id": 56368476, "question_id": 56368397, "link": "https://stackoverflow.com/questions/56368397/python-pandas-series-str-contains/56368476#56368476", "title": "Python Pandas Series.str.contains", "body": "<p>You can use the <code>issubset</code> method to return boolean if <code>['OAT', 'MAT', 'RAT']</code> is in the dataframe's columns: </p>\n\n<pre><code>expected = set(['OAT', 'MAT', 'RAT'])\nprint(expected.issubset(df.columns))\n</code></pre>\n"}], "owner": {"reputation": 2015, "user_id": 8372455, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7937214051961aa38cd1b42a16a599d0?s=128&d=identicon&r=PG&f=1", "display_name": "HenryHub", "link": "https://stackoverflow.com/users/8372455/henryhub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 56368476, "answer_count": 2, "score": 0, "last_activity_date": 1559164212, "creation_date": 1559163426, "question_id": 56368397, "link": "https://stackoverflow.com/questions/56368397/python-pandas-series-str-contains", "title": "Python Pandas Series.str.contains", "body": "<p>I have some data that looks like this in a CSV file:\n<a href=\"https://i.stack.imgur.com/Kxphm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kxphm.png\" alt=\"enter image description here\"></a></p>\n\n<p>Is it possible to print a Boolean statement if the <strong><em>dataframe columns names</em></strong> are <code>MAT</code> and <code>OAT</code> and <code>RAT</code>?</p>\n\n<p>Is pandas series needed for this? Like <a href=\"https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.contains.html\" rel=\"nofollow noreferrer\">Series.str.contains</a>?</p>\n\n<pre><code>import pandas as pd\n\n\ndf = pd.read_csv('static/data.csv')\n\n\n#OAT = pd.Series(df['OAT'])\n#RAT = pd.Series(df['RAT'])\n#MAT = pd.Series(df['MAT'])\n\ndfS = pd.Series(df)\n\nprint(dfS.str.contains('OAT', 'MAT', 'RAT'))\n</code></pre>\n"}, {"tags": ["python", "tkinter", "pack"], "comments": [{"owner": {"reputation": 305939, "user_id": 7432, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3e3921ee8a7792e4b5da0244933395e8?s=128&d=identicon&r=PG", "display_name": "Bryan Oakley", "link": "https://stackoverflow.com/users/7432/bryan-oakley"}, "edited": false, "score": 0, "creation_date": 1559186810, "post_id": 56368391, "comment_id": 99344743, "body": "Are you expecting to be able to see the canvas? You&#39;ve made the frame fill the window, so there&#39;s no visible room for the canvas."}, {"owner": {"reputation": 21, "user_id": 11575106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508e66fdf5d5b51ddb1a50236ea308d4?s=128&d=identicon&r=PG&f=1", "display_name": "topik53", "link": "https://stackoverflow.com/users/11575106/topik53"}, "reply_to_user": {"reputation": 305939, "user_id": 7432, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3e3921ee8a7792e4b5da0244933395e8?s=128&d=identicon&r=PG", "display_name": "Bryan Oakley", "link": "https://stackoverflow.com/users/7432/bryan-oakley"}, "edited": false, "score": 0, "creation_date": 1559203069, "post_id": 56368391, "comment_id": 99349671, "body": "So how can i make canvas visible, who is capturing events?"}, {"owner": {"reputation": 305939, "user_id": 7432, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3e3921ee8a7792e4b5da0244933395e8?s=128&d=identicon&r=PG", "display_name": "Bryan Oakley", "link": "https://stackoverflow.com/users/7432/bryan-oakley"}, "edited": false, "score": 0, "creation_date": 1559221486, "post_id": 56368391, "comment_id": 99357941, "body": "That question has many answers. Where do you want it to be? You&#39;ve explicitly put it below the bottom of the window."}], "owner": {"reputation": 21, "user_id": 11575106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508e66fdf5d5b51ddb1a50236ea308d4?s=128&d=identicon&r=PG&f=1", "display_name": "topik53", "link": "https://stackoverflow.com/users/11575106/topik53"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559166554, "creation_date": 1559163394, "question_id": 56368391, "link": "https://stackoverflow.com/questions/56368391/canvas-is-not-packing-while-i-want-to-pack-frame", "title": "Canvas is not packing while i want to pack frame", "body": "<p>Im trying to create reactangle which is resizable. Everything is good since im adding frame.pack() to capture actual coords. When i doing it canvas just disappearing.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import tkinter as tk\n\n\nclass NetBuilder(object):\n    root = None\n    canvas = None\n    frame = None\n    resolution_height = 0\n    resolution_width = 0\n    reactangles = [\n        [\"statusBar\", 40, 50, 60, 70],\n    ]\n    def on_key_pressed(self, event):\n        print(event.x)\n        print(event.y)\n    def __init__(self):\n        self.root = tk.Tk()\n        self.resolution_height = self.root.winfo_screenheight()\n        self.resolution_width = self.root.winfo_screenwidth()\n        resolution_for_geometry = str(self.resolution_width) + \"x\" + str(self.resolution_height)\n        self.root.geometry(resolution_for_geometry)\n        self.canvas = tk.Canvas(self.root, width=self.resolution_width, height=self.resolution_height)\n        self.frame = tk.Frame(self.root,width=self.resolution_width, height=self.resolution_height)\n        self.frame.bind(\"&lt;Button-1&gt;\", self.on_key_pressed)\n        self.frame.pack()\n\n\n    def net_creating(self):\n        for x in self.reactangles:\n            self.canvas.create_rectangle(x[1], x[2], x[3], x[4])\n            self.canvas.create_oval(x[1]- 2, x[2] - 2, x[1] + 2, x[2] + 2, outline=\"#f00\", fill=\"#f00\", width=1)    #Left-Top-Corner\n            self.canvas.create_oval(x[3] - 2, x[4] - 2, x[3] + 2, x[4] + 2, outline=\"#f00\", fill=\"#f00\", width=1)   #Right-Bottom-Corner\n            self.canvas.create_oval(x[1] + 2, x[4] + 2, x[1] - 2, x[4] - 2, outline=\"#f00\", fill=\"#f00\", width=1)   #Left-Bottom-Corner\n            self.canvas.create_oval(x[3] - 2, x[2] - 2, x[3] + 2, x[2] + 2, outline=\"#f00\", fill=\"#f00\", width=1)\n\n        self.canvas.pack()\n\n\n\n\nif __name__ == '__main__':\n    x = NetBuilder()\n\n    x.net_creating()\n    x.root.mainloop()\n</code></pre>\n\n<p>And when i'm not packing canvas capturing point is working fine.</p>\n"}, {"tags": ["python", "matplotlib", "random", "plot", "random-walk"], "comments": [{"owner": {"reputation": 970, "user_id": 10620028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76e9c6ed74b548534059fec223fcc94?s=128&d=identicon&r=PG&f=1", "display_name": "iamchoosinganame", "link": "https://stackoverflow.com/users/10620028/iamchoosinganame"}, "edited": false, "score": 0, "creation_date": 1559163831, "post_id": 56368355, "comment_id": 99339777, "body": "It&#39;s probably not the plotting that&#39;s slow. It&#39;s most likely the loops."}, {"owner": {"reputation": 1160, "user_id": 11542188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6274585f76bff6b24e744a25dfa4f30?s=128&d=identicon&r=PG&f=1", "display_name": "Masoud", "link": "https://stackoverflow.com/users/11542188/masoud"}, "edited": false, "score": 0, "creation_date": 1559163999, "post_id": 56368355, "comment_id": 99339840, "body": "there&#39;s a good documentation here: <a href=\"https://bastibe.de/2013-05-30-speeding-up-matplotlib.html\" rel=\"nofollow noreferrer\">bastibe.de/2013-05-30-speeding-up-matplotlib.html</a>"}, {"owner": {"reputation": 2221, "user_id": 3394386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36befa47364f055cb5980fc4e14b7a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jody Klymak", "link": "https://stackoverflow.com/users/3394386/jody-klymak"}, "edited": false, "score": 0, "creation_date": 1559225119, "post_id": 56368355, "comment_id": 99360001, "body": "Ok well you are calling contour 1000 times.  That will definitely be slow. It\u2019s unclear why you are calling contour 1000 times."}, {"owner": {"reputation": 13, "user_id": 11535582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c04af0d9bfee35ef3d96c2a976a4ce7d?s=128&d=identicon&r=PG&f=1", "display_name": "padar", "link": "https://stackoverflow.com/users/11535582/padar"}, "reply_to_user": {"reputation": 2221, "user_id": 3394386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36befa47364f055cb5980fc4e14b7a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jody Klymak", "link": "https://stackoverflow.com/users/3394386/jody-klymak"}, "edited": false, "score": 0, "creation_date": 1559225349, "post_id": 56368355, "comment_id": 99360119, "body": "@JodyKlymak because I want to see what the area was in each point"}, {"owner": {"reputation": 2221, "user_id": 3394386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36befa47364f055cb5980fc4e14b7a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jody Klymak", "link": "https://stackoverflow.com/users/3394386/jody-klymak"}, "edited": false, "score": 0, "creation_date": 1559225448, "post_id": 56368355, "comment_id": 99360162, "body": "Can you link an image to what you are trying to do?"}, {"owner": {"reputation": 13, "user_id": 11535582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c04af0d9bfee35ef3d96c2a976a4ce7d?s=128&d=identicon&r=PG&f=1", "display_name": "padar", "link": "https://stackoverflow.com/users/11535582/padar"}, "reply_to_user": {"reputation": 2221, "user_id": 3394386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36befa47364f055cb5980fc4e14b7a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jody Klymak", "link": "https://stackoverflow.com/users/3394386/jody-klymak"}, "edited": false, "score": 0, "creation_date": 1559227153, "post_id": 56368355, "comment_id": 99361070, "body": "@JodyKlymak here is what I&#39;m trying to do: <a href=\"https://imgur.com/a/JXdnZB8\" rel=\"nofollow noreferrer\">imgur.com/a/JXdnZB8</a>"}, {"owner": {"reputation": 2221, "user_id": 3394386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36befa47364f055cb5980fc4e14b7a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jody Klymak", "link": "https://stackoverflow.com/users/3394386/jody-klymak"}, "edited": false, "score": 0, "creation_date": 1559229744, "post_id": 56368355, "comment_id": 99362470, "body": "The image on Imagur is just a maroon color in an axes..."}, {"owner": {"reputation": 13, "user_id": 11535582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c04af0d9bfee35ef3d96c2a976a4ce7d?s=128&d=identicon&r=PG&f=1", "display_name": "padar", "link": "https://stackoverflow.com/users/11535582/padar"}, "reply_to_user": {"reputation": 2221, "user_id": 3394386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36befa47364f055cb5980fc4e14b7a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jody Klymak", "link": "https://stackoverflow.com/users/3394386/jody-klymak"}, "edited": false, "score": 0, "creation_date": 1559230113, "post_id": 56368355, "comment_id": 99362690, "body": "@JodyKlymak here you have more zoomed version: <a href=\"https://imgur.com/a/YTmj7vL\" rel=\"nofollow noreferrer\">imgur.com/a/YTmj7vL</a>"}, {"owner": {"reputation": 2221, "user_id": 3394386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36befa47364f055cb5980fc4e14b7a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jody Klymak", "link": "https://stackoverflow.com/users/3394386/jody-klymak"}, "edited": false, "score": 0, "creation_date": 1559231609, "post_id": 56368355, "comment_id": 99363514, "body": "I don&#39;t know what you think you can see w/ that contour; its just a mess to me. Doing 1000 of them will definitely take some time.  Suggest you come up w/ a visualization that doesn&#39;t require so many contours.  Its not like its hard for a viewer to gauge the distance from a point."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11535582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c04af0d9bfee35ef3d96c2a976a4ce7d?s=128&d=identicon&r=PG&f=1", "display_name": "padar", "link": "https://stackoverflow.com/users/11535582/padar"}, "edited": false, "score": 0, "creation_date": 1559166237, "post_id": 56368480, "comment_id": 99340481, "body": "Despite the changes, it still needs a while to draw it. I think main problem is in this loop: <code>python  for i in range(len(Z)):     ax.contourf(X, Y, Z[i], 20, cmap=&#39;RdGy&#39;, alpha=0.01) </code> but I don&#39;t know how I can write it different."}], "tags": [], "owner": {"reputation": 2221, "user_id": 3394386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36befa47364f055cb5980fc4e14b7a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jody Klymak", "link": "https://stackoverflow.com/users/3394386/jody-klymak"}, "is_accepted": true, "score": 0, "last_activity_date": 1559163832, "creation_date": 1559163832, "answer_id": 56368480, "question_id": 56368355, "link": "https://stackoverflow.com/questions/56368355/how-to-speed-up-drawing-plots-in-matplotlib/56368480#56368480", "title": "How to speed up drawing plots in Matplotlib?", "body": "<p>You should try to avoid the loops by learning to use the appropriate numpy functions.   i.e. something like the below will be much faster:</p>\n\n<pre><code>dx = np.random.randn(100)\ndy = np.random.randn(100)\nx = np.cumsum(dx)\ny = np.cumsum(dy)\n</code></pre>\n\n<p>If you <em>really</em> need the for-loop, preallocate your array; don't keep appending:</p>\n\n<pre><code>x = np.zeros(100)\ny = np.zeros(100)\nfor i in range(1, 100):\n    x[i] = x[i-1] + np.random.randn()\n    y[i] = y[i-1] + np.random.randn()\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11535582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c04af0d9bfee35ef3d96c2a976a4ce7d?s=128&d=identicon&r=PG&f=1", "display_name": "padar", "link": "https://stackoverflow.com/users/11535582/padar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 56368480, "answer_count": 1, "score": 0, "last_activity_date": 1559204805, "creation_date": 1559163209, "last_edit_date": 1559204805, "question_id": 56368355, "link": "https://stackoverflow.com/questions/56368355/how-to-speed-up-drawing-plots-in-matplotlib", "title": "How to speed up drawing plots in Matplotlib?", "body": "<p>I'm playing with random walk, I have two points. First one is walking randomly, second one is trying to escape from his area, which is given by formula e^(-t), where t is the distance between the two points. In my opinion it is not a difficult program, but it takes about a minute to run it with hundred points to calculate, so I'm asking you to help me find some way to speed it up and explain it to me.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import numpy as np\nimport matplotlib.pyplot as plt\n\n\ndef f(x, y, zx, zy):\n    return np.exp(-np.sqrt((x-zx)**2+(y-zy)**2))\n\n\nx = y = np.linspace(-100, 100, 1000)\nX, Y = np.meshgrid(x, y)\n\nfig, ax = plt.subplots(1, 1, figsize=(12, 6))\n#random picking first location for two points\nloksx = [np.random.randn(), ]\nloksy = [np.random.randn(), ]\nlokzx = [np.random.randn(), ]\nlokzy = [np.random.randn(), ]\nfor i in range(100):\n    lokzx.append(np.random.randn()+lokzx[-1])\n    lokzy.append(np.random.randn()+lokzy[-1])\n    nsx = np.random.randn()\n    nsy = np.random.randn()\n    #checking if the next step has smaller value than the last one \n    if f(loksx[-1]+nsx, loksy[-1]+nsy, lokzx[-1], lokzy[-1]) &lt; f(loksx[-1], loksy[-1], lokzx[-1], lokzy[-1]):\n        loksx.append(nsx+loksx[-1])\n        loksy.append(nsy+loksy[-1])\nZ = []\nfor i in range(len(lokzx)):\n    Z.append(f(X, Y, lokzx[i], lokzy[i]))\nax.plot(lokzx[0], lokzy[0], 'y,',markersize=1)\nax.plot(loksx[0], loksy[0], 'w,', markersize=1)\nax.plot(lokzx[1:-1], lokzy[1:-1], 'g,',markersize=1)\nax.plot(loksx[1:-1], loksy[1:-1], 'b,', markersize=1)\n\nax.plot(loksx[-1], loksy[-1], 'k,', markersize=1)\nax.plot(lokzx[-1], lokzy[-1], 'r,',markersize=1)\nfor i in range(len(Z)):\n    ax.contourf(X, Y, Z[i], 20, cmap='RdGy', alpha=0.01)\nax.plot()\nax.set_aspect('equal')\nplt.show()\n</code></pre>\n\n<p>@edit \nNow instead of using lists I'm using nparrays:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import numpy as np\nimport matplotlib.pyplot as plt\n\n\ndef f(x, y, zx, zy):\n    return np.exp(-np.sqrt((x-zx)**2+(y-zy)**2))\n\n\nx = y = np.linspace(-100, 100, 1000)\nX, Y = np.meshgrid(x, y)\n\nfig, ax = plt.subplots(1, 1, figsize=(12, 6))\nlokzx = np.random.randn(100)\nlokzy = np.random.randn(100)\nloksx = np.zeros(100)\nloksy = np.zeros(100)\nfor i in range(1,100):\n    nsx = np.random.randn()\n    nsy = np.random.randn()\n    if f(loksx[i-1]+nsx, loksy[i-1]+nsy, lokzx[i-1], lokzy[i-1]) &lt; f(loksx[i-1], loksy[i-1], lokzx[i-1], lokzy[i-1]):\n        loksx[i] = loksx[i-1]+nsx\n        loksy[i] = loksy[i-1]+nsy\n    else:\n        loksx[i] = loksx[i-1]\n        loksy[i] = loksy[i-1]\nZ = np.zeros((100,1000,1000))\nfor i in range(len(lokzx)):\n    Z[i] = f(X, Y, lokzx[i], lokzy[i])\n\nax.plot(lokzx[0], lokzy[0], 'y,',markersize=1)\nax.plot(loksx[0], loksy[0], 'w,', markersize=1)\nax.plot(lokzx[1:-1], lokzy[1:-1], 'g,',markersize=1)\nax.plot(loksx[1:-1], loksy[1:-1], 'b,', markersize=1)\n\nax.plot(loksx[-1], loksy[-1], 'k,', markersize=1)\nax.plot(lokzx[-1], lokzy[-1], 'r,',markersize=1)\nfor i in range(len(Z)):\n    ax.contourf(X, Y, Z[i], 20, cmap='RdGy', alpha=0.01)\nax.plot()\nax.set_aspect('equal')\nplt.show()\n</code></pre>\n\n<p>But still it takes a while to run this. The only problem left is this two lines of code:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>for i in range(len(Z)):\n    ax.contourf(X, Y, Z[i], 20, cmap='RdGy', alpha=0.01)\n</code></pre>\n\n<p>But I don't know how to rewrite this without using a loop.</p>\n"}, {"tags": ["python", "python-3.x"], "answers": [{"comments": [{"owner": {"reputation": 2786, "user_id": 3970455, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0b8facc87555a7f8038453727dd1b2ba?s=128&d=identicon&r=PG&f=1", "display_name": "Omar Gonzales", "link": "https://stackoverflow.com/users/3970455/omar-gonzales"}, "edited": false, "score": 0, "creation_date": 1559163629, "post_id": 56368377, "comment_id": 99339715, "body": "Perfect, and to create a virtualenv with Python 3.7, one can do: <code>py -3.7 -m venv myvirtualenv</code>. But how to set <code>python3</code> variable to call <code>Python 3.7.exe</code>."}, {"owner": {"reputation": 2575, "user_id": 10669875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ae3bf8ded4da2254e5aa66d54167613?s=128&d=identicon&r=PG&f=1", "display_name": "wovano", "link": "https://stackoverflow.com/users/10669875/wovano"}, "reply_to_user": {"reputation": 2786, "user_id": 3970455, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0b8facc87555a7f8038453727dd1b2ba?s=128&d=identicon&r=PG&f=1", "display_name": "Omar Gonzales", "link": "https://stackoverflow.com/users/3970455/omar-gonzales"}, "edited": false, "score": 0, "creation_date": 1559163884, "post_id": 56368377, "comment_id": 99339790, "body": "@OmarGonzales You could create a batch file with the name <code>python3.bat</code> and as contents <code>@py -3 %*</code> and put it somewhere in your PATH ;-) Note that this wouldn&#39;t work from other batch files very well, unfortunately."}, {"owner": {"reputation": 2786, "user_id": 3970455, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0b8facc87555a7f8038453727dd1b2ba?s=128&d=identicon&r=PG&f=1", "display_name": "Omar Gonzales", "link": "https://stackoverflow.com/users/3970455/omar-gonzales"}, "edited": false, "score": 0, "creation_date": 1559191958, "post_id": 56368377, "comment_id": 99345710, "body": "I&#39;m missing something here, because a lot of tutorials I see say use: <code>python3 manage.py runserver</code>or other commands...Should I assume they have created a bash file?"}, {"owner": {"reputation": 2575, "user_id": 10669875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ae3bf8ded4da2254e5aa66d54167613?s=128&d=identicon&r=PG&f=1", "display_name": "wovano", "link": "https://stackoverflow.com/users/10669875/wovano"}, "reply_to_user": {"reputation": 2786, "user_id": 3970455, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0b8facc87555a7f8038453727dd1b2ba?s=128&d=identicon&r=PG&f=1", "display_name": "Omar Gonzales", "link": "https://stackoverflow.com/users/3970455/omar-gonzales"}, "edited": false, "score": 0, "creation_date": 1559206765, "post_id": 56368377, "comment_id": 99351215, "body": "@OmarGonzales, in Linux the Python 3 executable is available under the name <code>python3</code> because a lot of other tools/scripts depend on <code>python</code> being Python 2. So these examples may be intended for Linux environments. However, in Windows it works a bit differently. And unfortunately the Python launcher is (as far as I know) only available for Windows. So there really are two different mechanisms for executing Python versions in Linux and Windows. I would like this being more standardized and easier, but it isn&#39;t... My advice: just read <code>python3</code> as <code>py -3</code> and you&#39;re fine :-)"}], "tags": [], "owner": {"reputation": 2575, "user_id": 10669875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ae3bf8ded4da2254e5aa66d54167613?s=128&d=identicon&r=PG&f=1", "display_name": "wovano", "link": "https://stackoverflow.com/users/10669875/wovano"}, "is_accepted": true, "score": 2, "last_activity_date": 1559163336, "creation_date": 1559163336, "answer_id": 56368377, "question_id": 56368351, "link": "https://stackoverflow.com/questions/56368351/calling-python3-shows-error-and-calling-python-starts-python2-7/56368377#56368377", "title": "calling python3 shows error and calling python starts python2.7", "body": "<p>Both versions are currently in your path, but Python 2.7 is the first, so Windows will start Python 2.7 if you type <code>python</code> on the command line.</p>\n\n<p>If you have installed the Python launcher (<code>py.exe</code>) you could start Python 3.7 using <code>py -3.7</code> and Python 2.7 using <code>py -2</code>.</p>\n"}], "owner": {"reputation": 2786, "user_id": 3970455, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0b8facc87555a7f8038453727dd1b2ba?s=128&d=identicon&r=PG&f=1", "display_name": "Omar Gonzales", "link": "https://stackoverflow.com/users/3970455/omar-gonzales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 1, "accepted_answer_id": 56368377, "answer_count": 1, "score": 1, "last_activity_date": 1559163336, "creation_date": 1559163189, "question_id": 56368351, "link": "https://stackoverflow.com/questions/56368351/calling-python3-shows-error-and-calling-python-starts-python2-7", "title": "calling python3 shows error and calling python starts python2.7", "body": "<p>I want to be able to call python3 on my windows 10 machine from cmd.</p>\n\n<p>I've reinstalled Python3.7 to make sure Add to path option was selected, but cannot still call <code>python3</code> and make the CMD start Python 3.7. </p>\n\n<p>System variables:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wUsF6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wUsF6.png\" alt=\"enter image description here\"></a></p>\n\n<p>Whereas <code>python</code> in CMD stars Python 2.7:</p>\n\n<p><a href=\"https://i.stack.imgur.com/FZ9cp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FZ9cp.png\" alt=\"enter image description here\"></a></p>\n\n<p>I think I need these because when creating a virtualenv, it is created to use Python 2.7:</p>\n\n<pre><code># Windows\npython -m venv env\n</code></pre>\n\n<p><strong>If I search for Python3.7 I can see the exe file and execute it correctly.</strong></p>\n\n<pre><code>C:\\Users\\OGONZALES\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Python 3.7\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/gjgqf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gjgqf.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["python", "amazon-web-services", "amazon-s3", "aws-lambda", "boto3"], "comments": [{"owner": {"reputation": 162605, "user_id": 174777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PnNW.jpg?s=128&g=1", "display_name": "John Rotenstein", "link": "https://stackoverflow.com/users/174777/john-rotenstein"}, "edited": false, "score": 0, "creation_date": 1559174362, "post_id": 56368326, "comment_id": 99342405, "body": "Sorry, but what is your question?"}, {"owner": {"reputation": 34248, "user_id": 269970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Breov.jpg?s=128&g=1", "display_name": "esqew", "link": "https://stackoverflow.com/users/269970/esqew"}, "edited": false, "score": 0, "creation_date": 1559223763, "post_id": 56368326, "comment_id": 99359251, "body": "How would you be filling the hard disk with your zip file? It doesn&#39;t appear you&#39;re writing it to your hard disk, but instead to a <code>BytesIO()</code> buffer"}, {"owner": {"reputation": 41, "user_id": 8172226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P3jXT.png?s=128&g=1", "display_name": "Yordano Gonzalez", "link": "https://stackoverflow.com/users/8172226/yordano-gonzalez"}, "edited": false, "score": 0, "creation_date": 1559232478, "post_id": 56368326, "comment_id": 99363995, "body": "Sorry, in RAM memory"}, {"owner": {"reputation": 41, "user_id": 8172226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P3jXT.png?s=128&g=1", "display_name": "Yordano Gonzalez", "link": "https://stackoverflow.com/users/8172226/yordano-gonzalez"}, "edited": false, "score": 0, "creation_date": 1559232537, "post_id": 56368326, "comment_id": 99364032, "body": "I want to upload the compressed file without filling the memory (RAM)"}], "owner": {"reputation": 41, "user_id": 8172226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P3jXT.png?s=128&g=1", "display_name": "Yordano Gonzalez", "link": "https://stackoverflow.com/users/8172226/yordano-gonzalez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 383, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559223291, "creation_date": 1559163085, "last_edit_date": 1559223291, "question_id": 56368326, "link": "https://stackoverflow.com/questions/56368326/how-to-create-and-upload-a-large-zip-file-to-s3-with-low-memory-using-python", "title": "How to create and upload a large zip file to s3 with low memory using python", "body": "<p>I want to download a list of s3 files and compress it into a file, but the list of files can be very large and take up a lot of memory space.</p>\n\n<p>The immediate solution is to download all the files compress them and upload it to s3</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>def upload_zip_file(event,context):\n    s3 = boto3.client('s3')\n    list_keys = event['list_keys']\n    data_io = BytesIO()\n    filename = \"file.pdf\"\n    zf = zipfile.ZipFile(data_io, 'w')\n\n    for key in list_keys:\n        s3_object = s3.get_object(Bucket=DATA_BUCKET_NAME, Key=key)\n        body = s3_object['Body'].read()\n        zf.writestr(filename,body, compress_type=zipfile.ZIP_DEFLATED)\n\n    zf.close()\n    s3.upload_fileobj(data_io, ZIP_BUCKET_NAME, filename)\n</code></pre>\n\n<p>With this solution when I download all the data, the total size of the zip file is stored in memory and can be larger than 1 GB. How can I upload the zip in small parts without reaching the full size?.</p>\n"}, {"tags": ["python"], "comments": [{"owner": {"reputation": 8762, "user_id": 1709364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40e026958109464eb03fd70b67fab155?s=128&d=identicon&r=PG", "display_name": "jasonharper", "link": "https://stackoverflow.com/users/1709364/jasonharper"}, "edited": false, "score": 6, "creation_date": 1559163200, "post_id": 56368312, "comment_id": 99339563, "body": "That looks like you&#39;re trying to run terminal commands from within a Python interpreter."}, {"owner": {"reputation": 1, "user_id": 9777231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ad58d1db3c166e1bdde6d615aacbdf?s=128&d=identicon&r=PG&f=1", "display_name": "DRAZZILB", "link": "https://stackoverflow.com/users/9777231/drazzilb"}, "reply_to_user": {"reputation": 8762, "user_id": 1709364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40e026958109464eb03fd70b67fab155?s=128&d=identicon&r=PG", "display_name": "jasonharper", "link": "https://stackoverflow.com/users/1709364/jasonharper"}, "edited": false, "score": 0, "creation_date": 1559163589, "post_id": 56368312, "comment_id": 99339696, "body": "@jasonharper any idea how it should it be re-written to compile?"}, {"owner": {"reputation": 8762, "user_id": 1709364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40e026958109464eb03fd70b67fab155?s=128&d=identicon&r=PG", "display_name": "jasonharper", "link": "https://stackoverflow.com/users/1709364/jasonharper"}, "edited": false, "score": 3, "creation_date": 1559163644, "post_id": 56368312, "comment_id": 99339720, "body": "You don&#39;t rewrite it, you enter it at a terminal prompt instead of a Python prompt."}, {"owner": {"reputation": 2131, "user_id": 2343935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/li569.png?s=128&g=1", "display_name": "grooveplex", "link": "https://stackoverflow.com/users/2343935/grooveplex"}, "edited": false, "score": 0, "creation_date": 1559166843, "post_id": 56368312, "comment_id": 99340649, "body": "On a related note, <a href=\"https://pythonclock.org/\" rel=\"nofollow noreferrer\">Python 2.7 will reach EOL in just seven months from tomorrow</a>!"}, {"owner": {"reputation": 1, "user_id": 9777231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ad58d1db3c166e1bdde6d615aacbdf?s=128&d=identicon&r=PG&f=1", "display_name": "DRAZZILB", "link": "https://stackoverflow.com/users/9777231/drazzilb"}, "reply_to_user": {"reputation": 8762, "user_id": 1709364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40e026958109464eb03fd70b67fab155?s=128&d=identicon&r=PG", "display_name": "jasonharper", "link": "https://stackoverflow.com/users/1709364/jasonharper"}, "edited": false, "score": 0, "creation_date": 1559306563, "post_id": 56368312, "comment_id": 99389155, "body": "@jasonharper thats what i thought. I ran CMD as admin and then ran the export command"}], "owner": {"reputation": 1, "user_id": 9777231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ad58d1db3c166e1bdde6d615aacbdf?s=128&d=identicon&r=PG&f=1", "display_name": "DRAZZILB", "link": "https://stackoverflow.com/users/9777231/drazzilb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559175606, "creation_date": 1559163031, "last_edit_date": 1559175606, "question_id": 56368312, "link": "https://stackoverflow.com/questions/56368312/python-syntax-error-when-creating-slack-app", "title": "Python Syntax Error When Creating Slack App", "body": "<p>I'm following a tutorial for removing all Slackbot messages from Slack but getting a syntax error</p>\n\n<pre><code>export BOT_NAME=$slackbot-destroyer\npipenv run python id.py\n</code></pre>\n\n<p>Error message:</p>\n\n<pre><code>File \"&lt;stdin&gt;\", line 1\n    export BOT_NAME=slackbot-destroyer pipenv run python id.py\n                  ^\nSyntaxError: invalid syntax\n</code></pre>\n\n<p>I'm running Python 2.7 on Windows.</p>\n"}, {"tags": ["python", "python-3.x", "optimization", "pyomo", "coin-or"], "comments": [{"owner": {"reputation": 2127, "user_id": 3453768, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/RpSGc.png?s=128&g=1", "display_name": "LarrySnyder610", "link": "https://stackoverflow.com/users/3453768/larrysnyder610"}, "edited": false, "score": 0, "creation_date": 1559219909, "post_id": 56368215, "comment_id": 99357162, "body": "You might want to edit your question to make it clear that you are looking for a syntax that will allow you to define variables like this automatically -- not for a modeling trick in which you declare new variables to accomplish this."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9744779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4EHaW.jpg?s=128&g=1", "display_name": "cicciobombacannoniere", "link": "https://stackoverflow.com/users/9744779/cicciobombacannoniere"}, "edited": false, "score": 0, "creation_date": 1559166007, "post_id": 56368424, "comment_id": 99340403, "body": "Thank you for the answer. I&#39;ve already modelled the problem as a MINLP, i&#39;ve already defined the variable as an integer variable. But now i want to be more specific."}, {"owner": {"reputation": 2127, "user_id": 3453768, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/RpSGc.png?s=128&g=1", "display_name": "LarrySnyder610", "link": "https://stackoverflow.com/users/3453768/larrysnyder610"}, "reply_to_user": {"reputation": 21, "user_id": 9744779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4EHaW.jpg?s=128&g=1", "display_name": "cicciobombacannoniere", "link": "https://stackoverflow.com/users/9744779/cicciobombacannoniere"}, "edited": false, "score": 0, "creation_date": 1559166195, "post_id": 56368424, "comment_id": 99340464, "body": "More specific about what? Are you asking whether you can model variables that come from a discrete set, in Pyomo, <i>without</i> declaring new integer variables?"}, {"owner": {"reputation": 21, "user_id": 9744779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4EHaW.jpg?s=128&g=1", "display_name": "cicciobombacannoniere", "link": "https://stackoverflow.com/users/9744779/cicciobombacannoniere"}, "edited": false, "score": 0, "creation_date": 1559199965, "post_id": 56368424, "comment_id": 99348369, "body": "Maybe I didn&#39;t explain myself clearly, I&#39;m sorry. What I want to do is declare that my variable can take only specific values, such as those in a list, which I fill personally."}, {"owner": {"reputation": 2127, "user_id": 3453768, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/RpSGc.png?s=128&g=1", "display_name": "LarrySnyder610", "link": "https://stackoverflow.com/users/3453768/larrysnyder610"}, "reply_to_user": {"reputation": 21, "user_id": 9744779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4EHaW.jpg?s=128&g=1", "display_name": "cicciobombacannoniere", "link": "https://stackoverflow.com/users/9744779/cicciobombacannoniere"}, "edited": false, "score": 0, "creation_date": 1559219859, "post_id": 56368424, "comment_id": 99357136, "body": "In that case, I don&#39;t think it&#39;s possible to do this automatically. For example, if you declare <code>model.A = Set(initialize=[0.1,0.5,1.0,1.7,2.3])</code> and then declare your variable like <code>model.x = Var(domain=model.A)</code>, Pyomo gives an error that the domain is not continuous, integer or binary -- suggesting that those are the only allowable domains. However, note that even if Pyomo <i>could</i> do what you are asking, it would still convert to integer variables &quot;behind the scenes&quot;, so it might be easier syntactically but it would not be faster computationally."}], "tags": [], "owner": {"reputation": 2127, "user_id": 3453768, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/RpSGc.png?s=128&g=1", "display_name": "LarrySnyder610", "link": "https://stackoverflow.com/users/3453768/larrysnyder610"}, "is_accepted": false, "score": 2, "last_activity_date": 1559163535, "creation_date": 1559163535, "answer_id": 56368424, "question_id": 56368215, "link": "https://stackoverflow.com/questions/56368215/pyomo-is-possible-to-assign-to-a-design-variable-only-defined-values/56368424#56368424", "title": "Pyomo: is possible to assign to a design variable only defined values?", "body": "<p>You have to do this with integer variables. For example, if there are <code>N</code> possible values of <code>x</code>, then let <code>x[n] = 1</code> if <code>x</code> equals the <code>n</code>th possible value, and <code>0</code> otherwise. Any time you have an <code>x</code> in your original model, replace it with </p>\n\n<pre><code>sum {n=1,...,N} v[n] * x[n]\n</code></pre>\n\n<p>where <code>v[n]</code> is the <code>n</code>th possible value. Finally, add a constraint that says:</p>\n\n<pre><code>sum {n=1,...,N} x[n] == 1 \n</code></pre>\n\n<p>I'm not writing these in Pyomo syntax, but this is a general modeling approach that is the same no matter what modeling language/package you use.</p>\n"}], "owner": {"reputation": 21, "user_id": 9744779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4EHaW.jpg?s=128&g=1", "display_name": "cicciobombacannoniere", "link": "https://stackoverflow.com/users/9744779/cicciobombacannoniere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559199695, "creation_date": 1559162516, "last_edit_date": 1559199695, "question_id": 56368215, "link": "https://stackoverflow.com/questions/56368215/pyomo-is-possible-to-assign-to-a-design-variable-only-defined-values", "title": "Pyomo: is possible to assign to a design variable only defined values?", "body": "<p>I want that a design variable assumes only specified values during optimization process.</p>\n\n<p>For example:\nLet x be the variable which can assume only specific value, e.g.: </p>\n\n<pre class=\"lang-py prettyprint-override\"><code>x = [0.1,0.5,1.0,1.7,2.3]\n</code></pre>\n\n<p>How can be written in python using pyomo (if it's possible)? </p>\n\n<p>I hope I was clear.</p>\n"}, {"tags": ["python", "apache-spark", "hadoop", "pyspark"], "comments": [{"owner": {"reputation": 32007, "user_id": 5858851, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/yXFCX.jpg?s=128&g=1", "display_name": "pault", "link": "https://stackoverflow.com/users/5858851/pault"}, "edited": false, "score": 0, "creation_date": 1559167398, "post_id": 56368211, "comment_id": 99340817, "body": "You can try <code>pyspark.sql.functions.regexp_replace()</code> instead of using a <code>udf</code>: <a href=\"https://stackoverflow.com/questions/38296609/spark-functions-vs-udf-performance\">Spark functions vs UDF performance?</a>"}, {"owner": {"reputation": 1, "user_id": 11543714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c365d5de5fea41b0f62d77c3d9fe5aa?s=128&d=identicon&r=PG&f=1", "display_name": "Tundra123", "link": "https://stackoverflow.com/users/11543714/tundra123"}, "reply_to_user": {"reputation": 32007, "user_id": 5858851, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/yXFCX.jpg?s=128&g=1", "display_name": "pault", "link": "https://stackoverflow.com/users/5858851/pault"}, "edited": false, "score": 0, "creation_date": 1559191940, "post_id": 56368211, "comment_id": 99345707, "body": "Hi pault, thanks for commenting. I tried using regex_replace in the first instance and it did have the required outcome, but I can&#39;t see how to use map with it and parrallelise the operation. I was iterating through the name list, running regex_replace on the whole dataset, then moving on to the next name. This was 20k iterations which lead to Stack overflow due to lineage. Checkpointing and hacking through the lineage worked, but the performance was still too slow."}, {"owner": {"reputation": 5541, "user_id": 750376, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/arDBB.jpg?s=128&g=1", "display_name": "abiratsis", "link": "https://stackoverflow.com/users/750376/abiratsis"}, "edited": false, "score": 0, "creation_date": 1559223633, "post_id": 56368211, "comment_id": 99359178, "body": "The regex functionality is a heavy operation, since both solutions <code>func&#47;udf</code> and <code>regexp_replace</code> were both pretty slow maybe you could try to increase the job parallelization. To answer that more precisely it would be better to have some characteristics of the cluster that the job is being executed. How many nodes does your cluster currently have and what are the available resources on each node?"}, {"owner": {"reputation": 32007, "user_id": 5858851, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/yXFCX.jpg?s=128&g=1", "display_name": "pault", "link": "https://stackoverflow.com/users/5858851/pault"}, "edited": false, "score": 0, "creation_date": 1559232360, "post_id": 56368211, "comment_id": 99363925, "body": "You could try creating a pattern that is an OR of all of the values in your list. Something like <code>rx = &quot;(^| |[[:^alpha:]])({name})( |$|[[:^alpha:]])&quot;.format(name=&quot;|&quot;.join(nameList))</code> and then doing one call to <code>regexp_replace</code> instead of iterating."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 2462264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f45e45207d6dca24ca8071400ad3308?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/2462264/adam"}, "is_accepted": false, "score": 0, "last_activity_date": 1602814850, "creation_date": 1602814850, "answer_id": 64382051, "question_id": 56368211, "link": "https://stackoverflow.com/questions/56368211/how-can-i-efficiently-replace-all-instances-of-multiple-regex-patterns-from-a-da/64382051#64382051", "title": "How can I efficiently replace all instances of multiple regex patterns from a dataframe of strings, in pySpark?", "body": "<p>In case you're still curious about this, by using the <code>udf</code> (your <code>removeNames</code> function) Spark is serializing all of your data to the master node, essentially defeating your usage of Spark to do this operation in a distributed fashion. As the method suggested in the comments, if you go with the <code>regexp_replace()</code> method, Spark will be able to keep all of the data on the distributed nodes, keeping everything distributed and improving performance.</p>\n"}], "owner": {"reputation": 1, "user_id": 11543714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c365d5de5fea41b0f62d77c3d9fe5aa?s=128&d=identicon&r=PG&f=1", "display_name": "Tundra123", "link": "https://stackoverflow.com/users/11543714/tundra123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 610, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1602814850, "creation_date": 1559162499, "question_id": 56368211, "link": "https://stackoverflow.com/questions/56368211/how-can-i-efficiently-replace-all-instances-of-multiple-regex-patterns-from-a-da", "title": "How can I efficiently replace all instances of multiple regex patterns from a dataframe of strings, in pySpark?", "body": "<p>I have a table in Hadoop which contains 7 billion strings which can themselves contain anything. I need to remove every name from the column containing the strings. An example string would be 'John went to the park' and I'd need to remove 'John' from that, ideally just replacing with '[name]'.</p>\n\n<p>In the case of 'John and Mary went to market', the output would be '[NAME] and [NAME] went to market'.</p>\n\n<p>To support this I have an ordered list of the most frequently occurring 20k names.</p>\n\n<p>I have access to Hue (Hive, Impala) and Zeppelin (Spark, Python &amp; libraries) to execute this.</p>\n\n<p>I've tried this in the DB, but being unable to update columns or iterate over a variable made it a non-starter, so using Python and PySpark seems to be the best option especially considering the number of calculations (20k names * 7bil input strings)</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>#nameList contains ['John','Emma',etc]\ndef removeNames(line, nameList):\n    str_line= line[0]\n    for name in nameList:\n        rx = f\"(^| |[[:^alpha:]])({name})( |$|[[:^alpha:]])\"\n        str_line = re.sub(rx,'[NAME]', str_line)\n    str_line= [str_line]\n    return tuple(str_line)\n\ndf = session.sql(\"select free_text from table\")\nrdd = df.rdd.map(lambda line: removeNames(line, nameList))\nrdd.toDF().show()\n\n</code></pre>\n\n<p>The code is executing, but it's taking an hour and a half even if I limit the input text to 1000 lines (which is nothing for Spark), and the lines aren't actually being replaced in the final output.</p>\n\n<p>What I'm wondering is: Why isn't map actually updating the lines of the RDD, and how could I make this more efficient so it executes in a reasonable amount of time?</p>\n\n<p>This is my first time posting so if there's essential info missing, I'll fill in as much as I can.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["python", "pandas", "dataframe", "group-by"], "comments": [{"owner": {"reputation": 9302, "user_id": 8300135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eaa9ded8087b3af42dd463c95696733?s=128&d=identicon&r=PG&f=1", "display_name": "SpghttCd", "link": "https://stackoverflow.com/users/8300135/spghttcd"}, "edited": false, "score": 1, "creation_date": 1559162696, "post_id": 56368178, "comment_id": 99339371, "body": "You want to group by <code>A</code> only: <code>df.groupby([&#39;A&#39;])</code>"}, {"owner": {"reputation": 45308, "user_id": 3483203, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/592wq.png?s=128&g=1", "display_name": "user3483203", "link": "https://stackoverflow.com/users/3483203/user3483203"}, "edited": false, "score": 0, "creation_date": 1559162912, "post_id": 56368178, "comment_id": 99339447, "body": "<code>[[*v] for _, v in df.groupby(&#39;A&#39;)[&#39;B&#39;]]</code>"}, {"owner": {"reputation": 9302, "user_id": 8300135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eaa9ded8087b3af42dd463c95696733?s=128&d=identicon&r=PG&f=1", "display_name": "SpghttCd", "link": "https://stackoverflow.com/users/8300135/spghttcd"}, "edited": false, "score": 2, "creation_date": 1559163005, "post_id": 56368178, "comment_id": 99339485, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/22219004/grouping-rows-in-list-in-pandas-groupby\">grouping rows in list in pandas groupby</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1898, "user_id": 1708165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ec670e250a0b2662151648ea882d2ef?s=128&d=identicon&r=PG", "display_name": "ch33hau", "link": "https://stackoverflow.com/users/1708165/ch33hau"}, "is_accepted": true, "score": 1, "last_activity_date": 1559162852, "creation_date": 1559162852, "answer_id": 56368282, "question_id": 56368178, "link": "https://stackoverflow.com/questions/56368178/pandas-group-a-column-by-another-column/56368282#56368282", "title": "Pandas group a column by another column", "body": "<pre class=\"lang-py prettyprint-override\"><code>import pandas as pd\n\ndf = pd.DataFrame([\n    {'A':1, 'B': 'a'},\n    {'A':1, 'B': 'b'},\n    {'A':1, 'B': 'c'},\n    {'A':2, 'B': 'd'},\n    {'A':2, 'B': 'e'},\n    {'A':2, 'B': 'f'}])\n\nlist(df.groupby('A')['B'].apply(list).values)\n\n# Output\n# [['a', 'b', 'c'], ['d', 'e', 'f']]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 970, "user_id": 10620028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76e9c6ed74b548534059fec223fcc94?s=128&d=identicon&r=PG&f=1", "display_name": "iamchoosinganame", "link": "https://stackoverflow.com/users/10620028/iamchoosinganame"}, "is_accepted": false, "score": 0, "last_activity_date": 1559162927, "creation_date": 1559162927, "answer_id": 56368296, "question_id": 56368178, "link": "https://stackoverflow.com/questions/56368178/pandas-group-a-column-by-another-column/56368296#56368296", "title": "Pandas group a column by another column", "body": "<pre><code>[x['B'].values.tolist() for _,x in df.groupby('A')]\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>[['a', 'b', 'c'], ['d', 'e', 'f']]\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 7288808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f0b45ac210a6a72f5bb675da83ca723?s=128&d=identicon&r=PG&f=1", "display_name": "user7288808", "link": "https://stackoverflow.com/users/7288808/user7288808"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "accepted_answer_id": 56368282, "answer_count": 2, "score": -1, "last_activity_date": 1559162927, "creation_date": 1559162321, "question_id": 56368178, "link": "https://stackoverflow.com/questions/56368178/pandas-group-a-column-by-another-column", "title": "Pandas group a column by another column", "body": "<p>I have a pandas dataframe that looks like:</p>\n\n<pre><code>A B\n1 a\n1 b\n1 c\n2 d\n2 e\n2 f\n</code></pre>\n\n<p>I want to get a list of values for column 'B' by column 'A', so the final product would look like:</p>\n\n<pre><code>list_one = [a, b, c]\nlist_two = [d, e, f]\n</code></pre>\n\n<p>I've tried:</p>\n\n<pre><code>df.groupby(['A','B'])\n</code></pre>\n\n<p>But, this doesn't do what I want it to do. </p>\n\n<p>What would be an elegant pythonic way to achieve this?</p>\n"}, {"tags": ["python", "screenshot", "dbus", "gio", "flatpak"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10548788, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-N0N3lLsYP5w/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXY4sEYjMX3JrBUv-tKHUs_gdEMaQ/mo/photo.jpg?sz=128", "display_name": "Joshua Bell", "link": "https://stackoverflow.com/users/10548788/joshua-bell"}, "is_accepted": false, "score": 0, "last_activity_date": 1559243053, "creation_date": 1559243053, "answer_id": 56384206, "question_id": 56368170, "link": "https://stackoverflow.com/questions/56368170/using-freedesktop-portal-to-take-screenshots-with-python/56384206#56384206", "title": "Using freedesktop portal to take screenshots with Python", "body": "<p>I resolved this issue by subscribing to the signal from the bus on the path of the request handle.</p>\n\n<pre><code>        args = GLib.Variant('(sa{sv})', (filename, {}))\n        result = self.proxy.call_sync('Screenshot',\n                                      args,\n                                      Gio.DBusCallFlags.NONE,\n                                      -1,\n                                      None)\n        request_handle = result.unpack()[0]\n        self.bus.signal_subscribe(\"org.freedesktop.portal.Desktop\",\n                                  \"org.freedesktop.portal.Request\",\n                                  \"Response\",\n                                  request_handle,\n                                  None,\n                                  Gio.DBusSignalFlags.NO_MATCH_RULE,\n                                  self.receive_screenshot_signal)\n</code></pre>\n\n<p>I couldn't find any specific documention on Gio.bus.signal_subscribe but here is how the callback function handles the return:</p>\n\n<pre><code>  def receive_screenshot_signal(self,\n                                  connection,\n                                  sender,\n                                  path,\n                                  interface,\n                                  signal,\n                                  params):\n        if not isinstance(params, GLib.Variant):\n            print(\"It's not a variant\")\n            return\n        response_code, results = params.unpack()\n        # Response code 0 signifies success\n        if response_code != 0 or 'uri' not in results:\n            print(\"Error taking screenshot\")\n            return\n        parsed_uri = urlparse(results['uri'])\n        assert parsed_uri.scheme == \"file\"\n        self.screenshot = unquote(parsed_uri.path)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10548788, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-N0N3lLsYP5w/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXY4sEYjMX3JrBUv-tKHUs_gdEMaQ/mo/photo.jpg?sz=128", "display_name": "Joshua Bell", "link": "https://stackoverflow.com/users/10548788/joshua-bell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 230, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559243053, "creation_date": 1559162292, "question_id": 56368170, "link": "https://stackoverflow.com/questions/56368170/using-freedesktop-portal-to-take-screenshots-with-python", "title": "Using freedesktop portal to take screenshots with Python", "body": "<p>I have been trying to write a flatpak application in python, which uses the freedesktop portal to take screenshots. I am adapting Gimp's freedesktop screenshot plugin which is written in c and I am running into trouble when it comes to accessing the screenshot after it is taken and shared with my application. I get a uri of the form '/org/freedesktop/portal/desktop/request/1_326/t' and the freedesktop portal documentation says that the uri points into a fuse file system mounted at run/user/$UID/doc/ and I can confirm that the screenshots are being saved there. However, t I can't seem to be able to get a useful identifier for them so that I can attach them to an email with my app.</p>\n\n<p>I have experimented with all of the methods in the freedesktop Documents portal and have had no success there. After calling a dbus proxy which returns a uri which is saved in the opath variable the Gimp implementation sets up another dbus proxy and then connects that proxy to a callback function here: the full file that I copied these snippets from is available here &lt;\ufeff<a href=\"https://github.com/GNOME/gimp/blob/master/plug-ins/screenshot/screenshot-freedesktop.c\" rel=\"nofollow noreferrer\">https://github.com/GNOME/gimp/blob/master/plug-ins/screenshot/screenshot-freedesktop.c</a>> </p>\n\n<pre><code>if (opath)\n    {\n      GDBusProxy *proxy2 = NULL;\n\n      proxy2 = g_dbus_proxy_new_for_bus_sync (G_BUS_TYPE_SESSION,\n                                              G_DBUS_PROXY_FLAGS_DO_NOT_AUTO_START,\n                                              NULL,\n                                              \"org.freedesktop.portal.Desktop\",\n                                              opath,\n                                              \"org.freedesktop.portal.Request\",\n                                              NULL, NULL);\n      *image_ID = 0;\n      g_signal_connect (proxy2, \"g-signal\",\n                        G_CALLBACK (screenshot_freedesktop_dbus_signal),\n                        image_ID);\n\n      gtk_main ();\n      g_object_unref (proxy2);\n      g_free (opath);\n</code></pre>\n\n<p>And the screenshot_freedesktop_dbus_signal function looks like this:</p>\n\n<pre><code>static void\nscreenshot_freedesktop_dbus_signal (GDBusProxy *proxy,\n                                    gchar      *sender_name,\n                                    gchar      *signal_name,\n                                    GVariant   *parameters,\n                                    gint32     *image_ID)\n{\n  if (g_strcmp0 (signal_name, \"Response\") == 0)\n    {\n      GVariant *results;\n      guint32   response;\n\n      g_variant_get (parameters, \"(u@a{sv})\",\n                     &amp;response,\n                     &amp;results);\n\n      /* Possible values:\n       * 0: Success, the request is carried out\n       * 1: The user cancelled the interaction\n       * 2: The user interaction was ended in some other way\n       * Cf. https://github.com/flatpak/xdg-desktop-portal/blob/master/data/org.freedesktop.portal.Request.xml\n       */\n      if (response == 0)\n        {\n          gchar *uri;\n\n          if (g_variant_lookup (results, \"uri\", \"s\", &amp;uri))\n            {\n              GFile *file = g_file_new_for_uri (uri);\n              gchar *path = g_file_get_path (file);\n\n              *image_ID = gimp_file_load (GIMP_RUN_NONINTERACTIVE,\n                                          path, path);\n              gimp_image_set_filename (*image_ID, \"screenshot.png\");\n\n              /* Delete the actual file. */\n              g_file_delete (file, NULL, NULL);\n\n              g_object_unref (file);\n              g_free (path);\n              g_free (uri);\n            }\n        }\n\n      g_variant_unref (results);\n      gtk_main_quit ();\n    }\n}\n</code></pre>\n\n<p>My code works the same way until the callback function. I can't find the pythonic equivalent of the g_signal_connect function. I have tried adding the callback to the new proxy's initialization like this </p>\n\n<pre><code>proxy2 = Gio.DBusProxy.new_for_bus(Gio.BusType.SESSION,\n                                            Gio.DBusProxyFlags.NONE,\n                                            None,\n                                            \"org.freedesktop.portal.Desktop\",\n                                            returned_uri[0],\n                                            \"org.freedesktop.portal.Request\",\n                                            None,\n                                            G_CALLBACK(self.receive_screenshot_signal),\n                                            None)\n</code></pre>\n\n<p>but my receive_screenshot_signal function is not passed any values and the task objects which are passed in say that they are not finished.</p>\n\n<p>I am not sure where to go from here so any advice or insight into how I can use the dbusproxy library and/or the freedesktop portals more effectively would be appreciated. Thanks!</p>\n"}, {"tags": ["python", "web-scraping", "beautifulsoup"], "comments": [{"owner": {"reputation": 3717, "user_id": 4286590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aec806c97431f338e396b9a5611bb9b?s=128&d=identicon&r=PG&f=1", "display_name": "bharatk", "link": "https://stackoverflow.com/users/4286590/bharatk"}, "edited": false, "score": 0, "creation_date": 1559200454, "post_id": 56368168, "comment_id": 99348612, "body": "Share your website link."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1559200818, "creation_date": 1559200818, "answer_id": 56373544, "question_id": 56368168, "link": "https://stackoverflow.com/questions/56368168/how-to-find-specific-link-in-a-page-via-similar-string-in-bs4-python/56373544#56373544", "title": "How to find specific link in a page via Similar string in bs4 python", "body": "<p>Assuming it is in an <code>a</code> tag you can use * contains operator and pass a list of Or strings to <code>select</code></p>\n\n<pre><code>soup.select('[href*=\"Top 100 Club Tracks Vol.1 2019.rar\"],[href*=\"top 100 club tracks vol.1 2019.rar\"]')\n</code></pre>\n\n<p>keep adding comma separated variations to select as shown above.</p>\n"}], "owner": {"reputation": 77, "user_id": 10974190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qXyqd.jpg?s=128&g=1", "display_name": "CryNet Plan", "link": "https://stackoverflow.com/users/10974190/crynet-plan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559200849, "creation_date": 1559162278, "last_edit_date": 1559200849, "question_id": 56368168, "link": "https://stackoverflow.com/questions/56368168/how-to-find-specific-link-in-a-page-via-similar-string-in-bs4-python", "title": "How to find specific link in a page via Similar string in bs4 python", "body": "<p>Is there any way for found link that contains this example string <code>Top 100 Club Tracks Vol.1 2019.rar</code></p>\n\n<p>but maybe the link contains this type of string </p>\n\n<p><code>Top_100_Club_Tracks_Vol.1_2019.rar</code> (uppercase and _)</p>\n\n<p><code>top 100 club tracks vol.1 2019.rar</code> (lowercase and white space)</p>\n\n<p><code>top.100.club.tracks.vol1.2019.rar</code> ( lowercase and dote)</p>\n\n<p>i just try this code and it cant just find links contains specific string :</p>\n\n<pre><code>mystr = Top 100 Club Tracks Vol.1 2019.rar\n\n links = soup_music.find('a', text=Title).findNext(\"div\",{\"class\":\"postContent\"}).findAll('a', attrs={'href':re.compile(mystr)})\n</code></pre>\n"}, {"tags": ["python", "keras", "deep-learning", "reshape"], "owner": {"reputation": 31, "user_id": 11407568, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HcXnav39X90/AAAAAAAAAAI/AAAAAAAAABE/wUXsZXJrQtE/photo.jpg?sz=128", "display_name": "Joshua Clancy", "link": "https://stackoverflow.com/users/11407568/joshua-clancy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 246, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1559162053, "creation_date": 1559162053, "question_id": 56368126, "link": "https://stackoverflow.com/questions/56368126/does-keras-reshape-maintain-data-structure-and-order-through-multiple-reshape-la", "title": "Does Keras Reshape maintain data structure and order through multiple reshape layers to and fro?", "body": "<p>I am relying on multiple layers of Keras Reshape but have no ability to check that they are working together properly. I start with a preprocessed tensor of (BatchSize, 50, 100, 300). Where 5 news articles a day for 10 days (50) are represented by 100 words, with each word being represented by a 300-dimensional embedded vector. </p>\n\n<p>I reshape this structure to and fro multiple times to get the data to fit with the various layers I am using. For example, I reshape (BatchSize, 50, 100, 300) to (BatchSize, 5000, 300) in order to feed the 300-dimensional word vectors through a time distributed layer, as to encode each word seperately. I then reshape the resulting (BatchSize, 5000, 10) to (BatchSize, 50, 100, 10). In this case, have I destroyed the relationship between the 50 News articles and their 100 words? Or does Reshape take care of this? </p>\n\n<p><a href=\"https://www.tensorflow.org/api_docs/python/tf/keras/layers/Reshape\" rel=\"nofollow noreferrer\">https://www.tensorflow.org/api_docs/python/tf/keras/layers/Reshape</a></p>\n\n<p>I looked into the documentation but couldn't really find an answer. I also searched through stack overflow. I am starting to think this is something everyone assumes is True (and probably is), but I need to be 100% sure. </p>\n\n<pre class=\"lang-py prettyprint-override\"><code>from keras.layers import Input, Dense, LSTM, TimeDistributed, Dropout, Reshape\nfrom keras.models import Model\n\nnewsInput = Input(shape=(input_length, 100, 300))\n\n#News Input pathway\n\n#Reshape intp a format which TimeDistributed will accept. (flatten the layers I want to keep seperate)\nnewsInput2 = Reshape([input_length*100, 300])(newsInput)\n#Encode each word from a 300 dimensional vector to a 10 dimensional vector.\nx = TimeDistributed(Dense(10, input_shape=(300,), activation='tanh'), input_shape=(input_length*100, 300))(newsInput2)\nprint(\"x shape\", x.shape)\n\n#Reshape intp a format which TimeDistributed will accept. (flatten the layers I want to keep seperate)\nx = Reshape([input_length, 100, 10])(x)\nx = Reshape([input_length, 100*10])(x)\n#encode each news article into a 10 dimensional vector.\nx = TimeDistributed(Dense(10, input_shape=(1000,), activation='tanh'), input_shape=(input_length, 1000))(x)\n# output = TimeDistributed(LSTM(10, return_sequences= False, input_shape=(100, 10), activation='tanh'), input_shape=(input_length, 100, 10))(x)\nprint(\"x\", x.shape)\n\noutput = LSTM(10, activation=\"relu\", input_shape=(50, 10))(x)\n\nmodel = Model(inputs=newsInput, outputs=output)\nmodel.summary()\n</code></pre>\n\n<p>I got it to run without any errors. But still not sure if the multiple reshapes maintained data integratory. </p>\n\n<hr>\n\n<h1>Layer (type)                 Output Shape              Param #</h1>\n\n<p>input_2 (InputLayer)         (None, 50, 100, 300)      0         </p>\n\n<hr>\n\n<p>reshape_1 (Reshape)          (None, 5000, 300)         0         </p>\n\n<hr>\n\n<p>time_distributed_1 (TimeDist (None, 5000, 10)          3010      </p>\n\n<hr>\n\n<p>reshape_2 (Reshape)          (None, 50, 100, 10)       0         </p>\n\n<hr>\n\n<p>reshape_3 (Reshape)          (None, 50, 1000)          0         </p>\n\n<hr>\n\n<p>time_distributed_2 (TimeDist (None, 50, 10)            10010     </p>\n\n<hr>\n\n<h1>lstm_1 (LSTM)                (None, 10)                840</h1>\n\n<p>Total params: 13,860\nTrainable params: 13,860\nNon-trainable params: 0</p>\n\n<hr>\n"}, {"tags": ["python", "pandas", "tree"], "comments": [{"owner": {"reputation": 1911, "user_id": 6239947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YmSEL.jpg?s=128&g=1", "display_name": "Supratim Haldar", "link": "https://stackoverflow.com/users/6239947/supratim-haldar"}, "edited": false, "score": 0, "creation_date": 1559162315, "post_id": 56368124, "comment_id": 99339245, "body": "&quot;row 5 (A01B 1/02) would have index value 4 for the value in the Parent column&quot; - but parent of row 5 has index 3. Isn&#39;t it?"}, {"owner": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "reply_to_user": {"reputation": 1911, "user_id": 6239947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YmSEL.jpg?s=128&g=1", "display_name": "Supratim Haldar", "link": "https://stackoverflow.com/users/6239947/supratim-haldar"}, "edited": false, "score": 0, "creation_date": 1559164759, "post_id": 56368124, "comment_id": 99340076, "body": "@Supratim Haldar, I see what you mean, parent of index 5 is index 4. Index 5 is level 8 &amp; index 4 is level 7. it doesn&#39;t really matter what the symbol is, the only thing that matters is the level and the position of the row to determine hierarchy."}, {"owner": {"reputation": 1911, "user_id": 6239947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YmSEL.jpg?s=128&g=1", "display_name": "Supratim Haldar", "link": "https://stackoverflow.com/users/6239947/supratim-haldar"}, "edited": false, "score": 0, "creation_date": 1559196960, "post_id": 56368124, "comment_id": 99347051, "body": "May be it&#39;s only me, but the logic of determining parent is not clear. I thought the first part of <code>symbol</code> determines parent (like &quot;A01B&quot; is parent of &quot;A01B 1/00&quot;). But you mentioned that symbol does not matter. Can you please explain clearly the logic and update your question?"}, {"owner": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "reply_to_user": {"reputation": 1911, "user_id": 6239947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YmSEL.jpg?s=128&g=1", "display_name": "Supratim Haldar", "link": "https://stackoverflow.com/users/6239947/supratim-haldar"}, "edited": false, "score": 0, "creation_date": 1559228916, "post_id": 56368124, "comment_id": 99362031, "body": "@SupratimHaldar I added a diagram that shows the hierarchy. hope this helps."}, {"owner": {"reputation": 2051, "user_id": 6883295, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Opjo7.jpg?s=128&g=1", "display_name": "cfort", "link": "https://stackoverflow.com/users/6883295/cfort"}, "edited": false, "score": 0, "creation_date": 1560349884, "post_id": 56368124, "comment_id": 99708693, "body": "What about downloading the <a href=\"https://www.cooperativepatentclassification.org/cpcSchemeAndDefinitions/CPCopenLinkedData.html\" rel=\"nofollow noreferrer\">pre-linked data</a> and then parsing it with <a href=\"https://github.com/RDFLib/rdflib\" rel=\"nofollow noreferrer\">rdflib</a>?"}, {"owner": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "edited": false, "score": 0, "creation_date": 1560351410, "post_id": 56368124, "comment_id": 99709611, "body": "hmm, not sure. Do you have any code to show?"}], "answers": [{"comments": [{"owner": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "edited": false, "score": 0, "creation_date": 1560435666, "post_id": 56576140, "comment_id": 99743171, "body": "This almost works, but as soon as the next level 2 symbol is processed, error <code>IndexError: single positional indexer is out-of-bounds</code> appears. There are 8 level 2 symbols and they have no parent. Code needs to account for the multiple level 2 symbols."}, {"owner": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "edited": false, "score": 1, "creation_date": 1560435743, "post_id": 56576140, "comment_id": 99743228, "body": "i guess something like <code>if len(potential_parents) == 0: df.loc[index, &#39;Parent&#39;] = &#39;&#39;</code> might work alright."}, {"owner": {"reputation": 3220, "user_id": 11492024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ip64y.png?s=128&g=1", "display_name": "vlemaistre", "link": "https://stackoverflow.com/users/11492024/vlemaistre"}, "reply_to_user": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "edited": false, "score": 0, "creation_date": 1560436149, "post_id": 56576140, "comment_id": 99743494, "body": "Good idea, I edited my answer and tested it on a simple example. It seems to work"}, {"owner": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "edited": false, "score": 1, "creation_date": 1560436365, "post_id": 56576140, "comment_id": 99743642, "body": "I don&#39;t think we need the first <code>if</code> statement. Just check the length of <code>potential_parents</code> and if it is 0, set that symbol&#39;s parent to <code>&#39;&#39;</code>, else <code>potential_parents.iloc[-1]</code>"}, {"owner": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "edited": false, "score": 0, "creation_date": 1560436603, "post_id": 56576140, "comment_id": 99743807, "body": "Is there any way to speed up the generation of <code>potential_parents</code>? Maybe something that looks in the range of only the rows of the first above level 2? A symbols that starts with B will never have a parent that starts with A. Further, level 19 symbols will have a very long <code>potent_parent</code> list."}, {"owner": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "edited": false, "score": 0, "creation_date": 1560436886, "post_id": 56576140, "comment_id": 99743997, "body": "You could think of this list as 8 separate trees... What if we made a list of the indicesof each level 2 symbols, and limit the df range we seach for <code>potential_parents</code> by this list?"}, {"owner": {"reputation": 3220, "user_id": 11492024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ip64y.png?s=128&g=1", "display_name": "vlemaistre", "link": "https://stackoverflow.com/users/11492024/vlemaistre"}, "reply_to_user": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "edited": false, "score": 0, "creation_date": 1560437324, "post_id": 56576140, "comment_id": 99744278, "body": "Let&#39;s continue this discussion in a chat : <a href=\"https://chat.stackoverflow.com/rooms/194892/level-problem\">chat.stackoverflow.com/rooms/194892/level-problem</a>"}, {"owner": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "edited": false, "score": 1, "creation_date": 1560440195, "post_id": 56576140, "comment_id": 99746112, "body": "We missed each other on chat. Here is my idea, break df into sub-df at each level 2. Run the code above to get the parents, and then combine each sub-df"}], "tags": [], "owner": {"reputation": 3220, "user_id": 11492024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ip64y.png?s=128&g=1", "display_name": "vlemaistre", "link": "https://stackoverflow.com/users/11492024/vlemaistre"}, "is_accepted": false, "score": 1, "last_activity_date": 1560436526, "last_edit_date": 1560436526, "creation_date": 1560413566, "answer_id": 56576140, "question_id": 56368124, "link": "https://stackoverflow.com/questions/56368124/adding-a-column-to-a-dataframe-containing-the-symbol-of-the-parent-node/56576140#56576140", "title": "Adding a column to a Dataframe containing the Symbol of the parent node", "body": "<p>In this answer I assume that your direct parent is always in a row above your own as it is what your expected output and your diagramm suggests.</p>\n\n<p>With this hypothesis, we can, for each row, take the closest row with a level below the row :</p>\n\n<pre><code>import pandas as pd\n\ndata={\"Symbol\":[\"A\", \"A01\", \"A01B\", \"A01B 1/00\", \"A01B 1/02\", \"A01B 1/022\", \"B\"], \"level\":[2,4,5,7,8,9,2]}\n\ndf=pd.DataFrame(data=data)\ndf['Parent'] = ''\n\nfor index, row in df.iterrows():\n    # We look at the potential parents\n    potential_parents = df.loc[df.index.isin([x for x in range(index)]) &amp; (df['level'] &lt; row['level']), 'Symbol']\n    # And we take the last one as our parent\n    if len(potential_parents) == 0: \n        df.loc[index, 'Parent'] = ''\n    else:\n        df.loc[index, 'Parent'] = potential_parents.iloc[-1]\n</code></pre>\n\n<p>Output : </p>\n\n<pre><code>       Symbol  level     Parent\n0           A      2           \n1         A01      4          A\n2        A01B      5        A01\n3   A01B 1/00      7       A01B\n4   A01B 1/02      8  A01B 1/00\n5  A01B 1/022      9  A01B 1/02\n6           B      2           \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "edited": false, "score": 0, "creation_date": 1560521418, "post_id": 56591975, "comment_id": 99775659, "body": "Interesting. There the highest level symbols is 19. Can you explain the values in hierarchy and how I would modify it to process the entire file?"}, {"owner": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "edited": false, "score": 0, "creation_date": 1560522905, "post_id": 56591975, "comment_id": 99776406, "body": "Alright, figured it out. This solution is many times faster. Thank you! <code>hierarchy = [0, 0, 0, 0, 2, 4, 0, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]</code> <code>parent = [&#39; &#39;]*20</code>"}], "tags": [], "owner": {"reputation": 3765, "user_id": 5828883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/146cf80315cf243c6e1d6bc64cfdb454?s=128&d=identicon&r=PG", "display_name": "RootTwo", "link": "https://stackoverflow.com/users/5828883/roottwo"}, "is_accepted": true, "score": 1, "last_activity_date": 1560490623, "creation_date": 1560490623, "answer_id": 56591975, "question_id": 56368124, "link": "https://stackoverflow.com/questions/56368124/adding-a-column-to-a-dataframe-containing-the-symbol-of-the-parent-node/56591975#56591975", "title": "Adding a column to a Dataframe containing the Symbol of the parent node", "body": "<p>Here's another method.  GetParent() returns a function that keeps track of the most recent symbol for each level and returns the parent of the current level.  Using it in pandas.apply() creates a column with the parent symbols.</p>\n\n<pre><code>def GetParent():\n    #            0  1  2  3  4  5  6  7  8  9  10\n    hierarchy = [0, 0, 0, 0, 2, 4, 0, 5, 7, 8, 9]\n    parent = [' ']*11\n\n    def func(row):\n        #print(row)\n        symbol,level = row[['SYMBOL', 'level']]\n\n        parent_level = hierarchy[level]\n        parent_symbol = parent[parent_level]\n\n        parent[level] = symbol\n\n        return pd.Series([parent_symbol], index=['parent'])\n\n    return func\n\n# create a column with the parents\nparents = df.apply(GetParent(), axis=1)\ndf = pd.concat([df, parents], axis=1)\n\ndf\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>    SYMBOL  level   na      ao      parent\n0   A           2   True    False   \n1   A01         4   True    False   A\n2   A01B        5   True    False   A01\n3   A01B 1/00   7   False   False   A01B\n4   A01B 1/02   8   False   False   A01B 1/00\n5   A01B 1/022  9   False   False   A01B 1/02\n6   A01B 1/024  9   False   False   A01B 1/02\n7   A01B 1/026  9   False   False   A01B 1/02\n8   A01B 1/028  9   False   False   A01B 1/02\n9   A01B 1/04   9   False   False   A01B 1/02\n10  A01B 1/06   8   False   False   A01B 1/00\n11  A01B 1/065  9   False   False   A01B 1/06\n12  A01B 1/08   9   False   False   A01B 1/06\n...\n</code></pre>\n"}], "owner": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 56591975, "answer_count": 2, "score": 0, "last_activity_date": 1560490623, "creation_date": 1559162046, "last_edit_date": 1560348468, "question_id": 56368124, "link": "https://stackoverflow.com/questions/56368124/adding-a-column-to-a-dataframe-containing-the-symbol-of-the-parent-node", "title": "Adding a column to a Dataframe containing the Symbol of the parent node", "body": "<p>I am using bulk data (List of CPC Valid symbols) from the <a href=\"https://www.cooperativepatentclassification.org/cpcSchemeAndDefinitions/Bulk.html\" rel=\"nofollow noreferrer\">CPC website</a>. I've read the csv into a pandas df, and the first 30 rows (of over 260K) are:</p>\n\n<pre><code>    SYMBOL  level   not-allocatable additional-only\n1   A   2   True    False\n2   A01 4   True    False\n3   A01B    5   True    False\n4   A01B 1/00   7   False   False\n5   A01B 1/02   8   False   False\n6   A01B 1/022  9   False   False\n7   A01B 1/024  9   False   False\n8   A01B 1/026  9   False   False\n9   A01B 1/028  9   False   False\n10  A01B 1/04   9   False   False\n11  A01B 1/06   8   False   False\n12  A01B 1/065  9   False   False\n13  A01B 1/08   9   False   False\n14  A01B 1/10   9   False   False\n15  A01B 1/12   9   False   False\n16  A01B 1/14   9   False   False\n17  A01B 1/16   8   False   False\n18  A01B 1/165  9   False   False\n19  A01B 1/18   9   False   False\n20  A01B 1/20   8   False   False\n21  A01B 1/22   8   False   False\n22  A01B 1/222  9   False   False\n23  A01B 1/225  10  False   False\n24  A01B 1/227  9   False   False\n25  A01B 1/24   8   False   False\n26  A01B 1/243  9   False   False\n27  A01B 1/246  9   False   False\n28  A01B 3/00   7   False   False\n29  A01B 3/02   8   False   False\n</code></pre>\n\n<p>The level value creates a hierarchy. So node A01B 1/00 is level 7 and a child of A01B. A01B 1/02 is level 8 and the child of A01B 1/00 &amp; A01b 3/00 is a child of A01B.</p>\n\n<p>What I would like is a way to create a new column called <code>PARENT</code> that contains the <code>SYMBOL</code> of the node's direct parent. For example, I edited the csv in Excel to show the desired result of the first few rows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Cx6lo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Cx6lo.png\" alt=\"The dataframe after adding the parent column\"></a></p>\n\n<blockquote>\n  <p><strong>Note</strong>: there are no level 1, 3, or 6 symbols. There are multiple level 2 symbols. There is no parent for level 2 symbols, the parent of level 4 symbols can be assigned the first level 2 symbol above it, and the parent of level 7 symbols likewise can be assigned the first level 5 symbol above it.</p>\n</blockquote>\n\n<p>EDIT: I need to better explain how to determine a node's parent. The level value and the row position are all that is needed to determine a parent.<a href=\"https://i.stack.imgur.com/rnf4b.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rnf4b.png\" alt=\"Tree showing parents and children\"></a></p>\n\n<p>I would like to use pandas to do the work, but I am not sure how to get started. Any takers? Thank you</p>\n"}, {"tags": ["python"], "comments": [{"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 2, "creation_date": 1559162233, "post_id": 56368123, "comment_id": 99339218, "body": "<code>filename</code> is just the file name, you need to pass the full path to <code>os.stat</code>."}, {"owner": {"reputation": 47, "user_id": 11574917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5335a503d8aae9e29769c61f53ca1adb?s=128&d=identicon&r=PG&f=1", "display_name": "callin", "link": "https://stackoverflow.com/users/11574917/callin"}, "reply_to_user": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1559162505, "post_id": 56368123, "comment_id": 99339317, "body": "Thank you.  I replaced the code and used &quot;f&quot; in the if os.path file and placed it before the .write command and it looks like it&#39;s working now; down to the 553 files as hoped."}], "answers": [{"tags": [], "owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "is_accepted": true, "score": 3, "last_activity_date": 1559162375, "creation_date": 1559162375, "answer_id": 56368188, "question_id": 56368123, "link": "https://stackoverflow.com/questions/56368123/excluding-files-of-a-certain-size/56368188#56368188", "title": "Excluding files of a certain size", "body": "<p>You need to pass the full path to <code>os.stat</code>. Rearrange your code a bit:</p>\n\n<pre><code>for filename in [f for f in filenames if f.endswith(\".txt\")]:\n    f = os.path.join(path, filename)\n    if os.stat(f).st_size &gt; 20000:\n        a.write(str(f) + os.linesep)\n        num_files = num_files + 1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6305326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4dab150ff612436f9aca1d86e878349?s=128&d=identicon&r=PG&f=1", "display_name": "joe_schmoe", "link": "https://stackoverflow.com/users/6305326/joe-schmoe"}, "is_accepted": false, "score": 0, "last_activity_date": 1559162776, "creation_date": 1559162776, "answer_id": 56368267, "question_id": 56368123, "link": "https://stackoverflow.com/questions/56368123/excluding-files-of-a-certain-size/56368267#56368267", "title": "Excluding files of a certain size", "body": "<p>I think you have to include the full path in the <code>if</code> statement. os.path can't find <code>filename</code></p>\n\n<p>Add full path to the file\n<code>os.path.join(path, filename)</code></p>\n\n<p>Also delete that slash at the end of <code>TEXT_FILE_PATH</code></p>\n\n<pre><code>import os\nimport csv\nimport os.path\nmtn_path = r\"TEXT_FILE_PATH\"\na = open(mtn_path + \"output.csv\", 'w+', newline='')\nnum_files = 0\nfor path, dirnames, filenames in os.walk(mtn_path):\n    for filename in [f for f in filenames if f.endswith(\".txt\")]:       \n        if os.stat(os.path.join(path, filename)).st_size &gt; 20000:\n            f = os.path.join(path, filename)\n            a.write(str(f) + os.linesep)\n            num_files = num_files + 1\n)\n#\nprint(\"The total number of text files found was \" + str(num_files))\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 11574917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5335a503d8aae9e29769c61f53ca1adb?s=128&d=identicon&r=PG&f=1", "display_name": "callin", "link": "https://stackoverflow.com/users/11574917/callin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 56368188, "answer_count": 2, "score": 2, "last_activity_date": 1559162776, "creation_date": 1559162044, "last_edit_date": 1559162316, "question_id": 56368123, "link": "https://stackoverflow.com/questions/56368123/excluding-files-of-a-certain-size", "title": "Excluding files of a certain size", "body": "<p>I'm trying to generate a .csv file that lists all .txt file in a sub-directory but can exclude a .txt file of a certain size.</p>\n\n<p>Without an if statement around file size, I can successfully generate the .csv file list that has the full paths to the .txt files (1105 files total)</p>\n\n<pre><code>import os\nimport csv\nimport os.path\nmtn_path = \"TEXT_FILE_PATH\\\\\"\na = open(mtn_path + \"output.csv\", 'w+', newline='')\nnum_files = 0\nfor path, dirnames, filenames in os.walk(mtn_path):\n    for filename in [f for f in filenames if f.endswith(\".txt\")]:\n#       if os.stat(filename).st_size &gt; 20000:\n            f = os.path.join(path, filename)\n            a.write(str(f) + os.linesep)\n            num_files = num_files + 1\n)\n#\nprint(\"The total number of text files found was \" + str(num_files))\n</code></pre>\n\n<p>When I include the if os.stat line, I get the error:</p>\n\n<p>FileNotFoundError: [WinError 2] The system cannot find the file specified: 'INT_NR_H1000Cu_000.mtn_001.txt'</p>\n\n<p>That particular .txt file is the first one listed in the csv file of the working code.</p>\n"}, {"tags": ["python", "windows", "image", "python-2.7", "rotation"], "answers": [{"comments": [{"owner": {"reputation": 490, "user_id": 5377275, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Z_DcwcHvDos/AAAAAAAAAAI/AAAAAAAAAEQ/B7U68v6GxR8/photo.jpg?sz=128", "display_name": "Trevor Keller", "link": "https://stackoverflow.com/users/5377275/trevor-keller"}, "edited": false, "score": 1, "creation_date": 1559163385, "post_id": 56368341, "comment_id": 99339628, "body": "The OP seeks to save under a different name, <i>not</i> to overwrite the original."}], "tags": [], "owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "is_accepted": false, "score": 0, "last_activity_date": 1559164944, "last_edit_date": 1559164944, "creation_date": 1559163160, "answer_id": 56368341, "question_id": 56368107, "link": "https://stackoverflow.com/questions/56368107/rotation-of-images/56368341#56368341", "title": "Rotation of images", "body": "<p>Your code works (I tested it). Here's an improved version, that rotates each image by the 3 mentioned angles and saves it.</p>\n\n<p><em>code.py</em>:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>#!/usr/bin/env python3\n\nimport sys\nimport os\nimport glob\nfrom PIL import Image\n\n\ndef main():\n    img_dir = \"./img\"\n    jpg_ext = \".jpg\"\n    angles = [90, 180, 270]\n    for file_name in glob.iglob(os.path.join(img_dir, \"*\" + jpg_ext)):\n        image = Image.open(file_name)\n        for angle in angles:\n            rot_suffix = \"_r{:03d}{:s}\".format(angle, jpg_ext)\n            file_name_rot = file_name.replace(jpg_ext, rot_suffix)\n            image_rot = image.rotate(angle)\n            image_rot.save(file_name_rot)\n            print(\"Rotated: {:s} by {:3d} degrees to {:s}\".format(file_name, angle, file_name_rot))\n\n\nif __name__ == \"__main__\":\n    print(\"Python {:s} on {:s}\\n\".format(sys.version, sys.platform))\n    main()\n    print(\"\\nDone.\")\n</code></pre>\n\n<p><strong>Output</strong>:</p>\n\n\n\n<blockquote>\n<pre class=\"lang-bat prettyprint-override\"><code>[cfati@CFATI-5510-0:e:\\Work\\Dev\\StackOverflow\\q056368107]&gt; dir /b .\\img\nimage.jpg\nscript_file.py\n\n[cfati@CFATI-5510-0:e:\\Work\\Dev\\StackOverflow\\q056368107]&gt; \"e:\\Work\\Dev\\VEnvs\\py_064_03.07.03_test0\\Scripts\\python.exe\" code.py\nPython 3.7.3 (v3.7.3:ef4ec6ed12, Mar 25 2019, 22:22:05) [MSC v.1916 64 bit (AMD64)] on win32\n\nRotated: ./img\\image.jpg by  90 degrees to ./img\\image_r090.jpg\nRotated: ./img\\image.jpg by 180 degrees to ./img\\image_r180.jpg\nRotated: ./img\\image.jpg by 270 degrees to ./img\\image_r270.jpg\n\nDone.\n\n[cfati@CFATI-5510-0:e:\\Work\\Dev\\StackOverflow\\q056368107]&gt; dir /b .\\img\nimage.jpg\nimage_r090.jpg\nimage_r180.jpg\nimage_r270.jpg\nscript_file.py\n</code></pre>\n</blockquote>\n\n<p>For more details regarding the operations performed on strings, check <a href=\"https://docs.python.org/3/library/string.html#format-string-syntax\" rel=\"nofollow noreferrer\">[Python 3.Docs]: Format String Syntax</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 490, "user_id": 5377275, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Z_DcwcHvDos/AAAAAAAAAAI/AAAAAAAAAEQ/B7U68v6GxR8/photo.jpg?sz=128", "display_name": "Trevor Keller", "link": "https://stackoverflow.com/users/5377275/trevor-keller"}, "is_accepted": false, "score": 0, "last_activity_date": 1559163653, "last_edit_date": 1559163653, "creation_date": 1559163305, "answer_id": 56368374, "question_id": 56368107, "link": "https://stackoverflow.com/questions/56368107/rotation-of-images/56368374#56368374", "title": "Rotation of images", "body": "<p>Your exact code works perfectly as-is: given image <code>original.jpg</code>, it flips (rotates 180 degrees) and saves it as <code>original_r180.jpg</code>. The <code>os.chdir</code> is extraneous, since changing to the current directory is a null-op, but it's not wrong. </p>\n\n<p>If you need to do all three, consider this:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import glob\nfrom PIL import Image\nos.chdir(\"./\")\nfor file in glob.glob(\"*.jpg\"):\n    for angle in (90, 180, 270):\n        image = Image.open(file)\n        image_rot = image.rotate(angle)\n        image_rot.save(file.replace(\".jpg\", \"_r{0}.jpg\".format(angle)))\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11506429, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Y-I5fI23H6Y/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rciE8oRlHIJDoYu3jsfvvLI1dkOCw/mo/photo.jpg?sz=128", "display_name": "ELW", "link": "https://stackoverflow.com/users/11506429/elw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 675, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559164944, "creation_date": 1559161989, "question_id": 56368107, "link": "https://stackoverflow.com/questions/56368107/rotation-of-images", "title": "Rotation of images", "body": "<p>I need to rotate an image by 90, 180, and 270 degrees. I do not need to copy over the image, but rather save the rotated image as its own separate image. So far, my code will rotate the image but will not save it as its own separate file. This is what I have so far.</p>\n\n<pre><code>import os\nimport glob\nfrom PIL import Image\nos.chdir(\"./\")\nfor file in glob.glob(\"*.jpg\"):\n    image = Image.open(file)\n    image_rot_180 = image.rotate(180)\n    image_rot_180.save(file.replace(\".jpg\", \"_r180.jpg\"))\n</code></pre>\n"}, {"tags": ["python", "numpy", "floating-point", "overflow", "rounding"], "comments": [{"owner": {"reputation": 24610, "user_id": 270986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49652c88a43a35bbf0095abfdae3515?s=128&d=identicon&r=PG", "display_name": "Mark Dickinson", "link": "https://stackoverflow.com/users/270986/mark-dickinson"}, "edited": false, "score": 0, "creation_date": 1559469760, "post_id": 56368092, "comment_id": 99424339, "body": "I opened an upstream issue: <a href=\"https://github.com/numpy/numpy/issues/13699\" rel=\"nofollow noreferrer\">github.com/numpy/numpy/issues/13699</a>"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 8667583, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gl8brI1UN-Q/AAAAAAAAAAI/AAAAAAABOCk/q209q38GBfg/photo.jpg?sz=128", "display_name": "Dan Hoogterp", "link": "https://stackoverflow.com/users/8667583/dan-hoogterp"}, "edited": false, "score": 0, "creation_date": 1559430458, "post_id": 56400095, "comment_id": 99419233, "body": "Thank you very much for your thorough response.  That certainly makes the cause clear.  I agree that it may not be a bug, but it is a nuisance subtlety at least.  Numpy is so incredibly impressive, this is a microscopic nuisance.  I&#39;m really impressed with numpy (and scipy)."}], "tags": [], "owner": {"reputation": 24610, "user_id": 270986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49652c88a43a35bbf0095abfdae3515?s=128&d=identicon&r=PG", "display_name": "Mark Dickinson", "link": "https://stackoverflow.com/users/270986/mark-dickinson"}, "is_accepted": false, "score": 3, "last_activity_date": 1559328395, "last_edit_date": 1559328395, "creation_date": 1559327116, "answer_id": 56400095, "question_id": 56368092, "link": "https://stackoverflow.com/questions/56368092/why-does-python-roundnp-float16np-pi-5-return-infinity-bug-limitation-or/56400095#56400095", "title": "Why does python round(np.float16(np.pi),5) return infinity? Bug, limitation, or expected?", "body": "<p>This is a limitation of NumPy's <code>round</code> algorithm. I hesitate to call it a bug: that's for the NumPy core developers to decide, but it may be worth reporting nevertheless.</p>\n\n<p>Here's the problem: to round to 5 decimal places, NumPy does the equivalent of scaling by <code>100000.0</code>, rounding to the nearest integer, then diving by <code>100000.0</code> again. That initial scaling can potentially overflow, even when the final result of the <code>round</code> operation would be expected to be within range.</p>\n\n<p>Here's the portion of the <a href=\"https://github.com/numpy/numpy/blob/75ea05fc0af60c685e6c071dae1f04c489a3ce93/numpy/core/src/multiarray/calculation.c#L715-L736\" rel=\"nofollow noreferrer\">NumPy source</a> where this is implemented. You need to backtrack a bit in the source to figure out that in this case <code>op1</code> is multiplication and <code>op2</code> refers to division.</p>\n\n<p>With <code>float64</code> or <code>float32</code> this would be unlikely to cause issues, because for normal uses you're unlikely to be within <code>100000.0</code> of the upper bound of the representable range of the floating-point type. But if you do get too close to that upper bound, you'll see the same problem. Here's an example with <code>np.float64</code>:</p>\n\n<pre><code>&gt;&gt;&gt; np.finfo(np.float64).max\n1.7976931348623157e+308\n&gt;&gt;&gt; x = np.float64(1e304)  # pick something within 1e5 of that max\n&gt;&gt;&gt; x * 1e5\n__main__:1: RuntimeWarning: overflow encountered in double_scalars\ninf\n&gt;&gt;&gt; np.round(x, 5)  # same multiplication happening internally\n/opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/numpy/core/fromnumeric.py:56: RuntimeWarning: overflow encountered in multiply\n  return getattr(obj, method)(*args, **kwds)\ninf\n</code></pre>\n\n<p>And here's the same thing with <code>float32</code>:</p>\n\n<pre><code>&gt;&gt;&gt; np.finfo(np.float32).max\n3.4028235e+38\n&gt;&gt;&gt; x = np.float32(1e35)\n&gt;&gt;&gt; x * 1e5  # okay; NumPy converts to `float64`\n1.0000000409184788e+40\n&gt;&gt;&gt; np.round(x, 5)\ninf\n</code></pre>\n\n<p>With <code>np.float16</code>, it's exactly the same issue, but since the dynamic range of the <code>float16</code> type is so small, you're much more likely to observe the issue in practice.</p>\n\n<p>In general, though, note that even if this were fixed, it <em>is</em> possible for two-argument <code>round</code> to overflow: it's possible that the original value is within the range of the relevant floating-point type, while the rounded value is not. Here's an example with Python's own <code>round</code> function:</p>\n\n<pre><code>&gt;&gt;&gt; x = 1.76e308\n&gt;&gt;&gt; x\n1.76e+308\n&gt;&gt;&gt; round(x, -307)  # should be 1.8e308, but that's out of range\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nOverflowError: rounded value too large to represent\n</code></pre>\n\n<p>But this can only happen for a negative <code>ndigits</code> argument. If the second argument were nonnegative, then there's no possibility of overflow - every sufficiently large representable value in any of the standard floating-point types is already integral, so a <code>round</code> with a nonnegative <code>ndigits</code> shouldn't change its value.</p>\n"}], "owner": {"reputation": 61, "user_id": 8667583, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gl8brI1UN-Q/AAAAAAAAAAI/AAAAAAABOCk/q209q38GBfg/photo.jpg?sz=128", "display_name": "Dan Hoogterp", "link": "https://stackoverflow.com/users/8667583/dan-hoogterp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 2, "answer_count": 1, "score": 6, "last_activity_date": 1559328395, "creation_date": 1559161924, "last_edit_date": 1559200851, "question_id": 56368092, "link": "https://stackoverflow.com/questions/56368092/why-does-python-roundnp-float16np-pi-5-return-infinity-bug-limitation-or", "title": "Why does python round(np.float16(np.pi),5) return infinity? Bug, limitation, or expected?", "body": "<p>I have a Python 3 function rounding floats to 6 digits (the logic handles various precision levels).  When passed with many (possibly all) numpy.float16 values it generates multiply-overflow warnings and returns infinity.</p>\n\n<p>The short snippet in the question title or shown below illustrates the behavior. </p>\n\n<p>The workaround is easy, just convert to larger floats first, but I'm curious whether the behavior is expected.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import numpy as np\nx = np.float16(3.14)\nx = round(x, 5)\nif np.isinf(x):\n    print(\"you've made an infinity through rounding....\", 1, x)\nelse:\n    print('just x: ', x)\n</code></pre>\n\n<p>I expect round to affect precision, but never cause an overflow or change a value into infinity.</p>\n"}, {"tags": ["python", "ansible"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 7480380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b65a30c1c0e790d4ac9c9f253c04f6c?s=128&d=identicon&r=PG&f=1", "display_name": "oraclept", "link": "https://stackoverflow.com/users/7480380/oraclept"}, "edited": false, "score": 0, "creation_date": 1559180193, "post_id": 56368584, "comment_id": 99343554, "body": "You mean to run ansible playbook in shell script and call that script using subprocess? subprocess has 3 options 1. Popen 2. call and 3. run. Which one will be preferred in this case? Ansible playbook runs for more than 30 min.  I want to collect output and wait. looks like call is preferred approach."}, {"owner": {"reputation": 3429, "user_id": 11332370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f6dff2145c158175c200ae87e88fbc1?s=128&d=identicon&r=PG&f=1", "display_name": "Alassane Ndiaye", "link": "https://stackoverflow.com/users/11332370/alassane-ndiaye"}, "reply_to_user": {"reputation": 27, "user_id": 7480380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b65a30c1c0e790d4ac9c9f253c04f6c?s=128&d=identicon&r=PG&f=1", "display_name": "oraclept", "link": "https://stackoverflow.com/users/7480380/oraclept"}, "edited": false, "score": 0, "creation_date": 1559205616, "post_id": 56368584, "comment_id": 99350694, "body": "Yes, if you are waiting for the process to terminate, then <code>call</code> is the most straightforward way. Do note that <code>popen</code> is the most general function, and <code>call</code> is just a wrapper around it though."}, {"owner": {"reputation": 3429, "user_id": 11332370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f6dff2145c158175c200ae87e88fbc1?s=128&d=identicon&r=PG&f=1", "display_name": "Alassane Ndiaye", "link": "https://stackoverflow.com/users/11332370/alassane-ndiaye"}, "reply_to_user": {"reputation": 27, "user_id": 7480380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b65a30c1c0e790d4ac9c9f253c04f6c?s=128&d=identicon&r=PG&f=1", "display_name": "oraclept", "link": "https://stackoverflow.com/users/7480380/oraclept"}, "edited": false, "score": 0, "creation_date": 1559205784, "post_id": 56368584, "comment_id": 99350764, "body": "And to answer your first question, I meant something like <code>subprocess.call([&quot;ansible-playbook&quot;, &quot;playbook.yaml&quot;, etc...])</code>"}], "tags": [], "owner": {"reputation": 3429, "user_id": 11332370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f6dff2145c158175c200ae87e88fbc1?s=128&d=identicon&r=PG&f=1", "display_name": "Alassane Ndiaye", "link": "https://stackoverflow.com/users/11332370/alassane-ndiaye"}, "is_accepted": false, "score": 0, "last_activity_date": 1559206106, "last_edit_date": 1559206106, "creation_date": 1559164334, "answer_id": 56368584, "question_id": 56367942, "link": "https://stackoverflow.com/questions/56367942/calling-ansible-adhoc-commands-playbooks-in-python-script/56368584#56368584", "title": "Calling Ansible adhoc commands/playbooks in python script", "body": "<p>Ansible doesn't recommend using that method. Quoting directly from the link you shared:</p>\n\n<blockquote>\n  <p>This API is intended for internal Ansible use. Ansible may make\n  changes to this API at any time that could break backward\n  compatibility with older versions of the API. Because of this,\n  external use is not supported by Ansible.</p>\n</blockquote>\n\n<p>Another option would be to use the <a href=\"https://docs.python.org/2/library/subprocess.html\" rel=\"nofollow noreferrer\">subprocess</a> library to call your command using the command line syntax (as opposed to the API).</p>\n"}], "owner": {"reputation": 27, "user_id": 7480380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b65a30c1c0e790d4ac9c9f253c04f6c?s=128&d=identicon&r=PG&f=1", "display_name": "oraclept", "link": "https://stackoverflow.com/users/7480380/oraclept"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 471, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559206106, "creation_date": 1559161221, "question_id": 56367942, "link": "https://stackoverflow.com/questions/56367942/calling-ansible-adhoc-commands-playbooks-in-python-script", "title": "Calling Ansible adhoc commands/playbooks in python script", "body": "<p>How to run Ansible playbooks and commands from python script</p>\n\n<p>Is this suggesgted way?\n<a href=\"https://docs.ansible.com/ansible/latest/dev_guide/developing_api.html#python-api-example\" rel=\"nofollow noreferrer\">https://docs.ansible.com/ansible/latest/dev_guide/developing_api.html#python-api-example</a></p>\n\n<p>Called ansible playbook/adhoc commands runs smoothly inside python script</p>\n"}, {"tags": ["python", "python-3.x", "pandas", "data-science", "data-analysis"], "comments": [{"owner": {"reputation": 8568, "user_id": 9177877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5qL1i.png?s=128&g=1", "display_name": "It_is_Chris", "link": "https://stackoverflow.com/users/9177877/it-is-chris"}, "edited": false, "score": 0, "creation_date": 1559161802, "post_id": 56367907, "comment_id": 99339071, "body": "your data types are mismatched you are dividing a <code>string</code> by and <code>integer</code>"}, {"owner": {"reputation": 1432, "user_id": 8797830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4fcb3728cc624f1a3f54e7842f8b200?s=128&d=identicon&r=PG&f=1", "display_name": "Chris90", "link": "https://stackoverflow.com/users/8797830/chris90"}, "reply_to_user": {"reputation": 8568, "user_id": 9177877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5qL1i.png?s=128&g=1", "display_name": "It_is_Chris", "link": "https://stackoverflow.com/users/9177877/it-is-chris"}, "edited": false, "score": 0, "creation_date": 1559162324, "post_id": 56367907, "comment_id": 99339253, "body": "@Chris thanks sir, is there anyway I can resolve this?"}], "answers": [{"comments": [{"owner": {"reputation": 1432, "user_id": 8797830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4fcb3728cc624f1a3f54e7842f8b200?s=128&d=identicon&r=PG&f=1", "display_name": "Chris90", "link": "https://stackoverflow.com/users/8797830/chris90"}, "edited": false, "score": 0, "creation_date": 1559179725, "post_id": 56368337, "comment_id": 99343473, "body": "this seems close, but the only thing it doesn&#39;t do is group by the day my final output when I try this has multiple rows for each day when I want only one row for each day, does that make sense? sorry for the confusion"}], "tags": [], "owner": {"reputation": 156, "user_id": 10543771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e94484df4836384fbbf9e888d596e01?s=128&d=identicon&r=PG&f=1", "display_name": "RyanL", "link": "https://stackoverflow.com/users/10543771/ryanl"}, "is_accepted": true, "score": 1, "last_activity_date": 1559163153, "creation_date": 1559163153, "answer_id": 56368337, "question_id": 56367907, "link": "https://stackoverflow.com/questions/56367907/grouping-by-date-column-and-applying-a-function-to-group-by/56368337#56368337", "title": "Grouping by date column and applying a function to group by", "body": "<p>I am not totally sure what you want your final dataframe to look like but it looks like this is something you can do.</p>\n\n<p>Using this dataframe as input:</p>\n\n<pre><code>       day   a   b\n0  5/11/19   3   1\n1  5/11/19  11   3\n2  5/12/19   5   9\n3  5/13/19  11  14\n\ndef calc(df):\n\n    len_a_under_10 = (df['a'] &lt; 10).sum() / len(df['a'])\n    len_b_under_10 = (df['b'] &lt; 10).sum() / len(df['b'])\n\n    df['a_under_10'] = len_a_under_10\n    df['b_under_10'] = len_b_under_10\n\nreturn df\n\ndf.groupby('day').apply(calc)\n</code></pre>\n\n<p>Gives:</p>\n\n<pre><code>       day   a   b  a_under_10  b_under_10\n0  5/11/19   3   1         0.5         1.0\n1  5/11/19  11   3         0.5         1.0\n2  5/12/19   5   9         1.0         1.0\n3  5/13/19  11  14         0.0         0.0\n</code></pre>\n"}], "owner": {"reputation": 1432, "user_id": 8797830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4fcb3728cc624f1a3f54e7842f8b200?s=128&d=identicon&r=PG&f=1", "display_name": "Chris90", "link": "https://stackoverflow.com/users/8797830/chris90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 56368337, "answer_count": 1, "score": -1, "last_activity_date": 1559179665, "creation_date": 1559161043, "last_edit_date": 1559179665, "question_id": 56367907, "link": "https://stackoverflow.com/questions/56367907/grouping-by-date-column-and-applying-a-function-to-group-by", "title": "Grouping by date column and applying a function to group by", "body": "<p>I tried asking a question earlier, but deleted so I could ask clearer and show what I am trying if it is close.</p>\n\n<p>My sample df is </p>\n\n<pre><code>    day         a   b\n  5/11/19       3   1\n  5/11/19       4   6\n  5/12/19       1   2\n  5/12/19       5   9\n  5/13/19      11   14\n</code></pre>\n\n<p>I want to group by the day column and want to have a new df that calculates for both col a and col b the number of values that are &lt; 10 / all values for that day and column ( a or b) as a %. Since there are numerous rows for each day. </p>\n\n<p>I am trying something like </p>\n\n<pre><code>def calc_(group_df):\nresult = dict()\nresult[\"x\"] = group_df[(group_df.x) &lt; 10] / len(group_df.x)\nresult[\"y\"] = group_df[(group_df.y) &lt; 10] / len(group_df.y)\nreturn pd.Series(result, index=[\"x\", \"y\"])\n</code></pre>\n\n<p>and then </p>\n\n<pre><code>df.groupby(\"day\").apply(calc)\n</code></pre>\n\n<p>but I am getting error of </p>\n\n<p><strong><em>TypeError: Could not operate 163143 with block values unsupported operand type(s) for /: 'str' and 'int'</em></strong></p>\n\n<p>Am I missing something?</p>\n\n<p>I want my final output </p>\n\n<pre><code>     day         a   b\n  5/11/19       .3  .1\n  5/12/19       .5  .9\n  5/13/19       .1  .4\n</code></pre>\n\n<p>I want it grouped by the business day and want each business day to show up only once in my final output. </p>\n"}, {"tags": ["python", "statistics"], "answers": [{"tags": [], "owner": {"reputation": 1160, "user_id": 11542188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6274585f76bff6b24e744a25dfa4f30?s=128&d=identicon&r=PG&f=1", "display_name": "Masoud", "link": "https://stackoverflow.com/users/11542188/masoud"}, "is_accepted": true, "score": 2, "last_activity_date": 1559174253, "creation_date": 1559174253, "answer_id": 56369984, "question_id": 56367891, "link": "https://stackoverflow.com/questions/56367891/simultaneously-fit-two-linear-functions-with-a-single-slope/56369984#56369984", "title": "Simultaneously fit two linear functions with a single slope", "body": "<p>I think you are going to do a <a href=\"https://en.wikipedia.org/wiki/Simple_linear_regression\" rel=\"nofollow noreferrer\">simple linear regression</a>. The problem here is to minimize the error for two linear functions with identical interception. The error function is:</p>\n\n<pre><code>def f(params):\n    alpha, betha_1, betha_2 = params\n    e_1 = np.power(y1- alpha - (betha_1 * x),2)\n    e_2 = np.power(y2- alpha - (betha_2 * x),2)\n    error = np.sum(e_1 + e_2)\n    return error\n</code></pre>\n\n<p>I used <code>scipy.optimize.minimize</code> to get optimum parameters. The final code is:</p>\n\n<pre><code>import numpy as np\nfrom scipy.optimize import minimize\nimport matplotlib.pyplot as plt\n\ny2 = [9, 11, 10, 12, 13, 12, 12]\ny1 = [10, 12, 11, 12, 12, 13, 14]\nx = [0, 1, 2, 3, 4, 5, 6]\nx, y1, y2 = np.array(x), np.array(y1), np.array(y2)\n\ndef f(params):\n    alpha, betha_1, betha_2 = params\n    e_1 = np.power(y1- alpha - (betha_1 * x),2)\n    e_2 = np.power(y2- alpha - (betha_2 * x),2)\n    error = np.sum(e_1 + e_2)\n    return error\n\ninitial_guess = [1, 1, 1]\nresult = minimize(f, initial_guess)\n\nxfine = np.arange(0, 6, 0.001)\ny1_reg = result.x[0] + result.x[1]*xfine\ny2_reg = result.x[0] + result.x[2]*xfine\n\nplt.plot(x, y1, 'bo', x, y2, 'go', xfine, y1_reg, 'b', xfine, y2_reg, 'g')\nplt.show()\n</code></pre>\n\n<p>and the result:\n<a href=\"https://i.stack.imgur.com/c2CIl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c2CIl.png\" alt=\"Liear Regression Result\"></a></p>\n"}], "owner": {"reputation": 111, "user_id": 3301721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96c8ff5a91318ea7e2be690120714839?s=128&d=identicon&r=PG", "display_name": "Eduardo", "link": "https://stackoverflow.com/users/3301721/eduardo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "closed_date": 1559178823, "accepted_answer_id": 56369984, "answer_count": 1, "score": 0, "last_activity_date": 1559193542, "creation_date": 1559160928, "last_edit_date": 1559193542, "question_id": 56367891, "link": "https://stackoverflow.com/questions/56367891/simultaneously-fit-two-linear-functions-with-a-single-slope", "closed_reason": "Needs more focus", "title": "Simultaneously fit two linear functions with a single slope", "body": "<p>I have two sets of experimental data, as shown on the figure <a href=\"https://i.stack.imgur.com/935OJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/935OJ.png\" alt=\"figure\"></a>\nFor <img src=\"https://latex.codecogs.com/gif.latex?x&space;=&space;0\" alt=\"x = 0\"> the measured data must be the same for the two sets. Therefore, I would like to fit both sets simultaneously, defining a single y-intercept and two slopes. As far as I understand, <a href=\"https://stackoverflow.com/questions/48674558/how-to-implement-automatic-model-determination-and-two-state-model-fitting-in-py\">this question</a> does not solve my problem.</p>\n"}, {"tags": ["python", "pip", "setup.py", "python-packaging"], "comments": [{"owner": {"reputation": 3227, "user_id": 4572274, "user_type": "registered", "profile_image": "https://graph.facebook.com/420310811459015/picture?type=large", "display_name": "yardstick17", "link": "https://stackoverflow.com/users/4572274/yardstick17"}, "reply_to_user": {"reputation": 263603, "user_id": 674039, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/leoFi.gif?s=128&g=1", "display_name": "wim", "link": "https://stackoverflow.com/users/674039/wim"}, "edited": false, "score": 0, "creation_date": 1559164766, "post_id": 56367877, "comment_id": 99340077, "body": "Added the project link which has the same behaviour as described."}], "answers": [{"tags": [], "owner": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "is_accepted": true, "score": 1, "last_activity_date": 1559163229, "creation_date": 1559163229, "answer_id": 56368360, "question_id": 56367877, "link": "https://stackoverflow.com/questions/56367877/version-dependency-error-with-setup-py-but-installs-successfully-with-pip-instal/56368360#56368360", "title": "Version dependency error with setup.py but installs successfully with pip install", "body": "<p>No, <code>pip install</code> is not the equivalent of <code>python setup.py install</code>; they differ in multiple aspects.  One of the ways they differ is that <code>pip</code> can downgrade packages (uninstall and then reinstall a lower version) in order to meet a version requirement.  Under certain circumstances, <code>pip</code> is even fine with installing conflicting requirements; it'll print out an error message in red, but the command will still exit with status 0.  Inspecting the output from <code>pip install</code> should tell you exactly what is going on.</p>\n"}], "owner": {"reputation": 3227, "user_id": 4572274, "user_type": "registered", "profile_image": "https://graph.facebook.com/420310811459015/picture?type=large", "display_name": "yardstick17", "link": "https://stackoverflow.com/users/4572274/yardstick17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 56368360, "answer_count": 1, "score": 1, "last_activity_date": 1559220113, "creation_date": 1559160879, "last_edit_date": 1559220113, "question_id": 56367877, "link": "https://stackoverflow.com/questions/56367877/version-dependency-error-with-setup-py-but-installs-successfully-with-pip-instal", "title": "Version dependency error with setup.py but installs successfully with pip install", "body": "<p>I have a project with the following directory structure:</p>\n\n<pre><code>- module_A\n  - a.py\n- module_B\n  - b.py\nrequirements.txt\nsetup.py\n</code></pre>\n\n<p>The project has the dependency on standard python packages, and other git packages. They are listed in <code>requirements.txt</code>.</p>\n\n<p>This projects is successfully installed when I install with pip.</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>pip install --process-dependency-links -e .\n</code></pre>\n\n<p>But when I try to install with the setup.py with the command</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>python setup.py install\n</code></pre>\n\n<p>It throws a processing dependencies error.</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>Installed /private/tmp/py2/.venv/lib/python2.7/site-packages/aspect_based_sentiment_analysis-0.0.4-py2.7.egg\nProcessing dependencies for aspect-based-sentiment-analysis==0.0.4\nerror: pandas 0.17.1 is installed but pandas==0.23.4 is required by set(['PyAthena'])\n</code></pre>\n\n<p>Project <a href=\"https://github.com/yardstick17/AspectBasedSentimentAnalysis\" rel=\"nofollow noreferrer\">link</a></p>\n\n<p>As far as I understand, pip command is equivalent of <code>python setup.py install</code>. It would be great if someone can explain what is going behind the scene.</p>\n\n<p><strong>Update</strong></p>\n\n<p>pip does log the dependency mismatch warning</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>pyathena 0.2.1 has requirement pandas==0.23.4, but you'll have pandas 0.17.1 which is incompatible.\n</code></pre>\n\n<p>Is there any way package can be installed using <code>setup.py</code>?</p>\n"}, {"tags": ["python", "c++", "pybind11"], "answers": [{"tags": [], "owner": {"reputation": 3137, "user_id": 170413, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c2574774985d332827840f73fbd3622e?s=128&d=identicon&r=PG", "display_name": "eacousineau", "link": "https://stackoverflow.com/users/170413/eacousineau"}, "is_accepted": false, "score": 0, "last_activity_date": 1560859299, "creation_date": 1560859299, "answer_id": 56648670, "question_id": 56367837, "link": "https://stackoverflow.com/questions/56367837/downcast-to-pybind11-derived-class/56648670#56648670", "title": "Downcast to pybind11 derived class", "body": "<p>I think that you're probably suffering from this suite of problems:</p>\n\n<p><a href=\"https://github.com/pybind/pybind11/issues/1774\" rel=\"nofollow noreferrer\">https://github.com/pybind/pybind11/issues/1774</a></p>\n\n<p>Ultimately, because you're just returning <code>MyState</code> straight out the gate, which then goes straight to C++, the Python interpreter loses track of your instance, and goes ahead and garbage collects the Python-portion of the object, which is why your object ends up getting kinda <a href=\"https://en.wikipedia.org/wiki/Object_slicing\" rel=\"nofollow noreferrer\">sliced</a>.</p>\n\n<p>Potential solutions:</p>\n\n<ul>\n<li>Stash a reference to your return <code>MyState</code>,at least long enough for the Python interpreter to get a reference again.\n\n<ul>\n<li>e.g. change <code>return MyState(...)</code> to <code>self._stashed_state = MyState(...); return self._stashed_state</code></li>\n</ul></li>\n<li>See if you can somehow <code>incref</code> on the Python version of your class in C++ (yuck, but it'll work)</li>\n<li>Review the workarounds listed in the aforementioned issues (can't remember all of 'em)</li>\n<li>Use our fork of <code>pybind11</code>, which handles this, but also drags in other stuff: <a href=\"https://github.com/YannickJadoul/pybind11-cleanup/blob/be4c7a38801d351bdb1b9b47e973a10a5197fc3a/FORKS.md\" rel=\"nofollow noreferrer\">overview for RobotLocomotion/pybind11</a></li>\n</ul>\n\n<p>You may also want to post on one of the existing issues mentioning that you encountered this problem as well (just so that it can be tracked).</p>\n"}], "owner": {"reputation": 3118, "user_id": 1253415, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/87096d37b6aed093f1b142c6a9bfae91?s=128&d=identicon&r=PG", "display_name": "jcai", "link": "https://stackoverflow.com/users/1253415/jcai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 487, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1560859299, "creation_date": 1559160758, "question_id": 56367837, "link": "https://stackoverflow.com/questions/56367837/downcast-to-pybind11-derived-class", "title": "Downcast to pybind11 derived class", "body": "<p>I'm using the \"<a href=\"https://pybind11.readthedocs.io/en/stable/advanced/classes.html\" rel=\"nofollow noreferrer\">Overriding virtual functions in Python</a>\" feature of pybind11 to create Python classes that inherit from C++ abstract classes. I have a C++ class <code>State</code> which is subclassed in Python as <code>MyState</code>. In this situation I have some <code>MyState</code> object that lost its type information and Python thinks it's a <code>State</code>. I need to downcast it back to <code>MyState</code> in Python code and I don't know a good way to do this.</p>\n\n<p>Here's the C++ example code:</p>\n\n<pre><code>#include &lt;memory&gt;\n\n#include &lt;pybind11/pybind11.h&gt;\n\nnamespace py = pybind11;\n\n// ========== State ==========\n\nclass State {\n public:\n  virtual ~State() = default;\n\n  virtual void dump() = 0;\n};\n\nusing StatePtr = std::shared_ptr&lt;State&gt;;\n\nclass PyState : public State {\n public:\n  using State::State;\n\n  void dump() override {\n    PYBIND11_OVERLOAD_PURE(void, State, dump);\n  }\n};\n\n// ========== Machine ==========\n\nclass Machine {\n public:\n  virtual ~Machine() = default;\n\n  virtual StatePtr begin() = 0;\n\n  virtual StatePtr step(const StatePtr&amp;) = 0;\n};\n\nusing MachinePtr = std::shared_ptr&lt;Machine&gt;;\n\nclass PyMachine : public Machine {\n public:\n  using Machine::Machine;\n\n  StatePtr begin() override {\n    PYBIND11_OVERLOAD_PURE(StatePtr, Machine, begin);\n  }\n\n  StatePtr step(const StatePtr&amp; state) override {\n    PYBIND11_OVERLOAD_PURE(StatePtr, Machine, step, state);\n  }\n};\n\n// ========== run ==========\n\nvoid run(const MachinePtr&amp; machine) {\n  StatePtr state = machine-&gt;begin();\n  for (int i = 0; i &lt; 5; ++i) {\n    state = machine-&gt;step(state);\n    state-&gt;dump();\n  }\n}\n\n// ========== pybind11 ==========\n\nPYBIND11_MODULE(example, m) {\n  py::class_&lt;State, StatePtr, PyState&gt;(m, \"State\").def(py::init&lt;&gt;());\n  py::class_&lt;Machine, MachinePtr, PyMachine&gt;(m, \"Machine\")\n      .def(py::init&lt;&gt;())\n      .def(\"begin\", &amp;Machine::begin)\n      .def(\"step\", &amp;Machine::step);\n  m.def(\"run\", &amp;run, \"Run the machine\");\n}\n</code></pre>\n\n<p>And the Python code:</p>\n\n<pre><code>#!/usr/bin/env python3\n\nfrom example import Machine, State, run\n\n\nclass MyState(State):\n    def __init__(self, x):\n        State.__init__(self)\n        self.x = x\n\n    def dump(self):\n        print(self.x)\n\n\nclass MyMachine(Machine):\n    def __init__(self):\n        Machine.__init__(self)\n\n    def begin(self):\n        return MyState(0)\n\n    def step(self, state):\n        # problem: when called from C++, `state` is an `example.State`\n        # instead of `MyState`. In order to access `state.x` we need\n        # some way to downcast it...\n        return MyState(state.x + 1)\n\n\nmachine = MyMachine()\n\nprint(\"running machine with python\")\nstate = machine.begin()\nfor _ in range(5):\n    state = machine.step(state)\n    state.dump()\n\nprint(\"running machine with C++\")\nrun(machine)  # error\n</code></pre>\n\n<p>Error message:</p>\n\n<pre><code>running machine with python\n1\n2\n3\n4\n5\nrunning machine with C++\nTraceback (most recent call last):\n  File \"&lt;string&gt;\", line 38, in &lt;module&gt;\n  File \"&lt;string&gt;\", line 36, in __run\n  File \"/usr/local/fbcode/platform007/lib/python3.6/runpy.py\", line 193, in _run_module_as_main\n    \"__main__\", mod_spec)\n  File \"/usr/local/fbcode/platform007/lib/python3.6/runpy.py\", line 85, in _run_code\n    exec(code, run_globals)\n  File \"/data/users/jcai/fbsource/fbcode/buck-out/dev/gen/experimental/jcai/pybind/run_example#link-tree/run_example.py\", line 38, in &lt;module&gt;\n    run(machine)  # error\n  File \"/data/users/jcai/fbsource/fbcode/buck-out/dev/gen/experimental/jcai/pybind/run_example#link-tree/run_example.py\", line 26, in step\n    return MyState(state.x + 1)\nAttributeError: 'example.State' object has no attribute 'x'\n</code></pre>\n\n<p>I do have a hacky workaround where I basically keep a \"downcast map\" <code>std::unordered_map&lt;State*, py::object&gt;</code> and register every created <code>MyState</code> with it. But I prefer not to resort to such things.</p>\n"}, {"tags": ["python", "pandas"], "answers": [{"tags": [], "owner": {"reputation": 970, "user_id": 10620028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76e9c6ed74b548534059fec223fcc94?s=128&d=identicon&r=PG&f=1", "display_name": "iamchoosinganame", "link": "https://stackoverflow.com/users/10620028/iamchoosinganame"}, "is_accepted": true, "score": 0, "last_activity_date": 1559160859, "creation_date": 1559160859, "answer_id": 56367869, "question_id": 56367822, "link": "https://stackoverflow.com/questions/56367822/how-to-drop-multiple-columns-from-a-pandas-dataframe-if-it-contains-any-alphabet/56367869#56367869", "title": "How to drop multiple columns from a pandas dataframe if it contains any alphabet (non numeric)?", "body": "<p>The following will convert numeric strings to number dtypes and select only the numeric dtypes from the DataFrame.</p>\n\n<pre><code>#convert number columns to numeric\ndf=df.apply(pd.to_numeric, errors='ignore')\ndf=df.select_dtypes('number')\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11476375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5ba4619cf4dc3057f112a394b6a6a9?s=128&d=identicon&r=PG&f=1", "display_name": "kusshal", "link": "https://stackoverflow.com/users/11476375/kusshal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 56367869, "answer_count": 1, "score": 0, "last_activity_date": 1559161822, "creation_date": 1559160698, "last_edit_date": 1559161822, "question_id": 56367822, "link": "https://stackoverflow.com/questions/56367822/how-to-drop-multiple-columns-from-a-pandas-dataframe-if-it-contains-any-alphabet", "title": "How to drop multiple columns from a pandas dataframe if it contains any alphabet (non numeric)?", "body": "<p>I have pulled data from hive into python using pyhive. Now I have created a dataframe from the data imported. The dtype of all the columns in the dataframe is object. I wanted to know the best way to drop any column in the data frame that contains an alphabet(non numeric)?</p>\n\n<p>df.select_dtypes(['number']) wouldnt work since all my columns are dtype=object.</p>\n"}, {"tags": ["python", "django", "django-email"], "comments": [{"owner": {"reputation": 1932, "user_id": 8291840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/20Unf.png?s=128&g=1", "display_name": "I\u015f\u0131k Kaplan", "link": "https://stackoverflow.com/users/8291840/i%c5%9f%c4%b1k-kaplan"}, "edited": false, "score": 0, "creation_date": 1559161087, "post_id": 56367816, "comment_id": 99338806, "body": "What you wrote seems more about html and not about python since all django does is to render the variables inside, it doesn&#39;t change any of the html code. How exactly are you trying to send that as email?"}, {"owner": {"reputation": 1843, "user_id": 9648520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c9b1118f02087a9f6cb5a5db2bbe563?s=128&d=identicon&r=PG&f=1", "display_name": "FightWithCode", "link": "https://stackoverflow.com/users/9648520/fightwithcode"}, "reply_to_user": {"reputation": 1932, "user_id": 8291840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/20Unf.png?s=128&g=1", "display_name": "I\u015f\u0131k Kaplan", "link": "https://stackoverflow.com/users/8291840/i%c5%9f%c4%b1k-kaplan"}, "edited": false, "score": 0, "creation_date": 1559161699, "post_id": 56367816, "comment_id": 99339031, "body": "I update the question with code."}], "answers": [{"tags": [], "owner": {"reputation": 58, "user_id": 3885690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a928b96dc6d07b6c2ed59bf16bfe5035?s=128&d=identicon&r=PG", "display_name": "Christopher Grande", "link": "https://stackoverflow.com/users/3885690/christopher-grande"}, "is_accepted": true, "score": 1, "last_activity_date": 1559192813, "creation_date": 1559192813, "answer_id": 56371934, "question_id": 56367816, "link": "https://stackoverflow.com/questions/56367816/djangos-html-emails-inline-css-not-working/56371934#56371934", "title": "Django&#39;s html email&#39;s inline css not working", "body": "<p>The red background is being skipped because of the spelling: <code>backgound-color</code> vs <code>background-color</code>.</p>\n\n<p>Also did you try different email clients - HTML email is very much it's own art.</p>\n"}], "owner": {"reputation": 1843, "user_id": 9648520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c9b1118f02087a9f6cb5a5db2bbe563?s=128&d=identicon&r=PG&f=1", "display_name": "FightWithCode", "link": "https://stackoverflow.com/users/9648520/fightwithcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 399, "favorite_count": 0, "accepted_answer_id": 56371934, "answer_count": 1, "score": 0, "last_activity_date": 1559192813, "creation_date": 1559160644, "last_edit_date": 1559161656, "question_id": 56367816, "link": "https://stackoverflow.com/questions/56367816/djangos-html-emails-inline-css-not-working", "title": "Django&#39;s html email&#39;s inline css not working", "body": "<p>I am trying to send a mail through HTML email. Everything is working perfectly, but the inline css of html file is not getting rendered in actual email.\n<strong>views.py</strong></p>\n\n<pre><code>        subject = 'Activate Your Account.'\n        htmly     = get_template('account_activation_email.html')\n\n        d = { 'user': user, 'domain':current_site.domain, 'uid':urlsafe_base64_encode(force_bytes(user.pk)), 'token': account_activation_token.make_token(user)}\n        text_content = \"\"\n        html_content = htmly.render(d)\n        msg = EmailMultiAlternatives(subject, text_content, '', [user.email])\n        msg.attach_alternative(html_content, \"text/html\")\n        try:\n            msg.send()\n        except BadHeaderError:\n            print(\"Error while sending email!\")\n</code></pre>\n\n<p>Here my html file : </p>\n\n<pre><code>&lt;html&gt;\n&lt;head&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;div style=\"backgound-color:red;position:relative;width:100%;text-align:center;\"&gt;Email Verification&lt;/div&gt;\n    Hi {{ user.username }},\n&lt;/body&gt;\n</code></pre>\n\n<p></p>\n\n<p>Please help!</p>\n"}]