[{"tags": ["kotlin"], "answers": [{"comments": [{"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "edited": false, "score": 1, "creation_date": 1441275390, "post_id": 32340382, "comment_id": 52616902, "body": "You need to write <code>::identity</code> in order to instantiate a function object from a function. This is similar to Java&#39;s method references."}, {"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 1, "creation_date": 1443996639, "post_id": 32340382, "comment_id": 53703285, "body": "Hey! I&#39;ve found a use-case for such a function! It is the <code>list.toMap(A, B)</code> function as here: <a href=\"http://stackoverflow.com/questions/32935470/how-to-convert-list-to-map-in-kotlin/32938733#32938733\" title=\"how to convert list to map in kotlin\">stackoverflow.com/questions/32935470/&hellip;</a>  Consider that there would be <code>fun it(x) = x</code>, than <code>list.toMap(::it, {it.length})</code> converts a list to a map where the elements are the keys."}], "tags": [], "owner": {"reputation": 25812, "user_id": 288456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf294ff6d86cc587dec43e2af34a9532?s=128&d=identicon&r=PG", "display_name": "Alexander Udalov", "link": "https://stackoverflow.com/users/288456/alexander-udalov"}, "is_accepted": true, "score": 16, "last_activity_date": 1480623877, "last_edit_date": 1480623877, "creation_date": 1441139523, "answer_id": 32340382, "question_id": 32336436, "link": "https://stackoverflow.com/questions/32336436/does-kotlin-have-an-identity-function/32340382#32340382", "title": "Does Kotlin have an identity function?", "body": "<p>There's no such function at the moment, but you can easily define it yourself:</p>\n\n<pre><code>fun &lt;T&gt; identity(x: T): T = x\n</code></pre>\n\n<p>If you think there are enough use cases for this function to be declared in Kotlin standard library, please file an issue at <a href=\"http://youtrack.jetbrains.com\" rel=\"noreferrer\">youtrack.jetbrains.com</a>. Thanks!</p>\n"}, {"comments": [{"owner": {"reputation": 5612, "user_id": 9279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d32ae698b36d5de067710811fec3094b?s=128&d=identicon&r=PG", "display_name": "Tim Keating", "link": "https://stackoverflow.com/users/9279/tim-keating"}, "edited": false, "score": 0, "creation_date": 1508044231, "post_id": 40672671, "comment_id": 80449607, "body": "Easier to write, yes, but there are use cases where having a defined identify function is incredibly useful (such as a general-purpose sequence of stream  operations with an optional filter stage)."}, {"owner": {"reputation": 341, "user_id": 2120553, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j05qa.png?s=128&g=1", "display_name": "Pierre-Yves Saumont", "link": "https://stackoverflow.com/users/2120553/pierre-yves-saumont"}, "reply_to_user": {"reputation": 5612, "user_id": 9279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d32ae698b36d5de067710811fec3094b?s=128&d=identicon&r=PG", "display_name": "Tim Keating", "link": "https://stackoverflow.com/users/9279/tim-keating"}, "edited": false, "score": 0, "creation_date": 1508142061, "post_id": 40672671, "comment_id": 80476934, "body": "What would be the type of this function? A generic value function would not be possible because there would be no information for inferring the type. A generic <code>fun</code> function returning a value function is possible, but probably not worth it."}, {"owner": {"reputation": 5612, "user_id": 9279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d32ae698b36d5de067710811fec3094b?s=128&d=identicon&r=PG", "display_name": "Tim Keating", "link": "https://stackoverflow.com/users/9279/tim-keating"}, "edited": false, "score": 0, "creation_date": 1508962084, "post_id": 40672671, "comment_id": 80829664, "body": "Fair point. The use case I was attempting to use it for was supplying a identity func to Collection.filter(), which happens to return Boolean. In that case, I ended up using <code>{ true }</code>, but that&#39;s not really an identity function."}, {"owner": {"reputation": 5612, "user_id": 9279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d32ae698b36d5de067710811fec3094b?s=128&d=identicon&r=PG", "display_name": "Tim Keating", "link": "https://stackoverflow.com/users/9279/tim-keating"}, "edited": false, "score": 1, "creation_date": 1508962920, "post_id": 40672671, "comment_id": 80830087, "body": "However, as a matter of fact, I think you can fake your way toward a generic by using an extension function: <code>fun &lt;T: Any&gt; T.identity(): T = this</code> And then to call it, you would use <code>Any::identity</code>"}, {"owner": {"reputation": 341, "user_id": 2120553, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j05qa.png?s=128&g=1", "display_name": "Pierre-Yves Saumont", "link": "https://stackoverflow.com/users/2120553/pierre-yves-saumont"}, "reply_to_user": {"reputation": 5612, "user_id": 9279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d32ae698b36d5de067710811fec3094b?s=128&d=identicon&r=PG", "display_name": "Tim Keating", "link": "https://stackoverflow.com/users/9279/tim-keating"}, "edited": false, "score": 0, "creation_date": 1509053165, "post_id": 40672671, "comment_id": 80875931, "body": "Interesting solution!"}], "tags": [], "owner": {"reputation": 341, "user_id": 2120553, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j05qa.png?s=128&g=1", "display_name": "Pierre-Yves Saumont", "link": "https://stackoverflow.com/users/2120553/pierre-yves-saumont"}, "is_accepted": false, "score": 17, "last_activity_date": 1508141923, "last_edit_date": 1508141923, "creation_date": 1479458592, "answer_id": 40672671, "question_id": 32336436, "link": "https://stackoverflow.com/questions/32336436/does-kotlin-have-an-identity-function/40672671#40672671", "title": "Does Kotlin have an identity function?", "body": "<p>If you need to pass the identity function as a parameter to another function, you can simply use <code>{ it }</code>. For example, it you have a List&lt;List&lt;String>> and want to flatten it to a List&lt;String>, you could use:</p>\n\n<pre><code>list.flatMap(identity)\n</code></pre>\n\n<p>where <code>identity</code> is the identity function. This can be written as:</p>\n\n<pre><code>list.flatMap { it }\n</code></pre>\n\n<p>This is equivalent to:</p>\n\n<pre><code>list.flatMap { x -&gt; x }\n</code></pre>\n\n<p>The alternative would be to define the identity function somewhere, such as:</p>\n\n<pre><code>val identity: (List&lt;String&gt;) -&gt; List&lt;String&gt; = { it }\n</code></pre>\n\n<p>But we can't create a generic <code>val</code>, so we would have to define an identity function for each type. The solution, (as it is done in Java <code>Function</code> interface) is to define it as a constant function:</p>\n\n<pre><code>fun &lt;A&gt; identity(): (A) -&gt; A = { it }\n</code></pre>\n\n<p>and use it as:</p>\n\n<pre><code>list.flatMap(identity)\n</code></pre>\n\n<p>Of course, it is much easier to write:</p>\n\n<pre><code>list.flatMap { it }\n</code></pre>\n\n<p>Declaring an identity function once for all (that would work for all types) is not possible because it would have to be parameterized. What is possible is to use a function returning this identity function:</p>\n\n<pre><code>fun &lt;T&gt; identity(): (T) -&gt; T  = { it }\n</code></pre>\n\n<p>Although it does the job, it is not very helpful since one has now to write:</p>\n\n<pre><code>list.flatMap(identity())\n</code></pre>\n"}], "owner": {"reputation": 235985, "user_id": 252000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/082b8ee2b0aebb430b8d4d98e6a5c32f?s=128&d=identicon&r=PG", "display_name": "fredoverflow", "link": "https://stackoverflow.com/users/252000/fredoverflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5353, "favorite_count": 0, "accepted_answer_id": 32340382, "answer_count": 2, "score": 24, "last_activity_date": 1508141923, "creation_date": 1441124269, "last_edit_date": 1508139986, "question_id": 32336436, "link": "https://stackoverflow.com/questions/32336436/does-kotlin-have-an-identity-function", "title": "Does Kotlin have an identity function?", "body": "<p>Scala has a generic <code>identity</code> function in the Predef:</p>\n\n<pre><code>def identity[A](x: A): A\n</code></pre>\n\n<p>Does Kotlin have a similar facility in the standard library? Of course I could simply use <code>{ it }</code> instead, but I find <code>identity</code> easier to read, and instantiating all those lambdas is a little wasteful.</p>\n\n<p>I must be able to use this <code>identity</code> function in places where a function <code>(Foo) -&gt; Foo</code> is expected, for any type <code>Foo</code>. Is such a function even possible in Kotlin's type system? (In the case of Scala, there is an implicit conversion that wraps the method inside a function object or something.)</p>\n"}, {"tags": ["singleton", "kotlin"], "answers": [{"tags": [], "owner": {"reputation": 25812, "user_id": 288456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf294ff6d86cc587dec43e2af34a9532?s=128&d=identicon&r=PG", "display_name": "Alexander Udalov", "link": "https://stackoverflow.com/users/288456/alexander-udalov"}, "is_accepted": false, "score": 10, "last_activity_date": 1440928320, "creation_date": 1440928320, "answer_id": 32295251, "question_id": 32288743, "link": "https://stackoverflow.com/questions/32288743/whats-the-difference-between-an-object-and-a-data-object/32295251#32295251", "title": "What&#39;s the difference between an object and a data object?", "body": "<p>The fact that <code>data</code> is allowed on an object declaration is in fact a bug (<a href=\"https://youtrack.jetbrains.com/issue/KT-6486\">KT-6486</a>) which should be fixed.</p>\n\n<p><a href=\"http://kotlinlang.org/docs/reference/data-classes.html\"><code>data</code></a> is an annotation which causes the compiler to generate <code>equals</code>, <code>hashCode</code>, <code>toString</code>, <code>copy</code> and <code>componentN</code> functions. It doesn't make much sense when applied to an object declaration for two reasons:</p>\n\n<ul>\n<li>An object declaration cannot have a constructor, and all these functions work based on properties defined in the primary constructor.</li>\n<li>There's only one instance of any object at runtime.</li>\n</ul>\n\n<p>So no <code>componentN</code> functions would be generated, <code>copy</code> can't work, and the generated <code>equals</code>/<code>hashCode</code>/<code>toString</code> implementations will be equivalent to the default ones from <code>Any</code> which are based on identity.</p>\n"}], "owner": {"reputation": 235985, "user_id": 252000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/082b8ee2b0aebb430b8d4d98e6a5c32f?s=128&d=identicon&r=PG", "display_name": "fredoverflow", "link": "https://stackoverflow.com/users/252000/fredoverflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1440928320, "creation_date": 1440868681, "question_id": 32288743, "link": "https://stackoverflow.com/questions/32288743/whats-the-difference-between-an-object-and-a-data-object", "title": "What&#39;s the difference between an object and a data object?", "body": "<p>The other day I noticed that I sometimes put <code>data</code> in front of <code>object</code>s and other times not:</p>\n\n<pre><code>object A\n\ndata object B\n</code></pre>\n\n<p>What's the difference between an <code>object</code> and a <code>data object</code>?</p>\n"}, {"tags": ["java", "json", "intellij-idea", "log4j", "kotlin"], "comments": [{"owner": {"reputation": 6820, "user_id": 1709216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7b60a83ab866cccc40a2226f6a4086?s=128&d=identicon&r=PG", "display_name": "rgoers", "link": "https://stackoverflow.com/users/1709216/rgoers"}, "edited": false, "score": 0, "creation_date": 1440908801, "post_id": 32269559, "comment_id": 52463412, "body": "I would suggest adding -Dlog4j2.StatusLogger.level=DEBUG. It should print some debugging messages that might help identify the problem."}], "answers": [{"tags": [], "owner": {"reputation": 1739, "user_id": 5226711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213d99f05df6ff35910e0acd8d749fbe?s=128&d=identicon&r=PG&f=1", "display_name": "Lars Gendner", "link": "https://stackoverflow.com/users/5226711/lars-gendner"}, "is_accepted": true, "score": 1, "last_activity_date": 1440760945, "creation_date": 1440760945, "answer_id": 32269917, "question_id": 32269559, "link": "https://stackoverflow.com/questions/32269559/log4j2-not-working-with-json-config-file/32269917#32269917", "title": "Log4j2 not working with json config file", "body": "<p>You can use the system property <code>log4j.configurationFactory</code>:</p>\n\n<pre><code>-Dlog4j.configurationFactory=org.apache.logging.log4j.core.config.json.JsonConfigurationFactory\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2596, "user_id": 1140338, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RkvnE.jpg?s=128&g=1", "display_name": "mvieghofer", "link": "https://stackoverflow.com/users/1140338/mvieghofer"}, "is_accepted": false, "score": 4, "last_activity_date": 1534921004, "creation_date": 1534921004, "answer_id": 51961286, "question_id": 32269559, "link": "https://stackoverflow.com/questions/32269559/log4j2-not-working-with-json-config-file/51961286#51961286", "title": "Log4j2 not working with json config file", "body": "<p>Even though there is already an accepted answer I'll post my solution too. Maybe this helps someone else in the future...</p>\n\n<p>The reason why it didn't work for me was that I didn't have the <code>jackson-core</code> and <code>jackson-databind</code> library available. After I added </p>\n\n<pre><code>compile 'com.fasterxml.jackson.core:jackson-core:2.8.7'\ncompile 'com.fasterxml.jackson.core:jackson-databind:2.6.2'\n</code></pre>\n\n<p>to my <code>build.gradle</code> file everything worked fine.</p>\n"}], "owner": {"reputation": 440, "user_id": 2969879, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/vuHkP.png?s=128&g=1", "display_name": "hinst", "link": "https://stackoverflow.com/users/2969879/hinst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2296, "favorite_count": 1, "accepted_answer_id": 32269917, "answer_count": 2, "score": 1, "last_activity_date": 1534921004, "creation_date": 1440759776, "question_id": 32269559, "link": "https://stackoverflow.com/questions/32269559/log4j2-not-working-with-json-config-file", "title": "Log4j2 not working with json config file", "body": "<p>It seems like log4j is trying to parse .json config file by XML parser, but why?</p>\n\n<p>I set log4j config file by command line argument: </p>\n\n<pre><code>-Dlog4j.configurationFile=src/log4j2.json\n</code></pre>\n\n<p>file content:</p>\n\n<pre><code>{\n    \"configuration\": {\n        \"appenders\": {\n            \"Console\": {\n                \"name\": \"Console\",\n                \"target\": \"SYSTEM_OUT\",\n                \"PatternLayout\": {\n                    \"pattern\": \"%date %thread %logger %message\"\n                }\n            }\n        },\n        \"loggers\": {\n            \"root\": {\n                \"level\": \"debug\",\n                \"appender-ref\": {\n                    \"ref\": \"Console\"\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>What I get:</p>\n\n<pre><code>[Fatal Error] log4j2.json:1:1: Content is not allowed in prolog.\nERROR StatusLogger Error parsing D:\\Dev\\HDelphiCrawler\\src\\log4j2.json org.xml.sax.SAXParseException; systemId: file:///D:/Dev/HDelphiCrawler/src/log4j2.json; lineNumber: 1; columnNumber: 1; Content is not allowed in prolog.\n    at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(DOMParser.java:257)\n    at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(DocumentBuilderImpl.java:348)\n    at org.apache.logging.log4j.core.config.xml.XmlConfiguration.&lt;init&gt;(XmlConfiguration.java:140)\n    at org.apache.logging.log4j.core.config.xml.XmlConfigurationFactory.getConfiguration(XmlConfigurationFactory.java:44)\n    at org.apache.logging.log4j.core.config.ConfigurationFactory$Factory.getConfiguration(ConfigurationFactory.java:410)\n    ....and so on...\nERROR StatusLogger No logging configuration\n</code></pre>\n\n<p>Jars in my lib folder:</p>\n\n<ul>\n<li>hamcrest-junit-2.0.0.0.jar</li>\n<li>jackson-annotations-2.6.1.jar</li>\n<li>jackson-core-2.6.1.jar</li>\n<li>jackson-databind-2.6.1.jar</li>\n<li>java-hamcrest-2.0.0.0.jar</li>\n<li>junit-4.12.jar</li>\n<li>kotlin-reflect.jar</li>\n<li>kotlin-runtime-sources.jar</li>\n<li>kotlin-runtime.jar</li>\n<li>log4j-api-2.3.jar</li>\n<li>log4j-core-2.3.jar</li>\n<li>log4j-slf4j-impl-2.3.jar</li>\n</ul>\n"}, {"tags": ["java", "rx-java", "kotlin"], "comments": [{"owner": {"reputation": 4016, "user_id": 1460833, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bc4821b9c16457694f503b42831198f1?s=128&d=identicon&r=PG", "display_name": "Sergey Mashkov", "link": "https://stackoverflow.com/users/1460833/sergey-mashkov"}, "edited": false, "score": 0, "creation_date": 1440687664, "post_id": 32246900, "comment_id": 52386164, "body": "where do you have &quot;println&quot; ?"}, {"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "reply_to_user": {"reputation": 4016, "user_id": 1460833, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bc4821b9c16457694f503b42831198f1?s=128&d=identicon&r=PG", "display_name": "Sergey Mashkov", "link": "https://stackoverflow.com/users/1460833/sergey-mashkov"}, "edited": false, "score": 0, "creation_date": 1440690205, "post_id": 32246900, "comment_id": 52387900, "body": "@SergeyMashkov, tried both in <code>.subscribe { println(thisThread() + &quot;: &quot; + it) }</code> and in <code>.doOnEach { println(thisThread() + &quot;: &quot; + it) }.toBlocking().last()</code>."}], "answers": [{"tags": [], "owner": {"reputation": 64143, "user_id": 61158, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/db0a0198951e15aadcb42b40452c29f7?s=128&d=identicon&r=PG", "display_name": "akarnokd", "link": "https://stackoverflow.com/users/61158/akarnokd"}, "is_accepted": true, "score": 1, "last_activity_date": 1440762735, "creation_date": 1440762735, "answer_id": 32270424, "question_id": 32246900, "link": "https://stackoverflow.com/questions/32246900/rxjava-onbackpressureblock-strange-behavior/32270424#32270424", "title": "RxJava: onBackpressureBlock() strange behavior", "body": "<p>The <code>onBackpressureBlock</code> operator is a failed experiment; it requires care where to apply. For example, <code>subscribeOn().onBackpressureBlock()</code> works but not the other way around.</p>\n\n<p>RxJava has non-blocking periodic timer called <code>interval</code> so you don't need to roll your own.</p>\n"}], "owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "accepted_answer_id": 32270424, "answer_count": 1, "score": 0, "last_activity_date": 1440762735, "creation_date": 1440671198, "last_edit_date": 1440720773, "question_id": 32246900, "link": "https://stackoverflow.com/questions/32246900/rxjava-onbackpressureblock-strange-behavior", "title": "RxJava: onBackpressureBlock() strange behavior", "body": "<p>I am playing around with RxJava (RxKotlin to be precise). Here I have the following <code>Observable</code>s:</p>\n\n<pre><code>fun metronome(ms: Int) = observable&lt;Int&gt; {\n    var i = 0;\n    while (true) {\n        if (ms &gt; 0) {\n            Thread.sleep(ms.toLong())\n        }\n        if (it.isUnsubscribed()) {\n            break\n        }\n        it.onNext(++i)\n    }\n}\n</code></pre>\n\n<p>And I'd like to have a few of them merged and running concurrently. They ignore backpressure so the backpressure operators have to be applied to them.</p>\n\n<p>Then I create</p>\n\n<pre><code>val cores = Runtime.getRuntime().availableProcessors()\nval threads = Executors.newFixedThreadPool(cores)\nval scheduler = Schedulers.from(threads)\n</code></pre>\n\n<p>And then I merge the <code>metronome</code>s:</p>\n\n<pre><code>val o = Observable.merge(listOf(metronome(0),\n                                metronome(1000).map { \"---------\" })\n                         .map { it.onBackpressureBlock().subscribeOn(scheduler) })\n                  .take(5000, TimeUnit.MILLISECONDS)\n</code></pre>\n\n<p>The first one is supposed to emit items incessantly.\nIf I do so in the last 3 seconds of the run I get the following output:</p>\n\n<pre><code>...\n[RxComputationThreadPool-5]: 369255\n[RxComputationThreadPool-5]: 369256\n[RxComputationThreadPool-5]: 369257\n[RxComputationThreadPool-5]: ---------\n[RxComputationThreadPool-5]: ---------\n[RxComputationThreadPool-5]: ---------\n</code></pre>\n\n<p>Seems that the <code>Observable</code>s are subscribed on the same one thread, and the first observable is blocked for 3+ seconds.</p>\n\n<p>But when I swap <code>onBackpressureBlock()</code> and <code>subscribeOn(scheduler)</code> calls the output becomes what I expected, the output gets merged during the whole execution.</p>\n\n<p>It's obvious to me that calls order matters in RxJava, but I don't quite understand what happens in this particular situation.</p>\n\n<p>So what happens when <code>onBackpressureBlock</code> operator is applied <em>before</em> <code>subscribeOn</code> and what if <em>after</em>?</p>\n"}, {"tags": ["gradle", "kotlin"], "comments": [{"owner": {"reputation": 838, "user_id": 1128600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57e379c176b460cf48ff3eb61a408da?s=128&d=identicon&r=PG", "display_name": "Steffen Funke", "link": "https://stackoverflow.com/users/1128600/steffen-funke"}, "edited": false, "score": 0, "creation_date": 1440706822, "post_id": 32239087, "comment_id": 52397330, "body": "Interesting approach - since you &quot;provide&quot; the Android Framework API, I assume you want to create an Android library? Correct me if I&#39;m wrong, but couldn&#39;t you use a plain Android library project? Kotlin integration works fine for that kind of project. But maybe I miss a requirement you need?"}, {"owner": {"reputation": 849, "user_id": 1137815, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/52a0a032eb6c79743ab0f6c42d3e5d19?s=128&d=identicon&r=PG", "display_name": "Nathan Taylor", "link": "https://stackoverflow.com/users/1137815/nathan-taylor"}, "reply_to_user": {"reputation": 838, "user_id": 1128600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57e379c176b460cf48ff3eb61a408da?s=128&d=identicon&r=PG", "display_name": "Steffen Funke", "link": "https://stackoverflow.com/users/1128600/steffen-funke"}, "edited": false, "score": 0, "creation_date": 1440711267, "post_id": 32239087, "comment_id": 52399514, "body": "@SteffenFunke, the library is a code generation library using annotation processors, so it can&#39;t be an actual android library. The full thing is on <a href=\"https://github.com/Workday/postman\" rel=\"nofollow noreferrer\">github</a> if you would like to see it."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1452106310, "post_id": 32239087, "comment_id": 57026555, "body": "Instead of custom code, use one of the prebuilt nicely available plugins for Gradle that do this.  I added information below."}], "answers": [{"tags": [], "owner": {"reputation": 50303, "user_id": 170842, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/c2ea72b8d001d81fb6ce3f356e45eb3a?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/170842/michael"}, "is_accepted": false, "score": 1, "last_activity_date": 1449589142, "creation_date": 1449589142, "answer_id": 34159939, "question_id": 32239087, "link": "https://stackoverflow.com/questions/32239087/adding-a-provided-configuration-to-a-kotlin-java-library-using-gradle/34159939#34159939", "title": "Adding a &#39;provided&#39; configuration to a kotlin/java library using gradle", "body": "<p>That's how I do it in a Gradle plugin:</p>\n\n<pre><code>private void addProvidedConfiguration() {\n  final Configuration provided =\n      addConfiguration(project.configurations, \"provided)\n  final Javadoc javadoc =\n      project.tasks.getByName(JavaPlugin.JAVADOC_TASK_NAME) as Javadoc\n  javadoc.classpath = javadoc.classpath.plus(provided)\n}\n\nprivate static Configuration addConfiguration(\n    final ConfigurationContainer configurations, final String name) {\n  final Configuration compile =\n      configurations.getByName(JavaPlugin.COMPILE_CONFIGURATION_NAME)\n  final Configuration configuration = configurations.create(name)\n\n  compile.extendsFrom(configuration)\n  configuration.visible = false\n  configuration.transitive = false\n\n  configuration.allDependencies.all { final dependency -&gt;\n    configurations.default.exclude(group: dependency.group, module: dependency.name)\n  }\n\n  return configuration\n}\n</code></pre>\n\n<p>You can check the source code on <a href=\"https://github.com/MichaelRocks/lightsaber/blob/develop/buildSrc/src/main/groovy/io/michaelrocks/bintray/BintrayPlugin.groovy\" rel=\"nofollow\">github</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "is_accepted": false, "score": 0, "last_activity_date": 1452106146, "creation_date": 1452106146, "answer_id": 34640520, "question_id": 32239087, "link": "https://stackoverflow.com/questions/32239087/adding-a-provided-configuration-to-a-kotlin-java-library-using-gradle/34640520#34640520", "title": "Adding a &#39;provided&#39; configuration to a kotlin/java library using gradle", "body": "<p>This <a href=\"https://github.com/spring-projects/gradle-plugins/tree/master/propdeps-plugin\" rel=\"nofollow\"><code>gradle-propdeps</code> plugin for Gradle</a> adds <code>provided</code> and <code>optional</code> to Gradle, and also handles its integration into IntelliJ IDEA and Eclipse.  It is from the Spring team and it has a lot of usage.</p>\n\n<p>You should apply the <code>kotlin</code> plugin after <code>propdeps</code>.</p>\n\n<p>I have not tested this with Android libraries, but it is a much safer bet than trying to roll your own.  There are little special cases to handle.</p>\n\n<p>An alternative plugin, also used heavily is <a href=\"https://github.com/nebula-plugins/gradle-extra-configurations-plugin\" rel=\"nofollow\">the one from Netflix team</a> who has many plugins available for different useful additions to Gradle.  This plugin adds the same <code>provided</code> and <code>optional</code>.</p>\n\n<p>This is a good reminder that the old issue <a href=\"http://issues.gradle.org/browse/GRADLE-784\" rel=\"nofollow\">Provide a 'provided' configuration</a> for Gradle is still outstanding for 6 years, and feel free to provide your opinion there as to the lack of this feature.</p>\n"}], "owner": {"reputation": 849, "user_id": 1137815, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/52a0a032eb6c79743ab0f6c42d3e5d19?s=128&d=identicon&r=PG", "display_name": "Nathan Taylor", "link": "https://stackoverflow.com/users/1137815/nathan-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 848, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1452106146, "creation_date": 1440637616, "question_id": 32239087, "link": "https://stackoverflow.com/questions/32239087/adding-a-provided-configuration-to-a-kotlin-java-library-using-gradle", "title": "Adding a &#39;provided&#39; configuration to a kotlin/java library using gradle", "body": "<p>I have a java library to which I've added a 'provided' configuration using gradle.</p>\n\n<pre><code>\napply plugin: 'java'\napply plugin: 'idea'\napply plugin: 'checkstyle'\napply from: file('../gradle/gradle-mvn-push.gradle')\n\nsourceCompatibility = JavaVersion.VERSION_1_7\ntargetCompatibility = JavaVersion.VERSION_1_7\n\nrepositories {\n    mavenCentral()\n}\n\ngroup = GROUP\nversion = VERSION_NAME\n\nconfigurations {\n    provided\n}\n\nsourceSets {\n    main.compileClasspath += configurations.provided\n    test.compileClasspath += configurations.provided\n    test.runtimeClasspath += configurations.provided\n}\njavadoc.classpath += configurations.provided\n\nidea {\n    module {\n        scopes.PROVIDED.plus += [configurations.provided]\n    }\n}\n\ncheckstyle {\n    configFile = new File(rootDir, 'checkstyle.xml')\n    toolVersion = '6.7'\n}\n\ndependencies {\n    provided 'com.google.android:android:2.3.1'\n    compile 'com.squareup:javawriter:2.5.0'\n    compile 'com.workday:metajava:1.0'\n}\n</code></pre>\n\n<p>Everything works as expected with this setup.</p>\n\n<p>Now I want to start using kotlin in my library, so I modified the build script to look like this (sans pluses)</p>\n\n<pre><code>\n+buildscript {\n+    repositories {\n+        mavenCentral()\n+    }\n+    dependencies {\n+        classpath \"org.jetbrains.kotlin:kotlin-gradle-plugin:0.12.613\"\n+    }\n+}\n apply plugin: 'java'\n apply plugin: 'idea'\n+apply plugin: 'kotlin'\n apply plugin: 'checkstyle'\n apply from: file('../gradle/gradle-mvn-push.gradle')\n\nsourceCompatibility = JavaVersion.VERSION_1_7\ntargetCompatibility = JavaVersion.VERSION_1_7\n\nrepositories {\n    mavenCentral()\n}\n\ngroup = GROUP\nversion = VERSION_NAME\n\nconfigurations {\n    provided\n}\n\nsourceSets {\n    main.compileClasspath += configurations.provided\n    test.compileClasspath += configurations.provided\n    test.runtimeClasspath += configurations.provided\n}\njavadoc.classpath += configurations.provided\n\nidea {\n    module {\n        scopes.PROVIDED.plus += [configurations.provided]\n    }\n}\n\ncheckstyle {\n    configFile = new File(rootDir, 'checkstyle.xml')\n    toolVersion = '6.7'\n}\n\ndependencies {\n    provided 'com.google.android:android:2.3.1'\n    compile 'com.squareup:javawriter:2.5.0'\n    compile 'com.workday:metajava:1.0'\n+   compile \"org.jetbrains.kotlin:kotlin-stdlib:0.12.613\"\n}\n</code></pre>\n\n<p>Without even adding any kotlin files (and even if I do), the library no longer compiles saying that it can't find the classes in the provided library (android in my case). </p>\n\n<p>What do I need to change to get it so that the provided dependencies are recognized again?</p>\n"}]