[{"tags": ["rx-java", "kotlin", "reactive-programming", "rx-java2", "algebraic-data-types"], "comments": [{"owner": {"reputation": 2602, "user_id": 3072366, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/e05703551a89ed28e6950c498b6eea2c?s=128&d=identicon&r=PG&f=1", "display_name": "Pezetter", "link": "https://stackoverflow.com/users/3072366/pezetter"}, "edited": false, "score": 0, "creation_date": 1492630841, "post_id": 43504473, "comment_id": 74063890, "body": "Great question mate!"}, {"owner": {"reputation": 1802, "user_id": 2814877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35675fe55ce061fb6594c53afc01de47?s=128&d=identicon&r=PG&f=1", "display_name": "m.ostroverkhov", "link": "https://stackoverflow.com/users/2814877/m-ostroverkhov"}, "edited": false, "score": 1, "creation_date": 1492635565, "post_id": 43504473, "comment_id": 74066633, "body": "have you considered moving <code>distinctUntilChanged</code> next to <code>relay</code>: <code>relay.distinctUntilChanged.flatMap...</code> ?"}, {"owner": {"reputation": 10814, "user_id": 891242, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5719e9d6125bf8f75501a83e68b11412?s=128&d=identicon&r=PG", "display_name": "ZakTaccardi", "link": "https://stackoverflow.com/users/891242/zaktaccardi"}, "reply_to_user": {"reputation": 1802, "user_id": 2814877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35675fe55ce061fb6594c53afc01de47?s=128&d=identicon&r=PG&f=1", "display_name": "m.ostroverkhov", "link": "https://stackoverflow.com/users/2814877/m-ostroverkhov"}, "edited": false, "score": 0, "creation_date": 1492635817, "post_id": 43504473, "comment_id": 74066758, "body": "@m.ostroverkhov definitely, but that&#39;s not my use case. need <code>distinctUntilChange</code> to work on the whole stream. your suggestion has <code>distinctUntilChanged</code> not operating within the flatmap. having both would be too expensive of an operation in my use case"}, {"owner": {"reputation": 16339, "user_id": 1584654, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/ZmAL8.jpg?s=128&g=1", "display_name": "GVillani82", "link": "https://stackoverflow.com/users/1584654/gvillani82"}, "edited": false, "score": 0, "creation_date": 1492636787, "post_id": 43504473, "comment_id": 74067267, "body": "What if you try using <code>distinctUntilChanged(BiPredicate&lt;? super T, ? super T&gt; comparer)</code> instead of the empty one, and create a <code>BiPredicate</code> object in which the <code>test()</code> method returns the comparison between the two objects (based on the int value)?"}], "answers": [{"tags": [], "owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "is_accepted": false, "score": 0, "last_activity_date": 1492637082, "creation_date": 1492637082, "answer_id": 43506330, "question_id": 43504473, "link": "https://stackoverflow.com/questions/43504473/how-to-control-flow-without-flatmap-which-breaks-a-reactive-stream-preventing/43506330#43506330", "title": "How to control flow without .flatMap, which breaks a reactive stream preventing operators like distinctUntilChanged from working on the entire stream", "body": "<p>Could you split the <code>Observable</code> into multiple observables with each of them getting events of a single type? You could then perform some operations on these observables, before merging them back together again.</p>\n\n<p>I am not able to test this right now, so it may need some tweaks. Anyway, I hope you get the idea here:</p>\n\n<pre><code>@Test fun distinctTest() {\n    val relay = PublishRelay.create&lt;State&gt;()\n\n    val loadingObs = relay.filter { it is State.Loading }\n                          .distinctUntilChanged()\n                          .doOnNext { println(\"loading\") }\n\n    val loadedObs = relay.filter { it is State.Loaded }\n                         .distinctUntilChanged()\n                         .doOnNext { println(it.value) }\n\n    val merged = loadingObs.mergeWith(loadedObs)\n\n    merged.subscribe()\n\n    relay.accept(State.Loading)\n    relay.accept(State.Loaded(1))\n    relay.accept(State.Loaded(2))\n    relay.accept(State.Loaded(3))\n    relay.accept(State.Loaded(3))\n    // Hopefully prints this: loading, 1, 2, 3\n}\n</code></pre>\n"}], "owner": {"reputation": 10814, "user_id": 891242, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5719e9d6125bf8f75501a83e68b11412?s=128&d=identicon&r=PG", "display_name": "ZakTaccardi", "link": "https://stackoverflow.com/users/891242/zaktaccardi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 688, "favorite_count": 0, "answer_count": 1, "score": 7, "last_activity_date": 1492637082, "creation_date": 1492630073, "question_id": 43504473, "link": "https://stackoverflow.com/questions/43504473/how-to-control-flow-without-flatmap-which-breaks-a-reactive-stream-preventing", "title": "How to control flow without .flatMap, which breaks a reactive stream preventing operators like distinctUntilChanged from working on the entire stream", "body": "<p>I want to handle a different observable chain of logic for different implementations of <code>State</code>. This can easily be achieved with a sealed class/algebraic data type/union + <code>.flatMap()</code>, but this breaks the stream, where operators like <code>.distinctUntilChanged()</code> only work within the <code>.flatMap()</code> function, not on the <em>whole</em> stream itself.</p>\n\n<pre><code>sealed class State {\n    object Loading : State()\n    data class Loaded(val value: Int) : State()\n}\n\n@Test fun distinctTest() {\n    val relay = PublishRelay.create&lt;State&gt;()\n    relay.flatMap {\n        fun handle(state: State): Observable&lt;*&gt; = when (state) {\n            State.Loading -&gt; Observable.just(state)\n                    .distinctUntilChanged()\n                    .doOnNext { println(\"loading\") }\n\n            is State.Loaded -&gt; Observable.just(state)\n                    .distinctUntilChanged()\n                    .doOnNext { println(it.value) }\n        }\n        handle(it)\n    }\n            .subscribe()\n\n    relay.accept(State.Loading)\n    relay.accept(State.Loaded(1))\n    relay.accept(State.Loaded(2))\n    relay.accept(State.Loaded(3))\n    relay.accept(State.Loaded(3))\n    //desired: loading, 1, 2, 3\n    //actual: loading, 1, 2, 3, 3\n}\n</code></pre>\n\n<p>Note, this is a simplified example. While I\u2019m just printing here, I actually want to perform different actions (render the UI differently) based on the implementing type of <code>State</code></p>\n\n<p>This can be accomplished with a subject/relay, but but that would create a disconnected, mutable stream, which I would also like to avoid.</p>\n"}, {"tags": ["kotlin"], "comments": [{"owner": {"reputation": 5111, "user_id": 785663, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b32f09978c0b55f375b81e9179dc568?s=128&d=identicon&r=PG", "display_name": "mabi", "link": "https://stackoverflow.com/users/785663/mabi"}, "edited": false, "score": 0, "creation_date": 1492688820, "post_id": 43502031, "comment_id": 74090383, "body": "For the record, while Ilia&#39;s answer solves the difficult Kotlin part, I&#39;ve solved the &quot;treat a directory of files as a stream of lines&quot; with <code>InputStreamReader(SequenceInputStream(com.google.common.coll&zwnj;&#8203;ect.Iterators.asEnum&zwnj;&#8203;eration(Files.list(&quot;&zwnj;&#8203;myDir&quot;).map { Files.newInputStream(it) }.iterator())), Charsets.US_ASCII).useLines { ... }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5111, "user_id": 785663, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b32f09978c0b55f375b81e9179dc568?s=128&d=identicon&r=PG", "display_name": "mabi", "link": "https://stackoverflow.com/users/785663/mabi"}, "edited": false, "score": 0, "creation_date": 1492682951, "post_id": 43504434, "comment_id": 74086043, "body": "Go coroutines! And thanks for the clever application of <code>when</code>."}], "tags": [], "owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "is_accepted": true, "score": 4, "last_activity_date": 1492644797, "last_edit_date": 1492644797, "creation_date": 1492629965, "answer_id": 43504434, "question_id": 43502031, "link": "https://stackoverflow.com/questions/43502031/iterating-over-files-splitting-by-pattern/43504434#43504434", "title": "Iterating over files, splitting by pattern", "body": "<p>You can read file as a sequence of text lines and then regroup those lines taking empty line as a delimiter:</p>\n\n<pre><code>File(\"myfile\").useLines { lines -&gt;\n    val lineBlocks: Sequence&lt;List&lt;String&gt;&gt; = buildSequence {\n        val block = mutableListOf&lt;String&gt;()\n        for (line in lines) {\n            when {\n                line.isNotEmpty() -&gt; block.add(line)\n                block.isNotEmpty() -&gt; {\n                    yield(block.toList())\n                    block.clear()\n                }\n            }\n        }\n        if (block.isNotEmpty()) yield(block.toList())\n    }\n\n    lineBlocks.forEach {\n        println(it.joinToString())\n    }\n}\n</code></pre>\n\n<p>Here you get the result in <code>lineBlocks</code>, which is a sequence where each element is a list of lines in a single block.</p>\n"}], "owner": {"reputation": 5111, "user_id": 785663, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b32f09978c0b55f375b81e9179dc568?s=128&d=identicon&r=PG", "display_name": "mabi", "link": "https://stackoverflow.com/users/785663/mabi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "accepted_answer_id": 43504434, "answer_count": 1, "score": 2, "last_activity_date": 1492644797, "creation_date": 1492621799, "question_id": 43502031, "link": "https://stackoverflow.com/questions/43502031/iterating-over-files-splitting-by-pattern", "title": "Iterating over files, splitting by pattern", "body": "<p>I'm trying to wrap my head around file stream processing. Got input looking like this:</p>\n\n<pre><code>bla\nblubb\n\nblubber\ntestcode\n</code></pre>\n\n<p>There's several files all looking like the above. Right now, I'm using a single file approach that reads the whole file into memory and splits it:</p>\n\n<pre><code>Files.newBufferedReader(\"myfile\").use { f -&gt;\n    f.readText().splitToSequence(\"\\n\\n\").forEach {\n        // do my stuff\n    }\n}\n</code></pre>\n\n<p>Now, I'm trying to generalize this to larger inputs (making it impractical to hold the file in memory) and several files. Ideally, I'd treat a whole directory of input files as a single stream of lines I split on <code>\\n\\n</code> and work on the parts. How would I do this?</p>\n"}, {"tags": ["android", "kotlin", "anko"], "comments": [{"owner": {"reputation": 148157, "user_id": 35364, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f11512869fe2f8d87a2f2b687b76686c?s=128&d=identicon&r=PG", "display_name": "hasen", "link": "https://stackoverflow.com/users/35364/hasen"}, "edited": false, "score": 0, "creation_date": 1492876436, "post_id": 43496290, "comment_id": 74173577, "body": "Any reason not to use a framelayout while changing its content?"}, {"owner": {"reputation": 641, "user_id": 1870447, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5obdQ.jpg?s=128&g=1", "display_name": "Antek", "link": "https://stackoverflow.com/users/1870447/antek"}, "reply_to_user": {"reputation": 148157, "user_id": 35364, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f11512869fe2f8d87a2f2b687b76686c?s=128&d=identicon&r=PG", "display_name": "hasen", "link": "https://stackoverflow.com/users/35364/hasen"}, "edited": false, "score": 0, "creation_date": 1494266096, "post_id": 43496290, "comment_id": 74744070, "body": "what do you mean?"}], "owner": {"reputation": 641, "user_id": 1870447, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5obdQ.jpg?s=128&g=1", "display_name": "Antek", "link": "https://stackoverflow.com/users/1870447/antek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 257, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492606567, "creation_date": 1492606264, "last_edit_date": 1492606567, "question_id": 43496290, "link": "https://stackoverflow.com/questions/43496290/anko-alternative-to-hide-one-view-and-show-another", "title": "Anko - alternative to hide one view and show another", "body": "<p>Should I just initialise and keep both, and set <code>visibility</code> to <code>VISIBLE</code> or <code>GONE</code> depending on the state? Is there a better method? What about memory issues? I would like to have a RecyclerView and a WebView alternately. I want to avoid Fragments - I tried that already and separation of responsibility between Activity, UI and Fragments is a hell.</p>\n\n<p>I keep my UI (inheriting from AnkoComponent) in a separate class, if that matters.</p>\n"}, {"tags": ["android", "message", "kotlin", "smack", "packet"], "answers": [{"comments": [{"owner": {"reputation": 922, "user_id": 7124362, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/663c7ea155af997408dbe0a6a8914b52?s=128&d=identicon&r=PG&f=1", "display_name": "Ankur Khandelwal", "link": "https://stackoverflow.com/users/7124362/ankur-khandelwal"}, "edited": false, "score": 0, "creation_date": 1492848296, "post_id": 43556191, "comment_id": 74165119, "body": "hey can you look this question <a href=\"http://stackoverflow.com/questions/43541753/not-able-to-receive-group-message-using-smack?noredirect=1#comment74135452_43541753\" title=\"not able to receive group message using smack\">stackoverflow.com/questions/43541753/&hellip;</a>"}], "tags": [], "owner": {"reputation": 22020, "user_id": 194894, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5e5b6587ba56fcaae86fe5db95248e98?s=128&d=identicon&r=PG", "display_name": "Flow", "link": "https://stackoverflow.com/users/194894/flow"}, "is_accepted": true, "score": 1, "last_activity_date": 1492843678, "creation_date": 1492843678, "answer_id": 43556191, "question_id": 43491831, "link": "https://stackoverflow.com/questions/43491831/how-do-i-get-the-message-from-the-message-id-in-smack/43556191#43556191", "title": "How do I get the message from the message id in smack.", "body": "<p>Cast the forwarded Stanza to Message and call getBody().</p>\n"}, {"tags": [], "owner": {"reputation": 530, "user_id": 4019748, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I-L3P8LtQSc/AAAAAAAAAAI/AAAAAAAAFYw/MbJsnv8CHMQ/photo.jpg?sz=128", "display_name": "Fernando Bonet", "link": "https://stackoverflow.com/users/4019748/fernando-bonet"}, "is_accepted": false, "score": 1, "last_activity_date": 1494956056, "creation_date": 1494956056, "answer_id": 44008068, "question_id": 43491831, "link": "https://stackoverflow.com/questions/43491831/how-do-i-get-the-message-from-the-message-id-in-smack/44008068#44008068", "title": "How do I get the message from the message id in smack.", "body": "<p>The getBody() is for Message and the ForwardedStanza extends Stanza so it can be Message, IQ or Presence.</p>\n\n<p>Try this:</p>\n\n<pre><code>    if (forwarded.getForwardedStanza() instanceof Message) {\n        String body = ((Message) forwarded.getForwardedStanza()).getBody();\n    }\n</code></pre>\n"}], "owner": {"reputation": 922, "user_id": 7124362, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/663c7ea155af997408dbe0a6a8914b52?s=128&d=identicon&r=PG&f=1", "display_name": "Ankur Khandelwal", "link": "https://stackoverflow.com/users/7124362/ankur-khandelwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1071, "favorite_count": 0, "accepted_answer_id": 43556191, "answer_count": 2, "score": 1, "last_activity_date": 1494956056, "creation_date": 1492594606, "question_id": 43491831, "link": "https://stackoverflow.com/questions/43491831/how-do-i-get-the-message-from-the-message-id-in-smack", "title": "How do I get the message from the message id in smack.", "body": "<p>I am trying to fetch the chat history using below function:</p>\n\n<pre><code>    var mamManager:MamManager= MamManager.getInstanceFor(connection)\n    var prevMsg=mamManager.queryArchive(JidCreate.entityBareFrom(jid)).forwardedMessages\n\n        println(msg.forwardedStanza)\n</code></pre>\n\n<p>But I am getting the output as</p>\n\n<pre><code>04-19 14:17:58.414 7964-7964/com.example.itstym.smackchat I/System.out: Message Stanza [to=user2@replica3377.cloudapp.net,from=user1@replica3377.cloudapp.net/307135084148417199024926,id=qQ73x-27,]\n</code></pre>\n\n<p>I can also get stanza id using msg.forwardedStanza.stanzaId but how will i get the msg text.</p>\n"}, {"tags": ["android", "broadcastreceiver", "kotlin", "android-broadcastreceiver"], "comments": [{"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "edited": false, "score": 1, "creation_date": 1492589379, "post_id": 43489963, "comment_id": 74034784, "body": "Are you sure <code>mApplicationContext</code> is not equal to <code>null</code> when  <code>mApplicationContext?.sendBroadcast(i)</code> is invoked?"}, {"owner": {"reputation": 249, "user_id": 7220319, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-68nKgfYqfiE/AAAAAAAAAAI/AAAAAAAAAAk/MQI3o5AfhQs/photo.jpg?sz=128", "display_name": "Ankur Khandelwal", "link": "https://stackoverflow.com/users/7220319/ankur-khandelwal"}, "reply_to_user": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "edited": false, "score": 0, "creation_date": 1492589707, "post_id": 43489963, "comment_id": 74035002, "body": "yes mApplicationContext is not null @miensol"}], "answers": [{"tags": [], "owner": {"reputation": 2837, "user_id": 3234352, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ceezr.jpg?s=128&g=1", "display_name": "Sathya Baman", "link": "https://stackoverflow.com/users/3234352/sathya-baman"}, "is_accepted": false, "score": 1, "last_activity_date": 1492590469, "creation_date": 1492590469, "answer_id": 43490373, "question_id": 43489963, "link": "https://stackoverflow.com/questions/43489963/broadcast-receiver-onreceive-is-not-called/43490373#43490373", "title": "Broadcast receiver onReceive() is not called", "body": "<p>Try Like this</p>\n\n<p>In your activity Inside <strong>onCreate</strong> method declare</p>\n\n<pre><code>LocalBroadcastManager.getInstance(context).registerReceiver(MyBroadcastReceiver, new IntentFilter(\"MyFilter\"));\n</code></pre>\n\n<p>Then implement the MyBroadcastReceiver in Activity</p>\n\n<pre><code>private final BroadcastReceiver MyBroadcastReceiver = new BroadcastReceiver() {\n        @Override\n        public void onReceive(Context context, Intent intent) {\n\n            String Action = intent.getStringExtra(\"Action\");\n            switch (Action){\n                case \"updatedata\":\n                    String message = intent.getStringExtra(\"message\");\n                    String date_time = intent.getStringExtra(\"date_time\");\n                    break;\n\n                default:\n                    break;\n            }\n        }\n    };\n</code></pre>\n\n<p>Send the Broadcast like this</p>\n\n<pre><code>Intent intent = new Intent(\"MyFilter\");\nintent.putExtra(\"message\", message);\nintent.putExtra(\"date_time\", date_time);\nintent.putExtra(\"Action\", \"updatedata\");\nLocalBroadcastManager.getInstance(context).sendBroadcast(intent);\n</code></pre>\n"}], "owner": {"reputation": 249, "user_id": 7220319, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-68nKgfYqfiE/AAAAAAAAAAI/AAAAAAAAAAk/MQI3o5AfhQs/photo.jpg?sz=128", "display_name": "Ankur Khandelwal", "link": "https://stackoverflow.com/users/7220319/ankur-khandelwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1678, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492590469, "creation_date": 1492589187, "question_id": 43489963, "link": "https://stackoverflow.com/questions/43489963/broadcast-receiver-onreceive-is-not-called", "title": "Broadcast receiver onReceive() is not called", "body": "<p>Broadcast receiver </p>\n\n<pre><code> mBroadcastReceiver = object : BroadcastReceiver() {\n            override fun onReceive(context: Context, intent: Intent) {\n\n                Log.i(TAG,\"contact list populate broadcast\")\n\n                var action = intent.action\n\n                Log.v(\"Action is \",action)\n                when (action) {\n                    GetContactListFromServer -&gt; {\n                       println(\"Get contact list\")\n\n\n                    }\n                }\n\n            }\n        }\n\n        val filter = IntentFilter(GetContactListFromServer)\n        this.registerReceiver(mBroadcastReceiver, filter)\n</code></pre>\n\n<p>This is how I am sending broadcast</p>\n\n<pre><code>val i = Intent(ContactListActivity.Obz.GetContactListFromServer)\ni.`package` = mApplicationContext?.getPackageName()\nmApplicationContext?.sendBroadcast(i)\n</code></pre>\n\n<p>This code is working fine till last night. I am not able to debug what is going wrong?</p>\n"}, {"tags": ["java", "kotlin", "obfuscation", "allatori"], "comments": [{"owner": {"reputation": 533, "user_id": 2266904, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SnIhU.jpg?s=128&g=1", "display_name": "AndroidCoolestRulest", "link": "https://stackoverflow.com/users/2266904/androidcoolestrulest"}, "edited": false, "score": 0, "creation_date": 1574856493, "post_id": 43483074, "comment_id": 104377738, "body": "Did you manage to use Allatori with Kotlin?"}], "owner": {"reputation": 7656, "user_id": 1938929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/OeAme.png?s=128&g=1", "display_name": "Jire", "link": "https://stackoverflow.com/users/1938929/jire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 279, "favorite_count": 2, "answer_count": 0, "score": 3, "last_activity_date": 1492626547, "creation_date": 1492553597, "last_edit_date": 1492626547, "question_id": 43483074, "link": "https://stackoverflow.com/questions/43483074/is-it-possible-to-use-allatori-on-kotlin-source-code", "title": "Is it possible to use Allatori on Kotlin source code?", "body": "<p>I've tried to use Allatori in the past and regardless of disabling a lot of options, I couldn't get it to apply to actual Kotlin bytecode - I had to exclude the Kotlin files in order for the obfuscation to work.</p>\n\n<p>Is it possible to use Allatori obfuscation on Kotlin bytecode? If so, which options need to be disabled?</p>\n"}, {"tags": ["kotlin"], "comments": [{"owner": {"reputation": 4319, "user_id": 4874829, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cfECAGc8huU/AAAAAAAAAAI/AAAAAAAAAJk/Pebw5H-quLo/photo.jpg?sz=128", "display_name": "Yoav Sternberg", "link": "https://stackoverflow.com/users/4874829/yoav-sternberg"}, "edited": false, "score": 5, "creation_date": 1492535754, "post_id": 43477903, "comment_id": 74012118, "body": "Just receive a <code>() -&gt; T</code> as a parameter for your method."}, {"owner": {"reputation": 3462, "user_id": 2094298, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/26a93895eedcc45a0ebc3bb0da2cfbe6?s=128&d=identicon&r=PG", "display_name": "Ruckus T-Boom", "link": "https://stackoverflow.com/users/2094298/ruckus-t-boom"}, "edited": false, "score": 4, "creation_date": 1492535778, "post_id": 43477903, "comment_id": 74012133, "body": "It&#39;s generally considered best practice to pass in a <code>() -&gt; T</code> anywhere you would use such code, and let the call site handle instantiation, since you can&#39;t guarantee the <code>T</code> will have a no-arg constructor."}, {"owner": {"reputation": 3462, "user_id": 2094298, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/26a93895eedcc45a0ebc3bb0da2cfbe6?s=128&d=identicon&r=PG", "display_name": "Ruckus T-Boom", "link": "https://stackoverflow.com/users/2094298/ruckus-t-boom"}, "reply_to_user": {"reputation": 4319, "user_id": 4874829, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cfECAGc8huU/AAAAAAAAAAI/AAAAAAAAAJk/Pebw5H-quLo/photo.jpg?sz=128", "display_name": "Yoav Sternberg", "link": "https://stackoverflow.com/users/4874829/yoav-sternberg"}, "edited": false, "score": 2, "creation_date": 1492535813, "post_id": 43477903, "comment_id": 74012155, "body": "@YoavSternberg You beat me by 20 seconds :)"}, {"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "edited": false, "score": 0, "creation_date": 1492587663, "post_id": 43477903, "comment_id": 74033771, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/26992039/what-is-the-proper-way-to-create-new-instance-of-generic-class-in-kotlin\">What is the proper way to create new instance of generic class in kotlin?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11647, "user_id": 507950, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0dabb66f0e0b88d90ccd9d0936e96f0e?s=128&d=identicon&r=PG", "display_name": "dodgy_coder", "link": "https://stackoverflow.com/users/507950/dodgy-coder"}, "edited": false, "score": 5, "creation_date": 1549199456, "post_id": 43478510, "comment_id": 95810319, "body": "Thanks for your answer. Looks like they weren&#39;t able to bring in the best from all modern languages then ... as a C# developer looking at Kotlin this is a bit of a letdown. They should have found some way to work some magic into the runtime."}, {"owner": {"reputation": 4476, "user_id": 137507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6f56d22d91fdc4f77fa3be933310745e?s=128&d=identicon&r=PG", "display_name": "david.barkhuizen", "link": "https://stackoverflow.com/users/137507/david-barkhuizen"}, "edited": false, "score": 6, "creation_date": 1554471132, "post_id": 43478510, "comment_id": 97776575, "body": "It&#39;s crazy that the decision to implement generics in Java via type erasure to ensure backwards compatibility has had such long-term negative effects on the JVM ecosystem."}], "tags": [], "owner": {"reputation": 3397, "user_id": 574826, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jvb1q.jpg?s=128&g=1", "display_name": "pdpi", "link": "https://stackoverflow.com/users/574826/pdpi"}, "is_accepted": true, "score": 21, "last_activity_date": 1602840126, "last_edit_date": 1602840126, "creation_date": 1492536073, "answer_id": 43478510, "question_id": 43477903, "link": "https://stackoverflow.com/questions/43477903/instantiating-a-generic-type-in-kotlin/43478510#43478510", "title": "Instantiating a generic type in Kotlin", "body": "<p>EDIT: As mentioned in comments, this is probably a bad idea. Accepting a <code>() -&gt; T</code> is probably the most reasonable way of achieving this. That said, the following technique will achieve what you're looking for, if not necessarily in the most idiomatic way.</p>\n<p>Unfortunately, you can't achieve that directly: Kotlin is hamstrung by its Java ancestry, so generics are erased at run time, meaning T is no longer available to use directly. Using reflection and inline functions, you can work around this, though:</p>\n<pre><code>/* We have no way to guarantee that an empty constructor exists, so must return T? instead of T */\ninline fun &lt;reified T : Any&gt; getValue(): T? {\n    val primaryConstructor = T::class.constructors.find { it.parameters.isEmpty() }\n    return primaryConstructor?.call()\n}\n</code></pre>\n<p>If we add some sample classes, you can see that this will return an instance when an empty constructor exists, or null otherwise:</p>\n<pre><code>class Foo() {}\nclass Bar(val label: String) { constructor() : this(&quot;bar&quot;)}\nclass Baz(val label: String)\n    \nfun main(args: Array&lt;String&gt;) {\n    System.out.println(&quot;Foo: ${getValue&lt;Foo&gt;()}&quot;) // Foo@...\n    // No need to specify the type when it can be inferred\n    val foo : Foo? = getValue()\n    System.out.println(&quot;Foo: ${foo}&quot;) // Foo@...\n    System.out.println(&quot;Bar: ${getValue&lt;Bar&gt;()}&quot;) // Prints Bar@...\n    System.out.println(&quot;Baz: ${getValue&lt;Baz&gt;()}&quot;) // null\n}\n</code></pre>\n"}], "owner": {"reputation": 2107, "user_id": 602114, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/07033bf8a7c36751fc329d524683fa12?s=128&d=identicon&r=PG", "display_name": "ikh", "link": "https://stackoverflow.com/users/602114/ikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9253, "favorite_count": 5, "accepted_answer_id": 43478510, "answer_count": 1, "score": 26, "last_activity_date": 1602840126, "creation_date": 1492534143, "last_edit_date": 1590147688, "question_id": 43477903, "link": "https://stackoverflow.com/questions/43477903/instantiating-a-generic-type-in-kotlin", "title": "Instantiating a generic type in Kotlin", "body": "<p>What's the best way to get an instance of a generic type in Kotlin? I am hoping to find the best approximation of the following C# code:</p>\n\n<pre><code>public T GetValue&lt;T&gt;() where T : new() {\n    return new T();\n}\n</code></pre>\n"}, {"tags": ["android", "kotlin", "android-databinding"], "answers": [{"comments": [{"owner": {"reputation": 1139, "user_id": 1506976, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/kteXE.gif?s=128&g=1", "display_name": "Marcel50506", "link": "https://stackoverflow.com/users/1506976/marcel50506"}, "edited": false, "score": 0, "creation_date": 1492587464, "post_id": 43481318, "comment_id": 74033637, "body": "I want to link the &#39;click&#39; with the BleutoothDevice as an argument back to the activity (so not to the adapter). How would you achieve this?"}, {"owner": {"reputation": 1214, "user_id": 6095439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb0a801257ee75e0987200564b0ea798?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6095439/john"}, "reply_to_user": {"reputation": 1139, "user_id": 1506976, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/kteXE.gif?s=128&g=1", "display_name": "Marcel50506", "link": "https://stackoverflow.com/users/1506976/marcel50506"}, "edited": false, "score": 0, "creation_date": 1492589383, "post_id": 43481318, "comment_id": 74034786, "body": "You can define your activity as a handler"}, {"owner": {"reputation": 1139, "user_id": 1506976, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/kteXE.gif?s=128&g=1", "display_name": "Marcel50506", "link": "https://stackoverflow.com/users/1506976/marcel50506"}, "edited": false, "score": 0, "creation_date": 1492589828, "post_id": 43481318, "comment_id": 74035078, "body": "That is a solution, but I&#39;d rather not have my Activity in the BindingLayout, since it would make it unsuitable for reuse (since I can only use that layout with that Activity)."}, {"owner": {"reputation": 4805, "user_id": 1085264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b8e1b984756a7ed46d210e80c0957895?s=128&d=identicon&r=PG", "display_name": "straya", "link": "https://stackoverflow.com/users/1085264/straya"}, "edited": false, "score": 0, "creation_date": 1604892999, "post_id": 43481318, "comment_id": 114476270, "body": "These days it is common to use a ViewModel, so the above would be `android:onClick=&quot;@{viewModel.onSomeClick}&quot;. That ViewModel should be for your Framgment or Activity (or even a specific View or feature), the Fragment/Activity can observe a LiveData from the ViewModel and route value updates to wherever they need to go (in your case to some main Activity it seems)."}], "tags": [], "owner": {"reputation": 1214, "user_id": 6095439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb0a801257ee75e0987200564b0ea798?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6095439/john"}, "is_accepted": false, "score": 1, "last_activity_date": 1492546190, "creation_date": 1492546190, "answer_id": 43481318, "question_id": 43477314, "link": "https://stackoverflow.com/questions/43477314/replace-java-generic-interface-in-kotlin-for-databinding/43481318#43481318", "title": "Replace java generic interface in Kotlin for Databinding", "body": "<p>You can just have a method, for example <code>onSomeClick()</code> in your class, and call it like this:  <code>android:onClick=\"@{onSomeClick}\"</code></p>\n"}], "owner": {"reputation": 1139, "user_id": 1506976, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/kteXE.gif?s=128&g=1", "display_name": "Marcel50506", "link": "https://stackoverflow.com/users/1506976/marcel50506"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 877, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1492587600, "creation_date": 1492532186, "last_edit_date": 1492587600, "question_id": 43477314, "link": "https://stackoverflow.com/questions/43477314/replace-java-generic-interface-in-kotlin-for-databinding", "title": "Replace java generic interface in Kotlin for Databinding", "body": "<p>I'm getting to know Kotlin as an Android developer. When making android apps, I'm used to using Databinding, retrolambda, etc. Now I'm a bit lost in how to solve the following case in Kotlin.</p>\n\n<h2>How I would normally do this in java</h2>\n\n<p>I have an <code>Adapter</code> (extends <code>RecyclerView.Adapter</code>) for a <code>RecyclerView</code> showing a list of <code>BluetoothDevice</code>s. Normally, all my projects have a generic interface TypedClickListener, which will give back the T object of the listitem the user clicked on. Like so:</p>\n\n<p><em>The generic interface:</em></p>\n\n<pre><code>public interface TypedClickListener&lt;T&gt; {\n    void onClick(T t);\n}\n</code></pre>\n\n<p><em>Constructor of PairedDeviceAdapter</em></p>\n\n<pre><code>public PairedDeviceAdapter(Context context, BluetoothDevice[] devices, TypedClickHandler&lt;BluetoothDevice&gt; handler){\n    mContext = context;\n    mDevices = devices\n    mClickHandler = handler;\n}\n</code></pre>\n\n<p><em>The adapter's onBindViewHolder: (the holder contains a databinding layout)</em></p>\n\n<pre><code>public void onBindViewHolder(DatabindViewHolder holder, Int position) {\n    holder.getBinding().setVariable(BR.device, mDevices[position]);\n    holder.getBinding().setVariable(BR.handler, mClickHandler);\n}\n</code></pre>\n\n<p><em>The layout itself:</em></p>\n\n<pre><code>&lt;layout xmlns:android=\"http://schemas.android.com/apk/res/android\"&gt;\n    &lt;data&gt;\n        &lt;import type=\"android.bluetooth.BluetoothDevice\"/&gt;\n        &lt;import type=\"com.example.TypedClickHandler\"/&gt;\n        &lt;variable\n            name=\"device\"\n            type=\"BluetoothDevice\"/&gt;\n        &lt;variable\n            name=\"handler\"\n            type=\"TypedClickHandler\"/&gt;\n    &lt;/data&gt;\n    &lt;LinearLayout\n        ... // width, height, etc\n        android:onClick=\"@{v-&gt;handler.onClick(device)}\"&gt;\n        ... // Row layout etc\n    &lt;/LinearLayout&gt;\n&lt;/layout&gt;\n</code></pre>\n\n<p>Now, putting everything together:</p>\n\n<p><em>Passing the TypedClickListener to the Adapter in the Activity:</em></p>\n\n<pre><code>mAdapter = PairedDeviceAdapter(this, devices, (bluetoothDevice) -&gt; {\n    // The code that is ran when user clicks a device\n}\n</code></pre>\n\n<h2>How I'm trying to do this in Kotlin</h2>\n\n<p>As said, I'm trying to do this with Kotlin. It seems I can skip the step of having a <code>TypedClickListener</code>, since I can use a simple inline function <code>(BluetoothDevice) -&gt; Unit</code>. </p>\n\n<p><em>The PairedDeviceAdapter looks like this:</em></p>\n\n<pre><code>class PairedDeviceAdapter(val context: Context, val clickHandler : (BluetoothDevice) -&gt; Unit ) : RecyclerView.Adapter&lt;DatabindViewHolder&gt;() {\n</code></pre>\n\n<p>The onBindViewHolder looks kinda the same as the Java version of it. However, I can't figure out how to bind my layout to the clickhandler, since I don't have the type of the clickhandler.</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;layout xmlns:android=\"http://schemas.android.com/apk/res/android\"&gt;\n    &lt;data&gt;\n        &lt;import type=\"android.bluetooth.BluetoothDevice\"/&gt;\n        &lt;import type=\"???\"/&gt;\n        &lt;variable\n            name=\"device\"\n            type=\"BluetoothDevice\"/&gt;\n        &lt;variable\n            name=\"handler\"\n            type=\"???\"/&gt;\n    &lt;/data&gt;\n    &lt;LinearLayout\n        ...\n        android:onClick=\"@{v-&gt;handler.???(device)}\"&gt;\n        ... // close everything\n</code></pre>\n\n<h2>Question</h2>\n\n<p>How can I make this same structure in Kotlin, or is there another (smarter?) solution to binding a adapter-row-click to a lambda function defined in the <code>Activity</code> (or <code>Fragment</code>).</p>\n"}, {"tags": ["java", "kotlin", "observable"], "answers": [{"comments": [{"owner": {"reputation": 9683, "user_id": 4076764, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c214b9830295015777d8c6cbc8462b4f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Hughes", "link": "https://stackoverflow.com/users/4076764/adam-hughes"}, "edited": false, "score": 0, "creation_date": 1492537040, "post_id": 43477351, "comment_id": 74012928, "body": "Thanks.  I&#39;ve updated my question to reflect my concrete implementation.  If you have any suggestions, please feel free to add to this answer."}, {"owner": {"reputation": 4319, "user_id": 4874829, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cfECAGc8huU/AAAAAAAAAAI/AAAAAAAAAJk/Pebw5H-quLo/photo.jpg?sz=128", "display_name": "Yoav Sternberg", "link": "https://stackoverflow.com/users/4874829/yoav-sternberg"}, "reply_to_user": {"reputation": 9683, "user_id": 4076764, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c214b9830295015777d8c6cbc8462b4f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Hughes", "link": "https://stackoverflow.com/users/4076764/adam-hughes"}, "edited": false, "score": 0, "creation_date": 1492542069, "post_id": 43477351, "comment_id": 74016024, "body": "@AdamHughes why not just <code>override val observers: MutableList&lt;Observer&lt;String&gt;&gt; = LinkedList()</code>? Why do you need an explicit backing field?"}, {"owner": {"reputation": 4319, "user_id": 4874829, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cfECAGc8huU/AAAAAAAAAAI/AAAAAAAAAJk/Pebw5H-quLo/photo.jpg?sz=128", "display_name": "Yoav Sternberg", "link": "https://stackoverflow.com/users/4874829/yoav-sternberg"}, "reply_to_user": {"reputation": 9683, "user_id": 4076764, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c214b9830295015777d8c6cbc8462b4f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Hughes", "link": "https://stackoverflow.com/users/4076764/adam-hughes"}, "edited": false, "score": 0, "creation_date": 1492542175, "post_id": 43477351, "comment_id": 74016089, "body": "Also, you can keep your helping function in the interface, or even better: declare them outside as extension methods :)"}, {"owner": {"reputation": 9683, "user_id": 4076764, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c214b9830295015777d8c6cbc8462b4f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Hughes", "link": "https://stackoverflow.com/users/4076764/adam-hughes"}, "edited": false, "score": 0, "creation_date": 1492542309, "post_id": 43477351, "comment_id": 74016168, "body": "Yoav, if I set <code>val observers = LinkedList()</code> won&#39;t this generate a new LinkedList() each time the getter is called?  I want to reuse this list.  I will look into extension methods, I&#39;m not really familiar with what you&#39;re proposing (new to kotlin)"}, {"owner": {"reputation": 4319, "user_id": 4874829, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cfECAGc8huU/AAAAAAAAAAI/AAAAAAAAAJk/Pebw5H-quLo/photo.jpg?sz=128", "display_name": "Yoav Sternberg", "link": "https://stackoverflow.com/users/4874829/yoav-sternberg"}, "reply_to_user": {"reputation": 9683, "user_id": 4076764, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c214b9830295015777d8c6cbc8462b4f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Hughes", "link": "https://stackoverflow.com/users/4076764/adam-hughes"}, "edited": false, "score": 0, "creation_date": 1492575384, "post_id": 43477351, "comment_id": 74027813, "body": "No, only if you use the getter syntax <code>get() = LinkedList()</code>"}, {"owner": {"reputation": 9683, "user_id": 4076764, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c214b9830295015777d8c6cbc8462b4f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Hughes", "link": "https://stackoverflow.com/users/4076764/adam-hughes"}, "edited": false, "score": 0, "creation_date": 1492792256, "post_id": 43477351, "comment_id": 74147561, "body": "Ah thanks, I was using incorrect syntax when I originally attempted that.  I was doing <code>val observers: LinkedList()</code> instead of &#39;val observers = LinkedList()`"}], "tags": [], "owner": {"reputation": 4319, "user_id": 4874829, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cfECAGc8huU/AAAAAAAAAAI/AAAAAAAAAJk/Pebw5H-quLo/photo.jpg?sz=128", "display_name": "Yoav Sternberg", "link": "https://stackoverflow.com/users/4874829/yoav-sternberg"}, "is_accepted": true, "score": 4, "last_activity_date": 1492532290, "creation_date": 1492532290, "answer_id": 43477351, "question_id": 43476811, "link": "https://stackoverflow.com/questions/43476811/can-a-kotlin-interface-cache-a-value/43477351#43477351", "title": "Can a kotlin interface cache a value?", "body": "<p>According to Kotlin docs:</p>\n\n<blockquote>\n  <p>Interfaces in Kotlin are very similar to Java 8. They can contain\n  declarations of abstract methods, as well as method implementations.\n  What makes them different from abstract classes is that interfaces\n  cannot store state.</p>\n</blockquote>\n\n<p>Interface can't hold any state as they are fully abstract. Perhaps you should use an <code>abstract class</code> in order to cache the values?</p>\n\n<p>See <a href=\"https://softwareengineering.stackexchange.com/questions/184945/why-is-an-interface-in-java-not-allowed-to-have-state\">this</a> question for more information about the reason for interfaces being stateless.</p>\n\n<blockquote>\n  <p>An interface is a contract specifying what its implementer promises to\n  be able to do. It does not need to specify state because state is an\n  implementation detail and only serves to constrain implementers in how\n  this contract is fulfilled. If you want to specify state you might\n  want to rethink you use of interfaces and look at abstract base\n  classes instead.</p>\n</blockquote>\n"}], "owner": {"reputation": 9683, "user_id": 4076764, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c214b9830295015777d8c6cbc8462b4f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Hughes", "link": "https://stackoverflow.com/users/4076764/adam-hughes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 725, "favorite_count": 0, "accepted_answer_id": 43477351, "answer_count": 1, "score": 1, "last_activity_date": 1492537279, "creation_date": 1492530643, "last_edit_date": 1495542854, "question_id": 43476811, "link": "https://stackoverflow.com/questions/43476811/can-a-kotlin-interface-cache-a-value", "title": "Can a kotlin interface cache a value?", "body": "<p>I really like using default implementations for interfaces in Kotlin, especially for common patterns like Observable.  Here's my interface,</p>\n\n<pre><code>interface Observable&lt;T&gt;{\n\n    // How do I cache this?\n    val observers: MutableList&lt;Observer&lt;T&gt;&gt;\n        get() = LinkedList&lt;&gt;()\n\n    fun addObserver(o:Observer&lt;T&gt;){\n        observers.add(o)\n    }\n\n    fun removeObserver(o:Observer&lt;T&gt;){\n        observers.remove(o)\n    }\n\n    fun notifyObservers(u:T){\n        for (o in observers){\n            o.update(u)\n        }\n    }\n\n}\n</code></pre>\n\n<p>The interface refers to a list of <code>observers</code>, but the <code>get()</code> call is returning a new <code>LinkedList()</code> each time.  How can I cache the value of <code>observers</code> so that it's only created once?  I've tried using <a href=\"https://stackoverflow.com/questions/ask\">kotlin-lazy</a>, but either can't get the syntax right, or it's not meant for interfaces.  My IDE complains \"Delegated properties are not allowed in interfaces.\"</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Based on Yoav's answer, I've change my interface to</p>\n\n<pre><code>interface Observable&lt;T&gt;{\n    val observers: MutableList&lt;Observer&lt;T&gt;&gt;\n}\n</code></pre>\n\n<p>And then in the implementing class,</p>\n\n<pre><code>class MyObservable : Observable&lt;String&gt;\n\n   private val _observers = LinkedList&lt;Observer&lt;String&gt;&gt;()\n\n   override val observers: MutableList&lt;Observer&lt;String&gt;&gt;\n       get() = _observers\n</code></pre>\n\n<p>Any tips to make this more succinct?</p>\n"}, {"tags": ["android", "binding", "kotlin"], "answers": [{"tags": [], "owner": {"reputation": 1214, "user_id": 6095439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb0a801257ee75e0987200564b0ea798?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6095439/john"}, "is_accepted": true, "score": 1, "last_activity_date": 1492521805, "last_edit_date": 1492521805, "creation_date": 1492521438, "answer_id": 43473362, "question_id": 43471602, "link": "https://stackoverflow.com/questions/43471602/android-kotlin-imageview-binding/43473362#43473362", "title": "Android Kotlin ImageView binding", "body": "<p>Function<code>loadPhotoFilePath</code> should be out of class, place it above <code>class OrderInfoFragment</code>.</p>\n\n<p>Or another way would be to annotate it as <code>@JvmStatic</code></p>\n"}], "owner": {"reputation": 81, "user_id": 644072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194d8baa52ea6ea1654ee574c02d13d6?s=128&d=identicon&r=PG", "display_name": "slartus", "link": "https://stackoverflow.com/users/644072/slartus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 785, "favorite_count": 0, "closed_date": 1492521923, "accepted_answer_id": 43473362, "answer_count": 1, "score": 0, "last_activity_date": 1492521805, "creation_date": 1492516971, "last_edit_date": 1492521078, "question_id": 43471602, "link": "https://stackoverflow.com/questions/43471602/android-kotlin-imageview-binding", "closed_reason": "Needs details or clarity", "title": "Android Kotlin ImageView binding", "body": "<p>How do I bind data to an imageview in kotlin?</p>\n\n<pre><code>&lt;ImageView               \n    app:photoFilePath=\"@{item.photoFilePath}\"\n    android:layout_width=\"60dp\"\n    android:layout_height=\"60dp\"\n/&gt;\n</code></pre>\n\n<p><strong>This is my class what i have implemented :</strong> </p>\n\n<pre><code>class OrderInfoFragment : BaseDialogFragment() {\n    private lateinit var mOrderItem: OrderItem\n    override fun onCreateDialog(savedInstanceState: Bundle?): Dialog {\n        val inflater = activity.layoutInflater\n        val binding = DataBindingUtil.inflate&lt;FragmentOrderInfoBinding&gt;(\n                inflater, R.layout.fragment_order_info, null, false)\n        val view = binding.root\n          binding.item = mOrderItem\n    }\n\n    @BindingAdapter(\"bind:photoFilePath\")\n    fun loadPhotoFilePath(imageView: ImageView, path: String) {\n\n    }\n}\n</code></pre>\n\n<p>I have tried using <code>loadPhotoFilePath</code> in the companion object.</p>\n"}, {"tags": ["lambda", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "edited": false, "score": 7, "creation_date": 1492513493, "post_id": 43469333, "comment_id": 73995616, "body": "Probably it&#39;s also worth mentioning that, if the original intention of the interface was to express the semantics of the expected function, then you can use <a href=\"https://kotlinlang.org/docs/reference/whatsnew11.html#type-aliases\" rel=\"nofollow noreferrer\">typealiases</a> or functional types with named parameters like <code>(bytesUploaded: Long) -&gt; Unit</code>."}], "tags": [], "owner": {"reputation": 68863, "user_id": 4465208, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/w14F6.png?s=128&g=1", "display_name": "zsmb13", "link": "https://stackoverflow.com/users/4465208/zsmb13"}, "is_accepted": false, "score": 29, "last_activity_date": 1492510319, "creation_date": 1492510319, "answer_id": 43469333, "question_id": 43469241, "link": "https://stackoverflow.com/questions/43469241/passing-lambda-instead-of-interface/43469333#43469333", "title": "Passing lambda instead of interface", "body": "<p>Kotlin only supports SAM conversions for Java interfaces.</p>\n\n<blockquote>\n  <p>... note that this feature works only for Java interop; since Kotlin\n  has proper function types, automatic conversion of functions into\n  implementations of Kotlin interfaces is unnecessary and therefore\n  unsupported.</p>\n</blockquote>\n\n<p>-- <a href=\"https://kotlinlang.org/docs/reference/java-interop.html#sam-conversions\" rel=\"noreferrer\">Official documentation</a></p>\n\n<p>If you want to use a lambda in the parameter, make your function take a function parameter instead of an interface. (For now at least. Supporting SAM conversions for Kotlin interfaces is an ongoing discussion, it was one of the possible future features at the Kotlin 1.1 live stream.)</p>\n"}, {"comments": [{"owner": {"reputation": 4601, "user_id": 680583, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a00127568b70da5b09210c50b0504042?s=128&d=identicon&r=PG", "display_name": "rmirabelle", "link": "https://stackoverflow.com/users/680583/rmirabelle"}, "edited": false, "score": 1, "creation_date": 1613459703, "post_id": 43470351, "comment_id": 117074218, "body": "<code>fun interface</code> - truer words were hardly ever written."}, {"owner": {"reputation": 294, "user_id": 7545745, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BCSPGQDHalY/AAAAAAAAAAI/AAAAAAAAAI4/gKv3RkoGOjA/photo.jpg?sz=128", "display_name": "Abhilash Maurya", "link": "https://stackoverflow.com/users/7545745/abhilash-maurya"}, "edited": false, "score": 0, "creation_date": 1613542575, "post_id": 43470351, "comment_id": 117103168, "body": "yes <code>fun interface</code> this will make the normal interface to functional interface."}], "tags": [], "owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "is_accepted": true, "score": 57, "last_activity_date": 1575925568, "last_edit_date": 1575925568, "creation_date": 1492513245, "answer_id": 43470351, "question_id": 43469241, "link": "https://stackoverflow.com/questions/43469241/passing-lambda-instead-of-interface/43470351#43470351", "title": "Passing lambda instead of interface", "body": "<p>As @zsmb13 said, SAM conversions are only supported for Java interfaces.</p>\n\n<p>You could create an extension function to make it work though:</p>\n\n<pre><code>// Assuming the type of dataManager is DataManager.\nfun DataManager.createAndSubmitSendIt(title: String, \n                                      message: String, \n                                      progressListener: (Long) -&gt; Unit) {\n    createAndSubmitSendIt(title, message,\n        object : ProgressListener {\n            override fun transferred(bytesUploaded: Long) {\n                progressListener(bytesUploaded)\n            }\n        })\n}\n</code></pre>\n\n<p><em>Edit:</em></p>\n\n<p>Kotlin 1.4 will bring function interfaces that enables SAM conversions for interfaces defined in Kotlin. This means that you can call your function with a lambda if you define your interface with the <code>fun</code> keyword. Like this:</p>\n\n<pre><code>fun interface ProgressListener {\n    fun transferred(bytesUploaded: Long)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1443, "user_id": 2384934, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/gNaHo.jpg?s=128&g=1", "display_name": "Louis Tsai", "link": "https://stackoverflow.com/users/2384934/louis-tsai"}, "is_accepted": false, "score": 10, "last_activity_date": 1519211412, "creation_date": 1519211412, "answer_id": 48904381, "question_id": 43469241, "link": "https://stackoverflow.com/questions/43469241/passing-lambda-instead-of-interface/48904381#48904381", "title": "Passing lambda instead of interface", "body": "<p>A little late to the party: instead of making an interface, you let the compile create one by taking a function directly instead of an interface in your datamanager, like this:</p>\n\n<pre><code>fun createAndSubmitSendIt(title: String, message: String, transferred: (Long) -&gt; Unit) {\n    val answer = TODO(\"whatever you need to do\")\n    transferred(answer)\n}\n</code></pre>\n\n<p>and then you just use it like how you want it! If I remember correctly, what the kotlin/jvm compiler do is the same as making an interface. </p>\n\n<p>Hope it helps!</p>\n"}, {"comments": [{"owner": {"reputation": 497, "user_id": 2470297, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/ipYCA.png?s=128&g=1", "display_name": "bearlysophisticated", "link": "https://stackoverflow.com/users/2470297/bearlysophisticated"}, "edited": false, "score": 0, "creation_date": 1548243775, "post_id": 53860126, "comment_id": 95471196, "body": "This is a nice solution and you don&#39;t even need that extra <code>typealias</code>."}, {"owner": {"reputation": 22949, "user_id": 6998684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqR2Z.jpg?s=128&g=1", "display_name": "IgorGanapolsky", "link": "https://stackoverflow.com/users/6998684/igorganapolsky"}, "edited": false, "score": 0, "creation_date": 1569259855, "post_id": 53860126, "comment_id": 102530823, "body": "Nested and local typealiases are not supported"}], "tags": [], "owner": {"reputation": 13958, "user_id": 689723, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/rQNO2.jpg?s=128&g=1", "display_name": "cesards", "link": "https://stackoverflow.com/users/689723/cesards"}, "is_accepted": false, "score": 9, "last_activity_date": 1599534746, "last_edit_date": 1599534746, "creation_date": 1545258985, "answer_id": 53860126, "question_id": 43469241, "link": "https://stackoverflow.com/questions/43469241/passing-lambda-instead-of-interface/53860126#53860126", "title": "Passing lambda instead of interface", "body": "<p><strong>UPDATED: September 7th, 2020</strong></p>\n<p>As the Kotlin <a href=\"https://kotlinlang.org/docs/reference/whatsnew14.html#sam-conversions-for-kotlin-interfaces\" rel=\"nofollow noreferrer\">documentation</a> for the Kotlin 1.4 release points out:</p>\n<blockquote>\n<p>Before Kotlin 1.4.0, you could apply SAM (Single Abstract Method) conversions only when working with Java methods and Java interfaces from Kotlin. From now on, you can use SAM conversions for Kotlin interfaces as well. To do so, mark a Kotlin interface explicitly as functional with the fun modifier.</p>\n</blockquote>\n<pre><code>fun interface Operation1 {\n    operator fun invoke(x: String): String\n}\n\nfun interface Operation2 {\n    fun doSomething(x: Int): String\n}\n\nval operation1 = Operation1 { &quot;$it world!&quot; }\nval operation2 = Operation2 { &quot;$it world!&quot; }\n\nfun main() {\n    // Usage: First sample.\n    println(operation1(&quot;Hello&quot;))\n    println(operation2.doSomething(0))\n    // Usage: Second sample.\n    println(Operation1 { &quot;$it world!&quot; }(&quot;Hello&quot;))\n    println(Operation2 { &quot;$it!&quot; }.doSomething(0))\n}\n</code></pre>\n<p>You can read more about functional interfaces <a href=\"https://kotlinlang.org/docs/reference/fun-interfaces.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n<p><strong>Previous solution:</strong></p>\n<p>Declare a typealias, inject it somewhere and invoke it later on:</p>\n<pre><code>internal typealias WhateverListener = (String) -&gt; Unit\n</code></pre>\n<p>and then we inject that typealias to our class:</p>\n<pre><code>class Gallery constructor(private val whateverListener: WhateverListener) {\n    \n    ...\n    \n    galleryItemClickListener.invoke(&quot;hello&quot;)\n\n    ...\n}\n</code></pre>\n<p>so we have our lambda:</p>\n<pre><code>val gallery = Gallery { appNavigator.openVideoPlayer(it) }\n</code></pre>\n<p>Credits to my colleague Joel Pedraza, who showed me the trick while trying to find a solution &lt;3.</p>\n<p><strong>NOTE: Check out the <a href=\"https://kotlinlang.org/docs/reference/fun-interfaces.html#functional-interfaces-vs-type-aliases\" rel=\"nofollow noreferrer\">Kotlin documentation</a> in case you want to know when to use either functional interfaces (lambdas) or type aliases.</strong></p>\n"}, {"tags": [], "owner": {"reputation": 1158, "user_id": 3658767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba715eae211bdea161beb6913420bd70?s=128&d=identicon&r=PG&f=1", "display_name": "fthdgn", "link": "https://stackoverflow.com/users/3658767/fthdgn"}, "is_accepted": false, "score": 6, "last_activity_date": 1586246105, "last_edit_date": 1586246105, "creation_date": 1569506083, "answer_id": 58118410, "question_id": 43469241, "link": "https://stackoverflow.com/questions/43469241/passing-lambda-instead-of-interface/58118410#58118410", "title": "Passing lambda instead of interface", "body": "<h1>Kotlin 1.4 and after</h1>\n\n<p>Kotlin 1.4 will fix this problem via \"Functional Interfaces\"</p>\n\n<h2>Kotlin Functional Interface</h2>\n\n<blockquote>\n  <ul>\n  <li>Kotlin API: Perfect</li>\n  <li>Kotlin Access: Perfect</li>\n  <li>Java Access: Perfect</li>\n  </ul>\n</blockquote>\n\n<pre><code>class KotlinApi {\n    fun interface Listener {\n        fun onResponse(response: String)\n    }\n\n    fun demo(listener: Listener) {\n        listener.onResponse(\"response\")\n    }\n}\n\nfun kotlinConsumer() {\n    KotlinApi().demo { response -&gt;\n        println(response)\n    }\n}\n\npublic static void javaConsumer(){\n    new KotlinApi().demo(response -&gt; {\n        System.out.println(response);\n    });\n}\n</code></pre>\n\n<h1>Before Kotlin 1.4</h1>\n\n<p>There is no single ultimate solution for this problem if you are aiming best access experience from both Kotlin and Java.</p>\n\n<p>If Kotlin developers had not thought SAM conversion for Kotlin interfaces is unnecessary, \"Kotlin Interface\" method would be ultimate solution.</p>\n\n<blockquote>\n  <p><a href=\"https://kotlinlang.org/docs/reference/java-interop.html#sam-conversions\" rel=\"noreferrer\">https://kotlinlang.org/docs/reference/java-interop.html#sam-conversions</a><br>\n  Also note that this feature works only for Java interop; since Kotlin\n  has proper function types, automatic conversion of functions into\n  implementations of Kotlin interfaces is unnecessary and therefore\n  unsupported.</p>\n</blockquote>\n\n<p>Select the best solution for your use case.</p>\n\n<h2>Kotlin Function Type</h2>\n\n<blockquote>\n  <ul>\n  <li>Kotlin API: Perfect</li>\n  <li>Kotlin Access: Perfect</li>\n  <li>Java Access: \n  \n  <ul>\n  <li>Auto generated parameter type like Function1 (not a big problem for Java 8 lambda)</li>\n  <li>Verbose <code>return Unit.INSTANCE;</code> instead of void return.</li>\n  </ul></li>\n  </ul>\n</blockquote>\n\n<pre><code>class KotlinApi {\n    fun demo(listener: (response: String) -&gt; Unit) {\n       listener(\"response\")\n    }\n}\n\nfun kotlinConsumer() {\n    KotlinApi().demo { response-&gt;\n        println(response)\n    }\n}\n\npublic static void javaConsumer() {\n    new KotlinApi().demo(response -&gt; {\n        System.out.println(response);\n        return Unit.INSTANCE;\n    });\n}\n</code></pre>\n\n<h2>Kotlin Interface</h2>\n\n<blockquote>\n  <ul>\n  <li>Kotlin API: Additional interface definition.</li>\n  <li>Kotlin Access: Too verbose</li>\n  <li>Java Access: Perfect</li>\n  </ul>\n</blockquote>\n\n<pre><code>class KotlinApi {\n    interface Listener {\n        fun onResponse(response: String)\n    }\n\n    fun demo(listener: Listener) {\n       listener.onResponse(\"response\")\n    }\n}\n\nfun kotlinConsumer() {\n    KotlinApi().demo(object : KotlinApi.Listener {\n        override fun onResponse(response: String) {\n            println(response)\n        }\n    })\n}\n\npublic static void javaConsumer() {\n    new KotlinApi().demo(response -&gt; {\n        System.out.println(response);\n    });\n}\n</code></pre>\n\n<h2>Java Interface</h2>\n\n<blockquote>\n  <ul>\n  <li>Kotlin API: Mixed Java code.</li>\n  <li>Kotlin Access: A little verbose</li>\n  <li>Java Access: Perfect</li>\n  </ul>\n</blockquote>\n\n<pre><code>class KotlinApi {\n    fun demo(listener: Listener) {\n        listener.onResponse(\"response\")\n    }\n}\n\npublic interface Listener {\n    void onResponse(String response);\n}\n\nfun kotlinConsumer() {\n    KotlinApi().demo { response -&gt;\n        println(response)\n    }\n}\n\npublic static void javaConsumer() {\n    new KotlinApi().demo(response -&gt; {\n        System.out.println(response);\n    });\n}\n</code></pre>\n\n<h2>Multiple Methods</h2>\n\n<blockquote>\n  <ul>\n  <li>Kotlin API: Multiple method implementations</li>\n  <li>Kotlin Access: Perfect if correct method is used. Auto completion suggests verbose method also.</li>\n  <li>Java Access: Perfect. Auto completion does not suggest function type method because of <code>JvmSynthetic</code> annotation</li>\n  </ul>\n</blockquote>\n\n<pre><code>class KotlinApi {\n    interface Listener {\n        fun onResponse(response: String)\n    }\n\n    fun demo(listener: Listener) {\n        demo { response -&gt;\n            listener.onResponse(response)\n        }\n    }\n\n    @JvmSynthetic //Prevents JVM to use this method\n    fun demo(listener: (String) -&gt; Unit) {\n        listener(\"response\")\n    }\n}\n\nfun kotlinConsumer() {\n    KotlinApi().demo { response -&gt;\n        println(response)\n    }\n}\n\npublic static void javaConsumer() {\n    new KotlinApi().demo(response -&gt; {\n        System.out.println(response);\n    });\n}\n</code></pre>\n\n<h2>Java API</h2>\n\n<blockquote>\n  <ul>\n  <li>Kotlin API: There is no Kotlin API, all API code is Java</li>\n  <li>Kotlin access: Perfect</li>\n  <li>Java access: Perfect</li>\n  </ul>\n</blockquote>\n\n<pre><code>public class JavaApi {\n    public void demo(Listener listener) {\n        listener.onResponse(\"response\");\n    }\n\n    public interface Listener {\n        void onResponse(String response);\n    }\n\n}\n\nfun kotlinConsumer() {\n    JavaApi().demo { response -&gt;\n        println(response)\n    }\n}\n\npublic static void javaConsumer() {\n    new JavaApi().demo(response -&gt; {\n        System.out.println(response);\n    });\n}\n</code></pre>\n"}], "owner": {"reputation": 1325, "user_id": 4978624, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/854707784602530/picture?type=large", "display_name": "Viktor Sinelnikov", "link": "https://stackoverflow.com/users/4978624/viktor-sinelnikov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21599, "favorite_count": 8, "accepted_answer_id": 43470351, "answer_count": 5, "score": 69, "last_activity_date": 1599534746, "creation_date": 1492510039, "last_edit_date": 1595801576, "question_id": 43469241, "link": "https://stackoverflow.com/questions/43469241/passing-lambda-instead-of-interface", "title": "Passing lambda instead of interface", "body": "<p>I have created an interface:</p>\n<pre><code>interface ProgressListener {\n    fun transferred(bytesUploaded: Long)\n}\n</code></pre>\n<p>but can use it only as an anonymous class, not lambda</p>\n<pre><code>dataManager.createAndSubmitSendIt(title, message,\nobject : ProgressListener {\n    override fun transferred(bytesUploaded: Long) {\n        System.out.println(bytesUploaded.toString())\n    }\n})\n</code></pre>\n<p>I think it should be a possibility to replace it by lambda:</p>\n<pre><code>dataManager.createAndSubmitSendIt(title, message, {System.out.println(it.toString())})\n</code></pre>\n<p>But I am getting error: <code>Type mismatch; required - ProgressListener, found - () -&gt; Unit?</code></p>\n<p>What am I doing wrong?</p>\n"}, {"tags": ["kotlin", "dsl"], "answers": [{"tags": [], "owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "is_accepted": true, "score": 11, "last_activity_date": 1492513145, "last_edit_date": 1492513145, "creation_date": 1492512326, "answer_id": 43470027, "question_id": 43468253, "link": "https://stackoverflow.com/questions/43468253/kotlin-type-safe-builder-dsls-safety-for-the-outermost-function/43470027#43470027", "title": "Kotlin type safe builder DSLs, safety for the outermost function", "body": "<p>Probably this can somehow be done in a more elegant way, but I can suggest using the <code>@Deprecated</code> annotation with <code>DeprecationLevel.ERROR</code> on a function with a matching signature defined for the receiver type, for example:</p>\n\n<pre><code>@Deprecated(\"Cannot be used in a html block.\", level = DeprecationLevel.ERROR)\nfun HtmlReceiver.html(action: HtmlReceiver.() -&gt; Unit): Nothing = error(\"...\")\n</code></pre>\n\n<p><sup>Or this can be a member function. By the way, the IDE completion behaves a bit differently based on whether it is an extension or a member.</sup></p>\n\n<p>This will make the calls like the inner one invalid:</p>\n\n<pre><code>html {\n    html { // Error: Cannot be used in a html block.\n    }\n}\n</code></pre>\n\n<p><a href=\"https://try.kotlinlang.org/#/UserProjects/i9cit5g2flf1fm6978nv0eje8t/3n941hdiugdugrtvntt0lg7glc\" rel=\"noreferrer\">(demo of this code)</a></p>\n\n<p>The top-level function can still be called inside a DSL block by its FQN e.g. <code>com.example.html { }</code>, so this trick only protects the users from calling the top level function by mistake.</p>\n"}], "owner": {"reputation": 68863, "user_id": 4465208, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/w14F6.png?s=128&g=1", "display_name": "zsmb13", "link": "https://stackoverflow.com/users/4465208/zsmb13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 1, "accepted_answer_id": 43470027, "answer_count": 1, "score": 10, "last_activity_date": 1492513145, "creation_date": 1492507177, "question_id": 43468253, "link": "https://stackoverflow.com/questions/43468253/kotlin-type-safe-builder-dsls-safety-for-the-outermost-function", "title": "Kotlin type safe builder DSLs, safety for the outermost function", "body": "<p>I'm going to use the <a href=\"https://kotlinlang.org/docs/reference/type-safe-builders.html#full-definition-of-the-comexamplehtml-package\" rel=\"noreferrer\">official example</a> from the documentation that implements a DSL for some HTML creation.</p>\n\n<p>Since Kotlin 1.1, the <code>@DslMarker</code> annotation allows us to restrict the scope of the functions in our classes, like the example does with the <code>@HtmlTagMarker</code> annotation. This gives us an error when trying to write incorrectly structured code like this:</p>\n\n<pre><code>html {\n    body { \n        body { // this in an error, as it's a function call on the outside Html element\n        }\n    }\n}\n</code></pre>\n\n<p>However, this doesn't prevent nesting the outermost function, which is the entry point to the DSL. For example, with the example as it is now, this can be written down without problems:</p>\n\n<pre><code>html {\n    html {\n    }\n}\n</code></pre>\n\n<p>Is there any way to make a DSL safer in this regard?</p>\n"}, {"tags": ["android-studio", "kotlin", "live-templates"], "answers": [{"tags": [], "owner": {"reputation": 1933, "user_id": 2279862, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/3YRDE.jpg?s=128&g=1", "display_name": "zoltish", "link": "https://stackoverflow.com/users/2279862/zoltish"}, "is_accepted": false, "score": 4, "last_activity_date": 1492500263, "creation_date": 1492500263, "answer_id": 43466094, "question_id": 43465976, "link": "https://stackoverflow.com/questions/43465976/how-can-i-name-a-variable-automatically-by-its-type-in-a-live-template/43466094#43466094", "title": "How can I name a variable automatically by its type in a live template?", "body": "<p><strong>Figured it out! Posting a screenshot as I think that explains it the best.</strong> </p>\n\n<p><a href=\"https://i.stack.imgur.com/74UkQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/74UkQ.png\" alt=\"Live template variables\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 372, "user_id": 5656782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9c4e66217c555e8d76e68b29d962c9?s=128&d=identicon&r=PG&f=1", "display_name": "Nate Good", "link": "https://stackoverflow.com/users/5656782/nate-good"}, "is_accepted": false, "score": 0, "last_activity_date": 1509649714, "creation_date": 1509649714, "answer_id": 47082907, "question_id": 43465976, "link": "https://stackoverflow.com/questions/43465976/how-can-i-name-a-variable-automatically-by-its-type-in-a-live-template/47082907#47082907", "title": "How can I name a variable automatically by its type in a live template?", "body": "<p>I have a slight variation on this that uses smart completion.  The key thing that evaded me at first was making sure you re-order the variables so the TYPE is before the VAR.  Otherwise the type will be empty.\n<a href=\"https://i.stack.imgur.com/dneQm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dneQm.png\" alt=\"Spring Live Template Variables\"></a></p>\n"}], "owner": {"reputation": 1933, "user_id": 2279862, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/3YRDE.jpg?s=128&g=1", "display_name": "zoltish", "link": "https://stackoverflow.com/users/2279862/zoltish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1509649714, "creation_date": 1492499910, "question_id": 43465976, "link": "https://stackoverflow.com/questions/43465976/how-can-i-name-a-variable-automatically-by-its-type-in-a-live-template", "title": "How can I name a variable automatically by its type in a live template?", "body": "<p>Using dagger, Im injecting fields a lot - so I created a live template for declaring an injected variable:</p>\n\n<pre><code>@Inject\nlateinit var $var$: $TYPE$\n</code></pre>\n\n<p>In Java, a similar live template would automatically fill in <strong>repository</strong> as I specified the type to be <code>Repository</code>.</p>\n\n<p>In Kotlin, however - it does not. But Im sure its possible?</p>\n"}, {"tags": ["android", "kotlin", "getter-setter", "getter"], "comments": [{"owner": {"reputation": 68863, "user_id": 4465208, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/w14F6.png?s=128&g=1", "display_name": "zsmb13", "link": "https://stackoverflow.com/users/4465208/zsmb13"}, "edited": false, "score": 0, "creation_date": 1492497646, "post_id": 43465032, "comment_id": 73985889, "body": "To clarify, are you doing things this way because you want to keep the features that <code>data class</code> provides (toString, equals, copy, etc.), but also add custom setter logic?"}, {"owner": {"reputation": 249, "user_id": 7220319, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-68nKgfYqfiE/AAAAAAAAAAI/AAAAAAAAAAk/MQI3o5AfhQs/photo.jpg?sz=128", "display_name": "Ankur Khandelwal", "link": "https://stackoverflow.com/users/7220319/ankur-khandelwal"}, "reply_to_user": {"reputation": 68863, "user_id": 4465208, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/w14F6.png?s=128&g=1", "display_name": "zsmb13", "link": "https://stackoverflow.com/users/4465208/zsmb13"}, "edited": false, "score": 0, "creation_date": 1492497941, "post_id": 43465032, "comment_id": 73986033, "body": "yes. I want to use data class for getter and setter also.  @zsmb13"}, {"owner": {"reputation": 249, "user_id": 7220319, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-68nKgfYqfiE/AAAAAAAAAAI/AAAAAAAAAAk/MQI3o5AfhQs/photo.jpg?sz=128", "display_name": "Ankur Khandelwal", "link": "https://stackoverflow.com/users/7220319/ankur-khandelwal"}, "reply_to_user": {"reputation": 68863, "user_id": 4465208, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/w14F6.png?s=128&g=1", "display_name": "zsmb13", "link": "https://stackoverflow.com/users/4465208/zsmb13"}, "edited": false, "score": 0, "creation_date": 1492500382, "post_id": 43465032, "comment_id": 73987344, "body": "@zsmb13 I have update my question."}], "answers": [{"tags": [], "owner": {"reputation": 20461, "user_id": 1452094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a12b28824b215e4886da2e9f376369f?s=128&d=identicon&r=PG", "display_name": "Kiskae", "link": "https://stackoverflow.com/users/1452094/kiskae"}, "is_accepted": false, "score": 1, "last_activity_date": 1492502242, "creation_date": 1492502242, "answer_id": 43466701, "question_id": 43465032, "link": "https://stackoverflow.com/questions/43465032/getting-error-while-dealing-with-getter-and-setter-in-kotlin/43466701#43466701", "title": "Getting error while dealing with getter and setter in kotlin", "body": "<p>It is important to remember that referring to <code>chatManger</code> ANYWHERE in the code ends up calling <code>getChatManger()</code> or <code>setChatManger()</code>, including inside of the getter or setter itself. This means your code will end up in an infinite loop and cause a <code>StackOverflowError</code>.</p>\n\n<p>Read up on <a href=\"https://kotlinlang.org/docs/reference/properties.html\" rel=\"nofollow noreferrer\">Properties</a>, specifically the section about getters/setters as well as the \"backing field\".</p>\n"}, {"comments": [{"owner": {"reputation": 4869, "user_id": 6151924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d32a9252d2034b93b3eb8f743512104?s=128&d=identicon&r=PG&f=1", "display_name": "RobCo", "link": "https://stackoverflow.com/users/6151924/robco"}, "reply_to_user": {"reputation": 249, "user_id": 7220319, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-68nKgfYqfiE/AAAAAAAAAAI/AAAAAAAAAAk/MQI3o5AfhQs/photo.jpg?sz=128", "display_name": "Ankur Khandelwal", "link": "https://stackoverflow.com/users/7220319/ankur-khandelwal"}, "edited": false, "score": 0, "creation_date": 1492507001, "post_id": 43467076, "comment_id": 73991336, "body": "@AnkurKhandelwal &quot;If I assigned it to null then I am getting null not the set value.&quot; This is because you create a new instance every time, so the next instance will not have the field set. Try: <code>val chatModel = chatModel(mApplicationContext); chatModel.chatManger=chatManage; val chatManager = chatModel.chatManager;</code>. This is about basic instance management and not about custom getters / setters. But please also not my last paragraph: You <b>don&#39;t need</b> custom getters setters if all they do is set a field."}, {"owner": {"reputation": 249, "user_id": 7220319, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-68nKgfYqfiE/AAAAAAAAAAI/AAAAAAAAAAk/MQI3o5AfhQs/photo.jpg?sz=128", "display_name": "Ankur Khandelwal", "link": "https://stackoverflow.com/users/7220319/ankur-khandelwal"}, "edited": false, "score": 0, "creation_date": 1492507557, "post_id": 43467076, "comment_id": 73991694, "body": "then how will I access the set value in the another activity. In the another activity, I have to create the new instance of the chatModel data class. That re-initialize the value to null"}, {"owner": {"reputation": 4869, "user_id": 6151924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d32a9252d2034b93b3eb8f743512104?s=128&d=identicon&r=PG&f=1", "display_name": "RobCo", "link": "https://stackoverflow.com/users/6151924/robco"}, "reply_to_user": {"reputation": 249, "user_id": 7220319, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-68nKgfYqfiE/AAAAAAAAAAI/AAAAAAAAAAk/MQI3o5AfhQs/photo.jpg?sz=128", "display_name": "Ankur Khandelwal", "link": "https://stackoverflow.com/users/7220319/ankur-khandelwal"}, "edited": false, "score": 0, "creation_date": 1492509626, "post_id": 43467076, "comment_id": 73993070, "body": "@AnkurKhandelwal This is a different question again: &quot;How to persist objects through activities&quot;. You&#39;ll probably want a singleton. Kotlin makes this easy with the <a href=\"https://kotlinlang.org/docs/reference/object-declarations.html#object-declarations\" rel=\"nofollow noreferrer\">object declaration</a>."}, {"owner": {"reputation": 249, "user_id": 7220319, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-68nKgfYqfiE/AAAAAAAAAAI/AAAAAAAAAAk/MQI3o5AfhQs/photo.jpg?sz=128", "display_name": "Ankur Khandelwal", "link": "https://stackoverflow.com/users/7220319/ankur-khandelwal"}, "edited": false, "score": 0, "creation_date": 1492510729, "post_id": 43467076, "comment_id": 73993858, "body": "hmm. I got this. thanks, @RobCo. I got confused with both of them. Thanks a lot. sorry man for troubling you."}], "tags": [], "owner": {"reputation": 4869, "user_id": 6151924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d32a9252d2034b93b3eb8f743512104?s=128&d=identicon&r=PG&f=1", "display_name": "RobCo", "link": "https://stackoverflow.com/users/6151924/robco"}, "is_accepted": true, "score": 3, "last_activity_date": 1492503464, "creation_date": 1492503464, "answer_id": 43467076, "question_id": 43465032, "link": "https://stackoverflow.com/questions/43465032/getting-error-while-dealing-with-getter-and-setter-in-kotlin/43467076#43467076", "title": "Getting error while dealing with getter and setter in kotlin", "body": "<p>You call the setter inside of the setter.. a.k.a. infinite loop:</p>\n\n<pre><code>    set(value) {\n        /* execute setter logic */\n        chatManger = value\n    }\n</code></pre>\n\n<p>Inside a property getter or setter there is an additional variable available: <code>field</code>. This represents the java <a href=\"https://kotlinlang.org/docs/reference/properties.html#backing-fields\" rel=\"nofollow noreferrer\">backing field</a> of that property. </p>\n\n<pre><code>    get() = field\n    set(value) {\n        field = value\n    }\n</code></pre>\n\n<p>With a regular var property, these getters and setters are auto-generated.\nSo, this is default behaviour and you don't have to override getter / setter if all you do is set the value to a field.  </p>\n"}], "owner": {"reputation": 249, "user_id": 7220319, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-68nKgfYqfiE/AAAAAAAAAAI/AAAAAAAAAAk/MQI3o5AfhQs/photo.jpg?sz=128", "display_name": "Ankur Khandelwal", "link": "https://stackoverflow.com/users/7220319/ankur-khandelwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1402, "favorite_count": 0, "accepted_answer_id": 43467076, "answer_count": 2, "score": 0, "last_activity_date": 1492506407, "creation_date": 1492496677, "last_edit_date": 1492506407, "question_id": 43465032, "link": "https://stackoverflow.com/questions/43465032/getting-error-while-dealing-with-getter-and-setter-in-kotlin", "title": "Getting error while dealing with getter and setter in kotlin", "body": "<p>I have define the data class as:</p>\n\n<pre><code>  data class chatModel(var context:Context?) {\n\n      var chatManger:ChatManager?=null\n            //getter\n        get() = chatManger\n            //setter\n        set(value) {\n            /* execute setter logic */\n            chatManger = value\n        }\n\n    }\n</code></pre>\n\n<p>Now how will i access the get() and set() function. \nIn java I do like that: \n//for getter</p>\n\n<pre><code>new chatModel().getJId()\n</code></pre>\n\n<p>//for setter</p>\n\n<pre><code>new chatModel().setJId(\"jid\")\n</code></pre>\n\n<p><strong>edit:</strong></p>\n\n<p>As the @yole suggested. I am using setter and getter as:</p>\n\n<p>//set the data</p>\n\n<pre><code>var chatDetails:chatModel=chatModel(mApplicationContext)\n chatDetails.chatManger=chatManager\n</code></pre>\n\n<p>But end up getting the  java.lang.StackOverflowError:                                                                               at </p>\n\n<pre><code>com.example.itstym.smackchat.Model.chatModel.setChatManger(chatModel.kt:38)\n</code></pre>\n\n<p>line 38 points to   </p>\n\n<pre><code>chatManger = value\n</code></pre>\n\n<p>this. </p>\n\n<p>@RobCo suggested.</p>\n\n<p>I have change the data class definition as:</p>\n\n<pre><code>data class chatModel(var context: Context?) {\n\n\n    var chatManger:ChatManager\n\n    get() = field\n    set(value) {\n        field=value\n    }\n}\n</code></pre>\n\n<p>//set the data.</p>\n\n<pre><code>    chatModel(mApplicationContext).chatManger=chatManager\n</code></pre>\n\n<p>//get the data in different activity</p>\n\n<pre><code>chatModel(applicationContext).chatManger\n</code></pre>\n\n<p>but getting error property must be initialized. If I assigned it to null then I am getting null not the set value. </p>\n"}, {"tags": ["intellij-idea", "kotlin"], "answers": [{"tags": [], "owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "is_accepted": true, "score": 3, "last_activity_date": 1492497867, "creation_date": 1492497867, "answer_id": 43465360, "question_id": 43460894, "link": "https://stackoverflow.com/questions/43460894/efficient-map-and-filter-combination-vs-stdlibs/43465360#43465360", "title": "Efficient map and filter combination vs stdlibs", "body": "<p>No, there is no optimization; the IntelliJ IDEA suggestion is intended to show you the more idiomatic way to perform a certain operation and does not always preserve the performance of the original code. Obviously you know what you're doing, so you should either ignore the suggestion of the inspection or suppress it.</p>\n"}], "owner": {"reputation": 501, "user_id": 2225734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/95003a1475abec21094e18156741e518?s=128&d=identicon&r=PG", "display_name": "Zach Melnick", "link": "https://stackoverflow.com/users/2225734/zach-melnick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 43465360, "answer_count": 1, "score": 1, "last_activity_date": 1492497867, "creation_date": 1492469616, "question_id": 43460894, "link": "https://stackoverflow.com/questions/43460894/efficient-map-and-filter-combination-vs-stdlibs", "title": "Efficient map and filter combination vs stdlibs", "body": "<p>I'm trying to write an efficient solution to a common map/filter paradigm. In Kotlin, you can write code that looks like this:</p>\n\n<pre><code>schedule.daysOfWeek.map { it.adjustInto(today) as LocalDate }\n        .filterTo(datesOnSchedule) { it.isBefore(endDate) }    \n</code></pre>\n\n<p>Generically, I'm applying a map, then filtering the mapped values based on a condition. However, an intermediate collection is created for this. This seems unnecessary. I wrote a little function that should do the same thing, but without the intermediate collection.</p>\n\n<pre><code>inline fun &lt;T, R&gt; Iterable&lt;T&gt;.mapThenFilter(predicate: (R) -&gt; Boolean, transform: (T) -&gt; R) {\n    mapThenFilter(ArrayList&lt;R&gt;(), predicate, transform)\n}\n\ninline fun &lt;T, R, C : MutableCollection&lt;in R&gt;&gt;\n    Iterable&lt;T&gt;.mapThenFilter(collection: C, predicate: (R) -&gt; Boolean, transform: (T) -&gt; R): C {\nfor (element in this) {\n    val mapped = transform(element)\n    if(predicate(mapped)) {\n        collection.add(mapped)\n    }\n   }\n return collection\n}                \n</code></pre>\n\n<p>However, IntelliJ is suggesting a stdlib replacement for my function that would make it look like:</p>\n\n<pre><code>    inline fun &lt;T, R, C : MutableCollection&lt;in R&gt;&gt; \nIterable&lt;T&gt;.mapThenFilter(collection: C, predicate: (R) -&gt; Boolean, transform: (T) -&gt; R): C {\n    this.map { transform(it) }\n        .filterTo(collection) { predicate(it) }\n    return collection\n}\n</code></pre>\n\n<p>Which turns my optimization straight back into the original code I wrote and re-introduces the inefficiency of creating multiple collections. Is there some optimization going on here that I am not aware of?</p>\n"}, {"tags": ["android", "kotlin"], "answers": [{"tags": [], "owner": {"reputation": 4489, "user_id": 4791032, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OeqJTPf-miM/AAAAAAAAAAI/AAAAAAAAACc/nqviDd0vRck/photo.jpg?sz=128", "display_name": "Bogdan Ustyak", "link": "https://stackoverflow.com/users/4791032/bogdan-ustyak"}, "is_accepted": true, "score": 2, "last_activity_date": 1492468842, "creation_date": 1492468842, "answer_id": 43460777, "question_id": 43460561, "link": "https://stackoverflow.com/questions/43460561/kotlin-cant-return-a-derived-type/43460777#43460777", "title": "Kotlin: Can&#39;t return a derived type", "body": "<p>Looks to be ok, try to match imports of Fragment in both classes. \nIt should be the same in all subclasses, For example <code>import android.app.Fragment</code> or <code>import android.support.v4.app.Fragment</code></p>\n"}], "owner": {"reputation": 573, "user_id": 6411538, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-GS6rh-AT3pc/AAAAAAAAAAI/AAAAAAAAABY/8ktg0X7KLrI/photo.jpg?sz=128", "display_name": "Nathan Horrigan", "link": "https://stackoverflow.com/users/6411538/nathan-horrigan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "accepted_answer_id": 43460777, "answer_count": 1, "score": 1, "last_activity_date": 1492468842, "creation_date": 1492467655, "question_id": 43460561, "link": "https://stackoverflow.com/questions/43460561/kotlin-cant-return-a-derived-type", "title": "Kotlin: Can&#39;t return a derived type", "body": "<p>I have the following kotlin function from an android project. I'm trying to return either a Movie or TvShow 'Fragment' that both derive from the base android 'Fragment' class. This code worked when it was java code but once converted to Kotlin - it no longer works. The error I'm getting is a type mismatch on the MovieFragment because it is type 'MoviesFragment' and not 'Fragment?'.</p>\n\n<hr/>\n\n<pre><code>override fun getItem(position: Int): Fragment? {\n        when (position) {\n            0 -&gt; {\n                val moviesFragment: MoviesFragment = MoviesFragment()\n                return moviesFragment\n            }\n            1 -&gt; {\n                val tvShowFragment: TvShowFragment = TvShowFragment()\n                return tvShowFragment\n            }\n            else -&gt; {\n                return null\n            }\n        }\n    }\n</code></pre>\n\n<p><hr />\nThanks in advance!!</p>\n"}, {"tags": ["collections", "kotlin"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 1, "creation_date": 1492460646, "post_id": 43458843, "comment_id": 73973966, "body": "Struggling to repro this: <a href=\"http://ideone.com/n8ydzW\" rel=\"nofollow noreferrer\">ideone.com/n8ydzW</a>.  Can you construct a <a href=\"http://stackoverflow.com/help/mcve\">minimal test-case</a>?"}, {"owner": {"reputation": 167, "user_id": 1279771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zVC7u.jpg?s=128&g=1", "display_name": "Nick Lowery", "link": "https://stackoverflow.com/users/1279771/nick-lowery"}, "reply_to_user": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1492461554, "post_id": 43458843, "comment_id": 73974461, "body": "I am strugging to come up with one. However, I have found a workaround. Using <code>foo.all { a -&gt; foo.any { b -&gt; a == b } }</code> is working as a substitute for <code>containsAll()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 1279771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zVC7u.jpg?s=128&g=1", "display_name": "Nick Lowery", "link": "https://stackoverflow.com/users/1279771/nick-lowery"}, "edited": false, "score": 0, "creation_date": 1492464964, "post_id": 43459804, "comment_id": 73976053, "body": "Thank you! This is the problem I am running into. It&#39;s still weird to have <code>foo.containsAll(foo)</code> return false, though."}, {"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "reply_to_user": {"reputation": 167, "user_id": 1279771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zVC7u.jpg?s=128&g=1", "display_name": "Nick Lowery", "link": "https://stackoverflow.com/users/1279771/nick-lowery"}, "edited": false, "score": 0, "creation_date": 1492467102, "post_id": 43459804, "comment_id": 73976858, "body": "Yes, that is simply how hashes work though and is why you simply shouldn&#39;t use mutable objects in a hash (note that mutable values in a map are fine just not keys)."}], "tags": [], "owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "is_accepted": true, "score": 2, "last_activity_date": 1492463953, "creation_date": 1492463953, "answer_id": 43459804, "question_id": 43458843, "link": "https://stackoverflow.com/questions/43458843/duplicate-items-in-set/43459804#43459804", "title": "Duplicate items in Set", "body": "<p>I believe the only way this is possible (short of reflection, etc.) is if your data class contains something mutable and an instance changing state after being added to the set, etc. e.g.</p>\n\n<pre><code>data class Foo(var int: Int = 0)\ndata class Bar(val string: String, val foo: Foo = Foo())\n\nval bars = mutableSetOf&lt;Bar&gt;()\nbars += Bar(\"\")\nbars += Bar(\"\")\n\nprintln(bars.containsAll(bars)) // true\n\nbars.first().foo.int = 12\n\nprintln(bars.containsAll(bars)) // false\n</code></pre>\n\n<p>This is because the result of <code>hashCode()</code> is being used in the set to identify it but if the state changes in an instance of your data class then it will likely have a different hash value causing issues like this.</p>\n\n<p>In general elements in sets and keys in maps should be immutable to avoid this issue.</p>\n"}], "owner": {"reputation": 167, "user_id": 1279771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zVC7u.jpg?s=128&g=1", "display_name": "Nick Lowery", "link": "https://stackoverflow.com/users/1279771/nick-lowery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1022, "favorite_count": 0, "accepted_answer_id": 43459804, "answer_count": 1, "score": 0, "last_activity_date": 1492463953, "creation_date": 1492459770, "question_id": 43458843, "link": "https://stackoverflow.com/questions/43458843/duplicate-items-in-set", "title": "Duplicate items in Set", "body": "<p>In Kotlin, I have a <code>MutableSet</code> of a data class. The data class does not override <code>equals()</code> or <code>hashCode()</code>. I've been encountering bugs involving duplicate objects in the set, and I noticed that calling <code>foo.containsAll(foo)</code> returns <code>false</code> for the set.</p>\n\n<p>I went through each item in the set and only a handful return <code>false</code> for <code>foo.contains(foo.toList()[i])</code>. For those that do, calling <code>foo.toList()[i] == foo.toList()[i]</code> returns <code>true</code>. So, equality checking works.</p>\n\n<p>What is going on here?</p>\n"}, {"tags": ["kotlin"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 4, "creation_date": 1492446408, "post_id": 43455305, "comment_id": 73966222, "body": "In all these cases, the method is not called via its name (<code>getValue()</code>, etc.); instead it&#39;s called via other syntax.  So presumably the intent is to make that clear by having the grammar enforce that these cases are prefixed with the <code>operator</code> keyword."}, {"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "edited": false, "score": 3, "creation_date": 1492447531, "post_id": 43455305, "comment_id": 73966785, "body": "Probably there could be a better keyword, something like <code>convention fun</code>, but there already was <code>operator fun</code>, and I doubt anyone needs two keywords instead of one. :)"}], "answers": [{"tags": [], "owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "is_accepted": true, "score": 6, "last_activity_date": 1492463429, "last_edit_date": 1492463429, "creation_date": 1492452012, "answer_id": 43456791, "question_id": 43455305, "link": "https://stackoverflow.com/questions/43455305/why-kotlin-use-operator-modifier-outside-of-operator-overloading/43456791#43456791", "title": "Why Kotlin use operator modifier outside of operator overloading?", "body": "<p>I presume in Kotlin <code>operator</code> means \"accessed by a name convention\", which is true for operators (<code>plus()</code>, <code>minusAssign()</code>, etc), component accessors (<code>component1()</code>, etc), for-loop accessors (<code>iterator</code>, <code>next</code>, <code>hasNext</code>) and delegate accessors (<code>getValue</code>, etc)</p>\n"}], "owner": {"reputation": 2732, "user_id": 3009822, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/HslzA.jpg?s=128&g=1", "display_name": "Yudhistira Arya", "link": "https://stackoverflow.com/users/3009822/yudhistira-arya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 563, "favorite_count": 1, "accepted_answer_id": 43456791, "answer_count": 1, "score": 2, "last_activity_date": 1492463429, "creation_date": 1492446226, "last_edit_date": 1492446491, "question_id": 43455305, "link": "https://stackoverflow.com/questions/43455305/why-kotlin-use-operator-modifier-outside-of-operator-overloading", "title": "Why Kotlin use operator modifier outside of operator overloading?", "body": "<p>I'm a bit confused on the usage of <code>operator</code> modifier in Kotlin. For example, Kotlin use <code>operator</code> modifier during destructuring declaration and properties delegation which, IMHO (pardon my ignorance), a bit confusing since both scenarios are outside of operator overloading.</p>\n\n<p>Destructuring: </p>\n\n<pre><code>operator fun &lt;K, V&gt; Map&lt;K, V&gt;.iterator(): Iterator&lt;Map.Entry&lt;K, V&gt;&gt; = entrySet().iterator()\noperator fun &lt;K, V&gt; Map.Entry&lt;K, V&gt;.component1() = getKey()\noperator fun &lt;K, V&gt; Map.Entry&lt;K, V&gt;.component2() = getValue()\n\nfor ((key, value) in map) {\n    // ...\n}\n</code></pre>\n\n<p>Properties delegation: </p>\n\n<pre><code>interface ReadOnlyProperty&lt;in R, out T&gt; {\n    operator fun getValue(thisRef: R, property: KProperty&lt;*&gt;): T\n}\n\ninterface ReadWriteProperty&lt;in R, T&gt; {\n    operator fun getValue(thisRef: R, property: KProperty&lt;*&gt;): T\n    operator fun setValue(thisRef: R, property: KProperty&lt;*&gt;, value: T)\n}\n</code></pre>\n"}, {"tags": ["android", "kotlin"], "comments": [{"owner": {"reputation": 37094, "user_id": 543539, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/cCXi8.jpg?s=128&g=1", "display_name": "Egor", "link": "https://stackoverflow.com/users/543539/egor"}, "edited": false, "score": 0, "creation_date": 1492445785, "post_id": 43455105, "comment_id": 73965873, "body": "Are you missing <code>&lt;&gt;</code> in <code>new ProgramParser&lt;&gt;()</code>?"}, {"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "edited": false, "score": 0, "creation_date": 1492446023, "post_id": 43455105, "comment_id": 73965990, "body": "Might you happen to have any other <code>ProgramParser</code> in the namespace?"}, {"owner": {"reputation": 2699, "user_id": 1965124, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/60bf4c6347b1ceb2192aa27fa11c6ead?s=128&d=identicon&r=PG", "display_name": "FriendlyMikhail", "link": "https://stackoverflow.com/users/1965124/friendlymikhail"}, "reply_to_user": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "edited": false, "score": 1, "creation_date": 1492447186, "post_id": 43455105, "comment_id": 73966630, "body": "@hotkey only 1 ProgramParser Egor: I did not want it to be generic, the ProgramParser is the non generic implementation"}, {"owner": {"reputation": 2597, "user_id": 1306903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fde10bcf0813b2162545477be4e7470b?s=128&d=identicon&r=PG", "display_name": "Takhion", "link": "https://stackoverflow.com/users/1306903/takhion"}, "edited": false, "score": 2, "creation_date": 1492448770, "post_id": 43455105, "comment_id": 73967431, "body": "It works for me, what Kotlin version are you on? Are you sure your imports are OK?"}, {"owner": {"reputation": 7287, "user_id": 258848, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/2Ckug.jpg?s=128&g=1", "display_name": "dimsuz", "link": "https://stackoverflow.com/users/258848/dimsuz"}, "edited": false, "score": 1, "creation_date": 1492451647, "post_id": 43455105, "comment_id": 73969029, "body": "So you extend it in kotlin and use it later in java? (because <code>Parser&lt;ProgramQuery.Data, Program&gt; parser = new ProgramParser();</code> is not a valid kotlin code."}], "owner": {"reputation": 2699, "user_id": 1965124, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/60bf4c6347b1ceb2192aa27fa11c6ead?s=128&d=identicon&r=PG", "display_name": "FriendlyMikhail", "link": "https://stackoverflow.com/users/1965124/friendlymikhail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 265, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492445387, "creation_date": 1492445387, "question_id": 43455105, "link": "https://stackoverflow.com/questions/43455105/extend-java-paramterized-interface-from-kotlin", "title": "Extend Java Paramterized Interface from Kotlin", "body": "<p>I have an interface \n<code>\npublic interface Parser&lt;Raw, Parsed&gt; extends Func1&lt;Raw, Parsed&gt;\n</code></p>\n\n<p>Which I implement from a kotlin class:</p>\n\n<p><code>class ProgramParser : Parser&lt;ProgramQuery.Data, Program&gt;</code></p>\n\n<p>when I then try to write <code>Parser&lt;ProgramQuery.Data, Program&gt; parser = new ProgramParser();</code></p>\n\n<p>I get an error <code>Error:(60, 53) error: incompatible types: ProgramParser cannot be converted to Parser&lt;Data,Program&gt;</code></p>\n\n<p>Is there a different way for me to make an implementation of a java interface in Kotlin?</p>\n"}, {"tags": ["generics", "kotlin"], "comments": [{"owner": {"reputation": 89682, "user_id": 675383, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e7a971eb341ffeaa3efca407239bf3b?s=128&d=identicon&r=PG", "display_name": "nhaarman", "link": "https://stackoverflow.com/users/675383/nhaarman"}, "edited": false, "score": 0, "creation_date": 1492441784, "post_id": 43453771, "comment_id": 73963612, "body": "Please include the code in the question itself."}], "answers": [{"tags": [], "owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "is_accepted": true, "score": 8, "last_activity_date": 1492454729, "last_edit_date": 1495542753, "creation_date": 1492443309, "answer_id": 43454554, "question_id": 43453771, "link": "https://stackoverflow.com/questions/43453771/kotlin-generics-super-child-classes/43454554#43454554", "title": "Kotlin generics super/child classes", "body": "<p>It's <a href=\"https://kotlinlang.org/docs/reference/generics.html#variance\" rel=\"noreferrer\">generics variance</a> that prevents your code from working. <code>SuperClass</code> is defined as</p>\n\n<pre><code>open class SuperClass&lt;T&gt; where T: SuperType { ... }\n</code></pre>\n\n<p>And its type parameter <code>T</code> is declared as invariant (it has no <code>out</code> or <code>in</code> modifiers). Therefore the subtyping relations are as follows:</p>\n\n<ul>\n<li><code>DerivedClass&lt;ChildType&gt;</code> is <strong>not</strong> a subtype of <code>SuperClass&lt;SuperType&gt;</code></li>\n<li><code>SuperClass&lt;ChildType&gt;</code> is <strong>not</strong> a subtype of <code>SuperClass&lt;SuperType&gt;</code></li>\n<li><code>DerivedClass&lt;SuperType&gt;</code> <strong>is</strong> a subtype of <code>SuperClass&lt;SuperType&gt;</code>.</li>\n</ul>\n\n<p>Since the function argument should belong to a subtype of the parameter type, and <code>ChildClass</code> is actually <code>DerivedClass&lt;ChildType&gt;</code>, you cannot pass <code>ChildClass</code> as a <code>SuperClass&lt;SuperType&gt;</code>.</p>\n\n<p>You can solve this problem by adding the <a href=\"https://kotlinlang.org/docs/reference/generics.html#use-site-variance-type-projections\" rel=\"noreferrer\"><code>out</code> projection</a> to the parameter type of <code>testType</code>:</p>\n\n<pre><code>fun testType(superClass: SuperClass&lt;out SuperType&gt;)\n</code></pre>\n\n<p>This will basically mean that this function accepts <code>SuperClass&lt;T&gt;</code> where <code>T</code> is a subtype of <code>SuperType</code>. Of course, it adds certain limitations on the <code>superClass</code> usage: as <code>T</code> can be absolutely any subtype of <code>SuperType</code>, it is not type-safe to pass anything to functions that expect <code>T</code> as an argument, and this is prohibited.</p>\n\n<p>Also, see another answer that explains the reason for the invariant generics behavior: <a href=\"https://stackoverflow.com/questions/35431249/kotlin-override-generic-property-within-subtype\">(link)</a></p>\n"}], "owner": {"reputation": 473, "user_id": 1800255, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/M1Jsq.jpg?s=128&g=1", "display_name": "TGIO", "link": "https://stackoverflow.com/users/1800255/tgio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3111, "favorite_count": 0, "accepted_answer_id": 43454554, "answer_count": 1, "score": 3, "last_activity_date": 1492454729, "creation_date": 1492440601, "last_edit_date": 1492443811, "question_id": 43453771, "link": "https://stackoverflow.com/questions/43453771/kotlin-generics-super-child-classes", "title": "Kotlin generics super/child classes", "body": "<p>Trying to use generic types classes but got following problem, which is: </p>\n\n<blockquote>\n  <p>Type mismatch: inferred type is <code>ChildClass</code> but <code>SuperClass&lt;SuperType&gt;</code> was expected</p>\n</blockquote>\n\n<pre><code>open class SuperClass&lt;T&gt; where T: SuperType {\n    fun modifySomething(input: T): T {\n        input.someValue.inc()\n        return input\n    }\n}\n\nopen class SuperType {\n    val someValue: Int = 0\n}\n\nclass ChildClass : SuperClass&lt;ChildType&gt;() \n\nclass ChildType: SuperType() {\n    fun getModifiedValue(): Int {\n        return someValue\n    }\n}\n\nclass TestEnvironment {\n    fun testType(superClass: SuperClass&lt;SuperType&gt;) { \n        // do something with superClass\n    }\n\n    fun itDoesntWork() {\n        testType(ChildClass()) // compilation error\n    }\n}\n</code></pre>\n\n<p>Here is <a href=\"https://gist.github.com/TGIO/53482514ccba395646ba4deda7df6452\" rel=\"nofollow noreferrer\">the gist</a> and <a href=\"http://try.kotlinlang.org/#/UserProjects/45k09ue3l8ccr530tgtj8an59/9t1q74hrftmgm2jivua9omd15i\" rel=\"nofollow noreferrer\">the kotlin playground</a></p>\n\n<p><strong>Desired result is that function</strong> <code>testType(superClass: SuperClass&lt;SuperType&gt;)</code> <strong>should accept class</strong> <code>ChildClass()</code> <strong>without using <code>*</code> wildcard</strong></p>\n"}, {"tags": ["generics", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 374, "user_id": 1622788, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/PIqdt.jpg?s=128&g=1", "display_name": "David Whitman", "link": "https://stackoverflow.com/users/1622788/david-whitman"}, "edited": false, "score": 0, "creation_date": 1492436006, "post_id": 43452319, "comment_id": 73960327, "body": "I haven&#39;t seen recursive generics before, but that&#39;s absolutely badshit. What&#39;s more, it compiles. I need to fix some other code before I can run the whole thing, but it seems good. Minor detail; you also need to cast <code>(request as RequestImpl&lt;T&gt;)</code> now, which is a little ugly but is safe.  I&#39;ll mark this as answered as soon as I fix my stuff and confirm it&#39;s working."}, {"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "reply_to_user": {"reputation": 374, "user_id": 1622788, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/PIqdt.jpg?s=128&g=1", "display_name": "David Whitman", "link": "https://stackoverflow.com/users/1622788/david-whitman"}, "edited": false, "score": 0, "creation_date": 1492436998, "post_id": 43452319, "comment_id": 73960873, "body": "@DavidWhitman, yep, <code>request as RequestImpl&lt;T&gt;</code> is a known pain in the neck when using recursive generics. You can shorten it a bit without losing type safety: <code>request as RequestImpl</code> (<code>&lt;T&gt;</code> is not checked at runtime anyway, and if it matches at compile-time then it&#39;s still safe)"}, {"owner": {"reputation": 374, "user_id": 1622788, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/PIqdt.jpg?s=128&g=1", "display_name": "David Whitman", "link": "https://stackoverflow.com/users/1622788/david-whitman"}, "edited": false, "score": 0, "creation_date": 1492438533, "post_id": 43452319, "comment_id": 73961707, "body": "Stellar answer, code is working perfectly. Kotlin is a beautiful language, especially when set against Java; thank you so much for your work on it.  There was one remaining bit of weirdness that I have a workaround for but others may want to be aware of. I created a wrapper for <code>ApiClient</code> with the signature <code>class ApiClientWrapper&lt;out C : ApiClient&lt;R&gt;, R : Request&lt;R, *&gt;&gt;</code>. It wraps the <code>rxecute</code> call using <code>fun &lt;T&gt; rxecute(request: R): Single&lt;T&gt;</code>, <i>but</i> you need to do an unsafe cast to map your results to <code>T</code> ( <code>.map { it as T }</code> ) because <code>request: R</code> has a type param of <code>Any?</code>."}], "tags": [], "owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "is_accepted": true, "score": 3, "last_activity_date": 1492445571, "last_edit_date": 1492445571, "creation_date": 1492435172, "answer_id": 43452319, "question_id": 43451840, "link": "https://stackoverflow.com/questions/43451840/mixing-class-and-function-generics-in-kotlin/43452319#43452319", "title": "Mixing class and function generics in Kotlin?", "body": "<p>Unfortunately, Kotlin generics cannot be manipulated in that way; a type parameter <code>R</code> cannot be used as a generic type itself (<code>R&lt;T&gt;</code>), and its upper bound is fixed at the declaration site, and you can only use a type parameter <code>R</code> as a single upper bound (no way to add another one, <code>where Q : R, Q : Request&lt;T&gt;</code> doesn't work). </p>\n\n<p>You can only parameterize concrete types, and one option that comes to my mind is <a href=\"https://www.sitepoint.com/self-types-with-javas-generics/\" rel=\"nofollow noreferrer\">recursive generics</a> pattern (it is also used with Java). You can add another type parameter for the implementation type to <code>Request</code>, so that it becomes <code>interface Request&lt;R, T&gt;</code>. This requires you to add the types of the implementations to the inherited type declarations:</p>\n\n<pre><code>class RequestImpl&lt;T&gt;: Request&lt;RequestImpl&lt;*&gt;, T&gt; { /* impl */ }\n</code></pre>\n\n<p>Then modify <code>ApiClient</code>:</p>\n\n<pre><code>interface ApiClient&lt;R : Request&lt;R, *&gt;&gt; {\n    fun &lt;T&gt; rxecute(request: Request&lt;R, T&gt;): Single&lt;T&gt;\n}\n</code></pre>\n\n<p><sup>An unwelcome side-effect that arises here is that you need to cast the <code>request</code> to use it as a <code>RequestImpl</code>: <code>request as RequestImpl</code>.</sup></p>\n\n<p>And transform <code>ApiClientImpl</code> as follows:</p>\n\n<pre><code>class ApiClientImpl : ApiClient&lt;RequestImpl&lt;*&gt;&gt; {\n    override fun &lt;T&gt; rxecute(request: Request&lt;RequestImpl&lt;*&gt;, T&gt;): Single&lt;T&gt; = TODO()\n}\n</code></pre>\n\n<p>This solution looks much more verbose than what you asked for, but recursive generics seem to be a common workaround for such cases, which require a stronger type system than what Java and Kotlin can offer.</p>\n\n<hr>\n\n<p><a href=\"https://try.kotlinlang.org/#/UserProjects/t49qq9agrvr2gi9v1ari6apd6n/p0i2hflpn6ngn9hifklvlrdhtb\" rel=\"nofollow noreferrer\"><sup>(runnable demo of the code in the answer)</sup></a></p>\n"}], "owner": {"reputation": 374, "user_id": 1622788, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/PIqdt.jpg?s=128&g=1", "display_name": "David Whitman", "link": "https://stackoverflow.com/users/1622788/david-whitman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "accepted_answer_id": 43452319, "answer_count": 1, "score": 2, "last_activity_date": 1492445571, "creation_date": 1492433333, "question_id": 43451840, "link": "https://stackoverflow.com/questions/43451840/mixing-class-and-function-generics-in-kotlin", "title": "Mixing class and function generics in Kotlin?", "body": "<p>I'm trying to create an interface that defines a single method. The type of the argument for that method must be a type parameter of the interface, because implementations of the interface will have unique implementations for this parameter. Fine so far, but the catch is that the parameter also has a type argument that is tied to the method. Can I have a parameter of a type defined as a class type argument, which also has its own type argument that's tied to the method?</p>\n\n<p>Put another way:</p>\n\n<p>I am trying to build an api client interface with two implementations. Each client makes api calls based on <code>Request&lt;T&gt;</code> objects that are passed into their <code>rxecute</code> functions (RxJava + execute, and yes, I am unduly proud of the name).</p>\n\n<p>My issue is with how to define the <code>rxecute</code> method in the interface. Let me lay out some sample code (my actual code isn't using <code>impl</code>, don't worry).</p>\n\n<pre><code>interface Request&lt;T&gt; // T is return type of the request\n\nclass RequestImpl&lt;T&gt;: Request&lt;T&gt; { // impl }\n\ninterface ApiClient&lt;R : Request&lt;*&gt;&gt; {\n  // R should somehow be of type Request&lt;T&gt;\n  fun &lt;T&gt; rxecute(request: R): Single&lt;T&gt;\n}\n\nclass ApiClientImpl : ApiClient&lt;RequestImpl&lt;????&gt;&gt; {\n  override fun &lt;T&gt; rxecute(request: RequestImpl&lt;T&gt;): Single&lt;T&gt; = // impl\n}\n</code></pre>\n\n<p>I would like to be able to use it like this:</p>\n\n<pre><code>val apiClient = ApiClientImpl()\napiClient.rxecute(RequestImpl&lt;SomeClass&gt;()).subscribe(someClassResult -&gt; ...)\n</code></pre>\n\n<p>Is it possible to create an interface like this or do generics not work like that?</p>\n"}, {"tags": ["kotlin"], "answers": [{"comments": [{"owner": {"reputation": 11617, "user_id": 44615, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66a939e1811361ef6cadd460e913bae3?s=128&d=identicon&r=PG", "display_name": "Martin Stone", "link": "https://stackoverflow.com/users/44615/martin-stone"}, "edited": false, "score": 0, "creation_date": 1492419143, "post_id": 43443419, "comment_id": 73952085, "body": "Thanks: That&#39;s done the trick. The <code>Float::minus</code> is nice too. (The lack of a constructor taking an array was a copy/paste oversight.)"}], "tags": [], "owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "is_accepted": true, "score": 3, "last_activity_date": 1492387022, "creation_date": 1492387022, "answer_id": 43443419, "question_id": 43442187, "link": "https://stackoverflow.com/questions/43442187/kotlin-construct-value-of-derived-generic-type-in-base-class/43443419#43443419", "title": "Kotlin: Construct value of derived generic type in base class", "body": "<p>You cannot do that in a straightforward way because, in Kotlin, you can only call a constructor of a concrete type, there's no way to call a constructor of a type parameter. Moreover, Kotlin does not allow passing an array into a function/constructor that expects fixed number of separate values.</p>\n\n<p>However, you can try to achieve that without too much boilerplate using an abstract function, like this:</p>\n\n<pre><code>abstract class VecN&lt;Derived: VecN&lt;Derived&gt;&gt;(val buffer: FloatArray) {\n    protected abstract fun createNew(buffer: FloatArray): Derived \n\n    operator fun minus(other: Derived) = \n        createNew(buffer.zip(other.buffer, Float::minus).toFloatArray())\n\n    // ...\n}\n</code></pre>\n\n<p>Then you have to override this function in each of the derived classes:</p>\n\n<pre><code>class Vec2(x: Float, y: Float) : VecN&lt;Vec2&gt;(floatArrayOf(x, y)) {\n    override protected fun createNew(buffer: FloatArray) = Vec2(buffer[0], buffer[1])\n}\n</code></pre>\n\n<p><a href=\"https://try.kotlinlang.org/#/UserProjects/fg11123prnpdnab6bk1fig31i8/l5odolj7hcpacclgp67tarete5\" rel=\"nofollow noreferrer\">(demo of this code)</a></p>\n"}], "owner": {"reputation": 11617, "user_id": 44615, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66a939e1811361ef6cadd460e913bae3?s=128&d=identicon&r=PG", "display_name": "Martin Stone", "link": "https://stackoverflow.com/users/44615/martin-stone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "accepted_answer_id": 43443419, "answer_count": 1, "score": 2, "last_activity_date": 1492387022, "creation_date": 1492377031, "question_id": 43442187, "link": "https://stackoverflow.com/questions/43442187/kotlin-construct-value-of-derived-generic-type-in-base-class", "title": "Kotlin: Construct value of derived generic type in base class", "body": "<p>I'm trying to reduce duplication across some vector types by defining the operators once, but I'm not sure it's possible. This seemed like the most promising approach:</p>\n\n<pre><code>open class VecN&lt;Derived: VecN&lt;Derived&gt;&gt;(val buffer: FloatArray) {\n    operator fun minus(other: Derived) = Derived(buffer.zip(other.buffer, { a, b -&gt; a - b }).toFloatArray())\n    operator fun plus(other: Derived) = Derived(buffer.zip(other.buffer, { a, b -&gt; a + b }).toFloatArray())\n    ... many more operators...\n}\n\nclass Vec2(x: Float, y: Float) : VecN&lt;Vec2&gt;(floatArrayOf(x, y))\nclass Vec3(x: Float, y: Float, z: Float) : VecN&lt;Vec3&gt;(floatArrayOf(x, y, z))\nclass Vec4(x: Float, y: Float, z: Float, w: Float) : VecN&lt;Vec4&gt;(floatArrayOf(x, y, z, w))\n</code></pre>\n\n<p>This gives me \"Type parameter Derived cannot be called as function\" where I try to construct my Derived return value.</p>\n\n<p>Is it possible to achieve this in Kotlin?</p>\n"}, {"tags": ["spring-boot", "spring-security", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 3078000, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4b04949997729d7c3e76df647e7f5820?s=128&d=identicon&r=PG&f=1", "display_name": "blue", "link": "https://stackoverflow.com/users/3078000/blue"}, "edited": false, "score": 0, "creation_date": 1492371642, "post_id": 43440691, "comment_id": 73939502, "body": "Thank for your answer! I&#39;m a bit confused though, as I&#39;m not using moxy which is, from what I&#39;ve read, a library for Android development? Or maybe do I need to use kapt on one of my dependencies? I&#39;ve added my build.gradle file to my post above, if it can help."}], "tags": [], "owner": {"reputation": 24400, "user_id": 2293534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/0YypN.jpg?s=128&g=1", "display_name": "SkyWalker", "link": "https://stackoverflow.com/users/2293534/skywalker"}, "is_accepted": false, "score": 0, "last_activity_date": 1492367736, "creation_date": 1492367736, "answer_id": 43440691, "question_id": 43440584, "link": "https://stackoverflow.com/questions/43440584/enabling-spring-security-global-method-security-breaks-dependency-injection-wit/43440691#43440691", "title": "Enabling Spring Security global method security breaks dependency injection (with Kotlin)", "body": "<p>you have to use kapt in your gradle file for moxy compiler.</p>\n\n<p>Most stable configuration is kapt with generate stubs is given in the following example</p>\n\n<pre><code>apply plugin: 'com.android.application'\napply plugin: 'kotlin-android'\nandroid {\n    compileSdkVersion 24\n    buildToolsVersion \"24.0.0\"\n\n    defaultConfig {\n        applicationId \"com.redmadrobot.moxysamplekotlin\"\n        minSdkVersion 19\n        targetSdkVersion 24\n        versionCode 1\n        versionName \"1.0\"\n        testInstrumentationRunner \"android.support.test.runner.AndroidJUnitRunner\"\n    }\n    buildTypes {\n        release {\n            minifyEnabled false\n            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'\n        }\n    }\n}\nkapt {\n    generateStubs = true\n}\ndependencies {\n    compile fileTree(dir: 'libs', include: ['*.jar'])\n    androidTestCompile('com.android.support.test.espresso:espresso-core:2.2.2', {\n        exclude group: 'com.android.support', module: 'support-annotations'\n    })\n    compile 'com.android.support:appcompat-v7:24.2.1'\n    compile 'com.android.support:design:24.2.1'\n    compile project(':moxy')\n    compile project(':moxy-android')\n    kapt project(':moxy-compiler')\n    testCompile 'junit:junit:4.12'\n    compile \"org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version\"\n}\n</code></pre>\n\n<p>For full details, please check this github issue: <a href=\"https://github.com/Arello-Mobile/Moxy/issues/41\" rel=\"nofollow noreferrer\">lateinit property Presenter has not been initialized</a></p>\n"}, {"tags": [], "owner": {"reputation": 125, "user_id": 3078000, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4b04949997729d7c3e76df647e7f5820?s=128&d=identicon&r=PG&f=1", "display_name": "blue", "link": "https://stackoverflow.com/users/3078000/blue"}, "is_accepted": true, "score": 0, "last_activity_date": 1492442967, "creation_date": 1492442967, "answer_id": 43454465, "question_id": 43440584, "link": "https://stackoverflow.com/questions/43440584/enabling-spring-security-global-method-security-breaks-dependency-injection-wit/43454465#43454465", "title": "Enabling Spring Security global method security breaks dependency injection (with Kotlin)", "body": "<p>Alright, I managed to fix it.</p>\n\n<p>I think that the issue was that while my <code>AccountController</code> was declared as <code>open</code>, some of my Kotlin classes weren't (for those unfamiliar with Kotlin, that mean that those classes were declared as <code>final</code> in the JVM), and it was messing with dependency injection somehow (maybe some CGLIB weirdness?). I didn't think the problem would come from here, because usually Spring throws an exception when it fails to inject a dependency for such reasons, but it didn't in this case. It may or may not be normal, but I don't have enough knowledge about Spring internals to be able to say that the lack of exception thrown is a bug.</p>\n\n<p>Anyway, back to our issue. One way to fix it (I think) without adding any more dependencies would be to go through your entire code and mark Spring-annotated classes (and maybe subclasses too) as <code>open</code> for them to drop their <code>final</code>-ness.</p>\n\n<p>However, JetBrains released a compiler plugin called <code>kotlin-allopen</code> to automatically declare classes with specific annotations as <code>open</code>, and you can even use <code>kotlin-spring</code> to automatically configure it with Spring annotations!</p>\n\n<p>So the other, simpler way to fix it would be to add this to your build.gradle (there is a maven version, too):</p>\n\n<pre><code>// Add to dependencies\nclasspath \"org.jetbrains.kotlin:kotlin-allopen:$kotlin_version\"\n\n// [...]\n\napply plugin: 'kotlin-spring'\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 3078000, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4b04949997729d7c3e76df647e7f5820?s=128&d=identicon&r=PG&f=1", "display_name": "blue", "link": "https://stackoverflow.com/users/3078000/blue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1157, "favorite_count": 0, "accepted_answer_id": 43454465, "answer_count": 2, "score": 0, "last_activity_date": 1492443070, "creation_date": 1492367096, "last_edit_date": 1492443070, "question_id": 43440584, "link": "https://stackoverflow.com/questions/43440584/enabling-spring-security-global-method-security-breaks-dependency-injection-wit", "title": "Enabling Spring Security global method security breaks dependency injection (with Kotlin)", "body": "<p>I am currently working on the authentication system for a Spring Boot application, and I've been having issues since I tried to enable Spring Security's global method security.</p>\n\n<p>The Spring Boot application being a REST API, the authentication system is a bit non-standard, so I have set up a custom authentication filter that I add to the <code>HttpSecurity</code> object that pre-processes the request, calls a custom <code>AuthenticationManager</code> and gives the final <code>Authentication</code> object to the <code>SecurityContextHolder</code>. And that works fine!</p>\n\n<p>However, with this method, I have to set up all the access rules for my endpoints directly in my overridden <code>WebSecurityConfigurerAdapter.configure</code> method, which I find less-than-practical, so I tried to use Spring Security <code>@PreAuthorize</code> annotation directly in my controllers instead.</p>\n\n<p>The problem is, if I add <code>@EnableGlobalMethodSecurity(prePostEnabled = true)</code> to my security configuration, all the <code>@Autowired</code> attributes in my controllers are not injected. It works fine if I set <code>prePostEnabled = false</code> or if I remove the annotation altogether, but of course this isn't what I want.</p>\n\n<p>Here a stacktrace that shows the request handler being called (and the attributes not being initialized):</p>\n\n<pre><code>kotlin.UninitializedPropertyAccessException: lateinit property accountService has not been initialized\n        at com.example.api.module.account.AccountController.addAccountRole(AccountController.kt:105) ~[main/:na]\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_121]\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_121]\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_121]\n        at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_121]\n        at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133) ~[spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:116) ~[spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827) ~[spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738) ~[spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85) ~[spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:963) ~[spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:897) ~[spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970) ~[spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872) ~[spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:648) ~[tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846) ~[spring-webmvc-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:729) ~[tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:230) ~[tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) ~[tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52) ~[tomcat-embed-websocket-8.5.11.jar:8.5.11]\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) ~[tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) ~[tomcat-embed-core-8.5.11.jar:8.5.11]\n        at com.example.api.security.HeaderAuthenticationFilter.doFilter(HeaderAuthenticationFilter.kt:46) ~[main/:na]\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) ~[tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) ~[tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:317) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:127) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:91) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:114) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:137) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:111) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:170) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at com.example.api.security.HeaderAuthenticationFilter.doFilter(HeaderAuthenticationFilter.kt:46) ~[main/:na]\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:116) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:64) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:105) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:56) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:214) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]\n        at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346) ~[spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262) ~[spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) ~[tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) ~[tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99) ~[spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) ~[tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) ~[tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.springframework.web.filter.HttpPutFormContentFilter.doFilterInternal(HttpPutFormContentFilter.java:105) ~[spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) ~[tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) ~[tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:81) ~[spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) ~[tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) ~[tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197) ~[spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) ~[tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) ~[tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198) ~[tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96) [tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:474) [tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140) [tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79) [tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87) [tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:349) [tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:783) [tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66) [tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:798) [tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1434) [tomcat-embed-core-8.5.11.jar:8.5.11]\n        at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-8.5.11.jar:8.5.11]\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [na:1.8.0_121]\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [na:1.8.0_121]\n        at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-8.5.11.jar:8.5.11]\n        at java.lang.Thread.run(Thread.java:745) [na:1.8.0_121]\n</code></pre>\n\n<p>And here's some of my classes which I think are relevant with all their annotations to illustrate my explanation.</p>\n\n<p>com/example/api/security/SecurityConfig.kt :</p>\n\n<pre><code>@Configuration\n@EnableWebSecurity\n@EnableGlobalMethodSecurity(prePostEnabled = true) // works if absent\nopen class WebSecurityConfig : WebSecurityConfigurerAdapter() {\n    @Autowired\n    lateinit var authFilter: HeaderAuthenticationFilter\n\n    override fun configure(http: HttpSecurity) {\n        http.addFilterAt(authFilter,\n                AbstractPreAuthenticatedProcessingFilter::class.java)\n                .sessionManagement()\n                .sessionCreationPolicy(SessionCreationPolicy.STATELESS)\n        http.authorizeRequests()\n                .antMatchers(HttpMethod.POST, \"/accounts\").permitAll()\n                .anyRequest().authenticated()\n        http.csrf().disable()\n    }\n}\n</code></pre>\n\n<p>com/example/api/module/account/AccountController.kt :</p>\n\n<pre><code>@RestController\n@RequestMapping(\"/accounts\")\nopen class AccountController {\n    @Autowired\n    lateinit var accountService: AccountService\n\n    // [...]\n\n    @PreAuthorize(\"hasAuthority('ADMIN') or hasIpAddress('127.0.0.1')\")\n    @RequestMapping(method = arrayOf(RequestMethod.POST),\n            value = \"/{id}/roles\")\n    fun addAccountRole(@RequestBody data: PostAccountRoleData,\n                       @PathVariable(\"id\") id: Long):\n            ResponseWrapper {\n        val account = accountService.findAccount(id) // line 105, exception here\n        accountService.updateAccount(account.copy(authority = data.roles))\n        return ResponseWrapper(StatusMessage.SUCCESS)\n    }\n}\n</code></pre>\n\n<p>com/example/api/module/account/AccountService.kt :</p>\n\n<pre><code>interface AccountService {\n    fun getAllAccounts(): List&lt;Account&gt;\n    fun findAccount(id: Long): Account\n\n    // [...]\n}\n</code></pre>\n\n<p>com/example/api/module/account/DatastoreAccountService.kt :</p>\n\n<pre><code>@Service(\"accountService\")\nclass DatastoreAccountService : AccountService {\n    // [...] implementation details\n}\n</code></pre>\n\n<p>So how could I resolve this? I know that activating global method security activates some kind of proxy but I have no idea why and how it could affect dependency injection on my controllers.</p>\n\n<p>Thanks in advance!</p>\n\n<p>EDIT: Here's my build.gradle file, too:</p>\n\n<pre><code>group 'com.example.api'\nversion '1.0-SNAPSHOT'\n\nbuildscript {\n    ext.kotlin_version = '1.1.1'\n    ext.spring_boot_version = '1.5.2.RELEASE'\n    ext.spring_security_version = '4.2.2.RELEASE'\n    ext.jackson_kotlin_version = '2.9.0.pr2'\n\n    repositories {\n        jcenter()\n        mavenCentral()\n    }\n    dependencies {\n        classpath \"org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version\"\n        classpath \"org.springframework.boot:spring-boot-gradle-plugin:$spring_boot_version\"\n        classpath 'com.google.cloud.tools:appengine-gradle-plugin:+'\n    }\n}\n\nrepositories {\n    maven {\n        url 'https://maven-central.storage.googleapis.com'\n    }\n    jcenter()\n    mavenCentral()\n}\n\napply plugin: 'kotlin'\napply plugin: 'idea'\napply plugin: 'eclipse'\napply plugin: 'org.springframework.boot'\napply plugin: 'com.google.cloud.tools.appengine'\n\ndependencies {\n    compile \"org.jetbrains.kotlin:kotlin-stdlib-jre8:$kotlin_version\"\n    compile 'org.springframework.boot:spring-boot-starter-web'\n    compile \"org.springframework.security:spring-security-web:$spring_security_version\"\n    compile \"org.springframework.security:spring-security-config:$spring_security_version\"\n    compile \"com.fasterxml.jackson.module:jackson-module-kotlin:$jackson_kotlin_version\"\n    compile 'com.google.cloud:google-cloud-datastore:+'\n}\n\njar {\n    baseName = 'example-api'\n    version = \"$version\"\n}\n\nappengine {\n    deploy {\n        stopPreviousVersion = true\n        promote = true\n    }\n}\n\nsourceCompatibility = 1.8\ntargetCompatibility = 1.8\n\n// Set-up the datastore emulator environment variable for debugging\nbootRun {\n    environment \"DATASTORE_EMULATOR_HOST\", \"localhost:8081\"\n    environment \"DATASTORE_PROJECT_ID\", \"example-api\"\n}\n</code></pre>\n"}, {"tags": ["properties", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1492408028, "post_id": 43438365, "comment_id": 73947797, "body": "I would recommend putting  <code>private object UNINITIALIZED_VALUE</code> inside <code>UninitializedProperty</code>, not alongside it"}, {"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1492408120, "post_id": 43438365, "comment_id": 73947822, "body": "The implementation has a bug. What if it is initialized with <code>null</code>? To fix it, you need to compare <code>_value</code> with <code>UNINITIALIZED_VALUE</code>, not with <code>null</code>."}], "tags": [], "owner": {"reputation": 4319, "user_id": 4874829, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cfECAGc8huU/AAAAAAAAAAI/AAAAAAAAAJk/Pebw5H-quLo/photo.jpg?sz=128", "display_name": "Yoav Sternberg", "link": "https://stackoverflow.com/users/4874829/yoav-sternberg"}, "is_accepted": false, "score": 6, "last_activity_date": 1492412597, "last_edit_date": 1492412597, "creation_date": 1492353501, "answer_id": 43438365, "question_id": 43437861, "link": "https://stackoverflow.com/questions/43437861/how-to-implement-a-property-that-draws-from-a-certain-source-until-it-is-set-dir/43438365#43438365", "title": "How to implement a property that draws from a certain source until it is set directly in Kotlin?", "body": "<p>You need to create a class that extends <code>ReadWriteProperty</code> that provides the functionality (Code sample is based on unsafe lazy implementation)</p>\n\n<pre><code>class UninitializedProperty&lt;T&gt;(private val getter: () -&gt; T) : ReadWriteProperty&lt;Any?, T&gt; {\n    var _value: Any? = UNINITIALIZED_VALUE\n\n    @Suppress(\"UNCHECKED_CAST\")\n    override fun getValue(thisRef: Any?, property: KProperty&lt;*&gt;): T = if(_value === UNINITIALIZED_VALUE) getter() else _value as T\n\n    override fun setValue(thisRef: Any?, property: KProperty&lt;*&gt;, value: T) {\n        _value = value\n    }\n\n   private object UNINITIALIZED_VALUE\n}\n</code></pre>\n\n<p>Next, define a helper method in order to keep constancy with standards delegates like <code>lazy</code>:</p>\n\n<pre><code>fun &lt;T&gt; uninitialized(getter: () -&gt; T): ReadWriteProperty&lt;Any?, T&gt; = UninitializedProperty(getter)\n</code></pre>\n\n<p>Now you can use it:</p>\n\n<pre><code>class Foo(val base: FooBase) {\n    override var number: Int by uninitialized { base.number }\n}\n</code></pre>\n\n<p><strong>Note:</strong> The class is not thread safe.</p>\n\n<p>Check the <a href=\"https://kotlinlang.org/docs/reference/delegated-properties.html\" rel=\"noreferrer\">official documentation</a> for more info about delegation.</p>\n"}, {"tags": [], "owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "is_accepted": true, "score": 2, "last_activity_date": 1492407939, "creation_date": 1492407939, "answer_id": 43445819, "question_id": 43437861, "link": "https://stackoverflow.com/questions/43437861/how-to-implement-a-property-that-draws-from-a-certain-source-until-it-is-set-dir/43445819#43445819", "title": "How to implement a property that draws from a certain source until it is set directly in Kotlin?", "body": "<p>Here is a performance improvement over the Yoav Sternberg's answer. As you see, it is less generic, but it avoids auto-boxing for ints:</p>\n\n<pre><code>class IntUninitializedProperty(private val getter: () -&gt; Int) {\n    private var isInitialised = false\n    private var value: Int = 0\n\n    fun getValue(thisRef: Any?, property: KProperty&lt;*&gt;): Int = if(isInitialised) value else getter()\n\n    fun setValue(thisRef: Any?, property: KProperty&lt;*&gt;, value: Int) {\n        this.value = value\n        isInitialised = true\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 645, "user_id": 1582024, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e15498d3e5d13a9917262e45363cb720?s=128&d=identicon&r=PG", "display_name": "user1582024", "link": "https://stackoverflow.com/users/1582024/user1582024"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 43445819, "answer_count": 2, "score": 2, "last_activity_date": 1492412597, "creation_date": 1492349975, "question_id": 43437861, "link": "https://stackoverflow.com/questions/43437861/how-to-implement-a-property-that-draws-from-a-certain-source-until-it-is-set-dir", "title": "How to implement a property that draws from a certain source until it is set directly in Kotlin?", "body": "<p>I currently have a property declared like this:</p>\n\n<pre><code>class Foo(val base : FooBase){\n    var _number: Int? = null\n\n    override var number: Int\n        get() = _number ?: base.number\n        set(value) {_number = value}\n}\n</code></pre>\n\n<p>However, I have a lot of properties like this, leading to quite a bit of code duplication. Is there a way to avoid this? I understand that property delegation is a way to do this, but I am unsure how to implement <code>ReadWriteProperty&lt;...&gt;</code> correctly. How do I use the \"property\" value, if I'm supposed to use it at all?</p>\n"}, {"tags": ["android", "dependency-injection", "kotlin", "dagger"], "answers": [{"tags": [], "owner": {"reputation": 1849, "user_id": 7679573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/czZkd.jpg?s=128&g=1", "display_name": "A. Shevchuk", "link": "https://stackoverflow.com/users/7679573/a-shevchuk"}, "is_accepted": false, "score": 1, "last_activity_date": 1507137433, "last_edit_date": 1507137433, "creation_date": 1492432775, "answer_id": 43451686, "question_id": 43433073, "link": "https://stackoverflow.com/questions/43433073/dagger2-not-working-in-android/43451686#43451686", "title": "Dagger2 not working in android", "body": "<p>You should call \"inject\" inside of class where you want to get injected variable. \nYou did it for MainActivity, but also you should inject your component inside other classes. By the way, you have TestClass, it seems like you use it in client code also from injection, because it has \"Singleton\" annotation. If it's true - you can simply add provider for it in your module and pass service as a contructor parameter:</p>\n\n<pre><code>class testModule {\n    @Provides @Singleton\n    fun provideTestServer(): TestService {\n    }\n\n @Provides @Singleton\n    fun provideTestServer(testService: TestService): TestClass {\n    }\n}\n</code></pre>\n\n<p>then, your TestClass should have constructor:</p>\n\n<pre><code>class TestClass(var testService: TestService) {\n    fun test() = testService.testfun()\n}\n</code></pre>\n\n<p>I suggest you to read once again about dagger, check this tutorial:\n<a href=\"http://www.vogella.com/tutorials/Dagger/article.html\" rel=\"nofollow noreferrer\">http://www.vogella.com/tutorials/Dagger/article.html</a></p>\n"}], "owner": {"reputation": 21, "user_id": 2944056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d8fc4014cc8f06bb66c75a24fd5a35f?s=128&d=identicon&r=PG&f=1", "display_name": "yong8521", "link": "https://stackoverflow.com/users/2944056/yong8521"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513246295, "creation_date": 1492309136, "last_edit_date": 1513246295, "question_id": 43433073, "link": "https://stackoverflow.com/questions/43433073/dagger2-not-working-in-android", "title": "Dagger2 not working in android", "body": "<p>I have problem using dagger2</p>\n\n<p>I create Component, Module, Provide</p>\n\n<pre><code>class testModule {\n    @Provides @Singleton\n    fun provideTestServer(): TestService {\n    }\n}\n</code></pre>\n\n<p>and i called onCreate() in MainActivity</p>\n\n<pre><code>DaggerImageComponent.builder().build().inject(this)\n</code></pre>\n\n<p>here's my problem\nDI works fine in MainActivity</p>\n\n<pre><code>class MainActivity: AppCompatActivity {\n    @Inject\n    lateinit var testService: TestService\n}\n</code></pre>\n\n<p>but other file is not working.</p>\n\n<pre><code>object TestObject {\n    @Inject\n    @JvmSynthetic // error: static field cannot inject\n    lateinit var testService: TestService\n    fun test() = testService.testfun()\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>@Singleton\nclass TestClass {\n    @Inject\n    lateinit var testService: TestService\n    fun test() = testService.testfun()\n}\n</code></pre>\n\n<p>TestClass and TestObject get error\n - lateinit property testInterface has not been initialized</p>\n\n<p>i don't understand why error occured in TestClass, TestObject.</p>\n"}, {"tags": ["java", "maven", "kotlin", "noclassdeffounderror", "mapdb"], "comments": [{"owner": {"reputation": 2151, "user_id": 4413257, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8f160210cbf97a6809347b9fc385fc10?s=128&d=identicon&r=PG&f=1", "display_name": "matoni", "link": "https://stackoverflow.com/users/4413257/matoni"}, "edited": false, "score": 0, "creation_date": 1492255010, "post_id": 43425367, "comment_id": 73908809, "body": "try clean and build project"}, {"owner": {"reputation": 1036, "user_id": 809131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db47471c64fd13fbac8d6c78e43bd006?s=128&d=identicon&r=PG", "display_name": "Jan Kotek", "link": "https://stackoverflow.com/users/809131/jan-kotek"}, "edited": false, "score": 0, "creation_date": 1492663740, "post_id": 43425367, "comment_id": 74074970, "body": "<a href=\"https://stackoverflow.com/questions/9846046/run-main-class-of-maven-project#9846103\" title=\"run main class of maven project%239846103\">stackoverflow.com/questions/9846046/&hellip;</a>"}, {"owner": {"reputation": 3677, "user_id": 1128668, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/35ca82b58da21315ee1650c8f4158adf?s=128&d=identicon&r=PG", "display_name": "GlenPeterson", "link": "https://stackoverflow.com/users/1128668/glenpeterson"}, "edited": false, "score": 0, "creation_date": 1531326421, "post_id": 43425367, "comment_id": 89558269, "body": "I had the same issue from the command line."}], "answers": [{"comments": [{"owner": {"reputation": 2020, "user_id": 1529441, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/7QNuh.gif?s=128&g=1", "display_name": "Tyvain", "link": "https://stackoverflow.com/users/1529441/tyvain"}, "edited": false, "score": 0, "creation_date": 1492306452, "post_id": 43428896, "comment_id": 73923525, "body": "Its better, but then I get: java.lang.NoClassDefFoundError: org/eclipse/collections/api/list/primitive/MutableLongList"}], "tags": [], "owner": {"reputation": 3070, "user_id": 7801800, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iUnnw.jpg?s=128&g=1", "display_name": "Anshul Sharma", "link": "https://stackoverflow.com/users/7801800/anshul-sharma"}, "is_accepted": false, "score": 2, "last_activity_date": 1492276239, "creation_date": 1492276239, "answer_id": 43428896, "question_id": 43425367, "link": "https://stackoverflow.com/questions/43425367/mapdb-classnotfoundexception-kotlin-jvm-internal-intrinsics/43428896#43428896", "title": "MapDB ClassNotFoundException: kotlin.jvm.internal.Intrinsics", "body": "<p>It will fail because you do not have the necessary kotlin runtime jar in your classpath. You have to run some command to resolve this error. please refer this link for commands:-</p>\n\n<p><a href=\"https://dzone.com/articles/exercises-in-kotlin-part-1-getting-started\" rel=\"nofollow noreferrer\">https://dzone.com/articles/exercises-in-kotlin-part-1-getting-started</a></p>\n"}, {"tags": [], "owner": {"reputation": 1036, "user_id": 809131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db47471c64fd13fbac8d6c78e43bd006?s=128&d=identicon&r=PG", "display_name": "Jan Kotek", "link": "https://stackoverflow.com/users/809131/jan-kotek"}, "is_accepted": false, "score": 0, "last_activity_date": 1492663791, "creation_date": 1492663791, "answer_id": 43510447, "question_id": 43425367, "link": "https://stackoverflow.com/questions/43425367/mapdb-classnotfoundexception-kotlin-jvm-internal-intrinsics/43510447#43510447", "title": "MapDB ClassNotFoundException: kotlin.jvm.internal.Intrinsics", "body": "<p>Maybe run your class from maven, it will add all necessary dependencies. </p>\n\n<p><a href=\"https://stackoverflow.com/questions/9846046/run-main-class-of-maven-project#9846103\">run main class of Maven project</a></p>\n"}, {"tags": [], "owner": {"reputation": 26881, "user_id": 432903, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/YCgsh.jpg?s=128&g=1", "display_name": "prayagupd", "link": "https://stackoverflow.com/users/432903/prayagupd"}, "is_accepted": true, "score": 8, "last_activity_date": 1498290677, "creation_date": 1498290677, "answer_id": 44734211, "question_id": 43425367, "link": "https://stackoverflow.com/questions/43425367/mapdb-classnotfoundexception-kotlin-jvm-internal-intrinsics/44734211#44734211", "title": "MapDB ClassNotFoundException: kotlin.jvm.internal.Intrinsics", "body": "<p>Either <code>kotlin-runtime</code> has to be in <code>classpath</code> and verify with <code>$ echo $CLASSPATH</code>.</p>\n\n<p>Or you have to add <code>kotlin-runtime</code> to maven and then assemble inside the jar itself with <code>mvn compile assembly:single</code>, </p>\n\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.jetbrains.kotlin&lt;/groupId&gt;\n    &lt;artifactId&gt;kotlin-runtime&lt;/artifactId&gt;\n    &lt;version&gt;1.1.3&lt;/version&gt;\n    &lt;scope&gt;compile&lt;/scope&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;org.jetbrains.kotlin&lt;/groupId&gt;\n    &lt;artifactId&gt;kotlin-stdlib&lt;/artifactId&gt;\n    &lt;version&gt;1.1.3&lt;/version&gt;\n    &lt;scope&gt;compile&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre>\n\n<p>which need to be attached to artifact as well and can be done with <code>assembly-plugin</code>.</p>\n\n<pre><code>    &lt;plugin&gt;\n        &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;\n        &lt;configuration&gt;\n            &lt;archive&gt;\n                &lt;manifest&gt;\n                    &lt;mainClass&gt;event.handlers.InventoryEventHandler&lt;/mainClass&gt;\n                &lt;/manifest&gt;\n            &lt;/archive&gt;\n            &lt;descriptorRefs&gt;\n                &lt;descriptorRef&gt;jar-with-dependencies&lt;/descriptorRef&gt;\n            &lt;/descriptorRefs&gt;\n        &lt;/configuration&gt;\n    &lt;/plugin&gt;\n</code></pre>\n\n<p>you can verify the kotlin-runtime is added to jar by </p>\n\n<pre><code>$ jar -tf target/amz-wavelength-1.0-SNAPSHOT-jar-with-dependencies.jar | grep kotlin-runtime\nMETA-INF/kotlin-runtime.kotlin_module\n</code></pre>\n\n<p>or </p>\n\n<pre><code>$ jar -tf target/amz-wavelength-1.0-SNAPSHOT-jar-with-dependencies.jar | grep \"kotlin/jvm/internal/*\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3677, "user_id": 1128668, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/35ca82b58da21315ee1650c8f4158adf?s=128&d=identicon&r=PG", "display_name": "GlenPeterson", "link": "https://stackoverflow.com/users/1128668/glenpeterson"}, "is_accepted": false, "score": 2, "last_activity_date": 1531325977, "last_edit_date": 1531325977, "creation_date": 1531324867, "answer_id": 51289865, "question_id": 43425367, "link": "https://stackoverflow.com/questions/43425367/mapdb-classnotfoundexception-kotlin-jvm-internal-intrinsics/51289865#51289865", "title": "MapDB ClassNotFoundException: kotlin.jvm.internal.Intrinsics", "body": "<p>@prayagupd's answer works for me.  But I thought it worth mentioning that another option is to use the <a href=\"https://maven.apache.org/plugins/maven-shade-plugin/\" rel=\"nofollow noreferrer\">maven-shade-plugin</a> instead of the <a href=\"https://maven.apache.org/plugins/maven-assembly-plugin/\" rel=\"nofollow noreferrer\">maven-assembly-plugin</a> (put this in the <code>build/plugins</code> section of your pom.xml file):</p>\n\n<pre><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n    &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;\n    &lt;version&gt;2.4.3&lt;/version&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;phase&gt;package&lt;/phase&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;shade&lt;/goal&gt;\n            &lt;/goals&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n&lt;/plugin&gt;\n</code></pre>\n\n<p>The shade plugin is nice because it allows you to exclude duplicate classes.  If you have to use either plugin, it's good to know you don't need both.  Build time and resulting jar file sizes are nearly identical in my quick tests, but the assembly plugin (that prayagupd suggested) doesn't add a bunch of warnings to my build output, so I'm going with that.</p>\n"}], "owner": {"reputation": 2020, "user_id": 1529441, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/7QNuh.gif?s=128&g=1", "display_name": "Tyvain", "link": "https://stackoverflow.com/users/1529441/tyvain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10107, "favorite_count": 3, "accepted_answer_id": 44734211, "answer_count": 4, "score": 5, "last_activity_date": 1531333305, "creation_date": 1492254918, "last_edit_date": 1531333305, "question_id": 43425367, "link": "https://stackoverflow.com/questions/43425367/mapdb-classnotfoundexception-kotlin-jvm-internal-intrinsics", "title": "MapDB ClassNotFoundException: kotlin.jvm.internal.Intrinsics", "body": "<p>I am trying to run a simple mapdb example, but get the error:</p>\n\n<pre><code>    Exception in thread \"main\" java.lang.NoClassDefFoundError: kotlin/jvm/internal/Intrinsics\n    at org.mapdb.DBMaker.fileDB(DBMaker.kt)\n    at leechies.Truc.main(Truc.java:9)\nCaused by: java.lang.ClassNotFoundException: kotlin.jvm.internal.Intrinsics\n    at java.net.URLClassLoader.findClass(URLClassLoader.java:381)\n    at java.lang.ClassLoader.loadClass(ClassLoader.java:424)\n    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:331)\n    at java.lang.ClassLoader.loadClass(ClassLoader.java:357)\n    ... 2 more\n</code></pre>\n\n<p>My class:</p>\n\n<pre><code>package leechies;\nimport java.util.concurrent.ConcurrentMap;\n\nimport org.mapdb.DB;\nimport org.mapdb.DBMaker;\n\npublic class Truc {\n    public static void main(String[] args) {\n        DB db = DBMaker.fileDB(\"file.db\").make();\n        ConcurrentMap map = db.hashMap(\"map\").createOrOpen();\n        map.put(\"something\", \"here\");\n        db.close();\n    }\n}\n</code></pre>\n\n<p>My pomx.xml</p>\n\n<pre><code>&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.mapdb&lt;/groupId&gt;\n        &lt;artifactId&gt;mapdb&lt;/artifactId&gt;\n        &lt;version&gt;3.0.3&lt;/version&gt;\n    &lt;/dependency&gt;\n</code></pre>\n\n<p>I run with rigth click -> Run as... -> java application.</p>\n"}, {"tags": ["android", "connection", "kotlin", "ejabberd", "smack"], "answers": [{"comments": [{"owner": {"reputation": 249, "user_id": 7220319, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-68nKgfYqfiE/AAAAAAAAAAI/AAAAAAAAAAk/MQI3o5AfhQs/photo.jpg?sz=128", "display_name": "Ankur Khandelwal", "link": "https://stackoverflow.com/users/7220319/ankur-khandelwal"}, "edited": false, "score": 0, "creation_date": 1492313229, "post_id": 43432101, "comment_id": 73924491, "body": "If I am making only connect request then also it should send me the connect successfully msg. By the way I also tried to call login() method also. But got same response."}, {"owner": {"reputation": 922, "user_id": 7124362, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/663c7ea155af997408dbe0a6a8914b52?s=128&d=identicon&r=PG&f=1", "display_name": "Ankur Khandelwal", "link": "https://stackoverflow.com/users/7124362/ankur-khandelwal"}, "edited": false, "score": 0, "creation_date": 1492699651, "post_id": 43432101, "comment_id": 74099105, "body": "@Kiskae can you check this question <a href=\"http://stackoverflow.com/questions/43491831/how-do-i-get-the-message-from-the-message-id-in-smack\" title=\"how do i get the message from the message id in smack\">stackoverflow.com/questions/43491831/&hellip;</a>"}], "tags": [], "owner": {"reputation": 20461, "user_id": 1452094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a12b28824b215e4886da2e9f376369f?s=128&d=identicon&r=PG", "display_name": "Kiskae", "link": "https://stackoverflow.com/users/1452094/kiskae"}, "is_accepted": false, "score": 0, "last_activity_date": 1492297388, "creation_date": 1492297388, "answer_id": 43432101, "question_id": 43423109, "link": "https://stackoverflow.com/questions/43423109/not-able-to-get-response-from-smack/43432101#43432101", "title": "Not able to get response from smack", "body": "<p>Looking at SMACK's documentation about creating a connection, you're missing a call to <code>connection.login()</code> so it times out after 5 seconds. (See delta between the last 2 RECV messages)</p>\n\n<p>Documentation: <a href=\"https://download.igniterealtime.org/smack/docs/latest/documentation/connections.html\" rel=\"nofollow noreferrer\">https://download.igniterealtime.org/smack/docs/latest/documentation/connections.html</a></p>\n"}], "owner": {"reputation": 249, "user_id": 7220319, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-68nKgfYqfiE/AAAAAAAAAAI/AAAAAAAAAAk/MQI3o5AfhQs/photo.jpg?sz=128", "display_name": "Ankur Khandelwal", "link": "https://stackoverflow.com/users/7220319/ankur-khandelwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 845, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1492297388, "creation_date": 1492238809, "question_id": 43423109, "link": "https://stackoverflow.com/questions/43423109/not-able-to-get-response-from-smack", "title": "Not able to get response from smack", "body": "<p>I am using the smack to connect ejabbard server. </p>\n\n<p>TO connect with ejabbard server through smack using following code</p>\n\n<pre><code>val config=XMPPTCPConnectionConfiguration.builder()\n                    .setXmppDomain(mDomainName)\n                    .setUsernameAndPassword(mUsername,mPassword)\n                    .setDebuggerEnabled(true)\n\n            mConnection= XMPPTCPConnection(config.build())\n\n            Log.v(\"Current status \",mConnection!!.isConnected().toString())\n            mConnection!!.connect()\n</code></pre>\n\n<p>But end up getting the error/warning:</p>\n\n<pre><code>4-15 12:09:22.626 2685-3195/com.example.itstym.kotlinchat I/DNSUtil: Could not resolve DNS SRV resource records for _xmpp-client._tcp.replica3377.cloudapp.net. Consider adding those.\n04-15 12:09:23.033 2685-3208/com.example.itstym.kotlinchat D/SMACK: SENT (1): &lt;stream:stream xmlns='jabber:client' to='replica3377.cloudapp.net' xmlns:stream='http://etherx.jabber.org/streams' version='1.0' from='user2@replica3377.cloudapp.net' xml:lang='en'&gt;\n04-15 12:09:23.189 2685-3209/com.example.itstym.kotlinchat D/SMACK: RECV (1): &lt;?xml version='1.0'?&gt;&lt;stream:stream id='3002662766383892485' version='1.0' xml:lang='en' xmlns:stream='http://etherx.jabber.org/streams' to='user2@replica3377.cloudapp.net' from='replica3377.cloudapp.net' xmlns='jabber:client'&gt;\n04-15 12:09:23.190 2685-3209/com.example.itstym.kotlinchat D/SMACK: RECV (1): &lt;stream:features&gt;&lt;mechanisms xmlns='urn:ietf:params:xml:ns:xmpp-sasl'&gt;&lt;mechanism&gt;PLAIN&lt;/mechanism&gt;&lt;mechanism&gt;DIGEST-MD5&lt;/mechanism&gt;&lt;mechanism&gt;X-OAUTH2&lt;/mechanism&gt;&lt;mechanism&gt;SCRAM-SHA-1&lt;/mechanism&gt;&lt;/mechanisms&gt;&lt;/stream:features&gt;\n04-15 12:09:28.846 2685-2754/com.example.itstym.kotlinchat D/SMACK: RECV (0): &lt;stream:error&gt;&lt;connection-timeout xmlns='urn:ietf:params:xml:ns:xmpp-streams'/&gt;&lt;/stream:error&gt;&lt;/stream:stream&gt;\n</code></pre>\n\n<p>after 30 sec or so I am getting another error </p>\n\n<pre><code>04-15 12:09:28.853 2685-2754/com.example.itstym.kotlinchat W/AbstractXMPPConnection: Connection XMPPTCPConnection[not-authenticated] (0) closed with error\n                                                                                     org.jivesoftware.smack.XMPPException$StreamErrorException: connection-timeout You can read more about the meaning of this stream error at http://xmpp.org/rfcs/rfc6120.html#streams-error-conditions\n                                                                                     &lt;stream:error&gt;&lt;connection-timeout xmlns='urn:ietf:params:xml:ns:xmpp-streams'/&gt;&lt;/stream:error&gt;\n                                                                                         at org.jivesoftware.smack.tcp.XMPPTCPConnection$PacketReader.parsePackets(XMPPTCPConnection.java:1046)\n                                                                                         at org.jivesoftware.smack.tcp.XMPPTCPConnection$PacketReader.access$300(XMPPTCPConnection.java:980)\n                                                                                         at org.jivesoftware.smack.tcp.XMPPTCPConnection$PacketReader$1.run(XMPPTCPConnection.java:996)\n                                                                                         at java.lang.Thread.run(Thread.java:818)\n</code></pre>\n\n<p>But when I check in ejabbard server session is started for the user. Also using converse.js I can verify the user is logged in.</p>\n\n<p>SO I think I am not getting the response from smack. </p>\n"}, {"tags": ["android", "kotlin"], "comments": [{"owner": {"reputation": 821, "user_id": 3952987, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/cFLgY.jpg?s=128&g=1", "display_name": "Mehran Zamani", "link": "https://stackoverflow.com/users/3952987/mehran-zamani"}, "edited": false, "score": 1, "creation_date": 1492237527, "post_id": 43422920, "comment_id": 73904518, "body": "what&#39;s the warning? and where is prefs?"}], "answers": [{"tags": [], "owner": {"reputation": 1214, "user_id": 6095439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb0a801257ee75e0987200564b0ea798?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6095439/john"}, "is_accepted": false, "score": 0, "last_activity_date": 1492242769, "creation_date": 1492242769, "answer_id": 43423633, "question_id": 43422920, "link": "https://stackoverflow.com/questions/43422920/return-value-for-a-variable-that-apparently-can-be-null-but-really-cant/43423633#43423633", "title": "Return value for a variable that apparently can be null but really can&#39;t", "body": "<p>You can write:</p>\n\n<pre><code>return someVar!!\n</code></pre>\n\n<p>this will return a non-null value, however if it's null it will throw an NPE.</p>\n"}, {"comments": [{"owner": {"reputation": 11707, "user_id": 4393565, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/19ab0903bafafe65cabf872f3ef5cff6?s=128&d=identicon&r=PG", "display_name": "P.J.Meisch", "link": "https://stackoverflow.com/users/4393565/p-j-meisch"}, "edited": false, "score": 0, "creation_date": 1492324081, "post_id": 43426424, "comment_id": 73926302, "body": "your solution 1 does not prevent <code>someVar</code>being modified between the assignment <code>someVar = value</code> and <code>return value</code>. So the returned value for the caller of <code>getSomeVar()</code> might be different than the actual value of the variable. So this should really be changed to a lazy initialized val as you suggested."}, {"owner": {"reputation": 4869, "user_id": 6151924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d32a9252d2034b93b3eb8f743512104?s=128&d=identicon&r=PG&f=1", "display_name": "RobCo", "link": "https://stackoverflow.com/users/6151924/robco"}, "reply_to_user": {"reputation": 11707, "user_id": 4393565, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/19ab0903bafafe65cabf872f3ef5cff6?s=128&d=identicon&r=PG", "display_name": "P.J.Meisch", "link": "https://stackoverflow.com/users/4393565/p-j-meisch"}, "edited": false, "score": 0, "creation_date": 1492341411, "post_id": 43426424, "comment_id": 73930289, "body": "@PJMeisch You&#39;re right, thanks. I have edited the answer to reflect this as well."}], "tags": [], "owner": {"reputation": 4869, "user_id": 6151924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d32a9252d2034b93b3eb8f743512104?s=128&d=identicon&r=PG&f=1", "display_name": "RobCo", "link": "https://stackoverflow.com/users/6151924/robco"}, "is_accepted": false, "score": 5, "last_activity_date": 1492341343, "last_edit_date": 1495540455, "creation_date": 1492261738, "answer_id": 43426424, "question_id": 43422920, "link": "https://stackoverflow.com/questions/43422920/return-value-for-a-variable-that-apparently-can-be-null-but-really-cant/43426424#43426424", "title": "Return value for a variable that apparently can be null but really can&#39;t", "body": "<p>The compiler complains because, theoretically, a different thread could change <code>someVar</code> in between the assignment and the return statement.  </p>\n\n<p>The idiomatic solution here would be to use <a href=\"https://kotlinlang.org/docs/reference/delegated-properties.html\" rel=\"nofollow noreferrer\">property delegation</a>:</p>\n\n<pre><code>private val someVar: SomeClass by lazy { getDefaultSomeVar() }\n</code></pre>\n\n<p>This initializes the property when it is first accessed in a thread safe manner. Also note that it is now a non-nullable val, instead of a nullable var, which makes it generally easier to work with.  </p>\n\n<p>You do lose the ability to modify it later on. If it needs to be mutable you currently have to make that yourself. For an example implementation see this SO question: <a href=\"https://stackoverflow.com/questions/34346966/kotlin-lazy-default-property\">Kotlin lazy default property</a>  </p>\n\n<hr>\n\n<p>The following two solutions take the method in the question (the 'java way') for granted and just show a way to prevent the compiler warning. However, in your situation these are <strong>not</strong> advised as they both have drawbacks over the lazy initialized property:</p>\n\n<p>1) Introduce a local variable. This variable is safe from being mutated by other threads and allows the compiler to do a Smart Cast:</p>\n\n<pre><code>private fun getSomeVar(): SomeClass {\n    var value = someVar\n    if(value == null) {\n        value = getDefaultSomeVar()\n        someVar = value\n    }\n\n    return value\n}\n</code></pre>\n\n<p>The method itself is however still not thread safe. In a multithreaded environment, <code>getDefaultSomeVar()</code> could be called multiple times and it is not guaranteed that the returned value of this method is equal to <code>someVar</code>.</p>\n\n<p>2) Use <code>!!</code>: the double bang operator. This converts a nullable type to non-nullable. But now you lose the protection and <a href=\"https://kotlinlang.org/docs/reference/null-safety.html#the--operator\" rel=\"nofollow noreferrer\">null safety</a> that the kotlin compiler enforces on you.  </p>\n\n<pre><code>return someVar!!\n</code></pre>\n\n<p>As the documentation puts it: 'If you want an NPE, you can have it'</p>\n"}, {"tags": [], "owner": {"reputation": 1849, "user_id": 7679573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/czZkd.jpg?s=128&g=1", "display_name": "A. Shevchuk", "link": "https://stackoverflow.com/users/7679573/a-shevchuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1492433104, "creation_date": 1492433104, "answer_id": 43451778, "question_id": 43422920, "link": "https://stackoverflow.com/questions/43422920/return-value-for-a-variable-that-apparently-can-be-null-but-really-cant/43451778#43451778", "title": "Return value for a variable that apparently can be null but really can&#39;t", "body": "<p>It could be shorter and without any warnings </p>\n\n<pre><code> private fun getSomeVar(): SomeClass {\n        return someVar?:getDefaultSomeVar()\n    }\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7863932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3b4d47d31946780801a7c819a7b7d83?s=128&d=identicon&r=PG&f=1", "display_name": "user7863932", "link": "https://stackoverflow.com/users/7863932/user7863932"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1492433104, "creation_date": 1492237253, "last_edit_date": 1492238544, "question_id": 43422920, "link": "https://stackoverflow.com/questions/43422920/return-value-for-a-variable-that-apparently-can-be-null-but-really-cant", "title": "Return value for a variable that apparently can be null but really can&#39;t", "body": "<p>What's an idiomatic way to do code this in Kotlin?</p>\n\n<pre><code>   private var someVar: SomeClass? = null\n\n   private fun getSomeVar(): SomeClass {\n        if (someVar == null) {\n            someVar = getDefaultSomeVar()\n        }\n\n        return someVar\n    }\n</code></pre>\n\n<p>Android Studio warns me about the return type. In Java this code is, however, proper and idiomatic. I mean, instead of changing the return type to <code>SomeClass?</code> maybe there's still a better way?</p>\n\n<p>Actually, <code>getSomeVar()</code> can never return null  </p>\n"}, {"tags": ["java", "android", "xml", "jvm", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 351, "user_id": 7326568, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-z4rasc19uOM/AAAAAAAAAAI/AAAAAAAAAAw/XkZQ8eWqW_U/photo.jpg?sz=128", "display_name": "\u041e\u043b\u0435\u0433 \u041c\u0456\u0441\u044c\u043a\u043e", "link": "https://stackoverflow.com/users/7326568/%d0%9e%d0%bb%d0%b5%d0%b3-%d0%9c%d1%96%d1%81%d1%8c%d0%ba%d0%be"}, "edited": false, "score": 1, "creation_date": 1492196618, "post_id": 43414339, "comment_id": 73894324, "body": "Your answer was right as well, but the second one has code sample and would be more appreciate by the community.  Thank you a lot! You were right and you saved me hours, I guess :)"}], "tags": [], "owner": {"reputation": 4556, "user_id": 3025732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J6boP.jpg?s=128&g=1", "display_name": "Joel Fernandes", "link": "https://stackoverflow.com/users/3025732/joel-fernandes"}, "is_accepted": false, "score": 1, "last_activity_date": 1492182784, "creation_date": 1492182784, "answer_id": 43414339, "question_id": 43414125, "link": "https://stackoverflow.com/questions/43414125/recyclerview-items-image-bug/43414339#43414339", "title": "RecyclerView item&#39;s image bug", "body": "<p><code>RecyclerView</code> is built to cache views and reuse them. When you scroll, your views are recycled and loaded from the memory. </p>\n\n<p>After you have made changes to your underlying data model attached to the adapter, it is important to notify the adapter about the same. In your <code>onClick</code> method, after you've made the changes, make sure you call <code>adapter.notifyDataSetChanged()</code> or just <code>notifyDataSetChanged()</code> if you're calling it directly from your adapter class.</p>\n"}, {"tags": [], "owner": {"reputation": 68863, "user_id": 4465208, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/w14F6.png?s=128&g=1", "display_name": "zsmb13", "link": "https://stackoverflow.com/users/4465208/zsmb13"}, "is_accepted": true, "score": 1, "last_activity_date": 1492183522, "creation_date": 1492183522, "answer_id": 43414565, "question_id": 43414125, "link": "https://stackoverflow.com/questions/43414125/recyclerview-items-image-bug/43414565#43414565", "title": "RecyclerView item&#39;s image bug", "body": "<p><code>RecyclerView</code> reuses the viewholders it creates with <code>onCreateViewHolder</code>. To put it simply, think of it as the views going off screen on the top coming back around on the bottom, and vica versa. Therefore, the nice way of solving what you want is the following:</p>\n\n<ol>\n<li><p>Set the icon to the right drawable in the <code>onBindViewHolder</code> method. This way, whether a viewholder is being bound for the first time, or had a drawable reflecting a recipe's favourited state already, it will be refreshed properly. </p>\n\n<p>Without knowing what your adapter looks like, this should give you an idea of how to do this (the example code assumes you have your recipes in some list called <code>recipes</code>):</p>\n\n<pre><code>override fun onBindViewHolder(holder: ViewHolder, position: Int) {\n    val recipe = recipes[position]\n    val itemView = holder.itemView\n    itemView.like.image = ContextCompat.getDrawable(itemView.context,\n            if(recipe.isFavorite) R.drawable.ic_star_before_like else R.drawable.ic_star_after_like)\n}\n</code></pre></li>\n<li><p>In the listener, modify the <code>Recipe</code> the same way you're doing it now, but instead of then setting the image directly, notify the adapter that the recipe at the given position has changed (<a href=\"https://developer.android.com/reference/android/support/v7/widget/RecyclerView.Adapter.html#notifyItemChanged(int)\" rel=\"nofollow noreferrer\"><code>notifyItemChanged(position)</code></a>), which will make it re-bind that item, refreshing the icon to reflect the new state. Again, I don't know where you're setting up the listener, but I assume you know what position the recipe is at in the list there.</p></li>\n</ol>\n"}], "owner": {"reputation": 351, "user_id": 7326568, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-z4rasc19uOM/AAAAAAAAAAI/AAAAAAAAAAw/XkZQ8eWqW_U/photo.jpg?sz=128", "display_name": "\u041e\u043b\u0435\u0433 \u041c\u0456\u0441\u044c\u043a\u043e", "link": "https://stackoverflow.com/users/7326568/%d0%9e%d0%bb%d0%b5%d0%b3-%d0%9c%d1%96%d1%81%d1%8c%d0%ba%d0%be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 621, "favorite_count": 0, "accepted_answer_id": 43414565, "answer_count": 2, "score": 0, "last_activity_date": 1492183522, "creation_date": 1492182078, "question_id": 43414125, "link": "https://stackoverflow.com/questions/43414125/recyclerview-items-image-bug", "title": "RecyclerView item&#39;s image bug", "body": "<p><strong>Problem: Glitch bug with RecyclerView's child's item ImageView</strong></p>\n\n<p>I have a RecyclerView.Each item has ImageView with id \"like\" which is basically an empty star.</p>\n\n<p>When we click on some item's \"Like\", for example, the first, the star is changing from empty filled in yellow, which means that item is liked.</p>\n\n<p>When we click on the first item everything is OK, everything is as it should be, but at the same time, we have a bug, changing the sixth item's \"like\" to a filled star, which shouldn't be done, as this item wasn't liked yet. </p>\n\n<p><em>If we click on second item's like - the seventh item would have the same bug.</em></p>\n\n<p><strong>To fill the item's in ViewHolder I have a model - Recipe.</strong></p>\n\n<pre><code>open class Recipe constructor(open var label: String,\n\n                          open var image: String,\n\n                          open var url: String,\n\n                          open var ingredients: RealmList&lt;Ingredient&gt;?,\n\n                          open var calories: Float,\n\n                          open var totalWeight: Float,\n\n                          open var id: Int,\n\n                          open var isFavorite: Boolean) : RealmObject() \n</code></pre>\n\n<p>So when clicking on some item I check whether it isFavorite or not, and change the \"like\" ImageView accordingly.</p>\n\n<p>Have anyone got any ideas how I should fix this?</p>\n\n<p>I tried to turn off recycling of items in the adapter, but unfortunately, in this case, the \"liked\" state isn't saved too.</p>\n\n<p><strong>OnClick listener for \"like\" button</strong></p>\n\n<pre><code>itemView.like.onClick {\n                if (recipe.isFavorite) {\n                    itemView.like.image = ContextCompat.getDrawable(itemView.context, R.drawable.ic_star_before_like)\n                    recipe.isFavorite = false\n                    DatabaseService.removeRecipeFromFavorites(recipe)\n                    itemView.context.toast(\"Recipe removed from favorites.\")\n                } else {\n                    itemView.like.image = ContextCompat.getDrawable(itemView.context, R.drawable.ic_star_after_like)\n                    recipe.isFavorite = true\n                    DatabaseService.addNewFavoriteRecipe(recipe)\n                    itemView.context.toast(\"Recipe added to favorites.\")\n                }\n\n            }\n</code></pre>\n\n<p><strong>XML-File</strong></p>\n\n<pre><code>&lt;LinearLayout\n  android:layout_width=\"match_parent\"\n  android:layout_height=\"0dip\"\n  android:layout_weight=\"0.8\"\n  android:gravity=\"center|right\"\n  android:orientation=\"horizontal\"&gt;\n\n  &lt;ImageView\n    android:id=\"@+id/like\"\n    android:layout_width=\"@dimen/icon_size_card\"\n    android:layout_height=\"@dimen/icon_size_card\"\n    android:padding=\"5dp\"\n    android:layout_marginRight=\"@dimen/icon_margin_card\"\n    android:src=\"@drawable/ic_star_before_like\" /&gt;\n\n  &lt;ImageView\n    android:id=\"@+id/share\"\n    android:layout_width=\"@dimen/icon_size_card\"\n    android:layout_height=\"@dimen/icon_size_card\"\n    android:padding=\"5dp\"\n    android:layout_marginRight=\"@dimen/icon_margin_card\"\n    android:src=\"@drawable/ic_share\" /&gt;\n\n  &lt;ImageView\n    android:id=\"@+id/save\"\n    android:layout_width=\"@dimen/icon_size_card\"\n    android:layout_height=\"@dimen/icon_size_card\"\n    android:padding=\"5dp\"\n    android:layout_marginRight=\"@dimen/icon_margin_card\"\n    android:src=\"@drawable/ic_save_recipe\" /&gt;\n\n  &lt;ImageView\n    android:id=\"@+id/expand\"\n    android:layout_width=\"@dimen/icon_size_card\"\n    android:layout_height=\"@dimen/icon_size_card\"\n    android:padding=\"5dp\"\n    android:layout_marginRight=\"@dimen/icon_margin_card\"\n    android:src=\"@drawable/ic_down_arrow\" /&gt;\n\n&lt;/LinearLayout&gt;\n</code></pre>\n"}, {"tags": ["android", "kotlin", "anko"], "comments": [{"owner": {"reputation": 4869, "user_id": 6151924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d32a9252d2034b93b3eb8f743512104?s=128&d=identicon&r=PG&f=1", "display_name": "RobCo", "link": "https://stackoverflow.com/users/6151924/robco"}, "edited": false, "score": 2, "creation_date": 1492178418, "post_id": 43411859, "comment_id": 73884827, "body": "Don&#39;t use the background. That will always make it stretch the entire view bounds. Other than that, look for a way to set the ScaleType. You probably want centerInside or fitCenter."}], "answers": [{"comments": [{"owner": {"reputation": 641, "user_id": 1870447, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5obdQ.jpg?s=128&g=1", "display_name": "Antek", "link": "https://stackoverflow.com/users/1870447/antek"}, "edited": false, "score": 0, "creation_date": 1492184408, "post_id": 43412659, "comment_id": 73888234, "body": "thank you, I just should have used ImageButton. Initially I just wanted to use one plain button and set an icon or a text on it, depending on the state. Using two buttons and showing/hiding them seems to be the easiest solution. I couldn&#39;t get <code>scaleType</code> to work with background, and <code>drawableTop|Bottom</code> etc. wouldn&#39;t suit my needs as well, so I&#39;ll stick with what I have now. Still, I don&#39;t know if that should be accepted answer."}, {"owner": {"reputation": 874, "user_id": 5065856, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-nIoVRNKXUeg/AAAAAAAAAAI/AAAAAAAAC0U/k7d_u_8vwjY/photo.jpg?sz=128", "display_name": "Pierre P.", "link": "https://stackoverflow.com/users/5065856/pierre-p"}, "reply_to_user": {"reputation": 641, "user_id": 1870447, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5obdQ.jpg?s=128&g=1", "display_name": "Antek", "link": "https://stackoverflow.com/users/1870447/antek"}, "edited": false, "score": 0, "creation_date": 1492184799, "post_id": 43412659, "comment_id": 73888445, "body": "You mean you can&#39;t get scaleType to work on an ImageButton ?"}, {"owner": {"reputation": 641, "user_id": 1870447, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5obdQ.jpg?s=128&g=1", "display_name": "Antek", "link": "https://stackoverflow.com/users/1870447/antek"}, "edited": false, "score": 0, "creation_date": 1492186021, "post_id": 43412659, "comment_id": 73889072, "body": "no, I couldn&#39;t get scaleType to work on plain button (i.e., there&#39;s just no such property). ImageButton worked as expected straight out from the box and there was no need to scale the image at all. I&#39;ll edit my question accordingly, though it seem it probably was answered numerous times then"}, {"owner": {"reputation": 641, "user_id": 1870447, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5obdQ.jpg?s=128&g=1", "display_name": "Antek", "link": "https://stackoverflow.com/users/1870447/antek"}, "edited": false, "score": 0, "creation_date": 1492186518, "post_id": 43412659, "comment_id": 73889297, "body": "I should perhaps scale the drawable to have proper height relative to the button, proper width resulting from aspect ratio and then set it as <code>backgroundDrawable</code>. I&#39;ll explore it some day later"}], "tags": [], "owner": {"reputation": 874, "user_id": 5065856, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-nIoVRNKXUeg/AAAAAAAAAAI/AAAAAAAAC0U/k7d_u_8vwjY/photo.jpg?sz=128", "display_name": "Pierre P.", "link": "https://stackoverflow.com/users/5065856/pierre-p"}, "is_accepted": false, "score": 1, "last_activity_date": 1492176883, "creation_date": 1492176883, "answer_id": 43412659, "question_id": 43411859, "link": "https://stackoverflow.com/questions/43411859/how-do-i-set-up-an-icon-drawable-for-a-button-in-anko/43412659#43412659", "title": "How do I set up an icon (drawable) for a button in anko?", "body": "<p>Not sure how Anko is supposed to work.\nTechnically for android, assuming you have an image button you should do :</p>\n\n<pre><code>((ImageButton)findViewById(R.id.yourButtonID)).setImageResource(R.drawable.yourDrawable);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 641, "user_id": 1870447, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5obdQ.jpg?s=128&g=1", "display_name": "Antek", "link": "https://stackoverflow.com/users/1870447/antek"}, "edited": false, "score": 0, "creation_date": 1492504532, "post_id": 43440461, "comment_id": 73989791, "body": "well, I need to accept it as the answer, and ask another question - I originally intended to have either an image or a text on a button, depending on the state of the app - that&#39;s why I asked about setting image for a button. Finally I ended up having two buttons (image and plain) and hiding/showing them accordingly."}], "tags": [], "owner": {"reputation": 348, "user_id": 4319961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/luP1G.jpg?s=128&g=1", "display_name": "Joe Sovcik", "link": "https://stackoverflow.com/users/4319961/joe-sovcik"}, "is_accepted": false, "score": 4, "last_activity_date": 1514902983, "last_edit_date": 1514902983, "creation_date": 1492366419, "answer_id": 43440461, "question_id": 43411859, "link": "https://stackoverflow.com/questions/43411859/how-do-i-set-up-an-icon-drawable-for-a-button-in-anko/43440461#43440461", "title": "How do I set up an icon (drawable) for a button in anko?", "body": "<p>First off, in order to set an Icon/image on a Button you should use <code>ImageButton</code>.</p>\n\n<p>Then it's easy.</p>\n\n<pre><code>imageButton{\n     imageResource = R.drawable.ic_cc_checkmark\n}\n</code></pre>\n\n<p>If you need to use other resources or a drawable, then to get it without getting a Resource not found Error use <code>ctx.getDrawable(R.x.y)</code></p>\n\n<p>Hope this helps someone</p>\n"}, {"tags": [], "owner": {"reputation": 345, "user_id": 2077405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YPrTQ.jpg?s=128&g=1", "display_name": "Ugo", "link": "https://stackoverflow.com/users/2077405/ugo"}, "is_accepted": true, "score": 1, "last_activity_date": 1588292665, "creation_date": 1588292665, "answer_id": 61535012, "question_id": 43411859, "link": "https://stackoverflow.com/questions/43411859/how-do-i-set-up-an-icon-drawable-for-a-button-in-anko/61535012#61535012", "title": "How do I set up an icon (drawable) for a button in anko?", "body": "<p>If anyone else is still trying to achieve this, here's a guide: <p>\n1. Create an extension function (perhaps in a standalone <code>.kt</code> file or in your <code>Activity</code> or <code>Fragment</code> class file where you want to use the button) like so:</p>\n\n<pre><code>inline fun ViewManager.materialButton(@StyleRes theme: Int, init: MaterialButton.() -&gt; Unit = {}): MaterialButton {\n    return ankoView({ MaterialButton(it) }, theme, init = init)\n}\n</code></pre>\n\n<ol start=\"2\">\n<li>Then use your button like other Anko views, like so:</li>\n</ol>\n\n<pre><code>materialButton(R.style.App_ThemeOverlay /** some overlay theme **/) {\n  icon = context.getDrawable(R.drawable.arrow_forward)\n  // ... other regular and material button properties here ...\n}\n</code></pre>\n"}], "owner": {"reputation": 641, "user_id": 1870447, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5obdQ.jpg?s=128&g=1", "display_name": "Antek", "link": "https://stackoverflow.com/users/1870447/antek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1904, "favorite_count": 0, "accepted_answer_id": 61535012, "answer_count": 3, "score": 1, "last_activity_date": 1588292665, "creation_date": 1492174179, "last_edit_date": 1492186157, "question_id": 43411859, "link": "https://stackoverflow.com/questions/43411859/how-do-i-set-up-an-icon-drawable-for-a-button-in-anko", "title": "How do I set up an icon (drawable) for a button in anko?", "body": "<p>I want to have an icon in the centre of a plain button, using anko. I tried </p>\n\n<p><code>button.backgroundResource = R.drawable.arrow_forward</code></p>\n\n<p>but I got drawable covering whole button and getting background colour from its parent (setting background colour on button explicite does nothing).</p>\n\n<p><a href=\"https://i.stack.imgur.com/B6EsR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/B6EsR.png\" alt=\"enter image description here\"></a></p>\n\n<p>I tried  <code>drawable = ...</code> as well, with same effect. How do I set up an icon with anko to have original aspect ratio and be centered?</p>\n"}, {"tags": ["android", "kotlin", "android-styles", "anko"], "answers": [{"tags": [], "owner": {"reputation": 1214, "user_id": 6095439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb0a801257ee75e0987200564b0ea798?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6095439/john"}, "is_accepted": true, "score": 3, "last_activity_date": 1492165745, "last_edit_date": 1495540009, "creation_date": 1492165329, "answer_id": 43409655, "question_id": 43404324, "link": "https://stackoverflow.com/questions/43404324/anko-ignoring-layout-margin-defined-in-style/43409655#43409655", "title": "Anko ignoring layout_margin defined in style", "body": "<p>This is not Anko problem, this is how Android works:</p>\n\n<blockquote>\n  <p>If you are specifying layout_margin in a custom style, this style must be explicitly applied to each individual view that you wish to have the specified margin (as seen in the code sample below). Including this style in a theme and applying it to your application or an activity will not work.</p>\n</blockquote>\n\n<p>This is because attributes which begin with layout_ are <code>LayoutParams</code>, or as in this example its <code>MarginLayoutParams</code>. Each <code>ViewGroup</code> have it's own <code>LayoutParams</code>  implementation. And so <code>layout_margin</code> is not just general attribute that can be applied anywhere. It must be applied within the context of a <code>ViewGroup</code> that specifically defines it as a valid argument.</p>\n\n<p>Look <a href=\"https://stackoverflow.com/questions/13167529/android-margins-specified-in-custom-style-not-taking-effect\">here</a> for more.</p>\n"}, {"tags": [], "owner": {"reputation": 3694, "user_id": 1167714, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/978df6957d78068fde50b8fd0e584512?s=128&d=identicon&r=PG", "display_name": "jonathanrz", "link": "https://stackoverflow.com/users/1167714/jonathanrz"}, "is_accepted": false, "score": 1, "last_activity_date": 1492360248, "last_edit_date": 1492360248, "creation_date": 1492209239, "answer_id": 43420067, "question_id": 43404324, "link": "https://stackoverflow.com/questions/43404324/anko-ignoring-layout-margin-defined-in-style/43420067#43420067", "title": "Anko ignoring layout_margin defined in style", "body": "<p>As @John pointed in his answer, using a style is not an option to define layout params.</p>\n\n<p>So, I developed a function to use in the applyRecursively that iterates over the views and apply the layouts that I want to apply.</p>\n\n<p>The solution:</p>\n\n<p>I wanted to define matchParent for width and height and a margin of 16dp for a TableView, so I created a new class that extends TableLayout</p>\n\n<pre><code>class TableViewFrame(context: Context) : TableLayout(context)\n</code></pre>\n\n<p>and then in the function when the view is a TableViewFrame I apply my layouts</p>\n\n<pre><code>fun applyTemplateViewLayouts(view: View) {\n    when(view) {\n        is TableViewFrame -&gt; {\n            when(view.layoutParams) {\n                is LinearLayout.LayoutParams -&gt; {\n                    view.layoutParams.height = matchParent\n                    view.layoutParams.width = matchParent\n                    (view.layoutParams as LinearLayout.LayoutParams).margin = view.dip(16)\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>To use the function, in the view definition, I just pass it in the applyRecursively:</p>\n\n<pre><code>verticalLayout {\n        tableViewFrame {\n            tableRow {\n                ...\n            }\n        }\n    }\n}.applyRecursively { view -&gt; applyTemplateViewLayouts(view) }\n</code></pre>\n\n<p>I wrote an article at medium with a more detailed explanation: <a href=\"https://medium.com/@jonathanrafaelzanella/using-android-styles-with-anko-e3d5341dd5b4\" rel=\"nofollow noreferrer\">https://medium.com/@jonathanrafaelzanella/using-android-styles-with-anko-e3d5341dd5b4</a></p>\n"}], "owner": {"reputation": 3694, "user_id": 1167714, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/978df6957d78068fde50b8fd0e584512?s=128&d=identicon&r=PG", "display_name": "jonathanrz", "link": "https://stackoverflow.com/users/1167714/jonathanrz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 628, "favorite_count": 0, "accepted_answer_id": 43409655, "answer_count": 2, "score": 1, "last_activity_date": 1492360248, "creation_date": 1492136182, "question_id": 43404324, "link": "https://stackoverflow.com/questions/43404324/anko-ignoring-layout-margin-defined-in-style", "title": "Anko ignoring layout_margin defined in style", "body": "<p>I created a custom style:</p>\n\n<pre><code>&lt;style name=\"Static\"&gt;\n    &lt;item name=\"android:layout_width\"&gt;wrap_content&lt;/item&gt;\n    &lt;item name=\"android:layout_height\"&gt;wrap_content&lt;/item&gt;\n    &lt;item name=\"android:layout_marginEnd\"&gt;5dp&lt;/item&gt;\n&lt;/style&gt;\n</code></pre>\n\n<p>Then I extended anko with a static function:</p>\n\n<pre><code>inline fun ViewManager.static(theme: Int = R.style.Static, init: TextView.() -&gt; Unit) = ankoView(::TextView, theme, init)\n</code></pre>\n\n<p>When I use this in my layout:</p>\n\n<pre><code>static { text = resources.getString(R.string.name) }\n</code></pre>\n\n<p>The marginEnd value is ignored.</p>\n\n<p>If I add a margin manually in anko:</p>\n\n<pre><code>static { text = resources.getString(R.string.name) }.lparams { marginEnd = dip(5) }\n</code></pre>\n\n<p>The margin is fine.</p>\n\n<p>Do you guys know what is happening that anko is ignoring my margin value or any other way to define a predefined margin for a extended view anko function?</p>\n"}, {"tags": ["java", "kotlin", "hashcode"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 1, "creation_date": 1492119064, "post_id": 43401993, "comment_id": 73864612, "body": "Given that implementation of <code>equals</code>, you more or less have no choice."}, {"owner": {"reputation": 630270, "user_id": 571407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2f0d9dec16bae1e06552af55ddefc11f?s=128&d=identicon&r=PG", "display_name": "JB Nizet", "link": "https://stackoverflow.com/users/571407/jb-nizet"}, "edited": false, "score": 5, "creation_date": 1492119352, "post_id": 43401993, "comment_id": 73864723, "body": "I would rather worry about your equals() method: it should not return true when comparing, say, a User with ID 1 with an Order with ID 1. An Order and a User should never be equal: they&#39;re not the same thing at all, even though they extend BaseItem"}, {"owner": {"reputation": 17849, "user_id": 4230345, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-fWK0YfC5ong/AAAAAAAAAAI/AAAAAAAAADk/a23H1FFs8Jg/photo.jpg?sz=128", "display_name": "Farbod Salamat-Zadeh", "link": "https://stackoverflow.com/users/4230345/farbod-salamat-zadeh"}, "reply_to_user": {"reputation": 630270, "user_id": 571407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2f0d9dec16bae1e06552af55ddefc11f?s=128&d=identicon&r=PG", "display_name": "JB Nizet", "link": "https://stackoverflow.com/users/571407/jb-nizet"}, "edited": false, "score": 0, "creation_date": 1492119865, "post_id": 43401993, "comment_id": 73864911, "body": "@JBNizet That&#39;s a very valid point - I did not think of that. Would it be appropriate to have an abstract <code>getType()</code> function which returns an integer based on what kind of <code>BaseItem</code> it is? Or do you think it would be better to use the standard implementations of <code>equals()</code> and <code>hashCode()</code> provided by Kotlin&#39;s <a href=\"https://kotlinlang.org/docs/reference/data-classes.html\" rel=\"nofollow noreferrer\">data classes</a>."}, {"owner": {"reputation": 630270, "user_id": 571407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2f0d9dec16bae1e06552af55ddefc11f?s=128&d=identicon&r=PG", "display_name": "JB Nizet", "link": "https://stackoverflow.com/users/571407/jb-nizet"}, "edited": false, "score": 0, "creation_date": 1492120226, "post_id": 43401993, "comment_id": 73865057, "body": "No. I&#39;d let subclasses implement equals (and hashCode) as they need to. Whether it&#39;s a good idea or not to use the ID for that depends on the context, the constraints of the persistence framework (if any), etc. For example, it&#39;s common to have the ID being null, and only being populated once auto-generated by the database. In that case, you can&#39;t really use the ID for equals() and hashCode(). Sometimes, not having equals() and hashCode() (i.e. use the one from java.lang.Object) is the correct thing to do."}, {"owner": {"reputation": 3180, "user_id": 905033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a6b947cd4c65dce0c3493549f9f411c?s=128&d=identicon&r=PG", "display_name": "Lew Bloch", "link": "https://stackoverflow.com/users/905033/lew-bloch"}, "edited": false, "score": 0, "creation_date": 1492127613, "post_id": 43401993, "comment_id": 73867277, "body": "It&#39;s a bad idea to carry database surrogate integer keys in the object model."}], "answers": [{"comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1492120056, "post_id": 43402241, "comment_id": 73864994, "body": "Why would it lead to violations?"}, {"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "reply_to_user": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1492120873, "post_id": 43402241, "comment_id": 73865287, "body": "@OliverCharlesworth I&#39;ve updated my answer to include an example of a violation."}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1492121451, "post_id": 43402241, "comment_id": 73865495, "body": "Yup, fair!  (Though one does see the base-class <code>equals</code> pattern in Java standard libraries, e.g. <code>AbstractList</code>)."}, {"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "reply_to_user": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1492121722, "post_id": 43402241, "comment_id": 73865580, "body": "@OliverCharlesworth Good point. This only applies to data/value classes. I&#39;ve updated my answer to clarify such. <i>Effective Java</i> also points out that there are some valid use cases of inheriting <code>equals</code>/<code>hashCode</code> from an abstract class and uses. e.g. <code>AbstractList</code>, <code>AbstractSet</code>, etc."}, {"owner": {"reputation": 17849, "user_id": 4230345, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-fWK0YfC5ong/AAAAAAAAAAI/AAAAAAAAADk/a23H1FFs8Jg/photo.jpg?sz=128", "display_name": "Farbod Salamat-Zadeh", "link": "https://stackoverflow.com/users/4230345/farbod-salamat-zadeh"}, "edited": false, "score": 0, "creation_date": 1492122126, "post_id": 43402241, "comment_id": 73865728, "body": "@mfulton26 Thank you - such a detailed answer! I&#39;ve learnt a lot more about <code>hashCode()</code> and <code>equals()</code> and the examples are helpful as well. I did read <i>Effective Java</i> a while ago, but I suppose I&#39;ve forgotten a lot of it so I may read through it again. ;)"}, {"owner": {"reputation": 30223, "user_id": 1876620, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/WyEns.jpg?s=128&g=1", "display_name": "fps", "link": "https://stackoverflow.com/users/1876620/fps"}, "edited": false, "score": 0, "creation_date": 1492124911, "post_id": 43402241, "comment_id": 73866616, "body": "Well, if you implement <code>hashCode</code> and <code>equals</code> in the abstract class properly, you would not have such a symmetry violation. For instance, if you had a <code>getClass()</code> method in Kotlin (such as the one that exists in Java), you could check in the <code>BaseItem</code>&#39;s <code>equals</code> method that the other object is of the same class as this instance, and then check the ID. No violation of any kind."}, {"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "reply_to_user": {"reputation": 30223, "user_id": 1876620, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/WyEns.jpg?s=128&g=1", "display_name": "fps", "link": "https://stackoverflow.com/users/1876620/fps"}, "edited": false, "score": 0, "creation_date": 1492126109, "post_id": 43402241, "comment_id": 73866936, "body": "@FedericoPeraltaSchaffner if you did not add any properties then yes but the moment you at a property you must sacrifice something: symmetry, transitivity, etc."}], "tags": [], "owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "is_accepted": true, "score": 2, "last_activity_date": 1492121550, "last_edit_date": 1492121550, "creation_date": 1492119997, "answer_id": 43402241, "question_id": 43401993, "link": "https://stackoverflow.com/questions/43401993/should-hashcode-return-an-objects-unique-id/43402241#43402241", "title": "Should hashCode() return an object&#39;s unique ID", "body": "<p>As your abstract <code>BaseClass</code> is for data classes (a.k.a. value classes) it should define <code>equals</code> and <code>hashCode</code> as <code>abstract</code> and force the implementing, concrete classes to implement them. e.g.:</p>\n\n<pre><code>abstract class BaseItem {\n    abstract val id: Int\n    abstract override fun equals(other: Any?): Boolean\n    abstract override fun hashCode(): Int\n}\n\ndata class Person(override val id: Int, val name: String) : BaseItem()\n\ndata class Product(\n        override val id: Int,\n        val name: String,\n        val cost: BigDecimal\n) : BaseItem()\n</code></pre>\n\n<p>Implementing these functions in the base class and not overriding them in the concrete sub-classes can lead to violations on the <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-any/equals.html\" rel=\"nofollow noreferrer\"><code>equals</code></a> &amp; <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-any/hash-code.html\" rel=\"nofollow noreferrer\"><code>hashCode</code></a> contracts.</p>\n\n<p>Here is an example of symmetry violation if you do not force sub-classes to implement <code>equals</code>/<code>hashCode</code>:</p>\n\n<pre><code>abstract class BaseItem {\n    abstract val id: Int\n    override fun equals(other: Any?) = (other is BaseItem) &amp;&amp; id == other.id\n    override fun hashCode() = id\n}\n\nclass Person(override val id: Int, val name: String) : BaseItem() {\n    override fun equals(other: Any?): Boolean {\n        return (other is Person) &amp;&amp; id == other.id &amp;&amp; name == other.name\n    }\n\n    override fun hashCode() = 31 * (31 + id.hashCode()) + name.hashCode()\n}\n\nclass Product(\n        override val id: Int,\n        val name: String,\n        val cost: BigDecimal\n) : BaseItem()\n\nfun main(args: Array&lt;String&gt;) {\n    val baseItem1: BaseItem = Person(1, \"Oliver\")\n    val baseItem2: BaseItem = Product(1, \"grease\", BigDecimal.TEN)\n    println(baseItem1 == baseItem2) // false\n    println(baseItem2 == baseItem1) // true\n}\n</code></pre>\n\n<p>If <code>equals</code>/<code>hashCode</code> were implemented according to their contracts then both equality checks would always return the same result (<code>true</code> or <code>false</code>, in this case it should be <code>false</code> as <code>Product</code> should also override these functions and check that <code>other</code> is also a <code>Product</code> and check each relevant property, etc.).</p>\n\n<p>See \"Item 8: Obey the general contract when overriding equals\" and \"Item 9: Always override hashCode when you override equals\" in <em>Effective Java, Second Edition</em> by Joshua Bloch for more details on these contracts and the problems around different approaches to hierarchical value classes.</p>\n"}], "owner": {"reputation": 17849, "user_id": 4230345, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-fWK0YfC5ong/AAAAAAAAAAI/AAAAAAAAADk/a23H1FFs8Jg/photo.jpg?sz=128", "display_name": "Farbod Salamat-Zadeh", "link": "https://stackoverflow.com/users/4230345/farbod-salamat-zadeh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1678, "favorite_count": 0, "accepted_answer_id": 43402241, "answer_count": 1, "score": 3, "last_activity_date": 1492121550, "creation_date": 1492118838, "question_id": 43401993, "link": "https://stackoverflow.com/questions/43401993/should-hashcode-return-an-objects-unique-id", "title": "Should hashCode() return an object&#39;s unique ID", "body": "<p>In my Kotlin/Java project, I have written some model classes that inherit an abstract class <code>BaseItem</code>:</p>\n\n<pre><code>/**\n * All data model classes should implement this\n */\nabstract class BaseItem {\n\n    /**\n     * A unique integer identifier used to represent the data item in the database.\n     */\n    abstract val id: Int\n\n    override fun equals(other: Any?) = (other is BaseItem) &amp;&amp; id == other.id\n\n}\n</code></pre>\n\n<p>These model classes will be used to represent data from a database. In the database, there is an ID column that contains unique integer identifiers.</p>\n\n<p>So when I use the model classes, it is guaranteed that the <code>id</code> property of each will unique.</p>\n\n<p>After reading this the Java specification for <code>hashCode()</code>:</p>\n\n<blockquote>\n  <ul>\n  <li>Whenever it is invoked on the same object more than once during an execution of an application, the <code>hashCode</code> method must consistently return the same integer, provided no information used in equals comparisons on the object is modified. This integer need not remain consistent from one execution of an application to another execution of the same application. </li>\n  <li>If two objects are equal according to the <code>equals(Object)</code> method, then calling the <code>hashCode</code> method on each of the two objects must produce the same integer result. </li>\n  <li>It is not required that if two objects are unequal according to the <code>equals(Object)</code> method, then calling the <code>hashCode</code> method on each of the two objects must produce distinct integer results. However, the programmer should be aware that producing distinct integer results for unequal objects may improve the performance of hash tables.</li>\n  </ul>\n</blockquote>\n\n<p>My question is:</p>\n\n<p><strong>Is it good practice to return this unique identifier in <code>hashCode()</code>?</strong></p>\n\n<p><em>Note: I am aware that in Kotlin, we can use <a href=\"https://kotlinlang.org/docs/reference/data-classes.html\" rel=\"nofollow noreferrer\"><code>data</code> classes</a> so that the compiler automatically derives predefined members like <code>equals()</code>, <code>hashCode()</code>, <code>toString()</code>, etc, but <code>abstract</code> classes cannot be <code>data</code> classes. (However, I could make subclasses of <code>BaseItem</code> <code>data</code> classes - I'm not sure whether or not this would be the better option for this use case).</em></p>\n"}, {"tags": ["kotlin"], "comments": [{"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "edited": false, "score": 6, "creation_date": 1492098753, "post_id": 43396499, "comment_id": 73854350, "body": "One case that comes to my mind is: when there&#39;s a property of a functional type, say <code>foo: (T) -&gt; R</code>, without <code>::</code> it would be confusing/ambigous whether you want to use value of <code>foo</code> or make a callable reference of <code>foo</code>."}, {"owner": {"reputation": 68863, "user_id": 4465208, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/w14F6.png?s=128&g=1", "display_name": "zsmb13", "link": "https://stackoverflow.com/users/4465208/zsmb13"}, "edited": false, "score": 2, "creation_date": 1492099045, "post_id": 43396499, "comment_id": 73854526, "body": "Adding to that: it also lets you have a function and a property with the same name in the same scope that you can refer to unambiguously, and it resembles Java&#39;s syntax for referencing methods."}, {"owner": {"reputation": 2732, "user_id": 3009822, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/HslzA.jpg?s=128&g=1", "display_name": "Yudhistira Arya", "link": "https://stackoverflow.com/users/3009822/yudhistira-arya"}, "reply_to_user": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "edited": false, "score": 0, "creation_date": 1492099306, "post_id": 43396499, "comment_id": 73854670, "body": "@hotkey I&#39;m a bit lost, if you have a property of <code>foo: (T) -&gt; R</code>, would a call to <code>foo</code> will just be translated to <code>getFoo()</code> and return the function? Which essentially the same with <code>::foo</code>? Please excuse my ignorance..."}, {"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "edited": false, "score": 1, "creation_date": 1492100519, "post_id": 43396499, "comment_id": 73855427, "body": "@YudhistiraArya, <code>::foo</code> means a callable reference of that property: you can call it and get its value -- that is, the function that you normally get as <code>foo</code>."}, {"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "edited": false, "score": 1, "creation_date": 1492100854, "post_id": 43396499, "comment_id": 73855615, "body": "@YudhistiraArya, here&#39;s what I&#39;m talking about: <a href=\"https://try.kotlinlang.org/#/UserProjects/kpteq5gg5q9b4shs4ek4dich33/bnef7upvvfbf5h88b4l4t456s7\" rel=\"nofollow noreferrer\">(demo)</a>"}, {"owner": {"reputation": 2732, "user_id": 3009822, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/HslzA.jpg?s=128&g=1", "display_name": "Yudhistira Arya", "link": "https://stackoverflow.com/users/3009822/yudhistira-arya"}, "reply_to_user": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "edited": false, "score": 0, "creation_date": 1492130599, "post_id": 43396499, "comment_id": 73867920, "body": "@hotkey thanks for the example!"}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1492351506, "post_id": 43396499, "comment_id": 73933049, "body": "@YudhistiraArya the answer you marked as Accepted is not correct at all and is a misunderstanding of this situation.  This will mislead others in the future."}], "answers": [{"comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1492351271, "post_id": 43399092, "comment_id": 73932976, "body": "This answer is incorrect.  Namespaces is not in play here at all, and this is a complete misunderstanding of the issue and why the code above works in this case.  See answer below about why this answer is wrong and misleading."}, {"owner": {"reputation": 177928, "user_id": 1103872, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/84b1acc3351c02f560dea7ac7f76ac8d?s=128&d=identicon&r=PG", "display_name": "Marko Topolnik", "link": "https://stackoverflow.com/users/1103872/marko-topolnik"}, "edited": false, "score": 0, "creation_date": 1573500555, "post_id": 43399092, "comment_id": 103894538, "body": "I find this answer as enlightening as the other one. There is no single &quot;because&quot; here, many forces are pulling the syntax this way or that."}], "tags": [], "owner": {"reputation": 3397, "user_id": 574826, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jvb1q.jpg?s=128&g=1", "display_name": "pdpi", "link": "https://stackoverflow.com/users/574826/pdpi"}, "is_accepted": false, "score": 7, "last_activity_date": 1492107196, "creation_date": 1492107196, "answer_id": 43399092, "question_id": 43396499, "link": "https://stackoverflow.com/questions/43396499/why-does-kotlin-need-function-reference-syntax/43399092#43399092", "title": "Why does Kotlin need function reference syntax?", "body": "<p>Because Java (and, therefore, Kotlin) uses separate namespaces for fields and methods, you need <code>::</code> to avoid ambiguities. Example:</p>\n\n<pre><code>val isOdd : (Int) -&gt; Boolean = { x -&gt; x % 2 != 0 }\nfun isOdd(x: Int): Boolean {\n    return x % 2 != 0\n}\n\nval odds = listOf(1,2,3).filter(isOdd) // uses the val version\nval otherOdds = listOf(1,2,3).filter(::isOdd) // uses the fun version\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 490, "user_id": 4266826, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tq1ql.png?s=128&g=1", "display_name": "Drew Nutter", "link": "https://stackoverflow.com/users/4266826/drew-nutter"}, "edited": false, "score": 1, "creation_date": 1573082932, "post_id": 43437882, "comment_id": 103769684, "body": "The problem you describe is not solved by references since references themselves are callable: <code>val newIsOdd = ::isOdd</code> allows <code>newIsOdd()</code> and <code>newIsOdd</code>. I don&#39;t even see this as a problem personally. But now we have a much more confusing problem: there are two types of functions, both of which are callable, but they can only be passed around <i>sometimes</i>. Consistency would be clearer. Either the two kinds of functions should have discrete syntaxes (like java) or there should only be one kind (like python), not a half-assed inconsistent middle ground."}], "tags": [], "owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "is_accepted": true, "score": 8, "last_activity_date": 1573500056, "last_edit_date": 1573500056, "creation_date": 1492350173, "answer_id": 43437882, "question_id": 43396499, "link": "https://stackoverflow.com/questions/43396499/why-does-kotlin-need-function-reference-syntax/43437882#43437882", "title": "Why does Kotlin need function reference syntax?", "body": "<p>Kotlin language design tries to avoid ambiguous situations where some absence of something could be both correct and incorrect syntax at the same time.  For example if you allowed the proposed syntax:</p>\n\n<pre><code>isOdd     // error, function invocation expected isOdd(...)\nisOdd     // not error, you have a function reference\n</code></pre>\n\n<p>The <code>::</code> is a clear signal as to the intent.  Because of this, you get only an error in the <code>isOdd</code> case because you now have possibilities that do not overlap:</p>\n\n<pre><code>isOdd      // error, function invocation expected isOdd(...)\n::isOdd    // function reference\nisOdd()    // error, missing parameter x\nisOdd(x)   // function call\n</code></pre>\n\n<p>This is why Kotlin avoids things that lead to ambiguous states.  Your eyes can also quickly pick up the problem, just as the IDE and static analysis can, just as the compiler does.  If you start allowing this looser syntax you will start running into compounded ambiguities such as when using as infix functions and so on.  Language design is more complicated than \"oh, let's make them type less characters\" because the complexity matrix is much larger than you imagine if you only look at one use case ignoring all the others.</p>\n"}], "owner": {"reputation": 2732, "user_id": 3009822, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/HslzA.jpg?s=128&g=1", "display_name": "Yudhistira Arya", "link": "https://stackoverflow.com/users/3009822/yudhistira-arya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3704, "favorite_count": 0, "accepted_answer_id": 43437882, "answer_count": 2, "score": 11, "last_activity_date": 1573500056, "creation_date": 1492097980, "last_edit_date": 1502350674, "question_id": 43396499, "link": "https://stackoverflow.com/questions/43396499/why-does-kotlin-need-function-reference-syntax", "title": "Why does Kotlin need function reference syntax?", "body": "<p>Kotlin docs stated that it supports <a href=\"https://kotlinlang.org/docs/reference/lambdas.html\" rel=\"noreferrer\">higher-order functions</a>. Why would the language even need a <code>::function</code> syntax when passing a top level function as an argument? </p>\n\n<p>Given: </p>\n\n<pre><code>fun isOdd(x: Int) = x % 2 != 0\nval numbers = listOf(1, 2, 3)\nprintln(numbers.filter(::isOdd)) // here.\n</code></pre>\n\n<p>Why not just</p>\n\n<pre><code>fun isOdd(x: Int) = x % 2 != 0\nval numbers = listOf(1, 2, 3)\nprintln(numbers.filter(isOdd)) // simple and makes more sense\n</code></pre>\n\n<p>More on the <a href=\"https://kotlinlang.org/docs/reference/reflection.html#function-references\" rel=\"noreferrer\">function reference syntax here</a>.</p>\n"}, {"tags": ["kotlin"], "answers": [{"tags": [], "owner": {"reputation": 4319, "user_id": 4874829, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cfECAGc8huU/AAAAAAAAAAI/AAAAAAAAAJk/Pebw5H-quLo/photo.jpg?sz=128", "display_name": "Yoav Sternberg", "link": "https://stackoverflow.com/users/4874829/yoav-sternberg"}, "is_accepted": true, "score": 12, "last_activity_date": 1567774114, "last_edit_date": 1567774114, "creation_date": 1492084283, "answer_id": 43391565, "question_id": 43389976, "link": "https://stackoverflow.com/questions/43389976/property-type-is-not-a-type-of-overriden/43391565#43391565", "title": "Property type is not a type of overriden", "body": "<p><code>repository</code> is a <code>var</code> field. Since <code>UserRepositoryTest</code> can be referred as <code>RepositoryTest&lt;User, Long&gt;</code>, you should be able to assign <code>Repository&lt;User, Long&gt;</code> to the <code>repository</code> field. However, it does not have to be a <code>UserRepository</code>, hence the error.</p>\n\n<p>Changing <code>repository</code>to <code>val</code> in <code>RepositoryTest</code> class should fix it.</p>\n"}], "owner": {"reputation": 3822, "user_id": 4725496, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/BYQOo.jpg?s=128&g=1", "display_name": "Feeco", "link": "https://stackoverflow.com/users/4725496/feeco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1187, "favorite_count": 0, "accepted_answer_id": 43391565, "answer_count": 1, "score": 6, "last_activity_date": 1567774114, "creation_date": 1492079760, "question_id": 43389976, "link": "https://stackoverflow.com/questions/43389976/property-type-is-not-a-type-of-overriden", "title": "Property type is not a type of overriden", "body": "<p>Sorry for not specific title, I don't really know how to name it better.<br>\nI have the following example:</p>\n\n<pre><code>class User\n\ninterface Repository&lt;T, ID&gt;\n\ninterface UserRepository : Repository&lt;User, Long&gt;\n\nabstract class RepositoryTest&lt;T, ID&gt; {\n\n    abstract var repository: Repository&lt;T, ID&gt;\n\n}\n\nclass UserRepositoryTest : RepositoryTest&lt;User, Long&gt;() {\n\n    //Error: Var-property type is \"UserRepository\", which is not a type of overriden \n    lateinit override var repository: UserRepository\n\n}\n</code></pre>\n\n<p>I need this architecture for the database testing. <code>Repository</code> have methods like insert, save, delete etc. I want to use this abstraction in <code>RepositoryTest</code> to delete all entries and insert needed data before each test. In <code>UserRepositoryTest</code> I want to specify the repository as <code>UserRepository</code> (it's a child of <code>Repository</code>), but I take an error mentioned in the example.<br>Why it gives me the error? I thought I can pass a subtype`s type.    </p>\n"}, {"tags": ["java", "kotlin", "higher-order-functions", "overload-resolution"], "answers": [{"tags": [], "owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "is_accepted": false, "score": 1, "last_activity_date": 1492438748, "last_edit_date": 1492438748, "creation_date": 1492080100, "answer_id": 43390093, "question_id": 43389783, "link": "https://stackoverflow.com/questions/43389783/how-to-call-kotlin-method-with-more-than-one-similar-signature-with-lambda/43390093#43390093", "title": "How to call Kotlin method with more than one similar signature with lambda?", "body": "<p>You can fix the calling code in Kotlin: you are passing a lambda with one argument <code>{ tx -&gt; doSomething() }</code>, but a lambda with receiver and no arguments is expected there.</p>\n\n<p>Compare: <code>(Refactor) -&gt; Unit</code> is the <a href=\"https://kotlinlang.org/docs/reference/lambdas.html#function-types\" rel=\"nofollow noreferrer\">type for a function</a> with one argument, while <code>Refactor.() -&gt; Unit</code> means a <a href=\"http://Refactor.()%20-%3E%20Unit\" rel=\"nofollow noreferrer\">function with receiver</a>, which takes no arguments and instead is passed a receiver (<code>this</code>) of type <code>Refactor</code>. These types are sometimes interchangeable, but lambdas are not converted between them implicitly.</p>\n\n<p>So, you can call <code>refactor</code> it as follows:</p>\n\n<pre><code>val unit: CompilationUnit = ...\nunit.refactor {\n   doSomeThing() // this code can also work with `this` of type `Refactor`\n}\n</code></pre>\n\n<p>Alternatively, to call the overload with <code>Consumer&lt;Refactor&gt;</code>, you can explicitly specify that:</p>\n\n<pre><code>unit.refactor(Consumer { tx -&gt; doSomething() })\n</code></pre>\n\n<p>Implicit <a href=\"https://kotlinlang.org/docs/reference/java-interop.html#sam-conversions\" rel=\"nofollow noreferrer\">SAM conversion</a> is, apparently, not available because there are several overloads with functional parameters.</p>\n"}], "owner": {"reputation": 521, "user_id": 4188345, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-tqR_wL3duSw/AAAAAAAAAAI/AAAAAAAAABQ/ga2O-c9eEVw/photo.jpg?sz=128", "display_name": "foxundermon", "link": "https://stackoverflow.com/users/4188345/foxundermon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1492438748, "creation_date": 1492079221, "last_edit_date": 1492080968, "question_id": 43389783, "link": "https://stackoverflow.com/questions/43389783/how-to-call-kotlin-method-with-more-than-one-similar-signature-with-lambda", "title": "How to call Kotlin method with more than one similar signature with lambda?", "body": "<p>I am using some code from this library: <a href=\"https://github.com/Netflix-Skunkworks/rewrite\" rel=\"nofollow noreferrer\">https://github.com/Netflix-Skunkworks/rewrite</a></p>\n\n<p>When I call one of its methods, I encounter an IDE error:</p>\n\n<blockquote>\n  <p>None of the following functions can be called with the arguments supplied.</p>\n</blockquote>\n\n<p>The target method has two similar signatures:</p>\n\n<pre><code>data class CompilationUnit(...){\n\n    fun refactor() = Refactor(this)\n\n    fun refactor(ops: Refactor.() -&gt; Unit): Refactor {\n        val r = refactor()\n        ops(r)\n        return r\n    }\n\n    fun refactor(ops: Consumer&lt;Refactor&gt;): Refactor {\n        val r = refactor()\n        ops.accept(r)\n        return r\n    }\n}\n</code></pre>\n\n<p>The calling code in Kotlin:</p>\n\n<pre><code>val unit: CompilationUnit =...\nunit.refactor{ tx -&gt;\n   doSomeThing()\n}\n</code></pre>\n\n<p>And this call with lambda is OK in Java:</p>\n\n<pre><code>CompilationUnit unit = ....\nunit.refactor(tx -&gt; {\n    doSomeThing()\n});\n</code></pre>\n"}, {"tags": ["generics", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 279, "user_id": 5981797, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qhK17uDO3NE/AAAAAAAAAAI/AAAAAAAABWI/H9x213QWPhI/photo.jpg?sz=128", "display_name": "gmariotti", "link": "https://stackoverflow.com/users/5981797/gmariotti"}, "edited": false, "score": 0, "creation_date": 1492084526, "post_id": 43388405, "comment_id": 73844054, "body": "Thanks for the clarification, but how should I change the signature of <code>Job.addMultipleNamedOutput</code> in order to make possible (1)? Because for now it accepts only (2), while for (1) it complains for the missing Key and Value."}, {"owner": {"reputation": 5305, "user_id": 5818889, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b8df2f6af3fd32042982001fac8407b?s=128&d=identicon&r=PG&f=1", "display_name": "glee8e", "link": "https://stackoverflow.com/users/5818889/glee8e"}, "reply_to_user": {"reputation": 279, "user_id": 5981797, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qhK17uDO3NE/AAAAAAAAAAI/AAAAAAAABWI/H9x213QWPhI/photo.jpg?sz=128", "display_name": "gmariotti", "link": "https://stackoverflow.com/users/5981797/gmariotti"}, "edited": false, "score": 0, "creation_date": 1492085532, "post_id": 43388405, "comment_id": 73844799, "body": "sorry, I&#39;ve made a mistake. I&#39;m terribly sorry for that."}], "tags": [], "owner": {"reputation": 5305, "user_id": 5818889, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b8df2f6af3fd32042982001fac8407b?s=128&d=identicon&r=PG&f=1", "display_name": "glee8e", "link": "https://stackoverflow.com/users/5818889/glee8e"}, "is_accepted": true, "score": 2, "last_activity_date": 1492085492, "last_edit_date": 1492085492, "creation_date": 1492075522, "answer_id": 43388405, "question_id": 43385904, "link": "https://stackoverflow.com/questions/43385904/understand-how-reified-and-wildcards-work-in-kotlin/43388405#43388405", "title": "Understand how reified and wildcards work in Kotlin", "body": "<p>It's all about raw types, which kotlin doesn't allow.</p>\n\n<p>This format works:</p>\n\n<pre><code>addMultipleNamedOutput&lt;TextOutputFormat&lt;Text, SensorData&gt;, Text, SensorData&gt;(HIGH_TEMP) //(1)\n</code></pre>\n\n<p>These two don't:</p>\n\n<pre><code>addMultipleNamedOutput&lt;TextOutputFormat, Text, SensorData&gt;(HIGH_TEMP) //(2)\n</code></pre>\n\n<p>So things get clear now. <code>TextOutputFormat</code> is illegal because Kotlin doesn't allow raw types. You have to specify the type arguments, which is missing in (2). Adding them result in format (1). </p>\n\n<p>This looks a bit verbose, but there is currently no workaround (at least IMHO).</p>\n"}], "owner": {"reputation": 279, "user_id": 5981797, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qhK17uDO3NE/AAAAAAAAAAI/AAAAAAAABWI/H9x213QWPhI/photo.jpg?sz=128", "display_name": "gmariotti", "link": "https://stackoverflow.com/users/5981797/gmariotti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 1, "accepted_answer_id": 43388405, "answer_count": 1, "score": 0, "last_activity_date": 1492085492, "creation_date": 1492067914, "last_edit_date": 1492083880, "question_id": 43385904, "link": "https://stackoverflow.com/questions/43385904/understand-how-reified-and-wildcards-work-in-kotlin", "title": "Understand how reified and wildcards work in Kotlin", "body": "<p>I'm sorry if the title of the question is not really significant, but I haven't found a better way to describe this problem.</p>\n\n<p>I'm writing some Kotlin extension methods for Hadoop, and yesterday I encounted a strange error that I don't understand. I wrote a couple of extension methods like this:</p>\n\n<pre><code>inline fun &lt;reified T : InputFormat&lt;*, *&gt;, reified K : Mapper&lt;*, *, *, *&gt;&gt; Job.addMultipleInputPath(path: Path) {\n  MultipleInputs.addInputPath(this, path, T::class.java, K::class.java)\n}\n\ninline fun &lt;reified T : OutputFormat&lt;*, *&gt;, reified Key : Any, reified Value : Any&gt; Job.addMultipleNamedOutput(namedOutput: String) {\n  MultipleOutputs.addNamedOutput(this, namedOutput, T::class.java, Key::class.java, Value::class.java)\n}\n\ninline fun &lt;reified T : Mapper&lt;*, *, KeyClass, ValueClass&gt;, reified KeyClass : Any, reified ValueClass : Any&gt; Job.setMapper() {\n  this.setMapperClass&lt;T&gt;()\n  this.mapOutput&lt;KeyClass, ValueClass&gt;()\n}\n</code></pre>\n\n<p>An if I try to call them in my Driver class, (1) and (3) work but (2) gives me a compile error:</p>\n\n<pre><code>with(Job.getInstance()) {\n  // works\n  addMultipleInputPath&lt;TextInputFormat, SensorsMapperType2&gt;(secInput)\n\n  // 2 type arguments expected for class TextOutputFormat&lt;K: Any!, V: Any!&gt; : FileOutputFormat&lt;K!, V!&gt; \n  // defined in org.apache.hadoop.mapreduce.lib.output\n  addMultipleNamedOutput&lt;TextOutputFormat, Text, SensorData&gt;(HIGH_TEMP)\n\n  // works\n  setMapper&lt;NGramMapper, Text, IntWritable&gt;()\n}\n</code></pre>\n\n<p>If I correct the call using <code>&lt;TextOutputFormat&lt;Any, Any&gt;&gt;</code> everything works fine, but I don't understand why this happens. Is there something that I'm missing on how reified and generics work in Kotlin?</p>\n"}, {"tags": ["gradle", "groovy", "kotlin", "pact"], "answers": [{"comments": [{"owner": {"reputation": 937, "user_id": 1322966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c2c8cdc39e886e80b89b2c9a853448c?s=128&d=identicon&r=PG", "display_name": "Kazuaki", "link": "https://stackoverflow.com/users/1322966/kazuaki"}, "edited": false, "score": 0, "creation_date": 1492051547, "post_id": 43382150, "comment_id": 73827294, "body": "What is the relevance of the <code>String</code> parameter to <code>hasPactsWith</code>?"}, {"owner": {"reputation": 937, "user_id": 1322966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c2c8cdc39e886e80b89b2c9a853448c?s=128&d=identicon&r=PG", "display_name": "Kazuaki", "link": "https://stackoverflow.com/users/1322966/kazuaki"}, "edited": false, "score": 0, "creation_date": 1492052120, "post_id": 43382150, "comment_id": 73827406, "body": "Maybe there could be a more specific error if no Pact files are found, too? :3"}, {"owner": {"reputation": 829, "user_id": 7038809, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ESGg4xbxRZ4/AAAAAAAAAAI/AAAAAAAAAug/gcy2PPUXC-A/photo.jpg?sz=128", "display_name": "Ronald Holshausen", "link": "https://stackoverflow.com/users/7038809/ronald-holshausen"}, "reply_to_user": {"reputation": 937, "user_id": 1322966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c2c8cdc39e886e80b89b2c9a853448c?s=128&d=identicon&r=PG", "display_name": "Kazuaki", "link": "https://stackoverflow.com/users/1322966/kazuaki"}, "edited": false, "score": 1, "creation_date": 1492063716, "post_id": 43382150, "comment_id": 73830942, "body": "The <code>String</code> parameter to <code>hasPactsWith</code> has no effect. It was initially put in to provide some type of grouping of consumers."}], "tags": [], "owner": {"reputation": 829, "user_id": 7038809, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ESGg4xbxRZ4/AAAAAAAAAAI/AAAAAAAAAug/gcy2PPUXC-A/photo.jpg?sz=128", "display_name": "Ronald Holshausen", "link": "https://stackoverflow.com/users/7038809/ronald-holshausen"}, "is_accepted": true, "score": 3, "last_activity_date": 1492047274, "creation_date": 1492047274, "answer_id": 43382150, "question_id": 43381910, "link": "https://stackoverflow.com/questions/43381910/provider-pactverify-isnt-picking-up-json-pact-file/43382150#43382150", "title": "Provider pactVerify isn&#39;t picking up JSON Pact file", "body": "<p>You are getting that warning because you have not told the pact plugin where to find the pact files. For pacts in a directory, add the following:</p>\n\n<pre><code>pact {\n  serviceProviders {\n    'Coffee Ordering Provider' {\n      port = 8080\n\n      startProviderTask = startProvider\n      terminateProviderTask = stopProvider\n      stateChangeUrl = url('http://localhost:8080/pactStateChange')\n\n      hasPactsWith('Coffee Ordering Consumers') {\n\n          // Will define a consumer for each pact file in the directory.\n          // Consumer name is read from contents of pact file\n          pactFileLocation = file(\"$buildDir/pacts\")\n\n      }\n    }\n  }\n}\n</code></pre>\n\n<p>Just a note that you were setting the <code>pact.rootDir</code> for all tests, but the pact verification does not run as a test.</p>\n"}], "owner": {"reputation": 937, "user_id": 1322966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c2c8cdc39e886e80b89b2c9a853448c?s=128&d=identicon&r=PG", "display_name": "Kazuaki", "link": "https://stackoverflow.com/users/1322966/kazuaki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 802, "favorite_count": 0, "accepted_answer_id": 43382150, "answer_count": 1, "score": 0, "last_activity_date": 1492047274, "creation_date": 1492045200, "question_id": 43381910, "link": "https://stackoverflow.com/questions/43381910/provider-pactverify-isnt-picking-up-json-pact-file", "title": "Provider pactVerify isn&#39;t picking up JSON Pact file", "body": "<p>I have two projects in the same repo, with completely separate directory structures (consumer in <code>/test-consumer</code>, provider in <code>/app</code>).</p>\n\n<p>The consumer check outputs a JSON Pact file in <code>/test-consumer/build/pacts</code>, as expected by</p>\n\n<pre><code>dependencies { test { systemProperties['pact.rootDir'] = \"$buildDir/pacts\" } }\n</code></pre>\n\n<p>I then copy the file into <code>/app/build/pacts/</code>, and put this same <code>systemProperties</code> line into my provider's <code>build.gradle</code>.</p>\n\n<p>The sample project that I'm plagiarising from is using a Pact broker, so I guessed I can take that out, and replace it with the <code>rootDir</code>, but it's not working. This is what I get:</p>\n\n<blockquote>\n  <p><code>WARNING: There are no consumers to verify for provider 'Coffee Ordering Provider'</code></p>\n</blockquote>\n\n<p>So, it seems like it's finding the Pact files, but can't find a provider+consumer pair in any of them.</p>\n\n<p><strong>TL;DR:\nWhat am I doing wrong?</strong></p>\n\n<p>Here are some code bits to help:</p>\n\n<pre><code>dependencies {\n  ...\n  test { systemProperties['pact.rootDir'] = \"$buildDir/pacts\" }\n}\n\npact {\n  serviceProviders {\n    'Coffee Ordering Provider' {\n      port = 8080\n\n      startProviderTask = startProvider\n      terminateProviderTask = stopProvider\n      stateChangeUrl = url('http://localhost:8080/pactStateChange')\n    }\n  }\n}\n</code></pre>\n"}]