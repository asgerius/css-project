[{"tags": ["kotlin"], "answers": [{"tags": [], "owner": {"reputation": 1023, "user_id": 450110, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9d4006a80c81c9d47fa06d7dbb18ccf0?s=128&d=identicon&r=PG", "display_name": "naixx", "link": "https://stackoverflow.com/users/450110/naixx"}, "is_accepted": false, "score": 0, "last_activity_date": 1424941644, "last_edit_date": 1424941644, "creation_date": 1424853609, "answer_id": 28714534, "question_id": 28709112, "link": "https://stackoverflow.com/questions/28709112/is-there-an-instanciable-mutablelist-in-kotlin-avoiding-java-api/28714534#28714534", "title": "Is there an instanciable MutableList in Kotlin, avoiding java api?", "body": "<p>You are right, java collections are the only way to get <code>MutableList</code></p>\n"}, {"comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 6, "creation_date": 1451702530, "post_id": 28716124, "comment_id": 56867874, "body": "It would be nice if this, the accepted answer, explained this a bit more.  That <code>List</code> and <code>Mutable</code> list are a bit of Kotlin magic.  And that all Java <code>List</code> implementations are both Kotlin <code>List</code> and <code>MutableList</code> including <code>ArrayList</code> and <code>LinkedList</code> along with other custom implementations.  Kotlin has helper functions to create lists more easily as shown in this answer.  Other helpers such as <code>listOf</code> return the read only list interface <code>List</code> instead of the mutable interface.  THe ones in the answer return the <code>MutableLis</code> interface."}, {"owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "edited": false, "score": 1, "creation_date": 1463452378, "post_id": 28716124, "comment_id": 62059084, "body": "<code>linkedListOf</code> is gone before 1.0. There is more generic <code>mutableListOf</code> available instead."}, {"owner": {"reputation": 2988, "user_id": 1507512, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/5EsQG.jpg?s=128&g=1", "display_name": "Massimo", "link": "https://stackoverflow.com/users/1507512/massimo"}, "edited": false, "score": 0, "creation_date": 1484840879, "post_id": 28716124, "comment_id": 70684738, "body": "they are only shortcuts, mutableListOf simply returns an ArrayList (which is mutable); listOf is an alternative to call Arrays.asList (which is immutable)"}], "tags": [], "owner": {"reputation": 6493, "user_id": 1020900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab5f80978d59af0204e0986ca41d2c23?s=128&d=identicon&r=PG", "display_name": "bashor", "link": "https://stackoverflow.com/users/1020900/bashor"}, "is_accepted": true, "score": 27, "last_activity_date": 1463479339, "last_edit_date": 1463479339, "creation_date": 1424858779, "answer_id": 28716124, "question_id": 28709112, "link": "https://stackoverflow.com/questions/28709112/is-there-an-instanciable-mutablelist-in-kotlin-avoiding-java-api/28716124#28716124", "title": "Is there an instanciable MutableList in Kotlin, avoiding java api?", "body": "<p>Try to use <code>mutableListOf</code> or <code>arrayListOf</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2952, "user_id": 4413098, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5a944fcc2691378e0c49b5c564bd55d2?s=128&d=identicon&r=PG&f=1", "display_name": "mightyWOZ", "link": "https://stackoverflow.com/users/4413098/mightywoz"}, "is_accepted": false, "score": 0, "last_activity_date": 1578935233, "last_edit_date": 1578935233, "creation_date": 1578933912, "answer_id": 59720730, "question_id": 28709112, "link": "https://stackoverflow.com/questions/28709112/is-there-an-instanciable-mutablelist-in-kotlin-avoiding-java-api/59720730#59720730", "title": "Is there an instanciable MutableList in Kotlin, avoiding java api?", "body": "<p>No, as far as Collections are concerned you can not avoid java API's, Because every kotlin collection uses corresponding java collection in one way or another. </p>\n\n<p><strong><em>Kotlin collection interfaces are just mock interfaces</em></strong>, they don't really exist at runtime. So even if you had a class implementing some kotlin collection interface(ex. <code>MutableList</code>) at runtime it would use corresponding java interface.</p>\n\n<p>for example let's write two kotlin classes implementing kotlin's <code>List</code> and <code>MutableList</code> interfaces respectively</p>\n\n<pre><code>abstract class KotlinList : List&lt;Int&gt;\n\nabstract class KotlinMutableList : MutableList&lt;Int&gt;\n</code></pre>\n\n<p>when you decompile these classes their signature's change as following (heads up, byte code ahead)</p>\n\n<pre><code>public abstract class com/example/kotlin/KotlinList implements java/util/List kotlin/jvm/internal/markers/KMappedMarker\n\npublic abstract class com/example/kotlin/KotlinMutableList implements java/util/List kotlin/jvm/internal/markers/KMutableList\n</code></pre>\n\n<p>Now both the classes implement <code>java.util.List</code> interface and they also implement  <code>kotlin.jvm.internal.markers.KMappedMarker</code> and <code>kotlin.jvm.internal.markers.KMutableList</code> interfaces respectively, so as you can see kotlin interfaces has disappeared and we are left with same old java <code>List</code> and your methods calls will now be addresses as java.util.List.someMethod and not with some kotlin interface. <code>KMutableList</code> and <code>KMappedMarker</code> as their name suggests are <a href=\"https://stackoverflow.com/questions/25850328/marker-interfaces-in-java\">marker</a> interfaces used by the  the compiler.</p>\n\n<p>In case of <code>KotlinList</code> class if you look inside you will see all mutater methods of <code>java.util.List</code> are generated for you and look similar to the one below</p>\n\n<pre><code>   public boolean add(int var1) {\n      throw new UnsupportedOperationException(\"Operation is not supported for read-only collection\");\n   }\n</code></pre>\n\n<p>So as you can see there is no way of avoiding java API's, because they are the foundation of kotlin's collections.</p>\n"}], "owner": {"reputation": 1819, "user_id": 2779871, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/noisZ.png?s=128&g=1", "display_name": "Jules Sam. Randolph", "link": "https://stackoverflow.com/users/2779871/jules-sam-randolph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4982, "favorite_count": 3, "accepted_answer_id": 28716124, "answer_count": 3, "score": 20, "last_activity_date": 1578935233, "creation_date": 1424824692, "last_edit_date": 1463454987, "question_id": 28709112, "link": "https://stackoverflow.com/questions/28709112/is-there-an-instanciable-mutablelist-in-kotlin-avoiding-java-api", "title": "Is there an instanciable MutableList in Kotlin, avoiding java api?", "body": "<p><code>MutableList</code> is an <strong>interface</strong>, but I cannot find a <strong>class</strong> in <code>kotlin</code> package that implements it explicitly. Is there any? Furthermore, I would have expected to be a package-scope defined <em>mutableListOf(varargs)</em> symetrically to <em>listOf(varargs)</em>. Up until now, I have to use java Collections.</p>\n"}, {"tags": ["kotlin"], "answers": [{"tags": [], "owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "is_accepted": true, "score": 2, "last_activity_date": 1424988269, "creation_date": 1424988269, "answer_id": 28753650, "question_id": 28701064, "link": "https://stackoverflow.com/questions/28701064/can-javascript-generated-from-kotlin-sources-be-used-back-in-jvm/28753650#28753650", "title": "Can javascript generated from Kotlin sources be used back in JVM?", "body": "<p>The current implementation of Kotlin does not have any support for invoking Java methods from JS-generated code. This could in theory be accomplished using Nashorn, but we (the Kotlin team) do not currently have any plans to work on that. If you're interested, you're welcome to contribute, but this would be a fairly long and difficult project.</p>\n"}], "owner": {"reputation": 1214, "user_id": 343846, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/3bb9588b8e025e863cc50e9dc1f189f9?s=128&d=identicon&r=PG", "display_name": "guai", "link": "https://stackoverflow.com/users/343846/guai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 28753650, "answer_count": 1, "score": 1, "last_activity_date": 1424988269, "creation_date": 1424795262, "question_id": 28701064, "link": "https://stackoverflow.com/questions/28701064/can-javascript-generated-from-kotlin-sources-be-used-back-in-jvm", "title": "Can javascript generated from Kotlin sources be used back in JVM?", "body": "<p>Is it possible to use js generated from Kotlin sources in JVM to manipulate java objects and its own js objects?<br>\nKinda create dynamic environment for development in distributed environment.\nSo new versions of classes can be dynamically loaded/modified on running remote servers while development. And then after it's done release versions to be compiled statically for max performance.<br>\nHow hard would it be to implement?</p>\n"}, {"tags": ["junit", "jmockit", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 14611, "user_id": 468311, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh3.googleusercontent.com/-R2kbPXmZbho/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jKxaTxYHTYxiImqnqvR0jJmhDlaw/mo/photo.jpg?sz=128", "display_name": "Igor Filippov", "link": "https://stackoverflow.com/users/468311/igor-filippov"}, "edited": false, "score": 1, "creation_date": 1450693667, "post_id": 28699883, "comment_id": 56528195, "body": "&gt;I would rather stick with Java (which continues to evolve - see Java 8) Just want to note that this isn&#39;t true on Android."}, {"owner": {"reputation": 3321, "user_id": 2323964, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/e348b1e9034b66bcd141fe0e65eacb83?s=128&d=identicon&r=PG&f=1", "display_name": "Novaterata", "link": "https://stackoverflow.com/users/2323964/novaterata"}, "reply_to_user": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1515522013, "post_id": 28699883, "comment_id": 83328387, "body": "@JaysonMinard Rogerio is the author of jmockit"}], "tags": [], "owner": {"reputation": 15221, "user_id": 2326914, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5be766827c5f7d3c077e92f75b7f9104?s=128&d=identicon&r=PG", "display_name": "Rog&#233;rio", "link": "https://stackoverflow.com/users/2326914/rog%c3%a9rio"}, "is_accepted": false, "score": 3, "last_activity_date": 1424792095, "creation_date": 1424792095, "answer_id": 28699883, "question_id": 28696399, "link": "https://stackoverflow.com/questions/28696399/using-kotlin-with-jmockit/28699883#28699883", "title": "Using kotlin with jmockit", "body": "<p>I don't think you'll be able to use JMockit from Kotlin (or most other JVM alternative languages, with the possible exception of Groovy), not reliably anyway. </p>\n\n<p>The reasons are that 1) JMockit was not developed with such languages in mind, and isn't tested with them; and 2) these languages, when compiled to bytecode, produce additional or different constructs that may confuse a tool like JMockit; also they usually insert calls to their own internal APIs which may also get in the way.</p>\n\n<p>In practice, alternative languages tend to develop their own testing/mocking/etc. tools, that not only work well for that language and its runtime, but also let you take full advantage of the language's strenghts.</p>\n\n<p>Personally, even though I can recognize the many benefits such languages bring (and I particularly like Kotlin), I would rather stick with Java (which continues to evolve - see Java 8). The fact is, so far <em>no</em> alternative JVM language has come even close of Java's widespread use, and (IMO) they never will.</p>\n"}, {"comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451702575, "post_id": 28749195, "comment_id": 56867880, "body": "The syntax for annotations has changed, in the above example <code>[Mocked]</code> would now be <code>@Mocked</code>"}], "tags": [], "owner": {"reputation": 10942, "user_id": 18575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/318654a786700455b96049d8ac9beb11?s=128&d=identicon&r=PG", "display_name": "Ilya Ryzhenkov", "link": "https://stackoverflow.com/users/18575/ilya-ryzhenkov"}, "is_accepted": false, "score": 0, "last_activity_date": 1424972575, "creation_date": 1424972575, "answer_id": 28749195, "question_id": 28696399, "link": "https://stackoverflow.com/questions/28696399/using-kotlin-with-jmockit/28749195#28749195", "title": "Using kotlin with jmockit", "body": "<p>We've experimented a little and found that you can define special function like this:</p>\n\n<pre><code>fun uninitialized&lt;T&gt;() = null as T\n</code></pre>\n\n<p>and then use it like this:</p>\n\n<pre><code>[Mocked] val dateTime : LocalDateTime = uninitialized()\n</code></pre>\n\n<p>You can also use it instead of <code>Matchers.any()</code> for the same effect.\nWe will consider adding it to compiler or standard library.</p>\n"}], "owner": {"reputation": 227, "user_id": 4198432, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4c8e63f72c361af1460668848c655285?s=128&d=identicon&r=PG&f=1", "display_name": "sk_dev", "link": "https://stackoverflow.com/users/4198432/sk-dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1660, "favorite_count": 1, "answer_count": 2, "score": 8, "last_activity_date": 1424972575, "creation_date": 1424782523, "last_edit_date": 1424790503, "question_id": 28696399, "link": "https://stackoverflow.com/questions/28696399/using-kotlin-with-jmockit", "title": "Using kotlin with jmockit", "body": "<p>I need some advice using jmockit with kotlin.</p>\n\n<p>(CUT) This is my (Java) class under test:</p>\n\n<pre><code>public final class NutritionalConsultant {\n    public static boolean isLunchTime() {\n        int hour = LocalDateTime.now().getHour();\n        return hour &gt;= 12 &amp;&amp; hour &lt;= 14;\n    }\n}\n</code></pre>\n\n<p>(j.1) This is a working Java test class</p>\n\n<pre><code>@RunWith(JMockit.class)\npublic class NutritionalConsultantTest {\n    @Test\n    public void shouldReturnTrueFor12h(@Mocked final LocalDateTime dateTime) {\n        new Expectations() {{\n            LocalDateTime.now(); result = dateTime;\n            dateTime.getHour(); result = 12;\n        }};\n        boolean isLunchTime = NutritionalConsultant.isLunchTime();\n        assertThat(isLunchTime, is(true));\n    }\n}\n</code></pre>\n\n<p>(kt.1) However, the corresponding kotlin class throws an exception</p>\n\n<pre><code>RunWith(javaClass&lt;JMockit&gt;())\npublic class NutritionalConsultantKt1Test {\n\n    Test\n    public fun shouldReturnTrueFor12h(Mocked dateTime : LocalDateTime) {\n        object : Expectations() {{\n            LocalDateTime.now(); result = dateTime;\n            dateTime.getHour(); result = 12;\n        }}\n        val isLunchTime = NutritionalConsultant.isLunchTime()\n        assertThat(isLunchTime, eq(true));\n    }\n}\n</code></pre>\n\n<p>Exception:</p>\n\n<pre><code>java.lang.Exception: Method shouldReturnTrueFor12h should have no parameters\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n    at java.lang.reflect.Constructor.newInstance(Constructor.java:408)\n    at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:41)\n    at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:212)\n    at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:68)\n    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:140)\n</code></pre>\n\n<p>The same exception is thrown when run with gradle.</p>\n\n<p>(kt.2) Using the @Mocked syntax with kotlin I am getting a different exception:</p>\n\n<pre><code>RunWith(javaClass&lt;JMockit&gt;())\npublic class NutritionalConsultantKt2Test {\n    Mocked\n    var dateTime : LocalDateTime by Delegates.notNull()\n\n    Test\n    public fun shouldReturnTrueFor12h() {\n        object : Expectations() {{\n            LocalDateTime.now(); result = dateTime;\n            dateTime.getHour(); result = 12;\n        }}\n        val isLunchTime = NutritionalConsultant.isLunchTime()\n        assertThat(isLunchTime, eq(true));\n    }\n}\n</code></pre>\n\n<p>Exception:</p>\n\n<pre><code>java.lang.IllegalArgumentException: Final mock field \"dateTime$delegate\" must be of a class type\n    at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:74)\n    at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:212)\n    at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:68)\n    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:140)\n</code></pre>\n\n<p><em>edit 20150224</em> maybe this is related to \"For a mock field, an instance of the declared type will be automatically created by JMockit and assigned to the field, provided it's not final.\" (from <a href=\"http://jmockit.org/tutorial/BehaviorBasedTesting.html\" rel=\"noreferrer\">http://jmockit.org/tutorial/BehaviorBasedTesting.html</a>)</p>\n\n<p>(kt.3) However, changing the val to var and using a !! operator leads to a working test... but this is not idiomatic kotlin code:</p>\n\n<pre><code>RunWith(javaClass&lt;JMockit&gt;())\npublic class NutritionalConsultantKt3Test {\n    Mocked\n    var dateTime : LocalDateTime? = null\n\n    Test\n    public fun shouldReturnTrueFor12h() {\n        object : Expectations() {{\n            LocalDateTime.now(); result = dateTime;\n            dateTime!!.getHour(); result = 12;\n        }}\n        val isLunchTime = NutritionalConsultant.isLunchTime()\n        assertThat(isLunchTime, eq(true));\n    }\n}\n</code></pre>\n\n<p>Did you have more success using kotlin with jmockit?</p>\n"}, {"tags": ["kotlin", "algebraic-data-types", "discriminated-union"], "answers": [{"comments": [{"owner": {"reputation": 2366, "user_id": 6022, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7123b04a975e97c9081f9570a5bc75b6?s=128&d=identicon&r=PG", "display_name": "ehnmark", "link": "https://stackoverflow.com/users/6022/ehnmark"}, "edited": false, "score": 0, "creation_date": 1424868835, "post_id": 28719082, "comment_id": 45725861, "body": "Hi, thanks for your reply! In Scala I would use a <code>sealed Trait OrderMessage</code> and <code>case class New(..) extends OrderMessage</code> etc. I could then pattern match on order message types and get access to their fields at the same type (just like in the F# example above). Any chance we&#39;d be able to do that with <code>when</code> in Kotlin any time soon? :)"}, {"owner": {"reputation": 20424, "user_id": 445715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3824489df267d3bf86bbc678b9745ac4?s=128&d=identicon&r=PG", "display_name": "Andrey Breslav", "link": "https://stackoverflow.com/users/445715/andrey-breslav"}, "reply_to_user": {"reputation": 2366, "user_id": 6022, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7123b04a975e97c9081f9570a5bc75b6?s=128&d=identicon&r=PG", "display_name": "ehnmark", "link": "https://stackoverflow.com/users/6022/ehnmark"}, "edited": false, "score": 0, "creation_date": 1424953295, "post_id": 28719082, "comment_id": 45767577, "body": "@enhmark What you can do is this: <a href=\"http://kotlin-demo.jetbrains.com/?publicLink=104074971561017308771-1714234109\" rel=\"nofollow noreferrer\">kotlin-demo.jetbrains.com/&hellip;</a>. See more about smart casts: <a href=\"http://kotlinlang.org/docs/reference/typecasts.html#smart-casts\" rel=\"nofollow noreferrer\">kotlinlang.org/docs/reference/typecasts.html#smart-casts</a>"}, {"owner": {"reputation": 15120, "user_id": 161257, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Lm0md.png?s=128&g=1", "display_name": "HRJ", "link": "https://stackoverflow.com/users/161257/hrj"}, "edited": false, "score": 0, "creation_date": 1440732139, "post_id": 28719082, "comment_id": 52405107, "body": "@AndreyBreslav &quot;will complain about exhaustiveness&quot;. Did you forget to put a &quot;not&quot; there? Otherwise I don&#39;t understand that part of your answer."}, {"owner": {"reputation": 20424, "user_id": 445715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3824489df267d3bf86bbc678b9745ac4?s=128&d=identicon&r=PG", "display_name": "Andrey Breslav", "link": "https://stackoverflow.com/users/445715/andrey-breslav"}, "reply_to_user": {"reputation": 15120, "user_id": 161257, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Lm0md.png?s=128&g=1", "display_name": "HRJ", "link": "https://stackoverflow.com/users/161257/hrj"}, "edited": false, "score": 0, "creation_date": 1441198246, "post_id": 28719082, "comment_id": 52580309, "body": "@HRJ kind of yes, I did"}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "reply_to_user": {"reputation": 15120, "user_id": 161257, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Lm0md.png?s=128&g=1", "display_name": "HRJ", "link": "https://stackoverflow.com/users/161257/hrj"}, "edited": false, "score": 27, "creation_date": 1451576694, "post_id": 28719082, "comment_id": 56839089, "body": "Kotlin now has <a href=\"https://kotlinlang.org/docs/reference/classes.html#sealed-classes\" rel=\"nofollow noreferrer\">Sealed Classes</a> which allow you to control the possible hierarchy and have the compiler check that you exhausted all options in a <code>when</code> statement / expression.  This addresses the issue Andrey and @HRJ mention."}], "tags": [], "owner": {"reputation": 20424, "user_id": 445715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3824489df267d3bf86bbc678b9745ac4?s=128&d=identicon&r=PG", "display_name": "Andrey Breslav", "link": "https://stackoverflow.com/users/445715/andrey-breslav"}, "is_accepted": true, "score": 37, "last_activity_date": 1440748231, "last_edit_date": 1440748231, "creation_date": 1424867397, "answer_id": 28719082, "question_id": 28695254, "link": "https://stackoverflow.com/questions/28695254/kotlin-and-discriminated-unions-sum-types/28719082#28719082", "title": "Kotlin and discriminated unions (sum types)", "body": "<p>The common way of implementing this kind of abstraction in an OO-language (e.g. Kotlin or Scala) would be to through inheritance:</p>\n\n<pre><code>open class OrderMessage private () { // private constructor to prevent creating more subclasses outside\n    class New(val id: Int, val quantity: Int) : OrderMessage()\n    class Cancel(val id: Int) : OrderMessage()\n}\n</code></pre>\n\n<p>You can push the common part to the superclass, if you like:</p>\n\n<pre><code>open class OrderMessage private (val id: Int) { // private constructor to prevent creating more subclasses outside\n    class New(id: Int, val quantity: Int) : OrderMessage(id)\n    class Cancel(id: Int) : OrderMessage(id)\n}\n</code></pre>\n\n<p>The type checker doesn't know that such a hierarchy is closed, so when you do a case-like match (<code>when</code>-expression) on it, it will complain that it is not exhaustive, but this will be fixed soon.</p>\n\n<p><strong>Update:</strong> while Kotlin does not support <em>pattern matching</em>, you can use <strong>when</strong>-expressions as smart casts to get almost the same behavior:</p>\n\n<pre><code>when (message) {\n  is New -&gt; println(\"new $id: $quantity\")\n  is Cancel -&gt; println(\"cancel $id\")\n}\n</code></pre>\n\n<p>See more about smart casts <a href=\"http://kotlinlang.org/docs/reference/typecasts.html#smart-casts\" rel=\"noreferrer\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 890, "user_id": 1435116, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7e8d8f792c2beb8c405080649d1e19fc?s=128&d=identicon&r=PG", "display_name": "Adeynack", "link": "https://stackoverflow.com/users/1435116/adeynack"}, "is_accepted": false, "score": 45, "last_activity_date": 1534410538, "last_edit_date": 1534410538, "creation_date": 1471611167, "answer_id": 39039552, "question_id": 28695254, "link": "https://stackoverflow.com/questions/28695254/kotlin-and-discriminated-unions-sum-types/39039552#39039552", "title": "Kotlin and discriminated unions (sum types)", "body": "<p><a href=\"https://kotlinlang.org/docs/reference/sealed-classes.html\" rel=\"noreferrer\">Kotlin's <code>sealed class</code></a> approach to that problem is extremely similar to the <a href=\"https://docs.scala-lang.org/tour/pattern-matching.html\" rel=\"noreferrer\">Scala <code>sealed class</code> and <code>sealed trait</code></a>.</p>\n\n<p>Example (taken from the linked Kotlin article):</p>\n\n<pre><code>sealed class Expr {\n    class Const(val number: Double) : Expr()\n    class Sum(val e1: Expr, val e2: Expr) : Expr()\n    object NotANumber : Expr()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1281, "user_id": 3537539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/256506a9078afeaf026655924497deb6?s=128&d=identicon&r=PG", "display_name": "xurxodev", "link": "https://stackoverflow.com/users/3537539/xurxodev"}, "is_accepted": false, "score": 9, "last_activity_date": 1538729776, "creation_date": 1538729776, "answer_id": 52661881, "question_id": 28695254, "link": "https://stackoverflow.com/questions/28695254/kotlin-and-discriminated-unions-sum-types/52661881#52661881", "title": "Kotlin and discriminated unions (sum types)", "body": "<p>The sealed class in Kotlin has been designed to be able to represent sum types, as it happens with the sealed trait in Scala. </p>\n\n<p>Example:</p>\n\n<pre><code>sealed class OrderStatus {\n    object Approved: OrderStatus()\n    class Rejected(val reason: String): OrderStatus()\n}\n</code></pre>\n\n<p>The key benefit of using sealed classes comes into play when you use them in a when expression for the match. </p>\n\n<p>If it's possible to verify that the statement covers all cases, you don't need to add an else clause to the statement. </p>\n\n<pre><code>private fun getOrderNotification(orderStatus:OrderStatus): String{\n    return when(orderStatus) {\n        is OrderStatus.Approved -&gt; \"The order has been approved\"\n        is OrderStatus.Rejected -&gt; \"The order has been rejected. Reason:\" + orderStatus.reason\n   }\n}\n</code></pre>\n\n<p>There are several things to keep in mind:</p>\n\n<ul>\n<li><p>In Kotlin when performing smartcast, which means that in this example it is not necessary to perform the conversion from OrderStatus to OrderStatus.Rejected to access the reason property.</p></li>\n<li><p>If we had not defined what to do for the rejected case, the compilation would fail and in the IDE a warning like this appears:</p></li>\n</ul>\n\n<p><strong>'when' expression must be exhaustive, add necessary 'is Rejected' branch or 'else' branch instead.</strong></p>\n\n<ul>\n<li>when it can be used as an expression or as a statement. If it is used as an expression, the value of the satisfied branch becomes the value of the general expression. If used as a statement, the values of the individual branches are ignored. This means that the compilation error in case of missing a branch only occurs when it is used as an expression, using the result.</li>\n</ul>\n\n<p>This is a link to my blog (spanish), where I have a more complete article about ADT with kotlin examples: <a href=\"http://xurxodev.com/tipos-de-datos-algebraicos/\" rel=\"noreferrer\">http://xurxodev.com/tipos-de-datos-algebraicos/</a></p>\n"}], "owner": {"reputation": 2366, "user_id": 6022, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7123b04a975e97c9081f9570a5bc75b6?s=128&d=identicon&r=PG", "display_name": "ehnmark", "link": "https://stackoverflow.com/users/6022/ehnmark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15214, "favorite_count": 6, "accepted_answer_id": 28719082, "answer_count": 3, "score": 50, "last_activity_date": 1538729776, "creation_date": 1424779189, "last_edit_date": 1478046095, "question_id": 28695254, "link": "https://stackoverflow.com/questions/28695254/kotlin-and-discriminated-unions-sum-types", "title": "Kotlin and discriminated unions (sum types)", "body": "<p>Does Kotlin have anything like discriminated unions (sum types)? What would be the idiomatic Kotlin translation of this (F#):</p>\n\n<pre><code>type OrderMessage =\n    | New of Id: int * Quantity: int\n    | Cancel of Id: int\n\nlet handleMessage msg = \n    match msg with\n        | New(id, qty) -&gt; handleNew id qty\n        | Cancel(id) -&gt; handleCxl id\n</code></pre>\n"}, {"tags": ["android", "junit", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 679, "user_id": 474867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f4b3fe3db6fe0c27150b32713f334dc?s=128&d=identicon&r=PG", "display_name": "m00sey", "link": "https://stackoverflow.com/users/474867/m00sey"}, "edited": false, "score": 0, "creation_date": 1424961892, "post_id": 28738864, "comment_id": 45773178, "body": "For completeness, you can still use Java based unit tests to test your Kotlin classes."}, {"owner": {"reputation": 10814, "user_id": 891242, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5719e9d6125bf8f75501a83e68b11412?s=128&d=identicon&r=PG", "display_name": "ZakTaccardi", "link": "https://stackoverflow.com/users/891242/zaktaccardi"}, "edited": false, "score": 2, "creation_date": 1426872884, "post_id": 28738864, "comment_id": 46563259, "body": "is there any way to auto-generate a java junit test for a kotlin class? <b>Go To -&gt; Test</b> is greyed out for me unfortunately for <b>.kt</b> classes"}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "reply_to_user": {"reputation": 10814, "user_id": 891242, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5719e9d6125bf8f75501a83e68b11412?s=128&d=identicon&r=PG", "display_name": "ZakTaccardi", "link": "https://stackoverflow.com/users/891242/zaktaccardi"}, "edited": false, "score": 0, "creation_date": 1451576884, "post_id": 28738864, "comment_id": 56839163, "body": "In <a href=\"http://blog.jetbrains.com/kotlin/2015/10/kotlin-1-0-beta-candidate-is-out/\" rel=\"nofollow noreferrer\">Kotlin Beta 1 RC announcement</a> it was mentioned that &quot;The last but not least, unit testing experience is much smoother now. List of improvements: \u201cCreate Test\u201d action, tests are runnable via gutter icons, navigation between tests and test subjects (\u21e7\u2318T/\u21e7^T) and also quickfixes to add dependencies on JUnit and TestNG when needed&quot;   ... which gives you those features you are looking for with navigating unit tests.  @ZakTaccardi"}], "tags": [], "owner": {"reputation": 386, "user_id": 3836081, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000265489427/picture?type=large", "display_name": "Natalia Selezneva", "link": "https://stackoverflow.com/users/3836081/natalia-selezneva"}, "is_accepted": true, "score": 4, "last_activity_date": 1438242978, "last_edit_date": 1438242978, "creation_date": 1424943499, "answer_id": 28738864, "question_id": 28671696, "link": "https://stackoverflow.com/questions/28671696/experimental-junit-support-in-android-kotlin-not-working/28738864#28738864", "title": "Experimental JUnit support in Android + Kotlin not working", "body": "<p>Unfortunatly, kotlin-gradle plugin doesn't support Junit tests for Android at this moment.</p>\n\n<p>EDIT: Junit support for android was added in Kotlin M12</p>\n"}], "owner": {"reputation": 8433, "user_id": 1456931, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5b9a171ecc501424c4fb4fa166fe0cf?s=128&d=identicon&r=PG", "display_name": "Damian Petla", "link": "https://stackoverflow.com/users/1456931/damian-petla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1548, "favorite_count": 3, "accepted_answer_id": 28738864, "answer_count": 1, "score": 5, "last_activity_date": 1438242978, "creation_date": 1424687578, "question_id": 28671696, "link": "https://stackoverflow.com/questions/28671696/experimental-junit-support-in-android-kotlin-not-working", "title": "Experimental JUnit support in Android + Kotlin not working", "body": "<p>Google recently released <a href=\"https://sites.google.com/a/android.com/tools/tech-docs/unit-testing-support\" rel=\"noreferrer\">experimental</a> support for running junit on local JVM in Android Studio. I wanted to try it out and since I am developing my Android app using Kotlin I want my tests classes be written in Kotlin too.</p>\n\n<p>Unfortunately, I can't make it working.\nI have updated my gradle configuration:</p>\n\n<pre><code>sourceSets {\n    main.java.srcDirs += 'src/main/kotlin'\n    androidTest.java.srcDirs += 'src/androidTest/kotlin'\n    test.java.srcDirs += 'src/test/kotlin'//this line was added\n}\ntestCompile 'junit:junit:4.12'\ntestCompile \"org.mockito:mockito-core:1.9.5\"\n</code></pre>\n\n<p>Android Studio recognise test folder.</p>\n\n<p>This is my simple test class just to see if it works</p>\n\n<pre><code>public class MyFirstTestClass {\n\n    [Test] fun firstTest() {\n        println(\"I am OK\")\n        Assert.assertTrue(\"\".isEmpty())\n    }\n}\n</code></pre>\n\n<p>If I try to run it I get the following message</p>\n\n<blockquote>\n  <p>Class not found: 'com.example.MyFirstTestClass'</p>\n</blockquote>\n"}, {"tags": ["arrays", "interop", "kotlin"], "comments": [{"owner": {"reputation": 11, "user_id": 4595090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d06149bd94acc937620f1eddcf55671a?s=128&d=identicon&r=PG&f=1", "display_name": "BillyBumper", "link": "https://stackoverflow.com/users/4595090/billybumper"}, "reply_to_user": {"reputation": 6909, "user_id": 4454454, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6UgUs.jpg?s=128&g=1", "display_name": "MaxZoom", "link": "https://stackoverflow.com/users/4454454/maxzoom"}, "edited": false, "score": 0, "creation_date": 1424743895, "post_id": 28664957, "comment_id": 45666584, "body": "I felt it related to issues of Java interop."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451577206, "post_id": 28664957, "comment_id": 56839300, "body": "This is not an issue currently, Kotlin has a stdlib function, see new answers."}], "answers": [{"comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451577173, "post_id": 28665161, "comment_id": 56839290, "body": "This is outdated, there is now a stdlib function.  See other answers."}], "tags": [], "owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "is_accepted": false, "score": 3, "last_activity_date": 1424650950, "creation_date": 1424650950, "answer_id": 28665161, "question_id": 28664957, "link": "https://stackoverflow.com/questions/28664957/what-is-the-canonical-way-to-convert-an-arraybyte-to-a-bytearray/28665161#28665161", "title": "What is the canonical way to convert an Array&lt;Byte&gt; to a ByteArray", "body": "<p>I don't see any built-in functions apart from the obvious loop-based approach. But you could define an extension function like this yourself:</p>\n\n<pre><code>fun Array&lt;Byte&gt;.toPrimitive(): ByteArray {\n    val tgtArray: ByteArray = ByteArray(this.size())\n\n    for (i in this.indices) {\n        tgtArray[i] = this[i]\n    }\n\n    return tgtArray\n}\n\nfun test() {\n    val srcArray = Array&lt;Byte&gt;(10, { 0 })\n\n    val tgtArray: ByteArray = srcArray.toPrimitive()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "is_accepted": false, "score": 1, "last_activity_date": 1451577149, "creation_date": 1451577149, "answer_id": 34548672, "question_id": 28664957, "link": "https://stackoverflow.com/questions/28664957/what-is-the-canonical-way-to-convert-an-arraybyte-to-a-bytearray/34548672#34548672", "title": "What is the canonical way to convert an Array&lt;Byte&gt; to a ByteArray", "body": "<p>Kotlin has this in the stdlib as an extension function <code>Array&lt;Byte&gt;.toByteArray()</code></p>\n\n\n\n<pre><code>val srcArray = Array&lt;Byte&gt;(10, { 0 })\nval tgtArray = srcArray.toByteArray()\n</code></pre>\n\n<p>(<em>Note:  I changed your <code>var</code> to <code>val</code> which is more common in Kotlin to use read-only values</em>)</p>\n\n<p>You will see similar ones for other primitive data types that have array implementations.  You can see them all in the <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-array/index.html#extension-functions\" rel=\"nofollow\">Kotlin documentation for Array extension functions</a>.</p>\n"}], "owner": {"reputation": 11, "user_id": 4595090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d06149bd94acc937620f1eddcf55671a?s=128&d=identicon&r=PG&f=1", "display_name": "BillyBumper", "link": "https://stackoverflow.com/users/4595090/billybumper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1451577149, "creation_date": 1424649530, "last_edit_date": 1424649964, "question_id": 28664957, "link": "https://stackoverflow.com/questions/28664957/what-is-the-canonical-way-to-convert-an-arraybyte-to-a-bytearray", "title": "What is the canonical way to convert an Array&lt;Byte&gt; to a ByteArray", "body": "<p>If have an Array and want to convert it to a ByteArray, how should I go about it? The following for instance fails:</p>\n\n<pre><code>var srcArray = Array&lt;Byte&gt;(10, { 0 })\nvar tgtArray: ByteArray = srcArray as ByteArray\n</code></pre>\n\n<p>I do realize though that specialized classes such as ByteArray are:</p>\n\n<blockquote>\n  <p>... not related to the Array class and are compiled down to Java\u2019s primitive arrays for maximum performance.</p>\n</blockquote>\n\n<p>So, the fact that my approach fails shouldn't surprise me - but what is the canonical way to make the conversion? Simply iterate through srcArray and populate tgtArray one index at a time - or is there a more elegant solution I'm missing?</p>\n"}, {"tags": ["java", "kotlin", "data-class"], "answers": [{"comments": [{"owner": {"reputation": 20424, "user_id": 445715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3824489df267d3bf86bbc678b9745ac4?s=128&d=identicon&r=PG", "display_name": "Andrey Breslav", "link": "https://stackoverflow.com/users/445715/andrey-breslav"}, "edited": false, "score": 2, "creation_date": 1424418360, "post_id": 28620809, "comment_id": 45549069, "body": "Looks like your example does not present the full picture: in the code you present, a no-argument version of <code>copy()</code> is not available for Java at all, and the phrase about defining <code>copy()</code> explicitly does not seem relevant. In any case, the design of <code>copy()</code> is based on default parameters mechanism that is only available in Kotln, not in Java"}, {"owner": {"reputation": 2552, "user_id": 269029, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b0b08e61a7674d6fec0bbea4b6e1f685?s=128&d=identicon&r=PG", "display_name": "Michael Pardo", "link": "https://stackoverflow.com/users/269029/michael-pardo"}, "reply_to_user": {"reputation": 20424, "user_id": 445715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3824489df267d3bf86bbc678b9745ac4?s=128&d=identicon&r=PG", "display_name": "Andrey Breslav", "link": "https://stackoverflow.com/users/445715/andrey-breslav"}, "edited": false, "score": 0, "creation_date": 1424460512, "post_id": 28620809, "comment_id": 45573113, "body": "The <code>copy()</code> function does exists in Java for the example above, it just doesn&#39;t copy any values since there are no arguments for the class. I didn&#39;t mention explicitly defining a copy function. I just didn&#39;t fully read the documentation of data classes and misinterpreted how they work."}, {"owner": {"reputation": 20424, "user_id": 445715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3824489df267d3bf86bbc678b9745ac4?s=128&d=identicon&r=PG", "display_name": "Andrey Breslav", "link": "https://stackoverflow.com/users/445715/andrey-breslav"}, "edited": false, "score": 0, "creation_date": 1424481664, "post_id": 28620809, "comment_id": 45580898, "body": "Oh, I&#39;m sorry: didn&#39;t copy the code of your example and misread curly braces for round ones. My bad"}], "tags": [], "owner": {"reputation": 2552, "user_id": 269029, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b0b08e61a7674d6fec0bbea4b6e1f685?s=128&d=identicon&r=PG", "display_name": "Michael Pardo", "link": "https://stackoverflow.com/users/269029/michael-pardo"}, "is_accepted": true, "score": 8, "last_activity_date": 1424400008, "creation_date": 1424400008, "answer_id": 28620809, "question_id": 28620782, "link": "https://stackoverflow.com/questions/28620782/kotlin-data-class-copy-function-not-working-when-called-from-java-class/28620809#28620809", "title": "Kotlin data class copy function not working when called from java class", "body": "<p>Okay, I missed this sentence in the docs:</p>\n\n<blockquote>\n  <p>If any of these functions is explicitly defined in the class body or inherited from the base types, it will not be generated.</p>\n</blockquote>\n\n<p>Which, infact, makes <code>copy</code> no better than a constructor for Java interop.</p>\n"}, {"tags": [], "owner": {"reputation": 2223, "user_id": 2332327, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7r0y4.jpg?s=128&g=1", "display_name": "DimitrisCBR", "link": "https://stackoverflow.com/users/2332327/dimitriscbr"}, "is_accepted": false, "score": 2, "last_activity_date": 1509378587, "creation_date": 1509378587, "answer_id": 47019312, "question_id": 28620782, "link": "https://stackoverflow.com/questions/28620782/kotlin-data-class-copy-function-not-working-when-called-from-java-class/47019312#47019312", "title": "Kotlin data class copy function not working when called from java class", "body": "<p>What you can do to get around the limitations of Kotlin's copy(), is to create your own copy function inside your data class. Example below:</p>\n\n<pre><code>data class User(val name : String, val property: String) {\n\n    fun copy() : User {\n      //uses the fields name and property defined in the constructor\n      return User(name,property)\n    }\n\n    //or if you need a copy with a changed field\n    fun copy(changedProperty : String) : User {\n      return User(name, changedProperty)\n    }\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1749, "user_id": 4365688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/poWWs.jpg?s=128&g=1", "display_name": "Nokuap", "link": "https://stackoverflow.com/users/4365688/nokuap"}, "is_accepted": false, "score": 0, "last_activity_date": 1518774860, "creation_date": 1518774860, "answer_id": 48824107, "question_id": 28620782, "link": "https://stackoverflow.com/questions/28620782/kotlin-data-class-copy-function-not-working-when-called-from-java-class/48824107#48824107", "title": "Kotlin data class copy function not working when called from java class", "body": "<p>For interop with java you can make function that use kotlin generated .copy</p>\n\n<pre><code>@Entity\ndata class User(@PrimaryKey var id: Int = 0,\n            var firstName: String? = null,\n            var lastName: String? = null,\n            var phone: String? = null,\n            var email: String? = null,\n            var phoneCode: String? = null,\n            var tokenId: String? = null,\n            var provider: SocialProvider? = null) : Serializable {\n\n\nvar countryCodeIso: String? = null\n    set(countryCodeIso) {\n        if (countryCodeIso != null) {\n            field = countryCodeIso.toLowerCase()\n        }\n    }\n\nfun javaCopy(): User {\n    val user = copy()\n    user.countryCodeIso = countryCodeIso\n    return user\n}}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1739, "user_id": 57357, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/46b892c9b15be26fec41fe9112410d5f?s=128&d=identicon&r=PG", "display_name": "Dan Tanner", "link": "https://stackoverflow.com/users/57357/dan-tanner"}, "is_accepted": false, "score": 0, "last_activity_date": 1583870468, "last_edit_date": 1583870468, "creation_date": 1582595982, "answer_id": 60386507, "question_id": 28620782, "link": "https://stackoverflow.com/questions/28620782/kotlin-data-class-copy-function-not-working-when-called-from-java-class/60386507#60386507", "title": "Kotlin data class copy function not working when called from java class", "body": "<p>This question is high in search rankings, and potentially confusing for those new to kotlin, since the question's sample code is not typical kotlin code or usage of the copy function.  I added some sample code below to help clarify what's going on, and also show typical usage of a data class.<br>\nIn short, the <code>copy</code> function is most useful when called from a kotlin class. I agree that its behavior isn't obvious when called from java code. </p>\n\n<pre class=\"lang-kotlin prettyprint-override\"><code>//\n// A.kt\n//\n\n// this is an idiomatic kotlin data class. note the parens around the properties, not braces.\ndata class A(\n    val x: String? = null,\n    val y: String? = null,\n    val z: B = B.ONE\n) {\n    // this javaCopy function is completely unnecessary when being called from kotlin; it's only here to show a fairly simple way to make kotlin-java interop a little easier (like what Nokuap showed).\n    fun javaCopy(): A {\n        return this.copy()\n    }\n}\n\nenum class B {\n    ONE,\n    TWO,\n    THREE\n}\n\nfun main() {\n    val a1 = A(\"Hello\", \"World\", B.TWO)\n\n    // here's what copy usage looks like for idiomatic kotlin code.\n    val a2 = a1.copy()\n    assert(a2.x == \"Hello\")\n    assert(a2.y == \"World\")\n    assert(a2.z == B.TWO)\n\n    // more typical is to `copy` the object and modify one or more properties during the copy. e.g.:\n    val a3 = a1.copy(y = \"Friend\")\n    assert(a2.x == \"Hello\")\n    assert(a3.y == \"Friend\")\n}\n</code></pre>\n\n<pre class=\"lang-java prettyprint-override\"><code>public class App {\n\n    public static void main(String[] args) {\n        A a1 = new A(\"Hello\", \"World\", B.TWO);\n\n        // the kotlin copy function is primarily meant for kotlin &lt;-&gt; kotlin interop\n        // copy works when called from java, but it requires all the args.\n        // calling the `javaCopy` function gives the expected behavior.\n        A a2 = a1.javaCopy();\n        assert a2.getX().equals(\"Hello\");\n        assert a2.getY().equals(\"World\");\n        assert a2.getZ().equals(B.TWO);\n    }\n}\n\n</code></pre>\n\n<p>Official docs on data classes, including the <code>copy</code> function:<br>\n<a href=\"https://kotlinlang.org/docs/reference/data-classes.html\" rel=\"nofollow noreferrer\">https://kotlinlang.org/docs/reference/data-classes.html</a></p>\n"}], "owner": {"reputation": 2552, "user_id": 269029, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b0b08e61a7674d6fec0bbea4b6e1f685?s=128&d=identicon&r=PG", "display_name": "Michael Pardo", "link": "https://stackoverflow.com/users/269029/michael-pardo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7677, "favorite_count": 2, "accepted_answer_id": 28620809, "answer_count": 4, "score": 5, "last_activity_date": 1583870468, "creation_date": 1424399814, "last_edit_date": 1582607127, "question_id": 28620782, "link": "https://stackoverflow.com/questions/28620782/kotlin-data-class-copy-function-not-working-when-called-from-java-class", "title": "Kotlin data class copy function not working when called from java class", "body": "<p>Maybe I'm misinterpreting how the <code>copy</code> function of a <code>data</code> class works or maybe there's a bug, but the following is an example of the <code>copy</code> function not working as expected:</p>\n\n<p>Kotlin:</p>\n\n<pre><code>data class A {\n    public var x: String? = null\n    public var y: String? = null\n    public var z: B = B.ONE\n}\n\nenum class B {\n    ONE\n    TWO\n    THREE\n}\n</code></pre>\n\n<p>Java</p>\n\n<pre><code>A a1 = new A()\na1.setX(\"Hello\")\na1.setY(\"World\")\na1.setZ(B.TWO)\n\nA a2 = a1.copy()\n// a2.x is null\n// a2.y is null\n// a2.z is B.ONE\n</code></pre>\n\n<p>It seems that <code>copy</code> is just making a new instance of <code>A</code> and not copying the values. If I put the variables in the constructor, the values are assigned, but then it's no different than constructing a new instance.</p>\n"}]