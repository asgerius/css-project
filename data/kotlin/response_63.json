[{"tags": ["javafx", "properties", "delegates", "kotlin"], "answers": [{"tags": [], "owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "is_accepted": false, "score": 2, "last_activity_date": 1458826785, "creation_date": 1458826785, "answer_id": 36201580, "question_id": 36185885, "link": "https://stackoverflow.com/questions/36185885/getting-kproperty-information-from-within-delegated-property-outside-getvalue/36201580#36201580", "title": "Getting KProperty Information from within Delegated Property outside getValue() and setValue() Functions", "body": "<p>This used to be possible in pre-release versions of Kotlin, where delegated properties had an additional method <code>propertyDelegated()</code> called during the initial setup of a delegated property. The method was removed shortly before 1.0, but it's likely that it (or an equivalent feature) will be re-added in a future version.</p>\n\n<p>For now, I suspect your existing solution is the best possibility.</p>\n"}, {"tags": [], "owner": {"reputation": 25812, "user_id": 288456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf294ff6d86cc587dec43e2af34a9532?s=128&d=identicon&r=PG", "display_name": "Alexander Udalov", "link": "https://stackoverflow.com/users/288456/alexander-udalov"}, "is_accepted": true, "score": 1, "last_activity_date": 1486825921, "creation_date": 1486825921, "answer_id": 42177435, "question_id": 36185885, "link": "https://stackoverflow.com/questions/36185885/getting-kproperty-information-from-within-delegated-property-outside-getvalue/42177435#42177435", "title": "Getting KProperty Information from within Delegated Property outside getValue() and setValue() Functions", "body": "<p>In Kotlin 1.1 (since 1.1-M04), you can use the <code>provideDelegate</code> operator convention to define a function which will be called once when the instance of the delegate is created. In your example, you can declare <code>provideDelegate</code> in <code>PropertyFX</code> and return a new delegate with the information about the container and the property. More info: <a href=\"https://blog.jetbrains.com/kotlin/2016/12/kotlin-1-1-m04-is-here/#provide-delegate\" rel=\"nofollow noreferrer\">https://blog.jetbrains.com/kotlin/2016/12/kotlin-1-1-m04-is-here/#provide-delegate</a></p>\n"}], "owner": {"reputation": 1615, "user_id": 2884225, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Eaihe.png?s=128&g=1", "display_name": "Ryan Hilbert", "link": "https://stackoverflow.com/users/2884225/ryan-hilbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 546, "favorite_count": 0, "accepted_answer_id": 42177435, "answer_count": 2, "score": 1, "last_activity_date": 1486825921, "creation_date": 1458757318, "question_id": 36185885, "link": "https://stackoverflow.com/questions/36185885/getting-kproperty-information-from-within-delegated-property-outside-getvalue", "title": "Getting KProperty Information from within Delegated Property outside getValue() and setValue() Functions", "body": "<p>I'm trying to implement the JavaFX <a href=\"https://docs.oracle.com/javase/8/javafx/api/javafx/beans/property/Property.html\" rel=\"nofollow\">Property</a> interface with a delegated Kotlin property, so that it can be used like so:</p>\n\n<pre><code>class Foo(bar:Bar){\n    val barProperty=PropertyFX(bar)\n    var bar by barProperty\n}\n</code></pre>\n\n<p>I wrote up a small class for this that works (mostly):</p>\n\n<pre><code>class PropertyFX&lt;T&gt;(value:T):SimpleObjectProperty&lt;T&gt;(value),ReadWriteProperty&lt;Any?,T&gt;{\n    override fun getValue(thisRef:Any?,property:KProperty&lt;*&gt;)=get()\n    override fun setValue(thisRef:Any?,property:KProperty&lt;*&gt;,value:T)=set(value)\n}\n</code></pre>\n\n<p>However, this class doesn't implement the interface's getBean() and getName() methods. They should return the values thisRef and property.name, respectively, from the arguments referenced in the getValue() and setValue() functions, but I don't have access to those arguments from outside the functions.</p>\n\n<p>I could store the values the first time they're used, like so:</p>\n\n<pre><code>class PropertyFX&lt;T&gt;(value:T):SimpleObjectProperty&lt;T&gt;(value),ReadWriteProperty&lt;Any?,T&gt;{\n    private var bean:Any?=null\n    private var name=\"\"\n    override fun getBean()=bean\n    override fun getName()=name\n    override fun getValue(thisRef:Any?,property:KProperty&lt;*&gt;):T{\n        bean=thisRef\n        name=property.name\n        return get()\n    }\n    override fun setValue(thisRef:Any?,property:KProperty&lt;*&gt;,value:T){\n        bean=thisRef\n        name=property.name\n        set(value)\n    }\n</code></pre>\n\n<p>But this seems like an awful hack, and it doesn't return the correct values for <a href=\"https://docs.oracle.com/javase/8/javafx/api/javafx/beans/property/ReadOnlyProperty.html#getBean--\" rel=\"nofollow\">getBean()</a> and <a href=\"https://docs.oracle.com/javase/8/javafx/api/javafx/beans/property/ReadOnlyProperty.html#getName--\" rel=\"nofollow\">getName()</a> until the property is accessed once. Is there a way to get these values earlier without passing them into the constructor, like is required by <a href=\"https://docs.oracle.com/javase/8/javafx/api/javafx/beans/property/SimpleObjectProperty.html#SimpleObjectProperty-java.lang.Object-java.lang.String-T-\" rel=\"nofollow\">SimpleObjectProperty</a>?</p>\n"}, {"tags": ["android", "json", "kotlin"], "comments": [{"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "edited": false, "score": 0, "creation_date": 1458760748, "post_id": 36184641, "comment_id": 60009030, "body": "Which JSON library are you using?"}, {"owner": {"reputation": 1964, "user_id": 1545435, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/5cakf.jpg?s=128&g=1", "display_name": "Ambran", "link": "https://stackoverflow.com/users/1545435/ambran"}, "reply_to_user": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "edited": false, "score": 0, "creation_date": 1458765691, "post_id": 36184641, "comment_id": 60011857, "body": "I use the <code>org.json.JSONArray</code> and <code>org.json.JSONObject</code>."}], "answers": [{"comments": [{"owner": {"reputation": 36733, "user_id": 907695, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/daac9f1ef1a91604000a38376cace034?s=128&d=identicon&r=PG", "display_name": "Pointer Null", "link": "https://stackoverflow.com/users/907695/pointer-null"}, "edited": false, "score": 44, "creation_date": 1498633981, "post_id": 36185280, "comment_id": 76572080, "body": "Nicer is: for(i in 0 until persons.length())"}, {"owner": {"reputation": 4394, "user_id": 534238, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nZVSf.jpg?s=128&g=1", "display_name": "Mike Williamson", "link": "https://stackoverflow.com/users/534238/mike-williamson"}, "edited": false, "score": 8, "creation_date": 1542665838, "post_id": 36185280, "comment_id": 93642832, "body": "<code>for(i in 0 until persons.length()</code> is definitely nicer, as it seems to help avoid the dreaded off-by-one problem.  But why wouldn&#39;t an iterator be exposed?  This seems crazy by default... it&#39;s a core object type which is entirely focused upon multiple objects.  Iterating through seems only natural, right???"}, {"owner": {"reputation": 376, "user_id": 2566313, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/me69D.png?s=128&g=1", "display_name": "marcode_ely", "link": "https://stackoverflow.com/users/2566313/marcode-ely"}, "edited": false, "score": 0, "creation_date": 1552781722, "post_id": 36185280, "comment_id": 97142479, "body": "It helps me a lot. Thanks fellow."}, {"owner": {"reputation": 131, "user_id": 1308590, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/fe1ae909e843d29d646759debbff7545?s=128&d=identicon&r=PG", "display_name": "famfamfam", "link": "https://stackoverflow.com/users/1308590/famfamfam"}, "edited": false, "score": 1, "creation_date": 1577093857, "post_id": 36185280, "comment_id": 105087762, "body": "i got out of range exception"}], "tags": [], "owner": {"reputation": 2618, "user_id": 3554721, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7528701ff581bc81191e4594a2252dd3?s=128&d=identicon&r=PG&f=1", "display_name": "0x60", "link": "https://stackoverflow.com/users/3554721/0x60"}, "is_accepted": true, "score": 168, "last_activity_date": 1576595844, "last_edit_date": 1576595844, "creation_date": 1458755370, "answer_id": 36185280, "question_id": 36184641, "link": "https://stackoverflow.com/questions/36184641/kotlin-iterate-through-a-jsonarray/36185280#36185280", "title": "Kotlin: Iterate through a JSONArray", "body": "<p>Unfortunately, <code>JsonArray</code> does not expose an iterator. So you will have to iterate through it using an index range:</p>\n\n<pre><code>for (i in 0 until persons.length()) {\n    val item = persons.getJSONObject(i)\n\n    // Your code here\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1964, "user_id": 1545435, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/5cakf.jpg?s=128&g=1", "display_name": "Ambran", "link": "https://stackoverflow.com/users/1545435/ambran"}, "edited": false, "score": 3, "creation_date": 1458768377, "post_id": 36188796, "comment_id": 60013243, "body": "Thanks Ilya. As a Kotlin newbie I appreciate every input I can get."}, {"owner": {"reputation": 10420, "user_id": 1491707, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/rOXkJ.png?s=128&g=1", "display_name": "Nick Felker", "link": "https://stackoverflow.com/users/1491707/nick-felker"}, "edited": false, "score": 1, "creation_date": 1496109809, "post_id": 36188796, "comment_id": 75513106, "body": "I prefer this solution since it takes greater advantage of Kotlin&#39;s specific functionality"}, {"owner": {"reputation": 2276, "user_id": 3175580, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbfe30c791549584b87aa50bdcaf8b08?s=128&d=identicon&r=PG&f=1", "display_name": "androidguy", "link": "https://stackoverflow.com/users/3175580/androidguy"}, "edited": false, "score": 2, "creation_date": 1500418116, "post_id": 36188796, "comment_id": 77325117, "body": "Though of course you will not always have an array of JSONObject. You might want to try:<code>operator fun &lt;T&gt; JSONArray.iterator(): Iterator&lt;T&gt;     = (0 until length()).asSequence().map { get(it) as T }.iterator()</code> now it has an &quot;unchecked cast&quot; of course."}, {"owner": {"reputation": 4936, "user_id": 7408927, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3014b6a57c88143a2a0784fb9c2708e8?s=128&d=identicon&r=PG&f=1", "display_name": "Sevastyan Savanyuk", "link": "https://stackoverflow.com/users/7408927/sevastyan-savanyuk"}, "edited": false, "score": 0, "creation_date": 1512640402, "post_id": 36188796, "comment_id": 82343344, "body": "Where is the check for an empty <code>JSONArray</code>? <code>get(it)</code> will throw an exception, if <code>JSONArray</code> is empty."}, {"owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "reply_to_user": {"reputation": 4936, "user_id": 7408927, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3014b6a57c88143a2a0784fb9c2708e8?s=128&d=identicon&r=PG&f=1", "display_name": "Sevastyan Savanyuk", "link": "https://stackoverflow.com/users/7408927/sevastyan-savanyuk"}, "edited": false, "score": 1, "creation_date": 1512729311, "post_id": 36188796, "comment_id": 82384926, "body": "@Sevastyan <code>0 until length()</code> will produce an empty range if an array is empty, so <code>get</code> will be called 0 times (i.e. won&#39;t be called at all) on elements of the empty range."}, {"owner": {"reputation": 4936, "user_id": 7408927, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3014b6a57c88143a2a0784fb9c2708e8?s=128&d=identicon&r=PG&f=1", "display_name": "Sevastyan Savanyuk", "link": "https://stackoverflow.com/users/7408927/sevastyan-savanyuk"}, "edited": false, "score": 0, "creation_date": 1512743320, "post_id": 36188796, "comment_id": 82392809, "body": "@Ilya <code>0 until 0</code> means <code>0</code>, so <code>get(it)</code> is <code>get(0)</code>."}, {"owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "reply_to_user": {"reputation": 4936, "user_id": 7408927, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3014b6a57c88143a2a0784fb9c2708e8?s=128&d=identicon&r=PG&f=1", "display_name": "Sevastyan Savanyuk", "link": "https://stackoverflow.com/users/7408927/sevastyan-savanyuk"}, "edited": false, "score": 2, "creation_date": 1512810122, "post_id": 36188796, "comment_id": 82414332, "body": "@Sevastyan you can quick check what <code>0 until 0</code> evaluates to with <a href=\"https://try.kotlinlang.org\" rel=\"nofollow noreferrer\">try.kotlinlang.org</a>"}, {"owner": {"reputation": 96259, "user_id": 247696, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/936383b387d6cc6d51279e429e5d7cd9?s=128&d=identicon&r=PG", "display_name": "Flimm", "link": "https://stackoverflow.com/users/247696/flimm"}, "reply_to_user": {"reputation": 2276, "user_id": 3175580, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbfe30c791549584b87aa50bdcaf8b08?s=128&d=identicon&r=PG&f=1", "display_name": "androidguy", "link": "https://stackoverflow.com/users/3175580/androidguy"}, "edited": false, "score": 0, "creation_date": 1541162370, "post_id": 36188796, "comment_id": 93131826, "body": "This code assumes that the JSONArray&#39;s children are objects and only objects. Even @androidguy&#39;s suggestion assumes that the JSONArray&#39;s children are homogenous, I think."}, {"owner": {"reputation": 389, "user_id": 2787953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mbeBb.jpg?s=128&g=1", "display_name": "Scre", "link": "https://stackoverflow.com/users/2787953/scre"}, "reply_to_user": {"reputation": 2276, "user_id": 3175580, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbfe30c791549584b87aa50bdcaf8b08?s=128&d=identicon&r=PG&f=1", "display_name": "androidguy", "link": "https://stackoverflow.com/users/3175580/androidguy"}, "edited": false, "score": 0, "creation_date": 1596365359, "post_id": 36188796, "comment_id": 111783148, "body": "@androidguy which can be suppressed away with <code>@Suppress(&quot;UNCHECKED_CAST&quot;)</code>"}, {"owner": {"reputation": 372, "user_id": 7513880, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/paCxg.png?s=128&g=1", "display_name": "Morpheus", "link": "https://stackoverflow.com/users/7513880/morpheus"}, "edited": false, "score": 0, "creation_date": 1613327179, "post_id": 36188796, "comment_id": 117035390, "body": "Thank you for contributing an answer. Would you kindly edit your answer to to include an explanation of your code?"}], "tags": [], "owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "is_accepted": false, "score": 44, "last_activity_date": 1596375311, "last_edit_date": 1596375311, "creation_date": 1458767638, "answer_id": 36188796, "question_id": 36184641, "link": "https://stackoverflow.com/questions/36184641/kotlin-iterate-through-a-jsonarray/36188796#36188796", "title": "Kotlin: Iterate through a JSONArray", "body": "<p>Even if some class doesn't expose an <code>iterator</code> method, you can still iterate it with <code>for</code> statement by providing an extension function <code>iterator</code>:</p>\n<pre><code>operator fun JSONArray.iterator(): Iterator&lt;JSONObject&gt; \n    = (0 until length()).asSequence().map { get(it) as JSONObject }.iterator()\n</code></pre>\n<p>Now when you use <code>JSONArray</code> in <code>for</code> statement this extension is invoked to get an iterator. It creates a range of indices and maps each index to an item corresponding to this index.</p>\n<p>I suppose the cast to <code>JSONObject</code> is required as the array can contain not only objects but also primitives and other arrays. And the <code>asSequence</code> call is here to execute <code>map</code> operation in a lazy way.</p>\n<p><strong>Generic way (<em>assuming</em> all array entries are of same type)</strong></p>\n<pre><code>@Suppress(&quot;UNCHECKED_CAST&quot;)\noperator fun &lt;T&gt; JSONArray.iterator(): Iterator&lt;T&gt;\n    = (0 until length()).asSequence().map { get(it) as T }.iterator()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1964, "user_id": 1545435, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/5cakf.jpg?s=128&g=1", "display_name": "Ambran", "link": "https://stackoverflow.com/users/1545435/ambran"}, "edited": false, "score": 0, "creation_date": 1543675614, "post_id": 53531676, "comment_id": 94008215, "body": "<code>jsonArray.getJSONObject(r)</code> should be <code>jsonArray.getJSONObject(i)</code> or have I misunderstood something?"}, {"owner": {"reputation": 285, "user_id": 2115881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/joN7O.jpg?s=128&g=1", "display_name": "Sharif", "link": "https://stackoverflow.com/users/2115881/sharif"}, "reply_to_user": {"reputation": 1964, "user_id": 1545435, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/5cakf.jpg?s=128&g=1", "display_name": "Ambran", "link": "https://stackoverflow.com/users/1545435/ambran"}, "edited": false, "score": 0, "creation_date": 1543850028, "post_id": 53531676, "comment_id": 94055691, "body": "yes, you&#39;re right, it should be <code>i</code> not <code>r</code>. Fixed code example."}, {"owner": {"reputation": 3975, "user_id": 842607, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a69067470e1edd172c448819e85b3055?s=128&d=identicon&r=PG", "display_name": "Jimit Patel", "link": "https://stackoverflow.com/users/842607/jimit-patel"}, "edited": false, "score": 1, "creation_date": 1579699948, "post_id": 53531676, "comment_id": 105853211, "body": "Can be refined as <code>(0 until (jsonArray.length()))</code>"}, {"owner": {"reputation": 372, "user_id": 7513880, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/paCxg.png?s=128&g=1", "display_name": "Morpheus", "link": "https://stackoverflow.com/users/7513880/morpheus"}, "edited": false, "score": 0, "creation_date": 1613327163, "post_id": 53531676, "comment_id": 117035385, "body": "Thank you for contributing an answer. Would you kindly edit your answer to to include an explanation of your code?"}], "tags": [], "owner": {"reputation": 285, "user_id": 2115881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/joN7O.jpg?s=128&g=1", "display_name": "Sharif", "link": "https://stackoverflow.com/users/2115881/sharif"}, "is_accepted": false, "score": 4, "last_activity_date": 1543849995, "last_edit_date": 1543849995, "creation_date": 1543464379, "answer_id": 53531676, "question_id": 36184641, "link": "https://stackoverflow.com/questions/36184641/kotlin-iterate-through-a-jsonarray/53531676#53531676", "title": "Kotlin: Iterate through a JSONArray", "body": "<p>How about </p>\n\n<pre><code>(0..(jsonArray.length()-1)).forEach { i -&gt;\n    var item = jsonArray.getJSONObject(i)\n}\n</code></pre>\n\n<p>?</p>\n"}, {"comments": [{"owner": {"reputation": 1775, "user_id": 5066895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bHw56.png?s=128&g=1", "display_name": "Dieter Meemken", "link": "https://stackoverflow.com/users/5066895/dieter-meemken"}, "edited": false, "score": 2, "creation_date": 1561039340, "post_id": 56687203, "comment_id": 99940822, "body": "Can you explain a bit more?"}, {"owner": {"reputation": 4620, "user_id": 5260982, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ww1JG.png?s=128&g=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/5260982/dave"}, "edited": false, "score": 3, "creation_date": 1561051408, "post_id": 56687203, "comment_id": 99947513, "body": "While this code may solve the question, <a href=\"https://meta.stackexchange.com/questions/114762/explaining-entirely-code-based-answers\">including an explanation</a> of how and why this solves the problem would really help to improve the quality of your post, and probably result in more up-votes. Remember that you are answering the question for readers in the future, not just the person asking now. Please <a href=\"https://stackoverflow.com/posts/56687203/edit\">edit</a> your answer to add explanation, and give an indication of what limitations and assumptions apply."}], "tags": [], "owner": {"reputation": 372, "user_id": 7513880, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/paCxg.png?s=128&g=1", "display_name": "Morpheus", "link": "https://stackoverflow.com/users/7513880/morpheus"}, "is_accepted": false, "score": 2, "last_activity_date": 1561037744, "creation_date": 1561037744, "answer_id": 56687203, "question_id": 36184641, "link": "https://stackoverflow.com/questions/36184641/kotlin-iterate-through-a-jsonarray/56687203#56687203", "title": "Kotlin: Iterate through a JSONArray", "body": "<pre><code>for (i in 0 until jsonArray.length()){\n    //do your stuff\n    }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4441, "user_id": 3025856, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/68e9ff807fadeaa41ece5dcf761a03c1?s=128&d=identicon&r=PG", "display_name": "Jeremy Caney", "link": "https://stackoverflow.com/users/3025856/jeremy-caney"}, "edited": false, "score": 0, "creation_date": 1608841280, "post_id": 65441244, "comment_id": 115700219, "body": "Thank you for contributing an answer. Would you kindly edit your answer to to include an explanation of your code? That will help future readers better understand what is going on, and especially those members of the community who are new to the language and struggling to understand the concepts."}, {"owner": {"reputation": 372, "user_id": 7513880, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/paCxg.png?s=128&g=1", "display_name": "Morpheus", "link": "https://stackoverflow.com/users/7513880/morpheus"}, "edited": false, "score": 0, "creation_date": 1613327136, "post_id": 65441244, "comment_id": 117035370, "body": "Thank you for contributing an answer. Would you kindly edit your answer to to include an explanation of your code?"}], "tags": [], "owner": {"reputation": 174, "user_id": 7507215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EmkH8.png?s=128&g=1", "display_name": "fisio", "link": "https://stackoverflow.com/users/7507215/fisio"}, "is_accepted": false, "score": 2, "last_activity_date": 1608844868, "last_edit_date": 1608844868, "creation_date": 1608829386, "answer_id": 65441244, "question_id": 36184641, "link": "https://stackoverflow.com/questions/36184641/kotlin-iterate-through-a-jsonarray/65441244#65441244", "title": "Kotlin: Iterate through a JSONArray", "body": "<p>shortest way is:</p>\n<pre><code>(0 until persons.length()).forEach {\n    val item = persons.getJSONObject(it)\n</code></pre>\n<p>Basically  from a range taking from zero to the jsonarray lenght ,it takes one number at time and use it as a index to retrieve the current object</p>\n"}], "owner": {"reputation": 1964, "user_id": 1545435, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/5cakf.jpg?s=128&g=1", "display_name": "Ambran", "link": "https://stackoverflow.com/users/1545435/ambran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50494, "favorite_count": 11, "accepted_answer_id": 36185280, "answer_count": 5, "score": 88, "last_activity_date": 1608844868, "creation_date": 1458753398, "last_edit_date": 1507621305, "question_id": 36184641, "link": "https://stackoverflow.com/questions/36184641/kotlin-iterate-through-a-jsonarray", "title": "Kotlin: Iterate through a JSONArray", "body": "<p>I'm writing an Android app using Kotlin and Realm.\nI have a JSONArray, and I want to iterate through the JSONObjects in this array in order to load them in a Realm database class:</p>\n\n<p>Realm class:</p>\n\n<pre><code>import io.realm.RealmObject\nimport io.realm.annotations.PrimaryKey\nimport io.realm.annotations.Required\n\nopen class Person(\n\n        @PrimaryKey open var id: Long = 0,\n\n        @Required\n        open var name: String = \"\"\n\n) : RealmObject() {\n\n}\n</code></pre>\n\n<p>The JSONArray:</p>\n\n<pre><code>{\n    \"persons\":[\n        {\n           \"id\":0,\n           \"name\":\"Biatrix\"\n        },\n        {\n           \"id\":1,\n           \"name\":\"Bill\"\n        },\n        {\n           \"id\":2,\n           \"name\":\"Oren\"\n        },\n        {\n           \"id\":3,\n           \"name\":\"Budd\"\n        }\n    ]\n}\n</code></pre>\n\n<p>I've tried iterating like the following:</p>\n\n<pre><code>for (item : JSONObject in persons) {\n\n}\n</code></pre>\n\n<p>... but I get a <code>for-loop range must have an iterator() method</code> error.</p>\n"}, {"tags": ["rx-java", "kotlin"], "comments": [{"owner": {"reputation": 15573, "user_id": 397786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8550f0386287de4073e022c401b9d4aa?s=128&d=identicon&r=PG", "display_name": "Tassos Bassoukos", "link": "https://stackoverflow.com/users/397786/tassos-bassoukos"}, "edited": false, "score": 0, "creation_date": 1458740162, "post_id": 36179494, "comment_id": 59994429, "body": "For some reason, I don&#39;t think that this is a good match for Rx; perhaps you would do better if you modeled your use case with an event bus?"}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 2388775, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c7f157fb2f88191e968dd5ef011dc268?s=128&d=identicon&r=PG", "display_name": "Motorro", "link": "https://stackoverflow.com/users/2388775/motorro"}, "edited": false, "score": 0, "creation_date": 1458790769, "post_id": 36191178, "comment_id": 60020205, "body": "Thanks a lot! That was obvious :)"}], "tags": [], "owner": {"reputation": 313, "user_id": 4592309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d8084bbffa1bd8557fbf11f02b0219?s=128&d=identicon&r=PG", "display_name": "Patrick Bacon", "link": "https://stackoverflow.com/users/4592309/patrick-bacon"}, "is_accepted": true, "score": 2, "last_activity_date": 1458779117, "creation_date": 1458779117, "answer_id": 36191178, "question_id": 36179494, "link": "https://stackoverflow.com/questions/36179494/rxjava-unsubscribe-async-observable-from-within-another-async-production/36191178#36191178", "title": "RxJava: Unsubscribe async observable from within another async production", "body": "<p>Assuming that the comment</p>\n\n<pre><code>// Chat 1 disappears FROM USER CHAT LIST, Chat 2 is created\n</code></pre>\n\n<p>indicates that you'd like the current <code>Chat</code> (<code>chat1</code> in this case) to stop emitting when a new <code>Chat</code> is sent on <code>chats</code>, you can accomplish this with the <code>switchMap</code> operator.</p>\n\n<pre><code>val sequence = chats.switchMap { it.lastMessage }\n</code></pre>\n\n<p>From the ReactiveX documentation:</p>\n\n<blockquote>\n  <p>RxJava also implements the switchMap operator. It behaves much like\n  flatMap, except that whenever a new item is emitted by the source\n  Observable, it will unsubscribe to and stop mirroring the Observable\n  that was generated from the previously-emitted item, and begin only\n  mirroring the current one.</p>\n</blockquote>\n"}], "owner": {"reputation": 147, "user_id": 2388775, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c7f157fb2f88191e968dd5ef011dc268?s=128&d=identicon&r=PG", "display_name": "Motorro", "link": "https://stackoverflow.com/users/2388775/motorro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 478, "favorite_count": 0, "accepted_answer_id": 36191178, "answer_count": 1, "score": 1, "last_activity_date": 1458779117, "creation_date": 1458739625, "last_edit_date": 1458749330, "question_id": 36179494, "link": "https://stackoverflow.com/questions/36179494/rxjava-unsubscribe-async-observable-from-within-another-async-production", "title": "RxJava: Unsubscribe async observable from within another async production", "body": "<p>What is a best (clean) way to unsubscribe an async <code>Observable</code> wich is produced in a <code>flatMap</code> of another async one?\nSay, I have a presentation that shows a chat list for user.\nEach Chat item should present the latest message of itself.\nHere is an original code to illustrate:</p>\n\n<pre><code>fun AsyncInsideAsync() {\n    /**\n     * A chat that 'transmits' latest message\n     */\n    class Chat(val name: Int) {\n        val lastMessage: PublishSubject&lt;String&gt; = PublishSubject.create()\n\n        fun postMessage(message: Int) {\n            lastMessage.onNext(\"Chat: $name, Message: $message\")\n        }\n    }\n\n    // List of chats for user.\n    val chats: PublishSubject&lt;Chat&gt; = PublishSubject.create()\n\n    ///////////////////////////////////\n    //        ORIGINAL SEQUENCE      //\n    ///////////////////////////////////\n    val sequence = chats.flatMap { it.lastMessage }\n\n    val subscriber = TestSubscriber&lt;String&gt;()\n    sequence.subscribe(subscriber)\n\n    // User has single chat in a chat-list\n    val chat1 = Chat(1)\n    chats.onNext(chat1)\n\n    // Someone posts a message in Chat 1\n    chat1.postMessage(1)\n    subscriber.assertValues(\n            \"Chat: 1, Message: 1\"\n    )\n\n    // Someone posts another message\n    chat1.postMessage(2)\n    subscriber.assertValues(\n            \"Chat: 1, Message: 1\",\n            \"Chat: 1, Message: 2\"\n    )\n\n    // Chat 1 disappears FROM USER CHAT LIST, Chat 2 is created\n    val chat2 = Chat(2)\n    chats.onNext(chat2)\n\n    // Someone posts a message to Chat 2\n    chat2.postMessage(1)\n    subscriber.assertValues(\n            \"Chat: 1, Message: 1\",\n            \"Chat: 1, Message: 2\",\n            \"Chat: 2, Message: 1\"\n    )\n\n    // Someone out there posts a message to Chat 1 that is not visible to user anymore\n    chat1.postMessage(3)\n\n    // The answer looks like this \n    //      \"Chat: 1, Message: 1\",\n    //      \"Chat: 1, Message: 2\",\n    //      \"Chat: 2, Message: 1\",\n    //      \"Chat: 1, Message: 3\"\n    // Chat 1 is still subscribed and test fails\n    subscriber.assertValues(\n            \"Chat: 1, Message: 1\",\n            \"Chat: 1, Message: 2\",\n            \"Chat: 2, Message: 1\",\n    )\n}\n</code></pre>\n\n<p>What I came up to is using a subject (or shared observable) to brake a chain of internal subscriptions. But it looks weird:</p>\n\n<pre><code>    ///////////////////////////////////\n    //        MODIFIED SEQUENCE      //\n    ///////////////////////////////////\n    val unsubscribe: PublishSubject&lt;Boolean&gt; = PublishSubject.create()\n    val sequence = chats\n            .doOnNext({ unsubscribe.onNext(true) })\n            .doAfterTerminate({ unsubscribe.onNext(true) })\n            .flatMap {\n                it.lastMessage.takeUntil(unsubscribe)\n            }\n</code></pre>\n\n<p>This approach works but looks frighteningly.\nThanks a lot!</p>\n"}, {"tags": ["kotlin", "kohesive-injekt"], "answers": [{"comments": [{"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "edited": false, "score": 1, "creation_date": 1458678191, "post_id": 36158947, "comment_id": 59966134, "body": "Just a small note: reification at compile time gives even more than passing class token at runtime: <a href=\"http://gafter.blogspot.ru/2006/12/super-type-tokens.html?m=1\" rel=\"nofollow noreferrer\">gafter.blogspot.ru/2006/12/super-type-tokens.html?m=1</a> For example, Jackson module for Kotlin uses this."}, {"owner": {"reputation": 3667, "user_id": 190148, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5338ca3693b8a1aaf94b6f791c5842a7?s=128&d=identicon&r=PG", "display_name": "netimen", "link": "https://stackoverflow.com/users/190148/netimen"}, "edited": false, "score": 0, "creation_date": 1458715879, "post_id": 36158947, "comment_id": 59979347, "body": "Yeah, I understand about verification and erasure. But I don&#39;t understand where exactly should I pass <code>KClass&lt;P&gt;</code> for injection to work in my case"}, {"owner": {"reputation": 3121, "user_id": 3699808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f0af2052e664e9f832421cb56590b935?s=128&d=identicon&r=PG", "display_name": "mhlz", "link": "https://stackoverflow.com/users/3699808/mhlz"}, "edited": false, "score": 0, "creation_date": 1458743717, "post_id": 36158947, "comment_id": 59997242, "body": "I think you can just call <code>injectLazy(clazz)</code>, but I&#39;m not 100% certain"}], "tags": [], "owner": {"reputation": 3121, "user_id": 3699808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f0af2052e664e9f832421cb56590b935?s=128&d=identicon&r=PG", "display_name": "mhlz", "link": "https://stackoverflow.com/users/3699808/mhlz"}, "is_accepted": false, "score": 2, "last_activity_date": 1458661475, "creation_date": 1458661475, "answer_id": 36158947, "question_id": 36156668, "link": "https://stackoverflow.com/questions/36156668/how-to-use-injectlazy-delegate-from-injekt-library-with-generics/36158947#36158947", "title": "How to use injectLazy() delegate from Injekt library with generics?", "body": "<p>Generic Type parameters are erased when compiling Java code. Kotlin provides a feature where inline functions can retain this type information all the way to the run time of the program. That feature is what the <code>injectLazy&lt;T&gt;</code> function uses to reify the type parameter.</p>\n\n<p>In your case though, the type parameter <code>P</code> comes from the class, so the Kotlin compiler can't reify it, meaning it'll get erased when compiling to Java bytecode. With the type parameter erased, the <code>injectLazy&lt;T&gt;</code> function can't be called anymore, because the type information will be missing at run time. This is why the compiler gives you the error.</p>\n\n<p>You will have to pass a <code>KClass&lt;P&gt;</code> object to your class and use that to inject dependencies, thereby sorta reifying the type manually.</p>\n"}, {"tags": [], "owner": {"reputation": 3667, "user_id": 190148, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5338ca3693b8a1aaf94b6f791c5842a7?s=128&d=identicon&r=PG", "display_name": "netimen", "link": "https://stackoverflow.com/users/190148/netimen"}, "is_accepted": true, "score": 0, "last_activity_date": 1458829297, "creation_date": 1458829297, "answer_id": 36202458, "question_id": 36156668, "link": "https://stackoverflow.com/questions/36156668/how-to-use-injectlazy-delegate-from-injekt-library-with-generics/36202458#36202458", "title": "How to use injectLazy() delegate from Injekt library with generics?", "body": "<p>I finally found a way to do that. But I had to add two new functions first:</p>\n\n<pre><code>fun &lt;T: Any&gt; typeRef(type: KClass&lt;T&gt;) = object : TypeReference&lt;T&gt; {\n    override val type = type.java\n}\n\nfun &lt;T : Any&gt; injectLazy(type: KClass&lt;T&gt;): Lazy&lt;T&gt; {\n    return lazy { Injekt.get(forType = typeRef(type)) }\n}\n</code></pre>\n\n<p>and now I can write:</p>\n\n<pre><code>abstract class MvpFragment&lt;P : Presenter&gt;(presenterClass: KClass&lt;P&gt;) : Fragment() {\n    protected val presenter by injectLazy(type = presenterClass)\n}\n</code></pre>\n"}], "owner": {"reputation": 3667, "user_id": 190148, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5338ca3693b8a1aaf94b6f791c5842a7?s=128&d=identicon&r=PG", "display_name": "netimen", "link": "https://stackoverflow.com/users/190148/netimen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 36202458, "answer_count": 2, "score": 2, "last_activity_date": 1458829297, "creation_date": 1458655734, "question_id": 36156668, "link": "https://stackoverflow.com/questions/36156668/how-to-use-injectlazy-delegate-from-injekt-library-with-generics", "title": "How to use injectLazy() delegate from Injekt library with generics?", "body": "<p>I have a following class Hierarchy</p>\n\n<pre><code>interface Presenter\n\nabstract class MvpFragment&lt;P: Presenter&gt; : Fragment() {\n    val presenter by injectLazy&lt;P&gt;() // error: Cannot use 'T' as reified type parameter. Use a class instead.\n}\n</code></pre>\n\n<p>Is there any way to use the <code>injectLazy</code> delegate with generics? I can pass a <code>KClass&lt;P&gt;</code> as a parameter to <code>MvpFragment</code>, but I still can't figure out how to use it to inject a <code>P</code> object.</p>\n"}, {"tags": ["intellij-idea", "gradle", "kotlin"], "comments": [{"owner": {"reputation": 1130, "user_id": 3927381, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/801e5e2a7b6e032c3ce07b9a9f7e7f8c?s=128&d=identicon&r=PG", "display_name": "solvingJ", "link": "https://stackoverflow.com/users/3927381/solvingj"}, "edited": false, "score": 0, "creation_date": 1460739691, "post_id": 36156291, "comment_id": 60899021, "body": "I have the same problem with a Groovy project. I believe it&#39;s due to Auto-import, but don&#39;t know any resolution yet."}, {"owner": {"reputation": 1948, "user_id": 1157905, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/eceaedd9e55ca442d8bc5a8571dd397d?s=128&d=identicon&r=PG", "display_name": "Omri374", "link": "https://stackoverflow.com/users/1157905/omri374"}, "edited": false, "score": 0, "creation_date": 1468334763, "post_id": 36156291, "comment_id": 64078784, "body": "Try deleting the .gradle folder, close the project and reimport the project from gradle."}, {"owner": {"reputation": 5826, "user_id": 14379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f77ca2a8cac1b10c9ef94c42e1263ac6?s=128&d=identicon&r=PG", "display_name": "seanf", "link": "https://stackoverflow.com/users/14379/seanf"}, "edited": false, "score": 0, "creation_date": 1493366684, "post_id": 36156291, "comment_id": 74396246, "body": "This sort of thing can happen when the project directory is accessed via a symbolic link. See <a href=\"http://stackoverflow.com/a/25888978/14379\">stackoverflow.com/a/25888978/14379</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5469, "user_id": 7083401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eA15o.png?s=128&g=1", "display_name": "ice1000", "link": "https://stackoverflow.com/users/7083401/ice1000"}, "is_accepted": false, "score": 1, "last_activity_date": 1495535975, "creation_date": 1495535975, "answer_id": 44132480, "question_id": 36156291, "link": "https://stackoverflow.com/questions/36156291/idea-showing-a-project-twice-in-tree/44132480#44132480", "title": "IDEA showing a project twice in tree", "body": "<p>Open your <code>project structure</code> dialog (you can use <code>Ctrl+Alt+Shift+S</code>), turn to the <code>Modules</code> section, check if you have duplicated module defined there.\nIf there is, remove the unnecessary ones.</p>\n"}, {"comments": [{"owner": {"reputation": 1694, "user_id": 2673386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cc376861b2ff6f3088bb4c338df6126a?s=128&d=identicon&r=PG", "display_name": "EntangledLoops", "link": "https://stackoverflow.com/users/2673386/entangledloops"}, "edited": false, "score": 0, "creation_date": 1560356634, "post_id": 50081210, "comment_id": 99712534, "body": "That isn&#39;t related. &quot;Module&quot; refers to IntelliJ&#39;s own module structure (see Project Settings), not Gradle&#39;s."}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 1, "creation_date": 1561745241, "post_id": 50081210, "comment_id": 100177175, "body": "Actually the option that fixed this for me was right above the option you were highlighting: &quot;use explicit module groups&quot;"}], "tags": [], "owner": {"reputation": 632, "user_id": 1499171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mARXO.jpg?s=128&g=1", "display_name": "jivimberg", "link": "https://stackoverflow.com/users/1499171/jivimberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1524950720, "creation_date": 1524950720, "answer_id": 50081210, "question_id": 36156291, "link": "https://stackoverflow.com/questions/36156291/idea-showing-a-project-twice-in-tree/50081210#50081210", "title": "IDEA showing a project twice in tree", "body": "<p>You may want to try disabling the <em>Create separate module per source set</em> option when importing the Gradle module.</p>\n\n<p><a href=\"https://i.stack.imgur.com/t9cvl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/t9cvl.png\" alt=\"import wizard\"></a></p>\n\n<p>So, the full steps are:</p>\n\n<ol>\n<li>Open Modules <a href=\"https://i.stack.imgur.com/FgPmm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FgPmm.png\" alt=\"enter image description here\"></a></li>\n<li>Remove the gradle module</li>\n<li>Re-import the module. On the second page of the import wizard <strong>make sure you disable the option: <em>Create separate module per source set</em></strong></li>\n</ol>\n"}], "owner": {"reputation": 852, "user_id": 3001663, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3ac148aad0c52963ff474c3304d9e12c?s=128&d=identicon&r=PG", "display_name": "Sim&#243;n Oro&#241;o", "link": "https://stackoverflow.com/users/3001663/sim%c3%b3n-oro%c3%b1o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2331, "favorite_count": 1, "answer_count": 2, "score": 12, "last_activity_date": 1524950720, "creation_date": 1458654809, "question_id": 36156291, "link": "https://stackoverflow.com/questions/36156291/idea-showing-a-project-twice-in-tree", "title": "IDEA showing a project twice in tree", "body": "<p>I have a Kotlin project with Gradle that has two children. Whenever I try to open it in IDEA, one of the children is shown twice in the tree.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Uf3ix.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/Uf3ix.png\" alt=\"Screenshot\"></a></p>\n\n<p>In the tree, you can see two projects at top level, grpc and grp. The issue is that grpc (from top level) is the same project as the grpc that's a children of grp.</p>\n\n<p>Here are my Gradle build files:</p>\n\n<p>The parent gradle.build:</p>\n\n<pre><code>buildscript {\n    ext.kotlin_version = '1.0.1'\n    repositories {\n        jcenter()\n        mavenCentral()\n    }\n    dependencies {\n        classpath \"org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version\"\n    }\n}\n\nallprojects {\n    repositories {\n        jcenter()\n        mavenCentral()\n    }\n} \n</code></pre>\n\n<p>The gradle.settings file:</p>\n\n<pre><code>include ':grpstd', ':grpc'\n</code></pre>\n\n<p>The grpc gradle.build:</p>\n\n<pre><code>apply plugin: 'antlr'\napply plugin: 'application'\napply plugin: 'kotlin'\n\nmainClassName = 'sron.grpc.MainKt'\n\ncompileKotlin.dependsOn generateGrammarSource\n\ngenerateGrammarSource {\n    arguments += ['-package', 'sron.grpc.compiler.internal']\n}\n\ndependencies {\n    antlr 'org.antlr:antlr4:4.5.2-1'\n\n    compile \"org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version\"\n    compile 'commons-cli:commons-cli:1.3.1'\n    compile 'org.ow2.asm:asm:5.0.4'\n    compile project(':grpstd')\n\n    testCompile 'junit:junit:4.12'\n    testCompile \"org.jetbrains.kotlin:kotlin-test:$kotlin_version\"\n}\n</code></pre>\n\n<p>The grpstd gradle.build:</p>\n\n<pre><code>apply plugin: 'kotlin'\n\ndependencies {\n    compile \"org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version\"\n\n    testCompile 'junit:junit:4.12'\n    testCompile \"org.jetbrains.kotlin:kotlin-test:$kotlin_version\"\n}\n</code></pre>\n\n<p><strong>Why is that project being shown twice? How can I prevent it?</strong></p>\n"}, {"tags": ["generics", "kotlin"], "answers": [{"tags": [], "owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "is_accepted": true, "score": 7, "last_activity_date": 1458664094, "last_edit_date": 1592644375, "creation_date": 1458654056, "answer_id": 36155991, "question_id": 36155108, "link": "https://stackoverflow.com/questions/36155108/kotlin-generics-in-kfunction1/36155991#36155991", "title": "kotlin generics in KFunction1", "body": "<p>This is <a href=\"https://kotlinlang.org/docs/reference/generics.html#variance\" rel=\"noreferrer\">generics variance in Kotlin</a>, its purpose is to impose type-safe hierarchy on generic classes with parameters which are in class hierarchy themselves.</p>\n<p>Class <code>KFunction1</code> has generic parameters defined as <code>&lt;in P1, out R&gt;</code>, <code>P1</code> with <code>in</code> modifier and <code>R</code> with <code>out</code> modifier. This means that there will be:</p>\n<ul>\n<li><p><strong>Contravariance on</strong> <code>P1</code> introduced by <code>in</code> modifier.</p>\n<p>Any <code>KFunction1&lt;PSuper, R&gt;</code> will be a subtype of <code>KFunction1&lt;P, R&gt;</code> if <code>PSuper</code> is a supertype of <code>P</code>. But the limitation will be added that <code>P1</code> can only appear as argument of (passed into) <code>KFunction1</code>'s members.</p>\n</li>\n<li><p><strong>Covariance on</strong> <code>R</code> introduced by <code>out</code> modifier.</p>\n<p>Any <code>KFunction1&lt;P, RSub&gt;</code> will be a subtype of <code>KFunction1&lt;P, R&gt;</code> if <code>RSub</code> is a subtype of <code>R</code>. And here <code>R</code> will be limited: it can only be used as a return value (passed out) of <code>KFunction1</code>'s members.</p>\n</li>\n</ul>\n<p>Therefore you will be able to assign <code>KFunction1&lt;PSuper, RSub&gt;</code> to a variable of type <code>KFunction1&lt;P, R&gt;</code>.</p>\n<p>This makes sense for <code>KFunction1</code>, because any function that receives an argument of type <code>PSuper</code> can also receive an instance of <code>P</code> (but not vice versa), and any function that returns instances of <code>RSub</code> in the same time returns instances of <code>R</code> (but not vice versa).</p>\n<hr>\n<p>You can simply compose an example which shows this behaviour:</p>\n<pre><code>class Invariant&lt;T&gt;  {\n    fun f(i: Int): T { throw Exception() } // OK\n    fun f(t: T): Int { throw Exception() } // OK\n}\n\nclass Contravariant&lt;in T&gt; {\n    fun f(i: Int): T { throw Exception() } // error, T cannot be returned\n    fun f(t: T): Int { throw Exception() } // OK, T is parameter type\n}\n\nclass Covariant&lt;out T&gt; {\n    fun f(i: Int): T { throw Exception() } // OK, T is returned\n    fun f(t: T): Int { throw Exception() } // error, T cannnot be parameter type\n}\n\nopen class Base\nclass Derived: Base()\n\nval i1: Invariant&lt;Base&gt; = Invariant&lt;Derived&gt;() // error\nval i2: Invariant&lt;Derived&gt; = Invariant&lt;Base&gt;() // error\n\nval n1: Contravariant&lt;Base&gt; = Contravariant&lt;Derived&gt;() // error\nval n2: Contravariant&lt;Derived&gt; = Contravariant&lt;Base&gt;() // OK\n\nval v1: Covariant&lt;Base&gt; = Covariant&lt;Derived&gt;() // OK\nval v2: Covariant&lt;Derived&gt; = Covariant&lt;Base&gt;() // error\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 2631346, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/69350a991116bbcd97d7418785855660?s=128&d=identicon&r=PG", "display_name": "alexadr", "link": "https://stackoverflow.com/users/2631346/alexadr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2660, "favorite_count": 0, "accepted_answer_id": 36155991, "answer_count": 1, "score": 3, "last_activity_date": 1458664094, "creation_date": 1458651714, "last_edit_date": 1458654112, "question_id": 36155108, "link": "https://stackoverflow.com/questions/36155108/kotlin-generics-in-kfunction1", "title": "kotlin generics in KFunction1", "body": "<p>Suppose, you have two classes TestA and TestB. Suppose that TestA extends TestB:</p>\n\n<pre><code>public class TestB {\n    private int intProp;\n    public int getIntProp() {\n        return intProp;\n    }\n    public void setIntProp(int intProp) {\n        this.intProp = intProp;\n    }\n}\n\n\npublic class TestA extends TestB {\n    private String strProp;\n    public String getStrProp() {\n        return strProp;\n    }\n    public void setStrProp(String strProp) {\n        this.strProp = strProp;\n    }\n}\n</code></pre>\n\n<p>Now I create next line of code:</p>\n\n<pre><code>var getter1: KFunction1&lt;TestA, Int&gt; = TestA::getIntProp\n</code></pre>\n\n<p>As you can see, I access from TestA class method of TestB: TestA::getIntProp\nSO the result is instance of KFunction1 with generic params &lt; TestA, Int ></p>\n\n<p>Now I try to create next line of code</p>\n\n<pre><code>var getter2: KFunction1&lt;TestA, Int&gt; = TestB::getIntProp\n</code></pre>\n\n<p>And it also works and compiles, while I expect that there will be compile error</p>\n"}, {"tags": ["intellij-idea", "kotlin", "ideavim"], "comments": [{"owner": {"reputation": 4037, "user_id": 3124227, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/efoMa.jpg?s=128&g=1", "display_name": "Feedforward", "link": "https://stackoverflow.com/users/3124227/feedforward"}, "edited": false, "score": 0, "creation_date": 1576574339, "post_id": 36152700, "comment_id": 104934752, "body": "The issue is fixed with the latest version of IdeaVim (0.53+)"}], "answers": [{"comments": [{"owner": {"reputation": 640, "user_id": 1621904, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cb684d7942802ea33bfeb66db8a0bf5?s=128&d=identicon&r=PG", "display_name": "koto", "link": "https://stackoverflow.com/users/1621904/koto"}, "edited": false, "score": 0, "creation_date": 1458653018, "post_id": 36155365, "comment_id": 59948309, "body": "Thanks for reply, but when I type <code>:actionList</code> I get message from IDE (on bottom bar) saying &#39;VIM - Not an editor command: actionList&#39;"}, {"owner": {"reputation": 3979, "user_id": 818832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1kwBW.png?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/818832/peter"}, "reply_to_user": {"reputation": 640, "user_id": 1621904, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cb684d7942802ea33bfeb66db8a0bf5?s=128&d=identicon&r=PG", "display_name": "koto", "link": "https://stackoverflow.com/users/1621904/koto"}, "edited": false, "score": 1, "creation_date": 1458653255, "post_id": 36155365, "comment_id": 59948481, "body": "Try <code>:actionlist</code> .. not <code>:actionList</code>"}, {"owner": {"reputation": 640, "user_id": 1621904, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cb684d7942802ea33bfeb66db8a0bf5?s=128&d=identicon&r=PG", "display_name": "koto", "link": "https://stackoverflow.com/users/1621904/koto"}, "edited": false, "score": 0, "creation_date": 1458653807, "post_id": 36155365, "comment_id": 59948908, "body": "<code>:actionlist</code> is ok :) I&#39;ll dive into that command and its possibilities soon, but I think it isn&#39;t the problem. I <b>can</b> do copy-paste and I do, but the problem lays not i Vim command itself, but in IDE (or IDE&#39;s plugin) behavior, that&#39;s how I see it."}], "tags": [], "owner": {"reputation": 3979, "user_id": 818832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1kwBW.png?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/818832/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1458734536, "last_edit_date": 1458734536, "creation_date": 1458652489, "answer_id": 36155365, "question_id": 36152700, "link": "https://stackoverflow.com/questions/36152700/intellijs-ideavim-plugin-disables-converting-java-to-kotlin/36155365#36155365", "title": "IntelliJ&#39;s IdeaVim plugin disables converting Java to Kotlin", "body": "<p>The vim plugin takes over the clipboard and past functions. When you type <code>:actionlist</code> you get a list of idea actions you can use in your <code>.ideavimrc</code> file to map keymaps to idea actions. Use <code>:action COMMAND</code> to execute the command.</p>\n\n<p>I.e.:</p>\n\n<p><code>norepmap &lt;C-w&gt;q :action VimWindowClose&lt;cr&gt;</code></p>\n\n<p>closes the current window.</p>\n\n<p>Furthermore, you can search for a particular <code>action</code> with <code>:actionlist Past</code>. \nThis lists </p>\n\n<p><code>EditorPast  &lt;C-V&gt; &lt;S-ins&gt;</code></p>\n\n<p>among other things.</p>\n\n<p>If you want to check if <code>EditorPast</code> ist the right command you can test it using <code>:action EditorPaste</code>.</p>\n\n<p>Another way to make this work is to let idea handle the <code>&lt;C-v&gt;</code> shortcut. This can be archieved with the <code>Settings -&gt; Other Setting -&gt; Vim Emulation</code> settings. The handler (vim or idea) can be defined with that setting.</p>\n"}, {"comments": [{"owner": {"reputation": 3979, "user_id": 818832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1kwBW.png?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/818832/peter"}, "edited": false, "score": 0, "creation_date": 1458658363, "post_id": 36157083, "comment_id": 59952652, "body": "As I wrote above: map the <code>EditorPast</code> action to your favorite shortcut or let IDEA handle the <code>&lt;C-v&gt;</code> shortcut."}, {"owner": {"reputation": 640, "user_id": 1621904, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cb684d7942802ea33bfeb66db8a0bf5?s=128&d=identicon&r=PG", "display_name": "koto", "link": "https://stackoverflow.com/users/1621904/koto"}, "reply_to_user": {"reputation": 3979, "user_id": 818832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1kwBW.png?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/818832/peter"}, "edited": false, "score": 0, "creation_date": 1458661166, "post_id": 36157083, "comment_id": 59954939, "body": "But &lt;C-v&gt; didn&#39;t work because Vim plugin somehow overintercepts pasting and typical Vim shortcut &#39;p&#39; pastes text, I may try remapping <code>EditorPaste</code> though."}, {"owner": {"reputation": 3979, "user_id": 818832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1kwBW.png?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/818832/peter"}, "edited": false, "score": 0, "creation_date": 1458725573, "post_id": 36157083, "comment_id": 59984413, "body": "See my last edit. There is a setting to define which handler should handle a certain action."}], "tags": [], "owner": {"reputation": 640, "user_id": 1621904, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cb684d7942802ea33bfeb66db8a0bf5?s=128&d=identicon&r=PG", "display_name": "koto", "link": "https://stackoverflow.com/users/1621904/koto"}, "is_accepted": true, "score": 1, "last_activity_date": 1458656749, "creation_date": 1458656749, "answer_id": 36157083, "question_id": 36152700, "link": "https://stackoverflow.com/questions/36152700/intellijs-ideavim-plugin-disables-converting-java-to-kotlin/36157083#36157083", "title": "IntelliJ&#39;s IdeaVim plugin disables converting Java to Kotlin", "body": "<p>Ok, guy from JetBrains answered my issue. The obvious workaround (which I didn't figure out) is to <strong>copy and paste from context menu</strong>. Then conversion question shows up. IMO it seems unlikely that IdeaVim plugin will support this feature by yanking and putting (Vim's copying and pasting), as from:</p>\n\n<blockquote>\n  <p>Running IDE actions on copy and paste might be a good idea, but we're not sure it wouldn't disrupt the workflow of the current users.</p>\n</blockquote>\n"}], "owner": {"reputation": 640, "user_id": 1621904, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cb684d7942802ea33bfeb66db8a0bf5?s=128&d=identicon&r=PG", "display_name": "koto", "link": "https://stackoverflow.com/users/1621904/koto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "accepted_answer_id": 36157083, "answer_count": 2, "score": 2, "last_activity_date": 1458734536, "creation_date": 1458644671, "last_edit_date": 1495541733, "question_id": 36152700, "link": "https://stackoverflow.com/questions/36152700/intellijs-ideavim-plugin-disables-converting-java-to-kotlin", "title": "IntelliJ&#39;s IdeaVim plugin disables converting Java to Kotlin", "body": "<p>I would like to use IntelliJ's feature, which converts Java code to Kotlin by simply copy-pasting from Java file to Kotlin file. It is working fine, but when I turn on IdeaVim plugin, it refuses to work anymore. I know Vim decently and I that's not the problem with my misunderstanding Vim edit modes. I am aware of <a href=\"https://stackoverflow.com/questions/34588117/how-can-i-convert-a-part-of-java-source-file-to-kotlin\">How can I convert a part of Java source file to Kotlin?</a> and answer by @yole saying that there is no other tool to do that.</p>\n\n<p>But that answer was made over 3 months ago, and maybe some other tool appeared. So, my question is if someone found workaround to make IdeaVim plugin cooperate with Java to Kotlin conversion. I've already made a ticket on YouTrack: <a href=\"https://youtrack.jetbrains.com/issue/VIM-1103\" rel=\"nofollow noreferrer\">https://youtrack.jetbrains.com/issue/VIM-1103</a> but frankly, I am not so sure if it will be resolved.</p>\n"}, {"tags": ["intellij-idea", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 640, "user_id": 1621904, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cb684d7942802ea33bfeb66db8a0bf5?s=128&d=identicon&r=PG", "display_name": "koto", "link": "https://stackoverflow.com/users/1621904/koto"}, "edited": false, "score": 0, "creation_date": 1458640646, "post_id": 36150528, "comment_id": 59939396, "body": "Thanks @yole. Yeah, seeing any output would be my next step :) At first I wanted the errors disappear."}], "tags": [], "owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "is_accepted": true, "score": 9, "last_activity_date": 1458651327, "last_edit_date": 1458651327, "creation_date": 1458638784, "answer_id": 36150528, "question_id": 36150374, "link": "https://stackoverflow.com/questions/36150374/trying-to-run-kotlin-script-in-intellij-idea/36150528#36150528", "title": "Trying to run Kotlin script in IntelliJ IDEA", "body": "<p>A standalone Kotlin script file needs to have a .kts extension. If you rename your file, you also need to make sure that your run configuration is updated to refer to the new name of the file.</p>\n\n<p>Also, if you create any file (a regular Kotlin file or a .kts file) which only contains a function, running the script will not produce any output, because the function will not be called. To see some output, you need to call the function in your script:</p>\n\n<pre><code>fun hello(): String {\n    return \"ok\"\n}\n\nprintln(hello())\n</code></pre>\n\n<p>The stacktrace that you saw is <a href=\"https://youtrack.jetbrains.com/issue/KT-3045\" rel=\"noreferrer\">a bug in Kotlin</a>.</p>\n"}], "owner": {"reputation": 640, "user_id": 1621904, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cb684d7942802ea33bfeb66db8a0bf5?s=128&d=identicon&r=PG", "display_name": "koto", "link": "https://stackoverflow.com/users/1621904/koto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8003, "favorite_count": 0, "accepted_answer_id": 36150528, "answer_count": 1, "score": 5, "last_activity_date": 1458651327, "creation_date": 1458638300, "question_id": 36150374, "link": "https://stackoverflow.com/questions/36150374/trying-to-run-kotlin-script-in-intellij-idea", "title": "Trying to run Kotlin script in IntelliJ IDEA", "body": "<p>I am learning Kotlin by doing Kotlin Koans int IntelliJ EduKotlin plugin (<a href=\"https://plugins.jetbrains.com/plugin/8186\" rel=\"noreferrer\">https://plugins.jetbrains.com/plugin/8186</a>). While doing tasks and running them im this plugin is working, I am not able to create new Kotlin script and run it <strong>without</strong> this plugin.</p>\n\n<p>Sample code in a file named <strong>Hello.kt</strong>:</p>\n\n<pre><code>fun hello() : String {\n    return \"ok\"\n}\n</code></pre>\n\n<p>Then I create new run configuration derived from 'Kotlin script', set 'Working directory' to ProjectName/src folder (or ProjectName folder, same result) and IDE shows me a 'Could not find script file: Hello.kt' warning as in the screen below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kSOHb.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/kSOHb.png\" alt=\"enter image description here\"></a></p>\n\n<p>And indeed, while trying to run script I got following stacktrace:</p>\n\n<pre><code>\"C:\\Program Files\\Java\\jdk1.8.0_74\\bin\\java\" -Dfile.encoding=windows-1250 -classpath C:\\Users\\myUser\\.IdeaIC2016\\config\\plugins\\Kotlin\\kotlinc\\lib\\kotlin-compiler.jar;C:\\Users\\myUser\\.IdeaIC2016\\config\\plugins\\Kotlin\\kotlinc\\lib\\kotlin-reflect.jar;C:\\Users\\myUser\\.IdeaIC2016\\config\\plugins\\Kotlin\\kotlinc\\lib\\kotlin-runtime.jar org.jetbrains.kotlin.cli.jvm.K2JVMCompiler -script Hello.kt\nexception: java.lang.RuntimeException: Failed to evaluate script: kotlin.KotlinNullPointerException\nat org.jetbrains.kotlin.cli.jvm.compiler.KotlinToJVMBytecodeCompiler.compileScript(KotlinToJVMBytecodeCompiler.kt:263)\nat org.jetbrains.kotlin.cli.jvm.compiler.KotlinToJVMBytecodeCompiler.compileAndExecuteScript(KotlinToJVMBytecodeCompiler.kt:212)\nat org.jetbrains.kotlin.cli.jvm.K2JVMCompiler.doExecute(K2JVMCompiler.kt:181)\nat org.jetbrains.kotlin.cli.jvm.K2JVMCompiler.doExecute(K2JVMCompiler.kt:49)\nat org.jetbrains.kotlin.cli.common.CLICompiler.exec(CLICompiler.java:181)\nat org.jetbrains.kotlin.cli.common.CLICompiler.exec(CLICompiler.java:138)\nat org.jetbrains.kotlin.cli.common.CLICompiler.exec(CLICompiler.java:57)\nat org.jetbrains.kotlin.cli.common.CLICompiler.doMainNoExit(CLICompiler.java:248)\nat org.jetbrains.kotlin.cli.common.CLICompiler.doMain(CLICompiler.java:238)\nat org.jetbrains.kotlin.cli.jvm.K2JVMCompiler$Companion.main(K2JVMCompiler.kt:248)\nat org.jetbrains.kotlin.cli.jvm.K2JVMCompiler.main(K2JVMCompiler.kt)\nCaused by: kotlin.KotlinNullPointerException\nat org.jetbrains.kotlin.cli.jvm.compiler.KotlinToJVMBytecodeCompiler.compileScript(KotlinToJVMBytecodeCompiler.kt:475)\n... 10 more\n\n\nProcess finished with exit code 2\n</code></pre>\n\n<p>What more, the hello method is marked as never used. However, when I change file extension from .kt to .ktscript, then this method is marked as used, and the output from running code is following:</p>\n\n<pre><code>\"C:\\Program Files\\Java\\jdk1.8.0_74\\bin\\java\" -Dfile.encoding=windows-1250 -classpath C:\\Users\\myUser\\.IdeaIC2016\\config\\plugins\\Kotlin\\kotlinc\\lib\\kotlin-compiler.jar;C:\\Users\\myUser\\.IdeaIC2016\\config\\plugins\\Kotlin\\kotlinc\\lib\\kotlin-reflect.jar;C:\\Users\\myUser\\.IdeaIC2016\\config\\plugins\\Kotlin\\kotlinc\\lib\\kotlin-runtime.jar org.jetbrains.kotlin.cli.jvm.K2JVMCompiler -script Hello.kt\n</code></pre>\n\n<p>error: source file or directory not found: Hello.kt</p>\n\n<pre><code>Process finished with exit code 1\n</code></pre>\n\n<p>So my question is: what am I missing when trying to create and run Kotlin code in a standalone Kotlin script in IntelliJ?</p>\n"}, {"tags": ["design-patterns", "kotlin"], "comments": [{"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 1, "creation_date": 1458622114, "post_id": 36140791, "comment_id": 59930248, "body": "do you need <code>model</code> and <code>year</code> to be mutable? Do you change them after a <code>Car</code> creation?"}, {"owner": {"reputation": 1819, "user_id": 2423030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3399e87cdaa04aae3f8574ba717597f8?s=128&d=identicon&r=PG", "display_name": "Keyhan", "link": "https://stackoverflow.com/users/2423030/keyhan"}, "reply_to_user": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1458626570, "post_id": 36140791, "comment_id": 59931932, "body": "I guess they should be immutable yes. Also you want to be sure they are set both and not empty"}, {"owner": {"reputation": 1071, "user_id": 1081827, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/82f3c665bf2b98505b201d2a9fdbb950?s=128&d=identicon&r=PG", "display_name": "JoseF", "link": "https://stackoverflow.com/users/1081827/josef"}, "edited": false, "score": 1, "creation_date": 1534751307, "post_id": 36140791, "comment_id": 90801838, "body": "You can also use this <a href=\"https://github.com/jffiorillo/jvmbuilder\" rel=\"nofollow noreferrer\">github.com/jffiorillo/jvmbuilder</a> Annotation Processor to generate the builder class automatically for you."}, {"owner": {"reputation": 1819, "user_id": 2423030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3399e87cdaa04aae3f8574ba717597f8?s=128&d=identicon&r=PG", "display_name": "Keyhan", "link": "https://stackoverflow.com/users/2423030/keyhan"}, "reply_to_user": {"reputation": 1071, "user_id": 1081827, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/82f3c665bf2b98505b201d2a9fdbb950?s=128&d=identicon&r=PG", "display_name": "JoseF", "link": "https://stackoverflow.com/users/1081827/josef"}, "edited": false, "score": 0, "creation_date": 1534769352, "post_id": 36140791, "comment_id": 90812024, "body": "@JoseF Good idea to add it to standard kotlin. It is useful for libraries written in kotlin."}, {"owner": {"reputation": 3855, "user_id": 342882, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/c13b4dc095a1bcc25e008effdd5cf07a?s=128&d=identicon&r=PG", "display_name": "Daneel Yaitskov", "link": "https://stackoverflow.com/users/342882/daneel-yaitskov"}, "edited": false, "score": 0, "creation_date": 1570557848, "post_id": 36140791, "comment_id": 102947850, "body": "<a href=\"https://github.com/ThinkingLogic/kotlin-builder-annotation\" rel=\"nofollow noreferrer\">github.com/ThinkingLogic/kotlin-builder-annotation</a>"}, {"owner": {"reputation": 1669, "user_id": 9987309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vUtsn.jpg?s=128&g=1", "display_name": "iCantC", "link": "https://stackoverflow.com/users/9987309/icantc"}, "edited": false, "score": 0, "creation_date": 1583217614, "post_id": 36140791, "comment_id": 107031524, "body": "Unless a class has a huge number of constructor params, Kotlin features such as optional, named and property params can easily replace the <code>Builder</code> pattern."}, {"owner": {"reputation": 15791, "user_id": 839733, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/2s6lO.jpg?s=128&g=1", "display_name": "Abhijit Sarkar", "link": "https://stackoverflow.com/users/839733/abhijit-sarkar"}, "edited": false, "score": 0, "creation_date": 1604878498, "post_id": 36140791, "comment_id": 114473804, "body": "Most of the answers miss one basic but important use of a builder, that is to build an <i>immutable</i> object incrementally. There are myriad uses of this, for example, when parsing an input. Creating a new data class for each event would be completely wasteful in that case."}], "answers": [{"comments": [{"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "edited": false, "score": 0, "creation_date": 1458593070, "post_id": 36140918, "comment_id": 59920638, "body": "As far as constructors with default values you can even do validation of input using <a href=\"https://kotlinlang.org/docs/reference/classes.html\" rel=\"nofollow noreferrer\">initializer blocks</a>. However, if you need something stateful (so that you don&#39;t have to specify everything up front) then the builder pattern is still the way to go."}, {"owner": {"reputation": 1819, "user_id": 2423030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3399e87cdaa04aae3f8574ba717597f8?s=128&d=identicon&r=PG", "display_name": "Keyhan", "link": "https://stackoverflow.com/users/2423030/keyhan"}, "edited": false, "score": 0, "creation_date": 1458593646, "post_id": 36140918, "comment_id": 59921000, "body": "Could you give me a simple example with code? Say a simple User class with name and email field with validation for email."}], "tags": [], "owner": {"reputation": 1211, "user_id": 4783965, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-ezsWKyHTPew/AAAAAAAAAAI/AAAAAAAADbE/nZ1PyKNEoWc/photo.jpg?sz=128", "display_name": "Ritave", "link": "https://stackoverflow.com/users/4783965/ritave"}, "is_accepted": false, "score": 0, "last_activity_date": 1458592023, "creation_date": 1458592023, "answer_id": 36140918, "question_id": 36140791, "link": "https://stackoverflow.com/questions/36140791/how-to-implement-builder-pattern-in-kotlin/36140918#36140918", "title": "How to implement Builder pattern in Kotlin?", "body": "<p>I would say the pattern and implementation stays pretty much the same in Kotlin. You can sometimes skip it thanks to default values, but for more complicated object creation, builders are still a useful tool that can't be omitted.</p>\n"}, {"comments": [{"owner": {"reputation": 1819, "user_id": 2423030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3399e87cdaa04aae3f8574ba717597f8?s=128&d=identicon&r=PG", "display_name": "Keyhan", "link": "https://stackoverflow.com/users/2423030/keyhan"}, "edited": false, "score": 2, "creation_date": 1458627980, "post_id": 36146423, "comment_id": 59932576, "body": "Thanks a lot for the answer. I like your approach but the downside is for a class with many parameters it becomes not so friendly to use the constructor and also test the class."}, {"owner": {"reputation": 1254, "user_id": 3362350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e4500858d24434055bd01b57bdc734f?s=128&d=identicon&r=PG", "display_name": "Jacob Zimmerman", "link": "https://stackoverflow.com/users/3362350/jacob-zimmerman"}, "edited": false, "score": 1, "creation_date": 1458652394, "post_id": 36146423, "comment_id": 59947786, "body": "+Keyhan two other ways you can do validation, assuming the validation doesn&#39;t happen between the fields: 1) use property delegates where the setter does validation - this is pretty much the same thing as having a normal setter that does validation 2) Avoid primitive obsession and create new types to pass in that validate themselves."}, {"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "reply_to_user": {"reputation": 1819, "user_id": 2423030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3399e87cdaa04aae3f8574ba717597f8?s=128&d=identicon&r=PG", "display_name": "Keyhan", "link": "https://stackoverflow.com/users/2423030/keyhan"}, "edited": false, "score": 1, "creation_date": 1458841375, "post_id": 36146423, "comment_id": 60046548, "body": "@Keyhan this is a classic approach in Python, it works very well even for functions with tens of arguments. The trick here is to use named arguments (not available in Java!)"}, {"owner": {"reputation": 1819, "user_id": 2423030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3399e87cdaa04aae3f8574ba717597f8?s=128&d=identicon&r=PG", "display_name": "Keyhan", "link": "https://stackoverflow.com/users/2423030/keyhan"}, "edited": false, "score": 1, "creation_date": 1459032938, "post_id": 36146423, "comment_id": 60113985, "body": "Yes, it is also a solution worth using, it seems unlike java where builder class have some clear advantages, in Kotlin it is not so obvious, talked to C# developers, C# also have kotlin like features (default value and you could name params when calling constructor) they did not use builder pattern either."}, {"owner": {"reputation": 4427, "user_id": 4706743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b05c3b09628ba8955d6d7a188271af?s=128&d=identicon&r=PG&f=1", "display_name": "D3xter", "link": "https://stackoverflow.com/users/4706743/d3xter"}, "edited": false, "score": 0, "creation_date": 1493489463, "post_id": 36146423, "comment_id": 74442804, "body": "I&#39;d argue against that approach, if some logic to construct an instance is needed. This approach mixes a simple POJO/Data-Class with its construction and that is against the &quot;Single Responsibility&quot; and the &quot;Closed for modification, open for extension&quot;-Principle"}, {"owner": {"reputation": 348, "user_id": 1602807, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rUxbo.jpg?s=128&g=1", "display_name": "vxh.viet", "link": "https://stackoverflow.com/users/1602807/vxh-viet"}, "edited": false, "score": 0, "creation_date": 1511323017, "post_id": 36146423, "comment_id": 81807813, "body": "Would you say <code>Builder</code> in Kotlin is more appropriate for mixed code base that contain both Java and Kotlin? If from the Java side we would need to frequently access a Kotlin object, it won&#39;t look too pretty if said object has 10 params in its constructor, is it?"}, {"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "reply_to_user": {"reputation": 348, "user_id": 1602807, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rUxbo.jpg?s=128&g=1", "display_name": "vxh.viet", "link": "https://stackoverflow.com/users/1602807/vxh-viet"}, "edited": false, "score": 1, "creation_date": 1511332366, "post_id": 36146423, "comment_id": 81810740, "body": "@vxh.viet many of such cases can be solved with <code>@JvmOverloads</code> <a href=\"http://kotlinlang.org/docs/reference/java-to-kotlin-interop.html#overloads-generation\" rel=\"nofollow noreferrer\">kotlinlang.org/docs/reference/&hellip;</a>"}], "tags": [], "owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "is_accepted": false, "score": 8, "last_activity_date": 1458841780, "last_edit_date": 1458841780, "creation_date": 1458622838, "answer_id": 36146423, "question_id": 36140791, "link": "https://stackoverflow.com/questions/36140791/how-to-implement-builder-pattern-in-kotlin/36146423#36146423", "title": "How to implement Builder pattern in Kotlin?", "body": "<p>I personally have never seen a builder in Kotlin, but maybe it is just me.</p>\n\n<p>All validation one needs happens in the <code>init</code> block:</p>\n\n<pre><code>class Car(val model: String,\n          val year: Int = 2000) {\n\n    init {\n        if(year &lt; 1900) throw Exception(\"...\")\n    }\n}\n</code></pre>\n\n<p>Here I took a liberty to guess that you don't really wanted <code>model</code> and <code>year</code> to be changeable. Also those default values seems to have no sense, (especially <code>null</code> for <code>name</code>) but I left one for demonstration purposes.</p>\n\n<p><strong>An Opinion:</strong>\nThe builder pattern used in Java as a mean to live without named parameters. In languages with named parameters (like Kotlin or Python) it is a good practice to have constructors with long lists of (maybe optional) parameters.</p>\n"}, {"comments": [{"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1458926215, "post_id": 36150989, "comment_id": 60080369, "body": "@kirill seriously, what&#39;s the gain compared to a long list of (optional) parameters in a constructor? Like in a real-life situation?"}, {"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "edited": false, "score": 2, "creation_date": 1458933544, "post_id": 36150989, "comment_id": 60084112, "body": "Nothing, but the author of the question specifically asked how to implement the builder pattern."}, {"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 1, "creation_date": 1459057455, "post_id": 36150989, "comment_id": 60118575, "body": "@KirillRakhman &quot;a pattern&quot; by its definition is a code construct that people often use to solve a particular problem. The <code>Builder</code> boilerplate solves nothing in Kotlin, and that&#39;s why it is not used. I thing it is worth mentioning somewhere in your answer, for people not to thing this is something idiomatic"}, {"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "edited": false, "score": 4, "creation_date": 1459185329, "post_id": 36150989, "comment_id": 60161790, "body": "I should correct myself, the builder pattern has some advantages, e.g. you could pass a partially constructed builder to another method. But you&#39;re right, I&#39;ll add a remark."}, {"owner": {"reputation": 1819, "user_id": 2423030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3399e87cdaa04aae3f8574ba717597f8?s=128&d=identicon&r=PG", "display_name": "Keyhan", "link": "https://stackoverflow.com/users/2423030/keyhan"}, "edited": false, "score": 0, "creation_date": 1459800079, "post_id": 36150989, "comment_id": 60439409, "body": "Actually in the beginning my question was if builder is needed in Kotlin and if so how to implement but then I got a remark that my question was not clear enough so I removed the part asking if Builder is useful in Kotlin. However I still think Kirills code is very good and useful in understanding Kotlin."}, {"owner": {"reputation": 1819, "user_id": 2423030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3399e87cdaa04aae3f8574ba717597f8?s=128&d=identicon&r=PG", "display_name": "Keyhan", "link": "https://stackoverflow.com/users/2423030/keyhan"}, "edited": false, "score": 4, "creation_date": 1459888057, "post_id": 36150989, "comment_id": 60487470, "body": "@KirillRakhman how about calling the builder from java? Is there an easy way to make the builder available to java?"}, {"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "edited": false, "score": 7, "creation_date": 1459935382, "post_id": 36150989, "comment_id": 60507198, "body": "All three versions can be called from Java like so: <code>Car.Builder builder = new Car.Builder();</code>. However only the first version has a fluent interface so the calls to the second and third versions can&#39;t be chained."}, {"owner": {"reputation": 4427, "user_id": 4706743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b05c3b09628ba8955d6d7a188271af?s=128&d=identicon&r=PG&f=1", "display_name": "D3xter", "link": "https://stackoverflow.com/users/4706743/d3xter"}, "reply_to_user": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1493488904, "post_id": 36150989, "comment_id": 74442626, "body": "@voddan you mean (optional) parameters in the constructor of the POJO?"}, {"owner": {"reputation": 124764, "user_id": 90848, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/tK3A3.jpg?s=128&g=1", "display_name": "Laurence Gonsalves", "link": "https://stackoverflow.com/users/90848/laurence-gonsalves"}, "edited": false, "score": 0, "creation_date": 1493747298, "post_id": 36150989, "comment_id": 74531150, "body": "How can you set more than one property when using the second or third implementations shown here?"}, {"owner": {"reputation": 124764, "user_id": 90848, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/tK3A3.jpg?s=128&g=1", "display_name": "Laurence Gonsalves", "link": "https://stackoverflow.com/users/90848/laurence-gonsalves"}, "edited": false, "score": 0, "creation_date": 1493747386, "post_id": 36150989, "comment_id": 74531204, "body": "By the way, in the first implementation you can write the setter methods more concisely: <code>fun model(model: String) = apply { this.model = model }</code>"}, {"owner": {"reputation": 411, "user_id": 4325925, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KzfQf8mrgKM/AAAAAAAAAAI/AAAAAAAAAEs/AwOnmHhInQk/photo.jpg?sz=128", "display_name": "Kata Lune", "link": "https://stackoverflow.com/users/4325925/kata-lune"}, "edited": false, "score": 0, "creation_date": 1496073225, "post_id": 36150989, "comment_id": 75501363, "body": "The builder patter not only allow you to use partially constructed object, but the main purpose - to avoid mistakes and increase code readability. Instead of new Car(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;) you will have new Car.Builder().model(&quot;A&quot;).owner(&quot;B&quot;).company(&quot;C&quot;).build()."}, {"owner": {"reputation": 6474, "user_id": 270143, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tB6Fg.jpg?s=128&g=1", "display_name": "ycomp", "link": "https://stackoverflow.com/users/270143/ycomp"}, "edited": false, "score": 11, "creation_date": 1496929138, "post_id": 36150989, "comment_id": 75872030, "body": "I think the kotlin example at the top only explains one possible use case. The main reason I use builders is to convert a mutable object into an immutable one. That is, I need to mutate it over time while I&#39;m &quot;building&quot; and then come up with an immutable object. At least in my code there are only one or 2 examples of code that has so many variations of parameters that I would use a builder instead of several different constructors. But to make an immutable object, I have a few cases where a builder is definitely the cleanest way I can think of."}, {"owner": {"reputation": 348, "user_id": 1602807, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rUxbo.jpg?s=128&g=1", "display_name": "vxh.viet", "link": "https://stackoverflow.com/users/1602807/vxh-viet"}, "edited": false, "score": 0, "creation_date": 1511322480, "post_id": 36150989, "comment_id": 81807685, "body": "I&#39;m also new on Kotlin and have been working through the Kotlin In Action book. In chapter 5.5.2, when it describe the <code>apply</code> function, it also specific state that this is the Kotlin way for <i>builder pattern</i>. With both named argument and <code>apply</code>, is there any legit reason that one would want to explicit implement a <code>Builder</code> in Kotlin?"}, {"owner": {"reputation": 735, "user_id": 157423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e5e4869d7885e33e91f056d9522fe05?s=128&d=identicon&r=PG", "display_name": "Adam Ho\u0161ek", "link": "https://stackoverflow.com/users/157423/adam-ho%c5%a1ek"}, "reply_to_user": {"reputation": 6474, "user_id": 270143, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tB6Fg.jpg?s=128&g=1", "display_name": "ycomp", "link": "https://stackoverflow.com/users/270143/ycomp"}, "edited": false, "score": 1, "creation_date": 1511544538, "post_id": 36150989, "comment_id": 81910347, "body": "@ycomp If you can make it data class, Kotlin generates a <code>copy</code> function with the same args as the constructor but with default values from the instance. So if performance is not an issue you can use that. Or you can write the <code>copy</code> function yourself:      class Person(val name: String, val age: Int) {         fun copy(             name: String = this.name,             age: Int = this.age         ) = Person(name, age)     }"}, {"owner": {"reputation": 4391, "user_id": 3106174, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/mKAhl.jpg?s=128&g=1", "display_name": "Advice-Dog", "link": "https://stackoverflow.com/users/3106174/advice-dog"}, "edited": false, "score": 0, "creation_date": 1548891756, "post_id": 36150989, "comment_id": 95710929, "body": "@KirillRakhman I think the example usage should be <code>val car = Car.Builder().model(&quot;X&quot;).build()</code> instead of <code>.builder()</code>."}, {"owner": {"reputation": 25765, "user_id": 534471, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sb2VI.png?s=128&g=1", "display_name": "Emanuel Moecklin", "link": "https://stackoverflow.com/users/534471/emanuel-moecklin"}, "edited": false, "score": 0, "creation_date": 1609366937, "post_id": 36150989, "comment_id": 115827190, "body": "I created some sample code to illustrate the different approaches for the builder pattern in Kotlin here: <a href=\"https://github.com/1gravity/design_patterns/tree/main/src/main/kotlin/com/onegravity/designpatterns/builder\" rel=\"nofollow noreferrer\">github.com/1gravity/design_patterns/tree/main/src/main/kotli&zwnj;&#8203;n/&hellip;</a>. On top of the proposed solution I created a DSL based variation."}], "tags": [], "owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "is_accepted": true, "score": 321, "last_activity_date": 1549010303, "last_edit_date": 1549010303, "creation_date": 1458640087, "answer_id": 36150989, "question_id": 36140791, "link": "https://stackoverflow.com/questions/36140791/how-to-implement-builder-pattern-in-kotlin/36150989#36150989", "title": "How to implement Builder pattern in Kotlin?", "body": "<p>First and foremost, in most cases you don't need to use builders in Kotlin because we have default and named arguments. This enables you to write</p>\n\n<pre><code>class Car(val model: String? = null, val year: Int = 0)\n</code></pre>\n\n<p>and use it like so:</p>\n\n<pre><code>val car = Car(model = \"X\")\n</code></pre>\n\n<p>If you absolutely want to use builders, here's how you could do it:</p>\n\n<p>Making the Builder a <code>companion object</code> doesn't make sense because <code>object</code>s are singletons. Instead declare it as an nested class (which is static by default in Kotlin).</p>\n\n<p>Move the properties to the constructor so the object can also be instantiated the regular way (make the constructor private if it shouldn't) and use a secondary constructor that takes a builder and delegates to the primary constructor. The code will look as follow:</p>\n\n<pre><code>class Car( //add private constructor if necessary\n        val model: String?,\n        val year: Int\n) {\n\n    private constructor(builder: Builder) : this(builder.model, builder.year)\n\n    class Builder {\n        var model: String? = null\n            private set\n\n        var year: Int = 0\n            private set\n\n        fun model(model: String) = apply { this.model = model }\n\n        fun year(year: Int) = apply { this.year = year }\n\n        fun build() = Car(this)\n    }\n}\n</code></pre>\n\n<p>Usage: <code>val car = Car.Builder().model(\"X\").build()</code></p>\n\n<p>This code can be shortened additionally by using a <a href=\"https://kotlinlang.org/docs/reference/type-safe-builders.html\" rel=\"noreferrer\">builder DSL</a>:</p>\n\n<pre><code>class Car (\n        val model: String?,\n        val year: Int\n) {\n\n    private constructor(builder: Builder) : this(builder.model, builder.year)\n\n    companion object {\n        inline fun build(block: Builder.() -&gt; Unit) = Builder().apply(block).build()\n    }\n\n    class Builder {\n        var model: String? = null\n        var year: Int = 0\n\n        fun build() = Car(this)\n    }\n}\n</code></pre>\n\n<p>Usage: <code>val car = Car.build { model = \"X\" }</code></p>\n\n<p>If some values are required and don't have default values, you need to put them in the constructor of the builder and also in the <code>build</code> method we just defined:</p>\n\n<pre><code>class Car (\n        val model: String?,\n        val year: Int,\n        val required: String\n) {\n\n    private constructor(builder: Builder) : this(builder.model, builder.year, builder.required)\n\n    companion object {\n        inline fun build(required: String, block: Builder.() -&gt; Unit) = Builder(required).apply(block).build()\n    }\n\n    class Builder(\n            val required: String\n    ) {\n        var model: String? = null\n        var year: Int = 0\n\n        fun build() = Car(this)\n    }\n}\n</code></pre>\n\n<p>Usage: <code>val car = Car.build(required = \"requiredValue\") { model = \"X\" }</code></p>\n"}, {"comments": [{"owner": {"reputation": 4608, "user_id": 820666, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w8QYD.jpg?s=128&g=1", "display_name": "Bastian Voigt", "link": "https://stackoverflow.com/users/820666/bastian-voigt"}, "edited": false, "score": 8, "creation_date": 1513383478, "post_id": 38098526, "comment_id": 82646980, "body": "In Jackson you don&#39;t actually need to have an empty constructor, and fields don&#39;t need to be mutable. You just have to annotate your constructor parameters with <code>@JsonProperty</code>"}, {"owner": {"reputation": 7014, "user_id": 800334, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a070788360df4847afbf6797a1a5bcaf?s=128&d=identicon&r=PG", "display_name": "Amir Abiri", "link": "https://stackoverflow.com/users/800334/amir-abiri"}, "edited": false, "score": 2, "creation_date": 1521179995, "post_id": 38098526, "comment_id": 85629572, "body": "You don&#39;t even have to annotate with <code>@JsonProperty</code> anymore, if you compile with the <code>-parameters</code> switch."}, {"owner": {"reputation": 1819, "user_id": 2423030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3399e87cdaa04aae3f8574ba717597f8?s=128&d=identicon&r=PG", "display_name": "Keyhan", "link": "https://stackoverflow.com/users/2423030/keyhan"}, "edited": false, "score": 2, "creation_date": 1522428073, "post_id": 38098526, "comment_id": 86163730, "body": "Jackson can actually be configured to use a builder."}, {"owner": {"reputation": 1039, "user_id": 2702713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a771ddb65aa83ec0fd875877ada64ef6?s=128&d=identicon&r=PG", "display_name": "Nils Breunese", "link": "https://stackoverflow.com/users/2702713/nils-breunese"}, "edited": false, "score": 1, "creation_date": 1537444282, "post_id": 38098526, "comment_id": 91791753, "body": "If you add the jackson-module-kotlin module to your project, you can just use data classes and it will work."}, {"owner": {"reputation": 234, "user_id": 3744047, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lPE46.jpg?s=128&g=1", "display_name": "ZeroStatic", "link": "https://stackoverflow.com/users/3744047/zerostatic"}, "edited": false, "score": 2, "creation_date": 1575833142, "post_id": 38098526, "comment_id": 104689507, "body": "How is this doing the same thing as a Builder Pattern? You are instantiating the final product and then swapping out / adding information. The whole point of the Builder pattern is to not be able to get the final product until all the necessary information is present.  Removing the .apply() leaves you with an undefined car. Removing all the constructor arguments from Builder leaves you with a Car Builder, and if you try to build it into a car, you&#39;ll likely run into an exception for not having specified the model and year yet. They are not the same thing."}], "tags": [], "owner": {"reputation": 16132, "user_id": 560358, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/M4qx3.jpg?s=128&g=1", "display_name": "David V&#225;vra", "link": "https://stackoverflow.com/users/560358/david-v%c3%a1vra"}, "is_accepted": false, "score": 10, "last_activity_date": 1467200497, "creation_date": 1467200497, "answer_id": 38098526, "question_id": 36140791, "link": "https://stackoverflow.com/questions/36140791/how-to-implement-builder-pattern-in-kotlin/38098526#38098526", "title": "How to implement Builder pattern in Kotlin?", "body": "<p>Because I'm using Jackson library for parsing objects from JSON, I need to have an empty constructor and I can't have optional fields. Also all fields have to be mutable. Then I can use this nice syntax which does the same thing as Builder pattern:</p>\n\n<pre><code>val car = Car().apply{ model = \"Ford\"; year = 2000 }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1819, "user_id": 2423030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3399e87cdaa04aae3f8574ba717597f8?s=128&d=identicon&r=PG", "display_name": "Keyhan", "link": "https://stackoverflow.com/users/2423030/keyhan"}, "edited": false, "score": 0, "creation_date": 1487061903, "post_id": 40227289, "comment_id": 71603035, "body": "Thanks, but I was thinking of using it from java as well. As far as I know optional arguments would not work from java."}], "tags": [], "owner": {"reputation": 7443, "user_id": 361832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hb6yU.jpg?s=128&g=1", "display_name": "Dariusz Bacinski", "link": "https://stackoverflow.com/users/361832/dariusz-bacinski"}, "is_accepted": false, "score": 3, "last_activity_date": 1521710061, "last_edit_date": 1521710061, "creation_date": 1477342100, "answer_id": 40227289, "question_id": 36140791, "link": "https://stackoverflow.com/questions/36140791/how-to-implement-builder-pattern-in-kotlin/40227289#40227289", "title": "How to implement Builder pattern in Kotlin?", "body": "<p>For a simple class you don't need a separate builder. You can make use of optional constructor arguments as Kirill Rakhman described.</p>\n\n<p>If you have more complex class then Kotlin provides a way to create Groovy style Builders/DSL:</p>\n\n<p><a href=\"https://kotlinlang.org/docs/reference/type-safe-builders.html\" rel=\"nofollow noreferrer\">Type-Safe Builders</a> </p>\n\n<p>Here is an example:</p>\n\n<p><a href=\"https://github.com/dbacinski/Design-Patterns-In-Kotlin#builder--assembler\" rel=\"nofollow noreferrer\">Github Example - Builder / Assembler</a> </p>\n"}, {"tags": [], "owner": {"reputation": 5654, "user_id": 2939690, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/71797fe963333d41de913eb798916eae?s=128&d=identicon&r=PG", "display_name": "vuhung3990", "link": "https://stackoverflow.com/users/2939690/vuhung3990"}, "is_accepted": false, "score": 0, "last_activity_date": 1495590595, "creation_date": 1495590595, "answer_id": 44147659, "question_id": 36140791, "link": "https://stackoverflow.com/questions/36140791/how-to-implement-builder-pattern-in-kotlin/44147659#44147659", "title": "How to implement Builder pattern in Kotlin?", "body": "<p>you can use optional parameter in kotlin\nexample:</p>\n\n<pre><code>fun myFunc(p1: String, p2: Int = -1, p3: Long = -1, p4: String = \"default\") {\n    System.out.printf(\"parameter %s %d %d %s\\n\", p1, p2, p3, p4)\n}\n</code></pre>\n\n<p>then </p>\n\n<pre><code>myFunc(\"a\")\nmyFunc(\"a\", 1)\nmyFunc(\"a\", 1, 2)\nmyFunc(\"a\", 1, 2, \"b\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2384, "user_id": 452486, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/a8k4V.jpg?s=128&g=1", "display_name": "Arst", "link": "https://stackoverflow.com/users/452486/arst"}, "is_accepted": false, "score": 5, "last_activity_date": 1496964031, "last_edit_date": 1496964031, "creation_date": 1496714582, "answer_id": 44380278, "question_id": 36140791, "link": "https://stackoverflow.com/questions/36140791/how-to-implement-builder-pattern-in-kotlin/44380278#44380278", "title": "How to implement Builder pattern in Kotlin?", "body": "<p>I have seen many examples that declare extra funs as builders. I personally like this approach. Save effort to write builders.</p>\n\n<pre><code>package android.zeroarst.lab.koltinlab\n\nimport kotlin.properties.Delegates\n\nclass Lab {\n    companion object {\n        @JvmStatic fun main(args: Array&lt;String&gt;) {\n\n            val roy = Person {\n                name = \"Roy\"\n                age = 33\n                height = 173\n                single = true\n                car {\n                    brand = \"Tesla\"\n                    model = \"Model X\"\n                    year = 2017\n                }\n                car {\n                    brand = \"Tesla\"\n                    model = \"Model S\"\n                    year = 2018\n                }\n            }\n\n            println(roy)\n        }\n\n        class Person() {\n            constructor(init: Person.() -&gt; Unit) : this() {\n                this.init()\n            }\n\n            var name: String by Delegates.notNull()\n            var age: Int by Delegates.notNull()\n            var height: Int by Delegates.notNull()\n            var single: Boolean by Delegates.notNull()\n            val cars: MutableList&lt;Car&gt; by lazy { arrayListOf&lt;Car&gt;() }\n\n            override fun toString(): String {\n                return \"name=$name, age=$age, \" +\n                        \"height=$height, \" +\n                        \"single=${when (single) {\n                            true -&gt; \"looking for a girl friend T___T\"\n                            false -&gt; \"Happy!!\"\n                        }}\\nCars: $cars\"\n            }\n        }\n\n        class Car() {\n\n            var brand: String by Delegates.notNull()\n            var model: String by Delegates.notNull()\n            var year: Int by Delegates.notNull()\n\n            override fun toString(): String {\n                return \"(brand=$brand, model=$model, year=$year)\"\n            }\n        }\n\n        fun Person.car(init: Car.() -&gt; Unit): Unit {\n            cars.add(Car().apply(init))\n        }\n\n    }\n}\n</code></pre>\n\n<p>I have not yet found a way that can force some fields to be initialized in DSL like showing errors instead of throwing exceptions. Let me know if anyone knows.</p>\n"}, {"tags": [], "owner": {"reputation": 4081, "user_id": 4097092, "user_type": "registered", "profile_image": "https://graph.facebook.com/1053290162/picture?type=large", "display_name": "Brandon Rude", "link": "https://stackoverflow.com/users/4097092/brandon-rude"}, "is_accepted": false, "score": 0, "last_activity_date": 1527285556, "creation_date": 1527285556, "answer_id": 50537350, "question_id": 36140791, "link": "https://stackoverflow.com/questions/36140791/how-to-implement-builder-pattern-in-kotlin/50537350#50537350", "title": "How to implement Builder pattern in Kotlin?", "body": "<pre><code>class Foo private constructor(@DrawableRes requiredImageRes: Int, optionalTitle: String?) {\n\n    @DrawableRes\n    @get:DrawableRes\n    val requiredImageRes: Int\n\n    val optionalTitle: String?\n\n    init {\n        this.requiredImageRes = requiredImageRes\n        this.requiredImageRes = optionalTitle\n    }\n\n    class Builder {\n\n        @DrawableRes\n        private var requiredImageRes: Int = -1\n\n        private var optionalTitle: String? = null\n\n        fun requiredImageRes(@DrawableRes imageRes: Int): Builder {\n            this.intent = intent\n            return this\n        } \n\n        fun optionalTitle(title: String): Builder {\n            this.optionalTitle = title\n            return this\n        }\n\n        fun build(): Foo {\n            if(requiredImageRes == -1) {\n                throw IllegalStateException(\"No image res provided\")\n            }\n            return Foo(this.requiredImageRes, this.optionalTitle)\n        }\n\n    }\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 10289238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9da351fd06864c771c30c795201b2ae?s=128&d=identicon&r=PG", "display_name": "danield", "link": "https://stackoverflow.com/users/10289238/danield"}, "is_accepted": false, "score": 2, "last_activity_date": 1543498576, "last_edit_date": 1543498576, "creation_date": 1541076736, "answer_id": 53101674, "question_id": 36140791, "link": "https://stackoverflow.com/questions/36140791/how-to-implement-builder-pattern-in-kotlin/53101674#53101674", "title": "How to implement Builder pattern in Kotlin?", "body": "<p>People nowdays should check Kotlin's <a href=\"https://kotlinlang.org/docs/reference/type-safe-builders.html\" rel=\"nofollow noreferrer\">Type-Safe Builders</a>.</p>\n\n<p>Using said way of object creation will look something like this:</p>\n\n<pre><code>html {\n    head {\n        title {+\"XML encoding with Kotlin\"}\n    }\n    // ...\n}\n</code></pre>\n\n<p>A nice 'in-action' usage example is the <a href=\"https://github.com/mvysny/vaadin-on-kotlin\" rel=\"nofollow noreferrer\">vaadin-on-kotlin</a> framework, which utilizes typesafe builders to <a href=\"https://github.com/mvysny/vaadin-on-kotlin#defining-ui-dsl-style\" rel=\"nofollow noreferrer\">assemble views and components</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 622, "user_id": 819710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Us2AK.jpg?s=128&g=1", "display_name": "Moises Portillo", "link": "https://stackoverflow.com/users/819710/moises-portillo"}, "is_accepted": false, "score": 0, "last_activity_date": 1542331972, "creation_date": 1542331972, "answer_id": 53330216, "question_id": 36140791, "link": "https://stackoverflow.com/questions/36140791/how-to-implement-builder-pattern-in-kotlin/53330216#53330216", "title": "How to implement Builder pattern in Kotlin?", "body": "<p>I implemented a basic Builder pattern in Kotlin with the follow code:</p>\n\n<pre><code>data class DialogMessage(\n        var title: String = \"\",\n        var message: String = \"\"\n) {\n\n\n    class Builder( context: Context){\n\n\n        private var context: Context = context\n        private var title: String = \"\"\n        private var message: String = \"\"\n\n        fun title( title : String) = apply { this.title = title }\n\n        fun message( message : String ) = apply { this.message = message  }    \n\n        fun build() = KeyoDialogMessage(\n                title,\n                message\n        )\n\n    }\n\n    private lateinit var  dialog : Dialog\n\n    fun show(){\n        this.dialog= Dialog(context)\n        .\n        .\n        .\n        dialog.show()\n\n    }\n\n    fun hide(){\n        if( this.dialog != null){\n            this.dialog.dismiss()\n        }\n    }\n}\n</code></pre>\n\n<p>And finally </p>\n\n<p>Java:</p>\n\n<pre><code>new DialogMessage.Builder( context )\n       .title(\"Title\")\n       .message(\"Message\")\n       .build()\n       .show();\n</code></pre>\n\n<p>Kotlin:</p>\n\n<pre><code>DialogMessage.Builder( context )\n       .title(\"Title\")\n       .message(\"\")\n       .build()\n       .show()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 223, "user_id": 995322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664de777a23de49a9433c9747e0cbe20?s=128&d=identicon&r=PG", "display_name": "YetAnotherMatt", "link": "https://stackoverflow.com/users/995322/yetanothermatt"}, "is_accepted": false, "score": 1, "last_activity_date": 1552908989, "creation_date": 1552908989, "answer_id": 55220464, "question_id": 36140791, "link": "https://stackoverflow.com/questions/36140791/how-to-implement-builder-pattern-in-kotlin/55220464#55220464", "title": "How to implement Builder pattern in Kotlin?", "body": "<p>I was working on a Kotlin project that exposed an API consumed by Java clients (which can't take advantage of the Kotlin language constructs). We had to add builders to make them usable in Java, so I created an @Builder annotation: <a href=\"https://github.com/ThinkingLogic/kotlin-builder-annotation\" rel=\"nofollow noreferrer\">https://github.com/ThinkingLogic/kotlin-builder-annotation</a>\n - it's basically a replacement for the Lombok @Builder annotation for Kotlin.</p>\n"}, {"comments": [{"owner": {"reputation": 963, "user_id": 6938998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a42d7cb22db231d00a71bbb404a7b98f?s=128&d=identicon&r=PG&f=1", "display_name": "sVd", "link": "https://stackoverflow.com/users/6938998/svd"}, "edited": false, "score": 1, "creation_date": 1592943479, "post_id": 55534077, "comment_id": 110605139, "body": "Thanks a lot! You made my day! Your answer should be marked as SOLUTION."}], "tags": [], "owner": {"reputation": 441, "user_id": 11316741, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5_gz_qp59II/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rceO82w4Q2t3VnMeaNzmVzpx5DGdg/mo/photo.jpg?sz=128", "display_name": "Dmitrii Bychkov", "link": "https://stackoverflow.com/users/11316741/dmitrii-bychkov"}, "is_accepted": false, "score": 39, "last_activity_date": 1554462551, "creation_date": 1554462551, "answer_id": 55534077, "question_id": 36140791, "link": "https://stackoverflow.com/questions/36140791/how-to-implement-builder-pattern-in-kotlin/55534077#55534077", "title": "How to implement Builder pattern in Kotlin?", "body": "<p>One approach is to do something like the following:</p>\n\n<pre><code>class Car(\n  val model: String?,\n  val color: String?,\n  val type: String?) {\n\n    data class Builder(\n      var model: String? = null,\n      var color: String? = null,\n      var type: String? = null) {\n\n        fun model(model: String) = apply { this.model = model }\n        fun color(color: String) = apply { this.color = color }\n        fun type(type: String) = apply { this.type = type }\n        fun build() = Car(model, color, type)\n    }\n}\n</code></pre>\n\n<p>Usage sample:</p>\n\n<pre><code>val car = Car.Builder()\n  .model(\"Ford Focus\")\n  .color(\"Black\")\n  .type(\"Type\")\n  .build()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1875, "user_id": 4465373, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Z3oCj.jpg?s=128&g=1", "display_name": "Farruh Habibullaev", "link": "https://stackoverflow.com/users/4465373/farruh-habibullaev"}, "is_accepted": false, "score": 1, "last_activity_date": 1561143157, "creation_date": 1561143157, "answer_id": 56708982, "question_id": 36140791, "link": "https://stackoverflow.com/questions/36140791/how-to-implement-builder-pattern-in-kotlin/56708982#56708982", "title": "How to implement Builder pattern in Kotlin?", "body": "<p>I am late to the party. I also encountered the same dilemma if I had to use Builder pattern in the project. Later, after research I have realized it is absolutely unnecessary since Kotlin already provides the named arguments and default arguments.</p>\n\n<p>If you really need to implement, Kirill Rakhman's answer is solid answer on how to implement in most effective way. Another thing you may find it useful is <a href=\"https://www.baeldung.com/kotlin-builder-pattern\" rel=\"nofollow noreferrer\">https://www.baeldung.com/kotlin-builder-pattern</a> you can compare and contrast with Java and Kotlin on their implementation</p>\n"}], "owner": {"reputation": 1819, "user_id": 2423030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3399e87cdaa04aae3f8574ba717597f8?s=128&d=identicon&r=PG", "display_name": "Keyhan", "link": "https://stackoverflow.com/users/2423030/keyhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72168, "favorite_count": 43, "accepted_answer_id": 36150989, "answer_count": 13, "score": 164, "last_activity_date": 1561143157, "creation_date": 1458591595, "last_edit_date": 1458654530, "question_id": 36140791, "link": "https://stackoverflow.com/questions/36140791/how-to-implement-builder-pattern-in-kotlin", "title": "How to implement Builder pattern in Kotlin?", "body": "<p>Hi I am a newbie in the Kotlin world. I like what I see so far and started to think to convert some of our libraries we use in our application from Java to Kotlin.</p>\n\n<p>These libraries are full of Pojos with setters, getters and Builder classes. Now I have googled to find what is the best way to implement Builders in Kotlin but no success.</p>\n\n<p>2nd Update: The question is how to write a Builder design-pattern for a simple pojo with some parameters in Kotlin? The code below is my attempt by writing java code and then using the eclipse-kotlin-plugin to convert to Kotlin.</p>\n\n<pre><code>class Car private constructor(builder:Car.Builder) {\n    var model:String? = null\n    var year:Int = 0\n    init {\n        this.model = builder.model\n        this.year = builder.year\n    }\n    companion object Builder {\n        var model:String? = null\n        private set\n\n        var year:Int = 0\n        private set\n\n        fun model(model:String):Builder {\n            this.model = model\n            return this\n        }\n        fun year(year:Int):Builder {\n            this.year = year\n            return this\n        }\n        fun build():Car {\n            val car = Car(this)\n            return car\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["android-studio", "libgdx", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 2241515, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/69737b148d81ff4555ebedde85679bd8?s=128&d=identicon&r=PG", "display_name": "user2241515", "link": "https://stackoverflow.com/users/2241515/user2241515"}, "edited": false, "score": 0, "creation_date": 1458590057, "post_id": 36139468, "comment_id": 59919065, "body": "I changed to LinkedList(listOf()) and it got an unresolved reference error. So I added import java.util.LinkedList and now it works.   So we now need a reference to java.util? That doesn&#39;t sound right.   btw - this is working in 1.0.0, and removed in 1.0.1? Way to go with breaking change management IntelliJ!"}, {"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "reply_to_user": {"reputation": 123, "user_id": 2241515, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/69737b148d81ff4555ebedde85679bd8?s=128&d=identicon&r=PG", "display_name": "user2241515", "link": "https://stackoverflow.com/users/2241515/user2241515"}, "edited": false, "score": 0, "creation_date": 1458590185, "post_id": 36139468, "comment_id": 59919145, "body": "@user2241515, if you just need an empty <code>LinkedList</code>, you can call its constructor and pass nothing in it: <code>val bullets: MutableList&lt;NewBullet&gt; = LinkedList()</code>"}, {"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "reply_to_user": {"reputation": 123, "user_id": 2241515, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/69737b148d81ff4555ebedde85679bd8?s=128&d=identicon&r=PG", "display_name": "user2241515", "link": "https://stackoverflow.com/users/2241515/user2241515"}, "edited": false, "score": 1, "creation_date": 1458590537, "post_id": 36139468, "comment_id": 59919345, "body": "@user2241515, Kotlin doesn&#39;t have its own implementations for Java&#39;s collections interfaces, so you have to use <code>java.util.LinkedList</code>. As to the change in stdlib, no, it was made before 1.0.0 release, in Release Candidate phase."}, {"owner": {"reputation": 123, "user_id": 2241515, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/69737b148d81ff4555ebedde85679bd8?s=128&d=identicon&r=PG", "display_name": "user2241515", "link": "https://stackoverflow.com/users/2241515/user2241515"}, "edited": false, "score": 0, "creation_date": 1458590642, "post_id": 36139468, "comment_id": 59919412, "body": "It works with this version:bruce@barsoom:~/Git/shmupwarz$ kotlinc -version info: Kotlin Compiler version 1.0.0"}, {"owner": {"reputation": 123, "user_id": 2241515, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/69737b148d81ff4555ebedde85679bd8?s=128&d=identicon&r=PG", "display_name": "user2241515", "link": "https://stackoverflow.com/users/2241515/user2241515"}, "edited": false, "score": 0, "creation_date": 1458590723, "post_id": 36139468, "comment_id": 59919461, "body": "I never installed a pre-release version"}, {"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "reply_to_user": {"reputation": 123, "user_id": 2241515, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/69737b148d81ff4555ebedde85679bd8?s=128&d=identicon&r=PG", "display_name": "user2241515", "link": "https://stackoverflow.com/users/2241515/user2241515"}, "edited": false, "score": 0, "creation_date": 1458590792, "post_id": 36139468, "comment_id": 59919501, "body": "@user2241515, then most probably they dropped the deprecated function. It seems more or less OK in regard to backward compatibility. It had been surely deprecated by 1.0.0 release anyway."}, {"owner": {"reputation": 123, "user_id": 2241515, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/69737b148d81ff4555ebedde85679bd8?s=128&d=identicon&r=PG", "display_name": "user2241515", "link": "https://stackoverflow.com/users/2241515/user2241515"}, "edited": false, "score": 0, "creation_date": 1458591610, "post_id": 36139468, "comment_id": 59919941, "body": "It&#39;s a little disconcerting. One reason I&#39;m looking at Kotlin is that it&#39;s NOT java. I&#39;m looking for an alternative to FSharp, and on the jvm, that would seem to be scala or kotlin. Having to use a java data object for a core element of my performance critical code, at the last moment, I wonder if that is kotlin&#39;s way of saying &#39;use scala...&#39;"}, {"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "reply_to_user": {"reputation": 123, "user_id": 2241515, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/69737b148d81ff4555ebedde85679bd8?s=128&d=identicon&r=PG", "display_name": "user2241515", "link": "https://stackoverflow.com/users/2241515/user2241515"}, "edited": false, "score": 0, "creation_date": 1458592380, "post_id": 36139468, "comment_id": 59920293, "body": "@user2241515, well, Kotlin has Java (not Scala \u263a) interoperability in priorities, and using Java&#39;s collections is a mean of compatibility with Java code. If you are concerned with the performance, Kotlin still works on JVM (compiled into JVM bytecode), so if kotlin-stdlib had own implementations of collections, they would hardly be considerably faster than <code>java.util.*</code> ones."}], "tags": [], "owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "is_accepted": false, "score": 3, "last_activity_date": 1458588761, "last_edit_date": 1458588761, "creation_date": 1458586856, "answer_id": 36139468, "question_id": 36139204, "link": "https://stackoverflow.com/questions/36139204/kotlin-unresolved-reference-linkedlistof/36139468#36139468", "title": "Kotlin unresolved reference linkedListOf", "body": "<p>As said in the <a href=\"https://gist.github.com/abreslav/f60fc0de060e7ed721c9\" rel=\"nofollow\">change log</a> of Kotlin 1.0 RC, <code>linkedListOf</code> has been deprecated and is not available now. The article you referenced uses Kotlin 1.0 Beta, which is older.</p>\n\n<p>To create a <code>LinkedList&lt;T&gt;</code> from varargs, you can pass a <code>listOf(...)</code> to the constructor:</p>\n\n<pre><code>val bullets: MutableList&lt;SomeType&gt; = LinkedList(listOf(item1, item2))\n</code></pre>\n\n<p>or write your own <code>linkedListOf</code>:</p>\n\n<pre><code>fun &lt;T&gt; linkedListOf(vararg items: T) = LinkedList&lt;T&gt;().apply { \n    for (i in items) { add(i) }\n}\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 2241515, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/69737b148d81ff4555ebedde85679bd8?s=128&d=identicon&r=PG", "display_name": "user2241515", "link": "https://stackoverflow.com/users/2241515/user2241515"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2068, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1458589734, "creation_date": 1458585993, "last_edit_date": 1458589734, "question_id": 36139204, "link": "https://stackoverflow.com/questions/36139204/kotlin-unresolved-reference-linkedlistof", "title": "Kotlin unresolved reference linkedListOf", "body": "<p>Following this post <a href=\"http://obviam.net/index.php/libgdx-and-kotlin/\" rel=\"nofollow\">http://obviam.net/index.php/libgdx-and-kotlin/</a> I\ncreated a project, and edited using Atom. It compiles, and runs on an android device. I want to convert to AndroidStudio for better tooling. </p>\n\n<p>I'm using AndroidStudio 1.5.1, and it says I have the latest version of the kotlin plugin. I created a new project using the LibGDX setup program, imported into AdroidStudio, converted the main class to kotlin, everything works. Then I pasted in my existing my code, and when I build, this line:</p>\n\n<pre><code>val bullets:MutableList&lt;NewBullet&gt; = linkedListOf() \n</code></pre>\n\n<p>gets this error:</p>\n\n<blockquote>\n  <p>Error:(19, 42) Unresolved reference: linkedListOf</p>\n</blockquote>\n\n<p>When I select Tools -> Kotlin -> Configure it says 'All modules with Kotlin files are configured'.  </p>\n\n<p>I've also tried importing the existing project into AndroidStudio, and the result is the same issue.</p>\n"}, {"tags": ["kotlin", "lazy-sequences"], "answers": [{"tags": [], "owner": {"reputation": 29521, "user_id": 1950649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yb5YJ.jpg?s=128&g=1", "display_name": "Vladimir Mironov", "link": "https://stackoverflow.com/users/1950649/vladimir-mironov"}, "is_accepted": true, "score": 6, "last_activity_date": 1458505443, "last_edit_date": 1458505443, "creation_date": 1458505070, "answer_id": 36119004, "question_id": 36118822, "link": "https://stackoverflow.com/questions/36118822/kotlin-sequence-function-unresolved-reference/36119004#36119004", "title": "Kotlin sequence function unresolved reference", "body": "<p>This function used to be named <code>sequence</code> but the name was changed to <code>generateSequence</code> starting from <code>1.0.0</code> release. <code>Iterable&lt;T&gt;.sequence</code> was renamed to <code>Iterable&lt;T&gt;.asSequence</code> as well:</p>\n\n<pre><code>val elements = generateSequence(1) { x -&gt; x + 1 }\nval elements = listOf(1, 2, 3, 4).asSequence()\n</code></pre>\n"}], "owner": {"reputation": 1731, "user_id": 780350, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/afaa8b1a1e2fe1b53755564e5fa34568?s=128&d=identicon&r=PG", "display_name": "melston", "link": "https://stackoverflow.com/users/780350/melston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 620, "favorite_count": 0, "accepted_answer_id": 36119004, "answer_count": 1, "score": 3, "last_activity_date": 1458505443, "creation_date": 1458504196, "question_id": 36118822, "link": "https://stackoverflow.com/questions/36118822/kotlin-sequence-function-unresolved-reference", "title": "Kotlin sequence function unresolved reference", "body": "<ul>\n<li>Kotlin 1.0.0</li>\n<li>IDEA 2016.1</li>\n</ul>\n\n<p>I have found a couple of references to the new <code>sequence</code> function used to create a sequence (no longer called <code>stream</code>).  <a href=\"http://blog.jetbrains.com/kotlin/2015/03/kotlin-m11-is-out/\" rel=\"nofollow\">The JetBrains blog</a> gives the following examples:</p>\n\n<pre><code>val elements = sequence(1, { x -&gt; x + 1})\nval elements = listOf(1, 2, 3, 4).sequence()\n</code></pre>\n\n<p><a href=\"http://agilewombat.com/2016/02/06/kotlin-sequences/\" rel=\"nofollow\">The AgileWombat blog</a> gives similar examples.  </p>\n\n<pre><code>val squares = sequence(1) {it + 1}.map {it * it}\n</code></pre>\n\n<p>However, when I try any of these examples, either in the REPL or in the IDE (IDEA 2016.1), I get the following:</p>\n\n<pre><code>&gt;&gt;&gt; val squares = sequence(1) {it + 1}.map {it * it}\nerror: unresolved reference: sequence\nval squares = sequence(1) {it + 1}.map {it * it}\n              ^\nerror: unresolved reference: it\nval squares = sequence(1) {it + 1}.map {it * it}\n                           ^\n</code></pre>\n\n<p>I have the latest plugin for the IDE and the latest kotlin package downloaded.  So I must be doing something wrong.  </p>\n"}, {"tags": ["kotlin"], "comments": [{"owner": {"reputation": 798, "user_id": 1032286, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/6RfSS.png?s=128&g=1", "display_name": "Adel Nizamutdinov", "link": "https://stackoverflow.com/users/1032286/adel-nizamutdinov"}, "edited": false, "score": 5, "creation_date": 1458504884, "post_id": 36118235, "comment_id": 59878155, "body": "one huge thing about vals is the lack of parametricity, this does not compile: <code>val id = fun&lt;T&gt;(t:T) = t</code>"}, {"owner": {"reputation": 41540, "user_id": 127013, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5cfa38a7e54e6c6a850dc6169a699246?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/127013/matthias"}, "reply_to_user": {"reputation": 798, "user_id": 1032286, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/6RfSS.png?s=128&g=1", "display_name": "Adel Nizamutdinov", "link": "https://stackoverflow.com/users/1032286/adel-nizamutdinov"}, "edited": false, "score": 0, "creation_date": 1458505489, "post_id": 36118235, "comment_id": 59878373, "body": "Ah good point! Hadn&#39;t thought about that. Definitely something to consider."}, {"owner": {"reputation": 1254, "user_id": 3362350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e4500858d24434055bd01b57bdc734f?s=128&d=identicon&r=PG", "display_name": "Jacob Zimmerman", "link": "https://stackoverflow.com/users/3362350/jacob-zimmerman"}, "edited": false, "score": 0, "creation_date": 1458558359, "post_id": 36118235, "comment_id": 59897475, "body": "Does g have access to instance properties?"}, {"owner": {"reputation": 41540, "user_id": 127013, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5cfa38a7e54e6c6a850dc6169a699246?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/127013/matthias"}, "reply_to_user": {"reputation": 1254, "user_id": 3362350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e4500858d24434055bd01b57bdc734f?s=128&d=identicon&r=PG", "display_name": "Jacob Zimmerman", "link": "https://stackoverflow.com/users/3362350/jacob-zimmerman"}, "edited": false, "score": 0, "creation_date": 1458561371, "post_id": 36118235, "comment_id": 59899335, "body": "@JacobZimmerman it does, although indeed not apparent from my example. Thanks for pointing it out."}], "answers": [{"comments": [{"owner": {"reputation": 9051, "user_id": 4433326, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-0eT2bjizzRQ/AAAAAAAAAAI/AAAAAAAA6WQ/O6mD60Yyahc/photo.jpg?sz=128", "display_name": "Louis CAD", "link": "https://stackoverflow.com/users/4433326/louis-cad"}, "edited": false, "score": 0, "creation_date": 1486488644, "post_id": 36119364, "comment_id": 71362978, "body": "Could you add the <code>f</code> and <code>g</code> function definitions so we have more context when reading your answer?"}, {"owner": {"reputation": 233128, "user_id": 807126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpNqK.jpg?s=128&g=1", "display_name": "Doug Stevenson", "link": "https://stackoverflow.com/users/807126/doug-stevenson"}, "reply_to_user": {"reputation": 9051, "user_id": 4433326, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-0eT2bjizzRQ/AAAAAAAAAAI/AAAAAAAA6WQ/O6mD60Yyahc/photo.jpg?sz=128", "display_name": "Louis CAD", "link": "https://stackoverflow.com/users/4433326/louis-cad"}, "edited": false, "score": 0, "creation_date": 1486489752, "post_id": 36119364, "comment_id": 71363647, "body": "f and g are defined in the question."}, {"owner": {"reputation": 9051, "user_id": 4433326, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-0eT2bjizzRQ/AAAAAAAAAAI/AAAAAAAA6WQ/O6mD60Yyahc/photo.jpg?sz=128", "display_name": "Louis CAD", "link": "https://stackoverflow.com/users/4433326/louis-cad"}, "edited": false, "score": 0, "creation_date": 1486490169, "post_id": 36119364, "comment_id": 71363883, "body": "Yeah, but copying them would help readability and save some mouse wheels, especially since there&#39;s other answers between the question and your answer"}, {"owner": {"reputation": 2644, "user_id": 2957169, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mf8Nx.jpg?s=128&g=1", "display_name": "charles-allen", "link": "https://stackoverflow.com/users/2957169/charles-allen"}, "edited": false, "score": 2, "creation_date": 1573122990, "post_id": 36119364, "comment_id": 103782362, "body": "Is this not just because the syntax is different? <code>a.g</code> is a reference to a fun; <code>a.f</code> is not; you should use method reference syntax: <code>a::f</code>. Having just tested this, <code>exe(a::f)</code> does indeed work!"}], "tags": [], "owner": {"reputation": 233128, "user_id": 807126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpNqK.jpg?s=128&g=1", "display_name": "Doug Stevenson", "link": "https://stackoverflow.com/users/807126/doug-stevenson"}, "is_accepted": false, "score": 3, "last_activity_date": 1565936700, "last_edit_date": 1565936700, "creation_date": 1458506773, "answer_id": 36119364, "question_id": 36118235, "link": "https://stackoverflow.com/questions/36118235/function-definition-fun-vs-val/36119364#36119364", "title": "Function definition: fun vs val", "body": "<p>Here's some code showing how f and g are different when it comes to usage:</p>\n\n<pre><code>fun main(args: Array&lt;String&gt;) {\n    val a = A()\n    exe(a.g)  // OK\n    //exe(a.f)  // does not compile\n    exe { a.f(it) }  // OK\n}\n\nfun exe(p: (Int) -&gt; Int) {\n    println(p(0))\n}\n</code></pre>\n\n<p>Where <code>f</code> and <code>g</code> are:</p>\n\n<pre><code>  fun f(x: Int) = 42\n\n  val g = fun(x: Int) = 42\n</code></pre>\n\n<p>You can see that g is an object that can be used like a lambda, but f cannot.  To use f similarly, you have to wrap it in a lambda.</p>\n"}, {"comments": [{"owner": {"reputation": 41540, "user_id": 127013, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5cfa38a7e54e6c6a850dc6169a699246?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/127013/matthias"}, "edited": false, "score": 2, "creation_date": 1458549241, "post_id": 36119407, "comment_id": 59891762, "body": "Ah great, this is exactly the kind of information I was looking for. Follow up question: would &quot;reifying&quot; <code>f</code> using <code>::f</code> result in Kotlin creating an internal function class similarly to what you describe here is done for <code>g</code>?"}, {"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "edited": false, "score": 0, "creation_date": 1458551089, "post_id": 36119407, "comment_id": 59892678, "body": "Basicly yes. Only when you use <code>inline</code> function, the class generation may be skipped."}], "tags": [], "owner": {"reputation": 29521, "user_id": 1950649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yb5YJ.jpg?s=128&g=1", "display_name": "Vladimir Mironov", "link": "https://stackoverflow.com/users/1950649/vladimir-mironov"}, "is_accepted": false, "score": 39, "last_activity_date": 1477645809, "last_edit_date": 1477645809, "creation_date": 1458507008, "answer_id": 36119407, "question_id": 36118235, "link": "https://stackoverflow.com/questions/36118235/function-definition-fun-vs-val/36119407#36119407", "title": "Function definition: fun vs val", "body": "<p>Kotlin is all about Java interoperability and defining a function as a <code>val</code> will produce a completely different result in terms of the interoperability. The following Kotlin class:</p>\n\n<pre><code>class A {\n  fun f(x: Int) = 42\n  val g = fun(x: Int) = 42\n}\n</code></pre>\n\n<p>is effectively equivalent to:</p>\n\n<pre><code>public class A {\n  private final Function1&lt;Integer, Integer&gt; gref = new Function1&lt;Integer, Integer&gt;() {\n    @Override\n    public Integer invoke(final Integer integer) {\n      return 42;\n    }\n  };\n\n  public int f(final int value) {\n    return 42;\n  }\n\n  public Function1&lt;Integer, Integer&gt; getG() {\n    return gref;\n  }\n}\n</code></pre>\n\n<p>As you can see, the main differences are:</p>\n\n<ol>\n<li><code>fun f</code> is just a usual method, while <code>val g</code> in fact is a higher-order function that returns another function</li>\n<li><code>val g</code> involves creation of a new class which isn't good if you are targeting Android</li>\n<li><code>val g</code> requires unnecessary boxing and unboxing</li>\n<li><code>val g</code> cannot be easily invoked from java: <code>A().g(42)</code> in Kotlin vs <code>new A().getG().invoke(42)</code> in Java</li>\n</ol>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>Regarding the <code>A::f</code> syntax. The compiler will generate an extra <code>Function2&lt;A, Integer, Integer&gt;</code> class for <strong>every</strong> <code>A::f</code> occurrence, so the following code results in two extra classes with <strong>7 methods</strong> each:</p>\n\n<pre><code>val first = A::f\nval second = A::f\n</code></pre>\n\n<p>Kotlin compiler isn't smart enough at the moment to optimize such kind of things. You can vote for the issue here <a href=\"https://youtrack.jetbrains.com/issue/KT-9831\" rel=\"noreferrer\">https://youtrack.jetbrains.com/issue/KT-9831</a>. In case you are interested, here is how each class looks in the bytecode: <a href=\"https://gist.github.com/nsk-mironov/fc13f2075bfa05d8a3c3\" rel=\"noreferrer\">https://gist.github.com/nsk-mironov/fc13f2075bfa05d8a3c3</a></p>\n"}], "owner": {"reputation": 41540, "user_id": 127013, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5cfa38a7e54e6c6a850dc6169a699246?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/127013/matthias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3019, "favorite_count": 6, "answer_count": 2, "score": 39, "last_activity_date": 1565936700, "creation_date": 1458500971, "question_id": 36118235, "link": "https://stackoverflow.com/questions/36118235/function-definition-fun-vs-val", "title": "Function definition: fun vs val", "body": "<p>I'm curious about what is the suggested way to define member functions in Kotlin. Consider these two member functions:</p>\n\n<pre><code>class A {\n\n  fun f(x: Int) = 42\n\n  val g = fun(x: Int) = 42\n\n}\n</code></pre>\n\n<p>These appear to accomplish the same thing, but I found subtle differences.</p>\n\n<p>The <code>val</code> based definition, for instance, seems to be more flexible in some scenarios. That is, I could not work out a straight forward way to compose <code>f</code> with other functions, but I could with <code>g</code>. To toy around with these definitions, I used the <a href=\"https://github.com/MarioAriasC/funKTionale\">funKTionale</a> library. I found that this does not compile:</p>\n\n<pre><code>val z = g andThen A::f // f is a member function\n</code></pre>\n\n<p>But if <code>f</code> were defined as a <code>val</code> pointing to the same function, it would compile just fine. To figure out what was going on I asked IntelliJ to explicitly define the type of <code>::f</code> and <code>g</code> for me, and it gives me this:</p>\n\n<pre><code>val fref: KFunction1&lt;Int, Int&gt; = ::f\n\nval gref: (Int) -&gt; Int = g\n</code></pre>\n\n<p>So one is of type <code>KFunction1&lt;Int, Int&gt;</code>, the other is of type <code>(Int) -&gt; Int</code>. It's easy to see that both represent functions of type <code>Int -&gt; Int</code>.</p>\n\n<p>What is the difference between these two types, and in which cases does it matter? I noticed that for top-level functions, I can compose them fine using either definition, but in order to make the aforementioned composition compile, I had to write it like so:</p>\n\n<pre><code>val z = g andThen A::f.partially1(this)\n</code></pre>\n\n<p>i.e. I had to partially apply it to <code>this</code> first.</p>\n\n<p>Since I don't have to go through this hassle when using <code>val</code>s for functions, is there a reason why I should ever define non-Unit member functions using <code>fun</code>? Is there a difference in performance or semantics that I am missing?</p>\n"}, {"tags": ["kotlin"], "comments": [{"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 1, "creation_date": 1458510166, "post_id": 36117471, "comment_id": 59880022, "body": "could you please provide a reference to an example of the pattern you want? In some other programming language maybe"}, {"owner": {"reputation": 85, "user_id": 2285491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59e627b6c1333b39ab7cafb210b087d2?s=128&d=identicon&r=PG&f=1", "display_name": "jjvr", "link": "https://stackoverflow.com/users/2285491/jjvr"}, "reply_to_user": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 1, "creation_date": 1458545407, "post_id": 36117471, "comment_id": 59890049, "body": "I edited my question @voddan"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 2285491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59e627b6c1333b39ab7cafb210b087d2?s=128&d=identicon&r=PG&f=1", "display_name": "jjvr", "link": "https://stackoverflow.com/users/2285491/jjvr"}, "edited": false, "score": 0, "creation_date": 1458566065, "post_id": 36131970, "comment_id": 59902614, "body": "Thank you! It is what he wanted."}], "tags": [], "owner": {"reputation": 50303, "user_id": 170842, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/c2ea72b8d001d81fb6ce3f356e45eb3a?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/170842/michael"}, "is_accepted": true, "score": 2, "last_activity_date": 1458642509, "last_edit_date": 1458642509, "creation_date": 1458565850, "answer_id": 36131970, "question_id": 36117471, "link": "https://stackoverflow.com/questions/36117471/elementary-functions-in-kotlin/36131970#36131970", "title": "Elementary functions in kotlin", "body": "<p>You can use lambdas instead of regular classes and overload operators to combine lambdas.</p>\n\n<pre><code>fun lin(k: Float) = { i: Int, x: Float -&gt;\n  when (i) {\n    0 -&gt; k * x\n    1 -&gt; k\n    else -&gt; 0.0f\n  }\n}\n\noperator fun ((Int, Float) -&gt; Float).plus(that: (Int, Float) -&gt; Float) =\n    { i: Int, x: Float -&gt; this(i, x) + that(i, x) }\n\nfun doSomething() {\n  val sum = lin(1f) + lin(2f)\n  val res = sum(0, 3.78f)\n}\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 2285491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59e627b6c1333b39ab7cafb210b087d2?s=128&d=identicon&r=PG&f=1", "display_name": "jjvr", "link": "https://stackoverflow.com/users/2285491/jjvr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 36131970, "answer_count": 1, "score": 0, "last_activity_date": 1458642509, "creation_date": 1458496993, "last_edit_date": 1458553416, "question_id": 36117471, "link": "https://stackoverflow.com/questions/36117471/elementary-functions-in-kotlin", "title": "Elementary functions in kotlin", "body": "<p>Looking for a way to get elementary functions and their derivatives I approach it like this:</p>\n\n<pre><code>abstract class Fun() {\n    /** \n     * i = 0 -- the function itself, \n     * i = 1, 2, 3, ... -- its successive derivatives\n     */\n    abstract fun d(i: Int, x: Float): Float\n}\n\nclass Lin(val k: Float) : Fun() { \n    // y = k*x\n    override fun d(i: Int, x: Float, p: Float) = when (i) {\n        0 -&gt; k * x\n        1 -&gt; k\n        else -&gt; 0.0f\n    }\n}\n\nclass Sum(val fun0: Fun, val fun1: Fun) : Fun() {\n    // y = fun0(x) + fun1(x)\n    override fun d(i: Int, x: Float, p: Float) = fun0.d(i, x) + fun1.d(i, x)\n}\n\nclass Example(val fun1: Fun, val fun2: Fun){\n    var res = fun1.d(0, 5.25f) // fun1 value at 5.25f\n    res = fun1.d(1, 3.29f) // fun1 first derivative at  3.29f\n    val sum = Sum(fun1, fun2) // sum of f1 and f2\n    res = sum(0, 3.78f) // sum value at 3.78f\n    res = sum(1, 5.69f) // sum first derivative at 5.69f\n}\n</code></pre>\n\n<p>Is there a more idiomatic way to do it in Kotlin?</p>\n\n<p>I have exposed the problem as I had done in Java, that is, classes that contain functions. My question is if I can do the same with functions, pass them on to a class like:</p>\n\n<pre><code>class ParametricCurveXYZ(val fun_x: Fun, val fun_y: Fun, val fun_z: Fun) {\n\n    fun pointToXYZ(s: Float) = VectorXYZ(fun_x.d(0, s), fun_y.d(0, s),    fun_z.d(0, s))\n\n    fun tangent(s: Float) = VectorXYZ(fun_x.d(1, s), fun_y.d(1, s), fun_z.d(1, s)).normalized()\n\n}\n</code></pre>\n"}, {"tags": ["kotlin"], "answers": [{"comments": [{"owner": {"reputation": 3297, "user_id": 1857807, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/DSWJ2.jpg?s=128&g=1", "display_name": "Kuno", "link": "https://stackoverflow.com/users/1857807/kuno"}, "edited": false, "score": 0, "creation_date": 1458554496, "post_id": 36108388, "comment_id": 59894862, "body": "I tested this and it works however I I find the solution of kirill more readable. Still have an upvote."}, {"owner": {"reputation": 4310, "user_id": 7870874, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/rEroC.jpg?s=128&g=1", "display_name": "Sira Lam", "link": "https://stackoverflow.com/users/7870874/sira-lam"}, "edited": false, "score": 0, "creation_date": 1527833681, "post_id": 36108388, "comment_id": 88284166, "body": "For me, since the initialization depends on something not yet calculated, I have to use backing property."}], "tags": [], "owner": {"reputation": 20461, "user_id": 1452094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a12b28824b215e4886da2e9f376369f?s=128&d=identicon&r=PG", "display_name": "Kiskae", "link": "https://stackoverflow.com/users/1452094/kiskae"}, "is_accepted": false, "score": 2, "last_activity_date": 1458429306, "creation_date": 1458429306, "answer_id": 36108388, "question_id": 36108286, "link": "https://stackoverflow.com/questions/36108286/ignore-setter-and-set-property-directly/36108388#36108388", "title": "Ignore setter and set property directly", "body": "<p>I believe the best solution is to use the 'backing property' concept described here: <a href=\"https://kotlinlang.org/docs/reference/properties.html#backing-properties\" rel=\"nofollow\">https://kotlinlang.org/docs/reference/properties.html#backing-properties</a></p>\n\n<pre><code>private var _table: Map&lt;String, Int&gt;? = null\npublic val table: Map&lt;String, Int&gt;\n  get() {\n    if (_table == null)\n      _table = HashMap() // Type parameters are inferred\n    return _table ?: throw AssertionError(\"Set to null by another thread\")\n  }\n</code></pre>\n\n<p>Then initialize the backing property in the constructor and do <code>&lt;backingproperty&gt; = value</code> instead of <code>field = value</code> as well as point the getter to the backing property.</p>\n"}, {"tags": [], "owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "is_accepted": false, "score": 0, "last_activity_date": 1458510034, "creation_date": 1458510034, "answer_id": 36119938, "question_id": 36108286, "link": "https://stackoverflow.com/questions/36108286/ignore-setter-and-set-property-directly/36119938#36119938", "title": "Ignore setter and set property directly", "body": "<p>Take a look at <code>by map</code> delegate, seems like this is the pattern you want:</p>\n\n<pre><code>class User(val map: MutableMap&lt;String, Any?&gt;) {\n    var name: String by map\n    var age: Int     by map\n}\n</code></pre>\n\n<p><a href=\"https://kotlinlang.org/docs/reference/delegated-properties.html#storing-properties-in-a-map\" rel=\"nofollow\">https://kotlinlang.org/docs/reference/delegated-properties.html#storing-properties-in-a-map</a></p>\n"}, {"tags": [], "owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "is_accepted": true, "score": 3, "last_activity_date": 1458559687, "last_edit_date": 1458559687, "creation_date": 1458550867, "answer_id": 36126663, "question_id": 36108286, "link": "https://stackoverflow.com/questions/36108286/ignore-setter-and-set-property-directly/36126663#36126663", "title": "Ignore setter and set property directly", "body": "<p>You need to directily initiliaze the property with the correct value. You can do this using the <code>run</code> function from the stdlib:</p>\n\n<pre><code>class UserManager @Inject constructor(\n        val prefs: SharedPreferences,\n        val jsonAdapter: JsonAdapter&lt;User&gt;\n) {\n\n    companion object {\n        val USER = \"user\"\n    }\n\n    var user: User = run {\n        val userString = prefs.getString(USER, null)\n        if (userString != null) {\n            jsonAdapter.fromJson(userString)\n        } else {\n            User()\n        }\n    }\n        set(value) {\n            field = value\n            prefs.edit().putString(USER, jsonAdapter.toJson(user)).apply()\n        }\n}\n</code></pre>\n\n<p>Shorter syntax proposed by Ilya Ryzhenkov on the Kotlin Slack:</p>\n\n<pre><code>var user: User = prefs.getString(USER, null)?.let { jsonAdapter.fromJson(it) } ?: User()\n    set(value) {\n        field = value\n        prefs.edit().putString(USER, jsonAdapter.toJson(user)).apply()\n    }\n</code></pre>\n"}], "owner": {"reputation": 3297, "user_id": 1857807, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/DSWJ2.jpg?s=128&g=1", "display_name": "Kuno", "link": "https://stackoverflow.com/users/1857807/kuno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 908, "favorite_count": 0, "accepted_answer_id": 36126663, "answer_count": 3, "score": 2, "last_activity_date": 1458559687, "creation_date": 1458428557, "question_id": 36108286, "link": "https://stackoverflow.com/questions/36108286/ignore-setter-and-set-property-directly", "title": "Ignore setter and set property directly", "body": "<p>I have a class that writes a user to SharedPreferences every time it is set:</p>\n\n<pre><code>class UserManager @Inject constructor(\n        val prefs: SharedPreferences,\n        val jsonAdapter: JsonAdapter&lt;User&gt;\n    ) {\n\n    companion object {\n        val USER = \"user\"\n    }\n\n    var user: User = User()\n        set(value) {\n            field = value\n            prefs.edit().putString(USER, jsonAdapter.toJson(user)).apply()\n        }\n\n    init {\n        val userString = prefs.getString(USER, null)\n        if (userString != null) {\n            user = jsonAdapter.fromJson(userString)\n        }\n    }\n}\n</code></pre>\n\n<p><strong>Problem:</strong> If the user is set in the init block, it calls the setter and writes the user that we just got from the shared prefs... to the shared prefs.</p>\n\n<p><strong>Question 1:</strong> How can I directly set the property from the init block?</p>\n\n<p><strong>Question 2:</strong> Why do I have to initialize the User when I define a custom setter, but can omit the initialization when the default setter is used?</p>\n"}, {"tags": ["kotlin"], "comments": [{"owner": {"reputation": 11834, "user_id": 1538877, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/N9qfZ.jpg?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/1538877/ruslan"}, "edited": false, "score": 1, "creation_date": 1458373680, "post_id": 36099066, "comment_id": 59841919, "body": "What do you try to accomplish?"}, {"owner": {"reputation": 179, "user_id": 937070, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fc47e34663f359d08fdffd03098b0149?s=128&d=identicon&r=PG", "display_name": "\u041d\u0438\u043a\u043e\u043b\u0430\u0439 \u041c\u0438\u0448\u0438\u043d", "link": "https://stackoverflow.com/users/937070/%d0%9d%d0%b8%d0%ba%d0%be%d0%bb%d0%b0%d0%b9-%d0%9c%d0%b8%d1%88%d0%b8%d0%bd"}, "reply_to_user": {"reputation": 11834, "user_id": 1538877, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/N9qfZ.jpg?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/1538877/ruslan"}, "edited": false, "score": 0, "creation_date": 1458391082, "post_id": 36099066, "comment_id": 59846505, "body": "I try to write geneology program, which read date from csv and build tree in browser, in perl I using  Plack, but what I can use in Kotlin? Spring?"}], "answers": [{"tags": [], "owner": {"reputation": 11834, "user_id": 1538877, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/N9qfZ.jpg?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/1538877/ruslan"}, "is_accepted": true, "score": 4, "last_activity_date": 1458377994, "last_edit_date": 1458377994, "creation_date": 1458373802, "answer_id": 36099282, "question_id": 36099066, "link": "https://stackoverflow.com/questions/36099066/why-my-code-unreachable/36099282#36099282", "title": "Why my code unreachable?", "body": "<p>If you want create a new instance of Person in the main method, you need to move your main function out of the class to the package level:</p>\n\n<pre><code>data class Person(\n        val id: Int,\n        val name: String\n)\n\nfun main(args: Array&lt;String&gt;) {\n    val person = Person(1, \"Nikolay\")\n    println(\"my name is ${person.name}\")\n}\n</code></pre>\n\n<p>Now you can play with Kotlin.</p>\n"}], "owner": {"reputation": 179, "user_id": 937070, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fc47e34663f359d08fdffd03098b0149?s=128&d=identicon&r=PG", "display_name": "\u041d\u0438\u043a\u043e\u043b\u0430\u0439 \u041c\u0438\u0448\u0438\u043d", "link": "https://stackoverflow.com/users/937070/%d0%9d%d0%b8%d0%ba%d0%be%d0%bb%d0%b0%d0%b9-%d0%9c%d0%b8%d1%88%d0%b8%d0%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3372, "favorite_count": 1, "accepted_answer_id": 36099282, "answer_count": 1, "score": 2, "last_activity_date": 1458391616, "creation_date": 1458372351, "last_edit_date": 1458391616, "question_id": 36099066, "link": "https://stackoverflow.com/questions/36099066/why-my-code-unreachable", "title": "Why my code unreachable?", "body": "<p>I'm new to Kotlin and trying to write a genealogy program, but I got an error:</p>\n\n<pre><code>Warning:(30, 14) Kotlin: Parameter 'args' is never used\nWarning:(32, 9) Kotlin: Unreachable code\n</code></pre>\n\n<p>How do I fix it?</p>\n\n<pre><code>data class Person(\n        val id: Int,\n        val name: String\n) {\n\n    fun main(args: Array&lt;String&gt;) {\n        val person = Person(1, \"Nikolay\")\n        println(\"my name is ${person.name}\")\n    }\n}\n</code></pre>\n\n<p>I could not figure out how to make it work.</p>\n\n<p>Waw, it works!</p>\n\n<pre><code>data class Person(\n        val id: Int,\n        val name: String,\n        val gender: Int,\n        val father: Int,\n        val mother: Int,\n        val children: List&lt;Int&gt;,\n        val email: String,\n        val homepage: String,\n        val date_of_birth: String,\n        val date_of_death: String,\n        val is_living: Boolean,\n        val place_of_birth: String,\n        val place_of_death: String,\n        val cemetery: String,\n        val schools: List&lt;String&gt;,\n        val jobs: List&lt;String&gt;,\n        val work_places: String,\n        val places_of_living: String,\n        val general: String,\n        val default_picture: String\n)\n\nfun main(args: Array&lt;String&gt;) {\n     val person =Person(1, \"Nikolay\", 1, 10, 11, listOf(2), \"mi@ya.ru\", \n                        \"mishin.narod.ru\", \"07.02.1976\",\n                        \"\", true, \"Moscow\", \"\", \"\", listOf(\"780\", \"MIIT\"), \n                        listOf(\"luxoft\", \"lotus domino\"), \n                        \"Nagornaya\", \"Buninskaya Alleya\", \"perl and kotlin programmer\", \"\")\n    println(\"my name is ${person.name}\")\n}\n</code></pre>\n\n<p>but also question with Date time\nhow use it?\nis it support Kotlin?</p>\n"}, {"tags": ["reflection", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 1736, "user_id": 2825964, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/K8YjK.jpg?s=128&g=1", "display_name": "Markus Marvell", "link": "https://stackoverflow.com/users/2825964/markus-marvell"}, "edited": false, "score": 0, "creation_date": 1458368235, "post_id": 36095692, "comment_id": 59840764, "body": "Is nullability related to class comparison? As i understood classes can not be nullable. Expression types can. But we test equality of classes but not expressions."}, {"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "reply_to_user": {"reputation": 1736, "user_id": 2825964, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/K8YjK.jpg?s=128&g=1", "display_name": "Markus Marvell", "link": "https://stackoverflow.com/users/2825964/markus-marvell"}, "edited": false, "score": 0, "creation_date": 1458376724, "post_id": 36095692, "comment_id": 59842644, "body": "@MarkusMarvell, you are right, it is not. I stated that just as a hint to another thing that <code>KClass</code> doesn&#39;t have from declared Kotlin types. I&#39;ll reformulate the statement to make it more clear."}], "tags": [], "owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "is_accepted": true, "score": 6, "last_activity_date": 1462532707, "last_edit_date": 1462532707, "creation_date": 1458342264, "answer_id": 36095692, "question_id": 36095418, "link": "https://stackoverflow.com/questions/36095418/kotlin-class-equality-fails/36095692#36095692", "title": "Kotlin class equality fails", "body": "<p>In your case equality fails because <code>KClass</code>es are considered equal when they correspond to the same Java's type, not the same Kotlin type. This is false for <code>int</code> and <code>java.lang.Integer</code>.</p>\n\n<p>The workaround is to use <code>KClass</code>'s <code>javaObjectType</code> property, which will return Java class (not primitive type) even for Kotlin type compiled into Java's primitive:</p>\n\n<pre><code> fun sameClass(c1: KClass&lt;*&gt;, c2: KClass&lt;*&gt;) = c1.javaObjectType == c2.javaObjectType\n\n sameClass(Int::class, (1 as Any?)!!.javaClass.kotlin) //true\n</code></pre>\n\n<p>I agree that this semantics is rather confusing, I <a href=\"https://youtrack.jetbrains.com/issue/KT-11502\" rel=\"nofollow\">filed an issue</a> about it.</p>\n\n<p>Also, <code>KClass</code> doesn't reflect nullability of Kotlin types, and in case if you need to work with declared Kotlin types precisely, you will need to use <code>KType</code>, which does.</p>\n\n<hr>\n\n<p><strong>UPD:</strong> the issue has been marked as fixed, and the equality is explained in <code>KClass.equals</code> KDoc since 1.0.2.</p>\n"}], "owner": {"reputation": 1736, "user_id": 2825964, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/K8YjK.jpg?s=128&g=1", "display_name": "Markus Marvell", "link": "https://stackoverflow.com/users/2825964/markus-marvell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1048, "favorite_count": 3, "accepted_answer_id": 36095692, "answer_count": 1, "score": 6, "last_activity_date": 1462532707, "creation_date": 1458340817, "last_edit_date": 1458343787, "question_id": 36095418, "link": "https://stackoverflow.com/questions/36095418/kotlin-class-equality-fails", "title": "Kotlin class equality fails", "body": "<p>The following snippet shows the result of testing equality of Kotlin <code>KClass</code> references obtained from different sources. Their string representations are the same. But their java classes are different. Expected that <code>c</code>, <code>c0</code> and <code>c1</code> are equal. But for some reason they aren't. </p>\n\n<p>Is there some nuance or it's a bug? If it's not a bug what is the reliable way to test equality of <code>KClass</code>es?</p>\n\n<pre><code>fun main(args: Array&lt;String&gt;) {\n    val c = Int::class\n    fun test(v0: Any, v1: Any) {\n        val c0 = v0.javaClass.kotlin\n        val c1 = v1.javaClass.kotlin\n        println(\"c= $c;  c0= $c0;  c1= $c1\") // c= class kotlin.Int;  c0= class kotlin.Int;  c1= class kotlin.Int\n        println(\"c= ${c.java};  c0= ${c0.java};  c1= ${c1.java}\") // c= int;  c0= class java.lang.Integer;  c1= class java.lang.Integer\n        println(\"c = c0? ${c == c0};  c0 = c1? ${c1 == c0}\") // c = c0? false;  c0 = c1? true\n    }\n    test(11, 22)\n}\n</code></pre>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>The workaround is to use <code>KClass.javaObjectType</code> method. </p>\n\n<p>The docs says:</p>\n\n<blockquote>\n  <p>Returns a Java Class instance corresponding to the given KClass instance. In case of primitive types it returns corresponding wrapper classes.</p>\n</blockquote>\n\n<p>I.e. <code>c.javaObjectType == c1.javaObjectType</code> is true</p>\n\n<p>But it doesn't justifies why <code>KClass</code>es having same string representation are different. At least it's confusing. And it's good idea to note about that in docs.</p>\n"}, {"tags": ["reflection", "parameters", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 3121, "user_id": 3699808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f0af2052e664e9f832421cb56590b935?s=128&d=identicon&r=PG", "display_name": "mhlz", "link": "https://stackoverflow.com/users/3699808/mhlz"}, "edited": false, "score": 0, "creation_date": 1474972336, "post_id": 36093832, "comment_id": 66742096, "body": "Is this planned for the 1.1 release since it promises improvements in the Java 1.8 area?"}, {"owner": {"reputation": 25812, "user_id": 288456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf294ff6d86cc587dec43e2af34a9532?s=128&d=identicon&r=PG", "display_name": "Alexander Udalov", "link": "https://stackoverflow.com/users/288456/alexander-udalov"}, "reply_to_user": {"reputation": 3121, "user_id": 3699808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f0af2052e664e9f832421cb56590b935?s=128&d=identicon&r=PG", "display_name": "mhlz", "link": "https://stackoverflow.com/users/3699808/mhlz"}, "edited": false, "score": 0, "creation_date": 1475052323, "post_id": 36093832, "comment_id": 66781637, "body": "@mhlz What exactly do you mean? The question seems to be about retention of parameter names in Kotlin bytecode and this answer does not mention anything about Java."}, {"owner": {"reputation": 338, "user_id": 1453345, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/48cba601d02383b98c71c6c1e24e86a8?s=128&d=identicon&r=PG", "display_name": "user1453345", "link": "https://stackoverflow.com/users/1453345/user1453345"}, "edited": false, "score": 0, "creation_date": 1487225979, "post_id": 36093832, "comment_id": 71689282, "body": "I also encountered this issue. Since we usually combine java and kotlin, especially lots of tools are written in java. Calling from java is a common case. But I can&#39;t find any information about how to enable it event in 1.1, does 1.1 really support this feature?"}, {"owner": {"reputation": 25812, "user_id": 288456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf294ff6d86cc587dec43e2af34a9532?s=128&d=identicon&r=PG", "display_name": "Alexander Udalov", "link": "https://stackoverflow.com/users/288456/alexander-udalov"}, "reply_to_user": {"reputation": 338, "user_id": 1453345, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/48cba601d02383b98c71c6c1e24e86a8?s=128&d=identicon&r=PG", "display_name": "user1453345", "link": "https://stackoverflow.com/users/1453345/user1453345"}, "edited": false, "score": 0, "creation_date": 1487327491, "post_id": 36093832, "comment_id": 71746118, "body": "@user1453345 What <i>issue</i> exactly did you encounter? No issue is described neither in the question nor in the answer. What do you mean by &quot;it&quot; in &quot;how to enable it&quot;? If you do have an issue, please create one at <a href=\"http://kotl.in/issue\" rel=\"nofollow noreferrer\">kotl.in/issue</a>, or ask a new SO question."}, {"owner": {"reputation": 338, "user_id": 1453345, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/48cba601d02383b98c71c6c1e24e86a8?s=128&d=identicon&r=PG", "display_name": "user1453345", "link": "https://stackoverflow.com/users/1453345/user1453345"}, "edited": false, "score": 0, "creation_date": 1487553754, "post_id": 36093832, "comment_id": 71822597, "body": "@AlexanderUdalov, not a big issue. I think how to understand this question depends on the our positions. If you focus on the kotlin itself, your answer is good. For me, as a language user, usually combine the kotlin and java in real project, so the &quot;retain parameter name in bytecode&quot; also means the ops from java(not only kotlin call kotlin ,but also java call kotlin), so the &quot;retain parameter name in bytecode&quot; equals &quot;get kotlin method parameter name in java&quot;. So the &quot;it&quot; means &quot;get kotlin method parameter name in java&quot;, I think it is what mhlz asking."}, {"owner": {"reputation": 338, "user_id": 1453345, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/48cba601d02383b98c71c6c1e24e86a8?s=128&d=identicon&r=PG", "display_name": "user1453345", "link": "https://stackoverflow.com/users/1453345/user1453345"}, "edited": false, "score": 0, "creation_date": 1487553825, "post_id": 36093832, "comment_id": 71822614, "body": "I already know the answer, it is in somewhere of the kotlin doc 1.1 , not easy to find. thanks:)"}], "tags": [], "owner": {"reputation": 25812, "user_id": 288456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf294ff6d86cc587dec43e2af34a9532?s=128&d=identicon&r=PG", "display_name": "Alexander Udalov", "link": "https://stackoverflow.com/users/288456/alexander-udalov"}, "is_accepted": true, "score": 8, "last_activity_date": 1496669496, "last_edit_date": 1496669496, "creation_date": 1458333567, "answer_id": 36093832, "question_id": 36093019, "link": "https://stackoverflow.com/questions/36093019/does-kotlin-compiler-always-retain-parameter-names-in-bytecode/36093832#36093832", "title": "Does Kotlin compiler always retain parameter names in bytecode?", "body": "<p>Unless the bytecode was modified in some way, it's safe to assume that all parameters which are given names in the sources will have those names at runtime. This is true for Kotlin 1.0 and there's no plans to change this.</p>\n\n<p>If you're interested which unnamed parameters does <em>others</em> include, there's also the single parameter of a default property setter and the outer class parameter for an inner class constructor. Such parameters don't have names neither in the source code nor at runtime.</p>\n\n<p>UPD: since this may seem confusing to some, this question and the answer are only related to retaining parameter names <em>for Kotlin reflection</em> and specifically so that <code>KParameter.name</code> would work. This is not related to the parameter names that <em>Java reflection</em> would see for compiled Kotlin code. To retain parameter names for Java reflection, pass the <code>-java-parameters</code> option to the Kotlin compiler.</p>\n"}, {"tags": [], "owner": {"reputation": 343, "user_id": 247708, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/030c4e7b728827511717acb60b8800d3?s=128&d=identicon&r=PG", "display_name": "Bharat", "link": "https://stackoverflow.com/users/247708/bharat"}, "is_accepted": false, "score": 7, "last_activity_date": 1523816040, "last_edit_date": 1592644375, "creation_date": 1502223631, "answer_id": 45577384, "question_id": 36093019, "link": "https://stackoverflow.com/questions/36093019/does-kotlin-compiler-always-retain-parameter-names-in-bytecode/45577384#45577384", "title": "Does Kotlin compiler always retain parameter names in bytecode?", "body": "<p>Just to complete Alexander's answer above as it may not be immediately obvious, <strong>to provide parameter names for Java reflection of Kotlin classes</strong> (i.e. for Java code using reflection to view parameter names of Kotlin code), you must supply the <code>-java-parameters</code> argument (since Kotlin 1.1).</p>\n<h3>Gradle</h3>\n<p>In your <code>build.gradle</code> &gt; <code>compileKotlin</code> closure</p>\n<pre><code>compileKotlin {\n    kotlinOptions {\n        jvmTarget = '1.8' //Good to target Java 8 unless you need 7\n        javaParameters = true //Will retain parameter names for Java reflection\n    }\n}\n</code></pre>\n<h3>Maven</h3>\n<pre><code>&lt;plugin&gt;\n    &lt;artifactId&gt;kotlin-maven-plugin&lt;/artifactId&gt;\n    &lt;groupId&gt;org.jetbrains.kotlin&lt;/groupId&gt;\n    &lt;version&gt;${kotlin.version}&lt;/version&gt;\n\n    &lt;configuration&gt;\n        &lt;args&gt;\n            &lt;arg&gt;-java-parameters&lt;/arg&gt;\n        &lt;/args&gt;\n\n    ...\n</code></pre>\n<h3>IntelliJ</h3>\n<ol>\n<li><p>In <em>Preferences</em> &gt; <em>Kotlin Compiler</em> &gt; <em>Additional command line parameters</em></p>\n</li>\n<li><p>Append <code>-java-parameters</code> to the list</p>\n</li>\n</ol>\n<p>Ensure you run a clean before running any reflection based code.</p>\n"}], "owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1548, "favorite_count": 0, "accepted_answer_id": 36093832, "answer_count": 2, "score": 5, "last_activity_date": 1523816040, "creation_date": 1458330278, "last_edit_date": 1458337598, "question_id": 36093019, "link": "https://stackoverflow.com/questions/36093019/does-kotlin-compiler-always-retain-parameter-names-in-bytecode", "title": "Does Kotlin compiler always retain parameter names in bytecode?", "body": "<p>In <code>kotlin-reflect</code>, class <code>KParameter</code> has nullable <code>name</code>, and its KDoc says:</p>\n\n<blockquote>\n  <p>Name of this parameter as it was declared in the source code, or <code>null</code> if the parameter has no name or its name is not available at runtime. Examples of nameless parameters include this instance for member functions, extension receiver for extension functions or properties, <strong>parameters of Java methods</strong> compiled without the debug information, and <strong>others</strong>.</p>\n</blockquote>\n\n<p>It says about well-known fact that Java doesn't always include parameter names in bytecode, but it says nothing about Kotlin classes, though there are some <em>others</em>.</p>\n\n<p>Can I assume that Kotlin compiler retains parameter names declared for functions in Kotlin sources? (In particular, I need constructor parameter names).</p>\n"}, {"tags": ["scala", "class", "require", "kotlin"], "answers": [{"tags": [], "owner": {"reputation": 1646, "user_id": 657723, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/SAt1h.jpg?s=128&g=1", "display_name": "Ivan Balashov", "link": "https://stackoverflow.com/users/657723/ivan-balashov"}, "is_accepted": false, "score": 2, "last_activity_date": 1458325631, "creation_date": 1458325631, "answer_id": 36091752, "question_id": 36091662, "link": "https://stackoverflow.com/questions/36091662/scala-require-equivalent-in-kotlin/36091752#36091752", "title": "Scala require() equivalent in Kotlin", "body": "<p>How about <a href=\"https://github.com/JetBrains/kotlin/blob/master/libraries/stdlib/src/kotlin/util/Preconditions.kt\" rel=\"nofollow\">Preconditions.kt</a> or <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/assert.html\" rel=\"nofollow\">Assert</a> ?</p>\n"}, {"tags": [], "owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "is_accepted": true, "score": 11, "last_activity_date": 1458327527, "creation_date": 1458327527, "answer_id": 36092345, "question_id": 36091662, "link": "https://stackoverflow.com/questions/36091662/scala-require-equivalent-in-kotlin/36092345#36092345", "title": "Scala require() equivalent in Kotlin", "body": "<p>Kotlin stdlib also has a <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/require.html\"><code>require</code></a> method:</p>\n\n<pre><code>class Rational(x: Int, y: Int) {\n    init {\n        require(y != 0) { \"denominator must be different than zero \" }\n    }\n}\n</code></pre>\n\n<p>It also has a <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/require-not-null.html\"><code>requireNotNull</code></a>, <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/check.html\"><code>check</code></a>, <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/check-not-null.html\"><code>checkNotNull</code></a>, <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/assert.html\"><code>assert</code></a>.</p>\n\n<p>There are also various other assert methods in <a href=\"https://github.com/JetBrains/kotlin/tree/f91c01919b7ce1a4a69cedcbc757eb31e4c5c413/libraries/kotlin.test/shared/src/main/kotlin/kotlin/test\">kotlin-test</a>.</p>\n"}], "owner": {"reputation": 903, "user_id": 4759312, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-a5WVXQSOHCA/AAAAAAAAAAI/AAAAAAAAABM/ZQN9cG0YL1c/photo.jpg?sz=128", "display_name": "Abdelrhman Talat", "link": "https://stackoverflow.com/users/4759312/abdelrhman-talat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 1, "accepted_answer_id": 36092345, "answer_count": 2, "score": 5, "last_activity_date": 1458327527, "creation_date": 1458325298, "question_id": 36091662, "link": "https://stackoverflow.com/questions/36091662/scala-require-equivalent-in-kotlin", "title": "Scala require() equivalent in Kotlin", "body": "<p>In Scala we have a require method that is used to set preconditions to classes like this </p>\n\n<pre><code>class Rational(x: Int, y: Int) {\n   require(y != 0, \"denominator must be different than zero \")\n</code></pre>\n\n<p>My question is: Do we have something like that in Kotlin? </p>\n"}, {"tags": ["inheritance", "setter", "kotlin", "overwrite"], "answers": [{"comments": [{"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "reply_to_user": {"reputation": 708, "user_id": 1315268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mlzCH.jpg?s=128&g=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/1315268/mario"}, "edited": false, "score": 0, "creation_date": 1458303791, "post_id": 36069324, "comment_id": 59812734, "body": "@Mario I thought you were trying to avoid needing to override <code>t</code>. &quot;Why should i overwrite a member?&quot; Here you don&#39;t (unless you&#39;re trying to avoid overriding a member method as well). &quot;Why do i have to define set and get when i just need set?&quot; Here you don&#39;t, just define set."}, {"owner": {"reputation": 708, "user_id": 1315268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mlzCH.jpg?s=128&g=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/1315268/mario"}, "edited": false, "score": 0, "creation_date": 1458349510, "post_id": 36069324, "comment_id": 59837475, "body": "That seems odd enough to give it a try. I rewrite my classes like this and have a look on the visibility scope of the class objects."}, {"owner": {"reputation": 5069, "user_id": 1510222, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8148c5fe86305366fef9466c2cf2143b?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz Cie\u015bli\u0144ski", "link": "https://stackoverflow.com/users/1510222/arkadiusz-cie%c5%9bli%c5%84ski"}, "edited": false, "score": 0, "creation_date": 1486893177, "post_id": 36069324, "comment_id": 71534548, "body": "Why Unit = FOO.defaultOnChange? - I know the result but I don&#39;t know how it works"}, {"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "edited": false, "score": 0, "creation_date": 1486903796, "post_id": 36069324, "comment_id": 71537508, "body": "Correct although it isn&#39;t <code>Unit = ...</code> but <code>(t: String) -&gt; Unit = FOO.defaultOnChange</code>."}], "tags": [], "owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "is_accepted": true, "score": 4, "last_activity_date": 1458304382, "last_edit_date": 1458304382, "creation_date": 1458240838, "answer_id": 36069324, "question_id": 36068033, "link": "https://stackoverflow.com/questions/36068033/kotlin-override-member-set-and-get/36069324#36069324", "title": "Kotlin override member set and get", "body": "<pre><code>open class FOO {\n    var t: String = \"origin\"\n        set(value) {\n            field = value\n            x(t)\n        }\n\n    open fun x(t: String) {\n        println(\"FOO: t=$t\")\n    }\n}\n\nopen class BOO : FOO() {\n    override fun x(t: String) {\n        super.x(t)\n        println(\"BOO: t=$t\")\n    }\n}\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I personally think it looks a bit odd but if what you're after is not needing to override any members (field or methods) then you can make your <code>onChange</code> method a property:</p>\n\n<pre><code>open class FOO(val onChange: (t: String) -&gt; Unit = FOO.defaultOnChange) {\n    companion object {\n        val defaultOnChange: (t: String) -&gt; Unit = { println(\"FOO: t=$it\") }\n    }\n\n    var t: String = \"origin\"\n        set(value) {\n            field = value\n            onChange(t)\n        }\n}\n\nopen class BOO : FOO({ defaultOnChange(it); println(\"BOO: t=$it\") })\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 708, "user_id": 1315268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mlzCH.jpg?s=128&g=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/1315268/mario"}, "edited": false, "score": 0, "creation_date": 1458287595, "post_id": 36072355, "comment_id": 59802601, "body": "hi, thanks for your answer. Yes this is the straight forward way and I thought about this as well. But this will increase method count in the api  so 3 members will have 3 onChange listener"}], "tags": [], "owner": {"reputation": 838, "user_id": 1128600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57e379c176b460cf48ff3eb61a408da?s=128&d=identicon&r=PG", "display_name": "Steffen Funke", "link": "https://stackoverflow.com/users/1128600/steffen-funke"}, "is_accepted": false, "score": 2, "last_activity_date": 1458251552, "creation_date": 1458251552, "answer_id": 36072355, "question_id": 36068033, "link": "https://stackoverflow.com/questions/36068033/kotlin-override-member-set-and-get/36072355#36072355", "title": "Kotlin override member set and get", "body": "<p>Similar approach, but with <code>Delegates.observable()</code>, \nsee in <a href=\"https://kotlinlang.org/docs/reference/delegated-properties.html\" rel=\"nofollow\">Language reference</a>:</p>\n\n<pre><code>import kotlin.properties.Delegates\n\nopen class UserBase {\n    var name: String by Delegates.observable(\"&lt;no name&gt;\") { prop, old, new -&gt;\n        println(\"$old -&gt; $new\")\n        onChange(new)\n    }\n\n    // could be abstract, if class is abstract\n    open fun onChange(v: String?) {}\n}\n\nclass User : UserBase() {\n    override fun onChange(v: String?) {\n        println(\"I was changed in my base class: ${v}\")\n    }\n}\n\nfun main(args: Array&lt;String&gt;) {\n    val user = User()\n    user.name = \"first\"\n    user.name = \"second\"\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 708, "user_id": 1315268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mlzCH.jpg?s=128&g=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/1315268/mario"}, "edited": false, "score": 0, "creation_date": 1458597844, "post_id": 36128646, "comment_id": 59923022, "body": "Yes... i just added the comments and overwritten getter setter for learning.  Anyway what i do not understand why kotlin is forceing me to overwrite the getter... if i do not do so, kotlin will handle the BOO.t in a whole other way then i expect"}], "tags": [], "owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "is_accepted": false, "score": 0, "last_activity_date": 1458556369, "creation_date": 1458556369, "answer_id": 36128646, "question_id": 36068033, "link": "https://stackoverflow.com/questions/36068033/kotlin-override-member-set-and-get/36128646#36128646", "title": "Kotlin override member set and get", "body": "<p>Why not just plain overriding? Like here:</p>\n\n<pre><code>open class FOO () {\n    open var t: String = \"origin\"\n\n    fun printT() = println(t)\n}\n\nclass BOO (): FOO () {\n    override var t: String\n    get() = super.t\n    set(value) {\n        // thats all you need\n        println(\"\\t overwritten setter is called\")\n        super.t = value \n    }\n}\n</code></pre>\n\n<p>The only disadvantage I see here is a need for explicitly overriding the getter, but that is just one extra line.</p>\n"}], "owner": {"reputation": 708, "user_id": 1315268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mlzCH.jpg?s=128&g=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/1315268/mario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5101, "favorite_count": 1, "accepted_answer_id": 36069324, "answer_count": 3, "score": 4, "last_activity_date": 1458556369, "creation_date": 1458236751, "question_id": 36068033, "link": "https://stackoverflow.com/questions/36068033/kotlin-override-member-set-and-get", "title": "Kotlin override member set and get", "body": "<p>Does anybody know a better way to listen for member change within own base class?</p>\n\n<pre><code>class FOO {\n    val t: String\n}\n\nclass BOO: FOO {\n    fun x(val t: String) {\n        // notify when t was changed \n    }\n}\n</code></pre>\n\n<p>In my opinion JavaRx with Observer would be to much. Kotlin Delegate does not work with inheritance (or i could not find a way yet). The best i came up with is to override setter and getter of \"t\" in \"BOO\". But this is a little bit awkward because of this \"Why should i overwrite a member?\" or \"Why do i have to define set and get when i just need set?\"</p>\n\n<p>So my solution so far:</p>\n\n<pre><code>import kotlin.properties.Delegates\n\nfun main(args: Array&lt;String&gt;) {\n    var foo = FOO()\n    foo.t = \"foo\"\n    foo.printT()\n\n    var boo = BOO()\n    boo.t = \"boo\"\n    boo.printT()\n}\n\nopen class FOO () {\n    open var t: String? = \"origin\"\n    set(value) {\n        println(\"\\t origin setter is called\")\n        field = String() + value // create a copy (original it is not a String :D)\n    }\n    get() {\n        println(\"\\t origin getter is called\")\n        return field\n    }\n\n    fun printT() = println(t)\n}\n\n\nclass BOO (): FOO () {\n    override var t: String?\n    set(value) {\n        // thats all what i need\n        println(\"\\t overwritten setter is called\")\n        super.t = value // execute origin setter\n    }\n    get() {\n        println(\"\\t overwritten getter is called\")\n        return super.t\n    }\n}\n</code></pre>\n"}, {"tags": ["android", "onclicklistener", "ontouchlistener", "kotlin"], "comments": [{"owner": {"reputation": 77347, "user_id": 1631193, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c713494416ceac454d71c524e15f1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Gabe Sechan", "link": "https://stackoverflow.com/users/1631193/gabe-sechan"}, "edited": false, "score": 0, "creation_date": 1458229655, "post_id": 36065388, "comment_id": 59777238, "body": "Unless whatever language you&#39;re doing does something weird in its framework, the opposite should be true-  a touch handler not properly written and calling performClick won&#39;t call a click handler.  By the way, you may want to tag this question with whatever language/framework you&#39;re using, since this isn&#39;t java and the Android SDK."}, {"owner": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "reply_to_user": {"reputation": 77347, "user_id": 1631193, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c713494416ceac454d71c524e15f1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Gabe Sechan", "link": "https://stackoverflow.com/users/1631193/gabe-sechan"}, "edited": false, "score": 0, "creation_date": 1458230242, "post_id": 36065388, "comment_id": 59777722, "body": "can you elaborate a bit about &quot;the opposite should be true&quot;"}, {"owner": {"reputation": 77347, "user_id": 1631193, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c713494416ceac454d71c524e15f1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Gabe Sechan", "link": "https://stackoverflow.com/users/1631193/gabe-sechan"}, "edited": false, "score": 0, "creation_date": 1458230351, "post_id": 36065388, "comment_id": 59777831, "body": "A touch handler needs to call performClick in order for a click listener to be triggered.  Yours doesn&#39;t, so it actually wouldn&#39;t ever call the click listener.  The default touch listener does it correctly, but if you override it you need to do it yourself.  Its actually important-  accessibility features depend on the click occurring, so if you don&#39;t do it right you&#39;ll break screen readers and similar accessibility apps."}, {"owner": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "reply_to_user": {"reputation": 77347, "user_id": 1631193, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c713494416ceac454d71c524e15f1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Gabe Sechan", "link": "https://stackoverflow.com/users/1631193/gabe-sechan"}, "edited": false, "score": 0, "creation_date": 1458230510, "post_id": 36065388, "comment_id": 59777957, "body": "much better, thank you. But the problem isn&#39;t that one. The touch listener is defined for the parent and it works fine. The touch listener stops working when i set a click listener to the child."}], "answers": [{"comments": [{"owner": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "edited": false, "score": 0, "creation_date": 1458231014, "post_id": 36065836, "comment_id": 59778283, "body": "still doesn&#39;t work. For some reason, if i set the click listener, parent ACTION_DOWN is called but parent ACTION_UP is not. Basically, i want to  detect a swipeUp in the same region the click listeners are called. Can&#39;t have both working, and i&#39;m looking for a workaround. Tried returning false in the children OnInterceptTouchEvent. same result"}], "tags": [], "owner": {"reputation": 4324, "user_id": 1259923, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/eSrTO.png?s=128&g=1", "display_name": "Eefret", "link": "https://stackoverflow.com/users/1259923/eefret"}, "is_accepted": false, "score": 0, "last_activity_date": 1458231053, "last_edit_date": 1458231053, "creation_date": 1458230606, "answer_id": 36065836, "question_id": 36065388, "link": "https://stackoverflow.com/questions/36065388/android-kotlin-child-onclick-blocks-parent-ontouch/36065836#36065836", "title": "Android Kotlin child onClick blocks parent OnTouch", "body": "<p>You have to override both onTouchListeners on your children views and return false, that will make them not override their parent ontouch.</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>widget1.onTouch { view, motionEvent -&gt; return@onTouch false }\nwidget2.onTouch { view, motionEvent -&gt; return@onTouch false }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "is_accepted": true, "score": 1, "last_activity_date": 1458297036, "last_edit_date": 1458297036, "creation_date": 1458295981, "answer_id": 36081643, "question_id": 36065388, "link": "https://stackoverflow.com/questions/36065388/android-kotlin-child-onclick-blocks-parent-ontouch/36081643#36081643", "title": "Android Kotlin child onClick blocks parent OnTouch", "body": "<p>The only thing that worked for me: In the parent LinearLayout, intercept the touch, call onTouchEvent and return false:</p>\n\n<pre><code>override fun onInterceptTouchEvent(ev: MotionEvent): Boolean {\n        onTouchEvent(ev)\n        return false\n    }\n</code></pre>\n\n<p>Move the TouchInterceptor with the Gesture Detector class to the parent onTouchEvent:</p>\n\n<pre><code>override fun onTouchEvent(e: MotionEvent): Boolean {\n            myGestureDetected.onTouchEvent(e)\n\n            when(e.action){\n                MotionEvent.ACTION_UP -&gt; {\n                    if (isScrollingDown) {\n                        onRecyclerViewMovingDown?.invoke()\n                    }\n                }\n\n                MotionEvent.ACTION_DOWN -&gt; {\n                    isScrollingDown = false\n                    isScrollingUp = false\n\n                }\n            }\n            return super.onTouchEvent(e)\n        }\n</code></pre>\n\n<p>I don't know if there is a better solution, but this one let me handle touch event on the parent first, then it passed the touch to the childs. There you can set your click listeners.</p>\n\n<p>Also, if you don't set click listeners, the area of touch that contains the clickable item won't trigger touch. so, better set</p>\n\n<pre><code>clickable=true\n</code></pre>\n\n<p>in all the items, and then only set listeners when you need.</p>\n"}], "owner": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6747, "favorite_count": 0, "accepted_answer_id": 36081643, "answer_count": 2, "score": 3, "last_activity_date": 1458297036, "creation_date": 1458229476, "last_edit_date": 1458230153, "question_id": 36065388, "link": "https://stackoverflow.com/questions/36065388/android-kotlin-child-onclick-blocks-parent-ontouch", "title": "Android Kotlin child onClick blocks parent OnTouch", "body": "<p>I have this layout hierarchy:</p>\n\n<pre><code>&lt;LinearLayout\n    xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\n    android:id=\"@+id/parent\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"&gt;\n\n    &lt;com.xxxxxx.Widget\n        android:id=\"@+id/widget1\"\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"wrap_content\"/&gt;\n\n    &lt;com.xxxxxx.Widget\n        android:id=\"@+id/widget2\"\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"wrap_content\"/&gt;\n    &lt;/LinearLayout&gt;\n&lt;/LinearLayout&gt;\n</code></pre>\n\n<p>I have touch Events for the Parent LinearLayout like this:</p>\n\n<pre><code>parent.setOnTouchListener(myCustomTouchParent)\n\n    class MyCustomTouchParent(ctx: Context): View.OnTouchListener {\n\n        private var isScrollingDown = false\n        private var isScrollingUp = false\n        private val myGestureDetected = GestureDetector(ctx, MyGestureListener())\n\n        var onRecyclerViewMovingDown: (() -&gt; Unit)? = null\n\n        override fun onTouch(p0: View?, e: MotionEvent): Boolean {\n            myGestureDetected.onTouchEvent(e)\n\n            when(e.action){\n                MotionEvent.ACTION_UP -&gt; {\n                    if (isScrollingDown) {\n                        onRecyclerViewMovingDown?.invoke()\n                    }\n                }\n\n                MotionEvent.ACTION_DOWN -&gt; {\n                    Log.i(\"TAg\", \"Action Down\")\n                    isScrollingDown = false\n                    isScrollingUp = false\n\n                }\n            }\n            return true\n        }\n\n        inner class MyGestureListener: GestureDetector.SimpleOnGestureListener() {\n            override fun onScroll(e1: MotionEvent, e2: MotionEvent, distanceX: Float, distanceY: Float): Boolean {\n                if(e2.y - e1.y &gt; 0){\n                    isScrollingUp = true\n                } else if(e2.y - e1.y &lt; 0){\n                    isScrollingDown = true\n                }\n                return super.onScroll(e1, e2, distanceX, distanceY)\n            }\n\n\n        }\n    }\n</code></pre>\n\n<p>Basically, this will detect a 'Scroll Up' event on the parent, and will perform some animations. The problem is, as soon as I set a click listener for widget1 and widget2, the touch event of the parent is no longer working. Is there any workaround for this?</p>\n"}, {"tags": ["java", "gradle", "android-gradle-plugin", "kotlin", "jasmin"], "answers": [{"comments": [{"owner": {"reputation": 25134, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1458219380, "post_id": 36061037, "comment_id": 59768959, "body": "Sounds promising, but then I get <code>Only Jar-type local dependencies are supported. Cannot handle: build&#47;intermediates&#47;classes&#47;debug</code> from <code>:prepareDebugDependencies</code>"}, {"owner": {"reputation": 25134, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1458219564, "post_id": 36061037, "comment_id": 59769084, "body": "Moreover, if I put my <code>SomeJVMClass.class</code> file in a <code>.jar</code> and use     <code>compile files(&quot;build&#47;intermediates&#47;classes&#47;debug&#47;asm.jar&quot;)</code>, it fails later in <code>:transformClassesWithDexForDebug</code> with <code>Uncaught translation error: java.lang.IllegalArgumentException: already added: Lcom&#47;example&#47;JVMServer&#47;SomeJVMClass</code>"}, {"owner": {"reputation": 20461, "user_id": 1452094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a12b28824b215e4886da2e9f376369f?s=128&d=identicon&r=PG", "display_name": "Kiskae", "link": "https://stackoverflow.com/users/1452094/kiskae"}, "reply_to_user": {"reputation": 25134, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1458219789, "post_id": 36061037, "comment_id": 59769276, "body": "@Cactus Putting it as a .jar file in the build directory might trigger an automatic include, try removing the compile line but leaving the .jar"}, {"owner": {"reputation": 25134, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1458219902, "post_id": 36061037, "comment_id": 59769373, "body": "Nope, then it&#39;s back to <code>:compileDebugKotlin</code> not finding `JVMServer&#39;"}, {"owner": {"reputation": 20461, "user_id": 1452094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a12b28824b215e4886da2e9f376369f?s=128&d=identicon&r=PG", "display_name": "Kiskae", "link": "https://stackoverflow.com/users/1452094/kiskae"}, "reply_to_user": {"reputation": 25134, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1458220738, "post_id": 36061037, "comment_id": 59769995, "body": "@Cactus One solution I can think of is to create a gradle subproject as a normal java library project, including the .class files in the output of that project and the adding a dependency to that subproject. Because it seems android has removed some of the capabilities of gradle&#39;s dependency system."}, {"owner": {"reputation": 25134, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1458221577, "post_id": 36061037, "comment_id": 59770687, "body": "I don&#39;t know the first thing about Gradle... do you have an example of such a subproject setup? Ideally including the actual assembly step as part of the build process as well."}, {"owner": {"reputation": 20461, "user_id": 1452094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a12b28824b215e4886da2e9f376369f?s=128&d=identicon&r=PG", "display_name": "Kiskae", "link": "https://stackoverflow.com/users/1452094/kiskae"}, "reply_to_user": {"reputation": 25134, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 1, "creation_date": 1458222550, "post_id": 36061037, "comment_id": 59771507, "body": "@Cactus refer to <a href=\"https://docs.gradle.org/current/userguide/multi_project_builds.html\" rel=\"nofollow noreferrer\">docs.gradle.org/current/userguide/multi_project_builds.html</a> for subprojects and <a href=\"https://docs.gradle.org/current/dsl/org.gradle.api.tasks.Exec.html\" rel=\"nofollow noreferrer\">docs.gradle.org/current/dsl/org.gradle.api.tasks.Exec.html</a> for custom tasks."}, {"owner": {"reputation": 20461, "user_id": 1452094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a12b28824b215e4886da2e9f376369f?s=128&d=identicon&r=PG", "display_name": "Kiskae", "link": "https://stackoverflow.com/users/1452094/kiskae"}, "reply_to_user": {"reputation": 25134, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 1, "creation_date": 1458223398, "post_id": 36061037, "comment_id": 59772166, "body": "@Cactus This documentation might actually solve your problem: <a href=\"https://docs.gradle.org/current/javadoc/org/gradle/api/tasks/SourceSetOutput.html\" rel=\"nofollow noreferrer\">docs.gradle.org/current/javadoc/org/gradle/api/tasks/&hellip;</a>"}], "tags": [], "owner": {"reputation": 20461, "user_id": 1452094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a12b28824b215e4886da2e9f376369f?s=128&d=identicon&r=PG", "display_name": "Kiskae", "link": "https://stackoverflow.com/users/1452094/kiskae"}, "is_accepted": false, "score": 0, "last_activity_date": 1458219880, "last_edit_date": 1458219880, "creation_date": 1458218951, "answer_id": 36061037, "question_id": 36060887, "link": "https://stackoverflow.com/questions/36060887/linking-to-jvm-asm-defined-classes-from-kotlin-using-gradle/36061037#36061037", "title": "Linking to JVM asm-defined classes from Kotlin using Gradle", "body": "<p><strong>Edit: turns out this approach does not work for android-gradle</strong></p>\n\n<p>This is more related to gradle than Kotlin, you can tell gradle to include <code>.class</code> files during compilation by adding the statement <code>compile files(\"build/intermediates/classes/debug\")</code> to your dependencies.</p>\n\n<p>This will place the .class files on the classpath where Kotlin should be able to find them.</p>\n"}], "owner": {"reputation": 25134, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 438, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1458219880, "creation_date": 1458218579, "question_id": 36060887, "link": "https://stackoverflow.com/questions/36060887/linking-to-jvm-asm-defined-classes-from-kotlin-using-gradle", "title": "Linking to JVM asm-defined classes from Kotlin using Gradle", "body": "<p>I have the following setup for an Android app:</p>\n\n<pre><code>\u251c\u2500\u2500 build.gradle\n\u2514\u2500\u2500 src\n    \u2514\u2500\u2500 main\n        \u251c\u2500\u2500 AndroidManifest.xml\n        \u251c\u2500\u2500 asm\n        \u2502\u00a0\u00a0 \u2514\u2500\u2500 SomeJVMClass.j\n        \u251c\u2500\u2500 kotlin\n        \u2502\u00a0\u00a0 \u2514\u2500\u2500 activity.kt\n        \u2514\u2500\u2500 res\n            \u2514\u2500\u2500 values\n                \u2514\u2500\u2500 strings.xml\n</code></pre>\n\n<p>The source file in <code>src/main/asm/SomeJVMClass.j</code> is <a href=\"https://github.com/Storyyeller/Krakatau\" rel=\"nofollow\">Krakatau</a> format JVM assembly (it's almost the same as Jasmin). I would like to use the class it defines from my main Kotlin source <code>activity.kt</code>.</p>\n\n<p>Before I even get to trying to automate this with Gradle, just assembling the file manually into <code>build</code> doesn't help. Here's what I tried:</p>\n\n<ol>\n<li>Do a <code>gradle build</code> to get the skeleton <code>build</code> directory (this of course fails with the Kotlin compiler not finding <code>SomeJVMClass</code>)</li>\n<li><p>I run Krakatau manually to put its class files in  <code>build/intermediates/classes/{debug,release}</code>:</p>\n\n<pre><code>$ for flavor in debug release; do ~/prog/jvm/krakatau/assemble.py -out build/intermediates/classes/$flavor -r src/main/asm ;done\n\nProcessing file src/main/asm/SomeJVMClass.j, 1/1 remaining\nClass written to build/intermediates/classes/debug/com/example/JVMServer/SomeJVMClass.class\n\nProcessing file src/main/asm/SomeJVMClass.j, 1/1 remaining\nClass written to build/intermediates/classes/release/com/example/JVMServer/SomeJVMClass.class\n</code></pre></li>\n<li><p>Re-run <code>grade build</code> with the hope that Kotlin will now find the <code>.class</code>files; but no improvement whatsoever:</p></li>\n</ol>\n\n<blockquote>\n<pre><code>:compileDebugKotlin\ne: /home/cactus/prog/android/kotlin-asm/src/main/kotlin/activity.kt (3,20): \n   Unresolved reference: JVMServer\ne: /home/cactus/prog/android/kotlin-asm/src/main/kotlin/activity.kt: (12,14): \n   Unresolved reference: SomeJVMClass\n</code></pre>\n</blockquote>\n\n<p>So the first question is, obviously, where do I put the resulting <code>.class</code> files so that the Kotlin compiler can find them. And the second, follow-up question, is how do I automate that so that a single <code>gradle build</code> command will run the Krakatau assembler first, before running the Kotlin compiler.</p>\n\n<p>For reference, here are my source files:</p>\n\n<p><code>src/main/asm/SomeJVMClass.j</code>:</p>\n\n<pre><code>.class public com/example/JVMServer/SomeJVMClass\n.super java/lang/Object\n\n.method public static foo: ()Ljava/lang/String;\n  .code stack 2 locals 0\n    ldc \"JVM bytecode works\"\n    areturn\n  .end code\n.end method\n\n.end class  \n</code></pre>\n\n<p><code>src/main/kotlin/activity.kt</code>:</p>\n\n<pre><code>package com.example.JVMClient\n\nimport com.example.JVMServer.SomeJVMClass    \nimport android.app.Activity\nimport android.os.Bundle\n\nclass MainActivity: Activity() {\n  protected override fun onCreate(savedInstanceState: Bundle?) {\n    super.onCreate(savedInstanceState)\n\n    setTitle(SomeJVMClass.foo())\n  }\n}\n</code></pre>\n"}, {"tags": ["java", "kotlin", "accessor"], "answers": [{"comments": [{"owner": {"reputation": 64215, "user_id": 11238, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/BGDex.png?s=128&g=1", "display_name": "Randy Sugianto &#39;Yuku&#39;", "link": "https://stackoverflow.com/users/11238/randy-sugianto-yuku"}, "edited": false, "score": 2, "creation_date": 1458204498, "post_id": 36054609, "comment_id": 59758184, "body": "Exactly what I needed. Thanks!"}], "tags": [], "owner": {"reputation": 3446, "user_id": 3432081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc197f6b517a678ecf798c94303b166c?s=128&d=identicon&r=PG&f=1", "display_name": "Cootri", "link": "https://stackoverflow.com/users/3432081/cootri"}, "is_accepted": true, "score": 10, "last_activity_date": 1458219322, "last_edit_date": 1458219322, "creation_date": 1458201550, "answer_id": 36054609, "question_id": 36054501, "link": "https://stackoverflow.com/questions/36054501/how-to-create-a-property-without-accessors-in-kotlin/36054609#36054609", "title": "How to create a property without accessors in Kotlin?", "body": "<p>You can annotate a property with the <a href=\"https://kotlinlang.org/docs/reference/java-to-kotlin-interop.html#instance-fields\" rel=\"noreferrer\"><code>@JvmField</code> annotation</a> to expose it as a Java field.</p>\n\n<blockquote>\n  <p>If you need to expose a Kotlin property as a field in Java, you need to annotate it with the @JvmField annotation. The field will have the same visibility as the underlying property. You can annotate a property with @JvmField if it has a backing field, is not private, does not have open, override or const modifiers, and is not a delegated property.</p>\n</blockquote>\n"}], "owner": {"reputation": 64215, "user_id": 11238, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/BGDex.png?s=128&g=1", "display_name": "Randy Sugianto &#39;Yuku&#39;", "link": "https://stackoverflow.com/users/11238/randy-sugianto-yuku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 733, "favorite_count": 2, "accepted_answer_id": 36054609, "answer_count": 1, "score": 5, "last_activity_date": 1458219322, "creation_date": 1458201185, "question_id": 36054501, "link": "https://stackoverflow.com/questions/36054501/how-to-create-a-property-without-accessors-in-kotlin", "title": "How to create a property without accessors in Kotlin?", "body": "<p>I am using a Kotlin class from Java code. My Kotlin class looks like:</p>\n\n<pre><code>class Something {\n    var a = 0\n}\n</code></pre>\n\n<p>I want to be able to access <code>a</code> from Java code like </p>\n\n<pre><code>s = new Something();\ns.a = 5;\n</code></pre>\n\n<p>however, I only have <code>s.getA()</code> and <code>s.setA(5)</code>. Is there any way to make this property directly settable and gettable from Java? Obviously we can't have custom getter and setter in this case.</p>\n"}, {"tags": ["exception", "intellij-idea", "exception-handling", "kotlin", "unchecked-exception"], "comments": [{"owner": {"reputation": 2015, "user_id": 1109309, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f8a2b866ae0dc92a9e774d0094da8f4d?s=128&d=identicon&r=PG", "display_name": "Alexey Andreev", "link": "https://stackoverflow.com/users/1109309/alexey-andreev"}, "edited": false, "score": 0, "creation_date": 1458192582, "post_id": 36051508, "comment_id": 59752568, "body": "I suppose it&#39;s impossible. Consider the following: <code>val cls = Class.forName(a); val method = cls.getMethod(b); method.invoke()</code>, where <code>a</code> and <code>b</code> are read from file or provided by user input. How can you know what exceptions this code throws before you execute the code?"}, {"owner": {"reputation": 1339, "user_id": 1359988, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/00c331889adb81f68b66cd75734459a6?s=128&d=identicon&r=PG", "display_name": "zjuhasz", "link": "https://stackoverflow.com/users/1359988/zjuhasz"}, "reply_to_user": {"reputation": 2015, "user_id": 1109309, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f8a2b866ae0dc92a9e774d0094da8f4d?s=128&d=identicon&r=PG", "display_name": "Alexey Andreev", "link": "https://stackoverflow.com/users/1109309/alexey-andreev"}, "edited": false, "score": 2, "creation_date": 1458193518, "post_id": 36051508, "comment_id": 59752885, "body": "I mean you&#39;re going to be missing all sorts of type information when you use reflection. Wouldn&#39;t the same issues apply if you were using  reflection in Java? I think it would still be useful to know what exceptions can be thrown in the cases where the type is known at compile time."}], "answers": [{"comments": [{"owner": {"reputation": 1339, "user_id": 1359988, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/00c331889adb81f68b66cd75734459a6?s=128&d=identicon&r=PG", "display_name": "zjuhasz", "link": "https://stackoverflow.com/users/1359988/zjuhasz"}, "edited": false, "score": 1, "creation_date": 1458194227, "post_id": 36052568, "comment_id": 59753135, "body": "Javadoc is a fine solution for my own code but the issue is the javadoc in many libraries leaves a lot to be desired and you&#39;re really counting on the developer to have thorough documentation on everything. I guess I was more looking for something like a warning in intelliJ or another tool where I wouldn&#39;t have to manually check anything so I don&#39;t accidentally miss an exception from a library function that isn&#39;t obvious. It seems like such a thing does not exist so far :/"}, {"owner": {"reputation": 233128, "user_id": 807126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpNqK.jpg?s=128&g=1", "display_name": "Doug Stevenson", "link": "https://stackoverflow.com/users/807126/doug-stevenson"}, "reply_to_user": {"reputation": 1339, "user_id": 1359988, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/00c331889adb81f68b66cd75734459a6?s=128&d=identicon&r=PG", "display_name": "zjuhasz", "link": "https://stackoverflow.com/users/1359988/zjuhasz"}, "edited": false, "score": 1, "creation_date": 1458194735, "post_id": 36052568, "comment_id": 59753292, "body": "Yeah, that&#39;s kind of the way unchecked exceptions work.  I know your pain."}, {"owner": {"reputation": 36733, "user_id": 907695, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/daac9f1ef1a91604000a38376cace034?s=128&d=identicon&r=PG", "display_name": "Pointer Null", "link": "https://stackoverflow.com/users/907695/pointer-null"}, "edited": false, "score": 2, "creation_date": 1506500008, "post_id": 36052568, "comment_id": 79841377, "body": "F1 key? Better write about IntelliJ action name, not shortcut which may be remapped. Doesn&#39;t work for me."}, {"owner": {"reputation": 2153, "user_id": 503668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e31b50927ae3653852824ff297a1a21e?s=128&d=identicon&r=PG", "display_name": "Thorbear", "link": "https://stackoverflow.com/users/503668/thorbear"}, "edited": false, "score": 0, "creation_date": 1535440347, "post_id": 36052568, "comment_id": 91054269, "body": "Not sure what function he referred to with <code>F1</code>, for me that always just brings up the IDE online help.  To look up method/class documentation I would always recommend <code>Quick Documentation</code> (default shortcut is <code>Ctrl</code>/<code>Cmd</code> + <code>Q</code>). And this documentation <i>does</i> show the exceptions defined with the <code>@Throws</code> annotation."}], "tags": [], "owner": {"reputation": 233128, "user_id": 807126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpNqK.jpg?s=128&g=1", "display_name": "Doug Stevenson", "link": "https://stackoverflow.com/users/807126/doug-stevenson"}, "is_accepted": true, "score": 4, "last_activity_date": 1458193649, "creation_date": 1458193649, "answer_id": 36052568, "question_id": 36051508, "link": "https://stackoverflow.com/questions/36051508/is-there-any-easy-way-to-see-what-exceptions-a-kotlin-function-throws/36052568#36052568", "title": "Is there any easy way to see what exceptions a Kotlin function throws?", "body": "<p>If you want to know what exceptions a Java method throws when called by Kotlin from IntelliJ, you can use the F1 key shortcut to pull up the javadoc and see the throws declaration in the popup menu.</p>\n\n<p>Kotlin functions can declare exceptions that it throws using the <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.jvm/-throws/\" rel=\"nofollow\">@Throws</a> annotation. Annotations are obviously optional, so you probably can't expect this to always exist.  Unfortunately, when you use the F1 keyboard shortcut on a method using @Throws, it doesn't show the exceptions declared to be thrown.  Java calls into these methods are required to catch these exceptions declared in the annotation.</p>\n\n<p>Kotlin javadoc can use the @throws javadoc annotation to further provide definition exceptions that can be thrown in a function.  These do appear in javadoc and in F1 help popups.  An of course this is also optional.</p>\n"}, {"tags": [], "owner": {"reputation": 1339, "user_id": 1359988, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/00c331889adb81f68b66cd75734459a6?s=128&d=identicon&r=PG", "display_name": "zjuhasz", "link": "https://stackoverflow.com/users/1359988/zjuhasz"}, "is_accepted": false, "score": 1, "last_activity_date": 1461445660, "creation_date": 1461445660, "answer_id": 36816441, "question_id": 36051508, "link": "https://stackoverflow.com/questions/36051508/is-there-any-easy-way-to-see-what-exceptions-a-kotlin-function-throws/36816441#36816441", "title": "Is there any easy way to see what exceptions a Kotlin function throws?", "body": "<p>This library called <a href=\"https://github.com/kittinunf/Result\" rel=\"nofollow\">Result</a> is a nice solution. It returns a Result object with a value or an exception and changes its type to success or failure accordingly. They can also be chained together using the libraries map and flatmap functions which helps eliminate nested try-catch blocks. Very cool, I recommend anyone who finds this question check it out.</p>\n\n<p>Of course this only helps with functions that take advantage of it so I'm not marking this as an answer.</p>\n"}], "owner": {"reputation": 1339, "user_id": 1359988, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/00c331889adb81f68b66cd75734459a6?s=128&d=identicon&r=PG", "display_name": "zjuhasz", "link": "https://stackoverflow.com/users/1359988/zjuhasz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3269, "favorite_count": 1, "accepted_answer_id": 36052568, "answer_count": 2, "score": 14, "last_activity_date": 1461445660, "creation_date": 1458187753, "last_edit_date": 1458188519, "question_id": 36051508, "link": "https://stackoverflow.com/questions/36051508/is-there-any-easy-way-to-see-what-exceptions-a-kotlin-function-throws", "title": "Is there any easy way to see what exceptions a Kotlin function throws?", "body": "<p>I mostly understand the potential issues with checked exceptions and why Kotlin omits them. However, the issue I am encountering is I can't find any foolproof way of clearly indicating to the caller what exceptions a function may throw. </p>\n\n<p>I have run into the issue countless times in Python where my program will crash after running for months because I didn't realise a function from some library I'm using can raise a particular exception. Although being forced to catch exceptions can be quite problematic, it is nice to clearly see all the potential exceptions a function can throw.</p>\n\n<p>So back to the question, is there any simple way to see what exceptions a function throws in Kotlin? What about for methods written in Java that are being called from Kotlin? Even if just in tooling (intelliJ). I'm not counting writing it in javadoc or kdoc as the writer of the function you're using may have omitted it.</p>\n"}]