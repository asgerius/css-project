[{"tags": ["android", "robolectric", "kotlin"], "comments": [{"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "edited": false, "score": 0, "creation_date": 1452723020, "post_id": 34773958, "comment_id": 57301068, "body": "Just tried <a href=\"https://gist.github.com/miensol/d2a3c070f9efc50d8d2f\" rel=\"nofollow noreferrer\">your example</a> and it works just fine. What are versions of kotlin, mockito and roboelectric that you&#39;re using?"}, {"owner": {"reputation": 5042, "user_id": 229697, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4392f1e7194a98c289ea5f9a84ba00bb?s=128&d=identicon&r=PG", "display_name": "Ramps", "link": "https://stackoverflow.com/users/229697/ramps"}, "reply_to_user": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "edited": false, "score": 0, "creation_date": 1452788939, "post_id": 34773958, "comment_id": 57332739, "body": "Thanks for checking. I have updated the question. Which versions did you try?"}, {"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "edited": false, "score": 0, "creation_date": 1452802632, "post_id": 34773958, "comment_id": 57340952, "body": "Just rechecked <a href=\"https://gist.github.com/miensol/d2a3c070f9efc50d8d2f\" rel=\"nofollow noreferrer\">the sample from gist</a> and it works fine with the versions you&#39;ve listed. Seems that your code must be somewhat different. Can you post a stacktrace?"}, {"owner": {"reputation": 5042, "user_id": 229697, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4392f1e7194a98c289ea5f9a84ba00bb?s=128&d=identicon&r=PG", "display_name": "Ramps", "link": "https://stackoverflow.com/users/229697/ramps"}, "reply_to_user": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "edited": false, "score": 0, "creation_date": 1452883478, "post_id": 34773958, "comment_id": 57377538, "body": "I&#39;ve added the stacktrace. Unfortunately it doesn&#39;t seem very helpful."}, {"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "edited": false, "score": 0, "creation_date": 1452890118, "post_id": 34773958, "comment_id": 57381062, "body": "You&#39;re right it does not. It seems strange though that you have <code>RobolectricTestRunner</code> in stack trace even though the <code>RunWith</code> says <code>RobolectricGradleTestRunner</code>"}, {"owner": {"reputation": 4412, "user_id": 1650580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Su7AM.jpg?s=128&g=1", "display_name": "Mike Buhot", "link": "https://stackoverflow.com/users/1650580/mike-buhot"}, "edited": false, "score": 0, "creation_date": 1452943441, "post_id": 34773958, "comment_id": 57394540, "body": "Could the problem be that the return value of classCaptor.capture() is null?  Kotlin then thinks that the signature of IActivityHandler#navigateTo(Class, Boolean) cannot allow a null argument?"}, {"owner": {"reputation": 5042, "user_id": 229697, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4392f1e7194a98c289ea5f9a84ba00bb?s=128&d=identicon&r=PG", "display_name": "Ramps", "link": "https://stackoverflow.com/users/229697/ramps"}, "edited": false, "score": 2, "creation_date": 1452950543, "post_id": 34773958, "comment_id": 57396586, "body": "Yes, that&#39;s it. You are right. I didn&#39;t notice that the navigateTo method accepts only non-null values. When I changed singature of navigateTo method to this one:  fun navigateTo(clazz: Class&lt;out BaseActivity&gt;?, closeCurrent: Boolean), then example works fine. If you want, please, add an answer to this question, so in case anyone else has the same problem he can find the solution."}, {"owner": {"reputation": 18947, "user_id": 2646526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3618d0d22a0a8d282c9d46b4c0874020?s=128&d=identicon&r=PG", "display_name": "heenenee", "link": "https://stackoverflow.com/users/2646526/heenenee"}, "reply_to_user": {"reputation": 4412, "user_id": 1650580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Su7AM.jpg?s=128&g=1", "display_name": "Mike Buhot", "link": "https://stackoverflow.com/users/1650580/mike-buhot"}, "edited": false, "score": 0, "creation_date": 1454048082, "post_id": 34773958, "comment_id": 57878246, "body": "@MBuhot See Ramps&#39;s comment about posting an answer."}], "answers": [{"comments": [{"owner": {"reputation": 316, "user_id": 2853228, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8b84a9403558fc6f9e3842e68ebe4e8c?s=128&d=identicon&r=PG&f=1", "display_name": "BhathiyaW", "link": "https://stackoverflow.com/users/2853228/bhathiyaw"}, "edited": false, "score": 42, "creation_date": 1478566797, "post_id": 35100208, "comment_id": 68199076, "body": "Just adding to the above answer for anyone else searching for this: What you need is com.nhaarman.mockito_kotlin.capture(classCaptor) instead of classCaptor.capture()"}, {"owner": {"reputation": 1156, "user_id": 1649917, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/98f36daa955c06085670a76a55a246a6?s=128&d=identicon&r=PG&f=1", "display_name": "nmu", "link": "https://stackoverflow.com/users/1649917/nmu"}, "edited": false, "score": 3, "creation_date": 1492416226, "post_id": 35100208, "comment_id": 73950913, "body": "And <a href=\"https://gist.github.com/spookyUnknownUser/f0ab1d3b9a99a87c0c0e0155abac81c9\" rel=\"nofollow noreferrer\">here</a> is how a Test from google codelabs would look with the argument Captor"}, {"owner": {"reputation": 16055, "user_id": 2914140, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Ik94c.jpg?s=128&g=1", "display_name": "CoolMind", "link": "https://stackoverflow.com/users/2914140/coolmind"}, "edited": false, "score": 3, "creation_date": 1527084836, "post_id": 35100208, "comment_id": 87994136, "body": "I tried many times to apply com.nhaarman.mockito_kotlin.capture but couldn&#39;t success. See <a href=\"https://stackoverflow.com/questions/38715702/mockito-argumentcaptor-for-kotlin-function\" title=\"mockito argumentcaptor for kotlin function\">stackoverflow.com/questions/38715702/&hellip;</a>. There is a link to a wiki: <a href=\"https://github.com/nhaarman/mockito-kotlin/wiki/Mocking-and-verifying#argument-captors\" rel=\"nofollow noreferrer\">github.com/nhaarman/mockito-kotlin/wiki/&hellip;</a>. So, I tried to remove several Mockito* libraries from import, change <code>verify</code> to com.nhaarman.mockito_kotlin.verify, a problem disappeared."}, {"owner": {"reputation": 889, "user_id": 4821585, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/138294779e1d83525bae89fd11601dff?s=128&d=identicon&r=PG", "display_name": "Achraf Amil", "link": "https://stackoverflow.com/users/4821585/achraf-amil"}, "edited": false, "score": 3, "creation_date": 1564237169, "post_id": 35100208, "comment_id": 100968567, "body": "I had to explicitly specify that the T type should not be null : <code>com.nhaarman.mockitokotlin2.capture&lt;MyType&gt;(argumentCaptor)</code>"}, {"owner": {"reputation": 5947, "user_id": 1276636, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/5pipn.jpg?s=128&g=1", "display_name": "Sufian", "link": "https://stackoverflow.com/users/1276636/sufian"}, "reply_to_user": {"reputation": 16055, "user_id": 2914140, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Ik94c.jpg?s=128&g=1", "display_name": "CoolMind", "link": "https://stackoverflow.com/users/2914140/coolmind"}, "edited": false, "score": 0, "creation_date": 1564480232, "post_id": 35100208, "comment_id": 101036060, "body": "@CoolMind that was helpful. Thanks. For everyone else, please <a href=\"https://stackoverflow.com/a/57268842/1276636\">see my answer</a> which states what to do explicitly."}], "tags": [], "owner": {"reputation": 4412, "user_id": 1650580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Su7AM.jpg?s=128&g=1", "display_name": "Mike Buhot", "link": "https://stackoverflow.com/users/1650580/mike-buhot"}, "is_accepted": true, "score": 43, "last_activity_date": 1605902755, "last_edit_date": 1605902755, "creation_date": 1454146886, "answer_id": 35100208, "question_id": 34773958, "link": "https://stackoverflow.com/questions/34773958/kotlin-and-argumentcaptor-illegalstateexception/35100208#35100208", "title": "kotlin and ArgumentCaptor - IllegalStateException", "body": "<p>The return value of <code>classCaptor.capture()</code> is null, but the signature of <code>IActivityHandler#navigateTo(Class, Boolean)</code> does not allow a null argument.</p>\n<p>The <a href=\"https://github.com/nhaarman/mockito-kotlin\" rel=\"nofollow noreferrer\">mockito-kotlin</a> library provides supporting functions to solve this problem.</p>\n<p>Code should be:</p>\n<pre><code>    @Captor\n    lateinit var classCaptor: ArgumentCaptor&lt;Class&lt;BaseActivity&gt;&gt;\n\n    @Captor\n    lateinit var booleanCaptor: ArgumentCaptor&lt;Boolean&gt;\n\n    ...\n\n    @Test\n    fun thatNavigatesToAddListScreenOnAddClicked(){\n        //given\n\n        //when\n        objectUnderTest?.addNewList()\n\n        //then\n        verify(activityHandlerMock).navigateTo(\ncom.nhaarman.mockitokotlin2.capture&lt;Class&lt;BaseActivity&gt;&gt;(classCaptor.capture()), \ncom.nhaarman.mockitokotlin2.capture&lt;Boolean&gt;(booleanCaptor.capture())\n)\n        var clazzValue = classCaptor.value\n        assertNotNull(clazzValue);\n        val booleanValue = booleanCaptor.value\n        assertFalse(booleanValue);\n    }\n</code></pre>\n<p>OR</p>\n<pre><code>var classCaptor = com.nhaarman.mockitokotlin2.argumentCaptor&lt;Class&lt;BaseActivity&gt;&gt;()\nvar booleanCaptor = com.nhaarman.mockitokotlin2.argumentCaptor&lt;Boolean&gt;()\n...\n verify(activityHandlerMock).navigateTo(\nclassCaptor.capture(), \nbooleanCaptor.capture()\n)\n</code></pre>\n<p>also in build.gradle add this:</p>\n<pre><code>testImplementation &quot;com.nhaarman.mockitokotlin2:mockito-kotlin:2.2.0&quot;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1003, "user_id": 823483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/38ce4d4caf46e3d228f7f3824bcc80ca?s=128&d=identicon&r=PG", "display_name": "bompf", "link": "https://stackoverflow.com/users/823483/bompf"}, "edited": false, "score": 0, "creation_date": 1558357776, "post_id": 35366060, "comment_id": 99063769, "body": "I have no idea why, but this is the only solution that has worked for me so far. Although technically, the others should work as well, as all they seem to do is a generic cast of null to T."}], "tags": [], "owner": {"reputation": 7455, "user_id": 312161, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/e21cc7396d5879d3812e2a940ebca6cb?s=128&d=identicon&r=PG", "display_name": "neworld", "link": "https://stackoverflow.com/users/312161/neworld"}, "is_accepted": false, "score": 4, "last_activity_date": 1455290291, "last_edit_date": 1495542343, "creation_date": 1455290291, "answer_id": 35366060, "question_id": 34773958, "link": "https://stackoverflow.com/questions/34773958/kotlin-and-argumentcaptor-illegalstateexception/35366060#35366060", "title": "kotlin and ArgumentCaptor - IllegalStateException", "body": "<p>According <a href=\"https://stackoverflow.com/questions/30305217/is-it-possible-to-use-mockito-in-kotlin\">this solution</a> my solution here: </p>\n\n<pre><code>fun &lt;T&gt; uninitialized(): T = null as T\n\n//open verificator\nval verificator = verify(activityHandlerMock)\n\n//capture (would be same with all matchers)\nclassCaptor.capture()\nbooleanCaptor.capture()\n\n//hack\nverificator.navigateTo(uninitialized(), uninitialized())\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 266, "user_id": 6766759, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nEwBE9yjgf4/AAAAAAAAAAI/AAAAAAAAACA/gOTLACPuoNY/photo.jpg?sz=128", "display_name": "angryd", "link": "https://stackoverflow.com/users/6766759/angryd"}, "edited": false, "score": 1, "creation_date": 1514268052, "post_id": 46064204, "comment_id": 82918214, "body": "Thanks, it works fo me. The part of GoogleSample about UnitTest is well worth leanrning!"}, {"owner": {"reputation": 914, "user_id": 4100025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VfC87.png?s=128&g=1", "display_name": "Ikechukwu Kalu", "link": "https://stackoverflow.com/users/4100025/ikechukwu-kalu"}, "reply_to_user": {"reputation": 266, "user_id": 6766759, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nEwBE9yjgf4/AAAAAAAAAAI/AAAAAAAAACA/gOTLACPuoNY/photo.jpg?sz=128", "display_name": "angryd", "link": "https://stackoverflow.com/users/6766759/angryd"}, "edited": false, "score": 1, "creation_date": 1514425197, "post_id": 46064204, "comment_id": 82969770, "body": "I&#39;m glad it works for you, angryd. Sure!, I basically refer to their sample whenever I get stuck and it&#39;s also well documented."}, {"owner": {"reputation": 1190, "user_id": 6517628, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bjZIrJg2rsc/AAAAAAAAAAI/AAAAAAAABC4/RdjEmxif1Bg/photo.jpg?sz=128", "display_name": "Kaskasi", "link": "https://stackoverflow.com/users/6517628/kaskasi"}, "edited": false, "score": 1, "creation_date": 1515479356, "post_id": 46064204, "comment_id": 83304273, "body": "I think  this should be the accepted answer. Using fun capture(captor: ArgumentCaptor&lt;T&gt;) helped me without having to add mockito-kotlin:"}, {"owner": {"reputation": 914, "user_id": 4100025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VfC87.png?s=128&g=1", "display_name": "Ikechukwu Kalu", "link": "https://stackoverflow.com/users/4100025/ikechukwu-kalu"}, "reply_to_user": {"reputation": 1190, "user_id": 6517628, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bjZIrJg2rsc/AAAAAAAAAAI/AAAAAAAABC4/RdjEmxif1Bg/photo.jpg?sz=128", "display_name": "Kaskasi", "link": "https://stackoverflow.com/users/6517628/kaskasi"}, "edited": false, "score": 0, "creation_date": 1515498866, "post_id": 46064204, "comment_id": 83314351, "body": "Sure, @Kaskasi. It&#39;s way simpler to use. Thanks."}, {"owner": {"reputation": 7792, "user_id": 1691423, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/YtJy0.jpg?s=128&g=1", "display_name": "vlio20", "link": "https://stackoverflow.com/users/1691423/vlio20"}, "edited": false, "score": 3, "creation_date": 1534620552, "post_id": 46064204, "comment_id": 90773865, "body": "I am still having the same issue after adding: <code>fun &lt;T&gt; capture(argumentCaptor: ArgumentCaptor&lt;T&gt;): T = argumentCaptor.capture()</code>    Then in the test: <code>val userCacheCaptor = ArgumentCaptor.forClass(User::class.java)     Mockito.verify(userCache, Mockito.times(1)).set(Mockito.anyString(), capture(userCacheCaptor))</code>  the error is: <code>java.lang.IllegalStateException: capture(userCacheCaptor) must not be null </code>"}, {"owner": {"reputation": 914, "user_id": 4100025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VfC87.png?s=128&g=1", "display_name": "Ikechukwu Kalu", "link": "https://stackoverflow.com/users/4100025/ikechukwu-kalu"}, "reply_to_user": {"reputation": 7792, "user_id": 1691423, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/YtJy0.jpg?s=128&g=1", "display_name": "vlio20", "link": "https://stackoverflow.com/users/1691423/vlio20"}, "edited": false, "score": 0, "creation_date": 1534912317, "post_id": 46064204, "comment_id": 90869996, "body": "@vlio20, how about casting the userCacheCaptor to the User class? More like: <code>Mockito.verify(eq(userCache), Mockito.times(1)).set(Mockito.anyString(), capture(userCacheCaptor) as User)</code>. Sorry for the late reply"}, {"owner": {"reputation": 4485, "user_id": 293878, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d7ae5e6ca15a70cd42b06dbabab55625?s=128&d=identicon&r=PG", "display_name": "Roberto Leinardi", "link": "https://stackoverflow.com/users/293878/roberto-leinardi"}, "edited": false, "score": 6, "creation_date": 1564641197, "post_id": 46064204, "comment_id": 101099029, "body": "@IkechukwuKalu I had the same issue than I solved using the annotation <code>@Captor private lateinit var snackbarManagerArgumentCaptor: ArgumentCaptor&lt;ShowSnackbarEvent&gt;</code> and then the helper <code>verify(snackbarManager).show(capture(snackbarManagerArgument&zwnj;&#8203;Captor))</code>."}, {"owner": {"reputation": 2829, "user_id": 2828100, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/538592314/picture?type=large", "display_name": "funct7", "link": "https://stackoverflow.com/users/2828100/funct7"}, "reply_to_user": {"reputation": 4485, "user_id": 293878, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d7ae5e6ca15a70cd42b06dbabab55625?s=128&d=identicon&r=PG", "display_name": "Roberto Leinardi", "link": "https://stackoverflow.com/users/293878/roberto-leinardi"}, "edited": false, "score": 0, "creation_date": 1597655971, "post_id": 46064204, "comment_id": 112193754, "body": "The solution @RobertoLeinardi suggested worked for me."}, {"owner": {"reputation": 267, "user_id": 1797806, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bGEr1.png?s=128&g=1", "display_name": "CanonicalBear", "link": "https://stackoverflow.com/users/1797806/canonicalbear"}, "edited": false, "score": 0, "creation_date": 1612712571, "post_id": 46064204, "comment_id": 116846649, "body": "Works for me. This should be the accepted answer."}], "tags": [], "owner": {"reputation": 914, "user_id": 4100025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VfC87.png?s=128&g=1", "display_name": "Ikechukwu Kalu", "link": "https://stackoverflow.com/users/4100025/ikechukwu-kalu"}, "is_accepted": false, "score": 45, "last_activity_date": 1612758035, "last_edit_date": 1612758035, "creation_date": 1504650702, "answer_id": 46064204, "question_id": 34773958, "link": "https://stackoverflow.com/questions/34773958/kotlin-and-argumentcaptor-illegalstateexception/46064204#46064204", "title": "kotlin and ArgumentCaptor - IllegalStateException", "body": "<p>From this <a href=\"http://derekwilson.net/blog/2018/08/23/mokito-kotlin\" rel=\"nofollow noreferrer\">blog</a></p>\n<p>&quot;Getting matchers to work with Kotlin can be a problem. If you have a method written in kotlin that does not take a nullable parameter then we cannot match with it using Mockito.any(). This is because it can return void and this is not assignable to a non-nullable parameter. If the method being matched is written in Java then I think that it will work as all Java objects are implicitly nullable.&quot;</p>\n<p>A wrapper function is needed that returns <code>ArgumentCaptor.capture()</code> as nullable type.</p>\n<p>Add the following as a helper method to your test</p>\n<pre><code>fun &lt;T&gt; capture(argumentCaptor: ArgumentCaptor&lt;T&gt;): T = argumentCaptor.capture()\n</code></pre>\n<p>Please see, <a href=\"https://github.com/googlesamples/android-architecture-components/blob/master/BasicRxJavaSampleKotlin/app/src/test/java/com/example/android/observability/MockitoKotlinHelpers.kt\" rel=\"nofollow noreferrer\">MockitoKotlinHelpers.kt</a> provided by Google in the Android Architecture repo for reference. the <code>capture</code> function provides a convenient way to call <code>ArgumentCaptor.capture()</code>. Call</p>\n<pre><code>verify(activityHandlerMock).navigateTo(capture(classCaptor), capture(booleanCaptor))\n</code></pre>\n<p><strong>Update:</strong> If the above solution does not work for you, please check Roberto Leinardi's solution in the comments below.</p>\n"}, {"tags": [], "owner": {"reputation": 1271, "user_id": 3339597, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/16ea9e6ce4d4fa8bfee0982ca0844f94?s=128&d=identicon&r=PG&f=1", "display_name": "Re&#39;em", "link": "https://stackoverflow.com/users/3339597/reem"}, "is_accepted": false, "score": 0, "last_activity_date": 1516512182, "creation_date": 1516512182, "answer_id": 48363940, "question_id": 34773958, "link": "https://stackoverflow.com/questions/34773958/kotlin-and-argumentcaptor-illegalstateexception/48363940#48363940", "title": "kotlin and ArgumentCaptor - IllegalStateException", "body": "<p>Came here after the kotlin-Mockito library didn't help. \nI created a solution using reflection.\nIt is a function which extracts the argument provided to the mocked-object earlier:</p>\n\n<pre><code>fun &lt;T: Any, S&gt; getTheArgOfUsedFunctionInMockObject(mockedObject: Any, function: (T) -&gt; S, clsOfArgument: Class&lt;T&gt;): T{\n    val argCaptor= ArgumentCaptor.forClass(clsOfArgument)\n    val ver = verify(mockedObject)\n    argCaptor.capture()\n    ver.javaClass.methods.first { it.name == function.reflect()!!.name }.invoke(ver, uninitialized())\n    return argCaptor.value\n}\nprivate fun &lt;T&gt; uninitialized(): T = null as T\n</code></pre>\n\n<p>Usage:\n(Say I have mocked my repository and tested a viewModel. After calling the viewModel's \"update()\" method with a MenuObject object, I want to make sure that the MenuObject actually called upon the repository's \"updateMenuObject()\" method:</p>\n\n<pre><code>viewModel.update(menuObjectToUpdate)\nval arg = getTheArgOfUsedFunctionInMockObject(mockedRepo, mockedRepo::updateMenuObject, MenuObject::class.java)\nassertEquals(menuObjectToUpdate, arg)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 366, "user_id": 1288683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R0pyS.jpg?s=128&g=1", "display_name": "enes.acikoglu", "link": "https://stackoverflow.com/users/1288683/enes-acikoglu"}, "is_accepted": false, "score": 16, "last_activity_date": 1583335593, "last_edit_date": 1583335593, "creation_date": 1529232877, "answer_id": 50895941, "question_id": 34773958, "link": "https://stackoverflow.com/questions/34773958/kotlin-and-argumentcaptor-illegalstateexception/50895941#50895941", "title": "kotlin and ArgumentCaptor - IllegalStateException", "body": "<p>Use kotlin-mockito <a href=\"https://mvnrepository.com/artifact/com.nhaarman/mockito-kotlin/1.5.0\" rel=\"noreferrer\">https://mvnrepository.com/artifact/com.nhaarman/mockito-kotlin/1.5.0</a> as dependency and sample code as written below :</p>\n\n<pre><code>argumentCaptor&lt;Hotel&gt;().apply {\n    verify(hotelSaveService).save(capture())\n\n    assertThat(allValues.size).isEqualTo(1)\n    assertThat(firstValue.name).isEqualTo(\"\u0130stanbul Hotel\")\n    assertThat(firstValue.totalRoomCount).isEqualTo(10000L)\n    assertThat(firstValue.freeRoomCount).isEqualTo(5000L)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 542, "user_id": 3767877, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000281244803/picture?type=large", "display_name": "Amit Kaushik", "link": "https://stackoverflow.com/users/3767877/amit-kaushik"}, "is_accepted": false, "score": 0, "last_activity_date": 1539070197, "creation_date": 1539070197, "answer_id": 52715547, "question_id": 34773958, "link": "https://stackoverflow.com/questions/34773958/kotlin-and-argumentcaptor-illegalstateexception/52715547#52715547", "title": "kotlin and ArgumentCaptor - IllegalStateException", "body": "<p>You can write a wrapper over argument captor</p>\n\n<pre><code>class CaptorWrapper&lt;T:Any&gt;(private val captor:ArgumentCaptor&lt;T&gt;, private val obj:T){\n    fun capture():T{\n        captor.capture()\n        return obj\n    }\n\n    fun captor():ArgumentCaptor&lt;T&gt;{\n        return captor\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5947, "user_id": 1276636, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/5pipn.jpg?s=128&g=1", "display_name": "Sufian", "link": "https://stackoverflow.com/users/1276636/sufian"}, "is_accepted": false, "score": 6, "last_activity_date": 1564568486, "last_edit_date": 1564568486, "creation_date": 1564480142, "answer_id": 57268842, "question_id": 34773958, "link": "https://stackoverflow.com/questions/34773958/kotlin-and-argumentcaptor-illegalstateexception/57268842#57268842", "title": "kotlin and ArgumentCaptor - IllegalStateException", "body": "<p>As stated by <a href=\"https://stackoverflow.com/questions/34773958/kotlin-and-argumentcaptor-illegalstateexception#comment87994136_35100208\">CoolMind in the comment</a>, you first need to add gradle import for <a href=\"https://github.com/nhaarman/mockito-kotlin\" rel=\"noreferrer\">Kotlin-Mockito</a> and then shift all your imports to use this library. Your imports will now look like:</p>\n\n<pre><code>import com.nhaarman.mockitokotlin2.argumentCaptor\nimport com.nhaarman.mockitokotlin2.any\nimport com.nhaarman.mockitokotlin2.eq\nimport com.nhaarman.mockitokotlin2.isNull\nimport com.nhaarman.mockitokotlin2.mock\nimport com.nhaarman.mockitokotlin2.verify\n</code></pre>\n\n<p>Then your test class will be something like this:</p>\n\n<pre><code>val mArgumentCaptor = argumentCaptor&lt;SignUpInteractor.Callback&gt;()\n\n@Test\nfun signUp_success() {\n    val customer = Customer().apply {\n        name = \"Test Name\"\n        email = \"test@example.com\"\n        phone = \"0123444456789\"\n        phoneDdi = \"+92\"\n        phoneNumber = \"\"\n        countryCode = \"92\"\n        password = \"123456\"\n    }\n    mPresenter.signUp(customer)\n    verify(mView).showProgress()\n    verify(mInteractor).createAccount(any(), isNull(), mArgumentCaptor.capture())\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10917953, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5fqgBWOWLa4/AAAAAAAAAAI/AAAAAAAAAPg/2X6iHoKSK_Y/photo.jpg?sz=128", "display_name": "Nikolas", "link": "https://stackoverflow.com/users/10917953/nikolas"}, "is_accepted": false, "score": 0, "last_activity_date": 1582144047, "creation_date": 1582144047, "answer_id": 60308699, "question_id": 34773958, "link": "https://stackoverflow.com/questions/34773958/kotlin-and-argumentcaptor-illegalstateexception/60308699#60308699", "title": "kotlin and ArgumentCaptor - IllegalStateException", "body": "<p>Another approach:</p>\n\n<pre><code>/**\n * Use instead of ArgumentMatcher.argThat(matcher: ArgumentMatcher&lt;T&gt;)\n */\nfun &lt;T&gt; safeArgThat(matcher: ArgumentMatcher&lt;T&gt;): T {\n    ThreadSafeMockingProgress.mockingProgress().argumentMatcherStorage\n        .reportMatcher(matcher)\n    return uninitialized()\n}\n\n@Suppress(\"UNCHECKED_CAST\")\nprivate fun &lt;T&gt; uninitialized(): T = null as T\n</code></pre>\n\n<p><strong>Usage:</strong></p>\n\n<pre><code>verify(spiedElement, times(1)).method(\n    safeArgThat(\n        CustomMatcher()\n    )\n)\n</code></pre>\n"}], "owner": {"reputation": 5042, "user_id": 229697, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4392f1e7194a98c289ea5f9a84ba00bb?s=128&d=identicon&r=PG", "display_name": "Ramps", "link": "https://stackoverflow.com/users/229697/ramps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18140, "favorite_count": 4, "accepted_answer_id": 35100208, "answer_count": 8, "score": 52, "last_activity_date": 1612758035, "creation_date": 1452708474, "last_edit_date": 1452883345, "question_id": 34773958, "link": "https://stackoverflow.com/questions/34773958/kotlin-and-argumentcaptor-illegalstateexception", "title": "kotlin and ArgumentCaptor - IllegalStateException", "body": "<p>I have a problem with capturing the Class argument via ArgumentCaptor. My test class looks like this:</p>\n\n<pre><code>@RunWith(RobolectricGradleTestRunner::class)\n@Config(sdk = intArrayOf(21), constants = BuildConfig::class)\nclass MyViewModelTest {\n    @Mock\n    lateinit var activityHandlerMock: IActivityHandler;\n\n    @Captor\n    lateinit var classCaptor: ArgumentCaptor&lt;Class&lt;BaseActivity&gt;&gt;\n\n    @Captor\n    lateinit var booleanCaptor: ArgumentCaptor&lt;Boolean&gt;\n\n    private var objectUnderTest: MyViewModel? = null\n\n    @Before\n    fun setUp() {\n        initMocks(this)\n        ...\n        objectUnderTest = MyViewModel(...)\n    }\n\n    @Test\n    fun thatNavigatesToAddListScreenOnAddClicked(){\n        //given\n\n        //when\n        objectUnderTest?.addNewList()\n\n        //then\n        verify(activityHandlerMock).navigateTo(classCaptor.capture(), booleanCaptor.capture())\n        var clazz = classCaptor.value\n        assertNotNull(clazz);\n        assertFalse(booleanCaptor.value);\n    }\n}\n</code></pre>\n\n<p>When I run the test, following exception is thrown:<br>\njava.lang.IllegalStateException: classCaptor.capture() must not be null<br>\nIs it possible to use argument captors in kotlin?</p>\n\n<p>=========\nUPDATE 1:<br>\nKotlin: 1.0.0-beta-4584<br>\nMockito: 1.10.19<br>\nRobolectric: 3.0</p>\n\n<p>=========\nUPDATE 2:<br>\n Stacktrace:<br></p>\n\n<pre><code>java.lang.IllegalStateException: classCaptor.capture() must not be null\n\nat com.example.view.model.ShoplistsViewModelTest.thatNavigatesToAddListScreenOnAddClicked(ShoplistsViewModelTest.kt:92)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:606)\nat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)\nat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\nat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)\nat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)\nat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)\nat org.robolectric.RobolectricTestRunner$2.evaluate(RobolectricTestRunner.java:251)\nat org.robolectric.RobolectricTestRunner.runChild(RobolectricTestRunner.java:188)\nat org.robolectric.RobolectricTestRunner.runChild(RobolectricTestRunner.java:54)\nat org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)\nat org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)\nat org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)\nat org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)\nat org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)\nat org.robolectric.RobolectricTestRunner$1.evaluate(RobolectricTestRunner.java:152)\nat org.junit.runners.ParentRunner.run(ParentRunner.java:363)\nat org.junit.runner.JUnitCore.run(JUnitCore.java:137)\nat com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)\nat com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)\nat com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:606)\nat com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)\n</code></pre>\n"}, {"tags": ["immutability", "kotlin"], "comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 1, "creation_date": 1452704591, "post_id": 34770493, "comment_id": 57290402, "body": "Please scan the Kotlin stdlib reference for collections and the different collection types, to become aware of many other functions similar to <code>toList()</code> <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections\" rel=\"nofollow noreferrer\">kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections</a>"}, {"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "edited": false, "score": 0, "creation_date": 1452725849, "post_id": 34770493, "comment_id": 57302332, "body": "See also <a href=\"http://stackoverflow.com/questions/33727657/kotlin-and-immutable-collections\" title=\"kotlin and immutable collections\">stackoverflow.com/questions/33727657/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "edited": false, "score": 1, "creation_date": 1452726019, "post_id": 34770659, "comment_id": 57302392, "body": "Note that read-only lists work great for instantiating effectively immutable lists but do not work for data classes or other cases where you want to receive a reference to an immutable list because a <code>MutableList&lt;T&gt;</code> is a <code>List&lt;T&gt;</code> so if a constructor, function, etc. asks for a <code>List&lt;T&gt;</code> someone can still pass in a <code>MutableList&lt;T&gt;</code> and later modify it. See <a href=\"http://stackoverflow.com/questions/33727657/kotlin-and-immutable-collections/34027828#34027828\" title=\"kotlin and immutable collections\">stackoverflow.com/questions/33727657/&hellip;</a> for some an example with further details."}], "tags": [], "owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "is_accepted": true, "score": 12, "last_activity_date": 1452763181, "last_edit_date": 1452763181, "creation_date": 1452699208, "answer_id": 34770659, "question_id": 34770493, "link": "https://stackoverflow.com/questions/34770493/kotlin-instantiate-immutable-list/34770659#34770659", "title": "Kotlin Instantiate Immutable List", "body": "<p>In Kotlin, <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-list/index.html\" rel=\"nofollow noreferrer\"><code>List&lt;T&gt;</code></a> is a <em>read-only</em> list interface, it has no functions for changing the content, unlike <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-mutable-list/index.html\" rel=\"nofollow noreferrer\"><code>MutableList&lt;T&gt;</code></a>. </p>\n\n<p>In general, <code>List&lt;T&gt;</code> implementation <em>may be</em> a mutable list (e.g. <code>ArrayList&lt;T&gt;</code>), but if you pass it as a <code>List&lt;T&gt;</code>, no mutating functions will be exposed without casting. Such a list reference is called <em>read-only</em>, stating that the list is not meant to be changed. This is <a href=\"http://www.andygibson.net/blog/programming/immutability-through-interfaces/\" rel=\"nofollow noreferrer\">immutability through interfaces</a> which was chosen as the approach to immutability for Kotlin stdlib.</p>\n\n<p>Closer to the question, <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/kotlin.-iterable/to-list.html\" rel=\"nofollow noreferrer\"><code>toList()</code></a> extension function for <code>Iterable&lt;T&gt;</code> in stdlib will fit: it returns read-only <code>List&lt;T&gt;</code>.</p>\n\n<p>Example:</p>\n\n<pre><code>val iterable: Iterable&lt;Int&gt; = listOf(1, 2, 3)\nval list: List&lt;Int&gt; = iterable.toList()\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 2591661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bf54a5bf2e2e32f1f69867ab91bd059?s=128&d=identicon&r=PG", "display_name": "alhart", "link": "https://stackoverflow.com/users/2591661/alhart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2094, "favorite_count": 1, "accepted_answer_id": 34770659, "answer_count": 1, "score": 4, "last_activity_date": 1452767934, "creation_date": 1452698735, "last_edit_date": 1452767934, "question_id": 34770493, "link": "https://stackoverflow.com/questions/34770493/kotlin-instantiate-immutable-list", "title": "Kotlin Instantiate Immutable List", "body": "<p>I've started using Kotlin as a substitute for java and quite like it. However, I've been unable to find a solution to this without jumping back into java-land:</p>\n\n<p>I have an <code>Iterable&lt;SomeObject&gt;</code> and need to convert it to a list so I can iterate through it more than once. This is an obvious application of an immutable list, as all I need to do is read it several times. How do I actually put that data in the list at the beginning though? (I know it's an interface, but I've been unable to find an implementation of it in documentation)</p>\n\n<p>Possible (if unsatisfactory) solutions:</p>\n\n<pre><code>val valueList = arrayListOf(values)\n// iterate through valuelist\n</code></pre>\n\n<p>or</p>\n\n<pre><code>fun copyIterableToList(values: Iterable&lt;SomeObject&gt;) : List&lt;SomeObject&gt; {\n    var outList = ArrayList&lt;SomeObject&gt;()\n    for (value in values) {\n        outList.add(value)\n    }\n    return outList\n}\n</code></pre>\n\n<p>Unless I'm misunderstanding, these end up with <code>MutableLists</code>, which works but feels like a workaround. Is there a similar <code>immutableListOf(Iterable&lt;SomeObject&gt;)</code> method that will instantiate an immutable list object?</p>\n"}, {"tags": ["kotlin"], "comments": [{"owner": {"reputation": 89682, "user_id": 675383, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e7a971eb341ffeaa3efca407239bf3b?s=128&d=identicon&r=PG", "display_name": "nhaarman", "link": "https://stackoverflow.com/users/675383/nhaarman"}, "edited": false, "score": 0, "creation_date": 1452698559, "post_id": 34770220, "comment_id": 57285663, "body": "The program works over here, running directly from IntelliJ. Did you try cleaning your project?"}, {"owner": {"reputation": 35330, "user_id": 322642, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0030846647f93ba6bf0938a199688c2e?s=128&d=identicon&r=PG", "display_name": "ligi", "link": "https://stackoverflow.com/users/322642/ligi"}, "reply_to_user": {"reputation": 89682, "user_id": 675383, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e7a971eb341ffeaa3efca407239bf3b?s=128&d=identicon&r=PG", "display_name": "nhaarman", "link": "https://stackoverflow.com/users/675383/nhaarman"}, "edited": false, "score": 0, "creation_date": 1452699005, "post_id": 34770220, "comment_id": 57285986, "body": "@nhaarman is a gradle clean run working for you? The error message is different after clean but there is still a problem"}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1452704669, "post_id": 34770220, "comment_id": 57290456, "body": "Keeping up to date with Kotlin changes via <a href=\"http://blog.jetbrains.com/kotlin/\" rel=\"nofollow noreferrer\">blog.jetbrains.com/kotlin</a> will let you know when something significant changes.  Although nothing is expected post 1.0 for breaking changes, some might happen before."}], "answers": [{"tags": [], "owner": {"reputation": 11834, "user_id": 1538877, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/N9qfZ.jpg?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/1538877/ruslan"}, "is_accepted": true, "score": 5, "last_activity_date": 1452713844, "last_edit_date": 1452713844, "creation_date": 1452699591, "answer_id": 34770829, "question_id": 34770220, "link": "https://stackoverflow.com/questions/34770220/kotlin-cli-application-fails-to-work-after-updating-to-kotlin-1-0-0-beta/34770829#34770829", "title": "Kotlin cli application fails to work after updating to kotlin 1.0.0-beta", "body": "<p>Change mainClassName to</p>\n\n<pre><code>mainClassName = \"minimalkotlincommandline.MainKt\"\n</code></pre>\n\n<p>Since Kotlin version M14 <a href=\"http://blog.jetbrains.com/kotlin/2015/10/kotlin-m14-is-out/\" rel=\"nofollow\">top-level naming changed</a> from <code>${Package}Package</code> to <code>${File}Kt</code>. More info in <a href=\"https://kotlinlang.org/docs/reference/java-to-kotlin-interop.html#package-level-functions\" rel=\"nofollow\">documentation</a>.</p>\n"}], "owner": {"reputation": 35330, "user_id": 322642, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0030846647f93ba6bf0938a199688c2e?s=128&d=identicon&r=PG", "display_name": "ligi", "link": "https://stackoverflow.com/users/322642/ligi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 34770829, "answer_count": 1, "score": 2, "last_activity_date": 1452713844, "creation_date": 1452697972, "last_edit_date": 1452698967, "question_id": 34770220, "link": "https://stackoverflow.com/questions/34770220/kotlin-cli-application-fails-to-work-after-updating-to-kotlin-1-0-0-beta", "title": "Kotlin cli application fails to work after updating to kotlin 1.0.0-beta", "body": "<p>I boiled the problem down to the following minimal setup - just a hello world. This one works:</p>\n\n<p><a href=\"https://github.com/ligi/MinimalKotlinCommandLine\" rel=\"nofollow\">https://github.com/ligi/MinimalKotlinCommandLine</a></p>\n\n<p>when I switch to kotlin:1.0.0-beta-4584 and run ( gradle clean run ) I am getting the following error:</p>\n\n<pre><code>Error: Could not find or load main class minimalkotlincommandline.MinimalkotlincommandlinePackage\n</code></pre>\n\n<p>with this build.gradle:</p>\n\n<pre><code>buildscript {\n    repositories {\n        mavenCentral()\n    }\n    dependencies {\n        classpath 'org.jetbrains.kotlin:kotlin-gradle-plugin:1.0.0-beta-4584'\n    }\n}\n\napply plugin: \"kotlin\"\napply plugin: 'application'\n\nmainClassName = \"minimalkotlincommandline.MinimalkotlincommandlinePackage\"\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    compile 'org.jetbrains.kotlin:kotlin-stdlib:1.0.0-beta-4584'\n}\n</code></pre>\n\n<p>and this Main.kt:\npackage minimalkotlincommandline</p>\n\n<pre><code>fun main(args: Array&lt;String&gt;) {\n    println(\"Hello world \")\n}\n</code></pre>\n"}, {"tags": ["java", "kotlin"], "comments": [{"owner": {"reputation": 89682, "user_id": 675383, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e7a971eb341ffeaa3efca407239bf3b?s=128&d=identicon&r=PG", "display_name": "nhaarman", "link": "https://stackoverflow.com/users/675383/nhaarman"}, "edited": false, "score": 0, "creation_date": 1452675486, "post_id": 34762029, "comment_id": 57269559, "body": "What Kotlin version are you using?"}], "answers": [{"tags": [], "owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "is_accepted": true, "score": 12, "last_activity_date": 1452679160, "creation_date": 1452679160, "answer_id": 34763541, "question_id": 34762029, "link": "https://stackoverflow.com/questions/34762029/getting-incompatible-types-error-when-using-code-generated-from-a-kotlin-data/34763541#34763541", "title": "Getting &quot;Incompatible types&quot; error when using code generated from a Kotlin data class", "body": "<p>In general, when javac loads a .class file, it does not perform a complete type check of the code in that class; it will trust the generic signatures specified in the bytecode. Because of that, other JVM languages can generate signatures which javac itself would refuse to generate.</p>\n\n<p>In this specific case, the wildcards generated by Kotlin beta 4 make no sense (<code>Integer[]</code> is a final class, so <code>? extends Integer[]</code> is useless), so the current development version doesn't generate any wildcards in this example.</p>\n\n<p>More generally, our goal is to ensure that APIs written in Kotlin are easy to consume from Java code, and in order to achieve this, Kotlin lets you control where exactly it generates wildcards. This is described <a href=\"http://blog.jetbrains.com/kotlin/2015/12/kotlin-1-0-beta-4-is-out/\">here</a> under \"Java Wildcards\".</p>\n"}], "owner": {"reputation": 7190, "user_id": 1584931, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/210b97cdd2f03f14ce874e23b7b52c73?s=128&d=identicon&r=PG", "display_name": "Bradley Campbell", "link": "https://stackoverflow.com/users/1584931/bradley-campbell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3036, "favorite_count": 3, "accepted_answer_id": 34763541, "answer_count": 1, "score": 6, "last_activity_date": 1452679160, "creation_date": 1452674841, "last_edit_date": 1452677508, "question_id": 34762029, "link": "https://stackoverflow.com/questions/34762029/getting-incompatible-types-error-when-using-code-generated-from-a-kotlin-data", "title": "Getting &quot;Incompatible types&quot; error when using code generated from a Kotlin data class", "body": "<p>If I decompile the .class file generated by <code>data class State(val b: List&lt;Array&lt;Int&gt;&gt;)</code> then I get the following Java code:</p>\n\n<pre><code>public final class State {\n    private final List&lt;? extends Integer[]&gt; b;\n\n    public State(List&lt;? extends Integer[]&gt; b) {\n      this.b = b;\n    }\n\n    public final List&lt;Integer[]&gt; getB() {\n      return this.b;\n    }\n\n    // ...\n}\n</code></pre>\n\n<p>If I copy/paste this java code into my IDE (Intellij 15), I get the following compilation error in the <code>getB()</code> method:</p>\n\n<pre><code>Incompatible types.\n\nRequired: List&lt;Integer[]&gt;\nFound:    List&lt;? extends Integer[]&gt;\n</code></pre>\n\n<p>What am I missing here? How is the Kotlin generated code able to do this but not my copy/pasted version?</p>\n"}, {"tags": ["kotlin", "kotlin-extension"], "answers": [{"comments": [{"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 1, "creation_date": 1452640461, "post_id": 34752211, "comment_id": 57257202, "body": "really? So now secondary constructors are better than factory functions? I think we need an official opinion (in the docs)"}, {"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "reply_to_user": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 1, "creation_date": 1452640939, "post_id": 34752211, "comment_id": 57257400, "body": "@voddan, the question and the answer are not about secondary constructors, they&#39;re about having a function mimic a constructor. What about secondary constructors, they are of no use when a function should return a subclass instance with different implementation. Otherwise, they seem to fit better than factory functions (reflection, super ctor call, Java interop)."}, {"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1452668562, "post_id": 34752211, "comment_id": 57265718, "body": "well, the sole propose of functions named like classes is factoring those classes without flooding the class code. The alternative is secondary constructors, and it is kind of implied in your answer."}, {"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "reply_to_user": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1452674003, "post_id": 34752211, "comment_id": 57268654, "body": "@voddan, well, in the answer I just stated that <i>naming</i> a factory function same to class may not be a good idea and why it&#39;s better to adhere the official naming style, explaining what may follow if one does not. The answer doesn&#39;t actually recommend using constructors instead of factory functions. Should I edit the answer to clarify it somehow?"}, {"owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "edited": false, "score": 7, "creation_date": 1452674789, "post_id": 34752211, "comment_id": 57269120, "body": "As the developer responsible for the Kotlin docs, I find this answer to be very sensible guidance. There is no reason to prefer secondary constructors to factory functions, but when you do use factory functions, the code is clearer if you give them distinct names, different from the name of the class."}, {"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "reply_to_user": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "edited": false, "score": 0, "creation_date": 1452681392, "post_id": 34752211, "comment_id": 57273724, "body": "@yole, thanks, I updated the answer to emphasize that the points stated are not against factory functions but against the naming style in question."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1452704949, "post_id": 34752211, "comment_id": 57290643, "body": "In context, this originated from this other comment in another question where it was stipulated this was a good idea: <a href=\"http://stackoverflow.com/questions/34738702/is-there-a-way-to-construct-a-hashset-with-initializator-function-in-kotlin#comment57225254_34739302\" title=\"is there a way to construct a hashset with initializator function in kotlin%23comment57225254_34739302\">stackoverflow.com/questions/34738702/&hellip;</a> but I commented that it was a bad idea.  You explanation here is nicely done and thorough."}], "tags": [], "owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "is_accepted": true, "score": 15, "last_activity_date": 1515768457, "last_edit_date": 1515768457, "creation_date": 1452626917, "answer_id": 34752211, "question_id": 34751897, "link": "https://stackoverflow.com/questions/34751897/should-we-avoid-naming-a-function-same-as-an-existing-class-in-kotlin-why/34752211#34752211", "title": "Should we avoid naming a function same as an existing class in Kotlin? Why?", "body": "<p><strong>UPD</strong></p>\n\n<p>In the updated coding conventions, there's a <a href=\"https://kotlinlang.org/docs/reference/coding-conventions.html#factory-functions\" rel=\"nofollow noreferrer\">section on this topic</a>:</p>\n\n<blockquote>\n  <p><strong>Factory functions</strong></p>\n  \n  <p>If you declare a factory function for a class, avoid giving it the same name as the class itself. Prefer using a distinct name making it clear why the behavior of the factory function is special. Only if there is really no special semantics, you can use the same name as the class.</p>\n  \n  <p>Example: </p>\n\n<pre><code>class Point(val x: Double, val y: Double) {\n    companion object {\n        fun fromPolar(angle: Double, radius: Double) = Point(...)\n    }\n}\n</code></pre>\n</blockquote>\n\n<p>The motivation I described below, though, seems to still hold.</p>\n\n<hr>\n\n<p>As said in documentation about the <a href=\"https://kotlinlang.org/docs/reference/coding-conventions.html\" rel=\"nofollow noreferrer\">naming style</a>:</p>\n\n<blockquote>\n  <p>If in doubt default to the Java Coding Conventions such as:</p>\n  \n  <ul>\n  <li>methods and properties start with lower case</li>\n  </ul>\n</blockquote>\n\n<p>One strong reason to avoid naming a function same to a class is that it might confuse a developer who will use it later, because, contrary to their expectations:</p>\n\n<ul>\n<li>the function won't be available for super constructor call (if the class is <code>open</code>)</li>\n<li>it won't be visible as a constructor through reflection</li>\n<li>it won't be usable as a constructor in Java code (<code>new HashSet(n, it -&gt; \"Element \" + it)</code> is an error)</li>\n<li>if you want to change the implementation later and return some subclass instance instead, it will get even more confusing that <code>HashSet(n) { \"Element $it\" }</code> will construct not a <code>HashSet</code> but, for example, a <code>LinkedHashSet</code></li>\n</ul>\n\n<p>It's better to show it explicitly that it's a factory function, not a constructor, to avoid this confusion.</p>\n\n<p>Naming a function same to a class is generally avoided in stdlib, too. Given <code>SomeClass</code>, in stdlib a preferred naming style for factory functions is <code>someClassOf</code>, <code>someClassBy</code> or whatever explains the semantics of the function best. The examples:</p>\n\n<ul>\n<li><code>generateSequence { ... }</code> and <code>sequenceOf(...)</code></li>\n<li><code>lazy { ... }</code> and <code>lazyOf(...)</code></li>\n<li><code>compareBy { ... }</code></li>\n<li><code>listOf(...)</code>, <code>setOf(...)</code>, <code>mapOf(...)</code></li>\n</ul>\n\n<p>So, one should definitely have strong reason to have a function mimic a constructor.</p>\n\n<p>Instead, a function's name might tell a user more (even everything) about its usage.</p>\n"}, {"comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 2, "creation_date": 1452705096, "post_id": 34766450, "comment_id": 57290755, "body": "I don&#39;t think we should pull in ideals of other languages as answers for &quot;what is best in Kotlin&quot;.  And internal code doesn&#39;t change that fact that it should follow best practices across the industry unless there is a good enough reason to differ."}, {"owner": {"reputation": 1254, "user_id": 3362350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e4500858d24434055bd01b57bdc734f?s=128&d=identicon&r=PG", "display_name": "Jacob Zimmerman", "link": "https://stackoverflow.com/users/3362350/jacob-zimmerman"}, "reply_to_user": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1452919137, "post_id": 34766450, "comment_id": 57389415, "body": "+Jayson Minard First, I want to point out that I mostly agree. Secondly, I think that naming conventions, pertaining to capitalisation, doesn&#39;t really count as a &quot;best practice&quot;. For example, C# and Java are almost the same language yet have different capitalization conventions. The reason for these conventions is purely about consistency for the sake of readability within a certain language community. So, I stick with what I said. If everyone who reads that code is okay with it, then there&#39;s nothing wrong with it. This is the same as any other convention mandated by a company style sheet."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1453054150, "post_id": 34766450, "comment_id": 57424272, "body": "This is a bit more than about capitalization."}, {"owner": {"reputation": 1254, "user_id": 3362350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e4500858d24434055bd01b57bdc734f?s=128&d=identicon&r=PG", "display_name": "Jacob Zimmerman", "link": "https://stackoverflow.com/users/3362350/jacob-zimmerman"}, "reply_to_user": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1453118724, "post_id": 34766450, "comment_id": 57448098, "body": "How so? That&#39;s all I see here."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 1, "creation_date": 1453118974, "post_id": 34766450, "comment_id": 57448244, "body": "The question is whether it is ok to make an extension function appear to be a constructor.  Other answers talk about details of naming conventions including capitalization, but that isn&#39;t the question."}, {"owner": {"reputation": 1254, "user_id": 3362350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e4500858d24434055bd01b57bdc734f?s=128&d=identicon&r=PG", "display_name": "Jacob Zimmerman", "link": "https://stackoverflow.com/users/3362350/jacob-zimmerman"}, "reply_to_user": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1453119281, "post_id": 34766450, "comment_id": 57448472, "body": "Okay, even on that note, I still stick with what I said, because it&#39;s implicitly tied in with the answer. Also, it&#39;s explicitly tied in with what I said about Python.  You claim that one shouldn&#39;t bring other languages&#39; conventions over, and I maintain that, as long as all users of the code agree, there&#39;s no reason not to. The only potential problem I see is the <i>compiler</i> ambiguity of it not knowing which HashSet to call."}], "tags": [], "owner": {"reputation": 1254, "user_id": 3362350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e4500858d24434055bd01b57bdc734f?s=128&d=identicon&r=PG", "display_name": "Jacob Zimmerman", "link": "https://stackoverflow.com/users/3362350/jacob-zimmerman"}, "is_accepted": false, "score": -2, "last_activity_date": 1452687261, "creation_date": 1452687261, "answer_id": 34766450, "question_id": 34751897, "link": "https://stackoverflow.com/questions/34751897/should-we-avoid-naming-a-function-same-as-an-existing-class-in-kotlin-why/34766450#34766450", "title": "Should we avoid naming a function same as an existing class in Kotlin? Why?", "body": "<p>I agree with +hotkey. It's probably best to avoid confusion in this case.</p>\n\n<p>If it's only used internally and all the other devs (if any) are okay with it, though, I'd say to go for it. Python acknowledges that idea and I love it. Heck, they go both ways, being okay with you naming a class in function case, too, if it feels more like it's acting like a function. But, Python doesn't have to deal with Java interop, so definitely don't do it for public code.</p>\n"}], "owner": {"reputation": 6030, "user_id": 11662, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cecb8a1f3d8a89ea8b7fb236b7b7d031?s=128&d=identicon&r=PG", "display_name": "Vilmantas Baranauskas", "link": "https://stackoverflow.com/users/11662/vilmantas-baranauskas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1050, "favorite_count": 1, "accepted_answer_id": 34752211, "answer_count": 2, "score": 8, "last_activity_date": 1515768457, "creation_date": 1452625803, "last_edit_date": 1515768260, "question_id": 34751897, "link": "https://stackoverflow.com/questions/34751897/should-we-avoid-naming-a-function-same-as-an-existing-class-in-kotlin-why", "title": "Should we avoid naming a function same as an existing class in Kotlin? Why?", "body": "<p>Kotlin allows to name a function same as an existing class, e.g. <code>HashSet</code> with initializer function could be implemented like this: </p>\n\n<pre><code>fun &lt;T&gt; HashSet(n : Int, fn: (Int) -&gt; T) = HashSet&lt;T&gt;(n).apply {\n    repeat(n) {\n        add(fn(it))\n    }\n}\n</code></pre>\n\n<p>When used, it looks like a normal <code>HashSet</code> constructor:</p>\n\n<pre><code>var real = HashSet&lt;String&gt;()\nvar fake = HashSet(5) { \"Element $it\" }\n</code></pre>\n\n<p>Should this be avoided or encouraged and why?</p>\n"}, {"tags": ["kotlin"], "comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1452612721, "post_id": 34738702, "comment_id": 57240975, "body": "It seems like you are asking an XY question (<a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">xyproblem.info</a>).  Would you rather ask how to do your function <code>readStars</code> in the most efficient manner?"}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1452613302, "post_id": 34738702, "comment_id": 57241381, "body": "I answered what your question appears to be (X) instead of <code>HashSet</code> (Y), see new answer below."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1452613659, "post_id": 34738702, "comment_id": 57241658, "body": "Did you try to create a <code>HashSet</code> yourself?  Like &quot;val mySet = HashSet&lt;Star&gt;(...)` ?  If so, you would already know how to create a <code>HashSet</code>.    You didn&#39;t show what you already tried in your question, so it is confusing because anyone can create a <code>HashSet</code> if they want.  Without Kotlin stdlib.  The stdlib would only add a helper function to make it more consistent with Kotlin style, but it doesn&#39;t add <code>HashSet</code> to available options."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 1, "creation_date": 1452614088, "post_id": 34738702, "comment_id": 57241984, "body": "Your <code>HashSet</code> question can be solved by yourself by reading <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/index.html\" rel=\"nofollow noreferrer\">kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/&hellip;</a>  and trying a few experiments with the constructors of <code>HashSet</code> ... it is not a good SO question.  The other &quot;how do I write this more efficient&quot; would not be down voted."}, {"owner": {"reputation": 6030, "user_id": 11662, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cecb8a1f3d8a89ea8b7fb236b7b7d031?s=128&d=identicon&r=PG", "display_name": "Vilmantas Baranauskas", "link": "https://stackoverflow.com/users/11662/vilmantas-baranauskas"}, "reply_to_user": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 1, "creation_date": 1452674420, "post_id": 34738702, "comment_id": 57268888, "body": "@JaysonMinard Thank you for putting so much energy into your answers and comments - they contain plenty of useful information. Maybe the what-is-the-best-way-to-read-stars question would have been a better one however I was really interested in a nice, compact and effective way to create a HashSet <i>with Kotlin</i> because I&#39;m learning it, not due to poor performance in the specific case. Just looking into kotlin/collections or constructors of HashSet, I couldn&#39;t have come up to the solution using &quot;apply()&quot; provided by KirillRakhman. I&#39;ll try my best to formulate better questions in the future."}], "answers": [{"comments": [{"owner": {"reputation": 6030, "user_id": 11662, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cecb8a1f3d8a89ea8b7fb236b7b7d031?s=128&d=identicon&r=PG", "display_name": "Vilmantas Baranauskas", "link": "https://stackoverflow.com/users/11662/vilmantas-baranauskas"}, "edited": false, "score": 0, "creation_date": 1452590760, "post_id": 34739302, "comment_id": 57225254, "body": "You can even name your function &quot;HashSet&quot; so it would look like a normal constructor of the HashSet. I wanted to know if there is something already present in the standard kotlin libs, or maybe some different approach altogether."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "reply_to_user": {"reputation": 6030, "user_id": 11662, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cecb8a1f3d8a89ea8b7fb236b7b7d031?s=128&d=identicon&r=PG", "display_name": "Vilmantas Baranauskas", "link": "https://stackoverflow.com/users/11662/vilmantas-baranauskas"}, "edited": false, "score": 1, "creation_date": 1452614236, "post_id": 34739302, "comment_id": 57242107, "body": "@VilmantasBaranauskas it isn&#39;t advised to try and hide a constructor with an extension function."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 1, "creation_date": 1452614314, "post_id": 34739302, "comment_id": 57242163, "body": "@miensol your code shouldn&#39;t assume that the initial capacity of the HashSet will be the same as the items loaded.  Most times they would not be for optimal performance.  Plus your implementation isn&#39;t useable from the <code>readStars</code> method (how would you integrate that without holding the values in something before, which is already the problem)"}, {"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "reply_to_user": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 1, "creation_date": 1452618485, "post_id": 34739302, "comment_id": 57245062, "body": "@JaysonMinard I&#39;ve only given answer to the following questions &quot;Is there a way to directly initialize a HashSet with the size of n and initializator function in Kotlin?&quot; and &quot;Is there an existing way in standard Kotlin libs?&quot;. It may be the XY question/problem though."}], "tags": [], "owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "is_accepted": false, "score": 5, "last_activity_date": 1452595913, "last_edit_date": 1452595913, "creation_date": 1452589342, "answer_id": 34739302, "question_id": 34738702, "link": "https://stackoverflow.com/questions/34738702/is-there-a-way-to-construct-a-hashset-with-initializator-function-in-kotlin/34739302#34739302", "title": "Is there a way to construct a HashSet with initializator function in Kotlin?", "body": "<p>Since <a href=\"https://docs.oracle.com/javase/7/docs/api/java/util/HashSet.html\" rel=\"noreferrer\"><code>HashSet</code></a> is a java class so you can only initialize it in a way provided by JDK. </p>\n\n<p>While there's <strong>no helper method in Kotlin runtime</strong> it's easy to write it yourself like so:</p>\n\n<pre><code>public fun &lt;T&gt; hashSetOf(size: Int, initializer: (Int) -&gt; T): HashSet&lt;T&gt; {\n    val result = HashSet&lt;T&gt;(size)\n    0.rangeTo(size - 1).forEach {\n        result.add(initializer(it))\n    }\n    return result\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "is_accepted": false, "score": 7, "last_activity_date": 1452696742, "last_edit_date": 1452696742, "creation_date": 1452590725, "answer_id": 34739758, "question_id": 34738702, "link": "https://stackoverflow.com/questions/34738702/is-there-a-way-to-construct-a-hashset-with-initializator-function-in-kotlin/34739758#34739758", "title": "Is there a way to construct a HashSet with initializator function in Kotlin?", "body": "<p>You can always use <code>apply</code> to initialize objects in-place:</p>\n\n<pre><code>HashSet&lt;Star&gt;(n).apply {\n    repeat(n) {\n        val (l1, l2) = readLine()!!.split(' ').map { it.toInt() }\n        put(Star(l1, l2))\n    }\n}\n</code></pre>\n\n<p>If that's too inconvenient too type every time, write an extension function:</p>\n\n<pre><code>inline fun &lt;T&gt; createHashSet(n : Int, crossinline fn: (Int) -&gt; T) = HashSet&lt;T&gt;(n).apply {\n    repeat(n) { add(fn(it)) }\n}\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>createHashSet&lt;Star&gt;(n) {\n    val (l1, l2) = readLine()!!.split(' ').map { it.toInt() }\n    Star(l1, l2)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 1, "creation_date": 1452614471, "post_id": 34746632, "comment_id": 57242281, "body": "Good answer.  Your <code>splitToSequence()</code> that then does <code>take(2)</code> and does <code>toList()</code> doesn&#39;t really save anything in the end.  Results in the same work and requires allocation of a Sequence, Iterator for the Sequence, a Take class from the Sequence, and then a List.  So that is more allocations in the end.  The version that uses an iterator is better, but then it allocates a class as the Iterator so doesn&#39;t necessarily save anything again.   You just change what is allocated, and maybe create more."}, {"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "reply_to_user": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1452615108, "post_id": 34746632, "comment_id": 57242759, "body": "@JaysonMinard You may be right. I haven&#39;t compared the overhead between a Kotlin Sequence and Lists but from what I can tell in the first solution <code>split</code> creates a list and then <code>map</code> creates another list. In the second solution <code>splitToSequence</code> creates a lazily evaluated <code>iterator</code> and then a list (so <i>if</i> a sequence has less overhead then a list then this is a win). In the <code>iterator</code> solutions no list is ever made (so again <i>if</i> a sequence has less overhead then a list then this is another win). I suppose for small lists you are absolutely right: use a list. I will update. Thank you."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 1, "creation_date": 1452615466, "post_id": 34746632, "comment_id": 57242989, "body": "The CPU cache will make the copy of the lists very cheap.  Lazy is not always cheaper for small things.   <code>split(char)</code> makes a sequence, allocates an anonymous <code>Iterable</code> which is then <code>map</code> into a <code>List</code>.  <code>splitToSequence(char)</code> makes a sequence, and then when you <code>map</code> tacks an instance of <code>TransformingSequence</code> which then creates anonymous instance of <code>Iterator</code> which is then <code>toList</code>.  So you do everything the other version does +1 other allocation.  And really, small things are better as copied, really large things maybe not.  Depends on how close in time the copy is, the CPU cache,..."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 2, "creation_date": 1452615549, "post_id": 34746632, "comment_id": 57243057, "body": "So Sequence mislead you into a less performant option.  There is a reason Kotlin defaults to making copies of collections a lot, because most cases it does not matter and performs as well or better than lazy eval.  You should assume copy is fine until you have indication it isn&#39;t.  Like size vs. memory, slowness shown to be in the copying, etc."}, {"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "reply_to_user": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1452615892, "post_id": 34746632, "comment_id": 57243317, "body": "@JaysonMinard Yep. That makes sense. Thanks. FYI: <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/split.html\" rel=\"nofollow noreferrer\"><code>split</code></a> returns <code>List&lt;String&gt;</code> not <code>Sequence&lt;String&gt;</code>."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1452615957, "post_id": 34746632, "comment_id": 57243345, "body": "I didn&#39;t say <code>split</code> returns a <code>Sequence</code>, internally the code within <code>split</code> makes a <code>Sequence</code> which ...(the rest of my paragraph)"}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1452616001, "post_id": 34746632, "comment_id": 57243370, "body": "(and really in the scheme of this code, assuming he isn&#39;t reading a billion stars from the file, not sure this level of optimization even matters)"}], "tags": [], "owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "is_accepted": false, "score": 1, "last_activity_date": 1452690795, "last_edit_date": 1452690795, "creation_date": 1452609829, "answer_id": 34746632, "question_id": 34738702, "link": "https://stackoverflow.com/questions/34738702/is-there-a-way-to-construct-a-hashset-with-initializator-function-in-kotlin/34746632#34746632", "title": "Is there a way to construct a HashSet with initializator function in Kotlin?", "body": "<p>As @miensol has pointed out <a href=\"https://docs.oracle.com/javase/7/docs/api/java/util/HashSet.html\" rel=\"nofollow\"><code>HashSet</code></a> initialization is limited to the constructors made available by the JDK. Kotlin has added a <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/hash-set-of.html\" rel=\"nofollow\"><code>hashSetOf</code></a> function which initializes an empty <code>HashSet</code> and then adds the specified elements to it.</p>\n\n<p>To avoid first reading the values into an array you can use a <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-sequence/\" rel=\"nofollow\"><code>kotlin.Sequence</code></a> who's \"values are evaluated lazily\":</p>\n\n\n\n<pre class=\"lang-kotlin prettyprint-override\"><code>fun BufferedReader.readStars(n: Int): Set&lt;Star&gt; {\n    return lineSequence().take(n).map {\n        val (l1, l2) = it.split(\" \").map { it.toInt() }\n        Star(l1, l2)\n    }.toHashSet()\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 2, "creation_date": 1452680411, "post_id": 34747871, "comment_id": 57273041, "body": "these two last charapters a kind of uncalled for. I suggest changing them into a link to the docs and a smily"}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "reply_to_user": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1452696840, "post_id": 34747871, "comment_id": 57284350, "body": "I deleted the last HashSet part because I already down voted the question asking how to create a HashSet which is a bad question for SO.  No need to repeat it here in the answer."}, {"owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "edited": false, "score": 0, "creation_date": 1452699912, "post_id": 34747871, "comment_id": 57286739, "body": "&quot;A call to substring does not copy the internal array, but shares it and is very efficient.&quot; \u2014 It isn&#39;t so anymore starting from Java 7"}], "tags": [], "owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "is_accepted": false, "score": 1, "last_activity_date": 1452700585, "last_edit_date": 1452700585, "creation_date": 1452613286, "answer_id": 34747871, "question_id": 34738702, "link": "https://stackoverflow.com/questions/34738702/is-there-a-way-to-construct-a-hashset-with-initializator-function-in-kotlin/34747871#34747871", "title": "Is there a way to construct a HashSet with initializator function in Kotlin?", "body": "<p>It seems like you are asking an XY question (<a href=\"http://xyproblem.info/\" rel=\"nofollow\">http://xyproblem.info/</a>).  You really want to know how to write <code>readStars</code> in the most efficient way, but instead you ask about <code>HashSet</code>.  I think @mfulton26 answers your question as well depending on what is being asked.</p>\n\n<p><strong>Here is the answer for \"how do I write this in the most efficient way:\"</strong></p>\n\n<p>You have two options.  First, a version that auto-closes the stream at the end:</p>\n\n\n\n<pre><code>fun BufferedReader.readStars(n: Int): Set&lt;Star&gt; {\n    return use {\n        lineSequence().map { line -&gt;\n            val idx = line.indexOf(' ')\n            Star(line.substring(0, idx).toInt(), line.substring(idx + 1).toInt())\n        }.toSet()\n    }\n}\n</code></pre>\n\n<p>And second, a version that does not:</p>\n\n<pre><code>fun BufferedReader.readStars(n: Int): Set&lt;Star&gt; {\n    return lineSequence().map { line -&gt;\n            val idx = line.indexOf(' ')\n            Star(line.substring(0, idx).toInt(), line.substring(idx+1).toInt())\n        }.toSet()\n}\n</code></pre>\n\n<p>Neither version creates an array, neither do they make copies of data.  They stream the data through a sequence which creates the Set and fills it directly.</p>\n\n<p><strong>Other notes</strong></p>\n\n<p>No need to use split if you are really concerned about allocations and performance.  Just use <code>indexOf(char)</code> and split the string yourself using <code>substring</code>. </p>\n\n<p>If you do a split, then please use <code>split(char)</code> not <code>split(String)</code> when you are looking to split on a <code>char</code></p>\n"}], "owner": {"reputation": 6030, "user_id": 11662, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cecb8a1f3d8a89ea8b7fb236b7b7d031?s=128&d=identicon&r=PG", "display_name": "Vilmantas Baranauskas", "link": "https://stackoverflow.com/users/11662/vilmantas-baranauskas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1203, "favorite_count": 1, "answer_count": 4, "score": 5, "last_activity_date": 1452700585, "creation_date": 1452587151, "last_edit_date": 1452592697, "question_id": 34738702, "link": "https://stackoverflow.com/questions/34738702/is-there-a-way-to-construct-a-hashset-with-initializator-function-in-kotlin", "title": "Is there a way to construct a HashSet with initializator function in Kotlin?", "body": "<p>To read Stars from a file in the <a href=\"https://www.facebook.com/hackercup/problem/910374079035613/\" rel=\"noreferrer\">Facebook Hacker Cup's 2016</a> Boomerang Constelations problem, following extension function can be defined:</p>\n\n<pre><code>fun BufferedReader.readStars(n: Int): Set&lt;Star&gt; {\n    return Array(n) {\n        val (l1, l2) = readLine().split(\" \").map { it.toInt() }\n        Star(l1, l2)\n    }.toHashSet()\n}\n</code></pre>\n\n<p>Code is compact but the values are first read into an array and then converted to a <code>HashSet</code>. Is there a way to directly initialize a <code>HashSet</code> with the size of <code>n</code> and initializator function in Kotlin?</p>\n\n<p><strong>UPDATE:</strong> Is there an <strong>existing</strong> way in standard Kotlin libs?</p>\n"}, {"tags": ["coding-style", "kotlin"], "comments": [{"owner": {"reputation": 338, "user_id": 1453345, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/48cba601d02383b98c71c6c1e24e86a8?s=128&d=identicon&r=PG", "display_name": "user1453345", "link": "https://stackoverflow.com/users/1453345/user1453345"}, "edited": false, "score": 0, "creation_date": 1452567947, "post_id": 34725155, "comment_id": 57216072, "body": "Can we use lateinit like: lateinit val broadcastAddresses: List&lt;InetAddress&gt;?"}], "answers": [{"tags": [], "owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "is_accepted": true, "score": 7, "last_activity_date": 1452528912, "last_edit_date": 1452528912, "creation_date": 1452528532, "answer_id": 34726075, "question_id": 34725155, "link": "https://stackoverflow.com/questions/34725155/cannot-call-a-function-from-init-block-because-of-val-property/34726075#34726075", "title": "Cannot call a function from init block because of val property", "body": "<p>One way of approaching the problem is to use <a href=\"https://en.wikipedia.org/wiki/Pure_function\">pure functions</a> to initialize fields:</p>\n\n<pre><code>class Operation {\n    val socket = DatagramSocket().apply { broadcast = true }\n    val data: ByteArray = \"Cassiopeiae server discovery packet\".toByteArray()\n    val broadcastAddresses = collectBroadcastAddresses(collectValidNetworkInterfaces()) \n\n    private fun collectValidNetworkInterfaces() =\n        NetworkInterface.getNetworkInterfaces().toList()\n            .filter { validInterface(it) }\n            .flatMap { nInterface -&gt; nInterface.interfaceAddresses }\n\n    private fun validInterface(it: NetworkInterface?) = true\n\n    private fun collectBroadcastAddresses(interfaceAddresses: List&lt;InterfaceAddress&gt;) {\n        interfaceAddresses\n            .filter { address -&gt; address.broadcast != null }\n            .map { it.broadcast }\n    }\n}\n</code></pre>\n\n<p>Notice how the <code>socket</code> field initialization uses <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/apply.html\"><code>apply</code></a> extension. </p>\n\n<p>I often find it useful to extract collection manipulation routines into extension methods:</p>\n\n<pre><code>class Operation {\n    val socket = DatagramSocket().apply { broadcast = true }\n    val data: ByteArray = \"Cassiopeiae server discovery packet\".toByteArray()\n    val broadcastAddresses = NetworkInterface.getNetworkInterfaces()\n        .collectValidNetworkInterfaces { validInterface(it) }\n        .collectBroadcastAddresses()\n\n    private fun validInterface(it: NetworkInterface?) = true\n}\n\nfun Iterable&lt;InterfaceAddress&gt;.collectBroadcastAddresses(): List&lt;InetAddress&gt; =\n    filter { address -&gt; address.broadcast != null }.map { it.broadcast }\n\nfun Enumeration&lt;NetworkInterface&gt;.collectValidNetworkInterfaces(isValid: (NetworkInterface) -&gt; Boolean = { true }) =\n    toList()\n        .filter { isValid(it) }\n        .flatMap { nInterface -&gt; nInterface.interfaceAddresses }\n</code></pre>\n"}], "owner": {"reputation": 2560, "user_id": 3757113, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000391669542/picture?type=large", "display_name": "LordScone", "link": "https://stackoverflow.com/users/3757113/lordscone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 34726075, "answer_count": 1, "score": 3, "last_activity_date": 1452528912, "creation_date": 1452525999, "question_id": 34725155, "link": "https://stackoverflow.com/questions/34725155/cannot-call-a-function-from-init-block-because-of-val-property", "title": "Cannot call a function from init block because of val property", "body": "<p>I'd like to initialize my class's properties.\nBecause I'm using heavily the functional elements of Kotlin, I'd like to put these initializations to well named functions, to increase readability of my code.\nThe problem is that I cannot assign a val property, if the code is not in the init block, but in function which is called from the init block.</p>\n\n<p>Is it possible to take apart initialization of a class, to different functions, if the properties are vals?</p>\n\n<p>Here is the code:</p>\n\n<pre><code>    val socket: DatagramSocket = DatagramSocket()\n    val data: ByteArray = \"Cassiopeiae server discovery packet\".toByteArray()\n    val broadcastAddresses: List&lt;InetAddress&gt;\n\n    init {\n        socket.broadcast = true\n        val interfaceAddresses = ArrayList&lt;InterfaceAddress&gt;()\n        collectValidNetworkInterfaces(interfaceAddresses)\n        collectBroadcastAddresses(interfaceAddresses)\n    }\n\n    private fun collectValidNetworkInterfaces(interfaceAddresses: ArrayList&lt;InterfaceAddress&gt;) {\n        NetworkInterface.getNetworkInterfaces().toList()\n                .filter { validInterface(it) }\n                .forEach { nInterface -&gt; nInterface.interfaceAddresses.toCollection(interfaceAddresses) }\n    }\n\n    private fun collectBroadcastAddresses(interfaceAddresses: ArrayList&lt;InterfaceAddress&gt;) {\n        broadcastAddresses = interfaceAddresses\n                .filter { address -&gt; address.broadcast != null }\n                .map { it.broadcast }\n    }\n</code></pre>\n\n<p>Of course it's not compiling, because <em>collectBroadcastAddresses</em> function tries to reassign the <em>broadcastAddresses</em> val. Although I don't want to put the code of this function to the init block, because it's not obvious what the code is doing, and the function name tells it very nicely. </p>\n\n<p>What can I do in such cases? I'd like to keep my code clean, this is the most important point!</p>\n"}, {"tags": ["json", "jackson", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 1, "creation_date": 1452513616, "post_id": 34717277, "comment_id": 57187631, "body": "This code isn&#39;t correct.  It only works because your data type is an Array.  Using <code>::class.java</code> is wrong ALWAYS when generics are involved."}, {"owner": {"reputation": 11834, "user_id": 1538877, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/N9qfZ.jpg?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/1538877/ruslan"}, "reply_to_user": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1452514106, "post_id": 34717277, "comment_id": 57187955, "body": "Thank you, @JaysonMinard i found extension function that i doesn&#39;t noticed before."}, {"owner": {"reputation": 2516, "user_id": 683482, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/lBysC.jpg?s=128&g=1", "display_name": "Raju yourPepe", "link": "https://stackoverflow.com/users/683482/raju-yourpepe"}, "edited": false, "score": 0, "creation_date": 1532695898, "post_id": 34717277, "comment_id": 90083519, "body": "if my json contains the field object, how should i customise ?"}, {"owner": {"reputation": 11834, "user_id": 1538877, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/N9qfZ.jpg?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/1538877/ruslan"}, "edited": false, "score": 0, "creation_date": 1532851544, "post_id": 34717277, "comment_id": 90122135, "body": "What do you mean by &quot;field object&quot;, and what you like to customize?"}, {"owner": {"reputation": 602, "user_id": 4711172, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LxBQY.jpg?s=128&g=1", "display_name": "Itai Spector", "link": "https://stackoverflow.com/users/4711172/itai-spector"}, "edited": false, "score": 0, "creation_date": 1544729911, "post_id": 34717277, "comment_id": 94389678, "body": "@IRus this is the magic code &#39;registerKotlinModule()&#39;"}, {"owner": {"reputation": 11834, "user_id": 1538877, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/N9qfZ.jpg?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/1538877/ruslan"}, "reply_to_user": {"reputation": 602, "user_id": 4711172, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LxBQY.jpg?s=128&g=1", "display_name": "Itai Spector", "link": "https://stackoverflow.com/users/4711172/itai-spector"}, "edited": false, "score": 0, "creation_date": 1544866819, "post_id": 34717277, "comment_id": 94433425, "body": "@ItaiSpector No, this is simple extension function"}, {"owner": {"reputation": 602, "user_id": 4711172, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LxBQY.jpg?s=128&g=1", "display_name": "Itai Spector", "link": "https://stackoverflow.com/users/4711172/itai-spector"}, "edited": false, "score": 0, "creation_date": 1544957194, "post_id": 34717277, "comment_id": 94451582, "body": "@IRus That simple extension made it work, cheers"}], "tags": [], "owner": {"reputation": 11834, "user_id": 1538877, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/N9qfZ.jpg?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/1538877/ruslan"}, "is_accepted": false, "score": 6, "last_activity_date": 1452514339, "last_edit_date": 1452514339, "creation_date": 1452502016, "answer_id": 34717277, "question_id": 34716697, "link": "https://stackoverflow.com/questions/34716697/how-do-i-deserialize-json-into-a-listsometype-with-kotlin-jackson/34717277#34717277", "title": "How do I deserialize JSON into a List&lt;SomeType&gt; with Kotlin + Jackson", "body": "<p>Following code works well for me:</p>\n\n<pre><code>import com.fasterxml.jackson.databind.ObjectMapper\nimport com.fasterxml.jackson.module.kotlin.readValue\nimport com.fasterxml.jackson.module.kotlin.registerKotlinModule\n\n\n\nval json = \"\"\"[ {\n  \"id\" : \"1\",\n  \"name\" : \"Blues\"\n}, {\n  \"id\" : \"0\",\n  \"name\" : \"Rock\"\n} ]\"\"\"\n\ndata class GenreDTO(val id: Int, val name: String)\n\nval mapper = ObjectMapper().registerKotlinModule()\n\nfun main(args: Array&lt;String&gt;) {\n    val obj: List&lt;GenreDTO&gt; = mapper.readValue(json)\n    obj.forEach {\n        println(it)\n    }\n}\n</code></pre>\n\n<p>This work because of extension function defined inside jackson-kotlin-module (that used <a href=\"https://kotlinlang.org/docs/reference/inline-functions.html#reified-type-parameters\" rel=\"noreferrer\">reified</a> generics):</p>\n\n<pre><code> public inline fun &lt;reified T: Any&gt; ObjectMapper.readValue(content: String): T = readValue(content, object: TypeReference&lt;T&gt;() {})\n</code></pre>\n\n<p>Thanks @JaysonMinard for notify me about it.</p>\n\n<p>Output:</p>\n\n<pre><code>GenreDTO(id=1, name=Blues)\nGenreDTO(id=0, name=Rock)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1452513798, "post_id": 34717305, "comment_id": 57187757, "body": "Since he should be using the Jackson Kotlin module, this should be simplified as described in the documentation for that module (<a href=\"https://github.com/FasterXML/jackson-module-kotlin\" rel=\"nofollow noreferrer\">github.com/FasterXML/jackson-module-kotlin</a>) .  There is a simple sample there for doing just this."}], "tags": [], "owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "is_accepted": false, "score": 12, "last_activity_date": 1452526074, "last_edit_date": 1452526074, "creation_date": 1452502139, "answer_id": 34717305, "question_id": 34716697, "link": "https://stackoverflow.com/questions/34716697/how-do-i-deserialize-json-into-a-listsometype-with-kotlin-jackson/34717305#34717305", "title": "How do I deserialize JSON into a List&lt;SomeType&gt; with Kotlin + Jackson", "body": "<p>The error you're getting is about following expression:</p>\n\n<pre><code>List&lt;GenreDTO&gt;::class.java\n</code></pre>\n\n<p>Because of how jvm treats generics there's no separate class for <code>List&lt;GenreDTO&gt;</code> thus compiler complains. Similarly in Java the following will not compile:</p>\n\n<pre><code>List&lt;GenreDTO&gt;.getClass()\n</code></pre>\n\n<p>Here's a sample that will deserialize the list properly:</p>\n\n<pre><code>val value:List&lt;GenreDTO&gt; = mapper.readValue(json, object : TypeReference&lt;List&lt;GenreDTO&gt;&gt;() {})\n</code></pre>\n\n<p>As @JaysonMinard has pointed out you can use <a href=\"http://github.com/FasterXML/jackson-module-kotlin\" rel=\"noreferrer\">jackson-module-kotlin</a> to simplify the invocation to:</p>\n\n<pre><code>val genres: List&lt;GenreDTO&gt; = mapper.readValue(json)\n// or\nval genres = mapper.readValue&lt;List&lt;GenreDTO&gt;&gt;(json)\n</code></pre>\n\n<p>This is possible because of <a href=\"https://kotlinlang.org/docs/reference/inline-functions.html#reified-type-parameters\" rel=\"noreferrer\"><code>reified type parameters</code></a>. Consider looking at <a href=\"https://github.com/FasterXML/jackson-module-kotlin/blob/master/src/main/kotlin/com/fasterxml/jackson/module/kotlin/Extensions.kt\" rel=\"noreferrer\"><code>Extensions</code></a> to find out details.</p>\n"}, {"comments": [{"owner": {"reputation": 26657, "user_id": 404201, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fd9932a584c0d67b5e017cc49305ccb7?s=128&d=identicon&r=PG", "display_name": "Jasper Blues", "link": "https://stackoverflow.com/users/404201/jasper-blues"}, "edited": false, "score": 1, "creation_date": 1452571463, "post_id": 34720988, "comment_id": 57216954, "body": "I was using the Kotlin module for Jackson, and had tried something like this, but forgot the imports."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "reply_to_user": {"reputation": 26657, "user_id": 404201, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fd9932a584c0d67b5e017cc49305ccb7?s=128&d=identicon&r=PG", "display_name": "Jasper Blues", "link": "https://stackoverflow.com/users/404201/jasper-blues"}, "edited": false, "score": 1, "creation_date": 1452606867, "post_id": 34720988, "comment_id": 57236518, "body": "I am hoping that <a href=\"https://youtrack.jetbrains.com/issue/KT-9238\" rel=\"nofollow noreferrer\">youtrack.jetbrains.com/issue/KT-9238</a> will allow a library to kinda tell the IDE what imports are important for it."}, {"owner": {"reputation": 887, "user_id": 4428658, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/596cf8b62050334aa029d06d0d8948df?s=128&d=identicon&r=PG&f=1", "display_name": "UncleBob", "link": "https://stackoverflow.com/users/4428658/unclebob"}, "edited": false, "score": 0, "creation_date": 1604508957, "post_id": 34720988, "comment_id": 114370350, "body": "I just realised that this does not work with generics. mapper.readValue&lt;List&lt;T&gt;&gt;(json) will result in a list of hashmaps. I get why, but I seem to be unable to find a workaround..."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "reply_to_user": {"reputation": 887, "user_id": 4428658, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/596cf8b62050334aa029d06d0d8948df?s=128&d=identicon&r=PG&f=1", "display_name": "UncleBob", "link": "https://stackoverflow.com/users/4428658/unclebob"}, "edited": false, "score": 0, "creation_date": 1605768376, "post_id": 34720988, "comment_id": 114754301, "body": "@UncleBob it is a limitation of reified generics.  Is <code>&lt;T&gt;</code> from a local class, or function, and how is that declared?  you have a special case here, and is maybe worthwhile to post a new question specific to using a generic parameter of a nested scope within your call to the function."}], "tags": [], "owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "is_accepted": true, "score": 39, "last_activity_date": 1452514210, "last_edit_date": 1452514210, "creation_date": 1452513382, "answer_id": 34720988, "question_id": 34716697, "link": "https://stackoverflow.com/questions/34716697/how-do-i-deserialize-json-into-a-listsometype-with-kotlin-jackson/34720988#34720988", "title": "How do I deserialize JSON into a List&lt;SomeType&gt; with Kotlin + Jackson", "body": "<p><strong><em>NOTE:</em></strong> <em>The answer from @IRus is also correct, it was being modified at the same time I wrote this to fill in more details.</em></p>\n\n<p>You should use the <a href=\"https://github.com/FasterXML/jackson-module-kotlin\">Jackson + Kotlin module</a> or you will have other problems deserializing into Kotlin objects when you do no have a default constructor.</p>\n\n<p>Your first sample of the code:</p>\n\n<pre><code>val dtos  = mapper.readValue(json, List::class.java)\n</code></pre>\n\n<p>Is returning an inferred type of <code>List&lt;*&gt;</code> since you did not specify more type information, and it is actually a <code>List&lt;Map&lt;String,Any&gt;&gt;</code> which is not really \"working OK\" but is not producing any errors.  It is unsafe, not typed.</p>\n\n<p>The second code should be:</p>\n\n<pre><code>import com.fasterxml.jackson.module.kotlin.jacksonObjectMapper\nimport com.fasterxml.jackson.module.kotlin.readValue\n\nval mapper = jacksonObjectMapper()\n// ...\nval genres: List&lt;GenreDTO&gt; = mapper.readValue(json)\n</code></pre>\n\n<p>You do not need anything else on the right side of the assignment, the Kotlin module for Jackson will reify the generics and create the <code>TypeReference</code> for Jackson internally.  Notice the <code>readValue</code> import, you need that or <code>.*</code> for the <code>com.fasterxml.jackson.module.kotlin</code> package to have the extension functions that do all of the magic.</p>\n\n<p>A slightly different alternative that also works:</p>\n\n<pre><code>val genres = mapper.readValue&lt;List&lt;GenreDTO&gt;&gt;(json)\n</code></pre>\n\n<p>There is no reason to NOT use the extension functions and the add-on module for Jackson.  It is small and solves other issues that would require you to jump through hoops to make a default constructor, or use a bunch of annotations.  With the module, your class can be normal Kotlin (optional to be <code>data</code> class):</p>\n\n<pre><code>class GenreDTO(val id: Int, val name: String)\n</code></pre>\n"}], "owner": {"reputation": 26657, "user_id": 404201, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fd9932a584c0d67b5e017cc49305ccb7?s=128&d=identicon&r=PG", "display_name": "Jasper Blues", "link": "https://stackoverflow.com/users/404201/jasper-blues"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29766, "favorite_count": 1, "closed_date": 1452558146, "accepted_answer_id": 34720988, "answer_count": 3, "score": 26, "last_activity_date": 1452526074, "creation_date": 1452499688, "last_edit_date": 1452512779, "question_id": 34716697, "link": "https://stackoverflow.com/questions/34716697/how-do-i-deserialize-json-into-a-listsometype-with-kotlin-jackson", "closed_reason": "Duplicate", "title": "How do I deserialize JSON into a List&lt;SomeType&gt; with Kotlin + Jackson", "body": "<p>What is the correct syntax to deserialize the following JSON: </p>\n\n<pre><code>[ {\n  \"id\" : \"1\",\n  \"name\" : \"Blues\"\n}, {\n  \"id\" : \"0\",\n  \"name\" : \"Rock\"\n} ]\n</code></pre>\n\n<p>I tried: </p>\n\n<pre><code>//Works OK\nval dtos  = mapper.readValue(json, List::class.java)\n</code></pre>\n\n<p>However I want: </p>\n\n<pre><code>val dtos : List&lt;GenreDTO&gt;  = mapper.readValue(json, \n    List&lt;GenreDTO&gt;::class.java)\n</code></pre>\n\n<p>The above syntax is not correct and gives: <code>only classes are allowed on the left hand side of a class literal</code></p>\n"}, {"tags": ["kotlin"], "comments": [{"owner": {"reputation": 1254, "user_id": 3362350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e4500858d24434055bd01b57bdc734f?s=128&d=identicon&r=PG", "display_name": "Jacob Zimmerman", "link": "https://stackoverflow.com/users/3362350/jacob-zimmerman"}, "edited": false, "score": 0, "creation_date": 1452453335, "post_id": 34703867, "comment_id": 57165524, "body": "After that, maybe see if you can turn the loop into a tail recursive function, which can be optimized with Kotlin&#39;s tailrec &quot;annotation&quot;."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 3, "creation_date": 1452514668, "post_id": 34703867, "comment_id": 57188348, "body": "(Note:  This is not a duplicate of the other.  The other is about functional loops, this is about non-functional loops.  I flagged for moderator intervention to &quot;un-mark this as a dupe, because it is not&quot;)"}], "answers": [{"tags": [], "owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "is_accepted": false, "score": 7, "last_activity_date": 1452460196, "last_edit_date": 1452460196, "creation_date": 1452420516, "answer_id": 34704212, "question_id": 34703867, "link": "https://stackoverflow.com/questions/34703867/how-to-continue-or-break-in-a-when-statement-inside-a-while-loop-using-k/34704212#34704212", "title": "How to `continue` or `break` in a `when` statement inside a `while` loop using Kotlin", "body": "<p>You can use <a href=\"https://kotlinlang.org/docs/reference/returns.html#break-and-continue-labels\" rel=\"noreferrer\">labels</a> to continue/break the loop i.e:</p>\n\n<pre><code>myLoop@ while (!mStopped &amp;&amp; c.hasNext()) {\n\n    val itemType = c.next()\n    when (itemType) {\n        1, 2 -&gt; {\n            doSomething()\n            if (condition())\n                continue@myLoop\n            doSomethingElse()\n        }\n    }\n    doTheLastStuff()\n}\n</code></pre>\n\n<p>Here's is a relevant excerpt from documentation:</p>\n\n<blockquote>\n  <p>Any expression in Kotlin may be marked with a label. Labels have the\n  form of an identifier followed by the @ sign, for example: abc@,\n  fooBar@ are valid labels(...)\n  A break qualified with a label jumps to the execution point right\n  after the loop marked with that label. A continue proceeds to the next\n  iteration of that loop.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "is_accepted": false, "score": 6, "last_activity_date": 1452445852, "last_edit_date": 1452445852, "creation_date": 1452429269, "answer_id": 34705401, "question_id": 34703867, "link": "https://stackoverflow.com/questions/34703867/how-to-continue-or-break-in-a-when-statement-inside-a-while-loop-using-k/34705401#34705401", "title": "How to `continue` or `break` in a `when` statement inside a `while` loop using Kotlin", "body": "<p>The issue here is that <code>break</code> and <code>continue</code> have a special meaning inside a <code>when</code> statement, namely breaking and continuing the <code>when</code> itself, not the surrounding loop. For now (kotlin 1.0) the syntax is not decided yet, so the feature does not work, despite the keywords being reserved.</p>\n\n<p>To solve this, use labels <a href=\"https://kotlinlang.org/docs/reference/returns.html#break-and-continue-labels\" rel=\"noreferrer\">https://kotlinlang.org/docs/reference/returns.html#break-and-continue-labels</a>:</p>\n\n<pre><code>loop@ while (...) {\n    when (itemType) {\n        1 -&gt; continue@loop\n        else -&gt; break@loop\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 242, "user_id": 119006, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4f45311c7b913bb4ee3719dbd216a153?s=128&d=identicon&r=PG", "display_name": "Brian Donovan-Smith", "link": "https://stackoverflow.com/users/119006/brian-donovan-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2582, "favorite_count": 0, "closed_date": 1452504697, "answer_count": 2, "score": 7, "last_activity_date": 1452460196, "creation_date": 1452417745, "question_id": 34703867, "link": "https://stackoverflow.com/questions/34703867/how-to-continue-or-break-in-a-when-statement-inside-a-while-loop-using-k", "closed_reason": "Duplicate", "title": "How to `continue` or `break` in a `when` statement inside a `while` loop using Kotlin", "body": "<p>I am converting a large project to Kotlin. There have been numerous challenges.  Me learning the new patterns of Kotlin is one of them.  Hopefully there is a pattern I can use to resolve this one.</p>\n\n<p>Here is the code I am attempting to achieve.  But, <code>continue</code> and <code>break</code> are not valid in a <code>when</code> statement.</p>\n\n<pre><code>while (!mStopped &amp;&amp; c.moveToNext()) {\n\n    val itemType = c.getInt()\n    when (itemType) {\n        1, 2 -&gt; {\n            doSomething()\n            if (condition)\n                continue\n            doSomethingElse()\n        }\n    }\n    doTheLastStuff()\n}\n</code></pre>\n\n<p>This is a very cut-down version of the code.  The original java code had 100's of lines inside the switch statements, and lots of <code>continue</code>'s and <code>break</code>'s.</p>\n\n<p>What I am trying to achieve is to continue execution back at the <code>while</code> statement.  What is the pattern for doing this in Kotlin</p>\n"}, {"tags": ["android", "parcelable", "kotlin"], "comments": [{"owner": {"reputation": 2470, "user_id": 3482621, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kYbYc.png?s=128&g=1", "display_name": "albert c braun", "link": "https://stackoverflow.com/users/3482621/albert-c-braun"}, "edited": false, "score": 0, "creation_date": 1512510049, "post_id": 34703680, "comment_id": 82285408, "body": "Also see <a href=\"https://stackoverflow.com/questions/33551972/is-there-a-convenient-way-to-create-parcelable-data-classes-in-android-with-kotl\" title=\"is there a convenient way to create parcelable data classes in android with kotl\">stackoverflow.com/questions/33551972/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 6830, "user_id": 1332872, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/M03y5.jpg?s=128&g=1", "display_name": "ssuukk", "link": "https://stackoverflow.com/users/1332872/ssuukk"}, "edited": false, "score": 0, "creation_date": 1452421671, "post_id": 34703906, "comment_id": 57154478, "body": "Thanx, I will check it later. One question though - why does Kotlin require type specification where Java doesn&#39;t?"}, {"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "reply_to_user": {"reputation": 6830, "user_id": 1332872, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/M03y5.jpg?s=128&g=1", "display_name": "ssuukk", "link": "https://stackoverflow.com/users/1332872/ssuukk"}, "edited": false, "score": 0, "creation_date": 1452422692, "post_id": 34703906, "comment_id": 57154726, "body": "@ssuukk Not sure what you mean. Kotlin uses <a href=\"https://kotlinlang.org/docs/reference/generics.html#declaration-site-variance\" rel=\"nofollow noreferrer\">declaration-site variance</a> as opposed to use-site variance."}, {"owner": {"reputation": 531, "user_id": 1105073, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/443e075f186efa23776d64303005cb8f?s=128&d=identicon&r=PG", "display_name": "Eggman87", "link": "https://stackoverflow.com/users/1105073/eggman87"}, "edited": false, "score": 0, "creation_date": 1454820921, "post_id": 34703906, "comment_id": 58213182, "body": "@miensol do you think this still works? I end up with a exception:  Parcelable protocol requires a Parcelable.Creator object called CREATOR when trying to read from a bundle."}, {"owner": {"reputation": 531, "user_id": 1105073, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/443e075f186efa23776d64303005cb8f?s=128&d=identicon&r=PG", "display_name": "Eggman87", "link": "https://stackoverflow.com/users/1105073/eggman87"}, "edited": false, "score": 1, "creation_date": 1454871499, "post_id": 34703906, "comment_id": 58227683, "body": "@miensol thanks! Ended up asking a question and getting it answered here. Worth noting you only need the JvmField annotation for the CREATOR."}, {"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "reply_to_user": {"reputation": 531, "user_id": 1105073, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/443e075f186efa23776d64303005cb8f?s=128&d=identicon&r=PG", "display_name": "Eggman87", "link": "https://stackoverflow.com/users/1105073/eggman87"}, "edited": false, "score": 0, "creation_date": 1454872389, "post_id": 34703906, "comment_id": 58228019, "body": "@Eggman87 Just looked at the generated class and you&#39;re right. However it seems strange that the compiler generates a static field even though we did not instruct it to do so."}], "tags": [], "owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "is_accepted": true, "score": 15, "last_activity_date": 1455285863, "last_edit_date": 1455285863, "creation_date": 1452418054, "answer_id": 34703906, "question_id": 34703680, "link": "https://stackoverflow.com/questions/34703680/android-parcelable-in-kotlin/34703906#34703906", "title": "Android Parcelable in Kotlin", "body": "<p>I suspect you're using an outdated version of Kotlin compiler (since you use <code>!</code>). Here's a version compiling properly with latest version:</p>\n\n<pre><code>companion object {\n    @JvmField\n    val CREATOR = object : Parcelable.Creator&lt;KwerendaGraficzna&gt; {\n        override fun createFromParcel(`in`: Parcel): KwerendaGraficzna {\n            return KwerendaGraficzna(`in`)\n        }\n\n        override fun newArray(size: Int): Array&lt;KwerendaGraficzna?&gt; {\n            return arrayOfNulls(size)\n        }\n    }\n}\n</code></pre>\n\n<p>Since the <code>Parcelable.Creator</code> requires a public static field we need to mark the <code>CREATOR</code> property with <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.jvm/-jvm-field/\"><code>@JvmField</code></a> and <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.jvm/-jvm-static/\"><code>JvmStatic</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1934, "user_id": 7877391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1oVvK.png?s=128&g=1", "display_name": "c-an", "link": "https://stackoverflow.com/users/7877391/c-an"}, "is_accepted": false, "score": 0, "last_activity_date": 1606903295, "creation_date": 1606903295, "answer_id": 65105860, "question_id": 34703680, "link": "https://stackoverflow.com/questions/34703680/android-parcelable-in-kotlin/65105860#65105860", "title": "Android Parcelable in Kotlin", "body": "<p>You don't need to implement all the boilerplate code.</p>\n<p>Instead,</p>\n<pre><code>@Parcelize\ndata class KwerendaGraficzna(val a: Int, val b: String): Parcelable{\n    // TODO: others code\n}\n</code></pre>\n<p>That's it.</p>\n<p>You need to enable <code>experimental</code> to <code>true</code> in <code>build.gradle</code> to apply the method above.</p>\n<pre><code>android{\n    compileSdkVersion 30\n    \n    defaultConfig{\n        applicationId &quot;com.example&quot;\n        minSdkVersion 25\n        targetSdkVersion 30\n        ...\n    }\n\n    ...\n\n    androidExtensions {\n        experimental = true\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 6830, "user_id": 1332872, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/M03y5.jpg?s=128&g=1", "display_name": "ssuukk", "link": "https://stackoverflow.com/users/1332872/ssuukk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3305, "favorite_count": 0, "accepted_answer_id": 34703906, "answer_count": 2, "score": 10, "last_activity_date": 1606903295, "creation_date": 1452416083, "question_id": 34703680, "link": "https://stackoverflow.com/questions/34703680/android-parcelable-in-kotlin", "title": "Android Parcelable in Kotlin", "body": "<p>I have such Java parcelable:</p>\n\n<pre><code>@SuppressWarnings(\"rawtypes\")\npublic static final Parcelable.Creator CREATOR = new Parcelable.Creator() {\n    public KwerendaGraficzna createFromParcel(Parcel in) {\n        return new KwerendaGraficzna(in);\n    }\n\n    public KwerendaGraficzna[] newArray(int size) {\n        return new KwerendaGraficzna[size];\n    }\n};\n</code></pre>\n\n<p>Now trying to implement it in Kotlin:</p>\n\n<pre><code>companion object {\n    @SuppressWarnings(\"rawtypes\")\n    val CREATOR: Parcelable.Creator&lt;KwerendaGraficzna!&gt; = object : Parcelable.Creator&lt;KwerendaGraficzna!&gt; {\n        override fun createFromParcel(`in`: Parcel): KwerendaGraficzna {\n            return KwerendaGraficzna(`in`)\n        }\n\n        override fun newArray(size: Int): Array&lt;KwerendaGraficzna!&gt; {\n            return arrayOfNulls&lt;KwerendaGraficzna!&gt;(size)\n        }\n    }\n}\n</code></pre>\n\n<p><code>arrayOfNulls</code> won't compile requires <code>KwerendaGraficzna</code> while it claims it received <code>KwerendaGraficzna?</code></p>\n\n<p>So how do I do it? </p>\n"}, {"tags": ["parallel-processing", "kotlin"], "comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 4, "creation_date": 1452514807, "post_id": 34697828, "comment_id": 57188436, "body": "Some of the fastest parallel collections around are from GS-Collections:  <a href=\"https://github.com/goldmansachs/gs-collections\" rel=\"nofollow noreferrer\">github.com/goldmansachs/gs-collections</a> ... which you can use from Kotlin (as any Java collection framework can be used)"}], "answers": [{"tags": [], "owner": {"reputation": 50185, "user_id": 276949, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/52e96d535181560d2b46d4b513454ee5?s=128&d=identicon&r=PG", "display_name": "Martin Konecny", "link": "https://stackoverflow.com/users/276949/martin-konecny"}, "is_accepted": false, "score": 4, "last_activity_date": 1555091691, "last_edit_date": 1555091691, "creation_date": 1452367526, "answer_id": 34697901, "question_id": 34697828, "link": "https://stackoverflow.com/questions/34697828/parallel-operations-on-kotlin-collections/34697901#34697901", "title": "Parallel operations on Kotlin collections?", "body": "<p>At the present moment no. The official Kotlin comparison to Scala mentions:</p>\n\n<blockquote>\n  <p>Things that may be added to Kotlin later:</p>\n  \n  <ul>\n  <li>Parallel collections</li>\n  </ul>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 2560, "user_id": 3757113, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000391669542/picture?type=large", "display_name": "LordScone", "link": "https://stackoverflow.com/users/3757113/lordscone"}, "edited": false, "score": 2, "creation_date": 1455978978, "post_id": 34699904, "comment_id": 58738773, "body": "how can one use Java 8 stream API in Kotlin?"}, {"owner": {"reputation": 1494, "user_id": 1635803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jIXgO.jpg?s=128&g=1", "display_name": "Grzegorz D.", "link": "https://stackoverflow.com/users/1635803/grzegorz-d"}, "reply_to_user": {"reputation": 2560, "user_id": 3757113, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000391669542/picture?type=large", "display_name": "LordScone", "link": "https://stackoverflow.com/users/3757113/lordscone"}, "edited": false, "score": 2, "creation_date": 1505132816, "post_id": 34699904, "comment_id": 79273067, "body": "@LordScone The same way as you&#39;d do it in Java. E.g.: <code>myCollection.parallelStream().map { ... }. filter { ... }</code>"}, {"owner": {"reputation": 8417, "user_id": 896663, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/43d6aedf3569e654c0ce647daa1a3a4c?s=128&d=identicon&r=PG&f=1", "display_name": "MozenRath", "link": "https://stackoverflow.com/users/896663/mozenrath"}, "edited": false, "score": 0, "creation_date": 1610560181, "post_id": 34699904, "comment_id": 116175255, "body": "just for information, parallelStream is only advised in case of long lists, for smaller lists, it will be an overhead to run the 2 jobs in different threads as in java world. Stick to coroutines as far as possible"}], "tags": [], "owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "is_accepted": true, "score": 48, "last_activity_date": 1550482441, "last_edit_date": 1550482441, "creation_date": 1452380169, "answer_id": 34699904, "question_id": 34697828, "link": "https://stackoverflow.com/questions/34697828/parallel-operations-on-kotlin-collections/34699904#34699904", "title": "Parallel operations on Kotlin collections?", "body": "<p>The Kotlin standard library has no support for parallel operations. However, since Kotlin uses the standard Java collection classes, you can use the Java 8 stream API to perform parallel operations on Kotlin collections as well.</p>\n\n<p>e.g.\n</p>\n\n<pre><code>myCollection.parallelStream()\n        .map { ... }\n        .filter { ... }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2854, "user_id": 18078, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/AErhq.jpg?s=128&g=1", "display_name": "David Leppik", "link": "https://stackoverflow.com/users/18078/david-leppik"}, "edited": false, "score": 0, "creation_date": 1458680143, "post_id": 35638609, "comment_id": 59967202, "body": "I don&#39;t see how &quot;destination.add(transform(item))&quot; is thread safe. What&#39;s to keep two threads from calling &quot;destination.add&quot; at the same time, thus breaking stuff since ArrayList.add() is not a thread safe operation?"}, {"owner": {"reputation": 7683, "user_id": 590437, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oehge.jpg?s=128&g=1", "display_name": "Holger Brandl", "link": "https://stackoverflow.com/users/590437/holger-brandl"}, "reply_to_user": {"reputation": 2854, "user_id": 18078, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/AErhq.jpg?s=128&g=1", "display_name": "David Leppik", "link": "https://stackoverflow.com/users/18078/david-leppik"}, "edited": false, "score": 0, "creation_date": 1458728704, "post_id": 35638609, "comment_id": 59986566, "body": "Thanks for the hint. Quite <a href=\"http://stackoverflow.com/questions/2715983/concurrent-threads-adding-to-arraylist-at-same-time-what-happens\">some</a> people think that when just adding elements it should be fine without synchronization. However, I&#39;ve changed it to use a synchronized list to improve thread-safety."}, {"owner": {"reputation": 846, "user_id": 372859, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0122fbad35cedf0bdc0da1a3204e355e?s=128&d=identicon&r=PG", "display_name": "Cuper Hector", "link": "https://stackoverflow.com/users/372859/cuper-hector"}, "edited": false, "score": 1, "creation_date": 1458821329, "post_id": 35638609, "comment_id": 60032968, "body": "The order in destination may not be the same as in the original list"}, {"owner": {"reputation": 7683, "user_id": 590437, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oehge.jpg?s=128&g=1", "display_name": "Holger Brandl", "link": "https://stackoverflow.com/users/590437/holger-brandl"}, "edited": false, "score": 0, "creation_date": 1459276567, "post_id": 35638609, "comment_id": 60210015, "body": "I think many parallel collection implementations (like in <a href=\"http://beust.com/weblog/2011/08/15/scalas-parallel-collections/\" rel=\"nofollow noreferrer\">scala</a>) do not care about preserving order. Though, by changing the for-each loop above to an indexed loop along with downstream resorting, order could be preserved easily."}, {"owner": {"reputation": 596, "user_id": 4515050, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/88TBE.jpg?s=128&g=1", "display_name": "StephanS", "link": "https://stackoverflow.com/users/4515050/stephans"}, "edited": false, "score": 0, "creation_date": 1572662670, "post_id": 35638609, "comment_id": 103638527, "body": "I&#39;m interested in a version that returns a <code>Sequence&lt;R&gt;</code> (or <code>Flow&lt;R&gt;</code>). Unfortunately I can&#39;t simply have the whole code execute in an <code>= execute{</code> block and call <code>yield</code> instead of <code>destination.add</code> because <code>yield</code> can only execute in the original block, so within <code>exec.submit { }</code> is not an option. (Order need not be preserved.)"}], "tags": [], "owner": {"reputation": 7683, "user_id": 590437, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oehge.jpg?s=128&g=1", "display_name": "Holger Brandl", "link": "https://stackoverflow.com/users/590437/holger-brandl"}, "is_accepted": false, "score": 14, "last_activity_date": 1538484514, "last_edit_date": 1538484514, "creation_date": 1456435332, "answer_id": 35638609, "question_id": 34697828, "link": "https://stackoverflow.com/questions/34697828/parallel-operations-on-kotlin-collections/35638609#35638609", "title": "Parallel operations on Kotlin collections?", "body": "<p>There is no official support in Kotlin's stdlib yet, but you could define an <a href=\"https://kotlinlang.org/docs/reference/extensions.html\" rel=\"nofollow noreferrer\">extension function </a> to mimic <code>par.map</code>:</p>\n\n<pre><code>fun &lt;T, R&gt; Iterable&lt;T&gt;.pmap(\n          numThreads: Int = Runtime.getRuntime().availableProcessors() - 2, \n          exec: ExecutorService = Executors.newFixedThreadPool(numThreads),\n          transform: (T) -&gt; R): List&lt;R&gt; {\n\n    // default size is just an inlined version of kotlin.collections.collectionSizeOrDefault\n    val defaultSize = if (this is Collection&lt;*&gt;) this.size else 10\n    val destination = Collections.synchronizedList(ArrayList&lt;R&gt;(defaultSize))\n\n    for (item in this) {\n        exec.submit { destination.add(transform(item)) }\n    }\n\n    exec.shutdown()\n    exec.awaitTermination(1, TimeUnit.DAYS)\n\n    return ArrayList&lt;R&gt;(destination)\n}\n</code></pre>\n\n<p>(<a href=\"https://github.com/holgerbrandl/kutils/blob/master/src/main/kotlin/kutils/ParCollections.kt\" rel=\"nofollow noreferrer\">github source</a>)</p>\n\n<p>Here's a simple usage example</p>\n\n<pre><code>val result = listOf(\"foo\", \"bar\").pmap { it+\"!\" }.filter { it.contains(\"bar\") }\n</code></pre>\n\n<p>If needed it allows to tweak threading by providing the number of threads or even a specific <code>java.util.concurrent.Executor</code>. E.g.</p>\n\n<pre><code>listOf(\"foo\", \"bar\").pmap(4, transform = { it + \"!\" })\n</code></pre>\n\n<p>Please note, that this approach just allows to parallelize the <code>map</code> operation and does not affect any downstream bits. E.g. the <code>filter</code> in the first example would run single-threaded. However, in many cases just the data transformation (ie. <code>map</code>) requires parallelization. Furthermore, it would be straightforward to extend the approach from above to other elements of Kotlin collection API.</p>\n"}, {"comments": [{"owner": {"reputation": 4026, "user_id": 1117848, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1215059/picture?type=large", "display_name": "Benjamin H", "link": "https://stackoverflow.com/users/1117848/benjamin-h"}, "edited": false, "score": 3, "creation_date": 1541102225, "post_id": 45794062, "comment_id": 93112267, "body": "With Kotlin 1.3 out, is this still the best answer?  I noticed @OlivierTerrien&#39;s Stream answer below, but I&#39;d prefer to stick with Kotlin Sequences and Iterables."}, {"owner": {"reputation": 15120, "user_id": 161257, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Lm0md.png?s=128&g=1", "display_name": "HRJ", "link": "https://stackoverflow.com/users/161257/hrj"}, "reply_to_user": {"reputation": 4026, "user_id": 1117848, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1215059/picture?type=large", "display_name": "Benjamin H", "link": "https://stackoverflow.com/users/1117848/benjamin-h"}, "edited": false, "score": 0, "creation_date": 1546228038, "post_id": 45794062, "comment_id": 94804159, "body": "@BenjaminH Thanks; I have marked yole&#39;s answer as accepted, as it also refers to the stream API and posted before OlivierTerrien&#39;s answer."}, {"owner": {"reputation": 1375, "user_id": 246376, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e7400cca6e3f9e2a4bb57135423186d7?s=128&d=identicon&r=PG", "display_name": "Dzmitry Lazerka", "link": "https://stackoverflow.com/users/246376/dzmitry-lazerka"}, "edited": false, "score": 23, "creation_date": 1550701742, "post_id": 45794062, "comment_id": 96370420, "body": "Quite elegantly? On the contrary, the code is pretty hard to read I would say."}, {"owner": {"reputation": 143, "user_id": 2000521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c07e500cc17d2808c9d9e309c9474346?s=128&d=identicon&r=PG", "display_name": "Joseph Catrambone", "link": "https://stackoverflow.com/users/2000521/joseph-catrambone"}, "reply_to_user": {"reputation": 1375, "user_id": 246376, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e7400cca6e3f9e2a4bb57135423186d7?s=128&d=identicon&r=PG", "display_name": "Dzmitry Lazerka", "link": "https://stackoverflow.com/users/246376/dzmitry-lazerka"}, "edited": false, "score": 2, "creation_date": 1560979007, "post_id": 45794062, "comment_id": 99919123, "body": "@DzmitryLazerka I think I see where you&#39;re coming from, but this exact code isn&#39;t the elegant bit.  The use of this code is what&#39;s elegant.  If the above method is placed somewhere, it can be used with just <code>foo.pmap { v -&gt; ...  }</code>.  I think that&#39;s fairly elegant."}, {"owner": {"reputation": 1870, "user_id": 752385, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/adb164b92b3e338ce103bd2816b266e4?s=128&d=identicon&r=PG", "display_name": "Strinder", "link": "https://stackoverflow.com/users/752385/strinder"}, "edited": false, "score": 1, "creation_date": 1591731699, "post_id": 45794062, "comment_id": 110166548, "body": "Currently &#39;CommonPool&#39; cannot be accessed - it is internal in &#39;kotlinx.coroutines&#39;!"}, {"owner": {"reputation": 8417, "user_id": 896663, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/43d6aedf3569e654c0ce647daa1a3a4c?s=128&d=identicon&r=PG&f=1", "display_name": "MozenRath", "link": "https://stackoverflow.com/users/896663/mozenrath"}, "edited": false, "score": 0, "creation_date": 1610560347, "post_id": 45794062, "comment_id": 116175337, "body": "This is in fact the best performing solution i think. It does not have any overheads like a parallelStream. Although would have loved to see a helper method from kotlin that could cater to it."}], "tags": [], "owner": {"reputation": 7514, "user_id": 1104870, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/fe76e258ce32209153e67d540f9232fd?s=128&d=identicon&r=PG", "display_name": "Alex Krauss", "link": "https://stackoverflow.com/users/1104870/alex-krauss"}, "is_accepted": false, "score": 37, "last_activity_date": 1503308930, "creation_date": 1503308930, "answer_id": 45794062, "question_id": 34697828, "link": "https://stackoverflow.com/questions/34697828/parallel-operations-on-kotlin-collections/45794062#45794062", "title": "Parallel operations on Kotlin collections?", "body": "<p>As of Kotlin 1.1, parallel operations can also be expressed quite elegantly in terms of <a href=\"https://kotlinlang.org/docs/reference/coroutines.html\" rel=\"noreferrer\">coroutines</a>. Here is <code>pmap</code> on lists:</p>\n\n<pre><code>fun &lt;A, B&gt;List&lt;A&gt;.pmap(f: suspend (A) -&gt; B): List&lt;B&gt; = runBlocking {\n    map { async(CommonPool) { f(it) } }.map { it.await() }\n}\n</code></pre>\n\n<p>Note that coroutines are still an experimental feature.</p>\n"}, {"comments": [{"owner": {"reputation": 15120, "user_id": 161257, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Lm0md.png?s=128&g=1", "display_name": "HRJ", "link": "https://stackoverflow.com/users/161257/hrj"}, "edited": false, "score": 0, "creation_date": 1546228196, "post_id": 52304046, "comment_id": 94804182, "body": "I am not following kotlin very closely; isn&#39;t this the same as Yole&#39;s answer?I appreciate that your answer has sample code. Maybe we can edit Yole&#39;s answer to add the sample code."}, {"owner": {"reputation": 1881, "user_id": 5619076, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/4njff.jpg?s=128&g=1", "display_name": "OlivierTerrien", "link": "https://stackoverflow.com/users/5619076/olivierterrien"}, "reply_to_user": {"reputation": 15120, "user_id": 161257, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Lm0md.png?s=128&g=1", "display_name": "HRJ", "link": "https://stackoverflow.com/users/161257/hrj"}, "edited": false, "score": 0, "creation_date": 1546344822, "post_id": 52304046, "comment_id": 94827994, "body": "@HRJ, not exactly. Yole said Kotlin had no support for stream which is true until version 1.2. Since this version, Kotlin provides a way to stream collections as Java8 does."}, {"owner": {"reputation": 15120, "user_id": 161257, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Lm0md.png?s=128&g=1", "display_name": "HRJ", "link": "https://stackoverflow.com/users/161257/hrj"}, "edited": false, "score": 0, "creation_date": 1546350493, "post_id": 52304046, "comment_id": 94829246, "body": "Yole said &quot;Kotlin has no support for parallel operations&quot;. Please check again."}, {"owner": {"reputation": 1881, "user_id": 5619076, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/4njff.jpg?s=128&g=1", "display_name": "OlivierTerrien", "link": "https://stackoverflow.com/users/5619076/olivierterrien"}, "reply_to_user": {"reputation": 15120, "user_id": 161257, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Lm0md.png?s=128&g=1", "display_name": "HRJ", "link": "https://stackoverflow.com/users/161257/hrj"}, "edited": false, "score": 0, "creation_date": 1546350814, "post_id": 52304046, "comment_id": 94829321, "body": "Yes you are right. Too quickly written. Parallel operations not stream."}, {"owner": {"reputation": 2393, "user_id": 671393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/035d4c85912d57bddcef8e8b5745f2e4?s=128&d=identicon&r=PG", "display_name": "Rupert Rawnsley", "link": "https://stackoverflow.com/users/671393/rupert-rawnsley"}, "edited": false, "score": 0, "creation_date": 1590676963, "post_id": 52304046, "comment_id": 109775632, "body": "Probably worth pointing out that as this requires JRE8 it is only available on Android 24 and above."}], "tags": [], "owner": {"reputation": 1881, "user_id": 5619076, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/4njff.jpg?s=128&g=1", "display_name": "OlivierTerrien", "link": "https://stackoverflow.com/users/5619076/olivierterrien"}, "is_accepted": false, "score": 11, "last_activity_date": 1536789456, "creation_date": 1536789456, "answer_id": 52304046, "question_id": 34697828, "link": "https://stackoverflow.com/questions/34697828/parallel-operations-on-kotlin-collections/52304046#52304046", "title": "Parallel operations on Kotlin collections?", "body": "<p>From 1.2 version, kotlin added a <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.streams/index.html\" rel=\"noreferrer\">stream feature</a> which is compliant with JRE8</p>\n\n<p>So, iterating over a list asynchronously could be done like bellow:</p>\n\n<pre><code>fun main(args: Array&lt;String&gt;) {\n  val c = listOf(\"toto\", \"tata\", \"tutu\")\n  c.parallelStream().forEach { println(it) }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2393, "user_id": 671393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/035d4c85912d57bddcef8e8b5745f2e4?s=128&d=identicon&r=PG", "display_name": "Rupert Rawnsley", "link": "https://stackoverflow.com/users/671393/rupert-rawnsley"}, "edited": false, "score": 0, "creation_date": 1590679603, "post_id": 53403284, "comment_id": 109777277, "body": "While I appreciate Kotlin not wanting to be opaque, surely this is a common enough requirement to warrant an extension method? forEachParallel or something similar"}], "tags": [], "owner": {"reputation": 460, "user_id": 2331319, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/0Wwzg.jpg?s=128&g=1", "display_name": "Lamberto Basti", "link": "https://stackoverflow.com/users/2331319/lamberto-basti"}, "is_accepted": false, "score": 5, "last_activity_date": 1542757463, "creation_date": 1542757463, "answer_id": 53403284, "question_id": 34697828, "link": "https://stackoverflow.com/questions/34697828/parallel-operations-on-kotlin-collections/53403284#53403284", "title": "Parallel operations on Kotlin collections?", "body": "<p>Kotlin wants to be idiomatic but not too much synthetic to be hard to understand at a first glance. </p>\n\n<p>Parallel computation trough Coroutines is no exception. They want it to be easy but not implicit with some pre-built method, allowing to branch the computation when needed.</p>\n\n<p>In your case:</p>\n\n<pre><code>collection.map { \n        async{ produceWith(it) } \n    }\n    .forEach { \n        consume(it.await()) \n    }\n</code></pre>\n\n<p>Notice that to call <code>async</code> and <code>await</code> you need to be inside a so called <code>Context</code>, you cannot make suspending calls or launching a coroutine from a non-coroutine context. To enter one you can either:</p>\n\n<ul>\n<li><code>runBlocking { /* your code here */ }</code>: it will suspend the current thread until the lambda returns.</li>\n<li><code>GlobalScope.launch { }</code>: it will execute the lambda in parallel; if your <code>main</code> finishes executing while your coroutines have not bad things will happen, in that case better use <code>runBlocking</code>.</li>\n</ul>\n\n<p>Hope it may helps :)</p>\n"}, {"tags": [], "owner": {"reputation": 596, "user_id": 4515050, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/88TBE.jpg?s=128&g=1", "display_name": "StephanS", "link": "https://stackoverflow.com/users/4515050/stephans"}, "is_accepted": false, "score": 2, "last_activity_date": 1572908272, "last_edit_date": 1572908272, "creation_date": 1572877734, "answer_id": 58695485, "question_id": 34697828, "link": "https://stackoverflow.com/questions/34697828/parallel-operations-on-kotlin-collections/58695485#58695485", "title": "Parallel operations on Kotlin collections?", "body": "<p>This solution assumes that your project is using coroutines:</p>\n\n<pre><code>implementation( \"org.jetbrains.kotlinx:kotlinx-coroutines-core:1.3.2\")\n</code></pre>\n\n<p>The functions called <code>parallelTransform</code> don't retain the order of elements and return a <code>Flow&lt;R&gt;</code>, while the function <code>parallelMap</code> retains the order and returns a <code>List&lt;R&gt;</code>.</p>\n\n<p>Create a threadpool for multiple invocations:</p>\n\n<pre><code>val numberOfCores = Runtime.getRuntime().availableProcessors()\nval executorDispatcher: ExecutorCoroutineDispatcher =\n    Executors.newFixedThreadPool(numberOfCores ).asCoroutineDispatcher()\n</code></pre>\n\n<p>use that dispatcher (and call <code>close()</code> when it's no longer needed):</p>\n\n<pre><code>inline fun &lt;T, R&gt; Iterable&lt;T&gt;.parallelTransform(\n    dispatcher: ExecutorDispatcher,\n    crossinline transform: (T) -&gt; R\n): Flow&lt;R&gt; = channelFlow {\n\n    val items: Iterable&lt;T&gt; = this@parallelTransform\n    val channelFlowScope: ProducerScope&lt;R&gt; = this@channelFlow\n\n    launch(dispatcher) {\n        items.forEach {item -&gt;\n            launch {\n                channelFlowScope.send(transform(item))\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>If threadpool reuse is of no concern (threadpools aren't cheap), you can use this version:</p>\n\n<pre><code>inline fun &lt;T, R&gt; Iterable&lt;T&gt;.parallelTransform(\n    numberOfThreads: Int,\n    crossinline transform: (T) -&gt; R\n): Flow&lt;R&gt; = channelFlow {\n\n    val items: Iterable&lt;T&gt; = this@parallelTransform\n    val channelFlowScope: ProducerScope&lt;R&gt; = this@channelFlow\n\n    Executors.newFixedThreadPool(numberOfThreads).asCoroutineDispatcher().use { dispatcher -&gt;\n        launch( dispatcher ) {\n            items.forEach { item -&gt;\n                launch {\n                    channelFlowScope.send(transform(item))\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>if you need a version that retains the order of elements:</p>\n\n<pre><code>inline fun &lt;T, R&gt; Iterable&lt;T&gt;.parallelMap(\n    dispatcher: ExecutorDispatcher,\n    crossinline transform: (T) -&gt; R\n): List&lt;R&gt; = runBlocking {\n\n    val items: Iterable&lt;T&gt; = this@parallelMap\n    val result = ConcurrentSkipListMap&lt;Int, R&gt;()\n\n    launch(dispatcher) {\n        items.withIndex().forEach {(index, item) -&gt;\n            launch {\n                result[index] = transform(item)\n            }\n        }\n    }\n\n    // ConcurrentSkipListMap is a SortedMap\n    // so the values will be in the right order\n    result.values.toList()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 359, "user_id": 2811244, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w1NEw.jpg?s=128&g=1", "display_name": "Sharon", "link": "https://stackoverflow.com/users/2811244/sharon"}, "is_accepted": false, "score": 12, "last_activity_date": 1573059749, "creation_date": 1573059749, "answer_id": 58735169, "question_id": 34697828, "link": "https://stackoverflow.com/questions/34697828/parallel-operations-on-kotlin-collections/58735169#58735169", "title": "Parallel operations on Kotlin collections?", "body": "<p>You can use this extension method: </p>\n\n<pre><code>suspend fun &lt;A, B&gt; Iterable&lt;A&gt;.pmap(f: suspend (A) -&gt; B): List&lt;B&gt; = coroutineScope {\n    map { async { f(it) } }.awaitAll()\n}\n</code></pre>\n\n<p>See <a href=\"https://jivimberg.io/blog/2018/05/04/parallel-map-in-kotlin/\" rel=\"noreferrer\">Parallel Map in Kotlin</a> for more info</p>\n"}], "owner": {"reputation": 15120, "user_id": 161257, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Lm0md.png?s=128&g=1", "display_name": "HRJ", "link": "https://stackoverflow.com/users/161257/hrj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33368, "favorite_count": 5, "accepted_answer_id": 34699904, "answer_count": 8, "score": 44, "last_activity_date": 1573059749, "creation_date": 1452367121, "question_id": 34697828, "link": "https://stackoverflow.com/questions/34697828/parallel-operations-on-kotlin-collections", "title": "Parallel operations on Kotlin collections?", "body": "<p>In Scala, one can easily do a parallel map, forEach, etc, with:</p>\n\n<pre><code>collection.par.map(..)\n</code></pre>\n\n<p>Is there an equivalent in Kotlin?</p>\n"}, {"tags": ["kotlin"], "comments": [{"owner": {"reputation": 12952, "user_id": 2398375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1a5530da29f23682b10bb5568076f83d?s=128&d=identicon&r=PG", "display_name": "Dioxin", "link": "https://stackoverflow.com/users/2398375/dioxin"}, "edited": false, "score": 0, "creation_date": 1452365069, "post_id": 34697222, "comment_id": 57141007, "body": "Error does not occur if <code>override val</code> was removed within the subclass. I&#39;m guessing this is a bug, since even supplying an optional value to the base class (and/or subclass) still results in a null error"}, {"owner": {"reputation": 41540, "user_id": 127013, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5cfa38a7e54e6c6a850dc6169a699246?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/127013/matthias"}, "reply_to_user": {"reputation": 12952, "user_id": 2398375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1a5530da29f23682b10bb5568076f83d?s=128&d=identicon&r=PG", "display_name": "Dioxin", "link": "https://stackoverflow.com/users/2398375/dioxin"}, "edited": false, "score": 0, "creation_date": 1452375087, "post_id": 34697222, "comment_id": 57144342, "body": "It&#39;s not evident from the sample code, but I actually need to override the property. The property type passed in the constructor in my real code is covariant in this position, so it must redefine (and hence override) the base class property."}, {"owner": {"reputation": 41540, "user_id": 127013, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5cfa38a7e54e6c6a850dc6169a699246?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/127013/matthias"}, "reply_to_user": {"reputation": 12952, "user_id": 2398375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1a5530da29f23682b10bb5568076f83d?s=128&d=identicon&r=PG", "display_name": "Dioxin", "link": "https://stackoverflow.com/users/2398375/dioxin"}, "edited": false, "score": 0, "creation_date": 1452375692, "post_id": 34697222, "comment_id": 57144527, "body": "This is getting weirder with the minute. Have a look at this even more concise test case, in which I made the problem with the property covariance more evident: <a href=\"https://gist.github.com/mttkay/9fbb0ddf72f471465afc\" rel=\"nofollow noreferrer\">gist.github.com/mttkay/9fbb0ddf72f471465afc</a>  Here I pass 42 in the constructor, and it prints 0. ^^"}, {"owner": {"reputation": 12952, "user_id": 2398375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1a5530da29f23682b10bb5568076f83d?s=128&d=identicon&r=PG", "display_name": "Dioxin", "link": "https://stackoverflow.com/users/2398375/dioxin"}, "edited": false, "score": 0, "creation_date": 1452379315, "post_id": 34697222, "comment_id": 57145651, "body": "Why not declare Base as Base&lt;T: BaseValue&gt;(val value: T) and do Sub(value: SubValue) : Base&lt;SubValue&gt;(value), rather than overriding the property?"}, {"owner": {"reputation": 41540, "user_id": 127013, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5cfa38a7e54e6c6a850dc6169a699246?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/127013/matthias"}, "reply_to_user": {"reputation": 12952, "user_id": 2398375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1a5530da29f23682b10bb5568076f83d?s=128&d=identicon&r=PG", "display_name": "Dioxin", "link": "https://stackoverflow.com/users/2398375/dioxin"}, "edited": false, "score": 0, "creation_date": 1452420333, "post_id": 34697222, "comment_id": 57154116, "body": "@VinceEmigh Sure, I could do that. It would mean I&#39;d have to go back and change my entire code base to now use a generic type where in Java, a non-generic type and a covariant getter sufficed. Another solution I found I posted in the comment to @yole&#39;s answer. Apparently one can change the program semantics ever so subtly by turning the property in the primary ctor into just a ctor argument, and moving the actual val declaration into the class body. That will make <code>input</code> in the init block reference the argument directly instead of the property."}], "answers": [{"comments": [{"owner": {"reputation": 7068, "user_id": 3055345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4be9ac800479c9373ed751f85fbe79e7?s=128&d=identicon&r=PG&f=1", "display_name": "desseim", "link": "https://stackoverflow.com/users/3055345/desseim"}, "edited": false, "score": 0, "creation_date": 1452381425, "post_id": 34699957, "comment_id": 57146190, "body": "I agree this is what happens, but when creating a <code>Base(&quot;test&quot;)</code>, it doesn&#39;t throw (even when explicitly dereferencing <code>this.input</code> in the <code>init</code> block of the <code>Base</code> class) ; although the primary constructor is called <i>after</i> the <code>init</code> block in this case too. This seems contradictory to me, but <i>if this is the intended behavior</i> could you explain the discrepancy between base and sub class creation process (which I reckon becomes a reformulation of the original question) ?"}, {"owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "reply_to_user": {"reputation": 7068, "user_id": 3055345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4be9ac800479c9373ed751f85fbe79e7?s=128&d=identicon&r=PG&f=1", "display_name": "desseim", "link": "https://stackoverflow.com/users/3055345/desseim"}, "edited": false, "score": 0, "creation_date": 1452410233, "post_id": 34699957, "comment_id": 57152006, "body": "Why are you saying that the primary constructor is called after the init block? On the Java bytecode level, code in all init blocks is appended to the primary constructor, and is executed after the code that copies the constructor parameter to the backing field."}, {"owner": {"reputation": 41540, "user_id": 127013, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5cfa38a7e54e6c6a850dc6169a699246?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/127013/matthias"}, "edited": false, "score": 0, "creation_date": 1452416308, "post_id": 34699957, "comment_id": 57153117, "body": "Right, now that you put it this way, it&#39;s pretty evident what&#39;s happening. Don&#39;t you think though that it&#39;s highly confusing that I&#39;m referring to <code>input</code> in the super class constructor, which is available as an argument to me, and I&#39;m passing a proper value, yet it&#39;s not initialized yet? I&#39;d be surprised if I&#39;d be the only person thinking that this is completely backwards."}, {"owner": {"reputation": 7068, "user_id": 3055345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4be9ac800479c9373ed751f85fbe79e7?s=128&d=identicon&r=PG&f=1", "display_name": "desseim", "link": "https://stackoverflow.com/users/3055345/desseim"}, "edited": false, "score": 0, "creation_date": 1452418581, "post_id": 34699957, "comment_id": 57153660, "body": "@yole thanks for detailing ; my assumption was based on debug logging in a secondary constructor because I have no access to a platform allowing me to check the generated bytecode atm. It remains imo that the discrepancy between creating an instance of the base and derived class is highly bewildering as Matthias commented ; could you add the rationale behind it to your answer if it indeed is intentional by design?"}, {"owner": {"reputation": 41540, "user_id": 127013, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5cfa38a7e54e6c6a850dc6169a699246?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/127013/matthias"}, "edited": false, "score": 0, "creation_date": 1452419913, "post_id": 34699957, "comment_id": 57153990, "body": "@yole Here is further evidence why the current behavior is completely puzzling: <a href=\"https://gist.github.com/mttkay/5dc9bde1006b70e1e8ba\" rel=\"nofollow noreferrer\">gist.github.com/mttkay/5dc9bde1006b70e1e8ba</a> Compared to the previous snippet, the only thing I changed is moving the super class property declaration out of the primary constructor and into the class body. Shouldn&#39;t these two programs be semantically equivalent? Yet they produce different results."}, {"owner": {"reputation": 10942, "user_id": 18575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/318654a786700455b96049d8ac9beb11?s=128&d=identicon&r=PG", "display_name": "Ilya Ryzhenkov", "link": "https://stackoverflow.com/users/18575/ilya-ryzhenkov"}, "reply_to_user": {"reputation": 41540, "user_id": 127013, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5cfa38a7e54e6c6a850dc6169a699246?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/127013/matthias"}, "edited": false, "score": 0, "creation_date": 1452421943, "post_id": 34699957, "comment_id": 57154533, "body": "@Matthias in the last example you are printing the value of the constructor parameter, not the property. Try using <code>this.input</code> to use property and get back an NPE :)"}, {"owner": {"reputation": 41540, "user_id": 127013, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5cfa38a7e54e6c6a850dc6169a699246?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/127013/matthias"}, "reply_to_user": {"reputation": 10942, "user_id": 18575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/318654a786700455b96049d8ac9beb11?s=128&d=identicon&r=PG", "display_name": "Ilya Ryzhenkov", "link": "https://stackoverflow.com/users/18575/ilya-ryzhenkov"}, "edited": false, "score": 0, "creation_date": 1452423239, "post_id": 34699957, "comment_id": 57154861, "body": "@IlyaRyzhenkov yeah sure, I did realize that. I&#39;m merely questioning that this is what should be happening for the sake of not violating the principle of least surprise."}, {"owner": {"reputation": 41540, "user_id": 127013, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5cfa38a7e54e6c6a850dc6169a699246?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/127013/matthias"}, "edited": false, "score": 0, "creation_date": 1452423606, "post_id": 34699957, "comment_id": 57154960, "body": "PS: I added a comment to the gist acknowledging that it was exaggerating the problem by naming the property and the constructor argument the same. However, this is a common enough idiom in the Java world to still make this a concern."}, {"owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "reply_to_user": {"reputation": 7068, "user_id": 3055345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4be9ac800479c9373ed751f85fbe79e7?s=128&d=identicon&r=PG&f=1", "display_name": "desseim", "link": "https://stackoverflow.com/users/3055345/desseim"}, "edited": false, "score": 1, "creation_date": 1452449333, "post_id": 34699957, "comment_id": 57163996, "body": "@desseim: I&#39;ve edited my answer to include a complete translation of Kotlin into equivalent Java code, so I hope the difference in behavior is no longer bewildering"}, {"owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "reply_to_user": {"reputation": 41540, "user_id": 127013, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5cfa38a7e54e6c6a850dc6169a699246?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/127013/matthias"}, "edited": false, "score": 1, "creation_date": 1452449423, "post_id": 34699957, "comment_id": 57164032, "body": "@Matthias: Our design for primary constructors effectively forces us to use the same name to refer to two different things (the constructor parameter and the property), and it&#39;s true that this can sometimes lead to surprising behavior. However, we don&#39;t have an alternative design which would fix the surprises while still allowing to keep the primary constructor syntax."}, {"owner": {"reputation": 41540, "user_id": 127013, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5cfa38a7e54e6c6a850dc6169a699246?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/127013/matthias"}, "edited": false, "score": 0, "creation_date": 1452450252, "post_id": 34699957, "comment_id": 57164364, "body": "@yole thanks for clarifying, I see where you&#39;re coming from."}], "tags": [], "owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "is_accepted": true, "score": 8, "last_activity_date": 1452449473, "last_edit_date": 1452449473, "creation_date": 1452380579, "answer_id": 34699957, "question_id": 34697222, "link": "https://stackoverflow.com/questions/34697222/how-are-overridden-properties-handled-in-init-blocks/34699957#34699957", "title": "How are overridden properties handled in init blocks?", "body": "<p>The original example is equivalent to the following Java program:</p>\n\n<pre><code>class Base {\n    private String input;\n    private String derived;\n\n    Base(String input) {\n        this.input = input;\n        this.derived = getInput().toUpperCase();  // Initializes derived by calling an overridden method\n    }\n\n    public String getInput() {\n        return input;\n    }\n}\n\nclass Derived extends Base {\n    private String input;\n\n    public Derived(String input) {\n        super(input);    // Calls the superclass constructor, which tries to initialize derived\n        this.input = input;  // Initializes the subclass field\n    }\n\n    @Override\n    public String getInput() {\n        return input;   // Returns the value of the subclass field\n    }\n}\n</code></pre>\n\n<p>The getInput() method is overridden in the Sub class, so the code calls Sub.getInput(). At this time, the constructor of the Sub class has not executed, so the backing field holding the value of Sub.input is still null. This is not a bug in Kotlin; you can easily run into the same problem in pure Java code.</p>\n\n<p>The fix is to not override the property. (I've seen your comment, but this doesn't really explain why you think you need to override it.)</p>\n"}, {"comments": [{"owner": {"reputation": 7068, "user_id": 3055345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4be9ac800479c9373ed751f85fbe79e7?s=128&d=identicon&r=PG&f=1", "display_name": "desseim", "link": "https://stackoverflow.com/users/3055345/desseim"}, "edited": false, "score": 1, "creation_date": 1452468248, "post_id": 34704376, "comment_id": 57170372, "body": "That is indeed the confusing part, thanks. Related tracker issue for whoever is interested: <a href=\"https://youtrack.jetbrains.com/issue/KT-91\" rel=\"nofollow noreferrer\">youtrack.jetbrains.com/issue/KT-91</a> ."}], "tags": [], "owner": {"reputation": 10942, "user_id": 18575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/318654a786700455b96049d8ac9beb11?s=128&d=identicon&r=PG", "display_name": "Ilya Ryzhenkov", "link": "https://stackoverflow.com/users/18575/ilya-ryzhenkov"}, "is_accepted": false, "score": 3, "last_activity_date": 1452421768, "creation_date": 1452421768, "answer_id": 34704376, "question_id": 34697222, "link": "https://stackoverflow.com/questions/34697222/how-are-overridden-properties-handled-in-init-blocks/34704376#34704376", "title": "How are overridden properties handled in init blocks?", "body": "<p>The confusion comes from the fact that you created two storages for the <code>input</code> value (fields in JVM). One is in base class, one in derived. When you are reading <code>input</code> value in base class, it calls virtual <code>getInput</code> method under the hood. <code>getInput</code> is overridden in derived class to return its own stored value, which is not initialised before base constructor is called. This is typical \"virtual call in constructor\" problem. </p>\n\n<p>If you change derived class to actually use property of super type, everything is fine again. </p>\n\n<pre><code>class Sub(input: String) : Base(input) {\n    override val input : String\n        get() = super.input\n}\n</code></pre>\n"}], "owner": {"reputation": 41540, "user_id": 127013, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5cfa38a7e54e6c6a850dc6169a699246?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/127013/matthias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1612, "favorite_count": 1, "accepted_answer_id": 34699957, "answer_count": 2, "score": 5, "last_activity_date": 1452449473, "creation_date": 1452363635, "last_edit_date": 1452423976, "question_id": 34697222, "link": "https://stackoverflow.com/questions/34697222/how-are-overridden-properties-handled-in-init-blocks", "title": "How are overridden properties handled in init blocks?", "body": "<p>I'm trying to understand why the following code throws:</p>\n\n<pre><code>open class Base(open val input: String) {\n  lateinit var derived: String\n\n  init {\n    derived = input.toUpperCase() // throws!\n  }\n}\n\nclass Sub(override val input: String) : Base(input)\n</code></pre>\n\n<p>When invoking this code like this:</p>\n\n<pre><code>println(Sub(\"test\").derived)    \n</code></pre>\n\n<p>it throws an exception, because at the time <code>toUpperCase</code> is called, <code>input</code> resolves to <code>null</code>. I find this counter intuitive: I pass a non-null value to the primary constructor, yet in the init block of the super class it resolves to null?</p>\n\n<p>I think I have a vague idea of what might be going on: since <code>input</code> serves both as a constructor argument as well as a property, the assignment internally calls <code>this.input</code>, but <code>this</code> isn't fully initialized yet. It's really odd: in the IntelliJ debugger, <code>input</code> resolves normally (to the value \"test\"), but as soon as I invoke the expression evaluation window and inspect <code>input</code> manually, it's suddenly null.</p>\n\n<p>Assuming this is expected behavior, what do you recommend to do instead, i.e. when one needs to initialize fields derived from properties of the same class?</p>\n\n<p><strong>UPDATE:</strong>\nI've posted two even more concise code snippets that illustrate where the confusion stems from:</p>\n\n<p><a href=\"https://gist.github.com/mttkay/9fbb0ddf72f471465afc\" rel=\"nofollow\">https://gist.github.com/mttkay/9fbb0ddf72f471465afc</a>\n<a href=\"https://gist.github.com/mttkay/5dc9bde1006b70e1e8ba\" rel=\"nofollow\">https://gist.github.com/mttkay/5dc9bde1006b70e1e8ba</a></p>\n"}, {"tags": ["kotlin", "kotlin-extension"], "answers": [{"comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 3, "creation_date": 1452515286, "post_id": 34689478, "comment_id": 57188748, "body": "It isn&#39;t exactly &quot;generic type erasure&quot;.  Kotlin can differentiate at compile time between the two functions because its signatures include the generics, and can also differentiated by return type.  Java does not create method signatures with generic types.  So this changes the actual method name in the byte code renaming it so that there are now two independent methods with no more need to differentiate by signature.  Rather than two overloaded functions on a class with apparently the same signature."}], "tags": [], "owner": {"reputation": 2636, "user_id": 211601, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Jfttk.png?s=128&g=1", "display_name": "Jeremy Lyman", "link": "https://stackoverflow.com/users/211601/jeremy-lyman"}, "is_accepted": true, "score": 11, "last_activity_date": 1452313649, "last_edit_date": 1452313649, "creation_date": 1452311409, "answer_id": 34689478, "question_id": 34689252, "link": "https://stackoverflow.com/questions/34689252/kotlin-extension-functions-by-type/34689478#34689478", "title": "Kotlin extension functions by type", "body": "<p>One answer seems to be :</p>\n\n<pre><code>@JvmName(\"sortA\")\nfun &lt;T: A&gt; List&lt;T&gt;.sort(): List&lt;T&gt; {\n    return this.sortedWith&lt;T&gt;(aComparator)\n}\n\n@JvmName(\"sortB\")\nfun &lt;T: B&gt; List&lt;T&gt;.sort(): List&lt;T&gt; {\n    return this.sortedWith&lt;T&gt;(bComparator)\n}\n</code></pre>\n\n<p>This seems to fix Java's issue with generic type erasure.</p>\n\n<p>Found here : <a href=\"https://kotlinlang.org/docs/reference/java-to-kotlin-interop.html\">https://kotlinlang.org/docs/reference/java-to-kotlin-interop.html</a></p>\n"}, {"comments": [{"owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "edited": false, "score": 0, "creation_date": 1452449597, "post_id": 34689558, "comment_id": 57164099, "body": "This example uses obsolete Kotlin syntax, which is no longer compatible with the current version. Jeremy&#39;s answer above shows the same solution using up-to-date syntax."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1452515041, "post_id": 34689558, "comment_id": 57188583, "body": "<code>platformName</code> is deprecated (or now removed), <code>JvmName</code> is current.  Update to Kotlin 1.0 betas and watch your compiler warnings/errors."}], "tags": [], "owner": {"reputation": 8020, "user_id": 823282, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xBNDh.png?s=128&g=1", "display_name": "activedecay", "link": "https://stackoverflow.com/users/823282/activedecay"}, "is_accepted": false, "score": 0, "last_activity_date": 1452542103, "last_edit_date": 1452542103, "creation_date": 1452312471, "answer_id": 34689558, "question_id": 34689252, "link": "https://stackoverflow.com/questions/34689252/kotlin-extension-functions-by-type/34689558#34689558", "title": "Kotlin extension functions by type", "body": "<p><a href=\"http://blog.jetbrains.com/kotlin/2014/10/making-platform-interop-even-smoother/\" rel=\"nofollow\">On this site, I found this solution</a></p>\n\n<p>Instead of this</p>\n\n<pre><code>fun Iterable&lt;Long&gt;.average(): Double {}\nfun Iterable&lt;Int&gt;.average(): Double {}\n</code></pre>\n\n<p>Use the platformName</p>\n\n<pre><code>fun Iterable&lt;Long&gt;.average(): Long {\n}\nplatformName(\"averageOfInt\") fun Iterable&lt;Int&gt;.average(): Int {\n}\n</code></pre>\n\n<p>EDIT: This is deprecated, use JvmName instead. </p>\n"}], "owner": {"reputation": 2636, "user_id": 211601, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Jfttk.png?s=128&g=1", "display_name": "Jeremy Lyman", "link": "https://stackoverflow.com/users/211601/jeremy-lyman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2473, "favorite_count": 1, "accepted_answer_id": 34689478, "answer_count": 2, "score": 4, "last_activity_date": 1452542103, "creation_date": 1452308342, "last_edit_date": 1452309260, "question_id": 34689252, "link": "https://stackoverflow.com/questions/34689252/kotlin-extension-functions-by-type", "title": "Kotlin extension functions by type", "body": "<p>What is the idiomatic way to add a function to a class based on type. The following example uses List as the class, and the Type Parameter <code>&lt;T&gt;</code> is the class of objects inside of the list. Lets say you want to sort each of these lists with a different comparator based on their type. </p>\n\n<pre><code>data class A(val foo: String)\ndata class B(val bar: Int)\n\nprivate val aComparator: Comparator&lt;A&gt; = Comparator { lhs, rhs -&gt; rhs.foo.compareTo(lhs.foo) }\nprivate val bComparator: Comparator&lt;B&gt; = Comparator { lhs, rhs -&gt; rhs.bar.compareTo(lhs.bar) }\n\nfun &lt;T: A&gt; List&lt;T&gt;.sort(): List&lt;T&gt; {\n    return this.sortedWith&lt;T&gt;(aComparator)\n}\n\nfun &lt;T: B&gt; List&lt;T&gt;.sort(): List&lt;T&gt; {\n    return this.sortedWith&lt;T&gt;(bComparator)\n}\n</code></pre>\n\n<p>This gives an error saying that both sort functions have the same signatures due to Java's overloading rules. In Java I might give them both different identifiable names but it is fairly ugly as Kotlin extensions (e.g. a.sortA() b.sortB()). Kotlin doesn't show sortA to a List&lt; B > so there seems like there would be a better way of writing sort() to handle different comparators on different objects.</p>\n\n<p>The example is pretty simple but imagine if I don't have access to modify class A and B so I could not use inheritance or implement an interface on them. I also thought about adding a comparator to every class and use Any? But that seems cumbersome as well.</p>\n"}, {"tags": ["raspberry-pi2", "kotlin", "jansi"], "comments": [{"owner": {"reputation": 641, "user_id": 5479247, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AC0-V9DmUv4/AAAAAAAAAAI/AAAAAAAAFc0/7D0Qqwhjgbg/photo.jpg?sz=128", "display_name": "Eugene Krivenja", "link": "https://stackoverflow.com/users/5479247/eugene-krivenja"}, "edited": false, "score": 1, "creation_date": 1452250945, "post_id": 34673801, "comment_id": 57095774, "body": "May be this is a reason: <code>Possible cause: can&#39;t load IA 32-bit .so on a ARM-bit platform</code>. You have installed Intel binaries only, but ARM is needed."}, {"owner": {"reputation": 11834, "user_id": 1538877, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/N9qfZ.jpg?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/1538877/ruslan"}, "edited": false, "score": 0, "creation_date": 1452343163, "post_id": 34673801, "comment_id": 57133128, "body": "<a href=\"https://youtrack.jetbrains.com/issue/KT-10605\" rel=\"nofollow noreferrer\">youtrack.jetbrains.com/issue/KT-10605</a> I submitted this bug to JetBrains."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5761927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6E9av.jpg?s=128&g=1", "display_name": "Kyungkoo", "link": "https://stackoverflow.com/users/5761927/kyungkoo"}, "edited": false, "score": 0, "creation_date": 1452480377, "post_id": 34678895, "comment_id": 57173266, "body": "Thank you. but even though I changed like you, it doesn&#39;t work. :( I changed COLOR_ENABLED=false and rebuilded new source but crached."}, {"owner": {"reputation": 25812, "user_id": 288456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf294ff6d86cc587dec43e2af34a9532?s=128&d=identicon&r=PG", "display_name": "Alexander Udalov", "link": "https://stackoverflow.com/users/288456/alexander-udalov"}, "reply_to_user": {"reputation": 11, "user_id": 5761927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6E9av.jpg?s=128&g=1", "display_name": "Kyungkoo", "link": "https://stackoverflow.com/users/5761927/kyungkoo"}, "edited": false, "score": 0, "creation_date": 1452515056, "post_id": 34678895, "comment_id": 57188596, "body": "Does it crash with the same error or another one? In any case, could you please edit your question to include the new stack trace?"}, {"owner": {"reputation": 11, "user_id": 5761927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6E9av.jpg?s=128&g=1", "display_name": "Kyungkoo", "link": "https://stackoverflow.com/users/5761927/kyungkoo"}, "edited": false, "score": 0, "creation_date": 1452560137, "post_id": 34678895, "comment_id": 57214032, "body": "I got same error. It also crashed at <code>org.jetbrains.kotlin.cli.common.messages.PlainTextMessageRen&zwnj;&#8203;derer.&lt;clinit&gt;(Plain&zwnj;&#8203;TextMessageRenderer.&zwnj;&#8203;java:35)</code>."}, {"owner": {"reputation": 11, "user_id": 5761927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6E9av.jpg?s=128&g=1", "display_name": "Kyungkoo", "link": "https://stackoverflow.com/users/5761927/kyungkoo"}, "edited": false, "score": 0, "creation_date": 1452660013, "post_id": 34678895, "comment_id": 57262558, "body": "I think when I changed <code>COLOR_ENABLED</code> value but when compiled it, <code>PlainTextMessageRenderer.java</code> is not compiled again."}, {"owner": {"reputation": 25812, "user_id": 288456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf294ff6d86cc587dec43e2af34a9532?s=128&d=identicon&r=PG", "display_name": "Alexander Udalov", "link": "https://stackoverflow.com/users/288456/alexander-udalov"}, "reply_to_user": {"reputation": 11, "user_id": 5761927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6E9av.jpg?s=128&g=1", "display_name": "Kyungkoo", "link": "https://stackoverflow.com/users/5761927/kyungkoo"}, "edited": false, "score": 0, "creation_date": 1452684408, "post_id": 34678895, "comment_id": 57275851, "body": "I see now that the problem is in the bootstrap compiler, which is just an artifact downloaded in update_dependencies. So colors must be disabled in an already built compiler located in <code>dependencies&#47;bootstrap-compiler&#47;Kotlin&#47;kotlinc&#47;lib&#47;kotlin-co&zwnj;&#8203;mpiler.jar</code>. I&#39;ll commit a change allowing that soon."}, {"owner": {"reputation": 11, "user_id": 5761927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6E9av.jpg?s=128&g=1", "display_name": "Kyungkoo", "link": "https://stackoverflow.com/users/5761927/kyungkoo"}, "edited": false, "score": 0, "creation_date": 1453078680, "post_id": 34678895, "comment_id": 57431974, "body": "Thank you :D. Could I ask when is the next release?"}, {"owner": {"reputation": 25812, "user_id": 288456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf294ff6d86cc587dec43e2af34a9532?s=128&d=identicon&r=PG", "display_name": "Alexander Udalov", "link": "https://stackoverflow.com/users/288456/alexander-udalov"}, "reply_to_user": {"reputation": 11, "user_id": 5761927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6E9av.jpg?s=128&g=1", "display_name": "Kyungkoo", "link": "https://stackoverflow.com/users/5761927/kyungkoo"}, "edited": false, "score": 0, "creation_date": 1453127489, "post_id": 34678895, "comment_id": 57453550, "body": "I&#39;ve committed the change: <a href=\"https://github.com/JetBrains/kotlin/commit/b0627b4\" rel=\"nofollow noreferrer\">github.com/JetBrains/kotlin/commit/b0627b4</a>. Please try adding <code>&lt;arg value=&quot;-Dkotlin.colors.enabled=false&quot;&#47;&gt;</code> to <code>&lt;exec&gt;</code> in target <code>override-version</code> in update_dependencies.xml"}, {"owner": {"reputation": 25812, "user_id": 288456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf294ff6d86cc587dec43e2af34a9532?s=128&d=identicon&r=PG", "display_name": "Alexander Udalov", "link": "https://stackoverflow.com/users/288456/alexander-udalov"}, "reply_to_user": {"reputation": 11, "user_id": 5761927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6E9av.jpg?s=128&g=1", "display_name": "Kyungkoo", "link": "https://stackoverflow.com/users/5761927/kyungkoo"}, "edited": false, "score": 0, "creation_date": 1453215689, "post_id": 34678895, "comment_id": 57497968, "body": "Yeah, you have to basically pass this option to every instance of the compiler run in <code>build.xml</code>. First of all, ant should be run with it: <code>ant -Dkotlin.colors.enabled=false</code>. Second, everywhere where a Kotlin compiler is run in a new process (fork=true), pass a system property: <code>&lt;sysproperty key=&quot;kotlin.colors.enabled&quot; value=&quot;true&quot;&#47;&gt;</code>. Let me know if you need further help"}, {"owner": {"reputation": 11, "user_id": 5761927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6E9av.jpg?s=128&g=1", "display_name": "Kyungkoo", "link": "https://stackoverflow.com/users/5761927/kyungkoo"}, "edited": false, "score": 0, "creation_date": 1453283943, "post_id": 34678895, "comment_id": 57530238, "body": "I updated my question. And one more thing. Even though I fixed <code>PlainTextMessageRenderer.java</code> 35line, build.xml doesn&#39;t care about. I don&#39;t why."}, {"owner": {"reputation": 25812, "user_id": 288456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf294ff6d86cc587dec43e2af34a9532?s=128&d=identicon&r=PG", "display_name": "Alexander Udalov", "link": "https://stackoverflow.com/users/288456/alexander-udalov"}, "reply_to_user": {"reputation": 11, "user_id": 5761927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6E9av.jpg?s=128&g=1", "display_name": "Kyungkoo", "link": "https://stackoverflow.com/users/5761927/kyungkoo"}, "edited": false, "score": 0, "creation_date": 1453287975, "post_id": 34678895, "comment_id": 57533030, "body": "Sorry, I made a typo, should be <code>... value=&quot;false&quot;&#47;&gt;</code> of course :("}, {"owner": {"reputation": 11, "user_id": 5761927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6E9av.jpg?s=128&g=1", "display_name": "Kyungkoo", "link": "https://stackoverflow.com/users/5761927/kyungkoo"}, "edited": false, "score": 0, "creation_date": 1453288776, "post_id": 34678895, "comment_id": 57533625, "body": "I also tried but, it doesn&#39;t work. I got same error. I executed ant using this command <code>ant -f build.xml -Dkotlin.colors.enabled=false</code>. Is this correct?"}, {"owner": {"reputation": 25812, "user_id": 288456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf294ff6d86cc587dec43e2af34a9532?s=128&d=identicon&r=PG", "display_name": "Alexander Udalov", "link": "https://stackoverflow.com/users/288456/alexander-udalov"}, "reply_to_user": {"reputation": 11, "user_id": 5761927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6E9av.jpg?s=128&g=1", "display_name": "Kyungkoo", "link": "https://stackoverflow.com/users/5761927/kyungkoo"}, "edited": false, "score": 0, "creation_date": 1453290390, "post_id": 34678895, "comment_id": 57534658, "body": "Could you please try running <code>ANT_OPTS=-Dkotlin.colors.enabled=false ant</code>?"}, {"owner": {"reputation": 11, "user_id": 5761927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6E9av.jpg?s=128&g=1", "display_name": "Kyungkoo", "link": "https://stackoverflow.com/users/5761927/kyungkoo"}, "edited": false, "score": 0, "creation_date": 1453375645, "post_id": 34678895, "comment_id": 57578624, "body": "I added <code>export ANT_OPTS=&quot;-Dkotlin.colors.enabled=false -Xmx1024m&quot;</code>, and then, execute <code>ant -f build.xml</code>. It took 4hours and suddenly, process is killed. anyway, I executed &#39;dist/kotlinc/kotlinc-jvm&#39; and got error <code>Exception in thread &quot;main&quot; java.lang.reflect.InvocationTargetException</code>."}], "tags": [], "owner": {"reputation": 25812, "user_id": 288456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf294ff6d86cc587dec43e2af34a9532?s=128&d=identicon&r=PG", "display_name": "Alexander Udalov", "link": "https://stackoverflow.com/users/288456/alexander-udalov"}, "is_accepted": false, "score": 3, "last_activity_date": 1452261799, "creation_date": 1452261799, "answer_id": 34678895, "question_id": 34673801, "link": "https://stackoverflow.com/questions/34673801/kotlin-compiler-build-fail-in-raspberrypi2/34678895#34678895", "title": "Kotlin Compiler build fail in Raspberrypi2", "body": "<p>Looks like jansi native libraries are missing for Raspberry Pi. I'm not sure if they should be available, but you can safely disable them while building Kotlin because Kotlin compiler only uses jansi to output colored diagnostic messages to the terminal. To disable the use of colors (and hence jansi), try applying this patch in the root of the Kotlin project:</p>\n\n<pre><code>diff --git a/compiler/cli/src/org/jetbrains/kotlin/cli/common/messages/PlainTextMessageRenderer.java b/compiler/cli/src/org/jetbrains/kotlin/cli/common/messages/PlainTextMessageRenderer.java\nindex e83309d..d4755e6 100644\n--- a/compiler/cli/src/org/jetbrains/kotlin/cli/common/messages/PlainTextMessageRenderer.java\n+++ b/compiler/cli/src/org/jetbrains/kotlin/cli/common/messages/PlainTextMessageRenderer.java\n@@ -32,9 +32,7 @@ import static org.jetbrains.kotlin.cli.common.messages.CompilerMessageSeverity.*\n public abstract class PlainTextMessageRenderer implements MessageRenderer {\n     // AnsiConsole doesn't check isatty() for stderr (see https://github.com/fusesource/jansi/pull/35).\n     // TODO: investigate why ANSI escape codes on Windows only work in REPL for some reason\n-    private static final boolean COLOR_ENABLED =\n-            !SystemInfo.isWindows &amp;&amp;\n-            CLibrary.isatty(CLibrary.STDERR_FILENO) != 0;\n+    private static final boolean COLOR_ENABLED = false;\n\n     private static final String LINE_SEPARATOR = LineSeparator.getSystemLineSeparator().getSeparatorString();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 4770681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10b834941ae2caef8248197cd3cbb72c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Wilson", "link": "https://stackoverflow.com/users/4770681/tyler-wilson"}, "is_accepted": false, "score": 2, "last_activity_date": 1457046651, "last_edit_date": 1457046651, "creation_date": 1457045835, "answer_id": 35784737, "question_id": 34673801, "link": "https://stackoverflow.com/questions/34673801/kotlin-compiler-build-fail-in-raspberrypi2/35784737#35784737", "title": "Kotlin Compiler build fail in Raspberrypi2", "body": "<p>I was just trying to get Kotlin to work on my Raspberry Pi as well. I followed the link above - <a href=\"https://youtrack.jetbrains.com/issue/KT-10605\" rel=\"nofollow\">https://youtrack.jetbrains.com/issue/KT-10605</a> - from IRus. From that I saw that it does check a property to disable color, fortunately.</p>\n\n<p>So, at least for now until the change is propagated, you can do the following:</p>\n\n<pre><code>kotlinc -Dkotlin.colors.enabled=false\n</code></pre>\n\n<p>which will then skip the part that tries to load a non-ARM shared library. At least it works for me to get the REPL running.</p>\n\n<p>Another way I found is to set the env variable JAVA_TOOL_OPTIONS like so:</p>\n\n<pre><code>export JAVA_TOOL_OPTIONS=\"-Dkotlin.colors.enabled=false\"\n</code></pre>\n\n<p>this will be picked up by the java vm and then you do not need it on every command line (though it does spit out an annoying 'Picked up message' every time.</p>\n"}, {"tags": [], "owner": {"reputation": 3755, "user_id": 1940850, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zqElV.png?s=128&g=1", "display_name": "karel", "link": "https://stackoverflow.com/users/1940850/karel"}, "is_accepted": false, "score": 0, "last_activity_date": 1520768748, "last_edit_date": 1520768748, "creation_date": 1520663514, "answer_id": 49206100, "question_id": 34673801, "link": "https://stackoverflow.com/questions/34673801/kotlin-compiler-build-fail-in-raspberrypi2/49206100#49206100", "title": "Kotlin Compiler build fail in Raspberrypi2", "body": "<p>The command line Kotlin compiler developed by jetbrains can be installed as a snap package in all currently supported versions of Ubuntu. To install it, open the terminal and type:</p>\n\n<pre><code>sudo snap install kotlin --classic  \n</code></pre>\n\n<p>Available tools:</p>\n\n<ul>\n<li>kotlinc</li>\n<li>kotlinc-jvm</li>\n<li>kotlinc-js</li>\n<li>kotlin-dce-js</li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 5761927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6E9av.jpg?s=128&g=1", "display_name": "Kyungkoo", "link": "https://stackoverflow.com/users/5761927/kyungkoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 723, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1520768748, "creation_date": 1452246139, "last_edit_date": 1453283833, "question_id": 34673801, "link": "https://stackoverflow.com/questions/34673801/kotlin-compiler-build-fail-in-raspberrypi2", "title": "Kotlin Compiler build fail in Raspberrypi2", "body": "<p>I tried to build kotlin compiler in Raspberrypi2 on Ubuntu Mate 15.10</p>\n\n<p>When I execute <code>ant -f update_dependencies.xml</code> and during building, error occured below.</p>\n\n<pre><code>override-version:\n [echo] Requested URL https://teamcity.jetbrains.com/guestAuth/app/rest/builds/?locator=buildType:IntelliJMarkdownParser_Build,status:SUCCESS,tag:forKotlin,count:1\n [echo] Build Number: 3174 - Kotlin 1.0.0-beta-5160 Build Id: 662124\n  [get] Getting: https://teamcity.jetbrains.com/guestAuth/app/rest/builds/id:662124/artifacts/content/markdown_jar/markdown.jar\n  [get] To: /home/kyungkoo/Downloads/kotlin-build-1.0.0-beta-4584/dependencies/markdown.jar\n  [get] Not modified - so not downloaded\n [exec] Exception in thread \"main\" java.lang.reflect.InvocationTargetException\n [exec]     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n [exec]     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n [exec]     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n [exec]     at java.lang.reflect.Method.invoke(Method.java:497)\n [exec]     at org.jetbrains.kotlin.preloading.Preloader.run(Preloader.java:73)\n [exec]     at org.jetbrains.kotlin.preloading.Preloader.main(Preloader.java:35)\n [exec] Caused by: java.lang.UnsatisfiedLinkError: Could not load library. Reasons: [no jansi in java.library.path, /tmp/libjansi-32-2155791272664213050.so: /tmp/libjansi-32-2155791272664213050.so: cannot open shared object file: No such file or directory (Possible cause: can't load IA 32-bit .so on a ARM-bit platform)]\n [exec]     at org.fusesource.hawtjni.runtime.Library.doLoad(Library.java:182)\n [exec]     at org.fusesource.hawtjni.runtime.Library.load(Library.java:140)\n [exec]     at org.fusesource.jansi.internal.CLibrary.&lt;clinit&gt;(CLibrary.java:37)\n [exec]     at org.jetbrains.kotlin.cli.common.messages.PlainTextMessageRenderer.&lt;clinit&gt;(PlainTextMessageRenderer.java:35)\n [exec]     at org.jetbrains.kotlin.cli.common.messages.MessageRenderer.&lt;clinit&gt;(MessageRenderer.java:29)\n [exec]     at org.jetbrains.kotlin.cli.common.CLICompiler.exec(CLICompiler.java:57)\n [exec]     at org.jetbrains.kotlin.cli.common.CLICompiler.doMainNoExit(CLICompiler.java:240)\n [exec]     at org.jetbrains.kotlin.cli.common.CLICompiler.doMain(CLICompiler.java:231)\n [exec]     at org.jetbrains.kotlin.cli.jvm.K2JVMCompiler$Companion.main(K2JVMCompiler.kt:246)\n [exec]     at org.jetbrains.kotlin.cli.jvm.K2JVMCompiler.main(K2JVMCompiler.kt)\n [exec]     ... 6 more\n</code></pre>\n\n<p>I installed <code>libjansi-java</code> and <code>libjansi-native-java</code> but it doesn't work.\nIs any idea solve this problem? </p>\n\n<hr>\n\n<p>I updated soruce code to <code>build-1.0.0-beta-5569</code> and added <code>&lt;arg value=\"-Dkotlin.colors.enabled=false\"/&gt;</code> like belows:</p>\n\n<pre><code>--- a/update_dependencies.xml\n+++ b/update_dependencies.xml\n@@ -368,6 +368,7 @@\n     &lt;macrodef name=\"build-protobuf-java-lite\"&gt;\n         &lt;sequential&gt;\n             &lt;exec executable=\"dependencies/bootstrap-compiler/Kotlin/kotlinc/bin/${kotlinc.executable.path}\" failonerror=\"true\"&gt;\n+                &lt;arg value=\"-Dkotlin.colors.enabled=false\"/&gt;\n                 &lt;arg value=\"-script\"/&gt;\n                 &lt;arg value=\"generators/infrastructure/build-protobuf-lite.kts\"/&gt;\n                 &lt;arg value=\"${basedir}/ideaSDK/lib/protobuf-2.5.0.jar\"/&gt;\n@@ -419,6 +420,7 @@\n                 &lt;delete dir=\"${markdown.dir}\" failonerror=\"false\"/&gt;\n                 &lt;unzip src=\"dependencies/download/markdown-sources.zip\" dest=\"dependencies\"/&gt;\n                 &lt;exec executable=\"dependencies/bootstrap-compiler/Kotlin/kotlinc/bin/${kotlinc.executable.path}\" failonerror=\"true\"&gt;\n+                    &lt;arg value=\"-Dkotlin.colors.enabled=false\"/&gt;\n                     &lt;arg value=\"${markdown.dir}/src\"/&gt;\n                     &lt;arg value=\"-d\"/&gt;\n                     &lt;arg value=\"${markdown.dir}/out\"/&gt;\n@@ -874,6 +876,7 @@\n             &lt;echo message=\"URL: ${override.version.url} Version: ${override.version.build.number}\"/&gt;\n\n             &lt;exec executable=\"dependencies/bootstrap-compiler/Kotlin/kotlinc/bin/${kotlinc.executable.path}\" failonerror=\"false\"&gt;\n+                &lt;arg value=\"-Dkotlin.colors.enbled=false\"/&gt;\n                 &lt;arg value=\"-cp\"/&gt;\n                 &lt;arg value=\"dependencies/bootstrap-compiler/Kotlin/kotlinc/lib/kotlin-compiler.jar\"/&gt;\n                 &lt;arg value=\"-script\"/&gt;\n</code></pre>\n\n<p>After finsiehd <code>update_dependencies.xml</code>, I executed <code>ant -f build.xml</code> and got following errors:</p>\n\n<pre><code>runner:\n     [echo] Cleaning /home/kyungkoo/Downloads/kotlin-build-1.0.0-beta-5569/dist/classes/runner\n    [mkdir] Created dir: /home/kyungkoo/Downloads/kotlin-build-1.0.0-beta-5569/dist/classes/runner\n  [kotlinc] Compiling [/home/kyungkoo/Downloads/kotlin-build-1.0.0-beta-5569/compiler/cli/cli-runner/src] =&gt; [/home/kyungkoo/Downloads/kotlin-build-1.0.0-beta-5569/dist/classes/runner]\n\nBUILD FAILED\n/home/kyungkoo/Downloads/kotlin-build-1.0.0-beta-5569/build.xml:441: java.lang.reflect.InvocationTargetException\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:497)\n    at org.jetbrains.kotlin.ant.KotlinCompilerBaseTask.execute(KotlinCompilerBaseTask.kt:92)\n    at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:293)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:497)\n    at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)\n    at org.apache.tools.ant.Task.perform(Task.java:348)\n    at org.apache.tools.ant.Target.execute(Target.java:435)\n    at org.apache.tools.ant.Target.performTasks(Target.java:456)\n    at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1405)\n    at org.apache.tools.ant.Project.executeTarget(Project.java:1376)\n    at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\n    at org.apache.tools.ant.Project.executeTargets(Project.java:1260)\n    at org.apache.tools.ant.Main.runBuild(Main.java:853)\n    at org.apache.tools.ant.Main.startAnt(Main.java:235)\n    at org.apache.tools.ant.launch.Launcher.run(Launcher.java:285)\n    at org.apache.tools.ant.launch.Launcher.main(Launcher.java:112)\nCaused by: java.lang.UnsatisfiedLinkError: Could not load library. Reasons: [no jansi in java.library.path, /tmp/libjansi-32-7100610475620258495.so: /tmp/libjansi-32-7100610475620258495.so: cannot open shared object file: No such file or directory (Possible cause: can't load IA 32-bit .so on a ARM-bit platform)]\n    at org.fusesource.hawtjni.runtime.Library.doLoad(Library.java:182)\n    at org.fusesource.hawtjni.runtime.Library.load(Library.java:140)\n    at org.fusesource.jansi.internal.CLibrary.&lt;clinit&gt;(CLibrary.java:37)\n    at org.jetbrains.kotlin.cli.common.messages.PlainTextMessageRenderer.&lt;clinit&gt;(PlainTextMessageRenderer.java:35)\n    at org.jetbrains.kotlin.cli.common.messages.MessageRenderer.&lt;clinit&gt;(MessageRenderer.java:29)\n    at org.jetbrains.kotlin.cli.common.CLICompiler.execFullPathsInMessages(CLICompiler.java:69)\n    ... 22 more\n\nTotal time: 1 minute 3 seconds\n</code></pre>\n\n<hr>\n\n<p>I fixed <code>build.xml</code> like this:</p>\n\n<pre><code>diff --git a/build.xml b/build.xml\nindex 38f751c..7bcfeb1 100644\n--- a/build.xml\n+++ b/build.xml\n@@ -299,6 +299,7 @@\n\n             &lt;java classname=\"org.jetbrains.kotlin.preloading.Preloader\" failonerror=\"true\" fork=\"true\"\n                   maxmemory=\"${max.heap.size.for.forked.jvm}\"&gt;\n+                &lt;sysproperty key=\"kotlin.colors.enabled\" value=\"true\"/&gt;\n                 &lt;classpath&gt;\n                     &lt;pathelement location=\"${kotlin-home}/lib/kotlin-preloader.jar\"/&gt;\n                 &lt;/classpath&gt;\n@@ -468,6 +469,7 @@\n               failonerror=\"true\"\n               fork=\"true\"\n               maxmemory=\"${max.heap.size.for.forked.jvm}\"&gt;\n+            &lt;sysproperty key=\"kotlin.colors.enabled\" value=\"true\"/&gt;\n             &lt;assertions&gt;\n                 &lt;enable/&gt;\n             &lt;/assertions&gt;\n@@ -732,6 +734,7 @@\n             &lt;pathconvert property=\"src.line\" refid=\"src.dirset\" pathsep=\" \"/&gt;\n\n             &lt;java classname=\"org.jetbrains.kotlin.preloading.Preloader\" failonerror=\"true\" fork=\"true\" maxmemory=\"${max.heap.size.for.forked.jvm}\"&gt;\n+                &lt;sysproperty key=\"kotlin.colors.enabled\" value=\"true\"/&gt;\n                 &lt;classpath&gt;\n                     &lt;pathelement location=\"${kotlin-home}/lib/kotlin-preloader.jar\"/&gt;\n                 &lt;/classpath&gt;\n@@ -771,6 +774,7 @@\n\n         &lt;sequential&gt;\n             &lt;java classname=\"org.jetbrains.kotlin.preloading.Preloader\" failonerror=\"true\" fork=\"true\" maxmemory=\"${max.heap.size.for.forked.jvm}\"&gt;\n+                &lt;sysproperty key=\"kotlin.colors.enabled\" value=\"true\"/&gt;\n                 &lt;classpath&gt;\n                     &lt;pathelement location=\"${kotlin-home}/lib/kotlin-preloader.jar\"/&gt;\n                 &lt;/classpath&gt;\n</code></pre>\n\n<p>and then, I execute ant build.\n<code>ant -f build.xml -Dkotlin.colors.enabled=false</code>.\nI'm not good at <code>ant</code>. So, I can not sure that this is correct syntax. but build was started and I got same error.</p>\n\n<pre><code>BUILD FAILED\n/home/kyungkoo/Downloads/kotlin-build-1.0.0-beta-5569/build.xml:442: java.lang.reflect.InvocationTargetException\n\n...\n\nCaused by: java.lang.UnsatisfiedLinkError: Could not load library. Reasons: [no jansi in java.library.path, /tmp/libjansi-32-7323034426853998701.so: /tmp/libjansi-32-7323034426853998701.so: cannot open shared object file: No such file or directory (Possible cause: can't load IA 32-bit .so on a ARM-bit platform)]\n    at org.fusesource.hawtjni.runtime.Library.doLoad(Library.java:182)\n    at org.fusesource.hawtjni.runtime.Library.load(Library.java:140)\n    at org.fusesource.jansi.internal.CLibrary.&lt;clinit&gt;(CLibrary.java:37)\n    at org.jetbrains.kotlin.cli.common.messages.PlainTextMessageRenderer.&lt;clinit&gt;(PlainTextMessageRenderer.java:35)\n</code></pre>\n"}, {"tags": ["kotlin"], "answers": [{"comments": [{"owner": {"reputation": 6830, "user_id": 1332872, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/M03y5.jpg?s=128&g=1", "display_name": "ssuukk", "link": "https://stackoverflow.com/users/1332872/ssuukk"}, "edited": false, "score": 0, "creation_date": 1452256697, "post_id": 34677293, "comment_id": 57099511, "body": "Off topic, but maybe you can answer it quickly here... What happened to numberOfThreads in buildDispatcher? Seems it doesn&#39;t exist anymore..."}, {"owner": {"reputation": 1629, "user_id": 700848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0f335ffa8a58df3a2ab208b04002fba?s=128&d=identicon&r=PG&f=1", "display_name": "M Platvoet", "link": "https://stackoverflow.com/users/700848/m-platvoet"}, "reply_to_user": {"reputation": 6830, "user_id": 1332872, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/M03y5.jpg?s=128&g=1", "display_name": "ssuukk", "link": "https://stackoverflow.com/users/1332872/ssuukk"}, "edited": false, "score": 1, "creation_date": 1452256803, "post_id": 34677293, "comment_id": 57099573, "body": "It has been renamed to &#39;concurrentTasks&#39; for the sake of being language runtime agnostic."}, {"owner": {"reputation": 1479, "user_id": 5991334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A4esy.png?s=128&g=1", "display_name": "highstakes", "link": "https://stackoverflow.com/users/5991334/highstakes"}, "edited": false, "score": 0, "creation_date": 1458825543, "post_id": 34677293, "comment_id": 60035623, "body": "@MPlatvoet would I have to re-configure kovenant with startKovenant() in every activity this way? Is doing this in the Application class only a bad idea? Thanks"}, {"owner": {"reputation": 1629, "user_id": 700848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0f335ffa8a58df3a2ab208b04002fba?s=128&d=identicon&r=PG&f=1", "display_name": "M Platvoet", "link": "https://stackoverflow.com/users/700848/m-platvoet"}, "edited": false, "score": 2, "creation_date": 1458828396, "post_id": 34677293, "comment_id": 60037577, "body": "You want to do this only once per application startup as this initialises the thread pools. So every place where you can guarantee this happens only once is a good place. You don&#39;t need to do this in every activity."}], "tags": [], "owner": {"reputation": 1629, "user_id": 700848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0f335ffa8a58df3a2ab208b04002fba?s=128&d=identicon&r=PG&f=1", "display_name": "M Platvoet", "link": "https://stackoverflow.com/users/700848/m-platvoet"}, "is_accepted": true, "score": 2, "last_activity_date": 1452256550, "creation_date": 1452256550, "answer_id": 34677293, "question_id": 34672514, "link": "https://stackoverflow.com/questions/34672514/kotlin-kovenant-succesui-on-wrong-thread/34677293#34677293", "title": "Kotlin kovenant succesUi on wrong thread?", "body": "<p>It's essential that you call <code>startKovenant()</code> (and <code>stopKovenant()</code>) on your MainActivity. This will setup Kovenant for use with Android by keeping threads alive and attaching the proper Dispatchers to the UI callbacks.</p>\n\n<p>So something like:</p>\n\n<pre><code>public class MainActivity : ... {\n    override fun onCreate(savedInstanceState: Bundle?) {\n        super.onCreate(savedInstanceState)\n        setContentView(...)\n\n        // Configure Kovenant with standard dispatchers\n        startKovenant()\n\n    }\n\n    ...\n\n    override fun onDestroy() {\n        stopKovenant()\n        super.onDestroy()\n    }\n}\n</code></pre>\n\n<p>More on this topic can be found in the <a href=\"http://kovenant.komponents.nl/android/config/\" rel=\"nofollow\">Android configuration documentation</a>  </p>\n"}], "owner": {"reputation": 6830, "user_id": 1332872, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/M03y5.jpg?s=128&g=1", "display_name": "ssuukk", "link": "https://stackoverflow.com/users/1332872/ssuukk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "accepted_answer_id": 34677293, "answer_count": 1, "score": 2, "last_activity_date": 1452256550, "creation_date": 1452241707, "last_edit_date": 1452243313, "question_id": 34672514, "link": "https://stackoverflow.com/questions/34672514/kotlin-kovenant-succesui-on-wrong-thread", "title": "Kotlin kovenant succesUi on wrong thread?", "body": "<p>I have a strange problem with Kovenant. Either I don't understand something o there's some bug. Below code is a simple <code>task { } successUi { }</code> for Android. Yet <code>succesUi</code> generates  <code>android.view.ViewRootImpl$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views.</code>, when cheking thread name it is:<code>kovenant-callback-2</code>, not main thread <code>iv</code> is <code>ImageView</code>. </p>\n\n<pre><code>    val promesa1 = task {\n        val nazwa = Thread.currentThread().name\n        print(nazwa)\n    } successUi {\n        val nazwa = Thread.currentThread().name\n        print(nazwa)\n\n        try {\n            iv!!.setImageBitmap(null)\n        } catch (ex : Exception) {\n            print(\"Mamy:\"+ex.toString())\n        }\n    }\n</code></pre>\n"}, {"tags": ["kotlin"], "answers": [{"tags": [], "owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "is_accepted": false, "score": 4, "last_activity_date": 1452242655, "creation_date": 1452242655, "answer_id": 34672755, "question_id": 34670692, "link": "https://stackoverflow.com/questions/34670692/can-we-define-our-accessors-without-an-init-value/34672755#34672755", "title": "Can we define our accessors without an init value?", "body": "<p>If you declare a property with a backing field, you need to initialize it. If you don't want do initialize it, you can declare custom getters and setters.</p>\n\n<pre><code>var item: String\n    get() = \"my String\"\n    set(value) {\n        log(value)\n        //do something with value\n    }\n</code></pre>\n\n<p>If you don't have a value to initialize the property with, declare it nullable and initialize it with <code>null</code></p>\n\n<pre><code>var item: String? = null\n    get() = field\n    set(value) {\n        field = value\n        //do something with value\n    }\n</code></pre>\n\n<p>If this doesn't match your requirements, please update the question to clarify.</p>\n"}], "owner": {"reputation": 338, "user_id": 1453345, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/48cba601d02383b98c71c6c1e24e86a8?s=128&d=identicon&r=PG", "display_name": "user1453345", "link": "https://stackoverflow.com/users/1453345/user1453345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1452485550, "creation_date": 1452234020, "last_edit_date": 1452485550, "question_id": 34670692, "link": "https://stackoverflow.com/questions/34670692/can-we-define-our-accessors-without-an-init-value", "title": "Can we define our accessors without an init value?", "body": "<p>I want to define my own accessor for a field, like this:</p>\n\n<pre><code>var item: Item\n    get() {...}\n    set(value) {...}\n</code></pre>\n\n<p>I get an error because item is not initialized. I cant add lateinit because I define the get and set methods.</p>\n\n<p>What I can choose is to declare another nullable field, and use that field to implement the item accessors, which is too stupid and redundant.</p>\n\n<p>So I guess there must other ways to implement this requirement...</p>\n\n<hr>\n\n<p>update:</p>\n\n<p>Thanks for you reply.\nI think I didnt express it clearly. And After I read the doc multiple times, I think the answer is NO.</p>\n\n<p>My requirement is: Is there an easier alternative way to declare this?</p>\n\n<pre><code>private var _table: Map&lt;String, Int&gt;? = null\npublic val table: Map&lt;String, Int&gt;\n    get() {\n      if (_table == null)\n        _table = HashMap() // Type parameters are inferred\n      return _table ?: throw AssertionError(\"Set to null by another thread\")\n    }\n</code></pre>\n\n<p>We have to declare a nullabe backing property so we can customize accessors and also leave the field uninitialized.</p>\n"}, {"tags": ["kotlin", "spark-java"], "answers": [{"comments": [{"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 1, "creation_date": 1452249950, "post_id": 34668975, "comment_id": 57095108, "body": "that&#39;s what i ended up using for Spark. Works great, the code overhead is tiny comparing to the size of the calls."}], "tags": [], "owner": {"reputation": 4169, "user_id": 341772, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/250b3c601cbd646bece3d2464b024488?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/341772/max"}, "is_accepted": false, "score": 2, "last_activity_date": 1452283595, "last_edit_date": 1452283595, "creation_date": 1452223267, "answer_id": 34668975, "question_id": 34668933, "link": "https://stackoverflow.com/questions/34668933/explicitly-returning-from-lambda-expression-in-kotlin/34668975#34668975", "title": "Explicitly returning from lambda expression in Kotlin", "body": "<p>I've found that this seems to work, though it's a little more verbose:</p>\n\n<pre><code>post(\"/auth/login\", fun(req, res): Any? {\n    val body = parseBody(req.body())\n    val assertion = body[\"assertion\"]\n    if (assertion == null) {\n        halt(400)\n        return null\n    }\n    // ...snip...lots more code\n    return null // or whatever\n})\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4169, "user_id": 341772, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/250b3c601cbd646bece3d2464b024488?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/341772/max"}, "edited": false, "score": 1, "creation_date": 1452234720, "post_id": 34670578, "comment_id": 57087070, "body": "Thanks, this is what I was looking for. I had a sneaking suspicion the <code>return@</code> pattern would be involved...anyway, I found further docs here: <a href=\"https://kotlinlang.org/docs/reference/returns.html#return-at-labels\" rel=\"nofollow noreferrer\">kotlinlang.org/docs/reference/returns.html#return-at-labels</a> (the second example in particular is relevant)."}], "tags": [], "owner": {"reputation": 338, "user_id": 1453345, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/48cba601d02383b98c71c6c1e24e86a8?s=128&d=identicon&r=PG", "display_name": "user1453345", "link": "https://stackoverflow.com/users/1453345/user1453345"}, "is_accepted": true, "score": 8, "last_activity_date": 1452233520, "creation_date": 1452233520, "answer_id": 34670578, "question_id": 34668933, "link": "https://stackoverflow.com/questions/34668933/explicitly-returning-from-lambda-expression-in-kotlin/34670578#34670578", "title": "Explicitly returning from lambda expression in Kotlin", "body": "<p>In my understanding, Lambda cant use return, return is for the function by default.</p>\n\n<p>So you need to use a label to tell the return clause where it will return to.\nI use this:</p>\n\n<pre><code>f@ {\n ...\n return@f null\n}\n</code></pre>\n"}], "owner": {"reputation": 4169, "user_id": 341772, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/250b3c601cbd646bece3d2464b024488?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/341772/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1433, "favorite_count": 0, "accepted_answer_id": 34670578, "answer_count": 2, "score": 2, "last_activity_date": 1452283634, "creation_date": 1452222854, "last_edit_date": 1452283634, "question_id": 34668933, "link": "https://stackoverflow.com/questions/34668933/explicitly-returning-from-lambda-expression-in-kotlin", "title": "Explicitly returning from lambda expression in Kotlin", "body": "<p>Using <a href=\"http://sparkjava.com/\" rel=\"nofollow\">Spark</a>, I end up with a bit of code like this:</p>\n\n<pre><code>post(\"/auth/login\", { req, res -&gt;\n    val body = parseBody(req.body())\n    val assertion = body[\"assertion\"]\n    if (assertion == null) {\n        halt(400)\n        return null\n    }\n    // ...snip...lots more code\n})\n</code></pre>\n\n<p>Which works great, except...it doesn't compile -- I get <code>'return' is not allowed here</code>.</p>\n\n<p>I <em>could</em> put the remainder of the lambda in an <code>else</code> block, but I'd rather not in the interest of minimizing indentation.</p>\n\n<p>So how do I \"short circuit\" the lambda to return a null?</p>\n"}, {"tags": ["android", "kotlin"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 5760714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea073d29d84df3b6a5f3fb3efe91b122?s=128&d=identicon&r=PG&f=1", "display_name": "zhousongbai", "link": "https://stackoverflow.com/users/5760714/zhousongbai"}, "is_accepted": false, "score": 5, "last_activity_date": 1452248331, "last_edit_date": 1452248331, "creation_date": 1452223904, "answer_id": 34669037, "question_id": 34668533, "link": "https://stackoverflow.com/questions/34668533/null-overload-constructor/34669037#34669037", "title": "Null overload constructor", "body": "<pre><code>class Student {\n    var id: String? = null\n    var name: String? = null\n    var grade: String? = null\n\n    constructor(id: String, name: String) {\n        this.id=id\n        this.name=name\n    }\n\n    constructor(id: String, name: String, grade: String) : this(id, name) {\n        this.grade = grade\n    }\n}\n</code></pre>\n\n<p>or </p>\n\n<pre><code>class Student(var id: String?, var name: String?) {\n    var grade: String? = null\n\n    constructor(id: String, name: String, grade: String) : this(id, name) {\n        this.grade = grade\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 338, "user_id": 1453345, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/48cba601d02383b98c71c6c1e24e86a8?s=128&d=identicon&r=PG", "display_name": "user1453345", "link": "https://stackoverflow.com/users/1453345/user1453345"}, "edited": false, "score": 0, "creation_date": 1452234351, "post_id": 34669463, "comment_id": 57086917, "body": "By the way, when does this init block executed? After the constructor executed?"}, {"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "edited": false, "score": 0, "creation_date": 1452244189, "post_id": 34669463, "comment_id": 57091489, "body": "Yes. The code is executed in the order, it appears. Because the secondary constructor calls the primary constructor, it first get&#39;s executed, then the properties are initialized to <code>null</code>, then the <code>init</code> block runs and finally the code inside the secondary constructor runs."}], "tags": [], "owner": {"reputation": 1254, "user_id": 3362350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e4500858d24434055bd01b57bdc734f?s=128&d=identicon&r=PG", "display_name": "Jacob Zimmerman", "link": "https://stackoverflow.com/users/3362350/jacob-zimmerman"}, "is_accepted": false, "score": 1, "last_activity_date": 1452244166, "last_edit_date": 1452244166, "creation_date": 1452226992, "answer_id": 34669463, "question_id": 34668533, "link": "https://stackoverflow.com/questions/34668533/null-overload-constructor/34669463#34669463", "title": "Null overload constructor", "body": "<p>Or</p>\n\n<pre><code>class Student(id: String, name: String) {\n    var id: String? = null\n    var name: String? = null\n    var grade: String? = null\n\n    init {\n        this.id = id\n        this.name = name\n    }\n\n    constructor(id: String, name: String, grade: String) : this(id,name) {\n        this.grade = grade\n    }\n}\n</code></pre>\n\n<p>The init block is how you use parameters in the primary constructor, which must be done when they're not marked as vals or vars there.</p>\n\n<p>Said differently, since you didn't mark the parameters in your primary constructor (the parenthesis right next to the class name) as vals or vars, they weren't automatically assigned as properties. In order to use parameters in the primary constructor, especially those that don't get marked as vars and vals, you need an init block.</p>\n\n<p>I can't help but think that what you truly want is <em>this</em> though:</p>\n\n<pre><code>class Student (var id: String, var name: String, var grade: String? = null)\n</code></pre>\n\n<p>Maybe even changing them to vals instead of vars.</p>\n"}, {"comments": [{"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "reply_to_user": {"reputation": 371, "user_id": 4140467, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc04dc9b703b06b95a820dccf1ae5676?s=128&d=identicon&r=PG&f=1", "display_name": "borrom", "link": "https://stackoverflow.com/users/4140467/borrom"}, "edited": false, "score": 1, "creation_date": 1452244125, "post_id": 34672832, "comment_id": 57091464, "body": "Btw, are you sure, you need to declare the properties as <code>var</code>s? If you won&#39;t change them later, make them <code>val</code>s."}], "tags": [], "owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "is_accepted": true, "score": 4, "last_activity_date": 1452242956, "creation_date": 1452242956, "answer_id": 34672832, "question_id": 34668533, "link": "https://stackoverflow.com/questions/34668533/null-overload-constructor/34672832#34672832", "title": "Null overload constructor", "body": "<p>Besides the other answers, there's another way. Initialize the properties directly using the primary constructor parameters:</p>\n\n<pre><code>class Student(id: String, name: String) {\n\n    var id: String? = id\n    var name: String? = name\n    var grade: String? = null\n\n    constructor(id: String, name: String, grade: String) : this(id,name) {\n        this.grade = grade\n    }\n}\n</code></pre>\n\n<p>Note, since <code>id</code> and <code>name</code> are always initialized with a non-nullable value, you can omit the <code>?</code>. Apart from that, you can omit the secondary constructor using a default value in the primary constructor:</p>\n\n<pre><code>class Student(id: String, name: String, grade: String? = null) {\n\n    var id: String = id\n    var name: String = name\n    var grade: String? = grade\n\n}\n</code></pre>\n\n<p>But now we only have one constructor left, so we can pull the properties directly into the constructor:</p>\n\n<pre><code>class Student(\n        var id: String,\n        var name: String, \n        var grade: String? = null\n)\n</code></pre>\n\n<p>Because the body of the class is now empty, I also omitted the curly braces.</p>\n"}], "owner": {"reputation": 371, "user_id": 4140467, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc04dc9b703b06b95a820dccf1ae5676?s=128&d=identicon&r=PG&f=1", "display_name": "borrom", "link": "https://stackoverflow.com/users/4140467/borrom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 1, "accepted_answer_id": 34672832, "answer_count": 3, "score": 1, "last_activity_date": 1452248331, "creation_date": 1452220119, "question_id": 34668533, "link": "https://stackoverflow.com/questions/34668533/null-overload-constructor", "title": "Null overload constructor", "body": "<p>I have the following class.</p>\n\n<pre><code>class Student(id: String, name: String) {\n\n    var id: String? = null\n    var name: String? = null\n    var grade: String? = null\n\n    constructor(id: String, name: String, grade: String) : this(id,name) {\n        this.grade = grade\n    }\n}\n</code></pre>\n\n<p>Use:</p>\n\n<pre><code>  var student = Student(\"AB001\",\"Smith\",\"N/A\")\n\n  prinln(student.id + student.name + student.grade)\n</code></pre>\n\n<p>Output: </p>\n\n<p>nullnullN/A</p>\n\n<p>Can anyone explains why I get the output null from default constructor?</p>\n"}, {"tags": ["android", "android-intent", "kotlin"], "comments": [{"owner": {"reputation": 3449, "user_id": 4044787, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/y219o.jpg?s=128&g=1", "display_name": "Randyka Yudhistira", "link": "https://stackoverflow.com/users/4044787/randyka-yudhistira"}, "edited": false, "score": 0, "creation_date": 1452219246, "post_id": 34668267, "comment_id": 57082642, "body": "is that java? what programming language do you use?"}, {"owner": {"reputation": 1068, "user_id": 5001783, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/230287aac1a68f46cd17669339c9ac20?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/5001783/user"}, "reply_to_user": {"reputation": 3449, "user_id": 4044787, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/y219o.jpg?s=128&g=1", "display_name": "Randyka Yudhistira", "link": "https://stackoverflow.com/users/4044787/randyka-yudhistira"}, "edited": false, "score": 3, "creation_date": 1452219342, "post_id": 34668267, "comment_id": 57082667, "body": "This is kotlin (swift for android)"}], "owner": {"reputation": 1068, "user_id": 5001783, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/230287aac1a68f46cd17669339c9ac20?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/5001783/user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 835, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1452248918, "creation_date": 1452217976, "last_edit_date": 1452248918, "question_id": 34668267, "link": "https://stackoverflow.com/questions/34668267/broadcast-receiver-in-application-class-android", "title": "Broadcast Receiver in Application class android", "body": "<p>I am registering <code>BroadcastReceiver</code> in application class and its register method is getting called and completed successfully without issue during application start. I am sending a broadcast from the module. I can print the action, it is there. But the app is not catching the broadcast. I don't know where I am doing wrong.</p>\n\n<p>Below is the method to register receiver.</p>\n\n<pre><code>fun registerRecordingDataReceiver () {\n    info(\"AppReceiver register called=&gt;${CommonsDataVars.TEMPERATURE.action()}\")\n    val temperatureCompleted = CommonsDataVars.TEMPERATURE.action()\n    val temperatureCompletedIntentFilter = IntentFilter(temperatureCompleted)\n    val broadcastManager = LocalBroadcastManager.getInstance(this)\n    broadcastManager.registerReceiver(appReceiver,temperatureCompletedIntentFilter)\n    info(\"AppREceiver register completed\")\n}\n</code></pre>\n\n<p>Part of Broadcast Receiver</p>\n\n<pre><code>override fun onReceive(context: Context?, intent: Intent?) {\nval action = intent?.getAction()\ndebug(\"Action in App Receiver =&gt;\"+action)\nif (action == CommonsDataVars.TEMPERATURE.action()) {\n    info(\"AppReceiver****************************************\")\n</code></pre>\n\n<p>sendBroadcast part:</p>\n\n<pre><code>info(\"TEMPERATURE register called=&gt;${CommonsDataVars.TEMPERATURE.action()}\")\nval intent = Intent()\nintent.setAction(CommonsDataVars.TEMPERATURE.action())\n//intent.putExtra(CommonsDataVars.TEMPERATURE.name, temperatureData)\nLocalBroadcastManager.getInstance(this).sendBroadcast(intent)\n</code></pre>\n"}, {"tags": ["java", "lambda", "interop", "kotlin", "higher-order-functions"], "comments": [{"owner": {"reputation": 847, "user_id": 1480495, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qNr9j.png?s=128&g=1", "display_name": "Connor Spencer Harries", "link": "https://stackoverflow.com/users/1480495/connor-spencer-harries"}, "edited": false, "score": 0, "creation_date": 1452199028, "post_id": 34664269, "comment_id": 57074896, "body": "What version of kotlin are you using so I can try expand upon my answer? :)"}, {"owner": {"reputation": 12952, "user_id": 2398375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1a5530da29f23682b10bb5568076f83d?s=128&d=identicon&r=PG", "display_name": "Dioxin", "link": "https://stackoverflow.com/users/2398375/dioxin"}, "reply_to_user": {"reputation": 847, "user_id": 1480495, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qNr9j.png?s=128&g=1", "display_name": "Connor Spencer Harries", "link": "https://stackoverflow.com/users/1480495/connor-spencer-harries"}, "edited": false, "score": 0, "creation_date": 1452205255, "post_id": 34664269, "comment_id": 57078222, "body": "@ConnorSpencerHarries How do I check? I know my version isn&#39;t the most current, I&#39;ve been having problems installing the newest update via IDEA, so I figured I&#39;d let it ride til I bumped into a problem"}, {"owner": {"reputation": 847, "user_id": 1480495, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qNr9j.png?s=128&g=1", "display_name": "Connor Spencer Harries", "link": "https://stackoverflow.com/users/1480495/connor-spencer-harries"}, "edited": false, "score": 0, "creation_date": 1452215126, "post_id": 34664269, "comment_id": 57081608, "body": "If you open your module settings (right click your project in the project explorer) you should see a &quot;Libraries&quot; button, hit that and you should see the version of the Kotlin runtime you&#39;re using, IntelliJ may try to use the same version for compiling if you are not using Maven or a similar tool."}, {"owner": {"reputation": 12952, "user_id": 2398375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1a5530da29f23682b10bb5568076f83d?s=128&d=identicon&r=PG", "display_name": "Dioxin", "link": "https://stackoverflow.com/users/2398375/dioxin"}, "reply_to_user": {"reputation": 847, "user_id": 1480495, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qNr9j.png?s=128&g=1", "display_name": "Connor Spencer Harries", "link": "https://stackoverflow.com/users/1480495/connor-spencer-harries"}, "edited": false, "score": 0, "creation_date": 1452365311, "post_id": 34664269, "comment_id": 57141102, "body": "@ConnorSpencerHarries It doesn&#39;t specify the version (<a href=\"https://gyazo.com/149e2a3afec89fd5df58a19362552486\" rel=\"nofollow noreferrer\">picture</a>). I checked there before asking :s Do you think it has to do with my other project not depending on the Kotlin library? It seems like it would be a reason, but it&#39;s strange how using things such as <code>kotlin.Boolean</code> works just fine without the dependency. The environment I&#39;m working in does not support external dependencies"}], "answers": [{"comments": [{"owner": {"reputation": 25812, "user_id": 288456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf294ff6d86cc587dec43e2af34a9532?s=128&d=identicon&r=PG", "display_name": "Alexander Udalov", "link": "https://stackoverflow.com/users/288456/alexander-udalov"}, "edited": false, "score": 1, "creation_date": 1452202289, "post_id": 34664569, "comment_id": 57076802, "body": "Kotlin sources are not compiled to Java, they&#39;re compiled to JVM bytecode directly (as Java sources are)"}, {"owner": {"reputation": 847, "user_id": 1480495, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qNr9j.png?s=128&g=1", "display_name": "Connor Spencer Harries", "link": "https://stackoverflow.com/users/1480495/connor-spencer-harries"}, "reply_to_user": {"reputation": 25812, "user_id": 288456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf294ff6d86cc587dec43e2af34a9532?s=128&d=identicon&r=PG", "display_name": "Alexander Udalov", "link": "https://stackoverflow.com/users/288456/alexander-udalov"}, "edited": false, "score": 0, "creation_date": 1452202748, "post_id": 34664569, "comment_id": 57077027, "body": "I know, I just worded it like that for the sake of digestibility."}], "tags": [], "owner": {"reputation": 847, "user_id": 1480495, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qNr9j.png?s=128&g=1", "display_name": "Connor Spencer Harries", "link": "https://stackoverflow.com/users/1480495/connor-spencer-harries"}, "is_accepted": false, "score": 3, "last_activity_date": 1452198973, "last_edit_date": 1452198973, "creation_date": 1452198613, "answer_id": 34664569, "question_id": 34664269, "link": "https://stackoverflow.com/questions/34664269/kotlins-higher-order-functions-in-java-project/34664569#34664569", "title": "Kotlin&#39;s Higher-Order Functions in Java project", "body": "<p>I threw your code into a module in my project and it built just fine, though this may be a side effect of me using multiple modules as the kotlin is <em>always</em> compiled to java before the java projects can touch it.</p>\n\n<pre><code>[INFO] ------------------------------------------------------------------------\n[INFO] Reactor Summary:\n[INFO] \n[INFO] mesh-parent ....................................... SUCCESS [1.718s]\n[INFO] mesh-common ....................................... SUCCESS [13.141s]\n[INFO] mesh-controller ................................... SUCCESS [8.217s]\n[INFO] java-so-project ................................... SUCCESS [1.121s]\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD SUCCESS\n[INFO] ------------------------------------------------------------------------\n[INFO] Total time: 24.558s\n[INFO] Finished at: Thu Jan 07 20:21:30 GMT 2016\n[INFO] Final Memory: 55M/341M\n[INFO] ------------------------------------------------------------------------\n\nProcess finished with exit code 0\n</code></pre>\n\n<p>If you are using maven (with mixed kotlin and java in a single module) then you may be required to add the following to your POM:</p>\n\n<pre><code>&lt;plugin&gt;\n    &lt;artifactId&gt;kotlin-maven-plugin&lt;/artifactId&gt;\n    &lt;groupId&gt;org.jetbrains.kotlin&lt;/groupId&gt;\n    &lt;version&gt;${kotlin.version}&lt;/version&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;phase&gt;process-sources&lt;/phase&gt;\n            &lt;goals&gt; \n                &lt;goal&gt;compile&lt;/goal&gt;\n            &lt;/goals&gt;\n        &lt;/execution&gt;\n        &lt;execution&gt;\n            &lt;phase&gt;process-test-sources&lt;/phase&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;test-compile&lt;/goal&gt;\n            &lt;/goals&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n&lt;/plugin&gt;\n</code></pre>\n\n<p><strike>I'm not sure if such a solution exists for gradle.</strike> If you don't use a dependency manager then you should be able to work around this by invoking the kotlin compiler and then <code>javac</code>.</p>\n\n<p>Without the workarounds mentioned I couldn't compile it either.</p>\n\n<p><strong>Edit:</strong> It appears Gradle requires no workaround as demonstrated <a href=\"https://github.com/JetBrains/kotlin-examples/blob/master/gradle/mixed-java-kotlin-hello-world/src/main/java/demo/HelloWorld.java\" rel=\"nofollow\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 29817, "user_id": 462604, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7176c041527db5489a2181a0f87f57d9?s=128&d=identicon&r=PG", "display_name": "Jakob Bowyer", "link": "https://stackoverflow.com/users/462604/jakob-bowyer"}, "is_accepted": true, "score": 3, "last_activity_date": 1452204277, "creation_date": 1452204277, "answer_id": 34666021, "question_id": 34664269, "link": "https://stackoverflow.com/questions/34664269/kotlins-higher-order-functions-in-java-project/34666021#34666021", "title": "Kotlin&#39;s Higher-Order Functions in Java project", "body": "<p>Using the following code</p>\n\n<pre><code>fun doSomething(method: () -&gt; Boolean) = method()\n</code></pre>\n\n<p>And the following java</p>\n\n<pre><code>public class Test {\n    public static void main(String[] args) {\n        System.out.println(MainKt.doSomething(() -&gt; true));\n    }\n}\n</code></pre>\n\n<p>It works just fine.</p>\n"}], "owner": {"reputation": 12952, "user_id": 2398375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1a5530da29f23682b10bb5568076f83d?s=128&d=identicon&r=PG", "display_name": "Dioxin", "link": "https://stackoverflow.com/users/2398375/dioxin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 896, "favorite_count": 0, "accepted_answer_id": 34666021, "answer_count": 2, "score": 2, "last_activity_date": 1469056612, "creation_date": 1452197475, "question_id": 34664269, "link": "https://stackoverflow.com/questions/34664269/kotlins-higher-order-functions-in-java-project", "title": "Kotlin&#39;s Higher-Order Functions in Java project", "body": "<p>I have a function that has a function type as a formal parameter:</p>\n\n<pre><code>fun doSomething(code: () -&gt; Boolean) = false //package function in TestKt.class\n</code></pre>\n\n<p>I've tried calling it in Java, passing in a lambda:</p>\n\n<pre><code>//Java class, in Java project\nclass Demo {\n    public static void main(String[] args) {\n        TestKt.doSomething(() -&gt; false);\n    }\n}\n</code></pre>\n\n<p>But I get the error:</p>\n\n<blockquote>\n  <p>Cannot infer functional interface type</p>\n</blockquote>\n\n<p>It works when the Java class is in a Kotlin project, but not in a Java project. I haven't had problems with anything else while using classes from Kotlin in my Java project, such as using kotlin methods typed with <code>kotlin.Boolean</code> and working with <code>vararg</code> parameters.</p>\n\n<p><strong>Question</strong></p>\n\n<p>How do I properly call the <code>doSomething</code> function from a Java project?</p>\n"}, {"tags": ["java", "kotlin"], "comments": [{"owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "edited": false, "score": 0, "creation_date": 1452172033, "post_id": 34655332, "comment_id": 57056941, "body": "What are you trying to accomplish? There is no type that describes only instances of classes written in Kotlin."}, {"owner": {"reputation": 437, "user_id": 5725496, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/386fb553a85bbd158916b038438a3855?s=128&d=identicon&r=PG&f=1", "display_name": "pozklundw", "link": "https://stackoverflow.com/users/5725496/pozklundw"}, "reply_to_user": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "edited": false, "score": 0, "creation_date": 1452174644, "post_id": 34655332, "comment_id": 57058769, "body": "@yole I hope to know &quot;this&quot;&#39;s class"}, {"owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "edited": false, "score": 1, "creation_date": 1452177978, "post_id": 34655332, "comment_id": 57061252, "body": "You can <code>i.javaClass</code> to find out the class of any object."}, {"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1452184578, "post_id": 34655332, "comment_id": 57066148, "body": "please edit the question by incorporating the updates into it. In the current state it is unclear what you are trying to do"}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1452206581, "post_id": 34655332, "comment_id": 57078868, "body": "It would help if your example used better class names that aren&#39;t so short and similar."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1452207134, "post_id": 34655332, "comment_id": 57079091, "body": "This question is not useful WITHOUT KNOWING what you will do with the instance that is being received.  You give no indication of what method <code>m()</code> does with the instance it receives.  Without that you leave everyone guessing as to the intent."}], "answers": [{"comments": [{"owner": {"reputation": 437, "user_id": 5725496, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/386fb553a85bbd158916b038438a3855?s=128&d=identicon&r=PG&f=1", "display_name": "pozklundw", "link": "https://stackoverflow.com/users/5725496/pozklundw"}, "edited": false, "score": 0, "creation_date": 1452177384, "post_id": 34657286, "comment_id": 57060843, "body": "no, as what &quot;update&quot; say, this way may thing more complex"}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1452207409, "post_id": 34657286, "comment_id": 57079217, "body": "instead of updates, rewrite the question to be clear.  we don&#39;t need revision history in the question, it is hard to follow.  Just create a more complete sample code."}], "tags": [], "owner": {"reputation": 641, "user_id": 5479247, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AC0-V9DmUv4/AAAAAAAAAAI/AAAAAAAAFc0/7D0Qqwhjgbg/photo.jpg?sz=128", "display_name": "Eugene Krivenja", "link": "https://stackoverflow.com/users/5479247/eugene-krivenja"}, "is_accepted": false, "score": 1, "last_activity_date": 1452175934, "creation_date": 1452175934, "answer_id": 34657286, "question_id": 34655332, "link": "https://stackoverflow.com/questions/34655332/how-to-pass-kotlin-class-or-kotlin-class-instance-as-arguments/34657286#34657286", "title": "How to pass kotlin class or kotlin class instance as arguments", "body": "<p>Is this what are you looking for?</p>\n\n<pre><code>interface MyKotlin\nclass Ex {\n  fun m(i: MyKotlin) {\n  }\n}\nclass Ex2 : MyKotlin {\n  fun m2() {\n    Ex().m(this)\n  }\n}\nclass Ex3 : MyKotlin {\n  fun m3() {\n    Ex().m(this)\n  }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "is_accepted": true, "score": 2, "last_activity_date": 1452190371, "creation_date": 1452190371, "answer_id": 34662258, "question_id": 34655332, "link": "https://stackoverflow.com/questions/34655332/how-to-pass-kotlin-class-or-kotlin-class-instance-as-arguments/34662258#34662258", "title": "How to pass kotlin class or kotlin class instance as arguments", "body": "<p>You can make use of <a href=\"https://kotlinlang.org/docs/reference/inline-functions.html#reified-type-parameters\" rel=\"nofollow\"><strong>reified type parameters</strong></a> like so:</p>\n\n<pre><code>class Ex() {\n    inline fun &lt;reified T&gt; m() {\n        println(T::class)\n    }\n}\n\nclass Ex2() {\n    fun m2() {\n        Ex().m&lt;Ex2&gt;()\n    }\n}\n</code></pre>\n\n<p>Now <code>Ex2().m2()</code> will print <code>class Ex2</code></p>\n"}], "owner": {"reputation": 437, "user_id": 5725496, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/386fb553a85bbd158916b038438a3855?s=128&d=identicon&r=PG&f=1", "display_name": "pozklundw", "link": "https://stackoverflow.com/users/5725496/pozklundw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11864, "favorite_count": 0, "accepted_answer_id": 34662258, "answer_count": 2, "score": 4, "last_activity_date": 1452190371, "creation_date": 1452170274, "last_edit_date": 1452170683, "question_id": 34655332, "link": "https://stackoverflow.com/questions/34655332/how-to-pass-kotlin-class-or-kotlin-class-instance-as-arguments", "title": "How to pass kotlin class or kotlin class instance as arguments", "body": "<p>see following code:</p>\n\n<pre><code>class Ex() {\n    fun m(i: Object) {\n    }\n}\n\nclass Ex2() {\n    fun m2() {\n        Ex().m(this)\n    }    \n}\n</code></pre>\n\n<p>How to make Ex#m receive Ex2 instance, I now can pass this.javaClass as arguments, but it's too trouble, what is \"this\"'s Class</p>\n\n<p><strong>update</strong></p>\n\n<p>change <code>fun m(i: Object)</code> to <code>fun m(i: Ex2)</code> can fix current example, but I hope KotlinObjectClass to make Ex#m receive variable type argument</p>\n\n<p><strong>update</strong>\nuse <code>Any</code> can fix \"variable type\" question, but I hope more exactly, I hope receive type only KotlinClassObjectInstance</p>\n"}, {"tags": ["java", "kotlin"], "comments": [{"owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "edited": false, "score": 0, "creation_date": 1452167414, "post_id": 34652934, "comment_id": 57053862, "body": "What are you trying to accomplish?"}], "answers": [{"tags": [], "owner": {"reputation": 641, "user_id": 5479247, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AC0-V9DmUv4/AAAAAAAAAAI/AAAAAAAAFc0/7D0Qqwhjgbg/photo.jpg?sz=128", "display_name": "Eugene Krivenja", "link": "https://stackoverflow.com/users/5479247/eugene-krivenja"}, "is_accepted": false, "score": 4, "last_activity_date": 1452167818, "last_edit_date": 1452167818, "creation_date": 1452166661, "answer_id": 34654192, "question_id": 34652934, "link": "https://stackoverflow.com/questions/34652934/how-to-get-current-class-filename-in-kotlin/34654192#34654192", "title": "How to get current class filename in kotlin", "body": "<p>As a workaround, put <code>main</code> method into companion object.<br>\nThis code will show a same path as your Java code:</p>\n\n<pre><code>class ExKt {\n  companion object {\n    @JvmStatic fun main(args: Array&lt;String&gt;) {\n        val path = ExKt::class.java.protectionDomain.codeSource.location.path\n        println(\"Kotlin: \" + path)\n    }\n  }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "edited": false, "score": 1, "creation_date": 1452172304, "post_id": 34654918, "comment_id": 57057144, "body": "It&#39;s nice that this code solves your problem, but it isn&#39;t an answer to your original question. This code returns the name of the Java class, not the name of the file from which it was compiled."}, {"owner": {"reputation": 641, "user_id": 5479247, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AC0-V9DmUv4/AAAAAAAAAAI/AAAAAAAAFc0/7D0Qqwhjgbg/photo.jpg?sz=128", "display_name": "Eugene Krivenja", "link": "https://stackoverflow.com/users/5479247/eugene-krivenja"}, "reply_to_user": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "edited": false, "score": 0, "creation_date": 1452175078, "post_id": 34654918, "comment_id": 57059100, "body": "Agree with @yole, additionally you could call <code>Ex::class.java.simpleName</code> directly from the <code>main</code>, creating a <code>Ex</code> instance doesn&#39;t make sense there."}], "tags": [], "owner": {"reputation": 437, "user_id": 5725496, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/386fb553a85bbd158916b038438a3855?s=128&d=identicon&r=PG&f=1", "display_name": "pozklundw", "link": "https://stackoverflow.com/users/5725496/pozklundw"}, "is_accepted": true, "score": -6, "last_activity_date": 1452169023, "creation_date": 1452169023, "answer_id": 34654918, "question_id": 34652934, "link": "https://stackoverflow.com/questions/34652934/how-to-get-current-class-filename-in-kotlin/34654918#34654918", "title": "How to get current class filename in kotlin", "body": "<p>The solution is:</p>\n\n<pre><code>class Ex() {\n    fun m() {\n        var p2 = Ex::class.java.simpleName\n        println(\"p2:${p2}\")\n    }\n}\n\nfun main(args: Array&lt;String&gt;) {\n    Ex().m()\n}\n</code></pre>\n"}], "owner": {"reputation": 437, "user_id": 5725496, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/386fb553a85bbd158916b038438a3855?s=128&d=identicon&r=PG&f=1", "display_name": "pozklundw", "link": "https://stackoverflow.com/users/5725496/pozklundw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4504, "favorite_count": 1, "accepted_answer_id": 34654918, "answer_count": 2, "score": 3, "last_activity_date": 1505853632, "creation_date": 1452162849, "last_edit_date": 1505853632, "question_id": 34652934, "link": "https://stackoverflow.com/questions/34652934/how-to-get-current-class-filename-in-kotlin", "title": "How to get current class filename in kotlin", "body": "<p>In Java I can use the following code:</p>\n\n<pre><code>public class Ex {\n    public static void main(String [ ] args) {\n        String path = Ex.class.getProtectionDomain().getCodeSource().getLocation().getPath();\n        String decodedPath = URLDecoder.decode(path, \"UTF-8\");\n    }\n}\n</code></pre>\n\n<p>but in Kotlin, the main function is defined outside out of a class. How can I get it's current file name?</p>\n"}, {"tags": ["generics", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1452163194, "post_id": 34649729, "comment_id": 57051028, "body": "not the first time one adds an extra <code>&lt;Type&gt;</code> and gets this. Can there be a warning about long generic class parameters&#39; names?"}, {"owner": {"reputation": 1327, "user_id": 250076, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f1dd635360e0d292a8190989cc4d21a?s=128&d=identicon&r=PG", "display_name": "Luna", "link": "https://stackoverflow.com/users/250076/luna"}, "reply_to_user": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1452173187, "post_id": 34649729, "comment_id": 57057762, "body": "@voddan What about a warning for generic parameter hiding a type?"}, {"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "reply_to_user": {"reputation": 1327, "user_id": 250076, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f1dd635360e0d292a8190989cc4d21a?s=128&d=identicon&r=PG", "display_name": "Luna", "link": "https://stackoverflow.com/users/250076/luna"}, "edited": false, "score": 0, "creation_date": 1452173312, "post_id": 34649729, "comment_id": 57057852, "body": "@RossAllan that would be even better, but it can go wrong if you mess up with imports"}], "tags": [], "owner": {"reputation": 29521, "user_id": 1950649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yb5YJ.jpg?s=128&g=1", "display_name": "Vladimir Mironov", "link": "https://stackoverflow.com/users/1950649/vladimir-mironov"}, "is_accepted": true, "score": 4, "last_activity_date": 1452157125, "last_edit_date": 1452157125, "creation_date": 1452152377, "answer_id": 34649729, "question_id": 34648938, "link": "https://stackoverflow.com/questions/34648938/generics-required-string-found-kotlin-string/34649729#34649729", "title": "Generics required String found kotlin.String", "body": "<p>In your case <code>String</code> is the name of a type parameter, not the standard <code>String</code> type, so the code from the question is equivalent to:</p>\n\n<pre><code>class CacheImpl&lt;T&gt; : Cache&lt;T&gt; {\n    override val NO_ENTRY_FOUND = CacheEntry&lt;T&gt;(value = \"not_found\", size = -1)\n}\n</code></pre>\n\n<p><code>CacheEntry</code> requires <code>T</code> for the first argument, but instead you've provided a <code>String</code>, thats why you see a compilation error. The fix is quite simple, you should just remove <code>String</code> from <code>CacheImpl</code> declaration:</p>\n\n<pre><code>class CacheImpl : Cache&lt;String&gt; {\n    override val NO_ENTRY_FOUND = CacheEntry&lt;String&gt;(value = \"not_found\", size = -1)\n}\n</code></pre>\n"}], "owner": {"reputation": 741, "user_id": 869497, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/070d85efd688d81a6aee4a780c9a5785?s=128&d=identicon&r=PG", "display_name": "Diemex", "link": "https://stackoverflow.com/users/869497/diemex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1737, "favorite_count": 1, "accepted_answer_id": 34649729, "answer_count": 1, "score": 2, "last_activity_date": 1505853648, "creation_date": 1452149317, "last_edit_date": 1505853648, "question_id": 34648938, "link": "https://stackoverflow.com/questions/34648938/generics-required-string-found-kotlin-string", "title": "Generics required String found kotlin.String", "body": "<pre><code>class CacheEntry&lt;T&gt;(val value: T, val size: Long)\n\ninterface Cache&lt;T&gt;{\n    val NO_ENTRY_FOUND : CacheEntry&lt;T&gt;\n}\n\nclass CacheImpl&lt;String&gt; : Cache&lt;String&gt;{\n    override val NO_ENTRY_FOUND =  CacheEntry&lt;String&gt;(value = \"not_found\", size = -1)\n}\n</code></pre>\n\n<p>I get this error:</p>\n\n<blockquote>\n  <p>Error:(12, 65) Gradle: Type mismatch: inferred type is kotlin.String but String was expected</p>\n</blockquote>\n\n<p>I can't understand why this doesn't work.</p>\n"}]