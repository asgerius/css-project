[{"tags": ["android", "android-support-library", "kotlin", "android-annotations"], "answers": [{"comments": [{"owner": {"reputation": 2559, "user_id": 1368690, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/AZwSk.jpg?s=128&g=1", "display_name": "hamena314", "link": "https://stackoverflow.com/users/1368690/hamena314"}, "reply_to_user": {"reputation": 1888, "user_id": 5509575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f2debfe039604b4e24c7769935bca5?s=128&d=identicon&r=PG&f=1", "display_name": "Hack5", "link": "https://stackoverflow.com/users/5509575/hack5"}, "edited": false, "score": 0, "creation_date": 1515680569, "post_id": 40007498, "comment_id": 83399324, "body": "@Penn Care to explain why this is false?"}], "tags": [], "owner": {"reputation": 7338, "user_id": 2580791, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/153662ca67d074e1f699912003f82ae2?s=128&d=identicon&r=PG", "display_name": "Mike Laren", "link": "https://stackoverflow.com/users/2580791/mike-laren"}, "is_accepted": false, "score": 21, "last_activity_date": 1476303074, "creation_date": 1476303074, "answer_id": 40007498, "question_id": 40007365, "link": "https://stackoverflow.com/questions/40007365/requiresapi-vs-targetapi-android-annotations/40007498#40007498", "title": "RequiresApi vs TargetApi android annotations", "body": "<p>From the JavaDocs in <a href=\"https://developer.android.com/reference/android/support/annotation/RequiresApi.html\" rel=\"noreferrer\">https://developer.android.com/reference/android/support/annotation/RequiresApi.html</a>:</p>\n\n<blockquote>\n  <p>[@RequiresApi] This is similar in purpose to the older @TargetApi annotation, but more clearly expresses that this is a requirement on the caller, rather than being used to \"suppress\" warnings within the method that exceed the minSdkVersion.</p>\n</blockquote>\n\n<p>I suppose they're functionally equivalent but <code>@RequiresApi</code> seems to be newer and has a higher chance of being extended to include more functionality.</p>\n"}, {"tags": [], "owner": {"reputation": 3392, "user_id": 1507816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e12e580af408ce6291da93fc02724f7?s=128&d=identicon&r=PG", "display_name": "Jorge Aguilar", "link": "https://stackoverflow.com/users/1507816/jorge-aguilar"}, "is_accepted": false, "score": 37, "last_activity_date": 1476305558, "last_edit_date": 1592644375, "creation_date": 1476305558, "answer_id": 40008157, "question_id": 40007365, "link": "https://stackoverflow.com/questions/40007365/requiresapi-vs-targetapi-android-annotations/40008157#40008157", "title": "RequiresApi vs TargetApi android annotations", "body": "<p>Similar to what Mike said, as you can see in the documentation:</p>\n<blockquote>\n<p>Denotes that the annotated element should only be called on the given API level or higher.</p>\n<p>This is similar in purpose to the older @TargetApi annotation, but more clearly expresses that this is a requirement on the caller, rather than being used to &quot;suppress&quot; warnings within the method that exceed the minSdkVersion.</p>\n</blockquote>\n<p>As you can see here, this is actually enforcing the caller to verify the API that's been used when calling into this method, instead of just removing the warning from your IDE/LINT.</p>\n<p>You can compare this to the @NonNull or @Null annotations, they enforce that the caller can/can't send null values into the function.</p>\n"}, {"tags": [], "owner": {"reputation": 2400, "user_id": 6112685, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RAHsYhTeNC0/AAAAAAAAAAI/AAAAAAAAAsc/A5bLML9T638/photo.jpg?sz=128", "display_name": "Abhay", "link": "https://stackoverflow.com/users/6112685/abhay"}, "is_accepted": true, "score": 92, "last_activity_date": 1503155608, "creation_date": 1503155608, "answer_id": 45773141, "question_id": 40007365, "link": "https://stackoverflow.com/questions/40007365/requiresapi-vs-targetapi-android-annotations/45773141#45773141", "title": "RequiresApi vs TargetApi android annotations", "body": "<p><code>@RequiresApi</code> - Denotes that the annotated element should only be called on the given API level or higher. </p>\n\n<p><code>@TargetApi</code> - Indicates that Lint should treat this type as targeting a given API level, no matter what the project target is. </p>\n"}, {"comments": [{"owner": {"reputation": 16055, "user_id": 2914140, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Ik94c.jpg?s=128&g=1", "display_name": "CoolMind", "link": "https://stackoverflow.com/users/2914140/coolmind"}, "edited": false, "score": 0, "creation_date": 1566908463, "post_id": 47152813, "comment_id": 101796154, "body": "When I used <code>@RequiresApi</code>, AS underlined a method call with red and also a whole class as containing an error."}, {"owner": {"reputation": 670, "user_id": 5129938, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iCNwbvKucbM/AAAAAAAAAAI/AAAAAAAAABc/5CavMZl-b2Y/photo.jpg?sz=128", "display_name": "jeevan venugopal", "link": "https://stackoverflow.com/users/5129938/jeevan-venugopal"}, "reply_to_user": {"reputation": 16055, "user_id": 2914140, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Ik94c.jpg?s=128&g=1", "display_name": "CoolMind", "link": "https://stackoverflow.com/users/2914140/coolmind"}, "edited": false, "score": 0, "creation_date": 1566909071, "post_id": 47152813, "comment_id": 101796486, "body": "@CoolMind did you used &quot;@RequiresApi&quot; inside any method?"}, {"owner": {"reputation": 16055, "user_id": 2914140, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Ik94c.jpg?s=128&g=1", "display_name": "CoolMind", "link": "https://stackoverflow.com/users/2914140/coolmind"}, "edited": false, "score": 0, "creation_date": 1566909177, "post_id": 47152813, "comment_id": 101796551, "body": "No, I added it before a method, like <code>@TargetApi</code>."}, {"owner": {"reputation": 670, "user_id": 5129938, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iCNwbvKucbM/AAAAAAAAAAI/AAAAAAAAABc/5CavMZl-b2Y/photo.jpg?sz=128", "display_name": "jeevan venugopal", "link": "https://stackoverflow.com/users/5129938/jeevan-venugopal"}, "reply_to_user": {"reputation": 16055, "user_id": 2914140, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Ik94c.jpg?s=128&g=1", "display_name": "CoolMind", "link": "https://stackoverflow.com/users/2914140/coolmind"}, "edited": false, "score": 0, "creation_date": 1566909850, "post_id": 47152813, "comment_id": 101796957, "body": "@CoolMind try to use the &quot;@RequiresApi&quot; to the method you are calling from.  Or surround the call like this.   if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.*api_code*) { // your method name }"}, {"owner": {"reputation": 16055, "user_id": 2914140, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Ik94c.jpg?s=128&g=1", "display_name": "CoolMind", "link": "https://stackoverflow.com/users/2914140/coolmind"}, "edited": false, "score": 0, "creation_date": 1566910984, "post_id": 47152813, "comment_id": 101797679, "body": "Yes, <code>if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) {</code> works, but I already have it in the method. Thanks!"}], "tags": [], "owner": {"reputation": 670, "user_id": 5129938, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iCNwbvKucbM/AAAAAAAAAAI/AAAAAAAAABc/5CavMZl-b2Y/photo.jpg?sz=128", "display_name": "jeevan venugopal", "link": "https://stackoverflow.com/users/5129938/jeevan-venugopal"}, "is_accepted": false, "score": 5, "last_activity_date": 1510042074, "creation_date": 1510042074, "answer_id": 47152813, "question_id": 40007365, "link": "https://stackoverflow.com/questions/40007365/requiresapi-vs-targetapi-android-annotations/47152813#47152813", "title": "RequiresApi vs TargetApi android annotations", "body": "<p>Both of them are for handling feature added to new android API levels without affecting the other API levels.</p>\n\n<p><strong>RequiresApi</strong></p>\n\n<pre><code>@RequiresApi(api = Build.VERSION_CODES.*api_code*)\n</code></pre>\n\n<p>Here it says that the annotated element should only be called on the given API level or higher. The annotated element below the given API level won't call.</p>\n\n<p><strong>TargetApi</strong> </p>\n\n<pre><code>@TargetApi(Build.VERSION_CODES.*api_code*)\n</code></pre>\n\n<p>Indicates that Lint should treat this type as targeting a given API level, no matter what the project target is. Only meant for specified API level.\nWon't called on other API level. </p>\n"}, {"comments": [{"owner": {"reputation": 564, "user_id": 3373865, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/52Mg7.jpg?s=128&g=1", "display_name": "Anand Kumar Jha", "link": "https://stackoverflow.com/users/3373865/anand-kumar-jha"}, "edited": false, "score": 4, "creation_date": 1533990276, "post_id": 50578783, "comment_id": 90555631, "body": "I really found it more comprehensive and easy to understand rather than the other answers available on this page. Hence +1."}, {"owner": {"reputation": 331, "user_id": 7331042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74e00db96e0c89df5a5c55729dce57ac?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitriy Pavlukhin", "link": "https://stackoverflow.com/users/7331042/dmitriy-pavlukhin"}, "edited": false, "score": 3, "creation_date": 1556217395, "post_id": 50578783, "comment_id": 98372735, "body": "This is the only answer that explains theory+practice, it really should be accepted."}], "tags": [], "owner": {"reputation": 1071, "user_id": 5637606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tyfe9.jpg?s=128&g=1", "display_name": "ssynhtn", "link": "https://stackoverflow.com/users/5637606/ssynhtn"}, "is_accepted": false, "score": 53, "last_activity_date": 1527579227, "creation_date": 1527579227, "answer_id": 50578783, "question_id": 40007365, "link": "https://stackoverflow.com/questions/40007365/requiresapi-vs-targetapi-android-annotations/50578783#50578783", "title": "RequiresApi vs TargetApi android annotations", "body": "<p>I'll first assume your min api version is lower than the api you are going to call, because that's where these kind of annotations make any sense</p>\n\n<pre><code>@RequiresApi(Build.VERSION_CODES.N_MR1)\npublic void hello() { // codes that call system apis introduced in android N_MR1}\n</code></pre>\n\n<p>When a method is annotated with this, anytime you call that method, your receive a nice red warning that this call requires api version that is higher than your min api version, but it doesn't stop you from compiling and building your apk, it will just crash on lower versions of android as I tested it.</p>\n\n<pre><code>@TargetApi\n</code></pre>\n\n<p>This doesn't help at all, it suppress warnings of calling new apis in your method, but when you call this method from somewhere else, there is no lint warning at all, and you can still build and install your apk only to meet a crash when that method is called.</p>\n"}], "owner": {"reputation": 12683, "user_id": 273119, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/6b7f0d7d95b3a1f9547274129582b434?s=128&d=identicon&r=PG", "display_name": "Daniel Gomez Rico", "link": "https://stackoverflow.com/users/273119/daniel-gomez-rico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39703, "favorite_count": 19, "accepted_answer_id": 45773141, "answer_count": 5, "score": 100, "last_activity_date": 1527579227, "creation_date": 1476302570, "question_id": 40007365, "link": "https://stackoverflow.com/questions/40007365/requiresapi-vs-targetapi-android-annotations", "title": "RequiresApi vs TargetApi android annotations", "body": "<p>Whats the difference between <code>RequiresApi</code> and <code>TargetApi</code>?</p>\n\n<p>Sample in kotlin:</p>\n\n<pre><code>@RequiresApi(api = Build.VERSION_CODES.M)\n@TargetApi(Build.VERSION_CODES.M)\nclass FingerprintHandlerM() : FingerprintManager.AuthenticationCallback()\n</code></pre>\n\n<p><em>NOTE: <code>FingerprintManager.AuthenticationCallback</code> requires api <code>M</code></em></p>\n\n<p><em>NOTE 2: if I dont use TargetApi lint fail with error <code>class requires api level 23...</code></em></p>\n"}, {"tags": ["kotlin", "kotlin-extension"], "comments": [{"owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "edited": false, "score": 0, "creation_date": 1476308730, "post_id": 40006315, "comment_id": 67295919, "body": "Currently <code>withDefault</code> is intended to be used only in the property delegation scenario, it doesn&#39;t affect the return value of <code>get</code> function. See <a href=\"https://youtrack.jetbrains.com/issue/KT-11851\" rel=\"nofollow noreferrer\">KT-11851</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1083, "user_id": 2394661, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/S4QAg.jpg?s=128&g=1", "display_name": "martin treurnicht", "link": "https://stackoverflow.com/users/2394661/martin-treurnicht"}, "edited": false, "score": 0, "creation_date": 1476311899, "post_id": 40007473, "comment_id": 67297121, "body": "Thanks! this solves the issue i was having, i&#39;ll report it to the Kotlin Team"}, {"owner": {"reputation": 1083, "user_id": 2394661, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/S4QAg.jpg?s=128&g=1", "display_name": "martin treurnicht", "link": "https://stackoverflow.com/users/2394661/martin-treurnicht"}, "edited": false, "score": 0, "creation_date": 1476312485, "post_id": 40007473, "comment_id": 67297290, "body": "I&#39;ve simplified this to the basics, here is the github gist for anyone interested in using it <a href=\"https://gist.github.com/martintreurnicht/2906b2e1fbfc04d488fbf06219b0746e\" rel=\"nofollow noreferrer\">gist.github.com/martintreurnicht/&hellip;</a>"}, {"owner": {"reputation": 465, "user_id": 1289270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a994da122d7e9738111f18e189f3ec4f?s=128&d=identicon&r=PG", "display_name": "Kostas Filios", "link": "https://stackoverflow.com/users/1289270/kostas-filios"}, "edited": false, "score": 2, "creation_date": 1502826784, "post_id": 40007473, "comment_id": 78359253, "body": "Good solution in the gist. I would only argue against <code>getOrPut</code> because it has an unexpected side-effect: It writes back to the map just, thus making <code>get</code> non-idempotent. To put it differently, if you call <code>containsKey</code> before and after <code>getOrPut</code> you&#39;ll get different results. Same goes for <code>size()</code> and a big set of other methods. And this is expected. But it&#39;s not expected with <code>get</code> which I think should act idempotently. In my implementation I use <code>getOrDefault</code>."}], "tags": [], "owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "is_accepted": true, "score": 2, "last_activity_date": 1476302993, "creation_date": 1476302993, "answer_id": 40007473, "question_id": 40006315, "link": "https://stackoverflow.com/questions/40006315/not-nullable-mutable-map/40007473#40007473", "title": "Not nullable Mutable Map", "body": "<p>This looks like a bug to me. I recommend reporting it at <a href=\"https://youtrack.jetbrains.com/issues/KT\" rel=\"nofollow\">Kotlin (KT) | YouTrack</a>.</p>\n\n<p>One way to workaround it is by explicitly defining <code>set</code> on your <code>NonNullableMutableMap</code> interface. e.g.:</p>\n\n<pre><code>interface NonNullableMutableMap&lt;K, V&gt; : MutableMap&lt;K, V&gt; {\n    override fun put(key: K, value: V): V\n    override fun get(key: K): V\n    operator fun set(key: K, value: V) {\n        put(key, value)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "is_accepted": false, "score": 2, "last_activity_date": 1476309008, "creation_date": 1476309008, "answer_id": 40008955, "question_id": 40006315, "link": "https://stackoverflow.com/questions/40006315/not-nullable-mutable-map/40008955#40008955", "title": "Not nullable Mutable Map", "body": "<p>Regarding to the runtime error you get, there is currently a bug in how <code>+=</code> operator gets compiled for inline <code>MutableMap.set</code> extension function: <a href=\"https://youtrack.jetbrains.com/issue/KT-14227\" rel=\"nofollow\">https://youtrack.jetbrains.com/issue/KT-14227</a></p>\n\n<p>The workaround is not to use <code>+=</code>:</p>\n\n<pre><code>map[\"first\"] = map[\"first\"] + 10L\n</code></pre>\n"}], "owner": {"reputation": 1083, "user_id": 2394661, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/S4QAg.jpg?s=128&g=1", "display_name": "martin treurnicht", "link": "https://stackoverflow.com/users/2394661/martin-treurnicht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1144, "favorite_count": 0, "accepted_answer_id": 40007473, "answer_count": 2, "score": 2, "last_activity_date": 1476309008, "creation_date": 1476298583, "question_id": 40006315, "link": "https://stackoverflow.com/questions/40006315/not-nullable-mutable-map", "title": "Not nullable Mutable Map", "body": "<ul>\n<li>Java : <code>1.8.0_102</code></li>\n<li>Kotlin: <code>1.0.4</code></li>\n</ul>\n\n<p>I'm trying to create a map where you can do something like <code>map[\"key\"] += 5</code> similar to javascript.</p>\n\n<p>Kotlin already has <code>withDefault</code> that solves one part of this, but map's get function still returns a nullable value, so i proceeded to make my own implementation of this inspired by <code>withDefault</code></p>\n\n<pre><code>interface NonNullableMutableMap&lt;K,V&gt; : MutableMap&lt;K,V&gt; {\n  override fun put(key: K, value: V): V\n  override fun get(key: K): V\n}\n\nfun &lt;K,V&gt; MutableMap&lt;K,V&gt;.withoutNullValues(default: () -&gt; V): NonNullableMutableMap&lt;K, V&gt; {\n  return NonNullableMapWrapper(this, default)\n}\n\nclass NonNullableMapWrapper&lt;K,V&gt;(val map: MutableMap&lt;K,V&gt;, val default: () -&gt; V) : NonNullableMutableMap&lt;K,V&gt; {\n  override fun put(key: K, value: V): V = map.put(key, value) ?: default()\n\n  override fun get(key: K): V {\n      val value = map.getOrPut(key, default)\n      return value\n  }\n  override val size: Int get() = map.size\n\n  override fun containsKey(key: K): Boolean = map.containsKey(key)\n\n  override fun containsValue(value: V): Boolean = map.containsValue(value)\n\n  override fun isEmpty(): Boolean = map.isEmpty()\n\n  override val entries: MutableSet&lt;MutableMap.MutableEntry&lt;K, V&gt;&gt; get() = map.entries\n  override val keys: MutableSet&lt;K&gt; get() = map.keys\n  override val values: MutableCollection&lt;V&gt; get() = map.values\n\n  override fun clear() {\n      map.clear()\n  }\n\n  override fun putAll(from: Map&lt;out K, V&gt;) {\n    map.putAll(from)\n  }\n\n  override fun remove(key: K): V {\n    return map.remove(key) ?: default()\n  }\n}\n</code></pre>\n\n<p>I created the following unit test to test it</p>\n\n<pre><code>class NonNullableMapTest {\n\n  @Test\n  fun notNullableTest() {\n      val map = HashMap&lt;String, Long&gt;().withoutNullValues { 0 }\n      map[\"first\"] += 10L\n      map[\"second\"] -= 10L\n      assertThat(map[\"first\"]).isEqualTo(10L)\n      assertThat(map[\"second\"]).isEqualTo(-10L)\n      assertThat(map[\"third\"]).isEqualTo(0L)\n  }\n}\n</code></pre>\n\n<p>But i'm getting the following error when i run the test:</p>\n\n<pre><code>tried to access method kotlin.collections.MapsKt__MapsJVMKt.set(Ljava/util/Map;Ljava/lang/Object;Ljava/lang/Object;)V from class foo.bar.NonNullableMapTest\njava.lang.IllegalAccessError: tried to access method kotlin.collections.MapsKt__MapsJVMKt.set(Ljava/util/Map;Ljava/lang/Object;Ljava/lang/Object;)V from class foo.bar.NonNullableMapTest\n</code></pre>\n\n<p>Any idea how to resolve this issue?</p>\n"}, {"tags": ["android", "kotlin", "kodein"], "answers": [{"comments": [{"owner": {"reputation": 3731, "user_id": 2134962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/55f5fcc613a1bc28e7c4eb00a9d609f6?s=128&d=identicon&r=PG", "display_name": "david.schreiber", "link": "https://stackoverflow.com/users/2134962/david-schreiber"}, "edited": false, "score": 0, "creation_date": 1476367375, "post_id": 40022532, "comment_id": 67323380, "body": "I&#39;m using that approach in my unit tests, i.e. in tests that verify the correct behavior of injected classes. However, in my instrumentation, more specifically in my functional tests, I&#39;m testing an instance of my real application. To make tests deterministic, I replace certain dependencies in my graph with mocks. Kodein is provided by the <code>Application</code> instance, hence it is like &quot;the one true Kodein&quot;. I&#39;m testing a configurable kodein approach right now, and will come back once I have some results."}], "tags": [], "owner": {"reputation": 7879, "user_id": 1269640, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/41b92fffd289939497f29809d146c59d?s=128&d=identicon&r=PG", "display_name": "Salomon BRYS", "link": "https://stackoverflow.com/users/1269640/salomon-brys"}, "is_accepted": false, "score": 5, "last_activity_date": 1476365696, "creation_date": 1476365696, "answer_id": 40022532, "question_id": 40005768, "link": "https://stackoverflow.com/questions/40005768/how-to-inject-test-overrides-into-the-default-dependency-graph/40022532#40022532", "title": "How to inject test overrides into the default dependency graph?", "body": "<p>If your test is given a <code>Kodein</code> instance (meaning that it can use a different <code>Kodein</code> object than the one held by your <code>Application</code>), then the recommended approach is to create a new Kodein object that extends the one of the app and overrides all necessary bindings.</p>\n\n<pre><code>val testKodein = Kodein {\n    extend(appKodein())\n\n    bind&lt;MyManager&gt;(overrides = true) with singleton { mock&lt;MyManager&gt;() }\n}\n</code></pre>\n\n<p>The configurable Kodein option is recommended only if you're using a static \"one true Kodein\". Using it prevents the possibility to run you're tests in parallel (because they all access the same Kodein instance), and forces you to <code>clear</code> the <code>ConfigurableKodein</code> between each tests and re-declare every time different overrides.</p>\n"}, {"tags": [], "owner": {"reputation": 3731, "user_id": 2134962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/55f5fcc613a1bc28e7c4eb00a9d609f6?s=128&d=identicon&r=PG", "display_name": "david.schreiber", "link": "https://stackoverflow.com/users/2134962/david-schreiber"}, "is_accepted": true, "score": 5, "last_activity_date": 1476444455, "creation_date": 1476444455, "answer_id": 40042047, "question_id": 40005768, "link": "https://stackoverflow.com/questions/40005768/how-to-inject-test-overrides-into-the-default-dependency-graph/40042047#40042047", "title": "How to inject test overrides into the default dependency graph?", "body": "\n\n<p>I am now using the <code>ConfigurableKodein</code> inside my custom <code>App</code> class.</p>\n\n<pre><code>class App : Application(), KodeinAware {\n    override val kodein = ConfigurableKodein()\n\n    override fun onCreate() {\n        super.onCreate()\n\n        // A function is used to create a Kodein module with all app deps.\n        kodein.addImport(appDependencies(this))\n    }\n}\n\n// Helper for accessing the App from any context.\nfun Context.asApp() = this.applicationContext as App\n</code></pre>\n\n<p>Inside my <code>AppTestRunner</code> class, I declare the configuration to be mutable. That way I can reset it's configuration between each and every test.</p>\n\n<pre><code>class AppTestRunner : AndroidJUnitRunner() {\n    override fun callApplicationOnCreate(app: Application) {\n        app.asApp().kodein.mutable = true\n        super.callApplicationOnCreate(app)\n    }\n}\n</code></pre>\n\n<p>I have created a JUnit rule that reset the dependency graph before every test.</p>\n\n<pre><code>class ResetKodeinRule : ExternalResource() {\n    override fun before() {\n        val app = InstrumentationRegistry.getInstrumentation().targetContext.asApp()\n        app.kodein.clear()\n        app.kodein.addImport(appDependencies(app))\n    }\n}\n</code></pre>\n\n<p>In my tests I can now retrieve the <code>App.kodein</code> instance and inject mocks that override dependencies of the original graph. The only thing that needs to be guaranteed is that the tested activity is launched <em>after</em> configuring mocks, or behavior is not predictable.</p>\n"}], "owner": {"reputation": 3731, "user_id": 2134962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/55f5fcc613a1bc28e7c4eb00a9d609f6?s=128&d=identicon&r=PG", "display_name": "david.schreiber", "link": "https://stackoverflow.com/users/2134962/david-schreiber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1633, "favorite_count": 1, "accepted_answer_id": 40042047, "answer_count": 2, "score": 2, "last_activity_date": 1476444455, "creation_date": 1476296603, "question_id": 40005768, "link": "https://stackoverflow.com/questions/40005768/how-to-inject-test-overrides-into-the-default-dependency-graph", "title": "How to inject test overrides into the default dependency graph?", "body": "<p>I would like to inject mocked overrides into my Android instrumentation tests using Kodein. I don't know which is the optimal approach to do this. Here's what I have in mind:</p>\n\n<ul>\n<li>My app uses a <code>KodeinAware</code> application class. The served Kodein instance holds all dependencies required by my app. </li>\n<li>In my tests I would like to inject mocked overrides for specific dependencies to test behavior of the app in various situations. </li>\n<li>Overrides should be different for each test, and should be injected before/while the test runs. </li>\n</ul>\n\n<p>Is the <a href=\"https://salomonbrys.github.io/Kodein/#_configurable_kodein\" rel=\"nofollow\">configurable Kodein extension</a> sensible in this situation, or is there a simpler, better suited approach (and if so, which)?</p>\n"}, {"tags": ["kotlin", "kotlin-extension"], "comments": [{"owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "edited": false, "score": 0, "creation_date": 1476291748, "post_id": 40004168, "comment_id": 67286485, "body": "I don&#39;t think you can do this, as it would require you to be able to pass <code>a</code> to the function by reference."}, {"owner": {"reputation": 34634, "user_id": 2444099, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ad5Vz.jpg?s=128&g=1", "display_name": "Eugen Pechanec", "link": "https://stackoverflow.com/users/2444099/eugen-pechanec"}, "edited": false, "score": 0, "creation_date": 1476291877, "post_id": 40004168, "comment_id": 67286564, "body": "Variable a contains value false. You cannot change what the variable holds unless you call <code>a = somtehing</code>. This is not possible in Kotlin. Find another way."}], "answers": [{"tags": [], "owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "is_accepted": false, "score": 2, "last_activity_date": 1476292490, "creation_date": 1476292490, "answer_id": 40004574, "question_id": 40004168, "link": "https://stackoverflow.com/questions/40004168/modify-this-in-extension-function/40004574#40004574", "title": "Modify &quot;this&quot; in extension function", "body": "<p>You can not do this because it would require you to pass <code>a</code> to the function by reference. This is not possible in Kotlin. All function arguments in Kotlin are passed by value.</p>\n\n<p>However, you could simulate the behaviour using the following construct. It's not very convenient though.</p>\n\n<pre><code>fun Boolean.toggle(getter: () -&gt; Boolean, setter: (Boolean) -&gt; Unit) {\n    setter(!getter())\n}\n\nvar a = false\n\nprintln(a) // prints false\n\na.toggle({a}, {a = it}) \n// Or a.toggle(a::get, a::set), but that isn't supported (yet?)\n\nprintln(a) // prints true\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "is_accepted": false, "score": 2, "last_activity_date": 1476295633, "creation_date": 1476295633, "answer_id": 40005477, "question_id": 40004168, "link": "https://stackoverflow.com/questions/40004168/modify-this-in-extension-function/40005477#40005477", "title": "Modify &quot;this&quot; in extension function", "body": "<p>As any other parameter of a function, <code>this</code> is a reference to an object. On the other hand, <code>var a</code> is a reference to the same object too. So basically you have two references that point to the same instance:</p>\n\n<pre><code>var a = false\nval this = a  // a.toggle()\n</code></pre>\n\n<p>There is no manipulation you can do to one of those references and change the other. They are unrelated variables with the same value, nothing more.</p>\n\n<p>What you can do (in theory) is to make the object itself changeable:</p>\n\n<pre><code>class MutableBoolean(val value: Boolean)\n\nval a = MutableBoolean(false)\na.toggle()\n\nfun MutableBoolean.toggle() {value = !value}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "is_accepted": true, "score": 6, "last_activity_date": 1476301817, "creation_date": 1476301817, "answer_id": 40007140, "question_id": 40004168, "link": "https://stackoverflow.com/questions/40004168/modify-this-in-extension-function/40007140#40007140", "title": "Modify &quot;this&quot; in extension function", "body": "<p>References to variables aren't supported yet but you can create extension functions to use with <a href=\"https://kotlinlang.org/docs/reference/reflection.html#property-references\" rel=\"noreferrer\">property references</a>:</p>\n\n<pre><code>fun KMutableProperty0&lt;Boolean&gt;.not() = set(get().not())\nfun KMutableProperty0&lt;Int&gt;.inc() = set(get().inc())\n\nvar a = false\nvar b = 1\n\nfun main(vararg args: String) {\n    ::a.not()\n    // now `a` contains `true`\n    ::b.inc()\n    // now `b` contains `2`\n}\n</code></pre>\n\n<p>Or if you'd rather the extension functions return the new value along with setting it:</p>\n\n<pre><code>fun KMutableProperty0&lt;Boolean&gt;.not(): Boolean = get().not().apply(setter)\nfun KMutableProperty0&lt;Int&gt;.inc(): Int = get().inc().apply(setter)\n</code></pre>\n"}], "owner": {"reputation": 20852, "user_id": 544406, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/dPN4O.jpg?s=128&g=1", "display_name": "Dmitry Ryadnenko", "link": "https://stackoverflow.com/users/544406/dmitry-ryadnenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2420, "favorite_count": 1, "accepted_answer_id": 40007140, "answer_count": 3, "score": 12, "last_activity_date": 1476307379, "creation_date": 1476291188, "last_edit_date": 1476307379, "question_id": 40004168, "link": "https://stackoverflow.com/questions/40004168/modify-this-in-extension-function", "title": "Modify &quot;this&quot; in extension function", "body": "<p>I want to write extension function that modifies \"this\", for example:</p>\n\n<pre><code>var a = false\na.toggle() // now a contains false\n</code></pre>\n\n<p>or</p>\n\n<pre><code>var a = 1\na.increment() // now a contains 2\n</code></pre>\n\n<p>Is it possible in Kotlin?</p>\n\n<p>I can create extension function that returns modified value, but leaves \"this\" unmodified, but I want even more convenience! It looks like Swift can do that.</p>\n"}, {"tags": ["kotlin"], "comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1476209734, "post_id": 39983290, "comment_id": 67246503, "body": "you don&#39;t say what/why you are trying to avoid something.  what part of it do you not like?"}, {"owner": {"reputation": 19583, "user_id": 3026283, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/SyT5b.png?s=128&g=1", "display_name": "H&#233;ctor", "link": "https://stackoverflow.com/users/3026283/h%c3%a9ctor"}, "reply_to_user": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1476210001, "post_id": 39983290, "comment_id": 67246653, "body": "@JaysonMinard Actually, it is because I have started learning Kotlin and I&#39;d like to know if this kind of things are possible."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1476210062, "post_id": 39983290, "comment_id": 67246692, "body": "ok, then my answer below is the smallest syntax I&#39;m aware of..."}, {"owner": {"reputation": 19583, "user_id": 3026283, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/SyT5b.png?s=128&g=1", "display_name": "H&#233;ctor", "link": "https://stackoverflow.com/users/3026283/h%c3%a9ctor"}, "reply_to_user": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1476210153, "post_id": 39983290, "comment_id": 67246749, "body": "Accepted! Thanks again :)"}], "answers": [{"tags": [], "owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "is_accepted": true, "score": 8, "last_activity_date": 1476209560, "creation_date": 1476209560, "answer_id": 39983897, "question_id": 39983290, "link": "https://stackoverflow.com/questions/39983290/override-interface-property-with-constructor-parameter-with-different-name/39983897#39983897", "title": "Override interface property with constructor parameter with different name", "body": "<p>You can do what you want simply by removing <code>val</code> from the constructor parameter, so that it is a parameter and not a member.  Your final class would be:</p>\n\n\n\n<pre><code>class AnyUsernamePersistentNodePath(username: String) : AnyPersistenceNodePath {\n    override val key = \"username\"\n    override val value = username\n}\n</code></pre>\n\n<p>You cannot otherwise change the name of something that you are truly overriding.  But you can pass in the value to be assigned to a member later during construction, as my slightly modified version of your code shows.  </p>\n"}], "owner": {"reputation": 19583, "user_id": 3026283, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/SyT5b.png?s=128&g=1", "display_name": "H&#233;ctor", "link": "https://stackoverflow.com/users/3026283/h%c3%a9ctor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1248, "favorite_count": 0, "accepted_answer_id": 39983897, "answer_count": 1, "score": 8, "last_activity_date": 1476261775, "creation_date": 1476207461, "question_id": 39983290, "link": "https://stackoverflow.com/questions/39983290/override-interface-property-with-constructor-parameter-with-different-name", "title": "Override interface property with constructor parameter with different name", "body": "<p>I have this code:</p>\n\n<pre><code>class AnyUsernamePersistentNodePath(override val value: String) : AnyPersistenceNodePath {\n    override val key = \"username\"    \n}\n</code></pre>\n\n<p>and </p>\n\n<pre><code>interface AnyPersistenceNodePath {\n    val key: String\n    val value: String\n}\n</code></pre>\n\n<p>So far, so good. Now I want parameter <code>value</code> in the constructor to be named <code>username</code>, instead of <code>value</code>. But, obviously, keep overriding interface's property <code>value</code>. Is that possible in Kotlin?</p>\n\n<p>I know that I can do:</p>\n\n<pre><code>class AnyUsernamePersistentNodePath(val username: String) : AnyPersistenceNodePath {\n    override val key = \"username\"\n    override val value = username\n}\n</code></pre>\n\n<p>but I'd like to avoid it.</p>\n"}, {"tags": ["android", "android-studio", "gradle", "android-gradle-plugin", "kotlin"], "comments": [{"owner": {"reputation": 1052, "user_id": 2238023, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a92a99a6222b719e5b407e0ea6f7cac6?s=128&d=identicon&r=PG", "display_name": "Bryan Bryce", "link": "https://stackoverflow.com/users/2238023/bryan-bryce"}, "edited": false, "score": 0, "creation_date": 1476239204, "post_id": 39982618, "comment_id": 67257684, "body": "Does 2.2.1 fix it for you? How did you set up Kotlin in your project?"}], "answers": [{"comments": [{"owner": {"reputation": 537, "user_id": 2021745, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7af7d07389097c19d378ace2ad094ded?s=128&d=identicon&r=PG", "display_name": "rmgoncalo", "link": "https://stackoverflow.com/users/2021745/rmgoncalo"}, "edited": false, "score": 0, "creation_date": 1476453868, "post_id": 40013744, "comment_id": 67366218, "body": "I&#39;m using plugin 1.0.4 and importing kotlin 1.0.3, but I cannot update this last to 1.0.4 because of dependencies that still depend on version 1.0.3. But, as soon as these dependencies support 1.0.4, I&#39;ll do that and hope the bug is gone :) Thanks."}], "tags": [], "owner": {"reputation": 403, "user_id": 1447651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FS4yU.jpg?s=128&g=1", "display_name": "Deva", "link": "https://stackoverflow.com/users/1447651/deva"}, "is_accepted": false, "score": 1, "last_activity_date": 1476340008, "creation_date": 1476340008, "answer_id": 40013744, "question_id": 39982618, "link": "https://stackoverflow.com/questions/39982618/android-studio-2-2-cannot-find-references-for-all-kotlin-files/40013744#40013744", "title": "Android Studio 2.2 cannot find references for all kotlin files", "body": "<p>Make sure the kotlin plugin version in Android studio and the kotlin version that you are using(check build.gradle) are the same.</p>\n"}, {"comments": [{"owner": {"reputation": 537, "user_id": 2021745, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7af7d07389097c19d378ace2ad094ded?s=128&d=identicon&r=PG", "display_name": "rmgoncalo", "link": "https://stackoverflow.com/users/2021745/rmgoncalo"}, "edited": false, "score": 0, "creation_date": 1476701348, "post_id": 40059578, "comment_id": 67441320, "body": "I&#39;m using kotlin 1.0.3 and plugin 1.0.4. Are you talking about which one?"}, {"owner": {"reputation": 17986, "user_id": 4730812, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d336a10204c1cd2e7fa47071ed629669?s=128&d=identicon&r=PG&f=1", "display_name": "piotrek1543", "link": "https://stackoverflow.com/users/4730812/piotrek1543"}, "reply_to_user": {"reputation": 537, "user_id": 2021745, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7af7d07389097c19d378ace2ad094ded?s=128&d=identicon&r=PG", "display_name": "rmgoncalo", "link": "https://stackoverflow.com/users/2021745/rmgoncalo"}, "edited": false, "score": 0, "creation_date": 1480665201, "post_id": 40059578, "comment_id": 69065737, "body": "I&#39;d talked about the second one. Kotlin and k-plugin should be the same, so if at that time 1.04 was in unsatble version you should keep with the older one, I mean 1.03."}], "tags": [], "owner": {"reputation": 17986, "user_id": 4730812, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d336a10204c1cd2e7fa47071ed629669?s=128&d=identicon&r=PG&f=1", "display_name": "piotrek1543", "link": "https://stackoverflow.com/users/4730812/piotrek1543"}, "is_accepted": false, "score": 0, "last_activity_date": 1476537905, "creation_date": 1476537905, "answer_id": 40059578, "question_id": 39982618, "link": "https://stackoverflow.com/questions/39982618/android-studio-2-2-cannot-find-references-for-all-kotlin-files/40059578#40059578", "title": "Android Studio 2.2 cannot find references for all kotlin files", "body": "<p>After updating AS please configure your project again like described below: <a href=\"https://kotlinlang.org/docs/tutorials/kotlin-android.html\" rel=\"nofollow\">https://kotlinlang.org/docs/tutorials/kotlin-android.html</a></p>\n\n<p>Always choose <code>Stable</code> channel for <code>Kotlin</code> updates. </p>\n\n<p>I don't think that <code>1.0.4</code> version is already in <code>stable</code> channel. Why? The latest version is compatible with the latest version of <code>IntelliJ IDEA</code>, so it may cause problems in the <code>Aandroid Studio</code> which does not follow <code>IDEA</code> versions.  </p>\n\n<p>Hope it will help</p>\n"}], "owner": {"reputation": 537, "user_id": 2021745, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7af7d07389097c19d378ace2ad094ded?s=128&d=identicon&r=PG", "display_name": "rmgoncalo", "link": "https://stackoverflow.com/users/2021745/rmgoncalo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1476537905, "creation_date": 1476204937, "question_id": 39982618, "link": "https://stackoverflow.com/questions/39982618/android-studio-2-2-cannot-find-references-for-all-kotlin-files", "title": "Android Studio 2.2 cannot find references for all kotlin files", "body": "<p>After updating to Android Studio 2.2, I keep getting the error \"<em>Unresolved reference</em>\" in <strong>all</strong> kotlin files.</p>\n\n<p>The specific failing gradle task is:\n<code>:app:compileStagingDebugKotlinAfterJava</code> (for a variant called <code>StagingDebug</code>)</p>\n\n<p>The only solution I've found so far is to run <code>clean</code>. But I don't want to run this every time in do changes in my code. Any help?</p>\n"}, {"tags": ["java", "amazon-web-services", "kotlin", "amazon-cognito"], "answers": [{"comments": [{"owner": {"reputation": 95690, "user_id": 984823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2KYN.jpg?s=128&g=1", "display_name": "Joop Eggen", "link": "https://stackoverflow.com/users/984823/joop-eggen"}, "edited": false, "score": 0, "creation_date": 1476197207, "post_id": 39979843, "comment_id": 67238794, "body": "Indeed <code>5f</code> is an underscore, of the URL-safe variant of Base64"}], "tags": [], "owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "is_accepted": true, "score": 2, "last_activity_date": 1476198524, "last_edit_date": 1476198524, "creation_date": 1476196709, "answer_id": 39979843, "question_id": 39979842, "link": "https://stackoverflow.com/questions/39979842/using-amazon-aws-cognito-well-known-jwks-json-data-fails-to-base64-decode-som/39979843#39979843", "title": "Using Amazon AWS Cognito `.well-known/jwks.json` data fails to base64 decode some fields", "body": "<p>The issue is that the Amazon AWS Cognito team is using two different Base64 encoding alphabets for basically the same thing.  So you will need to detect which is being used.</p>\n\n<p>If the encoded string ends with <code>=</code> or contains <code>+</code> or <code>/</code> then it is definitely the normal <code>Base64.getDecoder()</code>.  If it contains a <code>-</code> or <code>_</code> then it is definitely the <code>Base64.getUrlDecoder()</code>.  Otherwise nothing special is there and it is best to use the <code>Base64.getUrlDecoder()</code> because you do not know if the length would need padding or not.</p>\n\n<p>This translates to (<em>in Kotlin, but logically is applicable to any language</em>):</p>\n\n\n\n<pre><code>fun base64SafeDecoder(encoded: String): ByteArray {\n    val decoder = if (encoded.endsWith('=') || encoded.any { it == '+' || it == '/' }) {\n        Base64.getDecoder()\n    }\n    else {\n        Base64.getUrlDecoder()\n    }\n    return decoder.decode(encoded.toByteArray())\n}\n</code></pre>\n\n<p>This would be a problem for any language that has Base64 decoding in that they might be loose and ignore the invalid character (some do), or they might be strict and throw an exception.  Some test websites for Base64 encoding/decoding exhibit both of these behaviors as well, and the silent ignoring of invalid characters is dangerous.  You would then have an error later using the results of the decoding later.</p>\n"}, {"comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1476438831, "post_id": 40018554, "comment_id": 67356168, "body": "Great, in this case wanted to stay with JDK version, although good to know for other projects where commons codec is in the dependencies."}], "tags": [], "owner": {"reputation": 4499, "user_id": 6241856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eyH0Z.jpg?s=128&g=1", "display_name": "Ionut Trestian", "link": "https://stackoverflow.com/users/6241856/ionut-trestian"}, "is_accepted": false, "score": 2, "last_activity_date": 1476354773, "creation_date": 1476354773, "answer_id": 40018554, "question_id": 39979842, "link": "https://stackoverflow.com/questions/39979842/using-amazon-aws-cognito-well-known-jwks-json-data-fails-to-base64-decode-som/40018554#40018554", "title": "Using Amazon AWS Cognito `.well-known/jwks.json` data fails to base64 decode some fields", "body": "<p>You can try using the apache variant of the Base64 decode (org.apache.commons.codec.binary.Base64).</p>\n\n<p>The decodeBase64(String base64String) method handles both base64 and base64 url safe encodings seamlessly. And the isBase64 method provides a check to detect if a string is encoded in either base64 or base64 url safe.</p>\n"}], "owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1315, "favorite_count": 0, "accepted_answer_id": 39979843, "answer_count": 2, "score": 3, "last_activity_date": 1476354773, "creation_date": 1476196709, "last_edit_date": 1610973576, "question_id": 39979842, "link": "https://stackoverflow.com/questions/39979842/using-amazon-aws-cognito-well-known-jwks-json-data-fails-to-base64-decode-som", "title": "Using Amazon AWS Cognito `.well-known/jwks.json` data fails to base64 decode some fields", "body": "<p>When using Amazon AWS Cognito <strong>Federated Identities</strong>, and parsing the data at:<br/>\n<code>https://cognito-identity.amazonaws.com/.well-known/jwks_uri</code> which looks like:</p>\n<pre class=\"lang-json prettyprint-override\"><code>{&quot;keys&quot;:[\n    {&quot;kty&quot;:&quot;RSA&quot;,\n     &quot;alg&quot;:&quot;RS512&quot;,\n     &quot;use&quot;:&quot;sig&quot;,\n     &quot;kid&quot;:&quot;ap-northeast-11&quot;,\n     &quot;n&quot;:&quot;AI7mc1assO5n6yB4b7jPCFgVLYPSnwt4qp2BhJVAmlXRntRZ5w4910oKNZDOr4fe/BWOI2Z7upUTE/ICXdqirEkjiPbBN/duVy5YcHsQ5+GrxQ/UbytNVN/NsFhdG8W31lsE4dnrGds5cSshLaohyU/aChgaIMbmtU0NSWQ+jwrW8q1PTvnThVQbpte59a0dAwLeOCfrx6kVvs0Y7fX7NXBbFxe8yL+JR3SMJvxBFuYC+/om5EIRIlRexjWpNu7gJnaFFwbxCBNwFHahcg5gdtSkCHJy8Gj78rsgrkEbgoHk29pk8jUzo/O/GuSDGw8qXb6w0R1+UsXPYACOXM8C8+E=&quot;,\n     &quot;e&quot;:&quot;AQAB&quot;}, \n ... }\n</code></pre>\n<p>This works fine decoding the <code>n</code> field using this code (<em>Kotlin calling JDK 8 Base64 class</em>):</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>Base64.getDecoder().decode(encodedN.toByteArray())\n</code></pre>\n<p>But when using Cognito <strong>User Pools</strong> which has data at a URL in the form of:<br/> <code>https://cognito-idp.${REGION}.amazonaws.com/${POOLID}/.well-known/jwks.json</code></p>\n<p>It has the same type of data, but it will not decode.  Instead I end up with errors such as:</p>\n<blockquote>\n<p>Illegal base64 character 5f</p>\n</blockquote>\n<p>Since that is an underscore <code>_</code> and in the <em>Base64 URL</em> alphabet, I tried changing my decoding to:</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>Base64.getUrlDecoder().decode(encodedN.toByteArray())\n</code></pre>\n<p>But then the first set of data no longer decodes correctly because it contains <code>/</code> and other invalid characters for <em>Base64 URL</em> encoding.</p>\n<p>Is there a method that can handle both of these <code>jwks</code> sets of data with the same decoder?!?</p>\n<p><strong>Note:</strong> <em>this question is intentionally written and answered by the author (<a href=\"https://blog.stackoverflow.com/2011/07/its-ok-to-ask-and-answer-your-own-questions/\">Self-Answered Questions</a>), so that solutions for interesting problems are shared in SO.</em></p>\n"}, {"tags": ["json", "hibernate", "spring-mvc", "jackson", "kotlin"], "owner": {"reputation": 313, "user_id": 3203062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bf92275d14c57a3f066767b3c536?s=128&d=identicon&r=PG&f=1", "display_name": "DmRomantsov", "link": "https://stackoverflow.com/users/3203062/dmromantsov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 559, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1476268053, "creation_date": 1476183755, "last_edit_date": 1476268053, "question_id": 39975803, "link": "https://stackoverflow.com/questions/39975803/override-jsonignore-annotation-for-some-controllers-jackson-spring", "title": "Override @JsonIgnore annotation for some controllers. Jackson. Spring", "body": "<p>I need to serialize photos field only for direct requests to the entity. But when user make request to all MediaHolders objects, serialize only short information with photoSize. </p>\n\n<p>I'm using Kotlin, Jackson, Spring and Hibernate. \nI've tried: </p>\n\n<ul>\n<li>@JsonView on contoller. Doesn't work. JsonView doesn't override @JsonIgnore behavior. Or I'll need to annotate all fields in base PersonalDomainObject class and all controllers, which is not suitable for me. </li>\n<li>Custom JsonFilter, but the same, it doesn't see ignore fields. And I can't add different Filters on different Controllers. </li>\n</ul>\n\n<p>Maybe I'm missing something, but I think it's very common task in optimization. Thank you very much for any suggestion!</p>\n\n<pre><code>  @JsonIgnoreProperties(\"createdAt\", \"updatedAt\", \"owner\", \"hibernateLazyInitializer\", \"handler\")\n    open class MediaHolder : PersonalDomainObject() {\n\n        @OneToMany(cascade = arrayOf(CascadeType.PERSIST, CascadeType.REMOVE), mappedBy = \"mediaHolder\")\n        @LazyCollection(LazyCollectionOption.EXTRA)\n        var photos:MutableList&lt;Photo&gt; = mutableListOf()\n\n        val photosSize: Int\n            get() = photos.size\n}\n</code></pre>\n"}, {"tags": ["gson", "kotlin"], "answers": [{"tags": [], "owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "is_accepted": true, "score": 20, "last_activity_date": 1476267772, "last_edit_date": 1495542274, "creation_date": 1476119300, "answer_id": 39963353, "question_id": 39962284, "link": "https://stackoverflow.com/questions/39962284/gson-deserialization-with-kotlin-initializer-block-not-called/39963353#39963353", "title": "Gson Deserialization with Kotlin, Initializer block not called", "body": "<p>Gson is intended for usage with pure Java and doesn't interpret Kotlin primary constructors properly.</p>\n\n<p>If there is a default no-argument constructor, it is called (in your case, there is one: the primary constructor with default value <code>\"\"</code> for <code>someString</code>), <a href=\"https://stackoverflow.com/questions/18645050/is-default-no-args-constructor-mandatory-for-gson\">otherwise Gson calls no constructor at all</a>.</p>\n\n<p>Then Gson sets the property values (also, it bypasses actual setters of Kotlin properties and sets the fields directly, which may sometimes lead to unexpected behavior).</p>\n\n<hr>\n\n<p>As an alternative, you can use <a href=\"https://github.com/FasterXML/jackson-module-kotlin\" rel=\"noreferrer\">jackson-module-kotlin</a>, it should work good in your case (it understands Kotlin primary constructors, uses Kotlin setters and supports default parameter values as well since <code>2.8.x</code>).</p>\n\n<p>This example compares jackson-module-kotlin and <a href=\"https://github.com/SalomonBrys/Kotson\" rel=\"noreferrer\">Kotson</a> behavior:</p>\n\n<pre><code>class SomeClass(val id: Int = -1) {\n    init { println(\"init $id\") }\n}\n\nclass SomeClassNoDefault(val id: Int) {\n    init { println(\"init $id\") }\n}\n\nfun main(args: Array&lt;String&gt;) {\n    val mapper = jacksonObjectMapper()\n    val gson = Gson()\n\n    val idDefault = \"{}\"\n    val id123 = \"{\\\"id\\\": 123 }\"\n\n    println(\"jackson-module-kotlin, { }:\")\n    val o1 = mapper.readValue&lt;SomeClass&gt;(idDefault)\n    println(\"after construction: ${o1.id}\\n\")\n\n    println(\"jackson-module-kotlin, { \\\"id\\\" = 123 }:\")\n    val o2 = mapper.readValue&lt;SomeClass&gt;(id123)\n    println(\"after construction: ${o2.id}\\n\")\n\n    println(\"kotson, { }:\")\n    val o3 = gson.fromJson&lt;SomeClass&gt;(idDefault)\n    println(\"after construction: ${o3.id}\\n\")\n\n    println(\"kotson, { \\\"id\\\" = 123 }:\")\n    val o4 = gson.fromJson&lt;SomeClass&gt;(id123)\n    println(\"after construction: ${o4.id}\\n\")\n\n    println(\"---\\n\")\n\n    println(\"jackson-module-kotlin, no default value, { \\\"id\\\" = 123 }:\")\n    val o5 = mapper.readValue&lt;SomeClassNoDefault&gt;(id123)\n    println(\"after construction: ${o5.id}\\n\")\n\n    println(\"kotson, no default value, { \\\"id\\\" = 123 }:\")\n    val o6 = gson.fromJson&lt;SomeClassNoDefault&gt;(id123)\n    println(\"after construction: ${o6.id}\\n\")\n}\n</code></pre>\n\n<p>The output is</p>\n\n<blockquote>\n<pre><code>jackson-module-kotlin, { }:\ninit -1\nafter construction: -1\n\njackson-module-kotlin, { \"id\" = 123 }:\ninit 123\nafter construction: 123\n\nkotson, { }:\ninit -1\nafter construction: -1\n\nkotson, { \"id\" = 123 }:\ninit -1\nafter construction: 123\n\n---\n\njackson-module-kotlin, no default value, { \"id\" = 123 }:\ninit 123\nafter construction: 123\n\nkotson, no default value, { \"id\" = 123 }:\nafter construction: 123\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 259, "user_id": 6159609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30a94125c6b855ff07f52794117c560b?s=128&d=identicon&r=PG&f=1", "display_name": "Kirk_hehe", "link": "https://stackoverflow.com/users/6159609/kirk-hehe"}, "is_accepted": false, "score": 0, "last_activity_date": 1618568841, "creation_date": 1618568841, "answer_id": 67123540, "question_id": 39962284, "link": "https://stackoverflow.com/questions/39962284/gson-deserialization-with-kotlin-initializer-block-not-called/67123540#67123540", "title": "Gson Deserialization with Kotlin, Initializer block not called", "body": "<p>I had a similar issue with Gson. My data class had some serialized paraments and few non serialized. And I wanted to make my non serialized parameters with default values. The simplest solution I found is to make my non serialized parameters optional. Here is my workaround:</p>\n<pre><code>data class MyClass(\n@SerializedName(&quot;name&quot;) val name: String // All Serialize goes here\n) { // Non serialized\n    var status: String?\n        get {\n            return if (field == null) {\n                &quot;Nice status&quot;\n            } else {\n                field\n            }\n        }\n}\n</code></pre>\n"}], "owner": {"reputation": 6473, "user_id": 2660462, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/e7866e763430b8848f14ffdacb61b99f?s=128&d=identicon&r=PG", "display_name": "Lukas Lechner", "link": "https://stackoverflow.com/users/2660462/lukas-lechner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3876, "favorite_count": 3, "accepted_answer_id": 39963353, "answer_count": 2, "score": 17, "last_activity_date": 1618568841, "creation_date": 1476115417, "question_id": 39962284, "link": "https://stackoverflow.com/questions/39962284/gson-deserialization-with-kotlin-initializer-block-not-called", "title": "Gson Deserialization with Kotlin, Initializer block not called", "body": "<p>My initializer block is working perfectly fine when I create my Object</p>\n\n<pre><code>class ObjectToDeserialize(var someString: String = \"\") : Serializable {\n    init{\n        someString += \" initialized\"\n    }\n}\n</code></pre>\n\n<p>this way:</p>\n\n<pre><code>@Test\nfun createObject_checkIfInitialized() {\n      assertEquals(\"someString initialized\",ObjectToDeserialize(\"someString\").someString)\n}\n</code></pre>\n\n<p>But when I deserialize the object with Gson, the initializer block does not get executed:</p>\n\n<pre><code>@Test\nfun deserializeObject_checkIfInitialized(){\n    val someJson: String = \"{\\\"someString\\\":\\\"someString\\\" }\"\n    val jsonObject = Gson().fromJson(someJson, ObjectToDeserialize::class.java)\n\n    assertEquals(\"someString initialized\",jsonObject.someString)\n\n    // Expected :someString initialized\n    // Actual   :someString\n}\n</code></pre>\n\n<p>I think that gson is creating the object in a different way than by executing the primary constructor. Is it nevertheless possible to have something similar like initializer blocks?</p>\n\n<hr>\n"}, {"tags": ["json", "jackson", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 2756, "user_id": 2235972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZDR82.png?s=128&g=1", "display_name": "denvercoder9", "link": "https://stackoverflow.com/users/2235972/denvercoder9"}, "edited": false, "score": 0, "creation_date": 1566109572, "post_id": 39959833, "comment_id": 101548058, "body": "Is there a way to use default values for constructor parameters during deserialization if json field values are null? also keeping the fields in data class non-nullable?"}], "tags": [], "owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "is_accepted": true, "score": 6, "last_activity_date": 1476120609, "last_edit_date": 1476120609, "creation_date": 1476107260, "answer_id": 39959833, "question_id": 39959730, "link": "https://stackoverflow.com/questions/39959730/kotlin-jackson-generation-objects-from-json/39959833#39959833", "title": "Kotlin Jackson generation objects from JSON", "body": "<p>There are several issues I found about your mapping that prevent Jackson from reading the value from JSON:</p>\n\n<ul>\n<li><p><code>Skeleton</code> class has not-null constructor parameters (e.g. <code>val type: String</code>, not <code>String?</code>), and Jackson passes <code>null</code> to them if the value for those parameters is missing in JSON. This is what causes the exception you mentioned:</p>\n\n<blockquote>\n  <p>Parameter specified as non-null is null: method <code>com.uibuilder.controllers.parser.Skeleton.&lt;init&gt;</code>, parameter <code>name</code></p>\n</blockquote>\n\n<p>To avoid it, you should mark the parameters that might might have values missing as nullable (all of the parameters in your case):</p>\n\n<pre><code>data class Skeleton(val type: String?,\n                    val name: String?,\n                    val icon: String?,\n                    val fields: List&lt;Field&gt;?,\n                    val styles: Map&lt;String, Map&lt;String, Any&gt;&gt;?,\n                    val subviews : List&lt;Skeleton&gt;?)\n</code></pre></li>\n<li><p><code>fields</code> in <code>Skeleton</code> has type <code>List&lt;Field&gt;</code>, but in JSON it's represented by a single object, not by an array. The fix would be to change the <code>fields</code> parameter type to <code>Field?</code>:</p>\n\n<pre><code>data class Skeleton(...\n                    val fields: Field?,\n                    ...)\n</code></pre></li>\n<li><p>Also, <code>Field</code> class in your code doesn't match the objects in JSON:</p>\n\n<pre><code>\"fields\": {\n    \"text\": \"Some text 1\"\n}\n</code></pre>\n\n<p>You should change <code>Field</code> class as well, so that it has <code>text</code> property:</p>\n\n<pre><code>data class Field(val text: String)\n</code></pre></li>\n</ul>\n\n<p>After I made the changes I listed, Jackson could successfully read the JSON in question.</p>\n\n<hr>\n\n<p><strong>See also:</strong> <a href=\"https://kotlinlang.org/docs/reference/null-safety.html\" rel=\"nofollow\">\"Null Safety\" in Kotlin reference</a>.</p>\n"}], "owner": {"reputation": 1795, "user_id": 6920495, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b8f72219f7e1ef8ce0d33edbecbd299d?s=128&d=identicon&r=PG&f=1", "display_name": "Natan Rubinstein", "link": "https://stackoverflow.com/users/6920495/natan-rubinstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1672, "favorite_count": 0, "accepted_answer_id": 39959833, "answer_count": 1, "score": 3, "last_activity_date": 1476120609, "creation_date": 1476106983, "question_id": 39959730, "link": "https://stackoverflow.com/questions/39959730/kotlin-jackson-generation-objects-from-json", "title": "Kotlin Jackson generation objects from JSON", "body": "<p>Please help! I'm trying to generate object from JSON with jackson kotlin module. Here is json source:</p>\n\n<pre><code>{\n    \"name\": \"row\",\n    \"type\": \"layout\",\n    \"subviews\": [{\n        \"type\": \"horizontal\",\n        \"subviews\": [{\n            \"type\": \"image\",\n            \"icon\": \"ic_no_photo\",\n            \"styles\": {\n                \"view\": {\n                    \"gravity\": \"center\"\n                }\n            }\n        }, {\n            \"type\": \"vertical\",\n            \"subviews\": [{\n                \"type\": \"text\",\n                \"fields\": {\n                    \"text\": \"Some text 1\"\n                }\n            }, {\n                \"type\": \"text\",\n                \"fields\": {\n                    \"text\": \"Some text 2\"\n                }\n            }]\n        }, {\n            \"type\": \"vertical\",\n            \"subviews\": [{\n                \"type\": \"text\",\n                \"fields\": {\n                    \"text\": \"Some text 3\"\n                }\n            }, {\n                \"type\": \"text\",\n                \"fields\": {\n                    \"text\": \"Some text 4\"\n                }\n            }]\n        }, {\n            \"type\": \"vertical\",\n            \"subviews\": [{\n                \"type\": \"image\",\n                \"icon\": \"ic_no_photo\"\n            }, {\n                \"type\": \"text\",\n                \"fields\": {\n                    \"text\": \"Some text 5\"\n                }\n            }]\n        }]\n    }]\n}\n</code></pre>\n\n<p>I'm trying to generate instance of Skeleton class. </p>\n\n<pre><code>data class Skeleton (val type : String,\n                         val name: String,\n                         val icon: String,\n                         val fields: List&lt;Field&gt;,\n                         val styles: Map&lt;String, Map&lt;String, Any&gt;&gt;,\n                         val subviews : List&lt;Skeleton&gt;)\n\ndata class Field (val type: String, val value: Any)\n</code></pre>\n\n<p>As you can see, Skeleton object can have other Skeleton objects inside (and these objects can have other Skeleton objects inside too), also Skeleton can have List of Field objects</p>\n\n<pre><code>val mapper = jacksonObjectMapper()\nval skeleton: Skeleton = mapper.readValue(File(file))\n</code></pre>\n\n<p>This code ends with exception:</p>\n\n<pre><code>com.fasterxml.jackson.databind.JsonMappingException: Instantiation of [simple type, class com.uibuilder.controllers.parser.Skeleton] value failed (java.lang.IllegalArgumentException): Parameter specified as non-null is null: method com.uibuilder.controllers.parser.Skeleton.&lt;init&gt;, parameter name\n at [Source: docs\\layout.txt; line: 14, column: 3] (through reference chain: com.uibuilder.controllers.parser.Skeleton[\"subviews\"]-&gt;java.util.ArrayList[0]-&gt;com.uibuilder.controllers.parser.Skeleton[\"subviews\"]-&gt;java.util.ArrayList[0])\n</code></pre>\n"}, {"tags": ["java", "arrays", "generics", "kotlin"], "comments": [{"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "edited": false, "score": 0, "creation_date": 1476105447, "post_id": 39954726, "comment_id": 67197932, "body": "By calling <code>arrayOf(array)</code> you create a 2D array of type <code>Array&lt;IntArray&gt;</code>, this is why you get the error message."}], "answers": [{"comments": [{"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "edited": false, "score": 2, "creation_date": 1476093303, "post_id": 39954843, "comment_id": 67190882, "body": "You can also create a boxed array directly using <code>arrayOf(5, 3, 0, 2, 4, 1, 0, 5, 2, 3, 1, 4)</code>"}], "tags": [], "owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "is_accepted": true, "score": 7, "last_activity_date": 1476100262, "last_edit_date": 1476100262, "creation_date": 1476090448, "answer_id": 39954843, "question_id": 39954726, "link": "https://stackoverflow.com/questions/39954726/how-to-pass-an-array-of-integers-to-a-method-expecting-arrayt/39954843#39954843", "title": "How to pass an array of integers to a method expecting `Array&lt;T&gt;`?", "body": "<p><a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/int-array-of.html\" rel=\"nofollow\"><code>intArrayOf</code></a> returns <code>IntArray</code> which <strong>does not extend</strong> <code>Array&lt;Int&gt;</code> as one might assume. As <a href=\"https://kotlinlang.org/docs/reference/basic-types.html\" rel=\"nofollow\">stated in the documentation</a> Kotlin provides specialized array types for various primitives that avoid boxing overhead. <code>IntArray</code> corresponds to Java's <code>int[]</code>. The <code>ShellSort.sort</code> method (both Kotlin and Java) requires boxed versions. </p>\n\n<p>You can convert <code>IntArray</code> to <code>Array&lt;Int&gt;</code> using <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/to-typed-array.html\" rel=\"nofollow\"><code>toTypedArray</code></a> extension method like so:</p>\n\n<pre><code>val array = intArrayOf(5, 3, 0, 2, 4, 1, 0, 5, 2, 3, 1, 4).toTypedArray()\nshellSort(array)\n</code></pre>\n\n<p>Or as @KirillRakhman suggested create a boxed version directly:</p>\n\n<pre><code>shellSort(arrayOf(5, 3, 0, 2, 4, 1, 0, 5, 2, 3, 1, 4))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7773, "user_id": 1025935, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/NPYjX.jpg?s=128&g=1", "display_name": "UmAnusorn", "link": "https://stackoverflow.com/users/1025935/umanusorn"}, "edited": false, "score": 0, "creation_date": 1476092754, "post_id": 39954885, "comment_id": 67190584, "body": "Thank you for your answer but &quot;IntArray.toTypedArray()&quot; may work with Java but not for Kotlin"}], "tags": [], "owner": {"reputation": 24454, "user_id": 5108418, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/AN6Pg.png?s=128&g=1", "display_name": "Tamas Hegedus", "link": "https://stackoverflow.com/users/5108418/tamas-hegedus"}, "is_accepted": false, "score": 2, "last_activity_date": 1476090644, "creation_date": 1476090644, "answer_id": 39954885, "question_id": 39954726, "link": "https://stackoverflow.com/questions/39954726/how-to-pass-an-array-of-integers-to-a-method-expecting-arrayt/39954885#39954885", "title": "How to pass an array of integers to a method expecting `Array&lt;T&gt;`?", "body": "<p>This line</p>\n\n<pre><code>shellSort(arrayOf(array))\n</code></pre>\n\n<p>does not cast <code>IntArray array</code> to a regular <code>Array&lt;Integer&gt;</code>, but wraps it in a singleton array of type <code>Array&lt;IntArray&gt;</code>. Use <code>IntArray.toTypedArray()</code> to convert it to a generic array, as <code>@miensol</code> suggested.</p>\n"}], "owner": {"reputation": 7773, "user_id": 1025935, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/NPYjX.jpg?s=128&g=1", "display_name": "UmAnusorn", "link": "https://stackoverflow.com/users/1025935/umanusorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 39954843, "answer_count": 2, "score": 2, "last_activity_date": 1476216099, "creation_date": 1476090098, "last_edit_date": 1495540412, "question_id": 39954726, "link": "https://stackoverflow.com/questions/39954726/how-to-pass-an-array-of-integers-to-a-method-expecting-arrayt", "title": "How to pass an array of integers to a method expecting `Array&lt;T&gt;`?", "body": "<p>I have converted <a href=\"https://stackoverflow.com/questions/4833423/shell-sort-java-example\">java shellSort</a> to Kotlin. The problem is I have no idea to call this method.</p>\n\n<p>Java</p>\n\n<pre><code>package Sorts;\npublic class ShellSort extends Sorter{\n\n@Override\npublic &lt;T extends Comparable&lt;? super T&gt;&gt; void sort(T[] a) {\n    int h = 1;\n    while((h*3+1) &lt; a.length)\n        h = 3*h+1;\n    while(h &gt; 0){\n        for(int i = h-1; i &lt; a.length; i++){\n            T s = a[i];\n            int j = i;\n            for(j = i; (j&gt;=h) &amp;&amp; (a[j-h].compareTo(s) &gt; 0); j-=h)\n                a[j] = a[j-h];\n            a[j] = s;\n        }\n        h /= 3;\n    }\n}\n}\n</code></pre>\n\n<p>Kotlin</p>\n\n<pre><code>fun &lt;T : Comparable&lt;T&gt;&gt; shellSort(a: Array&lt;T&gt;) {\n    var h = 1\n    while (h * 3 + 1 &lt; a.size)\n        h = 3 * h + 1\n    while (h &gt; 0) {\n        for (i in h - 1..a.size - 1) {\n            val s = a[i]\n            var j = i\n            j = i\n            while (j &gt;= h &amp;&amp; a[j - h].compareTo(s) &gt; 0) {\n                a[j] = a[j - h]\n                j -= h\n            }\n            a[j] = s\n        }\n        h /= 3\n    }\n}\n</code></pre>\n\n<p>What I have tried to call is cast intArray to array</p>\n\n<pre><code> val array = intArrayOf(5, 3, 0, 2, 4, 1, 0, 5, 2, 3, 1, 4)\n shellSort(arrayOf(array))\n</code></pre>\n\n<p>Which comes with error</p>\n\n<p><a href=\"https://i.stack.imgur.com/338ir.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/338ir.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Type parameter bound for T in \n\n fun &lt;T : Comparable&lt;T&gt;&gt; shellSort(a: Array&lt;T&gt;) : Unit\n\nis not satisfied: inferred type IntArray is not a subtype of Comparable&lt;IntArray&gt;\n</code></pre>\n"}, {"tags": ["android-studio", "kotlin"], "comments": [{"owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "edited": false, "score": 2, "creation_date": 1476096198, "post_id": 39950075, "comment_id": 67192457, "body": "Which Kotlin compiler version are you referencing in your build.gradle?"}], "answers": [{"comments": [{"owner": {"reputation": 13647, "user_id": 315386, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/xIKTp.jpg?s=128&g=1", "display_name": "Mick Byrne", "link": "https://stackoverflow.com/users/315386/mick-byrne"}, "edited": false, "score": 0, "creation_date": 1477353377, "post_id": 40059743, "comment_id": 67721716, "body": "Yes, this was the solution (worked it out myself, but ups to you for following through with such a nice clear answer)."}, {"owner": {"reputation": 394, "user_id": 2023321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1iHEw.jpg?s=128&g=1", "display_name": "Eduardo Fernandes", "link": "https://stackoverflow.com/users/2023321/eduardo-fernandes"}, "edited": false, "score": 0, "creation_date": 1604955717, "post_id": 40059743, "comment_id": 114500622, "body": "Worked for me. Thanks."}], "tags": [], "owner": {"reputation": 17986, "user_id": 4730812, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d336a10204c1cd2e7fa47071ed629669?s=128&d=identicon&r=PG&f=1", "display_name": "piotrek1543", "link": "https://stackoverflow.com/users/4730812/piotrek1543"}, "is_accepted": true, "score": 9, "last_activity_date": 1476538947, "creation_date": 1476538947, "answer_id": 40059743, "question_id": 39950075, "link": "https://stackoverflow.com/questions/39950075/kotlin-app-build-failed-due-to-could-not-initialize-class-com-intellij-ide-high/40059743#40059743", "title": "Kotlin app build failed due to &quot;Could not initialize class com.intellij.ide.highlighter.JavaFileType&quot;", "body": "<p>Open <code>Tools | Kotlin | Configure Kotlin Plugin Updates</code> in the main menu,\nthen choose <code>Check for Updates</code>. Be sure that yo're using <code>Stable</code> channel.</p>\n\n<p>Close <code>Android Studio</code>, go to your project's directory, and delete <code>build</code> and <code>app/build</code> folders. Run Android Studio. Deleted folders would be recreated.</p>\n\n<p>Hope it will help</p>\n"}, {"tags": [], "owner": {"reputation": 6549, "user_id": 1148030, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/IdZzM.jpg?s=128&g=1", "display_name": "Peter Lamberg", "link": "https://stackoverflow.com/users/1148030/peter-lamberg"}, "is_accepted": false, "score": 6, "last_activity_date": 1479104744, "last_edit_date": 1479104744, "creation_date": 1478270852, "answer_id": 40425553, "question_id": 39950075, "link": "https://stackoverflow.com/questions/39950075/kotlin-app-build-failed-due-to-could-not-initialize-class-com-intellij-ide-high/40425553#40425553", "title": "Kotlin app build failed due to &quot;Could not initialize class com.intellij.ide.highlighter.JavaFileType&quot;", "body": "<p>In my case the kotlin plugin was not updated as @piotrek1543 said in other answer.</p>\n\n<p>In addition to that the <code>build.gradle</code> had an old Kotlin version number <code>1.0.1-2</code> and the IntelliJ said in a warning on top of to switch to the current bundled version <code>1.0.4</code>.</p>\n\n<p>Now with the kotlin version like this the error is gone:</p>\n\n<pre><code>ext.kotlin_version = '1.0.4'\n</code></pre>\n"}], "owner": {"reputation": 13647, "user_id": 315386, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/xIKTp.jpg?s=128&g=1", "display_name": "Mick Byrne", "link": "https://stackoverflow.com/users/315386/mick-byrne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5984, "favorite_count": 0, "accepted_answer_id": 40059743, "answer_count": 2, "score": 7, "last_activity_date": 1504993235, "creation_date": 1476061553, "last_edit_date": 1504993235, "question_id": 39950075, "link": "https://stackoverflow.com/questions/39950075/kotlin-app-build-failed-due-to-could-not-initialize-class-com-intellij-ide-high", "title": "Kotlin app build failed due to &quot;Could not initialize class com.intellij.ide.highlighter.JavaFileType&quot;", "body": "<p>I've just updated Android Studio to 2.2 and now my Kotlin project won't build. The gradle synch works fine, but when attempting to build I'm immediately presented with an error that reads:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Error:Execution failed for task ':app:compileDebugKotlin'.\n&gt; Could not initialize class com.intellij.ide.highlighter.JavaFileType\n</code></pre>\n\n<p>I've checked that my Kotlin plugin is up to date. This error sounds like something to do with the IDE and highlighting Java code? Any help would be appreciated.</p>\n"}, {"tags": ["kotlin"], "answers": [{"comments": [{"owner": {"reputation": 1581, "user_id": 2319806, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4aeddf919979c1ade0de68de94fc3b88?s=128&d=identicon&r=PG", "display_name": "ericky", "link": "https://stackoverflow.com/users/2319806/ericky"}, "edited": false, "score": 0, "creation_date": 1476115833, "post_id": 39951440, "comment_id": 67204618, "body": "Thanks miensol but I want to supply a named function - not a lambda - that takes a BorrowerX and returns a string. It works in Scala and I&#39;ve updated the code to show how it&#39;s done there. Maybe not in Kotlin?"}], "tags": [], "owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "is_accepted": false, "score": 0, "last_activity_date": 1476074822, "creation_date": 1476074822, "answer_id": 39951440, "question_id": 39949922, "link": "https://stackoverflow.com/questions/39949922/kotlin-how-to-pass-an-object-function-as-parameter-to-another/39951440#39951440", "title": "Kotlin: how to pass an object function as parameter to another?", "body": "<p>As stated in <a href=\"https://kotlinlang.org/docs/reference/lambdas.html\" rel=\"nofollow\">the documentation on lambdas</a>:</p>\n\n<pre><code>BorrowerX.findBorrowerX2(\"Borrower-Bad\", brs1, { it.name })\n</code></pre>\n\n<p>or when the lambda is the last parameter of the method:</p>\n\n<pre><code>BorrowerX.findBorrowerX2(\"Borrower-Bad\", brs1) { it.name }\n</code></pre>\n\n<p>Stating types and parameter names explicitly often improves readability:</p>\n\n<pre><code>BorrowerX.findBorrowerX2(\"Borrower-Bad\", brs1) { borrower:BorrowerX -&gt; borrower.name }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1581, "user_id": 2319806, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4aeddf919979c1ade0de68de94fc3b88?s=128&d=identicon&r=PG", "display_name": "ericky", "link": "https://stackoverflow.com/users/2319806/ericky"}, "edited": false, "score": 0, "creation_date": 1476324218, "post_id": 39985643, "comment_id": 67300175, "body": "Thanks Ilya, but I can&#39;t get <code>BorrowerX.findBorrowerX2(&quot;Borrower1&quot;, brs1, BorrowerX.Companion::getName)</code> to compile. I get 2 errors: &quot;Error:(41, 57) Kotlin: Type mismatch: inferred type is KFunction2&lt;BorrowerX.Companion, BorrowerX, String&gt; but (BorrowerX) -&gt; String was expected&quot; and &quot;Error:(41, 78) Kotlin: Callable references to object members are not supported&quot;. Any thought?"}, {"owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "reply_to_user": {"reputation": 1581, "user_id": 2319806, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4aeddf919979c1ade0de68de94fc3b88?s=128&d=identicon&r=PG", "display_name": "ericky", "link": "https://stackoverflow.com/users/2319806/ericky"}, "edited": false, "score": 1, "creation_date": 1476330550, "post_id": 39985643, "comment_id": 67301742, "body": "Oh, the former seems to be a reference bound to an instance of companion object, and bound references are supported starting from (not yet released) Kotlin 1.1. But you still can use <code>BorrowerX::name</code> in Kotlin 1.0."}, {"owner": {"reputation": 1581, "user_id": 2319806, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4aeddf919979c1ade0de68de94fc3b88?s=128&d=identicon&r=PG", "display_name": "ericky", "link": "https://stackoverflow.com/users/2319806/ericky"}, "edited": false, "score": 0, "creation_date": 1476456199, "post_id": 39985643, "comment_id": 67367801, "body": "You are correct: <a href=\"http://try.kotlinlang.org/#/UserProjects/jen80pe3qlke33ile9qn6mvlov/nrhqkvhpdnkttmbcmkjha272ul\" rel=\"nofollow noreferrer\">link</a> Fails with <code>v. 1.0.4</code>. Runs with <code>v. 1.1-M01</code>. Could you pass multiple parameters to getName if needed? Thank you."}, {"owner": {"reputation": 1581, "user_id": 2319806, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4aeddf919979c1ade0de68de94fc3b88?s=128&d=identicon&r=PG", "display_name": "ericky", "link": "https://stackoverflow.com/users/2319806/ericky"}, "edited": false, "score": 0, "creation_date": 1476733725, "post_id": 39985643, "comment_id": 67461692, "body": "Update: Appears multiple parameters are for &quot;future use&quot; in v. 1.1: &quot;Error:(35, 56) Type mismatch: inferred type is KFunction2&lt;BorrowerX, Int, String&gt; but (BorrowerX) -&gt; String was expected Error:(35, 85) This syntax is reserved for future use; to call a reference, enclose it in parentheses: (foo::bar)(args)&quot;. See <a href=\"http://try.kotlinlang.org/#/UserProjects/jen80pe3qlke33ile9qn6mvlov/nrhqkvhpdnkttmbcmkjha272ul\" rel=\"nofollow noreferrer\">val c</a>"}, {"owner": {"reputation": 1581, "user_id": 2319806, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4aeddf919979c1ade0de68de94fc3b88?s=128&d=identicon&r=PG", "display_name": "ericky", "link": "https://stackoverflow.com/users/2319806/ericky"}, "edited": false, "score": 0, "creation_date": 1496757454, "post_id": 39985643, "comment_id": 75783791, "body": "Hello Ilya. Is this still for &quot;future use in v. 1.1...&quot; in the current v. 1.1.2??  Does not appear to be implemented yet? Thank you."}, {"owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "reply_to_user": {"reputation": 1581, "user_id": 2319806, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4aeddf919979c1ade0de68de94fc3b88?s=128&d=identicon&r=PG", "display_name": "ericky", "link": "https://stackoverflow.com/users/2319806/ericky"}, "edited": false, "score": 0, "creation_date": 1496769751, "post_id": 39985643, "comment_id": 75792106, "body": "@ericky, there is no syntax in Kotlin like you&#39;re trying to use there. Use the lambda expression for partial application: <code>{ BorrowerX.getName2(it, 0) }</code>"}, {"owner": {"reputation": 1581, "user_id": 2319806, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4aeddf919979c1ade0de68de94fc3b88?s=128&d=identicon&r=PG", "display_name": "ericky", "link": "https://stackoverflow.com/users/2319806/ericky"}, "edited": false, "score": 0, "creation_date": 1496782120, "post_id": 39985643, "comment_id": 75798990, "body": "This is odd. This syntax did exist and work correctly under v. 1.1-M01 on Try Kotlin (my comment on 10/4/16 with link). What happened to 1.1-M01?"}, {"owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "reply_to_user": {"reputation": 1581, "user_id": 2319806, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4aeddf919979c1ade0de68de94fc3b88?s=128&d=identicon&r=PG", "display_name": "ericky", "link": "https://stackoverflow.com/users/2319806/ericky"}, "edited": false, "score": 0, "creation_date": 1496797618, "post_id": 39985643, "comment_id": 75803575, "body": "@ericky I&#39;ve checked the example with 1.1-M01 compiler and it yields the same error message about syntax."}, {"owner": {"reputation": 1581, "user_id": 2319806, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4aeddf919979c1ade0de68de94fc3b88?s=128&d=identicon&r=PG", "display_name": "ericky", "link": "https://stackoverflow.com/users/2319806/ericky"}, "edited": false, "score": 0, "creation_date": 1497106618, "post_id": 39985643, "comment_id": 75944914, "body": "Got it! Here is the syntax that works: <code>BorrowerX.findBorrowerX2(&quot;Borrower1&quot;, brs1, {BorrowerX.getName(it)})</code>. The working example can be found <a href=\"https://try.kotlinlang.org/#/UserProjects/jen80pe3qlke33ile9qn6mvlov/nrhqkvhpdnkttmbcmkjha272ul\" rel=\"nofollow noreferrer\">here</a>. Thank you Ilya."}], "tags": [], "owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "is_accepted": true, "score": 3, "last_activity_date": 1476215770, "creation_date": 1476215770, "answer_id": 39985643, "question_id": 39949922, "link": "https://stackoverflow.com/questions/39949922/kotlin-how-to-pass-an-object-function-as-parameter-to-another/39985643#39985643", "title": "Kotlin: how to pass an object function as parameter to another?", "body": "<p>You can use <code>::</code> operator to get a function reference:</p>\n\n<pre><code>BorrowerX.findBorrowerX2(\"Borrower1\", brs1, BorrowerX.Companion::getName)\n</code></pre>\n\n<p>Here <code>BorrowerX.Companion::getName</code> is a reference to the function <code>getName</code> declared in the companion object (named <code>Companion</code>) of the class <code>BorrowerX</code>. It has the type <code>KFunction1&lt;BorrowerX, String&gt;</code> which is a subtype of the required functional parameter type <code>(BorrowerX) -&gt; String</code>.</p>\n\n<p>It's worth noting that you can use <code>::</code> operator to get a property reference too:</p>\n\n<pre><code>BorrowerX.findBorrowerX2(\"Borrower1\", brs1, BorrowerX::name)\n</code></pre>\n\n<p><code>BorrowerX::name</code> has the type <code>KProperty1&lt;BorrowerX, String&gt;</code> which also is a subtype of <code>(BorrowerX) -&gt; String</code>. When invoked with the specified <code>BorrowerX</code> instance it returns the value of its <code>name</code> property.</p>\n"}], "owner": {"reputation": 1581, "user_id": 2319806, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4aeddf919979c1ade0de68de94fc3b88?s=128&d=identicon&r=PG", "display_name": "ericky", "link": "https://stackoverflow.com/users/2319806/ericky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4670, "favorite_count": 0, "accepted_answer_id": 39985643, "answer_count": 2, "score": 2, "last_activity_date": 1476215770, "creation_date": 1476059692, "last_edit_date": 1495541216, "question_id": 39949922, "link": "https://stackoverflow.com/questions/39949922/kotlin-how-to-pass-an-object-function-as-parameter-to-another", "title": "Kotlin: how to pass an object function as parameter to another?", "body": "<p>I am trying to learn functional Kotlin and have written this test code:</p>\n\n<pre><code>import java.util.*\n\ndata class BorrowerX(val name: String, val maxBooks: Int) {\n\n    companion object {\n\n        fun getName(br: BorrowerX): String = br.name\n\n        fun findBorrowerX(n: String, brs: ArrayList&lt;BorrowerX&gt;): BorrowerX? {\n\n            val coll: List&lt;BorrowerX&gt; = brs.filter { BorrowerX.getName(it) == n }\n\n            if (coll.isEmpty()) {\n                return null\n            } else return coll.first()\n\n        }\n\n        fun findBorrowerX2(n: String, brs: ArrayList&lt;BorrowerX&gt;, f: (BorrowerX) -&gt; String): BorrowerX? {\n\n            val coll: List&lt;BorrowerX&gt; = brs.filter { f(it) == n }\n\n            if (coll.isEmpty()) {\n                return null\n            } else return coll.first()\n\n        }\n\n    }\n\n}\n</code></pre>\n\n<p>In the REPL I can successfully call \"findBorrowerX\":</p>\n\n<pre><code>import BorrowerX\n\nval br1 = BorrowerX(name = \"Borrower1\", maxBooks = 1)\nval br2 = BorrowerX(name = \"Borrower2\", maxBooks = 2)\nval br3 = BorrowerX(name = \"Borrower3\", maxBooks = 3)\n\nval brs1 = arrayListOf(br1, br2, br3)\n\nBorrowerX.findBorrowerX(\"Borrower1\", brs1)\nBorrowerX(name=Borrower1, maxBooks=1)\n\nBorrowerX.findBorrowerX(\"Borrower-Bad\", brs1)\nnull\n</code></pre>\n\n<p>But how do I make the call to \"findBorrowerX2\":</p>\n\n<pre><code>BorrowerX.findBorrowerX2(\"Borrower1\", brs1, BorrowerX.getName(???))\n</code></pre>\n\n<p>And pass the iterated BorrowerX to getName??</p>\n\n<p>This looks related, but I'm not sure:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/16120697/kotlin-how-to-pass-a-function-as-parameter-to-another\">Kotlin: how to pass a function as parameter to another?</a></p>\n\n<p>Thank you in advance for your help with this!</p>\n\n<p>EDIT:</p>\n\n<p>Here is the equivalent Scala code for what I want to do:</p>\n\n<pre><code>def findBorrowerX2(n: String, brs: List[BorrowerX], f: BorrowerX =&gt; String): BorrowerX = {\n\n  val coll: List[BorrowerX] = brs.filter(f(_) == n)\n\n  if (coll.isEmpty) {\n    null\n  } else {\n    coll.head\n  }\n\n}\n\nscala&gt; BorrowerX.findBorrowerX2(\"Borrower3\", brs1, BorrowerX.getName(_))\nres1: BorrowerX = BorrowerX(Borrower3,3)\n\nscala&gt; BorrowerX.findBorrowerX2(\"Borrower33\", brs1, BorrowerX.getName(_))\nres2: BorrowerX = null\n</code></pre>\n\n<p>Perhaps this is not possible in Kotlin?</p>\n"}, {"tags": ["enums", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1476088860, "post_id": 39947078, "comment_id": 67188394, "body": "Very cool! You emulated the best feature of C++! See my answer for the short way."}], "tags": [], "owner": {"reputation": 244, "user_id": 6271926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HY7cQ.png?s=128&g=1", "display_name": "griffio", "link": "https://stackoverflow.com/users/6271926/griffio"}, "is_accepted": true, "score": 2, "last_activity_date": 1476037849, "creation_date": 1476037849, "answer_id": 39947078, "question_id": 39946802, "link": "https://stackoverflow.com/questions/39946802/how-may-i-get-kotlin-enum-same-behaviours-as-cpp-ones/39947078#39947078", "title": "How may I get Kotlin enum same behaviours as cpp ones", "body": "<p>I think you just need to set the value and move the increment around to make it work - so the initial counter and value are the same.</p>\n\n<pre><code>enum class Dxgi_format_gli {\n\n  DXGI_FORMAT_R64_UINT_GLI(1),\n  DXGI_FORMAT_R64_SINT_GLI;\n\n  val value: Int\n\n  private object Counter {\n    var value: Int = 0\n  }\n\n  constructor() {\n    Counter.value++\n    value = Counter.value.toInt()\n  }\n\n  private constructor(value: Int) {\n    this.value = value\n    Counter.value = value\n  }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5577, "user_id": 1047713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bd4a6e80c7c52685a465ef6fd4ebde3?s=128&d=identicon&r=PG", "display_name": "elect", "link": "https://stackoverflow.com/users/1047713/elect"}, "edited": false, "score": 0, "creation_date": 1476089589, "post_id": 39954356, "comment_id": 67188808, "body": "Thanks for your answer, however I don&#39;t start from <code>0</code> because this is the cpp code I am porting (there is an explanation btw)"}, {"owner": {"reputation": 5577, "user_id": 1047713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bd4a6e80c7c52685a465ef6fd4ebde3?s=128&d=identicon&r=PG", "display_name": "elect", "link": "https://stackoverflow.com/users/1047713/elect"}, "edited": false, "score": 0, "creation_date": 1476120104, "post_id": 39954356, "comment_id": 67206819, "body": "Cool suggestion <code>val value = ordinal + 1</code> voddan, +1 :p"}], "tags": [], "owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "is_accepted": false, "score": 6, "last_activity_date": 1476088735, "creation_date": 1476088735, "answer_id": 39954356, "question_id": 39946802, "link": "https://stackoverflow.com/questions/39946802/how-may-i-get-kotlin-enum-same-behaviours-as-cpp-ones/39954356#39954356", "title": "How may I get Kotlin enum same behaviours as cpp ones", "body": "<p>Every <code>enum</code> already has an auto-generated property <code>ordinal</code>:</p>\n\n<pre><code>enum class A {a, b, c}\n\nA.a.ordinal  // 0\nA.b.ordinal  // 1\nA.c.ordinal  // 2\n</code></pre>\n\n<p>So technically the easiest way to get what you want is <code>dxgi_format_gli.DXGI_FORMAT_R64_UINT_GLI.ordinal + 1</code> (I have no idea why don't you want to start with <code>0</code> 0_o)</p>\n\n<p>You may replace the code in the @griffio's answer with this:</p>\n\n<pre><code>enum class Dxgi_format_gli {\n\n  DXGI_FORMAT_R64_UINT_GLI,\n  DXGI_FORMAT_R64_SINT_GLI;\n\n  val value = ordinal + 1\n}\n</code></pre>\n"}], "owner": {"reputation": 5577, "user_id": 1047713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bd4a6e80c7c52685a465ef6fd4ebde3?s=128&d=identicon&r=PG", "display_name": "elect", "link": "https://stackoverflow.com/users/1047713/elect"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 559, "favorite_count": 0, "accepted_answer_id": 39947078, "answer_count": 2, "score": 1, "last_activity_date": 1489678166, "creation_date": 1476036176, "last_edit_date": 1489678166, "question_id": 39946802, "link": "https://stackoverflow.com/questions/39946802/how-may-i-get-kotlin-enum-same-behaviours-as-cpp-ones", "title": "How may I get Kotlin enum same behaviours as cpp ones", "body": "<p>I'd like to get the same behaviour as cpp:</p>\n\n<pre><code>enum dxgi_format_gli\n{\n    DXGI_FORMAT_R64_UINT_GLI = 1,\n    DXGI_FORMAT_R64_SINT_GLI\n}\n</code></pre>\n\n<p>where <code>DXGI_FORMAT_R64_UINT_GLI</code> gets 1 and the next gets 2</p>\n\n<p>the closest I got is:</p>\n\n<pre><code>private var counter: Int = 2;\n\nenum class dxgi_format_gli(i: Int = counter++) {\n\n    DXGI_FORMAT_R64_UINT_GLI(1),\n    DXGI_FORMAT_R64_SINT_GLI()\n}\n</code></pre>\n\n<p>However I'd like it, of course, to be dynamic, that is whenever I call the constructor with a parameter, save that one in <code>counter</code> and all the following constructors increment and get it..</p>\n\n<p>I already made it in java:</p>\n\n<pre><code>public enum Dxgi_format_gli {\n\n    DXGI_FORMAT_R64_UINT_GLI(1),\n    DXGI_FORMAT_R64_SINT_GLI;\n\n    public final int value;\n\n    private static class Counter {\n\n        private static short value = 0;\n    }\n\n    private Dxgi_format_gli() {\n        value = Counter.value;\n        Counter.value++;\n    }\n\n    private Dxgi_format_gli(int value) {\n        this.value = value;\n        Counter.value++;\n    }\n}\n</code></pre>\n\n<p>But I didn't make it using Kotlin..</p>\n"}, {"tags": ["kotlin"], "answers": [{"comments": [{"owner": {"reputation": 557, "user_id": 2202921, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/d8fffb4feb520571810c9770c96dd355?s=128&d=identicon&r=PG", "display_name": "user19937", "link": "https://stackoverflow.com/users/2202921/user19937"}, "edited": false, "score": 0, "creation_date": 1476025015, "post_id": 39941008, "comment_id": 67170172, "body": "So, what you are hinting is: adjust the syntax towards a host language (kotlin/Groovy) and extend the editors content assist for only the bits of syntax (for ex, the path expression)."}, {"owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "reply_to_user": {"reputation": 557, "user_id": 2202921, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/d8fffb4feb520571810c9770c96dd355?s=128&d=identicon&r=PG", "display_name": "user19937", "link": "https://stackoverflow.com/users/2202921/user19937"}, "edited": false, "score": 0, "creation_date": 1476028872, "post_id": 39941008, "comment_id": 67171328, "body": "Yes, you could do that."}], "tags": [], "owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "is_accepted": true, "score": 4, "last_activity_date": 1475997356, "creation_date": 1475997356, "answer_id": 39941008, "question_id": 39937546, "link": "https://stackoverflow.com/questions/39937546/dynamic-dsl-using-kotlin-with-content-assist/39941008#39941008", "title": "dynamic dsl using kotlin with content assist", "body": "<p>First, the syntax of your example is not valid Kotlin, so no, you can't build it as a Kotlin DSL. If you could change the syntax so that the path is stored in a string literal, then this would be valid Kotlin.</p>\n\n<p>Second, you can build a plugin for IntelliJ IDEA which would provide this kind of content assist and on-the-fly validation for any language - Java, Kotlin or anything else. The effort required to build such a plugin doesn't depend much on the language you're supporting; using Kotlin won't make it any easier to create such a plugin.</p>\n"}], "owner": {"reputation": 557, "user_id": 2202921, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/d8fffb4feb520571810c9770c96dd355?s=128&d=identicon&r=PG", "display_name": "user19937", "link": "https://stackoverflow.com/users/2202921/user19937"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 39941008, "answer_count": 1, "score": 1, "last_activity_date": 1475997356, "creation_date": 1475961870, "question_id": 39937546, "link": "https://stackoverflow.com/questions/39937546/dynamic-dsl-using-kotlin-with-content-assist", "title": "dynamic dsl using kotlin with content assist", "body": "<p>Does kotlin help building the following dsl ?</p>\n\n<pre><code>test 'test_01' {\n  description \" test that a user by name tom is present\n  author : xyz\n  GET /userstore/users/user(name=tom) {\n     verify(/first-name == 'Tom')\n  }\n}\n</code></pre>\n\n<p>in this dsl, the following are static parts</p>\n\n<blockquote>\n  <p>test, description, author, GET, verify</p>\n</blockquote>\n\n<p>but, the expression</p>\n\n<blockquote>\n  <p>/userstore/users/user(name=tom)</p>\n</blockquote>\n\n<p>is to be supported dynamically. Meaning, the application knows about various domain models that are navigable by the '/' separated syntax. the IDE (Intellij), should give me the content assist when I invoke it . For example, after GET if I type a '/' and invoke ca , it should give me the following options </p>\n\n<ol>\n<li>userstore</li>\n<li>bookstore</li>\n<li>buildings\netc</li>\n</ol>\n\n<p>The fact is, I do not not know these entries at development time. I can write code that can return these entries. I need the editor to invoke my code and get the content assist candidates. </p>\n\n<p>And, I need the build to flag errors if the expression is formed with invalid tokens. So, I need the editor to keep checking with my code and when a token is not found in the returned list of candidates should flag error in the editor. </p>\n"}, {"tags": ["maven", "intellij-idea", "kotlin"], "comments": [{"owner": {"reputation": 22943, "user_id": 870674, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0463b7a46ed49025082a795ac2f67f49?s=128&d=identicon&r=PG", "display_name": "klimat", "link": "https://stackoverflow.com/users/870674/klimat"}, "edited": false, "score": 2, "creation_date": 1475951517, "post_id": 39935855, "comment_id": 67153673, "body": "Hit alt+enter on that line. IDEA should suggest you a solution. Pick one."}, {"owner": {"reputation": 543, "user_id": 1929013, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/11f5a7ee410a95d7fca8faf6dd7398f4?s=128&d=identicon&r=PG", "display_name": "cannot_mutably_borrow", "link": "https://stackoverflow.com/users/1929013/cannot-mutably-borrow"}, "reply_to_user": {"reputation": 22943, "user_id": 870674, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0463b7a46ed49025082a795ac2f67f49?s=128&d=identicon&r=PG", "display_name": "klimat", "link": "https://stackoverflow.com/users/870674/klimat"}, "edited": false, "score": 0, "creation_date": 1475951634, "post_id": 39935855, "comment_id": 67153715, "body": "Woah! Thanks :)"}, {"owner": {"reputation": 22943, "user_id": 870674, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0463b7a46ed49025082a795ac2f67f49?s=128&d=identicon&r=PG", "display_name": "klimat", "link": "https://stackoverflow.com/users/870674/klimat"}, "edited": false, "score": 0, "creation_date": 1475951739, "post_id": 39935855, "comment_id": 67153754, "body": "I put this as an answer ok?"}, {"owner": {"reputation": 543, "user_id": 1929013, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/11f5a7ee410a95d7fca8faf6dd7398f4?s=128&d=identicon&r=PG", "display_name": "cannot_mutably_borrow", "link": "https://stackoverflow.com/users/1929013/cannot-mutably-borrow"}, "reply_to_user": {"reputation": 22943, "user_id": 870674, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0463b7a46ed49025082a795ac2f67f49?s=128&d=identicon&r=PG", "display_name": "klimat", "link": "https://stackoverflow.com/users/870674/klimat"}, "edited": false, "score": 1, "creation_date": 1475951797, "post_id": 39935855, "comment_id": 67153771, "body": "No worries. Go ahead :)"}], "answers": [{"tags": [], "owner": {"reputation": 22943, "user_id": 870674, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0463b7a46ed49025082a795ac2f67f49?s=128&d=identicon&r=PG", "display_name": "klimat", "link": "https://stackoverflow.com/users/870674/klimat"}, "is_accepted": true, "score": 9, "last_activity_date": 1475951824, "creation_date": 1475951824, "answer_id": 39935970, "question_id": 39935855, "link": "https://stackoverflow.com/questions/39935855/using-kotlin-synthetic-properties/39935970#39935970", "title": "Using Kotlin synthetic properties", "body": "<p>Hit alt+enter on that line. IDEA should suggest you a solution. Pick one.</p>\n\n<p>Probably:</p>\n\n<p><code>deploymentOptions.config = JsonObject().put(\"http.port\", 8081)</code></p>\n"}, {"tags": [], "owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "is_accepted": false, "score": 4, "last_activity_date": 1476103613, "creation_date": 1476103613, "answer_id": 39958658, "question_id": 39935855, "link": "https://stackoverflow.com/questions/39935855/using-kotlin-synthetic-properties/39958658#39958658", "title": "Using Kotlin synthetic properties", "body": "<p>In <a href=\"https://kotlinlang.org/docs/reference/java-interop.html#getters-and-setters\" rel=\"nofollow\">Kotlin documentation for Java interop</a>, it talks about getters and setters and how they relate to properties:</p>\n\n<blockquote>\n  <p>Methods that follow the Java conventions for getters and setters (no-argument methods with names starting with get and single-argument methods with names starting with set) are represented as properties in Kotlin. </p>\n</blockquote>\n\n<p>And it provides the example:</p>\n\n\n\n<pre><code>import java.util.Calendar\n\nfun calendarDemo() {\n    val calendar = Calendar.getInstance()\n    if (calendar.firstDayOfWeek == Calendar.SUNDAY) {  // call getFirstDayOfWeek()\n        calendar.firstDayOfWeek = Calendar.MONDAY       // call setFirstDayOfWeek()\n    }\n}\n</code></pre>\n\n<p>The tip you are receiving in your IDE is telling you that it is better (idiomatic) to use the property syntax instead of calling a getter or setter directly.  Therefore instead of using:</p>\n\n<pre><code>deploymentOptions.setConfig(...)\n</code></pre>\n\n<p>You would use:</p>\n\n<pre><code>deploymentOptions.config = ...\n</code></pre>\n"}], "owner": {"reputation": 543, "user_id": 1929013, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/11f5a7ee410a95d7fca8faf6dd7398f4?s=128&d=identicon&r=PG", "display_name": "cannot_mutably_borrow", "link": "https://stackoverflow.com/users/1929013/cannot-mutably-borrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2871, "favorite_count": 0, "accepted_answer_id": 39935970, "answer_count": 2, "score": 5, "last_activity_date": 1549598130, "creation_date": 1475951199, "last_edit_date": 1549598130, "question_id": 39935855, "link": "https://stackoverflow.com/questions/39935855/using-kotlin-synthetic-properties", "title": "Using Kotlin synthetic properties", "body": "<p>I'm trying Vert.x in Kotlin. I have the following piece of code:</p>\n\n<pre><code>val deploymentOptions = DeploymentOptions()\ndeploymentOptions.setConfig(JsonObject().put(\"http.port\", 8081))\n</code></pre>\n\n<p>Everything works fine. However, IntelliJ IDEA reports on the second line that I should use \"Kotlin synthetic properties\".</p>\n\n<p>Any idea how to do that in this case. Also, I'm using Maven. </p>\n\n<p>Solution:</p>\n\n<pre><code>deploymentOptions.config = JsonObject().put(\"http.port\", 8081)\n</code></pre>\n\n<p>Thanks for the help :)</p>\n"}, {"tags": ["kotlin"], "comments": [{"owner": {"reputation": 11834, "user_id": 1538877, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/N9qfZ.jpg?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/1538877/ruslan"}, "edited": false, "score": 0, "creation_date": 1475925013, "post_id": 39931410, "comment_id": 67145576, "body": "both r1 and r2 vals?"}, {"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "edited": false, "score": 1, "creation_date": 1475941432, "post_id": 39931410, "comment_id": 67150401, "body": "Why check for non null values by process of elimination instead of directly checking for non null? e.g. <code>r2?.reading ?: r1?.reading ?: throw IllegalArgumentException(&quot;All nulls!&quot;)</code>"}, {"owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "reply_to_user": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "edited": false, "score": 0, "creation_date": 1476217839, "post_id": 39931410, "comment_id": 67251129, "body": "@mfulton26 the <code>if</code> expression in the question is not exhaustive, i.e. it doesn&#39;t cover the case when both <code>r1</code> and <code>r2</code> are not null. So while your suggestion might be useful in some cases, in this case it isn&#39;t equivalent."}, {"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "edited": false, "score": 0, "creation_date": 1476304380, "post_id": 39931410, "comment_id": 67293670, "body": "After another look the question&#39;s example code returns <code>r1.reading</code> when both <code>r1</code> and <code>r2</code> are not null. I think a good, idiomatic way to write this in Kotlin would be <code>(r1 ?: r2 ?: throw IllegalArgumentException(&quot;All nulls!&quot;)).reading</code>."}, {"owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "reply_to_user": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "edited": false, "score": 0, "creation_date": 1476904535, "post_id": 39931410, "comment_id": 67549358, "body": "@mfulton26 once again, in the question if both <code>r1</code> and <code>r2</code> are not null, nothing is returned and execution continues."}, {"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "reply_to_user": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "edited": false, "score": 0, "creation_date": 1476912142, "post_id": 39931410, "comment_id": 67553438, "body": "Oops. Thank you @Ilya. I see now what you mean."}], "answers": [{"comments": [{"owner": {"reputation": 4190, "user_id": 2207729, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/076e4de85fdcd7632642b930f525cfaf?s=128&d=identicon&r=PG&f=1", "display_name": "PedroD", "link": "https://stackoverflow.com/users/2207729/pedrod"}, "edited": false, "score": 0, "creation_date": 1475925546, "post_id": 39931655, "comment_id": 67145697, "body": "I see. I would only expect those !! in a multi thread context."}], "tags": [], "owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "is_accepted": true, "score": 7, "last_activity_date": 1475925068, "creation_date": 1475925068, "answer_id": 39931655, "question_id": 39931410, "link": "https://stackoverflow.com/questions/39931410/why-am-i-forced-to-use-in-a-combination-of-null-checks/39931655#39931655", "title": "Why am I forced to use !! in a combination of null checks?", "body": "<p>The Kotlin compiler does not make logical inferences in the way you expect: \"I have already checked that r1 == null and r2 == null, so now if I'm only checking for r1 == null, then it must recognize that r2 is not null\". It doesn't. You haven't checked r2 in that branch, so it doesn't see that it is not null.</p>\n\n<p>In the second case the situation is simpler: <code>if (r1 == null) { ... } else { ... }</code>. It doesn't matter that you have another check inside the <code>else</code>; the compiler sees that you're in the <code>else</code> branch of an <code>if (x == null)</code> check and understands that the value is not null.</p>\n\n<p>There is an <a href=\"https://youtrack.jetbrains.com/issue/KT-10461\">open feature request</a> for adding this kind of logic, however, it's not on the near term roadmap of the Kotlin team.</p>\n"}, {"tags": [], "owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "is_accepted": false, "score": 1, "last_activity_date": 1476217639, "last_edit_date": 1476217639, "creation_date": 1476216700, "answer_id": 39985900, "question_id": 39931410, "link": "https://stackoverflow.com/questions/39931410/why-am-i-forced-to-use-in-a-combination-of-null-checks/39985900#39985900", "title": "Why am I forced to use !! in a combination of null checks?", "body": "<p>You could slightly restructure your <code>if</code> expression, so it would make less checks and have smart-cast applied to <code>r2</code>:</p>\n\n<pre><code>if (r1 == null) {\n    if (r2 == null) throw IllegalArgumentException(\"All nulls!\")\n    return r2.reading\n} else if (r2 == null) {\n    return r1.reading\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "edited": false, "score": 0, "creation_date": 1476904675, "post_id": 40059076, "comment_id": 67549421, "body": "Note that the first implementation throws when both <code>r1</code> and <code>r2</code> are not null, when it shouldn&#39;t. The second one is also not equivalent to the code in the question."}], "tags": [], "owner": {"reputation": 953, "user_id": 6763724, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KasE6zPK7mA/AAAAAAAAAAI/AAAAAAAAABQ/r3oBivz_Atg/photo.jpg?sz=128", "display_name": "Gary LO", "link": "https://stackoverflow.com/users/6763724/gary-lo"}, "is_accepted": false, "score": 2, "last_activity_date": 1476534908, "creation_date": 1476534908, "answer_id": 40059076, "question_id": 39931410, "link": "https://stackoverflow.com/questions/39931410/why-am-i-forced-to-use-in-a-combination-of-null-checks/40059076#40059076", "title": "Why am I forced to use !! in a combination of null checks?", "body": "<p>IMHO, if some application logics are mutually exclusive. I would prefer to use <code>when {}</code> to declaratively express full conditions case by case rather than using <code>if(...) else if(..) else</code> to compose the logic.</p>\n\n<p>Using <code>when{}</code> to specify the full conditions case by case can help developers just focus on particular case which is easier for debugging and later changes.</p>\n\n<p>In contrast, an <code>if else</code> conditions forced developers to trace from the top to bottom to get the whole idea of that part logic which is comparatively difficult for others to read and difficult to point out unreachable code. </p>\n\n<p>I had met some complex <code>if else</code> codes and I have to build a truth table for understanding the whole part of logic.</p>\n\n<p>Coming back to the question. Smart case works well with <code>when{}</code> :)</p>\n\n<p>Implementation 1</p>\n\n<pre><code>val someReading = when {\n    r1 != null &amp;&amp; r2 == null -&gt; r1.reading\n    r1 == null &amp;&amp; r2 != null -&gt; r2.reading\n    else -&gt; throw IllegalArgumentException(\"All nulls!\")\n}\n</code></pre>\n\n<p>Implementation 2</p>\n\n<pre><code>val someReading =\n        r1?.reading\n        ?: r2?.reading\n        ?: throw IllegalArgumentException(\"All nulls!\")\n</code></pre>\n"}], "owner": {"reputation": 4190, "user_id": 2207729, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/076e4de85fdcd7632642b930f525cfaf?s=128&d=identicon&r=PG&f=1", "display_name": "PedroD", "link": "https://stackoverflow.com/users/2207729/pedrod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 39931655, "answer_count": 3, "score": 3, "last_activity_date": 1476534908, "creation_date": 1475923344, "last_edit_date": 1475925182, "question_id": 39931410, "link": "https://stackoverflow.com/questions/39931410/why-am-i-forced-to-use-in-a-combination-of-null-checks", "title": "Why am I forced to use !! in a combination of null checks?", "body": "<p>For this piece of code, Kotlin forces me to handle a null-check situation while on the other line it doesn't, despite being the same situation:</p>\n\n<pre><code>if (r1 == null &amp;&amp; r2 == null)\n    throw IllegalArgumentException(\"All nulls!\")\nelse if (r1 == null)\n    return r2!!.reading // &lt;----- I am forced to !! here\nelse if (r2 == null)\n    return r1.reading // &lt;----- The compiler does not complain in this line\n</code></pre>\n\n<p>Is this a bug or a feature?</p>\n"}, {"tags": ["android", "realm", "kotlin"], "comments": [{"owner": {"reputation": 19323, "user_id": 1389357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uy7DP.jpg?s=128&g=1", "display_name": "Christian Melchior", "link": "https://stackoverflow.com/users/1389357/christian-melchior"}, "edited": false, "score": 0, "creation_date": 1475933520, "post_id": 39926234, "comment_id": 67147901, "body": "You will get an exception if trying to register a listener on a thread that doesn&#39;t support it. So something else must be at play here. Do you perhaps close the Realm before the callback happens?"}, {"owner": {"reputation": 1052, "user_id": 2238023, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a92a99a6222b719e5b407e0ea6f7cac6?s=128&d=identicon&r=PG", "display_name": "Bryan Bryce", "link": "https://stackoverflow.com/users/2238023/bryan-bryce"}, "reply_to_user": {"reputation": 19323, "user_id": 1389357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uy7DP.jpg?s=128&g=1", "display_name": "Christian Melchior", "link": "https://stackoverflow.com/users/1389357/christian-melchior"}, "edited": false, "score": 0, "creation_date": 1475942796, "post_id": 39926234, "comment_id": 67150805, "body": "@ChristianMelchior That&#39;s good to know. No, I&#39;m not closing the Realm."}, {"owner": {"reputation": 19323, "user_id": 1389357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uy7DP.jpg?s=128&g=1", "display_name": "Christian Melchior", "link": "https://stackoverflow.com/users/1389357/christian-melchior"}, "edited": false, "score": 0, "creation_date": 1476010756, "post_id": 39926234, "comment_id": 67166086, "body": "Listeners will also not be called if the RealmResults is GC&#39;ed. However it looks like you are creating a singleton object which shouldn&#39;t be GC&#39;ed?"}, {"owner": {"reputation": 1052, "user_id": 2238023, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a92a99a6222b719e5b407e0ea6f7cac6?s=128&d=identicon&r=PG", "display_name": "Bryan Bryce", "link": "https://stackoverflow.com/users/2238023/bryan-bryce"}, "reply_to_user": {"reputation": 19323, "user_id": 1389357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uy7DP.jpg?s=128&g=1", "display_name": "Christian Melchior", "link": "https://stackoverflow.com/users/1389357/christian-melchior"}, "edited": false, "score": 0, "creation_date": 1476025544, "post_id": 39926234, "comment_id": 67170348, "body": "@ChristianMelchior correct."}, {"owner": {"reputation": 4738, "user_id": 5361964, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/mh6DJ.jpg?s=128&g=1", "display_name": "Zohab Ali", "link": "https://stackoverflow.com/users/5361964/zohab-ali"}, "edited": false, "score": 0, "creation_date": 1534369858, "post_id": 39926234, "comment_id": 90685914, "body": "@BryanBryce Did you find any solution for that?"}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 5090844, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-b-vFIiqhjfM/AAAAAAAAAAI/AAAAAAAAAAA/2XzMLGRi9Pg/photo.jpg?sz=128", "display_name": "Fabi&#225;n Bravo", "link": "https://stackoverflow.com/users/5090844/fabi%c3%a1n-bravo"}, "is_accepted": false, "score": 0, "last_activity_date": 1499207855, "creation_date": 1499207855, "answer_id": 44914788, "question_id": 39926234, "link": "https://stackoverflow.com/questions/39926234/realm-query-notification-not-firing-using-kotlin/44914788#44914788", "title": "Realm Query Notification not firing using Kotlin", "body": "<p>This happens not because you're using kotlin, it does because you're not keeping any reference to the RealmResult objects, if you are creating listeners for them, save the results first as properties or class members and then add the listeners.</p>\n"}], "owner": {"reputation": 1052, "user_id": 2238023, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a92a99a6222b719e5b407e0ea6f7cac6?s=128&d=identicon&r=PG", "display_name": "Bryan Bryce", "link": "https://stackoverflow.com/users/2238023/bryan-bryce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 606, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1499207855, "creation_date": 1475876723, "last_edit_date": 1475883387, "question_id": 39926234, "link": "https://stackoverflow.com/questions/39926234/realm-query-notification-not-firing-using-kotlin", "title": "Realm Query Notification not firing using Kotlin", "body": "<p>I'm not able to get Realm Query Notifications to fire in Android using Kotlin. I've tried the full (1) and lambda (2) syntax for this separately: </p>\n\n<pre><code>object DataService {\n\n    val realm: Realm = Realm.getDefaultInstance()\n\n    var allDogs: RealmResults&lt;Dog&gt; = realm.where(Dog::class.java).findAll()\n\n    fun start() {\n\n        // (1)\n        allDogs.addChangeListener(object: RealmChangeListener&lt;RealmResults&lt;Dog&gt;&gt; {\n            override fun onChange(element: RealmResults&lt;Dog&gt;?) {\n                print(\"Ping?\")\n            }\n        })\n\n        // (2)\n        allDogs.addChangeListener {\n            // This listener doesn't fire when I create managed the Dog object below\n            print(\"Ping?\")\n        }\n\n        realm.executeTransaction {\n            realm.createObject(Dog::class.java)\n        }\n    }\n}\n</code></pre>\n\n<p>I'm wondering if it has to do with this line from the documentation:</p>\n\n<blockquote>\n  <p>Change listeners only work on Looper threads. For non-looper threads,\n  you manually have to use Realm.waitForChange() instead.</p>\n</blockquote>\n"}, {"tags": ["java", "kotlin", "bigdecimal"], "comments": [{"owner": {"reputation": 7577, "user_id": 5638835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fba9e7db4baba416a82c4277758d886?s=128&d=identicon&r=PG&f=1", "display_name": "puhlen", "link": "https://stackoverflow.com/users/5638835/puhlen"}, "edited": false, "score": 3, "creation_date": 1475855436, "post_id": 39921191, "comment_id": 67126141, "body": "Don&#39;t use double when accuracy is important like with finances.  It might have the precision needed but not the accuracy.  Use int/long if you can, and BigDecimal if you can&#39;t, but never float/double."}, {"owner": {"reputation": 149, "user_id": 1291749, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9c84238887a6e85fd333968e59f844b2?s=128&d=identicon&r=PG", "display_name": "vocalionecho", "link": "https://stackoverflow.com/users/1291749/vocalionecho"}, "edited": false, "score": 0, "creation_date": 1475865522, "post_id": 39921191, "comment_id": 67131359, "body": "Since you took the time to provide constructive feedback, which I appreciate, I wanted to take the time to provide some to you, too.  Your reply could have been written as &quot;I see where you may have a problem. The optimizer may have eliminated a lot of the code in the Doubles section which would really invalidate the test. You may want to check out JMH which can help with just this kind of problem.&quot; The aggression and arrogance of your response may not have been intentional, but it was strong. Just saying..."}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1475866009, "post_id": 39921191, "comment_id": 67131574, "body": "FWIW, what you are missing is that <code>double</code> is hardware supported on most systems, while <code>BigDecimal</code> is purely a software type. Not sure what role the optimizer plays, but you should expect a considerable difference in speed."}, {"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1475879982, "post_id": 39921191, "comment_id": 67136965, "body": "@vocalionecho thank you for responding. I apologise. Still, JMH is necessary to judge any alternatives for this issue."}, {"owner": {"reputation": 149, "user_id": 1291749, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9c84238887a6e85fd333968e59f844b2?s=128&d=identicon&r=PG", "display_name": "vocalionecho", "link": "https://stackoverflow.com/users/1291749/vocalionecho"}, "reply_to_user": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1475886623, "post_id": 39921191, "comment_id": 67138430, "body": "I sincerely appreciate the help @voddan. You obviously know what you&#39;re talking about. I will definitely look into JMH."}], "answers": [{"tags": [], "owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "is_accepted": false, "score": 2, "last_activity_date": 1476011988, "last_edit_date": 1476011988, "creation_date": 1475877351, "answer_id": 39926332, "question_id": 39921191, "link": "https://stackoverflow.com/questions/39921191/is-there-a-way-to-make-bigdecimal-faster-than-i-have-here/39926332#39926332", "title": "Is there a way to make BigDecimal faster than I have here?", "body": "<p>You can try <a href=\"https://github.com/JavaMoney/jsr354-ri\" rel=\"nofollow\">Moneta</a>, the JSR 354 reference implementation (JavaMoney RI). It has a <code>FastMoney</code> implementation:</p>\n\n<blockquote>\n  <p><code>FastMoney</code> represents numeric representation that was optimized for speed. It represents a monetary amount only as a integral number of type <code>long</code>, hereby using a number scale of 100'000 (10^5).</p>\n</blockquote>\n\n<p>e.g.</p>\n\n<pre><code>operator fun MonetaryAmount.times(multiplicand: Double): MonetaryAmount {\n    return multiply(multiplicand)\n}\n\noperator fun MonetaryAmount.div(divisor: Double): MonetaryAmount {\n    return divide(divisor)\n}\n\nfun tryFastMoney() {\n    val currency = Monetary.getCurrency(\"USD\")\n    val arr: MutableList&lt;MonetaryAmount&gt; = arrayListOf()\n\n    for (i in 1..10000000) {\n        arr.add(FastMoney.of(i, currency))\n    }\n\n    val pi = 3.14159\n\n    for (i in 0..arr.size - 1) {\n        arr[i] = arr[i] * pi / (pi * i + 1)\n    }\n}\n\nfun main(args: Array&lt;String&gt;) {\n    val fastMoneyTime = Stopwatch.elapse(::tryFastMoney)\n    println(\"FastMoney took $fastMoneyTime ms\")\n    val doubleTime = Stopwatch.elapse(::tryDouble)\n    println(\"Double took $doubleTime ms\")\n}\n</code></pre>\n\n<pre class=\"lang-none prettyprint-override\"><code>FastMoney took 7040 ms\nDouble took 4319 ms\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "is_accepted": false, "score": 0, "last_activity_date": 1475904822, "creation_date": 1475904822, "answer_id": 39929045, "question_id": 39921191, "link": "https://stackoverflow.com/questions/39921191/is-there-a-way-to-make-bigdecimal-faster-than-i-have-here/39929045#39929045", "title": "Is there a way to make BigDecimal faster than I have here?", "body": "<p>The most common solution for finances is using <code>Int</code> or several <code>Int</code>s:</p>\n\n<pre><code>val pi = 314159  // the point is implicit. To get the real value multiply `pi * 0.00001` \n</code></pre>\n\n<p>That way you explicitly control everything about the numbers (e.i. the remainders after a division). </p>\n\n<p>You may use <code>Long</code>, but it is not atomic, and thus it is not concurrently safe. Which means that you have to synchronise on any shared <code>Long</code> you have.</p>\n\n<p>A rule of thumb is to never ever use Floating Point Arithmetics (e.i. <code>Double</code> or <code>Float</code>) for finances, because, well, its point floats, thus guaranteeing absolutely nothing when the numbers are big.  </p>\n"}, {"tags": [], "owner": {"reputation": 213390, "user_id": 642706, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/ZWEI3.jpg?s=128&g=1", "display_name": "Basil Bourque", "link": "https://stackoverflow.com/users/642706/basil-bourque"}, "is_accepted": false, "score": 2, "last_activity_date": 1475909387, "last_edit_date": 1475909387, "creation_date": 1475907903, "answer_id": 39929397, "question_id": 39921191, "link": "https://stackoverflow.com/questions/39921191/is-there-a-way-to-make-bigdecimal-faster-than-i-have-here/39929397#39929397", "title": "Is there a way to make BigDecimal faster than I have here?", "body": "<p>Yes, <code>BigDecimal</code> is appropriate for money. Or any other situation where you need accuracy rather than speed.</p>\n\n<h1>Floating-point</h1>\n\n<p>The <code>float</code>, <code>Float</code>, <code>double</code>, and <code>Double</code> types all use <a href=\"http://en.wikipedia.org/wiki/Floating_point\" rel=\"nofollow\">floating-point</a> technology. </p>\n\n<p>The purpose of floating-point is to trade away accuracy for speed of execution. So you often see extraneous incorrect digits at the end of the decimal fraction. This is acceptable for gaming, 3D visualizations, and many scientific applications. Computers commonly have specialized hardware to accelerate floating point calculations. This is possible because the IEEE has concretely standardized floating point behavior. </p>\n\n<p><strong>Floating-point is <em>not</em> acceptable for financial transactions</strong>. Nor is floating point acceptable in any other situation that expects correct fractions.</p>\n\n<h1><code>BigDecimal</code></h1>\n\n<p>The two purposes of <code>BigDecimal</code> are:</p>\n\n<ul>\n<li>Handle arbitrarily large/small number.</li>\n<li>Not use floating point technology.</li>\n</ul>\n\n<p>So, what does your app need? Slow but accurate? Or, fast but slightly inaccurate? Those are your choices. Computers are not magic, computers are not infinitely fast nor infinitely accurate. Programming is like engineering in that it is all about choosing between trade-offs according to the needs of your particular application. </p>\n\n<p><code>BigDecimal</code> is one of the biggest sleeper features in Java. Brilliant work by IBM and others. I don't know if any other development platform has such an excellent facility for accurately handling decimal numbers. See some JavaOne presentations from years ago if you want to appreciate the technical issues. </p>\n\n<p>Do <em>not</em> initialize a BigDecimal object by passing a float or double:</p>\n\n<pre><code>new BigDecimal( 1234.4321 )  // BAD - Do not do this.\n</code></pre>\n\n<p>That argument creates a <code>float</code> value which introduces the inaccuracies of floating point technology. Use the other constructors.</p>\n\n<pre><code>new BigDecimal( \"1234.4321\" )  // Good\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 1291749, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9c84238887a6e85fd333968e59f844b2?s=128&d=identicon&r=PG", "display_name": "vocalionecho", "link": "https://stackoverflow.com/users/1291749/vocalionecho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2613, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1476011988, "creation_date": 1475855148, "last_edit_date": 1475857070, "question_id": 39921191, "link": "https://stackoverflow.com/questions/39921191/is-there-a-way-to-make-bigdecimal-faster-than-i-have-here", "title": "Is there a way to make BigDecimal faster than I have here?", "body": "<p>I'm working on some financial analysis software that will need to process large (ish) volumes of data. I'd like to use BigDecimal for the accuracy (some pricing info goes to four or five digits to the right of the decimal) but I was concerned about speed.</p>\n\n<p>I wrote the following test app and it appears that BigDecimal can be 90 to 100 times slower than Doubles. I knew there would be a delta, but that's more than I was expecting. Here's a typical output after many trials.</p>\n\n<pre><code>BigDecimal took 17944 ms\nDouble took 181 ms\n</code></pre>\n\n<p>Am I missing something?</p>\n\n<p>Here is the code. I tried to make it representative of real world. I created a constant where I could (pi) but also did some inline math of numbers that would vary from data row to data row - such as pi * BigDecimal(i) + BigDecimal(1). My point being that avoiding constructors can't be the only answer.</p>\n\n<p>Fortunately, it appears Double has enough precision anyway since numbers will be typically in the format 00000.00000. Any hidden gotchas I should know about, though? Do people use Double for financial analysis software?</p>\n\n<pre><code>import java.math.BigDecimal\n\nobject Stopwatch {\n    inline fun elapse(f: () -&gt; Unit):Long {\n        val start = System.currentTimeMillis()\n        f()\n        return System.currentTimeMillis() - start\n    }\n}\n\n\nfun tryBigDecimal() {\n    val arr: MutableList&lt;BigDecimal&gt; = arrayListOf()\n\n    for (i in 1..10000000) {\n        arr.add(BigDecimal(i))\n    }\n\n    val pi = BigDecimal(3.14159)\n\n    for (i in 0..arr.size - 1) {\n        arr[i] = arr[i] * pi / (pi * BigDecimal(i) + BigDecimal(1))\n    }\n\n    //arr.forEachIndexed { i, bigDecimal -&gt;  println(\"$i, ${bigDecimal.toString()}\")}\n}\n\nfun tryDouble() {\n    val arr: MutableList&lt;Double&gt; = arrayListOf()\n\n    for (i in 1..10000000) {\n        arr.add(i.toDouble())\n    }\n\n    val pi = 3.14159\n\n    for (i in 0..arr.size - 1) {\n        arr[i] = arr[i] * pi / (pi * i + 1)\n    }\n\n    //arr.forEachIndexed { i, bigDecimal -&gt;  println(\"$i, ${bigDecimal.toString()}\")}\n\n}\n\nfun main(args: Array&lt;String&gt;) {\n    val bigdecimalTime = Stopwatch.elapse(::tryBigDecimal)\n    println(\"BigDecimal took $bigdecimalTime ms\")\n\n    val doubleTime = Stopwatch.elapse(::tryDouble)\n    println(\"Double took $doubleTime ms\")\n}\n</code></pre>\n"}, {"tags": ["android", "kotlin"], "answers": [{"tags": [], "owner": {"reputation": 6089, "user_id": 2086009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5e7ab26eda52e199bb9e35d2a76b2dd?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/2086009/alex"}, "is_accepted": true, "score": 6, "last_activity_date": 1475826404, "last_edit_date": 1475826404, "creation_date": 1475805436, "answer_id": 39908200, "question_id": 39908136, "link": "https://stackoverflow.com/questions/39908136/handling-mutable-variables-in-multiple-functions-in-kotlin-android/39908200#39908200", "title": "Handling mutable variables in multiple functions in Kotlin Android", "body": "<p>There's two ways I know of to solve this. <a href=\"https://kotlinlang.org/docs/reference/properties.html#late-initialized-properties\" rel=\"nofollow\">Lateinit</a> and <a href=\"https://kotlinlang.org/docs/tutorials/android-plugin.html\" rel=\"nofollow\">Kotlin's Android extensions</a>.</p>\n\n<p>Lateinit lets you assign a value to a non-null type later in the classes lifespan.</p>\n\n<pre><code>lateinit var textView: TextView\n\noverride fun onCreate(savedInstanceState: Bundle?){\n  textView = findViewById(R.id.view_text)\n}\n</code></pre>\n\n<p>You can now access it without a null check.</p>\n\n<p>Or, you can use Kotlin's extensions.</p>\n\n<p>Add the plugin to your build.gradle</p>\n\n<pre><code>apply plugin: 'kotlin-android'\napply plugin: 'kotlin-android-extensions'\n</code></pre>\n\n<p>And import the generated accessors into your Activity, Fragment or whatever.</p>\n\n<pre><code>import kotlinx.android.synthetic.main.layout_name.*\n\ntext_view_id.text = \"Hello World!\"\n</code></pre>\n"}], "owner": {"reputation": 5267, "user_id": 1402526, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ac51b7f80f4b662e824156306d5fff9c?s=128&d=identicon&r=PG", "display_name": "Muz", "link": "https://stackoverflow.com/users/1402526/muz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 39908200, "answer_count": 1, "score": 1, "last_activity_date": 1475826404, "creation_date": 1475804802, "question_id": 39908136, "link": "https://stackoverflow.com/questions/39908136/handling-mutable-variables-in-multiple-functions-in-kotlin-android", "title": "Handling mutable variables in multiple functions in Kotlin Android", "body": "<p>I want to do Kotlin in Android but I have some issues with mutables. Let's say I'm doing a <code>TextView</code> that's accessed across multiple methods.</p>\n\n<pre><code>var tv: TextView? = null\n\noverride fun onCreate(savedInstanceState: Bundle?) {\n    tv = find(R.id.tv)\n}\n\nfun clearText(){\n    tv?.setText(\"\")\n}\n\nfun setText(text: String) {\n    tv?.setText(text)\n}\n</code></pre>\n\n<p>This works, but having <code>tv?</code> every time I use the TextView is a code smell. Is there a better way of doing this? I feel like I should be using <code>val</code> instead of <code>var</code> but I can't find a way to put it in.</p>\n"}, {"tags": ["unit-testing", "kotlin"], "answers": [{"tags": [], "owner": {"reputation": 10814, "user_id": 891242, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5719e9d6125bf8f75501a83e68b11412?s=128&d=identicon&r=PG", "display_name": "ZakTaccardi", "link": "https://stackoverflow.com/users/891242/zaktaccardi"}, "is_accepted": true, "score": 4, "last_activity_date": 1475776434, "creation_date": 1475776434, "answer_id": 39902648, "question_id": 39902610, "link": "https://stackoverflow.com/questions/39902610/mock-kotlin-class-in-java-unit-test/39902648#39902648", "title": "Mock Kotlin class in Java unit test", "body": "<p>this library may solve your issue <a href=\"https://github.com/nhaarman/mockito-kotlin\" rel=\"noreferrer\">https://github.com/nhaarman/mockito-kotlin</a></p>\n\n<p>EDIT: sorry, didn't realize you were using a Java test. If it's an option, try writing your test in kotlin too</p>\n"}], "owner": {"reputation": 19583, "user_id": 3026283, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/SyT5b.png?s=128&g=1", "display_name": "H&#233;ctor", "link": "https://stackoverflow.com/users/3026283/h%c3%a9ctor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1043, "favorite_count": 0, "accepted_answer_id": 39902648, "answer_count": 1, "score": 1, "last_activity_date": 1475836758, "creation_date": 1475776327, "question_id": 39902610, "link": "https://stackoverflow.com/questions/39902610/mock-kotlin-class-in-java-unit-test", "title": "Mock Kotlin class in Java unit test", "body": "<p>I have this Java test with Mockito:</p>\n\n<pre><code>public class PersistentNodeDeserializerTests {\n\n    @Test\n    public void userInfoPersistentNodeDeserializer() {\n        PersistentNode node = mock(PersistentNode.class);\n        when(node.stringChild(\"username\")).thenReturn(\"cliff12\");\n        //more stuff\n    }\n\n}\n</code></pre>\n\n<p><strong>PersistentNode</strong> is a Kotlin class:</p>\n\n<pre><code>open class PersistentNode(private val path: PersistentNodePath, val content: Any) {\n\n    val stringPath: String\n        get() = path.get()\n\n    val key: String\n        get() {\n            val parts = stringPath.split(\"/\");\n            return parts[parts.size - 1];\n        }\n\n    val mapContent: Map&lt;String, Any&gt;\n        get() {\n            return content as HashMap&lt;String, Any&gt;\n        }\n\n    fun stringChild(child: String): String {\n        return mapContent.get(child) as String\n    }\n\n}\n</code></pre>\n\n<p>I get this error:</p>\n\n<blockquote>\n  <p>kotlin.TypeCastException: null cannot be cast to non-null type\n  java.util.HashMap</p>\n</blockquote>\n\n<p>How can I mock the property <code>stringChild</code> properly?</p>\n"}, {"tags": ["spring-security", "kotlin", "spring-security-oauth2"], "comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1475791465, "post_id": 39900723, "comment_id": 67098041, "body": "one side note, on the overridden <code>configure</code> function you can change the nullability to just <code>HttpSecurity</code> if you know this function never really receives a null and it is still a valid override.  Will allow you to remove all the <code>?</code> null safety."}, {"owner": {"reputation": 148, "user_id": 2030852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba8be7da342a238e320de7e33dfe863f?s=128&d=identicon&r=PG", "display_name": "Erich Oliphant", "link": "https://stackoverflow.com/users/2030852/erich-oliphant"}, "reply_to_user": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1475801587, "post_id": 39900723, "comment_id": 67100774, "body": "Yeah, I&#39;d actually gotten around to fixing that.  The ? was added when I used the &#39;generate override..&#39;"}, {"owner": {"reputation": 3781, "user_id": 3212712, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/eZV9f.jpg?s=128&g=1", "display_name": "mohax", "link": "https://stackoverflow.com/users/3212712/mohax"}, "edited": false, "score": 0, "creation_date": 1523401279, "post_id": 39900723, "comment_id": 86543644, "body": "@ErichOliphant, did you find solution? =)"}], "owner": {"reputation": 148, "user_id": 2030852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba8be7da342a238e320de7e33dfe863f?s=128&d=identicon&r=PG", "display_name": "Erich Oliphant", "link": "https://stackoverflow.com/users/2030852/erich-oliphant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 271, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1475788133, "creation_date": 1475769717, "last_edit_date": 1475788133, "question_id": 39900723, "link": "https://stackoverflow.com/questions/39900723/enabling-login-page-for-spring-authorization-resource-server", "title": "Enabling login page for spring Authorization/Resource server", "body": "<p>I'm trying to get OAuth2 based SSO working with spring. I've created a server and client, but I've run into an issue where after enabling the Authorization and Resource server.  </p>\n\n<pre><code>@SpringBootApplication\n@EnableAuthorizationServer\n@EnableResourceServer\nopen class GsAuthenticationApplication {\n    companion object {\n        @JvmStatic  fun main(args: Array&lt;String&gt;) {\n            SpringApplication.run(GsAuthenticationApplication::class.java, *args)\n        }\n\n    }\n}\n</code></pre>\n\n<p>Once that's all wired up, the generated /login page is no longer available, as it seems to be treated as an protected OAuth resource </p>\n\n<pre><code>&lt;oauth&gt;\n&lt;error_description&gt;\nFull authentication is required to access this resource\n&lt;/error_description&gt;\n&lt;error&gt;unauthorized&lt;/error&gt;\n&lt;/oauth&gt;\n</code></pre>\n\n<p>I created a WebSecurityCOnfigurerAdapter bean, and tried to explicitly set it up with the configure method below, but it's still giving me the same issue</p>\n\n<pre><code>override fun configure(http: HttpSecurity?) {\n        //super.configure(http)\n        // @formatter:off\n        http\n            ?.authorizeRequests()\n            ?.and()\n            ?.formLogin()\n                ?.loginPage(\"/login\")\n                ?.permitAll()\n        // @formatter:on\n\n    }\n</code></pre>\n"}, {"tags": ["android", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "edited": false, "score": 1, "creation_date": 1475764346, "post_id": 39898606, "comment_id": 67083081, "body": "what about Activities not having a constructor ... can u do that?"}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "reply_to_user": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "edited": false, "score": 1, "creation_date": 1475772300, "post_id": 39898606, "comment_id": 67088412, "body": "what do you mean it doesn&#39;t have a constructor, who constructs the activity?"}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "reply_to_user": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "edited": false, "score": 2, "creation_date": 1475775376, "post_id": 39898606, "comment_id": 67090053, "body": "@user3806331 ok, fixed my answer by adding default constructor that calls the other constructor"}], "tags": [], "owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "is_accepted": true, "score": 4, "last_activity_date": 1475775682, "last_edit_date": 1475775682, "creation_date": 1475763880, "answer_id": 39898606, "question_id": 39893328, "link": "https://stackoverflow.com/questions/39893328/android-kotlin-mvp-class-delegation/39898606#39898606", "title": "Android Kotlin Mvp Class delegation", "body": "<p>You can delegate both interfaces to the same object if it implements both interfaces.  To do so just make the object a constructor parameter, for example:</p>\n\n\n\n<pre><code>class NowActivity(delegate: NowDelegateImpl): AppCompatActivity(), \n                        NowScreen by delegate, \n                        NowDelegate by delegate {\n   constructor (): this(NowDelegateImpl()) {}  // need this default constructor for Android to call\n... \n}\n</code></pre>\n\n<p>If the delegate does not implement everything of both interfaces, you can make it a member and manually delegate some subset of the functions to it.</p>\n\n<pre><code>class NowActivity(private val delegate: NowDelegateImpl): \n                       AppCompatActivity(), \n                       NowScreen,\n                       NowDelegate by delegate {\n   constructor (): this(NowDelegateImpl()) {}  // need this default constructor for Android to call\n   override fun callSomeFund() { delegate.callSomeFund() }\n}\n</code></pre>\n\n<p>Both options need you to create a default constructor that creates the object used for delegation and passes that to the primary constructor.</p>\n\n<p>Here it is broken out to an all inclusive sample that isn't so Android specific in case others want to see all that is going on...  </p>\n\n<p><strong>Example 1, delegate all interfaces to same object:</strong></p>\n\n<pre><code>interface CommonStuff {\n    fun foo1()\n    fun foo2()\n}\n\ninterface LessCommonStuff {\n    fun bar()\n}\n\nclass CommonDelegate1: CommonStuff, LessCommonStuff {\n    override fun foo1() {}\n    override fun foo2() {}\n    override fun bar() {}\n}\n\nclass Activity1(delegate: CommonDelegate1): \n                          LessCommonStuff by delegate,\n                          CommonStuff by delegate {\n   constructor (): this(CommonDelegate1()) {}  // need this default constructor\n   // ...\n}\n</code></pre>\n\n<p><strong>Example 2, manually delegate some interfaces using a member:</strong></p>\n\n<pre><code>interface CommonStuff {\n    fun foo1()\n    fun foo2()\n}\n\ninterface LessCommonStuff {\n    fun bar()\n}\n\nclass CommonDelegate2: CommonStuff {\n    override fun foo1() {}\n    override fun foo2() {}\n    fun barLikeThing() {}\n}\n\nclass Activity2(private val delegate: CommonDelegate2): \n                     LessCommonStuff,\n                     CommonStuff by delegate {\n    constructor (): this(CommonDelegate2()) {}  // need this default constructor\n    override fun bar() { delegate.barLikeThing() }\n}\n</code></pre>\n"}], "owner": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 460, "favorite_count": 0, "accepted_answer_id": 39898606, "answer_count": 1, "score": 3, "last_activity_date": 1475775682, "creation_date": 1475748898, "last_edit_date": 1475753992, "question_id": 39893328, "link": "https://stackoverflow.com/questions/39893328/android-kotlin-mvp-class-delegation", "title": "Android Kotlin Mvp Class delegation", "body": "<p>So I have the following scenario:</p>\n\n<pre><code>  class NowActivity: AppCompatActivity(), NowScreen, NowDelegate by NowDelegateImpl(){\n\n  onCreate(...){\n       presenter.attachView(this)\n  }\n</code></pre>\n\n<p>Is there any way I can delegate the implementation of some <code>NowScreen</code> methods to NowDelegate so I can do the following inside the presenter:</p>\n\n<pre><code>view.callSomeFunc()\n</code></pre>\n\n<p>in which callSomeFund() is implemented in <code>NowDelegate</code>.</p>\n\n<p>Is there any way of accomplish something like this? the problem is that I'm using MVP, which attach a view to a presenter. But some of the view implementation is repeated in several activities, so I would want to delegate it to another class.</p>\n"}]