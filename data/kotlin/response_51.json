[{"tags": ["rx-java", "kotlin"], "comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451564584, "post_id": 34538029, "comment_id": 56834419, "body": "This question seems familiar, this issue came up somewhere else.  The author of the <a href=\"https://github.com/ReactiveX/RxKotlin\" rel=\"nofollow noreferrer\">Kotlin extensions to RxJava</a> is active on <a href=\"http://kotlinslackin.herokuapp.com/\" rel=\"nofollow noreferrer\">Kotlin slack</a> in the #rx channel, you can ask there and report back here if he had any further information."}, {"owner": {"reputation": 9794, "user_id": 1481408, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/929196ae336bbd9c18ad01f934b66e7a?s=128&d=identicon&r=PG", "display_name": "Deividi Cavarzan", "link": "https://stackoverflow.com/users/1481408/deividi-cavarzan"}, "reply_to_user": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451564711, "post_id": 34538029, "comment_id": 56834479, "body": "I posted yesterday in slack with no response, but I think that was on general channel... I ll try in RX again, thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451564346, "post_id": 34538532, "comment_id": 56834316, "body": "Your 2nd flavour using <code>as</code> is idiomatic for casting."}, {"owner": {"reputation": 1731, "user_id": 1308089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/805f3d71ffe7fb96225611142d126bc3?s=128&d=identicon&r=PG", "display_name": "Thomas B Homburg", "link": "https://stackoverflow.com/users/1308089/thomas-b-homburg"}, "edited": false, "score": 0, "creation_date": 1451926013, "post_id": 34538532, "comment_id": 56936929, "body": "You should define your retryFunc first parameter as invariant: <code>Observable&lt;Throwable&gt;</code> as zipWith as <code>retryWhen</code> and <code>zipWith</code> is disagreeing on variance. See <a href=\"https://kotlinlang.org/docs/reference/generics.html\" rel=\"nofollow noreferrer\">kotlinlang.org/docs/reference/generics.html</a> and <a href=\"http://try.kotlinlang.org/#/UserProjects/1s7h5gs9uqp1sf7t3bng6vaao7/f6ac4lnf541vdab9ek9cdfschn\" rel=\"nofollow noreferrer\">try.kotlinlang.org/#/UserProjects/1s7h5gs9uqp1sf7t3bng6vaao7&zwnj;&#8203;/&hellip;</a>"}, {"owner": {"reputation": 9794, "user_id": 1481408, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/929196ae336bbd9c18ad01f934b66e7a?s=128&d=identicon&r=PG", "display_name": "Deividi Cavarzan", "link": "https://stackoverflow.com/users/1481408/deividi-cavarzan"}, "reply_to_user": {"reputation": 1731, "user_id": 1308089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/805f3d71ffe7fb96225611142d126bc3?s=128&d=identicon&r=PG", "display_name": "Thomas B Homburg", "link": "https://stackoverflow.com/users/1308089/thomas-b-homburg"}, "edited": false, "score": 0, "creation_date": 1451928393, "post_id": 34538532, "comment_id": 56938267, "body": "@tommes Even use as invariant the IDE shows that need to be covariant (out Throwable)"}, {"owner": {"reputation": 1731, "user_id": 1308089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/805f3d71ffe7fb96225611142d126bc3?s=128&d=identicon&r=PG", "display_name": "Thomas B Homburg", "link": "https://stackoverflow.com/users/1308089/thomas-b-homburg"}, "edited": false, "score": 0, "creation_date": 1451928806, "post_id": 34538532, "comment_id": 56938553, "body": "That&#39;s sounds like an error. Are you sure you have removed all variance keywords? Which lines produces an error, when you mark the type as invariant?"}, {"owner": {"reputation": 1731, "user_id": 1308089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/805f3d71ffe7fb96225611142d126bc3?s=128&d=identicon&r=PG", "display_name": "Thomas B Homburg", "link": "https://stackoverflow.com/users/1308089/thomas-b-homburg"}, "edited": false, "score": 0, "creation_date": 1451933663, "post_id": 34538532, "comment_id": 56941161, "body": "At this point I&#39;d remove the Func1 type declaration and let type inference resolve the type on the lambda."}, {"owner": {"reputation": 9794, "user_id": 1481408, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/929196ae336bbd9c18ad01f934b66e7a?s=128&d=identicon&r=PG", "display_name": "Deividi Cavarzan", "link": "https://stackoverflow.com/users/1481408/deividi-cavarzan"}, "edited": false, "score": 0, "creation_date": 1451934482, "post_id": 34538532, "comment_id": 56941630, "body": "This was evaluated as same as <code>Func1&lt;Observable&lt;out Throwable&gt;, Observable&lt;Any&gt;&gt;</code>, I just put the Func1 to be more readable."}, {"owner": {"reputation": 1731, "user_id": 1308089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/805f3d71ffe7fb96225611142d126bc3?s=128&d=identicon&r=PG", "display_name": "Thomas B Homburg", "link": "https://stackoverflow.com/users/1308089/thomas-b-homburg"}, "reply_to_user": {"reputation": 9794, "user_id": 1481408, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/929196ae336bbd9c18ad01f934b66e7a?s=128&d=identicon&r=PG", "display_name": "Deividi Cavarzan", "link": "https://stackoverflow.com/users/1481408/deividi-cavarzan"}, "edited": false, "score": 0, "creation_date": 1451937102, "post_id": 34538532, "comment_id": 56942999, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/99727/discussion-between-tommes-and-deividi-cavarzan\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 9794, "user_id": 1481408, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/929196ae336bbd9c18ad01f934b66e7a?s=128&d=identicon&r=PG", "display_name": "Deividi Cavarzan", "link": "https://stackoverflow.com/users/1481408/deividi-cavarzan"}, "is_accepted": true, "score": 2, "last_activity_date": 1451531328, "last_edit_date": 1451531328, "creation_date": 1451516217, "answer_id": 34538532, "question_id": 34538029, "link": "https://stackoverflow.com/questions/34538029/kotlin-wildcard-method/34538532#34538532", "title": "Kotlin wildcard method", "body": "<p>Found a solution:</p>\n\n<p><code>it.cast(Throwable::class.java).zipWith</code></p>\n\n<p>Or this one:</p>\n\n<p><code>(observable as Observable&lt;Throwable&gt;).zipWith</code></p>\n\n<p>Casting with <code>Throwable</code> solves, I hope that Kotlin has another way (not depending on <code>Observable.cast</code> method).</p>\n"}], "owner": {"reputation": 9794, "user_id": 1481408, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/929196ae336bbd9c18ad01f934b66e7a?s=128&d=identicon&r=PG", "display_name": "Deividi Cavarzan", "link": "https://stackoverflow.com/users/1481408/deividi-cavarzan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1255, "favorite_count": 0, "accepted_answer_id": 34538532, "answer_count": 1, "score": 2, "last_activity_date": 1505854361, "creation_date": 1451513474, "last_edit_date": 1505854361, "question_id": 34538029, "link": "https://stackoverflow.com/questions/34538029/kotlin-wildcard-method", "title": "Kotlin wildcard method", "body": "<p>I'm having some problems using the <code>retryWhen</code> function in RxJava.</p>\n\n<p>When I create a function to be passed to <code>retryWhen</code> in an <code>Observable</code>, I cannot call the <code>zipWith</code> function. It seems that Kotlin is expecting something that cannot be cast here.</p>\n\n<p>In this example, <code>it.zipWith</code> doesn't work (some other methods are available, but not this one):</p>\n\n<pre><code>    val retryFunc = Func1&lt;Observable&lt;out Throwable&gt;, Observable&lt;Any&gt;&gt; {\n        // zipWith is not possible to call\n        it.zipWith&lt;Int, Any&gt;(Observable.range(1, 3), Func2&lt;Throwable, Int, Any&gt; { throwable, integer -&gt;\n            if (integer &gt; 2) {\n                return@Func2 Observable.error&lt;Any&gt;(Exception())\n            }\n            Observable.timer(1, TimeUnit.SECONDS)\n        })\n    }\n\n    Observable.just(\"1\", \"2\", \"3\").retryWhen(retryFunc)\n</code></pre>\n\n<hr>\n\n<p>If I change the incoming parameters to <code>Func1&lt;Observable&lt;in Throwable&gt; ...</code>, the <code>in</code> keyword make it possible to use the <code>zipWith</code> function. But after I changed, the call <code>retryWhen(retryFunc)</code> shows an error:</p>\n\n<blockquote>\n  <p>Type mismatch: Expecting out Throwable, found in Throwable</p>\n</blockquote>\n\n<pre><code>    val retryFunc = Func1&lt;Observable&lt;in Throwable&gt;, Observable&lt;Any&gt;&gt; {\n        it.zipWith&lt;Int, Any&gt;(Observable.range(1, 3), Func2&lt;Throwable, Int, Any&gt; { throwable, integer -&gt;\n            if (integer &gt; 2) {\n                return@Func2 Observable.error&lt;Any&gt;(Exception())\n            }\n            Observable.timer(1, TimeUnit.SECONDS)\n        })\n    }\n\n    Observable.just(\"1\", \"2\", \"3\").retryWhen(retryFunc) // type mismatch here, expected out, found in\n</code></pre>\n\n<p>Does anyone know how can I receive and produce the same type in Kotlin? </p>\n\n<p>Be able to create the <code>zipWith</code> and return the expected value?</p>\n"}, {"tags": ["generics", "kotlin"], "comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451505690, "post_id": 34526021, "comment_id": 56814470, "body": "<code>FolderChooserView</code> is an interface, and do all view interfaces have a common ancestor interface?"}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451507216, "post_id": 34526021, "comment_id": 56815209, "body": "Adding the <code>android</code> tag might help if this is a common issue in the Android class hierarchies, someone else might have solved it.  Likely if solved with Java generics, it would be the same solution for Kotlin.  You might want to ask it with the <code>java</code> tag as well and then edit the question to say for Java or Kotlin how would you solve this problem with generics while avoiding a possible runtime unchecked cast.  It doesn&#39;t need to be limited to Kotlin."}, {"owner": {"reputation": 5871, "user_id": 3761545, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/uypve.jpg?s=128&g=1", "display_name": "Paul Woitaschek", "link": "https://stackoverflow.com/users/3761545/paul-woitaschek"}, "reply_to_user": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451507408, "post_id": 34526021, "comment_id": 56815322, "body": "Yes it is an interface. No they don&#39;t have a common ancestor interface. But if that would solve the problem and get around casting that is an option."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451509088, "post_id": 34526021, "comment_id": 56816212, "body": "It doesn&#39;t solve the problem actually, you would be casting from the ancestor to the descendant which still requires unchecked cast.  See my answer below, I tried."}], "answers": [{"comments": [{"owner": {"reputation": 5871, "user_id": 3761545, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/uypve.jpg?s=128&g=1", "display_name": "Paul Woitaschek", "link": "https://stackoverflow.com/users/3761545/paul-woitaschek"}, "edited": false, "score": 0, "creation_date": 1451484429, "post_id": 34526297, "comment_id": 56803443, "body": "Hm, I don&#39;t like this. I am thinking about designing this as a general Library so I really want to avoid these kinds of unchecked casts. Is there no solution to what I want to achieve?"}, {"owner": {"reputation": 89682, "user_id": 675383, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e7a971eb341ffeaa3efca407239bf3b?s=128&d=identicon&r=PG", "display_name": "nhaarman", "link": "https://stackoverflow.com/users/675383/nhaarman"}, "reply_to_user": {"reputation": 5871, "user_id": 3761545, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/uypve.jpg?s=128&g=1", "display_name": "Paul Woitaschek", "link": "https://stackoverflow.com/users/3761545/paul-woitaschek"}, "edited": false, "score": 0, "creation_date": 1451484661, "post_id": 34526297, "comment_id": 56803557, "body": "I have dealt with this as well, and had a proper solution, which turned out to be way to complex. See <a href=\"https://github.com/nhaarman/Triad/blob/44c20dbf44006bf4d0c0962d382f2daa4dfe75fd/triad/src/main/java/com/nhaarman/triad/Presenter.java\" rel=\"nofollow noreferrer\">Presenter</a>,  <a href=\"https://github.com/nhaarman/Triad/blob/44c20dbf44006bf4d0c0962d382f2daa4dfe75fd/triad/src/main/java/com/nhaarman/triad/Container.java\" rel=\"nofollow noreferrer\">Container</a> and the base <a href=\"https://github.com/nhaarman/Triad/blob/44c20dbf44006bf4d0c0962d382f2daa4dfe75fd/triad/src/main/java/com/nhaarman/triad/RelativeLayoutContainer.java\" rel=\"nofollow noreferrer\">RelativeLayoutContainer</a> (in java)."}, {"owner": {"reputation": 89682, "user_id": 675383, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e7a971eb341ffeaa3efca407239bf3b?s=128&d=identicon&r=PG", "display_name": "nhaarman", "link": "https://stackoverflow.com/users/675383/nhaarman"}, "reply_to_user": {"reputation": 5871, "user_id": 3761545, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/uypve.jpg?s=128&g=1", "display_name": "Paul Woitaschek", "link": "https://stackoverflow.com/users/3761545/paul-woitaschek"}, "edited": false, "score": 0, "creation_date": 1451484752, "post_id": 34526297, "comment_id": 56803613, "body": "These are files of an older version of a library of mine, where the generic types of the Presenter and View reference eachother to enforce proper behavior. Unfortunately <a href=\"https://github.com/nhaarman/Triad/blob/44c20dbf44006bf4d0c0962d382f2daa4dfe75fd/triad-sample/app/src/main/java/com/nhaarman/triad/sample/notes/noteslist/NoteView.java\" rel=\"nofollow noreferrer\">this requires a lot of sort of complex boilerplate</a>."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451507820, "post_id": 34526297, "comment_id": 56815562, "body": "This cast isn&#39;t such a bad thing, there are not a lot of good answers for this if any.  You can always add an assert that gives a really direct error message and since these happen immediately when an activity is created, you&#39;ll see the error very early in testing."}, {"owner": {"reputation": 89682, "user_id": 675383, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e7a971eb341ffeaa3efca407239bf3b?s=128&d=identicon&r=PG", "display_name": "nhaarman", "link": "https://stackoverflow.com/users/675383/nhaarman"}, "edited": false, "score": 0, "creation_date": 1451509006, "post_id": 34526297, "comment_id": 56816168, "body": "Yes, that&#39;s why I chose to do it this way."}], "tags": [], "owner": {"reputation": 89682, "user_id": 675383, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e7a971eb341ffeaa3efca407239bf3b?s=128&d=identicon&r=PG", "display_name": "nhaarman", "link": "https://stackoverflow.com/users/675383/nhaarman"}, "is_accepted": false, "score": 0, "last_activity_date": 1451466556, "creation_date": 1451466556, "answer_id": 34526297, "question_id": 34526021, "link": "https://stackoverflow.com/questions/34526021/generics-abstract-class-and-type-of-child/34526297#34526297", "title": "Generics: Abstract class and type of child", "body": "<p>You can add two generic parameters to your <code>BaseView</code> class, and cast <code>this</code> to <code>V</code>:</p>\n\n<pre><code>open class Presenter&lt;V&gt; {\n    fun bind(v: V) {}\n}\n\nopen class BaseView&lt;P, V&gt; where P : Presenter&lt;V&gt; {\n  lateinit var presenter: P\n\n  fun onStart() {\n    p.bind(this as V)\n  }\n}\n</code></pre>\n\n<p>You would use this like</p>\n\n<pre><code>class FolderPresenter : Presenter&lt;FolderChooserView&gt;() {\n\n}\n\nclass FolderChooserView : BaseView&lt;FolderPresenter, FolderChooserView&gt;()\n</code></pre>\n\n<p>Unfortunately, you won't get any help from your compiler if you mix up the parameters, due to the unchecked cast:</p>\n\n<pre><code>class SomeOtherView : BaseView&lt;SomeOtherPresenter, FolderChooserView&gt;()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "is_accepted": false, "score": 0, "last_activity_date": 1451508775, "creation_date": 1451508775, "answer_id": 34537074, "question_id": 34526021, "link": "https://stackoverflow.com/questions/34526021/generics-abstract-class-and-type-of-child/34537074#34537074", "title": "Generics: Abstract class and type of child", "body": "<p>The answer from @nhaarman is close but leaves open the hole if the class being bound is not actually the type of the view.      </p>\n\n<p>This cast isn't such a bad thing, there are not a lot of good answers for this if any. You can always add an assert that gives a really direct error message and since these happen immediately when an activity is created, you'll see the error very early in testing</p>\n\n<p>I don't think you'll easily get to a better answer without creating something that manages all parts of the relationship as one.  I think his answer has minimal risk.  </p>\n\n<p><strong>Compile time checking to avoid runtime error</strong></p>\n\n<p>You could write a function that can check the missing piece at compile time and people could use it like a compile-time assert.</p>\n\n<pre><code>// a function that is used when people want to check validity at compile time,\n// it does nothing but cause compiler error if wrong heirarchy\n\nfun &lt;A: V, P: Presenter&lt;V&gt;, V : View&gt; checkValid() {\n    // empty on purpose, used for compile time check\n}\n\n// successful:\ncheckValid&lt;FolderChooserActivity, FolderPresenter, FolderChooserView&gt;()\n\n// error below: \"Kotlin: Type argument is not within its bounds: should be subtype of 'test.so.FolderChooserView'\"\ncheckValid&lt;TryingToFoolItActivity, FolderPresenter, FolderChooserView&gt;()\n\n// this is blocked because SomeOtherActivity has its own compiler error so SomeOtherActivity type is not fully known\ncheckValid&lt;SomeOtherActivity, FolderPresenter, FolderChooserView&gt;()\n</code></pre>\n\n<p><strong>Using a function to create the class, with compile time checking to avoid runtime error</strong></p>\n\n<p>You can also require that a function be used to construct the <code>*Activity</code> class.  But if you can't enforce people ensuring they have the right view base class, you can't enforce the use of this function.  Here it is anyway, just to give more ideas to this problem.</p>\n\n\n\n<pre><code>inline fun &lt;reified A: V, P: Presenter&lt;V&gt;, V : View&gt; makeActivity(): A {\n    return A::class.java.newInstance() \n}\n\n// successful:\nval good1 = makeActivity&lt;FolderChooserActivity, FolderPresenter, FolderChooserView&gt;()\n\n// error below: \"Kotlin: Type argument is not within its bounds: should be subtype of 'test.so.FolderChooserView'\"\nval bad1 = makeActivity&lt;TryingToFoolItActivity, FolderPresenter, FolderChooserView&gt;()\n</code></pre>\n\n<p><strong>Full code:</strong></p>\n\n<p>I'm putting full code here so I can explore this more and try to get an alternative complete answer.  This is really just a variation of @nhaarman's answer.</p>\n\n<pre><code>// sample classes\n\nclass FolderPresenter : Presenter&lt;FolderChooserView&gt;() { }\n\nclass BadPresenter : Presenter&lt;RandomView&gt;() { }\n\n// successful declaration\nclass FolderChooserActivity : BaseActivity&lt;FolderPresenter, FolderChooserView&gt;(), FolderChooserView { }\n\n// Error: \"Kotlin: Type argument is not within its bounds: should be subtype of 'test.so.Presenter&lt;test.renlearn.solrpref.FolderChooserView&gt;'\"\nclass SomeOtherActivity : BaseActivity&lt;BadPresenter, FolderChooserView&gt;(), FolderChooserView {}\n\n// Runtime error, we are not a FolderChooserView\nclass TryingToFoolItActivity : BaseActivity&lt;FolderPresenter, FolderChooserView&gt;() {}\n\n// now the version using a function to construct the activity, where\n// this function adds the missing step of compiler time validation.\n\ninline fun &lt;reified A: V, P: Presenter&lt;V&gt;, V : View&gt; makeActivity(): A {\n    return A::class.java.newInstance()\n}\n\n// or a function that is used when people want to check validity at compile time,\n// it does nothing but cause compiler error if wrong heirarchy\n\nfun &lt;A: V, P: Presenter&lt;V&gt;, V : View&gt; checkValid() {\n    // empty on purpose, used for compile time check\n}\n\npublic fun foo() {\n    // successful:\n    val good1 = makeActivity&lt;FolderChooserActivity, FolderPresenter, FolderChooserView&gt;()\n\n    // error below: \"Kotlin: Type argument is not within its bounds: should be subtype of 'test.so.FolderChooserView'\"\n    val bad1 = makeActivity&lt;TryingToFoolItActivity, FolderPresenter, FolderChooserView&gt;()\n\n    // this is blocked because SomeOtherActivity has its own compiler error so SomeOtherActivity type is not fully known\n    val bad2 = makeActivity&lt;SomeOtherActivity, FolderPresenter, FolderChooserView&gt;()\n\n    // successful:\n    checkValid&lt;FolderChooserActivity, FolderPresenter, FolderChooserView&gt;()\n\n    // error below: \"Kotlin: Type argument is not within its bounds: should be subtype of 'test.so.FolderChooserView'\"\n    checkValid&lt;TryingToFoolItActivity, FolderPresenter, FolderChooserView&gt;()\n\n    // this is blocked because SomeOtherActivity has its own compiler error so SomeOtherActivity type is not fully known\n    checkValid&lt;SomeOtherActivity, FolderPresenter, FolderChooserView&gt;()\n}\n</code></pre>\n"}], "owner": {"reputation": 5871, "user_id": 3761545, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/uypve.jpg?s=128&g=1", "display_name": "Paul Woitaschek", "link": "https://stackoverflow.com/users/3761545/paul-woitaschek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1132, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1451508775, "creation_date": 1451465429, "question_id": 34526021, "link": "https://stackoverflow.com/questions/34526021/generics-abstract-class-and-type-of-child", "title": "Generics: Abstract class and type of child", "body": "<p>\nI have an abstract class called presenter:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>abstract class Presenter&lt;V&gt; {\n\n    fun bind(view: V) {\n        ...\n    }\n\n    ...\n}\n</code></pre>\n\n<p>And I have implementations of these presenters:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>class FolderChooserPresenter : Presenter&lt;FolderChooserView&gt;() {\n    ...\n}\n</code></pre>\n\n<p>And view classes which call the bind method at a specified point:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>class FolderChooserActivity : BaseView(), FolderChooserView {\n\n    @Inject lateinit var presenter: FolderChooserPresenter\n\n    // method of baseview\n    override fun onStart() {\n        super.onStart()\n\n        presenter.bind(this)\n    }\n}\n</code></pre>\n\n<p>What I would like to archieve is to have a base class for classes like the <code>FolderChooserActivity</code> which automatically call the bind method.<br>\nIt feels stupid to repeat these calls over and over again in all implementations. </p>\n\n<p>My approach is to have an abstract class which extends the <code>BaseView</code> which calls the bind method. But that obviously does not work as the bind class requires the implementation and not the abstract class.</p>\n"}, {"tags": ["arrays", "generics", "kotlin"], "comments": [{"owner": {"reputation": 16853, "user_id": 4101725, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dGwoPMFb_tM/AAAAAAAAAAI/AAAAAAAABks/tMMqc6E9REg/photo.jpg?sz=128", "display_name": "Michele d&#39;Amico", "link": "https://stackoverflow.com/users/4101725/michele-damico"}, "edited": false, "score": 1, "creation_date": 1451825225, "post_id": 34514861, "comment_id": 56898023, "body": "Issue on  <a href=\"https://youtrack.jetbrains.com/issue/KT-10555\" rel=\"nofollow noreferrer\">You Track</a>"}], "answers": [{"tags": [], "owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "is_accepted": false, "score": 1, "last_activity_date": 1451422383, "creation_date": 1451422383, "answer_id": 34518931, "question_id": 34514861, "link": "https://stackoverflow.com/questions/34514861/generic-function-with-generic-2d-array/34518931#34518931", "title": "Generic function with generic 2D array", "body": "<p>I think you are one level too deep for the reified parameter.  Maybe it is a bug, creating a <a href=\"https://youtrack.jetbrains.com\" rel=\"nofollow\">YouTrack issue</a> will help to find out.  This code works when you let <code>T</code> be the whole inner array:</p>\n\n<pre><code>inline fun &lt;reified T&gt; make2D(mask: Array&lt;T&gt;): Array&lt;T&gt; {\n    val res: Array&lt;T&gt; = arrayOf&lt;T&gt;()\n    return res\n}\n\n@Test\nfun test2D() {\n    val a: Array&lt;Array&lt;Int&gt;&gt; = arrayOf(arrayOf(0))\n    val b: Array&lt;Array&lt;Int&gt;&gt; = make2D(a)\n    assertEquals(0, b.size)\n}\n</code></pre>\n\n<p>After you create a YouTrack issue, please post the issue number here for tracking.</p>\n"}], "owner": {"reputation": 1308, "user_id": 1147256, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/1I0s7.jpg?s=128&g=1", "display_name": "Mariya Davydova", "link": "https://stackoverflow.com/users/1147256/mariya-davydova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1451422383, "creation_date": 1451405745, "last_edit_date": 1451420773, "question_id": 34514861, "link": "https://stackoverflow.com/questions/34514861/generic-function-with-generic-2d-array", "title": "Generic function with generic 2D array", "body": "<p>How can one implement a generic function which creates an empty generic 2D array? In the following code sample an empty 1D array is created and has the expected type. However, when I call test2D I get an error:</p>\n\n<p><code>java.lang.ClassCastException: [[Ljava.lang.Object; cannot be cast to [[Ljava.lang.Integer;</code></p>\n\n<pre><code>inline fun &lt;reified T&gt; make1D(mask: Array&lt;T&gt;) : Array&lt;T&gt; {\n  val res : Array&lt;T&gt; = arrayOf()\n  return res\n}\n\n@Test\nfun test1D() {\n  val a : Array&lt;Int&gt; = arrayOf(0)\n  val b : Array&lt;Int&gt; = make1D(a)\n  assertEquals(0, b.size)\n}\n\ninline fun &lt;reified T&gt; make2D(mask: Array&lt;Array&lt;T&gt;&gt;) : Array&lt;Array&lt;T&gt;&gt; {\n  val res : Array&lt;Array&lt;T&gt;&gt; = arrayOf() \n  // I expect T to be equal to Int when calling from test below, \n  // and res to have Integer[][] type;\n  // however it has Object[][] type instead\n  return res\n}\n\n@Test\nfun test2D() {\n  val a : Array&lt;Array&lt;Int&gt;&gt; = arrayOf(arrayOf(0))\n  val b : Array&lt;Array&lt;Int&gt;&gt; = make2D(a)\n  assertEquals(0, b.size)\n}\n</code></pre>\n"}, {"tags": ["nullable", "kotlin", "non-nullable"], "answers": [{"comments": [{"owner": {"reputation": 649, "user_id": 11764886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ecb317dd7f3f9dff08a257b3b48a83d?s=128&d=identicon&r=PG&f=1", "display_name": "Waldmann", "link": "https://stackoverflow.com/users/11764886/waldmann"}, "edited": false, "score": 1, "creation_date": 1600235904, "post_id": 34498563, "comment_id": 113019553, "body": "Variables and functions naming is awful."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "reply_to_user": {"reputation": 649, "user_id": 11764886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ecb317dd7f3f9dff08a257b3b48a83d?s=128&d=identicon&r=PG&f=1", "display_name": "Waldmann", "link": "https://stackoverflow.com/users/11764886/waldmann"}, "edited": false, "score": 0, "creation_date": 1600402466, "post_id": 34498563, "comment_id": 113082592, "body": "@Waldmann feel free to edit and clean those up, it is helpful!"}], "tags": [], "owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "is_accepted": true, "score": 306, "last_activity_date": 1557067359, "last_edit_date": 1557067359, "creation_date": 1451326386, "answer_id": 34498563, "question_id": 34498562, "link": "https://stackoverflow.com/questions/34498562/in-kotlin-what-is-the-idiomatic-way-to-deal-with-nullable-values-referencing-o/34498563#34498563", "title": "In Kotlin, what is the idiomatic way to deal with nullable values, referencing or converting them", "body": "<p>First, you should read all about <a href=\"https://kotlinlang.org/docs/reference/null-safety.html#null-safety\" rel=\"noreferrer\">Null Safety</a> in Kotlin which covers the cases thoroughly.</p>\n\n<p>In Kotlin, you cannot access a nullable value without being sure it is not <code>null</code> (<a href=\"https://kotlinlang.org/docs/reference/null-safety.html#checking-for-null-keyword--in-conditions\" rel=\"noreferrer\">Checking for null in conditions</a>), or asserting that it is surely not <code>null</code> using the <a href=\"https://kotlinlang.org/docs/reference/null-safety.html#the--operator\" rel=\"noreferrer\"><code>!!</code> sure operator</a>, accessing it with a <a href=\"https://kotlinlang.org/docs/reference/null-safety.html#safe-calls\" rel=\"noreferrer\"><code>?.</code> Safe Call</a>, or lastly giving something that is possibly <code>null</code> a default value using the <a href=\"https://kotlinlang.org/docs/reference/null-safety.html#elvis-operator\" rel=\"noreferrer\"><code>?:</code> Elvis Operator</a>.</p>\n\n<p><strong>For your 1st case in your question</strong> you have options depending on the intent of the code you would use one of these, and all are idiomatic but have different results:</p>\n\n<pre><code>val something: Xyz? = createPossiblyNullXyz()\n\n// access it as non-null asserting that with a sure call\nval result1 = something!!.foo()\n\n// access it only if it is not null using safe operator, \n// returning null otherwise\nval result2 = something?.foo()\n\n// access it only if it is not null using safe operator, \n// otherwise a default value using the elvis operator\nval result3 = something?.foo() ?: differentValue\n\n// null check it with `if` expression and then use the value, \n// similar to result3 but for more complex cases harder to do in one expression\nval result4 = if (something != null) {\n                   something.foo() \n              } else { \n                   ...\n                   differentValue \n              }\n\n// null check it with `if` statement doing a different action\nif (something != null) { \n    something.foo() \n} else { \n    someOtherAction() \n}\n</code></pre>\n\n<p>For the \"Why does it work when null checked\" read the background information below on <a href=\"https://kotlinlang.org/docs/reference/typecasts.html#smart-casts\" rel=\"noreferrer\">smart casts</a>.</p>\n\n<p><strong>For your 2nd case in your question</strong> in the question with <code>Map</code>, if you as a developer are sure of the result never being <code>null</code>, use <code>!!</code> sure operator as an assertion:</p>\n\n<pre><code>val map = mapOf(\"a\" to 65,\"b\" to 66,\"c\" to 67)\nval something = map.get(\"a\")!!\nsomething.toLong() // now valid\n</code></pre>\n\n<p>or in another case, when the map COULD return a null but you can provide a default value, then <code>Map</code> itself has a <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/get-or-else.html\" rel=\"noreferrer\"><code>getOrElse</code> method</a>:</p>\n\n<pre><code>val map = mapOf(\"a\" to 65,\"b\" to 66,\"c\" to 67)\nval something = map.getOrElse(\"z\") { 0 } // provide default value in lambda\nsomething.toLong() // now valid\n</code></pre>\n\n<hr />\n\n<h1>Background Information:</h1>\n\n<p><strong>Note:</strong> <em>in the examples below I am using explicit types to make the behavior clear.  With type inference, normally the types can be omitted for local variables and private members.</em></p>\n\n<h2>More about the <code>!!</code> sure operator</h2>\n\n<p>The <code>!!</code> operator asserts that the value is not <code>null</code> or throws an NPE.  This should be used in cases where the developer is guaranteeing that the value will never be <code>null</code>.  Think of it as an assert followed by a <a href=\"https://kotlinlang.org/docs/reference/typecasts.html#smart-casts\" rel=\"noreferrer\">smart cast</a>.</p>\n\n\n\n<pre><code>val possibleXyz: Xyz? = ...\n// assert it is not null, but if it is throw an exception:\nval surelyXyz: Xyz = possibleXyz!! \n// same thing but access members after the assertion is made:\npossibleXyz!!.foo()\n</code></pre>\n\n<p><em>read more: <a href=\"https://kotlinlang.org/docs/reference/null-safety.html#the--operator\" rel=\"noreferrer\">!! Sure Operator</a></em></p>\n\n<hr />\n\n<h2>More about <code>null</code> Checking and Smart Casts</h2>\n\n<p>If you protect access to a nullable type with a <code>null</code> check, the compiler will <a href=\"https://kotlinlang.org/docs/reference/typecasts.html#smart-casts\" rel=\"noreferrer\">smart cast</a> the value within the body of the statement to be non-nullable.  There are some complicated flows where this cannot happen, but for common cases works fine.</p>\n\n<pre><code>val possibleXyz: Xyz? = ...\nif (possibleXyz != null) {\n   // allowed to reference members:\n   possiblyXyz.foo()\n   // or also assign as non-nullable type:\n   val surelyXyz: Xyz = possibleXyz\n}\n</code></pre>\n\n<p>Or if you do a <code>is</code> check for a non-nullable type:</p>\n\n<pre><code>if (possibleXyz is Xyz) {\n   // allowed to reference members:\n   possiblyXyz.foo()\n}\n</code></pre>\n\n<p>And the same for 'when' expressions that also safe cast:</p>\n\n<pre><code>when (possibleXyz) {\n    null -&gt; doSomething()\n    else -&gt; possibleXyz.foo()\n}\n\n// or\n\nwhen (possibleXyz) {\n    is Xyz -&gt; possibleXyz.foo()\n    is Alpha -&gt; possibleXyz.dominate()\n    is Fish -&gt; possibleXyz.swim() \n}\n</code></pre>\n\n<p>Some things do not allow the <code>null</code> check to <a href=\"https://kotlinlang.org/docs/reference/typecasts.html#smart-casts\" rel=\"noreferrer\">smart cast</a> for the later use of the variable.  The example above uses a local variable that in no way could have mutated in the flow of the application, whether <code>val</code> or <code>var</code> this variable had no opportunity to mutate into a <code>null</code>.  But, in other cases where the compiler cannot guarantee the flow analysis, this would be an error:</p>\n\n<pre><code>var nullableInt: Int? = ...\n\npublic fun foo() {\n    if (nullableInt != null) {\n        // Error: \"Smart cast to 'kotlin.Int' is impossible, because 'nullableInt' is a mutable property that could have been changed by this time\"\n        val nonNullableInt: Int = nullableInt\n    }\n}\n</code></pre>\n\n<p>The lifecycle of the variable <code>nullableInt</code> is not completely visible and may be assigned from other threads, the <code>null</code> check cannot be <a href=\"https://kotlinlang.org/docs/reference/typecasts.html#smart-casts\" rel=\"noreferrer\">smart cast</a> into a non-nullable value. See the  \"Safe Calls\" topic below for a workaround.</p>\n\n<p>Another case that cannot be trusted by a <a href=\"https://kotlinlang.org/docs/reference/typecasts.html#smart-casts\" rel=\"noreferrer\">smart cast</a> to not mutate is a <code>val</code> property on an object that has a custom getter.  In this case, the compiler has no visibility into what mutates the value and therefore you will get an error message:</p>\n\n<pre><code>class MyThing {\n    val possibleXyz: Xyz? \n        get() { ... }\n}\n\n// now when referencing this class...\n\nval thing = MyThing()\nif (thing.possibleXyz != null) {\n   // error: \"Kotlin: Smart cast to 'kotlin.Int' is impossible, because 'p.x' is a property that has open or custom getter\"\n   thing.possiblyXyz.foo()\n}\n</code></pre>\n\n<p><em>read more: <a href=\"https://kotlinlang.org/docs/reference/null-safety.html#checking-for-null-keyword--in-conditions\" rel=\"noreferrer\">Checking for null in conditions</a></em></p>\n\n<hr />         \n\n<h2>More about the <code>?.</code> Safe Call operator</h2>\n\n<p>The safe call operator returns null if the value to the left is null, otherwise continues to evaluate the expression to the right.  </p>\n\n<pre><code>val possibleXyz: Xyz? = makeMeSomethingButMaybeNullable()\n// \"answer\" will be null if any step of the chain is null\nval answer = possibleXyz?.foo()?.goo()?.boo()\n</code></pre>\n\n<p>Another example where you want to iterate a list but only if not <code>null</code> and not empty, again the safe call operator comes in handy:</p>\n\n<pre><code>val things: List? = makeMeAListOrDont()\nthings?.forEach {\n    // this loops only if not null (due to safe call) nor empty (0 items loop 0 times):\n}\n</code></pre>\n\n<p>In one of the examples above we had a case where we did an <code>if</code> check but have the chance another thread mutated the value and therefore no <a href=\"https://kotlinlang.org/docs/reference/typecasts.html#smart-casts\" rel=\"noreferrer\">smart cast</a>.  We can change this sample to use the safe call operator along with the <code>let</code> function to solve this:</p>\n\n<pre><code>var possibleXyz: Xyz? = 1\n\npublic fun foo() {\n    possibleXyz?.let { value -&gt;\n        // only called if not null, and the value is captured by the lambda\n        val surelyXyz: Xyz = value\n    }\n}\n</code></pre>\n\n<p><em>read more: <a href=\"https://kotlinlang.org/docs/reference/null-safety.html#safe-calls\" rel=\"noreferrer\">Safe Calls</a></em></p>\n\n<hr />\n\n<h2>More about the <code>?:</code> Elvis Operator</h2>\n\n<p>The Elvis operator allows you to provide an alternative value when an expression to the left of the operator is <code>null</code>:</p>\n\n<pre><code>val surelyXyz: Xyz = makeXyzOrNull() ?: DefaultXyz()\n</code></pre>\n\n<p>It has some creative uses as well, for example throw an exception when something is <code>null</code>:</p>\n\n<pre><code>val currentUser = session.user ?: throw Http401Error(\"Unauthorized\")\n</code></pre>\n\n<p>or to return early from a function:</p>\n\n<pre><code>fun foo(key: String): Int {\n   val startingCode: String = codes.findKey(key) ?: return 0\n   // ...\n   return endingValue\n}\n</code></pre>\n\n<p><em>read more: <a href=\"https://kotlinlang.org/docs/reference/null-safety.html#elvis-operator\" rel=\"noreferrer\">Elvis Operator</a></em></p>\n\n<hr />\n\n<h2>Null Operators with Related Functions</h2>\n\n<p>Kotlin stdlib has a series of functions that work really nicely with the operators mentioned above.  For example:</p>\n\n<pre><code>// use ?.let() to change a not null value, and ?: to provide a default\nval something = possibleNull?.let { it.transform() } ?: defaultSomething\n\n// use ?.apply() to operate further on a value that is not null\npossibleNull?.apply {\n    func1()\n    func2()\n}\n\n// use .takeIf or .takeUnless to turn a value null if it meets a predicate\nval something = name.takeIf { it.isNotBlank() } ?: defaultName\n\nval something = name.takeUnless { it.isBlank() } ?: defaultName\n</code></pre>\n\n<hr />\n\n<h2>Related Topics</h2>\n\n<p>In Kotlin, most applications try to avoid <code>null</code> values, but it isn't always possible.  And sometimes <code>null</code> makes perfect sense.  Some guidelines to think about:</p>\n\n<ul>\n<li><p>in some cases, it warrants different return types that include the status of the method call and the result if successful.  Libraries like <a href=\"https://github.com/kittinunf/Result/\" rel=\"noreferrer\">Result</a> give you a success or failure result type that can also branch your code.  And the Promises library for Kotlin called <a href=\"http://kovenant.komponents.nl/\" rel=\"noreferrer\">Kovenant</a> does the same in the form of promises.  </p></li>\n<li><p>for collections as return types always return an empty collection instead of a <code>null</code>, unless you need a third state of \"not present\".  Kotlin has helper functions such as <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/index.html\" rel=\"noreferrer\"><code>emptyList()</code> or <code>emptySet()</code></a> to create these empty values.</p></li>\n<li><p>when using methods which return a nullable value for which you have a default or alternative, use the Elvis operator to provide a default value.  In the case of a <code>Map</code> use the <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/get-or-else.html\" rel=\"noreferrer\"><code>getOrElse()</code></a> which allows a default value to be generated instead of <code>Map</code> method <code>get()</code> which returns a nullable value.  Same for <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/get-or-put.html\" rel=\"noreferrer\"><code>getOrPut()</code></a></p></li>\n<li><p>when overriding methods from Java where Kotlin isn't sure about the nullability of the Java code, you can always drop the <code>?</code> nullability from your override if you are sure what the signature and functionality should be.  Therefore your overridden method is more <code>null</code> safe.  Same for implementing Java interfaces in Kotlin, change the nullability to be what you know is valid.</p></li>\n<li><p>look at functions that can help already, such as for <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.text/kotlin.-char-sequence/is-null-or-empty.html\" rel=\"noreferrer\"><code>String?.isNullOrEmpty()</code></a> and <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.text/kotlin.-char-sequence/is-null-or-blank.html\" rel=\"noreferrer\"><code>String?.isNullOrBlank()</code></a> which can operate on a nullable value safely and do what you expect.  In fact, you can add your own extensions to fill in any gaps in the standard library.</p></li>\n<li><p>assertion functions like <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/check-not-null.html\" rel=\"noreferrer\"><code>checkNotNull()</code></a> and <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/require-not-null.html\" rel=\"noreferrer\"><code>requireNotNull()</code></a> in the standard library.</p></li>\n<li><p>helper functions like <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/filter-not-null.html\" rel=\"noreferrer\"><code>filterNotNull()</code></a> which remove nulls from collections, or <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/list-of-not-null.html\" rel=\"noreferrer\"><code>listOfNotNull()</code></a> for returning a zero or single item list from a possibly <code>null</code> value.</p></li>\n<li><p>there is a <a href=\"https://kotlinlang.org/docs/reference/typecasts.html#safe-nullable-cast-operator\" rel=\"noreferrer\">Safe (nullable) cast operator</a> as well that allows a cast to non-nullable type return null if not possible. But I do not have a valid use case for this that isn't solved by the other methods mentioned above.</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 601, "user_id": 6382484, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-WeuQ98-xtxk/AAAAAAAAAAI/AAAAAAAAABc/cugEXnf1jwY/photo.jpg?sz=128", "display_name": "Steven Waterman", "link": "https://stackoverflow.com/users/6382484/steven-waterman"}, "edited": false, "score": 14, "creation_date": 1494950356, "post_id": 43884131, "comment_id": 75040945, "body": "val something: Xyz = createPossiblyNullXyz()!! will throw a NPE when createPossiblyNullXyz() returns null. It&#39;s simpler and follows conventions for dealing with a value you know isn&#39;t null"}, {"owner": {"reputation": 331, "user_id": 5543418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6366845cb929f1d56c8ac492dba3f7d6?s=128&d=identicon&r=PG&f=1", "display_name": "Guybrush", "link": "https://stackoverflow.com/users/5543418/guybrush"}, "edited": false, "score": 2, "creation_date": 1603817355, "post_id": 43884131, "comment_id": 114154630, "body": "This pattern is still quite useful, especially for request validation. Yes, if it&#39;s not allowed to be null you could just assert !!, but you may want to throw a more explicit exception that your code can understand and format for you. HandledException(message = &quot;Email is required&quot;, status = 400) for example."}], "tags": [], "owner": {"reputation": 67, "user_id": 2268369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c056c6943a9fd521f1328ade0c81d6fb?s=128&d=identicon&r=PG", "display_name": "John Farrell", "link": "https://stackoverflow.com/users/2268369/john-farrell"}, "is_accepted": false, "score": 3, "last_activity_date": 1494393733, "creation_date": 1494393733, "answer_id": 43884131, "question_id": 34498562, "link": "https://stackoverflow.com/questions/34498562/in-kotlin-what-is-the-idiomatic-way-to-deal-with-nullable-values-referencing-o/43884131#43884131", "title": "In Kotlin, what is the idiomatic way to deal with nullable values, referencing or converting them", "body": "<p>The previous answer is a hard act to follow, but here's one quick and easy way:</p>\n\n<pre><code>val something: Xyz = createPossiblyNullXyz() ?: throw RuntimeError(\"no it shouldn't be null\")\nsomething.foo() \n</code></pre>\n\n<p>If it really is never null, the exception won't happen, but if it ever is you'll see what went wrong.</p>\n"}, {"tags": [], "owner": {"reputation": 127, "user_id": 636400, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7td1u.jpg?s=128&g=1", "display_name": "Luca Piccinelli", "link": "https://stackoverflow.com/users/636400/luca-piccinelli"}, "is_accepted": false, "score": 0, "last_activity_date": 1608566569, "creation_date": 1608566569, "answer_id": 65396011, "question_id": 34498562, "link": "https://stackoverflow.com/questions/34498562/in-kotlin-what-is-the-idiomatic-way-to-deal-with-nullable-values-referencing-o/65396011#65396011", "title": "In Kotlin, what is the idiomatic way to deal with nullable values, referencing or converting them", "body": "<p>I want to add that now it exists <a href=\"https://github.com/lucapiccinelli/konad\" rel=\"nofollow noreferrer\">Konad</a> library that addresses more complex situations for nullable composition. Here it follows an example usage:</p>\n<pre><code>val foo: Int? = 1\nval bar: String? = &quot;2&quot;\nval baz: Float? = 3.0f\n\nfun useThem(x: Int, y: String, z: Float): Int = x + y.toInt() + z.toInt()\n\nval result: Int? = ::useThem.curry() \n   .on(foo.maybe) \n   .on(bar.maybe) \n   .on(baz.maybe)\n   .nullable\n</code></pre>\n<p>if you want to keep it nullable, or</p>\n<pre><code>val result: Result&lt;Int&gt; = ::useThem.curry() \n   .on(foo.ifNull(&quot;Foo should not be null&quot;)) \n   .on(bar.ifNull(&quot;Bar should not be null&quot;)) \n   .on(baz.ifNull(&quot;Baz should not be null&quot;))\n   .result\n</code></pre>\n<p>if you want to accumulate errors. See <a href=\"https://github.com/lucapiccinelli/konad#maybe\" rel=\"nofollow noreferrer\">maybe section</a></p>\n"}], "owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64122, "favorite_count": 65, "accepted_answer_id": 34498563, "answer_count": 3, "score": 184, "last_activity_date": 1608566569, "creation_date": 1451326386, "last_edit_date": 1610973576, "question_id": 34498562, "link": "https://stackoverflow.com/questions/34498562/in-kotlin-what-is-the-idiomatic-way-to-deal-with-nullable-values-referencing-o", "title": "In Kotlin, what is the idiomatic way to deal with nullable values, referencing or converting them", "body": "<p>If I have a nullable type <code>Xyz?</code>, I want to reference it or convert it to a non-nullable type <code>Xyz</code>.  What is the idiomatic way of doing so in Kotlin?</p>\n<p>For example, this code is in error:</p>\n\n<pre class=\"lang-kotlin prettyprint-override\"><code>val something: Xyz? = createPossiblyNullXyz()\nsomething.foo() // Error: &quot;Only safe (?.) or non-null asserted (!!.) calls are allowed on a nullable receiver of type Xyz?&quot;\n</code></pre>\n<p>But if I check null first it is allowed, why?</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>val something: Xyz? = createPossiblyNullXyz()\nif (something != null) {\n    something.foo() \n}\n</code></pre>\n<p>How do I change or treat a value as not <code>null</code> without requiring the <code>if</code> check, assuming I know for sure it is truly never <code>null</code>?  For example, here I am retrieving a value from a map that I can guarantee exists and the result of <code>get()</code> is not <code>null</code>.  But I have an error:</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>val map = mapOf(&quot;a&quot; to 65,&quot;b&quot; to 66,&quot;c&quot; to 67)\nval something = map.get(&quot;a&quot;)\nsomething.toLong() // Error: &quot;Only safe (?.) or non-null asserted (!!.) calls are allowed on a nullable receiver of type Int?&quot;\n</code></pre>\n<p>The method <code>get()</code> thinks it is possible that the item is missing and returns type <code>Int?</code>.  Therefore, what is the best way to force the type of the value to be not nullable?</p>\n<p><strong>Note:</strong> <em>this question is intentionally written and answered by the author (<a href=\"https://blog.stackoverflow.com/2011/07/its-ok-to-ask-and-answer-your-own-questions/\">Self-Answered Questions</a>), so that the idiomatic answers to commonly asked Kotlin topics are present in SO.  Also to clarify some really old answers written for alphas of Kotlin that are not accurate for current-day Kotlin.</em></p>\n"}, {"tags": ["kotlin"], "comments": [{"owner": {"reputation": 823, "user_id": 3702728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/nbzi4.png?s=128&g=1", "display_name": "succcubbus", "link": "https://stackoverflow.com/users/3702728/succcubbus"}, "edited": false, "score": 4, "creation_date": 1467868266, "post_id": 34498368, "comment_id": 63896838, "body": "This feature is proposed for a future version of Kotlin. <a href=\"https://github.com/Kotlin/KEEP/blob/master/proposals/stdlib/window-sliding.md\" rel=\"nofollow noreferrer\">github.com/Kotlin/KEEP/blob/master/proposals/stdlib/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451362125, "post_id": 34504231, "comment_id": 56750536, "body": "Obviously this could be made to NOT be lazy, such as the example that maps to <code>it.toList()</code> or to work from a <code>Collection</code> instead of a sequence.  But since it is easy to turn them into a <code>Sequence</code> it is a good starting point."}, {"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "edited": false, "score": 2, "creation_date": 1451397520, "post_id": 34504231, "comment_id": 56765871, "body": "FYI: I think you&#39;ve got a bug in your <code>batch</code> code. The following gets stuck in an endless loop <code>listOf(1, 2, 3, 4, 5, 6, 7, 8, 9, 10).asSequence().batch(2).toList()</code>."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "reply_to_user": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "edited": false, "score": 0, "creation_date": 1451400047, "post_id": 34504231, "comment_id": 56767231, "body": "Yeah, I see it now, if the elements aren&#39;t consumed and you convert to a list, the iterator stays still.  I have to advance the iterator and create something to hold the items not consumed."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "reply_to_user": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "edited": false, "score": 1, "creation_date": 1451400895, "post_id": 34504231, "comment_id": 56767725, "body": "Fixed, easiest answer is to make each batch a <code>List</code> created at the time the next group is iterated.  If you write code as you have <code>.batch(2).toList()</code> you will materialize all groups into memory at the same time as separate <code>List</code> otherwise only one group at a time will materialize.   Code is fixed, tests updated for this case."}, {"owner": {"reputation": 6932, "user_id": 620237, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/yzN9F.jpg?s=128&g=1", "display_name": "Dave Maple", "link": "https://stackoverflow.com/users/620237/dave-maple"}, "edited": false, "score": 0, "creation_date": 1451405390, "post_id": 34504231, "comment_id": 56770231, "body": "This is great! Thank you both for your time. Love the syntax. Might be a nice addition to the stdlib."}, {"owner": {"reputation": 897, "user_id": 2528556, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ArYFN.jpg?s=128&g=1", "display_name": "Sonofblip", "link": "https://stackoverflow.com/users/2528556/sonofblip"}, "edited": false, "score": 1, "creation_date": 1492704537, "post_id": 34504231, "comment_id": 74102686, "body": "This is a very nice solution, thanks @JaysonMinard!!"}, {"owner": {"reputation": 6647, "user_id": 709671, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e2589f597920174d08abc0cc4ba5f183?s=128&d=identicon&r=PG", "display_name": "axierjhtjz", "link": "https://stackoverflow.com/users/709671/axierjhtjz"}, "edited": false, "score": 1, "creation_date": 1538728019, "post_id": 34504231, "comment_id": 92252904, "body": "Awesome answer. It&#180;s been very useful. Thanks!"}], "tags": [], "owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "is_accepted": true, "score": 38, "last_activity_date": 1538914471, "last_edit_date": 1538914471, "creation_date": 1451361730, "answer_id": 34504231, "question_id": 34498368, "link": "https://stackoverflow.com/questions/34498368/kotlin-convert-large-list-to-sublist-of-set-partition-size/34504231#34504231", "title": "Kotlin: Convert large List to sublist of set partition size", "body": "<p><strong><em>NOTE:</em></strong> <em>For Kotlin 1.2 and newer, please see the <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/chunked.html\" rel=\"noreferrer\"><code>chunked</code></a> and <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/windowed.html\" rel=\"noreferrer\"><code>windowed</code></a> functions that are now in the standard library.  There is no need for a custom solution.</em></p>\n\n<hr/>\n\n<p>Here is an implementation of a lazy batching extension function which will take a collection, or anything that can become a <code>Sequence</code> and return a <code>Sequence</code> of <code>List</code> each of that size, with the last one being that size or smaller.</p>\n\n<p>Example usage to iterate a list as batches:</p>\n\n\n\n<pre><code>myList.asSequence().batch(5).forEach { group -&gt;\n   // receive a Sequence of size 5 (or less for final)\n}\n</code></pre>\n\n<p>Example to convert batches of <code>List</code> to <code>Set</code>:</p>\n\n<pre><code>myList.asSequence().batch(5).map { it.toSet() }\n</code></pre>\n\n<p>See the first test case below for showing the output given specific input.  </p>\n\n<p><strong>Code for the function <code>Sequence&lt;T&gt;.batch(groupSize)</code>:</strong></p>\n\n<pre><code>public fun &lt;T&gt; Sequence&lt;T&gt;.batch(n: Int): Sequence&lt;List&lt;T&gt;&gt; {\n    return BatchingSequence(this, n)\n}\n\nprivate class BatchingSequence&lt;T&gt;(val source: Sequence&lt;T&gt;, val batchSize: Int) : Sequence&lt;List&lt;T&gt;&gt; {\n    override fun iterator(): Iterator&lt;List&lt;T&gt;&gt; = object : AbstractIterator&lt;List&lt;T&gt;&gt;() {\n        val iterate = if (batchSize &gt; 0) source.iterator() else emptyList&lt;T&gt;().iterator()\n        override fun computeNext() {\n            if (iterate.hasNext()) setNext(iterate.asSequence().take(batchSize).toList())\n            else done() \n        }\n    }\n}\n</code></pre>\n\n<p><strong>Unit tests proving it works:</strong></p>\n\n<pre><code>class TestGroupingStream {\n\n    @Test fun testConvertToListOfGroupsWithoutConsumingGroup() {\n        val listOfGroups = listOf(1, 2, 3, 4, 5, 6, 7, 8, 9, 10).asSequence().batch(2).toList()\n        assertEquals(5, listOfGroups.size)\n        assertEquals(listOf(1,2), listOfGroups[0].toList())\n        assertEquals(listOf(3,4), listOfGroups[1].toList())\n        assertEquals(listOf(5,6), listOfGroups[2].toList())\n        assertEquals(listOf(7,8), listOfGroups[3].toList())\n        assertEquals(listOf(9,10), listOfGroups[4].toList())\n    }\n\n    @Test fun testSpecificCase() {\n        val originalStream = listOf(1,2,3,4,5,6,7,8,9,10)\n\n        val results = originalStream.asSequence().batch(3).map { group -&gt;\n            group.toList()\n        }.toList()\n\n        assertEquals(listOf(1,2,3), results[0])\n        assertEquals(listOf(4,5,6), results[1])\n        assertEquals(listOf(7,8,9), results[2])\n        assertEquals(listOf(10), results[3])\n    }\n\n\n    fun testStream(testList: List&lt;Int&gt;, batchSize: Int, expectedGroups: Int) {\n        var groupSeenCount = 0\n        var itemsSeen = ArrayList&lt;Int&gt;()\n\n        testList.asSequence().batch(batchSize).forEach { groupStream -&gt;\n            groupSeenCount++\n            groupStream.forEach { item -&gt;\n                itemsSeen.add(item)\n            }\n        }\n\n        assertEquals(testList, itemsSeen)\n        assertEquals(groupSeenCount, expectedGroups)\n    }\n\n    @Test fun groupsOfExactSize() {\n        testStream(listOf(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15), 5, 3)\n    }\n\n    @Test fun groupsOfOddSize() {\n        testStream(listOf(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18), 5, 4)\n        testStream(listOf(1,2,3,4), 3, 2)\n    }\n\n    @Test fun groupsOfLessThanBatchSize() {\n        testStream(listOf(1,2,3), 5, 1)\n        testStream(listOf(1), 5, 1)\n    }\n\n    @Test fun groupsOfSize1() {\n        testStream(listOf(1,2,3), 1, 3)\n    }\n\n    @Test fun groupsOfSize0() {\n        val testList = listOf(1,2,3)\n\n        val groupCountZero =   testList.asSequence().batch(0).toList().size\n        assertEquals(0, groupCountZero)\n\n        val groupCountNeg =  testList.asSequence().batch(-1).toList().size\n        assertEquals(0, groupCountNeg)\n\n    }\n\n    @Test fun emptySource() {\n        listOf&lt;Int&gt;().asSequence().batch(1).forEach { groupStream -&gt;\n            fail()\n        }\n\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "edited": false, "score": 0, "creation_date": 1451399644, "post_id": 34513096, "comment_id": 56767005, "body": "I suppose instead of separate files you can also use <code>@JvmName</code>. See <a href=\"https://kotlinlang.org/docs/reference/java-to-kotlin-interop.html#handling-signature-clashes-with-jvmname\" rel=\"nofollow noreferrer\">Handling signature clashes with @JvmName</a> for details."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451402022, "post_id": 34513096, "comment_id": 56768295, "body": "I like the last short answer, which works nicely for ArrayLists and a variation would work nicely for arrays.  Other lists maybe less performant (i.e. LinkedList).  And for other collections not possible."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 1, "creation_date": 1451402428, "post_id": 34513096, "comment_id": 56768544, "body": "Can you change your answer to protect for behavior when <code>size</code> is 0 (div by zero) or negative."}, {"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "reply_to_user": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 1, "creation_date": 1451402845, "post_id": 34513096, "comment_id": 56768751, "body": "Good idea @JaysonMinard. Thanks! Added <code>require(size &gt; 0)</code> (similar to Guava&#39;s partition methods)."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 1, "creation_date": 1451402885, "post_id": 34513096, "comment_id": 56768777, "body": "Great, two nice different answers + Guava if people want."}], "tags": [], "owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "is_accepted": false, "score": 4, "last_activity_date": 1539004919, "last_edit_date": 1539004919, "creation_date": 1451399397, "answer_id": 34513096, "question_id": 34498368, "link": "https://stackoverflow.com/questions/34498368/kotlin-convert-large-list-to-sublist-of-set-partition-size/34513096#34513096", "title": "Kotlin: Convert large List to sublist of set partition size", "body": "<p>In Kotlin 1.2 M2 and later you can use <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/chunked.html\" rel=\"nofollow noreferrer\"><code>chunked</code></a> and <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/windowed.html\" rel=\"nofollow noreferrer\"><code>windowed</code></a> (see <a href=\"https://blog.jetbrains.com/kotlin/2017/08/kotlin-1-2-m2-is-out/\" rel=\"nofollow noreferrer\">Kotlin 1.2 M2 is out | Kotlin Blog</a>). Note that there are <code>Sequence</code> variances too (see <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.sequences/index.html\" rel=\"nofollow noreferrer\">kotlin.sequences - Kotlin Programming Language</a>).</p>\n\n<p>For versions of Kotlin prior to 1.2 M2 I recommend using <a href=\"https://google.github.io/guava/releases/snapshot/api/docs/com/google/common/collect/Lists.html#partition(java.util.List,%20int)\" rel=\"nofollow noreferrer\">Lists.partition(List, int)</a> from <code>google-guava</code> (it uses <a href=\"https://docs.oracle.com/javase/6/docs/api/java/util/List.html?is-external=true#subList(int,%20int)\" rel=\"nofollow noreferrer\"><code>java.util.List.subList(int, int)</code></a>):</p>\n\n<p>If you are unfamiliar with <a href=\"https://github.com/google/guava\" rel=\"nofollow noreferrer\">Guava</a> see <a href=\"https://github.com/google/guava/wiki/CollectionUtilitiesExplained\" rel=\"nofollow noreferrer\">CollectionUtilitiesExplained \u00b7 google/guava Wiki</a> for more details.</p>\n\n<p>You can create your own Kotlin <a href=\"https://kotlinlang.org/docs/reference/extensions.html#extension-functions\" rel=\"nofollow noreferrer\">extension function</a> for it if you want:</p>\n\n<pre><code>fun &lt;T&gt; List&lt;T&gt;.collate(size: Int): List&lt;List&lt;T&gt;&gt; = Lists.partition(this, size)\n</code></pre>\n\n<p>If you want an extension function for mutable lists then in a separate Kotlin file (to avoid platform declaration clashes):</p>\n\n<pre><code>fun &lt;T&gt; MutableList&lt;T&gt;.collate(size: Int): List&lt;MutableList&lt;T&gt;&gt; = Lists.partition(this, size)\n</code></pre>\n\n<p>If you want something lazy loaded like in <a href=\"https://stackoverflow.com/a/34504231/3255152\">Jayson Minard's answer</a> you can use <a href=\"https://google.github.io/guava/releases/snapshot/api/docs/com/google/common/collect/Iterables.html#partition(java.lang.Iterable,%20int)\" rel=\"nofollow noreferrer\">Iterables.partition(Iterable, int)</a>. You might also be interested in <a href=\"https://google.github.io/guava/releases/snapshot/api/docs/com/google/common/collect/Iterables.html#paddedPartition(java.lang.Iterable,%20int)\" rel=\"nofollow noreferrer\">Iterables.paddedPartition(Iterable, int)</a> if you want to pad the last sublist if it is smaller than the specified <code>size</code>. These return <code>Iterable&lt;List&lt;T&gt;&gt;</code> (I don't see much point in making it <code>Iterable&lt;Iterable&lt;T&gt;&gt;</code> as <a href=\"https://docs.oracle.com/javase/6/docs/api/java/util/List.html?is-external=true#subList(int,%20int)\" rel=\"nofollow noreferrer\"><code>subList</code></a> returns an efficient view).</p>\n\n<p>If for some reason you don't want to depend on Guava you can roll your own pretty easily using the <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-list/sub-list.html\" rel=\"nofollow noreferrer\"><code>subList</code></a> function you mentioned:</p>\n\n<pre><code>fun &lt;T&gt; List&lt;T&gt;.collate(size: Int): List&lt;List&lt;T&gt;&gt; {\n    require(size &gt; 0)\n    return if (isEmpty()) {\n        emptyList()\n    } else {\n        (0..lastIndex / size).map {\n            val fromIndex = it * size\n            val toIndex = Math.min(fromIndex + size, this.size)\n            subList(fromIndex, toIndex)\n        }\n    }\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>fun &lt;T&gt; List&lt;T&gt;.collate(size: Int): Sequence&lt;List&lt;T&gt;&gt; {\n    require(size &gt; 0)\n    return if (isEmpty()) {\n        emptySequence()\n    } else {\n        (0..lastIndex / size).asSequence().map {\n            val fromIndex = it * size\n            val toIndex = Math.min(fromIndex + size, this.size)\n            subList(fromIndex, toIndex)\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7683, "user_id": 590437, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oehge.jpg?s=128&g=1", "display_name": "Holger Brandl", "link": "https://stackoverflow.com/users/590437/holger-brandl"}, "is_accepted": false, "score": 4, "last_activity_date": 1505893204, "last_edit_date": 1505893204, "creation_date": 1482495299, "answer_id": 41301362, "question_id": 34498368, "link": "https://stackoverflow.com/questions/34498368/kotlin-convert-large-list-to-sublist-of-set-partition-size/41301362#41301362", "title": "Kotlin: Convert large List to sublist of set partition size", "body": "<p>A more simplistic/functional-style solution would be</p>\n\n<pre><code>val items = (1..100).map { \"foo_${it}\" }\n\nfun &lt;T&gt; Iterable&lt;T&gt;.batch(chunkSize: Int) =\n   withIndex().                        // create index value pairs\n   groupBy { it.index / chunkSize }.   // create grouping index\n   map { it.value.map { it.value } }   // split into different partitions\n\n\nitems.batch(3)\n</code></pre>\n\n<p>Note 1: Personally I'd prefer <code>partition</code> as a method name here, but it's already present in Kotlin's <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/partition.html\" rel=\"nofollow noreferrer\">stdlib</a> to separate a lists into 2 parts given a predicate. </p>\n\n<p>Note 2: The the iterator solution from Jayson may scale better than this solution for large collections.</p>\n"}, {"tags": [], "owner": {"reputation": 21760, "user_id": 2183804, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/18110f30b61ea2ed890d26c361001710?s=128&d=identicon&r=PG", "display_name": "MaciejG&#243;rski", "link": "https://stackoverflow.com/users/2183804/maciejg%c3%b3rski"}, "is_accepted": false, "score": 0, "last_activity_date": 1487356117, "creation_date": 1487356117, "answer_id": 42305023, "question_id": 34498368, "link": "https://stackoverflow.com/questions/34498368/kotlin-convert-large-list-to-sublist-of-set-partition-size/42305023#42305023", "title": "Kotlin: Convert large List to sublist of set partition size", "body": "<p>There is unfortunately no built-in function for that yet and while functional and <code>Sequence</code>-based implementations from other answers look nice, if you just need is <code>List</code> of <code>List</code>s, I'd suggest writing a little bit of ugly, imperative, but performant code.</p>\n\n<p>This is my final result:</p>\n\n<pre><code>fun &lt;T&gt; List&lt;T&gt;.batch(chunkSize: Int): List&lt;List&lt;T&gt;&gt; {\n    if (chunkSize &lt;= 0) {\n        throw IllegalArgumentException(\"chunkSize must be greater than 0\")\n    }\n    val capacity = (this.size + chunkSize - 1) / chunkSize\n    val list = ArrayList&lt;ArrayList&lt;T&gt;&gt;(capacity)\n    for (i in 0 until this.size) {\n        if (i % chunkSize == 0) {\n            list.add(ArrayList(chunkSize))\n        }\n        list.last().add(this.get(i))\n    }\n    return list\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75816, "user_id": 1966109, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/wPv34.jpg?s=128&g=1", "display_name": "Imanou Petit", "link": "https://stackoverflow.com/users/1966109/imanou-petit"}, "is_accepted": false, "score": 44, "last_activity_date": 1551044506, "last_edit_date": 1551044506, "creation_date": 1499184474, "answer_id": 44910350, "question_id": 34498368, "link": "https://stackoverflow.com/questions/34498368/kotlin-convert-large-list-to-sublist-of-set-partition-size/44910350#44910350", "title": "Kotlin: Convert large List to sublist of set partition size", "body": "<p>With Kotlin 1.3, according to your needs, you may choose one of the following ways to solve your problem.</p>\n\n<hr>\n\n<h1>#1. Using <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/chunked.html\" rel=\"noreferrer\"><code>chunked</code></a></h1>\n\n<pre><code>fun main() {\n    val list = listOf(2, 4, 3, 10, 8, 7, 9)\n    val newList = list.chunked(2)\n    //val newList = list.chunked(size = 2) // also works\n    print(newList)\n}\n\n/*\nprints:\n[[2, 4], [3, 10], [8, 7], [9]]\n*/\n</code></pre>\n\n<hr>\n\n<h1>#2. Using <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/windowed.html\" rel=\"noreferrer\"><code>windowed</code></a></h1>\n\n<pre><code>fun main() {\n    val list = listOf(2, 4, 3, 10, 8, 7, 9)\n    val newList = list.windowed(2, 2, true)\n    //val newList = list.windowed(size = 2, step = 2, partialWindows = true) // also works\n    println(newList)\n}\n\n/*\nprints:\n[[2, 4], [3, 10], [8, 7], [9]]\n*/\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 854, "user_id": 5488468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uZFd2.jpg?s=128&g=1", "display_name": "Bipin Bharti", "link": "https://stackoverflow.com/users/5488468/bipin-bharti"}, "is_accepted": false, "score": 2, "last_activity_date": 1575353618, "creation_date": 1575353618, "answer_id": 59151135, "question_id": 34498368, "link": "https://stackoverflow.com/questions/34498368/kotlin-convert-large-list-to-sublist-of-set-partition-size/59151135#59151135", "title": "Kotlin: Convert large List to sublist of set partition size", "body": "<blockquote>\n  <p>Dummy Array</p>\n</blockquote>\n\n<pre><code> for (i in 0..49){\n             var  data=\"java\"\n            }\n            array.add(data)\n</code></pre>\n\n<blockquote>\n  <p>Used:</p>\n</blockquote>\n\n<pre><code>  var data=array?.chunked(15)\n</code></pre>\n\n<p><a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/chunked.html\" rel=\"nofollow noreferrer\">kotlin's method</a></p>\n"}], "owner": {"reputation": 6932, "user_id": 620237, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/yzN9F.jpg?s=128&g=1", "display_name": "Dave Maple", "link": "https://stackoverflow.com/users/620237/dave-maple"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13944, "favorite_count": 7, "accepted_answer_id": 34504231, "answer_count": 6, "score": 27, "last_activity_date": 1575353618, "creation_date": 1451325450, "question_id": 34498368, "link": "https://stackoverflow.com/questions/34498368/kotlin-convert-large-list-to-sublist-of-set-partition-size", "title": "Kotlin: Convert large List to sublist of set partition size", "body": "<p>I'm looking for a function equivalent to <a href=\"https://issues.apache.org/jira/browse/GROOVY-5283\" rel=\"noreferrer\">Groovy's collate</a> which would partition a large List into batches for processing. I did see <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-list/sub-list.html\" rel=\"noreferrer\"><code>subList</code></a> which could be adapted into a similar function but wanted to check and make sure I wasn't missing an in-built or crazy simple alternative to rolling my own.</p>\n"}, {"tags": ["android", "kotlin", "kotlin-android-extensions"], "comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451262725, "post_id": 34485857, "comment_id": 56714708, "body": "Should this be clearer in the title that it is Android, and also what the actual issue is (currently it is the topic, but not the problem in the title)"}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 1, "creation_date": 1451262777, "post_id": 34485857, "comment_id": 56714721, "body": "For your exception, it is always useful to have a stack trace, and to note where that trace intersects with the code you provided."}], "answers": [{"comments": [{"owner": {"reputation": 7051, "user_id": 1916449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d5611f16fc8a1b73a03e44297682824f?s=128&d=identicon&r=PG", "display_name": "arekolek", "link": "https://stackoverflow.com/users/1916449/arekolek"}, "edited": false, "score": 4, "creation_date": 1503415272, "post_id": 34597544, "comment_id": 78600883, "body": "In my case <code>onViewCreated</code> is not called at all, so this didn&#39;t help."}, {"owner": {"reputation": 4359, "user_id": 536466, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/933e080a2e1f19d8936c7597af6b9d87?s=128&d=identicon&r=PG", "display_name": "Julian Suarez", "link": "https://stackoverflow.com/users/536466/julian-suarez"}, "edited": false, "score": 3, "creation_date": 1506463825, "post_id": 34597544, "comment_id": 79830191, "body": "<code>onViewCreated</code> sadly is not called on a DialogFragment"}, {"owner": {"reputation": 6403, "user_id": 85472, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/322016982798ad35df085a1b7b729c38?s=128&d=identicon&r=PG", "display_name": "Maks", "link": "https://stackoverflow.com/users/85472/maks"}, "reply_to_user": {"reputation": 4359, "user_id": 536466, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/933e080a2e1f19d8936c7597af6b9d87?s=128&d=identicon&r=PG", "display_name": "Julian Suarez", "link": "https://stackoverflow.com/users/536466/julian-suarez"}, "edited": false, "score": 0, "creation_date": 1533712859, "post_id": 34597544, "comment_id": 90441503, "body": "actually @JulianSuarez onViewCreated does seem to be called, at least on a AppCompatDialogFragment"}], "tags": [], "owner": {"reputation": 62, "user_id": 2896511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f10c6de97175f9ed56eabba21d25bdc?s=128&d=identicon&r=PG&f=1", "display_name": "Ferenc Boldog", "link": "https://stackoverflow.com/users/2896511/ferenc-boldog"}, "is_accepted": false, "score": 0, "last_activity_date": 1451932375, "creation_date": 1451932375, "answer_id": 34597544, "question_id": 34485857, "link": "https://stackoverflow.com/questions/34485857/kotlin-synthetic-and-custom-layout-in-dialogfragment/34597544#34597544", "title": "Kotlin synthetic and custom layout in DialogFragment", "body": "<p>Move your code from <code>onActivityCreated</code> to <code>onViewCreated</code> method.\nLike this:</p>\n\n<pre><code>import kotlinx.android.synthetic.main.department_chooser_dialog.dep_list\n\noverride fun onViewCreated(view: View?, savedInstanceState: Bundle?) {\n    super.onViewCreated(view, savedInstanceState)\n    dep_list.apply {\n        layoutManager = LinearLayoutManager(activity)\n        itemAnimator = DefaultItemAnimator()\n        setHasFixedSize(true)\n    }\n}\n</code></pre>\n\n<p><em>I actually didn't look deeper into generated code and maybe there is a bug.</em></p>\n"}, {"tags": [], "owner": {"reputation": 375, "user_id": 4575369, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0dC4EnaiTfQ/AAAAAAAAAAI/AAAAAAAAALs/TNIANZcKbiw/photo.jpg?sz=128", "display_name": "Andrey Koretskyy", "link": "https://stackoverflow.com/users/4575369/andrey-koretskyy"}, "is_accepted": false, "score": 5, "last_activity_date": 1507219616, "last_edit_date": 1507219616, "creation_date": 1507110257, "answer_id": 46561757, "question_id": 34485857, "link": "https://stackoverflow.com/questions/34485857/kotlin-synthetic-and-custom-layout-in-dialogfragment/46561757#46561757", "title": "Kotlin synthetic and custom layout in DialogFragment", "body": "<p>Previous answer will not work, because onViewCreated is not called when you use onCreateDialog. You should first import kotlinx...department_chooser_dialog.<strong>view</strong>.dep_list, an then use it as follows:</p>\n\n<pre><code>import kotlinx.android.synthetic.main.department_chooser_dialog.view.dep_list\n...\nclass DepartmentChoiceDialog : DialogFragment() {\n    override fun onCreateDialog(savedInstanceState: Bundle?): Dialog {\n        val builder = AlertDialog.Builder(activity)\n        val dialog = inflater.inflate(R.layout.department_chooser_dialog, null)\n        dialog.dep_list.layoutManager = LinearLayoutManager(activity)\n        dialog.dep_list.itemAnimator = DefaultItemAnimator()\n        dialog.dep_list.setHasFixedSize(true)\n        builder.setTitle(R.string.choose_or_create_dep)\n               .setView(dialog)\n                    ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21161, "user_id": 1788806, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0ca4c6bc08e59c34de7fc39e09de8dbe?s=128&d=identicon&r=PG", "display_name": "Willi Mentzel", "link": "https://stackoverflow.com/users/1788806/willi-mentzel"}, "is_accepted": false, "score": -1, "last_activity_date": 1517673634, "creation_date": 1517673634, "answer_id": 48599247, "question_id": 34485857, "link": "https://stackoverflow.com/questions/34485857/kotlin-synthetic-and-custom-layout-in-dialogfragment/48599247#48599247", "title": "Kotlin synthetic and custom layout in DialogFragment", "body": "<p>The views are accessible via the view that you inflate in <code>onCreateDialog</code>. So, if you save the view in a variable (<code>rootView</code>) you can access the views from any method inside of <code>YourDialogFragment</code>.</p>\n\n<pre><code>// ...\nimport kotlinx.android.synthetic.main.your_layout.view.*\n\nclass YourDialogFragment : DialogFragment() {\n\n    private lateinit var rootView: View\n\n    override fun onCreateDialog(savedInstanceState: Bundle?): Dialog {\n\n        rootView = activity.layoutInflater.inflate(R.layout.your_layout, null as ViewGroup?)\n\n        rootView.someTextView.text = \"Hello\" // works\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 5331376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3r3ErqSCF9A/AAAAAAAAAAI/AAAAAAAAYF8/D-xW0dA1qq8/photo.jpg?sz=128", "display_name": "Lucas Montano", "link": "https://stackoverflow.com/users/5331376/lucas-montano"}, "is_accepted": false, "score": 4, "last_activity_date": 1520358846, "last_edit_date": 1520358846, "creation_date": 1520357693, "answer_id": 49136826, "question_id": 34485857, "link": "https://stackoverflow.com/questions/34485857/kotlin-synthetic-and-custom-layout-in-dialogfragment/49136826#49136826", "title": "Kotlin synthetic and custom layout in DialogFragment", "body": "<p>Change to <strong>onCreateView</strong> implementation</p>\n\n<pre><code>override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {\n    return inflater.inflate(R.layout.department_chooser_dialog, container, false)\n}\n</code></pre>\n\n<p>and use a custom title(TextView) and cancel(Button) in the <em>department_chooser_dialog</em></p>\n\n<p><strong>onActivityCreated</strong> will run after onCreateView and will be just fine.</p>\n\n<pre><code>override fun onActivityCreated(savedInstanceState: Bundle?) {\n    super.onActivityCreated(savedInstanceState)\n    dep_list.layoutManager = LinearLayoutManager(activity)\n    dep_list.itemAnimator = DefaultItemAnimator()\n    dep_list.setHasFixedSize(true)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3828, "user_id": 1495686, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mQMVJ.png?s=128&g=1", "display_name": "Bohsen", "link": "https://stackoverflow.com/users/1495686/bohsen"}, "edited": false, "score": 0, "creation_date": 1523610170, "post_id": 49352178, "comment_id": 86640614, "body": "The cleanest solution. Just a small question. Could this setup lead to memory leaks, when you save a reference to the view or does Android take care of this?"}, {"owner": {"reputation": 3492, "user_id": 4548500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/682a8ee4855d2f4617199afbd9fd23cf?s=128&d=identicon&r=PG", "display_name": "SUPERCILEX", "link": "https://stackoverflow.com/users/4548500/supercilex"}, "reply_to_user": {"reputation": 3828, "user_id": 1495686, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mQMVJ.png?s=128&g=1", "display_name": "Bohsen", "link": "https://stackoverflow.com/users/1495686/bohsen"}, "edited": false, "score": 3, "creation_date": 1523631714, "post_id": 49352178, "comment_id": 86654848, "body": "I use Leak Canary and haven&#39;t noticed anything. Also, just thinking about it, it wouldn&#39;t make sense for there to be a memory leak since the view is associated with an instance of a context class and will die with it in a config change."}, {"owner": {"reputation": 2395, "user_id": 2376004, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/DhIW1.png?s=128&g=1", "display_name": "Bad Loser", "link": "https://stackoverflow.com/users/2376004/bad-loser"}, "edited": false, "score": 0, "creation_date": 1568176318, "post_id": 49352178, "comment_id": 102187088, "body": "[Upvoted for sheer ingenuity] It certainly works. But in my case (generic Dialog within DialogFragment) I suffered a bizarre side-effect: Somehow an unspecified theme got applied to the View and I was seeing white text on a white background!"}], "tags": [], "owner": {"reputation": 3492, "user_id": 4548500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/682a8ee4855d2f4617199afbd9fd23cf?s=128&d=identicon&r=PG", "display_name": "SUPERCILEX", "link": "https://stackoverflow.com/users/4548500/supercilex"}, "is_accepted": false, "score": 9, "last_activity_date": 1521402443, "creation_date": 1521402443, "answer_id": 49352178, "question_id": 34485857, "link": "https://stackoverflow.com/questions/34485857/kotlin-synthetic-and-custom-layout-in-dialogfragment/49352178#49352178", "title": "Kotlin synthetic and custom layout in DialogFragment", "body": "<p>It looks like this isn't supported by default yet, but I've found the easiest way to do it to be like this. In a base dialog class:</p>\n\n<pre><code>protected abstract val containerView: View\n\noverride fun getView() = containerView\n</code></pre>\n\n<p>In a subclass:</p>\n\n<pre><code>override val containerView by unsafeLazy {\n    View.inflate(context, R.layout.dialog_team_details, null) as ViewGroup\n}\n</code></pre>\n\n<p>Then you can use the synthetic views as you normally would and use the <code>containerView</code> as the view for your dialog.</p>\n"}, {"comments": [{"owner": {"reputation": 2574, "user_id": 3173384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y8uK1.jpg?s=128&g=1", "display_name": "Penzzz", "link": "https://stackoverflow.com/users/3173384/penzzz"}, "edited": false, "score": 0, "creation_date": 1559039806, "post_id": 49470146, "comment_id": 99285846, "body": "this solution is leaking, on rotate for example, so better add customView = null in onDestroyView"}, {"owner": {"reputation": 81, "user_id": 5035991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6126d6053791eb39c9f82ae78404f1b4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Goldberg", "link": "https://stackoverflow.com/users/5035991/mr-goldberg"}, "edited": false, "score": 0, "creation_date": 1609184543, "post_id": 49470146, "comment_id": 115771617, "body": "If you override both <code>onCreateDialog</code> and <code>onCreateView</code>, then the DialogFragment might crash with <code>AndroidRuntimeException: requestFeature() must be called before adding content</code>. This is happening at least for API 23 but may be true for some other APIs and circumstances. See <a href=\"https://stackoverflow.com/a/21734372/5035991\">stackoverflow.com/a/21734372/5035991</a>. The safer solution is to override only <code>onCreateDialog</code>, set your view to the dialog and store it in your DialogFragment, then call synthetic features on the view: <code>this.dialogView.my_text_view.text = &quot;...&quot;</code>."}], "tags": [], "owner": {"reputation": 422, "user_id": 3247674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19c4e622aaf14bd0ae0691fed62c38eb?s=128&d=identicon&r=PG&f=1", "display_name": "Sabaat Ahmad", "link": "https://stackoverflow.com/users/3247674/sabaat-ahmad"}, "is_accepted": false, "score": 14, "last_activity_date": 1521928581, "last_edit_date": 1521928581, "creation_date": 1521926943, "answer_id": 49470146, "question_id": 34485857, "link": "https://stackoverflow.com/questions/34485857/kotlin-synthetic-and-custom-layout-in-dialogfragment/49470146#49470146", "title": "Kotlin synthetic and custom layout in DialogFragment", "body": "<p>I found a way that works for custom dialogs.</p>\n\n<pre><code>class ServerPickerDialogFragment: AppCompatDialogFragment() \n{\n  // Save your custom view at the class level\n  lateinit var customView: View;\n  override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?,\n                            savedInstanceState: Bundle?): View? \n  {\n       // Simply return the already inflated custom view\n       return customView\n  }\n\n  override fun onCreateDialog(savedInstanceState: Bundle?): Dialog {\n      // Inflate your view here\n      customView = context!!.layoutInflater.inflate(R.layout.dialog_server_picker, null) \n      // Create Alert Dialog with your custom view\n      return AlertDialog.Builder(context!!)\n             .setTitle(R.string.server_picker_dialog_title)\n             .setView(customView)\n             .setNegativeButton(android.R.string.cancel, null)\n             .create()\n  }\n\n  override fun onViewCreated(view: View, savedInstanceState: Bundle?) \n  {\n    super.onViewCreated(view, savedInstanceState)\n    // Perform remaining operations here. No null issues.\n    rbgSelectType.setOnCheckedChangeListener({ _, checkedId -&gt;\n      if(checkedId == R.id.rbSelectFromList) {\n             // XYZ\n      } else {\n             // ABC\n      }\n    })\n  }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 285, "user_id": 4604713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XyEob.png?s=128&g=1", "display_name": "act262", "link": "https://stackoverflow.com/users/4604713/act262"}, "is_accepted": false, "score": 2, "last_activity_date": 1527578395, "creation_date": 1527578395, "answer_id": 50578522, "question_id": 34485857, "link": "https://stackoverflow.com/questions/34485857/kotlin-synthetic-and-custom-layout-in-dialogfragment/50578522#50578522", "title": "Kotlin synthetic and custom layout in DialogFragment", "body": "<p>Because the default view's value from fragment(kotlin generate method _$_findCachedViewById), but if we create View from dialog, lead to fragment view is null, so we can't directly use default xxx , but we can use dialog.xxx replace default xxx</p>\n"}, {"tags": [], "owner": {"reputation": 224, "user_id": 6609792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/279f2abdb010ff5f64990fab05826516?s=128&d=identicon&r=PG&f=1", "display_name": "Aceofspadez44", "link": "https://stackoverflow.com/users/6609792/aceofspadez44"}, "is_accepted": false, "score": 4, "last_activity_date": 1528898643, "creation_date": 1528898643, "answer_id": 50839227, "question_id": 34485857, "link": "https://stackoverflow.com/questions/34485857/kotlin-synthetic-and-custom-layout-in-dialogfragment/50839227#50839227", "title": "Kotlin synthetic and custom layout in DialogFragment", "body": "<p>So I'm not sure if this has been solved... I just came across this. If you have a custom Dialog view make a class that extends DialogFragment and use the \"dialog\" object to import views in the layout. I'm using <code>Android Studio 3.1.3</code> and <code>Kotlin version 1.2.41</code> at the time of writing.</p>\n\n<pre><code>import kotlinx.android.synthetic.main.your_custom_layout.*\n\nclass SelectCountryBottomSheet : BottomSheetDialogFragment() {\n\n  override fun onCreateDialog(savedInstanceState: Bundle?): Dialog {\n      val dialog = super.onCreateDialog(savedInstanceState) as BottomSheetDialog\n      dialog.setContentView(R.layout.your_custom_layout)\n      dialog.some_custom_close_button.setOnClickListener { dismiss() }\n      return dialog\n  }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 5518220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MDD0JLhM2Dk/AAAAAAAAAAI/AAAAAAAAAGg/22kptnozu2U/photo.jpg?sz=128", "display_name": "ggaier", "link": "https://stackoverflow.com/users/5518220/ggaier"}, "is_accepted": false, "score": 1, "last_activity_date": 1540373166, "last_edit_date": 1540373166, "creation_date": 1540372230, "answer_id": 52965122, "question_id": 34485857, "link": "https://stackoverflow.com/questions/34485857/kotlin-synthetic-and-custom-layout-in-dialogfragment/52965122#52965122", "title": "Kotlin synthetic and custom layout in DialogFragment", "body": "<p>The kotlin code in a Fragment like this: </p>\n\n<pre><code>override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {\n    return inflater.inflate(R.layout.your_layout, container, false).apply {\n        mContentView = this\n        button1.setOnClickListener { \n            //do something\n        }\n    }\n}\n</code></pre>\n\n<p>After decompile the bytecode, you can see the implementation of synthetic properties:\n<code>\n((Button)this._$_findCachedViewById(id.button1))\n</code> \nand the <code>_$_findCachedViewById</code> method :</p>\n\n<pre><code>public View _$_findCachedViewById(int var1) {\n  if (this._$_findViewCache == null) {\n     this._$_findViewCache = new HashMap();\n  }\n\n  View var2 = (View)this._$_findViewCache.get(var1);\n  if (var2 == null) {\n     View var10000 = this.getView();\n     if (var10000 == null) {\n        return null;\n     }\n\n     var2 = var10000.findViewById(var1);\n     this._$_findViewCache.put(var1, var2);\n  }\n\n  return var2;\n</code></pre>\n\n<p>}</p>\n\n<p>so the magic is just the <code>this.getView()</code>. <strong>The <code>Fragment.mView</code> property is assigned after <code>Fragment.onCreateView(inflater, container, savedInstanceState)</code></strong>, if you use Kotlin Synthetic Properties in onCreateView() method, there will be a NPE. Code from <code>FragmentManager.moveToState()</code>: </p>\n\n<pre><code>case Fragment.CREATED:\n    ...\n    f.mView = f.performCreateView(f.performGetLayoutInflater(\n                                f.mSavedFragmentState), container, \n    f.mSavedFragmentState);\n    ...\n</code></pre>\n\n<p>To fix the NPE, make sure <code>getView</code> method return a non-null view.</p>\n\n<pre><code>private var mContentView: View? = null\noverride fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {\n    return inflater.inflate(R.layout.your_layout, container, false).apply {\n        mContentView = this\n    }\n}\noverride fun getView(): View? {\n    return mContentView\n}\n</code></pre>\n\n<p>and at the <code>onDestroyView()</code> lifecycle callback, set <code>mContentView</code> to null. </p>\n\n<pre><code>override fun onDestroyView() {\n    super.onDestroyView()\n    mView = null\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8472212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9839f53e2b50aa86dcb755488d0dd5c3?s=128&d=identicon&r=PG&f=1", "display_name": "XuesongZhang", "link": "https://stackoverflow.com/users/8472212/xuesongzhang"}, "is_accepted": false, "score": 1, "last_activity_date": 1564476998, "last_edit_date": 1564476998, "creation_date": 1564475894, "answer_id": 57267549, "question_id": 34485857, "link": "https://stackoverflow.com/questions/34485857/kotlin-synthetic-and-custom-layout-in-dialogfragment/57267549#57267549", "title": "Kotlin synthetic and custom layout in DialogFragment", "body": "<p>The setContentView is inside the OnActivityCreated calls. So by a synthetic set of controls to monitor events needs to call here:</p>\n\n<pre><code>override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {\n    return inflater.inflate(R.layout.layout_email_ga_code, container)\n}\n\noverride fun onCreate(savedInstanceState: Bundle?) {\n    super.onCreate(savedInstanceState)\n}\n\noverride fun onActivityCreated(savedInstanceState: Bundle?) {\n    dialog?.window?.requestFeature(Window.FEATURE_NO_TITLE)\n    super.onActivityCreated(savedInstanceState)\n    dialog?.window?.setLayout(WindowManager.LayoutParams.MATCH_PARENT, WindowManager.LayoutParams.MATCH_PARENT)\n\n    btn_back?.setOnClickListener {\n        mOnClickListener?.onClickCancel()\n        dismiss()\n    }\n}\n</code></pre>\n\n<p>And it worked.</p>\n"}], "owner": {"reputation": 5143, "user_id": 600351, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2a3b9fd62972fa271deb3d0e31256c?s=128&d=identicon&r=PG", "display_name": "Geob-o-matic", "link": "https://stackoverflow.com/users/600351/geob-o-matic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17112, "favorite_count": 2, "answer_count": 10, "score": 30, "last_activity_date": 1564476998, "creation_date": 1451257889, "last_edit_date": 1517671695, "question_id": 34485857, "link": "https://stackoverflow.com/questions/34485857/kotlin-synthetic-and-custom-layout-in-dialogfragment", "title": "Kotlin synthetic and custom layout in DialogFragment", "body": "<p>Let's say I have this layout:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\nandroid:layout_width=\"match_parent\"\nandroid:layout_height=\"match_parent\"\nandroid:orientation=\"vertical\"&gt;\n\n&lt;ImageButton\n    android:id=\"@+id/add_dep_btn\"\n    android:layout_width=\"wrap_content\"\n    android:layout_height=\"wrap_content\"\n    android:layout_alignParentEnd=\"true\"\n    android:layout_alignParentRight=\"true\"\n    android:layout_marginEnd=\"5dp\"\n    android:layout_marginRight=\"5dp\"\n    android:src=\"@android:drawable/ic_input_add\" /&gt;\n\n&lt;EditText\n    android:id=\"@+id/add_dep_text\"\n    android:layout_width=\"wrap_content\"\n    android:layout_height=\"wrap_content\"\n    android:layout_alignBottom=\"@id/add_dep_btn\"\n    android:layout_alignParentLeft=\"true\"\n    android:layout_alignParentStart=\"true\"\n    android:layout_alignTop=\"@id/add_dep_btn\"\n    android:layout_marginLeft=\"5dp\"\n    android:layout_marginStart=\"5dp\"\n    android:layout_toLeftOf=\"@id/add_dep_btn\"\n    android:layout_toStartOf=\"@id/add_dep_btn\" /&gt;\n\n&lt;android.support.v7.widget.RecyclerView\n    android:id=\"@+id/dep_list\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"wrap_content\"\n    android:layout_below=\"@id/add_dep_btn\" /&gt;\n\n&lt;TextView\n    android:id=\"@+id/empty_text\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"wrap_content\"\n    android:layout_below=\"@id/add_dep_text\"\n    android:layout_margin=\"20dp\"\n    android:gravity=\"center\"\n    android:text=\"@string/no_dep\"\n    android:textSize=\"22sp\" /&gt;\n&lt;/RelativeLayout&gt;\n</code></pre>\n\n<p>And I use it in a DialogFragment:</p>\n\n<pre><code>class DepartmentChoiceDialog : DialogFragment() {\n    override fun onCreateDialog(savedInstanceState: Bundle?): Dialog {\n        val builder = AlertDialog.Builder(activity)\n        builder.setTitle(R.string.choose_or_create_dep)\n            .setView(R.layout.department_chooser_dialog)\n            .setNegativeButton(android.R.string.cancel, { d, i -&gt;\n                d.cancel()\n            })\n        return builder.create()\n    }\n}\n</code></pre>\n\n<p>if I refer to the widget using synthetic:</p>\n\n<pre><code>override fun onActivityCreated(savedInstanceState: Bundle?) {\n    super.onActivityCreated(savedInstanceState)\n    dep_list.layoutManager = LinearLayoutManager(activity)\n    dep_list.itemAnimator = DefaultItemAnimator()\n    dep_list.setHasFixedSize(true)\n}\n</code></pre>\n\n<p>I got this error at runtime:</p>\n\n<blockquote>\n  <p>java.lang.NullPointerException: Attempt to invoke virtual method 'android.view.View android.view.View.findViewById(int)' on a null object reference\n                                                                          at MyDialog._$_findCachedViewById(DepartmentChoiceDialog.kt:0)</p>\n</blockquote>\n\n<p>I don't understand how to use synthetic in DialogFragment case. It works fine in Fragment and Activity.</p>\n"}, {"tags": ["generics", "rx-java", "kotlin"], "answers": [{"tags": [], "owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "is_accepted": true, "score": 7, "last_activity_date": 1451173936, "last_edit_date": 1451173936, "creation_date": 1451171401, "answer_id": 34476128, "question_id": 34476007, "link": "https://stackoverflow.com/questions/34476007/rxkotlin-trying-to-add-custom-errors-catching/34476128#34476128", "title": "RxKotlin: trying to add custom errors catching", "body": "<p>First, to specify <code>E</code> explictly, you could use the more verbose lambda syntax. This would look like this:</p>\n\n<pre><code>myObservable.handleError { it : IOException -&gt; it.printStackTrace() }\n</code></pre>\n\n<p>Alternativly, you could add an additional parameter to help the compiler infer the type. This could look something like this:</p>\n\n<pre><code>public inline fun &lt;reified E : Throwable, R&gt; Observable&lt;R&gt;.handleError(\n    typeHint: (E) -&gt; Unit,\n    crossinline handler: (E) -&gt; Unit\n) = onErrorResumeNext f@{\n        return@f when (e) {\n            is E -&gt; { handler(e); Observable.empty() }\n            else -&gt; Observable.error(e)\n        }\n    }    \n\nfun &lt;T&gt; of() : (T) -&gt; Unit = {}\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>myObservable.handleError(of&lt;IOException&gt;()) { it.printStackTrace() }\n</code></pre>\n"}], "owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 1, "accepted_answer_id": 34476128, "answer_count": 1, "score": 3, "last_activity_date": 1451173958, "creation_date": 1451170435, "last_edit_date": 1451173958, "question_id": 34476007, "link": "https://stackoverflow.com/questions/34476007/rxkotlin-trying-to-add-custom-errors-catching", "title": "RxKotlin: trying to add custom errors catching", "body": "<p>I'm trying to write my own extension function for RxKotlin which would make an <code>Observable</code> handle a specific error type (<code>Throwable</code> subclass) with a handler which is passed as an argument and emit no more items.</p>\n\n<p>Marble diagram would be:</p>\n\n<pre><code>--- a --- b --- c --- error : T\n\n[   handleError&lt;T&gt;(handler)   ]\n\n--- a --- b --- c --- finished\n                   |\n             handler(error)\n</code></pre>\n\n<p>I wrote the following:</p>\n\n<pre><code>public inline fun &lt;reified E : Throwable, R&gt; Observable&lt;R&gt;.handleError(\n    crossinline handler: (E) -&gt; Unit\n) = onErrorResumeNext f@{\n        return@f when (e) {\n            is E -&gt; { handler(e); Observable.empty() }\n            else -&gt; Observable.error(e)\n        }\n    }\n</code></pre>\n\n<p>It's working OK, but to use it I have to write, for example:</p>\n\n<pre><code> val myObservable: Observable&lt;SomeClass&gt; = ...\n\n myObservable.handleError&lt;IOException, SomeClass&gt; { it.printStackTrace() }\n                                       ^^^^^^^^^\n</code></pre>\n\n<p>I don't like it that I have to write the <code>Observable</code>'s generic in <code>handleError</code> call, I'd like to avoid it.</p>\n\n<p>So, is there a way to avoid explicitly specifying the second generic parameter?</p>\n\n<p>I suppose, there's no way to make the compiler infer it once I specify one of generic parameters. But is there any way to rewrite <code>handleErrors</code> to achieve what I want?</p>\n"}, {"tags": ["generics", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 2094, "user_id": 3858030, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/213edfb3b091fb865caa70bde8c43763?s=128&d=identicon&r=PG", "display_name": "Ufkoku", "link": "https://stackoverflow.com/users/3858030/ufkoku"}, "edited": false, "score": 4, "creation_date": 1485601888, "post_id": 34470853, "comment_id": 70999670, "body": "Is there any way to use it for parametr type of fun, for example, fun foo(arg : ClassType, InterfaceType){}? Without adding type parameter to class"}, {"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "reply_to_user": {"reputation": 2094, "user_id": 3858030, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/213edfb3b091fb865caa70bde8c43763?s=128&d=identicon&r=PG", "display_name": "Ufkoku", "link": "https://stackoverflow.com/users/3858030/ufkoku"}, "edited": false, "score": 1, "creation_date": 1485602283, "post_id": 34470853, "comment_id": 70999770, "body": "@Ufkoku, no, there&#39;s no way to do it: there&#39;s no intersection types in Kotlin, and generic parameters can only be declared explicitly."}, {"owner": {"reputation": 173, "user_id": 6902588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4606eecefbb5d50527ef17bf732c5f3?s=128&d=identicon&r=PG&f=1", "display_name": "leimenghao", "link": "https://stackoverflow.com/users/6902588/leimenghao"}, "edited": false, "score": 1, "creation_date": 1598004688, "post_id": 34470853, "comment_id": 112323318, "body": "@hotkey I have a function below:<code>fun &lt;T&gt; wrapClientListener(listener: RemoteController.OnClientUpdateListener): T where T : RemoteController.OnClientUpdateListener, T : NotificationListenerService</code>.  I don&#39;t care of T&#39;s type. But When I call this method, Kotlin asks for the specific type. So how can i call this method?"}], "tags": [], "owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "is_accepted": true, "score": 200, "last_activity_date": 1526081010, "last_edit_date": 1526081010, "creation_date": 1451128978, "answer_id": 34470853, "question_id": 34470703, "link": "https://stackoverflow.com/questions/34470703/generic-extending-class-and-implements-interface-in-kotlin/34470853#34470853", "title": "Generic extending class AND implements interface in Kotlin", "body": "<p>Only one upper bound can be specified inside the angle brackets.</p>\n\n<p>Kotlin offers different syntax for generic constraints when there is more than one constraint:</p>\n\n<pre><code>class Foo&lt;T&gt;(val t: T) where T : Bar, T : Baz { ... }\n</code></pre>\n\n<p>and for functions:</p>\n\n<pre><code>fun &lt;T&gt; f(): Foo where T : Bar, T : Baz { ... }\n</code></pre>\n\n<p>It is documented <a href=\"https://kotlinlang.org/docs/reference/generics.html#upper-bounds\" rel=\"noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 1052, "user_id": 4127239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bc8f5f2f3fce19f248e159557035ecd?s=128&d=identicon&r=PG&f=1", "display_name": "frenchdonuts", "link": "https://stackoverflow.com/users/4127239/frenchdonuts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35420, "favorite_count": 11, "accepted_answer_id": 34470853, "answer_count": 1, "score": 95, "last_activity_date": 1526081010, "creation_date": 1451127770, "question_id": 34470703, "link": "https://stackoverflow.com/questions/34470703/generic-extending-class-and-implements-interface-in-kotlin", "title": "Generic extending class AND implements interface in Kotlin", "body": "<p>Say I want a type variable, T, that extends a certain class and implements an interface. Something like:</p>\n\n<pre><code>class Foo &lt;T : Bar implements Baz&gt; { ... }\n</code></pre>\n\n<p>What is the syntax for this in Kotlin?</p>\n"}, {"tags": ["expression-trees", "kotlin"], "comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451046817, "post_id": 34461595, "comment_id": 56667443, "body": "The link above is to an &quot;April Fools&quot; joke by the Kotlin team, it is NOT a feature of Kotlin."}], "answers": [{"tags": [], "owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "is_accepted": true, "score": 3, "last_activity_date": 1452256966, "last_edit_date": 1452256966, "creation_date": 1451046976, "answer_id": 34462919, "question_id": 34461595, "link": "https://stackoverflow.com/questions/34461595/does-kotlin-support-expression-trees/34462919#34462919", "title": "Does Kotlin support expression trees?", "body": "<p>No, Currently Kotlin (and for 1.0) does not support expression trees.  There has been similar talk in the Kotlin chat on Slack that something might be coming in the future after 1.0.  It is best if you go there, to the channel <code>#language-proposals</code> and discuss future features there that are under discussion and have no concrete answer. <a href=\"http://kotlinslackin.herokuapp.com/\" rel=\"nofollow\">Kotlin Slack</a>.</p>\n"}], "owner": {"reputation": 2276, "user_id": 1740335, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QHyBk.png?s=128&g=1", "display_name": "x2bool", "link": "https://stackoverflow.com/users/1740335/x2bool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 2, "accepted_answer_id": 34462919, "answer_count": 1, "score": 3, "last_activity_date": 1452256966, "creation_date": 1451035142, "question_id": 34461595, "link": "https://stackoverflow.com/questions/34461595/does-kotlin-support-expression-trees", "title": "Does Kotlin support expression trees?", "body": "<p>It seems that there was a plan to include this feature in the language, but I cannot find anything in documentation about it. Does Kotlin support expression trees? Is this feature still on the roadmap?</p>\n"}, {"tags": ["dictionary", "for-loop", "iteration", "kotlin"], "comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451047146, "post_id": 34458588, "comment_id": 56667532, "body": "Your question is missing information needed to help answer your question.  For example, what version of Kotlin were you using that worked, versus which did not work?  Also, if you think this is a bug, then you should report it to the Kotlin issue tracker at <a href=\"https://youtrack.jetbrains.com\" rel=\"nofollow noreferrer\">youtrack.jetbrains.com</a>"}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451047322, "post_id": 34458588, "comment_id": 56667577, "body": "I think this question might be invalid now, it was caused by using a very old plugin of Kotlin so the question is based on not knowing you were on an old version of Kotlin.  Can the author please add a note to the top of the question that this was NOT a problem with current Kotlin and the question be closed?   The question is really &quot;if I use a very old version of Kotlin on accident, why do current features not work?&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 7656, "user_id": 1938929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/OeAme.png?s=128&g=1", "display_name": "Jire", "link": "https://stackoverflow.com/users/1938929/jire"}, "edited": false, "score": 0, "creation_date": 1450999450, "post_id": 34458737, "comment_id": 56659526, "body": "That&#39;s interesting! I got it fixed by downloading the plugin off JetBrain&#39;s plugin repository (<a href=\"http://plugins.jetbrains.com/plugin/6954?pr=idea\" rel=\"nofollow noreferrer\">plugins.jetbrains.com/plugin/6954?pr=idea</a>) and then installing the plugin from disk."}, {"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "reply_to_user": {"reputation": 7656, "user_id": 1938929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/OeAme.png?s=128&g=1", "display_name": "Jire", "link": "https://stackoverflow.com/users/1938929/jire"}, "edited": false, "score": 1, "creation_date": 1450999936, "post_id": 34458737, "comment_id": 56659627, "body": "@Jire, that looks even stranger as I could not reproduce the same after I created two more projects where I could..."}, {"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "reply_to_user": {"reputation": 7656, "user_id": 1938929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/OeAme.png?s=128&g=1", "display_name": "Jire", "link": "https://stackoverflow.com/users/1938929/jire"}, "edited": false, "score": 1, "creation_date": 1451000151, "post_id": 34458737, "comment_id": 56659669, "body": "@Jire, I could reproduce it again: I just needed to accept IDE&#39;s suggestion on Gradle file. However, the bug disappears on any project re-import, so it seems a minor one."}], "tags": [], "owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "is_accepted": true, "score": 1, "last_activity_date": 1450999889, "last_edit_date": 1450999889, "creation_date": 1450999363, "answer_id": 34458737, "question_id": 34458588, "link": "https://stackoverflow.com/questions/34458588/kotlin-is-it-no-longer-possible-to-iterate-a-map-with-destructured-entry-bug/34458737#34458737", "title": "Kotlin: Is it no longer possible to iterate a map with destructured Entry? Bug?", "body": "<p>Looks like a bug in IDE and Gradle plugins. I tried the following:</p>\n\n<ul>\n<li>Created a clean Gradle project with Kotlin 4584 and pasted your code. The bug was there, the same to your occurence.</li>\n<li>Changed Kotlin version to the previous one, 4583, and reimported the project. The code compiled well.</li>\n<li>Changed Kotlin version back to 4584, and the bug didn't show itself, the code compiled successfully. </li>\n</ul>\n\n<p>No following changes could let me reproduce the bug in this project, but I could in a new one.</p>\n"}, {"tags": [], "owner": {"reputation": 7656, "user_id": 1938929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/OeAme.png?s=128&g=1", "display_name": "Jire", "link": "https://stackoverflow.com/users/1938929/jire"}, "is_accepted": false, "score": 0, "last_activity_date": 1450999363, "creation_date": 1450999363, "answer_id": 34458738, "question_id": 34458588, "link": "https://stackoverflow.com/questions/34458588/kotlin-is-it-no-longer-possible-to-iterate-a-map-with-destructured-entry-bug/34458738#34458738", "title": "Kotlin: Is it no longer possible to iterate a map with destructured Entry? Bug?", "body": "<p>Oddly IntelliJ offered me to \"update\" to Kotlin plugin 2428 which caused this.</p>\n\n<p>Downloading off JetBrain's plugin repository (Kotlin plugin here: <a href=\"http://plugins.jetbrains.com/plugin/6954?pr=idea\" rel=\"nofollow\">http://plugins.jetbrains.com/plugin/6954?pr=idea</a>) and choosing <code>Install from disk...</code> in IntelliJ fixed the problem.</p>\n"}], "owner": {"reputation": 7656, "user_id": 1938929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/OeAme.png?s=128&g=1", "display_name": "Jire", "link": "https://stackoverflow.com/users/1938929/jire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3160, "favorite_count": 1, "accepted_answer_id": 34458737, "answer_count": 2, "score": 3, "last_activity_date": 1504623569, "creation_date": 1450997708, "last_edit_date": 1504623569, "question_id": 34458588, "link": "https://stackoverflow.com/questions/34458588/kotlin-is-it-no-longer-possible-to-iterate-a-map-with-destructured-entry-bug", "title": "Kotlin: Is it no longer possible to iterate a map with destructured Entry? Bug?", "body": "<p>It seems like with the latest Kotlin update you can no longer iterate through maps with destructured <code>Entry</code>. For example:</p>\n\n<pre><code>val map = HashMap&lt;Int, String&gt;()\n\nfor ((i, s) in map) { // compiler error here\n    ... // code\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/tqMHM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tqMHM.png\" alt=\"enter image description here\"></a></p>\n\n<p>The compiler error is <code>For-loop range must have an iterator() method</code></p>\n\n<p>This feature previously worked as expected, iterating through each entry in the map. I have also tried to use <code>map.entries</code> and <code>map.entrySet()</code> (deprecated) and with these:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Xw5zq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xw5zq.png\" alt=\"enter image description here\"></a></p>\n\n<p>What is the idiomatic way to iterate through a map now? Is this a bug?</p>\n"}, {"tags": ["kotlin"], "answers": [{"comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 3, "creation_date": 1451045658, "post_id": 34459307, "comment_id": 56667148, "body": "You can find a sample of using the Kotlin compiler within the Kobalt build system.  See this file here: <a href=\"https://github.com/cbeust/kobalt/blob/master/src/main/kotlin/com/beust/kobalt/plugin/kotlin/KotlinCompiler.kt\" rel=\"nofollow noreferrer\">github.com/cbeust/kobalt/blob/master/src/main/kotlin/com/beu&zwnj;&#8203;st/&hellip;</a>"}, {"owner": {"reputation": 14934, "user_id": 162410, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/97a472a751e503a7f8e5d88ba087a87c?s=128&d=identicon&r=PG", "display_name": "Cedric Beust", "link": "https://stackoverflow.com/users/162410/cedric-beust"}, "edited": false, "score": 0, "creation_date": 1451059560, "post_id": 34459307, "comment_id": 56670532, "body": "Also, note that <code>K2MVCompiler</code> does <b>not</b> support incremental compilation just yet, this is only supported in IDEA (and soon Gradle I hear)."}, {"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "reply_to_user": {"reputation": 14934, "user_id": 162410, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/97a472a751e503a7f8e5d88ba087a87c?s=128&d=identicon&r=PG", "display_name": "Cedric Beust", "link": "https://stackoverflow.com/users/162410/cedric-beust"}, "edited": false, "score": 0, "creation_date": 1451061644, "post_id": 34459307, "comment_id": 56671043, "body": "@CedricBeust thanks; I&#39;ve edited my answer accordingly"}], "tags": [], "owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "is_accepted": true, "score": 2, "last_activity_date": 1451061574, "last_edit_date": 1451061574, "creation_date": 1451006903, "answer_id": 34459307, "question_id": 34457873, "link": "https://stackoverflow.com/questions/34457873/invoke-kotlin-compiler-from-java-program/34459307#34459307", "title": "Invoke Kotlin compiler from Java program", "body": "<p>Yes. I believe <a href=\"https://github.com/JetBrains/kotlin/blob/master/compiler/cli/src/org/jetbrains/kotlin/cli/jvm/K2JVMCompiler.kt\" rel=\"nofollow\">K2JVMCompiler</a> will satisfy your needs.</p>\n\n<p>I don't believe you will find much documentation for it though. The best place to start would probably be in Kotlin's own smoke tests which use the class.</p>\n"}], "owner": {"reputation": 13339, "user_id": 391227, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/00832b0bc725df401bdec90786388fda?s=128&d=identicon&r=PG", "display_name": "Gelin Luo", "link": "https://stackoverflow.com/users/391227/gelin-luo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 407, "favorite_count": 0, "accepted_answer_id": 34459307, "answer_count": 1, "score": 3, "last_activity_date": 1451061574, "creation_date": 1450990955, "question_id": 34457873, "link": "https://stackoverflow.com/questions/34457873/invoke-kotlin-compiler-from-java-program", "title": "Invoke Kotlin compiler from Java program", "body": "<p>Is there kind of thing allow me to compile Kotlin program in memory, like ECJ (the Eclipse java compiler)? </p>\n"}, {"tags": ["android", "rx-java", "kotlin"], "answers": [{"tags": [], "owner": {"reputation": 11062, "user_id": 1104902, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e2ce37fa708768742edc4ed94b4cb76d?s=128&d=identicon&r=PG", "display_name": "pt2121", "link": "https://stackoverflow.com/users/1104902/pt2121"}, "is_accepted": true, "score": 5, "last_activity_date": 1450974064, "last_edit_date": 1450974064, "creation_date": 1450972993, "answer_id": 34455235, "question_id": 34447356, "link": "https://stackoverflow.com/questions/34447356/caused-by-rx-exceptions-missingbackpressureexception/34455235#34455235", "title": "Caused by: rx.exceptions.MissingBackpressureException", "body": "<p>The problem is your Observable source emits faster than the consumer consumes. It takes 100 ms to save each product. You can add onBackpressureBuffer(). </p>\n\n<pre><code>UpdateHelper().startUpdate()\n    .onBackpressureBuffer() // Add this\n    .subscribeOn(Schedulers.io())\n    .observeOn(AndroidSchedulers.mainThread())\n    .subscribe({\n      Log.d(TAG, \"next $it\")\n    }, {\n      Log.d(TAG, it.message)\n    }, {\n    })\n</code></pre>\n\n<p>Also, you can try removing <code>Thread.sleep(100)</code>.</p>\n\n<p>flatmap use <a href=\"https://github.com/ReactiveX/RxJava/blob/master/src/main/java/rx/internal/operators/OperatorMerge.java\" rel=\"noreferrer\">OperatorMerge</a> ( <code>merge(map(func))</code>): you can see that in your case, <code>map</code>'s onNexts are sent faster than have been requested.</p>\n"}], "owner": {"reputation": 555, "user_id": 4564530, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TnXH6aUu1tI/AAAAAAAAAAI/AAAAAAAAAwk/24cWrMW9hV8/photo.jpg?sz=128", "display_name": "Leo", "link": "https://stackoverflow.com/users/4564530/leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1811, "favorite_count": 0, "accepted_answer_id": 34455235, "answer_count": 1, "score": 1, "last_activity_date": 1450974064, "creation_date": 1450932285, "last_edit_date": 1450970743, "question_id": 34447356, "link": "https://stackoverflow.com/questions/34447356/caused-by-rx-exceptions-missingbackpressureexception", "title": "Caused by: rx.exceptions.MissingBackpressureException", "body": "<p>I have an other problem. This time I am facing this error <code>Caused by: rx.exceptions.MissingBackpressureException</code> during the execution of this code:</p>\n\n<pre><code>class UpdateHelper {\nval numberOfFileToUpdate: PublishSubject&lt;Int&gt;\n\ninit {\n    numberOfFileToUpdate = PublishSubject.create()\n}\n\npublic fun startUpdate(): Observable&lt;Int&gt;{\n    return getProducts().flatMap { products: ArrayList&lt;Product&gt; -&gt;\n            numberOfFileToUpdate.onNext(products.size)\n            return@flatMap saveRows(products)\n        }\n}\n\nprivate fun getProducts(): Observable&lt;ArrayList&lt;Product&gt;&gt; {\n    return Observable.create {\n        var products: ArrayList&lt;Product&gt; = ArrayList()\n        var i = 0\n        while (i++ &lt; 100) {\n            products.add(Product())\n        }\n\n        it.onNext(products)\n        it.onCompleted()\n    }\n}\n\n\nprivate fun saveRows(products: ArrayList&lt;Product&gt;): Observable&lt;Int&gt; {\n    return Observable.create&lt;Int&gt; {\n        var totalNumberOfRow = products.size\n\n        while (totalNumberOfRow-- &gt; 0){\n            it.onNext(products.size - totalNumberOfRow)\n            Thread.sleep(100)\n        }\n        it.onCompleted()\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>The code is just a test code of two process. The first process gets a list of <code>Product</code> from the web, then those products are persist into the a local database within the app. This is the main idea. </p>\n\n<p>The method <code>getProducts</code> do the work of getting the data, in this case I just create an ArrayList of 100 products. The <code>saveRows</code> do the persist work. </p>\n\n<p>The <code>saveRows</code> methods emit juts an <code>Int</code> that represent the saved row. I am doing this because in the UI I have a progressbar reporting the progress.</p>\n\n<p>From an other point of the app I call the method <code>startUpdate</code> and after a few items emitted I get the describe exception </p>\n\n<pre><code>at com.techbyflorin.rockapan.helpers.UpdateHelper$saveRows$1.call(UpdateHelper.kt:46)\n\nat com.techbyflorin.rockapan.helpers.UpdateHelper$saveRows$1.call(UpdateHelper.kt:40)\n</code></pre>\n\n<p>I understand why this exception should be happening <code>https://github.com/ReactiveX/RxJava/wiki/Backpressure</code> but I do not know what I am doing wrong or how to solve it.</p>\n\n<p>Can anybody advice me about this.</p>\n"}]