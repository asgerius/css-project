[{"tags": ["kotlin", "rx-kotlin"], "answers": [{"tags": [], "owner": {"reputation": 69512, "user_id": 697630, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/40769e88c0dc93d387a9e368c332fdf9?s=128&d=identicon&r=PG", "display_name": "Edwin Dalorzo", "link": "https://stackoverflow.com/users/697630/edwin-dalorzo"}, "is_accepted": true, "score": 3, "last_activity_date": 1485985245, "creation_date": 1485985245, "answer_id": 41990290, "question_id": 41987704, "link": "https://stackoverflow.com/questions/41987704/rxkotlin-single-just-does-not-emit-when-subscribing-testsubscriber/41990290#41990290", "title": "RxKotlin - Single.just() does not emit when subscribing TestSubscriber", "body": "<p>I think your invocation of <code>subscribe</code> is incorrect.</p>\n\n<p>It seems you meant </p>\n\n<pre><code>Single.just(true)\n    .subscribeOn(Schedulers.immediate())\n    .subscribe(testSubscriber)\n</code></pre>\n\n<p>Which would invoke the <code>subscribe(Subscriber&lt;? super T&gt; subscriber)</code>.</p>\n\n<p>Your code is invoking <code>subscribe(final Action1&lt;? super T&gt; onSuccess)</code>, which would explain what you see.</p>\n"}], "owner": {"reputation": 704, "user_id": 2192545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/mYRd5.png?s=128&g=1", "display_name": "Zackline", "link": "https://stackoverflow.com/users/2192545/zackline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 0, "accepted_answer_id": 41990290, "answer_count": 1, "score": 1, "last_activity_date": 1485985245, "creation_date": 1485976136, "question_id": 41987704, "link": "https://stackoverflow.com/questions/41987704/rxkotlin-single-just-does-not-emit-when-subscribing-testsubscriber", "title": "RxKotlin - Single.just() does not emit when subscribing TestSubscriber", "body": "<p>I thought this is how it works, seems like I'm missing something..</p>\n\n<pre><code>@Test\nfun singleCompletes()\n{\n    val testSubscriber = TestSubscriber&lt;Boolean&gt;()\n\n    Single.just(true)\n            .subscribeOn(Schedulers.immediate())\n            .subscribe { testSubscriber }\n\n    testSubscriber.assertNoErrors()\n    testSubscriber.assertValue(true)\n}\n</code></pre>\n\n<blockquote>\n  <p>java.lang.AssertionError: Number of items does not match. Provided: 1  Actual: 0.</p>\n</blockquote>\n"}, {"tags": ["java", "intellij-idea", "annotations", "kotlin", "ebean"], "answers": [{"tags": [], "owner": {"reputation": 3677, "user_id": 1128668, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/35ca82b58da21315ee1650c8f4158adf?s=128&d=identicon&r=PG", "display_name": "GlenPeterson", "link": "https://stackoverflow.com/users/1128668/glenpeterson"}, "is_accepted": false, "score": 0, "last_activity_date": 1485982610, "creation_date": 1485982610, "answer_id": 41989617, "question_id": 41986278, "link": "https://stackoverflow.com/questions/41986278/how-to-use-dbenumvalue-with-ebean-in-kotlin/41989617#41989617", "title": "How to use @DbEnumValue with Ebean in Kotlin?", "body": "<p>I think the cleanest solution is to use <code>@EnumValue</code> instead of @DbEnumValue:</p>\n\n<pre><code>enum class Status {\n    @EnumValue(\"N\") NEW,\n    @EnumValue(\"A\") ACTIVE,\n    @EnumValue(\"I\") INACTIVE\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3810, "user_id": 12323248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ampOo.jpg?s=128&g=1", "display_name": "akuzminykh", "link": "https://stackoverflow.com/users/12323248/akuzminykh"}, "edited": false, "score": 3, "creation_date": 1583052060, "post_id": 60473196, "comment_id": 106981627, "body": "You should add some explanation. Just pasting code is not a good way to help other people."}, {"owner": {"reputation": 3677, "user_id": 1128668, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/35ca82b58da21315ee1650c8f4158adf?s=128&d=identicon&r=PG", "display_name": "GlenPeterson", "link": "https://stackoverflow.com/users/1128668/glenpeterson"}, "edited": false, "score": 0, "creation_date": 1583164235, "post_id": 60473196, "comment_id": 107014698, "body": "Aah, you added <code>get:</code> - makes sense.  I&#39;ll have to try it."}, {"owner": {"reputation": 1, "user_id": 7212717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kUXzX.jpg?s=128&g=1", "display_name": "tenko", "link": "https://stackoverflow.com/users/7212717/tenko"}, "reply_to_user": {"reputation": 3810, "user_id": 12323248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ampOo.jpg?s=128&g=1", "display_name": "akuzminykh", "link": "https://stackoverflow.com/users/12323248/akuzminykh"}, "edited": false, "score": 1, "creation_date": 1583244866, "post_id": 60473196, "comment_id": 107045500, "body": "@akuzminykh ok,I well change it"}], "tags": [], "owner": {"reputation": 1, "user_id": 7212717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kUXzX.jpg?s=128&g=1", "display_name": "tenko", "link": "https://stackoverflow.com/users/7212717/tenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1583244950, "last_edit_date": 1583244950, "creation_date": 1583050347, "answer_id": 60473196, "question_id": 41986278, "link": "https://stackoverflow.com/questions/41986278/how-to-use-dbenumvalue-with-ebean-in-kotlin/60473196#60473196", "title": "How to use @DbEnumValue with Ebean in Kotlin?", "body": "<p>I think the second way is the  cleanlst, just a bit of syntax error</p>\n\n<pre><code>enum class Status(@get:DbEnumValue val value: String) {\n    NEW(\"N\"),\n    ACTIVE(\"A\"),\n    INACTIVE(\"I\")\n}\n</code></pre>\n\n<p>kotlin docs link:<a href=\"https://kotlinlang.org/docs/reference/annotations.html#annotation-use-site-targets\" rel=\"nofollow noreferrer\">Annotation Use-site Targets</a></p>\n"}], "owner": {"reputation": 3677, "user_id": 1128668, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/35ca82b58da21315ee1650c8f4158adf?s=128&d=identicon&r=PG", "display_name": "GlenPeterson", "link": "https://stackoverflow.com/users/1128668/glenpeterson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 366, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1583244950, "creation_date": 1485971119, "question_id": 41986278, "link": "https://stackoverflow.com/questions/41986278/how-to-use-dbenumvalue-with-ebean-in-kotlin", "title": "How to use @DbEnumValue with Ebean in Kotlin?", "body": "<h1>Background</h1>\n\n<p>I'm trying to convert this Ebean example from Java into Kotlin:\n<a href=\"http://ebean-orm.github.io/docs/mapping/extension/dbenumvalue\" rel=\"nofollow noreferrer\">http://ebean-orm.github.io/docs/mapping/extension/dbenumvalue</a></p>\n\n<p>Here's the sample Java code:</p>\n\n<pre><code>public enum Status {\n\n  NEW(\"N\"),\n  ACTIVE(\"A\"),\n  INACTIVE(\"I\");\n\n  String dbValue;\n  Status(String dbValue) {\n    this.dbValue = dbValue;\n  }\n\n  // annotate a method that returns the value\n  // in the DB that the enum element maps to\n\n  @DbEnumValue\n  public String getValue() {\n    return dbValue;\n  }\n}\n</code></pre>\n\n<h1>Kotlin</h1>\n\n<p>I expected the following in Kotlin:</p>\n\n<pre><code>// ERROR: This annotation is not available to target 'value parameter'\nenum class Status(@DbEnumValue(storage = DbEnumType.VARCHAR) value: String) {\n    NEW(\"N\"),\n    ACTIVE(\"A\"),\n    INACTIVE(\"I\")\n}\n</code></pre>\n\n<p>Or maybe:</p>\n\n<pre><code>// ERROR: Expecting , or ) after \"value:String\"\nenum class Status(val value:String\n                      @DbEnumValue(storage = DbEnumType.VARCHAR)\n                      get() = value) {\n    NEW(\"N\"),\n    ACTIVE(\"A\"),\n    INACTIVE(\"I\")\n}\n</code></pre>\n\n<p>The following makes sense to me and actually compiles, but the combination of the <code>dbValue</code> parameter for the constructor with a separate <code>value</code> field with getter for the annotation feels wasteful somehow.</p>\n\n<pre><code>enum class Status (val dbValue:String) {\n    NEW(\"N\"),\n    ACTIVE(\"A\"),\n    INACTIVE(\"I\");\n\n    val value: String\n        @DbEnumValue(storage = DbEnumType.VARCHAR)\n        get() = dbValue\n}\n</code></pre>\n\n<p>When I let IntelliJ convert the Java to Kotlin, it does this:</p>\n\n<pre><code>enum class Status private constructor(dbValue: String) {\n    NEW(\"N\"),\n    ACTIVE(\"A\"),\n    INACTIVE(\"I\");\n\n   var value: String internal set\n\n    init {\n        @DbEnumValue(storage = DbEnumType.VARCHAR)\n        this.value = dbValue\n    }\n}\n</code></pre>\n\n<p>I added the annotation to what IntelliJ produced, but it took me several guesses to figure out where to put it.</p>\n\n<h1>Questions</h1>\n\n<ul>\n<li>Why <code>private constructor</code>?</li>\n<li>Why <code>var value</code> without a get()?</li>\n<li>What is <code>internal set</code>?</li>\n<li>Why <code>init</code>?</li>\n<li>Why the extra <code>dbValue</code> variable? (I think to pass the value from the constructor to the public annotated get method).</li>\n<li>Is that even right?</li>\n<li>What is the idiomatic way to do this?</li>\n</ul>\n\n<p>Any explanation, correction, or improvement would be appreciated.  If you think this belongs on codeReview, I'm OK with you moving it.</p>\n"}, {"tags": ["syntax", "kotlin"], "comments": [{"owner": {"reputation": 14274, "user_id": 2621917, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2ecd16dbe555b9596651e94668f71466?s=128&d=identicon&r=PG", "display_name": "Michael Piefel", "link": "https://stackoverflow.com/users/2621917/michael-piefel"}, "edited": false, "score": 0, "creation_date": 1485953047, "post_id": 41979945, "comment_id": 71137772, "body": "The real answer, unfortunately, is \u2018no\u2019."}], "answers": [{"comments": [{"owner": {"reputation": 14274, "user_id": 2621917, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2ecd16dbe555b9596651e94668f71466?s=128&d=identicon&r=PG", "display_name": "Michael Piefel", "link": "https://stackoverflow.com/users/2621917/michael-piefel"}, "edited": false, "score": 0, "creation_date": 1485952939, "post_id": 41980066, "comment_id": 71137719, "body": "Which, in this case, will turn the OP\u2019s expression into a block, thus requiring extra braces and lines."}, {"owner": {"reputation": 1870, "user_id": 4837112, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/da93bd05b13630b7642656d7dd34918f?s=128&d=identicon&r=PG&f=1", "display_name": "danielspaniol", "link": "https://stackoverflow.com/users/4837112/danielspaniol"}, "edited": false, "score": 0, "creation_date": 1485953113, "post_id": 41980066, "comment_id": 71137814, "body": "Accessing it via <code>it</code> was my first idea too... but sadly it is not possible (would be cool if it was possible). And as Michael already mentioned your solution converts my expression into a block."}, {"owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "reply_to_user": {"reputation": 14274, "user_id": 2621917, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2ecd16dbe555b9596651e94668f71466?s=128&d=identicon&r=PG", "display_name": "Michael Piefel", "link": "https://stackoverflow.com/users/2621917/michael-piefel"}, "edited": false, "score": 0, "creation_date": 1485953117, "post_id": 41980066, "comment_id": 71137817, "body": "@MichaelPiefel Yes, that is why I said it would be nice if we could access it with <code>it</code>. This possibility has one purpose, which is that <code>e?.keyCode</code> would only be evaluated once. It may not make a difference in this case, but if it was a bigger expression, I would say this is the way to go."}, {"owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "reply_to_user": {"reputation": 1870, "user_id": 4837112, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/da93bd05b13630b7642656d7dd34918f?s=128&d=identicon&r=PG&f=1", "display_name": "danielspaniol", "link": "https://stackoverflow.com/users/4837112/danielspaniol"}, "edited": false, "score": 0, "creation_date": 1485953807, "post_id": 41980066, "comment_id": 71138243, "body": "@Exhauzt See my edit and see if you find that to be better."}, {"owner": {"reputation": 14274, "user_id": 2621917, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2ecd16dbe555b9596651e94668f71466?s=128&d=identicon&r=PG", "display_name": "Michael Piefel", "link": "https://stackoverflow.com/users/2621917/michael-piefel"}, "reply_to_user": {"reputation": 1870, "user_id": 4837112, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/da93bd05b13630b7642656d7dd34918f?s=128&d=identicon&r=PG&f=1", "display_name": "danielspaniol", "link": "https://stackoverflow.com/users/4837112/danielspaniol"}, "edited": false, "score": 0, "creation_date": 1485954317, "post_id": 41980066, "comment_id": 71138584, "body": "@Exhauzt I wonder what made this answer so much better than mine\u2026"}, {"owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "reply_to_user": {"reputation": 14274, "user_id": 2621917, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2ecd16dbe555b9596651e94668f71466?s=128&d=identicon&r=PG", "display_name": "Michael Piefel", "link": "https://stackoverflow.com/users/2621917/michael-piefel"}, "edited": false, "score": 0, "creation_date": 1485954488, "post_id": 41980066, "comment_id": 71138700, "body": "@MichaelPiefel I think we both came up with that approach at the same time. I saw your answer after I posted my edit. I gave you an upvote :)"}, {"owner": {"reputation": 1870, "user_id": 4837112, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/da93bd05b13630b7642656d7dd34918f?s=128&d=identicon&r=PG&f=1", "display_name": "danielspaniol", "link": "https://stackoverflow.com/users/4837112/danielspaniol"}, "reply_to_user": {"reputation": 14274, "user_id": 2621917, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2ecd16dbe555b9596651e94668f71466?s=128&d=identicon&r=PG", "display_name": "Michael Piefel", "link": "https://stackoverflow.com/users/2621917/michael-piefel"}, "edited": false, "score": 0, "creation_date": 1485956687, "post_id": 41980066, "comment_id": 71140283, "body": "@MichaelPiefel I just saw his answer first that&#39;s the only reason"}], "tags": [], "owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "is_accepted": true, "score": 21, "last_activity_date": 1534771920, "last_edit_date": 1534771920, "creation_date": 1485952757, "answer_id": 41980066, "question_id": 41979945, "link": "https://stackoverflow.com/questions/41979945/kotlin-accessing-parameter-of-when-statement/41980066#41980066", "title": "Kotlin: Accessing parameter of when-statement", "body": "<p>I had this problem myself a couple of days ago. I think it would have been nice to be able to access the value as <code>it</code> inside the <code>when</code>-expression.</p>\n\n<p>I solved it by assigning the expression to a <code>val</code> before the <code>when</code> expression:</p>\n\n<pre><code>val keyCode = e?.keyCode\nwhen(keyCode) {\n    KeyEvent.VK_T -&gt; mainWindow.enterTrainingState()\n    KeyEvent.VK_P -&gt; mainWindow.enterPlayState()\n    KeyEvent.VK_E -&gt; mainWindow.close()\n    else -&gt; println(keyCode)\n}\n</code></pre>\n\n<p>Unfortunately, this would require you to add extra braces and lines. The upside though, is that <code>e?.keyCode</code> would only be evaluated once. It may not matter in this exact case, but if the expression was bigger, this approach would be suitable.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Another possibility it to wrap the <code>when</code> expression in a call to <code>let</code>. It lets you access the parameter with <code>it</code>. Like this:</p>\n\n<pre><code>e?.keyCode.let {\n    when(it) {\n        KeyEvent.VK_T -&gt; mainWindow.enterTrainingState()\n        KeyEvent.VK_P -&gt; mainWindow.enterPlayState()\n        KeyEvent.VK_E -&gt; mainWindow.close()\n        else -&gt; println(it)\n  }\n}\n</code></pre>\n\n<p><strong>Edit2:</strong></p>\n\n<p>Kotlin 1.3 has support for capturing the subject expression of a <code>when</code> in a variable. This is the syntax:</p>\n\n<pre><code>when(val keyCode = e?.keyCode) {\n    KeyEvent.VK_T -&gt; mainWindow.enterTrainingState()\n    KeyEvent.VK_P -&gt; mainWindow.enterPlayState()\n    KeyEvent.VK_E -&gt; mainWindow.close()\n    else -&gt; println(keyCode)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "is_accepted": false, "score": 5, "last_activity_date": 1485953220, "creation_date": 1485953220, "answer_id": 41980228, "question_id": 41979945, "link": "https://stackoverflow.com/questions/41979945/kotlin-accessing-parameter-of-when-statement/41980228#41980228", "title": "Kotlin: Accessing parameter of when-statement", "body": "<p>It's not possible as of Kotlin 1.1. There is an open feature request for this functionality: <a href=\"https://youtrack.jetbrains.com/issue/KT-4895\" rel=\"noreferrer\">https://youtrack.jetbrains.com/issue/KT-4895</a></p>\n"}, {"tags": [], "owner": {"reputation": 14274, "user_id": 2621917, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2ecd16dbe555b9596651e94668f71466?s=128&d=identicon&r=PG", "display_name": "Michael Piefel", "link": "https://stackoverflow.com/users/2621917/michael-piefel"}, "is_accepted": false, "score": 4, "last_activity_date": 1485953541, "creation_date": 1485953541, "answer_id": 41980320, "question_id": 41979945, "link": "https://stackoverflow.com/questions/41979945/kotlin-accessing-parameter-of-when-statement/41980320#41980320", "title": "Kotlin: Accessing parameter of when-statement", "body": "<p>You may try the following, even if it changes the semantics slightly. In your case it may well be OK, I guess.</p>\n\n<pre><code>_content.addKeyListener(object : KeyAdapter() {\n    override fun keyPressed(e: KeyEvent?) = e?.keyCode.let {\n        when(it) {\n            KeyEvent.VK_T -&gt; mainWindow.enterTrainingState()\n            KeyEvent.VK_P -&gt; mainWindow.enterPlayState()\n            KeyEvent.VK_E -&gt; mainWindow.close()\n            else -&gt; println(it)\n        }\n    }\n})\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1123, "user_id": 1051164, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5a75b7890e3a44464213afd09893bc31?s=128&d=identicon&r=PG", "display_name": "Huy T", "link": "https://stackoverflow.com/users/1051164/huy-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1566504677, "creation_date": 1566504677, "answer_id": 57616459, "question_id": 41979945, "link": "https://stackoverflow.com/questions/41979945/kotlin-accessing-parameter-of-when-statement/57616459#57616459", "title": "Kotlin: Accessing parameter of when-statement", "body": "<p>With Kotlin 1.3, you can set the parameter as a scoped variable and access it.</p>\n\n<pre><code>_content.addKeyListener(object : KeyAdapter() {\n    override fun keyPressed(e: KeyEvent?) = when(val keycode = e?.keyCode) {\n        KeyEvent.VK_T -&gt; mainWindow.enterTrainingState()\n        KeyEvent.VK_P -&gt; mainWindow.enterPlayState()\n        KeyEvent.VK_E -&gt; mainWindow.close()\n        else -&gt; println(keycode)\n    }\n})\n</code></pre>\n"}], "owner": {"reputation": 1870, "user_id": 4837112, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/da93bd05b13630b7642656d7dd34918f?s=128&d=identicon&r=PG&f=1", "display_name": "danielspaniol", "link": "https://stackoverflow.com/users/4837112/danielspaniol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2041, "favorite_count": 0, "accepted_answer_id": 41980066, "answer_count": 4, "score": 12, "last_activity_date": 1566504677, "creation_date": 1485952410, "question_id": 41979945, "link": "https://stackoverflow.com/questions/41979945/kotlin-accessing-parameter-of-when-statement", "title": "Kotlin: Accessing parameter of when-statement", "body": "<p>Is there a way to get the value of the expression I passed into the <code>when</code> statement?</p>\n\n<p>In my application I have a <code>KeyListener</code> like that</p>\n\n<pre><code>_content.addKeyListener(object : KeyAdapter() {\n    override fun keyPressed(e: KeyEvent?) = when(e?.keyCode) {\n        KeyEvent.VK_T -&gt; mainWindow.enterTrainingState()\n        KeyEvent.VK_P -&gt; mainWindow.enterPlayState()\n        KeyEvent.VK_E -&gt; mainWindow.close()\n        else -&gt; println(e?.keyCode)\n    }\n})\n</code></pre>\n\n<p>Has Kotlin a neat syntax to access <code>e?.keyCode</code>? I don't really want to repeat the expression.</p>\n"}, {"tags": ["android", "kotlin", "kotlin-allopen"], "comments": [{"owner": {"reputation": 3668, "user_id": 2392960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a549fcc9b00c4ce0ede36ede98548729?s=128&d=identicon&r=PG", "display_name": "Januson", "link": "https://stackoverflow.com/users/2392960/januson"}, "edited": false, "score": 2, "creation_date": 1485949890, "post_id": 41977735, "comment_id": 71135699, "body": "What is the problem? Have you encountered some error or are you just asking if it can be done?"}, {"owner": {"reputation": 707, "user_id": 263423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/575ce5192b49886a361a1e75d0e46759?s=128&d=identicon&r=PG", "display_name": "Aleksei Potapkin", "link": "https://stackoverflow.com/users/263423/aleksei-potapkin"}, "reply_to_user": {"reputation": 3668, "user_id": 2392960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a549fcc9b00c4ce0ede36ede98548729?s=128&d=identicon&r=PG", "display_name": "Januson", "link": "https://stackoverflow.com/users/2392960/januson"}, "edited": false, "score": 0, "creation_date": 1497009280, "post_id": 41977735, "comment_id": 75910479, "body": "It simply does not work"}], "answers": [{"comments": [{"owner": {"reputation": 707, "user_id": 263423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/575ce5192b49886a361a1e75d0e46759?s=128&d=identicon&r=PG", "display_name": "Aleksei Potapkin", "link": "https://stackoverflow.com/users/263423/aleksei-potapkin"}, "edited": false, "score": 0, "creation_date": 1497009422, "post_id": 44087363, "comment_id": 75910568, "body": "Sorry, but I&#39;ve not managed to do it. Looks like it isn&#39;t intended to work with Android gradle plugin, but it is not clearly stated anywhere in the docs. Or at least I haven&#39;t managed to find it."}, {"owner": {"reputation": 5469, "user_id": 7083401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eA15o.png?s=128&g=1", "display_name": "ice1000", "link": "https://stackoverflow.com/users/7083401/ice1000"}, "reply_to_user": {"reputation": 707, "user_id": 263423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/575ce5192b49886a361a1e75d0e46759?s=128&d=identicon&r=PG", "display_name": "Aleksei Potapkin", "link": "https://stackoverflow.com/users/263423/aleksei-potapkin"}, "edited": false, "score": 0, "creation_date": 1501253787, "post_id": 44087363, "comment_id": 77714656, "body": "It&#39;s OK, and currently the newest version is <code>1.1.3-2</code>. Maybe update again?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9017713"}, "edited": false, "score": 1, "creation_date": 1512015498, "post_id": 44087363, "comment_id": 82089498, "body": "BTW the newest now is <code>1.2.0</code> :D"}, {"owner": {"reputation": 241, "user_id": 3430360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d564f265ded2cecba90fc6945d9ec349?s=128&d=identicon&r=PG&f=1", "display_name": "user3430360", "link": "https://stackoverflow.com/users/3430360/user3430360"}, "edited": false, "score": 1, "creation_date": 1565011507, "post_id": 44087363, "comment_id": 101205990, "body": "I am getting the same issues.  Does not appear to be working.  I am using Kotlin version 1.3.41 and the same version of the plugin."}], "tags": [], "owner": {"reputation": 5469, "user_id": 7083401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eA15o.png?s=128&g=1", "display_name": "ice1000", "link": "https://stackoverflow.com/users/7083401/ice1000"}, "is_accepted": true, "score": 4, "last_activity_date": 1526118143, "last_edit_date": 1526118143, "creation_date": 1495292246, "answer_id": 44087363, "question_id": 41977735, "link": "https://stackoverflow.com/questions/41977735/kotlin-allopen-for-android/44087363#44087363", "title": "Kotlin-allopen for android", "body": "<p>Yes you can.\nBecause it's a compiler plugin, you'll get all-open code after compilation.\nSo it should work with tests.\nDon't worry.</p>\n\n<p>Edit: according to the comment area, updating the kotlin plugin version seems work. Currently the newest version is <code>1.2.41</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 12152, "user_id": 2136812, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/5gWlP.jpg?s=128&g=1", "display_name": "Lena Bru", "link": "https://stackoverflow.com/users/2136812/lena-bru"}, "edited": false, "score": 0, "creation_date": 1580640693, "post_id": 59387312, "comment_id": 106157106, "body": "@MrVasiliev, can you tell me why my plugin usage is not working please? <a href=\"https://stackoverflow.com/questions/60025359/how-to-enable-allopen-plugin-for-android\" title=\"how to enable allopen plugin for android\">stackoverflow.com/questions/60025359/&hellip;</a>"}, {"owner": {"reputation": 1303, "user_id": 3245772, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GjCCd.jpg?s=128&g=1", "display_name": "MrVasilev", "link": "https://stackoverflow.com/users/3245772/mrvasilev"}, "reply_to_user": {"reputation": 12152, "user_id": 2136812, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/5gWlP.jpg?s=128&g=1", "display_name": "Lena Bru", "link": "https://stackoverflow.com/users/2136812/lena-bru"}, "edited": false, "score": 0, "creation_date": 1591715333, "post_id": 59387312, "comment_id": 110157704, "body": "@LenaBru did you check the path to your OpenForTesting file in the build.gradle file -&gt; &quot;annotation(&#39;com.example.myproject.OpenForTesting&#39;)&quot; ?"}], "tags": [], "owner": {"reputation": 1303, "user_id": 3245772, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GjCCd.jpg?s=128&g=1", "display_name": "MrVasilev", "link": "https://stackoverflow.com/users/3245772/mrvasilev"}, "is_accepted": false, "score": 3, "last_activity_date": 1576654207, "creation_date": 1576654207, "answer_id": 59387312, "question_id": 41977735, "link": "https://stackoverflow.com/questions/41977735/kotlin-allopen-for-android/59387312#59387312", "title": "Kotlin-allopen for android", "body": "<p>First add the dependency in your build.gradle (project) file:</p>\n\n<pre><code>dependencies {\n        classpath \"org.jetbrains.kotlin:kotlin-allopen:$kotlin_version\"\n    }\n</code></pre>\n\n<p>After that apply the plugin in your build.gradle (app mobdule) file:</p>\n\n<pre><code>apply plugin: 'kotlin-allopen'\n</code></pre>\n\n<p>Then specify the list of annotations that will make classes open:</p>\n\n<pre><code>allOpen {\n    annotation('com.example.myproject.OpenForTesting')\n}\n</code></pre>\n\n<p>And use this annotation for every class which you want to be open</p>\n\n<pre><code>@OpenForTesting\n</code></pre>\n\n<p>Here is the Kotlin official documentation about All-open: <a href=\"https://kotlinlang.org/docs/reference/compiler-plugins.html\" rel=\"nofollow noreferrer\">https://kotlinlang.org/docs/reference/compiler-plugins.html</a></p>\n\n<p>Hope this help</p>\n"}], "owner": {"reputation": 707, "user_id": 263423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/575ce5192b49886a361a1e75d0e46759?s=128&d=identicon&r=PG", "display_name": "Aleksei Potapkin", "link": "https://stackoverflow.com/users/263423/aleksei-potapkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3983, "favorite_count": 1, "accepted_answer_id": 44087363, "answer_count": 2, "score": 6, "last_activity_date": 1576654207, "creation_date": 1485945889, "last_edit_date": 1497009484, "question_id": 41977735, "link": "https://stackoverflow.com/questions/41977735/kotlin-allopen-for-android", "title": "Kotlin-allopen for android", "body": "<p>Is it possible to use kotlin-allopen gradle plugin for android testing with mockito? </p>\n\n<p>I've tried to add kotlin-allopen plugin to my build.gradle and define the annotation. </p>\n\n<pre><code>buildscript {\n   ext.kotlin_version = '1.0.6'\n\n   dependencies {\n       classpath \"org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version\"\n       classpath \"org.jetbrains.kotlin:kotlin-allopen:$kotlin_version\"\n   }\n}\n\napply plugin: 'com.android.application'\napply plugin: 'kotlin-allopen'\napply plugin: 'kotlin-android'\n\nallOpen {\n    annotation(\"com.mycompany.OpenForTest\")\n}\n</code></pre>\n\n<p>And these for annotation itself</p>\n\n<pre><code>annotation class OpenForTest\n</code></pre>\n\n<p>It's not working for me. Maybe I miss something?</p>\n"}, {"tags": ["android", "google-play-services", "kotlin", "google-signin"], "comments": [{"owner": {"reputation": 15264, "user_id": 6143482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MD37S.jpg?s=128&g=1", "display_name": "noogui", "link": "https://stackoverflow.com/users/6143482/noogui"}, "edited": false, "score": 1, "creation_date": 1485968228, "post_id": 41975350, "comment_id": 71148424, "body": "Error seems to be the same with this <a href=\"http://stackoverflow.com/questions/29343922/googleapiclient-is-throwing-googleapiclient-is-not-connected-yet-after-onconne\">SO thread</a> and was resolved."}, {"owner": {"reputation": 130, "user_id": 3382883, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d28c8d86ca703391031cd63caf799b92?s=128&d=identicon&r=PG", "display_name": "wverdese", "link": "https://stackoverflow.com/users/3382883/wverdese"}, "reply_to_user": {"reputation": 15264, "user_id": 6143482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MD37S.jpg?s=128&g=1", "display_name": "noogui", "link": "https://stackoverflow.com/users/6143482/noogui"}, "edited": false, "score": 0, "creation_date": 1487156482, "post_id": 41975350, "comment_id": 71653207, "body": "@noogui Thanks! Moving the client creation in <code>onCreate()</code> sounds more a workaround than a solution but I guess there&#39;s nothing more I can do. As it&#39;s said in this thread there&#39;s no way to report this bug to Google..."}], "answers": [{"tags": [], "owner": {"reputation": 76, "user_id": 2481102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea0734b31312712ad96d05d745d32e6b?s=128&d=identicon&r=PG", "display_name": "user2481102", "link": "https://stackoverflow.com/users/2481102/user2481102"}, "is_accepted": true, "score": 1, "last_activity_date": 1489121704, "creation_date": 1489121704, "answer_id": 42710526, "question_id": 41975350, "link": "https://stackoverflow.com/questions/41975350/googleapiclient-cant-manually-connect-and-perform-signout-afterwards/42710526#42710526", "title": "GoogleApiClient: Can&#39;t manually connect and perform signOut afterwards", "body": "<p>We need create googleAPIClient in onCreate() and sign out it in same activity.</p>\n\n<p>Ex:\nIn onCreate()</p>\n\n<pre><code>    GoogleSignInOptions gso = new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN)\n            .requestIdToken(this.getString(R.string.default_web_client_id))\n            .requestEmail()\n            .requestProfile()\n            .build();\n\n\n    mGoogleApiClient = new GoogleApiClient.Builder(activity)\n            .enableAutoManage(activity, new GoogleApiClient.OnConnectionFailedListener() {\n                @Override\n                public void onConnectionFailed(@NonNull ConnectionResult connectionResult) {\n                }\n            })\n            .addConnectionCallbacks(new GoogleApiClient.ConnectionCallbacks() {\n                @Override\n                public void onConnected(@Nullable Bundle bundle) {\n                }\n\n                @Override\n                public void onConnectionSuspended(int i) {\n\n                }\n            })\n            .addApi(Auth.GOOGLE_SIGN_IN_API, gso)\n            .build();\n</code></pre>\n\n<p>And Sign out it :</p>\n\n<pre><code>    Auth.GoogleSignInApi.signOut(mGoogleApiClient).setResultCallback(\n            new ResultCallback&lt;Status&gt;() {\n                @Override\n                public void onResult(@NonNull Status status) {\n\n                    if (mListener != null) {\n                        mListener.onSigout(\"\");\n                    }\n                }\n            });\n</code></pre>\n\n<p>If we create mGoogleAPIClient with ApplicationContext, we can't sign out Google Account properly.</p>\n"}], "owner": {"reputation": 130, "user_id": 3382883, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d28c8d86ca703391031cd63caf799b92?s=128&d=identicon&r=PG", "display_name": "wverdese", "link": "https://stackoverflow.com/users/3382883/wverdese"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 1, "accepted_answer_id": 42710526, "answer_count": 1, "score": 1, "last_activity_date": 1489121704, "creation_date": 1485938736, "question_id": 41975350, "link": "https://stackoverflow.com/questions/41975350/googleapiclient-cant-manually-connect-and-perform-signout-afterwards", "title": "GoogleApiClient: Can&#39;t manually connect and perform signOut afterwards", "body": "<p>I want to manually handle the <code>connect()</code> and <code>disconnect()</code> operation on the <code>GoogleApiClient</code>. I'm trying to:</p>\n\n<ul>\n<li>build a new <code>GoogleApiClient</code> (without <code>enableAutoManage</code>)</li>\n<li>call <code>connect()</code></li>\n<li>when <code>onConnected()</code> is called perform <code>signOut</code></li>\n<li>call <code>disconnect()</code> after <code>signOut</code> is over</li>\n</ul>\n\n<p>Here's an example:</p>\n\n<pre><code>fun signOut(googleApiClient: GoogleApiClient, resultCallback: (Status) -&gt; Unit) {\n    Auth.GoogleSignInApi.signOut(googleApiClient).setResultCallback(resultCallback)\n}\n\nfun test() {\n    val googleApiClient = GoogleApiClient.Builder(activity)\n        .addApi(Auth.GOOGLE_SIGN_IN_API, buildGoogleSignInOptions(googleAuthId))\n        .build()\n    googleApiClient.registerConnectionCallbacks(object : ConnectionCallbacks {\n        override fun onConnected(connectionHint: Bundle?) {\n            signOut { status -&gt;\n                //TODO something with status\n                googleApiClient.disconnect()\n            }\n        }\n\n        override fun onConnectionSuspended(cause: Int) {\n            //nop\n        }\n    })\n    googleApiClient.registerConnectionFailedListener {\n        //TODO handle failure\n    }\n    googleApiClient.connect()\n}\n</code></pre>\n\n<p>However when <code>onConnected()</code> is called the <code>signOut</code> call fails with </p>\n\n<pre><code>IllegalStateException: GoogleApiClient is not connected yet \n</code></pre>\n\n<p>Am I doing something wrong or is it a bug from the library?</p>\n"}, {"tags": ["error-handling", "kotlin", "apache-httpclient-4.x"], "answers": [{"tags": [], "owner": {"reputation": 3668, "user_id": 2392960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a549fcc9b00c4ce0ede36ede98548729?s=128&d=identicon&r=PG", "display_name": "Januson", "link": "https://stackoverflow.com/users/2392960/januson"}, "is_accepted": true, "score": 1, "last_activity_date": 1485953003, "last_edit_date": 1485953003, "creation_date": 1485951498, "answer_id": 41979651, "question_id": 41973656, "link": "https://stackoverflow.com/questions/41973656/how-to-handle-errors-properly-when-using-http-client-in-kotlin/41979651#41979651", "title": "How to handle errors properly when using HTTP client in Kotlin?", "body": "<p>You have multiple options for better maintenance of this method. These options are not necessarily Kotlin specific. More like <a href=\"https://refactoring.com/catalog/\" rel=\"nofollow noreferrer\">Refactoring</a> and <a href=\"https://en.wikipedia.org/wiki/SOLID_(object-oriented_design)\" rel=\"nofollow noreferrer\">Object design</a>. The one most obvious would be to split it into multiple methods. Since your method handles multiple different concerns you can split it into more focused pieces. Then thoroughly <strong>test</strong>, <strong>errorproof</strong> and <strong>log</strong> their behaviour.</p>\n\n<p>For example:</p>\n\n<ul>\n<li>First part handles the HTTP GET request. Extract this to a method returning GET response and check for <a href=\"https://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/impl/client/CloseableHttpClient.html#execute(org.apache.http.client.methods.HttpUriRequest)\" rel=\"nofollow noreferrer\">connection exceptions</a>.</li>\n<li>Middle part could be extracted as a validation of GET response to make sure you got a valid data to work on.</li>\n<li>Last part is again separate concern of parsing JSON from GET response. Place for handling of parser exceptions.</li>\n</ul>\n"}], "owner": {"reputation": 13167, "user_id": 399457, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6a6ed435a024926ffb41d1ad84b3b1f5?s=128&d=identicon&r=PG", "display_name": "Mentiflectax", "link": "https://stackoverflow.com/users/399457/mentiflectax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1287, "favorite_count": 0, "accepted_answer_id": 41979651, "answer_count": 1, "score": 0, "last_activity_date": 1485953003, "creation_date": 1485932049, "last_edit_date": 1485932452, "question_id": 41973656, "link": "https://stackoverflow.com/questions/41973656/how-to-handle-errors-properly-when-using-http-client-in-kotlin", "title": "How to handle errors properly when using HTTP client in Kotlin?", "body": "<p>I have the following code, which contacts an external system (Capsule CRM) using Apache HTTP Client.</p>\n\n<pre><code>override fun findPartiesByUrlFragment(urlFragment: String): PartiesSearchResult {\n    val req = HttpGet(\"https://api.capsulecrm.com/api/v2/parties/search?q=${urlFragment}\")\n\n    req.setHeader(\"Authorization\", \"Bearer ${ApiToken}\")\n    req.setHeader(\"Accept\", \"application/json\");\n\n    val httpClient = HttpClients.createDefault()\n    val res = httpClient.execute(req)\n\n    val parser = Parser()\n    val json:JsonObject = parser.parse(res.entity.content) as JsonObject\n\n    [...] // What happens thereafter isn't relevant because most errors are likely to occur in the code above\n\n    return PartiesSearchResult(false, \"\", emptyList())\n}\n</code></pre>\n\n<p>This piece of code must work in an application that runs 24/7, therefore I need to do right error processing and make sure that the entire application doesn't crash, if an expected problem (e. g. Capsule's server is down) occurs. <code>false</code> in <code>PartiesSearchResult(false, \"\", emptyList())</code> means that the operation failed.</p>\n\n<p>I can chesk the HTTP response code and parse the response only, if it's 200.</p>\n\n<p>But I'm confused because I don't see any declared exceptions here (as opposed to Java).</p>\n\n<p>Now I want to do this:</p>\n\n<pre><code>override fun findPartiesByUrlFragment(urlFragment: String): PartiesSearchResult {\n    var httpClient = null\n    var res = null\n    try {\n        val req = HttpGet(\"https://api.capsulecrm.com/api/v2/parties/search?q=${urlFragment}\")\n\n        req.setHeader(\"Authorization\", \"Bearer ${ApiToken}\")\n        req.setHeader(\"Accept\", \"application/json\");\n\n        httpClient = HttpClients.createDefault()\n        res = httpClient.execute(req)\n\n        if (res == null) {\n            return PartiesSearchResult(false, \"null response\", emptyList())\n        }\n\n        if (res.entity == null) {\n            return PartiesSearchResult(false, \"null entity\", emptyList())\n        }\n\n        val content = res.entity.content\n        if (content == null) {\n            return PartiesSearchResult(false, \"null content\", emptyList())\n        }\n\n        if (responseCode(res) == 200) {\n            val parser = Parser()\n            val json:JsonObject = parser.parse(content) as JsonObject\n\n            [...] // Convert JSON to my own objects\n\n            return PartiesSearchResult(true, \"\", emptyList())\n        }\n        return PartiesSearchResult(false, \"Invalid HTTP response code\", emptyList())\n    }\n    catch (Throwable t) {\n        return PartiesSearchResult(false, toString(t), emptyList())\n    }\n    finally {\n        closeIfNotNull(res)\n        closeIfNotNull(httpClient)\n    }\n\n    return PartiesSearchResult(false, \"\", emptyList())\n}\n</code></pre>\n\n<p>Is there a better way to do error handling in Kotlin (for the particular task of fetching data from another system using HTTP client), if my system must not fail because of expected problem situations (foreign server down, foreign server overloaded or having internal errors, temporary loss of internet connection etc.) ?</p>\n"}, {"tags": ["kotlin"], "comments": [{"owner": {"reputation": 8155, "user_id": 1431244, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/21b31222e990b631fee5484a7115a991?s=128&d=identicon&r=PG", "display_name": "Oliver Dain", "link": "https://stackoverflow.com/users/1431244/oliver-dain"}, "edited": false, "score": 0, "creation_date": 1485893165, "post_id": 41966530, "comment_id": 71111771, "body": "Btw, I do know I can do something like <code>var allData: List&lt;ResponseData&gt;? = null</code> in my declaration and then change the <code>useAllData</code> call to <code>useAllData(allData!!)</code>. That works but doesn&#39;t really meet my definition of &quot;elegant&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "is_accepted": true, "score": 2, "last_activity_date": 1485895479, "creation_date": 1485895479, "answer_id": 41967152, "question_id": 41966530, "link": "https://stackoverflow.com/questions/41966530/how-to-initialize-a-var-in-a-lambda/41967152#41967152", "title": "How to initialize a var in a lambda", "body": "<p>Kotlin's <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.io/use.html\" rel=\"nofollow noreferrer\"><code>use</code></a> returns the result which you can assign directly to a variable to avoid this type of issue. e.g.:</p>\n\n<pre><code>var allData: List&lt;ResponseData&gt; = FileInputStream(dataPath).use { input -&gt;\n    // allData is initialized here\n    ResponseData.parse(input)\n}\n\n// Kotlin can now tell that allData was initialized\nuseAllData(allData)\n</code></pre>\n"}], "owner": {"reputation": 8155, "user_id": 1431244, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/21b31222e990b631fee5484a7115a991?s=128&d=identicon&r=PG", "display_name": "Oliver Dain", "link": "https://stackoverflow.com/users/1431244/oliver-dain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 1, "accepted_answer_id": 41967152, "answer_count": 1, "score": 1, "last_activity_date": 1485895479, "creation_date": 1485893099, "question_id": 41966530, "link": "https://stackoverflow.com/questions/41966530/how-to-initialize-a-var-in-a-lambda", "title": "How to initialize a var in a lambda", "body": "<p>I keep bumping into situations like this:</p>\n\n<pre><code>    var allData: List&lt;ResponseData&gt;\n\n    FileInputStream(dataPath).use { input -&gt;\n        // allData is initialized here\n        allData = ResponseData.parse(input)\n    }\n\n    // Kotlin can't tell that allData was initialized\n    useAllData(allData)\n</code></pre>\n\n<p>The issue is, I think, that Kotlin has no idea when the lambda passed to <code>use</code> will be called so it can't know if the variable was initialized by the time you get to <code>useAllData</code>. I suspect this is just a limitation without a good workaround, but am hoping somebody has an elegant way to initialize things in these kinds of blocks (e.g. <code>use</code>, <code>with</code>, etc.)</p>\n"}, {"tags": ["kotlin"], "comments": [{"owner": {"reputation": 8155, "user_id": 1431244, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/21b31222e990b631fee5484a7115a991?s=128&d=identicon&r=PG", "display_name": "Oliver Dain", "link": "https://stackoverflow.com/users/1431244/oliver-dain"}, "edited": false, "score": 2, "creation_date": 1485886550, "post_id": 41964644, "comment_id": 71108205, "body": "how about just putting the &quot;common logic&quot; stuff in an <code>else</code> block?"}, {"owner": {"reputation": 3822, "user_id": 4725496, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/BYQOo.jpg?s=128&g=1", "display_name": "Feeco", "link": "https://stackoverflow.com/users/4725496/feeco"}, "reply_to_user": {"reputation": 8155, "user_id": 1431244, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/21b31222e990b631fee5484a7115a991?s=128&d=identicon&r=PG", "display_name": "Oliver Dain", "link": "https://stackoverflow.com/users/1431244/oliver-dain"}, "edited": false, "score": 1, "creation_date": 1485886901, "post_id": 41964644, "comment_id": 71108389, "body": "@OliverDain, good idea! But is it replacement for all cases where <code>break</code> may need?"}, {"owner": {"reputation": 8155, "user_id": 1431244, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/21b31222e990b631fee5484a7115a991?s=128&d=identicon&r=PG", "display_name": "Oliver Dain", "link": "https://stackoverflow.com/users/1431244/oliver-dain"}, "edited": false, "score": 0, "creation_date": 1485889431, "post_id": 41964644, "comment_id": 71109829, "body": "I think I agree that break functionality would be nice (though you could always do the if/else thing). Just suggesting a workaround until such time as the Kotlin team decided to implement (or not)."}, {"owner": {"reputation": 3462, "user_id": 2094298, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/26a93895eedcc45a0ebc3bb0da2cfbe6?s=128&d=identicon&r=PG", "display_name": "Ruckus T-Boom", "link": "https://stackoverflow.com/users/2094298/ruckus-t-boom"}, "edited": false, "score": 0, "creation_date": 1485889576, "post_id": 41964644, "comment_id": 71109899, "body": "Did you try doing what it suggested and adding labels to break to?"}, {"owner": {"reputation": 3822, "user_id": 4725496, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/BYQOo.jpg?s=128&g=1", "display_name": "Feeco", "link": "https://stackoverflow.com/users/4725496/feeco"}, "reply_to_user": {"reputation": 3462, "user_id": 2094298, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/26a93895eedcc45a0ebc3bb0da2cfbe6?s=128&d=identicon&r=PG", "display_name": "Ruckus T-Boom", "link": "https://stackoverflow.com/users/2094298/ruckus-t-boom"}, "edited": false, "score": 1, "creation_date": 1485894197, "post_id": 41964644, "comment_id": 71112305, "body": "@RuckusT-Boom, yes, I did. It is not allowed to label <code>when</code>."}, {"owner": {"reputation": 8022, "user_id": 1068649, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5e44a15ecb4ee475548612da03c81f33?s=128&d=identicon&r=PG", "display_name": "James Bassett", "link": "https://stackoverflow.com/users/1068649/james-bassett"}, "reply_to_user": {"reputation": 8155, "user_id": 1431244, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/21b31222e990b631fee5484a7115a991?s=128&d=identicon&r=PG", "display_name": "Oliver Dain", "link": "https://stackoverflow.com/users/1431244/oliver-dain"}, "edited": false, "score": 0, "creation_date": 1485898201, "post_id": 41964644, "comment_id": 71114435, "body": "I think you need a better example - this one is begging for an <code>else</code> as @OliverDain suggested. I don&#39;t mind <code>break</code> in loops, but using it (or <code>return</code> with no value) to get out of  a when expression seems ugly."}], "answers": [{"comments": [{"owner": {"reputation": 3822, "user_id": 4725496, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/BYQOo.jpg?s=128&g=1", "display_name": "Feeco", "link": "https://stackoverflow.com/users/4725496/feeco"}, "edited": false, "score": 0, "creation_date": 1485894297, "post_id": 41965672, "comment_id": 71112368, "body": "Good workaround, but I cannot accept it as the answer because it may be some code after <code>when</code>."}, {"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "reply_to_user": {"reputation": 3822, "user_id": 4725496, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/BYQOo.jpg?s=128&g=1", "display_name": "Feeco", "link": "https://stackoverflow.com/users/4725496/feeco"}, "edited": false, "score": 0, "creation_date": 1485894998, "post_id": 41965672, "comment_id": 71112734, "body": "@Feeco. Thank you. I think I slightly misunderstood your question. I&#39;ll post another answer."}], "tags": [], "owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "is_accepted": false, "score": 13, "last_activity_date": 1485890032, "creation_date": 1485890032, "answer_id": 41965672, "question_id": 41964644, "link": "https://stackoverflow.com/questions/41964644/break-or-return-from-when-expressions/41965672#41965672", "title": "break or return from when expressions", "body": "<p>You can use labels to break/continue/return. e.g.:</p>\n\n<pre><code>transactions@ for (transaction in transactions) {\n    when (transaction.state) {\n        Transaction.Type.EXPIRED,\n        Transaction.Type.BLOCKED -&gt; {\n            break@transactions\n        }\n    }\n}\n</code></pre>\n\n<p>See <a href=\"https://kotlinlang.org/docs/reference/returns.html\" rel=\"noreferrer\">Returns and Jumps - Kotlin Programming Language</a> for more details.</p>\n"}, {"tags": [], "owner": {"reputation": 1924, "user_id": 5334308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9c6e2dcd4ece150a876b3dc8d3a1f49?s=128&d=identicon&r=PG", "display_name": "Vyacheslav Lukianov", "link": "https://stackoverflow.com/users/5334308/vyacheslav-lukianov"}, "is_accepted": false, "score": 3, "last_activity_date": 1485890540, "creation_date": 1485890540, "answer_id": 41965818, "question_id": 41964644, "link": "https://stackoverflow.com/questions/41964644/break-or-return-from-when-expressions/41965818#41965818", "title": "break or return from when expressions", "body": "<p>Work around using <code>apply()</code>:</p>\n\n<pre><code>transaction.apply {\n    when(state) {\n        Transaction.Type.EXPIRED,\n        //about 10 more types\n        Transaction.Type.BLOCKED -&gt; {\n            if (type == Transaction.Type.BLOCKED &amp;&amp; closeAnyway) {\n                close(this)\n                return@apply\n            }\n            //common logic\n        }\n        //other types\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "reply_to_user": {"reputation": 22949, "user_id": 6998684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqR2Z.jpg?s=128&g=1", "display_name": "IgorGanapolsky", "link": "https://stackoverflow.com/users/6998684/igorganapolsky"}, "edited": false, "score": 1, "creation_date": 1601059608, "post_id": 41967047, "comment_id": 113297308, "body": "that&#39;s odd @IgorGanapolsky, you may need ask a question on SO if you still have the issue when trying to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal, reproducible example</a>  it should work, here is a Kotlin Playground link to demonstrate <code>run</code> + <code>return@run</code>: <a href=\"https://pl.kotl.in/yBP4E8ycc\" rel=\"nofollow noreferrer\">pl.kotl.in/yBP4E8ycc</a>"}], "tags": [], "owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "is_accepted": true, "score": 32, "last_activity_date": 1485895072, "creation_date": 1485895072, "answer_id": 41967047, "question_id": 41964644, "link": "https://stackoverflow.com/questions/41964644/break-or-return-from-when-expressions/41967047#41967047", "title": "break or return from when expressions", "body": "<p>You can use <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/run.html\" rel=\"noreferrer\"><code>run</code></a> with a <a href=\"https://kotlinlang.org/docs/reference/returns.html#return-at-labels\" rel=\"noreferrer\">return at label</a>:</p>\n\n<pre><code>when(transaction.state) {\n    Transaction.Type.EXPIRED,\n    //about 10 more types\n    Transaction.Type.BLOCKED -&gt; run {\n        if (transaction.type == Transaction.Type.BLOCKED &amp;&amp; transaction.closeAnyway) {\n            close(transaction)\n            return@run //close if type is blocked and has 'closeAnyway' flag\n        }\n        //common logic\n    }\n    //other types\n}\n</code></pre>\n"}], "owner": {"reputation": 3822, "user_id": 4725496, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/BYQOo.jpg?s=128&g=1", "display_name": "Feeco", "link": "https://stackoverflow.com/users/4725496/feeco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11490, "favorite_count": 3, "accepted_answer_id": 41967047, "answer_count": 3, "score": 25, "last_activity_date": 1485895072, "creation_date": 1485886426, "question_id": 41964644, "link": "https://stackoverflow.com/questions/41964644/break-or-return-from-when-expressions", "title": "break or return from when expressions", "body": "<p>What I would like to do:</p>\n\n<pre><code>when(transaction.state) {\n    Transaction.Type.EXPIRED,\n    //about 10 more types\n    Transaction.Type.BLOCKED -&gt; {\n        if (transaction.type == Transaction.Type.BLOCKED &amp;&amp; transaction.closeAnyway) {\n            close(transaction)\n            break //close if type is blocked and has 'closeAnyway' flag\n        }\n        //common logic\n    }\n    //other types\n}\n</code></pre>\n\n<p>I cannot write <code>break</code>:</p>\n\n<blockquote>\n  <p>'break' and 'continue' are not allowed in 'when' statements. Consider using labels to continue/break from the outer loop.</p>\n</blockquote>\n\n<p>Is it a way to <code>return/break</code> from <code>when</code> statements? Or what is the best way to solve it?</p>\n"}, {"tags": ["android", "google-play-services", "kotlin", "google-signin"], "owner": {"reputation": 130, "user_id": 3382883, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d28c8d86ca703391031cd63caf799b92?s=128&d=identicon&r=PG", "display_name": "wverdese", "link": "https://stackoverflow.com/users/3382883/wverdese"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1485876928, "creation_date": 1485876928, "question_id": 41961446, "link": "https://stackoverflow.com/questions/41961446/listener-not-called-when-dialog-update-google-play-services-is-prompted", "title": "Listener not called when dialog &quot;update Google Play Services&quot; is prompted", "body": "<p>I'm using a <code>GoogleApiClient</code> built with <code>enableAutoManage</code>:</p>\n\n<pre><code>GoogleApiClient.Builder(activity)\n  .enableAutoManage(activity) { result -&gt;\n    if (!result.hasResolution()) {\n      GoogleApiAvailability.getInstance().showErrorDialogFragment(activity, result.errorCode, 0)\n    }\n    else {\n      try {\n        result.startResolutionForResult(activity, errorResolutionRequestCode)\n      } catch (e: SendIntentException) {\n        Log.e(TAG, \"Exception while starting resolution activity\", e)\n      }\n    }\n}\n.addApi(Auth.GOOGLE_SIGN_IN_API, buildGoogleSignInOptions(googleAuthId))\n.build()\n</code></pre>\n\n<p>How can I know if the <code>connect()</code> operation has failed because the Play Services weren't updated?\nThe <code>OnConnectionFailed</code> callback is called only when the user closes the Dialog (that is automatically prompted), but I need a callback in any case to perform some UI operation. Is there a way to achieve that?</p>\n"}, {"tags": ["gradle", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 9459, "user_id": 1432980, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e646027bcc545177a971230c1e23134a?s=128&d=identicon&r=PG", "display_name": "lapots", "link": "https://stackoverflow.com/users/1432980/lapots"}, "edited": false, "score": 0, "creation_date": 1485870613, "post_id": 41957709, "comment_id": 71097177, "body": "In that case it returns ` Could not find method srcLink() for arguments [build_7r01ofigr1pt144ypsds3y84p$_run_closure2_closure5_clos&zwnj;&#8203;ure7@718989fa]`"}, {"owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "reply_to_user": {"reputation": 9459, "user_id": 1432980, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e646027bcc545177a971230c1e23134a?s=128&d=identicon&r=PG", "display_name": "lapots", "link": "https://stackoverflow.com/users/1432980/lapots"}, "edited": false, "score": 0, "creation_date": 1485871062, "post_id": 41957709, "comment_id": 71097490, "body": "What do you mean &quot;returns&quot;? Is that a compile error or an exception thrown at runtime?"}, {"owner": {"reputation": 9459, "user_id": 1432980, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e646027bcc545177a971230c1e23134a?s=128&d=identicon&r=PG", "display_name": "lapots", "link": "https://stackoverflow.com/users/1432980/lapots"}, "edited": false, "score": 0, "creation_date": 1485871201, "post_id": 41957709, "comment_id": 71097593, "body": "in runtime. When I try to run some of tasks from my plugin"}, {"owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "reply_to_user": {"reputation": 9459, "user_id": 1432980, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e646027bcc545177a971230c1e23134a?s=128&d=identicon&r=PG", "display_name": "lapots", "link": "https://stackoverflow.com/users/1432980/lapots"}, "edited": false, "score": 0, "creation_date": 1485871382, "post_id": 41957709, "comment_id": 71097716, "body": "I missed this one when I wrote the answer, but the return type of the <code>closure</code> parameter passed to the <code>app</code> function, must be <code>Unit</code>, not <code>String</code>. Check the new signature in my edit."}, {"owner": {"reputation": 9459, "user_id": 1432980, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e646027bcc545177a971230c1e23134a?s=128&d=identicon&r=PG", "display_name": "lapots", "link": "https://stackoverflow.com/users/1432980/lapots"}, "edited": false, "score": 0, "creation_date": 1485871566, "post_id": 41957709, "comment_id": 71097842, "body": "Same error.  Still could not  find method <code>srcLink</code>. I thought It should properly delegate <code>srcLink</code> but it does not do that.<code>Could not find method srcLink() for arguments [build_7r01ofigr1pt144ypsds3y84p$_run_closure2_closure5_clos&zwnj;&#8203;ure7@2c9306d3]</code>"}, {"owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "reply_to_user": {"reputation": 9459, "user_id": 1432980, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e646027bcc545177a971230c1e23134a?s=128&d=identicon&r=PG", "display_name": "lapots", "link": "https://stackoverflow.com/users/1432980/lapots"}, "edited": false, "score": 0, "creation_date": 1485871617, "post_id": 41957709, "comment_id": 71097872, "body": "Then the problem has to be somewhere else. The code works for me now."}, {"owner": {"reputation": 9459, "user_id": 1432980, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e646027bcc545177a971230c1e23134a?s=128&d=identicon&r=PG", "display_name": "lapots", "link": "https://stackoverflow.com/users/1432980/lapots"}, "edited": false, "score": 0, "creation_date": 1485871667, "post_id": 41957709, "comment_id": 71097898, "body": "Hm, you created gradle plugin application?"}, {"owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "reply_to_user": {"reputation": 9459, "user_id": 1432980, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e646027bcc545177a971230c1e23134a?s=128&d=identicon&r=PG", "display_name": "lapots", "link": "https://stackoverflow.com/users/1432980/lapots"}, "edited": false, "score": 0, "creation_date": 1485871780, "post_id": 41957709, "comment_id": 71097974, "body": "No, but the contrived example you provided in the question works for me after the fix. What kind of type is <code>build_7r01ofigr1pt144ypsds3y84p$_run_closure2_closure5_clos\u200c&zwnj;&#8203;\u200bure7@2c9306d3</code>? Doesn&#39;t seem like a <code>() -&gt; String</code> to me."}, {"owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "reply_to_user": {"reputation": 9459, "user_id": 1432980, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e646027bcc545177a971230c1e23134a?s=128&d=identicon&r=PG", "display_name": "lapots", "link": "https://stackoverflow.com/users/1432980/lapots"}, "edited": false, "score": 0, "creation_date": 1485871872, "post_id": 41957709, "comment_id": 71098035, "body": "Could you try to add <code>inline</code> to the functions? That would make the lambda-parameters inlined as well."}, {"owner": {"reputation": 9459, "user_id": 1432980, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e646027bcc545177a971230c1e23134a?s=128&d=identicon&r=PG", "display_name": "lapots", "link": "https://stackoverflow.com/users/1432980/lapots"}, "edited": false, "score": 0, "creation_date": 1485871973, "post_id": 41957709, "comment_id": 71098112, "body": "Did not help. BTW you can try the project itself  <code>https:&#47;&#47;github.com&#47;lapots&#47;gradle-app-environment-plugin</code> because they might be something I overlooked"}], "tags": [], "owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "is_accepted": false, "score": 0, "last_activity_date": 1485871390, "last_edit_date": 1485871390, "creation_date": 1485865967, "answer_id": 41957709, "question_id": 41955552, "link": "https://stackoverflow.com/questions/41955552/delegate-nested-closure-invokation-to-corresponding-class/41957709#41957709", "title": "delegate nested closure invokation to corresponding class", "body": "<p>You never call the <code>closure</code> parameter in your <code>app</code> function. I think the signature of the <code>app</code> function is wrong though. It should be like this:</p>\n\n<pre><code>fun app(id: String, closure: ApplicationEnvironmentExtension.() -&gt; Unit)\n</code></pre>\n\n<p>This makes the <code>this</code> in the closure refer to the <code>ApplicationEnvironmentExtension</code>. That makes the calls to <code>srcLink</code>, <code>downloadPath</code> and <code>installPath</code> hit the right object.</p>\n\n<p>You then call the closure by doing this:</p>\n\n<pre><code>val extension = ApplicationEnvironmentExtension()\nextension.closure()\n</code></pre>\n\n<p>This will populate the <code>ApplicationEnvironmentExtension</code>.</p>\n\n<p>I also think the signatures of the <code>srcLink</code>, <code>downloadPath</code> and <code>installPath</code> functions are wrong. They should be defined like this:</p>\n\n<pre><code> fun srcLink(closure: () -&gt; String)\n fun downloadPath(closure: () -&gt; String)\n fun installPath(closure: () -&gt; String)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9459, "user_id": 1432980, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e646027bcc545177a971230c1e23134a?s=128&d=identicon&r=PG", "display_name": "lapots", "link": "https://stackoverflow.com/users/1432980/lapots"}, "edited": false, "score": 0, "creation_date": 1485933472, "post_id": 41968025, "comment_id": 71125873, "body": "It does not work either. It cannot find <code>srcLink</code> field"}], "tags": [], "owner": {"reputation": 8022, "user_id": 1068649, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5e44a15ecb4ee475548612da03c81f33?s=128&d=identicon&r=PG", "display_name": "James Bassett", "link": "https://stackoverflow.com/users/1068649/james-bassett"}, "is_accepted": false, "score": 0, "last_activity_date": 1485898949, "creation_date": 1485898949, "answer_id": 41968025, "question_id": 41955552, "link": "https://stackoverflow.com/questions/41955552/delegate-nested-closure-invokation-to-corresponding-class/41968025#41968025", "title": "delegate nested closure invokation to corresponding class", "body": "<p>Do  you even need those functions? Can't you set <code>scrLink</code>, <code>downloadPath</code> and <code>installPath</code> as properties? i.e. </p>\n\n<pre><code>env {\n    app (\"ghc-haskell\") {\n        srcLink = \"http://downloads.haskell.org/~ghc/8.0.1/ghc-8.0.1-x86_64-unknown-mingw32.tar.xz\"\n        downloadPath = project(':').projectDir.absolutePath + \"\\\\applications\\\\plugin\" \n        installPath = project(':').projectDir.absolutePath + \"\\\\applications\\\\plugin\" \n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9459, "user_id": 1432980, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e646027bcc545177a971230c1e23134a?s=128&d=identicon&r=PG", "display_name": "lapots", "link": "https://stackoverflow.com/users/1432980/lapots"}, "is_accepted": true, "score": 0, "last_activity_date": 1487575060, "creation_date": 1487575060, "answer_id": 42338570, "question_id": 41955552, "link": "https://stackoverflow.com/questions/41955552/delegate-nested-closure-invokation-to-corresponding-class/42338570#42338570", "title": "delegate nested closure invokation to corresponding class", "body": "<p>I resolved the issue using that workaround.</p>\n\n<p>For some weird reasons the parameter <code>closure</code> that I was passing into <code>app</code> method always wanted to resolve against <code>ApplicationEnvironmentContainerExtension</code> despite setting is as a closure of <code>ApplicationEnvironmentExtension</code> and even invoking it. </p>\n\n<p>So I decided use brute force and create the fields - that supposed to be populated in <code>ApplicationEnvironmentExtension</code> - in <code>ApplicationEnvironmentContainerExtension</code>, fill them and set manually in the required class.</p>\n\n<pre><code>open class ApplicationEnvironmentContainerExtension {\n    val environs = mutableMapOf&lt;String, ApplicationEnvironmentExtension&gt;()\n\n    var installationId = \"\"\n    var srcLink = \"\"\n    var installPath = \"\"\n    var downloadPath = \"\"\n\n    fun app(id: String, closure : ApplicationEnvironmentExtension.() -&gt; Unit) {\n        val extension = ApplicationEnvironmentExtension()\n        extension.installationId = id\n        environs.put(id, extension)\n\n        extension.process(closure)\n\n        extension.setEverything(installationId, srcLink, downloadPath, installPath)\n    }\n}\n</code></pre>\n\n<p>As for closure I decided to set them like James Bassett suggested</p>\n\n<pre><code>env {\n    app (\"ghc-haskell\") {\n        srcLink = \"http://downloads.haskell.org/~ghc/8.0.1/ghc-8.0.1-x86_64-unknown-mingw32.tar.xz\"\n        downloadPath = \"$path\\\\applications\\\\plugin\"\n        installPath = \"$path\\\\applications\\\\plugin\"\n    }\n\n    app (\"mongo-db\") {\n        srcLink = \"https://fastdl.mongodb.org/win32/mongodb-win32-x86_64-2008plus-ssl-3.4.1-signed.msi\"\n        downloadPath = \"$path\\\\applications\\\\plugin\"\n        installPath = \"$path\\\\applications\\\\plugin\"\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 9459, "user_id": 1432980, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e646027bcc545177a971230c1e23134a?s=128&d=identicon&r=PG", "display_name": "lapots", "link": "https://stackoverflow.com/users/1432980/lapots"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 42338570, "answer_count": 3, "score": 0, "last_activity_date": 1487575060, "creation_date": 1485859426, "question_id": 41955552, "link": "https://stackoverflow.com/questions/41955552/delegate-nested-closure-invokation-to-corresponding-class", "title": "delegate nested closure invokation to corresponding class", "body": "<p>I am trying to implement <code>gradle</code> plugin in <code>kotlin</code> that would support the structure like this</p>\n\n<pre><code>env {\n    app (\"ghc-haskell\") {\n        srcLink { \"http://downloads.haskell.org/~ghc/8.0.1/ghc-8.0.1-x86_64-unknown-mingw32.tar.xz\" }\n        downloadPath { project(':').projectDir.absolutePath + \"\\\\applications\\\\plugin\" }\n        installPath { project(':').projectDir.absolutePath + \"\\\\applications\\\\plugin\" }\n    }\n}\n</code></pre>\n\n<p>But I have a problem with inner closures like <code>srcLink</code>, <code>downloadPath</code>, <code>installPath</code>. How to delegate its invokation to corresponding <code>kotlin</code> class?</p>\n\n<p>My extension looks like this</p>\n\n<pre><code>/**\n * Keeps all environments.\n */\nopen class ApplicationEnvironmentContainerExtension {\n    val environs = mutableMapOf&lt;String, ApplicationEnvironmentExtension&gt;()\n\n    fun app(id: String, closure : ApplicationEnvironmentContainerExtension.() -&gt; String) : ApplicationEnvironmentExtension {\n        val extension = ApplicationEnvironmentExtension()\n        extension.installationId = id\n        environs.put(id, extension)\n        return extension\n    }\n\n    /**\n     * Sub extension.\n     */\n    open class ApplicationEnvironmentExtension {\n        var installationId = \"\"\n        var srcLink = \"\"\n        var downloadPath = \"\"\n        var installPath = \"\"\n\n        fun srcLink(closure: ApplicationEnvironmentExtension.() -&gt; String) {\n            srcLink = closure()\n        }\n\n        fun downloadPath(closure: ApplicationEnvironmentExtension.() -&gt; String) {\n            downloadPath = closure()\n        }\n\n        fun installPath(closure: ApplicationEnvironmentExtension.() -&gt; String) {\n            installPath = closure()\n        }\n\n        override fun toString(): String {\n            return \"ApplicationEnvironmentExtension(\" +\n                        \"installationId='$installationId', \" +\n                        \"srcLink='$srcLink', \" +\n                        \"downloadPath='$downloadPath', \" +\n                        \"installPath='$installPath')\"\n        }\n\n\n    }\n}\n</code></pre>\n\n<p>And when I invoke my <code>print</code> task to display list of environs it shows set only <code>installationId</code> - other fields are empty</p>\n\n<pre><code>open class PrintingTask :  DefaultTask() {\n\n    @TaskAction\n    fun print() {\n        val extension = this.project.extensions.getByName(\"env\")  as ApplicationEnvironmentContainerExtension\n\n        extension.environs.forEach {\n            println(it.value)\n        }\n    }\n}\n</code></pre>\n\n<p>How delegate <code>closure</code> invokation to <code>ApplicationEnvironmentExtension</code>?</p>\n"}, {"tags": ["android", "kotlin"], "answers": [{"tags": [], "owner": {"reputation": 311, "user_id": 1781269, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1e55388412f2e7596d0b6225b93e28c0?s=128&d=identicon&r=PG", "display_name": "amarkon", "link": "https://stackoverflow.com/users/1781269/amarkon"}, "is_accepted": false, "score": 0, "last_activity_date": 1485873635, "creation_date": 1485873635, "answer_id": 41960295, "question_id": 41955453, "link": "https://stackoverflow.com/questions/41955453/edittext-loses-focus-ontextchange/41960295#41960295", "title": "EditText loses focus onTextChange", "body": "<p>It appears this is a bug in Anvil, as using Android's <code>onTextChanged</code> implementation works properly. Closing this and I'll file a bug in their repo.</p>\n"}], "owner": {"reputation": 311, "user_id": 1781269, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1e55388412f2e7596d0b6225b93e28c0?s=128&d=identicon&r=PG", "display_name": "amarkon", "link": "https://stackoverflow.com/users/1781269/amarkon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485873635, "creation_date": 1485859146, "last_edit_date": 1495542812, "question_id": 41955453, "link": "https://stackoverflow.com/questions/41955453/edittext-loses-focus-ontextchange", "title": "EditText loses focus onTextChange", "body": "<p>I'm working on an Android application built using <a href=\"https://github.com/zserge/anvil\" rel=\"nofollow noreferrer\">Anvil</a> and Kotlin, and currently I've got a RecyclerView rendering a list of key-value pairs that should be editable by the user. In order to save these edits, I've added an <code>onTextChanged</code> listener as follows:</p>\n\n<pre><code>textInputLayout {\n  size(MATCH, WRAP)\n  /* ommitted style attributes */\n\n  editText {\n    size(MATCH, WRAP)\n    /* ommitted style attributes */\n    init {\n      text(getPropertyValue(item))\n      onTextChanged { onPropertyChange(item.first, it.toString()) }\n    }\n  }\n}\n</code></pre>\n\n<p>In the above example, <code>item</code> is of type <code>Pair&lt;String, Property&gt;</code> where <code>Property</code> is a custom object that gives information about format type (string, date, number, etc.) and the <code>getPropertyValue</code> call has the signature <code>getPropertyValue(item: Pair&lt;String, Property&gt;): String</code>. </p>\n\n<p>For some reason, every time I type the text field sees no changes but loses focus. The <code>onTextChanged</code> listener is definitely getting called because when it executes I can see the updated values produced by <code>onPropertyChange</code> getting logged to the console.</p>\n\n<p>I've already tried the solutions outlined <a href=\"https://stackoverflow.com/questions/14910131/edittext-loses-focus-on-click\">here</a> to no avail. Does anyone have any other suggestions? Been stuck on this for  a while now.</p>\n"}, {"tags": ["java", "intellij-idea", "gradle", "junit", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 741, "user_id": 8677930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WjJem.jpg?s=128&g=1", "display_name": "Mayokun", "link": "https://stackoverflow.com/users/8677930/mayokun"}, "edited": false, "score": 0, "creation_date": 1615999112, "post_id": 41954650, "comment_id": 117867832, "body": "I feel so dumb right now...thanks for this :)"}], "tags": [], "owner": {"reputation": 8022, "user_id": 1068649, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5e44a15ecb4ee475548612da03c81f33?s=128&d=identicon&r=PG", "display_name": "James Bassett", "link": "https://stackoverflow.com/users/1068649/james-bassett"}, "is_accepted": true, "score": 10, "last_activity_date": 1485857058, "creation_date": 1485857058, "answer_id": 41954650, "question_id": 41951683, "link": "https://stackoverflow.com/questions/41951683/why-doesnt-intellij-idea-recognize-my-spek-tests/41954650#41954650", "title": "Why doesn&#39;t IntelliJ Idea recognize my Spek tests?", "body": "<p>Have you installed the <a href=\"https://github.com/raniejade/spek-idea-plugin\" rel=\"noreferrer\">Spek plugin for IntelliJ</a>?</p>\n\n<p>Just search for <code>spek</code> in the IntelliJ plugin settings.</p>\n"}, {"tags": [], "owner": {"reputation": 122, "user_id": 2969593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IH81q.jpg?s=128&g=1", "display_name": "Kenny Li", "link": "https://stackoverflow.com/users/2969593/kenny-li"}, "is_accepted": false, "score": 0, "last_activity_date": 1499527538, "creation_date": 1499527538, "answer_id": 44987762, "question_id": 41951683, "link": "https://stackoverflow.com/questions/41951683/why-doesnt-intellij-idea-recognize-my-spek-tests/44987762#44987762", "title": "Why doesn&#39;t IntelliJ Idea recognize my Spek tests?", "body": "<p>Since you are using Junit 4.11, you can remove this from your build.gradle:</p>\n\n<pre><code>junitPlatform {\n    filters {\n        engines {\n            include 'spek'\n        }\n    }\n}\n</code></pre>\n\n<p>Then add this above your test class declaration:</p>\n\n<pre><code>@RunWith(JUnitPlatform::class)\n</code></pre>\n\n<p>Source: <a href=\"http://spekframework.org/docs/latest/#setting-up-legacy\" rel=\"nofollow noreferrer\">http://spekframework.org/docs/latest/#setting-up-legacy</a></p>\n"}], "owner": {"reputation": 13167, "user_id": 399457, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6a6ed435a024926ffb41d1ad84b3b1f5?s=128&d=identicon&r=PG", "display_name": "Mentiflectax", "link": "https://stackoverflow.com/users/399457/mentiflectax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3006, "favorite_count": 0, "accepted_answer_id": 41954650, "answer_count": 2, "score": 10, "last_activity_date": 1499527538, "creation_date": 1485846821, "question_id": 41951683, "link": "https://stackoverflow.com/questions/41951683/why-doesnt-intellij-idea-recognize-my-spek-tests", "title": "Why doesn&#39;t IntelliJ Idea recognize my Spek tests?", "body": "<p>I have a Gradle-based Kotlin project with some <a href=\"http://spekframework.org/\" rel=\"noreferrer\">Spek</a> tests, which are based on JUnit and should be compatible with Idea.</p>\n\n<p>But I don't see a \"Run\" menu item in the context menu.</p>\n\n<p><a href=\"https://i.stack.imgur.com/I2xo7.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/I2xo7.png\" alt=\"Context menu\"></a></p>\n\n<p>Why? What do I need to do in order to be able to run Spek tests in Idea like other JUnit tests?</p>\n\n<p>Here's my <code>build.gradle</code>:</p>\n\n<pre><code>buildscript {\n  ext.kotlin_version = '1.0.4'\n  repositories {\n    mavenCentral()\n    maven {\n        url \"https://dl.bintray.com/jetbrains/spek\"\n    }\n  }\n  dependencies {\n    classpath \"org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version\"\n    classpath 'org.junit.platform:junit-platform-gradle-plugin:1.0.0-M3'\n  }\n\n}\n\napply plugin: \"kotlin\"\napply plugin: \"application\"\napply plugin: 'org.junit.platform.gradle.plugin'\n\njunitPlatform {\n    filters {\n        engines {\n            include 'spek'\n        }\n    }\n}\n\nmainClassName = \"com.mycompany.myproduct.AppKt\"\n\nsourceSets {\n  deploy\n}\n\nrepositories {\n  mavenCentral()\n  maven {\n    url \"https://dl.bintray.com/jetbrains/spek\"\n  }\n\n}\n\ndependencies {\n  compile \"org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version\"\n  compile 'org.telegram:telegrambots:2.4.2'\n  compile group: 'org.apache.commons', name: 'commons-lang3', version: '3.0'\n  compile group: 'ch.qos.logback', name: 'logback-core', version: '1.1.3'\n  compile group: 'ch.qos.logback', name: 'logback-classic', version: '1.1.3'\n  compile group: 'org.slf4j', name: 'slf4j-api', version: '1.6.1' \n  testCompile  'junit:junit:4.11'\n  testCompile \"org.jetbrains.kotlin:kotlin-test-junit:$kotlin_version\"\n  testCompile group: 'org.mockito', name: 'mockito-all', version: '2.0.2-beta'\n  testCompile 'org.jetbrains.spek:spek-api:1.1.19'\n  testRuntime 'org.jetbrains.spek:spek-junit-platform-engine:1.1.19'\n}\n\ntest.testClassesDir = project.tasks.compileTestKotlin.destinationDir\n\ntask wrapper(type: Wrapper) {\n  gradleVersion=\"3.1\"\n}\n\nrun {\n    jvmArgs = [\"-Xmx100m\", \"-XX:+HeapDumpOnOutOfMemoryError\", \"-XX:HeapDumpPath=/[...]/log/memdump.log\"]\n}\n\njar {\n    manifest {\n        attributes 'Main-Class': mainClassName,\n                   'Class-Path': configurations.runtime.files.collect {\"$it.name\"}.join(' ')\n    }\n}\n</code></pre>\n"}, {"tags": ["android", "function", "lambda", "mockito", "kotlin"], "comments": [{"owner": {"reputation": 126499, "user_id": 1531124, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/zw18i.png?s=128&g=1", "display_name": "GhostCat", "link": "https://stackoverflow.com/users/1531124/ghostcat"}, "edited": false, "score": 0, "creation_date": 1485848599, "post_id": 41945675, "comment_id": 71083431, "body": "And just for the record: the things that PowerMock does to byte code can give one a headache when working pure java. I would really stay away from using PowerMockito with bytecode generated by anything else but javac."}], "answers": [{"comments": [{"owner": {"reputation": 1845, "user_id": 4204176, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7d2919f023447cbe3492e8d5f8ae4ad6?s=128&d=identicon&r=PG", "display_name": "Jesus Almaral - Hackaprende", "link": "https://stackoverflow.com/users/4204176/jesus-almaral-hackaprende"}, "edited": false, "score": 0, "creation_date": 1485902763, "post_id": 41947120, "comment_id": 71116382, "body": "I think this is a good solution, but the thing is I have conflicts with PowerMock because of what I wrote above, I am using PowerMock because I am working with some static classes"}, {"owner": {"reputation": 8022, "user_id": 1068649, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5e44a15ecb4ee475548612da03c81f33?s=128&d=identicon&r=PG", "display_name": "James Bassett", "link": "https://stackoverflow.com/users/1068649/james-bassett"}, "reply_to_user": {"reputation": 1845, "user_id": 4204176, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7d2919f023447cbe3492e8d5f8ae4ad6?s=128&d=identicon&r=PG", "display_name": "Jesus Almaral - Hackaprende", "link": "https://stackoverflow.com/users/4204176/jesus-almaral-hackaprende"}, "edited": false, "score": 1, "creation_date": 1485905145, "post_id": 41947120, "comment_id": 71117219, "body": "Haha you&#39;re on your own then - there be dragons!"}, {"owner": {"reputation": 298, "user_id": 2423899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025aa765baa1d2132bf264e2f774c94d?s=128&d=identicon&r=PG&f=1", "display_name": "illusionJJ", "link": "https://stackoverflow.com/users/2423899/illusionjj"}, "edited": false, "score": 3, "creation_date": 1543157910, "post_id": 41947120, "comment_id": 93807957, "body": "What I missed? <code>capture(ArgumentCaptor&lt;T&gt;)</code> has parameter not lambda."}, {"owner": {"reputation": 1767, "user_id": 5607230, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-yxTaDUTQbFI/AAAAAAAAAAI/AAAAAAAAACk/PyBMKtiZFCE/photo.jpg?sz=128", "display_name": "Wackaloon", "link": "https://stackoverflow.com/users/5607230/wackaloon"}, "edited": false, "score": 0, "creation_date": 1613049519, "post_id": 41947120, "comment_id": 116959446, "body": "That solution doesn&#39;t work"}, {"owner": {"reputation": 4221, "user_id": 191761, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/umagg.jpg?s=128&g=1", "display_name": "Adam Burley", "link": "https://stackoverflow.com/users/191761/adam-burley"}, "edited": false, "score": 0, "creation_date": 1616418685, "post_id": 41947120, "comment_id": 117987898, "body": "If you are not using mockito-kotlin, check the solution on this page, which fixed it for me :) <a href=\"http://derekwilson.net/blog/2018/10/19/mockito-kotlin-2\" rel=\"nofollow noreferrer\">derekwilson.net/blog/2018/10/19/mockito-kotlin-2</a>"}], "tags": [], "owner": {"reputation": 8022, "user_id": 1068649, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5e44a15ecb4ee475548612da03c81f33?s=128&d=identicon&r=PG", "display_name": "James Bassett", "link": "https://stackoverflow.com/users/1068649/james-bassett"}, "is_accepted": false, "score": 2, "last_activity_date": 1486374962, "last_edit_date": 1486374962, "creation_date": 1485818164, "answer_id": 41947120, "question_id": 41945675, "link": "https://stackoverflow.com/questions/41945675/mocktito-argumentcaptor-for-kotlin-lambda-with-arguments/41947120#41947120", "title": "Mocktito ArgumentCaptor for Kotlin lambda with arguments", "body": "<p>Using <a href=\"https://github.com/nhaarman/mockito-kotlin/wiki/Mocking-and-verifying\" rel=\"nofollow noreferrer\">mockito-kotlin</a> like this seems to work:</p>\n\n<pre><code>    val myService = mock&lt;MyInterface&gt;()\n\n    myService.doSomething {\n        println(it)\n    }\n\n    verify(myService).doSomething(capture { function -&gt;\n        function.invoke(123)\n    })\n</code></pre>\n\n<p>Edit: removed unnecessary <code>argumentCaptor&lt;(Long) -&gt; Unit&gt;().apply {}</code> - it wasn't used</p>\n"}], "owner": {"reputation": 1845, "user_id": 4204176, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7d2919f023447cbe3492e8d5f8ae4ad6?s=128&d=identicon&r=PG", "display_name": "Jesus Almaral - Hackaprende", "link": "https://stackoverflow.com/users/4204176/jesus-almaral-hackaprende"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4246, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1486374962, "creation_date": 1485811576, "question_id": 41945675, "link": "https://stackoverflow.com/questions/41945675/mocktito-argumentcaptor-for-kotlin-lambda-with-arguments", "title": "Mocktito ArgumentCaptor for Kotlin lambda with arguments", "body": "<p>I am trying to test this on Kotlin:</p>\n\n<pre><code>verify(myInterface).doSomething(argumentCaptor.capture())\ncapture.value.invoke(0L)\n</code></pre>\n\n<p>Where doSomething is:</p>\n\n<pre><code>doSomething((Long) -&gt; Unit)\n</code></pre>\n\n<p>How can I create an ArgumentCaptor for this? Right now I am doing this</p>\n\n<pre><code>inline fun &lt;reified T : Any&gt; argumentCaptor() = ArgumentCaptor.forClass(T::class.java)!!\n    val captor = argumentCaptor&lt;(Long) -&gt; Unit&gt;()\n\n    verify(mainApiInterface!!).downloadUserProfilePicture(captor.capture())\n    captor.value.invoke(0L)\n</code></pre>\n\n<p>But I am getting java.lang.IllegalStateException: captor.capture() must not be null</p>\n\n<p>I also tried integrating mockito-kotlin but I get a PowerMockito error:</p>\n\n<blockquote>\n  <p>No instance field named \"reported\" could be found in the class hierarchy of org.mockito.internal.MockitoCore.</p>\n</blockquote>\n"}, {"tags": ["generics", "kotlin"], "comments": [{"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "edited": false, "score": 3, "creation_date": 1485797498, "post_id": 41941102, "comment_id": 71063975, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/35581867/kotlin-ndarray-with-a-lambda-constructor-with-generic-return-type\">Kotlin NDArray with a lambda constructor with generic return type</a>"}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 3289331, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c65d7756ad7fab1691f3af46e0d85248?s=128&d=identicon&r=PG&f=1", "display_name": "Lancaster", "link": "https://stackoverflow.com/users/3289331/lancaster"}, "edited": false, "score": 0, "creation_date": 1485861138, "post_id": 41946516, "comment_id": 71090884, "body": "Thanks for explanation, I like the second way. I updated my post and code works properly, but now I have a public constructor in Matrix2d class which can be used by all, and it&#39;s confusing, because I have a third parameter as an array. And if I use that constructor I should pass the number of rows and columns.  I wanted to specify contructor scope to private, but it&#39;s not available for inline function. How can I solve this problem in a different way?"}, {"owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "reply_to_user": {"reputation": 189, "user_id": 3289331, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c65d7756ad7fab1691f3af46e0d85248?s=128&d=identicon&r=PG&f=1", "display_name": "Lancaster", "link": "https://stackoverflow.com/users/3289331/lancaster"}, "edited": false, "score": 1, "creation_date": 1485875366, "post_id": 41946516, "comment_id": 71100561, "body": "Use internal constructor, though to call it from public inline function, you have to annotate it with @PublishedApi annotation (available in Kotlin 1.1). I&#39;ll update the example."}, {"owner": {"reputation": 34690, "user_id": 919872, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4dbc53382955c1a7ee0a92c0d3e94066?s=128&d=identicon&r=PG", "display_name": "Zelazny7", "link": "https://stackoverflow.com/users/919872/zelazny7"}, "edited": false, "score": 0, "creation_date": 1563568311, "post_id": 41946516, "comment_id": 100756983, "body": "Is there any way to do this with primitive arrays? I would like to create a general <code>Series</code> class that holds a private array of primitives like <code>long[]</code> or <code>double[]</code>."}], "tags": [], "owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "is_accepted": true, "score": 19, "last_activity_date": 1485875457, "last_edit_date": 1485875457, "creation_date": 1485815223, "answer_id": 41946516, "question_id": 41941102, "link": "https://stackoverflow.com/questions/41941102/instantiating-generic-array-in-kotlin/41946516#41946516", "title": "Instantiating generic array in Kotlin", "body": "<p>JVM arrays, on which Kotlin arrays are mapped to, require the element type to be known at compile time to create an instance of array.</p>\n\n<p>So you can instantiate <code>Array&lt;String&gt;</code> or <code>Array&lt;Any&gt;</code>, but not <code>Array&lt;T&gt;</code> where <code>T</code> is a type parameter, representing the type that is erased at compile time and hence is unknown. \nTo specify that a type parameter must be known at compile time it is marked with <code>reified</code> modifier.</p>\n\n<p>There are several options, what you can do in this situation:</p>\n\n<ol>\n<li><p>Use <code>MutableList&lt;T&gt;</code> for storing elements, which doesn't require reified T:</p>\n\n<pre><code>// MutableList function, available in Kotlin 1.1\nval data = MutableList(rows * cols, { i -&gt;\n   val r = i / cols\n   init(r, i % cols)\n})\n// or in Kotlin 1.0\nval data = mutableListOf&lt;T&gt;().apply {\n    repeat(rows * cols) { i -&gt;\n        val r = i / cols\n        add(init(r, i % cols))\n    }\n}\n</code></pre></li>\n<li><p>Create an array from an inline function with reified type parameter:</p>\n\n<pre><code>inline fun &lt;reified T&gt; Matrix2d(val rows: Int, val cols: Int, init: (Int, Int) -&gt; T) = \n    Matrix2d(rows, cols, Array(rows * cols, { .... })\n\nclass Matrix2d&lt;T&gt; \n    @PublishedApi internal constructor(\n        val rows: Int, val cols: Int,\n        private val data: Array&lt;T&gt;\n    ) \n</code></pre></li>\n<li><p>Use <code>Array&lt;Any?&gt;</code> as the storage, and cast its values to <code>T</code> in <code>get</code> function:</p>\n\n<pre><code>val data = Array&lt;Any?&gt;(rows * cols, { .... })\n\noperator fun get(row: Int, col: Int): T = data[row * cols + col] as T\n</code></pre></li>\n<li><p>Pass a parameter of type <code>Class&lt;T&gt;</code> or <code>KClass&lt;T&gt;</code> to constructor and use java reflection to create an instance of array.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 820, "user_id": 759719, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AmYnj.jpg?s=128&g=1", "display_name": "Bryan W. Wagner", "link": "https://stackoverflow.com/users/759719/bryan-w-wagner"}, "edited": false, "score": 0, "creation_date": 1579113434, "post_id": 50304353, "comment_id": 105661188, "body": "This solution is just as viable as solution 3 in the selected answer; just probably should have private access."}], "tags": [], "owner": {"reputation": 872, "user_id": 704132, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/XoaW2.png?s=128&g=1", "display_name": "Riki137", "link": "https://stackoverflow.com/users/704132/riki137"}, "is_accepted": false, "score": 2, "last_activity_date": 1526114319, "creation_date": 1526114319, "answer_id": 50304353, "question_id": 41941102, "link": "https://stackoverflow.com/questions/41941102/instantiating-generic-array-in-kotlin/50304353#50304353", "title": "Instantiating generic array in Kotlin", "body": "<p>Personally, the best workaround for me was:</p>\n\n<pre><code>@Suppress(\"UNCHECKED_CAST\")\nvar pool: Array&lt;T?&gt; = arrayOfNulls&lt;Any?&gt;(initialCapacity) as Array&lt;T?&gt;\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 3289331, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c65d7756ad7fab1691f3af46e0d85248?s=128&d=identicon&r=PG&f=1", "display_name": "Lancaster", "link": "https://stackoverflow.com/users/3289331/lancaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9852, "favorite_count": 3, "accepted_answer_id": 41946516, "answer_count": 2, "score": 18, "last_activity_date": 1526114319, "creation_date": 1485794656, "last_edit_date": 1485861021, "question_id": 41941102, "link": "https://stackoverflow.com/questions/41941102/instantiating-generic-array-in-kotlin", "title": "Instantiating generic array in Kotlin", "body": "<p>Why this doesn't compile? I get compile error in 3 line</p>\n\n<blockquote>\n  <p>Cannot use T as reified type parameter. Use class instead</p>\n</blockquote>\n\n<pre><code>class Matrix2d&lt;T&gt;(val rows: Int, val cols: Int, init: (Int, Int) -&gt; T) {\n\n   var data = Array(rows * cols, { i -&gt;\n      val r = Math.floor(i.toDouble() / cols).toInt()\n      init(r, i - r * cols)\n   })\n\n   operator fun get(row: Int, col: Int): T = data[row * cols + col]\n\n   operator fun set(row: Int, col: Int, v: T) = {\n      data[row * cols + col] = v\n   }\n}\n</code></pre>\n\n<p><strong>Solution</strong></p>\n\n<p>I added a factory function which looks like a second constructor but implemented in inline function</p>\n\n<pre><code>class Matrix2d&lt;T&gt;(val rows: Int, val cols: Int, private val data: Array&lt;T&gt;) {\n\n   companion object {\n      operator inline fun &lt;reified T&gt; invoke(rows: Int, cols: Int, init: (Int, Int) -&gt; T): Matrix2d&lt;T&gt; {\n         return Matrix2d(rows, cols, Array(rows * cols, { i -&gt;\n            val r = Math.floor(i.toDouble() / cols).toInt()\n            init(r, i - r * cols)\n         }))\n      }\n   }\n\n   init {\n      if (rows * cols != data.size) throw IllegalArgumentException(\"Illegal array size: ${data.size}\")\n   }\n\n   operator fun get(row: Int, col: Int): T = data[row * cols + col]\n\n   operator fun set(row: Int, col: Int, v: T) {\n      data[row * cols + col] = v\n   }\n}\n</code></pre>\n"}, {"tags": ["constructor", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 1427, "user_id": 1815052, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bed5ab71b8d23d9bf07a5fa12915699c?s=128&d=identicon&r=PG", "display_name": "SqueezyMo", "link": "https://stackoverflow.com/users/1815052/squeezymo"}, "edited": false, "score": 0, "creation_date": 1485797134, "post_id": 41941233, "comment_id": 71063769, "body": "I assumed I was missing something but yes, it certainly looks like a bug. Thanks, I guess I&#39;ll report it then."}], "tags": [], "owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "is_accepted": true, "score": 2, "last_activity_date": 1485795109, "creation_date": 1485795109, "answer_id": 41941233, "question_id": 41940321, "link": "https://stackoverflow.com/questions/41940321/adding-secondary-constructor-to-parent-unexpectedly-affects-child-classes/41941233#41941233", "title": "Adding secondary constructor to parent unexpectedly affects child classes", "body": "<p>This may be by design or a compiler bug. I recommend reporting it at <a href=\"https://youtrack.jetbrains.com/issues/KT\" rel=\"nofollow noreferrer\">Kotlin (KT) | YouTrack</a>.</p>\n\n<p>As a workaround, you can explicitly declare the generic types used in the <code>HashMap</code> when calling the <code>Parent</code> constructor:</p>\n\n<pre><code>class Child : Parent(hashMapOf&lt;String, Any&gt;(Pair(\"key\", \"value\")))\n</code></pre>\n\n<p>I'm not certain why  the compiler accepts <code>HashMap&lt;String, String&gt;</code> as <code>HashMap&lt;String, Any&gt;</code> when the secondary constructor isn't defined but doesn't accept it when the secondary constructor is defined but sometimes the compiler simply fails to infer generic types and you need to explicitly declare them.</p>\n"}], "owner": {"reputation": 1427, "user_id": 1815052, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bed5ab71b8d23d9bf07a5fa12915699c?s=128&d=identicon&r=PG", "display_name": "SqueezyMo", "link": "https://stackoverflow.com/users/1815052/squeezymo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 41941233, "answer_count": 1, "score": 0, "last_activity_date": 1485795109, "creation_date": 1485792196, "question_id": 41940321, "link": "https://stackoverflow.com/questions/41940321/adding-secondary-constructor-to-parent-unexpectedly-affects-child-classes", "title": "Adding secondary constructor to parent unexpectedly affects child classes", "body": "<p>I have a (seemingly) odd problem. It can be reproduced with just a few lines:</p>\n\n<pre><code>open class Parent(val map: HashMap&lt;String, Any&gt;) {\n    // constructor(unusedArgument: Int): this(hashMapOf())\n}\n\nclass Child: Parent(hashMapOf(Pair(\"key\", \"value\")))\n</code></pre>\n\n<p>It compiles and works as expected as long as I keep <code>Parent</code>'s secondary constructor commented out.\nOnce I put it back in, this lint error pops up where the <code>Child</code>'s parent constuctor is called:</p>\n\n<blockquote>\n  <p>Error: None of the following functions can be called with the\n  arguments supplied:</p>\n  \n  <p>public constructor Parent(map: HashMap) defined in Parent</p>\n  \n  <p>public constructor Parent(unusedArgument: Int) defined in Parent</p>\n</blockquote>\n\n<p>The error goes away if any of these is true:</p>\n\n<ul>\n<li>I specify variance as <code>HashMap&lt;String, out Any&gt;</code>,</li>\n<li>My secondary constructor is empty,</li>\n<li><code>map</code> is declared as <code>Map</code> instead of <code>HashMap</code> (which I don't do because for my purposes I need it to implement <code>Serializable</code>).</li>\n</ul>\n\n<p>To be honest, it doesn't make much sense to me. Why does it happen only if I add non-empty secondary constructor to the parent class? What does it have to do with anything? And how exactly do these \"fixes\" fix it?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["spring", "kotlin", "project-reactor"], "comments": [{"owner": {"reputation": 376, "user_id": 3105386, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/kLBxX.jpg?s=128&g=1", "display_name": "Vipul Jain", "link": "https://stackoverflow.com/users/3105386/vipul-jain"}, "edited": false, "score": 0, "creation_date": 1594547849, "post_id": 41939335, "comment_id": 111159001, "body": "<a href=\"https://www.woolha.com/tutorials/project-reactor-publishon-vs-subscribeon-difference\" rel=\"nofollow noreferrer\">woolha.com/tutorials/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 453, "user_id": 7384454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92753aff33caafc8f8b69328439cc7e5?s=128&d=identicon&r=PG&f=1", "display_name": "Valahu", "link": "https://stackoverflow.com/users/7384454/valahu"}, "edited": false, "score": 0, "creation_date": 1485811522, "post_id": 41941592, "comment_id": 71071523, "body": "Thank you for clarifying this aspect for me!"}, {"owner": {"reputation": 7581, "user_id": 2629588, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ODOGH.png?s=128&g=1", "display_name": "Sankarganesh Eswaran", "link": "https://stackoverflow.com/users/2629588/sankarganesh-eswaran"}, "edited": false, "score": 1, "creation_date": 1552284893, "post_id": 41941592, "comment_id": 96935704, "body": "But I&#39;m having a hard time realizing why we need two? publishOn and subscribeOn. Where all we are trying to achieve is to run the blocking/time taking task of the chain in a separate thread pool."}, {"owner": {"reputation": 20335, "user_id": 1113486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda20bf9d9c85c4390ca7237beba45a2?s=128&d=identicon&r=PG", "display_name": "Simon Basl&#233;", "link": "https://stackoverflow.com/users/1113486/simon-basl%c3%a9"}, "edited": false, "score": 2, "creation_date": 1552293098, "post_id": 41941592, "comment_id": 96938792, "body": "you wouldn&#39;t necessarily need the two for that case, subscribeOn should suffice to change the initial thread"}], "tags": [], "owner": {"reputation": 20335, "user_id": 1113486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda20bf9d9c85c4390ca7237beba45a2?s=128&d=identicon&r=PG", "display_name": "Simon Basl&#233;", "link": "https://stackoverflow.com/users/1113486/simon-basl%c3%a9"}, "is_accepted": true, "score": 25, "last_activity_date": 1485796256, "creation_date": 1485796256, "answer_id": 41941592, "question_id": 41939335, "link": "https://stackoverflow.com/questions/41939335/using-both-publishon-and-subscribeon-on-a-flux-results-in-nothing-happening/41941592#41941592", "title": "Using both publishOn and subscribeOn on a flux results in nothing happening", "body": "<p><code>subscribeOn</code> rather influence where the <em>subscription</em> occurs. That is, the initial event that triggers the source to emit elements. The <code>Subscriber</code> 's <code>onNext</code> hook on the other hand is influenced by the closest <code>publishOn</code> up in the chain (much like your <code>map</code>).</p>\n\n<p>But <code>EmitterProcessor</code>, like most <code>Processor</code>s, is more advanced and can do some work stealing. I'm unsure why you don't get anything printed in your case (your sample converted to Java works on my machine), but I bet it has something to do with that Processor.</p>\n\n<p>This code would better demonstrate <code>subscribeOn</code> vs <code>publishOn</code>:</p>\n\n<pre><code>Flux.just(\"a\", \"b\", \"c\") //this is where subscription triggers data production\n        //this is influenced by subscribeOn\n        .doOnNext(v -&gt; System.out.println(\"before publishOn: \" + Thread.currentThread().getName()))\n        .publishOn(Schedulers.elastic())\n        //the rest is influenced by publishOn\n        .doOnNext(v -&gt; System.out.println(\"after publishOn: \" + Thread.currentThread().getName()))\n        .subscribeOn(Schedulers.parallel())\n        .subscribe(v -&gt; System.out.println(\"received \" + v + \" on \" + Thread.currentThread().getName()));\n    Thread.sleep(5000);\n</code></pre>\n\n<p>This prints out:</p>\n\n<pre><code>before publishOn: parallel-1\nbefore publishOn: parallel-1\nbefore publishOn: parallel-1\nafter publishOn: elastic-2\nreceived a on elastic-2\nafter publishOn: elastic-2\nreceived b on elastic-2\nafter publishOn: elastic-2\nreceived c on elastic-2\n</code></pre>\n"}], "owner": {"reputation": 453, "user_id": 7384454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92753aff33caafc8f8b69328439cc7e5?s=128&d=identicon&r=PG&f=1", "display_name": "Valahu", "link": "https://stackoverflow.com/users/7384454/valahu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6198, "favorite_count": 6, "accepted_answer_id": 41941592, "answer_count": 1, "score": 9, "last_activity_date": 1485796256, "creation_date": 1485789405, "question_id": 41939335, "link": "https://stackoverflow.com/questions/41939335/using-both-publishon-and-subscribeon-on-a-flux-results-in-nothing-happening", "title": "Using both publishOn and subscribeOn on a flux results in nothing happening", "body": "<p>Whenever i use both subscribeOn and publishOn nothing is printed.\n   If I use only one it will print.\n   If I use subscribeOn(Schedulers.immediate()) or elastic it works.\n   Any ideea why that is?</p>\n\n<p>It was my understanding that publishOn affects on what thread it gets published and subscribe on on what thread the subscriber runs. Could you please point me in the right direction?</p>\n\n<pre><code>fun test() {\n        val testPublisher = EmitterProcessor.create&lt;String&gt;().connect()\n        testPublisher\n                .publishOn(Schedulers.elastic())\n                .map { it -&gt;\n                    println(\"map on ${Thread.currentThread().name}\")\n                    it\n                }\n                .subscribeOn(Schedulers.parallel())  \n                .subscribe { println(\"subscribe on ${Thread.currentThread().name}\") }\n        testPublisher.onNext(\"a\")\n        testPublisher.onNext(\"b\")\n        testPublisher.onNext(\"c\")\n        Thread.sleep(5000)\n        println(\"---\")\n    }\n</code></pre>\n"}, {"tags": ["android", "kotlin", "toast", "android-toast", "anko"], "comments": [{"owner": {"reputation": 171, "user_id": 6298618, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-H_RAvIWb4d8/AAAAAAAAAAI/AAAAAAAAACg/21RB0uEE0Oo/photo.jpg?sz=128", "display_name": "IMRAN", "link": "https://stackoverflow.com/users/6298618/imran"}, "edited": false, "score": 0, "creation_date": 1485767874, "post_id": 41932223, "comment_id": 71044910, "body": "use this Toast.makeText(getActivity(),&quot;message&quot;,Toast.LENGTH_SHORT).s&zwnj;&#8203;how();"}, {"owner": {"reputation": 2571, "user_id": 3734457, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de6e5134d8a12fdcbd9cd3b204d70203?s=128&d=identicon&r=PG", "display_name": "Jan Slominski", "link": "https://stackoverflow.com/users/3734457/jan-slominski"}, "reply_to_user": {"reputation": 171, "user_id": 6298618, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-H_RAvIWb4d8/AAAAAAAAAAI/AAAAAAAAACg/21RB0uEE0Oo/photo.jpg?sz=128", "display_name": "IMRAN", "link": "https://stackoverflow.com/users/6298618/imran"}, "edited": false, "score": 1, "creation_date": 1485767993, "post_id": 41932223, "comment_id": 71044980, "body": "I stated in my questions that standard Android Toast works without problems. But I would like to know why Anko&#39;s &quot;toast()&quot; extension method doesn&#39;t work in this case."}, {"owner": {"reputation": 171, "user_id": 6298618, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-H_RAvIWb4d8/AAAAAAAAAAI/AAAAAAAAACg/21RB0uEE0Oo/photo.jpg?sz=128", "display_name": "IMRAN", "link": "https://stackoverflow.com/users/6298618/imran"}, "edited": false, "score": 0, "creation_date": 1485768071, "post_id": 41932223, "comment_id": 71045024, "body": "what is your implementation of toast() method"}, {"owner": {"reputation": 2571, "user_id": 3734457, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de6e5134d8a12fdcbd9cd3b204d70203?s=128&d=identicon&r=PG", "display_name": "Jan Slominski", "link": "https://stackoverflow.com/users/3734457/jan-slominski"}, "reply_to_user": {"reputation": 171, "user_id": 6298618, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-H_RAvIWb4d8/AAAAAAAAAAI/AAAAAAAAACg/21RB0uEE0Oo/photo.jpg?sz=128", "display_name": "IMRAN", "link": "https://stackoverflow.com/users/6298618/imran"}, "edited": false, "score": 0, "creation_date": 1485768276, "post_id": 41932223, "comment_id": 71045128, "body": "It is not my implementation, it&#39;s Anko: <a href=\"https://github.com/Kotlin/anko\" rel=\"nofollow noreferrer\">github.com/Kotlin/anko</a>"}, {"owner": {"reputation": 3668, "user_id": 2392960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a549fcc9b00c4ce0ede36ede98548729?s=128&d=identicon&r=PG", "display_name": "Januson", "link": "https://stackoverflow.com/users/2392960/januson"}, "edited": false, "score": 1, "creation_date": 1485769951, "post_id": 41932223, "comment_id": 71046139, "body": "Post your code."}, {"owner": {"reputation": 2571, "user_id": 3734457, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de6e5134d8a12fdcbd9cd3b204d70203?s=128&d=identicon&r=PG", "display_name": "Jan Slominski", "link": "https://stackoverflow.com/users/3734457/jan-slominski"}, "edited": false, "score": 0, "creation_date": 1485770102, "post_id": 41932223, "comment_id": 71046219, "body": "toast(&quot;text&quot;) in fragment&#39;s button onClickListener :) (normal Toast works in the same place)"}, {"owner": {"reputation": 34634, "user_id": 2444099, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ad5Vz.jpg?s=128&g=1", "display_name": "Eugen Pechanec", "link": "https://stackoverflow.com/users/2444099/eugen-pechanec"}, "edited": false, "score": 0, "creation_date": 1486116937, "post_id": 41932223, "comment_id": 71217641, "body": "File a bug on anko Github and use standard Toast API for now."}, {"owner": {"reputation": 1563, "user_id": 2717821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rRK4d.jpg?s=128&g=1", "display_name": "Deni Erdyneev", "link": "https://stackoverflow.com/users/2717821/deni-erdyneev"}, "edited": false, "score": 0, "creation_date": 1487830681, "post_id": 41932223, "comment_id": 71963260, "body": "@JanSlominski, I have the same error and have created issue <a href=\"https://github.com/Kotlin/anko/issues/328\" rel=\"nofollow noreferrer\">github.com/Kotlin/anko/issues/328</a>"}], "answers": [{"comments": [{"owner": {"reputation": 16317, "user_id": 1866373, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/cafdE.jpg?s=128&g=1", "display_name": "Daniel Wilson", "link": "https://stackoverflow.com/users/1866373/daniel-wilson"}, "edited": false, "score": 2, "creation_date": 1543883198, "post_id": 42432818, "comment_id": 94070266, "body": "Took me embarrassingly long to figure out I was calling this from a fragment and needed context/activity"}], "tags": [], "owner": {"reputation": 1563, "user_id": 2717821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rRK4d.jpg?s=128&g=1", "display_name": "Deni Erdyneev", "link": "https://stackoverflow.com/users/2717821/deni-erdyneev"}, "is_accepted": true, "score": 11, "last_activity_date": 1487920558, "creation_date": 1487920558, "answer_id": 42432818, "question_id": 41932223, "link": "https://stackoverflow.com/questions/41932223/anko-toast-method-causes-java-lang-nosuchmethoderror-when-called-from-fragment/42432818#42432818", "title": "Anko toast() method causes java.lang.NoSuchMethodError when called from Fragment", "body": "<p>It is very strange, probably it is a bug.</p>\n\n<p>But next works for me</p>\n\n<pre><code>activity.toast(\"Toast's message text\")\n</code></pre>\n\n<p>or</p>\n\n<pre><code>context.toast(\"Toast's message text\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1304, "user_id": 7691891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2fSJi.jpg?s=128&g=1", "display_name": "Smaillns", "link": "https://stackoverflow.com/users/7691891/smaillns"}, "is_accepted": false, "score": 1, "last_activity_date": 1525197083, "creation_date": 1525197083, "answer_id": 50121296, "question_id": 41932223, "link": "https://stackoverflow.com/questions/41932223/anko-toast-method-causes-java-lang-nosuchmethoderror-when-called-from-fragment/50121296#50121296", "title": "Anko toast() method causes java.lang.NoSuchMethodError when called from Fragment", "body": "<p>If you want to use it inside a class (an adapter, for example), surely you have  to get the activity first (context)</p>\n\n<pre><code>holder.itemView.setOnClickListener(\n                { view -&gt;\n                    view.getContext().toast(\"Message\")\n                }\n        )\n</code></pre>\n"}], "owner": {"reputation": 2571, "user_id": 3734457, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de6e5134d8a12fdcbd9cd3b204d70203?s=128&d=identicon&r=PG", "display_name": "Jan Slominski", "link": "https://stackoverflow.com/users/3734457/jan-slominski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3817, "favorite_count": 0, "accepted_answer_id": 42432818, "answer_count": 2, "score": 9, "last_activity_date": 1525197083, "creation_date": 1485767573, "last_edit_date": 1486114662, "question_id": 41932223, "link": "https://stackoverflow.com/questions/41932223/anko-toast-method-causes-java-lang-nosuchmethoderror-when-called-from-fragment", "title": "Anko toast() method causes java.lang.NoSuchMethodError when called from Fragment", "body": "<p>I'm having following error when I'm calling toast(\"Toast's message text\") from Android Fragment:</p>\n\n<blockquote>\n  <p>java.lang.NoSuchMethodError: No virtual method getActivity()Landroid/app/Activity; in class Landroid/support/v4/app/Fragment; or its super classes (declaration of 'android.support.v4.app.Fragment' appears in name-of-the-file-classes.dex)</p>\n</blockquote>\n\n<p>I'm using Anko v0.9.1 and Kotlin 1.0.6</p>\n\n<p>What might be the cause of this crash? Standard Android Toast works just fine. Also toast() function works inside Activities. </p>\n"}, {"tags": ["java", "json", "kotlin"], "comments": [{"owner": {"reputation": 2463, "user_id": 3243124, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/e6526d2b3a6432d8d50ecc8ce6e7305f?s=128&d=identicon&r=PG&f=1", "display_name": "AJ_1310", "link": "https://stackoverflow.com/users/3243124/aj-1310"}, "reply_to_user": {"reputation": 823, "user_id": 6341307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05420bba7db341dc4bde23d6b1bd40f5?s=128&d=identicon&r=PG", "display_name": "Mr00Anderson", "link": "https://stackoverflow.com/users/6341307/mr00anderson"}, "edited": false, "score": 2, "creation_date": 1485750991, "post_id": 41928803, "comment_id": 71038654, "body": "I haven&#39;t developed in Java. It&#39;s not an error I&#39;m getting. I just don&#39;t know how to do effective parsing in Kotlin natively. All searches always lead to a framework. Java has an org.json.simple. Trusting the autocomplete features of the IDE, Kotlin doesn&#39;t."}, {"owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "edited": false, "score": 0, "creation_date": 1485770601, "post_id": 41928803, "comment_id": 71046540, "body": "The org.json.simple package isn&#39;t native to Java. I guess it&#39;s this library: <a href=\"https://github.com/fangyidong/json-simple\" rel=\"nofollow noreferrer\">github.com/fangyidong/json-simple</a>. You could use it with Kotlin as well if you want (although the klaxon library that Jason Bourne suggested might be a better choice for Kotlin)."}, {"owner": {"reputation": 7544, "user_id": 73046, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/pWrkh.jpg?s=128&g=1", "display_name": "James Moore", "link": "https://stackoverflow.com/users/73046/james-moore"}, "edited": false, "score": 0, "creation_date": 1500688146, "post_id": 41928803, "comment_id": 77464584, "body": "Take a look at <a href=\"https://github.com/square/moshi/\" rel=\"nofollow noreferrer\">github.com/square/moshi</a>.  There&#39;s a blog post about it at <a href=\"https://medium.com/square-corner-blog/kotlins-a-great-language-for-json-fcd6ef99256b\" rel=\"nofollow noreferrer\">medium.com/square-corner-blog/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 14934, "user_id": 162410, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/97a472a751e503a7f8e5d88ba087a87c?s=128&d=identicon&r=PG", "display_name": "Cedric Beust", "link": "https://stackoverflow.com/users/162410/cedric-beust"}, "edited": false, "score": 125, "creation_date": 1485799145, "post_id": 41929124, "comment_id": 71064968, "body": "Author here, feel free to email me if you have questions/suggestions."}, {"owner": {"reputation": 13840, "user_id": 1177147, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/zHhAS.jpg?s=128&g=1", "display_name": "Mark Feldman", "link": "https://stackoverflow.com/users/1177147/mark-feldman"}, "reply_to_user": {"reputation": 14934, "user_id": 162410, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/97a472a751e503a7f8e5d88ba087a87c?s=128&d=identicon&r=PG", "display_name": "Cedric Beust", "link": "https://stackoverflow.com/users/162410/cedric-beust"}, "edited": false, "score": 0, "creation_date": 1600909659, "post_id": 41929124, "comment_id": 113240663, "body": "I tried this today after two days of stuffing around with other libraries, and it works really well. Polymorphic support and documentation look good too, after collections it&#39;s the second thing I always test. Great package @Cedric!"}, {"owner": {"reputation": 1161, "user_id": 11357623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a611daecc3bba56a19f7df44f93cb97?s=128&d=identicon&r=PG&f=1", "display_name": "AppDeveloper", "link": "https://stackoverflow.com/users/11357623/appdeveloper"}, "edited": false, "score": 0, "creation_date": 1607775629, "post_id": 41929124, "comment_id": 115381886, "body": "why use a library when built-in support is available?"}], "tags": [], "owner": {"reputation": 8571, "user_id": 5408958, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/94b63b134239ba86c5638ba72d4ba36b?s=128&d=identicon&r=PG", "display_name": "Istiak Morsalin", "link": "https://stackoverflow.com/users/5408958/istiak-morsalin"}, "is_accepted": true, "score": 86, "last_activity_date": 1485751310, "creation_date": 1485751310, "answer_id": 41929124, "question_id": 41928803, "link": "https://stackoverflow.com/questions/41928803/how-to-parse-json-in-kotlin/41929124#41929124", "title": "How to parse JSON in Kotlin?", "body": "<p>You can use this library  <a href=\"https://github.com/cbeust/klaxon\" rel=\"noreferrer\">https://github.com/cbeust/klaxon</a></p>\n\n<p>Klaxon is a lightweight library to parse JSON in Kotlin.</p>\n"}, {"comments": [{"owner": {"reputation": 4336, "user_id": 819651, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b3b2801b397b45b57b784c83b6274e22?s=128&d=identicon&r=PG", "display_name": "Lu&#237;s Soares", "link": "https://stackoverflow.com/users/819651/lu%c3%ads-soares"}, "edited": false, "score": 9, "creation_date": 1500718122, "post_id": 41943306, "comment_id": 77470689, "body": "what&#39;s the dependency?"}, {"owner": {"reputation": 297, "user_id": 7491121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438c4d6376b2e40ea9277e85712554d2?s=128&d=identicon&r=PG&f=1", "display_name": "markB", "link": "https://stackoverflow.com/users/7491121/markb"}, "reply_to_user": {"reputation": 4336, "user_id": 819651, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b3b2801b397b45b57b784c83b6274e22?s=128&d=identicon&r=PG", "display_name": "Lu&#237;s Soares", "link": "https://stackoverflow.com/users/819651/lu%c3%ads-soares"}, "edited": false, "score": 0, "creation_date": 1582283073, "post_id": 41943306, "comment_id": 106732522, "body": "I used org.json. Here&#39;s the link :   <a href=\"https://mvnrepository.com/artifact/org.json/json/20180813\" rel=\"nofollow noreferrer\">mvnrepository.com/artifact/org.json/json/20180813</a>"}, {"owner": {"reputation": 173, "user_id": 6902588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4606eecefbb5d50527ef17bf732c5f3?s=128&d=identicon&r=PG&f=1", "display_name": "leimenghao", "link": "https://stackoverflow.com/users/6902588/leimenghao"}, "edited": false, "score": 0, "creation_date": 1593596696, "post_id": 41943306, "comment_id": 110834159, "body": "This method requires that class must have default constructor without any params. What if data class have params in constructor like below:     <code>data class SomeClass(val param1: Int, val param2: Int)</code>."}, {"owner": {"reputation": 297, "user_id": 7491121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438c4d6376b2e40ea9277e85712554d2?s=128&d=identicon&r=PG&f=1", "display_name": "markB", "link": "https://stackoverflow.com/users/7491121/markb"}, "reply_to_user": {"reputation": 173, "user_id": 6902588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4606eecefbb5d50527ef17bf732c5f3?s=128&d=identicon&r=PG&f=1", "display_name": "leimenghao", "link": "https://stackoverflow.com/users/6902588/leimenghao"}, "edited": false, "score": 0, "creation_date": 1593694273, "post_id": 41943306, "comment_id": 110873621, "body": "@leimenghao You can do this in one line :   val categories = SomeClass(param1 = foodJson.getJSONObject(i).getString(&quot;FoodName&quot;),param2 = foodJson.getJSONObject(i).getInt(&quot;Weight&quot;))"}, {"owner": {"reputation": 2833, "user_id": 5717211, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-ITpsjwkYtqM/AAAAAAAAAAI/AAAAAAAAAls/igvfEae-_gg/photo.jpg?sz=128", "display_name": "Arnyminer Z", "link": "https://stackoverflow.com/users/5717211/arnyminer-z"}, "edited": false, "score": 0, "creation_date": 1595264275, "post_id": 41943306, "comment_id": 111408270, "body": "Works really well. Just to say, you can use <code>for (i in 0 until foodJson!!.length()) {</code> instead of <code>for (i in 0..foodJson!!.length() - 1) {</code>. It does the same, and it&#39;s quite more visual"}], "tags": [], "owner": {"reputation": 297, "user_id": 7491121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438c4d6376b2e40ea9277e85712554d2?s=128&d=identicon&r=PG&f=1", "display_name": "markB", "link": "https://stackoverflow.com/users/7491121/markb"}, "is_accepted": false, "score": 27, "last_activity_date": 1593694946, "last_edit_date": 1593694946, "creation_date": 1485802120, "answer_id": 41943306, "question_id": 41928803, "link": "https://stackoverflow.com/questions/41928803/how-to-parse-json-in-kotlin/41943306#41943306", "title": "How to parse JSON in Kotlin?", "body": "<p>Not sure if this is what you need but this is how I did it.</p>\n<p>Using import org.json.JSONObject :</p>\n<pre><code>    val jsonObj = JSONObject(json.substring(json.indexOf(&quot;{&quot;), json.lastIndexOf(&quot;}&quot;) + 1))\n    val foodJson = jsonObj.getJSONArray(&quot;Foods&quot;)\n    for (i in 0..foodJson!!.length() - 1) {\n        val categories = FoodCategoryObject()\n        val name = foodJson.getJSONObject(i).getString(&quot;FoodName&quot;)\n        categories.name = name\n    }\n</code></pre>\n<p>Here's a sample of the json :</p>\n<p>{&quot;Foods&quot;: [{&quot;FoodName&quot;: &quot;Apples&quot;,&quot;Weight&quot;: &quot;110&quot; } ]}</p>\n"}, {"comments": [{"owner": {"reputation": 191, "user_id": 2196785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81629e0395e419e4207e526c4b9e079a?s=128&d=identicon&r=PG", "display_name": "redsk", "link": "https://stackoverflow.com/users/2196785/redsk"}, "edited": false, "score": 1, "creation_date": 1544550589, "post_id": 42014863, "comment_id": 94313071, "body": "Differently from Klaxon (it had a bug when I tried), Jackson actually works :)"}, {"owner": {"reputation": 595, "user_id": 4044107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1eHNW.jpg?s=128&g=1", "display_name": "Brooks DuBois", "link": "https://stackoverflow.com/users/4044107/brooks-dubois"}, "edited": false, "score": 0, "creation_date": 1554220376, "post_id": 42014863, "comment_id": 97667917, "body": "Additionally, you can use the JSON to Kotlin data class plugin in intellij to generate the data classes for you."}], "tags": [], "owner": {"reputation": 131, "user_id": 7508801, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/ee06bed0249d860bab3f5d456cf5f781?s=128&d=identicon&r=PG", "display_name": "Neurf", "link": "https://stackoverflow.com/users/7508801/neurf"}, "is_accepted": false, "score": 13, "last_activity_date": 1537461879, "last_edit_date": 1537461879, "creation_date": 1486082099, "answer_id": 42014863, "question_id": 41928803, "link": "https://stackoverflow.com/questions/41928803/how-to-parse-json-in-kotlin/42014863#42014863", "title": "How to parse JSON in Kotlin?", "body": "<p>I personally use the Jackson module for Kotlin that you can find here: <a href=\"https://github.com/FasterXML/jackson-module-kotlin\" rel=\"noreferrer\">jackson-module-kotlin</a>. </p>\n\n<pre><code>implementation \"com.fasterxml.jackson.module:jackson-module-kotlin:$version\"\n</code></pre>\n\n<p>As an example, here is the code to parse the JSON of the Path of Exile skilltree which is quite heavy (84k lines when formatted) :</p>\n\n<p>Kotlin code:</p>\n\n<pre><code>package util\n\nimport com.fasterxml.jackson.databind.DeserializationFeature\nimport com.fasterxml.jackson.module.kotlin.*\nimport java.io.File\n\ndata class SkillTreeData( val characterData: Map&lt;String, CharacterData&gt;, val groups: Map&lt;String, Group&gt;, val root: Root,\n                          val nodes: List&lt;Node&gt;, val extraImages: Map&lt;String, ExtraImage&gt;, val min_x: Double,\n                          val min_y: Double, val max_x: Double, val max_y: Double,\n                          val assets: Map&lt;String, Map&lt;String, String&gt;&gt;, val constants: Constants, val imageRoot: String,\n                          val skillSprites: SkillSprites, val imageZoomLevels: List&lt;Int&gt; )\n\n\ndata class CharacterData( val base_str: Int, val base_dex: Int, val base_int: Int )\n\ndata class Group( val x: Double, val y: Double, val oo: Map&lt;String, Boolean&gt;?, val n: List&lt;Int&gt; )\n\ndata class Root( val g: Int, val o: Int, val oidx: Int, val sa: Int, val da: Int, val ia: Int, val out: List&lt;Int&gt; )\n\ndata class Node( val id: Int, val icon: String, val ks: Boolean, val not: Boolean, val dn: String, val m: Boolean,\n                 val isJewelSocket: Boolean, val isMultipleChoice: Boolean, val isMultipleChoiceOption: Boolean,\n                 val passivePointsGranted: Int, val flavourText: List&lt;String&gt;?, val ascendancyName: String?,\n                 val isAscendancyStart: Boolean?, val reminderText: List&lt;String&gt;?, val spc: List&lt;Int&gt;, val sd: List&lt;String&gt;,\n                 val g: Int, val o: Int, val oidx: Int, val sa: Int, val da: Int, val ia: Int, val out: List&lt;Int&gt; )\n\ndata class ExtraImage( val x: Double, val y: Double, val image: String )\n\ndata class Constants( val classes: Map&lt;String, Int&gt;, val characterAttributes: Map&lt;String, Int&gt;,\n                      val PSSCentreInnerRadius: Int )\n\ndata class SubSpriteCoords( val x: Int, val y: Int, val w: Int, val h: Int )\n\ndata class Sprite( val filename: String, val coords: Map&lt;String, SubSpriteCoords&gt; )\n\ndata class SkillSprites( val normalActive: List&lt;Sprite&gt;, val notableActive: List&lt;Sprite&gt;,\n                         val keystoneActive: List&lt;Sprite&gt;, val normalInactive: List&lt;Sprite&gt;,\n                         val notableInactive: List&lt;Sprite&gt;, val keystoneInactive: List&lt;Sprite&gt;,\n                         val mastery: List&lt;Sprite&gt; )\n\nprivate fun convert( jsonFile: File ) {\n    val mapper = jacksonObjectMapper()\n    mapper.configure( DeserializationFeature.ACCEPT_EMPTY_ARRAY_AS_NULL_OBJECT, true )\n\n    val skillTreeData = mapper.readValue&lt;SkillTreeData&gt;( jsonFile )\n    println(\"Conversion finished !\")\n}\n\nfun main( args : Array&lt;String&gt; ) {\n    val jsonFile: File = File( \"\"\"rawSkilltree.json\"\"\" )\n    convert( jsonFile )\n</code></pre>\n\n<p>JSON (not-formatted): <a href=\"http://filebin.ca/3B3reNQf3KXJ/rawSkilltree.json\" rel=\"noreferrer\">http://filebin.ca/3B3reNQf3KXJ/rawSkilltree.json</a></p>\n\n<p>Given your description, I believe it matches your needs.</p>\n"}, {"tags": [], "owner": {"reputation": 1834, "user_id": 3881947, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/0lhYF.jpg?s=128&g=1", "display_name": "Deepshikha Puri", "link": "https://stackoverflow.com/users/3881947/deepshikha-puri"}, "is_accepted": false, "score": -6, "last_activity_date": 1514888238, "last_edit_date": 1514888238, "creation_date": 1514887996, "answer_id": 48059038, "question_id": 41928803, "link": "https://stackoverflow.com/questions/41928803/how-to-parse-json-in-kotlin/48059038#48059038", "title": "How to parse JSON in Kotlin?", "body": "<p>Download the source of deme from here(<a href=\"http://deepshikhapuri.blogspot.in/2017/11/Jsonparsinginandroidkotlin.html\" rel=\"nofollow noreferrer\">Json parsing in android kotlin</a>)</p>\n\n<p>Add this dependency:</p>\n\n<pre><code>compile 'com.squareup.okhttp3:okhttp:3.8.1'\n</code></pre>\n\n<p>Call api function:</p>\n\n<pre><code> fun run(url: String) {\n    dialog.show()\n    val request = Request.Builder()\n            .url(url)\n            .build()\n\n    client.newCall(request).enqueue(object : Callback {\n        override fun onFailure(call: Call, e: IOException) {\n            dialog.dismiss()\n\n        }\n\n        override fun onResponse(call: Call, response: Response) {\n            var str_response = response.body()!!.string()\n            val json_contact:JSONObject = JSONObject(str_response)\n\n            var jsonarray_contacts:JSONArray= json_contact.getJSONArray(\"contacts\")\n\n            var i:Int = 0\n            var size:Int = jsonarray_contacts.length()\n\n            al_details= ArrayList();\n\n            for (i in 0.. size-1) {\n                var json_objectdetail:JSONObject=jsonarray_contacts.getJSONObject(i)\n\n\n                var model:Model= Model();\n                model.id=json_objectdetail.getString(\"id\")\n                model.name=json_objectdetail.getString(\"name\")\n                model.email=json_objectdetail.getString(\"email\")\n                model.address=json_objectdetail.getString(\"address\")\n                model.gender=json_objectdetail.getString(\"gender\")\n\n                al_details.add(model)\n\n\n            }\n\n            runOnUiThread {\n                //stuff that updates ui\n                val obj_adapter : CustomAdapter\n                obj_adapter = CustomAdapter(applicationContext,al_details)\n                lv_details.adapter=obj_adapter\n            }\n\n            dialog.dismiss()\n\n        }\n\n    })\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1217, "user_id": 5225435, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/iaj9R.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5225435/tom"}, "edited": false, "score": 0, "creation_date": 1548096558, "post_id": 48761937, "comment_id": 95412617, "body": "The plugin is not working for nested JSON objects at the moment."}, {"owner": {"reputation": 420, "user_id": 3738870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/190425893cffeaa9db58f472ef15b111?s=128&d=identicon&r=PG&f=1", "display_name": "user3738870", "link": "https://stackoverflow.com/users/3738870/user3738870"}, "edited": false, "score": 1, "creation_date": 1584783311, "post_id": 48761937, "comment_id": 107546393, "body": "The problem with Gson is that it disregards nullability. A <code>val</code> property can easily be <code>null</code> if it&#39;s missing from the JSON. Also, default values are not used at all."}, {"owner": {"reputation": 695, "user_id": 7500651, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Qgw3Q.jpg?s=128&g=1", "display_name": "ansh sachdeva", "link": "https://stackoverflow.com/users/7500651/ansh-sachdeva"}, "reply_to_user": {"reputation": 420, "user_id": 3738870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/190425893cffeaa9db58f472ef15b111?s=128&d=identicon&r=PG&f=1", "display_name": "user3738870", "link": "https://stackoverflow.com/users/3738870/user3738870"}, "edited": false, "score": 0, "creation_date": 1596724591, "post_id": 48761937, "comment_id": 111908336, "body": "@user3738870 did you find a better alternative? i am  frustrated by this behavior of every parser i try"}, {"owner": {"reputation": 420, "user_id": 3738870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/190425893cffeaa9db58f472ef15b111?s=128&d=identicon&r=PG&f=1", "display_name": "user3738870", "link": "https://stackoverflow.com/users/3738870/user3738870"}, "reply_to_user": {"reputation": 695, "user_id": 7500651, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Qgw3Q.jpg?s=128&g=1", "display_name": "ansh sachdeva", "link": "https://stackoverflow.com/users/7500651/ansh-sachdeva"}, "edited": false, "score": 0, "creation_date": 1596831287, "post_id": 48761937, "comment_id": 111947658, "body": "@anshsachdeva Yes, multiple ones, I found moshi the fastest and easiest to use. <a href=\"https://github.com/square/moshi\" rel=\"nofollow noreferrer\">github.com/square/moshi</a>"}], "tags": [], "owner": {"reputation": 7418, "user_id": 6852729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZgDLu.jpg?s=128&g=1", "display_name": "KeLiuyue", "link": "https://stackoverflow.com/users/6852729/keliuyue"}, "is_accepted": false, "score": 31, "last_activity_date": 1518508969, "last_edit_date": 1518508969, "creation_date": 1518508464, "answer_id": 48761937, "question_id": 41928803, "link": "https://stackoverflow.com/questions/41928803/how-to-parse-json-in-kotlin/48761937#48761937", "title": "How to parse JSON in Kotlin?", "body": "<p>You can use <code>Gson</code> .</p>\n\n<h2><strong>Example</strong></h2>\n\n<p><strong>Step 1</strong></p>\n\n<p>Add compile </p>\n\n<pre><code>compile 'com.google.code.gson:gson:2.8.2'\n</code></pre>\n\n<p><strong>Step 2</strong></p>\n\n<p>Convert json to <code>Kotlin Bean</code>(use <a href=\"https://github.com/wuseal/JsonToKotlinClass\" rel=\"noreferrer\">JsonToKotlinClass</a>)</p>\n\n<p>Like this </p>\n\n<p><code>Json</code> data</p>\n\n<pre><code>{\n\"timestamp\": \"2018-02-13 15:45:45\",\n\"code\": \"OK\",\n\"message\": \"user info\",\n\"path\": \"/user/info\",\n\"data\": {\n    \"userId\": 8,\n    \"avatar\": \"/uploads/image/20180115/1516009286213053126.jpeg\",\n    \"nickname\": \"\",\n    \"gender\": 0,\n    \"birthday\": 1525968000000,\n    \"age\": 0,\n    \"province\": \"\",\n    \"city\": \"\",\n    \"district\": \"\",\n    \"workStatus\": \"Student\",\n    \"userType\": 0\n},\n\"errorDetail\": null\n}\n</code></pre>\n\n<p><code>Kotlin Bean</code></p>\n\n<pre><code>class MineUserEntity {\n\n    data class MineUserInfo(\n        val timestamp: String,\n        val code: String,\n        val message: String,\n        val path: String,\n        val data: Data,\n        val errorDetail: Any\n    )\n\n    data class Data(\n        val userId: Int,\n        val avatar: String,\n        val nickname: String,\n        val gender: Int,\n        val birthday: Long,\n        val age: Int,\n        val province: String,\n        val city: String,\n        val district: String,\n        val workStatus: String,\n        val userType: Int\n    )\n}\n</code></pre>\n\n<p><strong>Step 3</strong></p>\n\n<p>Use <code>Gson</code></p>\n\n<pre><code>var gson = Gson()\nvar mMineUserEntity = gson?.fromJson(response, MineUserEntity.MineUserInfo::class.java)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 810, "user_id": 685476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab260c3f2bbba367281db5d9f67964e7?s=128&d=identicon&r=PG", "display_name": "natronite", "link": "https://stackoverflow.com/users/685476/natronite"}, "edited": false, "score": 3, "creation_date": 1576218837, "post_id": 48904120, "comment_id": 104835356, "body": "The problem I have with this is that you can hardly use it with generics. At least I have not figured out how to do so. And I certainly don&#39;t want to use reflection."}, {"owner": {"reputation": 4717, "user_id": 1990785, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/30ed15227ce48259bd51b3b1e515e81c?s=128&d=identicon&r=PG&f=1", "display_name": "Pragmatic geek", "link": "https://stackoverflow.com/users/1990785/pragmatic-geek"}, "edited": false, "score": 3, "creation_date": 1588543586, "post_id": 48904120, "comment_id": 108932300, "body": "KotlinX Serialization is still in experimental phase, so they introduce breaking changes in new releases. Also, it&#39;s not thread-safe, so your JSON might get corrupted if several threads try to use a single instance of <code>Json</code> (it&#39;s common). Furthermore, there are several open Github issues with the bug label. So, it&#39;s still risky for use in production I would say (unless you&#39;re willing to spend time on fixing potential issues and do not plan to update it frequently). The project is indeed interesting especially for Kotlin Multiplatform projects, but it&#39;s not stable yet."}, {"owner": {"reputation": 4427, "user_id": 2111778, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vP0ug.jpg?s=128&g=1", "display_name": "xjcl", "link": "https://stackoverflow.com/users/2111778/xjcl"}, "edited": false, "score": 0, "creation_date": 1590186429, "post_id": 48904120, "comment_id": 109595974, "body": "There seems to already be a breaking change, JSON is now called Json"}, {"owner": {"reputation": 4427, "user_id": 2111778, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vP0ug.jpg?s=128&g=1", "display_name": "xjcl", "link": "https://stackoverflow.com/users/2111778/xjcl"}, "edited": false, "score": 0, "creation_date": 1590186457, "post_id": 48904120, "comment_id": 109595981, "body": "This also requires an additional dependency, so do follow the link for a guide"}, {"owner": {"reputation": 134, "user_id": 768217, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4d727b253d7f9683aa478fcf0c88ea0e?s=128&d=identicon&r=PG", "display_name": "TimCO", "link": "https://stackoverflow.com/users/768217/timco"}, "edited": false, "score": 0, "creation_date": 1601602415, "post_id": 48904120, "comment_id": 113465254, "body": "2020 Sept and this is still at RC2, no 1.0 version yet :-("}, {"owner": {"reputation": 174, "user_id": 7507215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EmkH8.png?s=128&g=1", "display_name": "fisio", "link": "https://stackoverflow.com/users/7507215/fisio"}, "edited": false, "score": 5, "creation_date": 1602500355, "post_id": 48904120, "comment_id": 113730632, "body": "Finally 1.0 is out! Here same examples: <a href=\"Https://blog.jetbrains.com/kotlin/2020/10/kotlinx-serialization-1-0-released/\" rel=\"nofollow noreferrer\">Https://blog.jetbrains.com/kotlin/2020/10/&hellip;</a>"}, {"owner": {"reputation": 221, "user_id": 5266245, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s046s7He4TY/AAAAAAAAAAI/AAAAAAAAAOw/OHHBHRbYwRs/photo.jpg?sz=128", "display_name": "Arash Kamangir", "link": "https://stackoverflow.com/users/5266245/arash-kamangir"}, "edited": false, "score": 0, "creation_date": 1611257018, "post_id": 48904120, "comment_id": 116399916, "body": "See the kotlinx.serialization enhanced documentation on GitHub: <a href=\"https://github.com/Kotlin/kotlinx.serialization/blob/master/docs/basic-serialization.md\" rel=\"nofollow noreferrer\">github.com/Kotlin/kotlinx.serialization/blob/master/docs/&hellip;</a>"}, {"owner": {"reputation": 1155, "user_id": 6491200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ee9f07ba539cbd424db19acf116ce83?s=128&d=identicon&r=PG", "display_name": "Caio Santos", "link": "https://stackoverflow.com/users/6491200/caio-santos"}, "edited": false, "score": 1, "creation_date": 1618862569, "post_id": 48904120, "comment_id": 118726725, "body": "<a href=\"https://kotlinlang.org/docs/releases.html\" rel=\"nofollow noreferrer\">kotlinlang.org/docs/releases.html</a> shows this plugin many times. It seems to be the best way to work with json in Kotlin."}], "tags": [], "owner": {"reputation": 1655, "user_id": 2425529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/155420b7462c19e05695c43f998c3451?s=128&d=identicon&r=PG", "display_name": "Elisha Sterngold", "link": "https://stackoverflow.com/users/2425529/elisha-sterngold"}, "is_accepted": false, "score": 123, "last_activity_date": 1602600056, "last_edit_date": 1602600056, "creation_date": 1519210568, "answer_id": 48904120, "question_id": 41928803, "link": "https://stackoverflow.com/questions/41928803/how-to-parse-json-in-kotlin/48904120#48904120", "title": "How to parse JSON in Kotlin?", "body": "<p>There is no question that the future of parsing in Kotlin will be with kotlinx.serialization. It is part of Kotlin libraries. Version kotlinx.serialization 1.0 is finally released</p>\n<p><a href=\"https://github.com/Kotlin/kotlinx.serialization\" rel=\"noreferrer\">https://github.com/Kotlin/kotlinx.serialization</a></p>\n<pre><code>import kotlinx.serialization.*\nimport kotlinx.serialization.json.JSON\n\n@Serializable\ndata class MyModel(val a: Int, @Optional val b: String = &quot;42&quot;)\n\nfun main(args: Array&lt;String&gt;) {\n\n    // serializing objects\n    val jsonData = JSON.stringify(MyModel.serializer(), MyModel(42))\n    println(jsonData) // {&quot;a&quot;: 42, &quot;b&quot;: &quot;42&quot;}\n    \n    // serializing lists\n    val jsonList = JSON.stringify(MyModel.serializer().list, listOf(MyModel(42)))\n    println(jsonList) // [{&quot;a&quot;: 42, &quot;b&quot;: &quot;42&quot;}]\n\n    // parsing data back\n    val obj = JSON.parse(MyModel.serializer(), &quot;&quot;&quot;{&quot;a&quot;:42}&quot;&quot;&quot;)\n    println(obj) // MyModel(a=42, b=&quot;42&quot;)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7571, "user_id": 4578513, "user_type": "registered", "accept_rate": 15, "profile_image": "https://i.stack.imgur.com/mUo1D.jpg?s=128&g=1", "display_name": "Developine", "link": "https://stackoverflow.com/users/4578513/developine"}, "is_accepted": false, "score": 4, "last_activity_date": 1527836871, "last_edit_date": 1527836871, "creation_date": 1525419287, "answer_id": 50169585, "question_id": 41928803, "link": "https://stackoverflow.com/questions/41928803/how-to-parse-json-in-kotlin/50169585#50169585", "title": "How to parse JSON in Kotlin?", "body": "<p>First of all.</p>\n\n<p>You can use JSON to Kotlin Data class converter plugin in Android Studio for JSON mapping to POJO classes (kotlin data class).\nThis plugin will annotate your Kotlin data class according to JSON.</p>\n\n<p>Then you can use GSON converter to convert JSON to Kotlin.</p>\n\n<p>Follow this Complete tutorial:\n<a href=\"http://developine.com/kotlin-android-json-parsing-tutorial-retrofit/\" rel=\"nofollow noreferrer\">Kotlin Android JSON Parsing Tutorial </a></p>\n\n<p>If you want to parse json manually.</p>\n\n<pre><code>val **sampleJson** = \"\"\"\n  [\n  {\n   \"userId\": 1,\n   \"id\": 1,\n   \"title\": \"sunt aut facere repellat provident occaecati excepturi optio \n    reprehenderit\",\n    \"body\": \"quia et suscipit\\nsuscipit recusandae consequuntur expedita\"\n   }]\n   \"\"\"\n</code></pre>\n\n<p>Code to Parse above JSON Array and its object at index 0.</p>\n\n<pre><code>var jsonArray = JSONArray(sampleJson)\nfor (jsonIndex in 0..(jsonArray.length() - 1)) {\nLog.d(\"JSON\", jsonArray.getJSONObject(jsonIndex).getString(\"title\"))\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7347, "user_id": 172274, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/886b1c9637f9742ff1074d6605a6df7e?s=128&d=identicon&r=PG", "display_name": "still_dreaming_1", "link": "https://stackoverflow.com/users/172274/still-dreaming-1"}, "edited": false, "score": 3, "creation_date": 1563123581, "post_id": 50468095, "comment_id": 100587823, "body": "So if this does not require any external libraries, that should mean org.json.JSONObject is part of the standard library right?"}, {"owner": {"reputation": 3796, "user_id": 1679768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HpyNj.png?s=128&g=1", "display_name": "frouo", "link": "https://stackoverflow.com/users/1679768/frouo"}, "reply_to_user": {"reputation": 7347, "user_id": 172274, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/886b1c9637f9742ff1074d6605a6df7e?s=128&d=identicon&r=PG", "display_name": "still_dreaming_1", "link": "https://stackoverflow.com/users/172274/still-dreaming-1"}, "edited": false, "score": 1, "creation_date": 1563263291, "post_id": 50468095, "comment_id": 100631166, "body": "@still_dreaming_1 yes it is, &quot;Added in API level 1&quot;, cf. <a href=\"https://developer.android.com/reference/org/json/JSONObject.html\" rel=\"nofollow noreferrer\">developer.android.com/reference/org/json/JSONObject.html</a>"}, {"owner": {"reputation": 7347, "user_id": 172274, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/886b1c9637f9742ff1074d6605a6df7e?s=128&d=identicon&r=PG", "display_name": "still_dreaming_1", "link": "https://stackoverflow.com/users/172274/still-dreaming-1"}, "edited": false, "score": 0, "creation_date": 1563281657, "post_id": 50468095, "comment_id": 100641081, "body": "I guess it&#39;s an Android thing? I was looking for it in the Kotlin or Java standard library for the JVM."}, {"owner": {"reputation": 3796, "user_id": 1679768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HpyNj.png?s=128&g=1", "display_name": "frouo", "link": "https://stackoverflow.com/users/1679768/frouo"}, "reply_to_user": {"reputation": 7347, "user_id": 172274, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/886b1c9637f9742ff1074d6605a6df7e?s=128&d=identicon&r=PG", "display_name": "still_dreaming_1", "link": "https://stackoverflow.com/users/172274/still-dreaming-1"}, "edited": false, "score": 0, "creation_date": 1563290852, "post_id": 50468095, "comment_id": 100646930, "body": "Oh yes absolutely, I am sorry I forgot to mention that in the answer! Maybe you could use <code>JsonObject</code> if your JVM is running under Java7 (<a href=\"https://docs.oracle.com/javaee/7/api/javax/json/JsonObject.html\" rel=\"nofollow noreferrer\">docs.oracle.com/javaee/7/api/javax/json/JsonObject.html</a>)?"}, {"owner": {"reputation": 829, "user_id": 1985786, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/QoiA3.jpg?s=128&g=1", "display_name": "Cao Dongping", "link": "https://stackoverflow.com/users/1985786/cao-dongping"}, "edited": false, "score": 0, "creation_date": 1577774318, "post_id": 50468095, "comment_id": 105250313, "body": "It must have a performance problem since you re-parsed JSONObject for every key."}], "tags": [], "owner": {"reputation": 3796, "user_id": 1679768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HpyNj.png?s=128&g=1", "display_name": "frouo", "link": "https://stackoverflow.com/users/1679768/frouo"}, "is_accepted": false, "score": 41, "last_activity_date": 1563291885, "last_edit_date": 1592644375, "creation_date": 1526993157, "answer_id": 50468095, "question_id": 41928803, "link": "https://stackoverflow.com/questions/41928803/how-to-parse-json-in-kotlin/50468095#50468095", "title": "How to parse JSON in Kotlin?", "body": "<h1>Without external library (on Android)</h1>\n<p>To parse this:</p>\n<pre><code>val jsonString = &quot;&quot;&quot;\n    {\n       &quot;type&quot;:&quot;Foo&quot;,\n       &quot;data&quot;:[\n          {\n             &quot;id&quot;:1,\n             &quot;title&quot;:&quot;Hello&quot;\n          },\n          {\n             &quot;id&quot;:2,\n             &quot;title&quot;:&quot;World&quot;\n          }\n       ]\n    }        \n&quot;&quot;&quot;\n</code></pre>\n<p>Use these classes:</p>\n<pre><code>import org.json.JSONObject\n\nclass Response(json: String) : JSONObject(json) {\n    val type: String? = this.optString(&quot;type&quot;)\n    val data = this.optJSONArray(&quot;data&quot;)\n            ?.let { 0.until(it.length()).map { i -&gt; it.optJSONObject(i) } } // returns an array of JSONObject\n            ?.map { Foo(it.toString()) } // transforms each JSONObject of the array into Foo\n}\n\nclass Foo(json: String) : JSONObject(json) {\n    val id = this.optInt(&quot;id&quot;)\n    val title: String? = this.optString(&quot;title&quot;)\n}\n</code></pre>\n<p>Usage:</p>\n<pre><code>val foos = Response(jsonString)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16055, "user_id": 2914140, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Ik94c.jpg?s=128&g=1", "display_name": "CoolMind", "link": "https://stackoverflow.com/users/2914140/coolmind"}, "edited": false, "score": 1, "creation_date": 1545827033, "post_id": 51043981, "comment_id": 94704469, "body": "It will convert to Java."}], "tags": [], "owner": {"reputation": 634, "user_id": 4273971, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yD7-VAHCPj0/AAAAAAAAAAI/AAAAAAAAAHs/ViQcsoD7ehI/photo.jpg?sz=128", "display_name": "kundan kamal", "link": "https://stackoverflow.com/users/4273971/kundan-kamal"}, "is_accepted": false, "score": 1, "last_activity_date": 1530019309, "creation_date": 1530019309, "answer_id": 51043981, "question_id": 41928803, "link": "https://stackoverflow.com/questions/41928803/how-to-parse-json-in-kotlin/51043981#51043981", "title": "How to parse JSON in Kotlin?", "body": "<p><a href=\"http://www.jsonschema2pojo.org/\" rel=\"nofollow noreferrer\">http://www.jsonschema2pojo.org/</a>\n  Hi you can use this website to convert json to pojo.<br>\n  control+Alt+shift+k    </p>\n\n<p>After that you can manualy convert that model class to kotlin model class. with                       the help of above  shortcut.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 10697251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/74B3T.jpg?s=128&g=1", "display_name": "Facundo Garcia", "link": "https://stackoverflow.com/users/10697251/facundo-garcia"}, "is_accepted": false, "score": 1, "last_activity_date": 1599895305, "last_edit_date": 1599895305, "creation_date": 1543008925, "answer_id": 53453177, "question_id": 41928803, "link": "https://stackoverflow.com/questions/41928803/how-to-parse-json-in-kotlin/53453177#53453177", "title": "How to parse JSON in Kotlin?", "body": "<p>A bit late, but whatever.</p>\n<p>If you prefer parsing JSON to JavaScript-like constructs making use of Kotlin syntax, I recommend <a href=\"https://github.com/zogar1993/jsonkraken\" rel=\"nofollow noreferrer\">JSONKraken</a>, of which I am the author.</p>\n<p>Suggestions and opinions on the matter are much apreciated!</p>\n"}, {"tags": [], "owner": {"reputation": 16055, "user_id": 2914140, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Ik94c.jpg?s=128&g=1", "display_name": "CoolMind", "link": "https://stackoverflow.com/users/2914140/coolmind"}, "is_accepted": false, "score": 7, "last_activity_date": 1552634057, "last_edit_date": 1552634057, "creation_date": 1545827822, "answer_id": 53932221, "question_id": 41928803, "link": "https://stackoverflow.com/questions/41928803/how-to-parse-json-in-kotlin/53932221#53932221", "title": "How to parse JSON in Kotlin?", "body": "<p>To convert JSON to Kotlin use <a href=\"http://www.json2kotlin.com/\" rel=\"noreferrer\">http://www.json2kotlin.com/</a></p>\n\n<p>Also you can use Android Studio plugin. File > Settings, select <code>Plugins</code> in left tree, press \"Browse repositories...\", search \"<strong>JsonToKotlinClass</strong>\", select it and click green button \"Install\".</p>\n\n<p><a href=\"https://i.stack.imgur.com/2XAXG.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/2XAXG.png\" alt=\"plugin\"></a></p>\n\n<p>After AS restart you can use it. You can create a class with <code>File &gt; New &gt; JSON To Kotlin Class (JsonToKotlinClass)</code>. Another way is to press Alt + K.</p>\n\n<p><a href=\"https://i.stack.imgur.com/fdivg.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/fdivg.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then you will see a dialog to paste JSON.</p>\n\n<p>In 2018 I had to add <code>package com.my.package_name</code> at the beginning of a class.</p>\n"}, {"tags": [], "owner": {"reputation": 4427, "user_id": 2111778, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vP0ug.jpg?s=128&g=1", "display_name": "xjcl", "link": "https://stackoverflow.com/users/2111778/xjcl"}, "is_accepted": false, "score": 4, "last_activity_date": 1599694082, "last_edit_date": 1599694082, "creation_date": 1599693596, "answer_id": 63820753, "question_id": 41928803, "link": "https://stackoverflow.com/questions/41928803/how-to-parse-json-in-kotlin/63820753#63820753", "title": "How to parse JSON in Kotlin?", "body": "<p>This uses <code>kotlinx.serialization</code> like <a href=\"https://stackoverflow.com/a/48904120/2111778\">Elisha's answer</a>. Meanwhile the API is being stabilized for the upcoming 1.0 release. Note that e.g. <code>JSON.parse</code> was renamed to <code>Json.parse</code> and is now <code>Json.decodeFromString</code>. Also it is imported in gradle <a href=\"https://github.com/Kotlin/kotlinx.serialization#setup\" rel=\"nofollow noreferrer\">differently</a> starting in Kotlin 1.4.0:</p>\n<pre><code>dependencies {\n    implementation &quot;org.jetbrains.kotlinx:kotlinx-serialization-core:1.0.0-RC&quot;\n}\napply plugin: 'kotlinx-serialization'\n</code></pre>\n<p>Example usage:</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>@Serializable\ndata class Properties(val nid: Int, val tid: Int)\n@Serializable\ndata class Feature(val pos: List&lt;Double&gt;, val properties: Properties? = null, \n    val count: Int? = null)\n@Serializable\ndata class Root(val features: List&lt;Feature&gt;)\n\n\nval root = Json.decodeFromString&lt;Root&gt;(jsonStr)\nval rootAlt = Json.decodeFromString(Root.serializer(), jsonStr)  // equivalent\n\nval str = Json.encodeToString(root)  // type 'Root' can be inferred!\n\n// For a *top-level* list (does not apply in my case) you would use \nval fList = Json.decodeFromString&lt;List&lt;Feature&gt;&gt;(jsonStr)\nval fListAlt = Json.decodeFromString(ListSerializer(Feature.serializer()), jsonStr)\n</code></pre>\n<p>Kotlin's <code>data class</code> defines a class that mainly holds data and has <code>.toString()</code> and other methods (e.g. destructuring declarations) automatically defined. I'm using nullable (<code>?</code>) types here for optional fields.</p>\n"}, {"tags": [], "owner": {"reputation": 823, "user_id": 8110255, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4892943fd9da72dca457cd2f56eb3ed1?s=128&d=identicon&r=PG", "display_name": "iamanbansal", "link": "https://stackoverflow.com/users/8110255/iamanbansal"}, "is_accepted": false, "score": 0, "last_activity_date": 1601879578, "creation_date": 1601879578, "answer_id": 64203455, "question_id": 41928803, "link": "https://stackoverflow.com/questions/41928803/how-to-parse-json-in-kotlin/64203455#64203455", "title": "How to parse JSON in Kotlin?", "body": "<h1>Kotin Seriazation</h1>\n<p>Kotlin specific library by Jetbrains for all supported platforms \u2013 Android, JVM, JavaScript, Native</p>\n<p><a href=\"https://github.com/Kotlin/kotlinx.serialization\" rel=\"nofollow noreferrer\">https://github.com/Kotlin/kotlinx.serialization</a></p>\n<h1>Moshi</h1>\n<p>Moshi is a JSON library for Android and Java by  Square.</p>\n<p><a href=\"https://github.com/square/moshi\" rel=\"nofollow noreferrer\">https://github.com/square/moshi</a></p>\n<h1>Jackson</h1>\n<p><a href=\"https://github.com/FasterXML/jackson\" rel=\"nofollow noreferrer\">https://github.com/FasterXML/jackson</a></p>\n<h1>Gson</h1>\n<p>Most popular but almost <em><strong>deprecated</strong></em></p>\n<p><a href=\"https://github.com/google/gson\" rel=\"nofollow noreferrer\">https://github.com/google/gson</a></p>\n<h1>JSON to Java</h1>\n<p><a href=\"http://www.jsonschema2pojo.org/\" rel=\"nofollow noreferrer\">http://www.jsonschema2pojo.org/</a></p>\n<h1>JSON to Kotlin</h1>\n<p>IntelliJ plugin - <a href=\"https://plugins.jetbrains.com/plugin/9960-json-to-kotlin-class-jsontokotlinclass-\" rel=\"nofollow noreferrer\">https://plugins.jetbrains.com/plugin/9960-json-to-kotlin-class-jsontokotlinclass-</a></p>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 3879338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a355582a5dcc67a6be44486775d713?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Kogan", "link": "https://stackoverflow.com/users/3879338/anton-kogan"}, "is_accepted": false, "score": -1, "last_activity_date": 1605860464, "last_edit_date": 1605860464, "creation_date": 1602232691, "answer_id": 64276627, "question_id": 41928803, "link": "https://stackoverflow.com/questions/41928803/how-to-parse-json-in-kotlin/64276627#64276627", "title": "How to parse JSON in Kotlin?", "body": "<p>i am using my custom implementation in kotlin:</p>\n<pre><code>/**\n * Created by Anton Kogan on 10/9/2020\n */\nobject JsonParser {\n\n    val TAG = &quot;JsonParser&quot;\n    /**\n * parse json object\n * @param objJson\n * @param include - all  keys, that you want to display\n * @return  Map&lt;String, String&gt;\n * @throws JSONException\n */\n    @Throws(JSONException::class)\n    fun parseJson(objJson: Any?, map :HashMap&lt;String, String&gt;, include : Array&lt;String&gt;?): Map&lt;String, String&gt; {\n        // If obj is a json array\n        if (objJson is JSONArray) {\n            for (i in 0 until objJson.length()) {\n                parseJson(objJson[i], map, include)\n            }\n        } else if (objJson is JSONObject) {\n            val it: Iterator&lt;*&gt; = objJson.keys()\n            while (it.hasNext()) {\n                val key = it.next().toString()\n                // If you get an array\n                when (val jobject = objJson[key]) {\n                    is JSONArray -&gt; {\n                        Log.e(TAG, &quot; JSONArray: $jobject&quot;)\n                        parseJson(\n                            jobject, map, include\n                        )\n                    }\n                    is JSONObject -&gt; {\n                        Log.e(TAG, &quot; JSONObject: $jobject&quot;)\n                        parseJson(\n                            jobject, map, include\n                        )\n                    }\n                    else -&gt; {\n//\n                        if(include == null || include.contains(key)) // here is check for include param\n                        {\n                            map[key] = jobject.toString()\n                            Log.e(TAG, &quot; adding to map: $key $jobject&quot;)\n                        }\n                    }\n                }\n            }\n        }\n        return map\n    }\n\n    /**\n     * parse json object\n     * @param objJson\n     * @param include - all  keys, that you want to display\n     * @return  Map&lt;String, String&gt;\n     * @throws JSONException\n     */\n    @Throws(JSONException::class)\n    fun parseJson(objJson: Any?, map :HashMap&lt;String, String&gt;): Map&lt;String, String&gt; {\n        return parseJson(objJson, map, null)\n    }\n}\n</code></pre>\n<p>You can use it like:</p>\n<pre><code>    val include= arrayOf(\n        &quot;atHome&quot;,//JSONArray\n        &quot;cat&quot;,\n        &quot;dog&quot;,\n        &quot;persons&quot;,//JSONArray\n        &quot;man&quot;,\n        &quot;woman&quot;\n    )\n    JsonParser.parseJson(jsonObject, map, include)\n    val linearContent: LinearLayout = taskInfoFragmentBinding.infoContainer\n</code></pre>\n<p>here is some useful links:</p>\n<p>json parsing :</p>\n<p>plugin:\n<a href=\"https://plugins.jetbrains.com/plugin/9960-json-to-kotlin-class-jsontokotlinclass-\" rel=\"nofollow noreferrer\">https://plugins.jetbrains.com/plugin/9960-json-to-kotlin-class-jsontokotlinclass-</a></p>\n<p>create POJOs  from json:\n<a href=\"https://codebeautify.org/jsonviewer\" rel=\"nofollow noreferrer\">https://codebeautify.org/jsonviewer</a></p>\n<p>Retrofit:\n<a href=\"https://square.github.io/retrofit/\" rel=\"nofollow noreferrer\">https://square.github.io/retrofit/</a></p>\n<p>Gson:\n<a href=\"https://github.com/google/gson\" rel=\"nofollow noreferrer\">https://github.com/google/gson</a></p>\n"}, {"tags": [], "owner": {"reputation": 1098, "user_id": 5646794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q8nBm.jpg?s=128&g=1", "display_name": "Touhid", "link": "https://stackoverflow.com/users/5646794/touhid"}, "is_accepted": false, "score": 5, "last_activity_date": 1603878788, "creation_date": 1603878788, "answer_id": 64570340, "question_id": 41928803, "link": "https://stackoverflow.com/questions/41928803/how-to-parse-json-in-kotlin/64570340#64570340", "title": "How to parse JSON in Kotlin?", "body": "<p>GSON is a good choice for Android and Web platform to parse JSON in a Kotlin project. This library is developed by Google.\n<a href=\"https://github.com/google/gson\" rel=\"noreferrer\">https://github.com/google/gson</a></p>\n<p><strong>1. First add GSON to your project:</strong></p>\n<pre><code>dependencies {\n   implementation 'com.google.code.gson:gson:2.8.6'\n}\n</code></pre>\n<p><strong>2. Now you need to convert your JSON to Kotlin Data class:</strong></p>\n<p>Copy your JSON and go to this(<a href=\"https://json2kt.com\" rel=\"noreferrer\">https://json2kt.com</a>) website and paste your JSON to Input Json box. Write package(ex: com.example.appName) and Class name(ex: UserData) in proper box. This site will show live preview of your data class below and also you can download all classes at once in a zip file.</p>\n<p>After downloading all classes extract zip file &amp; place them into your project.</p>\n<p><strong>3. Now Parse like below:</strong></p>\n<pre><code>val myJson = &quot;&quot;&quot;\n{\n    &quot;user_name&quot;: &quot;john123&quot;,\n    &quot;email&quot;: &quot;john@example.com&quot;,\n    &quot;name&quot;: &quot;John Doe&quot;\n}\n&quot;&quot;&quot;.trimIndent()\n\nval gson = Gson()\nvar mUser = gson.fromJson(myJson, UserData::class.java)\nprintln(mUser.userName)\n</code></pre>\n<p>Done :)</p>\n"}], "owner": {"reputation": 2463, "user_id": 3243124, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/e6526d2b3a6432d8d50ecc8ce6e7305f?s=128&d=identicon&r=PG&f=1", "display_name": "AJ_1310", "link": "https://stackoverflow.com/users/3243124/aj-1310"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268745, "favorite_count": 25, "accepted_answer_id": 41929124, "answer_count": 15, "score": 153, "last_activity_date": 1611257035, "creation_date": 1485748608, "last_edit_date": 1485750693, "question_id": 41928803, "link": "https://stackoverflow.com/questions/41928803/how-to-parse-json-in-kotlin", "title": "How to parse JSON in Kotlin?", "body": "<p>I'm receiving a quite deep JSON object string from a service which I must parse to a JSON object and then map it to classes.</p>\n\n<p>How can I transform a JSON string to object in Kotlin?</p>\n\n<p>After that the mapping to the respective classes, I was using StdDeserializer from Jackson. The problem arises at the moment the object had properties that also had to be deserialized into classes. I was not able to get the object mapper, at least I didn't know how, inside another deserializer.</p>\n\n<p>Thanks in advance for any help. Preferably, natively, I'm trying to reduce the number of dependencies I need so if the answer is only for JSON manipulation and parsing it'd be enough.</p>\n"}, {"tags": ["java", "android", "database", "realm", "kotlin"], "answers": [{"tags": [], "owner": {"reputation": 70518, "user_id": 2413303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kLhXq.jpg?s=128&g=1", "display_name": "EpicPandaForce", "link": "https://stackoverflow.com/users/2413303/epicpandaforce"}, "is_accepted": true, "score": 1, "last_activity_date": 1485729159, "last_edit_date": 1495541804, "creation_date": 1485729159, "answer_id": 41926710, "question_id": 41924862, "link": "https://stackoverflow.com/questions/41924862/realm-returning-stale-data/41926710#41926710", "title": "Realm returning stale data", "body": "<p>That's because </p>\n\n<pre><code>// This function simply stores a Realm model for all the data that has been uploaded to the server\nprivate fun markDataAsUploaded(dataToUpload: List&lt;CallLog&gt;) {\n    realm = Realm.getDefaultInstance()\n    for (data in dataToUpload) {\n        realm.beginTransaction()\n        val callLogUploaded = realm.createObject(CallLogUploaded::class.java)\n        callLogUploaded.callDate = data.callDate\n\n        realm.commitTransaction()\n    }\n}\n</code></pre>\n\n<p>This method has <a href=\"https://medium.com/@Zhuinden/how-to-use-realm-for-android-like-a-champ-and-how-to-tell-if-youre-doing-it-wrong-ac4f66b7f149\" rel=\"nofollow noreferrer\">quite a few errors that I had written about a long time ago</a> </p>\n\n<ul>\n<li><p>The Realm instance is opened, but never closed</p></li>\n<li><p>There is a new transaction per every element, rather than inserting all elements in a single transaction</p></li>\n</ul>\n\n<p>If you don't close the Realm instance (each instance requires its own <code>close()</code> call), then your Realm instance will never update unless you actually begin a transaction and do things inside the transaction.</p>\n\n<p>You have three solutions:</p>\n\n<p>1.) do your logic on the background thread inside a transaction, if there is nothing to be done, then cancel the transaction - queries made in transactions are never stale</p>\n\n<p>2.) make sure the Realm instance is closed properly (although this is definitely a necessity on any non-autoupdating thread)</p>\n\n<p>3.) a hacky solution is to call <a href=\"https://stackoverflow.com/a/38839808/2413303\"><code>RealmRefresh.refreshRealm()</code> after <code>getDefaultInstance()</code> according to my answer on Stack Overflow which relies on package-private API, but it works to solve this issue</a></p>\n\n<hr>\n\n<p>Typically you need to open the Realm instance at the beginning of the thread, and close it at the end of the thread.</p>\n\n<p>so, it's basically one big <code>try(Realm realm = Realm.getDefaultInstance() { ... }</code> for <code>onHandleIntent()</code>.</p>\n\n<hr>\n\n<p><code>enqueue(new Callback() { @Override public void onSuccess(..) {...}</code> runs on the UI thread. To run it on the current thread, you should use <code>call.execute()</code>.</p>\n\n<hr>\n\n<p>instead of</p>\n\n<pre><code>for (data in dataToUpload) {\n    realm.beginTransaction()\n    val callLogUploaded = realm.createObject(CallLogUploaded::class.java)\n    callLogUploaded.callDate = data.callDate\n\n    realm.commitTransaction()\n}\n</code></pre>\n\n<p>do</p>\n\n<pre><code>realm.beginTransaction()\nfor (data in dataToUpload) {\n    val callLogUploaded = realm.createObject(CallLogUploaded::class.java)\n    callLogUploaded.callDate = data.callDate\n}\nrealm.commitTransaction()\n</code></pre>\n\n<hr>\n\n<p>In order to understand about version retention you can read <a href=\"https://medium.com/@Zhuinden/understanding-realm-version-retention-and-synchronization-9a513c2445bb\" rel=\"nofollow noreferrer\">https://medium.com/@Zhuinden/understanding-realm-version-retention-and-synchronization-9a513c2445bb</a> .</p>\n"}], "owner": {"reputation": 6789, "user_id": 647897, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4b3454aaf296c3ff8c67249d84e752bc?s=128&d=identicon&r=PG", "display_name": "Bo Milanovich", "link": "https://stackoverflow.com/users/647897/bo-milanovich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "accepted_answer_id": 41926710, "answer_count": 1, "score": 1, "last_activity_date": 1485729159, "creation_date": 1485717104, "question_id": 41924862, "link": "https://stackoverflow.com/questions/41924862/realm-returning-stale-data", "title": "Realm returning stale data", "body": "<p>I don't have a lot of experience writing Android apps. For fun I am writing an app that will upload my call logs to my server. This entire app is running as a Service. The Service (starts when the phone is booted) is the one that registers the ContentObserver, which then calls my custom <code>CallLog</code> class. I use <code>ContentObserver</code> to listen for content change events. Unfortunately, the ContentObserver is called multiple times when I e.g. dial a number. </p>\n\n<p>For that reason, I have function that I call after a successful upload (I use Retrofit) called <code>markAsUploaded()</code>. This function creates a <code>RealmObject</code> called <code>CallLogUploaded</code> (which is different from my regular <code>CallLog</code> model). This <code>CallLogUploaded</code> simply has one identifier which is the <code>dateTime</code> of the call, which should be unique enough. Then, when I am iterating through the list of all the call logs, I check every single call log against a <code>isDataUploaded()</code> function, which does a Realm query and checks to see if there is already a call log with that dateTime stored in the database (realm). In theory, it should work.</p>\n\n<p>However, I have noticed that it does not always work. It seems that very often my data is stale. When I do <code>realm.isAutoRefresh()</code>, it returns false (although I swear it returned true once). In my <code>isDataUploaded</code> function, even when I do a <code>findAll()</code> on the Realm, I do not see all of my data - but the data definitely did hit the <code>markDataAsUploaded</code> function.</p>\n\n<p>Here's my code - it's in Kotlin but should be easy to understand:</p>\n\n<pre><code>    val callLogCall = service.sendCalLLogs(childId, dataToUpload)\n    callLogCall.enqueue(object : Callback&lt;Void&gt; {\n        override fun onResponse(call: Call&lt;Void&gt;, response: Response&lt;Void&gt;) {\n            if (response.isSuccessful) {\n                Log.i(AppConstants.LOG_TAG, \"Call log data uploaded successfully!\")\n                this@CallLogData.markDataAsUploaded(dataToUpload)\n            } else {\n                Log.w(AppConstants.LOG_TAG, \"Call log data upload failed\")\n            }\n        }\n\n        override fun onFailure(call: Call&lt;Void&gt;, t: Throwable) {\n            Log.w(AppConstants.LOG_TAG, \"Call log data upload error (onFailure) called\")\n        }\n    })\n\n\n// This function simply stores a Realm model for all the data that has been uploaded to the server\nprivate fun markDataAsUploaded(dataToUpload: List&lt;CallLog&gt;) {\n    realm = Realm.getDefaultInstance()\n    for (data in dataToUpload) {\n        realm.beginTransaction()\n        val callLogUploaded = realm.createObject(CallLogUploaded::class.java)\n        callLogUploaded.callDate = data.callDate\n\n        realm.commitTransaction()\n    }\n}\n\n// This function checks to see if the data is already uploaded.\nprivate fun isDataUploaded(callLog: CallLog) : Boolean { \n    return realm\n            .where(CallLogUploaded::class.java)\n            .equalTo(\"callDate\", callLog.callDate)\n            .count() &gt; 0L\n}\n\n// Gets the call logs - not the entire function\nfor (call in callLogs) {\n    val callLog = CallLog()\n    callLog.id = call.id\n    callLog.callDate = Utilities.getTimestampAsSeconds(call.callDate)\n\n    if (this.isDataUploaded(callLog)) {\n        continue\n    }\n\n    callLog.name = call.name\n    callLog.number = call.number\n }\n</code></pre>\n\n<p>I am very new to Realm and fairly new to Android development, so I would appreciate any help you can give me. Thanks!</p>\n"}, {"tags": ["android", "android-arrayadapter", "kotlin"], "answers": [{"tags": [], "owner": {"reputation": 20461, "user_id": 1452094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a12b28824b215e4886da2e9f376369f?s=128&d=identicon&r=PG", "display_name": "Kiskae", "link": "https://stackoverflow.com/users/1452094/kiskae"}, "is_accepted": true, "score": 40, "last_activity_date": 1523291403, "last_edit_date": 1523291403, "creation_date": 1485710170, "answer_id": 41923699, "question_id": 41923557, "link": "https://stackoverflow.com/questions/41923557/arrayadapter-use-kotlin-android/41923699#41923699", "title": "ArrayAdapter use Kotlin android", "body": "<p>Parameter variable cannot be re-assigned, you will need to create a local variable to hold your returned view:</p>\n\n<pre><code>override fun getView(position: Int, convertView: View?, parent: ViewGroup): View? {\n    var holder: ViewHolder\n    var retView: View\n\n    if(convertView == null){\n        retView = vi.inflate(resource, null)\n        holder = ViewHolder()\n\n        holder.image = retView.findViewById(R.id.myImage) as ImageView?\n\n        retView.tag = holder\n\n    } else {\n        holder = convertView.tag as ViewHolder\n        retView = convertView\n    }\n\n    return retView\n}\n</code></pre>\n"}], "owner": {"reputation": 621, "user_id": 6708989, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/ffc7213d4eb7b705a320008250b51dae?s=128&d=identicon&r=PG&f=1", "display_name": "g71132", "link": "https://stackoverflow.com/users/6708989/g71132"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25863, "favorite_count": 4, "accepted_answer_id": 41923699, "answer_count": 1, "score": 27, "last_activity_date": 1561127659, "creation_date": 1485709444, "last_edit_date": 1561127659, "question_id": 41923557, "link": "https://stackoverflow.com/questions/41923557/arrayadapter-use-kotlin-android", "title": "ArrayAdapter use Kotlin android", "body": "<p>SoI'm learning kotlin and now I need to write  an ArrayAdapter, but I've some error when trying to do this: </p>\n\n<pre><code>convertView = vi.inflate(resource, null) \n</code></pre>\n\n<p>kotlin is telling me </p>\n\n<blockquote>\n  <p>Val cannot be reassigned</p>\n</blockquote>\n\n<p>In the site kotline I convert java class to kotlin class and try to do like in this site. Why is there an error and how can I fix this? Here is the whole code.</p>\n\n<pre><code>open class MyAdapter(context: Context, resource: Int, list: ArrayList&lt;MyItems&gt;) :\n        ArrayAdapter&lt;MyItems&gt;(context, resource, list) {\n\n    var resource: Int\n    var list: ArrayList&lt;MyItems&gt;\n    var vi: LayoutInflater\n\n    init {\n        this.resource = resource\n        this.list = list\n        this.vi = context.getSystemService(Context.LAYOUT_INFLATER_SERVICE) as LayoutInflater\n    }\n\n\n    override fun getView(position: Int, convertView: View?, parent: ViewGroup): View? {\n        var holder: ViewHolder\n\n        if(convertView == null){\n            convertView = vi.inflate(resource, null) //error in this line\n            holder = ViewHolder()\n\n            holder.image = convertView.findViewById(R.id.myImage) as ImageView?\n\n            convertView.tag(holder) //error in this line\n\n        } else {\n            holder = convertView.tag as ViewHolder\n        }\n\n        return convertView\n    }\n\n    internal class ViewHolder {\n        var image: ImageView? = null\n    }\n\n}\n</code></pre>\n"}, {"tags": ["kotlin"], "answers": [{"comments": [{"owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "edited": false, "score": 0, "creation_date": 1485764925, "post_id": 41905971, "comment_id": 71043333, "body": "You can use the <code>eachCountTo</code> method instead of <code>foldTo</code> on the <code>Grouping</code>: <code>.eachCountTo(EnumMap(Subject::class.java))</code>"}, {"owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "edited": false, "score": 0, "creation_date": 1485768704, "post_id": 41905971, "comment_id": 71045398, "body": "Ah, I misread the question. I thought he only wanted to count up the marks in each subject."}], "tags": [], "owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "is_accepted": true, "score": 4, "last_activity_date": 1485586803, "last_edit_date": 1485586803, "creation_date": 1485573259, "answer_id": 41905971, "question_id": 41904241, "link": "https://stackoverflow.com/questions/41904241/kotlin-list-to-enummap-with-sums/41905971#41905971", "title": "Kotlin list to EnumMap with sums", "body": "<p>Currently, the easiest solution is to first produce the grouping with <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/group-by.html#groupby\" rel=\"nofollow noreferrer\"><code>.groupBy { }</code></a> and then process the groups with <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/map-values-to.html\" rel=\"nofollow noreferrer\"><code>.mapValuesTo() { }</code></a>, converting them to the sums:</p>\n\n<pre><code>val result = marks\n        .groupBy(Mark::subject)\n        .mapValuesTo(EnumMap(Subject::class.java)) { it.value.sumBy(Mark::value) }\n</code></pre>\n\n<p>After Kotlin 1.1 is released, the new stdlib functionality <a href=\"https://kotlinlang.org/docs/reference/whatsnew11.html#groupingby\" rel=\"nofollow noreferrer\">shown in Kotlin 1.1 Beta</a> will allow you to do the same without the intermediate groups map. Instead, the collection is processed only once with this code:</p>\n\n<pre><code>val result = marks\n        .groupingBy(Mark::subject)\n        .foldTo(EnumMap(Subject::class.java), 0) { acc, it -&gt; acc + it.value }\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7481081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71dc9a14e92ec01a9e4beb66ca33541e?s=128&d=identicon&r=PG&f=1", "display_name": "Delveroff", "link": "https://stackoverflow.com/users/7481081/delveroff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1196, "favorite_count": 0, "accepted_answer_id": 41905971, "answer_count": 1, "score": 2, "last_activity_date": 1485586803, "creation_date": 1485557082, "last_edit_date": 1495540390, "question_id": 41904241, "link": "https://stackoverflow.com/questions/41904241/kotlin-list-to-enummap-with-sums", "title": "Kotlin list to EnumMap with sums", "body": "<p>I have to migrate my project to Kotlin. Later, I questioned  <a href=\"https://stackoverflow.com/questions/41732240/java-8-list-to-enummap-with-sums\">this issue</a>. And I really can't get how to implement it in Kotlin. I know about 'associateBy' function, but it doesn't have that amount of arguments that Java 8 'groupBy' has.  Is it a way to implement it with lambdas. If not, how can I implement this algorithm without it?</p>\n"}, {"tags": ["generics", "kotlin"], "comments": [{"owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "edited": false, "score": 5, "creation_date": 1485540031, "post_id": 41898435, "comment_id": 70982736, "body": "Can you please make a minimal, <b>complete and verifiable</b> example? There&#39;s a lot of undefined classes and functions in your code. It makes it hard for me to try it out."}, {"owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "edited": false, "score": 0, "creation_date": 1485540269, "post_id": 41898435, "comment_id": 70982875, "body": "You can most likely just define your class as <code>open class SomeClass&lt;V : SomeType&gt;</code> though."}, {"owner": {"reputation": 19, "user_id": 4559053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oHtFL.jpg?s=128&g=1", "display_name": "muhrifqii", "link": "https://stackoverflow.com/users/4559053/muhrifqii"}, "reply_to_user": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "edited": false, "score": 0, "creation_date": 1485541677, "post_id": 41898435, "comment_id": 70983598, "body": "@marstran okay I will add the complete version tomorrow. Yeah that&#39;s shorter but <code>where</code> is used in case I want to upperbound more than 1 type. Thanks the suggestion btw."}, {"owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "edited": false, "score": 0, "creation_date": 1485543667, "post_id": 41898435, "comment_id": 70984592, "body": "You can have multiple upper bounds by using the <code>where</code> keyword: <code>open class SomeClass&lt;V&gt; where V : Sometype, V: SomeOtherType, V: SomeThirdType</code>"}, {"owner": {"reputation": 68461, "user_id": 90527, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/62d3a421bbe13cae0425a563579618ae?s=128&d=identicon&r=PG", "display_name": "outis", "link": "https://stackoverflow.com/users/90527/outis"}, "edited": false, "score": 0, "creation_date": 1518946675, "post_id": 41898435, "comment_id": 84703999, "body": "The example is still incomplete. The Rx classes are still undefined. The question asks about a call to <code>SomeClass&lt;V&gt;::onVc</code>, but there&#39;s none in the question."}], "owner": {"reputation": 19, "user_id": 4559053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oHtFL.jpg?s=128&g=1", "display_name": "muhrifqii", "link": "https://stackoverflow.com/users/4559053/muhrifqii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2272, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1486038946, "creation_date": 1485533949, "last_edit_date": 1486038946, "question_id": 41898435, "link": "https://stackoverflow.com/questions/41898435/kotlin-generics-constraint", "title": "Kotlin generics constraint", "body": "<p>I want to make a class that can accept limited generic type, so that my class can only accept the subclass of some particular class. But without so many cast. My code looks like this:</p>\n\n<pre><code>open class SomeClass&lt;V&gt; where V : SomeType { \n  private val vc: PS&lt;SomeType&gt; = PS.create()\n  protected val z: ZQ&lt;V&gt; = vc.doSmt(-1).map { it as V }\n\n  open fun onVc(v: V) {\n    vc.on(v)\n  } \n}\n</code></pre>\n\n<p>With that code, warning appeared to use <code>in</code> variance to the generic type. Changing to <code>SomeClass&lt;in V&gt;</code>. But when I call <code>onVc(v)</code> where v is a subtype of <code>SomeType</code>, it is rejected. <code>v</code> is type <code>Nothing</code>. I read the kotlin generic documentation here <a href=\"https://kotlinlang.org/docs/reference/generics.html\" rel=\"nofollow noreferrer\">https://kotlinlang.org/docs/reference/generics.html</a> but still confused.</p>\n\n<hr>\n\n<p>Edit:</p>\n\n<p>I will still put the original code there and add a better and representative code here.</p>\n\n<pre><code>open class SomeClass&lt;V&gt; (params: IgnoreThis) where V: SomeType {\n  private val vc: PublishSubject&lt;SomeType&gt; = PublishSubject.create()\n  protected val z: Observable&lt;V&gt; =\n    vc.filter { it !is SubClassOfSomeType }.map { it as V }\n\n  open fun onVc(v: V) {\n    vc.onNext(v)\n  }\n}\n</code></pre>\n\n<p>And this is <code>SomeType</code>, its super and sub class looks like</p>\n\n<pre><code>interface SuperSomeType&lt;S&gt; {\n  fun x(): Observable&lt;S&gt;\n}\n\ninterface SomeType : SuperSomeType&lt;EnumType1&gt;\ninterface SomeOtherType : SuperSomeType&lt;EnumType2&gt; // just to show why I used SuperSomeType interface\n\nclass SubClassOfSomeType : SomeType {\n  override fun x(): Observable&lt;EnumType1&gt; {\n    return Observable.empty()\n  }\n}\n</code></pre>\n\n<p>Thanks for the suggestion for make it clearer</p>\n"}, {"tags": ["spring", "spring-mvc", "spring-boot", "kotlin"], "comments": [{"owner": {"reputation": 3668, "user_id": 2392960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a549fcc9b00c4ce0ede36ede98548729?s=128&d=identicon&r=PG", "display_name": "Januson", "link": "https://stackoverflow.com/users/2392960/januson"}, "edited": false, "score": 0, "creation_date": 1485545653, "post_id": 41897967, "comment_id": 70985541, "body": "Post here your gradle/maven dependencies."}, {"owner": {"reputation": 508, "user_id": 1065545, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0d3ad02114c840528a7e113150a7ece4?s=128&d=identicon&r=PG", "display_name": "Flanfl", "link": "https://stackoverflow.com/users/1065545/flanfl"}, "reply_to_user": {"reputation": 3668, "user_id": 2392960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a549fcc9b00c4ce0ede36ede98548729?s=128&d=identicon&r=PG", "display_name": "Januson", "link": "https://stackoverflow.com/users/2392960/januson"}, "edited": false, "score": 0, "creation_date": 1485553275, "post_id": 41897967, "comment_id": 70989342, "body": "I&#39;ve added the whole file incase the issue comes from someting not so obvious (and I&#39;m completly new to graddle too :p )"}], "answers": [{"comments": [{"owner": {"reputation": 508, "user_id": 1065545, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0d3ad02114c840528a7e113150a7ece4?s=128&d=identicon&r=PG", "display_name": "Flanfl", "link": "https://stackoverflow.com/users/1065545/flanfl"}, "edited": false, "score": 0, "creation_date": 1485556912, "post_id": 41903863, "comment_id": 70990879, "body": "Indeed that was as simple as that! I added the depedency and it worked just fine. Many thanks!"}], "tags": [], "owner": {"reputation": 3668, "user_id": 2392960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a549fcc9b00c4ce0ede36ede98548729?s=128&d=identicon&r=PG", "display_name": "Januson", "link": "https://stackoverflow.com/users/2392960/januson"}, "is_accepted": true, "score": 1, "last_activity_date": 1485555103, "creation_date": 1485555103, "answer_id": 41903863, "question_id": 41897967, "link": "https://stackoverflow.com/questions/41897967/cant-serve-dynamic-web-content-with-spring-boot-and-kotlin/41903863#41903863", "title": "Can&#39;t serve dynamic Web Content with Spring Boot and Kotlin", "body": "<p>I looks like <code>spring-boot-starter-web</code> dependency is not enough to setup view resolving. Try to add <code>spring-boot-starter-thymeleaf</code> dependency and <strong>Thymeleaf</strong> should handle your html file.</p>\n\n<pre><code>compile(\"org.springframework.boot:spring-boot-starter-thymeleaf\")\n</code></pre>\n\n<p>Your HTML files should be in <code>src/main/resources/templates</code> or they might not be automatically detected.</p>\n"}], "owner": {"reputation": 508, "user_id": 1065545, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0d3ad02114c840528a7e113150a7ece4?s=128&d=identicon&r=PG", "display_name": "Flanfl", "link": "https://stackoverflow.com/users/1065545/flanfl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1453, "favorite_count": 0, "accepted_answer_id": 41903863, "answer_count": 1, "score": 1, "last_activity_date": 1485555103, "creation_date": 1485532447, "last_edit_date": 1485553236, "question_id": 41897967, "link": "https://stackoverflow.com/questions/41897967/cant-serve-dynamic-web-content-with-spring-boot-and-kotlin", "title": "Can&#39;t serve dynamic Web Content with Spring Boot and Kotlin", "body": "<p>Based on a Spring Boot <a href=\"https://spring.io/guides/gs/serving-web-content/\" rel=\"nofollow noreferrer\">tutorial</a> to served dynamic web content, I wanted to do the same in Kotlin. My Kotlin project is based on this <a href=\"https://spring.io/blog/2016/02/15/developing-spring-boot-applications-with-kotlin\" rel=\"nofollow noreferrer\">tutorial</a>. I've no issue running the code of both tutorials. </p>\n\n<p>From my understanding, I only needed to add a controller that would return a reference to a template. </p>\n\n<p>Here <code>HelloController.kt</code> (located under src/main/kotlin/foo/controller) :</p>\n\n<pre><code>package foo.controller\n\nimport org.slf4j.LoggerFactory\nimport org.springframework.stereotype.Controller\nimport org.springframework.web.bind.annotation.RequestMapping\n\n@Controller\nclass HelloController {\n\n    private val log = LoggerFactory.getLogger(HelloController::class.java)\n\n    @RequestMapping(\"/\")\n    fun hello(): String {\n        log.info(\"foo\")\n        return \"index\"\n    }\n}\n</code></pre>\n\n<p>Here is the simple \"template\", <code>index.html</code> that I want to access (located under  src/main/resources/templates/index.html):</p>\n\n<pre><code>&lt;html&gt;\n&lt;head&gt;\n&lt;/head&gt;\n&lt;body&gt;\nBar\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>So technically, if I go to <code>localhost:8080</code> I should have <code>index.html</code> displayed which I don't. Instead I have a 404 error. I do have the logged displayed so the <code>hello</code>method is called. What am I doing wrong? I didn't see any configuration file in the Spring Boot tutorial so I guess Spring is doing something under the hood to get the correct ressource from what a function returns. </p>\n\n<p>EDIT: </p>\n\n<p>Has requested my graddle imports:</p>\n\n<pre><code>buildscript {\n    val springBootVersion = \"1.4.3.RELEASE\"\n    val kotlinVersion = \"1.0.6\"\n    extra[\"kotlinVersion\"] = kotlinVersion\n\n    repositories {\n        mavenCentral()\n    }\n\n    dependencies {\n        classpath(\"org.springframework.boot:spring-boot-gradle-plugin:$springBootVersion\")\n        classpath(\"org.jetbrains.kotlin:kotlin-noarg:$kotlinVersion\")\n        classpath(\"org.jetbrains.kotlin:kotlin-allopen:$kotlinVersion\")\n        classpath(\"org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlinVersion\")\n    }\n}\n\napply {\n    plugin(\"kotlin\")\n    plugin(\"kotlin-spring\")\n    plugin(\"kotlin-jpa\")\n    plugin(\"org.springframework.boot\")\n}\n\nversion = \"0.0.1-SNAPSHOT\"\n\nconfigure&lt;JavaPluginConvention&gt; {\n    setSourceCompatibility(1.8)\n    setTargetCompatibility(1.8)\n}\n\nrepositories {\n    mavenCentral()\n}\n\nval kotlinVersion = extra[\"kotlinVersion\"] as String\n\ndependencies {\n    compile(\"org.springframework.boot:spring-boot-starter-web\")\n    compile(\"org.springframework.boot:spring-boot-starter-data-jpa\")\n    compile(\"com.h2database:h2\")\n    compile(\"org.jetbrains.kotlin:kotlin-stdlib:$kotlinVersion\")\n    compile(\"org.jetbrains.kotlin:kotlin-reflect:$kotlinVersion\")\n    compile(\"org.apache.commons:commons-io:1.3.2\")\n    compile(\"org.apache.commons:commons-lang3:3.3.1\")\n    testCompile(\"org.springframework.boot:spring-boot-starter-test\")\n}\n</code></pre>\n"}, {"tags": ["inline", "kotlin", "public", "java-synthetic-methods"], "comments": [{"owner": {"reputation": 1048, "user_id": 2266464, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FvTTv.jpg?s=128&g=1", "display_name": "Harry Timothy", "link": "https://stackoverflow.com/users/2266464/harry-timothy"}, "edited": false, "score": 0, "creation_date": 1583158570, "post_id": 41892715, "comment_id": 107011559, "body": "<code>@PublishedApi internal</code> should be declared on your private member, not on the inline function"}], "answers": [{"comments": [{"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "edited": false, "score": 5, "creation_date": 1485574001, "post_id": 41905907, "comment_id": 70994225, "body": "Thanks for the answer. Right, now I see that <code>@PublishedApi internal</code> leaves the names intact, I was mistaken. By the way, is the IDE supposed to hide the <code>@PublishedApi internal</code> members from completion or discourage their usage someway? And, just out of curiosity, what was wrong with <code>@Suppress(&quot;NON_PUBLIC_CALL_FROM_PUBLIC_INLINE&quot;)</code>?"}, {"owner": {"reputation": 15609, "user_id": 590790, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2648f806f3af808a2ed537c8e745558e?s=128&d=identicon&r=PG", "display_name": "Steven Jeuris", "link": "https://stackoverflow.com/users/590790/steven-jeuris"}, "reply_to_user": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "edited": false, "score": 0, "creation_date": 1517235080, "post_id": 41905907, "comment_id": 83999950, "body": "@hotkey Any follow-up on whether or not using <code>@JvmSynthetic</code> in combination with <code>@PublishedApi</code> causes any problems?"}, {"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "reply_to_user": {"reputation": 15609, "user_id": 590790, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2648f806f3af808a2ed537c8e745558e?s=128&d=identicon&r=PG", "display_name": "Steven Jeuris", "link": "https://stackoverflow.com/users/590790/steven-jeuris"}, "edited": false, "score": 2, "creation_date": 1517243478, "post_id": 41905907, "comment_id": 84005760, "body": "@StevenJeuris, I faced none, though I can&#39;t say I used that combination much. Well, none of my experiments aimed to detect trouble showed any."}, {"owner": {"reputation": 2085, "user_id": 5636313, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/igjep.jpg?s=128&g=1", "display_name": "Farid", "link": "https://stackoverflow.com/users/5636313/farid"}, "reply_to_user": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "edited": false, "score": 0, "creation_date": 1611436615, "post_id": 41905907, "comment_id": 116452495, "body": "@hotkey <code>@Suppress(&quot;NON_PUBLIC_CALL_FROM_PUBLIC_INLINE&quot;)</code>  this is not just to get rid of the warning right? I mean it does what <code>@PublishedApi</code> is intended to do &quot;making the member <i>effectively</i> public&quot;, am I right?"}], "tags": [], "owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "is_accepted": true, "score": 32, "last_activity_date": 1485572426, "creation_date": 1485572426, "answer_id": 41905907, "question_id": 41892715, "link": "https://stackoverflow.com/questions/41892715/inline-function-cannot-access-non-public-api-publishedapi-vs-suppress-vs-jvm/41905907#41905907", "title": "Inline function cannot access non-public-API: @PublishedApi vs @Suppress vs @JvmSynthetic", "body": "<p><code>@PublishedApi internal</code> is the intended way of exposing non-public API for using in public inline functions. </p>\n\n<p>That <code>@PublishedApi internal</code> member becomes effectively public and its name <em>doesn't</em> get mangled (if you noticed the opposite, please file a bug).</p>\n\n<p><code>@Suppress(\"NON_PUBLIC_CALL_FROM_PUBLIC_INLINE\")</code> is a band-aid workaround in the lack of <code>@PublisedApi</code> based on suppressing an error and therefore isn't recommended. With the introduction of <code>@PublishedApi</code> this suppression is going to be cleaned from stdlib.</p>\n\n<p><code>@JvmSynthetic</code> combined with <code>@PublishedApi</code> is an interesting approach, however it can cause some problems while debugging, though I'm not sure. </p>\n"}], "owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4977, "favorite_count": 5, "accepted_answer_id": 41905907, "answer_count": 1, "score": 30, "last_activity_date": 1500984339, "creation_date": 1485515761, "last_edit_date": 1592644375, "question_id": 41892715, "link": "https://stackoverflow.com/questions/41892715/inline-function-cannot-access-non-public-api-publishedapi-vs-suppress-vs-jvm", "title": "Inline function cannot access non-public-API: @PublishedApi vs @Suppress vs @JvmSynthetic", "body": "<p>In Kotlin, when I have a non-public member and an <code>inline fun</code> that calls it, there's a compilation error saying:</p>\n<blockquote>\n<p>Error:(22, 25) Kotlin: Public-API inline function cannot access non-public-API <code>private fun f(): Unit</code> defined in <code>com.example</code></p>\n</blockquote>\n<p>I found several ways to call my function inside a public <code>inline fun</code>, but which is the best way to do it?</p>\n<p>Suppose I have a <code>private fun f() { }</code>. Then the options I found are:</p>\n<ul>\n<li><p><code>fun f() { }</code></p>\n<p>Just make it public. This is the baseline solution, but if the others turn out to have major disadvantages, this can end up the best one.</p>\n</li>\n<li><p><code>@PublishedApi internal fun f() { }</code></p>\n<p>Introduced in <a href=\"https://blog.jetbrains.com/kotlin/2016/12/kotlin-1-1-m04-is-here/\" rel=\"noreferrer\">Kotlin 1.1-M04</a>, the annotation can be applied to an internal member, making it effectively public. The implication I noticed is that any library user will still be able to call it from Java code, that's what I don't like about it.</p>\n</li>\n<li><p><code>@Suppress(&quot;NON_PUBLIC_CALL_FROM_PUBLIC_INLINE&quot;) inline fun g() { f() }</code></p>\n<p>Found in <a href=\"https://github.com/JetBrains/kotlin/blob/19fa2f51ea893d2763846343fe66bd6ac1739ec7/libraries/stdlib/src/generated/_Collections.kt#L921\" rel=\"noreferrer\">the stdlib sources</a>, this annotation seems to suppress the error when applied to the calling function. But what are its limitations? Can it only be used for <code>inline</code> functions? Will the resulting program fail under some circumstances? I tried to call a non-inline function from an inline one with this trick, and it worked, but it looks suspicious.</p>\n</li>\n<li><p><code>@JvmSynthetic @PublishedApi internal fun f() { }</code></p>\n<p>Combine the second solution with the <em>synthetic</em> flag in the bytecode. I'm not sure if this is a <a href=\"https://stackoverflow.com/questions/41022275/whats-the-intended-use-of-jvmsynthetic-in-kotlin\">correct usage of <code>@JvmSynthetic</code></a>, but this appears to hide the function from Java code, which solves the problem of the <code>@PublishedApi internal</code>.</p>\n</li>\n</ul>\n<p>So, which of these solutions is the best way call a non-public function from a public inline one? What are the downsides of each solution that I don't see?</p>\n"}, {"tags": ["kotlin"], "answers": [{"tags": [], "owner": {"reputation": 74510, "user_id": 43582, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3e5ac1db48e4a7ef1b192cc6b5e7fbf0?s=128&d=identicon&r=PG", "display_name": "Bombe", "link": "https://stackoverflow.com/users/43582/bombe"}, "is_accepted": false, "score": 0, "last_activity_date": 1485504062, "creation_date": 1485504062, "answer_id": 41889268, "question_id": 41888269, "link": "https://stackoverflow.com/questions/41888269/intclass-javaprimitivetype-kotlin-reference-not-equal-to-intclass-javaobject/41889268#41889268", "title": "Int::class.javaPrimitiveType.kotlin reference not equal to Int::class.javaObjectType.kotlin", "body": "<p>Short answer: yes.</p>\n\n<p>Long answer: of course it\u2019s hard to tell what the intended behaviour <em>should be</em> as nobody of us was involved in making that decision, or writing that code. However, I don\u2019t think that it\u2019s really a requirement that these two objects are in fact the same object; equality is sufficient, reference equality is not required here.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 4343399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uBS7E.png?s=128&g=1", "display_name": "Kenji Tomita", "link": "https://stackoverflow.com/users/4343399/kenji-tomita"}, "edited": false, "score": 0, "creation_date": 1485508659, "post_id": 41890127, "comment_id": 70962870, "body": "Thanks for the detailed answer"}], "tags": [], "owner": {"reputation": 25812, "user_id": 288456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf294ff6d86cc587dec43e2af34a9532?s=128&d=identicon&r=PG", "display_name": "Alexander Udalov", "link": "https://stackoverflow.com/users/288456/alexander-udalov"}, "is_accepted": true, "score": 7, "last_activity_date": 1485507515, "creation_date": 1485507515, "answer_id": 41890127, "question_id": 41888269, "link": "https://stackoverflow.com/questions/41888269/intclass-javaprimitivetype-kotlin-reference-not-equal-to-intclass-javaobject/41890127#41890127", "title": "Int::class.javaPrimitiveType.kotlin reference not equal to Int::class.javaObjectType.kotlin", "body": "<p>This behavior is correct. <code>KClass</code> instances for a primitive type and the corresponding object type are equal (==), however they're created from different <code>java.lang.Class</code> instances and since <code>.java</code> always returns the original <code>Class</code> instance the <code>KClass</code> was constructed from, it wouldn't be possible for them to also be identical (===).</p>\n"}], "owner": {"reputation": 35, "user_id": 4343399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uBS7E.png?s=128&g=1", "display_name": "Kenji Tomita", "link": "https://stackoverflow.com/users/4343399/kenji-tomita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 0, "accepted_answer_id": 41890127, "answer_count": 2, "score": 1, "last_activity_date": 1485546271, "creation_date": 1485499381, "last_edit_date": 1485546271, "question_id": 41888269, "link": "https://stackoverflow.com/questions/41888269/intclass-javaprimitivetype-kotlin-reference-not-equal-to-intclass-javaobject", "title": "Int::class.javaPrimitiveType.kotlin reference not equal to Int::class.javaObjectType.kotlin", "body": "<p>I think that <strong>CASE 2</strong> should also return true. Is this behavior correct?</p>\n\n<pre><code>// CASE 1\nInt::class.javaPrimitiveType!!.kotlin == Int::class.javaObjectType.kotlin // true\n\n// CASE 2\nInt::class.javaPrimitiveType!!.kotlin === Int::class.javaObjectType.kotlin // false\n</code></pre>\n"}, {"tags": ["kotlin"], "answers": [{"comments": [{"owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "edited": false, "score": 12, "creation_date": 1485511693, "post_id": 41888331, "comment_id": 70964788, "body": "<code>{saveCall()}</code> can be written <code>::saveCall</code>."}, {"owner": {"reputation": 1052, "user_id": 2238023, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a92a99a6222b719e5b407e0ea6f7cac6?s=128&d=identicon&r=PG", "display_name": "Bryan Bryce", "link": "https://stackoverflow.com/users/2238023/bryan-bryce"}, "edited": false, "score": 1, "creation_date": 1491526211, "post_id": 41888331, "comment_id": 73604592, "body": "How would you use a function with arguments?"}, {"owner": {"reputation": 3668, "user_id": 2392960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a549fcc9b00c4ce0ede36ede98548729?s=128&d=identicon&r=PG", "display_name": "Januson", "link": "https://stackoverflow.com/users/2392960/januson"}, "edited": false, "score": 1, "creation_date": 1491545927, "post_id": 41888331, "comment_id": 73610166, "body": "Basicaly the same, except that instead of empty arg list you specify what args it should take. E.g. myFunction: (path: Path) -&gt; Unit. Take a look at this example from the documentation. <a href=\"https://kotlinlang.org/docs/reference/lambdas.html#function-types\" rel=\"nofollow noreferrer\">kotlinlang.org/docs/reference/lambdas.html#function-types</a>"}], "tags": [], "owner": {"reputation": 3668, "user_id": 2392960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a549fcc9b00c4ce0ede36ede98548729?s=128&d=identicon&r=PG", "display_name": "Januson", "link": "https://stackoverflow.com/users/2392960/januson"}, "is_accepted": true, "score": 39, "last_activity_date": 1485522614, "last_edit_date": 1485522614, "creation_date": 1485499737, "answer_id": 41888331, "question_id": 41887584, "link": "https://stackoverflow.com/questions/41887584/passing-function-as-parameter-in-kotlin/41888331#41888331", "title": "Passing function as parameter in kotlin", "body": "<p>Problem is, that you are not passing a function as a parameter to the <code>uploadImageToParse</code> method. You are passing the result. Also <code>uploadImageToParse</code> method is expecting <code>safeCall</code> to be <strong>Unit</strong> parameter not a <strong>function</strong>.</p>\n\n<p>For this to work you have to first declare <code>uploadImageToParse</code> to expect a function parameter.</p>\n\n<pre><code>fun uploadImageToParse(file: String?, saveCall: () -&gt; Unit) {\n    saveCall()\n}\n</code></pre>\n\n<p>Then you can pass function parameters to this method.</p>\n\n<pre><code>uploadImageToParse(imageFile, {saveCall()})\n</code></pre>\n\n<p>For more information on the topic take a look at <a href=\"https://kotlinlang.org/docs/reference/lambdas.html\" rel=\"noreferrer\">Higher-Order Functions and Lambdas</a> in the Kotlin documentation.</p>\n\n<p>Edit: As @marstran pointed out, you can also pass the function as a parameter using <a href=\"https://kotlinlang.org/docs/reference/reflection.html#function-references\" rel=\"noreferrer\">Function Reference</a>.</p>\n\n<pre><code>uploadImageToParse(imageFile, ::saveCall)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 5415300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/699ae0e5d4770e1d8ba6c732f5033b0f?s=128&d=identicon&r=PG", "display_name": "Braynstorm", "link": "https://stackoverflow.com/users/5415300/braynstorm"}, "is_accepted": false, "score": 4, "last_activity_date": 1491542925, "last_edit_date": 1491542925, "creation_date": 1485500327, "answer_id": 41888430, "question_id": 41887584, "link": "https://stackoverflow.com/questions/41887584/passing-function-as-parameter-in-kotlin/41888430#41888430", "title": "Passing function as parameter in kotlin", "body": "<p>Accepting a function pointer as a parameter is done like this:</p>\n\n<pre><code>private fun uploadImageToParse(file: ParseFile?, saveCall: () -&gt; Unit){\n    saveCall.invoke()\n}\n</code></pre>\n\n<p>The <code>()</code> are the types of the parameters.</p>\n\n<p>The <code>-&gt; Unit</code> part is the return type.</p>\n\n<p>Second Example:</p>\n\n<pre><code>fun someFunction (a:Int, b:Float) : Double {\n    return (a * b).toDouble()\n}\n\nfun useFunction (func: (Int, Float) -&gt; Double) {\n    println(func.invoke(10, 5.54421))\n}\n</code></pre>\n\n<p>For more information, refer to the <a href=\"https://kotlinlang.org/docs/reference/lambdas.html\" rel=\"nofollow noreferrer\">Kotlin Documentation</a></p>\n"}, {"tags": [], "owner": {"reputation": 1863, "user_id": 3838901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b60dd0d6855072619355ca3b9e09e1?s=128&d=identicon&r=PG&f=1", "display_name": "Farid Haq", "link": "https://stackoverflow.com/users/3838901/farid-haq"}, "is_accepted": false, "score": 1, "last_activity_date": 1548751659, "creation_date": 1548751659, "answer_id": 54417002, "question_id": 41887584, "link": "https://stackoverflow.com/questions/41887584/passing-function-as-parameter-in-kotlin/54417002#54417002", "title": "Passing function as parameter in kotlin", "body": "<p>Using lambda expression, We can pass method as parameters \n<br/>Example:</p>\n\n<pre><code>fun main(args: Array&lt;String&gt;) {\n  MyFunction(\"F KRITTY\", { x:Int, y:Int -&gt; x + y })\n}\n\nfun MyFunction(name: String , addNumber: (Int , Int) -&gt; Int) {\n  println(\"Parameter 1 Name :\" + name)\n  val number: Int = addNumber(10,20)\n  println(\"Parameter 2 Add Numbers : \" + number)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 657, "user_id": 5182150, "user_type": "registered", "profile_image": "https://graph.facebook.com/892258294180976/picture?type=large", "display_name": "Jude Osbert K", "link": "https://stackoverflow.com/users/5182150/jude-osbert-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1560239228, "last_edit_date": 1560239228, "creation_date": 1560152385, "answer_id": 56522383, "question_id": 41887584, "link": "https://stackoverflow.com/questions/41887584/passing-function-as-parameter-in-kotlin/56522383#56522383", "title": "Passing function as parameter in kotlin", "body": "<p>The answers above are correct. I also saw a question regarding the cases with parameters. In that case you can use the following:</p>\n\n<p>For example, if the accepting function is like the one below:</p>\n\n<pre><code>fun uploadImageToParse(file: String?, saveCallParameter: (a:String,b:Int,c:String) -&gt; Unit) {\nsaveCall(x,y,z) }\n</code></pre>\n\n<p>Then you could write your call like this:</p>\n\n<pre><code>uploadImageToParse(saveCallParameter={a,b,c-&gt;saveCall(a,b,c)}\n</code></pre>\n\n<p>Here saveCall is the named parameter.</p>\n"}], "owner": {"reputation": 12577, "user_id": 2102794, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/BrKf5.jpg?s=128&g=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/2102794/sai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11438, "favorite_count": 4, "accepted_answer_id": 41888331, "answer_count": 4, "score": 17, "last_activity_date": 1560239228, "creation_date": 1485495601, "question_id": 41887584, "link": "https://stackoverflow.com/questions/41887584/passing-function-as-parameter-in-kotlin", "title": "Passing function as parameter in kotlin", "body": "<p>I'm trying to pass a function as a parameter but it throws 'Unit cannot be invoked as function. Thanks in advance. </p>\n\n<pre><code>uploadImageToParse(imageFile, saveCall1())\nuploadImageToParse(imageFile, saveCall2())\nuploadImageToParse(imageFile, saveCall3())\n\nprivate fun uploadImageToParse(file: ParseFile?, saveCall: Unit) {\n        saveCall()//Throws an error saying 'Unit cannot be invoked as function'\n} \n</code></pre>\n"}, {"tags": ["android", "kotlin", "parcel"], "comments": [{"owner": {"reputation": 1213, "user_id": 921834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ygjaF.png?s=128&g=1", "display_name": "andrei_zaitcev", "link": "https://stackoverflow.com/users/921834/andrei-zaitcev"}, "edited": false, "score": 0, "creation_date": 1485437293, "post_id": 41873846, "comment_id": 70930572, "body": "Wouldn&#39;t <code>dest.writeInt(value!!)</code> work? As far as I remember Android doesn&#39;t  care if you pass a <code>null</code> value into Parcel."}, {"owner": {"reputation": 1411, "user_id": 3825816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1JXMz.png?s=128&g=1", "display_name": "Yvgen", "link": "https://stackoverflow.com/users/3825816/yvgen"}, "reply_to_user": {"reputation": 1213, "user_id": 921834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ygjaF.png?s=128&g=1", "display_name": "andrei_zaitcev", "link": "https://stackoverflow.com/users/921834/andrei-zaitcev"}, "edited": false, "score": 0, "creation_date": 1485437450, "post_id": 41873846, "comment_id": 70930699, "body": "!!- occur nullPointerexception and crash!"}, {"owner": {"reputation": 13134, "user_id": 5115932, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/TUPjU.jpg?s=128&g=1", "display_name": "Bryan", "link": "https://stackoverflow.com/users/5115932/bryan"}, "edited": false, "score": 1, "creation_date": 1485437864, "post_id": 41873846, "comment_id": 70931010, "body": "If you found the answer to your question, you should post it as an answer and accept it."}, {"owner": {"reputation": 34634, "user_id": 2444099, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ad5Vz.jpg?s=128&g=1", "display_name": "Eugen Pechanec", "link": "https://stackoverflow.com/users/2444099/eugen-pechanec"}, "reply_to_user": {"reputation": 1213, "user_id": 921834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ygjaF.png?s=128&g=1", "display_name": "andrei_zaitcev", "link": "https://stackoverflow.com/users/921834/andrei-zaitcev"}, "edited": false, "score": 0, "creation_date": 1485438370, "post_id": 41873846, "comment_id": 70931363, "body": "@andrei_zaitcev <code>writeInt</code> takes an unboxed Java integer which is not nullable. You can&#39;t pass null to this method."}, {"owner": {"reputation": 1213, "user_id": 921834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ygjaF.png?s=128&g=1", "display_name": "andrei_zaitcev", "link": "https://stackoverflow.com/users/921834/andrei-zaitcev"}, "edited": false, "score": 0, "creation_date": 1485438701, "post_id": 41873846, "comment_id": 70931579, "body": "Ah, I see. Sorry for misleading @Yvgen. My bad."}], "answers": [{"comments": [{"owner": {"reputation": 34634, "user_id": 2444099, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ad5Vz.jpg?s=128&g=1", "display_name": "Eugen Pechanec", "link": "https://stackoverflow.com/users/2444099/eugen-pechanec"}, "edited": false, "score": 1, "creation_date": 1485438299, "post_id": 41874646, "comment_id": 70931322, "body": "&quot;If value is null then it is absent and should not be written at all&quot; Yes, but we still need to know about this absence when unmarshalling so <i>something</i> has to be written."}], "tags": [], "owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "is_accepted": false, "score": 2, "last_activity_date": 1485446296, "last_edit_date": 1495540891, "creation_date": 1485437583, "answer_id": 41874646, "question_id": 41873846, "link": "https://stackoverflow.com/questions/41873846/write-in-parcer-nullable-value-in-kotlin/41874646#41874646", "title": "Write in parcer nullable value in kotlin", "body": "<p>This largely depends on what is the semantics of <code>null</code> as a value of your nullable property. It can mean:</p>\n\n<ul>\n<li><p>If <code>value</code> is null then it is absent and should not be written at all:</p>\n\n<pre><code>value?.let { writeInt(it) }\n</code></pre>\n\n<p>Of course, the <code>Parcel</code> receiver should be able to determine if it should read the value or not, this should be clear from the values written earlier.</p></li>\n<li><p><code>value</code> is provided by some code, and it is an error if it is null at the point where it should be written:</p>\n\n<pre><code>check(value != null) { \"value should be not null at the point it's wriiten\" }\nwriteInt(value!!)\n</code></pre>\n\n<p>Also, in this case, consider using <a href=\"https://kotlinlang.org/docs/reference/properties.html#late-initialized-properties\" rel=\"nofollow noreferrer\"><code>lateinit var</code></a> instead of nullable property.</p></li>\n<li><p>Some default value should be used instead of <code>value</code>:</p>\n\n<pre><code>writeInt(value ?: someDefaultValue())\n</code></pre>\n\n<p>With <code>Parcel</code>, this does make sense, because otherwise, if the value is missing, you have to specify the fact somewhere else.</p></li>\n<li><p>... (<code>null</code> can actually mean many things)</p></li>\n</ul>\n\n<p>Also, <a href=\"https://stackoverflow.com/questions/34498562/in-kotlin-what-is-the-idiomatic-way-to-deal-with-nullable-values-referencing-o/34498563\">this answer</a> shows many idiomatic ways of dealing with nullable values, and you might find some of them useful.</p>\n"}, {"comments": [{"owner": {"reputation": 34634, "user_id": 2444099, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ad5Vz.jpg?s=128&g=1", "display_name": "Eugen Pechanec", "link": "https://stackoverflow.com/users/2444099/eugen-pechanec"}, "edited": false, "score": 0, "creation_date": 1595504464, "post_id": 41883670, "comment_id": 111501223, "body": "You can use <code>source.readValue(null)</code> because integer is supported by the system class loader - same in all processes. See <a href=\"https://cs.android.com/android/platform/superproject/+/master:frameworks/base/core/java/android/os/Parcel.java;l=2854;drc=master\" rel=\"nofollow noreferrer\"><code>Parcel</code> source code</a>."}], "tags": [], "owner": {"reputation": 1411, "user_id": 3825816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1JXMz.png?s=128&g=1", "display_name": "Yvgen", "link": "https://stackoverflow.com/users/3825816/yvgen"}, "is_accepted": true, "score": 13, "last_activity_date": 1485479502, "last_edit_date": 1485479502, "creation_date": 1485467647, "answer_id": 41883670, "question_id": 41873846, "link": "https://stackoverflow.com/questions/41873846/write-in-parcer-nullable-value-in-kotlin/41883670#41883670", "title": "Write in parcer nullable value in kotlin", "body": "<p>Resolved by:</p>\n\n<pre><code>source.readValue(Int::class.java.classLoader) as Int?,\ndest.writeValue(value)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1387, "user_id": 651377, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/537563472e02359f184f0d4a5da446a5?s=128&d=identicon&r=PG", "display_name": "Alok Gupta", "link": "https://stackoverflow.com/users/651377/alok-gupta"}, "is_accepted": false, "score": -1, "last_activity_date": 1579660868, "creation_date": 1579660868, "answer_id": 59851894, "question_id": 41873846, "link": "https://stackoverflow.com/questions/41873846/write-in-parcer-nullable-value-in-kotlin/59851894#59851894", "title": "Write in parcer nullable value in kotlin", "body": "<p>Use data keyword along with Parcelable,</p>\n\n<pre><code>@Parcelize\ndata class CallIssue(\n                  var name : String? =null,\n                  var status: String? = null ,\n                  var mobile: String? = null,\n                  var priority: Int = 0,\n                  var natureOfWork: String? = null,\n                  var department: String? = null,\n                  var village: String? = null,\n                  var time_reported: Date? = null,\n                  var reporter: String? = null,\n                  var assignee: String? = null,\n                  var issue_id: String? = null,\n                  var startDate: Date? = null,\n                  var endDate: Date? = null,\n                  var gender : String?= null,\n                  var description: String? = null,\n                  var commentList: List&lt;String&gt;? = null,\n                  var expanded: Boolean = false) : Parcelable\n</code></pre>\n\n<p>If you are using @Parcelize then use \"data\" keyword otherwise all value are null after when you pass data from one activity to other activity.</p>\n"}], "owner": {"reputation": 1411, "user_id": 3825816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1JXMz.png?s=128&g=1", "display_name": "Yvgen", "link": "https://stackoverflow.com/users/3825816/yvgen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2458, "favorite_count": 1, "accepted_answer_id": 41883670, "answer_count": 3, "score": 11, "last_activity_date": 1579660868, "creation_date": 1485435017, "last_edit_date": 1485439030, "question_id": 41873846, "link": "https://stackoverflow.com/questions/41873846/write-in-parcer-nullable-value-in-kotlin", "title": "Write in parcer nullable value in kotlin", "body": "<p>Backend returns nullable <strong>Int?</strong>\nHow should I write nullable value?</p>\n\n<pre><code> date class Foo (var value: Int?){\n   constructor(source: Parcel) : this(\n     source.readInt()\n   )\n\n   override fun writeToParcel(dest: Parcel, flags: Int) {\n     dest.writeInt(value) // doesn't compile - writeInt expect no null value\n   }\n }\n</code></pre>\n\n<p>Now I got solution:</p>\n\n<pre><code>dest.writeInt(value?: -1)\n</code></pre>\n\n<p>And then check to -1</p>\n\n<p>or write Int like string and then use value of...</p>\n\n<p>but I think it's ugly and wrong.</p>\n\n<p><strong>RESOLVED! My answer:</strong></p>\n\n<pre><code>source.readValue(Int::class.java.classLoader) as Int?,\ndest.writeValue(value)\n</code></pre>\n"}, {"tags": ["types", "functional-programming", "kotlin"], "comments": [{"owner": {"reputation": 1561, "user_id": 1772342, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pvNgt.jpg?s=128&g=1", "display_name": "breandan", "link": "https://stackoverflow.com/users/1772342/breandan"}, "edited": false, "score": 0, "creation_date": 1549301867, "post_id": 41866996, "comment_id": 95845568, "body": "Interesting. Can you give an example of how this function is used?"}], "answers": [{"tags": [], "owner": {"reputation": 5110, "user_id": 1542319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49d8051261a5786e0fed00556f644191?s=128&d=identicon&r=PG", "display_name": "SerCe", "link": "https://stackoverflow.com/users/1542319/serce"}, "is_accepted": true, "score": 4, "last_activity_date": 1485409941, "creation_date": 1485409941, "answer_id": 41867636, "question_id": 41866996, "link": "https://stackoverflow.com/questions/41866996/how-to-use-recursive-type-in-kotlin/41867636#41867636", "title": "How to use recursive type in Kotlin", "body": "<p>You can define it as </p>\n\n<pre><code>fun &lt;F : (F, A) -&gt; R, A, R&gt; recur(f: F, arg: A): R = f(f, arg)\n</code></pre>\n\n<p>However, I don't see any satisfying type system way how it can be invoked. </p>\n"}], "owner": {"reputation": 11598, "user_id": 869330, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/34be19b80429871a85ea92656850bceb?s=128&d=identicon&r=PG&f=1", "display_name": "Naetmul", "link": "https://stackoverflow.com/users/869330/naetmul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 41867636, "answer_count": 1, "score": 2, "last_activity_date": 1485409941, "creation_date": 1485405614, "question_id": 41866996, "link": "https://stackoverflow.com/questions/41866996/how-to-use-recursive-type-in-kotlin", "title": "How to use recursive type in Kotlin", "body": "<p>What I want to do is something like this</p>\n\n<pre><code>fun &lt;F, A, R&gt; recur(f: (F, A) -&gt; R, arg: A): R = f(f, arg)\nwhere F = (F, A) -&gt; R\n</code></pre>\n\n<p>How can I type this function in Kotlin?</p>\n"}]