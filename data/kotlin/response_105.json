[{"tags": ["android", "kotlin", "anko"], "answers": [{"tags": [], "owner": {"reputation": 12683, "user_id": 273119, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/6b7f0d7d95b3a1f9547274129582b434?s=128&d=identicon&r=PG", "display_name": "Daniel Gomez Rico", "link": "https://stackoverflow.com/users/273119/daniel-gomez-rico"}, "is_accepted": true, "score": 2, "last_activity_date": 1484176681, "creation_date": 1484176681, "answer_id": 41602549, "question_id": 41599639, "link": "https://stackoverflow.com/questions/41599639/error-catching-exception-in-anko-async-call-kotlin/41602549#41602549", "title": "Error catching exception in Anko async call (Kotlin)", "body": "<p>From doAsync docs:</p>\n\n<blockquote>\n  <ul>\n  <li>@param exceptionHandler optional exception handler.   *  If\n  defined, any exceptions thrown inside [task] will be passed to it. If\n  not, exceptions will be ignored.</li>\n  </ul>\n</blockquote>\n\n<p>Looks like you can pass an <code>exceptionHandler</code> to manage them or it will handle exceptions with their <code>crashLogger</code>:</p>\n\n<pre><code>private val crashLogger = { throwable : Throwable -&gt; throwable.printStackTrace() }\n\n//...\n\nfun &lt;T&gt; T.doAsync( //...\n    exceptionHandler: ((Throwable) -&gt; Unit)? = crashLogger,\n    //... )\n</code></pre>\n\n<p>You can check <a href=\"https://github.com/Kotlin/anko/blob/7febda295f683349e3a1b3f9d999e4faa362b8cd/anko/library/static/common/src/Async.kt#L133\" rel=\"nofollow noreferrer\">Anko doAsync implementation</a> for details.</p>\n"}], "owner": {"reputation": 844, "user_id": 6045289, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/KR7Eg.jpg?s=128&g=1", "display_name": "antonicg", "link": "https://stackoverflow.com/users/6045289/antonicg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 744, "favorite_count": 1, "accepted_answer_id": 41602549, "answer_count": 1, "score": 2, "last_activity_date": 1484176681, "creation_date": 1484164621, "question_id": 41599639, "link": "https://stackoverflow.com/questions/41599639/error-catching-exception-in-anko-async-call-kotlin", "title": "Error catching exception in Anko async call (Kotlin)", "body": "<p>I'm calling an async call using Retrofit inside an Anko doAsync call. The problem is that I don't know how to catch the IOException that throws the <code>execute()</code> properly, basically the execute call is not getting called. If I comment the <code>if (resultBody is T)</code> line, and put the call inside a <code>trycatch</code> it works like a charm. Anyone knows why?</p>\n\n<pre><code>doAsync {\n\n    val response = call.execute()\n\n    uiThread {\n\n        if (response.isSuccessful) {\n\n            val resultBody = response.body()\n\n            if (resultBody is T)\n                callback.onSuccess(resultBody)\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["maven", "intellij-idea", "kotlin", "jetbrains-ide"], "answers": [{"tags": [], "owner": {"reputation": 25812, "user_id": 288456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf294ff6d86cc587dec43e2af34a9532?s=128&d=identicon&r=PG", "display_name": "Alexander Udalov", "link": "https://stackoverflow.com/users/288456/alexander-udalov"}, "is_accepted": true, "score": 4, "last_activity_date": 1484120731, "creation_date": 1484120731, "answer_id": 41585299, "question_id": 41585171, "link": "https://stackoverflow.com/questions/41585171/reduce-configuring-the-compilation-environment-time-for-kotlin-with-maven/41585299#41585299", "title": "Reduce &#39;configuring the compilation environment&#39; time for Kotlin with Maven", "body": "<p>The message is misleading, it just happens to be the last message printed by the compiler before the actual compilation. So it's the compilation itself that takes the majority of time.</p>\n"}], "owner": {"reputation": 43, "user_id": 6514292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c0641d89c86a0dea1ca3bb6d34ac835?s=128&d=identicon&r=PG&f=1", "display_name": "Jacksen", "link": "https://stackoverflow.com/users/6514292/jacksen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 41585299, "answer_count": 1, "score": 2, "last_activity_date": 1484120731, "creation_date": 1484120204, "question_id": 41585171, "link": "https://stackoverflow.com/questions/41585171/reduce-configuring-the-compilation-environment-time-for-kotlin-with-maven", "title": "Reduce &#39;configuring the compilation environment&#39; time for Kotlin with Maven", "body": "<p>During compilation using maven, when Kotlin is running it gets stuck on '[DEBUG] Configuring the compilation environment' for a good 20-30 seconds out of 40 seconds compilation time.</p>\n\n<p>Is there a way to minimise this time?</p>\n\n<pre><code>[INFO] Kotlin Compiler version 1.0.6-release-127\n[INFO] Compiling Kotlin sources from [/Users/jacksenkline/Desktop/api/src/main/java]\n[DEBUG] Classpath: /Users/jacksenkline/Desktop/api/target/api-0.1.0-SNAPSHOT/WEB-INF/classes:/Users/jacksenkline/.m2/repository/com/google/appengine/appengine-api-1.0-sdk/1.9.48/appengine-api-1.0-sdk-1.9.48.jar:/Users/jacksenkline/.m2/repository/javax/servlet/servlet-api/2.5/servlet-api-2.5.jar:/Users/jacksenkline/.m2/repository/jstl/jstl/1.2/jstl-1.2.jar:/Users/jacksenkline/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.0.6/kotlin-stdlib-1.0.6.jar:/Users/jacksenkline/.m2/repository/org/jetbrains/kotlin/kotlin-runtime/1.0.6/kotlin-runtime-1.0.6.jar:/Users/jacksenkline/.m2/repository/org/json/json/20160810/json-20160810.jar:/Users/jacksenkline/.m2/repository/redis/clients/jedis/2.9.0/jedis-2.9.0.jar:/Users/jacksenkline/.m2/repository/org/apache/commons/commons-pool2/2.4.2/commons-pool2-2.4.2.jar:/Users/jacksenkline/.m2/repository/io/jsonwebtoken/jjwt/0.7.0/jjwt-0.7.0.jar:/Users/jacksenkline/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.8.2/jackson-databind-2.8.2.jar:/Users/jacksenkline/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.8.0/jackson-annotations-2.8.0.jar:/Users/jacksenkline/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.8.2/jackson-core-2.8.2.jar\n[DEBUG] Classes directory is /Users/jacksenkline/Desktop/api/target/api-0.1.0-SNAPSHOT/WEB-INF/classes\n[INFO] Module name is api\n[DEBUG] Invoking compiler org.jetbrains.kotlin.cli.jvm.K2JVMCompiler@f48d6f2 with arguments:\n[DEBUG] destination=/Users/jacksenkline/Desktop/api/target/api-0.1.0-SNAPSHOT/WEB-INF/classes\n[DEBUG] classpath=/Users/jacksenkline/Desktop/api/target/api-0.1.0-SNAPSHOT/WEB-INF/classes:/Users/jacksenkline/.m2/repository/com/google/appengine/appengine-api-1.0-sdk/1.9.48/appengine-api-1.0-sdk-1.9.48.jar:/Users/jacksenkline/.m2/repository/javax/servlet/servlet-api/2.5/servlet-api-2.5.jar:/Users/jacksenkline/.m2/repository/jstl/jstl/1.2/jstl-1.2.jar:/Users/jacksenkline/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.0.6/kotlin-stdlib-1.0.6.jar:/Users/jacksenkline/.m2/repository/org/jetbrains/kotlin/kotlin-runtime/1.0.6/kotlin-runtime-1.0.6.jar:/Users/jacksenkline/.m2/repository/org/json/json/20160810/json-20160810.jar:/Users/jacksenkline/.m2/repository/redis/clients/jedis/2.9.0/jedis-2.9.0.jar:/Users/jacksenkline/.m2/repository/org/apache/commons/commons-pool2/2.4.2/commons-pool2-2.4.2.jar:/Users/jacksenkline/.m2/repository/io/jsonwebtoken/jjwt/0.7.0/jjwt-0.7.0.jar:/Users/jacksenkline/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.8.2/jackson-databind-2.8.2.jar:/Users/jacksenkline/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.8.0/jackson-annotations-2.8.0.jar:/Users/jacksenkline/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.8.2/jackson-core-2.8.2.jar\n[DEBUG] includeRuntime=false\n[DEBUG] jdkHome=(null)\n[DEBUG] noJdk=false\n[DEBUG] noStdlib=true\n[DEBUG] noReflect=false\n[DEBUG] module=(null)\n[DEBUG] script=false\n[DEBUG] kotlinHome=(null)\n[DEBUG] moduleName=api\n[DEBUG] jvmTarget=(null)\n[DEBUG] noCallAssertions=false\n[DEBUG] noParamAssertions=false\n[DEBUG] noOptimize=false\n[DEBUG] reportPerf=false\n[DEBUG] inheritMultifileParts=false\n[DEBUG] allowKotlinPackage=false\n[DEBUG] skipMetadataVersionCheck=false\n[DEBUG] skipRuntimeVersionCheck=false\n[DEBUG] declarationsOutputPath=(null)\n[DEBUG] friendPaths=(null)\n[DEBUG] PLUGIN_OPTION_FORMAT=plugin:&lt;pluginId&gt;:&lt;optionName&gt;=&lt;value&gt;\n[DEBUG] languageVersion=(null)\n[DEBUG] apiVersion=(null)\n[DEBUG] suppressWarnings=false\n[DEBUG] verbose=true\n[DEBUG] version=false\n[DEBUG] help=false\n[DEBUG] extraHelp=false\n[DEBUG] noInline=false\n[DEBUG] repeat=(null)\n[DEBUG] pluginClasspaths=(null)\n[DEBUG] pluginOptions=(null)\n[DEBUG] freeArgs=[/Users/jacksenkline/Desktop/api/src/main/java]\n[DEBUG] unknownExtraFlags=[]\n[DEBUG] End of arguments\n[DEBUG] Using Kotlin home directory &lt;no_path&gt;\n[DEBUG] Configuring the compilation environment\n</code></pre>\n"}, {"tags": ["exception", "kotlin", "coroutine"], "comments": [{"owner": {"reputation": 2571, "user_id": 3734457, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de6e5134d8a12fdcbd9cd3b204d70203?s=128&d=identicon&r=PG", "display_name": "Jan Slominski", "link": "https://stackoverflow.com/users/3734457/jan-slominski"}, "edited": false, "score": 0, "creation_date": 1484128922, "post_id": 41581548, "comment_id": 70379276, "body": "I think it&#39;s similar as Java, i.e. not possible. It&#39;s not Lisp ;)"}, {"owner": {"reputation": 311, "user_id": 5275056, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/eab85bfd8e7bbbae12962b0ea538077b?s=128&d=identicon&r=PG&f=1", "display_name": "Wonderlus", "link": "https://stackoverflow.com/users/5275056/wonderlus"}, "reply_to_user": {"reputation": 2571, "user_id": 3734457, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de6e5134d8a12fdcbd9cd3b204d70203?s=128&d=identicon&r=PG", "display_name": "Jan Slominski", "link": "https://stackoverflow.com/users/3734457/jan-slominski"}, "edited": false, "score": 0, "creation_date": 1484179250, "post_id": 41581548, "comment_id": 70408378, "body": "That&#39;s what it&#39;s looking like. Darn. Thanks!"}, {"owner": {"reputation": 19114, "user_id": 4137489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d6e58042c9b1e87df5f5df4796b389f?s=128&d=identicon&r=PG&f=1", "display_name": "marstran", "link": "https://stackoverflow.com/users/4137489/marstran"}, "edited": false, "score": 0, "creation_date": 1484220308, "post_id": 41581548, "comment_id": 70425160, "body": "I don&#39;t think this is possible. I guess it shouldn&#39;t be possible either. I would argue that if you could resume execution after an exception, the exception wasn&#39;t &quot;exceptional&quot; after all."}], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 5275056, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/eab85bfd8e7bbbae12962b0ea538077b?s=128&d=identicon&r=PG&f=1", "display_name": "Wonderlus", "link": "https://stackoverflow.com/users/5275056/wonderlus"}, "edited": false, "score": 0, "creation_date": 1484177835, "post_id": 41590809, "comment_id": 70407941, "body": "Can you give me an example of what you mean by: &quot;catch the exception in the controller and resume the coroutine&quot;  Sorry, I&#39;m just a few days into Kotlin. Thanks in advance."}, {"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "reply_to_user": {"reputation": 311, "user_id": 5275056, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/eab85bfd8e7bbbae12962b0ea538077b?s=128&d=identicon&r=PG&f=1", "display_name": "Wonderlus", "link": "https://stackoverflow.com/users/5275056/wonderlus"}, "edited": false, "score": 0, "creation_date": 1484209237, "post_id": 41590809, "comment_id": 70417974, "body": "Well, I have never tried to actually do it myself. Coroutines is very advanced staff, you know."}], "tags": [], "owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "is_accepted": false, "score": -2, "last_activity_date": 1484137159, "creation_date": 1484137159, "answer_id": 41590809, "question_id": 41581548, "link": "https://stackoverflow.com/questions/41581548/kotlin-continue-coroutine-after-exception/41590809#41590809", "title": "Kotlin - Continue Coroutine after Exception", "body": "<p>For that <code>someMethod1</code>, <code>someMethod2</code> and <code>someMethod3</code> must be <code>suspend fun</code>. Then all you need is to catch the exception in the controller and resume the coroutine.</p>\n"}, {"comments": [{"owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "edited": false, "score": 0, "creation_date": 1507279763, "post_id": 43784713, "comment_id": 80155449, "body": "Does <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines.experimental/-continuation/resume-with-exception.html\" rel=\"nofollow noreferrer\">resumeWithException</a> have no association with this?"}, {"owner": {"reputation": 20308, "user_id": 1051598, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f9c354e780ce562daea0e21b99bfdc0d?s=128&d=identicon&r=PG", "display_name": "Roman  Elizarov", "link": "https://stackoverflow.com/users/1051598/roman-elizarov"}, "reply_to_user": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "edited": false, "score": 0, "creation_date": 1507316705, "post_id": 43784713, "comment_id": 80176759, "body": "Nope. <code>resumeWithException</code> does resume with exception, but you can do it only once. You cannot &quot;resume it again&quot;."}], "tags": [], "owner": {"reputation": 20308, "user_id": 1051598, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f9c354e780ce562daea0e21b99bfdc0d?s=128&d=identicon&r=PG", "display_name": "Roman  Elizarov", "link": "https://stackoverflow.com/users/1051598/roman-elizarov"}, "is_accepted": false, "score": 2, "last_activity_date": 1493905687, "creation_date": 1493905687, "answer_id": 43784713, "question_id": 41581548, "link": "https://stackoverflow.com/questions/41581548/kotlin-continue-coroutine-after-exception/43784713#43784713", "title": "Kotlin - Continue Coroutine after Exception", "body": "<p>The short answer is that it is not possible. The longer answer is this:</p>\n\n<p>Kotlin coroutines let you <em>suspend</em> execution of the code only at designed suspension points (using suspending functions). Coroutines are not a general goto-like control construct. Quite to the contrary, it is a very well constrained and tightly checked control flow concept that ensures that you do not break the illusion of sequential execution of the code, despite the fact that you can suspend execution of the code and resume it later.</p>\n\n<p>Kotlin coroutines implement <em>one-shot continuations</em> and once the block of code is suspended it can be resumed only once to continue following it regular sequential execution logic, e.g. if the code threw an exception you can still suspend id, but you can only resume it to continue doing what it was going (handling this exception).</p>\n"}], "owner": {"reputation": 311, "user_id": 5275056, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/eab85bfd8e7bbbae12962b0ea538077b?s=128&d=identicon&r=PG&f=1", "display_name": "Wonderlus", "link": "https://stackoverflow.com/users/5275056/wonderlus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1456, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1493905687, "creation_date": 1484099986, "question_id": 41581548, "link": "https://stackoverflow.com/questions/41581548/kotlin-continue-coroutine-after-exception", "title": "Kotlin - Continue Coroutine after Exception", "body": "<p><strong>My Question</strong></p>\n\n<p>Is it possible to continue a coroutine's execution after an exception? </p>\n\n<p><strong>Example</strong></p>\n\n<pre><code>try {\n    someMethod1()\n    someMethod2() //Throws an exception!\n    someMethod3()\n} catch(e: Exception) {\n    //I do not want to call someMethod3 here!\n    //I want the coroutine to resume after the exception inside of the original block.\n} finally {\n    //I also do not want to call someMethod3 here!\n    //I want the coroutine to resume after the exception inside of the original block.\n}\n</code></pre>\n\n<p>I'm not sure if this is even possible, but thank you in advance for taking a look!</p>\n"}, {"tags": ["intellij-idea", "gradle", "kotlin", "gradle-kotlin-dsl"], "comments": [{"owner": {"reputation": 11834, "user_id": 1538877, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/N9qfZ.jpg?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/1538877/ruslan"}, "edited": false, "score": 0, "creation_date": 1484092482, "post_id": 41577502, "comment_id": 70366014, "body": "What version of IDEA kotlin plugin you using?"}, {"owner": {"reputation": 5577, "user_id": 1047713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bd4a6e80c7c52685a465ef6fd4ebde3?s=128&d=identicon&r=PG", "display_name": "elect", "link": "https://stackoverflow.com/users/1047713/elect"}, "reply_to_user": {"reputation": 11834, "user_id": 1538877, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/N9qfZ.jpg?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/1538877/ruslan"}, "edited": false, "score": 0, "creation_date": 1484115849, "post_id": 41577502, "comment_id": 70372300, "body": "2017.1, build IC-171.2014.21"}, {"owner": {"reputation": 11834, "user_id": 1538877, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/N9qfZ.jpg?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/1538877/ruslan"}, "edited": false, "score": 0, "creation_date": 1484121817, "post_id": 41577502, "comment_id": 70375030, "body": "Check it in Tool -&gt; Kotlin -&gt; Configure Kotlin Plugin Updates. For working with Kotlin Script Gradle 1.1 version required"}, {"owner": {"reputation": 5577, "user_id": 1047713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bd4a6e80c7c52685a465ef6fd4ebde3?s=128&d=identicon&r=PG", "display_name": "elect", "link": "https://stackoverflow.com/users/1047713/elect"}, "reply_to_user": {"reputation": 11834, "user_id": 1538877, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/N9qfZ.jpg?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/1538877/ruslan"}, "edited": false, "score": 0, "creation_date": 1484123137, "post_id": 41577502, "comment_id": 70375702, "body": "I am using 1.1 m04"}], "answers": [{"tags": [], "owner": {"reputation": 5577, "user_id": 1047713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bd4a6e80c7c52685a465ef6fd4ebde3?s=128&d=identicon&r=PG", "display_name": "elect", "link": "https://stackoverflow.com/users/1047713/elect"}, "is_accepted": false, "score": 1, "last_activity_date": 1484129321, "creation_date": 1484129321, "answer_id": 41587921, "question_id": 41577502, "link": "https://stackoverflow.com/questions/41577502/gradle-kotlin-script-plugin-with-id-kotlin-not-found/41587921#41587921", "title": "Gradle kotlin script, &gt; Plugin with id `kotlin` not found", "body": "<p>It seems working now, this is what I did:</p>\n\n<ul>\n<li>I closed the project and quitted Intellij</li>\n<li><p>in the project directory, I removed:</p>\n\n<ul>\n<li><code>.gradle</code></li>\n<li><code>.idea</code></li>\n<li><code>build</code></li>\n<li><code>gradle</code></li>\n<li><code>gradlew</code></li>\n<li><code>gradlew.bat</code></li>\n<li><code>settings.gradle</code></li>\n</ul></li>\n<li><p>I left only <code>src</code> and the <code>build.gradle.kts</code> script</p></li>\n<li><p>copy/paste from the <code>hello-kotlin</code>:</p>\n\n<ul>\n<li><code>gradle</code></li>\n<li><code>gradlew</code></li>\n<li><code>gradlew.bat</code></li>\n<li><code>settings.gradle</code></li>\n</ul></li>\n<li><p>open Intellij, chose \"Open Project\" and it was automatically showing up as a Gradle Project, selected and opened</p></li>\n</ul>\n"}], "owner": {"reputation": 5577, "user_id": 1047713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bd4a6e80c7c52685a465ef6fd4ebde3?s=128&d=identicon&r=PG", "display_name": "elect", "link": "https://stackoverflow.com/users/1047713/elect"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2705, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1512394095, "creation_date": 1484079016, "last_edit_date": 1592644375, "question_id": 41577502, "link": "https://stackoverflow.com/questions/41577502/gradle-kotlin-script-plugin-with-id-kotlin-not-found", "title": "Gradle kotlin script, &gt; Plugin with id `kotlin` not found", "body": "<p>I tried to migrate one of my <a href=\"https://github.com/elect86/kotlin-unsigned\" rel=\"nofollow noreferrer\">project</a> to Gradle using a Kotlin script.</p>\n<p>These are my steps:</p>\n<ul>\n<li>substituted the <code>/gradle/wrapper/gradle-wrapper.jar</code> with <a href=\"https://github.com/gradle/gradle-script-kotlin/blob/master/samples/hello-kotlin/gradle/wrapper/gradle-wrapper.jar\" rel=\"nofollow noreferrer\">this one</a></li>\n<li>updated the <code>distributionUrl</code> of <code>gradle/wrapper/gradle-wrapper.properties</code> to the same as <a href=\"https://github.com/gradle/gradle-script-kotlin/blob/master/samples/hello-kotlin/gradle/wrapper/gradle-wrapper.properties#L5\" rel=\"nofollow noreferrer\">here</a></li>\n<li>created the corresponding <a href=\"https://github.com/elect86/kotlin-unsigned/blob/master/build.gradle.kts\" rel=\"nofollow noreferrer\"><code>build.gradle.kts</code></a></li>\n<li>setting <code>settings.gradle</code> to <code>rootProject.buildFileName = 'build.gradle.kts'</code></li>\n</ul>\n<p>At that point Intellij detects it and suggests:</p>\n<blockquote>\n<p>You can configure Gradle wrapper to use distribution with sources. It will provide IDE with Gradle API/DSL documentation.</p>\n</blockquote>\n<p>-&gt; Ok, apply suggestion!</p>\n<blockquote>\n<p>Gradle 'hello-kotlin' project refresh failed</p>\n<p>Error:Plugin with id 'kotlin' not found.</p>\n</blockquote>\n<p>Then I also tried to try one of the official <a href=\"https://github.com/gradle/gradle-script-kotlin/tree/master/samples/hello-kotlin\" rel=\"nofollow noreferrer\">samples</a>:</p>\n<ul>\n<li>cloned the repo</li>\n<li>opened the sample</li>\n<li>same error</li>\n</ul>\n<p>...what am I doing wrong?</p>\n<p>I came back to the official sample, tried to invalidate cache and restart, it didn't work</p>\n<p>I tried to remove</p>\n<pre><code>apply {\n    plugin(&quot;kotlin&quot;)\n}\n</code></pre>\n<p>Refresh Gradle, add it again, refresh Gradle, it worked</p>\n<p>If I open a src file, Intellij says:</p>\n<blockquote>\n<p>Kotlin not configured</p>\n</blockquote>\n<p>However the sample seems running now..</p>\n<p>Intellij 2017.1 EAP</p>\n<p>Kotlin 1.1m04</p>\n"}, {"tags": ["kotlin"], "comments": [{"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "edited": false, "score": 0, "creation_date": 1484049139, "post_id": 41568067, "comment_id": 70340295, "body": "Inside the parsing stuff, is there a local variable named <code>contacts</code>? If there is, then its size is printed, not the size of the <code>contacts</code> stored in the property."}, {"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "edited": false, "score": 2, "creation_date": 1484049238, "post_id": 41568067, "comment_id": 70340353, "body": "Also, your test doesn&#39;t seem to call <code>parseResponse()</code>. Where is it (or should it be) called?"}, {"owner": {"reputation": 692, "user_id": 1841940, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/87bfa2c15daec9c35d82925b0d1adf97?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1841940/john-smith"}, "reply_to_user": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "edited": false, "score": 0, "creation_date": 1484054046, "post_id": 41568067, "comment_id": 70343540, "body": "I am sorry if this was unclear due to the stuff I just skipped from this entry here, I wanted to keep things as short and context-relevant as possible.  EnvelopeParser is in fact calling parseResponse from its constructor.   In fact, I run this in debug mode with break points, so am 100 % sure there is no local variable contacts, IntelliJ renders the value of the contacts member when breaking at println."}, {"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 2, "creation_date": 1484055938, "post_id": 41568067, "comment_id": 70344928, "body": "<code>contacts</code> is not mutable. Why do you write <code>contacts!!</code>?"}, {"owner": {"reputation": 692, "user_id": 1841940, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/87bfa2c15daec9c35d82925b0d1adf97?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1841940/john-smith"}, "edited": false, "score": 0, "creation_date": 1484063677, "post_id": 41568067, "comment_id": 70350471, "body": "If contacts is not mutable, the developers of Kotlin should rename mutableListOf()"}, {"owner": {"reputation": 1720, "user_id": 298106, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e628d2178737ea47df277ceba919ff6e?s=128&d=identicon&r=PG", "display_name": "Alexander Mikhaylov", "link": "https://stackoverflow.com/users/298106/alexander-mikhaylov"}, "reply_to_user": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1484065323, "post_id": 41568067, "comment_id": 70351621, "body": "I think @voddan means not nullable. I don&#39;t see where you call parseResponse method in your test. You only create an object and your contact list is empty."}], "answers": [{"tags": [], "owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "is_accepted": true, "score": 5, "last_activity_date": 1484259858, "last_edit_date": 1484259858, "creation_date": 1484072494, "answer_id": 41575731, "question_id": 41568067, "link": "https://stackoverflow.com/questions/41568067/kotlin-changes-made-in-super-constructor-are-overwritten/41575731#41575731", "title": "Kotlin: changes made in super constructor are overwritten", "body": "<p>As you said in comments, <code>parseResponse(...)</code> is called from inside the <code>EnvelopeParser</code> constructor.</p>\n\n<p>Then what's happening when you create an instance of <code>ReadCursorRequestParser</code> is:</p>\n\n<ol>\n<li><p>An object is allocated.</p></li>\n<li><p>The <code>ReadCursorRequestParser</code> constructor is called, and it calls the superclass constructor straight away.</p></li>\n<li><p>The super constructor (that of <code>EnvelopeParser</code>) invokes <code>parseResponse(...)</code> and thus assigns the <code>contacts</code> (and at this moment this is actually a non-empty list).</p></li>\n<li><p>The super constructor then returns, and the constructor of <code>ReadCursorRequestParser</code> continues.</p></li>\n<li><p><strong>The <code>ReadCursorRequestParser</code> constructor assigns <code>contacts</code> again, now it's an empty list</strong>.</p></li>\n</ol>\n\n<p>The reason for this is that each constructor first calls its super constructor (if any) and only then initializes the properties and executes the <code>init</code> blocks, and all the changes a superconstructor made to the state declared in the class (not the base classes) will be overwritten by the class' own constructor.</p>\n\n<p>This simplified example shows this behavior: <a href=\"http://try.kotlinlang.org/#/UserProjects/rrdg9fn46rg3563uvigo8o2bp6/coclfe252ard8rc7s8g766f8j1\" rel=\"nofollow noreferrer\">(link)</a>.</p>\n\n<hr>\n\n<p>The easiest workaround is to change the declaration of <code>contacts</code> to something like</p>\n\n<pre><code>lateinit var contacts: List&lt;AddressBookElementParser&gt;\n</code></pre>\n\n<p>With this declaration, the constructor won't reassign the <code>contacts</code>. </p>\n\n<p>But I'd rather strongly recommend you to avoid calling <code>open</code> functions in a constructor because, if overridden, they might (and usually do) depend on the <strong>derived class state, which has not been initialized</strong> yet, and also the <strong>changes they make will be overwritten</strong> by the derived class constructor. You can even end up with some part of the changes persisted because they are done to the superclass state and the other part erased -- definitely not what you want to see in everyday life.</p>\n"}], "owner": {"reputation": 692, "user_id": 1841940, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/87bfa2c15daec9c35d82925b0d1adf97?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1841940/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 41575731, "answer_count": 1, "score": -1, "last_activity_date": 1484260291, "creation_date": 1484048747, "last_edit_date": 1484260291, "question_id": 41568067, "link": "https://stackoverflow.com/questions/41568067/kotlin-changes-made-in-super-constructor-are-overwritten", "title": "Kotlin: changes made in super constructor are overwritten", "body": "<p>I am having trouble understanding what Kotlin is actually doing:</p>\n\n<p>My unit test looks like this:</p>\n\n<pre><code>@Test\nfun testReadCursorRequest() {\n    val xml = fromFile()\n    val parser: ReadCursorRequestParser = ReadCursorRequestParser(xml)\n    assertEquals(0, parser.status)\n    assertEquals(134, parser.contacts!!.size)\n}\n</code></pre>\n\n<p>My parser looks like this</p>\n\n<pre><code>abstract class EnvelopeParser(val xml: String) {\n    abstract fun parseResponse(response: Element)\n\n    init {\n        parseResponse(xmlFromString(xml))\n    }\n\n    // non-related stuff\n}\n</code></pre>\n\n<p><sup></sup></p>\n\n<pre><code>class ReadCursorRequestParser(xml: String) : EnvelopeParser(xml) {\n\n    var contacts: List&lt;AddressBookElementParser&gt; = mutableListOf()     \n\n    override fun parseResponse(response: Element) {\n        // here some parsing stuff, fills the contacts-list\n        println(\"size is: ${contacts.size}\")\n    }\n}\n</code></pre>\n\n<p>println says <code>size is: 134</code>, the unit test says: <code>java.lang.AssertionError: Expected &lt;134&gt;, actual &lt;0&gt;</code>.</p>\n\n<p>Why?</p>\n"}, {"tags": ["java", "android", "generics", "kotlin", "dagger-2"], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 6135379, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XfMyJ5yUSTU/AAAAAAAAAAI/AAAAAAAAAhQ/TAQMd_uyM4A/photo.jpg?sz=128", "display_name": "Bisca", "link": "https://stackoverflow.com/users/6135379/bisca"}, "is_accepted": true, "score": 8, "last_activity_date": 1490197072, "creation_date": 1490197072, "answer_id": 42956303, "question_id": 41566518, "link": "https://stackoverflow.com/questions/41566518/dagger-2-with-kotlin-returning-type-with-generic-in-applicationcomponent/42956303#42956303", "title": "Dagger 2 with Kotlin, returning type with generic in ApplicationComponent", "body": "<p>I had the same problem and I found out the solution.</p>\n\n<p>You need to declare the <code>@JvmWildcard</code> in your <code>@Provide</code> method return type.</p>\n\n<pre><code>@Provides \n@Singleton \nfun provideDatabase(@AppContext context: App): Database&lt;@JvmWildcard Realm&gt; {\n    Realm.init(context)\n    val config = RealmConfiguration.Builder()\n            .deleteRealmIfMigrationNeeded()\n            .name(\"db\")\n            .build()\n    Realm.setDefaultConfiguration(config)\n    return RealmDatabase(Realm.getDefaultInstance())\n}\n</code></pre>\n"}], "owner": {"reputation": 1653, "user_id": 4755017, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/JXnt4.jpg?s=128&g=1", "display_name": "Dennis Zinkovski", "link": "https://stackoverflow.com/users/4755017/dennis-zinkovski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 849, "favorite_count": 2, "accepted_answer_id": 42956303, "answer_count": 1, "score": 5, "last_activity_date": 1490197072, "creation_date": 1484043810, "question_id": 41566518, "link": "https://stackoverflow.com/questions/41566518/dagger-2-with-kotlin-returning-type-with-generic-in-applicationcomponent", "title": "Dagger 2 with Kotlin, returning type with generic in ApplicationComponent", "body": "<p>I want to return type with generic to be exposed by sub-graphs, the problem is in auto-generated java-classes, I tried to do something, but the one way to solve it is to remove generic type from AppComponent and return simple object. Is there more \"right\" approach?</p>\n\n<p><strong>Here is the AppComponent</strong></p>\n\n<pre><code>@Singleton\n@Component(modules = arrayOf(ApplicationModule::class))\ninterface ApplicationComponent {\n    fun inject(activity: BaseActivity&lt;MvpView, MvpPresenter&lt;MvpView&gt;&gt;)\n\n    //...\n    fun dataBase(): Database&lt;Realm&gt;\n}\n</code></pre>\n\n<p><strong>here is function in the ApplicationModule</strong></p>\n\n<pre><code>@Provides @Singleton fun provideDatabase(@AppContext context: App): Database&lt;Realm&gt; {\n    Realm.init(context)\n    val config = RealmConfiguration.Builder()\n            .deleteRealmIfMigrationNeeded()\n            .name(\"db\")\n            .build()\n    Realm.setDefaultConfiguration(config)\n    return RealmDatabase(Realm.getDefaultInstance())\n}\n</code></pre>\n\n<p><strong>Then I want to receive my Database</strong></p>\n\n<pre><code>@Provides @ActivityScope fun provideDich(database: Database&lt;Realm&gt;) = Someobject(database)\n</code></pre>\n\n<p><strong>And then I see log that says:</strong></p>\n\n<pre><code>**Error:com.test.data.storage.Database&lt;? extends io.realm.Realm&gt; cannot be provided without an @Provides-annotated method.**\n</code></pre>\n\n<p><strong>Because dagger2 generates factories like this and there is java masks</strong></p>\n\n<pre><code>    public final class Logout_Factory implements Factory&lt;Logout&gt; {\n  private final MembersInjector&lt;Logout&gt; logoutMembersInjector;\n\n  private final Provider&lt;SessionStorage.CloudStorage&gt; arg0Provider;\n\n  private final Provider&lt;Database&lt;? extends Realm&gt;&gt; arg1Provider;\n\n  public Logout_Factory(\n      MembersInjector&lt;Logout&gt; logoutMembersInjector,\n      Provider&lt;SessionStorage.CloudStorage&gt; arg0Provider,\n      Provider&lt;Database&lt;? extends Realm&gt;&gt; arg1Provider) {\n    assert logoutMembersInjector != null;\n    this.logoutMembersInjector = logoutMembersInjector;\n    assert arg0Provider != null;\n    this.arg0Provider = arg0Provider;\n    assert arg1Provider != null;\n    this.arg1Provider = arg1Provider;\n  }\n\n  @Override\n  public Logout get() {\n    return MembersInjectors.injectMembers(\n        logoutMembersInjector, new Logout(arg0Provider.get(), arg1Provider.get()));\n  }\n\n  public static Factory&lt;Logout&gt; create(\n      MembersInjector&lt;Logout&gt; logoutMembersInjector,\n      Provider&lt;SessionStorage.CloudStorage&gt; arg0Provider,\n      Provider&lt;Database&lt;? extends Realm&gt;&gt; arg1Provider) {\n    return new Logout_Factory(logoutMembersInjector, arg0Provider, arg1Provider);\n  }\n}\n</code></pre>\n"}, {"tags": ["java", "kotlin", "coroutine"], "comments": [{"owner": {"reputation": 26106, "user_id": 485337, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/VAz9B.jpg?s=128&g=1", "display_name": "Adam Arold", "link": "https://stackoverflow.com/users/485337/adam-arold"}, "edited": false, "score": 1, "creation_date": 1544430781, "post_id": 41559105, "comment_id": 94258572, "body": "Why don&#39;t you just switch to Kotlin instead?"}], "answers": [{"comments": [{"owner": {"reputation": 740, "user_id": 4594940, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh6.googleusercontent.com/-WBZ1yko941c/AAAAAAAAAAI/AAAAAAAAABA/evKzCnPfSXA/photo.jpg?sz=128", "display_name": "jkratz55", "link": "https://stackoverflow.com/users/4594940/jkratz55"}, "edited": false, "score": 2, "creation_date": 1548384893, "post_id": 41561165, "comment_id": 95531274, "body": "What if your library is written in Kotlin utilizing coroutines, and included as a JAR in a Java project. Would Java be able to utilize calling methods written in Kotlin that utilize coroutines?"}, {"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "reply_to_user": {"reputation": 740, "user_id": 4594940, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh6.googleusercontent.com/-WBZ1yko941c/AAAAAAAAAAI/AAAAAAAAABA/evKzCnPfSXA/photo.jpg?sz=128", "display_name": "jkratz55", "link": "https://stackoverflow.com/users/4594940/jkratz55"}, "edited": false, "score": 2, "creation_date": 1548405306, "post_id": 41561165, "comment_id": 95537324, "body": "From the java POV such a library would just look like normal bytecode with callbacks and some method calls to kotlinx.coroutines library classes. So no different than any other asynchronous technique"}], "tags": [], "owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "is_accepted": false, "score": 27, "last_activity_date": 1484022657, "creation_date": 1484022657, "answer_id": 41561165, "question_id": 41559105, "link": "https://stackoverflow.com/questions/41559105/can-i-take-advantage-of-kotlins-coroutines-by-using-them-in-java-code/41561165#41561165", "title": "Can I take advantage of Kotlin&#39;s Coroutines by using them in Java code?", "body": "<p>Kotlin coroutines are implemented with a compiler transformation to the code, which obviously can only be done by <code>kotlinc</code>.</p>\n\n<p>So, no, Java cannot use Kotlin's coroutines mechanic since it is a compile-time feature. </p>\n"}], "owner": {"reputation": 311, "user_id": 5275056, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/eab85bfd8e7bbbae12962b0ea538077b?s=128&d=identicon&r=PG&f=1", "display_name": "Wonderlus", "link": "https://stackoverflow.com/users/5275056/wonderlus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8625, "favorite_count": 3, "answer_count": 1, "score": 18, "last_activity_date": 1505439727, "creation_date": 1484006763, "question_id": 41559105, "link": "https://stackoverflow.com/questions/41559105/can-i-take-advantage-of-kotlins-coroutines-by-using-them-in-java-code", "title": "Can I take advantage of Kotlin&#39;s Coroutines by using them in Java code?", "body": "<p><strong>What's my goal?</strong></p>\n\n<p>My goal is to be able to use Kotlin's Coroutine system from Java. I want to be able to pause mid-execution for a given amount of time, and then pick back up at that spot after the given amount of time has passed. From Java, I'd like to be able to execute tasks that allow pausing mid-execution without in an asynchronous fashion, such as:</p>\n\n<pre><code>//example 1\nsomeLogic();\npause(3000L); //3 seconds\nsomeMoreLogic();\n\n//example 2\nwhile(true) {\n    someContinuedLogic();\n    pause(10000L); //10 seconds\n}\n</code></pre>\n\n<p><strong>What's my issue?</strong></p>\n\n<p>As expected, I am able to execute coroutines perfectly fine from Kotlin, but when it comes to Java, it becomes tricky because the Java part of the code executes the entire block at once without any pauses, whereas the Kotlin block correctly pauses 1, and then 4 seconds.</p>\n\n<p><strong>What's my question?</strong></p>\n\n<p>Is it even possible to use Kotlin as a backbone for coroutines in Java? If so, what am I doing wrong? <em>Below you can find the source code showing how I am attempting to use Kotlin's coroutines in Java.</em></p>\n\n<p><strong>KtScript Class</strong></p>\n\n<pre><code>abstract class KtScript {\n\n    abstract fun execute()\n\n    fun &lt;T&gt; async(block: suspend () -&gt; T): CompletableFuture&lt;T&gt; {\n        val future = CompletableFuture&lt;T&gt;()\n        block.startCoroutine(completion = object : Continuation&lt;T&gt; {\n            override fun resume(value: T) {\n                future.complete(value)\n            }\n            override fun resumeWithException(exception: Throwable) {\n                future.completeExceptionally(exception)\n            }\n        })\n        return future\n    }\n\n    suspend fun &lt;T&gt; await(f: CompletableFuture&lt;T&gt;): T =\n            suspendCoroutine { c: Continuation&lt;T&gt; -&gt;\n                f.whenComplete { result, exception -&gt;\n                    if (exception == null)\n                        c.resume(result)\n                    else\n                        c.resumeWithException(exception)\n                }\n            }\n\n    fun pause(ms: Long): CompletableFuture&lt;*&gt; {\n        //todo - a better pausing system (this is just temporary!)\n        return CompletableFuture.runAsync {\n            val currentMs = System.currentTimeMillis()\n            while (System.currentTimeMillis() - currentMs &lt; ms) {\n                /* do nothing */\n            }\n        }\n    }\n\n}\n</code></pre>\n\n<p><strong>Kotlin Execution Code</strong></p>\n\n<pre><code>fun main(args: Array&lt;String&gt;) {\n    ScriptTestKotlin().execute()\n}\n\nclass ScriptTestKotlin : KtScript() {\n    override fun execute() {\n        println(\"Executing Kotlin script from Kotlin...\")\n        val future = async {\n            await(pause(1000L))\n            println(\"   1 second passed...\")\n            await(pause(4000L))\n            println(\"   5 seconds passed...\")\n        }\n        future.get() //wait for asynchronous task to finish\n        println(\"Finished!\")\n    }\n}\n</code></pre>\n\n<p><strong>Kotlin Execution Results</strong></p>\n\n<pre><code>Executing Kotlin script from Kotlin...\n   1 second passed...\n   5 seconds passed...\nFinished!\n</code></pre>\n\n<p><strong>Java Execution Code</strong></p>\n\n<pre><code>public class ScriptTestJava extends KtScript {\n\n    public static void main(String[] args) {\n        new ScriptTestJava().execute();\n    }\n\n    @Override\n    public void execute() {\n        System.out.println(\"Executing Kotlin script from Java...\");\n        CompletableFuture&lt;?&gt; future = async(continuation -&gt; {\n            await(pause(1000L), continuation);\n            System.out.println(\"    1 second passed...\");\n            await(pause(4000L), continuation);\n            System.out.println(\"    5 seconds passed...\");\n            return continuation;\n        });\n        try {\n            future.get(); //wait for asynchronous task to finish\n        } catch(Exception e) {\n            e.printStackTrace();\n        }\n        System.out.println(\"Finished!\");\n    }\n}\n</code></pre>\n\n<p><strong>Java Execution Results</strong></p>\n\n<pre><code>Executing Kotlin script from Java...\n    1 second passed...\n    5 seconds passed...\nFinished!\n</code></pre>\n\n<p>^^^ Unfortunately, the pauses are skipped in Java. ^^^</p>\n"}, {"tags": ["android", "kotlin"], "comments": [{"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 1, "creation_date": 1484022826, "post_id": 41557809, "comment_id": 70327034, "body": "Your callback is not being executed. For whatever reason. It is not possible to tell without seeing the code."}, {"owner": {"reputation": 8164, "user_id": 5593959, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/9StDn.jpg?s=128&g=1", "display_name": "Dima Rostopira", "link": "https://stackoverflow.com/users/5593959/dima-rostopira"}, "edited": false, "score": 0, "creation_date": 1484037026, "post_id": 41557809, "comment_id": 70332777, "body": "When code in lambda throws exception it often being caught by function implementation (for example in Rx it will be caught and passed to <code>onError</code>)"}], "owner": {"reputation": 2331, "user_id": 602543, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/51fe439b2e5e18dd43ac828767d0b774?s=128&d=identicon&r=PG&f=1", "display_name": "Edwin Evans", "link": "https://stackoverflow.com/users/602543/edwin-evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484000131, "creation_date": 1483999762, "last_edit_date": 1484000131, "question_id": 41557809, "link": "https://stackoverflow.com/questions/41557809/why-arent-i-see-anything-useful-in-logcat-when-calling-method-from-kotlin", "title": "Why aren&#39;t I see anything useful in logcat when calling method from Kotlin?", "body": "<p>I have this code:</p>\n\n<pre><code>import org.json.JSONObject\n...\nLog.d(\"log\", \"I see this log message\")\nval jsonData : JSONObject = JSONObject(\"NOT|JSON\")\nLog.d(\"log\", \"I don't get here but don't see any exception logged\")\n</code></pre>\n\n<p>I don't expect to see the second log message since the JSONObject call will fail. But I don't see anything in log to indicate where the failure happened. This happens when inside an asynchronous callback. Any idea?</p>\n"}, {"tags": ["reflection", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 676, "user_id": 2987910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DAZWb.jpg?s=128&g=1", "display_name": "arcuri82", "link": "https://stackoverflow.com/users/2987910/arcuri82"}, "edited": false, "score": 0, "creation_date": 1484163621, "post_id": 41572806, "comment_id": 70401365, "body": "thx. unfortunately, I cannot try 1.1, as it does not seem available yet on Maven Central (<a href=\"https://repo.maven.apache.org/maven2/org/jetbrains/kotlin/kotlin-maven-plugin/\" rel=\"nofollow noreferrer\">repo.maven.apache.org/maven2/org/jetbrains/kotlin/&hellip;</a>) Once it will be available, I will try it out, and see how that <code>if</code> statement can be simplified with <code>isSubtypeOf</code>"}], "tags": [], "owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "is_accepted": false, "score": 2, "last_activity_date": 1549375118, "last_edit_date": 1549375118, "creation_date": 1484063339, "answer_id": 41572806, "question_id": 41553647, "link": "https://stackoverflow.com/questions/41553647/kotlin-isassignablefrom-and-reflection-type-checks/41572806#41572806", "title": "Kotlin: isAssignableFrom and reflection type checks", "body": "<p>No, there is not a better way pre-1.1 Kotlin.</p>\n\n<p>You can use <code>Int::class.javaObjectType</code> instead of <code>Integer.TYPE</code> to avoid using <code>java.lang.Integer</code> in Kotlin code but that makes the statement even longer (although more idiomatic).</p>\n\n<p>In Kotlin 1.1 you can use <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.reflect.full/is-subtype-of.html#issubtypeof\" rel=\"nofollow noreferrer\"><code>isSubtypeOf</code></a> or query <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.reflect.jvm/jvm-erasure.html\" rel=\"nofollow noreferrer\"><code>jvmErasure</code></a>.<a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.reflect.full/all-supertypes.html#allsupertypes\" rel=\"nofollow noreferrer\"><code>allSupertypes</code></a> directly.</p>\n"}], "owner": {"reputation": 676, "user_id": 2987910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DAZWb.jpg?s=128&g=1", "display_name": "arcuri82", "link": "https://stackoverflow.com/users/2987910/arcuri82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4695, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1549375118, "creation_date": 1483983176, "question_id": 41553647, "link": "https://stackoverflow.com/questions/41553647/kotlin-isassignablefrom-and-reflection-type-checks", "title": "Kotlin: isAssignableFrom and reflection type checks", "body": "<p>In Kotlin (1.0.6), through reflection I need to iterate over the members of a class (let's call it <code>Foo</code>), and do something based on the return type. I can write the following, which works:</p>\n\n<pre><code>Foo::class.members{ m -&gt;\n    if(Integer.TYPE.isAssignableFrom(m.returnType.javaType as Class&lt;*&gt;)){\n        //do something here\n    } else if ...\n}\n</code></pre>\n\n<p>the problem is that the <code>if</code> statement (to handle <code>kotlin.Int</code>) is quite ugly. Is there any better way in Kotlin to achieve the same result without having to rely directly on the Java API?</p>\n"}, {"tags": ["intellij-idea", "kotlin"], "comments": [{"owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "edited": false, "score": 0, "creation_date": 1483982777, "post_id": 41553515, "comment_id": 70312200, "body": "Have you tried File | Invalidate Caches and restart?"}, {"owner": {"reputation": 70, "user_id": 5830060, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/L7E0H.png?s=128&g=1", "display_name": "Mariell Hoversholm", "link": "https://stackoverflow.com/users/5830060/mariell-hoversholm"}, "reply_to_user": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "edited": false, "score": 0, "creation_date": 1483984365, "post_id": 41553515, "comment_id": 70313075, "body": "Just tried, @yole, but to no luck, sadly."}], "owner": {"reputation": 70, "user_id": 5830060, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/L7E0H.png?s=128&g=1", "display_name": "Mariell Hoversholm", "link": "https://stackoverflow.com/users/5830060/mariell-hoversholm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1483982695, "creation_date": 1483982695, "question_id": 41553515, "link": "https://stackoverflow.com/questions/41553515/intellij-imports-java-boolean-and-then-throws-error", "title": "IntelliJ imports Java Boolean and then throws error", "body": "<p>(First of all, yes, Minecraft plugin development. Live with it)</p>\n\n<p>So, I'm developing Kotlin in IntelliJ IDEA Ultimate, but it really hates me when it comes to importing <code>java.lang.Boolean</code> instead of <code>kotlin.Boolean</code> automagically.</p>\n\n<p>My Kotlin plugin is fully up to date, and so is IntelliJ according to JB Toolbox.</p>\n\n<p>Every time I press <code>CTRL+ALT+L</code> to auto-format and auto-import it imports <code>java.lang.Boolean</code> and then throws errors all over in the file that I should use <code>kotlin.Boolean</code>. Indeed, it's as simple as removing the import, but that's extra effort for nothing, as it should be able to do this itself. It may have something to do with extending a Java class, which has methods returning a Java Boolean, but I don't see how this would be the case, as it's simply way too annoying and more users should have noted it before.</p>\n\n<p>If I change the return type to <code>java.lang.Boolean</code> it says the overridden class, with no connection whatsoever to Kotlin STD-Lib, uses the Kotlin version and that I should change it to <code>kotlin.Boolean</code>. This has annoyed me a while now, so do anyone have any idea?</p>\n\n<p>The file in question is by the way this: <a href=\"https://gitlab.com/proximyst/HellishSurvival/blob/master/Plugin/src/main/java/com/proximyst/hellishsurvival/Commands.kt\" rel=\"nofollow noreferrer\">https://gitlab.com/proximyst/HellishSurvival/blob/master/Plugin/src/main/java/com/proximyst/hellishsurvival/Commands.kt</a></p>\n"}, {"tags": ["java", "kotlin", "decimalformat"], "answers": [{"tags": [], "owner": {"reputation": 89682, "user_id": 675383, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e7a971eb341ffeaa3efca407239bf3b?s=128&d=identicon&r=PG", "display_name": "nhaarman", "link": "https://stackoverflow.com/users/675383/nhaarman"}, "is_accepted": true, "score": 2, "last_activity_date": 1483957569, "creation_date": 1483957569, "answer_id": 41545834, "question_id": 41545690, "link": "https://stackoverflow.com/questions/41545690/decimalformat-precision-not-working-correctly/41545834#41545834", "title": "DecimalFormat precision not working correctly", "body": "<p>You're converting the <code>String</code> back to <code>Float</code>, thereby losing the format the <code>String</code> was in.</p>\n\n<p>Instead, just print the output of <code>format</code>:</p>\n\n<pre><code>println(formatter.format(20.0f))\n</code></pre>\n\n<p>If you want the extra 'f', put it in your pattern:</p>\n\n<pre><code>val pattern = if (precision &gt; 0) {\n    \"#0.${\"0\".repeat(precision)}f\"\n} else {\n    \"#f\"\n}\n</code></pre>\n"}], "owner": {"reputation": 365, "user_id": 3900210, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1c2ea656f87f465289d7fb2e3abd952f?s=128&d=identicon&r=PG&f=1", "display_name": "Sagar", "link": "https://stackoverflow.com/users/3900210/sagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 41545834, "answer_count": 1, "score": 0, "last_activity_date": 1483957569, "creation_date": 1483957168, "question_id": 41545690, "link": "https://stackoverflow.com/questions/41545690/decimalformat-precision-not-working-correctly", "title": "DecimalFormat precision not working correctly", "body": "<p>I would like to format a float using to a given precision using DecimalFormat. What I have is this</p>\n\n<pre><code>val formatter = DecimalFormat(if (precision &gt; 0) \"#0.${\"0\".repeat(precision)}\" else \"#\")\n</code></pre>\n\n<p>Lets say the precision is 2 and when I do </p>\n\n<pre><code>formatter.format(20.0f).toFloat()\n</code></pre>\n\n<p>I get the output as <code>20.0f</code> and not <code>20.00f</code></p>\n"}, {"tags": ["kotlin", "kotlin-interop"], "answers": [{"comments": [{"owner": {"reputation": 4190, "user_id": 2207729, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/076e4de85fdcd7632642b930f525cfaf?s=128&d=identicon&r=PG&f=1", "display_name": "PedroD", "link": "https://stackoverflow.com/users/2207729/pedrod"}, "edited": false, "score": 0, "creation_date": 1483913497, "post_id": 41537792, "comment_id": 70282202, "body": "Awesome! Learned a lot with this answer! Thanks!"}, {"owner": {"reputation": 4190, "user_id": 2207729, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/076e4de85fdcd7632642b930f525cfaf?s=128&d=identicon&r=PG&f=1", "display_name": "PedroD", "link": "https://stackoverflow.com/users/2207729/pedrod"}, "edited": false, "score": 0, "creation_date": 1483917575, "post_id": 41537792, "comment_id": 70283214, "body": "Ah, I suggested an edit, little did I know about the <code>it</code> syntactic sugar. Amazing, still learning :D"}, {"owner": {"reputation": 961, "user_id": 8463412, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-AsVe6ZFmeDU/AAAAAAAAAAI/AAAAAAAAADQ/pQ5YSEATEPg/photo.jpg?sz=128", "display_name": "sak", "link": "https://stackoverflow.com/users/8463412/sak"}, "edited": false, "score": 0, "creation_date": 1531993786, "post_id": 41537792, "comment_id": 89809797, "body": "What is r  in the use block?"}, {"owner": {"reputation": 630270, "user_id": 571407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2f0d9dec16bae1e06552af55ddefc11f?s=128&d=identicon&r=PG", "display_name": "JB Nizet", "link": "https://stackoverflow.com/users/571407/jb-nizet"}, "reply_to_user": {"reputation": 961, "user_id": 8463412, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-AsVe6ZFmeDU/AAAAAAAAAAI/AAAAAAAAADQ/pQ5YSEATEPg/photo.jpg?sz=128", "display_name": "sak", "link": "https://stackoverflow.com/users/8463412/sak"}, "edited": false, "score": 0, "creation_date": 1532004931, "post_id": 41537792, "comment_id": 89817320, "body": "@sak The BufferedReader"}, {"owner": {"reputation": 709, "user_id": 1709287, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AAusG.png?s=128&g=1", "display_name": "Takamitsu Mizutori", "link": "https://stackoverflow.com/users/1709287/takamitsu-mizutori"}, "edited": false, "score": 0, "creation_date": 1537869333, "post_id": 41537792, "comment_id": 91931147, "body": "In my case, I had to change <code>foreach</code> to <code>forEach</code>. Anyway, thank you so much for this answer!"}], "tags": [], "owner": {"reputation": 630270, "user_id": 571407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2f0d9dec16bae1e06552af55ddefc11f?s=128&d=identicon&r=PG", "display_name": "JB Nizet", "link": "https://stackoverflow.com/users/571407/jb-nizet"}, "is_accepted": true, "score": 33, "last_activity_date": 1549198812, "last_edit_date": 1549198812, "creation_date": 1483908865, "answer_id": 41537792, "question_id": 41537638, "link": "https://stackoverflow.com/questions/41537638/assignment-not-allowed-in-while-expression/41537792#41537792", "title": "Assignment not allowed in while expression?", "body": "<p>No, the best way, IMO, would be</p>\n\n<pre><code>val reader = BufferedReader(reader)\nreader.lineSequence().forEach {\n    println(it)\n}\n</code></pre>\n\n<p>And if you want to make sure the reader is properly closed (as you would with a try-with-resources statement in Java), you can use</p>\n\n<pre><code>BufferedReader(reader).use { r -&gt;\n    r.lineSequence().forEach {\n        println(it)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21048, "user_id": 603516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40895ef337d0a2eb7d538f5f8b3e6d58?s=128&d=identicon&r=PG", "display_name": "Vadzim", "link": "https://stackoverflow.com/users/603516/vadzim"}, "is_accepted": false, "score": 12, "last_activity_date": 1493320034, "last_edit_date": 1493320034, "creation_date": 1492854378, "answer_id": 43557686, "question_id": 41537638, "link": "https://stackoverflow.com/questions/41537638/assignment-not-allowed-in-while-expression/43557686#43557686", "title": "Assignment not allowed in while expression?", "body": "<p>Here is the shortest solution <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.io/java.io.-reader/for-each-line.html\" rel=\"noreferrer\">powered</a> by stdlib that also safely closes the reader:</p>\n\n<pre><code>reader.forEachLine {\n    println(it)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 835, "user_id": 3881432, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/z8IL6.png?s=128&g=1", "display_name": "zulkarnain shah", "link": "https://stackoverflow.com/users/3881432/zulkarnain-shah"}, "edited": false, "score": 2, "creation_date": 1528870367, "post_id": 43557893, "comment_id": 88664511, "body": "best short answer"}], "tags": [], "owner": {"reputation": 21048, "user_id": 603516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40895ef337d0a2eb7d538f5f8b3e6d58?s=128&d=identicon&r=PG", "display_name": "Vadzim", "link": "https://stackoverflow.com/users/603516/vadzim"}, "is_accepted": false, "score": 14, "last_activity_date": 1583865352, "last_edit_date": 1583865352, "creation_date": 1492855510, "answer_id": 43557893, "question_id": 41537638, "link": "https://stackoverflow.com/questions/41537638/assignment-not-allowed-in-while-expression/43557893#43557893", "title": "Assignment not allowed in while expression?", "body": "<p>And here is a short Kotlin-style general <a href=\"https://discuss.kotlinlang.org/t/assignment-not-allow-in-while-expression/339/19\" rel=\"nofollow noreferrer\">solution</a> by Roman Elizarov:</p>\n\n<pre><code>while (true) {\n    val line = reader.readLine() ?: break\n    println(line);\n}\n</code></pre>\n\n<p>Here <code>break</code> has <a href=\"https://kotlinlang.org/docs/reference/exceptions.html#the-nothing-type\" rel=\"nofollow noreferrer\">Nothing</a> type that also helps to promote type inference for the <code>line</code> as non-nullable string.    </p>\n"}, {"tags": [], "owner": {"reputation": 2573, "user_id": 3678261, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DWuqh.jpg?s=128&g=1", "display_name": "Manoj Behera", "link": "https://stackoverflow.com/users/3678261/manoj-behera"}, "is_accepted": false, "score": -1, "last_activity_date": 1523600831, "creation_date": 1523600831, "answer_id": 49810571, "question_id": 41537638, "link": "https://stackoverflow.com/questions/41537638/assignment-not-allowed-in-while-expression/49810571#49810571", "title": "Assignment not allowed in while expression?", "body": "<p>(This Example for while loop ) Hope this example will help you..</p>\n\n<p>Change from</p>\n\n<p>while ((c = <code>is</code>.read(buffer)) > 0) {\n            sb.append(String(buffer, 0, c, Charset.forName(UTF8)))\n}</p>\n\n<p>to</p>\n\n<p>while ({c = <code>is</code>.read(buffer);c}() > 0) {\n            sb.append(String(buffer, 0, c, Charset.forName(UTF8)))\n}</p>\n"}, {"tags": [], "owner": {"reputation": 17883, "user_id": 6202869, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0242e0540d33913439e284663e1a9300?s=128&d=identicon&r=PG&f=1", "display_name": "Roland", "link": "https://stackoverflow.com/users/6202869/roland"}, "is_accepted": false, "score": 2, "last_activity_date": 1548929915, "last_edit_date": 1548929915, "creation_date": 1548925596, "answer_id": 54456912, "question_id": 41537638, "link": "https://stackoverflow.com/questions/41537638/assignment-not-allowed-in-while-expression/54456912#54456912", "title": "Assignment not allowed in while expression?", "body": "<p>In cases you just want to replace <code>while ((x = y.someFunction()) != null)</code> you may use the following instead:</p>\n\n<pre><code>generateSequence { y.someFunction() }\n          .forEach { x -&gt; /* what you did in your while */ }\n</code></pre>\n\n<p><a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.sequences/generate-sequence.html\" rel=\"nofollow noreferrer\"><code>generateSequence</code></a> will extract you all the values one by one until the first <code>null</code> is reached. You may replace the <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.sequences/for-each.html\" rel=\"nofollow noreferrer\"><code>.forEach</code></a> with a <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.sequences/reduce.html\" rel=\"nofollow noreferrer\"><code>reduce</code></a> or <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.sequences/fold.html\" rel=\"nofollow noreferrer\"><code>fold</code></a> (or anything else that seems appropriate ;-)) if you want to keep the last value or sum up the values to something else.</p>\n\n<p>For your specific use case however you may just use what <a href=\"https://stackoverflow.com/a/41537792/6202869\">JB Nizet in his answer</a> has shown or use <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.io/java.io.-reader/use-lines.html#uselines\" rel=\"nofollow noreferrer\"><code>useLines</code></a>:</p>\n\n<pre><code>reader.useLines {\n  it.forEach(::println)\n}\n</code></pre>\n\n<p><a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.io/java.io.-reader/for-each-line.html\" rel=\"nofollow noreferrer\"><code>.forEachLine</code></a> is probably the next best short-hand solution to that specific <code>readLine</code>-problem (already answered <a href=\"https://stackoverflow.com/a/43557686/6202869\">here</a>) if you know you just want to read all lines and then stop.</p>\n"}, {"tags": [], "owner": {"reputation": 529, "user_id": 1101199, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/kHyc3.jpg?s=128&g=1", "display_name": "jyshin", "link": "https://stackoverflow.com/users/1101199/jyshin"}, "is_accepted": false, "score": 0, "last_activity_date": 1619066649, "creation_date": 1619066649, "answer_id": 67206892, "question_id": 41537638, "link": "https://stackoverflow.com/questions/41537638/assignment-not-allowed-in-while-expression/67206892#67206892", "title": "Assignment not allowed in while expression?", "body": "<p>I found that these days IntelliJ converts your Java code into the following kotlin code:</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>val br = BufferedReader(InputStreamReader(\n        conn.inputStream))\n\nvar output: String\nwhile (br.readLine().also { output = it } != null) {\n    println(output)\n}\n</code></pre>\n<p>This is still confusing but it's quite readable. It uses the fact that <code>also</code> returns the receiver instance (the result of <code>br.readLine()</code> here).</p>\n"}], "owner": {"reputation": 4190, "user_id": 2207729, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/076e4de85fdcd7632642b930f525cfaf?s=128&d=identicon&r=PG&f=1", "display_name": "PedroD", "link": "https://stackoverflow.com/users/2207729/pedrod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6734, "favorite_count": 6, "accepted_answer_id": 41537792, "answer_count": 6, "score": 19, "last_activity_date": 1619066649, "creation_date": 1483908015, "question_id": 41537638, "link": "https://stackoverflow.com/questions/41537638/assignment-not-allowed-in-while-expression", "title": "Assignment not allowed in while expression?", "body": "<p>In Java we can usually perform an assignment within the <code>while</code> condition. However Kotlin complains about it. So the following code does not compile:</p>\n\n<pre><code>val br = BufferedReader(InputStreamReader(\n        conn.inputStream))\n\nvar output: String\nprintln(\"Output from Server .... \\n\")\nwhile ((output = br.readLine()) != null) { // &lt;--- error here: Assignments are not expressions, and only expressions are allowed in this context\n    println(output)\n}\n</code></pre>\n\n<p>According to this other <a href=\"https://discuss.kotlinlang.org/t/assignment-not-allow-in-while-expression/339/6\" rel=\"noreferrer\">thread</a>, this seems the best solution:</p>\n\n<pre><code>val reader = BufferedReader(reader)\nvar line: String? = null;\nwhile ({ line = reader.readLine(); line }() != null) { // &lt;--- The IDE asks me to replace this line for while(true), what the...?\n  System.out.println(line);\n}\n</code></pre>\n\n<p>But is it?</p>\n"}, {"tags": ["android", "kotlin"], "comments": [{"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1483911564, "post_id": 41536009, "comment_id": 70281615, "body": "Why do you think it is not possible? It should work the same. Please explain what problems you have with the second code snippet."}, {"owner": {"reputation": 12970, "user_id": 2741273, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/71f8f37ebda905a8fffeb75e91b87a89?s=128&d=identicon&r=PG&f=1", "display_name": "Francesc", "link": "https://stackoverflow.com/users/2741273/francesc"}, "reply_to_user": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1483915007, "post_id": 41536009, "comment_id": 70282616, "body": "It doesn&#39;t compile, updated with compiler error."}], "answers": [{"comments": [{"owner": {"reputation": 12970, "user_id": 2741273, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/71f8f37ebda905a8fffeb75e91b87a89?s=128&d=identicon&r=PG&f=1", "display_name": "Francesc", "link": "https://stackoverflow.com/users/2741273/francesc"}, "edited": false, "score": 3, "creation_date": 1483980214, "post_id": 41541218, "comment_id": 70310648, "body": "Turns out one already exists: <a href=\"https://youtrack.jetbrains.com/issue/KT-10930\" rel=\"nofollow noreferrer\">youtrack.jetbrains.com/issue/KT-10930</a>"}, {"owner": {"reputation": 7289, "user_id": 3736955, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1647d5d7348d070ae95df49253385ee1?s=128&d=identicon&r=PG", "display_name": "Jemshit Iskenderov", "link": "https://stackoverflow.com/users/3736955/jemshit-iskenderov"}, "edited": false, "score": 0, "creation_date": 1533221058, "post_id": 41541218, "comment_id": 90276411, "body": "I think there is also problem with &quot;old&quot;, &quot;new&quot;. &quot;old&quot; becomes &quot;new&quot; somehow, so it is println(&quot;$new -&gt; $new&quot;) after some point"}], "tags": [], "owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "is_accepted": true, "score": 69, "last_activity_date": 1483937552, "creation_date": 1483937552, "answer_id": 41541218, "question_id": 41536009, "link": "https://stackoverflow.com/questions/41536009/kotlin-nullable-property-delegate-observable/41541218#41541218", "title": "Kotlin: nullable property delegate observable", "body": "<p>For some reason the type inference fails here. You have to specify the type of the delegate manually. Instead you can omit the property type declaration: </p>\n\n<pre><code>var name by Delegates.observable&lt;String?&gt;(\"&lt;no name&gt;\") {\n    prop, old, new -&gt;\n    println(\"$old -&gt; $new\")\n}\n</code></pre>\n\n<p>Please file an issue at <a href=\"https://youtrack.jetbrains.com/issues/KT\" rel=\"noreferrer\">https://youtrack.jetbrains.com/issues/KT</a> </p>\n"}], "owner": {"reputation": 12970, "user_id": 2741273, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/71f8f37ebda905a8fffeb75e91b87a89?s=128&d=identicon&r=PG&f=1", "display_name": "Francesc", "link": "https://stackoverflow.com/users/2741273/francesc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5393, "favorite_count": 1, "accepted_answer_id": 41541218, "answer_count": 1, "score": 31, "last_activity_date": 1483937552, "creation_date": 1483898855, "last_edit_date": 1483914997, "question_id": 41536009, "link": "https://stackoverflow.com/questions/41536009/kotlin-nullable-property-delegate-observable", "title": "Kotlin: nullable property delegate observable", "body": "<p>In Kotlin we can define an observable for a non-null property,</p>\n\n<pre><code>var name: String by Delegates.observable(\"&lt;no name&gt;\") {\n    prop, old, new -&gt;\n    println(\"$old -&gt; $new\")\n}\n</code></pre>\n\n<p>however this is not possible</p>\n\n<pre><code>var name: String? by Delegates.observable(\"&lt;no name&gt;\") {\n    prop, old, new -&gt;\n    println(\"$old -&gt; $new\")\n}\n</code></pre>\n\n<p>What would be the way to define an observable for a nullable property?</p>\n\n<p>Edit: this is the compile error</p>\n\n<pre><code>Property delegate must have a 'setValue(DataEntryRepositoryImpl, KProperty&lt;*&gt;, String?)' method. None of the following functions is suitable: \npublic abstract operator fun setValue(thisRef: Any?, property: KProperty&lt;*&gt;, value: String): Unit defined in kotlin.properties.ReadWriteProperty\n</code></pre>\n"}, {"tags": ["android", "mockito", "kotlin", "android-testing"], "answers": [{"comments": [{"owner": {"reputation": 711, "user_id": 1232726, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Bg5nq.jpg?s=128&g=1", "display_name": "filthy_wizard", "link": "https://stackoverflow.com/users/1232726/filthy-wizard"}, "edited": false, "score": 0, "creation_date": 1483901912, "post_id": 41535453, "comment_id": 70278310, "body": "ah yes. I see what I did now. sheer idiocy on my part!"}], "tags": [], "owner": {"reputation": 1117, "user_id": 917624, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2c8d99efd512b529035e3f7c45854c78?s=128&d=identicon&r=PG", "display_name": "Sri", "link": "https://stackoverflow.com/users/917624/sri"}, "is_accepted": true, "score": 3, "last_activity_date": 1483895820, "creation_date": 1483895820, "answer_id": 41535453, "question_id": 41535273, "link": "https://stackoverflow.com/questions/41535273/nullpointerexception-on-sharedpreferences-helper-class-when-running-a-test/41535453#41535453", "title": "nullPointerException on sharedpreferences helper class When running a test", "body": "<p>You should set expectations for the call below, on your mock object (<code>mockprefsedit</code>). As well for the object returned, on which <code>commit</code> is invoked.</p>\n\n<pre><code>edit!!.putString(key, value)\n</code></pre>\n\n<p>thanks\nSriram</p>\n"}], "owner": {"reputation": 711, "user_id": 1232726, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Bg5nq.jpg?s=128&g=1", "display_name": "filthy_wizard", "link": "https://stackoverflow.com/users/1232726/filthy-wizard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 886, "favorite_count": 0, "accepted_answer_id": 41535453, "answer_count": 1, "score": 3, "last_activity_date": 1515430157, "creation_date": 1483894813, "last_edit_date": 1515430157, "question_id": 41535273, "link": "https://stackoverflow.com/questions/41535273/nullpointerexception-on-sharedpreferences-helper-class-when-running-a-test", "title": "nullPointerException on sharedpreferences helper class When running a test", "body": "<p>I'm starting to use Kotlin on a little demo android app. I've created a <code>sharedpreferences</code> helper class which i'm trying to test with Junit and Mockito. Below is my sharedprefshelper:</p>\n\n<pre><code>public class SharedPrefsHelperImp( cont : Context) : SharedPrefsHelper {\n\nval prefsname: String = \"prefs\"\nvar prefs: SharedPreferences? = null\nvar edit: SharedPreferences.Editor? = null\n\n\ninit {\n    prefs = cont.getSharedPreferences(prefsname, Context.MODE_PRIVATE)\n    edit = prefs!!.edit()\n}\n\n\n\noverride fun getPrefsStringValue(key: String) : String {\n    return prefs!!.getString(key, \"\")\n}\n\n override fun addPrefsStringVal( key : String,  value: String)  {\n        edit!!.putString(key, value).commit()\n}\n\noverride fun getSharedPrefsBool(key : String): Boolean {\n    return prefs!!.getBoolean(key, false)\n}\n\noverride fun addSharedPrefsBool(key : String, value : Boolean) {\n        edit!!.putBoolean(key, value).commit()\n}\n}\n</code></pre>\n\n<p>here is my test class:</p>\n\n<pre><code>class SharedPrefsHelperImpTest {\n\n@Mock var  cont : Context? = null\n@Mock var mockprefs : SharedPreferences? = null\n@Mock var mockprefsedit : SharedPreferences.Editor? = null\nvar prefshelper : SharedPrefsHelper? = null\n\n@Before\nfun setUp() {\n\n    //MockitoAnnotations.initMocks(this)\n    cont = Mockito.mock(Context::class.java)\n    mockprefs = Mockito.mock(SharedPreferences::class.java)\n    mockprefsedit = Mockito.mock(SharedPreferences.Editor::class.java)\n\n    `when`(cont!!.getSharedPreferences(anyString(), anyInt())).thenReturn(mockprefs!!)\n    `when`(mockprefs!!.edit()).thenReturn(mockprefsedit!!)\n\n    prefshelper = SharedPrefsHelperImp(cont!!)\n}\n\n@Test\nfun testNotNull(){\n    Assert.assertNotNull(cont)\n    Assert.assertNotNull(mockprefs)\n    Assert.assertNotNull(mockprefsedit)\n}\n\n@Test\nfun testItemAdded()\n{\n    prefshelper!!.addPrefsStringVal(\"thing\", \"thing\")\n    verify(mockprefsedit)!!.putString(anyString(), anyString())\n}\n\n@Test\nfun testGetString()\n{\n    prefshelper!!.getPrefsStringValue(\"key\")\n    verify(mockprefs)!!.getString(\"key\", \"\")\n}\n\n}\n</code></pre>\n\n<p>Issue is when I call <code>addPrefsValueString()</code> in the helper. the line</p>\n\n<p>edit!!.putString(key, value).commit()</p>\n\n<p>throws a null pointer exception? not sure why? I've setup the mock <code>sharedprefs</code> and  <code>sharedpreferences.Edit</code> in the test class method annotated with <code>@Before</code> (shown below)</p>\n\n<pre><code>@Before\nfun setUp() {\n\n    //MockitoAnnotations.initMocks(this)\n    cont = Mockito.mock(Context::class.java)\n    mockprefs = Mockito.mock(SharedPreferences::class.java)\n    mockprefsedit = Mockito.mock(SharedPreferences.Editor::class.java)\n\n    `when`(cont!!.getSharedPreferences(anyString(), anyInt())).thenReturn(mockprefs!!)\n    `when`(mockprefs!!.edit()).thenReturn(mockprefsedit!!)\n\n    prefshelper = SharedPrefsHelperImp(cont!!)\n   }\n</code></pre>\n\n<p>i'm sure my code is less than optimal.</p>\n\n<p>EDIT:</p>\n\n<p>Here's my fix for the <code>testItemAdded()</code> method. need to return the mock preferences editor on the first call. </p>\n\n<pre><code>@Test\nfun testItemAdded()\n{\n    `when`(mockprefsedit?.putString(anyString(), anyString())).thenReturn(mockprefsedit)\n    `when`(mockprefsedit?.commit()).thenReturn(true)\n    prefshelper!!.addPrefsStringVal(\"thing\", \"thing\")\n\n    verify(mockprefsedit)!!.putString(anyString(), anyString())\n    verify(mockprefsedit)!!.commit()\n}\n</code></pre>\n"}, {"tags": ["java", "android", "rx-java", "kotlin"], "comments": [{"owner": {"reputation": 34634, "user_id": 2444099, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ad5Vz.jpg?s=128&g=1", "display_name": "Eugen Pechanec", "link": "https://stackoverflow.com/users/2444099/eugen-pechanec"}, "edited": false, "score": 0, "creation_date": 1483896720, "post_id": 41534995, "comment_id": 70276234, "body": "No for loops, no forEach. Basically everything has to be observable, including <code>addHeaderToPDF</code> and <code>addFooterToPDF</code>. <code>calculateWage</code> should return a <code>Single</code>, it either returns one value or errors."}, {"owner": {"reputation": 45, "user_id": 2087212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/149489da3cd331368330ef90f790011c?s=128&d=identicon&r=PG", "display_name": "szantogab", "link": "https://stackoverflow.com/users/2087212/szantogab"}, "reply_to_user": {"reputation": 34634, "user_id": 2444099, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ad5Vz.jpg?s=128&g=1", "display_name": "Eugen Pechanec", "link": "https://stackoverflow.com/users/2444099/eugen-pechanec"}, "edited": false, "score": 0, "creation_date": 1483899938, "post_id": 41534995, "comment_id": 70277580, "body": "<code>calculateWage</code> is an <code>Observable</code> because it emits the recalculated values of an employee upon a change. Can you please show me an example how to do this right? I cannot put the puzzle together. :("}, {"owner": {"reputation": 34634, "user_id": 2444099, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ad5Vz.jpg?s=128&g=1", "display_name": "Eugen Pechanec", "link": "https://stackoverflow.com/users/2444099/eugen-pechanec"}, "edited": false, "score": 0, "creation_date": 1483912660, "post_id": 41534995, "comment_id": 70281970, "body": "~Good, but how&#39;s a changing value going to help you print an immutable PDF? You need one value of wage at the time of printing of each emloyee.~ Understood, it&#39;s an observable to begin with. I&#39;m working on something concise, stay tuned..."}, {"owner": {"reputation": 34634, "user_id": 2444099, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ad5Vz.jpg?s=128&g=1", "display_name": "Eugen Pechanec", "link": "https://stackoverflow.com/users/2444099/eugen-pechanec"}, "edited": false, "score": 1, "creation_date": 1486723834, "post_id": 41534995, "comment_id": 71480232, "body": "Read this <a href=\"http://konmik.com/post/when_to_not_use_rxjava/\" rel=\"nofollow noreferrer\">konmik.com/post/when_to_not_use_rxjava</a>"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 2087212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/149489da3cd331368330ef90f790011c?s=128&d=identicon&r=PG", "display_name": "szantogab", "link": "https://stackoverflow.com/users/2087212/szantogab"}, "edited": false, "score": 0, "creation_date": 1483905418, "post_id": 41536392, "comment_id": 70279524, "body": "In the meantime I figured out that it will not work, because in the <code>doOnNext</code> and <code>doOnCompleted</code> closure I need to reach the PDF file that is created in the <code>doOnSubscribe</code> closure. How to do that? :S"}], "tags": [], "owner": {"reputation": 45, "user_id": 2087212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/149489da3cd331368330ef90f790011c?s=128&d=identicon&r=PG", "display_name": "szantogab", "link": "https://stackoverflow.com/users/2087212/szantogab"}, "is_accepted": false, "score": 0, "last_activity_date": 1483900895, "creation_date": 1483900895, "answer_id": 41536392, "question_id": 41534995, "link": "https://stackoverflow.com/questions/41534995/rxjava-observable-to-completable-how-to-avoid-toblocking/41536392#41536392", "title": "RxJava Observable to Completable, how to avoid toBlocking()", "body": "<p>I came up with this:</p>\n\n<pre><code>    return employeeService.all().first()\n            .doOnSubscribe { addHeaderToPDF() }\n            .flatMapIterable { it }\n            .flatMap { employeeService.calculateWage(it.id).first() }\n            .doOnNext { printEmployeeWage(it) }\n            .doOnCompleted { addFooterToPDF }\n            .toCompletable()\n</code></pre>\n\n<p>Is this how it is supposed to be done? :)</p>\n"}, {"comments": [{"owner": {"reputation": 713, "user_id": 242838, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Ai2Zz.jpg?s=128&g=1", "display_name": "kar", "link": "https://stackoverflow.com/users/242838/kar"}, "edited": false, "score": 0, "creation_date": 1484183597, "post_id": 41540048, "comment_id": 70409511, "body": "Nice, but what do you gain by using observables in this scenario?"}, {"owner": {"reputation": 34634, "user_id": 2444099, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ad5Vz.jpg?s=128&g=1", "display_name": "Eugen Pechanec", "link": "https://stackoverflow.com/users/2444099/eugen-pechanec"}, "reply_to_user": {"reputation": 713, "user_id": 242838, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Ai2Zz.jpg?s=128&g=1", "display_name": "kar", "link": "https://stackoverflow.com/users/242838/kar"}, "edited": false, "score": 1, "creation_date": 1484205408, "post_id": 41540048, "comment_id": 70416102, "body": "@KarsenGauss The input is one observable + one more observable for each employee. I went the rx way for as long as my mind allowed me after a week of rx. That was the goal: <i>No mixing of blocking and non-blocking code, stream for as long as possible.</i> And as mentioned another step would be to convert more blocking code to rx."}, {"owner": {"reputation": 713, "user_id": 242838, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Ai2Zz.jpg?s=128&g=1", "display_name": "kar", "link": "https://stackoverflow.com/users/242838/kar"}, "edited": false, "score": 1, "creation_date": 1484226353, "post_id": 41540048, "comment_id": 70429152, "body": "Your answer is great, don&#39;t get me wrong. I am just trying to highlight that sometimes it may be worth to take a step back and consider a non-reactive approach. I don&#39;t see that many benefits of a reactive solution for @szantogab&#39;s problem."}, {"owner": {"reputation": 34634, "user_id": 2444099, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ad5Vz.jpg?s=128&g=1", "display_name": "Eugen Pechanec", "link": "https://stackoverflow.com/users/2444099/eugen-pechanec"}, "reply_to_user": {"reputation": 713, "user_id": 242838, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Ai2Zz.jpg?s=128&g=1", "display_name": "kar", "link": "https://stackoverflow.com/users/242838/kar"}, "edited": false, "score": 1, "creation_date": 1484235331, "post_id": 41540048, "comment_id": 70435525, "body": "@KarsenGauss You and me both :D However there is a way to stream to PDF file at the end of this (for syantogab). And to get better at rx along the way (for me)."}], "tags": [], "owner": {"reputation": 34634, "user_id": 2444099, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ad5Vz.jpg?s=128&g=1", "display_name": "Eugen Pechanec", "link": "https://stackoverflow.com/users/2444099/eugen-pechanec"}, "is_accepted": true, "score": 3, "last_activity_date": 1483966555, "last_edit_date": 1483966555, "creation_date": 1483927895, "answer_id": 41540048, "question_id": 41534995, "link": "https://stackoverflow.com/questions/41534995/rxjava-observable-to-completable-how-to-avoid-toblocking/41540048#41540048", "title": "RxJava Observable to Completable, how to avoid toBlocking()", "body": "<p><em>Disclaimer:</em> This answer is a work in progress.</p>\n\n<hr>\n\n<p><em>Basic premise:</em> If you have <code>blocking</code> in the stream, you're doing it wrong.</p>\n\n<p><em>Note:</em> No state must leave the observable lambda.</p>\n\n<h1>Step 1: Stream the whole data set</h1>\n\n<p>The input is a stream of employees. For each employee you need to get one wage. Let's make it into one stream.</p>\n\n<pre><code>/**\n * @param employeesObservable\n * Stream of employees we're interested in.\n * @param wageProvider\n * Transformation function which takes an employee and returns a [Single] of their wage.\n * @return\n * Observable stream spitting individual [Pair]s of employees and their wages.\n */\nfun getEmployeesAndWagesObservable(\n        employeesObservable: Observable&lt;Employee&gt;,\n        wageProvider: Function&lt;Employee, Single&lt;Int&gt;&gt;\n): Observable&lt;Pair&lt;Employee, Int&gt;&gt;? {\n    val employeesAndWagesObservable: Observable&lt;Pair&lt;Employee, Int&gt;&gt;\n\n    // Each Employee from the original stream will be converted\n    // to a Single&lt;Pair&lt;Employee, Int&gt;&gt; via flatMapSingle operator.\n    // Remember, we need a stream and Single is a stream.\n    employeesAndWagesObservable = employeesObservable.flatMapSingle { employee -&gt;\n        // We need to get a source of wage value for current employee.\n        // That source emits a single Int or errors.\n        val wageForEmployeeSingle: Single&lt;Int&gt; = wageProvider.apply(employee)\n\n        // Once the wage from said source is loaded...\n        val employeeAndWageSingle: Single&lt;Pair&lt;Employee, Int&gt; = wageForEmployeeSingle.map { wage -&gt;\n            // ... construct a Pair&lt;Employee, Int&gt;\n            employee to wage\n        }\n\n        // This code is not executed now. It will be executed for each Employee\n        // after the original Observable&lt;Employee&gt; starts spitting out items.\n        // After subscribing to the resulting observable.\n        return@flatMapSingle employeeAndWageSingle\n    }\n\n    return employeesAndWagesObservable\n}\n</code></pre>\n\n<p>What's going to happen when you subscribe:</p>\n\n<ol>\n<li>Take an employee from source.</li>\n<li>Fetch wage of an employee.</li>\n<li>Spit out a pair of employee and their wage.</li>\n</ol>\n\n<p>This repeats  until <code>employeesObservable</code> signals <code>onComplete</code> or something fails with <code>onError</code>.</p>\n\n<p>Used operators:</p>\n\n<ul>\n<li><a href=\"http://reactivex.io/documentation/single.html\" rel=\"nofollow noreferrer\">flatMapSingle</a>: Converts an actual value into a new Single stream of some transformed value.</li>\n<li><a href=\"http://reactivex.io/documentation/operators/map.html\" rel=\"nofollow noreferrer\">map</a>: Converts an actual value into some other actual value (no nested streams).</li>\n</ul>\n\n<p>Hee's how you'd hook it up to your code:</p>\n\n<pre><code>fun doStuff() {\n    val employeesObservable = employeeService.all()\n    val wageProvider = Function&lt;Employee, Single&lt;Int&gt;&gt; { employee -&gt;\n        // Don't listen to changes. Take first wage and use that.\n        employeeService.calculateWage(employee.id).firstOrError()\n    }\n\n    val employeesAndWagesObservable = \n            getEmployeesAndWagesObservable(employeesObservable, wageProvider)\n\n    // Subscribe...\n}\n</code></pre>\n\n<p>Used operators: </p>\n\n<ul>\n<li><a href=\"http://reactivex.io/documentation/operators/first.html\" rel=\"nofollow noreferrer\">first</a>: Take the first item from observable and turn it into a Single stream.</li>\n<li><a href=\"http://reactivex.io/documentation/operators/timeout.html\" rel=\"nofollow noreferrer\">timeout</a>: A good idea would be to <code>.timeout</code> the wage if you're getting it over network.</li>\n</ul>\n\n<h1>Next steps</h1>\n\n<h2>Option 1: End here</h2>\n\n<p>Don't subscribe, call</p>\n\n<pre><code>val blockingIterable = employeesAndWagesObservable.blockingIterable()\nblockingIterable.forEach { ... }\n</code></pre>\n\n<p>and process each item in a synchronous fashion. Sit back, figure out next steps, watch presentations, read examples.</p>\n\n<h2>Option 2: Add layers</h2>\n\n<ol>\n<li><code>.map</code> each of these <code>Pair&lt;Employee, Int&gt;</code> to some abstract PDF building block.</li>\n<li>Turn your header and footer printers to Observables via <code>Observable.fromCallable { ... }</code>, have them return PDF building blocks too.</li>\n<li>Merge all of these in a sequential manner via <code>Observable.concat(headerObs, employeeDataObs, footerObs)</code></li>\n<li><code>.subscribe</code> to this result and start writing the PDF building blocks to a PDF writer.</li>\n<li>TODO:\n\n<ul>\n<li>Figure out a way to initialize the PDF writer lazily on subscription (not before building the stream),</li>\n<li>Delete output on error,</li>\n<li>Close output stream on complete or on error.</li>\n</ul></li>\n</ol>\n"}], "owner": {"reputation": 45, "user_id": 2087212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/149489da3cd331368330ef90f790011c?s=128&d=identicon&r=PG", "display_name": "szantogab", "link": "https://stackoverflow.com/users/2087212/szantogab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2553, "favorite_count": 0, "accepted_answer_id": 41540048, "answer_count": 2, "score": 4, "last_activity_date": 1483966555, "creation_date": 1483893384, "question_id": 41534995, "link": "https://stackoverflow.com/questions/41534995/rxjava-observable-to-completable-how-to-avoid-toblocking", "title": "RxJava Observable to Completable, how to avoid toBlocking()", "body": "<p>I am currently using RxJava on Android with Kotlin, but I have a problem and I can't solve without using toBlocking().</p>\n\n<p>I have method in employee service which returns an Observable>:</p>\n\n<pre><code>fun all(): Observable&lt;List&lt;Employee&gt;&gt;\n</code></pre>\n\n<p>This is all and good since this Observable emits the new list of employees whenever an employee changes. But I'd like to generate a PDF file from the employees, which obviously doesn't need to run everytime an employee changes. Also, I'd like to return a <code>Completable</code> object from my PDF generator method. I want to add a header to my PDF, and then iterate through the employees and calculate the wage of each employee, which also returns an Observable, and this is the place where I am using toBlocking right now. My current approach is this:</p>\n\n<pre><code>private fun generatePdf(outputStream: OutputStream): Completable {\n    return employeeService.all().map { employees -&gt;\n        try {\n                addHeaderToPDF()\n                for (i in employees) {\n                    val calculated = employeeService.calculateWage(i.id).toBlocking().first()\n                    // Print calculated to PDF....\n                }\n                addFooterToPDF()\n                return @map Completable.complete()\n            }\n            catch (e: Exception) {\n                return @map Completable.error(e)\n            }\n        }.first().toCompletable()\n</code></pre>\n\n<p>Is there any way to make this code a little cleaner using RxJava?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["android", "date", "kotlin"], "answers": [{"tags": [], "owner": {"reputation": 26172, "user_id": 49746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0IAAg.jpg?s=128&g=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/49746/todd"}, "is_accepted": true, "score": 3, "last_activity_date": 1483889946, "creation_date": 1483889946, "answer_id": 41534435, "question_id": 41533998, "link": "https://stackoverflow.com/questions/41533998/kotlin-date-daysafter-function-different-return-value-with-the-same-arguments/41534435#41534435", "title": "Kotlin Date.daysAfter function different return value with the same arguments", "body": "<blockquote>\n  <p>I'm missing something, function with the same arguments should return the same value.</p>\n</blockquote>\n\n<p>But you aren't calling it with the same values. You are calling it with two different values. </p>\n\n<p>First, you are comparing these two dates:</p>\n\n<pre><code>date arg - Sun Jan 08 09:48:57 EST 2017\n                         ^^^^^\nfirstDate.time - Sun Jan 01 09:49:04 EST 2017\n</code></pre>\n\n<p>And then you compare:</p>\n\n<pre><code>date arg - Sun Jan 08 09:49:04 EST 2017\n                         ^^^^^\nfirstDate.time - Sun Jan 01 09:49:04 EST 2017\n</code></pre>\n\n<p>Just looking at the times, it seems obvious why the first invocation gives a different answer from the second - because there IS a different number of days between them. Look at the times. In the first one, you are 6 days, 23 hours, and 53 seconds from the <code>firstDate</code>. In the second you are <em>exactly</em> 7 days.</p>\n"}], "owner": {"reputation": 2788, "user_id": 4643073, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Rf9P0.jpg?s=128&g=1", "display_name": "Tuby", "link": "https://stackoverflow.com/users/4643073/tuby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1251, "favorite_count": 0, "accepted_answer_id": 41534435, "answer_count": 1, "score": 0, "last_activity_date": 1483889946, "creation_date": 1483887149, "last_edit_date": 1592644375, "question_id": 41533998, "link": "https://stackoverflow.com/questions/41533998/kotlin-date-daysafter-function-different-return-value-with-the-same-arguments", "title": "Kotlin Date.daysAfter function different return value with the same arguments", "body": "<p>I've been wondering why my code is buggy, I discovered possible bug.</p>\n<pre><code>    fun daysAfter(date: Date): Int {\n    Log.d(&quot;DayLayout&quot;, &quot;date arg - $date&quot;)\n    Log.d(&quot;DayLayout&quot;, &quot;firstDate.time - &quot; + firstDate.time.toString())\n    val ret = date.daysAfter(firstDate.time).toInt()\n    Log.d(&quot;DayLayout&quot;, &quot;day after - &quot; + ret)\n    return ret\n}\n</code></pre>\n<p>First invocation of given function</p>\n<blockquote>\n<p>D/DayLayout: date arg - Sun Jan 08 09:48:57 EST 2017</p>\n<p>D/DayLayout: firstDate.time - Sun Jan 01 09:49:04 EST 2017</p>\n<p>D/DayLayout: day after - 6</p>\n</blockquote>\n<p>Second invocation, few secs later</p>\n<blockquote>\n<p>D/DayLayout: date arg - Sun Jan 08 09:49:04 EST 2017</p>\n<p>D/DayLayout: firstDate.time - Sun Jan 01 09:49:04 EST 2017</p>\n<p>D/DayLayout: day after - 7</p>\n</blockquote>\n<p>How is that even possible? I'm missing something, function with the same arguments should return the same value.</p>\n"}, {"tags": ["java", "kotlin", "predicate"], "answers": [{"tags": [], "owner": {"reputation": 67242, "user_id": 1189885, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/DLHqU.png?s=128&g=1", "display_name": "chrylis -cautiouslyoptimistic-", "link": "https://stackoverflow.com/users/1189885/chrylis-cautiouslyoptimistic"}, "is_accepted": true, "score": 4, "last_activity_date": 1483847824, "creation_date": 1483847824, "answer_id": 41529327, "question_id": 41529125, "link": "https://stackoverflow.com/questions/41529125/convert-kotlin-predicate-to-java/41529327#41529327", "title": "Convert kotlin predicate to java", "body": "<p>Java has lambda expressions but not a safe-navigation operator, so you'll need to expand the null check explicitly:</p>\n\n<pre><code>Iterables.filter(lst, obj -&gt; (obj != null &amp;&amp; obj.getProperty() != null));\n</code></pre>\n"}], "owner": {"reputation": 2369, "user_id": 2368378, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7c8279746f23ffb743727947864f71fd?s=128&d=identicon&r=PG", "display_name": "Tim Nuwin", "link": "https://stackoverflow.com/users/2368378/tim-nuwin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 41529327, "answer_count": 1, "score": 1, "last_activity_date": 1483847824, "creation_date": 1483845435, "question_id": 41529125, "link": "https://stackoverflow.com/questions/41529125/convert-kotlin-predicate-to-java", "title": "Convert kotlin predicate to java", "body": "<p>How do you convert this Kotlin predicate to java:</p>\n\n<pre><code>List&lt;SomeObjWithProp&gt; lst = ...\nIterables.filter(lst) { obj -&gt; obj?.property != null }\n</code></pre>\n"}, {"tags": ["java", "annotations", "kotlin"], "comments": [{"owner": {"reputation": 1012, "user_id": 2448440, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1e087e22595668ec941533856e078bad?s=128&d=identicon&r=PG", "display_name": "Qw3ry", "link": "https://stackoverflow.com/users/2448440/qw3ry"}, "edited": false, "score": 0, "creation_date": 1562317229, "post_id": 41528843, "comment_id": 100344924, "body": "Did you solve this? Would be interested in a solution to this precise use-case (antlr + kotlin)"}], "answers": [{"tags": [], "owner": {"reputation": 628808, "user_id": 139985, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=128&d=identicon&r=PG", "display_name": "Stephen C", "link": "https://stackoverflow.com/users/139985/stephen-c"}, "is_accepted": true, "score": 2, "last_activity_date": 1484024878, "last_edit_date": 1484024878, "creation_date": 1483843971, "answer_id": 41528979, "question_id": 41528843, "link": "https://stackoverflow.com/questions/41528843/annotating-generated-java-source-nullability-for-kotlin/41528979#41528979", "title": "Annotating generated Java source nullability (for Kotlin)", "body": "<p>The best way would be to modify the source code generator so that it includes the annotations that you require.</p>\n\n<p>If you can't modify the generator (e.g. because the generator is proprietary and you don't have its source code) then you can do this using bytecode engineering.  For example, this page on the ASM site gives one way to do it:</p>\n\n<ul>\n<li><a href=\"http://asm.ow2.org/doc/tutorial-annotations.html\" rel=\"nofollow noreferrer\">http://asm.ow2.org/doc/tutorial-annotations.html</a></li>\n</ul>\n\n<p>Of course, in either case you need some way to tell the tool (the generator, the bytecode rewriter, whatever) which methods should be annotated.</p>\n"}], "owner": {"reputation": 990, "user_id": 3019990, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3rUcM.png?s=128&g=1", "display_name": "CAD97", "link": "https://stackoverflow.com/users/3019990/cad97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 41528979, "answer_count": 1, "score": 1, "last_activity_date": 1484060677, "creation_date": 1483842514, "last_edit_date": 1484060677, "question_id": 41528843, "link": "https://stackoverflow.com/questions/41528843/annotating-generated-java-source-nullability-for-kotlin", "title": "Annotating generated Java source nullability (for Kotlin)", "body": "<p>I am generating Java source files for my project using a source generation tool (<a href=\"/questions/tagged/antlr\" class=\"post-tag\" title=\"show questions tagged &#39;antlr&#39;\" rel=\"tag\">antlr</a>). However, I am writing most, if not all of my code, in Kotlin.</p>\n\n<p>Kotlin already offers <a href=\"https://kotlinlang.org/docs/reference/java-interop.html\" rel=\"nofollow noreferrer\">great Java interop</a>, so using the generated sources is not a problem. However, because of how Kotlin <a href=\"https://kotlinlang.org/docs/reference/java-interop.html#null-safety-and-platform-types\" rel=\"nofollow noreferrer\">brings Java's nullable types into a null-safe system</a>, I lose most of the null-safety that I use Kotlin for. At the very best I have warnings of platform types (make type explicit to avoid subtle bugs); at the worst I have unexpected crashes and subtle bugs.</p>\n\n<p>Kotlin does, however, respect <a href=\"https://kotlinlang.org/docs/reference/java-interop.html#nullability-annotations\" rel=\"nofollow noreferrer\">nullability annotations</a>, such as JSR-305, FindBugs, Lombok, Eclipse, and JetBrains's respective forms of <code>@Nullable</code>/<code>@NonNull</code>, bringing those in as the appropriate non-null type or optional.</p>\n\n<p>Because the code is generated and I have access to the source (and understand how it works), I know which functions can/not return <code>null</code>, and want to annotate them as such so they include neatly into my null-safe code. However, I cannot add annotations directly into the code, as it is generated during the build step and would overwrite any manual changes.</p>\n\n<p><strong>Is it possible to / what is the best way to annotate the nullability of generated java sources for the purpose of use in null-safe code?</strong></p>\n"}, {"tags": ["java", "unit-testing", "junit", "kotlin", "annotation-processing"], "answers": [{"tags": [], "owner": {"reputation": 3604, "user_id": 1643723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20e16eeec789c8b7281a9d7dd56b8030?s=128&d=identicon&r=PG", "display_name": "user1643723", "link": "https://stackoverflow.com/users/1643723/user1643723"}, "is_accepted": true, "score": 2, "last_activity_date": 1484119383, "creation_date": 1484119383, "answer_id": 41584941, "question_id": 41528471, "link": "https://stackoverflow.com/questions/41528471/java-annotation-processor-annotated-kotlin-classes-unit-tests/41584941#41584941", "title": "Java annotation processor - Annotated Kotlin classes unit tests", "body": "<p>Kotlin integrates with ordinary Java annotation processors by generating \"stubs\" (empty class carcasses, that have same semantic/methods/fields as target Kotlin classes) <sup><a href=\"https://blog.jetbrains.com/kotlin/2015/06/better-annotation-processing-supporting-stubs-in-kapt/\" rel=\"nofollow noreferrer\">[1]</a></sup>. This means, that unit-testing Java annotation processors with <code>kapt</code> is essentially impossible \u2014 even if you somehow integrate the Kotlin tooling in your testing flow, you will end up testing <code>kapt</code> itself, rather then your own code.</p>\n\n<p>If you want to ensure, that your annotation processing code works with Kotlin-generated stubs, just generate all possible invariants that may be produced by stub generator, and use those as test subjects like any ordinary Java code.</p>\n"}], "owner": {"reputation": 143, "user_id": 5017462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39805e850a93b4c315b7f6b0c01548eb?s=128&d=identicon&r=PG&f=1", "display_name": "Robot Monkey", "link": "https://stackoverflow.com/users/5017462/robot-monkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 700, "favorite_count": 2, "accepted_answer_id": 41584941, "answer_count": 1, "score": 5, "last_activity_date": 1484119383, "creation_date": 1483838577, "question_id": 41528471, "link": "https://stackoverflow.com/questions/41528471/java-annotation-processor-annotated-kotlin-classes-unit-tests", "title": "Java annotation processor - Annotated Kotlin classes unit tests", "body": "<p>I have an annotation processor <a href=\"https://github.com/LachlanMcKee/gsonpath\" rel=\"noreferrer\">library</a> that I would like to get working for Kotlin, however I have hit a snag in terms of my unit testing. I would really appreciate if someone could give me some advice.</p>\n\n<p>My current unit testing implementation uses Google's <a href=\"https://github.com/google/compile-testing\" rel=\"noreferrer\">compile-testing</a> library. I create input and output classes and store them in the resources directory. Then during the unit test, the compile-testing library compiles the input java class, executes the annotation processor and then compares the generated classes against the expected output class from the resources directory.</p>\n\n<p>Here is an example (from my project) of what I am referring to:\n<a href=\"https://github.com/LachlanMcKee/gsonpath/blob/feature/updated-compiler-to-use-kotlin/gsonpath-compiler/src/test/java/gsonpath/generator/adapter/auto/FieldTypesTest.kt\" rel=\"noreferrer\">Unit test class</a>\n<a href=\"https://github.com/LachlanMcKee/gsonpath/tree/feature/updated-compiler-to-use-kotlin/gsonpath-compiler/src/test/resources/adapter/auto/field_types/primitives/valid\" rel=\"noreferrer\">Resources (Input and expected output classes</a></p>\n\n<p>This is working great for all my current java based unit tests. However when I attempt to write some tests using Kotlin classes, my test fails to load the class.</p>\n\n<p>I believe this is due to the compile-testing library being first and foremost a Java specific library (I don't see any mention of Kotlin on their project)</p>\n\n<p>At the moment I get the following issue:</p>\n\n<pre><code>java.lang.IllegalArgumentException: Compilation unit is not of SOURCE kind: \"/C:/dev/gsonpath/gsonpath-compiler/build/resources/test/adapter/auto/field_types/primitives/valid/TestValidPrimitives.kt\"\n\nat com.sun.tools.javac.api.JavacTool.getTask(JavacTool.java:137)\nat com.sun.tools.javac.api.JavacTool.getTask(JavacTool.java:107)\nat com.sun.tools.javac.api.JavacTool.getTask(JavacTool.java:64)\nat com.google.testing.compile.Compilation.compile(Compilation.java:69)\nat com.google.testing.compile.JavaSourcesSubject$CompilationClause.compilesWithoutError(JavaSourcesSubject.java:281)\n</code></pre>\n\n<p>The problem is fairly obvious that the incorrect compiler is being used. The exception itself is thrown when my file extension is not '.java'. If I attempt to load a Kotlin class with the '.java' file extension, it doesn't work since it is not correct Java syntax.</p>\n\n<p>Has anyone come across this issue before and solved it? I have had a look at a few other annotation processors (such as <a href=\"https://github.com/Raizlabs/DBFlow/tree/master/dbflow-processor/src/test/java/com/raizlabs/android/dbflow/processor/test\" rel=\"noreferrer\">DBFlow</a>), and they do not write unit tests in this manner.</p>\n\n<p>Since Kotlin is only recently dabbling in annotation processing, perhaps I am the first to have this problem?</p>\n"}, {"tags": ["c#", "unity3d", "kotlin", "unityscript", "coroutine"], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 5275056, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/eab85bfd8e7bbbae12962b0ea538077b?s=128&d=identicon&r=PG&f=1", "display_name": "Wonderlus", "link": "https://stackoverflow.com/users/5275056/wonderlus"}, "edited": false, "score": 0, "creation_date": 1484008220, "post_id": 41523402, "comment_id": 70323686, "body": "<a href=\"http://stackoverflow.com/questions/41559105/can-i-take-advantage-of-kotlins-coroutines-by-using-them-in-java-code\" title=\"can i take advantage of kotlins coroutines by using them in java code\">stackoverflow.com/questions/41559105/&hellip;</a>  Mind taking a look at this?"}], "tags": [], "owner": {"reputation": 8458, "user_id": 786388, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/69de0a32836e6068a2f0baba75627b00?s=128&d=identicon&r=PG", "display_name": "ean5533", "link": "https://stackoverflow.com/users/786388/ean5533"}, "is_accepted": false, "score": 6, "last_activity_date": 1483805069, "creation_date": 1483805069, "answer_id": 41523402, "question_id": 41520343, "link": "https://stackoverflow.com/questions/41520343/unity-c-kotlin-coroutines/41523402#41523402", "title": "Unity (C#) -&gt; Kotlin &lt;- Coroutines", "body": "<p><em>Keep in mind that coroutines are part of Kotlin 1.1 which is still in EAP (early access preview). While I personally have experienced great success, the API is not stable yet and you should not rely on it working in production. Also, this answer is likely to become out of date by the time Kotlin 1.1 is finalized.</em></p>\n\n<ol>\n<li>If you haven't already, upgrade your project and your IDE to the latest Kotlin 1.1 EAP milestone (M04 at the time of this writing) by following the instructions at the bottom of <a href=\"https://blog.jetbrains.com/kotlin/2016/12/kotlin-1-1-m04-is-here/\">this blog post</a>.</li>\n<li>Find or write a function that will do what you want.\n\n<ul>\n<li><a href=\"https://github.com/Kotlin/kotlinx.coroutines\">kotlinx.coroutines</a> has quite a few, though not the one you're looking for in this case.</li>\n<li>Fortunately it turns out to be <a href=\"https://github.com/Kotlin/kotlin-coroutines/blob/revision-2.1/kotlin-coroutines-informal.md#non-blocking-sleep\">quite easy</a> to write a non-blocking sleep:</li>\n</ul></li>\n</ol>\n\n<p><br></p>\n\n<pre><code>private val executor = Executors.newSingleThreadScheduledExecutor {\n    Thread(it, \"sleep-thread\").apply { isDaemon = true }\n}\n\nsuspend fun sleep(millis: Long): Unit = suspendCoroutine { c -&gt;\n    executor.schedule({ c.resume(Unit) }, millis, TimeUnit.MILLISECONDS)\n}\n</code></pre>\n\n<p>There are some important caveats to be aware of. Compared to .NET where all suspendable methods will be worked on by some shared central pool somewhere (I'm not even sure where, to be honest), the example sleep method linked/shown above will run all continued work in the executor pool that you specify. The example <code>sleep</code> method linked above uses a single thread, which means all work that occurs after <code>sleep</code> will be handled by a single thread. That may not be sufficient for your use case.</p>\n\n<p>If you have additional questions about the details of Kotlin's coroutines, I highly recommend joining the #coroutines channel in the kotlinlang slack. See <a href=\"https://kotlinlang.org/community.html\">here</a> for details on joining.</p>\n"}, {"tags": [], "owner": {"reputation": 20308, "user_id": 1051598, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f9c354e780ce562daea0e21b99bfdc0d?s=128&d=identicon&r=PG", "display_name": "Roman  Elizarov", "link": "https://stackoverflow.com/users/1051598/roman-elizarov"}, "is_accepted": false, "score": 2, "last_activity_date": 1490543975, "creation_date": 1490543975, "answer_id": 43031029, "question_id": 41520343, "link": "https://stackoverflow.com/questions/41520343/unity-c-kotlin-coroutines/43031029#43031029", "title": "Unity (C#) -&gt; Kotlin &lt;- Coroutines", "body": "<p>Here is almost line-by-line translation of your C# Unity code to Kotlin coroutines using <code>kotlix.coroutines</code> library: </p>\n\n<pre><code>fun main(args: Array&lt;String&gt;) {\n    println(\"Starting \" + Instant.now())\n    launch(CommonPool) { waitAndPrint(2.0f) }\n    println(\"Before waitAndPrint Finishes \" + Instant.now())\n    // Kotlin coroutines are like daemon threads, so we have to keep the main thread around\n    Thread.sleep(3000)\n}\n\nsuspend fun waitAndPrint(waitTime: Float) {\n    delay((waitTime * 1000).toLong()) // convert it to integer number of milliseconds\n    println(\"waitAndPrint \" + Instant.now())\n}\n</code></pre>\n\n<p>You can learn more in <a href=\"https://github.com/Kotlin/kotlinx.coroutines/blob/master/coroutines-guide.md\" rel=\"nofollow noreferrer\">Guide to kotlinx.coroutines by example</a> which has more examples like this one, showing various available features of Kotlin coroutines way beyond non-blocking sleep.</p>\n"}], "owner": {"reputation": 311, "user_id": 5275056, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/eab85bfd8e7bbbae12962b0ea538077b?s=128&d=identicon&r=PG&f=1", "display_name": "Wonderlus", "link": "https://stackoverflow.com/users/5275056/wonderlus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1524, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1490543975, "creation_date": 1483784532, "question_id": 41520343, "link": "https://stackoverflow.com/questions/41520343/unity-c-kotlin-coroutines", "title": "Unity (C#) -&gt; Kotlin &lt;- Coroutines", "body": "<p>I'm experimenting with Kotlin for the first time and would love some help.</p>\n\n<p>What the code below does is pause execution of the current function without sleeping the executing thread. The pause is based on the amount of time provided. The function works by using the Coroutine support in the C# language. (This support was also recently added to Kotlin!) </p>\n\n<p><strong>Unity Example</strong></p>\n\n<pre><code>void Start() \n{\n    print(\"Starting \" + Time.time);\n    StartCoroutine(WaitAndPrint(2.0F));\n    print(\"Before WaitAndPrint Finishes \" + Time.time);\n}\n\nIEnumerator WaitAndPrint(float waitTime) \n{\n    yield return new WaitForSeconds(waitTime);\n    print(\"WaitAndPrint \" + Time.time);\n}\n</code></pre>\n\n<p>I haven't been able to figure out how to do something similar in Kotlin. Can someone help guide me in the right direction? If I figure it out before an answer is posted I'll update my post. </p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["java", "kotlin", "vert.x"], "comments": [{"owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "edited": false, "score": 0, "creation_date": 1483909515, "post_id": 41519891, "comment_id": 70280977, "body": "What does your addUser() looks like?"}, {"owner": {"reputation": 35, "user_id": 3524237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4aa48d5b6e2c7f942208196f4f2d311b?s=128&d=identicon&r=PG&f=1", "display_name": "hokster23", "link": "https://stackoverflow.com/users/3524237/hokster23"}, "reply_to_user": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "edited": false, "score": 0, "creation_date": 1483930932, "post_id": 41519891, "comment_id": 70285873, "body": "@alexey-soshin I believe I fixed it by adding return after each response. From what I can tell because of how my conditional statements are, it would always trickle down to the 200 response. I had assumed the .end() would break out of the method, but obviously that&#39;s not how it works. So by returning it does that. I added the addUser() though"}], "owner": {"reputation": 35, "user_id": 3524237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4aa48d5b6e2c7f942208196f4f2d311b?s=128&d=identicon&r=PG&f=1", "display_name": "hokster23", "link": "https://stackoverflow.com/users/3524237/hokster23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2088, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1483930799, "creation_date": 1483781208, "last_edit_date": 1483930799, "question_id": 41519891, "link": "https://stackoverflow.com/questions/41519891/response-has-already-been-written-with-vertx", "title": "&quot;Response has already been written&quot; with Vertx", "body": "<p>I am brand new to Vertx and trying to create my first HTTP Rest Server. However, I have been running into this issue. Here is the error I'm getting when I try to send a response.</p>\n\n<pre><code>Jan 07, 2017 3:54:36 AM io.vertx.ext.web.impl.RoutingContextImplBase\nSEVERE: Unexpected exception in route\njava.lang.IllegalStateException: Response has already been written\n    at io.vertx.core.http.impl.HttpServerResponseImpl.checkWritten(HttpServerResponseImpl.java:559)\n    at io.vertx.core.http.impl.HttpServerResponseImpl.putHeader(HttpServerResponseImpl.java:156)\n    at io.vertx.core.http.impl.HttpServerResponseImpl.putHeader(HttpServerResponseImpl.java:54)\n    at com.themolecule.utils.Response.sendResponse(Response.kt:25)\n    at com.themolecule.api.UserAPI.addUser(UserAPI.kt:52)\n    at TheMoleculeAPI$main$3.handle(TheMoleculeAPI.kt:50)\n    at TheMoleculeAPI$main$3.handle(TheMoleculeAPI.kt:19)\n    at io.vertx.ext.web.impl.RouteImpl.handleContext(RouteImpl.java:215)\n    at io.vertx.ext.web.impl.RoutingContextImplBase.iterateNext(RoutingContextImplBase.java:78)\n    at io.vertx.ext.web.impl.RoutingContextImpl.next(RoutingContextImpl.java:94)\n    at io.vertx.ext.web.handler.impl.AuthHandlerImpl.authorise(AuthHandlerImpl.java:86)\n    at \n</code></pre>\n\n<p>And this is how I have set up my routes. </p>\n\n<pre><code>// setup verx\n        val vertx = Vertx.vertx()\n        val router = Router.router(vertx)\n\n        val allowHeaders = HashSet&lt;String&gt;()\n        allowHeaders.add(\"x-requested-with\")\n        allowHeaders.add(\"Access-Control-Allow-Origin\")\n        allowHeaders.add(\"origin\")\n        allowHeaders.add(\"Content-Type\")\n        allowHeaders.add(\"accept\")\n        val allowMethods = HashSet&lt;HttpMethod&gt;()\n        allowMethods.add(HttpMethod.GET)\n        allowMethods.add(HttpMethod.POST)\n        allowMethods.add(HttpMethod.DELETE)\n        allowMethods.add(HttpMethod.PATCH)\n\n        router.route().handler(CorsHandler.create(\"*\")\n                .allowedHeaders(allowHeaders)\n                .allowedMethods(allowMethods))\n\n        router.route().handler(BodyHandler.create())\n\n        val config = JsonObject().put(\"keyStore\", JsonObject()\n                .put(\"path\", \"keystore.jceks\")\n                .put(\"type\", \"jceks\")\n                .put(\"password\", \"password\"))\n\n        // protect the API, login outside of JWT\n        router.route(\"/them/*\").handler(JWTAuthHandler.create(jwt, \"/them/login\"))\n\n        //login routes\n        router.post(\"/them/login\").handler { it -&gt; loginAPI.login(it, jwt) }\n\n        //user routes\n        router.get(\"/them/user/getusers\").handler { it -&gt; userAPI.getUsers(it) }\n        router.post(\"/them/user/addUser\").handler { it -&gt; userAPI.addUser(it) }\n</code></pre>\n\n<p>This is the code that it seems to have the problem with. </p>\n\n<pre><code>fun sendResponse(responseCode: Int, responseMsg: String, context: RoutingContext) {\n        val userResponse = JsonObject().put(\"response\", responseMsg)\n        context\n                .response()\n                .putHeader(\"content-type\", \"application/json\")\n                .setStatusCode(responseCode)\n                .end(userResponse.encodePrettily())\n    }\n</code></pre>\n\n<p>Am I doing something wrong with the handlers? I tried to change the method for the response up a bunch of times, but nothing seems to work. This is written in Kotlin. If I need to add more context, just say the word!</p>\n\n<p>edit: addUser method added </p>\n\n<pre><code>fun addUser(context: RoutingContext) {\n        val request = context.bodyAsJson\n        val newUser = NewUserRequestDTO(request.getString(\"userID\").trim(), request.getString(\"password\").trim())\n\n        newUser.userID.trim()\n        if (!newUser.userID.isNullOrEmpty() &amp;&amp; !newUser.password.isNullOrEmpty()) {\n\n            //check user ID\n            if (userDAO.userIdInUse(newUser.userID)) {\n                Response.sendResponse(400, Response.ResponseMessage.ID_IN_USE.message, context)\n                return\n            }\n\n            //check password valid\n            val isValid: Boolean = SecurityUtils.checkPasswordCompliance(newUser.password)\n            if (!isValid) {\n                Response.sendResponse(400, Response.ResponseMessage.PASSWORD_IS_NOT_VALID.message, context)\n                return\n            }\n\n            val saltedPass = SecurityUtils.genSaltedPasswordAndSalt(newUser.password)\n            userDAO.addUser(newUser.userID, saltedPass.salt.toString(), saltedPass.pwdDigest.toString())\n        } else {\n            Response.sendResponse(401, Response.ResponseMessage.NO_USERNAME_OR_PASSWORD.message, context)\n            return\n        }\n\n        Response.sendResponse(200, Response.ResponseMessage.USER_CREATED_SUCCESSFULLY.message, context)\n    }\n</code></pre>\n"}, {"tags": ["android", "data-binding", "kotlin", "android-databinding"], "comments": [{"owner": {"reputation": 1224, "user_id": 1922473, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MSMhN.jpg?s=128&g=1", "display_name": "Dharmendra Pratap Singh", "link": "https://stackoverflow.com/users/1922473/dharmendra-pratap-singh"}, "edited": false, "score": 0, "creation_date": 1483764770, "post_id": 41517526, "comment_id": 70242080, "body": "Paste your build.gradle file"}], "answers": [{"tags": [], "owner": {"reputation": 3471, "user_id": 2068693, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/Cu4rC.jpg?s=128&g=1", "display_name": "E. Fernandes", "link": "https://stackoverflow.com/users/2068693/e-fernandes"}, "is_accepted": false, "score": 1, "last_activity_date": 1483918970, "last_edit_date": 1495542277, "creation_date": 1483918970, "answer_id": 41539159, "question_id": 41517526, "link": "https://stackoverflow.com/questions/41517526/how-to-bind-onclick-event-from-view-using-android-binding-library-and-kotlin/41539159#41539159", "title": "How to bind onClick event from view using Android Binding Library and Kotlin?", "body": "<p>Well, after following <a href=\"https://stackoverflow.com/a/37044756/2068693\">this</a> answer and taking care to use: </p>\n\n<pre><code>private fun initDataBinding() {\n        val binding: ActivityLoginBinding = DataBindingUtil.setContentView(this, R.layout.activity_login)\n        binding.presenter = mPresenter\n    }\n</code></pre>\n\n<p>I was able to make it work. The problem was, I was initing the binding only using:</p>\n\n<pre><code>MainActivityBinding binding = MainActivityBinding.inflate(getLayoutInflater());\n</code></pre>\n\n<p>As pointed on <a href=\"https://developer.android.com/topic/libraries/data-binding/index.html\" rel=\"nofollow noreferrer\">Data Binding Library official page</a>, which by some reason didnt work for me.</p>\n"}], "owner": {"reputation": 3471, "user_id": 2068693, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/Cu4rC.jpg?s=128&g=1", "display_name": "E. Fernandes", "link": "https://stackoverflow.com/users/2068693/e-fernandes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5061, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1483973832, "creation_date": 1483760013, "last_edit_date": 1483973832, "question_id": 41517526, "link": "https://stackoverflow.com/questions/41517526/how-to-bind-onclick-event-from-view-using-android-binding-library-and-kotlin", "title": "How to bind onClick event from view using Android Binding Library and Kotlin?", "body": "<p>I'm struggling to make <a href=\"https://developer.android.com/topic/libraries/data-binding/index.html\" rel=\"nofollow noreferrer\">Android Binding Library</a> to work with Kotlin. What I want to achieve is dispatch a onClick event to my Presenter class. What I've done was:</p>\n\n<ol>\n<li>Enable databinding on module's gradle file: <code>dataBinding {enabled = true}</code></li>\n<li>Import databinding compiler: <code>kapt 'com.android.databinding:compiler:2.0.0-beta6'</code></li>\n<li>Generate stubs: <code>kapt {generateStubs = true}</code></li>\n<li><p>Implement method on MainPresenter.kt:</p>\n\n<pre><code>fun onClickEditProfile () {\n    log(\"method you hoped to get called was called\")\n    mView!!.getContext().snackbar(\"received event: onClickEditProfile via data binding, this is awesome\").show()\n}\n</code></pre></li>\n<li><p>Prepare layout:</p>\n\n<pre><code>&lt;layout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"&gt;\n    &lt;data&gt;\n        &lt;variable\n            name=\"presenter\"\n            type=\"br.com.tyllt.presenter.MainPresenter\" /&gt;\n    &lt;/data&gt;\n        &lt;com.github.clans.fab.FloatingActionButton\n            android:layout_width=\"wrap_content\"\n            android:layout_height=\"wrap_content\"\n            android:onClick=\"@{() -&gt; presenter.onClickEditProfile()}\"\n            android:src=\"@drawable/ic_edit\"\n            app:fab_colorNormal=\"@color/colorPrimary\"\n            app:fab_colorPressed=\"@color/colorPrimaryDark\"\n            app:fab_hideAnimation=\"@anim/fab_scale_down\"\n            app:fab_label=\"Edit Profile\"\n            app:fab_size=\"mini\" /&gt;\n&lt;/layout&gt;\n</code></pre></li>\n</ol>\n\n<p>Problem is, when I generate the apk I get the followin exception:</p>\n\n<pre><code>Error:Execution failed for task ':app:compileDebugJavaWithJavac'.\n</code></pre>\n\n<blockquote>\n  <p>java.lang.IllegalArgumentException: Parameter specified as non-null is null: method org.jetbrains.kotlin.annotation.RoundEnvironmentWrapper.getElementsAnnotatedWith, parameter a</p>\n</blockquote>\n\n<p>Any idea?</p>\n"}, {"tags": ["gradle", "jaxb", "kotlin", "xjc"], "comments": [{"owner": {"reputation": 5305, "user_id": 5818889, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b8df2f6af3fd32042982001fac8407b?s=128&d=identicon&r=PG&f=1", "display_name": "glee8e", "link": "https://stackoverflow.com/users/5818889/glee8e"}, "edited": false, "score": 0, "creation_date": 1483766988, "post_id": 41516059, "comment_id": 70242456, "body": "I guess you want to translate that groovy task into kotlin script?"}, {"owner": {"reputation": 21659, "user_id": 1089967, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1f256b904ff621d678598d8fa49f86c5?s=128&d=identicon&r=PG", "display_name": "lance-java", "link": "https://stackoverflow.com/users/1089967/lance-java"}, "edited": false, "score": 0, "creation_date": 1483784268, "post_id": 41516059, "comment_id": 70246383, "body": "I recommend you don&#39;t put generated sources in <code>src&#47;main&#47;java</code>. Keep your directories separate to help with gradle up-to-date checks. Do you commit the generated sources? If yes maybe put in <code>src&#47;xjc&#47;java</code>. If no (recommended) maybe put in <code>$buildDir&#47;xjc</code> so it&#39;s cleaned"}, {"owner": {"reputation": 1490, "user_id": 2638049, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c4151dc27146995ec074177a9bce2d0a?s=128&d=identicon&r=PG", "display_name": "serge", "link": "https://stackoverflow.com/users/2638049/serge"}, "reply_to_user": {"reputation": 21659, "user_id": 1089967, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1f256b904ff621d678598d8fa49f86c5?s=128&d=identicon&r=PG", "display_name": "lance-java", "link": "https://stackoverflow.com/users/1089967/lance-java"}, "edited": false, "score": 0, "creation_date": 1483972518, "post_id": 41516059, "comment_id": 70305649, "body": "@LanceJava I don&#39;t commit generated source. Thank you for the advice, I&#39;ll change the location."}, {"owner": {"reputation": 1490, "user_id": 2638049, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c4151dc27146995ec074177a9bce2d0a?s=128&d=identicon&r=PG", "display_name": "serge", "link": "https://stackoverflow.com/users/2638049/serge"}, "reply_to_user": {"reputation": 5305, "user_id": 5818889, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b8df2f6af3fd32042982001fac8407b?s=128&d=identicon&r=PG&f=1", "display_name": "glee8e", "link": "https://stackoverflow.com/users/5818889/glee8e"}, "edited": false, "score": 0, "creation_date": 1483972569, "post_id": 41516059, "comment_id": 70305677, "body": "@glee8e So when I convert to kotlin I can still use ant?"}, {"owner": {"reputation": 5305, "user_id": 5818889, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b8df2f6af3fd32042982001fac8407b?s=128&d=identicon&r=PG&f=1", "display_name": "glee8e", "link": "https://stackoverflow.com/users/5818889/glee8e"}, "edited": false, "score": 0, "creation_date": 1484051193, "post_id": 41516059, "comment_id": 70341566, "body": "Of course you can. Kotlin, groovy, and others like Clojure, Scala, BeanScript, Jython, JRuby, etc. are all JVM languages and they all have some mechainsm to interop with Java. Since Ant is written in pure Java, it&#39;s ok to reference it directly as long as the language specific requirements are meet (there is almost none for kotlin). After all, if a JVM language can&#39;t take advantage of existing Java libraries, it should rather be targetting .NET framework, JS, or even native object code directly, not Java."}], "owner": {"reputation": 1490, "user_id": 2638049, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c4151dc27146995ec074177a9bce2d0a?s=128&d=identicon&r=PG", "display_name": "serge", "link": "https://stackoverflow.com/users/2638049/serge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1016, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1483745510, "creation_date": 1483745510, "question_id": 41516059, "link": "https://stackoverflow.com/questions/41516059/bulid-jaxb-classes-in-gradle-usin-kotlin", "title": "Bulid JAXB classes in Gradle usin Kotlin", "body": "<p>Hi I have a task in groovy:</p>\n\n<pre><code>task generateJAXBClasses() {\n    inputs.dir 'src/main/config'\n    outputs.dir 'src/main/java/ad/ecs/struct'\n    def jaxbSrcDir = file(\"${projectDir}/src/main/java\")\n    doLast {\n        ant.taskdef(name: 'xjc', classname: 'ad.ecs.structbuild.XJC2Task', \n                classpath: configurations.generateJAXBClasses.asPath)\n        ant.jaxbSrcDir = jaxbSrcDir\n\n        ant.xjc(\n            destdir: '${jaxbSrcDir}',\n            package: 'ad.ecs.struct',\n            schema: 'src/main/config/StructsULink.xsd',\n            binding: 'src/main/config/MainBindings.xml',\n            readonly: true,\n            //header: false,\n            argument1: '-Xsetters',\n            argument2: '-npa',\n        )\n    }\n}\n</code></pre>\n\n<p>I'm not sure how to reference my class <code>ad.ecs.structbuild.XJC2Task</code> in Kotlin. I was wondering if there is an alternative to the ant in Kotlin?</p>\n"}, {"tags": ["kotlin", "circular-dependency", "voronoi"], "answers": [{"tags": [], "owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "is_accepted": true, "score": 3, "last_activity_date": 1483751310, "last_edit_date": 1483751310, "creation_date": 1483741134, "answer_id": 41515269, "question_id": 41514165, "link": "https://stackoverflow.com/questions/41514165/circular-dependency-voronoi-halfedge/41515269#41515269", "title": "Circular Dependency (Voronoi Halfedge)", "body": "<p>Without seeing the full definition of <code>HalfEdge</code> this might not work but consider the following:</p>\n\n<pre><code>interface HalfEdge {\n    val mirrorHalf: HalfEdge\n}\n\nclass HalfEdges {\n    private inner class First : HalfEdge {\n        override val mirrorHalf: HalfEdge\n            get() = second\n    }\n\n    private inner class Second : HalfEdge {\n        override val mirrorHalf: HalfEdge\n            get() = first\n    }\n\n    val first: HalfEdge = First()\n    val second: HalfEdge = Second()\n\n    operator fun component1() = first\n    operator fun component2() = second\n}\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>val (newEdge, newEdge2) = HalfEdges()\ncheck(newEdge == newEdge2.mirrorHalf)\ncheck(newEdge.mirrorHalf == newEdge2)\n</code></pre>\n\n<p>You have to create both halves at the same time and although you may never keep a reference to it directly both half edges maintain a reference to their whole edge container so that they can access one another. The above implementation could easily be adapted to pass in data to the two half edges and/or associate data with the whole edge.</p>\n\n<p>This same principle could also be implemented with a parent \"Graph\" or \"Network\" class with an internal, bi-directional map of which edges mirror one another.</p>\n"}], "owner": {"reputation": 143, "user_id": 2699942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5943a2272b8b6a85665a117f430170b4?s=128&d=identicon&r=PG&f=1", "display_name": "user2699942", "link": "https://stackoverflow.com/users/2699942/user2699942"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 1, "accepted_answer_id": 41515269, "answer_count": 1, "score": 1, "last_activity_date": 1483751310, "creation_date": 1483736034, "last_edit_date": 1483738671, "question_id": 41514165, "link": "https://stackoverflow.com/questions/41514165/circular-dependency-voronoi-halfedge", "title": "Circular Dependency (Voronoi Halfedge)", "body": "<p>I know, \"circular dependency is a bad design\", but I think in this case it's warranted.</p>\n\n<p>When building a voronoi diagram, the cells are divided into what are called \"half edges\", this allows you to traverse the diagram in handy ways.</p>\n\n<p>Anyway, in order to instantiate a halfedge, I have to specify the mirror, or twin of the halfedge.</p>\n\n<p>This is funky in any language, but in Kotlin it's even more annoying because I have to use a nullable var instead of a val, like I would prefer.</p>\n\n<p>Right now I'm doing this funkiness, which I don't like;</p>\n\n<pre><code>val mirrorEdge: HalfEdge\n    get() = halfEdge!!\n\nprivate var halfEdge: HalfEdge? = null\n\nfun setMirror(halfEdge: HalfEdge) {\n    this.halfEdge = halfEdge\n}\n</code></pre>\n\n<p>//elsewhere</p>\n\n<pre><code>newEdge.setMirror(newEdge2)\nnewEdge2.setMirror(newEdge)\n</code></pre>\n\n<p>A halfedge mirror can never be null, and should be immutable, but I don't see how to communicate that intention in my code.</p>\n"}, {"tags": ["kotlin", "tornadofx"], "answers": [{"tags": [], "owner": {"reputation": 7027, "user_id": 1437402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbbcf2a192382575c5cdd4d1a0e98a0?s=128&d=identicon&r=PG", "display_name": "Edvin Syse", "link": "https://stackoverflow.com/users/1437402/edvin-syse"}, "is_accepted": true, "score": 2, "last_activity_date": 1483792269, "last_edit_date": 1483792269, "creation_date": 1483787293, "answer_id": 41520762, "question_id": 41512896, "link": "https://stackoverflow.com/questions/41512896/questions-about-di-viewmodel-etc/41520762#41520762", "title": "questions about DI, ViewModel etc", "body": "<p>1) This is the correct default behavior of the ViewModel. If you bind a property of the view model to an input, the changes are immediately reflected in that bound property, but will only be flushed into the underlying model object once you commit it.</p>\n\n<p>If you want to autocommit changes in the view model properties back into the underlying model object, you can create the binding with the <code>autocommit</code> property set to true:</p>\n\n<pre><code>val data = bind(true) { item?.dataProperty() }\n</code></pre>\n\n<p>You can also write <code>bind(autocommit = true)</code> if that looks clearer to you. This will cause any changes to be automatically flushed back into the underlying object.</p>\n\n<p>I also want to make you aware that by requiring an item in the constructor of your view model, you're effectively preventing it from being used with injection unless you prime it like you do using <code>setInScope</code>. This might be fine for your use case, but worth noting.</p>\n\n<p>2) The upcoming TornadoFX 1.5.10 will give you a better <em>runtime</em> error message if you forget to pass a parameter. It also introduces default values for parameters. See <a href=\"https://github.com/edvin/tornadofx/pull/227\" rel=\"nofollow noreferrer\">https://github.com/edvin/tornadofx/pull/227</a> for more info.</p>\n"}], "owner": {"reputation": 175, "user_id": 1291139, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/61977afb958e49ca1fdad04f56aaa3c0?s=128&d=identicon&r=PG", "display_name": "Wi-Al", "link": "https://stackoverflow.com/users/1291139/wi-al"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 41520762, "answer_count": 1, "score": 0, "last_activity_date": 1483792269, "creation_date": 1483730854, "last_edit_date": 1483731143, "question_id": 41512896, "link": "https://stackoverflow.com/questions/41512896/questions-about-di-viewmodel-etc", "title": "questions about DI, ViewModel etc", "body": "<p>I have the following code: </p>\n\n<pre><code>class ExampleView :View(\"My Example view\") {\n  val model:ExampleModel by inject()\n\n  override val root= vbox {\n    textfield(model.data)\n    button(\"Commit\") {\n      setOnAction {\n        model.commit()\n        closeModal()\n      }\n    }\n    button(\"Rollback\") {\n      setOnAction {\n        model.rollback()\n        closeModal()\n      }\n    }\n    button(\"Just quit\") {\n      setOnAction {\n        closeModal()\n      }\n    }\n  }\n\n}\n\nclass Example() {\n  var data by property&lt;String&gt;()\n  fun dataProperty() = getProperty(Example::data)\n}\n\nclass ExampleModel(example: Example) : ItemViewModel&lt;Example&gt;() {\n  init {\n    item = example\n  }\n  val data = bind { item?.dataProperty() }\n}\n\nclass MainView : View() {\n  val example:Example\n  override val root = BorderPane() \n\n  init {\n    example = Example()\n    example.data = \"Data for example\"\n    val exampleModel = ExampleModel(example)\n    with(root){\n      top {\n        menubar {\n          menu(\"Test\") {\n            menuitem(\"Example - 1\") {\n              val scope = Scope()\n              setInScope(exampleModel, scope)\n              find&lt;ExampleView&gt;(scope).openWindow()\n            }\n            menuitem(\"Example - 2\") {\n              val scope = Scope()\n              setInScope(exampleModel, scope)\n              find&lt;ExampleView&gt;(scope).openWindow()\n            }\n          }\n        }\n      }\n    }\n  }\n}\n</code></pre>\n\n<p>I have two questions for this example:</p>\n\n<p>1) If i change the value and close the window without a commit (User can do this with help [X] button) then only ViewModel will store changes (and it will be displayed in GUI even after the re-opening ), but model POJO object will keep the old data. </p>\n\n<p>if I used instance of Example class (without DI) then this instance received all the changes at once. </p>\n\n<p>For example i don't want commit/rollback functionality but i want DI and immediate updating. What i should do? (ofcource i can call \"commit\" for \"textfield change value event\")</p>\n\n<p>2) ViewModel has constructor with parameter and if i try open ExampleView like this</p>\n\n<pre><code>find&lt;ExampleView&gt;(Scope()).openWindow()\n</code></pre>\n\n<p>then I got an an obvious RuntimeException. Can I avoid this for example, by a compiler warnings (or by something else)? </p>\n"}, {"tags": ["command-line", "path", "compilation", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 6573388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-L0xo75Zs0t0/AAAAAAAAAAI/AAAAAAAAAPg/kY31JcfEbg8/photo.jpg?sz=128", "display_name": "Tom&#225;\u0161 Kr&#225;l", "link": "https://stackoverflow.com/users/6573388/tom%c3%a1%c5%a1-kr%c3%a1l"}, "edited": false, "score": 2, "creation_date": 1483728468, "post_id": 41511863, "comment_id": 70230518, "body": "Thank you SO much, I would never figured out this on my own."}, {"owner": {"reputation": 519, "user_id": 4489222, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NZWk5iKHTiw/AAAAAAAAAAI/AAAAAAAAAEk/PolBf92mMS0/photo.jpg?sz=128", "display_name": "Vivek Hande", "link": "https://stackoverflow.com/users/4489222/vivek-hande"}, "edited": false, "score": 1, "creation_date": 1613134214, "post_id": 41511863, "comment_id": 116989050, "body": "thanks man, for saving my time"}], "tags": [], "owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "is_accepted": true, "score": 4, "last_activity_date": 1483727049, "last_edit_date": 1483727049, "creation_date": 1483726747, "answer_id": 41511863, "question_id": 41511497, "link": "https://stackoverflow.com/questions/41511497/kotlin-compiling-from-command-line/41511863#41511863", "title": "Kotlin compiling from command line", "body": "<p>Windows PATH is semicolon-delimited; white space is <em>not</em> trimmed.</p>\n\n<p>You need to remove the space between <code>;</code> and <code>C:\\Program Files\\kotlinc\\bin\\</code> in order for the directory to be added correctly to PATH.</p>\n"}], "owner": {"reputation": 197, "user_id": 6573388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-L0xo75Zs0t0/AAAAAAAAAAI/AAAAAAAAAPg/kY31JcfEbg8/photo.jpg?sz=128", "display_name": "Tom&#225;\u0161 Kr&#225;l", "link": "https://stackoverflow.com/users/6573388/tom%c3%a1%c5%a1-kr%c3%a1l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7132, "favorite_count": 1, "accepted_answer_id": 41511863, "answer_count": 1, "score": 2, "last_activity_date": 1483727049, "creation_date": 1483725384, "last_edit_date": 1483726329, "question_id": 41511497, "link": "https://stackoverflow.com/questions/41511497/kotlin-compiling-from-command-line", "title": "Kotlin compiling from command line", "body": "<p>I need to compile some Kotlin files and run them as described at <a href=\"https://kotlinlang.org/docs/tutorials/command-line.html\" rel=\"nofollow noreferrer\">Kotlin documentation</a></p>\n\n<p>However, my command line keeps saying this: </p>\n\n<blockquote>\n  <p>C:\\Users\\Tom\\Documents\\ProjectEuler\\Kotlin>kotlinc\n  'kotlinc' is not recognized as an internal or external command,\n  operable program or batch file.</p>\n</blockquote>\n\n<p>I am a 64-bit Windows 7 user.\nSo I downloaded the latest version of the compiler (1.0.6 ATM) and extracted the files into my Program Files folder.</p>\n\n<p>My variable path is set like this:</p>\n\n<blockquote>\n  <p>PATH=C:\\Program Files\\Java\\jdk1.8.0_101\\bin; C:\\Program Files\\kotlinc\\bin\\;C:\\Program Files (x86)\\Android\\android-sdk\\platform-tools;</p>\n</blockquote>\n\n<p>At this point I have no idea, I tried two versions of the compiler and tried changing the path variable few times.</p>\n\n<p>Any help appreciated.</p>\n"}, {"tags": ["android", "enums", "kotlin", "apt", "kapt"], "comments": [{"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1483724541, "post_id": 41510828, "comment_id": 70228421, "body": "&quot;Enum anonymous class&quot; - what part of it is anonymous? Maybe you meant   &quot;How to use Enum with an abstract function in Kotlin&quot; or something like that?"}, {"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "reply_to_user": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 1, "creation_date": 1483792473, "post_id": 41510828, "comment_id": 70248717, "body": "@voddan Based on the question, I would say you&#39;re right. I&#39;ve edited the title."}], "answers": [{"tags": [], "owner": {"reputation": 3028, "user_id": 2241008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RYBCT.jpg?s=128&g=1", "display_name": "Anton  Malmygin", "link": "https://stackoverflow.com/users/2241008/anton-malmygin"}, "is_accepted": false, "score": 0, "last_activity_date": 1483723975, "creation_date": 1483723975, "answer_id": 41511077, "question_id": 41510828, "link": "https://stackoverflow.com/questions/41510828/how-to-implement-abstract-function-in-enum-constants/41511077#41511077", "title": "How to implement abstract function in Enum constants", "body": "<p>I just tried your code and it's compiled normally with Kotlin plugin 1.0.6-release-Studio2.2-1</p>\n\n<p>Maybe you can just try to update AndroidStudio/Kotlin plugin ?</p>\n"}, {"tags": [], "owner": {"reputation": 911, "user_id": 3356053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab0255c7c61eff6f66164b49c9463c54?s=128&d=identicon&r=PG", "display_name": "ptitvinou", "link": "https://stackoverflow.com/users/3356053/ptitvinou"}, "is_accepted": true, "score": 0, "last_activity_date": 1483956193, "creation_date": 1483956193, "answer_id": 41545369, "question_id": 41510828, "link": "https://stackoverflow.com/questions/41510828/how-to-implement-abstract-function-in-enum-constants/41545369#41545369", "title": "How to implement abstract function in Enum constants", "body": "<p>Alright... so I found out where the issue was and it was not what I expected to be. @Kirill Rakhman was right, there was nothing wrong with the enum code. I had an issue with kapt that was unable for some reason to generate my project annotations. More specifically I was using - what I missed as experimental - the newly available gradle kapt plugin documented <a href=\"https://blog.jetbrains.com/kotlin/2016/09/kotlin-1-0-4-is-here/\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>I rolled back to the previous kapt settings by replacing</p>\n\n<pre><code>apply plugin: 'kotlin-kapt'\n</code></pre>\n\n<p>by</p>\n\n<pre><code>kapt {\n    generateStubs = true\n}\n</code></pre>\n\n<p>And it worked! Not sure why the compilation failed while declaring my enum though.</p>\n\n<p>Thanks a lot for those who took time to look into it and if you have any idea why the experimental kapt plugin was not behaving as expected feel free to comment this answer, I would gladly want to know what happened :)</p>\n"}], "owner": {"reputation": 911, "user_id": 3356053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab0255c7c61eff6f66164b49c9463c54?s=128&d=identicon&r=PG", "display_name": "ptitvinou", "link": "https://stackoverflow.com/users/3356053/ptitvinou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 718, "favorite_count": 0, "accepted_answer_id": 41545369, "answer_count": 2, "score": 0, "last_activity_date": 1483956244, "creation_date": 1483723143, "last_edit_date": 1483956244, "question_id": 41510828, "link": "https://stackoverflow.com/questions/41510828/how-to-implement-abstract-function-in-enum-constants", "title": "How to implement abstract function in Enum constants", "body": "<p>What I'm trying to achieve is a simple pattern that I'm using in Java and should be do-able in Kotlin according to the <a href=\"https://kotlinlang.org/docs/reference/enum-classes.html\" rel=\"nofollow noreferrer\">documentation</a>. I just want to declare an enum class with a couple of constant definitions that implement the same abstract functions.</p>\n\n<p>My problem is that I cannot manage to make my code compile. I always get the same error:</p>\n\n<p><code>modifier abstract not allowed here</code></p>\n\n<p>Here is the code:</p>\n\n<pre><code>enum class Program {\n    HOME {\n        override fun readableName(context: Context): String {\n            return context.getString(R.string.program_home)\n        }\n    },\n    WEEKEND {\n        override fun readableName(context: Context): String {\n            return context.getString(R.string.program_weekend)\n        }\n    },\n    SHOPPING {\n        override fun readableName(context: Context): String {\n            return context.getString(R.string.program_shopping)\n        }\n    };\n\n    abstract fun readableName(context: Context): String\n}\n</code></pre>\n\n<p>I have even tried with the sample code from the documentation and yet even this does not compile. </p>\n\n<p>Could anyone have an idea about this odd issue? Btw I'm currently using Kotlin 1.0.6.</p>\n"}, {"tags": ["gradle", "kotlin", "gluon", "tornadofx"], "comments": [{"owner": {"reputation": 7027, "user_id": 1437402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbbcf2a192382575c5cdd4d1a0e98a0?s=128&d=identicon&r=PG", "display_name": "Edvin Syse", "link": "https://stackoverflow.com/users/1437402/edvin-syse"}, "edited": false, "score": 0, "creation_date": 1483724511, "post_id": 41508144, "comment_id": 70228401, "body": "I tried your exact build file with no modifications, and I was able to import it into IDEA without issues. Can you try to run &quot;gradle build&quot; from the command line to see if this is merely an IDEA issue or something else?"}, {"owner": {"reputation": 989, "user_id": 1281217, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0c677e60cbae363a9f8f97c55afff2fa?s=128&d=identicon&r=PG", "display_name": "dzim", "link": "https://stackoverflow.com/users/1281217/dzim"}, "reply_to_user": {"reputation": 7027, "user_id": 1437402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbbcf2a192382575c5cdd4d1a0e98a0?s=128&d=identicon&r=PG", "display_name": "Edvin Syse", "link": "https://stackoverflow.com/users/1437402/edvin-syse"}, "edited": false, "score": 0, "creation_date": 1483724660, "post_id": 41508144, "comment_id": 70228487, "body": "The funny thing is: from the console it both build and started. But the IDE insisted, it was not properly set up and could not use Kotlin and Tornado out-of-the-box..."}, {"owner": {"reputation": 989, "user_id": 1281217, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0c677e60cbae363a9f8f97c55afff2fa?s=128&d=identicon&r=PG", "display_name": "dzim", "link": "https://stackoverflow.com/users/1281217/dzim"}, "reply_to_user": {"reputation": 7027, "user_id": 1437402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbbcf2a192382575c5cdd4d1a0e98a0?s=128&d=identicon&r=PG", "display_name": "Edvin Syse", "link": "https://stackoverflow.com/users/1437402/edvin-syse"}, "edited": false, "score": 0, "creation_date": 1483780815, "post_id": 41508144, "comment_id": 70245493, "body": "@edvin so you have some other plugins, libraries, etc. already set up prior to the import? I started with a fresh installation of IDEA and needed to convert the original Java to Kotlin. And there the issues started."}, {"owner": {"reputation": 7027, "user_id": 1437402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbbcf2a192382575c5cdd4d1a0e98a0?s=128&d=identicon&r=PG", "display_name": "Edvin Syse", "link": "https://stackoverflow.com/users/1437402/edvin-syse"}, "edited": false, "score": 0, "creation_date": 1483786808, "post_id": 41508144, "comment_id": 70247119, "body": "No, I did not. Can you try to close the IDEA project, remove the .idea folder, then import the project again?"}, {"owner": {"reputation": 989, "user_id": 1281217, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0c677e60cbae363a9f8f97c55afff2fa?s=128&d=identicon&r=PG", "display_name": "dzim", "link": "https://stackoverflow.com/users/1281217/dzim"}, "reply_to_user": {"reputation": 7027, "user_id": 1437402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbbcf2a192382575c5cdd4d1a0e98a0?s=128&d=identicon&r=PG", "display_name": "Edvin Syse", "link": "https://stackoverflow.com/users/1437402/edvin-syse"}, "edited": false, "score": 0, "creation_date": 1483948112, "post_id": 41508144, "comment_id": 70291020, "body": "@EdvinSyse I did as you suggested. And to my surprise: it works. I guess IDEA was just confused when I updated the existing project step by step. And (from a developer perspective) there is one thing I would need to do: move the Kotlin files to <i>/src/main/kotlin</i> (currently still in <i>/src/main/java</i>). Can you create an answer, I could up-vote and set the tick? Thanks. PS: One issue I detected with <b>TornadoFX</b>, when I finally could work with it: It seems to be not compatible with Android (I guess some Java8-interna, not provided by Google)."}, {"owner": {"reputation": 7027, "user_id": 1437402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbbcf2a192382575c5cdd4d1a0e98a0?s=128&d=identicon&r=PG", "display_name": "Edvin Syse", "link": "https://stackoverflow.com/users/1437402/edvin-syse"}, "edited": false, "score": 0, "creation_date": 1483949430, "post_id": 41508144, "comment_id": 70291604, "body": "Great, I&#39;ll add an answer :)"}, {"owner": {"reputation": 7027, "user_id": 1437402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbbcf2a192382575c5cdd4d1a0e98a0?s=128&d=identicon&r=PG", "display_name": "Edvin Syse", "link": "https://stackoverflow.com/users/1437402/edvin-syse"}, "edited": false, "score": 1, "creation_date": 1483949762, "post_id": 41508144, "comment_id": 70291755, "body": "TornadoFX requires JavaFX 8.0, and therefore Java 8, so it can&#39;t be used with Kotlin as you pointed out :)"}, {"owner": {"reputation": 989, "user_id": 1281217, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0c677e60cbae363a9f8f97c55afff2fa?s=128&d=identicon&r=PG", "display_name": "dzim", "link": "https://stackoverflow.com/users/1281217/dzim"}, "reply_to_user": {"reputation": 7027, "user_id": 1437402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbbcf2a192382575c5cdd4d1a0e98a0?s=128&d=identicon&r=PG", "display_name": "Edvin Syse", "link": "https://stackoverflow.com/users/1437402/edvin-syse"}, "edited": false, "score": 0, "creation_date": 1483950222, "post_id": 41508144, "comment_id": 70291998, "body": "This is a pity. :-D Are there any plans for a &quot;Android-Version&quot;, so that I could use it in JavaFXPorts like you can use Anko? Nevertheless: Thanks for you help, it was greatly appreciated!"}], "answers": [{"tags": [], "owner": {"reputation": 7027, "user_id": 1437402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbbcf2a192382575c5cdd4d1a0e98a0?s=128&d=identicon&r=PG", "display_name": "Edvin Syse", "link": "https://stackoverflow.com/users/1437402/edvin-syse"}, "is_accepted": true, "score": 1, "last_activity_date": 1483949691, "creation_date": 1483949691, "answer_id": 41543610, "question_id": 41508144, "link": "https://stackoverflow.com/questions/41508144/how-to-set-up-a-gluon-application-with-kotlin-and-tornado-fx/41543610#41543610", "title": "How to set up a Gluon application with Kotlin and Tornado FX", "body": "<p>It looks like something went wrong when IDEA analyzed the build file and generated invalid metadata, probably due to incremental changes to your build config. To regenerate the metadata, do the following</p>\n\n<ul>\n<li>Close IDEA</li>\n<li>Remove the .idea folder inside the project folder</li>\n<li>Import the project</li>\n</ul>\n\n<p>This time the metadata would be generated from the already complete build file and it should be set up correctly.</p>\n\n<p>Also note that the Kotlin plugin by default will compile Kotlin sources in <code>src/main/kotlin</code>. Either change the source folder or konfigure the Kotlin plugin to compile sources in <code>src/main/java</code>:</p>\n\n<pre><code>sourceSets {\n    main.kotlin.srcDirs += 'src/main/java'\n}\n</code></pre>\n"}], "owner": {"reputation": 989, "user_id": 1281217, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0c677e60cbae363a9f8f97c55afff2fa?s=128&d=identicon&r=PG", "display_name": "dzim", "link": "https://stackoverflow.com/users/1281217/dzim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1387, "favorite_count": 0, "accepted_answer_id": 41543610, "answer_count": 1, "score": 1, "last_activity_date": 1483949691, "creation_date": 1483714142, "question_id": 41508144, "link": "https://stackoverflow.com/questions/41508144/how-to-set-up-a-gluon-application-with-kotlin-and-tornado-fx", "title": "How to set up a Gluon application with Kotlin and Tornado FX", "body": "<p>I currently try to combine the following technologies:</p>\n\n<ul>\n<li>Gluon (Mobile)</li>\n<li>Gradle (dependency of Gluon, since they rely on it)</li>\n<li>Kotlin (because it's a nice language I want to dive into)</li>\n<li>Tornado FX (I guess it's for JavaFX, what Anko is for Android)</li>\n</ul>\n\n<p>The issue is, that I'm relatively new to Intellij-IDEA and have issues setting it up properly, although I though, that the <code>build.gradle</code> file was appropriate enough.</p>\n\n<p>Here's what my <code>build.gradle</code> looks so far:</p>\n\n<pre><code>buildscript {\n    ext.kotlin_version = '1.0.6'\n\n    repositories {\n        jcenter()\n        mavenCentral()\n    }\n\n    dependencies {\n        classpath 'org.javafxports:jfxmobile-plugin:1.2.0'\n        classpath \"org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version\"\n    }\n}\n\napply plugin: 'org.javafxports.jfxmobile'\napply plugin: 'kotlin'\n// apply plugin: 'com.android.application'\n// apply plugin: 'kotlin-android'\n\nrepositories {\n    jcenter()\n    mavenCentral()\n    maven {\n        url 'http://nexus.gluonhq.com/nexus/content/repositories/releases'\n    }\n}\n\nmainClassName = 'eu.dzim.test.Main'\n\ndependencies {\n    compile \"org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version\"\n    // compile \"org.jetbrains.kotlin:kotlin-reflect:$kotlin_version\"\n    compile 'com.gluonhq:charm:4.2.0'\n    compile 'no.tornado:tornadofx:1.5.9'\n    compile 'no.tornado:tornadofx-controls:1.0.4'\n}\n\njfxmobile {\n    downConfig {\n        version = '3.1.0'\n        // Do not edit the line below. Use Gluon Mobile Settings in your project context menu instead\n        plugins 'display', 'lifecycle', 'statusbar', 'storage'\n    }\n    android {\n        manifest = 'src/android/AndroidManifest.xml'\n    }\n}\n</code></pre>\n\n<p>I at lease managed to stop the IDE to complain about Kotlin. I converted a simple application class to look like this:</p>\n\n<pre><code>package eu.dzim.test\n\nimport com.gluonhq.charm.down.Platform\nimport javafx.application.Application\nimport javafx.scene.Scene\nimport javafx.scene.layout.BorderPane\nimport javafx.stage.Screen\nimport javafx.stage.Stage\n\n/**\n * Created by daniel on 06.01.17.\n */\nclass Main : Application() {\n\n    @Throws(Exception::class)\n    override fun start(stage: Stage) {\n\n        var width = -1.0\n        var height = -1.0\n        if (Platform.isDesktop()) {\n            width = 480.0\n            height = 640.0\n            stage.title = \"Test\"\n        }\n        val primaryScreen = Screen.getPrimary()\n        val visualBounds = primaryScreen.visualBounds\n        if (width &lt; 0 || height &lt; 0) {\n            width = visualBounds.width\n            height = visualBounds.height\n        }\n\n        val root = BorderPane()\n\n        val scene = Scene(root, width, height)\n\n        stage.scene = scene\n\n        stage.show()\n    }\n}\n</code></pre>\n\n<p>But now I'm stuck, because the dependency to Tornado FX is not resolved properly.\nI wanted to create a <code>View</code> and started with</p>\n\n<pre><code>package eu.dzim.test\n\nimport tornadofx.View\nimport tornadofx.borderpane\n\nclass Root : View(\"My View\") {\n    override val root = borderpane {\n\n    }\n}\n</code></pre>\n\n<p>But the imports like <code>import tornadofx.View</code> never get resolved.</p>\n\n<p>Is there an issue, because Tornado seems to use Kotlin <code>1.0.5</code>, while I want to use <code>1.0.6</code>? (Although this has no effect, if I change it, regarding the (still unused, because \"unresolved\") <code>View</code>...)</p>\n\n<p>Regards,\nDaniel</p>\n"}, {"tags": ["android", "kotlin", "greendao"], "comments": [{"owner": {"reputation": 5305, "user_id": 5818889, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b8df2f6af3fd32042982001fac8407b?s=128&d=identicon&r=PG&f=1", "display_name": "glee8e", "link": "https://stackoverflow.com/users/5818889/glee8e"}, "edited": false, "score": 0, "creation_date": 1483768804, "post_id": 41507389, "comment_id": 70242831, "body": "Post your buildscript of your main project, please. I suspect your srcDirs is incorrect."}, {"owner": {"reputation": 4447, "user_id": 3050249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yz2yy.jpg?s=128&g=1", "display_name": "Miha_x64", "link": "https://stackoverflow.com/users/3050249/miha-x64"}, "edited": false, "score": 0, "creation_date": 1485176458, "post_id": 41507389, "comment_id": 70801600, "body": "Here&#39;s an issue: <a href=\"https://github.com/greenrobot/greenDAO/issues/395\" rel=\"nofollow noreferrer\">github.com/greenrobot/greenDAO/issues/395</a>"}], "answers": [{"comments": [{"owner": {"reputation": 614, "user_id": 5541721, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d5710ec01f4e0ce5363d746c27c0d3d3?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando Tan", "link": "https://stackoverflow.com/users/5541721/fernando-tan"}, "edited": false, "score": 0, "creation_date": 1504629239, "post_id": 42373458, "comment_id": 79079595, "body": "You saved my day, Thank !"}], "tags": [], "owner": {"reputation": 725, "user_id": 6631041, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Pj-5Z_6o_3Q/AAAAAAAAAAI/AAAAAAAAABY/1f2LHG7lxbU/photo.jpg?sz=128", "display_name": "CalvinChe", "link": "https://stackoverflow.com/users/6631041/calvinche"}, "is_accepted": true, "score": 8, "last_activity_date": 1524186637, "last_edit_date": 1524186637, "creation_date": 1487696284, "answer_id": 42373458, "question_id": 41507389, "link": "https://stackoverflow.com/questions/41507389/unresolved-reference-daosession-using-greendao-and-kotlin/42373458#42373458", "title": "Unresolved reference: DaoSession using greendao and kotlin", "body": "<p>This is caused by that Greendao generate DaoSession and other Dao files at <strong>a default path:\"app/build/generated/source/greendao/\"</strong>, which <strong>cannot</strong> be found by kotlin. </p>\n\n<p>So you just need to change the Dao path by <strong>adding this code to your module Gradle file</strong>:</p>\n\n<pre><code>greendao {\n    targetGenDir 'src/main/java' \n}\n</code></pre>\n\n<p>Then, you can find the Dao files like DaoSesson.java are generated in your project path 'src/main/java'. Now Kotlin can find the DaoSession.</p>\n\n<p>Hope can help.</p>\n\n<p>Reference: <a href=\"https://github.com/greenrobot/greenDAO/issues/352\" rel=\"noreferrer\">https://github.com/greenrobot/greenDAO/issues/352</a></p>\n"}, {"tags": [], "owner": {"reputation": 16195, "user_id": 3806413, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/MgI5b.jpg?s=128&g=1", "display_name": "0xAliHn", "link": "https://stackoverflow.com/users/3806413/0xalihn"}, "is_accepted": false, "score": 9, "last_activity_date": 1538391115, "creation_date": 1538391115, "answer_id": 52589544, "question_id": 41507389, "link": "https://stackoverflow.com/questions/41507389/unresolved-reference-daosession-using-greendao-and-kotlin/52589544#52589544", "title": "Unresolved reference: DaoSession using greendao and kotlin", "body": "<p>Move your <code>greendao</code> plugin before the <code>kotlin</code> plugin in your app build.gradle like below:</p>\n\n<pre><code>apply plugin: 'org.greenrobot.greendao'\n\napply plugin: 'kotlin-kapt'\napply plugin: 'kotlin-android'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4419, "user_id": 1148784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce804861baa75ec3004f4384ae45b47?s=128&d=identicon&r=PG", "display_name": "babay", "link": "https://stackoverflow.com/users/1148784/babay"}, "is_accepted": false, "score": 2, "last_activity_date": 1563142915, "last_edit_date": 1563142915, "creation_date": 1563136206, "answer_id": 57030940, "question_id": 41507389, "link": "https://stackoverflow.com/questions/41507389/unresolved-reference-daosession-using-greendao-and-kotlin/57030940#57030940", "title": "Unresolved reference: DaoSession using greendao and kotlin", "body": "<p>Note: with your entity classes written in Java, to use the generated greenDAO files in your Kotlin classes you currently may have to manually add the generated source folder for Kotlin compilation to succeed:</p>\n\n<pre><code>android {\n    ...\n    sourceSets {\n        main.java.srcDirs += 'build/generated/source/greendao'\n    }\n}\n</code></pre>\n\n<p>src: <a href=\"https://github.com/greenrobot/greenDAO/issues/395\" rel=\"nofollow noreferrer\">https://github.com/greenrobot/greenDAO/issues/395</a></p>\n\n<p>Also, see 0xAliHn answer: move </p>\n\n<pre><code>apply plugin: 'org.greenrobot.greendao'\n</code></pre>\n\n<p>above kotlin plugins</p>\n"}], "owner": {"reputation": 2291, "user_id": 2560592, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/pdOAk.jpg?s=128&g=1", "display_name": "Bubunyo Nyavor", "link": "https://stackoverflow.com/users/2560592/bubunyo-nyavor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3350, "favorite_count": 1, "accepted_answer_id": 42373458, "answer_count": 3, "score": 4, "last_activity_date": 1563142915, "creation_date": 1483711348, "question_id": 41507389, "link": "https://stackoverflow.com/questions/41507389/unresolved-reference-daosession-using-greendao-and-kotlin", "title": "Unresolved reference: DaoSession using greendao and kotlin", "body": "<p>I am trying to convert a android project written in java to kotlin. My greendao class have been generated by anytime i build i get a <code>Unresolved reference: DaoSession</code> error message. I have<br>\n<code>kapt { generateStubs = true }</code> in my build gradle code.</p>\n"}, {"tags": ["android", "android-layout", "kotlin", "anko"], "comments": [{"owner": {"reputation": 34634, "user_id": 2444099, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ad5Vz.jpg?s=128&g=1", "display_name": "Eugen Pechanec", "link": "https://stackoverflow.com/users/2444099/eugen-pechanec"}, "edited": false, "score": 0, "creation_date": 1483672239, "post_id": 41498061, "comment_id": 70202585, "body": "Where do you call <code>fillUserInterface</code>? Why is <code>anko</code> in tags?"}, {"owner": {"reputation": 3471, "user_id": 2068693, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/Cu4rC.jpg?s=128&g=1", "display_name": "E. Fernandes", "link": "https://stackoverflow.com/users/2068693/e-fernandes"}, "reply_to_user": {"reputation": 34634, "user_id": 2444099, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ad5Vz.jpg?s=128&g=1", "display_name": "Eugen Pechanec", "link": "https://stackoverflow.com/users/2444099/eugen-pechanec"}, "edited": false, "score": 0, "creation_date": 1483673154, "post_id": 41498061, "comment_id": 70202764, "body": "I call it from a presenter class, which by its turn, performs a HTTP call using retrofit and, on the callback of it, calls <code>fillUserInterface</code>. I&#39;m using anko to bind view elements on Activity, it is probably not the source of the problem."}], "answers": [{"tags": [], "owner": {"reputation": 4447, "user_id": 3050249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yz2yy.jpg?s=128&g=1", "display_name": "Miha_x64", "link": "https://stackoverflow.com/users/3050249/miha-x64"}, "is_accepted": false, "score": 0, "last_activity_date": 1484057420, "creation_date": 1484057420, "answer_id": 41570842, "question_id": 41498061, "link": "https://stackoverflow.com/questions/41498061/bug-unnable-to-change-supportactionbar-title/41570842#41570842", "title": "Bug - Unnable to change supportActionBar title", "body": "<p>Use <a href=\"https://developer.android.com/reference/android/app/Activity.html#setTitle(java.lang.CharSequence)\" rel=\"nofollow noreferrer\">Activity.setTitle(CharSequence)</a> instead of Toolbar.setTitle(CharSequence).</p>\n"}], "owner": {"reputation": 3471, "user_id": 2068693, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/Cu4rC.jpg?s=128&g=1", "display_name": "E. Fernandes", "link": "https://stackoverflow.com/users/2068693/e-fernandes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484057420, "creation_date": 1483670201, "question_id": 41498061, "link": "https://stackoverflow.com/questions/41498061/bug-unnable-to-change-supportactionbar-title", "title": "Bug - Unnable to change supportActionBar title", "body": "<p>I'm trying to change supportActionBar title from a method called from a network callback. Even though I call it from inside Main Thread, title doesn't change! If I try in any other method it does.</p>\n\n<p>My layout:</p>\n\n<pre><code>  &lt;android.support.design.widget.AppBarLayout\n        android:id=\"@+id/app_bar\"\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"@dimen/app_bar_height\"\n        android:fitsSystemWindows=\"true\"\n        android:theme=\"@style/AppTheme.AppBarOverlay\"&gt;\n\n        &lt;android.support.design.widget.CollapsingToolbarLayout\n            android:id=\"@+id/toolbar_layout\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"match_parent\"\n            android:fitsSystemWindows=\"true\"\n            app:contentScrim=\"?attr/colorPrimary\"\n            app:layout_scrollFlags=\"scroll|exitUntilCollapsed\"&gt;\n\n            &lt;ImageView\n                android:id=\"@+id/userProfile\"\n                android:layout_width=\"match_parent\"\n                android:layout_height=\"match_parent\"\n                android:contentDescription=\"@string/str_act_main_user_list_item_user_profile_picture\" /&gt;\n\n            &lt;android.support.v7.widget.Toolbar\n                android:id=\"@+id/toolbar\"\n                android:layout_width=\"match_parent\"\n                android:layout_height=\"?attr/actionBarSize\"\n                app:layout_collapseMode=\"pin\"\n                app:popupTheme=\"@style/AppTheme.PopupOverlay\" /&gt;\n\n        &lt;/android.support.design.widget.CollapsingToolbarLayout&gt;\n    &lt;/android.support.design.widget.AppBarLayout&gt;\n</code></pre>\n\n<p>MainActivity:</p>\n\n<pre><code>class ActivityMain : BaseActivity(), ContractMainView {\n\n    @Inject\n    lateinit var mPresenter: ContractMainPresenter\n\n    private var mUser: User? = null\n\n    override fun onCreate(savedInstanceState: Bundle?) {\n        super.onCreate(savedInstanceState)\n        setContentView(R.layout.activity_main)\n        App.component!!.inject(this)\n        setSupportActionBar(toolbar)\n        initPageView()\n        setUpProfile()\n        mPresenter.init()\n\n    }\n\n    override fun getContext(): AppCompatActivity {\n        return this\n    }\n\n    override fun getView(): BaseView? {\n        return this\n    }\n\n    override fun getPresenter(): BasePresenter? {\n        return mPresenter\n    }\n\n    private fun initPageView() {\n        container.adapter = SectionsPagerAdapter(supportFragmentManager)\n        container.addOnPageChangeListener(object : ViewPager.SimpleOnPageChangeListener() {\n            override fun onPageScrolled(position: Int, positionOffset: Float, positionOffsetPixels: Int) {\n                if (position == 0 &amp;&amp; positionOffset &gt; 0.95) {\n                    app_bar.setExpanded(false)\n                }\n            }\n\n            override fun onPageSelected(position: Int) {\n                if (position == 0) {\n                    app_bar.setExpanded(true)\n                }\n            }\n        })\n    }\n\n    override fun fillUserInterface(user: User) {\n        mUser = user\n        runOnUiThread {\n            println(\"changing title to: ${user.name}\")\n            supportActionBar!!.title = \"This is a Test\"\n        }\n    }\n\n    private fun setUpProfile() {\n        Picasso.with(this)\n                .load(\"http://images.mentalfloss.com/sites/default/files/borat_primary.jpg\")\n                .fit()\n                .centerCrop()\n                .into(findViewById(R.id.userProfile) as ImageView)\n    }\n}\n</code></pre>\n\n<p>The called method is: <code>fillUserInterface(user: User)</code>. No matter what I don, title gets never change from it. Any help is appreciated, thanks!</p>\n"}, {"tags": ["generics", "kotlin", "overloading", "kotlin-interop"], "comments": [{"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "edited": false, "score": 0, "creation_date": 1483645319, "post_id": 41493268, "comment_id": 70192664, "body": "Please check if the unchecked casts described <a href=\"http://stackoverflow.com/questions/40722976/how-to-deal-with-an-overload-resolution-ambiguity-of-functions-with-generics\">here</a> can help you."}], "answers": [{"comments": [{"owner": {"reputation": 2052, "user_id": 1993958, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rLV4m.jpg?s=128&g=1", "display_name": "BloodShura", "link": "https://stackoverflow.com/users/1993958/bloodshura"}, "edited": false, "score": 0, "creation_date": 1483645539, "post_id": 41493388, "comment_id": 70192785, "body": "But this ambiguity doesn&#39;t happen with the Java compiler... I can call <code>JavaClass.join(&quot;some separator&quot;, someArray)</code> and it will select the correct method."}, {"owner": {"reputation": 2052, "user_id": 1993958, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rLV4m.jpg?s=128&g=1", "display_name": "BloodShura", "link": "https://stackoverflow.com/users/1993958/bloodshura"}, "edited": false, "score": 0, "creation_date": 1483646152, "post_id": 41493388, "comment_id": 70193137, "body": "And I can see why that happens because of the spread operator... but, AFAIK, it is the only way to pass a Kotlin varargs parameter to a Java method receiving varargs"}, {"owner": {"reputation": 8155, "user_id": 1431244, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/21b31222e990b631fee5484a7115a991?s=128&d=identicon&r=PG", "display_name": "Oliver Dain", "link": "https://stackoverflow.com/users/1431244/oliver-dain"}, "reply_to_user": {"reputation": 2052, "user_id": 1993958, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rLV4m.jpg?s=128&g=1", "display_name": "BloodShura", "link": "https://stackoverflow.com/users/1993958/bloodshura"}, "edited": false, "score": 0, "creation_date": 1483646611, "post_id": 41493388, "comment_id": 70193409, "body": "I <b>think</b> what&#39;s happening here is that the spread operator de-sugars to <code>join(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)</code> rather than <code>join(&quot;a&quot;, arrayOfOtherArgs)</code> so it&#39;s not the same as the Java call. Doesn&#39;t this work <code>join(&quot;&lt;br&gt;&quot;, array)</code>? I don&#39;t have the same libs available but to test I did this and it worked: `  val varargs = arrayOf(&quot;a&quot;, &quot;b&quot;, &quot;c&#39;&quot;)` and then <code>String.format(&quot;my format string: %s&quot;, varargs)</code>. In other words, as far as i can tell you can pass a Kotlin array to a varargs method without the spread operator."}, {"owner": {"reputation": 2052, "user_id": 1993958, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rLV4m.jpg?s=128&g=1", "display_name": "BloodShura", "link": "https://stackoverflow.com/users/1993958/bloodshura"}, "edited": false, "score": 0, "creation_date": 1483647255, "post_id": 41493388, "comment_id": 70193763, "body": "AFAIK, yes, a Kotlin array can be passed to a varargs method without the spread operator, but a Kotlin varargs method parameter can&#39;t, and here&#39;s where the problem lies... as you said, it is &quot;de-sugaring&quot; and since the separator is of the same type as the array elements, it does not know which method to call"}, {"owner": {"reputation": 8155, "user_id": 1431244, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/21b31222e990b631fee5484a7115a991?s=128&d=identicon&r=PG", "display_name": "Oliver Dain", "link": "https://stackoverflow.com/users/1431244/oliver-dain"}, "reply_to_user": {"reputation": 2052, "user_id": 1993958, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rLV4m.jpg?s=128&g=1", "display_name": "BloodShura", "link": "https://stackoverflow.com/users/1993958/bloodshura"}, "edited": false, "score": 1, "creation_date": 1483651926, "post_id": 41493388, "comment_id": 70196226, "body": "Interesting. I see what you mean. Sorry, don&#39;t have an answer. BTW, note that my <code>String.format</code> example was flawed as <code>String.format</code>&#39;s varargs are of type <code>Object</code> so it&#39;s just passing that whole array as a single argument."}], "tags": [], "owner": {"reputation": 8155, "user_id": 1431244, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/21b31222e990b631fee5484a7115a991?s=128&d=identicon&r=PG", "display_name": "Oliver Dain", "link": "https://stackoverflow.com/users/1431244/oliver-dain"}, "is_accepted": false, "score": 2, "last_activity_date": 1483645367, "creation_date": 1483645367, "answer_id": 41493388, "question_id": 41493268, "link": "https://stackoverflow.com/questions/41493268/kotlin-compilers-type-inference-cant-choose-which-method-to-call-ambiguity-wi/41493388#41493388", "title": "Kotlin compiler&#39;s type inference can&#39;t choose which method to call (ambiguity with generic types)", "body": "<p>I don't think that's Kotlin specific. The problem is that the generic argument, <code>E</code> is of type <code>CharSequence</code> so your call becomes something like <code>join(\"separator\", \"word1\", \"word2\")</code> which is, indeed, ambiguous since the first argument, of type <code>E == CharSequence</code> is the same as the type of the other args.</p>\n"}, {"tags": [], "owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "is_accepted": false, "score": 1, "last_activity_date": 1483647398, "creation_date": 1483647398, "answer_id": 41493910, "question_id": 41493268, "link": "https://stackoverflow.com/questions/41493268/kotlin-compilers-type-inference-cant-choose-which-method-to-call-ambiguity-wi/41493910#41493910", "title": "Kotlin compiler&#39;s type inference can&#39;t choose which method to call (ambiguity with generic types)", "body": "<p>It looks like you will need to create a helper class in Java to bridge the interop issue. e.g.:</p>\n\n<pre><code>public class JavaClassInterop {\n    public static &lt;E extends CharSequence&gt; E joinSeparatedBy(CharSequence separator,\n                                                             E... array) {\n        return JavaClass.join(separator, array);\n    }\n}\n</code></pre>\n\n<p>Then you can call both:</p>\n\n<pre><code>import JavaClass.join\nimport JavaClassInterop.joinSeparatedBy\n\nfun main(args: Array&lt;String&gt;) {\n    join(*args)\n    joinSeparatedBy(\"&lt;br&gt;\", *args)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7670, "user_id": 3881406, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000106542313/picture?type=large", "display_name": "Andras Kloczl", "link": "https://stackoverflow.com/users/3881406/andras-kloczl"}, "is_accepted": false, "score": 1, "last_activity_date": 1511958302, "creation_date": 1511958302, "answer_id": 47552833, "question_id": 41493268, "link": "https://stackoverflow.com/questions/41493268/kotlin-compilers-type-inference-cant-choose-which-method-to-call-ambiguity-wi/47552833#47552833", "title": "Kotlin compiler&#39;s type inference can&#39;t choose which method to call (ambiguity with generic types)", "body": "<p>tldr</p>\n\n<p><strong>Probably you work incorrectly with nullable types</strong></p>\n\n<p>I was struggling with this error for a while, but finally came up with a solution. I had this at first</p>\n\n<pre><code>user.items.apply {\n        removeAll(otherItems)\n        removeAll(otherItems2)\n    }\n</code></pre>\n\n<p>The items collection is a MutableSet? so it is nullable, and otherItems collections are nullable too. \nSo after adding ? before the apply, and passing non nullable collection to the removeAll function, the errors disappeared.</p>\n\n<pre><code>user.items?.apply {\n        removeAll(otherItems.orEmpty())\n        removeAll(otherItems2.orEmpty())\n    }\n</code></pre>\n"}], "owner": {"reputation": 2052, "user_id": 1993958, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rLV4m.jpg?s=128&g=1", "display_name": "BloodShura", "link": "https://stackoverflow.com/users/1993958/bloodshura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4240, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1511958302, "creation_date": 1483644948, "last_edit_date": 1483645632, "question_id": 41493268, "link": "https://stackoverflow.com/questions/41493268/kotlin-compilers-type-inference-cant-choose-which-method-to-call-ambiguity-wi", "title": "Kotlin compiler&#39;s type inference can&#39;t choose which method to call (ambiguity with generic types)", "body": "<p>So, I have some Java methods with these signatures (removed annotations and code body for the sake of simplicity):</p>\n\n<pre><code>public class JavaClass {\n  public static &lt;E extends CharSequence&gt; E join(E... array) { ... }\n  public static &lt;E extends CharSequence&gt; E join(CharSequence separator, E... array) { ... }\n}\n</code></pre>\n\n<p>And I have some code in Kotlin, which calls the 'join' method:</p>\n\n<pre><code>class KtClass {\n    fun test(vararg array: String) {\n        JavaClass.join(*array)\n    }\n}\n</code></pre>\n\n<p>So far so good; it will spread the varargs and call the former method signature. Okie dokie!</p>\n\n<p>The problem comes if, for example, I want to call the latter method signature, with a 'separator' argument:</p>\n\n<pre><code>class KtClass {\n    fun test(vararg array: String) {\n        JavaClass.join(\"&lt;br&gt;\", *array)\n    }\n}\n</code></pre>\n\n<p>This code won't compile. The compiler can't get to decide which method to call. The error:</p>\n\n<blockquote>\n  <p>Error:(5, 13) Kotlin: Cannot choose among the following candidates without completing type inference: \n  public open fun  join(vararg array: String!): String! defined in JavaClass\n  public open fun  join(separator: CharSequence!, vararg array: String!): String! defined in JavaClass</p>\n</blockquote>\n\n<p>I can't even name the arguments because Kotlin doesn't let argument naming for non-Kotlin functions.</p>\n\n<p><strong>EDIT:</strong> Replaced the <em>E</em> generic type parameter with plain <em>String</em> references in the Java method headers, and it worked! So I guess this to be an incompatibility of type inference with generic types or something like that?</p>\n\n<hr>\n\n<hr>\n\n<p>I'm pretty sure this has to be something with the <strong>spread operator</strong> (*). But I can't pass the varargs parameter <code>array</code> to the <code>join</code> function if I don't use it.</p>\n\n<p>How can I solve this without touching the Java code?</p>\n\n<p><em>YES, I KNOW that there is Array.joinToString extension function, but this would solve only this particular case. I need to know a generic solution.</em></p>\n"}, {"tags": ["android", "rx-java", "kotlin", "rx-binding"], "answers": [{"comments": [{"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "edited": false, "score": 1, "creation_date": 1483622488, "post_id": 41482369, "comment_id": 70177353, "body": "This doesn&#39;t answer the question. If the activity is destroyed and nothing is keeping a reference to it, the observable will be collected, too. The question is, does using RxBinding create any references to the activity that wouldn&#39;t be created if you just used the listener? My guess is no, unless you use some operators that run on special schedulers."}, {"owner": {"reputation": 5874, "user_id": 5483091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FjoF7.jpg?s=128&g=1", "display_name": "Alexander Perfilyev", "link": "https://stackoverflow.com/users/5483091/alexander-perfilyev"}, "reply_to_user": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "edited": false, "score": 0, "creation_date": 1483625317, "post_id": 41482369, "comment_id": 70179339, "body": "If you look at any view constructor, it takes a reference to the context. Therefore any unsubscribed binding will prevent your activity to be garbage collected."}, {"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "edited": false, "score": 0, "creation_date": 1483627912, "post_id": 41482369, "comment_id": 70181236, "body": "Not if the only reference is a loop. Which is exactly the same with passing an anonymous inner class."}, {"owner": {"reputation": 5874, "user_id": 5483091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FjoF7.jpg?s=128&g=1", "display_name": "Alexander Perfilyev", "link": "https://stackoverflow.com/users/5483091/alexander-perfilyev"}, "reply_to_user": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "edited": false, "score": 0, "creation_date": 1483629691, "post_id": 41482369, "comment_id": 70182494, "body": "This observable never completes and hold your reference until you unsubscribe."}], "tags": [], "owner": {"reputation": 5874, "user_id": 5483091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FjoF7.jpg?s=128&g=1", "display_name": "Alexander Perfilyev", "link": "https://stackoverflow.com/users/5483091/alexander-perfilyev"}, "is_accepted": false, "score": 3, "last_activity_date": 1483611476, "creation_date": 1483611476, "answer_id": 41482369, "question_id": 41482036, "link": "https://stackoverflow.com/questions/41482036/should-i-unsubscribe-when-using-rxbinding/41482369#41482369", "title": "Should I unsubscribe when using rxbinding?", "body": "<p>Yep, if you look in the <a href=\"https://github.com/JakeWharton/RxBinding/blob/master/rxbinding-kotlin/src/main/kotlin/com/jakewharton/rxbinding2/view/RxView.kt\" rel=\"nofollow noreferrer\">doc</a>, it explicitely says:</p>\n\n<blockquote>\n  <ul>\n  <li><em>Warning:</em> The created observable keeps a strong reference to <code>view</code>. Unsubscribe to free this reference.</li>\n  </ul>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 3389, "user_id": 4853702, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/d4108214e2f91f7a04a4ccd5c2d553b0?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandr", "link": "https://stackoverflow.com/users/4853702/alexandr"}, "edited": false, "score": 0, "creation_date": 1483633502, "post_id": 41488625, "comment_id": 70185311, "body": "Thanks for such detailed explanation! In my case <code>.editorActionEvents()</code> still emitting events even after disposing <code>View</code>. I will try to use RxLifecycle to unsubscribe with <code>onDestroy</code>."}], "tags": [], "owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "is_accepted": true, "score": 12, "last_activity_date": 1483638566, "last_edit_date": 1592644375, "creation_date": 1483629826, "answer_id": 41488625, "question_id": 41482036, "link": "https://stackoverflow.com/questions/41482036/should-i-unsubscribe-when-using-rxbinding/41488625#41488625", "title": "Should I unsubscribe when using rxbinding?", "body": "<p>I've made a small test setup to find it out. It's not an Android app but it simulates the class relationships. Here's what it looks like:</p>\n<pre><code>class Context\nclass View(val context: Context) {\n    lateinit var listener: () -&gt; Unit\n    fun onClick() = listener.invoke()\n}\n\nfun View.clicks() = Observable.fromEmitter&lt;String&gt;({ emitter -&gt;\n    listener = { emitter.onNext(&quot;Click&quot;) }\n}, Emitter.BackpressureMode.DROP)\n\n\nvar ref: PhantomReference&lt;Context&gt;? = null\n\nfun main(args: Array&lt;String&gt;) {\n    var c: Context? = Context()\n    var view: View? = View(c!!)\n\n    view!!.clicks().subscribe(::println)\n    view.onClick()\n    view = null\n\n    val queue = ReferenceQueue&lt;Context&gt;()\n    ref = PhantomReference(c, queue)\n    c = null\n\n    val t = thread {\n        while (queue.remove(1000) == null) System.gc()\n    }\n    t.join()\n\n    println(&quot;Collected&quot;)\n}\n</code></pre>\n<p>In this snippet I instantiate a <code>View</code> that holds a reference to a <code>Context</code>. the view has a callback for click events that I wrap in an <code>Observable</code>. I trigger the callback once, then I null out all references to the <code>View</code> and the <code>Context</code> and only keep a <a href=\"https://docs.oracle.com/javase/7/docs/api/java/lang/ref/PhantomReference.html\" rel=\"noreferrer\"><code>PhantomReference</code></a>. Then, on a separate thread I wait until the <code>Context</code> instance is released. As you can see, I'm never unsubscribing from the <code>Observable</code>.</p>\n<p>If you run the code, it will print</p>\n<blockquote>\n<p>Click</p>\n<p>Collected</p>\n</blockquote>\n<p>and then terminate proving that the reference to the <code>Context</code> was indeed released.</p>\n<hr />\n<h2>What this means for you</h2>\n<p>As you can see, an <code>Observable</code> will not prevent referenced objects from being collected if the only references it has to it are circular. You can read more about circular references in <a href=\"https://stackoverflow.com/questions/1910194/how-does-java-garbage-collection-work-with-circular-references\">this question</a>.</p>\n<p>However this isn't always the case. Depending on the operators that you use in the observable chain, the reference <strong>can</strong> get leaked, e.g. by a scheduler or if you merge it with an infinite observable, like <a href=\"http://reactivex.io/documentation/operators/interval.html\" rel=\"noreferrer\"><code>interval()</code></a>. Explictly unsubscribing from an observable is always a good idea and you can reduce the necessary boilerplate by using something like <a href=\"https://github.com/trello/RxLifecycle\" rel=\"noreferrer\">RxLifecycle</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 410, "user_id": 9400836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/168701348acc31a14fc1b3ffe367b5ea?s=128&d=identicon&r=PG&f=1", "display_name": "pumnao", "link": "https://stackoverflow.com/users/9400836/pumnao"}, "edited": false, "score": 0, "creation_date": 1545126487, "post_id": 43824085, "comment_id": 94508785, "body": "Take great care if CompositeDisposable exists but is disposed, when adding another Disposable it will call disposable.dispose() immediately. That&#39;s why we should recreate the CompositeDisposable even if comDisp.isDisposed()"}], "tags": [], "owner": {"reputation": 6870, "user_id": 2301224, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/qGBrt.jpg?s=128&g=1", "display_name": "Baker", "link": "https://stackoverflow.com/users/2301224/baker"}, "is_accepted": false, "score": 4, "last_activity_date": 1494095911, "creation_date": 1494095911, "answer_id": 43824085, "question_id": 41482036, "link": "https://stackoverflow.com/questions/41482036/should-i-unsubscribe-when-using-rxbinding/43824085#43824085", "title": "Should I unsubscribe when using rxbinding?", "body": "<p>Yes, you should <a href=\"https://github.com/JakeWharton/RxBinding/blob/master/rxbinding-kotlin/src/main/kotlin/com/jakewharton/rxbinding2/view/RxView.kt\" rel=\"nofollow noreferrer\">unsubscribe when using RxBinding</a>.</p>\n\n<p>Here's one way... (in java, could be tweaked for kotlin?)</p>\n\n<h1>Collect</h1>\n\n<p>Within your Activity or Fragment, add disposables to a CompositeDisposable that you'll dispose at onDestroy().</p>\n\n<pre><code>CompositeDisposable mCompD; // collector\n\nDisposable d = RxView.clicks(mButton).subscribe(new Consumer...);\n\naddToDisposables(mCompD, d); // add to collector\n\npublic static void addToDisposables(CompositeDisposable compDisp, Disposable d) {\n    if (compDisp == null) {\n        compDisp = new CompositeDisposable();\n    }\n\n    compDisp.add(d);\n}\n</code></pre>\n\n<h1>Dispose</h1>\n\n<pre><code>@Override\nprotected void onDestroy() {\n    mCompD.dispose();\n    super.onDestroy();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16339, "user_id": 1584654, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/ZmAL8.jpg?s=128&g=1", "display_name": "GVillani82", "link": "https://stackoverflow.com/users/1584654/gvillani82"}, "is_accepted": false, "score": 14, "last_activity_date": 1499085574, "creation_date": 1499085574, "answer_id": 44885832, "question_id": 41482036, "link": "https://stackoverflow.com/questions/41482036/should-i-unsubscribe-when-using-rxbinding/44885832#44885832", "title": "Should I unsubscribe when using rxbinding?", "body": "<p>I think that Jake Wharton (the creator of the library) gave the <a href=\"https://github.com/JakeWharton/RxBinding/issues/282\" rel=\"noreferrer\">best answer</a>: </p>\n\n<blockquote>\n  <p>Treat a subscribed RxView.clicks() (or any Observable from this\n  library for that matter) like you would the View reference itself. If\n  you pass it (or subscribe to it) somewhere outside the lifetime of the\n  View, you've just leaked your entire activity.</p>\n  \n  <p>So if you're just subscribing inside your ViewHolder there's no need\n  to unsubscribe just like there'd be no need to unregister a click\n  listener were you doing it manually.</p>\n</blockquote>\n"}], "owner": {"reputation": 3389, "user_id": 4853702, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/d4108214e2f91f7a04a4ccd5c2d553b0?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandr", "link": "https://stackoverflow.com/users/4853702/alexandr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5176, "favorite_count": 2, "accepted_answer_id": 41488625, "answer_count": 4, "score": 13, "last_activity_date": 1499085574, "creation_date": 1483610563, "question_id": 41482036, "link": "https://stackoverflow.com/questions/41482036/should-i-unsubscribe-when-using-rxbinding", "title": "Should I unsubscribe when using rxbinding?", "body": "<p>There is how I use RxBinding with Kotlin:</p>\n\n<pre><code>override fun onViewCreated(view: View?, savedInstanceState: Bundle?) {\n    super.onViewCreated(view, savedInstanceState)\n    reset_password_text_view.clicks().subscribe { presenter.showConfirmSecretQuestionBeforeResetPassword() }\n    password_edit_text.textChanges().skip(1).subscribe { presenter.onPasswordChanged(it.toString()) }\n    password_edit_text.editorActionEvents().subscribe { presenter.done(password_edit_text.text.toString()) }\n}\n</code></pre>\n\n<p><code>Observable.subscribe(action)</code> returns <code>Subscription</code>. Should I keep it as reference and unsubscribe <code>onPause()</code> or <code>onDestroy()</code>?</p>\n\n<p>Like this:</p>\n\n<pre><code>private lateinit var resetPasswordClicksSubs: Subscription\n\noverride fun onViewCreated(view: View?, savedInstanceState: Bundle?) {\n    super.onViewCreated(view, savedInstanceState)\n    resetPasswordClicksSubs = reset_password_text_view.clicks().subscribe { presenter.showConfirmSecretQuestionBeforeResetPassword() }\n}\n\noverride fun onDestroy() {\n    super.onDestroy()\n    resetPasswordClicksSubs.unsubscribe()\n}\n</code></pre>\n"}, {"tags": ["delegates", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 5305, "user_id": 5818889, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b8df2f6af3fd32042982001fac8407b?s=128&d=identicon&r=PG&f=1", "display_name": "glee8e", "link": "https://stackoverflow.com/users/5818889/glee8e"}, "edited": false, "score": 0, "creation_date": 1483632941, "post_id": 41481352, "comment_id": 70184861, "body": "Yeah, that is the best solution so far. One will need to hack or use plain java if he wants both nullable and nonnull types."}, {"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "reply_to_user": {"reputation": 5305, "user_id": 5818889, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b8df2f6af3fd32042982001fac8407b?s=128&d=identicon&r=PG&f=1", "display_name": "glee8e", "link": "https://stackoverflow.com/users/5818889/glee8e"}, "edited": false, "score": 0, "creation_date": 1483642820, "post_id": 41481352, "comment_id": 70191194, "body": "@glee8e there is no (sensible) code that can be do with Java and can&#39;t be done with Kotlin"}, {"owner": {"reputation": 5305, "user_id": 5818889, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b8df2f6af3fd32042982001fac8407b?s=128&d=identicon&r=PG&f=1", "display_name": "glee8e", "link": "https://stackoverflow.com/users/5818889/glee8e"}, "edited": false, "score": 0, "creation_date": 1483663017, "post_id": 41481352, "comment_id": 70200385, "body": "IIRC It won&#39;t work, as kotlin compiler require the return type of getValue to match the property type, or a compile error will be thrown."}, {"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "reply_to_user": {"reputation": 5305, "user_id": 5818889, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b8df2f6af3fd32042982001fac8407b?s=128&d=identicon&r=PG&f=1", "display_name": "glee8e", "link": "https://stackoverflow.com/users/5818889/glee8e"}, "edited": false, "score": 0, "creation_date": 1483687452, "post_id": 41481352, "comment_id": 70207180, "body": "Hm, yes indeed. I&#39;ve fixed the type. It was a copy-paste from your code, so I expected the types to match."}], "tags": [], "owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "is_accepted": true, "score": 3, "last_activity_date": 1483687376, "last_edit_date": 1483687376, "creation_date": 1483608544, "answer_id": 41481352, "question_id": 41480070, "link": "https://stackoverflow.com/questions/41480070/how-to-solve-this-null-check-in-initializer-safely/41481352#41481352", "title": "How to solve this null check in initializer safely?", "body": "<p>One way is to limit <code>T</code> to only non-nullable types with an upper bound:</p>\n\n<pre><code>class ReflectBackedProperty&lt;T: Any&gt; : ReadOnlyProperty&lt;Any, T&gt; {}\n</code></pre>\n\n<p>Another approach is not to bother with <code>lateinit</code> at all:</p>\n\n<pre><code>class ReflectBackedProperty&lt;T&gt;(val initOnce: Boolean, val instance: Any): ReadOnlyProperty&lt;Any, T&gt;  {\n    var initialized = false\n    var cache: T? = null\n\n    override operator fun getValue(thisRef: Any, property: KProperty&lt;*&gt;): T {\n        if (!initialized || !initOnce) {\n            cache = instance.javaClass.getDeclaredField(property.name).get(instance) as T\n            initialized = true\n        }\n        return cache as T\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 5305, "user_id": 5818889, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b8df2f6af3fd32042982001fac8407b?s=128&d=identicon&r=PG&f=1", "display_name": "glee8e", "link": "https://stackoverflow.com/users/5818889/glee8e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 41481352, "answer_count": 1, "score": 0, "last_activity_date": 1483687376, "creation_date": 1483603912, "question_id": 41480070, "link": "https://stackoverflow.com/questions/41480070/how-to-solve-this-null-check-in-initializer-safely", "title": "How to solve this null check in initializer safely?", "body": "<p>I'm writing a test case which I need some private properties. Since those private data are generated from a private method, I decided to use reflection to retrieve them after calculation is done. Later I remembered the delegated properties and decide to write a general delegate. Here is the code I got so far:</p>\n\n<pre><code>fun &lt;T&gt; reflect(instance: Any, initOnce: Boolean = true) = ReflectBackedProperty&lt;T&gt;(initOnce, instance)\n\nclass ReflectBackedProperty&lt;T&gt;(val initOnce: Boolean, val instance: Any): ReadOnlyProperty&lt;Any, T&gt;  {\n    var initialized = false\n    lateinit var cache: T // &lt;--- (a)\n    override opertaor fun getValue(thisRef: Any, property: KProperty&lt;*&gt;): Any? {\n        @Suppress(\"UNCHECKED_CAST\")\n        if (!initialized || !initOnce) {\n            cache = instance.javaClass.getDeclaredField(property.name).get(instance) as T\n            initialized = true\n        }\n        return cache\n    }\n}\n</code></pre>\n\n<p>As you can see, property <code>cache</code> is initialized by <code>getValue</code> calls, and, if <code>initOnce</code> is set, subsequent calls will use that cache instead of keeping calling expensive reflection.</p>\n\n<p>The very unfortunate thing is that at (a) compiler complains because T may be a nullable type and late init mechanism will be broken, but if I initialize it with <code>null</code> and it still complains because T may be a non-null type and null-safety is broken.</p>\n\n<p>Currently, I made this to work by initializing it with the return value of a null-returning Java function. I inspected the bytecode generated and found kotlin compiler placed no null checks for that so it will work for now, but I'm worried that a future kotlin version will have such checks and ruin this trick. How I'm supposed to overcome this?</p>\n\n<hr>\n\n<p>Now I'm using this, below code is released to public domain. Mention this page if you like, or do nothing.</p>\n\n<p>KTHacks.java</p>\n\n<pre><code>public final class KTHacks {\n    private KTHacks() {\n        throw new UnsupportedOperationException();\n    }\n\n    /**\n     * Forge a null into a platform type and take advantage of relaxed null-checks.\n     * @param &lt;T&gt;\n     * @return\n     */\n    public static &lt;T&gt; T NULL() {\n        return null;\n    }\n}\n</code></pre>\n\n<p>ReflectBackedProperty.kt</p>\n\n<pre><code>import kotlin.properties.ReadOnlyProperty\nimport kotlin.reflect.KProperty\n\nfun &lt;T&gt; reflect(instance: Any, initOnce: Boolean = true) = ReflectBackedProperty&lt;T&gt;(initOnce, instance)\n\nclass ReflectBackedProperty&lt;T&gt;(val initOnce: Boolean, val instance: Any): ReadOnlyProperty&lt;Any, T&gt; {\n    var initialized = false\n    var cache: T = KTHacks.NULL()\n    override operator fun getValue(thisRef: Any, property: KProperty&lt;*&gt;): T {\n        @Suppress(\"UNCHECKED_CAST\")\n        if (!initialized || !initOnce) {\n            cache = instance.javaClass.getDeclaredField(property.name).get(instance) as T\n            initialized = true\n        }\n        return cache\n    }\n}\n</code></pre>\n"}]