[{"tags": ["kotlin"], "answers": [{"tags": [], "owner": {"reputation": 153257, "user_id": 6509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de6eafe28472ceb9522fd3f609afed53?s=128&d=identicon&r=PG", "display_name": "tim_yates", "link": "https://stackoverflow.com/users/6509/tim-yates"}, "is_accepted": false, "score": 5, "last_activity_date": 1464213553, "creation_date": 1464213553, "answer_id": 37448345, "question_id": 37448110, "link": "https://stackoverflow.com/questions/37448110/kotlin-error-unresolved-reference-merge-for-list-merge/37448345#37448345", "title": "Kotlin Error: Unresolved reference: merge (for list.merge())", "body": "<p>Can't find merge in the official docs (but do find it <a href=\"http://blog.jetbrains.com/kotlin/2014/07/m8-is-out/\" rel=\"noreferrer\">mentioned here</a>)</p>\n\n<p>Think you <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/zip.html\" rel=\"noreferrer\">want zip</a>:</p>\n\n<pre><code>println(list.zip(listRepeated) { it1, it2  -&gt; it1 + it2 })\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 86, "user_id": 5520376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f33e75eb8b374255f5319102335a16f0?s=128&d=identicon&r=PG&f=1", "display_name": "Abdulrhman Babelli", "link": "https://stackoverflow.com/users/5520376/abdulrhman-babelli"}, "reply_to_user": {"reputation": 153257, "user_id": 6509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de6eafe28472ceb9522fd3f609afed53?s=128&d=identicon&r=PG", "display_name": "tim_yates", "link": "https://stackoverflow.com/users/6509/tim-yates"}, "edited": false, "score": 0, "creation_date": 1464269789, "post_id": 37457888, "comment_id": 62423744, "body": "My idea is the same output as the article of &quot;Antonio Leiva&quot; about collection operations in kotlin (<a href=\"http://antonioleiva.com/collection-operations-kotlin/\" rel=\"nofollow noreferrer\">this article</a>)  My English is week a bit and sorry if you understand my answer in a wrong way :)"}, {"owner": {"reputation": 153257, "user_id": 6509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de6eafe28472ceb9522fd3f609afed53?s=128&d=identicon&r=PG", "display_name": "tim_yates", "link": "https://stackoverflow.com/users/6509/tim-yates"}, "edited": false, "score": 0, "creation_date": 1464270113, "post_id": 37457888, "comment_id": 62424026, "body": "Ahhh!  Tweaked the sentence so hopefully now it has the meaning you wanted :-)"}, {"owner": {"reputation": 86, "user_id": 5520376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f33e75eb8b374255f5319102335a16f0?s=128&d=identicon&r=PG&f=1", "display_name": "Abdulrhman Babelli", "link": "https://stackoverflow.com/users/5520376/abdulrhman-babelli"}, "reply_to_user": {"reputation": 153257, "user_id": 6509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de6eafe28472ceb9522fd3f609afed53?s=128&d=identicon&r=PG", "display_name": "tim_yates", "link": "https://stackoverflow.com/users/6509/tim-yates"}, "edited": false, "score": 1, "creation_date": 1464270367, "post_id": 37457888, "comment_id": 62424234, "body": "Thanks for tweaking my answer :D"}, {"owner": {"reputation": 381, "user_id": 6162031, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c2087196e379c933f145a94453e5e592?s=128&d=identicon&r=PG&f=1", "display_name": "MLev", "link": "https://stackoverflow.com/users/6162031/mlev"}, "edited": false, "score": 0, "creation_date": 1464374939, "post_id": 37457888, "comment_id": 62477223, "body": "Thank you both very much.  I appreciate the links, and the code is working now."}], "tags": [], "owner": {"reputation": 86, "user_id": 5520376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f33e75eb8b374255f5319102335a16f0?s=128&d=identicon&r=PG&f=1", "display_name": "Abdulrhman Babelli", "link": "https://stackoverflow.com/users/5520376/abdulrhman-babelli"}, "is_accepted": true, "score": 7, "last_activity_date": 1464270065, "last_edit_date": 1464270065, "creation_date": 1464257686, "answer_id": 37457888, "question_id": 37448110, "link": "https://stackoverflow.com/questions/37448110/kotlin-error-unresolved-reference-merge-for-list-merge/37457888#37457888", "title": "Kotlin Error: Unresolved reference: merge (for list.merge())", "body": "<p><code>merge</code> has been dropped in Kotlin 1.0 Beta 2 as described <a href=\"http://blog.jetbrains.com/kotlin/2015/11/kotlin-1-0-beta-2-is-out/\" rel=\"nofollow\">here</a>.</p>\n\n<p>As @tim_yates said, this code sample will give you the same output as in the article:</p>\n\n<pre><code>val list = listOf(1,2,3,4,5,6)\nval listRepeated = listOf(2,2,3,4,5,5,6)\nprintln(list.zip(listRepeated) { it1, it2  -&gt; it1 + it2 })\n</code></pre>\n"}], "owner": {"reputation": 381, "user_id": 6162031, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c2087196e379c933f145a94453e5e592?s=128&d=identicon&r=PG&f=1", "display_name": "MLev", "link": "https://stackoverflow.com/users/6162031/mlev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 968, "favorite_count": 0, "accepted_answer_id": 37457888, "answer_count": 2, "score": 1, "last_activity_date": 1464270065, "creation_date": 1464212571, "question_id": 37448110, "link": "https://stackoverflow.com/questions/37448110/kotlin-error-unresolved-reference-merge-for-list-merge", "title": "Kotlin Error: Unresolved reference: merge (for list.merge())", "body": "<p>I have the following Kotlin code based on the code from the \"Generation operations\" section from <a href=\"http://antonioleiva.com/collection-operations-kotlin/\" rel=\"nofollow\">here</a>:</p>\n\n<pre><code>val list = listOf(1,2,3,4,5,6)\nval listRepeated = listOf(2,2,3,4,5,5,6)\nprintln(list.merge(listRepeated) { it1, it2  -&gt; it1 + it2 })\n</code></pre>\n\n<p>I am receiving the following error messages:</p>\n\n<pre><code>Error:(33, 18) Kotlin: Unresolved reference: merge\nError:(33, 40) Kotlin: Cannot infer a type for this parameter. Please specify it explicitly.\nError:(33, 45) Kotlin: Cannot infer a type for this parameter. Please specify it explicitly.\n</code></pre>\n\n<p>How can I get this code to properly compile?</p>\n"}, {"tags": ["kotlin", "string-interpolation"], "comments": [{"owner": {"reputation": 7571, "user_id": 4578513, "user_type": "registered", "accept_rate": 15, "profile_image": "https://i.stack.imgur.com/mUo1D.jpg?s=128&g=1", "display_name": "Developine", "link": "https://stackoverflow.com/users/4578513/developine"}, "edited": false, "score": 0, "creation_date": 1586626571, "post_id": 37442198, "comment_id": 108198609, "body": "Maybe this link can be useful for readers.  <a href=\"http://developine.com/kotlin-idioms-introductory-tutorial-part-1/\" rel=\"nofollow noreferrer\">developine.com/kotlin-idioms-introductory-tutorial-part-1</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1815, "user_id": 1708390, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/symR5.jpg?s=128&g=1", "display_name": "Bugs Happen", "link": "https://stackoverflow.com/users/1708390/bugs-happen"}, "edited": false, "score": 0, "creation_date": 1512654347, "post_id": 37442402, "comment_id": 82352548, "body": "What will be the syntax if I want something like <code>val loc: String = &quot;$location.latitude, $location.longitude&quot;</code> ??"}, {"owner": {"reputation": 12218, "user_id": 1540818, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/oZ1EX.jpg?s=128&g=1", "display_name": "Joffrey", "link": "https://stackoverflow.com/users/1540818/joffrey"}, "reply_to_user": {"reputation": 1815, "user_id": 1708390, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/symR5.jpg?s=128&g=1", "display_name": "Bugs Happen", "link": "https://stackoverflow.com/users/1708390/bugs-happen"}, "edited": false, "score": 6, "creation_date": 1532950975, "post_id": 37442402, "comment_id": 90151889, "body": "@BugsHappen I know I&#39;m late, but for future readers: if you need a more complex expression than just a variable name, use braces: <code>&quot;${location.latitude}, ${location.longitude}&quot;</code>"}, {"owner": {"reputation": 1643, "user_id": 1234098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7c7d40bc2ac5fa50e6460f2ae8e6138?s=128&d=identicon&r=PG", "display_name": "boldfacedesignuk", "link": "https://stackoverflow.com/users/1234098/boldfacedesignuk"}, "reply_to_user": {"reputation": 12218, "user_id": 1540818, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/oZ1EX.jpg?s=128&g=1", "display_name": "Joffrey", "link": "https://stackoverflow.com/users/1540818/joffrey"}, "edited": false, "score": 0, "creation_date": 1539789443, "post_id": 37442402, "comment_id": 92631490, "body": "@Joffrey Thank you from the future, I could not find this in the docs."}], "tags": [], "owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "is_accepted": true, "score": 46, "last_activity_date": 1464192222, "creation_date": 1464192222, "answer_id": 37442402, "question_id": 37442198, "link": "https://stackoverflow.com/questions/37442198/how-does-string-interpolation-work-in-kotlin/37442402#37442402", "title": "How does string interpolation work in Kotlin?", "body": "<p>The Kotlin compiler translates this code to:</p>\n\n<pre><code>new StringBuilder().append(\"Hello, \").append(name).append(\"!\").toString()\n</code></pre>\n\n<p>There is no caching performed: every time you evaluate an expression containing a string template, the resulting string will be built again.</p>\n"}, {"tags": [], "owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "is_accepted": false, "score": 19, "last_activity_date": 1568892055, "last_edit_date": 1568892055, "creation_date": 1464202043, "answer_id": 37445324, "question_id": 37442198, "link": "https://stackoverflow.com/questions/37442198/how-does-string-interpolation-work-in-kotlin/37445324#37445324", "title": "How does string interpolation work in Kotlin?", "body": "<p>Regarding your 2nd question:\nIf you need caching for <code>fullName</code>, you may and should do it explicitly:</p>\n\n<pre><code>class Client {\n    val firstName: String\n    val lastName: String\n    val fullName = \"$firstName $lastName\"\n}\n</code></pre>\n\n<p>This code is equivalent to your snipped except that the underlying getter <code>getFullName()</code> now uses a final private field with the result of concatenation.</p>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 5167617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d9cbb5b47fd1e074b3880df764c1587?s=128&d=identicon&r=PG&f=1", "display_name": "o037", "link": "https://stackoverflow.com/users/5167617/o037"}, "edited": false, "score": 1, "creation_date": 1603809172, "post_id": 44628015, "comment_id": 114150373, "body": "This should be the accepted answer I think. FYI it seems if you&#39;re interpolating a &quot;companion object&quot; (ie property), it needs to be wrapped in brackets as well. EX: <code>println(&quot;My age is: ${person.age}&quot;)</code>"}], "tags": [], "owner": {"reputation": 396, "user_id": 7111769, "user_type": "registered", "profile_image": "https://graph.facebook.com/1228774053864570/picture?type=large", "display_name": "Anish Arya", "link": "https://stackoverflow.com/users/7111769/anish-arya"}, "is_accepted": false, "score": 10, "last_activity_date": 1497867991, "last_edit_date": 1497867991, "creation_date": 1497867753, "answer_id": 44628015, "question_id": 37442198, "link": "https://stackoverflow.com/questions/37442198/how-does-string-interpolation-work-in-kotlin/44628015#44628015", "title": "How does string interpolation work in Kotlin?", "body": "<p>As you know, in string interpolation, string literals containing placeholders are evaluated, yielding a result in which placeholders are replaced with their corresponding values.\nso interpolation (in KOTLIN) goes this way:</p>\n\n<pre><code>var age = 21\n\nprintln(\"My Age Is: $age\")\n</code></pre>\n\n<p>Remember: \"$\" sign is used for interpolation.</p>\n"}, {"tags": [], "owner": {"reputation": 454, "user_id": 3765055, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9e3132feafd34f356a90f8c1c7efc505?s=128&d=identicon&r=PG&f=1", "display_name": "LTroya", "link": "https://stackoverflow.com/users/3765055/ltroya"}, "is_accepted": false, "score": 2, "last_activity_date": 1514684604, "creation_date": 1514684604, "answer_id": 48039308, "question_id": 37442198, "link": "https://stackoverflow.com/questions/37442198/how-does-string-interpolation-work-in-kotlin/48039308#48039308", "title": "How does string interpolation work in Kotlin?", "body": "<p>You could do this:</p>\n\n<pre><code>String.format(\"%s %s\", client.firstName, client.lastName)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2421, "user_id": 445845, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vrtJX.jpg?s=128&g=1", "display_name": "Ariel Monaco", "link": "https://stackoverflow.com/users/445845/ariel-monaco"}, "is_accepted": false, "score": 2, "last_activity_date": 1611875496, "creation_date": 1611875496, "answer_id": 65946535, "question_id": 37442198, "link": "https://stackoverflow.com/questions/37442198/how-does-string-interpolation-work-in-kotlin/65946535#65946535", "title": "How does string interpolation work in Kotlin?", "body": "<p>Always use curly brackets to avoid surprises. For example if you're string interpolating an object property, you should be enclosing it in curly brackets:</p>\n<pre><code>print(&quot;Your username is ${user.username}\\n&quot;)\n</code></pre>\n"}], "owner": {"reputation": 552, "user_id": 6351509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c8763b15ec9be25980b620d17b44b27?s=128&d=identicon&r=PG&f=1", "display_name": "meztihn", "link": "https://stackoverflow.com/users/6351509/meztihn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28199, "favorite_count": 9, "accepted_answer_id": 37442402, "answer_count": 5, "score": 45, "last_activity_date": 1611875496, "creation_date": 1464191611, "last_edit_date": 1527851831, "question_id": 37442198, "link": "https://stackoverflow.com/questions/37442198/how-does-string-interpolation-work-in-kotlin", "title": "How does string interpolation work in Kotlin?", "body": "<p>Does the Kotlin compiler translate <code>\"Hello, $name!\"</code> using something like</p>\n\n<pre><code>java.lang.String.format(\"Hello, %s!\", name)\n</code></pre>\n\n<p>or is there some other mechanism?</p>\n\n<p>And if I have a class like this for example:</p>\n\n<pre><code>class Client {\n  val firstName: String\n  val lastName: String\n  val fullName: String\n    get() = \"$firstName $lastName\"\n}\n</code></pre>\n\n<p>Will this getter return a cached string or will it try to build a new string? Should I use lazyOf delegate instead?</p>\n\n<p>I know that there will be no performance issue unless there will be millions of calls to <code>fullName</code>, but I haven't found documentation about this feature except for how to use it.</p>\n"}, {"tags": ["java", "image", "bufferedimage", "kotlin"], "comments": [{"owner": {"reputation": 19365, "user_id": 352131, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/lW7ca.png?s=128&g=1", "display_name": "Durandal", "link": "https://stackoverflow.com/users/352131/durandal"}, "edited": false, "score": 3, "creation_date": 1464192140, "post_id": 37441882, "comment_id": 62387167, "body": "Without having tested anything my guess is that the <i>major</i> performance bottleneck is the use of inappropiate collection types, LinkedList and ArrayList in combination with the use of contains() is always a warning flag. HashSet is probably a more appropiate type for this type of work."}, {"owner": {"reputation": 2095, "user_id": 320124, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a6936c91b3e71791b8dce35bf8e167e2?s=128&d=identicon&r=PG", "display_name": "IAE", "link": "https://stackoverflow.com/users/320124/iae"}, "reply_to_user": {"reputation": 19365, "user_id": 352131, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/lW7ca.png?s=128&g=1", "display_name": "Durandal", "link": "https://stackoverflow.com/users/352131/durandal"}, "edited": false, "score": 1, "creation_date": 1464197842, "post_id": 37441882, "comment_id": 62390419, "body": "Hey Durandal, thanks for the suggestion! I implemented it in code and it have a tremendous speedup- see the Optimization edit. You should get credit for your comment, why don&#39;t you post it as answer and gain some upvotes?"}, {"owner": {"reputation": 19365, "user_id": 352131, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/lW7ca.png?s=128&g=1", "display_name": "Durandal", "link": "https://stackoverflow.com/users/352131/durandal"}, "edited": false, "score": 0, "creation_date": 1464283687, "post_id": 37441882, "comment_id": 62433483, "body": "I&#39;m not really worried about reputation but some explanatory reasoning might be useful to anyone stumbling here, so I&#39;ll write it as an answer."}, {"owner": {"reputation": 1693, "user_id": 233646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/088484a91afab0f46d0b6b7ebd1fe967?s=128&d=identicon&r=PG", "display_name": "Terje", "link": "https://stackoverflow.com/users/233646/terje"}, "edited": false, "score": 1, "creation_date": 1464361403, "post_id": 37441882, "comment_id": 62469870, "body": "You wrote: I have attempted to optimize the process of extracting rgb colors as seen in the question Java - get pixel array from image by accessing the image&#39;s raster data buffer, but this fails in the newest versions of Java with a java.lang.ClassCastException: java.awt.image.DataBufferInt cannot be cast to java.awt.image.DataBufferByte.  -- Just create a new BufferedImage with the correct format, - and draw the previous one into the new one. Then you can use your preferred DataBuffer format. Even if this takes some ms, I&#39;m sure total time is faster."}, {"owner": {"reputation": 2095, "user_id": 320124, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a6936c91b3e71791b8dce35bf8e167e2?s=128&d=identicon&r=PG", "display_name": "IAE", "link": "https://stackoverflow.com/users/320124/iae"}, "edited": false, "score": 0, "creation_date": 1464371359, "post_id": 37441882, "comment_id": 62475401, "body": "Hey Terje, thanks for the input! Unfortunately, I&#39;m not sure what you mean with the &quot;right&quot; format. Upon reading I automatically convert every BufferedImage to type <code>ARGB</code>. I need this because the extracted sprites should have a transparent background."}], "answers": [{"tags": [], "owner": {"reputation": 19365, "user_id": 352131, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/lW7ca.png?s=128&g=1", "display_name": "Durandal", "link": "https://stackoverflow.com/users/352131/durandal"}, "is_accepted": false, "score": 1, "last_activity_date": 1464283519, "creation_date": 1464283519, "answer_id": 37467432, "question_id": 37441882, "link": "https://stackoverflow.com/questions/37441882/unacceptable-performance-reading-transparent-png-pixel-by-pixel/37467432#37467432", "title": "Unacceptable Performance Reading Transparent .png Pixel by Pixel", "body": "<p>Using contains on an ArrayList or LinkedList has complexity O(n). This can quickly turn into a large overhead, considering you are doing <em>many</em> contains() calls in your filter. The complexity of the lookup <em>visited.contains()</em> grows with the size of the image processed (more pixels to visit and more pixels visited, turning complexity into O(n^2)).</p>\n\n<p>The simplest way to reduce this cost is to use a collection type that has a fast contains; like O(1) in the case of HashSet. The Set semantics also fit your requirements a little better than lists, as I understand it the visited/unvisted collections should not allow duplicates. Since Sets do not allow duplicates by contract, some of the explicit contains checks may be eliminated; in places you want to respond to the event of the point being first added you can also make use of the boolean result the add()-method gives (true when element was not present and added).</p>\n\n<p>While boxing/unboxing does cost some time, its a linear cost. Reducing boxing overhead will require quite a few changes to the code and \"only\" get you a constant factor speedup. Standard collections do not work with primitives (without the autoboxing you want to avoid in the first place). While there are special purpose 3rd party collections (Trove comes to mind) that handle primitives without boxing. I would only go this way if absolutely necessary, changing to primitive types where possible would most likely make your code longer and somewhat more obfuscated.</p>\n"}], "owner": {"reputation": 2095, "user_id": 320124, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a6936c91b3e71791b8dce35bf8e167e2?s=128&d=identicon&r=PG", "display_name": "IAE", "link": "https://stackoverflow.com/users/320124/iae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1464283519, "creation_date": 1464190815, "last_edit_date": 1464198143, "question_id": 37441882, "link": "https://stackoverflow.com/questions/37441882/unacceptable-performance-reading-transparent-png-pixel-by-pixel", "title": "Unacceptable Performance Reading Transparent .png Pixel by Pixel", "body": "<p>I'm creating a tool that detects sprites in a sprite sheet and converts each found sprite into a new BufferedImage. This process works, but is prohibitively slow with certain image formats- mostly transparent images- such as this one:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NEhl6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NEhl6.png\" alt=\"Kenney&#39;s Game Assets - Animal Pack - Round\"></a></p>\n\n<p>(<a href=\"http://kenney.nl/assets/animal-pac\" rel=\"nofollow noreferrer\">Kenney's Game Assets - Animal Pack</a>)</p>\n\n<p>I have profiled my code and determined that the vast majority, by over 99% of my app time is spent in this method alone because of the many <code>getRGB()</code> calls.</p>\n\n<pre><code>private fun findContiguousSprite(image: BufferedImage, startingPoint: Point, backgroundColor: Color): List&lt;Point&gt; {\n    val unvisited = LinkedList&lt;Point&gt;()\n    val visited   = arrayListOf(startingPoint)\n\n    unvisited.addAll(neighbors(startingPoint, image).filter {\n        Color(image.getRGB(it.x, it.y)) != backgroundColor\n    })\n\n    while (unvisited.isNotEmpty()) {\n        val currentPoint = unvisited.pop()\n        val currentColor = Color(image.getRGB(currentPoint.x, currentPoint.y))\n\n        if (currentColor != backgroundColor) {\n            unvisited.addAll(neighbors(currentPoint, image).filter {\n                !visited.contains(it) &amp;&amp;\n                !unvisited.contains(it) &amp;&amp;\n                (Color(image.getRGB(it.x, it.y)) != backgroundColor)\n            })\n\n            visited.add(currentPoint)\n        }\n    }\n\n    return visited.distinct()\n}\n</code></pre>\n\n<p>I have attempted to optimize the process of extracting rgb colors as seen in the question <a href=\"https://stackoverflow.com/questions/6524196/java-get-pixel-array-from-image\">Java - get pixel array from image</a> by accessing the image's raster data buffer, but this fails in the newest versions of Java with a <code>java.lang.ClassCastException: java.awt.image.DataBufferInt cannot be cast to java.awt.image.DataBufferByte</code>.</p>\n\n<p>Other stumbling blocks include the deceitfully needless boxing of colors such as in the line <code>Color(image.getRGB(it.x, it.y)) != backgroundColor</code>. However, while <code>image.getRGB()</code> returns by default in the RGBA color space, <code>background.rgb</code> only returns the sRGB color space.</p>\n\n<p><strong>Question:</strong> How can I improve the performance of reading a <code>BufferedImage</code> especially in the case of transparent images? Why is it so fast with almost any other .png image I throw at it except for these?</p>\n\n<p><strong>Note:</strong> While the code is in Kotlin, I accept Java or any other JVM language as an answer.</p>\n\n<p><strong>Code dump:</strong> In case you want the full section of code:</p>\n\n<pre><code>private fun findSpriteDimensions(image: BufferedImage,\n                                 backgroundColor: Color): List&lt;Rectangle&gt; {\n    val workingImage = image.copy()\n\n    val spriteDimensions = ArrayList&lt;Rectangle&gt;()\n    for (pixel in workingImage) {\n        val (point, color) = pixel\n\n        if (color != backgroundColor) {\n            logger.debug(\"Found a sprite starting at (${point.x}, ${point.y})\")\n            val spritePlot = findContiguousSprite(workingImage, point, backgroundColor)\n            val spriteRectangle = spanRectangleFrom(spritePlot)\n\n            logger.debug(\"The identified sprite has an area of ${spriteRectangle.width}x${spriteRectangle.height}\")\n\n            spriteDimensions.add(spriteRectangle)\n            workingImage.erasePoints(spritePlot, backgroundColor)\n        }\n    }\n\n    return spriteDimensions\n}\n\nprivate fun findContiguousSprite(image: BufferedImage, startingPoint: Point, backgroundColor: Color): List&lt;Point&gt; {\n    val unvisited = LinkedList&lt;Point&gt;()\n    val visited   = arrayListOf(startingPoint)\n\n    unvisited.addAll(neighbors(startingPoint, image).filter {\n        Color(image.getRGB(it.x, it.y)) != backgroundColor\n    })\n\n    while (unvisited.isNotEmpty()) {\n        val currentPoint = unvisited.pop()\n        val currentColor = Color(image.getRGB(currentPoint.x, currentPoint.y))\n\n        if (currentColor != backgroundColor) {\n            unvisited.addAll(neighbors(currentPoint, image).filter {\n                !visited.contains(it) &amp;&amp;\n                !unvisited.contains(it) &amp;&amp;\n                (Color(image.getRGB(it.x, it.y)) != backgroundColor)\n            })\n\n            visited.add(currentPoint)\n        }\n    }\n\n    return visited.distinct()\n}\n\nprivate fun neighbors(point: Point, image: Image): List&lt;Point&gt; {\n    val points = ArrayList&lt;Point&gt;()\n    val imageWidth = image.getWidth(null) - 1\n    val imageHeight = image.getHeight(null) - 1\n\n    // Left neighbor\n    if (point.x &gt; 0)\n        points.add(Point(point.x - 1, point.y))\n\n    // Right neighbor\n    if (point.x &lt; imageWidth)\n        points.add(Point(point.x + 1, point.y))\n\n    // Top neighbor\n    if (point.y &gt; 0)\n        points.add(Point(point.x, point.y - 1))\n\n    // Bottom neighbor\n    if (point.y &lt; imageHeight)\n        points.add(Point(point.x, point.y + 1))\n\n    // Top-left neighbor\n    if (point.x &gt; 0 &amp;&amp; point.y &gt; 0)\n        points.add(Point(point.x - 1, point.y - 1))\n\n    // Top-right neighbor\n    if (point.x &lt; imageWidth &amp;&amp; point.y &gt; 0)\n        points.add(Point(point.x + 1, point.y - 1))\n\n    // Bottom-left neighbor\n    if (point.x &gt; 0 &amp;&amp; point.y &lt; imageHeight - 1)\n        points.add(Point(point.x - 1, point.y + 1))\n\n    // Bottom-right neighbor\n    if (point.x &lt; imageWidth &amp;&amp; point.y &lt; imageHeight)\n        points.add(Point(point.x + 1, point.y + 1))\n\n    return points\n}\n</code></pre>\n\n<h3>First Optimization</h3>\n\n<p>Driven by @Durandal's comment, I decided to change my ArrayList to a HashSet. I also found a way to preserve alpha values using an alternative constructor for Color, <code>Color(rgb, preserveAlpha)</code>. Now I no longer need to box <code>getRGB()</code> before comparing the two values.</p>\n\n<pre><code>private fun findContiguousSprite(image: BufferedImage, point: Point, backgroundColor: Color): List&lt;Point&gt; {\n    val unvisited = LinkedList&lt;Point&gt;()\n    val visited   = hashSetOf(point)\n\n    unvisited.addAll(neighbors(point, image).filter { image.getRGB(it.x, it.y) != backgroundColor.rgb })\n\n    while (unvisited.isNotEmpty()) {\n        val currentPoint = unvisited.pop()\n        val currentColor = image.getRGB(currentPoint.x, currentPoint.y)\n\n        if (currentColor != backgroundColor.rgb) {\n            unvisited.addAll(neighbors(currentPoint, image).filter {\n                !visited.contains(it) &amp;&amp;\n                !unvisited.contains(it) &amp;&amp;\n                image.getRGB(it.x, it.y) != backgroundColor.rgb\n            })\n\n            visited.add(currentPoint)\n        }\n    }\n\n    return visited.toList()\n}\n</code></pre>\n\n<p>This processed the above image in <code>319ms</code>. Awesome!</p>\n"}, {"tags": ["android", "android-gradle-plugin", "kotlin", "android-productflavors"], "comments": [{"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 5, "creation_date": 1464186196, "post_id": 37439120, "comment_id": 62382519, "body": "Shouldn&#39;t flavor-specific sources exist only in the falvors you&#39;ve defined (i.e. not in main)? So you&#39;d define at least two flavors, and only have Bar.kt in the source sets for those flavors."}, {"owner": {"reputation": 14564, "user_id": 997851, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/63c8b0590595c3de58406678ef99a6bf?s=128&d=identicon&r=PG", "display_name": "sockeqwe", "link": "https://stackoverflow.com/users/997851/sockeqwe"}, "reply_to_user": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1464186547, "post_id": 37439120, "comment_id": 62382807, "body": "Hm, maybe you are right ... actually I am trying to override a dagger module ... so <code>Bar.kt</code> is actually a Dagger 2 module"}, {"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "edited": false, "score": 0, "creation_date": 1464187868, "post_id": 37439120, "comment_id": 62383918, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/18782368/android-gradle-buildtypes-duplicate-class\">Android gradle buildTypes: Duplicate class</a>"}, {"owner": {"reputation": 3247, "user_id": 2068732, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mMeD8.jpg?s=128&g=1", "display_name": "matdev", "link": "https://stackoverflow.com/users/2068732/matdev"}, "edited": false, "score": 0, "creation_date": 1613127121, "post_id": 37439120, "comment_id": 116986137, "body": "You can check out my answer: <a href=\"https://stackoverflow.com/questions/28563632/common-code-for-different-android-flavors/66141092#66141092\" title=\"common code for different android flavors\">stackoverflow.com/questions/28563632/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1728, "user_id": 1651286, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/WvZb0.jpg?s=128&g=1", "display_name": "Akhil Dad", "link": "https://stackoverflow.com/users/1651286/akhil-dad"}, "edited": false, "score": 15, "creation_date": 1483952752, "post_id": 37440707, "comment_id": 70293235, "body": "If I have say 4-5 flavours, and 3 of them use the same class and the set use specific code, do I need to duplicate it everywhere or sourceSets can do it? Not able to do with source sets"}, {"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "reply_to_user": {"reputation": 1728, "user_id": 1651286, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/WvZb0.jpg?s=128&g=1", "display_name": "Akhil Dad", "link": "https://stackoverflow.com/users/1651286/akhil-dad"}, "edited": false, "score": 4, "creation_date": 1485597581, "post_id": 37440707, "comment_id": 70998608, "body": "@AkhilDad I guess you could create a separate module to share the code across flavours."}, {"owner": {"reputation": 6008, "user_id": 325102, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3f053dd9ca8b6f699fe26f4015915391?s=128&d=identicon&r=PG", "display_name": "plaisthos", "link": "https://stackoverflow.com/users/325102/plaisthos"}, "edited": false, "score": 0, "creation_date": 1590579066, "post_id": 37440707, "comment_id": 109730989, "body": "Or add another flavour dimension for that."}], "tags": [], "owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "is_accepted": false, "score": 61, "last_activity_date": 1464187855, "creation_date": 1464187855, "answer_id": 37440707, "question_id": 37439120, "link": "https://stackoverflow.com/questions/37439120/product-flavor-duplicate-class-found/37440707#37440707", "title": "Product Flavor: Duplicate class found", "body": "<p><a href=\"https://developer.android.com/studio/build/build-variants.html#sourceset-build\" rel=\"noreferrer\">The documentation for variants</a> states (emphasis mine):</p>\n\n<blockquote>\n  <p>Note: For a given build variant, Gradle throws a build error if it\n  encounters two or more source set directories that have defined the\n  same Java class. For example, when building a debug APK, you cannot\n  define both src/debug/Utility.java and src/main/Utility.java. This is\n  because Gradle looks at both these directories during the build\n  process and throws <strong>a 'duplicate class' error</strong>. If you want different\n  versions of Utility.java for different build types, you can have each\n  build type define its own version of the file <strong>and not include it in\n  the main/ source set</strong>.</p>\n</blockquote>\n\n<p>So the solution is to have it's own version of <code>Bar.kt</code> per variant and exclude it from main source set.</p>\n"}, {"comments": [{"owner": {"reputation": 3526, "user_id": 807452, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f2c9b5ff931a29737fa936ed987abca?s=128&d=identicon&r=PG", "display_name": "3c71", "link": "https://stackoverflow.com/users/807452/3c71"}, "edited": false, "score": 1, "creation_date": 1567510487, "post_id": 46662661, "comment_id": 101976797, "body": "Works perfectly, using AS 3.4.2. Thanks!"}], "tags": [], "owner": {"reputation": 1813, "user_id": 509681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/4UiBI.jpg?s=128&g=1", "display_name": "Semanticer", "link": "https://stackoverflow.com/users/509681/semanticer"}, "is_accepted": false, "score": 28, "last_activity_date": 1507626166, "creation_date": 1507626166, "answer_id": 46662661, "question_id": 37439120, "link": "https://stackoverflow.com/questions/37439120/product-flavor-duplicate-class-found/46662661#46662661", "title": "Product Flavor: Duplicate class found", "body": "<p>As stated by miensol you cannot put your file to <code>main</code> and flavor specific folders and expect gradle to work the same way android resource system works. But I found a way to do this without code duplication so you don't have to copy your <code>Bar.kt</code> to every flavor folder you have. </p>\n\n<p>So let's say you have three flavors <strong>dev</strong>, <strong>prod</strong> and <strong>mock</strong>. You want your special mocked <code>Bar.kt</code> in <strong>mock</strong> but the normal implementation in <strong>dev</strong> and <strong>prod</strong> flavors. You put your mocked file to the <strong>mock</strong> flavor specific folder <code>mock/java/com/something/</code> and you put your \"default\" implementation to new folder with some random name like <code>non-mock/java/com/something/</code> naming it something like \"common\" would also make sense. Now you have to tell gradle where should those flavors look for their <code>Bar.kt</code> class.</p>\n\n<p>Put this in to your <code>build.gradle</code>:</p>\n\n<pre><code>android {\n    ...\n    sourceSets {\n        prod {\n            java.srcDirs('src/non-mock/java')\n        }\n        dev {\n            java.srcDirs('src/non-mock/java')\n        }\n    }\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 176, "user_id": 2190902, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WAPDw.jpg?s=128&g=1", "display_name": "Igor Romcy", "link": "https://stackoverflow.com/users/2190902/igor-romcy"}, "edited": false, "score": 0, "creation_date": 1602262672, "post_id": 52567082, "comment_id": 113675348, "body": "is there any way to use a base of ShoppingCartActivity on main and in case I have another one inside other flavor so I use the flavor one instead?"}], "tags": [], "owner": {"reputation": 519, "user_id": 4489222, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NZWk5iKHTiw/AAAAAAAAAAI/AAAAAAAAAEk/PolBf92mMS0/photo.jpg?sz=128", "display_name": "Vivek Hande", "link": "https://stackoverflow.com/users/4489222/vivek-hande"}, "is_accepted": false, "score": 15, "last_activity_date": 1544425348, "last_edit_date": 1544425348, "creation_date": 1538213988, "answer_id": 52567082, "question_id": 37439120, "link": "https://stackoverflow.com/questions/37439120/product-flavor-duplicate-class-found/52567082#52567082", "title": "Product Flavor: Duplicate class found", "body": "<p>If you have multiple flavors, Like A, B and C</p>\n\n<p>and your main code contains all activities, and for A and C flavor you want to change some functionality of some activity ex- ShoppingCartActivity </p>\n\n<p>then you need to make some changes as below, put ShoppingCartActivity in all three flavors (including B as well) and <strong>remove from main</strong> and declare the file into all manifest file other than main manifest</p>\n\n<p>for more details check <a href=\"https://developer.android.com/studio/build/build-variants#sourceset-build\" rel=\"noreferrer\">Build with source sets</a></p>\n\n<pre><code>- A\n  - java\n    - com\n      - example\n        - ShoppingCartActivity.kt(some changes)\n\n- B\n  - java\n    - com\n      - example\n        - ShoppingCartActivity.kt\n\n- C\n  - java\n    - com\n      - example\n        - ShoppingCartActivity.kt(new changes added)\n\n- main\n  - java\n    - com\n      - example\n        **(remove from here)**\n</code></pre>\n"}], "owner": {"reputation": 14564, "user_id": 997851, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/63c8b0590595c3de58406678ef99a6bf?s=128&d=identicon&r=PG", "display_name": "sockeqwe", "link": "https://stackoverflow.com/users/997851/sockeqwe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20550, "favorite_count": 9, "answer_count": 3, "score": 49, "last_activity_date": 1598469723, "creation_date": 1464183946, "last_edit_date": 1598469723, "question_id": 37439120, "link": "https://stackoverflow.com/questions/37439120/product-flavor-duplicate-class-found", "title": "Product Flavor: Duplicate class found", "body": "<p>I have a question, but I'm sitting here in front of my app since hours but I can't understand what the problem is.</p>\n<p>I have an android app (written in kotlin) and I want to make two product flavors and override a class / file in the product flavor:</p>\n<p>So my gradle script is that:</p>\n<pre><code>apply plugin: 'com.android.application'\napply plugin: 'kotlin-android'\n\n\nandroid {\n  ...\n  productFlavors {\n    foo {\n      applicationId &quot;com.foo&quot;\n    }\n  }\n}\n</code></pre>\n<p>My files are structured as follows:</p>\n<pre><code> - src\n    - androidTest\n    - foo\n      - java\n        - com\n          - example\n            - Bar.kt\n    - main\n      - java\n        - com\n          - example\n            - Bar.kt\n    - test\n</code></pre>\n<p>So basically I would like to override <code>Bar.kt</code> file in <code>foo</code> product flavor, but somehow it doesn't work: It says class Bar is duplicated.</p>\n<p>Any hint?</p>\n"}, {"tags": ["java", "protocol-buffers", "kotlin", "proto3"], "comments": [{"owner": {"reputation": 10672, "user_id": 19246, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ab76db4c7db78939bf0f881f45691e33?s=128&d=identicon&r=PG", "display_name": "Martin C.", "link": "https://stackoverflow.com/users/19246/martin-c"}, "edited": false, "score": 2, "creation_date": 1464171769, "post_id": 37433955, "comment_id": 62371646, "body": "A very good question. I am using <code>proto2</code> a lot and haven&#39;t yet looked into <code>proto3</code>, but this seems to be a <i>huge</i> step in a direction I am not happy with. <code>required</code>, <code>optional</code>, custom <code>default</code> values and the possibility to check if a value has been set or is fallback (<code>hasValue()</code> vs. <code>getValue()</code>) is one major building block in many of my applications."}], "answers": [{"comments": [{"owner": {"reputation": 1993, "user_id": 2044035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IKkGD.png?s=128&g=1", "display_name": "Matheus Felipe", "link": "https://stackoverflow.com/users/2044035/matheus-felipe"}, "edited": false, "score": 0, "creation_date": 1619111032, "post_id": 37444256, "comment_id": 118812330, "body": "I love how you frame the mindset of proto2 and proto3 being a flavor choice rather than an &quot;upgraded&quot; version number."}], "tags": [], "owner": {"reputation": 30998, "user_id": 2686899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/StqEe.jpg?s=128&g=1", "display_name": "Kenton Varda", "link": "https://stackoverflow.com/users/2686899/kenton-varda"}, "is_accepted": false, "score": 4, "last_activity_date": 1464198255, "creation_date": 1464198255, "answer_id": 37444256, "question_id": 37433955, "link": "https://stackoverflow.com/questions/37433955/proto3-setting-value-equal-to-default-is-not-recognised-in-runtime/37444256#37444256", "title": "Proto3 setting value equal to default is not recognised in runtime", "body": "<p>If you want Proto2's default value and set/unset behavior, you should switch back to Proto2. It is unlikely that Proto2 will go away any time soon as lots of code (including inside of Google) still depends on it, and it shares most of its implementation with Proto3. Think of proto2 vs. proto3 as an option (the exact option you're looking for, in fact) rather than a version change.</p>\n"}], "owner": {"reputation": 8300, "user_id": 654799, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/S83OA.jpg?s=128&g=1", "display_name": "vach", "link": "https://stackoverflow.com/users/654799/vach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1679, "favorite_count": 2, "answer_count": 1, "score": 4, "last_activity_date": 1464198255, "creation_date": 1464170950, "last_edit_date": 1464171586, "question_id": 37433955, "link": "https://stackoverflow.com/questions/37433955/proto3-setting-value-equal-to-default-is-not-recognised-in-runtime", "title": "Proto3 setting value equal to default is not recognised in runtime", "body": "<p><code>Proto3</code> is not as strict as <code>Proto2</code>, and there are no <code>required</code> or <code>optional</code> fields, there are no custom <code>default</code> values.</p>\n\n<p>Given the following definition...</p>\n\n<pre><code>message Order {\n    enum Side {\n        BID = 0;\n        ASK = 1;\n    }\n\n    int64 time = 1;\n    double price = 2;\n    double volume = 3;\n    Side side = 4;\n}\n</code></pre>\n\n<p>There are default values for any of those fields, after all now there are no rules of what you must or must not provide before you <code>.build()</code> your object.</p>\n\n<p>So the default for <code>time</code> is <code>0</code>, <code>price</code> is <code>0.0</code> and <code>side</code> is <code>BID</code>, if you print an instance where you did not provide one of the fields <strong>or provided the default value</strong> then runtime will treat it as it was never provided in both cases, so its not possible to determine if the value was manually set to <code>BID</code> or it was taken as the default.</p>\n\n<p>For example if we execute the following code (its kotlin) </p>\n\n<pre><code>Order.newBuilder()\n        .setPrice(1.0)\n        .setVolume(2.0)\n        .setSide(Order.Side.BID)\n        .build()\n        .apply { println(this) }\n</code></pre>\n\n<p>we will have this output</p>\n\n<pre><code>price: 1.0\nvolume: 2.0\n</code></pre>\n\n<p>at the very least this is annoying as when you print your proto objects using standard <code>.toString()</code> or json printer you'll have this cropped output...</p>\n\n<pre><code>{ \"price\": 1.0, \"volume\": 2.0 }\n{ \"price\": 1.0, \"volume\": 2.0, \"side\": \"ASK\" }\n{ \"price\": 1.0, \"volume\": 2.0 }\n{ \"price\": 1.0, \"volume\": 2.0, \"side\": \"ASK\" }\n</code></pre>\n\n<p>But what if your client does not necessarily care about default values and expects all fields to be present?</p>\n\n<p><strong>Question : is there a way to change this behaviour? at the very least how do we ensure that if value was set it is being shown?</strong></p>\n\n<p>Maybe there is a way to tell <code>protoc</code> to generate different code (affecting defaults behaviour)...</p>\n"}, {"tags": ["spring", "spring-mvc", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 784, "user_id": 1502561, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d3f2747c15a49715beeea47c2179588d?s=128&d=identicon&r=PG", "display_name": "Mike Emery", "link": "https://stackoverflow.com/users/1502561/mike-emery"}, "edited": false, "score": 1, "creation_date": 1558549453, "post_id": 37433354, "comment_id": 99142106, "body": "worth mentioning here: if you have an abstract class extended by a class with the <code>@Component</code> annotation, spring&#39;s kotlin plugin will NOT make the abstract functions open by default. The child may call the parent without issue, but if something external calls the parent method, it will be looking at all null member variables. Adding <code>open</code> to the method fixes it, or adding a spring annotation to the abstract class, or creating a new annotation and adding it to the <code>kotlin-allopen</code> plugin"}], "tags": [], "owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "is_accepted": true, "score": 12, "last_activity_date": 1511818153, "last_edit_date": 1511818153, "creation_date": 1464169402, "answer_id": 37433354, "question_id": 37431817, "link": "https://stackoverflow.com/questions/37431817/null-pointer-exception-in-spring-proxy-class-and-kotlin/37433354#37433354", "title": "Null Pointer Exception In Spring Proxy Class and Kotlin", "body": "<p>In Kotlin both <a href=\"https://kotlinlang.org/docs/reference/classes.html#wait-how-will-i-hack-my-libraries-now\" rel=\"nofollow noreferrer\">classes and members are final</a> by default.</p>\n\n<p>For the proxying library (<a href=\"https://github.com/cglib/cglib\" rel=\"nofollow noreferrer\">CGLIB</a>, <a href=\"http://jboss-javassist.github.io/javassist/\" rel=\"nofollow noreferrer\">javaassist</a>) to be able to proxy a method it has to be declared <strong>non final</strong> and in a <strong>non final</strong> class (<a href=\"https://stackoverflow.com/questions/10664182/what-is-the-difference-between-jdk-dynamic-proxy-and-cglib\">since those libraries implement proxying by subclassing</a>). Change your controller method to:</p>\n\n<pre><code>@RequestMapping(\"{id}\", method = arrayOf(RequestMethod.GET))\n@Cacheable(cacheNames = arrayOf(\"regions\"))\nopen fun get(@PathVariable id: Long): RegionResource {\n    return this.service.get(id)\n}\n</code></pre>\n\n<p><em>You probably see a warning in console regarding <code>RegionController</code> methods not being subject to proxying.</em></p>\n\n<h3><a href=\"https://kotlinlang.org/docs/reference/compiler-plugins.html#spring-support\" rel=\"nofollow noreferrer\">The Kotlin compiler plugin</a></h3>\n\n<p>The Kotlin team has acknowledged this difficulty and created a plugin that marks the standard AOP proxy candidates e.g. <code>@Component</code> with <code>open</code>. </p>\n\n<p>You can enable the plugin by in your <code>build.gradle</code>:</p>\n\n<pre><code>plugins {\n  id \"org.jetbrains.kotlin.plugin.spring\" version \"1.1.60\"\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8470, "user_id": 1245622, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/V7rHB.jpg?s=128&g=1", "display_name": "linqu", "link": "https://stackoverflow.com/users/1245622/linqu"}, "edited": false, "score": 0, "creation_date": 1485957159, "post_id": 39808560, "comment_id": 71140631, "body": "in the meantime kotlin 1.6 got released along with the new <i>All-open compiler plugin</i>: <a href=\"https://blog.jetbrains.com/kotlin/2016/12/kotlin-1-0-6-is-here/\" rel=\"nofollow noreferrer\">blog.jetbrains.com/kotlin/2016/12/kotlin-1-0-6-is-here</a>"}], "tags": [], "owner": {"reputation": 101, "user_id": 6469159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70af67bee8269c26759e27b5ee802699?s=128&d=identicon&r=PG&f=1", "display_name": "DaImmi", "link": "https://stackoverflow.com/users/6469159/daimmi"}, "is_accepted": false, "score": 1, "last_activity_date": 1475336956, "creation_date": 1475336956, "answer_id": 39808560, "question_id": 37431817, "link": "https://stackoverflow.com/questions/37431817/null-pointer-exception-in-spring-proxy-class-and-kotlin/39808560#39808560", "title": "Null Pointer Exception In Spring Proxy Class and Kotlin", "body": "<p>Soon this might not be a problem any longer.</p>\n\n<p>There is work in progress that any lib (including spring for example) can specify a list of annotations a file in META-INF. Once a class is annotated with one of these, it will default to open for the class itself and all its functions. This is also true for classes inheriting from an annotated class.</p>\n\n<p>For more details, have a look at <a href=\"https://github.com/Kotlin/KEEP/pull/40#issuecomment-250773204\" rel=\"nofollow\">https://github.com/Kotlin/KEEP/pull/40#issuecomment-250773204</a></p>\n"}], "owner": {"reputation": 8470, "user_id": 1245622, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/V7rHB.jpg?s=128&g=1", "display_name": "linqu", "link": "https://stackoverflow.com/users/1245622/linqu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1553, "favorite_count": 1, "accepted_answer_id": 37433354, "answer_count": 2, "score": 7, "last_activity_date": 1511818153, "creation_date": 1464165379, "last_edit_date": 1464711233, "question_id": 37431817, "link": "https://stackoverflow.com/questions/37431817/null-pointer-exception-in-spring-proxy-class-and-kotlin", "title": "Null Pointer Exception In Spring Proxy Class and Kotlin", "body": "<p>I am facing some problems with kotlin in conjunction with spring. </p>\n\n<p>I have a controller bean (without an interface btw) which has an auto-wired service bean via the primary constructor.</p>\n\n<p>It works perfectly unless I use caching annotations for the controller. Apparently springs caching generates a proxy class under the hood which deals with the caching.</p>\n\n<p>My code looks like this:</p>\n\n<pre><code>@RestController\n@RequestMapping(\"/regions/\")\nopen class RegionController @Autowired constructor(val service: RegionService) {\n    @RequestMapping(\"{id}\", method = arrayOf(RequestMethod.GET))\n    @Cacheable(cacheNames = arrayOf(\"regions\"))\n    fun get(@PathVariable id: Long): RegionResource {\n        return this.service.get(id)\n    }\n}\n</code></pre>\n\n<p>The problem now is a null pointer exception when the method is executed, actually <code>this.service</code> is <code>null</code> which technically is not possible as it is a nonnull variable in kotlin.</p>\n\n<p>I assume that <a href=\"https://spring.io/blog/2012/05/23/transactions-caching-and-aop-understanding-proxy-usage-in-spring\" rel=\"noreferrer\">class proxies generated by spring</a> initialize the class with null values instead of the autowired bean. This must be a common pitfall using kotlin and spring. How did you circumvent this problem?</p>\n"}, {"tags": ["android", "proguard", "kotlin", "android-proguard"], "answers": [{"comments": [{"owner": {"reputation": 13031, "user_id": 95462, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/707f27812c3a735e0f352a9b1f7e2489?s=128&d=identicon&r=PG", "display_name": "Greg Ennis", "link": "https://stackoverflow.com/users/95462/greg-ennis"}, "edited": false, "score": 3, "creation_date": 1518876434, "post_id": 42355208, "comment_id": 84688279, "body": "If you do that, then there is no point in running proguard at all"}, {"owner": {"reputation": 13468, "user_id": 635887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63a54e77591e1f9a75d3be9a195db45f?s=128&d=identicon&r=PG", "display_name": "Ray Hunter", "link": "https://stackoverflow.com/users/635887/ray-hunter"}, "reply_to_user": {"reputation": 13031, "user_id": 95462, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/707f27812c3a735e0f352a9b1f7e2489?s=128&d=identicon&r=PG", "display_name": "Greg Ennis", "link": "https://stackoverflow.com/users/95462/greg-ennis"}, "edited": false, "score": 1, "creation_date": 1518918590, "post_id": 42355208, "comment_id": 84699411, "body": "@GregEnnis for you own code that would be fine, since any code that is not used should be deleted from the project. 3rd party code is a different story."}, {"owner": {"reputation": 3033, "user_id": 304266, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/2Iiva.jpg?s=128&g=1", "display_name": "ubuntudroid", "link": "https://stackoverflow.com/users/304266/ubuntudroid"}, "reply_to_user": {"reputation": 13031, "user_id": 95462, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/707f27812c3a735e0f352a9b1f7e2489?s=128&d=identicon&r=PG", "display_name": "Greg Ennis", "link": "https://stackoverflow.com/users/95462/greg-ennis"}, "edited": false, "score": 0, "creation_date": 1557939152, "post_id": 42355208, "comment_id": 98937778, "body": "@GregEnnis is right. If you want to use proguard not just for optimisation (what you are likely referring to), but also for obfuscation, then you should not do this as it will leave all your own code as is, clear to read for anyone getting hold of your APK."}, {"owner": {"reputation": 13468, "user_id": 635887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63a54e77591e1f9a75d3be9a195db45f?s=128&d=identicon&r=PG", "display_name": "Ray Hunter", "link": "https://stackoverflow.com/users/635887/ray-hunter"}, "reply_to_user": {"reputation": 3033, "user_id": 304266, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/2Iiva.jpg?s=128&g=1", "display_name": "ubuntudroid", "link": "https://stackoverflow.com/users/304266/ubuntudroid"}, "edited": false, "score": 1, "creation_date": 1557951947, "post_id": 42355208, "comment_id": 98943279, "body": "@ubuntudroid <code>-keep</code> means that you are keeping the classes under the package and not having proguard remove them. <code>Specifies classes and class members (fields and methods) to be preserved as entry points to your code.</code> <a href=\"https://www.guardsquare.com/en/products/proguard/manual/usage\" rel=\"nofollow noreferrer\">guardsquare.com/en/products/proguard/manual/usage</a> has nothing to do with obfuscating your code. Obfuscation options <a href=\"https://www.guardsquare.com/en/products/proguard/manual/usage#obfuscationoptions\" rel=\"nofollow noreferrer\">guardsquare.com/en/products/proguard/manual/&hellip;</a>"}, {"owner": {"reputation": 3033, "user_id": 304266, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/2Iiva.jpg?s=128&g=1", "display_name": "ubuntudroid", "link": "https://stackoverflow.com/users/304266/ubuntudroid"}, "edited": false, "score": 1, "creation_date": 1557997644, "post_id": 42355208, "comment_id": 98956718, "body": "@RayHunter I stand corrected - my bad. Thanks for the references! :)"}], "tags": [], "owner": {"reputation": 13468, "user_id": 635887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63a54e77591e1f9a75d3be9a195db45f?s=128&d=identicon&r=PG", "display_name": "Ray Hunter", "link": "https://stackoverflow.com/users/635887/ray-hunter"}, "is_accepted": false, "score": 0, "last_activity_date": 1487628992, "creation_date": 1487628992, "answer_id": 42355208, "question_id": 37431372, "link": "https://stackoverflow.com/questions/37431372/cant-find-referenced-class-with-proguard-and-kotlin/42355208#42355208", "title": "&quot;can&#39;t find referenced class&quot; with Proguard and Kotlin", "body": "<p>I would make sure that I have my own package defined in proguard - something like this:</p>\n\n<pre><code>-dontwarn org.ligi.passandroid.**\n-keep class org.ligi.passandroid.** { *; }\n</code></pre>\n"}], "owner": {"reputation": 35330, "user_id": 322642, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0030846647f93ba6bf0938a199688c2e?s=128&d=identicon&r=PG", "display_name": "ligi", "link": "https://stackoverflow.com/users/322642/ligi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1942, "favorite_count": 2, "answer_count": 1, "score": 11, "last_activity_date": 1487628992, "creation_date": 1464164023, "last_edit_date": 1464183439, "question_id": 37431372, "link": "https://stackoverflow.com/questions/37431372/cant-find-referenced-class-with-proguard-and-kotlin", "title": "&quot;can&#39;t find referenced class&quot; with Proguard and Kotlin", "body": "<p>I am having a strange problem with proguard and kotlin. I am gradually converting a proguarded project to kotlin - which went very fine so far but I am getting proguard errors when converting certain classes. I could not yet isolate what the special property of these classes is so it breaks - they seems to be no different than the other ones. As an example InputStreamWithSource is just:</p>\n\n<pre><code>package org.ligi.passandroid.model\n\nimport java.io.InputStream\n\nclass InputStreamWithSource(val source: String, val inputStream: InputStream)\n</code></pre>\n\n<p>and it completely works in the IDE - I can deploy to a device - also all UI tests are running fine. Just when trying to assembleRelease the project I am getting proguard errors I do not understand:</p>\n\n<pre><code>Warning: org.ligi.passandroid.ui.FileUnzipControllerSpec: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.FileUnzipControllerSpec: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.InputStreamProvider: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.InputStreamProvider: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.InputStreamProvider: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.InputStreamProvider: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.InputStreamProvider: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.InputStreamProvider: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.PassImportActivity$ImportAndShowAsyncTask: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.PassImportActivity$ImportAndShowAsyncTask: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.PassImportActivity$ImportAndShowAsyncTask: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.PassImportActivity$ImportAndShowAsyncTask: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.PassImportActivity$ImportAndShowAsyncTask: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.PassViewActivityBase$UpdateAsync: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.PassViewActivityBase$UpdateAsync: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.PassViewActivityBase$UpdateAsync: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.SearchPassesIntentService: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.UnzipPassController: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.UnzipPassController: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.UnzipPassController$InputStreamUnzipControllerSpec: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.UnzipPassController$InputStreamUnzipControllerSpec: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.UnzipPassController$InputStreamUnzipControllerSpec: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.UnzipPassController$InputStreamUnzipControllerSpec: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.UnzipPassDialog: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.UnzipPassDialog: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.UnzipPassDialog$1AlertDialogUpdater: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\nWarning: org.ligi.passandroid.ui.UnzipPassDialog$1AlertDialogUpdater: can't find referenced class org.ligi.passandroid.model.InputStreamWithSource\n</code></pre>\n\n<p>when I add a dontwarn for these classes in the proguard configuration than it crashes at runtime - so these classes are really removed - but they should not be removed as they are used.</p>\n\n<p>I can work around this problem by adding keep class/enum for these classes in the proguard-config - but the question is why this is needed for these classes - IMHO it should not be needed</p>\n\n<p>Anyone has some Idea what could cause this or how best to investigate this problem? The full source is here: <a href=\"https://github.com/ligi/PassAndroid\" rel=\"noreferrer\">https://github.com/ligi/PassAndroid</a></p>\n"}, {"tags": ["java", "intellij-idea", "gradle", "build", "kotlin"], "comments": [{"owner": {"reputation": 13934, "user_id": 4096987, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b66edfbc16fa01f3f45d764a3fa01bb?s=128&d=identicon&r=PG&f=1", "display_name": "AndroidEx", "link": "https://stackoverflow.com/users/4096987/androidex"}, "edited": false, "score": 0, "creation_date": 1464146964, "post_id": 37426775, "comment_id": 62359370, "body": "What&#39;s exactly unresolved? Do you have all kotlin dependencies <a href=\"https://kotlinlang.org/docs/reference/using-gradle.html\" rel=\"nofollow noreferrer\">configured</a>?"}, {"owner": {"reputation": 435, "user_id": 6063999, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a136dda6e51a00e34ea9578bbc9e4b16?s=128&d=identicon&r=PG&f=1", "display_name": "Ives", "link": "https://stackoverflow.com/users/6063999/ives"}, "reply_to_user": {"reputation": 13934, "user_id": 4096987, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b66edfbc16fa01f3f45d764a3fa01bb?s=128&d=identicon&r=PG&f=1", "display_name": "AndroidEx", "link": "https://stackoverflow.com/users/4096987/androidex"}, "edited": false, "score": 0, "creation_date": 1464154103, "post_id": 37426775, "comment_id": 62361391, "body": "when kotlin class (test project)reference from core project (kotlin class) , get the  &#39;Unresolved reference&#39;  at gradle build."}, {"owner": {"reputation": 435, "user_id": 6063999, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a136dda6e51a00e34ea9578bbc9e4b16?s=128&d=identicon&r=PG&f=1", "display_name": "Ives", "link": "https://stackoverflow.com/users/6063999/ives"}, "reply_to_user": {"reputation": 13934, "user_id": 4096987, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b66edfbc16fa01f3f45d764a3fa01bb?s=128&d=identicon&r=PG&f=1", "display_name": "AndroidEx", "link": "https://stackoverflow.com/users/4096987/androidex"}, "edited": false, "score": 0, "creation_date": 1464154154, "post_id": 37426775, "comment_id": 62361414, "body": "yes, i  done the configure."}, {"owner": {"reputation": 89682, "user_id": 675383, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e7a971eb341ffeaa3efca407239bf3b?s=128&d=identicon&r=PG", "display_name": "nhaarman", "link": "https://stackoverflow.com/users/675383/nhaarman"}, "edited": false, "score": 1, "creation_date": 1464160653, "post_id": 37426775, "comment_id": 62364552, "body": "I don&#39;t see a dependency on the Kotlin standard library: <code>compile &quot;org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version&quot;</code>"}, {"owner": {"reputation": 435, "user_id": 6063999, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a136dda6e51a00e34ea9578bbc9e4b16?s=128&d=identicon&r=PG&f=1", "display_name": "Ives", "link": "https://stackoverflow.com/users/6063999/ives"}, "edited": false, "score": 0, "creation_date": 1464168810, "post_id": 37426775, "comment_id": 62369598, "body": "i supplement some code"}, {"owner": {"reputation": 17986, "user_id": 4730812, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d336a10204c1cd2e7fa47071ed629669?s=128&d=identicon&r=PG&f=1", "display_name": "piotrek1543", "link": "https://stackoverflow.com/users/4730812/piotrek1543"}, "edited": false, "score": 0, "creation_date": 1471379878, "post_id": 37426775, "comment_id": 65320825, "body": "is a problem solved?"}, {"owner": {"reputation": 435, "user_id": 6063999, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a136dda6e51a00e34ea9578bbc9e4b16?s=128&d=identicon&r=PG&f=1", "display_name": "Ives", "link": "https://stackoverflow.com/users/6063999/ives"}, "edited": false, "score": 0, "creation_date": 1471520674, "post_id": 37426775, "comment_id": 65384975, "body": "the problem not yet get solved"}], "answers": [{"comments": [{"owner": {"reputation": 435, "user_id": 6063999, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a136dda6e51a00e34ea9578bbc9e4b16?s=128&d=identicon&r=PG&f=1", "display_name": "Ives", "link": "https://stackoverflow.com/users/6063999/ives"}, "edited": false, "score": 0, "creation_date": 1464227127, "post_id": 37436841, "comment_id": 62402047, "body": "yes , i have classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version&quot; in buildscript dependencies."}], "tags": [], "owner": {"reputation": 4427, "user_id": 4706743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b05c3b09628ba8955d6d7a188271af?s=128&d=identicon&r=PG&f=1", "display_name": "D3xter", "link": "https://stackoverflow.com/users/4706743/d3xter"}, "is_accepted": false, "score": 0, "last_activity_date": 1464178581, "creation_date": 1464178581, "answer_id": 37436841, "question_id": 37426775, "link": "https://stackoverflow.com/questions/37426775/kotlin-project-cant-be-build-in-gradle/37436841#37436841", "title": "kotlin project can&#39;t be build in gradle", "body": "<p>The kotlin-gradle-plugin is not a dependency of your subprojects, it is a dependency of the buildscript itself.</p>\n\n<p>Follow the instructions on <a href=\"https://kotlinlang.org/docs/reference/using-gradle.html#plugin-and-versions\" rel=\"nofollow\">Plugin and Versions</a></p>\n"}], "owner": {"reputation": 435, "user_id": 6063999, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a136dda6e51a00e34ea9578bbc9e4b16?s=128&d=identicon&r=PG&f=1", "display_name": "Ives", "link": "https://stackoverflow.com/users/6063999/ives"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1739, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1464228655, "creation_date": 1464142772, "last_edit_date": 1464228655, "question_id": 37426775, "link": "https://stackoverflow.com/questions/37426775/kotlin-project-cant-be-build-in-gradle", "title": "kotlin project can&#39;t be build in gradle", "body": "<p>I have a java project that write in kotlin ,i use intelliJ IDEA to develop this project.  I have trouble on the dependencies setting (multiple project). I already read lot of examples , but I can't find the workaround , here is my dependencies setting code,\nit can be build in java class correctly , but the kotlin class will get lot of error 'Unresolved reference' . Is that any wrong about my setting or gradle is not suitable with kotlin . </p>\n\n<p>PS : when i only build core project , build process will successful , but build at test project will get the reference unresolved error   </p>\n\n<pre><code>allprojects {\napply plugin: 'java'\napply plugin: 'kotlin'\ngroup 'testProject'\nversion '1.0'\n}\n\n\n\nsubprojects{\napply plugin:  'java'\napply plugin: 'kotlin'\ndef defaultEncoding = 'UTF-8'\ncompileJava.options.encoding = defaultEncoding\nsourceCompatibility = 1.8\ntargetCompatibility = 1.8\n\nrepositories {\n    mavenCentral()\n    mavenLocal()\n}\n\ndependencies {\n\n    // Kotlin\n    compile \"org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version\"\n    compile \"org.jetbrains.kotlin:kotlin-reflect:$kotlin_version\"\n    compile \"org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version\"\n}\n}\nproject(':test') {\ndependencies {\n    compile project(':core')\n    compile project(':testTwo')\n}\n\nproject(':testTwo'){\ndependencies{\n    compile project(':core')\n}\n</code></pre>\n\n<p>setting.gradle</p>\n\n<pre><code>include 'test','testTwo','core'\n</code></pre>\n"}, {"tags": ["kotlin", "inline"], "comments": [{"owner": {"reputation": 89682, "user_id": 675383, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e7a971eb341ffeaa3efca407239bf3b?s=128&d=identicon&r=PG", "display_name": "nhaarman", "link": "https://stackoverflow.com/users/675383/nhaarman"}, "edited": false, "score": 4, "creation_date": 1464119484, "post_id": 37422399, "comment_id": 62350511, "body": "If it depends on your specific use, show the specific use."}, {"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "edited": false, "score": 3, "creation_date": 1464120995, "post_id": 37422399, "comment_id": 62351334, "body": "A <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a> would help. I can&#39;t this example to compile when trying to create stubs for the various types, etc."}, {"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 2, "creation_date": 1464165352, "post_id": 37422399, "comment_id": 62367251, "body": "could you please replaces all your custom types with standard like <code>String</code> or simple defined like <code>class A</code>? That way we can build your example and see the problem"}, {"owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "edited": false, "score": 1, "creation_date": 1464187006, "post_id": 37422399, "comment_id": 62383208, "body": "@Jire Could it be possible that you&#39;re profiling the code compiled when <code>reusable</code> was not an <code>inline</code> function?"}, {"owner": {"reputation": 7656, "user_id": 1938929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/OeAme.png?s=128&g=1", "display_name": "Jire", "link": "https://stackoverflow.com/users/1938929/jire"}, "edited": false, "score": 0, "creation_date": 1464189874, "post_id": 37422399, "comment_id": 62385481, "body": "I&#39;m working on an MCVE, this problem is very hard to replicate."}, {"owner": {"reputation": 7656, "user_id": 1938929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/OeAme.png?s=128&g=1", "display_name": "Jire", "link": "https://stackoverflow.com/users/1938929/jire"}, "reply_to_user": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "edited": false, "score": 0, "creation_date": 1464189997, "post_id": 37422399, "comment_id": 62385574, "body": "@Ilya I&#39;ve profiled it multiple times, all with inline. The same results happen every time. Unfortunately the problem is extremely hard to replicate, I believe it has something to do with many-level virtual extension functions."}], "owner": {"reputation": 7656, "user_id": 1938929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/OeAme.png?s=128&g=1", "display_name": "Jire", "link": "https://stackoverflow.com/users/1938929/jire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 2, "answer_count": 0, "score": 0, "last_activity_date": 1495767792, "creation_date": 1464118559, "last_edit_date": 1495767792, "question_id": 37422399, "link": "https://stackoverflow.com/questions/37422399/kotlin-fails-to-inline-some-bodies", "title": "Kotlin fails to inline some bodies", "body": "<p>I have an inline function which accepts two lambdas. This function is called in a hotspot of my code and, despite it being inline, thousands of objects are created for the bodies.</p>\n\n<p>What's interesting is commenting out, or replacing the bodies with simple calls like <code>println</code>s and everything works perfectly. But for some reason with my specific use, it seems like inline is failing to do its job!</p>\n\n<p>How can I resolve this? And what are the limitations associated with inlining bodies? Is this a bug?</p>\n\n<p><a href=\"https://i.imgur.com/bJsz4Cx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.imgur.com/bJsz4Cx.png\" alt=\"enter image description here\"></a></p>\n\n<p>My use case:</p>\n\n<pre><code>fun PlayerSend.sync() = reusable({\n    val packet = this\n\n    it.syncMovement(packet)\n\n    reusable({ if (it.updateRequired) it.sync(this) }, {\n        packet.bits(8, 0 /* amount of players to update */)\n        if (readable &gt; 0) {\n            packet.bits(11, 2047).byteAccess() + this\n        } else packet.byteAccess()\n    })\n}, { ses + 81.byte + readable.short + this })\n</code></pre>\n\n<p>The method header:</p>\n\n<pre><code>inline fun &lt;R1, R2&gt; reusable(use: ByteBufPacketeer.() -&gt; R1, after: ByteBufPacketeer.() -&gt; R2) {\n        val reusables = Reusables.get()\n        val count = ReuseablesCount.get()\n        ReuseablesCount.set(if (count + 1 &gt;= reusables.size) 0 else count + 1)\n        with(reusables[count]) {\n            use()\n            after()\n            clear()\n        }\n    }\n</code></pre>\n"}, {"tags": ["stream", "sequence", "rx-java", "kotlin", "rx-kotlin"], "comments": [{"owner": {"reputation": 9475, "user_id": 1373258, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/057cb1f71b78244924b7854605d79a9d?s=128&d=identicon&r=PG&f=1", "display_name": "tmn", "link": "https://stackoverflow.com/users/1373258/tmn"}, "edited": false, "score": 0, "creation_date": 1464116465, "post_id": 37421742, "comment_id": 62348942, "body": "I&#39;ve done something similar using a strictly pull-based implementation <a href=\"https://github.com/thomasnield/kdbc/blob/master/src/main/kotlin/kdbc/SelectBuilder.kt#L23:L38\" rel=\"nofollow noreferrer\">github.com/thomasnield/kdbc/blob/master/src/main/kotlin/kdbc&zwnj;&#8203;/&hellip;</a>"}, {"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "edited": false, "score": 1, "creation_date": 1464118611, "post_id": 37421742, "comment_id": 62350064, "body": "An observable can actually work in another thread, so I don&#39;t believe it&#39;s easy (if possible at all). Why avoid <code>toBlocking()</code>? As I understand, it would be a safe and easy way to achieve what you need."}, {"owner": {"reputation": 9475, "user_id": 1373258, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/057cb1f71b78244924b7854605d79a9d?s=128&d=identicon&r=PG&f=1", "display_name": "tmn", "link": "https://stackoverflow.com/users/1373258/tmn"}, "reply_to_user": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "edited": false, "score": 0, "creation_date": 1464125976, "post_id": 37421742, "comment_id": 62353901, "body": "I don&#39;t think that would work with a stateful ResultSet..."}], "answers": [{"comments": [{"owner": {"reputation": 9475, "user_id": 1373258, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/057cb1f71b78244924b7854605d79a9d?s=128&d=identicon&r=PG&f=1", "display_name": "tmn", "link": "https://stackoverflow.com/users/1373258/tmn"}, "edited": false, "score": 0, "creation_date": 1464125859, "post_id": 37423378, "comment_id": 62353841, "body": "Excellent. I&#39;ll play with this tonight when I get home."}, {"owner": {"reputation": 9475, "user_id": 1373258, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/057cb1f71b78244924b7854605d79a9d?s=128&d=identicon&r=PG&f=1", "display_name": "tmn", "link": "https://stackoverflow.com/users/1373258/tmn"}, "edited": false, "score": 0, "creation_date": 1464126740, "post_id": 37423378, "comment_id": 62354228, "body": "Studying this on my phone this is brilliant. The only thing that might be of concern is the fact only one ResultSet should be in the queue at a time, and it should block on either the get or put end to ensure that. If the queue cannot be constrained, I could always create my own synchronizer..."}, {"owner": {"reputation": 50303, "user_id": 170842, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/c2ea72b8d001d81fb6ce3f356e45eb3a?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/170842/michael"}, "reply_to_user": {"reputation": 9475, "user_id": 1373258, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/057cb1f71b78244924b7854605d79a9d?s=128&d=identicon&r=PG&f=1", "display_name": "tmn", "link": "https://stackoverflow.com/users/1373258/tmn"}, "edited": false, "score": 1, "creation_date": 1464127557, "post_id": 37423378, "comment_id": 62354536, "body": "@ThomasN. You can set maximum capacity to the <code>queue</code> passing it to a <code>LinkedBlockingQueue </code> constructor."}, {"owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "edited": false, "score": 2, "creation_date": 1464135562, "post_id": 37423378, "comment_id": 62356960, "body": "How is this way different from <code>Sequence { observable.toBlocking().getIterator() }</code>?"}, {"owner": {"reputation": 9475, "user_id": 1373258, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/057cb1f71b78244924b7854605d79a9d?s=128&d=identicon&r=PG&f=1", "display_name": "tmn", "link": "https://stackoverflow.com/users/1373258/tmn"}, "edited": false, "score": 0, "creation_date": 1464142430, "post_id": 37423378, "comment_id": 62358399, "body": "Ilya, the <code>toBlocking().getIterator()</code> seems to collect all items before iterating them. The <code>onCompleted()</code> gets called before any sequences are printed. <code>Observable.just(&quot;Alpha&quot;,&quot;Beta&quot;,&quot;Gamma&quot;).doOnCompleted { println(&quot;Done!&quot;) }.toBlocking().iterator.asSequence().forEach { println(it) }</code>"}, {"owner": {"reputation": 9475, "user_id": 1373258, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/057cb1f71b78244924b7854605d79a9d?s=128&d=identicon&r=PG&f=1", "display_name": "tmn", "link": "https://stackoverflow.com/users/1373258/tmn"}, "edited": false, "score": 0, "creation_date": 1464143223, "post_id": 37423378, "comment_id": 62358572, "body": "This is working beautifully @Michael. One question. Obviously some scheduling is needed to make two independent work streams, one for the <code>Observable</code> and another for the <code>Sequence</code>. But why the <code>observeOn()</code> and not a <code>subscribeOn()</code>? Is there any risk for backpressure problems? Or will the blocking on the queue keep that from happening?"}, {"owner": {"reputation": 9475, "user_id": 1373258, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/057cb1f71b78244924b7854605d79a9d?s=128&d=identicon&r=PG&f=1", "display_name": "tmn", "link": "https://stackoverflow.com/users/1373258/tmn"}, "edited": false, "score": 0, "creation_date": 1464145008, "post_id": 37423378, "comment_id": 62358936, "body": "Interesting. If I use <code>subscribeOn()</code> instead of <code>observeOn()</code>, the emissions and sequences interleave like I would want. But the <code>observeOn()</code> seems to stage and collect the emissions before moving on to the sequences. Are you sure this shouldn&#39;t use <code>subscribeOn()</code>? The <code>Observable</code> and <code>Sequence</code> operations must both be operating on completely separate threads."}, {"owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "reply_to_user": {"reputation": 9475, "user_id": 1373258, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/057cb1f71b78244924b7854605d79a9d?s=128&d=identicon&r=PG&f=1", "display_name": "tmn", "link": "https://stackoverflow.com/users/1373258/tmn"}, "edited": false, "score": 0, "creation_date": 1464145590, "post_id": 37423378, "comment_id": 62359076, "body": "@ThomasN. if you take a look at the implementation of <code>getIterator</code>, you&#39;ll find it very similiar to the answer given by @Michael: <a href=\"https://github.com/ReactiveX/RxJava/blob/1.x/src/main/java/rx/internal/operators/BlockingOperatorToIterator.java\" rel=\"nofollow noreferrer\">github.com/ReactiveX/RxJava/blob/1.x/src/main/java/rx/intern&zwnj;&#8203;al/&hellip;</a>"}, {"owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "edited": false, "score": 1, "creation_date": 1464145661, "post_id": 37423378, "comment_id": 62359096, "body": "You can ensure that <code>toBlocking().getIterator()</code> doesn&#39;t wait for observable to complete with this snippet: <code>Observable.interval(500, TimeUnit.MILLISECONDS)             .take(10)             .doOnCompleted { println(&quot;Done!&quot;) }             .toBlocking().iterator.asSequence()             .forEach { println(it) }</code>"}, {"owner": {"reputation": 50303, "user_id": 170842, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/c2ea72b8d001d81fb6ce3f356e45eb3a?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/170842/michael"}, "reply_to_user": {"reputation": 9475, "user_id": 1373258, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/057cb1f71b78244924b7854605d79a9d?s=128&d=identicon&r=PG&f=1", "display_name": "tmn", "link": "https://stackoverflow.com/users/1373258/tmn"}, "edited": false, "score": 0, "creation_date": 1464153145, "post_id": 37423378, "comment_id": 62361066, "body": "@ThomasN. Sorry, <code>observeOn</code> was just a bug. Fixed it."}, {"owner": {"reputation": 50303, "user_id": 170842, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/c2ea72b8d001d81fb6ce3f356e45eb3a?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/170842/michael"}, "reply_to_user": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "edited": false, "score": 0, "creation_date": 1464156177, "post_id": 37423378, "comment_id": 62362196, "body": "@Ilya Seems you&#39;re right and I was tricked by docs. So I don&#39;t really see any difference now from what <code>.toBlocking().iterator</code> does. But it seems to me that my implementation doesn&#39;t do what @ThomasN. really wants. I mean it doesn&#39;t block producer until consumer is ready. Maybe I have to delete the answer. I&#39;ll try to do a little more research on this."}, {"owner": {"reputation": 9475, "user_id": 1373258, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/057cb1f71b78244924b7854605d79a9d?s=128&d=identicon&r=PG&f=1", "display_name": "tmn", "link": "https://stackoverflow.com/users/1373258/tmn"}, "edited": false, "score": 0, "creation_date": 1464172550, "post_id": 37423378, "comment_id": 62372227, "body": "Just feel free to edit :) this got me closer than anything else. I can make my own synchronizer and drop it into this."}], "tags": [], "owner": {"reputation": 50303, "user_id": 170842, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/c2ea72b8d001d81fb6ce3f356e45eb3a?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/170842/michael"}, "is_accepted": true, "score": 4, "last_activity_date": 1464153026, "last_edit_date": 1464153026, "creation_date": 1464122118, "answer_id": 37423378, "question_id": 37421742, "link": "https://stackoverflow.com/questions/37421742/rxjava-turn-observable-into-iterator-stream-or-sequence/37423378#37423378", "title": "RxJava- Turn Observable into Iterator, Stream, or Sequence", "body": "<p>I'm not sure that's the easiest way to achieve what you want but you can try this code. It converts an <code>Observable</code> to an <code>Iterator</code> by creating a blocking queue and publishing all events from the <code>Observable</code> to this queue. The <code>Iterable</code> pulls events from the queue and blocks if there're none. Then it modify its own state depending on received current event.</p>\n\n<pre><code>class ObservableIterator&lt;T&gt;(\n    observable: Observable&lt;T&gt;,\n    scheduler: Scheduler\n) : Iterator&lt;T&gt;, Closeable {\n\n  private val queue = LinkedBlockingQueue&lt;Notification&lt;T&gt;&gt;()\n  private var cached: Notification&lt;T&gt;? = null\n  private var completed: Boolean = false\n\n  private val subscription =\n      observable\n          .materialize()\n          .subscribeOn(scheduler)\n          .subscribe({ queue.put(it) })\n\n  override fun hasNext(): Boolean {\n    cacheNext()\n    return !completed\n  }\n\n  override fun next(): T {\n    cacheNext()\n    val notification = cached ?: throw NoSuchElementException()\n    check(notification.isOnNext)\n    cached = null\n    return notification.value\n  }\n\n  private fun cacheNext() {\n    if (completed) {\n      return\n    }\n\n    if (cached == null) {\n      queue.take().let { notification -&gt;\n        if (notification.isOnError) {\n          completed = true\n          throw RuntimeException(notification.throwable)\n        } else if (notification.isOnCompleted) {\n          completed = true\n        } else {\n          cached = notification\n        }\n      }\n    }\n  }\n\n  override fun close() {\n    subscription.unsubscribe()\n    completed = true\n    cached = null\n  }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9475, "user_id": 1373258, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/057cb1f71b78244924b7854605d79a9d?s=128&d=identicon&r=PG&f=1", "display_name": "tmn", "link": "https://stackoverflow.com/users/1373258/tmn"}, "edited": false, "score": 0, "creation_date": 1464146962, "post_id": 37427232, "comment_id": 62359369, "body": "Okay, maybe that is why I got the wrong impression as I needed to use subscribeOn(). I will take a look at this a little more closely tomorrow. I am glad there is an operator built in for this purpose."}, {"owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "reply_to_user": {"reputation": 9475, "user_id": 1373258, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/057cb1f71b78244924b7854605d79a9d?s=128&d=identicon&r=PG&f=1", "display_name": "tmn", "link": "https://stackoverflow.com/users/1373258/tmn"}, "edited": false, "score": 1, "creation_date": 1464147705, "post_id": 37427232, "comment_id": 62359541, "body": "@ThomasN. What do you mean by strictly sequential? If you must not return from <code>onNext</code> of the subscriber until the result set is fetched from the iterator and processed, I&#39;m afraid you&#39;ll need some manual synchronization."}, {"owner": {"reputation": 9475, "user_id": 1373258, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/057cb1f71b78244924b7854605d79a9d?s=128&d=identicon&r=PG&f=1", "display_name": "tmn", "link": "https://stackoverflow.com/users/1373258/tmn"}, "edited": false, "score": 0, "creation_date": 1464147735, "post_id": 37427232, "comment_id": 62359554, "body": "Yes, that would be a problem with the ResultSet expiring. I believe the same ResultSet instance is emitted every time. It is its internal state that changes every time it is emitted. If its state is changing faster than each state can be consumed, that is a big problem."}, {"owner": {"reputation": 9475, "user_id": 1373258, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/057cb1f71b78244924b7854605d79a9d?s=128&d=identicon&r=PG&f=1", "display_name": "tmn", "link": "https://stackoverflow.com/users/1373258/tmn"}, "edited": false, "score": 0, "creation_date": 1464147830, "post_id": 37427232, "comment_id": 62359576, "body": "Yeah, I think manual synchronization will be necessary so ill have to go with that similar implementation from @Michael. But thank you, this solution works for every other case I came across other than the ResultSet one :)"}, {"owner": {"reputation": 9475, "user_id": 1373258, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/057cb1f71b78244924b7854605d79a9d?s=128&d=identicon&r=PG&f=1", "display_name": "tmn", "link": "https://stackoverflow.com/users/1373258/tmn"}, "edited": false, "score": 0, "creation_date": 1464275889, "post_id": 37427232, "comment_id": 62428568, "body": "Got some help creating a synchronizer for this purpose here. <a href=\"http://stackoverflow.com/questions/37446814/creating-a-singleblockingqueue-synchronizer/37455141#37455141\" title=\"creating a singleblockingqueue synchronizer\">stackoverflow.com/questions/37446814/&hellip;</a>"}], "tags": [], "owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "is_accepted": false, "score": 3, "last_activity_date": 1464147386, "last_edit_date": 1464147386, "creation_date": 1464146511, "answer_id": 37427232, "question_id": 37421742, "link": "https://stackoverflow.com/questions/37421742/rxjava-turn-observable-into-iterator-stream-or-sequence/37427232#37427232", "title": "RxJava- Turn Observable into Iterator, Stream, or Sequence", "body": "<p>You can use the following helper function:</p>\n\n<pre><code>fun &lt;T&gt; Observable&lt;T&gt;.asSequence() = Sequence { toBlocking().getIterator() }\n</code></pre>\n\n<p>The observable will be subscribed to when the sequence returned is called for iterator.</p>\n\n<p>If an observable emits elements on the same thread it was subscribed to (like <code>Observable.just</code> for example), it will populate the buffer of the iterator before it gets a chance to be returned. \nIn this case you might need to direct subscription to the different thread with a call to <code>subscribeOn</code>:</p>\n\n<pre><code>observable.subscribeOn(scheduler).asSequence()\n</code></pre>\n\n<p>However, while <code>toBlocking().getIterator()</code> doesn't buffer all results it could buffer some of them if they aren't consumed timely by the iterator. That might be a problem if a <code>ResultSet</code> gets somehow expired when the next <code>ResultSet</code> arrives.</p>\n"}], "owner": {"reputation": 9475, "user_id": 1373258, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/057cb1f71b78244924b7854605d79a9d?s=128&d=identicon&r=PG&f=1", "display_name": "tmn", "link": "https://stackoverflow.com/users/1373258/tmn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2722, "favorite_count": 2, "accepted_answer_id": 37423378, "answer_count": 2, "score": 4, "last_activity_date": 1464153026, "creation_date": 1464116238, "last_edit_date": 1464117919, "question_id": 37421742, "link": "https://stackoverflow.com/questions/37421742/rxjava-turn-observable-into-iterator-stream-or-sequence", "title": "RxJava- Turn Observable into Iterator, Stream, or Sequence", "body": "<p>I know this breaks a lot of Rx rules, but I really like <a href=\"https://github.com/davidmoten/rxjava-jdbc\" rel=\"nofollow\">RxJava-JDBC</a> and so do my teammates. Relational databases are very core to what we do and so is Rx.</p>\n\n<p>However there are some occasions where we do not want to emit as an <code>Observable&lt;ResultSet&gt;</code> but would rather just have a pull-based Java 8 <code>Stream&lt;ResultSet&gt;</code> or Kotlin <code>Sequence&lt;ResultSet&gt;</code>. But we are very accustomed to the RxJava-JDBC library which only returns an <code>Observable&lt;ResultSet&gt;</code>. </p>\n\n<p>Therefore, I am wondering if there is a way I can turn an <code>Observable&lt;ResultSet&gt;</code> into a <code>Sequence&lt;ResultSet&gt;</code> using an extension function, and not do any intermediary collection or <code>toBlocking()</code> calls. Below is all I have so far but my head is spinning now trying to connect push and pull based systems, and I cannot buffer either as the <code>ResultSet</code> is stateful with each <code>onNext()</code> call. Is this an impossible task?</p>\n\n<pre><code>import rx.Observable\nimport rx.Subscriber\nimport java.sql.ResultSet\n\nfun Observable&lt;ResultSet&gt;.asSequence() = object: Iterator&lt;ResultSet&gt;, Subscriber&lt;ResultSet&gt;() {\n\n    private var isComplete = false\n\n    override fun onCompleted() {\n        isComplete = true\n    }\n\n    override fun onError(e: Throwable?) {\n        throw UnsupportedOperationException()\n    }\n\n    override fun onNext(rs: ResultSet?) {\n        throw UnsupportedOperationException()\n    }\n\n\n    override fun hasNext(): Boolean {\n        throw UnsupportedOperationException()\n    }\n\n    override fun next(): ResultSet {\n        throw UnsupportedOperationException()\n    }\n\n}.asSequence()\n</code></pre>\n"}, {"tags": ["android-studio", "android-gradle-plugin", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 888, "user_id": 1122242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c94e800354854bafd803f7ff56239e0?s=128&d=identicon&r=PG", "display_name": "moveaway00", "link": "https://stackoverflow.com/users/1122242/moveaway00"}, "edited": false, "score": 0, "creation_date": 1464151663, "post_id": 37409126, "comment_id": 62360605, "body": "Yes! Thank you so much!"}], "tags": [], "owner": {"reputation": 12744, "user_id": 803225, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f2095982dbc8eea05059c2d2aea28133?s=128&d=identicon&r=PG", "display_name": "Chris.Jenkins", "link": "https://stackoverflow.com/users/803225/chris-jenkins"}, "is_accepted": true, "score": 25, "last_activity_date": 1464081159, "creation_date": 1464081159, "answer_id": 37409126, "question_id": 37409125, "link": "https://stackoverflow.com/questions/37409125/android-plugin-2-2-0-alpha1-fails-to-compile-with-kotlin/37409126#37409126", "title": "Android Plugin 2.2.0-alpha1 fails to compile with Kotlin", "body": "<p>This seems to be a dependency issue where the new Android Gradle Plugin includes Kotlin, but an older version.</p>\n\n<p>The work around for now is to reorder the classpath dependencies putting the kotlin plugin before the android one.</p>\n\n<pre><code>dependencies {\n  classpath \"org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version\"\n  classpath \"com.android.tools.build:gradle:$gradle_tools_version\"\n}\n</code></pre>\n\n<p>See the issue being tracked here: <a href=\"https://youtrack.jetbrains.com/issue/KT-12431\">https://youtrack.jetbrains.com/issue/KT-12431</a></p>\n"}], "owner": {"reputation": 12744, "user_id": 803225, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f2095982dbc8eea05059c2d2aea28133?s=128&d=identicon&r=PG", "display_name": "Chris.Jenkins", "link": "https://stackoverflow.com/users/803225/chris-jenkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1195, "favorite_count": 0, "accepted_answer_id": 37409126, "answer_count": 1, "score": 12, "last_activity_date": 1464081159, "creation_date": 1464081159, "question_id": 37409125, "link": "https://stackoverflow.com/questions/37409125/android-plugin-2-2-0-alpha1-fails-to-compile-with-kotlin", "title": "Android Plugin 2.2.0-alpha1 fails to compile with Kotlin", "body": "<p>After upgrading to Android build tools 2.2.0-alpha1. I can't configure the Application or build.</p>\n\n<p>I get the following stack trace from gradle:</p>\n\n<pre><code>e: java.lang.IllegalStateException: Built-in library initialization failed. Please ensure you have kotlin-runtime.jar in the classpath: java.lang.NoSuchMethodError: com.google.protobuf.GeneratedMessageLite.newSingularGeneratedExtension(Lcom/google/protobuf/MessageLite;Ljava/lang/Object;Lcom/google/protobuf/MessageLite;Lcom/google/protobuf/Internal$EnumLiteMap;ILcom/google/protobuf/WireFormat$FieldType;)Lcom/google/protobuf/GeneratedMessageLite$GeneratedExtension;\n    at org.jetbrains.kotlin.builtins.BuiltInsInitializer.initialize(BuiltInsInitializer.kt:45)\n    at org.jetbrains.kotlin.builtins.BuiltInsInitializer.get(BuiltInsInitializer.kt:62)\n    at org.jetbrains.kotlin.platform.JvmBuiltIns$Companion.getInstance(JvmBuiltIns.kt:32)\n    at org.jetbrains.kotlin.resolve.jvm.platform.JvmPlatform.getBuiltIns(JvmPlatform.kt:41)\n    at org.jetbrains.kotlin.resolve.TargetPlatformKt.createModule(TargetPlatform.kt:112)\n    at org.jetbrains.kotlin.resolve.TargetPlatformKt.createModule$default(TargetPlatform.kt:111)\n    at org.jetbrains.kotlin.context.ContextKt.ContextForNewModule(context.kt:124)\n    at org.jetbrains.kotlin.resolve.jvm.TopDownAnalyzerFacadeForJVM.createContextWithSealedModule(TopDownAnalyzerFacadeForJVM.java:163)\n    at org.jetbrains.kotlin.cli.jvm.compiler.KotlinToJVMBytecodeCompiler$analyze$1.analyze(KotlinToJVMBytecodeCompiler.kt:322)\n    at org.jetbrains.kotlin.cli.common.messages.AnalyzerWithCompilerReport.analyzeAndReport(AnalyzerWithCompilerReport.kt:129)\n    at org.jetbrains.kotlin.cli.jvm.compiler.KotlinToJVMBytecodeCompiler.analyze(KotlinToJVMBytecodeCompiler.kt:318)\n    at org.jetbrains.kotlin.cli.jvm.compiler.KotlinToJVMBytecodeCompiler.compileModules(KotlinToJVMBytecodeCompiler.kt:124)\n    at org.jetbrains.kotlin.cli.jvm.K2JVMCompiler.doExecute(K2JVMCompiler.kt:173)\n    at org.jetbrains.kotlin.cli.jvm.K2JVMCompiler.doExecute(K2JVMCompiler.kt:49)\n    at org.jetbrains.kotlin.cli.common.CLICompiler.exec(CLICompiler.java:220)\n    at org.jetbrains.kotlin.gradle.tasks.KotlinCompile.compileNotIncremental(Tasks.kt:497)\n    at org.jetbrains.kotlin.gradle.tasks.KotlinCompile.callCompiler(Tasks.kt:370)\n    at org.jetbrains.kotlin.gradle.tasks.KotlinCompile.callCompiler(Tasks.kt:149)\n    at org.jetbrains.kotlin.gradle.tasks.AbstractKotlinCompile.execute(Tasks.kt:110)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:498)\n    at org.gradle.internal.reflect.JavaMethod.invoke(JavaMethod.java:75)\n    at org.gradle.api.internal.project.taskfactory.AnnotationProcessingTaskFactory$IncrementalTaskAction.doExecute(AnnotationProcessingTaskFactory.java:245)\n    at org.gradle.api.internal.project.taskfactory.AnnotationProcessingTaskFactory$StandardTaskAction.execute(AnnotationProcessingTaskFactory.java:221)\n    at org.gradle.api.internal.project.taskfactory.AnnotationProcessingTaskFactory$IncrementalTaskAction.execute(AnnotationProcessingTaskFactory.java:232)\n    at org.gradle.api.internal.project.taskfactory.AnnotationProcessingTaskFactory$StandardTaskAction.execute(AnnotationProcessingTaskFactory.java:210)\n    at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeAction(ExecuteActionsTaskExecuter.java:80)\n    at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeActions(ExecuteActionsTaskExecuter.java:61)\n    at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.execute(ExecuteActionsTaskExecuter.java:46)\n    at org.gradle.api.internal.tasks.execution.PostExecutionAnalysisTaskExecuter.execute(PostExecutionAnalysisTaskExecuter.java:35)\n    at org.gradle.api.internal.tasks.execution.SkipUpToDateTaskExecuter.execute(SkipUpToDateTaskExecuter.java:68)\n    at org.gradle.api.internal.tasks.execution.ValidatingTaskExecuter.execute(ValidatingTaskExecuter.java:58)\n    at org.gradle.api.internal.tasks.execution.SkipEmptySourceFilesTaskExecuter.execute(SkipEmptySourceFilesTaskExecuter.java:52)\n    at org.gradle.api.internal.tasks.execution.SkipTaskWithNoActionsExecuter.execute(SkipTaskWithNoActionsExecuter.java:52)\n    at org.gradle.api.internal.tasks.execution.SkipOnlyIfTaskExecuter.execute(SkipOnlyIfTaskExecuter.java:53)\n    at org.gradle.api.internal.tasks.execution.ExecuteAtMostOnceTaskExecuter.execute(ExecuteAtMostOnceTaskExecuter.java:43)\n    at org.gradle.execution.taskgraph.DefaultTaskGraphExecuter$EventFiringTaskWorker.execute(DefaultTaskGraphExecuter.java:203)\n    at org.gradle.execution.taskgraph.DefaultTaskGraphExecuter$EventFiringTaskWorker.execute(DefaultTaskGraphExecuter.java:185)\n    at org.gradle.execution.taskgraph.AbstractTaskPlanExecutor$TaskExecutorWorker.processTask(AbstractTaskPlanExecutor.java:66)\n    at org.gradle.execution.taskgraph.AbstractTaskPlanExecutor$TaskExecutorWorker.run(AbstractTaskPlanExecutor.java:50)\n    at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:54)\n    at org.gradle.internal.concurrent.StoppableExecutorImpl$1.run(StoppableExecutorImpl.java:40)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n    at java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.NoSuchMethodError: com.google.protobuf.GeneratedMessageLite.newSingularGeneratedExtension(Lcom/google/protobuf/MessageLite;Ljava/lang/Object;Lcom/google/protobuf/MessageLite;Lcom/google/protobuf/Internal$EnumLiteMap;ILcom/google/protobuf/WireFormat$FieldType;)Lcom/google/protobuf/GeneratedMessageLite$GeneratedExtension;\n    at org.jetbrains.kotlin.serialization.builtins.BuiltInsProtoBuf.&lt;clinit&gt;(BuiltInsProtoBuf.java:879)\n    at org.jetbrains.kotlin.builtins.BuiltInSerializerProtocol.&lt;init&gt;(BuiltInSerializerProtocol.kt:25)\n    at org.jetbrains.kotlin.builtins.BuiltInSerializerProtocol.&lt;clinit&gt;(BuiltInSerializerProtocol.kt:24)\n    at org.jetbrains.kotlin.builtins.BuiltInsPackageFragment.&lt;init&gt;(BuiltInsPackageFragment.kt:34)\n    at org.jetbrains.kotlin.builtins.BuiltInsPackageFragmentProviderKt.createBuiltInPackageFragmentProvider(builtInsPackageFragmentProvider.kt:37)\n    at org.jetbrains.kotlin.builtins.KotlinBuiltIns.&lt;init&gt;(KotlinBuiltIns.java:84)\n    at org.jetbrains.kotlin.platform.JvmBuiltIns.&lt;init&gt;(JvmBuiltIns.kt:24)\n    at org.jetbrains.kotlin.platform.JvmBuiltIns.&lt;init&gt;(JvmBuiltIns.kt:24)\n    at org.jetbrains.kotlin.platform.JvmBuiltIns$Companion$initializer$1.invoke(JvmBuiltIns.kt:27)\n    at org.jetbrains.kotlin.platform.JvmBuiltIns$Companion$initializer$1.invoke(JvmBuiltIns.kt:25)\n    at org.jetbrains.kotlin.builtins.BuiltInsInitializer.initialize(BuiltInsInitializer.kt:41)\n    ... 46 more\n\ne: java.lang.AssertionError: Built-ins are not initialized (note: We are under the same lock as initializing and instance)\n    at org.jetbrains.kotlin.builtins.BuiltInsInitializer.get(BuiltInsInitializer.kt:57)\n    at org.jetbrains.kotlin.platform.JvmBuiltIns$Companion.getInstance(JvmBuiltIns.kt:32)\n    at org.jetbrains.kotlin.resolve.jvm.platform.JvmPlatform.getBuiltIns(JvmPlatform.kt:41)\n    at org.jetbrains.kotlin.resolve.TargetPlatformKt.createModule(TargetPlatform.kt:112)\n    at org.jetbrains.kotlin.resolve.TargetPlatformKt.createModule$default(TargetPlatform.kt:111)\n    at org.jetbrains.kotlin.context.ContextKt.ContextForNewModule(context.kt:124)\n    at org.jetbrains.kotlin.resolve.jvm.TopDownAnalyzerFacadeForJVM.createContextWithSealedModule(TopDownAnalyzerFacadeForJVM.java:163)\n    at org.jetbrains.kotlin.cli.jvm.compiler.KotlinToJVMBytecodeCompiler$analyze$1.analyze(KotlinToJVMBytecodeCompiler.kt:322)\n    at org.jetbrains.kotlin.cli.common.messages.AnalyzerWithCompilerReport.analyzeAndReport(AnalyzerWithCompilerReport.kt:129)\n    at org.jetbrains.kotlin.cli.jvm.compiler.KotlinToJVMBytecodeCompiler.analyze(KotlinToJVMBytecodeCompiler.kt:318)\n    at org.jetbrains.kotlin.cli.jvm.compiler.KotlinToJVMBytecodeCompiler.compileModules(KotlinToJVMBytecodeCompiler.kt:124)\n    at org.jetbrains.kotlin.cli.jvm.K2JVMCompiler.doExecute(K2JVMCompiler.kt:173)\n    at org.jetbrains.kotlin.cli.jvm.K2JVMCompiler.doExecute(K2JVMCompiler.kt:49)\n    at org.jetbrains.kotlin.cli.common.CLICompiler.exec(CLICompiler.java:220)\n    at org.jetbrains.kotlin.gradle.tasks.KotlinCompile.compileNotIncremental(Tasks.kt:497)\n    at org.jetbrains.kotlin.gradle.tasks.KotlinCompile.callCompiler(Tasks.kt:370)\n    at org.jetbrains.kotlin.gradle.tasks.KotlinCompile.callCompiler(Tasks.kt:149)\n    at org.jetbrains.kotlin.gradle.tasks.AbstractKotlinCompile.execute(Tasks.kt:110)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:498)\n    at org.gradle.internal.reflect.JavaMethod.invoke(JavaMethod.java:75)\n    at org.gradle.api.internal.project.taskfactory.AnnotationProcessingTaskFactory$IncrementalTaskAction.doExecute(AnnotationProcessingTaskFactory.java:245)\n    at org.gradle.api.internal.project.taskfactory.AnnotationProcessingTaskFactory$StandardTaskAction.execute(AnnotationProcessingTaskFactory.java:221)\n    at org.gradle.api.internal.project.taskfactory.AnnotationProcessingTaskFactory$IncrementalTaskAction.execute(AnnotationProcessingTaskFactory.java:232)\n    at org.gradle.api.internal.project.taskfactory.AnnotationProcessingTaskFactory$StandardTaskAction.execute(AnnotationProcessingTaskFactory.java:210)\n    at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeAction(ExecuteActionsTaskExecuter.java:80)\n    at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeActions(ExecuteActionsTaskExecuter.java:61)\n    at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.execute(ExecuteActionsTaskExecuter.java:46)\n    at org.gradle.api.internal.tasks.execution.PostExecutionAnalysisTaskExecuter.execute(PostExecutionAnalysisTaskExecuter.java:35)\n    at org.gradle.api.internal.tasks.execution.SkipUpToDateTaskExecuter.execute(SkipUpToDateTaskExecuter.java:68)\n    at org.gradle.api.internal.tasks.execution.ValidatingTaskExecuter.execute(ValidatingTaskExecuter.java:58)\n    at org.gradle.api.internal.tasks.execution.SkipEmptySourceFilesTaskExecuter.execute(SkipEmptySourceFilesTaskExecuter.java:52)\n    at org.gradle.api.internal.tasks.execution.SkipTaskWithNoActionsExecuter.execute(SkipTaskWithNoActionsExecuter.java:52)\n    at org.gradle.api.internal.tasks.execution.SkipOnlyIfTaskExecuter.execute(SkipOnlyIfTaskExecuter.java:53)\n    at org.gradle.api.internal.tasks.execution.ExecuteAtMostOnceTaskExecuter.execute(ExecuteAtMostOnceTaskExecuter.java:43)\n    at org.gradle.execution.taskgraph.DefaultTaskGraphExecuter$EventFiringTaskWorker.execute(DefaultTaskGraphExecuter.java:203)\n    at org.gradle.execution.taskgraph.DefaultTaskGraphExecuter$EventFiringTaskWorker.execute(DefaultTaskGraphExecuter.java:185)\n    at org.gradle.execution.taskgraph.AbstractTaskPlanExecutor$TaskExecutorWorker.processTask(AbstractTaskPlanExecutor.java:66)\n    at org.gradle.execution.taskgraph.AbstractTaskPlanExecutor$TaskExecutorWorker.run(AbstractTaskPlanExecutor.java:50)\n    at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:54)\n    at org.gradle.internal.concurrent.StoppableExecutorImpl$1.run(StoppableExecutorImpl.java:40)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n    at java.lang.Thread.run(Thread.java:745)\n</code></pre>\n"}, {"tags": ["android", "android-studio", "intellij-idea", "kotlin"], "comments": [{"owner": {"reputation": 927, "user_id": 2015751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29d0313be56df012c70064c768046964?s=128&d=identicon&r=PG", "display_name": "daemontus", "link": "https://stackoverflow.com/users/2015751/daemontus"}, "edited": false, "score": 0, "creation_date": 1473978874, "post_id": 37405782, "comment_id": 66358399, "body": "By any chance do you get an ArrayIndexOutOfBoundsException in the test output?"}], "answers": [{"comments": [{"owner": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "edited": false, "score": 1, "creation_date": 1496751588, "post_id": 44389767, "comment_id": 75779249, "body": "There is no reason that the coverage of others would be all counted as zero, when inline is used. JaCoco is okay, so the above doesn&#39;t explain at all."}], "tags": [], "owner": {"reputation": 1439, "user_id": 108034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8500c09e0cb583959da82df41ccb6a56?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/108034/mark"}, "is_accepted": false, "score": 3, "last_activity_date": 1496751372, "creation_date": 1496751372, "answer_id": 44389767, "question_id": 37405782, "link": "https://stackoverflow.com/questions/37405782/kotlin-inline-keyword-causing-intellij-idea-coverage-reporting-0/44389767#44389767", "title": "Kotlin inline keyword causing IntelliJ IDEA Coverage reporting 0%", "body": "<p>When an inlined function is compiled, the compiler essentially pastes its body into the call site (in place of the function call).  This means that the coverage analysis can't tell that it's an inlined function because it doesn't really exist where you defined it.  In other words, this behavior is a natural artifact of what it means for a function to be inlined.</p>\n"}], "owner": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1427, "favorite_count": 1, "answer_count": 1, "score": 14, "last_activity_date": 1496751372, "creation_date": 1464070744, "last_edit_date": 1464071629, "question_id": 37405782, "link": "https://stackoverflow.com/questions/37405782/kotlin-inline-keyword-causing-intellij-idea-coverage-reporting-0", "title": "Kotlin inline keyword causing IntelliJ IDEA Coverage reporting 0%", "body": "<p>I created a very simple test function as below</p>\n\n<pre><code>class SimpleClassTest {\n\n    lateinit var simpleObject: SimpleClass\n    @Mock lateinit var injectedObject: InjectedClass\n\n\n    @Before\n    fun setUp() {\n        MockitoAnnotations.initMocks(this)\n    }\n\n    @Test\n    fun testSimpleFunction() {\n        simpleObject = lookupInstance()\n    }\n\n    inline fun lookupInstance() = SimpleClass(injectedObject)\n}\n</code></pre>\n\n<p>I Run it with Coverage... The test coverage number is 0%. But if I remove the <code>inline</code> keyword, the test coverage number shows now.</p>\n\n<p>Is this a Kotlin issue or Android IntelliJ IDEA Coverage issue? (note: JaCoco coverage is good).</p>\n\n<p>Note: I'm using Android Studio 2.0 and Kotlin 1.0.2</p>\n"}, {"tags": ["mockito", "kotlin"], "comments": [{"owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "edited": false, "score": 1, "creation_date": 1464046553, "post_id": 37402113, "comment_id": 62312719, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/37375142/kotlin-manually-inlining-a-generic-function-produce-a-different-result\">Kotlin: Manually inlining a generic function produce a different result?</a>"}, {"owner": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "reply_to_user": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "edited": false, "score": 0, "creation_date": 1464047356, "post_id": 37402113, "comment_id": 62312911, "body": "@llya, it&#39;s not a duplicate. The <a href=\"http://stackoverflow.com/questions/37375142/kotlin-manually-inlining-a-generic-function-produce-a-different-result\" title=\"kotlin manually inlining a generic function produce a different result\">stackoverflow.com/questions/37375142/&hellip;</a> provides the why, but I can&#39;t get to how to manually inline it properly. So this is a follow up separate question."}, {"owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "edited": false, "score": 0, "creation_date": 1464048149, "post_id": 37402113, "comment_id": 62313086, "body": "You end up with the same code and it doesn&#39;t work for the same reason."}, {"owner": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "reply_to_user": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "edited": false, "score": 0, "creation_date": 1464048248, "post_id": 37402113, "comment_id": 62313105, "body": "Is there&#39;s no way of writing it without the inline function?"}, {"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "edited": false, "score": 0, "creation_date": 1464067878, "post_id": 37402113, "comment_id": 62317902, "body": "@Elye The tests with <code>fun &lt;reified T: Any&gt; anyObject()</code> in the question is failing with the very same reason as your later example."}, {"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "edited": false, "score": 0, "creation_date": 1464068535, "post_id": 37402113, "comment_id": 62318127, "body": "@Elye You don&#39;t have to use an inline function it can be a regular function i.e. <code>fun &lt;T&gt; anyObject(): T { return Mockito.anyObject&lt;T&gt;() }</code>. <a href=\"https://youtrack.jetbrains.com/issue/KT-8135\" rel=\"nofollow noreferrer\">This ticket</a> desribes the questionable behavior."}, {"owner": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "edited": false, "score": 0, "creation_date": 1464070518, "post_id": 37402113, "comment_id": 62318980, "body": "Sorry, I guess I didn&#39;t put my question clear. I want to remove not just the inline, but the entire anyObject() function I made... so I could use Mockito.anyObject directly for my <code>settingDependentObject</code> function. Is that possible I could use Mockitoy.anyObject() directly, without having the <code>must not be null</code> error message?"}, {"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "edited": false, "score": 1, "creation_date": 1464071703, "post_id": 37402113, "comment_id": 62319579, "body": "@Elye As mentioned in <a href=\"http://stackoverflow.com/a/37377126/155213\">the linked answer</a> it&#39;s not possible to <i>inline it manually</i> due to issue described in <a href=\"https://youtrack.jetbrains.com/issue/KT-8135\" rel=\"nofollow noreferrer\">this ticket</a>. You can ease your pain with <a href=\"https://github.com/nhaarman/mockito-kotlin\" rel=\"nofollow noreferrer\">the library</a>."}, {"owner": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "edited": false, "score": 0, "creation_date": 1464073705, "post_id": 37402113, "comment_id": 62320652, "body": "Thanks Miensol. That explains all!. I can&#39;t use that library fully due to two issues reported in <a href=\"http://stackoverflow.com/questions/37380830/java-lang-reflect-invocationtargetexception-when-using-kotlin-mokito-library\" title=\"java lang reflect invocationtargetexception when using kotlin mokito library\">stackoverflow.com/questions/37380830/&hellip;</a> and <a href=\"http://stackoverflow.com/questions/37403085/after-adding-mockito-kotlin-library-i-loose-my-coverage-data-of-android-studio\" title=\"after adding mockito kotlin library i loose my coverage data of android studio\">stackoverflow.com/questions/37403085/&hellip;</a>. I do have workaround though, but just thought of getting my mind clear on what&#39;s happening with all these. Thanks!!"}], "owner": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 623, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464047293, "creation_date": 1464046201, "last_edit_date": 1495542240, "question_id": 37402113, "link": "https://stackoverflow.com/questions/37402113/how-to-manually-inline-kotlin-fun-with-reified-t-any", "title": "How to manually inline Kotlin fun with &lt;reified T: Any&gt;", "body": "<p>I have a passing test below that uses an inline fun.</p>\n\n<pre><code>class SimpleClassTest {\n\n    private inline fun &lt;reified T: Any&gt; anyObject(): T {\n        return Mockito.anyObject&lt;T&gt;()\n    }\n\n    lateinit var simpleObject: SimpleClass\n    @Mock lateinit var injectedObject: InjectedClass\n\n\n    @Before\n    fun setUp() {\n        MockitoAnnotations.initMocks(this)\n    }\n\n    @Test\n    fun testSimpleFunction() {\n        simpleObject = SimpleClass(injectedObject)\n        simpleObject.simpleFunction()\n\n        verify(injectedObject).settingDependentObject(anyObject())\n    }\n}\n</code></pre>\n\n<p>But now I want to remove the inline fun as there's only one usage of it. So I replace the T with the actual class name i.e. Response (from Okhttp), and set it directly as a parameter in <code>settingDependentObject</code></p>\n\n<pre><code>class SimpleClassTest {\n\n    lateinit var simpleObject: SimpleClass\n    @Mock lateinit var injectedObject: InjectedClass\n\n\n    @Before\n    fun setUp() {\n        MockitoAnnotations.initMocks(this)\n    }\n\n    @Test\n    fun testSimpleFunction() {\n        simpleObject = SimpleClass(injectedObject)\n        simpleObject.simpleFunction()\n\n        verify(injectedObject).settingDependentObject(Mockito.anyObject&lt;Response&gt;())\n    }\n}\n</code></pre>\n\n<p>It will fail with</p>\n\n<pre><code>java.lang.IllegalStateException: Mockito.anyObject&lt;Response&gt;() must not be null\n</code></pre>\n\n<p>How could I manually inline it correctly and behave the same as when I have the <code>private inline fun &lt;reified T: Any&gt; anyObject(): T</code>?</p>\n\n<p><strong>Updated</strong>\nNote: this is a follow up question of <a href=\"https://stackoverflow.com/questions/37375142/kotlin-manually-inlining-a-generic-function-produce-a-different-result\">Kotlin: Manually inlining a generic function produce a different result?</a>. The previous provide the why, but I can't get to how to manually inline it properly. </p>\n"}, {"tags": ["kotlin", "named-parameters"], "comments": [{"owner": {"reputation": 25726, "user_id": 453435, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/SjPwA.jpg?s=128&g=1", "display_name": "Ben Leggiero", "link": "https://stackoverflow.com/users/453435/ben-leggiero"}, "edited": false, "score": 2, "creation_date": 1513454433, "post_id": 37394266, "comment_id": 82663337, "body": "Relevant Kotlin bug: <a href=\"https://youtrack.jetbrains.com/issue/KT-14934\" rel=\"nofollow noreferrer\">youtrack.jetbrains.com/issue/KT-14934</a>"}], "answers": [{"comments": [{"owner": {"reputation": 20424, "user_id": 445715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3824489df267d3bf86bbc678b9745ac4?s=128&d=identicon&r=PG", "display_name": "Andrey Breslav", "link": "https://stackoverflow.com/users/445715/andrey-breslav"}, "edited": false, "score": 23, "creation_date": 1464024720, "post_id": 37394267, "comment_id": 62302816, "body": "While this was never intended by the design of the language, I applaud your ingenuity :)"}, {"owner": {"reputation": 95, "user_id": 3396646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98b596e59d7cc64f986a0c057925b544?s=128&d=identicon&r=PG&f=1", "display_name": "Deanveloper", "link": "https://stackoverflow.com/users/3396646/deanveloper"}, "edited": false, "score": 0, "creation_date": 1466026195, "post_id": 37394267, "comment_id": 63152468, "body": "You can spread an array of Nothing with *arrayOf&lt;Nothing&gt;(). Or you should be able to, I think"}, {"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "reply_to_user": {"reputation": 95, "user_id": 3396646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98b596e59d7cc64f986a0c057925b544?s=128&d=identicon&r=PG&f=1", "display_name": "Deanveloper", "link": "https://stackoverflow.com/users/3396646/deanveloper"}, "edited": false, "score": 0, "creation_date": 1466028630, "post_id": 37394267, "comment_id": 63153405, "body": "@Deanveloper I just tried it out. I get: &quot;Unsuppored [Array&lt;Nothing&gt; in return type is illegal&quot; and &quot;Cannot use &#39;Nothing&#39; as reified type parameter&quot;. Even if you could, the subsequent arguments in, for example, <code>f0(*arrayOf&lt;Nothing&gt;(), 0, 1, 2)</code> are combined with the contents of the spread array which causes a different error: &quot;The integer literal does not conform to the expected type Nothing&quot;."}, {"owner": {"reputation": 8164, "user_id": 5593959, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/9StDn.jpg?s=128&g=1", "display_name": "Dima Rostopira", "link": "https://stackoverflow.com/users/5593959/dima-rostopira"}, "edited": false, "score": 0, "creation_date": 1599231856, "post_id": 37394267, "comment_id": 112719914, "body": "Not working in Kotlin <code>1.3.72</code>, says Nothing is forbidden type for vararg"}, {"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "reply_to_user": {"reputation": 8164, "user_id": 5593959, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/9StDn.jpg?s=128&g=1", "display_name": "Dima Rostopira", "link": "https://stackoverflow.com/users/5593959/dima-rostopira"}, "edited": false, "score": 0, "creation_date": 1599234867, "post_id": 37394267, "comment_id": 112721348, "body": "@DimaRostopira see note about 1.1+, I&#39;ve moved it up in the answer to clarify, you&#39;ll need to create your own version of <code>Nothing</code> (and you can call it whatever you&#39;d like, e.g. <code>Forbidden</code>)"}, {"owner": {"reputation": 8164, "user_id": 5593959, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/9StDn.jpg?s=128&g=1", "display_name": "Dima Rostopira", "link": "https://stackoverflow.com/users/5593959/dima-rostopira"}, "edited": false, "score": 0, "creation_date": 1599237810, "post_id": 37394267, "comment_id": 112722679, "body": "@mfulton26 missed it, sorry)"}], "tags": [], "owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "is_accepted": true, "score": 27, "last_activity_date": 1599234803, "last_edit_date": 1599234803, "creation_date": 1464015265, "answer_id": 37394267, "question_id": 37394266, "link": "https://stackoverflow.com/questions/37394266/how-can-i-force-calls-to-some-constructors-functions-to-use-named-arguments/37394267#37394267", "title": "How can I force calls to some constructors/functions to use named arguments?", "body": "<p>In Kotlin 1.0 you can do this by using <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-nothing.html\" rel=\"nofollow noreferrer\"><code>Nothing</code></a> from the stdlib.</p>\n<p>In Kotlin 1.1+ you will get &quot;Forbidden vararg parameter type: Nothing&quot; but you can replicate this pattern by defining your own empty class with a private constructor (like <code>Nothing</code>), and using that as the first varargs parameter.</p>\n<pre><code>/* requires passing all arguments by name */\nfun f0(vararg nothings: Nothing, arg0: Int, arg1: Int, arg2: Int) {}\nf0(arg0 = 0, arg1 = 1, arg2 = 2)    // compiles with named arguments\n//f0(0, 1, 2)                       // doesn't compile without each required named argument\n\n/* requires passing some arguments by name */\nfun f1(arg0: Int, vararg nothings: Nothing, arg1: Int, arg2: Int) {}\nf1(arg0 = 0, arg1 = 1, arg2 = 2)    // compiles with named arguments\nf1(0, arg1 = 1, arg2 = 2)           // compiles without optional named argument\n//f1(0, 1, arg2 = 2)                // doesn't compile without each required named argument\n</code></pre>\n<p>As <code>Array&lt;Nothing&gt;</code> is illegal in Kotlin, a value for <code>vararg nothings: Nothing</code> can't be created to be passed in (short of reflection I suppose). This seems a bit of a hack though and I suspect there is some overhead in the bytecode for the empty array of type <code>Nothing</code> but it appears to work.</p>\n<p>This approach does not work for data class primary constructors which cannot use <code>vararg</code> but these can be marked as <code>private</code> and secondary constructors can be used with <code>vararg nothings: Nothing</code>.</p>\n"}], "owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1773, "favorite_count": 4, "accepted_answer_id": 37394267, "answer_count": 1, "score": 25, "last_activity_date": 1599234803, "creation_date": 1464015265, "last_edit_date": 1464022275, "question_id": 37394266, "link": "https://stackoverflow.com/questions/37394266/how-can-i-force-calls-to-some-constructors-functions-to-use-named-arguments", "title": "How can I force calls to some constructors/functions to use named arguments?", "body": "<p>I have some constructors and functions that I'd like to always be called with named arguments. Is there a way to require this?</p>\n\n<p>I'd like to be able to do this for constructors and functions with many parameters and for those that read more clearly when named arguments are used, etc.</p>\n"}, {"tags": ["generics", "guice", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 5111, "user_id": 785663, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b32f09978c0b55f375b81e9179dc568?s=128&d=identicon&r=PG", "display_name": "mabi", "link": "https://stackoverflow.com/users/785663/mabi"}, "edited": false, "score": 0, "creation_date": 1464024727, "post_id": 37393727, "comment_id": 62302821, "body": "I know this isn&#39;t part of the question, but would you know why this mapping won&#39;t be available in one of the same module&#39;s <code>@Provides</code> methods? Otherwise, works as advertised, accepting."}], "tags": [], "owner": {"reputation": 3685, "user_id": 278897, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2d136f656bfb9290913ff85abbeccfd7?s=128&d=identicon&r=PG", "display_name": "Paul Blessing", "link": "https://stackoverflow.com/users/278897/paul-blessing"}, "is_accepted": true, "score": 2, "last_activity_date": 1464013733, "last_edit_date": 1495540378, "creation_date": 1464013733, "answer_id": 37393727, "question_id": 37393364, "link": "https://stackoverflow.com/questions/37393364/using-in-generics-in-multibinder/37393727#37393727", "title": "Using in Generics in Multibinder", "body": "<p>Use a <code>TypeLiteral</code> rather than a class literal to inject a class with a generic type (<a href=\"https://github.com/google/guice/wiki/FrequentlyAskedQuestions#how-to-inject-class-with-generic-type\" rel=\"nofollow noreferrer\">https://github.com/google/guice/wiki/FrequentlyAskedQuestions#how-to-inject-class-with-generic-type</a>). See <a href=\"https://stackoverflow.com/questions/14519722/multibinding-with-generics\">Multibinding with generics</a> for a Java example. Below is the equivalent Kotlin example.</p>\n\n<pre><code>val parsers = Multibinder.newSetBinder(binder(), object : TypeLiteral&lt;MessageParser&lt;Mime, Parsed&gt;&gt;() {})\n</code></pre>\n"}], "owner": {"reputation": 5111, "user_id": 785663, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b32f09978c0b55f375b81e9179dc568?s=128&d=identicon&r=PG", "display_name": "mabi", "link": "https://stackoverflow.com/users/785663/mabi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 694, "favorite_count": 0, "accepted_answer_id": 37393727, "answer_count": 1, "score": 1, "last_activity_date": 1464014644, "creation_date": 1464012689, "last_edit_date": 1464014644, "question_id": 37393364, "link": "https://stackoverflow.com/questions/37393364/using-in-generics-in-multibinder", "title": "Using in Generics in Multibinder", "body": "<p>I'm a bit confused on generics when using <code>com.google.inject.multibindings.Multibinder</code> as below:</p>\n\n<pre><code>interface MessageParser&lt;S, T&gt; {\n  fun accept(msg: S): Boolean\n  fun parser(msg: S): T\n}\nclass Parser1 : MessageParser&lt;Mime, Parsed&gt;\nclass Parser2 : MessageParser&lt;Mime, Parsed&gt;\n\nclass EmailModule : AbstractModule() {\n  override fun configure() {\n      val parsers = Multibinder.newSetBinder(binder(), MessageParser::class.java)\n      parsers.addBinding().to(Parser1::class.java)\n      parsers.addBinding().to(Parser2::class.java)\n  }\n}\n</code></pre>\n\n<p>This works, but loses all generics information. Is it possible to restrict this to a specific subset of parsers, ie do</p>\n\n<pre><code>val parsers: MessageParser&lt;Mime, Parsed&gt; =\n  Multibinder.newSetBinder(binder(), MessageParser&lt;Mime, Parsed&gt;::class.java)\n</code></pre>\n\n<p>Right now, this generates a compiler error:</p>\n\n<blockquote>\n  <p>Only classes are allowed on the left hand side of a class literal</p>\n</blockquote>\n"}, {"tags": ["android", "unit-testing", "android-studio", "testing", "kotlin"], "answers": [{"tags": [], "owner": {"reputation": 2100, "user_id": 2011622, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/96840d39824f44b6f5802210acb65dd9?s=128&d=identicon&r=PG", "display_name": "Peter F", "link": "https://stackoverflow.com/users/2011622/peter-f"}, "is_accepted": true, "score": 2, "last_activity_date": 1464015662, "creation_date": 1464015662, "answer_id": 37394394, "question_id": 37392478, "link": "https://stackoverflow.com/questions/37392478/running-spek-test-shows-error-empty-test-suite/37394394#37394394", "title": "Running Spek test shows error &quot;Empty test suite&quot;", "body": "<p>My failure was that I did not fully/properly configure Kotlin.</p>\n\n<p>I missed to apply the Kotlin plugin, which is done with these lines:</p>\n\n<pre><code>apply plugin: 'kotlin-android'\n\nbuildscript {\n    ext.kotlin_version = '1.0.2'\n    repositories {\n        jcenter()\n    }\n\n    dependencies {\n        classpath \"org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version\"\n    }\n</code></pre>\n\n<p>This is also a requirement if you want to use Kotlin code in plain JUnit tests.</p>\n"}], "owner": {"reputation": 2100, "user_id": 2011622, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/96840d39824f44b6f5802210acb65dd9?s=128&d=identicon&r=PG", "display_name": "Peter F", "link": "https://stackoverflow.com/users/2011622/peter-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1299, "favorite_count": 0, "accepted_answer_id": 37394394, "answer_count": 1, "score": 2, "last_activity_date": 1464015662, "creation_date": 1464010476, "last_edit_date": 1464010958, "question_id": 37392478, "link": "https://stackoverflow.com/questions/37392478/running-spek-test-shows-error-empty-test-suite", "title": "Running Spek test shows error &quot;Empty test suite&quot;", "body": "<p>Gotten familiar a bit with Kotlin I wanted to introduce it another Android-Java project, as a first step for testing only. I decided to start straight with <a href=\"https://jetbrains.github.io/spek/\" rel=\"nofollow\">Spek</a>.</p>\n\n<p>I added the following dependencies to build.gradle of the module to be tested:</p>\n\n<pre><code>testCompile 'junit:junit:4.12'\ntestCompile \"org.jetbrains.kotlin:kotlin-stdlib:1.0.2\"\ntestCompile \"org.jetbrains.kotlin:kotlin-test-junit:1.0.2\"\ntestCompile \"org.jetbrains.spek:spek:1.0.25\"\n</code></pre>\n\n<p>Among others I used the <a href=\"https://github.com/JetBrains/spek/blob/master/spek-samples/src/main/kotlin/org/jetbrains/spek/samples/SimpleTest.kt\" rel=\"nofollow\">SimpleTest</a> class of spek-samples of the git repo:</p>\n\n<pre><code>import org.jetbrains.spek.api.Spek\nimport kotlin.test.assertEquals\n\n\nclass SampleCalculator\n{\n    fun sum(x: Int, y: Int) = x + y\n    fun subtract(x: Int, y: Int) = x - y\n}\n\nclass SimpleTest : Spek({\n    describe(\"a calculator\") {\n        val calculator = SampleCalculator()\n\n        it(\"should return the result of adding the first number to the second number\") {\n            val sum = calculator.sum(2, 4)\n            assertEquals(6, sum)\n        }\n\n        it(\"should return the result of subtracting the second number from the first number\") {\n            val subtract = calculator.subtract(4, 2)\n            assertEquals(2, subtract)\n        }\n    }\n})\n</code></pre>\n\n<p>The code compiles and in Android Studio I am shown a green play button next to the class declaration to run the tests of the class. However, doing so results in </p>\n\n<pre><code>Process finished with exit code 1\nClass not found: \"com.anfema.ionclient.serialization.SimpleTest\"Empty test suite.\n</code></pre>\n\n<p>I created JUnit3 and JUnit4 tests of which all ran without any problems.</p>\n\n<p>Did I miss any additional configuration step for Spek tests?</p>\n"}, {"tags": ["android", "singleton", "kotlin"], "comments": [{"owner": {"reputation": 2666, "user_id": 4469112, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j9rSU.jpg?s=128&g=1", "display_name": "Alessio", "link": "https://stackoverflow.com/users/4469112/alessio"}, "edited": false, "score": 0, "creation_date": 1563805208, "post_id": 37391221, "comment_id": 100811434, "body": "please don&#39;t access the context statically, it&#39;s very bad and it could create problems later on. Instead context in Android should be accessed <a href=\"https://www.fwd.cloud/commit/post/android-context-on-demand/\" rel=\"nofollow noreferrer\">on demand</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "edited": false, "score": 0, "creation_date": 1464010745, "post_id": 37391717, "comment_id": 62294129, "body": "ya i always knew about that solution but was hoping there was another way. Thanks man"}, {"owner": {"reputation": 1286, "user_id": 4229910, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6febfae3298d5aeebe98b657d4f4aa7d?s=128&d=identicon&r=PG&f=1", "display_name": "ashwin mahajan", "link": "https://stackoverflow.com/users/4229910/ashwin-mahajan"}, "edited": false, "score": 0, "creation_date": 1548975207, "post_id": 37391717, "comment_id": 95748657, "body": "Can you please clear my doubt? : If context is used as a static variable, then if the dependent class holds its reference, what will not be garbage collected : Application object or the context variable? And if we use DI, then the context is passed to the dependent class, now if that holds the reference, then will the object will be garbage collected? Two chained questions, I hope its clear. Thanks!"}, {"owner": {"reputation": 50303, "user_id": 170842, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/c2ea72b8d001d81fb6ce3f356e45eb3a?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/170842/michael"}, "edited": false, "score": 0, "creation_date": 1549001346, "post_id": 37391717, "comment_id": 95755123, "body": "Actually <code>Application</code> is <code>Context</code> and it won&#39;t be gc&#39;ed while the application is running."}], "tags": [], "owner": {"reputation": 50303, "user_id": 170842, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/c2ea72b8d001d81fb6ce3f356e45eb3a?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/170842/michael"}, "is_accepted": false, "score": 3, "last_activity_date": 1464008453, "creation_date": 1464008453, "answer_id": 37391717, "question_id": 37391221, "link": "https://stackoverflow.com/questions/37391221/kotlin-singleton-application-class/37391717#37391717", "title": "Kotlin Singleton Application Class", "body": "<p>You cannot do that because Android creates an <code>Application</code> instance using its parameterless constructor.</p>\n\n<p>The problem you want to solve can be easily solved with DI. Just create instances with an injector so that the <code>Context</code> can be injected into objects as a dependency.</p>\n"}, {"comments": [{"owner": {"reputation": 15590, "user_id": 6478047, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Rd7gY.jpg?s=128&g=1", "display_name": "Manohar Reddy", "link": "https://stackoverflow.com/users/6478047/manohar-reddy"}, "edited": false, "score": 5, "creation_date": 1529991929, "post_id": 37412029, "comment_id": 89063013, "body": "Whats the use of <code>private set</code> at bottom ?"}, {"owner": {"reputation": 999, "user_id": 645092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a1e87e6da8409a37fa20f9d714655792?s=128&d=identicon&r=PG", "display_name": "letroll", "link": "https://stackoverflow.com/users/645092/letroll"}, "reply_to_user": {"reputation": 15590, "user_id": 6478047, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Rd7gY.jpg?s=128&g=1", "display_name": "Manohar Reddy", "link": "https://stackoverflow.com/users/6478047/manohar-reddy"}, "edited": false, "score": 3, "creation_date": 1535012682, "post_id": 37412029, "comment_id": 90912350, "body": "@Redman because we want only MyApp can set the instance value"}, {"owner": {"reputation": 709, "user_id": 4588241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UvFMZ.jpg?s=128&g=1", "display_name": "Shlomi Fresko", "link": "https://stackoverflow.com/users/4588241/shlomi-fresko"}, "edited": false, "score": 3, "creation_date": 1549620365, "post_id": 37412029, "comment_id": 95976342, "body": "It gives &quot;lateinit property instance has not been initialized&quot; Error"}, {"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "reply_to_user": {"reputation": 709, "user_id": 4588241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UvFMZ.jpg?s=128&g=1", "display_name": "Shlomi Fresko", "link": "https://stackoverflow.com/users/4588241/shlomi-fresko"}, "edited": false, "score": 0, "creation_date": 1549710419, "post_id": 37412029, "comment_id": 96006445, "body": "@ShlomiFresko then you&#39;re accessing it before <code>onCreate</code> was called."}, {"owner": {"reputation": 5072, "user_id": 3558145, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JvUM3.png?s=128&g=1", "display_name": "Shaishav", "link": "https://stackoverflow.com/users/3558145/shaishav"}, "edited": false, "score": 0, "creation_date": 1559047882, "post_id": 37412029, "comment_id": 99290356, "body": "Won&#39;t this create a new object and now you have two Application objects in memory although you only need one?"}, {"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "reply_to_user": {"reputation": 5072, "user_id": 3558145, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JvUM3.png?s=128&g=1", "display_name": "Shaishav", "link": "https://stackoverflow.com/users/3558145/shaishav"}, "edited": false, "score": 0, "creation_date": 1559052960, "post_id": 37412029, "comment_id": 99293424, "body": "@Shaishav no, you&#39;re only assigning the reference to the same object to a property."}, {"owner": {"reputation": 5072, "user_id": 3558145, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JvUM3.png?s=128&g=1", "display_name": "Shaishav", "link": "https://stackoverflow.com/users/3558145/shaishav"}, "edited": false, "score": 1, "creation_date": 1559108629, "post_id": 37412029, "comment_id": 99311776, "body": "@KirillRakhman one object will be created by the system at app launch and the other object will be due to <code>companion object</code>. One may hold reference to other if needed, as above but, both will have to survive as long as the app stays alive. Is this inference incorrect?"}, {"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "reply_to_user": {"reputation": 5072, "user_id": 3558145, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JvUM3.png?s=128&g=1", "display_name": "Shaishav", "link": "https://stackoverflow.com/users/3558145/shaishav"}, "edited": false, "score": 1, "creation_date": 1559203840, "post_id": 37412029, "comment_id": 99350016, "body": "@Shaishav The companion object is of a different type than the outer class, you can look up in the bytecode. You will have one instance of the <code>MyApp</code> class and one insance of <code>MyApp$Companion</code> holding a reference to the <code>MyApp</code> instance. Try it out here: <a href=\"https://pl.kotl.in/Wm_sTSSQo\" rel=\"nofollow noreferrer\">pl.kotl.in/Wm_sTSSQo</a>"}, {"owner": {"reputation": 5072, "user_id": 3558145, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JvUM3.png?s=128&g=1", "display_name": "Shaishav", "link": "https://stackoverflow.com/users/3558145/shaishav"}, "edited": false, "score": 0, "creation_date": 1559208556, "post_id": 37412029, "comment_id": 99352069, "body": "@KirillRakhman thanks, the example really helped. Also, the decompiled bytecode showed a different inner class as you suggested."}, {"owner": {"reputation": 6424, "user_id": 444761, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/MjkEi.jpg?s=128&g=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/444761/mark"}, "edited": false, "score": 0, "creation_date": 1580824352, "post_id": 37412029, "comment_id": 106218871, "body": "How about also including <code>@Volatile</code> (before <code>lateinit</code>) as explained here: <a href=\"https://stackoverflow.com/questions/106591/what-is-the-volatile-keyword-useful-for\" title=\"what is the volatile keyword useful for\">stackoverflow.com/questions/106591/&hellip;</a>"}, {"owner": {"reputation": 383, "user_id": 6798905, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8U69TiuDFUw/AAAAAAAAAAI/AAAAAAAAAA0/vEsJgiRXvs0/photo.jpg?sz=128", "display_name": "Dino Sunny", "link": "https://stackoverflow.com/users/6798905/dino-sunny"}, "reply_to_user": {"reputation": 15590, "user_id": 6478047, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Rd7gY.jpg?s=128&g=1", "display_name": "Manohar Reddy", "link": "https://stackoverflow.com/users/6478047/manohar-reddy"}, "edited": false, "score": 0, "creation_date": 1585722413, "post_id": 37412029, "comment_id": 107858155, "body": "The private set is used so that a value can\u2019t be assigned from an external class. @ManoharReddy"}, {"owner": {"reputation": 247, "user_id": 10823738, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dDIbTYkEl8A/AAAAAAAAAAI/AAAAAAAAAE8/zvqdhtKjnhU/photo.jpg?sz=128", "display_name": "Vivek Yadav", "link": "https://stackoverflow.com/users/10823738/vivek-yadav"}, "edited": false, "score": 0, "creation_date": 1588502979, "post_id": 37412029, "comment_id": 108915976, "body": "Since it&#39;s Kotlin, can&#39;t you declare the instance val as a top-level variable?"}, {"owner": {"reputation": 512, "user_id": 12357035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XT9DZ.png?s=128&g=1", "display_name": "Sourav Kannantha B", "link": "https://stackoverflow.com/users/12357035/sourav-kannantha-b"}, "reply_to_user": {"reputation": 247, "user_id": 10823738, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dDIbTYkEl8A/AAAAAAAAAAI/AAAAAAAAAE8/zvqdhtKjnhU/photo.jpg?sz=128", "display_name": "Vivek Yadav", "link": "https://stackoverflow.com/users/10823738/vivek-yadav"}, "edited": false, "score": 0, "creation_date": 1618315222, "post_id": 37412029, "comment_id": 118559460, "body": "@VivekYadav then you can&#39;t use <code>lateinit</code> modifier. Which means either you have to initialize at declaration (which is not possible here) or you have to declare its type as <code>MyApp?</code> which then has to be accessed everywhere as <code>instance!!</code> which is quite ugly."}], "tags": [], "owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "is_accepted": false, "score": 103, "last_activity_date": 1464088686, "creation_date": 1464088686, "answer_id": 37412029, "question_id": 37391221, "link": "https://stackoverflow.com/questions/37391221/kotlin-singleton-application-class/37412029#37412029", "title": "Kotlin Singleton Application Class", "body": "<p>You can do the same thing you would do in Java, i.e. put the <code>Application</code> instance in a static field. Kotlin doesn't have static fields, but properties in objects are statically accessible.</p>\n\n<pre><code>class MyApp: Application() {\n\n    override fun onCreate() {\n        super.onCreate()\n        instance = this\n    }\n\n    companion object {\n        lateinit var instance: MyApp\n            private set\n    }\n}\n</code></pre>\n\n<p>You can then access the property via <code>MyApp.instance</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1358, "user_id": 3295109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/13EDm.png?s=128&g=1", "display_name": "shredder", "link": "https://stackoverflow.com/users/3295109/shredder"}, "edited": false, "score": 2, "creation_date": 1510680900, "post_id": 37449710, "comment_id": 81534367, "body": "This looks good @nitrico, but i can&#39;t get the &#180;val Context.myApp: MyApp         get() = applicationContext as MyApp&#180; part to work. Could you go into a little more detail? Where this line needs to go and how to access it in another class?"}, {"owner": {"reputation": 1651, "user_id": 329999, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/b68480958b1c12b1d11da649adcaaf64?s=128&d=identicon&r=PG", "display_name": "Mitch", "link": "https://stackoverflow.com/users/329999/mitch"}, "edited": false, "score": 1, "creation_date": 1543482493, "post_id": 37449710, "comment_id": 93938167, "body": "&quot;get the the application context anywhere you have a context.&quot; - Can you explain why if I had a context I would need/want the application context? Seems like if I had a context of any kind, I would likely prefer to use that anyway. The use case where I want the application context is when I don&#39;t have a context otherwise, for example, a utility class that accesses a resource string. I&#39;m confused."}, {"owner": {"reputation": 680, "user_id": 1576415, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/453aa3dce0470f4690d5c0a2471b3756?s=128&d=identicon&r=PG", "display_name": "TheOnlyAnil", "link": "https://stackoverflow.com/users/1576415/theonlyanil"}, "edited": false, "score": 0, "creation_date": 1546612274, "post_id": 37449710, "comment_id": 94916683, "body": "Wasn&#39;t it simpler in JAVA?"}, {"owner": {"reputation": 5072, "user_id": 3558145, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JvUM3.png?s=128&g=1", "display_name": "Shaishav", "link": "https://stackoverflow.com/users/3558145/shaishav"}, "edited": false, "score": 0, "creation_date": 1559047642, "post_id": 37449710, "comment_id": 99290201, "body": "Won&#39;t this create a new object and now you have two Application objects in memory although you only need one?"}, {"owner": {"reputation": 1048, "user_id": 380119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c947f36ad980f922539deb7f4c37dc2b?s=128&d=identicon&r=PG", "display_name": "Pavel Lahoda", "link": "https://stackoverflow.com/users/380119/pavel-lahoda"}, "reply_to_user": {"reputation": 1651, "user_id": 329999, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/b68480958b1c12b1d11da649adcaaf64?s=128&d=identicon&r=PG", "display_name": "Mitch", "link": "https://stackoverflow.com/users/329999/mitch"}, "edited": false, "score": 0, "creation_date": 1587497869, "post_id": 37449710, "comment_id": 108534433, "body": "@Mitch &quot;Can you explain why if I had a context I would need/want the application context&quot; The difference is that you can introduce a memory leak to Activity context, if you keep reference of object created using its context when the Activity is no longer needed. If you keep that object (such as image resource) Activity is never GC&#39;d. Application exists during whole app lifespan, so there is no such leak happening. Application context should not be used for task like layout inflation etc. See <a href=\"https://medium.com/@banmarkovic/what-is-context-in-android-and-which-one-should-you-use-e1a8c6529652\" rel=\"nofollow noreferrer\">medium.com/@banmarkovic/&hellip;</a>"}], "tags": [], "owner": {"reputation": 533, "user_id": 4592776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0tYuMgwm-5A/AAAAAAAAAAI/AAAAAAAABIw/sTNNMDQB3D0/photo.jpg?sz=128", "display_name": "nitrico", "link": "https://stackoverflow.com/users/4592776/nitrico"}, "is_accepted": true, "score": 43, "last_activity_date": 1524201554, "last_edit_date": 1524201554, "creation_date": 1464222650, "answer_id": 37449710, "question_id": 37391221, "link": "https://stackoverflow.com/questions/37391221/kotlin-singleton-application-class/37449710#37449710", "title": "Kotlin Singleton Application Class", "body": "<p>If you want to <strong>use it to access some static properties</strong> you have there: You will only have one instance of your Application, so simply use the name you gave to the class. Don't worry about it not being an actual singleton, you can use it the same way.</p>\n\n<p>Example:</p>\n\n<pre><code>class MyApp : Application() {\n\n    companion object {\n        const val CONSTANT = 12\n        lateinit var typeface: Typeface\n    }\n\n    override fun onCreate() {\n        super.onCreate()\n        typeface = Typeface.createFromAsset(assets, \"fonts/myFont.ttf\")\n    }\n\n}\n</code></pre>\n\n<p>Then you can use <code>MyApp.CONSTANT</code> and <code>MyApp.typeface</code> anywhere in your app.</p>\n\n<p>-</p>\n\n<p>If what you want is <strong>to use it as an application context</strong> you can create an extension property for Context:</p>\n\n<pre><code>val Context.myApp: MyApp\n        get() = applicationContext as MyApp\n</code></pre>\n\n<p>Then you can use <code>myApp</code> to get the the application context anywhere you have a context.</p>\n"}, {"comments": [{"owner": {"reputation": 3454, "user_id": 237740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AS9RY.png?s=128&g=1", "display_name": "Fred Grott", "link": "https://stackoverflow.com/users/237740/fred-grott"}, "edited": false, "score": 1, "creation_date": 1535723303, "post_id": 49922850, "comment_id": 91184591, "body": "Thanks Raja Jawahar this is what I was looking for something concise and the best solution."}], "tags": [], "owner": {"reputation": 6526, "user_id": 4251124, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sjqGI.jpg?s=128&g=1", "display_name": "Raja Jawahar", "link": "https://stackoverflow.com/users/4251124/raja-jawahar"}, "is_accepted": false, "score": 14, "last_activity_date": 1541790405, "last_edit_date": 1541790405, "creation_date": 1524145943, "answer_id": 49922850, "question_id": 37391221, "link": "https://stackoverflow.com/questions/37391221/kotlin-singleton-application-class/49922850#49922850", "title": "Kotlin Singleton Application Class", "body": "<pre><code>    class AppController : Application() {\n\n        init {\n            instance = this\n        }\n\n        companion object {\n            private var instance: AppController? = null\n\n            fun applicationContext() : AppController {\n                return instance as AppController\n            }\n        }\n\n        override fun onCreate() {\n            super.onCreate()\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41157, "favorite_count": 11, "accepted_answer_id": 37449710, "answer_count": 4, "score": 43, "last_activity_date": 1588508473, "creation_date": 1464007035, "last_edit_date": 1536612015, "question_id": 37391221, "link": "https://stackoverflow.com/questions/37391221/kotlin-singleton-application-class", "title": "Kotlin Singleton Application Class", "body": "<p>So in android i want to make my application class a singleton.</p>\n\n<p>Making it like this: </p>\n\n<pre><code>object MyApplication: Application(){}\n</code></pre>\n\n<p>won't work. Following erros is thrown at runtime:</p>\n\n<pre><code>java.lang.IllegalAccessException: private com....is not accessible from class android.app.Instrumentation.\n</code></pre>\n\n<p>Doing this is also not possible:</p>\n\n<pre><code>class MyApp: Application() {\n\n    private val instance_: MyApp\n\n    init{\n        instance_ = this\n    }\n\n    override fun onCreate() {\n        super.onCreate()\n        if (BuildConfig.DEBUG) {\n            Timber.plant(Timber.DebugTree());\n        }\n    }\n\n    companion object{\n        fun getInstance() = instance_         \n    }\n}\n</code></pre>\n\n<p>So how can i get an instance of my application class everywhere in my app, would like to use <code>MyApp.instance()</code> instead of <code>(applicationContext as MyApp)</code>.</p>\n\n<p>Also an explanation why i want this: I have classes in my app, for example, a SharedPreference Singleton which is initialised with a context, and as its a singleton, can't have arguments.</p>\n"}, {"tags": ["dependency-injection", "kotlin"], "comments": [{"owner": {"reputation": 89682, "user_id": 675383, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e7a971eb341ffeaa3efca407239bf3b?s=128&d=identicon&r=PG", "display_name": "nhaarman", "link": "https://stackoverflow.com/users/675383/nhaarman"}, "edited": false, "score": 0, "creation_date": 1464001003, "post_id": 37388357, "comment_id": 62287615, "body": "Can&#39;t you use constructor injection?"}, {"owner": {"reputation": 2512, "user_id": 2992899, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Mu5w6.jpg?s=128&g=1", "display_name": "Czyzby", "link": "https://stackoverflow.com/users/2992899/czyzby"}, "reply_to_user": {"reputation": 89682, "user_id": 675383, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e7a971eb341ffeaa3efca407239bf3b?s=128&d=identicon&r=PG", "display_name": "nhaarman", "link": "https://stackoverflow.com/users/675383/nhaarman"}, "edited": false, "score": 0, "creation_date": 1464001252, "post_id": 37388357, "comment_id": 62287782, "body": "@nhaarman Not in case of circular dependencies. I specifically added the last paragraph to avoid suggestions how to make workarounds - I know that there are other ways of doing this. I simply asked if Kotlin provides a way of using this approach in a <i>nicer</i> way."}, {"owner": {"reputation": 89682, "user_id": 675383, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e7a971eb341ffeaa3efca407239bf3b?s=128&d=identicon&r=PG", "display_name": "nhaarman", "link": "https://stackoverflow.com/users/675383/nhaarman"}, "edited": false, "score": 1, "creation_date": 1464001323, "post_id": 37388357, "comment_id": 62287827, "body": "Constructor injection is not a workaround. Field injection is a workaround for when constructor injection is not possible."}, {"owner": {"reputation": 2512, "user_id": 2992899, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Mu5w6.jpg?s=128&g=1", "display_name": "Czyzby", "link": "https://stackoverflow.com/users/2992899/czyzby"}, "reply_to_user": {"reputation": 89682, "user_id": 675383, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e7a971eb341ffeaa3efca407239bf3b?s=128&d=identicon&r=PG", "display_name": "nhaarman", "link": "https://stackoverflow.com/users/675383/nhaarman"}, "edited": false, "score": 0, "creation_date": 1464003390, "post_id": 37388357, "comment_id": 62289202, "body": "Still, there are valid use cases of field injection, so it would be nice if Kotlin featured pleasant syntax for such situations."}], "answers": [{"comments": [{"owner": {"reputation": 2512, "user_id": 2992899, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Mu5w6.jpg?s=128&g=1", "display_name": "Czyzby", "link": "https://stackoverflow.com/users/2992899/czyzby"}, "edited": false, "score": 0, "creation_date": 1464000449, "post_id": 37388831, "comment_id": 62287307, "body": "Still more verbose than Java, but I like it - certainly better than our approaches. I&#39;d like to wait for more answers before accepting though (while I doubt it, maybe there&#39;s a less verbose way). I think you could even go with <code>@Inject private val someService = uinitialized&lt;SomeService&gt;()</code>, which is more Kotlin-ish."}, {"owner": {"reputation": 89682, "user_id": 675383, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e7a971eb341ffeaa3efca407239bf3b?s=128&d=identicon&r=PG", "display_name": "nhaarman", "link": "https://stackoverflow.com/users/675383/nhaarman"}, "edited": false, "score": 0, "creation_date": 1464001087, "post_id": 37388831, "comment_id": 62287673, "body": "This is not guaranteed to keep working: <a href=\"https://youtrack.jetbrains.com/issue/KT-8135\" rel=\"nofollow noreferrer\">youtrack.jetbrains.com/issue/KT-8135</a>"}, {"owner": {"reputation": 50303, "user_id": 170842, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/c2ea72b8d001d81fb6ce3f356e45eb3a?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/170842/michael"}, "reply_to_user": {"reputation": 89682, "user_id": 675383, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e7a971eb341ffeaa3efca407239bf3b?s=128&d=identicon&r=PG", "display_name": "nhaarman", "link": "https://stackoverflow.com/users/675383/nhaarman"}, "edited": false, "score": 0, "creation_date": 1464002274, "post_id": 37388831, "comment_id": 62288462, "body": "@nhaarman Sure, that&#39;s why I don&#39;t like it. But I hope JB isn&#39;t going to deprecated this hack until they come up with some other solution for this and similar problems."}], "tags": [], "owner": {"reputation": 50303, "user_id": 170842, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/c2ea72b8d001d81fb6ce3f356e45eb3a?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/170842/michael"}, "is_accepted": true, "score": 1, "last_activity_date": 1464000085, "creation_date": 1464000085, "answer_id": 37388831, "question_id": 37388357, "link": "https://stackoverflow.com/questions/37388357/which-is-the-preferred-syntax-when-using-annotation-based-dependency-injection-i/37388831#37388831", "title": "Which is the preferred syntax when using annotation-based dependency injection in Kotlin?", "body": "<p>There's a third way I use in my projects. But it's a hack.</p>\n\n<pre><code>fun &lt;T&gt; uninitialized(): T = null as T\n\n@Inject private val someService: SomeService = uninitialized()\n</code></pre>\n\n<p>When using this approach you can use <code>val</code> and Kotlin doesn't add any <code>null</code> checks.</p>\n\n<p>I, personally, would like Kotlin to have a legal way to achieve the same behavior, but currently there's none. Some time ago I created <a href=\"https://youtrack.jetbrains.com/issue/KT-10583\" rel=\"nofollow\">KT-10583</a> issue and described how the problem can be solved. But I'm not sure it's going to be solved in the nearest future.</p>\n"}], "owner": {"reputation": 2512, "user_id": 2992899, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Mu5w6.jpg?s=128&g=1", "display_name": "Czyzby", "link": "https://stackoverflow.com/users/2992899/czyzby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 1, "accepted_answer_id": 37388831, "answer_count": 1, "score": 2, "last_activity_date": 1464040519, "creation_date": 1463998651, "last_edit_date": 1464040519, "question_id": 37388357, "link": "https://stackoverflow.com/questions/37388357/which-is-the-preferred-syntax-when-using-annotation-based-dependency-injection-i", "title": "Which is the preferred syntax when using annotation-based dependency injection in Kotlin?", "body": "<p>We're using an existing framework which - among other things - provides dependency injection through annotations. In Java, to inject field value we would do something like this:</p>\n\n<pre><code>@Inject private SomeService someService;\n</code></pre>\n\n<p>Since reflection allows to reassign fields that are normally final, this also a valid declaration:</p>\n\n<pre><code>@Inject private final SomeService someService = null;\n</code></pre>\n\n<p>To make the declaration even shorter (and also make the fields available in unit test classes, while keeping them a part of semi-private API), you could do it like this:</p>\n\n<pre><code>@Inject SomeService someService;\n@Inject final SomeService someService;\n</code></pre>\n\n<p>When it comes to Kotlin, we're stuck with this:</p>\n\n<pre><code>@Inject private var someService: SomeService? = null\n@Inject private lateinit var someService: SomeService\n</code></pre>\n\n<ul>\n<li>Nullable type approach requires additional null check (or <code>!!</code> operator) on every service use, even though we're 100% sure they will never be null - unless something went completely wrong, in which case we have bigger problems.</li>\n<li><code>lateinit</code> approach seems to perform unnecessary checks at runtime (which are, well, highly unlikely to become performance bottlenecks, but still) and is rather verbose.</li>\n<li>Both approaches allow to reassign the variable to another value. We're yet to find a way of replacing <code>var</code> with <code>val</code> without overriding getter or using a back-up field, which faces the same problem. Ironically, they are both longer than Java declarations in many cases.</li>\n</ul>\n\n<p>So - what is the preferred way of declaring annotated Kotlin fields, which will be injected automatically and we're 100% sure that they will never be null?</p>\n\n<p>While I understand that there are multiple frameworks with Kotlin-friendly syntax solving similar problems (like <a href=\"https://github.com/kohesive/injekt\" rel=\"nofollow\">Injekt</a>), I'm asking if there's a nicer way of doing it with what we have.</p>\n"}, {"tags": ["android", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 533, "user_id": 4592776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0tYuMgwm-5A/AAAAAAAAAAI/AAAAAAAABIw/sTNNMDQB3D0/photo.jpg?sz=128", "display_name": "nitrico", "link": "https://stackoverflow.com/users/4592776/nitrico"}, "edited": false, "score": 0, "creation_date": 1463994333, "post_id": 37386457, "comment_id": 62283384, "body": "Thank you @miensol. But if my example (with the annotation) is right, I will leave it like that, because yours would complicate the readability of the code when having a lot of fields."}, {"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "reply_to_user": {"reputation": 533, "user_id": 4592776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0tYuMgwm-5A/AAAAAAAAAAI/AAAAAAAABIw/sTNNMDQB3D0/photo.jpg?sz=128", "display_name": "nitrico", "link": "https://stackoverflow.com/users/4592776/nitrico"}, "edited": false, "score": 0, "creation_date": 1463994758, "post_id": 37386457, "comment_id": 62283678, "body": "@nitrico This was just a suggestion. Note that <code>val field1: Int get() = state.field1</code> are redundant in my example so even with lots of fields there would be little difference in terms of code size from your example."}, {"owner": {"reputation": 533, "user_id": 4592776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0tYuMgwm-5A/AAAAAAAAAAI/AAAAAAAABIw/sTNNMDQB3D0/photo.jpg?sz=128", "display_name": "nitrico", "link": "https://stackoverflow.com/users/4592776/nitrico"}, "edited": false, "score": 0, "creation_date": 1463995215, "post_id": 37386457, "comment_id": 62283973, "body": "But they should be in two places (the singleton itself and the internal class).  Anyway, I&#39;ve asked because I read that <a href=\"http://stackoverflow.com/questions/30179793/are-kotlins-singletons-thread-safe\">singletons are thread-safe in Kotlin</a> but didn&#39;t know if that means what I try to achieve."}, {"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "reply_to_user": {"reputation": 533, "user_id": 4592776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0tYuMgwm-5A/AAAAAAAAAAI/AAAAAAAABIw/sTNNMDQB3D0/photo.jpg?sz=128", "display_name": "nitrico", "link": "https://stackoverflow.com/users/4592776/nitrico"}, "edited": false, "score": 1, "creation_date": 1463996669, "post_id": 37386457, "comment_id": 62284962, "body": "@nitrico &#39;Kotlin &quot;object&quot; is thread-safe by construction&#39; is what the answer says - that is: creating the singleton object instance is thread safe."}], "tags": [], "owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "is_accepted": true, "score": 3, "last_activity_date": 1464011649, "last_edit_date": 1464011649, "creation_date": 1463993111, "answer_id": 37386457, "question_id": 37386116, "link": "https://stackoverflow.com/questions/37386116/are-kotlin-object-singletons-methods-synchronized/37386457#37386457", "title": "Are Kotlin object/singleton&#39;s methods synchronized?", "body": "<p>If you wish to achieve <a href=\"https://docs.oracle.com/javase/tutorial/essential/concurrency/syncmeth.html\" rel=\"nofollow\"><code>@Synchronized</code></a> semantics you need to add it explicitly - as in your example. </p>\n\n<p>The <code>object Singleton {}</code> is no different in this matter from an object created with e.g. <code>val obj = Singleton()</code>.</p>\n\n<p>One other way to ensure the fields are in sync is to model it explicitly e.g.:</p>\n\n<pre><code>object Singleton {\n    @Volatile var state = State(0, 0)\n\n    val field1: Int get() = state.field1\n    val field2: Int get() = state.field2\n\n    data class State(val field1: Int, val field2: Int)\n}\n</code></pre>\n\n<p>And use <code>Singleton.state = Singleton.state.copy(field2 = 3)</code> to update the value. This obviously does not behave exactly the same as <code>@Synchronized</code> but is more explicit on the caller side that the values are to be in sync.</p>\n"}], "owner": {"reputation": 533, "user_id": 4592776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0tYuMgwm-5A/AAAAAAAAAAI/AAAAAAAABIw/sTNNMDQB3D0/photo.jpg?sz=128", "display_name": "nitrico", "link": "https://stackoverflow.com/users/4592776/nitrico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2616, "favorite_count": 0, "accepted_answer_id": 37386457, "answer_count": 1, "score": 6, "last_activity_date": 1464011649, "creation_date": 1463992097, "question_id": 37386116, "link": "https://stackoverflow.com/questions/37386116/are-kotlin-object-singletons-methods-synchronized", "title": "Are Kotlin object/singleton&#39;s methods synchronized?", "body": "<p>Does it make any sense to add the <code>@Synchronized</code> annotation to an object's methods to make them atomic or it isn't needed?</p>\n\n<p>For example:</p>\n\n<pre><code>object Singleton {\n\n    var field1: Int = 0\n        private set\n\n    var field2: Int = 0\n        private set\n\n    @Synchronized fun updateFields(f1: Int, f2: Int) {\n        field1 = f1\n        field2 = f2\n    }\n\n}\n</code></pre>\n\n<p>I want to ensure that all the fields are updated when I read them from other objects. Should I keep the <code>@Synchronized</code> annotation?</p>\n"}, {"tags": ["mockito", "kotlin"], "comments": [{"owner": {"reputation": 110088, "user_id": 2196460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mAcQx.png?s=128&g=1", "display_name": "hotkey", "link": "https://stackoverflow.com/users/2196460/hotkey"}, "edited": false, "score": 1, "creation_date": 1463970833, "post_id": 37381016, "comment_id": 62274499, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/35602231/kotlin-generics-reflection-and-the-difference-between-type-t-and-tany\">Kotlin: Generics, reflection and the difference between type T and T:Any</a>"}, {"owner": {"reputation": 4427, "user_id": 4706743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b05c3b09628ba8955d6d7a188271af?s=128&d=identicon&r=PG&f=1", "display_name": "D3xter", "link": "https://stackoverflow.com/users/4706743/d3xter"}, "edited": false, "score": 1, "creation_date": 1463989340, "post_id": 37381016, "comment_id": 62280528, "body": "Mockito.anyObject&lt;T&gt; is a java method and returns Platform-Type &quot;Any!&quot; That Type can be nullable or non-nullable. the kotlin-compiler won&#39;t infer anything there (because having null checks for every platform-type is noisy). so if you assign &quot;Any!&quot; to a &quot;Any&quot;, this can fail at runtime. see: <a href=\"https://kotlinlang.org/docs/reference/java-interop.html#null-safety-and-platform-types\" rel=\"nofollow noreferrer\">kotlinlang.org/docs/reference/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "edited": false, "score": 0, "creation_date": 1463971916, "post_id": 37381316, "comment_id": 62274718, "body": "Thanks llya. That helps explain the differences. I have some follow up question in the update, perhaps you could explain on?"}], "tags": [], "owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "is_accepted": false, "score": 3, "last_activity_date": 1463965854, "creation_date": 1463965854, "answer_id": 37381316, "question_id": 37381016, "link": "https://stackoverflow.com/questions/37381016/whats-the-different-of-reified-t-with-reified-t-any-in-kotlin/37381316#37381316", "title": "What&#39;s the different of &lt;reified T&gt; with &lt;reified T: Any&gt; in Kotlin?", "body": "<p>When you add <code>T : Any</code> constraint on a type parameter, you're making it effectively non-null: <code>T</code> is subtype of <code>Any</code> and <code>Any</code> can't hold nulls.</p>\n\n<p>Since the function is inline and has a reified type parameter, that parameter gets substituted with a real non-nullable type. And thus a null-check is performed on a call site, so you're getting this exception.</p>\n"}, {"comments": [{"owner": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "edited": false, "score": 0, "creation_date": 1463991157, "post_id": 37383340, "comment_id": 62281535, "body": "Thanks meinsol. When the method with return type T:Any? is invoked, why doesn&#39;t the null value returned by Mockito fails the runtime check inserted by Kotlin compiler?"}, {"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "reply_to_user": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "edited": false, "score": 0, "creation_date": 1463992564, "post_id": 37383340, "comment_id": 62282277, "body": "@Elye <code>T:Any?</code> can be <code>null</code>"}, {"owner": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "edited": false, "score": 0, "creation_date": 1464005391, "post_id": 37383340, "comment_id": 62290524, "body": "Thanks @miensol. Understood now. A further question if you could answer... my <code>settingDependentObject</code> function is also not accepting null. When T:Any? returns Null, why doesn&#39;t <code>settingDependentObject</code> complaints?"}, {"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "reply_to_user": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "edited": false, "score": 0, "creation_date": 1464005643, "post_id": 37383340, "comment_id": 62290706, "body": "@Eley As I mentioned in the answer the <code>IllegalStateException</code> is thrown before invoking <code>settingDependentObject</code>. The compiler doesn&#39;t complain when you have <code>settingDependentObject(anyObject())</code> and <code>&lt;reified T:Any?&gt; anyObject()</code> since <code>Any</code> <i>matches</i> <code>T:Any?</code> but not vice versa."}], "tags": [], "owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "is_accepted": true, "score": 7, "last_activity_date": 1463982220, "last_edit_date": 1495541287, "creation_date": 1463982220, "answer_id": 37383340, "question_id": 37381016, "link": "https://stackoverflow.com/questions/37381016/whats-the-different-of-reified-t-with-reified-t-any-in-kotlin/37383340#37383340", "title": "What&#39;s the different of &lt;reified T&gt; with &lt;reified T: Any&gt; in Kotlin?", "body": "<p>As <a href=\"https://kotlinlang.org/docs/reference/generics.html#upper-bounds\" rel=\"nofollow noreferrer\">stated in the documentation</a> and <a href=\"https://stackoverflow.com/a/35602699/155213\">the linked answer</a> the default upper bound is <code>Any?</code>. In other words the following declarations are equivalent:</p>\n\n<pre><code>inline fun &lt;reified T&gt; anyObject(): T = Mockito.anyObject&lt;T&gt;()\ninline fun &lt;reified T:Any?&gt; anyObject(): T = Mockito.anyObject&lt;T&gt;()\n</code></pre>\n\n<p>The <code>Mockito.anyObject&lt;T&gt;()</code> <a href=\"https://github.com/mockito/mockito/blob/196ff979da156caa07e19f57e4849637d8bede1a/src/main/java/org/mockito/Matchers.java#L161\" rel=\"nofollow noreferrer\">will return <code>null</code></a> for both <code>T:Any</code> and <code>T:Any?</code>. When the method with return type <code>T:Any</code> is invoked the <code>null</code> value returned by Mockito fails the runtime check inserted by Kotlin compiler. The error you're getting is thrown before <code>settingDependentObject</code> is invoked. </p>\n"}], "owner": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 838, "favorite_count": 0, "accepted_answer_id": 37383340, "answer_count": 2, "score": 6, "last_activity_date": 1463982220, "creation_date": 1463962947, "last_edit_date": 1463971880, "question_id": 37381016, "link": "https://stackoverflow.com/questions/37381016/whats-the-different-of-reified-t-with-reified-t-any-in-kotlin", "title": "What&#39;s the different of &lt;reified T&gt; with &lt;reified T: Any&gt; in Kotlin?", "body": "<p>The test class below, pass.</p>\n\n<pre><code>class SimpleClassTest {\n\n    private inline fun &lt;reified T&gt; anyObject(): T {\n        return Mockito.anyObject&lt;T&gt;()\n    }\n\n    lateinit var simpleObject: SimpleClass\n    @Mock lateinit var injectedObject: InjectedClass\n\n\n    @Before\n    fun setUp() {\n        MockitoAnnotations.initMocks(this)\n    }\n\n    @Test\n    fun testSimpleFunction() {\n        simpleObject = SimpleClass(injectedObject)\n        simpleObject.simpleFunction()\n\n        verify(injectedObject).settingDependentObject(anyObject())\n    }\n}\n</code></pre>\n\n<p>But if we change from</p>\n\n<pre><code>    private inline fun &lt;reified T&gt; anyObject(): T {\n        return Mockito.anyObject&lt;T&gt;()\n    }\n</code></pre>\n\n<p>to</p>\n\n<pre><code>    private inline fun &lt;reified T: Any&gt; anyObject(): T {\n        return Mockito.anyObject&lt;T&gt;()\n    }\n</code></pre>\n\n<p>It will fail with</p>\n\n<pre><code>java.lang.IllegalStateException: Mockito.anyObject&lt;T&gt;() must not be null\n</code></pre>\n\n<p>What's the different of <code>&lt;reified T&gt;</code> with <code>&lt;reified T: Any&gt;</code> in Kotlin?</p>\n\n<p><strong>UPDATED</strong>\nWith the answer that Any is non-null, then using <code>&lt;reified T: Any&gt;</code> shouldn't return error, since <code>settingDependentObject(...)</code> is declared receiving a non-null argument. I would expect <code>&lt;reified T&gt;</code> should error out instead, but it's opposite from what I understand. </p>\n\n<p>Did I understand something wrong?</p>\n"}, {"tags": ["mockito", "kotlin"], "comments": [{"owner": {"reputation": 89682, "user_id": 675383, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e7a971eb341ffeaa3efca407239bf3b?s=128&d=identicon&r=PG", "display_name": "nhaarman", "link": "https://stackoverflow.com/users/675383/nhaarman"}, "edited": false, "score": 1, "creation_date": 1463990817, "post_id": 37380830, "comment_id": 62281381, "body": "There is an <a href=\"https://github.com/nhaarman/mockito-kotlin/pull/23\" rel=\"nofollow noreferrer\">open PR</a> that solves <a href=\"https://github.com/nhaarman/mockito-kotlin/issues/20\" rel=\"nofollow noreferrer\">this</a> <a href=\"https://github.com/nhaarman/mockito-kotlin/issues/17\" rel=\"nofollow noreferrer\">issue</a>. However, I&#39;m not entirely sure if this is production worthy."}], "answers": [{"comments": [{"owner": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "edited": false, "score": 0, "creation_date": 1463976322, "post_id": 37381565, "comment_id": 62275665, "body": "Ya, that&#39;s the issue. Hope nharmaan could think of a way to resolve this issue in his library."}, {"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "edited": false, "score": 0, "creation_date": 1464090010, "post_id": 37381565, "comment_id": 62331345, "body": "<code>Mockito.any&lt;Response&gt;()</code> will always return <code>null</code>, won&#39;t it?"}, {"owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "reply_to_user": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "edited": false, "score": 0, "creation_date": 1464097846, "post_id": 37381565, "comment_id": 62337294, "body": "@miensol, yes, that&#39;s why an elvis operator with some non-null response is required after"}, {"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "edited": false, "score": 0, "creation_date": 1464107298, "post_id": 37381565, "comment_id": 62343909, "body": "@Ilya so it&#39;s equivalent to <code>null ?: someResponse</code>  which in turn is equivalent to just <code>someResponse</code>, isn&#39;t it?"}, {"owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "reply_to_user": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "edited": false, "score": 0, "creation_date": 1464109786, "post_id": 37381565, "comment_id": 62345303, "body": "@miensol, not it isn&#39;t, because <code>Mockito.any</code> is a function with a side-effect, it modifies the internal state that is used then by the object being mocked."}], "tags": [], "owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "is_accepted": true, "score": 3, "last_activity_date": 1464053860, "last_edit_date": 1464053860, "creation_date": 1463968238, "answer_id": 37381565, "question_id": 37380830, "link": "https://stackoverflow.com/questions/37380830/java-lang-reflect-invocationtargetexception-when-using-kotlin-mokito-library/37381565#37381565", "title": "java.lang.reflect.InvocationTargetException when using Kotlin-Mokito library", "body": "<p>The library relies on the reflection to instantiate an object of a given type to be used as mockito \"Any\" object. \nIt might not be possible for those classes which have non-trivial constructors.  <code>Response</code> is one of them.</p>\n\n<p>If you could get an instance of <code>Response</code> somehow, you can use it instead like:</p>\n\n<pre><code>verify(injectedObject).settingDependentObject(Mockito.any&lt;Response&gt;() ?: someResponse)\n</code></pre>\n"}], "owner": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6092, "favorite_count": 1, "accepted_answer_id": 37381565, "answer_count": 1, "score": 2, "last_activity_date": 1464053860, "creation_date": 1463961286, "question_id": 37380830, "link": "https://stackoverflow.com/questions/37380830/java-lang-reflect-invocationtargetexception-when-using-kotlin-mokito-library", "title": "java.lang.reflect.InvocationTargetException when using Kotlin-Mokito library", "body": "<p>any() from Kotlin Mockito library crash with the following code</p>\n\n<p><strong>The Test Class</strong></p>\n\n<pre><code>import com.nhaarman.mockito_kotlin.any\nimport com.nhaarman.mockito_kotlin.verify\nimport org.junit.Before\nimport org.junit.Test\nimport org.mockito.Mock\nimport org.mockito.MockitoAnnotations\n\nclass SimpleClassTest {\n\n    lateinit var simpleObject: SimpleClass\n    @Mock lateinit var injectedObject: InjectedClass\n\n\n    @Before\n    fun setUp() {\n        MockitoAnnotations.initMocks(this)\n    }\n\n    @Test\n    fun testSimpleFunction() {\n        simpleObject = SimpleClass(injectedObject)\n        simpleObject.simpleFunction()\n\n        verify(injectedObject).settingDependentObject(any())\n\n    }\n}\n</code></pre>\n\n<p><strong>The Source Class</strong></p>\n\n<pre><code>import com.squareup.okhttp.Protocol\nimport com.squareup.okhttp.Request\nimport com.squareup.okhttp.Response\n\n\nclass SimpleClass(val injectedClass: InjectedClass) {\n\n    fun simpleFunction() {\n        injectedClass.settingDependentObject(Response.Builder()\n                .request(Request.Builder().url(\"https://example.com\").build())\n                .code(200)\n                .body(null)\n                .protocol(Protocol.HTTP_1_1)\n                .build())\n    }\n}\n\nopen class DependentClass(response: Response) {\n\n}\n\nopen class InjectedClass() {\n    lateinit var response: Response\n\n    open fun settingDependentObject(response: Response) {\n        this.response = response\n    }\n}\n</code></pre>\n\n<p>The Crash Log</p>\n\n<pre><code>java.lang.reflect.InvocationTargetException\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n    at java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n    at kotlin.reflect.jvm.internal.FunctionCaller$Constructor.call(FunctionCaller.kt:63)\n    at kotlin.reflect.jvm.internal.KCallableImpl$DefaultImpls.call(KCallableImpl.kt:67)\n    at kotlin.reflect.jvm.internal.KFunctionImpl.call(KFunctionImpl.kt:30)\n    at kotlin.reflect.jvm.internal.KCallableImpl$DefaultImpls.callBy(KCallableImpl.kt:103)\n    at kotlin.reflect.jvm.internal.KFunctionImpl.callBy(KFunctionImpl.kt:30)\n    at com.nhaarman.mockito_kotlin.CreateInstanceKt.newInstance(CreateInstance.kt:138)\n    at com.nhaarman.mockito_kotlin.CreateInstanceKt.createInstance(CreateInstance.kt:60)\n    at com.elyeproj.phoneinfo.SimpleClassTest.testSimpleFunction(SimpleClassTest.kt:36)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:498)\n    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)\n    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\n    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)\n    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)\n    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)\n    at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)\n    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)\n    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)\n    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)\n    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)\n    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)\n    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)\n    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)\n    at org.junit.runners.ParentRunner.run(ParentRunner.java:363)\n    at org.junit.runner.JUnitCore.run(JUnitCore.java:137)\n    at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)\n    at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)\n    at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:498)\n    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)\nCaused by: java.lang.NullPointerException\n    at com.squareup.okhttp.Response.&lt;init&gt;(Response.java:56)\n    ... 39 more\n</code></pre>\n"}, {"tags": ["generics", "mockito", "kotlin"], "comments": [{"owner": {"reputation": 89682, "user_id": 675383, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e7a971eb341ffeaa3efca407239bf3b?s=128&d=identicon&r=PG", "display_name": "nhaarman", "link": "https://stackoverflow.com/users/675383/nhaarman"}, "edited": false, "score": 0, "creation_date": 1463936599, "post_id": 37375142, "comment_id": 62265587, "body": "What version of Kotlin and its plugin are you using?"}, {"owner": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "reply_to_user": {"reputation": 89682, "user_id": 675383, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e7a971eb341ffeaa3efca407239bf3b?s=128&d=identicon&r=PG", "display_name": "nhaarman", "link": "https://stackoverflow.com/users/675383/nhaarman"}, "edited": false, "score": 0, "creation_date": 1463958517, "post_id": 37375142, "comment_id": 62272060, "body": "I use 1.0.1-2. And when I switch to 1.0.2, it still works."}], "answers": [{"comments": [{"owner": {"reputation": 89682, "user_id": 675383, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e7a971eb341ffeaa3efca407239bf3b?s=128&d=identicon&r=PG", "display_name": "nhaarman", "link": "https://stackoverflow.com/users/675383/nhaarman"}, "edited": false, "score": 1, "creation_date": 1463936562, "post_id": 37377126, "comment_id": 62265575, "body": "To overcome this problem, I wrote a little <a href=\"https://www.github.com/nhaarman/mockito-kotlin\" rel=\"nofollow noreferrer\">helper library</a>."}, {"owner": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "edited": false, "score": 0, "creation_date": 1463961446, "post_id": 37377126, "comment_id": 62272637, "body": "Hi @nhaarman, great to hear from you. Actually I&#39;m aware of the null error issue due to Kotlin null-safe requirement, and Mockito returning null, and were wondering how that function got it working for me. Hence I post my question up as it is. I did try to use the helper library, but there&#39;s an issue when using a OkHttp response. I post the question at <a href=\"http://stackoverflow.com/questions/37380830/java-lang-reflect-invocationtargetexception-when-using-kotlin-mokito-library\" title=\"java lang reflect invocationtargetexception when using kotlin mokito library\">stackoverflow.com/questions/37380830/&hellip;</a>, which is specifically for you. (I think others will not be able to answer it, as it might be your library specific). Thanks"}, {"owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "edited": false, "score": 2, "creation_date": 1463966855, "post_id": 37377126, "comment_id": 62273684, "body": "@nhaarman The first method works because the compiler doesn&#39;t insert a null check after calling  <code>SimpleClassTest.anyObject</code> function. This behavior may be changed later, see <a href=\"https://youtrack.jetbrains.com/issue/KT-8135\" rel=\"nofollow noreferrer\">KT-8135</a>"}, {"owner": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "edited": false, "score": 0, "creation_date": 1463991687, "post_id": 37377126, "comment_id": 62281794, "body": "@llya, thanks for pointing this out. Perhaps you could put the comment as answer, explaining why one compiles and the other doesn&#39;t, that I could give a tick to it. As I plan to tick answer that covers both scenario."}], "tags": [], "owner": {"reputation": 89682, "user_id": 675383, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6e7a971eb341ffeaa3efca407239bf3b?s=128&d=identicon&r=PG", "display_name": "nhaarman", "link": "https://stackoverflow.com/users/675383/nhaarman"}, "is_accepted": true, "score": 5, "last_activity_date": 1463936526, "last_edit_date": 1495542782, "creation_date": 1463936526, "answer_id": 37377126, "question_id": 37375142, "link": "https://stackoverflow.com/questions/37375142/kotlin-manually-inlining-a-generic-function-produce-a-different-result/37377126#37377126", "title": "Kotlin: Manually inlining a generic function produce a different result?", "body": "<p>The source for <code>Mockito.anyObject()</code>:</p>\n\n<pre><code>/**\n * Matches anything, including null.\n * &lt;p&gt;\n * This is an alias of: {@link #any()} and {@link #any(java.lang.Class)}\n * &lt;p&gt;\n * See examples in javadoc for {@link Matchers} class\n * \n * @return &lt;code&gt;null&lt;/code&gt;.\n */\npublic static &lt;T&gt; T anyObject() {\n    return (T) reportMatcher(Any.ANY).returnNull();\n}\n</code></pre>\n\n<p>This method sets some internal state for Mockito, and then proceeds to return <code>null</code>. Since you're expecting a non-null instance in your <code>settingDependentObject()</code> method, the runtime fails.</p>\n\n<hr>\n\n<p>Why your first method succeeded, however, I'm not sure. Casting <code>null</code> to <code>T</code> <a href=\"https://stackoverflow.com/questions/30305217/is-it-possible-to-use-mockito-in-kotlin/35776132#35776132\">seemed to work a while ago</a>, but it doesn't work for me anymore. For that matter, I can't get your first implementation to succeed either.</p>\n"}], "owner": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 515, "favorite_count": 0, "accepted_answer_id": 37377126, "answer_count": 1, "score": 1, "last_activity_date": 1463936526, "creation_date": 1463924647, "question_id": 37375142, "link": "https://stackoverflow.com/questions/37375142/kotlin-manually-inlining-a-generic-function-produce-a-different-result", "title": "Kotlin: Manually inlining a generic function produce a different result?", "body": "<p>I have a simple test class</p>\n\n<pre><code>class SimpleClassTest {\n\n    private fun &lt;T&gt; anyObject(): T {\n        return Mockito.anyObject&lt;T&gt;()\n    }\n\n    lateinit var simpleObject: SimpleClass\n    @Mock lateinit var injectedObject: InjectedClass\n\n\n    @Before\n    fun setUp() {\n        MockitoAnnotations.initMocks(this)\n    }\n\n    @Test\n    fun testSimpleFunction() {\n        simpleObject = SimpleClass(injectedObject)\n        simpleObject.simpleFunction()\n\n        verify(injectedObject).settingDependentObject(anyObject())\n    }\n}\n</code></pre>\n\n<p>It works fine and pass.</p>\n\n<p>Since the private generic <code>anyObject()</code> function is only used once, so I decide to inlining it (manually) i.e. remove the need of that function, whereby I change from</p>\n\n<pre><code>verify(injectedObject).settingDependentObject(anyObject())\n</code></pre>\n\n<p>to</p>\n\n<pre><code>verify(injectedObject).settingDependentObject(Mockito.anyObject&lt;DependentClass&gt;())\n</code></pre>\n\n<p>However this now error as \n<code>java.lang.IllegalStateException: Mockito.anyObject&lt;DependentClass&gt;() must not be null</code></p>\n\n<p>Anything I did wrong inlining the function call to a direct statement?</p>\n\n<p>Is there anything different between using</p>\n\n<pre><code>private fun &lt;T&gt; anyObject(): T {\n    return Mockito.anyObject&lt;T&gt;()\n}\n</code></pre>\n\n<p>and the below?</p>\n\n<pre><code>Mockito.anyObject&lt;DependentClass&gt;()\n</code></pre>\n"}, {"tags": ["android", "android-edittext", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 53550, "user_id": 1083957, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/vIOTT.jpg?s=128&g=1", "display_name": "azizbekian", "link": "https://stackoverflow.com/users/1083957/azizbekian"}, "edited": false, "score": 1, "creation_date": 1514453750, "post_id": 37374301, "comment_id": 82978060, "body": "Nice explanation, sir."}, {"owner": {"reputation": 714, "user_id": 3874231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a56419c2e9770759b2ecf14ffd8beb6?s=128&d=identicon&r=PG&f=1", "display_name": "wojtow", "link": "https://stackoverflow.com/users/3874231/wojtow"}, "edited": false, "score": 1, "creation_date": 1551384684, "post_id": 37374301, "comment_id": 96631443, "body": "When calling java from Kotlin, I&#39;d say the linter isn&#39;t really doing you a favor suggesting you use the synthetic property.  1) It&#39;s not at all obvious when you can use it (as the OP&#39;s example illustrates)  2) Because sometimes you can and sometimes you can&#39;t use it you end up with two different coding styles for similar looking operations  3)  The documentation is in the Java notation.      I just turn that inspection off."}], "tags": [], "owner": {"reputation": 50303, "user_id": 170842, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/c2ea72b8d001d81fb6ce3f356e45eb3a?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/170842/michael"}, "is_accepted": true, "score": 57, "last_activity_date": 1463919672, "creation_date": 1463919672, "answer_id": 37374301, "question_id": 37374075, "link": "https://stackoverflow.com/questions/37374075/how-does-kotlin-property-access-syntax-work-for-java-classes-i-e-edittext-sett/37374301#37374301", "title": "How does Kotlin property access syntax work for Java classes (i.e. EditText setText)?", "body": "<p>When generating a synthetic property for a Java getter/setter pair Kotlin first looks for a getter. The getter is enough to create a synthetic property with a type of the getter. On the other hand the property will not be created if only a setter presents.</p>\n\n<p>When a setter comes into play property creation becomes more difficult. The reason is that the getter and the setter may have different type. Moreover, the getter and/or the setter may be overridden in a subclass.</p>\n\n<p>In your case the <code>TextView</code> class contains a getter <code>CharSequence getText()</code> and a setter <code>void setText(CharSequence)</code>. If you had a variable of type <code>TextView</code> your code would work fine. But you have a variable of type <code>EditText</code>. And the <code>EditText</code> class contains an overridden getter <code>Editable getText()</code>, which means that you can get an <code>Editable</code> for an <code>EditText</code> and set an <code>Editable</code> to an <code>EditText</code>. Therefore, Kotlin reasonably creates a synthetic property <code>text</code> of type <code>Editable</code>. The <code>String</code> class is not <code>Editable</code>, that's why you cannot assign a <code>String</code> instance to the <code>text</code> property of the <code>EditText</code> class.</p>\n"}, {"tags": [], "owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "is_accepted": false, "score": 5, "last_activity_date": 1463919707, "creation_date": 1463919707, "answer_id": 37374315, "question_id": 37374075, "link": "https://stackoverflow.com/questions/37374075/how-does-kotlin-property-access-syntax-work-for-java-classes-i-e-edittext-sett/37374315#37374315", "title": "How does Kotlin property access syntax work for Java classes (i.e. EditText setText)?", "body": "<p>The <code>android.text.Editable</code> comes from the <a href=\"https://developer.android.com/reference/android/widget/EditText.html#getText()\" rel=\"noreferrer\"><code>getText()</code></a>. It appears to me that the <code>obj.text = value</code> resolution in Kotlin is 2 step process.</p>\n\n<ol>\n<li>Compiler tries to finds a <code>text</code> property or Java method <code>getText</code> from which it infers the property type</li>\n<li>For the inferred property type the compiler tries to find corresponding property setter or Java method <code>setText(PropertyType value)</code></li>\n</ol>\n\n<p>Since in the 1. the inferred type is <code>Editable</code> the <code>editText.text = \"value\"</code> fails with <code>Type mismatch</code> error.</p>\n"}, {"tags": [], "owner": {"reputation": 466, "user_id": 1393687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05412889d6099f5b4bffb204ee820082?s=128&d=identicon&r=PG", "display_name": "souleymane sidib&#233;", "link": "https://stackoverflow.com/users/1393687/souleymane-sidib%c3%a9"}, "is_accepted": false, "score": 15, "last_activity_date": 1491074619, "creation_date": 1491074619, "answer_id": 43161042, "question_id": 37374075, "link": "https://stackoverflow.com/questions/37374075/how-does-kotlin-property-access-syntax-work-for-java-classes-i-e-edittext-sett/43161042#43161042", "title": "How does Kotlin property access syntax work for Java classes (i.e. EditText setText)?", "body": "<p>To avoid type mismatch, you can use the Factory inner class of Editable class. \nSo you can do now something like:  </p>\n\n<pre><code>textview.text = Editable.Factory.getInstance().newEditable(\"your text\")  \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 596, "user_id": 1640696, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/0x1FR.png?s=128&g=1", "display_name": "BNY", "link": "https://stackoverflow.com/users/1640696/bny"}, "is_accepted": false, "score": 7, "last_activity_date": 1533990848, "creation_date": 1533990848, "answer_id": 51799740, "question_id": 37374075, "link": "https://stackoverflow.com/questions/37374075/how-does-kotlin-property-access-syntax-work-for-java-classes-i-e-edittext-sett/51799740#51799740", "title": "How does Kotlin property access syntax work for Java classes (i.e. EditText setText)?", "body": "<p>Alternatively you could write an extension:</p>\n\n<pre><code>fun String.toEditable(): Editable =  Editable.Factory.getInstance().newEditable(this)\n</code></pre>\n\n<p>You can then use it as such:</p>\n\n<pre><code>mEditText.text = myString.toEditable()\n</code></pre>\n"}], "owner": {"reputation": 1427, "user_id": 1815052, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bed5ab71b8d23d9bf07a5fa12915699c?s=128&d=identicon&r=PG", "display_name": "SqueezyMo", "link": "https://stackoverflow.com/users/1815052/squeezymo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20024, "favorite_count": 6, "accepted_answer_id": 37374301, "answer_count": 4, "score": 32, "last_activity_date": 1561913166, "creation_date": 1463918367, "last_edit_date": 1561913166, "question_id": 37374075, "link": "https://stackoverflow.com/questions/37374075/how-does-kotlin-property-access-syntax-work-for-java-classes-i-e-edittext-sett", "title": "How does Kotlin property access syntax work for Java classes (i.e. EditText setText)?", "body": "<p>I'm trying to switch my Android project to Kotlin. I have an <code>EditText</code> (a subclass of <code>TextView</code>) for which I want to set a hint and text programmatically. The hint works as expected. For text, though, I'm getting a type mismatch exception if I try to do it using Kotlin setter syntax:</p>\n\n<pre><code>    val test = EditText(context)\n\n    test.setHint(\"hint\")    // Lint message: \"Use property access syntax\"\n    test.hint = \"hint\"      // ok\n\n    test.setText(\"text\")    // ok (no lint message)\n    test.text = \"text\"      // Type mismatch: inferred type is kotlin.String but android.text.Editable! was expected\n</code></pre>\n\n<p>If we look at the declaration, we'll find identical signatures inherited from <code>TextView</code>:</p>\n\n<pre><code>    public final void setHint(CharSequence hint)\n\n    public final void setText(CharSequence text)\n</code></pre>\n\n<p>I had an impression that <code>x.y = z</code> was a shortcut for <code>x.setY(z)</code> but apparently that impression was wrong. <code>setText()</code> is treated as a normal method rather than a setter, but what's the difference between these two methods that makes the compiler behave differently? The only one I can think of is that <code>TextView</code> has an <code>mHint</code> property but I don't think it might be the case.</p>\n\n<p>Another thing I don't quite understand is, where does <code>android.text.Editable</code> come from? There is no corresponding <code>setText(Editable)</code> method, nor is there a public field of this type.</p>\n"}, {"tags": ["java", "android", "kotlin", "parcel"], "answers": [{"tags": [], "owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "is_accepted": true, "score": 7, "last_activity_date": 1463909922, "last_edit_date": 1463909922, "creation_date": 1463909475, "answer_id": 37372606, "question_id": 37372435, "link": "https://stackoverflow.com/questions/37372435/kotlin-android-parcelable/37372606#37372606", "title": "Kotlin android parcelable", "body": "<p>In Kotlin <a href=\"https://kotlinlang.org/docs/reference/classes.html#wait-how-will-i-hack-my-libraries-now\" rel=\"noreferrer\">classes and members are final by default</a>. In other words the following declarations have the same bytecode:</p>\n\n<pre><code>@JvmField final val CREATOR: Parcelable.Creator&lt;Person&gt; = PersonCreator()\n@JvmField val CREATOR: Parcelable.Creator&lt;Person&gt; = PersonCreator()\n</code></pre>\n\n<p>So while the generated code has <code>final</code> keyword and it is not an error it is redundant.</p>\n\n<p>Even though classes and members are final by default there are still a need for <code>final</code> modifier in Kotlin. One example would be to mark <code>open</code> method as <code>final</code> in derived class:</p>\n\n<pre><code>open class Base {\n    open fun test(){}\n}\n\nopen class DerivedA : Base(){\n    final override fun test(){}\n}\n\nclass DerivedB : DerivedA() {\n    override fun test(){} //error: 'test' in 'DerivedA' is final and cannot be overriden\n}\n</code></pre>\n\n<p>While it's a good practice to make <code>public static</code> field <code>final</code> in java there's <a href=\"https://developer.android.com/reference/android/os/Parcelable.html\" rel=\"noreferrer\">no strict requirement for the <code>Parccelable.Creator</code> field</a> to be marked as such:</p>\n\n<blockquote>\n  <p>Classes implementing the Parcelable interface must also have a\n  non-null static field called CREATOR of a type that implements the\n  Parcelable.Creator interface.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 12833, "user_id": 4034572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3afb5605f4229f99610c44c2b8b0920e?s=128&d=identicon&r=PG", "display_name": "Albert Vila Calvo", "link": "https://stackoverflow.com/users/4034572/albert-vila-calvo"}, "is_accepted": false, "score": 6, "last_activity_date": 1591026498, "last_edit_date": 1591026498, "creation_date": 1556886089, "answer_id": 55969730, "question_id": 37372435, "link": "https://stackoverflow.com/questions/37372435/kotlin-android-parcelable/55969730#55969730", "title": "Kotlin android parcelable", "body": "<p>In Kotlin you can use the <code>@Parcelize</code> Kotlin Android Extension:</p>\n\n<pre><code>@Parcelize\ndata class User(val id: String, val name: String) : Parcelable\n</code></pre>\n\n<p>This is a compiler plugin that automatically generates the <a href=\"https://developer.android.com/reference/android/os/Parcelable\" rel=\"nofollow noreferrer\">Parcelable</a> implementation for you.</p>\n\n<p><a href=\"https://kotlinlang.org/docs/reference/compiler-plugins.html#parcelable-implementations-generator\" rel=\"nofollow noreferrer\">This page</a> on the Kotlin docs gives more details about it, including requirements, <a href=\"https://kotlinlang.org/docs/reference/compiler-plugins.html#supported-types\" rel=\"nofollow noreferrer\">supported types</a> and how to create <a href=\"https://kotlinlang.org/docs/reference/compiler-plugins.html#custom-parcelers\" rel=\"nofollow noreferrer\">custom parcelers</a> for unsupported types. </p>\n\n<hr>\n\n<p>If you are curious and you want dive into the technical details of the implementation, see the Kotlin Evolution and Enhancement Process <a href=\"https://github.com/Kotlin/KEEP/blob/master/proposals/extensions/android-parcelable.md\" rel=\"nofollow noreferrer\"><em>Compiler Extension to Support <code>android.os.Parcelable</code></em></a>. </p>\n\n<hr>\n\n<p>This feature was <a href=\"https://github.com/JetBrains/kotlin/blob/1.3.40/ChangeLog.md#tools-android-extensions\" rel=\"nofollow noreferrer\">experimental until Kotlin 1.3.40</a>. If you are still using a Kotlin version earlier than 1.3.40, you need to enable the experimental features to use this:</p>\n\n<pre><code>android {\n    // Enable @Parcelize\n    // You only need this for Kotlin &lt; 1.3.40\n    androidExtensions {\n        experimental = true\n    }\n    ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4887, "user_id": 371720, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/D2Rdd.png?s=128&g=1", "display_name": "Shihab Uddin", "link": "https://stackoverflow.com/users/371720/shihab-uddin"}, "is_accepted": false, "score": 2, "last_activity_date": 1583925405, "last_edit_date": 1583925405, "creation_date": 1583923353, "answer_id": 60634148, "question_id": 37372435, "link": "https://stackoverflow.com/questions/37372435/kotlin-android-parcelable/60634148#60634148", "title": "Kotlin android parcelable", "body": "<p>Use @Parcelize annotation to data class and extends Parcelable. Kotlin automatically do the rest for you. Example- Person data class.</p>\n\n<pre><code>@Parcelize\ndata class Person(val name: String, val age: Int, val email: String) : Parcelable\n</code></pre>\n\n<p>You can send value lets press on a button click like below from an activity.</p>\n\n<pre><code>   private val PERSON = \"person\"\n\n   // first ensure a person object with data\n   val person = Person(\"Shihab Uddin\", 30, \"shihab.mi7@gmai.com\")\n\n   binding.buttonSend.setOnClickListener {\n\n        val intent = Intent(this, ReceiveParcelableAcitivty::class.java)\n        //then put an parcelable extra to intent \n        intent.putExtra(PERSON, person)\n        startActivity(intent)\n\n    }\n</code></pre>\n\n<p>Receivers activity will get the data like </p>\n\n<pre><code>    private val PERSON = \"person\"\n    intent?.let {\n        var person = intent.extras.getParcelable(PERSON) as Person\n        bind.textViewData.text = \" Data Receive: $person\"\n    }\n</code></pre>\n\n<p><strong>androidExtensions</strong> attribute is no more necessary &lt; kotlin 1.3.40 </p>\n\n<pre><code>android {\n\n    // You only need this for Kotlin &lt; 1.3.40\n    androidExtensions {\n        experimental = true\n    }\n    ...\n}\n</code></pre>\n"}], "owner": {"reputation": 3611, "user_id": 1165499, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/64bccb96953928310e2b9056c75dffb5?s=128&d=identicon&r=PG&f=1", "display_name": "ashur", "link": "https://stackoverflow.com/users/1165499/ashur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5275, "favorite_count": 0, "accepted_answer_id": 37372606, "answer_count": 3, "score": 8, "last_activity_date": 1591026498, "creation_date": 1463908025, "last_edit_date": 1463908402, "question_id": 37372435, "link": "https://stackoverflow.com/questions/37372435/kotlin-android-parcelable", "title": "Kotlin android parcelable", "body": "<p>I've used auto generated feature of android plugin for android studio and it generated me the following code, but I can't understand why is there need for <code>final val</code> for <code>CREATOR</code> field ? I see <code>final</code> keyword for the first time in kotlin.</p>\n\n<pre><code>data class Person(\n        val name: String,\n        val surname: String\n) : Parcelable {\n    constructor(source: Parcel): this(source.readString(), source.readString())\n\n    override fun describeContents(): Int {\n        return 0\n    }\n\n    override fun writeToParcel(dest: Parcel?, flags: Int) {\n        dest?.writeString(name)\n        dest?.writeString(surname)\n    }\n\n    companion object {\n        @JvmField final val CREATOR: Parcelable.Creator&lt;Person&gt; = object : Parcelable.Creator&lt;Person&gt; {\n            override fun createFromParcel(source: Parcel): Person {\n                return Person(source)\n            }\n\n            override fun newArray(size: Int): Array&lt;Person?&gt; {\n                return arrayOfNulls(size)\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["java", "firebase", "kotlin", "firebase-realtime-database"], "comments": [{"owner": {"reputation": 26445, "user_id": 608820, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/aGmg7.jpg?s=128&g=1", "display_name": "Augusto", "link": "https://stackoverflow.com/users/608820/augusto"}, "edited": false, "score": 3, "creation_date": 1463883810, "post_id": 37369895, "comment_id": 62252117, "body": "I don&#39;t have any experience with firebase, but it looks like the parameter <code>key</code> in the eventlistener is null. Can you change the parameter of onChildAdded to be <code>String?</code> and try again?"}, {"owner": {"reputation": 3243, "user_id": 5079849, "user_type": "registered", "accept_rate": 46, "profile_image": "https://lh3.googleusercontent.com/-2CP3JmsQzco/AAAAAAAAAAI/AAAAAAAAAds/VUDQ1UwKiFI/photo.jpg?sz=128", "display_name": "Putra Ardiansyah", "link": "https://stackoverflow.com/users/5079849/putra-ardiansyah"}, "reply_to_user": {"reputation": 26445, "user_id": 608820, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/aGmg7.jpg?s=128&g=1", "display_name": "Augusto", "link": "https://stackoverflow.com/users/608820/augusto"}, "edited": false, "score": 0, "creation_date": 1463884355, "post_id": 37369895, "comment_id": 62252193, "body": "My bad, yes I traced the second parameter which is possibly null. Thanks"}, {"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1463907399, "post_id": 37369895, "comment_id": 62256471, "body": "Is this resolved? Can someone post a working solution to close the question?"}, {"owner": {"reputation": 3243, "user_id": 5079849, "user_type": "registered", "accept_rate": 46, "profile_image": "https://lh3.googleusercontent.com/-2CP3JmsQzco/AAAAAAAAAAI/AAAAAAAAAds/VUDQ1UwKiFI/photo.jpg?sz=128", "display_name": "Putra Ardiansyah", "link": "https://stackoverflow.com/users/5079849/putra-ardiansyah"}, "edited": false, "score": 0, "creation_date": 1463911750, "post_id": 37369895, "comment_id": 62257524, "body": "As Augusto said above, Kotlin is null-safe, but on above function, the key parameter may null. So the code should like this <code>onChildAdded(dataSnapshot: DataSnapshot, key: String?)</code> add question mark after key parameter"}], "answers": [{"tags": [], "owner": {"reputation": 3243, "user_id": 5079849, "user_type": "registered", "accept_rate": 46, "profile_image": "https://lh3.googleusercontent.com/-2CP3JmsQzco/AAAAAAAAAAI/AAAAAAAAAds/VUDQ1UwKiFI/photo.jpg?sz=128", "display_name": "Putra Ardiansyah", "link": "https://stackoverflow.com/users/5079849/putra-ardiansyah"}, "is_accepted": true, "score": 3, "last_activity_date": 1463911878, "creation_date": 1463911878, "answer_id": 37372985, "question_id": 37369895, "link": "https://stackoverflow.com/questions/37369895/kotlin-firebase-deserialization/37372985#37372985", "title": "Kotlin Firebase Deserialization", "body": "<p>As Augusto said above, Kotlin is null-safe, but on above function, the <em>key</em> parameter may null.\nSo the code should like this</p>\n\n<pre><code>onChildAdded(dataSnapshot: DataSnapshot, key: String?)\n</code></pre>\n\n<p><strong>Add question mark</strong> after key parameter</p>\n"}], "owner": {"reputation": 3243, "user_id": 5079849, "user_type": "registered", "accept_rate": 46, "profile_image": "https://lh3.googleusercontent.com/-2CP3JmsQzco/AAAAAAAAAAI/AAAAAAAAAds/VUDQ1UwKiFI/photo.jpg?sz=128", "display_name": "Putra Ardiansyah", "link": "https://stackoverflow.com/users/5079849/putra-ardiansyah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2347, "favorite_count": 1, "accepted_answer_id": 37372985, "answer_count": 1, "score": 3, "last_activity_date": 1463911878, "creation_date": 1463883467, "last_edit_date": 1463888634, "question_id": 37369895, "link": "https://stackoverflow.com/questions/37369895/kotlin-firebase-deserialization", "title": "Kotlin Firebase Deserialization", "body": "<p>I'm trying to deserialize data from Firebase to POJO with Kotlin, this is my POJO class:</p>\n\n<pre><code>class Message {\nvar number: String ?= null\nvar message: String? = null\nvar timestamp: Long = 0L\nvar isHandled: Boolean ?= false\nvar type:String ?=null\n}\n</code></pre>\n\n<p>and this is my code to retrieve data from Firebase</p>\n\n<pre><code>val query = Fire.REF.child(\"sms\").orderByChild(\"type\").equalTo(\"outbox-unsent\")\n    query.addChildEventListener(object : ChildEventListener {\n        override fun onChildAdded(dataSnapshot: DataSnapshot, key: String) {\n            val outbox = dataSnapshot.getValue(Message::class.java)\n            Log.d(\"BS\", \"Background Service $outbox\")\n           }\n//......\n});\n</code></pre>\n\n<p>this is my data structure on Firebase look like</p>\n\n<pre><code>\"sms\":{\n\"-KI3ar91oBXGNpXXrOCS\" : {\n\"handled\" : false,\n\"message\" : \"Pak kenapa koneksi...\",\n\"number\" : \"+6285830166314\",\n\"timestamp\" : 1463587399000,\n\"type\" : \"inbox\"\n},\n//.......//\n}\n</code></pre>\n\n<p>When I execute the code it raises an error:</p>\n\n<pre><code>java.lang.IllegalArgumentException: Parameter specified as non-null is null: method kotlin.jvm.internal.Intrinsics.checkParameterIsNotNull, parameter key\n</code></pre>\n\n<p>Where is my mistake on above code?</p>\n"}, {"tags": ["mockito", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "edited": false, "score": 1, "creation_date": 1463818830, "post_id": 37360255, "comment_id": 62235179, "body": "My injectObject class is already an open class. The settingDependentObject require a non-null object, but anyObject() returns null. That&#39;s why I thought the solution in <a href=\"http://stackoverflow.com/a/30308199/3286489\">stackoverflow.com/a/30308199/3286489</a> would help me overcome the null required issue. But it&#39;s still not  working."}, {"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "reply_to_user": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "edited": false, "score": 0, "creation_date": 1463820494, "post_id": 37360255, "comment_id": 62235588, "body": "@Elye please add the <code>InjectedClass</code> source to the question"}, {"owner": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "edited": false, "score": 0, "creation_date": 1463823227, "post_id": 37360255, "comment_id": 62236256, "body": "Added the class to be tested to the Update above. Thanks!"}, {"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "reply_to_user": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "edited": false, "score": 2, "creation_date": 1463826055, "post_id": 37360255, "comment_id": 62237004, "body": "@Elye you need to open both class and method for Mockito to work"}, {"owner": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "edited": false, "score": 0, "creation_date": 1463827841, "post_id": 37360255, "comment_id": 62237576, "body": "Ya, open settingDependentObject, makes the things work great. Thanks!"}], "tags": [], "owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "is_accepted": true, "score": 15, "last_activity_date": 1463825942, "last_edit_date": 1463825942, "creation_date": 1463816567, "answer_id": 37360255, "question_id": 37359648, "link": "https://stackoverflow.com/questions/37359648/parameter-specified-as-non-null-is-null-when-using-mokito-anyobject-on-kotlin/37360255#37360255", "title": "Parameter specified as non-null is null when using Mokito anyObject() on Kotlin function", "body": "<p>By default Kotlin <strong><a href=\"https://kotlinlang.org/docs/reference/classes.html#wait-how-will-i-hack-my-libraries-now\" rel=\"noreferrer\">classes and members are final</a></strong>. Mockito <a href=\"https://github.com/mockito/mockito/wiki/FAQ#what-are-the-limitations-of-mockito\" rel=\"noreferrer\">cannot mock final classes or methods</a>. \nThus when you write:</p>\n\n<pre><code>verify(injectedObject).settingDependentObject(anyObject())\n</code></pre>\n\n<p>the <strong>real implementation is called</strong> which requires non null argument.</p>\n\n<p>To fix that either <strong>open your class and method</strong> or, even better, change <code>SimpleClass</code> to accept an interface as its constructor argument and mock the interface instead.</p>\n"}, {"tags": [], "owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "is_accepted": false, "score": 1, "last_activity_date": 1473243755, "creation_date": 1473243755, "answer_id": 39367295, "question_id": 37359648, "link": "https://stackoverflow.com/questions/37359648/parameter-specified-as-non-null-is-null-when-using-mokito-anyobject-on-kotlin/39367295#39367295", "title": "Parameter specified as non-null is null when using Mokito anyObject() on Kotlin function", "body": "<p>There is a project specifically to help deal with Kotlin \"closed by default\" in unit testing with Mockito.  For JUNIT, you can use the <a href=\"https://github.com/dpreussler/kotlin-testrunner\" rel=\"nofollow\">kotlin-testrunner</a> which is an easy way to make any Kotlin test automatically open up classes for testing as they are loaded by the classloader.  Usage is simple, just add one annotation of <code>@RunWith(KotlinTestRunner::class)</code>, for example:</p>\n\n\n\n<pre><code>@RunWith(KotlinTestRunner::class)\nclass MyKotlinTestclass {\n   @Test \n   fun test() {\n   ...\n   }\n}\n</code></pre>\n\n<p>This is thoroughly covered in the article <a href=\"https://medium.com/@dpreussler/never-say-final-mocking-kotlin-classes-in-unit-tests-314d275b82b1\" rel=\"nofollow\">Never say final: mocking Kotlin classes in unit tests</a></p>\n\n<p>This covers your use case in an automatic way by allowing all classes to be mocked that otherwise would not be allowed.</p>\n"}, {"tags": [], "owner": {"reputation": 1239, "user_id": 1544211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc45c86b58b06eb5af34ec1891f2cc68?s=128&d=identicon&r=PG", "display_name": "fast3r", "link": "https://stackoverflow.com/users/1544211/fast3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1525340889, "creation_date": 1525340889, "answer_id": 50151947, "question_id": 37359648, "link": "https://stackoverflow.com/questions/37359648/parameter-specified-as-non-null-is-null-when-using-mokito-anyobject-on-kotlin/50151947#50151947", "title": "Parameter specified as non-null is null when using Mokito anyObject() on Kotlin function", "body": "<p>I ran into the same issue with Mockito when using <code>RETURNS_DEEP_STUBS</code>. It seems like nulls are still returned for nested objects, even when using the <code>kotlin-allopen</code> plugin.</p>\n\n<p>Please check out and comment on <a href=\"https://github.com/mockito/mockito/issues/1334\" rel=\"nofollow noreferrer\">this issue</a> on Mockito if you're having the same problem.</p>\n"}, {"tags": [], "owner": {"reputation": 391, "user_id": 7668027, "user_type": "registered", "profile_image": "https://graph.facebook.com/896211070521120/picture?type=large", "display_name": "Kyriakos Georgiopoulos", "link": "https://stackoverflow.com/users/7668027/kyriakos-georgiopoulos"}, "is_accepted": false, "score": 0, "last_activity_date": 1590255702, "creation_date": 1590255702, "answer_id": 61976142, "question_id": 37359648, "link": "https://stackoverflow.com/questions/37359648/parameter-specified-as-non-null-is-null-when-using-mokito-anyobject-on-kotlin/61976142#61976142", "title": "Parameter specified as non-null is null when using Mokito anyObject() on Kotlin function", "body": "<p>You can use this function instead </p>\n\n<pre><code>inline fun &lt;reified T : Any&gt; any(): T = Mockito.any(T::class.java) ?: T::class.java.newInstance()\n</code></pre>\n"}], "owner": {"reputation": 29751, "user_id": 3286489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/yTcB3.png?s=128&g=1", "display_name": "Elye", "link": "https://stackoverflow.com/users/3286489/elye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6736, "favorite_count": 1, "accepted_answer_id": 37360255, "answer_count": 4, "score": 12, "last_activity_date": 1590255702, "creation_date": 1463812105, "last_edit_date": 1495542290, "question_id": 37359648, "link": "https://stackoverflow.com/questions/37359648/parameter-specified-as-non-null-is-null-when-using-mokito-anyobject-on-kotlin", "title": "Parameter specified as non-null is null when using Mokito anyObject() on Kotlin function", "body": "<p>My code as below, refering to the solution in <a href=\"https://stackoverflow.com/a/30308199/3286489\">https://stackoverflow.com/a/30308199/3286489</a></p>\n\n<pre><code>import org.mockito.Mock\nimport org.mockito.Mockito\nimport org.mockito.MockitoAnnotations\nimport org.mockito.Mockito.*\n\nclass SimpleClassTest {\n\n    private fun &lt;T&gt; anyObject(): T {\n        Mockito.anyObject&lt;T&gt;()\n        return uninitialized()\n    }\n\n    private fun &lt;T&gt; uninitialized(): T = null as T\n    lateinit var simpleObject: SimpleClass\n    @Mock lateinit var injectedObject: InjectedClass\n\n\n    @Before\n    fun setUp() {\n        MockitoAnnotations.initMocks(this)\n    }\n\n    @Test\n    fun testSimpleFunction() {\n        simpleObject = SimpleClass(injectedObject)\n\n        verify(injectedObject).settingDependentObject(anyObject())\n\n    }\n}\n</code></pre>\n\n<p>I still have the below error</p>\n\n<pre><code>java.lang.IllegalArgumentException: Parameter specified as non-null is null: method my.package.InjectedClass.settingDependentObject, parameter dependentObject\n</code></pre>\n\n<p>Did I miss anything?</p>\n\n<p><strong>UPDATED</strong>\nBelow is the code tested (simplest form and working)</p>\n\n<pre><code>class SimpleClass(val injectedClass: InjectedClass) {\n\n    fun simpleFunction() {\n        injectedClass.settingDependentObject(DependentClass(Response.Builder().build()))\n    }\n}\n\nopen class DependentClass(response: Response) {\n\n}\n\nopen class InjectedClass() {\n    lateinit var dependentObject: DependentClass\n\n    fun settingDependentObject(dependentObject: DependentClass) {\n        this.dependentObject = dependentObject\n    }\n}\n</code></pre>\n"}, {"tags": ["android-studio", "kotlin", "kotlin-android-extensions"], "comments": [{"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "edited": false, "score": 0, "creation_date": 1463811670, "post_id": 37358976, "comment_id": 62233514, "body": "Do you see any error message in logcat logs?"}, {"owner": {"reputation": 381, "user_id": 6162031, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c2087196e379c933f145a94453e5e592?s=128&d=identicon&r=PG&f=1", "display_name": "MLev", "link": "https://stackoverflow.com/users/6162031/mlev"}, "reply_to_user": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "edited": false, "score": 0, "creation_date": 1463891195, "post_id": 37358976, "comment_id": 62253206, "body": "Hi miensol, I added a number of the debugging messages in the edited description above.  The main issues appear to be:  (1) Execution failed for task &#39;:app:compileDebugKotlin&#39;, (2) unresolved reference: kotlinx e:, and (3) unresolved reference: message."}, {"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "edited": false, "score": 0, "creation_date": 1463899125, "post_id": 37358976, "comment_id": 62254502, "body": "The paste log clearly shows that there&#39;s a compilation error, that&#39;s the first thing to resolve. Try <a href=\"http://stackoverflow.com/questions/34169562/unresolved-reference-kotlinx\">this</a> and let us know if it helped."}, {"owner": {"reputation": 9688, "user_id": 1402641, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/befad7c8ccbe09dc47c507242d3744cd?s=128&d=identicon&r=PG", "display_name": "Marcin Kozi\u0144ski", "link": "https://stackoverflow.com/users/1402641/marcin-kozi%c5%84ski"}, "edited": false, "score": 0, "creation_date": 1463943224, "post_id": 37358976, "comment_id": 62267780, "body": "Can you paste your top level <code>build.gradle</code> file? The one where you have a <code>buildscript {}</code> block."}, {"owner": {"reputation": 381, "user_id": 6162031, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c2087196e379c933f145a94453e5e592?s=128&d=identicon&r=PG&f=1", "display_name": "MLev", "link": "https://stackoverflow.com/users/6162031/mlev"}, "reply_to_user": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "edited": false, "score": 1, "creation_date": 1464061607, "post_id": 37358976, "comment_id": 62316159, "body": "@miensol, I updated the build.gradle files based on the link you provided and updated all of the outputs from the output of re-running the app.  There still appears to be a compilation error unfortunately.  Thanks for your help with this."}], "answers": [{"comments": [{"owner": {"reputation": 381, "user_id": 6162031, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c2087196e379c933f145a94453e5e592?s=128&d=identicon&r=PG&f=1", "display_name": "MLev", "link": "https://stackoverflow.com/users/6162031/mlev"}, "edited": false, "score": 0, "creation_date": 1465170792, "post_id": 37622405, "comment_id": 62775946, "body": "This worked perfectly, thanks!  I will also edit the versions of the build files above as well for future reference."}], "tags": [], "owner": {"reputation": 106, "user_id": 256513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ead21847a76f1cb5acba23413add58f3?s=128&d=identicon&r=PG", "display_name": "hleb", "link": "https://stackoverflow.com/users/256513/hleb"}, "is_accepted": true, "score": 8, "last_activity_date": 1507734511, "last_edit_date": 1507734511, "creation_date": 1464983733, "answer_id": 37622405, "question_id": 37358976, "link": "https://stackoverflow.com/questions/37358976/kotlin-android-app-compilation-failed-with-message-unresolved-reference-kotlin/37622405#37622405", "title": "Kotlin Android App compilation failed with message: Unresolved reference: kotlinx", "body": "<p>See the following response: <a href=\"https://stackoverflow.com/a/36526153/256513\">https://stackoverflow.com/a/36526153/256513</a></p>\n\n<p>You need to move the kotlin buildscript section from your <strong>project</strong> <code>build.gradle</code> to your <strong>module</strong> <code>build.gradle</code> file. </p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2306383"}, "is_accepted": false, "score": -3, "last_activity_date": 1498807218, "last_edit_date": 1498807218, "creation_date": 1498806127, "answer_id": 44840495, "question_id": 37358976, "link": "https://stackoverflow.com/questions/37358976/kotlin-android-app-compilation-failed-with-message-unresolved-reference-kotlin/44840495#44840495", "title": "Kotlin Android App compilation failed with message: Unresolved reference: kotlinx", "body": "<p>import the layout file from a R extension.\nlike this</p>\n\n<pre><code>import kotlindemo.app.com.myapplication.R.layout.activity_main;\nimport kotlinx.android.synthetic.main.activity_main.*\n</code></pre>\n"}], "owner": {"reputation": 381, "user_id": 6162031, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c2087196e379c933f145a94453e5e592?s=128&d=identicon&r=PG&f=1", "display_name": "MLev", "link": "https://stackoverflow.com/users/6162031/mlev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22760, "favorite_count": 2, "accepted_answer_id": 37622405, "answer_count": 2, "score": 4, "last_activity_date": 1507734511, "creation_date": 1463805787, "last_edit_date": 1465170978, "question_id": 37358976, "link": "https://stackoverflow.com/questions/37358976/kotlin-android-app-compilation-failed-with-message-unresolved-reference-kotlin", "title": "Kotlin Android App compilation failed with message: Unresolved reference: kotlinx", "body": "<p>I am testing out a basic Kotlin-based Android app based on the instructions in the \"Kotlin for Android Developers\" book.  I am using Android Studio 2.1.1. </p>\n\n<p>I have the following build.grade (Project: WeatherApp) setup:    </p>\n\n<pre><code>allprojects {\n    repositories {\n        jcenter()\n    }\n}\n\ntask clean(type: Delete) {\n    delete rootProject.buildDir\n}\n</code></pre>\n\n<p>I have the following build.grade (Module:App) setup:</p>\n\n<pre><code>apply plugin: 'com.android.application'\napply plugin: 'kotlin-android'\napply plugin: 'kotlin-android-extensions'\n\nbuildscript {\n    ext.support_version = '23.1.1'\n    ext.kotlin_version = '1.0.2'\n    ext.anko_version = '0.8.2'\n    repositories {\n        jcenter()\n    }\n    dependencies {\n        classpath 'com.android.tools.build:gradle:2.1.0'\n        classpath \"org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version\"\n        classpath \"org.jetbrains.kotlin:kotlin-android-extensions:$kotlin_version\"\n        // NOTE: Do not place your application dependencies here; they belong\n        // in the individual module build.gradle files\n    }\n}\n\nandroid {\n    compileSdkVersion 23\n    buildToolsVersion \"23.0.1\"\n\n    defaultConfig {\n        applicationId \"com.qtimemedia.weatherapp\"\n        minSdkVersion 15\n        targetSdkVersion 23\n        versionCode 1\n        versionName \"1.0\"\n    }\n    buildTypes {\n        release {\n            minifyEnabled false\n            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'\n        }\n    }\n    sourceSets {\n        main.java.srcDirs += 'src/main/kotlin'\n    }\n}\n\ndependencies {\n    compile fileTree(dir: 'libs', include: ['*.jar'])\n    testCompile 'junit:junit:4.12'\n    compile 'com.android.support:appcompat-v7:23.4.0'\n    compile 'org.jetbrains.anko:anko-sdk23:0.8.3'\n    compile 'org.jetbrains.anko:anko-appcompat-v7:0.8.3'\n    compile \"org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version\"\n}\nrepositories {\n    mavenCentral()\n}\n</code></pre>\n\n<p>I have the following MainActivity.kt code:</p>\n\n<pre><code>package com.qtimemedia.weatherapp\n\nimport android.support.v7.app.AppCompatActivity\nimport android.os.Bundle\nimport kotlinx.android.synthetic.main.activity_main.*\n\nclass MainActivity : AppCompatActivity() {\n\n    override fun onCreate(savedInstanceState: Bundle?) {\n        super.onCreate(savedInstanceState)\n        setContentView(R.layout.activity_main)\n        message.text = \"Hello Kotlin!\"\n    }\n}\n</code></pre>\n\n<p>Here is my activity_main.xml code:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    xmlns:tools=\"http://schemas.android.com/tools\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"\n    android:paddingBottom=\"@dimen/activity_vertical_margin\"\n    android:paddingLeft=\"@dimen/activity_horizontal_margin\"\n    android:paddingRight=\"@dimen/activity_horizontal_margin\"\n    android:paddingTop=\"@dimen/activity_vertical_margin\"\n    tools:context=\"com.qtimemedia.weatherapp.MainActivity\"&gt;\n\n    &lt;TextView\n        android:id=\"@+id/message\"\n        android:layout_width=\"wrap_content\"\n        android:layout_height=\"wrap_content\"\n        android:text=\"@string/hello_world\" /&gt;\n&lt;/RelativeLayout&gt;\n</code></pre>\n\n<p>Here is my strings.xml code:</p>\n\n<pre><code>&lt;resources&gt;\n    &lt;string name=\"app_name\"&gt;WeatherApp&lt;/string&gt;\n    &lt;string name=\"hello_world\"&gt;\"Hello World!\"&lt;/string&gt;\n&lt;/resources&gt;\n</code></pre>\n\n<p>I am trying to run my MainActivity using the available Nexus 6 API 23 emulator.  I have the option \"Tools >> Android >> Enable ADB Integration\" checked as on (I tried this with it off as well).  The emulator appears to be working but my app does not appear to be loading due to a failed build. When running the emulator I see the following messages in the \"4: Run\" window:</p>\n\n<pre><code>C:\\Users\\Owner\\AppData\\Local\\Android\\sdk\\tools\\emulator.exe -netdelay none -netspeed full -avd Nexus_6_API_23\nWarning: requested ram_size 1536M too big, reduced to 1024M\nemulator: WARNING: Crash service did not start\nemulator: WARNING: VM heap size set below hardware specified minimum of 384MB\nemulator: WARNING: Setting VM heap size to 384MB\nHax is enabled\nHax ram_size 0x40000000\nHAX is working and emulator runs in fast virt mode.\nconsole on port 5554, ADB on port 5555\n</code></pre>\n\n<p>I see the following in the Event Log window:</p>\n\n<pre><code>11:26:05 PM Gradle sync started\n11:26:15 PM Gradle sync completed\n11:26:16 PM Executing tasks: [:app:generateDebugSources, :app:generateDebugAndroidTestSources, :app:mockableAndroidJar, :app:prepareDebugUnitTestDependencies]\n11:26:34 PM Gradle build finished in 18s 266ms\n11:35:55 PM Executing tasks: [:app:clean, :app:generateDebugSources, :app:generateDebugAndroidTestSources, :app:mockableAndroidJar, :app:prepareDebugUnitTestDependencies, :app:assembleDebug]\n11:39:04 PM Gradle build finished with 3 error(s) in 3m 8s 551ms\n</code></pre>\n\n<p>I see the following in the Gradle Console window:</p>\n\n<pre><code>e: C:\\Users\\Owner\\AndroidStudioProjects\\WeatherApp\\app\\src\\main\\java\\com\\qtimemedia\\weatherapp\\MainActivity.kt: (5, 8): Unresolved reference: kotlinx\ne: C:\\Users\\Owner\\AndroidStudioProjects\\WeatherApp\\app\\src\\main\\java\\com\\qtimemedia\\weatherapp\\MainActivity.kt: (12, 9): Unresolved reference: message\n\n FAILED\n\nFAILURE: Build failed with an exception.\n\n* What went wrong:\nExecution failed for task ':app:compileDebugKotlin'.\n&gt; Compilation error. See log for more details\n\n* Try:\nRun with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output.\n\nBUILD FAILED\n\nTotal time: 3 mins 5.237 secs\n</code></pre>\n\n<p>In the Messages section I see the following:</p>\n\n<pre><code>C:\\Users\\Owner\\AndroidStudioProjects\\WeatherApp\\app\\src\\main\\java\\com\\qtimemedia\\weatherapp\\MainActivity.kt\nError:(5, 8) Unresolved reference: kotlinx\nError:(12, 9) Unresolved reference: message\nError:Execution failed for task ':app:compileDebugKotlin'.\n&gt; Compilation error. See log for more details\nInformation:BUILD FAILED\nInformation:Total time: 3 mins 5.237 secs\nInformation:3 errors\nInformation:0 warnings\nInformation:See complete output in console\n</code></pre>\n\n<p>How can I get the app to compile properly?</p>\n"}, {"tags": ["operator-overloading", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 8617, "user_id": 638225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df8bebd125339c83eb28e0f9aa48ced1?s=128&d=identicon&r=PG", "display_name": "Christoph Leiter", "link": "https://stackoverflow.com/users/638225/christoph-leiter"}, "edited": false, "score": 0, "creation_date": 1463819403, "post_id": 37340616, "comment_id": 62235321, "body": "That&#39;s a clever trick but personally I wouldn&#39;t recommend doing that. It&#39;s not easy to grasp what&#39;s going on. I would just use <code>add</code> (with multiple arguments) instead of the first <code>configure</code> and <code>apply</code> with <code>add</code> for the second. It&#39;s not really longer and plain simple."}, {"owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "reply_to_user": {"reputation": 8617, "user_id": 638225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df8bebd125339c83eb28e0f9aa48ced1?s=128&d=identicon&r=PG", "display_name": "Christoph Leiter", "link": "https://stackoverflow.com/users/638225/christoph-leiter"}, "edited": false, "score": 0, "creation_date": 1463821075, "post_id": 37340616, "comment_id": 62235733, "body": "@ChristophLeiter Fully agree, still it was a nice exercise :)"}], "tags": [], "owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "is_accepted": true, "score": 2, "last_activity_date": 1463839162, "last_edit_date": 1463839162, "creation_date": 1463729516, "answer_id": 37340616, "question_id": 37338485, "link": "https://stackoverflow.com/questions/37338485/how-to-add-operator-extension-as-a-part-of-context-of-the-specific-class-without/37340616#37340616", "title": "How to add operator extension as a part of context of the specific class without subclassing?", "body": "<p>Using the <a href=\"https://kotlinlang.org/docs/reference/operator-overloading.html#unary-operations\" rel=\"nofollow\"><code>unaryPlus</code></a> operator (<code>+Component</code>) is harder in this context since, as the <em>unary</em> implies, it's a single operand operator (single input). There's a sort of hacky solution though:</p>\n\n<pre><code>class ExtOf&lt;out T : MarkupContainer&gt;(val self: T) {\n    companion object {\n        private val lastConfiguredContainer = ThreadLocal&lt;ExtOf&lt;MarkupContainer&gt;?&gt;()\n\n        fun &lt;T : MarkupContainer&gt; configure(container: T, configurer: ExtOf&lt;T&gt;.() -&gt; Any?): T {\n            val currentLast = lastConfiguredContainer.get()\n            try {\n                val newCurrent = ExtOf(container)\n                lastConfiguredContainer.set(newCurrent)\n                newCurrent.configurer()\n            } finally {\n                lastConfiguredContainer.set(currentLast)\n            }\n            return container\n        }\n    }\n\n    operator fun &lt;T2 : Component&gt; T2.unaryPlus(): T2 {\n        val container = lastConfiguredContainer.get()\n        container!!.self.add(this) //TODO throw a nice exception explaining how ot use the `configure`\n        return this\n    }\n}\n\nfun &lt;T : MarkupContainer&gt; T.configure(configurer: ExtOf&lt;T&gt;.() -&gt; Any?) = ExtOf.configure(this, configurer)\n</code></pre>\n\n<p>The above maintains information about last configured <a href=\"https://ci.apache.org/projects/wicket/apidocs/6.x/org/apache/wicket/MarkupContainer.html\" rel=\"nofollow\"><code>MarkupContainer</code></a> in a <a href=\"https://docs.oracle.com/javase/7/docs/api/java/lang/ThreadLocal.html\" rel=\"nofollow\"><code>ThreadLocal</code></a> private variable that is used to supply the receiver of <a href=\"https://ci.apache.org/projects/wicket/apidocs/6.x/org/apache/wicket/MarkupContainer.html#add(org.apache.wicket.Component...)\" rel=\"nofollow\"><code>add</code></a> method.</p>\n\n<p>You can then write:</p>\n\n<pre><code>class SomePage() : WebPage() {\n    init {\n        configure {\n            +Label(\"someLabel\", \"Some label\")\n\n            +StatelessForm&lt;Unit&gt;(\"someForm\").configure {\n                // StatelessForm{} context\n                +Label(\"fieldLabel\", \"Field label\")\n                +RequiredTextField&lt;Long&gt;(\"someField\")\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>As I mentioned above the solution while works is far from being pretty. It can be confusing (as often overloaded operators are) so I'd advice using the regular <code>add</code> like so:</p>\n\n<pre><code>class SomePage() : WebPage() {\n    init {\n        add(\n            Label(\"someLabel\", \"Some label\"),\n\n            StatelessForm&lt;Unit&gt;(\"someForm\").apply {\n                // StatelessForm{} context\n                add(\n                  Label(\"fieldLabel\", \"Field label\"),\n                  RequiredTextField&lt;Long&gt;(\"someField\")\n                )\n            }\n        }\n    }\n}\n</code></pre>\n\n<p><em>I guess ideally there would be a library similar to <a href=\"https://github.com/Kotlin/anko\" rel=\"nofollow\">anko</a> but for wicket.</em></p>\n"}, {"tags": [], "owner": {"reputation": 1656, "user_id": 1211920, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3f037af7c4795183b297f6fdaeb24922?s=128&d=identicon&r=PG", "display_name": "Igor Wojda", "link": "https://stackoverflow.com/users/1211920/igor-wojda"}, "is_accepted": false, "score": -1, "last_activity_date": 1463730924, "creation_date": 1463730924, "answer_id": 37341079, "question_id": 37338485, "link": "https://stackoverflow.com/questions/37338485/how-to-add-operator-extension-as-a-part-of-context-of-the-specific-class-without/37341079#37341079", "title": "How to add operator extension as a part of context of the specific class without subclassing?", "body": "<p>I believe it's not possible</p>\n\n<p>The problem is that unaryPlus operator fun cannot have any params. You want to use unaryPlus inside MarkupContainer class, but you also want to add component (other class, other reference with technicly could be a param)</p>\n\n<p>The only way I see it could work would be with subclassing (Component subclass MarkupContainer) and unaryPlus perator extension to MarkupContainer</p>\n\n<pre><code>class Label(name: String, b: String) : Component() {}\nopen class MarkupContainer() {\nfun add(component: Component) {\n    println(\"added\" + this)\n}\n}\nopen class Component() : MarkupContainer() {}\nopen class StatelessForm&lt;T&gt;(name: String) : Component()\noperator fun Component.unaryPlus() {\nadd(this)\n}\n\nclass SomePage() : Component() {\ninit {\n    add(Label(\"someLabel\", \"Some label\"))\n    +Label(\"someLabel\", \"Some label\")\n\n    +object : StatelessForm&lt;Unit&gt;(\"someForm\") {\n        init {\n            // StatelessForm{} context\n            +Label(\"fieldLabel\", \"Field label\")\n        }\n    }\n}\n}\n</code></pre>\n"}], "owner": {"reputation": 400, "user_id": 430550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9973ea5ffae7ea669879293a1ab369c1?s=128&d=identicon&r=PG", "display_name": "garkin", "link": "https://stackoverflow.com/users/430550/garkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 3, "accepted_answer_id": 37340616, "answer_count": 2, "score": 4, "last_activity_date": 1463839162, "creation_date": 1463721744, "last_edit_date": 1463804979, "question_id": 37338485, "link": "https://stackoverflow.com/questions/37338485/how-to-add-operator-extension-as-a-part-of-context-of-the-specific-class-without", "title": "How to add operator extension as a part of context of the specific class without subclassing?", "body": "<p>I'm trying to utilize operators for Wicket, which is painfully verbose.</p>\n\n<p>My most wanted feature is to use an unary \"+\" to <code>add()</code> a component.\nBut it will be needed to work inside context of every <code>MarkupContainer</code> descendants. </p>\n\n<p>Use should be like this:</p>\n\n<pre><code>class SomePage() : WebPage() {\n    init {\n        // SomePage{} context\n        +Label(\"someLabel\",\"Some label\") \n        // instead of this.add(Label(\"someLabel\",\"Some label\"))\n        +object : StatelessForm&lt;Unit&gt;(\"someForm\") {\n            init {\n                // StatelessForm{} context\n                +Label(\"fieldLabel\",\"Field label\") \n                +RequiredTextField(\"someField\")\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Is it possible to implement this now without subclassing everything? Some <em>imaginary</em> syntax of what i want:</p>\n\n<pre><code>extend org.apache.wicket.MarkupContainer {\n    operator fun&lt;T: Component&gt; T.unaryPlus():T {\n        // add() is called as a method of a MarkupContainer instance\n        add(this) // this@MarkupContainer.add(this@unaryPlus)\n        return this\n    }\n}\n</code></pre>\n\n<ul>\n<li><a href=\"https://kotlinlang.org/docs/reference/extensions.html\" rel=\"nofollow\">https://kotlinlang.org/docs/reference/extensions.html</a></li>\n<li><a href=\"https://kotlinlang.org/docs/reference/operator-overloading.html\" rel=\"nofollow\">https://kotlinlang.org/docs/reference/operator-overloading.html</a></li>\n</ul>\n"}, {"tags": ["spring", "hibernate", "jpa", "kotlin"], "comments": [{"owner": {"reputation": 32699, "user_id": 202694, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/982e5d5973bcd2be7b77e52ec7dca27c?s=128&d=identicon&r=PG", "display_name": "Pace", "link": "https://stackoverflow.com/users/202694/pace"}, "edited": false, "score": 0, "creation_date": 1463711067, "post_id": 37335779, "comment_id": 62191423, "body": "Are you setting the order property of the Route object before you save it?"}], "answers": [{"tags": [], "owner": {"reputation": 32343, "user_id": 155213, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57bc3e08faeb981ddc81abd1d25c3bf1?s=128&d=identicon&r=PG", "display_name": "miensol", "link": "https://stackoverflow.com/users/155213/miensol"}, "is_accepted": true, "score": 3, "last_activity_date": 1463726935, "last_edit_date": 1495541280, "creation_date": 1463726311, "answer_id": 37339590, "question_id": 37335779, "link": "https://stackoverflow.com/questions/37335779/hibernate-saves-child-entity-with-null-parent-id/37339590#37339590", "title": "Hibernate saves child entity with null parent id", "body": "<p>You're modeling <a href=\"http://docs.jboss.org/hibernate/orm/5.1/userguide/html_single/Hibernate_User_Guide.html#associations-one-to-many-bidirectional\" rel=\"nofollow noreferrer\">bidirectional <code>@OneToMany</code></a> and as shown in the example in the documentation you're responsible for setting the <em>parent</em> value on the <em>child</em> entity:</p>\n\n<pre><code>val order = orderRepository.save(Order(...).apply{\n    ...\n    route = GeoHelpers.placesListToEntities(this, data.places),\n    ...\n})\n\nfun placesListToEntities(order:Order, points: List&lt;PlaceDto&gt;) = points.map {\n    Route(\n        order = order,\n        location = Helpers.geometry(it.location.latitude, it.location.longitude),\n        title = it.title\n    )\n}\n</code></pre>\n\n<p>PS. Since <code>Route</code> is an <a href=\"https://stackoverflow.com/questions/1695930/value-object-or-entity-object-in-my-hibernate-mapping\">entity</a> you could change your model a bit to enforce the constraints on the langauge level i.e:</p>\n\n<pre><code>class Route internal constructor() {\n    lateinit var order: Order\n\n    constructor(order: Order) : this() {\n        this.order = order\n    }\n}\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/questions/32038177/kotlin-with-jpa-default-constructor-hell\">this question</a> for more details.</p>\n"}], "owner": {"reputation": 131, "user_id": 893405, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4649b5a9f1cf23ba00066758632cca4d?s=128&d=identicon&r=PG", "display_name": "Fernando Luiz", "link": "https://stackoverflow.com/users/893405/fernando-luiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1639, "favorite_count": 0, "accepted_answer_id": 37339590, "answer_count": 1, "score": 2, "last_activity_date": 1512022583, "creation_date": 1463701426, "question_id": 37335779, "link": "https://stackoverflow.com/questions/37335779/hibernate-saves-child-entity-with-null-parent-id", "title": "Hibernate saves child entity with null parent id", "body": "<p>Hibernate doesn't want to save IDs for child entities. I have the following tables:</p>\n\n<pre><code>@Entity\n@Table(name = \"ct_orders\")\ndata class Order(\n\n    @Id\n    @Column(name = \"id\")\n    @GeneratedValue(strategy = javax.persistence.GenerationType.IDENTITY)\n    val id: Int = 0,\n\n    @OneToMany(fetch = FetchType.LAZY, cascade = arrayOf(CascadeType.ALL), mappedBy = \"order\")\n    val route: List&lt;Route&gt;? = null,\n\n    ...\n\n)\n\n@Entity\n@Table(name = \"ct_routes\")\n@JsonIgnoreProperties(\"id\", \"order\")\ndata class Route(\n\n    @Id\n    @Column(name = \"id\")\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    val id: Int = 0,\n\n    @Column\n    val location: Point = GeoHelpers.point(),\n\n    @ManyToOne(fetch = FetchType.LAZY)\n    @JoinColumn(name = \"order_id\")\n    val order: Order? = null,\n\n    @Column\n    val title: String = \"\"\n\n)\n</code></pre>\n\n<p>ct_routes saving with null in order_id. Is there some problem with relationships? Or, may be there is something wrong in my code?</p>\n\n<p>Here is the part of code, which saves an Order entity:</p>\n\n<pre><code>val order = orderRepository.save(Order(\n    ...\n    route = GeoHelpers.placesListToEntities(data.places),\n    ...\n))\n\nfun placesListToEntities(points: List&lt;PlaceDto&gt;) = points.map {\n    Route(\n        location = Helpers.geometry(it.location.latitude, it.location.longitude),\n        title = it.title\n    )\n}\n</code></pre>\n"}]