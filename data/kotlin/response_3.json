[{"tags": ["java", "reflection", "metaprogramming", "kotlin"], "comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451557985, "post_id": 28190962, "comment_id": 56831642, "body": "#1 is not an issue, it just has a different name to differentiate between a Java <code>Class</code> object and an enhanced Kotlin flavour that has some enhanced functionality <code>KClass</code>."}], "answers": [{"comments": [{"owner": {"reputation": 18616, "user_id": 421372, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/c81e22a8a22d02e036ff00a9bbd2802b?s=128&d=identicon&r=PG", "display_name": "Ragunath Jawahar", "link": "https://stackoverflow.com/users/421372/ragunath-jawahar"}, "edited": false, "score": 0, "creation_date": 1422509524, "post_id": 28194768, "comment_id": 44780285, "body": "Andrey, 1) the library works with private fields all the time. 2) In Kotlin, there&#39;s no way to declare fields - then why am I getting fields when I use reflection?"}, {"owner": {"reputation": 20424, "user_id": 445715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3824489df267d3bf86bbc678b9745ac4?s=128&d=identicon&r=PG", "display_name": "Andrey Breslav", "link": "https://stackoverflow.com/users/445715/andrey-breslav"}, "reply_to_user": {"reputation": 18616, "user_id": 421372, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/c81e22a8a22d02e036ff00a9bbd2802b?s=128&d=identicon&r=PG", "display_name": "Ragunath Jawahar", "link": "https://stackoverflow.com/users/421372/ragunath-jawahar"}, "edited": false, "score": 0, "creation_date": 1422524960, "post_id": 28194768, "comment_id": 44787191, "body": "Fields being not exposed on the language level doesn&#39;t mean that classes do not store any data at all. When Kotlin compiles properties to Java byte code, it creates a field + getter (and maybe setter)."}], "tags": [], "owner": {"reputation": 20424, "user_id": 445715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3824489df267d3bf86bbc678b9745ac4?s=128&d=identicon&r=PG", "display_name": "Andrey Breslav", "link": "https://stackoverflow.com/users/445715/andrey-breslav"}, "is_accepted": true, "score": 5, "last_activity_date": 1422455455, "creation_date": 1422455455, "answer_id": 28194768, "question_id": 28190962, "link": "https://stackoverflow.com/questions/28190962/kotlin-reflection-interoperability-with-java/28194768#28194768", "title": "Kotlin reflection interoperability with Java", "body": "<blockquote>\n  <p>For example, I have an existing library that uses reflection and it works well with Java. However, when I use the same with Kotlin, my reflective code doesn't seem to pick up the annotations on fields.</p>\n</blockquote>\n\n<p>Can it be because the fields are private now?</p>\n\n<p>Anyway, there are issues with annotations on fields at the moment, this will be fixed in on of the upcoming milestones.</p>\n\n<p>Some other relevant issues:</p>\n\n<ul>\n<li><a href=\"https://youtrack.jetbrains.com/issue/KT-5967\" rel=\"noreferrer\">https://youtrack.jetbrains.com/issue/KT-5967</a></li>\n<li><a href=\"https://youtrack.jetbrains.com/issue/KT-4169\" rel=\"noreferrer\">https://youtrack.jetbrains.com/issue/KT-4169</a></li>\n<li><a href=\"https://youtrack.jetbrains.com/issue/KT-3625\" rel=\"noreferrer\">https://youtrack.jetbrains.com/issue/KT-3625</a></li>\n</ul>\n\n<blockquote>\n  <p>I'm unable to use the .class facility or the .getClass() method in Kotlin as we do in Java.</p>\n</blockquote>\n\n<p>Only the syntax is different: <code>javaClass&lt;C&gt;()</code> works exactly the same as <code>C.class</code>, and <code>x.javaClass</code> does the same thing as <code>x.getClass()</code></p>\n\n<blockquote>\n  <p>When I use delegated properties in a Kotlin class, the properties that I retrieve have the $delegate suffix.</p>\n</blockquote>\n\n<p>Minor correction: the <em>fields</em> have the <code>$delegate</code> suffix, not the properties.</p>\n\n<blockquote>\n  <p>However, with delegates I see that most of the methods retain their behavior as they do in Java. Are there any other differences that I have to be aware of?</p>\n</blockquote>\n\n<p>The docs <a href=\"http://kotlinlang.org/docs/reference/delegated-properties.html\" rel=\"noreferrer\">here</a> give you a detailed description of how delegated properties are implemented.</p>\n\n<blockquote>\n  <p>Making Java and Kotlin interoperable for me would require understanding about 1 discussed above, plus other limitations / differences that Kotlin brings to meta-programming.</p>\n</blockquote>\n\n<p>The more your Kotlin code resembles Java code, the smaller is the difference from the reflection point of view. If you write idiomatic Kotlin, e.g. use default parameter values, traits, properties, delegates, top-level functions, extensions etc, the classes you get differ from idiomatic Java, otherwise they are closely aligned.</p>\n"}], "owner": {"reputation": 18616, "user_id": 421372, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/c81e22a8a22d02e036ff00a9bbd2802b?s=128&d=identicon&r=PG", "display_name": "Ragunath Jawahar", "link": "https://stackoverflow.com/users/421372/ragunath-jawahar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3446, "favorite_count": 0, "accepted_answer_id": 28194768, "answer_count": 1, "score": 3, "last_activity_date": 1422455455, "creation_date": 1422444051, "question_id": 28190962, "link": "https://stackoverflow.com/questions/28190962/kotlin-reflection-interoperability-with-java", "title": "Kotlin reflection interoperability with Java", "body": "<p>What are the caveats that a developer should be aware of while writing reflective code that works both with Java and Kotlin?</p>\n\n<p>For example, I have an existing library that uses reflection and it works well with Java. However, when I use the same with Kotlin, my reflective code doesn't seem to pick up the annotations on fields.</p>\n\n<p>Here are some of the differences that I noticed.</p>\n\n<p><strong>1. Acquiring a Class instance</strong></p>\n\n<pre><code>// Example 1.1 - Java\nClass&lt;?&gt; userClass = User.class;         // From a class name\nuserClass = userInstance.getClass();     // OR from an instance\n</code></pre>\n\n<p>Getting a Java class instance in Kotlin</p>\n\n<pre><code>// Example 1.2 - Kotlin\nval userClass = userInstance.javaClass   // From an instance\n</code></pre>\n\n<p>I'm unable to use the <code>.class</code> facility or the <code>.getClass()</code> method in Kotlin as we do in Java.</p>\n\n<p><strong>2. Delegates</strong></p>\n\n<p>When I use delegated properties in a Kotlin class, the properties that I retrieve have the <code>$delegate</code> suffix. This is a bit contrary to the fields that we get in Java (I do understand Kotlin does not have fields, only properties). How does this affect meta-programming?</p>\n\n<p>However, with delegates I see that most of the methods retain their behavior as they do in Java. Are there any other differences that I have to be aware of?</p>\n\n<p>Making Java and Kotlin interoperable for me would require understanding about <strong>1</strong> discussed above, plus other limitations / differences that Kotlin brings to meta-programming.</p>\n"}, {"tags": ["kotlin", "kotlin-js"], "answers": [{"comments": [{"owner": {"reputation": 163, "user_id": 4494699, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-v6zJdYxVp6A/AAAAAAAAAAI/AAAAAAAAACg/YirD1v-gJJM/photo.jpg?sz=128", "display_name": "John Abraham", "link": "https://stackoverflow.com/users/4494699/john-abraham"}, "edited": false, "score": 0, "creation_date": 1422285403, "post_id": 28150862, "comment_id": 44677246, "body": "thanks for quick reply first solution may work but it is not flexible i mean it is hard coded value and i am getting some errors  as well you can check it. 2nd solution creates Kotlin.createObject(.....) on javascript side i can&#39;t pass this to node.js this doesn&#39;t work"}, {"owner": {"reputation": 2883, "user_id": 2583765, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5e54eb8bd99cabcd824ddb09367efb4d?s=128&d=identicon&r=PG&f=1", "display_name": "birgersp", "link": "https://stackoverflow.com/users/2583765/birgersp"}, "edited": false, "score": 0, "creation_date": 1510669976, "post_id": 28150862, "comment_id": 81526834, "body": "2017 calling, trying to do the same as OP. is this answer outdated?"}, {"owner": {"reputation": 6493, "user_id": 1020900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab5f80978d59af0204e0986ca41d2c23?s=128&d=identicon&r=PG", "display_name": "bashor", "link": "https://stackoverflow.com/users/1020900/bashor"}, "reply_to_user": {"reputation": 2883, "user_id": 2583765, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5e54eb8bd99cabcd824ddb09367efb4d?s=128&d=identicon&r=PG&f=1", "display_name": "birgersp", "link": "https://stackoverflow.com/users/2583765/birgersp"}, "edited": false, "score": 0, "creation_date": 1521981045, "post_id": 28150862, "comment_id": 85954175, "body": "@gromit190 the answer looks like actual, please let me know if you have any problem with it."}], "tags": [], "owner": {"reputation": 6493, "user_id": 1020900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab5f80978d59af0204e0986ca41d2c23?s=128&d=identicon&r=PG", "display_name": "bashor", "link": "https://stackoverflow.com/users/1020900/bashor"}, "is_accepted": true, "score": 22, "last_activity_date": 1422296857, "last_edit_date": 1422296857, "creation_date": 1422278385, "answer_id": 28150862, "question_id": 28150124, "link": "https://stackoverflow.com/questions/28150124/javascript-anonymous-object-in-kotlin/28150862#28150862", "title": "javascript anonymous object in kotlin", "body": "<p>Possible solutions:</p>\n\n<p>1) with <code>js</code> function:</p>\n\n<pre><code>val header = js(\"({'content-type':'text/plain' , 'content-length' : 50 ...})\") \n</code></pre>\n\n<p>note: the parentheses are mandatory</p>\n\n<p>2) with <code>dynamic</code>:</p>\n\n<pre><code>val d: dynamic = object{}\nd[\"content-type\"] = \"text/plain\"\nd[\"content-length\"] = 50\n</code></pre>\n\n<p>3) with <code>js</code> + <code>dynamic</code>:</p>\n\n<pre><code>val d = js(\"({})\")\nd[\"content-type\"] = \"text/plain\"\nd[\"content-length\"] = 50\n</code></pre>\n\n<p>4) with native declaration:</p>\n\n<pre><code>native\nclass Object {\n  nativeGetter\n  fun get(prop: String): dynamic = noImpl\n\n  nativeSetter\n  fun set(prop: String, value: dynamic) {}\n}\n\nfun main(args : Array&lt;String&gt;) {\n  var o = Object()\n  o[\"content-type\"] = \"text/plain\"\n  o[\"content-length\"] = 50\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 1, "creation_date": 1451558072, "post_id": 28169605, "comment_id": 56831683, "body": "is this &quot;possible&quot; or does it work and do the same thing?"}, {"owner": {"reputation": 111, "user_id": 540610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42ff3a8fe6671a9249603cefdb9b9e5a?s=128&d=identicon&r=PG", "display_name": "Sharp", "link": "https://stackoverflow.com/users/540610/sharp"}, "reply_to_user": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451921529, "post_id": 28169605, "comment_id": 56934217, "body": "Thanks @JaysonMinard, I fixed my answer."}], "tags": [], "owner": {"reputation": 111, "user_id": 540610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42ff3a8fe6671a9249603cefdb9b9e5a?s=128&d=identicon&r=PG", "display_name": "Sharp", "link": "https://stackoverflow.com/users/540610/sharp"}, "is_accepted": false, "score": 6, "last_activity_date": 1451921450, "last_edit_date": 1451921450, "creation_date": 1422358762, "answer_id": 28169605, "question_id": 28150124, "link": "https://stackoverflow.com/questions/28150124/javascript-anonymous-object-in-kotlin/28169605#28169605", "title": "javascript anonymous object in kotlin", "body": "<p><s>\nOne more possible solution: </p>\n\n<pre><code>object {\n        val `content-type` = \"text/plain\"\n        val `content-length` = 50\n}\n</code></pre>\n\n<p></s>\nIt seems that it does not work anymore with escaped variable names.</p>\n"}, {"comments": [{"owner": {"reputation": 5291, "user_id": 5279156, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vHs51.jpg?s=128&g=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/5279156/vlad"}, "edited": false, "score": 0, "creation_date": 1582443907, "post_id": 36307953, "comment_id": 106774836, "body": "<code>Object()</code> may be replaced with <code>js(&quot;{}&quot;)</code>"}, {"owner": {"reputation": 5291, "user_id": 5279156, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vHs51.jpg?s=128&g=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/5279156/vlad"}, "edited": false, "score": 0, "creation_date": 1582444654, "post_id": 36307953, "comment_id": 106774966, "body": "This is the same and shorter <code>fun jsObject(init: dynamic.() -&gt; Unit) = js(&quot;{}&quot;).apply(init)</code>"}], "tags": [], "owner": {"reputation": 1058, "user_id": 320456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b2c8c956e2e8f57f70aa11bd6f7b81?s=128&d=identicon&r=PG", "display_name": "HughG", "link": "https://stackoverflow.com/users/320456/hughg"}, "is_accepted": false, "score": 1, "last_activity_date": 1582444023, "last_edit_date": 1582444023, "creation_date": 1459338563, "answer_id": 36307953, "question_id": 28150124, "link": "https://stackoverflow.com/questions/28150124/javascript-anonymous-object-in-kotlin/36307953#36307953", "title": "javascript anonymous object in kotlin", "body": "<p>I'm a Kotlin newbie (though not a newbie developer), I slightly extended answer  from @bashor to something looks neater for keys which are valid Java identifiers, but still allows ones which aren't.  I tested it with Kotlin 1.0.1.</p>\n\n<pre><code>@JsName(\"Object\")\nopen class Object {\n}\n\nfun jsobject(init: dynamic.() -&gt; Unit): dynamic {\n    return Object().apply(init)\n}\n\nheader = jsobject {\n    validJavaIdentifier = 0.2\n    this[\"content-type\"] = \"text/plain\"\n    this[\"content-length\"] = 50\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1138, "user_id": 7644072, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212309749595897/picture?type=large", "display_name": "Robbie Cronin", "link": "https://stackoverflow.com/users/7644072/robbie-cronin"}, "edited": false, "score": 0, "creation_date": 1552464480, "post_id": 47380123, "comment_id": 97014406, "body": "this is the only one that worked for me, lifesaver!"}, {"owner": {"reputation": 985, "user_id": 8505024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lSflM.png?s=128&g=1", "display_name": "iHad 169", "link": "https://stackoverflow.com/users/8505024/ihad-169"}, "edited": false, "score": 0, "creation_date": 1595348601, "post_id": 47380123, "comment_id": 111441055, "body": "The return Type can &quot;dynamic&quot; to &quot;Json&quot;. e.g. inline fun jsObject(init: dynamic.() -&gt; Unit): Json {}  This will more than safe."}], "tags": [], "owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "is_accepted": false, "score": 9, "last_activity_date": 1511114264, "creation_date": 1511114264, "answer_id": 47380123, "question_id": 28150124, "link": "https://stackoverflow.com/questions/28150124/javascript-anonymous-object-in-kotlin/47380123#47380123", "title": "javascript anonymous object in kotlin", "body": "<p>Here's a helper function to initialize an object with a lambda syntax</p>\n\n<pre><code>inline fun jsObject(init: dynamic.() -&gt; Unit): dynamic {\n    val o = js(\"{}\")\n    init(o)\n    return o\n}\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>jsObject {\n    foo = \"bar\"\n    baz = 1\n}\n</code></pre>\n\n<p>Emited javascript code</p>\n\n<pre><code>var o = {};\no.foo = 'bar';\no.baz = 1;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2197, "user_id": 799849, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c2a64fda2c076abba0de85a650e7a8e3?s=128&d=identicon&r=PG", "display_name": "eyelash", "link": "https://stackoverflow.com/users/799849/eyelash"}, "is_accepted": false, "score": 0, "last_activity_date": 1575402178, "last_edit_date": 1575402178, "creation_date": 1575331939, "answer_id": 59148463, "question_id": 28150124, "link": "https://stackoverflow.com/questions/28150124/javascript-anonymous-object-in-kotlin/59148463#59148463", "title": "javascript anonymous object in kotlin", "body": "<p>Here is another solution:<br>\nDefine the following helper function</p>\n\n<pre><code>fun jsObject(vararg pairs: Pair&lt;Any, Any&gt;): dynamic {\n    val result = js(\"({})\")\n    for ((key, value) in pairs) {\n        result[key] = value\n    }\n    return result\n}\n</code></pre>\n\n<p>You can then use it as follows</p>\n\n<pre><code>val header = jsObject(\"content-type\" to \"text/plain\", \"content-length\" to 50)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 331, "user_id": 10928439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3f96adfa5034912960b1ee84fb06923?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Jacobs", "link": "https://stackoverflow.com/users/10928439/simon-jacobs"}, "is_accepted": false, "score": 0, "last_activity_date": 1589164739, "creation_date": 1589164739, "answer_id": 61721444, "question_id": 28150124, "link": "https://stackoverflow.com/questions/28150124/javascript-anonymous-object-in-kotlin/61721444#61721444", "title": "javascript anonymous object in kotlin", "body": "<p>It is possible to transform a regular Kotlin object into a JavaScript anonymous object using JavaScript's <code>Object.assign()</code>. This allows you to stay in pure Kotlin and in type-safety as long as possible. So:</p>\n\n<pre><code>fun Any.toJsObject(): dynamic {\n    val thisArg = this                       // Allows use in js() function\n    return js(\"Object.assign({},thisArg)\")\n}\n\nval anObject = object { val a = \"a\" }        // Or use a regular class\nconsole.log( anObject.toJsObject().a )       // logs \"a\"\n</code></pre>\n"}], "owner": {"reputation": 163, "user_id": 4494699, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-v6zJdYxVp6A/AAAAAAAAAAI/AAAAAAAAACg/YirD1v-gJJM/photo.jpg?sz=128", "display_name": "John Abraham", "link": "https://stackoverflow.com/users/4494699/john-abraham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4999, "favorite_count": 4, "accepted_answer_id": 28150862, "answer_count": 6, "score": 16, "last_activity_date": 1589164739, "creation_date": 1422275238, "last_edit_date": 1527179008, "question_id": 28150124, "link": "https://stackoverflow.com/questions/28150124/javascript-anonymous-object-in-kotlin", "title": "javascript anonymous object in kotlin", "body": "<p>how to create JavaScript anonymous object in kotlin? i want to create exactly this object to be passed to nodejs app</p>\n\n<pre><code>var header = {\u201ccontent-type\u201d:\u201dtext/plain\u201d , \u201ccontent-length\u201d : 50 ...}\n</code></pre>\n"}]