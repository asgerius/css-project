[{"tags": ["android", "httpurlconnection", "kotlin"], "comments": [{"owner": {"reputation": 2088, "user_id": 3701433, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/wsvfr.jpg?s=128&g=1", "display_name": "Prudhvi", "link": "https://stackoverflow.com/users/3701433/prudhvi"}, "edited": false, "score": 0, "creation_date": 1429717325, "post_id": 29802323, "comment_id": 47732995, "body": "<i>val httpClient = HttpURLConnection()</i> what are you trying to do here? Please explain more."}, {"owner": {"reputation": 6647, "user_id": 709671, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e2589f597920174d08abc0cc4ba5f183?s=128&d=identicon&r=PG", "display_name": "axierjhtjz", "link": "https://stackoverflow.com/users/709671/axierjhtjz"}, "reply_to_user": {"reputation": 2088, "user_id": 3701433, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/wsvfr.jpg?s=128&g=1", "display_name": "Prudhvi", "link": "https://stackoverflow.com/users/3701433/prudhvi"}, "edited": false, "score": 0, "creation_date": 1429717480, "post_id": 29802323, "comment_id": 47733105, "body": "@prudhvi update the question with a example in actual java code."}, {"owner": {"reputation": 2088, "user_id": 3701433, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/wsvfr.jpg?s=128&g=1", "display_name": "Prudhvi", "link": "https://stackoverflow.com/users/3701433/prudhvi"}, "edited": false, "score": 0, "creation_date": 1429717911, "post_id": 29802323, "comment_id": 47733436, "body": "I suggest you to use <b>ApacheHttpClient</b> for network operations. Please see this <a href=\"http://stackoverflow.com/a/28907274/3701433\">answer</a> for more info."}, {"owner": {"reputation": 6647, "user_id": 709671, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e2589f597920174d08abc0cc4ba5f183?s=128&d=identicon&r=PG", "display_name": "axierjhtjz", "link": "https://stackoverflow.com/users/709671/axierjhtjz"}, "reply_to_user": {"reputation": 2088, "user_id": 3701433, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/wsvfr.jpg?s=128&g=1", "display_name": "Prudhvi", "link": "https://stackoverflow.com/users/3701433/prudhvi"}, "edited": false, "score": 0, "creation_date": 1429771746, "post_id": 29802323, "comment_id": 47758702, "body": "@prudhvi it dependes on what version you&#39;re targeting for Gingerbread and onwards HttpUrlConnection it&#180;s the tool you need <a href=\"http://android-developers.blogspot.com.es/2011/09/androids-http-clients.html\" rel=\"nofollow noreferrer\">android-developers.blogspot.com.es/2011/09/&hellip;</a>"}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451942018, "post_id": 29802323, "comment_id": 56945481, "body": "Please update the question to use code instead of a screenshot, and a text version of the error message (when you compiled, you get a text warning you can paste).  Otherwise this question isn&#39;t very searchable.  Images should not speak for words, unless there are no words."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451943255, "post_id": 29802323, "comment_id": 56946108, "body": "I wrote a simplification of your question (without screenshot) and also provided an answer using idiomatic Kotlin:  <a href=\"http://stackoverflow.com/a/34600243/3679676\">stackoverflow.com/a/34600243/3679676</a>  ... the current accepted answer is very large and does not explain what it did to make the fix, but rather shows all related code in the universe."}, {"owner": {"reputation": 6647, "user_id": 709671, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e2589f597920174d08abc0cc4ba5f183?s=128&d=identicon&r=PG", "display_name": "axierjhtjz", "link": "https://stackoverflow.com/users/709671/axierjhtjz"}, "reply_to_user": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1452528418, "post_id": 29802323, "comment_id": 57197718, "body": "@JaysonMinard just changed it to text. Thanks"}, {"owner": {"reputation": 2775, "user_id": 4961126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lV3bU.jpg?s=128&g=1", "display_name": "HAXM", "link": "https://stackoverflow.com/users/4961126/haxm"}, "edited": false, "score": 0, "creation_date": 1588081956, "post_id": 29802323, "comment_id": 108758613, "body": "<a href=\"https://medium.com/@ajay.dewari/connect-android-app-to-the-network-using-httpurlconnection-79a55c8c624e\" rel=\"nofollow noreferrer\">medium.com/@ajay.dewari/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 680, "user_id": 1054120, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/tLsRK.jpg?s=128&g=1", "display_name": "Matt Wenham", "link": "https://stackoverflow.com/users/1054120/matt-wenham"}, "edited": false, "score": 0, "creation_date": 1504643620, "post_id": 34600243, "comment_id": 79086631, "body": "I&#39;m a Kotlin beginner, so please bear with me. The <code>readText</code> documentation states that &quot;It is the caller&#39;s responsibility to close this reader&quot;. Is this untrue? Is your assertion that &quot;this form will auto close everything&quot; correct? I am referring to <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.io/java.io.-reader/read-text.html\" rel=\"nofollow noreferrer\">kotlinlang.org/api/latest/jvm/stdlib/kotlin.io/java.io.-read&zwnj;&#8203;er/&hellip;</a>"}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "reply_to_user": {"reputation": 680, "user_id": 1054120, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/tLsRK.jpg?s=128&g=1", "display_name": "Matt Wenham", "link": "https://stackoverflow.com/users/1054120/matt-wenham"}, "edited": false, "score": 0, "creation_date": 1505337002, "post_id": 34600243, "comment_id": 79377146, "body": "I may have been assuming <code>disconnect()</code> causes the close.  But I don&#39;t remember now, you can always wrap it with <code>use</code> to be sure, or check what <code>disconnect</code> does to any stream opened on the connection."}, {"owner": {"reputation": 22949, "user_id": 6998684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqR2Z.jpg?s=128&g=1", "display_name": "IgorGanapolsky", "link": "https://stackoverflow.com/users/6998684/igorganapolsky"}, "edited": false, "score": 0, "creation_date": 1606929948, "post_id": 34600243, "comment_id": 115114384, "body": "This is not secure, doesn&#39;t use TLS, and won&#39;t run on Android devices."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1607034974, "post_id": 34600243, "comment_id": 115153871, "body": "The answer is to the specific question and that code sample. The author wasn&#39;t really asking an Andoird question as much as a Java question so I fixed the Java code.  If you have an Android specific answer then please add an answer.  You don&#39;t indicate the &quot;Why&quot; of your comment so that doesn&#39;t help."}], "tags": [], "owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "is_accepted": true, "score": 18, "last_activity_date": 1574943100, "last_edit_date": 1574943100, "creation_date": 1451943174, "answer_id": 34600243, "question_id": 29802323, "link": "https://stackoverflow.com/questions/29802323/android-with-kotlin-how-to-use-httpurlconnection/34600243#34600243", "title": "Android with Kotlin - How to use HttpUrlConnection", "body": "<p>Here is a simplification of the question and answer.</p>\n\n<p>Why does this fail?  </p>\n\n\n\n<pre><code>val connection = HttpURLConnection()\nval data = connection.inputStream.bufferedReader().readText()\n// ... do something with \"data\"\n</code></pre>\n\n<p>with error:</p>\n\n<blockquote>\n  <p>Kotlin: Cannot access '': it is 'protected/<em>protected and package</em>/' in 'HttpURLConnection'</p>\n</blockquote>\n\n<p>This fails because you are constructing a class that is not intended to directly be constructed.  It is meant to be created by a factory, which is in the <code>URL</code> class <code>openConnection()</code> method.  This is also not a direct port of the sample Java code in the original question.</p>\n\n<p>The most idiomatic way in Kotlin to open this connection and read the contents as a string would be:</p>\n\n<pre><code>val connection = URL(\"http://www.android.com/\").openConnection() as HttpURLConnection\nval data = connection.inputStream.bufferedReader().readText()\n</code></pre>\n\n<p>This form will auto close everything when done reading the text or on an exception.  If you want to do custom reading:</p>\n\n<pre><code>val connection = URL(\"http://www.android.com/\").openConnection() as HttpURLConnection\nconnection.inputStream.bufferedReader().use { reader -&gt;\n    // ... do something with the reader\n}\n</code></pre>\n\n<p><strong><em>NOTE:</em></strong> <em>the <code>use()</code> extension function will open and close the reader and handle closing on errors automatically.</em></p>\n\n<h2>About the <code>disconnect()</code> method</h2>\n\n<p>The docs for <code>disconnect</code> say:</p>\n\n<blockquote>\n  <p>Each HttpURLConnection instance is used to make a single request\n  but the underlying network connection to the HTTP server may be\n  transparently shared by other instances. Calling the close() methods\n  on the InputStream or OutputStream of an HttpURLConnection\n  after a request may free network resources associated with this\n  instance but has no effect on any shared persistent connection.\n  Calling the disconnect() method may close the underlying socket\n  if a persistent connection is otherwise idle at that time.</p>\n</blockquote>\n\n<p>So you decide if you want to call it or not.  Here is a version of the code that calls disconnect:</p>\n\n<pre><code>val connection = URL(\"http://www.android.com/\").openConnection() as HttpURLConnection\ntry {\n    val data = connection.inputStream.bufferedReader().use { it.readText() }\n    // ... do something with \"data\"\n} finally {\n    connection.disconnect()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 289, "user_id": 10640233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ca9c265002588ad91904687bac3cc8a?s=128&d=identicon&r=PG&f=1", "display_name": "Deniz", "link": "https://stackoverflow.com/users/10640233/deniz"}, "is_accepted": false, "score": 0, "last_activity_date": 1571925483, "creation_date": 1571925483, "answer_id": 58543005, "question_id": 29802323, "link": "https://stackoverflow.com/questions/29802323/android-with-kotlin-how-to-use-httpurlconnection/58543005#58543005", "title": "Android with Kotlin - How to use HttpUrlConnection", "body": "<p>You can adaptaion your code; Don't forget user Runnable thread.</p>\n\n<pre><code>Thread(Runnable {\n            try {\n                val url = URL(\"www.android.com\")\n                val con = url.openConnection() as HttpURLConnection\n\n                val datas = con.inputStream.bufferedReader().readText()\n\n                val json = JSONObject(datas)\n                val blockList = json.getJSONObject(\"blockList\")\n                val warning = json.get(\"warnMessage\").toString()\n                val keys = blockList.keys()\n                var permission = HashMap&lt;String, Array&lt;String?&gt;&gt;()\n\n                while (keys.hasNext()) {\n                    val key = keys.next()\n                    val kods = blockList.getJSONArray(key)\n\n                    val permissonArray = arrayOfNulls&lt;String&gt;(kods.length())\n                    for (i in permissonArray.indices) {\n                        permissonArray[i] = kods.getString(i)\n                    }\n\n\n                    permission[key] = permissonArray;\n\n                }\n\n\n            } catch (ex: Exception) {\n                Log.d(\"Exception\", ex.toString())\n            }\n        }).start()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2775, "user_id": 4961126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lV3bU.jpg?s=128&g=1", "display_name": "HAXM", "link": "https://stackoverflow.com/users/4961126/haxm"}, "is_accepted": false, "score": 3, "last_activity_date": 1588084307, "last_edit_date": 1588084307, "creation_date": 1588083942, "answer_id": 61482596, "question_id": 29802323, "link": "https://stackoverflow.com/questions/29802323/android-with-kotlin-how-to-use-httpurlconnection/61482596#61482596", "title": "Android with Kotlin - How to use HttpUrlConnection", "body": "<p>The simplest way to do a <code>get</code> <code>post</code> request using <code>HTTPUrlConnection</code> is to create a common helper class that can be called from anywhere in the app to call the GET and POST request methods, without writing the same code again and again.</p>\n\n<p>Below is the helper <code>object</code> (Singleton) class that you can use for the network call for GET and POST requests.</p>\n\n<pre><code>package com.dewari.ajay.androidnetworkcommunication.network\n\nimport org.json.JSONObject\nimport java.io.BufferedReader\nimport java.io.BufferedWriter\nimport java.io.IOException\nimport java.io.InputStreamReader\nimport java.io.OutputStream\nimport java.io.OutputStreamWriter\nimport java.net.HttpURLConnection\nimport java.net.URL\nimport java.net.URLEncoder\nimport javax.net.ssl.HttpsURLConnection\n\n\nobject RequestHandler {\n\nconst val GET : String = \"GET\"\nconst val POST : String = \"POST\"\n\n@Throws(IOException::class)\nfun requestPOST(r_url: String?, postDataParams: JSONObject): String? {\n    val url = URL(r_url)\n    val conn: HttpURLConnection = url.openConnection() as HttpURLConnection\n    conn.readTimeout = 3000\n    conn.connectTimeout = 3000\n    conn.requestMethod = POST\n    conn.doInput = true\n    conn.doOutput = true\n    val os: OutputStream = conn.outputStream\n    val writer = BufferedWriter(OutputStreamWriter(os, \"UTF-8\"))\n    writer.write(encodeParams(postDataParams))\n    writer.flush()\n    writer.close()\n    os.close()\n    val responseCode: Int = conn.responseCode // To Check for 200\n    if (responseCode == HttpsURLConnection.HTTP_OK) {\n        val `in` = BufferedReader(InputStreamReader(conn.inputStream))\n        val sb = StringBuffer(\"\")\n        var line: String? = \"\"\n        while (`in`.readLine().also { line = it } != null) {\n            sb.append(line)\n            break\n        }\n        `in`.close()\n        return sb.toString()\n    }\n    return null\n}\n\n@Throws(IOException::class)\nfun requestGET(url: String?): String? {\n    val obj = URL(url)\n    val con = obj.openConnection() as HttpURLConnection\n    con.requestMethod = GET\n    val responseCode = con.responseCode\n    println(\"Response Code :: $responseCode\")\n    return if (responseCode == HttpURLConnection.HTTP_OK) { // connection ok\n        val `in` =\n            BufferedReader(InputStreamReader(con.inputStream))\n        var inputLine: String?\n        val response = StringBuffer()\n        while (`in`.readLine().also { inputLine = it } != null) {\n            response.append(inputLine)\n        }\n        `in`.close()\n        response.toString()\n    } else {\n        \"\"\n    }\n}\n\n@Throws(IOException::class)\nprivate fun encodeParams(params: JSONObject): String? {\n    val result = StringBuilder()\n    var first = true\n    val itr = params.keys()\n    while (itr.hasNext()) {\n        val key = itr.next()\n        val value = params[key]\n        if (first) first = false else result.append(\"&amp;\")\n        result.append(URLEncoder.encode(key, \"UTF-8\"))\n        result.append(\"=\")\n        result.append(URLEncoder.encode(value.toString(), \"UTF-8\"))\n    }\n    return result.toString()\n  }\n}\n</code></pre>\n\n<p>Using the above object class you can do your GET and POST requests as shown below:</p>\n\n<pre><code>//As this is network call it should be done in a separate thread\n                Thread(Runnable {\n                RequestHandler.requestGET(url)\n                RequestHandler.requestPOST(url, postJSONObject)\n            }).start()\n</code></pre>\n\n<p>Instead of using thread you can also use AsyncTask as followed:</p>\n\n<pre><code>    class NetworkAsyncCall(private val context: Context, private val url: String, private val requestType:\nString, private val postJSONObject: JSONObject = JSONObject()\n) : AsyncTask&lt;String?, String?, String?&gt;() {\n\n    override fun doInBackground(vararg p0: String?): String? {\n        return when (requestType) {\n            RequestHandler.GET -&gt; RequestHandler.requestGET(url)\n            RequestHandler.GET -&gt; RequestHandler.requestPOST(url, postJSONObject)\n            else -&gt; \"\"\n        }\n    }\n\n    override fun onPostExecute(s: String?) {\n        if (s != null) {\n            Toast.makeText(context, s, Toast.LENGTH_LONG).show()\n        }\n    }\n}\n</code></pre>\n\n<p>You can create the asyncTask as a inner class of Activity or a seperate indipendent class.</p>\n\n<p>Now to call the newtwork call via the AsyncTask <code>NetworkAsyncCall</code> in your <code>onCreate()</code> or any function from which you want call the api you can write:</p>\n\n<p><strong>NOTE:</strong> The mentioned url will not work so, you have to replace it with your own.</p>\n\n<pre><code>    override fun onCreate(savedInstanceState: Bundle?) {\n    setContentView(R.layout.activity_main)\n\n    // Change the url with your own GET URL request\n    val urlGET = \"http://my-json-feed\"\n    //GET Request\n    NetworkAsyncCall(this@MainActivity, urlGET, RequestHandler.GET).execute();\n\n   //       POST Request\n   //        doPost()\n}\n</code></pre>\n\n<p>For POST request you can call:</p>\n\n<pre><code>    private fun doPost() {\n    // Change the url with your own POST URL request\n    val urlPOST = \"http://my-json-feed\"\n    val postDataParams = JSONObject()\n    postDataParams.put(\"name\", \"Ajay\")\n    postDataParams.put(\"email\", \"aj****ri@gmail.com\")\n    postDataParams.put(\"phone\", \"+91 78******25\")\n    NetworkAsyncCall(this@MainActivity, urlPOST, RequestHandler.POST, postDataParams).execute()\n}\n</code></pre>\n\n<p>you can check the complete code in github <a href=\"https://github.com/ajaydewari/Android-Network-Communication\" rel=\"nofollow noreferrer\">here</a>.\nFor a good explanation you can check this <a href=\"https://medium.com/@ajay.dewari/connect-android-app-to-the-network-using-httpurlconnection-79a55c8c624e\" rel=\"nofollow noreferrer\">link</a>.</p>\n\n<p>the advantage of using the NetworkAsyncCall as seperate indipendent class is you don't have to write the AsyncTask code again, just call the same AsyncTask <code>NetworkAsyncCall</code> with a new object from different activitys/functions, however with this you have to implement a listener interface that you will require for the callback on <code>onPostExecute()</code> after getting the response from the api and to return back the response to the activity you have to perform the callback using that interface.</p>\n"}], "owner": {"reputation": 6647, "user_id": 709671, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e2589f597920174d08abc0cc4ba5f183?s=128&d=identicon&r=PG", "display_name": "axierjhtjz", "link": "https://stackoverflow.com/users/709671/axierjhtjz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19595, "favorite_count": 2, "accepted_answer_id": 34600243, "answer_count": 3, "score": 10, "last_activity_date": 1588084307, "creation_date": 1429716780, "last_edit_date": 1452528379, "question_id": 29802323, "link": "https://stackoverflow.com/questions/29802323/android-with-kotlin-how-to-use-httpurlconnection", "title": "Android with Kotlin - How to use HttpUrlConnection", "body": "<p>I\u00b4m trying to get data from a url inside an <code>AsyncTask</code> but I get an error when creating a new instance of <code>HttpUrlConnection</code>.</p>\n\n<p>Something like this on Java</p>\n\n<pre><code>URL url = new URL(\"http://www.android.com/\");\nHttpURLConnection urlConnection = (HttpURLConnection) url.openConnection();\ntry {\n    InputStream in = new BufferedInputStream(urlConnection.getInputStream());\n    readStream(in);\nfinally {\n    urlConnection.disconnect();\n}\n</code></pre>\n\n<p>But I keep getting the error shown below.</p>\n\n<pre><code>class GetWeatherTask : AsyncTast&lt;Void, Void, Void&gt;() {\n\n    override fun doInBackground(vararg params: Void?): Void? {\n        val httpClient = HttpURLConnection();\n        return null\n    }\n    override fun onPreExecute() {\n        super.onPreExecute()\n    }\n    override fun onPostExecute(result: Void?) {\n        super.onPostExecute(result)\n    }\n}\n</code></pre>\n\n<blockquote>\n  <p>Cannot access '': it is 'protected/<em>protected and package</em>/' in 'HttpURLConnection' Cannot create an instance of an abstract class</p>\n</blockquote>\n\n<p>Am I missing something? I tryied to create a class object extending <code>HttpUrlConnection</code> and try to implement the <code>init</code> method but I couldn't</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["java", "android", "android-support-library", "android-recyclerview", "kotlin"], "comments": [{"owner": {"reputation": 905471, "user_id": 115145, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/wDnd8.png?s=128&g=1", "display_name": "CommonsWare", "link": "https://stackoverflow.com/users/115145/commonsware"}, "edited": false, "score": 1, "creation_date": 1429707069, "post_id": 29798098, "comment_id": 47724393, "body": "If I had to guess, <code>beginBatchedUpdates()</code>, <code>recalculatePositionOfItemAt()</code> (for each item), and <code>endBatchedUpdates()</code>, but that&#39;s just a guess based upon the API."}, {"owner": {"reputation": 70518, "user_id": 2413303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kLhXq.jpg?s=128&g=1", "display_name": "EpicPandaForce", "link": "https://stackoverflow.com/users/2413303/epicpandaforce"}, "reply_to_user": {"reputation": 905471, "user_id": 115145, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/wDnd8.png?s=128&g=1", "display_name": "CommonsWare", "link": "https://stackoverflow.com/users/115145/commonsware"}, "edited": false, "score": 0, "creation_date": 1429707317, "post_id": 29798098, "comment_id": 47724587, "body": "worst case scenario, the <a href=\"http://developer.android.com/reference/android/support/v7/widget/util/SortedListAdapterCallback.html\" rel=\"nofollow noreferrer\">developer.android.com/reference/android/support/v7/widget/ut&zwnj;&#8203;il/&hellip;</a>  callback has methods for when an element is changed, but the right answer is probably @CommonsWare &#39;s answer."}, {"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "edited": false, "score": 0, "creation_date": 1429707359, "post_id": 29798098, "comment_id": 47724622, "body": "That&#39;s not a bad start. But calling recalculatePositionOfItemAt() for every index won&#39;t resort it completely. Indices will change which leads to some items being skipped."}], "answers": [{"tags": [], "owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "is_accepted": false, "score": 2, "last_activity_date": 1429713062, "last_edit_date": 1429713062, "creation_date": 1429708311, "answer_id": 29798656, "question_id": 29798098, "link": "https://stackoverflow.com/questions/29798098/how-to-completely-resort-recyclerviews-sortedlist/29798656#29798656", "title": "How to completely resort RecyclerView&#39;s SortedList", "body": "<p>Here's my own take on it (written in Kotlin):</p>\n\n<pre><code>list.beginBatchedUpdates()\n\nval indices = (0..list.size() - 1).toArrayList()\n\nwhile (!indices.isEmpty()) {\n    val i = indices.first()\n    val item = list.get(i)\n\n    list.recalculatePositionOfItemAt(i)\n\n    [suppress(\"USELESS_CAST_STATIC_ASSERT_IS_FINE\")]\n    indices.remove(list.indexOf(item) as Any) //cast to disambiguate remove()\n}\n\nlist.endBatchedUpdates()\n</code></pre>\n\n<p>As you can see, I'm tracking the new index after every call to <code>recalculatePositionOfItemAt()</code> so every item is resorted only once and no item is skipped.</p>\n\n<p>This works but seems really wasteful because <code>recalculatePositionOfItemAt()</code> will resize the underlying array twice to remove and then readd the item. <code>indexOf</code> will then perform a new binary search even though the index is already known.</p>\n\n<p><strong>Edit</strong>: This seems to lead to an infinite loop if items compare as equal.</p>\n\n<p>Alternative approach (remove all, then add all):</p>\n\n<pre><code>list.beginBatchedUpdates()\n\nval copy = (list.size() - 1 downTo 0).map { list.removeItemAt(it) }\ncopy.forEach { list.add(it) }\n\nlist.endBatchedUpdates()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "edited": false, "score": 0, "creation_date": 1429812570, "post_id": 29829983, "comment_id": 47788906, "body": "Yeah, I realized animating a complete resorting on more than 5 items looks really weird anyway."}, {"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "edited": false, "score": 0, "creation_date": 1430225025, "post_id": 29829983, "comment_id": 47960779, "body": "Btw, you don&#39;t need to copy the source. Since the underlying array mData is package private, you can access it via a helper in the same package."}], "tags": [], "owner": {"reputation": 34005, "user_id": 608649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46fbc3248107250cb09c0d69919b62ad?s=128&d=identicon&r=PG", "display_name": "yigit", "link": "https://stackoverflow.com/users/608649/yigit"}, "is_accepted": false, "score": 0, "last_activity_date": 1429808463, "creation_date": 1429808463, "answer_id": 29829983, "question_id": 29798098, "link": "https://stackoverflow.com/questions/29798098/how-to-completely-resort-recyclerviews-sortedlist/29829983#29829983", "title": "How to completely resort RecyclerView&#39;s SortedList", "body": "<p>Unfortunately, there is no api for this.\nJust copy the source and add that method yourself. Backing data is just an array so you can call Arrays.sort on it, then call notify data set changed.\nTracking changes is not trivial when the whole world changes so not really suitable case for sorted list.\nPlease create a feature request on b.Android.com.</p>\n"}, {"tags": [], "owner": {"reputation": 3205, "user_id": 9473786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1276343f8bb1e31a8d6d9bde959eccb1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler V", "link": "https://stackoverflow.com/users/9473786/tyler-v"}, "is_accepted": false, "score": 0, "last_activity_date": 1582395129, "last_edit_date": 1582395129, "creation_date": 1582394698, "answer_id": 60355180, "question_id": 29798098, "link": "https://stackoverflow.com/questions/29798098/how-to-completely-resort-recyclerviews-sortedlist/60355180#60355180", "title": "How to completely resort RecyclerView&#39;s SortedList", "body": "<p>The following method worked for me to switch to a new comparator to re-sort the list. I found the animation much smoother with an additional call to <code>notifyDataSetChanged()</code></p>\n\n<pre><code>private final List&lt;MyObject&gt; mTmp = new ArrayList&lt;&gt;();\nprivate Comparator&lt;MyObject&gt; mComparator = DEFAULT_COMPARATOR;\n\nprivate final SortedList&lt;MyObject&gt; mSortedList = new SortedList&lt;&gt;(MyObject.class, new SortedList.Callback&lt;MyObject&gt;() {\n    @Override\n    public int compare(MyObject a, MyObject b) {\n        return mComparator.compare(a, b);\n    }\n\n    // and other methods...\n});\n\npublic void changeComparator(@NonNull Comparator&lt;MyObject&gt; comp) {\n    mComparator = comp;\n\n    mSortedList.beginBatchedUpdates();\n\n    for(int i = 0; i &lt; mSortedList.size(); ++i) {\n        mTmp.add(mSortedList.get(i));\n    }\n    mSortedList.clear();\n    mSortedList.addAll(mTmp);\n    mTmp.clear();\n\n    mSortedList.endBatchedUpdates();\n\n    notifyDataSetChanged();\n}\n</code></pre>\n"}], "owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1164, "favorite_count": 3, "answer_count": 3, "score": 6, "last_activity_date": 1582395129, "creation_date": 1429706916, "last_edit_date": 1429708007, "question_id": 29798098, "link": "https://stackoverflow.com/questions/29798098/how-to-completely-resort-recyclerviews-sortedlist", "title": "How to completely resort RecyclerView&#39;s SortedList", "body": "<p>The RecyclerView library recently added the new <a href=\"http://developer.android.com/reference/android/support/v7/util/SortedList.html\"><code>SortedList</code></a> class. Suppose I have a callback that implements a <a href=\"http://developer.android.com/reference/android/support/v7/util/SortedList.Callback.html#compare%28T2,%20T2%29\"><code>compare()</code></a> method that can change over time, i.e. the underlying Comparator can be switched out. What's the best way to tell the <code>SortedList</code> to completely resort its data?</p>\n"}, {"tags": ["kotlin"], "comments": [{"owner": {"reputation": 4427, "user_id": 4706743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b05c3b09628ba8955d6d7a188271af?s=128&d=identicon&r=PG&f=1", "display_name": "D3xter", "link": "https://stackoverflow.com/users/4706743/d3xter"}, "edited": false, "score": 1, "creation_date": 1429695137, "post_id": 29782304, "comment_id": 47715046, "body": "I&#39;ve already reported this: <a href=\"https://youtrack.jetbrains.com/issue/KT-6947\" rel=\"nofollow noreferrer\">youtrack.jetbrains.com/issue/KT-6947</a>"}, {"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "edited": false, "score": 1, "creation_date": 1429701695, "post_id": 29782304, "comment_id": 47719964, "body": "I&#39;ve asked a similar question before here: <a href=\"http://stackoverflow.com/questions/28022388/reference-to-method-of-a-particular-instance-in-kotlin\" title=\"reference to method of a particular instance in kotlin\">stackoverflow.com/questions/28022388/&hellip;</a> It seems to be on the agenda."}], "answers": [{"comments": [{"owner": {"reputation": 3111, "user_id": 455678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ec6689b267447cdcd58fbe5d89332b25?s=128&d=identicon&r=PG", "display_name": "Lander", "link": "https://stackoverflow.com/users/455678/lander"}, "edited": false, "score": 0, "creation_date": 1429650592, "post_id": 29782658, "comment_id": 47696267, "body": "Ah, I see. That bit of the documentation confused me a little. Error is gone after changing the parameter, thanks!"}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "reply_to_user": {"reputation": 3111, "user_id": 455678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ec6689b267447cdcd58fbe5d89332b25?s=128&d=identicon&r=PG", "display_name": "Lander", "link": "https://stackoverflow.com/users/455678/lander"}, "edited": false, "score": 0, "creation_date": 1429651087, "post_id": 29782658, "comment_id": 47696524, "body": "You&#39;re welcome. I&#39;m curious... did you have to change it to <code>bar: Test.(Any) -&gt; Unit</code>, or were you able to leave it as <code>(Any) -&gt; Unit</code>? @Lander"}, {"owner": {"reputation": 3111, "user_id": 455678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ec6689b267447cdcd58fbe5d89332b25?s=128&d=identicon&r=PG", "display_name": "Lander", "link": "https://stackoverflow.com/users/455678/lander"}, "edited": false, "score": 0, "creation_date": 1429660171, "post_id": 29782658, "comment_id": 47700167, "body": "I did in fact have to change it to <code>bar: Test.(Any)</code>. To me it doesn&#39;t make sense to have to specify the class name... I figured <code>::fun</code> would result in just some type of &quot;function pointer&quot; -- I don&#39;t see why my <code>foo</code> function in this case should have to care about where the function comes from. A way around that is to just provide a lambda like <code>{ bar -&gt; someFun(bar) }</code> as an argument instead of <code>::someFun</code>."}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "reply_to_user": {"reputation": 3111, "user_id": 455678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ec6689b267447cdcd58fbe5d89332b25?s=128&d=identicon&r=PG", "display_name": "Lander", "link": "https://stackoverflow.com/users/455678/lander"}, "edited": false, "score": 0, "creation_date": 1429660373, "post_id": 29782658, "comment_id": 47700225, "body": "Ah. I like the lambda idea. I added it to the answer. I agree... I think it&#39;s pretty crazy you have to change the type just to pass the class method in. That really codes you into a hole @Lander"}], "tags": [], "owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "is_accepted": true, "score": 3, "last_activity_date": 1429660314, "last_edit_date": 1592644375, "creation_date": 1429648660, "answer_id": 29782658, "question_id": 29782304, "link": "https://stackoverflow.com/questions/29782304/member-function-cannot-be-used-as-argument/29782658#29782658", "title": "Member function cannot be used as argument", "body": "<blockquote>\n<p><a href=\"http://kotlinlang.org/docs/reference/reflection.html#function-references\" rel=\"nofollow noreferrer\">Documentation</a></p>\n<p>If we need to use a member of a class, or an extension function, it needs to be qualified, and the result will be of type \u201cextension function\u201d, e.g. String::toCharArray gives us an extension function for type String: String.() -&gt; CharArray.</p>\n</blockquote>\n<pre><code>foo(Test::someFun)\n</code></pre>\n<p>The type changes to:</p>\n<pre><code>bar: Test.(Any) -&gt; Unit\n</code></pre>\n<p>You can also just pass a lambda to the function to get around this:</p>\n<pre><code>foo { bar -&gt; someFun(bar) }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7665559, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Gsx0OEHOHrU/AAAAAAAAAAI/AAAAAAAABaQ/KvBK0a5X4dk/photo.jpg?sz=128", "display_name": "Ian Miller", "link": "https://stackoverflow.com/users/7665559/ian-miller"}, "is_accepted": false, "score": 0, "last_activity_date": 1506444471, "creation_date": 1506444471, "answer_id": 46431889, "question_id": 29782304, "link": "https://stackoverflow.com/questions/29782304/member-function-cannot-be-used-as-argument/46431889#46431889", "title": "Member function cannot be used as argument", "body": "<p>inside the Test class</p>\n\n<p>change code</p>\n\n<pre><code>fun baz() {\n    foo(::someFun)\n}\n</code></pre>\n\n<p>to </p>\n\n<pre><code>fun baz() {\n    foo(this::someFun)\n}\n</code></pre>\n\n<p>would solve the problem!</p>\n\n<p><strong>if you want to reference a type of function, let's say</strong></p>\n\n<pre><code>(Int,Int)-&gt;String\n</code></pre>\n\n<p><strong>and you have class A</strong></p>\n\n<pre><code>class A{\n    fun whatever(a:Int,b:Int) = \"${a},${b}\"\n}\n</code></pre>\n\n<p>you can reference the function using <code>A()::whatever</code>\nwhere A() means an instance of A</p>\n"}], "owner": {"reputation": 3111, "user_id": 455678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ec6689b267447cdcd58fbe5d89332b25?s=128&d=identicon&r=PG", "display_name": "Lander", "link": "https://stackoverflow.com/users/455678/lander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1028, "favorite_count": 0, "accepted_answer_id": 29782658, "answer_count": 2, "score": 0, "last_activity_date": 1506444471, "creation_date": 1429647509, "question_id": 29782304, "link": "https://stackoverflow.com/questions/29782304/member-function-cannot-be-used-as-argument", "title": "Member function cannot be used as argument", "body": "<p>With the following code:</p>\n\n<pre><code>fun someFun(x: Any) {\n\n}\n\nfun foo(bar: (val x: Any) -&gt; Unit) {\n\n}\n\nfun baz() {\n    foo(::someFun)\n}\n\nclass Test {\n    fun someFun(x: Any) {\n\n    }\n\n    fun foo(bar: (val x: Any) -&gt; Unit) {\n\n    }\n\n    fun baz() {\n        foo(::someFun)\n    }\n}\n</code></pre>\n\n<p>In the code <em>outside</em> of the class, everything works fine, no error. In at Test::baz where <code>foo</code> is called, I get the following error:</p>\n\n<blockquote>\n  <p>Error:(53, 13) Kotlin: Type mismatch: inferred type is kotlin.reflect.KMemberFunction1 but (kotlin.Any) -> kotlin.Unit was expected</p>\n</blockquote>\n\n<p>Why can't I use a member function as an argument like this? <a href=\"http://kotlinlang.org/docs/reference/reflection.html#function-references\" rel=\"nofollow\">The documentation</a> doesn't say that I <em>can't</em> do this.</p>\n"}, {"tags": ["gradle", "kotlin"], "comments": [{"owner": {"reputation": 1306, "user_id": 1199452, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3627d3e77bcaa8b54906393d0c9f7055?s=128&d=identicon&r=PG&f=1", "display_name": "ntoskrnl", "link": "https://stackoverflow.com/users/1199452/ntoskrnl"}, "edited": false, "score": 0, "creation_date": 1429600626, "post_id": 29765204, "comment_id": 47662076, "body": "I don&#39;t want to mislead the reader, so what should I write instead?"}, {"owner": {"reputation": 20424, "user_id": 445715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3824489df267d3bf86bbc678b9745ac4?s=128&d=identicon&r=PG", "display_name": "Andrey Breslav", "link": "https://stackoverflow.com/users/445715/andrey-breslav"}, "edited": false, "score": 1, "creation_date": 1429614880, "post_id": 29765204, "comment_id": 47671642, "body": "Write <code>&lt;reified T: Any&gt;</code>, this way a plain <code>T</code> is not nullable any more"}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451944064, "post_id": 29765204, "comment_id": 56946494, "body": "To make this more correct and include the generic type information, you need to change to use a Gson TypeToken as well.  Please see <a href=\"http://stackoverflow.com/a/33420043/3679676\">stackoverflow.com/a/33420043/3679676</a> for a answer that does this."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451944167, "post_id": 29765204, "comment_id": 56946555, "body": "The <code>gradle</code> tag should be removed, this is unrelated to Gradle and would have shown up in any use of the Kotlin compiler at that time."}], "answers": [{"comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451944074, "post_id": 29770640, "comment_id": 56946503, "body": "To make this more correct and include the generic type information, you need to change to use a Gson TypeToken as well.  Please see <a href=\"http://stackoverflow.com/a/33420043/3679676\">stackoverflow.com/a/33420043/3679676</a> for a answer that does this."}], "tags": [], "owner": {"reputation": 20424, "user_id": 445715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3824489df267d3bf86bbc678b9745ac4?s=128&d=identicon&r=PG", "display_name": "Andrey Breslav", "link": "https://stackoverflow.com/users/445715/andrey-breslav"}, "is_accepted": true, "score": 2, "last_activity_date": 1429614948, "creation_date": 1429614948, "answer_id": 29770640, "question_id": 29765204, "link": "https://stackoverflow.com/questions/29765204/unable-to-compile-an-extension-function-with-reified-type-parameter-in-kotlin/29770640#29770640", "title": "Unable to compile an extension function with reified type parameter in Kotlin", "body": "<p>The exception you are getting is a bug in the compiler.</p>\n\n<p>The warning you are getting is correct, and to eliminate it, write <code>&lt;reified T: Any&gt;</code>, this way a plain <code>T</code> is not nullable any more.</p>\n"}], "owner": {"reputation": 1306, "user_id": 1199452, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3627d3e77bcaa8b54906393d0c9f7055?s=128&d=identicon&r=PG&f=1", "display_name": "ntoskrnl", "link": "https://stackoverflow.com/users/1199452/ntoskrnl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "accepted_answer_id": 29770640, "answer_count": 1, "score": 0, "last_activity_date": 1430177583, "creation_date": 1429599979, "last_edit_date": 1430177583, "question_id": 29765204, "link": "https://stackoverflow.com/questions/29765204/unable-to-compile-an-extension-function-with-reified-type-parameter-in-kotlin", "title": "Unable to compile an extension function with reified type parameter in Kotlin", "body": "<p>I have a kotlin library project and use <code>Spek</code> for testing. In my tests I try to use the following function:</p>\n\n<pre><code>inline fun JsonElement?.cast&lt;reified T&gt;(gson: Gson): T {\n  return if (this != null)\n    gson.fromJson&lt;T&gt;(this, javaClass&lt;T&gt;())\n  else null\n}\n</code></pre>\n\n<p>When I try to compile the above code, I get a compilation error:</p>\n\n<pre><code>Error: Gradle: java.lang.IllegalStateException: Error type encountered:\norg.jetbrains.kotlin.types.ErrorUtils$UninferredParameterTypeConstructor@144bac7f (ErrorTypeImpl).\nOne of the possible reasons may be that this type is not directly accessible from this module.\nTo workaround this error, try adding an explicit dependency on the module\nor library which contains this type to the classpath\n</code></pre>\n\n<p>However this code compiles correctly:\n</p>\n\n<pre><code>inline fun JsonElement?.cast&lt;reified T&gt;(gson: Gson): T? {\n  return if (this != null)\n    gson.fromJson&lt;T&gt;(this, javaClass&lt;T&gt;())\n  else null\n}\n</code></pre>\n\n<p>You notice, the return type was changed from <code>T</code> to <code>T?</code>. Even though it compiles, I get a hint message:</p>\n\n<pre><code>'T' has nullable upper bound. This means that a value of type may be null.\nUsing 'T?' is likely to mislead the reader.\n</code></pre>\n\n<p>Is it a correct behavior?</p>\n"}, {"tags": ["arrays", "kotlin"], "comments": [{"owner": {"reputation": 16077, "user_id": 97777, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fb95aca1c80de718bbfa01447220633b?s=128&d=identicon&r=PG", "display_name": "Duncan McGregor", "link": "https://stackoverflow.com/users/97777/duncan-mcgregor"}, "edited": false, "score": 0, "creation_date": 1448151651, "post_id": 29743160, "comment_id": 55464983, "body": "<a href=\"http://stackoverflow.com/questions/33583235/how-can-i-tell-kotlin-that-an-array-or-collection-cannot-contain-nulls\" title=\"how can i tell kotlin that an array or collection cannot contain nulls\">stackoverflow.com/questions/33583235/&hellip;</a> - one of the comments suggests that the warning is a bug"}], "answers": [{"tags": [], "owner": {"reputation": 404, "user_id": 2480032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/048b8bcd7c0996c3b0fff4e685c32181?s=128&d=identicon&r=PG", "display_name": "Ciprian Khlud", "link": "https://stackoverflow.com/users/2480032/ciprian-khlud"}, "is_accepted": false, "score": 1, "last_activity_date": 1429599184, "last_edit_date": 1429599184, "creation_date": 1429520539, "answer_id": 29743429, "question_id": 29743160, "link": "https://stackoverflow.com/questions/29743160/how-to-create-an-empty-array-in-kotlin/29743429#29743429", "title": "How to create an empty array in kotlin?", "body": "<p>I found two ways to create an empty array, the second way without a lambda:</p>\n\n<pre><code>var arr = Array (0, { i -&gt; \"\" })\nvar arr2 = array&lt;String&gt;()\n</code></pre>\n\n<p>Regarding Kotlin's null strings, this is not allowed. You have to use <em>String?</em> type to allow strings to be null.</p>\n"}, {"comments": [{"owner": {"reputation": 3728, "user_id": 1779504, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/K8LTB.png?s=128&g=1", "display_name": "csharpfolk", "link": "https://stackoverflow.com/users/1779504/csharpfolk"}, "edited": false, "score": 2, "creation_date": 1495379651, "post_id": 30887200, "comment_id": 75217350, "body": "What about typed arrays like <code>IntArray</code>? Right now I am using <code>arrayOf&lt;Int&gt;().toIntArray()</code>, is there any better way?"}, {"owner": {"reputation": 2964, "user_id": 2769917, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/78c9b4e2e2a18d5c74468629bcd1c3ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asif Mushtaq", "link": "https://stackoverflow.com/users/2769917/asif-mushtaq"}, "edited": false, "score": 5, "creation_date": 1495826665, "post_id": 30887200, "comment_id": 75430192, "body": "what is the purpose of these methods? because we can&#39;t assign the size so we can&#39;t assign the value or get. array[0] throw <code>java.lang.ArrayIndexOutOfBoundsException:</code> exception."}, {"owner": {"reputation": 3587, "user_id": 2232458, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JBfaE.jpg?s=128&g=1", "display_name": "Ari", "link": "https://stackoverflow.com/users/2232458/ari"}, "edited": false, "score": 0, "creation_date": 1509628954, "post_id": 30887200, "comment_id": 81101084, "body": "what if the type is <code>T</code> instead of <code>String</code>?"}, {"owner": {"reputation": 980, "user_id": 790568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecda1aec52ddef6013abf8c63a0d75cc?s=128&d=identicon&r=PG", "display_name": "Cremons", "link": "https://stackoverflow.com/users/790568/cremons"}, "reply_to_user": {"reputation": 3728, "user_id": 1779504, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/K8LTB.png?s=128&g=1", "display_name": "csharpfolk", "link": "https://stackoverflow.com/users/1779504/csharpfolk"}, "edited": false, "score": 1, "creation_date": 1532411992, "post_id": 30887200, "comment_id": 89951313, "body": "@csharpfolk, you may use intArrayOf() to initialize an empty IntArray"}, {"owner": {"reputation": 630, "user_id": 4575069, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Nptlr.jpg?s=128&g=1", "display_name": "Syed Hamza Hassan", "link": "https://stackoverflow.com/users/4575069/syed-hamza-hassan"}, "edited": false, "score": 0, "creation_date": 1538559349, "post_id": 30887200, "comment_id": 92181368, "body": "How to add item in string array in kotlin ?"}, {"owner": {"reputation": 7835, "user_id": 5318303, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/c68a73abf0e7084430aa45ac9f97fda9?s=128&d=identicon&r=PG", "display_name": "Mir-Ismaili", "link": "https://stackoverflow.com/users/5318303/mir-ismaili"}, "edited": false, "score": 0, "creation_date": 1545543920, "post_id": 30887200, "comment_id": 94648093, "body": "This has an immutable length of <code>0</code>! So it&#39;s useful just for very special purposes that you don&#39;t want storing any <b><i>data</i></b> (just want <b><i>type</i></b>). Use <code>Array(length){&quot;&quot;}</code> to include a desired <code>length</code>. See <a href=\"https://stackoverflow.com/questions/29743160/how-to-create-a-empty-array-in-kotlin#answer-53901415\">my answer</a> below for details."}, {"owner": {"reputation": 361, "user_id": 10343490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57b04f74c529ae1d5cc8583cc89f14ff?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/10343490/paul"}, "reply_to_user": {"reputation": 3728, "user_id": 1779504, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/K8LTB.png?s=128&g=1", "display_name": "csharpfolk", "link": "https://stackoverflow.com/users/1779504/csharpfolk"}, "edited": false, "score": 0, "creation_date": 1580549812, "post_id": 30887200, "comment_id": 106140274, "body": "@csharpfolk IntArray(size = 2)"}], "tags": [], "owner": {"reputation": 1908, "user_id": 3543130, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5d023505076e3ea939260f9f26b88f42?s=128&d=identicon&r=PG&f=1", "display_name": "Martian Odyssey", "link": "https://stackoverflow.com/users/3543130/martian-odyssey"}, "is_accepted": true, "score": 134, "last_activity_date": 1434532424, "creation_date": 1434532424, "answer_id": 30887200, "question_id": 29743160, "link": "https://stackoverflow.com/questions/29743160/how-to-create-an-empty-array-in-kotlin/30887200#30887200", "title": "How to create an empty array in kotlin?", "body": "<p>As of late (June 2015) there is the Kotlin standard library function</p>\n\n<pre><code>public fun &lt;T&gt; arrayOf(vararg t: T): Array&lt;T&gt;\n</code></pre>\n\n<p>So to create an empty array of Strings you can write</p>\n\n<pre><code>val emptyStringArray = arrayOf&lt;String&gt;()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2964, "user_id": 2769917, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/78c9b4e2e2a18d5c74468629bcd1c3ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asif Mushtaq", "link": "https://stackoverflow.com/users/2769917/asif-mushtaq"}, "edited": false, "score": 1, "creation_date": 1495826688, "post_id": 33838875, "comment_id": 75430201, "body": "arr[0] throw <code>java.lang.ArrayIndexOutOfBoundsException:</code> how we can use it?"}, {"owner": {"reputation": 338, "user_id": 1107768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9391152264f5d5fe5e7f6db2de7ebdcb?s=128&d=identicon&r=PG", "display_name": "Kuba Ber&#225;nek", "link": "https://stackoverflow.com/users/1107768/kuba-ber%c3%a1nek"}, "edited": false, "score": 8, "creation_date": 1500640687, "post_id": 33838875, "comment_id": 77441533, "body": "It&#39;s an empty array, you can&#39;t add/read anything to/from it. It may seem useless, but sometimes you have to pass an array somewhere and this allows you to construct an empty array easily."}, {"owner": {"reputation": 538, "user_id": 1473350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ab88fc69545c3e1dec4a031fa3953ae?s=128&d=identicon&r=PG", "display_name": "iSWORD", "link": "https://stackoverflow.com/users/1473350/isword"}, "edited": false, "score": 2, "creation_date": 1502298042, "post_id": 33838875, "comment_id": 78152703, "body": "this is better than Martian Odyssey&#39;s answer because when used in a data class to initialize an array, arrayOf causes a java.util.concurrent.ExecutionException while emptyArray() doesn&#39;t."}, {"owner": {"reputation": 7835, "user_id": 5318303, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/c68a73abf0e7084430aa45ac9f97fda9?s=128&d=identicon&r=PG", "display_name": "Mir-Ismaili", "link": "https://stackoverflow.com/users/5318303/mir-ismaili"}, "edited": false, "score": 1, "creation_date": 1545544201, "post_id": 33838875, "comment_id": 94648125, "body": "This has an immutable length of <code>0</code>! So it&#39;s useful just for very special purposes that you don&#39;t want storing any <b><i>data</i></b> (just want <b><i>type</i></b>). Use <code>Array(length){&quot;&quot;}</code> to include a desired <code>length</code>. See <a href=\"https://stackoverflow.com/questions/29743160/how-to-create-a-empty-array-in-kotlin#answer-53901415\">my answer</a> below for details."}], "tags": [], "owner": {"reputation": 11062, "user_id": 1104902, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e2ce37fa708768742edc4ed94b4cb76d?s=128&d=identicon&r=PG", "display_name": "pt2121", "link": "https://stackoverflow.com/users/1104902/pt2121"}, "is_accepted": false, "score": 47, "last_activity_date": 1481724906, "last_edit_date": 1481724906, "creation_date": 1448071097, "answer_id": 33838875, "question_id": 29743160, "link": "https://stackoverflow.com/questions/29743160/how-to-create-an-empty-array-in-kotlin/33838875#33838875", "title": "How to create an empty array in kotlin?", "body": "<p>Just for reference, there is also <code>emptyArray</code>. For example,</p>\n\n<pre><code>var arr = emptyArray&lt;String&gt;()\n</code></pre>\n\n<p>See</p>\n\n<ul>\n<li><a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/empty-array.html\" rel=\"noreferrer\">doc</a></li>\n<li><a href=\"https://github.com/JetBrains/kotlin/blob/master/libraries/stdlib/src/kotlin/collections/Arrays.kt\" rel=\"noreferrer\">Array.kt</a></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 5164, "user_id": 1872046, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/2GC1B.jpg?s=128&g=1", "display_name": "polkovnikov.ph", "link": "https://stackoverflow.com/users/1872046/polkovnikov-ph"}, "edited": false, "score": 1, "creation_date": 1497963602, "post_id": 44648266, "comment_id": 76292750, "body": "This is an array of nulls, not empty strings as in question."}], "tags": [], "owner": {"reputation": 533, "user_id": 7553195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50cdc18957162fb398a3a8b141120c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ali hasan", "link": "https://stackoverflow.com/users/7553195/ali-hasan"}, "is_accepted": false, "score": 10, "last_activity_date": 1497948769, "creation_date": 1497948769, "answer_id": 44648266, "question_id": 29743160, "link": "https://stackoverflow.com/questions/29743160/how-to-create-an-empty-array-in-kotlin/44648266#44648266", "title": "How to create an empty array in kotlin?", "body": "<p>null array </p>\n\n<pre><code>var arrayString=Array&lt;String?&gt;(5){null}\nvar nullArray= arrayOfNulls&lt;String&gt;(5)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1754, "user_id": 7096016, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ur81C.jpg?s=128&g=1", "display_name": "Alexander Savin", "link": "https://stackoverflow.com/users/7096016/alexander-savin"}, "is_accepted": false, "score": 2, "last_activity_date": 1539564228, "creation_date": 1539564228, "answer_id": 52808378, "question_id": 29743160, "link": "https://stackoverflow.com/questions/29743160/how-to-create-an-empty-array-in-kotlin/52808378#52808378", "title": "How to create an empty array in kotlin?", "body": "<p><strong>Use:</strong></p>\n\n<pre><code>@JvmField val EMPTY_STRING_ARRAY = arrayOfNulls&lt;String&gt;(0)\n</code></pre>\n\n<p>It returns an 0 size array of Strings, initialized with null values.</p>\n\n<p><strong>1. Wrong:</strong></p>\n\n<pre><code>@JvmField val EMPTY_STRING_ARRAY = emptyArray&lt;String&gt;()\n</code></pre>\n\n<p>It returns <code>arrayOfNulls&lt;String&gt;(0)</code></p>\n\n<p><strong>2. Wrong:</strong></p>\n\n<pre><code> @JvmField val EMPTY_STRING_ARRAY = arrayOf&lt;String&gt;()\n</code></pre>\n\n<p>It returns an array containing the Strings.</p>\n"}, {"tags": [], "owner": {"reputation": 7835, "user_id": 5318303, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/c68a73abf0e7084430aa45ac9f97fda9?s=128&d=identicon&r=PG", "display_name": "Mir-Ismaili", "link": "https://stackoverflow.com/users/5318303/mir-ismaili"}, "is_accepted": false, "score": 18, "last_activity_date": 1611860254, "last_edit_date": 1611860254, "creation_date": 1545542719, "answer_id": 53901415, "question_id": 29743160, "link": "https://stackoverflow.com/questions/29743160/how-to-create-an-empty-array-in-kotlin/53901415#53901415", "title": "How to create an empty array in kotlin?", "body": "<h1>Empty or <code>null</code>? That's the question!</h1>\n<p><em>To create an array of <b><code>null</code></b>s, simply use <strong><code>arrayOfNulls&lt;Type&gt;(length)</code></strong>.</em></p>\n<hr />\n<p>But to generate an <strong>empty</strong> array of size <code>length</code>, use:</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>val arr = Array(length) { emptyObject }\n</code></pre>\n<p>Note that <em>you <strong>must</strong> define an <code>emptyObject</code></em> properly per each data-type (beacause you don't want <code>null</code>s). E. g. for <code>String</code>s, <code>emptyObject</code> can be <code>&quot;&quot;</code>. So:</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>val arr = Array(3) { &quot;&quot; }  // is equivalent for: arrayOf(&quot;&quot;,&quot;&quot;,&quot;&quot;)\n</code></pre>\n<hr />\n<p><a href=\"https://pl.kotl.in/H1wFNohgE\" rel=\"nofollow noreferrer\">Here</a> is a <em>live example</em>. Note that the program runs with two sample arguments, by default.</p>\n"}, {"tags": [], "owner": {"reputation": 16055, "user_id": 2914140, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Ik94c.jpg?s=128&g=1", "display_name": "CoolMind", "link": "https://stackoverflow.com/users/2914140/coolmind"}, "is_accepted": false, "score": 3, "last_activity_date": 1559728893, "creation_date": 1559728893, "answer_id": 56458314, "question_id": 29743160, "link": "https://stackoverflow.com/questions/29743160/how-to-create-an-empty-array-in-kotlin/56458314#56458314", "title": "How to create an empty array in kotlin?", "body": "<p>As mentioned above, you can use <code>IntArray(size)</code> or <code>FloatArray(size)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 10310062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ebd004a9efe089357c50dcf6612f2b0?s=128&d=identicon&r=PG&f=1", "display_name": "Prashant Singh", "link": "https://stackoverflow.com/users/10310062/prashant-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1615728885, "creation_date": 1615728885, "answer_id": 66625129, "question_id": 29743160, "link": "https://stackoverflow.com/questions/29743160/how-to-create-an-empty-array-in-kotlin/66625129#66625129", "title": "How to create an empty array in kotlin?", "body": "<p>Simplest way to initialise array and assigning values :</p>\n<pre><code>val myArray: Array&lt;String&gt; = Array(2) { &quot;&quot; }\n    myArray[0] = &quot;Java&quot;\n    myArray[1] = &quot;Kotlin&quot;\n</code></pre>\n"}], "owner": {"reputation": 2039, "user_id": 302199, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/464bd9a7835e7bafedc64b98b02e4ee2?s=128&d=identicon&r=PG", "display_name": "huangcd", "link": "https://stackoverflow.com/users/302199/huangcd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69550, "favorite_count": 4, "accepted_answer_id": 30887200, "answer_count": 8, "score": 104, "last_activity_date": 1615728885, "creation_date": 1429519896, "last_edit_date": 1587938423, "question_id": 29743160, "link": "https://stackoverflow.com/questions/29743160/how-to-create-an-empty-array-in-kotlin", "title": "How to create an empty array in kotlin?", "body": "<p>I'm using <code>Array(0, {i -&gt; \"\"})</code> currently, and I would like to know if there's a better implementation such as <code>Array()</code></p>\n\n<p>plus, if I'm using <code>arrayOfNulls&lt;String&gt;(0) as Array&lt;String&gt;</code>, the compiler will alert me that this cast can never succeed. But it's the default implementation inside <code>Array(0, {i -&gt; \"\"})</code>. Do I miss something?</p>\n"}, {"tags": ["nullpointerexception", "null", "kotlin", "java-collections-api", "java-interop"], "comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451706049, "post_id": 29732137, "comment_id": 56868395, "body": "Read more about using and <a href=\"http://stackoverflow.com/questions/34498562/in-kotlin-what-is-the-idiomatic-way-to-deal-with-nullable-values-referencing-o/34498563#34498563\">working with nullable values in Kotlin</a>"}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451744385, "post_id": 29732137, "comment_id": 56877401, "body": "This was a bug at the time of the question being asked, and is no longer an issue."}], "answers": [{"comments": [{"owner": {"reputation": 235985, "user_id": 252000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/082b8ee2b0aebb430b8d4d98e6a5c32f?s=128&d=identicon&r=PG", "display_name": "fredoverflow", "link": "https://stackoverflow.com/users/252000/fredoverflow"}, "edited": false, "score": 0, "creation_date": 1429603080, "post_id": 29734499, "comment_id": 47663522, "body": "Why did you replace <code>trait</code> with <code>interface</code>? The docs say <code>trait</code>."}, {"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "reply_to_user": {"reputation": 235985, "user_id": 252000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/082b8ee2b0aebb430b8d4d98e6a5c32f?s=128&d=identicon&r=PG", "display_name": "fredoverflow", "link": "https://stackoverflow.com/users/252000/fredoverflow"}, "edited": false, "score": 0, "creation_date": 1429606995, "post_id": 29734499, "comment_id": 47665988, "body": "<a href=\"http://blog.jetbrains.com/kotlin/2015/04/more-changes-enum-syntax-and-one-deprecation-and-more/\" rel=\"nofollow noreferrer\">blog.jetbrains.com/kotlin/2015/04/&hellip;</a> says &quot;trait&quot; will be deprecated in favor of &quot;interface&quot;."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451706155, "post_id": 29734499, "comment_id": 56868407, "body": "This code example should be:  <code>val hm = hashMapOf&lt;String, Int&gt;()</code> or literally create the map in the sample as read-only <code>val hm = mapOf(&quot;alice&quot; to 42)</code>"}, {"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "reply_to_user": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451732176, "post_id": 29734499, "comment_id": 56873735, "body": "@jayson <code>val hm = hashMapOf&lt;String, Int&gt;()</code> will, again, create a variable of type <code>HashMap</code>, not <code>MutableMap</code> which is the whole point."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451744347, "post_id": 29734499, "comment_id": 56877386, "body": "I guess I should have made that comment more clear.  This is not CURRENTLY and issue with Kotlin, was a bug at the time, and NOW you can do what he did originally or the two examples I gave.  See full notes in another answer."}], "tags": [], "owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "is_accepted": true, "score": 6, "last_activity_date": 1429470455, "creation_date": 1429470455, "answer_id": 29734499, "question_id": 29732137, "link": "https://stackoverflow.com/questions/29732137/why-does-hashmap-get-not-return-a-nullable-type/29734499#29734499", "title": "Why does HashMap.get not return a nullable type?", "body": "<p>Your variable <code>hm</code> is of type <code>HashMap</code> and because that's a platform class its methods return <a href=\"http://kotlinlang.org/docs/reference/java-interop.html#null-safety-and-platform-types\" rel=\"noreferrer\">platform types</a>. Kotlin's own <a href=\"http://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-map/index.html\" rel=\"noreferrer\"><code>Map</code></a> and its <strike>subtrait</strike> subinterface <a href=\"http://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-mutable-map/\" rel=\"noreferrer\"><code>MutableMap</code></a> however return nullable types for <a href=\"http://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-map/get.html\" rel=\"noreferrer\"><code>get()</code></a>.</p>\n\n<p>Change your code to</p>\n\n<pre><code>val hm : MutableMap&lt;String, Int&gt; = HashMap()\n</code></pre>\n\n<p>and it will print \"null\".</p>\n"}, {"tags": [], "owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "is_accepted": false, "score": 0, "last_activity_date": 1451744294, "creation_date": 1451744294, "answer_id": 34566858, "question_id": 29732137, "link": "https://stackoverflow.com/questions/29732137/why-does-hashmap-get-not-return-a-nullable-type/34566858#34566858", "title": "Why does HashMap.get not return a nullable type?", "body": "<p>This is no longer an issue.  Kotlin had an issue with how the JDK class was annotated telling it how to treat some methods.  Current Kotlin does not exhibit the problem you were seeing.  </p>\n\n<p>These both return a HashMap from Java collections, the first <code>hm1</code> being more idiomatic.</p>\n\n\n\n<pre><code>val hm1 = hashMapOf&lt;String, Int&gt;()\nval hm2 = HashMap&lt;String, Int&gt;()\n</code></pre>\n\n<p>You can also create it as a map that already has the values if they are known ahead of time.</p>\n\n<pre><code>val hm3 = hashMapOf(\"alice\" to 42)\n</code></pre>\n\n<p>or a readonly version:</p>\n\n<pre><code>val hm4 = mapOf(\"alice\" to 42)\n</code></pre>\n\n<p>In all of these versions, they all print <code>null</code> when calling <code>get()</code> with an unknown value and then printing the result:</p>\n\n<pre><code>println(hm1.get(\"missing\"))\nprintln(hm2.get(\"missing\"))\nprintln(hm3.get(\"missing\"))\nprintln(hm4.get(\"missing\"))\n</code></pre>\n\n<p>All have the same signature for <code>get()</code> since the JDK classes are annotated by the Kotlin team to know that <code>get()</code> returns a nullable value, <code>Int?</code> in this case.</p>\n\n<p>Only an error in those annotations would cause a problem.  And should be <a href=\"https://youtrack.jetbrains.com\" rel=\"nofollow\">tracked as a bug</a> if you see another one within the JDK runtime library.</p>\n"}], "owner": {"reputation": 235985, "user_id": 252000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/082b8ee2b0aebb430b8d4d98e6a5c32f?s=128&d=identicon&r=PG", "display_name": "fredoverflow", "link": "https://stackoverflow.com/users/252000/fredoverflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1776, "favorite_count": 0, "accepted_answer_id": 29734499, "answer_count": 2, "score": 3, "last_activity_date": 1451744294, "creation_date": 1429458849, "question_id": 29732137, "link": "https://stackoverflow.com/questions/29732137/why-does-hashmap-get-not-return-a-nullable-type", "title": "Why does HashMap.get not return a nullable type?", "body": "<p>I was a bit surprised that the following example throws a <code>NullPointerException</code>:</p>\n\n<pre><code>fun main(args: Array&lt;String&gt;) {\n    val hm = HashMap&lt;String, Int&gt;()\n    hm.put(\"alice\", 42)\n    val x = hm.get(\"bob\")\n    println(x)   // BOOM\n}\n</code></pre>\n\n<p>I thought there are no <code>NullPointerException</code>s in Kotlin code?</p>\n\n<p>If I annotate <code>x</code> with an optional type, the programm prints <code>null</code> instead:</p>\n\n<pre><code>fun main(args: Array&lt;String&gt;) {\n    val hm = HashMap&lt;String, Int&gt;()\n    hm.put(\"alice\", 42)\n    val x: Int? = hm.get(\"bob\")\n    println(x)   // null\n}\n</code></pre>\n\n<p>Have I discovered a special case, or is this a general problem with Kotlin/Java interop?</p>\n\n<p>I am using IntelliJ IDEA 14.1 Community Edition with Kotlin 0.11.91.1 plugin.</p>\n"}, {"tags": ["java", "reflection", "kotlin"], "comments": [{"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451706439, "post_id": 29730057, "comment_id": 56868446, "body": "I have posted a new answer which is valid for current Kotlin and implements the inline function with reified type parameters as suggested by @bashor"}], "answers": [{"comments": [{"owner": {"reputation": 783, "user_id": 4672864, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/8b39e83fd6dbd1932b93f29f31cd1c60?s=128&d=identicon&r=PG&f=1", "display_name": "user38725", "link": "https://stackoverflow.com/users/4672864/user38725"}, "edited": false, "score": 0, "creation_date": 1429792745, "post_id": 29731369, "comment_id": 47773634, "body": "<code>public fun Engine.get&lt;S : EntitySystem&gt;(type: KClass&lt;S&gt;) : S { \treturn getSystem(type.java) }</code> seemed to do the trick"}, {"owner": {"reputation": 783, "user_id": 4672864, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/8b39e83fd6dbd1932b93f29f31cd1c60?s=128&d=identicon&r=PG&f=1", "display_name": "user38725", "link": "https://stackoverflow.com/users/4672864/user38725"}, "edited": false, "score": 0, "creation_date": 1439189010, "post_id": 29731369, "comment_id": 51739403, "body": "I have updated to the latest Kotlin (0.12.1230), and the kotlin.reflect.jvm does not seem to exist anymore? Anyone know if it has been renamed or something?"}, {"owner": {"reputation": 783, "user_id": 4672864, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/8b39e83fd6dbd1932b93f29f31cd1c60?s=128&d=identicon&r=PG&f=1", "display_name": "user38725", "link": "https://stackoverflow.com/users/4672864/user38725"}, "edited": false, "score": 0, "creation_date": 1439189444, "post_id": 29731369, "comment_id": 51739624, "body": "Never mind... the problem seemed to be that the Android Studio&#39;s intention to add kotlin-reflect did not update the build.gradle-file at all..."}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451706496, "post_id": 29731369, "comment_id": 56868458, "body": "<code>javaClass&lt;T&gt;()</code> is deprecated, use <code>T::class</code> instead."}], "tags": [], "owner": {"reputation": 6493, "user_id": 1020900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab5f80978d59af0204e0986ca41d2c23?s=128&d=identicon&r=PG", "display_name": "bashor", "link": "https://stackoverflow.com/users/1020900/bashor"}, "is_accepted": true, "score": 1, "last_activity_date": 1451822740, "last_edit_date": 1451822740, "creation_date": 1429454670, "answer_id": 29731369, "question_id": 29730057, "link": "https://stackoverflow.com/questions/29730057/kotlin-reflection-issue/29731369#29731369", "title": "Kotlin Reflection Issue", "body": "<p>You should use the extension property <a href=\"http://kotlinlang.org/api/latest/jvm/stdlib/kotlin.reflect.jvm/-k-class/java.html\" rel=\"nofollow\"><code>java</code></a> instead of <code>javaClass</code>.</p>\n\n<p>Additionally You can improve your API with <a href=\"http://kotlinlang.org/docs/reference/inline-functions.html#reified-type-parameters\" rel=\"nofollow\">reified type parameters</a> and rewrite your code like:</p>\n\n<pre><code>public inline fun &lt;reified C : Component&gt; Entity.getComponent(): C {\n    return getComponent(C::class.java)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "is_accepted": false, "score": 2, "last_activity_date": 1451706393, "creation_date": 1451706393, "answer_id": 34562396, "question_id": 29730057, "link": "https://stackoverflow.com/questions/29730057/kotlin-reflection-issue/34562396#34562396", "title": "Kotlin Reflection Issue", "body": "<p>In current Kotlin (1.0), the code would be simpler as:</p>\n\n<pre><code>public inline fun &lt;reified C : Component&gt; Entity.getComponent(): C {\n    return getComponent(C::class)\n}\n</code></pre>\n\n<p>And can be called:</p>\n\n<pre><code>val comp: SomeComponent = entity.getComponent()\n</code></pre>\n\n<p>Where type inference will work, reify the generic type parameter (including any nested generic parameters) and call the method, which then uses the type parameter as a class reference.</p>\n"}], "owner": {"reputation": 783, "user_id": 4672864, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/8b39e83fd6dbd1932b93f29f31cd1c60?s=128&d=identicon&r=PG&f=1", "display_name": "user38725", "link": "https://stackoverflow.com/users/4672864/user38725"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1051, "favorite_count": 0, "accepted_answer_id": 29731369, "answer_count": 2, "score": 3, "last_activity_date": 1451822740, "creation_date": 1429447661, "question_id": 29730057, "link": "https://stackoverflow.com/questions/29730057/kotlin-reflection-issue", "title": "Kotlin Reflection Issue", "body": "<p>I have these methods declared in Java libraries:</p>\n\n<p>Engine.java:</p>\n\n<pre><code>public &lt;T extends EntitySystem&gt; T getSystem(Class&lt;T&gt; systemType)\n</code></pre>\n\n<p>Entity.java:</p>\n\n<pre><code>public &lt;T extends Component&gt; T getComponent(Class&lt;T&gt; componentClass)\n</code></pre>\n\n<p>Now, I use these methods A LOT, and I would really like to use <code>MyComponent::class</code> (i.e. kotlin reflection) instead of the more verbose <code>javaClass&lt;MyComponent&gt;()</code> everywhere.</p>\n\n<p>My <code>EntitySystem</code> and <code>Component</code> implementations are written in Kotlin.</p>\n\n<p>So I thought I would create extension functions that take <code>KClasses</code> instead, but I am not quite sure how to make them work.</p>\n\n<p>Something along the lines of...</p>\n\n<pre><code>public fun &lt;C : Component&gt; Entity.getComponent(type: KClass&lt;out Component&gt;): C {\n    return getComponent(type.javaClass)\n}\n</code></pre>\n\n<p>But this does not work for several reasons: The compiler says type inference failed, since <code>javaClass</code> returns <code>Class&lt;KClass&lt;C&gt;&gt;</code>. And I need <code>Class&lt;C&gt;</code>. I also don't know how to make the method properly generic.</p>\n\n<p>Can anyone help me create these methods?</p>\n"}, {"tags": ["kotlin"], "comments": [{"owner": {"reputation": 7287, "user_id": 258848, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/2Ckug.jpg?s=128&g=1", "display_name": "dimsuz", "link": "https://stackoverflow.com/users/258848/dimsuz"}, "reply_to_user": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1451845121, "post_id": 29717241, "comment_id": 56904732, "body": "@JaysonMinard author of an accepted answer already has updated it to reflect the current state of things"}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 0, "creation_date": 1452132566, "post_id": 29717241, "comment_id": 57038208, "body": "Good, then I dropped the other answer since it is no longer needed."}, {"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1453011934, "post_id": 29717241, "comment_id": 57412508, "body": "/*kotlin programming*/"}], "answers": [{"comments": [{"owner": {"reputation": 7287, "user_id": 258848, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/2Ckug.jpg?s=128&g=1", "display_name": "dimsuz", "link": "https://stackoverflow.com/users/258848/dimsuz"}, "edited": false, "score": 1, "creation_date": 1429739916, "post_id": 29807651, "comment_id": 47747365, "body": "I do not like the package scope because I tend to have many file-local variables and they clutter all completion popups and generally I do not need them visible everywhere. I know I can use an <code>object</code>, but that seems more like a hack..."}, {"owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "reply_to_user": {"reputation": 7287, "user_id": 258848, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/2Ckug.jpg?s=128&g=1", "display_name": "dimsuz", "link": "https://stackoverflow.com/users/258848/dimsuz"}, "edited": false, "score": 0, "creation_date": 1429775552, "post_id": 29807651, "comment_id": 47761061, "body": "Well, in Kotlin the package structure doesn&#39;t have to correspond to the directory structure, so you can set a distinct package for every file without changing the structure of files in your project."}, {"owner": {"reputation": 7287, "user_id": 258848, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/2Ckug.jpg?s=128&g=1", "display_name": "dimsuz", "link": "https://stackoverflow.com/users/258848/dimsuz"}, "edited": false, "score": 1, "creation_date": 1429786357, "post_id": 29807651, "comment_id": 47768693, "body": "Yep, noticed that, just feels unusual. Is this the recommended way? Actually I feel a little beet disoriented on how to organize my Kotlin project with all this stuff in mind: default package scope, arbitrary package name per-file. And I really miss some best-practise or advice from Kotlin authors. Java is stricter here and it feels to me like this brings some order..."}, {"owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "reply_to_user": {"reputation": 7287, "user_id": 258848, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/2Ckug.jpg?s=128&g=1", "display_name": "dimsuz", "link": "https://stackoverflow.com/users/258848/dimsuz"}, "edited": false, "score": 0, "creation_date": 1429786564, "post_id": 29807651, "comment_id": 47768866, "body": "The recommended way is to follow the Java conventions, because it&#39;s the only way that allows you to freely mix Java and Kotlin source files within the same source root. However, for pure Kotlin projects you have more flexibility, and having a unique package per file is one of the possible approaches."}, {"owner": {"reputation": 7287, "user_id": 258848, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/2Ckug.jpg?s=128&g=1", "display_name": "dimsuz", "link": "https://stackoverflow.com/users/258848/dimsuz"}, "edited": false, "score": 0, "creation_date": 1429786720, "post_id": 29807651, "comment_id": 47768983, "body": "Ok, thank you. Still by following Java conventions I get into this situation which lead to the question I&#39;m asking... Ok, I guess I&#39;ll have to learn to live with that :)"}, {"owner": {"reputation": 73428, "user_id": 3679676, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0faaf44a8922cf165ff73d9efd0dade?s=128&d=identicon&r=PG", "display_name": "Jayson Minard", "link": "https://stackoverflow.com/users/3679676/jayson-minard"}, "edited": false, "score": 1, "creation_date": 1451706617, "post_id": 29807651, "comment_id": 56868482, "body": "This answer is out of date, <code>private</code> is now file-local scope for top-level items."}], "tags": [], "owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "is_accepted": true, "score": 9, "last_activity_date": 1451726481, "last_edit_date": 1451726481, "creation_date": 1429732853, "answer_id": 29807651, "question_id": 29717241, "link": "https://stackoverflow.com/questions/29717241/is-there-a-way-to-have-a-private-file-constant-in-kotlin/29807651#29807651", "title": "Is there a way to have a private file constant in Kotlin", "body": "<p>Top-level declarations with <code>private</code> visibility are visible only in the file where they are declared.</p>\n\n<p>(original answer, valid when the question was asked: Kotlin does not have any concept of file-local scope, and to the best of my knowledge there are no plans to introduce it. If you don't like package scope (why?), you can create an <code>object</code> encapsulating the functions and the private constants that they use.</p>\n"}], "owner": {"reputation": 7287, "user_id": 258848, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/2Ckug.jpg?s=128&g=1", "display_name": "dimsuz", "link": "https://stackoverflow.com/users/258848/dimsuz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2811, "favorite_count": 2, "accepted_answer_id": 29807651, "answer_count": 1, "score": 14, "last_activity_date": 1506549404, "creation_date": 1429359471, "last_edit_date": 1506549404, "question_id": 29717241, "link": "https://stackoverflow.com/questions/29717241/is-there-a-way-to-have-a-private-file-constant-in-kotlin", "title": "Is there a way to have a private file constant in Kotlin", "body": "<p>Suppose I have some Utils.kt file which will contain only some utility functions, no classes, no objects. And suppose that those functions use some common set of constant values.</p>\n\n<p>So I do something like this:</p>\n\n<pre><code>package myapp\n\nprivate val CONST1 = 1\nprivate val CONST2 = 2\n\npublic fun function1() {}\npublic fun function2() {}\n</code></pre>\n\n<p>Unfortunately Kotlin treats <strong>private</strong> as \"available to the whole package\".\nSo CONST1 and CONST2 are available to all files which are in the same package.\nThe only way to isolate them is to move this file to a separate package.</p>\n\n<p>But what if I have several utility files like this, each with its own set of <em>private</em> constants. Then i have only two options: move each of them to a unique package or give up and have consts from all of them accessible everywhere.</p>\n\n<p>Either way seems to create clutter.</p>\n\n<p>Any options or advice?</p>\n\n<p>(<strong>upd:</strong> actually, I must say this is one of those rare things that bother me in Kotlin - no way to make some entity be file-local (without using some syntax hacks): it's either available to whole package or to everyone at all)</p>\n\n<p><strong>UPD:</strong> This question is now obsolete (see the accepted answer)</p>\n"}]