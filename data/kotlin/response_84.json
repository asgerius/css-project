[{"tags": ["spring", "spring-boot", "internationalization", "locale", "kotlin"], "answers": [{"tags": [], "owner": {"reputation": 705, "user_id": 1583160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/204fddf9820b18f8d994dbec3e860242?s=128&d=identicon&r=PG", "display_name": "irotsoma", "link": "https://stackoverflow.com/users/1583160/irotsoma"}, "is_accepted": true, "score": 1, "last_activity_date": 1471473667, "creation_date": 1471473667, "answer_id": 39007338, "question_id": 39006818, "link": "https://stackoverflow.com/questions/39006818/spring-boot-controller-locale-not-changing-with-parameter/39007338#39007338", "title": "Spring Boot Controller Locale Not Changing with Parameter", "body": "<p>OK, looks like the missing piece was implementing a <code>WebMvcConfigurerAdapter</code>, setting up a <code>SessionLocaleResolver</code> bean, and overriding the <code>addInterceptors</code> function to manually add my <code>LocaleChangeInterceptor</code>.  I used a separate Configuration class to do this.</p>\n\n<pre><code>@Configuration\nopen class CustomWebMvcConfigurerAdapter : WebMvcConfigurerAdapter() {\n\n    //internationalization beans\n    @Bean\n    open fun localeResolver(): LocaleResolver {\n        val slr = SessionLocaleResolver()\n        slr.setDefaultLocale(Locale.US)\n        return slr\n    }\n\n    @Bean\n    open fun localeChangeInterceptor(): LocaleChangeInterceptor {\n        val localeChangeInterceptor = LocaleChangeInterceptor()\n        localeChangeInterceptor.paramName = \"locale\"\n        return localeChangeInterceptor\n    }\n\n    override fun addInterceptors(registry: InterceptorRegistry?) {\n        registry?.addInterceptor(localeChangeInterceptor())\n        super.addInterceptors(registry)\n    }\n}\n</code></pre>\n\n<p>I guess I misunderstood, thinking that Spring Boot handled the <code>LocaleChangeInterceptor</code> on it's own if you created the proper bean, but I guess you have to still override a <code>WebMvcConfigurerAdapter</code> and force the interceptor in there.  If I've missed something and someone has a cleaner solution, I'd be happy to give you the accepted answer since what I'm doing here just feels like a messy workaround.</p>\n"}], "owner": {"reputation": 705, "user_id": 1583160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/204fddf9820b18f8d994dbec3e860242?s=128&d=identicon&r=PG", "display_name": "irotsoma", "link": "https://stackoverflow.com/users/1583160/irotsoma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1455, "favorite_count": 0, "accepted_answer_id": 39007338, "answer_count": 1, "score": 1, "last_activity_date": 1471474632, "creation_date": 1471470706, "last_edit_date": 1471474632, "question_id": 39006818, "link": "https://stackoverflow.com/questions/39006818/spring-boot-controller-locale-not-changing-with-parameter", "title": "Spring Boot Controller Locale Not Changing with Parameter", "body": "<p>I'm having some trouble with using Spring Boot with Kotlin to handle locale.  I created these settings in my application.properties file:</p>\n\n<pre><code>spring.messages.basename=messages/messages\nspring.messages.cache-seconds=-1\nspring.messages.encoding=UTF-8\n</code></pre>\n\n<p>Then created an autowired instance of MessageSource in my controller:</p>\n\n<pre><code>@Autowired\nlateinit var messageSource: MessageSource\n</code></pre>\n\n<p>When put a locale in the url as a parameter, the parameter doesn't seem to get picked up when I call <code>LocaleContextHolder.getLocale()</code>, so it is always en_US.  Though, I can manually pick it up using <code>@RequestParam(value=\"locale\") locale: Locale</code> as a parameter to my controller function and use it from there in the controller function, but not in other functions.  I thought that spring boot LocaleContextHolder was supposed to hold the current locale based on the request URL automatically for the whole session.</p>\n\n<p>I read an older article that mentioned using a LocaleChangeInterceptor bean as well as beans for MessageSource and LocaleResolver in your main class, but another article said Spring Boot doesn't require that.  I tried it anyway with no difference.  These are the functions I used:</p>\n\n<pre><code>@Bean\nopen fun localeResolver(): LocaleResolver {\n    val slr = SessionLocaleResolver()\n    slr.setDefaultLocale(Locale.US)\n    return slr\n}\n\n@Bean\nopen fun localeChangeInterceptor(): LocaleChangeInterceptor {\n    val localeChangeInterceptor = LocaleChangeInterceptor()\n    localeChangeInterceptor.paramName = \"locale\"\n    return localeChangeInterceptor\n}\n\n@Bean\nopen fun messageSource(): ResourceBundleMessageSource {\n    val source = ResourceBundleMessageSource()\n    source.setBasenames(\"messages/messages\")\n    source.setDefaultEncoding(\"UTF-8\")\n    return source\n}\n</code></pre>\n\n<p>Any suggestions on what to try next other than capturing the locale manually and making it a parameter in every function that gets called by the controller?  Thanks!</p>\n"}, {"tags": ["kotlin", "htmlunit"], "answers": [{"tags": [], "owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "is_accepted": false, "score": 3, "last_activity_date": 1471420594, "creation_date": 1471420594, "answer_id": 38991051, "question_id": 38988187, "link": "https://stackoverflow.com/questions/38988187/kotlin-intelij-htmlunit-none-of-the-following-functions-can-be-called-with/38991051#38991051", "title": "Kotlin + Intelij + HtmlUnit: None of the following functions can be called with the arguments supplied", "body": "<p>If you are looking for a way to instantiate an object with a method override, than you need an object expression:</p>\n\n<pre><code>webClient.webConnection = object : FalsifyingWebConnection(webClient) {\n    override fun getResponse(request: WebRequest): WebResponse {\n        if(request.getUrl().getPath().toLowerCase().equals(\"some url i don't need \")) {\n            return createWebResponse(request, \"\", \"application/javascript\");\n        }\n\n        return super.getResponse(request);\n    }\n}\n</code></pre>\n\n<p><a href=\"https://kotlinlang.org/docs/reference/object-declarations.html\" rel=\"nofollow\">https://kotlinlang.org/docs/reference/object-declarations.html</a></p>\n"}], "owner": {"reputation": 225, "user_id": 460146, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6ed6b3c8d4df044471e81a6bb5b5bc73?s=128&d=identicon&r=PG", "display_name": "taniGroup", "link": "https://stackoverflow.com/users/460146/tanigroup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 835, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1471420594, "creation_date": 1471408598, "question_id": 38988187, "link": "https://stackoverflow.com/questions/38988187/kotlin-intelij-htmlunit-none-of-the-following-functions-can-be-called-with", "title": "Kotlin + Intelij + HtmlUnit: None of the following functions can be called with the arguments supplied", "body": "<p>I'm using HtmlUnit for my project, when I tried the below code:</p>\n\n<pre><code>webClient.webConnection = FalsifyingWebConnection(webClient) {\n            fun getResponse(request: WebRequest): WebResponse {\n                if(request.getUrl().getPath().toLowerCase().equals(\"some url i don't need \")) {\n                    return createWebResponse(request, \"\", \"application/javascript\");\n                }\n\n            return super.getResponse(request);\n        }\n    }\n</code></pre>\n\n<p>Error happens at <strong>FalsifyingWebConnection(webClient)</strong>, which says:</p>\n\n<p><a href=\"https://i.stack.imgur.com/hJyl7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hJyl7.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["java", "dependencies", "mailchimp", "kotlin"], "comments": [{"owner": {"reputation": 41460, "user_id": 2310289, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PO7Uz.jpg?s=128&g=1", "display_name": "Scary Wombat", "link": "https://stackoverflow.com/users/2310289/scary-wombat"}, "edited": false, "score": 2, "creation_date": 1471408560, "post_id": 38988170, "comment_id": 65328710, "body": "dowload <code>kotlin-runtime.jar</code>"}, {"owner": {"reputation": 41460, "user_id": 2310289, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PO7Uz.jpg?s=128&g=1", "display_name": "Scary Wombat", "link": "https://stackoverflow.com/users/2310289/scary-wombat"}, "edited": false, "score": 1, "creation_date": 1471408585, "post_id": 38988170, "comment_id": 65328715, "body": "see <a href=\"https://discuss.kotlinlang.org/t/java-lang-noclassdeffounderror-kotlin-jvm-internal-reflection/287\" rel=\"nofollow noreferrer\">discuss.kotlinlang.org/t/&hellip;</a>"}, {"owner": {"reputation": 539, "user_id": 3803046, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c15b2f0bc1bd93f5f4aaa3cf27de2193?s=128&d=identicon&r=PG&f=1", "display_name": "corpico", "link": "https://stackoverflow.com/users/3803046/corpico"}, "reply_to_user": {"reputation": 41460, "user_id": 2310289, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PO7Uz.jpg?s=128&g=1", "display_name": "Scary Wombat", "link": "https://stackoverflow.com/users/2310289/scary-wombat"}, "edited": false, "score": 0, "creation_date": 1471409597, "post_id": 38988170, "comment_id": 65328975, "body": "I do like the easy fixes. Thanks, that got rid of the exception, but now there&#39;s another: <code>NoClassDefFoundError: kotlin&#47;text&#47;Charsets</code>. The Kotlin literature seems to be well-hidden. Do you know where this dependency might be?"}, {"owner": {"reputation": 67242, "user_id": 1189885, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/DLHqU.png?s=128&g=1", "display_name": "chrylis -cautiouslyoptimistic-", "link": "https://stackoverflow.com/users/1189885/chrylis-cautiouslyoptimistic"}, "edited": false, "score": 1, "creation_date": 1471409807, "post_id": 38988170, "comment_id": 65329035, "body": "@corpico, you want <a href=\"https://search.maven.org\" rel=\"nofollow noreferrer\">the Central Repository</a>. Search for <code>fc:kotlin.text.Charsets</code> (full classname). In this case, it isn&#39;t <i>on</i> Central, which ought to be filed as a bug against Kotlin itself."}, {"owner": {"reputation": 539, "user_id": 3803046, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c15b2f0bc1bd93f5f4aaa3cf27de2193?s=128&d=identicon&r=PG&f=1", "display_name": "corpico", "link": "https://stackoverflow.com/users/3803046/corpico"}, "edited": false, "score": 0, "creation_date": 1471410859, "post_id": 38988170, "comment_id": 65329392, "body": "Awesome! I was able to track it down. For anyone searching in the future, it&#39;s under stdlib: <a href=\"https://search.maven.org/#search%7Cga%7C1%7Ca%3A%22kotlin-stdlib%22\" rel=\"nofollow noreferrer\">Central Repository</a>"}, {"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1471422910, "post_id": 38988170, "comment_id": 65335396, "body": "You should absolutely not use classpath as a way to add dependancies! This is a Maven&#39;s or Gradle&#39;s job, not yours"}], "answers": [{"comments": [{"owner": {"reputation": 539, "user_id": 3803046, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c15b2f0bc1bd93f5f4aaa3cf27de2193?s=128&d=identicon&r=PG&f=1", "display_name": "corpico", "link": "https://stackoverflow.com/users/3803046/corpico"}, "edited": false, "score": 0, "creation_date": 1471452003, "post_id": 38991717, "comment_id": 65355768, "body": "Can you elaborate a bit. Sorry, I&#39;ve never used Maven before and am trying to learn. I just have a normal Java project in Netbeans and have always just added Jar files to use 3rd-party libraries. Is there no way (or is the wrong way) to package up MaleOrang and all its dependencies so my project can use it?"}, {"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "reply_to_user": {"reputation": 539, "user_id": 3803046, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c15b2f0bc1bd93f5f4aaa3cf27de2193?s=128&d=identicon&r=PG&f=1", "display_name": "corpico", "link": "https://stackoverflow.com/users/3803046/corpico"}, "edited": false, "score": 0, "creation_date": 1471454090, "post_id": 38991717, "comment_id": 65356892, "body": "there sure is a way to package all in one, but it is used for distribution in special cases, not for working around NetBeans"}, {"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "reply_to_user": {"reputation": 539, "user_id": 3803046, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c15b2f0bc1bd93f5f4aaa3cf27de2193?s=128&d=identicon&r=PG&f=1", "display_name": "corpico", "link": "https://stackoverflow.com/users/3803046/corpico"}, "edited": false, "score": 0, "creation_date": 1471454162, "post_id": 38991717, "comment_id": 65356934, "body": "My point is that you are trying to swing agains the flow, and thus hit the rocks nobody else does. Make your life easier ;)"}, {"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "reply_to_user": {"reputation": 539, "user_id": 3803046, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c15b2f0bc1bd93f5f4aaa3cf27de2193?s=128&d=identicon&r=PG&f=1", "display_name": "corpico", "link": "https://stackoverflow.com/users/3803046/corpico"}, "edited": false, "score": 0, "creation_date": 1471454396, "post_id": 38991717, "comment_id": 65357077, "body": "If you are a newbie, from my experience: 1) forget about NetBeans 2) instal InteliJ Idea CE 3) use its package manager in project settings to import libs from Maven Central 4) never manually download a jar again. This will set you up for playing around and simple projects"}, {"owner": {"reputation": 539, "user_id": 3803046, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c15b2f0bc1bd93f5f4aaa3cf27de2193?s=128&d=identicon&r=PG&f=1", "display_name": "corpico", "link": "https://stackoverflow.com/users/3803046/corpico"}, "edited": false, "score": 0, "creation_date": 1471458008, "post_id": 38991717, "comment_id": 65359046, "body": "If I do want to, not distribute this, but use it all packaged up and self-contained on a flash drive independent of the IDE, is there a way to do that? I&#39;m following your lead, making a project with the MaleOrang pom, but when I <i>Build with Dependencies</i>, an empty jar is spit out with the warning: <code>JAR will be empty - no content was marked for inclusion!</code>"}, {"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "reply_to_user": {"reputation": 539, "user_id": 3803046, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c15b2f0bc1bd93f5f4aaa3cf27de2193?s=128&d=identicon&r=PG&f=1", "display_name": "corpico", "link": "https://stackoverflow.com/users/3803046/corpico"}, "edited": false, "score": 0, "creation_date": 1471458392, "post_id": 38991717, "comment_id": 65359263, "body": "make sure your directory structure is <i>exactly</i> as it is supposed to be. Feel free to google Maven questions like that one: <a href=\"http://stackoverflow.com/questions/19606739/maven-jar-will-be-empty-no-content-was-marked-for-inclusion\" title=\"maven jar will be empty no content was marked for inclusion\">stackoverflow.com/questions/19606739/&hellip;</a>"}], "tags": [], "owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "is_accepted": true, "score": 1, "last_activity_date": 1471454820, "last_edit_date": 1471454820, "creation_date": 1471422695, "answer_id": 38991717, "question_id": 38988170, "link": "https://stackoverflow.com/questions/38988170/how-to-use-kotlin-written-mailchimp-wrapper-in-java-project/38991717#38991717", "title": "How to use Kotlin-written MailChimp wrapper in Java Project", "body": "<p>I think you got the whole thing the wrong way around. </p>\n\n<p>A java lib is NOT supposed to be downloaded as a <code>.jar</code>. Instead, one <strong>must</strong> use build and dependancy management tools for that. </p>\n\n<p>As the README mentions, MaleOrang is accessible though <a href=\"http://search.maven.org/#search%7Cgav%7C1%7Cg%3A%22com.ecwid%22%20AND%20a%3A%22maleorang%22\" rel=\"nofollow\">MavenCentral</a>.</p>\n\n<p>Add Maven or Gradle to your project, then add <code>com.ecwid:maleorang:3.0-0.9.2</code> in the configuration file as a dependency.</p>\n\n<p>That way you'll be able to use any Java lib in a heart bit without warring about it dependancies (which may change over time).</p>\n"}], "owner": {"reputation": 539, "user_id": 3803046, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c15b2f0bc1bd93f5f4aaa3cf27de2193?s=128&d=identicon&r=PG&f=1", "display_name": "corpico", "link": "https://stackoverflow.com/users/3803046/corpico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 524, "favorite_count": 0, "accepted_answer_id": 38991717, "answer_count": 1, "score": 0, "last_activity_date": 1471454820, "creation_date": 1471408431, "question_id": 38988170, "link": "https://stackoverflow.com/questions/38988170/how-to-use-kotlin-written-mailchimp-wrapper-in-java-project", "title": "How to use Kotlin-written MailChimp wrapper in Java Project", "body": "<p>I'm using <a href=\"https://github.com/Ecwid/maleorang\" rel=\"nofollow\">MaleOrang</a>, a java wrapper for <a href=\"https://mailchimp.com\" rel=\"nofollow\">MailChimp</a>, which is one of the more popular email marketing sites. I added the MaleOrang jar file to my project's classpath and used the following example to connect to MailChimp and add a subscriber to my account:</p>\n\n<pre><code>public void RunMailChimp() throws Exception {\n        MailchimpClient client = new MailchimpClient(apiKey);\n        try {\n            EditMemberMethod.CreateOrUpdate method = new EditMemberMethod.CreateOrUpdate(listId, Email);\n            method.status = \"subscribed\";\n            method.merge_fields = new MailchimpObject();\n            method.merge_fields.mapping.put(\"FNAME\", firstName);\n            method.merge_fields.mapping.put(\"LNAME\", lastName);\n\n            MemberInfo member = client.execute(method);\n            System.err.println(\"The user has been successfully subscribed: \" + member);\n        } finally {\n            client.close();\n        }\n    }\n</code></pre>\n\n<p>The following error popped up though. The guy behind MaleOrang says his wrapper is written in Kotlin language, which I have no experience with, but am assuming this error has to do with that. Can anyone provide insight into how this works?</p>\n\n<pre><code>Exception in thread \"JavaFX Application Thread\" java.lang.NoClassDefFoundError: kotlin/jvm/internal/Intrinsics\n    at com.ecwid.maleorang.MailchimpClient.&lt;init&gt;(MailchimpClient.kt)\n    ...\n</code></pre>\n"}, {"tags": ["android", "realm", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "edited": false, "score": 0, "creation_date": 1471385567, "post_id": 38983203, "comment_id": 65323309, "body": "yo pretty clever that way, it used java8 try with resources. Tomorrow gona try to refactor it to use fromCallable instead of defer+just. Gona check if it works, or if it doesnt and you knew it why it isnt the same. and i&#39;ll accept your answer accordingly. thank you so much!"}, {"owner": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "edited": false, "score": 0, "creation_date": 1471425410, "post_id": 38983203, "comment_id": 65336998, "body": "can you check my edit and comment whether its the same thing or will produce different results. For me, its the same. I&#39;ll accept your answer"}, {"owner": {"reputation": 70518, "user_id": 2413303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kLhXq.jpg?s=128&g=1", "display_name": "EpicPandaForce", "link": "https://stackoverflow.com/users/2413303/epicpandaforce"}, "reply_to_user": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "edited": false, "score": 0, "creation_date": 1471532971, "post_id": 38983203, "comment_id": 65393839, "body": "Yes, it seems to be the same, and if it works then great :)"}], "tags": [], "owner": {"reputation": 70518, "user_id": 2413303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kLhXq.jpg?s=128&g=1", "display_name": "EpicPandaForce", "link": "https://stackoverflow.com/users/2413303/epicpandaforce"}, "is_accepted": true, "score": 2, "last_activity_date": 1471377016, "last_edit_date": 1471377016, "creation_date": 1471376589, "answer_id": 38983203, "question_id": 38981751, "link": "https://stackoverflow.com/questions/38981751/android-kotlin-realm-proper-way-of-query-return-unmanaged-items-on-bg-thread/38983203#38983203", "title": "Android Kotlin Realm Proper Way of Query+ Return Unmanaged Items on Bg Thread", "body": "<p>This is how you would turn your Realm objects unmanaged:</p>\n\n<pre><code>    return Observable.defer(() -&gt; {\n        try(Realm realm = Realm.getDefaultInstance()) {\n            return Observable.just(\n                realm.copyFromRealm(\n                    realm.where(ItemRealm.class).equalTo(\"sent\", false).findAll()\n                )\n            );\n        }\n    }).subscribeOn(Schedulers.io());\n</code></pre>\n\n<p>Although this answer is Java, the Kotlin answer is just half step away.</p>\n"}], "owner": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 1, "accepted_answer_id": 38983203, "answer_count": 1, "score": 1, "last_activity_date": 1471425382, "creation_date": 1471371094, "last_edit_date": 1471425382, "question_id": 38981751, "link": "https://stackoverflow.com/questions/38981751/android-kotlin-realm-proper-way-of-query-return-unmanaged-items-on-bg-thread", "title": "Android Kotlin Realm Proper Way of Query+ Return Unmanaged Items on Bg Thread", "body": "<p>What is the proper way of querying and returning an unmanaged result of items with realm, everything in the background thread?. I'm using somethibf like this:</p>\n\n<pre><code>return Observable.just(1)\n                .subscribeOn(Schedulers.io())\n                .map {\n                    val realm = Realm.getDefaultInstance()\n                    val results = realm.where(ItemRealm::class.java)\n                            .equalTo(\"sent\", false).findAll()\n\n                    realm to results\n                }\n                .map {\n                    val (realm, results) = it\n                    val unManagedResults = realm.copyFromRealm(results)\n                    realm.close()\n                    unManagedResults\n                }\n    }\n</code></pre>\n\n<p>And then chaining this observable with another one that will post the results to a server.</p>\n\n<p>The solution working, although is a bit ugly on this aspects:</p>\n\n<ul>\n<li>No proper way of wrapping the realmQuery in an observable, because\nthere is no way of opening a realInstance in a background thread without this kind of cheat (at least that i know about), so i need to use this fake\nobservable <code>Observable.just(1)</code>.</li>\n<li><p>Not the best place to open and close Realm instances, inside first and second map</p></li>\n<li><p>I don't know if it is guaranteed that the realm instance is closed after all the items have been copied.</p></li>\n</ul>\n\n<p>So what is the proper way of Query and Return unmanaged results on the background thread (some context, i need this to send the results to a server, in the background and as this task is totally independent from my app current data flow, so it should be off the main thread).</p>\n\n<p>Suggested Version:</p>\n\n<pre><code>return Observable.fromCallable {\n            Realm.getDefaultInstance().use { realm -&gt;\n                realm.copyFromRealm(\n                        realm.where(ItemRealm::class.java)\n                                .equalTo(ItemRealm.FIELD_SEND, false).findAll()\n                )\n            }\n        }\n</code></pre>\n"}, {"tags": ["kotlin"], "comments": [{"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "edited": false, "score": 0, "creation_date": 1471371966, "post_id": 38980648, "comment_id": 65316743, "body": "Why not use <code>main</code> to do the initialization?"}, {"owner": {"reputation": 3962, "user_id": 2789327, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/819a89b05f92171a5bb1e3e20f0832ae?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/2789327/dan"}, "reply_to_user": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "edited": false, "score": 0, "creation_date": 1471372231, "post_id": 38980648, "comment_id": 65316889, "body": "Because I picked a bad toy example. Imagine a file full of related free functions that all depend on some shared initialization. Arguably I could just wrap those in a named <code>object</code>, but a lot of the beauty of kotlin is generally not being forced to do stuff like that."}, {"owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "edited": false, "score": 0, "creation_date": 1471376111, "post_id": 38980648, "comment_id": 65318992, "body": "Got it. Unfortunately I don&#39;t know of a way to do that other than your workaround or a variant. e.g. <code>val static_init = run { println(&quot;workaround&quot;) }</code> or <code>val static_init = object { init { println(&quot;workaround&quot;) } }</code>."}], "answers": [{"tags": [], "owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "is_accepted": false, "score": 3, "last_activity_date": 1471421223, "creation_date": 1471421223, "answer_id": 38991251, "question_id": 38980648, "link": "https://stackoverflow.com/questions/38980648/how-to-write-a-package-level-static-initializer-in-kotlin/38991251#38991251", "title": "How to write a package-level static initializer in Kotlin?", "body": "<p>As you mentioned, you need a property with something that would run on initialisation:</p>\n\n<pre><code>val x = run {\n    println(\"The package class has loaded\")\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7656, "user_id": 1938929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/OeAme.png?s=128&g=1", "display_name": "Jire", "link": "https://stackoverflow.com/users/1938929/jire"}, "edited": false, "score": 0, "creation_date": 1471504292, "post_id": 38992087, "comment_id": 65375095, "body": "In Kotlin 1.1, you can use Kotlin Script (.kts) which will run code without needing a declaration. This is kind of similar to what the asker wants."}], "tags": [], "owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "is_accepted": true, "score": 8, "last_activity_date": 1471423994, "creation_date": 1471423994, "answer_id": 38992087, "question_id": 38980648, "link": "https://stackoverflow.com/questions/38980648/how-to-write-a-package-level-static-initializer-in-kotlin/38992087#38992087", "title": "How to write a package-level static initializer in Kotlin?", "body": "<p>Currently there is no way to add code to the static constructor generated for Kotlin file classes, only top-level property initializers are getting there. This sounds like a feature request, so now there is an issue to track this: <a href=\"https://youtrack.jetbrains.com/issue/KT-13486\" rel=\"noreferrer\">KT-13486</a> Package-level 'init' blocks</p>\n\n<p>Another workaround is to place initialization in top-level private/internal object and reference that object in those functions that depend on the effect of that initialization. Objects are initialized lazily, when they are referenced first time.</p>\n\n<pre><code>fun dependsOnState(arg: Int) = State.run {\n    arg + value\n}\n\nprivate object State {\n    val value: Int\n    init {\n        value = 42\n        println(\"State was initialized\")\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3962, "user_id": 2789327, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/819a89b05f92171a5bb1e3e20f0832ae?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/2789327/dan"}, "edited": false, "score": 0, "creation_date": 1498060003, "post_id": 44450492, "comment_id": 76345778, "body": "If all you need is a single, lazily-initialized value like this, Kotlin has a builtin for you: <code>val table: MutableMap&lt;String, Int&gt; by lazy(::HashMap)</code>"}], "tags": [], "owner": {"reputation": 1387, "user_id": 3835455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qdBh3.png?s=128&g=1", "display_name": "Eric Liu", "link": "https://stackoverflow.com/users/3835455/eric-liu"}, "is_accepted": false, "score": 0, "last_activity_date": 1496990033, "last_edit_date": 1496990033, "creation_date": 1496988719, "answer_id": 44450492, "question_id": 38980648, "link": "https://stackoverflow.com/questions/38980648/how-to-write-a-package-level-static-initializer-in-kotlin/44450492#44450492", "title": "How to write a package-level static initializer in Kotlin?", "body": "<p>I got around it by using a Backing Property on the top-level, under the Kotlin file. <a href=\"https://kotlinlang.org/docs/reference/properties.html#backing-properties\" rel=\"nofollow noreferrer\">Kotlin Docs: Backing Properties</a></p>\n\n<pre><code>private var _table: Map&lt;String, Int&gt;? = null\npublic val table: Map&lt;String, Int&gt;\n    get() {\n        if (_table == null) {\n            _table = HashMap() // Type parameters are inferred\n           // .... some other initialising code here\n        }\n        return _table ?: throw AssertionError(\"Set to null by another thread\")\n    }\n</code></pre>\n"}], "owner": {"reputation": 3962, "user_id": 2789327, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/819a89b05f92171a5bb1e3e20f0832ae?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/2789327/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2662, "favorite_count": 1, "accepted_answer_id": 38992087, "answer_count": 3, "score": 8, "last_activity_date": 1496990033, "creation_date": 1471367069, "last_edit_date": 1495541613, "question_id": 38980648, "link": "https://stackoverflow.com/questions/38980648/how-to-write-a-package-level-static-initializer-in-kotlin", "title": "How to write a package-level static initializer in Kotlin?", "body": "<p><a href=\"https://stackoverflow.com/questions/37262468/static-initialisation-block-in-kotlin\">A previous question</a> shows how to put a static initializer inside a class using its <a href=\"http://kotlinlang.org/docs/reference/object-declarations.html#companion-objects\" rel=\"noreferrer\"><code>companion object</code></a>. I'm trying to find a way to add a static initializer at the package level, but it seems packages have no companion object.</p>\n\n<pre><code>// compiler error: Modifier 'companion' is not applicable inside 'file'\ncompanion object { init { println(\"Loaded!\") } }\nfun main(args: Array&lt;String&gt;) { println(\"run!\") }\n</code></pre>\n\n<p>I've tried other variations that might've made sense (<code>init</code> on its own, <code>static</code>), and I know as a workaround I can use a throwaway <code>val</code> as in</p>\n\n<pre><code>val static_init = {\n    println(\"ugly workaround\")\n}()\n</code></pre>\n\n<p>but is there a clean, official way to achieve the same result?</p>\n\n<hr>\n\n<p>Edit: As <a href=\"https://stackoverflow.com/questions/38980648/how-to-write-a-package-level-static-initializer-in-kotlin/38981598#38981598\">@mfulton26's answer</a> mentions, there is no such thing as a package-level function really in the JVM. Behind the scenes, the kotlin compiler is <a href=\"https://kotlinlang.org/docs/reference/java-to-kotlin-interop.html\" rel=\"noreferrer\">wrapping any free functions, including <code>main</code> in a class</a>. I'm trying to add a static initializer to <em>that</em> class -- the class being generated by kotlin for the free functions declared in the file. </p>\n"}, {"tags": ["android", "realm", "kotlin"], "comments": [{"owner": {"reputation": 70518, "user_id": 2413303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kLhXq.jpg?s=128&g=1", "display_name": "EpicPandaForce", "link": "https://stackoverflow.com/users/2413303/epicpandaforce"}, "edited": false, "score": 0, "creation_date": 1471357753, "post_id": 38977533, "comment_id": 65308041, "body": "I&#39;m mostly surprised it didn&#39;t just crash altogether, saying you&#39;re trying to add a change listener on a non-looper thread, or that you&#39;re accessing a background thread&#39;s Realm object from the UI thread."}, {"owner": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "reply_to_user": {"reputation": 70518, "user_id": 2413303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kLhXq.jpg?s=128&g=1", "display_name": "EpicPandaForce", "link": "https://stackoverflow.com/users/2413303/epicpandaforce"}, "edited": false, "score": 0, "creation_date": 1471358872, "post_id": 38977533, "comment_id": 65308814, "body": "ya. realm edit please"}, {"owner": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "reply_to_user": {"reputation": 70518, "user_id": 2413303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kLhXq.jpg?s=128&g=1", "display_name": "EpicPandaForce", "link": "https://stackoverflow.com/users/2413303/epicpandaforce"}, "edited": false, "score": 0, "creation_date": 1471358923, "post_id": 38977533, "comment_id": 65308848, "body": "any idea why keep giving access on different thread on edit 2?"}, {"owner": {"reputation": 70518, "user_id": 2413303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kLhXq.jpg?s=128&g=1", "display_name": "EpicPandaForce", "link": "https://stackoverflow.com/users/2413303/epicpandaforce"}, "edited": false, "score": 0, "creation_date": 1471359427, "post_id": 38977533, "comment_id": 65309165, "body": "This truly depends on where you&#39;re calling <code>setItemDeleted()</code> from."}, {"owner": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "reply_to_user": {"reputation": 70518, "user_id": 2413303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kLhXq.jpg?s=128&g=1", "display_name": "EpicPandaForce", "link": "https://stackoverflow.com/users/2413303/epicpandaforce"}, "edited": false, "score": 0, "creation_date": 1471359541, "post_id": 38977533, "comment_id": 65309244, "body": "calling it from main thread"}, {"owner": {"reputation": 70518, "user_id": 2413303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kLhXq.jpg?s=128&g=1", "display_name": "EpicPandaForce", "link": "https://stackoverflow.com/users/2413303/epicpandaforce"}, "edited": false, "score": 0, "creation_date": 1471359802, "post_id": 38977533, "comment_id": 65309425, "body": "....I still think your error is elsewhere. I&#39;d have to see a stack trace to tell for certain."}, {"owner": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "reply_to_user": {"reputation": 70518, "user_id": 2413303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kLhXq.jpg?s=128&g=1", "display_name": "EpicPandaForce", "link": "https://stackoverflow.com/users/2413303/epicpandaforce"}, "edited": false, "score": 0, "creation_date": 1471360034, "post_id": 38977533, "comment_id": 65309567, "body": "the stack trace point to the query line. This solved the problem: Observable.just(item\u200c\u200bId) .subscribeOn(Schedul\u200c\u200bers.io()) .subscribe { val realm = Realm.getDefaultInst\u200c\u200bance() realm.executeTransac\u200c\u200btion { realm.where(ItemReal\u200c\u200bm::class.java).findFi\u200c\u200brst().userDelet&zwnj;&#8203;ed = true } }"}], "answers": [{"comments": [{"owner": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "edited": false, "score": 0, "creation_date": 1471358461, "post_id": 38977646, "comment_id": 65308533, "body": "ok. but either way it won&#39;t work. Think its because i&#39;m getting a new fresh realm instance in the main threads, and then i&#39;m using it on bg thread. Error: java.lang.IllegalStateException: Realm access from incorrect thread. Realm objects can only be accessed on the thread they were created."}, {"owner": {"reputation": 70518, "user_id": 2413303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kLhXq.jpg?s=128&g=1", "display_name": "EpicPandaForce", "link": "https://stackoverflow.com/users/2413303/epicpandaforce"}, "reply_to_user": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "edited": false, "score": 0, "creation_date": 1471358513, "post_id": 38977646, "comment_id": 65308568, "body": "....that shouldn&#39;t be the case with <b>this</b> code I wrote, so I think that crash is coming from elsewhere."}, {"owner": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "edited": false, "score": 0, "creation_date": 1471358545, "post_id": 38977646, "comment_id": 65308594, "body": "tried this and works:  Observable.just(itemId)                 .subscribeOn(Schedulers.io())                 .subscribe {                     val realm = Realm.getDefaultInstance()                     realm.executeTransaction {                         realm.where(ItemRealm::class.java).findFirst().userDeleted = true                     }                 }"}, {"owner": {"reputation": 70518, "user_id": 2413303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kLhXq.jpg?s=128&g=1", "display_name": "EpicPandaForce", "link": "https://stackoverflow.com/users/2413303/epicpandaforce"}, "reply_to_user": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "edited": false, "score": 0, "creation_date": 1471358713, "post_id": 38977646, "comment_id": 65308721, "body": "Well you kinda shoulda added the fact you&#39;re using RX into the question. But yes, that works."}, {"owner": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "edited": false, "score": 0, "creation_date": 1471358768, "post_id": 38977646, "comment_id": 65308759, "body": "i wasn&#39;t. but with your solution it gives me that error. I think it&#39;s weird too. Can&#39;t understand why"}, {"owner": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "edited": false, "score": 0, "creation_date": 1471361057, "post_id": 38977646, "comment_id": 65310295, "body": "this sounds like the solution. bona try it out :p but i&#39;m also positive thats the reason"}, {"owner": {"reputation": 22949, "user_id": 6998684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqR2Z.jpg?s=128&g=1", "display_name": "IgorGanapolsky", "link": "https://stackoverflow.com/users/6998684/igorganapolsky"}, "edited": false, "score": 0, "creation_date": 1602862349, "post_id": 38977646, "comment_id": 113863489, "body": "We shouldn&#39;t use <code>executeTransactionAwait</code>?"}, {"owner": {"reputation": 70518, "user_id": 2413303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kLhXq.jpg?s=128&g=1", "display_name": "EpicPandaForce", "link": "https://stackoverflow.com/users/2413303/epicpandaforce"}, "edited": false, "score": 0, "creation_date": 1602896444, "post_id": 38977646, "comment_id": 113873780, "body": "What is <code>executeTransactionAwait</code>? Technically I used <code>executeTransactionAsync</code> here because I was assuming that UI thread writes have been happening, and the easiest way to do a background thread write with realm is <code>executeTransactionAsync</code>. Of course, you can use synchronous write on background thread too."}], "tags": [], "owner": {"reputation": 70518, "user_id": 2413303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kLhXq.jpg?s=128&g=1", "display_name": "EpicPandaForce", "link": "https://stackoverflow.com/users/2413303/epicpandaforce"}, "is_accepted": true, "score": 3, "last_activity_date": 1471360936, "last_edit_date": 1471360936, "creation_date": 1471357874, "answer_id": 38977646, "question_id": 38977533, "link": "https://stackoverflow.com/questions/38977533/android-kotlin-realm-proper-way-to-queryupdate-async/38977646#38977646", "title": "Android Kotlin Realm Proper Way to Query+Update Async", "body": "<p>Everything in <code>executeTransactionAsync()</code> runs on a background thread, so you should use the synchronous methods to obtain your object inside it.</p>\n\n<pre><code>Realm.getDefaultInstance().use { realm -&gt;\n    realm.executeTransactionAsync { bgRealm -&gt;\n        // find the item\n        val item = bgRealm.where(ItemRealm::class.java)\n                        .equalTo(ItemRealm.ID, itemId).findFirst()\n        item?.deleted = true\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3925, "user_id": 3806331, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ab7f221d4245947fd3260c364ffd0645?s=128&d=identicon&r=PG&f=1", "display_name": "johnny_crq", "link": "https://stackoverflow.com/users/3806331/johnny-crq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2450, "favorite_count": 0, "accepted_answer_id": 38977646, "answer_count": 1, "score": 3, "last_activity_date": 1471360936, "creation_date": 1471357537, "last_edit_date": 1471358838, "question_id": 38977533, "link": "https://stackoverflow.com/questions/38977533/android-kotlin-realm-proper-way-to-queryupdate-async", "title": "Android Kotlin Realm Proper Way to Query+Update Async", "body": "<p>I recently faced a problem in which i had in memory a RealResult List of objects and was showing it in a view. Upon user click, the current showing item should be marked as deleted in realm (property <code>isDeleted</code>)</p>\n\n<p>So i was just getting that object from the lazy <code>RealmResults</code> list, open a transaction and mark it deleted. As the RealmResults are auto-updated, i had a change listener bound to a <code>notifityDataSetChanged</code>. Everything works fine except this warning:</p>\n\n<pre><code>Mixing asynchronous queries with local writes should be avoided. Realm will convert any async queries to synchronous in order to remain consistent. Use asynchronous writes instead\n</code></pre>\n\n<p>Which is problematic because my list is enormous and i don't want the query to become <code>sync</code>. I solved it this way, which i don't know it it is right. Instead of giving the item object to the update function, i give the id of the object, and then do this:</p>\n\n<pre><code>Realm.getDefaultInstance().use { realm -&gt;\n\n            realm.executeTransactionAsync {\n                // find the item\n                realm.where(ItemRealm::class.java)\n                        .equalTo(ItemRealm.ID, itemId).findFirstAsync()\n                        .addChangeListener(object : RealmChangeListener&lt;ItemRealm&gt; {\n                            override fun onChange(element: ItemRealm) {\n                                element.deleted = true\n                                element.removeChangeListener(this)\n                            }\n                        })\n            }\n        }\n</code></pre>\n\n<p>The problem which im unsure is the <code>async</code> part of the query inside an async transaction.</p>\n\n<p>Edit. Actually, it throws <code>java.lang.IllegalStateException: Realm access from incorrect thread. Realm objects can only be accessed on the thread they were created.</code></p>\n\n<p>Edit2: Tried this and show Realm access on different thread:</p>\n\n<pre><code>fun setItemDeleted(itemId: Long) {\n        // write so new realm instance\n        Realm.getDefaultInstance().use { realm -&gt;\n            realm.executeTransactionAsync {\n                // find the item\n                val item = realm.where(ItemRealm::class.java)\n                        .equalTo(ItemRealm.TIMESTAMP, itemId).findFirst()\n                item?.userDeleted = true\n            }\n        }\n    }\n</code></pre>\n"}, {"tags": ["kotlin", "kotlin-extension"], "answers": [{"comments": [{"owner": {"reputation": 1656, "user_id": 1211920, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3f037af7c4795183b297f6fdaeb24922?s=128&d=identicon&r=PG", "display_name": "Igor Wojda", "link": "https://stackoverflow.com/users/1211920/igor-wojda"}, "edited": false, "score": 1, "creation_date": 1471415927, "post_id": 38975680, "comment_id": 65331435, "body": "Thanks a lot this sentence makes everything clear for me &quot;If foo were declared outside of class C then it would only have one receiver which would be the extension receiver D.&quot;"}], "tags": [], "owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "is_accepted": true, "score": 5, "last_activity_date": 1471352394, "creation_date": 1471352394, "answer_id": 38975680, "question_id": 38973124, "link": "https://stackoverflow.com/questions/38973124/is-there-any-difference-between-receiver-object-and-extension-receiver/38975680#38975680", "title": "Is there any difference between &quot;receiver object&quot; and &quot;extension receiver&quot;", "body": "<p>An <em>extension receiver</em> is a <em>receiver object</em> while a <em>receiver object</em> is either a <em>dispatch receiver</em> or an <em>extension receiver</em>.</p>\n\n<blockquote>\n  <p>Inside a class, you can declare extensions for another class. Inside such an extension, there are multiple <em>implicit receivers</em> - objects members of which can be accessed without a qualifier. The instance of the class in which the extension is declared is called <em>dispatch receiver</em>, and the instance of the receiver type of the extension method is called <em>extension receiver</em>.</p>\n  \n  <pre><code>class D {\n    fun bar() { ... }\n}\n\nclass C {\n    fun baz() { ... }\n\n    fun D.foo() {\n        bar()   // calls D.bar\n        baz()   // calls C.baz\n    }\n\n    fun caller(d: D) {\n        d.foo()   // call the extension function\n    }\n}\n</code></pre>\n</blockquote>\n\n<p>In the above example the function <code>foo</code> has two <em>implicit receivers</em>: <code>C</code> is the <em>dispatch receiver</em> and <code>D</code> is the <em>extension receiver</em>. If <code>foo</code> were declared outside of <code>class C</code> then it would only have one receiver which would be the <em>extension receiver</em> <code>D</code>.</p>\n\n<p>In short, a <em>receiver object</em> and an <em>extension receiver</em> can be the same but there is also another type of <em>receiver object</em> called a <em>dispatch receiver</em>.</p>\n\n<p>For more details, see <a href=\"https://kotlinlang.org/docs/reference/extensions.html#declaring-extensions-as-members\" rel=\"noreferrer\">Declaring Extensions as Members - Extensions - Kotlin Programming Language</a>.</p>\n"}], "owner": {"reputation": 1656, "user_id": 1211920, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3f037af7c4795183b297f6fdaeb24922?s=128&d=identicon&r=PG", "display_name": "Igor Wojda", "link": "https://stackoverflow.com/users/1211920/igor-wojda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 0, "accepted_answer_id": 38975680, "answer_count": 1, "score": 0, "last_activity_date": 1471352394, "creation_date": 1471345137, "question_id": 38973124, "link": "https://stackoverflow.com/questions/38973124/is-there-any-difference-between-receiver-object-and-extension-receiver", "title": "Is there any difference between &quot;receiver object&quot; and &quot;extension receiver&quot;", "body": "<p>It's hard to tell acording to the docs <a href=\"https://kotlinlang.org/docs/reference/extensions.html\" rel=\"nofollow\">https://kotlinlang.org/docs/reference/extensions.html</a></p>\n\n<p>so I wonder are <strong>receiver object</strong> and <strong>extension receiver</strong> the same? or does the name depends on context?</p>\n"}, {"tags": ["java", "spring", "authentication", "spring-boot", "kotlin"], "answers": [{"comments": [{"owner": {"reputation": 13167, "user_id": 399457, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6a6ed435a024926ffb41d1ad84b3b1f5?s=128&d=identicon&r=PG", "display_name": "Mentiflectax", "link": "https://stackoverflow.com/users/399457/mentiflectax"}, "edited": false, "score": 0, "creation_date": 1471335128, "post_id": 38969581, "comment_id": 65293298, "body": "When I add <code>import org.springframework.security.web.util.AntPathRequestMatcher</code> to the file, the compiler say it can&#39;t resolve the referece."}, {"owner": {"reputation": 119, "user_id": 1264693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d2fee45d40bf9bc22fb5249adb554b?s=128&d=identicon&r=PG", "display_name": "ali2992", "link": "https://stackoverflow.com/users/1264693/ali2992"}, "reply_to_user": {"reputation": 13167, "user_id": 399457, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6a6ed435a024926ffb41d1ad84b3b1f5?s=128&d=identicon&r=PG", "display_name": "Mentiflectax", "link": "https://stackoverflow.com/users/399457/mentiflectax"}, "edited": false, "score": 0, "creation_date": 1471335228, "post_id": 38969581, "comment_id": 65293346, "body": "sorry, try <code>.logoutUrl(&quot;&#47;logout&quot;)</code> instead"}], "tags": [], "owner": {"reputation": 119, "user_id": 1264693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d2fee45d40bf9bc22fb5249adb554b?s=128&d=identicon&r=PG", "display_name": "ali2992", "link": "https://stackoverflow.com/users/1264693/ali2992"}, "is_accepted": false, "score": 0, "last_activity_date": 1471334642, "creation_date": 1471334642, "answer_id": 38969581, "question_id": 38969088, "link": "https://stackoverflow.com/questions/38969088/log-out-doesnt-work-in-spring-boot-application-post-method-not-supported/38969581#38969581", "title": "Log out doesn&#39;t work in Spring Boot application (POST method not supported)", "body": "<p>Have you tried specifying the logout path?</p>\n\n<pre><code>.logout() \n    .logoutSuccessUrl(\"/login\")\n    .logoutRequestMatcher(new AntPathRequestMatcher(\"/logout\"))\n    .permitAll()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13167, "user_id": 399457, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6a6ed435a024926ffb41d1ad84b3b1f5?s=128&d=identicon&r=PG", "display_name": "Mentiflectax", "link": "https://stackoverflow.com/users/399457/mentiflectax"}, "edited": false, "score": 0, "creation_date": 1471337531, "post_id": 38970334, "comment_id": 65294704, "body": "I tried your approach, see &quot;Update 1&quot;. Is that what you&#39;ve meant?"}], "tags": [], "owner": {"reputation": 15647, "user_id": 497381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2XEZf.jpg?s=128&g=1", "display_name": "martin-g", "link": "https://stackoverflow.com/users/497381/martin-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1471337112, "creation_date": 1471337112, "answer_id": 38970334, "question_id": 38969088, "link": "https://stackoverflow.com/questions/38969088/log-out-doesnt-work-in-spring-boot-application-post-method-not-supported/38970334#38970334", "title": "Log out doesn&#39;t work in Spring Boot application (POST method not supported)", "body": "<p>You can add <code>\"/logout\"</code> to the first section of allowed paths.</p>\n\n<p>But why do you use a  with a  for the logout at all? You can use a simple link () that will issue a GET request.</p>\n"}, {"tags": [], "owner": {"reputation": 94, "user_id": 6720074, "user_type": "registered", "profile_image": "https://graph.facebook.com/1078255965601560/picture?type=large", "display_name": "Duc D. Nguyen", "link": "https://stackoverflow.com/users/6720074/duc-d-nguyen"}, "is_accepted": true, "score": 5, "last_activity_date": 1471340972, "creation_date": 1471340972, "answer_id": 38971682, "question_id": 38969088, "link": "https://stackoverflow.com/questions/38969088/log-out-doesnt-work-in-spring-boot-application-post-method-not-supported/38971682#38971682", "title": "Log out doesn&#39;t work in Spring Boot application (POST method not supported)", "body": "<p>I'm not familiar with Thymeleaf, but at least this will give you some idea. </p>\n\n<p>The problem is not your SecurityConfig but the </p>\n\n<blockquote>\n  <p>th:action=\"@{/logout}\" </p>\n</blockquote>\n\n<p>(not redirect to /logout, check Network tab in Chrome or Firefox). </p>\n\n<p>If I replace it with </p>\n\n<blockquote>\n  <p>action=\"/logout\" </p>\n</blockquote>\n\n<p>Then it work perfectly.</p>\n"}], "owner": {"reputation": 13167, "user_id": 399457, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6a6ed435a024926ffb41d1ad84b3b1f5?s=128&d=identicon&r=PG", "display_name": "Mentiflectax", "link": "https://stackoverflow.com/users/399457/mentiflectax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 801, "favorite_count": 0, "accepted_answer_id": 38971682, "answer_count": 3, "score": 3, "last_activity_date": 1471340972, "creation_date": 1471332981, "last_edit_date": 1471337509, "question_id": 38969088, "link": "https://stackoverflow.com/questions/38969088/log-out-doesnt-work-in-spring-boot-application-post-method-not-supported", "title": "Log out doesn&#39;t work in Spring Boot application (POST method not supported)", "body": "<p>I have a Spring Boot application with the following configuration</p>\n\n<pre><code>@Configuration\n@EnableWebSecurity\nopen class WebSecurityConfig : WebSecurityConfigurerAdapter() {\n    override fun configure(http:HttpSecurity) {\n        http\n            .authorizeRequests()\n                .antMatchers(\"/css/**\", \"/js/**\", \"/fonts/**\")\n                .permitAll().and()\n            .formLogin()\n                .loginPage(\"/login\")\n                .permitAll()\n                .and()\n            .authorizeRequests()\n                .anyRequest().authenticated()\n                .and()\n            .logout() \n                .logoutSuccessUrl(\"/login\") \n                .permitAll()\n            .and().csrf().disable()\n    }\n    @Autowired\n    fun configureGlobal(auth:AuthenticationManagerBuilder) {\n        auth\n            .inMemoryAuthentication()\n                .withUser(\"usr@provider.com\").password(\"test\").roles(\"USER\")\n    }\n}\n</code></pre>\n\n<p>When I try to log out, I get the error</p>\n\n<blockquote>\n  <p>There was an unexpected error (type=Method Not Allowed, status=405).\n  Request method 'POST' not supported</p>\n</blockquote>\n\n<p>How can I fix it?</p>\n\n<p><strong>How to reproduce</strong></p>\n\n<ol>\n<li>Check out the code from <a href=\"https://github.com/dpisarenko/spring-boot-logout\" rel=\"nofollow\">this repository</a>.</li>\n<li><code>gradle bootRun</code></li>\n<li>Go to <code>http://localhost:8080</code>, enter <code>usr@provider.com</code> and <code>test</code> as user name and password, respectively.</li>\n<li>Press the logout button.</li>\n</ol>\n\n<p><strong>Update 1:</strong> This doesn't work, either.</p>\n\n<pre><code>http\n    .authorizeRequests()\n        .antMatchers(\"/css/**\", \"/js/**\", \"/fonts/**\", \"/logout\u200c\u200b\")\n        .permitAll().and()\n    .formLogin()\n        .loginPage(\"/login\")\n        .permitAll()\n        .and()\n    .authorizeRequests()\n        .anyRequest().authenticated()\n        .and()\n    .csrf().disable()\n</code></pre>\n"}, {"tags": ["intellij-idea", "gradle", "kotlin"], "answers": [{"tags": [], "owner": {"reputation": 1851, "user_id": 4850160, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HErtk.png?s=128&g=1", "display_name": "memoizr", "link": "https://stackoverflow.com/users/4850160/memoizr"}, "is_accepted": false, "score": -2, "last_activity_date": 1471328525, "creation_date": 1471328525, "answer_id": 38967870, "question_id": 38966625, "link": "https://stackoverflow.com/questions/38966625/configure-intellij-auto-completion-for-gradle-script-in-kotlin/38967870#38967870", "title": "Configure IntelliJ auto-completion for gradle script in kotlin", "body": "<p>Try re-importing the project by selecting <code>settings.gradle</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 16944, "user_id": 1433665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/eb67872e230b18666cedb94bd572809f?s=128&d=identicon&r=PG", "display_name": "TheKojuEffect", "link": "https://stackoverflow.com/users/1433665/thekojueffect"}, "edited": false, "score": 1, "creation_date": 1471394046, "post_id": 38973917, "comment_id": 65325538, "body": "Thanks for your reply. I had tried that but I got <code>ClassCastException: org.gradle.script.lang.kotlin.support.GradleKotlinScriptDepe&zwnj;&#8203;ndenciesResolver cannot be cast to org.jetbrains.kotlin.script.ScriptDependenciesResolver</code> exceptions in the event log. May be it has to do something with IntelliJ version as well. I&#39;m using IntelliJ 2016.2.1"}], "tags": [], "owner": {"reputation": 1706, "user_id": 657503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ljBxD.png?s=128&g=1", "display_name": "Lauw", "link": "https://stackoverflow.com/users/657503/lauw"}, "is_accepted": false, "score": 8, "last_activity_date": 1471507967, "last_edit_date": 1471507967, "creation_date": 1471347445, "answer_id": 38973917, "question_id": 38966625, "link": "https://stackoverflow.com/questions/38966625/configure-intellij-auto-completion-for-gradle-script-in-kotlin/38973917#38973917", "title": "Configure IntelliJ auto-completion for gradle script in kotlin", "body": "<p>Had the same problem. Gradle script Kotlin requires version 1.1x of the IntelliJ Kotlin plugin.</p>\n\n<p>Follow these steps to install it:<br>\n<a href=\"https://github.com/gradle/gradle-script-kotlin/tree/master/samples#install-idea-kotlin-plugin\">https://github.com/gradle/gradle-script-kotlin/tree/master/samples#install-idea-kotlin-plugin</a></p>\n\n<p>The regular update channel only updates to version 1.0.3x right now.</p>\n\n<p><em>Update 18/06:</em><br>\nThe github readme has been updated to include:<br>\n<code>(Note: this version will not work with the official Gradle 3.0 release, stick to the official EAP 1.1 from JetBrains if you intend to use Gradle 3.0)\n</code></p>\n\n<p>If you manually installed version 1.1.0-dev-2222 earlier, uninstall it and restart IntelliJ.</p>\n\n<h3>Install version 1.1.x from the EAP Channel</h3>\n\n<p>This version works with Kotlin-Script in Gradle 3.0.</p>\n\n<p>In IntelliJ, press:<br>\n<code>Tools =&gt; Kotlin =&gt; Configure Kotlin Updates.</code><br>\nSelect<br>\n<code>Early Access Preview 1.1</code><br>\nand press<br>\n<code>Check for updates now</code>.</p>\n\n<p>Download the latest plugin.<br>\n<em>If it gives an error, just restart IntelliJ, it will have installed the plugin.</em></p>\n"}, {"tags": [], "owner": {"reputation": 281, "user_id": 5080165, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yOQuI.png?s=128&g=1", "display_name": "koly", "link": "https://stackoverflow.com/users/5080165/koly"}, "is_accepted": false, "score": 3, "last_activity_date": 1476927561, "last_edit_date": 1476927561, "creation_date": 1476925950, "answer_id": 40143923, "question_id": 38966625, "link": "https://stackoverflow.com/questions/38966625/configure-intellij-auto-completion-for-gradle-script-in-kotlin/40143923#40143923", "title": "Configure IntelliJ auto-completion for gradle script in kotlin", "body": "<p>I tried gradle 3.1 with kotlin-plugin-1.1.0-dev-2222.zip in intellij 2.5. And it works for me.</p>\n\n<p>Here is my intellij version:<br>\nIntelliJ IDEA 2016.2.5\nBuild #IC-162.2228.15, built on October 14, 2016\nJRE: 1.8.0_112-release-287-b2 x86_64\nJVM: OpenJDK 64-Bit Server VM by JetBrains s.r.o</p>\n\n<p>And the steps:</p>\n\n<p>1, Download the kotlin-plugin-1.1.0-dev-2222.zip in <a href=\"https://github.com/gradle/gradle-script-kotlin/tree/master/samples\" rel=\"nofollow\">https://github.com/gradle/gradle-script-kotlin/tree/master/samples</a> and install the plugin in Idea<br>\n2, Create a gradle java project in Idea, and choose to use gradle wrapper<br>\n3, In the terminal, under the project directory, use \"./gradlew wrapper --gradle-version=3.1\" to switch to gradle 3.1<br>\n4, Create a file \"build.gradle.kts\" under the root directory of the project<br>\n5, Add <code>rootProject.buildFileName = 'build.gradle.kts'</code> in the settings.gradle file<br>\n6, Add codes in build.gradle.kts, and if the auto-completion does not work, try \"Refresh all projects\" in the Gradle Tool Window.<br>\n7, If it still not work, restart your Idea</p>\n\n<p>Here is a github repo: <a href=\"https://github.com/kolyjjj/gradle-kotlin-test\" rel=\"nofollow\">https://github.com/kolyjjj/gradle-kotlin-test</a></p>\n"}], "owner": {"reputation": 16944, "user_id": 1433665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/eb67872e230b18666cedb94bd572809f?s=128&d=identicon&r=PG", "display_name": "TheKojuEffect", "link": "https://stackoverflow.com/users/1433665/thekojueffect"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3764, "favorite_count": 2, "answer_count": 3, "score": 22, "last_activity_date": 1503042779, "creation_date": 1471321469, "last_edit_date": 1503042779, "question_id": 38966625, "link": "https://stackoverflow.com/questions/38966625/configure-intellij-auto-completion-for-gradle-script-in-kotlin", "title": "Configure IntelliJ auto-completion for gradle script in kotlin", "body": "<p>I am trying out <strong>gradle-script-kotlin</strong> with simple hello-world application in IntelliJ. But <strong>IntelliJ</strong> auto-completion doesn't popup in <strong>build.gradle.kts</strong> file.</p>\n\n<p><a href=\"https://github.com/gradle/gradle-script-kotlin/tree/master/samples/hello-world\" rel=\"noreferrer\">https://github.com/gradle/gradle-script-kotlin/tree/master/samples/hello-world</a></p>\n\n<p><strong>build.gradle.kts:</strong></p>\n\n<pre><code>apply&lt;ApplicationPlugin&gt;()\n\nconfigure&lt;ApplicationPluginConvention&gt; {\n    mainClassName = \".HelloWorld\"\n}\n\nconfigure&lt;JavaPluginConvention&gt; {\n    setSourceCompatibility(1.8)\n    setTargetCompatibility(1.8)\n}\n\nrepositories {\n    jcenter()\n}\n\ndependencies {\n    testCompile(\"junit:junit:4.12\")\n}\n</code></pre>\n\n<p><strong>settings.gradle:</strong></p>\n\n<pre><code>rootProject.buildFileName = 'build.gradle.kts'\n</code></pre>\n\n<p>I have IntelliJ kotlin plugin and gradle plugin installed and using gradle 3.0. The sample application works with gradle commands.</p>\n\n<p><strong>How to configure IntelliJ to enable auto-completion on build.gradle.kts file?</strong></p>\n\n<p>I'm using IntelliJ 2016.2.2 with kotlin plugin version: 1.0.3-release-IJ2016.1-120</p>\n"}, {"tags": ["scala", "types", "expression", "kotlin"], "comments": [{"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1471258331, "post_id": 38952278, "comment_id": 65261307, "body": "The <code>while</code> code does not seem to be idiomatic for reading. Wouldn&#39;t it better to use (buffered) streams for that?"}], "answers": [{"tags": [], "owner": {"reputation": 19087, "user_id": 900130, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/m5mjk.jpg?s=128&g=1", "display_name": "Zolt&#225;n", "link": "https://stackoverflow.com/users/900130/zolt%c3%a1n"}, "is_accepted": false, "score": 5, "last_activity_date": 1471252550, "creation_date": 1471252550, "answer_id": 38952371, "question_id": 38952278, "link": "https://stackoverflow.com/questions/38952278/kotlin-curly-braces-around-several-expressions-or-statements/38952371#38952371", "title": "Kotlin: Curly braces around several expressions (or statements)", "body": "<p>If <code>{}</code> defines a function, you can just call the function upon declaring it, which will immediately evaluate it:</p>\n\n<pre><code>val a = {\n  val b = 1\n  val c = b + b\n  c + c\n}()\nprintln(a)\n</code></pre>\n\n<p>prints <code>4</code>. (Note the <code>()</code> at the end of the block)</p>\n"}, {"tags": [], "owner": {"reputation": 17986, "user_id": 4730812, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d336a10204c1cd2e7fa47071ed629669?s=128&d=identicon&r=PG&f=1", "display_name": "piotrek1543", "link": "https://stackoverflow.com/users/4730812/piotrek1543"}, "is_accepted": false, "score": 3, "last_activity_date": 1471255123, "last_edit_date": 1495541687, "creation_date": 1471255123, "answer_id": 38952991, "question_id": 38952278, "link": "https://stackoverflow.com/questions/38952278/kotlin-curly-braces-around-several-expressions-or-statements/38952991#38952991", "title": "Kotlin: Curly braces around several expressions (or statements)", "body": "<blockquote>\n  <p>In Scala, every statement is an expression (possibly with Unit type)</p>\n</blockquote>\n\n<p>That's not exactly true. Check: <a href=\"https://stackoverflow.com/questions/10022408/is-everything-a-function-or-expression-or-object-in-scala\">Is everything a function or expression or object in scala?</a></p>\n\n<p>As Zoltan said <code>{}</code> defines functions so instead of:</p>\n\n<pre><code>// Kotlin\nval a = {\n  val b = 1\n  val c = b + b\n  c + c\n}\nprintln(a)\n</code></pre>\n\n<p>it should be:</p>\n\n<pre><code>// Kotlin\nval a = {\n  val b = 1\n  val c = b + b\n  c + c\n}\nprintln(a()) //you defined a function, which returns `4`, not expression\n</code></pre>\n\n<p>or</p>\n\n<pre><code>// Kotlin\nval a = {\n  val b = 1\n  val c = b + b\n  c + c\n}() //note these braces\nprintln(a)\n</code></pre>\n\n<p>If you would like to print a value, not function, you can try to declare the variable and then use one of Kotlin functions to change a value like in example below:</p>\n\n<pre><code>var sum = 0\nints.filter { it &gt; 0 }.forEach {\n  sum += it\n}\nprint(sum)\n</code></pre>\n\n<blockquote>\n  <p>Read: <a href=\"https://kotlinlang.org/docs/reference/lambdas.html\" rel=\"nofollow noreferrer\">Higher-Order Functions and\n  Lambdas</a></p>\n</blockquote>\n\n<p>Hope it will help</p>\n"}, {"comments": [{"owner": {"reputation": 35078, "user_id": 615306, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/5a11940d70233031c01ead6c0b62c990?s=128&d=identicon&r=PG", "display_name": "Kirill Rakhman", "link": "https://stackoverflow.com/users/615306/kirill-rakhman"}, "edited": false, "score": 5, "creation_date": 1471258065, "post_id": 38953482, "comment_id": 65261204, "body": "Note that unlike the other solutions, this one doesn&#39;t generate any anonymous classes and is therefore more efficient."}], "tags": [], "owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "is_accepted": true, "score": 15, "last_activity_date": 1471257907, "last_edit_date": 1471257907, "creation_date": 1471257280, "answer_id": 38953482, "question_id": 38952278, "link": "https://stackoverflow.com/questions/38952278/kotlin-curly-braces-around-several-expressions-or-statements/38953482#38953482", "title": "Kotlin: Curly braces around several expressions (or statements)", "body": "<p>In Kotlin <code>{}</code> are always a lambda expression or a part of a syntax construct like <code>while(true) {}</code>. Probably different from Scala, but easy to grasp, nonetheless. </p>\n\n<p>What you probably want is:</p>\n\n<pre><code>val a = run {\n  val b = 1\n  val c = b + b\n  c + c\n}\nprintln(a)\n</code></pre>\n\n<p>Kotlin has no build-in concept of \"code blocks anywhere\". Instead we use standard functions-helpers like <code>run</code> in the example above.</p>\n\n<p><a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/run.html\" rel=\"noreferrer\">https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/run.html</a></p>\n"}], "owner": {"reputation": 11598, "user_id": 869330, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/34be19b80429871a85ea92656850bceb?s=128&d=identicon&r=PG&f=1", "display_name": "Naetmul", "link": "https://stackoverflow.com/users/869330/naetmul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4620, "favorite_count": 0, "accepted_answer_id": 38953482, "answer_count": 3, "score": 6, "last_activity_date": 1471257907, "creation_date": 1471252175, "last_edit_date": 1495542782, "question_id": 38952278, "link": "https://stackoverflow.com/questions/38952278/kotlin-curly-braces-around-several-expressions-or-statements", "title": "Kotlin: Curly braces around several expressions (or statements)", "body": "<p>I think this question is somewhat related to <a href=\"https://stackoverflow.com/questions/36037442/kotlin-function-declaration-equals-sign-before-curly-braces\">Kotlin function declaration: equals sign before curly braces</a></p>\n\n<p>In Scala, every statement is an expression (possibly with <code>Unit</code> type). If we surround multiple expressions with braces, then the final expression is the actual value of the curly braced part. Therefore,</p>\n\n<pre><code>// Scala\nval a = {\n  val b = 1\n  val c = b + b\n  c + c\n}\nprintln(a)\n</code></pre>\n\n<p>The type of <code>a</code> is <code>Int</code> and the code prints the value <code>4</code>.</p>\n\n<p>However, in Kotlin, this is somewhat different.\nIf we do the same thing in the Kotlin,</p>\n\n<pre><code>// Kotlin\nval a = {\n  val b = 1\n  val c = b + b\n  c + c\n}\nprintln(a)\n</code></pre>\n\n<p>The type of <code>a</code> is <code>() -&gt; Int</code> and the code prints the <code>Function0&lt;java.lang.Integer&gt;</code>, which means a 0-ary function object with result type <code>Int</code>.</p>\n\n<p>So if we want to print the value <code>4</code>, we need to do <code>println(a())</code>.</p>\n\n<p>In fact, the expression <code>{}</code> in Kotlin is a function <code>() -&gt; ()</code>.</p>\n\n<p>I cannot find an explanation about this in Kotlin official reference pages. Without a parameter list or <code>-&gt;</code>, curly braces make a function?</p>\n\n<p>When I use Scala, I write many codes like the first code. However, in Kotlin, it <strong>creates</strong> a function object and we have to <strong>call</strong> the function, which may be an overhead in a loop or recursion.</p>\n\n<ol>\n<li><p>Is there any document about this thing: <em>just curly braces make a function object</em>?</p></li>\n<li><p>Any way to workaround the overhead in the second code if it is used many times?</p></li>\n</ol>\n\n<p><strong>EDIT</strong></p>\n\n<p>Here is the actual code that iterates many times:</p>\n\n<p>in Java</p>\n\n<pre><code>while ((count = input.read(data, 0, BYTE_BLOCK_SIZE)) != -1) {\n    ....\n}\n</code></pre>\n\n<p>in Scala</p>\n\n<pre><code>while {\n  count = input.read(data, 0, BYTE_BLOCK_SIZE)\n  count != -1\n} {\n  ....\n}\n</code></pre>\n\n<p>in Kotlin</p>\n\n<pre><code>while ({\n    count = input.read(data, 0, BYTE_BLOCK_SIZE)\n    count != -1\n}()) {\n    ...\n}\n</code></pre>\n\n<p>You can see, only Kotlin makes a lot of function objects and calls them.</p>\n"}, {"tags": ["akka", "kotlin", "akka-testkit"], "comments": [{"owner": {"reputation": 25728, "user_id": 3144601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/94FMr.jpg?s=128&g=1", "display_name": "voddan", "link": "https://stackoverflow.com/users/3144601/voddan"}, "edited": false, "score": 0, "creation_date": 1471248177, "post_id": 38949474, "comment_id": 65256987, "body": "How is the code supposed to look in Scala/Java ?"}, {"owner": {"reputation": 26541, "user_id": 1532460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dc5b338bf194a9e117af20bd9b2e4edb?s=128&d=identicon&r=PG", "display_name": "awesoon", "link": "https://stackoverflow.com/users/1532460/awesoon"}, "edited": false, "score": 0, "creation_date": 1471249616, "post_id": 38949474, "comment_id": 65257595, "body": "Which version of Kotlin are you using? The following code (<a href=\"http://pastebin.com/kxSD8ZBY\" rel=\"nofollow noreferrer\">pastebin</a>) compiles just fine with Kotlin compiler version 1.1.0-dev-2222"}, {"owner": {"reputation": 223, "user_id": 5954363, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-l9Xc8KThdfA/AAAAAAAAAAI/AAAAAAAAAA4/MjL4rBcOviw/photo.jpg?sz=128", "display_name": "Kunal Kanojia", "link": "https://stackoverflow.com/users/5954363/kunal-kanojia"}, "edited": false, "score": 0, "creation_date": 1471251328, "post_id": 38949474, "comment_id": 65258343, "body": "Am using version 1.0.3. The code compiles fine, but throws an error when I run it. And it looks like this in java - <a href=\"https://gist.github.com/kunalkanojia/8202d0690208949054eee8b88cec8da2\" rel=\"nofollow noreferrer\">gist.github.com/kunalkanojia/8202d0690208949054eee8b88cec8da&zwnj;&#8203;2</a>"}, {"owner": {"reputation": 17986, "user_id": 4730812, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d336a10204c1cd2e7fa47071ed629669?s=128&d=identicon&r=PG&f=1", "display_name": "piotrek1543", "link": "https://stackoverflow.com/users/4730812/piotrek1543"}, "edited": false, "score": 0, "creation_date": 1471254025, "post_id": 38949474, "comment_id": 65259430, "body": "check: <a href=\"http://stackoverflow.com/questions/36525910/kotlin-type-inference-compile-error-when-using-akka-java-api?rq=1\" title=\"kotlin type inference compile error when using akka java api\">stackoverflow.com/questions/36525910/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 1067858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6c049a0a792bba27f3c141268df6c84?s=128&d=identicon&r=PG", "display_name": "Max Kammerer", "link": "https://stackoverflow.com/users/1067858/max-kammerer"}, "is_accepted": true, "score": 2, "last_activity_date": 1471256096, "creation_date": 1471256096, "answer_id": 38953217, "question_id": 38949474, "link": "https://stackoverflow.com/questions/38949474/testing-akka-actors-with-kotlin-and-akka-testkit/38953217#38953217", "title": "Testing akka actors with Kotlin and akka-testkit", "body": "<p>It's a bug in kotlin compiler and it was fixed in 1.0.4 branch, fix avaliable within snapshot versions. \nFor kotlin 1.0.3 you can use workaround from <a href=\"https://youtrack.jetbrains.com/issue/KT-11833\" rel=\"nofollow\">https://youtrack.jetbrains.com/issue/KT-11833</a></p>\n"}], "owner": {"reputation": 223, "user_id": 5954363, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-l9Xc8KThdfA/AAAAAAAAAAI/AAAAAAAAAA4/MjL4rBcOviw/photo.jpg?sz=128", "display_name": "Kunal Kanojia", "link": "https://stackoverflow.com/users/5954363/kunal-kanojia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 665, "favorite_count": 0, "accepted_answer_id": 38953217, "answer_count": 1, "score": 1, "last_activity_date": 1471256096, "creation_date": 1471236675, "last_edit_date": 1471239073, "question_id": 38949474, "link": "https://stackoverflow.com/questions/38949474/testing-akka-actors-with-kotlin-and-akka-testkit", "title": "Testing akka actors with Kotlin and akka-testkit", "body": "<p>I am trying to play around with akka and kotlin. I am using the akka java API. The Actor class works fine. But am unable to implement the testcase with Akka-testkit. </p>\n\n<p>This is my testcase, </p>\n\n<pre><code>fun testWordCount() {\n    object : JavaTestKit(system) {\n        init {\n            val masterActor = system.actorOf(Props.create(WordCountActor.WordCountMaster::class.java), \"master\")\n            masterActor.tell(WordCountActor.StartCounting(\"src/main/resources/\", 5), testActor)\n            val wcs = expectMsgClass(JavaTestKit.duration(\"5 seconds\"), WordCountActor.WordCountSuccess::class.java)\n            object : JavaTestKit.Within(JavaTestKit.duration(\"5 seconds\")) {\n                override fun run() {\n                    Assert.assertEquals(20, wcs.result.size)\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>I get the below error - </p>\n\n<pre><code>Error:(39, 17) Kotlin: [Internal Error] org.jetbrains.kotlin.codegen.CompilationException: Back-end (JVM) Internal error: Error generating constructors of class null with kind IMPLEMENTATION\nCause: Error generating constructors of class null with kind IMPLEMENTATION\nFile being compiled and position: (39,17) in /Users/kunalkanojia/Workspace/fun/kotlin_word_count/src/test/kotlin/WordCountActorTest.kt\nPsiElement: object : JavaTestKit.Within(JavaTestKit.duration(\"20 seconds\")) {\n                override fun run() {\n                    Assert.assertEquals(20, wcs.result.size.toLong())\n                }\n            }\n</code></pre>\n\n<p>I am new to Kotlin, what could be the problem?</p>\n"}, {"tags": ["function", "kotlin", "default-value", "variadic-functions", "named-parameters"], "answers": [{"comments": [{"owner": {"reputation": 38631, "user_id": 253468, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/eump2.jpg?s=128&g=1", "display_name": "TWiStErRob", "link": "https://stackoverflow.com/users/253468/twisterrob"}, "edited": false, "score": 2, "creation_date": 1543599084, "post_id": 38941244, "comment_id": 93990119, "body": "Changing the signature is not nice to users of the function. By tradition vararg is last, and it can lead to problems when you want just call it normally as you pointed out; <code>numbers = *intArrayOf(...)</code> is the way to go here."}], "tags": [], "owner": {"reputation": 21048, "user_id": 603516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40895ef337d0a2eb7d538f5f8b3e6d58?s=128&d=identicon&r=PG", "display_name": "Vadzim", "link": "https://stackoverflow.com/users/603516/vadzim"}, "is_accepted": true, "score": 28, "last_activity_date": 1471169963, "creation_date": 1471169963, "answer_id": 38941244, "question_id": 38941071, "link": "https://stackoverflow.com/questions/38941071/kotlin-can-you-use-named-arguments-for-varargs/38941244#38941244", "title": "Kotlin: Can you use named arguments for varargs?", "body": "<p>It can be worked around by moving optional arguments after the <code>vararg</code>:</p>\n\n<pre><code>fun complicated(vararg numbers: Int, easy: Boolean = false, hard: Boolean = true) = {}\n</code></pre>\n\n<p>Then it can be called like this:</p>\n\n<pre><code>complicated(1, 2, 3, 4, 5)\ncomplicated(1, 2, 3, hard = true)\ncomplicated(1, easy = true)\n</code></pre>\n\n<p>Note that trailing optional params need to be always passed with name.\nThis won't compile:</p>\n\n<pre><code>complicated(1, 2, 3, 4, true, true) // compile error\n</code></pre>\n\n<p>Another option is to spare <code>vararg</code> sugar for explicit array param:</p>\n\n<pre><code>fun complicated(easy: Boolean = false, hard: Boolean = true, numbers: IntArray) = {}\n\ncomplicated(numbers = intArrayOf(1, 2, 3, 4, 5))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25812, "user_id": 288456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf294ff6d86cc587dec43e2af34a9532?s=128&d=identicon&r=PG", "display_name": "Alexander Udalov", "link": "https://stackoverflow.com/users/288456/alexander-udalov"}, "is_accepted": false, "score": 34, "last_activity_date": 1471170973, "creation_date": 1471170973, "answer_id": 38941373, "question_id": 38941071, "link": "https://stackoverflow.com/questions/38941071/kotlin-can-you-use-named-arguments-for-varargs/38941373#38941373", "title": "Kotlin: Can you use named arguments for varargs?", "body": "<p>To pass a named argument to a vararg parameter, use the <a href=\"https://kotlinlang.org/docs/reference/functions.html#variable-number-of-arguments-varargs\">spread operator</a>:</p>\n\n<pre><code>complicated(numbers = *intArrayOf(1, 2, 3, 4, 5))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17986, "user_id": 4730812, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d336a10204c1cd2e7fa47071ed629669?s=128&d=identicon&r=PG&f=1", "display_name": "piotrek1543", "link": "https://stackoverflow.com/users/4730812/piotrek1543"}, "is_accepted": false, "score": 8, "last_activity_date": 1471206289, "last_edit_date": 1471206289, "creation_date": 1471185815, "answer_id": 38943308, "question_id": 38941071, "link": "https://stackoverflow.com/questions/38941071/kotlin-can-you-use-named-arguments-for-varargs/38943308#38943308", "title": "Kotlin: Can you use named arguments for varargs?", "body": "<p>Kotlin Docs says clearly that:</p>\n\n<blockquote>\n  <h3>Variable number of arguments (Varargs)</h3>\n  \n  <p>A parameter of a function (normally the last one) may be marked with\n  <code>vararg</code> modifier:</p>\n\n<pre><code>fun &lt;T&gt; asList(vararg ts: T): List&lt;T&gt; {\n  val result = ArrayList&lt;T&gt;()\n  for (t in ts) // ts is an Array\n    result.add(t)\n  return result\n}\n</code></pre>\n  \n  <p>allowing a variable number of arguments to be passed to the function:</p>\n\n<pre><code>  val list = asList(1, 2, 3)\n</code></pre>\n  \n  <p>Inside a function a <code>vararg</code>-parameter of type <code>T</code> is visible as an\n  array of <code>T</code>, i.e. the <code>ts</code> variable in the example above has type\n  <code>Array&lt;out T&gt;</code>.</p>\n  \n  <p>Only one parameter may be marked as <code>vararg</code>. If a <code>vararg</code> parameter\n  is not the last one in the list, values for the following parameters\n  can be passed using the named argument syntax, or, if the parameter\n  has a function type, by passing a lambda outside parentheses.</p>\n  \n  <p>When we call a <code>vararg</code>-function, we can pass arguments one-by-one,\n  e.g. <code>asList(1, 2, 3)</code>, or, if we already have an array and want to\n  pass its contents to the function, we use the <strong>spread</strong> operator\n  (prefix the array with <code>*</code>):</p>\n\n<pre><code>val a = arrayOf(1, 2, 3)\nval list = asList(-1, 0, *a, 4)\n</code></pre>\n  \n  <p>From: <a href=\"https://kotlinlang.org/docs/reference/functions.html#variable-number-of-arguments-varargs\" rel=\"noreferrer\">https://kotlinlang.org/docs/reference/functions.html#variable-number-of-arguments-varargs</a></p>\n</blockquote>\n\n<p>To resume, you can make it using spread operator so it would look like:</p>\n\n<pre><code>complicated(numbers = *intArrayOf(1, 2, 3, 4, 5))\n</code></pre>\n\n<p>Hope it will help</p>\n"}, {"tags": [], "owner": {"reputation": 403, "user_id": 4083820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b5a9a5f9469a566fe4a0574ef86101?s=128&d=identicon&r=PG&f=1", "display_name": "C.A.B.", "link": "https://stackoverflow.com/users/4083820/c-a-b"}, "is_accepted": false, "score": 2, "last_activity_date": 1519103126, "creation_date": 1519103126, "answer_id": 48878198, "question_id": 38941071, "link": "https://stackoverflow.com/questions/38941071/kotlin-can-you-use-named-arguments-for-varargs/48878198#48878198", "title": "Kotlin: Can you use named arguments for varargs?", "body": "<p>The vararg parameter can be anywhere in the list of parameters. See example below of how it may be called with different set of parameters. BTW any call can also provide lambda after closed parenthesis.</p>\n\n<pre><code>fun varargs(\n  first: Double = 0.0,\n  second: String = \"2nd\",\n  vararg varargs: Int,\n  third: String = \"3rd\",\n  lambda: ()-&gt;Unit = {}\n) {\n  ...\n}\n\nfun main(args: Array&lt;String&gt;) {\n  val list = intArrayOf(1, 2, 3)\n\n  varargs(1.0, \"...\", *list, third=\"third\")\n  varargs(1.0, \"...\", *list)\n  varargs(1.0, varargs= *list, third=\"third\")\n  varargs(varargs= *list, third=\"third\")\n  varargs(varargs= *list, third=\"third\", second=\"...\")\n  varargs(varargs= *list, second=\"...\")\n\n  varargs(1.0, \"...\", 1, 2, 3, third=\"third\")\n  varargs(1.0, \"...\", 1, 2, 3)\n  varargs(1.0)\n\n  varargs(1.0, \"...\", third=\"third\")\n  varargs(1.0, third=\"third\")\n  varargs(third=\"third\")\n}\n</code></pre>\n"}], "owner": {"reputation": 7656, "user_id": 1938929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/OeAme.png?s=128&g=1", "display_name": "Jire", "link": "https://stackoverflow.com/users/1938929/jire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11367, "favorite_count": 2, "accepted_answer_id": 38941244, "answer_count": 4, "score": 33, "last_activity_date": 1519103126, "creation_date": 1471168453, "question_id": 38941071, "link": "https://stackoverflow.com/questions/38941071/kotlin-can-you-use-named-arguments-for-varargs", "title": "Kotlin: Can you use named arguments for varargs?", "body": "<p>For example, you might have function with a complicated signature and varargs:</p>\n\n<pre><code>fun complicated(easy: Boolean = false, hard: Boolean = true, vararg numbers: Int)\n</code></pre>\n\n<p>It would make sense that you should be able to call this function like so:</p>\n\n<pre><code>complicated(numbers = 1, 2, 3, 4, 5)\n</code></pre>\n\n<p>Unfortunately the compiler doesn't allow this.</p>\n\n<p>Is it possible to use named arguments for varargs? Are there any clever workarounds?</p>\n"}, {"tags": ["kotlin", "casting"], "answers": [{"comments": [{"owner": {"reputation": 21581, "user_id": 4754790, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/0hACp.jpg?s=128&g=1", "display_name": "Dragan Bozanovic", "link": "https://stackoverflow.com/users/4754790/dragan-bozanovic"}, "edited": false, "score": 0, "creation_date": 1471166892, "post_id": 38930459, "comment_id": 65236863, "body": "Shouldn&#39;t the body of <code>forEach</code> be inlined? In that case, <code>max</code> should be just a local variable, thus mutli-threading is not an issue."}, {"owner": {"reputation": 3462, "user_id": 2094298, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/26a93895eedcc45a0ebc3bb0da2cfbe6?s=128&d=identicon&r=PG", "display_name": "Ruckus T-Boom", "link": "https://stackoverflow.com/users/2094298/ruckus-t-boom"}, "reply_to_user": {"reputation": 21581, "user_id": 4754790, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/0hACp.jpg?s=128&g=1", "display_name": "Dragan Bozanovic", "link": "https://stackoverflow.com/users/4754790/dragan-bozanovic"}, "edited": false, "score": 0, "creation_date": 1471187725, "post_id": 38930459, "comment_id": 65242085, "body": "Multi-threading will still be an issue if the body of <code>forEach</code> makes threads. Inlining the creation of a thread doesn&#39;t inline the thread."}], "tags": [], "owner": {"reputation": 3462, "user_id": 2094298, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/26a93895eedcc45a0ebc3bb0da2cfbe6?s=128&d=identicon&r=PG", "display_name": "Ruckus T-Boom", "link": "https://stackoverflow.com/users/2094298/ruckus-t-boom"}, "is_accepted": false, "score": 0, "last_activity_date": 1471291693, "last_edit_date": 1471291693, "creation_date": 1471074130, "answer_id": 38930459, "question_id": 38927809, "link": "https://stackoverflow.com/questions/38927809/compilation-error-smart-cast-to-type-is-impossible-because-variable-is/38930459#38930459", "title": "Compilation error: Smart cast to &#39;&lt;type&gt;&#39; is impossible, because &#39;&lt;variable&gt;&#39; is a local variable that is captured by a changing closure", "body": "<p>The problem is that <code>foreach</code> creates multiple closures, each of which access the same <code>max</code> which is a <code>var</code>.</p>\n\n<p>What should happen if <code>max</code> were set to <code>null</code> in another of the closures after the <code>max == null</code> check but before <code>it &gt; max</code>? </p>\n\n<p>Since each closure can theoretically work independently (potentially on multiple threads) but all access the same <code>max</code>, you can't guarantee it won't change during execution.</p>\n"}, {"tags": [], "owner": {"reputation": 17307, "user_id": 869184, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/58a3657cee7bdb5f537020660d9711e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/869184/ilya"}, "is_accepted": true, "score": 31, "last_activity_date": 1595028444, "last_edit_date": 1595028444, "creation_date": 1471272585, "answer_id": 38957431, "question_id": 38927809, "link": "https://stackoverflow.com/questions/38927809/compilation-error-smart-cast-to-type-is-impossible-because-variable-is/38957431#38957431", "title": "Compilation error: Smart cast to &#39;&lt;type&gt;&#39; is impossible, because &#39;&lt;variable&gt;&#39; is a local variable that is captured by a changing closure", "body": "<p>In general, when a mutable variable is captured in a lambda function closure, smart casts are not applicable to that variable, both inside the lambda and in the declaring scope after the lambda was created.</p>\n<p>It's because the function may escape from its enclosing scope and may be executed later in a different context, possibly multiple times and possibly in parallel.  As an example, consider a hypothetical function <code>List.forEachInParallel { ... }</code>, which executes the given lambda function for each element of the list, but in parallel.</p>\n<p>The compiler must generate code that will remain correct even in that severe case, so it doesn't make an assumption that the value of variable remains unchanged after the null check and thus cannot smart cast it.</p>\n<p>However, <code>List.forEach</code> is quite different, because it is an <a href=\"https://kotlinlang.org/docs/reference/inline-functions.html\" rel=\"noreferrer\"><code>inline</code></a> function. The body of an inline function and the bodies of its functional parameters (unless the parameter has <code>noinline</code> or <code>crossinline</code> modifiers) are inlined at the call site, so the compiler could reason about the code in a lambda passed as an argument to inline function as if it was written directly in the calling method body making the smart cast possible.</p>\n<p>It could, but currently, it doesn't. Simply because that feature is not implemented yet. There is an open issue for it: <a href=\"https://youtrack.jetbrains.com/issue/KT-7186\" rel=\"noreferrer\">KT-7186</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 21581, "user_id": 4754790, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/0hACp.jpg?s=128&g=1", "display_name": "Dragan Bozanovic", "link": "https://stackoverflow.com/users/4754790/dragan-bozanovic"}, "edited": false, "score": 1, "creation_date": 1471274581, "post_id": 38957768, "comment_id": 65270124, "body": "Exactly, that&#39;s what confused me in the first place. If a lambda body is completely inlined, then I would expect to be able to do everything I would do if I were to write the inlined code manually."}], "tags": [], "owner": {"reputation": 24586, "user_id": 3255152, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fbd95ef81d0a85310fee8dd46e0f65b0?s=128&d=identicon&r=PG&f=1", "display_name": "mfulton26", "link": "https://stackoverflow.com/users/3255152/mfulton26"}, "is_accepted": false, "score": 1, "last_activity_date": 1471273674, "creation_date": 1471273674, "answer_id": 38957768, "question_id": 38927809, "link": "https://stackoverflow.com/questions/38927809/compilation-error-smart-cast-to-type-is-impossible-because-variable-is/38957768#38957768", "title": "Compilation error: Smart cast to &#39;&lt;type&gt;&#39; is impossible, because &#39;&lt;variable&gt;&#39; is a local variable that is captured by a changing closure", "body": "<p>This looks like a compiler bug to me.</p>\n\n<p>If the inline lambda parameter in <code>forEach</code> were marked as <code>crossinline</code> then I would expect a compilation error because of the possibility of concurrent invocations of the lambda expression.</p>\n\n<p>Consider the following <code>forEach</code> implementation:</p>\n\n<pre><code>inline fun &lt;T&gt; Iterable&lt;T&gt;.forEach(crossinline action: (T) -&gt; Unit): Unit {\n    val executorService: ExecutorService = ForkJoinPool.commonPool()\n    val futures = map { element -&gt; executorService.submit { action(element) } }\n    futures.forEach { future -&gt; future.get() }\n}\n</code></pre>\n\n<p>The above implementation would fail to compile without <code>crossinline</code> modifier. Without it, the lambda may contain <a href=\"https://kotlinlang.org/docs/reference/inline-functions.html#non-local-returns\" rel=\"nofollow\">non-local returns</a> which means it cannot be used in a concurrent fashion.</p>\n\n<p>I suggest creating an issue: <a href=\"https://youtrack.jetbrains.com/issues/KT\" rel=\"nofollow\">Kotlin (KT) | YouTrack</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 218, "user_id": 467208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca9dfcde6cee5ca62b85e815ae0522e0?s=128&d=identicon&r=PG", "display_name": "IllvilJa", "link": "https://stackoverflow.com/users/467208/illvilja"}, "edited": false, "score": 3, "creation_date": 1596561705, "post_id": 44197085, "comment_id": 111848528, "body": "This saved my day, bummer I cannot upvote twice!  And it should really not be called a workaround IMHO, as it implies that &quot;for(item in list) {...}&quot; is some sort of anti-pattern which it is not in my eyes. (Yes, I&#39;m somewhat old school when it comes to coding.)"}, {"owner": {"reputation": 13421, "user_id": 2298241, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/kWH39.jpg?s=128&g=1", "display_name": "Ivo Stoyanov", "link": "https://stackoverflow.com/users/2298241/ivo-stoyanov"}, "reply_to_user": {"reputation": 218, "user_id": 467208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca9dfcde6cee5ca62b85e815ae0522e0?s=128&d=identicon&r=PG", "display_name": "IllvilJa", "link": "https://stackoverflow.com/users/467208/illvilja"}, "edited": false, "score": 0, "creation_date": 1612432605, "post_id": 44197085, "comment_id": 116767120, "body": "Thank you for your comment @IllvilJa! I fixed the description."}], "tags": [], "owner": {"reputation": 13421, "user_id": 2298241, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/kWH39.jpg?s=128&g=1", "display_name": "Ivo Stoyanov", "link": "https://stackoverflow.com/users/2298241/ivo-stoyanov"}, "is_accepted": false, "score": 7, "last_activity_date": 1612432557, "last_edit_date": 1612432557, "creation_date": 1495787650, "answer_id": 44197085, "question_id": 38927809, "link": "https://stackoverflow.com/questions/38927809/compilation-error-smart-cast-to-type-is-impossible-because-variable-is/44197085#44197085", "title": "Compilation error: Smart cast to &#39;&lt;type&gt;&#39; is impossible, because &#39;&lt;variable&gt;&#39; is a local variable that is captured by a changing closure", "body": "<p>Thanks to <a href=\"https://stackoverflow.com/users/869184/ilya\">Ilya</a> for the detailed explanation of the problem!\nYou can use the standard <code>for(item in list){...}</code> expression like this:</p>\n<pre><code>var max : Int? = null\nval list = listOf(1, 2, 3)\nfor(item in list){\n    if (max == null || item &gt; max) {\n        max = item\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 21581, "user_id": 4754790, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/0hACp.jpg?s=128&g=1", "display_name": "Dragan Bozanovic", "link": "https://stackoverflow.com/users/4754790/dragan-bozanovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6902, "favorite_count": 4, "accepted_answer_id": 38957431, "answer_count": 4, "score": 28, "last_activity_date": 1612432557, "creation_date": 1471045290, "last_edit_date": 1554897404, "question_id": 38927809, "link": "https://stackoverflow.com/questions/38927809/compilation-error-smart-cast-to-type-is-impossible-because-variable-is", "title": "Compilation error: Smart cast to &#39;&lt;type&gt;&#39; is impossible, because &#39;&lt;variable&gt;&#39; is a local variable that is captured by a changing closure", "body": "<p>To simplify my real use case, let's suppose that I want to find the maximum number in a list:</p>\n\n<pre><code>var max : Int? = null\nlistOf(1, 2, 3).forEach {\n    if (max == null || it &gt; max) {\n        max = it\n    }\n}\n</code></pre>\n\n<p>However, compilation fails with the following error:</p>\n\n<blockquote>\n  <p>Smart cast to 'Int' is impossible, because 'max' is a local variable that is captured by a changing closure</p>\n</blockquote>\n\n<p>Why does a changing closure prevent smart cast from working in this example?</p>\n"}, {"tags": ["spring-boot", "kotlin"], "comments": [{"owner": {"reputation": 21581, "user_id": 4754790, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/0hACp.jpg?s=128&g=1", "display_name": "Dragan Bozanovic", "link": "https://stackoverflow.com/users/4754790/dragan-bozanovic"}, "edited": false, "score": 0, "creation_date": 1471015525, "post_id": 38911714, "comment_id": 65199666, "body": "<a href=\"http://stackoverflow.com/a/3498476/4754790\">stackoverflow.com/a/3498476/4754790</a>"}, {"owner": {"reputation": 11834, "user_id": 1538877, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/N9qfZ.jpg?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/1538877/ruslan"}, "edited": false, "score": 0, "creation_date": 1471330749, "post_id": 38911714, "comment_id": 65290912, "body": "Does it works with plain java? Do you try same with pojo?"}, {"owner": {"reputation": 810, "user_id": 1537029, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/zvYNG.jpg?s=128&g=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/1537029/kim"}, "edited": false, "score": 0, "creation_date": 1471332951, "post_id": 38911714, "comment_id": 65292121, "body": "i doing in Kotlin, so i never try in Java. Just wondering how could it be work to prevent in server side instead of database side. It&#39;s actually my first time use the annotation."}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 7898033, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uRq5u.png?s=128&g=1", "display_name": "Dummyc0m", "link": "https://stackoverflow.com/users/7898033/dummyc0m"}, "is_accepted": false, "score": 0, "last_activity_date": 1500978096, "creation_date": 1500978096, "answer_id": 45300443, "question_id": 38911714, "link": "https://stackoverflow.com/questions/38911714/spring-annotation-not-working-in-kotlin/45300443#45300443", "title": "Spring Annotation not working in Kotlin", "body": "<p>I do not think your issue is with Kotlin exactly.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/29344676/size-and-pattern-annotation-are-not-working-in-spring-mvc\">@Size and @Pattern annotation are not working in Spring MVC</a></p>\n\n<p>It is possible that you have missed the org.hibernate:hibernate-validator package in your dependency, but without more information I cannot be certain.</p>\n"}, {"tags": [], "owner": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1524923999, "creation_date": 1524923999, "answer_id": 50077327, "question_id": 38911714, "link": "https://stackoverflow.com/questions/38911714/spring-annotation-not-working-in-kotlin/50077327#50077327", "title": "Spring Annotation not working in Kotlin", "body": "<p>When using Kotlin, you need to apply the constraint validators on the getter methods. This should work:</p>\n\n<pre><code>@Column(unique=true, nullable = false)\n@get: Size(min = 1, max = 50)\nvar name: String = \"\",\n\n@get: Size(max = 100)\nvar description: String = \"\"\n</code></pre>\n"}], "owner": {"reputation": 810, "user_id": 1537029, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/zvYNG.jpg?s=128&g=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/1537029/kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 793, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1524923999, "creation_date": 1470984949, "question_id": 38911714, "link": "https://stackoverflow.com/questions/38911714/spring-annotation-not-working-in-kotlin", "title": "Spring Annotation not working in Kotlin", "body": "<p>Any have problem of annotation doesnt work in Kotlin? </p>\n\n<pre><code>@Column(unique=true, nullable = false)\n@Size(min = 1, max = 50)\nvar name: String = \"\",\n\n@Size(max = 100)\nvar description: String = \"\"\n</code></pre>\n\n<p>I can save into database with empty string and the unique constraint also not working via the annotation. Anyone have similar issue before ? Kindly advise :)</p>\n"}, {"tags": ["android", "realm", "kotlin"], "comments": [{"owner": {"reputation": 70518, "user_id": 2413303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kLhXq.jpg?s=128&g=1", "display_name": "EpicPandaForce", "link": "https://stackoverflow.com/users/2413303/epicpandaforce"}, "edited": false, "score": 0, "creation_date": 1470983201, "post_id": 38910246, "comment_id": 65180109, "body": "Do you <b>need</b> to parcel instead of requerying the object?"}, {"owner": {"reputation": 370, "user_id": 976138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/358791a9c91e7615ffe62c7c6e02e470?s=128&d=identicon&r=PG", "display_name": "zaki50", "link": "https://stackoverflow.com/users/976138/zaki50"}, "edited": false, "score": 0, "creation_date": 1470989172, "post_id": 38910246, "comment_id": 65183112, "body": "First I got the same message <code>Unresolved reference: UserRealmProxy</code> but it disappear after building the project."}, {"owner": {"reputation": 370, "user_id": 976138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/358791a9c91e7615ffe62c7c6e02e470?s=128&d=identicon&r=PG", "display_name": "zaki50", "link": "https://stackoverflow.com/users/976138/zaki50"}, "edited": false, "score": 0, "creation_date": 1470989231, "post_id": 38910246, "comment_id": 65183150, "body": "Can you try <code>@field:ParcelPropertyConverter(ListParcelConverter::class)</code> instead of <code>@ParcelPropertyConverter(ListParcelConverter::class)</code>?"}, {"owner": {"reputation": 3121, "user_id": 1048418, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8110ec87e6a79865071765f48fd1670e?s=128&d=identicon&r=PG", "display_name": "Dawid Hy\u017cy", "link": "https://stackoverflow.com/users/1048418/dawid-hy%c5%bcy"}, "edited": false, "score": 0, "creation_date": 1475489372, "post_id": 38910246, "comment_id": 66948059, "body": "I have the same issue. Did you solve it?"}, {"owner": {"reputation": 2205, "user_id": 3290623, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/92ac216026ab4480156041a4fb68bff6?s=128&d=identicon&r=PG", "display_name": "Martin Mlostek", "link": "https://stackoverflow.com/users/3290623/martin-mlostek"}, "edited": false, "score": 0, "creation_date": 1506513023, "post_id": 38910246, "comment_id": 79849861, "body": "same issue here.. did you find a solution?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7145282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91d0a143413ee9c9a81f3c3af958b562?s=128&d=identicon&r=PG&f=1", "display_name": "taohaipai", "link": "https://stackoverflow.com/users/7145282/taohaipai"}, "is_accepted": false, "score": 0, "last_activity_date": 1478856094, "last_edit_date": 1478856094, "creation_date": 1478855646, "answer_id": 40544619, "question_id": 38910246, "link": "https://stackoverflow.com/questions/38910246/kotlin-realm-and-parcel/40544619#40544619", "title": "kotlin - realm and parcel", "body": "<p>Probably, you will annotate to <strong>setter</strong>. Please try this.</p>\n\n<pre><code>@Parcel( implementations = arrayOf(UserRealmProxy::class),\n     value = Parcel.Serialization.BEAN,\n     analyze = arrayOf(User::class))\nopen class User : RealmObject() {\n    open var name: String? = null\n    open var Items: RealmList&lt;Item&gt;? = null\n    @ParcelPropertyConverter(ListParcelConverter::class) set\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1417, "user_id": 865249, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/bc392a7f1e25e90bbfb34e1c276ee551?s=128&d=identicon&r=PG", "display_name": "Ricardo", "link": "https://stackoverflow.com/users/865249/ricardo"}, "is_accepted": false, "score": 0, "last_activity_date": 1552393583, "creation_date": 1552393583, "answer_id": 55121437, "question_id": 38910246, "link": "https://stackoverflow.com/questions/38910246/kotlin-realm-and-parcel/55121437#55121437", "title": "kotlin - realm and parcel", "body": "<p>In my case, when I have this error: 'Unresolved reference: UserRealmProxy'. If I have this package: com.path.model.Album, and I have to use:</p>\n\n<pre><code>import io.realm.com_path_model_AlbumRealmProxy\n\n...\n@Parcel(implementations = arrayOf(com_path_model_AlbumRealmProxy::class)\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6707698, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IlRushM4o3Y/AAAAAAAAAAI/AAAAAAAAAEE/FUsSb_w9Vgg/photo.jpg?sz=128", "display_name": "user6707698", "link": "https://stackoverflow.com/users/6707698/user6707698"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1138, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1552393583, "creation_date": 1470977973, "last_edit_date": 1470978630, "question_id": 38910246, "link": "https://stackoverflow.com/questions/38910246/kotlin-realm-and-parcel", "title": "kotlin - realm and parcel", "body": "<p>I develop the android project with android studio.\nI want to save realm objects using <code>onSaveInstanceState()</code> in kotlin.\nMy code is </p>\n\n<pre><code>@Parcel( implementations = arrayOf(UserRealmProxy::class),\n         value = Parcel.Serialization.BEAN,\n         analyze = arrayOf(User::class))\nopen class User : RealmObject() {\n    open var name: String? = null\n\n    @ParcelPropertyConverter(ListParcelConverter::class)\n    open var Items: RealmList&lt;Item&gt;? = null\n}\n</code></pre>\n\n<p>but there are some errors while compiling:</p>\n\n<pre><code>'Unresolved reference: UserRealmProxy'\n'An annotation parameter must be a compile-time constant'\n</code></pre>\n\n<p>Sure, UserRealmProxy exists already because already the project has been compiled.\nalso <code>@ParcelPropertyConverter(ListParcelConverter::class)</code> does not work.\nit causes exception in runtime:</p>\n\n<pre><code>'java.io.NotSerializableException: io.realm.RealmList'\n</code></pre>\n\n<p>But this code is compiled well in java.</p>\n\n<p>i need your help.</p>\n"}, {"tags": ["javafx", "kotlin", "mvp", "tornadofx"], "comments": [{"owner": {"reputation": 3462, "user_id": 2094298, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/26a93895eedcc45a0ebc3bb0da2cfbe6?s=128&d=identicon&r=PG", "display_name": "Ruckus T-Boom", "link": "https://stackoverflow.com/users/2094298/ruckus-t-boom"}, "edited": false, "score": 0, "creation_date": 1470958732, "post_id": 38906820, "comment_id": 65173863, "body": "Why do you need the abstract classes? TornadoFX&#39;s built in <code>View</code> and <code>Controller</code> classes work great for MVC, MVP, or even MVVM (despite being named Controller)."}, {"owner": {"reputation": 3462, "user_id": 2094298, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/26a93895eedcc45a0ebc3bb0da2cfbe6?s=128&d=identicon&r=PG", "display_name": "Ruckus T-Boom", "link": "https://stackoverflow.com/users/2094298/ruckus-t-boom"}, "edited": false, "score": 0, "creation_date": 1470958738, "post_id": 38906820, "comment_id": 65173866, "body": "Also, <code>View</code>s are singletons as well, so you can just put <code>val view: SimpleTestView by inject()</code> in your presenter. I&#39;m not sure how important the onViewAttached function is."}, {"owner": {"reputation": 57, "user_id": 6645977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14f65234c4e37cc0e777d09f3de8d542?s=128&d=identicon&r=PG&f=1", "display_name": "Zocp", "link": "https://stackoverflow.com/users/6645977/zocp"}, "reply_to_user": {"reputation": 3462, "user_id": 2094298, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/26a93895eedcc45a0ebc3bb0da2cfbe6?s=128&d=identicon&r=PG", "display_name": "Ruckus T-Boom", "link": "https://stackoverflow.com/users/2094298/ruckus-t-boom"}, "edited": false, "score": 0, "creation_date": 1470959610, "post_id": 38906820, "comment_id": 65174069, "body": "@RuckusT-Boom Oh I see I did not know that views are singletons. The abstract classes are there to enforce the idea that for every View, there is a Presenter attached to it. I&#39;ve made changes to the main post. Feel free to add any suggestions to it"}, {"owner": {"reputation": 3462, "user_id": 2094298, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/26a93895eedcc45a0ebc3bb0da2cfbe6?s=128&d=identicon&r=PG", "display_name": "Ruckus T-Boom", "link": "https://stackoverflow.com/users/2094298/ruckus-t-boom"}, "edited": false, "score": 0, "creation_date": 1470960178, "post_id": 38906820, "comment_id": 65174188, "body": "If you want to enforce it, you can go definitely use the abstract classes (though the generics could probably be done better; I&#39;m not an expert on generics). I think the latter one feels cleaner though."}, {"owner": {"reputation": 3462, "user_id": 2094298, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/26a93895eedcc45a0ebc3bb0da2cfbe6?s=128&d=identicon&r=PG", "display_name": "Ruckus T-Boom", "link": "https://stackoverflow.com/users/2094298/ruckus-t-boom"}, "edited": false, "score": 0, "creation_date": 1470960318, "post_id": 38906820, "comment_id": 65174227, "body": "Also, SO isn&#39;t a great place for questions like &quot;Does this look good?&quot; It&#39;s often hard to post an answer beyond yes or no that isn&#39;t a discussion. For those kinds of questions, the TornadoFX slack channel is great: <a href=\"https://kotlinlang.slack.com/messages/tornadofx/\" rel=\"nofollow noreferrer\">kotlinlang.slack.com/messages/tornadofx</a>"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 6645977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14f65234c4e37cc0e777d09f3de8d542?s=128&d=identicon&r=PG&f=1", "display_name": "Zocp", "link": "https://stackoverflow.com/users/6645977/zocp"}, "edited": false, "score": 0, "creation_date": 1471141850, "post_id": 38930386, "comment_id": 65233079, "body": "Thanks for summarizing the discussion. I&#39;ll definitely use the abstract classes but I&#39;m still not sure how the generics could be improved. I would use Presenter : AbstractPresenter&lt;*&gt; or would using Presenter : Controller be better? Also If I wanted to ensure the presenter has the view, this can be done the same way as I presented in the original post right"}, {"owner": {"reputation": 3462, "user_id": 2094298, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/26a93895eedcc45a0ebc3bb0da2cfbe6?s=128&d=identicon&r=PG", "display_name": "Ruckus T-Boom", "link": "https://stackoverflow.com/users/2094298/ruckus-t-boom"}, "reply_to_user": {"reputation": 57, "user_id": 6645977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14f65234c4e37cc0e777d09f3de8d542?s=128&d=identicon&r=PG&f=1", "display_name": "Zocp", "link": "https://stackoverflow.com/users/6645977/zocp"}, "edited": false, "score": 0, "creation_date": 1471187971, "post_id": 38930386, "comment_id": 65242159, "body": "Sure, but it seems a little weird to me conceptually to ensure the presenter has a view since you can&#39;t use generics to force the presenter and the view to be paired."}, {"owner": {"reputation": 3462, "user_id": 2094298, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/26a93895eedcc45a0ebc3bb0da2cfbe6?s=128&d=identicon&r=PG", "display_name": "Ruckus T-Boom", "link": "https://stackoverflow.com/users/2094298/ruckus-t-boom"}, "reply_to_user": {"reputation": 57, "user_id": 6645977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14f65234c4e37cc0e777d09f3de8d542?s=128&d=identicon&r=PG&f=1", "display_name": "Zocp", "link": "https://stackoverflow.com/users/6645977/zocp"}, "edited": false, "score": 0, "creation_date": 1471188027, "post_id": 38930386, "comment_id": 65242173, "body": "But I don&#39;t know your use case, so if it works for you, go for it."}], "tags": [], "owner": {"reputation": 3462, "user_id": 2094298, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/26a93895eedcc45a0ebc3bb0da2cfbe6?s=128&d=identicon&r=PG", "display_name": "Ruckus T-Boom", "link": "https://stackoverflow.com/users/2094298/ruckus-t-boom"}, "is_accepted": true, "score": 1, "last_activity_date": 1471073641, "creation_date": 1471073641, "answer_id": 38930386, "question_id": 38906820, "link": "https://stackoverflow.com/questions/38906820/tornadofx-creating-a-mvp-design/38930386#38930386", "title": "TornadoFX - Creating a MVP Design", "body": "<p>To sum up the discussion above, you can simply do:</p>\n\n<pre><code>class SampleTestView : View() {\n    val presenter: SampleTestPresenter by inject()\n\n    override val root: AnchorPane by fxml()\n    val testButton: Button by fxid()\n\n    init {\n        testButton.setOnAction { presenter.doSomething() }\n    }\n}\n\nclass SampleTestPresenter : Controller() {\n    val view: SampleTestView by inject()\n\n    fun doSomething() {\n        println(\"Did the thing\")\n    }\n}\n</code></pre>\n\n<p>If you want to ensure the view has a presenter, you could create an abstract view and have all your views extend from it:</p>\n\n<pre><code>abstract class AbstractView&lt;Presenter : Controller&gt; : View() {\n    abstract val presenter: Presenter\n}\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 6645977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14f65234c4e37cc0e777d09f3de8d542?s=128&d=identicon&r=PG&f=1", "display_name": "Zocp", "link": "https://stackoverflow.com/users/6645977/zocp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1398, "favorite_count": 0, "accepted_answer_id": 38930386, "answer_count": 1, "score": 0, "last_activity_date": 1471073641, "creation_date": 1470953070, "last_edit_date": 1470969952, "question_id": 38906820, "link": "https://stackoverflow.com/questions/38906820/tornadofx-creating-a-mvp-design", "title": "TornadoFX - Creating a MVP Design", "body": "<p>Hello I'm new to using TornadoFX and I was wondering what the best design for a MVP structure would be using TornadoFX?</p>\n\n<p>In MVP the view:</p>\n\n<p>-> would delegate all events such as button clicking to a function in the presenter</p>\n\n<p>-> does not interact with the model</p>\n\n<p>Here are some of the rough prototype ideas:</p>\n\n<pre><code>abstract class AbstractPresenter&lt;View : tornadofx.View&gt; : Controller() {\n\nvar view: View by Delegates.notNull()\n\nfun attachView(view: View) {\n    this.view = view;\n }\n}\n</code></pre>\n\n<p>I create a presenter which attaches itself to a AbstractView:</p>\n\n<pre><code>abstract class AbstractView&lt;out Presenter : AbstractPresenter&lt;*&gt;&gt; : View() {\n\nabstract val presenter: Presenter\n\n}\n</code></pre>\n\n<p>Now using it in a example:</p>\n\n<pre><code>class SampleTestView: AbstractView&lt;SampleTestPresenter&gt;() {\n\noverride val presenter: SampleTestPresenter by inject()\noverride val root: AnchorPane by fxml()\n\nval testButton: Button by fxid()\n\ninit {\n    presenter.attachView(this)\n    testButton.setOnAction { presenter.doSomething() }\n   }\n\n}\n</code></pre>\n\n<p>The Sample Presenter:</p>\n\n<pre><code>class SampleTestPresenter: AbstractPresenter&lt;SampleWindowView&gt;() {\n\nfun doSomething() {\n    println(\"did it\")\n}\n\n}\n</code></pre>\n\n<p>Is this a decent implementation of the MVP pattern using TornadoFX?</p>\n\n<p><strong><em>EDIT</em></strong></p>\n\n<p>Made some changes:</p>\n\n<pre><code>class SampleWindowView : View() {\noverride val root: AnchorPane by fxml()\nval presenter : SampleWindowViewPresenter by inject()\n\nval button:Button by fxid()\n\ninit {\n    button.setOnAction {  presenter.handleButtonClick() }\n  }\n}\n\n\nclass SampleWindowViewPresenter : Controller() {\n\nval sampleView: SampleWindowView by inject()\n\nfun handleButtonClick() {\n    println(\"clicked\")\n  }\n}\n</code></pre>\n"}]