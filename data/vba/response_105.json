[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1484530315, "post_id": 41602909, "comment_id": 70534630, "body": "This sounds like you&#39;re trying to write &quot;goal seek&quot; in VBA, is that correct? I believe you can call goal seek via VBA. Related maybe: <a href=\"http://stackoverflow.com/questions/18139322/goal-seek-macro-with-goal-as-a-formula\" title=\"goal seek macro with goal as a formula\">stackoverflow.com/questions/18139322/&hellip;</a>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1526376743, "post_id": 41602909, "comment_id": 87709310, "body": "@AhmedAbdelhameed  Please say you&#39;ve found all the <code>macro</code> tags now - I&#39;m having trouble finding a new question on the home page. :)"}], "owner": {"reputation": 11, "user_id": 7407118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d122ddd9740977fcf4328a66acdd22f2?s=128&d=identicon&r=PG&f=1", "display_name": "Stbr88", "link": "https://stackoverflow.com/users/7407118/stbr88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 291, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1526372903, "creation_date": 1484178982, "last_edit_date": 1526372903, "question_id": 41602909, "link": "https://stackoverflow.com/questions/41602909/goal-seek-esque-macro-without-formulas-in-the-excel-sheet", "title": "Goal Seek-esque macro without formulas in the Excel sheet?", "body": "<p>I have a sheet that pulls columns of data from an external source, and a macro which then uses that data to calculate and populate other columns in the sheet. The calculation outputs on each row depend on the values of the row above. Ultimately, I would like to set the value of one column in the very last row to zero, by changing the input data in one of the first cells. If this were all Excel formulas then I could do a simple Goal Seek, but all of the calculations are carried out in vba. </p>\n\n<p>I am new to vba so I'm not sure if what I'm asking is even possible. Here is an example of how my macro for the calculations looks:</p>\n\n<pre><code>Public Sub Calculate()\n\ni = 2\nDo While Cells(i, 3) &lt;&gt; \"\"\n\nCells(i, 31).Value = Cells(i, 30) / (1 + Cells(i, 61))\nCells(i, 28).Value = -Cells(i, 14) * Cells(i, 31) \nCells(i, 27).Value = (-Cells(i, 26) * Cells(i, 2)) \nCells(i, 32).Value = Cells(i, 15) + Cells(i, 2) + Cells(i,27) \nCells(i, 29).Value = Cells(i, 61) * (Cells(i, 15) + Cells(i, 2) \nCells(i, 61).Value = (Cells(i, 60) + 1) \nCells(i, 62).Value = (Cells(18, 3) + 1) \nCells(i + 1, 15).Value = Cells(i, 32) \nCells(i + 1, 16).Value = Cells(i, 33) \n\ni = i + 1\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>Basically, the value of the last row of column 32 (AF) depends on the value of the first row of column 2 (B). So I would like to vary the value of B2 to make AF500 = 0, based on these calculations. I would love to avoid having formulas in the sheet so I hope this is possible. Thank you for taking the time to read, and sorry for the awful code.</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 2139, "user_id": 116198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HgA1y.png?s=128&g=1", "display_name": "Chris R. Timmons", "link": "https://stackoverflow.com/users/116198/chris-r-timmons"}, "is_accepted": false, "score": 2, "last_activity_date": 1484180302, "creation_date": 1484180302, "answer_id": 41603109, "question_id": 41602782, "link": "https://stackoverflow.com/questions/41602782/vba-copying-from-excel-file-to-word-file-bookmark/41603109#41603109", "title": "VBA copying from Excel file to WORD file bookmark", "body": "<p>I'm not sure why the contents of the Word document are being overwritten.</p>\n\n<p>However, removing the .Select operation and just pasting into the bookmark's range seems to work.</p>\n\n<p>Remove these lines:</p>\n\n<pre><code>wddoc.bookmarks(\"bkmark4\").Select\nwddoc.Range.Paste\n</code></pre>\n\n<p>and replace with this line:</p>\n\n<pre><code>wddoc.bookmarks(\"bkmark4\").Range.Paste\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7402607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D4Rn7.gif?s=128&g=1", "display_name": "I. Hopkins", "link": "https://stackoverflow.com/users/7402607/i-hopkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 790, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484180302, "creation_date": 1484178027, "question_id": 41602782, "link": "https://stackoverflow.com/questions/41602782/vba-copying-from-excel-file-to-word-file-bookmark", "title": "VBA copying from Excel file to WORD file bookmark", "body": "<p>When I copy a chart from Excel ('Report' sheet) to a WORD file ('Report template.docx'), why does VBA wipe out the previous content of the WORD file? I suspect the problem is in line 'wddoc.Range.Paste' but I don't know how to change it to avoid the problem.</p>\n\n<p>Sub ActivateWordTransferData()</p>\n\n<pre><code>Dim wdapp As Object, wddoc As Object\nDim strdocname As String\n\nSet wdapp = GetObject(, \"Word.Application\")\nwdapp.Visible = True\n\nstrdocname = \"C:\\users\\ian\\Documents\\Dropbox\\Report template.docx\"\nSet wddoc = wdapp.documents(strdocname)\n\nWorksheets(\"Report\").Shapes(\"Chart 2\").Copy\nwdapp.Activate\nwddoc.bookmarks(\"bkmark4\").Select\nwddoc.Range.Paste\n\nwddoc.Save\nSet wddoc = Nothing\nSet wdapp = Nothing\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "excel-2016", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1484173563, "post_id": 41601779, "comment_id": 70406382, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/1063155/so-my-excel-vba-project-password-can-easily-be-cracked-what-are-other-options\">So my Excel-VBA project password can easily be cracked... What are other options?</a>, numerous others."}, {"owner": {"reputation": 29, "user_id": 7370183, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/bef662264132b866f0c7d034a6d248cf?s=128&d=identicon&r=PG&f=1", "display_name": "Coldcode", "link": "https://stackoverflow.com/users/7370183/coldcode"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1484174685, "post_id": 41601779, "comment_id": 70406841, "body": "The VB6 mentioned in the another post seems to be obsolete and I can&#39;t find where to download it."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1484174957, "post_id": 41601779, "comment_id": 70406938, "body": "Then check some of <a href=\"http://stackoverflow.com/search?q=%5Bexcel-vba%5D+project+password\">these others</a>. Those run about 50-50 between cracking and preventing cracking. If you don&#39;t find anything there, <a href=\"https://www.google.com/?gws_rd=ssl#q=excel+vba+project+prevent+password+cracking\" rel=\"nofollow noreferrer\">check these results</a>."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 7370183, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/bef662264132b866f0c7d034a6d248cf?s=128&d=identicon&r=PG&f=1", "display_name": "Coldcode", "link": "https://stackoverflow.com/users/7370183/coldcode"}, "edited": false, "score": 0, "creation_date": 1484177641, "post_id": 41602612, "comment_id": 70407878, "body": "I copied the working Excel VBA code. I went to Access visual basic editor, inserted a new module and pasted it. When I tried to save it in ACCDE it prompted and error saying Access was unable to create the .accde, .mde, or .ade file. This error is usually associated with compiling a large database into an MDE file. Because of the method used to compile the database aconsiderable number of TableID references are created for each table. etc."}, {"owner": {"reputation": 29, "user_id": 7370183, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/bef662264132b866f0c7d034a6d248cf?s=128&d=identicon&r=PG&f=1", "display_name": "Coldcode", "link": "https://stackoverflow.com/users/7370183/coldcode"}, "edited": false, "score": 0, "creation_date": 1484178394, "post_id": 41602612, "comment_id": 70408120, "body": "I linked in my original post for the screenshots."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 29, "user_id": 7370183, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/bef662264132b866f0c7d034a6d248cf?s=128&d=identicon&r=PG&f=1", "display_name": "Coldcode", "link": "https://stackoverflow.com/users/7370183/coldcode"}, "edited": false, "score": 0, "creation_date": 1484179865, "post_id": 41602612, "comment_id": 70408580, "body": "Have edited my answer to give explicit steps as to what I did."}, {"owner": {"reputation": 29, "user_id": 7370183, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/bef662264132b866f0c7d034a6d248cf?s=128&d=identicon&r=PG&f=1", "display_name": "Coldcode", "link": "https://stackoverflow.com/users/7370183/coldcode"}, "edited": false, "score": 0, "creation_date": 1484182317, "post_id": 41602612, "comment_id": 70409213, "body": "I tried this but this need to be run in Access. Is it possible to run the code in Excel by clicking inserted button in Excel? My code (simplified) uses the A, B, C columns data to calculate new data to D, E, F columns. I want that the program user can click the inserted button in Excel to calculate the value for the new columns. But the program user should not see the code."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 29, "user_id": 7370183, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/bef662264132b866f0c7d034a6d248cf?s=128&d=identicon&r=PG&f=1", "display_name": "Coldcode", "link": "https://stackoverflow.com/users/7370183/coldcode"}, "edited": false, "score": 0, "creation_date": 1484182570, "post_id": 41602612, "comment_id": 70409258, "body": "The code in Excel will not be protected.  This is a question that has been raised many times.  You can write in a different language if you like C#, VB.NET , C++ but VBA as housed in Excel workbook is not protected it is easily broken into.  Sorry, you have to pick the least of evils here."}, {"owner": {"reputation": 29, "user_id": 7370183, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/bef662264132b866f0c7d034a6d248cf?s=128&d=identicon&r=PG&f=1", "display_name": "Coldcode", "link": "https://stackoverflow.com/users/7370183/coldcode"}, "edited": false, "score": 0, "creation_date": 1484183206, "post_id": 41602612, "comment_id": 70409429, "body": "Which of those are easiest to write and what IDE should I use? In addition, if I write with one of those languages, does it provide the ability to use the button in Excel and other features like in the Excel VBA version of code?"}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 0, "last_activity_date": 1484179841, "last_edit_date": 1484179841, "creation_date": 1484176981, "answer_id": 41602612, "question_id": 41601779, "link": "https://stackoverflow.com/questions/41601779/restrict-access-to-vba-code/41602612#41602612", "title": "Restrict access to VBA code", "body": "<p>I have verified that it is possible to write VBA code in MS Access project, compile to an accde file.  So after OP had some issue, editing this post to make my steps more explicit...</p>\n\n<p>Create an Excel Workbook file which we will call back into because we want to prove we can interact with the Excel session.  I called my workbook <code>N:\\WorkbookControlledByAccess.xlsm</code> and in a module I wrote some code that can be called into using Application.Run    This code is trivial but exemplary</p>\n\n<pre><code>Option Explicit\n\nPublic Function SomeExportedFunction() As String\n    SomeExportedFunction = \"Hello 47\"\nEnd Function\n</code></pre>\n\n<p>Then I opened MS Access and went File->New->Blank desktop database and pressed Create which accepted the given default database filename, for me 'Database5', this will create Database5.accdb.  And the default window is a new Table, Table1, close that.  On the ribbon, go Create->Blank Form.</p>\n\n<p>On the Form create a command button, this throws an annoying wizard, cancel the wizard.  Right-click newly created button to get context menu and then click Build Event, from the Choose Builder dialog choose Code Builder, this gives an error \"To add a code module to a form or report, you must switch to Design view and set the HasNModule property of the form or report to Yes.\"  Click OK to that error and switch to design view by using the View button on the Design ribbon.  Once in design view try the context menu step again.  You should get a VBA IDE window now which has the following code</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate Sub Command0_Click()\n\nEnd Sub\n</code></pre>\n\n<p>We will test the button by changing this to </p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate Sub Command0_Click()\n    MsgBox \"Just access at the moment\"\nEnd Sub\n</code></pre>\n\n<p>One runs the form by pressing F5, the form runs, click the button and our new message box appears.  Ok, now to do some Excel Access interop. Add Tools->References and add Microsoft Excel 15.0 and change the code to be </p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPublic Sub Command0_Click()\n\n    '* Use GetObject to verify the workbook is loaded and accessible via\n    '* RunningObjectTable\n    Dim wb As Excel.Workbook\n    Set wb = GetObject(\"n:\\WorkbookControlledByAccess.xlsm\")\n\n    '* If we got here without error then we should be able to call back into Excel session.\n    MsgBox wb.Parent.Run(\"WorkbookControlledByAccess.xlsm!SomeExportedFunction\")\n\n    'MsgBox SomeExportedFunction\nEnd Sub\n</code></pre>\n\n<p>Now if you run the form and click the button the message is retrieved from the Excel workbook we created earlier.  So this proves Access can reach Excel.</p>\n\n<p>That was in a normal accdb file and one needs to password protect the code.</p>\n\n<p>Then when you want to create the accde file you go File->Save As->Make ACCDE and follow the file dialog.   You can then open the accde file and the code will be locked.</p>\n\n<p>I have yet to do exhaustive search for any hacks into an accde file yet but we know the standard Excel VBA is not safe.</p>\n"}], "owner": {"reputation": 29, "user_id": 7370183, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/bef662264132b866f0c7d034a6d248cf?s=128&d=identicon&r=PG&f=1", "display_name": "Coldcode", "link": "https://stackoverflow.com/users/7370183/coldcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1162, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1484179841, "creation_date": 1484173254, "last_edit_date": 1531161705, "question_id": 41601779, "link": "https://stackoverflow.com/questions/41601779/restrict-access-to-vba-code", "title": "Restrict access to VBA code", "body": "<p>I have searched from google but I still can't find a clear answer. I have written code in excel vba. -How to restrict the program users access to the code? Adding a password in VBA project properties is easy to crack so what is the best and easiest way to hide the vba code from program users?</p>\n\n<p>Another post suggest VB6 but it's obsolete and I can't find where to download it.</p>\n\n<p>The Access error message when trying to save in ACCDE.\n<a href=\"https://i.stack.imgur.com/kmHZC.jpg\" rel=\"nofollow noreferrer\">The Access error message when trying to save in ACCDE.</a>\n<a href=\"https://i.stack.imgur.com/zIeDz.jpg\" rel=\"nofollow noreferrer\">Part 2</a></p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1484174127, "post_id": 41601730, "comment_id": 70406639, "body": "Do you need to keep formatting? If you just need values, just set two ranges equal to eachother. ie: <code>Range([destination range]).Value = Range([copy from Range]).Value</code>.  Also, it&#39;s best to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">avoid using <code>.Select</code>/<code>.Activate</code></a>."}, {"owner": {"reputation": 1, "user_id": 6811491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2a5e8027b78b3738e06e2049edcc0e?s=128&d=identicon&r=PG&f=1", "display_name": "DLem", "link": "https://stackoverflow.com/users/6811491/dlem"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1484174565, "post_id": 41601730, "comment_id": 70406800, "body": "@BruceWayne Are you talking about the time gap itself? I am using that column as a reference but the start and end times that make up the difference is what I am really after."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6811491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2a5e8027b78b3738e06e2049edcc0e?s=128&d=identicon&r=PG&f=1", "display_name": "DLem", "link": "https://stackoverflow.com/users/6811491/dlem"}, "edited": false, "score": 0, "creation_date": 1484179713, "post_id": 41602108, "comment_id": 70408538, "body": "I added an answer to show my new formula. I like where you were going with this but can you help me out with the way I edited it?"}], "tags": [], "owner": {"reputation": 128, "user_id": 5309819, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BAkH6.jpg?s=128&g=1", "display_name": "Nick van H.", "link": "https://stackoverflow.com/users/5309819/nick-van-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1484174720, "creation_date": 1484174720, "answer_id": 41602108, "question_id": 41601730, "link": "https://stackoverflow.com/questions/41601730/looping-for-time-gaps-and-copying-to-another-worksheet/41602108#41602108", "title": "Looping for time gaps and copying to another worksheet", "body": "<p>The problem lies in that you always paste to B3/D3. To solve this you need to make the destination variable too. One way of doing this is to make a range variable which points to the destination cell and shift the reference each time a match is found, Start with;</p>\n\n<pre><code>Dim rDest as range\nSet rDest = Sheets(\"Time Gaps\").Range(\"D3\") 'init reference\n</code></pre>\n\n<p>Then replace the copy line with; </p>\n\n<pre><code>Selection.Offset(, -2).Copy Destination:=rDest\n</code></pre>\n\n<p>You can use rDest.offset to make relative shifts to the destination cell. </p>\n\n<p>And right before end if add the following line; </p>\n\n<pre><code>Set rDest = rDest.Offset(1,0) 'set range to next row\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1438, "user_id": 7381844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472a02745987037a063febc591fbb937?s=128&d=identicon&r=PG&f=1", "display_name": "jBuchholz", "link": "https://stackoverflow.com/users/7381844/jbuchholz"}, "is_accepted": false, "score": 0, "last_activity_date": 1484174865, "creation_date": 1484174865, "answer_id": 41602138, "question_id": 41601730, "link": "https://stackoverflow.com/questions/41601730/looping-for-time-gaps-and-copying-to-another-worksheet/41602138#41602138", "title": "Looping for time gaps and copying to another worksheet", "body": "<p>You always copy your results to cells B3/D3 so all but the last result are overwritten.</p>\n\n<p>Easiest way would probably be a counter that determines in what row the data are covered:</p>\n\n<pre><code>Dim i As Range\ndim counter as Integer\nFor Each i In Range(\"F14:F30000\").SpecialCells(xlCellTypeVisible)\n    If i.Value &gt; 0.02777778 Then\n        i.Select\n        Selection.Offset(, -2).Copy Destination:=Sheets(\"Time Gaps\").Cells(counter + 3, 2)\n        i.Select\n        Selection.Offset(1, -3).Copy Destination:=Sheets(\"Time Gaps\").Cells(counter + 3, 2)\n        counter = counter + 1\n    End If\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6811491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2a5e8027b78b3738e06e2049edcc0e?s=128&d=identicon&r=PG&f=1", "display_name": "DLem", "link": "https://stackoverflow.com/users/6811491/dlem"}, "edited": false, "score": 1, "creation_date": 1484180495, "post_id": 41603011, "comment_id": 70408781, "body": "Set rDest2 = rDest.Offset(0, 4) needed to be changed to Set rDest2 = rDest2.Offset(0, 4)"}], "tags": [], "owner": {"reputation": 1, "user_id": 6811491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2a5e8027b78b3738e06e2049edcc0e?s=128&d=identicon&r=PG&f=1", "display_name": "DLem", "link": "https://stackoverflow.com/users/6811491/dlem"}, "is_accepted": false, "score": 0, "last_activity_date": 1484179644, "creation_date": 1484179644, "answer_id": 41603011, "question_id": 41601730, "link": "https://stackoverflow.com/questions/41601730/looping-for-time-gaps-and-copying-to-another-worksheet/41603011#41603011", "title": "Looping for time gaps and copying to another worksheet", "body": "<p>This is working pretty well. I added rDest2 because I wanted both the start time and end time copied to my \"Time Gap\" sheet. I am having issues though with how the second gap time found is pasting with the offset. this is my formula:</p>\n\n<pre><code>Dim i As Range\nDim rDest As Range\nDim rDest2 As Range\nSet rDest = Sheets(\"Time Gaps\").Range(\"B3\")\nSet rDest2 = Sheets(\"Time Gaps\").Range(\"D3\")\nFor Each i In Range(\"F14:F30000\").SpecialCells(xlCellTypeVisible)\n    If i.Value &gt; 0.02777778 Then\n        i.Select\n        Selection.Offset(, -2).Copy Destination:=rDest\n        i.Select\n        Selection.Offset(1, -3).Copy Destination:=rDest2\n        Set rDest = rDest.Offset(0, 4)\n        Set rDest2 = rDest.Offset(0, 4)\n    End If\nNext i\n</code></pre>\n\n<p>The Time Gaps sheet I am trying to post to has header that look like this:</p>\n\n<pre><code>(Time Start) (Time Gap) (Time End) (Time Start) (Time Gap) (Time End)(Time Start) (Time Gap) (Time End)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 128, "user_id": 5309819, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BAkH6.jpg?s=128&g=1", "display_name": "Nick van H.", "link": "https://stackoverflow.com/users/5309819/nick-van-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1484245425, "creation_date": 1484245425, "answer_id": 41620329, "question_id": 41601730, "link": "https://stackoverflow.com/questions/41601730/looping-for-time-gaps-and-copying-to-another-worksheet/41620329#41620329", "title": "Looping for time gaps and copying to another worksheet", "body": "<p>Looks like you offset by 4 columns, while your header repeats in sets of 3. You probably need to Offset(0,3). Also take a look at DLem's comment.</p>\n\n<p>PS: You don't need to declare another variable rDest2, try;</p>\n\n<pre><code>    i.Offset(, -2).Copy Destination:=rDest\n    i.Offset(1, -3).Copy Destination:=rDest.offset(0,1) 'or (0,2) if the 2nd item has to be 2 columns to the right\n</code></pre>\n\n<p>PS2: Please update the topic start instead of posting a new question as an answer (there is an edit link underneath your post)</p>\n"}], "owner": {"reputation": 1, "user_id": 6811491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2a5e8027b78b3738e06e2049edcc0e?s=128&d=identicon&r=PG&f=1", "display_name": "DLem", "link": "https://stackoverflow.com/users/6811491/dlem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1484245425, "creation_date": 1484173077, "question_id": 41601730, "link": "https://stackoverflow.com/questions/41601730/looping-for-time-gaps-and-copying-to-another-worksheet", "title": "Looping for time gaps and copying to another worksheet", "body": "<p>I have a list of times like this:</p>\n\n<pre><code>Start time  End Time        Difference between times\n10:31:53    10:34:40        0.000115741\n10:34:50    10:35:21        0.000196759\n10:35:38    10:37:17        0.000138889\n10:37:29    10:37:52        0.000358796\n10:38:23    10:40:01        0.000324074\n10:40:29    10:40:59        4.62963E-05\n10:41:03    10:41:46        0.000173611\n10:42:01    10:42:33        0.000104167\n</code></pre>\n\n<p>I am trying to set up VBA that finds differences that are greater than 40 minutes (0.02777778) and once it finds it it copies the start and end times. There may be more than one gap time that is greater than 40 minutes so I would like to copy them all (preferably to the right apposed to vertically like a list). </p>\n\n<p>Here is what I have so far: </p>\n\n<pre><code>Dim i As Range\nFor Each i In Range(\"F14:F30000\").SpecialCells(xlCellTypeVisible)\n    If i.Value &gt; 0.02777778 Then\n        i.Select\n        Selection.Offset(, -2).Copy Destination:=Sheets(\"Time Gaps\").Range(\"B3\")\n        i.Select\n        Selection.Offset(1, -3).Copy Destination:=Sheets(\"Time Gaps\").Range(\"D3\")\n    End If\nNext i\n</code></pre>\n\n<p>But it only copies the last gap time that meets the criteria. How can I make it so it records all of them?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "edited": false, "score": 0, "creation_date": 1486084255, "post_id": 41601668, "comment_id": 71205485, "body": "OK, first things first.  Most people will chastise you and tell you that SO is not a code writing service.  While you are presenting code with a problem, you&#39;re not saying what you&#39;ve done to try to achieve it.  Meanwhile, I kind of enjoy this kind of task, so see below."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7406662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uBFd0.jpg?s=128&g=1", "display_name": "TheDataProcessor", "link": "https://stackoverflow.com/users/7406662/thedataprocessor"}, "edited": false, "score": 0, "creation_date": 1489616524, "post_id": 42015247, "comment_id": 72755274, "body": "So does this mean I&#39;d have to modify the DIM statements on the whole sheet 3(NewData) page for everything to work correctly? In this chat I only pasted partial code. It isn&#39;t the whole code line, hence why i sent a link."}, {"owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "reply_to_user": {"reputation": 1, "user_id": 7406662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uBFd0.jpg?s=128&g=1", "display_name": "TheDataProcessor", "link": "https://stackoverflow.com/users/7406662/thedataprocessor"}, "edited": false, "score": 0, "creation_date": 1489695243, "post_id": 42015247, "comment_id": 72796723, "body": "I&#39;ll have to look at it again, but in general, wherever you have a statement such as &quot;DIM A, B, C as string&quot;, only C is a string.  A and B are variants.  Sometimes that can cause unexpected behaviour.  I try to dimension all variables as explicitly as possible.  It&#39;s just a matter of adding &quot;as string (or whatever variable type you need) in lines where multiple variables are dimensioned.  You should probably have &quot;Option Explicit&quot; at the top, to ensure all variables used are properly dimensioned."}], "tags": [], "owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "is_accepted": false, "score": 0, "last_activity_date": 1486084910, "creation_date": 1486084910, "answer_id": 42015247, "question_id": 41601668, "link": "https://stackoverflow.com/questions/41601668/can-someone-help-me-modify-this-excel-vba-code/42015247#42015247", "title": "Can someone help me modify this Excel VBA code?", "body": "<p>First, the Clean_Image routine requires that the Clean_SKU routine has already run.  They're in the right order in the Clean_all routine, but since they can be run separately, I've added some code to make sure that clean image doesn't try to run unless clean sku has already done so.</p>\n\n<p>Add this in between the first intCounter loop and the line \"ii= number\"  Note that I said after the first intCounter loop.  There will be two loops when you're done, one to find the Image File Name\" column, and then the new one to get the cleaned SKU Column.</p>\n\n<pre><code>'This section will find the column that the new Cleaned SKU value is in.  If it's not there, the procedure aborts.\n For intCounter = 1 To ActiveSheet.UsedRange.Columns.count\n    count$ = Cells(1, intCounter).Address(False, False)\n    Range(count$).Select\n    If ActiveCell.Value = \"Cleaned SKU\" Then\n      SKUColumn = intCounter\n      Exit For\n    End If\n\n    If SKUColumn = 0 Then\n        MsgBox \"You must run the Clean SKUs program first.\", vbOKOnly + vbCritical\n        Exit Sub\n    End If\n Next intCounter\n</code></pre>\n\n<p>Now, you need to find the image extension, and the sku to create the new image file name.  I've added some variables that are a little bit easier to read than a$, b$ etc (oh yeah, Dim Statements...)  Change the top part to this:</p>\n\n<pre><code> Dim a$, b$, c$, SKUValue$, ImageExtension$, count$, MyLetter$, number, ii, j, I As Integer\n Dim lr As Long, SKUColumn As Long, ImageRow As Long\n Dim r As Range, cl As Range\n</code></pre>\n\n<p>we'll talk more about DIM statements later.</p>\n\n<pre><code>'I didn't analyze this or try to change it, but I think it's a bit odd\n MyLetter$ = MyLetter$ &amp; ChrW(number + 64)\n lr = Cells(Rows.count, \"B\").End(xlUp).Row 'find Last row\n Set r = Range(MyLetter$ &amp; \"2:\" &amp; MyLetter$ &amp; lr) 'define working range\n\n 'I changed 'cell' to 'cl' because cell is a reserved word, but in this instance is being used as a variable\n 'and that's confusing\n For Each cl In r\n  'take the file extension from the file name (maybe it's always .jpg, and maybe it isn't.\n    ImageExtension = Right(cl.Value, 4)\n    'get the row number we're on\n    ImageRow = cl.Row\n    'and get the SKU value from the Cleaned SKU column\n    SKUValue$ = Trim(ActiveSheet.Cells(ImageRow, SKUColumn)) 'get the cleaned SKU\n    'put them together in the new column\n    cl.Offset(0, 1).Value = SKUValue &amp; ImageExtension\n  Next cl\n</code></pre>\n\n<p>and that should work.</p>\n\n<p>Now, about DIM statements.  They don't actually work as you think they do.\nthe a$, b$, c$ part does create string variables, because of the '$', but 'number' ii, and j are not numbers, they're variants.  Each variable has to be given it's date type explicitly, or they default to variant.  Only I is an integer.</p>\n\n<p>OK, so try these changes, and if you have any problems, or have questions, post a comment.</p>\n"}], "owner": {"reputation": 1, "user_id": 7406662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uBFd0.jpg?s=128&g=1", "display_name": "TheDataProcessor", "link": "https://stackoverflow.com/users/7406662/thedataprocessor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": -9, "last_activity_date": 1486084910, "creation_date": 1484172846, "last_edit_date": 1531164843, "question_id": 41601668, "link": "https://stackoverflow.com/questions/41601668/can-someone-help-me-modify-this-excel-vba-code", "title": "Can someone help me modify this Excel VBA code?", "body": "<p>I have an excel macro spreadsheet that I'm trying to edit. This is a cleaner that cleans fields in certain columns used to process data. The code was written by a previous co-worker. The file can be found here.</p>\n\n<p><a href=\"http://www.mediafire.com/file/luv3wsfhdvz20h7/Master_data_scrubber_-_USE_THIS_ONE.xlsm\" rel=\"nofollow noreferrer\">http://www.mediafire.com/file/luv3wsfhdvz20h7/Master_data_scrubber_-_USE_THIS_ONE.xlsm</a></p>\n\n<p>Anways I'm relatively new to excel and I don't know much about VBA so when looking over the code i didn't understand much of it all. I'm trying to get edit the cleaning macro. There is a clean all button which Will take Columns A-AP and create a new column next to it with the cleaned values. Each column also has individual button cleaners.</p>\n\n<p>Column B contains a sku number column (I.G 40118) and the clean button will add the manufacturer code to it (i.g. happ). Thus after pressing Clean, a column will be inserted in between B and C. In this new column will be the value happ40118. </p>\n\n<p>Column K is labeled Image name. So the value in for say K2 could be \"hungryhippos-box.jpg\" Currently the clean button for Column K just copies the value an pastes it in a cell from the new inserted column. </p>\n\n<p>I want the button to actually instead of copying the value take the values from the cells in the Cleaned_Sku Column (the newly created column C) and then tack on the extension from the value of Column K (.jpg) and concatenate them together in the newly created Column L. So the value will look like happ40118.jpg. </p>\n\n<p>Here is what what the code looks like below. </p>\n\n<pre><code>**For the Clean All**\n\nPrivate Sub Clean_ALL_Click()\n\nMsgBox (\"This action will take a few moments.\")\nApplication.ScreenUpdating = False\n Cells.Select\n    Range(\"AM9\").Activate\n    With Selection.Font\n        .Name = \"Arial\"\n        .Size = 8\n    End With\n\nCall CleanSKUs_Click\nCall CleanBrand_Click\nCall Clean_MFG_SKU_Click\nCall Clean_UPC_Click\nCall Clean_ISBN_Click\nCall Clean_EAN_Click\nCall Clean_product_name_Click\nCall Clean_Short_desc_Click\nCall Celan_long_desc_Click\nCall Clean_Image_Click\nCall Clean_MSRP_Click\nCall Clean_Cost_Click\nCall Clean_product_weight_Click\nCall Clean_product_weight_u_Click\nCall Clean_product_length_Click\nCall Clean_product_width_Click\nCall Clean_product_height_Click\nCall Clean_product_lwh_uom_Click\nCall Clean_age_range_Click\nCall Clean_Origin_Click\nCall Clean_origin_text_Click\nCall Clean_Product_safety_Click\nCall Clean_category_Click\nCall Clean_Processed_date_Click\nCall Clean_Interactive_URL_Click\nCall Cleaned_Drop_ship_Click\nCall Cleaned_Developmental_Attributes_Click\nCall Clean_keywords_Click\nCall Clean_product_available_date_Click\nCall Clean_gender_Click\nCall Clean_attribute_Click\nCall Clean_products_Awards_Click\nCall Clean_P_Awards_index_Click\nCall Clean_Out_of_Production_Click\nApplication.ScreenUpdating = True\nMsgBox (\"The data cleaning is done!\" &amp; vbCrLf &amp; vbCrLf &amp; \"  All the data has been copied to a new column,\" &amp; vbCrLf &amp; \"check the data before using it.\")\n\nEnd Sub\n\n----------\n**For the Clean SKU** \n\nPrivate Sub CleanSKUs_Click()\n\n Dim a$, b$, C$, prefix$, count$, MyLetter$, number, ii, j, I As Integer\n Dim lr As Long\n Dim r As Range\n Dim popbox As String\n Dim popcount, loopI As Integer\n\n For intCounter = 1 To ActiveSheet.UsedRange.Columns.count\n    count$ = Cells(1, intCounter).Address(False, False)\n    Range(count$).Select\n    If ActiveCell.Value = \"SKU\" Then\n      number = intCounter\n      ActiveCell.Offset(0, 1).EntireColumn.Insert\n      ActiveCell.Offset(0, 1).Value = \"Cleaned SKUs\"\n    Exit For\n    End If\n Next intCounter\n\nii = number / 26\n If ii &gt; 1 Then\n   ii = Int(ii)\n   j = ii * 26\n   If number = j Then\n     number = 26\n     ii = ii - 1\n   Else\n     number = number - j\n   End If\n   MyLetter = ChrW(ii + 64)\n End If\n\n MyLetter$ = MyLetter$ &amp; ChrW(number + 64)\n lr = Cells(Rows.count, \"B\").End(xlUp).Row 'find Last row\n\n Set r = Range(MyLetter$ &amp; \"2:\" &amp; MyLetter$ &amp; lr) 'define working range\n\n Sheets(\"VARs\").Activate\n ActiveSheet.Cells(3, 2).Select\n prefix$ = Selection.Value\n Sheets(\"NewData\").Activate\n\n Dim d\n Set d = CreateObject(\"Scripting.Dictionary\")\n popcount = 0\n loopI = 1\n\n For Each cell In r\n\n loopI = loopI + 1\n If d.Exists(cell.Value) Then\n    ' tag the d(cell.value) row   -- i.e. (the first appearance of this SKU)\n    Rows(d(cell.Value) &amp; \":\" &amp; d(cell.Value)).Select\n    Selection.Interior.ColorIndex = 6\n    ' tag the row\n    Rows(loopI &amp; \":\" &amp; loopI).Select\n    Selection.Interior.ColorIndex = 6\n    ' add duplicate to popup box\n    popcount = popcount + 1\n Else\n    d.Add cell.Value, loopI\n End If\n\n a$ = cell.Value\n For I = 1 To Len(a$)\n b$ = Mid(a$, I, 1)\n If b$ Like \"[A-Z,a-z,0-9]\" Then\n C$ = C$ &amp; b$\n End If\n Next I\n C$ = prefix$ &amp; C$\n cell.Offset(0, 1).Value = LCase(C$) 'set value\n C$ = \"\" 'reset c$ to nothing\n Next cell\n\n If popcount &gt; 0 Then\n MsgBox (\"There were \" &amp; popcount &amp; \" repeated SKUs.\")\n End If\n\nEnd Sub\n\n----------\n***For the Clean Image(This is the one I want to modify)**\n\nPrivate Sub Clean_Image_Click()\n\n Dim a$, b$, C$, count$, MyLetter$, number, ii, j, I As Integer\n Dim lr As Long\n Dim r As Range\n\n For intCounter = 1 To ActiveSheet.UsedRange.Columns.count\n    count$ = Cells(1, intCounter).Address(False, False)\n    Range(count$).Select\n    If ActiveCell.Value = \"Image filename\" Then\n      number = intCounter\n      ActiveCell.Offset(0, 1).EntireColumn.Insert\n      ActiveCell.Offset(0, 1).FormulaR1C1 = \"Cleaned Image Filename\"\n    Exit For\n    End If\n Next\n\nii = number / 26\n If ii &gt; 1 Then\n   ii = Int(ii)\n   j = ii * 26\n   If number = j Then\n     number = 26\n     ii = ii - 1\n   Else\n     number = number - j\n   End If\n   MyLetter = ChrW(ii + 64)\n End If\n\n MyLetter$ = MyLetter$ &amp; ChrW(number + 64)\n lr = Cells(Rows.count, \"B\").End(xlUp).Row 'find Last row\n Set r = Range(MyLetter$ &amp; \"2:\" &amp; MyLetter$ &amp; lr) 'define working range\n\n For Each cell In r\n a$ = cell.Value\n a$ = Trim(a$)\n cell.Offset(0, 1).Value = a$ 'set value\n a$ = \"\" 'reset c$ to nothing\n Next cell\n\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "vbe", "rubberduck"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 6, "creation_date": 1484172684, "post_id": 41601588, "comment_id": 70406017, "body": "Commands will be disabled if they aren&#39;t available based on the current add-in state.  In this case it appears that the initial parse hasn&#39;t been performed.  Click on the blue &quot;recycle arrows&quot; in the RD status bar."}], "answers": [{"comments": [{"owner": {"reputation": 1316, "user_id": 4169411, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/724127205/picture?type=large", "display_name": "Kaz", "link": "https://stackoverflow.com/users/4169411/kaz"}, "edited": false, "score": 1, "creation_date": 1490115284, "post_id": 41601886, "comment_id": 72964242, "body": "Just a comment. Unless you have some way of detecting when the VBE has actually finished loading, I would leave it manual."}, {"owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "edited": false, "score": 0, "creation_date": 1509033812, "post_id": 41601886, "comment_id": 80865193, "body": "@Mat&#39;s Mug: I click refresh but the button text remains <code>Pending</code> and submenus remain disabled. Could my corporate firewall be an issue? <code>Ver. 2.1.1.2431</code> Edit: Now it says <code>Parse Error</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "edited": false, "score": 0, "creation_date": 1509034096, "post_id": 41601886, "comment_id": 80865372, "body": "@KacireeSoftware close Excel, verify in Task Manager that the process is indeed gone, then open up Excel with an empty/new workbook, bring up the VBE - same problem? If not, bring up the settings and enable logging at ERROR or WARNING level, then open the workbook that doesn&#39;t parse, reproduce the problem, and see if the log contains anything useful. If it fails with an empty workbook, there&#39;s definitely something wrong."}, {"owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "edited": false, "score": 0, "creation_date": 1509034151, "post_id": 41601886, "comment_id": 80865409, "body": "I&#39;m in Access not Excel"}, {"owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "edited": false, "score": 0, "creation_date": 1509034332, "post_id": 41601886, "comment_id": 80865531, "body": "Ok I am going to start a new post with Log results"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 10, "last_activity_date": 1484173721, "creation_date": 1484173721, "answer_id": 41601886, "question_id": 41601588, "link": "https://stackoverflow.com/questions/41601588/rubberduck-ui-submenus-are-disabled/41601886#41601886", "title": "Rubberduck UI submenus are disabled", "body": "<blockquote>\n  <p>Disclaimer: I'm heavily involved with the development of the Rubberduck add-in.</p>\n</blockquote>\n\n<p>You did nothing wrong =)</p>\n\n<p>In earlier alpha 2.x releases we discovered that launching the initial parse on startup was causing problems (violent crashes), because the add-in was, essentially, ready before the VBE had finished setting up the object model for the project(s) loaded in the IDE. Basically the VBE loads its add-ins before it completely finishes constructing itself, so we can't just launch a parse task right on startup.</p>\n\n<p>So we disabled the initial/automatic parse, that's why it needs to be done manually (for now).</p>\n\n<p>The Rubberduck commandbar (docked at the top of the IDE by default, just below the main commandbar) contains a \"refresh\" button:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vuvZ7.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/vuvZ7.png\" alt=\"enter image description here\"></a></p>\n\n<p>Clicking that button will change the parser state from \"Pending\" / \"En attente\" to \"Ready\" / \"Pr\u00eat\" (after going through a number of states).</p>\n\n<p>Most Rubberduck commands will be enabled as soon as the state is \"Parsed\" (which doesn't last very long - it switches to \"Resolving identifiers\" quite immediately after), and the refactorings get enabled on \"Ready\" state (even before inspections finish running).</p>\n\n<p>You will also find that \"refresh\" command button in the toolstrip of the <em>Code Explorer</em>, <em>Test Explorer</em>, <em>Inspection Results</em> and <em>Todo Explorer</em> toolwindows.</p>\n\n<p>You should be able to browse/navigate the code and use the VBE while Rubberduck is working in the background, but please note that modifying code while Rubberduck is parsing it is possibly going to result in some parser error states; we assume that the code in the IDE is compilable =)</p>\n\n<p>Think of that button as \"Okay ducky, I've done code changes, now sync up with the IDE\": the add-in needs to know the exact in-editor location of every single token in order to work as it should. Refactoring or applying an inspection quick-fix on de-synchronized parser state is definitely a bad idea!</p>\n\n<p>That said, disabling <em>all</em> menus on startup was kind of lazy (and clumsy too: for example the hotkey for displaying the <em>inspection results</em> and <em>code explorer</em> toolwindows will work even though the menus are disabled) - we'll fix that by next release, and the initial parse should be automatic again, too (we'll make it start after a delay, to give the VBE a chance to finish starting up).</p>\n"}], "owner": {"reputation": 782, "user_id": 2594076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iwFqJ.jpg?s=128&g=1", "display_name": "Jean-Marc Flamand", "link": "https://stackoverflow.com/users/2594076/jean-marc-flamand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 818, "favorite_count": 1, "accepted_answer_id": 41601886, "answer_count": 1, "score": 15, "last_activity_date": 1484188459, "creation_date": 1484172518, "last_edit_date": 1484188459, "question_id": 41601588, "link": "https://stackoverflow.com/questions/41601588/rubberduck-ui-submenus-are-disabled", "title": "Rubberduck UI submenus are disabled", "body": "<p>I've just installed the Rubberduck VBE add-in v2.0.11.2453 (MSIL) on Windows 10 OS.</p>\n\n<p>When I open a macro-enabled Excel workbook in Excel and launch the VBA editor, Rubberduck starts but all commands under the Rubberduck menu are disabled.</p>\n\n<p>What am I doing wrong?</p>\n\n<p><a href=\"https://i.stack.imgur.com/efcIB.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/efcIB.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["mysql", "vba", "excel"], "comments": [{"owner": {"reputation": 1438, "user_id": 7381844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472a02745987037a063febc591fbb937?s=128&d=identicon&r=PG&f=1", "display_name": "jBuchholz", "link": "https://stackoverflow.com/users/7381844/jbuchholz"}, "edited": false, "score": 0, "creation_date": 1484175333, "post_id": 41601476, "comment_id": 70407067, "body": "In what line does the error occur? Could your strings get too long?"}, {"owner": {"reputation": 3, "user_id": 7405923, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9aRA1.jpg?s=128&g=1", "display_name": "Cantfi Gurei Tout", "link": "https://stackoverflow.com/users/7405923/cantfi-gurei-tout"}, "reply_to_user": {"reputation": 1438, "user_id": 7381844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472a02745987037a063febc591fbb937?s=128&d=identicon&r=PG&f=1", "display_name": "jBuchholz", "link": "https://stackoverflow.com/users/7381844/jbuchholz"}, "edited": false, "score": 0, "creation_date": 1484175773, "post_id": 41601476, "comment_id": 70407225, "body": "All of the following gets highlighted entering debug: <code>.CommandText = Array( _         &quot;SELECT subquery.*&quot; &amp; Chr(10) &amp; _             &quot;FROM (&quot; &amp; Chr(10) &amp; _                         &quot;SELECT *&quot; &amp; Chr(10) &amp; _                         &quot;FROM mydatabase.mytable&quot; &amp; Chr(10) &amp; _                         &quot;WHERE (mytable.Xfield IN (&quot; &amp; X &amp; &quot;))) subquery&quot; &amp; Chr(10) &amp; _             &quot;WHERE (subquery.Yfield IN (&quot; &amp; Y &amp; &quot;)) AND (subquery.Zfield IN (&quot; &amp; Z &amp; &quot;))&quot;)</code>"}, {"owner": {"reputation": 3, "user_id": 7405923, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9aRA1.jpg?s=128&g=1", "display_name": "Cantfi Gurei Tout", "link": "https://stackoverflow.com/users/7405923/cantfi-gurei-tout"}, "reply_to_user": {"reputation": 1438, "user_id": 7381844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472a02745987037a063febc591fbb937?s=128&d=identicon&r=PG&f=1", "display_name": "jBuchholz", "link": "https://stackoverflow.com/users/7381844/jbuchholz"}, "edited": false, "score": 0, "creation_date": 1484177069, "post_id": 41601476, "comment_id": 70407690, "body": "For strings, how long is too long? I don&#39;t think it&#39;s the problem because the long ones work when the others are short."}, {"owner": {"reputation": 1438, "user_id": 7381844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472a02745987037a063febc591fbb937?s=128&d=identicon&r=PG&f=1", "display_name": "jBuchholz", "link": "https://stackoverflow.com/users/7381844/jbuchholz"}, "edited": false, "score": 0, "creation_date": 1484177218, "post_id": 41601476, "comment_id": 70407731, "body": "About 65k, I think. Why do you pass the <code>.commandText</code> an array (containing only one value)? I would have guessed this always returned a type missmatch. Try passing it the sql query directly."}, {"owner": {"reputation": 3, "user_id": 7405923, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9aRA1.jpg?s=128&g=1", "display_name": "Cantfi Gurei Tout", "link": "https://stackoverflow.com/users/7405923/cantfi-gurei-tout"}, "reply_to_user": {"reputation": 1438, "user_id": 7381844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472a02745987037a063febc591fbb937?s=128&d=identicon&r=PG&f=1", "display_name": "jBuchholz", "link": "https://stackoverflow.com/users/7381844/jbuchholz"}, "edited": false, "score": 0, "creation_date": 1484183418, "post_id": 41601476, "comment_id": 70409479, "body": "This code is an adaptation of the output of the macro recorder. I don&#39;t know why it passes the <code>.commandText</code> an array or how to do it differently. How would your suggestion look in terms of changing the code?"}], "answers": [{"tags": [], "owner": {"reputation": 1438, "user_id": 7381844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472a02745987037a063febc591fbb937?s=128&d=identicon&r=PG&f=1", "display_name": "jBuchholz", "link": "https://stackoverflow.com/users/7381844/jbuchholz"}, "is_accepted": true, "score": 0, "last_activity_date": 1484209026, "creation_date": 1484209026, "answer_id": 41608126, "question_id": 41601476, "link": "https://stackoverflow.com/questions/41601476/excel-mysql-run-time-error-13-type-mismatch/41608126#41608126", "title": "Excel &amp; MySQL -- Run-time error &#39;13&#39;: Type mismatch", "body": "<p>Try this to avoid using an array:</p>\n\n<pre><code>.CommandText = _\n    \"SELECT subquery.*\" &amp; Chr(10) &amp; _\n        \"FROM (\" &amp; Chr(10) &amp; _\n                    \"SELECT *\" &amp; Chr(10) &amp; _\n                    \"FROM mydatabase.mytable\" &amp; Chr(10) &amp; _\n                    \"WHERE (mytable.Xfield IN (\" &amp; X &amp; \"))) subquery\" &amp; Chr(10) &amp; _\n        \"WHERE (subquery.Yfield IN (\" &amp; Y &amp; \")) AND (subquery.Zfield IN (\" &amp; Z &amp; \"))\"\n</code></pre>\n\n<p>i.e. pass the sql query directly as string and not as an array.</p>\n\n<p>(This should also be more efficient as <code>array(...)</code> returns an array of variant instead of string).</p>\n"}], "owner": {"reputation": 3, "user_id": 7405923, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9aRA1.jpg?s=128&g=1", "display_name": "Cantfi Gurei Tout", "link": "https://stackoverflow.com/users/7405923/cantfi-gurei-tout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 407, "favorite_count": 0, "accepted_answer_id": 41608126, "answer_count": 1, "score": 0, "last_activity_date": 1484209026, "creation_date": 1484172022, "question_id": 41601476, "link": "https://stackoverflow.com/questions/41601476/excel-mysql-run-time-error-13-type-mismatch", "title": "Excel &amp; MySQL -- Run-time error &#39;13&#39;: Type mismatch", "body": "<p>First post, here goes. I am trying to make a dynamic query in Excel that retrieves data from a table in MySQL that has approximately 3M records. There are three variables I use to narrow down the results. Each of the variables is a list for the IN statement in SQL. I control which and how many items appear in the list in the spreadsheet. The variables/lists are as such:</p>\n\n<ul>\n<li>X = \"AA\", \"BB\", \"CC\"...   </li>\n<li>Y = \"DDDDD\", \"EEEEE\", \"FFFFF\"...  </li>\n<li>Z = 1, 2, 3, 4, 5...</li>\n</ul>\n\n<p>The code works fine if there are only 1-2 items in each list or if one list is long and the others are just one item or so. The problem happens if all of the lists are long: \"Run-time error '13': Type mismatch\".</p>\n\n<p>When the query is successful, there's a pop-up that asks me to enter my password for the database. When it fails, the error happens before the password prompt, leading me to believe it's a problem on the vba/Excel side, maybe some kind of capacity issue.</p>\n\n<p>Any suggestions on solving the cause of the error? Code below. Thanks a lot!</p>\n\n<pre><code>Dim X As String\nDim Y As String\nDim Z As String\n\nX = Range(\"Filter_X\").Value\nY = Range(\"Filter_Y\").Value\nZ = Range(\"Filter_Z\").Value\n\nThisWorkbook.Sheets.Add(After:=Sheets(Sheets.Count)).Name = \"Data\"\n\nWith ActiveSheet.ListObjects.Add(SourceType:=0, Source:= _\n\"ODBC;DRIVER={MySQL ODBC 5.3 ANSI Driver};UID=root;;DATABASE=mydatabase;PORT=3306;\" _\n    , Destination:=Range(\"$A$1\")).QueryTable\n\n    .CommandText = Array( _\n        \"SELECT subquery.*\" &amp; Chr(10) &amp; _\n            \"FROM (\" &amp; Chr(10) &amp; _\n                        \"SELECT *\" &amp; Chr(10) &amp; _\n                        \"FROM mydatabase.mytable\" &amp; Chr(10) &amp; _\n                        \"WHERE (mytable.Xfield IN (\" &amp; X &amp; \"))) subquery\" &amp; Chr(10) &amp; _\n            \"WHERE (subquery.Yfield IN (\" &amp; Y &amp; \")) AND (subquery.Zfield IN (\" &amp; Z &amp; \"))\")\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .PreserveColumnInfo = True\n    .ListObject.DisplayName = \"Pivot_data\"\n    .Refresh BackgroundQuery:=False\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1484171910, "post_id": 41601262, "comment_id": 70405689, "body": "Where is <code>Source_Table</code> <b>Dim&#39;ed</b> and <b>Set</b> ??"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1484171917, "post_id": 41601262, "comment_id": 70405692, "body": "How is <code>Source_Table</code> defined? The #N/A error indicates that the value is not found in the first column of the source table. Also check that the data type of SubPart is the same as in the first column of Source_Table, i.e. text vs. number."}, {"owner": {"reputation": 3, "user_id": 7406795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9fabb3cc181a58cf25073eb56e9b94?s=128&d=identicon&r=PG&f=1", "display_name": "Hamburgertime", "link": "https://stackoverflow.com/users/7406795/hamburgertime"}, "edited": false, "score": 0, "creation_date": 1484172208, "post_id": 41601262, "comment_id": 70405801, "body": "It seems my problem stems from not knowing that tables need to be defined in macros; I assumed that since calling them up like this in a cell formula. To clarify, Source_Table is an existing table in my workbook that I can reference with VLOOKUP if I&#39;m working from cell."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7406795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9fabb3cc181a58cf25073eb56e9b94?s=128&d=identicon&r=PG&f=1", "display_name": "Hamburgertime", "link": "https://stackoverflow.com/users/7406795/hamburgertime"}, "edited": false, "score": 0, "creation_date": 1484177350, "post_id": 41602215, "comment_id": 70407784, "body": "Hello Nick, thank you for the response. I&#39;ve added the WorkSheetFunction to the expression, but now I am getting a 1004 error when running the macro. I&#39;ve pasted the entire code to the OP to help identify the problem."}, {"owner": {"reputation": 128, "user_id": 5309819, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BAkH6.jpg?s=128&g=1", "display_name": "Nick van H.", "link": "https://stackoverflow.com/users/5309819/nick-van-h"}, "reply_to_user": {"reputation": 3, "user_id": 7406795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9fabb3cc181a58cf25073eb56e9b94?s=128&d=identicon&r=PG&f=1", "display_name": "Hamburgertime", "link": "https://stackoverflow.com/users/7406795/hamburgertime"}, "edited": false, "score": 0, "creation_date": 1484178581, "post_id": 41602215, "comment_id": 70408162, "body": "Not sure if I follow, but now I only see a declaration of     Source_Table     but it isn&#39;t used in your code any more?"}, {"owner": {"reputation": 3, "user_id": 7406795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9fabb3cc181a58cf25073eb56e9b94?s=128&d=identicon&r=PG&f=1", "display_name": "Hamburgertime", "link": "https://stackoverflow.com/users/7406795/hamburgertime"}, "edited": false, "score": 0, "creation_date": 1484178950, "post_id": 41602215, "comment_id": 70408280, "body": "I have now correctly updated the OP to show the Source_Table declaration. I suppose my confusion stems from the fact that the COUNTIF function can directly reference the table I&#39;m working from, but for some reason the VLOOKUP function requires this extra workaround that I don&#39;t fully understand. The current Macro returns the Error 1004 dialog box."}, {"owner": {"reputation": 128, "user_id": 5309819, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BAkH6.jpg?s=128&g=1", "display_name": "Nick van H.", "link": "https://stackoverflow.com/users/5309819/nick-van-h"}, "reply_to_user": {"reputation": 3, "user_id": 7406795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9fabb3cc181a58cf25073eb56e9b94?s=128&d=identicon&r=PG&f=1", "display_name": "Hamburgertime", "link": "https://stackoverflow.com/users/7406795/hamburgertime"}, "edited": false, "score": 0, "creation_date": 1484245773, "post_id": 41602215, "comment_id": 70442204, "body": "That is because VLookup expects a range, and Source_Table is not a range type variable. Try;      ActiveCell = Application.WorksheetFunction.VLookup(SubPart, Source_Table.range, 2, 0)"}], "tags": [], "owner": {"reputation": 128, "user_id": 5309819, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BAkH6.jpg?s=128&g=1", "display_name": "Nick van H.", "link": "https://stackoverflow.com/users/5309819/nick-van-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1484175215, "creation_date": 1484175215, "answer_id": 41602215, "question_id": 41601262, "link": "https://stackoverflow.com/questions/41601262/vlookup-works-in-cell-but-not-in-macro/41602215#41602215", "title": "VLookup works in cell but not in macro", "body": "<p>The way you call the vlookup doesn't work is because it is a member of Worksheetfunction, try; </p>\n\n<pre><code>Application.Worksheetfunction.VLookup\n</code></pre>\n\n<p>This applies to most excel formulas. There are some functions that are embedded in vba like min/max/now and do not specifically have to be called through the Worksheetfunction member.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7406795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9fabb3cc181a58cf25073eb56e9b94?s=128&d=identicon&r=PG&f=1", "display_name": "Hamburgertime", "link": "https://stackoverflow.com/users/7406795/hamburgertime"}, "edited": false, "score": 0, "creation_date": 1484179972, "post_id": 41603013, "comment_id": 70408618, "body": "Thank You, I thought I had tried every form of the Range() function, but I must have missed that one. It works!"}], "tags": [], "owner": {"reputation": 782, "user_id": 2594076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iwFqJ.jpg?s=128&g=1", "display_name": "Jean-Marc Flamand", "link": "https://stackoverflow.com/users/2594076/jean-marc-flamand"}, "is_accepted": true, "score": 0, "last_activity_date": 1484179651, "creation_date": 1484179651, "answer_id": 41603013, "question_id": 41601262, "link": "https://stackoverflow.com/questions/41601262/vlookup-works-in-cell-but-not-in-macro/41603013#41603013", "title": "VLookup works in cell but not in macro", "body": "<p>This works fine \n...Application.WorksheetFunction.VLookup(SubPart, Application.Range(\"Source_Table\"), 6, False)</p>\n"}], "owner": {"reputation": 3, "user_id": 7406795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9fabb3cc181a58cf25073eb56e9b94?s=128&d=identicon&r=PG&f=1", "display_name": "Hamburgertime", "link": "https://stackoverflow.com/users/7406795/hamburgertime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 903, "favorite_count": 0, "accepted_answer_id": 41603013, "answer_count": 2, "score": 0, "last_activity_date": 1526372918, "creation_date": 1484171185, "last_edit_date": 1526372918, "question_id": 41601262, "link": "https://stackoverflow.com/questions/41601262/vlookup-works-in-cell-but-not-in-macro", "title": "VLookup works in cell but not in macro", "body": "<p>I'm having a problem where moving a VLookup function from a Cell to a Macro is returning #N/A. </p>\n\n<p>Right now, I have a table that is referencing a second, unformatted table to build a formatted list. The formatted list uses a series of VLOOKUP commands to  populate, but this requires manually entering a new line and the 'SubPart' name.</p>\n\n<p>I'm writing a macro that will simply read the whole source table and populate thew new formatted one with a single click. </p>\n\n<p>Unfortunately, I can't seem to get VLOOKUP to work when it's taken from cells to a macro. </p>\n\n<pre><code>Sub PopulateSubs()\n\n\nOn Error GoTo MyErrorHandler:\nDim SubAssy, SubPart As String\nDim BomCount, i As Integer\nDim BlankRow As Long\nDim Source_Table As ListObject\n\nSet Source_Table = Worksheets(\"BoMs\").ListObjects(\"Table_Query_From_Syspro\")\n\n\nSubAssy = InputBox(\"Enter the Subassembly:\")\n\nIf Len(SubAssy) &gt; 0 Then\n  BomCount = Application.CountIf(Range(\"Table_Query_from_Syspro[ParentPart]\"), SubAssy)\n\n For i = 1 To BomCount\n\n    BlankRow = Range(\"A10000\").End(xlUp).Row + 1\n    Cells(BlankRow, 1).Select\n    SubPart = SubAssy &amp; i\n    ActiveCell = i\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell = Application.WorksheetFunction.VLookup(SubPart, Source_Table, 2, 0)\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell = Application.WorksheetFunction.VLookup(SubPart, Source_Table, 3, 0)\n\nNext i\n\nElse\n\n    MsgBox \"You entered an invalid value\"\n\nEnd If\n\n\nMyErrorHandler:\nIf Err.Number = 1004 Then\nMsgBox \"Sub assembly Not Present in the table.\"\nEnd If\n\nEnd Sub       \n</code></pre>\n\n<p>VLOOKUP in the manual table was correctly working, but I cannot get it to return anything but #N/A in this application.</p>\n\n<p>I have looked at similar solutions on this site, and run the macro with SubPart as \"SubPart\" as well as \"\"SubPart\"\" but neither term seems to help.</p>\n\n<p>The source table is formatted as General for all cells, I'm not sure if this causes a type mismatch with String entries.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1484171490, "post_id": 41601214, "comment_id": 70405483, "body": "Where&#39;s the code you&#39;re using now?"}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 5117956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kTKPO.png?s=128&g=1", "display_name": "Kieran", "link": "https://stackoverflow.com/users/5117956/kieran"}, "is_accepted": false, "score": 1, "last_activity_date": 1484172423, "creation_date": 1484172423, "answer_id": 41601570, "question_id": 41601214, "link": "https://stackoverflow.com/questions/41601214/how-can-i-loop-down-row-by-row-until-a-blank-cell-is-found/41601570#41601570", "title": "How can I loop down row by row until a blank cell is found", "body": "<p>There are any number of ways you can achieve this. Assuming that you are always using BC2:BC11 you can create a simple for loop to build the string and then output the result to the active cell.</p>\n\n<pre><code>Dim newString As String\nFor i = 2 To 11\n\n    If ActiveSheet.Range(\"BC\" &amp; i).Text &lt;&gt; \"\" Then\n        If newString = \"\" Then\n            newString = ActiveSheet.Range(\"BC\" &amp; i).Text\n        Else\n            newString = newString &amp; Chr(10) &amp; ActiveSheet.Range(\"BC\" &amp; i).Text\n        End If\n    End If\n\nNext\n\nActiveCell.Value = newString\n</code></pre>\n\n<p>Hope that helps :)</p>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1484229074, "post_id": 41601710, "comment_id": 70431004, "body": "@ryguy7272, did yio get through it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 2, "last_activity_date": 1484172988, "creation_date": 1484172988, "answer_id": 41601710, "question_id": 41601214, "link": "https://stackoverflow.com/questions/41601214/how-can-i-loop-down-row-by-row-until-a-blank-cell-is-found/41601710#41601710", "title": "How can I loop down row by row until a blank cell is found", "body": "<p>a possible code with no loops</p>\n\n<pre><code>With ActiveCell\n    .value = Join(Application.Transpose(.Offset(1).Resize(10).value), \" \") '&lt;--| change \"10\" to your actual cells number to be considered below active cell\n    .value = WorksheetFunction.Trim(.value) \n    .Replace \" \", Chr(10)\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 41601710, "answer_count": 2, "score": 0, "last_activity_date": 1484172988, "creation_date": 1484170977, "last_edit_date": 1531164843, "question_id": 41601214, "link": "https://stackoverflow.com/questions/41601214/how-can-i-loop-down-row-by-row-until-a-blank-cell-is-found", "title": "How can I loop down row by row until a blank cell is found", "body": "<p>I'm working in Excel 2010.  I'm trying to concatenate values in one column, and enter a Char(10) between each cell.  So, I'm working in cells BC2:BC11, and I want to concatenate everything in cell BC1.  I came up with this for BC1:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=R[1]C &amp; CHAR(10) &amp; R[2]C &amp; CHAR(10) &amp; R[3]C &amp; CHAR(10) &amp; R[4]C &amp; CHAR(10) &amp; R[5]C &amp; CHAR(10) &amp; R[6]C &amp; CHAR(10) &amp; R[7]C &amp; CHAR(10) &amp; R[8]C &amp; CHAR(10) &amp; R[9]C &amp; CHAR(10) &amp; R[10]C\"\n</code></pre>\n\n<p>It works, but the problem is that often there will be less than 10 values in my array, so I get a bunch of line breaks piling up at the end, and that messes up something downstream from this.  I'd like to come up with an elegant way of looping through BC2:BC11 and combining everything, with CHAR(10), in between each cell.  Can someone give me a script or point me in the right direction?</p>\n\n<p>Thanks. </p>\n"}, {"tags": ["excel", "vba", "variables"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1484170615, "post_id": 41601059, "comment_id": 70405081, "body": "AFAIK you can&#39;t do that. What you can do though, is in your formula, use an empty cell somewhere and name that cell <code>Rate1</code> via the Range Name manager.  Or just use your VBA to create a named range called <code>Rate1</code> that has that value."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1484170683, "post_id": 41601059, "comment_id": 70405122, "body": "Not if it&#39;s strictly a VBA variable. If you create it as a defined name, then you can use it in the cell and in a formula. (Instead of assigning a cell or a range to a defined name, it would effectively be a constant.)"}, {"owner": {"reputation": 87, "user_id": 7406786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-iwIOdgYVqTk/AAAAAAAAAAI/AAAAAAAABJQ/X9hnIYvyRUw/photo.jpg?sz=128", "display_name": "David Quetglas", "link": "https://stackoverflow.com/users/7406786/david-quetglas"}, "edited": false, "score": 0, "creation_date": 1485277025, "post_id": 41601059, "comment_id": 70854536, "body": "Im teribly sorry, I did not see this reply. Thank you for your reply."}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 7406786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-iwIOdgYVqTk/AAAAAAAAAAI/AAAAAAAABJQ/X9hnIYvyRUw/photo.jpg?sz=128", "display_name": "David Quetglas", "link": "https://stackoverflow.com/users/7406786/david-quetglas"}, "edited": false, "score": 0, "creation_date": 1485277071, "post_id": 41601169, "comment_id": 70854567, "body": "Thank you for your reply"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 0, "last_activity_date": 1484170793, "creation_date": 1484170793, "answer_id": 41601169, "question_id": 41601059, "link": "https://stackoverflow.com/questions/41601059/can-i-use-a-declared-variable-in-vba-inside-a-cell-inside-a-spreadsheet/41601169#41601169", "title": "Can I use a declared variable in VBA inside a cell inside a spreadsheet?", "body": "<p>The only thing you can access from the worksheet are public functions in modules.  If you need to expose internal values to the worksheet like that, one option is to make a simple wrapper function:</p>\n\n<pre><code>'In a Module\nPrivate Const Rate1 As Double = 1.234\n\nPublic Function ModuleGlobal(varName As String) As Variant\n    Select Case varName\n        Case \"Rate1\"\n            ModuleGlobal = Rate1\n        'etc.\n    End Select\nEnd Function\n</code></pre>\n\n<p>Then you can use it like this:</p>\n\n<pre><code>=A1 * ModuleGlobal(\"Rate1\")\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 7406786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-iwIOdgYVqTk/AAAAAAAAAAI/AAAAAAAABJQ/X9hnIYvyRUw/photo.jpg?sz=128", "display_name": "David Quetglas", "link": "https://stackoverflow.com/users/7406786/david-quetglas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1547681886, "creation_date": 1484170382, "last_edit_date": 1547681886, "question_id": 41601059, "link": "https://stackoverflow.com/questions/41601059/can-i-use-a-declared-variable-in-vba-inside-a-cell-inside-a-spreadsheet", "title": "Can I use a declared variable in VBA inside a cell inside a spreadsheet?", "body": "<p>So if i declared a variable and name it 'Rate1' in the VBA for the sheet im working on. How can I use it in a formula inside a cell in spreadsheet:\nExample:</p>\n\n<p>(cell A2)   =A1 * Rate1</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1484170145, "post_id": 41600859, "comment_id": 70404870, "body": "You have to open the form for it to be initialized and added to the forms collection of the DB"}], "answers": [{"tags": [], "owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "is_accepted": false, "score": 3, "last_activity_date": 1509061093, "last_edit_date": 1509061093, "creation_date": 1484170053, "answer_id": 41600983, "question_id": 41600859, "link": "https://stackoverflow.com/questions/41600859/declaring-and-setting-form-variable-in-access-vba/41600983#41600983", "title": "Declaring and Setting Form Variable in Access VBA", "body": "<pre><code>Private Sub cmdSuppliers_Click()\n    Dim frm As Form\n    Set frm = Forms(\"frmSuppliers\")\n\n    Debug.Print frm.Name\n</code></pre>\n\n<p>You referenced the Forms collection but made it singular instead of plural.</p>\n"}, {"tags": [], "owner": {"reputation": 273, "user_id": 6490191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/892b65d788a19cd018c74394494fc302?s=128&d=identicon&r=PG&f=1", "display_name": "Steve W", "link": "https://stackoverflow.com/users/6490191/steve-w"}, "is_accepted": true, "score": 2, "last_activity_date": 1484171268, "creation_date": 1484171268, "answer_id": 41601292, "question_id": 41600859, "link": "https://stackoverflow.com/questions/41600859/declaring-and-setting-form-variable-in-access-vba/41601292#41601292", "title": "Declaring and Setting Form Variable in Access VBA", "body": "<p>Thank you Sorceri and Christopher.  I seem to have been missing a compilation of the wrong reference to the forms collection and not opening the form prior to setting the variable.  This code seems to do the trick:</p>\n\n<pre><code>Private Sub cmdSuppliers_Click()\n    Dim frm As Form\n\n    DoCmd.OpenForm \"frmSuppliers\", acNormal, , , , acHidden\n    Set frm = Forms(\"frmSuppliers\")\n\n    Debug.Print frm.Name\n\n    DoCmd.Close acForm, frm.Name\n    Set frm = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 6490191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/892b65d788a19cd018c74394494fc302?s=128&d=identicon&r=PG&f=1", "display_name": "Steve W", "link": "https://stackoverflow.com/users/6490191/steve-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14667, "favorite_count": 0, "accepted_answer_id": 41601292, "answer_count": 2, "score": 0, "last_activity_date": 1509061093, "creation_date": 1484169442, "question_id": 41600859, "link": "https://stackoverflow.com/questions/41600859/declaring-and-setting-form-variable-in-access-vba", "title": "Declaring and Setting Form Variable in Access VBA", "body": "<p>It seems so simple, but I can't seem to find the correct syntax.  I am looking to create a form variable for an unopened form in my Access 2013 application so I can pass the form object to a series of methods rather than passing separate properties of the form.</p>\n\n<p>Here's what I've been attempting, but I run into Run-time error '2465' \"Microsoft Access can't find the field 'frmSuppliers' referenced in your expression.</p>\n\n<pre><code>Private Sub cmdSuppliers_Click()\n    Dim frm As Form\n    Set frm = Form(\"frmSuppliers\")\n\n    Debug.Print frm.Name\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1484169892, "post_id": 41600834, "comment_id": 70404728, "body": "<code>ThisWorkbook.Activate</code>"}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1484170550, "post_id": 41601041, "comment_id": 70405045, "body": "<code>wbSource</code> is superfluous here. If you&#39;re assigning it as <code>ThisWorkbook</code>, just use <code>ThisWorkbook.Activate</code>."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1484170608, "post_id": 41601041, "comment_id": 70405075, "body": "There may be some (advanced) situations where it&#39;s unsafe to assume <code>ThisWorkbook</code> is the one which launched the UserForm, and those cases could be handled e.g., <code>Set wbSource = ActiveWorkbook &#39;etc...</code> but if OP was writing code for scenarios that advanced, it&#39;s unlikely s/he would have to ask how to do this :)"}], "tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 0, "last_activity_date": 1484170313, "creation_date": 1484170313, "answer_id": 41601041, "question_id": 41600834, "link": "https://stackoverflow.com/questions/41600834/command-button-to-return-user-back-to-source-workbook/41601041#41601041", "title": "Command button to return user back to source workbook", "body": "<p>Something like this should work in the code for the userform:</p>\n\n<pre><code>Public wbSource As Workbook\n\nPrivate Sub CommandButton1_Click()\n    wbSource.Activate\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n    Set wbSource = ThisWorkbook\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 2194182, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1e6b81d90e944bbde7218993bcdf18d?s=128&d=identicon&r=PG", "display_name": "user2194182", "link": "https://stackoverflow.com/users/2194182/user2194182"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1484170313, "creation_date": 1484169369, "question_id": 41600834, "link": "https://stackoverflow.com/questions/41600834/command-button-to-return-user-back-to-source-workbook", "title": "Command button to return user back to source workbook", "body": "<p>We have a userform that pops-up and remains on top of all applications.</p>\n\n<p>Since users are always working on multiple workbooks and applications, I want a button on the userform. On clicking this button the users should be returned to the workbook from where the userform is activated.</p>\n\n<p>Let's say the userform is activated from Book1. On clicking the button, users should be returned to book1.</p>\n\n<p>I'm just an excel beginner. Any help will be appreciated</p>\n"}, {"tags": ["excel", "vba", "formula", "calculation"], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1484229035, "post_id": 41601345, "comment_id": 70430971, "body": "<a href=\"http://stackoverflow.com/questions/41612730/why-variable-is-not-accessed-inside-a-case-statement-in-excel-vba/41613112#41613112\">here</a> you may take inspiration from for &quot;translation algorithms&quot;"}, {"owner": {"reputation": 1, "user_id": 7406666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f83db8de3a62342e8cd114bd92f47db?s=128&d=identicon&r=PG&f=1", "display_name": "Syngh", "link": "https://stackoverflow.com/users/7406666/syngh"}, "edited": false, "score": 0, "creation_date": 1484323545, "post_id": 41601345, "comment_id": 70477098, "body": "Thank you for the direction, I will try and see what I can come up with."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1484171484, "creation_date": 1484171484, "answer_id": 41601345, "question_id": 41600738, "link": "https://stackoverflow.com/questions/41600738/excel-multiple-cell-calculation/41601345#41601345", "title": "Excel - Multiple Cell Calculation", "body": "<p>of course it should be first assessed the <em>translation</em> of one rating system to the other and then assume those algorithms to shift between rating grades types</p>\n\n<p>one of the possible approaches could be the following:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim grades As Variant, levels As Variant\n    Dim cell As Range\n    Dim index As Double\n\n    grades = Array(\"F\", \"E\", \"D\", \"C\", \"B\", \"A\")\n    levels = Array(1, 2, 3, 4)\n\n    For Each cell In Intersect(Range(\"A:C\"), ActiveSheet.UsedRange).Offset(1).SpecialCells(xlCellTypeConstants)\n        Select Case cell.Column\n            Case 1 '%\n                index = cell.value / 100\n                cell.Offset(, 1).value = GetRate(index, levels)\n                cell.Offset(, 2).value = GetRate(index, grades)\n            Case 2 ' Level\n                index = InStr(Join(levels, \"\"), cell.value) / Len(Join(levels, \"\"))\n                cell.Offset(, -1).value = index * 100\n                cell.Offset(, 1).value = GetRate(index, grades)\n            Case 3\n                index = InStr(Join(grades, \"\"), cell.value) / Len(Join(grades, \"\"))\n                cell.Offset(, -2).value = index * 100\n                cell.Offset(, -1).value = GetRate(index, levels)\n        End Select\n    Next\nEnd Sub\n\nFunction GetRate(index As Double, rates As Variant)\n    GetRate = rates(WorksheetFunction.Max(Round(index * (UBound(rates) - LBound(rates) + 1), 0) - 1, 0))\nEnd Function\n</code></pre>\n\n<p>due to the simplicity of the translation algorithm it doesn't provide a bijective relationship between grading systems with different spans, but it can get you closer to your goal  </p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7406666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f83db8de3a62342e8cd114bd92f47db?s=128&d=identicon&r=PG&f=1", "display_name": "Syngh", "link": "https://stackoverflow.com/users/7406666/syngh"}, "edited": false, "score": 0, "creation_date": 1484323498, "post_id": 41601372, "comment_id": 70477064, "body": "Thank you for the response, I continue to search for answers on google and try different things. I know there is a way to do this in excel and am determined to make it happen. Eventually, I think this may go the route of an access database, but I want to keep things simple for now as my coding skills are not the greatest."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 1, "user_id": 7406666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f83db8de3a62342e8cd114bd92f47db?s=128&d=identicon&r=PG&f=1", "display_name": "Syngh", "link": "https://stackoverflow.com/users/7406666/syngh"}, "edited": false, "score": 0, "creation_date": 1484324219, "post_id": 41601372, "comment_id": 70477550, "body": "@Syngh does the above approach <i>not work</i> for you? If not, can you please elaborate (revise your original question with new/relevant information)?  This should work, and does not require <i>any</i> VBA programming..."}, {"owner": {"reputation": 1, "user_id": 7406666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f83db8de3a62342e8cd114bd92f47db?s=128&d=identicon&r=PG&f=1", "display_name": "Syngh", "link": "https://stackoverflow.com/users/7406666/syngh"}, "edited": false, "score": 0, "creation_date": 1485267369, "post_id": 41601372, "comment_id": 70847664, "body": "thanks for the code David, my intial issue that I&#39;m trying to solve for is this (and again I&#39;m sorry if I don&#39;t articulate it very well). I need excel to automatically look at cells in 3 different column - once it sees a &#39;mark&#39; in one of those cells I need it to automatically populate the corresponding value into the other two cell. VLookup works, but I have to insert the formula into the correct rows, I&#39;m hoping to do it at a higher level where I don&#39;t need the VLookup as a fx in the cell and just have it run a script to execute the results."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 1, "user_id": 7406666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f83db8de3a62342e8cd114bd92f47db?s=128&d=identicon&r=PG&f=1", "display_name": "Syngh", "link": "https://stackoverflow.com/users/7406666/syngh"}, "edited": false, "score": 0, "creation_date": 1485267980, "post_id": 41601372, "comment_id": 70848086, "body": "you might consider revising your question with the following: A better explanation of what you&#39;re trying to do, screenshot or preferably pasted text example of your <i>inputs</i>, and also same for the expected <i>outputs/results</i>. it&#39;s also very helpful in most cases if you will demonstrate what you have tried so far, explaining the problems or shortcomings thereof (this helps others avoid making the same errors while assisting you)."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1484171595, "creation_date": 1484171595, "answer_id": 41601372, "question_id": 41600738, "link": "https://stackoverflow.com/questions/41600738/excel-multiple-cell-calculation/41601372#41601372", "title": "Excel - Multiple Cell Calculation", "body": "<p>Create a table like so (you can add more rows if you need to define +/- scores like \"B+\", etc.). The key here is sort the table ascending by %, with each row being the <em>minimum</em> score needed for the corresponding Level/Letter Grade.</p>\n\n<p><a href=\"https://i.stack.imgur.com/eubdI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eubdI.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then, you can use <code>VLOOKUP</code> formula against this table, like so to get the Level:</p>\n\n<pre><code>=VLOOKUP(F2,$A$1:$C$7,2,TRUE)\n</code></pre>\n\n<p>And like so, to get the Letter Grade:</p>\n\n<pre><code>=VLOOKUP(F2,$A$1:$C$7,3,TRUE)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/4nIUs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4nIUs.png\" alt=\"enter image description here\"></a></p>\n\n<p>This takes advantage of the <code>True</code> parameter in the VLOOKUP function, which will return an <em>approximate match</em> (and assumes data is sorted ascending). So, when you enter a value like \"81%\", it returns the nearest row which is <em>not greater than</em> 81%, so it will return data from row 5. Likewise, 12% will return data from row 2, 75% from row 4, etc.</p>\n\n<p>And your results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pnyGc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pnyGc.png\" alt=\"enter image description here\"></a></p>\n\n<p>You may need to use <em>two</em> tables if you can't 1:1 map the Level/Letter Grade to a Percent row, but the idea would be the same.</p>\n"}], "owner": {"reputation": 1, "user_id": 7406666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f83db8de3a62342e8cd114bd92f47db?s=128&d=identicon&r=PG&f=1", "display_name": "Syngh", "link": "https://stackoverflow.com/users/7406666/syngh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 692, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1547681860, "creation_date": 1484168998, "last_edit_date": 1547681860, "question_id": 41600738, "link": "https://stackoverflow.com/questions/41600738/excel-multiple-cell-calculation", "title": "Excel - Multiple Cell Calculation", "body": "<p>I'm a teacher and trying to create a mark sheet the problem I have is that assignments are marked using different schemes (i.e. % [1 - 100], Level [1 -4], Letter Grade [F - A]). The problem I have is that I only want to report using one marking scheme and need to convert or calculate the other marking schemes based on the scheme there is it is marked. </p>\n\n<p>I've made an excel worksheet which contains a student names and assignments. The sheet then has 3 other columns, one representing each scheme \"Letter\", \"Level\", Percentage a column for each scheme. Now, at any given time there is going to be a value in one of the 'scheme' columns - I need excel to automatically or by macro calculate the appropriate value into the other cells.</p>\n\n<p>For example, there are three assignments each marked with a different scheme on the same sheet. </p>\n\n<pre><code>Assignment 1 - %\nAssignment 2 - Level \nAssignment 3 - Letter Grade\n</code></pre>\n\n<p>How can I get excel to check which mark value exists and then populate/calculate the other two the corresponding values. </p>\n\n<p>Mike got 80% (%) on Assignment 1, but I want excel to populate the level column and letter column with the corresponding values at the same time Level 3 on Assignment 2 excel to calculate corresponding percentage and letter and at the same time for a Letter A on Assignment 3 the corresponding % and level should be calculated. </p>\n\n<p>Don't know if this is possible or makes sense, but I tried VLOOKUP and was not successful because I have to do it all manually - I'm aiming for an automated process.</p>\n\n<p>Sorry if it is not clear or confusing...but I've been at this for two days with no luck and not even sure if what I'm doing is possible.</p>\n"}, {"tags": ["excel", "if-statement", "conditional-formatting", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1484168758, "post_id": 41600336, "comment_id": 70404107, "body": "You can nest up to 64 IF&#39;s, that should be more than enough for just ten conditions. If you decide to state your real problem, there may be more efficient solutions, but probably you should post in the SuperUser forum"}, {"owner": {"reputation": 21, "user_id": 7388338, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AAScM17cKhE/AAAAAAAAAAI/AAAAAAAADI8/2i0CrJhwu28/photo.jpg?sz=128", "display_name": "Mehdi Fit", "link": "https://stackoverflow.com/users/7388338/mehdi-fit"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1484185728, "post_id": 41600336, "comment_id": 70410037, "body": "Function BAI(x As Integer, y As String, z As Integer) As String If x &lt; 21 And y = &quot;female&quot; And 20 &lt;= z &lt;= 39 Then   BAI = &quot;UNDERWEIGHT&quot;     ElseIf 22 &lt;= x &lt;= 33 And y = &quot;Female&quot; And 20 &lt;= z &lt;= 39 Then         BAI = &quot;Healthy&quot;                                               ElseIf 34 &lt;= x &lt;= 38 And y = &quot;Female&quot; And 20 &lt;= z &lt;= 39 Then         BAI = &quot;overweight&quot;     ElseIf x &gt;= 39 And y = &quot;Female&quot; And 20 &lt;= z &lt;= 39 Then         BAI = &quot;OBESE&quot;"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1484186315, "post_id": 41600336, "comment_id": 70410170, "body": "Your comment does not clarify your problem, to me. And it seems to be VBA and not Excel. Please read the HELP pages for information as to <a href=\"http://stackoverflow.com/help/on-topic\">What topics can I ask about here?</a>, <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask a Good Question</a>, and <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>"}, {"owner": {"reputation": 21, "user_id": 7388338, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AAScM17cKhE/AAAAAAAAAAI/AAAAAAAADI8/2i0CrJhwu28/photo.jpg?sz=128", "display_name": "Mehdi Fit", "link": "https://stackoverflow.com/users/7388338/mehdi-fit"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1484187491, "post_id": 41600336, "comment_id": 70410518, "body": "@RonRosenfeld sry for inconvenient , i tried to make it clear please check it out."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1484187940, "post_id": 41600336, "comment_id": 70410627, "body": "Did you read the references I suggested?  Please re-read the one about providing an example.  Also, what language is your function in?  If it is VBA, then <code>20 &lt;= z &lt;= 39</code> is not valid syntax.  Should be something like <code>20 &lt;= z And z &lt;=39</code>"}, {"owner": {"reputation": 21, "user_id": 7388338, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AAScM17cKhE/AAAAAAAAAAI/AAAAAAAADI8/2i0CrJhwu28/photo.jpg?sz=128", "display_name": "Mehdi Fit", "link": "https://stackoverflow.com/users/7388338/mehdi-fit"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1484188336, "post_id": 41600336, "comment_id": 70410723, "body": "@RonRosenfeld , yes it is VBA ,I see that syntax might be the case, because in some numbers i&#39;m getting the right answer and in some not, let me try this first...tnx"}, {"owner": {"reputation": 21, "user_id": 7388338, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AAScM17cKhE/AAAAAAAAAAI/AAAAAAAADI8/2i0CrJhwu28/photo.jpg?sz=128", "display_name": "Mehdi Fit", "link": "https://stackoverflow.com/users/7388338/mehdi-fit"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1484189537, "post_id": 41600336, "comment_id": 70411038, "body": "@RonRosenfeld that was not the problem, i changed&#39;em all but still not working. i spent more than 8 hours to solve this but still nothing..."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1484191311, "post_id": 41600336, "comment_id": 70411449, "body": "Your problem remains unclear to me. <code>get wrong answer sometimes</code> is all I understand. Unless you can clarify, I won&#39;t be able to help. I cannot reproduce your problem with the information you have chosen to provide."}, {"owner": {"reputation": 21, "user_id": 7388338, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AAScM17cKhE/AAAAAAAAAAI/AAAAAAAADI8/2i0CrJhwu28/photo.jpg?sz=128", "display_name": "Mehdi Fit", "link": "https://stackoverflow.com/users/7388338/mehdi-fit"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1484201034, "post_id": 41600336, "comment_id": 70414212, "body": "i couldn&#39;t solve it and i do not know anymore how to express myself and very frustrated. i sent my formula and i attach the image, no idea how to express myself. i have 3 conditional variables to analyze a numeric cell (x) into a string like (a,b,c,d) . Age ,Gender and X. The age is 3 conditional ( e,f) , gender is 2 conditional (m,f) and x is 12 conditional for each specific gender. i just need to know a function or a defined user function to be able define 3 conditions."}, {"owner": {"reputation": 21, "user_id": 7388338, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AAScM17cKhE/AAAAAAAAAAI/AAAAAAAADI8/2i0CrJhwu28/photo.jpg?sz=128", "display_name": "Mehdi Fit", "link": "https://stackoverflow.com/users/7388338/mehdi-fit"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1484201159, "post_id": 41600336, "comment_id": 70414263, "body": "@RonRosenfeld i do not know how to say this, thanks you. i do really need help. i&#39;m sure i just do not know a tiny detail. it took me my whole 2 days. any advice would be greatly appreciate it."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1484226078, "post_id": 41600336, "comment_id": 70428967, "body": "You need to review your logic.  You require that <code>x</code> be an <code>integer</code>. You have no provision for <code>female</code>, <code>z = 20-39</code> and <code>x=21</code> or <code>x=39</code>.  You have no category for <code>Obese</code> with <code>male</code> and <code>z = 60-79</code>.   If it were me, I would construct lookup tables.  Easier to follow the logic, and to maintain if you should want to make minor changes.  (Or, you could hire someone)"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7388338, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AAScM17cKhE/AAAAAAAAAAI/AAAAAAAADI8/2i0CrJhwu28/photo.jpg?sz=128", "display_name": "Mehdi Fit", "link": "https://stackoverflow.com/users/7388338/mehdi-fit"}, "edited": false, "score": 0, "creation_date": 1484236910, "post_id": 41614642, "comment_id": 70436762, "body": "you are awesome!! the best, I spent almost full 2 days working on this. i used our both function VBA but you know what i realized that may make you laugh. in gender section i had a list &quot;Female&quot; and &quot;Male&quot;. if you see in the function i wrote in some area is &quot;female&quot; and some &quot;Female&quot; capital and small letter!!!! you guess right, i am stupid... also when i ran yours in my cell i had &quot;Female&quot; but you wrote &quot;female&quot; so it did not return me a correct answer. i just found out how CUTE VBA is about spaces and letters. by the way you are the best. thank you so much for your time ."}, {"owner": {"reputation": 1232, "user_id": 5687262, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IS1E8.png?s=128&g=1", "display_name": "elmer007", "link": "https://stackoverflow.com/users/5687262/elmer007"}, "reply_to_user": {"reputation": 21, "user_id": 7388338, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AAScM17cKhE/AAAAAAAAAAI/AAAAAAAADI8/2i0CrJhwu28/photo.jpg?sz=128", "display_name": "Mehdi Fit", "link": "https://stackoverflow.com/users/7388338/mehdi-fit"}, "edited": false, "score": 0, "creation_date": 1484240538, "post_id": 41614642, "comment_id": 70439304, "body": "@MehdiFit Glad I could help.  I&#39;ve edited the answer to make the gender case-sensitivity perform better.  Using the <code>UCase</code> function allows for any case input (e.g., &quot;fEMaLe&quot;) to return true when compared to &quot;FEMALE&quot;.  So, <code>UCase(&quot;fEMaLe&quot;) = &quot;FEMALE&quot;</code>.  I&#39;ve also included the <code>Trim</code> function to eliminate any extra spaces before/after the gender input. Using <code>UCase</code> and <code>Trim</code> will allow the function to handle an input like `  FEMale    ` and still work."}], "tags": [], "owner": {"reputation": 1232, "user_id": 5687262, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IS1E8.png?s=128&g=1", "display_name": "elmer007", "link": "https://stackoverflow.com/users/5687262/elmer007"}, "is_accepted": true, "score": 0, "last_activity_date": 1484240436, "last_edit_date": 1484240436, "creation_date": 1484228201, "answer_id": 41614642, "question_id": 41600336, "link": "https://stackoverflow.com/questions/41600336/how-to-create-multi-conditions-if-function-in-excel/41614642#41614642", "title": "How to create multi conditions &quot;if&quot; function in Excel?", "body": "<p>Here's a new answer given the edited question.</p>\n\n<p>If you're going to go the If-Then-Else route, then I would recommend breaking down your logic into groups.  I tried, but I'm not familiar with your field so I may not have done it perfectly:</p>\n\n<ol>\n<li>First, test if the person is male or female.</li>\n<li>Second, test to see which range their Age is within.</li>\n<li>Third, test to see which range their BPI is within.</li>\n</ol>\n\n<p>Also, for readability, I would recommend renaming your variables to something more meaningful.  I renamed \"x\" to \"BPI\", \"y\" to \"Gender\", and \"z\" to \"Age\".</p>\n\n<hr>\n\n<p>Edit: For the case-sensitive \"male\" and \"female\", I've added the <code>UCase</code> function to the code below. It converts a string to all uppercase, which allows it to be compared to an all uppercase string.  For example, \"MaLe\" would be converted to \"MALE\", and then compared to \"MALE\".  In other words, this should eliminate the case-sensitivity from the gender portion of the function.</p>\n\n<p>Also, for possible spaces before/after the gender, using the <code>Trim</code> function will eliminate them.  So, <code>Trim(\"Male   \")</code> becomes just <code>\"Male\"</code> (no spaces).</p>\n\n<hr>\n\n<p>Look at the following and see if it's more what you're looking for:</p>\n\n<pre><code>Function BAI(BPI As Integer, Gender As String, Age As Integer) As String\nIf UCase(Trim(Gender)) = \"FEMALE\" Then\n    If 20 &lt;= Age And Age &lt;= 39 Then\n        If BPI &lt;= 21 Then BAI = \"UNDERWEIGHT\"\n        If 22 &lt;= BPI And BPI &lt;= 33 Then BAI = \"Healthy\"\n        If 34 &lt;= BPI And BPI &lt;= 38 Then BAI = \"Overweight\"\n        If BPI &gt;= 39 Then BAI = \"OBESE\"\n    ElseIf 40 &lt;= Age And Age &lt;= 59 Then\n        If BPI &lt;= 23 Then BAI = \"UNDERWEIGHT\"\n        If 24 &lt;= BPI And BPI &lt;= 35 Then BAI = \"Healthy\"\n        If 36 &lt;= BPI And BPI &lt;= 41 Then BAI = \"Overweight\"\n        If BPI &gt;= 42 Then BAI = \"OBESE\"\n    ElseIf 60 &lt;= Age And Age &lt;= 79 Then\n        If BPI &lt;= 25 Then BAI = \"UNDERWEIGHT\"\n        If 26 &lt;= BPI And BPI &lt;= 38 Then BAI = \"Healthy\"\n        If 39 &lt;= BPI And BPI &lt;= 43 Then BAI = \"Overweight\"\n        If BPI &gt;= 44 Then BAI = \"OBESE\"\n    Else\n        BAI = \"Error - Age outside acceptable range\"\n    End If\nElseIf UCase(Trim(Gender)) = \"MALE\" Then\n    If 20 &lt;= Age And Age &lt;= 39 Then\n        If BPI &lt;= 8 Then BAI = \"UNDERWEIGHT\"\n        If 9 &lt;= BPI And BPI &lt;= 21 Then BAI = \"Healthy\"\n        If 22 &lt;= BPI And BPI &lt;= 26 Then BAI = \"Overweight\"\n        If BPI &gt;= 27 Then BAI = \"OBESE\"\n    ElseIf 40 &lt;= Age And Age &lt;= 59 Then\n        If BPI &lt;= 11 Then BAI = \"UNDERWEIGHT\"\n        If 12 &lt;= BPI And BPI &lt;= 23 Then BAI = \"Healthy\"\n        If 24 &lt;= BPI And BPI &lt;= 28 Then BAI = \"Overweight\"\n        If BPI &gt;= 29 Then BAI = \"OBESE\"\n    ElseIf 60 &lt;= Age And Age &lt;= 79 Then\n        If BPI &lt;= 13 Then BAI = \"UNDERWEIGHT\"\n        If 14 &lt;= BPI And BPI &lt;= 25 Then BAI = \"Healthy\"\n        If 26 &lt;= BPI And BPI &lt;= 30 Then BAI = \"Overweight\"\n        If BPI &gt;= 31 Then BAI = \"OBESE\"\n    Else\n        BAI = \"Error - Age outside acceptable range\"\n    End If\nElse\n    BAI = \"Error - Choose male or female\"\nEnd If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7388338, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AAScM17cKhE/AAAAAAAAAAI/AAAAAAAADI8/2i0CrJhwu28/photo.jpg?sz=128", "display_name": "Mehdi Fit", "link": "https://stackoverflow.com/users/7388338/mehdi-fit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "accepted_answer_id": 41614642, "answer_count": 1, "score": -1, "last_activity_date": 1484404029, "creation_date": 1484167367, "last_edit_date": 1531161705, "question_id": 41600336, "link": "https://stackoverflow.com/questions/41600336/how-to-create-multi-conditions-if-function-in-excel", "title": "How to create multi conditions &quot;if&quot; function in Excel?", "body": "<p><img src=\"https://i.stack.imgur.com/Nu597.png\" alt=\"enter image description here\"></p>\n\n<p>I assume x is the number I'm going to analyze and \"y\" is as \"male\" or \"female\" and \"z\" is as age group.\nx is a number that the result will be \"underweight\", healthy \" or overweight\". but x which is actually the BPI is not the same for male and female. eg, if x = 21 then depends on gender and age it would be categorized as either \"underweight\", \"healthy \" or overweight\".</p>\n\n<pre><code> Function BAI(x As Integer, y As String, z As Integer) As String\n\n\n If x &lt; 21 And y = \"female\" And 20 &lt;= z &lt;= 39 Then\n    BAI = \"UNDERWEIGHT\"\n\n Elseif 22 &lt;= x &lt;= 33 And y = \"Female\" And 20 &lt;= z &lt;= 39 Then\n    BAI = \"Healthy\"\n\nElseIf 34 &lt;= x &lt;= 38 And y = \"Female\" And 20 &lt;= z &lt;= 39 Then\n    BAI = \"overweight\"\n\nElseIf x &gt;= 39 And y = \"Female\" And 20 &lt;= z &lt;= 39 Then\n    BAI = \"OBESE\"\n\nElseIf x &lt;= 23 And y = \"female\" And 40 &lt;= z &lt;= 59 Then\n    BAI = \"UNDERWEIGHT\"\n\nElseIf 24 &lt;= x &lt;= 35 And y = \"female\" And 40 &lt;= z &lt;= 59 Then\n    BAI = \"Healthy\"\n\nElseIf 36 &lt;= x &lt;= 41 And y = \"female\" And 40 &lt;= z &lt;= 59 Then\n    BAI = \"Overweight\"\n\nElseIf x &gt;= 42 And y = \"female\" And 40 &lt;= z &lt;= 59 Then\n    BAI = \"OBESE\"\n\nElseIf x &lt;= 25 And y = \"female\" And 60 &lt;= z &lt;= 79 Then\n    BAI = \"UNDERWEIGHT\"\n\nElseIf 26 &lt;= x &lt;= 38 And y = \"female\" And 60 &lt;= z &lt;= 79 Then\n    BAI = \"Healthy\"\n\nElseIf 39 &lt;= x &lt;= 43 And y = \"female\" And 60 &lt;= z &lt;= 79 Then\n    BAI = \"Overweight\"\n\nElseIf x &gt;= 44 And y = \"female\" And 60 &lt;= z &lt;= 79 Then\n    BAI = \"obese\"\n\nElseIf x &lt;= 8 And y = \"male\" And 20 &lt;= z &lt;= 39 Then\n    BAI = \"Underweight\"\n\nElseIf 9 &lt;= x &lt;= 21 And y = \"male\" And 20 &lt;= z &lt;= 39 Then\n    BAI = \"Healthy\"\n\nElseIf 22 &lt;= x &lt;= 26 And y = \"male\" And 20 &lt;= z &lt;= 39 Then\n    BAI = \"overweight\"\n\nElseIf x &gt;= 27 And y = \"male\" And 20 &lt;= z &lt;= 39 Then\n    BAI = \"OBESE\"\n\nElseIf x &lt;= 11 And y = \"male\" And 40 &lt;= z &lt;= 59 Then\n    BAI = \"UNDERWEIGHT\"\n\nElseIf 12 &lt;= x &lt;= 23 And y = \"male\" And 40 &lt;= z &lt;= 59 Then\n    BAI = \"Healthy\"\n\nElseIf 24 &lt;= x &lt;= 28 And y = \"male\" And 40 &lt;= z &lt;= 59 Then\n    BAI = \"Overweight\"\n\nElseIf x &gt;= 29 And y = \"male\" And 40 &lt;= z &lt;= 59 Then\n    BAI = \"OBESE\"\n\nElseIf x &lt;= 13 And y = \"male\" And 60 &lt;= z &lt;= 79 Then\n    BAI = \"UNDERWEIGHT\"\n\nElseIf 14 &lt;= x &lt;= 25 And y = \"male\" And 60 &lt;= z &lt;= 79 Then\n    BAI = \"Healthy\"\n\nElseIf 26 &lt;= x &lt;= 30 And y = \"male\" And 60 &lt;= z &lt;= 79 Then\n    BAI = \"Overweight\"\n\n End If\n\n End Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "edited": false, "score": 0, "creation_date": 1484167365, "post_id": 41600253, "comment_id": 70403414, "body": "I believe you are correct--your initial <code>IF</code> will be true even when the value in the cell is blank."}, {"owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "edited": false, "score": 0, "creation_date": 1484168669, "post_id": 41600253, "comment_id": 70404062, "body": "Curious: What is &quot;NaN&quot; as you&#39;re using it? AFAIK, Excel doesn&#39;t have a NaN value (as in &quot;not a number&quot;), unless your data just have the string &quot;NaN&quot; in there."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1484169097, "post_id": 41600253, "comment_id": 70404291, "body": "Your code will set empty cells, cells containing <code>&quot;&quot;</code>, and cells containing <code>&quot;NaN&quot;</code> to yellow (after first changing empty cells to red for a very short time).  But there is no reason why your code should be changing cells containing <code>0</code> to be yellow as you say in your question (&quot;all the cells that pass the if statement conditions end as yellow, even if 0&quot;).  Are you 100% certain that cells containing a <code>0</code> end up as yellow?!?"}, {"owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1484169394, "post_id": 41600253, "comment_id": 70404442, "body": "@YowE3K I think I can answer for the OP. When the cell has nothing in it, <code>.Value</code> will match either 0 or &quot;&quot; in the <code>If</code> statements, so, yes, both conditions will be satisfied."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "edited": false, "score": 0, "creation_date": 1484169452, "post_id": 41600253, "comment_id": 70404479, "body": "@vknowles - but that doesn&#39;t explain how a <code>0</code> ends up yellow - just why an empty cell ends up yellow (after being red for a short time)."}, {"owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1484169791, "post_id": 41600253, "comment_id": 70404664, "body": "@YowE3K - Good point. Probably the OP described it incorrectly. My mistake."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "edited": false, "score": 0, "creation_date": 1484169982, "post_id": 41600253, "comment_id": 70404771, "body": "@vknowles - I did wonder whether that was a mistake in the question, but even the title is <code>Zero values being read-in as missing values in VBA</code> which seems to mean that the problem is with cells containing <code>0</code>, not with empty cells."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1484170191, "post_id": 41600253, "comment_id": 70404890, "body": "Is it possible that you have a cell format that displays text using a format of <code>\\0</code>?  Perhaps so that you can have a formula calculate an empty string but then is displayed as a <code>0</code>?  That would cause those cells to be coloured yellow instead of red, even though it looks like the cells are <code>0</code>."}, {"owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "reply_to_user": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "edited": false, "score": 0, "creation_date": 1484191034, "post_id": 41600253, "comment_id": 70411388, "body": "@vknowles  I am working with data imported from our db, so the NaN values come in as strings to excel."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1484167454, "creation_date": 1484167454, "answer_id": 41600363, "question_id": 41600253, "link": "https://stackoverflow.com/questions/41600253/zero-values-being-read-in-as-missing-values-in-vba/41600363#41600363", "title": "Zero values being read-in as missing values in VBA", "body": "<p>In Excel the default value of an empty cell is zero, so you need to check there's actually some content before checking for zero:</p>\n\n<pre><code> Dim c As Range\n\n For j = 6 To lastRow\n\n    Set c = mainSheet.Cells(j, i)\n\n    'highlight if production outage\n    If Len(c.Value) &gt; 0 And c.Value = 0 Then\n        c.Interior.Color = vbRed\n        outageCounter = outageCounter + 1\n    End If\n\n    'highlight if comm outage\n    If c.Value = \"\" Or c.Value = \"NaN\" Then\n        c.Interior.Color = vbYellow\n        missingCounter = missingCounter + 1\n    End If\n\n    totalCounter = totalCounter + 1\n\nNext j\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "edited": false, "score": 0, "creation_date": 1484168792, "post_id": 41600576, "comment_id": 70404133, "body": "I like this because it takes advantage of one property that distinguishes between empty and 0 rather than having to do two tests (length and value)."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1484168335, "creation_date": 1484168335, "answer_id": 41600576, "question_id": 41600253, "link": "https://stackoverflow.com/questions/41600253/zero-values-being-read-in-as-missing-values-in-vba/41600576#41600576", "title": "Zero values being read-in as missing values in VBA", "body": "<p>you can use <code>Text</code> property and check it against <code>0</code> (\"production outage\") and \"\" or \"NaN\" (\"comm outage\")</p>\n\n<p>you can also use some <code>With - End With</code> to reduce typing and memory accesses</p>\n\n<pre><code>With mainSheet\n    For i = 2 To 4 'lastColumn\n\n        totalCounter = 0\n        outageCounter = 0\n        missingCounter = 0\n\n        'j is for the rows\n        For j = 6 To lastrow\n\n            With .Cells(j, i)\n                Select Case .Text\n                    Case 0\n                        'highlight if production outage\n                        .Interior.Color = vbRed\n                        outageCounter = outageCounter + 1\n\n                    Case \"\", \"NaN\"\n                        'highlight if comm outage\n                        .Interior.Color = vbYellow\n                        missingCounter = missingCounter + 1\n                End Select\n\n                totalCounter = totalCounter + 1\n            End With\n        Next j\n\n        .Cells(lastrow + 2, i).value = missingCounter\n        .Cells(lastrow + 3, i).value = outageCounter\n        .Cells(lastrow + 4, i).value = totalCounter\n    Next i\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 0, "accepted_answer_id": 41600363, "answer_count": 2, "score": 0, "last_activity_date": 1484168335, "creation_date": 1484167047, "question_id": 41600253, "link": "https://stackoverflow.com/questions/41600253/zero-values-being-read-in-as-missing-values-in-vba", "title": "Zero values being read-in as missing values in VBA", "body": "<p>I am trying to trace through a sheet and highlight cells that come back as blank values or 0 values (or \"NaN\") values.  I wrote a nested for loop to do this for me, however, I am seeing a weird item.</p>\n\n<p>The cell in question should change to red if the value equals 0.  When I run my macro, however, the end result is that all the cells that pass the <code>if statement</code> conditions end as yellow, even if 0.  Perhaps VBA reads blank cells as 0, or the cells are not truly blank? Have I made a mistake, or am I incorrect on the logic of VBA?  </p>\n\n<pre><code>    'i is for the columns\nFor i = 2 To 4 'lastColumn\n\n    totalCounter = 0\n    outageCounter = 0\n    missingCounter = 0\n\n    'j is for the rows\n    For j = 6 To lastRow\n\n        'highlight if production outage\n        If mainSheet.Cells(j, i).Value = 0 Then\n            mainSheet.Cells(j, i).Interior.Color = vbRed\n            outageCounter = outageCounter + 1\n        End If\n\n        'highlight if comm outage\n        If mainSheet.Cells(j, i).Value = \"\" Or mainSheet.Cells(j, i).Value = \"NaN\" Then\n            mainSheet.Cells(j, i).Interior.Color = vbYellow\n            missingCounter = missingCounter + 1\n        End If\n\n        totalCounter = totalCounter + 1\n\n    Next j\n\n    mainSheet.Cells(lastRow + 2, i).Value = missingCounter\n    mainSheet.Cells(lastRow + 3, i).Value = outageCounter\n    mainSheet.Cells(lastRow + 4, i).Value = totalCounter\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 25, "user_id": 7406586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/20320efe9977284e3e9e6e8a0708ee47?s=128&d=identicon&r=PG&f=1", "display_name": "fungrymonster", "link": "https://stackoverflow.com/users/7406586/fungrymonster"}, "reply_to_user": {"reputation": 1352, "user_id": 7070298, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/AyWmq.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7070298/brad"}, "edited": false, "score": 0, "creation_date": 1484167612, "post_id": 41600141, "comment_id": 70403535, "body": "I tried a lot of other stuff, but I&#39;ve just gotten to the point where I don&#39;t know where to go with it"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484207808, "post_id": 41600141, "comment_id": 70417255, "body": "@fungrymonster do you have an header row (row 1) at &quot;ImportSheet&quot; ? so the values start from row 2?"}, {"owner": {"reputation": 25, "user_id": 7406586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/20320efe9977284e3e9e6e8a0708ee47?s=128&d=identicon&r=PG&f=1", "display_name": "fungrymonster", "link": "https://stackoverflow.com/users/7406586/fungrymonster"}, "edited": false, "score": 0, "creation_date": 1484228976, "post_id": 41600141, "comment_id": 70430922, "body": "Yes,they start at row 2"}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 7406586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/20320efe9977284e3e9e6e8a0708ee47?s=128&d=identicon&r=PG&f=1", "display_name": "fungrymonster", "link": "https://stackoverflow.com/users/7406586/fungrymonster"}, "is_accepted": false, "score": -1, "last_activity_date": 1484169208, "last_edit_date": 1484169208, "creation_date": 1484167756, "answer_id": 41600433, "question_id": 41600141, "link": "https://stackoverflow.com/questions/41600141/create-and-add-rows-to-worksheet/41600433#41600433", "title": "Create and Add rows to Worksheet", "body": "<p>And this is what I had for moving rows:</p>\n\n<pre><code>Dim contract As String\nImprt = Worksheets(\"ImportSheet\").UsedRange.Rows.Count\n   Srtd = Worksheets(contract)\"enter code here\"\n   If Srtd = 1 Then Srtd = 0\n    For x = Imprt To 2 Step -1\n        If Range(\"J\" &amp; x).Value = contract Then\n            Rows(x).Cut Destination:=Worksheets(contract).Range(\"A\" &amp; Srtd + 1)\n            Srtd = Srtd + 1\n            Else:\n        End If\n    Next x\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 25, "user_id": 7406586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/20320efe9977284e3e9e6e8a0708ee47?s=128&d=identicon&r=PG&f=1", "display_name": "fungrymonster", "link": "https://stackoverflow.com/users/7406586/fungrymonster"}, "edited": false, "score": 0, "creation_date": 1484235449, "post_id": 41615853, "comment_id": 70435615, "body": "@fungrymonster  you&#39;re welcome, please mark as answer. Y clicking the   V next to my answer"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1484231892, "creation_date": 1484231892, "answer_id": 41615853, "question_id": 41600141, "link": "https://stackoverflow.com/questions/41600141/create-and-add-rows-to-worksheet/41615853#41615853", "title": "Create and Add rows to Worksheet", "body": "<p>Try the code below (explanation inside the code as comments):</p>\n\n<pre><code>Option Explicit\n\nSub Sheet()\n\nDim lRow    As Long\nDim Dict    As Object\nDim Key     As Variant\nDim LastRow As Long\nDim DestSht As Worksheet\nDim ShtName As String\n\nSet Dict = CreateObject(\"Scripting.Dictionary\")\n\nWith Worksheets(\"ImportSheet\")\n\n    ' loop from row 2 until last row with data in Column \"B\"\n    For lRow = 2 To .Cells(.Rows.Count, \"B\").End(xlUp).Row          \n        ' copy unique values from column B into dictionary\n        If Not Dict.exists(.Range(\"B\" &amp; lRow).value) Then\n            If .Range(\"B\" &amp; lRow).value &lt;&gt; \"\" Then Dict.Add .Range(\"B\" &amp; lRow).value, .Range(\"B\" &amp; lRow).value\n        End If\n    Next lRow\n\n    ' create a new worksheet per unique key in Dictionary\n    For Each Key In Dict\n        Worksheets.Add(After:=Sheets(Sheets.Count)).Name = Key\n    Next Key\n\n    ' loop through all cells in Column B, and copy each row to relevant worksheet\n    For lRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row To 2 Step -1\n        If .Range(\"B\" &amp; lRow).value &lt;&gt; \"\" Then\n            ShtName = .Range(\"B\" &amp; lRow).value\n            Set DestSht = Worksheets(ShtName)\n            LastRow = DestSht.Cells(DestSht.Rows.Count, \"B\").End(xlUp).Row + 1\n            .Rows(lRow).Copy Destination:=DestSht.Range(\"A\" &amp; LastRow)\n            .Rows(lRow).Delete xlShiftUp\n        End If\n    Next lRow\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7406586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/20320efe9977284e3e9e6e8a0708ee47?s=128&d=identicon&r=PG&f=1", "display_name": "fungrymonster", "link": "https://stackoverflow.com/users/7406586/fungrymonster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 41615853, "answer_count": 2, "score": -1, "last_activity_date": 1484231892, "creation_date": 1484166617, "last_edit_date": 1484168853, "question_id": 41600141, "link": "https://stackoverflow.com/questions/41600141/create-and-add-rows-to-worksheet", "title": "Create and Add rows to Worksheet", "body": "<p>I'm rather new to to VBA coding. I want to set up a template and would like to create a macro that looks at column B. Then creates new worksheets for the different inputs in B. Lastly it then pulls all rows with value \"B1\" and puts them into the corresponding worksheet.</p>\n\n<p>(Example if unclear) Column B includes the values 1 and 2. Code then creates worksheets called \"1\" and \"2\". Then takes all the rows that have 1 in column B and puts them in worksheet \"1\", and similar for value \"2\".</p>\n\n<pre><code>Sub Sheet() \n    Dim NewSheet As Worksheet\n    Dim cell As Object\n    Dim cellRange As Long\n\n    For Each Worksheets(\"ImportSheet\") In [Column J]\n        Set NewSheet = Nothing\n        On Error Resume Next\n        Set NewSheet = Worksheets(rng.Value)\n        On Error GoTo 0\n        If NewSheet Is Nothing Then\n            Worksheets.Add(After:=Sheets(Sheets.Count)).Name = rng.Value\n        End If\n    Next rng\nEnd Sub\n</code></pre>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 100, "user_id": 2275597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81a00c67cd0f511840e96e3d459ed11d?s=128&d=identicon&r=PG", "display_name": "Dave Clough", "link": "https://stackoverflow.com/users/2275597/dave-clough"}, "is_accepted": false, "score": 0, "last_activity_date": 1484166443, "creation_date": 1484166443, "answer_id": 41600101, "question_id": 41599979, "link": "https://stackoverflow.com/questions/41599979/passing-string-to-another-sub-routine/41600101#41600101", "title": "Passing String to another sub routine", "body": "<p>The two subroutines have different scope. Variables defined JrnlHeader are not available in PrintToTextFile.  If you want header to be available in PrintToTextFile the change it to PrintToTextFile(header as string)  and call PrintToTextFile(header) from JrnlHeader.</p>\n"}, {"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 1, "last_activity_date": 1484167189, "last_edit_date": 1484167189, "creation_date": 1484166886, "answer_id": 41600211, "question_id": 41599979, "link": "https://stackoverflow.com/questions/41599979/passing-string-to-another-sub-routine/41600211#41600211", "title": "Passing String to another sub routine", "body": "<p>You have defined <code>Header</code> to be a local variable in <code>JrnlHeader</code>.  This means its scope does not extend to other subroutines/functions.</p>\n\n<p>You can define the scope of the variable to be \"module\" level, by placing the <code>Dim Header As String</code> statement prior to the first subroutine/function within the code module.  Then its value will be available when execution resumes in <code>PrintToTextFile</code>.</p>\n\n<hr>\n\n<p>Alternatively, you could change your code to pass the variable as a parameter between the two functions:</p>\n\n<pre><code>Sub PrintToTextFile()\n\n    Dim Header As String\n    '...\n    JnrlHeader Header\n    '...\n    Print #FileNum, Header\nEnd Sub\n\nSub JrnlHeader(Header As String)\n    '...  (but don't include any declaration of Header!)\n    Header = \"&lt;JRNL_HDR_IMP&gt;\"\n    '...\nEnd Sub\n</code></pre>\n\n<p>But, judging by how many variables are being set up in <code>JrnlHeader</code>, I think you will want to go with using a module-level scoped variable approach.</p>\n"}], "owner": {"reputation": 13, "user_id": 6841538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df5f58ca279e3888d3dc0689501e35c7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay De", "link": "https://stackoverflow.com/users/6841538/jay-de"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1770, "favorite_count": 0, "closed_date": 1484168306, "answer_count": 2, "score": 0, "last_activity_date": 1484167602, "creation_date": 1484165893, "last_edit_date": 1531164843, "question_id": 41599979, "link": "https://stackoverflow.com/questions/41599979/passing-string-to-another-sub-routine", "closed_reason": "Duplicate", "title": "Passing String to another sub routine", "body": "<p>I am trying to practice embedding my code. I created a subroutine called <code>JrnlHeader</code> to declare variables I will use in another subroutine.  I am currently only concerned with one variable named <code>Header</code>.  I would like to know why <code>Header</code> is empty in subroutine <code>PrintToTextFile</code> and how I can fix it to be able to use strings declared in JrnlHeader.</p>\n\n<pre><code>Private Sub JrnlHeader()\n    Dim Header As String\n    Dim SeqNo As String\n    Dim SeqVar As String\n    Dim Bu As String\n    Dim BuVar As String\n    Dim JrnlID As String\n    Dim JrnlIDVar As String\n    Dim JrnlDate As String\n    Dim JrnlDateVar As String\n    Dim Descr As String\n    Dim DescrVar As String\n    Dim Ledger As String\n    Dim LedgerVar As String\n    Dim Source As String\n    Dim SourceVar As String\n    Dim CurEff As String\n    Dim Reverse As String\n    Dim AutoLn As String\n    Dim AdjEnt As String\n\n    Header = \"&lt;JRNL_HDR_IMP&gt;\"\n    SeqNo = \"&lt;SEQNO&gt;\" &amp; SeqVar &amp; \"&lt;/SEQNO&gt;\"\n    Bu = \"&lt;BUSINESS_UNIT&gt;\" &amp; BuVar &amp; \"&lt;/BUSINESS_UNIT&gt;\"\n    JrnlID = \"&lt;JOURNAL_ID&gt;\" &amp; JrnlIDVar &amp; \"&lt;/JOURNAL_ID&gt;\"\n    JrnlDate = \"&lt;JOURNAL_DATE&gt;\" &amp; JrnlDateVar &amp; \"&lt;/JOURNAL_DATE&gt;\"\n    Descr = \"&lt;DESCR254&gt;\" &amp; DescrVar &amp; \"&lt;/DESCR254&gt;\"\n    Ledger = \"&lt;LEDGER_GROUP&gt;\" &amp; LedgerVar &amp; \"&lt;/LEDGER_GROUP&gt;\"\n    Source = \"&lt;SOURCE&gt;\" &amp; SourceVar &amp; \"&lt;/SOURCE&gt;\"\n    CurEff = \"&lt;CUR_EFFDT&gt;\" &amp; JrnlDateVar &amp; \"&lt;/CUR_EFFDT&gt;\"\n    Reverse = \"&lt;REVERSAL_CD&gt;N&lt;/REVERSAL_CD&gt;\"\n    AutoLn = \"&lt;AUTO_GEN_LINES&gt;N&lt;/AUTO_GEN_LINES&gt;\"\n    AdjEnt = \"&lt;ADJUSTING_ENTRY&gt;N&lt;/ADJUSTING_ENTRY&gt;\"\nEnd Sub\n\nSub PrintToTextFile()\n    Dim FileNum As Integer\n\n    JrnlHeader\n\n    FileNum = FreeFile ' next free filenumber\n\n    'Open \"C:\\Temp\\TEXTFILE.TXT\" For Output As #FileNum ' creates the new file\n    Open \"C:\\temp\\TEXTFILE.TXT\" For Append As #FileNum\n    Print #FileNum, Header\n    Close #FileNum ' close the file\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1484166717, "post_id": 41599963, "comment_id": 70403071, "body": "if no type is specified to the paramarray variable, then any type can be passed <a href=\"http://stackoverflow.com/questions/20783170/pass-array-to-paramarray\" title=\"pass array to paramarray\">stackoverflow.com/questions/20783170/pass-array-to-paramarra&zwnj;&#8203;y</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1484167051, "post_id": 41599963, "comment_id": 70403228, "body": "If you need your ParamArray to contain pairs of values then check the ubound and raise an error if it&#39;s even.  Pretty sure there&#39;s no up-front way to &quot;force&quot; the user to call it using the correct number of arguments."}], "owner": {"reputation": 729, "user_id": 5248324, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/OfvTl.jpg?s=128&g=1", "display_name": "ToMakPo", "link": "https://stackoverflow.com/users/5248324/tomakpo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 281, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1484167267, "creation_date": 1484165830, "last_edit_date": 1484167267, "question_id": 41599963, "link": "https://stackoverflow.com/questions/41599963/vba-paramarray-with-sets-of-values-instead-of-individual-values", "title": "VBA: ParamArray() with sets of values instead of individual values", "body": "<p>In Excel VBA, I understand how to use <code>ParamArray()</code> but is there a way to require sets of parameters instead of just one at a time. For example; <code>sum(val1, val2, val3, ...)</code> lets you enter one value at a time, but with <code>sumifs(A:A, rng1, val1, rng2, val2, ...)</code> you are required to put the <code>rng</code> and <code>val</code> as a set. Is there a way to do that with user defined functions?</p>\n\n<p>I feel like it is just something I will need to do in the code but I would like it to correct from the start.</p>\n\n<pre><code>Function foo(bar As String, ParamArray names() As String, ParamArray attributs() As Range) As String\n    ...\nEnd Function\n</code></pre>\n\n<p>in the cell</p>\n\n<pre><code>=foo(\"hello\", \"name\", A2:A5, \"age\", B2:B5, \"address\", C2:C5)\n</code></pre>\n"}, {"tags": ["vba", "excel", "internet-explorer"], "comments": [{"owner": {"reputation": 831, "user_id": 2159907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23f3e67a3c0fd17bfb9bf369b35fd431?s=128&d=identicon&r=PG", "display_name": "Rob Parsons", "link": "https://stackoverflow.com/users/2159907/rob-parsons"}, "edited": false, "score": 0, "creation_date": 1484385139, "post_id": 41599791, "comment_id": 70495911, "body": "That&#39;s VB code... Which versions of windows and IE are you using.. I think from memory VB6 requires the hwnd to be declared as a lPtr. The VB6 IDE has a debugger which you can place break points in. In your test function you should test for a hwnd value of 0... also (I think) nested quotes should be doubled... &quot;alert(&#39;test&#39;)&quot; s.b &quot;alert(&#39;&#39;test&#39;&#39;)&quot; (&#39;&#39; == two &#39;). Visual Basic is no longer supported. You should abandon your work with it."}, {"owner": {"reputation": 831, "user_id": 2159907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23f3e67a3c0fd17bfb9bf369b35fd431?s=128&d=identicon&r=PG", "display_name": "Rob Parsons", "link": "https://stackoverflow.com/users/2159907/rob-parsons"}, "edited": false, "score": 0, "creation_date": 1484385757, "post_id": 41599791, "comment_id": 70496049, "body": "IE9 on Windows 7 does not append the string &quot;Internet Explorer&quot; to the end of the tabs document title. Use the spy++ utility that comes with Visual Studio to examine the window titles of the tabs under the Internet Explorer_server object."}, {"owner": {"reputation": 831, "user_id": 2159907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23f3e67a3c0fd17bfb9bf369b35fd431?s=128&d=identicon&r=PG", "display_name": "Rob Parsons", "link": "https://stackoverflow.com/users/2159907/rob-parsons"}, "edited": false, "score": 0, "creation_date": 1484386085, "post_id": 41599791, "comment_id": 70496111, "body": "the MVP site was last updated in 2000. I think you can safely give up on that code."}], "owner": {"reputation": 443, "user_id": 3279592, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0fe51532f0990a2408c84b391579a80e?s=128&d=identicon&r=PG", "display_name": "Neophear", "link": "https://stackoverflow.com/users/3279592/neophear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2452, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484165110, "creation_date": 1484165110, "last_edit_date": 1531164843, "question_id": 41599791, "link": "https://stackoverflow.com/questions/41599791/control-ie-from-hwnd", "title": "Control IE from hwnd", "body": "<p>I have been trying to get this to work for days now.\nMy situation is that I have an excel document that needs browse a website as another windows user.</p>\n\n<p>I have no problem controlling a webbrowser (IE) as the current user. But I cant launch or get the browser if I start it as another user.</p>\n\n<p>I found a sample here: <a href=\"http://www.mvps.org/emorcillo/en/code/vb6/iedom.shtml\" rel=\"nofollow noreferrer\">http://www.mvps.org/emorcillo/en/code/vb6/iedom.shtml</a> but I cant take control of the elements on the page.</p>\n\n<p>Almost all the code below is from that site except the last function test().</p>\n\n<pre><code>'\n' Requires: reference to \"Microsoft HTML Object Library\"\n'\nPrivate Type UUID\n   Data1 As Long\n   Data2 As Integer\n   Data3 As Integer\n   Data4(0 To 7) As Byte\nEnd Type\n\nPrivate Declare Function SetForegroundWindow Lib \"user32\" (ByVal hwnd As Long) As Long\n\nPrivate Declare Function GetClassName Lib \"user32\" _\n   Alias \"GetClassNameA\" ( _\n   ByVal hwnd As Long, _\n   ByVal lpClassName As String, _\n   ByVal nMaxCount As Long) As Long\n\nPrivate Declare Function EnumChildWindows Lib \"user32\" ( _\n   ByVal hWndParent As Long, _\n   ByVal lpEnumFunc As Long, _\n   lParam As Long) As Long\n\nPrivate Declare Function RegisterWindowMessage Lib \"user32\" _\n   Alias \"RegisterWindowMessageA\" ( _\n   ByVal lpString As String) As Long\n\nPrivate Declare Function SendMessageTimeout Lib \"user32\" _\n   Alias \"SendMessageTimeoutA\" ( _\n   ByVal hwnd As Long, _\n   ByVal msg As Long, _\n   ByVal wParam As Long, _\n   lParam As Any, _\n   ByVal fuFlags As Long, _\n   ByVal uTimeout As Long, _\n   lpdwResult As Long) As Long\n\nPrivate Const SMTO_ABORTIFHUNG = &amp;H2\n\nPrivate Declare Function ObjectFromLresult Lib \"oleacc\" ( _\n   ByVal lResult As Long, _\n   riid As UUID, _\n   ByVal wParam As Long, _\n   ppvObject As Any) As Long\n\nPrivate Declare Function FindWindow Lib \"user32\" _\n   Alias \"FindWindowA\" ( _\n   ByVal lpClassName As String, _\n   ByVal lpWindowName As String) As Long\n\n'\n' IEDOMFromhWnd\n'\n' Returns the IHTMLDocument interface from a WebBrowser window\n'\n' hWnd - Window handle of the control\n'\nFunction IEDOMFromhWnd(ByVal hwnd As Long) As IHTMLDocument\n    Dim IID_IHTMLDocument As UUID\n    Dim hWndChild As Long\n    Dim lRes As Long\n    Dim lMsg As Long\n    Dim hr As Long\n\n    If hwnd &lt;&gt; 0 Then\n        If Not IsIEServerWindow(hwnd) Then\n            ' Find a child IE server window\n            EnumChildWindows hwnd, AddressOf EnumChildProc, hwnd\n        End If\n\n        If hwnd &lt;&gt; 0 Then\n\n            ' Register the message\n            lMsg = RegisterWindowMessage(\"WM_HTML_GETOBJECT\")\n\n            ' Get the object pointer\n            Call SendMessageTimeout(hwnd, lMsg, 0, 0, _\n                SMTO_ABORTIFHUNG, 1000, lRes)\n\n            If lRes Then\n                ' Initialize the interface ID\n                With IID_IHTMLDocument\n                    .Data1 = &amp;H626FC520\n                    .Data2 = &amp;HA41E\n                    .Data3 = &amp;H11CF\n                    .Data4(0) = &amp;HA7\n                    .Data4(1) = &amp;H31\n                    .Data4(2) = &amp;H0\n                    .Data4(3) = &amp;HA0\n                    .Data4(4) = &amp;HC9\n                    .Data4(5) = &amp;H8\n                    .Data4(6) = &amp;H26\n                    .Data4(7) = &amp;H37\n                End With\n\n                ' Get the object from lRes\n                hr = ObjectFromLresult(lRes, IID_IHTMLDocument, _\n                    0, IEDOMFromhWnd)\n            End If\n        End If\n    End If\nEnd Function\n\nPrivate Function IsIEServerWindow(ByVal hwnd As Long) As Boolean\nDim lRes As Long\nDim sClassName As String\n\n   ' Initialize the buffer\n   sClassName = String$(100, 0)\n\n   ' Get the window class name\n   lRes = GetClassName(hwnd, sClassName, Len(sClassName))\n   sClassName = Left$(sClassName, lRes)\n\n   IsIEServerWindow = StrComp(sClassName, _\n                      \"Internet Explorer_Server\", _\n                      vbTextCompare) = 0\n\nEnd Function\n\n'\n' Copy this function to a .bas module\n'\nFunction EnumChildProc(ByVal hwnd As Long, lParam As Long) As Long\n    If IsIEServerWindow(hwnd) Then\n        lParam = hwnd\n    Else\n        EnumChildProc = 1\n    End If\nEnd Function\n\nFunction test()\n    Dim hwnd As Long\n    Dim doc As MSHTML.HTMLDocument\n\n    hwnd = FindWindow(\"IEFrame\", \"Google - Internet Explorer\")\n\n    Set doc = IEDOMFromhWnd(hwnd)\n    doc.execCommand \"alert('test')\"\nEnd Function\n</code></pre>\n\n<p>It might have something to do with the fact that I get an Interface instead of an actual document, but I dont know how to change this.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "edited": false, "score": 0, "creation_date": 1484167520, "post_id": 41600293, "comment_id": 70403497, "body": "It would probably make more sense to declare the range first and then use a single <code>For Each</code> loop instead of the nested loops."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "edited": false, "score": 0, "creation_date": 1484167728, "post_id": 41600293, "comment_id": 70403593, "body": "@J_Lard I attempted to do Dim Rng as Range, Rng = Range(&quot;C4:I32&quot;), then still found myself nesting loops.  This just seemed easier, in comparison.  If I was doing it wrong, that would also make sense why it was a pain to think through..."}, {"owner": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "edited": false, "score": 0, "creation_date": 1484167985, "post_id": 41600293, "comment_id": 70403731, "body": "You could say <code>Set rng = Range(&quot;C4:I32&quot;)</code> then something like <code>For Each c in rng... If c.Value = &quot;&quot;...</code>. Either way should work though :)"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "edited": false, "score": 0, "creation_date": 1484168151, "post_id": 41600293, "comment_id": 70403802, "body": "Got&#39;cha!  Thanks for the tip for next time... I&#39;m still pretty new to looping, myself.  I have had lots of help to date to get to where I&#39;m at."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 0, "last_activity_date": 1484167517, "last_edit_date": 1484167517, "creation_date": 1484167201, "answer_id": 41600293, "question_id": 41599749, "link": "https://stackoverflow.com/questions/41599749/excel-vba-looping/41600293#41600293", "title": "Excel VBA Looping", "body": "<p>Would something like this work?</p>\n\n<pre><code>Dim i as Variant\nDim j as Variant\n\nFor i = 4 to 32\nFor j = 3 to 9\n\n    If Cells(i,j).Value=\"\" Then\n\n    MsgBox \"Missing value in Cell(\" &amp; i &amp; \" ,\" &amp; j &amp; \").\"\n\n    End If\n\nNext j\nNext i\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7406275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/phgxE.jpg?s=128&g=1", "display_name": "GreenGraffix", "link": "https://stackoverflow.com/users/7406275/greengraffix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 1, "accepted_answer_id": 41600293, "answer_count": 1, "score": 0, "last_activity_date": 1484249908, "creation_date": 1484164972, "last_edit_date": 1531164843, "question_id": 41599749, "link": "https://stackoverflow.com/questions/41599749/excel-vba-looping", "title": "Excel VBA Looping", "body": "<p>Okay bear with me on this, I am pretty new to VBA in Excel. I have been trying to figure out how to loop in a time sheet I made for error checking for a few days now and I am just dumbfounded. </p>\n\n<p>My time sheet looks like this\n<img src=\"https://i.stack.imgur.com/FsREU.jpg\" alt=\"\"></p>\n\n<p>So I have been trying to get a loop to look for empty cells. </p>\n\n<p>My range would be (\"C4:I4\") &amp; I need to run this on 29 rows starting with C4.</p>\n\n<ul>\n<li>If a row has data in each cell in the range then I would like it to <code>GoTo 500</code>.</li>\n<li>If a row has data in any cells but all are not filled in I need it to display a <code>MsgBox</code> to tell the user what needs to be filled in.</li>\n<li>If an entire range in a row besides the first is empty then I need to <code>GoTo 500</code> to run the save file part of the code. </li>\n</ul>\n\n<p>Any help would be greatly appreciated. I have scoured through the forums and tried to get multiple looping examples to work for me but have been unable to do so.</p>\n\n<pre><code>Sub checkemptycells()\n\n    Dim x As String\n\n    Range(\"C1\").Select\n    If ActiveCell.Text = \"\" Then\n        MsgBox \"Pick Your Name\"\n        GoTo 1000\n    End If\n\n    Range(\"G1\").Select\n    If ActiveCell.Text = \"\" Then\n        MsgBox \"ENTER A DATE\"\n        GoTo 1000\n    End If\n\n    Range(\"C4\").Select\n    If ActiveCell.Text = \"\" Then\n        MsgBox \"Need Job#\"\n        GoTo 1000\n    End If\n\n    Range(\"D4\").Select\n    If ActiveCell.Text = \"\" Then\n        MsgBox \"need qty.\"\n        GoTo 1000\n    End If\n\n    Range(\"E4\").Select\n    If ActiveCell.Text = \"\" Then\n        MsgBox \"Need Work Order!\"\n        GoTo 1000\n    End If\n\n    Range(\"F4\").Select\n    If ActiveCell.Text = \"\" Then\n        MsgBox \"Pick a Dept.!\"\n        GoTo 1000\n    End If\n\n    Range(\"G4:I4\").Select\n    If ActiveCell.Text = \"\" Then\n        MsgBox \"Fill Start &amp; Stop times on this line\"\n        GoTo 1000\n    End If\n\n    Dim FilePath As String\n    Dim FileName As String\n    Dim MyDate As String\n    Dim USER As String\n\n    FilePath = \"Z:\\TIMESHEETS\\\"\n    MyDate = Format(Now(), \"mm_dd_yyyy_\")\n    USER = (ActiveSheet.Range(\"  C1\"))\n\n    FileName = FilePath &amp; MyDate &amp; USER\n    ActiveWorkbook.SaveAs FileName:=FileName, FileFormat:=xlWorkbookNormal\n    ActiveWorkbook.Close\n    OpenAfterPublish = False\n    xls.DisplayAlerts = False\n\n1000\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "powershell"], "answers": [{"tags": [], "owner": {"reputation": 7, "user_id": 6100237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fde23416197d3659f27995e5d547fe3b?s=128&d=identicon&r=PG&f=1", "display_name": "John Heinze", "link": "https://stackoverflow.com/users/6100237/john-heinze"}, "is_accepted": false, "score": -1, "last_activity_date": 1484167000, "creation_date": 1484167000, "answer_id": 41600242, "question_id": 41599693, "link": "https://stackoverflow.com/questions/41599693/after-opening-a-mpu-file-in-notepad-my-code-no-longer-can-find-it-inside-a-zip/41600242#41600242", "title": "After opening a .mpu file in notepad my code no longer can find it inside a zip file", "body": "<p>I fixed it by changing the file explorer settings to not hide known file paths.</p>\n"}], "owner": {"reputation": 7, "user_id": 6100237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fde23416197d3659f27995e5d547fe3b?s=128&d=identicon&r=PG&f=1", "display_name": "John Heinze", "link": "https://stackoverflow.com/users/6100237/john-heinze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484167000, "creation_date": 1484164797, "last_edit_date": 1531164843, "question_id": 41599693, "link": "https://stackoverflow.com/questions/41599693/after-opening-a-mpu-file-in-notepad-my-code-no-longer-can-find-it-inside-a-zip", "title": "After opening a .mpu file in notepad my code no longer can find it inside a zip file", "body": "<pre><code>Sub Unzip2()\nDim FSO As Object\nDim oApp As Object\nDim Fname As Variant\nDim FileNameFolder As Variant\nDim DefPath As String\nDim strDate As String\nDim fileNameInZip As Variant\n'direct = \"Y:\\DataServices\\JohnH\\MACRO Domestic\\AUTO GLS\\REAL ZIPS\"\nzippy = Dir(direct &amp; \"\\*.zip\")\nFname = direct &amp; \"\\\" &amp; zippy\n\n\nIf Fname = False Then\n    'Do nothing\nElse\n    'Root folder for the new folder.\n    'You can also use DefPath = \"C:\\Users\\Ron\\test\\\"\n    'DefPath = Application.DefaultFilePath\n    'If Right(DefPath, 1) &lt;&gt; \"\\\" Then\n     '   DefPath = DefPath &amp; \"\\\"\n    'End If\n\n    'Create the folder name\n    'strDate = Format(Now, \" dd-mm-yy h-mm-ss\")\n    FileNameFolder = direct &amp; \"\\\"\n\n    'Make the normal folder in DefPath\n    'MkDir FileNameFolder\n\n    'Extract the files into the newly created folder\n    Set oApp = CreateObject(\"Shell.Application\")\n\n    'Change this \"*.txt\" to extract the files you want\n    For Each fileNameInZip In oApp.Namespace(Fname).Items\n        If LCase(fileNameInZip) Like LCase(\"*.MPU\") Then\n            oApp.Namespace(FileNameFolder).CopyHere _\n                    oApp.Namespace(Fname).Items.Item(CStr(fileNameInZip))\n        End If\n    Next\n\n   ' MsgBox \"You find the files here: \" &amp; FileNameFolder\n\n    On Error Resume Next\n    Set FSO = CreateObject(\"scripting.filesystemobject\")\n    FSO.DeleteFolder Environ(\"Temp\") &amp; \"\\Temporary Directory*\", True\nEnd If\n'direct = \"Y:\\Excel\\EPICAC\\NEW FILES\\RESULTS\\\"\nMkDir (direct &amp; \"\\\" &amp; \"Results\")\n\nEnd Sub\n</code></pre>\n\n<p>I am using the code above in order to extract zips with a .mpu file (which really is just a text file) and then later opening and reading some data out of it.</p>\n\n<p>However, I had to read some data from an MPU in the zip manually today and opened it in notepad. Now when I go into a .zip the file type no longer shows up in the name of the file, and the code does not recognize there are any MPUs in the file. </p>\n\n<p>Is there a way to reverse it so either Windows doesn't remove the .mpu from the file name or a way I can look at file type instead?  </p>\n"}, {"tags": ["vba", "ms-access", "odbc"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1484168777, "post_id": 41599635, "comment_id": 70404123, "body": "There is no easy way - but I wonder how you came this far before meeting that message."}], "answers": [{"comments": [{"owner": {"reputation": 596, "user_id": 6855437, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/QYZ8M.png?s=128&g=1", "display_name": "BLang", "link": "https://stackoverflow.com/users/6855437/blang"}, "edited": false, "score": 0, "creation_date": 1484578807, "post_id": 41602851, "comment_id": 70555598, "body": "yeah, thats pretty much the process i followed!! Thanks for the post!"}], "tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": false, "score": 2, "last_activity_date": 1484178464, "creation_date": 1484178464, "answer_id": 41602851, "question_id": 41599635, "link": "https://stackoverflow.com/questions/41599635/apply-dbseechanges-to-all-recordsets-vba/41602851#41602851", "title": "apply dbSeeChanges to all recordsets VBA", "body": "<p>The quickest way would be to cut the text</p>\n\n<p>,dbOpenDynaset, dbSeeChanges</p>\n\n<p>Into your cut/paste buffer.</p>\n\n<p>You then do a global search on OpenRecordSet(</p>\n\n<p>When you find a match (hit f3 for search). When you see a match, then tap \u201cend\u201d key to move to end of line, then one back arrow, and then a ctrl-v to paste in above. Now hit f3 and do this again (and again etc.).</p>\n\n<p>The above process will occur quite rapid \u2013 even in a large application the above will only take a few minutes. You could I suppose use some VBA to read all code and modify, but I think the above process would be faster than working out some VBA to do a global type of replace on the code.</p>\n\n<p>So you can do a global search, but no \"pattern\" match replace is available in the VBA IDE.</p>\n"}], "owner": {"reputation": 596, "user_id": 6855437, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/QYZ8M.png?s=128&g=1", "display_name": "BLang", "link": "https://stackoverflow.com/users/6855437/blang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 838, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484178464, "creation_date": 1484164606, "question_id": 41599635, "link": "https://stackoverflow.com/questions/41599635/apply-dbseechanges-to-all-recordsets-vba", "title": "apply dbSeeChanges to all recordsets VBA", "body": "<p>I am using MS access 2016 as a front end and have ODBC to a microsoft SQL server.</p>\n\n<p>When i open a recordset in VBA i got the \"You must use the dbSeeChanges option with OpenRecordSet...\"</p>\n\n<p>Now i have resolved this issue, so my question is this: Is there an easy way to apply this to all places where a recordset is created? Is there some simple setting to check in VBA? Because there are a lot of recordsets that get made throughout my code and adding the dbSeeChanges command everywhere will take a long time.</p>\n\n<p>In case someone wants the fix for the dbSeeChanges:</p>\n\n<pre><code>Set tempRcst = CurrentDb.OpenRecordset(\"SELECT * FROM table1\", dbOpenDynaset, dbSeeChanges)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "edited": false, "score": 0, "creation_date": 1484164604, "post_id": 41599583, "comment_id": 70401896, "body": "When you say &#39;return a specified shorter number&#39;, do you mean you have a list of shorter numbers and you want to find which one corresponds to a particular large number?"}, {"owner": {"reputation": 13020, "user_id": 4505446, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/GXF8z.png?s=128&g=1", "display_name": "A-Sharabiani", "link": "https://stackoverflow.com/users/4505446/a-sharabiani"}, "edited": false, "score": 0, "creation_date": 1484169851, "post_id": 41599583, "comment_id": 70404702, "body": "Also, is there any formula that maps the numbers to their shortened form? e.x. 200 / 200 = 1, 400 / 200 = 2, ... x / 200 ?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7406471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38d4b7838690f7cb303bd56981e855f3?s=128&d=identicon&r=PG&f=1", "display_name": "conor steele", "link": "https://stackoverflow.com/users/7406471/conor-steele"}, "edited": false, "score": 0, "creation_date": 1484223508, "post_id": 41599720, "comment_id": 70427277, "body": "Thank you this has worked well. A slight issue is that it is only amending the number in column A of the datasheet. How do I specify the column from which to run the macro? Also, is there a way to run the macro automatically when the column is populated with the long numbers?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1484164905, "creation_date": 1484164905, "answer_id": 41599720, "question_id": 41599583, "link": "https://stackoverflow.com/questions/41599583/code-to-shorten-specified-numbers-in-column/41599720#41599720", "title": "Code to shorten specified numbers in column", "body": "<p>Here is a small example with a double loop:</p>\n\n<pre><code>Sub Shorten()\n    Dim ary(1 To 4) As Long, bry(1 To 4) As Long\n    Dim I As Long, N As Long\n\n    ary(1) = 100\n    ary(2) = 234\n    ary(3) = 8765\n    ary(4) = 123\n    bry(1) = 1\n    bry(2) = 2\n    bry(3) = 3\n    bry(4) = 4\n    N = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    For I = 1 To N\n        For j = 1 To 4\n            If Cells(I, 1).Value = ary(j) Then Cells(I, 1).Value = bry(j)\n        Next j\n    Next I\nEnd Sub\n</code></pre>\n\n<p>ary() contains the list of \"long\" values and bry() the list of \"shorter\" values.</p>\n"}], "owner": {"reputation": 1, "user_id": 7406471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38d4b7838690f7cb303bd56981e855f3?s=128&d=identicon&r=PG&f=1", "display_name": "conor steele", "link": "https://stackoverflow.com/users/7406471/conor-steele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1484164905, "creation_date": 1484164425, "last_edit_date": 1531164843, "question_id": 41599583, "link": "https://stackoverflow.com/questions/41599583/code-to-shorten-specified-numbers-in-column", "title": "Code to shorten specified numbers in column", "body": "<p>I'm trying to set up a code to read a series of numbers in a column and return a specified shorter number. For example, if the number is 200 then this would return the number 1 and 400 would return 2. Any thoughts if this is possible?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1484164369, "post_id": 41599553, "comment_id": 70401785, "body": "Can you sort? If so, you could sort the table based on the numbers, and delete all except the last row of each group.  What have you tried so far?"}, {"owner": {"reputation": 21, "user_id": 6209994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeae32aa9da97fe7c3bbaf5b58123d20?s=128&d=identicon&r=PG&f=1", "display_name": "ygao85", "link": "https://stackoverflow.com/users/6209994/ygao85"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1484164572, "post_id": 41599553, "comment_id": 70401882, "body": "Sorting is a viable option if the sample size was fairly small. However the data which I am working with has over 500+ different &quot;&quot;groups&quot; - this will be very time consuming."}, {"owner": {"reputation": 1543, "user_id": 2142248, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/F2o9H.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/2142248/adam"}, "edited": false, "score": 0, "creation_date": 1484165615, "post_id": 41599553, "comment_id": 70402515, "body": "Does it have to be a macro? Pivot tables are great for this kind of stuff."}], "answers": [{"tags": [], "owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "is_accepted": false, "score": 0, "last_activity_date": 1484166275, "creation_date": 1484166275, "answer_id": 41600071, "question_id": 41599553, "link": "https://stackoverflow.com/questions/41599553/conditional-row-removal/41600071#41600071", "title": "Conditional row removal", "body": "<p>If your letters are in column A and numbers are in column B, the following code should do the trick:</p>\n\n<pre><code>Sub FindMaxValue()\n\nDim CountLng As Long\n\n'find range\nCountLng = ActiveSheet.UsedRange.Rows.Count\n\n'loop through range to find max\nFor x1 = CountLng To 2 Step -1\n    For x2 = 2 To CountLng\n        If Range(\"A\" &amp; x1).Value = Range(\"A\" &amp; x2).Value And x1 &lt;&gt; x2 Then\n            If Range(\"B\" &amp; x1).Value &gt;= Range(\"B\" &amp; x2).Value Then\n                Rows(x2).EntireRow.Delete\n                Exit for\n            Else\n                Rows(x1).EntireRow.Delete\n                Exit For\n            End If\n        End If\n    Next x2\nNext x1\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1484166871, "creation_date": 1484166871, "answer_id": 41600207, "question_id": 41599553, "link": "https://stackoverflow.com/questions/41599553/conditional-row-removal/41600207#41600207", "title": "Conditional row removal", "body": "<p>you could use <code>Dictionary</code> to hold each letter maximum value and then <code>AutoFilter()</code> to delete \"lower\" values letter rows:</p>\n\n<pre><code>Option Explicit\n\nSub min()\n    Dim rng As Range, cell As Range\n    Dim key As Variant\n\n    Set rng = Range(\"B1\", Cells(Rows.Count, \"A\").End(xlUp))\n    With CreateObject(\"Scripting.Dictionary\")\n        For Each cell In rng.Resize(rng.Rows.Count - 1, 1).Offset(1)\n            If .Exists(cell.value) Then\n                If cell.Offset(, 1) &gt; .item(cell.value) Then .item(cell.value) = cell.Offset(, 1).value\n            Else\n                .Add cell.value, cell.Offset(, 1).value\n            End If\n        Next\n        Application.DisplayAlerts = False\n        For Each key In .Keys\n            rng.AutoFilter field:=1, Criteria1:=key\n            rng.AutoFilter field:=2, Criteria1:=\"&lt;\" &amp; .item(key)\n            rng.Resize(rng.Rows.Count - 1, 1).Offset(1).SpecialCells(xlCellTypeVisible).Delete\n            rng.AutoFilter\n        Next\n        Application.DisplayAlerts = True\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6209994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeae32aa9da97fe7c3bbaf5b58123d20?s=128&d=identicon&r=PG&f=1", "display_name": "ygao85", "link": "https://stackoverflow.com/users/6209994/ygao85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1555395973, "creation_date": 1484164303, "last_edit_date": 1555395973, "question_id": 41599553, "link": "https://stackoverflow.com/questions/41599553/conditional-row-removal", "title": "Conditional row removal", "body": "<p>I have the following Excel table:</p>\n\n<pre><code>Letter  Number\nA       15\nA       2212\nA       3741\nB       251\nB       7\nB       14201\nC       13503\nC       97\nC       113\n</code></pre>\n\n<p>I would like to go through the \"letter column\" and whenever there is the same letter, look at the \"number column\" beside it and <strong>delete the smaller values - keeping only the largest values</strong>. </p>\n\n<p>I would like the end result to have only one entry for each letter and the corresponding value next to it as shown below:</p>\n\n<pre><code>Letter  Number\nA       3741\nB       14201\nC       13503\n</code></pre>\n"}, {"tags": ["vba", "excel", "adodb"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1484172670, "post_id": 41599513, "comment_id": 70406008, "body": "Connection strings need full path. Change top line to: <code>esteLibro = libro.FullName</code>. Even still, I doubt you can update with opened workbook."}, {"owner": {"reputation": 11, "user_id": 7291335, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iSSexuPh3Kw/AAAAAAAAAAI/AAAAAAAAAE8/_vFCnGpWark/photo.jpg?sz=128", "display_name": "Jedicillo", "link": "https://stackoverflow.com/users/7291335/jedicillo"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1484221373, "post_id": 41599513, "comment_id": 70425897, "body": "I can read, so full path is not necessary. But even with full path, I still have the same error. And I have been unable to find some source that tells me that this cannot be done."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7291335, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iSSexuPh3Kw/AAAAAAAAAAI/AAAAAAAAAE8/_vFCnGpWark/photo.jpg?sz=128", "display_name": "Jedicillo", "link": "https://stackoverflow.com/users/7291335/jedicillo"}, "edited": false, "score": 0, "creation_date": 1484222708, "post_id": 41601753, "comment_id": 70426756, "body": "That is a simplified query. The real query is something like: <code>&#39;consUpdate = &quot;Update [Base$A3:T100000] Set INVERSIONES = prMonto &quot; &amp; _ &#39;                &quot;Where Empresa = prEmpresa and BANCO = prBanco and Fecha = prFecha &quot;</code> I want to use a parameterized query, for the filters in SQL, that is why I need ADODB. There could be gaps between the data that I want to update, so I cannot use range.copy... The other option, for now, is to just loop thru the rows to see if the data match my parameters, but I think it will be a lot slower with time and the increment in data."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 11, "user_id": 7291335, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iSSexuPh3Kw/AAAAAAAAAAI/AAAAAAAAAE8/_vFCnGpWark/photo.jpg?sz=128", "display_name": "Jedicillo", "link": "https://stackoverflow.com/users/7291335/jedicillo"}, "edited": false, "score": 0, "creation_date": 1484229343, "post_id": 41601753, "comment_id": 70431199, "body": "As mentioned you can use an <code>IIF()</code> to set logic and pass needed params: <code>SELECT Col1, Col2, Col3, IIF(Empresa = ? AND BANCO = ? AND Fecha =?, ?, INVERSIONES) AS NewInversiones, Col4, Col5, Col6 FROM [Base$A3:T100000]</code>. And I don&#39;t quite understand why <code>CopyFromRecordset</code> does not work as it would be exact copy of very table range in <code>FROM</code> clause, places right back starting at <code>Base$A3</code>."}, {"owner": {"reputation": 11, "user_id": 7291335, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iSSexuPh3Kw/AAAAAAAAAAI/AAAAAAAAAE8/_vFCnGpWark/photo.jpg?sz=128", "display_name": "Jedicillo", "link": "https://stackoverflow.com/users/7291335/jedicillo"}, "edited": false, "score": 0, "creation_date": 1484234741, "post_id": 41601753, "comment_id": 70435072, "body": "Now I understand. But still I am not comfortable with rewriting everything. Thank you. I suppose that what I want to do is not possible, so I will just use the old <code>For each r in ws.Range().Rows</code>."}, {"owner": {"reputation": 143, "user_id": 4394003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dba398f6ed6924d777ce90d64ac26ac8?s=128&d=identicon&r=PG&f=1", "display_name": "TestPilot10", "link": "https://stackoverflow.com/users/4394003/testpilot10"}, "edited": false, "score": 0, "creation_date": 1588252691, "post_id": 41601753, "comment_id": 108831565, "body": "I added a field to the Excel sheet with the row number and pulled the value into the query, then updated only the rows I wanted, ws.range(&quot;A&quot; &amp; rsCaja(&quot;rowNumber&quot;))=1000"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1484173162, "creation_date": 1484173162, "answer_id": 41601753, "question_id": 41599513, "link": "https://stackoverflow.com/questions/41599513/update-excel-with-adodb-with-workbook-open/41601753#41601753", "title": "Update Excel with ADODB with Workbook Open", "body": "<p>Consider running a read-only <code>SELECT</code> over the existing data of the opened workbook. For various reasons of file write access, Excel, being a flat file cached memory application, may not have the facility like databases to have application opened and current data updated synchronously. </p>\n\n<p>Below sets up <code>SELECT</code> query for you to mirror current structure with one change of passing a constant, 1000, and assigning it to the <em>INVERSIONES</em> column alias in current column position. A conditional logic <code>IIF</code> statement can easily be placed here as well. Alternatively, run query and dump results in a new worksheet. Then delete/archive current worksheet and save workbook.</p>\n\n<pre><code>Dim cnCaja As New ADODB.Connection\nDim rsCaja As New ADODB.Recordset\nDim consCaja As String\n\nesteLibro = ActiveWorkbook.FullName\ncnCaja.Open \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n            \"Data Source='\" &amp; esteLibro &amp; \"';\" &amp; _\n            \"Extended Properties='Excel 12.0;HDR=Yes;';\"\n\nconsCaja = \"SELECT Col1, Col2, Col3, '1000' AS INVERSIONES, Col4, Col5, Col6\" &amp; _\n           \" FROM [Base$A3:T100000]\"\nrsCaja.Open consCaja, cnCaja\n\nWorksheets(\"Base\").Range(\"A3\").CopyFromRecordset rsCaja\n\nrsCaja.Close: cnCaja.Close\nSet rsCaja As Nothing: Set cnCaja As Nothing\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7291335, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iSSexuPh3Kw/AAAAAAAAAAI/AAAAAAAAAE8/_vFCnGpWark/photo.jpg?sz=128", "display_name": "Jedicillo", "link": "https://stackoverflow.com/users/7291335/jedicillo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1561, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1547681953, "creation_date": 1484164187, "last_edit_date": 1547681953, "question_id": 41599513, "link": "https://stackoverflow.com/questions/41599513/update-excel-with-adodb-with-workbook-open", "title": "Update Excel with ADODB with Workbook Open", "body": "<p>In Excel 2010. I am trying to write/update some cells, based on some filters, on the same workbook that executes the macro; for simplicity, I have reduced de query to what you can see.\nThis code works, but only when the workbook is closed (tested from another workbook).</p>\n\n<pre><code>Dim libro As Workbook\nSet libro = ActiveWorkbook\nesteLibro = libro.Name\n\nDim cnCaja As ADODB.Connection\nDim rsCaja As ADODB.Recordset\nSet cnCaja = New ADODB.Connection\nSet rsCaja = New ADODB.Recordset\ncnCaja.Open \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n    \"Data Source='\" &amp; esteLibro &amp; \"';\" &amp; _\n        \"Extended Properties='Excel 12.0;HDR=Yes;ReadOnly=False';\"\n\nDim consCaja As String\nconsCaja = \"Update [Base$A3:T100000] Set INVERSIONES = 1000 \"\nrsCaja.Open consCaja, cnCaja, adOpenStatic, adLockOptimistic\n</code></pre>\n\n<p>When executed from another workbook, the column \"INVERSIONES\" will have its blank cells changed to 10000; but from the same workbook I got the error:</p>\n\n<blockquote>\n  <p>'-2147217865 (8004e37)' The Microsoft Access database engine could not\n  find the object '[Base$A3:T100000]'. Make sure the object exists and that you spell its\n  name and the path name correctly. If '' is not a local object, check\n  your network connection or contact the server administrator.</p>\n</blockquote>\n\n<p>This is the entire connection string:</p>\n\n<pre><code>Debug.Print cnCaja.ConnectionString\n</code></pre>\n\n<blockquote>\n  <p>Provider=Microsoft.ACE.OLEDB.12.0;User ID=Admin; Data\n  Source=Danny_Diario.xlsm;Mode=Share Deny None; Jet OLEDB:System\n  database=\"\";Jet OLEDB:Registry Path=\"\"; Jet OLEDB:Database\n  Password=\"\";Jet OLEDB:Engine Type=35; Jet OLEDB:Database Locking\n  Mode=0;Jet OLEDB:Global Partial Bulk Ops=2; Jet OLEDB:Global Bulk\n  Transactions=1;Jet OLEDB:New Database Password=\"\"; Jet OLEDB:Create\n  System Database=False;Jet OLEDB:Encrypt Database=False; Jet\n  OLEDB:Don't Copy Locale on Compact=False; Jet OLEDB:Compact Without\n  Replica Repair=False;Jet OLEDB:SFP=False; Jet OLEDB:Support Complex\n  Data=False; Jet OLEDB:Bypass UserInfo Validation=False;</p>\n</blockquote>\n\n<p>And, a query against the same table will work, even when the workbook is open.</p>\n\n<pre><code>consCaja = \"Select * from [Base$A3:T100000] Where Fecha = #\" &amp; fechaBase &amp; \"# and Empresa = \"\"Empresa\"\" and Banco = \"\"Banco\"\"\"\nrsCaja.Open consCaja, cnCaja, adOpenForwardOnly, adLockReadOnly\n\nDo While Not rsCaja.EOF\n    MsgBox (rsCaja(\"Empresa\").Value &amp; vbNewLine &amp; rsCaja(\"Banco\").Value &amp; vbNewLine &amp; rsCaja(\"INVERSIONES\").Value)\n    rsCaja.MoveNext\nLoop\n</code></pre>\n\n<p>Finally, is it possible to update an Excel with ADODB with the workbook open?\nIf yes, what am I doing wrong, or how do I resolve this?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 336, "user_id": 7381857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1599f87eff5cabfc62ad15cabe3b9c8?s=128&d=identicon&r=PG&f=1", "display_name": "Rufus", "link": "https://stackoverflow.com/users/7381857/rufus"}, "is_accepted": false, "score": 0, "last_activity_date": 1484163374, "last_edit_date": 1484163374, "creation_date": 1484162988, "answer_id": 41599187, "question_id": 41599116, "link": "https://stackoverflow.com/questions/41599116/how-to-skip-a-blank-cell/41599187#41599187", "title": "How to skip a blank cell?", "body": "<p>You need to add check of blank cell in you loop, for example:\nI added check in the second row (and end if just before end of loop) - it checks length of text in the cell:</p>\n\n<pre><code>For Each MyCell In MyRange\nIF(LEN(MYCELL.VALUE)&gt;0) THEN\n    On Error Resume Next\n\n    If CheckSheetExists(MyCell.Value) = False Then\n\n        Sheets(\"Template\").Copy After:=Sheets(Sheets.Count)\n\n        With Sheets(Sheets.Count)\n            .name = MyCell.Value\n            .Cells(3, 1) = MyCell.Value\n\n        End With\n    End If\n\nOn Error GoTo 0\n\nMyCell.Hyperlinks.Add Anchor:=MyCell, Address:=\"\", SubAddress:=\"'\" &amp; MyCell.Value &amp; \"'!A1\"\nEND IF\nNext MyCell\n</code></pre>\n\n<p>EDIT:\nI would change the function checking if WS exists:</p>\n\n<pre><code>Function CheckSheetExists(ByVal name As String) as boolean\ndim WS as worksheet\n\non error resume next\nset ws = Worksheet(name)\non error goto 0\n\nif(ws is nothing) then\nCheckSheetExists = false\nelse\nCheckSheetExists = true\nend if\n\nset ws=nothing\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 7359007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/637203decc7914da7a5f350e215855ec?s=128&d=identicon&r=PG&f=1", "display_name": "Simon M", "link": "https://stackoverflow.com/users/7359007/simon-m"}, "edited": false, "score": 0, "creation_date": 1484255384, "post_id": 41599191, "comment_id": 70447437, "body": "This work perfectly, exactly what I need - Thanks David!"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 0, "last_activity_date": 1484163318, "last_edit_date": 1495541240, "creation_date": 1484163002, "answer_id": 41599191, "question_id": 41599116, "link": "https://stackoverflow.com/questions/41599116/how-to-skip-a-blank-cell/41599191#41599191", "title": "How to skip a blank cell?", "body": "<p>Your problem is likely this assignment:</p>\n\n<pre><code>Set MyRange = Range(MyRange, MyRange.End(xlDown))\n</code></pre>\n\n<p>The <code>End(xlDown)</code> method will stop on a blank cell (generally).</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">this other answer</a> for more reliable ways to find the \"last\" cell in a given range.</p>\n\n<p>You may also want to move your <code>MyCell.Hyperlinks.Add</code> statement <em>within</em> the <code>If CheckSheetExists</code> block, <strong>and</strong> you'll need to add logic to skip empty cells (if there are empty cells within the <code>MyRange</code>.</p>\n\n<pre><code>Sub AutoAddSheet()\n\nDim MyCell As Range, MyRange As Range\n\nWith Sheets(\"Master\")\nSet MyRange = .Range(\"A5\")\nSet MyRange = .Range(MyRange, .Range(\"A\" &amp; .Rows.Count).End(xlUp))\n\nFor Each MyCell In MyRange\n\n    On Error Resume Next\n\n    If CheckSheetExists(MyCell.Value) = False And MyCell.Value &lt;&gt; vbNullString Then\n\n        Sheets(\"Template\").Copy After:=Sheets(Sheets.Count)\n\n        With Sheets(Sheets.Count)\n            .name = MyCell.Value\n            .Cells(3, 1) = MyCell.Value\n\n        End With\n        MyCell.Hyperlinks.Add Anchor:=MyCell, Address:=\"\", SubAddress:=\"'\" &amp; MyCell.Value &amp; \"'!A1\"\n    End If\n\nOn Error GoTo 0\n\nNext MyCell\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1484163200, "creation_date": 1484163200, "answer_id": 41599254, "question_id": 41599116, "link": "https://stackoverflow.com/questions/41599116/how-to-skip-a-blank-cell/41599254#41599254", "title": "How to skip a blank cell?", "body": "<p>How about:</p>\n\n<pre><code>For Each MyCell In MyRange\n    If MyCell.Value &lt;&gt; \"\" Then\n        On Error Resume Next\n            If CheckSheetExists(MyCell.Value) = False Then\n                Sheets(\"Template\").Copy After:=Sheets(Sheets.Count)\n                With Sheets(Sheets.Count)\n                    .Name = MyCell.Value\n                    .Cells(3, 1) = MyCell.Value\n                End With\n            End If\n        On Error GoTo 0\n        MyCell.Hyperlinks.Add Anchor:=MyCell, Address:=\"\", SubAddress:=\"'\" &amp; MyCell.Value &amp; \"'!A1\"\n    End If\nNext MyCell\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 7359007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/637203decc7914da7a5f350e215855ec?s=128&d=identicon&r=PG&f=1", "display_name": "Simon M", "link": "https://stackoverflow.com/users/7359007/simon-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 462, "favorite_count": 0, "accepted_answer_id": 41599191, "answer_count": 3, "score": 0, "last_activity_date": 1555556680, "creation_date": 1484162685, "last_edit_date": 1555556680, "question_id": 41599116, "link": "https://stackoverflow.com/questions/41599116/how-to-skip-a-blank-cell", "title": "How to skip a blank cell?", "body": "<p>I have a macro to create a new worksheet and rename that sheet with hyperlink based on the value of cell in the \"Master\" sheet range(\"A5\").</p>\n\n<p>It will stop at a blank cell. What should I add to skip the blank cell and continue?</p>\n\n<pre><code>Function CheckSheetExists(ByVal name As String)\n' checks if a worksheet already exists\n\nDim retVal As Boolean\n\nretVal = False\n\nFor s = 1 To Sheets.Count\n    If Sheets(s).name = name Then\n        retVal = True\n        Exit For\n    End If\nNext s\n\nCheckSheetExists = retVal\n\nEnd Function\n\nSub AutoAddSheet()\n\nDim MyCell As Range, MyRange As Range\n\nSet MyRange = Sheets(\"Master\").Range(\"A5\")\nSet MyRange = Range(MyRange, MyRange.End(xlDown))\n\nFor Each MyCell In MyRange\n\n    On Error Resume Next\n\n    If CheckSheetExists(MyCell.Value) = False Then\n\n        Sheets(\"Template\").Copy After:=Sheets(Sheets.Count)\n\n        With Sheets(Sheets.Count)\n            .name = MyCell.Value\n            .Cells(3, 1) = MyCell.Value\n\n        End With\n    End If\n\nOn Error GoTo 0\n\nMyCell.Hyperlinks.Add Anchor:=MyCell, Address:=\"\", SubAddress:=\"'\" &amp; MyCell.Value &amp; \"'!A1\"\n\nNext MyCell\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "edited": false, "score": 2, "creation_date": 1484162542, "post_id": 41599032, "comment_id": 70400787, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/538f81ec(v=VS.71).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/538f81ec(v=VS.71).aspx</a> <a href=\"http://stackoverflow.com/questions/949263/variable-number-of-arguments-in-paramarray-arglist\" title=\"variable number of arguments in paramarray arglist\">stackoverflow.com/questions/949263/&hellip;</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1484163328, "post_id": 41599032, "comment_id": 70401220, "body": "<code>ParamArray</code> is what you need.   <a href=\"http://www.tushar-mehta.com/publish_train/xl_vba_cases/1005%20ParamArray.shtml\" rel=\"nofollow noreferrer\">tushar-mehta.com/publish_train/xl_vba_cases/&hellip;</a>"}], "owner": {"reputation": 66, "user_id": 7406355, "user_type": "registered", "profile_image": "https://graph.facebook.com/10105147157536863/picture?type=large", "display_name": "Jake", "link": "https://stackoverflow.com/users/7406355/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1173, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1484162358, "creation_date": 1484162358, "last_edit_date": 1531161705, "question_id": 41599032, "link": "https://stackoverflow.com/questions/41599032/vba-excel-function-with-unlimited-number-of-parameters", "title": "VBA Excel Function with unlimited number of parameters", "body": "<p>I have a function that changes data from an excel spreadsheet into SQL update or insert statements. For the Update section of it, I have up to 4 variables that can get entered into the where clause, but I was wondering if you guys know how to add parameters indefinitely like the SUMIFS function. Here are the parameter declarations:</p>\n\n<pre><code>Public Function SQLCode(Fctn As String, TBL As String, rRange As Range, Optional Where1 As Variant, Optional Where2 As Variant, Optional Where3 As Variant, Optional Where4 As Variant) As String\n</code></pre>\n\n<p>Do I have any options aside from adding like 20 parameters and hoping nobody needs more than that?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 336, "user_id": 7381857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1599f87eff5cabfc62ad15cabe3b9c8?s=128&d=identicon&r=PG&f=1", "display_name": "Rufus", "link": "https://stackoverflow.com/users/7381857/rufus"}, "edited": false, "score": 0, "creation_date": 1484161896, "post_id": 41598731, "comment_id": 70400402, "body": "Do you mean that your solution counts also lines which match in regards of date but not for condition in range <code>L:L</code>? I put your code and for me it works fine. Did you replicated the same function in Excel worksheet? If yes the result was correct or the same as in VBA?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1484162034, "post_id": 41598731, "comment_id": 70400489, "body": "Do all the values that fall between the two dates also have &quot;TER&quot; in column L?  If so, then obviously the answer will be the same as if you just counted how many rows fall between the two dates.  The answer will only be reduced if you have some non-&quot;TER&quot; values in column L."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7406247, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rfJcr64YdVk/AAAAAAAAAAI/AAAAAAAAQgA/C9ETbZUDQLw/photo.jpg?sz=128", "display_name": "Cilene Gon&#231;alves", "link": "https://stackoverflow.com/users/7406247/cilene-gon%c3%a7alves"}, "is_accepted": false, "score": 0, "last_activity_date": 1534514922, "creation_date": 1534514922, "answer_id": 51897221, "question_id": 41598731, "link": "https://stackoverflow.com/questions/41598731/vba-countifs-ignores-an-argument/51897221#51897221", "title": "VBA CountIfs ignores an argument", "body": "<p>Thanks for helping, everybody.\nMy solution for my counts was doing something else:\nIn a brief, to get the result i wanted, I did some sequential autofilters to the columns, copied the lines affected and counted the number of registers with another command line.</p>\n\n<p>Example:</p>\n\n<pre><code>Selection.AutoFilter\n    ActiveSheet.Range(\"$L$1:$L\" &amp; LR).AutoFilter Field:=27, Criteria1:=CStr(MESRAM)\n    ActiveSheet.Range(\"$AK$1:$AK\" &amp; LR).AutoFilter Field:=28, Criteria1:=CStr(ANORAM)\n    ActiveSheet.Range(\"$AE$1:$AE\" &amp; LR).AutoFilter Field:=29, Criteria1:=CStr(MESRAM)\n\nLR = Cells(Rows.Count, \"A\").End(xlUp).Row\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7406247, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rfJcr64YdVk/AAAAAAAAAAI/AAAAAAAAQgA/C9ETbZUDQLw/photo.jpg?sz=128", "display_name": "Cilene Gon&#231;alves", "link": "https://stackoverflow.com/users/7406247/cilene-gon%c3%a7alves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1534514922, "creation_date": 1484161377, "last_edit_date": 1484162093, "question_id": 41598731, "link": "https://stackoverflow.com/questions/41598731/vba-countifs-ignores-an-argument", "title": "VBA CountIfs ignores an argument", "body": "<p>I am having the following trouble with my <code>Application.WorksheetFunction.CountIfs</code> code bellow.</p>\n\n<p>When I do the countifs making it look and count for the word \"TER\", it works.</p>\n\n<p>When I do the countifs between the dates, it works.</p>\n\n<p>When I put the arguments I said together it just count between the dates, it's like the countifs ignored the argument I want to count the word TER in the column.\nI researched a lot, and couldn't find something that helps. Already tried put two quotes in \"\"TER\"\".</p>\n\n<p>Thank you.</p>\n\n<pre><code>Dim TerminPerio As Integer, IniRAM As Date, FimRAM As Date\nDim NecessTOT As Integer\n\nIniRAM = #12/1/2016#           \nFimRAM = #12/31/2016#\n\nNecessTOT = Application.WorksheetFunction.CountIfs(Range(\"L:L\"), \"TER\", Range(\"I:I\"), \"&gt;=\" &amp; CDbl(IniRAM), Range(\"I:I\"), \"&lt;=\" &amp; CDbl(FimRAM)) \n'NecessTOT = Application.WorksheetFunction.CountIfs(Range(\"L:L\"), \"TER\")\n'NecessTOT = Application.WorksheetFunction.CountIfs(Range(\"I:I\"), \"&gt;=\" &amp; CDbl(IniRAM), Range(\"I:I\"), \"&lt;=\" &amp; CDbl(FimRAM)) \n\nMsgBox (CStr(NecessTOT))\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1486751538, "post_id": 42166274, "comment_id": 71497526, "body": "If this refers to another procedure such as <code>&quot;Textbox_Paste&quot;</code> you may want to include the necessary code from that procedure, too. Otherwise I think this answer would be incomplete."}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1486960460, "post_id": 42166274, "comment_id": 71555411, "body": "@DavidZemens, Added the code to show a message box when Paste is clicked."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1486995537, "post_id": 42166274, "comment_id": 71573642, "body": "Your <code>OnAction</code> statement is calling the <code>&quot;Textbox_Paste&quot;</code> procedure. Where is the code for <code>&quot;Textbox_Paste&quot;</code>?"}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1486996440, "post_id": 42166274, "comment_id": 71574279, "body": "@DavidZemens, I have left it for you to try. :-). I have given enough suggestions in my answer to solve the problem."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1486998309, "post_id": 42166274, "comment_id": 71575571, "body": "You&#39;re explicitly calling a procedure for which you are not providing the code (and is not part of the OP). Either this <code>OnAction</code> is irrelevant, in which case you should omit the statement from your answer, or it is relevant, in which case your answer is incomplete. Further, while your code does provide an active <code>Paste</code> button, it doesn&#39;t actually perform the paste operation, and your solution doesn&#39;t address: <i>do I HAVE to add OnAction and refer to a sub to have it actually paste the text into the textbox or is using the msoControlButton with ID 22 enough?</i>"}, {"owner": {"reputation": 486, "user_id": 6377101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/06cc0df790dd4134fffbd1a86751243a?s=128&d=identicon&r=PG&f=1", "display_name": "anonymous", "link": "https://stackoverflow.com/users/6377101/anonymous"}, "edited": false, "score": 0, "creation_date": 1487024211, "post_id": 42166274, "comment_id": 71590466, "body": "@MukulVarshney thank you for the help. Using your answer and David Zemens&#39; answer has enabled the paste and I can now paste content into the textbox"}], "tags": [], "owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "is_accepted": false, "score": 0, "last_activity_date": 1486753186, "last_edit_date": 1486753186, "creation_date": 1486751307, "answer_id": 42166274, "question_id": 41598179, "link": "https://stackoverflow.com/questions/41598179/trouble-with-vba-right-click-paste/42166274#42166274", "title": "Trouble with VBA Right-Click Paste", "body": "<p>Try below. Paste is enabled for me.</p>\n\n<pre><code>Private WithEvents cmdPasteButton As CommandBarButton\n\nPrivate Sub txtInput_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n    If Button = vbKeyRButton Then\n        Call ShowMenu\n        Application.CommandBars(\"MyMenu\").ShowPopup\n    End If\nEnd Sub\n\nSub ShowMenu()\n\n    'Remove any old instance of MyPopUp\n    On Error Resume Next\n    CommandBars(\"MyMenu\").Delete\n    On Error GoTo 0\n\n    Set cmdPasteButton = CommandBars.Add(Name:=\"MyMenu\", Position:=msoBarPopup).Controls.Add(Type:=msoControlButton, ID:=22)\n    cmdPasteButton.OnAction = \"Textbox_Paste\"\n\nEnd Sub\n\nPrivate Sub cmdPasteButton_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)\n    MsgBox \"hello from cmdPasteButton_Click\"\n    CancelDefault = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 486, "user_id": 6377101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/06cc0df790dd4134fffbd1a86751243a?s=128&d=identicon&r=PG&f=1", "display_name": "anonymous", "link": "https://stackoverflow.com/users/6377101/anonymous"}, "edited": false, "score": 0, "creation_date": 1487024109, "post_id": 42207187, "comment_id": 71590422, "body": "thanks for the <code>txtInput.Paste</code> as it is necessary to paste the content."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 1, "last_activity_date": 1486998314, "creation_date": 1486998314, "answer_id": 42207187, "question_id": 41598179, "link": "https://stackoverflow.com/questions/41598179/trouble-with-vba-right-click-paste/42207187#42207187", "title": "Trouble with VBA Right-Click Paste", "body": "<blockquote>\n  <p>Additional question, once the user can click paste, do I HAVE to add OnAction and refer to a sub to have it actually paste the text into the textbox or is using the msoControlButton with ID 22 enough to indicate the pasting of text?</p>\n</blockquote>\n\n<p>No, you actually don't need to use either, because the <code>ActiveX TextBox</code> class has a <code>Paste</code> method which you can use. So, piggy-backing on @Mukul Varney's answer, within the <code>cmdPasteButton_Click</code> event procedure, you can simply do:</p>\n\n<pre><code>txtInput.Paste\n</code></pre>\n\n<p>And this should paste the clipboard contents at the cursor position in the TextBox.</p>\n\n<pre><code>Private Sub cmdPasteButton_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)\n    txtInput.Paste\n\n    CancelDefault = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 486, "user_id": 6377101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/06cc0df790dd4134fffbd1a86751243a?s=128&d=identicon&r=PG&f=1", "display_name": "anonymous", "link": "https://stackoverflow.com/users/6377101/anonymous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 701, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1486998314, "creation_date": 1484159489, "last_edit_date": 1531164843, "question_id": 41598179, "link": "https://stackoverflow.com/questions/41598179/trouble-with-vba-right-click-paste", "title": "Trouble with VBA Right-Click Paste", "body": "<p>I'm creating a Pop Up Menu to paste into an ActiveX Textbox on an Excel worksheet. The pop up works but the \"Paste\" option is grayed out. </p>\n\n<pre><code>Private Sub txtInput_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n    If Button = vbKeyRButton Then\n        Call ShowMenu\n        Application.CommandBars(\"MyMenu\").ShowPopup\n    End If\nEnd Sub\n\n\n\nSub ShowMenu()\n    'Remove any old instance of MyPopUp\n    On Error Resume Next\n    CommandBars(\"MyMenu\").Delete\n    On Error GoTo 0\n\n    With CommandBars.Add(name:=\"MyMenu\", Position:=msoBarPopup)\n        With .Controls.Add(Type:=msoControlButton, ID:=22)\n            .Enabled = True\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>I added in the <code>.Enabled = True</code> but that did not fix the issue. I'm sure I'm missing something basic. </p>\n\n<p>Additional question, once the user <em>can</em> click paste, do I HAVE to add <code>OnAction</code> and refer to a sub to have it actually paste the text into the textbox or is using the msoControlButton with ID 22 enough to indicate the pasting of text?</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "is_accepted": false, "score": 0, "last_activity_date": 1484159931, "creation_date": 1484159931, "answer_id": 41598304, "question_id": 41598111, "link": "https://stackoverflow.com/questions/41598111/how-to-replace-shiftreturn-with-return-in-a-word-document/41598304#41598304", "title": "How to replace &#39;Shift+Return&#39; with &#39;Return&#39; in a Word Document", "body": "<p>Solved with:</p>\n\n<pre><code>WordBasic.EditReplace Find:=Chr(11), Replace:=\"^p\", Direction:=0, MatchCase:=0, WholeWord:=0, PatternMatch:=0, SoundsLike:=0, ReplaceAll:=1, Format:=0, Wrap:=1\n</code></pre>\n\n<p>or</p>\n\n<pre><code>WordBasic.EditReplace Find:=\"^l\", Replace:=\"^p\", Direction:=0, MatchCase:=0, WholeWord:=0, PatternMatch:=0, SoundsLike:=0, ReplaceAll:=1, Format:=0, Wrap:=1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": true, "score": 0, "last_activity_date": 1484161746, "creation_date": 1484161746, "answer_id": 41598850, "question_id": 41598111, "link": "https://stackoverflow.com/questions/41598111/how-to-replace-shiftreturn-with-return-in-a-word-document/41598850#41598850", "title": "How to replace &#39;Shift+Return&#39; with &#39;Return&#39; in a Word Document", "body": "<p>Just for reference, Word uses only<br>\ncarriage return for \"Paragraph Mark\" (<code>vbCr</code> = <code>Chr(13)</code>, or <code>^p</code> special character)<br>\nand vertical tab for \"Manual Line Break\" (<code>vbVerticalTab</code> = <code>Chr(11)</code>, or <code>^l</code> special character)</p>\n"}], "owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1378, "favorite_count": 0, "accepted_answer_id": 41598850, "answer_count": 2, "score": 0, "last_activity_date": 1484161746, "creation_date": 1484159279, "question_id": 41598111, "link": "https://stackoverflow.com/questions/41598111/how-to-replace-shiftreturn-with-return-in-a-word-document", "title": "How to replace &#39;Shift+Return&#39; with &#39;Return&#39; in a Word Document", "body": "<p>I have a word document with 'Shift+Return' (showed as arrow from top to down and left) instead of 'Return' (end paragraph), so, if I try to justify, I got a wrong formatting.</p>\n\n<p>I've tried to replace with this:</p>\n\n<pre><code>WordBasic.EditReplace Find:=Chr(11), Replace:=vbCrLf, Direction:=0, MatchCase:=0, WholeWord:=0, PatternMatch:=0, SoundsLike:=0, ReplaceAll:=1, Format:=0, Wrap:=1\n</code></pre>\n\n<p>and this:</p>\n\n<pre><code>WordBasic.EditReplace Find:=Chr(11), Replace:=vbNewLine, Direction:=0, MatchCase:=0, WholeWord:=0, PatternMatch:=0, SoundsLike:=0, ReplaceAll:=1, Format:=0, Wrap:=1\n</code></pre>\n\n<p>but I get a \"square\" as first char of the new line.</p>\n\n<p>What is wrong in my code?</p>\n"}, {"tags": ["excel", "vba", "unicode"], "comments": [{"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1484159206, "post_id": 41597949, "comment_id": 70398927, "body": "You don&#39;t have to start MS Internet Explorer to do this. You can make the HTTP request directly in VBA, google for &quot;VBA HTTP Request&quot;, you should get many examples."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1484159390, "post_id": 41597949, "comment_id": 70399018, "body": "Does <a href=\"http://stackoverflow.com/a/16798887/4650297\">this SO thread/answer</a> do the trick?  It may, if hiragana, katakana, kanji are all non-Latin characters."}, {"owner": {"reputation": 73, "user_id": 6934685, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9b6b66466fb5d172d5af22afd00257e8?s=128&d=identicon&r=PG&f=1", "display_name": "awsmagala", "link": "https://stackoverflow.com/users/6934685/awsmagala"}, "edited": false, "score": 0, "creation_date": 1484159821, "post_id": 41597949, "comment_id": 70399280, "body": "I am already using a version of this code that runs smoother IsAlpha does the same thing but doesn&#39;t generate overflow errors like the IsLatin function does.  The problem with this however is some cells will have latin and non latin characters mixed ex &quot;\u30b8\u30e3\u30ac\u30a4\u30e2\u306f10g / m2&quot; could be in a cell and would then be skipped. I should say I want my function to look at each piece of the string and see if it is Japanese or not."}, {"owner": {"reputation": 73, "user_id": 6934685, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9b6b66466fb5d172d5af22afd00257e8?s=128&d=identicon&r=PG&f=1", "display_name": "awsmagala", "link": "https://stackoverflow.com/users/6934685/awsmagala"}, "edited": false, "score": 0, "creation_date": 1484159918, "post_id": 41597949, "comment_id": 70399346, "body": "Wernfried Domsheit thank you for that suggestion.  That is something I will have to look into in the future."}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1484160749, "post_id": 41597949, "comment_id": 70399803, "body": "Also give free translator service a try, e.g. <a href=\"http://www.frengly.com/api\" rel=\"nofollow noreferrer\">frengly.com/api</a> They could be even easier to use."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 6934685, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9b6b66466fb5d172d5af22afd00257e8?s=128&d=identicon&r=PG&f=1", "display_name": "awsmagala", "link": "https://stackoverflow.com/users/6934685/awsmagala"}, "edited": false, "score": 0, "creation_date": 1484163675, "post_id": 41598868, "comment_id": 70401395, "body": "So this helps avoid some of the translation mistakes that occur but it is not perfect. would it be possible to lets say set up a dictionary of all possible hiragana, katakana, and kanji (this dictionary would then contain like 2500 elements) and see if any part of the string is in that dictionary? or some other structure again I&#39;m not to savy on these things."}, {"owner": {"reputation": 73, "user_id": 6934685, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9b6b66466fb5d172d5af22afd00257e8?s=128&d=identicon&r=PG&f=1", "display_name": "awsmagala", "link": "https://stackoverflow.com/users/6934685/awsmagala"}, "edited": false, "score": 0, "creation_date": 1484163826, "post_id": 41598868, "comment_id": 70401479, "body": "like set up an excel sheet with all of them inside and use the Find function or something?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 73, "user_id": 6934685, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9b6b66466fb5d172d5af22afd00257e8?s=128&d=identicon&r=PG&f=1", "display_name": "awsmagala", "link": "https://stackoverflow.com/users/6934685/awsmagala"}, "edited": false, "score": 0, "creation_date": 1484164312, "post_id": 41598868, "comment_id": 70401753, "body": "Can you perhaps post some samples of your cells? What isn&#39;t the function catching? Are hiragana, katakana, and kanji characters that <i>are</i> being read as Latin?  ...And I suppose yes, if you do have a list of characters, we can always just loop through that list and see if any character in the <code>myString</code> matches a character in that array."}, {"owner": {"reputation": 73, "user_id": 6934685, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9b6b66466fb5d172d5af22afd00257e8?s=128&d=identicon&r=PG&f=1", "display_name": "awsmagala", "link": "https://stackoverflow.com/users/6934685/awsmagala"}, "edited": false, "score": 0, "creation_date": 1484164545, "post_id": 41598868, "comment_id": 70401875, "body": "\u5bb9\u91cfup  Ns91 (a \u51e6\u7406) are some examples of cells the code isn&#39;t catching but the code will catch other cells with latin characters.  I think its the spacing of characters and may also be something on googles end I have not tested yet to see if kanji will show up in the translated text box before it gets translated"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1484161798, "creation_date": 1484161798, "answer_id": 41598868, "question_id": 41597949, "link": "https://stackoverflow.com/questions/41597949/how-to-check-if-a-string-or-cell-has-kajji-characters-inside-it/41598868#41598868", "title": "How to check if a string (or cell) has kajji characters inside it?", "body": "<p>This sub, borrowed heavily from the answer I linked to, can determine if a string has any latin characters:</p>\n\n<pre><code>Sub t()\nDim k       As Long\nDim myString As String\nmyString = Range(\"Z1\").Value  'Edit this as needed\nDim latinChars As Long\n\nlatinChars = 0\nFor k = 1 To Len(myString)\n    If IsLatin(Mid(myString, k, 1)) Then\n        ' Has latin characters\n        latinChars = latinChars + 1\n    End If\nNext k\n\nIf latinChars = 0 Then\n    ' Doesn't have latin characters\n    Debug.Print \"Doesn't have latin characters\"\nElse\n    ' Has latin characters\n    Debug.Print \"Has latin characters\"\nEnd If\n\nEnd Sub\n\nFunction IsLatin(Str As String) As Boolean\nIsLatin = True\nFor i = 1 To Len(Str)\nIsLatin = IsLatin And Abs(AscW(Mid(Str, i, 1)) - 64) &lt; 64\nNext i\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 6934685, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9b6b66466fb5d172d5af22afd00257e8?s=128&d=identicon&r=PG&f=1", "display_name": "awsmagala", "link": "https://stackoverflow.com/users/6934685/awsmagala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1295, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1547682070, "creation_date": 1484158735, "last_edit_date": 1547682070, "question_id": 41597949, "link": "https://stackoverflow.com/questions/41597949/how-to-check-if-a-string-or-cell-has-kajji-characters-inside-it", "title": "How to check if a string (or cell) has kajji characters inside it?", "body": "<p>I work for a Japanese company.  As such a majority of the excel tables sent to me are in mostly Japanese.  So I have created an excel macro that prompts the user to select a range of cells they want translated.  The macro loops through the range of cells grabbing the cell value, copying it into the Google Translate Text Box, waits for the translation, copies the translation, and sets the cells value to the translation.  </p>\n\n<p>Now all of this is working and I can translate any range I throw at it.  The issue I am having is the amount of time it takes to translate a document.  I have done everything I can with speeding up the connection to google.  The next thing I see slowing the macro down is the fact I cannot figure out a simple way to determine if a cell contains any Japanese (hiragana, katakana, kanji).  So I am looking for a function that essentially does this:</p>\n\n<pre><code>Function isJapanese(cell as Range)\n     If cell.Value is Japanese Then\n            isJapanese = True\n     Else\n            isJapanese = False\n     End If\nEnd Function\n</code></pre>\n\n<p>I am already checking if the string contains latin letters or not (which is making it skip some cells), certain symbols, and any other character or string I can think of that is unique to only English cells.</p>\n\n<p>Below is the code I have so far (I am using a user form to get the variables for the translation function)</p>\n\n<pre><code>Function Translate_Range(rng As String, in_exp As String, out_exp As String) As Boolean\nDim japCheck As Boolean, japCount As Integer, cellAddress As String, transText As String, langDesired As String, wkb As String, sht As String, searchRange As Range, doneCheck As Boolean\ndoneCheck = False\nwkb = ActiveWorkbook.Name\nsht = ActiveSheet.Name\nWorkbooks(wkb).Worksheets(sht).Activate\njapCount = 0\njapCheck = True\nSet searchRange = Range(rng)\nFor Each cell In searchRange\n    If cell.Value &lt;&gt; \"\" And InStr(cell.Text, \"mm\") = 0 And InStr(cell.Text, \"\u00b1\") = 0 Then\n        japCheck = IsAlpha(cell.Text)\n        If japCheck = True Then\n            GoTo NextIteration\n        Else\n            transText = translate_string(cell.Address, in_exp, out_exp)\n            ActiveSheet.Range(cell.Address).Value = transText\n        End If\n    End If\nNextIteration:\n    Next\n    doneCheck = True\n    Translate_Range = doneCheck\nEnd Function\n\nPrivate Function translate_string(cell As String, input_exp As String,  output_exp As String)\nDim str As String\nstr = ActiveSheet.Range(cell).Value\nSet IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = False\nIE.navigate \"http://translate.google.com/#\" &amp; input_exp &amp; \"/\" &amp; output_exp &amp; \"/\" &amp; str\n    Do Until IE.readyState = 4\n        DoEvents\n    Loop\nDo Until result_data &lt;&gt; \"\"\n    CLEAN_DATA = Split(Application.WorksheetFunction.Substitute(IE.Document.getElementById(\"result_box\").innerHTML, \"&lt;/SPAN&gt;\", \"\"), \"&lt;\")\n    For i = LBound(CLEAN_DATA) To UBound(CLEAN_DATA)\n        result_data = result_data &amp; Right(CLEAN_DATA(i), Len(CLEAN_DATA(i)) - InStr(CLEAN_DATA(i), \"&gt;\"))\n    Next\nLoop\nIE.Quit\ntranslate_string = result_data\nEnd Function\n\nPrivate Function IsAlpha(strValue As String) As Boolean\n    IsAlpha = strValue Like WorksheetFunction.Rept(\"[a-zA-Z]\", Len(strValue))\nEnd Function\n</code></pre>\n\n<p>I feel like there has to be a Unicode protocol for kanji characters.  I am just woefully inexperienced when it comes to things like this (I am a mechanical engineer who makes excel macros to make my life easier, so my knowledge of technical programming topics like this is lacking sorry)</p>\n"}, {"tags": ["excel", "vba", "controls"], "comments": [{"owner": {"reputation": 73, "user_id": 5758552, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/35cb16b9938f683df5510b698de00fb2?s=128&d=identicon&r=PG&f=1", "display_name": "Tom C.", "link": "https://stackoverflow.com/users/5758552/tom-c"}, "edited": false, "score": 0, "creation_date": 1484161936, "post_id": 41597666, "comment_id": 70400433, "body": "I forgot to add, this listbox is on a spreadsheet, not inside a Userform."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7406249, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d22294f1c01cc411d421cc8cdb809edb?s=128&d=identicon&r=PG", "display_name": "user7406249", "link": "https://stackoverflow.com/users/7406249/user7406249"}, "is_accepted": false, "score": 0, "last_activity_date": 1484160089, "creation_date": 1484160089, "answer_id": 41598349, "question_id": 41597666, "link": "https://stackoverflow.com/questions/41597666/excel-vba-form-control-listbox-with-multi-columns-how-to-populate-from-ado-r/41598349#41598349", "title": "Excel VBA: form control listbox with multi-columns -- how to populate from ADO recordset?", "body": "<p>No idea if Form control can support muticolumns like the ActiveX list box so you might need to consider adding  them in differently..</p>\n\n<p>Below is an example of how to remove all/add items, hope it helps:</p>\n\n<pre><code>'to remove all previous items\nMe.Shapes(\"lst_System\").ControlFormat.RemoveAllItems\n'to add item\nMe.Shapes(\"lst_System\").ControlFormat.AddItem \"SomeStringValue\"\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 5758552, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/35cb16b9938f683df5510b698de00fb2?s=128&d=identicon&r=PG&f=1", "display_name": "Tom C.", "link": "https://stackoverflow.com/users/5758552/tom-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 846, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1484160089, "creation_date": 1484157709, "question_id": 41597666, "link": "https://stackoverflow.com/questions/41597666/excel-vba-form-control-listbox-with-multi-columns-how-to-populate-from-ado-r", "title": "Excel VBA: form control listbox with multi-columns -- how to populate from ADO recordset?", "body": "<p>Due to compatibility issues, I am having to use an Excel <strong>form control listbox</strong> (vs. ActiveX) control on my spreadsheet. I am trying to populate it with three fields from an ADO recordset, but I am having problems as it has been sometime since I have used Form Controls. </p>\n\n<p>Here is the code I wrote for my ActiveX listbox. Can you point me to an example of where a form control listbox with multiple columns is populated from an ADO recordset?</p>\n\n<p>Thanks ahead of time for any help you can provide in making this conversion!</p>\n\n<p>-- Tom</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n On Error GoTo Err_Worksheet_Activate\n Dim cnn As ADODB.Connection\n Dim rst As ADODB.Recordset\n Dim i As Integer\n\n     Set cnn = New ADODB.Connection\n\n     cnn.ConnectionString = gcstr_Connection ' a global property with the connection string defined elsewhere. The connection is to a SQL Server database.\n\n      cnn.Open\n\n      Set rst = cnn.Execute(\"SELECT [FieldA], [FieldB], [FieldC] FROM dbo.\", , adCmdText)\n\n      rst.MoveFirst\n\n      With Me.lst_System\n          .Clear\n          Do\n          .AddItem\n          .List(i, 0) = rst![FieldA]\n          .List(i, 1) = rst![FieldB]\n          .List(i, 2) = rst![FieldC]\n          i = i + 1\n              rst.MoveNext\n          Loop Until rst.EOF\n      End With\n\n Exit_Worksheet_Activate:\n      On Error Resume Next\n      rst.Close\n      cnn.Close\n      Set rst = Nothing\n      Set cnn = Nothing\n      Exit Sub\n\n Err_Worksheet_Activate:\n      MsgBox Err.Number &amp; vbCrLf &amp; Err.Description, vbCritical, \"Error!\"\n      Err.Clear\n      Resume Exit_Worksheet_Activate\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1484156654, "post_id": 41597338, "comment_id": 70397583, "body": "what error? Typemismatch?"}, {"owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1484156770, "post_id": 41597338, "comment_id": 70397658, "body": "I&#39;m not sure why I receive a syntax error?  The dates of 2017 are listed in row 10, I would like the macro to open the workbook and open to the cell of today&#39;s date.  I have tried several different macros without success."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484156847, "post_id": 41597338, "comment_id": 70397701, "body": "ah, because of magic quotes.. see the updated code as edited by @ShaiRado. Use <code>&quot;</code> instead of  <code>\u201c</code>"}, {"owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1484156953, "post_id": 41597338, "comment_id": 70397771, "body": "Thank you, but now I am receiving a &quot;runtime error9 - Subcript out of range&quot;."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1484157105, "post_id": 41597338, "comment_id": 70397850, "body": "You are using <code>Activate</code> before confirming <code>Find</code> has found something.  You are looking for the string x.  Are the values in row 10 strings?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1484157278, "post_id": 41597338, "comment_id": 70397941, "body": "Do not used <code>On Error Resume Next</code> like this.  It means don&#39;t bother me with errors.  It should only be used so:  <code>On Error Resume Next</code> <code>Statement that might fail for external reasons</code> <code>On Error Goto 0</code> <code>Check for errors</code>."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1484157352, "post_id": 41597338, "comment_id": 70397984, "body": "Did you mean to write <code>Set wb = Workbooks.Open(&quot;2017 Capacity Planner.xlsm&quot;)</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1484158340, "post_id": 41597603, "comment_id": 70398499, "body": "Why do u need to select the worksheet before the .Find ? Maybe add a MsgBox if the date is not found ?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484158505, "post_id": 41597603, "comment_id": 70398574, "body": "agreed, didn&#39;t change that part just copied OP&#39;s code and made few changes but sure that part is redundant."}, {"owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "edited": false, "score": 0, "creation_date": 1484158950, "post_id": 41597603, "comment_id": 70398796, "body": "That works great after adding the .Open to the line Set wb.  Thank you all for your help.  Very much appreciated."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 3, "last_activity_date": 1484157467, "creation_date": 1484157467, "answer_id": 41597603, "question_id": 41597338, "link": "https://stackoverflow.com/questions/41597338/what-update-will-open-my-workbook-to-todays-date/41597603#41597603", "title": "What update will open my workbook to today&#39;s date?", "body": "<p>You are still using magic quotes. Even if you remove that you will Error 438 on the line .Row(10). Then on the find another error is waiting when nothing is found.Change your code like this :</p>\n\n<pre><code>Sub test()\n\n    Dim rng As Range\n    Dim x As String\n\n    Dim wb As Workbook, wb1 As Workbook\n    Dim LastRow As Long\n\n    Set wb = Workbooks(\"2017 Capacity Planner.xlsm\")\n\n    Worksheets(\"Dashboard\").Select\n    x = (Format(Date, \"Short Date\"))\n\n    Set rng = Worksheets(\"Dashboard\").Rows(10).Find(What:=x, LookIn:=xlValues)\n\n    If Not rng Is Nothing Then\n        rng.Parent.Activate\n        rng.Select\n    End If\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 41597603, "answer_count": 1, "score": 0, "last_activity_date": 1484157467, "creation_date": 1484156492, "last_edit_date": 1484156647, "question_id": 41597338, "link": "https://stackoverflow.com/questions/41597338/what-update-will-open-my-workbook-to-todays-date", "title": "What update will open my workbook to today&#39;s date?", "body": "<p>I would like my workbook to open on the cell of today's date.  The dates of 2017 are listed in row 10.  My macro is listed below but contains a syntax error on the line\n'x = Format(Date, \"Short Date\")'</p>\n\n<pre><code>Private Sub Workbook_OpenDate()\n\n    Dim wb As Workbook, wb1 As Workbook\n    Dim LastRow As Long\n\n    Set wb = Workbooks(\"2017 Capacity Planner.xlsm\")\n\n    Worksheets(\"Dashboard\").Select\n    x = Format(Date, \"Short Date\")\n\n    On Error Resume Next\n    Worksheets(\u201cDashboard\u201d).Row(10).Find(What:=x, LookIn:=xlValues).Activate\n    Application.Goto Selection, True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "64-bit", "ms-office", "userform"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6163255, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7a0e6d36b54662a468b94438f073400d?s=128&d=identicon&r=PG&f=1", "display_name": "bleeetiso", "link": "https://stackoverflow.com/users/6163255/bleeetiso"}, "edited": false, "score": 0, "creation_date": 1484165997, "post_id": 41597616, "comment_id": 70402705, "body": "Yes I disabled macros and entered the file but I don&#39;t see any missing references"}, {"owner": {"reputation": 21, "user_id": 6163255, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7a0e6d36b54662a468b94438f073400d?s=128&d=identicon&r=PG&f=1", "display_name": "bleeetiso", "link": "https://stackoverflow.com/users/6163255/bleeetiso"}, "edited": false, "score": 0, "creation_date": 1484167194, "post_id": 41597616, "comment_id": 70403311, "body": "I checked the userform and there seems to be  empty spaces where the date boxes are supposed to be."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "reply_to_user": {"reputation": 21, "user_id": 6163255, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7a0e6d36b54662a468b94438f073400d?s=128&d=identicon&r=PG&f=1", "display_name": "bleeetiso", "link": "https://stackoverflow.com/users/6163255/bleeetiso"}, "edited": false, "score": 0, "creation_date": 1484326167, "post_id": 41597616, "comment_id": 70478877, "body": "If those are date time picker boxes then you&#39;ll have to re-create them yourself. LIke this one: <a href=\"https://sites.google.com/site/e90e50/calendar-control-class\" rel=\"nofollow noreferrer\">sites.google.com/site/e90e50/calendar-control-class</a>"}], "tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": true, "score": 0, "last_activity_date": 1484157498, "creation_date": 1484157498, "answer_id": 41597616, "question_id": 41596987, "link": "https://stackoverflow.com/questions/41596987/excel-2010-microsoft-forms-error-could-not-load-some-objects-because-they-are-no/41597616#41597616", "title": "Excel 2010 Microsoft forms error Could not load some objects because they are not available on this machine", "body": "<p>Normally you should be able to open the file even though it generates a compile error. Can you open the file with macro's disabled? (just rename the file so Excel does not know you opened it before)</p>\n\n<p>If so, then go to the VBA editor and check Tools, References. Note the ones markes MISSING. I bet one is something like \"Common Controls\". If you open the userforms you should have some empty spaces where a control used to be, those are the incompatible ones.</p>\n"}], "owner": {"reputation": 21, "user_id": 6163255, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7a0e6d36b54662a468b94438f073400d?s=128&d=identicon&r=PG&f=1", "display_name": "bleeetiso", "link": "https://stackoverflow.com/users/6163255/bleeetiso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7835, "favorite_count": 0, "accepted_answer_id": 41597616, "answer_count": 1, "score": 0, "last_activity_date": 1531321822, "creation_date": 1484155403, "last_edit_date": 1531321822, "question_id": 41596987, "link": "https://stackoverflow.com/questions/41596987/excel-2010-microsoft-forms-error-could-not-load-some-objects-because-they-are-no", "title": "Excel 2010 Microsoft forms error Could not load some objects because they are not available on this machine", "body": "<p>I have office 2010 64 bit and I am trying to open a excel file with a userform in it that was made in office 32 bit. I get this error \"Excel 2010 Microsoft forms error Could not load some objects because they are not available on this machine\". then the files closes</p>\n\n<p>When I click the help button it says \"Compile error in hidden module: module name \"</p>\n\n<p>Is there there a way I can fix this so that I can open this file or files like this if this is a common issue? </p>\n\n<p>thanks </p>\n"}, {"tags": ["vba", "forms", "ms-access", "unsafe"], "comments": [{"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1484164749, "post_id": 41596966, "comment_id": 70401980, "body": "You are making a few false assumptions. First of all you database does have modules. The moment a single event in a single form is scripted, a module for that form is generated. Second, and most importantly, you are taking the words &quot;unsafe content&quot; seriously. For MS Access every little bit of VBA code is &quot;unsafe&quot;. This is meant to protect from opening a random file you downloaded from the Internet or got in an email. For a file that was developed in house it is not only safe but it is essential to allow VBA to run unhindered."}, {"owner": {"reputation": 858, "user_id": 1907723, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ad79171d1a70ac1b069c163ad3f615a1?s=128&d=identicon&r=PG", "display_name": "fakemeta", "link": "https://stackoverflow.com/users/1907723/fakemeta"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1484167419, "post_id": 41596966, "comment_id": 70403450, "body": "@SunKnight0 I didn&#39;t mean my database has no modules. I meant I didn&#39;t develop any of those. And you are right, there&#39;s nothing wrong with allowing Access to run unsafe code in this file, and I understand what &quot;unsafe&quot; means. There might be cases when new users on their fresh installed Windows double-click the .accdb file accidentally without allowing unsafe content first, and it breaks my program. In this cases I will have to give them a fresh copy of the project. That&#39;s the problem for me."}, {"owner": {"reputation": 858, "user_id": 1907723, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ad79171d1a70ac1b069c163ad3f615a1?s=128&d=identicon&r=PG", "display_name": "fakemeta", "link": "https://stackoverflow.com/users/1907723/fakemeta"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1484167528, "post_id": 41596966, "comment_id": 70403501, "body": "@SunKnight0 To be more clear - usually when user runs new .accdb file with macros there will be errors during start up (stuff about unsafe actions in macros etc) and &quot;Enable content&quot; button appears. When user clicks the button, the program restarts without any macro errors and works fine. But in my case the program restarts with corruptions and I can&#39;t revert these corruptions."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1484167655, "post_id": 41596966, "comment_id": 70403558, "body": "That&#39;s pretty weird. Is it a single file or does it link to external data? If it does and depending on how the external data is linked, it could explain why it &quot;breaks&quot;. If you are on a Windows domain environment you can set access to always run &quot;unsafe&quot; content via group policy. Doesn&#39;t explain why it happens but it does bypass the problem."}, {"owner": {"reputation": 858, "user_id": 1907723, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ad79171d1a70ac1b069c163ad3f615a1?s=128&d=identicon&r=PG", "display_name": "fakemeta", "link": "https://stackoverflow.com/users/1907723/fakemeta"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1484167695, "post_id": 41596966, "comment_id": 70403579, "body": "@SunKnight0 Yes, it&#39;s a single file."}, {"owner": {"reputation": 858, "user_id": 1907723, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ad79171d1a70ac1b069c163ad3f615a1?s=128&d=identicon&r=PG", "display_name": "fakemeta", "link": "https://stackoverflow.com/users/1907723/fakemeta"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1484167773, "post_id": 41596966, "comment_id": 70403626, "body": "@SunKnight0 Maybe MS Access automatically removes some parts of code it considers unsafe during the start up without unsafe content enabled?"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1484167792, "post_id": 41596966, "comment_id": 70403636, "body": "Sorry was editing. See my group policy suggestion. As to why it breaks, look for any startup macro or code or OnOpen/OnLoad code in the startup form."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1484167920, "post_id": 41596966, "comment_id": 70403702, "body": "I have never seen MS Access permanently remove code."}, {"owner": {"reputation": 858, "user_id": 1907723, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ad79171d1a70ac1b069c163ad3f615a1?s=128&d=identicon&r=PG", "display_name": "fakemeta", "link": "https://stackoverflow.com/users/1907723/fakemeta"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1484168186, "post_id": 41596966, "comment_id": 70403815, "body": "@SunKnight0 Well, changing group policies is just an another way to bypass this bug. But in my case I really need to fix it to prevent stupid situations. 20 minutes ago a user came and asked for another copy of this program because he moved .accdb to another folder and forgot to add it to trusted location before running."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1484168419, "post_id": 41596966, "comment_id": 70403922, "body": "Sure but it bypasses it permanently. Anyway without actually looking at the file I can&#39;t even begin to guess why it actually breaks. Try disabling the startup form/macro and open it and see if that will break it as well."}, {"owner": {"reputation": 858, "user_id": 1907723, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ad79171d1a70ac1b069c163ad3f615a1?s=128&d=identicon&r=PG", "display_name": "fakemeta", "link": "https://stackoverflow.com/users/1907723/fakemeta"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1484168436, "post_id": 41596966, "comment_id": 70403932, "body": "@SunKnight0 I updated my question."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1484168634, "post_id": 41596966, "comment_id": 70404034, "body": "Based on the update it seems your problem is definitely code that runs but not fully (for example your end code runs but your startup code does not). In addition to disabling any macros you would have to also disable any <code>OnOpen</code>, <code>OnCurrent</code>, <code>OnLoad</code> and <code>OnClose</code> VBA code (and probably more that I am missing) for any form/subform that may be activated, in order to troubleshoot."}, {"owner": {"reputation": 858, "user_id": 1907723, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ad79171d1a70ac1b069c163ad3f615a1?s=128&d=identicon&r=PG", "display_name": "fakemeta", "link": "https://stackoverflow.com/users/1907723/fakemeta"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1484169163, "post_id": 41596966, "comment_id": 70404335, "body": "@SunKnight0 Yes, I thinks that&#39;s a good idea. I will check it tomorrow and tell you the results."}, {"owner": {"reputation": 858, "user_id": 1907723, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ad79171d1a70ac1b069c163ad3f615a1?s=128&d=identicon&r=PG", "display_name": "fakemeta", "link": "https://stackoverflow.com/users/1907723/fakemeta"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1484337182, "post_id": 41596966, "comment_id": 70484669, "body": "@SunKnight0 I removed ALL VBA code from my startup form and it didn&#39;t help. But I&#39;ve found a solution and posted it as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 858, "user_id": 1907723, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ad79171d1a70ac1b069c163ad3f615a1?s=128&d=identicon&r=PG", "display_name": "fakemeta", "link": "https://stackoverflow.com/users/1907723/fakemeta"}, "is_accepted": true, "score": 0, "last_activity_date": 1484337076, "creation_date": 1484337076, "answer_id": 41642436, "question_id": 41596966, "link": "https://stackoverflow.com/questions/41596966/ms-access-form-gets-broken-after-enabling-unsafe-content/41642436#41642436", "title": "MS Access form gets broken after enabling unsafe content", "body": "<p>I've ran into some more weird problems and while debugging them found out that there are some MS Office 2000 footprints on the system. I decided to uninstall MS Office, clean Windows registry and install MS Office again. This solved all my problems.</p>\n"}], "owner": {"reputation": 858, "user_id": 1907723, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ad79171d1a70ac1b069c163ad3f615a1?s=128&d=identicon&r=PG", "display_name": "fakemeta", "link": "https://stackoverflow.com/users/1907723/fakemeta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 41642436, "answer_count": 1, "score": 0, "last_activity_date": 1502354268, "creation_date": 1484155356, "last_edit_date": 1502354268, "question_id": 41596966, "link": "https://stackoverflow.com/questions/41596966/ms-access-form-gets-broken-after-enabling-unsafe-content", "title": "MS Access form gets broken after enabling unsafe content", "body": "<p>I have a MS Access project, which was developed in MS Access 97. I successfully converted it to MS Access 2016 (that was a long story tho). Everything looks fine, but I have noticed a very strange behavior.</p>\n\n<p>When user opens the project file in client mode for the first time, a lot of macro errors pop up. This is a normal thing, because user has not yet allowed unsafe content in this file. So, after user has closed all the errors, he presses \"Allow unsafe content\" button and closes the file. Now user opens the project again and it is not working properly. Some forms are invoked that should'nt be invoked and \"Module not found\" error pops up. I didn't develop any modules for this program. So, it means that if user opens the file without allowing unsafe content first, the project gets totally messed up and it's impossible to recover unless you replace the file with a fresh copy.</p>\n\n<p>However, if user has a fresh copy of project .accdb file, and the file is located in trusted location, everything works fine. Another way to make project run properly without putting it to trusted location is to open it while holding shift key first and pressing \"Allow unsafe content\" button. Then user can normally run file with double-click and it works like it should.</p>\n\n<p>So, <strong>opening this file without allowing unsafe content first breaks the project</strong>. I've also tried to open VBA code of the form, which is invoked by default and the VBA code windows looks frozen. Other forms are working fine. <a href=\"https://i.stack.imgur.com/9k0XO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9k0XO.png\" alt=\"enter image description here\"></a></p>\n\n<p>How can I debug this problem?</p>\n\n<p><strong>UPD:</strong> It really looks like the problem is caused by attempting to run macros while unsafe content is not enabled. </p>\n\n<p><strong>UPD:</strong> I noticed one more thing - if I run the project without allowing unsafe content first, but I don't press \"allow content\", and just close the program - I'm still able to run it from trusted location. So the corruption happens only after I press \"enable content\" button. My form has macro with OnClose action attached. But I tried to remove all the macros from this form and it didn't help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1484154948, "post_id": 41596754, "comment_id": 70396471, "body": "Why not use getters and setters? See the answer to <a href=\"http://stackoverflow.com/questions/29257127/vba-complicated-getter-setter-syntax\">this</a> question."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1484155652, "post_id": 41596754, "comment_id": 70396917, "body": "is <code>frmSettingsSetup</code> open when you are initializing the other form? if not then it wont get any value as there is none. Forms are Classes, show if its not open, there&#39;s no instance value to get."}, {"owner": {"reputation": 57, "user_id": 5087327, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42cff3b796b2209e2f659f8c5e09f6dc?s=128&d=identicon&r=PG&f=1", "display_name": "Wally", "link": "https://stackoverflow.com/users/5087327/wally"}, "edited": false, "score": 0, "creation_date": 1484156800, "post_id": 41596754, "comment_id": 70397680, "body": "frmSettingsSetup is hidden but not closed <code>frmSettingsSetup.Hide</code> when I initialize the other form."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1484157583, "post_id": 41596754, "comment_id": 70398107, "body": "just put <code>msgbox frmSettingsSetup.g1</code> in the initialize and see what value comes back."}, {"owner": {"reputation": 57, "user_id": 5087327, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42cff3b796b2209e2f659f8c5e09f6dc?s=128&d=identicon&r=PG&f=1", "display_name": "Wally", "link": "https://stackoverflow.com/users/5087327/wally"}, "edited": false, "score": 0, "creation_date": 1484159167, "post_id": 41596754, "comment_id": 70398905, "body": "When I add that code the message box returns the correct value. I can Create a Variable and it assigns the correct value to a variable, but when I attempt to fill an array as I did above each item is left blank."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1484159752, "post_id": 41596754, "comment_id": 70399234, "body": "How / when are you looking to see what values have been placed in <code>targetGrades(1)</code> - are you looking in the <code>Watch</code> window while stepping through the code, or are you looking at the value when used somehow in some other piece of code.  (Remember that you have defined <code>targetGrades</code> to only be in scope within <code>UserForm_Initialize</code>, so that array will not be available outside that subroutine.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1484159898, "post_id": 41596754, "comment_id": 70399332, "body": "You also say in your question &quot;the variables are = &quot;&quot; as are the Public variables being pulled from frmSettingsSetup (g1-g5).&quot; but an earlier comment says &quot;When I add that code the message box returns the correct value.&quot; - those statements seem to be contradictory."}, {"owner": {"reputation": 57, "user_id": 5087327, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42cff3b796b2209e2f659f8c5e09f6dc?s=128&d=identicon&r=PG&f=1", "display_name": "Wally", "link": "https://stackoverflow.com/users/5087327/wally"}, "edited": false, "score": 0, "creation_date": 1484160502, "post_id": 41596754, "comment_id": 70399667, "body": "I am calling it in a function that is being called within the subroutine.  I Attempted to move the array out of the function and it is working just fine. Is it possible to use an array called in a subroutine within a function called within the same subroutine?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1484163494, "post_id": 41596754, "comment_id": 70401292, "body": "If you want a variable to be accessible to all functions/subroutines within a module, you should declare the variable prior to the first function/subroutine in that module.  If you declare it using <code>Dim</code> (or <code>Private</code>) it will be accessible to all functions/subroutines within that module, but not to other modules.  If you declare it using <code>Public</code> it will be accessible to other modules in your project as well."}, {"owner": {"reputation": 57, "user_id": 5087327, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42cff3b796b2209e2f659f8c5e09f6dc?s=128&d=identicon&r=PG&f=1", "display_name": "Wally", "link": "https://stackoverflow.com/users/5087327/wally"}, "edited": false, "score": 0, "creation_date": 1484236577, "post_id": 41596754, "comment_id": 70436494, "body": "Thank you, To resolve this I created a Module called Globals and declared my global variables there. This makes it possible to access the variable regardless of form status."}], "answers": [{"tags": [], "owner": {"reputation": 57, "user_id": 5087327, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42cff3b796b2209e2f659f8c5e09f6dc?s=128&d=identicon&r=PG&f=1", "display_name": "Wally", "link": "https://stackoverflow.com/users/5087327/wally"}, "is_accepted": false, "score": 0, "last_activity_date": 1484236626, "creation_date": 1484236626, "answer_id": 41617635, "question_id": 41596754, "link": "https://stackoverflow.com/questions/41596754/setting-a-local-variable-from-a-publicvariable-on-another-form-during-form-initi/41617635#41617635", "title": "Setting a local Variable from a publicvariable on another form during form initialization", "body": "<p>To resolve this I created a Module called Globals and declared my global variables there. This makes it possible to access the variable regardless of form status.</p>\n"}], "owner": {"reputation": 57, "user_id": 5087327, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42cff3b796b2209e2f659f8c5e09f6dc?s=128&d=identicon&r=PG&f=1", "display_name": "Wally", "link": "https://stackoverflow.com/users/5087327/wally"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484236626, "creation_date": 1484154663, "question_id": 41596754, "link": "https://stackoverflow.com/questions/41596754/setting-a-local-variable-from-a-publicvariable-on-another-form-during-form-initi", "title": "Setting a local Variable from a publicvariable on another form during form initialization", "body": "<p>I am attempting to set an array during user form initialization. I am filling the array with Public variables created on another user form. The issue is, when I attempt to set the values in the array during form initialization they do not populate. If I use the same code with a button click it works like a charm. </p>\n\n<p>The Code</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n'Declare local Variables\nDim targetGrades(1 To 5) As String\n'Set Variables\ntargetGrades(1) = frmSettingsSetup.g1\ntargetGrades(2) = frmSettingsSetup.g2\ntargetGrades(3) = frmSettingsSetup.g3\ntargetGrades(4) = frmSettingsSetup.g4\ntargetGrades(5) = frmSettingsSetup.g5\n\nEnd Sub\n</code></pre>\n\n<p>When I run the code the variables are = \"\" as are the Public variables being pulled from frmSettingsSetup (g1-g5). Is there a way to call variables from another form during form initialization?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 2, "last_activity_date": 1484154814, "creation_date": 1484154814, "answer_id": 41596807, "question_id": 41596651, "link": "https://stackoverflow.com/questions/41596651/how-to-save-worksheet-in-a-specific-folder-with-a-specific-name-using-vba/41596807#41596807", "title": "How to save worksheet in a specific folder with a specific name using vba?", "body": "<ol>\n<li>Username : Environ(\"UserName\") </li>\n<li><p>Date : Format(Date, \"ddmmyy\")</p>\n\n<pre><code>Dim InitialName As String\nDim sFileSaveName As Variant\n\nInitialName = \"C:\\temp\\\" &amp; Environ(\"UserName\") &amp; Space(1) &amp; Format(Date, \"ddmmyy\")\n\nsFileSaveName = Application.GetSaveAsFilename(InitialFileName:=InitialName, fileFilter:=\"Excel Files (*.xlsm), *.xlsm\")\nIf sFileSaveName &lt;&gt; False Then\n    ActiveWorkbook.SaveAs sFileSaveName\nEnd If\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 7214470, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1346693875362217/picture?type=large", "display_name": "Mohsin Khan", "link": "https://stackoverflow.com/users/7214470/mohsin-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1252, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484154814, "creation_date": 1484154308, "last_edit_date": 1531164843, "question_id": 41596651, "link": "https://stackoverflow.com/questions/41596651/how-to-save-worksheet-in-a-specific-folder-with-a-specific-name-using-vba", "title": "How to save worksheet in a specific folder with a specific name using vba?", "body": "<p>Please can someone help me with changing the below code so the user is guided to save it in a specific folder with his username and current date please</p>\n\n<p>When command button2 is pressed, 'save as' box should open in the following path: \"C/test/\" and the suggested name of worksheet should be in 'username ddmmyy' format.</p>\n\n<p>I know that I should be using 'application.username' somewhere in the code but not sure how the complete code will look like.</p>\n\n<p>What I could prepare so far is as follows (apologies if this is incorrect):</p>\n\n<pre><code>Private Sub CommandButton2_Click()\nDim IntialName As String\nDim sFileSaveName As Variant\nIntialName = \"Sample Output\"\nsFileSaveName = Application.GetSaveAsFilename(InitialFileName:=InitialName, fileFilter:=\"Excel Files (*.xlsm), *.xlsm\")\nIf sFileSaveName &lt;&gt; False Then\nActiveWorkbook.SaveAs sFileSaveName\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "call", "ms-word", "type-mismatch"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1484154122, "post_id": 41596510, "comment_id": 70395915, "body": "post the sub&#39;s code."}, {"owner": {"reputation": 119, "user_id": 7405699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82d07cb948fa9305c2964d881052e91b?s=128&d=identicon&r=PG", "display_name": "Ifusaso", "link": "https://stackoverflow.com/users/7405699/ifusaso"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1484168092, "post_id": 41596510, "comment_id": 70403778, "body": "@cyboashu updated"}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 7405699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82d07cb948fa9305c2964d881052e91b?s=128&d=identicon&r=PG", "display_name": "Ifusaso", "link": "https://stackoverflow.com/users/7405699/ifusaso"}, "is_accepted": true, "score": 0, "last_activity_date": 1484311681, "creation_date": 1484311681, "answer_id": 41635014, "question_id": 41596510, "link": "https://stackoverflow.com/questions/41596510/word-2013-vba-type-mismatch-error-when-calling-from-field/41635014#41635014", "title": "Word 2013 VBA Type mismatch error when calling from Field", "body": "<p>I found that I caused the error by having the code in two places- under the ThisDocument Object and the Macros Module. I deleted the ThisDocument version and the script runs.</p>\n"}], "owner": {"reputation": 119, "user_id": 7405699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82d07cb948fa9305c2964d881052e91b?s=128&d=identicon&r=PG", "display_name": "Ifusaso", "link": "https://stackoverflow.com/users/7405699/ifusaso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 514, "favorite_count": 1, "accepted_answer_id": 41635014, "answer_count": 1, "score": -1, "last_activity_date": 1484311681, "creation_date": 1484153863, "last_edit_date": 1484165472, "question_id": 41596510, "link": "https://stackoverflow.com/questions/41596510/word-2013-vba-type-mismatch-error-when-calling-from-field", "title": "Word 2013 VBA Type mismatch error when calling from Field", "body": "<p>I haven't coded in some time, and then it wasn't Visual Basic so forgive me if my question is simple or poorly explained.</p>\n\n<p>I have a Sub CustomSave() which verifies that there aren't blank ContentControls where they need to be filled in, then SaveAs's the (.docm) Word document with a title of \"User Name\" \"Date Requested\" \"Requested Action\" then deletes { Save } (see below) and 1 other Field in the document to prevent unintentional editing.</p>\n\n<p>The Sub runs perfectly when I Run it from VBA.</p>\n\n<p>The Sub is called (without passing anything) from a Field:<br>\n<code>{MacroButton CustomSave Save}</code></p>\n\n<p>When I activate said field, I get this error:<br>\n(Title) Microsoft Visual Basic for Applications [X]<br>\n(Content) Type mismatch<br>\n(Options) [OK][Help]  </p>\n\n<p>Help just takes me to the generic Microsoft online help that I couldn't find the answer.</p>\n\n<p>I'm retyping the code, so disregard the lack of a save directory and please don't assume typos exist in the actual document if I make a mistake here:</p>\n\n<pre><code>Sub CustomSave()\n\n' Deselect the Save Field   \nSelection.Collapse\n\n' Set checks for required data\nDim tRequest As Boolean\nDim tUser As Boolean\nDim tOffice As Boolean\nDim tCard As Boolean\ntRequest = ActiveDocument.SelectContentControlsByTitle(\"Request\").Item(1).ShowingPlaceholderText\ntUser = ActiveDocument.SelectContentControlsByTitle(\"User\").Item(1).ShowingPlaceholde    tText\ntOffice = ActiveDocument.SelectContentControlsByTitle(\"Office\").Item(1).ShowingPlaceholderText\ntCard = ActiveDocument.SelectContentControlsByTitle(\"Card\").Item(1).ShowingPlaceholderText\n\n' Set file name variables\nDim cardHolder As String\nDim cardAction As String\ncardHolder = ActiveDocument.SelectContentControlsByTitle(\"User\")(1).Range.Text\ncardAction = ActiveDocument.SelectContentControlsByTitle(\"Request\")(1).Range.Text\n\n' Check all and Error out if missing required data\nIf tRequest Then\n    Msg = \"Action Requested is required.\"\n    MsgBox = Msg,,\"Error\"\n    Exit Sub\n\nElseIf tUser Then\n    Msg = \"Username is required.\"\n    MsgBox = Msg,,\"Error\"\n    Exit Sub\n\nElseIf ActiveDocument.SelectContentControlsByTitle(\"Request\")(1).Range.Text = \"New\" Then\n    ' Embedded If to check fields only required for new requests\n\n    If tCard Then\n        Msg = \"Card type is required.\"\n        MsgBox = Msg,,\"Error\"\n        Exit Sub\n\n    ElseIf tOffice Then\n        Msg = \"Office location is required.\"\n        MsgBox = Msg,,\"Error\"\n        Exit Sub\n\n    Else\n        GoTo Save\n\n    End If\n\n'If all checks are satisfied, save to the designated location\nElse\nSave:\n    ' Remove the Save and Clear Fields but not the first Field\n    Dim rng As Range\n\n    For Each rng In ActiveDocument.StoryRanges\n        With rng.Fields\n            While .Count &gt; 1\n                .Item(2).Delete\n            Wend\n        End With\n    Next\n\n    ' Finally, perform the save\n    ActiveDocument.SaveAs2 (\"Dir\" &amp; cardHolder &amp; \" \" &amp; Format(Now(), \"yyyy-mm-dd\") &amp; \" \" &amp; cardAction &amp; \".docm\")\n\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1484153540, "post_id": 41596316, "comment_id": 70395539, "body": "You must store that value as Text: Excel can&#39;t handle numbers with more than 15 digits of precision.  Is that value intended to be used as a number?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1484154973, "post_id": 41596316, "comment_id": 70396483, "body": "@TimWilliams  Is it possible to capture the characters as they appear in the <b>Formula Bar</b> for the active cell ??"}], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1484154242, "post_id": 41596435, "comment_id": 70395982, "body": "But if your column is only wide enough to show <code>####</code> or <code>9.41E+20</code>?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1484154855, "post_id": 41596435, "comment_id": 70396403, "body": "@DarrenBartrup-Cook  You are correct...see my <b>EDIT#1</b>"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 173, "user_id": 5748085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/PmghB.jpg?s=128&g=1", "display_name": "Buckethead", "link": "https://stackoverflow.com/users/5748085/buckethead"}, "edited": false, "score": 0, "creation_date": 1484155425, "post_id": 41596435, "comment_id": 70396775, "body": "@Buckethead  thank you for the feedback....but be aware that you will get what you see in the cell rather than what you see in the <i>Formula Bar</i>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1484156207, "post_id": 41596435, "comment_id": 70397271, "body": "Now try that with <code>941144280284022000001</code>"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1484156371, "post_id": 41596435, "comment_id": 70397382, "body": "@TimWilliams Just getting your string in a cell requires the cell to be formatted as <b><i>Text</i></b> or to place a single quote before the <b><i>9</i></b>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1484156690, "post_id": 41596435, "comment_id": 70397603, "body": "That was my point I guess - how the values are entered is the main issue here."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1484156983, "post_id": 41596435, "comment_id": 70397784, "body": "@TimWilliams My answer assumed that the issue of getting the numeral string into the cell had already been resolved and that cell displayed the numeral string quoted in the question."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1484160072, "post_id": 41596435, "comment_id": 70399441, "body": "I just thought it was worth including explicitly in your answer: the comment about displaying as #### or 9.41E+20 would only happen with a non-text entry."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1484160803, "post_id": 41596435, "comment_id": 70399842, "body": "@TimWilliams  Is my <b>EDIT</b> any better ??"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1484160774, "last_edit_date": 1484160774, "creation_date": 1484153629, "answer_id": 41596435, "question_id": 41596316, "link": "https://stackoverflow.com/questions/41596316/get-value-from-cell-without-transform-in-vba-macros/41596435#41596435", "title": "Get value from cell without transform in vba macros", "body": "<p>Here is an example:</p>\n\n<pre><code>Sub dural()\n    MsgBox ActiveCell.Text\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/jpEXW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jpEXW.png\" alt=\"enter image description here\"></a></p>\n\n<p>This will insure that long strings of numerals are not converted to numbers.</p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>This assumes that the cell actually displays the long string of numerals.  If the cell displays <strong>####</strong>, that is what the sub will pick-up.  If the cell displays <strong>9.41E+20</strong>, then that is what my sub will pick-up.</p>\n\n<p>My sub will <strong>not</strong> necessarily pick-up the contents of the <em>Formula Bar</em>.</p>\n"}, {"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1484156215, "post_id": 41596567, "comment_id": 70397275, "body": "Now try that with <code>941144280284022000001</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1484161181, "post_id": 41596567, "comment_id": 70400033, "body": "<code>? CDec(941144280284022000001)</code> &gt;&gt; <code>941144280284022000000</code>"}], "tags": [], "owner": {"reputation": 64, "user_id": 5941652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b75b5fbcce9ab8ba81c1d0172c7898b2?s=128&d=identicon&r=PG&f=1", "display_name": "SilentFlight", "link": "https://stackoverflow.com/users/5941652/silentflight"}, "is_accepted": false, "score": 2, "last_activity_date": 1484172157, "last_edit_date": 1484172157, "creation_date": 1484154028, "answer_id": 41596567, "question_id": 41596316, "link": "https://stackoverflow.com/questions/41596316/get-value-from-cell-without-transform-in-vba-macros/41596567#41596567", "title": "Get value from cell without transform in vba macros", "body": "<p>Try a simple :</p>\n\n<pre><code>Dim myVar as Variant\n\nmyVar = CDec(Range(\"A1\").Value)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1484161366, "creation_date": 1484161366, "answer_id": 41598724, "question_id": 41596316, "link": "https://stackoverflow.com/questions/41596316/get-value-from-cell-without-transform-in-vba-macros/41598724#41598724", "title": "Get value from cell without transform in vba macros", "body": "<p>If you wish to store a value that <em>looks</em> like a number (or is a number) but has more than 15 digits of precision, then you <em>must</em> either format the cell as text <em>before</em> entering the value, or prepend the value with a single apostrophe to indicate to Excel that the value is to be treated as text and not a number.</p>\n\n<p>If you <em>don't</em> do this, then as soon as the value is entered, there's a good chance it will be altered by Excel. The trailing zeros in the example value mean this does not happen in this specific case, but try changing that last 0 to 1 and you'll see what I mean.</p>\n\n<p>You enter: 941144280284022000001</p>\n\n<p>Excel converts this to: 94114428028402200000<strong>0</strong></p>\n\n<p>More reading:  <a href=\"https://en.wikipedia.org/wiki/Numeric_precision_in_Microsoft_Excel\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Numeric_precision_in_Microsoft_Excel</a></p>\n"}], "owner": {"reputation": 173, "user_id": 5748085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/PmghB.jpg?s=128&g=1", "display_name": "Buckethead", "link": "https://stackoverflow.com/users/5748085/buckethead"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 41596435, "answer_count": 3, "score": 1, "last_activity_date": 1547681930, "creation_date": 1484153310, "last_edit_date": 1547681930, "question_id": 41596316, "link": "https://stackoverflow.com/questions/41596316/get-value-from-cell-without-transform-in-vba-macros", "title": "Get value from cell without transform in vba macros", "body": "<p>I have an issue with vba macros. Cell contains value 941144280284022000000. But when try to get this value in macros, variable is equal \n9.41144280284022E+20. Is it possible to get \"real\" value?\nThanks.</p>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1484154045, "post_id": 41596293, "comment_id": 70395865, "body": "<code>04&#47;05&#47;2016</code> is 4th May 2016?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1484161554, "post_id": 41596293, "comment_id": 70400228, "body": "I assume the values in columns H and I are text, not dates.  Is that correct?  (And it is therefore setting column H to be the lowest text value, i.e. <code>&quot;04&#47;05&#47;2016&quot;</code> is less than <code>&quot;13&#47;01&#47;2016&quot;</code> because <code>&quot;0&quot;</code> is less than <code>&quot;1&quot;</code>.)"}], "answers": [{"comments": [{"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1484210497, "post_id": 41598844, "comment_id": 70418643, "body": "Hi YowE3k: That was it. It was stored as Text. Thank you so much for the help the code you gave me worked perfectly. Thank you so much for taking the time. Much respect from Dublin :-) Have a great day"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1484161731, "creation_date": 1484161731, "answer_id": 41598844, "question_id": 41596293, "link": "https://stackoverflow.com/questions/41596293/vba-code-not-correcting-dates-for-all-rows-of-data/41598844#41598844", "title": "VBA code not correcting dates for all rows of data", "body": "<p>Judging by your output, it appears that the cells in column H and I are text, not dates.  Thus <code>\"04/05/2016\"</code> is less than <code>\"13/01/2016\"</code>, and (for Anders Nyboe Andersen) <code>\"15/03/2016\"</code> is greater than <code>\"14/03/2016\"</code> is greater than <code>\"07/04/2016\"</code>.</p>\n\n<p>Providing your locale settings are such that dates are represented as \"dd/mm/yyyy\" format (your profile says Ireland, so I am guessing that they are), you can get your tests working by converting the text in the cells to be a <code>Date</code> prior to performing your comparisons:</p>\n\n<pre><code>' Update Start Date on Previous Row\nIf CDate(wks.Cells(r, 8)) &lt; CDate(wks.Cells(r - 1, 8)) Then\n    wks.Cells(r - 1, 8) = wks.Cells(r, 8)\nEnd If\n' Update End Date on Previous Row\nIf CDate(wks.Cells(r, 9)) &gt; CDate(wks.Cells(r - 1, 9)) Then\n    wks.Cells(r - 1, 9) = wks.Cells(r, 9)\nEnd If \n</code></pre>\n"}], "owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 41598844, "answer_count": 1, "score": 0, "last_activity_date": 1484161731, "creation_date": 1484153245, "question_id": 41596293, "link": "https://stackoverflow.com/questions/41596293/vba-code-not-correcting-dates-for-all-rows-of-data", "title": "VBA code not correcting dates for all rows of data", "body": "<p>I hope you can help. I have a piece of code and it works relatively well.</p>\n\n<p>What it does is it opens up a dialog box using a command button that allows a user to select another excel sheet once this sheet is selected the code then consolidates the duplicates and creates a new row with the earliest possible start date and latest possible end date then deletes the duplicate rows. </p>\n\n<p>So in Pic 1 </p>\n\n<p>We can see that we have duplicate rows with multiple start date and end dates what the code should do is find the duplicates with the earliest start date and latest end date and make a new line. </p>\n\n<p>Pic 1. </p>\n\n<p><a href=\"https://i.stack.imgur.com/rs6KR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rs6KR.png\" alt=\"Pic1\"></a></p>\n\n<p>In Pic 2 \nyou can see that the duplicates have been removed and for the first duplicate the dates are correct with the earliest start date and latest end date possible available Agnholt J\u00f8rgen Steen Start date 01/04/2016  end date 17/06/2016</p>\n\n<p>But for Breum   Leif its the wrong way round 04/05/2016 13/01/2016</p>\n\n<p>Pic 2. \n<a href=\"https://i.stack.imgur.com/Edssf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Edssf.png\" alt=\"enter image description here\"></a></p>\n\n<p>Can my code be amended to solve this issue. As always any help is greatly appreciated. </p>\n\n<p>My code is below.  </p>\n\n<p>CODE </p>\n\n<pre><code>Sub Open_Workbook_Dialog()\n\n\n    Dim strFileName     As String\n    Dim wkb             As Workbook\n    Dim wks             As Worksheet\n    Dim lastRow         As Long\n    Dim r               As Long\n\n    MsgBox \"Select Denmark File\" '&lt;--| txt box for prompt to pick a file\n\n        strFileName = Application.GetOpenFilename(FileFilter:=\"Excel Files,*.xl*;*.xm*\") '&lt;--| Opens the file window to allow selection\n\n    Set wkb = Application.Workbooks.Open(strFileName)\n    Set wks = ActiveWorkbook.Sheets(1)\n    lastRow = wks.UsedRange.Rows.Count\n\n    For r = lastRow To 3 Step -1\n        ' Identify Duplicate\n        If wks.Cells(r, 1) = wks.Cells(r - 1, 1) _\n        And wks.Cells(r, 2) = wks.Cells(r - 1, 2) _\n        And wks.Cells(r, 3) = wks.Cells(r - 1, 3) _\n        And wks.Cells(r, 4) = wks.Cells(r - 1, 4) _\n        And wks.Cells(r, 5) = wks.Cells(r - 1, 5) _\n        And wks.Cells(r, 6) = wks.Cells(r - 1, 6) _\n        And wks.Cells(r, 7) = wks.Cells(r - 1, 7) Then\n            ' Update Start Date on Previous Row\n            If wks.Cells(r, 8) &lt; wks.Cells(r - 1, 8) Then\n                wks.Cells(r - 1, 8) = wks.Cells(r, 8)\n            End If\n            ' Update End Date on Previous Row\n            If wks.Cells(r, 9) &gt; wks.Cells(r - 1, 9) Then\n                wks.Cells(r - 1, 9) = wks.Cells(r, 9)\n            End If\n            ' Delete Duplicate\n            Rows(r).Delete\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1484153351, "post_id": 41596289, "comment_id": 70395408, "body": "Can you post the actual code?  <code>Sub GetWb() as Workbook</code> is a syntax error at very least, and <code>&#39;code here to set the proper workbook</code> is likely where the issue is."}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 0, "creation_date": 1484153914, "post_id": 41596289, "comment_id": 70395782, "body": "I think your solution is close - there may be a better way to write it, but the idea would be the same - catch an error on tyring to access the <code>Workbook</code> object. Just wrap it into a <code>Function</code> that returns <code>Boolean</code> - and you are all set."}, {"owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "edited": false, "score": 0, "creation_date": 1484154084, "post_id": 41596289, "comment_id": 70395890, "body": "i added code to the function."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1484154227, "post_id": 41596289, "comment_id": 70395977, "body": "what happens in the first snippet if you comment out <code>set w = GetWb</code>?"}, {"owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "edited": false, "score": 0, "creation_date": 1484154550, "post_id": 41596289, "comment_id": 70396211, "body": "Edit: My real question is how to test if object was set that was instantiated. I am not really looking to &quot;correct&quot; my code. Its just an example."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1484178546, "post_id": 41596289, "comment_id": 70408155, "body": "Just FYI you can&#39;t really expect a concrete example with a code sample that is clearly nonsense. Your <code>Is Nothing</code> test would work if the code you posted were a function."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1484181862, "post_id": 41596289, "comment_id": 70409101, "body": "I can&#39;t replicate this at all. If <code>Application.Workbooks.Open</code> throws I <i>consistently</i> have <code>Is Nothing</code> return <code>True</code> on the variable it was being set to."}], "answers": [{"comments": [{"owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "edited": false, "score": 0, "creation_date": 1484154701, "post_id": 41596649, "comment_id": 70396301, "body": "While that will solve the issue, my real question is how to test if object was set that was instantiated. I am not really looking to &quot;correct&quot; my code. Its just an example. I am gathering that there isn&#39;t a better way and I should either do it my way or return nothing like you state here."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "edited": false, "score": 1, "creation_date": 1484156109, "post_id": 41596649, "comment_id": 70397198, "body": "hmm, but with workbooks, it will never happen, if you do ` Dim x As Workbook` and the check its nothing. Only way to create an instance and not set the value is <code>Dim x As New Workbook</code> but this case is useless as it will start spraion err: 429 every time you try to use it without setting any workbook. Overkill is to declare with New keyword and trap error 429."}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "reply_to_user": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "edited": false, "score": 1, "creation_date": 1484159021, "post_id": 41596649, "comment_id": 70398837, "body": "@mountainclimber I&#39;ve also noticed that there is something different when you work with &quot;system&quot; objects like <code>Workbook</code> and <code>Worksheets</code> collection compared to the objects you create yourself. Not being able to use <code>Is Nothing</code> check is one example. Another is - I have generic function to check if item exists in collection and it does not work with <code>Worksheets</code>, even though it is theoretically a <code>Collection</code> (documentation says that). All you can do with application objects is trial and error to see what works. :-("}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 1, "last_activity_date": 1484154299, "creation_date": 1484154299, "answer_id": 41596649, "question_id": 41596289, "link": "https://stackoverflow.com/questions/41596289/vba-test-if-workbook-is-nothing/41596649#41596649", "title": "VBA: test if workbook is nothing", "body": "<p>change your error handling for GetWB so it returns nothing incase of error, also use Function instead of sub.</p>\n\n<pre><code>Function GetWb() As Workbook\n\n    Application.DisplayAlerts = False\n    Application.EnableEvents = False\n\n    On Error GoTo errHandler:\n\n    Set GetWb = Application.Workbooks.Open(\"Z:\\somepath.xlsm\", ReadOnly:=True)\n    Application.EnableEvents = True\n    Application.DisplayAlerts = True\n\nerrHandler:\n        If Err.Number &lt;&gt; 0 Then\n            Set GetWb = Nothing\n            Application.EnableEvents = True\n            Application.DisplayAlerts = True\n        End If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5289, "favorite_count": 0, "accepted_answer_id": 41596649, "answer_count": 1, "score": -1, "last_activity_date": 1484154498, "creation_date": 1484153241, "last_edit_date": 1531164843, "question_id": 41596289, "link": "https://stackoverflow.com/questions/41596289/vba-test-if-workbook-is-nothing", "title": "VBA: test if workbook is nothing", "body": "<p>Edit: My real question is how to test if object was set that was instantiated. I am not really looking to \"correct\" my code. Its just an example.</p>\n\n<p>I have a function that returns a workbook:</p>\n\n<p>Edit: Added code</p>\n\n<pre><code>Sub GetWb() as Workbook\n\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\nOn Error Resume Next\nSet wM = Application.Workbooks.Open(\"Z:\\somepath.xlsm\", ReadOnly:=True)\nApplication.EnableEvents = True\nApplication.DisplayAlerts = True\nOn Error GoTo 0\n\nend sub\n</code></pre>\n\n<p>In another sub I want to check if that object was set properly by the function. I usually do something like this with objects generally:</p>\n\n<pre><code>dim w as Workbook\nset w = GetWb\nif w is nothing then\ndebug.print \"no workbook\"\nelse\ndebug.print \"workbook\"\nend if\n</code></pre>\n\n<p>However, the <code>is nothing</code> test does not work because the object is instantiated, but was not set so it is something, not nothing.</p>\n\n<p>I have resorted to this ugly solution, which works fine:</p>\n\n<pre><code>dim w as Workbook\nset w = GetWb\non error goto someerrorhandling\nif w.name = \"\" then\nend if\non error goto 0\n'other code here\n\n\nsomeerrorhandling: \nmsgbox \"no workbook\"\n</code></pre>\n\n<p>In other words, I check a property of the object to force an error, or not. There must be a better/cleaner way.</p>\n\n<p>I checked and this link states that the way I am doing it is the best way:\n<a href=\"https://stackoverflow.com/questions/8472907/vba-conditional-is-nothing\">VBA: Conditional - Is Nothing</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1484152901, "post_id": 41596121, "comment_id": 70395151, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/office/gg264412(v=office.15).aspx\" rel=\"nofollow noreferrer\">IIf()</a>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 4, "creation_date": 1484152952, "post_id": 41596121, "comment_id": 70395175, "body": "VBA doesn&#39;t have a true ternary operator. There&#39;s the <code>IIf</code> <i>function</i>, but you add the overhead of a function call, giving you <b><i>both</i></b> decreased readability and performance."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1484152993, "post_id": 41596121, "comment_id": 70395210, "body": "Its also not short-circuited."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 4, "creation_date": 1484153070, "post_id": 41596121, "comment_id": 70395248, "body": "just to point out that <code>Iif()</code> function doesn&#39;t short-circuit and always evaluates both branches so that should one of them fail, even if not the &quot;real&quot; one, the statement would throw an error anyway"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1484153087, "post_id": 41596121, "comment_id": 70395259, "body": "If you just want the decreased readability, simple expressions can use a single line <code>If..Else</code>:  <code>If boolVar = True Then x = &quot;foo&quot; Else x = &quot;bar&quot;</code>"}, {"owner": {"reputation": 7410, "user_id": 2353523, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RXiBc.jpg?s=128&g=1", "display_name": "soulshined", "link": "https://stackoverflow.com/users/2353523/soulshined"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1484153114, "post_id": 41596121, "comment_id": 70395276, "body": "ternary was on the tip of my tongue @Comintern glad you said it! that would have bothered me forever. I&#39;m okay with decreased readability when it comes to simple tasks. can you elaborate on the performance hindrances? I just started to learn about VB"}, {"owner": {"reputation": 7410, "user_id": 2353523, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RXiBc.jpg?s=128&g=1", "display_name": "soulshined", "link": "https://stackoverflow.com/users/2353523/soulshined"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1484153166, "post_id": 41596121, "comment_id": 70395302, "body": "ahhhh @user3598756 that makes a big difference, and almost useless"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1484153219, "post_id": 41596121, "comment_id": 70395328, "body": "You take a performance hit for any function call - pushing and popping the call stack, etc. I have no clue if objective C compiler inlines functions, but it&#39;s the opposite of that."}, {"owner": {"reputation": 7410, "user_id": 2353523, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RXiBc.jpg?s=128&g=1", "display_name": "soulshined", "link": "https://stackoverflow.com/users/2353523/soulshined"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1484154121, "post_id": 41596121, "comment_id": 70395914, "body": "Thanks for the feedback @user3598756 i&#39;ll probably opt-out after you guys telling me it&#39;s not short-circuited. I&#39;m okay with decreased readability as long as it doesn&#39;t return false positives, or in this case, false negatives, since one can always be true. Do you mind sharing as an answer? I would hate future question seekers miss that bit of info due to overlooking comment section"}, {"owner": {"reputation": 7410, "user_id": 2353523, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RXiBc.jpg?s=128&g=1", "display_name": "soulshined", "link": "https://stackoverflow.com/users/2353523/soulshined"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1484158036, "post_id": 41596121, "comment_id": 70398325, "body": "@Comintern I just read in the docs you don&#39;t have to use <code>End If</code> as a closer when the <code>If</code> &amp; <code>Then</code> are on the same line! So I think that is sufficient. Gonna go with your example and opt out of <code>End If</code>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1484158262, "post_id": 41596121, "comment_id": 70398450, "body": "Just to clarify, <code>End If</code> isn&#39;t <i>optional</i> on a single line <code>If</code> statement, you can&#39;t have it <i>at all</i>.  ;-)"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1484159278, "post_id": 41596121, "comment_id": 70398965, "body": "@soulshined; as per your request I added an answer"}, {"owner": {"reputation": 7410, "user_id": 2353523, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RXiBc.jpg?s=128&g=1", "display_name": "soulshined", "link": "https://stackoverflow.com/users/2353523/soulshined"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1484159369, "post_id": 41596121, "comment_id": 70399007, "body": "@Comintern I completely missed your example. You definetly didn&#39;t put it in there. I just skimmed it the first time. After I saw if then I gave up \ud83d\ude01 your the man though! Or woman, I can&#39;t tell from here ;) thanks for not judging a newbie"}], "answers": [{"comments": [{"owner": {"reputation": 7410, "user_id": 2353523, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RXiBc.jpg?s=128&g=1", "display_name": "soulshined", "link": "https://stackoverflow.com/users/2353523/soulshined"}, "edited": false, "score": 0, "creation_date": 1484153599, "post_id": 41596160, "comment_id": 70395575, "body": "So you have to set a variable to the function first? Thats awkward. I was hoping it would be an &#39;out-of-box&#39; experience. Thanks for the swift response. I&#39;m going to have to look more into it based on the feedback in the comments above."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 7410, "user_id": 2353523, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RXiBc.jpg?s=128&g=1", "display_name": "soulshined", "link": "https://stackoverflow.com/users/2353523/soulshined"}, "edited": false, "score": 6, "creation_date": 1484158266, "post_id": 41596160, "comment_id": 70398454, "body": "@soulshined You don&#39;t have to set a variable to a function; <code>IIF</code> is built into VBA. It works largely similarly to the ternary operator in C, however as others have pointed out it doesn&#39;t short-circuit and it is a function call. Here it is using your example: <code>IIF(boolVar, &quot;Yup, tis true&quot;, &quot;Nope, tis false&quot; )</code>."}, {"owner": {"reputation": 7410, "user_id": 2353523, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RXiBc.jpg?s=128&g=1", "display_name": "soulshined", "link": "https://stackoverflow.com/users/2353523/soulshined"}, "reply_to_user": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1484180346, "post_id": 41596160, "comment_id": 70408740, "body": "Yeah I realized that after testing @Blackhawk , too late to edit comment though :/"}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 37, "last_activity_date": 1484152872, "creation_date": 1484152872, "answer_id": 41596160, "question_id": 41596121, "link": "https://stackoverflow.com/questions/41596121/does-vba-have-a-ternary-operator/41596160#41596160", "title": "Does VBA Have a Ternary Operator?", "body": "<pre><code>Sub test()\n\n    Dim x As Long\n    Dim y As Long\n    y = 1\n    x = IIf(y = 1, 1, 2)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 21, "last_activity_date": 1580200870, "last_edit_date": 1580200870, "creation_date": 1484159191, "answer_id": 41598084, "question_id": 41596121, "link": "https://stackoverflow.com/questions/41596121/does-vba-have-a-ternary-operator/41598084#41598084", "title": "Does VBA Have a Ternary Operator?", "body": "<p>the closest function is <code>IIf()</code></p>\n\n<pre><code>IIf(expr, truepart, falsepart)\n</code></pre>\n\n<p>but:</p>\n\n<ul>\n<li><p>you can't have its branches simply running code, while you have to assign its return value to some variable,</p></li>\n<li><p>it doesn't short-circuit,</p>\n\n<p>it always evaluates both branches so that should one of them fail, even if not the \"real\" one, the statement would throw an error anyway.</p></li>\n</ul>\n\n<p>So the most <em>resembling</em> statement is:</p>\n\n<pre><code>If boolVar Then sub1 Else sub2 \n</code></pre>\n\n<p>where:</p>\n\n<ul>\n<li><p><code>boolVar</code> is a boolean type variable,</p></li>\n<li><p><code>sub1</code> and <code>sub2</code> are two different subs/functions to be called.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 9336170, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/bd6a5d6c1ba005d542254416bc86f7ba?s=128&d=identicon&r=PG", "display_name": "Jose Natali", "link": "https://stackoverflow.com/users/9336170/jose-natali"}, "is_accepted": false, "score": 4, "last_activity_date": 1518142489, "last_edit_date": 1518142489, "creation_date": 1518141439, "answer_id": 48697635, "question_id": 41596121, "link": "https://stackoverflow.com/questions/41596121/does-vba-have-a-ternary-operator/48697635#48697635", "title": "Does VBA Have a Ternary Operator?", "body": "<p>As an alternative you can create the following public function in a module:</p>\n\n<pre><code>Public Function iff(expr, trueR, falseR) As Variant\n    If expr Then iff = trueR Else iff = falseR\nEnd Function\n</code></pre>\n\n<p>So far works for me.</p>\n"}], "owner": {"reputation": 7410, "user_id": 2353523, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RXiBc.jpg?s=128&g=1", "display_name": "soulshined", "link": "https://stackoverflow.com/users/2353523/soulshined"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23904, "favorite_count": 3, "accepted_answer_id": 41596160, "answer_count": 3, "score": 27, "last_activity_date": 1580206974, "creation_date": 1484152764, "last_edit_date": 1580206974, "question_id": 41596121, "link": "https://stackoverflow.com/questions/41596121/does-vba-have-a-ternary-operator", "title": "Does VBA Have a Ternary Operator?", "body": "<p>I come from the beautiful world of Obj C, which is based on the C programming language, and I've fallen in love with finding quirky ways to save space. However, I've looked through as much documentation as I can and I can't find anything juicy on VBA that will shorten this syntax:</p>\n\n<pre><code>If boolVar = True Then\n   'Do something\nElse\n   'Do nothing\nEnd If\n</code></pre>\n\n<p>In Obj C, and naturally C, I'm extremely familiar with doing this:</p>\n\n<pre><code>boolVar ? \"Nope, tis false\" : \"Yup, tis true\"\n</code></pre>\n\n<p>This is very similar to what most other languages use, some may use extra logical operators like <code>!=</code> or <code>==</code> but that leaves me optimistic. I may not have looked in the right places, if that's the case PLEASE <strong>let me know</strong> where you get your documentation.</p>\n\n<p>TLDR, can we shorten If/Then/Else to one line of code in VBA? <em>This is extremely handy</em> when the 'Do Somethings' are nothing more then setting another variable's single parameter, or enabling/disabling a button. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7405676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5ebc86b499519512f3509a6409fe303?s=128&d=identicon&r=PG&f=1", "display_name": "massi", "link": "https://stackoverflow.com/users/7405676/massi"}, "is_accepted": false, "score": 0, "last_activity_date": 1530894832, "last_edit_date": 1530894832, "creation_date": 1484922366, "answer_id": 41765887, "question_id": 41596011, "link": "https://stackoverflow.com/questions/41596011/populating-a-spreadsheet-from-other-tab-values/41765887#41765887", "title": "Populating a spreadsheet from other tab values", "body": "<p>I managed to solve the problem on my own.</p>\n\n<pre><code>Sub writeall()\n\n    Dim Ws As Worksheet\n    Dim Ws1 As Worksheet\n    Dim Ws2 As Worksheet\n\n    Dim X As Long\n    Dim Y As Long\n    Dim count As Long\n\n    Application.ScreenUpdating = False\n\n    Set Ws = ActiveWorkbook.Worksheets(1)\n    Set Ws1 = ActiveWorkbook.Worksheets(2)\n    Set Ws2 = Workbooks(\"xxxx.xlsx\").Sheets(\"2017\") ' xxxx is the name of the xlsx\n\n    count = 1\n\n    For X = 2 To Ws2.Range(\"A\" &amp; Rows.count).End(xlUp).Row\n        For Y = 1 To Ws1.Range(\"A\" &amp; Rows.count).End(xlUp).Row\n            count = count + 1\n            Ws.Cells(count, 1).Value = Ws2.Cells(X, 1).Value\n            Ws.Cells(count, 2).Value = Ws1.Cells(Y, 2).Value\n            Ws.Cells(count, 3).Value = Ws1.Cells(Y, 1).Value\n\n        Next Y\n    Next X\n\n    Application.ScreenUpdating = True\n    MsgBox (\"Spreadsheet updated\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7405676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5ebc86b499519512f3509a6409fe303?s=128&d=identicon&r=PG&f=1", "display_name": "massi", "link": "https://stackoverflow.com/users/7405676/massi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1531899669, "creation_date": 1484152413, "last_edit_date": 1531899669, "question_id": 41596011, "link": "https://stackoverflow.com/questions/41596011/populating-a-spreadsheet-from-other-tab-values", "title": "Populating a spreadsheet from other tab values", "body": "<p>In Excel for Mac:</p>\n\n<p>I have 2 tabs (wkst1 and wkst2) and need to populate a third one (wkst3)</p>\n\n<p>wkst1 has one column with names listed\ne.g.</p>\n\n<pre><code>A\n\nB\n</code></pre>\n\n<p>wkst2 has two columns</p>\n\n<pre><code>X     1\n\nY     4\n</code></pre>\n\n<p>I need to populate wkst3 to ensure all rows in wkst2 are associated to each name listed in wkst1.</p>\n\n<p>e.g. my wished result would be:</p>\n\n<pre><code>A     X     1\n\nA     Y     4\n\nB     X     1\n\nB     Y     4\n</code></pre>\n\n<p>Can you suggest the code I should use?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1484325738, "post_id": 41595710, "comment_id": 70478580, "body": "Would you like a VBA solution for it?"}, {"owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "reply_to_user": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1484325828, "post_id": 41595710, "comment_id": 70478648, "body": "Yes please, that would be perfect"}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1484328502, "post_id": 41595710, "comment_id": 70480204, "body": "Two questions - Is the data in your excel in consistent order and is the spacing (which denotes groups and sub groups) also in consistent order?"}, {"owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "reply_to_user": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1484328845, "post_id": 41595710, "comment_id": 70480421, "body": "The data is not in consistent order. For instance, at the largest grouping the first entry (&quot;OCM&quot;) could have 6 subgroups, while the next entry could have 3 subgroups, etc. However, the spacing to denote groups is consistent: the largest group will have no spacing, the second grouping will always have indent = 1, and the smallest grouping will have indent = 2, for all entries."}], "answers": [{"comments": [{"owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "edited": false, "score": 0, "creation_date": 1484340023, "post_id": 41642337, "comment_id": 70486029, "body": "Thanks for your reply and for coming up with a great workaround. I can&#39;t seem to get the code to work however - the categories aren&#39;t grouped together and just appear in a list when I run the script."}, {"owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "edited": false, "score": 0, "creation_date": 1484340550, "post_id": 41642337, "comment_id": 70486282, "body": "the nodeOrd part of the code seems to return  &quot;0&quot; for all values"}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "reply_to_user": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "edited": false, "score": 0, "creation_date": 1484340597, "post_id": 41642337, "comment_id": 70486305, "body": "I have assumed that there are 4 spaces before level1 and 8 before level2. Perhaps you need to adjust your spacing"}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "reply_to_user": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "edited": false, "score": 0, "creation_date": 1484340683, "post_id": 41642337, "comment_id": 70486335, "body": "what does nodeTxt  return for you ... check in debug.print"}, {"owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "edited": false, "score": 0, "creation_date": 1484341118, "post_id": 41642337, "comment_id": 70486520, "body": "It correctly reads &quot;nodeTxt&quot; and &quot;nodeAmt&quot; as OCM and 45,727xx. The issue is that there technically aren&#39;t readable spaces, it&#39;s an indent (Format cells &gt; Alignment &gt; Indent = 1). There&#39;s a function that can return the correct nodeOrd (please see edit), and this works in your code"}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "reply_to_user": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "edited": false, "score": 0, "creation_date": 1484341839, "post_id": 41642337, "comment_id": 70486818, "body": "@beeba - modified the code to use indent instead of spaces... check if it works"}, {"owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "edited": false, "score": 0, "creation_date": 1484342247, "post_id": 41642337, "comment_id": 70486998, "body": "Thanks, that works perfectly! Would it be possible to export the TreeView control to a sheet in the excel workbook, keeping the node groupings intact?"}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "reply_to_user": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "edited": false, "score": 0, "creation_date": 1484342597, "post_id": 41642337, "comment_id": 70487136, "body": "Nop. Can&#39;t do that. But the data can be exported in XML format."}, {"owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "edited": false, "score": 0, "creation_date": 1484344529, "post_id": 41642337, "comment_id": 70487916, "body": "how do I export it in XML?"}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "reply_to_user": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "edited": false, "score": 0, "creation_date": 1484345235, "post_id": 41642337, "comment_id": 70488200, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/133119/discussion-between-pankaj-jaju-and-beeba\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "is_accepted": false, "score": 2, "last_activity_date": 1484351668, "last_edit_date": 1484351668, "creation_date": 1484336690, "answer_id": 41642337, "question_id": 41595710, "link": "https://stackoverflow.com/questions/41595710/collapse-expand-rows-in-section/41642337#41642337", "title": "Collapse/expand rows in section", "body": "<p><strong>Solution 1 - Using groups</strong></p>\n\n<pre><code>Private Sub Workbook_Open()\n    With Sheet1\n        Dim i As Long, varLast As Long\n\n        .Cells.ClearOutline\n        varLast = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        .Columns(\"A:A\").Insert Shift:=xlToRight 'helper column\n\n        For i = 1 To varLast\n            .Range(\"A\" &amp; i) = .Range(\"B\" &amp; i).IndentLevel\n        Next\n\n        Dim rngRows As Range, rngFirst As Range, rngLast As Range, rngCell As Range, rowOffset As Long\n\n        Set rngFirst = Range(\"A1\")\n        Set rngLast = rngFirst.End(xlDown)\n        Set rngRows = Range(rngFirst, rngLast)\n\n        For Each rngCell In rngRows\n            rowOffset = 1\n\n            Do While rngCell.Offset(rowOffset) &gt; rngCell And rngCell.Offset(rowOffset).Row &lt;= rngLast.Row\n                rowOffset = rowOffset + 1\n            Loop\n\n            If rowOffset &gt; 1 Then\n                Range(rngCell.Offset(1), rngCell.Offset(rowOffset - 1)).EntireRow.Group\n            End If\n        Next\n\n        .Columns(\"A:A\").EntireColumn.Delete\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/9qHIz.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9qHIz.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Solution 2 - In case you don't want to modify the workbook data - workaround</strong></p>\n\n<p>Step 1 - Create a <code>UserForm</code> and add <code>TreeView</code> Control</p>\n\n<p><a href=\"https://i.stack.imgur.com/IqPij.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IqPij.png\" alt=\"enter image description here\"></a></p>\n\n<p>Step 2 - Add the following code in the <code>UserForm</code> code</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    With Me.TreeView1\n        .Style = tvwTreelinesPlusMinusText\n        .LineStyle = tvwRootLines\n    End With\n\n    Call func_GroupData\nEnd Sub\n\nPrivate Sub func_GroupData()\n    varRows = CLng(Sheet1.Cells(Sheet1.Rows.Count, \"A\").End(xlUp).Row)\n\n    With Me.TreeView1.Nodes\n        .Clear\n\n        For i = 1 To varRows\n            nodeTxt = Sheet1.Range(\"A\" &amp; i)\n            nodeOrd = Sheet1.Range(\"A\" &amp; i).IndentLevel\n            nodeTxt = Trim(nodeTxt)\n            nodeAmt = Trim(CStr(Format(Sheet1.Range(\"B\" &amp; i), \"###,###,###,##0.00\")))\n\n            Select Case nodeOrd\n                Case 0 'Level 0 - Root node\n                    nodeTxt = nodeTxt &amp; Space(80 - Len(nodeTxt &amp; nodeAmt)) &amp; nodeAmt\n                    .Add Key:=\"Node\" &amp; i, Text:=Trim(nodeTxt)\n                    nodePar1 = \"Node\" &amp; i\n                Case 1 'Level 1 node\n                    nodeTxt = nodeTxt &amp; Space(80 - Len(nodeTxt &amp; nodeAmt)) &amp; nodeAmt\n                    .Add Relative:=nodePar1, Relationship:=tvwChild, Key:=\"Node\" &amp; i, Text:=Trim(nodeTxt)\n                    nodePar2 = \"Node\" &amp; i\n                Case 2 'Level 2 node\n                    nodeTxt = nodeTxt &amp; Space(80 - Len(nodeTxt &amp; nodeAmt)) &amp; nodeAmt\n                    .Add Relative:=nodePar2, Relationship:=tvwChild, Key:=\"Node\" &amp; i, Text:=Trim(nodeTxt)\n                    nodePar3 = \"Node\" &amp; i\n            End Select\n\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p>Step 3 - Add the following code in <code>ThisWorkbook</code> to show the treeview</p>\n\n<pre><code>Private Sub Workbook_Open()\n    UserForm1.Show vbModeless\nEnd Sub\n</code></pre>\n\n<p>The result</p>\n\n<p><a href=\"https://i.stack.imgur.com/4ucdX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4ucdX.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": false, "score": 1, "last_activity_date": 1484602138, "last_edit_date": 1484602138, "creation_date": 1484601752, "answer_id": 41685183, "question_id": 41595710, "link": "https://stackoverflow.com/questions/41595710/collapse-expand-rows-in-section/41685183#41685183", "title": "Collapse/expand rows in section", "body": "<p>One possibility would be to add a button to each cell and to hide its children rows on <em>collapse</em> and display its children rows on <em>expand</em>. </p>\n\n<p>Each <code>Excel.Button</code> executes one common method <code>TreeNodeClick</code> where the <code>Click</code> method is called on corresponding instance of <code>TreeNode</code>. The child rows are hidden or displayed based on the actual caption of the button. </p>\n\n<p>At the beginning the source data range needs to be selected when the method <code>Main</code> is executed. Problem is that the collection of Tree-Nodes needs to be filled each time the sheet is opened. So the method <code>Main</code> needs to be executed when the sheet is opened othervise it won't work.</p>\n\n<hr>\n\n<p><em>Standard Module Code:</em></p>\n\n<pre><code>Option Explicit\n\nPublic treeNodes As VBA.Collection\n\nSub Main()\n    Dim b As TreeBuilder\n    Set b = New TreeBuilder\n    Set treeNodes = New VBA.Collection\n    ActiveSheet.Buttons.Delete\n    b.Build Selection, treeNodes\nEnd Sub\n\nPublic Sub TreeNodeClick()\n    Dim caller As String\n    caller = Application.caller\n    Dim treeNode As treeNode\n    Set treeNode = treeNodes(caller)\n    If Not treeNode Is Nothing Then\n        treeNode.Click\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><em>Class Module TreeNode:</em></p>\n\n<pre><code>Option Explicit\n\nPrivate m_button As Excel.Button\nPrivate m_children As Collection\nPrivate m_parent As treeNode\nPrivate m_range As Range\nPrivate Const Collapsed As String = \"+\"\nPrivate Const Expanded As String = \"-\"\nPrivate m_indentLevel As Integer\n\nPublic Sub Create(ByVal rng As Range, ByVal parent As treeNode)\nOn Error GoTo ErrCreate\n\n    Set m_range = rng\n    m_range.EntireRow.RowHeight = 25\n    m_indentLevel = m_range.IndentLevel\n    Set m_parent = parent\n    If Not m_parent Is Nothing Then _\n        m_parent.AddChild Me\n    Set m_button = rng.parent.Buttons.Add(rng.Left + 3 + 19 * m_indentLevel, rng.Top + 3, 19, 19)\n    With m_button\n        .Caption = Expanded\n        .Name = m_range.Address\n        .OnAction = \"TreeNodeClick\"\n        .Placement = xlMoveAndSize\n        .PrintObject = False\n    End With\n\n    With m_range\n        .VerticalAlignment = xlCenter\n        .Value = Strings.Trim(.Value)\n        .Value = Strings.String((m_indentLevel + 11) + m_indentLevel * 5, \" \") &amp; .Value\n    End With\n\n    Exit Sub\n\nErrCreate:\n    MsgBox Err.Description, vbCritical, \"TreeNode::Create\"\nEnd Sub\n\nPublic Sub Collapse(ByVal hide As Boolean)\n    If hide Then\n        m_range.EntireRow.Hidden = True\n    End If\n    m_button.Caption = Collapsed\n    Dim ch As treeNode\n    For Each ch In m_children\n        ch.Collapse True\n    Next\nEnd Sub\n\nPublic Sub Expand(ByVal unhide As Boolean)\n    If unhide Then\n        m_range.EntireRow.Hidden = False\n    End If\n    m_button.Caption = Expanded\n    Dim ch As treeNode\n    For Each ch In m_children\n        ch.Expand True\n    Next\nEnd Sub\n\nPublic Sub AddChild(ByVal child As treeNode)\n    m_children.Add child\nEnd Sub\n\nPrivate Sub Class_Initialize()\n    Set m_children = New VBA.Collection\nEnd Sub\n\nPublic Sub Click()\n    If m_button.Caption = Collapsed Then\n        Expand False\n    Else\n        Collapse False\n    End If\nEnd Sub\n\nPublic Property Get IndentLevel() As Integer\n    IndentLevel = m_indentLevel\nEnd Property\n\nPublic Property Get Cell() As Range\n    Set Cell = m_range\nEnd Property\n</code></pre>\n\n<hr>\n\n<p><em>Class Module TreeBuilder:</em></p>\n\n<pre><code>Option Explicit\n\nPublic Sub Build(ByVal source As Range, ByVal treeNodes As VBA.Collection)\n    Dim currCell As Range\n    Dim newNode As treeNode\n    Dim parentNode As treeNode\n    For Each currCell In source.Columns(1).Cells\n        Set parentNode = FindParent(currCell, source, treeNodes)\n        Set newNode = New treeNode\n        newNode.Create currCell, parentNode\n        treeNodes.Add newNode, currCell.Address\n    Next currCell\nEnd Sub\n\nPrivate Function FindParent(ByVal currCell As Range, ByVal source As Range, ByVal treeNodes As VBA.Collection) As treeNode\n    If currCell.IndentLevel = 0 Then\n        Exit Function\n    End If\n    Dim c As Range\n    Dim r As Integer\n    Set c = currCell\n    For r = currCell.Row - 1 To source.Rows(1).Row Step -1\n        Set c = c.offset(-1, 0)\n        If c.IndentLevel = currCell.IndentLevel - 1 Then\n            Set FindParent = treeNodes(c.Address)\n            Exit Function\n        End If\n    Next r\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><em>Result:</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/S0pJd.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S0pJd.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1696, "favorite_count": 2, "answer_count": 2, "score": 1, "last_activity_date": 1484602138, "creation_date": 1484151453, "last_edit_date": 1484361182, "question_id": 41595710, "link": "https://stackoverflow.com/questions/41595710/collapse-expand-rows-in-section", "title": "Collapse/expand rows in section", "body": "<p>I have data that is grouped into three successive categories in a grouping scheme like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/hMxlo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hMxlo.png\" alt=\"enter image description here\"></a></p>\n\n<p>So the overall group \"OCM\" is broken down into subgroups named \"N/A\", \"Financials\", \"Industrials\" etc, each of which are broken up into further subgroups. </p>\n\n<p>I have the same data in Excel, but unfortunately it is automaticlally formatted like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pwutG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pwutG.png\" alt=\"enter image description here\"></a></p>\n\n<p>Instead of grouping the sections, everything has been expanded out and there is just a space to indicate where a new subgroup begins. </p>\n\n<p>The data extends for several thousand rows, so grouping it by hand is impossible. Is there another way to group the data automatically, where a space indicates a subgroup?</p>\n\n<p>EDIT</p>\n\n<pre><code>Function indenture(r As Range) As Integer\nindenture = r.IndentLevel\nEnd Function\n</code></pre>\n\n<p>Then  <code>nodeOrd = Sheet1.Range(\"A\" &amp; i).IndentLevel</code> returns the correct indent level.</p>\n"}, {"tags": ["excel", "vba", "countif"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1484151839, "post_id": 41595296, "comment_id": 70394495, "body": "You are basing your <code>lastrow</code> variable on the &quot;table&quot; worksheet, column A, but then using it as the last row for your &quot;data&quot; sheet?  I think you need to base your <code>lastrow</code> variable on the &quot;data&quot; worksheet, rest of the code looks good."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7405528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b010084a1b6daef59ccc2fde02cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Gores Hamad", "link": "https://stackoverflow.com/users/7405528/gores-hamad"}, "edited": false, "score": 0, "creation_date": 1484211468, "post_id": 41595567, "comment_id": 70419231, "body": "I got a question, I have filtered data, but countif still counts all of the data, how can I count only the filtered data?"}, {"owner": {"reputation": 335, "user_id": 3866299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6ZBbc.jpg?s=128&g=1", "display_name": "Nathan Dudley", "link": "https://stackoverflow.com/users/3866299/nathan-dudley"}, "reply_to_user": {"reputation": 3, "user_id": 7405528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b010084a1b6daef59ccc2fde02cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Gores Hamad", "link": "https://stackoverflow.com/users/7405528/gores-hamad"}, "edited": false, "score": 0, "creation_date": 1484248264, "post_id": 41595567, "comment_id": 70443477, "body": "You would need to write your own function in VBA to handle this. It would essentially be a loop through the data with a counter. You could use the built-in InStr function to see if the the cell contains &quot; cookies &quot; and then check to see if the entire row is hidden or not."}], "tags": [], "owner": {"reputation": 335, "user_id": 3866299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6ZBbc.jpg?s=128&g=1", "display_name": "Nathan Dudley", "link": "https://stackoverflow.com/users/3866299/nathan-dudley"}, "is_accepted": true, "score": 1, "last_activity_date": 1484151850, "last_edit_date": 1484151850, "creation_date": 1484151044, "answer_id": 41595567, "question_id": 41595296, "link": "https://stackoverflow.com/questions/41595296/vba-countif-cant-look-in-other-sheet-and-bring-answer-back-to-original-sheet/41595567#41595567", "title": "(VBA) Countif can&#39;t look in other sheet and bring answer back to original sheet", "body": "<p>It looks like you should be getting the last row from the data sheet since that's the sheet you want the count from. Also, you should specify the sheets when defining a Range. I prefer to use the \"Cells\" syntax.</p>\n\n<pre><code>Sub count_cookies()\n\n  lastRow = Worksheets(\"data\").Cells(Rows.Count, 1).End(xlUp).Row\n  Worksheets(\"table\").Cells(6, 2) = WorksheetFunction.CountIf(Range(Sheets(\"data\").Cells(2, \"a\"), Sheets(\"data\").Cells(lastRow, \"a\")), \"* cookies *\")\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7405528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b010084a1b6daef59ccc2fde02cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Gores Hamad", "link": "https://stackoverflow.com/users/7405528/gores-hamad"}, "edited": false, "score": 0, "creation_date": 1484211405, "post_id": 41595854, "comment_id": 70419202, "body": "I got a question, I have filtered data, but countif still counts all of the data, how can I count only the filtered data?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1484151883, "creation_date": 1484151883, "answer_id": 41595854, "question_id": 41595296, "link": "https://stackoverflow.com/questions/41595296/vba-countif-cant-look-in-other-sheet-and-bring-answer-back-to-original-sheet/41595854#41595854", "title": "(VBA) Countif can&#39;t look in other sheet and bring answer back to original sheet", "body": "<p>you could try this:</p>\n\n<pre><code>With Worksheets(\"table\")\n    With .Range(\"A2\", .Cells(.Rows.Count, 1).End(xlUp))\n        .Cells(6, 2).Value = WorksheetFunction.CountIf(Worksheets(\"data\").Range(.Address), \"* cookies *\")\n    End With\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7405528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b010084a1b6daef59ccc2fde02cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Gores Hamad", "link": "https://stackoverflow.com/users/7405528/gores-hamad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1383, "favorite_count": 0, "accepted_answer_id": 41595567, "answer_count": 2, "score": 0, "last_activity_date": 1484211436, "creation_date": 1484150226, "last_edit_date": 1484211436, "question_id": 41595296, "link": "https://stackoverflow.com/questions/41595296/vba-countif-cant-look-in-other-sheet-and-bring-answer-back-to-original-sheet", "title": "(VBA) Countif can&#39;t look in other sheet and bring answer back to original sheet", "body": "<p>I have an excel file with an unknown end range (which changes every time) and I want to know the amount of rows that the specific word comes back in that data table.</p>\n\n<p>It is just one column, and I have tried so many different methods but I still do not know the solution to it.</p>\n\n<p>This is the VBA code:</p>\n\n<pre><code>Sub count_cookies()\n\nlastrow = Worksheets(\"table\").Cells(Rows.Count, 1).End(xlUp).Row\nWorksheets(\"table\").Cells(6, 2) = WorksheetFunction.CountIf(Range(\"data!A2:A\" &amp; lastrow), \"* cookies *\")\nEnd Sub\n</code></pre>\n\n<p>So I want the amount counted from sheet \"data\" to sheet \"table\", but what am I doing wrong?</p>\n\n<p>EDIT: I got a question, I have filtered data, but countif still counts all of the data, how can I count only the filtered data? IS there a different formula for this?</p>\n"}, {"tags": ["vba", "excel", "dictionary", "scripting"], "comments": [{"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1484150376, "post_id": 41595244, "comment_id": 70393482, "body": "I&#39;m not sure if the picture in your link is small enough, could you make it tinier please?"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 2, "creation_date": 1484153554, "post_id": 41595244, "comment_id": 70395546, "body": "Sadly not on the points front, but I won&#39;t down vote you, and I&#39;ll tell you why your question is not great, and why I&#39;ll flag it to be closed.  You&#39;re looking to return info based on mouse position(as far as i can tell this is your main question), but you don&#39;t mention this in the title.  You include no code and show no research effort.  On the positive side, the answer is that there is no mouse position/ hover event in vba (kinda not so positive really).  And you could use a dictionary I guess... but as part of a much bigger section of code.  I&#39;m sorry you need to make this question better"}, {"owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "reply_to_user": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1484181030, "post_id": 41595244, "comment_id": 70408914, "body": "Hi, Thanks, Actually I am not looking for a mouse over reaction. I just want a smooth reply to the users. As I mentioned in my post, even a cell value result (something that can I put it in a cell) is ok. By the way I dont know waht the reputation stands for, Just it dosen&#39;t let me to give positive feedback to the others. It is why I asked for it. otherwise I am not a professional developer. Thanks anyway. and If you found it ok to give a negative point. No worry go ahead. Regards,"}], "answers": [{"tags": [], "owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "is_accepted": true, "score": 0, "last_activity_date": 1484310029, "creation_date": 1484310029, "answer_id": 41634540, "question_id": 41595244, "link": "https://stackoverflow.com/questions/41595244/returning-a-quick-statistical-info-for-a-cell-as-a-comment/41634540#41634540", "title": "Returning a quick statistical info for a cell as a comment", "body": "<p>For the record, I came to this answer from one of friends in MrExcel froum. Hope you find it usefull. \nThe just difference is, I was looking for a momentum reply just for an active cell, but this code, provide all the information for all the order names as a comment. but it is very easy to adjust!</p>\n\n<pre><code>Sub UpdateComments()\nDim c As Variant, strComment As String\nDim intISSUED As Integer, intSHORTAGE As Integer\nDim tblDATA As ListObject, tblDASH As ListObject\nSet tblDATA = Application.Range(\"TBL.data\").ListObject 'adjust Table Name\nSet tblDASH = Application.Range(\"TBL.dash\").ListObject 'adjust Table Name\nFor Each c In tblDASH.ListColumns(\"W/B\").DataBodyRange\n    strComment = \"\"\n    intISSUED = Application.CountIfs(tblDATA.ListColumns(\"Work Book\").DataBodyRange, c, tblDATA.ListColumns(\"Stage\").DataBodyRange, \"Issued\")\n    strComment = strComment &amp; Chr(10) &amp; \"Issued: \" &amp; intISSUED\n    intSHORTAGE = Application.CountIfs(tblDATA.ListColumns(\"Work Book\").DataBodyRange, c,tblDATA.ListColumns(\"Stage\").DataBodyRange, \"Shortage\")\n    strComment = strComment &amp; Chr(10) &amp; \"Shortage: \" &amp; intSHORTAGE\n    '  ADDITIONAL 'STAGES' HERE\n    '  OR put 'stages' in array to condense code\n    With Sheets(tblDASH.Parent.Name).Range(c.Address)\n        If .Comment Is Nothing Then\n            .AddComment\n            .Comment.Visible = False\n        End If\n        .Comment.Text Text:=Mid(strComment, 2)\n    End With\nNext c\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 1, "accepted_answer_id": 41634540, "answer_count": 1, "score": 0, "last_activity_date": 1484310029, "creation_date": 1484150073, "last_edit_date": 1531164843, "question_id": 41595244, "link": "https://stackoverflow.com/questions/41595244/returning-a-quick-statistical-info-for-a-cell-as-a-comment", "title": "Returning a quick statistical info for a cell as a comment", "body": "<p>I have a long list of data on an excel table. This data includes detail information of each order in several rows. There is a column shows the status of each row. Also, I have a dashboard which just lists out the order names. I want the users to be able to see a short statistical info of each book as a comment or when they mouse over the cell, if possible or as a cell data. The info could be something like underneath sample in 3 or 4 row. (The number of items is the count of rows with the same status)</p>\n\n<blockquote>\n  <p>5 issued item\n   3 shortage items\n   2 Done items\n   X other</p>\n</blockquote>\n\n<p>If you just give me the general idea it would be great.\nI think I have to use a collection procedure, something like \"scripting dictionary\" but I have no experience using them. I know how to do that by putting a case statement after if clause inside a loop, but I am looking for a smarter way. you can find some pictures and a sample data below: <a href=\"https://1drv.ms/x/s!ArGi1KRQ5iItgYwUIlw2-u6kMhGlVQ\" rel=\"nofollow noreferrer\">sample</a> <a href=\"https://s23.postimg.org/4vrbe361n/order_comment_info.jpg\" rel=\"nofollow noreferrer\">pictures</a></p>\n"}, {"tags": ["excel", "correlation", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7405383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01326e8da1eed8e641044fa47f989cfe?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/7405383/eugene"}, "edited": false, "score": 0, "creation_date": 1484265122, "post_id": 41625117, "comment_id": 70451473, "body": "Figured it out. This worked for me, FYI, this code pastes values on another sheet. Hope this works for someone else."}], "tags": [], "owner": {"reputation": 3, "user_id": 7405383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01326e8da1eed8e641044fa47f989cfe?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/7405383/eugene"}, "is_accepted": false, "score": 0, "last_activity_date": 1484265045, "creation_date": 1484265045, "answer_id": 41625117, "question_id": 41595215, "link": "https://stackoverflow.com/questions/41595215/how-to-pull-values-from-correlation-table-applying-criteria/41625117#41625117", "title": "How to pull values from correlation table applying criteria?", "body": "<pre><code>Sub extract()\n\nWorksheets(\"Matrix\").Select\nRange(\"A1\").Select\n\nDim Row As Long\n\nDim Col As Long\n\n\nx = 1\n\ny = 1\n\ni = 0\n\nWorksheets(\"Paste\").Cells.ClearContents\nWorksheets(\"Paste\").Range(\"A1\") = \"X\"\nWorksheets(\"Paste\").Range(\"B1\") = \"Y\"\nWorksheets(\"Paste\").Range(\"C1\") = \"Value\"\n\nWorksheets(\"Matrix\").Activate\nRow = Worksheets(\"Matrix\").Range(\"A1\",        Worksheets(\"Matrix\").Range(\"A1\").End(xlDown)).Rows.Count\nCol = Worksheets(\"Matrix\").Range(\"A1\",     Worksheets(\"Matrix\").Range(\"A1\").End(xlToRight)).Columns.Count\n\n\nIf Row &lt;&gt; Col Then\nMsgBox \"ERROR: Matrix is not symmetrical, can't be a correlation matrix\"\n\nExit Sub\n\nEnd If\n\nFor x = 1 To Row\n\n    For y = 1 To Col\n\n        If Cells(y, x) &gt; 1 Then\n        Cells(y, x).Copy\n        Worksheets(\"pegar\").Range(\"C2\").Offset(RowOffset:=i).PasteSpecial xlPasteValues\n        Worksheets(\"paste\").Range(\"B2\").Offset(RowOffset:=i).Value = y\n        Worksheets(\"paste\").Range(\"A2\").Offset(RowOffset:=i).Value = x\n        i = i + 1\n\n    End If\n\nNext y\n\n\nNext x\n\nWorksheets(\"paste\").Select\nMsgBox \"values extracted\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7405383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01326e8da1eed8e641044fa47f989cfe?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/7405383/eugene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484265045, "creation_date": 1484149969, "last_edit_date": 1531161705, "question_id": 41595215, "link": "https://stackoverflow.com/questions/41595215/how-to-pull-values-from-correlation-table-applying-criteria", "title": "How to pull values from correlation table applying criteria?", "body": "<p>I'm currently in need of extracting cell values from a correlation table that fit a certain profile, e.g. \"&lt;0.6\". This could an easy enough manual task if it weren't for the fact that I'm running correlation coefficients for >4,000 items. The idea for the output would be to create another table with a concatenate column showing the items involved and another column containing the value for the correlation of those items.</p>\n\n<p>I'd imagine that VBA would be the way to go but maybe there's some other faster and simpler way I could be overlooking.</p>\n\n<p>Any help would be much appreciated!</p>\n\n<p>Thanks in advance :)</p>\n"}, {"tags": ["vba", "goto"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7401157, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c0f8aa6e2108dda72faaeab8702a58de?s=128&d=identicon&r=PG&f=1", "display_name": "VVV", "link": "https://stackoverflow.com/users/7401157/vvv"}, "edited": false, "score": 0, "creation_date": 1484148841, "post_id": 41594833, "comment_id": 70392492, "body": "can you elaborate it a little bit? I don&#39;t get how it works"}], "tags": [], "owner": {"reputation": 1438, "user_id": 7381844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472a02745987037a063febc591fbb937?s=128&d=identicon&r=PG&f=1", "display_name": "jBuchholz", "link": "https://stackoverflow.com/users/7381844/jbuchholz"}, "is_accepted": false, "score": 0, "last_activity_date": 1484148784, "creation_date": 1484148784, "answer_id": 41594833, "question_id": 41594760, "link": "https://stackoverflow.com/questions/41594760/on-error-goto-inside-an-if-does-it-react-to-any-error-on-the-sub/41594833#41594833", "title": "On error goto inside an if, does it react to any error on the sub?", "body": "<p>Only if the if-clause is executed.\nWith <code>On Error GoTo 0</code> you can turn off your error handler at the end of the if-clause.</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 7401157, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c0f8aa6e2108dda72faaeab8702a58de?s=128&d=identicon&r=PG&f=1", "display_name": "VVV", "link": "https://stackoverflow.com/users/7401157/vvv"}, "edited": false, "score": 0, "creation_date": 1484148944, "post_id": 41594848, "comment_id": 70392544, "body": "If I do that, and the <code>Error_handler</code> triggers the <code>On Error Goto 0</code> is not going to activate right?"}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "reply_to_user": {"reputation": 9, "user_id": 7401157, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c0f8aa6e2108dda72faaeab8702a58de?s=128&d=identicon&r=PG&f=1", "display_name": "VVV", "link": "https://stackoverflow.com/users/7401157/vvv"}, "edited": false, "score": 1, "creation_date": 1484149145, "post_id": 41594848, "comment_id": 70392682, "body": "<code>On Error GoTo 0</code> turns off any error handling. VBA will just stop at the line where error is encountered (as it usually does). You can do that in <code>Error_handler</code>, but it is wrong way to do it. In <code>Error_handler</code> you should use <code>Resume</code> or go to another label. It is good practice to either turn on error handling for entire sub and handle all errors, or turn the error handling on and off &quot;at the same level&quot; - aka like in my example above."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1484149433, "post_id": 41594848, "comment_id": 70392877, "body": "Looks like the <a href=\"http://stackoverflow.com/documentation/vba/3211/error-handling#t=201701111543262206472\">On Error Statement</a> documentation needs to mention this :-)"}], "tags": [], "owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "is_accepted": true, "score": 3, "last_activity_date": 1484148846, "creation_date": 1484148846, "answer_id": 41594848, "question_id": 41594760, "link": "https://stackoverflow.com/questions/41594760/on-error-goto-inside-an-if-does-it-react-to-any-error-on-the-sub/41594848#41594848", "title": "On error goto inside an if, does it react to any error on the sub?", "body": "<p>In your example, anything executed after the <code>On Error</code> statement will go to the error handler label, even after the <code>End If</code> statement. If you want to turn off this error handler you need to reset it as follows:</p>\n\n<pre><code>If CheckF = 0 Then\n    On Error GoTo Error_handler\n    .PivotItems(.PivotItems(pivotcount).name).Visible = False\n    On Error GoTo 0\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7401157, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c0f8aa6e2108dda72faaeab8702a58de?s=128&d=identicon&r=PG&f=1", "display_name": "VVV", "link": "https://stackoverflow.com/users/7401157/vvv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 1, "accepted_answer_id": 41594848, "answer_count": 2, "score": 0, "last_activity_date": 1484149029, "creation_date": 1484148570, "last_edit_date": 1484149029, "question_id": 41594760, "link": "https://stackoverflow.com/questions/41594760/on-error-goto-inside-an-if-does-it-react-to-any-error-on-the-sub", "title": "On error goto inside an if, does it react to any error on the sub?", "body": "<p>I have a question about the <code>On Error GoTo</code>. I have this line of code </p>\n\n<pre><code>    If CheckF = 0 Then\n        On Error GoTo Error_handler\n        .PivotItems(.PivotItems(pivotcount).name).Visible = False\n\n\n    End If\n</code></pre>\n\n<p>My question is that if I have an error outside that <code>if</code> it trigger the <code>On Error</code> anyway</p>\n\n<p>And if that is the case, I would like to have a way to avoid it, because I need a different kind of message for each different error.</p>\n\n<p>I hope I explained myself.  </p>\n"}, {"tags": ["html", "vba", "excel", "hyperlink"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1484148215, "post_id": 41594608, "comment_id": 70392080, "body": "You can&#39;t start with an ampersand."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484148481, "post_id": 41594608, "comment_id": 70392256, "body": "remove the first <code>&amp;</code> from your string. It should be <code>Email_Body = PN &amp; &quot; has failed for appearance issues and requires a   marketing disposition. This part has been cleared by engineering. Please see NCR number &quot; &amp; NCR &amp; &quot;in NCR Log for more details.&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 156, "user_id": 7248735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VRmCj.jpg?s=128&g=1", "display_name": "R. McIntosh", "link": "https://stackoverflow.com/users/7248735/r-mcintosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1484148490, "creation_date": 1484148490, "answer_id": 41594735, "question_id": 41594608, "link": "https://stackoverflow.com/questions/41594608/email-in-vba-adding-links/41594735#41594735", "title": "Email in VBA: Adding links", "body": "<p>The string concatenation operator &amp; (or +) requires an operand on each side.</p>\n\n<pre><code>Email_Body = &amp; PN &amp; \" has failed for ap\n</code></pre>\n\n<p>Should be</p>\n\n<pre><code>Email_Body = PN &amp; \" has failed for ap\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1484159292, "post_id": 41595271, "comment_id": 70398969, "body": "You may or may not have just made me cry in relief. Thank you so so so much."}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "reply_to_user": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1484161638, "post_id": 41595271, "comment_id": 70400268, "body": "No problem, if it works please accept it as the answer, otherwise let me know :)"}, {"owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1484253274, "post_id": 41595271, "comment_id": 70446318, "body": "Unfortunately the link isn&#39;t quite working all the way. I&#39;ve edited my post so you can see where I&#39;m at now. Any idea as to why it&#39;s not taking the whole thing?"}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "reply_to_user": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1484254654, "post_id": 41595271, "comment_id": 70447026, "body": "Can you give me an example of the data that would be stored in NCR and PN?"}, {"owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1484257239, "post_id": 41595271, "comment_id": 70448406, "body": "NCR will always be a 5 digit number and PN will be a number from 4 digits to over 10, depending"}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "reply_to_user": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1484297729, "post_id": 41595271, "comment_id": 70461276, "body": "@ladymrt have you got an example of the link? E.g. R:\\Quality\\12345&#39;s\\12345 123456.xlsm"}, {"owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1484325915, "post_id": 41595271, "comment_id": 70478712, "body": "R:\\Quality\\NCR&#39;s\\NCR 12345 123456.xlsm"}, {"owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1484326377, "post_id": 41595271, "comment_id": 70479012, "body": "the first two instances of the letters &quot;NCR&quot; need to be as is. The folder these forms are in is literally called &quot;NCR&#39;s&quot;. The naming convention for these files is &quot;NCR&quot; [the NCR #] [the part number].xlsm"}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "reply_to_user": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1484329423, "post_id": 41595271, "comment_id": 70480737, "body": "Ok, well if that&#39;s the case I think the line should be <code>my_hyperlink = &quot;R:\\Quality\\NCR&#39;s\\NCR&quot; &amp; &quot; &quot; &amp; NCR &amp; &quot; &quot; &amp; PN &amp; &quot;.xlsm&quot;</code>"}, {"owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1484330405, "post_id": 41595271, "comment_id": 70481302, "body": "Still only pulling up to the first end-quotes (R:\\Quality\\NCR&#39;s\\NCR) wondering why the &amp; statements aren&#39;t getting included? Thank you very much for all your help!"}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "reply_to_user": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1484330565, "post_id": 41595271, "comment_id": 70481402, "body": "Try double quoting, so <code>my_hyperlink = &quot;&quot;R:\\Quality\\NCR&#39;s\\NCR&quot;&quot; &amp; &quot;&quot; &quot;&quot; &amp; NCR &amp; &quot;&quot; &quot;&quot; &amp; PN &amp; &quot;&quot;.xlsm&quot;&quot;</code>"}, {"owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1484341716, "post_id": 41595271, "comment_id": 70486767, "body": "reds it out and gives me a syntax error with the whole line highlighted."}, {"owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1484346286, "post_id": 41595271, "comment_id": 70488603, "body": ".HTMLBody = PN &amp; &quot; has failed for appearance issues and requires a marketing disposition. This part has been cleared by engineering. Please see NCR number &quot; &amp; NCR &amp; &quot; in NCR Log for more details.  &lt;a href=&quot;&quot;&quot; &amp; my_hyperlink &amp; &quot;&quot;&quot;&gt;NCR &quot; &amp; NCR &amp; &quot;&lt;/a&gt;&quot;"}, {"owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1484346324, "post_id": 41595271, "comment_id": 70488617, "body": "Triple quoting the link in the actual body of the email actually fixed it. Thank you again times a million for all of your help, I would not have been able to do this without ya!"}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "reply_to_user": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1484472811, "post_id": 41595271, "comment_id": 70517886, "body": "No problem, the syntax is sometimes quite odd! Thanks for accepting the answer, could you also vote it up please."}, {"owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1484678810, "post_id": 41595271, "comment_id": 70605130, "body": "I&#39;m too new for my votes to count visibly, but sure thing!"}], "tags": [], "owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "is_accepted": true, "score": 0, "last_activity_date": 1484150148, "creation_date": 1484150148, "answer_id": 41595271, "question_id": 41594608, "link": "https://stackoverflow.com/questions/41594608/email-in-vba-adding-links/41595271#41595271", "title": "Email in VBA: Adding links", "body": "<p>As others have indicated, the line:</p>\n\n<pre><code>Email_Body = &amp; PN &amp; \" has failed for appearance issues and requires a   marketing disposition. This part has been cleared by engineering. Please see NCR number \" &amp; NCR &amp; \"in NCR Log for more details.\"\n</code></pre>\n\n<p>Should be changed to:</p>\n\n<pre><code>Email_Body = PN &amp; \" has failed for appearance issues and requires a   marketing disposition. This part has been cleared by engineering. Please see NCR number \" &amp; NCR &amp; \"in NCR Log for more details.\"\n</code></pre>\n\n<p>As you do not need an ampersand at the start.</p>\n\n<p>In terms of the hyperlink, you could do the following:</p>\n\n<pre><code>dim my_hyperlink as string\nmy_hyperlink = \"R:\\Quality\\\" &amp; NCR &amp; \"'s\\\" &amp; NCR &amp; \" \" &amp; PN &amp; \".xlsm\"\n</code></pre>\n\n<p>In order to add this into the email you should use <code>.HTMLBody</code> and so replace the lines you have with these (I've added the hyperlink at the end of your sentence):</p>\n\n<pre><code>Email_Body = PN &amp; \" has failed for appearance issues and requires a   marketing disposition. This part has been cleared by engineering. Please see NCR number \" &amp; NCR &amp; \"in NCR Log for more details. The hyperlink is &lt;a href=\" &amp; my_hyperlink &amp; \"&gt;click here&lt;/a&gt;\"\n\nWith Mail_Single\n.Subject = Email_Subject\n.To = Email_Send_To\n.cc = Email_Cc\n.BCC = Email_Bcc\n.HTMLBody = Email_Body\n.send\nEnd With\n</code></pre>\n\n<p>For efficiency and readability, you could change your code to:</p>\n\n<pre><code>Sub emailmarketing()\n\nDim Email_Subject, Email_Send_From, Email_Send_To, _\nEmail_Cc, Email_Bcc, Email_Body As String\nDim Mail_Object, Mail_Single As Variant\nDim PN As String\nDim NCR As String\n\nPN = Worksheets(\"Sheet1\").Range(\"C12\").Value\nNCR = Worksheets(\"Sheet1\").Range(\"I4\").Value\n\nOn Error GoTo debugs\nSet Mail_Object = CreateObject(\"Outlook.Application\")\nSet Mail_Single = Mail_Object.CreateItem(0)\nWith Mail_Single\n.Subject = \"Non-Conformance Report: Part Failed Appearance\"\n.To = \"me@workemail.com\"\n.cc = \"me@workemail.com\"\n.HTMLBody = PN &amp; \" has failed for appearance issues and requires a   marketing disposition. This part has been cleared by engineering. Please see NCR number \" &amp; NCR &amp; \"in NCR Log for more details. The hyperlink is &lt;a href=\" &amp; my_hyperlink &amp; \"&gt;click here&lt;/a&gt;\"\n.send\nEnd With\ndebugs:\nIf Err.Description &lt;&gt; \"\" Then MsgBox Err.Description\n\nEnd Sub\n</code></pre>\n\n<p>Let me know if this works :)</p>\n"}], "owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 41595271, "answer_count": 2, "score": 0, "last_activity_date": 1484253233, "creation_date": 1484148158, "last_edit_date": 1484253233, "question_id": 41594608, "link": "https://stackoverflow.com/questions/41594608/email-in-vba-adding-links", "title": "Email in VBA: Adding links", "body": "<p>For some reason, this is only putting the path up to the specified NCR number (i.e. R:\\Quality\\NCR's[the NCR number here] and that's it). I cannot figure out why it's not pulling the rest of the information (the PN and the .xlsm) into the link. Please help!</p>\n\n<pre><code>Dim Email_Subject, Email_Send_From, Email_Send_To, _\nEmail_Cc, Email_Bcc, Email_Body As String\nDim Mail_Object, Mail_Single As Variant\nDim PN As String\nDim NCR As String\nDim my_hyperlink As String\n\n\n\nPN = Worksheets(\"Sheet1\").Range(\"C12\").Value\nNCR = Worksheets(\"Sheet1\").Range(\"I4\").Value\n\nmy_hyperlink = \"R:\\Quality\\NCR's\\\" &amp; NCR &amp; \" \" &amp; PN &amp; \".xlsm\"\n\nOn Error GoTo debugs\nSet Mail_Object = CreateObject(\"Outlook.Application\")\nSet Mail_Single = Mail_Object.CreateItem(0)\nWith Mail_Single\n.Subject = \"NCR: Part Failed Appearance\"\n.To = \"me@workemail.com\"\n.cc = \"me@workemail.com\"\n.HTMLBody = PN &amp; \" has failed for appearance issues and requires a marketing disposition. This part has been cleared by engineering. Please see NCR number \" &amp; NCR &amp; \" in NCR Log for more details. See the Report &lt;a href=\" &amp; my_hyperlink &amp; \"&gt;Here&lt;/a&gt;\"\n.send\nEnd With\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 80, "user_id": 7396650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8723cf709a4b6c27acbd947cb4048645?s=128&d=identicon&r=PG&f=1", "display_name": "Phesago", "link": "https://stackoverflow.com/users/7396650/phesago"}, "edited": false, "score": 0, "creation_date": 1484149752, "post_id": 41594737, "comment_id": 70393072, "body": "dude you are awesome!"}], "tags": [], "owner": {"reputation": 1438, "user_id": 7381844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472a02745987037a063febc591fbb937?s=128&d=identicon&r=PG&f=1", "display_name": "jBuchholz", "link": "https://stackoverflow.com/users/7381844/jbuchholz"}, "is_accepted": true, "score": 3, "last_activity_date": 1484148498, "creation_date": 1484148498, "answer_id": 41594737, "question_id": 41594468, "link": "https://stackoverflow.com/questions/41594468/ms-access-recordcount-returns-a-valid-number-but-getrows-only-pulls-one-record/41594737#41594737", "title": "MS-Access RecordCount Returns a valid number, but .GetRows only pulls one record", "body": "<p>GetRows also uses the recordset's pointer. With <code>rs.MoveLast</code> you put that pointer to the last row. That's why only one row gets returned. Add<code>rs.MoveFirst</code> after setting <code>Q</code> to resolve this.</p>\n"}, {"tags": [], "owner": {"reputation": 273, "user_id": 6490191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/892b65d788a19cd018c74394494fc302?s=128&d=identicon&r=PG&f=1", "display_name": "Steve W", "link": "https://stackoverflow.com/users/6490191/steve-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1484168770, "creation_date": 1484168770, "answer_id": 41600687, "question_id": 41594468, "link": "https://stackoverflow.com/questions/41594468/ms-access-recordcount-returns-a-valid-number-but-getrows-only-pulls-one-record/41600687#41600687", "title": "MS-Access RecordCount Returns a valid number, but .GetRows only pulls one record", "body": "<p>Like Phesago mentioned, Access will only return the recordcount based on which record in the recordset it's looking at.  As a general practice when working with recordsets, I always begin with the following template:</p>\n\n<pre><code>Private Sub CreateRecordset()\n    Dim rs As Recordset\n    Dim sql As String\n\n    sql = \"SELCT * FROM tblSomeTable\"\n\n    Set rs = CurrentDb.OpenRecordset(sql, dbOpenDynaset, dbSeeChanges)\n\n    With rs\n        If Not .EOF And Not .BOF Then\n            .MoveLast\n            .MoveFirst\n\n            Dim i As Integer\n\n            For i = 0 To rs.RecordCount - 1\n                'do whatever actions desired\n\n\n\n            Next\n\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 80, "user_id": 7396650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8723cf709a4b6c27acbd947cb4048645?s=128&d=identicon&r=PG&f=1", "display_name": "Phesago", "link": "https://stackoverflow.com/users/7396650/phesago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 41594737, "answer_count": 2, "score": 1, "last_activity_date": 1484168770, "creation_date": 1484147762, "question_id": 41594468, "link": "https://stackoverflow.com/questions/41594468/ms-access-recordcount-returns-a-valid-number-but-getrows-only-pulls-one-record", "title": "MS-Access RecordCount Returns a valid number, but .GetRows only pulls one record", "body": "<p>Ok I am trying to dynamically get recordCount and pass that to .GetRows but it doesnt work as it only pulls in one records into the array. If I just statically put a number into the .GetRows method it works fine, but this is obviously not ideal. </p>\n\n<p><strong>This Works</strong></p>\n\n<pre><code>Set rs = CurrentDb.OpenRecordset(\"SELECT * FROM Client\", dbOpenDynaset, dbSeeChanges)\naRR = rs.GetRows(\"random number\")\nFor i = 0 To rs.RecordCount - 1\n    For j = 0 To rs.Fields.Count - 1\n        Debug.Print ; aRR(j, i)\n    Next j\nNext i\n</code></pre>\n\n<p><strong>This does not</strong></p>\n\n<pre><code>Set rs = CurrentDb.OpenRecordset(\"SELECT * FROM Client\", dbOpenDynaset, dbSeeChanges)\nWith rs\n    rs.MoveLast\n    Debug.Print ; rs.RecordCount\n    Q = rs.RecordCount\n    aRR = rs.GetRows(Q)\nEnd With\nFor i = 0 To rs.RecordCount - 1\n    For j = 0 To rs.Fields.Count - 1\n        Debug.Print ; aRR(j, i)\n    Next j\nNext i\n</code></pre>\n\n<p>I have tried multiple things I have found on the web but clearly I must be missing something? Is there an easy approach to this or do i need to requery with a DISTINCT clase, and pass the return value within that record set to a new variable?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1484146456, "post_id": 41593572, "comment_id": 70390928, "body": "IMO your question / problem description is hard to follow. I&#39;d suggest adding a cropped screenshot or two."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1484146464, "post_id": 41593572, "comment_id": 70390939, "body": "in the array, split again, spit(a,&quot;=&quot;)"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1484146562, "post_id": 41593572, "comment_id": 70391013, "body": "For unique values, would you not want to look at: <a href=\"http://www.ozgrid.com/forum/showthread.php?t=160873\" rel=\"nofollow noreferrer\">ozgrid.com/forum/showthread.php?t=160873</a> ?"}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1484146544, "creation_date": 1484146544, "answer_id": 41594022, "question_id": 41593572, "link": "https://stackoverflow.com/questions/41593572/vba-output-new-collection-to-single-cell/41594022#41594022", "title": "VBA Output new collection to single cell", "body": "<p>in the array, <code>split</code> again, <code>spit(a,\"=\")</code> adding index 1 to another array, not a collection, then use <code>JOIN</code> to put it back together</p>\n\n<pre><code>x=0\nredim arrOutput(ubound(ary))\nFor Each a In ary\n    arrOutput(x)= split(a,\"=\")(1)\n    x=x+1\nNext\n\nrange(\"b1\")=join(arrOutput,\",\")\n</code></pre>\n\n<p>or just split by = and take odd numbers from the resulting array maybe?</p>\n"}, {"tags": [], "owner": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "is_accepted": false, "score": 0, "last_activity_date": 1484147474, "creation_date": 1484147474, "answer_id": 41594348, "question_id": 41593572, "link": "https://stackoverflow.com/questions/41593572/vba-output-new-collection-to-single-cell/41594348#41594348", "title": "VBA Output new collection to single cell", "body": "<p>If you need to hold something unique - always think about dictionary, cause of <code>Exists</code> method. Here's a small example:</p>\n\n<pre><code>Sub test()\n    Dim NonUniqueValues As Variant\n    Dim UniqueValues As Object\n    Dim i As Long\n\n    'gather source array\n    NonUniqueValues = Union([A1], [A2], [A3], [A4]).Value2\n\n    'set dict\n    Set UniqueValues = CreateObject(\"Scripting.Dictionary\")\n\n    'loop over array\n    For i = LBound(NonUniqueValues, 1) To UBound(NonUniqueValues, 1)\n        If Not UniqueValues.Exists(NonUniqueValues(i, 1)) Then _\n                Call UniqueValues.Add(Key:=NonUniqueValues(i, 1), Item:=NonUniqueValues(i, 1))\n    Next\n\n    'output\n    [B1] = Join(UniqueValues.Keys, \",\")\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/F4THX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F4THX.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 138, "user_id": 2284877, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/041b5353112512851f3a4897b1b2ce26?s=128&d=identicon&r=PG", "display_name": "user2284877", "link": "https://stackoverflow.com/users/2284877/user2284877"}, "edited": false, "score": 0, "creation_date": 1484207596, "post_id": 41594380, "comment_id": 70417147, "body": "thank you. your solution is the clearest and simple, even i need to quit the initial concatenation"}, {"owner": {"reputation": 191, "user_id": 1815210, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/57ca0244e20d7f6b6c48a27bc8f01616?s=128&d=identicon&r=PG", "display_name": "gimmegimme", "link": "https://stackoverflow.com/users/1815210/gimmegimme"}, "edited": false, "score": 0, "creation_date": 1532561472, "post_id": 41594380, "comment_id": 90026365, "body": "Also, if you selected the rows with your mouse &amp; cursor, you could replace the argument (&quot;A1:A4&quot;) with Selection.Address:           For Each cell In Range(Selection.Address)"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 2, "last_activity_date": 1484147537, "creation_date": 1484147537, "answer_id": 41594380, "question_id": 41593572, "link": "https://stackoverflow.com/questions/41593572/vba-output-new-collection-to-single-cell/41594380#41594380", "title": "VBA Output new collection to single cell", "body": "<p>you could use a late binding \"on the fly\" <code>Dictionary</code> object:</p>\n\n<pre><code>Sub main()\n    Dim cell As Range\n\n    With CreateObject(\"Scripting.Dictionary\")\n        For Each cell In Range(\"A1:A4\") '&lt;--| change \"A1:A4\" to whatever range you need\n            .Item(cell.Value) = .Item(cell.Value) + 1\n        Next cell\n        Range(\"B1\").Value = Join(.keys, \",\")\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1484147588, "creation_date": 1484147588, "answer_id": 41594399, "question_id": 41593572, "link": "https://stackoverflow.com/questions/41593572/vba-output-new-collection-to-single-cell/41594399#41594399", "title": "VBA Output new collection to single cell", "body": "<p>Perhaps:</p>\n\n<pre><code>Public Function KonKat(rng As Range) As String\n    Dim c As Collection, r As Range, i As Long\n\n    Set c = New Collection\n    On Error Resume Next\n        For Each r In rng\n            c.Add r.Value, CStr(r.Value)\n        Next r\n    On Error GoTo 0\n\n    For i = 1 To c.Count\n        KonKat = KonKat &amp; \",\" &amp; c.Item(i)\n    Next i\n        KonKat = Mid(KonKat, 2)\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/6Id8D.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6Id8D.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 138, "user_id": 2284877, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/041b5353112512851f3a4897b1b2ce26?s=128&d=identicon&r=PG", "display_name": "user2284877", "link": "https://stackoverflow.com/users/2284877/user2284877"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 491, "favorite_count": 0, "accepted_answer_id": 41594380, "answer_count": 4, "score": 0, "last_activity_date": 1484147588, "creation_date": 1484145172, "last_edit_date": 1531164843, "question_id": 41593572, "link": "https://stackoverflow.com/questions/41593572/vba-output-new-collection-to-single-cell", "title": "VBA Output new collection to single cell", "body": "<p>I need to get unique values from a range, in a specific cell.<br>\nA1=x, A2=y, A3=z, A4=x<br>\nI want to get B1=x,y,z<br>\nMy solution is:<br>\nconcatenate A1,A2,A3,A4, in B2.<br>\nsplit B2.<br>\nmake new collection from splitted B2.<br>\noutput collection elements into C1, C2, ..Ci<br>\nconcatenate C1, C2,..Ci into B1    </p>\n\n<p>Is possible to avoid to output collection into C1,C2 ? but output directly into B1 through some variable ?     </p>\n\n<pre><code>   '''''''  \nconcatenation part    \n''''''''\n    Dim ary As Variant\n    Dim Arr As New Collection, a\n    Dim i As Long\n    ary = split(Range(\"b2\"), \",\")\n\n    For Each a In ary\n    Arr.Add a, a\n    Next\n\n    For i = 1 To Arr.count\n    Cells(1, i+2) = Arr(i) ' output collection in some cells\n    Next\n    '''''''''''''''''''''''''\nconcatenation part\n'''''''''''\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "formatting", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7404962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58de15b4435bf593f39f55ea445d8c45?s=128&d=identicon&r=PG&f=1", "display_name": "Ian David", "link": "https://stackoverflow.com/users/7404962/ian-david"}, "is_accepted": false, "score": 0, "last_activity_date": 1538573546, "last_edit_date": 1538573546, "creation_date": 1484152513, "answer_id": 41596046, "question_id": 41593200, "link": "https://stackoverflow.com/questions/41593200/powerpoint-macro-to-format-table-position-size-font-alignment/41596046#41596046", "title": "Powerpoint macro to format table (position, size, font, alignment)", "body": "<p>I have played around a bit more, and I've answered my own question:</p>\n\n<pre><code>Sub format()\n\nDim s As Slide\nDim oSh As Shape\nDim oTbl As Table\nDim lRow As Long\nDim lCol As Long\n\nFor Each s In ActivePresentation.Slides\n    For Each oSh In s.Shapes\n        If oSh.HasTable Then\n            oSh.Left = 1 * 28.3\n            oSh.Top = 3 * 28.3\n            oSh.Width = 23.5 * 28.35\n            oSh.ZOrder msoSendToBack\n            Set oTbl = oSh.Table\n            For lRow = 1 To oTbl.Rows.Count\n               For lCol = 1 To oTbl.Columns.Count\n                With oTbl.Cell(lRow, lCol).Shape\n                    .TextFrame.TextRange.Font.Name = \"Calibri\"\n                    .TextFrame.TextRange.Font.Size = 7\n                    .TextFrame2.VerticalAnchor = msoAnchorMiddle\n                    oTbl.Rows(lRow).Height = 0.5\n                    End With\n                Next lCol\n            Next lRow\n        End If\n    Next oSh    \nNext s\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": false, "score": 0, "last_activity_date": 1484153562, "creation_date": 1484153562, "answer_id": 41596408, "question_id": 41593200, "link": "https://stackoverflow.com/questions/41593200/powerpoint-macro-to-format-table-position-size-font-alignment/41596408#41596408", "title": "Powerpoint macro to format table (position, size, font, alignment)", "body": "<p>I see you figured it out (good job!). One other useful thing relating to your need \"All row heights as small as possible\" is to just do this:</p>\n\n<pre><code>oSh.Height = 0\n</code></pre>\n\n<p>...sometimes a couple of times depending on the table's content.</p>\n"}], "owner": {"reputation": 1, "user_id": 7404962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58de15b4435bf593f39f55ea445d8c45?s=128&d=identicon&r=PG&f=1", "display_name": "Ian David", "link": "https://stackoverflow.com/users/7404962/ian-david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4136, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593729609, "creation_date": 1484144102, "last_edit_date": 1593729609, "question_id": 41593200, "link": "https://stackoverflow.com/questions/41593200/powerpoint-macro-to-format-table-position-size-font-alignment", "title": "Powerpoint macro to format table (position, size, font, alignment)", "body": "<p>I have a PowerPoint with about 10 slides, each slide has one table that needs to be formatted the same way.  I am using the below macro to format the text within the tables, but I dont know how to combine this code with other formatting such as row height and table position. </p>\n\n<p>Please can someone help me by adding to the below code the following preferences:</p>\n\n<ul>\n<li>Table horizontal position = 1cm from left</li>\n<li>Table vertical position = 3cm from top</li>\n<li>Table width = 23.5cm</li>\n<li>Table sent to back</li>\n<li>All row heights as small as posible</li>\n<li><p>All Text middle aligned (vertically)</p>\n\n<pre><code>Sub format()\n\nDim s As Slide\nDim oSh As Shape\nDim oTbl As Table\nDim lRow As Long\nDim lCol As Long\n\nFor Each s In ActivePresentation.Slides\n    For Each oSh In s.Shapes\n        If oSh.HasTable Then\n            Set oTbl = oSh.Table\n            For lRow = 1 To oTbl.Rows.Count\n                For lCol = 1 To oTbl.Columns.Count\n                    With oTbl.Cell(lRow, lCol).Shape.TextFrame.TextRange\n                        .Font.Name = \"Calibri\"\n                        .Font.Size = 7\n                    End With\n                Next\n            Next\n        End If\n    Next    ' Shape\nNext s\nEnd Sub\n</code></pre></li>\n</ul>\n"}, {"tags": ["sorting", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 6534666, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de5b8986f14da453d4f51230c0fd0490?s=128&d=identicon&r=PG&f=1", "display_name": "N.Ha", "link": "https://stackoverflow.com/users/6534666/n-ha"}, "edited": false, "score": 0, "creation_date": 1484231859, "post_id": 41600197, "comment_id": 70432971, "body": "So will the Me.OrderBy know to target the subform? or do I need to setfocus to the subform and then do the Me.OrderBy?"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "reply_to_user": {"reputation": 71, "user_id": 6534666, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de5b8986f14da453d4f51230c0fd0490?s=128&d=identicon&r=PG&f=1", "display_name": "N.Ha", "link": "https://stackoverflow.com/users/6534666/n-ha"}, "edited": false, "score": 0, "creation_date": 1484245685, "post_id": 41600197, "comment_id": 70442164, "body": "If you are not calling it from the subform&#39;s module you have to qualify it. For example if calling from the parent form: <code>Me.[SubFormName]!OrderBy=&quot;Filter&quot;</code> Or from a global function: <code>Forms(&quot;MainFormName&quot;).[SubFormName]!OrderBy=&quot;Filter&quot;</code>. Final syntax may be a little different as I am writing this on the fly."}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": true, "score": 0, "last_activity_date": 1484166820, "creation_date": 1484166820, "answer_id": 41600197, "question_id": 41593129, "link": "https://stackoverflow.com/questions/41593129/sort-button-in-access-form/41600197#41600197", "title": "Sort Button in Access Form", "body": "<p>Use the <code>OrderBy</code> property of the form. You can set it to anything that would be valid as an ORDER BY in the SQL of the form recordset.</p>\n\n<pre><code>Me.OrderBy = \"[Name], [Priority] DESC\"\nMe.Requery\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 6534666, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de5b8986f14da453d4f51230c0fd0490?s=128&d=identicon&r=PG&f=1", "display_name": "N.Ha", "link": "https://stackoverflow.com/users/6534666/n-ha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1793, "favorite_count": 0, "accepted_answer_id": 41600197, "answer_count": 1, "score": 0, "last_activity_date": 1484166820, "creation_date": 1484143880, "question_id": 41593129, "link": "https://stackoverflow.com/questions/41593129/sort-button-in-access-form", "title": "Sort Button in Access Form", "body": "<p>So I have a form that has a subform that displays projects. The goal is to create a sort button that would allow me to to sort/filter the project list by name and then priority. So my question is if there was a way to have two or more sort/filter criteria in a sort/filter button? I know I'm able to sort on one field using the .SetFocus and then DoCmd.RunCommand acCmdSortAscending but is that applicable to multiple fields? ie: Sort by Name AND Priority (High, Medium, Low). Thanks in advance!</p>\n"}, {"tags": ["oracle", "vba", "excel"], "comments": [{"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1484142281, "post_id": 41592556, "comment_id": 70388181, "body": "maybe you could add your query?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1484142705, "post_id": 41592556, "comment_id": 70388440, "body": "Have you checked if you have the Microsoft ActiveX library references enabled in VBA?  I am unsure which version of library is needed, but have seen those be issues for using Oracle/VBA."}, {"owner": {"reputation": 23, "user_id": 7404874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be058cc9362b60bfefe47001460eff0d?s=128&d=identicon&r=PG&f=1", "display_name": "Dhanabalan", "link": "https://stackoverflow.com/users/7404874/dhanabalan"}, "edited": false, "score": 0, "creation_date": 1484143440, "post_id": 41592556, "comment_id": 70388856, "body": "Thanks for your responses. Following is the query used:          sqlText = &quot; SELECT * FROM &quot; &amp; tablename &amp; &quot; WHERE rownum &lt; &quot; &amp; countx . I&#39;m using MS ActiveX 2.0 which is compatible i suppose. Since the query executes when i select a column with datatype character but throws error upon selecting a column with datatype timestamp."}, {"owner": {"reputation": 1133, "user_id": 5400038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae205ae8523ed6098d14d37819af8456?s=128&d=identicon&r=PG&f=1", "display_name": "R P", "link": "https://stackoverflow.com/users/5400038/r-p"}, "edited": false, "score": 0, "creation_date": 1484144399, "post_id": 41592556, "comment_id": 70389503, "body": "You can add the query to the question itself by editing it. It would be helpful."}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1484149803, "post_id": 41592556, "comment_id": 70393114, "body": "Try <code>Provider=OraOLEDB.Oracle</code> instead of <code>PROVIDER=MSDAORA</code>. The Microsoft provider has been <a href=\"https://msdn.microsoft.com/en-us/library/ms675851%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">deprecated</a> for many years. You can download &quot;Oracle Provider for OLE DB&quot; from here: <a href=\"http://www.oracle.com/technetwork/topics/dotnet/downloads/net-downloads-160392.html\" rel=\"nofollow noreferrer\">Oracle Data Access Components (ODAC) for Windows Downloads</a>"}, {"owner": {"reputation": 23, "user_id": 7404874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be058cc9362b60bfefe47001460eff0d?s=128&d=identicon&r=PG&f=1", "display_name": "Dhanabalan", "link": "https://stackoverflow.com/users/7404874/dhanabalan"}, "reply_to_user": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1484151843, "post_id": 41592556, "comment_id": 70394497, "body": "@WernfriedDomscheit I do not have the privilege to install anything new. My office network does not allows that. My DBA suggested me to use Oracle ODBC connection string. I have Oracle 12c client (Oracle12FAT_0012.03) installed in my machine. Could you please let me know the connection string to be used."}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1484151983, "post_id": 41592556, "comment_id": 70394573, "body": "Try anyway, perhaps OLEDB provider was included in your Oracle client installation"}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1484167730, "post_id": 41592556, "comment_id": 70403594, "body": "You can also have the Oracle SQL query cast the timestamp as a different data type."}], "answers": [{"tags": [], "owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "is_accepted": true, "score": 1, "last_activity_date": 1484156863, "last_edit_date": 1484156863, "creation_date": 1484154237, "answer_id": 41596631, "question_id": 41592556, "link": "https://stackoverflow.com/questions/41592556/datatype-supported-in-oracle-but-not-in-excel-vba/41596631#41596631", "title": "Datatype supported in Oracle but not in Excel VBA", "body": "<p>Microsoft OLE DB Provider for Oracle has been <a href=\"https://msdn.microsoft.com/en-us/library/ms675851%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">deprecated</a> for many years, it does not support Oracle data type <code>TIMESTAMP</code>. As far as I remember development stopped at Oracle 8i.</p>\n\n<p>You have to use the Oracle Provider for OLE DB, in case it is not installed you can download it from here: <a href=\"http://www.oracle.com/technetwork/topics/dotnet/downloads/net-downloads-160392.html\" rel=\"nofollow noreferrer\">Oracle Data Access Components (ODAC) for Windows Downloads</a></p>\n\n<p>The connection string then has to be like this:</p>\n\n<pre><code>\"PROVIDER=OraOLEDB.Oracle;DATA SOURCE=\" &amp; Server &amp; \";\" &amp; \"USER ID=\" &amp; UID &amp; \";PASSWORD=\" &amp; PWD\n</code></pre>\n\n<p>You can also try ODBC driver. Situation is similar, the Mircosoft driver has been <a href=\"https://msdn.microsoft.com/en-us/library/ms713590%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">deprecated</a> long time ago and you must use the Oracle driver. </p>\n\n<p>Connection string would be similar to this:</p>\n\n<pre><code>\"Driver={Oracle in OraClient11g_home1};Uid=\" &amp; UID &amp; \";Pwd=\" &amp; PWD &amp; \";DBQ=\" &amp; Server;\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7404874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be058cc9362b60bfefe47001460eff0d?s=128&d=identicon&r=PG&f=1", "display_name": "Dhanabalan", "link": "https://stackoverflow.com/users/7404874/dhanabalan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 823, "favorite_count": 0, "accepted_answer_id": 41596631, "answer_count": 1, "score": 1, "last_activity_date": 1484156863, "creation_date": 1484142155, "last_edit_date": 1484145790, "question_id": 41592556, "link": "https://stackoverflow.com/questions/41592556/datatype-supported-in-oracle-but-not-in-excel-vba", "title": "Datatype supported in Oracle but not in Excel VBA", "body": "<p>I've written an excel vba which connects to Oracle and retrieves random 'n' records from a table. The query is working in Oracle but when i execute the vba, i get an error message \"data type is not supported. Run time error -2147467259 (80004005)\"</p>\n\n<p>Then in my vba code, i removed the column which has data type = Timestamp. The vba works and retrieves the records. </p>\n\n<p>I can use a conversion in my vba query but the table name is dynamic and number of columns differs from each table and hence i can only use \"Select * from\". Could you please help me on this.</p>\n\n<p>Following is the query used. Does not works since the table has timestamp column</p>\n\n<pre><code>    sqlText = \" SELECT * FROM \" &amp; tablename &amp; \" WHERE rownum &lt; \" &amp; countx   \n</code></pre>\n\n<p>The below query works since i'm querying a column name with data type character.</p>\n\n<pre><code>    sqlText = \" SELECT name FROM employee \" WHERE rownum &lt; \" &amp; countx        \n</code></pre>\n\n<p>I'm using ADO 2.8 and following is my connection string</p>\n\n<pre><code>conn.Open \"PROVIDER=MSDAORA.Oracle;DATA SOURCE=\" &amp; Server &amp; \";\" &amp; \"USER ID=\" &amp; UID &amp; \";PASSWORD=\" &amp; PWD\n</code></pre>\n\n<p>Thanks,\nDhanabalan</p>\n"}, {"tags": ["vba", "excel", "charts", "range"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1484142403, "post_id": 41592447, "comment_id": 70388259, "body": "One way that works for me, when modifying ranges for charts, is to filter the contents.  When you set the range for the chart, you would A) filter the sheet, B) select range based on your parameters, C) output in a chart.  Filtering/hiding will make line items not be visible in the chart."}, {"owner": {"reputation": 1, "user_id": 7404815, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208156198159142/picture?type=large", "display_name": "Marty G", "link": "https://stackoverflow.com/users/7404815/marty-g"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1484142611, "post_id": 41592447, "comment_id": 70388387, "body": "Can you show an example please?"}, {"owner": {"reputation": 1, "user_id": 7404815, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208156198159142/picture?type=large", "display_name": "Marty G", "link": "https://stackoverflow.com/users/7404815/marty-g"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1484143737, "post_id": 41592447, "comment_id": 70389054, "body": "Im trying to upload the chart to show you what I got, but cant figure out how to do it"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1484143805, "post_id": 41592447, "comment_id": 70389094, "body": "If youve got some code can you upload that please?  You can edit it into your question"}, {"owner": {"reputation": 1, "user_id": 7404815, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208156198159142/picture?type=large", "display_name": "Marty G", "link": "https://stackoverflow.com/users/7404815/marty-g"}, "edited": false, "score": 0, "creation_date": 1484149816, "post_id": 41592447, "comment_id": 70393119, "body": "Ive added the code to the original question. Thank you for the interest!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7404815, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208156198159142/picture?type=large", "display_name": "Marty G", "link": "https://stackoverflow.com/users/7404815/marty-g"}, "edited": false, "score": 0, "creation_date": 1484148843, "post_id": 41593133, "comment_id": 70392495, "body": "Option Explicit  Private Sub Workbook_BeforeClose(Cancel As Boolean) &#39;Stop workbook refreshing      Call Chart_Stop  End Sub"}, {"owner": {"reputation": 1, "user_id": 7404815, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208156198159142/picture?type=large", "display_name": "Marty G", "link": "https://stackoverflow.com/users/7404815/marty-g"}, "edited": false, "score": 0, "creation_date": 1484149308, "post_id": 41593133, "comment_id": 70392804, "body": "I still cant send all the code. It says its too many characters. Is there a way i can send them to you in a msg?"}, {"owner": {"reputation": 1, "user_id": 7404815, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208156198159142/picture?type=large", "display_name": "Marty G", "link": "https://stackoverflow.com/users/7404815/marty-g"}, "edited": false, "score": 0, "creation_date": 1484149887, "post_id": 41593133, "comment_id": 70393157, "body": "Ok I got the original code entered into the original question above. Where should I place the code that you sent?"}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1484143884, "creation_date": 1484143884, "answer_id": 41593133, "question_id": 41592447, "link": "https://stackoverflow.com/questions/41592447/how-to-make-a-range-bar-chart/41593133#41593133", "title": "How to make a range bar chart", "body": "<p>Take your sheet of data and filter... example would be: </p>\n\n<pre><code>Columns(\"A:C\").Sort key1:=Range(\"C2\"), _\n  order1:=xlAscending, header:=xlYes\n</code></pre>\n\n<p>Sort info: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840646.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff840646.aspx</a></p>\n\n<p>You then can define to select your desired range.  Assuming column A is x-axis and B is y-axis (where your parameters for modifying need to be assessed):</p>\n\n<pre><code>Dim High1 as integer\nDim Low1 as integer\n\nHigh1 = Match(Max(B:B),B:B)  'This isn't tested, just an idea\nLow1 = Match(Max(B:B)+50,B:B)  'Again, not tested\n</code></pre>\n\n<p>and using those defined parameters:</p>\n\n<pre><code>.Range(Cells(High1,1),Cells(Low1,2).Select\n</code></pre>\n\n<p>This should give an idea for High1/Low1, where you can work through how you want to define the row that the max value occurs.</p>\n\n<p>You then CreateObject for the Chart you want, having selected the data range you are going to use.</p>\n"}], "owner": {"reputation": 1, "user_id": 7404815, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208156198159142/picture?type=large", "display_name": "Marty G", "link": "https://stackoverflow.com/users/7404815/marty-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 895, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1484164251, "creation_date": 1484141881, "last_edit_date": 1484164251, "question_id": 41592447, "link": "https://stackoverflow.com/questions/41592447/how-to-make-a-range-bar-chart", "title": "How to make a range bar chart", "body": "<p>Hey I'm new to forums and this is my first post. I am new to vba in excel, but have written thinkscript in ThinkorSwim. </p>\n\n<p>If anyone is familiar with a range stock chart, thats what Im going after.</p>\n\n<p>I found code for a line chart, and am using it, but it is based on where price is at any given time. I want to modify this line chart to only plot values when they are above or below a range so that it resembles a candlestick chart with no wicks. Once data enters that range, I only want it to update whenever a new high or low is made in that range. The ranges need to be preset (ex. 50 ticks) Once the range is exceeded, I want the data plotted in the next range up, and repeat the process. Time and dates should be ignored, and only plot based on price action.</p>\n\n<p>Does anyone have any ideas?</p>\n\n<pre><code>Option Explicit\n\n'Update the values between the quotes here:\nPrivate Const sChartWSName = \"Chart\"\nPrivate Const sSourceWSName = \"Sheet1\"\nPrivate Const sTableName = \"tblValues\"\nPublic RunTime As Double\n\nPrivate Sub Chart_Setup()\n'Create the structure needed to preserve and chart data\n    Dim wsChart As Worksheet\n    Dim lstObject As ListObject\n    Dim cht As Chart\n    Dim shp As Button\n    'Create sheet if necessary\n    Set wsChart = Worksheets.Add\n    wsChart.Name = sChartWSName\n    'Set up listobject to hold data\n    With wsChart\n        .Range(\"A1\").Value = \"Time\"\n        .Range(\"B1\").Value = \"Value\"\n        Set lstObject = .ListObjects.Add( _\n                        SourceType:=xlSrcRange, _\n                        Source:=.Range(\"A1:B1\"), _\n                        xllistobjecthasheaders:=xlYes)\n        lstObject.Name = sTableName\n        .Range(\"A2\").NumberFormat = \"h:mm:ss AM/PM (mmm-d)\"\n        .Columns(\"A:A\").ColumnWidth = 25\n        .Select\n    End With\n    'Create the chart\n    With ActiveSheet\n        .Shapes.AddChart.Select\n        Set cht = ActiveChart\n        With cht\n            .ChartType = xlLine\n            .SetSourceData Source:=Range(sTableName)\n            .PlotBy = xlColumns\n            .Legend.Delete\n            .Axes(xlCategory).CategoryType = xlCategoryScale\n            With .SeriesCollection(1).Format.Range\n                .Visible = msoTrue\n                .Weight = 1.25\n            End With\n        End With\n    End With\n    'Add buttons to start/stop the routine\n    Set shp = ActiveSheet.Buttons.Add(242.25, 0, 83.75, 33.75)\n    With shp\n        .OnAction = \"Chart_Initialize\"\n        .Characters.Text = \"Restart Plotting\"\n    End With\n    Set shp = ActiveSheet.Buttons.Add(326.25, 0, 83.75, 33.75)\n    With shp\n        .OnAction = \"Chart_Stop\"\n        .Characters.Text = \"Stop Plotting\"\n    End With\nEnd Sub\n\nPublic Sub Chart_Initialize()\n'Initialize the routine\nDim wsTarget As Worksheet\nDim lstObject As ListObject\n\n'Make sure worksheet exists\nOn Error Resume Next\nSet wsTarget = Worksheets(sChartWSName)\nIf Err.Number &lt;&gt; 0 Then\n    Call Chart_Setup\n    Set wsTarget = Worksheets(sChartWSName)\nEnd If\nOn Error GoTo 0\n\n'Check if chart data exists\nWith Worksheets(sChartWSName)\n    Set lstObject = .ListObjects(sTableName)\n    If lstObject.ListRows.Count &gt; 0 Then\n        Select Case MsgBox(\"You already have data.  Do you want to clear it and start fresh?\", vbYesNoCancel, \"Clear out old data?\")\n\n            Case Is = vbYes\n                'User wants to clear the data\n                lstObject.DataBodyRange.Delete\n\n            Case Is = vbCancel\n                'User cancelled so exit routine\n                Exit Sub\n\n            Case Is = vbNo\n                'User just wants to append to existing table\n        End Select\n    End If\n\n    'Begin appending\n    Call Chart_AppendData\nEnd With\nEnd Sub\n\nPrivate Sub Chart_AppendData()\n'Append data to the chart table\nDim lstObject As ListObject\nDim lRow As Long\n\nWith Worksheets(sChartWSName)\n    Set lstObject = .ListObjects(sTableName)\n    If lstObject.ListRows.Count = 0 Then\n        lRow = .Range(\"A1\").End(xlDown).Row\n    End If\n    If lRow = 0 Then\n        lRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Offset(1, 0).Row\n    End If\n    If lRow &gt; 2 Then\n        If .Range(\"B\" &amp; lRow - 1).Value = Worksheets(sSourceWSName).Range(\"C10\").Value Then\n            'Data is a match, so do nothing\n        Else\n            'Data needs appending\n            .Range(\"A\" &amp; lRow).Value = CDate(Now)\n            .Range(\"B\" &amp; lRow).Value = Worksheets(sSourceWSName).Range(\"C10\").Value\n        End If\n    Else\n            'Data needs appending\n            .Range(\"A\" &amp; lRow).Value = CDate(Now)\n            .Range(\"B\" &amp; lRow).Value = Worksheets(sSourceWSName).Range(\"C10\").Value\n    End If\nEnd With\n\nRunTime = Now + TimeValue(\"00:00:01\")\nApplication.OnTime RunTime, \"Chart_AppendData\"\nEnd Sub\n\nPublic Sub Chart_Stop()\n'Stop capturing data\nOn Error Resume Next\nApplication.OnTime EarliestTime:=RunTime, Procedure:=\"Chart_AppendData\", Schedule:=False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "header"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484141838, "post_id": 41592333, "comment_id": 70387881, "body": "what do you want to get ? your code runs fine, it creates the right header from the text in <code>Range(&quot;B3&quot;)</code>, and sets the font to <b>Calibri, bold, 11</b>. what is the result you want to get ?"}, {"owner": {"reputation": 53, "user_id": 7075690, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/14fe15f0f9e5efee4c783fd419a457bc?s=128&d=identicon&r=PG&f=1", "display_name": "Finley", "link": "https://stackoverflow.com/users/7075690/finley"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484142184, "post_id": 41592333, "comment_id": 70388116, "body": "It runs fine for the most part...but occasionally the header will appear extremely large.  I want to ensure that the header will always adhere to the standards set in the macro - Calibri, Bold, 11 size font. Are there any reasons that could cause the header to break from the macro dictated font?"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 7075690, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/14fe15f0f9e5efee4c783fd419a457bc?s=128&d=identicon&r=PG&f=1", "display_name": "Finley", "link": "https://stackoverflow.com/users/7075690/finley"}, "edited": false, "score": 0, "creation_date": 1484143946, "post_id": 41592682, "comment_id": 70389165, "body": "Actually just figured out why it&#39;s happening. But I need help figuring out how to avoid it from happening. I specify that the font should be size 11. From time-to-time the name of the document will begin with the number 3 (which is part of a company name)  how can I separate the font size from the header text to avoid excel from thinking the font size should be 113?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 53, "user_id": 7075690, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/14fe15f0f9e5efee4c783fd419a457bc?s=128&d=identicon&r=PG&f=1", "display_name": "Finley", "link": "https://stackoverflow.com/users/7075690/finley"}, "edited": false, "score": 0, "creation_date": 1484144002, "post_id": 41592682, "comment_id": 70389204, "body": "@Finley  ok, hope I&#39;ve helped u"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1484142926, "last_edit_date": 1484142926, "creation_date": 1484142552, "answer_id": 41592682, "question_id": 41592333, "link": "https://stackoverflow.com/questions/41592333/excel-vba-to-create-header-error/41592682#41592682", "title": "Excel VBA to Create Header ERROR", "body": "<p>Maybe you would be interested by something like the code below.\nIt checks the length of the string in cell \"B3\" and according to the length (using <code>Select Case</code>) it sets the Header font size. You will need to adjust the values inside the <code>Case</code>s to fit your needs.</p>\n\n<pre><code>Option Explicit\n\n'=========================================================================\n'  Custom Header based on value of specified cell\n'=========================================================================\n\nSub HeaderFont()\n\nDim FntSize As Integer\n\nSelect Case Len(Sheets(\"Reference\").Range(\"B3\"))\n    Case Is &gt; 300 ' &lt;-- length of string is more than 300 characters\n        FntSize = 11\n\n    Case Is &gt; 200 ' &lt;-- length of string is more than 200 characters\n        FntSize = 12\n\n    Case Else\n        FntSize = 13\n\n    ' you can add more Cases to have more scenarios\n\nEnd Select\n\nActiveSheet.PageSetup.RightHeader = \"&amp;\"\"Calibri,Bold\"\"&amp;\" &amp; FntSize &amp; \"\" &amp; Sheets(\"Reference\").Range(\"B3\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7075690, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/14fe15f0f9e5efee4c783fd419a457bc?s=128&d=identicon&r=PG&f=1", "display_name": "Finley", "link": "https://stackoverflow.com/users/7075690/finley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484142926, "creation_date": 1484141577, "last_edit_date": 1484141612, "question_id": 41592333, "link": "https://stackoverflow.com/questions/41592333/excel-vba-to-create-header-error", "title": "Excel VBA to Create Header ERROR", "body": "<p>I am currently using the below macro to customize the header based off the contents of cell B3 within spreadsheet \"Reference\", and have been using it sometime now.</p>\n\n<p>I'm currently running into an issue where the header font is becoming very large.  The header becomes so large, that if I print the spreadsheet (which I do often with this file) it monopolizes the entire page - in other words - the header overtakes the entire print area because it's so large.</p>\n\n<p>Is anyone able to see where I'm going wrong with the macro or have an idea as to why this is occurring and how to resolve this issue?</p>\n\n<pre><code>----\n\n'=========================================================================\n'  Custom Header based on value of specified cell\n'=========================================================================\n\nSub HeaderFont()\n\nActiveSheet.PageSetup.RightHeader = \"&amp;\"\"Calibri,bold\"\"&amp;11\" &amp; Sheets(\"Reference\").Range(\"B3\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "google-chrome", "selenium"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484141244, "post_id": 41591881, "comment_id": 70387453, "body": "what happens when you try combining them to 1 line, try <code>drv.Start &quot;Chrome&quot;, &quot;www.google.com&quot;</code> . (you do have Chorme installed, right ?`"}, {"owner": {"reputation": 71, "user_id": 4578409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5ad507ee1536e3125f05dcd606fe7ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Prem", "link": "https://stackoverflow.com/users/4578409/prem"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484222682, "post_id": 41591881, "comment_id": 70426725, "body": "I got the same error message."}, {"owner": {"reputation": 71, "user_id": 4578409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5ad507ee1536e3125f05dcd606fe7ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Prem", "link": "https://stackoverflow.com/users/4578409/prem"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484307740, "post_id": 41591881, "comment_id": 70467203, "body": "Same code works in Chrome 53 version but not working in 55 version."}], "answers": [{"tags": [], "owner": {"reputation": 1777, "user_id": 2160695, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/4089246b5f97d9edbab7de4605ef8e2e?s=128&d=identicon&r=PG", "display_name": "Unicco", "link": "https://stackoverflow.com/users/2160695/unicco"}, "is_accepted": true, "score": 5, "last_activity_date": 1508140726, "last_edit_date": 1508140726, "creation_date": 1508139946, "answer_id": 46765291, "question_id": 41591881, "link": "https://stackoverflow.com/questions/41591881/issue-in-launching-chrome-via-selenium-vba/46765291#46765291", "title": "Issue in launching Chrome via Selenium VBA", "body": "<p>I fixed this by installing the latest ChromeDriver, and replacing the .exe-file with the file located in my AppData.</p>\n\n<p><strong>Requirements</strong></p>\n\n<ul>\n<li>Download and install SeleniumBasic VBA, and set the reference in VBA editor (<a href=\"https://florentbr.github.io/SeleniumBasic/\" rel=\"noreferrer\">https://florentbr.github.io/SeleniumBasic/</a>)</li>\n</ul>\n\n<p><strong>Steps</strong></p>\n\n<ol>\n<li>Download latest WebDriver from: <a href=\"https://sites.google.com/a/chromium.org/chromedriver/downloads\" rel=\"noreferrer\">https://sites.google.com/a/chromium.org/chromedriver/downloads</a></li>\n<li>Open folder C:\\Users\\ <code>Username</code>\\AppData\\Local\\SeleniumBasic</li>\n<li>Replace chromedriver.exe with existing file</li>\n</ol>\n\n<p><strong>Example</strong></p>\n\n<p>Now this example code below works as intended</p>\n\n<pre><code>Sub driver()\n    Dim selenium As New selenium.WebDriver\n\n    selenium.Start \"chrome\", \"http://google.com\"\n    selenium.Get \"/\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 4578409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5ad507ee1536e3125f05dcd606fe7ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Prem", "link": "https://stackoverflow.com/users/4578409/prem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7930, "favorite_count": 2, "accepted_answer_id": 46765291, "answer_count": 1, "score": 2, "last_activity_date": 1508140726, "creation_date": 1484140333, "question_id": 41591881, "link": "https://stackoverflow.com/questions/41591881/issue-in-launching-chrome-via-selenium-vba", "title": "Issue in launching Chrome via Selenium VBA", "body": "<p>I have tried to launch Chrome browser via Selenium VBA by using the below code. I am getting this error when executing the code \"WebRequestError\nThe underlying connection was closed: An unexpected error occurred on a receive.\" But IE browser is working fine.</p>\n\n<pre><code>Sub samp()\nDim drv As New Selenium.WebDriver\ndrv.Start \"Chrome\"\ndrv.Get \"www.google.com\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 353, "user_id": 4625886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dba3b62f6875333ff46c58c3e240c0b8?s=128&d=identicon&r=PG&f=1", "display_name": "Anand", "link": "https://stackoverflow.com/users/4625886/anand"}, "is_accepted": false, "score": -1, "last_activity_date": 1484148180, "last_edit_date": 1484148180, "creation_date": 1484141506, "answer_id": 41592308, "question_id": 41591641, "link": "https://stackoverflow.com/questions/41591641/compare-two-excel-sheets-and-find-the-difference/41592308#41592308", "title": "Compare Two Excel sheets and find the difference", "body": "<p>I have created this file to compare two excel workbooks few years back, code is very elemantary but it does work with few limitations. </p>\n\n<p>Limitations:</p>\n\n<ol>\n<li>both file should not have same name</li>\n<li>it only compare values in the cell, does not compare any graphics.</li>\n<li>It is only comparing first 300 rows and first 200 columns, you can very easily update this in code to fit your need.</li>\n</ol>\n\n<p>Code is divided into two subs. 1. Compareworkbook and 2. CreateNewWorksheet</p>\n\n<p>You can creat browse button macro to populate two excel file names in named cell \"file1\" and named cell \"file2\". Then you can use Compareworkbook macro to compare two excel files. Once you run \"Compareworkbook\" macro, it will create new worksheet to show you the report. it only shows the values which are different. </p>\n\n<p>You can modify this code to compare certain columns or to fit your need. This should give you a good starting point.</p>\n\n<pre><code>Sub CompareWorkbook1()\n'this subroutine is created to compare two excel files\n'This will only compare first 300 rows and 150 column for all worksheet\n'in both workbook assuming both workbook has same number of worksheets\n\nDim wb As Workbook, wb1 As Workbook, wb2 As Workbook\n    Dim ws As Worksheet\n    Dim wBook1 As Variant\n    Dim wBook2 As Variant\n    'Set source workbook\n    Set wb = ActiveWorkbook\n            'Open the target workbook\n\nwBook1 = ActiveWorkbook.Sheets(\"Sheet1\").Range(\"file1\").Value\nwBook2 = ActiveWorkbook.Sheets(\"Sheet1\").Range(\"file2\").Value\n\n\n    Answer = MsgBox(\"This will generate a new report, Do you want to proceed?\", vbQuestion + vbYesNo, \"Are you sure? This will delete existing reports and generate new reports\")\n    If Answer = vbNo Then\n        GoTo exit1\n    Else\n        If Range(\"file1\").Value = \"\" Then\n            Msg = \"ERROR: INFORMATION MISSING ...\" &amp; vbNewLine &amp; vbNewLine\n            Msg = Msg &amp; \"Make sure you browse the file  \"\n            Msg = Msg &amp; \"by clicking on Browse button next to Step 1 \" &amp; vbNewLine &amp; vbNewLine\n            Msg = Msg &amp; \"REPORT WILL NOT GENERATE\"\n            MsgBox Msg, vbCritical\n            GoTo exit1\n        End If\n        If Range(\"file2\").Value = \"\" Then\n            Msg = \"ERROR: INFORMATION MISSING ...\" &amp; vbNewLine &amp; vbNewLine\n            Msg = Msg &amp; \"Make sure you browse the file  \"\n            Msg = Msg &amp; \"by clicking on Browse button next to Step 2 \" &amp; vbNewLine &amp; vbNewLine\n            Msg = Msg &amp; \"REPORT WILL NOT GENERATE\"\n            MsgBox Msg, vbCritical\n            GoTo exit1\n        End If\n\n\n    'generate new worksheet\n    ReportName = \"Comparison Results\"\n    Call CreateNewWorksheet(ReportName)\n\n    'set workbooks as variable wb1 and wb2\n    Set wb1 = Workbooks.Open(wBook1)\n    Set wb2 = Workbooks.Open(wBook2)\nwb.Sheets(2).Cells(4, 2).Value = wb1.Name\nwb.Sheets(2).Cells(4, 3).Value = wb2.Name\nwb.Sheets(2).Cells(3, 7).Value = wb1.Name\nwb.Sheets(2).Cells(3, 10).Value = wb2.Name\n\n'Pull data from browsed workbook for All incident\n'MsgBox \"WOrkbooks are opened\"\nThisWorkbook.Activate\nDim oSheet As Excel.Worksheet\n\n'This will populate all Worksheet name in Combo box\n    Dim a As Integer\n    Dim b As Integer\n    Dim c As Integer\n    Dim d As Integer\n    Dim wSheetsNo As Integer\n    Dim wSheetsNo1 As Integer\n    Dim wSheetsNo2 As Integer\n    a = 1\n    b = 1\n    c = 1\n    d = 1\n    wSheetsNo1 = 0\n    wSheetsNo2 = 0\n\n    a = 5\n    b = 2\n    For Each oSheet In wb1.Sheets\n\n\n        wb.Sheets(2).Cells(a, b) = oSheet.Name\n        a = a + 1\n        wSheetsNo1 = wSheetsNo1 + 1\n    Next oSheet\n    a = 5\n    b = 3\n    For Each oSheet In wb1.Sheets\n\n        wb.Sheets(2).Cells(a, b) = oSheet.Name\n        a = a + 1\n        wSheetsNo2 = wSheetsNo2 + 1\n    Next oSheet\n\n    a = 5\n    b = 7\n'populates all worksheet from 1st workbook to compare\nFor wSheetsNo = 1 To wSheetsNo1\n    'Compares from row 1 to 300\n    For c = 1 To 300\n        'Compares columns 1 to 200\n        For d = 1 To 200\n            'Compares each cell value in each worksheets for these two workbook\n            If wb1.Sheets(wSheetsNo).Cells(c, d).Value &lt;&gt; wb2.Sheets(wSheetsNo).Cells(c, d).Value Then\n                wb.Sheets(2).Cells(a, b + 1) = \"Cells (\" &amp; c &amp; \", \" &amp; d &amp; \")\"\n                wb.Sheets(2).Cells(a, b + 4) = \"Cells (\" &amp; c &amp; \", \" &amp; d &amp; \")\"\n                wb.Sheets(2).Cells(a, b + 2) = wb1.Sheets(wSheetsNo).Cells(c, d).Value\n                wb.Sheets(2).Cells(a, b + 5) = wb2.Sheets(wSheetsNo).Cells(c, d).Value\n                wb.Sheets(2).Cells(a, b) = wb1.Sheets(wSheetsNo).Name\n                wb.Sheets(2).Cells(a, b + 3) = wb2.Sheets(wSheetsNo).Name\n                a = a + 1\n            End If\n        'looks into next column\n        Next\n    'looks into next row\n    Next\n'looks into next worksheet\nNext\n\n'closes both workbook\nwb1.Close\nwb2.Close\nEnd If\n'exit if files is now browsed or path is empty\nexit1:\n\nEnd Sub\n\nSub CreateNewWorksheet(ReportName)\n\nDim wsSheet As Worksheet\n\n    On Error Resume Next\n        Set wsSheet = Sheets(ReportName)\n    On Error GoTo 0\n        If Not wsSheet Is Nothing Then\n            Application.DisplayAlerts = False\n            Sheets(ReportName).Delete\n            Application.DisplayAlerts = True\n        End If\n\n'Add New sheet at end of worksheet\n    ActiveWorkbook.Sheets.Add After:=Worksheets(Worksheets.Count)\n\n    ActiveSheet.Name = ReportName\n\nSheets(\"Comparison Results\").Select\n    Range(\"B4\").Select\n    Sheets(\"Comparison Results\").Select\n    Range(\"B3\").Select\n    ActiveCell.FormulaR1C1 = \"Worksheets which are compared\"\n    Range(\"B4\").Select\n    Columns(\"B:B\").ColumnWidth = 27.57\n    Columns(\"B:B\").Select\n    Selection.ColumnWidth = 28\n    Columns(\"C:C\").Select\n    Selection.ColumnWidth = 28\n    Range(\"B3:C3\").Select\n    With Selection\n        .HorizontalAlignment = xlGeneral\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = True\n    End With\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = True\n    End With\n    Selection.Font.Bold = True\n    Range(\"B4\").Select\n    ActiveCell.FormulaR1C1 = \"1st Workbook\"\n    Range(\"C4\").Select\n    ActiveCell.FormulaR1C1 = \"2nd Workbook\"\n    Range(\"B4:C4\").Select\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Range(\"B3:C50\").Select\n    ActiveWindow.SmallScroll Down:=-45\n    Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n    Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n    With Selection.Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideVertical)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideHorizontal)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    Range(\"B3:C4\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 10092543\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Range(\"B5:C50\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 10092543\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Range(\"C13\").Select\n    ActiveWindow.SmallScroll Down:=-15\n    Range(\"B3:C3\").Select\n    ActiveCell.FormulaR1C1 = \"Worksheets which are compared\"\n    Columns(\"G:L\").Select\n    Selection.ColumnWidth = 28\n    Selection.ColumnWidth = 10\n    Selection.ColumnWidth = 15\n    Selection.ColumnWidth = 18\n    Range(\"G3:I3\").Select\n    With Selection\n        .HorizontalAlignment = xlGeneral\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = True\n    End With\n    Selection.Copy\n    Range(\"J3\").Select\n    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n    Application.CutCopyMode = False\n    Range(\"G3:I3\").Select\n    ActiveCell.FormulaR1C1 = \"\"\n    Range(\"G4\").Select\n    ActiveCell.FormulaR1C1 = \"Worksheet\"\n    Range(\"H4\").Select\n    ActiveCell.FormulaR1C1 = \"Cell number\"\n    Range(\"I4\").Select\n    ActiveCell.FormulaR1C1 = \"Value in the cell\"\n    Range(\"G4:I4\").Select\n    Selection.Copy\n    Range(\"J4\").Select\n    ActiveSheet.Paste\n    Range(\"B4\").Select\n    Application.CutCopyMode = False\n    Selection.ClearContents\n    Range(\"C4\").Select\n    Selection.ClearContents\n    Range(\"G3:L10000\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 10092543\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n    Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n    With Selection.Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideVertical)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideHorizontal)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    Range(\"G3:L4\").Select\n    Selection.Font.Bold = True\n    Range(\"B3:C4\").Select\n    Selection.Font.Bold = False\n    Selection.Font.Bold = True\n    Range(\"B4:L4\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    With Selection\n        .HorizontalAlignment = xlGeneral\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Range(\"G3:L3\").Select\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n    End With\n    Range(\"G5\").Select\n    ActiveWindow.SmallScroll Down:=-15\n    Range(\"G3:I3\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Range(Selection, Selection.End(xlToLeft)).Select\n    Range(\"G3:L3\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n    Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n    With Selection.Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlInsideVertical)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideHorizontal)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    Range(\"G3:L4\").Select\n    Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n    Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n    With Selection.Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlInsideVertical)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideHorizontal)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n     Range(\"G3:L10000\").Select\n    Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n    Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n    With Selection.Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlInsideVertical)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideHorizontal)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n\n\n    Range(\"B3:C4\").Select\n    Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n    Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n    With Selection.Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlInsideVertical)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideHorizontal)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    Range(\"B3:C50\").Select\n    Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n    Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n    With Selection.Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlInsideVertical)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    Range(\"G3:I10000\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n    Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n    With Selection.Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlInsideVertical)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\nColumns(\"D:F\").Select\n    Range(\"F1\").Activate\n    Selection.ColumnWidth = 3\n    Range(\"G2:L2\").Select\n    With Selection\n        .HorizontalAlignment = xlGeneral\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = True\n    End With\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 10092543\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Range(\"G2:L2\").Select\n    ActiveCell.FormulaR1C1 = \"Comparison Results\"\n    Range(\"G2:L2\").Select\n    Selection.Font.Bold = True\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = True\n    End With\n    With Selection.Font\n        .Name = \"Calibri\"\n        .Size = 14\n        .Strikethrough = False\n        .Superscript = False\n        .Subscript = False\n        .OutlineFont = False\n        .Shadow = False\n        .Underline = xlUnderlineStyleNone\n        .ThemeColor = xlThemeColorLight1\n        .TintAndShade = 0\n        .ThemeFont = xlThemeFontMinor\n    End With\n    Range(\"G2:L2\").Select\n    Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n    Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n    With Selection.Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    Selection.Borders(xlInsideVertical).LineStyle = xlNone\n    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone\n    'Sheets(\"Sheet1\").Select\n    Range(\"B2\").Select\nRange(\"G3:L4\").Select\n    Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n    Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n    With Selection.Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlInsideHorizontal)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    Range(\"B1\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 10808362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P6hIA.jpg?s=128&g=1", "display_name": "mlm11011", "link": "https://stackoverflow.com/users/10808362/mlm11011"}, "is_accepted": false, "score": 0, "last_activity_date": 1572322692, "creation_date": 1572322692, "answer_id": 58601380, "question_id": 41591641, "link": "https://stackoverflow.com/questions/41591641/compare-two-excel-sheets-and-find-the-difference/58601380#58601380", "title": "Compare Two Excel sheets and find the difference", "body": "<p>This should do: </p>\n\n<pre><code>Sub HighlightDiffBtwSheets()\n'Substitute \"TEST1\" with the name of the sheet where you have the Name-Text columns\n'Substitute \"TEST2\" with the name of the sheet where you have the RuleName-RuleText columns\n'Substitute A in the Range with the column letter of Name/RuleName\n\nFor Each Name In Sheets(\"TEST1\").Range(\"A2:A\" &amp; Sheets(\"TEST1\").Cells(Rows.Count, 1).End(xlUp).Row)\n        For Each RuleName In Sheets(\"TEST2\").Range(\"A2:A\" &amp; Sheets(\"TEST2\").Cells(Rows.Count, 1).End(xlUp).Row)\n        If InStr(RuleName.Value, Name.Value) &lt;&gt; 0 Then\n            If Name.Offset(, 1).Value &lt;&gt; RuleName.Offset(, 1).Value Then\n             RuleName.Offset(, 1).Select\n             With Selection.Interior\n            .Color = 65535\n             End With\n\n             End If\n        End If\n        Next\nNext\nEnd Sub\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 12304267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9bbf0b418a5e56863ed204615b49fdb?s=128&d=identicon&r=PG&f=1", "display_name": "ProfessorPorcupine", "link": "https://stackoverflow.com/users/12304267/professorporcupine"}, "is_accepted": false, "score": 0, "last_activity_date": 1575060440, "creation_date": 1575060440, "answer_id": 59110800, "question_id": 41591641, "link": "https://stackoverflow.com/questions/41591641/compare-two-excel-sheets-and-find-the-difference/59110800#59110800", "title": "Compare Two Excel sheets and find the difference", "body": "<p>An easier non VBA way to do this is to use Conditional Formatting.  Just Create A New Rule, then select Use Formula option.  Use a relative reference (no dollar signs) and copy to where you need it.  For example, <code>=A1&lt;&gt;Sheet1!A1</code></p>\n"}], "owner": {"reputation": 3, "user_id": 2988907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1edbb954fa8a0b992bae3f25c33997f2?s=128&d=identicon&r=PG&f=1", "display_name": "user2988907", "link": "https://stackoverflow.com/users/2988907/user2988907"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 8163, "favorite_count": 2, "answer_count": 3, "score": 0, "last_activity_date": 1609297630, "creation_date": 1484139603, "last_edit_date": 1484140578, "question_id": 41591641, "link": "https://stackoverflow.com/questions/41591641/compare-two-excel-sheets-and-find-the-difference", "title": "Compare Two Excel sheets and find the difference", "body": "<p>I want to find out or highlight the differences between two Excel sheets.</p>\n\n<p><a href=\"https://i.stack.imgur.com/yO01W.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yO01W.png\" alt=\"enter image description here\"></a></p>\n\n<p>from above image I want to compare both sheets based on \"Name\" and \"RuleName\", if the number matches it needs to check differences for \"Text\" and \"Rule Text\" and it needs to find the differences like highlighted text in second Excel document.</p>\n"}, {"tags": ["sql-server", "vba", "visual-studio-2012"], "comments": [{"owner": {"reputation": 16152, "user_id": 205233, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fd3b79356ba4ea1f7e8d6be783446e59?s=128&d=identicon&r=PG&f=1", "display_name": "Filburt", "link": "https://stackoverflow.com/users/205233/filburt"}, "edited": false, "score": 0, "creation_date": 1484139441, "post_id": 41591403, "comment_id": 70386312, "body": "If your database is called <code>Database1</code>, you need to change the value for <code>Initial Catalog</code> from <code>Database1Dataset</code> to <code>Database1</code>."}, {"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1484139463, "post_id": 41591403, "comment_id": 70386331, "body": "<code>tboxUname</code> = <code>; sp_msforeachtable(&#39;DROP TABLE ?&#39;)</code>"}, {"owner": {"reputation": 16152, "user_id": 205233, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fd3b79356ba4ea1f7e8d6be783446e59?s=128&d=identicon&r=PG&f=1", "display_name": "Filburt", "link": "https://stackoverflow.com/users/205233/filburt"}, "reply_to_user": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 2, "creation_date": 1484139543, "post_id": 41591403, "comment_id": 70386387, "body": "@Gareth: <a href=\"http://xkcd.com/327/\" rel=\"nofollow noreferrer\">Exploits Of A Mom</a>."}], "owner": {"reputation": 23, "user_id": 6864886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e992a7cbbf7d8cba2692708c7ee638e8?s=128&d=identicon&r=PG&f=1", "display_name": "IsaSca", "link": "https://stackoverflow.com/users/6864886/isasca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 363, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484138898, "creation_date": 1484138898, "question_id": 41591403, "link": "https://stackoverflow.com/questions/41591403/how-do-i-read-data-from-a-local-sql-database-in-visual-basic-the-database-was-m", "title": "How do i read data from a local SQL database in visual basic? The database was made in Visual Studio", "body": "<p>I am having a few issues regarding reading data from a local sql server in visual basic. I have made the database and connected it as a data source but for some reason my data source connection and initial catalog must be incorrect. This is my code:</p>\n\n<pre><code> Private Sub Button1_Click(sender As Object, e As EventArgs) Handles btnLogin.Click\n        Dim con As New SqlConnection\n        Dim cmd As New SqlCommand\n        Dim rd As SqlDataReader\n\n        con.ConnectionString = (\"Data Source = localhost; Initial Catalog=Database1Dataset; Integrated security=true \")\n        cmd.Connection = con\n        con.Open()\n        cmd.CommandText = \"select login, password from Table where login = '\" &amp; tboxUname.Text &amp; \"' and password = '\" &amp; tboxPword.Text &amp; \"' \"\n        rd = cmd.ExecuteReader\n        If rd.HasRows Then\n            frmProperties.Show()\n        Else\n            MsgBox(\"Incorrect Login\") 'Else, display a message saying \"incorrect login\".\n            Tries += 1\n            If Tries = 3 Then\n                MsgBox(\"Closing Program\")\n                Close()\n            End If\n        End If\n\n    End Sub\n</code></pre>\n\n<p>My database is called Database1 and the table is called Table. Thanks for any help.</p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1484138200, "post_id": 41591111, "comment_id": 70385524, "body": "how did you  <code>Dim pCach</code> ?"}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1484138335, "post_id": 41591111, "comment_id": 70385618, "body": "@iDevlop <code>Dim pCach As PivotCache</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 1, "creation_date": 1484138896, "post_id": 41591261, "comment_id": 70385994, "body": "Yes I tried it says I have to wait 1 minute more before I can mark it as an answer."}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 1, "creation_date": 1484138977, "post_id": 41591261, "comment_id": 70386051, "body": "Yes we have to wait for 5 minutes after the answer has been posted before we can accept it as solution if I am not wrong."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 5, "last_activity_date": 1484138482, "creation_date": 1484138482, "answer_id": 41591261, "question_id": 41591111, "link": "https://stackoverflow.com/questions/41591111/type-mismatch-when-setting-up-pivotcache/41591261#41591261", "title": "Type mismatch when setting up pivotcache", "body": "<p>Try splitting setting the <code>PivotCache</code> and the <code>PivotTable</code> to 2 seperate code lines, like in the code below :</p>\n\n<pre><code>Dim pTbl  As PivotTable\nDim pCach As PivotCache\n\n' set the Pivot Cache\nSet pCach = ThisWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=pTRng)\n\n' create a new Pivot Table in \"wOPT\" sheet, start from Cell A3\nSet pTbl = wOPT.PivotTables.Add(PivotCache:=pCach, TableDestination:=wOPT.Range(\"A3\"), TableName:=\"PivotTable2\")\n</code></pre>\n"}], "owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 372, "favorite_count": 0, "accepted_answer_id": 41591261, "answer_count": 1, "score": 3, "last_activity_date": 1484138482, "creation_date": 1484138056, "last_edit_date": 1531164843, "question_id": 41591111, "link": "https://stackoverflow.com/questions/41591111/type-mismatch-when-setting-up-pivotcache", "title": "Type mismatch when setting up pivotcache", "body": "<p>I have pCach as PivotCache</p>\n\n<p>when I just do</p>\n\n<pre><code>ThisWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=pTRng).CreatePivotTable(TableDestination:= _\n    wOPT.Cells(3, 1), TableName:=\"PivotTable2\")\n</code></pre>\n\n<p>It works as expected and inserts pivotcache on the destination cell</p>\n\n<p>But when I try this it gives me type mismatch error?</p>\n\n<pre><code> Set pCach = ThisWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=pTRng).CreatePivotTable(TableDestination:= _\n    wOPT.Cells(3, 1), TableName:=\"PivotTable2\")\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1484139330, "post_id": 41590941, "comment_id": 70386255, "body": "2 problems.  (1) <code>IS</code> is an illegal name.  Don&#39;t know how you got it in there without an error.  (2)  On the first pass, the array has not been initialized, so you have to test to see if the array is empty.  See Chip Pearson&#39;s page on <a href=\"http://www.cpearson.com/excel/vbaarrays.htm\" rel=\"nofollow noreferrer\">VBA Arrays</a> for a useful function."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1484140124, "post_id": 41590941, "comment_id": 70386750, "body": "@RonRosenfeld Thanks for the answer. The IS is just an example, in my file the name is ISIdentifierArray (just cut it so it wouldn&#39;t be too long). For checking if the array is empty, should that be done before I enter the loop that calls the function or inside that loop?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1484140192, "post_id": 41590941, "comment_id": 70386787, "body": "You can do it at either location.  To make the function more generally useful, I would do it within the function."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1484140513, "post_id": 41590941, "comment_id": 70387010, "body": "@RonRosenfeld So I put the isarrayempty function inside the isinarray function? Sorry, I am still trying to wrap my head around what I have to do."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1484140574, "post_id": 41590941, "comment_id": 70387048, "body": "I&#39;ll post an answer"}], "answers": [{"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1484139785, "post_id": 41591674, "comment_id": 70386556, "body": "<code>IsInArray = -1</code> definitely does <b>NOT</b> end the function"}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1484140144, "post_id": 41591674, "comment_id": 70386763, "body": "Thanks for the answer. I will try and see how it works."}], "tags": [], "owner": {"reputation": 153, "user_id": 4137845, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-GOnqAEH8QoQ/AAAAAAAAAAI/AAAAAAAAAMI/q412c4RpHKk/photo.jpg?sz=128", "display_name": "Thapipo", "link": "https://stackoverflow.com/users/4137845/thapipo"}, "is_accepted": false, "score": -1, "last_activity_date": 1484139708, "creation_date": 1484139708, "answer_id": 41591674, "question_id": 41590941, "link": "https://stackoverflow.com/questions/41590941/manipulating-workbook-data-with-two-arrays/41591674#41591674", "title": "Manipulating workbook data with two arrays", "body": "<p>In your function IsInArray, can you try this : </p>\n\n<pre><code>Function IsInArray(stringToBeFound As String, arr As Variant) As Long\nDim position As Long\nDim returnValue as Long\n'default return value if value not found in array\nreturnValue  = -1\n\nFor position = LBound(arr) To UBound(arr) 'subscript out of range\n    If arr(position) = stringToBeFound Then\n        returnValue  = position + 1\n        Exit For\n    End If\nNext\n\nIsInArray = returnValue\n\nEnd Function`\n</code></pre>\n\n<p>I think when you write : IsInArray = -1, you're ending your function.</p>\n"}, {"comments": [{"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1484141663, "post_id": 41592235, "comment_id": 70387751, "body": "Much Appreciated. Only one question: On the &quot;If IsArrayEmpy(arr) then exit function&quot;, on the first iteration the array will be empty, so if it stops the function I cannot get the position to continue the macro and paste the information? If that happens, wouldn&#39;t the next iteration would also find return and empty array (and so on)?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 1, "creation_date": 1484142902, "post_id": 41592235, "comment_id": 70388555, "body": "@DGMS89 Huh? Array is empty means you have not even declared any dimensions. Once you declare a dimension, the array will no longer be empty.  But you don&#39;t do that within the IsInArray function as it now exists. Once you set a dimension, the array will no longer be empty.  If that is what you want, you could add code to ReDim the array if it is empty, to whatever you want the initial dimensions set."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1484146482, "post_id": 41592235, "comment_id": 70390952, "body": "@RonRosefeld Yes, now I understand, I though it would break out of the function with no position value, but that does not happen.  One more thing, if you don&#39;t mind: in the second part of the loop in the main sub, the redim preserve is also giving a subscription error. Can that be for the same reason? (the array being empty)"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 1, "creation_date": 1484147838, "post_id": 41592235, "comment_id": 70391832, "body": "@DGMS89 Yes.  If <code>IS</code> has no dimensions, then <code>Ubound(IS)</code> will return an error."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1484148958, "post_id": 41592235, "comment_id": 70392560, "body": "@RonRosefeld OK. Since this array is dynamic (I don&#39;t know how large it is going to be), should I just declare it initially <code>IS(0 to 1)</code> and then ReDim? Or is there another way?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 1, "creation_date": 1484161090, "post_id": 41592235, "comment_id": 70399989, "body": "@DGMS89 If you are going to change it, you <code>Dim IS() : ReDim IS(0)</code> and then you can do your <code>ReDim Preserve</code>.  In those situations, though, I usually use a <code>Collection</code> or <code>Dictionary</code> object to collect the individual bits of data."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 1, "last_activity_date": 1484141292, "last_edit_date": 1525816150, "creation_date": 1484141292, "answer_id": 41592235, "question_id": 41590941, "link": "https://stackoverflow.com/questions/41590941/manipulating-workbook-data-with-two-arrays/41592235#41592235", "title": "Manipulating workbook data with two arrays", "body": "<p>Your problem is that when you test the <code>LBOUND</code> of an unallocated array, you will get an error.  And that will be the case on the first pass through your <code>IsInArray</code> function.</p>\n\n<p>Since links to outside websites are discouraged, I have copied the <code>IsArrayEmpty</code> function from Chip Pearson's web site page on <a href=\"http://www.cpearson.com/excel/vbaarrays.htm\" rel=\"nofollow noreferrer\">VBA Arrays</a></p>\n\n<p>Change your <code>IsInArray</code> function as follows (and add the <code>IsArrayEmpty</code> function as I show below:</p>\n\n<hr>\n\n<pre><code>Function IsInArray(stringToBeFound As String, Arr As Variant) As Long\nDim position As Long\n'default return value if value not found in array\n\nIsInArray = -1\nIf IsArrayEmpty(Arr) Then Exit Function\n\n\nFor position = LBound(Arr) To UBound(Arr) 'subscript out of range\n    If Arr(position) = stringToBeFound Then\n        IsInArray = position + 1\n        Exit For\n    End If\nNext\n\nEnd Function\n\nPublic Function IsArrayEmpty(Arr As Variant) As Boolean\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'From Chip Pearson [VBA Arrays](http://www.cpearson.com/excel/vbaarrays.htm)\n\n' IsArrayEmpty\n' This function tests whether the array is empty (unallocated). Returns TRUE or FALSE.\n'\n' The VBA IsArray function indicates whether a variable is an array, but it does not\n' distinguish between allocated and unallocated arrays. It will return TRUE for both\n' allocated and unallocated arrays. This function tests whether the array has actually\n' been allocated.\n'\n' This function is really the reverse of IsArrayAllocated.\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\nDim LB As Long\nDim UB As Long\n\nErr.Clear\nOn Error Resume Next\nIf IsArray(Arr) = False Then\n' we weren't passed an array, return True\n    IsArrayEmpty = True\nEnd If\n\n' Attempt to get the UBound of the array. If the array is\n' unallocated, an error will occur.\nUB = UBound(Arr, 1)\nIf (Err.Number &lt;&gt; 0) Then\n    IsArrayEmpty = True\nElse\n''''''''''''''''''''''''''''''''''''''''''\n ' On rare occassion, under circumstances I\n ' cannot reliably replictate, Err.Number\n ' will be 0 for an unallocated, empty array.\n ' On these occassions, LBound is 0 and\n ' UBoung is -1.\n ' To accomodate the weird behavior, test to\n ' see if LB &gt; UB. If so, the array is not\n ' allocated.\n ''''''''''''''''''''''''''''''''''''''''''\n Err.Clear\n LB = LBound(Arr)\n If LB &gt; UB Then\n IsArrayEmpty = True\n Else\n IsArrayEmpty = False\n End If\nEnd If\n\nEnd Function\n</code></pre>\n\n<hr>\n"}], "owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 41592235, "answer_count": 2, "score": 0, "last_activity_date": 1484141292, "creation_date": 1484137575, "question_id": 41590941, "link": "https://stackoverflow.com/questions/41590941/manipulating-workbook-data-with-two-arrays", "title": "Manipulating workbook data with two arrays", "body": "<p>I am trying to get the information from one workbook, transform it to array (2D), add the first column (identifier) to an identifier array, match and paste it to excel. The code has some extra lines for basic organization.</p>\n\n<p>The current problem is that, in the IsInArray function, I am getting a \"subscript not defined\", for the 'for position = LBound(arr) to UBound(arr)'. </p>\n\n<p>Any idea of what might be happening?</p>\n\n<pre><code>Sub Pr()\nDim w As Workbook\nSet w = ThisWorkbook\nDim w2 As Workbook\nDim end1 As Long, end2 As Long, i As Long, lRow As Long, lColumn As Long, t     As Long, k As Long, position As Long, g As Long\nDim WBArray() As Variant\nDim IS() As Variant\nDim ws As Worksheet\n\nend1 = ThisWorkbook.Worksheets(1).UsedRange.Rows.count\n\nDim MyFolder As String\nDim MyFile As String\n\n'Optimize Macro Speed Start\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\n\n'opens the first workbook file\nFor i = 2 To ThisWorkbook.Sheets(\"FILES\").Cells(1, 2).Value\n\n    Workbooks.Open Filename:=ThisWorkbook.path &amp; \"\\\" &amp; ThisWorkbook.Sheets(\"FILES\").Cells(i, 1).Value\n\n    Set w2 = ActiveWorkbook\n    ActiveSheet.Range(\"A:A\").Select\n\n    'text to columns\n    Selection.TextToColumns destination:=Range(\"A1\"), DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n        Semicolon:=True, Comma:=True, Space:=False, Other:=False, FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), Array(7 _\n        , 1), Array(8, 1), Array(9, 1), Array(10, 1), Array(11, 1), Array(12, 1), Array(13, 1), Array(14, 1), Array(15, 1), Array(16, 1), Array(17 _\n        , 1), Array(18, 1), Array(19, 1), Array(20, 1), Array(21, 1), Array(22, 1), Array(23, 1), Array(24, 1), Array(25, 1), Array(26, 1), Array(27 _\n        , 1), Array(28, 1), Array(29, 1), Array(30, 1), Array(31, 1),   Array(32, 1)), TrailingMinusNumbers:=True\n\n    end2 = ActiveSheet.UsedRange.Rows.count\n\n'transform it to array\n    WBArray = ActiveSheet.Range(Cells(5, 1), Cells(end2, 29)).Value\n\n'loop to match information in two arrays\n\n    For lRow = 2 To UBound(WBArray)\n        If IsInArray((WBArray(lRow, 1)), IS) &lt;&gt; -1 Then\n            t = IsInArray((WBArray(lRow, 1)), IS)\n\n'start the information pasting procedure:\n            w.Sheets(\"C\").Cell(t, i + 3) = WBArray(lRow, 11)\n            w.Sheets(\"M\").Cell(t, i + 3) = WBArray(lRow, 12)\n            w.Sheets(\"W t-1\").Cell(t, i + 3) = WBArray(lRow, 13)\n            w.Sheets(\"P\").Cell(t, i + 3) = WBArray(lRow, 14)\n            w.Sheets(\"A\").Cell(t, i + 3) = WBArray(lRow, 15)\n            w.Sheets(\"PC\").Cell(t, i + 3) = WBArray(lRow, 16)\n            w.Sheets(\"AM\").Cell(t, i + 3) = WBArray(lRow, 17)\n            w.Sheets(\"AM t-1\").Cell(t, i + 3) = WBArray(lRow, 18)\n            w.Sheets(\"P t-1\").Cell(t, i + 3) = WBArray(lRow, 19)\n            w.Sheets(\"F\").Cell(t, i + 3) = WBArray(lRow, 20)\n            w.Sheets(\"F t-1\").Cell(t, i + 3) = WBArray(lRow, 21)\n            w.Sheets(\"A t-1\").Cell(t, i + 3) = WBArray(lRow, 22)\n            w.Sheets(\"S\").Cell(t, i + 3) = WBArray(lRow, 23)\n\n        Else\n\n'add it to the end of ISArray\n            ReDim Preserve IS(1 To UBound(IS) + 1)\n            IS(UBound(IS)) = WBArray(lRow, 1)\n            k = UBound(IS)\n\n            w.Sheets(\"C\").Cell(k, i + 3) = WBArray(lRow, 11)\n            w.Sheets(\"M\").Cell(k, i + 3) = WBArray(lRow, 12)\n            w.Sheets(\"W t-1\").Cell(k, i + 3) = WBArray(lRow, 13)\n            w.Sheets(\"P\").Cell(k, i + 3) = WBArray(lRow, 14)\n            w.Sheets(\"A\").Cell(k, i + 3) = WBArray(lRow, 15)\n            w.Sheets(\"PC\").Cell(k, i + 3) = WBArray(lRow, 16)\n            w.Sheets(\"AM\").Cell(k, i + 3) = WBArray(lRow, 17)\n            w.Sheets(\"AM t-1\").Cell(k, i + 3) = WBArray(lRow, 18)\n            w.Sheets(\"P t-1\").Cell(k, i + 3) = WBArray(lRow, 19)\n            w.Sheets(\"F\").Cell(k, i + 3) = WBArray(lRow, 20)\n            w.Sheets(\"F t-1\").Cell(k, i + 3) = WBArray(lRow, 21)\n            w.Sheets(\"A t-1\").Cell(k, i + 3) = WBArray(lRow, 22)\n            w.Sheets(\"S\").Cell(k, i + 3) = WBArray(lRow, 23)\n\n        End If\n\n  Next lRow\n'copy the file date from each source workbook to output workbook\n'if the control sheet name (FILES) is changed, please change it in this loop\n\n        For Each ws In w.Worksheets\n\n            If ws.Name &lt;&gt; \"FILES\" Then\n\n                ws.Cells(1, i + 3) = w2.Worksheets(1).Cells(1, 2)\n\n            End If\n\n        Next ws\n\nNext i\n\n'paste the is array to all worksheets\n\n    g = UBound(IS)\n    For Each ws In ActiveWorkbook.Worksheets\n\n        Range(\"A1:A\" &amp; g) = IS()\n\n    Next ws\n\n'Optimize Macro Speed\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\nApplication.Calculation = xlCalculationAutomatic\n\n'Close file and save\n'w.Close True\n\n\nEnd Sub\n\n\n\nFunction IsInArray(stringToBeFound As String, arr As Variant) As Long\nDim position As Long\n'default return value if value not found in array\nIsInArray = -1\n\nFor position = LBound(arr) To UBound(arr) 'subscript out of range\n    If arr(position) = stringToBeFound Then\n        IsInArray = position + 1\n        Exit For\n    End If\nNext\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "replace", "eval", "ms-word", "execute"], "comments": [{"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1484141131, "post_id": 41590718, "comment_id": 70387388, "body": "I believe it should be <code>Evaluate()</code>, but I&#39;m completely uncertain whether or not this would work"}, {"owner": {"reputation": 444, "user_id": 4842964, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd2670dae1e6cb09465d241e3e67b741?s=128&d=identicon&r=PG&f=1", "display_name": "Some_Guy", "link": "https://stackoverflow.com/users/4842964/some-guy"}, "reply_to_user": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1484142389, "post_id": 41590718, "comment_id": 70388250, "body": "evaluate() is an excel specific function that works on worksheet formulae rather than vba code (e.g. <code>evaluate(&quot;sum(a1:d4))&quot;</code>    )"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1484147240, "post_id": 41590718, "comment_id": 70391468, "body": "Even in excel eval/Evaluateis just a mechanism to invoke a function. What you are trying to to do in your example is Set properties to an object. As far as I know, VBA doesn&#39;t  supports such feature. To tweak a property you will first need an instance of the object and then reflect it to replace/ add the property values. .Net / Java support reflection, VBA doesn&#39;t."}, {"owner": {"reputation": 444, "user_id": 4842964, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd2670dae1e6cb09465d241e3e67b741?s=128&d=identicon&r=PG&f=1", "display_name": "Some_Guy", "link": "https://stackoverflow.com/users/4842964/some-guy"}, "edited": false, "score": 0, "creation_date": 1484147968, "post_id": 41590718, "comment_id": 70391939, "body": "So what do you recommend I do?  I could create a new sub for each combination of properties I end up using (involves a lot of code duplication)?  I could create a behemoth of a sub with a bunch of optional arguments for every property I might care to use in the future (better, but still ugly)   Or is there a smarter way that achieves a similar purpose, that is to say invoke a subroutine which includes a method within it defined by multiple parameters, without specifying all of these potentially used parameters in the arguments of the subroutine?"}, {"owner": {"reputation": 444, "user_id": 4842964, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd2670dae1e6cb09465d241e3e67b741?s=128&d=identicon&r=PG&f=1", "display_name": "Some_Guy", "link": "https://stackoverflow.com/users/4842964/some-guy"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1484843705, "post_id": 41590718, "comment_id": 70686710, "body": "@cyboashu turns out this is in fact possible, see my answer below."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1484843929, "post_id": 41590718, "comment_id": 70686847, "body": "yeah, you totally nailed it. who cares for reflection. :) Cheers!!"}], "answers": [{"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1484616750, "post_id": 41687157, "comment_id": 70572404, "body": "Good answer, but perhaps &quot;It&#39;s not possible to evaluate a string as code in vba&quot; should read &quot;There is no straight-forward way to evaluate a string as code in vba&quot;. VBA is Turing complete. You could write your own parser if worse comes to worse. Also -- the VBA editor is scriptable, and you can use it to dynamically generate code. But, there is nothing which is as immediately usable as e.g. Python&#39;s <code>exec()</code> function."}, {"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1604579860, "post_id": 41687157, "comment_id": 114392848, "body": "@JohnColeman Exactly! And <a href=\"https://github.com/sancarn/stdVBA/blob/master/src/stdLambda.cls\" rel=\"nofollow noreferrer\">write our own parser, compiler and evaluator we did!</a> :D"}], "tags": [], "owner": {"reputation": 444, "user_id": 4842964, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd2670dae1e6cb09465d241e3e67b741?s=128&d=identicon&r=PG&f=1", "display_name": "Some_Guy", "link": "https://stackoverflow.com/users/4842964/some-guy"}, "is_accepted": true, "score": 2, "last_activity_date": 1508929537, "last_edit_date": 1592644375, "creation_date": 1484612576, "answer_id": 41687157, "question_id": 41590718, "link": "https://stackoverflow.com/questions/41590718/evaluate-string-as-code-vba/41687157#41687157", "title": "evaluate string as code VBA", "body": "<h3>Best option</h3>\n<p>CallByName allows you to set a Property or invoke a Method with an Object named by a string.</p>\n<pre><code>Sub Example(x, Optional Method1 As String =&quot;&quot;, _\n            Optional Param1 As String = &quot;&quot;, Optional Param1Value as Variant)\n\n    Dim MyObject as Object \n    Set MyObject = Application.ExampleObject\n\n    'invoke a method from its name\n    if method1 &lt;&gt; &quot;&quot; Then CallByName MyObject, Method1, VbMethod\n    'set a property from its name and a variant representing the value to set\n    if param1 &lt;&gt; &quot;&quot; Then CallByName MyObject, Param1, VbSet, Param1Value\n\n    With MyObject\n        .property1 = &quot;foo&quot;\n        .property2 = x       \n        .excecute\n    End With\nEnd Sub\n</code></pre>\n<p>(For info on how to handle properties with more than one value elegantly, see this thread <a href=\"http://www.vbforums.com/showthread.php?405366-RESOLVED-Using-CallByName-with-variable-number-of-arguments\" rel=\"nofollow noreferrer\">http://www.vbforums.com/showthread.php?405366-RESOLVED-Using-CallByName-with-variable-number-of-arguments</a>)</p>\n<h3>Earlier solution</h3>\n<p>Farm out rarely-used properties to external subroutine. Still could be useful in combination with the above if you don't want to clutter up the arguments of your Main Subroutine.</p>\n<pre><code>Sub Example(x, Optional ExternalSub as String)\n    'pull any additional rarely used properties from another sub\n    Application.Run(ExternalSub)\n\n    With Application.ExampleObject\n        .property1 = &quot;foo&quot;\n        .property2 = x       \n        .excecute\n    \nEnd Sub\n\nSub External_MoreProperties\n    Application.ExampleObject.property3 = &quot;bar&quot;\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "is_accepted": false, "score": 0, "last_activity_date": 1604580006, "last_edit_date": 1604580006, "creation_date": 1604579684, "answer_id": 64697319, "question_id": 41590718, "link": "https://stackoverflow.com/questions/41590718/evaluate-string-as-code-vba/64697319#64697319", "title": "evaluate string as code VBA", "body": "<p>A bit late to the party but in this case I would use <a href=\"https://github.com/sancarn/stdVBA/blob/master/src/stdLambda.cls\" rel=\"nofollow noreferrer\"><code>stdLambda</code></a>.</p>\n<p>stdLambda is an external library, developed to bring a full parser, compiler and evaluator to VBA. We parse VBA-like code, convert it into byte code, and then evaluate it when needed, all within the VBA runtime!</p>\n<p>Usage should be very straight forward for this use case:</p>\n<pre><code>Public Sub FaR_Wild_Stories_Extras(ByVal rngStory As Word.Range, _\nByVal strSearch As String, ByVal strReplace As String, _\nOptional ByVal extraFilters As stdICallable)\n\n    Dim f as Find\n    set f = rngStory.Find\n    With f\n       'Default search params:\n       .ClearFormatting\n       .Replacement.ClearFormatting\n       .Text = strSearch\n       .Replacement.Text = strReplace\n       .Forward = True\n       .MatchWildcards = True\n       .MatchCase = True\n       .IgnorePunct = True\n       .IgnoreSpace = True\n       .Format = False\n       .Wrap = wdFindContinue\n       Call extraFilters.Run(f)\n       .Execute Replace:= wdReplaceAll\n    End With\n End Sub\n Sub Main()\n    Call FaR_Wild_Stories_Extras(Doc.Contents, &quot;Hello&quot;,&quot;Bye&quot;, stdLambda.CreateMultiline( _ \n        &quot;$1.Font.Size = 10&quot;, _ \n        &quot;$1.MatchDiacritics = False&quot; _ \n    ))\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 444, "user_id": 4842964, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd2670dae1e6cb09465d241e3e67b741?s=128&d=identicon&r=PG&f=1", "display_name": "Some_Guy", "link": "https://stackoverflow.com/users/4842964/some-guy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2291, "favorite_count": 0, "accepted_answer_id": 41687157, "answer_count": 2, "score": 0, "last_activity_date": 1604580006, "creation_date": 1484136893, "last_edit_date": 1484843119, "question_id": 41590718, "link": "https://stackoverflow.com/questions/41590718/evaluate-string-as-code-vba", "title": "evaluate string as code VBA", "body": "<p>I have a subroutine with optional parameters</p>\n\n<pre><code>Public Sub FaR_Wild_Stories_Extras(ByVal rngStory As Word.Range, _\n    ByVal strSearch As String, ByVal strReplace As String, _\n    Optional extra1 As String = \"\", Optional extra2 As String = \"\")\n  With rngStory.Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Text = strSearch\n    .Replacement.Text = strReplace\n    .Forward = True\n    .MatchWildcards = True\n    .MatchCase = True\n    .IgnorePunct = True\n    .IgnoreSpace = True\n    .Format = False\n    .Wrap = wdFindContinue\n    If extra1 &lt;&gt; \"\" Then eval(extra1)\n    If extra2 &lt;&gt; \"\" Then eval(extra2)\n    .Execute Replace:=wdReplaceAll\n  End With\nEnd Sub\n</code></pre>\n\n<p>I want to be able to place something like \"<code>.font.size=14</code>\" or <code>.MatchDiacritics = False</code> for example in <code>extra1</code> and evaluate it, so that, when invoking a find and replace subroutine if there are specific extra params I want to include in the find and replace as a one time thing, I don't have to create a whole separate sub for it.</p>\n\n<p>Is there a way to do this?  Eval() doesn't seem to exist in word VBA.\nObject.string isn't possible, is there some smarter way I could structure my code other than duplicating the subroutine or having a subroutine with 10s of rarely used, optional arguments?</p>\n\n<p>For a more generalised case, is it possible to <code>call</code> a sub like this, or structure code by passing arguments cleverly to have the same effect</p>\n\n<pre><code>...\ncall Example , true, \".prop1=5\", \".prop2=6\"\n...\n\nSub Example1(x, Optional param1 As String, Optional param2 As String)\n    With Application.ExampleObject\n        .property1 = \"foo\"\n        .property2 = x\n        Expand (param1)\n        Expand (param2)\n        .excecute\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7394412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0da9efab478220752f3691eabb98747d?s=128&d=identicon&r=PG&f=1", "display_name": "JoFE", "link": "https://stackoverflow.com/users/7394412/jofe"}, "edited": false, "score": 0, "creation_date": 1484137379, "post_id": 41590451, "comment_id": 70384966, "body": "I don&#39;t know if the OR would work as each variable is specific to one single paste location. I&#39;m not searching for more than one variable at a time."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 1, "user_id": 7394412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0da9efab478220752f3691eabb98747d?s=128&d=identicon&r=PG&f=1", "display_name": "JoFE", "link": "https://stackoverflow.com/users/7394412/jofe"}, "edited": false, "score": 0, "creation_date": 1484140050, "post_id": 41590451, "comment_id": 70386706, "body": "Use the array option then, enclose your code in one of the methods shown in the link"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1484136144, "creation_date": 1484136144, "answer_id": 41590451, "question_id": 41590413, "link": "https://stackoverflow.com/questions/41590413/getting-excel-macro-to-loop-task-slightly-different-each-time/41590451#41590451", "title": "Getting Excel Macro to Loop Task, Slightly Different Each Time", "body": "<p>Look at the OR clause in your filter.  I'd suggest recording doing a multiple selection filter, like this <a href=\"http://www.ozgrid.com/VBA/autofilter-vba-criteria.htm\" rel=\"nofollow noreferrer\">And Or Criteria</a>  about 2/3 down.   Or use a for next loop on an array.  Like so <a href=\"http://www.homeandlearn.org/arrays_and_loops.html\" rel=\"nofollow noreferrer\" title=\"looping array\">Looping Array</a></p>\n"}], "owner": {"reputation": 1, "user_id": 7394412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0da9efab478220752f3691eabb98747d?s=128&d=identicon&r=PG&f=1", "display_name": "JoFE", "link": "https://stackoverflow.com/users/7394412/jofe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484136144, "creation_date": 1484136011, "question_id": 41590413, "link": "https://stackoverflow.com/questions/41590413/getting-excel-macro-to-loop-task-slightly-different-each-time", "title": "Getting Excel Macro to Loop Task, Slightly Different Each Time", "body": "<p>I hope someone can help me, as I know that the macro I am trying to create would save about 30 minutes' work if it comes off.</p>\n\n<p>Once a month I download a financial transactions report; the search variables I need to use are in column C. The number of rows for each search variable changes from month to month. I need to search for all rows containing a given variable (e.g. VDEN, VDEM VDEF; these are exact search terms), copy all rows containing the variable and paste them into a one of five workbooks, each with several worksheets in it.</p>\n\n<p>I have some code to do this with one term and one worksheet location, but I don't know how to loop it so that it goes back for a new variable and starts the whole process all over again.</p>\n\n<p>This is what I have already:</p>\n\n<pre><code>Sub Macro2()\n\nWorkbooks.Open Filename:=\"C:\\Users\\jo\\Desktop\\Month End.xlsx\"\nColumns(\"A:L\").Select\nSelection.EntireColumn.Hidden = False\nApplication.DisplayAlerts = False\nCells.Find(\"Total:\").Rows(1).EntireRow.Delete\nApplication.DisplayAlerts = True\n\nDim lastrow As Long\nlastrow = ActiveSheet.Cells(ActiveSheet.Rows.Count, \"A\").End(xlUp).Row\n\nWith ActiveSheet.Range(\"a1:l\" &amp; lastrow)\n.AutoFilter Field:=3, Criteria1:=\"VDEN\"\n.Offset(1, 0).Copy\n\n End With\n\nWorkbooks.Open Filename:=\"X:\\admin\\Finance\\2016-17\\Transaction Lists\\Sample Transactions 2016-17.xlsx\"\n\nWindows(\"Month End.xlsx\").Activate\nWindows(\"Sample Transactions 2016-17.xlsx\").Activate\nSheets(\"Pre-Sessional\").Select\nColumns(\"A:L\").Select\nSelection.EntireColumn.Hidden = False\n\nWindows(\"Sample Transactions 2016-17.xlsx\").Activate\nWorksheets(\"Pre-Sessional\").Activate\nRange(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Select\nActiveSheet.Paste\nRange(\"D:D,F:F,G:G,H:H,K:K\").Select\n\nSelection.EntireColumn.Hidden = True\n\nWindows(\"Month End.xlsx\").Activate\nActiveSheet.ShowAllData\n\n\n End Sub\n</code></pre>\n\n<p>Can anybody help?</p>\n\n<p>Many thanks</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1484136987, "post_id": 41590388, "comment_id": 70384709, "body": "Here is one way (in English) <code>=ADDRESS(MATCH(&quot;stack&quot;,B:B,0),2)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 6, "last_activity_date": 1484137535, "last_edit_date": 1484137535, "creation_date": 1484137193, "answer_id": 41590822, "question_id": 41590388, "link": "https://stackoverflow.com/questions/41590388/display-cell-address-with-a-vlookup/41590822#41590822", "title": "Display cell address with a =VLOOKUP", "body": "<p>Most <code>VLOOKUP</code> formulas can be replaced by a combination of <code>INDEX</code> and <code>MATCH</code>. If you do this you can then wrap that formula with a <code>CELL</code> function using the <code>\"address\"</code> parameter to return the cell address of the return value.</p>\n\n<p>In this example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/C7TCU.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/C7TCU.png\" alt=\"enter image description here\"></a></p>\n\n<p>We are looking for the value in column <code>B</code> based on the row in column <code>A</code> where value <code>c</code> is found. With a <code>VLOOKUP</code> you would write</p>\n\n<p><code>=VLOOKUP(\"c\",A1:B6,2,0)</code></p>\n\n<p>With an <code>INDEX</code> and <code>MATCH</code> the formula is:</p>\n\n<p><code>=INDEX(B2:B6,MATCH(\"c\",A2:A6,0))</code></p>\n\n<p>And therefore to get the address of the result you can write:</p>\n\n<p><code>=CELL(\"address\",INDEX(B2:B6,MATCH(\"c\",A2:A6,0)))</code></p>\n\n<p>To get the result of <code>$B$4</code>.</p>\n\n<p>In the example I used <code>E1</code> as the reference instead of <code>c</code>.</p>\n\n<p>Hope that helps to integrate into your workbook set-up. This is the French Excel translation of the final formula:</p>\n\n<p><code>=CELLULE(\"adresse\";INDEX(B2:B6;EQUIV(\"c\";A2:A6;0)))</code></p>\n\n<p>Bonne chance!</p>\n"}], "owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3567, "favorite_count": 0, "accepted_answer_id": 41590822, "answer_count": 1, "score": 2, "last_activity_date": 1484137535, "creation_date": 1484135946, "last_edit_date": 1531161705, "question_id": 41590388, "link": "https://stackoverflow.com/questions/41590388/display-cell-address-with-a-vlookup", "title": "Display cell address with a =VLOOKUP", "body": "<p>I'd like to do the following thing:\nWhen my =VLOOKUP formula finds what I need to find, I want to display the address of the cell where my =VLOOKUP formula found what I wanted.</p>\n\n<p>Example:</p>\n\n<p>I want to find \"Stack Overflow\" in my SHEET2 TAB</p>\n\n<p><a href=\"https://i.stack.imgur.com/S8XMp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S8XMp.png\" alt=\"enter image description here\"></a></p>\n\n<p>But I'd like to display the address of \"Stack Overflow\" in the SHEET2... not \"Stack overflow\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/9fXDc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9fXDc.png\" alt=\"enter image description here\"></a></p>\n\n<p>What I've tried:</p>\n\n<p>=SI(RECHERCHEV(A39;GW!$B:$B;1;FAUX)=A39;CELLULE(\"adresse\";RECHERCHEV(A39;GW!$B:$B;1;FAUX));\"KO\")</p>\n\n<p>The CELLULE(\"adresse\";xx) part does not work... :(</p>\n\n<p>Thanks in advance for your help</p>\n\n<p>Jean</p>\n"}, {"tags": ["vba", "macros", "recorder", "catia"], "answers": [{"tags": [], "owner": {"reputation": 821, "user_id": 6937632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1554053245e86d609b83f201aa6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "C R Johnson", "link": "https://stackoverflow.com/users/6937632/c-r-johnson"}, "is_accepted": false, "score": 0, "last_activity_date": 1484168718, "creation_date": 1484168718, "answer_id": 41600666, "question_id": 41590384, "link": "https://stackoverflow.com/questions/41590384/3d-curve-macro-recording-not-working-in-catia-vba/41600666#41600666", "title": "3d curve macro recording not working in catia vba", "body": "<p>The Freestyle 3D curve is not supported by automation (there is no API). Nor are any of the tools in DSE. That is why, in this case, nothing is recorded. </p>\n\n<p>Also, sometimes recording doesn't work even when APIs which do exist. </p>\n"}], "owner": {"reputation": 37, "user_id": 7204843, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/GYsqg.jpg?s=128&g=1", "display_name": "Hadiza Hamza", "link": "https://stackoverflow.com/users/7204843/hadiza-hamza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484168718, "creation_date": 1484135931, "question_id": 41590384, "link": "https://stackoverflow.com/questions/41590384/3d-curve-macro-recording-not-working-in-catia-vba", "title": "3d curve macro recording not working in catia vba", "body": "<p>i have been trying to record the creation of a 3d curve using control points in catia using the macro recorder but it refuses to record anything except part.update. I even tried it in both Freestyle workbench and Digitized shape editor workbench, but both have same result. please could someone explain to me how to do it or atleast where i could find such macro</p>\n"}, {"tags": ["excel", "excel-2010", "userform", "vba"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 3203020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a987a4e483f149eed5eb9bb07038b08e?s=128&d=identicon&r=PG&f=1", "display_name": "TehJake", "link": "https://stackoverflow.com/users/3203020/tehjake"}, "edited": false, "score": 0, "creation_date": 1484145453, "post_id": 41593152, "comment_id": 70390211, "body": "Thanks Robin, will try implementing this now.  Oddly enough, in the interim since asking my question I&#39;ve turned off all of the queryclose events in each of my forms and swapped to using buttons - Still experiencing the same behaviour!    I&#39;ve been using &quot;Unload Me&quot; before showing my next form, because it seems that as soon as I &quot;.Show&quot; a form, that procedure stops executing and instead control yields to the shown form. After the new form is shown, it resumes executing from &quot;.Show&quot; (or &quot;Unload Me&quot;).  I notice you call &quot;.Show&quot; before &quot;Unload&quot; - Does this work the same way for you?"}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 0, "last_activity_date": 1484144606, "last_edit_date": 1484144606, "creation_date": 1484143933, "answer_id": 41593152, "question_id": 41590346, "link": "https://stackoverflow.com/questions/41590346/userform-close-button-fails-after-form-launched-for-second-time/41593152#41593152", "title": "UserForm Close button fails after form launched for second time", "body": "<p>Use a variable to refer to the 2nd <code>Userform</code> in the first as this gives you greater control over the second forms status - you can unset the variable after you have closed the 2nd form and returned to the event handler that instantiated it in the first place. This guarantees that each time you click the button to launch <code>UserForm2</code> that you are working with a 'fresh copy'.</p>\n\n<p>Also you should use the <code>QueryClose</code> event - see <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278635.aspx\" rel=\"nofollow noreferrer\">MSDN</a>. This event:</p>\n\n<blockquote>\n  <p>Occurs before a UserForm closes</p>\n</blockquote>\n\n<p>You need to be able to be able to control the re-activation of <code>UserForm1</code> before the form is disposed. </p>\n\n<p>The <code>Terminate</code> event is slightly different:</p>\n\n<blockquote>\n  <p>Occurs when all references to an instance of an object are removed from memory by setting all variables that refer to the object to Nothing or when the last reference to the object goes out of scope.</p>\n</blockquote>\n\n<p>In the sample code below I am getting the correct behaviour using a reference to <code>UserForm2</code> and handling <code>QueryClose</code>. </p>\n\n<p>In this sample code I am using <code>UserForm1</code> and <code>UserForm2</code> but you can substitue for <code>A</code> and <code>B</code> in your app:</p>\n\n<h2>Code in <code>UserForm1</code>:</h2>\n\n<pre><code>Option Explicit\n\nPrivate m_frm2 As UserForm2\n\nPrivate Sub CommandButton1_Click()\n\n    Me.Hide\n    Set m_frm2 = New UserForm2\n    m_frm2.Show\n    Set m_frm2 = Nothing\n\nEnd Sub\n</code></pre>\n\n<h2>Code in <code>UserForm2</code>:</h2>\n\n<pre><code>Option Explicit\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    UserForm1.Show\n    Unload Me\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 3203020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a987a4e483f149eed5eb9bb07038b08e?s=128&d=identicon&r=PG&f=1", "display_name": "TehJake", "link": "https://stackoverflow.com/users/3203020/tehjake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1068, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484144642, "creation_date": 1484135800, "last_edit_date": 1531164843, "question_id": 41590346, "link": "https://stackoverflow.com/questions/41590346/userform-close-button-fails-after-form-launched-for-second-time", "title": "UserForm Close button fails after form launched for second time", "body": "<p>I have a <code>UserForm</code>, A, with a command button that opens <code>UserForm</code> B using the below code: </p>\n\n<pre><code>Private Sub cmd_click()\n    Me.Hide\n    B.Show\nEnd Sub\n</code></pre>\n\n<p>B, when closed via the X button, runs the following:</p>\n\n<pre><code>Private Sub UserForm_Terminate()\n    Unload Me\n    A.Show\nEnd Sub\n</code></pre>\n\n<p>After:</p>\n\n<ul>\n<li>opening B (from A)</li>\n<li>closing B and returning to A </li>\n<li>and then opening B again</li>\n</ul>\n\n<p>The close button on B ceases to work. </p>\n\n<p><code>UserForm</code> A is a menu form that leads to several others, so navigating back and forth between the menus is a pretty basic requirement. This behaviour is reproducible for every form linked from A, as well as for tertiary forms that open from those. </p>\n\n<p>Given my target demographic is of the older generation, I want my <code>UserForms</code> to be intuitive to use, which means preserving regular close button functionality.</p>\n\n<p>Does anyone have any info on this? It may be that my google-fu is lacking, but I can't seem to find anyone who has had the same issue. Any input at this stage is greatly appreciated!</p>\n"}, {"tags": ["vba", "excel", "excel-2007"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484134002, "post_id": 41589639, "comment_id": 70382773, "body": "you have <code>Function getCodeFromUser() As Variant</code> in the middle of your <code>Sub consumption()</code> ? where is your <code>End Sub</code> ?"}, {"owner": {"reputation": 23, "user_id": 6567755, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5a96938e0e83b856405cc6f3ce8bef00?s=128&d=identicon&r=PG&f=1", "display_name": "divy.h", "link": "https://stackoverflow.com/users/6567755/divy-h"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484136500, "post_id": 41589639, "comment_id": 70384378, "body": "Sorry my mistake. Actually it is not complete code so i forgot to mention it. @shai Rado"}, {"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 0, "creation_date": 1484137340, "post_id": 41589639, "comment_id": 70384938, "body": "Also the var <code>code</code> is never defined neither <code>true</code> or <code>false</code>, and yet you want to loop until its <code>false</code>. The default value for Boolean variables is <code>false</code>, which will cause it not to loop, because its already <code>false</code>"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6567755, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5a96938e0e83b856405cc6f3ce8bef00?s=128&d=identicon&r=PG&f=1", "display_name": "divy.h", "link": "https://stackoverflow.com/users/6567755/divy-h"}, "edited": false, "score": 0, "creation_date": 1484167024, "post_id": 41591148, "comment_id": 70403213, "body": "Can i recall values from sub?  Because platecode and &quot;i&quot; are define in sub and value of &quot;i&quot; is dependent user&#39;s entered counter value. I think you will be more clear after i show you full code. I will do that as soon as possibles. I am extremely sorry for this delay and thank you for pointing out mistakes."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 23, "user_id": 6567755, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5a96938e0e83b856405cc6f3ce8bef00?s=128&d=identicon&r=PG&f=1", "display_name": "divy.h", "link": "https://stackoverflow.com/users/6567755/divy-h"}, "edited": false, "score": 0, "creation_date": 1484200556, "post_id": 41591148, "comment_id": 70414045, "body": "@divy.h you could do that, but then you have to define these variables outside the <code>Sub</code> level, but in the module level, right after <code>Option Explicit</code>, and define each one of them as <code>Public</code> (look at updated code above)"}, {"owner": {"reputation": 23, "user_id": 6567755, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5a96938e0e83b856405cc6f3ce8bef00?s=128&d=identicon&r=PG&f=1", "display_name": "divy.h", "link": "https://stackoverflow.com/users/6567755/divy-h"}, "edited": false, "score": 0, "creation_date": 1484209928, "post_id": 41591148, "comment_id": 70418310, "body": "I have change my code as you suggested and answered your question. Please check my edited code.@Shai Rado"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1484200731, "last_edit_date": 1484200731, "creation_date": 1484138152, "answer_id": 41591148, "question_id": 41589639, "link": "https://stackoverflow.com/questions/41589639/i-am-trying-to-validate-my-data-using-data-validation/41591148#41591148", "title": "I am trying to validate my data using data validation", "body": "<p>This is not the answer, it's just too long to put as a comment.</p>\n\n<p>Read the slightly modified code below, and see my comments (especially the ones with <code>?</code> , where it indicates where you have an error).</p>\n\n<p><strong>Note</strong>: as good coding practice, always use <code>Option Explicit</code> in the beginning of your code, when you try to <strong>Compile VBAProject</strong> you will get an error, and the curser will point to all the lines where you have variables which have not been properly defined.</p>\n\n<p><strong>Temp. modified code</strong></p>\n\n<pre><code>Option Explicit \n\n' Public variables definition section\nPublic Platecode As Integrer\nPublic code as Boolean ' &lt;-- not the greateset variable name\nPublic ws As Worksheet     \n\n'==============================================================\n\nSub consumption()\n\nDim counter As Integer\nDim i As Integer\nDim x As Integer\n'Dim ws As Worksheet ' &lt;-- remove from here, define as Public\nDim wc As Worksheet\nDim rangs As Range, rangc As Range\n\nSet ws = ThisWorkbook.Worksheets(\"current stock\")\nSet wc = ThisWorkbook.Worksheets(\"consumption\")\n\nCall getCodeFromUser \n\nEnd Sub\n\n'==================================================================\n\nFunction getCodeFromUser As Variant\n\nDim Rng As Range\n\nDo\n    Platecode = Application.InputBox(prompt:=\"Enter a code\", Type:=1) ' where is Platecode defined or set ?\n\n    Set Rng = ws.Range(\"c4:c128\").Find(What:=Platecode, LookAt:=xlWhole)\n    If Not Rng Is Nothing Then Exit Function ' &lt;-- you want to exit the function if Find was Successful ?\n\n    With ws.Cells(i, 4).Validation ' &lt; where is i defined or set ?\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:=\"=\" &amp; rangs.Address ' &lt;-- where is rangs defined or set ?\n\n        If ws.Cells(i, 4) Is Nothing Then ' &lt;-- this If doesn't need to be nested inside the 'With' above\n            MsgBox \"Something is wrong with \" &amp; ws.Cells(i, 4).value\n        End If\n    End With\nLoop Until code = False ' where is code defined ? where do you reset it?\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6567755, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5a96938e0e83b856405cc6f3ce8bef00?s=128&d=identicon&r=PG&f=1", "display_name": "divy.h", "link": "https://stackoverflow.com/users/6567755/divy-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1484225469, "creation_date": 1484133889, "last_edit_date": 1484225469, "question_id": 41589639, "link": "https://stackoverflow.com/questions/41589639/i-am-trying-to-validate-my-data-using-data-validation", "title": "I am trying to validate my data using data validation", "body": "<p>I have list of data in current stock sheet and i want to check if user's entered value match with one of value of the list. Suppose current stock sheet has 16.001,15.002,15.0089 etc. and i want to check if users entered value match with one of the listed value in current stock or not. my range in both the sheet is dynamic. I am getting run-time error 424.</p>\n\n<pre><code>       ' my current sheet is consumption(wc)\n     Option Explicit\n\n Public i As Integer\n Public wc As Worksheet\n Public ws As Worksheet\n\n\nSub consumption()\n\nDim counter As Integer\nDim erow As Integer, counterrun As Integer\nDim result As Integer, result1 As Integer, loopresult As Integer\nDim user As String\n\nSet ws = ThisWorkbook.Worksheets(\"current stock\")\n\nSet wc = ThisWorkbook.Worksheets(\"consumption\")\nerow = wc.Cells(wc.Rows.Count, 3).End(xlUp).Row + 1\n\ncounter = Application.InputBox(prompt:=\"Enter a counter:\", Type:=1)\nFor i = erow To counterrun\n\n  Cells(i, 3).Value = Application.InputBox(prompt:=\"Entre a Dwg No.\", Type:=2)\nCall getCodeFromUser\n\nEnd Sub\n\n\nFunction getCodeFromUser() As Variant\nDim rng As Range\nDim platecode As Integer ' my platecode is like 16.0012\n\nDo\n    platecode = Application.InputBox(prompt:=\"Enter a code\", Type:=1)\n\n  Set rng = ws.Range(\"C4:C25860\").Find(What:=platecode, LookAt:=xlWhole) ' error 91 occurs here.\n\n    If Not rng Is Nothing Then Exit Function  ' if platecode is not from rng  i want to exit\n   With rng.Validation\n.Delete\n    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:=\"=\" &amp; rng.Address ' yes i want to go back to my sub when value is correct\n\n\nIf rng Is Nothing Then ' what do you suggest instead of this If?\n\n        MsgBox \"Somthing is wrong with \" &amp; platecode\n    End If\n\nEnd With\n\n\nLoop Until platecode = True ' i want to run this loop till values are match\nCells(i, 4).Value = platecode ' stored location. it will save value of platecode if it is true.\n' value of \"i\" is taken from public\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "email", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6403325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/977e97043b96a0e5c1477ef810dec0f5?s=128&d=identicon&r=PG&f=1", "display_name": "B\u0142a\u017cej \u0141aszewski", "link": "https://stackoverflow.com/users/6403325/b%c5%82a%c5%bcej-%c5%81aszewski"}, "edited": false, "score": 0, "creation_date": 1488032414, "post_id": 42351899, "comment_id": 72056982, "body": "I solved the problem by different way, but I will look closer to your solution when I will have some free time. I think I tried something like that with no succeeds..."}, {"owner": {"reputation": 4750, "user_id": 428811, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9c08c7f05e0d0444cd72807e8911d728?s=128&d=identicon&r=PG", "display_name": "Mr. TA", "link": "https://stackoverflow.com/users/428811/mr-ta"}, "reply_to_user": {"reputation": 11, "user_id": 6403325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/977e97043b96a0e5c1477ef810dec0f5?s=128&d=identicon&r=PG&f=1", "display_name": "B\u0142a\u017cej \u0141aszewski", "link": "https://stackoverflow.com/users/6403325/b%c5%82a%c5%bcej-%c5%81aszewski"}, "edited": false, "score": 0, "creation_date": 1573742245, "post_id": 42351899, "comment_id": 103989544, "body": "@B\u0142a\u017cej\u0141aszewski do you mind sharing how you fixed it? We&#39;re experiencing the same problem."}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1487615537, "creation_date": 1487615537, "answer_id": 42351899, "question_id": 41589424, "link": "https://stackoverflow.com/questions/41589424/change-from-field-in-reply-event-for-a-shared-mailbox/42351899#42351899", "title": "Change &#39;FROM&#39; field in reply event for a shared mailbox", "body": "<p>For your purposes I think you need SendUsingAccount</p>\n\n<pre><code>Private Sub oItem_Reply(ByVal Response As Object, Cancel As Boolean)\n\n    strSender1 = \"Name of mailbox1\"\n\n    If Response.Class = olMail Then\n\n        If oItem.AutoForwarded = True Then\n\n            If oItem.Sender = strSender1 Then\n\n                ' oItem was autoforwarded from\n                '  strSender1 - name of shared mailbox which is owner of the mail\n                Response.SendUsingAccount = Session.Accounts.Item(1)\n                MsgBox \"Field 'From' has been changed to \" + strSender1\n\n            End If\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>To determine the account number:</p>\n\n<pre><code>Private Sub AccountNames()\n\n    Dim i As Long\n\n    For i = 1 To Session.Accounts.Count\n        Debug.Print \" Account \" &amp; i &amp; \" DisplayName....: \" &amp; _\n          Session.Accounts.Item(i).DisplayName\n        Debug.Print\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6403325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/977e97043b96a0e5c1477ef810dec0f5?s=128&d=identicon&r=PG&f=1", "display_name": "B\u0142a\u017cej \u0141aszewski", "link": "https://stackoverflow.com/users/6403325/b%c5%82a%c5%bcej-%c5%81aszewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 939, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554706446, "creation_date": 1484133275, "last_edit_date": 1554706446, "question_id": 41589424, "link": "https://stackoverflow.com/questions/41589424/change-from-field-in-reply-event-for-a-shared-mailbox", "title": "Change &#39;FROM&#39; field in reply event for a shared mailbox", "body": "<p><strong>Description of the problem:</strong></p>\n\n<p>I have to change the sender ('from' field ) of a message. I added two shared mailbox accounts and while I'm clicking reply on the item, which belongs to one of them, I want to send this reply message from the other shared mailbox.</p>\n\n<p><strong>My (not working) solution:</strong></p>\n\n<p>I used event _Reply. I'm changing the property .SentOnBehalfOfName, assigning the email address of the second shared mailbox. The 'from' field in the message editor changes to the proper address, but after sending the message the person who received it sees that I sent it from the first email address and in my \"sent items\" folder the message appears as sent on behalf of \"second email address\".</p>\n\n<p><strong>My code (located in thisOutlookSession):</strong> </p>\n\n<pre><code>Option Explicit\nPrivate WithEvents oExpl As Explorer\nPrivate WithEvents oItem As MailItem\nPrivate bDiscardEvents As Boolean\nPublic WithEvents myOlApp As Outlook.Application\n\nPublic strSender1 As String 'name of shered mailbox which is owner of the mail\nPublic strSender2 As String 'address of shered mailbox\n\nPrivate Sub Application_Startup()\n   Set oExpl = Application.ActiveExplorer\n   bDiscardEvents = False\nEnd Sub\n\nPrivate Sub oExpl_SelectionChange()\n   On Error Resume Next\n   Set oItem = oExpl.Selection.Item(1)\nEnd Sub\n\nPrivate Sub oItem_Reply(ByVal Response As Object, Cancel As Boolean)\n    strSender1 = \"Name of mailbox1\"\n    strSender2 = \"mailbox2@dsg.dk\"\n    If Response.Class = olMail Then\n        If Response.Sender Is Nothing Then\n             'MsgBox \"There's no sender for the current email\", vbInformation\n             Exit Sub\n        End If\n        If Response.Sender = strSender1 Then\n            MsgBox \"Field 'From' has been changed to \" + strSender2\n            Response.SentOnBehalfOfName = strSender2\n        End If\n    End If\n    MsgBox Response.SentOnBehalfOfName\n    'Set oItem = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "textbox"], "answers": [{"comments": [{"owner": {"reputation": 235, "user_id": 4482610, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/82aa9cb1fda6262b0162842cb8d9ea0f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4482610/mike"}, "edited": false, "score": 0, "creation_date": 1484133496, "post_id": 41589313, "comment_id": 70382417, "body": "So is it simple to say it is because I am using a very old version of Excel (I believe version 10.0, 2002) this won&#39;t work?"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 235, "user_id": 4482610, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/82aa9cb1fda6262b0162842cb8d9ea0f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4482610/mike"}, "edited": false, "score": 0, "creation_date": 1484133721, "post_id": 41589313, "comment_id": 70382586, "body": "I expect that the limit changes from version to version - I added this pertinent information to your question. HTH for Excel 2013. WHy don&#39;t you try running the code with 255 and 256 limits on your version and update your question?"}, {"owner": {"reputation": 235, "user_id": 4482610, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/82aa9cb1fda6262b0162842cb8d9ea0f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4482610/mike"}, "edited": false, "score": 0, "creation_date": 1484133951, "post_id": 41589313, "comment_id": 70382738, "body": "You&#39;re right, the limits are much less.  Thanks for your response, I&#39;m going to have to have a little re-think of what I am doing."}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 3, "last_activity_date": 1484133347, "last_edit_date": 1484133347, "creation_date": 1484132954, "answer_id": 41589313, "question_id": 41588673, "link": "https://stackoverflow.com/questions/41588673/vba-text-string-limit-in-textbox/41589313#41589313", "title": "VBA text string limit in Textbox", "body": "<p>In my 32-bit Excel 2013 the limit is <strong>32767</strong> - (2^15)-1 - characters. Try run this VBA and see if you get the same error has me:</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    Dim ws As Worksheet\n    Dim shp As Shape\n    Dim strFill As String\n    Dim strTest As String\n    Dim lng As Long\n\n\n    Set ws = Sheet1\n    Set shp = ws.Shapes.AddTextbox(msoTextOrientationHorizontal, _\n        ws.Range(\"A1\").Left, ws.Range(\"A1\").Top, 500, 500)\n    strTest = \"blah blah blah\"\n\n    'enter 32767 x characters in textbox\n    strFill = VBA.String(32767, \"x\")\n    shp.TextFrame.Characters.Text = strFill\n\n    'check the string length\n    MsgBox Len(shp.TextFrame.Characters.Text)\n\n    'overwrite the string\n    shp.TextFrame.Characters.Text = strTest\n    MsgBox \"overwritten with \" &amp; strTest\n\n    'enter 32768 x characters in textbox\n    strFill = VBA.String(32768, \"x\")\n    shp.TextFrame.Characters.Text = strFill '&lt;~~ error should occur on this line!\n\nEnd Sub\n</code></pre>\n\n<p>The error is:</p>\n\n<blockquote>\n  <p>Run-time error '1004': Unable to set the Text property of the Characters class</p>\n</blockquote>\n\n<p>Occuring on the 2nd line of code below, where an attempt is made to populate the <code>Textbox</code> which a string of 32,768 characters in length:</p>\n\n<pre><code>strFill = VBA.String(32768, \"x\")\nshp.TextFrame.Characters.Text = strFill\n</code></pre>\n"}], "owner": {"reputation": 235, "user_id": 4482610, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/82aa9cb1fda6262b0162842cb8d9ea0f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4482610/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4384, "favorite_count": 0, "accepted_answer_id": 41589313, "answer_count": 1, "score": 3, "last_activity_date": 1484133669, "creation_date": 1484131369, "last_edit_date": 1495539965, "question_id": 41588673, "link": "https://stackoverflow.com/questions/41588673/vba-text-string-limit-in-textbox", "title": "VBA text string limit in Textbox", "body": "<p>I came across an answer on here regarding getting text from a textBox in Excel, using VBA:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/21673105/get-the-value-of-a-textbox-to-a-cell\">Get the value of a textbox to a cell</a></p>\n\n<p>I commented today but not being sure whether that will be picked up I thought I'd ask the question.  </p>\n\n<p>My Excel version is 2002/ version 10. My query is whether this method of returning the text from a <code>TextBox</code> is limited to return a certain number of characters / length of string. </p>\n\n<p><code>Worksheets(\"Sheet1\").Shapes(\"TextBox 1\").TextFrame.Characters.Text</code></p>\n\n<p>This returns the text but it is not returning the entire string.  </p>\n\n<p>When I use:</p>\n\n<p><code>Worksheets(\"Sheet1\").Shapes(\"TextBox 1\").TextFrame.Characters.Text = \"blah blah blah\"</code></p>\n\n<p>It sets the text to \"blah blah blah\" unless the initial text is quite long.  In which case it overwrites the majority of the existing text \"blah blah blah\" but then also includes the remaining part of text.  </p>\n\n<p>I hope this makes sense and I hope somebody knows the answer.  </p>\n\n<p>Thanks</p>\n\n<p>****IN ADDITION****\nIn fact, I have just looked and what is interesting and think answers my question is the amount of characters it returns is 255 (the famous 255).  </p>\n\n<p>So with this in mind I think my question needs changing to, \"Is there a way around this being limited to 255 characters?\"</p>\n"}, {"tags": ["vba", "excel", "duplicates", "call"], "answers": [{"comments": [{"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1484133499, "post_id": 41588489, "comment_id": 70382419, "body": "Thank you for taking the time to respond Vityata. I made the change but no luck. It doesn&#39;t work unfortunately."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1484133597, "post_id": 41588489, "comment_id": 70382493, "body": "Save the sheet, close it, open it and try again. It should work."}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1484133821, "post_id": 41588489, "comment_id": 70382656, "body": "Hi. Again thanks. I saved the sheet, closed it and opened it again. But its is unfortunately still not working."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1484133883, "post_id": 41588489, "comment_id": 70382691, "body": "And if you try it with <code>ConsolidateDupes</code> without the button it works?"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1484134052, "post_id": 41588489, "comment_id": 70382812, "body": "correct. If i put the code into the sheet without the button and run the code. It works perfectly. its when I click the command button on the instructions sheet that it doesn&#39;t work"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1484135987, "post_id": 41588489, "comment_id": 70384033, "body": "Hi Vityata: Thank you so much for the help it is greatly appreciated. The first dirty solution is bugging on the line my_FileName.Activate and the error is run time error 424."}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1484136127, "post_id": 41588489, "comment_id": 70384136, "body": "The second example is looking to end an if so i put it under Set wks = my_FileName.Sheet1     lastRow = wks.UsedRange.Rows.Count but hten it bugs out on line Set wks = my_FileName.Sheet1 again error 424. Again thank you for the help it is very much appreciated"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1484139812, "post_id": 41588489, "comment_id": 70386576, "body": "Hi. I tried it and it is now bugging on Set wkb = Application.Workbooks(my_FileName) run time error 9 out of range"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1484144000, "post_id": 41588489, "comment_id": 70389202, "body": "I tried it again but still no luck. Run time error 9 is still happening on Set wkb = Application.Workbooks(strFileName)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1484144402, "post_id": 41588489, "comment_id": 70389506, "body": "Check again the new edit. Just make sure that the workbook with the button is the only one opened."}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1484145088, "post_id": 41588489, "comment_id": 70389986, "body": "The button workbook was the only one open but when i run the code now i get a run time error 438 object does not support this property or method on line Set wks = wkb.Sheet1"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 1, "creation_date": 1484145228, "post_id": 41588489, "comment_id": 70390077, "body": "Open was written with M. Try again :)"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1484145904, "post_id": 41588489, "comment_id": 70390533, "body": "Hi Vityata: SO BOO YEAH we def need to change Opem to Open but we also needed to change Set wks = wkb.Sheet1 to Set wks = ActiveWorkbook.Sheets(1)  With these changes it works perfectly! Thank you so much for your time and Patience it is greatly appreciated. Much respect from Dublin"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1484146120, "post_id": 41588489, "comment_id": 70390698, "body": "Well, I thought that Sheet1 was the sheet name in the file -&gt; <a href=\"https://qph.ec.quoracdn.net/main-qimg-b9f870535e06783fec8a6252ca24c28a?convert_to_webp=true\" rel=\"nofollow noreferrer\">qph.ec.quoracdn.net/&hellip;</a>"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1484146219, "post_id": 41588489, "comment_id": 70390760, "body": "Ah no problem. Thanks again for the help. I have accepted the answer and I hope you get lots of Stack points, and if there is anything else i can do please let me know. :-)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1484146413, "post_id": 41588489, "comment_id": 70390906, "body": "No problem, glad that I managed to help you. I usually check my code, and test it before giving it, but today was something else. Btw, its a good idea to remove the pics, as far as the info there could be private and plenty of companies would not like it. Anyhow, this is how it should have been: <code>ActiveWorkbook.Worksheets(&quot;Sheet1&quot;)</code>"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 1, "creation_date": 1484146648, "post_id": 41588489, "comment_id": 70391066, "body": "Oh you have helped greatly i hope to pay it all forward some day. I have removed the pics thanks for the heads up. sound advice."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 1, "creation_date": 1484146943, "post_id": 41588489, "comment_id": 70391268, "body": "Good to know - once you become more experienced you may take a look again at the code and remove the <code>ActiveWorkbook</code> part and set the workbook directly. Activeworkbook, activesheet, activecell, etc. is considered bad practise in VBA. But as far as it works, it is ok."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1484308914, "last_edit_date": 1484308914, "creation_date": 1484130914, "answer_id": 41588489, "question_id": 41588426, "link": "https://stackoverflow.com/questions/41588426/vba-code-not-executing-properly-when-called/41588489#41588489", "title": "VBA code not executing properly when called", "body": "<p>Can you delete this:</p>\n\n<pre><code>    Rows(r).Delete\n</code></pre>\n\n<p>And write this instead:</p>\n\n<pre><code>    wks.Rows(r).Delete\n</code></pre>\n\n<p>Edit:\nTry this:\n(very dirty solution, but it should work)</p>\n\n<pre><code>Sub Open_Workbook_Dialog()\n\n\n    Dim strFileName     As string\n    dim wkb             as workbook\n    Dim wks             As Worksheet\n    Dim lastRow         As Long\n    Dim r               As Long\n\n    MsgBox \"Select Denmark File\" '&lt;--| txt box for prompt to pick a file\n\n        strFileName = Application.GetOpenFilename(FileFilter:=\"Excel Files,*.xl*;*.xm*\") '&lt;--| Opens the file window to allow selection\n\n    set wkb = Application.Workbooks.Open(strFileName)\n    Set wks = wkb.Sheet1\n    lastRow = wks.UsedRange.Rows.Count\n\n    For r = lastRow To 3 Step -1\n        ' Identify Duplicate\n        If wks.Cells(r, 1) = wks.Cells(r - 1, 1) _\n        And wks.Cells(r, 2) = wks.Cells(r - 1, 2) _\n        And wks.Cells(r, 3) = wks.Cells(r - 1, 3) _\n        And wks.Cells(r, 4) = wks.Cells(r - 1, 4) _\n        And wks.Cells(r, 5) = wks.Cells(r - 1, 5) _\n        And wks.Cells(r, 6) = wks.Cells(r - 1, 6) _\n        And wks.Cells(r, 7) = wks.Cells(r - 1, 7) Then\n            ' Update Start Date on Previous Row\n            If wks.Cells(r, 8) &lt; wks.Cells(r - 1, 8) Then\n                wks.Cells(r - 1, 8) = wks.Cells(r, 8)\n            End If\n            ' Update End Date on Previous Row\n            If wks.Cells(r, 9) &gt; wks.Cells(r - 1, 9) Then\n                wks.Cells(r - 1, 9) = wks.Cells(r, 9)\n            End If\n            ' Delete Duplicate\n            Rows(r).Delete\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>However, the problem is that it did not work, because you did not pass the my_FileName to the ConsolidateDupes procedure. Thus, the procedure was executing in the file with the button, and it was a bit meaningless there.</p>\n\n<p>Hi so some changes were need to get this to work and the code that works is below I hope it helps a fellow VBA'r out :-) </p>\n\n<pre><code>   Sub Open_Workbook_Dialog()\n\n\n    Dim strFileName     As String\n    Dim wkb             As Workbook\n    Dim wks             As Worksheet\n    Dim LastRow         As Long\n    Dim r               As Long\n\n    MsgBox \"Select Denmark File\" '&lt;--| txt box for prompt to pick a file\n\n        strFileName = Application.GetOpenFilename(FileFilter:=\"Excel Files,*.xl*;*.xm*\") '&lt;--| Opens the file window to allow selection\n\n    Set wkb = Application.Workbooks.Open(strFileName)\n    Set wks = ActiveWorkbook.Sheets(1)\n    LastRow = wks.UsedRange.Rows.Count\n\n    ' Sort the B Column Alphabetically\n    With ActiveWorkbook.Sheets(1)\n\n        Dim LastRow2 As Long\n        LastRow2 = .Cells(Rows.Count, 1).End(xlUp).Row\n        Dim LastCol As Long\n        LastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n        With ActiveWorkbook.Worksheets(\"Sheet1\").Sort\n            .SortFields.Clear\n            .SortFields.Add Key:=Range(Cells(2, 2), Cells(LastRow, 2)), _\n                            SortOn:=xlSortOnValues, _\n                            Order:=xlAscending, _\n                            DataOption:=xlSortNormal\n            .SetRange Range(Cells(2, 1), Cells(LastRow, LastCol))\n            .Header = xlNo\n            .MatchCase = False\n            .Orientation = xlTopToBottom\n            .SortMethod = xlPinYin\n            .Apply\n\n        End With\n\n    End With\n\n    For r = LastRow To 3 Step -1\n        ' Identify Duplicate\n        If wks.Cells(r, 1) = wks.Cells(r - 1, 1) _\n        And wks.Cells(r, 2) = wks.Cells(r - 1, 2) _\n        And wks.Cells(r, 3) = wks.Cells(r - 1, 3) _\n        And wks.Cells(r, 4) = wks.Cells(r - 1, 4) _\n        And wks.Cells(r, 5) = wks.Cells(r - 1, 5) _\n        And wks.Cells(r, 6) = wks.Cells(r - 1, 6) _\n        And wks.Cells(r, 7) = wks.Cells(r - 1, 7) Then\n           ' Update Start Date on Previous Row\n        If CDate(wks.Cells(r, 8)) &lt; CDate(wks.Cells(r - 1, 8)) Then\n         wks.Cells(r - 1, 8) = wks.Cells(r, 8)\n        End If\n        ' Update End Date on Previous Row\n        If CDate(wks.Cells(r, 9)) &gt; CDate(wks.Cells(r - 1, 9)) Then\n        wks.Cells(r - 1, 9) = wks.Cells(r, 9)\n        End If\n            ' Delete Duplicate\n            Rows(r).Delete\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "accepted_answer_id": 41588489, "answer_count": 1, "score": 0, "last_activity_date": 1484308914, "creation_date": 1484130712, "last_edit_date": 1484146559, "question_id": 41588426, "link": "https://stackoverflow.com/questions/41588426/vba-code-not-executing-properly-when-called", "title": "VBA code not executing properly when called", "body": "<p>Hi all I hope you can help. I have a piece of code see below. </p>\n\n<p>What I am trying to achieve is that a user opens up an Excel sheet that contains   a command button and instructions. \nOnce the command button is clicked a dialog box opens up which then allows the user to select another excel sheet, once that excel sheet is selected another piece of code (should) fire and duplicates are consolidated and start dates and end dates are amended, and the sheet is left open in its desired state free of duplicates and dates correct. </p>\n\n<p>The piece of code </p>\n\n<pre><code>Public Sub ConsolidateDupes()\n</code></pre>\n\n<p>works perfectly when it is run by itself, on the original sheet but when I try to call it with the command button , its is not working correctly. No error appears it just does not remove all the possible duplicates and does not work the dates to the earliest start and latest end date </p>\n\n<p>I have added pictures to make explanation easier \nPic 1 </p>\n\n<p>Excel sheet with Command Button </p>\n\n<p>Pic 2 the Sheet to be selected in its original state with Duplicates and multiple start and end dates </p>\n\n<p>The selected sheet after code has been run by itslef on that sheet </p>\n\n<p>The selected sheet when it is called when command button is used </p>\n\n<p>As you can hopefully see the Duplicates are left and the dates are not worked to the earliest start date and latest end date </p>\n\n<p>As i said the code works perfectly when run on the sheet by itself but when it is called it leaves duplicates and is not working the start and end dates </p>\n\n<p>Here is my code any help is as always greatly appreciated. </p>\n\n<p>CODE </p>\n\n<pre><code>Sub Open_Workbook_Dialog()\n\nDim my_FileName As Variant\n\n    MsgBox \"Select Denmark File\" '&lt;--| txt box for prompt to pick a file\n\n        my_FileName = Application.GetOpenFilename(FileFilter:=\"Excel Files,*.xl*;*.xm*\") '&lt;--| Opens the file window to allow selection\n\n    If my_FileName &lt;&gt; False Then\n    Workbooks.Open Filename:=my_FileName\n\n\nCall ConsolidateDupes   '&lt;--|Calls the Filter Code and executes\n\nEnd If\n\n\nEnd Sub\n\nPublic Sub ConsolidateDupes()\n    Dim wks As Worksheet\n    Dim lastRow As Long\n    Dim r As Long\n\n    Set wks = Sheet1\n\n    lastRow = wks.UsedRange.Rows.Count\n\n    For r = lastRow To 3 Step -1\n        ' Identify Duplicate\n        If wks.Cells(r, 1) = wks.Cells(r - 1, 1) _\n        And wks.Cells(r, 2) = wks.Cells(r - 1, 2) _\n        And wks.Cells(r, 3) = wks.Cells(r - 1, 3) _\n        And wks.Cells(r, 4) = wks.Cells(r - 1, 4) _\n        And wks.Cells(r, 5) = wks.Cells(r - 1, 5) _\n        And wks.Cells(r, 6) = wks.Cells(r - 1, 6) _\n        And wks.Cells(r, 7) = wks.Cells(r - 1, 7) Then\n            ' Update Start Date on Previous Row\n            If wks.Cells(r, 8) &lt; wks.Cells(r - 1, 8) Then\n                wks.Cells(r - 1, 8) = wks.Cells(r, 8)\n            End If\n            ' Update End Date on Previous Row\n            If wks.Cells(r, 9) &gt; wks.Cells(r - 1, 9) Then\n                wks.Cells(r - 1, 9) = wks.Cells(r, 9)\n            End If\n            ' Delete Duplicate\n            Rows(r).Delete\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "forms", "ms-access", "import"], "comments": [{"owner": {"reputation": 153, "user_id": 4137845, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-GOnqAEH8QoQ/AAAAAAAAAAI/AAAAAAAAAMI/q412c4RpHKk/photo.jpg?sz=128", "display_name": "Thapipo", "link": "https://stackoverflow.com/users/4137845/thapipo"}, "edited": false, "score": 0, "creation_date": 1484137228, "post_id": 41588284, "comment_id": 70384861, "body": "Your function DateiAuswaehlen will return the excel file path. So after calling this function  ,using DoCmd.TransferSpreadsheet should be easy, can we your code on how you&#39;re using it ?"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1484336036, "creation_date": 1484336036, "answer_id": 41642178, "question_id": 41588284, "link": "https://stackoverflow.com/questions/41588284/access-2010-import-excel-file-which-is-selected-with-a-filedialog/41642178#41642178", "title": "Access 2010: Import Excel File which is selected with a FileDialog", "body": "<p>Here you go!!</p>\n\n<pre><code>Sub btn_GetFileName_Click()\n'************************************************************************\n'Lets get the file name\n    Debug.Print \"Getting File Name\"\n    'Declare a variable as a FileDialog object.\n    Dim fd As FileDialog\n\n    'Set the starting look location\n    Dim strComPath As String\n    strComPath = \"C:\\\"\n\n    Dim strFilePath As String\n    'Create a FileDialog object as a File Picker dialog box.\n    Set fd = Application.FileDialog(msoFileDialogFilePicker)\n\n    'Declare a variable to contain the path\n    'of each selected item. Even though the path is a String,\n    'the variable must be a Variant because For Each...Next\n    'routines only work with Variants and Objects.\n    Dim vrtSelectedItem As Variant\n\n    'Use a With...End With block to reference the FileDialog object.\n    With fd\n        .InitialFileName = strComPath\n        .AllowMultiSelect = False\n        .Filters.Clear\n        'Add filter to only show excel files.\n        .Filters.Add \"Excel files\", \"*.xlsm\", 1\n        'Use the Show method to display the File Picker dialog box and return the user's action.\n        'The user pressed the action button.\n        If .Show = -1 Then\n                strFilePath = .SelectedItems(1)\n\n            'Step through each string in the FileDialogSelectedItems collection.\n            'For Each vrtSelectedItem In .SelectedItems\n\n                'vrtSelectedItem is a String that contains the path of each selected item.\n                'You can use any file I/O functions that you want to work with this path.\n                'This example simply displays the path in a message box.\n             '   strFilePath: \" &amp; vrtSelectedItem\n\n            'Next vrtSelectedItem\n\n        Else\n            'The user pressed Cancel.\n            DoCmd.Hourglass (False)\n            MsgBox \"You must select a file to import before proceeding\", vbOKOnly + vbExclamation, \"No file Selected, exiting\"\n            Set fd = Nothing\n            Exit Sub\n        End If\n    End With\n\n\n\n    tblFileName = strFilePath\n    DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel9, \"tblTest\", tblFileName, True\n\n    Set fd = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7403995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1c4764b8e2bb72aa92e9e188ef09593?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7403995/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 493, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593956851, "creation_date": 1484130314, "last_edit_date": 1593956851, "question_id": 41588284, "link": "https://stackoverflow.com/questions/41588284/access-2010-import-excel-file-which-is-selected-with-a-filedialog", "title": "Access 2010: Import Excel File which is selected with a FileDialog", "body": "<p>Im new to Access and VBA.\nI created a form in which i can select a file via fileDialog. </p>\n\n<p>Here the code for the fileDialog:</p>\n\n<pre><code>Public Function DateiAuswaehlen()\n\nDim objFiledialog As FileDialog\n\nSet objFiledialog = _\n    Application.FileDialog(msoFileDialogOpen)\n\nWith objFiledialog\n\n    .AllowMultiSelect = False\n\n    If .Show = True Then\n\n        DateiAuswaehlen = .SelectedItems(1)\n\n\n\n\n\n    End If\n\nEnd With\n\nSet objFiledialog = Nothing\n\nEnd Function\n</code></pre>\n\n<p>How can I import the selected Excel File into an access table?\nI found the DoCmd.TransferSpreadsheet Method but it has not worked, tbh i dont even know where to place it. Im sorry as I mentioned im very new to VBA</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1484129990, "post_id": 41588069, "comment_id": 70380038, "body": "What have you tried so far? Post up your code to show where the error lies."}], "answers": [{"tags": [], "owner": {"reputation": 486, "user_id": 6377101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/06cc0df790dd4134fffbd1a86751243a?s=128&d=identicon&r=PG&f=1", "display_name": "anonymous", "link": "https://stackoverflow.com/users/6377101/anonymous"}, "is_accepted": false, "score": 1, "last_activity_date": 1484153451, "creation_date": 1484153451, "answer_id": 41596364, "question_id": 41588069, "link": "https://stackoverflow.com/questions/41588069/insert-a-specific-number-of-rows-into-a-table-based-on-values-in-a-column-in-ano/41596364#41596364", "title": "Insert a specific number of rows into a table based on values in a column in another table", "body": "<p>Best way to learn how to create Macros is to use the Record Macro function. It will produce the code of what you do within the workbook, however, in this instance you require loops so it is more complex.</p>\n\n<p>The below code will achieve what you are looking for. I added in comments to explain what each line does.</p>\n\n<pre><code>Sub copyRow()\n\nApplication.ScreenUpdating = False                      'Turn off ScreenUpdating so you won't see all the\n                                                        'actions happen in real time\n\n    Dim count As Integer                                'Declare variables\n    Dim lastRow1 As Integer, lastRow2 As Integer\n    Dim ws1 As Worksheet, ws2 As Worksheet\n\n    Set ws1 = Worksheets(\"Sheet1\")                      'Set worksheet values\n    Set ws2 = Worksheets(\"Sheet2\")\n\n    ws1.Activate                                        'Sheet1 needs to be active to perform next step\n    lastRow1 = ws1.Range(\"A50\").End(xlUp).row           'Identify last row in table to know data size\n\n    For i = 2 To lastRow1                               'For the number of rows in table, perform the following\n        count = ws1.Range(\"F\" &amp; i).Value                'Set 'count' variable, number of times to paste row\n        ws1.Activate                                    'Sheet2 needs to be active to perform next step\n        ws1.Range(Range(\"A\" &amp; i), Range(\"D\" &amp; i)).Copy  'Copy data you want to transfer\n\n        ws2.Activate\n        lastRow2 = ws2.Range(\"A50\").End(xlUp).row       'Identify last row in table\n        lastRow2 = lastRow2 + 1                         'Want to paste data to NEXT row\n\n        For j = lastRow2 To lastRow2 + count - 1        'Paste the data the number of times indicated\n            ws2.Range(\"A\" &amp; j).PasteSpecial\n        Next j\n    Next i\n\nApplication.ScreenUpdating = True                       'Turn back on ScreenUpdating to see updated sheet\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7403924, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209371266173500/picture?type=large", "display_name": "Shwanal Chand", "link": "https://stackoverflow.com/users/7403924/shwanal-chand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 737, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484153451, "creation_date": 1484129731, "last_edit_date": 1531161705, "question_id": 41588069, "link": "https://stackoverflow.com/questions/41588069/insert-a-specific-number-of-rows-into-a-table-based-on-values-in-a-column-in-ano", "title": "Insert a specific number of rows into a table based on values in a column in another table", "body": "<p>I am a bit useless when it comes to excel VBA. I've got a problem that I need to solve where I have two tables on two separate worksheets in excel.</p>\n\n<p>Table 1 on sheet1 looks like this <a href=\"https://i.stack.imgur.com/Gzjd1.png\" rel=\"nofollow noreferrer\">1</a> (picture attached)</p>\n\n<p>What I need to achieve is to copy the values from the first 4 columns in table 1 and paste it into table 2 an \"x\" number of times in table2. \"x\" is defined by the corresponding value in the count column in table1.</p>\n\n<p>The resulting table2 on sheet2 should look something similar to this <a href=\"https://i.stack.imgur.com/Tqvr8.png\" rel=\"nofollow noreferrer\">2</a>: (picture attached)</p>\n\n<p>I would really appreciate if someone could show me how to achieve this with a vba macro.</p>\n\n<p>Thanks a lot!</p>\n\n<p>-shawn</p>\n"}, {"tags": ["excel", "vbscript", "vba"], "comments": [{"owner": {"reputation": 497, "user_id": 4956455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WMaZW.jpg?s=128&g=1", "display_name": "v.grabovets", "link": "https://stackoverflow.com/users/4956455/v-grabovets"}, "edited": false, "score": 1, "creation_date": 1484131098, "post_id": 41587762, "comment_id": 70380777, "body": "In your comment you write <code>ff = FreeFile_()</code> but in your code <code>ff = FreeFile()</code>. Initial code without underscore works fine."}, {"owner": {"reputation": 1, "user_id": 7403867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51e29a1c138796a359410dcf5443c223?s=128&d=identicon&r=PG&f=1", "display_name": "DejanBla\u017ei\u010d", "link": "https://stackoverflow.com/users/7403867/dejanbla%c5%bei%c4%8d"}, "reply_to_user": {"reputation": 497, "user_id": 4956455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WMaZW.jpg?s=128&g=1", "display_name": "v.grabovets", "link": "https://stackoverflow.com/users/4956455/v-grabovets"}, "edited": false, "score": 0, "creation_date": 1484131405, "post_id": 41587762, "comment_id": 70380969, "body": "Yes i know... In my code i wrote ff = FreeFile() but when I get error it has underscore in it."}, {"owner": {"reputation": 497, "user_id": 4956455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WMaZW.jpg?s=128&g=1", "display_name": "v.grabovets", "link": "https://stackoverflow.com/users/4956455/v-grabovets"}, "edited": false, "score": 0, "creation_date": 1484131955, "post_id": 41587762, "comment_id": 70381324, "body": "Try <code>ff = FreeFile</code> without parentheses. I have Excel 2016 and it works with or without them fine."}, {"owner": {"reputation": 1, "user_id": 7403867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51e29a1c138796a359410dcf5443c223?s=128&d=identicon&r=PG&f=1", "display_name": "DejanBla\u017ei\u010d", "link": "https://stackoverflow.com/users/7403867/dejanbla%c5%bei%c4%8d"}, "reply_to_user": {"reputation": 497, "user_id": 4956455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WMaZW.jpg?s=128&g=1", "display_name": "v.grabovets", "link": "https://stackoverflow.com/users/4956455/v-grabovets"}, "edited": false, "score": 0, "creation_date": 1484132312, "post_id": 41587762, "comment_id": 70381570, "body": "yeps, that works. but I got error in next line... the underscore showed right before Lock word. so it is like Syntax error on line 16: Open FileName For Input_Lock Read As #ff"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7403867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51e29a1c138796a359410dcf5443c223?s=128&d=identicon&r=PG&f=1", "display_name": "DejanBla\u017ei\u010d", "link": "https://stackoverflow.com/users/7403867/dejanbla%c5%bei%c4%8d"}, "edited": false, "score": 0, "creation_date": 1484218708, "post_id": 41593345, "comment_id": 70424081, "body": "Hello, thanks for answer. I rewrote whole code, but there was same error... i did get past it, but than i get stuck at the last line in case... again syntax error.."}, {"owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "reply_to_user": {"reputation": 1, "user_id": 7403867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51e29a1c138796a359410dcf5443c223?s=128&d=identicon&r=PG&f=1", "display_name": "DejanBla\u017ei\u010d", "link": "https://stackoverflow.com/users/7403867/dejanbla%c5%bei%c4%8d"}, "edited": false, "score": 0, "creation_date": 1484234422, "post_id": 41593345, "comment_id": 70434834, "body": "do you mean error at line &quot;Case Else: Error ErrNo&quot;? If so, then replace &quot;ErrNo = Err&quot; by &quot;ErrNo = Err.Number&quot;"}, {"owner": {"reputation": 1, "user_id": 7403867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51e29a1c138796a359410dcf5443c223?s=128&d=identicon&r=PG&f=1", "display_name": "DejanBla\u017ei\u010d", "link": "https://stackoverflow.com/users/7403867/dejanbla%c5%bei%c4%8d"}, "edited": false, "score": 0, "creation_date": 1484285542, "post_id": 41593345, "comment_id": 70456390, "body": "Yes, that&#39;s the error.. it says syntax error Case Else: _Error ErrNo  Tried the replace stuff, but i get same error.. Syntax error on that line. I am really confused now :/"}, {"owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "reply_to_user": {"reputation": 1, "user_id": 7403867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51e29a1c138796a359410dcf5443c223?s=128&d=identicon&r=PG&f=1", "display_name": "DejanBla\u017ei\u010d", "link": "https://stackoverflow.com/users/7403867/dejanbla%c5%bei%c4%8d"}, "edited": false, "score": 0, "creation_date": 1484320504, "post_id": 41593345, "comment_id": 70475121, "body": "In your code, delete the blank between &quot;Else: Error&quot;, then rewrite it in the same place."}], "tags": [], "owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "is_accepted": false, "score": 0, "last_activity_date": 1484144545, "creation_date": 1484144545, "answer_id": 41593345, "question_id": 41587762, "link": "https://stackoverflow.com/questions/41587762/check-if-excel-workbook-is-open/41593345#41593345", "title": "Check if excel workbook is open?", "body": "<p>I think you done copy/paste the code into VBA editor. So clean the code, delete all blancks that are not needed, verify where each line is finished.</p>\n"}], "owner": {"reputation": 1, "user_id": 7403867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51e29a1c138796a359410dcf5443c223?s=128&d=identicon&r=PG&f=1", "display_name": "DejanBla\u017ei\u010d", "link": "https://stackoverflow.com/users/7403867/dejanbla%c5%bei%c4%8d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 424, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494525083, "creation_date": 1484128862, "last_edit_date": 1531161705, "question_id": 41587762, "link": "https://stackoverflow.com/questions/41587762/check-if-excel-workbook-is-open", "title": "Check if excel workbook is open?", "body": "<p>So... I used this piece of code for reference: </p>\n\n<pre><code>Option Explicit\n\nSub Sample()\nDim Ret\n\nRet = IsWorkBookOpen(\"C:\\myWork.xlsx\")\n\nIf Ret = True Then\n    MsgBox \"File is open\"\nElse\n    MsgBox \"File is Closed\"\nEnd If\nEnd Sub\n\nFunction IsWorkBookOpen(FileName As String)\nDim ff As Long, ErrNo As Long\n\nOn Error Resume Next\nff = FreeFile()\nOpen FileName For Input Lock Read As #ff\nClose ff\nErrNo = Err\nOn Error GoTo 0\n\nSelect Case ErrNo\nCase 0:    IsWorkBookOpen = False\nCase 70:   IsWorkBookOpen = True\nCase Else: Error ErrNo\nEnd Select\nEnd Function\n</code></pre>\n\n<p>I used my workbook and everything, but it returns Syntax error on line 15: ff = FreeFile_().</p>\n\n<p>Why is this the case? What syntax error is there?\nI am trying to check if workbook is opened by some other user, because if that's the case, I can't save the values in the Workbook.</p>\n\n<p>Thanks for answers, D.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1484131201, "post_id": 41587259, "comment_id": 70380848, "body": "Your address:  <code>(&quot;B19&quot; &amp; Rows.Count)</code>  resolves to <code>B191048576</code>, which is an illegal address.  Hence the error.  The last empty cell in column B will be returned by <code>cells(rows.Count,&quot;B&quot;).end(xlup).offset(1,0)</code> <b>BUT</b> you will have to specifically test for <code>B19</code> not being empty, if you want to start at <code>B19</code>"}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1484128332, "post_id": 41587499, "comment_id": 70378852, "body": "This would be wrong, if there is no value in column B. In this case the OP wants the value to be written in B19."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1484128470, "post_id": 41587499, "comment_id": 70378954, "body": "I&#39;m not sure you are right, as I understood it most likely he has data up tp &quot;B19&quot;, that&#39;s why he wants to find the last row with data (after &quot;B19&quot;), and put &quot;A5&quot; in the first empty row below it (I might be wrong - the PO will explain better)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1484128786, "post_id": 41587499, "comment_id": 70379185, "body": "You can still start from B19, independently whether he has data before or not."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1484129150, "post_id": 41587499, "comment_id": 70379431, "body": "A little remark, although the OP did it that way, but I think it would be more logical to <code>msgbox &quot;done&quot;</code> <i>after</i> the success of the operation."}, {"owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "edited": false, "score": 0, "creation_date": 1484129258, "post_id": 41587499, "comment_id": 70379511, "body": "Data in A5 is inserted by using userform box. Thats a different story. But everytime data inserted in A5, the code above need to check whether the data is exist in column B. if no, insert the value in column B. However i need to start from B19."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "edited": false, "score": 0, "creation_date": 1484129348, "post_id": 41587499, "comment_id": 70379565, "body": "@Jeeva  so try the code above and see if it&#39;s fits ur needs"}, {"owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "edited": false, "score": 0, "creation_date": 1484129418, "post_id": 41587499, "comment_id": 70379614, "body": "@ShaiRado..no. it is not fit my requirement."}, {"owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "edited": false, "score": 0, "creation_date": 1484129574, "post_id": 41587499, "comment_id": 70379725, "body": "@ShaiRado because it start from B2. I want it start from B19"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "edited": false, "score": 0, "creation_date": 1484132728, "post_id": 41587499, "comment_id": 70381839, "body": "@Jeeva try now, copy the entire edited code (instead of my previous one) and see if it works like u wanted"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1484132649, "last_edit_date": 1484132649, "creation_date": 1484128211, "answer_id": 41587499, "question_id": 41587259, "link": "https://stackoverflow.com/questions/41587259/excel-vba-error-1004-when-inserting-value-in-last-non-empty-row/41587499#41587499", "title": "Excel VBA - Error &#39;1004&#39; when inserting value in last non empty row", "body": "<p>2 comments:</p>\n\n<p>First: <code>CountIf</code> returns a number, so if there is atleast one Count, you should check if the result is > 0 (not if <code>True</code>).</p>\n\n<p>Second: Getting to the last row with data after Range(\"B19\"), you need to use <code>.Range(\"B\" &amp; .Rows.Count).End(xlUp).Offset(1, 0)</code>.</p>\n\n<p>Try the code below:</p>\n\n<pre><code>Private Sub test()\n\nWith Sheets(\"Sheet1\")\n    If Application.CountIf(.Columns(2), .Range(\"A5\").Value) &gt; 0 Then\n        MsgBox \"Already taken, try another username\"\n    Else\n        If .Cells(.Rows.Count, \"B\").End(xlUp).Row &lt; 19 Then ' &lt;-- check if the last row in Column B is less than 19\n            .Range(\"B19\").Value = .Range(\"A5\").Value\n        Else\n            .Range(\"B\" &amp; .Rows.Count).End(xlUp).Offset(1, 0).Value = .Range(\"A5\").Value\n        End If\n\n        MsgBox \"Done\"           \n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "edited": false, "score": 0, "creation_date": 1484207593, "post_id": 41588620, "comment_id": 70417142, "body": "i implement the code by modify it as below:  change &quot;B19:B&quot; to &quot;L19:L&quot; and A5 to B24. However it start to key in from row 47."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "edited": false, "score": 0, "creation_date": 1484208710, "post_id": 41588620, "comment_id": 70417701, "body": "since you change reference column from &quot;B&quot; (i.e. column index 2) to &quot;L&quot; (i.e. column index 12) you also have to change <code>...Cells(.Rows.Count, 2)...</code> to <code>...Cells(.Rows.Count, 12)...</code>"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1484131219, "creation_date": 1484131219, "answer_id": 41588620, "question_id": 41587259, "link": "https://stackoverflow.com/questions/41587259/excel-vba-error-1004-when-inserting-value-in-last-non-empty-row/41588620#41588620", "title": "Excel VBA - Error &#39;1004&#39; when inserting value in last non empty row", "body": "<p>you could try this:</p>\n\n<pre><code>Private Sub main()\n    With Sheets(\"Sheet1\")\n        With .Range(\"B19:B\" &amp; WorksheetFunction.Max(.Cells(.Rows.Count, 2).End(xlUp).Row, 19))\n            If Application.CountIf(.Cells, .Parent.Range(\"A5\").Value) &gt; 0 Then\n                MsgBox \"Already taken, try another username\"\n            Else\n                .Cells(.Rows.Count + IIf(IsEmpty(.Cells(.Rows.Count)), 0, 1)).Value = .Parent.Range(\"A5\").Value\n                MsgBox \"Done\"\n            End If\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 41588620, "answer_count": 2, "score": 0, "last_activity_date": 1484132649, "creation_date": 1484127515, "last_edit_date": 1484128249, "question_id": 41587259, "link": "https://stackoverflow.com/questions/41587259/excel-vba-error-1004-when-inserting-value-in-last-non-empty-row", "title": "Excel VBA - Error &#39;1004&#39; when inserting value in last non empty row", "body": "<p>I get Run-time error '1004' </p>\n\n<blockquote>\n  <p>Application-defined or object-defined error</p>\n</blockquote>\n\n<p>when i'm try to insert value starting from B19.</p>\n\n<p>Below are the code:</p>\n\n<pre><code>Private Sub test()\n\nIf Application.CountIf(Sheets(\"Sheet1\").Columns(2), Range(\"A5\").Value) Then\n    MsgBox \"Already taken, try another username\"\nElse\n    MsgBox \"Done\"\n    Sheets(\"Sheet1\").Range(\"B19\" &amp; Rows.Count).End(xlUp).Offset(1, 0) = Range(\"A5\").Value\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>The purpose of this code is to insert value from A5 to last non empty row starting from B19.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1484149751, "post_id": 41587034, "comment_id": 70393069, "body": "Just a small note - probably it is a slightly better idea to use <code>public</code>, instead of <code>global</code> - <a href=\"http://stackoverflow.com/questions/3815547/what-is-the-difference-between-dim-global-public-and-private-as-modular-field\" title=\"what is the difference between dim global public and private as modular field\">stackoverflow.com/questions/3815547/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 5, "last_activity_date": 1484127840, "creation_date": 1484127840, "answer_id": 41587369, "question_id": 41587034, "link": "https://stackoverflow.com/questions/41587034/using-global-constants-to-store-environment-variables/41587369#41587369", "title": "Using Global Constants to store environment variables", "body": "<p>I usually do exactly the same or two other things, depending on the size of the application. If it is something small, I use your approach. However,these are the other approaches I use.</p>\n\n<p>First Approach:</p>\n\n<p>If the user is supposed to change the password or the default_value, I make a separate sheet, called \"Settings\" and I write them there. Then I make a public function for the password like this:</p>\n\n<pre><code>public function GetPassword as string\n   GetPassword = [set_password]\nend function\n</code></pre>\n\n<p>Second Approach:</p>\n\n<p>If this is a big application with lots of constant and public variables, the scope gets somehow \"dirty\" and it is difficult to find the variables. Thus, I make a class of the Constants and I declare them there. Then, it is easier to call them.</p>\n\n<p>Something like this:</p>\n\n<pre><code>Private Const p_First_COLUMN_TO_FILL = 8\n\nPublic Property Get FIRST_COLUMN_TO_FILL() As Long\n    FIRST_COLUMN_TO_FILL = p_First_COLUMN_TO_FILL\nEnd Property\n</code></pre>\n\n<p>Thus, if my class is <code>clsConstants</code>, I declare it as <code>Public objCon As clsConstants</code> and now with <code>objCon.FIRST_COLUMN_TO_FILL</code> I get what I want. The scope is somehow cleaner this way. You may also build more than one class of constants, depending on what are they used for.</p>\n"}], "owner": {"reputation": 2521, "user_id": 3250992, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/625932982113d9c5a46e88f442501cf3?s=128&d=identicon&r=PG&f=1", "display_name": "noobmaster69", "link": "https://stackoverflow.com/users/3250992/noobmaster69"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2636, "favorite_count": 1, "accepted_answer_id": 41587369, "answer_count": 1, "score": 3, "last_activity_date": 1484127840, "creation_date": 1484126873, "question_id": 41587034, "link": "https://stackoverflow.com/questions/41587034/using-global-constants-to-store-environment-variables", "title": "Using Global Constants to store environment variables", "body": "<p>I'm creating an add-in for Microsoft Excel and I'm using a module to store variables (which do not change during runtime) which are accessed by classes and other modules in the app. This is a more convenient way of hard coding values which I may have to find and replace at different points in the development cycle.</p>\n\n<p>The variables are things such as the app version, or the workbook password:</p>\n\n<pre><code>Option Explicit\nOption Private Module\n\nGlobal Const APP_ID = \"XXY\"\nGlobal Const APP_VERSION = \"1.00\"\nGlobal Const WORKSHEET_PASSWORD = \"s0Me_pa$$w0rD\"\nGlobal Const DATA_TABLE = \"tblStockData\"\nGlobal Const FORM_DEFAULT_VALUE = 200\n</code></pre>\n\n<p>I was wondering if anyone can tell me if this is bad practice and if so, what a better course of action would be?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 1, "creation_date": 1484126609, "post_id": 41586776, "comment_id": 70377590, "body": "Add an <code>Exit For</code> after <code>found = True</code>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1484126660, "post_id": 41586776, "comment_id": 70377634, "body": "or use a <code>do until loop</code> <code>do....loop until found=true</code>"}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 7403662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/944fabb2a0252fe9e6086bd01eed4dcc?s=128&d=identicon&r=PG&f=1", "display_name": "Reety", "link": "https://stackoverflow.com/users/7403662/reety"}, "edited": false, "score": 0, "creation_date": 1484128876, "post_id": 41586939, "comment_id": 70379243, "body": "Aaah! Thank you very much, should of seen that."}], "tags": [], "owner": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "is_accepted": true, "score": 1, "last_activity_date": 1484126638, "creation_date": 1484126638, "answer_id": 41586939, "question_id": 41586776, "link": "https://stackoverflow.com/questions/41586776/vba-searching-the-first-repeated-word-within-a-range/41586939#41586939", "title": "VBA - Searching the first repeated word within a Range", "body": "<p>If you need only first occurense just quit your loops!</p>\n\n<pre><code>Sub NeedleSearch()\n    Dim SearchSpace As Variant\n    Dim found As Boolean\n    found = False\n    SearchSpace = Range(\"A1:z20\").Value\n    Dim i As Integer, j As Integer\n    For i = 1 To 20\n        For j = 1 To 26\n            If SearchSpace(i, j) = \"needle\" Then\n                Range(\"A25\").Value = \"Column \" &amp; j\n                Range(\"B25\").Value = \"Row \" &amp; i\n                found = True\n            End If\n            If found Then _\n                    Exit For\n        Next j\n        If found Then _\n                Exit For\n    Next i\n    If found = False Then\n        Range(\"A25\").Value = \"needle not found\"\n        Range(\"B25\").Value = \" \"\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105, "user_id": 7403662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/944fabb2a0252fe9e6086bd01eed4dcc?s=128&d=identicon&r=PG&f=1", "display_name": "Reety", "link": "https://stackoverflow.com/users/7403662/reety"}, "edited": false, "score": 0, "creation_date": 1484128909, "post_id": 41587236, "comment_id": 70379267, "body": "Great, thanks very much! I also needed this as well :)"}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "reply_to_user": {"reputation": 105, "user_id": 7403662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/944fabb2a0252fe9e6086bd01eed4dcc?s=128&d=identicon&r=PG&f=1", "display_name": "Reety", "link": "https://stackoverflow.com/users/7403662/reety"}, "edited": false, "score": 0, "creation_date": 1484129783, "post_id": 41587236, "comment_id": 70379888, "body": "Great, happy to hear this. But please mark either one of the answer as correct so the question is flagged as &#39;already answered&#39;. Cheerio :)"}], "tags": [], "owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1484127464, "creation_date": 1484127464, "answer_id": 41587236, "question_id": 41586776, "link": "https://stackoverflow.com/questions/41586776/vba-searching-the-first-repeated-word-within-a-range/41587236#41587236", "title": "VBA - Searching the first repeated word within a Range", "body": "<p>To elaborate further: What this code actually does, if there are multiple instances of <code>needle</code> is, it will print all instances of found cells into A25:B25. Let's say there are 3 instances of <code>needle</code> e.g. in A1, B2 and C3. Your loop prints A1 into A25:B25 first, then B2 and then C3. Because it is happening so fast, you only see C3 or what you called the \"last occurence\".</p>\n\n<p>What you can do to print out <em>all</em> solutions (which is what I'm guessing you're trying to do in the end) you could change your code to something like this:</p>\n\n<pre><code>Sub NeedleSearch()\nDim SearchSpace As Variant\nDim found As Boolean\nfound = False\nSearchSpace = Range(\"A1:z20\").Value\nDim ws As Worksheet\nDim i As Integer\nDim j As Integer\nDim k As Integer\n\nSet ws = ThisWorkbook.Sheets(1)\nk = 25\n\nFor i = 1 To 20\n    For j = 1 To 26\n        If SearchSpace(i, j) = \"needle\" Then\n            ws.Cells(k, 1).Value = \"Occurence \" &amp; k - 24\n            ws.Cells(k, 2).Value = \"Column \" &amp; j\n            ws.Cells(k, 3).Value = \"Row \" &amp; i\n            k = k + 1\n            found = True\n        End If\n    Next j\nNext i\nIf found = False Then\n    ws.Range(\"A25\").Value = \"needle not found\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Change your <code>Sheet</code> ID accordingly.</p>\n\n<p>HTH</p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1484133516, "creation_date": 1484133516, "answer_id": 41589498, "question_id": 41586776, "link": "https://stackoverflow.com/questions/41586776/vba-searching-the-first-repeated-word-within-a-range/41589498#41589498", "title": "VBA - Searching the first repeated word within a Range", "body": "<p>you can avoid loops by means of <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746(v=office.15).aspx\" rel=\"nofollow noreferrer\">Find()</a> method of <code>Range</code> object:</p>\n\n<pre><code>Option Explicit\n\nSub NeedleSearch()\n    Dim f As Range\n\n    Set f = Range(\"A1:Z20\").Find(what:=\"needle\", LookIn:=xlValues, lookat:=xlWhole, After:=Range(\"Z20\"), SearchOrder:=xlByRows)\n    If f Is Nothing Then\n        Range(\"A25\").Value = \"needle not found\"\n        Range(\"B25\").Value = \" \"\n    Else\n        Range(\"A25\").Value = \"Column \" &amp; f.Column\n        Range(\"B25\").Value = \"Row \" &amp; f.Row\n    End If\nEnd Sub\n</code></pre>\n\n<p>that can also be rewritten as follows:</p>\n\n<pre><code>Sub NeedleSearch()\n    Dim f As Range\n    Dim arr As Variant\n\n    Set f = Range(\"A1:Z20\").Find(what:=\"needle\", LookIn:=xlValues, lookat:=xlWhole, After:=Range(\"Z20\"), SearchOrder:=xlByRows)\n    If f Is Nothing Then\n        arr = Array(\"needle not found\", \" \")\n    Else\n        arr = Array(\"Column \" &amp; f.Column, \"Row \" &amp; f.Row)\n    End If\n    Range(\"A25:B25\").Value = arr\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 7403662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/944fabb2a0252fe9e6086bd01eed4dcc?s=128&d=identicon&r=PG&f=1", "display_name": "Reety", "link": "https://stackoverflow.com/users/7403662/reety"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 41586939, "answer_count": 3, "score": 0, "last_activity_date": 1484133516, "creation_date": 1484126111, "last_edit_date": 1484126418, "question_id": 41586776, "link": "https://stackoverflow.com/questions/41586776/vba-searching-the-first-repeated-word-within-a-range", "title": "VBA - Searching the first repeated word within a Range", "body": "<p>I've implemented this macro whereby if i run it, it will show me the column and row of the word \"needle\" in the range A1:Z20. Although if there are multiple words of \"needle\" it will only output the last. How can I change this code to show me the first occurrence of the word?</p>\n\n<p>Hope this makes sense, and here is my code so far:</p>\n\n<pre><code>Sub NeedleSearch()\nDim SearchSpace As Variant\nDim found As Boolean\nfound = False\nSearchSpace = Range(\"A1:z20\").Value\nDim i As Integer, j As Integer\nFor i = 1 To 20\n    For j = 1 To 26\n        If SearchSpace(i, j) = \"needle\" Then\n            Range(\"A25\").Value = \"Column \" &amp; j\n            Range(\"B25\").Value = \"Row \" &amp; i\n            found = True\n        End If\n    Next j\nNext i\nIf found = False Then\n    Range(\"A25\").Value = \"needle not found\"\n    Range(\"B25\").Value = \" \"\nEnd If\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://gyazo.com/b2b093ced12be97783f848f3f19c29f4\" rel=\"nofollow noreferrer\">With No Repeated Words</a>\n<a href=\"https://gyazo.com/5a44fdd5daec3280a5698273c9bde621\" rel=\"nofollow noreferrer\">With 1 Repeated Word</a></p>\n"}, {"tags": ["vba", "excel", "listbox", "copy-paste", "offset"], "answers": [{"comments": [{"owner": {"reputation": 2420, "user_id": 2207426, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/G5kTR.png?s=128&g=1", "display_name": "4est", "link": "https://stackoverflow.com/users/2207426/4est"}, "edited": false, "score": 0, "creation_date": 1484126330, "post_id": 41586615, "comment_id": 70377398, "body": "what I I need to other value paste to column D, next to column E etc...I need to setup a few addme?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 2420, "user_id": 2207426, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/G5kTR.png?s=128&g=1", "display_name": "4est", "link": "https://stackoverflow.com/users/2207426/4est"}, "edited": false, "score": 0, "creation_date": 1484126487, "post_id": 41586615, "comment_id": 70377497, "body": "this code answers your post, if you want to more information then update your post"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1484127675, "last_edit_date": 1484127675, "creation_date": 1484125517, "answer_id": 41586615, "question_id": 41586550, "link": "https://stackoverflow.com/questions/41586550/paste-value-from-listbox-to-default-columns-row-under-selected-field/41586615#41586615", "title": "Paste value from ListBox to default columns (row under selected field)", "body": "<p>Try the code below, to get the <code>Offset</code> working of <code>Selection</code>, but at Column C.</p>\n\n<pre><code>Dim addme As Range\nSet addme = Selection\n\n' set the range to selection's row, but in Column C\nSet addme = Cells(Selection.Row, \"C\")\n\n' now offset 1 row below\naddme.Offset(1) = \"test offset\"\n</code></pre>\n\n<p><strong>Edit 1</strong>: updated code to fit PO's new data:</p>\n\n<pre><code>Range(Cells(addme.Row, \"C\"), Cells(addme.Row, \"C\")).Offset(1).Value = Me.lbsourceList.List(x, 1)\nRange(Cells(addme.Row, \"D\"), Cells(addme.Row, \"D\")).Offset(1).Value = Me.lbsourceList.List(x, 2)\nRange(Cells(addme.Row, \"E\"), Cells(addme.Row, \"E\")).Offset(1).Value = Me.lbsourceList.List(x, 3)\nRange(Cells(addme.Row, \"F\"), Cells(addme.Row, \"F\")).Offset(1).Value = Me.lbsourceList.List(x, 4)\n</code></pre>\n"}], "owner": {"reputation": 2420, "user_id": 2207426, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/G5kTR.png?s=128&g=1", "display_name": "4est", "link": "https://stackoverflow.com/users/2207426/4est"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "accepted_answer_id": 41586615, "answer_count": 1, "score": 1, "last_activity_date": 1484127675, "creation_date": 1484125284, "last_edit_date": 1484126732, "question_id": 41586550, "link": "https://stackoverflow.com/questions/41586550/paste-value-from-listbox-to-default-columns-row-under-selected-field", "title": "Paste value from ListBox to default columns (row under selected field)", "body": "<p>I tried to paste value from ListBox: alwyas one row below selection, into column C, D, E, F.</p>\n\n<p>my code:</p>\n\n<pre><code>Dim addme as Range\nSet addme = Application.Selection\n\n    For x = 0 To Me.lbsourceList.ListCount - 1\n        If Me.lbsourceList.Selected(x) Then        \n\n            'addme.Offset(1, ) = Me.lbsourceList.List(x, 1)'\n            'addme.Offset(1, ) = Me.lbsourceList.List(x, 2)'\n            'addme.Offset(1, ) = Me.lbsourceList.List(x, 3)'\n            'addme.Offset(1, ) = Me.lbsourceList.List(x, 4)'\n\n            Set addme = addme.Offset(1, 0)      \n        End If\n    Next x\n</code></pre>\n\n<p>Offset (1,0) will go under one row below, but I don't know how to set up column C, D, E, F as defualt.</p>\n"}, {"tags": ["vba", "excel", "pdf", "pdf-generation"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7168530"}, "edited": false, "score": 0, "creation_date": 1484123605, "post_id": 41585775, "comment_id": 70375921, "body": "Just to be clear, I&#39;ve tried some of the solutions from here <a href=\"http://stackoverflow.com/questions/33127693/all-columns-of-excelsheet-are-not-fitted-in-same-page-of-pdf-while-converting-u\" title=\"all columns of excelsheet are not fitted in same page of pdf while converting u\">stackoverflow.com/questions/33127693/&hellip;</a> Although that was how to &#39;squeeze&#39; a large number of columns into one PDF. I&#39;m trying to do the opposite in making 20 columns fit neatly into one PDF document without any right or left margins..."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 1, "creation_date": 1484126378, "post_id": 41585775, "comment_id": 70377437, "body": "Does your sheet look OK in Print Preview or have a wide right margin?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7168530"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1484127092, "post_id": 41585775, "comment_id": 70377982, "body": "If I set the Workbook View to Page Break Preview mode and manually select the same range for page 1, there is still a small margin but it looks alot better in print preview. Unfortunately ive tried doing the same and then running the pdf generator (excluding the page set up step) but it still has the margin in the pdf document (which leads me to believe that its a problem with the pdf step as opposed to formatting in excel)"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7168530"}, "is_accepted": true, "score": 0, "last_activity_date": 1484137035, "last_edit_date": 1484137035, "creation_date": 1484127885, "answer_id": 41587388, "question_id": 41585775, "link": "https://stackoverflow.com/questions/41585775/how-to-export-a-spreadsheet-to-pdf-with-columns-populating-the-full-page-width/41587388#41587388", "title": "How to export a spreadsheet to PDF with columns populating the full page width", "body": "<p>This has fixed itself now bizarrely. I've just set the Page Break Preview range and it has worked this time, so i'm not going to ask any questions and just accept it! This is the code i'm going with</p>\n\n<pre><code>Sub PDF_Gen()\n\nDim Title As String\n\n'Set Page Break Preview area\n\nActiveWindow.View = xlPageBreakPreview\nActiveSheet.PageSetup.PrintArea = \"$A$1:$T$79\"\n\n'Convert to PDF and save in C drive\n\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n\"C:\\template1.pdf\", Quality:= _\nxlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, _\nOpenAfterPublish:=False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7168530"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 453, "favorite_count": 0, "accepted_answer_id": 41587388, "answer_count": 1, "score": 2, "last_activity_date": 1484137035, "creation_date": 1484122574, "last_edit_date": 1484123445, "question_id": 41585775, "link": "https://stackoverflow.com/questions/41585775/how-to-export-a-spreadsheet-to-pdf-with-columns-populating-the-full-page-width", "title": "How to export a spreadsheet to PDF with columns populating the full page width", "body": "<p>Helllo everyone. I have created a macro to export some templates I've built in excel. The range of the templates are A1:T79. I set up the code below to take that range and turn it into a PDF document (which works fine).</p>\n\n<p>The problem is that the pdf document it creates has a huge margin of space on the right hand side. I want the the columns (A through T) to FULLY populate the page width end to end (doesn't matter about how many pages that adjusts to in length).</p>\n\n<p>I've tried a number of things and looked at some related links on this website but none have worked (which is why i'm asking again as opposed to responding to an old post over a year old!). Any help would be greatly appreciated. Code is below. Let me know if I've not explained anything properly and I will respond below. Thanks! :)</p>\n\n<pre><code>Sub PDF_Gen()\n\n'Set Page Area. My attempt at trying to fix the page width which doesn't work\n\nWith ActiveSheet.PageSetup\n    .PrintArea = ActiveSheet.Range(\"A1:T79\")\n    .Orientation = xlPortrait\n    .FitToPagesWide = 1\n    .Zoom = False\nEnd With\n\n'Convert to PDF and save document in C drive\n\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n\"C:\\template1.pdf\", Quality:= _\nxlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, _\nOpenAfterPublish:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484122852, "post_id": 41585761, "comment_id": 70375559, "body": "where you have <code>&quot;path to copy&quot;</code> you do have your <code>full path &amp; &quot;\\&quot; &amp; FileName.xlsx</code> , right ? when using <code>PasteSpecial</code> you need to add a parameter of which type, like <code>xlPasteAll</code> or <code>xlPasteValues</code> after, like <code>rngPaste.PasteSpecial xlPasteAll</code>."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1484123043, "post_id": 41585761, "comment_id": 70375664, "body": "If you want to use your <code>wsCopy.Range(&quot;d, e&quot;).EntireColumn</code> method, then modify it to <code>Set rngCopy = wsCopy.Range(&quot;D1:E1&quot;).EntireColumn</code>"}, {"owner": {"reputation": 11, "user_id": 7403398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f40443b772987dfd57254de0b72d6f9?s=128&d=identicon&r=PG&f=1", "display_name": "Bram de Wit", "link": "https://stackoverflow.com/users/7403398/bram-de-wit"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484124395, "post_id": 41585761, "comment_id": 70376296, "body": "Thanks for replying. Yes I do have the full path, I just removed it as it`s a long reference with company references.  If I put in the wsCopy.Range (&quot;D1:E1&quot;).Entire column it takes everything in between right? as I need C,R,W and X. Anyway to leave the columns out I dont need?"}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1484125414, "post_id": 41585761, "comment_id": 70376865, "body": "You can use <code>Union</code> method to select separate ranges. I just don&#39;t know how that will be pasted, probably also separately, exactly in the same position as it was in original worksheet."}, {"owner": {"reputation": 11, "user_id": 7403398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f40443b772987dfd57254de0b72d6f9?s=128&d=identicon&r=PG&f=1", "display_name": "Bram de Wit", "link": "https://stackoverflow.com/users/7403398/bram-de-wit"}, "edited": false, "score": 1, "creation_date": 1484126095, "post_id": 41585761, "comment_id": 70377250, "body": "Ok found out myself, should replace the line with Set rngCopy = wsCopy.Range(&quot;C:C,R:R,W:W,X:X&quot;).EntireColumn"}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1484126984, "post_id": 41585761, "comment_id": 70377908, "body": "I think you don&#39;t need <code>.EntireColumn</code> in this situation."}], "answers": [{"tags": [], "owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "is_accepted": false, "score": 0, "last_activity_date": 1484125692, "creation_date": 1484125692, "answer_id": 41586662, "question_id": 41585761, "link": "https://stackoverflow.com/questions/41585761/copy-specific-entire-column-from-file-1-to-2/41586662#41586662", "title": "Copy specific entire column from file 1 to 2", "body": "<p>Solutions to copy entire column.</p>\n\n<pre><code>Sub copy()\n    Dim wb As Workbook\n    Dim wbNew As Workbook\n    Dim ws As Worksheet\n    Dim wsNew As Worksheet\n\n    Set wb = ActiveWorkbook\n    Set ws = wb.Sheets(\"old\")\n    Set wbNew = Workbooks(\"Book.xlsx\")\n    Set wsNew = wbNew.Sheets(\"new\")\n\n    ws.Columns(3).copy\n    wsNew.Columns(3).Insert Shift:=xlToRight\n\n    ws.Columns(18).copy\n    wsNew.Columns(18).Insert Shift:=xlToRight\n\n    ws.Columns(23).copy\n    wsNew.Columns(23).Insert Shift:=xlToRight\n\n    ws.Columns(24).copy\n    wsNew.Columns(24).Insert Shift:=xlToRight\n\n    Set wsNew = Nothing\n    Set wbNew = Nothing\n    Set ws = Nothing\n    Set wb = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7403398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f40443b772987dfd57254de0b72d6f9?s=128&d=identicon&r=PG&f=1", "display_name": "Bram de Wit", "link": "https://stackoverflow.com/users/7403398/bram-de-wit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484125692, "creation_date": 1484122532, "last_edit_date": 1484122732, "question_id": 41585761, "link": "https://stackoverflow.com/questions/41585761/copy-specific-entire-column-from-file-1-to-2", "title": "Copy specific entire column from file 1 to 2", "body": "<p>Hello I'm trying to copy columns C, R, W,X from file 1 to file 2 with below code but keep getting an error. My VBA knowledge isn't that good yet but probably has to do with the range setting? I've tried multiple ways but can't get it to work. </p>\n\n<p>Am I using the right setting or should I use another action to get the specific columns?</p>\n\n<pre><code>Sub PFS()\n\nDim wbCopy As Workbook\nDim wsCopy As Worksheet\nDim rngCopy As Range\nDim wbPaste As Workbook\nDim wsPaste As Worksheet\nDim rngPaste As Range\n\nSet wbPaste = ActiveWorkbook\nSet wbCopy = Workbooks.Open(\"path to copy\")\nSet wsCopy = wbCopy.Worksheets(\"Blad1\")\nSet rngCopy = wsCopy.Range(\"d, e\").EntireColumn\nSet wsPaste = wbPaste.Worksheets(\"PFS\")\nSet rngPaste = wsPaste.Range(\"a1\")\n\nrngCopy.Copy\nrngPaste.PasteSpecial\n\nWorkbooks.Application.CutCopyMode = False\n\nApplication.DisplayAlerts = False\nwbCopy.Save\nwbCopy.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1334, "user_id": 2903056, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/426cd8a78bf3c830d6ef082c9bbc290a?s=128&d=identicon&r=PG&f=1", "display_name": "steenbergh", "link": "https://stackoverflow.com/users/2903056/steenbergh"}, "edited": false, "score": 5, "creation_date": 1484121417, "post_id": 41585415, "comment_id": 70374832, "body": "What is this code supposed to do? What is it doing now? Do you get an error message? Have you <a href=\"http://stackoverflow.com/tour\">taken the tour</a>?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1484122232, "post_id": 41585415, "comment_id": 70375225, "body": "Try to describe better what is happening in your code, what you are trying to acheive, and if you are getting an error at what line. The post in current state can&#39;t tell us much and it&#39;s almost impossible to help you"}, {"owner": {"reputation": 1, "user_id": 7403309, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211241325444479/picture?type=large", "display_name": "Niclas Schwencke Sparrevohn Mr", "link": "https://stackoverflow.com/users/7403309/niclas-schwencke-sparrevohn-mr"}, "edited": false, "score": 0, "creation_date": 1484122950, "post_id": 41585415, "comment_id": 70375611, "body": "Sorry.  I would like to be able to enter a 12-digit number in cell H6 so that the filter in the pivot table will change to that number. I get a little different errors but the most common are: run-time error 6 overflow."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7403309, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211241325444479/picture?type=large", "display_name": "Niclas Schwencke Sparrevohn Mr", "link": "https://stackoverflow.com/users/7403309/niclas-schwencke-sparrevohn-mr"}, "edited": false, "score": 0, "creation_date": 1484140873, "post_id": 41590255, "comment_id": 70387225, "body": "Hmm if i use Double i get: User defined type not defined. And if i use LongLong i get: Unable to get the PivotTabels property of the worksheet class. But if have checked and it should be right."}], "tags": [], "owner": {"reputation": 1438, "user_id": 7381844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472a02745987037a063febc591fbb937?s=128&d=identicon&r=PG&f=1", "display_name": "jBuchholz", "link": "https://stackoverflow.com/users/7381844/jbuchholz"}, "is_accepted": false, "score": 0, "last_activity_date": 1484135593, "creation_date": 1484135593, "answer_id": 41590255, "question_id": 41585415, "link": "https://stackoverflow.com/questions/41585415/why-will-this-easy-vba-code-not-work/41590255#41590255", "title": "Why will this easy VBA code not work", "body": "<p>Long is only 32 bits so you can only store 9 decimal digits. Use Double or (only if you have a 64bit-version) LongLong.</p>\n"}], "owner": {"reputation": 1, "user_id": 7403309, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211241325444479/picture?type=large", "display_name": "Niclas Schwencke Sparrevohn Mr", "link": "https://stackoverflow.com/users/7403309/niclas-schwencke-sparrevohn-mr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1484135593, "creation_date": 1484121167, "last_edit_date": 1484122156, "question_id": 41585415, "link": "https://stackoverflow.com/questions/41585415/why-will-this-easy-vba-code-not-work", "title": "Why will this easy VBA code not work", "body": "<p>Can any one see why this isn't working for me? </p>\n\n<p>My cell H6 contains a 12 digit number, thus the use of Long.\nAny thoughts on how to adjust this code in order for it to work:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n'This line stops the worksheet updating on every change, it only updates when cell'H6 or H7 is touched  \nIf Intersect(Target, Range(\"H6:H7\")) Is Nothing Then Exit Sub\n\n'Set the Variables to be used  \nDim pt As PivotTable  \nDim Field As PivotField  \nDim NewCat As Long  \n\n'Here you amend to suit your data  \nSet pt = Worksheets(\"Data1\").PivotTables(\"PivotTable10\")    \nSet Field = pt.PivotFields(\"[Produkter].[EAN].[EanID]\")  \n\nNewCat = Worksheets(\"Data1\").Range(\"H6\").Value    \n\n'This updates and refreshes the PIVOT table\n\nWith ActiveSheet.PivotTables(\"PivotTabel10\").PivotFields(\"[Produkter].[EAN].[EanID]\")  \n    .ClearAllFilters\n    .PivotFilters.Add Type:=xlCaptionEquals, Value1:=ActiveSheet.Range(\"H6\").Value\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 128, "user_id": 5309819, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BAkH6.jpg?s=128&g=1", "display_name": "Nick van H.", "link": "https://stackoverflow.com/users/5309819/nick-van-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1484177657, "creation_date": 1484177657, "answer_id": 41602730, "question_id": 41585273, "link": "https://stackoverflow.com/questions/41585273/vba-coding-to-extract-data-from-txt-file/41602730#41602730", "title": "VBA Coding to extract data from .txt file", "body": "<p>Assuming the text file contains only one line with Coord. Z and the values are separated by spaces you can also scan for that line and split to an array using the following code; </p>\n\n<pre><code>Dim vTmp as variant\nDim i as long, j as long\n\nDo Until EOF(1)\nLine Input #1, textline\nIf InStr(text, \"Coord. Z\") then vTmp = split(textline, \" \")\nLoop\n</code></pre>\n\n<p>This code makes an array vTmp which contains concatinated characters (or empty entries if double spaces are present) </p>\n\n<p>Next loop through the resulting array and dump the values in your sheet. </p>\n\n<pre><code>j = 1 'Start column\n\n'Loop through array\nFor i = LBound(vTmp) to UBound(vTmp)\n    If vTmp(i) &lt;&gt; \"\" 'If entry is not empty\n        Sheet2.Cells(LastRow, j).value = vTmp(i) 'Dump entry\n        j = j + 1 'Next column\n    End if\nNext i\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7402121, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E4F4j.png?s=128&g=1", "display_name": "Faisal Hilmi", "link": "https://stackoverflow.com/users/7402121/faisal-hilmi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1164, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484177657, "creation_date": 1484120619, "last_edit_date": 1531164843, "question_id": 41585273, "link": "https://stackoverflow.com/questions/41585273/vba-coding-to-extract-data-from-txt-file", "title": "VBA Coding to extract data from .txt file", "body": "<p>i tried to extract data from .txt file as per attached using below coding. However, i don't have idea how to remain the negative value as when i run the coding, the negative sign will missing. Please help.</p>\n\n<p><a href=\"https://i.stack.imgur.com/HtYFB.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim myFile As String, text As String, textline As String, Point1 As Integer, LastRow As Long, Filename As String, x As Variant\n\n'Open File Location\nmyFile = Application.GetOpenFilename()\n\n'Read the data file\nOpen myFile For Input As #1\n\nDo Until EOF(1)\nLine Input #1, textline\ntext = text &amp; textline\n\nLoop\n\nClose #1 'Close data file\n\n'Defined starting point\n Point1 = InStr(text, \"Coord. Z\")\n\n'Adding new line\nLastRow = Sheet2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n\n'Get Module S/N from filename\nstrFilePath = myFile\nFilename = Replace(Dir([strFilePath]), \".txt\", \"\")\n\n'Location of the data\nSheet2.Range(\"A\" &amp; LastRow).Value = Filename\nSheet2.Range(\"B\" &amp; LastRow).Value = Mid(text, Point1 + 21, 8)\nSheet2.Range(\"C\" &amp; LastRow).Value = Mid(text, Point1 + 36, 8)\nSheet2.Range(\"D\" &amp; LastRow).Value = Mid(text, Point1 + 54, 8)\nSheet2.Range(\"E\" &amp; LastRow).Value = Mid(text, Point1 + 70, 8)\nSheet2.Range(\"F\" &amp; LastRow).Value = Mid(text, Point1 + 84, 8)\nSheet2.Range(\"G\" &amp; LastRow).Value = Mid(text, Point1 + 103, 8)\n\n`End Sub\n</code></pre>\n"}, {"tags": ["excel", "function", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1484121263, "post_id": 41585238, "comment_id": 70374748, "body": "I assume you have <a href=\"http://stackoverflow.com/q/28238292/11683\"><code>Dim SourceRange, DestinationRange As Range</code></a> somewhere, which makes it a Possible duplicate of <a href=\"http://stackoverflow.com/q/25316331/11683\">ByRef Argument Type Mismatch&quot; Error VB6</a>."}, {"owner": {"reputation": 1, "user_id": 6518258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7551540710c0c2afbeb67365c5f4722?s=128&d=identicon&r=PG&f=1", "display_name": "sameer agarwal", "link": "https://stackoverflow.com/users/6518258/sameer-agarwal"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1484122237, "post_id": 41585238, "comment_id": 70375227, "body": "yes, you are right, I have Dim SourceRange, DestinationRange as Range at the beginning of code. Removing that  line still produces same error."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1484122301, "post_id": 41585238, "comment_id": 70375262, "body": "Then click both links."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 1097251, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c3c0bc74940df4e24bc470fb6a9cc9b2?s=128&d=identicon&r=PG", "display_name": "TimmyD", "link": "https://stackoverflow.com/users/1097251/timmyd"}, "edited": false, "score": 0, "creation_date": 1609896429, "post_id": 41628175, "comment_id": 115963733, "body": "Bad bad Microsoft. How misleading."}], "tags": [], "owner": {"reputation": 4250, "user_id": 1877903, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/T8yS7.jpg?s=128&g=1", "display_name": "neelsg", "link": "https://stackoverflow.com/users/1877903/neelsg"}, "is_accepted": false, "score": 3, "last_activity_date": 1484286674, "creation_date": 1484286674, "answer_id": 41628175, "question_id": 41585238, "link": "https://stackoverflow.com/questions/41585238/vba-complie-error-when-trying-to-pass-range-as-argument/41628175#41628175", "title": "VBA complie error when trying to pass range as argument", "body": "<p>You need to change</p>\n\n<pre><code>Dim SourceRange, DestinationRange As Range\n</code></pre>\n\n<p>To</p>\n\n<pre><code>Dim SourceRange As Range\nDim DestinationRange As Range\n</code></pre>\n\n<p>Otherwise it is equivalent to</p>\n\n<pre><code>Dim SourceRange As Variant\nDim DestinationRange As Range\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6518258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7551540710c0c2afbeb67365c5f4722?s=128&d=identicon&r=PG&f=1", "display_name": "sameer agarwal", "link": "https://stackoverflow.com/users/6518258/sameer-agarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 761, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484286674, "creation_date": 1484120463, "last_edit_date": 1531164843, "question_id": 41585238, "link": "https://stackoverflow.com/questions/41585238/vba-complie-error-when-trying-to-pass-range-as-argument", "title": "VBA complie error when trying to pass range as argument", "body": "<p>I am passing two range arguments in a function. One is working fine but second is giving compile error. </p>\n\n<p>Here I am calling the function -</p>\n\n<pre><code>Set SourceRange = Sheets(\"QueryResult\").Range(\"QueryResult\")\nSet DestinationRange = Sheets(\"TradeUnderlyingCptyWWRTemplate\").Range(\"CounterpartyName\")\nCall PopulateDetails(23, SourceRange, DestinationRange, 2, 8)\n</code></pre>\n\n<p>And here is the function:</p>\n\n<pre><code>Function PopulateDetails(SourceColumns As Integer, Srce As Range, Destination As Range, DestinationColums As Integer, DestinationRows As Integer)\n\nDim CellName As String\nDim a, b, i As Integer\n\nFor b = 0 To DestinationRows - 1\n    For a = 0 To DestinationColums - 1\n\n        On Error GoTo Err:\n        Sheets(\"TradeUnderlyingCptyWWRTemplate\").Select\n        Destination.Offset(b, a).Select\n        CellName = Destination.Offset(b, a).Name.Name\n\n        For i = 0 To SourceColumns - 1\n            If (Destination.Offset(b, a).Name.Name = Srce.Offset(0, i).Value And Destination.Offset(b, a).Value = \"\") Then\n                Destination.Offset(b, a).Value = Srce.Offset(1, i).Value\n                Exit For\n            End If\n        Next\nErr:\n        On Error Resume Next\n        Err.Clear\n        CellName = \"\"\n    Next\nNext\n\nEnd Function\n</code></pre>\n\n<p>However, it is giving compile error: </p>\n\n<blockquote>\n  <p>byref argument type mismatch</p>\n</blockquote>\n\n<p>with <code>SourceRange</code> highlighted in the code.</p>\n\n<p>When I change the function to only have four arguments (deleting Source argument), it works fine.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "edited": false, "score": 1, "creation_date": 1484120984, "post_id": 41585142, "comment_id": 70374632, "body": "Bhshan What have you tried so far?  Definitely this requires VBA code, and can&#39;t be doe by formulas. Don&#39;t expect SO to be your code writing service."}, {"owner": {"reputation": 1, "user_id": 7403234, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jJU3gwCVyjo/AAAAAAAAAAI/AAAAAAAABhE/aViuXu85C0I/photo.jpg?sz=128", "display_name": "Bhushan Rane", "link": "https://stackoverflow.com/users/7403234/bhushan-rane"}, "reply_to_user": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "edited": false, "score": 0, "creation_date": 1484215561, "post_id": 41585142, "comment_id": 70421910, "body": "OK sorry guys if I was unambiguous before. Let me explain in brief.  There are 12 columns for 12 months as M, AR, BR, .... KR  M has formula =IF(ISERROR(VLOOKUP(S8,N:N,1,FALSE)),S8,)  it looks for some value in columns S,  similarly, AR has formula =IF(ISERROR(VLOOKUP(AO7,AJ:AJ,1,FALSE)),AO7,)  it will look for value in column AJ  BR will look in CJ...  Now, thing is it is not necessary that this S, AJ, BJ ... KJ will have text in them. It is rare that there will be entry in S, AJ, ..KJ  I just want to be notified by Display box in case there is text in columns S, AJ, BJ..KJ"}, {"owner": {"reputation": 1, "user_id": 7403234, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jJU3gwCVyjo/AAAAAAAAAAI/AAAAAAAABhE/aViuXu85C0I/photo.jpg?sz=128", "display_name": "Bhushan Rane", "link": "https://stackoverflow.com/users/7403234/bhushan-rane"}, "reply_to_user": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "edited": false, "score": 0, "creation_date": 1484215799, "post_id": 41585142, "comment_id": 70422088, "body": "@dgorti  I have tried this one   Private Sub Worksheet_Change(ByVal Target As Excel.Range)  If Worksheets(&quot;sheet1&quot;).Range(&quot;M7&quot;).Value = &quot;&quot; Then Exit Sub Else MsgBox (&quot;There was one or more rejections&quot;) End If  End Sub   this works with just single cell... i want to make this work for 12 columns M, AR, BR, CR... KR for same sheet."}], "answers": [{"comments": [{"owner": {"reputation": 499, "user_id": 7160536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b7c2e2c668ace472a1b0abc47f4421?s=128&d=identicon&r=PG&f=1", "display_name": "ClintB", "link": "https://stackoverflow.com/users/7160536/clintb"}, "edited": false, "score": 0, "creation_date": 1484121462, "post_id": 41585454, "comment_id": 70374864, "body": "You should consider protecting those columns and lock the sheet so they cant be overwritten. (you can unprotect all the cells that you want people to be able to edit.)"}], "tags": [], "owner": {"reputation": 499, "user_id": 7160536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b7c2e2c668ace472a1b0abc47f4421?s=128&d=identicon&r=PG&f=1", "display_name": "ClintB", "link": "https://stackoverflow.com/users/7160536/clintb"}, "is_accepted": false, "score": 0, "last_activity_date": 1484121338, "creation_date": 1484121338, "answer_id": 41585454, "question_id": 41585142, "link": "https://stackoverflow.com/questions/41585142/dialogue-box-to-appear-when-any-entry-has-been-made-into-columns-ar-br-cr-dr/41585454#41585454", "title": "Dialogue box to appear when any entry has been made into columns AR, BR, CR , DR", "body": "<p>Press Alt+F11\nClick on this workbook and paste this macro:</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n        Select Case Target.Column\n            Case 13, 44, 70, 96 'M, AR, BR, CR\n                MsgBox (\"You have altered column \" &amp; Target.Address &amp; \" with value: \" &amp; Target.Value)\n        End Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7403234, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jJU3gwCVyjo/AAAAAAAAAAI/AAAAAAAABhE/aViuXu85C0I/photo.jpg?sz=128", "display_name": "Bhushan Rane", "link": "https://stackoverflow.com/users/7403234/bhushan-rane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1484127847, "creation_date": 1484120111, "last_edit_date": 1484127847, "question_id": 41585142, "link": "https://stackoverflow.com/questions/41585142/dialogue-box-to-appear-when-any-entry-has-been-made-into-columns-ar-br-cr-dr", "title": "Dialogue box to appear when any entry has been made into columns AR, BR, CR , DR", "body": "<p>This would be easy for Excel Experts... I want to have a dialogue box to appear when any entry has been made into columns  M , AR, BR, CR , DR ... KR</p>\n\n<p>It would be more nice if i get what entry has been made to the column in the dialogue box to appear...that is secondary if possible</p>\n\n<p>These columns will be filled by Text by another formula...and this will be very rare</p>\n\n<p>so, I just want to know by warning message if those cells get filled by text in future.</p>\n\n<p>any help with code is appreciated :)</p>\n\n<p>Thanks in Advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "edited": false, "score": 1, "creation_date": 1484121133, "post_id": 41585111, "comment_id": 70374702, "body": "See <a href=\"http://stackoverflow.com/questions/3690793/how-to-protect-excel-workbook-using-vba\" title=\"how to protect excel workbook using vba\">stackoverflow.com/questions/3690793/&hellip;</a>"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1484121189, "post_id": 41585111, "comment_id": 70374719, "body": "<code>Wk.password = &quot;password&quot;</code> or <code>Wk.protect &quot;password&quot;</code>, according to what you want to protect."}, {"owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1484121639, "post_id": 41585111, "comment_id": 70374944, "body": "@VincentG thanks. i&#39;m using <b>Wk.password = &quot;password&quot;</b> and it is working. however. when i run those code above, the newly created file is opened. How to suppress that?"}, {"owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1484121843, "post_id": 41585111, "comment_id": 70375051, "body": "@VincentG, its ok. found the way. Thank you again."}], "answers": [{"tags": [], "owner": {"reputation": 129, "user_id": 5392516, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GQWvK6-N8YU/AAAAAAAAAAI/AAAAAAAAAAA/X9JE-sRrRvs/photo.jpg?sz=128", "display_name": "Ali Varli", "link": "https://stackoverflow.com/users/5392516/ali-varli"}, "is_accepted": false, "score": 1, "last_activity_date": 1484121542, "creation_date": 1484121542, "answer_id": 41585513, "question_id": 41585111, "link": "https://stackoverflow.com/questions/41585111/excel-vba-create-another-excel-file-with-password-protected/41585513#41585513", "title": "Excel VBA - Create Another Excel File with Password Protected", "body": "<pre><code>Application.DisplayAlerts = False\nApplication.ScreenUpdating = False\n\nActiveWorkbook.SaveAs FileFormat:=xlNormal, Password:=\"pass\", WriteResPassword:=\"\", _\nReadOnlyRecommended:=False, CreateBackup:=False\n\nActiveWorkbook.Close\n</code></pre>\n\n<p>Here is the documentation: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff841185.aspx\" rel=\"nofollow noreferrer\">Workbook.SaveAs Method (Excel)</a></p>\n"}], "owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1413, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484121542, "creation_date": 1484119995, "question_id": 41585111, "link": "https://stackoverflow.com/questions/41585111/excel-vba-create-another-excel-file-with-password-protected", "title": "Excel VBA - Create Another Excel File with Password Protected", "body": "<p>I have a Excel Program that need to create another excel with password protected. I can create another excel but i don't know how to protect it with password. Below are the code for the creating another Excel File.</p>\n\n<pre><code>Option Explicit\n\nSub Macro1()\n\nDim Wk As Workbook\n\nSet Wk = Workbooks.Add\nApplication.DisplayAlerts = False\nWk.SaveAs Filename:=\u201dB:\\Test1.xlsx\u201d\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>Hope you guys can help for this part.</p>\n"}, {"tags": ["excel", "vba", "bloomberg"], "answers": [{"comments": [{"owner": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "edited": false, "score": 0, "creation_date": 1484125958, "post_id": 41585181, "comment_id": 70377172, "body": "You don&#39;t have to change the terminal settings: you can override them in Excel or VBA."}], "tags": [], "owner": {"reputation": 212, "user_id": 7373309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a438ae919aeb17b00417d619f90852f?s=128&d=identicon&r=PG&f=1", "display_name": "EKSK", "link": "https://stackoverflow.com/users/7373309/eksk"}, "is_accepted": true, "score": 4, "last_activity_date": 1546337344, "last_edit_date": 1546337344, "creation_date": 1484120272, "answer_id": 41585181, "question_id": 41585048, "link": "https://stackoverflow.com/questions/41585048/excel-vba-bloomberg-adjusted-prices/41585181#41585181", "title": "Excel / VBA / Bloomberg adjusted prices", "body": "<p>It doesn\u2019t matter if you download the data via VBA, Excel directly, or with any another program like R for example: Bloomberg will always give you the data based your terminal/account settings. If you like to have prices and returns that are adjusted for dividends do the following:</p>\n\n<ol>\n<li>Log in to your Bloomberg Terminal/Account</li>\n<li><code>DPDF &lt;go&gt;</code></li>\n<li>Change the Settings for Abnormal/Normal/Cash Dividends and Historical Pricing (if all boxes are checked you will have the desired functionality)</li>\n</ol>\n"}], "owner": {"reputation": 101, "user_id": 7378830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6827272ea2e9c8d077e4722e4bba25f3?s=128&d=identicon&r=PG&f=1", "display_name": "FS2010", "link": "https://stackoverflow.com/users/7378830/fs2010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6060, "favorite_count": 0, "accepted_answer_id": 41585181, "answer_count": 1, "score": 3, "last_activity_date": 1546337344, "creation_date": 1484119761, "last_edit_date": 1513161838, "question_id": 41585048, "link": "https://stackoverflow.com/questions/41585048/excel-vba-bloomberg-adjusted-prices", "title": "Excel / VBA / Bloomberg adjusted prices", "body": "<p>I'm using Excel and VBA to Analyse some data for a assignment in University. At my University I can download the from Bloomberg, I'm doing this via a VBA code. I don't have any formulas in Excel. </p>\n\n<p>My question is how can I get Price and Return Data which are adjusted for dividends?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 7382229, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2183f5ae1cd92ea69711bf69eac1bfd6?s=128&d=identicon&r=PG&f=1", "display_name": "Nadal Mir", "link": "https://stackoverflow.com/users/7382229/nadal-mir"}, "edited": false, "score": 0, "creation_date": 1484119249, "post_id": 41584745, "comment_id": 70373799, "body": "yes correct the code will open the folder after the save complete. the problem is when i cancel the save. the folder also open. i dont want it to open when click on cancel"}, {"owner": {"reputation": 499, "user_id": 7160536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b7c2e2c668ace472a1b0abc47f4421?s=128&d=identicon&r=PG&f=1", "display_name": "ClintB", "link": "https://stackoverflow.com/users/7160536/clintb"}, "reply_to_user": {"reputation": 55, "user_id": 7382229, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2183f5ae1cd92ea69711bf69eac1bfd6?s=128&d=identicon&r=PG&f=1", "display_name": "Nadal Mir", "link": "https://stackoverflow.com/users/7382229/nadal-mir"}, "edited": false, "score": 0, "creation_date": 1484120584, "post_id": 41584745, "comment_id": 70374443, "body": "Not sure if you realized I updated but the code above should fix your problem."}], "tags": [], "owner": {"reputation": 499, "user_id": 7160536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b7c2e2c668ace472a1b0abc47f4421?s=128&d=identicon&r=PG&f=1", "display_name": "ClintB", "link": "https://stackoverflow.com/users/7160536/clintb"}, "is_accepted": true, "score": 1, "last_activity_date": 1484119404, "last_edit_date": 1484119404, "creation_date": 1484118611, "answer_id": 41584745, "question_id": 41584238, "link": "https://stackoverflow.com/questions/41584238/stop-macro-from-operating-with-exit-statement/41584745#41584745", "title": "Stop macro from operating with exit statement", "body": "<p>Open your vbe window. go to ThisWorkbook.</p>\n\n<pre><code>Private Sub Workbook_AfterSave(ByVal Success As Boolean)\n    If (Success) Then\n        Call Shell(\"explorer.exe\" &amp; \" \" &amp; ActiveWorkbook.Path, vbNormalFocus)\n    End If\nEnd Sub\n</code></pre>\n\n<p>This macro will open the folder after you save it using the normal save methods.</p>\n\n<p>**Updated for when user cancelled the save.</p>\n"}], "owner": {"reputation": 55, "user_id": 7382229, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2183f5ae1cd92ea69711bf69eac1bfd6?s=128&d=identicon&r=PG&f=1", "display_name": "Nadal Mir", "link": "https://stackoverflow.com/users/7382229/nadal-mir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 41584745, "answer_count": 1, "score": 0, "last_activity_date": 1484119404, "creation_date": 1484116613, "last_edit_date": 1531164843, "question_id": 41584238, "link": "https://stackoverflow.com/questions/41584238/stop-macro-from-operating-with-exit-statement", "title": "Stop macro from operating with exit statement", "body": "<p>hi I am going to popup the file location folder after the save complete. my problem is when i cancel the save. the folder also popup. how to stop the folder popup when i click cancel the save. If im not mistaken it can be done by exit statement</p>\n\n<p>here my code </p>\n\n<pre><code>Private Sub savebr_Click()\n\n\nDim varResult As Variant\nDim saveas As String\nDim fname As String\n\n\nCells.AutoFilter\n'to get original filename put below code\n\n fname = ActiveWorkbook.Name\n\n saveas = \"C:/newfolder.Show fname\n\n\n'to open targeted folder after save\n\nCall Shell(\"explorer.exe\" &amp; \" \" &amp; ActiveWorkbook.path, vbNormalFocus)\n\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484114330, "post_id": 41583457, "comment_id": 70371737, "body": "is the prefix allways &quot;Debit_Coverage_Report_&quot; ?"}, {"owner": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "edited": false, "score": 0, "creation_date": 1484115799, "post_id": 41583457, "comment_id": 70372283, "body": "And where are the dates and other numbers? hour/min/seconds? Debit_Coverage_Report_dd_mm_yyyy_hh_mm_ss? So report 1 is Feb 1st 2016?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484133730, "post_id": 41583457, "comment_id": 70382590, "body": "@sagar have you tested any of the answer below ? did they work ? any feedback ?"}, {"owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "edited": false, "score": 0, "creation_date": 1484136042, "post_id": 41583457, "comment_id": 70384068, "body": "Sorry for the late Reply Sir, Yes its Working Absolutely Correct and Fine.Thank you so much for your help..."}, {"owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "edited": false, "score": 0, "creation_date": 1484137289, "post_id": 41583457, "comment_id": 70384906, "body": "Dear Sir Also want to understand with regards to the code which is ---&gt; &quot;ReDim Preserve DateArr(0 To ind - 1)&quot;"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484201059, "post_id": 41583457, "comment_id": 70414223, "body": "@sagar it&#39;s to resize the array to the number of elements actualy exists (not the empty ones). if it solved your post mark as answer (click the little <b>V</b> next to my answer below)"}], "answers": [{"tags": [], "owner": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "is_accepted": false, "score": 0, "last_activity_date": 1484116162, "creation_date": 1484116162, "answer_id": 41584117, "question_id": 41583457, "link": "https://stackoverflow.com/questions/41583457/manipulate-the-text-for-date/41584117#41584117", "title": "Manipulate the Text for Date", "body": "<p>The easiest way to do this is to convert text to columns\nIn your spreadsheet, select the column, go to DATA TAB, select Text To Columns.</p>\n\n<p>From there, use a delimiter \"_\" instead of the default TAB (Select Other) and finish</p>\n\n<p>You will end up with as separate columns</p>\n\n<pre><code>Debit   Coverage    Report  1   2   2016    11  8   34\nDebit   Coverage    Report  10  11  2015    14  19  33\n</code></pre>\n\n<p>from there party on the data to your heart's content.</p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1484116937, "last_edit_date": 1484116937, "creation_date": 1484116492, "answer_id": 41584210, "question_id": 41583457, "link": "https://stackoverflow.com/questions/41583457/manipulate-the-text-for-date/41584210#41584210", "title": "Manipulate the Text for Date", "body": "<p>Assuming your prefix of \"Debit_Coverage_Report\" stays for all of your strings, and <strong>\"_1_2_2016\"</strong> is in the date order of <code>dd_mm_yyyy</code> (01-Feb-2016), try the Code below (VBA solution):</p>\n\n<pre><code>Option Explicit\n\nSub ExtractDate()\n\nDim LastRow As Long, i As Long, ind As Long\nDim MyArr   As Variant\nDim DateArr() As Date\n\n' init Date array to a lrage size on init &gt;&gt; will optimize it's size later in the code\nReDim DateArr(0 To 1000)\nind = 0 ' &lt;-- init DateArr array index\n\n' modify \"Sheet1\" to your sheet's name\nWith Sheets(\"Sheet1\")\n\n    ' in my test all data is in column B, so looking for last row with value in column B\n    LastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n\n    ' loop through all cells in columns B\n    For i = 2 To LastRow\n        If .Range(\"B\" &amp; i).Value &lt;&gt; \"\" Then ' &lt;-- check if the cell is not empty\n            MyArr = Split(.Range(\"B\" &amp; i).Value, \"_\") ' &lt;-- split the string to array elements\n\n            DateArr(ind) = DateSerial(MyArr(5), MyArr(4), MyArr(3)) ' &lt;-- inserting the array to DateArr array\n            ' the line below is just to show you the results on column C (next to your original string)\n            .Range(\"C\" &amp; i).Value = DateArr(ind)\n\n            ind = ind + 1\n        End If\n    Next i\n\n    ReDim Preserve DateArr(0 To ind - 1) ' &lt;-- resize array to number of array elements found in worksheet                   \nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Screen-shot below shows the results in Column C after running this code</p>\n\n<p><a href=\"https://i.stack.imgur.com/K2y22.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K2y22.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 41584210, "answer_count": 2, "score": 0, "last_activity_date": 1484116937, "creation_date": 1484113204, "question_id": 41583457, "link": "https://stackoverflow.com/questions/41583457/manipulate-the-text-for-date", "title": "Manipulate the Text for Date", "body": "<p>I have the text details as below in my excel sheet, I required to extract only Dates from the below text with the help of VBA Code.I couldn't able to use formula like MID as well because the date's are either single digit OR Double digit.Please help me. </p>\n\n<p>Debit_Coverage_Report_1_2_2016_11_8_34</p>\n\n<p>Debit_Coverage_Report_10_11_2015_14_19_33</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "is_accepted": false, "score": 1, "last_activity_date": 1484120654, "last_edit_date": 1484120654, "creation_date": 1484115636, "answer_id": 41583975, "question_id": 41583283, "link": "https://stackoverflow.com/questions/41583283/scope-of-multiple-for-each-loops-in-excel-vba/41583975#41583975", "title": "Scope of Multiple For each loops in Excel VBA", "body": "<p>You dont need a macro for this.\nYou can do this with formulas</p>\n\n<pre><code>=IF($C$1 = A2, B2, 0)\n=IF($D$1 = A2, B2, 0)\n=IF($E$1=A2, B2, 0)\n</code></pre>\n\n<p>Paste them in C2, D2, E2 and then copy \nthe formulas for the rest of the cells</p>\n\n<p>Or as YowE3K points out you can use\n=IF(C$1=$A2,$B2,0) in cell C2, and copied to all the other cells (i.e. C2:E4)</p>\n\n<p><a href=\"https://i.stack.imgur.com/U55Gi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U55Gi.png\" alt=\"Screenshot\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1484127264, "last_edit_date": 1484127264, "creation_date": 1484119549, "answer_id": 41584991, "question_id": 41583283, "link": "https://stackoverflow.com/questions/41583283/scope-of-multiple-for-each-loops-in-excel-vba/41584991#41584991", "title": "Scope of Multiple For each loops in Excel VBA", "body": "<p>sticking to VBA you can simplify your code and reduce running time</p>\n\n<pre><code>Option Explicit\n\nSub LoopInsert()\n    Dim catColumnRng As Range, catRowRng As Range, colRng As Range, cell As Range\n\n    With Worksheets(\"Sheet1\")\n        Set catColumnRng = .Range(\"A2\", .Cells(.Rows.Count, 1).End(xlUp)).SpecialCells(xlCellTypeConstants, xlTextValues) '&lt;--| store all \"Category\" not empty cells in column A from row 2 downwards\n        Set catRowRng = .Range(\"C1\", .Cells(1, .Columns.Count).End(xlToLeft)).SpecialCells(xlCellTypeConstants, xlTextValues) '&lt;--| store all \"Category\" not empty cells in row 1 from column 3 rightwards\n\n        For Each cell In catColumnRng '&lt;--| loop through column A \"Category\" cells\n            Set colRng = catRowRng.Find(what:=cell.Value, LookIn:=xlValues, lookat:=xlWhole) '&lt;--| try finding corresponding text in row 1 \"Category\" cells\n            If Not colRng Is Nothing Then .Cells(cell.Row, colRng.Column).Value = cell.Offset(, 1) '&lt;--| if found then place the value\n        Next cell\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7402667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f5aae7101fade6951fb687831e74451?s=128&d=identicon&r=PG&f=1", "display_name": "Tyro", "link": "https://stackoverflow.com/users/7402667/tyro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1271, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1547682084, "creation_date": 1484112329, "last_edit_date": 1547682084, "question_id": 41583283, "link": "https://stackoverflow.com/questions/41583283/scope-of-multiple-for-each-loops-in-excel-vba", "title": "Scope of Multiple For each loops in Excel VBA", "body": "<p>I have a sheet with below data. </p>\n\n<pre><code>Category      | Amount    | Daily Charges | Misc Charges |  Vendor Charges\n------------  |-----------| --------------|--------------|-------------------\nDaily Charges |500,000.00 |               |              |       \n--------------|-----------|---------------|--------------|-------------------\nMisc Charges  | 500.00    |               |              |       \n--------------|-----------| --------------|--------------|-------------------\nVendor Charges| 50,000.00 |               |              | \n</code></pre>\n\n<p>I need to fill column 3 (Daily Charges) , column 4 (Misc Charges) and column 5(Vendor Charges) as below using macros.</p>\n\n<pre><code>Category      | Amount    | Daily Charges | Misc Charges |  Vendor Charges\n------------  |-----------| --------------|--------------|-------------------\nDaily Charges |500,000.00 | 500,000.00    |     0        |       0\n--------------|-----------|---------------|--------------|-------------------\nMisc Charges  | 500.00    |     0         | \u20b9 500.00     |       0\n--------------|-----------| --------------|--------------|-------------------\nVendor Charges| 50,000.00 |     0         |      0       | 50,000.00\n</code></pre>\n\n<p><strong>Please help.</strong></p>\n\n<p>I tried the below macro function but i'm unable to exit correctly from the scope of a for each loop .</p>\n\n<pre><code>Sub LoopInsert()\n\nDim tgt, final, rng, val, cell, cell2, cell3 As Range\nWorksheets(\"Sheet1\").Activate\n\nSet rng = ActiveSheet.Range(\"A2\", ActiveSheet.Range(\"A2\").End(xlDown))\nSet val = ActiveSheet.Range(\"B2\", ActiveSheet.Range(\"B2\").End(xlDown))\nSet tgt = ActiveSheet.Range(\"C2\", ActiveSheet.Range(\"C2\").End(xlDown))\n\n\nFor Each cell In rng\n   For Each cell2 In val\n\n    If cell.Value = \"Daily Charges\" Then\n     Exit For\n       For Each cell3 In tgt\n        cell3.Value = cell2.Value\n        Exit For\n        Next\n     Else\n     For Each cell3 In tgt\n        cell3.Value = 0\n        Exit For\n        Next\n    End If\nNext\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7402623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab92c13aa25949eb3e2596e914b8c89f?s=128&d=identicon&r=PG&f=1", "display_name": "J Regan", "link": "https://stackoverflow.com/users/7402623/j-regan"}, "edited": false, "score": 0, "creation_date": 1484112169, "post_id": 41583070, "comment_id": 70370964, "body": "Thanks for the quick reply! I tried the above but I always get the same answer (1). The only difference is I don&#39;t have &#39;TRUE&#39; next to MAIN in sub B as it&#39;s the expected end of statement, would that make a difference? I won&#39;t always know which sub is going to call MAIN as it will be based on user input."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 13, "user_id": 7402623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab92c13aa25949eb3e2596e914b8c89f?s=128&d=identicon&r=PG&f=1", "display_name": "J Regan", "link": "https://stackoverflow.com/users/7402623/j-regan"}, "edited": false, "score": 0, "creation_date": 1484112299, "post_id": 41583070, "comment_id": 70371007, "body": "@JRegan - Remove the <code>Call</code> statement - it&#39;s obsolete. Otherwise, wrap the parameter in parentheses: <code>Call MAIN(True)</code>."}, {"owner": {"reputation": 13, "user_id": 7402623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab92c13aa25949eb3e2596e914b8c89f?s=128&d=identicon&r=PG&f=1", "display_name": "J Regan", "link": "https://stackoverflow.com/users/7402623/j-regan"}, "edited": false, "score": 0, "creation_date": 1484112660, "post_id": 41583070, "comment_id": 70371147, "body": "Removed the     Call statement and wrapped the TRUE which allowed me to put it in but I still get 1 for both answers. Is there anything else that may trip this up? I&#39;m using the same as what you have above at the moment. Also will having TRUE next to only one sub limit me to 2 options under false/true?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 13, "user_id": 7402623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab92c13aa25949eb3e2596e914b8c89f?s=128&d=identicon&r=PG&f=1", "display_name": "J Regan", "link": "https://stackoverflow.com/users/7402623/j-regan"}, "edited": false, "score": 0, "creation_date": 1484112917, "post_id": 41583070, "comment_id": 70371226, "body": "@JRegan - You can pass anything you need for a parameter. As far as determining why you&#39;re always getting 1, I&#39;d need to see your actual code. The example above should return 1 from B and 2 from A."}, {"owner": {"reputation": 13, "user_id": 7402623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab92c13aa25949eb3e2596e914b8c89f?s=128&d=identicon&r=PG&f=1", "display_name": "J Regan", "link": "https://stackoverflow.com/users/7402623/j-regan"}, "edited": false, "score": 0, "creation_date": 1484113167, "post_id": 41583070, "comment_id": 70371305, "body": "I haven&#39;t put this into my code yet, just testing so it&#39;s in 3 separate subs (all in the same module) with the only difference being that I have included &#39;Msgbox Answer&#39; to output the value at the end of the MAIN sub. Everything else is identical. Very strange.."}, {"owner": {"reputation": 13, "user_id": 7402623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab92c13aa25949eb3e2596e914b8c89f?s=128&d=identicon&r=PG&f=1", "display_name": "J Regan", "link": "https://stackoverflow.com/users/7402623/j-regan"}, "edited": false, "score": 0, "creation_date": 1484188067, "post_id": 41583070, "comment_id": 70410664, "body": "Ah never mind this was completely my mistake. I had 2 buttons setup to trigger sub a and b and somehow had them pointing to A... This does indeed work perfectly so thanks very much for your help, I&#39;ve already found many ways to use the optional arguments!"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1484111044, "creation_date": 1484111044, "answer_id": 41583070, "question_id": 41583020, "link": "https://stackoverflow.com/questions/41583020/vba-how-to-determine-the-outcome-of-an-if-statement-based-on-the-sub-that-call/41583070#41583070", "title": "VBA - How to determine the outcome of an IF statement based on the sub that called the sub it is in?", "body": "<p>Just pass an optional parameter if it's called from a specific location:</p>\n\n<pre><code>Sub A()\n    MAIN\nEnd Sub\n\nSub B()\n    MAIN True\nEnd Sub\n\nSub MAIN(Optional fromB As Boolean = False)\n    If fromB Then\n        Answer = 2\n    Else\n        Answer = 1\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7402623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab92c13aa25949eb3e2596e914b8c89f?s=128&d=identicon&r=PG&f=1", "display_name": "J Regan", "link": "https://stackoverflow.com/users/7402623/j-regan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 41583070, "answer_count": 1, "score": 0, "last_activity_date": 1484111044, "creation_date": 1484110722, "question_id": 41583020, "link": "https://stackoverflow.com/questions/41583020/vba-how-to-determine-the-outcome-of-an-if-statement-based-on-the-sub-that-call", "title": "VBA - How to determine the outcome of an IF statement based on the sub that called the sub it is in?", "body": "<p>First time poster but long time reader. I finally have a question that is either not here or I simply can't phrase it correctly enough to return an answer.</p>\n\n<p>What I'm trying to achieve is to have a single sub that I can call from other subs, that is 90% the same for everything and only changes the last 10% based on the sub that called it (possibly via an IF statement)</p>\n\n<p>maybe something like:</p>\n\n<pre><code>Sub A()\nCall Main\nEnd Sub\n\nSub B()\nCall MAIN\nEnd Sub\n\nSub MAIN()\nIf Sub A called Sub MAIN Then\nAnswer = 1\nelseif: Sub B called Sub MAIN Then\nAnswer = 2\nEndif\nEnd sub\n</code></pre>\n\n<p>I'm thinking this may not be possible but would be great to use something like this rather than writing a heap of almost identical subs.</p>\n\n<p>Any advice is appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1484110339, "post_id": 41582884, "comment_id": 70370337, "body": "See <a href=\"http://stackoverflow.com/documentation/vba/990/scripting-filesystemobject/10411/recursively-enumerate-folders-and-files#t=201701110450381295929\">this</a> and <a href=\"https://msdn.microsoft.com/en-us/library/5xc78d8d(v=vs.84).aspx\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1484112650, "post_id": 41582884, "comment_id": 70371144, "body": "You never set <code>LContinue</code> to <code>False</code> ?"}, {"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1484125576, "post_id": 41582884, "comment_id": 70376945, "body": "see &lt;<a href=\"http://stackoverflow.com/questions/41102975/how-can-i-improve-my-function-for-handling-alternative-to-application-filesearch\" title=\"how can i improve my function for handling alternative to application filesearch\">stackoverflow.com/questions/41102975/&hellip;</a>&gt; link. Posted this a while back. Look for my answer i posted to the question"}, {"owner": {"reputation": 1, "user_id": 7402576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ffcc0efe79e98bc344e8a5547489ffb?s=128&d=identicon&r=PG&f=1", "display_name": "pjanelson", "link": "https://stackoverflow.com/users/7402576/pjanelson"}, "reply_to_user": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1484175792, "post_id": 41582884, "comment_id": 70407233, "body": "Thanks all.   @mo.h I am trying to combine your previous answer with my desired actions as per above. Not having a lot of luck doing so, but the idea looks to be what I am trying to achieve."}, {"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1484175859, "post_id": 41582884, "comment_id": 70407255, "body": "@pjanelson I&#39;ll take a look tomorrow and help you out"}, {"owner": {"reputation": 1, "user_id": 7402576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ffcc0efe79e98bc344e8a5547489ffb?s=128&d=identicon&r=PG&f=1", "display_name": "pjanelson", "link": "https://stackoverflow.com/users/7402576/pjanelson"}, "reply_to_user": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1484178185, "post_id": 41582884, "comment_id": 70408055, "body": "@mo.h - thank you very much."}, {"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1484334372, "post_id": 41582884, "comment_id": 70483261, "body": "did you try my answer out?"}], "answers": [{"tags": [], "owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "is_accepted": false, "score": 2, "last_activity_date": 1484212713, "creation_date": 1484212713, "answer_id": 41609203, "question_id": 41582884, "link": "https://stackoverflow.com/questions/41582884/vba-check-if-file-exists-in-sub-folders/41609203#41609203", "title": "VBA check if file exists in sub folders", "body": "<p>Okay, my answer is going to revolve around 2 comments from your question. This will serve only as a basis for you to improve upon and adapt to how you need it.</p>\n\n<p><strong>N.B SKIP TO THE BOTTOM OF MY ANSWER TO SEE THE FULL WORKING CODE</strong></p>\n\n<p>The first comment is:</p>\n\n<blockquote>\n  <p><strong>I need to create a code that can search a main folder and loop through the various sub-folders.</strong>  </p>\n</blockquote>\n\n<p>The code i will explain below will take a MAIN FOLDER, that <strong>you will need to specify</strong>, and then it will loop through <strong>ALL</strong> subfolders of the parent directoy. So you will not need to worry about specific sub folders. As long as you know the <strong>name of the file</strong> you want to access, the code will find it regardless.</p>\n\n<p>The second is a line of your code:</p>\n\n<p><code>LPath = \"K:\\location\\main folder\\sub folder \\sub folder\"</code></p>\n\n<p>This line of code will form part of a UDF (User Defined Function) that i will display below.</p>\n\n<p><strong>Step 1</strong></p>\n\n<p>Re-label LPath to be the what is called the \"Host Folder\". This is the MAIN FOLDER. \nFor Example: <code>Host Folder = \"K:\\User\\My Documents\\\"</code> (Note the backslash at the end is needed)</p>\n\n<p><strong>Step 2</strong></p>\n\n<p>Set a reference to Microsoft Scripting Runtime in 2 places:</p>\n\n<p><strong>i) In the code</strong></p>\n\n<p><code>Set FileSystem = CreateObject(\"Scripting.FileSystemObject\")</code></p>\n\n<p><strong>ii) In the VBA Editor</strong>. (To a basic google search on how to find the reference library in the VBA editor)</p>\n\n<p><strong>Step 3</strong></p>\n\n<p>This is the main element, this is a sub routine that will find the file no matter where it is, providing a <strong>file name</strong> and <strong>host folder</strong> has been provided.</p>\n\n<pre><code>Sub DoFolder(Folder)\n\n    Dim SubFolder\n    For Each SubFolder In Folder.SubFolders\n        DoFolder SubFolder\n    Next\n    Dim File\n    For Each File In Folder.Files\n        If File.Name = \"Specify Name.pdf\" Then\n            Workbooks.Open (Folder.path &amp; \"\\\" &amp; File.Name), UpdateLinks:=False\n            Workbooks(File.Name).Activate\n            Exit Sub\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>The code above will simply open the file once it has found it. This was just my own specific use; adapt as necessary.</p>\n\n<p><strong>MAIN CODE</strong></p>\n\n<pre><code>Option Explicit\nDim FileSystem As Object\nDim HostFolder As String\n\nSub FindFile()\nHostFolder = \"K:\\User\\My Documents\\\"\n\nSet FileSystem = CreateObject(\"Scripting.FileSystemObject\")\nDoFolder FileSystem.GetFolder(HostFolder)\n\nEnd Sub\nSub DoFolder(Folder)\n\n    Dim SubFolder\n    For Each SubFolder In Folder.SubFolders\n        DoFolder SubFolder\n    Next\n    Dim File\n    For Each File In Folder.Files\n        If File.Name = \"Specify Name.pdf\" Then\n            Workbooks.Open (Folder.path &amp; \"\\\" &amp; File.Name), UpdateLinks:=False\n            Workbooks(File.Name).Activate\n            Exit Sub\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>You can chop this up how you see fit, you can probably throw it into your sub CheckIfFileExists() or just use it on its own. </p>\n\n<p>Let me know how you get along so i can help you understand this further</p>\n"}], "owner": {"reputation": 1, "user_id": 7402576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ffcc0efe79e98bc344e8a5547489ffb?s=128&d=identicon&r=PG&f=1", "display_name": "pjanelson", "link": "https://stackoverflow.com/users/7402576/pjanelson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4346, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484212713, "creation_date": 1484109997, "last_edit_date": 1484110181, "question_id": 41582884, "link": "https://stackoverflow.com/questions/41582884/vba-check-if-file-exists-in-sub-folders", "title": "VBA check if file exists in sub folders", "body": "<p>I am relatively amateur at VBA and am using a code provided by tech on the net. </p>\n\n<p>I have an Excel document with files names in column B (not always one file type) which I am trying to ensure I have copies and the correct revision in a designated folder.</p>\n\n<p>Currently, the code works perfectly for a specific folder location, but the files referenced in the Excel spreadsheet exist in various other folders and thus I need to create a code that can search a main folder and loop through the various sub-folders. </p>\n\n<p>See current code below for reference. </p>\n\n<pre><code>Sub CheckIfFileExists()\n\n    Dim LRow As Integer\n    Dim LPath As String\n    Dim LExtension As String\n    Dim LContinue As Boolean\n\n    'Initialize variables\n    LContinue = True\n    LRow = 8\n    LPath = \"K:\\location\\main folder\\sub folder \\sub folder\"\n    LExtension = \".pdf\"\n\n    'Loop through all column B values until a blank cell is found\n    While LContinue\n\n        'Found a blank cell, do not continue\n        If Len(Range(\"B\" &amp; CStr(LRow)).Value) = 0 Then\n            LContinue = True\n\n        'Check if file exists for document title\n        Else\n            'Place \"No\" in column E if the file does NOT exist\n            If Len(Dir(LPath &amp; Range(\"B\" &amp; CStr(LRow)).Value &amp; LExtension)) = 0 Then\n                Range(\"E\" &amp; CStr(LRow)).Value = \"No\"\n            'Place \"Yes\" in column E if the file does exist\n            Else\n                Range(\"E\" &amp; CStr(LRow)).Value = \"Yes\"\n            End If\n\n\n        End If\n\n        LRow = LRow + 1\n\n    Wend\n\nEnd Sub\n</code></pre>\n\n<p>There are over 1000 documents, so simple windows searches is not ideal, and I have reviewed several previous questions and cannot find an answer that helps.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1484108532, "post_id": 41582545, "comment_id": 70369789, "body": "<a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/vbe.aspx</a>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1484110521, "post_id": 41582545, "comment_id": 70370396, "body": "Determining if <code>Workbook_Open()</code> has code is much different than determining if <code>Workbook_Open()</code> has <b><i>executed</i></b>. Do you need to know if there is code there, or if it ran?"}, {"owner": {"reputation": 145, "user_id": 7402499, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/72f85ba88e22f99c290824f654397da8?s=128&d=identicon&r=PG&f=1", "display_name": "hardish", "link": "https://stackoverflow.com/users/7402499/hardish"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1484114081, "post_id": 41582545, "comment_id": 70371640, "body": "@Comintern, either way is good. If there are solutions to either, it will be great to know both of them!"}, {"owner": {"reputation": 145, "user_id": 7402499, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/72f85ba88e22f99c290824f654397da8?s=128&d=identicon&r=PG&f=1", "display_name": "hardish", "link": "https://stackoverflow.com/users/7402499/hardish"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1484114184, "post_id": 41582545, "comment_id": 70371673, "body": "@Tim, I can only see references to code stored in modules. My OP is about a piece of code which resides in Private Sub Workbook.open()."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1484119540, "post_id": 41582545, "comment_id": 70373909, "body": "&quot;Creating An Event Procedure&quot; on that page shows how to access the ThisWorkbook module"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484200969, "post_id": 41582545, "comment_id": 70414188, "body": "@hardish take a look at my answer and code below, and let me know if it works as you intended"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1484121794, "last_edit_date": 1484121794, "creation_date": 1484121221, "answer_id": 41585428, "question_id": 41582545, "link": "https://stackoverflow.com/questions/41582545/check-if-private-sub-workbook-open-is-empty/41585428#41585428", "title": "Check if Private Sub Workbook.open() is empty", "body": "<p>This code below (inside a regular module) loops through all the VB Project components (including <code>ThisWorkbook</code> module), and checks if the module name is \"ThisWorkbook\".</p>\n\n<p>Once it finds \"ThisWorkbook\" module, it checks the total number of code lines inside that module, if it's 0, it raises a <code>MsgBox</code> that it's empty. If it's not, then it checks to see if it can find a \"Workbook_Open\" string inside the code. If it does, it counts the total number of lines (not empty lines) of code between the \"Workbook_Open\" line and the closest \"End Sub\" line.</p>\n\n<p><strong><em>Check_WorkBookModule_Contents</em> Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub Check_WorkBookModule_Contents()\n\nConst PROC_NAME = \"ThisWorkbook\"\n\nDim VBProj As VBIDE.VBProject\nDim VBComp As VBIDE.VBComponent\nDim CodeMod As VBIDE.CodeModule\nDim i As Long, j As Long, SubLinesCount As Long\nDim ModuleCodeLinesCount As Long\n\nSet VBProj = ActiveWorkbook.VBProject\n\n' loop through all modules, worksheets and other objects in VB Project\nFor Each VBComp In VBProj.VBComponents\n    Set CodeMod = VBComp.CodeModule            \n    Debug.Print CodeMod.Name ' &lt;-- for debug\n\n    If CodeMod.Name Like PROC_NAME Then ' &lt;-- check if module name is \"ThisWorkbook\"\n        ' if total of code lines in \"ThisWorkbook\" module is empty\n        If CodeMod.CountOfLines = 0 Then\n            MsgBox CodeMod.Name &amp; \" module is empty\"\n            Exit Sub\n        End If                \n        SubLinesCount = 0 ' reset counter\n\n        ' loop through all code lines inside current module\n        For i = 1 To CodeMod.CountOfLines\n            If Len(CodeMod.Lines(i, 1)) &gt; 0 Then\n                ' if the name of current sub is found within the current code line\n                If CodeMod.Lines(i, 1) Like \"*Workbook_Open*\" Then\n\n                    For j = i + 1 To CodeMod.CountOfLines\n                        If Len(CodeMod.Lines(j, 1)) &gt; 0 And Not CodeMod.Lines(j, 1) Like \"End Sub*\" Then\n                            SubLinesCount = SubLinesCount + 1\n                        End If\n                    Next j\n\n                    If SubLinesCount &gt; 0 Then\n                        MsgBox CodeMod &amp; \" module, has an event of 'Workbook_Open' , with total of \" &amp; SubLinesCount &amp; \" lines of code\"\n                        Exit Sub\n                    Else\n                        MsgBox CodeMod &amp; \" module, has an event of 'Workbook_Open' , but it's empty !\"\n                        Exit Sub\n                    End If\n\n                End If\n            End If\n        Next i\n    End If\nNext VBComp\n\nEnd Sub\n</code></pre>\n\n<p><strong>Note</strong>: In order to access the VB Project Module, you need to follow the 2 steps below:</p>\n\n<p><strong>Step 1</strong>: Add \"<em>Trust access to the VBA project object model</em>\" , go to Developer >> Macro Security >> then add a V to the Trust access to the VBA project object model.</p>\n\n<p><strong>Step 2</strong>: Add Reference to your VB project, add \"<em>Microsoft Visual Basic for Applications Extensibility 5.3</em>\"</p>\n"}], "owner": {"reputation": 145, "user_id": 7402499, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/72f85ba88e22f99c290824f654397da8?s=128&d=identicon&r=PG&f=1", "display_name": "hardish", "link": "https://stackoverflow.com/users/7402499/hardish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 41585428, "answer_count": 1, "score": 1, "last_activity_date": 1484121794, "creation_date": 1484107721, "last_edit_date": 1531164843, "question_id": 41582545, "link": "https://stackoverflow.com/questions/41582545/check-if-private-sub-workbook-open-is-empty", "title": "Check if Private Sub Workbook.open() is empty", "body": "<p>I have a user who needs to execute a macro after an Excel file was opened, and who needs to know (programatically) if the current Excel file's Private Sub Workbook.open() routine is empty. </p>\n\n<p>Is there any way to keep this information in memory after the workbook is opened so that if the user needs to run his macro this information is available. Something along a persistent global var would be ideal. But i'm not sure if it's possible.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1484107477, "post_id": 41582472, "comment_id": 70369522, "body": "Can you edit the question to include your code?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1484107540, "post_id": 41582472, "comment_id": 70369538, "body": "Two things: 1) Is the procedure a <code>Sub</code> or <code>Function</code>. 2) Is it labeled <code>Private</code>?"}, {"owner": {"reputation": 145, "user_id": 7402499, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/72f85ba88e22f99c290824f654397da8?s=128&d=identicon&r=PG&f=1", "display_name": "hardish", "link": "https://stackoverflow.com/users/7402499/hardish"}, "edited": false, "score": 0, "creation_date": 1484113986, "post_id": 41582472, "comment_id": 70371598, "body": "It&#39;s a Private Sub as I want to call the built in Open sub. But it can be a public function as I assume I can call it from a Private Sub?"}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 7402499, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/72f85ba88e22f99c290824f654397da8?s=128&d=identicon&r=PG&f=1", "display_name": "hardish", "link": "https://stackoverflow.com/users/7402499/hardish"}, "edited": false, "score": 0, "creation_date": 1484117120, "post_id": 41584021, "comment_id": 70372854, "body": "Brilliant! This was easy!"}, {"owner": {"reputation": 145, "user_id": 7402499, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/72f85ba88e22f99c290824f654397da8?s=128&d=identicon&r=PG&f=1", "display_name": "hardish", "link": "https://stackoverflow.com/users/7402499/hardish"}, "edited": false, "score": 0, "creation_date": 1484534291, "post_id": 41584021, "comment_id": 70535432, "body": "I tried but it appears that I do not have enough feedback. If anybody can accept this for me?"}, {"owner": {"reputation": 145, "user_id": 7402499, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/72f85ba88e22f99c290824f654397da8?s=128&d=identicon&r=PG&f=1", "display_name": "hardish", "link": "https://stackoverflow.com/users/7402499/hardish"}, "edited": false, "score": 0, "creation_date": 1484534371, "post_id": 41584021, "comment_id": 70535445, "body": "Oh, ok, i should have clicked on the tick symbol, not the up arrow. Great, thanks @ASH"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 145, "user_id": 7402499, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/72f85ba88e22f99c290824f654397da8?s=128&d=identicon&r=PG&f=1", "display_name": "hardish", "link": "https://stackoverflow.com/users/7402499/hardish"}, "edited": false, "score": 0, "creation_date": 1484534425, "post_id": 41584021, "comment_id": 70535463, "body": "@hardish you&#39;re welcome, thanks for answering the call :)"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1484115795, "creation_date": 1484115795, "answer_id": 41584021, "question_id": 41582472, "link": "https://stackoverflow.com/questions/41582472/call-functino-sub-in-microsoft-excel-objects-this-workbook-vbe-hierarchy/41584021#41584021", "title": "Call functino/sub in Microsoft Excel Objects -&gt; This Workbook VBE hierarchy", "body": "<p>It seems that your problem is with the file's name having spaces, that's why you tried to put those parentheses. I did a similar test and it worked but instead of using parenthese I did it this way:</p>\n\n<pre><code>   Application.Run \"'\" &amp; wb.name &amp; \"'\" &amp; \"!\" &amp; vbcomp.name &amp; \".mySub\"\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 7402499, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/72f85ba88e22f99c290824f654397da8?s=128&d=identicon&r=PG&f=1", "display_name": "hardish", "link": "https://stackoverflow.com/users/7402499/hardish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 41584021, "answer_count": 1, "score": 1, "last_activity_date": 1484115795, "creation_date": 1484107307, "last_edit_date": 1531164843, "question_id": 41582472, "link": "https://stackoverflow.com/questions/41582472/call-functino-sub-in-microsoft-excel-objects-this-workbook-vbe-hierarchy", "title": "Call functino/sub in Microsoft Excel Objects -&gt; This Workbook VBE hierarchy", "body": "<p>I had no luck finding a way to call a function which is saved in the ThisWorkbook component of the VBE tree. I tried</p>\n\n<pre><code>Dim vbComponentName As String\nvbComponentName = \"ThisWorkbook\"\nDim wb As Workbook\nDim vbcomp As VBComponent\nSet wb = ThisWorkbook\nFor Each vbcomp In wb.VBProject.VBComponents\n    If vbcomp.Name = vbComponentName Then\n        Debug.Print \"command: \" &amp; wb.Name &amp; \"!\" &amp; vbcomp.Name &amp; \".Open\"\n        Application.Run (wb.Name &amp; \"!\" &amp; vbcomp.Name &amp; \".Open\")\n    End If\nNext \n</code></pre>\n\n<p>which prints:</p>\n\n<pre><code>Long Name File_v.18.xlsm!ThisWorkbook.Open\n</code></pre>\n\n<p>But it does not work. It compiles but gives me an error:</p>\n\n<pre><code>Cannot run the macro \"XYX\". \nThe macro may not be available in this workbook or all macros may be disable.\n</code></pre>\n\n<p>Any hints will be appreciated!</p>\n"}, {"tags": ["vba", "excel", "citrix"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1484111375, "post_id": 41582437, "comment_id": 70370692, "body": "There might be something going on with the Citrix client clipboard redirection. Are there any other oddities around copy and paste operations in that environment?"}, {"owner": {"reputation": 2663, "user_id": 62765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7cdd98de0548146a2677029896bed9e?s=128&d=identicon&r=PG", "display_name": "Craig T", "link": "https://stackoverflow.com/users/62765/craig-t"}, "edited": false, "score": 0, "creation_date": 1484114268, "post_id": 41582437, "comment_id": 70371712, "body": "Does it make any difference if you set the calculation method to &#39;Manual&#39; before you run it ?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1484143150, "post_id": 41582437, "comment_id": 70388703, "body": "@Comintern - it&#39;s not copy | paste. It&#39;s copying (think moving, but keeping the worksheet in the original file) an entire worksheet to another file."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 2663, "user_id": 62765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7cdd98de0548146a2677029896bed9e?s=128&d=identicon&r=PG", "display_name": "Craig T", "link": "https://stackoverflow.com/users/62765/craig-t"}, "edited": false, "score": 0, "creation_date": 1484143272, "post_id": 41582437, "comment_id": 70388770, "body": "@CraigT - Good suggestion, however no dice :( Still hangs."}, {"owner": {"reputation": 44153, "user_id": 109035, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CrLfp.jpg?s=128&g=1", "display_name": "Raj More", "link": "https://stackoverflow.com/users/109035/raj-more"}, "edited": false, "score": 0, "creation_date": 1484146813, "post_id": 41582437, "comment_id": 70391181, "body": "Is it because someone else has the file open, and it is waiting for the answer to the question about &quot;open read only&quot;?  try copying the Excel file to a local temp directory before initiating the individual sheet copy process."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 44153, "user_id": 109035, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CrLfp.jpg?s=128&g=1", "display_name": "Raj More", "link": "https://stackoverflow.com/users/109035/raj-more"}, "edited": false, "score": 0, "creation_date": 1484148230, "post_id": 41582437, "comment_id": 70392092, "body": "@RajMore - Answer to first question is no. Second point is good thought  however this will ultimately be run on a Citrix Environment so local temp is not an option. I did try to save on Citrix Desktop, but it still hung :("}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1484150323, "creation_date": 1484150323, "answer_id": 41595335, "question_id": 41582437, "link": "https://stackoverflow.com/questions/41582437/copying-worksheet-freezes-excel-when-files-stored-on-network-drives/41595335#41595335", "title": "Copying Worksheet Freezes Excel When Files Stored on Network Drives", "body": "<p>The problem occurred because of using an <code>EVALUATE</code> formula in Named Range on the worksheet. When I removed this the worksheet copied appropriately.</p>\n"}], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 614, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484150323, "creation_date": 1484107068, "last_edit_date": 1484146573, "question_id": 41582437, "link": "https://stackoverflow.com/questions/41582437/copying-worksheet-freezes-excel-when-files-stored-on-network-drives", "title": "Copying Worksheet Freezes Excel When Files Stored on Network Drives", "body": "<p>I have the following piece of code that copies worksheets from one file to another:</p>\n\n<pre><code>Dim wbMaster As Workbook\nSet wbMaster = Workbooks(\"UniversalQuoteProposal.xlsb\")\n\nDim vSheetNames As Variant\nvSheetNames = wsConfig.Range(\"SheetExportGeneralLiability\")\n\nDim i As Integer\nFor i = LBound(vSheetNames) To UBound(vSheetNames)\n    If vSheetNames(i, 2) = \"X\" Then ThisWorkbook.Worksheets(vSheetNames(i, 1)).Copy Before:=wbMaster.Worksheets(1)\nNext\n</code></pre>\n\n<p>This code works brilliantly on my local machine, but when I run it when files are saved on the Network the <code>.Copy</code> method freezes Excel (on the very first worksheet).</p>\n\n<p>Now, the worksheet has several formulas, most with structured referencing to tables elsewhere in the file and a few more complex (but nothing too crazy) ... <code>SUMIF</code> and such. However, this works smooth and fast in my local machine.</p>\n\n<p>Setting calcs to manual before the copy operation did not work. Neither did moving the worksheet (as opposed to copying it).</p>\n\n<p>I suspect its because the copied sheet has to create links to the shared drive and it's hanging. I can't flatten the formulas because they will be affected by user-entry downstream.</p>\n\n<p>Any clue how I can get this to work in the network drivesor things I should be looking out for? </p>\n"}, {"tags": ["excel", "if-statement", "excel-formula", "ifs", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1484107259, "post_id": 41582383, "comment_id": 70369471, "body": "Please read <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a> and edit your question accordingly and for more readability. The question is very likely to be closed in the format its written."}, {"owner": {"reputation": 750, "user_id": 2787159, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/g8VG6.png?s=128&g=1", "display_name": "thatsIch", "link": "https://stackoverflow.com/users/2787159/thatsich"}, "edited": false, "score": 0, "creation_date": 1484111985, "post_id": 41582383, "comment_id": 70370904, "body": "Please what you already tried and a well formatted display what you input and what is supposed to be returned."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1484125364, "post_id": 41582383, "comment_id": 70376837, "body": "As a hint, given no example, I would suggest IF() and VLOOKUP() may work."}, {"owner": {"reputation": 21, "user_id": 7388338, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AAScM17cKhE/AAAAAAAAAAI/AAAAAAAADI8/2i0CrJhwu28/photo.jpg?sz=128", "display_name": "Mehdi Fit", "link": "https://stackoverflow.com/users/7388338/mehdi-fit"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1484187293, "post_id": 41582383, "comment_id": 70410459, "body": "@SolarMike  i think i need VBA for my case, i have 3 variables which they all are dependent. age, gender and BPI. Bpi is a number. this number must be analyze base on the user&#39;s age and gender. eg. people who their age is between 20-39 if they are male and their BPI &lt; 8 then they are &quot;underweight&quot; for female is different. if they are 20-39 and female and bpi &lt; 21 then they are underweight"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1484202339, "post_id": 41582383, "comment_id": 70414698, "body": "It is noticed that you gave Alan Wage the same response as you gave me... If you put your data in two tables : on male one female then lookup etc can work - much of this depends on how you structure your data and this also controls how easy it is to change or update the values . if you have them all &quot;hardcoded&quot; in the function then updating a value is difficult : a table value can be changed quickly while the calculation proceeds as set."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7388338, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AAScM17cKhE/AAAAAAAAAAI/AAAAAAAADI8/2i0CrJhwu28/photo.jpg?sz=128", "display_name": "Mehdi Fit", "link": "https://stackoverflow.com/users/7388338/mehdi-fit"}, "edited": false, "score": 0, "creation_date": 1484187191, "post_id": 41600976, "comment_id": 70410429, "body": "i think i need VBA for my case, i have 3 variables which they all are dependent. age, gender and BPI. Bpi is a number. this number must be analyze base on the user&#39;s age and gender. eg. people who their age is between 20-39 if they are male and their BPI &lt; 8 then they are &quot;underweight&quot; for female is different. if they are 20-39 and female and bpi &lt; 21 then they are underweight."}, {"owner": {"reputation": 583, "user_id": 2286964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca11e109f5f3e0877a0ab858f33c3d4c?s=128&d=identicon&r=PG", "display_name": "Alan Waage", "link": "https://stackoverflow.com/users/2286964/alan-waage"}, "reply_to_user": {"reputation": 21, "user_id": 7388338, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AAScM17cKhE/AAAAAAAAAAI/AAAAAAAADI8/2i0CrJhwu28/photo.jpg?sz=128", "display_name": "Mehdi Fit", "link": "https://stackoverflow.com/users/7388338/mehdi-fit"}, "edited": false, "score": 0, "creation_date": 1484773184, "post_id": 41600976, "comment_id": 70653088, "body": "For complex logic, VBA provides results that will be much easier to read and maintain.  Just create a function that takes your three variables as parameters and returns the desired result string.  Then call that function in the cell."}], "tags": [], "owner": {"reputation": 583, "user_id": 2286964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca11e109f5f3e0877a0ab858f33c3d4c?s=128&d=identicon&r=PG", "display_name": "Alan Waage", "link": "https://stackoverflow.com/users/2286964/alan-waage"}, "is_accepted": false, "score": 0, "last_activity_date": 1484170001, "creation_date": 1484170001, "answer_id": 41600976, "question_id": 41582383, "link": "https://stackoverflow.com/questions/41582383/excel-if-function-ifs/41600976#41600976", "title": "Excel , if function, ifs,", "body": "<p>You can obtain your desired result using the IF workbook function.  To get multiple criteria in a single IF condition use the AND() and OR() functions.  To create if - elseif type logic, nest added IF() functions inside the appropriate sections.  as an example</p>\n\n<pre><code>=IF(OR(AND(A1=\"Male\", A2&gt;20),AND(A1=\"Female\",A2&gt;30)), IF(A3&gt;200,\"overweight\",\"healthy\"),\"otherstuff\")\n</code></pre>\n\n<p>This should get you started down the right path.</p>\n"}], "owner": {"reputation": 21, "user_id": 7388338, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AAScM17cKhE/AAAAAAAAAAI/AAAAAAAADI8/2i0CrJhwu28/photo.jpg?sz=128", "display_name": "Mehdi Fit", "link": "https://stackoverflow.com/users/7388338/mehdi-fit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484186735, "creation_date": 1484106652, "last_edit_date": 1531161705, "question_id": 41582383, "link": "https://stackoverflow.com/questions/41582383/excel-if-function-ifs", "title": "Excel , if function, ifs,", "body": "<pre><code>I assume x is the number I'm going to analyze and \"y\" is as \"male\" or \"female\" and \"z\" is as age group.\n</code></pre>\n\n<p>x is a number that the result will be \"underweight\", healthy \" or overweight\". but x which is actually the BPI is not the same for male and female. eg, if x = 21 then depends on gender and age it would be categorized as either \"underweigh\", \"healthy \" or overweight\".</p>\n\n<pre><code> Function BAI(x As Integer, y As String, z As Integer) As String\n\n\n If x &lt; 21 And y = \"female\" And 20 &lt;= z &lt;= 39 Then\n    BAI = \"UNDERWEIGHT\"\n\n Elseif 22 &lt;= x &lt;= 33 And y = \"Female\" And 20 &lt;= z &lt;= 39 Then\n    BAI = \"Healthy\"\n\nElseIf 34 &lt;= x &lt;= 38 And y = \"Female\" And 20 &lt;= z &lt;= 39 Then\n    BAI = \"overweight\"\n\nElseIf x &gt;= 39 And y = \"Female\" And 20 &lt;= z &lt;= 39 Then\n    BAI = \"OBESE\"\n\nElseIf x &lt;= 23 And y = \"female\" And 40 &lt;= z &lt;= 59 Then\n    BAI = \"UNDERWEIGHT\"\n\nElseIf 24 &lt;= x &lt;= 35 And y = \"female\" And 40 &lt;= z &lt;= 59 Then\n    BAI = \"Healthy\"\n\nElseIf 36 &lt;= x &lt;= 41 And y = \"female\" And 40 &lt;= z &lt;= 59 Then\n    BAI = \"Overweight\"\n\nElseIf x &gt;= 42 And y = \"female\" And 40 &lt;= z &lt;= 59 Then\n    BAI = \"OBESE\"\n\nElseIf x &lt;= 25 And y = \"female\" And 60 &lt;= z &lt;= 79 Then\n    BAI = \"UNDERWEIGHT\"\n\nElseIf 26 &lt;= x &lt;= 38 And y = \"female\" And 60 &lt;= z &lt;= 79 Then\n    BAI = \"Healthy\"\n\nElseIf 39 &lt;= x &lt;= 43 And y = \"female\" And 60 &lt;= z &lt;= 79 Then\n    BAI = \"Overweight\"\n\nElseIf x &gt;= 44 And y = \"female\" And 60 &lt;= z &lt;= 79 Then\n    BAI = \"obese\"\n\nElseIf x &lt;= 8 And y = \"male\" And 20 &lt;= z &lt;= 39 Then\n    BAI = \"Underweight\"\n\nElseIf 9 &lt;= x &lt;= 21 And y = \"male\" And 20 &lt;= z &lt;= 39 Then\n    BAI = \"Healthy\"\n\nElseIf 22 &lt;= x &lt;= 26 And y = \"male\" And 20 &lt;= z &lt;= 39 Then\n    BAI = \"overweight\"\n\nElseIf x &gt;= 27 And y = \"male\" And 20 &lt;= z &lt;= 39 Then\n    BAI = \"OBESE\"\n\nElseIf x &lt;= 11 And y = \"male\" And 40 &lt;= z &lt;= 59 Then\n    BAI = \"UNDERWEIGHT\"\n\nElseIf 12 &lt;= x &lt;= 23 And y = \"male\" And 40 &lt;= z &lt;= 59 Then\n    BAI = \"Healthy\"\n\nElseIf 24 &lt;= x &lt;= 28 And y = \"male\" And 40 &lt;= z &lt;= 59 Then\n    BAI = \"Overweight\"\n\nElseIf x &gt;= 29 And y = \"male\" And 40 &lt;= z &lt;= 59 Then\n    BAI = \"OBESE\"\n\nElseIf x &lt;= 13 And y = \"male\" And 60 &lt;= z &lt;= 79 Then\n    BAI = \"UNDERWEIGHT\"\n\nElseIf 14 &lt;= x &lt;= 25 And y = \"male\" And 60 &lt;= z &lt;= 79 Then\n    BAI = \"Healthy\"\n\nElseIf 26 &lt;= x &lt;= 30 And y = \"male\" And 60 &lt;= z &lt;= 79 Then\n    BAI = \"Overweight\"\n\n End If\n\n End Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1484107429, "post_id": 41582249, "comment_id": 70369510, "body": "Have you actually tried to accomplish your goal? If so, please show us what you have tried and where it&#39;s failing. SO is not a code-for-me site."}, {"owner": {"reputation": 107, "user_id": 7352029, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/90e6dc8e682ae24ded254a77b8b4c35e?s=128&d=identicon&r=PG&f=1", "display_name": "walter while", "link": "https://stackoverflow.com/users/7352029/walter-while"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1484110996, "post_id": 41582249, "comment_id": 70370551, "body": "I have tried to add the search criteria, but i&#39;m not sure on how to copy a specific col based on search criteria and paste in a different sheet."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484125305, "post_id": 41582249, "comment_id": 70376808, "body": "where is your closing <code>Next</code> for your <code>For Each test In Count1Criteria</code> ? what exactly are you trying to achieve in the <code>With</code> section ??? which <code>Worksheet</code> is <code>Worksheets(test(2))</code> suppose to be ?  what are you trying to achieve in <code>Range(test(0)) = wf.CountIfs(.Range(test(3)), test(4))</code> ?"}, {"owner": {"reputation": 107, "user_id": 7352029, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/90e6dc8e682ae24ded254a77b8b4c35e?s=128&d=identicon&r=PG&f=1", "display_name": "walter while", "link": "https://stackoverflow.com/users/7352029/walter-while"}, "edited": false, "score": 0, "creation_date": 1484129637, "post_id": 41582249, "comment_id": 70379783, "body": "The above code is only to check for Keywords like &quot;Pass&quot;, &quot;Fail&quot; in the given ranges and update the count in the cells. I can use this code to search for the keywords, but I&#39;m stuck with the part after that. (i.e, once this condition is satisfied, the values in M column should be pasted into a different sheet) . I now figured out a below code to copy paste the column into a diff sheet, but dont know how to merge both the codes :"}, {"owner": {"reputation": 107, "user_id": 7352029, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/90e6dc8e682ae24ded254a77b8b4c35e?s=128&d=identicon&r=PG&f=1", "display_name": "walter while", "link": "https://stackoverflow.com/users/7352029/walter-while"}, "edited": false, "score": 0, "creation_date": 1484129781, "post_id": 41582249, "comment_id": 70379886, "body": "This is the code to copy paste the column into another sheet : <code>last_row = Cells.Find(&quot;*&quot;, SearchOrder:=XlSearchOrder.xlByRows,         SearchDirection:=XlSearchDirection.xlPrevious).Row Range(&quot;M1:M&quot; &amp; last_row&quot;).select Selection.Copy Sheets(&quot;Sheet2&quot;).Activate Range(&quot;D1&quot;).Select Activesheet.Paste Sheets(&quot;Sheet1&quot;).Activate</code>"}], "answers": [{"tags": [], "owner": {"reputation": 107, "user_id": 7352029, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/90e6dc8e682ae24ded254a77b8b4c35e?s=128&d=identicon&r=PG&f=1", "display_name": "walter while", "link": "https://stackoverflow.com/users/7352029/walter-while"}, "is_accepted": true, "score": 0, "last_activity_date": 1484182374, "creation_date": 1484182374, "answer_id": 41603403, "question_id": 41582249, "link": "https://stackoverflow.com/questions/41582249/pasting-columns-in-different-sheet-using-vba/41603403#41603403", "title": "Pasting columns in different sheet using VBA", "body": "<p>This does the job:</p>\n\n<pre><code>Sub sbMoveData()\nDim lRow As Integer, i As Integer, j As Integer\n 'Find last roe in Sheet1\n\nlRow = Sheet1.Cells.SpecialCells(xlLastCell).Row\n\nj = 1\nFor i = 1 To lRow\n\nIf UCase(Sheet1.Range(\"A\" &amp; i)) = \"COMPATIBLE\" And UCase(Sheet1.Range(\"B\" &amp; i)) = \"PASS\" Then\n\nSheets(\"Sheet1\").Range(\"M\" &amp; i).Copy Destination:=Sheets(\"Sheet2\").Range(\"A\" &amp; j)\n\nj = j + 1\n\nEnd If\n\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 7352029, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/90e6dc8e682ae24ded254a77b8b4c35e?s=128&d=identicon&r=PG&f=1", "display_name": "walter while", "link": "https://stackoverflow.com/users/7352029/walter-while"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 41603403, "answer_count": 1, "score": 1, "last_activity_date": 1542342344, "creation_date": 1484105587, "last_edit_date": 1542342344, "question_id": 41582249, "link": "https://stackoverflow.com/questions/41582249/pasting-columns-in-different-sheet-using-vba", "title": "Pasting columns in different sheet using VBA", "body": "<p>I have the below code that will find and give the count if it matches the specific criteria:</p>\n\n<pre><code>Sub WBR()\nDim Count1Criteria As Variant\nDim Count3Criteria As Variant\nDim test As Variant\nDim wf As WorksheetFunction\nSet wf = Application.WorksheetFunction\n\nCount1Criteria = Array(Array(\"AE4\", \"AE5\", \"Latency\", \"O:O\", \"Pass\", \"Fail\"))\nFor Each test In Count1Criteria\nWith Worksheets(test(2))\n    Range(test(0)) = wf.CountIfs(.Range(test(3)), test(4))\n    Range(test(1)) = wf.CountIfs(.Range(test(3)), test(5))\n    End With\n    End Sub\n</code></pre>\n\n<p>I want to do the following:</p>\n\n<ul>\n<li>Once this criteria is met, instead of adding the count to the designated cell, the values in \"M\" col (named as \"LATENCY\") should be copied and pasted in \"D\" col in sheet.</li>\n</ul>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1484113157, "creation_date": 1484113157, "answer_id": 41583450, "question_id": 41582184, "link": "https://stackoverflow.com/questions/41582184/find-nearest-row-match-using-vba/41583450#41583450", "title": "Find nearest row match using VBA", "body": "<p>Assuming that by \"nearest\" you meant nearest volume (in the case of no exaxt matching), I suggest this function that returns the right range given those parameters. Note that I assumed that your \"Gauge\" column is next to the \"Format\" one (columns H and I as in your code) while your pictures shows that gauge comes last...</p>\n\n<pre><code>Option Explicit\n\nFunction findNearestRow(FindIn As Range, Format As String, _\n    Gauge As String, Width As Double, Depth As Double, Length As Double) As Range\n\n    Dim F As String, G As String, W As Double, D As Double, L As Double\n    Dim i As Long, best As Long, vol As Double, diff As Double, minDiff As Double\n    minDiff = 99999999\n\n    vol = Width * Depth * Length\n    For i = 1 To FindIn.Rows.Count\n        F = FindIn.Cells(i, 1).Value\n        G = FindIn.Cells(i, 2).Value\n        If F = Format And G = Gauge Then\n            W = FindIn.Cells(i, 3).Value\n            D = FindIn.Cells(i, 4).Value\n            L = FindIn.Cells(i, 5).Value\n            If W = Width And D = Depth And L = Length Then\n                Set findNearestRow = FindIn.Rows(i)\n                Exit Function\n            End If\n\n            diff = Abs(W * D * L - vol)\n            If diff &lt; minDiff Then\n               minDiff = diff\n               best = i\n            End If\n        End If\n   Next\n   If minDiff &lt; 1000 Then Set findNearestRow = FindIn.Rows(best)\n   ' Else it returns null, nearest matching too far\n\nEnd Function\n\nSub Test()\n    Dim r As Range\n    Set r = findNearestRow(FindIn:=Range(\"H2:L20\"), _\n                Format:=Sheets(\"inputs\").Range(\"H26\"), _\n                Gauge:=Sheets(\"inputs\").Range(\"I26\"), _\n                Width:=Sheets(\"inputs\").Range(\"J26\"), _\n                Depth:=Sheets(\"inputs\").Range(\"K26\"), _\n                Length:=Sheets(\"inputs\").Range(\"L26\"))\n\n    If r Is Nothing Then\n        MsgBox \"no matching found\"\n    Else\n        r.Select\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1484144153, "creation_date": 1484144153, "answer_id": 41593220, "question_id": 41582184, "link": "https://stackoverflow.com/questions/41582184/find-nearest-row-match-using-vba/41593220#41593220", "title": "Find nearest row match using VBA", "body": "<p>You could first <code>AutoFilter()</code> the exact matches and then loop through filtered cells for the <em>nearest</em> triple:</p>\n\n<pre><code>Option Explicit\n\nSub Calculate()\n    Dim Format As String\n    Dim Gauge As Long, Width As Long, Depth As Long, Length As Long\n    Dim nearestRate As Double\n    Dim nearestRng As Range, cell As Range\n\n    With Sheets(\"inputs\")\n        Format = .Range(\"H26\").Value2\n        Gauge = .Range(\"I26\").Value2\n        Width = .Range(\"J26\").Value2\n        Depth = .Range(\"K26\").Value2\n        Length = .Range(\"L26\").Value2\n        With .Range(\"F1\", .Cells(.Rows.Count, \"A\").End(xlUp))\n            .AutoFilter field:=2, Criteria1:=Format\n            .AutoFilter field:=6, Criteria1:=Gauge\n            If Application.WorksheetFunction.Subtotal(103, .Resize(, 1)) &gt; 1 Then\n                nearestRate = 100000000#\n                For Each cell In .Resize(.Rows.Count - 1, 1).Offset(1, 2).SpecialCells(xlCellTypeVisible)\n                    UpdateNearest cell, Width, Depth, Length, nearestRate, nearestRng\n                Next\n            End If\n        End With\n    End With\nEnd Sub\n\nFunction UpdateNearest(rng As Range, refVal1 As Long, refVal2 As Long, refVal3 As Long, nearestRate As Double, nearestRng As Range) As Long\n    Dim rate As Double\n\n    rate = Sqr((rng.Value - refVal1) ^ 2 + (rng.Offset(, 1).Value - refVal1) ^ 2 + (rng.Offset(, 2).Value - refVal2) ^ 2)\n    If rate &lt; nearestRate Then\n        nearestRate = rate\n        Set nearestRng = rng\n    End If\nEnd Function\n</code></pre>\n\n<p>the <code>UpdateNearest()</code> function assumes a criteria of minimum differences squares sum. but you can adapt to your actual (and unknown) needs</p>\n"}], "owner": {"reputation": 2421, "user_id": 369619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/a229f6bec8489362b3b3c8debc8a08f6?s=128&d=identicon&r=PG&f=1", "display_name": "Cannon", "link": "https://stackoverflow.com/users/369619/cannon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 206, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1484144153, "creation_date": 1484105101, "last_edit_date": 1531164843, "question_id": 41582184, "link": "https://stackoverflow.com/questions/41582184/find-nearest-row-match-using-vba", "title": "Find nearest row match using VBA", "body": "<p>I have sample table as below</p>\n\n<pre><code>Type    Format  W   D   L   Gauge\nRoxy    Rubbers 31  1   1   3\nRoxy    Rubbers 36  0   48  4\nRoxy    Rubbers 36  1   1   3\n</code></pre>\n\n<p>Here is my sub</p>\n\n<pre><code>Sub Calculate()\n   Dim Format, Gauge, Width, Depth, Length As String \n   Format = Sheets(\"inputs\").Range(\"H26\")\n   Gauge = Sheets(\"inputs\").Range(\"I26\")\n   Width = Sheets(\"inputs\").Range(\"J26\")\n   Depth = Sheets(\"inputs\").Range(\"K26\")\n   Length = Sheets(\"inputs\").Range(\"L26\")\n\n   Dim vArray() As Variant\n   vArray = Range(\"myRange\")\n\n   Dim i As Long\n   For i = LBound(vArray, 1) To UBound(vArray, 1)\n       Debug.Print vArray(i, 1)\n   Next\nEnd Sub\n</code></pre>\n\n<p>How do I find nearest row using VBA?\nGauge and format needs to be exact match and for W/D/L need to return nearest match</p>\n\n<p>Example:\nFor Rubbers, 3 gauge, 30x12x12 input it should return first row as result</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1484104611, "post_id": 41582083, "comment_id": 70368870, "body": "........Cool code..........."}, {"owner": {"reputation": 31, "user_id": 7402343, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xfCVQm5V4pE/AAAAAAAAAAI/AAAAAAAADak/NiCQrMYKr8Q/photo.jpg?sz=128", "display_name": "MButler", "link": "https://stackoverflow.com/users/7402343/mbutler"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1484104706, "post_id": 41582083, "comment_id": 70368891, "body": ".....Thank you!"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1484105634, "post_id": 41582083, "comment_id": 70369081, "body": "I think it is a naming issue, because you are missing the ! after the worksheet:  Selection.OnAction = SheetCodeName &amp; &quot;!&quot; &amp; NewLiftSpace &amp; &quot;_Button&quot;"}, {"owner": {"reputation": 31, "user_id": 7402343, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xfCVQm5V4pE/AAAAAAAAAAI/AAAAAAAADak/NiCQrMYKr8Q/photo.jpg?sz=128", "display_name": "MButler", "link": "https://stackoverflow.com/users/7402343/mbutler"}, "edited": false, "score": 0, "creation_date": 1484105980, "post_id": 41582083, "comment_id": 70369159, "body": "I changed it to your suggestion (Selection.OnAction = SheetCodeName &amp; &quot;!&quot; &amp; NewLiftSpace &amp; &quot;_Button&quot;), but no such luck.  Still receive the &quot;1004&quot; error on the initial run of opening the workbook, but continues to work fine afterward."}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1484107214, "post_id": 41582083, "comment_id": 70369459, "body": "Have you tried switching the &quot;code&quot;-subroutine with the &quot;with&quot;-loop above it?"}, {"owner": {"reputation": 31, "user_id": 7402343, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xfCVQm5V4pE/AAAAAAAAAAI/AAAAAAAADak/NiCQrMYKr8Q/photo.jpg?sz=128", "display_name": "MButler", "link": "https://stackoverflow.com/users/7402343/mbutler"}, "edited": false, "score": 0, "creation_date": 1484108319, "post_id": 41582083, "comment_id": 70369725, "body": "So I moved the &quot;code&quot; sub to be above the &quot;with&quot; (button) loop and no such luck.  Still &quot;1004&quot; error."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1484110117, "post_id": 41582083, "comment_id": 70370246, "body": "I can&#39;t replicate a 1004 error with the code that you posted.  Can you edit the question to include the calling code?"}, {"owner": {"reputation": 31, "user_id": 7402343, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xfCVQm5V4pE/AAAAAAAAAAI/AAAAAAAADak/NiCQrMYKr8Q/photo.jpg?sz=128", "display_name": "MButler", "link": "https://stackoverflow.com/users/7402343/mbutler"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1484137981, "post_id": 41582083, "comment_id": 70385383, "body": "@Comintern, I have included the calling code.  This is the complete code when the user selects &quot;Add New Lift&quot; on the &quot;Main&quot; sheet.  Thanks for your help!"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7402343, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xfCVQm5V4pE/AAAAAAAAAAI/AAAAAAAADak/NiCQrMYKr8Q/photo.jpg?sz=128", "display_name": "MButler", "link": "https://stackoverflow.com/users/7402343/mbutler"}, "edited": false, "score": 0, "creation_date": 1484155322, "post_id": 41595044, "comment_id": 70396716, "body": "Thank you for your help!  I pasted your code in place of my code and I don&#39;t see the error, BUT... The &quot;code&quot; string isn&#39;t getting written to the new worksheet (SheetCodeName) nor does it appear that the &quot;Log History&quot; button is getting assigned an .OnAction.  What is odd to me though, is that as soon as I open the VBA editor and rerun the &quot;Add New Lift&quot;, everything works fine."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 31, "user_id": 7402343, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xfCVQm5V4pE/AAAAAAAAAAI/AAAAAAAADak/NiCQrMYKr8Q/photo.jpg?sz=128", "display_name": "MButler", "link": "https://stackoverflow.com/users/7402343/mbutler"}, "edited": false, "score": 0, "creation_date": 1484155650, "post_id": 41595044, "comment_id": 70396915, "body": "I don&#39;t get you: are you done or do you still have issues?"}, {"owner": {"reputation": 31, "user_id": 7402343, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xfCVQm5V4pE/AAAAAAAAAAI/AAAAAAAADak/NiCQrMYKr8Q/photo.jpg?sz=128", "display_name": "MButler", "link": "https://stackoverflow.com/users/7402343/mbutler"}, "edited": false, "score": 0, "creation_date": 1484155784, "post_id": 41595044, "comment_id": 70397000, "body": "I&#39;m not receiving the Runtime &quot;1004&quot; error anymore, but the &quot;code&quot; string is not getting written to the new worksheet and the &quot;Log History&quot; button is not getting assigned an action."}, {"owner": {"reputation": 31, "user_id": 7402343, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xfCVQm5V4pE/AAAAAAAAAAI/AAAAAAAADak/NiCQrMYKr8Q/photo.jpg?sz=128", "display_name": "MButler", "link": "https://stackoverflow.com/users/7402343/mbutler"}, "edited": false, "score": 0, "creation_date": 1484157234, "post_id": 41595044, "comment_id": 70397914, "body": "After further inspection, the code works, but only if the VBA Editor is open.  It throws a Runtime &quot;9&quot; error where the code is written to the new worksheet (SheetCodeName) if the VBA Editor is not open.  I guess this might be from a memory issue."}, {"owner": {"reputation": 31, "user_id": 7402343, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xfCVQm5V4pE/AAAAAAAAAAI/AAAAAAAADak/NiCQrMYKr8Q/photo.jpg?sz=128", "display_name": "MButler", "link": "https://stackoverflow.com/users/7402343/mbutler"}, "edited": false, "score": 0, "creation_date": 1484157655, "post_id": 41595044, "comment_id": 70398142, "body": "Below is the code that writes the &quot;code&quot; string and throws the runtime &quot;9&quot; error, unless the VBA Editor is open.  I will do some code stepping this afternoon to see what I can find.  Thanks!.........          With ActiveWorkbook.VBProject.VBComponents(SheetCodeName).CodeMod&zwnj;&#8203;ule &#39;&lt;--| reference your new sheet &#39;CodeName&#39;         .InsertLines .CountOfLines + 1, Code     End With"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1484149442, "creation_date": 1484149442, "answer_id": 41595044, "question_id": 41582083, "link": "https://stackoverflow.com/questions/41582083/onaction-runtime-error-1004-on-initial-run/41595044#41595044", "title": "OnAction Runtime Error &quot;1004&quot; on initial run", "body": "<p>it's because after <code>Sheets.Add(...</code> the new sheet becomes the <em>Active</em> and once in <code>CreateButton()</code> the statement:</p>\n\n<pre><code>With ActiveSheet 'Main Sheet\n</code></pre>\n\n<p>is actually referencing the new added sheet and not \"Main\" one as you expected</p>\n\n<p>Bottom line, avoid <code>Activate</code>/<code>ActiveXXX</code>/<code>Select</code>/<code>Selection</code> coding pattern as much as possible and use fully qualified range references as in the following refactoring of your code:</p>\n\n<pre><code>Option Explicit\n\nSub Add_New_Lift()\n\n    '*****************************************************************************************************\n    ' This macro creates a new columns that contains the lift name, \"Current\", \"Goal\", \"% Goal\" and formulas\n    '*****************************************************************************************************\n    Dim ecol As Integer, ColNo1 As Integer, ColNo2 As Integer, ColNo3 As Integer\n    Dim ColLet1 As String, ColLet2 As String, ColLet3 As String\n    Dim erow As Integer\n    Dim NewLift As String\n    Dim Lift_Metcon As String\n    Dim SheetCodeName As String\n    Dim cell As Range\n\n    Application.ScreenUpdating = False\n    On Error GoTo errHandler\n    'Ask user to provide the name of the lift through a message box\n    NewLift = InputBox(\"New Lift Name:\", \"Add New Lift\")\n\n    If StrPtr(NewLift) = 0 Or NewLift = \"\" Then Exit Sub\n    Do\n        Lift_Metcon = InputBox(\"Is this a Lift (Weight), Metcon (Time), or AMRAP (Total Reps):\" &amp; _\n                        vbCrLf &amp; vbTab &amp; \"-   Lift\" &amp; _\n                        vbCrLf &amp; vbTab &amp; \"-   Metcon\" &amp; _\n                        vbCrLf &amp; vbTab &amp; \"-   AMRAP\" _\n                        , \"Type of Measurement\")\n        If StrPtr(Lift_Metcon) = 0 Then Exit Sub\n    Loop While Not ((Lift_Metcon = \"Lift\") Or (Lift_Metcon = \"Metcon\") Or (Lift_Metcon = \"AMRAP\"))\n\n    'Find first empty column to add the new lift and formatting as well as Column letters for use with formula\n    With Worksheets(\"Main\") '&lt;--| reference your \"Main\" sheet\n        ecol = .Cells(4, Columns.Count).End(xlToLeft).Offset(0, 1).Column\n        ColNo1 = ecol\n        ColLet1 = Split(.Cells(, ColNo1).Address, \"$\")(1)\n        ColNo2 = ecol + 1\n        ColLet2 = Split(.Cells(, ColNo2).Address, \"$\")(1)\n        ColNo3 = ecol + 2\n        ColLet3 = Split(.Cells(, ColNo3).Address, \"$\")(1)\n\n        'Formatting\n        With .Columns(ecol) '&lt;--| reference referenced sheet 'ecol'th column\n            .Borders(xlEdgeLeft).LineStyle = xlContinuous\n            .Borders(xlEdgeLeft).Weight = xlMedium\n        End With\n        .Range(.Cells(3, ecol), .Cells(3, ecol + 2)).Merge\n        .Cells(3, ecol) = NewLift\n        .Cells(3, ecol).Font.Size = 16\n        .Cells(4, ecol) = \"Current\"\n        .Cells(4, ecol + 1) = \"Goal\"\n        .Cells(4, ecol + 2) = \"% Goal\"\n        .Range(.Cells(3, ecol), .Cells(4, ecol + 2)).HorizontalAlignment = xlCenter\n        .Range(.Cells(3, ecol), .Cells(4, ecol + 2)).Font.Bold = True\n        .Range(.Cells(3, ecol), .Cells(4, ecol + 2)).ColumnWidth = 8\n        .Range(.Cells(1, ecol), .Cells(4, ecol + 2)).Interior.Color = RGB(166, 166, 166)\n        .Range(.Cells(5, ecol + 2), .Cells(100, ecol + 2)).Formula = \"=IF(\" &amp; ColLet1 &amp; \"5&lt;&gt; \"\"\"\", \" &amp; ColLet1 &amp; \"5/\" &amp; ColLet2 &amp; \"5,\"\"\"\" )\"\n        .Range(.Cells(5, ecol + 2), .Cells(100, ecol + 2)).NumberFormat = \"0.00%\"\n        If Lift_Metcon = \"Metcon\" Then .Range(.Cells(5, ecol), .Cells(100, ecol)).NumberFormat = \"0.0\"\n\n        'Create new worksheet with formatting\n        With Sheets.Add(After:=Sheets(Sheets.Count)) '&lt;--| this will make the new sheet the \"Active\" one\n            .Name = NewLift\n            .Range(\"A2\") = \"Name\"\n            .Range(\"A1\") = Lift_Metcon\n            .Range(\"A1\").Font.Color = RGB(166, 166, 166)\n            .Range(\"A2:B2\").Font.Bold = True\n            .Range(\"A:A\").ColumnWidth = 27\n            .Range(\"A1:BZ2\").Interior.Color = RGB(166, 166, 166)\n            .Range(\"A1\").RowHeight = 55\n            .Range(\"B2\") = \"M/F\"\n            .Columns(\"C\").Select\n            ActiveWindow.FreezePanes = True\n\n            For Each cell In .Range(\"A3:BZ100\") ''change range accordingly\n                If cell.Row Mod 2 = 1 Then ''highlights row 2,4,6 etc|= 0 highlights 1,3,5\n                    cell.Interior.Color = RGB(217, 217, 217) ''color to preference\n                Else\n                    cell.Interior.ColorIndex = xlNone ''color to preference or remove\n                End If\n            Next cell\n            SheetCodeName = .CodeName\n\n        End With\n        .Activate '&lt;--| jump back to referenced (i.e.: \"Main\") sheet and make it active again\n\n        'Calls the CreateButton subroutine and passes the NewLift from user, last empty column and SheetCodeName (i.e. Sheet5)\n        CreateButton NewLift, ecol, SheetCodeName\n\n    End With\n    Worksheets(\"Records\").Cells(Rows.Count, 1).End(xlUp).Offset(1).Value = NewLift\n\nerrHandler:\n    Application.ScreenUpdating = True\n\nEnd Sub\n\n\n\nSub CreateButton(NewLift As String, ecol As Integer, SheetCodeName As String)\n    Dim Code As String\n    Dim NewLiftSpace As String\n\n    NewLiftSpace = Replace(NewLift, \" \", \"_\")\n    SheetCodeName = Worksheets(NewLift).CodeName\n\n    With ActiveSheet.Buttons.Add(Cells(2, ecol + 1).Left, Cells(2, ecol + 1).Top, 45, 45) '&lt;--| reference a new button on active sheet\n        .Characters.Text = \"Log\" &amp; vbCrLf &amp; \"History\"\n        .OnAction = SheetCodeName &amp; \".\" &amp; NewLiftSpace &amp; \"_Button\"\n    End With\n\n    'subroutine macro text\n    Code = \"Public Sub \" &amp; NewLiftSpace &amp; \"_Button()\" &amp; vbCrLf\n    Code = Code &amp; \"Dim LiftSheet As String\" &amp; vbCrLf\n    Code = Code &amp; \"LiftSheet = \" &amp; \"\"\"\" &amp; NewLift &amp; \"\"\"\" &amp; vbCrLf\n    Code = Code &amp; \"Call History.Log_History(LiftSheet)\" &amp; vbCrLf\n    Code = Code &amp; \"End Sub\" &amp; vbCrLf\n    Code = Code &amp; \"Public Sub CommandButton1_Click()\" &amp; vbCrLf\n    Code = Code &amp; \"UserForm1.Show\" &amp; vbCrLf\n    Code = Code &amp; \"Athlete_Chart(Athlete)\" &amp; vbCrLf\n    Code = Code &amp; \"End Sub\"\n\n    'add macro at the end of the sheet module\n    With ActiveWorkbook.VBProject.VBComponents(SheetCodeName).CodeModule '&lt;--| reference your new sheet 'CodeName'\n        .InsertLines .CountOfLines + 1, Code\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>where I deliberatley choose to leave that:</p>\n\n<pre><code>.Activate '&lt;--| jump back to referenced (i.e.: \"Main\") sheet and make it active again\n</code></pre>\n\n<p>because I intended you needed to leave the user with \"Main\" sheet as the active one</p>\n\n<p>so I also exploited it to leave <code>ActiveSheet</code> reference in CreateButton() to implicitly refer to \"Main\" sheet instead of changing Sub <em>signature</em> adding a new argument (a reference to \"Main\" sheet or its name) to use and reference \"Main\" sheet also</p>\n"}], "owner": {"reputation": 31, "user_id": 7402343, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xfCVQm5V4pE/AAAAAAAAAAI/AAAAAAAADak/NiCQrMYKr8Q/photo.jpg?sz=128", "display_name": "MButler", "link": "https://stackoverflow.com/users/7402343/mbutler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 651, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1529250965, "creation_date": 1484104327, "last_edit_date": 1592644375, "question_id": 41582083, "link": "https://stackoverflow.com/questions/41582083/onaction-runtime-error-1004-on-initial-run", "title": "OnAction Runtime Error &quot;1004&quot; on initial run", "body": "<p>Background:  I have a workbook that logs Olympic lift weights/history.  The user is able to create new lifts by pressing a button (Add New Lift) which calls a macro &quot;New_Lift&quot; and &quot;Create_Button&quot;.  This will create a new worksheet with lift name, create a new column on the main sheet with the lift's name, add a button (main sheet) called &quot;Log History&quot; (OnAction = new worksheet sub).</p>\n<p>The new worksheet, columns, and button are created fine, but receive a runtime error &quot;1004&quot; when the macro is run for the first time after opening the workbook (works fine thereafter).  The error points to the '.OnAction' of the button.  Below is a screenshot of the main sheet and the &quot;Create_Button&quot; code.  Any help is greatly appreciated and please let me know if I need to clarify anything.</p>\n<h3>Workbook Screenshot</h3>\n<p><img src=\"https://i.stack.imgur.com/r3PU6.png\" alt=\"Workbook Screenshot\" /></p>\n<pre><code>Sub Add_New_Lift()\n\n'*****************************************************************************************************\n' This macro creates a new columns that contains the lift name, &quot;Current&quot;, &quot;Goal&quot;, &quot;% Goal&quot; and formulas\n'*****************************************************************************************************\nDim ecol As Integer\nDim erow As Integer\nDim NewLift As String\nDim Lift_Metcon As String\nDim SheetCodeName As String\n\nApplication.ScreenUpdating = False\n\n'Ask user to provide the name of the lift through a message box\nNewLift = InputBox(&quot;New Lift Name:&quot;, &quot;Add New Lift&quot;)\n\nIf StrPtr(NewLift) = 0 Then\n    Exit Sub\nElse\n    Do\n    Lift_Metcon = InputBox(&quot;Is this a Lift (Weight), Metcon (Time), or AMRAP (Total Reps):&quot; &amp; _\n                    vbCrLf &amp; vbTab &amp; &quot;-   Lift&quot; &amp; _\n                    vbCrLf &amp; vbTab &amp; &quot;-   Metcon&quot; &amp; _\n                    vbCrLf &amp; vbTab &amp; &quot;-   AMRAP&quot; _\n                    , &quot;Type of Measurement&quot;)\n        \n    If StrPtr(Lift_Metcon) = 0 Then\n        Exit Sub\n    ElseIf (Lift_Metcon = &quot;Lift&quot;) Or (Lift_Metcon = &quot;Metcon&quot;) Or (Lift_Metcon = &quot;AMRAP&quot;) Then\n        Exit Do\n    Else\n        MsgBox &quot;You have not made a valid entry.  Please try again.&quot;\n    End If\n    Loop\nEnd If\n\n'Find first empty column to add the new lift and formatting as well as Column letters for use with formula\necol = Worksheets(&quot;Main&quot;).Cells(4, Columns.Count).End(xlToLeft).Offset(0, 1).Column\nColNo1 = ecol\nColLet1 = Split(Cells(, ColNo1).Address, &quot;$&quot;)(1)\nColNo2 = ecol + 1\nColLet2 = Split(Cells(, ColNo2).Address, &quot;$&quot;)(1)\nColNo3 = ecol + 2\nColLet3 = Split(Cells(, ColNo3).Address, &quot;$&quot;)(1)\n\n\n'Formatting\n    Worksheets(&quot;Main&quot;).Activate\n    Columns(ecol).Select\n    Selection.Borders(xlEdgeLeft).LineStyle = xlContinuous\n    Selection.Borders(xlEdgeLeft).Weight = xlMedium\n    Range(Cells(3, ecol), Cells(3, ecol + 2)).Merge\n    Cells(3, ecol) = NewLift\n    Cells(3, ecol).Font.Size = 16\n    Cells(4, ecol) = &quot;Current&quot;\n    Cells(4, ecol + 1) = &quot;Goal&quot;\n    Cells(4, ecol + 2) = &quot;% Goal&quot;\n    Range(Cells(3, ecol), Cells(4, ecol + 2)).HorizontalAlignment = xlCenter\n    Range(Cells(3, ecol), Cells(4, ecol + 2)).Font.Bold = True\n    Range(Cells(3, ecol), Cells(4, ecol + 2)).ColumnWidth = 8\n    Range(Cells(1, ecol), Cells(4, ecol + 2)).Interior.Color = RGB(166, 166, 166)\n    Range(Cells(5, ecol + 2), Cells(100, ecol + 2)).Formula = &quot;=IF(&quot; &amp; ColLet1 &amp; &quot;5&lt;&gt; &quot;&quot;&quot;&quot;, &quot; &amp; ColLet1 &amp; &quot;5/&quot; &amp; ColLet2 &amp; &quot;5,&quot;&quot;&quot;&quot; )&quot;\n    Range(Cells(5, ecol + 2), Cells(100, ecol + 2)).NumberFormat = &quot;0.00%&quot;\n    \n    If Lift_Metcon = &quot;Metcon&quot; Then\n        Range(Cells(5, ecol), Cells(100, ecol)).NumberFormat = &quot;0.0&quot;\n    End If\n\n'Create new worksheet with formatting\nSheets.Add(After:=Sheets(Sheets.Count)).Name = NewLift\nSheets(NewLift).Range(&quot;A2&quot;) = &quot;Name&quot;\nSheets(NewLift).Range(&quot;A1&quot;) = Lift_Metcon\nSheets(NewLift).Range(&quot;A1&quot;).Font.Color = RGB(166, 166, 166)\nSheets(NewLift).Range(&quot;A2:B2&quot;).Font.Bold = True\nSheets(NewLift).Range(&quot;A:A&quot;).ColumnWidth = 27\nSheets(NewLift).Range(&quot;A1:BZ2&quot;).Interior.Color = RGB(166, 166, 166)\nSheets(NewLift).Range(&quot;A1&quot;).RowHeight = 55\nSheets(NewLift).Range(&quot;B2&quot;) = &quot;M/F&quot;\nSheets(NewLift).Columns(&quot;C&quot;).Select\nActiveWindow.FreezePanes = True\nSheets(NewLift).Range(&quot;A3&quot;).Select\n\nFor Each Cell In Range(&quot;A3:BZ100&quot;) ''change range accordingly\nIf Cell.Row Mod 2 = 1 Then ''highlights row 2,4,6 etc|= 0 highlights 1,3,5\n    Cell.Interior.Color = RGB(217, 217, 217) ''color to preference\nElse\n    Cell.Interior.ColorIndex = xlNone ''color to preference or remove\nEnd If\nNext Cell\n\nSheetCodeName = ActiveSheet.CodeName\n\n'Calls the CreateButton subroutine and passes the NewLift from user, last empty column and SheetCodeName (i.e. Sheet5)\nCall CreateButton(NewLift, ecol, SheetCodeName)\n\nWorksheets(&quot;Records&quot;).Activate\nerow = Worksheets(&quot;Records&quot;).Cells(Rows.Count, 1).End(xlUp).Offset(1).Row\nCells(erow, 1) = NewLift\n\nWorksheets(&quot;Main&quot;).Activate\nRange(&quot;A5&quot;).Select\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n\n\n\nSub CreateButton(NewLift As String, ecol As Integer, SheetCodeName As String)\nDim Code As String\nDim NewLiftSpace As String\n\nNewLiftSpace = Replace(NewLift, &quot; &quot;, &quot;_&quot;)\nSheetCodeName = Worksheets(NewLift).CodeName\n\nWith ActiveSheet 'Main Sheet\n    .Buttons.Add(Cells(2, ecol + 1).Left, Cells(2, ecol + 1).Top, 45, 45).Select\n    Selection.Characters.Text = &quot;Log&quot; &amp; vbCrLf &amp; &quot;History&quot;\n    Selection.OnAction = SheetCodeName &amp; &quot;.&quot; &amp; NewLiftSpace &amp; &quot;_Button&quot;\nEnd With\n\n'subroutine macro text\nCode = &quot;Public Sub &quot; &amp; NewLiftSpace &amp; &quot;_Button()&quot; &amp; vbCrLf\nCode = Code &amp; &quot;Dim LiftSheet As String&quot; &amp; vbCrLf\nCode = Code &amp; &quot;LiftSheet = &quot; &amp; &quot;&quot;&quot;&quot; &amp; NewLift &amp; &quot;&quot;&quot;&quot; &amp; vbCrLf\nCode = Code &amp; &quot;Call History.Log_History(LiftSheet)&quot; &amp; vbCrLf\nCode = Code &amp; &quot;End Sub&quot; &amp; vbCrLf\nCode = Code &amp; &quot;Public Sub CommandButton1_Click()&quot; &amp; vbCrLf\nCode = Code &amp; &quot;UserForm1.Show&quot; &amp; vbCrLf\nCode = Code &amp; &quot;Athlete_Chart(Athlete)&quot; &amp; vbCrLf\nCode = Code &amp; &quot;End Sub&quot;\n\n\n'add macro at the end of the sheet module\nWith ActiveWorkbook.VBProject.VBComponents(ActiveSheet.CodeName).CodeModule\n    .InsertLines .CountOfLines + 1, Code\nEnd With\n\nEnd Sub\n</code></pre>\n<p><strong>EDIT:</strong> Code runs without errors if the VBA editor is open.</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 1, "user_id": 7398690, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0ab275ccd4fecba1309c4f3f388a9165?s=128&d=identicon&r=PG&f=1", "display_name": "Pao", "link": "https://stackoverflow.com/users/7398690/pao"}, "edited": false, "score": 0, "creation_date": 1484103522, "post_id": 41581967, "comment_id": 70368605, "body": "*Not other files. Just in other excel files"}], "answers": [{"comments": [{"owner": {"reputation": 1230, "user_id": 4064372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/225de4472e4e944d85254f42f778d20d?s=128&d=identicon&r=PG&f=1", "display_name": "Edd", "link": "https://stackoverflow.com/users/4064372/edd"}, "edited": false, "score": 0, "creation_date": 1490194313, "post_id": 42954693, "comment_id": 73004921, "body": "Can you clarify what you mean by &quot;misunderstand your code&quot; please?"}, {"owner": {"reputation": 1, "user_id": 7751949, "user_type": "registered", "profile_image": "https://graph.facebook.com/1681492785210428/picture?type=large", "display_name": "Felipe Mazzaro", "link": "https://stackoverflow.com/users/7751949/felipe-mazzaro"}, "reply_to_user": {"reputation": 1230, "user_id": 4064372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/225de4472e4e944d85254f42f778d20d?s=128&d=identicon&r=PG&f=1", "display_name": "Edd", "link": "https://stackoverflow.com/users/4064372/edd"}, "edited": false, "score": 0, "creation_date": 1490288829, "post_id": 42954693, "comment_id": 73057236, "body": "For exemple, supose you have a workbook called Felipe.xlsm, and you are using userforms on this Workbook. And on the Userform, you will get an information on the cell &quot;A1&quot;, which is a number. Therefore, you can use the code:  Label1.Caption = Range(&quot;A1&quot;)  Ok?  On this code, the userform will get the information inside the Workbook that is active. Thus, if you let ShowModal as False, and start using another file called &quot;Edd.xlsm&quot;. And the information inside the cell &quot;A1&quot; is your own name. If you let this Workbook active, the userform will get the information of this Workbook!"}, {"owner": {"reputation": 1, "user_id": 7751949, "user_type": "registered", "profile_image": "https://graph.facebook.com/1681492785210428/picture?type=large", "display_name": "Felipe Mazzaro", "link": "https://stackoverflow.com/users/7751949/felipe-mazzaro"}, "reply_to_user": {"reputation": 1230, "user_id": 4064372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/225de4472e4e944d85254f42f778d20d?s=128&d=identicon&r=PG&f=1", "display_name": "Edd", "link": "https://stackoverflow.com/users/4064372/edd"}, "edited": false, "score": 0, "creation_date": 1490289065, "post_id": 42954693, "comment_id": 73057389, "body": "So, try always use the complete address of the information you want to get, like:  Label1.Caption = workbooks(&quot;Felipe.xlsm&quot;).Sheets(&quot;Plan 1&quot;).Range(&quot;A1&quot;)  This way, the code wont get from another Workbooks, but only on the one that you specified."}], "tags": [], "owner": {"reputation": 1, "user_id": 7751949, "user_type": "registered", "profile_image": "https://graph.facebook.com/1681492785210428/picture?type=large", "display_name": "Felipe Mazzaro", "link": "https://stackoverflow.com/users/7751949/felipe-mazzaro"}, "is_accepted": false, "score": 0, "last_activity_date": 1490203265, "last_edit_date": 1490203265, "creation_date": 1490193283, "answer_id": 42954693, "question_id": 41581967, "link": "https://stackoverflow.com/questions/41581967/userform-alttab-in-vba-excel/42954693#42954693", "title": "Userform Alt+tab in VBA Excel", "body": "<p>On the userform properties, there is an option called \"ShowModal\". If you set it with the value \"False\", then you can use other UserForms or WorkBooks. </p>\n\n<p>Just be careful, if you didn't index the WorkBook and WorkSheet that you are working on (in the Userform), the events on the Userform can misunderstand your code.</p>\n"}], "owner": {"reputation": 1, "user_id": 7398690, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0ab275ccd4fecba1309c4f3f388a9165?s=128&d=identicon&r=PG&f=1", "display_name": "Pao", "link": "https://stackoverflow.com/users/7398690/pao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 650, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538121807, "creation_date": 1484103385, "last_edit_date": 1538121807, "question_id": 41581967, "link": "https://stackoverflow.com/questions/41581967/userform-alttab-in-vba-excel", "title": "Userform Alt+tab in VBA Excel", "body": "<p>How can I activate the <kbd>alt</kbd>+<kbd>tab</kbd>? <br>\nWhen my userform is open, I can't <kbd>alt</kbd>-<kbd>tab</kbd> with other files <em>(documents/internet/etc)</em>. Is there any code to this or configuration?</p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1744, "user_id": 1191147, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/cZDaT.jpg?s=128&g=1", "display_name": "Hashim Aziz", "link": "https://stackoverflow.com/users/1191147/hashim-aziz"}, "edited": false, "score": 0, "creation_date": 1484108869, "post_id": 41582017, "comment_id": 70369909, "body": "How would I call this? Sorry, today was the first time I used Excel, picking it up as I go along. :-)"}, {"owner": {"reputation": 1744, "user_id": 1191147, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/cZDaT.jpg?s=128&g=1", "display_name": "Hashim Aziz", "link": "https://stackoverflow.com/users/1191147/hashim-aziz"}, "edited": false, "score": 0, "creation_date": 1484110662, "post_id": 41582017, "comment_id": 70370435, "body": "Okay, I tried calling it with <code>=MissingSequence(A1:A23400)</code> the first time, which failed with an error. Then I added <code>Public</code> before <code>Function</code>, and that seemed to do the trick - something was definitely running while minimising and maximising the window, and it did that for about 20-30 seconds. I&#39;d really appreciate some sort of confirmation that it ran successfully, especially since I&#39;m unsure whether this dataset has any missing numbers in it."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1744, "user_id": 1191147, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/cZDaT.jpg?s=128&g=1", "display_name": "Hashim Aziz", "link": "https://stackoverflow.com/users/1191147/hashim-aziz"}, "edited": false, "score": 1, "creation_date": 1484143049, "post_id": 41582017, "comment_id": 70388642, "body": "@Hashim - for confirmation use a <code>debug.print MissingSequence</code> to print results to the Immediate Window in the VBE. Also, make sure you pass an actual range <code>A1:A23400</code> is a string literal. I think you will need <code>Range(A1:A23400)</code>."}, {"owner": {"reputation": 1744, "user_id": 1191147, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/cZDaT.jpg?s=128&g=1", "display_name": "Hashim Aziz", "link": "https://stackoverflow.com/users/1191147/hashim-aziz"}, "edited": false, "score": 0, "creation_date": 1484256503, "post_id": 41582017, "comment_id": 70448045, "body": "Do you mean use a <code>debug.print</code> when calling the function? Also, what would using the Range look like in code? Where would I place it?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1744, "user_id": 1191147, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/cZDaT.jpg?s=128&g=1", "display_name": "Hashim Aziz", "link": "https://stackoverflow.com/users/1191147/hashim-aziz"}, "edited": false, "score": 0, "creation_date": 1484324462, "post_id": 41582017, "comment_id": 70477717, "body": "@Hashim - <code>sMyString = MissingSequence(Range(&quot;A1:A23400&quot;))</code>.. then debug.print <code>sMyString</code>. Place this is a separate procedure then run."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1484104112, "last_edit_date": 1484104112, "creation_date": 1484103806, "answer_id": 41582017, "question_id": 41581877, "link": "https://stackoverflow.com/questions/41581877/how-to-highlight-and-list-missing-values-in-a-letter-number-sequence/41582017#41582017", "title": "How to highlight and list missing values in a letter-number sequence", "body": "<p>There's perhaps more speedy way to do this ... but this is tested and produced results on a small sample.</p>\n\n<pre><code>Function MissingSequence(Rng As Range) As String\n\nDim iCnt As Integer\nFor iCnt = 65 To 90 'ASCI characters for alphabet A-Z\n\n    Dim iNum As Integer\n    For iNum = 100 To 999\n\n        Dim sCheck As String\n        sCheck = Chr(iCnt) &amp; iNum            \n\n        If Rng.Find(sCheck, lookat:=xlWhole) Is Nothing Then\n\n            Dim sMissingNumbers As String\n            sMissingNumbers = sMissingNumbers &amp; \",\" &amp; sCheck\n\n        End If\n\n    Next\n\nNext\n\n  MissingSequence = Mid(sMissingNumbers, 2)\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1744, "user_id": 1191147, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/cZDaT.jpg?s=128&g=1", "display_name": "Hashim Aziz", "link": "https://stackoverflow.com/users/1191147/hashim-aziz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 41582017, "answer_count": 1, "score": 0, "last_activity_date": 1484104112, "creation_date": 1484102795, "last_edit_date": 1531161705, "question_id": 41581877, "link": "https://stackoverflow.com/questions/41581877/how-to-highlight-and-list-missing-values-in-a-letter-number-sequence", "title": "How to highlight and list missing values in a letter-number sequence", "body": "<p>I'm using Excel 2010. I have a column of data that contains four-digit sequences. These sequences consist of and iterate through a number of the alphabet followed by a number from 100-999. So A100, A101, A102... A999, then B100, B101... all the way up until Z999. There are 24,000 of these sequences (i.e. rows). </p>\n\n<p>I first tried the following VBA script:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function MissingNumbers(Rng As Range) As String\nDim X As Long, MaxNum As Long\nMaxNum = WorksheetFunction.Max(Rng)\nReDim Nums(1 To MaxNum)\nFor X = 1 To MaxNum\n   If Rng.Find(X, LookAt:=xlWhole) Is Nothing Then\n      MissingNumbers = MissingNumbers &amp; \", \" &amp; X\n   End If\n  Next\n  MissingNumbers = Mid(MissingNumbers, 3)\nEnd Function\n</code></pre>\n\n<p>...but I ran into an error when calling it with <code>=MissingNumbers(A1:A23400)</code>, which I'm guessing is because the function can't parse the alphabetic letters at the beginning of the sequences.</p>\n\n<p><strong>My question: what formula can I use to <em>both highlight and separately list</em> missing values in my first column?</strong> </p>\n\n<p>For extra clarification, missing values in the range</p>\n\n<pre><code>C996\nC998\nC999\nD101\n</code></pre>\n\n<p>...would be... </p>\n\n<pre><code>C996\n*C997*\nC998\nC999\n*D100*\nD101\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1484100262, "post_id": 41581543, "comment_id": 70367836, "body": "Gather your list of filenames first, <i>then</i> start the loop. <code>*.xls</code> matches the Excel lock files (<code>~file.xls</code>). If you turn of error handling anywhere, don&#39;t."}, {"owner": {"reputation": 95, "user_id": 7376921, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/74660847ad790c9a48e3622dfbcdd253?s=128&d=identicon&r=PG&f=1", "display_name": "studiis", "link": "https://stackoverflow.com/users/7376921/studiis"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1484100561, "post_id": 41581543, "comment_id": 70367894, "body": "@Comintern does that mean just moving one line (&quot;Set wb = Workbooks.Open...&quot;)  to before &quot;Do While&quot;? I think that&#39;s the only code that gathers filenames after the loop starts."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1484100645, "post_id": 41581543, "comment_id": 70367908, "body": "No, that would only open the first workbook.  Make 2 loops - one to create an array of filenames, the second iterating over that array and opening\\processing them."}, {"owner": {"reputation": 95, "user_id": 7376921, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/74660847ad790c9a48e3622dfbcdd253?s=128&d=identicon&r=PG&f=1", "display_name": "studiis", "link": "https://stackoverflow.com/users/7376921/studiis"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1484100880, "post_id": 41581543, "comment_id": 70367965, "body": "@Comintern I&#39;m not so sure how to do that. In answers below, could you post what you have in mind?"}, {"owner": {"reputation": 166, "user_id": 5602275, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P12Y0DA5eRQ/AAAAAAAAAAI/AAAAAAAABH0/TUP_IYlksMs/photo.jpg?sz=128", "display_name": "Michael", "link": "https://stackoverflow.com/users/5602275/michael"}, "edited": false, "score": 2, "creation_date": 1484102744, "post_id": 41581543, "comment_id": 70368401, "body": "Do all your excel files end exactly like .xls? Are none of them .xlsx? I don&#39;t see anything wrong with how you are looping through the files in the folder you enter other than the fact that I don&#39;t see where you increment n. Provide the entire macro and I will see if I spot anything wrong."}, {"owner": {"reputation": 499, "user_id": 7160536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b7c2e2c668ace472a1b0abc47f4421?s=128&d=identicon&r=PG&f=1", "display_name": "ClintB", "link": "https://stackoverflow.com/users/7160536/clintb"}, "edited": false, "score": 0, "creation_date": 1484104211, "post_id": 41581543, "comment_id": 70368772, "body": "As Michael mentions try changing <code>Dir(folderPath &amp; &quot;*.xls&quot;)</code> to <code>Dir(folderPath &amp; &quot;*.xls*&quot;)</code> this should help it find xlsx and xlsm files as well."}, {"owner": {"reputation": 95, "user_id": 7376921, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/74660847ad790c9a48e3622dfbcdd253?s=128&d=identicon&r=PG&f=1", "display_name": "studiis", "link": "https://stackoverflow.com/users/7376921/studiis"}, "reply_to_user": {"reputation": 166, "user_id": 5602275, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P12Y0DA5eRQ/AAAAAAAAAAI/AAAAAAAABH0/TUP_IYlksMs/photo.jpg?sz=128", "display_name": "Michael", "link": "https://stackoverflow.com/users/5602275/michael"}, "edited": false, "score": 0, "creation_date": 1484145710, "post_id": 41581543, "comment_id": 70390385, "body": "@Michael all the files are Excel 1997-2003 workbooks, which I believe is .xls   And when I changed it to &quot;<i>.xls</i>&quot; from &quot;*.xls&quot; I got a &quot;subscript out of range error&quot;"}, {"owner": {"reputation": 95, "user_id": 7376921, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/74660847ad790c9a48e3622dfbcdd253?s=128&d=identicon&r=PG&f=1", "display_name": "studiis", "link": "https://stackoverflow.com/users/7376921/studiis"}, "reply_to_user": {"reputation": 166, "user_id": 5602275, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P12Y0DA5eRQ/AAAAAAAAAAI/AAAAAAAABH0/TUP_IYlksMs/photo.jpg?sz=128", "display_name": "Michael", "link": "https://stackoverflow.com/users/5602275/michael"}, "edited": false, "score": 0, "creation_date": 1484145790, "post_id": 41581543, "comment_id": 70390430, "body": "@Michael actually the error must be from something else"}, {"owner": {"reputation": 95, "user_id": 7376921, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/74660847ad790c9a48e3622dfbcdd253?s=128&d=identicon&r=PG&f=1", "display_name": "studiis", "link": "https://stackoverflow.com/users/7376921/studiis"}, "edited": false, "score": 0, "creation_date": 1484147189, "post_id": 41581543, "comment_id": 70391419, "body": "I added the macro."}], "answers": [{"tags": [], "owner": {"reputation": 166, "user_id": 5602275, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P12Y0DA5eRQ/AAAAAAAAAAI/AAAAAAAABH0/TUP_IYlksMs/photo.jpg?sz=128", "display_name": "Michael", "link": "https://stackoverflow.com/users/5602275/michael"}, "is_accepted": false, "score": 0, "last_activity_date": 1484443491, "creation_date": 1484443491, "answer_id": 41656878, "question_id": 41581543, "link": "https://stackoverflow.com/questions/41581543/how-to-run-macro-on-all-files-in-a-folder/41656878#41656878", "title": "How to run macro on all files in a folder?", "body": "<p>You should and clean up your code by providing which worksheet you are working on.</p>\n\n<pre><code>set ws = wb.Sheets(1)\nwith ws\n    For Each curr In .Range(\"A\" &amp; i, \"Z\" &amp; i)\n        If InStr(1, curr.Value, \"Protein name\", vbTextCompare) &gt; 0 Or InStr(1, curr.Value, \"description\", vbTextCompare) &gt; 0 Or InStr(1, curr.Value, \"Common name\", vbTextCompare) &gt; 0 Then\n            .Range(curr.Offset(1), .Cells(.Rows.Count, curr.Column).End(xlUp)).Copy Destination:=Workbooks(\"ExtractedColumns (version 2)\").Sheets(\"Sheet1\").Cells(Rows.Count, \"D\").End(xlUp).Offset(1, 0)\n            found = True\n            Exit For\n        End If\n    Next\nend with\n</code></pre>\n\n<p>I would never use ActiveSheet.</p>\n\n<pre><code>n = ActiveSheet.UsedRange.Rows(ActiveSheet.UsedRange.Rows.Count).Row\n</code></pre>\n\n<p>Try this instead</p>\n\n<pre><code>lastRow = ws.Cells(ws.Rows.Count,\"D\").End(xlUp).Row\n</code></pre>\n\n<p>I hope this help. I can't really test it on my machine since I don't have Excel installed.</p>\n"}], "owner": {"reputation": 95, "user_id": 7376921, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/74660847ad790c9a48e3622dfbcdd253?s=128&d=identicon&r=PG&f=1", "display_name": "studiis", "link": "https://stackoverflow.com/users/7376921/studiis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3469, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1555598880, "creation_date": 1484099959, "last_edit_date": 1555598880, "question_id": 41581543, "link": "https://stackoverflow.com/questions/41581543/how-to-run-macro-on-all-files-in-a-folder", "title": "How to run macro on all files in a folder?", "body": "<p>I'm writing a macro that will run on all Excel files in a folder and copy columns with certain headers then paste then to a new sheet titled \"ExtractedColumns\").</p>\n\n<p>I ran this macro on a small folder (four Workbooks) and successfully got the data onto the ExtractedColumns sheet.</p>\n\n<p>When I ran the macro on a folder with 60 files (which included the four files from my successful sample set), it skipped some workbooks and seems to have wrapped around itself. The last file's extracted columns appear at the beginning, and columns from the first few files (including the sample ones that ran successfully earlier) didn't appear. </p>\n\n<p>I'm thinking the problem is the code iterating through the folder.</p>\n\n<pre><code>Sub AllFiles()\nDim folderPath As String\nDim filename As String\nDim wb As Workbook\n\nfolderPath = 'I put the path name here\n\nIf Right(folderPath, 1) &lt;&gt; \"\\\" Then folderPath = folderPath + \"\\\"\n\nfilename = Dir(folderPath &amp; \"*.xls\")\nDo While filename &lt;&gt; \"\"\n    Application.ScreenUpdating = False\n    Set wb = Workbooks.Open(folderPath &amp; filename)\n\n    'Macro from below goes here\n\n    Workbooks(\"ExtractedColumns\").Worksheets(\"Sheet1\").Cells(n, 1).Value = filename\n    wb.Close\n    filename = Dir\nLoop\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Here's the complete macro:</p>\n\n<pre><code>Dim curr As Range\nDim cell As Range\nDim lastRow As Variant\nDim n As Long\nDim found As Boolean\nDim FirstRow As Range\n\nfound = False\n\nFor i = 3 To 30\n    If Not IsEmpty(Cells(i, \"C\")) Then\n        Exit For\n    End If\nNext\n\nFor Each curr In Range(\"A\" &amp; i, \"Z\" &amp; i)\n    If InStr(1, curr.Value, \"Protein name\", vbTextCompare) &gt; 0 Or InStr(1, curr.Value, \"description\", vbTextCompare) &gt; 0 Or InStr(1, curr.Value, \"Common name\", vbTextCompare) &gt; 0 Then\n        Range(curr.Offset(1), Cells(Rows.Count, curr.Column).End(xlUp)).Copy Destination:=Workbooks(\"ExtractedColumns (version 2)\").Sheets(\"Sheet1\").Cells(Rows.Count, \"D\").End(xlUp).Offset(1, 0)\n        found = True\n        Exit For\n    End If\nNext\n\nIf Not found Then\n    For Each curr In Range(\"A\" &amp; i, \"Z\" &amp; i)\n        If InStr(1, curr.Value, \"protein\", vbTextCompare) &gt; 0 Then\n            Range(curr.Offset(1), Cells(Rows.Count, curr.Column).End(xlUp)).Copy Destination:=Workbooks(\"ExtractedColumns\").Sheets(\"Sheet1\").Cells(Rows.Count, \"D\").End(xlUp).Offset(1, 0)\n            Exit For\n        End If\n    Next              \nEnd If\n\nFor Each curr In Range(\"A\" &amp; i, \"Z\" &amp; i)\n    If InStr(1, curr.Value, \"accession\", vbTextCompare) &gt; 0 Or InStr(1, curr.Value, \"Uniprot\", vbTextCompare) &gt; 0 Or InStr(1, curr.Value, \"IPI\") &gt; 0 Then\n        Range(curr.Offset(1), Cells(Rows.Count, curr.Column).End(xlUp)).Copy Destination:=Workbooks(\"ExtractedColumns\").Sheets(\"Sheet1\").Cells(Rows.Count, \"E\").End(xlUp).Offset(1, 0)\n        found = True\n        Exit For\n    End If\nNext\n\nFor Each curr In Range(\"A\" &amp; i, \"Z\" &amp; i)\n    If (InStr(1, curr.Value, \"residue\", vbTextCompare) &gt; 0 Or curr.Value = \"Position\" Or curr.Value = \"Positions\" Or InStr(1, curr.Value, \"Site\", vbTextCompare) &gt; 0) And Not InStr(1, curr.Value, \"ERK\") &gt; 0 Then\n        Range(curr.Offset(1), Cells(Rows.Count, curr.Column).End(xlUp)).Copy Destination:=Workbooks(\"ExtractedColumns\").Sheets(\"Sheet1\").Cells(Rows.Count, \"G\").End(xlUp).Offset(1, 0)\n        Exit For\n    End If\nNext\n\n'puts dashes in any blank cells in the columns\nn = ActiveSheet.UsedRange.Rows(ActiveSheet.UsedRange.Rows.Count).Row\nFor Each curr In Workbooks(\"ExtractedColumns\").Sheets(\"Sheet1\").Range(\"D2:D\" &amp; n)\n    If curr.Value = \"\" Then curr.Value = \" - \"\nNext\nFor Each curr In Workbooks(\"ExtractedColumns\").Sheets(\"Sheet1\").Range(\"E2:E\" &amp; n)\n    If curr.Value = \"\" Then curr.Value = \" - \"\nNext\nFor Each curr In Workbooks(\"ExtractedColumns\").Sheets(\"Sheet1\").Range(\"G2:G\" &amp; n)\n    If curr.Value = \"\" Then curr.Value = \" - \"\nNext\n</code></pre>\n"}]