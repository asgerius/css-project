[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1442448511, "post_id": 32620289, "comment_id": 53091593, "body": "Would changing colors to help distinguish between columns be enough?"}, {"owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1442448611, "post_id": 32620289, "comment_id": 53091619, "body": "Yes that would do. If I got 10 colours interchanging, then that would be clearly separate them. Thank a lot."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1442449878, "post_id": 32620289, "comment_id": 53091886, "body": "Can you include an image of the data (sample data - to get the visual explanation of how it should work)"}, {"owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1442449964, "post_id": 32620289, "comment_id": 53091905, "body": "Sorry cant upload due to privacy things."}], "answers": [{"comments": [{"owner": {"reputation": 66, "user_id": 2509253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfb56b1251cb5626508fa2c4fb268166?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/2509253/joe"}, "reply_to_user": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "edited": false, "score": 0, "creation_date": 1442456680, "post_id": 32621055, "comment_id": 53093469, "body": "Excellent.  Glad to hear it."}], "tags": [], "owner": {"reputation": 66, "user_id": 2509253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfb56b1251cb5626508fa2c4fb268166?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/2509253/joe"}, "is_accepted": true, "score": 1, "last_activity_date": 1442451723, "creation_date": 1442451723, "answer_id": 32621055, "question_id": 32620289, "link": "https://stackoverflow.com/questions/32620289/use-multiple-highlighting-colours-in-a-code/32621055#32621055", "title": "Use multiple highlighting colours in a code", "body": "<p>I would make your color index as a number, say 33, and add it to be the MOD of subrownumber.  If you want 10 different colors use subrownumber MOD 10, 8 different colors use subrownumber MOD 8, etc.</p>\n\n<p>You'd also have to change your conditional to check for a range of ColorIndex instead of just one value, so you may want to start by setting all colors the same on the sheet (or removing color).  For example, if you start with a ColorIndex of something less than 33, then you could add a subrownubmer MOD 10 to 33 in each loop and never risk breaking the conditional.</p>\n\n<p>So without the underlying data, I haven't run this code, but I would do this:</p>\n\n<pre><code>Sub Button1_Click()\n    Dim rownumber As Integer\n    Dim ColumnC, ColumnF, ColumnC1, ColumnF1 As String\n    Dim ColumnD, ColumnD1 As Single\n    Dim subrownumber As Integer\n    Dim Condition As Boolean\n    rownumber = 1\n    Do\n        ColumnD = Cells(rownumber, 4).Value\n        ColumnC = Cells(rownumber, 3).Value\n        ColumnF = Cells(rownumber, 6).Value\n        Condition = False\n        If (ColumnD &lt; 0) Then\n            subrownumber = 1\n            Do\n                ColumnD1 = Cells(subrownumber, 4).Value\n                ColumnC1 = Cells(subrownumber, 3).Value\n                ColumnF1 = Cells(subrownumber, 6).Value\n                If (ColumnD1 = ColumnD * -1 And ColumnF1 = ColumnF And _\n                    ColumnC1 = ColumnC) And _\n                    Cells(subrownumber, 4).Interior.ColorIndex &lt; 33 And _\n                    Cells(rownumber, 4).Interior.ColorIndex &lt; 33 Then\n                        Cells(subrownumber, 4).Interior.ColorIndex = _\n                            (subrownumber MOD 10) + 33\n                        Cells(subrownumber, 3).Interior.ColorIndex = _\n                            (subrownumber MOD 10) + 33\n                        Cells(subrownumber, 6).Interior.ColorIndex = _\n                            (subrownumber MOD 10) + 33\n                        Cells(rownumber, 4).Interior.ColorIndex = _\n                            (subrownumber MOD 10) + 33\n                        Cells(rownumber, 3).Interior.ColorIndex = _\n                            (subrownumber MOD 10) + 33\n                        Cells(rownumber, 6).Interior.ColorIndex = _\n                            (subrownumber MOD 10) + 33\n                        Condition = True\n                End If\n                subrownumber = subrownumber + 1\n            Loop Until IsEmpty(Cells(subrownumber, 4)) Or Condition = True\n        End If\n        rownumber = rownumber + 1\n    Loop Until IsEmpty(Cells(rownumber, 4))\nEnd Sub\n</code></pre>\n\n<p>This should make sure that you never get a cell with the same color above or below it (unless it is the default color that you begin with).</p>\n"}], "owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 32621055, "answer_count": 1, "score": 0, "last_activity_date": 1442451723, "creation_date": 1442445548, "last_edit_date": 1531164843, "question_id": 32620289, "link": "https://stackoverflow.com/questions/32620289/use-multiple-highlighting-colours-in-a-code", "title": "Use multiple highlighting colours in a code", "body": "<p>I managed to develop a code to highlight cells when there is a condition matching. But all the cells are having the same colour code that makes it difficult to identify. Colour code 37 use here. How Could I change my colour code in between 33-46 (random selection of colours even fine for me.</p>\n\n<pre><code>Sub Button1_Click()\n    Dim rownumber As Integer\n    Dim ColumnC, ColumnF, ColumnC1, ColumnF1 As String\n    Dim ColumnD, ColumnD1 As Single\n    Dim subrownumber As Integer\n    Dim Condition As Boolean\n    rownumber = 1\n    Do\n        ColumnD = Cells(rownumber, 4).Value\n        ColumnC = Cells(rownumber, 3).Value\n        ColumnF = Cells(rownumber, 6).Value\n        Condition = False\n        If (ColumnD &lt; 0) Then\n            subrownumber = 1\n            Do\n                ColumnD1 = Cells(subrownumber, 4).Value\n                ColumnC1 = Cells(subrownumber, 3).Value\n                ColumnF1 = Cells(subrownumber, 6).Value\n                If (ColumnD1 = ColumnD * -1 And ColumnF1 = ColumnF And _\n                    ColumnC1 = ColumnC) And _\n                    Cells(subrownumber, 4).Interior.ColorIndex &lt;&gt; 37 And _\n                    Cells(rownumber, 4).Interior.ColorIndex &lt;&gt; 37 Then\n                        Cells(subrownumber, 4).Interior.ColorIndex = 37\n                        Cells(subrownumber, 3).Interior.ColorIndex = 37\n                        Cells(subrownumber, 6).Interior.ColorIndex = 37\n                        Cells(rownumber, 4).Interior.ColorIndex = 37\n                        Cells(rownumber, 3).Interior.ColorIndex = 37\n                        Cells(rownumber, 6).Interior.ColorIndex = 37\n                        Condition = True\n                End If\n                subrownumber = subrownumber + 1\n            Loop Until IsEmpty(Cells(subrownumber, 4)) Or Condition = True\n        End If\n        rownumber = rownumber + 1\n    Loop Until IsEmpty(Cells(rownumber, 4))\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1442444929, "post_id": 32620178, "comment_id": 53090750, "body": "<code>Set InsertPoint = .cells(1)</code>"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1442445325, "post_id": 32620178, "comment_id": 53090839, "body": "DANG!!!! I find if annoying how sometimes Cells works and other times Range works and it feels like you are doing the same thing.  Thought technically speaking if I use Cells(1), I get sent back to cell A1, but Cells(.row,.column) take me back to the upper left corner of what I had selected.  If you edit your answer I will mark it as accepted...NVM I cant accept a comment 8("}], "answers": [{"comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1442446218, "post_id": 32620310, "comment_id": 53091072, "body": "OK, I totally buy what you are saying, and it makes sense.  however when I run that small little chunk of code with .cells(1) and then do the InsertPoint.select after the &quot;end with&quot; , it takes me to cell A1.  I just re ran it to make sure, and it is still doing it.  However when I change the 1 to .row,.column, when I do the InsertPoint.select, I get the top left corner of what was selected.  I am guessing that this is based on the InsertPoint.select being outside/after the End With."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1442446546, "post_id": 32620310, "comment_id": 53091173, "body": "No that&#39;s not it. Once InsertPoint is set it should stay that way. There must be some anomaly generated by your code. I&#39;ve tried it and it works. See what address(es) is spit back to the Immediate window with the above modifications."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1442447952, "post_id": 32620310, "comment_id": 53091469, "body": "figured it out.  Typo did me over.  I had retype my code instead of cut and paste and I typed set InsertPoint = Cells(1).  I missed the damned period before Cells.  Your code sir does absolutely what you said it would do.  Thank you very much for taking the time to help me with this.  Note to self, .cells is relative address and cells is absolute address."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1442446587, "last_edit_date": 1442446587, "creation_date": 1442445690, "answer_id": 32620310, "question_id": 32620178, "link": "https://stackoverflow.com/questions/32620178/how-to-store-the-location-of-top-left-corner-of-a-selection-box/32620310#32620310", "title": "How to store the location of top left corner of a selection box", "body": "<p>While you are inside the <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With ... End With statement</a>, everything prefaced with a period (aka <code>.</code> or <em>full stop</em>) will be in direct relation to the <code>Selection</code> that the With... end With block references.</p>\n\n<pre><code>With Selection\n    Set InsertPoint = .Cells(1)\n    debug.print InsertPoint.address(0, 0)\n    'do lots of stuff here\nEnd With\n\ndebug.print InsertPoint.address(0, 0)\n</code></pre>\n\n<p>So <code>Cells(1)</code> or <code>Cells(1, 1)</code> will still refer to the worksheet's A1 but inside that block <code>.Cells(1)</code> refers to the cell in the top-left corner of the Selection.</p>\n"}], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 32620310, "answer_count": 1, "score": 0, "last_activity_date": 1442446587, "creation_date": 1442444798, "last_edit_date": 1442446428, "question_id": 32620178, "link": "https://stackoverflow.com/questions/32620178/how-to-store-the-location-of-top-left-corner-of-a-selection-box", "title": "How to store the location of top left corner of a selection box", "body": "<p>I am trying to store the upper left corner of the selected cell(s).  Later the code below selects a lot of different areas and, after executing it, I want to make the selected cell the top left corner of the originally selected cell(s).</p>\n\n<p>I get an error at the line after <code>With Selection</code>:</p>\n\n<pre><code>Private Sub Test()\n\n    Dim InsertPoint As Range\n\n    With Selection\n        Set InsertPoint = Range(.Row, .Column)\n        'insert a bunch of code working with this selection\n    End With\n    'insert a whole wack of code selecting various things\n    InsertPoint.select\nEnd Sub\n</code></pre>\n\n<p>Can someone point me in the right direction/correct my coding please?</p>\n"}, {"tags": ["excel", "vba", "checkbox"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1442444288, "post_id": 32620074, "comment_id": 53090556, "body": "Look into select case statements."}, {"owner": {"reputation": 95, "user_id": 5344302, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/af508996124898d0a86e19c443e0f726?s=128&d=identicon&r=PG&f=1", "display_name": "redcase", "link": "https://stackoverflow.com/users/5344302/redcase"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1442446545, "post_id": 32620074, "comment_id": 53091172, "body": "Thank you @Scott Craner , what might that look like in controlling visibility?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1442447165, "post_id": 32620074, "comment_id": 53091290, "body": "Scott gave you information on what to investigate. Have you tried a Google search for <code>VBA select case</code> as he suggested?"}, {"owner": {"reputation": 95, "user_id": 5344302, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/af508996124898d0a86e19c443e0f726?s=128&d=identicon&r=PG&f=1", "display_name": "redcase", "link": "https://stackoverflow.com/users/5344302/redcase"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1442447874, "post_id": 32620074, "comment_id": 53091453, "body": "@Ken White Yes I did and it is definitely helpful, just could not figure how to create a Select Case statement that selects based off of two Cases. I am going to review Scott&#39;s post below now."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 5344302, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/af508996124898d0a86e19c443e0f726?s=128&d=identicon&r=PG&f=1", "display_name": "redcase", "link": "https://stackoverflow.com/users/5344302/redcase"}, "edited": false, "score": 0, "creation_date": 1442448625, "post_id": 32620563, "comment_id": 53091623, "body": "@Ken White and Scott, I just started using VBA on Monday and have just relied on google till this first post Have any recommendations on resources/books to help me get a comprehensive understanding of VBA? Appreciate any feedback."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 95, "user_id": 5344302, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/af508996124898d0a86e19c443e0f726?s=128&d=identicon&r=PG&f=1", "display_name": "redcase", "link": "https://stackoverflow.com/users/5344302/redcase"}, "edited": false, "score": 0, "creation_date": 1442449214, "post_id": 32620563, "comment_id": 53091745, "body": "@redcase That is a loaded question.  It is very personal, based on how one learns.  Most of my info came from google and trial and error, with a few books thrown in.  there is no one way that works for everyone."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1442447521, "creation_date": 1442447521, "answer_id": 32620563, "question_id": 32620074, "link": "https://stackoverflow.com/questions/32620074/how-do-i-have-one-userform-event-procedure-checkbox-click-control-multiple-if/32620563#32620563", "title": "How do I have one Userform event procedure (checkbox click) control multiple IF THEN statements?", "body": "<p>Currently both if statements will fire.  So if cboIMP.Value = \"1\" then it first runs through the first if statement and unhides the first text box. But it immediately runs the second if statement and because it does not = \"2\" it re hides the text box.</p>\n\n<p>There are two choices a select case statement or else if statements.</p>\n\n<p>Select Case:</p>\n\n<pre><code>If cbIMPLBL.Value = \"True\" Then\n    Select Case cboIMP.Value\n        Case 1\n            'hide/unhide for 1\n        Case 2\n            'hide/unhide for 2\n        Case Else\n            'Hide all\n    End Select\nEnd If\n</code></pre>\n\n<p>Else if</p>\n\n<pre><code>If cbIMPLBL.Value = \"True\" Then\n    if cboIMP.Value = 1 then\n       'do your stuff\n    Else if cboIMP.Value = 2 then\n       'do your stuff\n    Else\n       'hide everything\n    end if\nEnd If\n</code></pre>\n\n<p>This way once the code finds a true it ignores all others.  If it does not find any true statements it runs the else.</p>\n"}], "owner": {"reputation": 95, "user_id": 5344302, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/af508996124898d0a86e19c443e0f726?s=128&d=identicon&r=PG&f=1", "display_name": "redcase", "link": "https://stackoverflow.com/users/5344302/redcase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 32620563, "answer_count": 1, "score": 0, "last_activity_date": 1442447521, "creation_date": 1442444109, "question_id": 32620074, "link": "https://stackoverflow.com/questions/32620074/how-do-i-have-one-userform-event-procedure-checkbox-click-control-multiple-if", "title": "How do I have one Userform event procedure (checkbox click) control multiple IF THEN statements?", "body": "<p>Hey so I am a beginner with VBA but here is my dilemma:</p>\n\n<p>Creating an excel userform with VBA -</p>\n\n<p>I have a combobox with the numbers 1-8, the number of textboxes shown for the user to fill out is based off of the number selected in the combobox.</p>\n\n<p>I also have a checkbox which, when \"TRUE\", enables the user to create a custom title for the output of the textbox.</p>\n\n<hr>\n\n<p>Ex: \nNumber of Goals = <strong>2</strong><br>\n<em>Custom Label Goals? [x] (True</em>)</p>\n\n<p><strong>Goal 1</strong> : $1,000,000<br>\n <em>\"New Home\"</em></p>\n\n<p><strong>Goal 2</strong> : $50,000<br>\n\"Boat\"</p>\n\n<hr>\n\n<p>My issue is that I cannot get the number of custom label boxes to be the same as the number of goals selected. So when Number of goals is 2, 8 custom goal textboxes still show up if the checkbox is TRUE.</p>\n\n<p>I found a way using the code below, but when I enter the second IF THEN statement, the first no longer responds to the clicking the checkbox:</p>\n\n<pre><code>Private Sub cbIMPLBL_Click()\n\nIf cboIMP.Value = \"1\" And cbIMPLBL.Value = \"True\" Then\n   txtIMPLBL1.Visible = True\n   txtIMPLBL2.Visible = False\n   txtIMPLBL3.Visible = False\n   txtIMPLBL4.Visible = False\n   txtIMPLBL5.Visible = False\n   txtIMPLBL6.Visible = False\n   txtIMPLBL7.Visible = False\n   txtIMPLBL8.Visible = False\nElse\n   txtIMPLBL1.Visible = False\n   txtIMPLBL2.Visible = False\n   txtIMPLBL3.Visible = False\n   txtIMPLBL4.Visible = False\n   txtIMPLBL5.Visible = False\n   txtIMPLBL6.Visible = False\n   txtIMPLBL7.Visible = False\n   txtIMPLBL8.Visible = False\nEnd If\n\nIf cboIMP.Value = \"2\" And cbIMPLBL.Value = \"True\" Then\n   txtIMPLBL1.Visible = True\n   txtIMPLBL2.Visible = True\n   txtIMPLBL3.Visible = False\n   txtIMPLBL4.Visible = False\n   txtIMPLBL5.Visible = False\n   txtIMPLBL6.Visible = False\n   txtIMPLBL7.Visible = False\n   txtIMPLBL8.Visible = False\nElse\n   txtIMPLBL1.Visible = False\n   txtIMPLBL2.Visible = False\n   txtIMPLBL3.Visible = False\n   txtIMPLBL4.Visible = False\n   txtIMPLBL5.Visible = False\n   txtIMPLBL6.Visible = False\n   txtIMPLBL7.Visible = False\n   txtIMPLBL8.Visible = False\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Any help here would be greatly appreciated. \nAs I am just beginning is there a different way I am supposed to be doing this, e.g. not writing all of this out individually, but as a control or function (not sure what the term would be) of some sort?</p>\n\n<p>Thank you so much!!!!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1442443277, "post_id": 32619853, "comment_id": 53090269, "body": "Why are you against breaking out the if statement as a function?"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1442443774, "post_id": 32619853, "comment_id": 53090412, "body": "Exactly how you posted it: <code>MsgBox ActiveSheet.Range(&quot;A1&quot;) = &quot;Yes&quot;</code> -&gt; should show False (or True)"}, {"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1442445887, "post_id": 32619853, "comment_id": 53090980, "body": "@findwindow Because it&#39;s an &quot;if true return true else return false&quot; pattern in disguise :}"}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1442443716, "creation_date": 1442443716, "answer_id": 32620010, "question_id": 32619853, "link": "https://stackoverflow.com/questions/32619853/writing-an-expression-containing-the-comparison-operator-as-a-subroutine-arg/32620010#32620010", "title": "Writing an expression containing the comparison operator &quot;=&quot; as a subroutine argument", "body": "<p>Yes it will work. It will be taken as a test, not as an assignment. This is the semantic of the = operator whenever used inside an expression (unlike in C, which has the == operator for disambiguation..)</p>\n"}, {"tags": [], "owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "is_accepted": true, "score": 1, "last_activity_date": 1442466571, "last_edit_date": 1442466571, "creation_date": 1442444949, "answer_id": 32620198, "question_id": 32619853, "link": "https://stackoverflow.com/questions/32619853/writing-an-expression-containing-the-comparison-operator-as-a-subroutine-arg/32620198#32620198", "title": "Writing an expression containing the comparison operator &quot;=&quot; as a subroutine argument", "body": "<p>In VB, <code>=</code> is <em>only</em> an assignment when it appears as the token of an <a href=\"https://msdn.microsoft.com/en-us/library/aa711981(v=vs.71).aspx\" rel=\"nofollow\">AssignmentStatements</a> or in a declaration with an assignment. (The link is for VB.NET, but it applies well-enough to VBA here.) </p>\n\n<p>In all other cases - whenever <code>=</code> appears in an <em>expression</em> (or a sub-expression) - it is always treated as the comparison equality operator and yields a boolean value.</p>\n\n<p>In the post it is found in an <em>expression</em> used as an argument to the function; and as such it will work as desired. Different coding guidelines may prohibit such, but those are irrelevant to the semantics.</p>\n\n<p>These grammar rules also explains why one can't \"chain assignments\" in VB.</p>\n\n<hr>\n\n<p>Thus it works as desired:</p>\n\n<pre><code> dostuff(ActiveSheet.Range(\"A1\") = \"Yes\")\n'[-- function call ---------------------]\n'        [-- expression ---------------]\n'                                ^-- '=' as comparison\n</code></pre>\n\n<p>Another way to write the code, if one didn't like comparisons in arguments:</p>\n\n<pre><code> Dim C as boolean = ActiveSheet.Range(\"A1\") = \"Yes\"\n'[-- declaration with assignment -----------------]\n'                 ^-- '=' for assignment\n'                   [-- expression ---------------]\n'                                           ^-- '=' as comparison\n dostuff(C)\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5313490, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb41bf86b2e9d43dc56b2fdd5898095c?s=128&d=identicon&r=PG&f=1", "display_name": "S Barry", "link": "https://stackoverflow.com/users/5313490/s-barry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 32620198, "answer_count": 2, "score": 1, "last_activity_date": 1442466571, "creation_date": 1442442707, "last_edit_date": 1442446109, "question_id": 32619853, "link": "https://stackoverflow.com/questions/32619853/writing-an-expression-containing-the-comparison-operator-as-a-subroutine-arg", "title": "Writing an expression containing the comparison operator &quot;=&quot; as a subroutine argument", "body": "<p>I have a subroutine in Excel VBA that takes a Boolean value as input.  The Boolean value should be <code>True</code> if the value of a cell is equal to \"Yes\", and <code>False</code> otherwise.</p>\n\n<p>I already know I should be able to do something like this:</p>\n\n<pre><code>Dim C as boolean\nIf ActiveSheet.Range(\"A1\") = \"Yes\" Then\nC = True\nEnd If\ndostuff(C)\n</code></pre>\n\n<p>But I would prefer to be more concise.  I want to do something like this:</p>\n\n<pre><code>dostuff(ActiveSheet.Range(\"A1\")=\"Yes\")\n</code></pre>\n\n<p>I basically want to make sure that the statement is evaluated as a logical expression and not an assignment. </p>\n\n<p>Will this work as it is?<br>\nIf not, what is the best / correct way of doing this without having to use an if statement?</p>\n"}, {"tags": ["arrays", "vba", "dynamic", "ms-word", "do-while"], "comments": [{"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1443650596, "post_id": 32619642, "comment_id": 53584043, "body": "What program are you running this out of? I assumed Word, but then why would you be creating new Word objects if you&#39;re already in Word?"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1443651506, "post_id": 32619642, "comment_id": 53584350, "body": "I get <code>Word encountered an error processing the XML file Document3.docx</code> after using FileCopy in Word 2010 so I can&#39;t tell why your code isn&#39;t working."}, {"owner": {"reputation": 461, "user_id": 4564057, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7bf977a7b05ba11b5b88881ba4214f27?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt Leadley", "link": "https://stackoverflow.com/users/4564057/kurt-leadley"}, "reply_to_user": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1443661351, "post_id": 32619642, "comment_id": 53586811, "body": "My 2nd block of code, which is my newest block of code doesn&#39;t even have Document3.docx in the code. Maybe Word ran the other macro on you."}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1443713010, "post_id": 32619642, "comment_id": 53612181, "body": "Your code doesn&#39;t have any file names. You have to select them from FileDialogs. I chose <code>Document3.xlsx&#39; for </code>strfilename3<code>. I can&#39;t possibly know what you picked. It doesn&#39;t matter what name I pick, the file created by </code>FileCopy` won&#39;t open. I&#39;m not sure why you&#39;re using FileCopy rather than working inside Word, but I don&#39;t know what Office app you&#39;re code is running in."}, {"owner": {"reputation": 461, "user_id": 4564057, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7bf977a7b05ba11b5b88881ba4214f27?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt Leadley", "link": "https://stackoverflow.com/users/4564057/kurt-leadley"}, "reply_to_user": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1443714843, "post_id": 32619642, "comment_id": 53613319, "body": "I am only trying this on word documents not xlsx"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1443725652, "post_id": 32619642, "comment_id": 53618905, "body": "I named it docx, not xlsx. Sorry about the typo in the last comment"}, {"owner": {"reputation": 461, "user_id": 4564057, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7bf977a7b05ba11b5b88881ba4214f27?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt Leadley", "link": "https://stackoverflow.com/users/4564057/kurt-leadley"}, "reply_to_user": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1443730915, "post_id": 32619642, "comment_id": 53621698, "body": "That is odd, I just copied that 2nd block of code above to double check that nothing was lost in translation, and it did not throw an error for me. I am using Word 2010 by the way. I also have Microsoft DAO 3.6 Object Library enabled in addition to Microsoft Scripting Runtime. When you had this code successfully add multiple words to a single sentence how were you handling the files?"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1443788927, "post_id": 32619642, "comment_id": 53642125, "body": "Strange. I&#39;m using Word 2010 too. No DAO reference. I was using already opened documents - just to simulate having three documents without having to code all the file open stuff. I&#39;ll try it again."}], "answers": [{"comments": [{"owner": {"reputation": 461, "user_id": 4564057, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7bf977a7b05ba11b5b88881ba4214f27?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt Leadley", "link": "https://stackoverflow.com/users/4564057/kurt-leadley"}, "edited": false, "score": 0, "creation_date": 1443561473, "post_id": 32853048, "comment_id": 53541563, "body": "Does the dict need to be set as an object instead? I am getting an error &quot;User-defined type not defined&quot;"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "reply_to_user": {"reputation": 461, "user_id": 4564057, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7bf977a7b05ba11b5b88881ba4214f27?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt Leadley", "link": "https://stackoverflow.com/users/4564057/kurt-leadley"}, "edited": false, "score": 0, "creation_date": 1443619566, "post_id": 32853048, "comment_id": 53566651, "body": "Set a reference using, from the VBE, Tools - References to Microsoft Scripting Runtime."}, {"owner": {"reputation": 461, "user_id": 4564057, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7bf977a7b05ba11b5b88881ba4214f27?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt Leadley", "link": "https://stackoverflow.com/users/4564057/kurt-leadley"}, "edited": false, "score": 0, "creation_date": 1443628167, "post_id": 32853048, "comment_id": 53572630, "body": "I appreciate your help. Unfortunately the revised code you supplied me only succeeded on one word.  I used the paragraph &quot;This is a test. The word Automation <b>cool</b> tool, will hopefully work <b>now</b>. This is not a <b>fun</b> test. Need a new sentence here now for the word <b>awesome</b> Automation tool, hopefully this works.&quot;  Only <b>fun</b> was added to the new doc. I will post my updated code if you are still willing to help."}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "reply_to_user": {"reputation": 461, "user_id": 4564057, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7bf977a7b05ba11b5b88881ba4214f27?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt Leadley", "link": "https://stackoverflow.com/users/4564057/kurt-leadley"}, "edited": false, "score": 0, "creation_date": 1443648061, "post_id": 32853048, "comment_id": 53583001, "body": "Yes, post your updated code. I tested my code before I posted it, so I know it works."}, {"owner": {"reputation": 461, "user_id": 4564057, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7bf977a7b05ba11b5b88881ba4214f27?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt Leadley", "link": "https://stackoverflow.com/users/4564057/kurt-leadley"}, "edited": false, "score": 0, "creation_date": 1443648258, "post_id": 32853048, "comment_id": 53583070, "body": "I have the code in the 2nd block of the original comment. I edited that."}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 0, "last_activity_date": 1443557927, "creation_date": 1443557927, "answer_id": 32853048, "question_id": 32619642, "link": "https://stackoverflow.com/questions/32619642/adding-multiple-words-to-a-word-document-in-a-sentence-using-an-array-with-vba/32853048#32853048", "title": "Adding multiple words to a word document in a sentence using an array with VBA", "body": "<p>This uses a Scripting.Dictionary - set a reference using Tools - References to Microsoft Scripting Runtime.</p>\n\n<p>It saves the sentence of each found entry as an entry to the dictionary. It only saves each sentence once. When it finds the second word, it replaces that word within what's already in the dictionary.</p>\n\n<pre><code>Sub MergeRevision()\n\n    Dim dcOrig As Document\n    Dim dcRev As Document\n    Dim dcNew As Document\n    Dim rSearch As Range\n    Dim dict As Scripting.Dictionary\n    Dim i As Long\n\n    'Set up the documents - you already have this part\n    Set dcOrig = Documents(\"Document1.docm\")\n    Set dcRev = Documents(\"Document2.docx\")\n    Set dcNew = Documents(\"Document3.docx\")\n    dcOrig.Content.Copy\n    dcNew.Content.Paste\n\n    'We'll store the sentences here\n    Set dict = New Scripting.Dictionary\n\n    Set rSearch = dcRev.Range\n    With rSearch\n        .Find.Forward = True\n        .Find.Format = True\n        .Find.Font.Color = wdColorBlue\n        .Find.Execute\n\n        Do While .Find.Found\n            'key = revised sentence, item = original sentence\n            'if the revised sentence already exists in the dictionary, replace the found word in the entry\n            If dict.Exists(.Sentences(1).Text) Then\n                dict.Item(.Sentences(1).Text) = Replace$(Replace$(dict.Item(.Sentences(1).Text), .Text, vbNullString), Space(2), Space(1))\n            Else\n            'if the revised sentence isn't in the dict, then this is the first found word, so add it and replace the word\n                dict.Add .Sentences(1).Text, Replace$(Replace$(.Sentences(1).Text, .Text, vbNullString), Space(2), Space(1))\n            End If\n\n            .Find.Execute\n        Loop\n    End With\n\n    'Loop through all the dictionary entries and find the origial (item) and replace With\n    'the revised (key)\n    For i = 1 To dict.Count\n        Set rSearch = dcNew.Range\n        With rSearch.Find\n            .MatchWholeWord = False\n            .MatchCase = False\n            .MatchPhrase = True\n            .IgnoreSpace = True\n            .IgnorePunct = True\n            .Wrap = wdFindContinue\n            .Text = dict.Items(i - 1)\n            .Replacement.Text = dict.Keys(i - 1)\n            .Execute Replace:=wdReplaceOne\n        End With\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 461, "user_id": 4564057, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7bf977a7b05ba11b5b88881ba4214f27?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt Leadley", "link": "https://stackoverflow.com/users/4564057/kurt-leadley"}, "edited": false, "score": 0, "creation_date": 1443822830, "post_id": 32908011, "comment_id": 53660735, "body": "Thank you so much! I added this and it worked completely       <code>dict.Item(.Sentences(1).Text) = Replace$(Replace$(dict.Item(.Sentences(1).Text), .Text, vbNullString), &quot; ,&quot;, &quot;,&quot;)                 dict.Item(.Sentences(1).Text) = Replace$(Replace$(dict.Item(.Sentences(1).Text), .Text, vbNullString), &quot; .&quot;, &quot;.&quot;)</code>"}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": false, "score": 0, "last_activity_date": 1443791628, "creation_date": 1443791628, "answer_id": 32908011, "question_id": 32619642, "link": "https://stackoverflow.com/questions/32619642/adding-multiple-words-to-a-word-document-in-a-sentence-using-an-array-with-vba/32908011#32908011", "title": "Adding multiple words to a word document in a sentence using an array with VBA", "body": "<p>Change your <code>.Execute</code> line to</p>\n\n<pre><code>Debug.Assert .Execute(Replace:=wdReplaceOne)\n</code></pre>\n\n<p>Execute returns False if it's unsuccessful and Debug.Assert stops the code when it's False. When it stops, go to the immediate window and type the debug.print (?) statements below (the answers I got are shown)</p>\n\n<pre><code>?.Text\nThe word Automation tool, will hopefully work . \n?.Replacement.Text\nThe word Automation cool tool, will hopefully work now. \n?rsearch.Text\nThis is a test. The word Automation tool, will hopefully work. This is not a test. Need a new sentence here now for the word Automation tool, hopefully this works.\n</code></pre>\n\n<p>The problem is that it can't find <code>.Text</code> because of the <code>&lt;space&gt;&lt;period&gt;</code> at the end. We're deleting double spaces, but that doesn't work when the blue text is at the end of the sentence. You need to replace SpaceSpace, SpacePeriod, and SpaceComma, at least. Who knows what other strange punctuation you might encounter.</p>\n\n<p>Once you get things working, you can get rid of the Debug.Assert. But you may want to throw an error when .Execute returns False so the user is aware it didn't copy correctly.</p>\n\n<p>The reason I was getting those \"processing\" errors was because I was using FileCopy on a macro-enabled document and copying with a .docx extension. So my bad.</p>\n"}], "owner": {"reputation": 461, "user_id": 4564057, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7bf977a7b05ba11b5b88881ba4214f27?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt Leadley", "link": "https://stackoverflow.com/users/4564057/kurt-leadley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 32853048, "answer_count": 2, "score": 0, "last_activity_date": 1443791628, "creation_date": 1442441507, "last_edit_date": 1443628810, "question_id": 32619642, "link": "https://stackoverflow.com/questions/32619642/adding-multiple-words-to-a-word-document-in-a-sentence-using-an-array-with-vba", "title": "Adding multiple words to a word document in a sentence using an array with VBA", "body": "<p>My question pertains to the Do While loop in my code, but I posted the whole thing to show you what I'm doing. This code will compare two documents. The object is to have blue text in a revision document added into the sentences of the original document and have that become a new third document. The functionality I am having trouble accomplishing is adding multiple words within a sentence. Right now I can add a word anywhere in a sentence as long as it is the only instance of blue text within that sentence. The program finds blue text  and selects the entire sentence of that particular blue word. This is the only way I have thought how to reference where to add the new text to the third document. The blue text is removed from the sentence and that sentence is taken and found in the original document that has been copied. The blue text is then added back and saved to the new document. Here is a rundown of why one blue word per sentence will work and not two or more:<br/><br/>\n<strong>Does not work:</strong><br/>\nOriginal Document: \"This String Is.\"<br/>\nRevision Document: \"This <strong>New</strong> String Is <strong>New.</strong>\"<br/>\nThe first blue word is found and taken out to compare the string to the original document but.....<br/> \"This String Is New\" does not match with \"This String Is\"<br/><br/>\n<strong>This works though with just one blue word per sentence:</strong><br/>\nOriginal Document: \"This String Is.\"<br/>\nRevision Document: \"This String Is <strong>New</strong>.\" <br/>\n\"New\" is removed \"This String Is.\" = \"This String Is.\"<br/><br/>\nThe sentence is found in the original document and the blue word is added to the copied original document and is saved. The program then moves onto the next blue word and repeats the process till no more blue text is found. <strong>However</strong>, without removing all instances of blue text within a sentence at once, there will not be a match in the orignal document. That is what I need help accomplishing, probably with an array.\n<br/>      </p>\n\n<pre><code>Sub ArrayTest()\n\n MsgBox \"Welcome to the word document automatic modifier\", vbInformation + vbOKOnly\n\n    MsgBox \"Please open the revision file\", vbInformation + vbOKOnly\n\n    Dim strfilename1 As String\n    Dim fd1 As Office.FileDialog\n\n   ''''''Browsing/Opening the change request'''''''\n\n    Set fd1 = Application.FileDialog(msoFileDialogFilePicker)\n\n   With fd1\n\n      .AllowMultiSelect = False\n      .Title = \"Open the modified word document.\"\n      .Filters.Clear\n      .Filters.Add \"Word 2010\", \"*.docx\"\n      .Filters.Add \"All Files\", \"*.*\"\n\n      If .Show = True Then\n        strfilename1 = .SelectedItems(1) 'replace txtFileName with your textbox\n      Else\n      Exit Sub\n      End If\n   End With\n\n\n''''''''''' Browsing/Opening the original Design Manual'''''''''''''''''''''''''''\n\nMsgBox \"Open the orginal document\", vbInformation + vbOKOnly\n\n\nDim strfilename2 As String\n\n    Dim fd2 As Office.FileDialog\n\n    Set fd2 = Application.FileDialog(msoFileDialogFilePicker)\n\n   With fd2\n\n      .AllowMultiSelect = False\n      .Title = \"Please select the original file.\"\n      .Filters.Clear\n      .Filters.Add \"Word 2010\", \"*.docx\"\n      .Filters.Add \"All Files\", \"*.*\"\n\n      If .Show = True Then\n        strfilename2 = .SelectedItems(1) 'replace txtFileName with your textbox\n      Else\n      Exit Sub\n      End If\n   End With\n\n\nMsgBox \"Please enter the file name with which you want to store the new updated file\", vbInformation + vbOKOnly\n\n\n''''''''''''''''''Asking user to input name to the new revised document'''''''''''''''''''''''''''''''''''''\n\nDim strfilename3 As String\n\n    Dim fd3 As Office.FileDialog\n\n    Set fd3 = Application.FileDialog(msoFileDialogSaveAs)\n\n   With fd3\n      .AllowMultiSelect = False\n      .Title = \"Please select the name to be given to the new file.\"\n      If .Show = True Then\n        strfilename3 = .SelectedItems(1) 'replace txtFileName with your textbox\n      Else\n      Exit Sub\n      End If\n   End With\n\n\nDim strg1 As String\nDim strg2 As String\nDim strg3 As String\nDim count As Integer\nDim strgArray()\n\n\nFileCopy strfilename2, strfilename3\n\nSet objWordChange = CreateObject(\"Word.Application\")\nSet objWordorig = CreateObject(\"Word.Application\")\n\nobjWordChange.Visible = False\nobjWordorig.Visible = False\n\nSet objDocChange = objWordChange.Documents.Open(strfilename1)\nSet objSelectionChange = objWordChange.Selection\nSet objDocOrig = objWordorig.Documents.Open(strfilename3)\nSet objSelectionOrig = objWordorig.Selection\n\ncount = 0\n\nobjSelectionChange.Find.Forward = True\nobjSelectionChange.Find.Format = True\nobjSelectionChange.Find.Font.Color = wdColorBlue\n\nDo While True\n    objSelectionChange.Find.Execute\n    If objSelectionChange.Find.Found Then\n        strg2 = objSelectionChange.Sentences(1).Text\n        count = count + 1\n        ReDim strgArray(count)\n        strgArray(count) = objSelectionChange.Text\n        MsgBox strgArray(count) &amp; \" Located In Array Index # \" &amp; count\n        MsgBox strg2\n        strg3 = Replace(strg2, strgArray(count), \"\")\n        strg3 = Replace(strg3, \"  \", \" \")\n        strg3 = Mid(strg3, 1, Len(strg3) - 2)\n        strg4 = strg3\n        MsgBox strg4\n\n        Set objRangeOrig = objDocOrig.Content\n        '''''Search the string in the original manual'''''\n        With objRangeOrig.Find\n        .MatchWholeWord = False\n        .MatchCase = False\n        .MatchPhrase = True\n        .IgnoreSpace = True\n        .IgnorePunct = True\n        .Wrap = wdFindContinue\n        .Text = strg4\n        .Replacement.Text = Left(strg2, Len(strg2) - 2)\n        .Execute Replace:=wdReplaceOne\n        objDocOrig.Save\n        End With\n    Else\n        Exit Do\n    End If\nLoop\nobjDocChange.Close\nobjDocOrig.Save\nobjDocOrig.Close\n\nobjWordChange.Quit\nobjWordorig.Quit\n\nEnd Sub\n</code></pre>\n\n<p><strong><em>Edit: This is the newer code as suggested by Dick, however it is still not completely working.</em></strong></p>\n\n<pre><code>Sub WordReplaceSentence()\n\nMsgBox \"Welcome to the word document automatic modifier\", vbInformation + vbOKOnly\n\nMsgBox \"Please open the revision file\", vbInformation + vbOKOnly\n\n    Dim strfilename1 As String\n    Dim fd1 As Office.FileDialog\n\n   ''''''Browsing/Opening the change request'''''''\n\n    Set fd1 = Application.FileDialog(msoFileDialogFilePicker)\n\n   With fd1\n\n      .AllowMultiSelect = False\n      .Title = \"Open the modified word document.\"\n      .Filters.Clear\n      .Filters.Add \"Word 2010\", \"*.docx\"\n      .Filters.Add \"All Files\", \"*.*\"\n\n      If .Show = True Then\n        strfilename1 = .SelectedItems(1) 'replace txtFileName with your textbox\n      Else\n      Exit Sub\n      End If\n   End With\n\n\n''''''''''' Browsing/Opening the original Design Manual'''''''''''''''''''''''''''\n\nMsgBox \"Open the orginal document\", vbInformation + vbOKOnly\n\n\nDim strfilename2 As String\n\n    Dim fd2 As Office.FileDialog\n\n    Set fd2 = Application.FileDialog(msoFileDialogFilePicker)\n\n   With fd2\n\n      .AllowMultiSelect = False\n      .Title = \"Please select the original file.\"\n      .Filters.Clear\n      .Filters.Add \"Word 2010\", \"*.docx\"\n      .Filters.Add \"All Files\", \"*.*\"\n\n      If .Show = True Then\n        strfilename2 = .SelectedItems(1) 'replace txtFileName with your textbox\n      Else\n      Exit Sub\n      End If\n   End With\n\n\nMsgBox \"Please enter the file name with which you want to store the new updated file\", vbInformation + vbOKOnly\n\n\n''''''''''''''''''Asking user to input name to the new revised document'''''''''''''''''''''''''''''''''''''\n\n    Dim strfilename3 As String\n\n    Dim fd3 As Office.FileDialog\n\n    Set fd3 = Application.FileDialog(msoFileDialogSaveAs)\n\n   With fd3\n      .AllowMultiSelect = False\n      .Title = \"Please select the name to be given to the new file.\"\n      If .Show = True Then\n        strfilename3 = .SelectedItems(1) 'replace txtFileName with your textbox\n      Else\n      Exit Sub\n      End If\n   End With\n\n    FileCopy strfilename2, strfilename3\n\n    Set objWordChange = CreateObject(\"Word.Application\")\n    Set objWordorig = CreateObject(\"Word.Application\")\n\n    objWordChange.Visible = False\n    objWordorig.Visible = False\n\n    Set objDocChange = objWordChange.Documents.Open(strfilename1)\n    Set objSelectionChange = objWordChange.Selection\n    Set objDocOrig = objWordorig.Documents.Open(strfilename3)\n    Set objSelectionOrig = objWordorig.Selection\n\n    Dim rSearch As Range\n    Dim dict As Scripting.Dictionary\n    Dim i As Long\n\n    'Set up the documents - you already have this part\n\n\n    'We'll store the sentences here\n    Set dict = New Scripting.Dictionary\n\n    Set rSearch = objDocChange.Range\n    With rSearch\n        .Find.Forward = True\n        .Find.Format = True\n        .Find.Font.Color = wdColorBlue\n        .Find.Execute\n\n        Do While .Find.Found\n        Dim strg1\n        Dim strg2\n        strg1 = rSearch.Sentences(1).Text\n        MsgBox strg1\n            'key = revised sentence, item = original sentence\n            'if the revised sentence already exists in the dictionary, replace the found word in the entry\n            If dict.Exists(.Sentences(1).Text) Then\n                dict.Item(.Sentences(1).Text) = Replace$(Replace$(dict.Item(.Sentences(1).Text), .Text, vbNullString), Space(2), Space(1))\n            Else\n            'if the revised sentence isn't in the dict, then this is the first found word, so add it and replace the word\n                dict.Add .Sentences(1).Text, Replace$(Replace$(.Sentences(1).Text, .Text, vbNullString), Space(2), Space(1))\n            End If\n\n            .Find.Execute\n        Loop\n    End With\n\n    'Loop through all the dictionary entries and find the origial (item) and replace With\n    'the revised (key)\n    For i = 1 To dict.Count\n        Set rSearch = objDocOrig.Range\n        With rSearch.Find\n            .MatchWholeWord = False\n            .MatchCase = False\n            .MatchPhrase = True\n            .IgnoreSpace = True\n            .IgnorePunct = True\n            .Wrap = wdFindContinue\n            .Text = dict.Items(i - 1)\n            .Replacement.Text = dict.Keys(i - 1)\n            .Execute Replace:=wdReplaceOne\n        End With\n    Next i\n\nobjDocChange.Close\nobjDocOrig.Save\nobjDocOrig.Close\n\nobjWordChange.Quit\nobjWordorig.Quit\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["mysql", "vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1442440327, "post_id": 32619352, "comment_id": 53089281, "body": "What I need is your salary if I am to do your work for you? XD"}, {"owner": {"reputation": 1, "user_id": 5344195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82890f8364d491df239b472670b12f09?s=128&d=identicon&r=PG&f=1", "display_name": "Jka", "link": "https://stackoverflow.com/users/5344195/jka"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1442440584, "post_id": 32619352, "comment_id": 53089392, "body": "Sharing is caring bro...you can ask me any question related to Taxation/ ways to save tax ....i can give you the answer...i am a finance guy..."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1442440662, "post_id": 32619352, "comment_id": 53089419, "body": "If this was sharingiscaringbro.com then sure. But this is SO XD Please see how to <a href=\"http://stackoverflow.com/help/how-to-ask\">ask a question</a>. Admittedly, my comment was rude but irresitible so I apologize."}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1442441194, "post_id": 32619352, "comment_id": 53089629, "body": "Look into COUNTIF function:"}, {"owner": {"reputation": 1, "user_id": 5344195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82890f8364d491df239b472670b12f09?s=128&d=identicon&r=PG&f=1", "display_name": "Jka", "link": "https://stackoverflow.com/users/5344195/jka"}, "edited": false, "score": 0, "creation_date": 1442441225, "post_id": 32619352, "comment_id": 53089637, "body": "Thanks pnuts, i used to do it in pivot table earlier...Sorry i forgot to mention that earlier.....the same set of data comes every month..And i spent a whole day every time to clean up and make it to the required format with pivot table....So i was just wondering if anyone out there can help me on a macro....with which i can automate the whole process,....I have used record macro to do all the process...this is the only thing which i am not able to automate due to lack of technical knowledge..... :( ....sorry to all i am being too greedy on this..."}, {"owner": {"reputation": 1, "user_id": 5344195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82890f8364d491df239b472670b12f09?s=128&d=identicon&r=PG&f=1", "display_name": "Jka", "link": "https://stackoverflow.com/users/5344195/jka"}, "edited": false, "score": 0, "creation_date": 1442441399, "post_id": 32619352, "comment_id": 53089697, "body": "Thanks Macro....there are two criteria, one is the ID and second one is the compensaiton variable...which is not allowing me to do the Countif function"}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1442441897, "post_id": 32619352, "comment_id": 53089870, "body": "please give sample of data sheet (with the challenges) so we can help you..."}, {"owner": {"reputation": 1, "user_id": 5344195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82890f8364d491df239b472670b12f09?s=128&d=identicon&r=PG&f=1", "display_name": "Jka", "link": "https://stackoverflow.com/users/5344195/jka"}, "edited": false, "score": 0, "creation_date": 1442443751, "post_id": 32619352, "comment_id": 53090404, "body": "Sorry i am new to this so i dont know to share in this portal...so i am sharing it from google sheet <a href=\"https://docs.google.com/spreadsheets/d/1XmgDms-wpiyoUmF0zd1D4EgDOgpFnpXLiK-VaEWEiBk/edit?usp=sharing\" rel=\"nofollow noreferrer\">docs.google.com/spreadsheets/d/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 5344195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82890f8364d491df239b472670b12f09?s=128&d=identicon&r=PG&f=1", "display_name": "Jka", "link": "https://stackoverflow.com/users/5344195/jka"}, "edited": false, "score": 0, "creation_date": 1442444433, "post_id": 32619352, "comment_id": 53090602, "body": "The challenge is, other than doing a pivot table...is there a way we can count the number of variables for each individual....the countif function wont work as there are two criteria....count the number of the header for the employee id.......as suggested by a user recorded the pivot table.....but if we can have a way some other formula which is not common....that would be great....i tried lot of check on count, countif, countifs, counta, match...but nothing seems to work....I have a lot of vlookups going through the spreadsheet...so it will have effect on pivot so cannot trust pivot...."}, {"owner": {"reputation": 1, "user_id": 5344195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82890f8364d491df239b472670b12f09?s=128&d=identicon&r=PG&f=1", "display_name": "Jka", "link": "https://stackoverflow.com/users/5344195/jka"}, "edited": false, "score": 0, "creation_date": 1442518409, "post_id": 32619352, "comment_id": 53125625, "body": "Anyluck guys.....apologizes for not being clear...and appreciate all your help"}, {"owner": {"reputation": 1, "user_id": 5344195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82890f8364d491df239b472670b12f09?s=128&d=identicon&r=PG&f=1", "display_name": "Jka", "link": "https://stackoverflow.com/users/5344195/jka"}, "edited": false, "score": 0, "creation_date": 1442835608, "post_id": 32619352, "comment_id": 53231503, "body": "I did it guys with the help of loops...thanks for all your help"}], "answers": [{"tags": [], "owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "is_accepted": false, "score": 0, "last_activity_date": 1442442299, "creation_date": 1442442299, "answer_id": 32619776, "question_id": 32619352, "link": "https://stackoverflow.com/questions/32619352/counting-the-number-of-occurrences-of-specific-item-for-unique-number/32619776#32619776", "title": "Counting the number of occurrences of specific item for unique number", "body": "<ul>\n<li>select your data</li>\n<li>insert pivot table</li>\n<li>put the employee id as a row field, the pay item type in column field, and the amount as a data field (right click to summarize by count)</li>\n</ul>\n\n<p>That might be just what you need. </p>\n\n<p>Record yourself doing that, post the code, and we can help you tweak it so it works every month. </p>\n"}], "owner": {"reputation": 1, "user_id": 5344195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82890f8364d491df239b472670b12f09?s=128&d=identicon&r=PG&f=1", "display_name": "Jka", "link": "https://stackoverflow.com/users/5344195/jka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1442442299, "creation_date": 1442440151, "last_edit_date": 1442440679, "question_id": 32619352, "link": "https://stackoverflow.com/questions/32619352/counting-the-number-of-occurrences-of-specific-item-for-unique-number", "title": "Counting the number of occurrences of specific item for unique number", "body": "<p>I tried using formulas but these didn't work as expected. My boss has given me a file which contains data on 7,000 employees and lists monthly pay items such as salary, allowance etc. I need to summarize in one sheet like the below, for eg 1234 was paid salary every month so the Salary should reflect 12, whereas he received education allowances only for two months so the count will show as <code>2</code> under Education.  </p>\n\n<p>I take the data from a different sheet, which will have employee ID on cell A:A, and pay items on C:C (Salary for 12  months will be in 12 rows like that for each pay item).   </p>\n\n<p>The expectation is a new sheet with count under each column of pay description how many items are there for each employee: </p>\n\n<pre>\nEmployee ID Salary  Home Allowance  Education   Sodexo\n1234          12                      2 \n45678               \n91011</pre>         \n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1442439469, "post_id": 32619183, "comment_id": 53088892, "body": "Step through the code using F8. Where does it break?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 4, "creation_date": 1442439516, "post_id": 32619183, "comment_id": 53088920, "body": "I&#39;ll save you the trouble: If you&#39;re calling this as a user-defined function <i>from the worksheet</i>, it cannot be done this way. You can&#39;t use the <code>Activate</code> method (and in fact, you can&#39;t use many of the <code>Range</code> methods within a UDF called from the worksheet). Ranges should be passed as arguments to the function."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1442440530, "post_id": 32619183, "comment_id": 53089365, "body": "Here&#39;s some other stuff you can&#39;t do in a UDF too - <a href=\"https://support.microsoft.com/en-us/kb/170787#mt1\" rel=\"nofollow noreferrer\">UDF limitations</a>"}, {"owner": {"reputation": 11, "user_id": 5344182, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206085905041388/picture?type=large", "display_name": "Muhammed Arbab Ali Javed", "link": "https://stackoverflow.com/users/5344182/muhammed-arbab-ali-javed"}, "edited": false, "score": 0, "creation_date": 1442441958, "post_id": 32619183, "comment_id": 53089889, "body": "Thank You for the response, if not for a UDF how can I run through this?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1442448857, "post_id": 32619183, "comment_id": 53091662, "body": "Is the following of any help? <a href=\"http://stackoverflow.com/questions/27050976/calculating-molecular-weight-using-excel\">Calculating Molecular Weight Using Excel</a>"}], "owner": {"reputation": 11, "user_id": 5344182, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206085905041388/picture?type=large", "display_name": "Muhammed Arbab Ali Javed", "link": "https://stackoverflow.com/users/5344182/muhammed-arbab-ali-javed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1442439367, "creation_date": 1442439367, "last_edit_date": 1531164843, "question_id": 32619183, "link": "https://stackoverflow.com/questions/32619183/this-is-my-first-time-programming-in-vba-i-do-not-get-any-return-values-for-mol", "title": "This is my first time programming in VBA, I do not get any return values for MolarVolume", "body": "<p>no matter what I plug in, I get a Value error #Value! Is there a problem with the way my function is written, used to C++ and Matlab. Could anyone please tell me what I'm doing wrong. This is a function to calculate the Molar Volume of a compound from 3 different Datasets for different Values. The logic In my opinion (feel free to correct) seems to be fine. It's just that I am not used to the Visual Basic Syntax. If there are any logical or syntax related errors please please please tell me. All help will be appreciated. Thank you in advance! </p>\n\n<pre><code>Function MolarVolume(compund As String, T As Double, P As Double) As Double\nT = 273.15 + T\nDim Compare As String\nDim Z01 As Double  \nDim Z02 As Double\nDim Z0 As Double\nDim Tc As Double\nDim Pc As Double\nDim Z11 As Double\nDim Z12 As Double\nDim Z1 As Double\nDim Pr As Double\nDim Pr1 As Double\nDim Pr2 As Double\nDim col As Integer\nDim Row As Integer\nDim ComparePressureZ As Double\nDim CompareTempZ As Double\n\nSet Data = Worksheets(\"data\").Activate\n\nCompare = Data.Cells(Row, 1)\n\n\nWhile Compare &lt;&gt; compound\nRow = Row + 1\nCompare = Data.Cells(Row, 1)\nWend\n\nTc = Data.Cells(Row, 4)\nPc = Data.Cells(Row, 5)\n\nTr = T / Tc\nPr = P / Pc  \n\nTr = Round(Tr, 1)\n\n\nSet Dataz0 = Worksheets(\"data_Z0.csv\").Activate\n\ncol = 1\nRow = 1\n\n\nComparePressureZ = Dataz0.Cells(1, col)\nCompareTempZ = Dataz0.Cells(Row, col)\n\nWhile ComparePressureZ &lt; Round(Pr, 1)\ncol = col + 1\nPr1 = Dataz0.Cells(1, col)\nWhile CompareTempZ &lt;&gt; Tr\nRow = Row + 1\nWend\nZ01 = Dataz0.Cells(Row, col)\nWend\n\n\n\nSet Rng = Range(\"B1:P1\")\nRow = 1\ncol = 2\n\n\nFor Each cll In Rng\nIf cll.Value &gt; Pr Then\ncol = col\nPr2 = Dataz0.Cells(1, col)\nElse\ncol = col + 1\nEnd If\nNext\n\n\nWhile CompareTempZ &lt;&gt; Tr\nRow = Row + 1\nWend\n\n\nZ02 = Dataz0.Cells(Row, col)\n\n\nZ0 = Z01 + (Pr - Pr1) * ((Z02 - Z01) / (Pr2 - Pr1))\n\n\nSet dataz1 = Worksheets(\"data_Z1.csv\").Activate\n\ncol = 1\nRow = 1\n\nComparePressureZ = dataz1.Cells(1, col)\nCompareTempZ = dataz1.Cells(Row, col)\n\nWhile ComparePressureZ &lt; Round(Pr, 1)\ncol = col + 1\nPr1 = dataz1.Cells(1, col)\nWhile CompareTempZ &lt;&gt; Tr\nRow = Row + 1\nWend\nZ11 = dataz1.Cells(Row, col)\nWend\n\n\n\nSet Rng = Range(\"B1:P1\")\nRow = 1\ncol = 2\n\n\nFor Each cll In Rng\nIf cll.Value &gt; Pr Then\ncol = col\nPr2 = dataz1.Cells(1, col)\nElse\ncol = col + 1\nEnd If\nNext\n\n\nWhile CompareTempZ &lt;&gt; Tr\nRow = Row + 1\nWend\n\n\nZ12 = dataz1.Cells(Row, col)\n\n\nZ1 = Z11 + (Pr - Pr1) * ((Z12 - Z11) / (Pr2 - Pr1))\n\n\nMolarVolume = Z1\n\n\nEnd Function    \n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1442492567, "post_id": 32619126, "comment_id": 53109430, "body": "Col P values are positive numbers and blank &quot; . But I will try this method and let you know if this works for me"}, {"owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "reply_to_user": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1442506850, "post_id": 32619126, "comment_id": 53119208, "body": "That should work, it&#39;s constants vs. formulas, so positive numbers are fine."}], "tags": [], "owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "is_accepted": false, "score": 0, "last_activity_date": 1442439144, "creation_date": 1442439144, "answer_id": 32619126, "question_id": 32618815, "link": "https://stackoverflow.com/questions/32618815/code-to-if-cell-isnt-empty-insert-a-few-equations-in-offset-position/32619126#32619126", "title": "Code to, if cell isn&#39;t empty, insert a few equations in offset position", "body": "<p>Assuming the values in column P are constants, you can try running the following line of code using specialcells and avoid the loop altogether. </p>\n\n<pre><code>columns(\"P\").specialCells(xlcelltypeconstants).offset(1,-12).formular1c1=\"=OFFSET(R[-1]C[-3],-R[-1]C[30],0)\"\n</code></pre>\n\n<p>For more on special cells, see <a href=\"https://tduhameau.wordpress.com/tag/specialcells/\" rel=\"nofollow\">here</a>. </p>\n"}, {"comments": [{"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1442497304, "post_id": 32619128, "comment_id": 53112608, "body": "This worked perfectly, all I had to was adjust the reference location from the active cell in col P. Thank you"}], "tags": [], "owner": {"reputation": 1293, "user_id": 4152280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AhQa0.jpg?s=128&g=1", "display_name": "SkyMaster", "link": "https://stackoverflow.com/users/4152280/skymaster"}, "is_accepted": true, "score": 0, "last_activity_date": 1442439147, "creation_date": 1442439147, "answer_id": 32619128, "question_id": 32618815, "link": "https://stackoverflow.com/questions/32618815/code-to-if-cell-isnt-empty-insert-a-few-equations-in-offset-position/32619128#32619128", "title": "Code to, if cell isn&#39;t empty, insert a few equations in offset position", "body": "<p>Your code would look like:</p>\n\n<pre><code>Sub DropEq()\n\nDim dlen2 As String\nApplication.ScreenUpdating = False\ndlen2 = Worksheets(\"HR-Calc\").Range(\"AS1\")\n\nFor lrow = 1 To Cells.Range(\"AU1\").Value\n    If Cells(lrow, \"P\") &lt;&gt; \"\" Then\n        Cells(lrow, \"P\").Select\n        ActiveCell.Offset(1, -12).FormulaR1C1 = \"=OFFSET(R[-1]C[-3],-R[-1]C[30],0)\"\n    End If\n\n'first instance thats true for statement above  is P43, which would then throw the equations below into those cells\n    'Range(\"d44\").ActiveCell.FormulaR1C1 = \"=OFFSET(R[-1]C[-3],-R[-1]C[30],0)\"\n\n'Range(\"E44\").ActiveCell.FormulaR1C1 = _\n    \"=COUNTA(R[-1]C[-2]:OFFSET(R[-1]C[-2],-R[-2]C[29],0))/2\"\n\n    'Range(\"F44\").ActiveCell.FormulaR1C1 = _\n    \"=SUMIF(R[-1]C[-4]:OFFSET(R[-1]C[-4],-R[-2]C[28],0),R1C21,R[-1]C[8]:OFFSET(R[-1]C[8],-R[-2]C[28],0))\"\n\n'Range(\"G44\").ActiveCell.FormulaR1C1 = _\n    \"=SUMIF(R[-1]C[-5]:OFFSET(R[-1]C[-5],-R[-2]C[27],0),R2C21,R[-1]C[7]:OFFSET(R[-1]C[7],-R[-2]C[27],0))\"\n\n'Range(\"H44\").ActiveCell.FormulaR1C1 =    \"=SUM(R[-1]C[7]:OFFSET(R[-1]C[7],-R[-2]C[26],0))\"\n\n'Range(\"I44\").ActiveCell.FormulaR1C1 = _\n    \"= COUNTA(R[-1]C[6]:OFFSET(R[-1]C[6],-R[-2]C[25],0))-COUNTBLANK(R[-1]C[6]:OFFSET(R[-1]C[6],-R[-2]C[25],0))\"\n\n'   I'd like a msgbox asking single or double fuse? then ask for fuse rating and place input value that into \"E45 relative to P43\"\n'    Range(\"E45\").ActiveCell.FormulaR1C1 = \"30A STRING\"\n'    Range(\"F45\").ActiveCell.FormulaR1C1 = \"POS\"\n'    Range(\"G45\").ActiveCell.FormulaR1C1 = \"NEG\"\n'    Range(\"H45\").ActiveCell.FormulaR1C1 = \"MAX SPL\"\n'    Range(\"I45\").ActiveCell.FormulaR1C1 = \"# SPL\"\nNext lrow\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 32619128, "answer_count": 2, "score": 0, "last_activity_date": 1442448119, "creation_date": 1442437940, "last_edit_date": 1531161705, "question_id": 32618815, "link": "https://stackoverflow.com/questions/32618815/code-to-if-cell-isnt-empty-insert-a-few-equations-in-offset-position", "title": "Code to, if cell isn&#39;t empty, insert a few equations in offset position", "body": "<p>I have found different chunks of the answer in many Google searches and I have smashed them together in the code below, but I'm getting errors and other issues. </p>\n\n<p>I need to scan col P, if there is a value in col P, then offset one row and -12 col and paste in a formula. (In the recorded macro the first value in P is in P43). So in my code I have range as a cell not as an offset reference (if P43 is active cell first equation should go into D44 or R1C-12 etc). I keep getting an error in my <code>if cell &lt;&gt; \"\"</code> statement. This code will have to repeat until it hits the last row (row value is stored in cell \"AU1\" since there are many gaps in data).  </p>\n\n<pre><code>Sub DropEq()\n\nDim dlen2 As String\n\nApplication.ScreenUpdating = False\ndlen2 = Worksheets(\"HR-Calc\").Range(\"AS1\")\n\nIf Cells(lRow, \"P\") &lt;&gt; \"\" Then ActiveCell.Select\nActiveCell.Offset(1, -12).FormulaR1C1 = \"=OFFSET(R[-1]C[-3],-R[-1]C[30],0)\"\n\n'first instance thats true for statement above  is P43, which would then throw the equations below into those cells\n    'Range(\"d44\").ActiveCell.FormulaR1C1 = \"=OFFSET(R[-1]C[-3],-R[-1]C[30],0)\"\n\n'Range(\"E44\").ActiveCell.FormulaR1C1 = _\n    \"=COUNTA(R[-1]C[-2]:OFFSET(R[-1]C[-2],-R[-2]C[29],0))/2\"\n\n    'Range(\"F44\").ActiveCell.FormulaR1C1 = _\n    \"=SUMIF(R[-1]C[-4]:OFFSET(R[-1]C[-4],-R[-2]C[28],0),R1C21,R[-1]C[8]:OFFSET(R[-1]C[8],-R[-2]C[28],0))\"\n\n'Range(\"G44\").ActiveCell.FormulaR1C1 = _\n    \"=SUMIF(R[-1]C[-5]:OFFSET(R[-1]C[-5],-R[-2]C[27],0),R2C21,R[-1]C[7]:OFFSET(R[-1]C[7],-R[-2]C[27],0))\"\n\n'Range(\"H44\").ActiveCell.FormulaR1C1 =    \"=SUM(R[-1]C[7]:OFFSET(R[-1]C[7],-R[-2]C[26],0))\"\n\n'Range(\"I44\").ActiveCell.FormulaR1C1 = _\n    \"= COUNTA(R[-1]C[6]:OFFSET(R[-1]C[6],-R[-2]C[25],0))-COUNTBLANK(R[-1]C[6]:OFFSET(R[-1]C[6],-R[-2]C[25],0))\"\n\n'   I'd like a msgbox asking single or double fuse? then ask for fuse rating and place input value that into \"E45 relative to P43\"\n'    Range(\"E45\").ActiveCell.FormulaR1C1 = \"30A STRING\"\n'    Range(\"F45\").ActiveCell.FormulaR1C1 = \"POS\"\n'    Range(\"G45\").ActiveCell.FormulaR1C1 = \"NEG\"\n'    Range(\"H45\").ActiveCell.FormulaR1C1 = \"MAX SPL\"\n'    Range(\"I45\").ActiveCell.FormulaR1C1 = \"# SPL\"\n Next lRow\n\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access-2007"], "answers": [{"tags": [], "owner": {"reputation": 99, "user_id": 3405747, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/00b8d7aaac8632ca91ed6dc4e1b75fd1?s=128&d=identicon&r=PG&f=1", "display_name": "bbwolff", "link": "https://stackoverflow.com/users/3405747/bbwolff"}, "is_accepted": false, "score": 0, "last_activity_date": 1442504834, "creation_date": 1442504834, "answer_id": 32634677, "question_id": 32618783, "link": "https://stackoverflow.com/questions/32618783/create-linked-tables-in-access-with-vba/32634677#32634677", "title": "Create linked tables in access with vba", "body": "<p>I found this on the net that works, though slow</p>\n\n<pre><code>Function createAttached(strTable As String, strPath As String, strBaseTable As String) As Boolean\nOn Error GoTo CreateAttachedError\n\nDim tdf As TableDef\nDim strConnect As String\nDim fRetval As Boolean\nDim myDB As Database\n\n    DoCmd.SetWarnings False\n    Set myDB = CurrentDb\n    Set tdf = myDB.CreateTableDef(strTable)\n\n    With tdf\n        .Connect = \";DATABASE=\" &amp; strPath\n        .SourceTableName = strBaseTable\n    End With\n\n    myDB.TableDefs.Append tdf\n\n    fRetval = True\n\n    DoCmd.SetWarnings True\n\nCreateAttachedExit:\n    createAttached = fRetval\n    Exit Function\n\nCreateAttachedError:\n    If Err = 3110 Then\n        Resume CreateAttachedExit\n    Else\n        If Err = 3011 Then\n            Resume Next\n        End If\n    End If\nEnd Function\n</code></pre>\n\n<p><a href=\"https://www.microsoftaccessexpert.com/Microsoft-Access-Code-LinkTable.aspx\" rel=\"nofollow\">https://www.microsoftaccessexpert.com/Microsoft-Access-Code-LinkTable.aspx</a></p>\n"}], "owner": {"reputation": 99, "user_id": 3405747, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/00b8d7aaac8632ca91ed6dc4e1b75fd1?s=128&d=identicon&r=PG&f=1", "display_name": "bbwolff", "link": "https://stackoverflow.com/users/3405747/bbwolff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2359, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1442504834, "creation_date": 1442437828, "question_id": 32618783, "link": "https://stackoverflow.com/questions/32618783/create-linked-tables-in-access-with-vba", "title": "Create linked tables in access with vba", "body": "<p>I'm working with a database in Access 2007, one front end and a few backends.</p>\n\n<p>I like to convert all my linked tables to local for offline work so that i don't accidentally spoil the data. </p>\n\n<p>I delete all the relations and tables and then run a saved import.</p>\n\n<p>I'd like to recreate linked tables after I'm done with modifications. Problem is, Access won't save the import of linked tables. Is there a way to simply link all the tables from backend to frontend with VBA</p>\n"}, {"tags": ["vba", "vbscript", "vb6"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1442437517, "post_id": 32618635, "comment_id": 53087948, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/31891059/extracting-the-collection-of-unique-values-from-a-filter-in-vba\">Extracting the collection of unique values from a filter in VBA</a>"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1442438013, "post_id": 32618635, "comment_id": 53088194, "body": "@Jeeped This is intended to show the general technique, without mixing in Excel- or other host-specific code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1442438299, "post_id": 32618635, "comment_id": 53088359, "body": "Yes, I get <i>exactly</i> what you are trying to accomplish. It is just that there are so-so many Scripting.Dictionary examples already available I question whether we need a non-Community-Wiki self-answered post. Perhaps you should should sign-up for the new <a href=\"http://meta.stackoverflow.com/questions/306213/warlords-of-documentation-your-questions-answered?cb=1\">Warlords of Documentation</a> endeavour. I have."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1442472918, "post_id": 32618635, "comment_id": 53098354, "body": "@Jeeped There may be a lot of Dictionary examples already available, but very few showing this specific technique, and it is always buried together with host-specific code. (And yes, I have already signed up for the SO Documentation beta.)"}], "answers": [{"tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": true, "score": 2, "last_activity_date": 1478200682, "last_edit_date": 1495535364, "creation_date": 1442437284, "answer_id": 32618636, "question_id": 32618635, "link": "https://stackoverflow.com/questions/32618635/how-can-i-get-a-unique-set-of-values/32618636#32618636", "title": "How can I get a unique set of values?", "body": "<p>Use a <code>Scripting.Dictionary</code> (<strong>Tools</strong> -> <strong>References...</strong> -> <strong>Microsoft Scripting Runtime</strong>):</p>\n\n<pre><code>Function Unique(values As Variant) As Variant()\n    'Put all the values as keys into a dictionary\n    Dim dict As New Dictionary\n    Dim val As Variant\n    For Each val In values\n        dict(val) = 1\n    Next\n    Unique = dict.Keys 'This cannot be done with a Collection, which doesn't expose its keys\nEnd Function\n</code></pre>\n\n<p>In VBScript, or in VBA if you prefer using late binding (variables without explicit types):</p>\n\n<pre><code>Function Unique(values)\n    Dim dict, val\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n    For Each val In values\n    ...\n</code></pre>\n\n<p>If running VBA on a Mac (which doesn't have the Microsoft Scripting Runtime), there is a <a href=\"https://github.com/VBA-tools/VBA-Dictionary\" rel=\"nofollow noreferrer\">drop-in replacement for Dictionary</a> available.</p>\n\n<p>Some examples:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/a/31891475/111794\">Extracting the collection of unique values from a filter in VBA</a></li>\n<li><a href=\"https://stackoverflow.com/a/32295149/111794\">Delete duplicate entries in a given row</a></li>\n<li><a href=\"https://stackoverflow.com/a/31637146/111794\">How to remove duplicate items in listbox</a></li>\n<li><a href=\"https://stackoverflow.com/questions/13743165/how-to-get-unique-values-from-a-list-of-values-using-vbscript\">How to get unique values from a list of values using VBscript?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/13512646/vbscriptremove-duplicates-from-an-array\">VBScript:Remove duplicates from an array</a></li>\n<li><a href=\"https://stackoverflow.com/a/33638663/111794\">Word occurrences in VBA</a></li>\n<li><a href=\"https://stackoverflow.com/questions/21169826/find-all-distinct-values-in-user-based-selection-excel-vba\">Find all distinct values in user based selection - Excel VBA</a></li>\n</ul>\n\n<hr>\n\n<p>Another option (VBA only) is to use a <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg251465.aspx\" rel=\"nofollow noreferrer\">Collection</a>. It's a little more awkward, because there is no way to set an existing key without an error being thrown, and because the returned array has to be created manually:</p>\n\n<pre><code>Function Unique(values As Variant) As Variant()\n    Dim col As New Collection, val As Variant, i As Integer\n    For Each val In values\n        TryAdd col, val, val\n    Next\n    Dim ret() As Variant\n    Redim ret(col.Count - 1)\n    For i = 0 To col.Count-1\n        ret(i) = col(i+1)\n    Next\n    Unique = ret\nEnd Function\n\nSub TryAdd(col As Collection, item As Variant, key As String)\n    On Error Resume Next\n    col.Add(item, key)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1930, "favorite_count": 0, "accepted_answer_id": 32618636, "answer_count": 1, "score": 0, "last_activity_date": 1516754758, "creation_date": 1442437284, "last_edit_date": 1516754758, "question_id": 32618635, "link": "https://stackoverflow.com/questions/32618635/how-can-i-get-a-unique-set-of-values", "title": "How can I get a unique set of values?", "body": "<p>Given some sort of collection of values (an array or a collection of some kind), how can I generate a set of distinct values?</p>\n"}, {"tags": ["vba", "button", "passwords"], "comments": [{"owner": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 2, "creation_date": 1442436283, "post_id": 32618330, "comment_id": 53087328, "body": "The user can open the macro and read the password."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 5003701, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/909639425763095/picture?type=large", "display_name": "Riadh Sa&#239;d", "link": "https://stackoverflow.com/users/5003701/riadh-sa%c3%afd"}, "edited": false, "score": 0, "creation_date": 1442437848, "post_id": 32618560, "comment_id": 53088119, "body": "Thanks a lot for your help :)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1442437075, "creation_date": 1442437075, "answer_id": 32618560, "question_id": 32618330, "link": "https://stackoverflow.com/questions/32618330/how-to-protect-a-button-with-a-password/32618560#32618560", "title": "How to protect a button with a password?", "body": "<p>@SLaks comment aside...</p>\n\n<pre><code>strPassword = \"HR\"\n\nFor lTries = 1 To 3\n    strPassTry = InputBox(\"Enter Password please\", \"RUN MACRO\")\n    If strPassTry = vbNullString Then\n        Exit Sub\n    End If\n    bSuccess = strPassword = strPassTry\n    If bSuccess Then Exit For\n    MsgBox \"Password incorrect\"\nNext lTries\n\nIf Not bSuccess Then \n    Msgbox \"Wrong password supplied!\"\n    Exit Sub\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 5003701, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/909639425763095/picture?type=large", "display_name": "Riadh Sa&#239;d", "link": "https://stackoverflow.com/users/5003701/riadh-sa%c3%afd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1675, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1442437075, "creation_date": 1442436191, "last_edit_date": 1442436551, "question_id": 32618330, "link": "https://stackoverflow.com/questions/32618330/how-to-protect-a-button-with-a-password", "title": "How to protect a button with a password?", "body": "<p>I would like to know  how I can protect a button with a password before run the macro?</p>\n\n<p>I tried the following code, which works good, but I couldn't exit in case of the password is incorrect for the third time.</p>\n\n<pre><code>strPassword = \"HR\"\nFor lTries = 1 To 3\n    strPassTry = InputBox(\"Enter Password please\", \"RUN MACRO\")\n    If strPassTry = vbNullString Then\n        Exit Sub\n    End If\n    bSuccess = strPassword = strPassTry\n    If bSuccess = True Then Exit For\n    MsgBox \"Password incorrect\"\nNext lTries\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 378, "user_id": 4001728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/30e4634bc6682da5aff886511e7f4a61?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas", "link": "https://stackoverflow.com/users/4001728/lucas"}, "is_accepted": false, "score": 0, "last_activity_date": 1442435652, "creation_date": 1442435652, "answer_id": 32618180, "question_id": 32618087, "link": "https://stackoverflow.com/questions/32618087/vba-equivalent-to-excels-search/32618180#32618180", "title": "VBA equivalent to Excel&#39;s &quot;Search()&quot;", "body": "<p>You can use any function available in Excel in your VBA code. You can access this function in Application.WorksheetFunction object: <code>Application.WorksheetFunction.Search</code>. Use the same arguments you would use in the spreadsheet.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5343869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fea23b7cb33b1f332382782ba01b2da6?s=128&d=identicon&r=PG&f=1", "display_name": "Fernie B.", "link": "https://stackoverflow.com/users/5343869/fernie-b"}, "edited": false, "score": 0, "creation_date": 1442505668, "post_id": 32618221, "comment_id": 53118478, "body": "This helped alot. I created a new sub and receive a &quot;Run time error: 424 Object Required&quot; error message when i try to run. I wanna paste the new macro here to show but it has too many characters. Should I just edit the orignal post?"}, {"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "reply_to_user": {"reputation": 1, "user_id": 5343869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fea23b7cb33b1f332382782ba01b2da6?s=128&d=identicon&r=PG&f=1", "display_name": "Fernie B.", "link": "https://stackoverflow.com/users/5343869/fernie-b"}, "edited": false, "score": 0, "creation_date": 1442510599, "post_id": 32618221, "comment_id": 53121311, "body": "I have just simply use <code>Range</code> - depending on when the routine is called, then a <code>Sheets(...)</code> could be required"}], "tags": [], "owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "is_accepted": false, "score": 3, "last_activity_date": 1442435934, "last_edit_date": 1442435934, "creation_date": 1442435823, "answer_id": 32618221, "question_id": 32618087, "link": "https://stackoverflow.com/questions/32618087/vba-equivalent-to-excels-search/32618221#32618221", "title": "VBA equivalent to Excel&#39;s &quot;Search()&quot;", "body": "<p><code>Instr</code> is the VBA eqivalent</p>\n\n<pre><code>dim Pos as long\nPos=Instr(Range(\"B2\"),\"ADMIN\")\nif pos&gt;0 then 'code if found\nelse 'notfound\nend if\n</code></pre>\n\n<p>Instr has more options than search: see documentation <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264811(v=office.15).aspx\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 5343869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fea23b7cb33b1f332382782ba01b2da6?s=128&d=identicon&r=PG&f=1", "display_name": "Fernie B.", "link": "https://stackoverflow.com/users/5343869/fernie-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13847, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1442435934, "creation_date": 1442435339, "last_edit_date": 1442435567, "question_id": 32618087, "link": "https://stackoverflow.com/questions/32618087/vba-equivalent-to-excels-search", "title": "VBA equivalent to Excel&#39;s &quot;Search()&quot;", "body": "<p>I have an assignment I need some help with. There are three columns: Column A(username), Column B(Category), and Column C(note). I have to create a Sub that checks each cell down Column B according to category (for example Admin). If the string, \"Admin\", is found in B2 for example, then the A2 is searched for either:\"john.deer\", \"BES\", or \"mars\". If \"john.deer\" is found then C2 is to say \"Domain Admin Account\", if \"BES\" is found then C2 is to say \"BES Admin Account\" etc.  </p>\n\n<p>However if \"Admin\" is not found in Column C then \"SQL\" is searched in C2. If \"SQL\" is found then \"SQL Server\", \"SQL Engine\", and \"SQL Cluster\" is searched in A2. The exact same task as the previous paragraph except different strings are searched in Column B and A. Different strings are outputted to Column C as well. </p>\n\n<p>I had an equation that was perfect and just needed to create an equivalent for VBA:</p>\n\n<pre><code>=IF(NOT(ISERROR(SEARCH(\"admin\",B3))),IF(NOT(ISERROR(SEARCH(\"john.deer\",A3))),\"Domain Admin Account\",if(not(iserror(search(\"bes\",a2))),\"BES  Admin Account\", if(not(iserror(search(\"mars\",a2))),\"Cisco Admin Account\",\"no category\"),IF(NOT(ISERROR(SEARCH(\"SQL\",B3))),IF(NOT(ISERROR(SEARCH(\"sqlserver\",A3))),\"SQL Server\",IF(NOT(ISERROR(SEARCH(\"sqlengine\",B3))),\"SQL Engine Account\",\" \")))\n</code></pre>\n\n<p>As you can tell its a mess, which is why I wish to create a VBA equivalent. However, there is no Search() object in VBA, only .Find.  </p>\n\n<p>Here is my attempt at VBA before realizing Search did not work:</p>\n\n<pre><code>    Private Sub CommandButton21_Click()\n\nIf Not IsError Then\n    If Search(\"ADMIN\", \"B2\") Then 'Searches Col. F for \"Admin\", then Col. B for type of admin before\n                                'populating Notes Col. with specific Note\n\n    If Not IsError Then\n        Search(\"john.deer\", \"A2\") = \"Domain Admin Account\"\n    ElseIf Not IsError Then\n        Search(\"BES\", \"A2\") = \"BES Admin Account\"\n    ElseIf Not IsError Then\n        Search(\"mars1\", \"A2\") = \"Admin Account for Cisco Phone System\"\n    Else\n  End If\n\nIf Search(\"admin\", \"B2\") Then\n    If Not IsError Then\n        Search(\"uccxadmin\", \"b2\") = \"Admin Account for Cisco phone system\"\n\nEnd If\nend if\nend sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1442434892, "post_id": 32617921, "comment_id": 53086623, "body": "Huh. If you can do it for one, you can do it for both. Try an <code>and</code> with the <code>if</code> statement?"}, {"owner": {"reputation": 25, "user_id": 5343995, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-A2fhI2W8Kug/AAAAAAAAAAI/AAAAAAAAAs0/JMSKA4uGtTo/photo.jpg?sz=128", "display_name": "iain", "link": "https://stackoverflow.com/users/5343995/iain"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1442435055, "post_id": 32617921, "comment_id": 53086706, "body": "Hi there, thanks for the reply. However I&#39;ve been advised to use a Do.. While look instead of an If statement to iterate through the recordset. I will try to figure out another way to iterate through. Thanks for your help, Iain"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1442435150, "post_id": 32617921, "comment_id": 53086754, "body": "You&#39;re confusing the two processes. You do want a <code>do while</code> loop to pull your data but then you want an <code>if</code> statement to determine where to drop the data you pulled... What code do you have so far?"}, {"owner": {"reputation": 25, "user_id": 5343995, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-A2fhI2W8Kug/AAAAAAAAAAI/AAAAAAAAAs0/JMSKA4uGtTo/photo.jpg?sz=128", "display_name": "iain", "link": "https://stackoverflow.com/users/5343995/iain"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1442435396, "post_id": 32617921, "comment_id": 53086872, "body": "Thanks again for the reply. The code I&#39;ve had the most success with I lifted from here <a href=\"http://stackoverflow.com/questions/32484761/export-access-data-into-excel-workbook-and-split-data-into-multiple-sheets-based?lq=1\">link</a>"}, {"owner": {"reputation": 25, "user_id": 5343995, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-A2fhI2W8Kug/AAAAAAAAAAI/AAAAAAAAAs0/JMSKA4uGtTo/photo.jpg?sz=128", "display_name": "iain", "link": "https://stackoverflow.com/users/5343995/iain"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1442435478, "post_id": 32617921, "comment_id": 53086924, "body": "Urgh, I tried to past my code but it was too long"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1442435596, "post_id": 32617921, "comment_id": 53086987, "body": "@IainWall Could you post the code in the original post as an edit?  It will make it easier to read."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1442435679, "post_id": 32617921, "comment_id": 53087031, "body": "Ah. Sadly, I am unfamiliar with the database object :/ I would do it without but that seems to be the more efficient method so I will let someone else more knowledgeable take over XD"}, {"owner": {"reputation": 25, "user_id": 5343995, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-A2fhI2W8Kug/AAAAAAAAAAI/AAAAAAAAAs0/JMSKA4uGtTo/photo.jpg?sz=128", "display_name": "iain", "link": "https://stackoverflow.com/users/5343995/iain"}, "edited": false, "score": 0, "creation_date": 1442435685, "post_id": 32617921, "comment_id": 53087036, "body": "Hi guys, I&#39;ve pasted the code above. I&#39;m sorry about my noobiness here :("}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1442506681, "post_id": 32617921, "comment_id": 53119095, "body": "Does that code do what you need for one <code>intRouterLocation</code>?  And is the remaining challenge about creating additional workbooks for each of the other <code>intRouterLocation</code>?"}, {"owner": {"reputation": 25, "user_id": 5343995, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-A2fhI2W8Kug/AAAAAAAAAAI/AAAAAAAAAs0/JMSKA4uGtTo/photo.jpg?sz=128", "display_name": "iain", "link": "https://stackoverflow.com/users/5343995/iain"}, "edited": false, "score": 0, "creation_date": 1442522525, "post_id": 32617921, "comment_id": 53127777, "body": "Hi HansUp, thanks for your response. The above code will work in so far as to filter the data based on intDaysInLocation into the separate sheets within one workbook with all the intRouterLocation&#39;s included. What I am now needing to do, ,is figure a way to create a new workbook for each of the unique intRouterLocations (200 of them), the drop the existing code in.  Hoepfully that makes sense! I do really appreciate the help you guys have given me :)"}, {"owner": {"reputation": 531, "user_id": 1946796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vd55i.jpg?s=128&g=1", "display_name": "Rafa Barragan", "link": "https://stackoverflow.com/users/1946796/rafa-barragan"}, "edited": false, "score": 0, "creation_date": 1464219390, "post_id": 32617921, "comment_id": 62400275, "body": "Hi, have you tried to make a <code>Stored Procedure</code>? and <code>Loop</code> through it with something like in [this][1]. It could be easier and avoids run statements that could affect your Database.  [1]: <a href=\"http://www.mrexcel.com/forum/excel-questions/340855-visual-basic-applications-nextrecordset-does-work.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "edited": false, "score": 0, "creation_date": 1442956416, "post_id": 32726953, "comment_id": 53296425, "body": "PS if you create the subfolder <i>Export</i> next to the database file, then you can use the <i>CurrentProject.Path &amp; &quot;\\Export\\&quot;</i> as a parameter"}, {"owner": {"reputation": 25, "user_id": 5343995, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-A2fhI2W8Kug/AAAAAAAAAAI/AAAAAAAAAs0/JMSKA4uGtTo/photo.jpg?sz=128", "display_name": "iain", "link": "https://stackoverflow.com/users/5343995/iain"}, "edited": false, "score": 0, "creation_date": 1443374299, "post_id": 32726953, "comment_id": 53457904, "body": "Sorry for the late reply. I fiddled about with it a wee bit and it works!! Thank you so much for your help!"}, {"owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "reply_to_user": {"reputation": 25, "user_id": 5343995, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-A2fhI2W8Kug/AAAAAAAAAAI/AAAAAAAAAs0/JMSKA4uGtTo/photo.jpg?sz=128", "display_name": "iain", "link": "https://stackoverflow.com/users/5343995/iain"}, "edited": false, "score": 0, "creation_date": 1443377313, "post_id": 32726953, "comment_id": 53458877, "body": "You&#39;re welcome. Maybe you could mark my answer so it can be closed? Thank you in advance."}], "tags": [], "owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "is_accepted": true, "score": 0, "last_activity_date": 1442956070, "creation_date": 1442956070, "answer_id": 32726953, "question_id": 32617921, "link": "https://stackoverflow.com/questions/32617921/exporting-data-from-access-to-excel-workbooks-sheets-based-on-numerous-condition/32726953#32726953", "title": "Exporting data from Access to Excel workbooks/sheets based on numerous conditions", "body": "<p>I think I built what you need. Just point it towards the right table, fields and export location as in the Test sub. It needs to be run from Access, with a reference to your Excel library.</p>\n\n<pre><code>Public Sub Test()\n\n    ExportToExcel \"tblData\", \"intRouterLocation\", \"intDaysInLocation\", CurrentProject.Path &amp; \"\\Export\\\"\n\nEnd Sub\n\nPublic Sub ExportToExcel(sTableName As String, sWorkBookNameField As String, sSheetNameField As String, sDestinationFolder As String)\n\n    Dim rsData          As Recordset\n    Dim oXL             As Excel.Application\n    Dim oWB             As Excel.Workbook\n    Dim oSH             As Excel.Worksheet\n    Dim sPrevWB         As String\n    Dim sPrevSheet      As String\n    Dim lRecordcount    As String\n    Dim vTempArray()    As Variant\n    Dim lFieldID        As Long\n    Dim lRecordID       As Long\n\n    With CurrentDb.OpenRecordset(\"SELECT [\" &amp; sWorkBookNameField &amp; \"],[\" &amp; sSheetNameField &amp; \"] FROM [\" &amp; sTableName &amp; \"] GROUP BY [\" &amp; sWorkBookNameField &amp; \"],[\" &amp; sSheetNameField &amp; \"] ORDER BY [\" &amp; sWorkBookNameField &amp; \"],[\" &amp; sSheetNameField &amp; \"] DESC;\")\n        If .EOF And .BOF Then\n            .Close\n            MsgBox \"No data found\"\n            Exit Sub\n        End If\n\n        Set oXL = New Excel.Application\n\n        Do Until .EOF\n            If sPrevWB &lt;&gt; .Fields(sWorkBookNameField) Then\n                If Not oWB Is Nothing Then\n                    oWB.Close True\n                    Set oWB = oXL.Workbooks.Add\n                Else\n                    With oXL\n                        Set oWB = .Workbooks.Add\n                        .Calculation = xlCalculationManual\n                        .ScreenUpdating = False\n                    End With\n                End If\n\n                oWB.SaveAs sDestinationFolder &amp; .Fields(sWorkBookNameField) &amp; \".xlsx\"\n                sPrevWB = .Fields(sWorkBookNameField)\n                Set oSH = oWB.Sheets(1)\n            ElseIf sPrevSheet &lt;&gt; .Fields(sSheetNameField) Then\n                If oSH.Index + 1 &gt; oWB.Sheets.Count Then oWB.Sheets.Add\n                Set oSH = oWB.Sheets(oSH.Index + 1)\n            End If\n\n            oSH.Name = .Fields(sSheetNameField)\n\n            'Push data to sheet (numerous methods, I just picked one)\n            Set rsData = CurrentDb.OpenRecordset(\"SELECT * FROM [\" &amp; sTableName &amp; \"] WHERE [\" &amp; sWorkBookNameField &amp; \"]='\" &amp; .Fields(sWorkBookNameField) &amp; \"' AND [\" &amp; sSheetNameField &amp; \"]='\" &amp; .Fields(sSheetNameField) &amp; \"'\")\n\n            rsData.MoveLast\n            lRecordcount = rsData.RecordCount\n            rsData.MoveFirst\n\n            vTempArray = rsData.GetRows(lRecordcount)\n\n            For lFieldID = 0 To UBound(vTempArray, 1)\n                oSH.Cells(1, lFieldID + 1) = rsData.Fields(lFieldID).Name\n                For lRecordID = 0 To UBound(vTempArray, 2)\n                    oSH.Cells(lRecordID + 2, lFieldID + 1) = vTempArray(lFieldID, lRecordID)\n                Next lRecordID\n            Next lFieldID\n            oSH.Cells.EntireColumn.AutoFit\n            .MoveNext\n        Loop\n        .Close\n    End With\n\n    oWB.Save\n    oXL.Quit\n\n    Set rsData = Nothing\n    Set oSH = Nothing\n    Set oWB = Nothing\n    Set oXL = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5343995, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-A2fhI2W8Kug/AAAAAAAAAAI/AAAAAAAAAs0/JMSKA4uGtTo/photo.jpg?sz=128", "display_name": "iain", "link": "https://stackoverflow.com/users/5343995/iain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 889, "favorite_count": 0, "accepted_answer_id": 32726953, "answer_count": 1, "score": 2, "last_activity_date": 1442956070, "creation_date": 1442434723, "last_edit_date": 1442542711, "question_id": 32617921, "link": "https://stackoverflow.com/questions/32617921/exporting-data-from-access-to-excel-workbooks-sheets-based-on-numerous-condition", "title": "Exporting data from Access to Excel workbooks/sheets based on numerous conditions", "body": "<p>I have some data structured as follows:</p>\n\n<pre><code>sglAccNumber    intDaysOld      intRouterLocation   intDaysInLocation\n1638828663      614             Customer Service    05. - 61-90 Days\n1955963013      348             Advertising         03. 16-45 Days\n1198680816      1678            Accounting          09. 401-730 Days\n1892708307      1860            Accounting          010. 730+ Days\n1785581943      1005            Asset Management    02. 6-15 Days\n1942406908      1853            Finances            09. 401-730 Days\n</code></pre>\n\n<p>etc... There are 60,000 rows of data.</p>\n\n<p>I am looking to move the data from the Access table to numerous different workbooks, based on the intRouterLocation name. The bit I'm struggling with is, within each individual workbook, also to move the data to a worksheet with the name intDaysInLocation.</p>\n\n<p>For example, using the data above, the Accounting workbook would have two sheets generated, one for <em>09. 401-730 Days</em>, and one for <em>010. 730+ Days</em> and the appropriate entries would populate each. </p>\n\n<p>I have been struggling with this for the past few days and can get the data to go into either the workbooks by name, or the <strong>intDaysInLocation</strong> by value, but combining them both has gotten the better of me.  </p>\n\n<p>Is this something that would be possible using VBA?</p>\n\n<p>The code I'm using to collate the sheets only (all in one sheet, the <em>intRouterLocation</em> isn't taken into account):</p>\n\n<pre><code>Sub exportMk2 ()\n\nDim db As DAO.Database\nDim qdf As DAO.QueryDef\nDim rs As DAO.Recordset\nDim strPath As String\nDim strSelectOneType As String\nDim strSelectDaysInLocation As String\n\n' (change strPath back to what you need)\nstrPath = CurrentProject.Path &amp; Chr(92) &amp; \"Pets_dataset_export_\" &amp; _\n    Format(Date, \"yyyy-mm-dd\") &amp; \".xlsx\"\nstrSelectDaysInLocation = \"SELECT DISTINCT p.intDaysInLocation\" &amp; vbCrLf &amp; _\n    \"FROM Worksheet AS p;\"\n\nSet db = CurrentDb\nSet rs = db.OpenRecordset(strSelectDaysInLocation, dbOpenSnapshot)\nSet rsRouters = db.OpenRecordset(strSelectDaysInLocation, dbOpenSnapshot)\n\nFor Each routerLocation In rsRouters\n    Do While Not rs.EOF\n        strSelectOneType = \"SELECT p.ID, p.intDaysInLocation, p.intRouterLocation\" &amp; vbCrLf &amp; _\n            \"FROM Worksheet AS p\" &amp; vbCrLf &amp; _\n            \"WHERE p.intDaysInLocation='\" &amp; rs!intDaysInLocation.Value &amp; \"';\"\n        Debug.Print strSelectOneType\n        Set qdf = db.QueryDefs(\"qryExportMe\")\n        qdf.SQL = strSelectOneType\n        qdf.Close\n        DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, _\n            \"qryExportMe\", strPath, True, \"woot \" &amp; rs!intDaysInLocation.Value\n        rs.MoveNext\n    Loop\nNext\nrs.Close\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1442434697, "post_id": 32617727, "comment_id": 53086502, "body": "A QueryDef is created then destroyed but it is never referenced again; it is not part of the working code. The three occurrences (declaration, setting, setting to nothing) could be deleted and nothing would change. It may have been one avenue that the coder was exploring and gave up on in favor of <code>DoCmd.TransferSpreadsheet ...</code>."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1442434778, "post_id": 32617727, "comment_id": 53086551, "body": "... and for a general &quot;Do I have to set things to <code>Nothing</code>&quot; question, see <a href=\"http://stackoverflow.com/q/19038350/11683\">When should an Excel VBA variable be killed or set to Nothing?</a>."}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1442478637, "post_id": 32617979, "comment_id": 53101398, "body": "Still this is a confusing coding practice. They should have put it in a statement form:  <code>cdb.CreateQueryDef &quot;Reserve-from Wakely&quot;, &quot;SELECT *&quot;</code>."}], "tags": [], "owner": {"reputation": 532, "user_id": 5339510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GYWNv.jpg?s=128&g=1", "display_name": "Philippe", "link": "https://stackoverflow.com/users/5339510/philippe"}, "is_accepted": true, "score": 3, "last_activity_date": 1442434944, "creation_date": 1442434944, "answer_id": 32617979, "question_id": 32617727, "link": "https://stackoverflow.com/questions/32617727/immediately-setting-a-variable-to-nothing/32617979#32617979", "title": "Immediately setting a variable to nothing", "body": "<p>It is because the <em>QueryDef</em> is not only contained in the <em>qdf</em> variable, but it is also stored in <em>QueryDefs</em> collection and saved to disk...</p>\n\n<p>As explained here: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff845129(v=office.14).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff845129(v=office.14).aspx</a></p>\n\n<blockquote>\n  <p>To create a new QueryDef object, use the CreateQueryDef method. In a Microsoft Access workspace, if you supply a string for the name argument or if you explicitly set the Name property of the new QueryDef object to a non\u2013zero-length string, you will create a permanent QueryDef that will automatically be appended to the QueryDefs collection and saved to disk</p>\n</blockquote>\n"}], "owner": {"reputation": 47, "user_id": 4941481, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-j2uo1xDfTT0/AAAAAAAAAAI/AAAAAAAAAD4/0Iu34Iz0sjc/photo.jpg?sz=128", "display_name": "DemonLlama", "link": "https://stackoverflow.com/users/4941481/demonllama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "accepted_answer_id": 32617979, "answer_count": 1, "score": 1, "last_activity_date": 1442434944, "creation_date": 1442433991, "last_edit_date": 1442434640, "question_id": 32617727, "link": "https://stackoverflow.com/questions/32617727/immediately-setting-a-variable-to-nothing", "title": "Immediately setting a variable to nothing", "body": "<p>I used a variation of this code that I found on this site, and it works well. My question is, I can't understand the rationale behind setting <code>qdf</code> to nothing immediately after defining it. Clearly it doesn't disrupt the process, everything works fine, but to my untrained eye, it shouldn't. Why is that in the code, and why does it not empty the variable's SQL code and export nothing to excel?</p>\n\n<pre><code>Sub Export()\n    Dim cdb As DAO.Database, qdf As DAO.QueryDef\n    Set cdb = CurrentDb\n\n    Const xlsxPath = \"redacted 1\"\n\n    ' create .xlsx file if it doesn't already exist, and add the first worksheet\n\n    DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"Ledger Data by Channel\", xlsxPath, True\n\n\n    'file exists now, so this will add a second worksheet to the file\n    DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"Premium Reserves\", xlsxPath, True\n\n    Set qdf = cdb.CreateQueryDef(\"Reserve-from Wakely\", _\n            \"SELECT * FROM [redacted 4] UNION SELECT * FROM [PAI ALR] UNION SELECT * FROM [Prior Month PAI DAC]\")\n    Set qdf = Nothing\n        DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"redacted 2\", xlsxPath, True\n    DoCmd.DeleteObject acQuery, \"Reserve-from Wakely\"\n\n    DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"redacted 3\", xlsxPath, True\n\n    DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"Claims Data\", xlsxPath, True\n\n    Set cdb = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1442435295, "post_id": 32617615, "comment_id": 53086826, "body": "If all else fails, you could ask the user for the screen size. I know it&#39;s not ideal.  zedfoxus might be onto something though. Good luck."}], "answers": [{"comments": [{"owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1442435282, "post_id": 32618018, "comment_id": 53086818, "body": "@MatthewD it is indeed quite interesting to see all the kinds of information WMI exposes. I didn&#39;t know this was possible until trying it myself after some Googling"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 1, "creation_date": 1442435381, "post_id": 32618018, "comment_id": 53086866, "body": "I went down a different path from my Googling. I will put this info in my &quot;bag of tricks&quot;. Thanks."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "edited": false, "score": 1, "creation_date": 1442436835, "post_id": 32618018, "comment_id": 53087602, "body": "This is amazing. Thanks a lot."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "edited": false, "score": 1, "creation_date": 1442436888, "post_id": 32618018, "comment_id": 53087629, "body": "I have two monitor, is there any way to check on which monitor my project is currently running?"}, {"owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "edited": false, "score": 0, "creation_date": 1442437434, "post_id": 32618018, "comment_id": 53087898, "body": "@user1670773 I am sure there is a way to do that, but I don&#39;t know the answer. You might benefit from creating a new question so that someone more knowledgeable than me can help out"}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1486074038, "post_id": 32618018, "comment_id": 71202361, "body": "Note that, as noted in the Wmi documentation, the actual values may not be available."}], "tags": [], "owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "is_accepted": true, "score": 5, "last_activity_date": 1442435070, "last_edit_date": 1495540464, "creation_date": 1442435070, "answer_id": 32618018, "question_id": 32617615, "link": "https://stackoverflow.com/questions/32617615/how-to-get-monitor-size/32618018#32618018", "title": "How to get monitor size", "body": "<p>You can tap into WMI's <code>WmiMonitorBasicDisplayParams</code> to get some information about your display. I was successfully able to display the diagonal length of both displays with this code using Windows 7.</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    Dim WMIObject As Object\n    Dim WMIResult As Object\n    Dim WMIItem As Object\n\n    Set WMIObject = GetObject(\"winmgmts:\\\\.\\root\\WMI\")\n    Set WMIResult = WMIObject.ExecQuery(\"Select * From WmiMonitorBasicDisplayParams\")\n\n    Dim Diagonal As Double\n    Dim Width As Double\n    Dim Height As Double\n    Dim Counter As Integer\n    Counter = 1\n\n    For Each WMIItem In WMIResult\n\n        Width = WMIItem.MaxHorizontalImageSize / 2.54\n        Height = WMIItem.MaxVerticalImageSize / 2.54\n        Diagonal = Sqr((Height ^ 2) + (Width ^ 2))\n\n        MsgBox \"Your monitor # \" &amp; Counter &amp; \" is approximiately \" &amp; Round(Diagonal, 2) &amp; \" inches diagonal\"\n        Counter = Counter + 1\n\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Some other references that may help you. </p>\n\n<ul>\n<li><a href=\"http://www.activexperts.com/admin/scripts/wmiscripts/vbscript/0066/\" rel=\"nofollow noreferrer\">VBScript and WMI to capture display information</a></li>\n<li><a href=\"http://www.activexperts.com/admin/scripts/wmiscripts/powershell/0066/\" rel=\"nofollow noreferrer\">PowerShell and WMI to capture display information</a></li>\n<li><a href=\"https://stackoverflow.com/questions/12911553/how-can-i-get-the-real-size-of-the-lcd-display-diagonal-i-e-if-a-it-is-a-17\">C# to capture display information</a></li>\n<li><a href=\"https://sites.google.com/site/beyondexcel/project-updates/exposingsystemsecretswithvbaandwmiapi\" rel=\"nofollow noreferrer\">System Information using VBA and WMI</a></li>\n</ul>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6157, "favorite_count": 0, "accepted_answer_id": 32618018, "answer_count": 1, "score": 4, "last_activity_date": 1442435070, "creation_date": 1442433579, "question_id": 32617615, "link": "https://stackoverflow.com/questions/32617615/how-to-get-monitor-size", "title": "How to get monitor size", "body": "<p>In my project I need to determine the size of the monitor/screen. I can get the screen resolution using following code</p>\n\n<pre><code>   X = fPixelsToTwips(GetSystemMetrics(SM_CXSCREEN), \"X\") '\n   Y = GetSystemMetrics(SM_CYSCREEN)\n</code></pre>\n\n<p>This gives me the correct screen resolution. But I have a 13.6\" laptop screen and my friend has 15.6\" laptop screen. Both has same screen resolution 1366*768. But the screen size is different. So how can I determine screen size of monitor? This is very important for my project.</p>\n"}, {"tags": ["arrays", "vba", "excel", "textbox", "user-input"], "comments": [{"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1442433482, "post_id": 32617175, "comment_id": 53085809, "body": "Variable length but 30 is the most values you will have?  That is to say, the maximum will be a 3 column, 10 row table?"}, {"owner": {"reputation": 35, "user_id": 5268912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/973d4a8e7ad742d1fcc7d62723801edf?s=128&d=identicon&r=PG&f=1", "display_name": "discolemonade", "link": "https://stackoverflow.com/users/5268912/discolemonade"}, "reply_to_user": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1442434029, "post_id": 32617175, "comment_id": 53086136, "body": "for inputting back into text boxes yes but the table read is usually 3 by 14 with 4 blank rows thus the weeding portion."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 5268912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/973d4a8e7ad742d1fcc7d62723801edf?s=128&d=identicon&r=PG&f=1", "display_name": "discolemonade", "link": "https://stackoverflow.com/users/5268912/discolemonade"}, "edited": false, "score": 0, "creation_date": 1442435607, "post_id": 32618102, "comment_id": 53086992, "body": "I figured out my issure, I have posted my answer if you would like to see if there is any issues but for me the code runs beautifully."}], "tags": [], "owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "is_accepted": false, "score": 0, "last_activity_date": 1442435382, "creation_date": 1442435382, "answer_id": 32618102, "question_id": 32617175, "link": "https://stackoverflow.com/questions/32617175/pass-user-selected-range-into-array-then-into-userform-text-boxes/32618102#32618102", "title": "pass user selected range into array then into userform text boxes", "body": "<p><strong>Edit:  I missed that you were using the input box wrong, however I will leave this answer as it presents a way to collapse a variable range of user input from a multidimensional array into a single dimension array.</strong></p>\n\n<p>This should get you started.  Basically it will read the user's input, dynamically create a one-dimensional array of the correct size (rows * columns), and read all the values in the range the user selects to this one dimensional array.  It will then loop through the one dimensional array and print the values back out to the window.</p>\n\n<p>I think this is what you're looking for, but if you need further clarification I can add some.  I added comments so you can see what each section is doing.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub TestArrays()\n\n        Dim calBTemp() As Variant, calB() As Variant\n        Dim i As Long, j As Long, x As Long\n        Dim rngInput As Range\n\n        Set rngInput = Application.InputBox(\"Select the Cal B table.\", \"Select Range\", Type:=8)\n\n        'Read the user input, check for empty input\n        'If empty input, exit the subroutine\n        If Not rngInput Is Nothing Then\n                calBTemp = rngInput\n        Else\n                Exit Sub\n        End If\n\n        'Create the one-dimensional array dynamically based on user selection\n        ReDim calB((UBound(calBTemp, 1) - LBound(calBTemp, 1) + 1) * (UBound(calBTemp, 2) - LBound(calBTemp, 2) + 1))\n\n        'Loop through our multidimensional array\n        For i = LBound(calBTemp, 1) To UBound(calBTemp, 1)\n                For j = LBound(calBTemp, 2) To UBound(calBTemp, 2)\n                        'Assign the value to our one dimensional array\n                        calB(x) = calBTemp(i, j)\n                        x = x + 1\n                Next j\n        Next i\n\n        'Loop through our one dimensional array\n        For i = LBound(calB) To UBound(calB)\n                Debug.Print calB(i)\n        Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 5268912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/973d4a8e7ad742d1fcc7d62723801edf?s=128&d=identicon&r=PG&f=1", "display_name": "discolemonade", "link": "https://stackoverflow.com/users/5268912/discolemonade"}, "is_accepted": false, "score": 0, "last_activity_date": 1442435387, "creation_date": 1442435387, "answer_id": 32618104, "question_id": 32617175, "link": "https://stackoverflow.com/questions/32617175/pass-user-selected-range-into-array-then-into-userform-text-boxes/32618104#32618104", "title": "pass user selected range into array then into userform text boxes", "body": "<p>So I just wasn't using the <code>Application.Inputbox</code> right.  If you return it as a range it will configure to the proper sized 2D array it seams and you can call/manipulate data from there.  Here is a working sub.</p>\n\n<pre><code>Sub selectRange()\nDim ran As Range, calB(1 To 30) As Double, i As Integer, j As Integer, k As Integer, l As Integer\ndozerCal.Hide\nSet ran = Application.InputBox(\"Select the Cal B table.\", Type:=8)\nl = 1\nFor j = 1 To 14\n    For i = 1 To 3\n        If Abs(ran(j, i)) &gt; 0 Then\n            calB(l) = ran(j, i)\n            l = l + 1\n        End If\n    Next\nNext\n    lx = calB(1)\n    ly = calB(2)\n    lz = calB(3)\n    rx = calB(4)\n    ry = calB(5)\n    rz = calB(6)\n    ix = calB(7)\n    iy = calB(8)\n    iz = calB(9)\n    sx = calB(10)\n    sy = calB(11)\n    sz = calB(12)\n    p1x = calB(13)\n    p1y = calB(14)\n    p1z = calB(15)\n    p2x = calB(16)\n    p2y = calB(17)\n    p2z = calB(18)\n    lfx = calB(19)\n    lfy = calB(20)\n    lfz = calB(21)\n    lrx = calB(22)\n    lry = calB(23)\n    lrz = calB(24)\n    rfx = calB(25)\n    rfy = calB(26)\n    rfz = calB(27)\n    rrx = calB(28)\n    rry = calB(29)\n    rrz = calB(30)\n    ActiveWorkbook.Close\n    dozerCal.Show\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 115, "user_id": 3182515, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rqeXd.jpg?s=128&g=1", "display_name": "Jack Geiger", "link": "https://stackoverflow.com/users/3182515/jack-geiger"}, "is_accepted": false, "score": 0, "last_activity_date": 1442435818, "creation_date": 1442435818, "answer_id": 32618219, "question_id": 32617175, "link": "https://stackoverflow.com/questions/32617175/pass-user-selected-range-into-array-then-into-userform-text-boxes/32618219#32618219", "title": "pass user selected range into array then into userform text boxes", "body": "<p>This code will do the trick (and forces the user to select 3 columns and 14 rows):</p>\n\n<pre><code>Sub selectRange()\n    Dim selectedRange As Range\n    Dim errorMessage As String\n    errorMessage = vbNullString\n    Dim ran As Range, calB(1 To 30) As Long, i As Integer, j As Integer, k As Integer, l As Integer\n\n    Do\n        'doesn't handle cancel event\n        Set selectedRange = Application.InputBox(\"Select the Cal B table.\", _\n        Type:=8, Title:=\"Please select 14 rows and 3 columns\" &amp; errorMessage)\n        errorMessage = \"; previous selection was invalid\"\n    Loop While selectedRange.Columns.Count &lt;&gt; 3 Or selectedRange.Rows.Count &lt;&gt; 14\n\n    For j = 1 To 14\n        For i = 1 To 3\n            If Abs(selectedRange.Cells(j, i)) &gt; 0 Then\n                calB(l) = selectedRange.Cells(j, i)\n                l = l + 1\n            End If\n        Next\n    Next\n...rest of your code\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5268912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/973d4a8e7ad742d1fcc7d62723801edf?s=128&d=identicon&r=PG&f=1", "display_name": "discolemonade", "link": "https://stackoverflow.com/users/5268912/discolemonade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 859, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1442435818, "creation_date": 1442432003, "question_id": 32617175, "link": "https://stackoverflow.com/questions/32617175/pass-user-selected-range-into-array-then-into-userform-text-boxes", "title": "pass user selected range into array then into userform text boxes", "body": "<p>I am trying to have my code prompt the user to select a range of data of 3 width and variable length.  There will only be 30 values those with some rows being blank.  I want to have these 30 values populate into 30 text boxes in a userform of mine (this is so values don't have to be manually entered).  I looked around and figured my route should be <code>Application.Inputbox</code> and then pass it into an array were the blank rows can be weeded out with for loops.  I don't know how to pass the user selected table into a 2D array though.</p>\n\n<pre><code>Sub selectRange()\nDim r(1 To 14, 1 To 3) As Variant, ran As Range, calB(1 To 30) As Long, i As Integer, j As Integer, k As Integer, l As Integer\ndozerCal.Hide\nSet r = Application.InputBox(\"Select the Cal B table.\", Type:=8)\n\nFor j = 1 To 14\n    For i = 1 To 3\n        If Abs(r(j, i)) &gt; 0 Then\n            calB(l) = r(j, i)\n            l = l + 1\n        End If\n    Next\nNext\n    lx = calB(1)\n    ly = calB(2)\n    lz = calB(3)\n    rx = calB(4)\n    ry = calB(5)\n    rz = calB(6)\n    ix = calB(7)\n    iy = calB(8)\n    iz = calB(9)\n    sx = calB(10)\n    sy = calB(11)\n    sz = calB(12)\n    p1x = calB(13)\n    p1y = calB(14)\n    p1z = calB(15)\n    p2x = calB(16)\n    p2y = calB(17)\n    p2z = calB(18)\n    lfx = calB(19)\n    lfy = calB(20)\n    lfz = calB(21)\n    lrx = calB(22)\n    lry = calB(23)\n    lrz = calB(24)\n    rfx = calB(25)\n    rfy = calB(26)\n    rfz = calB(27)\n    rrx = calB(28)\n    rry = calB(29)\n    rrz = calB(30)\n    ActiveWorkbook.Close\n    dozercall.Show\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance for everyone's help.</p>\n"}, {"tags": ["vba", "excel", "web-scraping", "automation"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1442433228, "post_id": 32617167, "comment_id": 53085688, "body": "IMO you should use POST request, not GET in your case. Open the page eg in Chrome developer tools (press F12), on Elements tab, find the form <code>excel</code>, delete <code>target=&quot;_blank&quot;</code> and click on file icon, after the file downloaded, go to Network tab, and you see appeared <code>SurveyOutputServlet</code> POST request. Consider the <a href=\"http://stackoverflow.com/a/32429348/2165759\">example of retrieving csv data via XHR</a>."}, {"owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1442435893, "post_id": 32617167, "comment_id": 53087138, "body": "@omegastripes I tried that by inputting the URL as &quot;<a href=\"http://data.bls.gov/pdq/SurveyOutputServlet\" rel=\"nofollow noreferrer\">data.bls.gov/pdq/SurveyOutputServlet</a>&quot; and using POST as you advused but then I get a error saying the file extension is not valid and also I get the webpage contents in the excel sheet instead of the data. Please leave a comment if you can. Thanks for your help."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1442438135, "post_id": 32617167, "comment_id": 53088261, "body": "Take a look at <a href=\"http://i.stack.imgur.com/wNhgb.png\" rel=\"nofollow noreferrer\">my screenshot</a>, there are a bunch of Form Data parameters typical for POST XHR. I&#39;ve linked some of them with the page options just to show their common purpose. So you have to send all that parameters with request. Press view source (<code>output_type=default&amp;years_option=specific_years&amp;from_year=2&zwnj;&#8203;005&amp;...</code>) and you&#39;ll understand how to create the string to be sent. See my example by the link above."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1442444554, "post_id": 32620063, "comment_id": 53090634, "body": "btw, I used <b>Microsoft XML, v6.0</b> and <b>Microsoft HTML Object Library</b> in addition to <b>Microsoft ActiveX Data Objects 2.1 Library</b> for that code."}, {"owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "edited": false, "score": 0, "creation_date": 1442496700, "post_id": 32620063, "comment_id": 53112132, "body": "Thanks for your reply and help with the code. Suddenly now I find that the code throws an &quot;Operation Timed out error &quot; on  &quot;.send&quot; line. Can you please clarify? I have included the required references. Thanks."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "edited": false, "score": 0, "creation_date": 1442524289, "post_id": 32620063, "comment_id": 53128656, "body": "The code is still retrieving the xlsx download from my end. Perhaps you got IP blocked?"}, {"owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "edited": false, "score": 0, "creation_date": 1442538727, "post_id": 32620063, "comment_id": 53133045, "body": "yes it might have to do something with IP as it is working on my personal computer. Thanks."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1442444053, "creation_date": 1442444053, "answer_id": 32620063, "question_id": 32617167, "link": "https://stackoverflow.com/questions/32617167/extracting-file-url-from-a-hyperlinked-image/32620063#32620063", "title": "Extracting file URL from a Hyperlinked Image", "body": "<p>You might be able to hit the form target directly with a POST (action=\"/pdq/SurveyOutputServlet\") but it is expecting a post string of the &lt;input&gt; elements together with their values. Most if not all of these input elements have been filled out for you simply by going to that page. All you need to do is collect and concatenate them into a post string to be shoved back at the form.</p>\n\n<pre><code>Option Explicit\n\n'base web page\nPublic Const csBLSGOVpg = \"http://data.bls.gov/timeseries/LNS14000000\"\n'form's action target\nPublic Const csXLSDLpg = \"http://data.bls.gov/pdq/SurveyOutputServlet\"\n\nSub mcr_Stream_Buyer_Documents()\n    Dim xmlDL As New MSXML2.ServerXMLHTTP60, xmlBDY As New HTMLDocument, adoFILE As Object\n    Dim xmlSend As String, strFN As String, f As Long, i As Long\n\n    With xmlDL\n        .SetTimeouts 5000, 5000, 15000, 25000\n\n        'start by going to the base web page\n        .Open \"GET\", csBLSGOVpg, False\n        .setRequestHeader \"Content-Type\", \"text/javascript\"\n        .send\n\n        If .Status &lt;&gt; \"200\" Then GoTo bm_Exit\n\n        'get the source HTML for examination; zero the post string var\n        xmlBDY.body.innerHTML = .responseText\n        xmlSend = vbNullString\n\n        'loop through the forms until you find the right one\n        'then loop through the input elements and construct a post string\n        For f = 0 To xmlBDY.getElementsByTagName(\"form\").Length - 1\n            If xmlBDY.getElementsByTagName(\"form\")(f).Name = \"excel\" Then\n                With xmlBDY.getElementsByTagName(\"form\")(f)\n                    For i = 0 To .getElementsByTagName(\"input\").Length - 1\n                        xmlSend = xmlSend &amp; Chr(38) &amp; _\n                                 .getElementsByTagName(\"input\")(i).Name &amp; Chr(61) &amp; _\n                                 .getElementsByTagName(\"input\")(i).Value\n                    Next i\n                    xmlSend = \"?.x=5&amp;.y=5\" &amp; xmlSend\n                End With\n                Exit For\n            End If\n        Next f\n        'Debug.Print xmlSend   'check the POST string\n\n        'send the POST string back to the form's action target\n        .Open \"POST\", csXLSDLpg, False\n        xmlDL.setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\n        xmlDL.send xmlSend\n\n        If xmlDL.Status &lt;&gt; \"200\" Then GoTo bm_Exit\n\n        'pick up the response as a stream and save it as a .XLSX\n        strFN = Environ(\"USERPROFILE\") &amp; \"\\Documents\\LNS14000000\" &amp; Format(Date, \"yyyymmdd\") &amp; \".xlsx\"\n        On Error Resume Next\n        Kill strFN\n        On Error GoTo 0\n        Set adoFILE = CreateObject(\"ADODB.Stream\")\n        adoFILE.Type = 1\n        adoFILE.Open\n        adoFILE.Write .responseBody\n        adoFILE.SaveToFile strFN, 2\n        Set adoFILE = Nothing\n\n    End With\n    Set xmlBDY = Nothing\n    Set xmlDL = Nothing\n    Exit Sub\nbm_Exit:\n    Debug.Print Err.Number &amp; \":\" &amp; Err.Description\nEnd Sub\n</code></pre>\n\n<p>This is pretty minimalist but it is all that you need. There is at least one non-standard input element that does not have a name but I elected to send its value back anyway. I did not sequentially remove things until it broke; I just built the POST string given what I retrieved and sent it back.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/YxCuK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YxCuK.png\" alt=\"XML stream download\"></a>\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<sub>LNS1400000020150916.xlsx</sub></p>\n\n<p>You will probably be moving this code to some sort of loop. Adjust the receiving file name accordingly. Each new page should adjust its own form input elements accordingly.</p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1530347895, "creation_date": 1530347895, "answer_id": 51113245, "question_id": 32617167, "link": "https://stackoverflow.com/questions/32617167/extracting-file-url-from-a-hyperlinked-image/51113245#51113245", "title": "Extracting file URL from a Hyperlinked Image", "body": "<p>Once response is  stored in an HTMLDocument object you can use a CSS selector of </p>\n\n<pre><code>#download_xlsx\n</code></pre>\n\n<p>The <code>\"#\"</code> means id.</p>\n\n<p>You can then click on this element </p>\n\n<pre><code>htmlDocument.querySelector(\"#download_xlsx\").Click\n</code></pre>\n\n<hr>\n\n<p><strong>VBA:</strong></p>\n\n<pre><code>Option Explicit\nPublic Sub DownloadFile()\n    Dim ie As New InternetExplorer\n    With ie\n        .Visible = True\n        .navigate \"https://data.bls.gov/timeseries/LNS14000000\"\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        .document.querySelector(\"#download_xlsx\").Click\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Other:</strong></p>\n\n<p>You could even target the form and submit:</p>\n\n<pre><code>.document.forms(\"excel\").submit\n</code></pre>\n\n<p>This triggers the <code>POST</code> request mentioned in the other answer (which is an awesome answer btw).</p>\n"}], "owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 1, "accepted_answer_id": 32620063, "answer_count": 2, "score": 2, "last_activity_date": 1557411592, "creation_date": 1442431982, "last_edit_date": 1557411592, "question_id": 32617167, "link": "https://stackoverflow.com/questions/32617167/extracting-file-url-from-a-hyperlinked-image", "title": "Extracting file URL from a Hyperlinked Image", "body": "<pre><code>Sub DownloadFile() \n\n    Dim myURL As String\n    myURL = \"http://data.bls.gov/timeseries/LNS14000000\"\n    Dim WinHttpReq As Object\n    Set WinHttpReq = CreateObject(\"Microsoft.XMLHTTP\")\n    WinHttpReq.Open \"GET\", myURL, False, \"username\", \"password\"\n    WinHttpReq.send\n\n    myURL = WinHttpReq.responseBody\n    If WinHttpReq.Status = 200 Then\n        Set oStream = CreateObject(\"ADODB.Stream\")\n        oStream.Open\n        oStream.Type = 1\n        oStream.Write WinHttpReq.responseBody\n        oStream.SaveToFile \"C:\\Downloads\\abc.xlsx\", 2\n        oStream.Close\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I am trying to download data using VBA and found this code running pretty well. The webpage URL from which I am trying to download data is the one I have used in the code. Please take a moment and open the webpage as the Excel file I am trying to download is linked in an image and so I am not able to find the URL to download the file from that image. Please advice. Thanks.<a href=\"https://i.stack.imgur.com/GT3FI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GT3FI.png\" alt=\"enter image description here\"></a> </p>\n"}, {"tags": ["vba", "excel", "date-arithmetic"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5343796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af4337dc03aaec3e627177366a47fd09?s=128&d=identicon&r=PG&f=1", "display_name": "kiki", "link": "https://stackoverflow.com/users/5343796/kiki"}, "edited": false, "score": 0, "creation_date": 1442432429, "post_id": 32616988, "comment_id": 53085233, "body": "Hi Jeeped, thank you. I have tried this, but it&#39;s returning rows containing expiry dates 1 year from now and not the desired 2 month range. Thanks though!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 11, "user_id": 5343796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af4337dc03aaec3e627177366a47fd09?s=128&d=identicon&r=PG&f=1", "display_name": "kiki", "link": "https://stackoverflow.com/users/5343796/kiki"}, "edited": false, "score": 0, "creation_date": 1442432719, "post_id": 32616988, "comment_id": 53085391, "body": "If that is the case then you may have dates with swapped MDY vs DMY."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1442433288, "post_id": 32616988, "comment_id": 53085718, "body": "would <code>dateadd(&quot;d&quot;,60,now())</code> work regardless of date style in place of the  <code>now() + 60</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1442433445, "post_id": 32616988, "comment_id": 53085788, "body": "It would work if <code>Now() + 60</code> worked. If the dates are wrong, then they are wrong. They need to be imported properly or manually corrected."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1442433976, "post_id": 32616988, "comment_id": 53086101, "body": "@Jeeped  Thanks, I do not work much with dates and wanted to know if it made a difference."}, {"owner": {"reputation": 11, "user_id": 5343796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af4337dc03aaec3e627177366a47fd09?s=128&d=identicon&r=PG&f=1", "display_name": "kiki", "link": "https://stackoverflow.com/users/5343796/kiki"}, "edited": false, "score": 0, "creation_date": 1442434837, "post_id": 32616988, "comment_id": 53086587, "body": "Thank you both. The dates in the worksheet display in format DMY. But the macro returns rows in DMY as well as in YMD past 60 days, e.g., 2016-05-31. Maybe it has an issue recognizing the date format or the date format is not properly enforced. If I select a date cell in the original it comes up in the function box (sorry don&#39;t know the proper term) as MDY. How do I enforce the date format properly instead of it just displaying DMY but not storing it that way in the cell."}, {"owner": {"reputation": 11, "user_id": 5343796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af4337dc03aaec3e627177366a47fd09?s=128&d=identicon&r=PG&f=1", "display_name": "kiki", "link": "https://stackoverflow.com/users/5343796/kiki"}, "edited": false, "score": 0, "creation_date": 1442436815, "post_id": 32616988, "comment_id": 53087596, "body": "I&#39;ve tried it also with the dateadd function now as well as per Scott&#39;s suggestion and I get the same result as with now() + 60. Why is it not recognizing the dates? I get returns way past 60 days all the way up to 2017."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1442437161, "post_id": 32616988, "comment_id": 53087764, "body": "a) are half of the dates right-aligned in their cells and the other half left-aligned? b) it may be time to redact a portion of the data in the worksheet and post it to a public file repository like Google-Drive or DropBox."}, {"owner": {"reputation": 11, "user_id": 5343796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af4337dc03aaec3e627177366a47fd09?s=128&d=identicon&r=PG&f=1", "display_name": "kiki", "link": "https://stackoverflow.com/users/5343796/kiki"}, "edited": false, "score": 0, "creation_date": 1442438662, "post_id": 32616988, "comment_id": 53088547, "body": "a) the data does not indicate any alignment. they are definitely dates, not text."}, {"owner": {"reputation": 11, "user_id": 5343796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af4337dc03aaec3e627177366a47fd09?s=128&d=identicon&r=PG&f=1", "display_name": "kiki", "link": "https://stackoverflow.com/users/5343796/kiki"}, "edited": false, "score": 0, "creation_date": 1442438714, "post_id": 32616988, "comment_id": 53088565, "body": "b) I will try but I have to desensitize the data first as it is work stuff"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1442431444, "creation_date": 1442431444, "answer_id": 32616988, "question_id": 32616858, "link": "https://stackoverflow.com/questions/32616858/copy-of-rows-of-data-meeting-date-range-criteria-using-vba-excel/32616988#32616988", "title": "Copy of rows of data meeting date range criteria using VBA Excel", "body": "<p>If the following line is working under the old conditions,</p>\n\n<pre><code>If Range(\"H\" &amp; CStr(LSearchRow)).Value &gt; Now() Then\n</code></pre>\n\n<p>... change it to include the new conditions (60 day limit)</p>\n\n<pre><code>If Range(\"H\" &amp; LSearchRow).Value &gt; Now() AND _\n  Range(\"H\" &amp; LSearchRow).Value &lt; Now() + 60 Then\n</code></pre>\n\n<p>The <code>CStr</code> conversion wasn't completely necessary for a simple string concatenation.</p>\n"}], "owner": {"reputation": 11, "user_id": 5343796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af4337dc03aaec3e627177366a47fd09?s=128&d=identicon&r=PG&f=1", "display_name": "kiki", "link": "https://stackoverflow.com/users/5343796/kiki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 839, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1442431444, "creation_date": 1442430870, "question_id": 32616858, "link": "https://stackoverflow.com/questions/32616858/copy-of-rows-of-data-meeting-date-range-criteria-using-vba-excel", "title": "Copy of rows of data meeting date range criteria using VBA Excel", "body": "<p>I'm trying to amend code I have to limit the results copied to another worksheet. Right now everything is copied that is > today. It's comparing an expiry date in Column H with today's date. I want to limit the results to include all rows that include an expiry date of > today AND &lt; today + 60 days. I've tried different ways and functions like defining an end date and used the DateAdd function. Nothing is working, please help! Thank you!</p>\n\n<pre><code>Sub SearchForExpiryDate()\n\n       Dim LSearchRow As Integer\n       Dim LCopyToRow As Integer\n\n       On Error GoTo Err_Execute\n\n       'Start search in row 8\n       LSearchRow = 8\n\n       'Start copying data to row 2 in Expiring MOCs (row counter variable)\n       LCopyToRow = 2\n\n\n       While Len(Range(\"A\" &amp; CStr(LSearchRow)).Value) &gt; 0\n\n\n          'If value in column H &gt; Today, copy entire row to \"Expiring_MOC\"\n          If Range(\"H\" &amp; CStr(LSearchRow)).Value &gt; Now() Then\n\n             'Select row in MOC_MASTER to copy\n             Rows(CStr(LSearchRow) &amp; \":\" &amp; CStr(LSearchRow)).Select\n             Selection.Copy\n\n             'Paste row into \"Expiring_MOCs\" in next row\n             Sheets(\"Expiring_MOCs\").Select\n             Rows(CStr(LCopyToRow) &amp; \":\" &amp; CStr(LCopyToRow)).Select\n             ActiveSheet.Paste\n\n             'Move counter to next row\n             LCopyToRow = LCopyToRow + 1\n\n             'Go back to 'MOC MASTER' to continue searching\n             Sheets(\"MOC_MASTER\").Select\n\n          End If\n\n          LSearchRow = LSearchRow + 1\n\n       Wend\n\n       'Position on cell A3\n       Application.CutCopyMode = False\n       Range(\"A3\").Select\n\n       MsgBox \"All matching data has been copied.\"\n\n       Exit Sub\n\n    Err_Execute:\n       MsgBox \"An error occurred.\"\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "vlookup"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5343642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55c9b59695ce5037fda0401822d347b?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/5343642/scott"}, "edited": false, "score": 0, "creation_date": 1442431345, "post_id": 32616621, "comment_id": 53084658, "body": "Wow, perfect on the first try!  Thank you!  I was hoping I could take the correct answer and modify it to take other actions down to the last row with data.    For example this bit of code enters yesterday&#39;s date into column C starting with row 2:"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 23, "user_id": 5343642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55c9b59695ce5037fda0401822d347b?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/5343642/scott"}, "edited": false, "score": 0, "creation_date": 1442431687, "post_id": 32616621, "comment_id": 53084831, "body": "The <code>lr</code> variable holds the row with the last non-blank value in column A. Nothing else is important as column A is used in the VLOOKUP. If <code>lr</code> was 99 then that <code>.range(.cells(2, 2), .cells(lr, 2))</code> is the same as saying <code>range(&quot;B2:B99&quot;)</code>. The start and end are defined with the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"nofollow noreferrer\">Range.Cells property</a>."}, {"owner": {"reputation": 23, "user_id": 5343642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55c9b59695ce5037fda0401822d347b?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/5343642/scott"}, "edited": false, "score": 0, "creation_date": 1442431862, "post_id": 32616621, "comment_id": 53084918, "body": "Ack... not sure what happened on that last comment.  Text got jacked up.    For example this bit of code enters yesterday&#39;s date into column C starting with row 2 but is limited to the number of rows that had data in column A when I recorded the macro: ActiveCell.FormulaR1C1 = &quot;=(TODAY())-1&quot;  How can I fix this to do what I want it to do down through the rows that have data in column A?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 23, "user_id": 5343642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55c9b59695ce5037fda0401822d347b?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/5343642/scott"}, "edited": false, "score": 0, "creation_date": 1442432231, "post_id": 32616621, "comment_id": 53085110, "body": "Column C would be referenced like <code>.range(.cells(2, 3), .cells(lr, 3))</code> or alternately as I&#39;ve shown above. I also included a way to get a static date that will not change if that is preferred."}, {"owner": {"reputation": 23, "user_id": 5343642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55c9b59695ce5037fda0401822d347b?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/5343642/scott"}, "edited": false, "score": 0, "creation_date": 1442432942, "post_id": 32616621, "comment_id": 53085535, "body": "You win again Jeeped!  I added your code for the date and it just worked first time.  I was also able to mod it slightly to do one more thing I needed to have happen.  Somehow that worked too!  Thanks very much for the prompt replies!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1442432147, "last_edit_date": 1442432147, "creation_date": 1442430005, "answer_id": 32616621, "question_id": 32616408, "link": "https://stackoverflow.com/questions/32616408/vlookup-with-excel-vba-number-of-values-to-look-up-is-variable/32616621#32616621", "title": "VLookup() with Excel VBA - Number of values to look up is variable", "body": "<p>You can skip the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195345.aspx\" rel=\"nofollow\">Range.AutoFill method</a> and just write the formula in all at once.</p>\n\n<pre><code>dim lr as long\nwith activesheet\n    lr = .cells(rows.count, 1).end(xlup).row\n    .range(.cells(2, 2), .cells(lr, 2)).FormulaR1C1 = _\n       \"=VLOOKUP(RC[-1],'[AD Data 9-8-15.xls]showAllUsersReport'!C1:C2,2,FALSE)\"\n    .range(\"C2:C\" &amp; lr).formula = \"=TODAY()-1\"\n    'for a static date (one that will not change tomorrow) use the following instead\n    '.range(\"C2:C\" &amp; lr) = Date - 1\nend with\n</code></pre>\n\n<p>I could not tell where your formula actually <em>started</em> from your sample. This <em>starts</em> in B2 and fills columns B down to the last cell in column A. It looks like your sample <em>might</em> actually start in B1 but I could not be sure.</p>\n"}], "owner": {"reputation": 23, "user_id": 5343642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55c9b59695ce5037fda0401822d347b?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/5343642/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 740, "favorite_count": 0, "accepted_answer_id": 32616621, "answer_count": 1, "score": 2, "last_activity_date": 1442432147, "creation_date": 1442429209, "last_edit_date": 1442431881, "question_id": 32616408, "link": "https://stackoverflow.com/questions/32616408/vlookup-with-excel-vba-number-of-values-to-look-up-is-variable", "title": "VLookup() with Excel VBA - Number of values to look up is variable", "body": "<p>I have a need to use vlookup in File A that references a dataset with two columns (user and country) in File B.  </p>\n\n<p>The number of users in column A of File A varies each time the vlookup is done so I need some VBA code that takes that into account.  What I have so far was built with the macro recorder and works fine so long as the same number of users exists each time the macro is run, which isn't the case.</p>\n\n<p>Here's the code I have so far that does the vlookup and then autofills it on down to row 113.  Like I said this works until I end up with 114+ users and at that point the vlookups just stop.</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n    \"=VLOOKUP(RC[-1],'[AD Data 9-8-15.xls]showAllUsersReport'!C1:C2,2,FALSE)\"\n\nSelection.AutoFill Destination:=Range(\"B2:B113\"), Type:=xlFillDefault\n</code></pre>\n\n<p>Do I need to mod this code or insert something entirely different?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 522, "user_id": 1804650, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/GMxI1.jpg?s=128&g=1", "display_name": "Richard Pullman", "link": "https://stackoverflow.com/users/1804650/richard-pullman"}, "edited": false, "score": 0, "creation_date": 1442429538, "post_id": 32616260, "comment_id": 53083634, "body": "Take a  close look at his explanation for those of you who struggle with Syntax- this clarified a lot for me."}], "tags": [], "owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "is_accepted": true, "score": 2, "last_activity_date": 1442428819, "creation_date": 1442428819, "answer_id": 32616260, "question_id": 32616170, "link": "https://stackoverflow.com/questions/32616170/using-workbook-variable-in-workbooksvariablename-close-statement/32616260#32616260", "title": "Using Workbook Variable in Workbooks(variablename).close Statement`", "body": "<p>Last line should look like this:</p>\n\n<pre><code>JohnnyFootball.Close SaveChanges:=False\n</code></pre>\n\n<p><code>JohnnyFootball</code> is <code>Workbook</code> variable. To get an element from <code>Workbooks</code> collection you have to pass it's name or index.</p>\n"}], "owner": {"reputation": 522, "user_id": 1804650, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/GMxI1.jpg?s=128&g=1", "display_name": "Richard Pullman", "link": "https://stackoverflow.com/users/1804650/richard-pullman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 32616260, "answer_count": 1, "score": 1, "last_activity_date": 1442428819, "creation_date": 1442428555, "question_id": 32616170, "link": "https://stackoverflow.com/questions/32616170/using-workbook-variable-in-workbooksvariablename-close-statement", "title": "Using Workbook Variable in Workbooks(variablename).close Statement`", "body": "<p>The filename changes so I use the wildcard * to refer to it in the Workbooks.Open statement</p>\n\n<p>Last Line of code throws type mismatch error, how can I change the syntax to repair the code?</p>\n\n<pre><code> Dim JohnnyFootball As Workbook\n Workbooks.Open Filename:= _\n    \"T:\\ConA\\RIP\\Extracts\\Reference\" &amp; \"*.xlsx\"     \n    Sheets(\"Sheet1\").Select\n   Set JohnnyFootball = ActiveWorkbook\n   'Other [redacted] code here runs fine\n   'Code below throws type mismatch error\n  Workbooks(JohnnyFootball).Close SaveChanges:=False\n</code></pre>\n"}, {"tags": ["vba", "shell", "excel", "ftp"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1442449692, "post_id": 32615581, "comment_id": 53091848, "body": "Try monitoring to output of the Run command: <code>result = wsh.Run(...</code> then <code>If result&lt;&gt;0 Then MsgBox &quot;Error: &quot; &amp; result</code>"}], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 3277367, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/de50ee6588b71b894a9f0fec4d4e9d43?s=128&d=identicon&r=PG&f=1", "display_name": "Snoobie", "link": "https://stackoverflow.com/users/3277367/snoobie"}, "edited": false, "score": 0, "creation_date": 1442592815, "post_id": 32623533, "comment_id": 53159672, "body": "This worked perfectly.  Thank you so much for teaching me this!"}], "tags": [], "owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "is_accepted": true, "score": 3, "last_activity_date": 1518592123, "last_edit_date": 1518592123, "creation_date": 1442469940, "answer_id": 32623533, "question_id": 32615581, "link": "https://stackoverflow.com/questions/32615581/excel-vba-shell-ftp-logging/32623533#32623533", "title": "Excel VBA Shell FTP Logging", "body": "<p>Redirect the output of the <code>ftp.exe</code> to a file:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>wsh.Run \"%comspec% /c FTP  -i -s:C:\\Temp\\\" &amp; ftpfileName &amp; \".txt &gt; c:\\path\\ftp.log 2&gt;&amp;1\", 1, True\n</code></pre>\n\n<p>See also <a href=\"https://ss64.com/nt/syntax-redirection.html\" rel=\"nofollow noreferrer\">https://ss64.com/nt/syntax-redirection.html</a></p>\n"}], "owner": {"reputation": 183, "user_id": 3277367, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/de50ee6588b71b894a9f0fec4d4e9d43?s=128&d=identicon&r=PG&f=1", "display_name": "Snoobie", "link": "https://stackoverflow.com/users/3277367/snoobie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1080, "favorite_count": 2, "accepted_answer_id": 32623533, "answer_count": 1, "score": 0, "last_activity_date": 1518592123, "creation_date": 1442426462, "last_edit_date": 1442470105, "question_id": 32615581, "link": "https://stackoverflow.com/questions/32615581/excel-vba-shell-ftp-logging", "title": "Excel VBA Shell FTP Logging", "body": "<p>So I have code that creates a sequence of steps in a text file in the temp directory and then executes the shell FTP.  The question I have is, once the shell is launched and is running through the FTP, is it possible to log the FTP results?  Like if a file failed to upload or <em>\"can't find file name\"</em> etc? This way I can be away from the computer while the script is pushing files to the FTP and later look at the log to see what failed and why.</p>\n\n<p>This is my FTP launch command:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub executeFTPBatch(ByVal ftpfileName)\n    Dim wsh As Object\n    Set wsh = VBA.CreateObject(\"WScript.Shell\")\n    wsh.Run \"FTP -i -s:C:\\Temp\\\" &amp; ftpfileName &amp; \".txt\", 1, True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-2013"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3157904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4983a92394862b7b2b4e04abc8a6aa4c?s=128&d=identicon&r=PG&f=1", "display_name": "Minemaster", "link": "https://stackoverflow.com/users/3157904/minemaster"}, "edited": false, "score": 0, "creation_date": 1442518139, "post_id": 32616193, "comment_id": 53125476, "body": "Good thought, and probably should have put this earlier.  The only control in the group header is a textbox that is bound to data, which is the grouping."}], "tags": [], "owner": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "is_accepted": false, "score": 0, "last_activity_date": 1442428619, "creation_date": 1442428619, "answer_id": 32616193, "question_id": 32615484, "link": "https://stackoverflow.com/questions/32615484/continued-group-header/32616193#32616193", "title": "Continued Group Header", "body": "<p>try something like:</p>\n\n<pre><code>Private m_isFirst As Boolean\n\nPrivate Sub GroupHeader0_Format(Cancel As Integer, FormatCount As Integer)\n    m_isFirst = False\n    If m_isFirst Then\n        label1 = \"Header\"\n    Else\n        label1 = \"Header (cont...)\"\n    End If\nEnd Sub\n\nPrivate Sub Report_Load()\n    m_isFirst = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 3157904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4983a92394862b7b2b4e04abc8a6aa4c?s=128&d=identicon&r=PG&f=1", "display_name": "Minemaster", "link": "https://stackoverflow.com/users/3157904/minemaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1442428619, "creation_date": 1442426129, "question_id": 32615484, "link": "https://stackoverflow.com/questions/32615484/continued-group-header", "title": "Continued Group Header", "body": "<p>MS Access 2013</p>\n\n<p>When repeating a group header (not the Page or Report Header), is there a way to change what displays?  </p>\n\n<p>What I have: A report with one group, and in the header section of that group displays the group name.  Group Header \"Repeat Section\" property is set to \"Yes\", which displays the group header each time that group breaks to the next column and/or next page.  This all works fine.</p>\n\n<p>What I'd like to do is:  For the first instance of the group header the group should be displayed (i.e. \"Group 1\").  For each instance after the first, I'd like to add a designation that it is continued (i.e. \"Group 1 (cont.)\").</p>\n\n<p>Anyone have suggestions?\nI don't mind adding in VBA if necessary.</p>\n\n<p>Thanks, Paulie</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 13, "user_id": 5343478, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZJPcXt7EGA8/AAAAAAAAAAI/AAAAAAAAAk4/3nc_0PFSSu0/photo.jpg?sz=128", "display_name": "Mani deep", "link": "https://stackoverflow.com/users/5343478/mani-deep"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1442425341, "post_id": 32615127, "comment_id": 53081228, "body": "i am using nested if;"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1442425399, "post_id": 32615127, "comment_id": 53081261, "body": "Can you restate this part of your question?  I don&#39;t follow what you are saying here. &quot;when i run this code the value instead of incrementation another new value is being added.&quot;"}, {"owner": {"reputation": 13, "user_id": 5343478, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZJPcXt7EGA8/AAAAAAAAAAI/AAAAAAAAAk4/3nc_0PFSSu0/photo.jpg?sz=128", "display_name": "Mani deep", "link": "https://stackoverflow.com/users/5343478/mani-deep"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1442425627, "post_id": 32615127, "comment_id": 53081400, "body": "when I click on the button it is  printing a value &#39;1&#39; on the screen and when i clicking it again another &#39;1&#39; is being printed on the screen after the previous &#39;1&#39;. I need the &#39;1&#39; to be changed as &#39;2&#39; when i click on the button second time."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1442425773, "post_id": 32615127, "comment_id": 53081486, "body": "That is a variable scope issue.  Each time you enter a sub or function the variables local to it are recreated.  You can put your count variable at the top of your form or module above all subs and functions. That will make it global to that particular form or module. Then the function will increment how you expect."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1442425892, "post_id": 32615127, "comment_id": 53081571, "body": "There&#39;s not enough code here to debug this.  I&#39;m guessing you never change the value of <code>count</code>: it will remain zero."}, {"owner": {"reputation": 13, "user_id": 5343478, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZJPcXt7EGA8/AAAAAAAAAAI/AAAAAAAAAk4/3nc_0PFSSu0/photo.jpg?sz=128", "display_name": "Mani deep", "link": "https://stackoverflow.com/users/5343478/mani-deep"}, "edited": false, "score": 0, "creation_date": 1442426145, "post_id": 32615127, "comment_id": 53081719, "body": "Thanks a lot @MathewD its working :D :D"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5343478, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZJPcXt7EGA8/AAAAAAAAAAI/AAAAAAAAAk4/3nc_0PFSSu0/photo.jpg?sz=128", "display_name": "Mani deep", "link": "https://stackoverflow.com/users/5343478/mani-deep"}, "edited": false, "score": 0, "creation_date": 1442427179, "post_id": 32615409, "comment_id": 53082367, "body": "Selection.Range.Text = &quot;[&quot; + count + 1 + &quot;]&quot;   is this line correct?   i need to add paranthesis before and after the number."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 13, "user_id": 5343478, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZJPcXt7EGA8/AAAAAAAAAAI/AAAAAAAAAk4/3nc_0PFSSu0/photo.jpg?sz=128", "display_name": "Mani deep", "link": "https://stackoverflow.com/users/5343478/mani-deep"}, "edited": false, "score": 0, "creation_date": 1442427579, "post_id": 32615409, "comment_id": 53082575, "body": "In VBA &amp; will separate text from variables and the + is to do the math.  Selection.Range.Text = &quot;[&quot; &amp; Count + 1 &amp; &quot;]&quot; I think is what you are looking for. Although I think + will concatenate strings also but try to use them right."}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 0, "last_activity_date": 1442428208, "last_edit_date": 1442428208, "creation_date": 1442425880, "answer_id": 32615409, "question_id": 32615127, "link": "https://stackoverflow.com/questions/32615127/how-to-increment-values-in-ms-word-using-add-in-in-visual-basic/32615409#32615409", "title": "how to increment values in ms word using add-in in visual basic", "body": "<p>That is a variable scope issue. Each time you enter a sub or function the variables local to it are recreated. You can put your count variable at the top of your form or module above all subs and functions. That will make it global to that particular form or module. Then the function will increment how you expect. </p>\n\n<pre><code>Private Count as integer\n\nSub SomeSub()\n    count = count + 1\n    Selection.Range.Text = count \nEnd if\n</code></pre>\n\n<p>In the above code, the first time SomeSub is called it will be one, the second time it is called it will be 2, then 3...</p>\n\n<p>EDIT:\nHere is the OP ended up with that works for them.</p>\n\n<pre><code>Dim count As Integer\nFriend Sub RangeFormat11()\n    Dim document As Word.Document = Me.Application.ActiveDocument\n    Dim Selection = Me.Application.Selection\n    If (count = 0) Then\n        Selection.Range.Text = count + 1\n        count = count + 1\n    Else\n        Selection.Range.Text = count + 1\n        count = count + 1\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 5343478, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZJPcXt7EGA8/AAAAAAAAAAI/AAAAAAAAAk4/3nc_0PFSSu0/photo.jpg?sz=128", "display_name": "Mani deep", "link": "https://stackoverflow.com/users/5343478/mani-deep"}, "is_accepted": false, "score": 0, "last_activity_date": 1442426703, "creation_date": 1442426703, "answer_id": 32615639, "question_id": 32615127, "link": "https://stackoverflow.com/questions/32615127/how-to-increment-values-in-ms-word-using-add-in-in-visual-basic/32615639#32615639", "title": "how to increment values in ms word using add-in in visual basic", "body": "<p>this is new code i used:</p>\n\n<pre><code>Dim count As Integer\nFriend Sub RangeFormat11()\n    Dim document As Word.Document = Me.Application.ActiveDocument\n\n    Dim Selection = Me.Application.Selection\n\n\n    If (count = 0) Then\n        Selection.Range.Text = count + 1\n        count = count + 1\n\n\n    Else\n\n        Selection.Range.Text = count + 1\n        count = count + 1\n\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5343478, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZJPcXt7EGA8/AAAAAAAAAAI/AAAAAAAAAk4/3nc_0PFSSu0/photo.jpg?sz=128", "display_name": "Mani deep", "link": "https://stackoverflow.com/users/5343478/mani-deep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 756, "favorite_count": 1, "accepted_answer_id": 32615409, "answer_count": 2, "score": 1, "last_activity_date": 1442428208, "creation_date": 1442424853, "question_id": 32615127, "link": "https://stackoverflow.com/questions/32615127/how-to-increment-values-in-ms-word-using-add-in-in-visual-basic", "title": "how to increment values in ms word using add-in in visual basic", "body": "<p>'I am trying to increment a value in ms word using add-in in visual basic.\nI am  using this code: </p>\n\n<pre><code>    If (count = 0) Then\n        Selection.Range.Text = count + 1\n\n    Else\n        count = count + 1\n        Selection.Range.Text = count \n    End If\n</code></pre>\n\n<p>when i run this code the value instead of incrementation another new value is being added.</p>\n\n<p>The o/p i am getting is only '1'\nplease help me out with this.I need values to be incremented but not added again.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 2, "creation_date": 1442425618, "post_id": 32615046, "comment_id": 53081392, "body": "<code>...concatenate column B and C with dash and append next row values.</code> Every value in your column E seems to follow this description, with the exception of <code>E4</code> and <code>E8</code>. What is the rule for these two cells?"}, {"owner": {"reputation": 8325, "user_id": 1389663, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f75200201bef9963e90368df0675981?s=128&d=identicon&r=PG", "display_name": "Ninja Cowgirl", "link": "https://stackoverflow.com/users/1389663/ninja-cowgirl"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1442426293, "post_id": 32615046, "comment_id": 53081810, "body": "I added Column D and did a concatenate. Column is just a if formula with concatenate but and it&#39;s not working the way i wanted to work. Row 2 and Row 3 for column E should be empty and Row 3 for column E should be concatenated value since Team 400 duplicates 3 times. and same goes for team 660"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1442426697, "post_id": 32615046, "comment_id": 53082093, "body": "Will the teams (column A) be sorted ascending as in the image?"}, {"owner": {"reputation": 8325, "user_id": 1389663, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f75200201bef9963e90368df0675981?s=128&d=identicon&r=PG", "display_name": "Ninja Cowgirl", "link": "https://stackoverflow.com/users/1389663/ninja-cowgirl"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1442426787, "post_id": 32615046, "comment_id": 53082158, "body": "I can sort it by column A if it&#39;s better for formula"}], "answers": [{"comments": [{"owner": {"reputation": 8325, "user_id": 1389663, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f75200201bef9963e90368df0675981?s=128&d=identicon&r=PG", "display_name": "Ninja Cowgirl", "link": "https://stackoverflow.com/users/1389663/ninja-cowgirl"}, "edited": false, "score": 0, "creation_date": 1442430647, "post_id": 32616432, "comment_id": 53084269, "body": "Let me test this . Thank you mr. hero. and I will let you know in few"}, {"owner": {"reputation": 8325, "user_id": 1389663, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f75200201bef9963e90368df0675981?s=128&d=identicon&r=PG", "display_name": "Ninja Cowgirl", "link": "https://stackoverflow.com/users/1389663/ninja-cowgirl"}, "edited": false, "score": 0, "creation_date": 1442430878, "post_id": 32616432, "comment_id": 53084412, "body": "Genius: Worked in first try. OMG. Thank you so much."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 1, "last_activity_date": 1442429336, "creation_date": 1442429336, "answer_id": 32616432, "question_id": 32615046, "link": "https://stackoverflow.com/questions/32615046/how-to-concatenate-based-on-number-of-duplicates-ms-excel/32616432#32616432", "title": "How to concatenate based on number of duplicates - MS Excel", "body": "<p>This is not possible with formulas. It requires a VBA-based solution.</p>\n\n<p>I wrote a custom routine for you. Please place this in a standard code module:</p>\n\n<pre><code>Public Sub ConcatTeamZones()\n    Const SOURCE = \"A1\"\n    Const OUTPUT = \"E1\"\n    Dim i&amp;, j&amp;, s$, v, w\n    v = Range(SOURCE).CurrentRegion\n    ReDim w(1 To UBound(v), 0)\n    For i = 2 To UBound(w)\n        If v(i, 1) &lt;&gt; v(i - 1, 1) Then\n            w(i - 1, 0) = s\n            s = s &amp; v(i, 2) &amp; \"-\" &amp; v(i, 3)\n            s = \"\"\n        Else\n            s = s &amp; \";\"\n        End If\n        s = s &amp; v(i, 2) &amp; \"-\" &amp; v(i, 3)\n    Next\n    w(i - 1, 0) = s\n    Range(OUTPUT).Resize(UBound(w)) = w\nEnd Sub\n</code></pre>\n\n<p>And then from the worksheet with your team data, press ALT-F8 to bring up the Macro Dialog. Run the ConcatTeamZones macro.</p>\n\n<p>Note 1: this assumes that column A is sorted.</p>\n\n<p>Note 2: You can edit the first two lines to specify which columns contains the source (team data) and which column you wish the output.</p>\n"}, {"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1442434665, "creation_date": 1442434665, "answer_id": 32617908, "question_id": 32615046, "link": "https://stackoverflow.com/questions/32615046/how-to-concatenate-based-on-number-of-duplicates-ms-excel/32617908#32617908", "title": "How to concatenate based on number of duplicates - MS Excel", "body": "<p>It can be done using formulas, <em>it\u2019s just a matter of perspective</em>:</p>\n\n<p><em>Assuming data is sorted by Team</em></p>\n\n<p>This formula gives the concatenated result with the maximum of combinations on top. Enter this formula in cell <code>E2</code> and copy till last record.</p>\n\n<pre><code>=CONCATENATE($D2,IF(EXACT($A2,$A3),\";\"&amp;$E3,\"\"))\n</code></pre>\n\n<p>To assign the max possible combinations to each Team enter this formula in <code>F2</code> and copy till last record.</p>\n\n<pre><code>=INDEX($E:$E,MATCH($A2,$A:$A,0),0)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/icaq8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/icaq8.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5343114, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-88PkWjIDHnM/AAAAAAAAAAI/AAAAAAAAAP0/x5RG4xrTm7k/photo.jpg?sz=128", "display_name": "William Flynn", "link": "https://stackoverflow.com/users/5343114/william-flynn"}, "is_accepted": false, "score": 0, "last_activity_date": 1442444134, "creation_date": 1442444134, "answer_id": 32620078, "question_id": 32615046, "link": "https://stackoverflow.com/questions/32615046/how-to-concatenate-based-on-number-of-duplicates-ms-excel/32620078#32620078", "title": "How to concatenate based on number of duplicates - MS Excel", "body": "<p>Here's how I would do it...</p>\n\n<p>Cell \"A1\": =COUNTIF(B$2:B2,B2)&amp;B2   - This is to create a unique key. Copy down the length of your table</p>\n\n<p>Then I would use an advanced query (with vba maybe) to create a list of unique values for team in the \"F\" column</p>\n\n<p>Cell \"G2\": =VLOOKUP(\"1\"&amp;F2,A:D,3,0)&amp;\"-\"&amp;VLOOKUP(\"1\"&amp;F2,A:D,4,0)&amp;IF(ISERROR(VLOOKUP(\"2\"&amp;F2,A:D,3,0)),\"\",\",  \"&amp;VLOOKUP(\"2\"&amp;F2,A:D,3,0)&amp;\"-\"&amp;VLOOKUP(\"2\"&amp;F2,A:D,4,0))&amp;IF(ISERROR(VLOOKUP(\"3\"&amp;F2,A:D,3,0)),\"\",\",  \"&amp;VLOOKUP(\"3\"&amp;F2,A:D,3,0)&amp;\"-\"&amp;VLOOKUP(\"3\"&amp;F2,A:D,4,0))&amp;IF(ISERROR(VLOOKUP(\"4\"&amp;F2,A:D,3,0)),\"\",\",  \"&amp;VLOOKUP(\"4\"&amp;F2,A:D,3,0)&amp;\"-\"&amp;VLOOKUP(\"4\"&amp;F2,A:D,4,0))</p>\n\n<p>This function creates your combined references. It would be longer if you expected more than 4 occurrences of teams.</p>\n\n<p>Just copy \"IF(ISERROR(VLOOKUP(\"4\"&amp;F2,A:D,3,0)),\"\",\",  \"&amp;VLOOKUP(\"4\"&amp;F2,A:D,3,0)&amp;\"-\"&amp;VLOOKUP(\"4\"&amp;F2,A:D,4,0))\" and change the \"4\" to \"5\" etc</p>\n\n<p>You could hide column A (to tidy up).</p>\n\n<p>Sorry, I tried to include an image but insufficient reputation :-)</p>\n"}], "owner": {"reputation": 8325, "user_id": 1389663, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f75200201bef9963e90368df0675981?s=128&d=identicon&r=PG", "display_name": "Ninja Cowgirl", "link": "https://stackoverflow.com/users/1389663/ninja-cowgirl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1292, "favorite_count": 0, "accepted_answer_id": 32616432, "answer_count": 3, "score": -1, "last_activity_date": 1442444134, "creation_date": 1442424547, "last_edit_date": 1531161705, "question_id": 32615046, "link": "https://stackoverflow.com/questions/32615046/how-to-concatenate-based-on-number-of-duplicates-ms-excel", "title": "How to concatenate based on number of duplicates - MS Excel", "body": "<p>Is there a way to concatenate multiple columns if the a row is duplicate? I have a spreadsheet where column A has duplicate team but there area and LD  (column b and c) are different value. I would like to have a formulate at column E where it will concatenate column B and C with dash and append next row values. See the attached picture highlighted row E. Any idea how to do this with excel formula or may be VBA.  I tried this formula in column E =IF(A3=A4,D3&amp;\";\"&amp;D4) but it returns false for the last duplicate row.</p>\n\n<p><a href=\"https://i.stack.imgur.com/p32Kh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p32Kh.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "resize", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1972, "user_id": 1304458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ea084fbd20a88381173e9aaf4de00?s=128&d=identicon&r=PG", "display_name": "xyz", "link": "https://stackoverflow.com/users/1304458/xyz"}, "is_accepted": false, "score": 0, "last_activity_date": 1442446813, "creation_date": 1442446813, "answer_id": 32620468, "question_id": 32614803, "link": "https://stackoverflow.com/questions/32614803/post-back-entire-rom-of-match-not-just-matched-value/32620468#32620468", "title": "Post Back entire rom of match not just matched value", "body": "<p>After many hours I came up with</p>\n\n<pre><code>Function GetRowRangeOfCell(FindRange As Range)\n    Set GetRowRangeOfCell = FindRange.Offset(0, -(FindRange.Column - 1)).Resize(1,  FindRange.CurrentRegion.Columns.Count)\nEnd Function\n</code></pre>\n\n<p>Then used it this way</p>\n\n<pre><code>GetRowRangeOfCell(fCell).Copy Destination:=PostBackWS.Range(fCell.Address).Offset(0, -(fCell.Column - 1) + LC)\n</code></pre>\n"}], "owner": {"reputation": 1972, "user_id": 1304458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ea084fbd20a88381173e9aaf4de00?s=128&d=identicon&r=PG", "display_name": "xyz", "link": "https://stackoverflow.com/users/1304458/xyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1442446813, "creation_date": 1442423747, "last_edit_date": 1531164843, "question_id": 32614803, "link": "https://stackoverflow.com/questions/32614803/post-back-entire-rom-of-match-not-just-matched-value", "title": "Post Back entire rom of match not just matched value", "body": "<p>The matching code post back the value of a match (if it exist) on the row of the match I need to post back the <code>entire row</code> of the match not just the <code>match</code></p>\n\n<p>But I am not getting how to <code>Resize</code></p>\n\n<p>Thanks</p>\n\n<pre><code>Sub FindMatches()\nDim PostBackWS As Worksheet\nDim FindRng As Range, ReplaceRng As Range, fCell As Range, rCell As Range\nDim LC as Long\n\nSet FindRng = GetRange(\"OriginalData\", \"A\", \"B\", \"B\", 2, False)\nSet ReplaceRng = GetRange(\"NewData_Prepped\", \"A\", \"AA\", \"AA\", 2, False)\nSet PostBackWS = ThisWorkbook.Sheets(\"XXX\")\n\nLC = Sheets(\"OriginalData\").Cells(1, Columns.Count).End(xlToLeft).Column\n\n For Each fCell In FindRng\n    If DoesMatchExists(fCell, ReplaceRng) = True Then\n\n       'This posts back the matched cell value\n        'PostBackWS.Range(fCell.Address).Value = fCell.Value\n\n       'I want to post back the entire row of matched cell\n        PostBackWS.Range(fCell.Address) =  Sheets(\"OriginalData\").Range(fCell.Address).Resize(1, LC)\n\n        'I have also tried\n         PostBackWS.Range(fCell.Address).Offset(0, 1) = fCell.EntireRow\n\n    End If\nNext fCell\nEnd Sub\n</code></pre>\n\n<p>The UDFs</p>\n\n<pre><code>Function DoesMatchExists(ByVal FindValue As String, LookInRange As Range) As   Boolean\n    DoesMatchExists = Not LookInRange.Find(FindValue, , xlValues, xlWhole, xlByRows, xlNext, MatchCase:=False) Is Nothing\nEnd Function\n\nFunction GetRange(shtName As String, lcLetter As String, ColLetter1 As String, ColLetter2 As String, Optional startRow As Long = 2, Optional absRange   As Boolean = False) As Range\nDim LastCellRow As Object\nDim ws As Worksheet\nDim LastRow As Long, LastColRow As Long\n\nSet ws = ThisWorkbook.Sheets(shtName)\n\nSelect Case absRange\nCase False\n  With ws\n          LastRow = .Range(lcLetter &amp; .Rows.Count).End(xlUp).Row\n     Set GetRange = .Range(.Cells(startRow, ColLetter1), .Cells(LastRow, ColLetter2))\n  End With\n\nCase True\n  With ws\n       Set LastCellRow = .Cells.Find(what:=\"*\", _\n                          After:=.Range(\"A1\"), _\n                          LookAt:=xlPart, _\n                          LookIn:=xlFormulas, _\n                          SearchOrder:=xlByRows, _\n                          SearchDirection:=xlPrevious, _\n                          MatchCase:=False)\n           LastRow = LastCellRow.Row\n\n      Set GetRange = .Range(.Cells(startRow, ColLetter1), .Cells(LastRow, ColLetter2))\n  End With\nEnd Select\n</code></pre>\n\n<p>End Function</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "edited": false, "score": 0, "creation_date": 1442423278, "post_id": 32614586, "comment_id": 53080111, "body": "Can you post the sample of FullHTML where the BPlan value is?"}, {"owner": {"reputation": 11, "user_id": 5339633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24b0236cf0c20f20d9f20bb3e1a8f574?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Dole", "link": "https://stackoverflow.com/users/5339633/bob-dole"}, "reply_to_user": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "edited": false, "score": 0, "creation_date": 1442423379, "post_id": 32614586, "comment_id": 53080167, "body": "Okay <a href=\"http://finance.yahoo.com/q/pr?s=AAPL+Profile\" rel=\"nofollow noreferrer\">finance.yahoo.com/q/pr?s=AAPL+Profile</a>"}, {"owner": {"reputation": 11, "user_id": 5339633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24b0236cf0c20f20d9f20bb3e1a8f574?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Dole", "link": "https://stackoverflow.com/users/5339633/bob-dole"}, "edited": false, "score": 0, "creation_date": 1442423699, "post_id": 32614586, "comment_id": 53080358, "body": "yes that is my question that I solved, and now I have a new question"}], "answers": [{"tags": [], "owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "is_accepted": false, "score": 1, "last_activity_date": 1442425086, "creation_date": 1442425086, "answer_id": 32615199, "question_id": 32614586, "link": "https://stackoverflow.com/questions/32614586/instr-returns-0-excel-vba/32615199#32615199", "title": "Instr returns 0 Excel VBA", "body": "<p>What i had to do to get this to run and update was change the FO and LO to data type long because the location was greater than the maximum value of an integer variable.</p>\n\n<pre><code>Sub ImportBPlans()\nDim BPlan As String, FullHTML As String, URL1 As String, Cut1 As String,  T1   As String\nDim FO As Long, LO As Long\n\nFor i = 2 To LastRow\n\n    T1 = WB1.Cells(i, 1).Value\n\n\n\n    URL1 = \"http://finance.yahoo.com/q/pr?s=\" + T1 + \"+Profile\"\n    FullHTML = GetHTML(URL1)\n    BPlan = \"&amp;nbsp;&lt;/th&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;\"\n    x = Len(FullHTML)\n\n    FO = InStr(1, FullHTML, BPlan, vbTextCompare) + Len(BPlan)\n    LO = InStr(FO, FullHTML, \"&lt;\")\n    Cut1 = Left(FullHTML, LO)\n    Cut1 = Right(Cut1, FO - LO)\n    WB5.Cells(i, 1).Value = Cut1\n\nNext i\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": true, "score": 0, "last_activity_date": 1442431217, "last_edit_date": 1442431217, "creation_date": 1442427328, "answer_id": 32615812, "question_id": 32614586, "link": "https://stackoverflow.com/questions/32614586/instr-returns-0-excel-vba/32615812#32615812", "title": "Instr returns 0 Excel VBA", "body": "<p>In the past I've had trouble doing what your trying. It seems that either MSHTML or MSXTML or both modify the raw HTML, which makes parsing it an \"adventure\". To get your code to work I modified your line:</p>\n\n<pre><code>BPlan = \"&amp;nbsp;&lt;/th&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;\"\n</code></pre>\n\n<p>to</p>\n\n<pre><code>BPlan = \"&amp;nbsp;&lt;/th&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;\" &amp; vbCrLf &amp; \"&lt;p&gt;\"\n</code></pre>\n\n<p>Where did the extra <code>&lt;/tbody&gt;</code> and <code>vbCrLf</code> come from? Dunno. I don't see them when I look at the raw HTML source with a browser, but they are definitely in <code>FullHTML</code>. Bob Dole's <code>BPlan</code> seems like it should have worked --- doing a browser FIND on the source HTML for Dole's <code>BPlan</code> succeeds. If someone can explain this, and knows how to reliably parse HTML with these tools, I'd love to learn!</p>\n"}], "owner": {"reputation": 11, "user_id": 5339633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24b0236cf0c20f20d9f20bb3e1a8f574?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Dole", "link": "https://stackoverflow.com/users/5339633/bob-dole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 32615812, "answer_count": 2, "score": -1, "last_activity_date": 1442431217, "creation_date": 1442422908, "question_id": 32614586, "link": "https://stackoverflow.com/questions/32614586/instr-returns-0-excel-vba", "title": "Instr returns 0 Excel VBA", "body": "<p>The first Instr() function gives me a zero even though the substring is clearly within the string as I have checked on Yahoos website. Please help me.</p>\n\n<pre><code>Sub ImportBPlans()\nDim BPlan As String, FullHTML As String, URL1 As String, Cut1 As String,  T1   As String\nDim FO As Integer, LO As Integer\n\nFor i = 2 To LastRow\n\n    T1 = WB1.Cells(i, 1).Value\n\n\n\n    URL1 = \"http://finance.yahoo.com/q/pr?s=\" + T1 + \"+Profile\"\n    FullHTML = GetHTML(URL1)\n    BPlan = \"&amp;nbsp;&lt;/th&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;\"\n    x = Len(FullHTML)\n\n    FO = InStr(1, FullHTML, BPlan, vbTextCompare) + Len(BPlan)\n    LO = InStr(FO, FullHTML, \"&lt;\")\n    Cut1 = Left(FullHTML, LO)\n    Cut1 = Right(Cut1, FO - LO)\n    WB5.Cells(i, 1).Value = Cut1\n\nNext i\n\n\nEnd Sub\n\nFunction GetHTML(URL As String) As String\n    Dim HTML As String\n    Dim htmlBDY As New HTMLDocument\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", URL, False\n        .Send\n        htmlBDY.body.innerHTML = .responseText\n        GetHTML = htmlBDY.body.outerHTML\n    End With\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "where-clause"], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 2953175, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0500ba05552072c5d8813884535839?s=128&d=identicon&r=PG&f=1", "display_name": "ppw", "link": "https://stackoverflow.com/users/2953175/ppw"}, "edited": false, "score": 0, "creation_date": 1442474290, "post_id": 32616273, "comment_id": 53099043, "body": "Still no joy Clint, the query doesn&#39;t error, but I still get a &#39;0&#39; returned from it. Thanks anyway for your suggestion."}, {"owner": {"reputation": 339, "user_id": 5042263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4GD2iGS817g/AAAAAAAAAAI/AAAAAAAAAd4/o-nfiJZs8Us/photo.jpg?sz=128", "display_name": "Clint Street", "link": "https://stackoverflow.com/users/5042263/clint-street"}, "reply_to_user": {"reputation": 155, "user_id": 2953175, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0500ba05552072c5d8813884535839?s=128&d=identicon&r=PG&f=1", "display_name": "ppw", "link": "https://stackoverflow.com/users/2953175/ppw"}, "edited": false, "score": 0, "creation_date": 1442508037, "post_id": 32616273, "comment_id": 53119874, "body": "@ppw I have another suggestion that I have used in access with Null."}, {"owner": {"reputation": 339, "user_id": 5042263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4GD2iGS817g/AAAAAAAAAAI/AAAAAAAAAd4/o-nfiJZs8Us/photo.jpg?sz=128", "display_name": "Clint Street", "link": "https://stackoverflow.com/users/5042263/clint-street"}, "reply_to_user": {"reputation": 155, "user_id": 2953175, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0500ba05552072c5d8813884535839?s=128&d=identicon&r=PG&f=1", "display_name": "ppw", "link": "https://stackoverflow.com/users/2953175/ppw"}, "edited": false, "score": 0, "creation_date": 1442508469, "post_id": 32616273, "comment_id": 53120101, "body": "Sorry never seen your answer below before I posted."}], "tags": [], "owner": {"reputation": 339, "user_id": 5042263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4GD2iGS817g/AAAAAAAAAAI/AAAAAAAAAd4/o-nfiJZs8Us/photo.jpg?sz=128", "display_name": "Clint Street", "link": "https://stackoverflow.com/users/5042263/clint-street"}, "is_accepted": false, "score": 1, "last_activity_date": 1442507960, "last_edit_date": 1442507960, "creation_date": 1442428849, "answer_id": 32616273, "question_id": 32614553, "link": "https://stackoverflow.com/questions/32614553/excel-sql-query-where-somefield-is-null-not-working-correctly/32616273#32616273", "title": "Excel SQL Query - Where (somefield) is null - not working correctly", "body": "<p>I am just guessing here try this:</p>\n\n<pre><code>strQuery = \"Select Count(IIF(ReviewDate is null,0,ReviewDate)) as UnassignedCount FROM [PatComDB$] Where  ReviewDate = 0\"\n</code></pre>\n\n<p>Since the above did not work try this I have used this in an access database because sometimes the data is not null it is blank instead.</p>\n\n<pre><code> strQuery = \"Select Count(ReviewDate) as UnassignedCount FROM [PatComDB$] \n Where ReviewDate is Null Or \" &amp; Char(34) &amp; Char(34)\n</code></pre>\n\n<p>Not sure if it will work for an excel query. Worth a shot</p>\n"}, {"tags": [], "owner": {"reputation": 155, "user_id": 2953175, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0500ba05552072c5d8813884535839?s=128&d=identicon&r=PG&f=1", "display_name": "ppw", "link": "https://stackoverflow.com/users/2953175/ppw"}, "is_accepted": true, "score": 1, "last_activity_date": 1442497722, "creation_date": 1442497722, "answer_id": 32631989, "question_id": 32614553, "link": "https://stackoverflow.com/questions/32614553/excel-sql-query-where-somefield-is-null-not-working-correctly/32631989#32631989", "title": "Excel SQL Query - Where (somefield) is null - not working correctly", "body": "<p>Figured out the answer myself after a few more attempts at code variations.</p>\n\n<p>I had to change the count column to a column with data in for it to work correctly (In this case I used the Index field which will never be empty) Code used is below.</p>\n\n<pre><code>strQuery = \"Select Count(Index) as UnassignedCount FROM [PatComDB$] \nWhere ReviewDate = Null OR ReviewDate = 0 OR ReviewDate is null\"\n</code></pre>\n\n<p>I used some suggestions from answers here and other answers from my research to make sure I capture every eventuality of an empty cell (I think).</p>\n"}], "owner": {"reputation": 155, "user_id": 2953175, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0500ba05552072c5d8813884535839?s=128&d=identicon&r=PG&f=1", "display_name": "ppw", "link": "https://stackoverflow.com/users/2953175/ppw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5339, "favorite_count": 0, "accepted_answer_id": 32631989, "answer_count": 2, "score": 0, "last_activity_date": 1442507960, "creation_date": 1442422792, "last_edit_date": 1442475540, "question_id": 32614553, "link": "https://stackoverflow.com/questions/32614553/excel-sql-query-where-somefield-is-null-not-working-correctly", "title": "Excel SQL Query - Where (somefield) is null - not working correctly", "body": "<p>Having a bit of trouble with an Excel SQL Query where clause.</p>\n\n<p>The data in my sheet within excel (as far as I can see) is empty, there are no values and no formatting etc. in the cell.\nI am trying to run the following query from Outlook (in VBA).</p>\n\n<pre><code>strQuery = \"Select Count(ReviewDate) as UnassignedCount FROM [PatComDB$]\nWhere ReviewDate is null \"\n</code></pre>\n\n<p>But the query is returning 0.</p>\n\n<p>I have searched for some solutions and have tried the below.</p>\n\n<pre><code>strQuery = \"Select Count(ReviewDate) as UnassignedCount FROM [PatComDB$]\nWhere IIF(ReviewDate is null,0,ReviewDate) \"\n</code></pre>\n\n<p>(Which returns 7 - the count of the field that is not null)</p>\n\n<p>And have had no luck.</p>\n\n<p>My connection clause is as follows (if it is any use)</p>\n\n<pre><code>Set Con = New ADODB.Connection\nWith Con\n    .Provider = \"Microsoft.Jet.OLEDB.4.0\"\n    .ConnectionString = \"Data Source=&lt;some link&gt;;\" &amp; _\n        \"Extended Properties=Excel 8.0;\"\n    .Open\nEnd With\n</code></pre>\n\n<p>and my sheet looks something like this</p>\n\n<pre><code>IdeaID      RPA     Type        SubDate     ReviewDate\n\nIdeaID1     RPA1234 Existing    01/01/2015  \nIdeaID2     RPA1235 New         02/01/2015  \nIdeaID3     RPA1236 Existing    03/01/2015  \nIdeaID4     RPA0001 New         04/01/2015  01/09/2015\nIdeaID5     RPA0001 New         05/01/2015  02/09/2015\nIdeaID6     RPA0001 New         06/01/2015  07/09/2015\nIdeaID7     RPA0001 New         07/01/2015  07/09/2015\nIdeaID8     RPA0001 New         08/01/2015  07/09/2015\nIdeaID9     RPA0001 New         09/01/2015  07/09/2015\nIdeaID10    RPA0001 New         10/01/2015  07/09/2015\n</code></pre>\n\n<p>Does anyone have any ideas where I could be going wrong, be it my query or the data in my sheet perhaps?</p>\n\n<p>Note: I am unfortunately restricted to Outlook and Excel in terms of software.</p>\n\n<p>Thanks in advance.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Forgot to mention that running the following query on the same data set returns NULL</p>\n\n<pre><code>strQuery = \"Select * FROM [PatComDB$] Where Index = 1\"\nrsARR = rs.GetRows\nDebug.Print (rsARR(6, 0))\n</code></pre>\n"}, {"tags": ["xml", "vba"], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 0, "last_activity_date": 1442435866, "creation_date": 1442435866, "answer_id": 32618229, "question_id": 32614339, "link": "https://stackoverflow.com/questions/32614339/ms-access-vba-handle-line-feed-characters-from-xml/32618229#32618229", "title": "MS Access VBA handle line feed characters from XML", "body": "<p>What you are referring to is actually whitespace, not linefeeds. You can restyle the XML using XSLT. Then, the whitespace within an attribute value an be handled with XSLT's <code>normalize-space()</code> function. </p>\n\n<p>As background, <a href=\"http://www.w3schools.com/xsl/\" rel=\"nofollow\">XSLT</a> is a special-purpose declarative language to transform/style XML to any restructured format. In VBA (like many other programming languages), you can load XSLT externally (just like your XML file) or as an inline string. Below is the external file route:</p>\n\n<p><strong>XSLT</strong> (almost an identity transform to clone structure but removing white space in attribute value)</p>\n\n<pre><code>&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"&gt; \n&lt;xsl:output method=\"xml\" indent=\"yes\" omit-xml-declaration=\"yes\"/&gt;\n\n&lt;xsl:template match=\"node()\"&gt; \n     &lt;xsl:copy&gt; \n         &lt;xsl:apply-templates select=\"@* | node()\"/&gt; \n     &lt;/xsl:copy&gt; \n&lt;/xsl:template&gt;\n\n&lt;xsl:template match=\"@*\"&gt; \n     &lt;xsl:attribute name=\"{name()}\"&gt; \n         &lt;xsl:value-of select=\"normalize-space()\"/&gt; \n     &lt;/xsl:attribute&gt; \n&lt;/xsl:template&gt; \n\n&lt;/xsl:stylesheet&gt;\n</code></pre>\n\n<p><strong>VBA</strong> (loads both .config xml and .xsl file in wrkInFolder and transforms into outputted .config file)</p>\n\n<pre><code>Dim XMLDoc As New MSXML2.DOMDocument60\nDim XSLDoc As New MSXML2.DOMDocument60\nDim OutputXML As New MSXML2.DOMDocument60\n\nDim wrkInFolder As String, wrkInFullPath As String \nDim wrkOutFolder As String, wrkOutFullPath As String\n\n'---- Set up the I/O Paths \nwrkInFolder = \"D:\\mypath\\\" \nwrkInFullPath = wrkInFolder &amp; \"xmltest.config\"\nwrkOutFolder = wrkInFolder \nwrkOutFullPath = wrkOutFolder &amp; \"xmltest-out.config\"\n\n'---- Load xml data\nXMLDoc.async = False\nXMLDoc.Load wrkInFullPath\n\n'---- Load xslt stylesheet\nXSLDoc.async = False\nXSLDoc.Load wrkInFolder &amp; \"xslfile.xsl\"     ' SAVE ABOVE EXTERNALLY IN .xsl FORMAT\n\n'---- Do the transform\nXMLDoc.transformNodeToObject XSLDoc, OutputXML\nOutputXML.Save wrkOutFullPath\n</code></pre>\n"}], "owner": {"reputation": 686, "user_id": 1806671, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496b2d17e3c896a47db0ff2c51cc2444?s=128&d=identicon&r=PG", "display_name": "wayfarer", "link": "https://stackoverflow.com/users/1806671/wayfarer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 32618229, "answer_count": 1, "score": 0, "last_activity_date": 1442435866, "creation_date": 1442422111, "question_id": 32614339, "link": "https://stackoverflow.com/questions/32614339/ms-access-vba-handle-line-feed-characters-from-xml", "title": "MS Access VBA handle line feed characters from XML", "body": "<p>I'm updating a small xml file.  The input has line breaks within an attribute, as shown here:</p>\n\n<pre><code> &lt;foo&gt;\n  &lt;add name=\"bar\"\n    attr1=\"aaaa;\n    bbbbb;\n    cccc\"/&gt;\n &lt;/foo&gt;\n</code></pre>\n\n<p>The output, however, looks like this (with &#xA; line feeds)</p>\n\n<pre><code>&lt;foo&gt;\n    &lt;add name=\"bar\" attr1=\"aaaa;&amp;#xA;   bbbbb;&amp;#xA; cccc\"/&gt;\n&lt;/foo&gt;\n</code></pre>\n\n<p>I've tried several ways to locate and remove the line feeds.</p>\n\n<p>A workaround is to not have the line feeds in the input.  However, I'd like to leave the line feeds in the input, for readability.  I'd prefer to leave them in the output also, however, that's not necessary.</p>\n\n<p>How might I control the line feeds in the output, either by having them be \"real\" line feeds, or deleting them?</p>\n\n<p>Below is the test routine which replicates the problem; it does no data update, like the real routine does.  The real routine works fine except for the line feeds.</p>\n\n<pre><code>Sub Test()\nOn Error GoTo ErrTrap:\nDim XMLDoc As New MSXML2.DOMDocument60\n\nDim wrkInFolder As String\nDim wrkInFullPath As String\nDim wrkOutFolder As String\nDim wrkOutFullPath As String\n\nDim wrkCSNode As IXMLDOMNode\nDim wrkDataCS As IXMLDOMNode\nDim wrkAttr As IXMLDOMAttribute\n\nDim wrkInVal As String\nDim wrkOutVal As String\n\n'---- set up the I/O Paths\nwrkInFolder = \"D:\\mypath\\\"\nwrkInFullPath = wrkInFolder &amp; \"xmltest.config\"\nwrkOutFolder = wrkInFolder\nwrkOutFullPath = wrkOutFolder &amp; \"xmltest-out.config\"\n\n'---- get the doc\nXMLDoc.Load (wrkInFullPath)\n\n'--- get conn str node\nSet wrkCSNode = XMLDoc.SelectSingleNode(\"foo\")\n'--- first child node (base 0)\n Set wrkDataCS = wrkCSNode.ChildNodes(0)\n '--- first attribute (base 0)\n Set wrkAttr = wrkDataCS.Attributes(0)\n\n '---- get the value of the attribute\n wrkInVal = wrkAttr.NodeValue\n\n wrkOutVal = Replace(wrkInVal, \"&amp;#xA;\", \"\")\n p1 = InStr(wrkOutVal, \"&amp;#xA;\")\n If p1 &lt;&gt; 0 Then\n      MsgBox (\"Found line feed\")\n End If\n\n wrkAttr.NodeValue = wrkOutVal\n\n XMLDoc.Save (wrkOutFullPath)\n\n On Error GoTo 0\n Exit Sub\n</code></pre>\n\n<p>ErrTrap:\n    Dim exmsg As String\n    exmsg = Err.Description\n    Dim wrkStop As String\n    wrkStop = \"\"\n    On Error GoTo 0</p>\n\n<p>End Sub</p>\n"}, {"tags": ["forms", "vba", "label", "copy-paste"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1442422419, "post_id": 32613993, "comment_id": 53079614, "body": "Use a text box styled to look like a label?"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1442425144, "post_id": 32613993, "comment_id": 53081101, "body": "You could copy the label.caption to the clipboard in the label click event."}], "answers": [{"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1442425313, "creation_date": 1442425313, "answer_id": 32615258, "question_id": 32613993, "link": "https://stackoverflow.com/questions/32613993/selectable-text-on-vba-form/32615258#32615258", "title": "Selectable text on VBA form", "body": "<p>You could copy the label.caption to the clipboard in the label click event.</p>\n\n<pre><code>Private Sub Label1_Click()\n    With New MSForms.DataObject\n        .SetText Label1.Caption\n        .PutInClipboard\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1364, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1442425313, "creation_date": 1442420871, "question_id": 32613993, "link": "https://stackoverflow.com/questions/32613993/selectable-text-on-vba-form", "title": "Selectable text on VBA form", "body": "<p>I am using the following code to copy a label's text to the clipboard when a button is clicked:</p>\n\n<pre><code>Private Sub CopyToClipBoardButton_Click()\n\n    CopyText labelName\n\nEnd Sub\n</code></pre>\n\n<p>But instead of clicking the button,I wish I could directly select the text on the form and right click the mouse button to copy it. Is it possible? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1442421153, "post_id": 32613984, "comment_id": 53078853, "body": "One reason the debug is greyed out is that the vba is password protected.  IF this is the case remove the password protection and reopen the file."}], "owner": {"reputation": 505, "user_id": 4983280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1cdfa48482a093d4c9855b274aa98dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark harris", "link": "https://stackoverflow.com/users/4983280/mark-harris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1442420838, "creation_date": 1442420838, "question_id": 32613984, "link": "https://stackoverflow.com/questions/32613984/vba-code-conflict-with-excel-2010-and-excel-2013", "title": "VBA code conflict with excel 2010 and excel 2013", "body": "<p>When i open my excel spreadsheet with vba code in excel 2010 I get no errors, however, when i open my spreadsheet in excel 2013 i get an error saying run time error 53, 'file not found'.</p>\n\n<p>I am not sure which part of my code is giving me an error as when the message pops up in excel 2013 the option to debug is greyed out.</p>\n\n<p>Does anyone know why this is?</p>\n\n<p>Can I use a cross excel supported code to open files?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1442420708, "post_id": 32613860, "comment_id": 53078553, "body": "Look at Range(currentrow).Find What=&quot;Approved/Closed&quot; Then get the date from the previous column."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1442420920, "post_id": 32613860, "comment_id": 53078682, "body": "Do closed tickets ever get re-opened?"}, {"owner": {"reputation": 15, "user_id": 5342639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aa6f11e183b45e6f4f5001d3c94c612?s=128&d=identicon&r=PG&f=1", "display_name": "hockey1020", "link": "https://stackoverflow.com/users/5342639/hockey1020"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1442421332, "post_id": 32613860, "comment_id": 53078960, "body": "@MatthewD  Good question, they do get re-opened.  So it literally would need to be the last cell in the row compared to searching for the first &quot;Approved/Closed&quot;  Thanks for quick response!"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1442421376, "post_id": 32613860, "comment_id": 53078996, "body": "There is a .findnext. You will need a loop. I&#39;m on a phone so it&#39;s a bit difficult to answer questions right this minute. I&#39;m sure Tim or somebody can provide and example."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1442421638, "creation_date": 1442421638, "answer_id": 32614197, "question_id": 32613860, "link": "https://stackoverflow.com/questions/32613860/dynamically-find-last-cell-with-text-in-every-row/32614197#32614197", "title": "Dynamically find last cell with text in every row", "body": "<p>Entered in (eg) A3 this will pick up the \"closed\" date provided the last populated column in the row is \"Approved/Closed\"</p>\n\n<pre><code>=IF(INDEX(3:3,1,MAX((LEN(B3:KZ3)&gt;0)*COLUMN(B3:KZ3)))=\"Approved/Closed\",\n    INDEX(3:3,1,MAX((LEN(B3:KZ3)&gt;0)*COLUMN(B3:KZ3))-1),\"\")\n</code></pre>\n\n<p>An array formula, so use Ctrl+Shift+Enter when entering it.</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 5342639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aa6f11e183b45e6f4f5001d3c94c612?s=128&d=identicon&r=PG&f=1", "display_name": "hockey1020", "link": "https://stackoverflow.com/users/5342639/hockey1020"}, "edited": false, "score": 0, "creation_date": 1442423789, "post_id": 32614469, "comment_id": 53080405, "body": "You are awesome Scott - Thank you!  How would I get the time value that you are pulling (End(xlToRight).Offset(, -1).Value) into a specific column?  Say column A for every row that it finds the time value in, enter the value to Range A &amp; the row that it is taking the value from."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 15, "user_id": 5342639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aa6f11e183b45e6f4f5001d3c94c612?s=128&d=identicon&r=PG&f=1", "display_name": "hockey1020", "link": "https://stackoverflow.com/users/5342639/hockey1020"}, "edited": false, "score": 0, "creation_date": 1442426500, "post_id": 32614469, "comment_id": 53081967, "body": "You would &#39;rw.offset(,x)` the x would be the number of rows offset from the column specified in the for loop.  If you are going to put the answer in column A use column B in the for loop and x would equal -1."}, {"owner": {"reputation": 15, "user_id": 5342639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aa6f11e183b45e6f4f5001d3c94c612?s=128&d=identicon&r=PG&f=1", "display_name": "hockey1020", "link": "https://stackoverflow.com/users/5342639/hockey1020"}, "edited": false, "score": 0, "creation_date": 1442434867, "post_id": 32614469, "comment_id": 53086607, "body": "Makes sense!! Thanks again!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1442422518, "creation_date": 1442422518, "answer_id": 32614469, "question_id": 32613860, "link": "https://stackoverflow.com/questions/32613860/dynamically-find-last-cell-with-text-in-every-row/32614469#32614469", "title": "Dynamically find last cell with text in every row", "body": "<p>If you want it in VBA You could do something like this</p>\n\n<pre><code>Dim rw As Range\nFor Each rw In Range(Range(\"A1\"), Range(\"A1\").End(xlDown)).Cells\n    If rw.End(xlToRight).Value = \"Approved/Closed\" Then\n        MsgBox rw.End(xlToRight).Offset(, -1).Value 'put the value anywhere you want.\n    End If\nNext\n</code></pre>\n\n<p>It will loop through all the rows and check if the last column is equal to \"Approved/Closed\".  Then you can do what ever wanted with the offset value.</p>\n\n<p>This only works if there are no blank cells in the table.</p>\n"}], "owner": {"reputation": 15, "user_id": 5342639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aa6f11e183b45e6f4f5001d3c94c612?s=128&d=identicon&r=PG&f=1", "display_name": "hockey1020", "link": "https://stackoverflow.com/users/5342639/hockey1020"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 32614469, "answer_count": 2, "score": 1, "last_activity_date": 1442422518, "creation_date": 1442420420, "last_edit_date": 1442420544, "question_id": 32613860, "link": "https://stackoverflow.com/questions/32613860/dynamically-find-last-cell-with-text-in-every-row", "title": "Dynamically find last cell with text in every row", "body": "<p>I need to add a feature to a macro I created and I am having some trouble doing so.  This is my first post on here!  My macro is a SLA report for tickets.  The last columns (furthest to the right in the spreadsheet) have repeating headers of ACTION TYPE, and ACTION DATE as seen below: </p>\n\n<pre><code>ACTION DATE | ACTION TYPE | ACTION DATE | ACTION TYPE | ACTION DATE | ACTION TYPE\n</code></pre>\n\n<p>This is where it becomes dynamic because for every row, there is a unique # of columns which is dependent on the number of Action's performed.</p>\n\n<p>Below would be a simple example where 3 actions occur with a ticket, ie: 1. Submit from requester, 2. Comment, and 3. Close of ticket -- Note: This is 6 columns because before every ACTION TYPE column there is the corresponding ACTION DATE showing when the action occurred:</p>\n\n<pre><code>7/14/2015 6:21:19 PM | Submitted | 7/15/2015 9:35 | Commented | 7/15/2015 9:17 | Approved/Closed\n</code></pre>\n\n<p>WHAT I NEED VBA TO DO for this portion is to find when every ticket was closed.  This would be the last populated ACTION DATE cell in every row, assuming the ticket was closed.  This could be done a number of different ways, but I was thinking to find the last cell that contains data (furthest to right) in every row (this would always be the ACTION TYPE column).  Once this is found, verify that the value has \"Approved/Closed\" in it (not all tickets are closed), and THEN offset one column to the left to copy the closed time. (paste into a new column, say column A for example).<br>\nIf the ticket is still open, there will not be an \"Approved/Closed\" action type as the last used cell in the row..I cant simply just go to the last cell in a row with data and assume that it is closed.</p>\n\n<p>Is this possible to do?  Is there a better way?</p>\n\n<p>The # of rows and columns is always changing (typically around 100 columns and 6000 rows.  The Action Date and Action Type columns usually account for the last 60-70 columns in the report.</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": true, "score": 1, "last_activity_date": 1442421908, "creation_date": 1442421908, "answer_id": 32614280, "question_id": 32613486, "link": "https://stackoverflow.com/questions/32613486/what-type-of-object-is-a-copied-excel-chart-in-word/32614280#32614280", "title": "What type of object is a copied Excel chart in Word?", "body": "<p>It is an <code>InlineShape</code> object. A collection of InlineShapes can be accessed at the document level:</p>\n\n<pre><code>wdDoc.InlineShapes(Index)\n</code></pre>\n\n<p>I believe the Index corresponds to the order in the document, not their order of creation, so if you know it's location in the document relative to other InlineShapes (First: Index=1 or Last: Index = .Count), you could access it that way.</p>\n\n<p>There is also an InlineShapes property for the Range object. So if you know (say) which paragraph you've pasted the shape into, you can access it with</p>\n\n<pre><code>Paragraphs(MyPara).Range.InlineShapes(Index)\n</code></pre>\n\n<p>Hope that helps</p>\n"}], "owner": {"reputation": 510, "user_id": 3398853, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c99b8975fefdcd0ff7556e1b17c6cae9?s=128&d=identicon&r=PG&f=1", "display_name": "Kazschuri", "link": "https://stackoverflow.com/users/3398853/kazschuri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 32614280, "answer_count": 1, "score": 0, "last_activity_date": 1442421908, "creation_date": 1442419175, "last_edit_date": 1442419973, "question_id": 32613486, "link": "https://stackoverflow.com/questions/32613486/what-type-of-object-is-a-copied-excel-chart-in-word", "title": "What type of object is a copied Excel chart in Word?", "body": "<p>I have copied a chart from Excel to Word and I need to resize it now. All with VBA via Access.</p>\n\n<p>Can someone tell me, what kind of object the chart is, or how I can get hold of it?</p>\n\n<pre><code>xlSheet.ChartObjects(1).Chart.CopyPicture Appearance:=1, Size:=1, Format:=-4147\nwdDoc.Selection.PasteSpecial Link:=False, DataType:=3, Placement:=0, DisplayAsIcon:=False\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1442419295, "creation_date": 1442419295, "answer_id": 32613541, "question_id": 32613372, "link": "https://stackoverflow.com/questions/32613372/run-time-error-1004-in-rangecells/32613541#32613541", "title": "Run time error 1004 in Range(Cells())", "body": "<blockquote>\n  <p>Range(Cells(1, x), Cells(h, x)).Value = Worksheets(\"ABC1\").Range(Cells(1, y), Cells(h, y)).Value</p>\n</blockquote>\n\n<p>You are getting that error because your cells objects are not fully qualified.</p>\n\n<p>Try this</p>\n\n<pre><code>WS.Range(WS.Cells(1, x), WS.Cells(h, x)).Value = _\nWorksheets(\"ABC1\").Range(Worksheets(\"ABC1\").Cells(1, y), Worksheets(\"ABC1\").Cells(h, y)).Value\n</code></pre>\n\n<p>Similarly please qualify all your objects in your code.</p>\n"}], "owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 774, "favorite_count": 0, "accepted_answer_id": 32613541, "answer_count": 1, "score": 1, "last_activity_date": 1442419295, "creation_date": 1442418846, "question_id": 32613372, "link": "https://stackoverflow.com/questions/32613372/run-time-error-1004-in-rangecells", "title": "Run time error 1004 in Range(Cells())", "body": "<p>I have the following code in a number of macros, but it takes in a lot of information, which I don't need. The formula is as follows:</p>\n\n<pre><code>Range(\"A1\" &amp; h &amp; \":BD\" &amp; h).Value = Worksheets(\"ABC1\").Range(\"A\" &amp; h &amp; \":BD\" &amp; h).Value\n</code></pre>\n\n<p>I have tried to change the formula to a more dynamic version, as follows:</p>\n\n<pre><code>Sub MFGI_NAV()\n\nDim x As Variant\nDim y As Variant\n\n    Worksheets(\"ABC1\").Activate\n\n    h = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    Set WS = Sheets.Add(before:=Worksheets(\"ZYX\"), Type:=xlWorksheet)\n    ActiveSheet.Name = \"JKL\"\n\n    x = 1\n    y = 1\n    While y &lt;= 82\n\n        Cells(1, x).Select\n        Range(Cells(1, x), Cells(h, x)).Value = Worksheets(\"ABC1\").Range(Cells(1, y), Cells(h, y)).Value\n\n        x = x + 1\n        y = y + 3\n\n    Wend\n    End Sub\n</code></pre>\n\n<p>This formula only takes in every 3rd column in the sheet \"ABC1\" and put it into every incremental column in \"JKL\".</p>\n\n<p>However, when I try this, I get a run time error 1004.</p>\n\n<p>Is there any suggestions on how I can get this to work more dynamically?</p>\n\n<p>BTW, the reason I ask is that while this file only has 82 columns, and 20k rows, future sheets could have up to 10k columns and 500k rows (and yes, I know that is massive, but that is the way the system generates the information, and only 1/3 of it is needed)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 1, "creation_date": 1442416687, "post_id": 32612618, "comment_id": 53075883, "body": "I see you are new to VBA in Excel, is there anything that you&#39;ve tried so far?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 3, "creation_date": 1442416964, "post_id": 32612618, "comment_id": 53076086, "body": "lol &quot;come up empty&quot;?? <a href=\"http://stackoverflow.com/questions/11562093/delete-rows-based-on-condition-in-a-column?s=6|2.6246\" title=\"delete rows based on condition in a column\">stackoverflow.com/questions/11562093/&hellip;</a> <a href=\"http://stackoverflow.com/questions/14613609/how-to-delete-row-based-on-cell-value?s=4|2.8762\" title=\"how to delete row based on cell value\">stackoverflow.com/questions/14613609/&hellip;</a> <a href=\"http://stackoverflow.com/questions/11317172/delete-row-based-on-condition?s=7|2.6021\" title=\"delete row based on condition\">stackoverflow.com/questions/11317172/&hellip;</a> <a href=\"http://stackoverflow.com/questions/30055943/how-to-delete-rows-based-on-criteria-from-2-columns-in-vba?s=13|2.3984\" title=\"how to delete rows based on criteria from 2 columns in vba\">stackoverflow.com/questions/30055943/&hellip;</a> <a href=\"http://stackoverflow.com/questions/28349141/delete-rows-based-on-criteria-in-multiple-columns?s=14|2.3781\" title=\"delete rows based on criteria in multiple columns\">stackoverflow.com/questions/28349141/&hellip;</a>"}, {"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1442417256, "post_id": 32612618, "comment_id": 53076264, "body": "@findwindow -- Did you really laugh out loud?  I&#39;m just trying to imagine you sitting at your computer cackling like a hyena over this..."}, {"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1442417896, "post_id": 32612618, "comment_id": 53076640, "body": "@M.Peachy happy to help if it looks like questioner has tried to help them selves. I just added your question title into Google and it returns 3.7 million results..."}], "answers": [{"tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1442488244, "creation_date": 1442488244, "answer_id": 32628911, "question_id": 32612618, "link": "https://stackoverflow.com/questions/32612618/conditional-statement-to-delete-rows-based-on-values-in-two-columns/32628911#32628911", "title": "Conditional statement to delete rows based on values in two columns", "body": "<p>I do not understand why people waste so much time searching for exactly the code they need for a problem that is unique to them.  It would be so much easier to learn the basics of VBA and then code their solution themselves</p>\n\n<p>Search for \u201cExcel VBA Tutorial\u201d.  There are many to choose from so pick one that matches your learning style.  I prefer books.  I visited a good library; borrowed the most promising Excel VBA Primers to study at home then bought the one I preferred as a permanent reference book.  A few hours learning VBA and you could solve this problem and the next and the next without wasting hours wandering around the web looking at code you do not understand.</p>\n\n<p>Think about your requirement.  I assume <code>c28=c29=c30=c31</code> is an example.  <code>c31=c32=c33=c34</code> would also be of interest.  You need to generalise your specification.</p>\n\n<p>I will replace <code>c28</code> by <code>Cells(28, \"C\")</code> which happens to be VBA syntax but any suitable notation will do at this stage.  I think you mean:</p>\n\n<pre><code>Cells(RowCurrent, \"C\") = Cells(RowCurrent+1, \"C\") And _\nCells(RowCurrent, \"C\") = Cells(RowCurrent+2, \"C\") And _\nCells(RowCurrent, \"C\") = Cells(RowCurrent+3, \"C\")\n</code></pre>\n\n<p>for all permitted values for <code>RowCurrent</code>.  </p>\n\n<p>What are the permitted values for <code>RowCurrent</code>?  If you have one header row, the first data row will be <code>2</code> so the minimum value for <code>RowCurrent</code> will be <code>2</code>.  If <code>RowLast</code> is the last used row of the worksheet, the maximum value for <code>RowCurrent</code> is <code>RowLast \u2013 3</code>.</p>\n\n<p>When you say <code>e28:e31</code> do you means cells e28, c29, c30 and e31 have been merged?</p>\n\n<p>Do you mean <code>e28:e31</code>contains <code>.tif</code> or <code>e28:e31</code>ends <code>.tif</code>?  Would you keep <code>abc.tif.txt</code>?  When programming, your specification must be absolutely precise.  The computer will do what you say not what you meant.</p>\n\n<p>You say you have many worksheets and you want to read each of them in turn.  I would expect any tutorial to explain how to loop through all the worksheets of a workbook.  Alternatively, this is the sort of question you can search for.  If you have a single requirement, you can usually find a suitable match.  Put another way, searching for D may be easy but searching for A and D and I is difficult.</p>\n\n<p>You have an outer loop for each worksheet.  You need to find the last used row of each worksheet.  You have an inner loop for each block of rows.  You need to delete uninteresting blocks.  I would expect you to learn how to do each of those from your tutorial.  Can you put those four separate techniques together?</p>\n\n<p>I can only see one serious complication with your requirement; you do not delete uninteresting rows, you keep interesting rows.  If you examine rows 2 to 5 and find they do not conform to your template, you cannot delete them because rows 3 to 6 might conform to your template.  I do not believe you could possibly find any code that would meet this requirement.  You would have to design the solution yourself.  I have a couple of suggestions but I would need to have more confidence in your exact requirement before suggesting them.</p>\n"}], "owner": {"reputation": 1, "user_id": 5342920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/034685c6911a81ebe712f9f50014de9b?s=128&d=identicon&r=PG&f=1", "display_name": "M. Peachy", "link": "https://stackoverflow.com/users/5342920/m-peachy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 861, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1442488244, "creation_date": 1442416606, "question_id": 32612618, "link": "https://stackoverflow.com/questions/32612618/conditional-statement-to-delete-rows-based-on-values-in-two-columns", "title": "Conditional statement to delete rows based on values in two columns", "body": "<p>I've tried searching here and generally through Google to find a solution to suit my needs, but have come up empty. I'm new to using Excel VBA, but I assume this is the correct way to go about things in this case. </p>\n\n<p>I have a large spreadsheet - many worksheets with thousands of rows in each. Each worksheet has similar data in it. There are 5 columns, A-E. Column C has duplicate data, and column E disambiguates it. What I'm looking for is a way to delete rows when the condition of \"If c28=c29=c30=c31, and e28:e31 contains '.tif', then delete rows where e28:e31 is not '.tif'.\"</p>\n\n<p>I hope this makes sense. </p>\n\n<p>Thanks for any help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1442416593, "post_id": 32612590, "comment_id": 53075817, "body": "I don&#39;t see a file <code>close</code>"}, {"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1442420282, "post_id": 32612590, "comment_id": 53078266, "body": "I added <code>ActiveWorkbook.Close</code>. No errors now and it deletes the temp file but it is not saving the final file"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1442421493, "post_id": 32612590, "comment_id": 53079077, "body": "Need to look through your code to see what&#39;s going on but why set books if you&#39;re not going to use them? Edit: what Darren says too."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1442421997, "post_id": 32612590, "comment_id": 53079367, "body": "Can&#39;t tell which one is the final file that you want to save XD And I presume Beta is the one you want to delete? If so, use <code>Beta.close</code>? I can&#39;t tell which one is the activeworkbook at the time you call <code>close</code> XD Finally, why use <code>saveas</code> earlier then change to<code>getsaveasfilename</code> later?"}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1442421465, "creation_date": 1442421465, "answer_id": 32614153, "question_id": 32612590, "link": "https://stackoverflow.com/questions/32612590/code-runs-with-out-error-but-it-is-not-saving-the-file/32614153#32614153", "title": "Code runs with out error but it is not saving the file", "body": "<p>You're asking for a filename to save as with <code>Application.GetSaveAsFilename</code> but you're not putting it to use:</p>\n\n<pre><code>Sub test()\n\n    Dim a As String\n    a = Application.GetSaveAsFilename(FileFilter:=\"Excel Files, *.xls\")  'Ask for a filename to save as.\n    ThisWorkbook.SaveAs a 'Save the file\n\nEnd Sub\n</code></pre>\n\n<p>It's the end of the day, so haven't added everything - check that the result of <code>a</code> isn't FALSE or some other unusable name.  There's also various options available under <code>SaveAs</code>.</p>\n"}], "owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1442421465, "creation_date": 1442416522, "last_edit_date": 1531161705, "question_id": 32612590, "link": "https://stackoverflow.com/questions/32612590/code-runs-with-out-error-but-it-is-not-saving-the-file", "title": "Code runs with out error but it is not saving the file", "body": "<p>It is supposed to open the file, save as, copy values, Save as again (final filename), then to delete the first save as. I am using this to achieve a temporary .xlsx file. It works, opens, saves as window comes up, then deletes the Temp file but it is not saving the file before it deletes the temp file.</p>\n\n<p>Code:</p>\n\n<pre><code> Sub PracticeMakesPerfect()\n\nDim wbMain     As Workbook\nDim Alpha      As Workbook\nDim Beta       As Workbook\nDim sFile      As String\nDim PurgeTemp\n\nApplication.DisplayAlerts = False\n    Set wbMain = Workbooks(\"Macro Tester.xlsm\")\n    Set Alpha = Workbooks.Open(\"C:\\Users\\frfcomputer\\Desktop\\Test.xlsx\")\n        ActiveWorkbook.SaveAs \"C:\\Users\\frfcomputer\\Desktop\\test\\Temp.xlsx\"\n    Set Beta = Workbooks(\"Temp.xlsx\")\n\nwbMain.Sheets(\"Sheet1\").Range(\"A1\").Value = Beta.Sheets(\"Sheet1\").Range(\"A1\").Value\n\nApplication.DisplayAlerts = True\n\n        Application.GetSaveAsFilename\n\nActiveWorkbook.Close\n\n'Source File Location\nsFile = \"C:\\Users\\frfcomputer\\Desktop\\test\\\" &amp; \"Temp.xlsx\"  \n\n'Sets Object\nSet PurgeTemp = CreateObject(\"Scripting.FileSystemObject\")\n\n'Checks File Exists or Not\nIf PurgeTemp.FileExists(sFile) Then\n\n    'If file exists, delete the file\n    PurgeTemp.DeleteFile sFile, True\n    MsgBox \"Deleted The File Successfully\", vbInformation, \"Done!\"\nElse\n\n    'If file does not exists\n    MsgBox \"Specified File Not Found\", vbInformation, \"Not Found!\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1442419636, "post_id": 32612726, "comment_id": 53077854, "body": "There is a lot to be said for parameters. They scale better if you need to change the back-end."}], "tags": [], "owner": {"reputation": 44607, "user_id": 833073, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7b2e4376123477a31727c54096d1d117?s=128&d=identicon&r=PG", "display_name": "fthiella", "link": "https://stackoverflow.com/users/833073/fthiella"}, "is_accepted": false, "score": 3, "last_activity_date": 1442427881, "last_edit_date": 1442427881, "creation_date": 1442416951, "answer_id": 32612726, "question_id": 32612505, "link": "https://stackoverflow.com/questions/32612505/how-can-i-insert-data-from-an-access-form-into-a-sql-table-using-vba/32612726#32612726", "title": "How can I insert data from an Access form into a sql table using VBA?", "body": "<p>I think you are just missing some double quotes:</p>\n\n<pre><code>StrSQL = \"INSERT INTO [dbo_Expense_Projection] ([StatusID],[TravellerUFID],[Email]) \" &amp; _\n\"VALUES(\" &amp; Me.StatusID &amp; \", \" Me.TravellerUFID &amp; \", \" Me.SubmitterUFID &amp; \", \"\"\" &amp; Me.email &amp; \"\"\")\"\nDoCmd.RunSQL StrSQL\n</code></pre>\n\n<p>You can try to print the contents of StrSQL and check the query before running it:</p>\n\n<pre><code>Debug.Print StrSQL\n</code></pre>\n\n<p>but I prefer not to create SQL strings with concatenated values (what happens if Me.StravellerUFID contains a double quote?)</p>\n\n<p>I would suggest you to insert data using DAO:</p>\n\n<pre><code>Dim rs as Recordset\nSet rs = CurrentDb.OpenRecordset(\"dbo_Expense_Projection\")\nrs.AddNew\nrs!StatusID = Me.StatusID\nrs!TravellerUFID = Me.TravellerUFID\n' ...other fields\nrs.Update\nrs.Close\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "is_accepted": false, "score": 0, "last_activity_date": 1442484685, "last_edit_date": 1442484685, "creation_date": 1442482198, "answer_id": 32626931, "question_id": 32612505, "link": "https://stackoverflow.com/questions/32612505/how-can-i-insert-data-from-an-access-form-into-a-sql-table-using-vba/32626931#32626931", "title": "How can I insert data from an Access form into a sql table using VBA?", "body": "<p>There are also some ampersands missing in the SQL-String:</p>\n\n<pre><code>StrSQL = \"INSERT INTO [dbo_Expense_Projection] ([StatusID],[TravellerUFID],[Email]) \" &amp; _\n          \"VALUES(\" &amp; Me!StatusID &amp; \", \" &amp; Me!TravellerUFID &amp; \", \" &amp; Me!SubmitterUFID &amp; \", \"\"\" &amp; Me!email &amp; \"\"\")\"\n</code></pre>\n\n<p>And I think you should use exclamation mark between \"Me\" and fieldname. But I do not want to argue with the experts here about that... ;)</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 5342869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5Vg1y.jpg?s=128&g=1", "display_name": "Andy Hunn", "link": "https://stackoverflow.com/users/5342869/andy-hunn"}, "is_accepted": false, "score": 0, "last_activity_date": 1442512777, "creation_date": 1442512777, "answer_id": 32637002, "question_id": 32612505, "link": "https://stackoverflow.com/questions/32612505/how-can-i-insert-data-from-an-access-form-into-a-sql-table-using-vba/32637002#32637002", "title": "How can I insert data from an Access form into a sql table using VBA?", "body": "<p>Here is what ended up working:</p>\n\n<pre><code>Dim StrSQL As String\n\nStrSQL = \"INSERT INTO dbo_Expense_Projection (StatusID,TravellerUFID,Email) \n          VALUES('\" &amp; Form!StatusID &amp; \"','\" &amp; Form!TravellerUFID &amp; \"','\" &amp; Form!Email &amp; \"')\"\n\nDoCmd.SetWarnings False\nDoCmd.RunSQL StrSQL\nDoCmd.SetWarnings True\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5342869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5Vg1y.jpg?s=128&g=1", "display_name": "Andy Hunn", "link": "https://stackoverflow.com/users/5342869/andy-hunn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3051, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1442512777, "creation_date": 1442416307, "last_edit_date": 1442416800, "question_id": 32612505, "link": "https://stackoverflow.com/questions/32612505/how-can-i-insert-data-from-an-access-form-into-a-sql-table-using-vba", "title": "How can I insert data from an Access form into a sql table using VBA?", "body": "<p>Here is what I have, I'm trying to take fields from an Access form (data comes from one linked sql table) and insert them into another linked sql table:</p>\n\n<pre><code>StrSQL = \"INSERT INTO [dbo_Expense_Projection] ([StatusID],[TravellerUFID],[Email]) \" &amp; _\n          VALUES(\" &amp; Me.StatusID &amp; \", \" Me.TravellerUFID &amp; \", \" Me.SubmitterUFID &amp; \", \" Me.email &amp; \")\nDoCmd.RunSQL StrSQL\n</code></pre>\n\n<p>But I am getting this error</p>\n\n<pre><code>Compile error: Sub or Function not defined \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1442417983, "post_id": 32612379, "comment_id": 53076702, "body": "without more detail this is impossible to answer! We need to see the rest of the vba. We also need details of the error - at least the error message."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1442421845, "post_id": 32612379, "comment_id": 53079285, "body": "Must be the source worksheet is not active! again and again ... We are not supposed to advice you to activate your worksheet before the copy statement ;)"}], "answers": [{"tags": [], "owner": {"reputation": 2177, "user_id": 1211997, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/289e883b1531a6c68ce799642e3b918e?s=128&d=identicon&r=PG", "display_name": "rheitzman", "link": "https://stackoverflow.com/users/1211997/rheitzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1442446693, "creation_date": 1442446693, "answer_id": 32620446, "question_id": 32612379, "link": "https://stackoverflow.com/questions/32612379/how-to-copy-data-from-different-sheets/32620446#32620446", "title": "How to copy data from different sheets", "body": "<p>One liners are hard to deal with. Breaking down helps:</p>\n\n<pre><code>Dim wks As Worksheet\nDim startrow, endrow\nstartrow = 1\nendrow = 10\nSet wks = ThisWorkbook.Worksheets(\"stops\") ' my test sheet\n' copy first column to clipboard\nwks.Range(wks.Cells(startrow, 1), wks.Cells(endrow, 1)).Copy\n</code></pre>\n\n<p>I think your main error was not qualifying the <code>Cells</code> reference. It might work on a single sheet, but not from another sheet or workbook.</p>\n\n<pre><code>Dim startrow, endrow\nstartrow = 1\nendrow = 10\nRange(Cells(startrow, 1), Cells(endrow, 1)).Copy ' of this worksheet\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4071880, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100001233214207/picture?type=large", "display_name": "Bharath Thati", "link": "https://stackoverflow.com/users/4071880/bharath-thati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1442446693, "creation_date": 1442416012, "last_edit_date": 1531164843, "question_id": 32612379, "link": "https://stackoverflow.com/questions/32612379/how-to-copy-data-from-different-sheets", "title": "How to copy data from different sheets", "body": "<p>I need to copy data from sheet ABC. I know the column number, start row and end row. When i try the following code it throws error. any help would be great</p>\n\n<pre><code>workbooks(\"ABC\").worksheets(\"abc\").range(cells(startrow,1),cells(endrow,1)).copy\n</code></pre>\n"}, {"tags": ["vba", "excel", "filenames"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1442418856, "post_id": 32612337, "comment_id": 53077331, "body": "You need to add something to <code>LastCol</code> otherwise you&#39;re going to keep overwriting the previous values..."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1442419453, "post_id": 32612337, "comment_id": 53077731, "body": "It also seems using <code>End(xlToLeft).Columns</code> instead of <code>End(xlUp).Rows</code>, you intend to align text file data side by side instead of stacking on top of each other. Usually, data and reports are handled in long not wide formats. See <a href=\"http://www.rondebruin.nl/win/s9/win005.htm\" rel=\"nofollow noreferrer\">Bruin&#39;s note here</a>."}, {"owner": {"reputation": 1, "user_id": 5342837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18d2b88d7804c05811b1e7afde85067c?s=128&d=identicon&r=PG&f=1", "display_name": "IrishThunder23", "link": "https://stackoverflow.com/users/5342837/irishthunder23"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1442433068, "post_id": 32612337, "comment_id": 53085604, "body": "@Tim-Williams, could you explain more?  Are you suggesting a meaningless increment because the LastCol will align with the data import."}, {"owner": {"reputation": 1, "user_id": 5342837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18d2b88d7804c05811b1e7afde85067c?s=128&d=identicon&r=PG&f=1", "display_name": "IrishThunder23", "link": "https://stackoverflow.com/users/5342837/irishthunder23"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1442433133, "post_id": 32612337, "comment_id": 53085638, "body": "@Parfait, I tried replacing with End(xlUp).Rows but it didn&#39;t seem to compile."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1442434550, "creation_date": 1442434550, "answer_id": 32617873, "question_id": 32612337, "link": "https://stackoverflow.com/questions/32612337/importing-text-file-loop-while-adding-file-name/32617873#32617873", "title": "Importing Text File Loop while adding file name", "body": "<p>This will get the column number of the last <em>occupied</em> cell in Row1 (or the first cell if there's nothing on the row)</p>\n\n<pre><code>LastCol = Cells(1, Columns.Count).End(xlToLeft).Column\n</code></pre>\n\n<p>If you start populating content at that position you will (except in the empty row case) overwrite the content in that cell.</p>\n\n<pre><code> LastCol = Cells(1, Columns.Count).End(xlToLeft).Column  + 1\n</code></pre>\n\n<p>Gives you the first <em>empty</em> cell [from the right] on that row.  But that doesn't account for the content in the imported file, which has multiple columns.  If your imported file has 3 columns then you need to offset further... </p>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1442499684, "creation_date": 1442499684, "answer_id": 32632719, "question_id": 32612337, "link": "https://stackoverflow.com/questions/32612337/importing-text-file-loop-while-adding-file-name/32632719#32632719", "title": "Importing Text File Loop while adding file name", "body": "<p>To change from wide to long format, simply change the <code>LastCol</code> to <code>LastRow</code> with changes to the following four lines in code.</p>\n\n<pre><code>Dim ... LastRow As Long, ...\n\nLastRow = Cells(Rows.Count, 1).End(xlUp).Row\n...\nRange(Cells(LastRow + 1, 1).Address).Value = fileName\n...\n   Destination:=Cells(LastRow + 2, 1))\n</code></pre>\n\n<p>This also resolves your overwriting of FileName and allows you to continue on with subsequent .dat file imports.</p>\n"}], "owner": {"reputation": 1, "user_id": 5342837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18d2b88d7804c05811b1e7afde85067c?s=128&d=identicon&r=PG&f=1", "display_name": "IrishThunder23", "link": "https://stackoverflow.com/users/5342837/irishthunder23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 688, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1442499684, "creation_date": 1442415897, "last_edit_date": 1442420975, "question_id": 32612337, "link": "https://stackoverflow.com/questions/32612337/importing-text-file-loop-while-adding-file-name", "title": "Importing Text File Loop while adding file name", "body": "<p>I'm a newbie to Excel VBA and having some problem.  I am creating a Macro which will take a .dat file (imports like a .txt file) and puts the filename in the first row and then all the data underneath it starting with row 2.  Then the program loops and starts the process again 3 rows over (the data has many rows but only 3 columns).</p>\n\n<p>Currently my Macro will put the imported data correctly, but the filename is not looping correctly.  It will input the filename into A1, loops inputs filename into D3 while deleting filename from A1.  I can't figure out what's going wrong.</p>\n\n<pre><code>Sub ImportDataFiles()\n'call out variables\nDim fName As String, LastCol As Long, fileName As String, fso As Object\n\n'loop start\nBEGINNING:\nLastCol = Cells(1, Columns.Count).End(xlToLeft).Column\nfName = Application.GetOpenFilename(\"All Files, *.dat\")\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nfileName = fso.GetFilename(fName)\n'fileName is just the file name from the path\nRange(Cells(1, LastCol).Address).Value = fileName\nIf fName = \"False\" Then Exit Sub\n        'Imports data from text file\n        With ActiveSheet.QueryTables.Add(Connection:=\"TEXT;\" &amp; fName, _\n            Destination:=Cells(2, LastCol))\n                .TextFileStartRow = 30\n                .TextFileParseType = xlDelimited\n                .TextFileConsecutiveDelimiter = True\n                .TextFileTabDelimiter = False\n                .TextFileSemicolonDelimiter = True\n                .TextFileCommaDelimiter = False\n                .TextFileSpaceDelimiter = False\n                .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, _\n                   1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, _\n                   1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, _\n                   1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n                .Refresh BackgroundQuery:=False\n                'loop end\n                If MsgBox(\"Do you want to do it again?\", vbYesNo) = vbYes Then GoTo BEGINNING\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "scheduled-tasks", "userform"], "comments": [{"owner": {"reputation": 65, "user_id": 4500109, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/VLcnF.jpg?s=128&g=1", "display_name": "DezyK", "link": "https://stackoverflow.com/users/4500109/dezyk"}, "edited": false, "score": 0, "creation_date": 1442415506, "post_id": 32612183, "comment_id": 53075016, "body": "P.S The timetorun variable has been declared globally."}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1442418953, "post_id": 32612183, "comment_id": 53077412, "body": "But you do get the message box? I don&#39;t see how the first update ever gets scheduled. Do you have something in the Initialize event that runs UpdateDashboard or something?"}, {"owner": {"reputation": 65, "user_id": 4500109, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/VLcnF.jpg?s=128&g=1", "display_name": "DezyK", "link": "https://stackoverflow.com/users/4500109/dezyk"}, "reply_to_user": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1442480861, "post_id": 32612183, "comment_id": 53102719, "body": "The first update works fine through, it&#39;s any later scheduled updates that don&#39;t."}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1442498496, "post_id": 32612183, "comment_id": 53113458, "body": "But do you get the message box? What runs the first update?"}], "owner": {"reputation": 65, "user_id": 4500109, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/VLcnF.jpg?s=128&g=1", "display_name": "DezyK", "link": "https://stackoverflow.com/users/4500109/dezyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1442415609, "creation_date": 1442415462, "last_edit_date": 1442415609, "question_id": 32612183, "link": "https://stackoverflow.com/questions/32612183/schedule-an-update-on-a-vba-form", "title": "Schedule an update on a VBA form", "body": "<p>I have a VBA form that shows a chart, list and fields that have been taken (via a recordset) from a database.\nI am trying to get the form to update every 10 seconds, by clearing the fileds, chart and list and running the SQL to update.\nThe following code should set the update to run in 10 seconds time and do it over and over until the user clicks close, but it doesn't work.\nNo error messages, just no update.</p>\n\n<pre><code>Sub UpdateDashboard()\n    clearform\n    CreatePendingList\n    PopulateCheckTimes\n    lasthourchart\n    createchart\n    ScheduleUpdate\nEnd Sub\n\nSub ScheduleUpdate()\n    timetorun = Now + TimeValue(\"00:00:10\")\n    MsgBox timetorun\n    Application.OnTime timetorun, \"UpdateDashboard\"\nEnd Sub\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    Application.OnTime timetorun, \"UpdateDashboard\", , False\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql-server", "forms", "vba", "ms-access"], "comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1442415647, "post_id": 32611946, "comment_id": 53075118, "body": "Do you have a unique index? You may have to create one on the link if it is to a view. It can be easier to link the tables and create the query in MS Access. You will still need indexes."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1442415659, "post_id": 32611946, "comment_id": 53075134, "body": "Sounds like the query is not updateable. Does the query use only the single SQL Server table? Can you post the SQL of the query?"}, {"owner": {"reputation": 33, "user_id": 5339365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90012d52bb37919e50b79e86ec002995?s=128&d=identicon&r=PG&f=1", "display_name": "ProgrammingAccountant", "link": "https://stackoverflow.com/users/5339365/programmingaccountant"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1442416804, "post_id": 32611946, "comment_id": 53075959, "body": "@Fionnuala The SQL table has an Identity column &quot;ID&quot; and the query pulls results if you simply execute it."}, {"owner": {"reputation": 33, "user_id": 5339365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90012d52bb37919e50b79e86ec002995?s=128&d=identicon&r=PG&f=1", "display_name": "ProgrammingAccountant", "link": "https://stackoverflow.com/users/5339365/programmingaccountant"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1442416944, "post_id": 32611946, "comment_id": 53076065, "body": "@Andre451 I actually have an old version of the database in which the query is identical, and the form is editable. In that version, there is a switchboard. I removed the switchboard in favor of blank form that I added several buttons to. Could that be the issue?"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1442418002, "post_id": 32611946, "comment_id": 53076714, "body": "Can you open the query and edit data?"}, {"owner": {"reputation": 33, "user_id": 5339365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90012d52bb37919e50b79e86ec002995?s=128&d=identicon&r=PG&f=1", "display_name": "ProgrammingAccountant", "link": "https://stackoverflow.com/users/5339365/programmingaccountant"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1442418656, "post_id": 32611946, "comment_id": 53077187, "body": "@Fionnuala I actually fixed the keys on the linked tables to match the old query, which I missed the first time, and it worked! Thanks! (If you want to post the answer for the rep, feel free, or I will later on)"}], "answers": [{"tags": [], "owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "is_accepted": true, "score": 2, "last_activity_date": 1442419880, "last_edit_date": 1442419880, "creation_date": 1442419244, "answer_id": 32613516, "question_id": 32611946, "link": "https://stackoverflow.com/questions/32611946/continuous-form-not-allowing-edits/32613516#32613516", "title": "Continuous Form not allowing edits", "body": "<p>With an SQL Server back-end it is essential that you have relevant unique indexes on any table or view that you wish to edit. Check all indexes to make sure they are appropriate.</p>\n\n<p>You can create an index for a view in VBA like so:</p>\n\n<pre><code>db.Execute \"CREATE UNIQUE INDEX uiId ON someview (Id) WITH PRIMARY\"\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5339365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90012d52bb37919e50b79e86ec002995?s=128&d=identicon&r=PG&f=1", "display_name": "ProgrammingAccountant", "link": "https://stackoverflow.com/users/5339365/programmingaccountant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 32613516, "answer_count": 1, "score": 3, "last_activity_date": 1442419880, "creation_date": 1442414886, "last_edit_date": 1442418547, "question_id": 32611946, "link": "https://stackoverflow.com/questions/32611946/continuous-form-not-allowing-edits", "title": "Continuous Form not allowing edits", "body": "<p>I need a continuous form to allow edits on one column, although I will take any at this point.</p>\n\n<p>The form level settings are set as follows:\nAllowEdits: Yes; AllowDeletes: Yes; AllowAdditions: Yes;</p>\n\n<p>The form controls settings:\nEnabled: Yes; Locked: No; </p>\n\n<p>The Record Source is a query with these settings:\nRecord Locks: No Locks; Recordset Type: Dynaset;</p>\n\n<p>The query pulls from a MS SQL server table that is set up in MS Access as a linked table, and I have admin rights on the SQL server.</p>\n\n<p>I have attempted remaking the a simplified version of the form, and it still does not allow edits. I have other continuous forms sourced from different tables that can be edited, but whenever I try on the form in question, nothing happens. It seems like it would be at the table or query level. Is there a setting I am missing?</p>\n\n<p>Edit: The query is pulling from two tables - </p>\n\n<p>dbo_tbl_controls (PK StatOrig - Text) and </p>\n\n<p>dbo_tbl_statspkgdata (PK Stat - Text; VType - Text; Yr - Number and others)</p>\n\n<p>The relationship is one to many on StatOrig = Stat. I need the controls table for the sort order.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1442545722, "post_id": 32611740, "comment_id": 53134486, "body": "Change this to a question and answer it yourself. <a href=\"http://meta.stackoverflow.com/questions/250204/can-you-answer-your-own-questions-on-stack-overflow\" title=\"can you answer your own questions on stack overflow\">meta.stackoverflow.com/questions/250204/&hellip;</a>"}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1442551225, "post_id": 32611740, "comment_id": 53135919, "body": "Thanks will do so later today."}], "answers": [{"tags": [], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "is_accepted": true, "score": 0, "last_activity_date": 1442661200, "creation_date": 1442661200, "answer_id": 32667511, "question_id": 32611740, "link": "https://stackoverflow.com/questions/32611740/pausing-vba-code/32667511#32667511", "title": "Pausing VBA Code", "body": "<p>Using a ToggleButton in a Userform (which initiates your code and <code>Modal</code> = <code>True</code>)</p>\n\n<p>You can successfully pause the code. With this you can then work in an additional selection to change the operation or function of the code via an addiotn button.</p>\n\n<p>You will need to use public/global variables.</p>\n\n<p>Comments Welcome.</p>\n\n<p>Userform:</p>\n\n<pre><code>Public Sub ToggleButton1_AfterUpdate()\n\n\n    'Program is Paused / Selected to Pause\n\n    If ProgBar.ToggleButton1.Value = True Then\n        'Changing the Text of the Toggle button once the program is \n         'selected to Pause\n        'If program paused then button will display continue\n        ProgBar.ToggleButton1.Caption = \"Continue\"\n\n\n        'For Sending to  Loop Code\n        ProgramStatus = \"0\"\n        Call LoopCode.PrgStat(ProgramStatus)\n\n    End If\n\n\n\n    'Program is running / Selected to run\n\n    If ProgBar.ToggleButton1.Value = False Then\n        'Changing the Text of the Toggle button once the program is selected to continue\n        'If program running then button will display pause\n        ProgBar.ToggleButton1.Caption = \"Pause\"\n\n        'For Sending to  Loop Code\n        ProgramStatus = \"1\"\n        Call LoopCode.PrgStat(ProgramStatus)\n\n    End If\n\n\nEnd Sub\n</code></pre>\n\n<p>In your Module</p>\n\n<pre><code>Public Status As String\n\nPublic Sub PrgStat(ByVal ProgStatus As String)\n\n   Status = ProgStatus\n\nEnd Sub\n\n\n\n\nSub SomeSub()\n\n Do While\n\n   ' Some Loop Code Running\n\n\n\n\n          If Status = \"1\" Then\n\n          'Toggle Not Pressed           \n\n          End If\n\n          If Status = \"0\" Then\n\n             'Toggle Button Pressed\n\n             Do While Status = \"0\"\n                'Program will stop here until the togglebutton on the \n                'userform is pressed again which changes Status = 1\n\n                'This is where you can make another selection on the \n                'userform\n\n                 DoEvents\n\n             Loop\n\n\n          End If\n\n   Loop\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 32667511, "answer_count": 1, "score": 0, "last_activity_date": 1442661200, "creation_date": 1442414388, "last_edit_date": 1442661183, "question_id": 32611740, "link": "https://stackoverflow.com/questions/32611740/pausing-vba-code", "title": "Pausing VBA Code", "body": "<p>How can you pause a code from running and then allow it to continue again.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1442413527, "post_id": 32611359, "comment_id": 53073503, "body": "Try to add more details to your question, you might get a better response."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1442413886, "post_id": 32611359, "comment_id": 53073781, "body": "What line produces the error."}], "answers": [{"tags": [], "owner": {"reputation": 191, "user_id": 5149107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf2d7652f551f5c58c3005cb880f39f?s=128&d=identicon&r=PG&f=1", "display_name": "hughg", "link": "https://stackoverflow.com/users/5149107/hughg"}, "is_accepted": false, "score": 1, "last_activity_date": 1442414365, "creation_date": 1442414365, "answer_id": 32611732, "question_id": 32611359, "link": "https://stackoverflow.com/questions/32611359/object-not-found-error-how-it-can-be-solved/32611732#32611732", "title": "Object not found error. How it can be solved?", "body": "<p>I don't see the variable 'Abnormal' defined prior to this line:</p>\n\n<pre><code>If Abnormal.Cells(i, 11).Value = \"IT\" Then\n</code></pre>\n\n<p>Maybe you meant:</p>\n\n<pre><code>If Sheets(\"Abnormal\").Cells(i, 11).Value = \"IT\" Then\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5342721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e8c697c1688aa6e76c69d28a7069a8d?s=128&d=identicon&r=PG&f=1", "display_name": "Sagar Anand", "link": "https://stackoverflow.com/users/5342721/sagar-anand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 764, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1442421379, "creation_date": 1442413385, "last_edit_date": 1442421379, "question_id": 32611359, "link": "https://stackoverflow.com/questions/32611359/object-not-found-error-how-it-can-be-solved", "title": "Object not found error. How it can be solved?", "body": "<p>This code is producing an \"Object not found\" error.</p>\n\n<pre><code>Sub Button86_Click()\n    Dim Y As Integer\n    Dim i As Integer\n    Dim LastRow As Long\n\n    Y = 2\n    Worksheets(\"Abnormal\").Activate\n\n    With ActiveSheet\n        LastRow = .Range(\"A1\").SpecialCells(xlCellTypeLastCell).Row\n    End With\n\n    Sheets(\"Abnormal\").Rows(1).Copy Destination:=Sheets(\"Ab_IT\").Rows(1)\n    For i = 2 To LastRow\n        If Abnormal.Cells(i, 11).Value = \"IT\" Then\n            Sheets(\"Abnormal\").Rows(i).Copy Destination:=Sheets(\"Ab_IT\").Rows(Y)\n            Y = Y + 1  \n        End If\n    Next i\n\n    Worksheets(\"Ab_IT\").Activate\n\n    With ActiveSheet.UsedRange\n        .Cells.Copy\n        .Cells.PasteSpecial xlPasteValues\n        .Cells(1).Select\n    End With\n\n    Application.CutCopyMode = False\n    Worksheets(\"Ab_IT\").Columns(\"A:J\").AutoFit\nEnd Sub\n</code></pre>\n\n<p>** Error line - If Abnormal.Cells(i, 11).Value = \"IT\" Then\nDetails - There are two sheets. Abnormal and Ab_IT.\nIn Abnormal sheet, there is one column(11),which sometimes contain \"IT\"\nI am trying to copy all the rows, which contain IT to another sheet Ab_IT.\nBut getting an error object not defined.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1442413670, "post_id": 32611170, "comment_id": 53073610, "body": "Not directly with an autofilter. You either need to build an array of the values you do want (by looping and ignoring the known values), or you can use an advanced filter instead."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 3029332, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a1651c383374eed21b5490023d6551d3?s=128&d=identicon&r=PG&f=1", "display_name": "Proventus", "link": "https://stackoverflow.com/users/3029332/proventus"}, "edited": false, "score": 0, "creation_date": 1442421564, "post_id": 32611862, "comment_id": 53079108, "body": "Sweet. Exactly what I need.  Thanks."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1442414658, "creation_date": 1442414658, "answer_id": 32611862, "question_id": 32611170, "link": "https://stackoverflow.com/questions/32611170/is-there-a-way-to-not-a-criteria-array-in-excel-vba/32611862#32611862", "title": "Is there a way to NOT a criteria array in Excel VBA?", "body": "<p>With data like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WJygQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WJygQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>We want to see everything <strong>except</strong> <em>Val1</em>,<em>Val2</em>, and <em>Val3</em></p>\n\n<p>Here is one approach:</p>\n\n<pre><code>Sub AllButThree()\n   Dim N As Long, ary(), c As Collection\n   Dim i As Long, a As String, v As String\n   ary = Array(\"Val1\", \"Val2\", \"Val3\")\n   Set c = New Collection\n   N = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n   On Error Resume Next\n   For i = 2 To N\n      v = Cells(i, 1).Value\n      If v &lt;&gt; ary(0) And v &lt;&gt; ary(1) And v &lt; ary(2) Then\n         c.Add v, CStr(v)\n      End If\n   Next i\n\n   On Error GoTo 0\n   ReDim bry(1 To c.Count)\n   For i = 1 To c.Count\n      bry(i) = c.Item(i)\n   Next i\n\n   ActiveSheet.Range(\"$A$1:$A\" &amp; N).AutoFilter Field:=1, Criteria1:=(bry), Operator:=xlFilterValues\nEnd Sub\n</code></pre>\n\n<p>It builds an array of what we want to see.</p>\n"}], "owner": {"reputation": 35, "user_id": 3029332, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a1651c383374eed21b5490023d6551d3?s=128&d=identicon&r=PG&f=1", "display_name": "Proventus", "link": "https://stackoverflow.com/users/3029332/proventus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 881, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1442414658, "creation_date": 1442412913, "question_id": 32611170, "link": "https://stackoverflow.com/questions/32611170/is-there-a-way-to-not-a-criteria-array-in-excel-vba", "title": "Is there a way to NOT a criteria array in Excel VBA?", "body": "<p>I have a column with known values. 5 are written in stone, and the odd one is new. I need to filter on the new (unknown) value. If I only had 2 known values, I could filter out Criteria1 &amp; 2 by using =\"&lt;>\"</p>\n\n<p>Since we can't use Criteria3, 4, ...\nIs there a way to use something like:</p>\n\n<p>Criteria1:=\"&lt;>\"Array(\"Val1\", \"Val2\", ...)</p>\n\n<p>(clarification: I want to show everything NOT in the array.)</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ms-access", "listbox", "vba"], "comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1442412521, "post_id": 32610305, "comment_id": 53072721, "body": "you can perform a standard for loop for ItemIndex = 0 to lbFA.listCount -1. This way you can get values from different column too if in case multi column listbox &gt; lbfa.column(col_id, ItemIndex)"}], "answers": [{"comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1442423165, "post_id": 32613496, "comment_id": 53080040, "body": "Got it!  Thanks...regular For Loop, not For Each."}], "tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": true, "score": 1, "last_activity_date": 1442419190, "creation_date": 1442419190, "answer_id": 32613496, "question_id": 32610305, "link": "https://stackoverflow.com/questions/32610305/how-to-check-values-in-a-listbox-and-select-certain-rows/32613496#32613496", "title": "How to check values in a listbox and select certain rows", "body": "<p>you can perform a standard for loop <code>for ItemIndex = 0 to lbFA.listCount -1</code>. This way you can get values from different column too if in case multi column listbox > lbfa.column(col_id, ItemIndex) </p>\n"}], "owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 678, "favorite_count": 0, "accepted_answer_id": 32613496, "answer_count": 1, "score": 1, "last_activity_date": 1442419190, "creation_date": 1442410853, "last_edit_date": 1495539868, "question_id": 32610305, "link": "https://stackoverflow.com/questions/32610305/how-to-check-values-in-a-listbox-and-select-certain-rows", "title": "How to check values in a listbox and select certain rows", "body": "<p>I found this question...\n<a href=\"https://stackoverflow.com/questions/26682659/easy-vba-looking-through-a-listbox-and-selecting-the-contents\">EASY: vba: Looking through a listbox and selecting the contents</a>\nbut it seems to select every item...not very useful.</p>\n\n<p>I need to load a popup form's ListBox with the existing values already highlighted so that the user will be able to add or remove items.</p>\n\n<pre><code>  For x = 1 To rs.RecordCount\n    For Each ItemIndex In lbFA.?????\n      If lbFA.ItemData(ItemIndex) = rs!FunctionalArea Then\n        lbFA.Selected(ItemIndex) = True\n      End If\n    Next y\n  Next x\n</code></pre>\n\n<p>What goes in the <code>lbFA.?????</code> area?  I think that's the only part I missing.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5297287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hivAj.jpg?s=128&g=1", "display_name": "Dylan Lau", "link": "https://stackoverflow.com/users/5297287/dylan-lau"}, "edited": false, "score": 1, "creation_date": 1442412953, "post_id": 32610468, "comment_id": 53073078, "body": "Oops, also didn&#39;t need to iterate through the rows using an integer. Could&#39;ve iterated using <code>For Each r In MyWs.UsedRange.Rows</code> as @A.S.H answered."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1442441524, "post_id": 32610468, "comment_id": 53089742, "body": "thanks for your note. Funny thing, my answer was voted down, by some unknown who did not have the courage to mention any reason for voting down..."}], "tags": [], "owner": {"reputation": 81, "user_id": 5297287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hivAj.jpg?s=128&g=1", "display_name": "Dylan Lau", "link": "https://stackoverflow.com/users/5297287/dylan-lau"}, "is_accepted": true, "score": 1, "last_activity_date": 1442411204, "creation_date": 1442411204, "answer_id": 32610468, "question_id": 32609949, "link": "https://stackoverflow.com/questions/32609949/looping-through-range-using-variables-rows-and-columns/32610468#32610468", "title": "Looping through range using variables (rows and columns)", "body": "<p>If the tables are all starting from cell A1, change your for statement to:</p>\n\n<pre><code>For Each Cell In Range(\"A1\", Cells(lastRow, lastCol)) ''change range accordingly\n</code></pre>\n\n<p>Though also, the way your for loop works is that it is changing every cell. It can be optimized to color the row up to the last column at once.</p>\n\n<pre><code>If ActiveSheet Is Nothing = False Then\n  Set MyWS = ActiveWorkbook.ActiveSheet\n\n  lastCol = MyWS.UsedRange.Columns.Count + 1\n  lastRow = MyWS.UsedRange.Rows.Count + 1\n\n  Dim i As Integer\n  For i = 1 To lastRow\n    If i Mod 2 = 1 Then\n        Range(\"A\" &amp; i, Cells(i, lastcol)).Interior.ColorIndex = 15\n    Else\n        Range(\"A\" &amp; i, Cells(i, lastcol)).Interior.ColorIndex = 14\n    End If\n  Next i\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1442411274, "creation_date": 1442411274, "answer_id": 32610492, "question_id": 32609949, "link": "https://stackoverflow.com/questions/32609949/looping-through-range-using-variables-rows-and-columns/32610492#32610492", "title": "Looping through range using variables (rows and columns)", "body": "<p>Try this:</p>\n\n<pre><code>  Dim r As Range\n  For Each r In MyWs.UsedRange.Rows\n    If r.Row Mod 2 = 1 Then\n        r.Interior.ColorIndex = 15\n    Else\n        r.Interior.ColorIndex = 14\n    End If\n  Next r\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 211, "user_id": 363784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cb56a8878cf05a456fc017286caecc2?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/363784/ben"}, "edited": false, "score": 0, "creation_date": 1442411619, "post_id": 32610502, "comment_id": 53072023, "body": "Agreed with @Dylan below - there is a tacit assumption that every table starts from A1 here. But if so, can just do each row, don&#39;t have to do every cell."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1442442031, "post_id": 32610502, "comment_id": 53089914, "body": "iterating through rows is much much simpler"}, {"owner": {"reputation": 211, "user_id": 363784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cb56a8878cf05a456fc017286caecc2?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/363784/ben"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1442479915, "post_id": 32610502, "comment_id": 53102166, "body": "@A.S.H it is indeed, and I didn&#39;t realise Rows property would only address columns in UsedRange, so I just learnt something :) Original post seems to indicate an intention to shade one extra row and one extra column, so perhaps you&#39;d need to extend that range slightly to meet the requirement, if that was intention? Also got downvoted, also don&#39;t know why!"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1442480204, "post_id": 32610502, "comment_id": 53102337, "body": "seems all the answers were vote down lol. Prob&#39;ly we did not quite understand the question :)"}], "tags": [], "owner": {"reputation": 211, "user_id": 363784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cb56a8878cf05a456fc017286caecc2?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/363784/ben"}, "is_accepted": false, "score": 0, "last_activity_date": 1442411307, "creation_date": 1442411307, "answer_id": 32610502, "question_id": 32609949, "link": "https://stackoverflow.com/questions/32609949/looping-through-range-using-variables-rows-and-columns/32610502#32610502", "title": "Looping through range using variables (rows and columns)", "body": "<p>Always good to include Option Explicit in your code modules. Try the following:</p>\n\n<pre><code>    Option Explicit\n\n    Sub test()\n\n    Dim MyWS As Excel.Worksheet\n    Dim objRow As Excel.Range\n    Dim lastCol As Long\n    Dim lastRow As Long\n    Dim lngRow As Long\n\n    If ActiveSheet Is Nothing = False Then\n      Set MyWS = ActiveWorkbook.ActiveSheet\n\n      lastCol = MyWS.UsedRange.Columns.Count + 1\n      lastRow = MyWS.UsedRange.Rows.Count + 1\n\n      For lngRow = 1 To lastRow\n            Set objRow = MyWS.Range(MyWS.Cells(lngRow, 1), MyWS.Cells(lngRow, lastCol))\n        If lngRow Mod 2 = 1 Then\n            objRow.Interior.ColorIndex = 15 'color to preference\n        Else\n            objRow.Interior.ColorIndex = 14 'color to preference or remove\n        End If\n      Next lngRow\n\n    End If\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5135888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53c68ff3f5929d7d51215a66d8e8965d?s=128&d=identicon&r=PG&f=1", "display_name": "Gia", "link": "https://stackoverflow.com/users/5135888/gia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4222, "favorite_count": 0, "accepted_answer_id": 32610468, "answer_count": 3, "score": 1, "last_activity_date": 1442415048, "creation_date": 1442410005, "last_edit_date": 1442415048, "question_id": 32609949, "link": "https://stackoverflow.com/questions/32609949/looping-through-range-using-variables-rows-and-columns", "title": "Looping through range using variables (rows and columns)", "body": "<p>I'm writing a simple formatting macro to alternate the row color for a table in Excel.</p>\n\n<p>I want this macro to be able to format any size table (no matter row/column size).</p>\n\n<p>For example, I want the macro to work when I have a chart with 6 rows 4 columns, or 4 rows 5 columns, or 9 rows 10 columns, etc.</p>\n\n<p>Here's the code I have so far - but I'm getting a runtime error.</p>\n\n<pre><code>  If ActiveSheet Is Nothing = False Then\n  Set MyWS = ActiveWorkbook.ActiveSheet\n\n  lastCol = MyWS.UsedRange.Columns.Count + 1\n  lastRow = MyWS.UsedRange.Rows.Count + 1\n\n  For Each Cell In Range(lastRow, lastCol) ''change range accordingly\n    If Cell.Row Mod 2 = 1 Then\n        Cell.Interior.ColorIndex = 15 ''color to preference\n    Else\n        Cell.Interior.ColorIndex = 14 ''color to preference or remove\n    End If\n  Next Cell\nEnd If\n</code></pre>\n\n<p>I've tried multiple versions of the Range - having the column var come first, having an '&amp;' instead of a comma, etc.</p>\n\n<p>If I use just Range(\"A1:A\" &amp; lastRow), it'll work but just for the data in column A.\nI would need it to span across all columns in the chart.</p>\n"}, {"tags": ["html", "excel", "vba", "hyperlink"], "comments": [{"owner": {"reputation": 10209, "user_id": 909742, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/OWvxE.jpg?s=128&g=1", "display_name": "Andrea", "link": "https://stackoverflow.com/users/909742/andrea"}, "edited": false, "score": 0, "creation_date": 1442408617, "post_id": 32609272, "comment_id": 53069728, "body": "Check <a href=\"http://stackoverflow.com/a/25493388/909742\">this</a> answer: it should help you"}], "owner": {"reputation": 26, "user_id": 5342363, "user_type": "registered", "profile_image": "https://graph.facebook.com/970762632965416/picture?type=large", "display_name": "Lenny Obez", "link": "https://stackoverflow.com/users/5342363/lenny-obez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1442409755, "creation_date": 1442408265, "last_edit_date": 1442409755, "question_id": 32609272, "link": "https://stackoverflow.com/questions/32609272/how-can-i-extract-websites-info-with-hyperlinks-using-excel-vba", "title": "How can I extract website&#39;s info with hyperlinks using EXCEL VBA?", "body": "<p>I have a small list of websites (hyperlinks) in EXCEL from C2 to C90 right now and I need to find some informations like the website's name, postcode and email. It would speed up the process by script than by hand ;)</p>\n\n<p>Actually, I've find this code for VBA to open every hyperlinks in once but it's still pretty long to find the information:</p>\n\n<pre><code>Sub OpenHyperLinks()\n'Update 20141124\n    Dim xHyperlink As Hyperlink\n    Dim WorkRng As Range\n    On Error Resume Next\n    xTitleId = \"KutoolsforExcel\"\n    Set WorkRng = Application.Selection\n    Set WorkRng = Application.InputBox(\"Range\", xTitleId, WorkRng.Address, Type:=8)\n    For Each xHyperlink In WorkRng.Hyperlinks\n        xHyperlink.Follow\n    Next\nEnd Sub\n</code></pre>\n\n<p>So, is there anyway for a script to open all the hyperlinks ($C2:$C90) and paste every \"h1\" tag from the HTML page to EXCEL ($A2:$A90) !</p>\n\n<p>Thank you in advance !</p>\n"}, {"tags": ["excel", "vba", "sorting"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1442407970, "post_id": 32609045, "comment_id": 53069196, "body": "So you are looking to change your data? Once you do this Excel will not be able to get the data back to the original state."}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1442409060, "post_id": 32609045, "comment_id": 53070036, "body": "Will column A and C have same value but in different order?"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 4309291, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c74f20a3e25734d1061af0831fcea048?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry", "link": "https://stackoverflow.com/users/4309291/jerry"}, "edited": false, "score": 0, "creation_date": 1442410225, "post_id": 32609317, "comment_id": 53070949, "body": "Sorry that was a poor example I gave. Imagine if column A was in the order <code>10 40 30 60 50 20</code> Then column C could not be sorted using the sort function as A is neither in ascending or descending order. Sorry for my earlier mistake."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 107, "user_id": 4309291, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c74f20a3e25734d1061af0831fcea048?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry", "link": "https://stackoverflow.com/users/4309291/jerry"}, "edited": false, "score": 0, "creation_date": 1442410735, "post_id": 32609317, "comment_id": 53071354, "body": "I have changed my answer based on your new data."}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1442410716, "last_edit_date": 1442410716, "creation_date": 1442408371, "answer_id": 32609317, "question_id": 32609045, "link": "https://stackoverflow.com/questions/32609045/excel-sort-based-on-first-column/32609317#32609317", "title": "Excel Sort based on first column", "body": "<p>In you VBA IDE go to the tools menu and selecte references. Select \"Microstoft ActiveX data objects 2.8 Library.</p>\n\n<pre><code>Private Sub CommandButton26_Click()\n\nDim rs As New ADODB.Recordset\nDim ws As Excel.Worksheet\nDim lrow As Long\n\n    Set ws = Application.ActiveSheet\n\n    'Add fields to your recordset for storing data.\n    With rs\n        .Fields.Append \"Row\", adInteger\n        .Fields.Append \"ColumnC\", adInteger\n        .Fields.Append \"ColumnD\", adInteger\n        .Open\n    End With\n\n    lrow = 1\n\n    'Loop through and record what is in Columns C and D\n    Do While lrow &lt;= ws.UsedRange.Rows.count\n\n        rs.AddNew\n        rs.Fields(\"Row\").Value = lrow\n        rs.Fields(\"ColumnC\").Value = ws.Range(\"C\" &amp; lrow).Value\n        rs.Fields(\"ColumnD\").Value = ws.Range(\"D\" &amp; lrow).Value\n        rs.Update\n\n        lrow = lrow + 1\n        ws.Range(\"A\" &amp; lrow).Activate\n    Loop\n\n    'Now go through and rewrite columns C and D based on what is in A\n    lrow = 1\n    Do While lrow &lt;= ws.UsedRange.Rows.count\n\n        rs.Filter = \"\"\n        rs.Filter = \"ColumnC='\" &amp; ws.Range(\"A\" &amp; lrow).Value &amp; \"'\"\n        'If we have a match, write C and D\n        If rs.RecordCount &gt; 0 Then\n            ws.Range(\"C\" &amp; lrow).Value = rs.Fields(\"ColumnC\").Value\n            ws.Range(\"D\" &amp; lrow).Value = rs.Fields(\"ColumnD\").Value\n        End If\n\n        lrow = lrow + 1\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "is_accepted": false, "score": 0, "last_activity_date": 1442410448, "last_edit_date": 1442410448, "creation_date": 1442410136, "answer_id": 32610000, "question_id": 32609045, "link": "https://stackoverflow.com/questions/32609045/excel-sort-based-on-first-column/32610000#32610000", "title": "Excel Sort based on first column", "body": "<p>Here is a small macro that you use which will sort your columns C based on column A and column D will be automatically sorted.<br>\nIt's uses <strong><code>'MATCH'</code></strong> function. I've placed the comments for your understanding.<br>\nAssuming your data is in column A:D and having header.  </p>\n\n<pre><code>Sub test1()\n    Dim sht As Worksheet\n    Dim rw As Long\n\n    'SELECTING THE SHEET (CHANGE ME)\n    Set sht = Sheets(\"Sheet2\")\n\n    'SETTING # OF ROWS\n    rw = sht.UsedRange.Rows.Count\n\n    'LOOPING AND PLACING FORMULA IN TEMPORARY COLUMN E\n    For i = 2 To rw\n        sht.Cells(i, 5).Value = \"=MATCH(C\" &amp; i &amp; \",$A$2:$A$\" &amp; rw &amp; \",0)\"\n    Next\n\n    'SORTING COLUMNS C,D AND E IN ASCENDING ORDER (WHICH WILL BE EXACTLY LIKE COLUMN A)\n    Range(\"C2:E\" &amp; rw).Sort Key1:=Range(\"E2:E\" &amp; rw), Order1:=xlAscending\n\n    'CLEARING THE TEMPORARY COLUMN E\n    Range(\"E2:E\" &amp; rw).Clear\n\n    'RELEASING THE OBJECT\n    Set sht = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 4309291, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c74f20a3e25734d1061af0831fcea048?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry", "link": "https://stackoverflow.com/users/4309291/jerry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 752, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1442411925, "creation_date": 1442407641, "last_edit_date": 1442411925, "question_id": 32609045, "link": "https://stackoverflow.com/questions/32609045/excel-sort-based-on-first-column", "title": "Excel Sort based on first column", "body": "<p>Just a quick question. Say I have four columns of data A, B, C and D.</p>\n\n<p><code>A   B   C   D\n10  1   10  8\n40  2   30  9\n30  3   60  12\n60  4   50  11\n50  5   40  13\n20  6   20  15</code></p>\n\n<p>How would I sort columns C and D based on the order of A? i.e I would want the following result;</p>\n\n<p><code>A   B   C   D\n10  1   10  8\n40  2   40  13\n30  3   30  9\n60  4   60  12\n50  5   50  11\n20  6   20  15</code></p>\n\n<p>See how Column C has arranged to be the same as A and The values in D corresponding to their neighboring cell in C has moved with them. I tried highlighting all the columns and sorting the data based on column A but it didn't work. Any ideas?</p>\n\n<p>Regards,\nJer</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2672288"}, "edited": false, "score": 0, "creation_date": 1442407530, "post_id": 32608487, "comment_id": 53068869, "body": "works a charm! thanks Heinzi, noted about option explicit, many thanks."}], "tags": [], "owner": {"reputation": 150063, "user_id": 87698, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33f12c2270fa9d3627845b9f41a08f4f?s=128&d=identicon&r=PG", "display_name": "Heinzi", "link": "https://stackoverflow.com/users/87698/heinzi"}, "is_accepted": true, "score": 1, "last_activity_date": 1442406139, "creation_date": 1442406139, "answer_id": 32608487, "question_id": 32608052, "link": "https://stackoverflow.com/questions/32608052/outlook-vba-move-email-to-folder-object-required/32608487#32608487", "title": "outlook vba - move email to folder, object required", "body": "<p><code>myInbox</code> is a local variable of <code>Application_Startup</code>. Thus, it's only accessible in <code>Application_Startup</code>.</p>\n\n<p>I <em>strongly</em> recommend to add <code>Option Explicit On</code> to the top of your module. This will alert you of such errors (and others).</p>\n\n<p>To solve your problem, either</p>\n\n<ul>\n<li><p>discover <code>myInbox</code> again in your <code>myItems_ItemAdd</code> method (you might want to extract your Application_Startup code into a method for that) or</p></li>\n<li><p>declare <code>myInbox</code> outside your method (just like <code>myItems</code>) to make it globally accessible. Note that such \"global variables\" should be used sparingly and only if really necessary.</p></li>\n</ul>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2672288"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 686, "favorite_count": 0, "accepted_answer_id": 32608487, "answer_count": 1, "score": 2, "last_activity_date": 1442406139, "creation_date": 1442404922, "question_id": 32608052, "link": "https://stackoverflow.com/questions/32608052/outlook-vba-move-email-to-folder-object-required", "title": "outlook vba - move email to folder, object required", "body": "<p>I'm trying to write some vba which will move emails as they are received into a certain folder. </p>\n\n<p>The code, so far, is:</p>\n\n<pre><code>Private WithEvents myItems as Outlook.Items\nPublic Sub Application_Startup()\n    Dim myApp as Outlook.Application\n    Dim myNameSpace as Outlook.NameSpace\n    Dim myInbox as Outlook.Folder\n\n    Set myApp = Outlook.Application\n    Set myNameSpace = myApp.GetNamespace(\"MAPI\")\n    Set myInbox = myNameSpace.GetDefaultFolder(olFolderInbox)\n    Set myItems = myInbox.Items\nEnd Sub\n\nPrivate Sub myItems_ItemAdd(ByVal item as Object)\n    Dim msg as Outlook.MailItem\n    Dim recips as String\n    Dim destFolder as Outlook.Folder\n\n    Set destFolder = myInbox.Folders(\"Test\")\n    Set msg = item\n    recips = msg.To\n    If InStr(recips, \"m0atz\") Then\n          msg.Move destFolder\n    End If\n\n    Set msg = nothing\n    Set destFolder = nothing\nEnd Sub\n</code></pre>\n\n<p>The issue I'm having is an error when an email is received from this line:</p>\n\n<pre><code>Set destFolder = myInbox.Folders(\"Test\")\n</code></pre>\n\n<p>saying \"run-time error 424 - Object Required\"</p>\n\n<p>Any ideas greatly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1442404261, "post_id": 32607379, "comment_id": 53066440, "body": "I&#39;m struggling to follow the logic of this code - but can&#39;t help thinking that you might be able to use conditional formatting for this instead..."}, {"owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1442404299, "post_id": 32607379, "comment_id": 53066471, "body": "It is bit difficult to use conditional formatting.  This requirement is very specific (sometimes everyone feels that way)  But as explained in the question I try to match positive and negative values. And to avoid duplicate Once highlighted we avoid that on. Both positive and negative numbers are in the same column."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1442407688, "post_id": 32607379, "comment_id": 53068983, "body": "Perhaps you can show us an example of what goes right, and what goes wrong. I&#39;m struggling to visualize your problem."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1442409109, "post_id": 32607379, "comment_id": 53070083, "body": "Can you give an example of values (say three rows C, D and F) and show what goes wrong in it? You can post those values textually without need to upload a worksheet."}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "edited": false, "score": 0, "creation_date": 1442434031, "post_id": 32614062, "comment_id": 53086141, "body": "This is working almost perfect for me. Only problem is when there is a duplicate of negatives in column 4 which can be match against non-highlighted positives, this ignores those ones. For example we have -1.00 in column 4 for three consecutive times (with equal column 3 and 6) and there three 1.00 values as well. But the code only picks the first pair and ignores the other couple of pairs."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "edited": false, "score": 0, "creation_date": 1442451806, "post_id": 32614062, "comment_id": 53092321, "body": "Hi. Did you get it working or do you want me to edit the code to catch duplicates?"}, {"owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "edited": false, "score": 0, "creation_date": 1442454794, "post_id": 32614062, "comment_id": 53093066, "body": "I did it my own way as well.. If you could modify your one little bit to avoid duplication, it would be great. I am not even a beginner to arrays and lists and would love to see ur update. Only mistake on my program was variable design at the top. Thx anyway."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "edited": false, "score": 0, "creation_date": 1442501763, "post_id": 32614062, "comment_id": 53115814, "body": "That&#39;s all done and available as an edit in my post ... though it&#39;s always better to &#39;own&#39; your own code so well done for fixing yours."}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 0, "last_activity_date": 1442501422, "last_edit_date": 1442501422, "creation_date": 1442421139, "answer_id": 32614062, "question_id": 32607379, "link": "https://stackoverflow.com/questions/32607379/excel-vba-do-loop-work-for-some-but-not-for-all/32614062#32614062", "title": "Excel VBA - Do loop work for some but not for all", "body": "<p>It is rather tricky code to follow especially without the sample data, but from what I think you're saying it should do as you want it to. You'd almost have to go through manually to see what matches you're expecting and in what order and then step through your routine to see whether it matches as you think it should.</p>\n\n<p>I can't help thinking you'd be better off creating two lists: one with the negatives and the other with the positives and then just pair match one with the other. The code below does that. When I first wrote it, I thought you were saying in your post that you wanted to ignore duplicates, so this code does. If that isn't what you want to do then some adjustments will be needed.</p>\n\n<p>You could use any lists or arrays but I've gone for a collection because the key can be a concat of your three cell values and therefore a quick look-up.</p>\n\n<pre><code>Dim ws As Worksheet\nDim rng As Range\nDim posData As New Collection\nDim negData As New Collection\nDim key As String\nDim r As Long\nDim v As Variant\n\nSet ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\nOn Error Resume Next\nFor r = 1 To ws.UsedRange.Rows.Count\n    key = ws.Cells(r, 3).Text &amp; \" \" &amp; _\n          CStr(Abs(ws.Cells(r, 4).Value2)) &amp; \" \" &amp; _\n          ws.Cells(r, 6).Text\n    If ws.Cells(r, 4).Value2 &lt; 0 Then\n        negData.Add r, key\n    Else\n        posData.Add r, key\n    End If\nNext\n\nFor Each v In negData\n    key = ws.Cells(v, 3).Text &amp; \" \" &amp; _\n          CStr(Abs(ws.Cells(v, 4).Value2)) &amp; \" \" &amp; _\n          ws.Cells(v, 6).Text\n    Err.Clear\n    r = posData(key)\n    If Err = 0 Then\n        Set rng = Union(ws.Cells(v, 3), ws.Cells(v, 4), ws.Cells(v, 6), _\n                        ws.Cells(r, 3), ws.Cells(r, 4), ws.Cells(r, 6))\n        rng.Interior.ColorIndex = 37\n    End If\nNext\n</code></pre>\n\n<p><strong>Update: Code that includes duplicates</strong></p>\n\n<p>Below is some code that will do what you're asking. You mentioned that you were new to lists and arrays so I've written a solution that includes both for you to learn from.</p>\n\n<p>Important: I've used a <code>Dictionary</code> class which is useful for storing lists of data. In your Visual Basic Editor you will need to go to Tools -> References and select <code>Microsoft Scripting Runtime</code> in order to have access to this class.</p>\n\n<p>The way I attacked this was to have a <code>Dictionary</code> of unique values (Dcol, Ccol and Fcol) and within each <code>Item</code> another <code>Dictionary</code> containing all the duplicate values. For each new row, the code checks whether there's an unpaired reciprocal value already in the <code>Dictionary</code>. If there is, then it pairs up the two and paints the cells; if not it adds the values to the dictionary and moves on.</p>\n\n<p>Where this might suit your needs better is that it only loops through the worksheet once whereas yours checks the whole worksheet for each and every row ... 10 x 10 is fine but 10,000 x 10,000 would have a time issue for the user.</p>\n\n<p>Enjoy!</p>\n\n<pre><code>Public Sub MatchMaker()\n\n    Const SEP As String = \"|\"\n\n    Dim singlesClub As Dictionary\n    Dim duplicateSinglies As Dictionary\n    Dim aMatchForMe(1) As String\n\n    Dim ws As Worksheet\n    Dim rng As Range\n    Dim rowNum As Long\n    Dim startRow As Long\n    Dim endRow As Long\n    Dim cText As String\n    Dim dVal As Integer\n    Dim fText As String\n\n    ' Initialise the objects.\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set singlesClub = New Dictionary\n    Set duplicateSinglies = New Dictionary\n\n    ' Define the loop parameters.\n    startRow = IIf(Len(ws.Cells(1, \"D\").Text) &gt; 0, 1, ws.Cells(1, \"D\").End(xlDown).Row)\n    endRow = ws.Cells(ws.Rows.Count, \"D\").End(xlUp).Row\n\n    ' Loop through the worksheet.\n    For rowNum = startRow To endRow\n\n        ' Check the row is valid.\n        If Len(ws.Cells(rowNum, \"C\").Text) &gt; 0 And _\n           Len(ws.Cells(rowNum, \"D\").Text) &gt; 0 And _\n           Len(ws.Cells(rowNum, \"F\").Text) &gt; 0 And _\n           IsNumeric(ws.Cells(rowNum, \"D\")) Then\n\n            ' Create the key name - used to identify our dictionary items,\n            ' and assign to the key array.\n            cText = ws.Cells(rowNum, \"C\").Text\n            dVal = ws.Cells(rowNum, \"D\").Value2\n            fText = ws.Cells(rowNum, \"F\").Text\n\n            ' Array index: 0=this key, 1=reciprocal \"D\" value key.\n            aMatchForMe(0) = CStr(dVal) &amp; SEP &amp; cText &amp; SEP &amp; fText\n            aMatchForMe(1) = CStr(dVal * -1) &amp; SEP &amp; cText &amp; SEP &amp; fText\n\n            ' Define the range of this row\n            Set rng = Union(ws.Cells(rowNum, \"C\"), _\n                               ws.Cells(rowNum, \"D\"), _\n                               ws.Cells(rowNum, \"F\"))\n\n\n            ' Check to see if the reciprocal key exists in the unpaired dictionary.\n            ' If it does, then we have at least one match.\n            ' If it doesn't then we must add this key to the unpaired dictionary.\n\n            If singlesClub.Exists(aMatchForMe(1)) Then\n\n                ' Take the first of the duplicate values and acquire its range\n                Set duplicateSinglies = singlesClub(aMatchForMe(1))\n\n                ' Fill the cells of both pairs.\n                Set rng = Union(duplicateSinglies.Items(0), rng)\n                rng.Interior.ColorIndex = (rowNum Mod 17) + 2\n\n                ' Remove the value from the unpaired dictionary.\n                duplicateSinglies.Remove (duplicateSinglies.Keys(0))\n                If duplicateSinglies.Count = 0 Then singlesClub.Remove (aMatchForMe(1))\n\n            Else\n\n                ' Add this value to the unpaired list.\n                If singlesClub.Exists(aMatchForMe(0)) Then\n                    Set duplicateSinglies = singlesClub(aMatchForMe(0))\n                    duplicateSinglies.Add rowNum, rng\n                Else\n                    Set duplicateSinglies = New Dictionary\n                    duplicateSinglies.Add rowNum, rng\n                    singlesClub.Add aMatchForMe(0), duplicateSinglies\n                End If\n\n            End If\n\n        End If\n\n    Next\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "is_accepted": true, "score": 0, "last_activity_date": 1442445159, "creation_date": 1442445159, "answer_id": 32620231, "question_id": 32607379, "link": "https://stackoverflow.com/questions/32607379/excel-vba-do-loop-work-for-some-but-not-for-all/32620231#32620231", "title": "Excel VBA - Do loop work for some but not for all", "body": "<p>Finally get there.</p>\n\n<pre><code>Sub Button1_Click()\nDim rownumber As Integer\nDim ColumnC, ColumnF, ColumnC1, ColumnF1 As String\nDim ColumnD, ColumnD1 As Single\nDim subrownumber As Integer\nDim Condition As Boolean\nrownumber = 1\nDo\n    ColumnD = Cells(rownumber, 4).Value\n    ColumnC = Cells(rownumber, 3).Value\n    ColumnF = Cells(rownumber, 6).Value\n    Condition = False\n\nIf (ColumnD &lt; 0) Then\n    subrownumber = 1\n    Do\n        ColumnD1 = Cells(subrownumber, 4).Value\n        ColumnC1 = Cells(subrownumber, 3).Value\n        ColumnF1 = Cells(subrownumber, 6).Value\n            If (ColumnD1 = ColumnD * -1 And ColumnF1 = ColumnF And ColumnC1 = ColumnC) And _\n             Cells(subrownumber, 4).Interior.ColorIndex &lt;&gt; 37 And _\n             Cells(rownumber, 4).Interior.ColorIndex &lt;&gt; 37 Then\n                Cells(subrownumber, 4).Interior.ColorIndex = 37\n                Cells(subrownumber, 3).Interior.ColorIndex = 37\n                Cells(subrownumber, 6).Interior.ColorIndex = 37\n                Cells(rownumber, 4).Interior.ColorIndex = 37\n                Cells(rownumber, 3).Interior.ColorIndex = 37\n                Cells(rownumber, 6).Interior.ColorIndex = 37\n                Condition = True\n            End If\n    subrownumber = subrownumber + 1\n    Loop Until IsEmpty(Cells(subrownumber, 4)) Or Condition = True\nEnd If\nrownumber = rownumber + 1\nLoop Until IsEmpty(Cells(rownumber, 4))\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 32620231, "answer_count": 2, "score": 0, "last_activity_date": 1442501422, "creation_date": 1442403051, "question_id": 32607379, "link": "https://stackoverflow.com/questions/32607379/excel-vba-do-loop-work-for-some-but-not-for-all", "title": "Excel VBA - Do loop work for some but not for all", "body": "<p>I am trying to highlight certain cells based on it's column 4 values.</p>\n\n<p>Basically, If column 4 value is negative, then we search through the column 4 from the beginning and if there is positive match (That is positive of the column 4 value and then matching the respective column 3 and 6 values) then highlight all those together.</p>\n\n<p>Additionally, once paired and highlighted, it should not be picked again in the middle loop therefore another condition added there.</p>\n\n<p>This code is doing my job to an extent. But in between it misses some negative values that can match against the positives. Any help would be greatly appreciated</p>\n\n<pre><code>Sub Button1_Click()\nDim rownumber As Integer\nDim ColumnC, ColumnF, ColumnC1, ColumnF1 As String\nDim ColumnD, ColumnD1 As Integer\nDim subrownumber As Integer\nDim Condition As Boolean\n\nrownumber = 1\n\nDo\nColumnD = Cells(rownumber, 4).Value\nColumnC = Cells(rownumber, 3).Value\nColumnF = Cells(rownumber, 6).Value\nCondition = False\n\nIf (ColumnD &lt; 0) Then\n    subrownumber = 1\n    Do\n    ColumnD1 = Cells(subrownumber, 4).Value\n    ColumnC1 = Cells(subrownumber, 3).Value\n    ColumnF1 = Cells(subrownumber, 6).Value\n            If (ColumnD1 = ColumnD * -1 And ColumnF1 = ColumnF And ColumnC1 = ColumnC) And _\n              Cells(subrownumber, 4).Interior.ColorIndex &lt;&gt; 37 Then\n\n                Cells(subrownumber, 4).Interior.ColorIndex = 37\n                Cells(subrownumber, 3).Interior.ColorIndex = 37\n                Cells(subrownumber, 6).Interior.ColorIndex = 37\n                Cells(rownumber, 4).Interior.ColorIndex = 37\n                Cells(rownumber, 3).Interior.ColorIndex = 37\n                Cells(rownumber, 6).Interior.ColorIndex = 37\n                Condition = True\n            End If\n    subrownumber = subrownumber + 1\n    Loop Until IsEmpty(Cells(subrownumber, 4)) Or Condition = True\nEnd If\nrownumber = rownumber + 1\nLoop Until IsEmpty(Cells(rownumber, 4))\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5342008, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QW-s9IrYhAU/AAAAAAAAAAI/AAAAAAAAACc/Qj2ZiEuQzi8/photo.jpg?sz=128", "display_name": "ZAINAB MALIK", "link": "https://stackoverflow.com/users/5342008/zainab-malik"}, "edited": false, "score": 0, "creation_date": 1442404470, "post_id": 32607442, "comment_id": 53066573, "body": "Windows(&quot;Archroma Pakistan Ltd.xls&quot;).Activate"}, {"owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "reply_to_user": {"reputation": 1, "user_id": 5342008, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QW-s9IrYhAU/AAAAAAAAAAI/AAAAAAAAACc/Qj2ZiEuQzi8/photo.jpg?sz=128", "display_name": "ZAINAB MALIK", "link": "https://stackoverflow.com/users/5342008/zainab-malik"}, "edited": false, "score": 0, "creation_date": 1442404564, "post_id": 32607442, "comment_id": 53066639, "body": "Windows(&quot;Al-Fazal Associates (Pvt) Ltd.&quot;).Activate"}, {"owner": {"reputation": 1, "user_id": 5342008, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QW-s9IrYhAU/AAAAAAAAAAI/AAAAAAAAACc/Qj2ZiEuQzi8/photo.jpg?sz=128", "display_name": "ZAINAB MALIK", "link": "https://stackoverflow.com/users/5342008/zainab-malik"}, "edited": false, "score": 0, "creation_date": 1442404579, "post_id": 32607442, "comment_id": 53066649, "body": "i am using this format &quot;Windows(&quot;Archroma Pakistan Ltd.xls&quot;).Activate&quot; but i  want to run this same macro on many sheets, without changes in macro ,"}, {"owner": {"reputation": 1, "user_id": 5342008, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QW-s9IrYhAU/AAAAAAAAAAI/AAAAAAAAACc/Qj2ZiEuQzi8/photo.jpg?sz=128", "display_name": "ZAINAB MALIK", "link": "https://stackoverflow.com/users/5342008/zainab-malik"}, "edited": false, "score": 0, "creation_date": 1442404791, "post_id": 32607442, "comment_id": 53066814, "body": "i want to apply this macro on all workbooks and want to save on them location, but i think <b>loop</b> or <b>Variable</b> is required :("}], "tags": [], "owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "is_accepted": false, "score": 0, "last_activity_date": 1442403227, "creation_date": 1442403227, "answer_id": 32607442, "question_id": 32607295, "link": "https://stackoverflow.com/questions/32607295/excel-macro-with-template-want-to-use-it-many-different-reports-but-em-stuck-on/32607442#32607442", "title": "Excel Macro With template, want to use it many different reports but em stuck on it", "body": "<p>Hope you know whether mistake is.</p>\n\n<pre><code>Windows(\"**Archroma Pakistan Ltd.xls**\").Activate\n</code></pre>\n\n<p>So you need to change that name to the relevant sheet name if you need to work for others as well. Hope all the reports are in the same format.</p>\n"}, {"tags": [], "owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "is_accepted": false, "score": 0, "last_activity_date": 1442404769, "creation_date": 1442404769, "answer_id": 32607993, "question_id": 32607295, "link": "https://stackoverflow.com/questions/32607295/excel-macro-with-template-want-to-use-it-many-different-reports-but-em-stuck-on/32607993#32607993", "title": "Excel Macro With template, want to use it many different reports but em stuck on it", "body": "<p>Try this answer then.</p>\n\n<pre><code>ActiveWorkbook.ActiveSheet.select \n</code></pre>\n\n<p>instead the above one</p>\n"}], "owner": {"reputation": 1, "user_id": 5342008, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QW-s9IrYhAU/AAAAAAAAAAI/AAAAAAAAACc/Qj2ZiEuQzi8/photo.jpg?sz=128", "display_name": "ZAINAB MALIK", "link": "https://stackoverflow.com/users/5342008/zainab-malik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1442409569, "creation_date": 1442402823, "last_edit_date": 1442409569, "question_id": 32607295, "link": "https://stackoverflow.com/questions/32607295/excel-macro-with-template-want-to-use-it-many-different-reports-but-em-stuck-on", "title": "Excel Macro With template, want to use it many different reports but em stuck on it", "body": "<p>I am using below mention macro with template for formatted my daily reports,\nbut the issue is, its just working on 1 specific name sheet(Archroma Pakistan Ltd.xls), i want to use it for 35 more reports, for example:</p>\n\n<p>\"Al-Fazal Associates (Pvt) Ltd.\"<br>\n\"Capital Assets Leasing Corporation Limited\"<br>\n\"Carvan Carriage Company (Chevron 425)\"</p>\n\n<pre><code>Sub Macro17()\n    '\n    ' Macro17 Macro\n    ' loc\n    '\n    ' Keyboard Shortcut: Ctrl+Shift+O\n    '\n    Columns(\"F:R\").Select\n    Selection.Delete Shift:=xlToLeft\n    Columns(\"G:K\").Select\n    Selection.Delete Shift:=xlToLeft\n    Range(\"A1\").Select\n    'Windows(\"UEPL - Copy.xls\").Activate\n    Windows(\"**Archroma Pakistan Ltd.xls**\").Activate\n    Range(\"A3\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Selection.Copy\n    Workbooks.Add Template:= \"\\\\172.16.4.241\\Analysis\\NR Status11.xltm\"\n    'Windows(\"NR Status11\").Activate\n    Windows(\"NR Status111\").Activate\n    Range(\"A14\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n    Range(\"A15\").Select\n    Selection.End(xlDown).Select\n    Selection.End(xlUp).Select\n    Rows(\"24:24\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    ActiveWindow.ScrollRow = 15\n    ActiveWindow.ScrollRow = 17\n    ActiveWindow.ScrollRow = 19\n    ActiveWindow.ScrollRow = 22\n    ActiveWindow.ScrollRow = 24\n    ActiveWindow.ScrollRow = 26\n    ActiveWindow.ScrollRow = 29\n    ActiveWindow.ScrollRow = 31\n    ActiveWindow.ScrollRow = 35\n    ActiveWindow.ScrollRow = 38\n    ActiveWindow.ScrollRow = 43\n    ActiveWindow.ScrollRow = 48\n    ActiveWindow.ScrollRow = 53\n    ActiveWindow.ScrollRow = 59\n    ActiveWindow.ScrollRow = 67\n    ActiveWindow.ScrollRow = 76\n    ActiveWindow.ScrollRow = 85\n    ActiveWindow.ScrollRow = 99\n    ActiveWindow.ScrollRow = 112\n    ActiveWindow.ScrollRow = 124\n    ActiveWindow.ScrollRow = 136\n    ActiveWindow.ScrollRow = 148\n    ActiveWindow.ScrollRow = 160\n    ActiveWindow.ScrollRow = 171\n    ActiveWindow.ScrollRow = 181\n    ActiveWindow.ScrollRow = 189\n    ActiveWindow.ScrollRow = 198\n    ActiveWindow.ScrollRow = 204\n    ActiveWindow.ScrollRow = 211\n    ActiveWindow.ScrollRow = 216\n    ActiveWindow.ScrollRow = 218\n    ActiveWindow.SmallScroll Down:=12\n    Rows(\"24:231\").Select\n    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n    Application.CutCopyMode = False\n    Range(\"A21\").Select\n    Selection.End(xlDown).Select\n    Range(\"A2:B2\").Select\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Selection.Merge\n    Range(\"A1\").Select\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1442405222, "post_id": 32606814, "comment_id": 53067130, "body": "Firstly, you have completely irrelevant tags on this question - what do <a href=\"https://stackoverflow.com/questions/tagged/mysql\">mysql</a> and <a href=\"https://stackoverflow.com/questions/tagged/vba\">vba</a> have to do with this? Second, you need to show us what you have tried yourself so far, and what isn&#39;t working. Finally this statement <i>&quot;The details are not too important...&quot;</i> this should never be assumed when asking a question that you do not know the answer to. Have a look at how to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 23, "user_id": 5341793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a4QTTv05SEM/AAAAAAAAAAI/AAAAAAAAACQ/AijlklNrFDk/photo.jpg?sz=128", "display_name": "Ellz", "link": "https://stackoverflow.com/users/5341793/ellz"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1442406719, "post_id": 32606814, "comment_id": 53068261, "body": "Okay give me a moment."}, {"owner": {"reputation": 23, "user_id": 5341793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a4QTTv05SEM/AAAAAAAAAAI/AAAAAAAAACQ/AijlklNrFDk/photo.jpg?sz=128", "display_name": "Ellz", "link": "https://stackoverflow.com/users/5341793/ellz"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1442407633, "post_id": 32606814, "comment_id": 53068934, "body": "Thanks Macro man, I&#39;ll have a look and learn from the link."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1442407806, "post_id": 32606814, "comment_id": 53069072, "body": "Just to clarify, my comment wasn&#39;t intended to be an &quot;ear-bashing&quot;, just to highlight that as it currently stands it isn&#39;t entirely clear what you are asking. For example I would have attempted to answer this with a <a href=\"https://stackoverflow.com/questions/tagged/powershell\">powershell</a> script because of the title and your mention of &#39;COM objects&#39; but it appears that you want a <a href=\"https://stackoverflow.com/questions/tagged/vba\">vba</a> solution instead. StackOverflow gets it success from the people that volunteer their time - so if you can help them to help you - it makes the world a better place :)"}, {"owner": {"reputation": 23, "user_id": 5341793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a4QTTv05SEM/AAAAAAAAAAI/AAAAAAAAACQ/AijlklNrFDk/photo.jpg?sz=128", "display_name": "Ellz", "link": "https://stackoverflow.com/users/5341793/ellz"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1442408045, "post_id": 32606814, "comment_id": 53069266, "body": "I initially though you were a grumpy man but on reflection my question would be extremely vague and frustrating for anyone trying to help :(  Thanks for the help and taking the time!"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1442408447, "post_id": 32606814, "comment_id": 53069598, "body": "I&#39;m grumpy in real life :) - But no worries. The other (less important) thing with tags is that they drive the <a href=\"http://meta.stackexchange.com/questions/184108/what-is-syntax-highlighting-and-how-does-it-work\">syntax highlighting</a> for the Q&amp;A on the page. In this case I&#39;ve edited the answers to &#39;force&#39; the correct highlighting as they were defaulting to <a href=\"https://stackoverflow.com/questions/tagged/powershell\">powershell</a>"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5341793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a4QTTv05SEM/AAAAAAAAAAI/AAAAAAAAACQ/AijlklNrFDk/photo.jpg?sz=128", "display_name": "Ellz", "link": "https://stackoverflow.com/users/5341793/ellz"}, "edited": false, "score": 0, "creation_date": 1442407396, "post_id": 32608685, "comment_id": 53068757, "body": "This is exactly what I want Ambie.  Thank you so much!   The values in J are indeed a string e.g 1918ERACSD7362  I just needed to see how someone could do it, so i can learn how it works and patch it together thanks again!"}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 1, "last_activity_date": 1442407890, "last_edit_date": 1442407890, "creation_date": 1442406623, "answer_id": 32608685, "question_id": 32606814, "link": "https://stackoverflow.com/questions/32606814/manipulating-excel-spreadsheet-removing-rows-based-on-values-in-a-column-and-th/32608685#32608685", "title": "Manipulating Excel spreadsheet, removing rows based on values in a column and then removing more rows based on values in another column", "body": "<p>Ellz, I do agree with Macro Man in that your tags are misleading and, more importantly, I did indeed need to know the details of Column J.</p>\n\n<p>However, I got so sick of rude posts today and yours was polite and respectful so I've pasted some code below that will do the trick ... provided Column J can be a string (the details of which you haven't given us ... see what Macro Man's getting at?).</p>\n\n<p>There are many ways to test for duplicates. One is to try and add a unique key to a collection and see if it throws an error. Many wouldn't like that philosophy but it seemed to be okay for you because it also gives you a collection of all the unique (ie remaining) keys in Column J.\n</p>\n\n<pre><code>Sub Delete102sAndDuplicates()\n    Dim ws As Worksheet\n    Dim uniques As Collection\n    Dim rng As Range\n    Dim rowPair As Range\n    Dim iCell As Range\n    Dim jCell As Range\n    Dim delRows As Range\n\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set rng = Intersect(ws.UsedRange, ws.Range(\"I:J\"))\n    Set uniques = New Collection\n\n    For Each rowPair In rng.Rows\n\n        Set iCell = rowPair.Cells(, 1)\n        Set jCell = rowPair.Cells(, 2)\n\n        On Error Resume Next\n        uniques.Add jCell.Value2, jCell.Text\n\n        If Err = 457 Or iCell.Value2 = 102 Then\n            On Error GoTo 0\n            If delRows Is Nothing Then\n                Set delRows = rowPair.EntireRow\n            Else\n                Set delRows = Union(delRows, rowPair.EntireRow)\n            End If\n        End If\n\n    Next\n\n    If Not delRows is Nothing then\n        MsgBox delRows.Address(False, False) &amp; \" deleted.\"\n        delRows.Delete\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 5341793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a4QTTv05SEM/AAAAAAAAAAI/AAAAAAAAACQ/AijlklNrFDk/photo.jpg?sz=128", "display_name": "Ellz", "link": "https://stackoverflow.com/users/5341793/ellz"}, "edited": false, "score": 0, "creation_date": 1442407927, "post_id": 32608988, "comment_id": 53069160, "body": "VBA was welcomed as well thanks, I was more interested in how people do it so i could learn the code and then patch it together myself to cater to my needs."}, {"owner": {"reputation": 23, "user_id": 5341793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a4QTTv05SEM/AAAAAAAAAAI/AAAAAAAAACQ/AijlklNrFDk/photo.jpg?sz=128", "display_name": "Ellz", "link": "https://stackoverflow.com/users/5341793/ellz"}, "edited": false, "score": 0, "creation_date": 1442408168, "post_id": 32608988, "comment_id": 53069370, "body": "I&#39;d like to give extra thanks for taking the time to explain it to me as well It&#39;s very much appreciated!"}], "tags": [], "owner": {"reputation": 161, "user_id": 5260805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a405bb9c79d074fe80f5063b5ddd1060?s=128&d=identicon&r=PG&f=1", "display_name": "Roxton", "link": "https://stackoverflow.com/users/5260805/roxton"}, "is_accepted": false, "score": 0, "last_activity_date": 1442407917, "last_edit_date": 1442407917, "creation_date": 1442407479, "answer_id": 32608988, "question_id": 32606814, "link": "https://stackoverflow.com/questions/32606814/manipulating-excel-spreadsheet-removing-rows-based-on-values-in-a-column-and-th/32608988#32608988", "title": "Manipulating Excel spreadsheet, removing rows based on values in a column and then removing more rows based on values in another column", "body": "<p>There are a number of ways in which this can be done, and which is best will depend on how frequently you perform this task and whether you want to have it fully automated. Since you've tagged your question with <code>VBA</code> I assume you'll be happy with a VBA-based answer:\n</p>\n\n<pre><code>Sub removeValues()\n\nRange(\"I1\").Select  'Start at the top of the I column\n'We are going to go down the column until we hit an empty row\nDo Until IsEmpty(ActiveCell.Value) = True\n    If ActiveCell.Value &lt;&gt; 102 Then\n        ActiveCell.EntireRow.Delete 'Then delete the row\n    Else\n        ActiveCell.Offset(1).Select 'Select the cell below\n    End If\nLoop\n\n'Now we have removed all non-102 values from the column, let`s remove the duplicates from the J column\nRange(\"A:J\").RemoveDuplicates Columns:=10, Header:=xlNo\n\nEnd Sub\n</code></pre>\n\n<p>The key line there is <code>Range(\"A:J\").RemoveDuplicates</code>. It will remove rows from the range you specify according to duplicates it finds in the column you specify. In that case, it will remove items from the A-J columns based on duplicates in column 10 (which is J). If your data extends beyond the <code>J</code> column, then you'll need to replace <code>\"A:J\"</code> with the appropriate range. Note that the <code>Columns</code> value is relative to the index of the first column, so while the <code>J</code> column is <code>10</code> when that range starts at A (1), it would be <code>2</code> for example if the range were only <code>I:J</code>. Does that make sense?</p>\n\n<p>(Note: Using <code>ActiveCell</code> is not really best practice, but it's the method that most obviously translates to what you were trying to do and as it seems you're new to VBA I thought it would be the easiest to understand).</p>\n"}], "owner": {"reputation": 23, "user_id": 5341793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a4QTTv05SEM/AAAAAAAAAAI/AAAAAAAAACQ/AijlklNrFDk/photo.jpg?sz=128", "display_name": "Ellz", "link": "https://stackoverflow.com/users/5341793/ellz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 32608685, "answer_count": 2, "score": 1, "last_activity_date": 1442408038, "creation_date": 1442401431, "last_edit_date": 1442408038, "question_id": 32606814, "link": "https://stackoverflow.com/questions/32606814/manipulating-excel-spreadsheet-removing-rows-based-on-values-in-a-column-and-th", "title": "Manipulating Excel spreadsheet, removing rows based on values in a column and then removing more rows based on values in another column", "body": "<p>I have a rather complicated problem. </p>\n\n<p>I have a log file that when put into excel the column \"I\" contains event IDs, and the column J contains a custom key that keeps a particular even grouped. </p>\n\n<p>All i want to do is remove any rows that do not contain the value of say 102 in the event id column. \nAnd THEN i need to check the custom key (column J) and remove rows that are duplicates since any duplicates will falsely show other statistics i want.</p>\n\n<p>I have gotten as far as being able to retrieve the values from the columns using com objects and .entirecolumn cell value etc, but I am completely stumped as to how i can piece together a solid way to remove rows. I could not figure out how to get the row for each value. </p>\n\n<p>To give a bit more clarity this is my thought process on what i need to do:</p>\n\n<p>If cell value in Column I does not = 102 Then delete the row that cell contains.\nRepeat for all rows in spreadsheet. \nAnd THEN-\nRead every cell in column J and remove all rows containing duplicates based on the values in column J. \nSave spreadsheet.</p>\n\n<p>Can any kind persons help me? </p>\n\n<hr>\n\n<hr>\n\n<p>Additional Info:</p>\n\n<p>Column I holds a string that is an event id number e.g = 1029\nColumn J holds a string that is a mix of numbers and letters = 1ASER0X3NEX0S</p>\n"}, {"tags": ["excel", "vba", "date", "numbers", "format"], "comments": [{"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 1, "creation_date": 1442402144, "post_id": 32606798, "comment_id": 53065063, "body": "Max <code>Integer</code> vaue is <code>32767</code>. Define <code>IntMonth</code> as <code>Long</code>, and use <code>DateValue</code> instead of <code>CInt</code>."}, {"owner": {"reputation": 105, "user_id": 4399510, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99db940a09e784892952cf786cd81cd3?s=128&d=identicon&r=PG&f=1", "display_name": "Nelus", "link": "https://stackoverflow.com/users/4399510/nelus"}, "reply_to_user": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1442405287, "post_id": 32606798, "comment_id": 53067173, "body": "You can also overcome this problem by converting the date to a String before using it as a key. That way, the dictionary key preserves the &#39;yyyy/mm/dd&#39; format."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 4399510, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99db940a09e784892952cf786cd81cd3?s=128&d=identicon&r=PG&f=1", "display_name": "Nelus", "link": "https://stackoverflow.com/users/4399510/nelus"}, "edited": false, "score": 0, "creation_date": 1442405189, "post_id": 32607159, "comment_id": 53067109, "body": "Fantastic! Realise now that the number exceeded the Integer limit (hence &#39;overflow&#39; error) - I should&#39;ve used Long from the start."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 3, "last_activity_date": 1442402435, "creation_date": 1442402435, "answer_id": 32607159, "question_id": 32606798, "link": "https://stackoverflow.com/questions/32606798/how-to-change-from-date-format-to-number-in-excel-vba/32607159#32607159", "title": "How to change from date format to number in Excel VBA?", "body": "<p>A tiny trick!</p>\n\n<pre><code>Sub dural()\n    IntMonth = CLng(CDate(\"2012/05/11\"))\n    MsgBox IntMonth\nEnd Sub\n</code></pre>\n\n<p>This is because <strong><em>CDate()</em></strong> is REALLY flexible.</p>\n"}], "owner": {"reputation": 105, "user_id": 4399510, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99db940a09e784892952cf786cd81cd3?s=128&d=identicon&r=PG&f=1", "display_name": "Nelus", "link": "https://stackoverflow.com/users/4399510/nelus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3759, "favorite_count": 0, "accepted_answer_id": 32607159, "answer_count": 1, "score": 2, "last_activity_date": 1442402435, "creation_date": 1442401385, "question_id": 32606798, "link": "https://stackoverflow.com/questions/32606798/how-to-change-from-date-format-to-number-in-excel-vba", "title": "How to change from date format to number in Excel VBA?", "body": "<p>I store items in a dictionary with the key being a date e.g. '2012/05/11'\nThe key is then changed to a number (41040) by default.\nWhen I want to retrieve that item, I need to reference it by the number: dFRmonths.Item(41040). Since dFRmonths.Item(\"2012/05/11\") does not exist.</p>\n\n<p>I only have the date, not the number, so I need to convert the date to a number, then use the number to do the lookup.</p>\n\n<p>Trying to convert a date to a number gives an 'overflow' error:</p>\n\n<pre><code>IntMonth = CInt(\"2012/05/11\")\n</code></pre>\n\n<p>Any idea how to change \"2012/05/11\" into 41040 so I can look it up?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["r", "excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1442402791, "post_id": 32606771, "comment_id": 53065458, "body": "In VBA you could use the range object and the Formula property to get the formula in the cell... so you could start by loop through all the ranges in the table, and outputting the formula..."}, {"owner": {"reputation": 448, "user_id": 5341912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02bde2966f0cae37565803007dafa9dc?s=128&d=identicon&r=PG&f=1", "display_name": "Stanislav", "link": "https://stackoverflow.com/users/5341912/stanislav"}, "reply_to_user": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1442407045, "post_id": 32606771, "comment_id": 53068498, "body": "@OurManInBananas thanks for the advice, but when i try to output the formula, i see again only &quot;TABLE(F2, C2)&quot;. Unfortunately i have no experiencein excel, is it real to extract so non-direct reference?"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1442407822, "post_id": 32606771, "comment_id": 53069081, "body": "Can you show us an example of the formulae that are in the cells you want?"}, {"owner": {"reputation": 448, "user_id": 5341912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02bde2966f0cae37565803007dafa9dc?s=128&d=identicon&r=PG&f=1", "display_name": "Stanislav", "link": "https://stackoverflow.com/users/5341912/stanislav"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1442410300, "post_id": 32606771, "comment_id": 53071011, "body": "@Luuklag thank you, i have updated my answer (added example)"}, {"owner": {"reputation": 604, "user_id": 6357666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c39803479fc8babcb4a0949a1932654?s=128&d=identicon&r=PG", "display_name": "user20637", "link": "https://stackoverflow.com/users/6357666/user20637"}, "edited": false, "score": 1, "creation_date": 1442419729, "post_id": 32606771, "comment_id": 53077906, "body": "I suspect that the {} indicates that this is an &quot;array formula&quot; and that NAME is a &quot;name[d range]&quot;. In VBA you can access the lists of names using the Worksheet.Names and Workbook.Names properties. For each name you can see what it refers to using the Name.RefersTo property."}, {"owner": {"reputation": 604, "user_id": 6357666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c39803479fc8babcb4a0949a1932654?s=128&d=identicon&r=PG", "display_name": "user20637", "link": "https://stackoverflow.com/users/6357666/user20637"}, "edited": false, "score": 0, "creation_date": 1442420074, "post_id": 32606771, "comment_id": 53078148, "body": "Outside VBA you can see/manage names using Name Manager on the Formulas tab."}, {"owner": {"reputation": 448, "user_id": 5341912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02bde2966f0cae37565803007dafa9dc?s=128&d=identicon&r=PG&f=1", "display_name": "Stanislav", "link": "https://stackoverflow.com/users/5341912/stanislav"}, "reply_to_user": {"reputation": 604, "user_id": 6357666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c39803479fc8babcb4a0949a1932654?s=128&d=identicon&r=PG", "display_name": "user20637", "link": "https://stackoverflow.com/users/6357666/user20637"}, "edited": false, "score": 1, "creation_date": 1442420714, "post_id": 32606771, "comment_id": 53078559, "body": "@user20637 &quot;TABLE&quot; is not named constant, it is special word, so i can&#39;t get access to it from Name Manager"}], "answers": [{"comments": [{"owner": {"reputation": 448, "user_id": 5341912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02bde2966f0cae37565803007dafa9dc?s=128&d=identicon&r=PG&f=1", "display_name": "Stanislav", "link": "https://stackoverflow.com/users/5341912/stanislav"}, "edited": false, "score": 0, "creation_date": 1442487239, "post_id": 32622176, "comment_id": 53106437, "body": "Thank you for the advice. But in my case it does not work. These cells (F2 and C2)  contains two popular parameters. Its are used in a variety of formulas."}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 1, "last_activity_date": 1442461504, "last_edit_date": 1442461504, "creation_date": 1442460771, "answer_id": 32622176, "question_id": 32606771, "link": "https://stackoverflow.com/questions/32606771/extract-formula-from-excel-data-table-what-if-analysis/32622176#32622176", "title": "Extract formula from Excel Data Table (What-If Analysis)", "body": "<p>I think in your example the <code>F2</code> and <code>C2</code> are effectively only the addresses of parameters for a function (<code>TABLE</code>) where that may be located anywhere, with the associated formula in the table's top left cell.  </p>\n\n<p>So I suggest go to <code>C2</code>, FORMULAS > Formula Auditing and click Trace Dependents, repeat for <code>F2</code> and see where the arrows converge.</p>\n"}, {"comments": [{"owner": {"reputation": 448, "user_id": 5341912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02bde2966f0cae37565803007dafa9dc?s=128&d=identicon&r=PG&f=1", "display_name": "Stanislav", "link": "https://stackoverflow.com/users/5341912/stanislav"}, "edited": false, "score": 0, "creation_date": 1442490735, "post_id": 32629062, "comment_id": 53108324, "body": "thank you, it was really usefull, especially &quot;TABLE(Rowinp, Colinp) Neither blank. The formula is that in the cell at the intersection of the left and top margins with instances of Rowinp replaced by values from the upper margin of the same column and instances of Colinp replaced by values from the the left margin of the same row.&quot;"}, {"owner": {"reputation": 604, "user_id": 6357666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c39803479fc8babcb4a0949a1932654?s=128&d=identicon&r=PG", "display_name": "user20637", "link": "https://stackoverflow.com/users/6357666/user20637"}, "reply_to_user": {"reputation": 448, "user_id": 5341912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02bde2966f0cae37565803007dafa9dc?s=128&d=identicon&r=PG&f=1", "display_name": "Stanislav", "link": "https://stackoverflow.com/users/5341912/stanislav"}, "edited": false, "score": 0, "creation_date": 1442492144, "post_id": 32629062, "comment_id": 53109177, "body": "@StanislavAbs If it meets your needs, can you accept the answer?"}], "tags": [], "owner": {"reputation": 604, "user_id": 6357666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c39803479fc8babcb4a0949a1932654?s=128&d=identicon&r=PG", "display_name": "user20637", "link": "https://stackoverflow.com/users/6357666/user20637"}, "is_accepted": true, "score": 2, "last_activity_date": 1442488747, "creation_date": 1442488747, "answer_id": 32629062, "question_id": 32606771, "link": "https://stackoverflow.com/questions/32606771/extract-formula-from-excel-data-table-what-if-analysis/32629062#32629062", "title": "Extract formula from Excel Data Table (What-If Analysis)", "body": "<p>I'm using Excel 2007 but have no reason to believe things differ in other versions. </p>\n\n<p>@Stanislav was right to reject my comment suggestion that TABLE was a name; it is an EXCEL function. But it is a very strange function :-}</p>\n\n<ul>\n<li>There isn't any help on the TABLE function in the local help, it isn't listed in \"List of worksheet functions (alphabetical)\".</li>\n<li>You can't manually enter or edit the TABLE function; error \"That function is not valid\".</li>\n<li>Copy/Pasting cells containing the TABLE function pastes their values, not their formulae, even when you specify Paste Special > Formulas</li>\n<li>You can't insert rows/columns immediately above/left of cells containing the TABLE function; error \"Cannot change part of a data table\". </li>\n<li>Pace @pnuts using Formulas > Formula Auditing cells containing the TABLE function shows no precedents and no cells show them as dependents. Although in a VBA sheet auditing tool which I use the Range.DirectDependents Property finds the \"formula range\" dependent on the \"margin\" cells containing the formulas, but not those containg the values (see below for explanation of those terms).</li>\n</ul>\n\n<p>I haven't been able to find anything I regard as decent documentation of TABLE(). I have found lots of illustrations of how to produce and use that function, but nothing clearly specifying the arguments and result. The best I've found is <a href=\"https://support.office.com/en-us/article/Calculate-multiple-results-by-using-a-data-table-e95e2487-6ca6-4413-ad12-77542a5ea50b\" rel=\"nofollow\">https://support.office.com/en-us/article/Calculate-multiple-results-by-using-a-data-table-e95e2487-6ca6-4413-ad12-77542a5ea50b</a>. I'd be pleased if anyone can point me to better documentation.</p>\n\n<p>I deduce the bahaviour as described here:</p>\n\n<p>TABLE(Rowinp,Colinp) is an array formula in a contiguous array of cells. I'll refer to that contiguous array as the \"formula range\" of the data table. \nThe cells immediately above/left of the formula range are also part of the data table, even though they do not contain a TABLE() function and can be edited; I'll refer to those cells as the \"margins\" of the data table.</p>\n\n<p>Rowinp and Colinp must be blank or references to single cells. \nRowinp and Colinp must be different (or error \"Input cell reference is not valid\"), they must not both be blank.</p>\n\n<p>The values in the formula range are calculated by taking formula(s) from the margin(s) and substituting references to Rowinp and/or Colinp with values from the margin(s).</p>\n\n<p>There are three mutually exclusive possibilities, corresponding to Rowinp blank or not.</p>\n\n<ol>\n<li>TABLE(Rowinp, ) Colinp blank. The formula is that in the left margin of the same row with instances of Rowinp replaced by values from the upper margin of the same column. </li>\n<li>TABLE( , Colinp)  Rowinp blank. The formula is that in the top margin of the same column with instances of Colinp replaced by values from the the left margin of the same row.</li>\n<li>TABLE(Rowinp, Colinp) Neither blank. The formula is that in the cell at the intersection of the left and top margins with instances of Rowinp replaced by values from the upper margin of the same column and instances of Colinp replaced by values from the the left margin of the same row.</li>\n</ol>\n\n<p>I think that should let you work out what the effective formula is in each cell of the formula range.</p>\n\n<p>But I wouldn't be surprised to learn that any of the above is wrong :-0<br>\nI welcome pointers to anything more authoritative.</p>\n"}], "owner": {"reputation": 448, "user_id": 5341912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02bde2966f0cae37565803007dafa9dc?s=128&d=identicon&r=PG&f=1", "display_name": "Stanislav", "link": "https://stackoverflow.com/users/5341912/stanislav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2151, "favorite_count": 0, "accepted_answer_id": 32629062, "answer_count": 2, "score": 5, "last_activity_date": 1463748674, "creation_date": 1442401289, "last_edit_date": 1531161705, "question_id": 32606771, "link": "https://stackoverflow.com/questions/32606771/extract-formula-from-excel-data-table-what-if-analysis", "title": "Extract formula from Excel Data Table (What-If Analysis)", "body": "<p>I am faced with rewriting an Excel project in R. I see a table in which a cell  <strong>{= TABLE (F2, C2)}</strong> is shown. I understand how to create a Table like this (What-If Analysis, Data Table...).</p>\n\n<p>As I have to understand this to rewrite in R, how can I find <strong>the original formula</strong> which stands behind that cell?  </p>\n\n<p>EXAMPLE: I have created a Data Table as shown <a href=\"http://www.excel-easy.com/examples/data-tables.html\" rel=\"noreferrer\">here</a> and the sheet looks like <a href=\"http://www.excel-easy.com/examples/images/data-tables/one-variable-data-table-result.png\" rel=\"noreferrer\">this</a>:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/VV4zG.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/VV4zG.png\" alt=\"SO32606771 question example\"></a> </p>\n\n<p>In my case, I don't know how the sheet was created, and I want to know the initial formula. Now this is shown as <code>{=TABLE(,C4)}</code>. \n(In the example I know the answer, it is in the cell (D10), but where is reference for this cell in Data Table?)</p>\n"}, {"tags": ["excel", "vba", "sorting"], "comments": [{"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1442401371, "post_id": 32606523, "comment_id": 53064542, "body": "You can add helper column with formula <code>=&quot;&quot;&amp;A1</code> and sort using it."}], "answers": [{"comments": [{"owner": {"reputation": 897, "user_id": 1044533, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/169630f634a264b46fb6761510679931?s=128&d=identicon&r=PG", "display_name": "MKII", "link": "https://stackoverflow.com/users/1044533/mkii"}, "edited": false, "score": 0, "creation_date": 1442404282, "post_id": 32606856, "comment_id": 53066458, "body": "But how can I force a VBA script to view the cell&#39;s content as a Text?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 897, "user_id": 1044533, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/169630f634a264b46fb6761510679931?s=128&d=identicon&r=PG", "display_name": "MKII", "link": "https://stackoverflow.com/users/1044533/mkii"}, "edited": false, "score": 0, "creation_date": 1442404559, "post_id": 32606856, "comment_id": 53066636, "body": "Use VBA to convert them into text and put the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840646.aspx\" rel=\"nofollow noreferrer\">Range.Sort method</a>&#39;s <code>DataOption:=xlSortNormal</code> option."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1442401547, "last_edit_date": 1592644375, "creation_date": 1442401547, "answer_id": 32606856, "question_id": 32606523, "link": "https://stackoverflow.com/questions/32606523/sorting-an-excel-column-by-value/32606856#32606856", "title": "Sorting an Excel Column by value", "body": "<p>If you format all of the values as <strong>Text</strong> you will be able to sort using the <strong>Sort numbers and numbers store as text differently</strong> option. This produces the results you are looking for.</p>\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/m0q7R.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/m0q7R.png\" alt=\"Sort Numbers as text\" /></a></p>\n<p>Of course, you will lose the benefit of dealing with true numbers and will have to watch out for lookups that are seeking a true number and not text-that-looks-like-a-number but as your values are already mixed, this might not be a bad thing.</p>\n"}], "owner": {"reputation": 897, "user_id": 1044533, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/169630f634a264b46fb6761510679931?s=128&d=identicon&r=PG", "display_name": "MKII", "link": "https://stackoverflow.com/users/1044533/mkii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 32606856, "answer_count": 1, "score": 1, "last_activity_date": 1442401547, "creation_date": 1442400634, "question_id": 32606523, "link": "https://stackoverflow.com/questions/32606523/sorting-an-excel-column-by-value", "title": "Sorting an Excel Column by value", "body": "<p>I have a column with ID values, like these:</p>\n\n<pre><code>50\n14G\n44\n2X\n22\n</code></pre>\n\n<p>I would like to sort it by \"digit value\" using VBA, so I get a list like this</p>\n\n<pre><code>14G\n22\n2X\n44\n50\n</code></pre>\n\n<p>Since numbers should come before letters, and digits' relevance comes from their position. However, if I use Range().Sort I get a list like this:</p>\n\n<pre><code>22\n44\n50\n14G\n2X\n</code></pre>\n\n<p>Which is how Excel sorts it alphabetically. Is there a way to sort it the way I want it, short of writing a sort function myself?</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010", "ms-access-2013"], "comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1442402403, "post_id": 32606505, "comment_id": 53065214, "body": "6 columns is not a lot, why not <code>if col1 is null or col2 is null ...</code> ?"}, {"owner": {"reputation": 311, "user_id": 2857740, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5870407206e91db4674d4cd3b9c795a1?s=128&d=identicon&r=PG&f=1", "display_name": "adp", "link": "https://stackoverflow.com/users/2857740/adp"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1442403984, "post_id": 32606505, "comment_id": 53066239, "body": "Hi thanks for your replay. I tried this : Design View-&gt;Criteria : Is Null -&gt; The problem is that if I type this at col1 and I type the same thing col2 ,the query is only going to show me data where both col1 and col2 are null.But I want to see also the data where col 1  is null and col 2 is not null and vice versa. So if I type in Design view under all 6 Criteria ,,is null&#39; - the query is only going to show entries where all 6 columns are blank. Or did u meant something ales?"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1442404525, "post_id": 32606505, "comment_id": 53066620, "body": "You must use different lines so you get OR rather than AND, have a look at SQL View in the query design window."}, {"owner": {"reputation": 311, "user_id": 2857740, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5870407206e91db4674d4cd3b9c795a1?s=128&d=identicon&r=PG&f=1", "display_name": "adp", "link": "https://stackoverflow.com/users/2857740/adp"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1442406184, "post_id": 32606505, "comment_id": 53067861, "body": "Yep this worked, thank you"}], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 2857740, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5870407206e91db4674d4cd3b9c795a1?s=128&d=identicon&r=PG&f=1", "display_name": "adp", "link": "https://stackoverflow.com/users/2857740/adp"}, "edited": false, "score": 0, "creation_date": 1442406283, "post_id": 32608269, "comment_id": 53067936, "body": "Thank you but it worked with Fionnuala solution. I guess this works as well , where should I type this command ? should I create a Macro?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 311, "user_id": 2857740, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5870407206e91db4674d4cd3b9c795a1?s=128&d=identicon&r=PG&f=1", "display_name": "adp", "link": "https://stackoverflow.com/users/2857740/adp"}, "edited": false, "score": 0, "creation_date": 1442413105, "post_id": 32608269, "comment_id": 53073194, "body": "That&#39;s the SQL for a query."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 3, "last_activity_date": 1442405539, "creation_date": 1442405539, "answer_id": 32608269, "question_id": 32606505, "link": "https://stackoverflow.com/questions/32606505/ms-access-show-null-values/32608269#32608269", "title": "MS Access show null values", "body": "<p>You can simply use:</p>\n\n<pre><code>Select * From YourTable\nWhere (Field1 + Field2 + Field3 + Field4 + Field5 + Field6) Is Null\n</code></pre>\n\n<p>This will list all records where one or more fields are Null.</p>\n"}, {"tags": [], "owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "is_accepted": true, "score": 2, "last_activity_date": 1442407110, "creation_date": 1442407110, "answer_id": 32608856, "question_id": 32606505, "link": "https://stackoverflow.com/questions/32606505/ms-access-show-null-values/32608856#32608856", "title": "MS Access show null values", "body": "<p>6 columns is not a lot, you can use</p>\n\n<pre><code> if col1 is null or col2 is null ...\n</code></pre>\n\n<p>In the Query Design Window, you must use different lines so you get OR rather than AND, have a look at SQL View to see this.</p>\n"}], "owner": {"reputation": 311, "user_id": 2857740, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5870407206e91db4674d4cd3b9c795a1?s=128&d=identicon&r=PG&f=1", "display_name": "adp", "link": "https://stackoverflow.com/users/2857740/adp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1811, "favorite_count": 0, "accepted_answer_id": 32608856, "answer_count": 2, "score": 2, "last_activity_date": 1442407110, "creation_date": 1442400594, "question_id": 32606505, "link": "https://stackoverflow.com/questions/32606505/ms-access-show-null-values", "title": "MS Access show null values", "body": "<p>I just started learning MS access and I encountered the following problem:</p>\n\n<p>I have a table in Ms Access which I would like to check for fields with no values (Null Values). I have a table with 6 columns for example and I would like to be able to query for all missing data.\nThe best thing I could come up is a Union Query in which I combined Queries for all columns. The problem I have with this solution is that if there are 2 null values in on row ,I get a duplicate entry in my result.</p>\n\n<p>Is there a better way to show all null values from one table? Or a way to exclude the duplicate from the Union Query?</p>\n\n<p>Thank you! </p>\n"}, {"tags": ["ms-access", "vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 510, "user_id": 3398853, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c99b8975fefdcd0ff7556e1b17c6cae9?s=128&d=identicon&r=PG&f=1", "display_name": "Kazschuri", "link": "https://stackoverflow.com/users/3398853/kazschuri"}, "is_accepted": true, "score": 0, "last_activity_date": 1442491733, "last_edit_date": 1442491733, "creation_date": 1442472810, "answer_id": 32624180, "question_id": 32606376, "link": "https://stackoverflow.com/questions/32606376/with-access-vba-resize-an-excel-chart-that-is-placed-in-word-document/32624180#32624180", "title": "with access vba resize an excel chart that is placed in word document", "body": "<p>It is an InlineShape object. A collection of InlineShapes can be accessed at the document level. So what I was searching for was:</p>\n\n<pre><code>wdDoc.InlineShapes(Index)\n</code></pre>\n"}], "owner": {"reputation": 510, "user_id": 3398853, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c99b8975fefdcd0ff7556e1b17c6cae9?s=128&d=identicon&r=PG&f=1", "display_name": "Kazschuri", "link": "https://stackoverflow.com/users/3398853/kazschuri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 32624180, "answer_count": 1, "score": -1, "last_activity_date": 1459428522, "creation_date": 1442400192, "last_edit_date": 1459428522, "question_id": 32606376, "link": "https://stackoverflow.com/questions/32606376/with-access-vba-resize-an-excel-chart-that-is-placed-in-word-document", "title": "with access vba resize an excel chart that is placed in word document", "body": "<p>Due to company rules I have to create a word document from access and I need excel charts in it.</p>\n\n<p>I can already export the required charts to the right place in the word document, but am now stuck in resizing it. I basically can't find the chart :-(</p>\n\n<p>So far I have this:</p>\n\n<pre><code>With xlSheet\n    Set xlSheet = .Application.Worksheets(\"Sheet1\")\n    .ChartObjects(1).Chart.CopyPicture Appearance:=1, Size:=1, Format:=-4147\nEnd With\n\nwith wdDoc\n    .Selection.PasteSpecial Link:=False, DataType:=3, _\n        Placement:=0, DisplayAsIcon:=False\nEnd With\n</code></pre>\n\n<p>xlSheet is a worksheet and wdDoc a Document. The Pasting is good, but I have no real clue how to find the chart. I tried</p>\n\n<pre><code>Dim thisChart as Object\nWith xlSheet\n    Set xlSheet = .Application.Worksheets(\"Sheet1\")\n    .ChartObjects(1).Chart.CopyPicture Appearance:=1, Size:=1, Format:=-4147\nEnd With\n\nwith wdDoc\n    .Selection.PasteSpecial Link:=False, DataType:=3, _\n        Placement:=0, DisplayAsIcon:=False\n    Set thisChart = .Selection.ShapeRange(1)\nEnd With\n</code></pre>\n\n<p>But I get the error <code>invalid Argument or Procedure</code></p>\n\n<p>Thanks for help,</p>\n\n<p>kaz</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1442399570, "post_id": 32606031, "comment_id": 53063443, "body": "What kind of error do you receive?"}, {"owner": {"reputation": 47, "user_id": 5226510, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a6d955acd378d3594d359cbeb442553b?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej", "link": "https://stackoverflow.com/users/5226510/maciej"}, "reply_to_user": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1442399647, "post_id": 32606031, "comment_id": 53063494, "body": "Run-time error &#39;1004&#39;  Method &#39;Range&#39; of object &#39;_Global&#39; failed"}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1442399931, "post_id": 32606031, "comment_id": 53063673, "body": "Are all your ranges defined? you refer to <code>&quot;Range1&quot;,&quot;Range2&quot;</code> etc, but are those named ranges defined? If you didn&#39;t set those named ranges <code>Excel</code> will throw an error."}, {"owner": {"reputation": 47, "user_id": 5226510, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a6d955acd378d3594d359cbeb442553b?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej", "link": "https://stackoverflow.com/users/5226510/maciej"}, "reply_to_user": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1442400081, "post_id": 32606031, "comment_id": 53063764, "body": "One of them could be not defined and I want to check if it is defined"}], "answers": [{"tags": [], "owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "is_accepted": false, "score": 0, "last_activity_date": 1442402197, "creation_date": 1442402197, "answer_id": 32607088, "question_id": 32606031, "link": "https://stackoverflow.com/questions/32606031/check-if-couple-of-ranges-are-met-in-worksheet/32607088#32607088", "title": "Check if couple of ranges are met in worksheet", "body": "<p>One of the ways is to check if the <code>.Name</code> matches with the named <code>Range</code> you defined and using an <code>Integer</code> counter to match if the amount of <code>Ranges</code> are found.</p>\n\n<p>see code below:</p>\n\n<pre><code>Private Sub CheckNamedRanges()\n\n    Dim nm As Name\n    Dim wb As Workbook\n    Dim i As Integer\n\n    Set wb = ActiveWorkbook\n\n    For Each nm In wb.Names\n        If nm.Name = \"Range1\" Or nm.Name = \"Range2\" Or nm.Name = \"Range3\" Or nm.Name = \"Range4\" Or nm.Name = \"Range5\" Then\n            i = i + 1\n        End If\n    Next\n\n    If i = 5 Then\n        'do something\n    Else\n        MsgBox \"Check if in file each of required range is mentioned!\"\n    End If\nEnd Sub\n</code></pre>\n\n<p><em>(Due note I am not 100% sure this is the most efficient way)</em></p>\n"}, {"tags": [], "owner": {"reputation": 1265, "user_id": 1926468, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ecc606132c686f696c00fed0590f6c3c?s=128&d=identicon&r=PG&f=1", "display_name": "Youbaraj Sharma", "link": "https://stackoverflow.com/users/1926468/youbaraj-sharma"}, "is_accepted": false, "score": 0, "last_activity_date": 1442402638, "creation_date": 1442402638, "answer_id": 32607228, "question_id": 32606031, "link": "https://stackoverflow.com/questions/32606031/check-if-couple-of-ranges-are-met-in-worksheet/32607228#32607228", "title": "Check if couple of ranges are met in worksheet", "body": "<p>Try something like this</p>\n\n<pre><code>Sub CheckTheRange()\nDim CheckMyRange As Range\n\nOn Error Resume Next\nSet CheckMyRange = Range(\"MyRange\")\nOn Error GoTo 0\nIf CheckMyRange Is Nothing Then\n     'Error, range not found\nElse\n     'Go for it\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5226510, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a6d955acd378d3594d359cbeb442553b?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej", "link": "https://stackoverflow.com/users/5226510/maciej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "closed_date": 1442606770, "answer_count": 2, "score": 0, "last_activity_date": 1442402638, "creation_date": 1442399224, "question_id": 32606031, "link": "https://stackoverflow.com/questions/32606031/check-if-couple-of-ranges-are-met-in-worksheet", "closed_reason": "Duplicate", "title": "Check if couple of ranges are met in worksheet", "body": "<p>I have code like below, I would like to check if group of named ranges are met in worksheet and if yes do something, but I receive error when range is not met in if line, how to solve it? thanks </p>\n\n<pre><code>If Range(\"Range1\") Is Nothing Or Range(\"Range2\") Is Nothing Or Range(\"Range3\") Is Nothing Or Range(\"Range4\") Is Nothing Or Range(\"Range5\") Is Nothing Then\n\nMsgBox \"Check if in file each of required range is mentioned!\"\nElse\n'do something\nEnd if\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "vba", "visual-studio-2013"], "answers": [{"tags": [], "owner": {"reputation": 4655, "user_id": 222673, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/tSitX.jpg?s=128&g=1", "display_name": "Scott Wylie", "link": "https://stackoverflow.com/users/222673/scott-wylie"}, "is_accepted": false, "score": 0, "last_activity_date": 1442553156, "last_edit_date": 1495540689, "creation_date": 1442553156, "answer_id": 32644335, "question_id": 32605973, "link": "https://stackoverflow.com/questions/32605973/i-am-trying-to-make-an-event-in-google-calendar-using-ms-access-vba/32644335#32644335", "title": "I am trying to make an event in google calendar using MS access vba", "body": "<p>Looks like when you are calling GoogleWebAuthorizationBroker.AuthorizeAsync method, it is looking for a dependency of System.Net.Http.Primitives which is not on the executing machine.</p>\n\n<p>Make sure this reference is deployed with your application.</p>\n\n<p>This looks like a duplicate issue.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/18370360/could-not-load-file-or-assembly-system-net-http-primitives-located-assemblys-m\">Could not load file or assembly System.Net.Http.Primitives. Located assembly&#39;s manifest definition does not match the assembly reference</a></p>\n"}], "owner": {"reputation": 66, "user_id": 4558850, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cN_Fo2OUpng/AAAAAAAAAAI/AAAAAAAAAX4/Rb_kIO3rpwg/photo.jpg?sz=128", "display_name": "ishoo agarwal", "link": "https://stackoverflow.com/users/4558850/ishoo-agarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 348, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1442553156, "creation_date": 1442399076, "last_edit_date": 1442404058, "question_id": 32605973, "link": "https://stackoverflow.com/questions/32605973/i-am-trying-to-make-an-event-in-google-calendar-using-ms-access-vba", "title": "I am trying to make an event in google calendar using MS access vba", "body": "<p>The plan to make an C# dll file then add that dll file into MS access VBA code by making COM\nEverything is working fine in C# code Except the fact that when I use debugger in C# it shows \"GoogleWebAuthorizationBrokes.cs not found\" and I have to use continue button to execute further code, else the code runs fine and create an event in the google calendar\nBut when I use call the Method from VBA it goes to the C# but do not execute the entire methode</p>\n\n<pre><code>public string CalendarMethod(string Email, string text)\n        {\n            try\n            {\n\n    Msg = \"Credential started\";\n                    UserCredential credential = GoogleWebAuthorizationBroker.AuthorizeAsync(\n                        new ClientSecrets\n                        {\n                            ClientId = \"ClientID\",\n                            ClientSecret = \"ClientSecret\",\n                        },\n                        new[] { CalendarService.Scope.Calendar },\n                        \"user\",\n                        CancellationToken.None).Result;\n                    Msg = \"Credential Executed\";\n                    // Create the service.\n                    var service = new CalendarService(new BaseClientService.Initializer()\n                    {\n                        HttpClientInitializer = credential,\n                        ApplicationName = \"Calendar API Sample\",\n                    });\n                    Msg = \"Service Executed\";\n                    Event myEvent = new Event()\n                    {\n                        Summary = \"Test Event\",\n                        Location = \"City\",\n                        Start = new EventDateTime()\n                        {\n                            DateTime = DateTime.Now,\n                            TimeZone = \"America/Los_Angeles\"\n                        },\n                        End = new EventDateTime()\n                        {\n                            DateTime = DateTime.Now,\n                            TimeZone = \"America/Los_Angeles\"\n                        },\n                        Recurrence = new String[] {\n                      \"RRULE:FREQ=WEEKLY;BYDAY=MO\"\n                  },\n                        Attendees = new List&lt;EventAttendee&gt;()\n                        {\n                            new EventAttendee() { Email = \"ishooagarwal@gmail.com\" } \n                        }\n                    };\n\n                    Event recurringEvent = service.Events.Insert(myEvent, \"primary\").Execute();\n                    Msg = \"Event Executed\";\n                    return \"Executed\" + Msg;\n                }\n                catch (Exception ex)\n                {\n                    Console.WriteLine(ex + Msg);\n                    return \"Not executed\" + Msg +ex;\n                }\n            }\n</code></pre>\n\n<p>It always return from Credential Started\nIt returns a huge msg at VBA side\nSystem.AggregateException One or more errors occured -------> System.IO.FileNotFoundException could not load filem or assembly \"System.Net.Http.Primitives, Version=1.5.0.0, culture=neutral, publicKeyToken=b03.......\" or one of its dependencies, The system cannot find the file specified\nat Microsoft.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess{Task task}\nat Microsoft.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccess{Task task}\nat Google.Apis.Auth.OAuth2.GoogleWebAuthorizationBroker.\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1442401429, "post_id": 32605195, "comment_id": 53064579, "body": "What is your definition of &quot;Week 1&quot;?  The seven days starting 1 January?  The week starting with the first Monday of the year?  The week containing the first Thursday of the year?  The third of these is the ISO definition but the first two are also popular.  The definition determines which years have a week 53 so must be known before considering what missing weeks to add."}, {"owner": {"reputation": 15, "user_id": 5101981, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0eb70673ab6c590caad256ffdb98e004?s=128&d=identicon&r=PG&f=1", "display_name": "vba_interested", "link": "https://stackoverflow.com/users/5101981/vba-interested"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1442405884, "post_id": 32605195, "comment_id": 53067626, "body": "@TonyDallimore, thanks for your command. Indeed as the focus is really on the time, the week 53 should be known where to add. However, the dataset which I use has a strong seasonality. In the original dataset there is no week 53. To avoid complex statistics and see that there is no need for a week 53, I decided to see it not so much as a date en dust add it to 52"}], "answers": [{"tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1442438755, "last_edit_date": 1442438755, "creation_date": 1442437119, "answer_id": 32618585, "question_id": 32605195, "link": "https://stackoverflow.com/questions/32605195/insert-rows-in-matrix/32618585#32618585", "title": "Insert rows in matrix", "body": "<p><strong>Part 1</strong>  Sorry the answer is in two parts.  I cannot post images using Stack Overflow's new system and the text tables I have used instead cause this answer to exceed the 30,000 character limit.  I have reported the bug and Stack Overflow's technical staff are investigating.</p>\n\n<p>I have made no attempt to debug your existing code because:</p>\n\n<ul>\n<li>It contains simple mistakes that a very junior programmer would not make suggesting very poor quality code.  Debugging poor quality code can be from very difficult to impossible because you are not sure what the author intended.</li>\n<li>The problem does not justify the use of one dictionary let alone two.  </li>\n<li>It does not do anything close to what you want so a rewrite would be necessary.</li>\n</ul>\n\n<p>I have created some data to represent yours:</p>\n\n<pre><code>  |   A   |   B   |   C   |   D   |   E   |   F   |   G   |\n1 |Year   |Week   |Amounts|--&gt;    |       |       |       |\n2 |   2002|      2|     11|     21|     31|     41|     51|\n3 |   2002|     15|     24|     34|     44|     54|     64|\n4 |   2002|     17|       |     36|     46|     56|     66|\n5 |   2002|     18|     27|     37|     47|     57|       |\n6 |   2002|     43|     27|     37|     47|     57|     67|\n7 |   2002|     44|     28|     38|     48|     58|     68|\n8 |   2003|     21|     32|     42|     52|       |       |\n9 |   2003|     23|     34|     44|     54|     64|     74|\n10|   2003|     24|     10|     20|     30|     40|     50|\n11|   2003|     44|     30|     40|     50|     60|     70|\n12|   2003|     45|     31|     41|       |       |       |\n13|   2003|     46|     32|     42|     52|     62|     72|\n14|   2003|     52|     13|     23|     33|     43|     53|\n15|   2003|     53|     14|     24|     34|     44|     54|\n16|   2005|      1|     17|     27|     37|     47|       |\n17|   2005|     29|     20|     30|     40|     50|     60|\n18|   2005|     53|     19|     29|     39|     49|     59|\n19|   2006|      1|     20|     30|     40|     50|     60|\n20|   2006|      2|     11|     21|     31|     41|     51|\n21|   2007|     53|      0|      0|      0|      0|      0|\n</code></pre>\n\n<p>Points to note:</p>\n\n<ul>\n<li>I have omitted most of the rows so you can see all my data.  The macro below inserts all the missing rows</li>\n<li>You say you want the macro to handle 174 columns least.  I have added a few extra columns to demonstrate the macro can handle more than 3 columns.  I have not tested it with all columns used but it should be able to handle any number of columns up to the Excel maximum for the version you are using.</li>\n<li>Some of the rows have trailing empty columns.  I do not know if your data has trailing empty columns but this demonstrates that the macro is not affected by empty columns.  New rows are sized for the longest existing row.</li>\n<li>If there are existing rows for week 53, the macro accepts them but it only creates rows for weeks 1 to 52.</li>\n<li>There is no week 1 for 2002 or 2003.  I doubt week 1 is missing for any of your data but, if it is, the macro will insert it. </li>\n<li>There is no year 2004.  The macro adds weeks 1 to 52 for this missing year.</li>\n<li>The table is supposed to indicate that I have incomplete data for years 2002 to 2006.  Currently I have no data for 2007 so I have added an empty row for week 53.  The macro will insert weeks 1 to 52.  If I had not wanted a week 53, I could have made the row for week 1 and the macro would have added rows for weeks 2 to 52.  Currently you have data for 2002 to 2013.  If you wanted to start collecting data for 2014, add a single row for 2014 and the macro will add the rest.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1442438463, "creation_date": 1442438463, "answer_id": 32618948, "question_id": 32605195, "link": "https://stackoverflow.com/questions/32605195/insert-rows-in-matrix/32618948#32618948", "title": "Insert rows in matrix", "body": "<p><strong>Part 2</strong></p>\n\n<p>Start of data after macro has run.</p>\n\n<pre><code>   |   A   |   B   |   C   |   D   |   E   |   F   |   G   |   H   |   I   |\n1  |Year   |Week   |Amounts|--&gt;    |       |       |       |       |       |\n2  |   2002|      1|      0|      0|      0|      0|      0|       |       |\n3  |   2002|      2|     10|     20|     30|     40|       |       |       |\n4  |   2002|      3|     11|     21|     31|     41|     51|       |       |\n5  |   2002|      4|      0|      0|      0|      0|      0|       |       |\n6  |   2002|      5|      0|      0|      0|      0|      0|       |       |\n7  |   2002|      6|      0|      0|      0|      0|      0|       |       |\n8  |   2002|      7|      0|      0|      0|      0|      0|       |       |\n9  |   2002|      8|      0|      0|      0|      0|      0|       |       |\n10 |   2002|      9|      0|      0|      0|      0|      0|       |       |\n11 |   2002|     10|      0|      0|      0|      0|      0|       |       |\n12 |   2002|     11|      0|      0|      0|      0|      0|       |       |\n13 |   2002|     12|      0|      0|      0|      0|      0|       |       |\n14 |   2002|     13|      0|      0|      0|      0|      0|       |       |\n15 |   2002|     14|      0|      0|      0|      0|      0|       |       |\n16 |   2002|     15|     24|     34|     44|     54|     64|       |       |\n17 |   2002|     16|      0|      0|      0|      0|      0|       |       |\n18 |   2002|     17|       |     36|     46|     56|     66|       |       |\n19 |   2002|     18|     27|     37|     47|     57|       |       |       |\n20 |   2002|     19|      0|      0|      0|      0|      0|       |       |\n21 |   2002|     20|      0|      0|      0|      0|      0|       |       |\n22 |   2002|     21|      0|      0|      0|      0|      0|       |       |\n23 |   2002|     22|      0|      0|      0|      0|      0|       |       |\n24 |   2002|     23|      0|      0|      0|      0|      0|       |       |\n25 |   2002|     24|      0|      0|      0|      0|      0|       |       |\n26 |   2002|     25|      0|      0|      0|      0|      0|       |       |\n27 |   2002|     26|      0|      0|      0|      0|      0|       |       |\n28 |   2002|     27|      0|      0|      0|      0|      0|       |       |\n29 |   2002|     28|      0|      0|      0|      0|      0|       |       |\n30 |   2002|     29|      0|      0|      0|      0|      0|       |       |\n</code></pre>\n\n<p>Try the macro and study my code.  I have explained the objective of each part of the macro but I have not explained most of the VBA statements since it is normally easy to look up statements once you know they exist.  For example, try searching for \"Excel VBA Option Explicit\".  Come back with questions but, the more you can work out for yourself, the faster you will develop.</p>\n\n<pre><code>Option Explicit\n  ' Constants allow you to use names instead of literals that might change over\n  ' time. You only have one header row and perhaps this will not change but\n  ' it is better to avoid making such assumptions. If you ever do add a second\n  ' header row, one change here will fix the macro.\n  Const RowDataFirst As Long = 2\n\n  ' Columns can be letters or numbers with \"A\"=1, \"B\"=2, \"C\"=3 and so on\n  Const ColYear As Long = 1\n  Const ColWeek As Long = 2\n  Const ColDataFirst As Long = 3\n\n  ' Change to your name for the worksheet containing the matrix\n  Const WshtName As String = \"Data\"\nSub CreateUnrecordedWeeks()\n\n  Dim ColCrnt As Long\n  Dim ColLast As Long\n  Dim RowCrnt As Long\n  Dim RowLast As Long\n  Dim RowValues() As Variant\n  Dim WeekCrnt As Long\n  Dim YearCrnt As Long\n\n  ' This stops the screen being repainted everytime a row is inserted\n  Application.ScreenUpdating = False\n\n  ' \"Cells(1, 1).CurrentRegion\" requires/assumes that the user has started the\n  ' macro with the correct worksheet active.  This may be very likely in this\n  ' case but it is is a bad habit to make this assumption so best not to start.\n  ' Use a With statement to specify the worksheet unless there is an\n  ' operational reason why using the worksheet selected by the user is\n  ' appropriate.\n  With Worksheets(WshtName)\n\n    ' Excel VBA often provides several methods of achiving the same objective.\n    ' There are several methods of finding the last row and or column none of\n    ' which gives what the naive programmer might expect in every situation.\n    ' Separate Finds for the last row and last column containing any value is\n    ' the most reliable and I believe appropriate for your situation.  In\n    ' particular it allows some existing rows to have missing trailing values\n    ' without this causing problrms for the macro.\n    RowLast = .Cells.Find(\"*\", .Range(\"A1\"), xlFormulas, , xlByRows, xlPrevious).Row\n    ColLast = .Cells.Find(\"*\", .Range(\"A1\"), xlFormulas, , xlByColumns, xlPrevious).Column\n\n    ' \"Debug.Print\" outputs values to the Immediate Window (at the bottom of the screen).\n    ' I use Debug.Print to check values are as I expect before moving on to the next\n    ' section of the macro.\n    'Debug.Print \"RowLast \" &amp; RowLast\n    'Debug.Print \"ColLast \" &amp; ColLast\n\n    ' Validate existing rows have valid years and weeks in ascending order\n    '=====================================================================\n    ' To add missing rows, the macro requires that, in every case, Row(N+1) is\n    ' for a later year or week than Row(N). Validating that this requirement is\n    ' met before starting the update avoiding creating a half updated matrix.\n\n    ' For rows RowDataFirst to RowLast:\n    '   1) column A must hold a value in the range 2000 to 2099\n    '   2) column B must hold a value in the range 1 to 53\n    '   3) Cells(Row+1,\"A\") must be equal to or greater than Cells(Row,\"A\")\n    '   4) If Cells(Row+1,\"A\") equals Cells(Row,\"A\") then Cells(Row+1,\"B\")\n    '      must be greater than Cells(Row,\"B\")\n\n    ' Check the first data row here.  Within loop check the second of each\n    ' pair.  This means each row is only checked once\n    If Not HasRowValidYearWeek(RowDataFirst) Then\n      ' User has already been told of problem\n      ' \"Debug.Assert False\" stops execution.  I place it at the top of every path\n      ' through my code.  Once it has been reached, I comment it out.  Any that remain\n      ' when I have finished testing imply my testing has been inadequate.\n      'Debug.Assert False\n      Exit Sub\n    End If\n\n    ' Check each data row (except the first) against the previous row\n    For RowCrnt = RowDataFirst + 1 To RowLast\n\n      If Not HasRowValidYearWeek(RowCrnt) Then\n        ' User has already been told of problem\n        'Debug.Assert False\n        Exit Sub\n      End If\n\n      If .Cells(RowCrnt, ColYear) = .Cells(RowCrnt - 1, ColYear) Then\n        If .Cells(RowCrnt, ColWeek) &gt; .Cells(RowCrnt - 1, ColWeek) Then\n          ' Same year, increased week so current row belongs after previous row\n          'Debug.Assert False\n        ElseIf .Cells(RowCrnt, ColWeek) = .Cells(RowCrnt - 1, ColWeek) Then\n          'Debug.Assert False\n          Call MsgBox(\"Row \" &amp; RowCrnt &amp; \" has the same year\" &amp; _\n                      \" and week as the previous row.\", vbOKOnly)\n          Exit Sub\n        Else\n          'Debug.Assert False\n          Call MsgBox(\"Row \" &amp; RowCrnt &amp; _\n                      \" belongs before the previous row.\", vbOKOnly)\n          Exit Sub\n        End If\n      ElseIf .Cells(RowCrnt, ColYear) &gt; .Cells(RowCrnt - 1, ColYear) Then\n        ' Increased year so current row belongs after previous row\n        'Debug.Assert False\n      Else\n        'Debug.Assert False\n        Call MsgBox(\"Row \" &amp; RowCrnt &amp; _\n                    \" belongs before the previous row.\", vbOKOnly)\n\n      End If\n    Next\n\n    'Debug.Print \"Data OK\"\n\n    ' Generate a row of zeros for any row to be inserted. This row is the length\n    ' of the longest existing row.\n    ReDim RowValues(1 To 1, 1 To ColLast)\n    ' VBA allows a range to loaded to an array or an array to be loaded to a\n    ' range with:\n    '   1) VariantArray = Range.Value\n    '   2) Range.Value = VariantArray\n    ' With format 1, the interpreted ReDims VariantArray to match the range\n    ' size. With format 2, The range and array sizes should match. I leave you\n    ' to experiment to discover what happens if the the sizes do not match.\n    ' VariantArray is a two dimensional array. The first dimension is for rows\n    ' and the second for columns. The is the opposite of the normal convention\n    ' but means the access matches Cells(Row, Column)\n    ' RowValues(1, ColYear) and RowValues(1, ColWeek) will be overwritten when\n    ' a row is inserted.\n    For ColCrnt = 1 To ColLast\n      RowValues(1, ColCrnt) = 0\n    Next\n\n    RowCrnt = 2\n\n    ' The first row must be for week 1 of a year\n    YearCrnt = .Cells(RowCrnt, ColYear).Value\n    WeekCrnt = 0\n\n    ' This is the main loop.  It cannot be a For-Loop because rows will be\n    ' inserted and the end value for a For-Loop can be changed within the loop.\n    ' Each repeat of this loop does one of the following:\n    '  1) Determines that the next required row is already present and\n    '     advances to the next row\n    '  2) Determines a mid-year is missing and inserts it.  The previous\n    '     current row remains the current row\n    '  3) Determines the current year is complete and prepares for the next\n    '  4) Determines a trailing week for a year is missing and adds it.  The\n    '     year previous current row remains the current row\n    Do While RowCrnt &lt;= RowLast\n      If YearCrnt = .Cells(RowCrnt, ColYear).Value Then\n        ' Have another row for the same year\n        'Debug.Assert False\n        WeekCrnt = WeekCrnt + 1\n        If WeekCrnt = .Cells(RowCrnt, ColWeek).Value Then\n          ' The next row is already present\n          'Debug.Assert False\n          RowCrnt = RowCrnt + 1 ' Advance to next row\n          ' No more processing for this loop\n        Else\n          ' The next row is not present\n          'Debug.Assert False\n          .Rows(RowCrnt).Insert  ' Insert row above RowCrnt\n          RowLast = RowLast + 1\n          RowValues(1, ColYear) = YearCrnt\n          RowValues(1, ColWeek) = WeekCrnt\n          .Range(.Cells(RowCrnt, 1), .Cells(RowCrnt, ColLast)).Value = RowValues\n          RowCrnt = RowCrnt + 1 ' Advance to previous current row\n          ' No more processing for this loop\n        End If\n      Else\n        ' Next row is for a different year\n        'Debug.Assert False\n        If WeekCrnt = 52 Or WeekCrnt = 53 Then\n          ' YearCrnt is finished\n          'Debug.Assert False\n          YearCrnt = YearCrnt + 1\n          WeekCrnt = 0\n          ' No more processing for this loop\n        Else\n          ' A trailing week is missing.  Add it.\n          'Debug.Assert False\n          WeekCrnt = WeekCrnt + 1\n          .Rows(RowCrnt).Insert  ' Insert row above RowCrnt\n          RowLast = RowLast + 1\n          RowValues(1, ColYear) = YearCrnt\n          RowValues(1, ColWeek) = WeekCrnt\n          .Range(.Cells(RowCrnt, 1), .Cells(RowCrnt, ColLast)).Value = RowValues\n          RowCrnt = RowCrnt + 1 ' Advance to previous current row\n          ' No more processing for this loop\n        End If\n      End If\n\n    Loop\n\n  End With\n\n  Application.ScreenUpdating = True\n\nEnd Sub\nFunction ColNumToCode(ByVal ColNum As Long) As String\n\n  Dim ColCode As String\n  Dim PartNum As Long\n\n  ' Last updated 3 Feb 12.  Adapted to handle three character codes.\n  If ColNum = 0 Then\n    ColNumToCode = \"0\"\n  Else\n    ColCode = \"\"\n    Do While ColNum &gt; 0\n      PartNum = (ColNum - 1) Mod 26\n      ColCode = Chr(65 + PartNum) &amp; ColCode\n      ColNum = (ColNum - PartNum - 1) \\ 26\n    Loop\n  End If\n\n  ColNumToCode = ColCode\n\nEnd Function\nFunction HasRowValidYearWeek(ByVal RowCrnt As Long) As Boolean\n\n    ' Return True if column ColYear of RowCrnt is in the range 2000-2099 and\n    ' column ColWeek of RowCrnt is in the range 1-53\n\n    HasRowValidYearWeek = True\n\n    With Worksheets(WshtName)\n\n      If IsNumeric(.Cells(RowCrnt, ColYear).Value) Then\n        If .Cells(RowCrnt, ColYear).Value &gt;= 2000 And _\n           .Cells(RowCrnt, ColYear).Value &lt;= 2099 Then\n          'Debug.Assert False\n          ' Column A of first data row has good value\n        Else\n          'Debug.Assert False\n          Call MsgBox(\"Cell \" &amp; ColNumToCode(ColYear) &amp; RowCrnt &amp; _\n                      \" is not in the range 2000-2099.\", vbOKOnly)\n          HasRowValidYearWeek = False\n        End If\n      Else\n        'Debug.Assert False\n        Call MsgBox(\"Cell \" &amp; ColNumToCode(ColYear) &amp; RowCrnt &amp; _\n                    \" is not numeric.\", vbOKOnly)\n          HasRowValidYearWeek = False\n      End If\n\n      If IsNumeric(.Cells(RowCrnt, ColWeek).Value) Then\n        If .Cells(RowCrnt, ColWeek).Value &gt;= 1 And _\n          .Cells(RowCrnt, ColWeek).Value &lt;= 53 Then\n          'Debug.Assert False\n          ' Column A of first data row has good value\n        Else\n          'Debug.Assert False\n          Call MsgBox(\"Cell \" &amp; ColNumToCode(ColWeek) &amp; RowCrnt &amp; _\n                      \" is not in the range 1-53.\", vbOKOnly)\n          HasRowValidYearWeek = False\n        End If\n      Else\n        'Debug.Assert False\n        Call MsgBox(\"Cell \" &amp; ColNumToCode(ColWeek) &amp; RowCrnt &amp; _\n                    \" is not numeric.\", vbOKOnly)\n        HasRowValidYearWeek = False\n      End If\n\n  End With\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5101981, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0eb70673ab6c590caad256ffdb98e004?s=128&d=identicon&r=PG&f=1", "display_name": "vba_interested", "link": "https://stackoverflow.com/users/5101981/vba-interested"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 841, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1442438755, "creation_date": 1442397025, "last_edit_date": 1531164843, "question_id": 32605195, "link": "https://stackoverflow.com/questions/32605195/insert-rows-in-matrix", "title": "Insert rows in matrix", "body": "<p>I used to have a very simple matrix. This matrix is like:</p>\n\n<pre><code>year    week    amount    \n2002    1       687\nuntil\n2013    52      8546\n</code></pre>\n\n<p>However, some weeks were not recorded. Therefore, the following macro was written for me. This macro insert a new row, name the right year in the first column, name the right week in the second column and ad a zero in the third column.</p>\n\n<pre><code>Sub CreateUnrecordedWeeks()\n\n'   Defining used objects\nDim FY  As Integer, LY  As Integer\nDim I As Integer, ii As Integer\nDim ObjDic1   As Object\nSet ObjDic1 = CreateObject(\"Scripting.Dictionary\")\nDim ObjDic2  As Object\nSet ObjDic2 = CreateObject(\"Scripting.Dictionary\")\nDim WkRg As Range\nDim F  As Range\nSet WkRg = Cells(1, 1).CurrentRegion\n\n\nWith ObjDic1\n    For Each F In WkRg.Columns(1).Cells\n        .Item(F.Value &amp; \"/\" &amp; F.Offset(0, 1).Value) = F.Offset(0, 2).Value\n    Next F\n\n'        AAA = .keys: BBB = .items\n\n        FY = Evaluate(\"MIN((A:A))\")\n        LY = Evaluate(\"MAX(A:A)\")\n\n    For I = FY To LY\n        For ii = 1 To 52\n            If (.exists((I &amp; \"/\" &amp; ii))) Then\n                ObjDic2.Item(I &amp; \"/\" &amp; ii) = Array(I, ii, .Item(I &amp; \"/\" &amp; ii))\n            Else\n                ObjDic2.Item(I &amp; \"/\" &amp; ii) = Array(I, ii, \"0\")\n            End If\n        Next ii\n    Next I\nEnd With\n\nWith ObjDic2\n    Cells(1, 1).Resize(.Count, 3) = Application.Transpose(Application.Transpose(.items))\nEnd With\n\n\nEnd Sub\n</code></pre>\n\n<p>However, my matrix changed to:</p>\n\n<pre><code>Year    Week    10230001   10230003 etc etc\n2002    1       564        56\nuntil\n2013    52      85         5868\n</code></pre>\n\n<p>So my question is: <strong>how should I change the macro to employ larger matrixes (174 colums at least)</strong></p>\n\n<p>As I employ the old macro, I see that the macro actually do not insert a row, but copy the cell under it downwards. As a result, the additional columns do not move, so the wrong time variable is connected to it.  So I need to copy the whole matrix downwards or insert a row. But how?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007", "ms-access-2010", "ms-access-2013"], "answers": [{"comments": [{"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1442398144, "post_id": 32605390, "comment_id": 53062512, "body": "Hello again! Alas this requeried the form in the same way as before (new data showing, but subform not reordering and conditional formats not applied)."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1442397568, "creation_date": 1442397568, "answer_id": 32605390, "question_id": 32604541, "link": "https://stackoverflow.com/questions/32604541/requery-of-subform-does-not-activate-conditional-formatting-and-puts-new-record/32605390#32605390", "title": "Requery of subform does not activate conditional formatting and puts new record at the bottom", "body": "<pre><code>Forms!myMainForm!mySubForm.Requery\n</code></pre>\n\n<p>This requeries the <code>mySubForm</code> control on <code>myMainForm</code>, but not the subform itself.</p>\n\n<p>Try instead:</p>\n\n<pre><code>Forms!myMainForm!mySubForm.Form.Requery\n</code></pre>\n\n<p>(note: I'm not 100% sure this will solve the issue)</p>\n"}, {"comments": [{"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1442397807, "post_id": 32605454, "comment_id": 53062304, "body": "You can email me if you like: matthew.richard.hall@gmail.com"}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1442398299, "post_id": 32605454, "comment_id": 53062619, "body": "Navigation control is not something I&#39;ve ever used, so will have to do some reading up on it. Thanks for this suggestion though."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "reply_to_user": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1442398406, "post_id": 32605454, "comment_id": 53062673, "body": "its very simple and elegant.. can sense you will greatly profit from navigation controls."}], "tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": false, "score": 1, "last_activity_date": 1442397753, "creation_date": 1442397753, "answer_id": 32605454, "question_id": 32604541, "link": "https://stackoverflow.com/questions/32604541/requery-of-subform-does-not-activate-conditional-formatting-and-puts-new-record/32605454#32605454", "title": "Requery of subform does not activate conditional formatting and puts new record at the bottom", "body": "<p>Migrate froms Tabs to Navigation Control. Usual Tabs are preloaded and will increase the main form load time. On the other hand, Navigation control only loads the form when its opened. This eliminates your needs to manually re-query the second tab.</p>\n\n<p>PS: I'm interested in something in your form, what is your best contact method?</p>\n"}], "owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1442397753, "creation_date": 1442395379, "last_edit_date": 1442396156, "question_id": 32604541, "link": "https://stackoverflow.com/questions/32604541/requery-of-subform-does-not-activate-conditional-formatting-and-puts-new-record", "title": "Requery of subform does not activate conditional formatting and puts new record at the bottom", "body": "<p>I have a form with a 2-page tab control.</p>\n\n<p>The first page has a subform with a button on the subform that's supposed to requery another subform that is on the second page.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Forms!myMainForm!mySubForm.Requery\n</code></pre>\n\n<p>The main form and its fields are used to create new records and the subform on the second page shows these records.</p>\n\n<p>Here's a screenshot of page 1's subform and button:</p>\n\n<p><a href=\"http://i.imgur.com/RLsgcSi.jpg\" rel=\"nofollow\">http://i.imgur.com/RLsgcSi.jpg</a></p>\n\n<p>When the button is clicked, the subform on the second page shows any new record at the bottom of the list instead of being sorted in descending date/time order. Also the Funding Rate field does not seem to get its conditional formatting applied:</p>\n\n<p><a href=\"http://i.imgur.com/QRvI5fy.jpg\" rel=\"nofollow\">http://i.imgur.com/QRvI5fy.jpg</a></p>\n\n<p>I've been able to get the subform to display correctly if I also add some VBA to the button to switch to the second page of the tab, but I'd rather not do this.</p>\n\n<p>Is it possible to requery a subform and have it display correctly when the user is ready to see it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "edited": false, "score": 1, "creation_date": 1442395884, "post_id": 32604505, "comment_id": 53061050, "body": "Not exactly what you asked for, but this sounds like a job for <a href=\"https://support.microsoft.com/en-us/kb/211485\" rel=\"nofollow noreferrer\">data validation</a>."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 4212022, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Zmmjs.jpg?s=128&g=1", "display_name": "Robin Wiman", "link": "https://stackoverflow.com/users/4212022/robin-wiman"}, "edited": false, "score": 0, "creation_date": 1442411241, "post_id": 32605112, "comment_id": 53071754, "body": "This is exactly what I was looking for.   Question, how am I supposed to use this code for specific cells?  Right now it&#39;s automatically applicable to A column."}, {"owner": {"reputation": 101, "user_id": 4212022, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Zmmjs.jpg?s=128&g=1", "display_name": "Robin Wiman", "link": "https://stackoverflow.com/users/4212022/robin-wiman"}, "edited": false, "score": 0, "creation_date": 1442411525, "post_id": 32605112, "comment_id": 53071963, "body": "I get how to change columns inside here:   <code>If Target.Column = 1 Then</code>  But it seems as if I cant choose to set specific cells."}, {"owner": {"reputation": 101, "user_id": 4212022, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Zmmjs.jpg?s=128&g=1", "display_name": "Robin Wiman", "link": "https://stackoverflow.com/users/4212022/robin-wiman"}, "edited": false, "score": 0, "creation_date": 1442475364, "post_id": 32605112, "comment_id": 53099604, "body": "<code>If Not Application.Intersect(Target, Me.Range(&quot;A1,A3,B3,B5,C1,C6&quot;)) Then</code>  This string has an error 91: Object variable or With block variable not set  I&#39;ll try to debug it."}, {"owner": {"reputation": 101, "user_id": 4212022, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Zmmjs.jpg?s=128&g=1", "display_name": "Robin Wiman", "link": "https://stackoverflow.com/users/4212022/robin-wiman"}, "edited": false, "score": 0, "creation_date": 1442497425, "post_id": 32605112, "comment_id": 53112686, "body": "Works like a charm! Millions of thanks! I will send this topic to a few of my coworkers so they can use this code too, if you don&#39;t mind"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 1, "last_activity_date": 1442494606, "last_edit_date": 1442494606, "creation_date": 1442396826, "answer_id": 32605112, "question_id": 32604505, "link": "https://stackoverflow.com/questions/32604505/program-excel-to-return-a-specific-value/32605112#32605112", "title": "Program excel to return a specific value", "body": "<p>Put this code in the worksheet module and test it out, when you change a cell in column A (1) it will activate,</p>\n\n<p>Where is the worksheet Module?</p>\n\n<p><a href=\"https://i.stack.imgur.com/YcldD.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YcldD.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Copy and paste the code ,</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Count &gt; 1 Then Exit Sub\n    If Intersect(Target, Range(\"A1,B1,C1,A4,B4,C4\")) Is Nothing Then Exit Sub\n    Application.EnableEvents = 0\n    If Target &lt;&gt; \"\" Then Target = \"X\"\n    Application.EnableEvents = 1\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 4212022, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Zmmjs.jpg?s=128&g=1", "display_name": "Robin Wiman", "link": "https://stackoverflow.com/users/4212022/robin-wiman"}, "edited": false, "score": 0, "creation_date": 1442474844, "post_id": 32612117, "comment_id": 53099344, "body": "Thank You very much! I will use this code in addition to Dave&#39;s I have a very large spreadsheet and they will both come in handy!"}, {"owner": {"reputation": 101, "user_id": 4212022, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Zmmjs.jpg?s=128&g=1", "display_name": "Robin Wiman", "link": "https://stackoverflow.com/users/4212022/robin-wiman"}, "edited": false, "score": 0, "creation_date": 1442475517, "post_id": 32612117, "comment_id": 53099686, "body": "<code>Set LR = Range(&quot;A1:b3&quot;)</code>  LR variable is not defined, and it returns an error, unfortunately."}, {"owner": {"reputation": 317, "user_id": 4539403, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/57e9499356c1425fbf8d5e8c0bc35e0a?s=128&d=identicon&r=PG&f=1", "display_name": "mozgov_net", "link": "https://stackoverflow.com/users/4539403/mozgov-net"}, "reply_to_user": {"reputation": 101, "user_id": 4212022, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Zmmjs.jpg?s=128&g=1", "display_name": "Robin Wiman", "link": "https://stackoverflow.com/users/4212022/robin-wiman"}, "edited": false, "score": 0, "creation_date": 1442499977, "post_id": 32612117, "comment_id": 53114500, "body": "@RobinWiman <code>Dim LR, cell As Range</code> - this line declares the variables. there was an extra comma in there, sorry about that."}], "tags": [], "owner": {"reputation": 317, "user_id": 4539403, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/57e9499356c1425fbf8d5e8c0bc35e0a?s=128&d=identicon&r=PG&f=1", "display_name": "mozgov_net", "link": "https://stackoverflow.com/users/4539403/mozgov-net"}, "is_accepted": false, "score": 1, "last_activity_date": 1442499888, "last_edit_date": 1442499888, "creation_date": 1442415326, "answer_id": 32612117, "question_id": 32604505, "link": "https://stackoverflow.com/questions/32604505/program-excel-to-return-a-specific-value/32612117#32612117", "title": "Program excel to return a specific value", "body": "<p>This should work for you (just change the range to the one you need) :</p>\n\n<pre><code>Option Explicit\nSub worksheet_Change(ByVal Target As Range)\n\n   On Error GoTo errorbutler 'error handler - important to have this in case your macro does a booboo\nApplication.Calculation = xlCalculationManual 'turn off automatic calculation to speed up the macro\nApplication.EnableEvents = False 'turn off events in order to prevent an endless loop\nDim LR, cell As Range 'Declare your variables\nSet LR = Range(\"A1:b3\") ' Select range of cells this macro would apply to\n    For Each cell In Target 'Loops through the cells that user have changed\n        If Union(cell, LR).Address = LR.Address Then 'Checks if the changed cell is part of your range\n           cell.Value=\"x\" 'changes the value of that cell to x\n        End if\n    Next cell\n\nErrorexit: 'part of error handling procedure\n\nApplication.EnableEvents = True 'Turn autocalc back on\nApplication.Calculation = xlCalculationAutomatic 'turn events back on\n\nExit Sub\n\nErrorbutler:          'error handling procedure\n Debug.Print Err.Number &amp; vbNewLine &amp; Err.Description\n Resume Errorexit\n\nEnd Sub\n</code></pre>\n\n<p>Oh yes, and this code should be put into the worksheet module - the same way as Dave has shown you</p>\n"}], "owner": {"reputation": 101, "user_id": 4212022, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Zmmjs.jpg?s=128&g=1", "display_name": "Robin Wiman", "link": "https://stackoverflow.com/users/4212022/robin-wiman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 32605112, "answer_count": 2, "score": 1, "last_activity_date": 1442499888, "creation_date": 1442395299, "question_id": 32604505, "link": "https://stackoverflow.com/questions/32604505/program-excel-to-return-a-specific-value", "title": "Program excel to return a specific value", "body": "<p>I have a spreadsheet that is going to be used in a survey. </p>\n\n<p>How can I make the cells only to return \"x\" regardless of what the survey taker type in. </p>\n\n<p>For instance, if I write a \"w\" in the cell, it should turn into an \"x\".</p>\n\n<p>I have come to a point where I think there is an option when I protect the workbook or sheet. Because I can tell from another spreadsheet (which has this function) that it only works if the workbook is protected.</p>\n\n<p>I tried to google it, but it seems as if I don't know the right keywords to find the answer.</p>\n\n<p>Also, I have found a set of Vba code that I fiddle with, but I'm not sure this is correct. I don't want to attach the code as I don't want to confuse any response here.</p>\n\n<p>Thank you for any help provided.</p>\n"}, {"tags": ["vba", "excel", "default", "command-prompt"], "answers": [{"tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": true, "score": 4, "last_activity_date": 1442396916, "last_edit_date": 1442396916, "creation_date": 1442395998, "answer_id": 32604793, "question_id": 32604458, "link": "https://stackoverflow.com/questions/32604458/vba-answer-save-as-overwrite-prompt-and-others-not-with-default-option/32604793#32604793", "title": "VBA: Answer &quot;save as - overwrite&quot; prompt (and others) NOT with default option", "body": "<p>You are doing a very wrong thing here, and naturally you get warnings in the process.</p>\n\n<p>Here's what you should be doing instead.</p>\n\n<pre><code>Sub Speichern()\n\n  Dim w As Workbook\n  Set w = Workbooks.Add\n\n  ThisWorkbook.Worksheets(\"CombinedRaw\").Copy Before:=w.Sheets(1)\n\n  Dim i As Long\n\n  Application.DisplayAlerts = False\n  For i = w.Sheets.Count To 2 Step -1\n    w.Sheets(i).Delete\n  Next\n  Application.DisplayAlerts = True\n\n  w.Close SaveChanges:=True, Filename:=ThisWorkbook.Path &amp; \"\\DATATRY.xlsx\"\n\nEnd Sub\n</code></pre>\n\n<p>You won't get the xlsm warnings provided you don't have code in the code module of <code>CombinedRaw</code>. If you do, you might want to move it out to a module.</p>\n\n<p>You will still get the overwrite warning, but only that one.<br>\nIf you'd like to suppress that warning either, move the <code>Application.DisplayAlerts = True</code> to be after the <code>w.Close</code>.</p>\n"}], "owner": {"reputation": 245, "user_id": 2425113, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/45e99652c5740e8c2dbd75a9f8c11840?s=128&d=identicon&r=PG", "display_name": "Marie. P.", "link": "https://stackoverflow.com/users/2425113/marie-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9787, "favorite_count": 0, "accepted_answer_id": 32604793, "answer_count": 1, "score": 2, "last_activity_date": 1442396916, "creation_date": 1442395169, "question_id": 32604458, "link": "https://stackoverflow.com/questions/32604458/vba-answer-save-as-overwrite-prompt-and-others-not-with-default-option", "title": "VBA: Answer &quot;save as - overwrite&quot; prompt (and others) NOT with default option", "body": "<p>I have a .xlsm file from which I need some sheets saved in a non-macro file format (.xlsx).\nFor this, I have created the following code. \nThe first part saves the active Worksheet, called \"CombinedRaw\", as a seperate file \"DATATRY.xlsx\". This closes the active file, i.e. we are no longer in the file \"data retrieve 9.xlsm\", but \"DATATRY.xlsx\" instead, so after deleting the unnecessary worksheets in the new DATATRY file, I open the workbook data retrieve 9.xlsm in which I originally started again, and close DATATRY, so that at the end of the macro I am where I was before. Otherwise, the VBA window would close, and I'd have to manually close the new file, open the other, and open VBA developer again.</p>\n\n<p>You notice that I managed to override the Delete-Worksheet-Confirmation prompt; however, there are other prompts that I cannot override in this way as I do not want to answer with the default answer:</p>\n\n<p>The first one is \"the following features cannot be saved in Macro-free workbooks: ... to continue saving, click yes\". Here I need yes, and it is also default answer, too. </p>\n\n<p>However, \"A file named ... already exists in this location, do you want to replace?\" needs to be yes, but default is no.</p>\n\n<p>After deleting the sheets comes \"This workbook contains links to other data sources\", as it contains formulas to get data from Thomson Reuters database. Default is \"Update\", but I want \"Don't update\".</p>\n\n<p>Then again \"cannot be saved in macro-free workbooks\", where I need the default yes.</p>\n\n<p>Are there methods to predefine different answers that should be given to several sequential prompts?</p>\n\n<pre><code>Sub Speichern()\n\n    ChDir ThisWorkbook.Path\n\n    'save as DATATRY.xlsx without macros\n    Worksheets(\"CombinedRaw\").SaveAs Filename:= _\n        ThisWorkbook.Path &amp; \"\\DATATRY.xlsx\", FileFormat:=51, _\n        CreateBackup:=False\n\n    'delete other sheets in the new file, then close\n    Application.DisplayAlerts = False\n        Worksheets(\"Codes\").Delete\n    Application.DisplayAlerts = True\n\n    'open \"this\" book again\n    Workbooks.Open Filename:=ThisWorkbook.Path &amp; \"\\data retrieve 9.xlsm\"\n    Workbooks(\"DATATRY.xlsx\").Close SaveChanges:=True\n\nEnd Sub\n</code></pre>\n\n<p>Alternatively, deleting the previously existing file from the folder and then saving it would seem to me like a brute workaround, but if it helps, perhaps it is better? But this will still not solve the non-default \"update\" prompt problem.</p>\n"}, {"tags": ["vba", "excel", "user-defined-functions"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1442395376, "post_id": 32604412, "comment_id": 53060701, "body": "You need to either: 1. Pass those ranges as arguments to the function directly; or 2. Qualify the ranges with a worksheet object. #1 is better in my opinion."}, {"owner": {"reputation": 23, "user_id": 2105454, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a095300004f8c82fe1272291b304e1ad?s=128&d=identicon&r=PG", "display_name": "Shivoham", "link": "https://stackoverflow.com/users/2105454/shivoham"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1442396158, "post_id": 32604412, "comment_id": 53061228, "body": "Thank you Rory. The #1 is not possible (this is a resumed version, but the original has more than 30 ranges). Sorry, but I don&#39;t understand the #2."}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1442399541, "creation_date": 1442399541, "answer_id": 32606143, "question_id": 32604412, "link": "https://stackoverflow.com/questions/32604412/malfunction-of-excel-vba-own-function-when-open-other-excel-file/32606143#32606143", "title": "Malfunction of Excel-VBA own function when open other excel-file", "body": "<p>This is what I meant by #2 in my comment:</p>\n\n<pre><code>Function CONVERTemf(E as Variant)\n  With ThisWorkbook.Sheets(\"your sheet name\")\n    c0_1 = .Range(\"coef0_1\").Value\n    c1_1 = .Range(\"coef1_1\").Value\n    c2_1 = .Range(\"coef2_1\").Value\n\n    c0_2 = .Range(\"coef0_2\").Value\n    c1_2 = .Range(\"coef1_2\").Value\n    c2_2 = .Range(\"coef2_2\").Value \n\n    Emfmin_1 = .Range(\"Emin_1\").Value\n    Emfmax_1 = .Range(\"Emax_1\").Value\n    Emfmin_2 = .Range(\"Emin_2\").Value\n    Emfmax_2 = .Range(\"Emax_2\").Value\n  End With\n    Select Case E\n        Case Emfmin_1 To Emfmax_1\n            CONVERTemf = (c2_1 * E ^ 2) + (c1_1 * E) + (c0_1)\n        Case Emfmin_2 To Emfmax_2\n            CONVERTemf = (c2_2 * E ^ 2) + (c1_2 * E) + (c0_2)\n    End Select\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 2105454, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a095300004f8c82fe1272291b304e1ad?s=128&d=identicon&r=PG", "display_name": "Shivoham", "link": "https://stackoverflow.com/users/2105454/shivoham"}, "edited": false, "score": 0, "creation_date": 1442414538, "post_id": 32606967, "comment_id": 53074338, "body": "It works too! Thank you very much! But, then, I have a question: which option is better in terms of memory and speed, yours or the other one? Thank you again!"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "reply_to_user": {"reputation": 23, "user_id": 2105454, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a095300004f8c82fe1272291b304e1ad?s=128&d=identicon&r=PG", "display_name": "Shivoham", "link": "https://stackoverflow.com/users/2105454/shivoham"}, "edited": false, "score": 0, "creation_date": 1442422208, "post_id": 32606967, "comment_id": 53079479, "body": "Better in terms of memory and speed is none of both, i belive. I&#39;ve mentioned why I think that <code>.Names(&quot;coef0_1&quot;).RefersToRange</code> is better in my opinion. As long as all the names refers only to the one sheet <code>.Sheets(&quot;your sheet name&quot;)</code> mine solution will not be better as the other."}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": false, "score": 0, "last_activity_date": 1442466826, "last_edit_date": 1442466826, "creation_date": 1442401865, "answer_id": 32606967, "question_id": 32604412, "link": "https://stackoverflow.com/questions/32604412/malfunction-of-excel-vba-own-function-when-open-other-excel-file/32606967#32606967", "title": "Malfunction of Excel-VBA own function when open other excel-file", "body": "<p>The <code>Range(\"coef0_1\")</code> does not specify where the <code>Range</code>shall be. So the <code>ActiveSheet.Range(\"coef0_1\")</code> or in the case of named ranges <code>Application.Range(\"coef0_1\")</code> is assumed. This will fail if the Workbook in which the Macro runs is not the active Workbook.</p>\n\n<p>A solution which specifies the special Worksheet to which the name refers to will work. But a name can be created not only with scope of one Worksheet but also for the whole Workbook. If so then it is very ugly if it is then needed to specify the specific Worksheet to which the name really refers to. For example if <code>coef0_1</code> refers to <code>Sheet1</code> but <code>Emin_1</code> refers to <code>Sheet2</code> then it has to be <code>ThisWorkbook.Sheets(\"Sheet1\").Range(\"coef0_1\")</code> but <code>ThisWorkbook.Sheets(\"Sheet2\").Range(\"Emin_1\")</code>.</p>\n\n<p>If the names are in the scope \"Workbook\" then the following should also work:</p>\n\n<pre><code>Function CONVERTemf(E As Variant)\n  With ThisWorkbook\n    c0_1 = .Names(\"coef0_1\").RefersToRange.Value\n    c1_1 = .Names(\"coef1_1\").RefersToRange.Value\n    c2_1 = .Names(\"coef2_1\").RefersToRange.Value\n\n    c0_2 = .Names(\"coef0_2\").RefersToRange.Value\n    c1_2 = .Names(\"coef1_2\").RefersToRange.Value\n    c2_2 = .Names(\"coef2_2\").RefersToRange.Value\n\n    Emfmin_1 = .Names(\"Emin_1\").RefersToRange.Value\n    Emfmax_1 = .Names(\"Emax_1\").RefersToRange.Value\n    Emfmin_2 = .Names(\"Emin_2\").RefersToRange.Value\n    Emfmax_2 = .Names(\"Emax_2\").RefersToRange.Value\n  End With\n    Select Case E\n        Case Emfmin_1 To Emfmax_1\n            CONVERTemf = (c2_1 * E ^ 2) + (c1_1 * E) + (c0_1)\n        Case Emfmin_2 To Emfmax_2\n            CONVERTemf = (c2_2 * E ^ 2) + (c1_2 * E) + (c0_2)\n    End Select\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 2105454, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a095300004f8c82fe1272291b304e1ad?s=128&d=identicon&r=PG", "display_name": "Shivoham", "link": "https://stackoverflow.com/users/2105454/shivoham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1442466826, "creation_date": 1442395063, "question_id": 32604412, "link": "https://stackoverflow.com/questions/32604412/malfunction-of-excel-vba-own-function-when-open-other-excel-file", "title": "Malfunction of Excel-VBA own function when open other excel-file", "body": "<p>I have a malfunction of my own Excel-VBA function and I don't know why.\nI want to apply one polynomial or another (which coeficients are calculated in one sheet  depending on some rules) depending on the value of the input parameter of the function CONVERTemf(E):</p>\n\n<p>In the excel-sheet I have cells named:\n\"coef0_1\", \"coef1_1\", \"coef2_1\", \"Emin_1\", \"Emax_1\"  [for the first polynomial];\n\"coef0_2\", \"coef1_2\", \"coef2_2\", \"Emin_2\", \"Emax_2\"  [for the second one].</p>\n\n<p>If \"E\" is between \"Emin_1\" and \"Emax_1\" the function CONVERTemf(E) will apply the first polynomial, if \"E\" is between \"Emin_2\" and \"Emax_2\" it must apply the second one. </p>\n\n<p>I have programmed something like this and it functions ok, BUT, when I open another excel-file (even an empty one!) the values previously calculated lose the result and appears \"#\u00a1VALOR!\".</p>\n\n<p>Thank you very much!</p>\n\n<pre><code>Function CONVERTemf(E as Variant)\n    c0_1 = Range(\"coef0_1\").Value\n    c1_1 = Range(\"coef1_1\").Value\n    c2_1 = Range(\"coef2_1\").Value\n\n    c0_2 = Range(\"coef0_2\").Value\n    c1_2 = Range(\"coef1_2\").Value\n    c2_2 = Range(\"coef2_2\").Value \n\n    Emfmin_1 = Range(\"Emin_1\").Value\n    Emfmax_1 = Range(\"Emax_1\").Value\n    Emfmin_2 = Range(\"Emin_2\").Value\n    Emfmax_2 = Range(\"Emax_2\").Value\n\n    Select Case E\n        Case Emfmin_1 To Emfmax_1\n            CONVERTemf = (c2_1 * E ^ 2) + (c1_1 * E) + (c0_1)\n        Case Emfmin_2 To Emfmax_2\n            CONVERTemf = (c2_2 * E ^ 2) + (c1_2 * E) + (c0_2)\n    End Select\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5566, "user_id": 1771479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5m0gd.jpg?s=128&g=1", "display_name": "agold", "link": "https://stackoverflow.com/users/1771479/agold"}, "is_accepted": false, "score": 0, "last_activity_date": 1442395716, "creation_date": 1442395716, "answer_id": 32604667, "question_id": 32603837, "link": "https://stackoverflow.com/questions/32603837/excel-grouping-and-subtotals/32604667#32604667", "title": "excel grouping and subtotals", "body": "<p>You can create a Pivot table having as row the date and name, and as value the count of Task.</p>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1442395736, "creation_date": 1442395736, "answer_id": 32604677, "question_id": 32603837, "link": "https://stackoverflow.com/questions/32603837/excel-grouping-and-subtotals/32604677#32604677", "title": "excel grouping and subtotals", "body": "<p>Use countifs function to solve this.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ecI5z.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ecI5z.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><code>=COUNTIFS($A$3:$A$19,\"=\"&amp;F3,$B$3:$B$19,\"=\"&amp;G3)</code></p>\n\n<p>Will look like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/cwBJO.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cwBJO.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "is_accepted": false, "score": 0, "last_activity_date": 1442396568, "last_edit_date": 1442396568, "creation_date": 1442395778, "answer_id": 32604698, "question_id": 32603837, "link": "https://stackoverflow.com/questions/32603837/excel-grouping-and-subtotals/32604698#32604698", "title": "excel grouping and subtotals", "body": "<p>Take all of your data from on columns A and B and paste it to another sheet.\nThen select the 2 columns on the new sheet and choose the ribbon data -> remove duplicates.\nOn the same new sheet on c2 enter the formula (assuming your first sheet named Sheet1):</p>\n\n<pre><code>=COUNTIFS(Sheet1!A:A,A2,Sheet1!B:B,B2)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 2370199, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dc41cb74f9b7343eb4a9a28a7ad6b83f?s=128&d=identicon&r=PG", "display_name": "Ranjit Alexander", "link": "https://stackoverflow.com/users/2370199/ranjit-alexander"}, "edited": false, "score": 0, "creation_date": 1442407117, "post_id": 32604732, "comment_id": 53068550, "body": "Hi Rakesh, I was about to post saying that I googled around and worked it out with Pivot Tables... Thank you. It worked out."}], "tags": [], "owner": {"reputation": 70, "user_id": 5340633, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/11779f33caed59c7a19d8e28ed7f01d5?s=128&d=identicon&r=PG", "display_name": "Rakesh", "link": "https://stackoverflow.com/users/5340633/rakesh"}, "is_accepted": true, "score": 0, "last_activity_date": 1442395870, "creation_date": 1442395870, "answer_id": 32604732, "question_id": 32603837, "link": "https://stackoverflow.com/questions/32603837/excel-grouping-and-subtotals/32604732#32604732", "title": "excel grouping and subtotals", "body": "<p>You can achieve it using Pivot in excel.</p>\n\n<p>Steps:\n1. select your data.\n2. Goto Insert tab and click on Pivot\n3. Select Date,Name and Task Field List [Field list opens up at right side]\n4. Put Date couln in Rows Label\n5. Put Name in Column Labels\n6. Count of Tasks in Values</p>\n"}], "owner": {"reputation": 9, "user_id": 2370199, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dc41cb74f9b7343eb4a9a28a7ad6b83f?s=128&d=identicon&r=PG", "display_name": "Ranjit Alexander", "link": "https://stackoverflow.com/users/2370199/ranjit-alexander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 32604732, "answer_count": 4, "score": 0, "last_activity_date": 1442396568, "creation_date": 1442393507, "last_edit_date": 1531161705, "question_id": 32603837, "link": "https://stackoverflow.com/questions/32603837/excel-grouping-and-subtotals", "title": "excel grouping and subtotals", "body": "<p>I have a excel with the following fields:</p>\n\n<pre><code>Date        Name    Task\n========================\n16/09/2015  AT      1\n\n16/09/2015  AT      2\n\n16/09/2015  AT      3\n\n16/09/2015  BT      4\n\n16/09/2015  BT      5\n\n16/09/2015  CT      6\n\n15/09/2015  AT      7\n\n15/09/2015  BT      8\n\n15/09/2015  CT      9\n</code></pre>\n\n<p>The excel sheet basically contains the every date tasks assigned to each person. </p>\n\n<p>What I want is, I want to total of how many task was assigned to each person daily. Something like this:</p>\n\n<pre><code>Date            Name     Daily Task Total\n=========================================\n16/09/2015      A               3\n\n16/09/2015      B               2\n\n16/09/2015      C               1\n\n15/09/2015      A               1\n\n15/09/2015      B               1\n\n15/09/2015      C               1\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 4781900, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0bcac6d82c581f7dd64f2bcd3d6de9e8?s=128&d=identicon&r=PG&f=1", "display_name": "tom bannister", "link": "https://stackoverflow.com/users/4781900/tom-bannister"}, "edited": false, "score": 0, "creation_date": 1442395192, "post_id": 32603957, "comment_id": 53060595, "body": "as a bonus task, would you know know to then save this &quot;Template&quot; tab as an excel file?... I have looked into this and I have code that does exactly what I want is here, I just dont know how to combine them:     Sub Sample()          ThisWorkbook.Sheets(&quot;Template&quot;).Copy          ActiveWorkbook.SaveAs &quot;Desktop&quot;, FileFormat:=51      End Sub"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 131, "user_id": 4781900, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0bcac6d82c581f7dd64f2bcd3d6de9e8?s=128&d=identicon&r=PG&f=1", "display_name": "tom bannister", "link": "https://stackoverflow.com/users/4781900/tom-bannister"}, "edited": false, "score": 0, "creation_date": 1442396136, "post_id": 32603957, "comment_id": 53061217, "body": "I&#39;ve supplied some framework for saving the Template worksheet above."}, {"owner": {"reputation": 131, "user_id": 4781900, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0bcac6d82c581f7dd64f2bcd3d6de9e8?s=128&d=identicon&r=PG&f=1", "display_name": "tom bannister", "link": "https://stackoverflow.com/users/4781900/tom-bannister"}, "edited": false, "score": 0, "creation_date": 1442396952, "post_id": 32603957, "comment_id": 53061745, "body": "Thank you jeeped, but does this code both copy the data to the template and then save the template or would I need 2 buttons to work both of these macros? (In the UK tab it would be useful to have 1 button that works both of these macros)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 131, "user_id": 4781900, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0bcac6d82c581f7dd64f2bcd3d6de9e8?s=128&d=identicon&r=PG&f=1", "display_name": "tom bannister", "link": "https://stackoverflow.com/users/4781900/tom-bannister"}, "edited": false, "score": 0, "creation_date": 1442397660, "post_id": 32603957, "comment_id": 53062215, "body": "Just combine them. With the two sitting in a code page one on top of the other, remove <code>End Sub</code> from the first and remove <code>Sub sbSaveAnotherSheet()</code> from the second."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1442396108, "last_edit_date": 1442396108, "creation_date": 1442393828, "answer_id": 32603957, "question_id": 32603754, "link": "https://stackoverflow.com/questions/32603754/how-to-copy-data-from-1-tab-to-another-in-excel-as-text-with-a-macro/32603957#32603957", "title": "How to copy data from 1 tab to another in excel as TEXT with a macro", "body": "<p>This will transfer the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195193.aspx\" rel=\"nofollow\">Range.Value property</a>. You can also pass across the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193553.aspx\" rel=\"nofollow\">Range.Value2 property</a> which is a raw version of the value.</p>\n\n<pre><code>Sub sbCopyRangeToAnotherSheet()\n    With Sheets(\"UK\").Range(\"A5:AJ110\")\n        Sheets(\"Template\").Range(\"A5\").Resize(.Rows.Count, .Columns.Count) = .Value\n    End With\nEnd Sub\n</code></pre>\n\n<p>There is also the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840217.aspx\" rel=\"nofollow\">Range.Text property</a> but this should be reserved for special cases where value or value2 is insufficient. The .Text property is read-only and can be passed across from individual cell to individual cell.</p>\n\n<p>Saving the Template worksheet to a new workbook is a small matter of copying it with no destination. This results in a copy of the single Template worksheet being created in a new workbook which also becomes the ActiveWorkbook.</p>\n\n<pre><code>Sub sbSaveAnotherSheet()\n    Dim fp As String, fn As String\n\n    fp = Environ(\"USERPROFILE\") &amp; Chr(92) &amp; \"Documents\"  '&lt;~~user's Documents folder\n    fn = \"My_New_Workbook\"\n    With Sheets(\"Template\")\n        'with no destination given, the following code line copies\n        'the Template worksheet to a new workbook which becomes the ActiveWorkbook\n        .Copy\n        'Save this new workbook as a .XLSX\n        ActiveWorkbook.SaveAs Filename:=fp &amp; Chr(92) &amp; fn, FileFormat:=xlOpenXMLWorkbook\n    End With\nEnd Sub\n</code></pre>\n\n<p>No file extension is provided in the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff841185.aspx\" rel=\"nofollow\">Workbook.SaveAs method</a>. This will be supplied by the <strong>FileFormat</strong> parameter (see <a href=\"https://msdn.microsoft.com/en-us/library/office/ff198017.aspx\" rel=\"nofollow\">xlFileFormat Enumeration</a>). If omitted, the file format will be that which is stated in Excel Options \u25ba Save \u25ba Save File in this Format.</p>\n"}], "owner": {"reputation": 131, "user_id": 4781900, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0bcac6d82c581f7dd64f2bcd3d6de9e8?s=128&d=identicon&r=PG&f=1", "display_name": "tom bannister", "link": "https://stackoverflow.com/users/4781900/tom-bannister"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 32603957, "answer_count": 1, "score": 1, "last_activity_date": 1442396108, "creation_date": 1442393293, "question_id": 32603754, "link": "https://stackoverflow.com/questions/32603754/how-to-copy-data-from-1-tab-to-another-in-excel-as-text-with-a-macro", "title": "How to copy data from 1 tab to another in excel as TEXT with a macro", "body": "<p>The code I have to copy data from 1 tab to another works as I'd expect it to BUT I actually want it to copy the data as text (visual cell contents) as opposed to copying the formulas over, the code I have is:</p>\n\n<pre><code>Sub sbCopyRangeToAnotherSheet()\n\nSheets(\"UK\").Range(\"A5:AJ110\").Copy\nDestination:=Sheets(\"Template\").Range(\"A5\")\n\nSheets(\"UK\").Range(\"A5:AJ110\").Copy\n\nSheets(\"Template\").Activate\n\nRange(\"A5\").Select\n\nActiveSheet.Paste\n\nApplication.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n\n<p>Is there any way to easily manipulate this code so it will do what I want it to?</p>\n"}, {"tags": ["multithreading", "forms", "vba", "loops", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5308942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9addf62deab50aa6aac93f476a2d3bf?s=128&d=identicon&r=PG&f=1", "display_name": "John H.", "link": "https://stackoverflow.com/users/5308942/john-h"}, "edited": false, "score": 0, "creation_date": 1442395264, "post_id": 32604130, "comment_id": 53060634, "body": "Thanks for fast reply.  for options what you suggested: 1. I need check time in realtime (Now() == someTime) - Cannot be used 2. I tried add button STOP where I added function to change boolean to FALSE (It has any affect) 3. It needs run permanently because of checking time (its schelude tasker - when its time it starts other app and after it check if ends fine) 4. If I use .DLL and execute code (while true - infinite loop) - will be form accessable?"}], "tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": false, "score": 0, "last_activity_date": 1442394292, "creation_date": 1442394292, "answer_id": 32604130, "question_id": 32603732, "link": "https://stackoverflow.com/questions/32603732/infinite-cycle-while-and-enable-control-ms-access-form-2003/32604130#32604130", "title": "Infinite cycle (While) and enable control MS Access Form 2003", "body": "<p>MS Access or MS office are single threaded platforms and cannot perform parallel executions. Generally, having a blind loop or uncontrolled loop is not a good practice at all. If you have a blind loop function without a controller, you are wasting process cycles of your vba application.</p>\n\n<p>what you can do:</p>\n\n<ol>\n<li>use timer and set intervals how often your code must execute</li>\n<li>Add <strong>\"Do events\"</strong> within the loop to use the process cycles to execute some other code when a code within loop is waiting for an external signal.</li>\n<li>Add any sort of controller to break the loop.. simple if else condition</li>\n<li>Migrate your code to an external .DLL and execute/control the function outside VBA</li>\n</ol>\n\n<p>In short, VBA cannot perform threading. Using uncontrolled will freeze your application which will force you to use [CTRL] + F12 to stop the execution manually.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5308942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9addf62deab50aa6aac93f476a2d3bf?s=128&d=identicon&r=PG&f=1", "display_name": "John H.", "link": "https://stackoverflow.com/users/5308942/john-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1442475279, "creation_date": 1442475279, "answer_id": 32624849, "question_id": 32603732, "link": "https://stackoverflow.com/questions/32603732/infinite-cycle-while-and-enable-control-ms-access-form-2003/32624849#32624849", "title": "Infinite cycle (While) and enable control MS Access Form 2003", "body": "<p>I used function <strong>\"DoEvents\"</strong> (it at least react for input - keyboard / mouse)</p>\n"}], "owner": {"reputation": 1, "user_id": 5308942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9addf62deab50aa6aac93f476a2d3bf?s=128&d=identicon&r=PG&f=1", "display_name": "John H.", "link": "https://stackoverflow.com/users/5308942/john-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1442475279, "creation_date": 1442393229, "question_id": 32603732, "link": "https://stackoverflow.com/questions/32603732/infinite-cycle-while-and-enable-control-ms-access-form-2003", "title": "Infinite cycle (While) and enable control MS Access Form 2003", "body": "<p>I made function which use do while(true) - infinite loop (which controls other apps)</p>\n\n<p>I am searching solution how to make form accessable - when I start app, access just loading and my form cannot be changed. At least I tried to make some \"listening function\" for key \"S\" to stop while and it doesnt work too (maybe I am doing it bad, is it possible?)</p>\n\n<p>I just used</p>\n\n<pre><code>Do While (run) &lt;code&gt; Loop\n</code></pre>\n\n<p>I guess I will need at least 2 thread (1 thread handle infinite while, 2 thread for form, but I read access cannot handle Multithreading.)</p>\n\n<p>I can ask, is there some possibility of make this work?</p>\n\n<p>Jan.</p>\n"}, {"tags": ["image", "vba", "browser", "web", "resolution"], "comments": [{"owner": {"reputation": 2919, "user_id": 424072, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/22dbdaa8854ce1832f1145daf4c399f1?s=128&d=identicon&r=PG", "display_name": "J&#233;r&#233;mie Bertrand", "link": "https://stackoverflow.com/users/424072/j%c3%a9r%c3%a9mie-bertrand"}, "edited": false, "score": 0, "creation_date": 1442392569, "post_id": 32603424, "comment_id": 53058918, "body": "Can you provide the tested code?"}, {"owner": {"reputation": 11, "user_id": 5341077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/127311fa2f290203af957b51e48d3434?s=128&d=identicon&r=PG&f=1", "display_name": "Alex139", "link": "https://stackoverflow.com/users/5341077/alex139"}, "reply_to_user": {"reputation": 2919, "user_id": 424072, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/22dbdaa8854ce1832f1145daf4c399f1?s=128&d=identicon&r=PG", "display_name": "J&#233;r&#233;mie Bertrand", "link": "https://stackoverflow.com/users/424072/j%c3%a9r%c3%a9mie-bertrand"}, "edited": false, "score": 0, "creation_date": 1442394669, "post_id": 32603424, "comment_id": 53060284, "body": "I added the code to my initial question. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5341077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/127311fa2f290203af957b51e48d3434?s=128&d=identicon&r=PG&f=1", "display_name": "Alex139", "link": "https://stackoverflow.com/users/5341077/alex139"}, "edited": false, "score": 0, "creation_date": 1442429814, "post_id": 32609931, "comment_id": 53083780, "body": "I tested the same thing in visual studio 2012 and it works, but I guess in Access this is not possible because of the control&#39;s limitations. Does that make sense? Re-pixeling the image is not a solution. File size is not a problem - I can display images of 30mb in size at 4000x4000."}, {"owner": {"reputation": 1572, "user_id": 5306470, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/9M5cV.jpg?s=128&g=1", "display_name": "Daniel Springer", "link": "https://stackoverflow.com/users/5306470/daniel-springer"}, "reply_to_user": {"reputation": 11, "user_id": 5341077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/127311fa2f290203af957b51e48d3434?s=128&d=identicon&r=PG&f=1", "display_name": "Alex139", "link": "https://stackoverflow.com/users/5341077/alex139"}, "edited": false, "score": 0, "creation_date": 1442488633, "post_id": 32609931, "comment_id": 53107171, "body": "Repixeling is not a solution? Why?"}, {"owner": {"reputation": 11, "user_id": 5341077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/127311fa2f290203af957b51e48d3434?s=128&d=identicon&r=PG&f=1", "display_name": "Alex139", "link": "https://stackoverflow.com/users/5341077/alex139"}, "edited": false, "score": 0, "creation_date": 1442541464, "post_id": 32609931, "comment_id": 53133595, "body": "The picture I want to display is actually a large technical drawing that goes into a final report that has to be printed to scale. Repixeling would affect the details in the drawing. The report is also HTML and very large - (A0 or larger in size) and is shown in the app as well, with the same issue (the drawing is not displayed in the body of the report). For now, I decided to open the report externally, using the default browser - this is the only way it works for now."}], "tags": [], "owner": {"reputation": 1572, "user_id": 5306470, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/9M5cV.jpg?s=128&g=1", "display_name": "Daniel Springer", "link": "https://stackoverflow.com/users/5306470/daniel-springer"}, "is_accepted": false, "score": 0, "last_activity_date": 1442409945, "creation_date": 1442409945, "answer_id": 32609931, "question_id": 32603424, "link": "https://stackoverflow.com/questions/32603424/display-a-large-image-in-the-web-browser-control-ms-access/32609931#32609931", "title": "Display a large image in the web browser control - MS Access", "body": "<p>Are you sure you can?\nOtherwise, you can Re-pixel the image here: <a href=\"http://www.garyshood.com/imageconvert/\" rel=\"nofollow\">http://www.garyshood.com/imageconvert/</a></p>\n\n<p>And I found this on GoDaddy help:\n\"NOTE: Images need to to be formatted as .jpg, .jpeg, .gif or .png files. Image uploads are limited to 30MB per file. While images as large as 5000 x 5000 pixels can be uploaded, images will not be displayed larger than 1920 x 1080 pixels.\"</p>\n"}], "owner": {"reputation": 11, "user_id": 5341077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/127311fa2f290203af957b51e48d3434?s=128&d=identicon&r=PG&f=1", "display_name": "Alex139", "link": "https://stackoverflow.com/users/5341077/alex139"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1260, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1528987994, "creation_date": 1442392248, "last_edit_date": 1528987994, "question_id": 32603424, "link": "https://stackoverflow.com/questions/32603424/display-a-large-image-in-the-web-browser-control-ms-access", "title": "Display a large image in the web browser control - MS Access", "body": "<p>Screenshot: </p>\n\n<p><img src=\"https://i.stack.imgur.com/THpQ4.png\" alt=\"screenshot\"></p>\n\n<p>When trying to display a large image (larger than 5000x5000) in an IE web browser control in MS Access 2010, the image is not displayed.</p>\n\n<p>I am using VBA to both navigate and write content to the object's document. I've tested both methods and I'm getting the same result. Smaller images render with no issues.</p>\n\n<p>LE\nHere is the code:</p>\n\n<pre><code>Private Sub DisplayImg(bWrite As Boolean)\n\nDim sHTMLFilePath As String\nDim sImageFilePath As String\nDim sContent As String\n\nsImageFilePath = \"d:\\img.png\"\nsHTMLFilePath = \"d:\\html.html\"\n\nsContent = \"&lt;html&gt;\"\nsContent = sContent &amp; vbCrLf &amp; \"&lt;head&gt;\"\nsContent = sContent &amp; vbCrLf &amp; \"&lt;/head&gt;\"\nsContent = sContent &amp; vbCrLf &amp; \"&lt;style&gt;\"\nsContent = sContent &amp; vbCrLf &amp; GetCSS ' gets css from db\nsContent = sContent &amp; vbCrLf &amp; \"&lt;/style&gt;\"\nsContent = sContent &amp; vbCrLf &amp; \"&lt;body&gt;\"\nsContent = sContent &amp; vbCrLf &amp; \"&lt;img class=\" &amp; Chr(34) &amp; \"img_wb\" &amp; Chr(34) &amp; \" src=\" &amp; Chr(34) &amp; sImageFilePath &amp; Chr(34) &amp; \"&gt;\"\nsContent = sContent &amp; vbCrLf &amp; \"&lt;/body&gt;\"\nsContent = sContent &amp; vbCrLf &amp; \"&lt;/html&gt;\"\n\nIf bWrite = False Then ' navigate\n    Call CreateNewTextFile(sHTMLFilePath, sContent) ' creates the html file\n    Me.wb.navigate sHTMLFilePath\nElse ' write\n    Me.wb.Document.Clear\n    Me.wb.Document.write sContent\n    Me.wb.Document.Close\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["forms", "ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 1, "creation_date": 1442392090, "post_id": 32603216, "comment_id": 53058645, "body": "What/where is your &quot;first row event&quot;?"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1442507627, "post_id": 32603216, "comment_id": 53119635, "body": "if you are using a bound form then I&#39;d guess that when you change your first record it will, of course, change the corresponding record in your table regardless of how you have your VBA written."}], "answers": [{"comments": [{"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1442499291, "post_id": 32604286, "comment_id": 53114019, "body": "This could be doing something totally different though. Maybe I mis-read but can we guarantee the form is bound to <code>Schluesselhistorie</code> equally?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1442500810, "post_id": 32604286, "comment_id": 53115163, "body": "We don&#39;t know, but the <code>SLH</code> prefix of the field names indicates this."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1442505790, "post_id": 32604286, "comment_id": 53118571, "body": "I&#39;m going to show off some Google translate foo here and make a guess: <code>hinzuf&#252;gen</code> means <code>add</code> and <code>historie</code> is <code>history</code> so maybe the OP is trying to make an audit table? Maybe some data macros/triggers are in order, or maybe they are already being used which is causing the confusion."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1442521510, "post_id": 32604286, "comment_id": 53127255, "body": "Oh yes, lots of guessing is possible. Let&#39;s await some feedback from the questioneer."}, {"owner": {"reputation": 1, "user_id": 4094914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c3000d81e088152c0f4deb2cb9b4049?s=128&d=identicon&r=PG&f=1", "display_name": "Trippley", "link": "https://stackoverflow.com/users/4094914/trippley"}, "edited": false, "score": 0, "creation_date": 1444855662, "post_id": 32604286, "comment_id": 54082177, "body": "I&#39;m still trying to fix that problem, tough it has been a month already (with me being bedridden). The form is bound to Schluesselhistorie and I try to use a submit button for adding the record to the table. But while adding the record to the table, the data in the fields of the form are edited into the first row first. After that the record is added to the table without problems with the code above."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1444901486, "post_id": 32604286, "comment_id": 54099429, "body": "Then skip all that code, use <code>DoCmd.GoToRecord, , acNewRec</code> (to go to a new record) and assign your SLH values."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1442394767, "creation_date": 1442394767, "answer_id": 32604286, "question_id": 32603216, "link": "https://stackoverflow.com/questions/32603216/recordset-addnew-modifies-first-record-in-a-table/32604286#32604286", "title": "Recordset Addnew modifies first record in a table", "body": "<p>You should use the recordsetclone of the form:</p>\n\n<pre><code>Private Sub Schlussel_hinzuf\u00fcgen_Click()\n    On Error GoTo ErrHandler\n    Dim R As DAO.Recordset\n    Set R = Me.RecordsetClone\n    R.AddNew\n    ' Normally data is added to the record between these two\n    R.UpDate\n    R.Close\n    Exit Sub\nErrHandler:\n    MsgBox \"Couldn't save record!\", vbCritical\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4094914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c3000d81e088152c0f4deb2cb9b4049?s=128&d=identicon&r=PG&f=1", "display_name": "Trippley", "link": "https://stackoverflow.com/users/4094914/trippley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 629, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1442491087, "creation_date": 1442391597, "question_id": 32603216, "link": "https://stackoverflow.com/questions/32603216/recordset-addnew-modifies-first-record-in-a-table", "title": "Recordset Addnew modifies first record in a table", "body": "<p>I'm currently having problems with adding a new record in a table through VBA in Access. The VBA is used through a Button in a Form which has 2 Combination fields and 2 date fields. </p>\n\n<pre><code>Private Sub Schlussel_hinzuf\u00fcgen_Click()\n    On Error GoTo ErrHandler\n    Dim R As Recordset\n    Set R = CurrentDb.OpenRecordset(\"Schluesselhistorie\")\n    R.AddNew\n    ' Normally data is added to the record between these two\n    R.Close\n    Me.Requery\n    DoCmd.Close\n    Exit Sub\nErrHandler:\n    MsgBox \"Couldn't save record!\", vbCritical\nEnd Sub\n</code></pre>\n\n<p>As soon as the R.AddNew is called the first record of the table is modified with the Data from the combination and date fields. A completely new record at the end of the table is created as well when </p>\n\n<pre><code>R![SLH_Schluessel_ID] = Me.Kombinationsfeld13.Value\nR![SLH_Kontakt_ID] = Me.Kombinationsfeld15.Value\nR![SLH_Datum_Ausgabe] = Me.SLH_Datum_Ausgabe.Value\nR![SLH_Datum_Rueckgabe_Soll] = Me.SLH_Datum_Rueckgabe_Soll.Value\nR.Update\n</code></pre>\n\n<p>is called though. I am kinda irritated as the former (first row event) shouldn't happen as I know and when code is added above both the first row is modified and a new record with these values is added.</p>\n\n<p>The table is externally linked and the field names are in German.</p>\n\n<p>Are there restrictions to the DAO where the Recordset used can't specify which line the Addnew should use. Or does the Addnew take the values of the Form to automatically add the Values to the table?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1442391718, "post_id": 32603098, "comment_id": 53058417, "body": "Use a <a href=\"https://support.office.com/en-us/article/match-function-0600e189-9f3c-4e4f-98c1-943a0eb427ca\" rel=\"nofollow noreferrer\">MATCH function</a> to get the row number in the the Master worksheet. Once you have that, everything else is just direct value transfer using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"nofollow noreferrer\">Range.Cells property</a> to locate the target."}, {"owner": {"reputation": 141, "user_id": 5341242, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Bh8YE.jpg?s=128&g=1", "display_name": "Wowdude", "link": "https://stackoverflow.com/users/5341242/wowdude"}, "edited": false, "score": 0, "creation_date": 1442399154, "post_id": 32603098, "comment_id": 53063196, "body": "I can use the WB version of MATCH very easily and quickly. Is there a way to manipulate that logic into the VBA version?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1442399370, "post_id": 32603098, "comment_id": 53063332, "body": "Something like <code>rw = application.match(.Range(&quot;A1&quot;), sheets(&quot;Master&quot;).columns(1), 0)</code>. Then use <code>rw</code> to set values. You have no sample data and no original effort that I can try and comprehend where any of this actually is so you&#39;re pretty much on your own."}, {"owner": {"reputation": 141, "user_id": 5341242, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Bh8YE.jpg?s=128&g=1", "display_name": "Wowdude", "link": "https://stackoverflow.com/users/5341242/wowdude"}, "edited": false, "score": 0, "creation_date": 1442404832, "post_id": 32603098, "comment_id": 53066849, "body": "Please see amended original comment with coding and table of example data. Sorry i&#39;m still quite new to VBA coding. I will do my best to use the code you have provided and come back with what I have."}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 5341242, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Bh8YE.jpg?s=128&g=1", "display_name": "Wowdude", "link": "https://stackoverflow.com/users/5341242/wowdude"}, "edited": false, "score": 0, "creation_date": 1442414824, "post_id": 32610761, "comment_id": 53074560, "body": "Wow! This worked perfectly first time! Thank you very much!! A lot cleaner and quicker than my code.  Just for my own benefit and learning, could you quickly sum up how this code works and what each section does?  Again many thanks @Calum !"}, {"owner": {"reputation": 143, "user_id": 5023141, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/73e4102f195847ce8cdd617c722fba4c?s=128&d=identicon&r=PG&f=1", "display_name": "Calum", "link": "https://stackoverflow.com/users/5023141/calum"}, "reply_to_user": {"reputation": 141, "user_id": 5341242, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Bh8YE.jpg?s=128&g=1", "display_name": "Wowdude", "link": "https://stackoverflow.com/users/5341242/wowdude"}, "edited": false, "score": 0, "creation_date": 1442415595, "post_id": 32610761, "comment_id": 53075076, "body": "Hi @Wowdude, glad I could help. I&#39;ve added more annotation notes which hopefully explains it more, in summary though it goes through each cell from 1 to 2000 and if the cell in column D of the child workbook equals that of column D in the master, it will copy the values that also fall on that row, so in this case column A,B and C. Hope that makes sense! Would be great if you could accept the answer as well :-) Thanks"}, {"owner": {"reputation": 141, "user_id": 5341242, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Bh8YE.jpg?s=128&g=1", "display_name": "Wowdude", "link": "https://stackoverflow.com/users/5341242/wowdude"}, "edited": false, "score": 0, "creation_date": 1442491346, "post_id": 32610761, "comment_id": 53108706, "body": "That&#39;s brilliant thanks @Callum . Can I be cheeky and just ask how you would close the Slave workbook that was opened. I have tried numerous different ways that I know  (including Activeworkbook.Close and Workbooks(&quot;owb&quot;).Close) but they all fail. Thanks again! =D"}, {"owner": {"reputation": 143, "user_id": 5023141, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/73e4102f195847ce8cdd617c722fba4c?s=128&d=identicon&r=PG&f=1", "display_name": "Calum", "link": "https://stackoverflow.com/users/5023141/calum"}, "reply_to_user": {"reputation": 141, "user_id": 5341242, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Bh8YE.jpg?s=128&g=1", "display_name": "Wowdude", "link": "https://stackoverflow.com/users/5341242/wowdude"}, "edited": false, "score": 0, "creation_date": 1442496310, "post_id": 32610761, "comment_id": 53111849, "body": "Thanks for accepting, and I assume you want it saving as well? Closing won&#39;t save it and will just close it. As the Slave isn&#39;t the active that wouldn&#39;t work, please see the edited code and the &quot;with owb&quot; at the bottom. Thanks :)"}, {"owner": {"reputation": 141, "user_id": 5341242, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Bh8YE.jpg?s=128&g=1", "display_name": "Wowdude", "link": "https://stackoverflow.com/users/5341242/wowdude"}, "edited": false, "score": 0, "creation_date": 1442498444, "post_id": 32610761, "comment_id": 53113422, "body": "Ah fantastic. Again I am in your debt @Callum"}], "tags": [], "owner": {"reputation": 143, "user_id": 5023141, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/73e4102f195847ce8cdd617c722fba4c?s=128&d=identicon&r=PG&f=1", "display_name": "Calum", "link": "https://stackoverflow.com/users/5023141/calum"}, "is_accepted": true, "score": 1, "last_activity_date": 1442496171, "last_edit_date": 1442496171, "creation_date": 1442411983, "answer_id": 32610761, "question_id": 32603098, "link": "https://stackoverflow.com/questions/32603098/vba-to-find-and-update-row-based-on-value/32610761#32610761", "title": "VBA to find and update row based on value", "body": "<p>The below code can go in each of your children workbooks, I wasn't sure where the ID appeared in the master workbook so I just assumed column D the same as the children, the below is untested and based on if column D in the child matches column D in the master it will update column A, B and C. At the moment it only does it for 2000 rows, change if applicable. :)</p>\n\n<pre><code>Dim fpath As String\nDim owb As Workbook\nDim Master As Worksheet \nDim Slave As Worksheet 'the following declares both master and slave as worksheets\n\nfpath = \"location of master workbook\" \n\n\nSet owb = Application.Workbooks.Open(fpath) 'opens the file path\n\nSet Master = ThisWorkbook.Worksheets(\"name of sheet in child workbook\") 'declares this workbook and sheet as \"master\"\nSet Slave = owb.Worksheets(\"name of sheet in master you are pasting to\") 'declares the workbook and sheet you're copying to as \"slave\"\n\n\nFor j = 1 To 2000 '(the master sheet) 'goes through each row from 1 to 2000\n\nFor i = 1 To 2000 '(the slave sheet) 'again does the same and the slave sheet\n    If Trim(Master.Cells(j, 4).Value2) = vbNullString Then Exit For 'if the ID is blank it will exit and move on to the next row\n    If Master.Cells(j, 4).Value = Slave.Cells(i, 4).Value Then 'the 4 represents column D, if cell in column D matches the cell in column D in the masterwork book then it will..\n            Slave.Cells(i, 1).Value = Master.Cells(j, 1).Value 'cell in column A child workbook equals cell in column A in master workbook\n            Slave.Cells(i, 2).Value = Master.Cells(j, 2).Value\n            Slave.Cells(i, 3).Value = Master.Cells(j, 3).Value 'same for B and C\n\n\n    End If\n    Next\n\n\nNext\n\n\nMsgBox (\"Data Transfer Successful\")\n\nWith owb\n.Save\n.Close\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 5341242, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Bh8YE.jpg?s=128&g=1", "display_name": "Wowdude", "link": "https://stackoverflow.com/users/5341242/wowdude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12035, "favorite_count": 1, "accepted_answer_id": 32610761, "answer_count": 1, "score": 1, "last_activity_date": 1442496171, "creation_date": 1442391186, "last_edit_date": 1442405065, "question_id": 32603098, "link": "https://stackoverflow.com/questions/32603098/vba-to-find-and-update-row-based-on-value", "title": "VBA to find and update row based on value", "body": "<p>I have a master workbook and multiple children workbooks, each in fixed locations, which hold records of work as individual rows. Rows are copied from the master workbook to the children workbooks based on which of the workbooks are selected.</p>\n\n<p>However, i'm stuck for the VBA coding (in macro form) whereby from within each of the children workbooks, they can update the master. I need it to find and update the work row in the master based on the unique ID number which is assigned to each piece of work and appears in the same column (column D) in both the children and master workbooks.</p>\n\n<p>Any help or ideas would be much appreciated.</p>\n\n<p>Thanks in Advance</p>\n\n<p>Apologies. Please see below data from my sample child workbook (sorry I couldn't format it properly) and below that, the current VBA code I have to copy back to the master workbook:</p>\n\n<p>Data:</p>\n\n<pre><code>Complaint Type  Raised by   Status      ID\nBilling         Percy       Completed   101\nBilling         Percy       Completed   102\nMetering        John        Pending     103\nReads           John        Pending     104\nReads           Jack        Pending     105\nBilling         Julie       Untouched   106\nService         Jack        Completed   107\nMetering        Julie       Untouched   108\nService         Percy       Pending     109\nPayment         Pete        Pending     110\n</code></pre>\n\n<p>VBA Code:</p>\n\n<pre><code>Private Sub CommandButton21_Click()\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\n Dim SourceRange As Range, DestRange As Range\n\n Set SourceRange = Sheets(\"Sheet1\").Range(\"A2:D2\") 'data source\n wb = ActiveWorkbook.Name\n\n Workbooks.Open \"C:\\Users\\user\\Desktop\\Test.xlsm\" 'path to Master\n Windows(wb).Activate 'Activate Child Workbook\n SourceRange.Cut 'define the range to copy 'Cut data from child workbook\n\n Windows(\"Test.xlsm\").Activate 'Activate Master\n Sheets(\"Completed\").Select 'Activate Sheet\n Workbooks(\"Test.xlsm\").Sheets(\"Completed\").Cells(Rows.Count, \"A\").End(xlUp).Offset(1).Paste 'Paste in Master\n\n Application.CutCopyMode = False 'Clear Clipboard\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1442384557, "post_id": 32600908, "comment_id": 53054578, "body": "<a href=\"http://blog.pentalogic.net/2008/11/working-days-weekdays-holidays-sharepoint-calculated-columns/\" rel=\"nofollow noreferrer\">find the difference between 2 days</a>"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5188140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d59a06f71c0710181502cb8f5a3d5d?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5188140/nabilah"}, "edited": false, "score": 0, "creation_date": 1442395844, "post_id": 32604360, "comment_id": 53061024, "body": "Alright thank you! :)"}], "tags": [], "owner": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "is_accepted": true, "score": 1, "last_activity_date": 1442394930, "creation_date": 1442394930, "answer_id": 32604360, "question_id": 32600908, "link": "https://stackoverflow.com/questions/32600908/how-to-find-the-days-difference-between-two-dates/32604360#32604360", "title": "How to find the days difference between two dates", "body": "<p>Instead of using vba just enter the formula for the first row on C1 :</p>\n\n<pre><code>=ROUND(a1,0)-ROUND(b1,0)\n</code></pre>\n\n<p>Then just the formula to the end of exisiting rows.</p>\n\n<p>If you insist using vba code use the simple code below:</p>\n\n<pre><code>   Dim LastRow As Long\nLastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    Range(\"c1\").Select\n    ActiveCell.FormulaR1C1 = \"=ROUND(RC[-1],0)-ROUND(RC[-2],0)\"\n    Range(\"c1\").AutoFill Destination:=Range(\"C1:C\" &amp; LastRow)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5188140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d59a06f71c0710181502cb8f5a3d5d?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5188140/nabilah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "closed_date": 1457841935, "accepted_answer_id": 32604360, "answer_count": 1, "score": -10, "last_activity_date": 1442394930, "creation_date": 1442383578, "last_edit_date": 1442383782, "question_id": 32600908, "link": "https://stackoverflow.com/questions/32600908/how-to-find-the-days-difference-between-two-dates", "closed_reason": "Needs more focus", "title": "How to find the days difference between two dates", "body": "<p>I have been working on finding the Days difference between the dates found in Column A and column B. The dates in both columns are not constant thus I would need a code that would allow to read both dates in column A and B and find the Days difference between those two dates until the last row is empty.  </p>\n\n<p>Is there any code that I could use to find the Days difference between column A and B with a range of more than 500 rows?</p>\n"}, {"tags": ["string", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1442384520, "creation_date": 1442384520, "answer_id": 32601115, "question_id": 32600367, "link": "https://stackoverflow.com/questions/32600367/excel-vba-how-to-get-the-next-character-of-instr/32601115#32601115", "title": "Excel VBA - How to get the next character of InStr?", "body": "<p>Is this what you are trying?</p>\n\n<pre><code>Sub Sample()\n    s = \"qweqweqwe12345\"\n    mm = \"qweqweqwe\"\n\n    If InStr(1, s, mm) &lt;&gt; 0 Then\n        '~~&gt; Find position of string1\n        pos1 = InStr(1, s, mm)\n        '~~&gt; Find position of string2\n        pos2 = InStr(pos1 + Len(mm), s, \"12345\")\n        Debug.Print pos2\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1442391207, "post_id": 32601710, "comment_id": 53058127, "body": "@SiddharthRout I don&#39;t know what you mean... ;)"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1442391189, "last_edit_date": 1442391189, "creation_date": 1442386689, "answer_id": 32601710, "question_id": 32600367, "link": "https://stackoverflow.com/questions/32600367/excel-vba-how-to-get-the-next-character-of-instr/32601710#32601710", "title": "Excel VBA - How to get the next character of InStr?", "body": "<p>I think you mean something like:</p>\n\n<pre><code>Dim lFound As Long\ns = \"qweqweqwe12345\"\nmm = \"qweqweqwe\"\n\nlFound = InStr(s, mm)\nIf lFound &lt;&gt; 0 Then MsgBox Mid$(s, lFound + Len(mm))\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 4563989, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a75767e3032017ddbb28f4cf8f4b3e40?s=128&d=identicon&r=PG&f=1", "display_name": "bigbryan", "link": "https://stackoverflow.com/users/4563989/bigbryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 586, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1442391189, "creation_date": 1442381050, "last_edit_date": 1531164843, "question_id": 32600367, "link": "https://stackoverflow.com/questions/32600367/excel-vba-how-to-get-the-next-character-of-instr", "title": "Excel VBA - How to get the next character of InStr?", "body": "<pre><code>s = \"qweqweqwe12345\"\nmm = \"qweqweqwe\"\n\nIf InStr(mm,rr) &lt;&gt; 0 Then\n\n ' get the the next character or \"12345\"\n\nEnd if\n</code></pre>\n\n<p>I need to get the next character after finding the mm string in rr.</p>\n"}, {"tags": ["xml", "vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1442380051, "post_id": 32600170, "comment_id": 53052829, "body": "People are more likely to help if you <i>indent your code</i> - it&#39;s difficult to read as-posted."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1442380167, "post_id": 32600170, "comment_id": 53052865, "body": "<code>FileName:=myPath &amp; myFile</code> - here <code>myPath</code> has no terminating backslash, so this doesn&#39;t form a usable path.  Comment out the error handler and see what errors you get."}, {"owner": {"reputation": 49, "user_id": 5101980, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f55a24c5c8af46a1656213e29d8a70c6?s=128&d=identicon&r=PG&f=1", "display_name": "John Kings", "link": "https://stackoverflow.com/users/5101980/john-kings"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1442381030, "post_id": 32600170, "comment_id": 53053191, "body": "Thanks for the input.. will make the update and get back to you."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1442415136, "post_id": 32600170, "comment_id": 53074767, "body": "On the Data tab &gt;&gt; Get External Data &gt;&gt; From other sources &gt;&gt; From XML data import  Record a macro and ,analyze the code as well as check whether import is successful."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1442425623, "post_id": 32600170, "comment_id": 53081398, "body": "Your program with some corrections works fine on my computer. Please look carefully changes in paths made at the last minute to conform to paths mentioned in your post."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1442476847, "post_id": 32600170, "comment_id": 53100431, "body": "Is your program working now or still there are some problems."}, {"owner": {"reputation": 49, "user_id": 5101980, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f55a24c5c8af46a1656213e29d8a70c6?s=128&d=identicon&r=PG&f=1", "display_name": "John Kings", "link": "https://stackoverflow.com/users/5101980/john-kings"}, "edited": false, "score": 0, "creation_date": 1443079802, "post_id": 32600170, "comment_id": 53351009, "body": "Hi Skkakkar. Just came back from a short trip.. Will check it today and get back to you"}], "answers": [{"tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": true, "score": 0, "last_activity_date": 1442436867, "last_edit_date": 1442436867, "creation_date": 1442422856, "answer_id": 32614567, "question_id": 32600170, "link": "https://stackoverflow.com/questions/32600170/importing-xml-into-excel/32614567#32614567", "title": "Importing .xml into Excel", "body": "<p>I have made some changes in your code, now it works and saves files such as File1.xls, File2.xls etc. Changes have been marked on your code. Still one minor problem remains that last file though saved remains open in the workspace. This I could not examine further due to my pre-occupation with some other things. I hope you will be able to resolve this issue. Modified code as follows.  </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code> Sub From_XML_To_XL_02\n    On Error GoTo errh\n    Dim myWB As Workbook, WB As Workbook\n    Set myWB = ThisWorkbook\n    Dim myPath\n    myPath = \"C:\\WorkFolder\\Projects\\\"\n    Dim myFile\n    myFile = Dir(myPath &amp; \"*.xml\")\n    Dim t As Long, N As Long, r As Long, c As Long\n    t = 1\n    N = 0\n    Application.ScreenUpdating = False\n    Do While Len(myFile) &gt; 0             'Do While myFile &lt;&gt; \"\"\n     N = N + 1\n      Set WB = Workbooks.OpenXML(ThisWorkbook.Path &amp; \"\\\" &amp; myFile)   ' Set WB = Workbooks.OpenXML(FileName:=myPath &amp; myFile, LoadOption:=xlXmlLoadImportToList)\n       If N &gt; 1 Then\n        r = WB.Sheets(1).Cells.Find(What:=\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        c = WB.Sheets(1).Cells.Find(What:=\"*\", SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column\n        WB.Sheets(1).Range(Cells(3, \"A\"), Cells(r, c)).Copy myWB.Sheets(1).Cells(t, \"A\")\n        Else\n        WB.Sheets(1).UsedRange.Copy myWB.Sheets(1).Cells(t, \"A\")\n      End If\n                                     'WB.Close False\n      t = myWB.Sheets(1).Cells.Find(What:=\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row + 1\n    myWB.SaveAs Filename:=\"C:\\WorkFolder\\Projects\\Files\" &amp; N &amp; \".xls\" 'added save path here to save in different files\n    WB.Close False\n    myFile = Dir()\n    Loop\n    Application.ScreenUpdating = True\n    myWB.Save\nExit Sub\n errh:\n MsgBox \"no files xml\"\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 5101980, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f55a24c5c8af46a1656213e29d8a70c6?s=128&d=identicon&r=PG&f=1", "display_name": "John Kings", "link": "https://stackoverflow.com/users/5101980/john-kings"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "accepted_answer_id": 32614567, "answer_count": 1, "score": 0, "last_activity_date": 1442436867, "creation_date": 1442379868, "last_edit_date": 1442384050, "question_id": 32600170, "link": "https://stackoverflow.com/questions/32600170/importing-xml-into-excel", "title": "Importing .xml into Excel", "body": "<p>I have a macro code below for Excel 2007. I need to import .xml files into Excel. There are 1,000 .xml files. The schema is only 80 percent the same. I need to import them to Excel and export them as .csv with semicolon.\nI have inserted the code into Excel macro. But when I execute it the files are not being imported.  </p>\n\n<p>Can any one help me check the code, will the code work for my scenario?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub From_XML_To_XL_02\nOn Error GoTo errh\nDim myWB As Workbook, WB As Workbook\nSet myWB = ThisWorkbook\nDim myPath\n  myPath = \"C:\\WorkFolder\\Projects\\\"\nDim myFile\n  myFile = Dir(myPath &amp; \"*.xml\")\nDim t As Long, N As Long, r As Long, c As Long\n  t = 1\n  N = 0\nApplication.ScreenUpdating = False\nDo While myFile &lt;&gt; \"\"\n   N = N + 1\n   Set WB = Workbooks.OpenXML(FileName:=myPath &amp; myFile, LoadOption:=xlXmlLoadImportToList)\n   If N &gt; 1 Then\n        r = WB.Sheets(1).Cells.Find(What:=\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        c = WB.Sheets(1).Cells.Find(What:=\"*\", SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column\n        WB.Sheets(1).Range(Cells(3, \"A\"), Cells(r, c)).Copy myWB.Sheets(1).Cells(t, \"A\")\n   Else\n      WB.Sheets(1).UsedRange.Copy myWB.Sheets(1).Cells(t, \"A\")\n  End If\nWB.Close False\nt = myWB.Sheets(1).Cells.Find(What:=\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row + 1\nmyFile = Dir()\n  Loop\nApplication.ScreenUpdating = True\n  myWB.Save\nExit Sub\nerrh:\n MsgBox \"no files xml\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1442385616, "post_id": 32600049, "comment_id": 53055097, "body": "I think you should be using <code>Range(&quot;F2&quot;).FormulaR1C1 = ...</code> instead of <code>Range(&quot;F2&quot;).Text = ...</code>. Also is <b>F2</b> meant to be the sheet on vFile?"}, {"owner": {"reputation": 101, "user_id": 5110406, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/8558400d82a0570c992e7f0657d7e272?s=128&d=identicon&r=PG&f=1", "display_name": "avumlas", "link": "https://stackoverflow.com/users/5110406/avumlas"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1442388964, "post_id": 32600049, "comment_id": 53056895, "body": "I already tried R1C1 and still giving the same error. Also F2 is the cell itself on the file vFile"}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1442389804, "post_id": 32600049, "comment_id": 53057345, "body": "You are missing the single quotations for the workbook reference. that part should be: <code>&#39;[&quot; &amp; vFile &amp; &quot;]Sheet1&#39;</code>"}], "owner": {"reputation": 101, "user_id": 5110406, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/8558400d82a0570c992e7f0657d7e272?s=128&d=identicon&r=PG&f=1", "display_name": "avumlas", "link": "https://stackoverflow.com/users/5110406/avumlas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1442379092, "creation_date": 1442379092, "last_edit_date": 1531164843, "question_id": 32600049, "link": "https://stackoverflow.com/questions/32600049/vba-vlookup-on-opened-file", "title": "VBA Vlookup on opened file", "body": "<p>I need a little help on VBA regarding VLOOKUP. Error pops up saying \"Application-defined or object defined error. Sometimes it shows \"Object required\". Thanks in advance. I recorded the macro but it doesn't work when i put it on VBA</p>\n\n<pre><code>  Sub CopyData()\n  '\n  Dim Newbook As Window\n  Dim wb As Workbook, wb2 As Workbook\n  Dim ws As Worksheet\n  Dim vFile As Variant\n\n  Set wb = ActiveWorkbook\n\n  For Each wkb In Workbooks ' Looking for new file created on multiple workbooks\n  If Left(wkb.Name, 4) = \"Book\" Then\n  Set wb3 = wkb\n  Exit For\n  End If\n  Next wkb\n  wkb.Activate          \n  Sheets(\"Prices\").Select' Selecting the sheet of the newly created workbook\n  Range(\"F2\").Select\n  vFile = Application.GetOpenFilename(\"All-Files,*.xl**\", 1, \"Select One File To Open\", , False) 'Open the data source workbook\n  If TypeName(vFile) = \"Boolean\" Then Exit Sub\n  Workbooks.Open vFile\n  Range(\"F2\").Text = \"=VLOOKUP(RC[-4]&amp;MID(RC[-3],3,3),[\" &amp; vFile &amp; \"]Sheet1!R3C1:R8149C15,15,FALSE)\"\n  Range(\"F2\").Select\n  Selection.AutoFill Destination:=Range(\"F2:F\" &amp; Cells(Rows.Count, 1).End(xlUp).Row)\n  End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1442377200, "post_id": 32599620, "comment_id": 53051928, "body": "Thank you for your help! :)"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1442376537, "creation_date": 1442376537, "answer_id": 32599620, "question_id": 32599436, "link": "https://stackoverflow.com/questions/32599436/insert-dates-when-empty-cells-are-found-in-a-column/32599620#32599620", "title": "Insert Dates when empty cells are found in a column", "body": "<p>Test each cell:</p>\n\n<pre><code>  Sub Update()\n\n    For Each cell In Range(\"B2:B318\")\n      If cell.Value = \"\" Then\n        cell.Value = \"9 / 4 / 2015\"\n      End If\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 32599620, "answer_count": 1, "score": 2, "last_activity_date": 1442376748, "creation_date": 1442375327, "last_edit_date": 1531164843, "question_id": 32599436, "link": "https://stackoverflow.com/questions/32599436/insert-dates-when-empty-cells-are-found-in-a-column", "title": "Insert Dates when empty cells are found in a column", "body": "<p>Hi currently i have a code that  allows  me to insert the rows of specific dates in excel. However now i would need a code that would allow me to insert the specific date in a column where there is an empty cell. The code that i have so far is:</p>\n\n<pre><code> Sub Update()\n\n    For Each cell In Range(\"B2:B318\")\n        cell.Value = \"9 / 4 / 2015\"\n\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>I am not sure of making the necessary changes to allow the code to look through column B from row 2 to row 318 and insert the specific dates on any empty cell found. I hope anyone could assist me. Would appreciate it a lot. Thank you.</p>\n"}, {"tags": ["vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 1, "creation_date": 1442375878, "post_id": 32599368, "comment_id": 53051586, "body": "Why not run code in the before update event?"}], "answers": [{"tags": [], "owner": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "is_accepted": false, "score": 0, "last_activity_date": 1442528418, "creation_date": 1442528418, "answer_id": 32640856, "question_id": 32599368, "link": "https://stackoverflow.com/questions/32599368/how-do-i-prevent-the-user-moving-to-a-new-record-with-dirty-data/32640856#32640856", "title": "How do I prevent the user moving to a new record with dirty data?", "body": "<p>You can add your 'logic' in the Form Event \"After update\"</p>\n\n<pre><code>Private Sub Form_AfterUpdate()\n    'do some logic stuff here or call another method\nEnd Sub\n</code></pre>\n\n<p>When I tried it, Access was able to distinguish correctly if the form is dirty or not before firing this event. But you should try it on your own. </p>\n"}], "owner": {"reputation": 3907, "user_id": 3791372, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xEZFO.jpg?s=128&g=1", "display_name": "user3791372", "link": "https://stackoverflow.com/users/3791372/user3791372"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1442528418, "creation_date": 1442374874, "question_id": 32599368, "link": "https://stackoverflow.com/questions/32599368/how-do-i-prevent-the-user-moving-to-a-new-record-with-dirty-data", "title": "How do I prevent the user moving to a new record with dirty data?", "body": "<p>If I'm creating a new record, and have logic that fires when the user presses the save button. This creates a problem that the user can create a new record, but not press the 'save' button, but just navigate to a new/previous record. The data will be saved, but the other VBA logic won't be fired.</p>\n\n<p>I wish to prevent this, so which would be the best way? I would like navigation to be allowed on the form, just not when the record is new and dirty (navigation during updates are fine).</p>\n\n<p>I've thought of two ideas, but am not sure how to implement either, nor which would be more logical. How would I do these:</p>\n\n<p><strong>Idea 1</strong>: Disable the navigation when a record is new and is dirty</p>\n\n<p><strong>Idea 2</strong>: Fire the 'presave' logic when the user navigates away from a dirty new record.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 1, "creation_date": 1442374279, "post_id": 32599264, "comment_id": 53051219, "body": "You have a couple of <code>INSTR</code>. Which one is the problem? Have you tried using the debugger to inspect the variable contents? They mightn&#39;t be what you expect."}, {"owner": {"reputation": 1074, "user_id": 5312548, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/89a837174bf7e62b26df5afb3e2bc497?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin Tripathi", "link": "https://stackoverflow.com/users/5312548/nitin-tripathi"}, "edited": false, "score": 0, "creation_date": 1442374788, "post_id": 32599264, "comment_id": 53051328, "body": "Instr returns <code>integer</code> and you are taking it in <code>FO</code> and <code>LO</code> which is a <code>string</code>. Please correct it."}], "answers": [{"comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 1, "creation_date": 1442425751, "post_id": 32599347, "comment_id": 53081475, "body": "So you use this in your next question and don&#39;t even accept it here?"}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 0, "last_activity_date": 1442374726, "creation_date": 1442374726, "answer_id": 32599347, "question_id": 32599264, "link": "https://stackoverflow.com/questions/32599264/excel-vba-instr-function/32599347#32599347", "title": "Excel VBA InStr function", "body": "<p>Try this:</p>\n\n<pre><code>    FO = InStr(1, FullHTML, BPlan, vbTextCompare) + Len(BPlan)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 2, "creation_date": 1442376565, "post_id": 32599381, "comment_id": 53051736, "body": "While you are 100% correct and while the types should be corrected, this will not fix the problem that the OP is asking about. Whatever numeric value is returned from InStr() will be coerced to a string value as the code currently stands."}, {"owner": {"reputation": 1074, "user_id": 5312548, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/89a837174bf7e62b26df5afb3e2bc497?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin Tripathi", "link": "https://stackoverflow.com/users/5312548/nitin-tripathi"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1442377222, "post_id": 32599381, "comment_id": 53051932, "body": "certainly code needs to be corrected as it uses <code>RIGHT</code> and <code>LEFT</code> function which certainly requires number in its second argument while i can see it passes string FO and LO . i am not sure how it is working him."}, {"owner": {"reputation": 11, "user_id": 5339633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24b0236cf0c20f20d9f20bb3e1a8f574?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Dole", "link": "https://stackoverflow.com/users/5339633/bob-dole"}, "edited": false, "score": 0, "creation_date": 1442422629, "post_id": 32599381, "comment_id": 53079741, "body": "I did the changes that everyone recommended and the first Instr still returns 0."}], "tags": [], "owner": {"reputation": 1074, "user_id": 5312548, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/89a837174bf7e62b26df5afb3e2bc497?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin Tripathi", "link": "https://stackoverflow.com/users/5312548/nitin-tripathi"}, "is_accepted": false, "score": 0, "last_activity_date": 1442374981, "creation_date": 1442374981, "answer_id": 32599381, "question_id": 32599264, "link": "https://stackoverflow.com/questions/32599264/excel-vba-instr-function/32599381#32599381", "title": "Excel VBA InStr function", "body": "<p>FO and LO are defined as <code>string</code>.\nit should be <code>integer</code> as Instr returns <code>integer</code>.\nGet it corrected.</p>\n\n<pre><code>Public Shared Function InStr(_\n   ByVal String1 As String, _\n   ByVal String2 As String, _\n   Optional ByVal Compare As CompareMethod _\n) As Integer\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5339633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24b0236cf0c20f20d9f20bb3e1a8f574?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Dole", "link": "https://stackoverflow.com/users/5339633/bob-dole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1471, "favorite_count": 0, "accepted_answer_id": 32599347, "answer_count": 2, "score": -2, "last_activity_date": 1442532560, "creation_date": 1442374081, "question_id": 32599264, "link": "https://stackoverflow.com/questions/32599264/excel-vba-instr-function", "title": "Excel VBA InStr function", "body": "<p>Why does my InStr function return 0 when it clearly is part of the HTML string?</p>\n\n<p>I cannot post this without more text.I cannot post this without more text.I cannot post this without more text.I cannot post this without more text.I cannot post this without more text.I cannot post this without more text.</p>\n\n<pre><code>Sub ImportBPlans()\n    Dim BPlan As String, FullHTML As String, URL1 As String, Cut1 As String, T1 As String\n    Dim FO As String, LO As String, Other1 As Long\n\n    For i = 2 To LastRow\n\n        T1 = WB1.Cells(i, 1).Value\n\n        URL1 = \"http://finance.yahoo.com/q/pr?s=\" + T1 + \"+Profile\"\n        FullHTML = GetHTML(URL1)\n        BPlan = \"&amp;nbsp;&lt;/th&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;\"\n        x = Len(FullHTML)\n        FO = InStr(FullHTML, BPlan, CompareMethod.Text) + Len(BPlan)\n        LO = InStr(FO, FullHTML, \"&lt;\")\n        Cut1 = Left(FullHTML, LO)\n        Cut1 = Right(Cut1, FO - LO)\n        WB5.Cells(i, 1).Value = Cut1\n\n    Next i\n\n\nEnd Sub\n\nFunction GetHTML(URL As String) As String\n    Dim HTML As String\n    Dim htmlBDY As New HTMLDocument\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", URL, False\n        .Send\n        htmlBDY.body.innerHTML = .responseText\n        GetHTML = htmlBDY.body.outerHTML\n    End With\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1442371176, "post_id": 32598728, "comment_id": 53050441, "body": "Is the total number of rows in the aggregated 7 columns going to exceed 1048576?"}, {"owner": {"reputation": 17, "user_id": 5111109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1a310bde0d674108f3e1e538cf089f7?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/5111109/paolo"}, "edited": false, "score": 0, "creation_date": 1442376991, "post_id": 32598728, "comment_id": 53051854, "body": "There are about 5.02 million non-empty cells so there will approximately be a little over 700 thousand rows. @Jeeped  EDIT: I miscounted. There are only 2.2 million cells which will result in 300,000 rows."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1442386996, "post_id": 32598728, "comment_id": 53055781, "body": "Generally speaking, a show of original effort toward a solution is expected in the Excel forum. Judging from your last (excellent) question on r, quantmodr and mysql I believe you understand the <a href=\"http://stackoverflow.com/tour\">SO</a> process."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1442386795, "creation_date": 1442386795, "answer_id": 32601745, "question_id": 32598728, "link": "https://stackoverflow.com/questions/32598728/how-do-i-move-every-7-columns-to-the-next-empty-row/32601745#32601745", "title": "How do I move every 7 columns to the next empty row?", "body": "<p>Open the VBE with <kbd>Alt</kbd>+<kbd>F11</kbd> and put the following into a module code sheet.</p>\n\n<pre><code>Sub play_tetris()\n    Dim rws As Long, cls As Long, i As Long\n    Dim v As Long, vs As Long, vTMP As Variant, vVALs As Variant\n\n    Application.ScreenUpdating = False\n\n    With Worksheets(\"Sheet1\")\n        With .Cells(1, 1).CurrentRegion\n            ReDim vVALs(1 To Application.CountA(.Cells) / 7, 1 To 7)\n        End With\n        For cls = 1 To Range(\"BOO1\").Column Step 7\n            rws = .Cells(Rows.Count, cls).End(xlUp).Row\n            vTMP = .Cells(1, cls).Resize(rws, 7).Value2\n            For v = LBound(vTMP, 1) To UBound(vTMP, 1)\n                vs = vs + 1\n                For i = 1 To 7\n                    vVALs(vs, i) = vTMP(v, i)\n                Next i\n            Next v\n        Next cls\n        With .Cells(1, 1).Resize(UBound(vVALs, 1), 7)\n            .Value = vVALs\n            .Rows(1).Copy\n            .PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\n                          SkipBlanks:=False, Transpose:=False\n            .Resize(1, Range(\"BOO1\").Column).Offset(0, 7).EntireColumn.Delete\n        End With\n    End With\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Adjust the Worksheet <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196974.aspx\" rel=\"nofollow\">.Name property</a> in the fourth line if you are not working on Sheet1. Tap <kbd>Alt</kbd>+<kbd>Q</kbd> to return to the worksheet then <kbd>Alt</kbd>+<kbd>F8</kbd> to open the <strong>Macro</strong> dialog and Run the macro.</p>\n"}], "owner": {"reputation": 17, "user_id": 5111109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1a310bde0d674108f3e1e538cf089f7?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/5111109/paolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1442386795, "creation_date": 1442370328, "question_id": 32598728, "link": "https://stackoverflow.com/questions/32598728/how-do-i-move-every-7-columns-to-the-next-empty-row", "title": "How do I move every 7 columns to the next empty row?", "body": "<p>I have data from A1 to BOO66262 and I need to fit everything in seven columns, regardless of the number of rows. I currently have:</p>\n\n<pre><code>     | A | B | C | D | E | F | G | H | I | J | K | L | M | N | ... | BOO\n1    | x | x | x | x | x | x | x | x | x | x | x | x | x | x | ... | x\n...  | . | . | . | . | . | . | . | . | . | . | . | . | . | . | ... | .\n66262| x | x | x | x | x | x | x | x | x | x | x | x | x | x | ... | x\n</code></pre>\n\n<p>I need the worksheet to only have seven columns like so:</p>\n\n<pre><code>    | A | B | C | D | E | F | G\n1   | x | x | x | x | x | x | x\n... | x | x | x | x | x | x | x\nn   | x | x | x | x | x | x | x\n</code></pre>\n\n<p>Every group has 7 columns but vary in the number of rows. Does anyone know how to do this with VBA?</p>\n\n<p>Here's a screenshot of how my spreadsheet currently looks:<a href=\"https://i.stack.imgur.com/lnjoy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lnjoy.png\" alt=\"Screenshot\"></a></p>\n"}, {"tags": ["vba", "excel", "inputbox"], "answers": [{"comments": [{"owner": {"reputation": 1175, "user_id": 1487006, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dbe9ed99a12fd3fa2f8dcd33e303eda0?s=128&d=identicon&r=PG", "display_name": "baarkerlounger", "link": "https://stackoverflow.com/users/1487006/baarkerlounger"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1442371710, "post_id": 32598783, "comment_id": 53050581, "body": "What are you inputting as the values?"}, {"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1442371834, "post_id": 32598783, "comment_id": 53050612, "body": "The respective column, row."}, {"owner": {"reputation": 1175, "user_id": 1487006, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dbe9ed99a12fd3fa2f8dcd33e303eda0?s=128&d=identicon&r=PG", "display_name": "baarkerlounger", "link": "https://stackoverflow.com/users/1487006/baarkerlounger"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1442372072, "post_id": 32598783, "comment_id": 53050670, "body": "oh well that&#39;s because you&#39;re inputbox is now expecting a range. Mine was expecting integers"}, {"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1442372165, "post_id": 32598783, "comment_id": 53050697, "body": "okay i changed it back to your code. it works perfectly now:) however if it is null inputs for all 4 boxes, it gives a programming error. How do i avoid it?"}, {"owner": {"reputation": 1175, "user_id": 1487006, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dbe9ed99a12fd3fa2f8dcd33e303eda0?s=128&d=identicon&r=PG", "display_name": "baarkerlounger", "link": "https://stackoverflow.com/users/1487006/baarkerlounger"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1442372320, "post_id": 32598783, "comment_id": 53050751, "body": "Well what do you want to do in that case? You could just have a check to see if any of the values are null and then either have a GOTO to end the macro or throw the inputbox again until a correct value is entered etc"}, {"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1442372608, "post_id": 32598783, "comment_id": 53050792, "body": "In the case of  which the user accidentally clicks on the function?"}, {"owner": {"reputation": 1175, "user_id": 1487006, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dbe9ed99a12fd3fa2f8dcd33e303eda0?s=128&d=identicon&r=PG", "display_name": "baarkerlounger", "link": "https://stackoverflow.com/users/1487006/baarkerlounger"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1442373275, "post_id": 32598783, "comment_id": 53050953, "body": "Okay edited again. Now the User has a cancel button on each input box. Clicking this or clicking Okay with null entered will in both cases end the macro."}, {"owner": {"reputation": 1175, "user_id": 1487006, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dbe9ed99a12fd3fa2f8dcd33e303eda0?s=128&d=identicon&r=PG", "display_name": "baarkerlounger", "link": "https://stackoverflow.com/users/1487006/baarkerlounger"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1442373744, "post_id": 32598783, "comment_id": 53051069, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/89754/discussion-between-db579-and-niva\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1175, "user_id": 1487006, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dbe9ed99a12fd3fa2f8dcd33e303eda0?s=128&d=identicon&r=PG", "display_name": "baarkerlounger", "link": "https://stackoverflow.com/users/1487006/baarkerlounger"}, "is_accepted": true, "score": 1, "last_activity_date": 1442373227, "last_edit_date": 1442373227, "creation_date": 1442370730, "answer_id": 32598783, "question_id": 32598638, "link": "https://stackoverflow.com/questions/32598638/vba-code-to-overwrite-cells-through-moving-shifting-up-a-range-of-cells-with-a/32598783#32598783", "title": "VBA code to overwrite cells through moving /shifting up a range of cells with a user input box", "body": "<p>Extending the accepted answer from your last question you could do something like this:</p>\n\n<p>That way the User can select the range it acts on using input boxes? </p>\n\n<pre><code>Dim y1 As Variant\nDim y2 As Variant\nDim x1 As Variant\nDim x2 As Variant\nDim cell1 As Integer\nDim cell2 As Integer\n\ny1 = Application.InputBox(\"Input First Row\")\nIf y1 = \"\" Or y1 = False Then GoTo handleNull\ny2 = Application.InputBox(\"Input End Row\")\nIf y2 = \"\" Or y2 = False Then GoTo handleNull\nx1 = Application.InputBox(\"Input First Column\")\nIf x1 = \"\" Or x1 = False Then GoTo handleNull\nx2 = Application.InputBox(\"Input End Column\")\nIf x2 = \"\" Or x2 = False Then GoTo handleNull\n\ncell1 = y2 - 1\ncell2 = x1\n\n\nDim sh As Worksheet\nDim x As Long, y As Long\n\nSet sh = ActiveSheet ' or the specific sheet\n\n' The 12 months\nFor y = y1 To y2\n    ' Your 7 columns\n    For x = x1 To x2\n        sh.Cells(y, x) = sh.Cells(y + 1, x)\n    Next x\nNext y\n\nWith sh.Cells(y2, 1)\n    .Select\n    ' This only works if your column A contains dates (not strings)\n    .Value = DateAdd(\"m\", 1, sh.Cells(cell1, cell2))\nEnd With\n\nhandleNull:\nEnd\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1442382467, "post_id": 32600332, "comment_id": 53053734, "body": "But how do i put this . as in just one input box will do or?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1442413877, "post_id": 32600332, "comment_id": 53073773, "body": "Use can first select the range and then run the macro."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1442380864, "creation_date": 1442380864, "answer_id": 32600332, "question_id": 32598638, "link": "https://stackoverflow.com/questions/32598638/vba-code-to-overwrite-cells-through-moving-shifting-up-a-range-of-cells-with-a/32600332#32600332", "title": "VBA code to overwrite cells through moving /shifting up a range of cells with a user input box", "body": "<p>This will operate on the selected range:</p>\n\n<pre><code>Selection.Value = Selection.Offset(1,0).Value\n</code></pre>\n"}], "owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 32598783, "answer_count": 2, "score": 2, "last_activity_date": 1442380864, "creation_date": 1442369605, "last_edit_date": 1495539868, "question_id": 32598638, "link": "https://stackoverflow.com/questions/32598638/vba-code-to-overwrite-cells-through-moving-shifting-up-a-range-of-cells-with-a", "title": "VBA code to overwrite cells through moving /shifting up a range of cells with a user input box", "body": "<p>I previously asked a question on <a href=\"https://stackoverflow.com/questions/32195214/vba-code-to-overwrite-cells-through-moving-shifting-up-a-range-of-cells\">VBA code to overwrite cells through moving /shifting up a range of cells</a> and i got an answer which met my needs. However i realised that i had to hard code all the ranges for each table to perform this vba function which is risky as the cell alignments often change in the sheet.. Thus i want an input box that allows user to select the table of cells they want to perform this function .I know how an input box works however the given code goes by rows and columns, something of which the range that the user selects, does not contain . Thus is there anyways for an input box to work in this code without having to hardcode? Or are there any other alternatives to avoid hardcording in this code and have it work based on the user selection basis? All of your help would be very much appreciated.</p>\n\n<p>Improvised on the given answer but i am still getting a type mismatch error. Why is that so?</p>\n\n<pre><code>Sub Macro1()\n\nDim y1 As Variant\nDim y2 As Variant\nDim x1 As Variant\nDim x2 As Variant\n\ny1 = Application.InputBox(\"Input First Row\", Type:=8)\ny2 = Application.InputBox(\"Input End Row\", Type:=8)\nx1 = Application.InputBox(\"Input First Column\", Type:=8)\nx2 = Application.InputBox(\"Input End Column\", Type:=8)\n\nDim sh As Worksheet\n    Dim x As Long, y As Long\n\n    Set sh = ActiveSheet ' or the specific sheet\n\n    ' The 12 months\n    For y = y1 To y2\n        ' Your 7 columns\n        For x = x1 To x2\n            sh.Cells(y, x) = sh.Cells(y + 1, x)\n        Next x\n    Next y\n\n    'With sh.Cells(y2, 1)\n        '.Select\n        ' This only works if your column A contains dates (not strings)\n        '.Value = DateAdd(\"m\", 1, sh.Cells(y2 - 1, 1))\n   ' End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1442429223, "post_id": 32598104, "comment_id": 53083453, "body": "Make sure your  macros Enable or <a href=\"http://stackoverflow.com/questions/31617344/outlook-not-running-visual-basic-after-restart/31663883#31663883\">Create a self-signing certificate</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1442370976, "last_edit_date": 1442370976, "creation_date": 1442369116, "answer_id": 32598574, "question_id": 32598104, "link": "https://stackoverflow.com/questions/32598104/trying-to-block-saveas-in-excel-2007-the-cancel-true-function-does-not-work/32598574#32598574", "title": "Trying to block SAVEAS in Excel 2007, The Cancel=True function does not work", "body": "<p>Your code works, just make sure your code is under <code>ThisWorkbook</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/lb6Yu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lb6Yu.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    If (SaveAsUI = True) Then\n        Cancel = SaveAsUI\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 5340206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80c899e72b784409274290f0022bab2d?s=128&d=identicon&r=PG&f=1", "display_name": "Chemical Engineer", "link": "https://stackoverflow.com/users/5340206/chemical-engineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1442405947, "creation_date": 1442365448, "last_edit_date": 1442368620, "question_id": 32598104, "link": "https://stackoverflow.com/questions/32598104/trying-to-block-saveas-in-excel-2007-the-cancel-true-function-does-not-work", "title": "Trying to block SAVEAS in Excel 2007, The Cancel=True function does not work", "body": "<p>I have been trying to use this VBA code to block SAVEAS functionality in ThisWorkBook:</p>\n\n<pre><code>Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\nIf (SaveAsUI = True) Then\n    MsgBox \"here\"\n    Cancel = SaveAsUI\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I even get the message \"here\" but the program happily lets me use the SaveAs functionality.</p>\n\n<p>Is there something I am missing?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 442, "user_id": 2497009, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yaHZR.png?s=128&g=1", "display_name": "usncahill", "link": "https://stackoverflow.com/users/2497009/usncahill"}, "edited": false, "score": 0, "creation_date": 1442367389, "post_id": 32598067, "comment_id": 53049605, "body": "You don&#39;t want to add an adjoining column with <code>=&quot;PPD&quot;&amp;A1</code>?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1442367418, "post_id": 32598067, "comment_id": 53049613, "body": "Why do you need a macro? Sounds like an easy case for spreadsheet formulas. If you pre-generated list is in column A, starting at A1, in B1 enter the formula <code>= &quot;PPL&quot; &amp; A1</code> and copy down."}], "answers": [{"tags": [], "owner": {"reputation": 442, "user_id": 2497009, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yaHZR.png?s=128&g=1", "display_name": "usncahill", "link": "https://stackoverflow.com/users/2497009/usncahill"}, "is_accepted": false, "score": 0, "last_activity_date": 1442367612, "creation_date": 1442367612, "answer_id": 32598379, "question_id": 32598067, "link": "https://stackoverflow.com/questions/32598067/macro-sequentially-to-prepend-three-characters/32598379#32598379", "title": "Macro sequentially to prepend three characters", "body": "<p>Consider just adding an adjoining column, the first cell containing <code>=\"PPD\"&amp;A1</code> and fill the column down.</p>\n\n<p>Otherwise, this is a simple for loop.</p>\n\n<pre><code>Dim cel as Range\n\nFor Each cel in ThisWorksheet.UsedRage\n  if Len(cel) = 10 then cel = \"PPD\" &amp; cel\nNext\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5340200, "user_type": "registered", "profile_image": "https://graph.facebook.com/830099400441612/picture?type=large", "display_name": "David King", "link": "https://stackoverflow.com/users/5340200/david-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1442371347, "creation_date": 1442365258, "last_edit_date": 1442371347, "question_id": 32598067, "link": "https://stackoverflow.com/questions/32598067/macro-sequentially-to-prepend-three-characters", "title": "Macro sequentially to prepend three characters", "body": "<p>I'm trying to add the text \"PPL\" to a pre generated list of coupon codes to upload to my website, our vendor's system only generates 10 digit codes and my website only accepts 13 digit codes.  </p>\n\n<p>How should I write the VB macro to simply add those three letters to each of the cell's contents?</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5340143, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IhzF9.jpg?s=128&g=1", "display_name": "Ness", "link": "https://stackoverflow.com/users/5340143/ness"}, "edited": false, "score": 0, "creation_date": 1442979065, "post_id": 32603273, "comment_id": 53302862, "body": "When the selection is lager than the text contained in the field but dose not identify the text is in a form field when only the text is selected.  &#39;Do     Selection.HomeKey Unit:=wdStory     Selection.Find.ClearFormatting     With Selection.Find         .MatchWholeWord = True         .MatchCase = False         .Text = &quot;QLD&quot;         .Forward = True         .Wrap = wdFindContinue     End With     If Selection.Find.Execute = False Then         Exit Do     Else         If Selection.FormFields.Count &gt; 0 Then         MsgBox (&quot;awesome&quot;)         Else         End If     End If Loop&#39;"}], "tags": [], "owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "is_accepted": false, "score": 0, "last_activity_date": 1442391800, "creation_date": 1442391800, "answer_id": 32603273, "question_id": 32597812, "link": "https://stackoverflow.com/questions/32597812/determining-a-formfield-is-selected/32603273#32603273", "title": "Determining a formfield is selected", "body": "<p>To check if there is any <code>FormField</code> inside selection check this:</p>\n\n<pre><code>if Selection.FormFields.Count &gt; 0 then\n</code></pre>\n\n<p>Assuming you have one <code>FormField</code> inside selection you could change any of its property like this (example of how to bold text):</p>\n\n<pre><code>Selection.FormFields(1).Range.Font.Bold = True\n</code></pre>\n\n<p>And to read current value of <code>FormField</code> use this:</p>\n\n<pre><code>Selection.FormFields(1).Result\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5340143, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IhzF9.jpg?s=128&g=1", "display_name": "Ness", "link": "https://stackoverflow.com/users/5340143/ness"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 314, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594054698, "creation_date": 1442363314, "last_edit_date": 1594054698, "question_id": 32597812, "link": "https://stackoverflow.com/questions/32597812/determining-a-formfield-is-selected", "title": "Determining a formfield is selected", "body": "<p>I have used the following code to find text and do a replace</p>\n\n<pre><code>Do\n    Selection.HomeKey Unit:=wdStory\n    Selection.Find.ClearFormatting\n    With Selection.Find\n        .MatchWholeWord = True\n        .MatchCase = False\n        .Text = \"QLD\"\n        .Forward = True\n        .Wrap = wdFindContinue\n    End With\n    If Selection.Find.Execute = False Then\n        Exit Do\n    Else\n        Selection.Delete\n        Selection.TypeText Text:=\"Queensland \"\n    End If\nLoop\n</code></pre>\n\n<p>The client using this has started to use formfields now and wants the text format of the formfield to apply.</p>\n\n<p>How can I determine that the selection contains a formfield to get the properties of it?</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1442423368, "post_id": 32597624, "comment_id": 53080158, "body": "Can you show some sample data before and after? also are the same cells causing the issues or is it random?"}, {"owner": {"reputation": 1637, "user_id": 1291912, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/409aba3615511a10351efe5edf016b4b?s=128&d=identicon&r=PG", "display_name": "SF Lee", "link": "https://stackoverflow.com/users/1291912/sf-lee"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1442535554, "post_id": 32597624, "comment_id": 53132370, "body": "Unfortunately, it&#39;s really hard to reproduce the problem. You need to create a workbook using Excel 2003, save it, then re-open it using Excel 2013. You could also arguably create a workbook in Excel 2013 and change its theme via a custom made XML file that mirrors the Excel 2003 theme."}], "answers": [{"comments": [{"owner": {"reputation": 1637, "user_id": 1291912, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/409aba3615511a10351efe5edf016b4b?s=128&d=identicon&r=PG", "display_name": "SF Lee", "link": "https://stackoverflow.com/users/1291912/sf-lee"}, "edited": false, "score": 0, "creation_date": 1442372254, "post_id": 32598230, "comment_id": 53050731, "body": "I tried your first method, it didn&#39;t work. The copied items are still not formatted properly. As for your second method, I don&#39;t want to copy the entire sheet itself, just parts of it. Also, I don&#39;t want to copy any named ranges, embedded objects, pictures, charts, etc. I only want the cell data."}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1442366529, "creation_date": 1442366529, "answer_id": 32598230, "question_id": 32597624, "link": "https://stackoverflow.com/questions/32597624/copying-excel-source-theme-formatting-only-in-vba/32598230#32598230", "title": "Copying Excel source theme (formatting only) in VBA", "body": "<p>Try 1 or 2</p>\n\n<pre><code>Option Explicit\n\nPublic Sub copyWithoutFormulas_1()\n    xlEnabled False\n    With Sheet2\n        .EnableCalculation = False\n        .EnableFormatConditionsCalculation = False\n\n        .UsedRange.EntireColumn.Delete\n        Sheet1.UsedRange.Copy .Cells(1, 1)\n        .UsedRange.Value2 = .UsedRange.Value2\n\n        .EnableCalculation = True\n        .EnableFormatConditionsCalculation = True\n    End With\n    Application.CutCopyMode = False\n    xlEnabled True\nEnd Sub\n\nPublic Sub copyWithoutFormulas_2()\n    xlEnabled False\n    Sheet1.Copy After:=Worksheets(Worksheets.Count)\n    With Worksheets(Worksheets.Count).UsedRange\n        .Value2 = .Value2\n    End With\n    xlEnabled True\nEnd Sub\n\nPrivate Sub xlEnabled(ByVal opt As Boolean)\n    With Application\n        .EnableEvents = opt\n        .DisplayAlerts = opt\n        .ScreenUpdating = opt\n        .Calculation = IIf(opt, xlCalculationAutomatic, xlCalculationManual)\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1637, "user_id": 1291912, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/409aba3615511a10351efe5edf016b4b?s=128&d=identicon&r=PG", "display_name": "SF Lee", "link": "https://stackoverflow.com/users/1291912/sf-lee"}, "is_accepted": true, "score": 1, "last_activity_date": 1442534602, "creation_date": 1442534602, "answer_id": 32641843, "question_id": 32597624, "link": "https://stackoverflow.com/questions/32597624/copying-excel-source-theme-formatting-only-in-vba/32641843#32641843", "title": "Copying Excel source theme (formatting only) in VBA", "body": "<p>To force copy the source theme to the destination cells, one can do the following. Unfortunately, this method will apply the source theme to the entire destination workbook, which is OK in my situation. Not sure if it's useful for anyone else.</p>\n\n<pre><code>Sub CopyText(fromCells As Range, toCells As Range, Optional copyTheme As Boolean = False)\n    If copyTheme Then\n        Dim fromWorkbook As Workbook\n        Dim toWorkbook As Workbook\n        Dim themeTempFilePath As String\n\n        Set fromWorkbook = fromCells.Worksheet.Parent\n        Set toWorkbook = toCells.Worksheet.Parent\n        themeTempFilePath = Environ(\"temp\") &amp; \"\\\" &amp; fromWorkbook.Name &amp; \"Theme.xml\"\n\n        fromWorkbook.Theme.ThemeFontScheme.Save themeTempFilePath\n        toWorkbook.Theme.ThemeFontScheme.Load themeTempFilePath\n        fromWorkbook.Theme.ThemeColorScheme.Save themeTempFilePath\n        toWorkbook.Theme.ThemeColorScheme.Load themeTempFilePath\n    End If\n\n    Set toCells = toCells.Cells(1, 1).Resize(fromCells.Rows.Count, fromCells.Columns.Count)\n    fromCells.Copy\n\n    toCells.PasteSpecial Paste:=xlPasteFormats\n    toCells.PasteSpecial Paste:=xlPasteColumnWidths\n    toCells.PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1637, "user_id": 1291912, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/409aba3615511a10351efe5edf016b4b?s=128&d=identicon&r=PG", "display_name": "SF Lee", "link": "https://stackoverflow.com/users/1291912/sf-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3777, "favorite_count": 0, "accepted_answer_id": 32641843, "answer_count": 2, "score": 1, "last_activity_date": 1442534602, "creation_date": 1442361997, "last_edit_date": 1442534417, "question_id": 32597624, "link": "https://stackoverflow.com/questions/32597624/copying-excel-source-theme-formatting-only-in-vba", "title": "Copying Excel source theme (formatting only) in VBA", "body": "<p>I'm trying to programmatically copy a large range of cells from one workbook to another in VBA. I want to copy the formatting (including the entire source theme) and values, but NOT formulas. The following is my VBA code:</p>\n\n<pre><code>fromCells.Copy\n\ntoCells.PasteSpecial Paste:=xlPasteFormats\ntoCells.PasteSpecial Paste:=xlPasteColumnWidths\ntoCells.PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>Unfortunately, there are occasions when the above code doesn't work. This is usually with Font face and size. I noticed that whenever this happens, the only way to copy the font formatting across is to use <code>xlPasteAllUsingSourceTheme</code>, so it seems the font formatting is somehow registered to a 'source theme'. Unfortunately, <code>xlPasteAllUsingSourceTheme</code> doesn't work for me because it's copying formulas as well.</p>\n\n<p>So is there a way to copy the source theme (formatting only) across? Or maybe a way to force copy all the font formatting across?</p>\n\n<p><strong>Note:</strong> Copying using <code>xlPasteAllUsingSourceTheme</code> and then overwriting it with <code>xlPasteValues</code> won't work for me because when the formulas is copied it keeps popping up message boxes telling me about issues with the formulas (such as conflicting named ranges used in the formulas, etc.).</p>\n\n<p>I'm using Excel 2013. I noticed this problem doesn't seem to arise in Excel 2007 or earlier. Any help is appreciated.</p>\n\n<hr>\n\n<p><strong>Edit:</strong> I've also tried the following code (added to the beginning of the above code), it still doesn't work...</p>\n\n<pre><code>Dim themeTempFilePath As String\nthemeTempFilePath = Environ(\"temp\") &amp; \"\\\" &amp; fromWorkbook.Name &amp; \"Theme.xml\"\n\nfromWorkbook.Theme.ThemeFontScheme.Save themeTempFilePath\ntoWorkbook.Theme.ThemeFontScheme.Load themeTempFilePath\nfromWorkbook.Theme.ThemeColorScheme.Save themeTempFilePath\ntoWorkbook.Theme.ThemeColorScheme.Load themeTempFilePath\n</code></pre>\n\n<hr>\n\n<p><strong>Update:</strong> It seems the above code for saving and loading themes <em>does</em> work. The problematic text that I was looking at came from a different place - a form control. It was copied as a picture (using <code>Shape.CopyPicture</code>) but somehow the font gets changed in the process. However, I'll post this issue as another question.</p>\n\n<p>For this question, I'll put up the theme saving and loading mechanism as an answer.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1442363145, "post_id": 32597447, "comment_id": 53048631, "body": "Why are you confused?  What happens when you run your code?"}, {"owner": {"reputation": 1, "user_id": 2872893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323df1c287eba623ae87647914443568?s=128&d=identicon&r=PG&f=1", "display_name": "Steve T", "link": "https://stackoverflow.com/users/2872893/steve-t"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1442408752, "post_id": 32597447, "comment_id": 53069832, "body": "It copies the first selection, pastes the first selection on the first pass but then only pastes the first selection again again and again. The filter doesn&#39;t reset to the new selection for the second week, third etc."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 2872893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323df1c287eba623ae87647914443568?s=128&d=identicon&r=PG&f=1", "display_name": "Steve T", "link": "https://stackoverflow.com/users/2872893/steve-t"}, "edited": false, "score": 0, "creation_date": 1442427116, "post_id": 32613263, "comment_id": 53082344, "body": "Not quite.. It runs through the first time...the second time there is no filter and it fails in the with: &quot;autofilter method of Range class failed&quot; ."}, {"owner": {"reputation": 1, "user_id": 2872893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323df1c287eba623ae87647914443568?s=128&d=identicon&r=PG&f=1", "display_name": "Steve T", "link": "https://stackoverflow.com/users/2872893/steve-t"}, "edited": false, "score": 0, "creation_date": 1442437904, "post_id": 32613263, "comment_id": 53088141, "body": "on the second pass..            .AutoFilter Field:=1, Criteria1:=&quot;&gt;=&quot; &amp; startWeek, _                         Operator:=xlAnd, Criteria2:=&quot;&lt;&quot; &amp; endWeek  ..............with the message &quot;autofilter method of Range class failed&quot;"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1442418515, "creation_date": 1442418515, "answer_id": 32613263, "question_id": 32597447, "link": "https://stackoverflow.com/questions/32597447/multiple-select-and-copy-on-different-pages/32613263#32613263", "title": "Multiple Select and Copy on different pages", "body": "<p>Maybe try removing the filter before re-applying it within the loop?\nUntested:</p>\n\n<pre><code>Sub tracker2()\n    clearSchedule\n    Dim fundingDate As Range\n    Dim SourceLastRow As Long\n    Dim sourceBook As Workbook\n    Dim sourceSheet As Worksheet\n    Dim copyRange As Range\n    Dim sched As Worksheet\n    Dim startWeek As Date\n    Dim endWeek As Date\n    Dim f As Range\n    Dim x As Integer\n\n    Set sourceBook = ThisWorkbook\n    Set sourceSheet = sourceBook.Worksheets(\"Oz\")\n    'Determine last row of source from Oz\n    With sourceSheet\n        SourceLastRow = .Cells(.Rows.Count, \"K\").End(xlUp).Row\n    End With\n\n    sourceSheet.Columns(\"A:AM\").Sort key1:=Range(\"K:K\"), _\n                     order1:=xlAscending, Header:=xlYes\n\n    Set sched = ThisWorkbook.Sheets(\"Schedule\")\n\n    Set fundingDate = sourceSheet.Range(\"K1:K\" &amp; SourceLastRow)\n    Set copyRange = sourceSheet.Range(\"H2:N\" &amp; SourceLastRow)\n\n    'need to loop 4 times\n     For x = 7 To 28 Step 7\n\n         startWeek = Date - (Weekday(Date, vbMonday) - 1) + x\n         endWeek = Date + (7 - Weekday(Date, vbMonday)) + x\n\n         'sets oz to sort on inst start\n         With fundingDate\n            .Parent.Cells.AutoFilter '&lt;&lt;&lt;remove any previous filter\n            .AutoFilter Field:=1, Criteria1:=\"&gt;=\" &amp; startWeek, _\n                        Operator:=xlAnd, Criteria2:=\"&lt;\" &amp; endWeek\n         End With\n\n         Set f = sched.Cells.Find(startWeek)\n         copyRange.SpecialCells(xlCellTypeVisible).Copy _\n                               sched.Cells(17, f.Column)\n\n     Application.CutCopyMode = False\n     Next x 'close 4 times loop\n\n    Cells.AutoFilter\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 2872893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323df1c287eba623ae87647914443568?s=128&d=identicon&r=PG&f=1", "display_name": "Steve T", "link": "https://stackoverflow.com/users/2872893/steve-t"}, "is_accepted": true, "score": 0, "last_activity_date": 1442771673, "creation_date": 1442771673, "answer_id": 32682510, "question_id": 32597447, "link": "https://stackoverflow.com/questions/32597447/multiple-select-and-copy-on-different-pages/32682510#32682510", "title": "Multiple Select and Copy on different pages", "body": "<p>Here is the actual working code</p>\n\n<pre><code>Sub tracker3()\n clearSchedule\n Dim fundingDate As Range\n Dim SourceLastRow As Long\n Dim sourceBook As Workbook\n Dim sourceSheet As Worksheet\n Dim copyRange As Range\n Dim sched As Worksheet\n Dim startWeek As Date\n Dim endWeek As Date\n Dim f As Range\n Dim x As Integer\n Set sourceBook = ThisWorkbook\n Set sourceSheet = sourceBook.Worksheets(\"Oz\")\n'Determine last row of source from Oz which is the source worksheet\nWith sourceSheet\n    SourceLastRow = .Cells(.Rows.Count, \"K\").End(xlUp).row\nEnd With\n'sorts sourcesheet based on Install Start\nsourceSheet.Columns(\"A:AM\").Sort key1:=Range(\"K:K\"), _\n                 order1:=xlAscending, Header:=xlYes\n\nSet sched = ThisWorkbook.Sheets(\"Schedule\")\n\n'need to loop 4 times for 4 weeks info\n For x = 7 To 28 Step 7\n    Set fundingDate = sourceSheet.Range(\"K1:K\" &amp; SourceLastRow) 'install start\n    Set copyRange = sourceSheet.Range(\"H2:N\" &amp; SourceLastRow) 'the 7 columsn to be copied\n     startWeek = Date - (Weekday(Date, vbMonday) - 1) + x\n     endWeek = Date + (7 - Weekday(Date, vbMonday)) + x\n\n     'With the source sheet Oz\n     With sourceSheet\n        Cells.AutoFilter '&lt;&lt;&lt;remove any previous filter\n        Cells.AutoFilter Field:=11, Criteria1:=\"&gt;=\" &amp; startWeek, _\n                    Operator:=xlAnd, Criteria2:=\"&lt;\" &amp; endWeek\n     End With\n\n     Set f = sched.Cells.Find(startWeek) 'find the proper place to paste\n     copyRange.SpecialCells(xlCellTypeVisible).Copy _\n                           sched.Cells(17, f.Column)\n\n Application.CutCopyMode = False\n Next x 'close 4 times loop\n\nCells.AutoFilter\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 2872893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323df1c287eba623ae87647914443568?s=128&d=identicon&r=PG&f=1", "display_name": "Steve T", "link": "https://stackoverflow.com/users/2872893/steve-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 32682510, "answer_count": 2, "score": 0, "last_activity_date": 1442771673, "creation_date": 1442360817, "last_edit_date": 1442423638, "question_id": 32597447, "link": "https://stackoverflow.com/questions/32597447/multiple-select-and-copy-on-different-pages", "title": "Multiple Select and Copy on different pages", "body": "<p>I have a workbook with one sheet (Oz) updated daily.\nThe other sheet (Schedule) displays horizontally by week.\nI identify the date of next Monday\nsearch for that column in 'Schedule' and clear everything on 'Schedule' to the right of that column (This works with the clearschedule function).\nThen I want to rebuild 'Schedule' with the latest data in 'Oz'<br>\nI sort 'Oz' on column K (This works). Then I filter for all the installs that  are in week 1 (start greater than or equal to next Monday and less than next Sunday). I copy the selection (H2:N?) from 'Oz', find the matching startWeek column on 'Schedule' and then paste the selected 'Oz'columns into 'Schedule'......week 1 plotted (This works)\nNow I am trying to loop this 4 times (7 to 28 step 7) to select and copy from 'Oz' to the next 4 weeks in 'Schedule'. This is where the problem is.......It keeps pasting the original week 1 data into the next weeks on 'Schedule'</p>\n\n<p>Can anyone tell me why the code doesn't filter, copy and paste the next week?</p>\n\n<pre><code>Sub tracker2()\n  clearSchedule\n  Dim fundingDate As Range\n  Dim SourceLastRow As Long\n  Dim sourceBook As Workbook\n  Dim sourceSheet As Worksheet\n  Dim copyRange As Range\n  Dim sched As Worksheet\n  Dim startWeek As Date\n  Dim endWeek As Date\n  Dim f As Range\n  Dim Col_letter\n  Dim x As Integer\n  Set sourceBook = ThisWorkbook\n  Set sourceSheet = sourceBook.Worksheets(\"Oz\")\n    'Determine last row of source from Oz\n   With sourceSheet\n       SourceLastRow = .Cells(.Rows.Count, \"K\").End(xlUp).row\n   End With\n   Columns(\"A:AM\").Sort key1:=Range(\"K:K\"), order1:=xlAscending, Header:=xlYes\n   Set sched = ThisWorkbook.Sheets(\"Schedule\")\n\n   Set fundingDate = sourceSheet.Range(\"K1:K\" &amp; SourceLastRow)\n   'need to loop 4 times\n    For x = 7 To 28 Step 7\n        startWeek = Date - (Weekday(Date, vbMonday) - 1) + x\n        endWeek = Date + (7 - Weekday(Date, vbMonday)) + x\n        Set f = sched.Cells.Find(startWeek)\n        Col_letter = Split(Cells(1, f.Column).Address(True, False), \"$\")(0)\n        'sets oz to sort on inst start\n        With fundingDate\n          .AutoFilter Field:=1, Criteria1:= _\n            \"&gt;=\" &amp; startWeek, Operator:=xlAnd, Criteria2:=\"&lt;\" &amp; endWeek\n           Set copyRange = sourceSheet.Range(\"H2:N\" &amp; SourceLastRow)\n           copyRange.SpecialCells(xlCellTypeVisible).Copy sched.Range(Col_letter &amp; \"17\")\n       End With\n    Application.CutCopyMode = False\n    Next x\n  'close 4 times loop\n  Cells.AutoFilter\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 5205268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8bce853cb10c9d08763ad2d199e022c7?s=128&d=identicon&r=PG&f=1", "display_name": "D.Alexander", "link": "https://stackoverflow.com/users/5205268/d-alexander"}, "is_accepted": false, "score": 0, "last_activity_date": 1513274968, "last_edit_date": 1513274968, "creation_date": 1442361954, "answer_id": 32597617, "question_id": 32597261, "link": "https://stackoverflow.com/questions/32597261/vba-code-multiple-if-condition-and-put-complete-datein-respective-column/32597617#32597617", "title": "VBA code multiple if condition and put complete datein respective column", "body": "<p>The wording of your question was very interesting, maybe a screenshot might be better. Ok this is what I have crafted. I am sorry I am not sure this code will work 100% as I have not got Word installed on this machine so had to write it in notepad, so may not be the best solution. As suggested in one of the comments - you have to add add() in the button1_click event. Hopefully this has been of some use.</p>\n\n<pre><code>Private Sub add()                   'Add the add sub routine to the button1_click\n    Sheets(\"Renewal\").Activate()            'makes the sheet activate\n    if textbox1.text &lt;&gt; \"\" and textbox2.text &lt;&gt; \"\" and textbox3.text &lt;&gt; \"\" and combobox1.text &lt;&gt; \"\" then        'condition\n        dim pos as integer          'used to find next position\n        pos = findNext()            'adds next position value\n\n        activesheet.cells(1,pos).value = textbox2.text          'adds Date of completion\n        activesheet.cells(2,pos).value = textbox3.text          'adds annual premium\n        activesheet.cells(3,pos).value = textbox1.text          'adds customer number\n        activesheet.cells(4,pos).value = combobox1.text         'adds product type\n\n        'unsure if combobox1.text is correct.\n\n    end if                      'end of the condition\nEnd sub                         'end of sub routine\n\nPrivate function findNext()                 'this function finds the next position in sheet\n    dim x as integer                'used as a counter\n    x = 1                       'counter = 1\n    do                      'start of iteration\n        x = x + 1               'counting\n    loop until activesheet.cells(1,x).value = \"\"    'end when cell (A, counter) has no value\n    return x                    'returns the counter value\nEnd function                        'end of function\n</code></pre>\n\n<p>P.S. If you are a complete begin beginner - This video may help you with the ui: <a href=\"https://www.youtube.com/watch?v=hCIpMwdKCgE\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=hCIpMwdKCgE</a></p>\n"}], "owner": {"reputation": 1, "user_id": 5340065, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vWfrI2zAhhA/AAAAAAAAAAI/AAAAAAAAAUA/Zzcr09Dx2W8/photo.jpg?sz=128", "display_name": "Flying Zone", "link": "https://stackoverflow.com/users/5340065/flying-zone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1513274968, "creation_date": 1442359430, "last_edit_date": 1442363483, "question_id": 32597261, "link": "https://stackoverflow.com/questions/32597261/vba-code-multiple-if-condition-and-put-complete-datein-respective-column", "title": "VBA code multiple if condition and put complete datein respective column", "body": "<p>I am creating macro and I am stuck in creating the main page of VBA code. we have a sheet named \"Renewal\" in which all the customer information we dump. Column C we have customer number, Column D We have product type Dental, LIFE &amp; Dis. Column A we have to put complete data, and Column B we have to put annual premium. Now I want the main page where I can one input box1 in which I put customer number,  combo box1 in which 3 option I will get \"DENTAL, LIFE, DIS., input box2 Date of completion, and input box3 annual premium. If input box1 and combo box1 condition satisfy then date will put on same row of column A and annual premium in column B respectively.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5339633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24b0236cf0c20f20d9f20bb3e1a8f574?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Dole", "link": "https://stackoverflow.com/users/5339633/bob-dole"}, "edited": false, "score": 0, "creation_date": 1442367986, "post_id": 32597460, "comment_id": 53049740, "body": "for the line where you declare htmlBDY, my program says &quot;user defined type not defined&#39;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 11, "user_id": 5339633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24b0236cf0c20f20d9f20bb3e1a8f574?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Dole", "link": "https://stackoverflow.com/users/5339633/bob-dole"}, "edited": false, "score": 0, "creation_date": 1442369180, "post_id": 32597460, "comment_id": 53050004, "body": "Go to the VBE&#39;s Tools \u25ba References scroll down and put a checkmark beside Microsoft HTML Object Library."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1442360887, "creation_date": 1442360887, "answer_id": 32597460, "question_id": 32597253, "link": "https://stackoverflow.com/questions/32597253/argument-type-mismatch/32597460#32597460", "title": "Argument Type Mismatch", "body": "<p>You are confusing an expected <strong>HTMLDocument</strong> with its string contents.</p>\n\n<pre><code>Sub ImportBPlans()\n    Dim BPlan As String, FullHTML As String, URL1 As String, Cut1 As String\n    Dim FO As String, LO As String, Other1 As Long\n\n    URL1 = \"http://finance.yahoo.com/q/pr?s=AAPL+Profile\"\n    FullHTML = GetHTML(URL1)\n    BPlan = \"&amp;nbsp;&lt;/th&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;\"\n    FO = InStr(FullHTML, BPlan) + Len(BPlan)\n    LO = InStr(FO, FullHTML, \"&lt;\")\n    Cut1 = Left(FullHTML, LO)\n    Cut1 = Right(Cut1, FO - LO)\n\n    Debug.Print Cut1\n    'WB5.Cells(1, 1).Value = Cut1\n\nEnd Sub\n\nFunction GetHTML(URL As String) As String\n    Dim HTML As String\n    Dim htmlBDY As New HTMLDocument\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", URL, False\n        .Send\n        htmlBDY.body.innerHTML = .responseText\n        GetHTML = htmlBDY.body.outerHTML\n    End With\nEnd Function\n</code></pre>\n\n<p>The HTMLDocument being received in the <code>.responseText</code> is more than what you would expect if tapping Ctrl+U to View Source. To pass back the source as a string from your function, you must resolve it down to a simple string.</p>\n"}, {"tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1442362501, "creation_date": 1442362501, "answer_id": 32597696, "question_id": 32597253, "link": "https://stackoverflow.com/questions/32597253/argument-type-mismatch/32597696#32597696", "title": "Argument Type Mismatch", "body": "<p>Your variable defining section is the issue. You need to tell what type it is before the comma (it's not used as English).</p>\n\n<p>See below, if you don't specify the type, it's <strong>Empty</strong>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/nwMu4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nwMu4.png\" alt=\"Dim Issue\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 5339633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24b0236cf0c20f20d9f20bb3e1a8f574?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Dole", "link": "https://stackoverflow.com/users/5339633/bob-dole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 32597460, "answer_count": 2, "score": 0, "last_activity_date": 1442363882, "creation_date": 1442359395, "last_edit_date": 1442363882, "question_id": 32597253, "link": "https://stackoverflow.com/questions/32597253/argument-type-mismatch", "title": "Argument Type Mismatch", "body": "<p>Line  5 of the code gives me an argument type mistmatch. Help me please?</p>\n\n<pre><code> Sub ImportBPlans()\nDim BPlan, FullHTML, URL1, Cut1 As String\nDim FO, LO, Other1 As Integer\n\nURL1 = \"http://finance.yahoo.com/q/pr?s=AAPL+Profile\"\nFullHTML = GetHTML(URL1)\nBPlan = \"&amp;nbsp;&lt;/th&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;\"\nFO = InStr(FullHTML, BPlan) + Len(BPlan)\nLO = InStr(FO, FullHTML, \"&lt;\")\nCut1 = Left(FullHMTML, LO)\nCut1 = Right(Cut1, FO - LO)\n\n\nWB5.Cells(1, 1).Value = Cut1\n\n\n\nEnd Sub\n\nFunction GetHTML(URL As String) As String\n    Dim HTML As String\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", URL, False\n        .Send\n        GetHTML = .ResponseText\n    End With\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "parsing", "text"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1442360381, "post_id": 32596930, "comment_id": 53047888, "body": "First idea come to mind is to use a variable to store which mode when the line is read, say <code>If InStr(1,Line,&quot;Variable&quot;,vbTextCompare) &gt; 0 Then bLookForValue = True</code>, so from next line, different test cases for items in splitting <code>|</code> and use <code>Len(...) &gt; 0</code>, <code>IsNumeric(...)</code> to pick up values, when value retrieved, <code>bLookForValue = False</code>. It may also help to remove empty spaces for each Line."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1442363780, "post_id": 32596930, "comment_id": 53048777, "body": "Is &quot;Value2&quot; always in the same location or do you need to find that first before extracting the value from the following line?"}, {"owner": {"reputation": 31, "user_id": 5339974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efec2307386dee045e1225b87035397e?s=128&d=identicon&r=PG&f=1", "display_name": "Frooga", "link": "https://stackoverflow.com/users/5339974/frooga"}, "edited": false, "score": 0, "creation_date": 1442364546, "post_id": 32596930, "comment_id": 53048946, "body": "Thanks for your help. It&#39;s messy.  In this example, Value2 will always be in that location, and may repeat several times in the file. But there are additional tables with data I am interested in. In these cases, value2 may be in a different row or position in the line. To make it worse, some tables do not have unique column headers, so there may be multiple &quot;Value&quot; strings. This is why I need to somehow key off of &quot;Variable&quot; for text. Numerically, the data value is also not always unique."}, {"owner": {"reputation": 31, "user_id": 5339974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efec2307386dee045e1225b87035397e?s=128&d=identicon&r=PG&f=1", "display_name": "Frooga", "link": "https://stackoverflow.com/users/5339974/frooga"}, "edited": false, "score": 0, "creation_date": 1442365048, "post_id": 32596930, "comment_id": 53049062, "body": "Tim: thank you also for fixing the table display in my post. How did you do that?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1442377414, "post_id": 32596930, "comment_id": 53051983, "body": "I used the code sample <code>{}</code> button."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1442377949, "post_id": 32596930, "comment_id": 53052144, "body": "Would be useful if you could post a larger sample, or provide more detail about exactly what you need to parse.  Otherwise, @PatricK&#39;s advise is more or less how you should proceed."}, {"owner": {"reputation": 31, "user_id": 5339974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efec2307386dee045e1225b87035397e?s=128&d=identicon&r=PG&f=1", "display_name": "Frooga", "link": "https://stackoverflow.com/users/5339974/frooga"}, "edited": false, "score": 0, "creation_date": 1442445900, "post_id": 32596930, "comment_id": 53090989, "body": "I&#39;m not familiar enough with VBA. To understand Patrick&#39;s suggestion. Can someone provide an example of one test scenario for items in splitting | and using Len and IsNuemeric commands? The piece of code I&#39;m using wasn&#39;t mine originally. I found it on a forum and modified it. But, I&#39;m stuck if the data value and the text string I&#39;m keying off of are on different lines."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 5339974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efec2307386dee045e1225b87035397e?s=128&d=identicon&r=PG&f=1", "display_name": "Frooga", "link": "https://stackoverflow.com/users/5339974/frooga"}, "is_accepted": false, "score": 1, "last_activity_date": 1443568119, "creation_date": 1443568119, "answer_id": 32855183, "question_id": 32596930, "link": "https://stackoverflow.com/questions/32596930/parsing-data-from-txt-file-using-vba-data-and-variable-on-different-line/32855183#32855183", "title": "Parsing data from .txt file using VBA, data and variable on different line", "body": "<p>I had friend help me out with this problem and we found that the only way to extract the exact data I wanted was to key off unique text and then off of the +--- characters that defined the table:</p>\n\n<pre><code>If InStr(1, LineTxt, \"Variable\", vbTextCompare) Then ' Look For unique text in desired table - this starts the next search for \"Object\"\n\n    a = 0 'Use this as a switch for breaking out of next DO LOOP\n\nDo While a &lt;&gt; 1 'Do this unti a = 1\n\n    Line Input #1, LineTxt ' Read line from\n\n    If InStr(1, LineTxt, \"+==========\") Then ' Look for Type - This only occurs after \"Object\" is found, so it will not happen other time \"Type\" occurs in the log.\n    Line Input #1, LineTxt ' read a line on each loop\n    Row = Row + 1 ' Increment counter for row\n       Worksheets(\"Output\").Range(\"J60000\").End(xlUp).Offset(1, 0).Value = Trim(Split(LineTxt, \"|\")(3)) 'Once \"Type\" is found, split the line and write the data to a cell on worksheet \"Output\"\n\n    a = 1 ' Set swith to 1 - The Do / While loop will break due to this switch change.\n    End If\nLoop ' Loop until a = 1\n</code></pre>\n\n<p>End If</p>\n\n<p>Thanks to everyone that did provide suggestions.  I learned a lot on this forum!</p>\n"}], "owner": {"reputation": 31, "user_id": 5339974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efec2307386dee045e1225b87035397e?s=128&d=identicon&r=PG&f=1", "display_name": "Frooga", "link": "https://stackoverflow.com/users/5339974/frooga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 929, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1443568119, "creation_date": 1442357345, "last_edit_date": 1442358099, "question_id": 32596930, "link": "https://stackoverflow.com/questions/32596930/parsing-data-from-txt-file-using-vba-data-and-variable-on-different-line", "title": "Parsing data from .txt file using VBA, data and variable on different line", "body": "<p>I have a .txt file that changes the format it is displayed in for certain variables</p>\n\n<p>I am able to successfully extract time data using this code:</p>\n\n<p>File data:</p>\n\n<pre><code>+---------------------+------------------------------------------------------------------+\n| Start Time      | 09/06/2015 02:28:58                                              |\n| Finish Time     | 09/06/2015 03:12:33                                              |\n+---------------------+------------------------------------------------------------------+\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>'open .txt files from defined folder(s)\n  Set fso = CreateObject(\"Scripting.FileSystemObject\")\n  For Each f In fso.GetFolder(\"C:\\Localdata\\XYZ\").Files\n    If LCase(fso.GetExtensionName(f.Name)) = \"txt\" Then\n      'define Row\n      Row = Row + 1\n      'open each file as a text stream and read until end of file\n      Set stream = f.OpenAsTextStream\n      Do While Not stream.AtEndOfStream\n        Line = stream.ReadLine\n        'extract the data associated with the text for items in data line\n        If InStr(1, Line, \"Start Time\") Then\n        'Add each value to the next available row in designated column (A,B...)\n           Range(\"A60000\").End(xlUp).Offset(1, 0).Value = Trim(Split(Line, \"|\")(2))\n        End If\n</code></pre>\n\n<p>But, now I'm trying parse data that appears in the file in this manner:</p>\n\n<pre><code>|                                 |                   Variable                 |\n|                                 +-----------+-----------+--------+-----------+\n|            Object               |  Value1   |  Value2   | Value3 |  Value4   |\n|                                 |           |           |        |           |\n+=================================+===========+===========+========+===========+\n| Type                            |     5.00 |     10.00  |   15.00|     20.00 |\n+---------------------------------+-----------+-----------+--------+-----------+\n</code></pre>\n\n<p>I'd like to flag off the text \"Variable\" and pull the value under Value2 (10.00).\nI have several \"tables\" like this in the text file with variable spacing and character length</p>\n\n<p>How can I get it to skip down a few rows from the text string of interest?</p>\n"}, {"tags": ["ms-access", "ms-word", "vba", "export-to-word"], "answers": [{"tags": [], "owner": {"reputation": 187, "user_id": 1165586, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3a1d877212878ae24bde40440f9ee0d8?s=128&d=identicon&r=PG", "display_name": "Artec", "link": "https://stackoverflow.com/users/1165586/artec"}, "is_accepted": true, "score": 0, "last_activity_date": 1442400398, "creation_date": 1442400398, "answer_id": 32606445, "question_id": 32596564, "link": "https://stackoverflow.com/questions/32596564/access-2013-vba-bad-filling-word-2013-forms-with-data-from-access-2013/32606445#32606445", "title": "Access 2013 VBA,bad filling Word 2013 forms with data from Access 2013", "body": "<p>I found an error !\nAccess VBA code is ok but problem was with content of Document.dotx. I wrote in my post that I have set dot separator in regional settings but in Word bookmark \"NR\" I saw coma. That was issue. I changed bookmark properties (number format from 0,00 to 0.00) and everythings work great.\nI'm sorry that I answered myself to my question but I hope this can help others to find a solution to the problem.</p>\n"}], "owner": {"reputation": 187, "user_id": 1165586, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3a1d877212878ae24bde40440f9ee0d8?s=128&d=identicon&r=PG", "display_name": "Artec", "link": "https://stackoverflow.com/users/1165586/artec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 499, "favorite_count": 0, "accepted_answer_id": 32606445, "answer_count": 1, "score": -1, "last_activity_date": 1594651681, "creation_date": 1442355260, "last_edit_date": 1594651681, "question_id": 32596564, "link": "https://stackoverflow.com/questions/32596564/access-2013-vba-bad-filling-word-2013-forms-with-data-from-access-2013", "title": "Access 2013 VBA,bad filling Word 2013 forms with data from Access 2013", "body": "<p>I have a problem with filling Word 2013 forms with data from Access 2013.\nReferences:</p>\n\n<p><code>Visual Basic for application</code>\n<code>MS Access 15 Office Library</code>\n<code>Ole automation</code>\n<code>MS Access 15 database engine object</code>\n<code>MS Word 15 Object Library</code>\n<code>MS ActiveX data object multi-dimensional library 2.8</code></p>\n\n<p>My code is:</p>\n\n<pre><code>Dim wordApp As Word.Application\nDim wordDoc As Word.Document\nSet wordApp = New Word.Application\nWith wordApp\n    .Visible = True\n    Set wordDoc = .Documents.Open(\"C:\\Template\\Document.dotx\", , False)\n    With wordDoc\n        .FormFields(\"NR\").result = Me!NR\n</code></pre>\n\n<p>NR - is standard numeric format, for example 1500.00</p>\n\n<p>If I type 1500.00 as a result in Document.docx I h've got 1500,00 but if i type 1500.80 (other than 00 after dot) I've got 15008,00.\nPrinted value is ten times larger than typed.</p>\n\n<p>In regional settings I have set dot separator but in Word I see coma (but in Access 2010 it worked).</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 4548240, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/080d090ef4d153a1f25c572cf9809ee2?s=128&d=identicon&r=PG&f=1", "display_name": "Freek v. wely", "link": "https://stackoverflow.com/users/4548240/freek-v-wely"}, "is_accepted": false, "score": -1, "last_activity_date": 1444987558, "creation_date": 1444987558, "answer_id": 33166858, "question_id": 32596515, "link": "https://stackoverflow.com/questions/32596515/input-data-a-part-of-a-kolom-from-a-different-file-with-the-same-date-in-the-k/33166858#33166858", "title": "Input data (a part of a kolom) from a different file with the same date in the kolom", "body": "<p>I have found the solution with a formule and not with a macro.\nWith using the formule HLOOKUP() i have the right result.</p>\n"}], "owner": {"reputation": 101, "user_id": 4548240, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/080d090ef4d153a1f25c572cf9809ee2?s=128&d=identicon&r=PG&f=1", "display_name": "Freek v. wely", "link": "https://stackoverflow.com/users/4548240/freek-v-wely"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1444987558, "creation_date": 1442354969, "last_edit_date": 1442364996, "question_id": 32596515, "link": "https://stackoverflow.com/questions/32596515/input-data-a-part-of-a-kolom-from-a-different-file-with-the-same-date-in-the-k", "title": "Input data (a part of a kolom) from a different file with the same date in the kolom", "body": "<p>Is it possible to import data from a column in an different file with the same date in the column.\nOn one sheet i have 7 dates created in different columns with </p>\n\n<pre><code>    15-09-15    16-09-15    17-09-15    18-09-15    19-09-15    20-09-15    21-09-15\n</code></pre>\n\n<p>O<br>\nM<br>\nN                           </p>\n\n<p>Now will i show data from cells from a column from a different file with the same date as a cell in the kolom where will be paste the data.</p>\n"}, {"tags": ["c#", "asp.net-mvc", "excel", "vba", "math"], "answers": [{"comments": [{"owner": {"reputation": 465, "user_id": 2769616, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002153640039/picture?type=large", "display_name": "Rodrigo Riskalla Leal", "link": "https://stackoverflow.com/users/2769616/rodrigo-riskalla-leal"}, "edited": false, "score": 0, "creation_date": 1442436958, "post_id": 32596536, "comment_id": 53087664, "body": "It Worked! but for other situations it still gives wrong answers. How could i fix it?"}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "reply_to_user": {"reputation": 465, "user_id": 2769616, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002153640039/picture?type=large", "display_name": "Rodrigo Riskalla Leal", "link": "https://stackoverflow.com/users/2769616/rodrigo-riskalla-leal"}, "edited": false, "score": 0, "creation_date": 1442438770, "post_id": 32596536, "comment_id": 53088594, "body": "You&#39;ll have to be more specific - what situations?  does a difference in the 14th or 15th decimal really matter that much?"}, {"owner": {"reputation": 465, "user_id": 2769616, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002153640039/picture?type=large", "display_name": "Rodrigo Riskalla Leal", "link": "https://stackoverflow.com/users/2769616/rodrigo-riskalla-leal"}, "edited": false, "score": 0, "creation_date": 1442504190, "post_id": 32596536, "comment_id": 53117469, "body": "I have edited my question, in the end there is an Example. Actually I&#39;m developing an application for an financial institution that is used to do calculation with excel, so minor errors can propagate."}], "tags": [], "owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "is_accepted": false, "score": 1, "last_activity_date": 1442355470, "last_edit_date": 1442355470, "creation_date": 1442355113, "answer_id": 32596536, "question_id": 32596378, "link": "https://stackoverflow.com/questions/32596378/emulate-excel-numeric-precision-c-net/32596536#32596536", "title": "Emulate Excel Numeric Precision C# .NET", "body": "<p>If you want to emulate floating-point math then use <code>double</code> instead of <code>decimal</code>. <code>decimal</code> is designed to give a more accurate base-10 representation at the expense of speed. If you use <code>double</code> in C# you get the same result as Excel (at least for your examples - there may be other edge cases that behave differently):</p>\n\n<p>C#: </p>\n\n<pre><code>double result = 1.0 + 1.0 / 9000.0 - 1.0;\nConsole.WriteLine(result.ToString(\"N30\"));\n\n0.000111111111111173000000000000\n</code></pre>\n\n<p>Excel:</p>\n\n<pre><code>=1+1/9000-1\n\n0.000111111111111173000000000000\n</code></pre>\n"}], "owner": {"reputation": 465, "user_id": 2769616, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002153640039/picture?type=large", "display_name": "Rodrigo Riskalla Leal", "link": "https://stackoverflow.com/users/2769616/rodrigo-riskalla-leal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 498, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1442436913, "creation_date": 1442354274, "last_edit_date": 1442436913, "question_id": 32596378, "link": "https://stackoverflow.com/questions/32596378/emulate-excel-numeric-precision-c-net", "title": "Emulate Excel Numeric Precision C# .NET", "body": "<h1>Excel Precision system</h1>\n\n<p>Excel has a modified version of the IEEE 754 specification for numeric precision. More information on how Excel does calculation can be found <a href=\"https://en.wikipedia.org/wiki/Numeric_precision_in_Microsoft_Excel\" rel=\"nofollow\">here</a>.</p>\n\n<h2>Summarizing:</h2>\n\n<ul>\n<li>Numbers are stored with only it's 15 leading figures.</li>\n<li>Before any calculation Excel tries to represent the number as power of 2 (because of it's binary representation)</li>\n<li>If the number is not a simple power of 2, it uses geometric progression to find the closest number represented by binary.</li>\n<li>If the number is really small Excel represents it as a simple power of 2.</li>\n</ul>\n\n<hr>\n\n<h1>Problem</h1>\n\n<p>Other languages, in my case <strong>C# .NET</strong>, implement numeric precision in a different way. \nSo, when you try to emulate a Spreadsheet, you end up getting some precision mismatches.</p>\n\n<h2>Example</h2>\n\n<p>Open Excel and insert this formula in any cell:</p>\n\n<pre><code>=1+1/9000-1.\n</code></pre>\n\n<p>Then you will notice that the result is not the same as the one that is obtained by the following formula:</p>\n\n<pre><code>=1/9000\n</code></pre>\n\n<p><strong>I don't want to change this behavior of Excel, i just want to mimic it.</strong></p>\n\n<p>Now in C# create a simple program and do the same calculation with a <code>Decimal</code> number. <em>I'm using decimal to represent numbers. But it could be double our Float, the result will be the same.</em></p>\n\n<pre><code>decimal result = 1.0M + 1.0M / 9000.0M - 1.0M;\nConsole.WriteLine(result.ToString(\"N30\"));\n</code></pre>\n\n<h2>Question</h2>\n\n<p><strong>Is there any Way that C# can emulate Excel's numeric precision. So that i can get the same results as Excel?</strong></p>\n\n<h1>Edit</h1>\n\n<p>As @DStanley mentioned, using double solves the example above, but it stills doesn't work for other situations, for example:</p>\n\n<p>Excel:</p>\n\n<pre><code>=1+0.000000000000001665280326829110-1\n\n0.000000000000000000000000000000\n</code></pre>\n\n<p>C#:</p>\n\n<pre><code>double result = 1.0 + 0.000000000000001665280326829110 - 1.0;\nConsole.WriteLine(result.ToString(\"N30\"));\n\n0.000000000000001554312234475220\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1442353235, "post_id": 32596082, "comment_id": 53045691, "body": "Huh. <code>cells()</code> would be the logical choice but maybe <code>offset</code> perhaps?"}, {"owner": {"reputation": 55, "user_id": 2440200, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ce71e765b5f54ddb2a481cd021d77082?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Lima", "link": "https://stackoverflow.com/users/2440200/jo%c3%a3o-lima"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1442401858, "post_id": 32596082, "comment_id": 53064858, "body": "@findwindow <code>cells()</code> was my first thought but it took forever to display a single array. That&#39;s why I wanted to use <code>range()</code>. As I&#39;m quite new to VBA, I didn&#39;t know the <code>offset</code> function but perhaps it would work."}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 0, "last_activity_date": 1442354625, "last_edit_date": 1442354625, "creation_date": 1442354258, "answer_id": 32596372, "question_id": 32596082, "link": "https://stackoverflow.com/questions/32596082/display-arrays-without-using-a-loop-in-excel-vba/32596372#32596372", "title": "Display arrays without using a loop in Excel VBA", "body": "<p>Try this (untested)</p>\n\n<pre><code>Dim wb As Workbook, v As Variant, lCol As Long\n\nFor i = 1 To UBound(Files)\n    Set wb = Workbooks.Open(Files(i))\n    With thisWb.Sheets(1)\n        lCol = .Cells(1, .Columns.Count).End(xlToLeft).Column + 2\n        v = testfunction\n        .Range(.Cells(1, lCol), .Cells(UBound(v, 1), UBound(v, 2) + lCol)) = v\n        wb.Close False\n    End With\nNext\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 2440200, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ce71e765b5f54ddb2a481cd021d77082?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Lima", "link": "https://stackoverflow.com/users/2440200/jo%c3%a3o-lima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 32596372, "answer_count": 1, "score": 1, "last_activity_date": 1442354625, "creation_date": 1442353010, "last_edit_date": 1442353090, "question_id": 32596082, "link": "https://stackoverflow.com/questions/32596082/display-arrays-without-using-a-loop-in-excel-vba", "title": "Display arrays without using a loop in Excel VBA", "body": "<p>I have a problem displaying the results of the following code:</p>\n\n<pre><code>For i = 1 To UBound(files) Step 1    \n    Workbooks.Open files(i)\n    With ActiveWorkbook\n        Module2.testfunction\n        thisWb.Sheets(1).Range(\"A1:C\" &amp; Ubound(testfunction)) = testfunction\n        .Close False\n    End With\nNext i\n</code></pre>\n\n<p>In each iteration of the for loop, there is a new workbook to which I apply the \"testfunction\". This function returns an array and I need to write this array to the workbook where the macro is running (\"thisWb\"). With each iteration there is a new array and this new one has to be displayed in the next range of columns, so as not to overlap the one displayed before (with a spacing of one column).</p>\n\n<p>As the code is now, there is an overlapping. I want to find a way to iterate the range (in the column part) without having to resort to a loop with Cells().  </p>\n\n<p>Is it possible?</p>\n"}, {"tags": ["c#", "multithreading", "excel", "excel-interop", "vba"], "owner": {"reputation": 41, "user_id": 3637892, "user_type": "registered", "profile_image": "https://graph.facebook.com/1591933394/picture?type=large", "display_name": "Diego Cruz", "link": "https://stackoverflow.com/users/3637892/diego-cruz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1442446791, "creation_date": 1442352015, "last_edit_date": 1531161705, "question_id": 32595849, "link": "https://stackoverflow.com/questions/32595849/handling-vba-macros-concurrency-in-a-single-excel-instance", "title": "Handling VBA macros concurrency in a single Excel instance", "body": "<p>I'm developing a .NET application to do some automation tasks in Excel (run macros, refresh connections, etc). But due to <a href=\"https://stackoverflow.com/questions/32540576/unexpected-behavior-when-refreshing-internal-data-connections-in-excel\">{this issue}</a> I need to run all tasks in only one instance of Excel. </p>\n\n<p>If an instance of Excel is already open, I use it, else I create a new one. The problem is that Excel is single thread, so I need to handle concurrency when multiple instances of my application are running at the same time. At the momment, I just catch the COM exception \"0x800AC472\" and retry (with a sleep of X seconds) until the running task has ended. However, it's not a very robust solution, several errors occurs and some deadlock issues appears.</p>\n\n<p>Can I handle Excel concurrency in a robust way?</p>\n\n<p>I have already in my code an implementation of IMessageFilter, but it's not sufficient.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 5331685, "user_type": "registered", "profile_image": "https://graph.facebook.com/1066582100020217/picture?type=large", "display_name": "Jared Burton", "link": "https://stackoverflow.com/users/5331685/jared-burton"}, "edited": false, "score": 0, "creation_date": 1442358677, "post_id": 32596217, "comment_id": 53047468, "body": "Yeah, I was thinking of doing something like that (I&#39;m not one to avoid being a little crude, haha). The problem is, I want this code to work for any employee that I&#39;m adding through a different macro, If it could be one code to work for the whole workbook instead of one I would have to add to each sheet it&#39;d be a lot better for me"}, {"owner": {"reputation": 55, "user_id": 5331685, "user_type": "registered", "profile_image": "https://graph.facebook.com/1066582100020217/picture?type=large", "display_name": "Jared Burton", "link": "https://stackoverflow.com/users/5331685/jared-burton"}, "edited": false, "score": 0, "creation_date": 1442366920, "post_id": 32596217, "comment_id": 53049495, "body": "Okay Just did a bunch more research, looks like this is the only way that I can find to do it. I&#39;ll make it work, thanks for the help!"}, {"owner": {"reputation": 191, "user_id": 5149107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf2d7652f551f5c58c3005cb880f39f?s=128&d=identicon&r=PG&f=1", "display_name": "hughg", "link": "https://stackoverflow.com/users/5149107/hughg"}, "reply_to_user": {"reputation": 55, "user_id": 5331685, "user_type": "registered", "profile_image": "https://graph.facebook.com/1066582100020217/picture?type=large", "display_name": "Jared Burton", "link": "https://stackoverflow.com/users/5331685/jared-burton"}, "edited": false, "score": 0, "creation_date": 1442367420, "post_id": 32596217, "comment_id": 53049616, "body": "There is a &#39;SheetCalculate&#39; event in the Workbook object you could use instead. Updated answer to elaborate."}], "tags": [], "owner": {"reputation": 191, "user_id": 5149107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf2d7652f551f5c58c3005cb880f39f?s=128&d=identicon&r=PG&f=1", "display_name": "hughg", "link": "https://stackoverflow.com/users/5149107/hughg"}, "is_accepted": true, "score": 0, "last_activity_date": 1442367572, "last_edit_date": 1442367572, "creation_date": 1442353601, "answer_id": 32596217, "question_id": 32595553, "link": "https://stackoverflow.com/questions/32595553/change-one-sheets-name-when-another-is-changed/32596217#32596217", "title": "Change one sheet&#39;s name when another is changed", "body": "<p>It may be a bit crude, but you could simply use the 'Calculate' event on the second worksheet object to update its own name.</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n    If Range(\"A1\") &amp; \" Achievements\" &lt;&gt; Me.Name Then\n        Me.Name = Range(\"A1\") &amp; \" Achievements\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>or use the 'SheetCalculate event in the workbook object:</p>\n\n<pre><code>Private Sub Workbook_SheetCalculate(ByVal Sh As Object)\n    On Error Resume Next\n    If Sh.Range(\"W1\").Value = \"Achievement Lists\" Then\n        If Sh.Range(\"A1\").Value &amp; \" Achievements\" &lt;&gt; Sh.Name Then\n            Sh.Name = Sh.Range(\"A1\") &amp; \" Achievements\"\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 5331685, "user_type": "registered", "profile_image": "https://graph.facebook.com/1066582100020217/picture?type=large", "display_name": "Jared Burton", "link": "https://stackoverflow.com/users/5331685/jared-burton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 32596217, "answer_count": 1, "score": 1, "last_activity_date": 1442373354, "creation_date": 1442350884, "last_edit_date": 1442373354, "question_id": 32595553, "link": "https://stackoverflow.com/questions/32595553/change-one-sheets-name-when-another-is-changed", "title": "Change one sheet&#39;s name when another is changed", "body": "<p>I am working on a dashboard/stats for employees at my company, and I've run into a bit of a hiccup with one of my codes. Here's a bit of background to start</p>\n\n<p>Each employee has 2 sheets with their different stats. </p>\n\n<p>The first sheet is always visible and has a macro that will un-hide and activate the 2nd sheet (so that the workbook doesn't get too unmanageable.) When you click off the 2nd sheet, I have a macro that will hide it (it uses <code>workbook_Sheetdeactivate</code> to close the sheet if it has properties related to the 2nd sheet)</p>\n\n<p>The first sheet's tab-name is added to a cell (in my case <code>range(\"A62\"))</code>, with the formula <code>\"=MID(CELL(\"filename\",A1),FIND(\"]\",CELL(\"filename\",A1))+1,255)\"</code>. </p>\n\n<p>I then make that cell equal to <code>range(\"A1\")</code> on the second sheet. What I want is for the the name of the 2nd sheet to equal <code>range(\"A1\")</code> &amp; \" Achievements\", so that the 2nd sheet can be referenced in my macros by the first sheet. (Ex: if sheet1 is \"Bobby\", sheet2 is \"Bobby Achievements\")</p>\n\n<p>I didn't have trouble writing the macro itself, but I don't know which sub would be best to use so that the macro is activated at the right time. Is there a way to have the macro run whenever a sheetname is changed in the workbook?</p>\n\n<p>Here's the code:</p>\n\n<pre><code>dim ws as worksheet\n\n'Sorting through each sheet to find \"Achievement Sheets\"\nFor Each ws in Workbook\n    If ws.range(\"W1\").Value = \"Achievement Lists\" Then\n        ws.name = ws.Range(\"A1\") &amp; \" Achievements\"\n    End if\nNext ws\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1442350348, "post_id": 32595326, "comment_id": 53044437, "body": "Are you turning off screenupdating and setting calculation to manual?"}, {"owner": {"reputation": 173, "user_id": 2989297, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/628a99d3db020096dd08168e37273c10?s=128&d=identicon&r=PG&f=1", "display_name": "user2989297", "link": "https://stackoverflow.com/users/2989297/user2989297"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1442350494, "post_id": 32595326, "comment_id": 53044500, "body": "Was looking into screenupdating as you were typing that out. I dont think setting calculation to manual would make a difference. There are no formulas present when the command is running."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1442351555, "post_id": 32595326, "comment_id": 53044977, "body": "Can you sort the data? It&#39;s the abstract arrangement of the rows to be deleted that is gumming up the works.If they can all be sorted so that blank column A cells are in one contiguous block at the bottom of the data matrix everything will go much faster."}, {"owner": {"reputation": 173, "user_id": 2989297, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/628a99d3db020096dd08168e37273c10?s=128&d=identicon&r=PG&f=1", "display_name": "user2989297", "link": "https://stackoverflow.com/users/2989297/user2989297"}, "edited": false, "score": 0, "creation_date": 1442352158, "post_id": 32595326, "comment_id": 53045251, "body": "To do that, id need to add in an index, and if I do that, then the rows wont truely be blank and will make the file larger, which is what I am trying to avoid... the file size bloat may be worth the time it buys though..."}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 2989297, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/628a99d3db020096dd08168e37273c10?s=128&d=identicon&r=PG&f=1", "display_name": "user2989297", "link": "https://stackoverflow.com/users/2989297/user2989297"}, "edited": false, "score": 0, "creation_date": 1442352284, "post_id": 32595555, "comment_id": 53045320, "body": "Okay, I plugged this in, and the difference appears to be negligible. It may end up being better overall, but ive been running for 15 minutes and its still going, which is exceeding what I was hoping for. At that rate, id just keep the simpler command and leave it running overnight, Though I still dont want to do that..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 173, "user_id": 2989297, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/628a99d3db020096dd08168e37273c10?s=128&d=identicon&r=PG&f=1", "display_name": "user2989297", "link": "https://stackoverflow.com/users/2989297/user2989297"}, "edited": false, "score": 0, "creation_date": 1442352320, "post_id": 32595555, "comment_id": 53045335, "body": "Did you get the <code>.Cells.Sort</code> modification I included?"}, {"owner": {"reputation": 173, "user_id": 2989297, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/628a99d3db020096dd08168e37273c10?s=128&d=identicon&r=PG&f=1", "display_name": "user2989297", "link": "https://stackoverflow.com/users/2989297/user2989297"}, "edited": false, "score": 0, "creation_date": 1442353456, "post_id": 32595555, "comment_id": 53045775, "body": "Copy and pasted your code and changed the worksheet name."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1442352023, "last_edit_date": 1442352023, "creation_date": 1442350888, "answer_id": 32595555, "question_id": 32595326, "link": "https://stackoverflow.com/questions/32595326/optimizing-vba-command-to-delete-rows-with-blanks/32595555#32595555", "title": "Optimizing VBA command to delete rows with blanks", "body": "<p>Use an <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221844%28v=office.11%29.aspx\" rel=\"nofollow\">AutoFilter Method</a> and temporarily turn off all possible environment parameters.</p>\n\n<pre><code>    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Application.EnableEvents = False\n    Application.Calculation = xlCalculationManual\n    With Worksheets(\"Sheet1\")\n        If .AutoFilterMode Then .AutoFilterMode = False\n        With .Cells(1, 1).CurrentRegion\n            .Cells.Sort Key1:=.Columns(1), Order1:=xlAscending, _\n                        Orientation:=xlTopToBottom, Header:=xlYes\n            .AutoFilter Field:=1, Criteria1:=\"=\"\n            .Resize(.Rows.Count - 1, 1).Offset(1, 0).EntireRow.Delete\n            .AutoFilter\n        End With\n    End With\n    Application.Calculation = xlCalculationAutomatic\n    Application.EnableEvents = True\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n</code></pre>\n\n<p>It has been my experience that even looping through the rows from bottom to top can sometimes beat a call to delete <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow\">Range.SpecialCells</a> with the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836534.aspx\" rel=\"nofollow\">xlCellTypeBlanks</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 173, "user_id": 2989297, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/628a99d3db020096dd08168e37273c10?s=128&d=identicon&r=PG&f=1", "display_name": "user2989297", "link": "https://stackoverflow.com/users/2989297/user2989297"}, "is_accepted": false, "score": 0, "last_activity_date": 1442353686, "creation_date": 1442353686, "answer_id": 32596240, "question_id": 32595326, "link": "https://stackoverflow.com/questions/32595326/optimizing-vba-command-to-delete-rows-with-blanks/32596240#32596240", "title": "Optimizing VBA command to delete rows with blanks", "body": "<p>Alright, so, basically riding on Jeeped's suggestions that sorting is the best method to do it, I just decided to index the data and sort:</p>\n\n<pre><code>'Insert column for index\nColumns(\"A:A\").Select\nSelection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n\n'Apply index\nRange(\"A1\").Select\nActiveCell.FormulaR1C1 = \"1\"\n\nRange(\"A2\").Select\nActiveCell.FormulaR1C1 = _\n    \"=IF(RC[1]=\"\"\"\",\"\"\"\",R[-1]C+1)\"\n\nRange(\"A3:A\" &amp; Range(\"B\" &amp; Rows.Count).End(xlUp).Row).Formula = \"=IF(RC[1]=\"\"\"\",\"\"\"\",IF(R[-1]C=\"\"\"\",R[-2]C+1,R[-1]C+1))\"\n\n'Sort blanks to bottom\nColumns(\"A:Z\").Select\nActiveWorkbook.Worksheets(\"MasterList\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"MasterList\").Sort.SortFields.Add Key:=Columns( _\n    \"A:A\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Masterlist\").Sort\n    .SetRange Columns(\"A:Z\")\n    .Header = xlGuess\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n\nColumns(\"A\").Select\nSelection.Delete Shift:=xlToLeft\n</code></pre>\n\n<p>Which runs like butter. Leaves the non-true-blank rows at the bottom, which is going to drive up the file size a bit, which is not ideal, but id rather run the macro run fast and take a half Meg penalty in file size than sit here waiting 40 minutes when I want to run a large file.</p>\n"}], "owner": {"reputation": 173, "user_id": 2989297, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/628a99d3db020096dd08168e37273c10?s=128&d=identicon&r=PG&f=1", "display_name": "user2989297", "link": "https://stackoverflow.com/users/2989297/user2989297"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1442364617, "creation_date": 1442350031, "last_edit_date": 1442364617, "question_id": 32595326, "link": "https://stackoverflow.com/questions/32595326/optimizing-vba-command-to-delete-rows-with-blanks", "title": "Optimizing VBA command to delete rows with blanks", "body": "<p>I have a macro where I use the following command to delete all rows where A = blank:</p>\n\n<pre><code>Range(\"A:A\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n</code></pre>\n\n<p>The files that I am running through this macro range from 1kb to 300mb.</p>\n\n<p>Doing some pressure testing, it appears that when the file is below 15mb, the command will execute almost instantaneously, resulting in a 20 second to 6 minute run time for the macro.</p>\n\n<p>The second I plug in a file that is larger than 15mb, the macro will get caught on this command for 30-40 minutes.</p>\n\n<p>Does anyone have a nifty trick to optimize this command for large files? If it takes a fraction of a second for a 13mb file, there must be a way to make it take a fraction of a second for a 15mb file and hopefully make it take a fraction of a second for a 300mb file...</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1442348882, "post_id": 32594878, "comment_id": 53043670, "body": "Type mismatch <i>where</i> ?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1442348973, "post_id": 32594878, "comment_id": 53043723, "body": "You are getting that <code>type mismatch</code> error because <code>getRGB1</code> is returning a string like <code>FFFFFF</code> whereas <code>.RGB</code> is expecting something like <code>RGB(0, 128, 0)</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1442349211, "post_id": 32594878, "comment_id": 53043856, "body": "Please see <a href=\"http://stackoverflow.com/questions/24132665/return-rgb-values-from-range-interior-color-or-any-other-color-property\">This</a> on how to retrieve those values."}, {"owner": {"reputation": 11, "user_id": 5339633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24b0236cf0c20f20d9f20bb3e1a8f574?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Dole", "link": "https://stackoverflow.com/users/5339633/bob-dole"}, "edited": false, "score": 0, "creation_date": 1442349426, "post_id": 32594878, "comment_id": 53043963, "body": "I am now trying it with a value like RGB(0, 128,0) and it is giving me a 400 error the second time I run the line Set mySeries(i) = myChart.SeriesCollection(i)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1442349588, "post_id": 32594878, "comment_id": 53044036, "body": "That could be probably because you do not have that series collection."}, {"owner": {"reputation": 11, "user_id": 5339633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24b0236cf0c20f20d9f20bb3e1a8f574?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Dole", "link": "https://stackoverflow.com/users/5339633/bob-dole"}, "edited": false, "score": 0, "creation_date": 1442350135, "post_id": 32594878, "comment_id": 53044320, "body": "hmm yes So I added this function and the second to last line is highlighted in red? Why  Function getRGB2(rcell) As String     Dim C As Long     Dim R As Long     Dim G As Long     Dim B As Long      C = rcell.Interior.Color     R = C Mod 256     G = C \\ 256 Mod 256     B = C \\ 65536 Mod 256     getRGB2 = &quot;RBG(&quot; &amp; R &amp; &quot;,&quot; &amp; G &amp; &quot;,&quot; &amp; B &quot;)&quot; End Function"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5339633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24b0236cf0c20f20d9f20bb3e1a8f574?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Dole", "link": "https://stackoverflow.com/users/5339633/bob-dole"}, "edited": false, "score": 0, "creation_date": 1442357304, "post_id": 32596834, "comment_id": 53047053, "body": "YEEEEESSSS GOD BLESS YOUR SOUL"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 0, "last_activity_date": 1442356712, "creation_date": 1442356712, "answer_id": 32596834, "question_id": 32594878, "link": "https://stackoverflow.com/questions/32594878/make-bar-graphs-different-colors/32596834#32596834", "title": "Make bar graphs different colors", "body": "<p>Set the color of each cell in range G12:R12</p>\n\n<pre><code>Option Explicit\n\nSub UpdateChart()\n    Dim myChart As Chart\n\n    Set myChart = ActiveSheet.ChartObjects(1)\n    For i = 1 To 10\n        With myChart.SeriesCollection(1)\n            .Points(i).Format.Fill.ForeColor.RGB = Cells(12, i + 6).Interior.Color\n        End With\n    End Sub\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5339633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24b0236cf0c20f20d9f20bb3e1a8f574?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Dole", "link": "https://stackoverflow.com/users/5339633/bob-dole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 1, "accepted_answer_id": 32596834, "answer_count": 1, "score": 0, "last_activity_date": 1442356712, "creation_date": 1442348272, "last_edit_date": 1442351220, "question_id": 32594878, "link": "https://stackoverflow.com/questions/32594878/make-bar-graphs-different-colors", "title": "Make bar graphs different colors", "body": "<p>I have a code to change the colors of my bars in my bar graph but now it gives me a type mismatch. Please help me fix my code.</p>\n\n<pre><code>Sub UpdateChart()\n\nDim myChartObj As ChartObject\nDim myChart As Chart\nDim mySeries(1 To 10) As Series\nDim myChartFormat(1 To 10) As ChartFormat\nDim myFillFormat(1 To 10) As FillFormat\nDim myColorFormat(1 To 10) As ColorFormat\n\nActiveSheet.ChartObjects(1).Activate\n\nSet myChart = ActiveChart\n\nFor i = 1 To 10\n\n    Set mySeries(i) = myChart.SeriesCollection(i)\n    Set myChartFormat(i) = mySeries(i).Format\n    Set myFillFormat(i) = myChartFormat(i).Fill\n    Set myColorFormat(i) = myFillFormat(i).ForeColor\n\n\n     If i = 1 Then\n\n    myColorFormat(i).RGB = getRGB1(Cells(12, 7))\n\n    ElseIf i = 2 Then\n\n     myColorFormat(i).RGB = getRGB1(Cells(12, 7))\n\n    ElseIf i = 3 Then\n\n     myColorFormat(i).RGB = getRGB1(Cells(12, 8))\n\n    ElseIf i = 4 Then\n\n     myColorFormat(i).RGB = getRGB1(Cells(12, 9))\n\n    ElseIf i = 5 Then\n\n     myColorFormat(i).RGB = getRGB1(Cells(12, 10))\n\n    ElseIf i = 6 Then\n\n     myColorFormat(i).RGB = getRGB1(Cells(12, 11))\n\n    ElseIf i = 7 Then\n\n     myColorFormat(i).RGB = getRGB1(Cells(12, 12))\n\n    ElseIf i = 8 Then\n\n     myColorFormat(i).RGB = getRGB1(Cells(12, 13))\n\n    ElseIf i = 9 Then\n\n     myColorFormat(i).RGB = getRGB1(Cells(12, 14))\n\n    ElseIf i = 10 Then\n\n     myColorFormat(i).RGB = getRGB1(Cells(12, 15))\n\n     End If\n\n\n\n\nNext i\n\n\n\nEnd Sub\n\nFunction getRGB1(rcell) As String\n    Dim sColor As String\n\n    sColor = Right(\"000000\" &amp; Hex(rcell.Interior.Color), 6)\n    getRGB1 = Right(sColor, 2) &amp; Mid(sColor, 3, 2) &amp; Left(sColor, 2)\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 2628450, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/97a219197d1a9efe8744f0896a46188e?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/2628450/matt"}, "edited": false, "score": 0, "creation_date": 1442349941, "post_id": 32595134, "comment_id": 53044226, "body": "A excel box poped up with my SQL. Does that mean it is working? If it is how can I put the results in sheet1. thanks for your help"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 101, "user_id": 2628450, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/97a219197d1a9efe8744f0896a46188e?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/2628450/matt"}, "edited": false, "score": 0, "creation_date": 1442411869, "post_id": 32595134, "comment_id": 53072209, "body": "That just gives you an opportunity to check the SQL and make sure it is being input properly - that there are no errors with it. I do not know how to paste SQL results to Excel, you&#39;ll have to research that yourself, sorry!"}], "tags": [], "owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "is_accepted": false, "score": 0, "last_activity_date": 1442349251, "creation_date": 1442349251, "answer_id": 32595134, "question_id": 32594863, "link": "https://stackoverflow.com/questions/32594863/pull-results-into-excel-from-database/32595134#32595134", "title": "Pull results into Excel from database", "body": "<p>Did you verify that strSQL is being entered correctly into your query? Put <code>Msgbox strSQL</code> before <code>With ActiveWorkbook.Connections(1).ODBCConnection</code> and make sure it appears as expected.</p>\n\n<p>Also, all of this:</p>\n\n<pre><code>strSQL = \"\"\nstrSQL = strSQL &amp; \"SELECT tkt.cntry_istto\"\nstrSQL = strSQL &amp; \",tkt.pod\"\n\nstrSQL = strSQL &amp; \" FROM INTGY.GRUIP tkt\"\n\nstrSQL = strSQL &amp; \" Where tky.year_month_nbr between \" &amp; strStDt &amp; \" and \" &amp; strEnDt\n</code></pre>\n\n<p>Can be rewritten as:</p>\n\n<pre><code>strSQL = \"SELECT tkt.cntry_istto,tkt.pod FROM INTGY.GRUIP tkt Where tky.year_month_nbr between \" &amp; strStDt &amp; \" and \" &amp; strEnDt\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1442430555, "creation_date": 1442430555, "answer_id": 32616780, "question_id": 32594863, "link": "https://stackoverflow.com/questions/32594863/pull-results-into-excel-from-database/32616780#32616780", "title": "Pull results into Excel from database", "body": "<p>Use an <a href=\"https://support.microsoft.com/en-us/kb/257819\" rel=\"nofollow\">ADO connection</a> to retrieve a recordset and then use <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839240.aspx\" rel=\"nofollow\">CopyFromRecordset</a> to copy to worksheet range (specifying only the upper left cell).</p>\n\n<p>Also, I am unaware of the database but pay attention to your dates which must be enclosed with either single quotes (for most databases) or if using MS Access enclose with <code>#</code> instead of quotes.</p>\n\n<pre><code>Dim conn As Object \nDim rst As Object\nDim strSQL As String, strStDt As String, strEnDt As String\n\nSet conn = CreateObject(\"ADODB.Connection\") \nSet rst = CreateObject(\"ADODB.Recordset\")\n\nstrStDt = ThisWorkbook.Worksheets(\"lookup\").Range(\"B6\")\nstrEnDt = ThisWorkbook.Worksheets(\"lookup\").Range(\"B5\")\n\nstrSQL = \"SELECT tkt.cntry_istto, tkt.pod\"\nstrSQL = strSQL &amp; \" FROM INTGY.GRUIP tkt\"\nstrSQL = strSQL &amp; \" WHERE tkt.year_month_nbr\"\nstrSQL = strSQL &amp; \" BETWEEN '\" &amp; strStDt &amp; \"' and '\" &amp; strEnDt &amp; \"'\n\nconn.Open \"DSN=#EDXX\"\nrst.Open strSQL, conn\n\nThisWorkbook.Sheets(1).Range(\"A1\").CopyFromRecordest rst\nrst.Close\n\nSet rst = Nothing \nSet conn = Nothing\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 2628450, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/97a219197d1a9efe8744f0896a46188e?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/2628450/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1442430555, "creation_date": 1442348220, "last_edit_date": 1442380132, "question_id": 32594863, "link": "https://stackoverflow.com/questions/32594863/pull-results-into-excel-from-database", "title": "Pull results into Excel from database", "body": "<p>I can't get this code to work. The first time I ran it, it prompted me for my password and the macro completes each time, but it is not pulling the result into <code>sheet1</code>. What can I do here?</p>\n\n<pre><code>Sub Update()\n\n    ThisWorkbook.Sheets(\"sheet1\").Activate\n    ThisWorkbook.Sheets(\"sheet1\").Range(\"A1\").Select\n    Dim strStDt As String\n    Dim strEnDt As String\n    Dim strSQL As String\n\n    strStDt = ThisWorkbook.Worksheets(\"lookup\").Range(\"B6\").Value\n    strEnDt = ThisWorkbook.Worksheets(\"lookup\").Range(\"B5\").Value\n\n    strSQL = \"\"\n    strSQL = strSQL &amp; \"SELECT tkt.cntry_istto\"\n    strSQL = strSQL &amp; \",tkt.pod\"\n\n    strSQL = strSQL &amp; \" FROM INTGY.GRUIP tkt\"\n\n    strSQL = strSQL &amp; \" Where tky.year_month_nbr between \" &amp; strStDt &amp; \" and \" &amp; strEnDt\n\n\n    ThisWorkbook.Sheets(\"sheet1\").Activate\n    ThisWorkbook.Sheets(\"sheet1\").Range(\"A1\").Select\n\n    With ActiveWorkbook.Connections(1).ODBCConnection\n\n        .BackgroundQuery = True\n        .Connection = \"ODBC;DSN=#EDXX;UID=;;DATABASE=INTGY; AUTHENTICATION=;\"\n        .CommandText = strSQL\n        .RefreshOnFileOpen = False\n        .SavePassword = False\n        .SourceConnectionFile = \"\"\n        .SourceDataFile = \"\"\n        .ServerCredentialsMethod = xlCredentialsMethodIntegrated\n        .AlwaysUseConnectionFile = False\n        .Refresh\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "charts"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5339578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/193fad7d6d03d7cc9ecdf1fa86d9c1e8?s=128&d=identicon&r=PG&f=1", "display_name": "gerikov", "link": "https://stackoverflow.com/users/5339578/gerikov"}, "is_accepted": false, "score": 0, "last_activity_date": 1442349081, "creation_date": 1442349081, "answer_id": 32595082, "question_id": 32594639, "link": "https://stackoverflow.com/questions/32594639/creating-a-specific-chart/32595082#32595082", "title": "Creating a specific chart", "body": "<p>I can solve it finally :) \nHere is my code, maybe it can help for anyone else.</p>\n\n<pre><code>Dim sourcech As Chart\nSet sourcech = Charts.Add\nSet sourcech = sourcech.Location(Where:=xlLocationAsObject, name:=\"Details\")\n\nWith sourcech\n    .SetSourceData Source:=Sheets(\"Details\").Range(\"l2:L9\")\n    .SeriesCollection(1).XValues = Sheets(\"Details\").Range(\"I2:J9\") 'here you can modify the X axes\n\nEnd With  \n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5339578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/193fad7d6d03d7cc9ecdf1fa86d9c1e8?s=128&d=identicon&r=PG&f=1", "display_name": "gerikov", "link": "https://stackoverflow.com/users/5339578/gerikov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1442385668, "creation_date": 1442347322, "last_edit_date": 1442385668, "question_id": 32594639, "link": "https://stackoverflow.com/questions/32594639/creating-a-specific-chart", "title": "Creating a specific chart", "body": "<p>I would like to create a chart like this: <a href=\"http://take.ms/BEie1\" rel=\"nofollow noreferrer\">http://take.ms/BEie1</a>. </p>\n\n<p><a href=\"https://i.stack.imgur.com/wfH39.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wfH39.png\" alt=\"enter image description here\"></a></p>\n\n<p>The first two columns are the name and serial number. </p>\n\n<p>I have to put these two on the X axis as in the images, and the Y axis is for the percentage usage.  </p>\n\n<p>Here is my latest attempt:  </p>\n\n<pre><code>Dim xRange As Range\nDim yRange As Range\nDim objCht As ChartObject\n\nSet objCht = detailsh.ChartObjects.Add(Left:=detailsh.Columns(\"A\").Left, Width:=350, Top:=detailsh.Rows(9).Top, Height:=210)\nSet xRange = Range(\"I2:J9\")\nSet xRange = Range(\"L2:L9\")\n\nWith objCht.Chart\n    Set srs = .SeriesCollection.NewSeries\n    With srs\n        .name = detailsh.Range(\"B1\")\n        .Values = detailsh.Range(\"I2:I7\")\n        .XValues = detailsh.Range(\"L2:L7\")\n    End With\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1442347480, "post_id": 32594622, "comment_id": 53042944, "body": "Combine it with <code>mid()</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1442348462, "post_id": 32594622, "comment_id": 53043459, "body": "I am curious as to why VBA? You can achieve these using Excel formulas..."}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 3202298, "user_type": "registered", "profile_image": "https://graph.facebook.com/745312443/picture?type=large", "display_name": "FoxInCloud", "link": "https://stackoverflow.com/users/3202298/foxincloud"}, "is_accepted": true, "score": 3, "last_activity_date": 1442347596, "creation_date": 1442347596, "answer_id": 32594704, "question_id": 32594622, "link": "https://stackoverflow.com/questions/32594622/how-to-remove-specific-text-from-a-cell/32594704#32594704", "title": "How to remove specific text from a cell", "body": "<p>What about</p>\n\n<pre><code>Cells(x, 1).Value = Replace(Cells(x, 1).Value, \"Assistant to the \", \"\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 1, "last_activity_date": 1442348375, "creation_date": 1442348375, "answer_id": 32594909, "question_id": 32594622, "link": "https://stackoverflow.com/questions/32594622/how-to-remove-specific-text-from-a-cell/32594909#32594909", "title": "How to remove specific text from a cell", "body": "<p>There are various ways to achieve what you want</p>\n\n<ol>\n<li><code>Replace</code>: FoxInCloud has already covered that. <strong>&lt;==This is the easiest</strong>.</li>\n<li><p><code>Split</code>: </p>\n\n<pre><code>Debug.Print Split(Cells(x, 1).Value,\"Assistant to the \")(1)\n</code></pre></li>\n<li><p><code>Mid/Len</code>: </p>\n\n<pre><code>Debug.Print Mid(Cells(x, 1).Value, Len(\"Assistant to the \") + 1, _\nLen(Cells(x, 1).Value) - Len(\"Assistant to the \"))\n</code></pre></li>\n<li><p><code>Right/Len</code>: </p>\n\n<pre><code>Debug.Print Right(Cells(x, 1).Value, Len(\"Assistant to the \"))\n</code></pre></li>\n</ol>\n\n<p>I would highly recommend that you spend some time studying how these functions work to get a better idea.</p>\n"}], "owner": {"reputation": 347, "user_id": 4777929, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ddf40c38cf4432bb8098cf8a7d269c41?s=128&d=identicon&r=PG&f=1", "display_name": "xxxRxxx", "link": "https://stackoverflow.com/users/4777929/xxxrxxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 515, "favorite_count": 0, "accepted_answer_id": 32594704, "answer_count": 2, "score": 0, "last_activity_date": 1442351969, "creation_date": 1442347257, "last_edit_date": 1531161705, "question_id": 32594622, "link": "https://stackoverflow.com/questions/32594622/how-to-remove-specific-text-from-a-cell", "title": "How to remove specific text from a cell", "body": "<p>So for example, in cell A1 I might have \"Assistant to the Regional Manager.\" My original idea was to use Instr like this:</p>\n\n<pre><code>If InStr(1, Cells(x, 1).Value, \"Assistant\") &gt; 0 Then\n        Cells(x, 1).Value = Cells(x, 1).Value - \"Assistant to the \"\n</code></pre>\n\n<p>so that only \"Regional Manager\" remains, but this does not work. Is there a way to remove \"Assistant to the \"?</p>\n"}, {"tags": ["vba", "email", "ms-access", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": false, "score": 1, "last_activity_date": 1442421034, "creation_date": 1442421034, "answer_id": 32614033, "question_id": 32594339, "link": "https://stackoverflow.com/questions/32594339/create-a-dynamic-outlook-email-using-access-vba/32614033#32614033", "title": "Create a Dynamic Outlook Email using Access VBA", "body": "<p>you should code in MS Access.\na pseudo code would be:</p>\n\n<ol>\n<li>Read all values from your access table</li>\n<li>create outlook object, mail object</li>\n<li>Open outlook mail and add subject, content, attachments</li>\n<li>send or leave it to the employee to send</li>\n</ol>\n\n<p>call this like</p>\n\n<pre><code>send_email_message \"to@to.to\",\"\",\"\",\"Email subject\",\"Add your email content/body like project id= &amp;field1, project name = field2 and so on\"\n</code></pre>\n\n<p>you can attach more than one file just join the document name with a \";\" delimiter. like</p>\n\n<p>\"C;\\file1.txt;c:\\File2.txt\"</p>\n\n<p>here a sending email function:\nthis function uses outlook objects (import them in reference)\nor change it to late binding by vba.createobject(\"outlook.application\")</p>\n\n<pre><code>Function SEND_EMAIL_MESSAGE(mTo As String, mCC As String, mBC As String, mSubject As String, mBody As String, Optional useOwnSignature As Boolean = False, Optional DisplayMsg As Boolean = False, Optional isHTML As Boolean = False, Optional AttachmentPath = \"\") As Boolean\n'---------------------------------------------------------------------------------------\n' Procedure : SEND_EMAIL_MESSAGE\n' Author    : KRISH KM\n' Date      : 01/09/2013\n' Purpose   : Send emails using outlook\n'---------------------------------------------------------------------------------------\n'\n' Please check the reference for Microsoft Outlook 14.0 object library for outlook 2010.\n\n    Dim oAPP As Outlook.Application\n    Dim oMail As Outlook.MailItem\n    Dim oAPPAttach As Outlook.Attachment\n    Dim mSignature As String\n\n    On Error GoTo ERROR_EMAIL\n    ' Create the Outlook session.\n    Set oAPP = New Outlook.Application\n\n    ' Create the message.\n    Set oMail = oAPP.CreateItem(olMailItem)\n\n    With oMail\n        ' Add the To recipient(s) to the message.\n        .to = mTo\n        .cc = mCC\n        .BCC = mBC\n        .Subject = mSubject\n\n        If useOwnSignature Then .BodyFormat = olFormatHTML\n        .Display\n\n        If useOwnSignature Then\n            If isHTML Then\n\n                mSignature = .HTMLBody\n                .HTMLBody = mBody &amp; mSignature\n            Else\n                mSignature = .body\n                .body = mBody &amp; mSignature\n            End If\n        Else\n            .body = mBody\n        End If\n\n        ' Add attachments to the message.\n        If Not IsMissing(AttachmentPath) Then\n            Dim mFiles() As String\n            If (VBA.Right(AttachmentPath, 1)) &lt;&gt; \";\" Then AttachmentPath = AttachmentPath &amp; \";\"\n            mFiles = VBA.Split(AttachmentPath, \";\")\n            Dim i As Integer\n            For i = 0 To UBound(mFiles) - 1\n                If Not mFiles(i) = \"\" Then .Attachments.Add (mFiles(i)) 'Set oAPPAttach = .Attachments.Add(mFiles(i))\n            Next i\n\n        End If\n\n        ' Should we display the message before sending?\n        If DisplayMsg Then\n            .Display\n        Else\n            .Send\n        End If\n    End With\n\n    SEND_EMAIL_MESSAGE = True\nEXIT_ROUTINE:\n    On Error GoTo 0\n    Set oAPP = Nothing\n    Set oMail = Nothing\n    Exit Function\n\nERROR_EMAIL:\n    SEND_EMAIL_MESSAGE = False\n    GoTo EXIT_ROUTINE\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5339527, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TkS0pYTF19E/AAAAAAAAAAI/AAAAAAAAA0s/d8gSOYJIv9w/photo.jpg?sz=128", "display_name": "Liz Adkins", "link": "https://stackoverflow.com/users/5339527/liz-adkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1795, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1593517231, "creation_date": 1442346203, "last_edit_date": 1593517231, "question_id": 32594339, "link": "https://stackoverflow.com/questions/32594339/create-a-dynamic-outlook-email-using-access-vba", "title": "Create a Dynamic Outlook Email using Access VBA", "body": "<p>Here is my current setup...</p>\n\n<p>I have an Access project tracking database with project description values (example: Project_ID) and I have a button \"Create Email\" which I've successfully gotten to open Outlook, pick an Outlook draft, and automatically generate the appropriate subject line.</p>\n\n<p>However, I have no clue where to start on this next step. Any help is appreciated!</p>\n\n<p>I would like the Outlook email to have dynamic fields that are linked to the fields in my Access database. I'm not even sure if I should be trying to code in Access or in Outlook for this step!</p>\n\n<p>Example of what I want:</p>\n\n<blockquote>\n  <p>NAME,</p>\n  \n  <p>Attached are your documents for:</p>\n  \n  <p>Project_ID  Project_Name   Project_Type &lt;--Values from my Access\n  database</p>\n  \n  <p>Sincerely,</p>\n  \n  <p>my signature</p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1442345944, "post_id": 32594209, "comment_id": 53042139, "body": "You are getting that error because you have not declared the <code>ws</code> object"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1442345996, "post_id": 32594209, "comment_id": 53042176, "body": "<code>How do I get the valuefromcellN2? to actually show the value, not text?</code> Use this <code>.ChartTitle.Characters.Text = Range(&quot;N2&quot;).Value</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1442346090, "post_id": 32594209, "comment_id": 53042227, "body": "Let me post a proper reply.. gimme few mins."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1442346333, "post_id": 32594209, "comment_id": 53042369, "body": "&quot;tend to just go with stuff that works even if I don&#39;t understand it&quot; That&#39;s a really bad idea. I can easily post an answer below that erases all files on your C:\\ drive XD"}, {"owner": {"reputation": 13, "user_id": 5339500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e31addf313a3e1cf1c0f39c01430298?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/5339500/sam"}, "edited": false, "score": 1, "creation_date": 1442346445, "post_id": 32594209, "comment_id": 53042437, "body": "findwindow you are right, and that is one of the reasons why I am trying to find the reason behind each of my questions."}, {"owner": {"reputation": 13, "user_id": 5339500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e31addf313a3e1cf1c0f39c01430298?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/5339500/sam"}, "edited": false, "score": 0, "creation_date": 1442346495, "post_id": 32594209, "comment_id": 53042461, "body": "Also, although I said I just go with stuff that works, I can still work out if it&#39;s in the right &#39;general&#39; direction - I hope!"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5339500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e31addf313a3e1cf1c0f39c01430298?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/5339500/sam"}, "edited": false, "score": 0, "creation_date": 1442347510, "post_id": 32594584, "comment_id": 53042959, "body": "Thanks so much Siddharth Rout - your solution certainly looks more elegant!"}, {"owner": {"reputation": 13, "user_id": 5339500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e31addf313a3e1cf1c0f39c01430298?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/5339500/sam"}, "edited": false, "score": 0, "creation_date": 1442347633, "post_id": 32594584, "comment_id": 53043033, "body": "I think that I may have miscommunicated my intentions - I intend to produce various charts, each with only one series on. The code I updated the main post with does this now thanks to your help! I will try to accommodate the LRow idea in - thanks again!"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 13, "user_id": 5339500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e31addf313a3e1cf1c0f39c01430298?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/5339500/sam"}, "edited": false, "score": 0, "creation_date": 1442347692, "post_id": 32594584, "comment_id": 53043067, "body": "In that case move the for loop before the <code>Set chrt = .Shapes.AddChart.Chart</code> line ;)"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 0, "last_activity_date": 1442347104, "last_edit_date": 1495541653, "creation_date": 1442347104, "answer_id": 32594584, "question_id": 32594209, "link": "https://stackoverflow.com/questions/32594209/424-code-and-graph-creation-in-vba/32594584#32594584", "title": "424 code and graph creation in vba", "body": "<blockquote>\n  <p>Q1 Am I going about this in roughly the right way?</p>\n</blockquote>\n\n<p>Yes you are. You need to just iron out few issues.</p>\n\n<blockquote>\n  <p>Q2 What have I missed out to cause this runtime error?</p>\n</blockquote>\n\n<p>You are getting that error because you have not declared the <code>ws</code> object. I have explained it later in the code below on how to go about it.</p>\n\n<blockquote>\n  <p>Q3 How do I get the valuefromcellN2? to actually show the value, not text?</p>\n</blockquote>\n\n<p>To get the value from a particular cell, you can say <code>Range(\"A1\").Value</code> so in your case it will be <code>Range(\"N2\").Value</code></p>\n\n<p><strong>Few other things</strong></p>\n\n<ol>\n<li><p>When working with Excel rows, avoid the use of <code>Integer</code>. Use <code>Long</code>. Post Excel 2007, the number of rows have increased and the <code>Integer</code> may not be able to accommodate bigger values.</p></li>\n<li><p>Avoid using hard coded values like <code>65536</code>. See <a href=\"https://stackoverflow.com/questions/11169445/error-finding-last-used-cell-in-vba\">This</a> on how to find the last row.</p></li>\n</ol>\n\n<p><strong>Code</strong></p>\n\n<p>I have commented the code so you shouldn't have a problem understanding it. But if you do then simply ask.</p>\n\n<p>Is this what you are trying (<strong>Untested</strong>)?</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim ws As Worksheet\n    Dim i As Long, LRow As Long\n    Dim chrt As Chart  \n\n    '~~&gt; This is where we will have the chart\n    '~~&gt; We declare the object here. Change as applicable\n    Set ws = ThisWorkbook.Sheets(\"Sheet2\")\n\n    With ws\n        '~~. Find the last row in Col A\n        LRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n        '~~&gt; Add Chart\n        Set chrt = .Shapes.AddChart.Chart\n\n        With chrt '&lt;~~ Work with chart and set it's parameters\n            .ChartType = xlXYScatter\n            .HasTitle = True\n            .ChartTitle.Characters.Text = ws.Range(\"N2\").Value '&lt;~~ Set the Value here\n            .Axes(xlCategory, xlPrimary).HasTitle = True\n            .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"Timeline\"\n            .Axes(xlValue, xlPrimary).HasTitle = True\n            .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"Grade\"\n            .Axes(xlCategory).HasMajorGridlines = True\n\n            'Formatting\n            .Axes(xlCategory).HasMinorGridlines = False\n            .Axes(xlValue).HasMajorGridlines = True\n            .Axes(xlValue).HasMinorGridlines = False\n            .HasLegend = False\n\n            n = 1\n\n            '~~&gt; Add series and set it\n            For i = 2 To LRow\n                .SeriesCollection.NewSeries\n                .SeriesCollection(n).Name = \"Progress\"\n                .SeriesCollection(n).XValues = \"=Sheet2!$B$1:$J$1\"\n                .SeriesCollection(n).Values = \"=Sheet2!$B$\" &amp; i &amp; \":$J$\" &amp; i\n                n = n + 1\n            Next i\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5339500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e31addf313a3e1cf1c0f39c01430298?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/5339500/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 32594584, "answer_count": 1, "score": 1, "last_activity_date": 1442347325, "creation_date": 1442345704, "last_edit_date": 1442347325, "question_id": 32594209, "link": "https://stackoverflow.com/questions/32594209/424-code-and-graph-creation-in-vba", "title": "424 code and graph creation in vba", "body": "<p>I'm relatively new to VBA - tend to just go with stuff that works even if I don't understand it I'm afraid!</p>\n\n<p>I'm trying to produce individual scatter graphs for each row of data from a worksheet. I'm OK with configuring the graph etc, but getting it to read each row and iterate properly is beyond me!</p>\n\n<p>This is what I've got currently:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nActiveWorkbook.Charts.Add\nDim i As Integer\nFor i = 2 To WS.Range(\"A65536\").End(xlUp).Row\nWith ActiveWorkbook.ActiveChart\n    'Data?\n    .ChartType = xlXYScatter\n    .SeriesCollection.NewSeries\n    .SeriesCollection(1).Name = \"Progress\"\n    .SeriesCollection(1).XValues = \"=Sheet2!$B$1:$J$1\"\n    .SeriesCollection(1).Values = \"=Sheet2!$B$\" &amp; i &amp; \":$J$\" &amp; i\n\n    'Titles\n    .HasTitle = True\n    .ChartTitle.Characters.Text = \"valuefromcellN2?\"\n    .Axes(xlCategory, xlPrimary).HasTitle = True\n    .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"Timeline\"\n    .Axes(xlValue, xlPrimary).HasTitle = True\n    .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"Grade\"\n    .Axes(xlCategory).HasMajorGridlines = True\n\n    'Formatting\n    .Axes(xlCategory).HasMinorGridlines = False\n    .Axes(xlValue).HasMajorGridlines = True\n    .Axes(xlValue).HasMinorGridlines = False\n    .HasLegend = False\n\nEnd With\nNext\nEnd Sub\n</code></pre>\n\n<p>When I run this, I get a runtime error 424 - object required. My questions are:</p>\n\n<ol>\n<li>Am I going about this in roughly the right way?</li>\n<li>What have I missed out to cause this runtime error?</li>\n<li>How do I get the <strong>valuefromcellN2?</strong> to actually show the value, not text?</li>\n</ol>\n\n<p>Thanks for any help!</p>\n\n<p>Sam</p>\n\n<p>EDIT:</p>\n\n<p>thanks for the help - I think I've updated it correctly now (it works with all titles and creates new graphs!)</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nActiveWorkbook.Charts.Add\nDim ws As Worksheet\nSet ws = tracker\nDim i As Long\nFor i = 2 To ws.Range(\"A65536\").End(xlUp).Row\nCharts.Add\nWith ActiveWorkbook.ActiveChart\n    'Data?\n    .ChartType = xlXYScatter\n    .SeriesCollection.NewSeries\n    .SeriesCollection(1).Name = \"Progress\"\n    .SeriesCollection(1).XValues = \"=tracker!$B$1:$J$1\"\n    .SeriesCollection(1).Values = \"=tracker!$B$\" &amp; i &amp; \":$J$\" &amp; i\n\n    'Titles\n    .HasTitle = True\n    .ChartTitle.Characters.Text = Range(\"N\" &amp; i).Value\n    .Axes(xlCategory, xlPrimary).HasTitle = True\n    .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"Timeline\"\n    .Axes(xlValue, xlPrimary).HasTitle = True\n    .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"Grade\"\n    .Axes(xlCategory).HasMajorGridlines = True\n\n    'Formatting\n    .Axes(xlCategory).HasMinorGridlines = False\n    .Axes(xlValue).HasMajorGridlines = True\n    .Axes(xlValue).HasMinorGridlines = False\n    .HasLegend = False\n\nEnd With\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "sorting"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1442344826, "post_id": 32593566, "comment_id": 53041543, "body": "You could create a custom list based on sheet one, sort sheet two left to right and then delete the custom list you just created.  Along the same lines as <a href=\"http://stackoverflow.com/questions/6100944/code-an-excel-vba-sort-with-a-custom-order-and-a-value-containing-commas\">this</a>"}, {"owner": {"reputation": 291, "user_id": 2337922, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5075f986b54602d68419acf1fc22ddd9?s=128&d=identicon&r=PG", "display_name": "Singularity20XX", "link": "https://stackoverflow.com/users/2337922/singularity20xx"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1442345115, "post_id": 32593566, "comment_id": 53041699, "body": "When you create a custom list, the list remains static. The values on sheet1, unfortunately, constantly change,"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1442345343, "post_id": 32593566, "comment_id": 53041816, "body": "Each time you run the code it will look to sheet one and create a new custom list based on whats there.  Then when you have sorted sheet two it gets deleted.  load everything into an array, pass that array into the custom list.  It will change each time it is run."}, {"owner": {"reputation": 291, "user_id": 2337922, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5075f986b54602d68419acf1fc22ddd9?s=128&d=identicon&r=PG", "display_name": "Singularity20XX", "link": "https://stackoverflow.com/users/2337922/singularity20xx"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1442348162, "post_id": 32593566, "comment_id": 53043303, "body": "I see that the custom list changes. However I tried every variation of custom sort on sheet2"}], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1442348961, "creation_date": 1442348961, "answer_id": 32595056, "question_id": 32593566, "link": "https://stackoverflow.com/questions/32593566/sorting-a-collection-of-columns-based-on-a-range/32595056#32595056", "title": "Sorting a collection of columns based on a range", "body": "<p>Can be achieved without VBA if a row is added to the top of the second sheet with a formula such as:  </p>\n\n<pre><code>=MATCH(B2,Sheet1!$A:$A,0)  \n</code></pre>\n\n<p>in B1 copied across to suit and then ColumnsB onwards sorted on Row1.</p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1442350986, "last_edit_date": 1442350986, "creation_date": 1442350234, "answer_id": 32595368, "question_id": 32593566, "link": "https://stackoverflow.com/questions/32593566/sorting-a-collection-of-columns-based-on-a-range/32595368#32595368", "title": "Sorting a collection of columns based on a range", "body": "<p>As discussed in the comments of the OP.</p>\n\n<p>First create a custom list based on the contents on sheet1 (I will put them all together):</p>\n\n<pre><code>Dim cstListArr() As Variant\ncstListArr = wst1.Range(Range(\"A1\"), Range(\"A1\").End(xlDown))\nApplication.AddCustomList ListArray:=cstListArr\n</code></pre>\n\n<p>then sort left to right</p>\n\n<pre><code>Set srtRng = wst2.Range(Range(\"B1\"), Range(\"B1\").End(xlDown).End(xlToRight))\n\nwst2.Sort.SortFields.Clear\nsrtRng.Sort Key1:=wst2.Range(\"B1:JS1\"), Order1:=xlAscending, Header:=xlGuess, _\nOrderCustom:=Application.CustomListCount + 1, MatchCase:=False, _\nOrientation:=xlLeftToRight, DataOption1:=xlSortNormal\n</code></pre>\n\n<p>then get rid of the custom sort just created.</p>\n\n<pre><code>Application.DeleteCustomList Application.CustomListCount\n</code></pre>\n\n<p>So all together:</p>\n\n<pre><code>Dim wst1 As Worksheet\nDim wst2 As Worksheet\nSet wst1 = ActiveWorkbook.Worksheets(\"Sheet1\")\nSet wst2 = ActiveWorkbook.Worksheets(\"Sheet2\")\nDim srtRng As Range\n\nwst1.Activate\nDim cstListArr() As Variant\ncstListArr = wst1.Range(Range(\"A1\"), Range(\"A1\").End(xlDown))\nApplication.AddCustomList ListArray:=cstListArr\n\nwst2.Activate\nSet srtRng = wst2.Range(Range(\"B1\"), Range(\"B1\").End(xlDown).End(xlToRight))\n\nwst2.Sort.SortFields.Clear\nsrtRng.Sort Key1:=wst2.Range(\"B1:JS1\"), Order1:=xlAscending, Header:=xlGuess, _\n    OrderCustom:=Application.CustomListCount + 1, MatchCase:=False, _\n    Orientation:=xlLeftToRight, DataOption1:=xlSortNormal\n\n\nApplication.DeleteCustomList Application.CustomListCount\n</code></pre>\n"}], "owner": {"reputation": 291, "user_id": 2337922, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5075f986b54602d68419acf1fc22ddd9?s=128&d=identicon&r=PG", "display_name": "Singularity20XX", "link": "https://stackoverflow.com/users/2337922/singularity20xx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1443075431, "creation_date": 1442343399, "last_edit_date": 1443075431, "question_id": 32593566, "link": "https://stackoverflow.com/questions/32593566/sorting-a-collection-of-columns-based-on-a-range", "title": "Sorting a collection of columns based on a range", "body": "<p>I have scoured Google and the Stack for examples of what I am trying to do, while I have found some examples the perform part of what I am trying to do, I am having trouble accomplishing the desired result. I have included the below code which seems to look like it will do what I want to accomplish. Unfortunately I get a \"Subscript out of range\" which I assume has to do with my syntax. </p>\n\n<p>Per the screenshots included I am trying to sort the columns found on \"Sheet2\" by the order of the values found in Column A on \"Sheet1\". Conceptually, </p>\n\n<p>I figure the best route would be to assign the values in sheet1 to an array, the columns in sheet2 to an array and then order array2 according to the array1.</p>\n\n<p>Any thoughts on how to accomplish this? Any help is appreciated:</p>\n\n<pre><code>Public Sub sortColumn()\nDim rng As Range\nDim i As Integer\nDim J As Integer\nDim Temp\nDim nams As Variant\nDim F\nDim Dex As Integer\nDim Arr As Variant\n\n\nnams = Array(Worksheets(\"Sheet1\").Range(\"A1:A350\").Value2)\n\nSet rng = Worksheets(\"Sheet2\").Range(\"B1:JS1\")\nFor i = 1 To rng.Columns.Count\n    For J = i To rng.Columns.Count\n        For F = 0 To UBound(nams)\n            If nams(F) = rng(J) Then Dex = F: Exit For\n        Next F\n        If F &lt; i Then\n            Temp = rng.Columns(i).value\n            rng(i).Resize(rng.Rows.Count) = rng.Columns(J).value\n            rng(J).Resize(rng.Rows.Count) = Temp\n        End If\n    Next J\nNext i\n\n\nEnd Sub\n</code></pre>\n\n<p>Above code, as stated above, results in a \"Sub script out of range\". I have checked by range names and they are valid. Below graphics show what I am working with:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2lSCH.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2lSCH.gif\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/2NwNS.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2NwNS.gif\" alt=\"enter image description here\"></a></p>\n"}]