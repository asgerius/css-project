[{"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1527116238, "post_id": 50498457, "comment_id": 88009990, "body": "You activate one worksheet then immediately activate another. Please read and heed <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1527116557, "post_id": 50498457, "comment_id": 88010063, "body": "Is this the same you&#39;re trying todo: ElAr = rEleAn ? and you&#39;re Redim makes your array 1 row and column to big"}, {"owner": {"reputation": 17, "user_id": 7989152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eeb2fe5a81394e101ca8133d4e4cae2?s=128&d=identicon&r=PG&f=1", "display_name": "webfootedoldman", "link": "https://stackoverflow.com/users/7989152/webfootedoldman"}, "edited": false, "score": 0, "creation_date": 1527138113, "post_id": 50498457, "comment_id": 88014960, "body": "@Jeeped Pretty sure I&#39;m activating a Workbooks(SheetName) - the SheetName variable is from a form - and then Worksheets(&quot;Report&quot;). But I&#39;ll look into avoiding Select, thanks."}, {"owner": {"reputation": 17, "user_id": 7989152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eeb2fe5a81394e101ca8133d4e4cae2?s=128&d=identicon&r=PG&f=1", "display_name": "webfootedoldman", "link": "https://stackoverflow.com/users/7989152/webfootedoldman"}, "reply_to_user": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1527138175, "post_id": 50498457, "comment_id": 88014975, "body": "@EvR Yes that&#39;s what I&#39;m going for. I&#39;ll give EleList and ColList a minus one on the count in the morning when I get to work and see if that solves it. Thanks."}, {"owner": {"reputation": 17, "user_id": 7989152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eeb2fe5a81394e101ca8133d4e4cae2?s=128&d=identicon&r=PG&f=1", "display_name": "webfootedoldman", "link": "https://stackoverflow.com/users/7989152/webfootedoldman"}, "edited": false, "score": 0, "creation_date": 1527187416, "post_id": 50498457, "comment_id": 88044766, "body": "@Jeeped, changed SheetName variable to FlNm to avoid confusion. GOing with EvR&#39;s suggestion to avoid select. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 7989152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eeb2fe5a81394e101ca8133d4e4cae2?s=128&d=identicon&r=PG&f=1", "display_name": "webfootedoldman", "link": "https://stackoverflow.com/users/7989152/webfootedoldman"}, "edited": false, "score": 0, "creation_date": 1527179941, "post_id": 50503685, "comment_id": 88040980, "body": "I had tried something similar to that earlier, though it was a bit more long winded. I tried almost exactly what you wrote - I had to change <code>Sheet1</code> to <code>Report</code> since I have no control over the name of the worksheet that I am getting data from. Unfortunately this still doesn&#39;t capture the data for the array. I have no variables in my local window. I added <code>EleList = rEleAn.Rows.Count - 1</code> and <code>ColList = rEleAn.Columns.Count - 1</code> per your earlier statement that the size of the range was incorrect. This did not work. I also kept the -1 to the count and changed <code>Value</code> to <code>Value2</code>. No go."}, {"owner": {"reputation": 17, "user_id": 7989152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eeb2fe5a81394e101ca8133d4e4cae2?s=128&d=identicon&r=PG&f=1", "display_name": "webfootedoldman", "link": "https://stackoverflow.com/users/7989152/webfootedoldman"}, "edited": false, "score": 0, "creation_date": 1527186408, "post_id": 50503685, "comment_id": 88044299, "body": "Nvm, I&#39;ve solved it. <code>ElAr(EleLst, ColLst) = Range(frst).Offset(EleLst, ColLst).Value</code> needed to be <code>ElAr(EleLst, ColLst = frst.Offset(EleLst, ColLst).Value</code>. The Runtime Error 1004 was cropping up because the <code>Range(frst)</code> was looking for a named range in the worksheet, not as a VBA defined variable range."}, {"owner": {"reputation": 17, "user_id": 7989152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eeb2fe5a81394e101ca8133d4e4cae2?s=128&d=identicon&r=PG&f=1", "display_name": "webfootedoldman", "link": "https://stackoverflow.com/users/7989152/webfootedoldman"}, "edited": false, "score": 0, "creation_date": 1527187348, "post_id": 50503685, "comment_id": 88044734, "body": "And I just realized that yours works, too. @EvR. I was looking for variable information in the locals window instead of trying to print to a sheet. Marking as solved. Thanks for your help."}], "tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": true, "score": 0, "last_activity_date": 1527233571, "last_edit_date": 1527233571, "creation_date": 1527147661, "answer_id": 50503685, "question_id": 50498457, "link": "https://stackoverflow.com/questions/50498457/transferring-range-to-dynamic-array-gives-runtime-error-1004/50503685#50503685", "title": "Transferring range to dynamic array gives Runtime Error 1004", "body": "<p>If I understand your comment correctly, try:   </p>\n\n<pre><code>Sub GetElemArray()\n\n            Dim fndrng As Range\n            Dim rEleAn As Range\n            Dim frst As Range\n\n            'the rest of the variables below are global\n            Set fndrng = Worksheets(\"Report\").Columns(2).Find(\"Analyte\")\n            Set frst = fndrng.Offset(1, 0)\n            Set rEleAn = Range(frst, fndrng.End(xlDown).End(xlToRight))\n            ElAr = rEleAn\n\n        'Code to Do Other Stuff\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7989152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eeb2fe5a81394e101ca8133d4e4cae2?s=128&d=identicon&r=PG&f=1", "display_name": "webfootedoldman", "link": "https://stackoverflow.com/users/7989152/webfootedoldman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 50503685, "answer_count": 1, "score": 0, "last_activity_date": 1530909397, "creation_date": 1527115196, "last_edit_date": 1531164843, "question_id": 50498457, "link": "https://stackoverflow.com/questions/50498457/transferring-range-to-dynamic-array-gives-runtime-error-1004", "title": "Transferring range to dynamic array gives Runtime Error 1004", "body": "<p>Attempting to copy a range from one workbook to another - there will be other tasks performed on the data set in the process but this is the gist of what I want for now. The range in the source workbook is not static; meaning each time a report is generated, the necessary information will appear in the same columns but not the same rows. There is one blank column in the middle of the range and several columns I will be ignoring - along with some calculations/converting of data. To try and help with the somewhat unpredictable nature of the location of the data in the source workbook, I've named my range as a variable in the sub - I'm not sure if that is the problem. Everything seems to be working out, except when I go to put the range in the array. Here's what I've got:</p>\n\n<pre><code>    Sub GetElemArray()\n\n        Dim fndrng As Range\n        Dim rEleAn As Range\n        Dim frst As Range\n\n        'the rest of the variables below are global\n\n        Workbooks(SheetName).Activate\n        Worksheets(\"Report\").Activate\n        Columns(2).Select\n\n        Set fndrng = Selection.Find(\"Analyte\")\n        Set frst = fndrng.Offset(1, 0)\n        Set rEleAn = Range(frst, fndrng.End(xlDown).End(xlToRight))\n\n        EleList = rEleAn.Rows.Count\n        ColList = rEleAn.Columns.Count\n        ReDim ElAr(0 To EleList, 0 To ColList)\n\n        For EleList = LBound(ElAR, 1) To UBound(ElAr, 1)\n            For ColList = LBound(ElAr, 2) To UBound(ElAr, 2)\n\n                'The following line returns the Runtime 1004 error\n                ElAr(EleList, ColList) = Range(frst).Offset(EleList, _ \n                  ColList).Value\n            Next ColList\n        Next EleList\n\n    Code to Do Other Stuff\n    End Sub\n</code></pre>\n\n<p>Looking through the Locals Window, I can see that <code>rEleAn</code> stores its values as <code>.Value2</code>. I tried changing the Range to this property and it still returned the same error. Looking in the Locals Window, everything is assigned properly near as I can tell.</p>\n\n<p>Any ideas as to what is happening?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1527118836, "post_id": 50498435, "comment_id": 88010660, "body": "Are you filtering a table or range?"}, {"owner": {"reputation": 87, "user_id": 9494250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cc9d89159bcb0796ac3d917069d025?s=128&d=identicon&r=PG&f=1", "display_name": "Majid", "link": "https://stackoverflow.com/users/9494250/majid"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1527120048, "post_id": 50498435, "comment_id": 88010922, "body": "Table, the other columns were ignored. The filter is being applied on the first row."}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 9494250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cc9d89159bcb0796ac3d917069d025?s=128&d=identicon&r=PG&f=1", "display_name": "Majid", "link": "https://stackoverflow.com/users/9494250/majid"}, "edited": false, "score": 0, "creation_date": 1527116906, "post_id": 50498504, "comment_id": 88010152, "body": "filters correctly to between, but does not take the dates. My date is in the format mm/dd/yyyy in Range(&quot;B3&quot;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 87, "user_id": 9494250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cc9d89159bcb0796ac3d917069d025?s=128&d=identicon&r=PG&f=1", "display_name": "Majid", "link": "https://stackoverflow.com/users/9494250/majid"}, "edited": false, "score": 0, "creation_date": 1527117181, "post_id": 50498504, "comment_id": 88010233, "body": "Try the edit above. If this doesn&#39;t resolve your issues the edit your question to include sample data and expected results. hint: I am reluctant to retype data from an image."}, {"owner": {"reputation": 87, "user_id": 9494250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cc9d89159bcb0796ac3d917069d025?s=128&d=identicon&r=PG&f=1", "display_name": "Majid", "link": "https://stackoverflow.com/users/9494250/majid"}, "edited": false, "score": 1, "creation_date": 1527122646, "post_id": 50498504, "comment_id": 88011444, "body": "It worked. I had to just change the format to m/dd/yyyy"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1527117062, "last_edit_date": 1527117062, "creation_date": 1527115454, "answer_id": 50498504, "question_id": 50498435, "link": "https://stackoverflow.com/questions/50498435/date-range-filter-vba/50498504#50498504", "title": "Date range filter VBA", "body": "<p>Try,</p>\n\n<pre><code>with ActiveSheet.Range(\"A1:C99999\")\n    .AutoFilter Field:=1, Operator:=xlAnd, _\n                Criteria1:=\"&gt;=\"&amp;format(Worksheets(\"Sheet1\").Range(\"B3\").Value, \"mm/dd/yyyy\") _\n                Criteria2:=\"&lt;=\"&amp;format(Worksheets(\"Sheet1\").Range(\"B4\").Value, \"mm/dd/yyyy\")\nend with\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 9494250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cc9d89159bcb0796ac3d917069d025?s=128&d=identicon&r=PG&f=1", "display_name": "Majid", "link": "https://stackoverflow.com/users/9494250/majid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4017, "favorite_count": 0, "accepted_answer_id": 50498504, "answer_count": 1, "score": 1, "last_activity_date": 1527121773, "creation_date": 1527115053, "last_edit_date": 1531164843, "question_id": 50498435, "link": "https://stackoverflow.com/questions/50498435/date-range-filter-vba", "title": "Date range filter VBA", "body": "<p>How do I make the below filter work? The reports are generated weekly and the user needs to enter just the beginning and end date. The filter must be applied based on he values the user gives.</p>\n\n<p>I recorded a macro and got the code as </p>\n\n<pre><code>ActiveSheet.Range(\"$A$1:$C$29663\").AutoFilter Field:=1, Criteria1:= _\n    \"&gt;=5/14/2018\", Operator:=xlAnd, Criteria2:=\"&lt;=5/18/2018\"\n</code></pre>\n\n<p>I want to reference cells in the above sentence instead of values:</p>\n\n<p>Something like below: </p>\n\n<pre><code>ActiveSheet.Range(\"$A$1:$C$29663\").AutoFilter Field:=1, Criteria1:= _\n    Worksheets(\"Sheet1\").Range(\"B3\").Value, Operator:=xlAnd, Criteria2:=Worksheets(\"Sheet1\").Range(\"B4\").Value\n</code></pre>\n\n<p>The above statement is throws errors. </p>\n\n<p>The date values are 5/14/2018 and 5/19/2018</p>\n\n<p>Sample values in the field</p>\n\n<pre><code>5/1/2018\n5/1/2018\n5/1/2018\n5/1/2018\n5/1/2018\n5/1/2018\n</code></pre>\n\n<p>(formatted as short date)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1527113504, "post_id": 50498135, "comment_id": 88009267, "body": "<code>Select Case Right(cleanBMCode, 1)</code> and then <code>Case &quot;#&quot;</code> etc"}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 3, "creation_date": 1527115039, "post_id": 50498135, "comment_id": 88009702, "body": "also look at cleanBMCode versus cleanCode"}], "answers": [{"comments": [{"owner": {"reputation": 225, "user_id": 8592765, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cfbc123f552b4961420b8690b0e70fac?s=128&d=identicon&r=PG&f=1", "display_name": "Pinlop", "link": "https://stackoverflow.com/users/8592765/pinlop"}, "edited": false, "score": 0, "creation_date": 1527192104, "post_id": 50498507, "comment_id": 88047113, "body": "Would you make the default value of <code>numberOrPercentCheck = True</code> at the top of the function or would you add something on the next line after <code>Case Else</code> that sets <code>numberOrPercentCheck = True</code> if I want to execute the &quot;#&quot; option if neither? Or would you alternative just change <code>Case &quot;#&quot;: numberOrPercentCheck = False</code> and the other to True? And would you say that Case is the absolute best way for a third possibility?"}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "reply_to_user": {"reputation": 225, "user_id": 8592765, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cfbc123f552b4961420b8690b0e70fac?s=128&d=identicon&r=PG&f=1", "display_name": "Pinlop", "link": "https://stackoverflow.com/users/8592765/pinlop"}, "edited": false, "score": 0, "creation_date": 1527233437, "post_id": 50498507, "comment_id": 88059397, "body": "The default of first top-function is False, when you want your Else Clause also set to True then you have only 2 options and I would go for the first-function. (just change # to %). When there are more possibilities I think that select case is easy to read/follow/adjust."}], "tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": true, "score": 2, "last_activity_date": 1527115481, "creation_date": 1527115481, "answer_id": 50498507, "question_id": 50498135, "link": "https://stackoverflow.com/questions/50498135/proper-use-of-boolean-case/50498507#50498507", "title": "Proper use of boolean/case?", "body": "<p>When you just want a Boolean:</p>\n\n<pre><code>Private Function numberOrPercentCheck(ByVal cleanCode As String) As Boolean\n    numberOrPercentCheck = Right(cleanCode, 1) = \"#\"\nEnd Function\n</code></pre>\n\n<p>When you need a third possibility:</p>\n\n<pre><code>Private Function numberOrPercentCheck(ByVal cleanCode As String) As Variant\n    Select Case Right(cleanCode, 1)\n        Case \"#\": numberOrPercentCheck = True\n        Case \"%\": numberOrPercentCheck = False\n        Case Else: numberOrPercentCheck = \"Error: \" &amp; cleanCode &amp; \" is not formatted properly with a # or % at the end\"\n    End Select\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 8592765, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cfbc123f552b4961420b8690b0e70fac?s=128&d=identicon&r=PG&f=1", "display_name": "Pinlop", "link": "https://stackoverflow.com/users/8592765/pinlop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 50498507, "answer_count": 1, "score": 1, "last_activity_date": 1527194313, "creation_date": 1527113078, "last_edit_date": 1531164843, "question_id": 50498135, "link": "https://stackoverflow.com/questions/50498135/proper-use-of-boolean-case", "title": "Proper use of boolean/case?", "body": "<p>I'm having issues figuring out if I properly wrote this function. It'll be fed a string that either contains a \"%\" or a \"#\" as the last character ie. \"TA_PQ_SI02_%\". I just want this function to tell me if it's a % or #. </p>\n\n<p>Did I do this in the most effiecient/proper way? I think not, and would like to learn why.</p>\n\n<pre><code>Private Function numberOrPercentCheck(ByVal cleanCode As String) As Boolean\n    Select Case cleanCode \n        Case Right(cleanCode , 1) = \"#\"\n            numberOrPercentCheck= True\n        Case Right(cleanCode , 1) = \"%\"\n            numberOrPercentCheck= False\n        Case Else\n            Debug.Print \"Error: \" &amp; cleanCode &amp; \" is not formatted properly with a # or % at the end, and has been set to a default #\"\n            numberOrPercentCheck = True\n    End Select\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 7346117, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CXzhSH-pYtI/AAAAAAAAAAI/AAAAAAAAAMs/pUmsWxBdBNk/photo.jpg?sz=128", "display_name": "Mikael Kajander", "link": "https://stackoverflow.com/users/7346117/mikael-kajander"}, "is_accepted": true, "score": 1, "last_activity_date": 1527119263, "last_edit_date": 1527119263, "creation_date": 1527116364, "answer_id": 50498623, "question_id": 50498106, "link": "https://stackoverflow.com/questions/50498106/use-vba-in-some-form-to-edit-or-create-more-vba-code-for-a-file-that-will-be-dis/50498623#50498623", "title": "Use VBA in some form to edit or create more VBA code for a file that will be distributed", "body": "<p>This sounds like something I made a couple of years ago. (It's company property now so I can't redistribute it). Here is the general idea with PasteBin as source:</p>\n\n<p>You can do this by creating a VBA-injector and placing the module name in the top of the Pastebin. </p>\n\n<pre><code>changesMadeDate|\nModulename1 updateDate1|\n//your code here\n|Modulename2 updateDate2|\n//and so on\n</code></pre>\n\n<p>If you are working with just Modules, UserForms and Classes this is pretty doable but stay away from Worksheetcode because then you can't use the remove and add method but would instead have to rewrite the sheet code with SendKeys. (Unreliable)</p>\n\n<p>What you need to do (using modules as example):</p>\n\n<ol>\n<li>Create a Pastebin that contains all the modules as described above. </li>\n<li>Create a methods to split the Pastebin data and save each module locally as moduleName + \".bas\" using FSO.</li>\n<li>Remove and add modules to the current project. </li>\n</ol>\n\n<p>You can use this to also create a updateDate for each module and only update those that are newer. Just add a updateDate after Modulename in the Pastebin.</p>\n\n<p>You can distribute just the VBA injector and everyone can use the modules after running the update. Also add changesMadeDate before the first module name in Pastebin and you can create a Workbook_open event that checks it to know if to run the update at all.</p>\n\n<p>If you exceed the Pastebin char limit then just do:</p>\n\n<pre><code>ModuleName1 pastebinlink1|\nModuleName2 pastebinlink2|\n</code></pre>\n\n<p>Then go from there. Using a shared textfile would probably work better though. </p>\n\n<p>Edit: You could also delete all but injector modules. Then add empty modules and use VBIDE.VBComponent.CodeModule then write into them, but I prefer the first way.</p>\n"}], "owner": {"reputation": 385, "user_id": 9564026, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ricards Porins", "link": "https://stackoverflow.com/users/9564026/ricards-porins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 50498623, "answer_count": 1, "score": -1, "last_activity_date": 1527119263, "creation_date": 1527112928, "question_id": 50498106, "link": "https://stackoverflow.com/questions/50498106/use-vba-in-some-form-to-edit-or-create-more-vba-code-for-a-file-that-will-be-dis", "title": "Use VBA in some form to edit or create more VBA code for a file that will be distributed", "body": "<p>So whilst I tried to make the title as clear as possible I will expand on it here.</p>\n\n<p>I am trying to create a new macro, the data for that macro will come from Pastebin, this file would be distributed to many people in different countries. Thus my goal would be to be able to modify or update macros in one shape or form, I can do an easy test to check if there are updates but could not figure out how to modify a macro, I would happily create a new excel workbook temporarily that has these macros or possibly create a VBScript and that creates a macro, not sure of the best method to do this.</p>\n\n<p>What I have done so far, form tons of searching how to programmatically moidfy macros is form the website <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">cpearson</a></p>\n\n<p>However this needs the modification of security which has to be done one each computer that will use this file and that is just not a possibility.</p>\n\n<p>If you need more clarification on the question feel free to drop a comment, (might reply tomorrow) </p>\n\n<p>Any suggestions on how to modify or import macros or workarounds to achieve the desired effect would be amazing. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1527119186, "post_id": 50497938, "comment_id": 88010744, "body": "What is the specific problem you&#39;re having?  It&#39;s unlikely anyone is going to analyse your posted code against your requirements to figure out what the problem is.   Direct questions - one specific problem at a time - are the best approach when asking for help here."}, {"owner": {"reputation": 11, "user_id": 9836840, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100407965256713/picture?type=large", "display_name": "Ellen", "link": "https://stackoverflow.com/users/9836840/ellen"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1527171426, "post_id": 50497938, "comment_id": 88035600, "body": "It&#39;s the last portion of code I&#39;ve got at the moment:"}, {"owner": {"reputation": 11, "user_id": 9836840, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100407965256713/picture?type=large", "display_name": "Ellen", "link": "https://stackoverflow.com/users/9836840/ellen"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1527171825, "post_id": 50497938, "comment_id": 88035893, "body": "It&#39;s the last portion of code I&#39;ve got at the moment. I think it&#39;s something to do with the &quot;if&quot; statement and &quot;Set WS&quot;. If I take those 2 lines out, I can get it to work."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1527174043, "post_id": 50497938, "comment_id": 88037436, "body": "Always helps to explain exactly what errors you&#39;re seeing, or how actual behavior is different from expected behavior.  We can&#39;t really guess the problem."}], "owner": {"reputation": 11, "user_id": 9836840, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100407965256713/picture?type=large", "display_name": "Ellen", "link": "https://stackoverflow.com/users/9836840/ellen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1527111980, "creation_date": 1527111980, "question_id": 50497938, "link": "https://stackoverflow.com/questions/50497938/excel-vba-command-button-on-userform-to-place-value-in-specific-cell-based-on", "title": "Excel VBA - command button on userform to place value in specific cell based on 4 criteria (across 3 worksheets)", "body": "<p>I'm extremely new working with VBA. I'm trying to create a file to help analyze actual, budget and forecast values for my finance department. I think VBA is the way I need to go to get my idea to work like I envision, but finding someone who knows VBA has been quite a challenge. I've tried different searches, but I don't think I've phrased my searches correctly to get the information I need. I would appreciate any help I can get.</p>\n\n<p>What I have so far: A userform with a command button where the criteria can be set along with the value.</p>\n\n<p>What I need it to do:  When using the command button the value will go to 1 of 3 worksheets into a designated cell based on the 4 criteria. </p>\n\n<p>Here are my criteria (and their possibilities):</p>\n\n<ol>\n<li>Month (1-12)</li>\n<li>Entry Type (Actual, Budget, Forecast)</li>\n<li>FCV Header (Raw Materials, Packaging Materials\u2026.)</li>\n<li>Variance Type (Usage, Price, Substitution\u2026)</li>\n</ol>\n\n<p>I have 4 worksheets</p>\n\n<ol>\n<li>Input Tab (this is where the command button is to open the userform and gives an outline of the different Header/Variance Type combinations that can be used)</li>\n<li>FCV Actual</li>\n<li>FCV Budget</li>\n<li>FCV Forecast</li>\n</ol>\n\n<p>I want the \u201cUpload FCV\u201d command button in the userform to look at those 4 criteria and place the value from the text box in the appropriate cell.</p>\n\n<ul>\n<li>The coding I\u2019m troubleshooting right now is for the following setup. The proper cell for this entry to populate is on the FCV Actual tab cell C12</li>\n<li>Month: 1</li>\n<li>Entry Type: Actual</li>\n<li>FCV Header: Raw Materials</li>\n<li>Variance Type: Usage</li>\n<li>Text Box Value: 100</li>\n</ul>\n\n<p>I then want the userform to clear itself in preparation for the next entry.\nThis is the coding I have so far.</p>\n\n<pre><code>'Sub UseModeless()'\n    'Dim frm As New UserFormData_Entry_Form'\n    'frm.Show vbModeless'\n'End Sub'\n\n'Private Sub UserForm_Initialize()'\n    'CB_Month.List = Array(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12)'\n    'CB_Entry_Type.List = Array(\"Actual\", \"Budget\", \"Forecast\")'\n    'CB_FCV_Header.List = Array(\"Raw Materials\", \"Packaging Materials\", \"Labour/Other Variable Variances\", \"Energy\", \"Fixed Cost Variances\", \"Depreciation\", \"Volume\", \"PRO\")'\n    'CB_Variance_Type.List = Array(\"Usage\", \"Price\", \"Substitution\", \"Usage &amp; Non Prop &amp; Other Variable\", \"Substitution &amp; Costing Lot Size\", \"Fixed Labour &amp; Salaried\", \"Maintenance (inc. Labour)\", \"Fixed Energy Variances\", \"Fixed Costs Other\", \"Fixed Spend - Not Explained\", \"Start Up\", \"Special Charges\", \"Bad Goods\", \"Cost Without Production\", \"Factory FG Write-Offs Due to Quality\", \"N/A\")'\n'End Sub'\n\n'Private Sub Upload_Button_Click()'\n    'Application.ScreenUpdating = False'\n    'Dim WS As Worksheet'\n    'If CB_Month = \"1\" And CB_Entry_Type = \"Actual\" And CB_FCV_Header = \"Raw Materials\" And CB_Variance_Type = \"Usage\" And TB_Test &lt;&gt; \"\" Then'\n    'Set WS = ActiveWorkbook.Worksheets(\"FCV Actual\")'\n    'Sheets(\"input tab\").Range(\"a1\") = TB_Total.Value'\n    'End If'\n    'UserForm = Me.reset()'\n'End Sub'\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527109900, "post_id": 50497456, "comment_id": 88007963, "body": "<a href=\"https://www.rondebruin.nl/win/s9/win005.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s9/win005.htm</a>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1527111204, "post_id": 50497456, "comment_id": 88008433, "body": "Why not use <code>Range.Find</code> instead of iterating?"}, {"owner": {"reputation": 1, "user_id": 9807395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a95f1ffeebd0a5356b8b6fbbc0bc40d?s=128&d=identicon&r=PG&f=1", "display_name": "Staryun", "link": "https://stackoverflow.com/users/9807395/staryun"}, "edited": false, "score": 0, "creation_date": 1527112066, "post_id": 50497456, "comment_id": 88008778, "body": "because i don&#180;t know how use it, i try but i am rush with this."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9807395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a95f1ffeebd0a5356b8b6fbbc0bc40d?s=128&d=identicon&r=PG&f=1", "display_name": "Staryun", "link": "https://stackoverflow.com/users/9807395/staryun"}, "edited": false, "score": 0, "creation_date": 1527110218, "post_id": 50497515, "comment_id": 88008082, "body": "Thanks mate i continue with the development  of the function and i will knows you that its works."}, {"owner": {"reputation": 677, "user_id": 3692993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df58980e773a17b1c4258c5c143bb0e0?s=128&d=identicon&r=PG&f=1", "display_name": "TFrazee", "link": "https://stackoverflow.com/users/3692993/tfrazee"}, "reply_to_user": {"reputation": 1, "user_id": 9807395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a95f1ffeebd0a5356b8b6fbbc0bc40d?s=128&d=identicon&r=PG&f=1", "display_name": "Staryun", "link": "https://stackoverflow.com/users/9807395/staryun"}, "edited": false, "score": 0, "creation_date": 1527136071, "post_id": 50497515, "comment_id": 88014434, "body": "Sorry, it should be <code>Set sheet1 = range1.Worksheet</code>.  You need the <code>Set</code> keyword since it&#39;s an object reference."}], "tags": [], "owner": {"reputation": 677, "user_id": 3692993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df58980e773a17b1c4258c5c143bb0e0?s=128&d=identicon&r=PG&f=1", "display_name": "TFrazee", "link": "https://stackoverflow.com/users/3692993/tfrazee"}, "is_accepted": false, "score": 0, "last_activity_date": 1527136094, "last_edit_date": 1527136094, "creation_date": 1527109874, "answer_id": 50497515, "question_id": 50497456, "link": "https://stackoverflow.com/questions/50497456/know-the-row-column-number-of-a-range/50497515#50497515", "title": "Know the row &amp; column number of a range", "body": "<p>You can get all that information from the <code>Range</code> objects themselves.</p>\n\n<pre><code>Set sheet1 = range1.Worksheet\nrow11 = range1.Row\nrow12 = range1.Row + range1.Rows.Count 'Start row + the number of rows in the range\ncolumn11 = range1.Column\ncolumn12 = range1.Column + range1.Columns.Count 'Start col + the number of cols in the range\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1527117870, "last_edit_date": 1527117870, "creation_date": 1527117570, "answer_id": 50498768, "question_id": 50497456, "link": "https://stackoverflow.com/questions/50497456/know-the-row-column-number-of-a-range/50498768#50498768", "title": "Know the row &amp; column number of a range", "body": "<p>You may use this</p>\n\n<pre><code>With range1\n    range1SheetName = .Parent.Name\n    Set range1Sheet= .Parent\n\n    row11 = .Rows(1).Row\n    row12 = .Rows(.Rows.Count).Row\n\n    column11 = .Columns(1).Column\n    column12 = .Columns(.Columns.Count).Column\nEnd With \n</code></pre>\n\n<p>But you can also directly iterate through rows or columns</p>\n\n<pre><code>Dim cell As Range\n\nFor Each cell in range1.Columns(1).Cells \u2018iterate through first column cells -&gt; iterate through rows\n    Msgbox cell.Row\nNext\n\nFor Each cell in range1.Rows(1).Cells \u2018iterate through first row cells -&gt; iterate through columns\n    Msgbox cell.Column\nNext\n\nFor Each cell in range1.Columns \u2018iterate through columns\n    Msgbox cell.Address \u2018 cell is the entire current column\nNext\n\nFor Each cell in range1.Rows \u2018iterate through rows\n    Msgbox cell.Address \u2018 cell is the entire current row\nNext\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9807395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a95f1ffeebd0a5356b8b6fbbc0bc40d?s=128&d=identicon&r=PG&f=1", "display_name": "Staryun", "link": "https://stackoverflow.com/users/9807395/staryun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1527143871, "creation_date": 1527109560, "last_edit_date": 1527143871, "question_id": 50497456, "link": "https://stackoverflow.com/questions/50497456/know-the-row-column-number-of-a-range", "title": "Know the row &amp; column number of a range", "body": "<p>I need make an Excel function that finds a value in a <code>range(range1)</code> , and when finds the value make a product with others <code>ranges(2,3,4)</code>, like this:</p>\n\n<pre><code>function PRODUCT_IF_RANGE=(obj as string,range1 as range,range2 as \nrange,range3 as range,range4 as range) as string\n</code></pre>\n\n<p>the \"ranges\" not necessarily shares the same \"sheet\" and the output type of the function is \"string\" cause I need that notation. </p>\n\n<p>My problem is how I can knows the <code>sheet(name or index)</code>, first an last row, and first and last column of a range? With that I can iterate the range and makes the function runs, like:</p>\n\n<pre><code>dim row11 as integer    'first row\u00b4s number of range1\ndim row12 as integer    'last  row\u00b4s number of range1\ndim column11 as integer 'first column\u00b4s number of range1\ndim column12 as integer 'first column\u00b4s number of range1\n........\nfor i=row11 to row12\nfor j=column11 to column12\nif sheets(sheetr1).cells(i,j)=obj then\n.......\nnext j\nnext i\n........\n........\n</code></pre>\n\n<p>So I just need know the value(number) of first and last row, first ans last column asd the sheet of a range.</p>\n"}, {"tags": ["vba", "ms-access-2013"], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 7638735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6abae53e939f469b8e82aa3fe9291f5?s=128&d=identicon&r=PG&f=1", "display_name": "PIT", "link": "https://stackoverflow.com/users/7638735/pit"}, "is_accepted": false, "score": 0, "last_activity_date": 1527142727, "creation_date": 1527142727, "answer_id": 50502248, "question_id": 50497293, "link": "https://stackoverflow.com/questions/50497293/using-a-saved-report-template-and-updating-the-recordsource-then-save-to-file/50502248#50502248", "title": "Using a saved report template and updating the Recordsource, then save to file", "body": "<p>Assuming that you have a \"Managers\" Table or similar (tblManagersOrSuch) the following untested sub should get you going...</p>\n\n<pre><code>Sub DoManagersReport(Mnth As Integer)\n   Dim rsManagers As DAO.Recordset\n   Set rsManagers = CurrentDb.OpenRecordset(\"tblManagersOrSuch\")\n   If Not rsManagers.EOF Then\n      rsManagers.MoveFirst\n      Do Until rsManagers.EOF\n         DoCmd.OpenReport \"rptUsageReportTemplate\", acViewPreview, , , acHidden\n         Reports(\"rptUsageReportTemplate\").Caption = rsManagers!ManagerID &amp; \"'s \" &amp; Mnth &amp; \" Usage Report\"\n         Reports(\"rptUsageReportTemplate\").Controls(\"fldManagerHeader\") = rsManagers!ManagerID &amp; \"'s \" &amp; Mnth &amp; \" Usage Report\"\n         Reports(\"rptUsageReportTemplate\").RecordSource = \"Select * from MngrUsgRptStr Where ManagerID = \" &amp; rsManagers!ManagerID\n         DoEvents\n         Reports(\"rptUsageReportTemplate\").Visible = True\n         DoCmd.OutputTo acOutputReport, \"rptUsageReportTemplate\", acFormatPDF, \"C:\\\" &amp; rsManagers!ManagerID &amp; \" \" &amp; Mnth &amp; \" Usage Report.pdf\"\n         DoEvents\n         DoCmd.Close acReport, \"rptUsageReportTemplate\"\n      Loop\n   End If\n   'add error handling \n\n End Sub\n</code></pre>\n\n<p>Note that setting the RecordSource forces a requery so you do not require that.\nI would also suggest adding a fileSaveAs function to determine the save folder...  </p>\n"}], "owner": {"reputation": 33, "user_id": 9221247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7915f9743462d161838b9fc994ed1ae6?s=128&d=identicon&r=PG&f=1", "display_name": "D. Steel", "link": "https://stackoverflow.com/users/9221247/d-steel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527142727, "creation_date": 1527108778, "question_id": 50497293, "link": "https://stackoverflow.com/questions/50497293/using-a-saved-report-template-and-updating-the-recordsource-then-save-to-file", "title": "Using a saved report template and updating the Recordsource, then save to file", "body": "<p>I'm trying to output reports.  They all follow the same information, just for different managers.  I can't seem to get any of the right syntax in to modify the necessary parts (Recordsource, Caption, and 1 field that will contain a set string).  I don't know what its asking me and I can get the code to find the next manager name (a recordsource) and cycle through them.  I can get the code to output to PDF file no problem.  It's the relevant code below that I need to figure out.  It's probably completely wrong. I haven't really dealt with reports yet. </p>\n\n<pre><code>DoCmd.OpenReport \"rptUsageReportTemplate\", acViewReport\nReports(\"rptUsageReportTemplate\").RecordSource = MngrUsgRptStr\nReports(\"rptUsageReportTemplate\").Caption = MngrName &amp; \"'s \" &amp; Mnth &amp; \" Usage Report\"\nReports(\"rptUsageReportTemplate\").Controls(\"fldManagerHeader\") = MngrName &amp; \"'s \" &amp; Mnth &amp; \" Usage Report\"\nReports(\"rptUsageReportTemplate\").Requery\nDoCmd.Close acReport, \"rptUsageReportTemplate\", acSaveYes\n</code></pre>\n\n<p>The \"docmd.openreport\" Is in there because i couldn't stop getting the error 2451 - The report name [...] you entered is misspelled or refers to a report that isn't open or doesn't exist.\"  I know it exists and I know it's spelled correctly.  So it must be an open thing.  If I can get Access to output reports behind the scenes without needing to see the report open and close, that would be great. </p>\n\n<p>In short what I want is for the Report I saved to be a template and just update the values a bunch of times and save it to file. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1527109765, "post_id": 50497157, "comment_id": 88007905, "body": "Maybe not your issue here (might be it) but either way highly recommended - avoid using <code>ActiveSheet</code>. You mentioned that the sheet name is &quot;Statistics&quot;, I&#39;d replace your references to <code>ActiveSheet</code> with <code>Sheets(&quot;Statistics&quot;)</code>. Or use a <code>With Sheets(&quot;Statistics&quot;)...End With</code> construction."}, {"owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "edited": false, "score": 0, "creation_date": 1527110468, "post_id": 50497157, "comment_id": 88008172, "body": "<i>&quot;when i debug it keeps telling me that ch2016.Chart.SetSourceData ActiveSheet.Range(&quot;A19&quot;).CurrentRegion is the issue&quot;</i> that&#39;s not a clear description of the error."}, {"owner": {"reputation": 5, "user_id": 9465005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/619bdb05fffb24492789530d2d3e6503?s=128&d=identicon&r=PG&f=1", "display_name": "yomomo", "link": "https://stackoverflow.com/users/9465005/yomomo"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1527113398, "post_id": 50497157, "comment_id": 88009232, "body": "@BigBen you were right, using Sheets(&quot;Statistics&quot;) worked :)"}], "owner": {"reputation": 5, "user_id": 9465005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/619bdb05fffb24492789530d2d3e6503?s=128&d=identicon&r=PG&f=1", "display_name": "yomomo", "link": "https://stackoverflow.com/users/9465005/yomomo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527108128, "creation_date": 1527108128, "question_id": 50497157, "link": "https://stackoverflow.com/questions/50497157/embedding-charts-in-a-sheet-vba", "title": "Embedding charts in a sheet - VBA", "body": "<p>So i've been trying to make a sub that makes charts off of some pivot tables in the sheet, the sheet name is \"statistics\". I was able to make it work a couple of times but now it doesn't work and when i debug it keeps telling me that</p>\n\n<pre><code>ch2016.Chart.SetSourceData ActiveSheet.Range(\"A19\").CurrentRegion\n</code></pre>\n\n<p>is the issue but i haven't changed anything? i don't get the problem, since it was working perfectly earlier.</p>\n\n<pre><code>Sub Opgave4()\n\nDim ch2015 As Shape\nDim ch2016 As ChartObject\nDim ch2017 As ChartObject\n\n\nActiveSheet.Select\n\n\nSet ch2015 = ActiveSheet.Shapes.AddChart(Left:=0, Top:=0, Width:=450, Height:=200)\nSet ch2016 = ActiveSheet.ChartObjects.Add(Left:=450, Top:=0, Width:=450, Height:=200)\nSet ch2017 = ActiveSheet.ChartObjects.Add(Left:=900, Top:=0, Width:=450, Height:=200)\n\n\nch2015.Chart.SetSourceData ActiveSheet.Range(\"A2\").CurrentRegion\nch2016.Chart.SetSourceData ActiveSheet.Range(\"A19\").CurrentRegion\nch2017.Chart.SetSourceData ActiveSheet.Range(\"G1\").CurrentRegion\n\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "conditional-formatting", "vba"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9831006, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x4Ns4oH417I/AAAAAAAAAAI/AAAAAAAABhg/DsuQW7qK3Kc/photo.jpg?sz=128", "display_name": "Hayden Shirts", "link": "https://stackoverflow.com/users/9831006/hayden-shirts"}, "edited": false, "score": 0, "creation_date": 1527113879, "post_id": 50497628, "comment_id": 88009369, "body": "for some reason its only highlighting the words Committee and Team, the collum that im using the macro on currently uses almost every keyword but it only highlights+gives a key for those two words, any thoughts?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 33, "user_id": 9831006, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x4Ns4oH417I/AAAAAAAAAAI/AAAAAAAABhg/DsuQW7qK3Kc/photo.jpg?sz=128", "display_name": "Hayden Shirts", "link": "https://stackoverflow.com/users/9831006/hayden-shirts"}, "edited": false, "score": 0, "creation_date": 1527113987, "post_id": 50497628, "comment_id": 88009403, "body": "I tested and verified it was working so I know that the code is correct. Try checking the spelling in your column G"}, {"owner": {"reputation": 33, "user_id": 9831006, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x4Ns4oH417I/AAAAAAAAAAI/AAAAAAAABhg/DsuQW7qK3Kc/photo.jpg?sz=128", "display_name": "Hayden Shirts", "link": "https://stackoverflow.com/users/9831006/hayden-shirts"}, "edited": false, "score": 0, "creation_date": 1527114566, "post_id": 50497628, "comment_id": 88009569, "body": "Only 2 words are being conditionally formatted:      <a href=\"https://i.stack.imgur.com/QOq0b.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/QOq0b.png</a>"}, {"owner": {"reputation": 33, "user_id": 9831006, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x4Ns4oH417I/AAAAAAAAAAI/AAAAAAAABhg/DsuQW7qK3Kc/photo.jpg?sz=128", "display_name": "Hayden Shirts", "link": "https://stackoverflow.com/users/9831006/hayden-shirts"}, "edited": false, "score": 0, "creation_date": 1527115155, "post_id": 50497628, "comment_id": 88009732, "body": "for example all of the cells in this picture contain the word &quot;attend&quot; but none of them are being formatted <a href=\"https://i.stack.imgur.com/JtEnx.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/JtEnx.png</a>"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 33, "user_id": 9831006, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x4Ns4oH417I/AAAAAAAAAAI/AAAAAAAABhg/DsuQW7qK3Kc/photo.jpg?sz=128", "display_name": "Hayden Shirts", "link": "https://stackoverflow.com/users/9831006/hayden-shirts"}, "edited": false, "score": 0, "creation_date": 1527165940, "post_id": 50497628, "comment_id": 88031611, "body": "@HaydenShirts Found a minor bug in the <code>If WorksheetFunction.CountIf</code> line that was causing the issue.  Updated its criteria argument to have the * on both sides and verified it should now work properly given your provided sample data.  Updated answer to reflect the change."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 0, "last_activity_date": 1527166007, "last_edit_date": 1527166007, "creation_date": 1527110358, "answer_id": 50497628, "question_id": 50496769, "link": "https://stackoverflow.com/questions/50496769/conditional-formatting-macro-with-key/50497628#50497628", "title": "Conditional Formatting macro with key", "body": "<p>I think this is what you're looking for.  Note that it's not finding \"Attention to\" because it finds \"Attention\" first.  To be successful, order them in the order of priority for finds (higher the list get found first), or make sure you aren't going to have duplicate partial matches like that.</p>\n\n<pre><code>Sub ColorCoringPluskey()\n'\n' ColorCoringPluskey Macro\n'\n\n    Dim wb As Workbook\n    Dim wsKey As Worksheet\n    Dim wsFees As Worksheet\n    Dim aKeyColors(1 To 20, 1 To 2) As Variant\n    Dim aOutput() As Variant\n    Dim sKeyShName As String\n    Dim i As Long, j As Long\n\n    Set wb = ActiveWorkbook\n    Set wsFees = wb.Sheets(\"Fees\")\n    sKeyShName = \"Color Coding Key\"\n\n    On Error Resume Next\n    Set wsKey = wb.Sheets(sKeyShName)\n    On Error GoTo 0\n    If wsKey Is Nothing Then\n        Set wsKey = wb.Sheets.Add(After:=ActiveSheet)\n        wsKey.Name = sKeyShName\n        With wsKey.Range(\"A1:B1\")\n            .Value = Array(\"Word\", \"Color\")\n            .HorizontalAlignment = xlCenter\n            .Font.Bold = True\n            .Borders(xlEdgeBottom).LineStyle = xlContinuous\n        End With\n    Else\n        wsKey.Range(\"A2:B\" &amp; wsKey.Rows.Count).Clear\n    End If\n\n    aKeyColors(1, 1) = \"Strategize\":    aKeyColors(1, 2) = 10053120\n    aKeyColors(2, 1) = \"Coordinate\":    aKeyColors(2, 2) = 13421619\n    aKeyColors(3, 1) = \"Committee\":     aKeyColors(3, 2) = 16777062\n    aKeyColors(4, 1) = \"Attention\":     aKeyColors(4, 2) = 2162853\n    aKeyColors(5, 1) = \"Work\":          aKeyColors(5, 2) = 5263615\n    aKeyColors(6, 1) = \"Circulate\":     aKeyColors(6, 2) = 10066431\n    aKeyColors(7, 1) = \"Numerous\":      aKeyColors(7, 2) = 13158\n    aKeyColors(8, 1) = \"Follow up\":     aKeyColors(8, 2) = 39372\n    aKeyColors(9, 1) = \"Attend\":        aKeyColors(9, 2) = 65535\n    aKeyColors(10, 1) = \"Attention to\": aKeyColors(10, 2) = 65535\n    aKeyColors(11, 1) = \"Print\":        aKeyColors(11, 2) = 10092543\n    aKeyColors(12, 1) = \"WIP\":          aKeyColors(12, 2) = 13056\n    aKeyColors(13, 1) = \"Prepare\":      aKeyColors(13, 2) = 32768\n    aKeyColors(14, 1) = \"Develop\":      aKeyColors(14, 2) = 3394611\n    aKeyColors(15, 1) = \"Participate\":  aKeyColors(15, 2) = 10092441\n    aKeyColors(16, 1) = \"Organize\":     aKeyColors(16, 2) = 13369548\n    aKeyColors(17, 1) = \"Various\":      aKeyColors(17, 2) = 16751103\n    aKeyColors(18, 1) = \"Maintain\":     aKeyColors(18, 2) = 16724787\n    aKeyColors(19, 1) = \"Team\":         aKeyColors(19, 2) = 16750950\n    aKeyColors(20, 1) = \"Address\":      aKeyColors(20, 2) = 6697881\n\n    wsFees.Cells.FormatConditions.Delete\n    ReDim aOutput(1 To UBound(aKeyColors, 1), 1 To 2)\n    With wsFees.Columns(\"G\")\n        For i = LBound(aKeyColors, 1) To UBound(aKeyColors, 1)\n            If WorksheetFunction.CountIf(.Cells, \"*\" &amp; aKeyColors(i, 1) &amp; \"*\") &gt; 0 Then\n                j = j + 1\n                aOutput(j, 1) = aKeyColors(i, 1)\n                aOutput(j, 2) = aKeyColors(i, 2)\n                .FormatConditions.Add xlTextString, String:=aKeyColors(i, 1), TextOperator:=xlContains\n                .FormatConditions(.FormatConditions.Count).Interior.Color = aKeyColors(i, 2)\n            End If\n        Next i\n    End With\n\n    If j &gt; 0 Then\n        wsKey.Range(\"A2\").Resize(j, 1).Value = aOutput\n        For i = 1 To j\n            wsKey.Cells(i + 1, \"B\").Interior.Color = aOutput(i, 2)\n        Next i\n        wsKey.Columns(\"A\").EntireColumn.AutoFit\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9831006, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x4Ns4oH417I/AAAAAAAAAAI/AAAAAAAABhg/DsuQW7qK3Kc/photo.jpg?sz=128", "display_name": "Hayden Shirts", "link": "https://stackoverflow.com/users/9831006/hayden-shirts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 50497628, "answer_count": 1, "score": 0, "last_activity_date": 1527166007, "creation_date": 1527106501, "last_edit_date": 1531161705, "question_id": 50496769, "link": "https://stackoverflow.com/questions/50496769/conditional-formatting-macro-with-key", "title": "Conditional Formatting macro with key", "body": "<p>Im trying to make a macro to conditionally format a column. So, that it will change the fill color for cells based on keywords contained in the cells i'm also trying to make it so that this macro will create a new sheet and output a key that only contains keywords and fill colors for keywords contained in the column that is being formatted. </p>\n\n<p>So for example if I have a list of keywords that has 30 words and the column only uses 9 of the words in this case then it would output a key on a separate sheet that only contained the 9 used words along with the corresponding fill colors. </p>\n\n<p>This is what the macro currently looks like, it will conditionally format the column and create a new sheet that outputs a key but it contains all keywords even when they are not used. </p>\n\n<pre><code>Sub ColorCoringPluskey()\n'\n' ColorCoringPluskey Macro\n'\n\n'\n    Sheets.Add After:=ActiveSheet\n    Sheets(\"Sheet1\").Select\n    Sheets(\"Sheet1\").Name = \"Color Coding Key\"\n    Range(\"A1\").Select\n    ActiveCell.FormulaR1C1 = \"Word\"\n    Range(\"B1\").Select\n    ActiveCell.FormulaR1C1 = \"Color\"\n    Range(\"A1\").Select\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Range(\"B1\").Select\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Range(\"A1:B1\").Select\n    Selection.Font.Bold = True\n    Selection.Font.Underline = xlUnderlineStyleSingle\n    Range(\"A2\").Select\n    ActiveCell.FormulaR1C1 = \"Strategize\"\n    Range(\"A3\").Select\n    ActiveCell.FormulaR1C1 = \"Coordinate\"\n    Range(\"A4\").Select\n    ActiveCell.FormulaR1C1 = \"Committee\"\n    Range(\"A5\").Select\n    ActiveCell.FormulaR1C1 = \"Attention\"\n    Range(\"A6\").Select\n    ActiveCell.FormulaR1C1 = \"Work\"\n    Range(\"A7\").Select\n    ActiveCell.FormulaR1C1 = \"Criculate\"\n    Range(\"A8\").Select\n    ActiveCell.FormulaR1C1 = \"Numerous\"\n    Range(\"A9\").Select\n    ActiveCell.FormulaR1C1 = \"Follow up\"\n    Range(\"A10\").Select\n    ActiveCell.FormulaR1C1 = \"Attend\" &amp; Chr(10) &amp; \"Attend to\"\n    Range(\"A11\").Select\n    ActiveCell.FormulaR1C1 = \"Attention to\"\n    Range(\"A12\").Select\n    ActiveCell.FormulaR1C1 = \"Print\"\n    Range(\"A13\").Select\n    ActiveCell.FormulaR1C1 = \"WIP\"\n    Range(\"A14\").Select\n    ActiveCell.FormulaR1C1 = \"Prepare\" &amp; Chr(10) &amp; \"Prepare for\"\n    Range(\"A15\").Select\n    ActiveCell.FormulaR1C1 = \"Develop\"\n    Range(\"A16\").Select\n    ActiveCell.FormulaR1C1 = \"Participate\"\n    Range(\"A17\").Select\n    ActiveCell.FormulaR1C1 = \"Organize\"\n    Range(\"A18\").Select\n    ActiveCell.FormulaR1C1 = \"Various\"\n    Range(\"A19\").Select\n    ActiveCell.FormulaR1C1 = \"Maintain\"\n    Range(\"A20\").Select\n    ActiveCell.FormulaR1C1 = \"Team\" &amp; Chr(10) &amp; \"Team call\"\n    Range(\"A21\").Select\n    ActiveCell.FormulaR1C1 = \"Address\"\n    Range(\"B2\").Select\n    Columns(\"A:A\").ColumnWidth = 13.43\n    Columns(\"B:B\").ColumnWidth = 31.43\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 10053120\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Range(\"B3\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 13421619\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Range(\"B4\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 16777062\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Sheets(\"Fees\").Select\n    Columns(\"G:G\").Select\n    Selection.FormatConditions.Add Type:=xlTextString, String:=\"Strateg\", _\n        TextOperator:=xlContains\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 10053120\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Selection.FormatConditions.Add Type:=xlTextString, String:=\"Coordinate\", _\n        TextOperator:=xlContains\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 13421619\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Selection.FormatConditions.Add Type:=xlTextString, String:=\"Committee\", _\n        TextOperator:=xlContains\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 16777062\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Selection.FormatConditions.Add Type:=xlTextString, String:=\"Attention\", _\n        TextOperator:=xlContains\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 2162853\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Selection.FormatConditions.Add Type:=xlTextString, String:=\"Work\", _\n        TextOperator:=xlContains\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 5263615\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Selection.FormatConditions.Add Type:=xlTextString, String:=\"Circulate\", _\n        TextOperator:=xlContains\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 10066431\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Sheets(\"Color Coding Key\").Select\n    Range(\"B5\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 2162853\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Range(\"B6\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 5263615\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Range(\"B7\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 10066431\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Range(\"B8\").Select\n    Sheets(\"Fees\").Select\n    Selection.FormatConditions.Add Type:=xlTextString, String:=\"Numer\", _\n        TextOperator:=xlContains\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 13158\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Selection.FormatConditions.Add Type:=xlTextString, String:=\"Follow Up\", _\n        TextOperator:=xlContains\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    Selection.FormatConditions(1).StopIfTrue = False\n    Selection.FormatConditions.Add Type:=xlTextString, String:=\"atten\", _\n        TextOperator:=xlContains\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 65535\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Selection.FormatConditions.Add Type:=xlTextString, String:=\"Print\", _\n        TextOperator:=xlContains\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 10092543\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Sheets(\"Color Coding Key\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 13158\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Range(\"B9\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 39372\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Range(\"B10\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 65535\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Range(\"B11\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 10092543\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Range(\"B11\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 65535\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Range(\"B12\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 10092543\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Sheets(\"Fees\").Select\n    Selection.FormatConditions.Add Type:=xlTextString, String:=\"WIP\", _\n        TextOperator:=xlContains\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 13056\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Selection.FormatConditions.Add Type:=xlTextString, String:=\"Prep\", _\n        TextOperator:=xlContains\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 32768\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Selection.FormatConditions.Add Type:=xlTextString, String:=\"develop\", _\n        TextOperator:=xlContains\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 3394611\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Sheets(\"Color Coding Key\").Select\n    Range(\"B13\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 13056\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Range(\"B14\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 32768\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Range(\"B15\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 3394611\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Range(\"B16\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 10092441\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Sheets(\"Fees\").Select\n    Selection.FormatConditions.Add Type:=xlTextString, String:=\"Particip\", _\n        TextOperator:=xlContains\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 10092441\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Selection.FormatConditions.Add Type:=xlTextString, String:=\"Organize\", _\n        TextOperator:=xlContains\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 13369548\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Selection.FormatConditions.Add Type:=xlTextString, String:=\"Various\", _\n        TextOperator:=xlContains\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 16751103\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Sheets(\"Color Coding Key\").Select\n    Range(\"B17\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 13369548\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Range(\"B18\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 16751103\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Range(\"B19\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 16724787\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Range(\"B20\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 16750950\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Range(\"B21\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 6697881\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Sheets(\"Fees\").Select\n    Selection.FormatConditions.Add Type:=xlTextString, String:=\"Maintain\", _\n        TextOperator:=xlContains\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 16724787\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Selection.FormatConditions.Add Type:=xlTextString, String:=\"Team\", _\n        TextOperator:=xlContains\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 16750950\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Selection.FormatConditions.Add Type:=xlTextString, String:=\"address\", _\n        TextOperator:=xlContains\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 6697881\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Sheets(\"Fees\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access", "userform"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1527107814, "post_id": 50496757, "comment_id": 88006948, "body": "Seems you misunderstand the purpose of a form. What&#39;s the query supposed to do if the form isn&#39;t loaded? Queries don&#39;t care about forms, but they can take parameters. Look into parameterizing your queries, not for ways to hack up a coupling between a query and some form. The parameter value can come from a form, but the query should be fundamentally and blissfully unaware of where the parameter value came from."}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 1, "creation_date": 1527109853, "post_id": 50496757, "comment_id": 88007945, "body": "Your second format should work just fine. You  can type in the forms! expression as you have into the query builder (in the criteria part of the query grid). You don&#39;t need quotes or to concatenate when you do this."}, {"owner": {"reputation": 1, "user_id": 9836832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66146ff14e59bd76323110cd55a68f0c?s=128&d=identicon&r=PG&f=1", "display_name": "Matt L", "link": "https://stackoverflow.com/users/9836832/matt-l"}, "edited": false, "score": 0, "creation_date": 1527163174, "post_id": 50496757, "comment_id": 88029525, "body": "Thank you guys for the quick responses. The query as it stands will pull the providers first name, last name and initials if there is no population on the form.   Albert - I understand that I can use that method for the criteria. What I am trying to do is to take the users entry and place it in the field section on the query grid, not the criteria. My only option might be to create over 200 queries for each specific specialty."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9836832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66146ff14e59bd76323110cd55a68f0c?s=128&d=identicon&r=PG&f=1", "display_name": "Matt L", "link": "https://stackoverflow.com/users/9836832/matt-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1527261830, "creation_date": 1527261830, "answer_id": 50532468, "question_id": 50496757, "link": "https://stackoverflow.com/questions/50496757/can-a-control-from-an-access-userform-be-used-in-a-query-field/50532468#50532468", "title": "Can a Control from an Access Userform be used in a Query Field?", "body": "<p>I found out that there is no way to take a users input and place it into the field section of the query grid. Access' database format does not allow for this. </p>\n"}], "owner": {"reputation": 1, "user_id": 9836832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66146ff14e59bd76323110cd55a68f0c?s=128&d=identicon&r=PG&f=1", "display_name": "Matt L", "link": "https://stackoverflow.com/users/9836832/matt-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527261830, "creation_date": 1527106459, "last_edit_date": 1527106763, "question_id": 50496757, "link": "https://stackoverflow.com/questions/50496757/can-a-control-from-an-access-userform-be-used-in-a-query-field", "title": "Can a Control from an Access Userform be used in a Query Field?", "body": "<p>I currently have a Microsoft Access 2010 database for a whole bunch of medical providers. Each provider record has almost 200 specialties that can either have \"Yes\", \"P/C\" or \"No\" as entries.</p>\n\n<p>I am trying to make a search form that would allow the user to select a specialty from a combobox and have a query search the database for every provider whom has that field name at either a \"Yes\" or a \"P/C\"</p>\n\n<p>My issue is I do not know quite how to take a user input from a form and use that value to search by a field. </p>\n\n<p>The following only gives me syntax errors.</p>\n\n<pre><code>\"'\" &amp; Forms!fProviderSearch!cmbbxSearchProviderSpecialty &amp; \"'\"\n\nExpr 1: Forms!fProviderSearch!cmbbxSearchProviderSpecialty \n</code></pre>\n\n<p>My question is then is this even possible? Can a Userform's control value be placed into the query field to search?</p>\n\n<p>I have tried to solve this using VBA and that was just a big unsuccessful mess.</p>\n"}, {"tags": ["excel", "performance", "web-scraping", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1527106169, "post_id": 50496673, "comment_id": 88006111, "body": "I know this ends with &quot;IE.Quit&quot; but that is because I cannot get the other method to work. If this wasnt added, I would have 48 IE windows open in the background."}], "answers": [{"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1527109883, "post_id": 50497487, "comment_id": 88007955, "body": "The input format (ConvertWhat) is currency tickers: For example, USD, EUR, GBP, HKD, etc. Only one input of course. Also, if for whatever reason, you wanted ConvertUSD(USD), the answer would be 1."}, {"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1527111110, "post_id": 50497487, "comment_id": 88008406, "body": "So there\u2019s no \u201camount\u201d argument then? You\u2019re not looking to convert a variable amount, but just get the exchange rate of 1 of the source currency?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1527111291, "post_id": 50497487, "comment_id": 88008467, "body": "Yes, we are just extracting the conversion rate out of Oanda (which will always be compared to 1 USD)."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1527111370, "post_id": 50497487, "comment_id": 88008498, "body": "I have also not figured out how to mod the date input by using the domain. That is an issue for another question most likely though. The date needs to be (Date -1) i.e. Yesterday"}, {"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1527111499, "post_id": 50497487, "comment_id": 88008547, "body": "Okay - answer edited to show a range of different currencies in a loop. Tested and working."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1527113037, "post_id": 50497487, "comment_id": 88009106, "body": "I added both of these to a module. Cell A1 = EUR, Cell B2 = ConvertUSD(A1) and im getting a #VALUE!. I should run the first module, and then use the equation right?"}, {"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1527117638, "post_id": 50497487, "comment_id": 88010344, "body": "Seems like you want a dynamic UDF? That won\u2019t work with the modified code I provided, as the IE object won\u2019t\u2019ve been created, and there\u2019s no second argument provided in your funtion caller. Perhaps you\u2019d better edit your original question to flesh out exactly how you want to use this function. Tip: UDFs trying to open a new IE is a very bad idea!"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1527118062, "post_id": 50497487, "comment_id": 88010429, "body": "I need to build a simple table. Column A will be a list of currency tickers (48) and column B needs to be the corresponding conversion rate matched to 1 USD. My initial plan was to put my UDF in cell B2 (row 1 is headers naturally) and then filldown the UDF to B48. Your tip is definitely valid, which is why I am here seeking an alternative!"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1527118350, "post_id": 50497487, "comment_id": 88010514, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/171652/discussion-between-urdearboy-and-chris-melville\">continue this discussion in chat</a>."}, {"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1527179018, "post_id": 50497487, "comment_id": 88040521, "body": "@urdearboy - what you&#39;re asking is beyond the scope of your original question. Your question related to being able to use the same IE, instead of having to open lots of them. That question has been answered (and I&#39;d very much appreciate an up-vote and a tick if you are satisfied). Regarding your other issue, you need to raise a new question. Thanks."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1527179982, "post_id": 50497487, "comment_id": 88041002, "body": "Valid ask. I will create a new question now with the same tags. Hope to see you there!"}], "tags": [], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "is_accepted": true, "score": 1, "last_activity_date": 1527111456, "last_edit_date": 1527111456, "creation_date": 1527109722, "answer_id": 50497487, "question_id": 50496673, "link": "https://stackoverflow.com/questions/50496673/need-help-amending-macro-to-use-one-internet-explorer-window/50497487#50497487", "title": "Need help amending macro to use one Internet Explorer Window", "body": "<p>Try this:</p>\n\n<pre><code>Sub MainSub()\n    Dim IE As InternetExplorer\n    Set IE = New InternetExplorer\n    '\n    Dim x As Long\n    Dim Currencies As Variant\n    Currencies = Array(\"GBP\", \"EUR\", \"JPY\", \"HKD\")\n    '\n    For x = LBound(Currencies) To UBound(Currencies)\n        Debug.Print \"1 USD = \" &amp; ConvertUSD(Currencies(x), IE) &amp; \" \" &amp; Currencies(x)\n    Next x\n    IE.Quit ' Quit here instead\n    Set IE = Nothing\nEnd Sub\n\nPublic Function ConvertUSD(ByVal ConvertWhat As String, IE As InternetExplorer) As Double\n\n    'References\n    '   Microsoft XML, vs.0\n    '   Microsoft Internet Controls\n    '   Microsoft HTML Object Library.\n\n    ' Dim IE As New InternetExplorer ' Commented out here\n\n    IE.Navigate \"https://www.oanda.com/currency/converter?quote_currency=USD&amp;base_currency=\" &amp; ConvertWhat\n\n    Do\n        DoEvents\n    Loop Until IE.ReadyState = ReadyState_Complete\n    Dim Doc As HTMLDocument\n    Set Doc = IE.Document\n    Dim Ans As String\n    Ans = Trim(Doc.getElementsByTagName(\"tbody\")(2).innerText)\n    Dim AnsExtract As Variant\n    AnsExtract = Split(Ans, \" \")\n\n    ConvertUSD = AnsExtract(4)\n\n    ' IE.Quit ' Don't quit here\n\nEnd Function\n</code></pre>\n\n<p>Your problem is that you keep opening a new IE every time the function is called. However if you open one before calling the function, you'll be able to re-use it as needed - and only quit after you've finished.</p>\n"}], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 50497487, "answer_count": 1, "score": 0, "last_activity_date": 1527118325, "creation_date": 1527106116, "last_edit_date": 1531164843, "question_id": 50496673, "link": "https://stackoverflow.com/questions/50496673/need-help-amending-macro-to-use-one-internet-explorer-window", "title": "Need help amending macro to use one Internet Explorer Window", "body": "<p>The below function opens Oanda.com and takes the currency conversion rate between USD and a input (another currency). The equation will be filled down with another macro to span 48 rows. The macro as it stands, will open 48 Internet Explorer Windows and close them after extracting the data point (1 at a time as the equation updates down the column). This process is tedious and the below method seems to be more efficient on every front but I cannot figure out how to implement: </p>\n\n<p>Is there a way to amend this to first check for existing Internet Explorer window, If one is open, simply use that window to go to the domain (which is variable here) and extract data. If a window is not open, then open one. I do not know procedures to search for programs running in the background.   </p>\n\n<p>The main goal is to speed up the equation when it is executed by fill down. Any suggestions welcome.  </p>\n\n<p>Clarity Edit: I created the UDF to help me build a table. Currency tickers (USD, EUR, GBP, etc) will span Column A down to row 48. Column B needs to show the corresponding conversion rate matched against 1 USD (down to row 48). The UDF below does as intended but i'm seeking an alternative, more efficient, way to do this. </p>\n\n<p>Option Explicit</p>\n\n<pre><code>Public Function ConvertUSD(ConvertWhat As String) As Double\n\n    'References\n    '   Microsoft XML, vs.0\n    '   Microsoft Internet Controls\n    '   Microsoft HTML Object Library.\n\n    Dim IE As New InternetExplorer\n    'IE.Visible = True\n\n    IE.Navigate \"https://www.oanda.com/currency/converter?quote_currency=USD&amp;base_currency=\" &amp; ConvertWhat\n\n    Do\n        DoEvents\n    Loop Until IE.ReadyState = ReadyState_Complete\n    Dim Doc As HTMLDocument\n    Set Doc = IE.Document\n    Dim Ans As String\n    Ans = Trim(Doc.getElementsByTagName(\"tbody\")(2).innerText)\n    Dim AnsExtract As Variant\n    AnsExtract = Split(Ans, \" \")\n\n    ConvertUSD = AnsExtract(4)\n\n    IE.Quit\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "fill", "autofill"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1527104612, "post_id": 50496298, "comment_id": 88005351, "body": "Record a macro and it will give you the VBA."}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1527104782, "post_id": 50496298, "comment_id": 88005439, "body": "I did... and control + end gives &quot;ActiveCell.SpecialCells(xlLastCell).Select&quot; but... Like I said I have been struggling trying to make it work..."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1527104975, "post_id": 50496298, "comment_id": 88005529, "body": "Are you getting some error or something? You aren&#39;t explaining the issue very well."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9298223"}, "edited": false, "score": 0, "creation_date": 1527105373, "post_id": 50496298, "comment_id": 88005727, "body": "Watch <a href=\"https://www.youtube.com//watch?v=c8reU-H1PKQ&amp;index=5&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 5 - Selecting Cells (Range, Cells, Activecell, End, Offset)</a>.  <code>ActiveCell.SpecialCells(xlLastCell).Select</code> will select the last cell of the <code>ActiveCell</code>.  <code>ActiveSheet.Cells.SpecialCells(xlLastCell)</code> will return the last cell of the <code>ActiveSheet</code>.  In anycase, watch the video."}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1527105588, "post_id": 50496298, "comment_id": 88005839, "body": "The issue is I don&#39;t know how to do it... 99% of every Google search I have tried refers to filling down a single column to the last used row... a few refer to filling a known range down a column to the last used row... and a few refer to filling a known range across to the last used column... but I cant find how to fill down to the last used row and the last used column... say... column a has numbers 1 through 10 and row 1 has numbers 1 through 10 and cell b2 has $A2*B$1... I want to auto fill this formula to make a multiplication chart like is used in elementary school"}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1527105880, "post_id": 50496298, "comment_id": 88005967, "body": "and just to be clear... this is a simplified example... in reality... I have dates in column A and names in row 1... and my formula is a sumifs... but the simplified example of the multiplication chart will work if I can figure out how to fill to the last used row and last used column...."}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1527106067, "post_id": 50496298, "comment_id": 88006046, "body": "lastCol = Cells(1, Columns.Count).End(xlToLeft).Column......     lastRow = ActiveSheet.Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row..........     Range(&quot;B2&quot;).AutoFill Destination:=Range(Range(&quot;B2&quot;), Cells(2, lastCol)), Type:=xlFillDefault..........     Range(&quot;B2:B&quot; &amp; lastCol).AutoFill Destination:=Range(&quot;B2&quot;), Cells(lastRow, lastCol)), Type:=xlFillDefault"}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1527106166, "post_id": 50496298, "comment_id": 88006110, "body": "that is what I had tried last but it didn&#39;t work... ive been trying different things for hours"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1527106264, "post_id": 50496298, "comment_id": 88006148, "body": "Are you getting errors? Incorrect results, etc? How isn&#39;t it working? Also can you please edit the code into the original post? Thanks."}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1527106489, "post_id": 50496298, "comment_id": 88006245, "body": "ok I added the code into the original post"}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1527106683, "post_id": 50496298, "comment_id": 88006354, "body": "basically I was trying to fill across then select it all and fill down... but It didn&#39;t work and I don&#39;t know if I can simplify it by telling it to fill from B2 to &quot;ActiveCell.SpecialCells(xlLastCell).Select&quot;..."}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1527107366, "post_id": 50496298, "comment_id": 88006729, "body": "do you understand?"}, {"owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "edited": false, "score": 0, "creation_date": 1527110755, "post_id": 50496298, "comment_id": 88008280, "body": "Please check <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>"}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1527163037, "post_id": 50499147, "comment_id": 88029413, "body": "This doesn&#39;t quite work... But its much closer to working than I have ever been before... this starts at cell &quot;B2&quot; and fills left and up to &quot;A1&quot;... if I change --&gt;Set Start = WS.Range(&quot;B2&quot;)--&gt;Set Start = WS.Range(&quot;E10&quot;)--&gt;then it starts at cell &quot;E10&quot; and fills left and up to &quot;A1&quot;... is there a way to tell it to fill down and to the right? Otherwise is there a way to change --&gt; Set Start = WS.Range(&quot;B2&quot;) --&gt; to reference the cell (LCol, LRow)"}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1527163965, "post_id": 50499147, "comment_id": 88030134, "body": "wait a min... its doing that because it is determining my last row as 1 and my last column as 1... it wasn&#39;t doing that the first few times I ran it... hmmm... let me see if I can figure it out... I bet its because A1 is now blank..."}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1527164442, "post_id": 50499147, "comment_id": 88030494, "body": "no... I thought A1 was blank, but its not... I don&#39;t know why it is saying row 1 col 1 for last cell..."}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1527164682, "post_id": 50499147, "comment_id": 88030641, "body": "ok... figured it out... your formula is looking at row 2 and column B which in my case... the only rows/columns with data are row 1 and column A... after changing LRow and LCol to &quot;A&quot; and &quot;1&quot;... it works... thank you so much!!"}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1527166388, "post_id": 50499147, "comment_id": 88031949, "body": "Ok!! At last!! So my formula worked in excel but not in visual basic... Turns out that it was because I had a criteria for sumifs that was &quot;=&quot;&amp;A2 and in VBA you have to use double quotes &quot;&quot;=&quot;&quot;&amp;A2... Here is my formula --&gt; WS.Range(&quot;B2&quot;, WS.Cells(lastRow, lastCol)).Formula = &quot;=SUMIFS(Raw_Data!$F$2:$F$1000,Raw_Data!$A$2:$A$1000,&quot;&quot;=&quot;&quot;&amp;M&zwnj;&#8203;atrix!$A2,Raw_Data!$&zwnj;&#8203;E$2:$E$1000,&quot;&quot;=&quot;&quot;&amp;Ma&zwnj;&#8203;trix!B$1)&quot;"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 0, "last_activity_date": 1527122683, "last_edit_date": 1527122683, "creation_date": 1527120799, "answer_id": 50499147, "question_id": 50496298, "link": "https://stackoverflow.com/questions/50496298/excel-vba-autofill-across-and-down/50499147#50499147", "title": "Excel VBA autofill across and down", "body": "<p>The below code helps you determine, and reference, your \"box range.\" The code is making 3 assumptions that you may need to amend for if incorrect:</p>\n\n<p>1) The \"top left corner\" of your box range is B2</p>\n\n<p>2) Values in Col B span to the bottom of your range. If you expect blanks in Col B, change this to a different column.  </p>\n\n<p>3) Values in row 2 span to the end of your used columns. If you expect blanks in row 2, change this to a different row. </p>\n\n<pre><code>Sub RangeBox()\n\nDim WS As Worksheet\nSet WS = ThisWorkbook.Sheets(1)\n\nDim LRow As Long\nDim LCol As Long\n\nLRow = WS.Range(\"B\" &amp; WS.Rows.Count).End(xlUp).Row\nLCol = WS.Cells(2, Columns.Count).End(xlToLeft).Column\n\nMsgBox \"Last Row: \" &amp; LRow &amp; vbNewLine &amp; \"Last Column: \" &amp; LCol\n\n'How to refer to the box range starting from A1\nDim Start As Range\nSet Start = WS.Range(\"B2\")\n\nWS.Range(Start, WS.Cells(LRow, LCol)).Select\n\nEnd Sub\n</code></pre>\n\n<p>To fill this range with a formula: </p>\n\n<pre><code>WS.Range(Start, WS.Cells(LRow, LCol)).Formula = \"=Sum(1,2)\"\n</code></pre>\n\n<p>Inside the quotes, type the equation in as you would in excel and used locked references if needed ($). The above example would fill your range with the value 3. </p>\n"}], "owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1067, "favorite_count": 0, "accepted_answer_id": 50499147, "answer_count": 1, "score": -1, "last_activity_date": 1527122683, "creation_date": 1527104509, "last_edit_date": 1527106447, "question_id": 50496298, "link": "https://stackoverflow.com/questions/50496298/excel-vba-autofill-across-and-down", "title": "Excel VBA autofill across and down", "body": "<p>Ok... I am struggling with something that is probably simple... I have a formula in cell B2 and I want to fill to the last cell that contains data or formatting (same as when you press CTRL+END) or in other words \"the bottom right corner\" of my data. How do I do this? There is data in column \"A\" and in row \"1\"... So it needs to fill to the last row and last column containing data...</p>\n\n<pre><code>lastCol = Cells(1, Columns.Count).End(xlToLeft).Column\nlastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nRange(\"B2\").AutoFill Destination:=Range(Range(\"B2\"), Cells(2, lastCol)), Type:=xlFillDefault\nRange(\"B2:B\" &amp; lastCol).AutoFill Destination:=Range(\"B2\"), Cells(lastRow, lastCol)), Type:=xlFillDefault\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1527103219, "post_id": 50495884, "comment_id": 88004626, "body": "Your <code>OR</code> and <code>ORDER</code> clauses need space between each other"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1527103248, "post_id": 50495884, "comment_id": 88004645, "body": "use <code>Debug.Print sql</code> to display your completed query in the immediate window, and then paste it into Access to see if you get an error there as well."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1527103288, "post_id": 50495884, "comment_id": 88004671, "body": "Your original recordsource is possibly fine but not when you run attempt to change it."}, {"owner": {"reputation": 3, "user_id": 9601813, "user_type": "registered", "profile_image": "https://graph.facebook.com/214732595924535/picture?type=large", "display_name": "Dayle Angus", "link": "https://stackoverflow.com/users/9601813/dayle-angus"}, "edited": false, "score": 0, "creation_date": 1527103783, "post_id": 50495884, "comment_id": 88004946, "body": "I printed sql and got the following SELECT tblCustomer.[Job ID], tblCustomer.[Customer Name], tblCustomer.[Street Name], tblCustomer.Area, tblAppointments.[Appointment Date]  FROM tblCustomer  LEFT JOIN tblAppointments ON tblCustomer.[Job ID] = tblAppointments.[Job Number].Value  WHERE [Customer Name] LIKE &#39;<i>s</i>&#39; OR [Job ID] LIKE &#39;<i>s</i>&#39; OR [Street Name] LIKE &#39;<i>s</i>&#39; OR [Area] LIKE &#39;<i>s</i>&#39; OR [Appointment Date] LIKE &#39;<i>s</i>&#39; ORDER BY tblAppointments.[Appointment Date];"}, {"owner": {"reputation": 3, "user_id": 9601813, "user_type": "registered", "profile_image": "https://graph.facebook.com/214732595924535/picture?type=large", "display_name": "Dayle Angus", "link": "https://stackoverflow.com/users/9601813/dayle-angus"}, "edited": false, "score": 0, "creation_date": 1527104197, "post_id": 50495884, "comment_id": 88005142, "body": "Parfait - i&#39;m not sure I know what you mean in your second comment. Can you elaborate?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1527104208, "post_id": 50495884, "comment_id": 88005151, "body": "Why does your printed query not have asterisks and where is the spaces before <code>OR</code>? Please be sure exact query is being posted here."}, {"owner": {"reputation": 3, "user_id": 9601813, "user_type": "registered", "profile_image": "https://graph.facebook.com/214732595924535/picture?type=large", "display_name": "Dayle Angus", "link": "https://stackoverflow.com/users/9601813/dayle-angus"}, "edited": false, "score": 0, "creation_date": 1527105290, "post_id": 50495884, "comment_id": 88005696, "body": "Yes I noticed that but there is asterisks in the immediate window. I think it may be as I am pasting it into this comments section."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1527105354, "post_id": 50495884, "comment_id": 88005722, "body": "Include it in your question instead of in the comments. And does it run when you paste it into an Access query?"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 9601813, "user_type": "registered", "profile_image": "https://graph.facebook.com/214732595924535/picture?type=large", "display_name": "Dayle Angus", "link": "https://stackoverflow.com/users/9601813/dayle-angus"}, "is_accepted": false, "score": 0, "last_activity_date": 1527105421, "creation_date": 1527105421, "answer_id": 50496508, "question_id": 50495884, "link": "https://stackoverflow.com/questions/50495884/requerying-subform-only-work-sometimes/50496508#50496508", "title": "Requerying subform only work sometimes", "body": "<p>I created a new subform and copied the one that did not work and everything seems to be running well.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9601813, "user_type": "registered", "profile_image": "https://graph.facebook.com/214732595924535/picture?type=large", "display_name": "Dayle Angus", "link": "https://stackoverflow.com/users/9601813/dayle-angus"}, "edited": false, "score": 0, "creation_date": 1527107983, "post_id": 50496516, "comment_id": 88007033, "body": "Thank you I will look into that. I&#39;m still quite green so learning this will be on my goal list. I have fixed it for now and am a little wary about changing it especially with code that I would be guessing with. Thank you for your help though I will study parameterization and use it in the future."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 2, "last_activity_date": 1527105449, "creation_date": 1527105449, "answer_id": 50496516, "question_id": 50495884, "link": "https://stackoverflow.com/questions/50495884/requerying-subform-only-work-sometimes/50496516#50496516", "title": "Requerying subform only work sometimes", "body": "<p>Consider parameterization with a stored query for several reasons in your case:</p>\n\n<ol>\n<li>Helps avoid syntax issues like what you may have since Access will not allow you to save a query with syntax errors if using the GUI query designer;</li>\n<li>Better maintainability than a concatenated SQL string which requires single/double quote enclosure and you abstract data from code;</li>\n<li>The Access engine compiles stored queries to best execution plan so will be more efficient than a VBA called SQL string (i.e., use index on <code>JOIN</code>).</li>\n</ol>\n\n<p><strong>SQL</strong> <em>(save as a query object with parameter to be referenced by name in VBA)</em></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>PARAMETERS txtKeywordsParam TEXT(255);\nSELECT c.[Job ID], c.[Customer Name], c.[Street Name], c.Area, a.[Appointment Date]\nFROM tblCustomer c\nLEFT JOIN tblAppointments a ON c.[Job ID] = a.[Job Number]\nWHERE c.[Customer Name] LIKE txtKeywordsParam \n  OR c.[Job ID] LIKE txtKeywordsParam \n  OR c.[Street Name] LIKE txtKeywordsParam \n  OR c.[Area] LIKE txtKeywordsParam \n  OR a.[Appointment Date] LIKE txtKeywordsParam \nORDER BY a.[Appointment Date];\n</code></pre>\n\n<p><strong>VBA</strong></p>\n\n<pre><code>Private Sub btnSearch_Click()\n    Dim qdef As QueryDef\n    Dim rst As Recordset\n\n    ' OPEN QUERY AND BIND PARAM\n    Set qdef = CurrentDb.QueryDefs(\"mySavedParamQuery\")\n    qdef!txtKeywordsParam = \"*\" &amp; Me.txtKeyword &amp; \"*\"\n\n    ' ASSIGN QUERY RESULT TO RECORDSET\n    Set rst = qdef.OpenRecordset()    \n\n    ' APPLY RECORDSET TO FORM \n    Set Me.subCustomerList.Form.Recordset = rst    \n    Set qdef = Nothing    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9601813, "user_type": "registered", "profile_image": "https://graph.facebook.com/214732595924535/picture?type=large", "display_name": "Dayle Angus", "link": "https://stackoverflow.com/users/9601813/dayle-angus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 50496516, "answer_count": 2, "score": 0, "last_activity_date": 1527105449, "creation_date": 1527102836, "last_edit_date": 1527104444, "question_id": 50495884, "link": "https://stackoverflow.com/questions/50495884/requerying-subform-only-work-sometimes", "title": "Requerying subform only work sometimes", "body": "<p>I am trying to requery a subform which diplays customer details.</p>\n\n<p>I am sure my sql works as the subform works fine when not influenced by the main form.</p>\n\n<pre><code>Private Sub btnSearch_Click()\n    Dim sql As String\n\n    sql = \"SELECT tblCustomer.[Job ID], tblCustomer.[Customer Name], tblCustomer.[Street Name], tblCustomer.Area, tblAppointments.[Appointment Date] \" _\n    &amp; \"FROM tblCustomer \" _\n    &amp; \"LEFT JOIN tblAppointments ON tblCustomer.[Job ID] = tblAppointments.[Job Number].Value \" _\n    &amp; \"WHERE [Customer Name] LIKE '*\" &amp; Me.txtKeywords &amp; \"*'\" _\n    &amp; \"OR [Job ID] LIKE '*\" &amp; Me.txtKeywords &amp; \"*'\" _\n    &amp; \"OR [Street Name] LIKE '*\" &amp; Me.txtKeywords &amp; \"*'\" _\n    &amp; \"OR [Area] LIKE '*\" &amp; Me.txtKeywords &amp; \"*'\" _\n    &amp; \"OR [Appointment Date] LIKE '*\" &amp; Me.txtKeywords &amp; \"*'\" _\n    &amp; \"ORDER BY tblAppointments.[Appointment Date];\"\n\n    Me.subCustomerList.Form.RecordSource = sql\n    Me.subCustomerList.Form.Requery\nEnd Sub\n</code></pre>\n\n<p>The debugger shows an error at the following line:</p>\n\n<pre><code>Me.subCustomerList.Form.RecordSource = sql\n</code></pre>\n\n<p>I also get the error message</p>\n\n<blockquote>\n  <p>object or class does not support set of events</p>\n</blockquote>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1527104057, "post_id": 50495747, "comment_id": 88005074, "body": "<code>If Len(.Body) &gt; 32 Then</code>"}, {"owner": {"reputation": 1, "user_id": 9742995, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ryan Lee", "link": "https://stackoverflow.com/users/9742995/ryan-lee"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1527264264, "post_id": 50495747, "comment_id": 88078074, "body": "Thank you. It is working now"}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1527264353, "creation_date": 1527264353, "answer_id": 50533121, "question_id": 50495747, "link": "https://stackoverflow.com/questions/50495747/deleting-duplicate-tasks-based-number-of-characters-in-body/50533121#50533121", "title": "Deleting duplicate tasks based number of characters in body", "body": "<p>Here is how you can check the length of the <code>.Body</code> - using a number instead of a string.</p>\n\n<pre><code>If Len(.Body) &gt; 32 Then\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9742995, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ryan Lee", "link": "https://stackoverflow.com/users/9742995/ryan-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1592993308, "creation_date": 1527102357, "last_edit_date": 1592993308, "question_id": 50495747, "link": "https://stackoverflow.com/questions/50495747/deleting-duplicate-tasks-based-number-of-characters-in-body", "title": "Deleting duplicate tasks based number of characters in body", "body": "<p>I am currently running a macro that runs a rule at startup to create a task, then deletes duplicate tasks. However, because i am making edits to new tasks, the macro doesn't recognise that there are two tasks with the same name because the body text is different. Is there a way to modify the macro to look for the number of characters in the body text? for example </p>\n\n<pre><code>If .body&gt;\"32\" Then\n  ?????\nEnd If\n</code></pre>\n\n<p>Here is the code I currently have. Original code from\n<a href=\"https://www.datanumen.com/blogs/quickly-remove-duplicate-outlook-items-folder-via-vba/\" rel=\"nofollow noreferrer\">https://www.datanumen.com/blogs/quickly-remove-duplicate-outlook-items-folder-via-vba/</a> &amp;\n<a href=\"https://www.slipstick.com/outlook/rules/run-outlook-rules-startup/\" rel=\"nofollow noreferrer\">https://www.slipstick.com/outlook/rules/run-outlook-rules-startup/</a></p>\n\n<pre><code>Private Sub Application_Startup()\nRunAllInboxRules\nRemoveDuplicateItems\nEnd Sub\n\nSub RunAllInboxRules()\nDim st As Outlook.Store\nDim myRules As Outlook.Rules\nDim rl As Outlook.Rule\nDim count As Integer\nDim ruleList As String\n'On Error Resume Next\n\n' get default store (where rules live)\nSet st = Application.Session.DefaultStore\n' get rules\nSet myRules = st.GetRules\n\n' iterate all the rules\nFor Each rl In myRules\n    ' determine if it's an Inbox rule\n          If rl.RuleType = olRuleReceive And rl.IsLocalRule = True Then\n        ' if so, run it\n        rl.Execute ShowProgress:=True\n        count = count + 1\n        ruleList = ruleList &amp; vbCrLf &amp; rl.Name\n    End If\nNext\n\n' tell the user what you did\nruleList = \"These rules were executed against the Inbox: \" &amp; vbCrLf &amp; ruleList\nMsgBox ruleList, vbInformation, \"Macro: RunAllInboxRules\"\n\nSet rl = Nothing\nSet st = Nothing\nSet myRules = Nothing\nEnd Sub\n\nSub RemoveDuplicateItems()\nDim objFolder As Folder\nDim objDictionary As Object\nDim i As Long\nDim objItem As Object\nDim strKey As String\n\nSet objDictionary = CreateObject(\"scripting.dictionary\")\n'Select a source folder\nSet objFolder = Outlook.Application.Session.PickFolder\n\nIf Not (objFolder Is Nothing) Then\n   For i = objFolder.Items.count To 1 Step -1\n       Set objItem = objFolder.Items.Item(i)\n\n       Select Case objFolder.DefaultItemType\n              'Check email subject, body and sent time\n              Case olMailItem\n                   strKey = objItem.subject &amp; \",\" &amp; objItem.Body &amp; \",\" &amp; objItem.SentOn\n              'Check appointment subject, start time, duration, location and body\n              Case olAppointmentItem\n                   strKey = objItem.subject &amp; \",\" &amp; objItem.Start &amp; \",\" &amp; objItem.Duration &amp; \",\" &amp; objItem.Location &amp; \",\" &amp; objItem.Body\n              'Check contact full name and email address\n              Case olContactItem\n                   strKey = objItem.FullName &amp; \",\" &amp; objItem.Email1Address &amp; \",\" &amp; objItem.Email2Address &amp; \",\" &amp; objItem.Email3Address\n              'Check task subject, start date, due date and body\n              Case olTaskItem\n                   strKey = objItem.subject &amp; \",\" &amp; objItem.StartDate &amp; \",\" &amp; objItem.DueDate &amp; \",\" &amp; objItem.Body\n       End Select\n\n       strKey = Replace(strKey, \", \", Chr(32))\n\n       'Remove the duplicate items\n       If objDictionary.Exists(strKey) = True Then\n          objItem.Delete\n       Else\n          objDictionary.Add strKey, True\n       End If\n   Next i\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "excel-formula", "sum"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9298223"}, "edited": false, "score": 0, "creation_date": 1527102468, "post_id": 50495568, "comment_id": 88004256, "body": "There is no loop needed. You need to read <a href=\"https://www.gcflearnfree.org/excelformulas/relative-and-absolute-cell-references/1/\" rel=\"nofollow noreferrer\">Relative and Absolute Cell References</a>."}, {"owner": {"reputation": 1, "user_id": 9824612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc852b0549c9d788c83ef9f2d9c07aff?s=128&d=identicon&r=PG&f=1", "display_name": "alewis9", "link": "https://stackoverflow.com/users/9824612/alewis9"}, "edited": false, "score": 0, "creation_date": 1527102847, "post_id": 50495568, "comment_id": 88004440, "body": "I should have clarified, I am looking to add this in as vba code to a macro I have written."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9298223"}, "edited": false, "score": 2, "creation_date": 1527102894, "post_id": 50495568, "comment_id": 88004464, "body": "You should post your macro."}, {"owner": {"reputation": 1742, "user_id": 9463489, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jblood94", "link": "https://stackoverflow.com/users/9463489/jblood94"}, "edited": false, "score": 0, "creation_date": 1527104423, "post_id": 50495568, "comment_id": 88005259, "body": "Do you want the macro to insert <i>formulas</i> into column P or just the values of the various sums?"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 8663362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XlhnF.jpg?s=128&g=1", "display_name": "sebashc3712", "link": "https://stackoverflow.com/users/8663362/sebashc3712"}, "reply_to_user": {"reputation": 1, "user_id": 9824612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc852b0549c9d788c83ef9f2d9c07aff?s=128&d=identicon&r=PG&f=1", "display_name": "alewis9", "link": "https://stackoverflow.com/users/9824612/alewis9"}, "edited": false, "score": 0, "creation_date": 1527103247, "post_id": 50495791, "comment_id": 88004644, "body": "So you can do a loop for each blank field in the column Q that puts the sum of the values of the column S and writes the result in the column P. What code do you have so far??"}], "tags": [], "owner": {"reputation": 47, "user_id": 8663362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XlhnF.jpg?s=128&g=1", "display_name": "sebashc3712", "link": "https://stackoverflow.com/users/8663362/sebashc3712"}, "is_accepted": false, "score": 0, "last_activity_date": 1527102527, "creation_date": 1527102527, "answer_id": 50495791, "question_id": 50495568, "link": "https://stackoverflow.com/questions/50495568/sum-formula-vba-need-loop/50495791#50495791", "title": "=Sum Formula VBA. Need loop", "body": "<p>You can use pivot table to resume your data in that way:</p>\n\n<p><a href=\"https://i.stack.imgur.com/iUixH.png\" rel=\"nofollow noreferrer\">Pivot table</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/TKTm3.png\" rel=\"nofollow noreferrer\">Configurations</a></p>\n\n<p>Is that what you mean? or did you mean a VBA code?</p>\n\n<p>Regards</p>\n"}, {"tags": [], "owner": {"reputation": 1742, "user_id": 9463489, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jblood94", "link": "https://stackoverflow.com/users/9463489/jblood94"}, "is_accepted": false, "score": 0, "last_activity_date": 1527104061, "creation_date": 1527104061, "answer_id": 50496194, "question_id": 50495568, "link": "https://stackoverflow.com/questions/50495568/sum-formula-vba-need-loop/50496194#50496194", "title": "=Sum Formula VBA. Need loop", "body": "<p>For the example you gave, put this formula in cell P3 and fill down:</p>\n\n<p><code>=IF(LEN(S3)=0,SUM(INDIRECT(\"R\"&amp;ROW()+1&amp;\"C\"&amp;COLUMN(S3)&amp;\":R\"&amp;ROW()+MATCH(TRUE,INDEX(S4:S$17=\"\",0),0)-1&amp;\"C\"&amp;COLUMN(S3),FALSE)),\"\")</code></p>\n\n<p>Note that if your data extend past row 16, you need to change \"S$17\" to one cell <em>below</em> the last cell in column S.</p>\n"}], "owner": {"reputation": 1, "user_id": 9824612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc852b0549c9d788c83ef9f2d9c07aff?s=128&d=identicon&r=PG&f=1", "display_name": "alewis9", "link": "https://stackoverflow.com/users/9824612/alewis9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1527110594, "creation_date": 1527101702, "last_edit_date": 1527110594, "question_id": 50495568, "link": "https://stackoverflow.com/questions/50495568/sum-formula-vba-need-loop", "title": "=Sum Formula VBA. Need loop", "body": "<p><a href=\"https://i.stack.imgur.com/QZ8FV.png\" rel=\"nofollow noreferrer\">Spreadsheet</a></p>\n\n<p>I am trying to insert a new sum formula into column P that sums the corresponding values in column S. This process will repeat over as you will see in the image of my spreadsheet I have attached. Any ideas for creating a loop to do this?</p>\n\n<p>Update: I figured out a loop that will do this here is my code. </p>\n\n<pre><code>Sub COMPLETE()\n\nTotalRow = 0\n\n\nSumEnd = 0\n\n\nFor cur_row = 3 To 174\n\n\n\n\nIf IsEmpty(Cells(cur_row, 19)) = True Then\n\nIf cur_row = 3 Then\n\nTotalRow = 3\n\nCounts = -1\n\nElse\n\nCells(TotalRow, 25) = \"=SUM(S\" &amp; (SumEnd - Counts) &amp; \":S\" &amp; SumEnd &amp; \" )\"\n\n\nTotalRow = cur_row\n\nCounts = -1\n\nEnd If\n\n\n\nElse:\n\nCounts = Counts + 1\n\n\nSumEnd = cur_row\n\n\n\n End If\n\n\n\n\nNext cur_row\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "forms", "ms-access"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1527102405, "post_id": 50495467, "comment_id": 88004225, "body": "Where is that region? Detail? Form header/footer? Page header/footer? Please provide a screenshot more showing full report. And why are you using button controls on reports and not forms?"}, {"owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1527102869, "post_id": 50495467, "comment_id": 88004454, "body": "That is a small section of the entire Report, it is not in the Header nor Footer, but in the Detail section.  The full report is not much larger than that screenshot, and contains just those two buttons and a few controls that get populated from From1.  I originally attempted to put the print and save buttons ON a Form, but everything I read said that you have to print a PDF directly from the Report, and not a Form, so I  threw the buttons on the Report itself.  Form1 populates the data and opens the Report in question."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1527103059, "post_id": 50495467, "comment_id": 88004559, "body": "<i>I read said that you have to print a PDF directly from the Report, and not a Form</i> ... not true. You can call <code>DoCmd.OutputTo</code> <i>anywhere</i> in forms, reports, macros, modules, even outside MS Access (like in Excel or Python) but still calling the Access library!"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1527103112, "post_id": 50495467, "comment_id": 88004583, "body": "Can you still post a wider lens screenshot? Is the entire Detail section grayed or a box inside Detail? I cannot tell from here."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 3, "creation_date": 1527103354, "post_id": 50495467, "comment_id": 88004711, "body": "Yes, this is normal. Since those controls are in Detail section and report is apparently in ReportView, that highight indicates record is selected. Don&#39;t use ReportView."}, {"owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "edited": false, "score": 0, "creation_date": 1527177727, "post_id": 50495467, "comment_id": 88039833, "body": "I was able to get everything working on the Form, versus the Report as suggested - just wanted to follow up and confirm it worked for others out there."}], "owner": {"reputation": 97, "user_id": 6107355, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RaaW_0oA2t0/AAAAAAAAAAI/AAAAAAAAAKo/J6Zeriak-lU/photo.jpg?sz=128", "display_name": "Eric King", "link": "https://stackoverflow.com/users/6107355/eric-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527103791, "creation_date": 1527101341, "last_edit_date": 1527103791, "question_id": 50495467, "link": "https://stackoverflow.com/questions/50495467/ms-access-gray-box-appears-when-clicking-report-background", "title": "MS Access Gray box appears when clicking Report background", "body": "<p>When I click on the background of my Report, I get this gray box that covers the entire form.  </p>\n\n<p>It goes away when I click inside any of the controls, but wanted to know how to turn off this function or disable the gray box from appearing when someone clicks on the background of the Report. </p>\n\n<p>See images below as an example.  </p>\n\n<p><img src=\"https://i.stack.imgur.com/Rvbxs.jpg\" alt=\"enter image description here\">\n<img src=\"https://i.stack.imgur.com/aJi9w.jpg\" alt=\"enter image description here\"></p>\n\n<p>Is this normal for all reports, or is it an F4 setting, etc?  Anyone able to point me in the right direction? </p>\n"}, {"tags": ["vba", "winhttprequest"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1527106125, "post_id": 50495335, "comment_id": 88006085, "body": "This URL redirects to <code>https:&#47;&#47;extranet-logon-emea.sanofi.com&#47;my.policy</code> with login form. Are you trying to log in? Give us full picture."}, {"owner": {"reputation": 73, "user_id": 9836438, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bLiJe69q9Y8/AAAAAAAAAAI/AAAAAAAAACc/aXpZh29eNnU/photo.jpg?sz=128", "display_name": "Julio Hintze", "link": "https://stackoverflow.com/users/9836438/julio-hintze"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1527176854, "post_id": 50495335, "comment_id": 88039281, "body": "Sorry about being a little vague. I&#39;ve updated the original post."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1527180379, "post_id": 50495335, "comment_id": 88041217, "body": "There&#39;s a need for login and password :)"}, {"owner": {"reputation": 73, "user_id": 9836438, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bLiJe69q9Y8/AAAAAAAAAAI/AAAAAAAAACc/aXpZh29eNnU/photo.jpg?sz=128", "display_name": "Julio Hintze", "link": "https://stackoverflow.com/users/9836438/julio-hintze"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1527182555, "post_id": 50495335, "comment_id": 88042363, "body": "The request should give me a html page with the login/password inputs, but the &quot;Send&quot; method always timesout"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1527185500, "post_id": 50495335, "comment_id": 88043837, "body": "Use <a href=\"https://www.getpostman.com\" rel=\"nofollow noreferrer\">Postman</a> or <a href=\"https://www.telerik.com/fiddler\" rel=\"nofollow noreferrer\">Fiddler</a> to see what&#39;s going on."}, {"owner": {"reputation": 73, "user_id": 9836438, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bLiJe69q9Y8/AAAAAAAAAAI/AAAAAAAAACc/aXpZh29eNnU/photo.jpg?sz=128", "display_name": "Julio Hintze", "link": "https://stackoverflow.com/users/9836438/julio-hintze"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1527258496, "post_id": 50495335, "comment_id": 88074820, "body": "Solved it! Thank you, JohnyL, for the patience!"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1527269501, "post_id": 50495335, "comment_id": 88080469, "body": "Glad that helped you :)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527528905, "post_id": 50495335, "comment_id": 88152088, "body": "@JulioCesarHintzedosSantos Thanks for posting the solution line. Would you mind posting it as an answer rather than an edit to the question please? If you post the line added to your original code it will not only help others more, but may earn you rep points. Two days after posting your answer you can then accept it."}], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 9836438, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bLiJe69q9Y8/AAAAAAAAAAI/AAAAAAAAACc/aXpZh29eNnU/photo.jpg?sz=128", "display_name": "Julio Hintze", "link": "https://stackoverflow.com/users/9836438/julio-hintze"}, "is_accepted": true, "score": 1, "last_activity_date": 1527601474, "creation_date": 1527601474, "answer_id": 50585953, "question_id": 50495335, "link": "https://stackoverflow.com/questions/50495335/winhttp-request-fails-timeout-why/50585953#50585953", "title": "WinHTTP Request fails (timeout). Why?", "body": "<p>The problem was solved by using <code>.SetProxy 2, <i>proxy</i></code>.</p>\n"}], "owner": {"reputation": 73, "user_id": 9836438, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bLiJe69q9Y8/AAAAAAAAAAI/AAAAAAAAACc/aXpZh29eNnU/photo.jpg?sz=128", "display_name": "Julio Hintze", "link": "https://stackoverflow.com/users/9836438/julio-hintze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1583, "favorite_count": 0, "accepted_answer_id": 50585953, "answer_count": 1, "score": 0, "last_activity_date": 1527601474, "creation_date": 1527100848, "last_edit_date": 1527258456, "question_id": 50495335, "link": "https://stackoverflow.com/questions/50495335/winhttp-request-fails-timeout-why", "title": "WinHTTP Request fails (timeout). Why?", "body": "<p>So, I'm trying to send a request to a http server from VBA using the WinHttpRequest class.</p>\n\n<p>I've already made a similar code which sends requests to another server, and it worked. This one won't even go through the \".Send\". It fails (timeout).</p>\n\n<p>I've checked every RequestHeader at Google Chrome devtools and tried to replicate the web request, but failed (with and without the cookies).</p>\n\n<p>Any ideas?</p>\n\n<p>The code:</p>\n\n<pre>\n    Dim WHTTP As New WinHttp.WinHttpRequest\n\n    With WHTTP\n        .Open \"GET\", \"https://contactcenter-prd.prosodie.com/prweb/sso\", False\n        .SetRequestHeader \"Accept\", \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8\"\n        .SetRequestHeader \"Accept-Encoding\", \"gzip, deflate, br\"\n        .SetRequestHeader \"Accept-Language\", \"pt-BR,pt;q=0.9,en-US;q=0.8,en;q=0.7\"\n        .SetRequestHeader \"Connection\", \"keep-alive\"\n        '.SetRequestHeader \"Cookie\", \"JSESSIONID=337C72E2DBCC1080C674033FFC51EBFA.contactcenter; Pega-RULES=\" & Chr(34) & \"{atn}e3ByfVkzNDBlc3NYRlBYdWFRT2dkRFRjekU5LytjNm51MEMwazI4YmJqVDNvaFlUTE1LQUN3T1p6SUVYMEd5dlUxaHRSWEVINFpJTWVhY1YKdCtpRkQwZjJLdz09\" & Chr(34) & \"; BWROUTEID=s2ac70d938fbd5ee39c5b1b93ac33d7b.1\"\n        .SetRequestHeader \"Host\", \"contactcenter-prd.prosodie.com\"\n        .SetRequestHeader \"Upgrade-Insecure-Requests\", \"1\"\n        '.SetRequestHeader \"User-Agent\", \"Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.117 Safari/537.36\" ' From Chrome\n        .SetRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\" ' Some guy said it would work (it didn't)\n        '.SetTimeouts 1200000, 1200000, 1200000, 1200000\n        .Send\n    End With\n</pre>\n\n<p><b>EDIT:</b></p>\n\n<p>The purpose of the macro is to enter the website, get some info, put the info into a worksheet and exit the website.</p>\n\n<p>I'm aware that the URL redirects to another, but (I think) I <b>have to</b> go to the first website to get some cookies.</p>\n\n<p><b>EDIT 2:</b></p>\n\n<p>Problem solved.</p>\n\n<p>I had to setup a proxy to use the website.\n<code>.SetProxy 2, myProxy</code> did the trick!</p>\n"}, {"tags": ["arrays", "excel", "sorting", "copy-paste", "vba"], "comments": [{"owner": {"reputation": 1026, "user_id": 8788388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j4tnBdMaXfk/AAAAAAAAAAI/AAAAAAACwcU/Jg67BYcCeW0/photo.jpg?sz=128", "display_name": "Hakan ERDOGAN", "link": "https://stackoverflow.com/users/8788388/hakan-erdogan"}, "edited": false, "score": 1, "creation_date": 1527101346, "post_id": 50495244, "comment_id": 88003676, "body": "copy/pastes, activating cells slows down Excel-VBA codes. Instead of copying and pasting try assigning cell values to variables and then assign the new cell values to these variables. You may want to play around with loops and array variables in order to copy multiple cells at once."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 9356603, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AdcT8n0jPEY/AAAAAAAAAAI/AAAAAAAAAQQ/xtuD27ktDaI/photo.jpg?sz=128", "display_name": "Salik Gilani", "link": "https://stackoverflow.com/users/9356603/salik-gilani"}, "edited": false, "score": 0, "creation_date": 1527218389, "post_id": 50500315, "comment_id": 88054229, "body": "Thank you for your help! I believe screenupdating and manual calculations have helped reduce the time. The reason I have refresh all is due to the data being updated based on a user access list which is updated quite frequently and I have an external connection linked to the file. Once again, thank you for your help!"}, {"owner": {"reputation": 558, "user_id": 7378537, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/901b8b99c93e12e82b05a09197917c37?s=128&d=identicon&r=PG&f=1", "display_name": "Yeile", "link": "https://stackoverflow.com/users/7378537/yeile"}, "reply_to_user": {"reputation": 37, "user_id": 9356603, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AdcT8n0jPEY/AAAAAAAAAAI/AAAAAAAAAQQ/xtuD27ktDaI/photo.jpg?sz=128", "display_name": "Salik Gilani", "link": "https://stackoverflow.com/users/9356603/salik-gilani"}, "edited": false, "score": 0, "creation_date": 1527471293, "post_id": 50500315, "comment_id": 88126969, "body": "@SalikGilani glad I could help! Do accept the answer so other users know what to do in the future. Cheers!"}, {"owner": {"reputation": 37, "user_id": 9356603, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AdcT8n0jPEY/AAAAAAAAAAI/AAAAAAAAAQQ/xtuD27ktDaI/photo.jpg?sz=128", "display_name": "Salik Gilani", "link": "https://stackoverflow.com/users/9356603/salik-gilani"}, "edited": false, "score": 0, "creation_date": 1527561160, "post_id": 50500315, "comment_id": 88160253, "body": "I already have. Dont think It will show since I do not have enough reputation points. Hope this helps other people out as well. cheers!"}], "tags": [], "owner": {"reputation": 558, "user_id": 7378537, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/901b8b99c93e12e82b05a09197917c37?s=128&d=identicon&r=PG&f=1", "display_name": "Yeile", "link": "https://stackoverflow.com/users/7378537/yeile"}, "is_accepted": false, "score": 0, "last_activity_date": 1527131263, "creation_date": 1527131263, "answer_id": 50500315, "question_id": 50495244, "link": "https://stackoverflow.com/questions/50495244/macro-to-copy-from-one-sheet-to-another-and-sort-ascending/50500315#50500315", "title": "Macro to Copy from One Sheet to Another and Sort Ascending", "body": "<p>Your copy/paste/sort code seems efficient enough, I don't think it is the cause of your lag. I suspect <code>Activeworkbook.RefreshAll</code> may be the problem - try commenting it out to see if performance improves.</p>\n\n<p>Copy/Paste/Sort can slow down the process because such operation interacts with the spreadsheet, and reading/writing/updating requires processing power. Try the following:</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\n\n` Your code here\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9356603, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AdcT8n0jPEY/AAAAAAAAAAI/AAAAAAAAAQQ/xtuD27ktDaI/photo.jpg?sz=128", "display_name": "Salik Gilani", "link": "https://stackoverflow.com/users/9356603/salik-gilani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1257, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527131263, "creation_date": 1527100551, "last_edit_date": 1531161705, "question_id": 50495244, "link": "https://stackoverflow.com/questions/50495244/macro-to-copy-from-one-sheet-to-another-and-sort-ascending", "title": "Macro to Copy from One Sheet to Another and Sort Ascending", "body": "<p>I have an Array formula in the Sheet \" Employee Access Detail\". (Values are from Column A to D and array formula extends to Row 1530).</p>\n\n<p>I want to copy the values to another sheet called \"Employee Access Arranged\" and paste as values and then sort ascending according to Column C. I have a code that is working and is as follows :-</p>\n\n<pre><code>    Private Sub CommandButton1_Click()\n\n     ActiveWorkbook.RefreshAll\n\n     Sheets(\"Employee Access Arranged\").Range(\"A2:D\" &amp; Sheets(\"Employee \n     Access Arranged\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row).ClearContents\n\n     With Sheets(\"Employee Access Detail\")\n    .Range(.Range(\"A4\"), .Cells(.Rows.Count, \"D\").End(xlUp)).Copy\n     End With\n\n    With Sheets(\"Employee Access Arranged\")\n    .Cells(.Rows.Count, \"A\").End(xlUp)(2).PasteSpecial Paste:=xlPasteValues\n    End With\n\n    Application.CutCopyMode = False\n\n    Range(\"C2\").CurrentRegion.Select\n    Selection.Sort Key1:=Range(\"C2\"), Order1:=xlDescending, Header:=xlGuess, _\n    OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _\n    DataOption1:=xlSortNormal\n\n    Worksheets(\"Employee Access Arranged\").Activate\n    Range(\"A2\").Activate\n\n     End Sub\n</code></pre>\n\n<p>Now, just to paste these values and arrange ascending this code is taking a few minutes and since this has to be done multiple times, is not efficient.</p>\n\n<p>I would be grateful if there was a way this code could be made more efficient. I believe the issues is with how I am copying the values. </p>\n\n<p>Thank you for your help in advance. Appreciate it. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1527099249, "post_id": 50494714, "comment_id": 88002584, "body": "What do you mean by &quot;extend the range&quot;.  Are these all <code>.xls</code> workbooks?"}, {"owner": {"reputation": 51, "user_id": 7704959, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212629008864379/picture?type=large", "display_name": "Vincent", "link": "https://stackoverflow.com/users/7704959/vincent"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1527099490, "post_id": 50494714, "comment_id": 88002697, "body": "They&#39;re all csv/flat files. And range, I mean the limit to where the maximum of files can be merged/transferred into a single workbook. Sorry for the confusion."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1527099757, "post_id": 50494714, "comment_id": 88002835, "body": "What specific problem have you run into?"}, {"owner": {"reputation": 51, "user_id": 7704959, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212629008864379/picture?type=large", "display_name": "Vincent", "link": "https://stackoverflow.com/users/7704959/vincent"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1527100913, "post_id": 50494714, "comment_id": 88003450, "body": "I&#39;m running to an incomplete data. My thinking is, maybe it&#39;s because the files in my local folder far exceed the the range of columns and/or rows."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1527106024, "post_id": 50494714, "comment_id": 88006032, "body": "Excel can handle a little more than <code>1,000,000</code> rows.  You are only referencing a small fraction of that <code>65,536</code>.  Why not reference the entire column?"}, {"owner": {"reputation": 51, "user_id": 7704959, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212629008864379/picture?type=large", "display_name": "Vincent", "link": "https://stackoverflow.com/users/7704959/vincent"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1527113370, "post_id": 50494714, "comment_id": 88009223, "body": "I&#39;ve actually did reference the column to (&quot;A1000000&quot;) but to no avail. It&#39;s not gathering/merging all the data that&#39;s on my local folder. Local folder contains 5000+ files. When everything is merged, it only gathered 2000+ files. I did a spot check by reducing the number of files in half in my local folder, and came out perfectly."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1527113412, "post_id": 50494714, "comment_id": 88009236, "body": "How many rows of data do you have, roughly?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1527114017, "post_id": 50494714, "comment_id": 88009414, "body": "Also, how many files are there in <code>filesObj</code> after you <code>Set filesObj = dirObj.Files</code>"}, {"owner": {"reputation": 51, "user_id": 7704959, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212629008864379/picture?type=large", "display_name": "Vincent", "link": "https://stackoverflow.com/users/7704959/vincent"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1527114605, "post_id": 50494714, "comment_id": 88009587, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/171650/discussion-between-vincent-and-ron-rosenfeld\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1527099862, "creation_date": 1527099862, "answer_id": 50495064, "question_id": 50494714, "link": "https://stackoverflow.com/questions/50494714/extending-the-range/50495064#50495064", "title": "Extending the Range", "body": "<p>Going to take a guess and say that you're looking for two dynamic ranges for a copy and a paste:</p>\n\n<pre><code>dim lrs as long, lrd as long 'last row source/destination\n'could also look for last column dynamically\n\n'inside of your loop\nwith everyObj.sheets(\"\")\n    lrs = .cells(.rows.count,1).end(xlup).row\n    .range(.cells(1,1),.cells(lrs,\"iv\").copy\nend with\nwith thisworkbook.sheets(\"\")\n    lrd = .cells(.rows.count, 1).end(xlup).row\n    .range(.cells(lrd+1,1),.cells(lrd+1+lrs,\"iv\").paste\nend with\n</code></pre>\n\n<p>untested code, giving a shot in the dark.  you should be able to add nearly unlimited lines into excel, provided you're using the correct code to get there.</p>\n\n<p>i would recommend closing each source file and specify to NOT SAVE (the latter appears missing from your code).</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 7704959, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212629008864379/picture?type=large", "display_name": "Vincent", "link": "https://stackoverflow.com/users/7704959/vincent"}, "edited": false, "score": 0, "creation_date": 1527119249, "post_id": 50495065, "comment_id": 88010758, "body": "I&#39;ve tried this, but the outcome is the same as my original code. I&#39;d like to point out that if the files in my local folder   (&quot;C:\\Users\\Vincent\\Desktop\\856&quot;) over 3,000 files, that&#39;s the time I run into getting an incomplete data when ran. I&#39;m wondering if there are limitations to the Range code? Or if the files are trying to merge but won&#39;t copy?"}], "tags": [], "owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "is_accepted": false, "score": 0, "last_activity_date": 1527099862, "creation_date": 1527099862, "answer_id": 50495065, "question_id": 50494714, "link": "https://stackoverflow.com/questions/50494714/extending-the-range/50495065#50495065", "title": "Extending the Range", "body": "<p>You need to find the last row or end of the range, try this:</p>\n\n<pre><code>Sub Merger()\nDim bookList As Workbook\nDim mergeObj As Object, dirObj As Object, filesObj As Object, everyObj As Object\nApplication.ScreenUpdating = False\nSet mergeObj = CreateObject(\"Scripting.FileSystemObject\")\n\nSet dirObj = mergeObj.Getfolder(\"C:\\Users\\Vincent\\Desktop\\856\")\n\nSet filesObj = dirObj.Files\nFor Each everyObj In filesObj\nSet bookList = Workbooks.Open(everyObj)\n\n' find last row in column A\nDim last_row As Long\nWith ActiveSheet\n    last_row = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With\n\nRange(\"A2:IV\" &amp; Range(\"A\" &amp; last_row).End(xlUp).Row).Copy\n\nThisWorkbook.Worksheets(1).Activate\n\nRange(\"A\" &amp; last_row).End(xlUp).Offset(1, 0).PasteSpecial\n\nApplication.CutCopyMode = False\nbookList.Close\n\nApplication.DisplayAlerts = False\n\nNext\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 7704959, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212629008864379/picture?type=large", "display_name": "Vincent", "link": "https://stackoverflow.com/users/7704959/vincent"}, "edited": false, "score": 0, "creation_date": 1527119285, "post_id": 50495297, "comment_id": 88010769, "body": "I&#39;ve tried this, but the outcome is the same as my original code. I&#39;d like to point out that if the files in my local folder   (&quot;C:\\Users\\Vincent\\Desktop\\856&quot;) over 3,000 files, that&#39;s the time I run into getting an incomplete data when ran. I&#39;m wondering if there are limitations to the Range code? Or if the files are trying to merge but won&#39;t copy?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9298223"}, "reply_to_user": {"reputation": 51, "user_id": 7704959, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212629008864379/picture?type=large", "display_name": "Vincent", "link": "https://stackoverflow.com/users/7704959/vincent"}, "edited": false, "score": 0, "creation_date": 1527129429, "post_id": 50495297, "comment_id": 88012896, "body": "@Vincent I edited my post to describe how to troubleshoot the code."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9298223"}, "is_accepted": false, "score": 0, "last_activity_date": 1527141318, "last_edit_date": 1527141318, "creation_date": 1527100756, "answer_id": 50495297, "question_id": 50494714, "link": "https://stackoverflow.com/questions/50494714/extending-the-range/50495297#50495297", "title": "Extending the Range", "body": "<p><code>Range().Rows.Count</code> should be used of hard coding the last row.  All referencing inside the range should be fully qualified (reference the source worksheet).  Using a <code>With WorkBook.Worksheet</code> block will ensure that you return the proper Range everytime.</p>\n\n<blockquote>\n<pre><code>With bookList.Worksheets(1)\n    .Range(\"A2:IV2\", .Range(\"A\" &amp; .Rows.Count).End(xlUp))\nEnd With\n</code></pre>\n</blockquote>\n\n<p><code>Range.Copy</code> should only be used when you need to include Formatting.  <code>Range.Value</code> returns an Array of values from the Range. </p>\n\n<p><code>Application.DisplayAlerts = False</code> should precede <code>bookList.Close</code>.  Using the <code>Workbook.Close SaveChanges:=False</code> is preferable and eliminates the need to disable <code>DisplayAlerts</code> (e.g.  <code>bookList.Close SaveChanges:=False</code>)</p>\n\n<pre><code>Sub Merger()\n    Application.ScreenUpdating = False\n    Dim bookList As Workbook\n    Dim mergeObj As Object, dirObj As Object, filesObj As Object, everyObj As Object\n    Dim Source As Range, Target As Range\n    Set mergeObj = CreateObject(\"Scripting.FileSystemObject\")\n\n    Set dirObj = mergeObj.Getfolder(\"C:\\Users\\Vincent\\Desktop\\856\")\n\n    Set filesObj = dirObj.Files\n    For Each everyObj In filesObj\n        Set bookList = Workbooks.Open(everyObj)\n\n        With bookList.Worksheets(1)\n            Set Source = .Range(\"A2:IV2\", .Range(\"A\" &amp; .Rows.Count).End(xlUp))\n        End With\n\n        With ThisWorkbook.Worksheets(1)\n            Set Target = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Offset(1, 0)\n        End With\n\n        Target.Resize(Source.Rows.Count, Source.Columns.Count).Value = Source.Value\n\n        bookList.Close SaveChanges:=False\n    Next\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<h2>Addendum</h2>\n\n<p>The current \"Range Limit\" is <code>1048576 Rows x 16384 Columns</code>.  This code extends the Range from <code>A2:V2</code> to the last used cell in <code>Column A</code> of the CSV File. If the data in <code>Column A</code> does not extend to the end of the list change <code>.Range(\"A\"</code> to the appropriate column.</p>\n\n<blockquote>\n<pre><code>Set Source = .Range(\"A2:IV2\", .Range(\"A\" &amp; .Rows.Count).End(xlUp)\n</code></pre>\n</blockquote>\n\n<p>You should set a breakpoint at <code>bookList.Close</code> and test the Ranges.  </p>\n\n<p><code>Immediate Window</code></p>\n\n<blockquote>\n  <p>?Source.Address, Target.Resize(Source.Rows.Count, Source.Columns.Count).Address</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/TQljH.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TQljH.jpg\" alt=\"Immediate Window\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1527226044, "post_id": 50502766, "comment_id": 88056171, "body": "@Vincent, any feedback?"}, {"owner": {"reputation": 51, "user_id": 7704959, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212629008864379/picture?type=large", "display_name": "Vincent", "link": "https://stackoverflow.com/users/7704959/vincent"}, "edited": false, "score": 0, "creation_date": 1527254716, "post_id": 50502766, "comment_id": 88072320, "body": "Hi. Yes, I&#39;m running into &quot;run-time error 1004&quot;. Also got an error that I need to switch to 64 bit microsoft office. I check the version that I have and I do have the 64 bit. An error also stated that memory is insufficient. I checked my RAM and I do have 16gb."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 51, "user_id": 7704959, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212629008864379/picture?type=large", "display_name": "Vincent", "link": "https://stackoverflow.com/users/7704959/vincent"}, "edited": false, "score": 0, "creation_date": 1527261670, "post_id": 50502766, "comment_id": 88076704, "body": "which line is highlighted when hitting &quot;run-time error 1004&quot;?"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1527144641, "creation_date": 1527144641, "answer_id": 50502766, "question_id": 50494714, "link": "https://stackoverflow.com/questions/50494714/extending-the-range/50502766#50502766", "title": "Extending the Range", "body": "<p>you could try this</p>\n\n<pre><code>Option Explicit\n\nSub Merger()\n    Dim mergeObj As Object, dirObj As Object, filesObj As Object, everyObj As Object\n    Dim targetSht As Worksheet\n\n    Set targetSht = ThisWorkbook.Worksheets(1)\n    Application.ScreenUpdating = False\n\n    Set mergeObj = CreateObject(\"Scripting.FileSystemObject\")\n\n    Set dirObj = mergeObj.Getfolder(\"C:\\Users\\Vincent\\Desktop\\856\")\n    Set filesObj = dirObj.Files\n    For Each everyObj In filesObj\n        Select Case mergeObj.GetExtensionName(everyObj)\n            Case \"csv\" ' handle only \"csv\" files (you can extend the list of allowed extensions)\n                With Workbooks.Open(everyObj).Worksheets(1) ' open current file as a workbook and reference its first worksheet \n                    With Intersect(.UsedRange, .UsedRange.Offset(1)) ' reference referenced worksheet \"used\" range except its first row\n                        If targetSht.UsedRange.Rows(targetSht.UsedRange.Rows.Count).Row + .Rows.Count &lt;= targetSht.Rows.Count Then ' if target sheet has room for current file rows \n                            .Copy targetSht.Cells(targetSht.Rows.Count, 1).End(xlUp).Offset(1)\n                        Else\n                            MsgBox \"not enough room in \" &amp; targetSht.Name &amp; \" for \" &amp; everyObj.Name\n                        End If\n                    End With\n                    .Parent.Close False\n                End With\n        End Select\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 7704959, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212629008864379/picture?type=large", "display_name": "Vincent", "link": "https://stackoverflow.com/users/7704959/vincent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1527144641, "creation_date": 1527098440, "last_edit_date": 1527098605, "question_id": 50494714, "link": "https://stackoverflow.com/questions/50494714/extending-the-range", "title": "Extending the Range", "body": "<p>Below is a code to merge multiple workbooks into a single workbook. However, the files that are being extracted from the local folder comes up incomplete once the process is done. My guess is the workbooks/files in that local folder far exceeds the range that's in the code.</p>\n\n<p>How do I extend the range, preferably \"unlimited\" or to the maximum limit of excel to transfer and combine the workbooks as much as possible?</p>\n\n<p>Below is the code that I use.</p>\n\n<p>Please advise and our help is much appreciated.</p>\n\n<p>Vincent</p>\n\n<pre><code>Sub Merger()\nDim bookList As Workbook\nDim mergeObj As Object, dirObj As Object, filesObj As Object, everyObj As Object\nApplication.ScreenUpdating = False\nSet mergeObj = CreateObject(\"Scripting.FileSystemObject\")\n\nSet dirObj = mergeObj.Getfolder(\"C:\\Users\\Vincent\\Desktop\\856\")\n\nSet filesObj = dirObj.Files\nFor Each everyObj In filesObj\nSet bookList = Workbooks.Open(everyObj)\n\nRange(\"A2:IV\" &amp; Range(\"A65536\").End(xlUp).Row).Copy\n\nThisWorkbook.Worksheets(1).Activate\n\nRange(\"A65536\").End(xlUp).Offset(1, 0).PasteSpecial\n\nApplication.CutCopyMode = False\nbookList.Close\n\nApplication.DisplayAlerts = False\n\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "listbox", "userform"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9298223"}, "edited": false, "score": 0, "creation_date": 1527103851, "post_id": 50494537, "comment_id": 88004983, "body": "Is <code>ProjectInformation</code> a worksheet or the named range?  If it is a range are you sure the <code>H</code> is referring to the correct column.  For example <code>Range(&quot;B:B&quot;).Range(&quot;H2&quot;)</code> refers to <code>Range(&quot;I2&quot;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 5010, "user_id": 9754169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/785875bd9271c02795b886d3a9c65331?s=128&d=identicon&r=PG&f=1", "display_name": "Yuca", "link": "https://stackoverflow.com/users/9754169/yuca"}, "is_accepted": false, "score": 1, "last_activity_date": 1527103514, "last_edit_date": 1527103514, "creation_date": 1527100180, "answer_id": 50495157, "question_id": 50494537, "link": "https://stackoverflow.com/questions/50494537/for-each-or-named-range-to-populate-listbox/50495157#50495157", "title": "For each or Named Range to populate ListBox", "body": "<p>There is no need to loop, you can pass the range as the source of the listbox</p>\n\n<pre><code>Program_ListBox.List = Range(\"H2:H\" &amp; Lr)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 167, "user_id": 9630197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d5cd6a208cf541aea4da0c87ac2e3e?s=128&d=identicon&r=PG&f=1", "display_name": "SB999", "link": "https://stackoverflow.com/users/9630197/sb999"}, "edited": false, "score": 0, "creation_date": 1527146893, "post_id": 50495975, "comment_id": 88019137, "body": "Works perfectly - thank you very much for your time, the explanation is much appreciated as well!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9298223"}, "is_accepted": true, "score": 0, "last_activity_date": 1527103189, "creation_date": 1527103189, "answer_id": 50495975, "question_id": 50494537, "link": "https://stackoverflow.com/questions/50494537/for-each-or-named-range-to-populate-listbox/50495975#50495975", "title": "For each or Named Range to populate ListBox", "body": "<p><code>Range(\"H2:H\" &amp; Lr)</code> references the cells on the <code>ActiveSheet</code>.  You should always fully qualify your references.</p>\n\n<pre><code>With ProjectInformation\n    If Len(.Range(\"H2\").Value) = 7 Then\n        For Each C In .Range(\"H2\", .Range(\"H\" &amp; .Rows.Count).End(xlUp))\n            With Program_ListBox\n                .AddItem C.Value\n            End With\n        Next C\n    End If\nEnd With\n</code></pre>\n\n<p>There is no need loop the cells to the add the values to the listbox.  You can assign the <code>Range().Value</code> array directly to the <code>Listbox.List</code> array.</p>\n\n<pre><code> With ProjectInformation\n    If Len(.Range(\"H2\").Value) = 7 Then\n        Program_ListBox.List = .Range(\"H2\", .Range(\"H\" &amp; .Rows.Count).End(xlUp)).Value\n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 9630197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d5cd6a208cf541aea4da0c87ac2e3e?s=128&d=identicon&r=PG&f=1", "display_name": "SB999", "link": "https://stackoverflow.com/users/9630197/sb999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 634, "favorite_count": 0, "accepted_answer_id": 50495975, "answer_count": 2, "score": 0, "last_activity_date": 1527109829, "creation_date": 1527097752, "last_edit_date": 1531164843, "question_id": 50494537, "link": "https://stackoverflow.com/questions/50494537/for-each-or-named-range-to-populate-listbox", "title": "For each or Named Range to populate ListBox", "body": "<p>All I am trying to populate a listbox with a For Each loop which iterates through the rows. The for each loop is going through the items in a Named range (ProgramIDs).</p>\n\n<p>The current code I am using is </p>\n\n<pre><code>If Len(ProjectInformation.Range(\"H2\").Value) = 7 Then\n\n    Dim Lr As Long\n    Lr = Range(\"H1048576\").End(xlUp).Row\n    For Each C In Range(\"H2:H\" &amp; Lr)\n        With Program_ListBox\n            .AddItem C.Value\n        End With\n    Next C\n\nEnd If\n</code></pre>\n\n<p>I fear this is a very basic question however after researching the website / google I simply cannot get this simple task to function. </p>\n\n<p>Any help would be appreciated. </p>\n"}, {"tags": ["vba", "excel", "gantt-chart"], "comments": [{"owner": {"reputation": 1026, "user_id": 8788388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j4tnBdMaXfk/AAAAAAAAAAI/AAAAAAACwcU/Jg67BYcCeW0/photo.jpg?sz=128", "display_name": "Hakan ERDOGAN", "link": "https://stackoverflow.com/users/8788388/hakan-erdogan"}, "edited": false, "score": 0, "creation_date": 1527098060, "post_id": 50494434, "comment_id": 88002037, "body": "The relationship between Machine1 and tasks are not clear. How will we put tasks into gantt chart, could you revise your 2nd screenshot to show this?"}, {"owner": {"reputation": 3, "user_id": 9835919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33566be0f1a7b75c901060b08ac95267?s=128&d=identicon&r=PG&f=1", "display_name": "A. Rojas", "link": "https://stackoverflow.com/users/9835919/a-rojas"}, "reply_to_user": {"reputation": 1026, "user_id": 8788388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j4tnBdMaXfk/AAAAAAAAAAI/AAAAAAACwcU/Jg67BYcCeW0/photo.jpg?sz=128", "display_name": "Hakan ERDOGAN", "link": "https://stackoverflow.com/users/8788388/hakan-erdogan"}, "edited": false, "score": 0, "creation_date": 1527106496, "post_id": 50494434, "comment_id": 88006249, "body": "I&#39;ve updated the question, I added what the final answer should look like. The Machine 1 makes all the task, so all of the tasks should be in a gantt like type chart where you can see the tasks that the Machine 1 will be making, in this case &quot;a&quot;, &quot;b&quot;, and &quot;c&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9835919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33566be0f1a7b75c901060b08ac95267?s=128&d=identicon&r=PG&f=1", "display_name": "A. Rojas", "link": "https://stackoverflow.com/users/9835919/a-rojas"}, "edited": false, "score": 0, "creation_date": 1527145705, "post_id": 50496589, "comment_id": 88018385, "body": "I had to modify the conditions a bit so that way there could be blank cells if the range said so, but the logic was just what I needed. Thank you very much!"}], "tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": true, "score": 0, "last_activity_date": 1527105765, "creation_date": 1527105765, "answer_id": 50496589, "question_id": 50494434, "link": "https://stackoverflow.com/questions/50494434/color-a-specific-range-of-cells-in-the-same-row/50496589#50496589", "title": "Color a specific range of cells in the same row", "body": "<p>If I understand what you want correctly, this can be done with conditional formatting:</p>\n\n<p>Use four conditions, one for each of the following formulas:</p>\n\n<pre><code>=COLUMN(AK6)&lt;=$D$7+37\n=COLUMN(AK6)&lt;=$D$6+37\n=COLUMN(AK6)&lt;=$D$5+37\n=COLUMN(AK6)&lt;=$D$4+37\n</code></pre>\n\n<p>and apply them in that order to <code>$AK$6:$BZ$6</code></p>\n"}], "owner": {"reputation": 3, "user_id": 9835919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33566be0f1a7b75c901060b08ac95267?s=128&d=identicon&r=PG&f=1", "display_name": "A. Rojas", "link": "https://stackoverflow.com/users/9835919/a-rojas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 50496589, "answer_count": 1, "score": -1, "last_activity_date": 1527106193, "creation_date": 1527097289, "last_edit_date": 1527106193, "question_id": 50494434, "link": "https://stackoverflow.com/questions/50494434/color-a-specific-range-of-cells-in-the-same-row", "title": "Color a specific range of cells in the same row", "body": "<p>Similar to a Gantt Chart but not quite the same, I'm trying to color a variable range of cells on the same row.</p>\n\n<p><a href=\"https://i.stack.imgur.com/YrL9A.png\" rel=\"nofollow noreferrer\">As you can see I have a variable number of tasks and a variable start and end for each task</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/8DNGz.png\" rel=\"nofollow noreferrer\">I've created a simple time series where the \"Machine 1\", which is in the row number 6, is making all the tasks. The time series is in the row number 3.</a></p>\n\n<p>So basically, I need to color the ranges given by the tasks table in the Machine 1 row, using that time series as a reference to start coloring the cells. Each task has to have a different color.</p>\n\n<p>As I'm a beginner in VBA, I've been trying to do this using a formula:</p>\n\n<pre><code>=IF(AND($C4&lt;=AK$3;$D4&gt;=AK$3);1;0)\n</code></pre>\n\n<p>Being C4 the start of the task, AK3 the place of the time series right now, and D4 the end of the task. Then I would fill the whole Machine 1 row. This would give a 1 in the range of the task and a 0 before and after the task, then I could format the row and color the cell by the given value in each cell. (1 color and 0 blank)</p>\n\n<p>The problem is that this only works for one task and I really don't know how to change the formula to add the other tasks. I'm pretty sure this can be done in VBA but, like I said, I'm still a beginner. Please help me</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ngczl.png\" rel=\"nofollow noreferrer\">The final answer should look like this. The color doesn't matter, it's how to color the variable ranges automatically the problem</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1527096276, "post_id": 50494082, "comment_id": 88001170, "body": "Once you have named a sheet <code>Filter Data</code> you couldn&#39;t run it again because that sheet already exists. Does each new sheet need a new name?"}, {"owner": {"reputation": 47, "user_id": 6500122, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0c0ce4bbbd979de5044576cab35fb3f5?s=128&d=identicon&r=PG&f=1", "display_name": "Avi22", "link": "https://stackoverflow.com/users/6500122/avi22"}, "reply_to_user": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1527097095, "post_id": 50494082, "comment_id": 88001568, "body": "No, we can call it as we want.. even 1..2..3...4"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1527102201, "post_id": 50494498, "comment_id": 88004121, "body": "<code>Workbook.Sheets.Add</code> also happens to return an object reference pointing to the <code>Worksheet</code> object that was added, so a better solution would be to hold that reference in a local variable, and code against that variable instead of assuming <code>ActiveSheet</code> will remain active throughout the execution of the code."}], "tags": [], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "is_accepted": true, "score": 0, "last_activity_date": 1527097577, "creation_date": 1527097577, "answer_id": 50494498, "question_id": 50494082, "link": "https://stackoverflow.com/questions/50494082/multiple-runs-of-vba-code/50494498#50494498", "title": "Multiple runs of VBA code", "body": "<p>When you create a new sheet in Excel it becomes the active sheet, so instead of specifically selecting sheet 2 you can use <code>activesheet</code></p>\n\n<pre><code>Sheets.Add After:=ActiveSheet\nWith ActiveSheet\n    .Range(\"A1\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n    .Columns(\"A:A\").EntireColumn.AutoFit\n    .Cells.Select\n    .Cells.EntireColumn.AutoFit\n    .Rows(\"1:1\").Select\n    .Application.CutCopyMode = False\n    With Selection\n         With .Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .Color = 15773696\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n        End With\n        .AutoFilter\n    End With\n    .Columns(\"A:A\").EntireColumn.AutoFit\n    .Range(\"A2\").Select\nEnd With\n</code></pre>\n\n<p>Then you can manually rename all your new sheets.</p>\n\n<p>Alternatively if you want to loop a set number of times you could wrap the whole thing in a loop and increment sheet names:</p>\n\n<pre><code>For i = 1 to 4\n    Sheets.Add After:=ActiveSheet\n    With ActiveSheet\n        .Name = \"FilterData \" &amp; i\n*rest of the code here*\n    End With\nNext i\n</code></pre>\n\n<p>This will create 4 sheets called FilterData 1, 2, 3 etc, but again this will throw an error if you already have sheets called those things.</p>\n"}], "owner": {"reputation": 47, "user_id": 6500122, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0c0ce4bbbd979de5044576cab35fb3f5?s=128&d=identicon&r=PG&f=1", "display_name": "Avi22", "link": "https://stackoverflow.com/users/6500122/avi22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 50494498, "answer_count": 1, "score": 0, "last_activity_date": 1527098436, "creation_date": 1527095941, "last_edit_date": 1531164843, "question_id": 50494082, "link": "https://stackoverflow.com/questions/50494082/multiple-runs-of-vba-code", "title": "Multiple runs of VBA code", "body": "<p>I have a code that I want to run several times but for now I can run it only once unless I made some changes at data sheet name.</p>\n\n<p>My code:</p>\n\n<pre><code>Public Sub MyFilter()\n    Dim lngStart As Date, lngEnd As Date\n    lngStart = Range(\"b2\").Value 'assume this is the start date\n    lngEnd = Range(\"b3\").Value 'assume this is the end date\n    Range(\"q:q\").AutoFilter field:=1, _\n        Criteria1:=\"&gt;=\" &amp; lngStart, _\n        Operator:=xlAnd, _\n        Criteria2:=\"&lt;=\" &amp; lngEnd\n\n\n           Range(\"A1:s3000\").Select\n    Range(\"A:A\").Activate\n    Selection.Copy\n    Sheets.Add After:=ActiveSheet\n    Sheets(\"Sheet2\").Select\n    Sheets(\"Sheet2\").Name = \"FilterData\"\n    Range(\"A1\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Columns(\"A:A\").EntireColumn.AutoFit\n    Cells.Select\n    Cells.EntireColumn.AutoFit\n    Rows(\"1:1\").Select\n    Application.CutCopyMode = False\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 15773696\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Selection.AutoFilter\n    Columns(\"A:A\").EntireColumn.AutoFit\n    Range(\"A2\").Select\n\nEnd Sub\n</code></pre>\n\n<p>Before I execute it I create sheet2 manually but if I want to run it again I cant because I already have \"FilterData\" sheet data name.</p>\n\n<p>How can I modify the code to:\n1. Run it without the need to enter \"sheet2\" manually.\n2. To run it more than once.\nThanks! </p>\n"}, {"tags": ["excel", "powerpoint", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1527094885, "post_id": 50493771, "comment_id": 88000482, "body": "a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> will help us help you a lot better."}, {"owner": {"reputation": 1, "user_id": 9835438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d7cddff295149b07e2854cb89109dc?s=128&d=identicon&r=PG&f=1", "display_name": "JP11", "link": "https://stackoverflow.com/users/9835438/jp11"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1527096296, "post_id": 50493771, "comment_id": 88001180, "body": "@ScottHoltzman does the revised question work?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1527169928, "post_id": 50493771, "comment_id": 88034463, "body": "instead of using <code>ActivePresentation</code> and <code>ActiveWindow</code> bind the <b>specific</b> powerpoint file to a variable and run the code of that. Also, avoid <code>Selection</code>. Tie a variable to that specific object (by name, say) and run the code against that."}], "owner": {"reputation": 1, "user_id": 9835438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d7cddff295149b07e2854cb89109dc?s=128&d=identicon&r=PG&f=1", "display_name": "JP11", "link": "https://stackoverflow.com/users/9835438/jp11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527174414, "creation_date": 1527094734, "last_edit_date": 1531161705, "question_id": 50493771, "link": "https://stackoverflow.com/questions/50493771/excel-issues-with-positioning-table-after-pasting-in-ppt", "title": "Excel issues with positioning table after pasting in PPT", "body": "<p>Revised...</p>\n\n<p>I am able to copy and paste an embedded table from Excel to PPT, however I am having difficulty positioning the table. The code below pastes the table, but than generates a <em>\"Run-time error of Selection.ShapeRange: Invalid Request.\"</em> </p>\n\n<p>I have limited experience and have been spent the past few weeks trying to figure it out, but do not know where to go from here.</p>\n\n<pre><code> 'Copy Range from Excel\n Range(\"B4:E11\").Copy\n\n 'Paste Embeded File into Excel\n     PPAPP.ActivePresentation.Application.CommandBars.ExecuteMso \"PasteExcelTableSourceFormatting\"\n     PPAPP.ActivePresentation.Application.CommandBars.ReleaseFocus\n    End With\n\n'Position Table in Excel \n   With PPAPP.ActiveWindow.Selection.ShapeRange(1)\n      .Name = \"SummaryTable\"\n      .Left = 1.08 * 72\n       .Top = 1.9 * 72\n      .LockAspectRatio = msoFalse\n      .Height = 5.11 * 72\n      .Width = 11.8 * 72\n        End With\n</code></pre>\n"}, {"tags": ["excel", "vba", "variant"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1527095387, "post_id": 50493652, "comment_id": 88000716, "body": "This is answered here: <a href=\"https://stackoverflow.com/questions/21572437/vba-variant-how-to-handle-class-vs-primitive-types\" title=\"vba variant how to handle class vs primitive types\">stackoverflow.com/questions/21572437/&hellip;</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527095672, "post_id": 50493652, "comment_id": 88000878, "body": "Const vbObject = 9 in assoc with ^^ link. But noting your question is <b>specifically</b> about Dim not testing ...."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1527095813, "post_id": 50493652, "comment_id": 88000960, "body": "<code>Variant</code> exists <i>specifically</i> to lift the compile-time type constraints that implicit type conversions don&#39;t already mess up... Might as well take a <code>String</code>, and convert from there."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1527096674, "post_id": 50493652, "comment_id": 88001355, "body": "Why does it matter what it&#39;s <b>&quot;not&quot;</b>?"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 7, "last_activity_date": 1527096695, "creation_date": 1527096695, "answer_id": 50494265, "question_id": 50493652, "link": "https://stackoverflow.com/questions/50493652/variant-but-not-an-object/50494265#50494265", "title": "Variant but not an Object", "body": "<p>I don't see what's wrong with using a <code>Variant</code> and throwing an <em>invalid procedure call or argument</em> run-time error 5, which pretty much <em>literally</em> says \"this procedure was invoked with an invalid argument\", given <code>IsObject(theParameter)</code> returning <code>True</code>.</p>\n\n<p><code>Variant</code> exists <em>specifically</em> to lift the compile-time type constraints so that VBA can deal with foreign types such as <code>IUnknown</code> and whatnot: there's no way you can use a <code>Variant</code> <em>and</em> enforce any kind of compile-time check against it - <em>by definition</em> a <code>Variant</code>'s type is only resolved at run-time.</p>\n\n<p>The idiomatic way to solve this, is to use good, meaningful names for both your procedure and their parameters. Pretty hard to recommend anything with the examples you've got though.</p>\n\n<p>There is no \"variant but not an object\" type, and you can't use a <code>Variant</code> and expect any kind of type validation at compile-time.</p>\n"}], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 50494265, "answer_count": 1, "score": 4, "last_activity_date": 1566923922, "creation_date": 1527094320, "last_edit_date": 1566923922, "question_id": 50493652, "link": "https://stackoverflow.com/questions/50493652/variant-but-not-an-object", "title": "Variant but not an Object", "body": "<p>If I know a bit of data is going to be an Object, but I don't know what kind, I can pass it to a function or routine like this:</p>\n\n<pre><code>Sub mySubExpectingAnObject(myVal As Object)\n</code></pre>\n\n<p>Which is more explicit than</p>\n\n<pre><code>Sub mySubExpectingAnObject(myVal As Variant)\n</code></pre>\n\n<p>And should be preferred even if both work</p>\n\n<p>If instead I know the bit of data is <em>not</em> an object, but could be anything else (<code>Long</code>, <code>Double</code>, <code>String</code> etc.), is there any way of <code>Dim</code>ing the argument as not an object. E.g</p>\n\n<pre><code>Sub mySubExpectingNotAnObject(myVal As NotObject)\n</code></pre>\n\n<p>Since if I use <code>Variant</code> here, there will be no automatic anti-object check. Does such a type exist; one that can encapsulate any non-object datatype exclusively? Is there a workaround other than just </p>\n\n<pre><code>If isObject(myVal) Then Err.Raise 5\n</code></pre>\n\n<p>or similar?</p>\n"}, {"tags": ["excel", "vba", "performance", "lag"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 1, "creation_date": 1527094930, "post_id": 50493534, "comment_id": 88000500, "body": "What happens if you delete your IE object and create a new one?"}, {"owner": {"reputation": 63, "user_id": 9721733, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pLYoBb7RkD4/AAAAAAAAAAI/AAAAAAAAADU/tYNLXKvJMoQ/photo.jpg?sz=128", "display_name": "Rick Jeffries", "link": "https://stackoverflow.com/users/9721733/rick-jeffries"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1527097234, "post_id": 50493534, "comment_id": 88001649, "body": "Does not work.  I tried shutting down Excel and IE and reopening.  Does not change anything, the IE is still sluggish.  Only thing that works is a complete reboot."}, {"owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "edited": false, "score": 0, "creation_date": 1527102248, "post_id": 50493534, "comment_id": 88004147, "body": "<a href=\"https://stackoverflow.com/questions/50296186/ie-in-vba-code-lose-connection/50297406#50297406\" title=\"ie in vba code lose connection\">stackoverflow.com/questions/50296186/&hellip;</a> take a look at answer here and see if it helps"}, {"owner": {"reputation": 5895, "user_id": 2834978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05b09a797fd0c59d1627b30fb4cdba01?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Mu&#241;oz", "link": "https://stackoverflow.com/users/2834978/luis-mu%c3%b1oz"}, "edited": false, "score": 0, "creation_date": 1527116145, "post_id": 50493534, "comment_id": 88009969, "body": "Can you reopen the IE windows every n requests? May be that workarounds the resources leak."}], "owner": {"reputation": 63, "user_id": 9721733, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pLYoBb7RkD4/AAAAAAAAAAI/AAAAAAAAADU/tYNLXKvJMoQ/photo.jpg?sz=128", "display_name": "Rick Jeffries", "link": "https://stackoverflow.com/users/9721733/rick-jeffries"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1527094273, "creation_date": 1527093839, "last_edit_date": 1527094273, "question_id": 50493534, "link": "https://stackoverflow.com/questions/50493534/auto-refreshing-browser-slows-over-time", "title": "Auto refreshing browser slows over time", "body": "<p>I have an Excel VBA program that uses an open IE window with a web page that automatically refreshes every 120 seconds.  At the beginning of a fresh reboot/cycle, the web page has data that takes about 10 seconds to completely load, as soon as it's complete, the VBA program grabs the data.</p>\n\n<p>Over time, the time it takes for the data to completely show on the browser takes longer and longer.  Eventually after running for 36-48 hours, the browser takes longer than 120 seconds to complete, leaving my program dead in the wind.  The only way to get it back working properly is a complete shutdown of the computer.</p>\n\n<p>Is the computer just running out of memory over time? I shut off caching, that didn't appear to change anything.  What am I missing?</p>\n"}, {"tags": ["vba", "excel", "compiler-errors"], "comments": [{"owner": {"reputation": 1156, "user_id": 7437143, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6e6a10d62061d1dd0ecb2d0b760eb7d?s=128&d=identicon&r=PG&f=1", "display_name": "a.t.", "link": "https://stackoverflow.com/users/7437143/a-t"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1527092132, "post_id": 50492838, "comment_id": 87999045, "body": "Dear @Vityata, thank you for your suggestion on an estimation method of the compiled subroutine file size. From the information and forum posts I have seen so far the number of lines indeed appears to provide a good indicator to estimate the compiled subroutine file size. I think the number of lines in my subroutine is off-topic."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9298223"}, "edited": false, "score": 0, "creation_date": 1527097618, "post_id": 50493413, "comment_id": 88001820, "body": "<code>Cyclomatic Complexity</code> would be a great metric to include on a Dating site. Great post.  Moving forward, I will have to take a close look at both <code>Cyclomatic Complexity</code> and  <code>Maximum Nesting</code> as I write and refactor code.  That being said, I&#39;m still going to be a &quot;Lines of Code Nazi&quot; because there is &quot;personal sense of accomplishment&quot; when I reduce the overall lines of code."}, {"owner": {"reputation": 1156, "user_id": 7437143, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6e6a10d62061d1dd0ecb2d0b760eb7d?s=128&d=identicon&r=PG&f=1", "display_name": "a.t.", "link": "https://stackoverflow.com/users/7437143/a-t"}, "edited": false, "score": 0, "creation_date": 1527103782, "post_id": 50493413, "comment_id": 88004944, "body": "@Mathieu Guindon, Thank you for your elaborate answer. From  your answer and <a href=\"https://en.wikipedia.org/wiki/Abstraction_(computer_science)\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Abstraction_(computer_science)</a> I currently understand that the size of the compiled code is meaningless because the difference in level of abstraction renders the effects of for example refactoring the subroutine code as practically untraceable. Thank you for the pointers to tools that allow me to work on the XY-problem more effectively! I am a great fan of the work put into Rubberduck, and I will be more persistent in applying it."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1156, "user_id": 7437143, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6e6a10d62061d1dd0ecb2d0b760eb7d?s=128&d=identicon&r=PG&f=1", "display_name": "a.t.", "link": "https://stackoverflow.com/users/7437143/a-t"}, "edited": false, "score": 1, "creation_date": 1527104500, "post_id": 50493413, "comment_id": 88005302, "body": "@a.t. You&#39;ll probably want to keep an eye out on the progress of the rewriting of the <i>Extract Method</i> refactoring tool ;-)"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1527113076, "post_id": 50493413, "comment_id": 88009116, "body": "I love the sentiment, but this doesn\u2019t answer the question Mug."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 12, "last_activity_date": 1527114718, "last_edit_date": 1527114718, "creation_date": 1527093390, "answer_id": 50493413, "question_id": 50492838, "link": "https://stackoverflow.com/questions/50492838/how-can-one-see-the-size-of-the-compiled-subroutine-in-vba-excel-2016/50493413#50493413", "title": "How can one see the size of the compiled subroutine in VBA Excel 2016?", "body": "<p>No, you can't do that. VBA is compiled in several stages, it's part p-code, part interpreted, and at the end of the day the size in kb of the compiled procedure isn't what you need to work on.</p>\n\n<hr>\n\n<p>You need to read about <strong>Abstraction</strong>, urgently. A procedure that triggers this compiler error is over 10K lines of code. A healthy procedure at the appropriate abstraction level might be somewhere between 500 and a thousand times smaller than that (not kidding) - <strong>the size of the compiled code is absolutely meaningless</strong>.</p>\n\n<p>If you're worrying about the size of the compiled code, you're not writing the code for a human.</p>\n\n<p>Code isn't written for a compiler to crunch and a runtime environment to run. Code is written for a human maintainer to read, understand, follow, debug, modify, extend, etc. Without any level of abstraction, code is a boring, excruciatingly mind-numbing series of executable statements that are invariably redundant, inefficient, and annoyingly bug-prone.</p>\n\n<p>There are 3rd-party tools you can use to analyze VBA code. MZ-Tools 3.0 was free, but the latest version isn't. It has a feature that can tell you how many lines of code are in each procedure of each module, how much of it is commented-out, whether you have unused variables, etc.</p>\n\n<p><a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> is free and open-source, under active development (disclaimer: I own the project's repository), and has a <em>code metrics</em> feature (distinct from <em>code inspections</em>) that can probably help you identify the most problematic areas (although, parsing a 10K-liner module might take a while):</p>\n\n<p><img src=\"https://i.stack.imgur.com/WEy45.png\" alt=\"Rubberduck Code Metrics\"></p>\n\n<p><em>Lines</em> is your \"lines of code\" metric; <em>Cyclomatic Complexity</em> is a rough indicator of the different possible execution paths in your code (how much sense that metric makes at a module-level aggregate is debatable); <em>Maximum Nesting</em> is also an indicator of how badly \"arrow-shaped\" code might be.</p>\n\n<p>High values in these metrics are a sign that you may need to <em>extract methods</em>.</p>\n"}], "owner": {"reputation": 1156, "user_id": 7437143, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6e6a10d62061d1dd0ecb2d0b760eb7d?s=128&d=identicon&r=PG&f=1", "display_name": "a.t.", "link": "https://stackoverflow.com/users/7437143/a-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1295, "favorite_count": 1, "accepted_answer_id": 50493413, "answer_count": 1, "score": 3, "last_activity_date": 1527114718, "creation_date": 1527091162, "last_edit_date": 1527104929, "question_id": 50492838, "link": "https://stackoverflow.com/questions/50492838/how-can-one-see-the-size-of-the-compiled-subroutine-in-vba-excel-2016", "title": "How can one see the size of the compiled subroutine in VBA Excel 2016?", "body": "<p>After finding a \"procedure to large\" error on a specific subroutine of a module, I am refactoring the code in the module. I was curious on how effective the refactoring is at reducing the compiled code size. </p>\n\n<p>So I was wondering if there is a way to see the size of the compiled code of a subroutine in a Module of Excel 2016?</p>\n\n<p>My attempts so far have been limited to searching online for methods to determine the size of a compiled module or subroutine in VBA.</p>\n\n<p>It led me to the limits of VBA as listed in <a href=\"https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-basic-6/aa240819(v=vs.60)\" rel=\"nofollow noreferrer\">here</a>. It does not mention a way to see the size of the procedure compiled, nor does it mention whether that is (practically) possible.</p>\n\n<p>(As was mentioned in the comments, the current maximum size of the compiled procedure is 64K as stated <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/procedure-too-large\" rel=\"nofollow noreferrer\">here</a>.)</p>\n\n<ol>\n<li>I think the compiled procedure size is not 1 on 1 related to the number of lines. (Because that does not take into account short or long lines. But I am currently unsure about how the vba-procure is compiled, and consequently how lines contribute to the compiled file size, otherwise a solution could possibly be to compute the compiled file size.)</li>\n<li>Nor is the procedure 1 on 1 dependent on the size of the code as stored as a '.txt' file. (because it can contain comments which do not contribute to the compiled code size)</li>\n</ol>\n\n<p><strong>Disclamer</strong> - I am well aware of the shortcomings of the old code I am modifying. That it is poorly written, I think this quote of Bill Gates illustrates it quite well:</p>\n\n<blockquote>\n  <p>Measuring programming progress by lines of code is like measuring\n  aircraft building progress by weight.</p>\n</blockquote>\n\n<p>I think refactoring, and breaking the code up in shorter subroutines is an appropriate first step. To monitor this process, in combination with the hard bottleneck presented by VBA as the <code>Procedure too long</code>- error led me to this question.</p>\n"}, {"tags": ["vba", "excel", "error-handling"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 2, "creation_date": 1527091299, "post_id": 50492777, "comment_id": 87998597, "body": "You&#39;re not exiting your procedure to deal with the error and then <code>resuming</code> so your error flag isn&#39;t getting reset.... I should expand that to an answer. :)"}], "answers": [{"comments": [{"owner": {"reputation": 382, "user_id": 4616944, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a221bbef1d153d8670d9b352930df4b?s=128&d=identicon&r=PG&f=1", "display_name": "Devsman", "link": "https://stackoverflow.com/users/4616944/devsman"}, "edited": false, "score": 0, "creation_date": 1527093077, "post_id": 50493061, "comment_id": 87999567, "body": "Excellent. Thank you."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 382, "user_id": 4616944, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a221bbef1d153d8670d9b352930df4b?s=128&d=identicon&r=PG&f=1", "display_name": "Devsman", "link": "https://stackoverflow.com/users/4616944/devsman"}, "edited": false, "score": 0, "creation_date": 1527093190, "post_id": 50493061, "comment_id": 87999636, "body": "Feel free to accept as answer if it is, although it&#39;s generally worth waiting  a bit to see if anything better turns up. :)"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 3, "last_activity_date": 1527092116, "creation_date": 1527092116, "answer_id": 50493061, "question_id": 50492777, "link": "https://stackoverflow.com/questions/50492777/why-does-only-one-of-my-vba-error-handlers-handle-errors/50493061#50493061", "title": "Why does only one of my VBA error handlers handle errors?", "body": "<p>Move your error handling outside of the main body of code.  It should go between an <code>Exit Sub</code> and <code>End Sub</code>.  </p>\n\n<p>This code will not deal with the <code>Type mismatch</code> error and will never display the \"Long Date Error\" or \"Finding\" messages.</p>\n\n<pre><code>Sub Test()\n\n    Dim Short_Date As Date\n    Dim Long_Date As Date\n\n    On Error GoTo Short_Date_Error\n        Short_Date = 1 / 0 'Overflow\n        GoTo Long_Date\nShort_Date_Error:\n    MsgBox \"Short Date Error\"\nLong_Date:\n    On Error GoTo Long_Date_Error\n        Long_Date = Int(\"A\") 'Type mismatch\n        GoTo Date_Find\nLong_Date_Error:\n    MsgBox \"Long Date Error\"\nDate_Find:\n    MsgBox \"Finding\"\n\nEnd Sub  \n</code></pre>\n\n<p>This code on the other hand moves outside the body of code, deals with the error and then resumes:  </p>\n\n<pre><code>Sub Test1()\n\n    Dim Short_Date As Date\n    Dim Long_Date As Date\n\n    On Error GoTo Short_Date_Error\n        Short_Date = 1 / 0 'Overflow\n\nLong_Date:\n    On Error GoTo Long_Date_Error\n        Long_Date = Int(\"A\") 'Type mismatch\n\nDate_Find:\n    MsgBox \"Finding\"\n\nExit Sub\nShort_Date_Error:\n    MsgBox \"Short Date Error\"\n    Resume Long_Date\n\nLong_Date_Error:\n    MsgBox \"Long Date Error\"\n    Resume Date_Find\n\nEnd Sub  \n</code></pre>\n\n<p>This <a href=\"https://stackoverflow.com/questions/1038006/good-patterns-for-vba-error-handling\">link</a> seems to have a fair amount regarding error handling.</p>\n"}], "owner": {"reputation": 382, "user_id": 4616944, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a221bbef1d153d8670d9b352930df4b?s=128&d=identicon&r=PG&f=1", "display_name": "Devsman", "link": "https://stackoverflow.com/users/4616944/devsman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 50493061, "answer_count": 1, "score": 0, "last_activity_date": 1527092116, "creation_date": 1527090947, "question_id": 50492777, "link": "https://stackoverflow.com/questions/50492777/why-does-only-one-of-my-vba-error-handlers-handle-errors", "title": "Why does only one of my VBA error handlers handle errors?", "body": "<p>This is kind of an XY problem, but I found it odd in itself.</p>\n\n<p>Here is some code I put together as part of a solution to search for dates:</p>\n\n<pre><code>...\n    Dim Short_Date As Date\n    Dim Long_Date As Date\n    Dim Not_A_Short_Date As Boolean\n    Dim Not_A_Long_Date As Boolean\n    Not_A_Short_Date = False\n    Not_A_Long_Date = False\n    On Error GoTo Short_Date_Error\n        Short_Date = CDate(Format(Find_What, \"Short Date\"))\n        GoTo Long_Date\nShort_Date_Error:\n        Not_A_Short_Date = True\nLong_Date:\n    On Error GoTo Long_Date_Error\n        Dim Temp\n        Temp = Format(Find_What, \"Long Date\")\n        Long_Date = CDate(Format(Find_What, \"Long Date\"))\n        GoTo Date_Find\nLong_Date_Error:\n        Not_A_Long_Date = True\nDate_Find:\n...\n</code></pre>\n\n<p>I found that the VBA runtime raises an error saying Type mismatch at the Long_Date = CDate(Format(Find_What, \"Long Date\")) line. Sure enough, Find_What was being passed in something that is not at all a date. Which, as luck would have it, is exactly the error I'm trying to catch.</p>\n\n<p>But when I step through, I found that the runtime jumps from Short_Date = CDate(Format(Find_What, \"Short Date\")) to Short_Date_Error without giving me the error window, while almost the same code (just with a \"Long Date\" instead of a \"Short Date\") with the same value of Find_What just a few lines below results in the error window.</p>\n\n<p>Does anybody know what might cause this?</p>\n\n<p>(Also, if there are any good resources on how to search for dates that would be great. I got the idea for this code from <a href=\"http://www.ozgrid.com/VBA/find-dates.htm\" rel=\"nofollow noreferrer\">the result of a Google search</a>.)</p>\n"}, {"tags": ["excel", "vba", "sorting", "ranking"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1527090681, "post_id": 50492674, "comment_id": 87998228, "body": "How do you want to handle <b>ties</b> ??"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1527091266, "post_id": 50492674, "comment_id": 87998574, "body": "you can sort a range based on a column, multi columns actually, and keep the data relevant to each respective row intact.  I am sure you can &quot;rank them in place instead&quot; if you wish, by running a comparison function.  I am just not sure why you are against sort, you can sort, rank, and then return it to the way it was in a the blink of an eye."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1527092752, "post_id": 50492674, "comment_id": 87999366, "body": "I demonstrated one example of sorting that would be extremely fast for you below, you probably don&#39;t need a multi line sort if you are going off one attribute like avg days.  If you want to write a sub to rank in place we can do that, but I guarantee it will be longer.  You can also create a pivot that will show you the top 10 or top # you specify and leave the data in place.  Many ways to &quot;skin the cat&quot; here."}, {"owner": {"reputation": 117, "user_id": 9825319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYs7i.png?s=128&g=1", "display_name": "Matt Gaydon", "link": "https://stackoverflow.com/users/9825319/matt-gaydon"}, "edited": false, "score": 0, "creation_date": 1527095011, "post_id": 50492674, "comment_id": 88000541, "body": "I&#39;m not necessarily &quot;against&quot; sort. I am an intern who is still learning how to utilize VBA for these tasks so that is why I need them in that form. In the real world I want the fastest and easiest and most efficient way to give me the results I need. For the purpose of this exercise however I need to utilize VBA. I am going to view your answer below and see if it clarified the issue for me. Thank you for your help!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9298223"}, "edited": false, "score": 0, "creation_date": 1527098287, "post_id": 50492674, "comment_id": 88002151, "body": "You can use the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheetfunction-rank-method-excel\" rel=\"nofollow noreferrer\">WorksheetFunction.Rank Method (Excel)</a>.  <code>Rank()</code> can be used either in the Worksheet or in VBA code.  If you have problems implementing it, post some code and I will be happy to help."}, {"owner": {"reputation": 117, "user_id": 9825319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYs7i.png?s=128&g=1", "display_name": "Matt Gaydon", "link": "https://stackoverflow.com/users/9825319/matt-gaydon"}, "edited": false, "score": 0, "creation_date": 1527103332, "post_id": 50492674, "comment_id": 88004698, "body": "I ended up doing something like that ^^^ , I &quot;cheated&quot; my way around it using the Record Macro function, turns out that&#39;s what my supervisor wanted me to do. Ha! But upon doing that it used a function very similar to what you listed. Another thing I looked at using was a Bubble Sort for anyone else curious on how to solve this problem."}], "answers": [{"comments": [{"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1527093011, "post_id": 50493095, "comment_id": 87999524, "body": "Obviously I have left some code out, please don&#39;t blast me for the line not being &quot;With wsBuild.Sort&quot; as other methods were also used in that block such as .Range and .Cells  - WWC"}, {"owner": {"reputation": 117, "user_id": 9825319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYs7i.png?s=128&g=1", "display_name": "Matt Gaydon", "link": "https://stackoverflow.com/users/9825319/matt-gaydon"}, "edited": false, "score": 0, "creation_date": 1527103245, "post_id": 50493095, "comment_id": 88004642, "body": "Thank you for that long and comprehensive response. Like I said I am still very much a beginner but I understand the concepts of what you&#39;re doing, which is all I can ask for at this point."}], "tags": [], "owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "is_accepted": true, "score": 1, "last_activity_date": 1527092883, "last_edit_date": 1527092883, "creation_date": 1527092240, "answer_id": 50493095, "question_id": 50492674, "link": "https://stackoverflow.com/questions/50492674/rank-a-list-of-values-largest-to-smallest-using-vba/50493095#50493095", "title": "Rank A List Of Values (Largest to Smallest) Using VBA", "body": "<p>I ripped this code out of Accounting Accrual - Invoicing true up Excel Application, it is one of many sorts on a data \"field\".</p>\n\n<p>You can do something similar.  To make this more clear for you to apply:\nwsBuild is a named sheet (in developer, you can call it directly regardless of worksheet name or position). \"twb\" just indicates that it is working in thisworkbook, as I am consolidating data from several workbooks (data exports, 3 in this case).</p>\n\n<p>twbNameCol is the col number for the vendor name found in a different function</p>\n\n<p>twbJobNumberCol is the col number for the sales order found in a different function</p>\n\n<p>twbTot1Col is the col number for the sales amount found in a different function</p>\n\n<p>If you want to find the headers dynamically just choose a number higher than your import template in a manner like this, this one accommodates for having 2 total column headers one for accrual and one for invoices, you may not to need to do something like this, since I export from a system I know the header names, or you can make your own, diff accrual is the last column I am looking to find the position on so I break the loop at that point:</p>\n\n<pre><code>twbTot1Col = 0\ntwbTot2Col = 0\n'First let's define the column positions\n    For j = 1 To 50\n        If InStr(wsBuild.Cells(1, j), \"Totals\") &gt; 0 And twbTot1Col = twbTot2Col Then\n            'It is the first time\n            twbTot1Col = j\n        ElseIf InStr(wsBuild.Cells(1, j), \"Totals\") &gt; 0 And twbTot1Col &lt;&gt; twbTot2Col Then\n            twbTot2Col = j\n        ElseIf InStr(wsBuild.Cells(1, j), \"JobNumber\") &gt; 0 Then\n            twbJobNumCol = j\n        ElseIf InStr(wsBuild.Cells(1, j), \"New VAP\") &gt; 0 Then\n            twbNewVAPCol = j\n        ElseIf InStr(wsBuild.Cells(1, j), \"New AP\") &gt; 0 Then\n            twbNewAPCol = j\n        ElseIf InStr(wsBuild.Cells(1, j), \"Name\") &gt; 0 Then\n            twbNameCol = j\n        ElseIf InStr(wsBuild.Cells(1, j), \"Diff Accrual\") &gt; 0 Then\n            twbDiffCol = j\n            j = 100 'Break loop\n        Else\n            'Do nothing\n        End If\n    Next j\n</code></pre>\n\n<p>twbLastRow is the last row in the data range (data range is 2 to LastRow)</p>\n\n<p>It is found like this:</p>\n\n<pre><code>twbLastRow = wsBuild.Cells(Rows.Count, 1).End(xlUp).Row\n</code></pre>\n\n<p>Here is an example of the sort code, there are some column insertion steps prior to this 1, 2, 3, so I only copied the sort</p>\n\n<pre><code>With wsBuild\n'4) Perform 3 line sort\n        .Sort.SortFields.Clear\n        .Sort.SortFields.Add Key:=.Range(.Cells(2, twbNameCol), .Cells(twbLastRow, twbNameCol)), _\n            SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n\n        .Sort.SortFields.Add Key:=.Range(.Cells(2, twbJobNumCol), .Cells(twbLastRow, twbJobNumCol)), _\n            SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n\n        .Sort.SortFields.Add Key:=.Range(.Cells(2, twbTot1Col), .Cells(twbLastRow, twbTot1Col)), _\n            SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\n\n\n         .Sort.SetRange .Range(.Cells(1, 1), .Cells(twbLastRow, twbDiffCol + 2))\n         .Sort.Header = xlYes\n         .Sort.MatchCase = False\n         .Sort.Orientation = xlTopToBottom\n         .Sort.SortMethod = xlPinYin\n         .Sort.Apply\n    End With\n</code></pre>\n\n<p>If you take a look at this, you can \"rank\" your data in any which way you would like.  This sort is <strong>1. vendor</strong> then <strong>2. job number</strong> then <strong>3. accrual amount</strong> then the funs begins to match up invoice import against the accruals.  If you define your sort range properly you will not lose or mismtach any data in adjacent columns.  I guess I am lobbying for you to use sort.</p>\n\n<p>If you provide some code the answer could actually be a sort of your data, insert a rank column, put the ranks in, then unsort your data back to the way it was.  Rather than running a function to \"rank\" based on a specific attribute (longer ..... but doable).  Cheers, WWC</p>\n"}], "owner": {"reputation": 117, "user_id": 9825319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYs7i.png?s=128&g=1", "display_name": "Matt Gaydon", "link": "https://stackoverflow.com/users/9825319/matt-gaydon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1851, "favorite_count": 0, "accepted_answer_id": 50493095, "answer_count": 1, "score": 0, "last_activity_date": 1536852474, "creation_date": 1527090611, "last_edit_date": 1536852474, "question_id": 50492674, "link": "https://stackoverflow.com/questions/50492674/rank-a-list-of-values-largest-to-smallest-using-vba", "title": "Rank A List Of Values (Largest to Smallest) Using VBA", "body": "<p>I have a VBA code to return a Crew ID for a job completed, the total number of jobs that crew did, how many days that crew was working, and then return the average number of jobs per day. They are in no particular order and all of these categories are adjacent to each other in the excel spreadsheet. In a column next to these other categories, I want to write a VBA code to assign each row a value (1 to 10, since there are 10 crews) based on who has the highest number of jobs per day.</p>\n\n<p>I have looked at other code and suggestions but all I can find is sorting. I don't want to sort them since I can easily do that in Excel and if I sort the values in VBA for that specific column, they will not line up with the rest of the information about them. Any suggestions on how I can \"rank\" these columns by printing the numbers 1 through 10 in the column adjacent based on who has the highest to lowest jobs per day average?</p>\n\n<p>Thank you all for your help!</p>\n"}, {"tags": ["vba", "excel", "match"], "comments": [{"owner": {"reputation": 3, "user_id": 9834916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba8668afbc8e6422d2aa32146d10c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Steve-O", "link": "https://stackoverflow.com/users/9834916/steve-o"}, "edited": false, "score": 0, "creation_date": 1533130079, "post_id": 50492660, "comment_id": 90233342, "body": "If anyone else is struggling with this, the method I am using in lieu of a solution in this sort of fashion is to create an extra column using concat(criteria1,&quot;-&quot;,criteria2,&quot;-&quot;,...) to allow matching to a single criteria. This works fine, but I would prefer to do it without the extra column"}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1533186427, "post_id": 50492660, "comment_id": 90255548, "body": "i was reviewing my answer in the context of your question.  On the surface it looks like a filtered range may be precisely the answer you want. and don&#39;t be afraid of helper columns.  they may not be your ideal solution but they are easy to hide - especially - for you! because you&#39;re here in stack overflow and you know how to change the worksheet visible property from -1 visible, not to 0 hidden, but to 2 very hidden.  meaning a user cannot modify or even identify your sheet without vba code, opening the vbe, or unzipping the xlsx and inspecting the xml files"}], "answers": [{"tags": [], "owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "is_accepted": false, "score": 0, "last_activity_date": 1533184533, "creation_date": 1533184533, "answer_id": 51645582, "question_id": 50492660, "link": "https://stackoverflow.com/questions/50492660/match-function-with-multiple-criteria/51645582#51645582", "title": "Match function with multiple criteria", "body": "<p>was just passing through and picked up on some similarities you have with a project I'm working on, i noticed you said you were trying to match objects... this might help, or it might not.  depends on the object property you want to match.</p>\n\n<p>to easily and quickly find and retrieve matches, i load arrays with criteria and set filters. copy special visible to grab the filtered results then split with getfromclipboard to load an array.</p>\n\n<p>combobox's are great when i need a different level of matching, specifically, when i need to match a users request from a pool of possibilities. frequently the results i pulled from the the clipboard will populate a combo list</p>\n\n<p>or</p>\n\n<p>i may send it to a dictionary as an item or populate keys.  dictionaries are a deceptively simple way to find unique values or create arrays with relationships to other data.  added benefit, they can hold just about anything as an item and the key is similar except it cannot be an array and it must be unique from the other keys.</p>\n\n<p>hope you find something helpful, best of luck!</p>\n"}], "owner": {"reputation": 3, "user_id": 9834916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba8668afbc8e6422d2aa32146d10c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Steve-O", "link": "https://stackoverflow.com/users/9834916/steve-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 550, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533184533, "creation_date": 1527090578, "last_edit_date": 1533130042, "question_id": 50492660, "link": "https://stackoverflow.com/questions/50492660/match-function-with-multiple-criteria", "title": "Match function with multiple criteria", "body": "<p>I currently have a userform with various objects. \nI wish to add a \"search and fill form\" function similar to that I found here (only I have to match 4 fields instead of 1): <a href=\"https://www.experts-exchange.com/questions/28706684/VBA-Code-to-Populate-Userform-with-Existing-Records-Edit-them-and-add-them-back-to-the-worksheet.html\" rel=\"nofollow noreferrer\">https://www.experts-exchange.com/questions/28706684/VBA-Code-to-Populate-Userform-with-Existing-Records-Edit-them-and-add-them-back-to-the-worksheet.html</a>\nThe objects that I am searching for are 3 textboxes and the 4th a selected radiobutton which I have formatted for this purpose as:</p>\n\n<pre><code>If radio1 = True Then\ncriteria4 = \"radio1\"\nElseIf radio2 = True Then\ncriteria4 = \"radio2\"\nElseIf radio3 = True Then\ncriteria4 = \"radio3\"\nElseIf radio4 = True Then\ncriteria4 = \"radio4\"\nEnd If\n</code></pre>\n\n<p>I have tried a few methods for the \"search\" component without success:</p>\n\n<p>-Using match function (formatted in various ways one of which is shown below, which i couldn't get to evaluate no matter what I tried)</p>\n\n<pre><code>formula = \"match(\" &amp; criteria1 &amp; criteria2 &amp; criteria3 &amp; criteria4 &amp; \",a2:a999&amp;b2:b999&amp;e2:e999&amp;f2:f999, 0)\"\nr = Evaluate(formula)\n</code></pre>\n\n<p>-Using a for loop as a means to match based on if function (here I am stuck as to how to get the row number for the match to be output so I can then use it later to fill the form with the corresponding data)</p>\n\n<pre><code>lastrow = ws.Cells(Rows.Count, 1).End(xlUp).row\n\n'search for jb, sbj, pckg and jbtyp match\nWith ws.Range(\"A1,P\" &amp; lastrow)\nFor row = 2 To .Rows.Count\nIf .Cells(row, 1).Value Like criteria1 And .Cells(row, 2).Value Like criteria2 And .Cells(row, 5).Value Like criteria3 And .Cells(row, 6).Value Like criteria4 Then\n***method of returning row number for the match that can then be use in later code to pull data from this row***\n    End If\nNext\nEnd With\n</code></pre>\n\n<p>Any guidance would be greatly appreciated either continuing one of these methods or an alternative.</p>\n\n<p>[EDIT] I tried the below thinking it was working, however I have started using it again and realised this only allows me to search the first row (criteria1), please help...</p>\n\n<pre><code>Set rfound = Columns(\"A\").Find(criteria1, Cells(Rows.Count, \"A\"), xlValues, xlWhole)\nIf Not rfound Is Nothing Then\nstrfirst = rfound.Address\n    Do\n    If LCase(Cells(rfound.row, \"B\").Text) = criteria2 And LCase(Cells(rfound.row, \"E\").Text) = criteria3 And LCase(Cells(rfound.row, \"F\").Text) = criteria4 Then\nr = rfound.row\nEnd If\nSet rfound = Columns(\"A\").Find(criteria1, rfound, xlValues, xlWhole)\nr = rfound.row\n    Me.txt1 = ws.Cells(r, \"A\")\n    ...\n    Me.cmbengpos = ws.Cells(r, \"I\")\n    ...\n    If ws.Cells(r, \"F\") = \"radio1\" Then\n    Me.radiopanels.Value = True\n    End If\n    ...\nLoop While rfound.Address &lt;&gt; strfirst\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1527090574, "post_id": 50492606, "comment_id": 87998160, "body": "Do you want the normal <b>ENTER</b> key or the <b>ENTER</b> key on the numeric keypad??"}, {"owner": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1527090699, "post_id": 50492606, "comment_id": 87998242, "body": "I do prefer the <b>normal ENTER</b> if possible. Thanks"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1527091066, "post_id": 50492606, "comment_id": 87998449, "body": "I think this is an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY Problem</a>.  What are you really trying to do?  You usually don&#39;t want to actually mimic keypresses.  There&#39;s a way to select that next cell with VBA.  What code do you have now? Generally, it could look like <code>Sub mySub() &#47;&#47; Range(&quot;A1&quot;).Formula = &quot;=ROW()-7&quot; &#47;&#47; Range(&quot;A1&quot;).Offset(1,0).Activate</code> ...even though you should <a href=\"https://stackoverflow.com/questions/10714251/\">avoid using <code>.Select&#47;.Activate</code></a>."}, {"owner": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1527091698, "post_id": 50492606, "comment_id": 87998809, "body": "@BruceWayne thanks for answering. I&#39;m trying to start the macro once ENTER key is pressed, and then jump to the first cell of the next row, write and focus the row on its right side. But do this no matter in what row am I. Did I explain ok? I&#39;m sorry, if not. Ask more if its needed for the explanation please"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1527094860, "post_id": 50492606, "comment_id": 88000471, "body": "So, when the user has your workbook/spreadsheet open, you want the macro to fire any time they press <code>ENTER</code>? <b>Do not do that</b>.  What&#39;s your goal with the macro, to enter the <code>=ROW()-7</code> formula in a current cell, and after it&#39;s entered, go down one row, over one column?  For example, you want <code>=ROW()-7</code> in <code>A1</code>, and after that&#39;s entered, have the active cell be <code>B2</code>?"}, {"owner": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1527148073, "post_id": 50492606, "comment_id": 88019805, "body": "@BruceWayne the goal is when I press ENTER, the first cell of the next row fills with =ROW()-7 formula and the cell on its right gets the focus. Thanks for answering"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "edited": false, "score": 0, "creation_date": 1527147852, "post_id": 50493759, "comment_id": 88019677, "body": "I paste this code in ThisWorkbook(code) and it does nothing. Do I have to do anything else? Thanks"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "edited": false, "score": 0, "creation_date": 1527168684, "post_id": 50493759, "comment_id": 88033566, "body": "You&#39;ll need to put it in the code for the particular worksheet that you want it to work on. If you want this to work on ALL worksheets in the workbook, then a different event can be used in <code>ThisWorkbook</code> code with a few tweaks. Let me know and I can write that up real quick."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "edited": false, "score": 0, "creation_date": 1527379329, "post_id": 50493759, "comment_id": 88106594, "body": "@Juan  if this solved it for you, please flag as The Answer by clicking the check mark left of the post."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 0, "last_activity_date": 1527094682, "creation_date": 1527094682, "answer_id": 50493759, "question_id": 50492606, "link": "https://stackoverflow.com/questions/50492606/excel-macro-enter/50493759#50493759", "title": "excel macro Enter", "body": "<p>When I press the <kbd>Enter</kbd> key while in a cell it causes excel to select the next cell. You could use the <code>Worksheet_SelectionChange()</code> event to capture that and perform the action:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    'Toggle this off to avoid endless loops\n    Application.EnableEvents = False\n\n    'Add the date\n    Target.EntireRow.Cells(1, 1).Value = Now - 7\n\n    'Select the \"Next Cell\"?\n    Target.EntireRow.Cells(1,2).Select\n\n    'Toggle back on so this event fires again\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>Put that in the code page, in VBE, for whatever sheet you want this to happen.</p>\n\n<p>Even though we aren't capturing the <kbd>Enter</kbd> key push directly, this does exactly what you described without having to perform any keybinding.</p>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "edited": false, "score": 0, "creation_date": 1527148714, "post_id": 50493773, "comment_id": 88020163, "body": "Thanks for your answer, but I&#39;m sorry I&#39;m noob in excel. I paste the first option in ThisWorkbook (code) page and it does nothing. Should I do anything else? And if I choose the second option, can I paste both in the same Module page? Thanks"}, {"owner": {"reputation": 1742, "user_id": 9463489, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jblood94", "link": "https://stackoverflow.com/users/9463489/jblood94"}, "reply_to_user": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "edited": false, "score": 0, "creation_date": 1527794805, "post_id": 50493773, "comment_id": 88272849, "body": "For the first solution, you need to save and reopen the workbook. For the second, put it into a new module (Insert &gt; Module)."}], "tags": [], "owner": {"reputation": 1742, "user_id": 9463489, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jblood94", "link": "https://stackoverflow.com/users/9463489/jblood94"}, "is_accepted": false, "score": 0, "last_activity_date": 1527094740, "creation_date": 1527094740, "answer_id": 50493773, "question_id": 50492606, "link": "https://stackoverflow.com/questions/50492606/excel-macro-enter/50493773#50493773", "title": "excel macro Enter", "body": "<p>Use <code>OnKey</code>. Do one of the following:</p>\n\n<p>1) Place this in the ThisWorkbook module (this will take over the enter key when you open the workbook and put it back to normal when you close):</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    Application.OnKey \"~\"\nEnd Sub\n\nPrivate Sub Workbook_Open()\n    Application.OnKey \"~\", \"AutoIncrement\"\nEnd Sub\n</code></pre>\n\n<p>--OR--</p>\n\n<p>2) Add this to a module and call <code>CatchEnter</code> it to toggle the behavior:</p>\n\n<pre><code>Public blnCatchEnter As Boolean\n\nPublic Sub CatchEnter()\n    If blnCatchEnter Then\n        Application.OnKey \"~\"\n        blnCatchEnter = False\n    Else\n        Application.OnKey \"~\", \"AutoIncrement\"\n        blnCatchEnter = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>Next, add this macro to a module:</p>\n\n<pre><code>Public Sub AutoIncrement()\n    If TypeName(Selection) = \"Range\" Then\n        Dim lngRow As Long\n\n        lngRow = Selection.Row + 1\n\n        Range(\"A\" &amp; lngRow).Formula = \"=ROW()-7\"\n        Range(\"B\" &amp; lngRow).Select\n    End If\nEnd Sub\n</code></pre>\n\n<p>Although, I agree with @BruceWayne that you may not want to take over the <code>Enter</code> key this way. Assigning a shortcut to <code>AutoIncrement</code> will be safer.</p>\n"}], "owner": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 50493759, "answer_count": 2, "score": 0, "last_activity_date": 1527094740, "creation_date": 1527090462, "last_edit_date": 1527091113, "question_id": 50492606, "link": "https://stackoverflow.com/questions/50492606/excel-macro-enter", "title": "excel macro Enter", "body": "<p>I'm trying to record this macro: Pressing <kbd>Enter</kbd> key, the first cell of the next row fills with autoincrement value <code>=ROW()-7</code> and the next cell gets the focus. </p>\n\n<p>How can I use Enter key for the macro? I also have problems with ranges of the macro, any tip or solution?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1527090206, "post_id": 50492453, "comment_id": 87997889, "body": "So if we find the date in column <b>F</b>, do you watn to delete <b>C</b> and <b>E</b> or <b>C, D, F</b>??"}, {"owner": {"reputation": 59, "user_id": 9835552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc6149b3db45c3ede455e7dacc3c0210?s=128&d=identicon&r=PG&f=1", "display_name": "activexplor3", "link": "https://stackoverflow.com/users/9835552/activexplor3"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1527090282, "post_id": 50492453, "comment_id": 87997936, "body": "If date is in F7, I want to delete column C, D, E."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1527090431, "post_id": 50492453, "comment_id": 87998049, "body": "@activexplor3 If you post what you have accomplished this far, we will be happy to help you."}, {"owner": {"reputation": 1284, "user_id": 235862, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8a81a94a23389a75eb3a4ec56c6a9ac8?s=128&d=identicon&r=PG", "display_name": "Juan Diego", "link": "https://stackoverflow.com/users/235862/juan-diego"}, "edited": false, "score": 0, "creation_date": 1527090666, "post_id": 50492453, "comment_id": 87998218, "body": "Please add your code"}, {"owner": {"reputation": 59, "user_id": 9835552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc6149b3db45c3ede455e7dacc3c0210?s=128&d=identicon&r=PG&f=1", "display_name": "activexplor3", "link": "https://stackoverflow.com/users/9835552/activexplor3"}, "edited": false, "score": 0, "creation_date": 1527091728, "post_id": 50492453, "comment_id": 87998823, "body": "Sub DeleteUnnecessaryColumns(specifiedWorksheet)      Dim lastCol As Long     lastCol = Cells.Find(What:=&quot;*&quot;, After:=[C1], SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column     For i = 1 To lastCol         If InStr(Cells(7, 0), specifiedDate, vbTextCompare) = 0 Then             Columns(i).Delete         End If     Next i          End Sub"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1527094281, "post_id": 50492453, "comment_id": 88000194, "body": "@activexplor3 I&#39;ve added your code to your post - next time, edit your post with the code instead of adding a new comment."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 9835552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc6149b3db45c3ede455e7dacc3c0210?s=128&d=identicon&r=PG&f=1", "display_name": "activexplor3", "link": "https://stackoverflow.com/users/9835552/activexplor3"}, "edited": false, "score": 0, "creation_date": 1527098136, "post_id": 50494299, "comment_id": 88002068, "body": "Thank you for the response! I have tried the code and I get an Object Required error on this line: lastCol = .Cells.Find(What:=&quot;*&quot;, After:=[C1], SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column"}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "reply_to_user": {"reputation": 59, "user_id": 9835552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc6149b3db45c3ede455e7dacc3c0210?s=128&d=identicon&r=PG&f=1", "display_name": "activexplor3", "link": "https://stackoverflow.com/users/9835552/activexplor3"}, "edited": false, "score": 0, "creation_date": 1527099994, "post_id": 50494299, "comment_id": 88002956, "body": "See edit. The <code>.Find</code> method is for the <code>Range</code> object. That seemed like extra overhead so I converted to the common ctrl + shift + end method. This isn&#39;t always correct, but is a decent alternative."}, {"owner": {"reputation": 59, "user_id": 9835552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc6149b3db45c3ede455e7dacc3c0210?s=128&d=identicon&r=PG&f=1", "display_name": "activexplor3", "link": "https://stackoverflow.com/users/9835552/activexplor3"}, "edited": false, "score": 0, "creation_date": 1527100496, "post_id": 50494299, "comment_id": 88003222, "body": "The code seems to have deleted column C and stopped after that."}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "reply_to_user": {"reputation": 59, "user_id": 9835552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc6149b3db45c3ede455e7dacc3c0210?s=128&d=identicon&r=PG&f=1", "display_name": "activexplor3", "link": "https://stackoverflow.com/users/9835552/activexplor3"}, "edited": false, "score": 0, "creation_date": 1527100575, "post_id": 50494299, "comment_id": 88003261, "body": "Was <code>specifieddate</code> found in Col D?"}, {"owner": {"reputation": 59, "user_id": 9835552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc6149b3db45c3ede455e7dacc3c0210?s=128&d=identicon&r=PG&f=1", "display_name": "activexplor3", "link": "https://stackoverflow.com/users/9835552/activexplor3"}, "edited": false, "score": 0, "creation_date": 1527100669, "post_id": 50494299, "comment_id": 88003318, "body": "No, it is part of the string in cell AF7."}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "reply_to_user": {"reputation": 59, "user_id": 9835552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc6149b3db45c3ede455e7dacc3c0210?s=128&d=identicon&r=PG&f=1", "display_name": "activexplor3", "link": "https://stackoverflow.com/users/9835552/activexplor3"}, "edited": false, "score": 0, "creation_date": 1527100898, "post_id": 50494299, "comment_id": 88003445, "body": "Do <code>For i = 3 to 35</code> does it delete everything up to AF and stop?"}, {"owner": {"reputation": 59, "user_id": 9835552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc6149b3db45c3ede455e7dacc3c0210?s=128&d=identicon&r=PG&f=1", "display_name": "activexplor3", "link": "https://stackoverflow.com/users/9835552/activexplor3"}, "edited": false, "score": 0, "creation_date": 1527101679, "post_id": 50494299, "comment_id": 88003877, "body": "I was previously mistaken, it didn&#39;t delete column C and stop. It deleted a variety of seemingly random columns. The original sheet prior to me running the code had values in columns C to EQ. Now only columns C to CK have values. For i = 3 to 35, the result is the same."}, {"owner": {"reputation": 59, "user_id": 9835552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc6149b3db45c3ede455e7dacc3c0210?s=128&d=identicon&r=PG&f=1", "display_name": "activexplor3", "link": "https://stackoverflow.com/users/9835552/activexplor3"}, "edited": false, "score": 0, "creation_date": 1527101932, "post_id": 50494299, "comment_id": 88003996, "body": "Is there a way to check only every 29th cell starting from C7? If the date is not in C7, delete 29 columns (including C, up to but not including AF). Most of the cells in row 7 are blank, so maybe not every cell needs to be checked."}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "reply_to_user": {"reputation": 59, "user_id": 9835552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc6149b3db45c3ede455e7dacc3c0210?s=128&d=identicon&r=PG&f=1", "display_name": "activexplor3", "link": "https://stackoverflow.com/users/9835552/activexplor3"}, "edited": false, "score": 0, "creation_date": 1527103551, "post_id": 50494299, "comment_id": 88004817, "body": "Sorry for the delay, I forgot that you need to reset the indices after the column deletion, so it doesn&#39;t skip random columns as you were seeing."}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "reply_to_user": {"reputation": 59, "user_id": 9835552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc6149b3db45c3ede455e7dacc3c0210?s=128&d=identicon&r=PG&f=1", "display_name": "activexplor3", "link": "https://stackoverflow.com/users/9835552/activexplor3"}, "edited": false, "score": 0, "creation_date": 1527128137, "post_id": 50494299, "comment_id": 88012595, "body": "If you want to check every 29th column, use <code>Step</code> in the <code>For</code> loop <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/fornext-statement\" rel=\"nofollow noreferrer\">MSDN</a>. Welcome to Stack Overflow!"}], "tags": [], "owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "is_accepted": true, "score": 0, "last_activity_date": 1527128349, "last_edit_date": 1527128349, "creation_date": 1527096789, "answer_id": 50494299, "question_id": 50492453, "link": "https://stackoverflow.com/questions/50492453/vba-loop-across-one-row-to-find-a-value-that-contains-a-cell-and-delete-columns/50494299#50494299", "title": "VBA Loop across one row to find a value that contains a cell and delete columns before that column", "body": "<p>A few changes:</p>\n\n<ol>\n<li>Use a <code>With</code> block to explicitly target the specified worksheet</li>\n<li>Add a <code>.</code> before the <code>Cells</code> collection to explicitly link to the specified worksheet (through the <code>With</code> block)</li>\n<li>Start the loop with the correct column index for Column C = 3 (<code>For i = 3</code> ...)</li>\n<li>You missed the first argument to the <code>InStr</code> function: starting character (1 was assumed) <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/instr-function\" rel=\"nofollow noreferrer\">MSDN</a></li>\n<li>The second argument for <code>InStr</code> wasn't set to the <code>i</code> variable. This will now cycle through the values in each column</li>\n<li>The loop would not stop once it found the search text. So I added an <code>Else</code> clause that exits the <code>For</code> loop once <code>specifiedDate</code> is found, preventing the script from deleting columns to the right of the target column.</li>\n<li><code>specifiedDate</code> was never passed to the Sub or declared so I added it as a parameter. You can also declare and set it within this procedure. If it's declared as a public variable, then delete the parameter.</li>\n<li>The <code>.Find</code> method is only available to a range object, so I used a method available to cells instead</li>\n<li>After a column is deleted, the indices for the remaining columns are reduced by one so the same must be done to the variables controlling the loop</li>\n</ol>\n\n<p>It should now properly delete a column if the search text is not found in row 7 and will stop executing once the first match is found, leaving the remaining columns intact.</p>\n\n<pre><code>Sub DeleteUnnecessaryColumns(specifiedWorksheet, specifiedDate) \n\nDim lastCol As Long\nWith specifiedWorksheet\n    lastCol = .Cells(7, .Columns.Count).End(xlToLeft).Column\n    For i = 3 To lastCol\n        If InStr(1, .Cells(7, i), specifiedDate, vbTextCompare) = 0 Then \n            .Columns(i).Delete\n            i = i - 1\n            lastCol = lastCol - 1\n        Else\n            Exit For\n        End If \n    Next i \nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 238, "user_id": 9757930, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GEVLxGzjnsE/AAAAAAAAAAI/AAAAAAAADnU/vRuIvzLpAJU/photo.jpg?sz=128", "display_name": "mer_curius", "link": "https://stackoverflow.com/users/9757930/mer-curius"}, "is_accepted": false, "score": 0, "last_activity_date": 1527098898, "creation_date": 1527098898, "answer_id": 50494814, "question_id": 50492453, "link": "https://stackoverflow.com/questions/50492453/vba-loop-across-one-row-to-find-a-value-that-contains-a-cell-and-delete-columns/50494814#50494814", "title": "VBA Loop across one row to find a value that contains a cell and delete columns before that column", "body": "<p>Something like...  You need to call it from somewhere else, using syntax like <code>DeleteUnnecessaryColumns \"Sheet1\", \"9/30/2017\"</code></p>\n\n<pre><code>Sub DeleteUnnecessaryColumns(specifiedWorksheet as worksheet, SpecifiedDate as string) \n\ndim r as range   ' set up a range for row 7, columns C to the end\nset r = specifiedWorksheet.rows(7)\nset r = r.resize(Columnsize:= r.columns.count - 2)\nset r =  r.offset(0,2)\n\nDim lastCol As Long, i as long\n\nfor i = 1 to r.columns.count  'loop through the cells in the r range\n    if instr(string:=r.cells(i), substring:= SpecifiedDate) &gt; 0 then\n        lastcol = i  'this ends the loop and sets the value for lastcol\n    end if \nnext\n\nSpecifiedWorksheet.range(cells(1, 3), cells(1, lastcol - 1).entirecolumn.delete\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 9835552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc6149b3db45c3ede455e7dacc3c0210?s=128&d=identicon&r=PG&f=1", "display_name": "activexplor3", "link": "https://stackoverflow.com/users/9835552/activexplor3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 679, "favorite_count": 0, "accepted_answer_id": 50494299, "answer_count": 2, "score": 1, "last_activity_date": 1527128349, "creation_date": 1527090026, "last_edit_date": 1527094086, "question_id": 50492453, "link": "https://stackoverflow.com/questions/50492453/vba-loop-across-one-row-to-find-a-value-that-contains-a-cell-and-delete-columns", "title": "VBA Loop across one row to find a value that contains a cell and delete columns before that column", "body": "<p>I need to check each cell in row 7 starting from C7 (C7, D7, E7, etc) and find a cell with a string value that contains a certain date (for example, \"9/30/2017\" in string \"6/30/2017 to 9/30/2017\") and delete ALL columns from column C to whatever column that the cell is in. How would I do this with VBA code? I am new to VBA and have tried everything that I could find. Thankful for any suggestions</p>\n\n<p>My code:</p>\n\n<pre><code>Sub DeleteUnnecessaryColumns(specifiedWorksheet) \n\nDim lastCol As Long \nlastCol = Cells.Find(What:=\"*\", After:=[C1], SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column \n\nFor i = 1 To lastCol \n    If InStr(Cells(7, 0), specifiedDate, vbTextCompare) = 0 Then \n        Columns(i).Delete \n    End If \nNext i \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "vba", "excel"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1527090020, "post_id": 50492033, "comment_id": 87997772, "body": "&quot;the problem is that the characters in quotes are variables and my code is not working for all cases&quot;  show us what you have so far"}, {"owner": {"reputation": 3388, "user_id": 9534819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fdbae473f8d26eb6a10d85ab897e91e?s=128&d=identicon&r=PG&f=1", "display_name": "Matt.G", "link": "https://stackoverflow.com/users/9534819/matt-g"}, "edited": false, "score": 0, "creation_date": 1527093744, "post_id": 50492033, "comment_id": 87999924, "body": "&quot;to get rid of the text starts from the justification to the length of the characters that i specify&quot;. How are you going to ge the length here?"}, {"owner": {"reputation": 130, "user_id": 9143368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732d6206859c8b1d3ae39a9251442ee4?s=128&d=identicon&r=PG&f=1", "display_name": "1986G1988", "link": "https://stackoverflow.com/users/9143368/1986g1988"}, "reply_to_user": {"reputation": 3388, "user_id": 9534819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fdbae473f8d26eb6a10d85ab897e91e?s=128&d=identicon&r=PG&f=1", "display_name": "Matt.G", "link": "https://stackoverflow.com/users/9534819/matt-g"}, "edited": false, "score": 0, "creation_date": 1527094213, "post_id": 50492033, "comment_id": 88000159, "body": "@Matt.G I am asking  whether there is any way i can specify a length of characters i can omit."}, {"owner": {"reputation": 3388, "user_id": 9534819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fdbae473f8d26eb6a10d85ab897e91e?s=128&d=identicon&r=PG&f=1", "display_name": "Matt.G", "link": "https://stackoverflow.com/users/9534819/matt-g"}, "edited": false, "score": 0, "creation_date": 1527094428, "post_id": 50492033, "comment_id": 88000266, "body": "what is your criteria for identifying the length? is it ending with dimensionswidth=&quot;..&quot; or anything before characterOffset?"}, {"owner": {"reputation": 130, "user_id": 9143368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732d6206859c8b1d3ae39a9251442ee4?s=128&d=identicon&r=PG&f=1", "display_name": "1986G1988", "link": "https://stackoverflow.com/users/9143368/1986g1988"}, "reply_to_user": {"reputation": 3388, "user_id": 9534819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fdbae473f8d26eb6a10d85ab897e91e?s=128&d=identicon&r=PG&f=1", "display_name": "Matt.G", "link": "https://stackoverflow.com/users/9534819/matt-g"}, "edited": false, "score": 0, "creation_date": 1527094881, "post_id": 50492033, "comment_id": 88000481, "body": "@Matt.G anything before characteroffset"}], "answers": [{"comments": [{"owner": {"reputation": 130, "user_id": 9143368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732d6206859c8b1d3ae39a9251442ee4?s=128&d=identicon&r=PG&f=1", "display_name": "1986G1988", "link": "https://stackoverflow.com/users/9143368/1986g1988"}, "edited": false, "score": 0, "creation_date": 1527105258, "post_id": 50493900, "comment_id": 88005673, "body": "Would you be able to elaborate the usage of this in a vba code an example or something. I am just a beginner."}, {"owner": {"reputation": 3388, "user_id": 9534819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fdbae473f8d26eb6a10d85ab897e91e?s=128&d=identicon&r=PG&f=1", "display_name": "Matt.G", "link": "https://stackoverflow.com/users/9534819/matt-g"}, "reply_to_user": {"reputation": 130, "user_id": 9143368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732d6206859c8b1d3ae39a9251442ee4?s=128&d=identicon&r=PG&f=1", "display_name": "1986G1988", "link": "https://stackoverflow.com/users/9143368/1986g1988"}, "edited": false, "score": 0, "creation_date": 1527106221, "post_id": 50493900, "comment_id": 88006131, "body": "@george86, I have edited the answer to include VBA sample code. Please note that I&#39;ve not tested it"}, {"owner": {"reputation": 130, "user_id": 9143368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732d6206859c8b1d3ae39a9251442ee4?s=128&d=identicon&r=PG&f=1", "display_name": "1986G1988", "link": "https://stackoverflow.com/users/9143368/1986g1988"}, "edited": false, "score": 0, "creation_date": 1527251998, "post_id": 50493900, "comment_id": 88070516, "body": "My vba script is working good &amp; i want share that excel file with my co-workers so that they can also use it without seeing the code that i made.What will be the best way of doing that. Can i make it like a web app or something?"}], "tags": [], "owner": {"reputation": 3388, "user_id": 9534819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fdbae473f8d26eb6a10d85ab897e91e?s=128&d=identicon&r=PG&f=1", "display_name": "Matt.G", "link": "https://stackoverflow.com/users/9534819/matt-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1527106167, "last_edit_date": 1527106167, "creation_date": 1527095241, "answer_id": 50493900, "question_id": 50492033, "link": "https://stackoverflow.com/questions/50492033/vba-replace-using-regex/50493900#50493900", "title": "VBA Replace Using Regex", "body": "<p>Use Regex: <code>justification.*?(?=\\scharacterOffset)</code></p>\n\n<p><a href=\"https://regex101.com/r/fQeZPq/1\" rel=\"nofollow noreferrer\">Demo</a></p>\n\n<p>See this <a href=\"https://analystcave.com/excel-regex-tutorial/#Regex_Replace_pattern_in_a_string\" rel=\"nofollow noreferrer\">link</a> on how to replace using regex in VBA</p>\n\n<p>Sample:</p>\n\n<pre><code>Dim regex As Object, str As String\nSet regex = CreateObject(\"VBScript.RegExp\")\n\nWith regex\n  .Pattern = \"justification.*?(?=\\scharacterOffset)\"\nEnd With\n\nstr = \"justification=\"left\" dimensionsHeight=\"1\" dimensionsWidth=\"19\" characterOffset=\"0\"\"   'might need to escape \"\nDebug.Print regex.Replace(str, \"\") \n'Result: characterOffset=\"0\"\n</code></pre>\n"}], "owner": {"reputation": 130, "user_id": 9143368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732d6206859c8b1d3ae39a9251442ee4?s=128&d=identicon&r=PG&f=1", "display_name": "1986G1988", "link": "https://stackoverflow.com/users/9143368/1986g1988"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1199, "favorite_count": 0, "accepted_answer_id": 50493900, "answer_count": 1, "score": -3, "last_activity_date": 1527106167, "creation_date": 1527088746, "last_edit_date": 1531164843, "question_id": 50492033, "link": "https://stackoverflow.com/questions/50492033/vba-replace-using-regex", "title": "VBA Replace Using Regex", "body": "<p>I am trying to edit a XML file using a VBA code.The following is a sample of what i am trying to do</p>\n\n<pre><code>justification=\"left\" dimensionsHeight=\"1\" dimensionsWidth=\"19\" characterOffset=\"0\".\n</code></pre>\n\n<p>what I want is when I search through the document and if i find a string called justification i want to get rid of the text starts from the justification to the length of the characters that i specify. For Eg: I want to get rid from justification upto <code>dimensionswidth=\"19\"</code>  in this case and my result should contain just <code>characterOffset=\"0\"</code>. I am trying to use Instr &amp; Replace functions but the problem is that the characters in quotes are variables and my code is not working for all cases.\nAny ideas guys</p>\n\n<p>This is the code i have now</p>\n\n<pre><code>If InStr(1, LinesB(j), \"Justification\") Then\n\nLinesB(j) = Replace(LinesB(j), \"justification=\" + Chr(34) + \"left\" + Chr(34) + \"dimensionsHeight=\" + Chr(34) + \"1\" + Chr(34) + \"dimensionsWidth=\" + Chr(34) + \"19\", \"\")\n\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1527088537, "post_id": 50491929, "comment_id": 87996790, "body": "<code>?selection.interior.color</code> - it returns a number, coming from the values of the <code>R</code>*<code>G</code>*<code>B</code>, but it is not <code>RGB</code>."}, {"owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1527088719, "post_id": 50491929, "comment_id": 87996926, "body": "I&#39;m more curious if every theme color has a name or index number. Ie, can I select &quot;Dark Blue, Text 2, 25% Darker&quot;."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1527088779, "post_id": 50491929, "comment_id": 87996955, "body": "Yes. Every theme color has a background color, which is within the range of <code>0</code> to <code>256^3-1</code>"}, {"owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1527088914, "post_id": 50491929, "comment_id": 87997039, "body": "No, I want to SELECT THE COLOR BY ITS NAME, something to the effect of .interior.color = &quot;&quot;Dark Blue, Text 2, 25% Darker&quot;"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1527089268, "post_id": 50491929, "comment_id": 87997278, "body": "<code>selection.interior.colorindex = ThisWorkbook.Styles(&quot;40 % - Akzent3&quot;).Interior.ColorIndex</code>"}], "answers": [{"comments": [{"owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "edited": false, "score": 1, "creation_date": 1527089466, "post_id": 50492107, "comment_id": 87997414, "body": "That did indeed output a nice list... but the color isn&#39;t on it! Perhaps the color is selected separately from the intensity?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "edited": false, "score": 0, "creation_date": 1527089789, "post_id": 50492107, "comment_id": 87997634, "body": "@MauryMarkowitz - do you mean patterns? Something like <code>Selection.Interior.ThemeColor = xlThemeColorAccent5</code>?"}, {"owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "edited": false, "score": 0, "creation_date": 1527090609, "post_id": 50492107, "comment_id": 87998191, "body": "No, it has something to do with Theme.ThemeColorScheme.colors(x), but it doesn&#39;t seem that you can can use GetColorName with the names you see in the display."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "edited": false, "score": 3, "creation_date": 1527090689, "post_id": 50492107, "comment_id": 87998234, "body": "@MauryMarkowitz - have you tried to record a macro and see what is happening?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1527089005, "creation_date": 1527089005, "answer_id": 50492107, "question_id": 50491929, "link": "https://stackoverflow.com/questions/50491929/selecting-theme-colors-in-excel-without-using-rgb-values/50492107#50492107", "title": "Selecting theme colors in Excel *without* using RGB values?", "body": "<p>Check this to see the color of the styles:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim st As Style\n    Dim cnt As Long: cnt = 1\n\n    For Each st In ThisWorkbook.Styles\n        Cells(cnt, 1).Interior.ColorIndex = cnt\n        Cells(cnt, 2) = cnt\n        Cells(cnt, 3) = st.Name\n        Cells(cnt, 4) = st.NameLocal\n        cnt = cnt + 1\n    Next st\n\nEnd Sub\n</code></pre>\n\n<p>Returning this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Jdg1d.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Jdg1d.png\" alt=\"enter image description here\"></a></p>\n\n<p>If you want to use specific style for a specific selection:</p>\n\n<pre><code>selection.interior.colorindex = ThisWorkbook.Styles(\"40 % - Akzent3\").Interior.ColorIndex\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "edited": false, "score": 0, "creation_date": 1527090637, "post_id": 50492461, "comment_id": 87998211, "body": "Ahhh, let me see what I can do with that!"}, {"owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "edited": false, "score": 0, "creation_date": 1527090888, "post_id": 50492461, "comment_id": 87998362, "body": "I think the key is GetCustomColor, but I&#39;m not sure how to map the name I see in the picker into the right name in the index. There doesn&#39;t seem to be a way to READ the name from the selection already in a cell?"}, {"owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "reply_to_user": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "edited": false, "score": 1, "creation_date": 1527090915, "post_id": 50492461, "comment_id": 87998377, "body": "Try to record a macro... As suggested by @Vityata."}, {"owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "edited": false, "score": 0, "creation_date": 1527091190, "post_id": 50492461, "comment_id": 87998515, "body": "Ha! The color in question, a very dark blue, is &quot;xlThemeColorLight2&quot;."}, {"owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "edited": false, "score": 0, "creation_date": 1527091324, "post_id": 50492461, "comment_id": 87998618, "body": "Actually, in retrospect, that name <i>does</i> make sense within XL. However, it also kind of destroys the original concept - if the name isn&#39;t something like &quot;Dark Blue&quot;, there doesn&#39;t seem to be much point in using it."}, {"owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "reply_to_user": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "edited": false, "score": 0, "creation_date": 1527091507, "post_id": 50492461, "comment_id": 87998716, "body": "You&#39;re right... But you can always make your own function to convert the names like <code>Dark-Blue</code> to the xl names like <code>xlThemeColorLight2</code>, eh eh!! If you publish it, I&#39;ll sure give you a thumbs up..."}, {"owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "edited": false, "score": 0, "creation_date": 1527092492, "post_id": 50492461, "comment_id": 87999240, "body": "Unfortunately, while it seems you can get the color by name, you can&#39;t get the name from the color. You can get it&#39;s index number, but then you&#39;re back to square 1! Grumble, grumble, grumble..."}, {"owner": {"reputation": 12668, "user_id": 95852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e215c7362074d0346612a10d3a89be9e?s=128&d=identicon&r=PG", "display_name": "John Y", "link": "https://stackoverflow.com/users/95852/john-y"}, "reply_to_user": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "edited": false, "score": 1, "creation_date": 1541431787, "post_id": 50492461, "comment_id": 93205271, "body": "@MauryMarkowitz - That might be part of the point, though. It&#39;s a <i>theme</i>, so it&#39;s designed to be swappable. You should be able to switch from a light theme to a dark theme, or a subdued, pastel theme to a bright, garish theme by changing the theme but keeping the color index numbers."}], "tags": [], "owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "is_accepted": true, "score": 2, "last_activity_date": 1527090635, "last_edit_date": 1527090635, "creation_date": 1527090044, "answer_id": 50492461, "question_id": 50491929, "link": "https://stackoverflow.com/questions/50491929/selecting-theme-colors-in-excel-without-using-rgb-values/50492461#50492461", "title": "Selecting theme colors in Excel *without* using RGB values?", "body": "<p>I think you have to use the properties:</p>\n\n<pre><code>   .ThemeColor = xlThemeColorAccent5 'name of the theme\n   .TintAndShade = 0.25 'darkness (1 - no dark; -1 - max dark)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 3279536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bb7b5ac5baa4aff7bfba4414644f7f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3279536", "link": "https://stackoverflow.com/users/3279536/user3279536"}, "is_accepted": false, "score": 1, "last_activity_date": 1545215551, "last_edit_date": 1545215551, "creation_date": 1545214657, "answer_id": 53849064, "question_id": 50491929, "link": "https://stackoverflow.com/questions/50491929/selecting-theme-colors-in-excel-without-using-rgb-values/53849064#53849064", "title": "Selecting theme colors in Excel *without* using RGB values?", "body": "<pre><code>Sub DemoThemecolors()\n   Dim rng As Range\n   Dim n As Integer, m As Integer\n   Dim arrNames\n   Dim arrDescriptions\n   Dim arrValues\n   arrNames = Array(\"xlThemeColorAccent1\", \"xlThemeColorAccent2\", \"xlThemeColorAccent3\", \"xlThemeColorAccent4\", \"xlThemeColorAccent5\", \"xlThemeColorAccent6\", _\n                    \"xlThemeColorDark1\", \"xlThemeColorDark2\", \"xlThemeColorFollowedHyperlink\", \"xlThemeColorHyperlink\", \"xlThemeColorLight1\", \"xlThemeColorLight2\")\n   arrDescriptions = Array(\"Accent1\", \"Accent2\", \"Accent3\", \"Accent4\", \"Accent5\", \"Accent6\", \"Dark1\", \"Dark2\", \"Followed hyperlink\", \"Hyperlink\", \"Light1\", \"Light2\")\n   arrValues = Array(5, 6, 7, 8, 9, 10, 1, 3, 12, 11, 2, 4)\n\n   ActiveWorkbook.Worksheets.Add\n   Set rng = Cells(2, 7)\n   rng(0, 4).Value = \"TintAndShade\"\n   rng(1, 4).Value = 0\n   For m = 1 To 9\n      rng(1, m + 4).Value = 0.1 * m\n   Next m\n   rng(1, 1) = \"ThemeColor Name\"\n   rng(1, 2).Value = \"Value\"\n   rng(1, 3).Value = \"Description\"\n\n   For n = 1 To 12\n      rng(n + 1, 1).Value = arrNames(n)\n      rng(n + 1, 2).Value = arrValues(n)\n      rng(n + 1, 3).Value = arrDescriptions(n)\n      rng(n + 1, 4).Interior.ThemeColor = arrValues(n)\n      For m = 1 To 9\n         With rng(n + 1, m + 4).Interior\n            .ThemeColor = arrValues(n)\n            .TintAndShade = 0.1 * m\n         End With\n      Next m\n   Next n\n    Range(\"G1:S2\").Font.Bold = True\n    Columns(\"G:I\").EntireColumn.AutoFit\nEnd Sub\n</code></pre>\n\n<p>In case you wonder why all builtin Themes show dark colors for Light1/2 and light colors for Dark1/2 - It's probably a bug, or as MS would call it; it's a \"feature\" in Excel, and in Word too. In Powerpoint it's vice versa- more the way you would expect it to be.</p>\n"}], "owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4365, "favorite_count": 0, "accepted_answer_id": 50492461, "answer_count": 3, "score": 3, "last_activity_date": 1545215551, "creation_date": 1527088403, "last_edit_date": 1531161705, "question_id": 50491929, "link": "https://stackoverflow.com/questions/50491929/selecting-theme-colors-in-excel-without-using-rgb-values", "title": "Selecting theme colors in Excel *without* using RGB values?", "body": "<p>I was given a sheet and I'm trying to match a very dark blue they selected.</p>\n\n<p>When I click on the triangle beside the \"fill icon\" in the Home strip to bring up the color picker, I can see that color is the second from the bottom in the third column, the blues. It is called \"Dark Blue, Text 2, 25% Darker\".</p>\n\n<p>I'd like to do this in VBA and use english terms for clarity. I tried various web pages that list the VBA color names, but it's not there. Is there some way to select this without resorting to numeric RGB or similar?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1527088827, "post_id": 50491780, "comment_id": 87996993, "body": "What is your dictionary object?"}, {"owner": {"reputation": 105, "user_id": 9808154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd6a98412f53a13e79ec56c431df064?s=128&d=identicon&r=PG&f=1", "display_name": "ThisGuyJustNeedsHelp", "link": "https://stackoverflow.com/users/9808154/thisguyjustneedshelp"}, "reply_to_user": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1527088921, "post_id": 50491780, "comment_id": 87997048, "body": "@Brian FileList"}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 9808154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd6a98412f53a13e79ec56c431df064?s=128&d=identicon&r=PG&f=1", "display_name": "ThisGuyJustNeedsHelp", "link": "https://stackoverflow.com/users/9808154/thisguyjustneedshelp"}, "edited": false, "score": 0, "creation_date": 1527088573, "post_id": 50491965, "comment_id": 87996811, "body": "so how would i use it in my code? when i need the first 2 pictures on active sheet then any next two will have to be on a different sheet"}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1527088498, "creation_date": 1527088498, "answer_id": 50491965, "question_id": 50491780, "link": "https://stackoverflow.com/questions/50491780/logic-on-looping-and-condition-in-dictionary/50491965#50491965", "title": "Logic on looping and condition in dictionary", "body": "<p>Check out <code>MOD</code>.</p>\n\n<pre><code>if i MOD 2 = 0 then...\n</code></pre>\n\n<p><code>MOD</code> produces the modulo of a number. </p>\n\n<p>0 MOD 2 is 0 </p>\n\n<p>1 MOD 2 is 1 </p>\n\n<p>2 MOD 2 is 0 </p>\n\n<p>3 MOD 2 is 1 </p>\n\n<p>4 MOD 2 is 0</p>\n"}, {"comments": [{"owner": {"reputation": 105, "user_id": 9808154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd6a98412f53a13e79ec56c431df064?s=128&d=identicon&r=PG&f=1", "display_name": "ThisGuyJustNeedsHelp", "link": "https://stackoverflow.com/users/9808154/thisguyjustneedshelp"}, "edited": false, "score": 0, "creation_date": 1527089564, "post_id": 50492252, "comment_id": 87997482, "body": "The thing is, i need the next two pictures on a new sheet, then the next two pictures on another sheet and so forth."}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 105, "user_id": 9808154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd6a98412f53a13e79ec56c431df064?s=128&d=identicon&r=PG&f=1", "display_name": "ThisGuyJustNeedsHelp", "link": "https://stackoverflow.com/users/9808154/thisguyjustneedshelp"}, "edited": false, "score": 0, "creation_date": 1527089609, "post_id": 50492252, "comment_id": 87997510, "body": "@ThisGuyJustNeedsHelp I know. That doesn&#39;t do it for you?"}, {"owner": {"reputation": 105, "user_id": 9808154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd6a98412f53a13e79ec56c431df064?s=128&d=identicon&r=PG&f=1", "display_name": "ThisGuyJustNeedsHelp", "link": "https://stackoverflow.com/users/9808154/thisguyjustneedshelp"}, "edited": false, "score": 0, "creation_date": 1527089654, "post_id": 50492252, "comment_id": 87997537, "body": "no because it only puts 1 picture on active sheet then jumps to i &gt;1, then it only puts 1 pictures on each sheet it seems."}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 105, "user_id": 9808154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd6a98412f53a13e79ec56c431df064?s=128&d=identicon&r=PG&f=1", "display_name": "ThisGuyJustNeedsHelp", "link": "https://stackoverflow.com/users/9808154/thisguyjustneedshelp"}, "edited": false, "score": 0, "creation_date": 1527089699, "post_id": 50492252, "comment_id": 87997571, "body": "@ThisGuyJustNeedsHelp I made an edit. Sorry about that."}], "tags": [], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "is_accepted": false, "score": 0, "last_activity_date": 1527089665, "last_edit_date": 1527089665, "creation_date": 1527089397, "answer_id": 50492252, "question_id": 50491780, "link": "https://stackoverflow.com/questions/50491780/logic-on-looping-and-condition-in-dictionary/50492252#50492252", "title": "Logic on looping and condition in dictionary", "body": "<p>Will this work for you?</p>\n\n<pre><code>Dim PictureFilename As Variant\nDim FileList As Dictionary\n....\ni = 0\nFor Each PictureFilename In FileList '''Assuming you have a worksheet already.\n    If i &gt; 1 then\n        TabName = DefaultWorksheetNameAdder + \" \" + Format(Now(), \"mm-dd-yyyy\")\n        PicWorkbook.Sheets.Add(after:=PicWorkbook.Sheets(PicWorkbook.Sheets.Count)).Name = \"NewSheet\"\n        Set PicWorksheet = PicWorkbook.Sheets(PicWorkbook.Sheets.Count)\n        i = 0\n    Else\n        Set Photo = PicWorksheet.Shapes.AddPicture(CStr(PictureFilename), msoFalse, msoCTrue, 1, 1, -1, -1)\n        Set pic = Nothing\n        Set pic = Photo\n        colPictures.Add pic\n        i = i + 1\n    End If\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105, "user_id": 9808154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd6a98412f53a13e79ec56c431df064?s=128&d=identicon&r=PG&f=1", "display_name": "ThisGuyJustNeedsHelp", "link": "https://stackoverflow.com/users/9808154/thisguyjustneedshelp"}, "edited": false, "score": 0, "creation_date": 1527094777, "post_id": 50492785, "comment_id": 88000435, "body": "Perfecto. Thanks"}], "tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": true, "score": 0, "last_activity_date": 1527091428, "last_edit_date": 1527091428, "creation_date": 1527090961, "answer_id": 50492785, "question_id": 50491780, "link": "https://stackoverflow.com/questions/50491780/logic-on-looping-and-condition-in-dictionary/50492785#50492785", "title": "Logic on looping and condition in dictionary", "body": "<p><code>Mod</code> is your friend here.  I restructured your code some, but this should give you what you need:</p>\n\n<pre><code>Dim PictureFilename As Variant\nDim FileList As Dictionary\n\ni = 0\n\nFor Each PictureFilename In FileList\n    i = i + 1\n\n    If i &gt; 2 And i Mod 2 = 1 Then\n       TabName = DefaultWorksheetNameAdder + \" \" + Format(Now(), \"mm-dd-yyyy\")\n       PicWorkbook.Sheets.Add(after:=PicWorkbook.Sheets(PicWorkbook.Sheets.Count)).Name = \"NewSheet\"\n       Set PicWorksheet = PicWorkbook.Sheets(PicWorkbook.Sheets.Count)\n    End If\n\n    Set Photo = PicWorksheet.Shapes.AddPicture(CStr(PictureFilename), msoFalse, msoCTrue, 1, 1, -1, -1)\n    Set pic = Nothing\n    Set pic = Photo\n    colPictures.Add pic\nNext\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 9808154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd6a98412f53a13e79ec56c431df064?s=128&d=identicon&r=PG&f=1", "display_name": "ThisGuyJustNeedsHelp", "link": "https://stackoverflow.com/users/9808154/thisguyjustneedshelp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 50492785, "answer_count": 3, "score": 0, "last_activity_date": 1527091428, "creation_date": 1527087942, "last_edit_date": 1527088910, "question_id": 50491780, "link": "https://stackoverflow.com/questions/50491780/logic-on-looping-and-condition-in-dictionary", "title": "Logic on looping and condition in dictionary", "body": "<p>I am looping an dictionary and outputting it to activesheet the first 2 pictures then create additional sheet for the next two and so forth. Only want 2 pictures on each sheet depending on how many pictures maybe in the dictionary. I'm needing help on the logic as i'm unsure how to code the loop to only put 2 pictures after adding the first 2 to the active sheet.</p>\n\n<p>Heres the code:</p>\n\n<pre><code>Dim PictureFilename As Variant\nDim FileList As Dictionary\n....\nFor Each PictureFilename In FileList\n    i = i + 1\n    If i &gt;2 then\n        TabName = DefaultWorksheetNameAdder + \" \" + Format(Now(), \"mm-dd-yyyy\")\n        PicWorkbook.Sheets.Add(after:=PicWorkbook.Sheets(PicWorkbook.Sheets.Count)).Name = \"NewSheet\"\n        Set PicWorksheet = PicWorkbook.Sheets(PicWorkbook.Sheets.Count)\n\n        'how to handle the next two without having to code i &gt; 4 , i &gt; 6 ect.?\n    Else\n        Set Photo = PicWorksheet.Shapes.AddPicture(CStr(PictureFilename), msoFalse, msoCTrue, 1, 1, -1, -1)\n        Set pic = Nothing\n        Set pic = Photo\n        colPictures.Add pic\n    End If\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1527089782, "post_id": 50491695, "comment_id": 87997625, "body": "Do you care about the &quot;Change Subject&quot; notes?"}, {"owner": {"reputation": 1, "user_id": 2859557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c866d3585d593a6babddae7e3965fbef?s=128&d=identicon&r=PG&f=1", "display_name": "user2859557", "link": "https://stackoverflow.com/users/2859557/user2859557"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1527092591, "post_id": 50491695, "comment_id": 87999280, "body": "Yea but I figured that it is not super relevant since those are not problematic in the same sense."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 2859557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c866d3585d593a6babddae7e3965fbef?s=128&d=identicon&r=PG&f=1", "display_name": "user2859557", "link": "https://stackoverflow.com/users/2859557/user2859557"}, "edited": false, "score": 0, "creation_date": 1527139729, "post_id": 50492561, "comment_id": 88015466, "body": "This works exactly as I tried to make mine work. Thank you. Now I need to think about the logic to understand it better."}], "tags": [], "owner": {"reputation": 1198, "user_id": 3361377, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b2278758c8fd94df86e3e7f155e96bdb?s=128&d=identicon&r=PG&f=1", "display_name": "dcromley", "link": "https://stackoverflow.com/users/3361377/dcromley"}, "is_accepted": false, "score": 1, "last_activity_date": 1527090298, "creation_date": 1527090298, "answer_id": 50492561, "question_id": 50491695, "link": "https://stackoverflow.com/questions/50491695/vba-macro-to-find-specific-strings-while-maintaining-the-ordering/50492561#50492561", "title": "VBA macro to find specific strings while maintaining the ordering", "body": "<p>I think you want a \"reportrow\" in addition to a \"datarow\" (i).</p>\n\n<pre><code>  reportrow = 2\n  For i = 1 To finalrow\n    SearchString = datasheet.Range(\"A\" &amp; i)\n    If InStr(1, SearchString, \"Change Number\") Then\n      Cells(i, 1).Copy\n      reportsheet.Select\n      Cells(reportrow, 1).PasteSpecial xlPasteFormulasAndNumberFormats\n      reportrow = reportrow + 1\n      datasheet.Select\n    ElseIf InStr(1, SearchString, \"Report-\") Then\n      Cells(i, 1).Copy\n      reportsheet.Select\n      Cells(reportrow, 2).PasteSpecial xlPasteFormulasAndNumberFormats\n      reportrow = reportrow + 1\n      datasheet.Select\n    End If\n  Next i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1198, "user_id": 3361377, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b2278758c8fd94df86e3e7f155e96bdb?s=128&d=identicon&r=PG&f=1", "display_name": "dcromley", "link": "https://stackoverflow.com/users/3361377/dcromley"}, "edited": false, "score": 0, "creation_date": 1527103987, "post_id": 50493057, "comment_id": 88005040, "body": ". . . . . . . ."}, {"owner": {"reputation": 1, "user_id": 2859557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c866d3585d593a6babddae7e3965fbef?s=128&d=identicon&r=PG&f=1", "display_name": "user2859557", "link": "https://stackoverflow.com/users/2859557/user2859557"}, "edited": false, "score": 0, "creation_date": 1527140890, "post_id": 50493057, "comment_id": 88015942, "body": "Hmm, this works better than the copy-paste method since this runs much faster and with less performance requirements. Thank you for this. I need to try to understand the code now :)"}, {"owner": {"reputation": 1, "user_id": 2859557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c866d3585d593a6babddae7e3965fbef?s=128&d=identicon&r=PG&f=1", "display_name": "user2859557", "link": "https://stackoverflow.com/users/2859557/user2859557"}, "edited": false, "score": 0, "creation_date": 1527141641, "post_id": 50493057, "comment_id": 88016297, "body": "It interestingly extracts the Change Subject notes only if there are multiple Reports under the change. Gonna come back when I figure it out."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "reply_to_user": {"reputation": 1, "user_id": 2859557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c866d3585d593a6babddae7e3965fbef?s=128&d=identicon&r=PG&f=1", "display_name": "user2859557", "link": "https://stackoverflow.com/users/2859557/user2859557"}, "edited": false, "score": 0, "creation_date": 1527168121, "post_id": 50493057, "comment_id": 88033202, "body": "@user2859557 The following link leads to an answer with some basic dictionary properties/methods, with some examples. <a href=\"https://stackoverflow.com/a/32487945/9259306\">stackoverflow.com/a/32487945/9259306</a>"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "reply_to_user": {"reputation": 1, "user_id": 2859557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c866d3585d593a6babddae7e3965fbef?s=128&d=identicon&r=PG&f=1", "display_name": "user2859557", "link": "https://stackoverflow.com/users/2859557/user2859557"}, "edited": false, "score": 0, "creation_date": 1527170234, "post_id": 50493057, "comment_id": 88034698, "body": "@user2859557 I tried double-checking the second code I included, running it on sample data (without changing anything). I attached images of my sample data, before/after. It looked like it worked for me. Did you make any changes to the code?"}, {"owner": {"reputation": 1, "user_id": 2859557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c866d3585d593a6babddae7e3965fbef?s=128&d=identicon&r=PG&f=1", "display_name": "user2859557", "link": "https://stackoverflow.com/users/2859557/user2859557"}, "edited": false, "score": 0, "creation_date": 1527577832, "post_id": 50493057, "comment_id": 88165775, "body": "Sorry for late reply. I only modified the strings that are sought after with InStr since I didn&#39;t include the complete original data for privacy reasons. But now that I think it might be this reason for why the code isn&#39;t working since there arent always 3 details under a change. I have been trying to make it work through InStr searches for the change details too but there I seem to lose the ordering."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "reply_to_user": {"reputation": 1, "user_id": 2859557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c866d3585d593a6babddae7e3965fbef?s=128&d=identicon&r=PG&f=1", "display_name": "user2859557", "link": "https://stackoverflow.com/users/2859557/user2859557"}, "edited": false, "score": 0, "creation_date": 1527601983, "post_id": 50493057, "comment_id": 88181453, "body": "@user2859557 I&#39;ve updated the &quot;Edit&quot; section to account for the variable number of &quot;details&quot;. I also included some explanation of the sections I changed."}, {"owner": {"reputation": 1, "user_id": 2859557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c866d3585d593a6babddae7e3965fbef?s=128&d=identicon&r=PG&f=1", "display_name": "user2859557", "link": "https://stackoverflow.com/users/2859557/user2859557"}, "edited": false, "score": 0, "creation_date": 1527657856, "post_id": 50493057, "comment_id": 88202849, "body": "I am speechless for your helpfulness. I actually tried to do the exactly same thing (matching strings) with some success but it was awful looking and had bugs. Would&#39;ve never figured out how useful dictionaries are for a task like this."}], "tags": [], "owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "is_accepted": false, "score": 1, "last_activity_date": 1527601879, "last_edit_date": 1527601879, "creation_date": 1527092107, "answer_id": 50493057, "question_id": 50491695, "link": "https://stackoverflow.com/questions/50491695/vba-macro-to-find-specific-strings-while-maintaining-the-ordering/50493057#50493057", "title": "VBA macro to find specific strings while maintaining the ordering", "body": "<p>This code requires adding a reference to the <strong>Microsoft Scripting Runtime</strong> library (for the dictionaries). I based this code on several assumptions:</p>\n\n<ul>\n<li><p>That the reports are always placed directly under their associated change number.</p></li>\n<li><p>That the Change Numbers are all unique</p></li>\n<li><p>That the Report Numbers associated with a change number, are all unique.</p></li>\n<li><p>That there are always three descriptions to a report:</p>\n\n<ul>\n<li>Workload</li>\n<li>Requirements</li>\n<li>Development</li>\n</ul></li>\n<li><p>That you have no interest in preserving the \"Change Subject\" Notes directly under each Change Number (This has been further addressed in edit below)</p></li>\n</ul>\n\n<hr>\n\n<p>Instead of directly moving the information from one sheet to the other, this code collects the data into a dictionary; then extracts that data back to the final worksheet. This also gets the data from Sheet1 column B to Sheet2 columns D,E,F</p>\n\n<hr>\n\n<pre><code>Sub search_and_extract()\n\n    Dim datasheet As Worksheet\n    Dim reportsheet As Worksheet\n\n    Dim SearchString As String\n    Dim i As Integer\n    Dim j As Integer\n\n    Set datasheet = Sheet1\n    Set reportsheet = Sheet2\n\n    Dim chNum As String\n    Dim rptNum As String\n    Dim ChangeNumbers As New Dictionary\n\n    Dim dictKey1 As Variant\n    Dim dictKey2 As Variant\n\n    reportsheet.Range(\"A1:H200\").ClearContents\n    finalrow = datasheet.Cells(datasheet.Rows.Count, 1).End(xlUp).Row\n\n    For i = 1 To finalrow\n        SearchString = datasheet.Range(\"A\" &amp; i)\n\n        If InStr(1, SearchString, \"Change Number\") Then\n            chNum = datasheet.Cells(i, 1)\n            ChangeNumbers.Add chNum, New Dictionary 'For report numbers\n        ElseIf InStr(1, SearchString, \"Report-\") Then\n            rptNum = datasheet.Cells(i, 1)\n            ChangeNumbers.Item(chNum).Add rptNum, New Dictionary 'For details\n\n            For j = 0 To 2\n                ChangeNumbers.Item(chNum).Item(rptNum).Add j, datasheet.Cells(i, 1).Offset(j, 1) ' the details\n            Next j\n        End If\n    Next i\n\n    i = 1\n    For Each dictKey1 In ChangeNumbers.Keys\n        reportsheet.Cells(i, 1) = dictKey1\n\n        If ChangeNumbers.Item(dictKey1).Count &gt; 0 Then\n            For Each dictKey2 In ChangeNumbers.Item(dictKey1).Keys\n                reportsheet.Cells(i, 2) = dictKey2\n\n                For j = 0 To 2\n                    reportsheet.Cells(i, 4 + j) = ChangeNumbers.Item(dictKey1).Item(dictKey2).Item(j)\n                Next j\n                i = i + 1 'moves to new row for new report (or next change number\n            Next dictKey2\n        Else\n            i = i + 1 'no reports, so moves down to prevent overwriting change number\n        End If\n    Next dictKey1\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Edit:</strong></p>\n\n<p>Sample on including change subject, if desired. This assumes (in addition to above):</p>\n\n<ul>\n<li>The change subject is always before the relevant report(s)</li>\n<li>That there will not be <strong>any</strong> reports without change subjects</li>\n<li>That the change subject will go in column C. (This can be edited, for example, to column G by changing <code>reportsheet.Cells(i, 3)</code> to <code>reportsheet.Cells(i, 7)</code>)</li>\n</ul>\n\n<p>There were also some changes to the detail-loop sections to accommodate for a changing number of details. This code is structured so that each detail-type will consistently be placed in the same column (i.e. a column for the Requirements, a column for the Development, etc.)</p>\n\n<p>Primary changes for the detail-loop sections were from this:</p>\n\n<pre><code>For j = 0 To 2\n    ChangeNumbers.Item(chNum).Item(chSub).Item(rptNum).Add j, datasheet.Cells(i, 1).Offset(j, 1) ' the details\nNext j\n</code></pre>\n\n<p>to this (Only two sample types of detail were included. Also note that currently, the destination column number is hard-coded -- it may be better to make constants for the required column numbers, to make the code more read-able and easier to maintain.):</p>\n\n<pre><code>j = 0\n\nDo While IsEmpty(datasheet.Cells(i + j, 1)) Or datasheet.Cells(i + j, 1) = rptNum\n    If InStr(1, datasheet.Cells(i + j, 2), \"Specified\") Then\n        ' The 4 after \".Add\" is the column number for this detail in sheet2\n        ChangeNumbers.Item(chNum).Item(chSub).Item(rptNum).Add 4, datasheet.Cells(i + j, 2) ' the details\n    ElseIf InStr(1, datasheet.Cells(i + j, 2), \"Total Workload\") Then\n        ' The 5 after \".Add\" is the column number for this detail in sheet2\n        ChangeNumbers.Item(chNum).Item(chSub).Item(rptNum).Add 5, datasheet.Cells(i + j, 2) ' the details\n    End If\n\n    j = j + 1\nLoop\n</code></pre>\n\n<p>and from this:</p>\n\n<pre><code>For j = 0 To 2\n    reportsheet.Cells(i, 4 + j) = ChangeNumbers.Item(dictKey1).Item(dictKey2).Item(dictKey3).Item(j)\nNext j\n</code></pre>\n\n<p>to this (Please note the additional variable required):</p>\n\n<pre><code>Dim dictKey4\n\nFor each dictKey4 In ChangeNumbers.Item(dictKey1).Item(dictKey2).Item(dictKey3).Keys\n    reportsheet.Cells(i, dictKey4) = ChangeNumbers.Item(dictKey1).Item(dictKey2).Item(dictKey3).Item(dictKey4)\nNext dictKey4\n</code></pre>\n\n<hr>\n\n<pre><code>Sub search_and_extract()\n\n    Dim datasheet As Worksheet\n    Dim reportsheet As Worksheet\n\n    Dim SearchString As String\n    Dim i As Integer\n    Dim j As Integer\n\n    Set datasheet = Sheet1\n    Set reportsheet = Sheet2\n\n    Dim chNum As String\n    Dim chSub as String\n    Dim rptNum As String\n    Dim ChangeNumbers As New Dictionary\n\n    Dim dictKey1 As Variant\n    Dim dictKey2 As Variant\n    Dim dictKey3 As Variant\n    Dim dictKey4 As Variant\n\n    reportsheet.Range(\"A1:H200\").ClearContents\n    finalrow = datasheet.Cells(datasheet.Rows.Count, 1).End(xlUp).Row\n\n    For i = 1 To finalrow\n        SearchString = datasheet.Range(\"A\" &amp; i)\n\n        If InStr(1, SearchString, \"Change Number\") Then\n            chNum = datasheet.Cells(i, 1)\n            ChangeNumbers.Add chNum, New Dictionary 'For report numbers\n        ElseIf InStr(1, SearchString, \"Change Subject\") Then\n            chSub = datasheet.Cells(i, 1)\n            ChangeNumbers.Item(chNum).Add chSub, New Dictionary 'For report numbers\n        ElseIf InStr(1, SearchString, \"Report-\") Then\n            rptNum = datasheet.Cells(i, 1)\n            ChangeNumbers.Item(chNum).Item(chSub).Add rptNum, New Dictionary 'For details\n\n            j = 0\n\n            'Verifies that the details belong to the current report\n            'String checks are included after locating a report to maintain a connection between the report and its details\n            Do While IsEmpty(datasheet.Cells(i + j, 1)) Or datasheet.Cells(i + j, 1) = rptNum\n                If InStr(1, datasheet.Cells(i + j, 2), \"Specified\") Then\n                    ' The 4 after \".Add\" is the column number for this detail in sheet2\n                    ChangeNumbers.Item(chNum).Item(chSub).Item(rptNum).Add 4, datasheet.Cells(i + j, 2) ' the details\n                ElseIf InStr(1, datasheet.Cells(i + j, 2), \"Total Workload\") Then\n                    ' The 5 after \".Add\" is the column number for this detail in sheet2\n                    ChangeNumbers.Item(chNum).Item(chSub).Item(rptNum).Add 5, datasheet.Cells(i + j, 2) ' the details\n                End If\n\n                j = j + 1\n            Loop\n        End If\n    Next i\n\n    i = 1\n    For Each dictKey1 In ChangeNumbers.Keys\n        reportsheet.Cells(i, 1) = dictKey1 'Change Number\n\n        If ChangeNumbers.Item(dictKey1).Count &gt; 0 Then\n            For Each dictKey2 In ChangeNumbers.Item(dictKey1).Keys\n                reportsheet.Cells(i, 3) = dictKey2 'Change Subject; assuming in column C on same row as Change Number\n\n                If ChangeNumbers.Item(dictKey1).Item(dictKey2).Count &gt; 0 Then\n                    For Each dictKey3 In ChangeNumbers.Item(dictKey1).Item(dictKey2).Keys 'Report Number\n                        reportsheet.Cells(i, 2) = dictKey3\n                        'reportsheet.Cells(i, 3) = dictKey2 'Uncomment if you want change subject in every row w/ matching report\n\n                        For each dictKey4 In ChangeNumbers.Item(dictKey1).Item(dictKey2).Item(dictKey3).Keys\n                            reportsheet.Cells(i, dictKey4) = ChangeNumbers.Item(dictKey1).Item(dictKey2).Item(dictKey3).Item(dictKey4)\n                        Next dictKey4\n                        i = i + 1 'moves to new row for new report (or next change number\n                    Next dictKey3\n                Else\n                    i = i + 1 'no reports, so moves down to prevent overwriting change number\n                End If\n            Next dictKey2\n        Else\n            i = i + 1 'no change subject, so moves down to prevent overwriting change number\n        End If\n    Next dictKey1\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 2859557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c866d3585d593a6babddae7e3965fbef?s=128&d=identicon&r=PG&f=1", "display_name": "user2859557", "link": "https://stackoverflow.com/users/2859557/user2859557"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1527601879, "creation_date": 1527087729, "question_id": 50491695, "link": "https://stackoverflow.com/questions/50491695/vba-macro-to-find-specific-strings-while-maintaining-the-ordering", "title": "VBA macro to find specific strings while maintaining the ordering", "body": "<p>My data has change request data in column A and B. I would need to move this data so that all data related to a single change request would be on its own row.</p>\n\n<p>I have been working on an VBA macro that would loop through Sheet1 A-column to find specific strings and then paste those to different columns on Sheet2 depending on which type of String it is.</p>\n\n<p>So far I have gotten somewhere with this but my problem is as follows: I have data in A-column that has Change Numbers and Report Numbers. Change number can have multiple Reports under it. When I loop through this I manage to get:</p>\n\n<ul>\n<li>Change Numbers to column A</li>\n<li>Report Numbers to column B</li>\n</ul>\n\n<p>However, as there are sometimes multiple reports under a single Change Number I am struggling to keep these in the right order. Change numbers would need to skip rows according to the amount of reports under the previous change number. How do I make the change numbers skip cells according to the amount of reports under them? I tried using another loop inside my current loop to check how many reports does a change have but couldn't seem to make it work.</p>\n\n<p>My code at the moment looks like this:</p>\n\n<pre><code>Sub search_and_extract()\n\nDim datasheet As Worksheet\nDim reportsheet As Worksheet\n\nDim SearchString As String\nDim i As Integer\n\nSet datasheet = Sheet1\nSet reportsheet = Sheet2\n\nreportsheet.Range(\"A1:H200\").ClearContents\n\ndatasheet.Select\nfinalrow = Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 1 To finalrow\nSearchString = datasheet.Range(\"A\" &amp; i)\n    If InStr(1, SearchString, \"Change Number\") Then\n        Cells(i, 1).Copy\n        reportsheet.Select\n        Range(\"A200\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats\n        datasheet.Select\n\n    ElseIf InStr(1, SearchString, \"Report-\") Then\n        Cells(i, 1).Copy\n        reportsheet.Select\n        Range(\"B200\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats\n        datasheet.Select\n        End If\nNext i\nreportsheet.Select\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/c0l8n.png\" rel=\"nofollow noreferrer\">pic of the formatting of my excel if that helps</a></p>\n\n<p>I will be also trying to get the data from Sheet1 column B to Sheet2 columns D,E,F etc but that is a worry of the future.</p>\n"}, {"tags": ["vba", "excel", "function"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1527088317, "last_edit_date": 1527088317, "creation_date": 1527087997, "answer_id": 50491799, "question_id": 50491666, "link": "https://stackoverflow.com/questions/50491666/basic-function-with-2-variables-not-working-in-excel/50491799#50491799", "title": "Basic function with 2 variables not working in Excel", "body": "<p>In Germany, you should use German separators. Thus function should be written like this in Excel:</p>\n\n<pre><code>=Canyou(12;2)\n</code></pre>\n\n<p>Or like this, if you want to give floating point value as first argument -\n<code>=Canyou(12,2;2)</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/w1VTW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w1VTW.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 58, "user_id": 8153534, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211412744427345/picture?type=large", "display_name": "Wim F", "link": "https://stackoverflow.com/users/8153534/wim-f"}, "is_accepted": false, "score": 0, "last_activity_date": 1527088380, "creation_date": 1527088380, "answer_id": 50491920, "question_id": 50491666, "link": "https://stackoverflow.com/questions/50491666/basic-function-with-2-variables-not-working-in-excel/50491920#50491920", "title": "Basic function with 2 variables not working in Excel", "body": "<p>The function works for me having comma as list separator.</p>\n\n<p>In case you are not sure of the separator settings on your PC, check in windows.\nRegion and Language / Additional settings/ List separator.</p>\n\n<p>Kr,</p>\n\n<p>W</p>\n"}, {"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1527089841, "creation_date": 1527089841, "answer_id": 50492395, "question_id": 50491666, "link": "https://stackoverflow.com/questions/50491666/basic-function-with-2-variables-not-working-in-excel/50492395#50492395", "title": "Basic function with 2 variables not working in Excel", "body": "<p>Functions have to be in standard modules not worksheet modules if you wish to use them on the spreadsheet. You should also declare them as Public</p>\n"}], "owner": {"reputation": 11, "user_id": 9835340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/963bf33ed0cc78fa1d4572f9472d4e17?s=128&d=identicon&r=PG&f=1", "display_name": "F.H.Bokhari", "link": "https://stackoverflow.com/users/9835340/f-h-bokhari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1527089841, "creation_date": 1527087632, "last_edit_date": 1527088340, "question_id": 50491666, "link": "https://stackoverflow.com/questions/50491666/basic-function-with-2-variables-not-working-in-excel", "title": "Basic function with 2 variables not working in Excel", "body": "<p>I made a super basic function as follows:</p>\n\n<pre><code>Option Explicit\n\nFunction Canyou(A As Double, B As Double) As Double\n    Canyou = A + B\nEnd Function\n</code></pre>\n\n<p>The function is in a module in the worksheet where I want to use it. I then went into the worksheet and typed:\n= Canyou(2,3)\nAnd I get a value error. I tried instead to select cells with numbers in them like:\n= Canyou (A1, B2)\nand that didn't work at all.</p>\n\n<p>Background info: I am working with a German version of Excel. But I also tried changing the commas to semicolon etc and none of this works (commas work in other places just fine).</p>\n\n<p>Any ideas?</p>\n\n<p>Thanks,\nFHB<a href=\"https://i.stack.imgur.com/a0G3Y.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "reply_to_user": {"reputation": 11, "user_id": 9789102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d35b59ae30b0ec8701a018378456ecc?s=128&d=identicon&r=PG&f=1", "display_name": "Mike F.", "link": "https://stackoverflow.com/users/9789102/mike-f"}, "edited": false, "score": 0, "creation_date": 1527088128, "post_id": 50491722, "comment_id": 87996535, "body": "@MikeF. I accidentally posted too soon. See my finished answer."}, {"owner": {"reputation": 11, "user_id": 9789102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d35b59ae30b0ec8701a018378456ecc?s=128&d=identicon&r=PG&f=1", "display_name": "Mike F.", "link": "https://stackoverflow.com/users/9789102/mike-f"}, "edited": false, "score": 0, "creation_date": 1527088463, "post_id": 50491722, "comment_id": 87996738, "body": "ok, now it is throwing Run-time error &#39;1004&#39;: Method &quot;Range&#39; of object&#39;_Worksheet&#39; failed on line 8 still"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "reply_to_user": {"reputation": 11, "user_id": 9789102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d35b59ae30b0ec8701a018378456ecc?s=128&d=identicon&r=PG&f=1", "display_name": "Mike F.", "link": "https://stackoverflow.com/users/9789102/mike-f"}, "edited": false, "score": 0, "creation_date": 1527088553, "post_id": 50491722, "comment_id": 87996802, "body": "@MikeF. I had accidentally posted my answer in the middle of typing. If you haven&#39;t assigned a value to <code>ws</code>, it&#39;s going to throw an error every time you reference it."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "reply_to_user": {"reputation": 11, "user_id": 9789102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d35b59ae30b0ec8701a018378456ecc?s=128&d=identicon&r=PG&f=1", "display_name": "Mike F.", "link": "https://stackoverflow.com/users/9789102/mike-f"}, "edited": false, "score": 0, "creation_date": 1527088767, "post_id": 50491722, "comment_id": 87996949, "body": "@MikeF. Sorry, just identified another issue. If you append the total number of rows (i.e. 1000000) to <code>G3</code>, it thinks you are trying to reference the range <code>G31000000</code> or G-31 Million. which is probably why the range method failed. I corrected my code."}, {"owner": {"reputation": 11, "user_id": 9789102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d35b59ae30b0ec8701a018378456ecc?s=128&d=identicon&r=PG&f=1", "display_name": "Mike F.", "link": "https://stackoverflow.com/users/9789102/mike-f"}, "edited": false, "score": 0, "creation_date": 1527088801, "post_id": 50491722, "comment_id": 87996967, "body": "Yeah, i updated my script to reflect yours.  I have the Set ws = sheets(&quot;Overall Stats&quot; and it is grabbing that sheet now.  i am getting a different error now though."}], "tags": [], "owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "is_accepted": true, "score": 0, "last_activity_date": 1527088958, "last_edit_date": 1527088958, "creation_date": 1527087794, "answer_id": 50491722, "question_id": 50491537, "link": "https://stackoverflow.com/questions/50491537/i-am-getting-run-time-error-91-object-variable-or-with-block-variable-not-set/50491722#50491722", "title": "I am getting run-time error &#39;91&#39;: Object variable or With block variable not set on sheet. Possibly not selecting worksheet?", "body": "<p>A few comments:</p>\n\n<ul>\n<li><p>Until a variable is assigned a value, it contains the default. For a long, that's <code>0</code>; for a worksheet (or other object) that's <code>Nothing</code>.</p></li>\n<li><p>Usually, people try to avoid using <code>.Select</code> in code, because it slows it down.</p>\n\n<ul>\n<li>I also don't know what the code would try to do with this: <code>With Sheets(\"Overall Stats\").Select</code></li>\n</ul></li>\n<li><p>When using a <code>With ws</code> statement, that means that a line like <code>ws.Range(\"A1\")</code> can become <code>.Range(\"A1\")</code> instead. <strong>Note:</strong> if you omit the period (i.e. use <code>Range(\"A1\")</code>, the code will default to using the designated range from the ActiveWorksheet -- which is not necessarily the one specified in the <code>With</code> statement.)</p></li>\n</ul>\n\n<hr>\n\n<p>See updated code below:</p>\n\n<pre><code>Sub ConditionalFormat()\n\n    Dim LR As Long, i As Long\n    Dim ws As Worksheet\n\n    Set ws = Sheets(\"Overall Stats\")\n\n\n    With ws\n        LR = .Range(\"G\" &amp; .Rows.Count).End(xlUp).Row 'Line 8 here 'removed the `3` from `G3`\n        For i = 1 To LR\n            With .Range(\"G\" &amp; i)\n                If .Value = \"ISO2\" Then\n\n                    Range(ws.Range(\"L3\"), ws.Range(\"L3\").End(xlDown)).FormatConditions.AddColorScale ColorScaleType:=3\n\n                    'End With 'This line is extraneous and should be removed. It WILL throw an error, if uncommented.\n                End If\n            End With\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9789102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d35b59ae30b0ec8701a018378456ecc?s=128&d=identicon&r=PG&f=1", "display_name": "Mike F.", "link": "https://stackoverflow.com/users/9789102/mike-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "accepted_answer_id": 50491722, "answer_count": 1, "score": 0, "last_activity_date": 1527088958, "creation_date": 1527087273, "last_edit_date": 1531164843, "question_id": 50491537, "link": "https://stackoverflow.com/questions/50491537/i-am-getting-run-time-error-91-object-variable-or-with-block-variable-not-set", "title": "I am getting run-time error &#39;91&#39;: Object variable or With block variable not set on sheet. Possibly not selecting worksheet?", "body": "<p>I am getting \"run-time error '91': Object variable or With block variable not set\" when I try to run this code.  the error comes up on line 8.  In my locals window I see:</p>\n\n<p>Expression : Value : Type</p>\n\n<p>LR : 0 : 0</p>\n\n<p>i : 0 : 0</p>\n\n<p>ws : Nothing : Worksheet</p>\n\n<p>So I believe that it is not selecting the worksheet but I may be way off here.\nI am new to VBA scripting still so any help would be appreciated!</p>\n\n<pre><code>    Sub ConditionalFormat()\n\n    Dim LR As Long, i As Long\n    Dim ws As Worksheet\n\n\n     With Sheets(\"Overall Stats\").Select\n        LR = ws.Range(\"G3\" &amp; Rows.Count).End(xlUp).Row 'Line 8 here\n            For i = 1 To LR\n                With ws.Range(\"G\" &amp; i)\n                   If .Value = \"ISO2\" Then\n\n                        Range(\"L3\").Select\n                        Range(Selection, Selection.End(xlDown)).Select\n                        Selection.FormatConditions.AddColorScale ColorScaleType:=3\n\n                        End With\n                    End If\n                End With\n            Next i\n        End With\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "activex"], "comments": [{"owner": {"reputation": 1, "user_id": 9835338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58bdc8f8a3259c6d1d3ced12b219e6d8?s=128&d=identicon&r=PG&f=1", "display_name": "MC77", "link": "https://stackoverflow.com/users/9835338/mc77"}, "edited": false, "score": 0, "creation_date": 1527087292, "post_id": 50491513, "comment_id": 87995947, "body": "I don&#39;t know why it&#39;s all on the same row and very hard to read.. Sorry about that."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1527087336, "post_id": 50491513, "comment_id": 87995987, "body": "It seems you are missing a <code>Select Case</code>?"}, {"owner": {"reputation": 1, "user_id": 9835338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58bdc8f8a3259c6d1d3ced12b219e6d8?s=128&d=identicon&r=PG&f=1", "display_name": "MC77", "link": "https://stackoverflow.com/users/9835338/mc77"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1527087914, "post_id": 50491513, "comment_id": 87996400, "body": "Yes, I thought so also.  I did include Select Case Value under Value = ComboBox1 but it didnt make a difference."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1527087991, "post_id": 50491513, "comment_id": 87996448, "body": "<a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/select-case-statement\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/visual-basic/language-refere&zwnj;&#8203;nce/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 9835338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58bdc8f8a3259c6d1d3ced12b219e6d8?s=128&d=identicon&r=PG&f=1", "display_name": "MC77", "link": "https://stackoverflow.com/users/9835338/mc77"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1527088441, "post_id": 50491513, "comment_id": 87996725, "body": "Thanks mate, but I&#39;m just a lowly accountant so that blew my mind.  Essentially I think I need to define my drop down items in the Select list.  Let&#39;s start simple.  Is Select Case Value a true statement?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9835338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58bdc8f8a3259c6d1d3ced12b219e6d8?s=128&d=identicon&r=PG&f=1", "display_name": "MC77", "link": "https://stackoverflow.com/users/9835338/mc77"}, "edited": false, "score": 0, "creation_date": 1527088646, "post_id": 50491976, "comment_id": 87996871, "body": "Thanks.  Now on the first Total I receive an error &quot;Compile error: Expected Function or variable&quot;"}, {"owner": {"reputation": 1, "user_id": 9835338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58bdc8f8a3259c6d1d3ced12b219e6d8?s=128&d=identicon&r=PG&f=1", "display_name": "MC77", "link": "https://stackoverflow.com/users/9835338/mc77"}, "edited": false, "score": 0, "creation_date": 1527089379, "post_id": 50491976, "comment_id": 87997349, "body": "Let&#39;s start from the start.    I create a drop down list using the Combo Box (ActiveX Control) option.  Excel then provides this list a name such as ComboBox1 and it is this name I use when entering &quot;Select Case ComboBox1.Value&quot;?"}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1527088540, "creation_date": 1527088540, "answer_id": 50491976, "question_id": 50491513, "link": "https://stackoverflow.com/questions/50491513/activex-combobox-to-drive-workbook-formatting/50491976#50491976", "title": "ActiveX ComboBox to drive workbook formatting", "body": "<p>It looks like you are trying to do something like this:</p>\n\n<pre><code>Sub ComboBox1_Change()\n  Select Case ComboBox1.Value\n    Case \"Total\"\n      MsgBox \"Total\"\n    Case \"Blank\"\n      MsgBox \"Products\"\n    Case \"Products\"\n      MsgBox \"Services\"\n  End Select\nEnd Sub\n</code></pre>\n\n<p>Does that meet your needs?</p>\n"}], "owner": {"reputation": 1, "user_id": 9835338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58bdc8f8a3259c6d1d3ced12b219e6d8?s=128&d=identicon&r=PG&f=1", "display_name": "MC77", "link": "https://stackoverflow.com/users/9835338/mc77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527088540, "creation_date": 1527087217, "last_edit_date": 1527087305, "question_id": 50491513, "link": "https://stackoverflow.com/questions/50491513/activex-combobox-to-drive-workbook-formatting", "title": "ActiveX ComboBox to drive workbook formatting", "body": "<p>I would like to use an an ActiveX ComboBox to drive the formatting of the Excel workbook.</p>\n\n<p>Particulars of relevance:</p>\n\n<pre><code>- ComboBox name: ComboBox1\n- ComboBox options: Total, Products, Services\n</code></pre>\n\n<p>My macro thus far:</p>\n\n<pre><code>Sub ComboBox1_Change()\n  Value = ComboBox1\n  Case Total\n  MsgBox \"Total\"\n  Case Blank\n  MsgBox \"Products\"\n  Case Products\n  MsgBox \"Services\"\n  End Select\nEnd Sub\n</code></pre>\n\n<p>To test it's working I have simply included the message display however this will be amended once all is running smoothly.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel", "for-loop", "search"], "comments": [{"owner": {"reputation": 167, "user_id": 9630197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d5cd6a208cf541aea4da0c87ac2e3e?s=128&d=identicon&r=PG&f=1", "display_name": "SB999", "link": "https://stackoverflow.com/users/9630197/sb999"}, "edited": false, "score": 0, "creation_date": 1527087547, "post_id": 50491435, "comment_id": 87996136, "body": "@Nathan_Sav the current loop is iterating through values within a summed row. In row 9 is &quot;Actual&quot; &amp; &quot;Forecast&quot; dependant on the current month. The offset is checking this. (I have changed the offsets so they are correct in the scenario)"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1527088107, "post_id": 50491435, "comment_id": 87996525, "body": "When you say <code>&lt;&gt;0</code> do you mean <code>-5</code> and <code>A</code> are ok?  Or does formula on the sheet ensure no letters are returned and only numbers greater than 0 for instance?"}, {"owner": {"reputation": 167, "user_id": 9630197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d5cd6a208cf541aea4da0c87ac2e3e?s=128&d=identicon&r=PG&f=1", "display_name": "SB999", "link": "https://stackoverflow.com/users/9630197/sb999"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1527088722, "post_id": 50491435, "comment_id": 87996928, "body": "@DarrenBartrup-Cook -5 is okay (Any numeric number except 0) is okay. The formula on the sheet ensures there is no letters. (Its protected)"}], "owner": {"reputation": 167, "user_id": 9630197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d5cd6a208cf541aea4da0c87ac2e3e?s=128&d=identicon&r=PG&f=1", "display_name": "SB999", "link": "https://stackoverflow.com/users/9630197/sb999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527089071, "creation_date": 1527086970, "last_edit_date": 1531164843, "question_id": 50491435, "link": "https://stackoverflow.com/questions/50491435/search-right-to-left-multiple-ranges", "title": "Search Right to left (Multiple Ranges)", "body": "<p>All I have the below <code>For Each</code> loop which returns the last column which has a value &lt;>0. This works fine although I'm sure there is a more efficient way. </p>\n\n<pre><code>    Dim LastColFcst As Integer\n    For Each p In Range(\"E44:P44,S44:AD44,AG44:AR44,AU44:BF44,BI44:BU44\")\n    If p.Value &lt;&gt; 0 And p.Offset(-35, 0).Value = \"Forecast\" Then\n    LastColFcst = p.Column\n    End If\n    Next p\n</code></pre>\n\n<p>I now wish to get the last column with a value &lt;>0  for different rows 86,88,95,99. I can achieve this by copy and pasting my orginal code for four rows and having an IF Statement. However this seems like a very inefficient way to achieve a simple task. Sample code below; **EDIT Full sample (Long inefficient code posted below)</p>\n\n<pre><code>    Dim LastColFcst As Integer\nFor Each p In Range(\"E86:P86,S86:AD86,AG86:AR86,AU86:BF86,BI86:BU86\")\nIf p.Value &lt;&gt; 0 And p.Offset(-77, 0).Value = \"Forecast\" Then\nLastColFcst = p.Column\nEnd If\nNext p\n\nFor Each L In Range(\"E88:P88,S88:AD88,AG88:AR88,AU88:BF88,BI88:BU88\")\nIf L.Value &lt;&gt; 0 And L.Offset(-79, 0).Value = \"Forecast\" And L.Column &gt; LastColFcst Then\nLastColFcst = L.Column\nEnd If\nNext L\n\nFor Each J In Range(\"E95:P95,S95:AD95,AG95:AR95,AU95:BF95,BI95:BU95\")\nIf J.Value &lt;&gt; 0 And J.Offset(-79, 0).Value = \"Forecast\" And J.Column &gt; LastColFcst Then\nLastColFcst = J.Column\nEnd If\nNext J\n\nFor Each K In Range(\"E97:P97,S97:AD97,AG97:AR97,AU97:BF97,BI97:BU97\")\nIf K.Value &lt;&gt; 0 And K.Offset(-88, 0).Value = \"Forecast\" And K.Column &gt; LastColFcst Then\nLastColFcst = K.Column\nEnd If\nNext K        \n</code></pre>\n\n<p>Can anyone advise what's the best way to go about this scenario?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1527087614, "post_id": 50491363, "comment_id": 87996177, "body": "Access will know if the name of checkbox is <code>Expedited</code>.Actually you have to use name the checkbox in if condition."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1527090103, "post_id": 50491363, "comment_id": 87997833, "body": "What do you mean &quot;on the fly&quot;? Just use your basic line of code in the click event of the checkbox  - it will change the Exp_Date &quot;on the fly&quot;"}, {"owner": {"reputation": 266, "user_id": 6158286, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/cdeb0d9ef71c19671a809a0f5f486bd2?s=128&d=identicon&r=PG&f=1", "display_name": "Mike S", "link": "https://stackoverflow.com/users/6158286/mike-s"}, "edited": false, "score": 0, "creation_date": 1527096531, "post_id": 50491363, "comment_id": 88001284, "body": "Thanks much Harun and dbM,  yes it works now with simple expression  in Default: =IIf([ExpYN]=True,DateAdd(&quot;h&quot;,72,Now()),DateAdd(&quot;d&quot;,30,Date(&zwnj;&#8203;))). I modified now my question, Once defaulted are filled, I can&#39;t modify it clicking on Expedited, not sure if this available.. Probably Default works only once (?)"}, {"owner": {"reputation": 473, "user_id": 9513577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157931990617524/picture?type=large", "display_name": "Isaac Reefman", "link": "https://stackoverflow.com/users/9513577/isaac-reefman"}, "edited": false, "score": 0, "creation_date": 1527213218, "post_id": 50491363, "comment_id": 88053264, "body": "Yep, @MikeS, Default only triggers once. You can have it update each time you check or uncheck the box though: Both the answers below look at how exactly you could do that.  If one of them answers the question, could you accept one so the question shows up as resolved?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1528962311, "post_id": 50491363, "comment_id": 88706963, "body": "\ud83c\udf1f  <b><i>JUST POINTING OUT,</b> this user does not <b>ACCEPT</b> Answers!</i>"}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1527103077, "last_edit_date": 1527103077, "creation_date": 1527102695, "answer_id": 50495849, "question_id": 50491363, "link": "https://stackoverflow.com/questions/50491363/ms-access-db-vba-form-dynamic-default-value-on-condition/50495849#50495849", "title": "MS Access db, VBA form dynamic Default value on condition", "body": "<p>DefaultValue triggers only once - when record is first initiated by input into any field. If the calculation is based on value of Expedited, the DLookup should not work because the record is not yet committed to table. Record is committed when: 1. close table/query/form or 2. move to another record or 3. run code to save. If you want to programmatically modify DeadlineDate value based on Expedited value, then code needs to be in Expedited AfterUpdate event and abandon the DefaultValue approach.</p>\n\n<p><code>Me!DeadlineDate = IIf(Me!ExpYN, DateAdd(\"h\",72,Now()), DateAdd(\"d\",30,Now()))</code></p>\n"}, {"tags": [], "owner": {"reputation": 473, "user_id": 9513577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157931990617524/picture?type=large", "display_name": "Isaac Reefman", "link": "https://stackoverflow.com/users/9513577/isaac-reefman"}, "is_accepted": false, "score": 1, "last_activity_date": 1527134725, "last_edit_date": 1527134725, "creation_date": 1527121477, "answer_id": 50499219, "question_id": 50491363, "link": "https://stackoverflow.com/questions/50491363/ms-access-db-vba-form-dynamic-default-value-on-condition/50499219#50499219", "title": "MS Access db, VBA form dynamic Default value on condition", "body": "<p>Using <code>IIf</code> or <code>DLookup</code> to refer to another field on the same record in a Default Value isn't going to get you anywhere, because Access only asks Default Value what value to fill in when the new record is first initiated. That means it's going to be based on the default values of the other fields, and therefore will not respond to any user input.</p>\n\n<p>I'd suggest that you keep the Default Value of both <code>StartDate</code> and <code>DeadlineDate</code> simple, similar to how you already are:</p>\n\n<p><code>StartDate</code>'s Default Value: <code>Now()</code></p>\n\n<p><code>DeadlineDate</code>'s Default Value: <code>DateAdd(\"d\",30,Now())</code></p>\n\n<p>And then change it in code if and when Expedited is changed. There's a few ways of doing this, I'd probably put it in the Before Update event of the checkbox, so it runs without having to move out of the record. You could also base it on the StartDate field if you might want to be able to change the record later on. You could build it with Access' macro builder, but it's easier to show you VBA here:</p>\n\n<pre><code>If ExpYN Then\n    DeadlineDate = DateAdd(\"h\", 72, StartDate)\nElse\n    DeadlineDate = DateAdd(\"d\", 30, StartDate)\nEnd If\n</code></pre>\n\n<p>If you want the expedition process to be based on the moment the button is clicked instead of the DateTime data in <code>StartDate</code>, just change <code>StartDate</code> (or whatever that field is called) to <code>Now()</code>.</p>\n"}], "owner": {"reputation": 266, "user_id": 6158286, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/cdeb0d9ef71c19671a809a0f5f486bd2?s=128&d=identicon&r=PG&f=1", "display_name": "Mike S", "link": "https://stackoverflow.com/users/6158286/mike-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 504, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1527134725, "creation_date": 1527086785, "last_edit_date": 1527097924, "question_id": 50491363, "link": "https://stackoverflow.com/questions/50491363/ms-access-db-vba-form-dynamic-default-value-on-condition", "title": "MS Access db, VBA form dynamic Default value on condition", "body": "<p>I'm using form below and not sure if I can implement this logic:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ogeCJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ogeCJ.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Start Date = Now();\n\nIf Expedited  then Exp_Date = Start_Date + 72 hours \nelse Exp_Date = Start_Date + 30 days.\n</code></pre>\n\n<p>I used this expression for default but looks like at time of evaluations it doen'st care about value in ExpeditedYN.</p>\n\n<pre><code>=IIf([ExpYN]=True,DateAdd(\"h\",72,Now()),DateAdd(\"d\",30,Date()))\n</code></pre>\n\n<p>Ideally I'd like to flip Exp.Date  default clicking on Expedited box, is this available in VB. Tried DLookUp (D --> Dynamic??) and it doesn't work</p>\n\n<pre><code>DLookUp(IIf([ExpYN]=True,DateAdd(\"h\",72,Now()),DateAdd(\"d\",30,Date())))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/XMXJx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XMXJx.png\" alt=\"enter image description here\"></a>\nTx\nDai </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1527087018, "post_id": 50491343, "comment_id": 87995730, "body": "How the cell is highlighted? Using conditional format or any other way?"}, {"owner": {"reputation": 71, "user_id": 7965705, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5P4wy57sdxs/AAAAAAAAAAI/AAAAAAAAAH4/9N6BW7AJsGI/photo.jpg?sz=128", "display_name": "Carl O&#39; Beirne", "link": "https://stackoverflow.com/users/7965705/carl-o-beirne"}, "reply_to_user": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1527087402, "post_id": 50491343, "comment_id": 87996028, "body": "The cells are just text and numbers. Some of the columns are green in colour but there is no formatting."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1527088639, "post_id": 50491343, "comment_id": 87996860, "body": "You want to copy the current active selection from one workbook to another? How do you want them pasted? Exactly where they were? Into a contiguous block based on the current selection in the destination sheet? More specific info will get you a better answer more quickly."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1527090916, "last_edit_date": 1527090916, "creation_date": 1527087044, "answer_id": 50491452, "question_id": 50491343, "link": "https://stackoverflow.com/questions/50491343/macro-for-highlighted-cells-rather-than-specific-cells/50491452#50491452", "title": "Macro for highlighted cells rather than specific cells", "body": "<pre><code>Option Explicit\n\nSub CopySpecificRange()\n\n    Dim srcRange As Range\n    Set srcRange = Worksheets(1).Range(\"A8:I14\")\n\n    Dim myCell  As Range\n    Dim srcRangeColored As Range\n\n    For Each myCell In srcRange\n        If myCell.Interior.Color = vbYellow Then\n            If Not srcRangeColored Is Nothing Then\n                Set srcRangeColored = Union(srcRangeColored, myCell)\n            Else\n                Set srcRangeColored = myCell\n            End If\n        End If\n    Next myCell\n\n    If Not srcRangeColored Is Nothing Then\n        srcRangeColored.copy Worksheets(2).Range(\"A2\")\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Concerning that you want only cells, colored in vbYellow the code above works. Just make sure that you fix correctly the <code>Worksheets(2)</code> and <code>Worksheets(1)</code> as you wish.</p>\n\n<p>Depending on what you want, probably it is a better idea to save the colored values in a data structure (array or list), and to put it one after another in range <code>A2</code>. Thus, consider that you are interested in the yellow cells of  <code>A1:D10</code> range only:</p>\n\n<p><a href=\"https://i.stack.imgur.com/nO03B.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nO03B.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thus, trying to get this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/w9gdZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w9gdZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>You may use the <code>myColl</code> as a <code>Collection</code> and add any <code>vbYellow</code> cell to it. Then, using the incremented <code>cnt</code>, it is easy to put the values of the collection on a single row:</p>\n\n<pre><code>Sub CopySpecificRange()\n\n    Dim srcRange As Range\n    Set srcRange = Worksheets(1).Range(\"A1:D10\")\n\n    Dim myCell  As Range\n    Dim srcRangeColored As Range\n    Dim myColl As New Collection\n\n    For Each myCell In srcRange\n        If myCell.Interior.Color = vbYellow Then\n            myColl.Add myCell.Value2\n        End If\n    Next myCell\n\n    Dim cnt As Long: cnt = 1\n    With Worksheets(2)\n        For Each myCell In .Range(.Cells(1, 1), .Cells(1, myColl.Count))\n            myCell = myColl.Item(cnt)\n            cnt = cnt + 1\n        Next myCell\n    End With\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>And concerning the edit, where highlighted means selected. </p>\n\n<p>Input:</p>\n\n<p><a href=\"https://i.stack.imgur.com/IXQSR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IXQSR.png\" alt=\"enter image description here\"></a></p>\n\n<p>Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ta03o.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ta03o.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub CopySelectedRanges()\n\n    Dim myCell  As Range\n    Dim srcRangeColored As Range\n    Dim myColl As New Collection\n\n    For Each myCell In Selection.Cells\n        myColl.Add myCell.Value2\n    Next myCell\n\n    Dim cnt As Long: cnt = 1\n    With Worksheets(2)\n        For Each myCell In .Range(.Cells(1, 1), .Cells(1, myColl.Count))\n            myCell = myColl.Item(cnt)\n            cnt = cnt + 1\n        Next myCell\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 7965705, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5P4wy57sdxs/AAAAAAAAAAI/AAAAAAAAAH4/9N6BW7AJsGI/photo.jpg?sz=128", "display_name": "Carl O&#39; Beirne", "link": "https://stackoverflow.com/users/7965705/carl-o-beirne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 945, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527090916, "creation_date": 1527086709, "last_edit_date": 1527087615, "question_id": 50491343, "link": "https://stackoverflow.com/questions/50491343/macro-for-highlighted-cells-rather-than-specific-cells", "title": "Macro for highlighted cells rather than specific cells", "body": "<p>I am writing an excel macro that will grab information that is highlighted in one excel workbook and paste it into a new workbook.</p>\n\n<p>The code I currently have takes the info from specific cells, but I need it to be of certain cells that are highlighted throughout the spreadsheet.</p>\n\n<p>The code I currently have is</p>\n\n<pre><code>Sub copy()\n\nWorkbooks(\"Book2.xlsx\").Worksheets(\"Master Data\").Range(\"A8:I14\").copy _\nWorkbooks(\"Book1.xlsx\").Worksheets(\"Sheet1\").Range(\"A1\")\n\n\nEnd Sub\n</code></pre>\n\n<p>EDIT</p>\n\n<p>By highlighted, I do not mean highlighted with a colour or with formatting. I mean by selecting a multitude of cells by click and dragging to select cells</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1527085970, "post_id": 50490626, "comment_id": 87994972, "body": "Maybe I&#39;m just being dense, but I can&#39;t understand how you&#39;re getting your new sheet from your historical data and new data - also, a tip: When using example names, it&#39;s easier to use words that <i>aren&#39;t</i> so similar in appearance, like Tom, Mike and Harry, instead of Blabla, Blabli, Bloblo, etc..."}, {"owner": {"reputation": 13, "user_id": 9757156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e90059d6ecc4e83d5e6e4b2ec6ee073?s=128&d=identicon&r=PG&f=1", "display_name": "Aim&#233;", "link": "https://stackoverflow.com/users/9757156/aim%c3%a9"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1527086608, "post_id": 50490626, "comment_id": 87995419, "body": "Hi Dwirony,  I&#39;m willing to get the new sheet based on what do not exist on the historical sheet."}], "owner": {"reputation": 13, "user_id": 9757156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e90059d6ecc4e83d5e6e4b2ec6ee073?s=128&d=identicon&r=PG&f=1", "display_name": "Aim&#233;", "link": "https://stackoverflow.com/users/9757156/aim%c3%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "protected_date": 1544450952, "answer_count": 0, "score": 1, "last_activity_date": 1544443048, "creation_date": 1527084725, "last_edit_date": 1527085572, "question_id": 50490626, "link": "https://stackoverflow.com/questions/50490626/comparing-two-excel-worksheet-and-display-new-data-in-a-new-worksheet", "title": "Comparing two Excel worksheet and display new data in a new worksheet", "body": "<p>I looked for the answer of my problem in all topics discussed on this platform such as Compare two Sheet and find differences, Macro to compare two worksheets &amp; highlights differences and so on ... but I did not found what I was looking for.</p>\n\n<p>My question is ; is there a possibility to compare two excel worksheets with a different layout as below? I'm willing to compare an historical worksheets versus a new worksheets and display in a third worksheet what was on the new worksheet that does not exist in the historical e.g :</p>\n\n<p><a href=\"https://i.stack.imgur.com/Giwbs.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Giwbs.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I hope you will understand my question and be able to help me on this topic. I already have a code which compare two worksheet and show the difference but it's not enough for my problem. </p>\n\n<pre><code>Option Explicit\n\nSub CompareIt()\n    Dim ar As Variant\n    Dim arr As Variant\n    Dim Var As Variant\n    Dim v()\n    Dim i As Long\n    Dim n As Long\n    Dim j As Long\n    Dim str As String\n\n    ar = Sheet1.Cells(10, 1).CurrentRegion.Value\n    With CreateObject(\"Scripting.Dictionary\")\n        .CompareMode = 1\n        ReDim v(1 To UBound(ar, 2))\n        For i = 2 To UBound(ar, 1)\n            For n = 1 To UBound(ar, 2)\n                str = str &amp; Chr(2) &amp; ar(i, n)\n                v(n) = ar(i, n)\n            Next\n            .Item(str) = v: str = \"\"\n        Next\n        ar = Sheet2.Cells(10, 1).CurrentRegion.Resize(, UBound(v)).Value\n        For i = 2 To UBound(ar, 1)\n            For n = 1 To UBound(ar, 2)\n                str = str &amp; Chr(2) &amp; ar(i, n)\n                v(n) = ar(i, n)\n            Next\n            If .exists(str) Then\n                .Item(str) = Empty\n            Else\n                .Item(str) = v\n            End If\n            str = \"\"\n        Next\n        For Each arr In .keys\n            If IsEmpty(.Item(arr)) Then .Remove arr\n        Next\n        Var = .items: j = .Count\n    End With\n    With Sheet3.Range(\"a1\").Resize(, UBound(ar, 2))\n        .CurrentRegion.ClearContents\n        .Value = ar\n        If j &gt; 0 Then\n            .Offset(1).Resize(j).Value = Application.Transpose(Application.Transpose(Var))\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 1476, "user_id": 9405863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40cdcd740f2f6f607a21a66697131155?s=128&d=identicon&r=PG&f=1", "display_name": "user9405863", "link": "https://stackoverflow.com/users/9405863/user9405863"}, "edited": false, "score": 0, "creation_date": 1527084325, "post_id": 50490469, "comment_id": 87993788, "body": "include images inline to help you better"}, {"owner": {"reputation": 9, "user_id": 9373960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dafa69d253a277ea6b88fa7c4edfa173?s=128&d=identicon&r=PG&f=1", "display_name": "Santis789", "link": "https://stackoverflow.com/users/9373960/santis789"}, "reply_to_user": {"reputation": 1476, "user_id": 9405863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40cdcd740f2f6f607a21a66697131155?s=128&d=identicon&r=PG&f=1", "display_name": "user9405863", "link": "https://stackoverflow.com/users/9405863/user9405863"}, "edited": false, "score": 0, "creation_date": 1527084644, "post_id": 50490469, "comment_id": 87994012, "body": "They should be visible now."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 9373960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dafa69d253a277ea6b88fa7c4edfa173?s=128&d=identicon&r=PG&f=1", "display_name": "Santis789", "link": "https://stackoverflow.com/users/9373960/santis789"}, "edited": false, "score": 1, "creation_date": 1527085969, "post_id": 50490961, "comment_id": 87994970, "body": "Thank you for the information about hiding the bloomberg dates, I did not know that. I have fixed the problem now."}, {"owner": {"reputation": 5010, "user_id": 9754169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/785875bd9271c02795b886d3a9c65331?s=128&d=identicon&r=PG&f=1", "display_name": "Yuca", "link": "https://stackoverflow.com/users/9754169/yuca"}, "reply_to_user": {"reputation": 9, "user_id": 9373960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dafa69d253a277ea6b88fa7c4edfa173?s=128&d=identicon&r=PG&f=1", "display_name": "Santis789", "link": "https://stackoverflow.com/users/9373960/santis789"}, "edited": false, "score": 0, "creation_date": 1527163080, "post_id": 50490961, "comment_id": 88029446, "body": "Happy to help! Try to use Bloomberg sheet builder for even better results"}], "tags": [], "owner": {"reputation": 5010, "user_id": 9754169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/785875bd9271c02795b886d3a9c65331?s=128&d=identicon&r=PG&f=1", "display_name": "Yuca", "link": "https://stackoverflow.com/users/9754169/yuca"}, "is_accepted": true, "score": 0, "last_activity_date": 1527085598, "creation_date": 1527085598, "answer_id": 50490961, "question_id": 50490469, "link": "https://stackoverflow.com/questions/50490469/formula-in-vba-based-on-adjusting-cells/50490961#50490961", "title": "Formula in VBA based on adjusting cells", "body": "<p>In my opinion you have two alternatives:</p>\n\n<p>1)adjust the autofill approach: write the formula in a loop, using an offset and then fill cells below</p>\n\n<pre><code>Dim rng As Range\nSet rng = Range(\"k2:m2\")\nDim i As Integer\nDim offset As Integer\ni = 0\noffset = 2\nFor Each cell In rng\n    cell.FormulaR1C1 = \"=Input!R[-1]C[-\" &amp; 10 - offset * i &amp; \"]/Input!R5C[-\" &amp; 10 - offset * i &amp; \"]*100\"\n    i = i + 1\nNext cell\n</code></pre>\n\n<p>2) Modify the Bloomberg formula to hide dates (=bdh(\"AAPL UQ Equity\",\"PX_LAST\",\"dts=h\") and that way all your price series are next to each other and that way your original autofill works</p>\n"}], "owner": {"reputation": 9, "user_id": 9373960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dafa69d253a277ea6b88fa7c4edfa173?s=128&d=identicon&r=PG&f=1", "display_name": "Santis789", "link": "https://stackoverflow.com/users/9373960/santis789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 50490961, "answer_count": 1, "score": 0, "last_activity_date": 1527085598, "creation_date": 1527084273, "last_edit_date": 1527085381, "question_id": 50490469, "link": "https://stackoverflow.com/questions/50490469/formula-in-vba-based-on-adjusting-cells", "title": "Formula in VBA based on adjusting cells", "body": "<p>I'm having some diffulculties in writing the right code. As you can see in the first picture I have 3 different stocks and the price of them listed in different columns. </p>\n\n<p><img src=\"https://i.stack.imgur.com/Za9Xj.png\" alt=\"1\"></p>\n\n<p>I now want to calculate the return of these different stocks, which I am doing by the use of VBA. The code refers to the sheet called \"Input\", but places the value in a different sheet. The last part of the code just drags the calculations to the last used column.</p>\n\n<pre><code>Range(\"B4\").FormulaR1C1 = \"=Input!R[1]C[1]/Input!R5C[1]*100\"\nlastcolumn = Cells(3, Columns.Count).End(xlToLeft).column\nRange(\"B4\").AutoFill Destination:=Range(Cells(4, 2), Cells(4, lastcolumn))\n</code></pre>\n\n<p>However, my problem occurs when dragging. As shown in the picture below, I can't drag the code due to the the number of columns in between the values in the \"Input\" sheet and that there are no columns inbetween in the other sheet. How can I change my code so VBA calculates the right way so the return of Microsoft i calculated by F5/F$5*100 and not D5/D$5*100? I hope the question makes sense.   </p>\n\n<p><img src=\"https://i.stack.imgur.com/svfvO.png\" alt=\"2\"></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 9834898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf5f10283d8f8902ab4aa242ee89d592?s=128&d=identicon&r=PG&f=1", "display_name": "Elena", "link": "https://stackoverflow.com/users/9834898/elena"}, "edited": false, "score": 0, "creation_date": 1527086105, "post_id": 50490536, "comment_id": 87995077, "body": "Thank you very much. One thing more I have one condition for two colums. &quot; Cells(i, j + 1).Value &lt; 0 And Cells(i, j + 2).Value&lt;0&quot; I want to see separetly  results for every pair of colums"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 27, "user_id": 9834898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf5f10283d8f8902ab4aa242ee89d592?s=128&d=identicon&r=PG&f=1", "display_name": "Elena", "link": "https://stackoverflow.com/users/9834898/elena"}, "edited": false, "score": 0, "creation_date": 1527086215, "post_id": 50490536, "comment_id": 87995160, "body": "@Elena - give it a try with the condition, the cells are accessible from here - <code>Worksheets(1).Cells(j, col1.Column)</code>."}, {"owner": {"reputation": 27, "user_id": 9834898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf5f10283d8f8902ab4aa242ee89d592?s=128&d=identicon&r=PG&f=1", "display_name": "Elena", "link": "https://stackoverflow.com/users/9834898/elena"}, "edited": false, "score": 0, "creation_date": 1527177813, "post_id": 50490536, "comment_id": 88039873, "body": "Actually it is not exactly that I need. I need the results of conditional counting of the rows in the table, like:   number of rows"}, {"owner": {"reputation": 27, "user_id": 9834898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf5f10283d8f8902ab4aa242ee89d592?s=128&d=identicon&r=PG&f=1", "display_name": "Elena", "link": "https://stackoverflow.com/users/9834898/elena"}, "edited": false, "score": 0, "creation_date": 1527178241, "post_id": 50490536, "comment_id": 88040110, "body": "Actually it is not exactly that I need. I need the results of conditional counting of the rows in the table,for instance : if element (i,j) &gt;0 and (i,j+1)&gt;0, then in Columns D,F  (here j=D,j+1=F) we have X rows, and so until  row 16. It should be an array"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1527085508, "last_edit_date": 1527085508, "creation_date": 1527084470, "answer_id": 50490536, "question_id": 50490400, "link": "https://stackoverflow.com/questions/50490400/separating-columns-from-range/50490536#50490536", "title": "Separating columns from range", "body": "<p>If your question is simplified to the following:</p>\n\n<p><em>I look at the range C2:N59, but I want to see results for columns D,E and G,H and so on for every condition. Which Loop should I write for it?</em></p>\n\n<p>Then this is a possible answer:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim inspectedRange As Range\n    Set inspectedRange = Worksheets(1).Range(\"C2:N59\")\n\n    Dim cnt As Long\n    For cnt = 1 To inspectedRange.Columns.Count Step 2\n        Debug.Print inspectedRange.Columns(cnt).Address\n        Debug.Print inspectedRange.Columns(cnt + 1).Address\n        Debug.Print \"-------------\"\n    Next cnt\n\nEnd Sub\n</code></pre>\n\n<p>It prints every 2 columns, starting from <code>C</code> and <code>D</code> like this:</p>\n\n<pre><code>$C$2:$C$59\n$D$2:$D$59\n-------------\n$E$2:$E$59\n$F$2:$F$59\n-------------\n$G$2:$G$59\n$H$2:$H$59\n-------------\n</code></pre>\n\n<p>And it allows you to work further with these ranges - <code>inspectedRange.Columns(cnt)</code> and <code>inspectedRange.Columns(cnt+1)</code> the way you want. If you want to use the <code>j</code> and <code>i</code> in a nested loop, this is a possible way to get the cells and to do something with them:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim inspectedRange As Range\n    Set inspectedRange = Worksheets(1).Range(\"C2:N59\")\n\n    Dim j As Long, i As Long, cnt As Long\n    Dim col1 As Range\n    Dim col2 As Range\n\n    For cnt = 1 To inspectedRange.Columns.Count Step 2\n        Set col1 = inspectedRange.Columns(cnt)\n        Set col2 = inspectedRange.Columns(cnt + 1)\n        For j = 3 To 16 Step 3\n            For i = 2 To 59 Step 1\n                With Worksheets(1)\n                    Debug.Print .Cells(j, col1.Column).Address\n                    Debug.Print .Cells(i, col2.Column).Address\n                End With\n            Next i\n        Next j            \n    Next cnt\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9834898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf5f10283d8f8902ab4aa242ee89d592?s=128&d=identicon&r=PG&f=1", "display_name": "Elena", "link": "https://stackoverflow.com/users/9834898/elena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527085508, "creation_date": 1527084120, "last_edit_date": 1527084208, "question_id": 50490400, "link": "https://stackoverflow.com/questions/50490400/separating-columns-from-range", "title": "Separating columns from range", "body": "<p>I want to count the number of rows conditionally in Excel sheet.  I wrote the code which calculates numbers in the whole range. However I need to separate results for different columns. For example, now I look at the range  C2:N59, but i want to see results for columns D,E and G,H and so on for every condition. Which Loop should I write for it?<br>\nhere is my code: </p>\n\n<pre><code>Function RabigatorCount()\nDim zelle As Range\nDim i As Integer\nDim Rabigator() As Integer\nDim posMonitoring As Integer\nDim j As Integer\nDim intCounter(9) As Integer\nSet zelle = Cells.Find(\"is_monitoring_relevant\")\nposMonitoring = zelle.Column\nFor j = 3 To 16 Step 3\nFor i = 2 To 59\nIf Cells(i, posMonitoring).Value = \"c\" And Cells(i, j + 1).Value &lt; 0 And Cells(i, j + 2).Value &lt; 0 Then\n                intCounter(1) = intCounter(1) + 1\n                ElseIf Cells(i, posMonitoring).Value = \"c\" And Cells(i, j + 1).Value = 0 And Cells(i, j + 2).Value &lt; 0 Then\n                intCounter(2) = intCounter(2) + 1\n\n\n            End If \n    Next i\n    Next j\n   RabigatorCount = intCounter         \n   End Function\n</code></pre>\n\n<p>Thank you very much:)</p>\n"}, {"tags": ["java", "ms-access", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1527085884, "post_id": 50490114, "comment_id": 87994917, "body": "<i>like Access blocks one form when a second is opened</i> - you mean using modal dialogs? Seems like going through a lot of trouble just to make a dialog modal and owned by the host app&#39;s mainwindow. So what&#39;s the question? &quot;it will provoke a bug&quot; is rather vague, is any specific error thrown?"}, {"owner": {"reputation": 1, "user_id": 9834854, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "TND", "link": "https://stackoverflow.com/users/9834854/tnd"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1527086626, "post_id": 50490114, "comment_id": 87995429, "body": "yes i want to make the java window as modal window"}, {"owner": {"reputation": 1, "user_id": 9834854, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "TND", "link": "https://stackoverflow.com/users/9834854/tnd"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1527086814, "post_id": 50490114, "comment_id": 87995561, "body": "here is a screenshot <a href=\"https://imgur.com/a/8b9ZW8O\" rel=\"nofollow noreferrer\">imgur.com/a/8b9ZW8O</a>"}, {"owner": {"reputation": 1, "user_id": 9834854, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "TND", "link": "https://stackoverflow.com/users/9834854/tnd"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1527087054, "post_id": 50490114, "comment_id": 87995755, "body": "and it provokes application not responding error when i click on the Access application area"}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1527102395, "post_id": 50490114, "comment_id": 88004215, "body": "If <code>WaitForSingleObject</code> will halt host application&#39;s execution until the time specified. if you would like to remain responsive, you must capture and process the messages like DoEvents would do in a loop. Search for <code>MsgWaitForMultipleObjects</code>. Just out of curiocity, what&#39;s that JAR doing?"}, {"owner": {"reputation": 1, "user_id": 9834854, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "TND", "link": "https://stackoverflow.com/users/9834854/tnd"}, "edited": false, "score": 0, "creation_date": 1527170088, "post_id": 50490114, "comment_id": 88034583, "body": "Ty for your helps, the JAR is an interface for drag and drop of Outlook attachments to Access and i&#39;m still seeking the solution. WaitForSingleObject doesn&#39;t work for me because when the host application&#39;s is hidden its parent forms will be activated."}, {"owner": {"reputation": 1, "user_id": 9834854, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "TND", "link": "https://stackoverflow.com/users/9834854/tnd"}, "edited": false, "score": 0, "creation_date": 1527170260, "post_id": 50490114, "comment_id": 88034719, "body": "what i want it&#39;s to run my jar as modal to the entire Access application, i&#39;ve tried Application.visible, Application.echo and so on but there isnt a method like Application.eventsEnabled one from Excel."}, {"owner": {"reputation": 1, "user_id": 9834854, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "TND", "link": "https://stackoverflow.com/users/9834854/tnd"}, "edited": false, "score": 0, "creation_date": 1527170895, "post_id": 50490114, "comment_id": 88035167, "body": "I don&#39;t know if we can make the jar modal to his caller application or a process modal to another one."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1527263828, "post_id": 50490114, "comment_id": 88077874, "body": "Maybe not what you are looking for but have a look in <a href=\"https://github.com/krishKM/VBA_TOOLS/blob/master/README.md#drag-and-drop-openfiledialog\" rel=\"nofollow noreferrer\">Drag and drop for vba</a>"}], "owner": {"reputation": 1, "user_id": 9834854, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "TND", "link": "https://stackoverflow.com/users/9834854/tnd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527174801, "creation_date": 1527083296, "last_edit_date": 1527174801, "question_id": 50490114, "link": "https://stackoverflow.com/questions/50490114/block-access-application-while-using-java-application", "title": "Block Access Application while using Java Application", "body": "<p>I'm working on a drag-and-drop Java interface run from an Access form.</p>\n\n<p>My problem is that if the user clicks on the background (the Access Application), it will provoke a bug of the Accesss Apllication, so I want to block Access when the Java application is running like Access blocks one form when a second is opened.</p>\n\n<p>Here is the function I use to run my jar : </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Compare Database\nOption Explicit\n\nPrivate Const INFINITE = &amp;HFFFFFFFF\nPrivate Const SYNCHRONIZE = &amp;H100000\nPrivate Const PROCESS_QUERY_INFORMATION = &amp;H400&amp;\n\nPrivate Declare Function CloseHandle Lib \"kernel32\" (ByVal hObject As Long) As Long\nPrivate Declare Function GetExitCodeProcess Lib \"kernel32\" (ByVal hProcess As Long, lpExitCode As Long) As Long\nPrivate Declare Function WaitForSingleObject Lib \"kernel32\" (ByVal hHandle As Long, ByVal dwMilliseconds As Long) As Long\n\nPrivate Declare Function OpenProcess Lib \"kernel32\" (ByVal dwDesiredAccess As Long, _\n    ByVal bInheritHandle As Long, ByVal dwProcessId As Long) As Long\n\nPublic Declare Sub Sleep Lib \"kernel32\" (ByVal IngMilliseconds As Long)\n\n'Shell and wait.  Return exit code result, raise an exception on any error.\nPublic Function ShellSync(ByVal PathName As String, ByVal WindowStyle As VbAppWinStyle) As Long\nDim lngPid As Long\nDim lngHandle As Long\nDim lngExitCode As Long\n\nlngPid = Shell(PathName, WindowStyle)\nIf lngPid &lt;&gt; 0 Then\n    lngHandle = OpenProcess(SYNCHRONIZE Or PROCESS_QUERY_INFORMATION, 0, lngPid)\n    If lngHandle &lt;&gt; 0 Then\n        WaitForSingleObject lngHandle, INFINITE\n        If GetExitCodeProcess(lngHandle, lngExitCode) &lt;&gt; 0 Then\n            ShellSync = lngExitCode\n            CloseHandle lngHandle\n        Else\n            CloseHandle lngHandle\n            Err.Raise &amp;H8004AA00, \"ShellSync\", \"Failed to retrieve exit code, error \" &amp; CStr(Err.LastDllError)\n        End If\n    Else\n        Err.Raise &amp;H8004AA01, \"ShellSync\", \"Failed to open child process\"\n    End If\nElse\n    Err.Raise &amp;H8004AA02, \"ShellSync\", \"Failed to Shell child process\"\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 1, "creation_date": 1527083673, "post_id": 50490109, "comment_id": 87993337, "body": "Do you not also get an error since <code>lastrow</code> is being used before it is defined?  I believe the error 1004 is because you haven&#39;t defined <code>contractsum</code>."}, {"owner": {"reputation": 5, "user_id": 8171010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81c43250bda9eb79c3c4a33e4927cc0b?s=128&d=identicon&r=PG&f=1", "display_name": "Del2me", "link": "https://stackoverflow.com/users/8171010/del2me"}, "reply_to_user": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1527083877, "post_id": 50490109, "comment_id": 87993487, "body": "Thanks for spotting that, I&#39;ve moved lastrow up to before set rng. I&#39;ll edit the original post"}, {"owner": {"reputation": 5, "user_id": 8171010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81c43250bda9eb79c3c4a33e4927cc0b?s=128&d=identicon&r=PG&f=1", "display_name": "Del2me", "link": "https://stackoverflow.com/users/8171010/del2me"}, "reply_to_user": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1527084440, "post_id": 50490109, "comment_id": 87993867, "body": "Thanks Jarom, Seems like I&#39;m full of mistakes today! I had defined contractrange, but had used the term contractsum within the formula. I have changed the formula over to the correct defined range, but still receiving the same error unfortunately."}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1527084482, "post_id": 50490109, "comment_id": 87993898, "body": "Oh, actually the main issue is probably that you are in column A and you are trying to go to the left by using <code>cell.offset(0,-6)</code>  You can only offset to the right of column A."}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1527085346, "post_id": 50490109, "comment_id": 87994486, "body": "I think I found out why you are trying to use the offset in the vlookup.  See my answer and let me know if that makes sense."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1527085798, "post_id": 50490109, "comment_id": 87994850, "body": "Maybe my answer given <a href=\"https://stackoverflow.com/questions/50490109/for-each-cell-in-range-if-cell-value-is-not-blank-then-vlookup\">here</a> may help?"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8171010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81c43250bda9eb79c3c4a33e4927cc0b?s=128&d=identicon&r=PG&f=1", "display_name": "Del2me", "link": "https://stackoverflow.com/users/8171010/del2me"}, "edited": false, "score": 0, "creation_date": 1527088643, "post_id": 50490827, "comment_id": 87996868, "body": "Works wonderfully, many thanks for your help Jarom. I can see where I was going wrong now"}], "tags": [], "owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "is_accepted": true, "score": 1, "last_activity_date": 1527085244, "creation_date": 1527085244, "answer_id": 50490827, "question_id": 50490109, "link": "https://stackoverflow.com/questions/50490109/for-each-cell-in-range-if-cell-value-is-not-blank-then-vlookup/50490827#50490827", "title": "For each cell in range, if cell value is not blank then vlookup", "body": "<p>It looks like you might be mixing up the use of active cells and the <code>Cell</code> that you are using in your loop.  The <code>Cell</code> will only change after a full loop iteration.  It is not like an active cell that will change after you select a different cell.</p>\n\n<p>So when you use <code>Cell.offset(0,6)</code>, the <code>Cell</code> has not changed, so you don't need to try to get back by using <code>Cell.offset(0,-6)</code> in the Vlookup.  </p>\n\n<p>Try this instead:</p>\n\n<pre><code>For Each cell In rng\n'If cell does not equal blank then for each cell in column A, offset to column G.\n    If cell.Value &lt;&gt; \"\" Then\n\n    'In column G, vlookup column A cell value in contractrange's column C, only return exact match\n        cell.Offset(0, 6).Value = Application.VLookup(cell, contractrange, 1, False)\n\n        'In column H, vlookup column A cell value in contractrange's column A, only return exact match\n        cell.Offset(0, 7).Value = Application.VLookup(cell, contractrange, 3, False)\n    End If\n    'Repeat for all cells in range\nNext cell\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8171010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81c43250bda9eb79c3c4a33e4927cc0b?s=128&d=identicon&r=PG&f=1", "display_name": "Del2me", "link": "https://stackoverflow.com/users/8171010/del2me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1307, "favorite_count": 0, "accepted_answer_id": 50490827, "answer_count": 1, "score": 0, "last_activity_date": 1527085244, "creation_date": 1527083280, "last_edit_date": 1527084257, "question_id": 50490109, "link": "https://stackoverflow.com/questions/50490109/for-each-cell-in-range-if-cell-value-is-not-blank-then-vlookup", "title": "For each cell in range, if cell value is not blank then vlookup", "body": "<p>I'm struggling to get the below code to function due to Run-time error '1004': Application-define or object-defined error.</p>\n\n<p>Usually when I've encountered this error is was due to sheet protection, I've ensured sheets are unprotected thus the line at the start of the sub.</p>\n\n<p>I'll outlay the scenario here and the end goal:</p>\n\n<p><strong>Sheet1 = Live Contracts</strong></p>\n\n<p>This sheet contains a table of 6 columns and dynamic number of rows.\ncolumn 1 contains a contract reference number. Columns 2 - 6 are irrelevant to this.</p>\n\n<p><strong>Sheet 4 = Contract Sums</strong></p>\n\n<p>This sheet contains all contracts, the corresponding department and the value of the contract.</p>\n\n<p><strong>Goal</strong></p>\n\n<p>Create a module which can be called via a userform button. </p>\n\n<p>The module needs to view column A of sheet1 and for each cell -if there is a value- create a vlookup in column G with the following parameters. </p>\n\n<pre><code>Lookup Value = Cell.offset(0, -6)\n\nTable array = Sheet4.range(\"A3:C676\")\n\nCol_Index_Num = 1\n\nFALSE - Exact match\n</code></pre>\n\n<p>The module would need to repeat this process for all cells within the range.</p>\n\n<p>Now for what I've produced:</p>\n\n<pre><code> Worksheets(\"Live Contracts\").Unprotect\n\nDim rng As range\nDim lastrow As Long\nDim cell As range\nDim contractrange As range\n\n'Find dynamic range\nlastrow = Worksheets(\"Live Contracts\").range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nSet contractrange = Worksheets(\"Contract Sums\").range(\"A3:C676\")\nSet rng = Worksheets(\"Live Contracts\").range(\"A2:A\" &amp; lastrow)\n\nFor Each cell In rng\n'If cell does not equal blank then for each cell in column A, offset to column G.\n    If cell.Value &lt;&gt; \"\" Then\n\n    'In column G, vlookup column A cell value in contractrange's column C, only return exact match\n        cell.Offset(0, 6).Value = Application.VLookup(cell.Offset(0, -6), contractrange, 1, False)\n\n        'In column H, vlookup column A cell value in contractrange's column A, only return exact match\n        cell.Offset(0, 7).Value = Application.VLookup(cell.Offset(0, -7), contractrange, 3, False)\n    End If\n    'Repeat for all cells in range\nNext cell\n\n\nEnd Sub\n</code></pre>\n\n<p>The first line beginning with cell.offset is being highlighted when debugging</p>\n\n<p>P.S I'm relatively new to VBA, apologies for poor code!</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 664, "user_id": 1285979, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/embHN.jpg?s=128&g=1", "display_name": "L0uis", "link": "https://stackoverflow.com/users/1285979/l0uis"}, "edited": false, "score": 1, "creation_date": 1527082337, "post_id": 50489732, "comment_id": 87992382, "body": "What is the error?"}, {"owner": {"reputation": 427, "user_id": 5669343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34763f8e8eb60f7677a89fc2b8410f2b?s=128&d=identicon&r=PG&f=1", "display_name": "tackdetack", "link": "https://stackoverflow.com/users/5669343/tackdetack"}, "reply_to_user": {"reputation": 664, "user_id": 1285979, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/embHN.jpg?s=128&g=1", "display_name": "L0uis", "link": "https://stackoverflow.com/users/1285979/l0uis"}, "edited": false, "score": 0, "creation_date": 1527083010, "post_id": 50489732, "comment_id": 87992882, "body": "Run-Time error &#39;13&#39;:     Type Mismatch  Which i&#39;m assuming is for the Deleted Items folder"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1527086550, "post_id": 50489732, "comment_id": 87995378, "body": "On which line ?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 1, "creation_date": 1527087105, "post_id": 50489732, "comment_id": 87995805, "body": "Why not just open that mailbox in Outlook and move the messages manually? It is a one-time thing, right?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1527090349, "post_id": 50489732, "comment_id": 87997983, "body": "I agree with @DmitryStreblechenko, it seems like you could just do a search on the employee&#39;s name and just manually highlight and move over the results"}, {"owner": {"reputation": 427, "user_id": 5669343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34763f8e8eb60f7677a89fc2b8410f2b?s=128&d=identicon&r=PG&f=1", "display_name": "tackdetack", "link": "https://stackoverflow.com/users/5669343/tackdetack"}, "edited": false, "score": 0, "creation_date": 1527095040, "post_id": 50489732, "comment_id": 88000555, "body": "Yes and no. There is a mix of mail and calendar items. The calendar items give an issues because it tries to recreate the event and fails."}], "answers": [{"tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": true, "score": 1, "last_activity_date": 1527090621, "creation_date": 1527090621, "answer_id": 50492677, "question_id": 50489732, "link": "https://stackoverflow.com/questions/50489732/move-email-from-deleted-folder/50492677#50492677", "title": "Move Email from Deleted Folder", "body": "<p>You have to specify the deleted items folder like so:</p>\n\n<pre><code>Set myInbox = myNameSpace.GetDefaultFolder(olFolderDeletedItems)\n</code></pre>\n\n<p>You can read more examples for specifying folders <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/namespace-getdefaultfolder-method-outlook\" rel=\"nofollow noreferrer\">here</a> and a list of other options <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/oldefaultfolders-enumeration-outlook\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 427, "user_id": 5669343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34763f8e8eb60f7677a89fc2b8410f2b?s=128&d=identicon&r=PG&f=1", "display_name": "tackdetack", "link": "https://stackoverflow.com/users/5669343/tackdetack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 0, "accepted_answer_id": 50492677, "answer_count": 1, "score": 0, "last_activity_date": 1573026328, "creation_date": 1527082140, "last_edit_date": 1527082641, "question_id": 50489732, "link": "https://stackoverflow.com/questions/50489732/move-email-from-deleted-folder", "title": "Move Email from Deleted Folder", "body": "<p>Recently had an employee leave the company and decided to move a few thousand emails and events to the trash folder in Outlook. Thankfully, I can still recover them manually but I would prefer not have to do them in small batches.. </p>\n\n<p>I've got this code but it errors when I try to move items from the \"Deleted Items\" folder back to the Inbox. </p>\n\n<pre><code>Sub MoveItems()\n Dim myNameSpace As Outlook.NameSpace\n Dim myInbox As Outlook.Folder\n Dim myDestFolder As Outlook.Folder\n Dim myItems As Outlook.Items\n Dim myItem As Object\n\n Set myNameSpace = Application.GetNamespace(\"MAPI\")\n Set myInbox = myNameSpace.GetDefaultFolder(Deleted Items)\n Set myItems = myInbox.Items\n Set myDestFolder = myInbox.Folders(\"olFolderInbox\")\n Set myItem = myItems.Find(\"[SenderName] = 'John Smith'\")\n While TypeName(myItem) &lt;&gt; \"Nothing\"\n myItem.Move myDestFolder\n Set myItem = myItems.FindNext\n Wend\nEnd Sub\n</code></pre>\n\n<p>Thoughts?</p>\n"}, {"tags": ["vba", "ms-access", "dependencies", "boolean", "beforeupdate"], "comments": [{"owner": {"reputation": 473, "user_id": 9513577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157931990617524/picture?type=large", "display_name": "Isaac Reefman", "link": "https://stackoverflow.com/users/9513577/isaac-reefman"}, "edited": false, "score": 0, "creation_date": 1527490480, "post_id": 50489697, "comment_id": 88131760, "body": "How have you gone with this? Did my answer work for you?"}], "answers": [{"tags": [], "owner": {"reputation": 473, "user_id": 9513577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157931990617524/picture?type=large", "display_name": "Isaac Reefman", "link": "https://stackoverflow.com/users/9513577/isaac-reefman"}, "is_accepted": false, "score": 0, "last_activity_date": 1527134595, "last_edit_date": 1527134595, "creation_date": 1527124074, "answer_id": 50499482, "question_id": 50489697, "link": "https://stackoverflow.com/questions/50489697/ms-access-form-vba-check-checkboxes-before-checking-others/50499482#50499482", "title": "MS Access Form VBA Check Checkboxes, Before Checking Others?", "body": "<p>From my recent experience, when the Before Update event is triggered it uses the new value of the field in any calculations. So I'd expect you to want to start that main <code>If</code> statement like <code>If Me.NoOptions = True Then</code>.\nI also don't believe you need the <code>Else OptionCheck = True</code> bits just before the <code>End If</code>s.</p>\n\n<p>What may be causing a problem is you've called <code>OptionsAllowPubFunc</code>, but the function you've included in this question is actually called <code>PlaintiffLiensAllowed</code> - unless you have an identical function called OptionsAllowPubFunc, this'll give you an error. </p>\n\n<p>Finally, I've never found <code>me.undo</code> to be especially helpful in this kind of context, but the Before Update gives you an out - just tell it to cancel using <code>Cancel = True</code> (or anything that isn't 0) and it'll not update the field and exit the sub.</p>\n\n<p>You could also add in a bit to re-enable the option fields if they were un-checking the box.</p>\n\n<p>Try running it as:</p>\n\n<pre><code>Private Sub NoOptions_BeforeUpdate(Cancel As Integer)\nDim Msg As String, Style As VbMsgBoxStyle, Title As String\nDim Response As VbMsgBoxResult, delOLiensSQL As String\n\nIf Me.NoOptions = True Then\n    If (Me.OptionA = True Or Me.OptionB = True Or Me.OptionC = True Or Me.OptionD = True) Then\n        Msg = \"You have chosen No Options, but one or more option is checked.\" &amp; vbCrLf &amp; _\n        \"Choosing No Options will require removing all Lien amounts.\" &amp; vbCrLf &amp; _\n        \"Would you like to change this Person to No Options?\"\n        Style = vbYesNo\n        Title = \"All Options Will Be Reset to 0 and False.\"\n        Response = MsgBox(Msg, Style, Title)\n\n        If Response = vbYes Then\n            If Nz(DLookup(\"ID\", \"tblPersonOtherOptionsD\", \"FKPerson = \" &amp; Me.ID), 0) Then\n                delOLiensSQL = \"Delete From tblPersonOtherOptionsD Where FKPerson = \" &amp; Me.ID\n                DoCmd.RunSQL delOoptionssSQL, dbSeeChanges\n            End If\n            Me.OptionA = False\n            Me.OptionAAmount = 0\n            Me.OptionB = False\n            Me.OptionBAmount = 0\n            Me.OptionC = False\n            Me.OptionCAmount = 0\n            Me.OptionD = False\n            PlaintiffLiensAllowed(False)\n        Else\n            MsgBox \"OK, we will leave everything as it is.\", vbOKOnly, \"Better Safe Than Sorry\"\n            Cancel = True\n        End If\n    End If\nElse\n    PlaintiffLiensAllowed(True)\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 487, "user_id": 729474, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/a8e32e28c2361f6bf5465e39c0a68987?s=128&d=identicon&r=PG", "display_name": "missscripty", "link": "https://stackoverflow.com/users/729474/missscripty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 905, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594461254, "creation_date": 1527082060, "last_edit_date": 1594461254, "question_id": 50489697, "link": "https://stackoverflow.com/questions/50489697/ms-access-form-vba-check-checkboxes-before-checking-others", "title": "MS Access Form VBA Check Checkboxes, Before Checking Others?", "body": "<p>I am working on an Access application, with a SQL back-end.</p>\n\n<p>I have a form for people, where each person can need to have different things checked or unchecked. There are the following fields and corresponding controls on the form:</p>\n\n<p>No Options (integer - boolean - checkbox)</p>\n\n<p>Option A (integer - boolean - checkbox)</p>\n\n<p>Option A Amount (money)</p>\n\n<p>Option B (integer - boolean - checkbox)</p>\n\n<p>Option B Amount (money)</p>\n\n<p>Option C (integer - boolean - checkbox)</p>\n\n<p>Option C Amount (money)</p>\n\n<p>Option D (integer - boolean - checkbox)</p>\n\n<p>Option D command button (opens popup form with option type drop down and amounts for multiple values to be entered).</p>\n\n<p>My concern is that if someone checks one box, it can conflict with another checkbox or money fields.</p>\n\n<p>If someone checks No Options, and one of the other options is checked, I have to uncheck those. I also need to 0 out their corresponding money field. If there are Option D \"Other Option\" records, in a linked table, then I need to delete those too, after I confirm with the user. I also want to disable the checkboxes and money/ command button controls for options A - D.  </p>\n\n<p>If I am unchecking No Options, then I need to enable all of that.</p>\n\n<p>You can start to see how every time I check any of the No Options, or Options A - D, I have to check the state of No Options, and the option's corresponding money amount, to confirm the user wants to make this change.  </p>\n\n<p>To do that, I set up the following code for the No Options Before update:</p>\n\n<pre><code>Private Sub NoOptions_BeforeUpdate(Cancel As Integer)\nDim Msg, Style, Title\nDim delOLiensSQL\n\nIf Me.NoOptions = False Then\n    If (Me.OptionA = True Or Me.OptionB = True Or Me.OptionC = True Or Me.OptionD = True) Then\n        Msg = \"You have chosen No Options, but one or more option is checked.\" &amp; vbCrLf &amp; _\n        \"Choosing No Options will require removing all Lien amounts.\" &amp; vbCrLf &amp; _\n        \"Would you like to change this Person to No Options?\"\n        Style = vbYesNo\n        Title = \"All Options Will Be Reset to 0 and False.\"\n        Response = MsgBox(Msg, Style, Title)\n\n        If Response = vbYes Then\n            If Nz(DLookup(\"ID\", \"tblPersonOtherOptionsD\", \"FKPerson = \" &amp; Me.ID), 0) Then\n                delOLiensSQL = \"Delete From tblPersonOtherOptionsD Where FKPerson = \" &amp; Me.ID\n                DoCmd.RunSQL delOoptionssSQL, dbSeeChanges\n            End If\n            Me.OptionA = False\n            Me.OptionAAmount = 0\n            Me.OptionB = False\n            Me.OptionBAmount = 0\n            Me.OptionC = False\n            Me.OptionCAmount = 0\n            Me.OptionD = False\n            OptionsAllowPubFunc (False)\n        Else\n            Me.Undo\n            MsgBox \"OK, we will leave everything as it is.\", vbOKOnly, \"Better Safe Than Sorry\"\n        End If\n    Else\n        Me.NoOptions = True\n    End If\nElse\n    Me.NoOptions = False\nEnd If\nEnd Sub\n</code></pre>\n\n<p>OptionsAllowPubFunc (False) is a public function which is the following:</p>\n\n<pre><code>Public Function PlaintiffLiensAllowed(Liens As Boolean)\n    Forms!frmPerson.OptionAAmount.Enabled = Liens\n    Forms!frmPerson.OptionBAmount.Enabled = Liens\n    Forms!frmPerson.OptionCAmount.Enabled = Liens\n    Forms!frmPerson.OptionDAmount.Enabled = Liens\nEnd Function\n</code></pre>\n\n<p>I also set up Before Update public function for OptionA, OptionB, OptionC, OptionD as follows:</p>\n\n<pre><code>Public Function ChangeAOption(OptionCheck As Control, OptionAmount As Control, OptionName As String)\n    Dim Msg, Style, Title\n    Dim Msg2, Style2, Title2\n\n    If OptionCheck = True Then\n\n        If Nz(OptionAmount, 0) &gt; 0 Then\n            Msg = \"There is a \" &amp; OptionName &amp; \" Option amount. Unchecking \" &amp; OptionName &amp; \" Option, will require the amount to be 0.\" &amp; vbCrLf &amp; _\n            \"Would you like to uncheck \" &amp; OptionName &amp; \" Option and make the amount 0?\"\n            Style = vbYesNo\n            Title = \"Confirm No \" &amp; OptionName &amp; \" Option.\"\n            Response = MsgBox(Msg, Style, Title)\n\n            If Response = vbYes Then\n                OptionAmount = 0\n                OptionCheck = False\n            Else\n                OptionCheck.Undo\n                MsgBox \"Ok, we will leave it as is.\", vbOKOnly, \"Better Safe Than Sorry.\"\n            End If\n        Else\n            OptionCheck = False\n        End If\n    Else\n        If Forms!frmPerson.NoOptions = True Then\n            Msg2 = \"No Options is Checked. Checking \" &amp; OptionName &amp; \" Options will require no Options to be unchecked.\" &amp; vbCrLf &amp; _\n            \"Would you like to uncheck no Options?\"\n            Style2 = vbYesNo\n            Title2 = \"Confirm No Options False.\"\n            Response2 = MsgBox(Msg2, Style2, Title2)\n            If Response2 = vbYes Then\n                OptionsAllowPubFunc (True)\n                Forms!frmPerson.NoOptions = False\n                OptionCheck = True\n            Else\n                OptionCheck = True\n            End If\n        Else\n        OptionCheck = True\n    End If\nEnd Function\n</code></pre>\n\n<p>I'm testing this, and when I try to check the No Options checkbox, changing it from false to true, I get a run-time error '-2147352567 (80020009)':</p>\n\n<blockquote>\n  <p>The macro or function set to BeforeUpdate or ValidationRule property\n  for this field is preventing the [People application] from saving data\n  in the field.</p>\n</blockquote>\n\n<p>Anyone know what I'm doing wrong?  Is there a more simple way to do this?</p>\n\n<p>Thank you!!!</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 2, "creation_date": 1527082108, "post_id": 50489608, "comment_id": 87992190, "body": "Does the job run as <code>System</code> or with a specific user (have you entered a password for the job?) If it runs as <code>System</code>, you don&#39;t have access to network resources"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1527082112, "post_id": 50489608, "comment_id": 87992192, "body": "How exactly do you run it from the Task Scheduler?"}, {"owner": {"reputation": 1, "user_id": 9834698, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216559661209112/picture?type=large", "display_name": "Drew Berger", "link": "https://stackoverflow.com/users/9834698/drew-berger"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1527082305, "post_id": 50489608, "comment_id": 87992357, "body": "@FunThomas I run it from a user and I have to enter the password when I save the task.  I can see it open the db but as I said it goes to the error handler."}, {"owner": {"reputation": 1, "user_id": 9834698, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216559661209112/picture?type=large", "display_name": "Drew Berger", "link": "https://stackoverflow.com/users/9834698/drew-berger"}, "edited": false, "score": 0, "creation_date": 1527082355, "post_id": 50489608, "comment_id": 87992391, "body": "unfortunately I am not the network admin so I am running it from a user workstation."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1527083169, "post_id": 50489608, "comment_id": 87992983, "body": "Is it possible that the network drive is not mapped to V for this user? Maybe try to use the UNC path to access the file."}, {"owner": {"reputation": 1, "user_id": 9834698, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216559661209112/picture?type=large", "display_name": "Drew Berger", "link": "https://stackoverflow.com/users/9834698/drew-berger"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1527083171, "post_id": 50489608, "comment_id": 87992985, "body": "@FunThomas I looked in the history and it shows that it is running from User: System.  So if I don&#39;t have access to network resources when running as System how do I change it so it has access to the network resources?"}, {"owner": {"reputation": 1, "user_id": 9834698, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216559661209112/picture?type=large", "display_name": "Drew Berger", "link": "https://stackoverflow.com/users/9834698/drew-berger"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1527083211, "post_id": 50489608, "comment_id": 87993022, "body": "@VincentG I mapped the drive myself and it is mapped as V:"}, {"owner": {"reputation": 1, "user_id": 9834698, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216559661209112/picture?type=large", "display_name": "Drew Berger", "link": "https://stackoverflow.com/users/9834698/drew-berger"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1527083345, "post_id": 50489608, "comment_id": 87993135, "body": "@VincentG I also tried removing the V from the code and having it as &quot;\\\\10.10.5.100\\shared\\DHP\\Boards.....&quot; and when I did that it said Error 1004 Microsoft Excel cannot access the file."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1527084129, "post_id": 50489608, "comment_id": 87993668, "body": "@DrewBerger: On the &quot;General&quot; tab of the task properties, you define the user account. Press button &quot;Change User&quot; to define it. If you click &quot;<i>run wether user is logged on or not</i>&quot;, you may not check &quot;<i>Do not store password</i>&quot;"}, {"owner": {"reputation": 1, "user_id": 9834698, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216559661209112/picture?type=large", "display_name": "Drew Berger", "link": "https://stackoverflow.com/users/9834698/drew-berger"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1527084717, "post_id": 50489608, "comment_id": 87994062, "body": "@FunThomas I had it set to run as the current computer username and had the &quot;Do not store password&quot; box unchecked.  If I need to change the user I guess im not sure how to do that.  I did click the change user button but had no clue what to do from there.  The user that is set does have access to all necessary drives because as I said the VBA works flawlessly when running directly from an open session of Access."}, {"owner": {"reputation": 1, "user_id": 9834698, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216559661209112/picture?type=large", "display_name": "Drew Berger", "link": "https://stackoverflow.com/users/9834698/drew-berger"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1527097726, "post_id": 50489608, "comment_id": 88001864, "body": "@VincentG do you have any other suggestions?  I have been looking for a while online and can not find anything relevant.  The Access file is located on the C drive of the computer running the Task.  The code in that file I have changed to the UNC path and still it will not open the excel files.  As I said it works fine from Access just not when Access is started by the Task Scheduler."}, {"owner": {"reputation": 1, "user_id": 9834698, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216559661209112/picture?type=large", "display_name": "Drew Berger", "link": "https://stackoverflow.com/users/9834698/drew-berger"}, "edited": false, "score": 0, "creation_date": 1527102500, "post_id": 50489608, "comment_id": 88004267, "body": "I found on Microsoft&#39;s site that this is not possible for Office products with the &quot;Run whether user is logged on or not&quot; checked.  The only way to do this is to leave the user logged on constantly."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9834698, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216559661209112/picture?type=large", "display_name": "Drew Berger", "link": "https://stackoverflow.com/users/9834698/drew-berger"}, "is_accepted": false, "score": 0, "last_activity_date": 1527102603, "creation_date": 1527102603, "answer_id": 50495818, "question_id": 50489608, "link": "https://stackoverflow.com/questions/50489608/access-vba-not-finding-excel-files-on-server-when-using-task-scheduler/50495818#50495818", "title": "Access VBA not finding Excel files on server when using Task Scheduler", "body": "<p>I found on Microsoft's site that this is not possible for Office products with the \"Run whether user is logged on or not\" checked.  The only way to do this is to leave the user logged on constantly.  See the reply from Mark Burns.</p>\n\n<p><a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/7d81395f-fc98-4e96-90e0-1331cb4dab3d/scheduled-macro-only-runs-if-user-is-logged-in-windows-server-2003r2?forum=accessdev\" rel=\"nofollow noreferrer\">https://social.msdn.microsoft.com/Forums/office/en-US/7d81395f-fc98-4e96-90e0-1331cb4dab3d/scheduled-macro-only-runs-if-user-is-logged-in-windows-server-2003r2?forum=accessdev</a></p>\n"}], "owner": {"reputation": 1, "user_id": 9834698, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216559661209112/picture?type=large", "display_name": "Drew Berger", "link": "https://stackoverflow.com/users/9834698/drew-berger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594634661, "creation_date": 1527081835, "last_edit_date": 1594634661, "question_id": 50489608, "link": "https://stackoverflow.com/questions/50489608/access-vba-not-finding-excel-files-on-server-when-using-task-scheduler", "title": "Access VBA not finding Excel files on server when using Task Scheduler", "body": "<p>Hello I am getting a 1004 error when trying to run my code via the task scheduler.  I can run the macro that executes the code directly from Access and it works fine but when running from Task Scheduler it will not find the file path and error handler kicks in and emails me.  Any thoughts as to how to fix this?  The reason for opening each of these excel files is to run their VBA which updates them to text only from another excel file that contains a lot of complex formulas.  Linking to the excel file that had all of the formulas proved too slow.</p>\n\n<p>Here is the code.</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\n\nPublic Function UpdateData()\n\n    Dim xlApp As Object\n    Dim mail As CDO.Message\n    Dim config As CDO.Configuration\n\n    On Error GoTo 100\n\n    Set xlApp = CreateObject(\"Excel.Application\")\n\n    With xlApp\n        .Application.Visible = False\n        .Workbooks.Open \"V:\\DHP\\Boards\\Access Data\\CV1Data.xlsm\"\n        .Workbooks(\"CV1Data.xlsm\").Save\n        .Workbooks.Open \"V:\\DHP\\Boards\\Access Data\\CV2Data.xlsm\"\n        .Workbooks(\"CV2Data.xlsm\").Save\n        .Workbooks.Open \"V:\\DHP\\Boards\\Access Data\\CV3Data.xlsm\"\n        .Workbooks(\"CV3Data.xlsm\").Save\n        .Workbooks.Open \"V:\\DHP\\Boards\\Access Data\\CV4Data.xlsm\"\n        .Workbooks(\"CV4Data.xlsm\").Save\n        .Workbooks.Open \"V:\\DHP\\Boards\\Access Data\\602Data.xlsm\"\n        .Workbooks(\"602Data.xlsm\").Save\n        .Workbooks.Open \"V:\\DHP\\Boards\\Access Data\\PVGData.xlsm\"\n        .Workbooks(\"PVGData.xlsm\").Save\n        .Workbooks.Open \"V:\\DHP\\Boards\\Access Data\\PV24Data.xlsm\"\n        .Workbooks(\"PV24Data.xlsm\").Save\n        .Workbooks.Open \"V:\\DHP\\Boards\\Access Data\\ReasonCodes.xlsm\"\n        .Workbooks(\"ReasonCodes.xlsm\").Save\n    End With\n\n    xlApp.Quit\n\n    Set xlApp = Nothing\n\n    Application.SetOption \"Auto compact\", True\n    Application.Quit\n    Exit Function\n\n100:\n\n    Set mail = CreateObject(\"CDO.Message\")\n    Set config = CreateObject(\"CDO.Configuration\")\n\n    config.Fields(cdoSendUsingMethod).Value = cdoSendUsingPort\n    config.Fields(cdoSMTPServer).Value = \"mr.domain.com\"\n    config.Fields(cdoSMTPServerPort).Value = 25\n    config.Fields.Update\n\n    Set mail.Configuration = config\n\n    With mail\n        .To = \"First.Last@Domain.com\"\n        .From = \"First.Last@Domain.com\"\n        .Subject = \"Error Occured - Error Number \" &amp; Err.Number\n        .TextBody = \"DHPTables Database -\" &amp; Err.Description\n        .Send\n    End With\n\n    Set config = Nothing\n    Set mail = Nothing\n\n    Application.SetOption \"Auto compact\", True\n    Application.Quit\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 9834685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0051458b4627d8bdb7a592fc46e15f3d?s=128&d=identicon&r=PG&f=1", "display_name": "DuctTape7", "link": "https://stackoverflow.com/users/9834685/ducttape7"}, "edited": false, "score": 0, "creation_date": 1528285754, "post_id": 50490404, "comment_id": 88447664, "body": "As newbie to vba, could you comment your code more troughoutly?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 101, "user_id": 9834685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0051458b4627d8bdb7a592fc46e15f3d?s=128&d=identicon&r=PG&f=1", "display_name": "DuctTape7", "link": "https://stackoverflow.com/users/9834685/ducttape7"}, "edited": false, "score": 0, "creation_date": 1528296394, "post_id": 50490404, "comment_id": 88454937, "body": "Done. I&#39;ve also given slightly more useful Subroutines that should make it easier for you to use."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 2, "last_activity_date": 1528296340, "last_edit_date": 1528296340, "creation_date": 1527084134, "answer_id": 50490404, "question_id": 50489540, "link": "https://stackoverflow.com/questions/50489540/custom-printing-area-macro/50490404#50490404", "title": "Custom printing area macro", "body": "<p>If you create and load a range into <code>rng_to_add</code>, the following will take the existing PrintArea and <code>Union</code> (append to) the <code>rng_to_add</code>:</p>\n\n<pre><code>' Going into this, you need to have declared a variable called rng_to_add\nDim rng_to_add As Range\n\n' and loaded the range area you want to add to the PrintArea. This will\n' be different for your particular situation.\nSet rng_to_add = Sheets(\"Sheet1\").Range(\"A1:C3\")\n\n' Referring to the current PageSetup of the Activesheet..\nWith ActiveSheet.PageSetup\n\n    ' Check if the PrintArea of above PageSetup is empty\n    If .PrintArea = \"\" Then\n        ' If so, set the PrintArea to the address of the Range: rng_to_add\n        .PrintArea = rng_to_add.Address\n    Else\n        ' If not, set it to the address of a union (append) of the existing\n        ' PrintArea's range and the address of the Range: rng_to_add\n        .PrintArea = Union(Range(.PrintArea), rng_to_add).Address\n    End If\n\n' End the reference to the current PageSetup of the Activesheet\nEnd With\n</code></pre>\n\n<hr>\n\n<p>So, for portability and/or integrating into your existing routines, you could create subroutines that manage the PrintArea like so:</p>\n\n<pre><code>Sub Clear_PrintArea()\n    ' Set PrintArea to nothing\n    ActiveSheet.PageSetup.PrintArea = \"\"\nEnd Sub\n\n\nSub Add_range_to_PrintArea(rng_to_add As Range)\n\n    ' Referring to the current PageSetup of the Activesheet..\n    With ActiveSheet.PageSetup\n\n        ' Check if the PrintArea of above PageSetup is empty\n        If .PrintArea = \"\" Then\n            ' If so, set the PrintArea to the address of the Range: rng_to_add\n            .PrintArea = rng_to_add.Address\n        Else\n            ' If not, set it to the address of a union (append) of the existing\n            ' PrintArea's range and the address of the Range: rng_to_add\n            .PrintArea = Union(Range(.PrintArea), rng_to_add).Address\n        End If\n\n    ' End the reference to the current PageSetup of the Activesheet\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>You could then <strong>call</strong> it like so:</p>\n\n<pre><code>Clear_PrintArea\nAdd_range_to_PrintArea Range(\"A1:C3\")\nAdd_range_to_PrintArea Range(\"A7:C10\")\nAdd_range_to_PrintArea Range(\"A13:C16\")\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 9834685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0051458b4627d8bdb7a592fc46e15f3d?s=128&d=identicon&r=PG&f=1", "display_name": "DuctTape7", "link": "https://stackoverflow.com/users/9834685/ducttape7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528296340, "creation_date": 1527081664, "last_edit_date": 1531161705, "question_id": 50489540, "link": "https://stackoverflow.com/questions/50489540/custom-printing-area-macro", "title": "Custom printing area macro", "body": "<p>I'm making a macro that sets a print area to user selected areas of document. Basically there is a box next to a bunch of cells and if user ticks the box then the bunch of cells is included to the print area.\nHere is my code so far:</p>\n\n<pre><code>Sub TestCellA1()\n\n    Dim t As Integer, d As Integer\n    t = 0\n    d = 20\n    Dim rng_per As Range\n    Set rng_per = Range(\"A3:E328\") 'prints whole document\n    Dim rng1 As Range\n\n    If Not IsEmpty(Range(\"F19\")) = True Then\n        ActiveSheet.PageSetup.PrintArea = Range(rng_per)\n\n    Else\n        Do While t &lt; 10\n            If IsEmpty(Range(\"F\" &amp; d).Value) = True Then\n                'MsgBox \"Do not print\"\n            Else\n                'MsgBox \"Do print\"\n                ActiveSheet.PageSetup.PrintArea = rng1\n            End If\n            t = t + 1\n            d = d + 25\n\n        Loop\n\n    End If\nEnd Sub\n</code></pre>\n\n<p>So far this works to the point where the actual work is supposed to be done. I planned that everytime when loop finds box ticked it adds that part of document to the print area. As a newbie with vba I have no idea how to add those areas to print area. Any ideas how to do it? Thanks in advance&amp; have a good day.</p>\n"}, {"tags": ["excel", "vba", "debugging"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1527081696, "post_id": 50489427, "comment_id": 87991884, "body": "What is the idea of <code>Let DateWriter = &quot;28&#47;09&#47;2018&quot;</code>? Is it better to write <code>DataWriter.Value = = &quot;28&#47;09&#47;2018&quot;</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1527084681, "post_id": 50489427, "comment_id": 87994044, "body": "What is the need for <code>For Each c in StatusValue</code> or <code>For Each v In QuotationOpen</code> since <code>StatusValue</code> and <code>QuotationOpen</code> are both just single cells?"}, {"owner": {"reputation": 13, "user_id": 9834687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maria Fakhry", "link": "https://stackoverflow.com/users/9834687/maria-fakhry"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1527085985, "post_id": 50489427, "comment_id": 87994981, "body": "@Vityata I wanted it to match the row where QuotationOpen is Q3ING18. But I will try"}, {"owner": {"reputation": 13, "user_id": 9834687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maria Fakhry", "link": "https://stackoverflow.com/users/9834687/maria-fakhry"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1527086133, "post_id": 50489427, "comment_id": 87995096, "body": "@bigben I didnt think of it I immagined them being the range of cells in that column. Basically what I wanted to do is for every q3ing18 in the column C, The date 28/09/2018 gets written in the column G"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1527086645, "post_id": 50489427, "comment_id": 87995445, "body": "But they&#39;re not the range of cells in that column - you set them to be a single cell with <code>Cells(x, 4)</code> and <code>Cells(x, 3)</code>. You&#39;re iterating down the column with <code>x</code>... Do you have to do this with VBA? Seems like you could use a formula. <code>=IF(AND(C4=&quot;Q3ING18&quot;,D4=&quot;DESIGN&quot;),DATEVALUE(&quot;28&#47;09&#47;2018&quot;),&quot;&quot;&zwnj;&#8203;)</code>"}, {"owner": {"reputation": 13, "user_id": 9834687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maria Fakhry", "link": "https://stackoverflow.com/users/9834687/maria-fakhry"}, "edited": false, "score": 0, "creation_date": 1527086798, "post_id": 50489427, "comment_id": 87995553, "body": "I have other Dates to match with weird names from the same column"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1527086941, "post_id": 50489427, "comment_id": 87995656, "body": "If you&#39;re just matching names to dates, can you use a <code>Vlookup</code> against a table of the matches?"}, {"owner": {"reputation": 13, "user_id": 9834687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maria Fakhry", "link": "https://stackoverflow.com/users/9834687/maria-fakhry"}, "edited": false, "score": 0, "creation_date": 1527088029, "post_id": 50489427, "comment_id": 87996468, "body": "It&#39;s giving me a circular reference error"}, {"owner": {"reputation": 13, "user_id": 9834687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maria Fakhry", "link": "https://stackoverflow.com/users/9834687/maria-fakhry"}, "edited": false, "score": 0, "creation_date": 1527088715, "post_id": 50489427, "comment_id": 87996922, "body": "<code>=IF(D14=&quot;DESIGN&quot;;VLOOKUP(C14;Sheet3!A:B;G:G;FALSE);&quot;N&#47;A&quot;)</code> I&#39;m trying this formula but its giving me an error as a result"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1527089550, "post_id": 50489427, "comment_id": 87997473, "body": "Those <code>;</code> should be <code>,</code>. Also check your syntax in <code>Vlookup</code>: the 3rd argument is the column index number (e.g. 2), not a column."}, {"owner": {"reputation": 13, "user_id": 9834687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maria Fakhry", "link": "https://stackoverflow.com/users/9834687/maria-fakhry"}, "edited": false, "score": 0, "creation_date": 1527091305, "post_id": 50489427, "comment_id": 87998607, "body": "I tried switching the <code>;</code>to <code>,</code>it gave me an incorrect syntax, so i left them and I&#39;m still getting the same error"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1527093175, "post_id": 50489427, "comment_id": 87999628, "body": "I would familiarize yourself with <a href=\"https://support.office.com/en-us/article/vlookup-function-0bbc8083-26fe-4963-8ab8-93a18ad188a1\" rel=\"nofollow noreferrer\">Vlookups</a>. The use of the semicolon is foreign to me but maybe <a href=\"https://lockone.wordpress.com/2015/08/06/excel-now-using-semicolons-instead-of-commas-in-separating-formulas-fix-it-now\" rel=\"nofollow noreferrer\">this setting</a> is applicable in your case. If so, you still need to fix the 3rd argument in the Vlookup."}, {"owner": {"reputation": 13, "user_id": 9834687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maria Fakhry", "link": "https://stackoverflow.com/users/9834687/maria-fakhry"}, "edited": false, "score": 0, "creation_date": 1527093794, "post_id": 50489427, "comment_id": 87999942, "body": "I did but it did not change anything , <code>=IF(D14=&quot;DESIGN&quot;;VLOOKUP(C14;Sheet3!A:B;7;FALSE);&quot;N&#47;A&quot;)</code>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1527094785, "post_id": 50489427, "comment_id": 88000439, "body": "Again, please read about Vlookup. Your specified range to look at - <code>Sheet3!A:B</code> - only has 2 columns and you&#39;re telling Excel to look at the 7th column."}], "owner": {"reputation": 13, "user_id": 9834687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maria Fakhry", "link": "https://stackoverflow.com/users/9834687/maria-fakhry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1527081824, "creation_date": 1527081315, "last_edit_date": 1527081824, "question_id": 50489427, "link": "https://stackoverflow.com/questions/50489427/vba-is-giving-error-13-type-mismatch-datatypes-range", "title": "VBA is giving error 13 &quot;Type Mismatch&quot; datatypes range", "body": "<p>I am trying to write a code to take a specific name from a column and match a date with it in a next one,</p>\n\n<pre><code>Sub ContractDates()\n\n    Dim StatusValue As Range\n    Dim QuotationOpen As Range\n    Dim DateWriter As Range\n    Dim x As Long\n    Dim rFind As Range\n\n    lastrow = Sheets(\"Sheet2\").Cells(Rows.Count, 1).End(xlUp).Row\n\n    For x = 2 To lastrow\n        Set StatusValue = Cells(x, 4)\n        For Each c In StatusValue\n            If StatusValue = \"DESIGN\" Then\n                Set QuotationOpen = Cells(x, 3)\n                For Each v In QuotationOpen\n                    If QuotationOpen = \"Q3ING18\" Then\n                        Set DateWriter = Cells(x, 7)\n                        Let DateWriter = \"28/09/2018\"\n                    End If\n                Next\n            End If\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>And It is giving me the error on the line that says </p>\n\n<pre><code>If QuotationOpen = \"Q3ING18\" Then\n</code></pre>\n\n<p>But not on the line that says </p>\n\n<pre><code>If StatusValue= \"DESIGN\" Then\n</code></pre>\n\n<p>Even though they are both 'range'\nAnd I can't figure out why</p>\n"}, {"tags": ["vba", "excel", "list", "rows"], "comments": [{"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 0, "creation_date": 1527080851, "post_id": 50489113, "comment_id": 87991284, "body": "Look at array solution: <a href=\"https://stackoverflow.com/questions/50379087/for-loop-using-dates-compile-error-syntax-error/50379235#50379235\" title=\"for loop using dates compile error syntax error\">stackoverflow.com/questions/50379087/&hellip;</a>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1527080987, "post_id": 50489113, "comment_id": 87991391, "body": "Is this <code>Next j, i</code> and <code>Then _ Cells.Rows(i).Delete: Exit For</code> really working as you wish?"}, {"owner": {"reputation": 43, "user_id": 9834548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b81e94d3ea46059ab08f90580f3f9e26?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9834548/john"}, "edited": false, "score": 0, "creation_date": 1527081278, "post_id": 50489113, "comment_id": 87991606, "body": "Yes it is working. I checked the results with the reports prepared manually, without a macro."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1527081380, "post_id": 50489113, "comment_id": 87991684, "body": "I see. Still, it hurts my eyes a bit, but if you like it - it is ok. Concerning the speeding up - put all the relevant rows in one range with a <code>Union()</code> and delete the range once. See <a href=\"https://stackoverflow.com/a/50372692/5448626\">here</a> or <a href=\"https://stackoverflow.com/a/50350507/5448626\">even better here</a>"}, {"owner": {"reputation": 415, "user_id": 6339516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/piSbx.jpg?s=128&g=1", "display_name": "J.B.", "link": "https://stackoverflow.com/users/6339516/j-b"}, "edited": false, "score": 0, "creation_date": 1527082189, "post_id": 50489113, "comment_id": 87992275, "body": "I would rather use VLOOKUP in helper column, filter the helper column for non blank cells and delete the rows at once. All these can be coded in macro."}, {"owner": {"reputation": 43, "user_id": 9834548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b81e94d3ea46059ab08f90580f3f9e26?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9834548/john"}, "edited": false, "score": 0, "creation_date": 1527151295, "post_id": 50489113, "comment_id": 88021560, "body": "Thank you for all suggestions, currently I am using the method with deleting all of them at the end by help of Union(), which got be faster results but still takes around 3 minutes to be done."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1527188607, "post_id": 50489113, "comment_id": 88045384, "body": "What are the addresses of both ranges?"}, {"owner": {"reputation": 43, "user_id": 9834548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b81e94d3ea46059ab08f90580f3f9e26?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9834548/john"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1527241101, "post_id": 50489113, "comment_id": 88063874, "body": "@JohnyL: I&#39;m not sure If I know what you mean. In the report tab, there is data from column A to L. the dates are in column E. As for holidays, I have them listed in column A."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 9834548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b81e94d3ea46059ab08f90580f3f9e26?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9834548/john"}, "edited": false, "score": 0, "creation_date": 1527152017, "post_id": 50493411, "comment_id": 88022072, "body": "Hello, I&#39;ve tried your code but there is a problem with line:         <code>Set vis = ur.SpecialCells(xlCellTypeVisible)</code> It says that no cells were found."}, {"owner": {"reputation": 43, "user_id": 9834548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b81e94d3ea46059ab08f90580f3f9e26?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9834548/john"}, "edited": false, "score": 0, "creation_date": 1527240977, "post_id": 50493411, "comment_id": 88063789, "body": "Thank you for that code! Unfortunately it seems to work only with cells containing a letter. It doesn&#39;t recognize dates (which are a criteria here) and therefore nothing is removed."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 43, "user_id": 9834548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b81e94d3ea46059ab08f90580f3f9e26?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9834548/john"}, "edited": false, "score": 0, "creation_date": 1527249480, "post_id": 50493411, "comment_id": 88068902, "body": "Can you provide 3 sample dates (exact format) from <code>Holidays</code> and 3 more from <code>Report</code> so I can test the code?"}, {"owner": {"reputation": 43, "user_id": 9834548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b81e94d3ea46059ab08f90580f3f9e26?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9834548/john"}, "edited": false, "score": 0, "creation_date": 1527250337, "post_id": 50493411, "comment_id": 88069429, "body": "Sure, for instance I have those in Report:                                                   7/26/2016     8/2/2016     8/9/2016     6/5/2017 and these in Holidays:5/25/2017 6/5/2017 6/23/2017"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 43, "user_id": 9834548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b81e94d3ea46059ab08f90580f3f9e26?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9834548/john"}, "edited": false, "score": 0, "creation_date": 1527260404, "post_id": 50493411, "comment_id": 88076046, "body": "Great! How many total dates do you have in <code>Holidays</code>? All dates are in <code>Holidays.colA</code>, correct? And are all dates in <code>Report.colA</code> as well?"}, {"owner": {"reputation": 43, "user_id": 9834548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b81e94d3ea46059ab08f90580f3f9e26?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9834548/john"}, "edited": false, "score": 0, "creation_date": 1527260728, "post_id": 50493411, "comment_id": 88076225, "body": "I have 14 dates in Holidays. Yes, they are in column A, starting A2.There are around 82k dates in Report, column E."}, {"owner": {"reputation": 43, "user_id": 9834548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b81e94d3ea46059ab08f90580f3f9e26?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9834548/john"}, "edited": false, "score": 0, "creation_date": 1527517233, "post_id": 50493411, "comment_id": 88146729, "body": "That works great! Thanks a lot for the help, Paul Bica!"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1527280133, "last_edit_date": 1527280133, "creation_date": 1527093383, "answer_id": 50493411, "question_id": 50489113, "link": "https://stackoverflow.com/questions/50489113/deleting-rows-in-vba-based-on-a-list/50493411#50493411", "title": "Deleting rows in VBA based on a list", "body": "<p>This should remove about 10 K rows out of 200 K, in less than 30 seconds</p>\n\n<p>Code bellow assumes that <code>UsedRange</code> on both sheets starts in <code>A1</code>, and</p>\n\n<ul>\n<li>Sheet <code>Holidays</code> contains only column <code>A</code> (in contiguous rows)</li>\n<li>Sheet <code>Report</code> contains dates to be removed in column <code>E</code> (in contiguous rows)</li>\n<li>Dates on both sheets are formatted as <strong><code>\"m/d/yyyy\"</code></strong></li>\n</ul>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub RemoveHolidaysFromReportFilterUnion()\n    Const WS_NAME = \"Report\"\n    Dim wsH As Worksheet:   Set wsH = ThisWorkbook.Worksheets(\"Holidays\")\n    Dim wsR As Worksheet:   Set wsR = ThisWorkbook.Worksheets(WS_NAME)\n\n    Dim del As Range, wsNew As Worksheet\n\n    Application.ScreenUpdating = False\n    Set del = GetRowsToDelete(wsH, wsR)\n    If del.Cells.Count &gt; 1 Then\n        del.EntireRow.Hidden = True\n        Set wsNew = ThisWorkbook.Worksheets.Add(After:=wsR)\n        wsR.UsedRange.SpecialCells(xlCellTypeVisible).EntireRow.Copy\n        With wsNew.Cells(1)\n            .PasteSpecial xlPasteColumnWidths\n            .PasteSpecial xlPasteAll\n            .Select\n        End With\n        Application.DisplayAlerts = False\n        wsR.Delete\n        Application.DisplayAlerts = True\n        wsNew.Name = WS_NAME\n    End If\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Function GetRowsToDelete(ByRef wsH As Worksheet, ByRef wsR As Worksheet) As Range\n    Const HOLIDAYS_COL = \"A\"\n    Const REPORT_COL = \"E\"\n    Dim arr As Variant, i As Long, itm As Variant\n\n    ReDim arr(1 To wsH.UsedRange.Rows.Count - 1)\n    i = 1\n    For Each itm In wsH.UsedRange.Columns(HOLIDAYS_COL).Offset(1).Cells\n        If Len(itm) &gt; 0 Then\n            arr(i) = itm.Text   'Create AutoFilter Array (dates as strings)\n            i = i + 1\n        End If\n    Next\n\n    Dim ur As Range, del As Range, lr As Long, fc As Range\n\n    With wsR.UsedRange\n        Set ur = .Resize(.Rows.Count - 1, 1).Offset(1)\n        Set del = wsR.Cells(.Rows.Count + 1, REPORT_COL)\n    End With\n\n    lr = wsR.UsedRange.Rows.Count\n    Set fc = wsR.Range(wsR.Cells(1, REPORT_COL), wsR.Cells(lr, REPORT_COL))\n    fc.AutoFilter Field:=1, Criteria1:=arr, Operator:=xlFilterValues\n    If fc.SpecialCells(xlCellTypeVisible).Cells.Count &gt; 1 Then\n        Set del = Union(del, ur.SpecialCells(xlCellTypeVisible))\n    End If\n    fc.AutoFilter\n    Set GetRowsToDelete = del\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>Performance - <code>Removed about 5K rows out of a total of 100K</code></p>\n\n<pre><code>Sheet Report   - Rows: 100,011, Cols: 11   (Rows Left: 94,805 - Deleted: 5,206)\nSheet Holidays - Rows:      20, Cols:  1\n\nInitial Sub - Holidays()              - Time: 112.625 sec\nRemoveHolidaysFromReportFilterUnion() - Time:  10.512 sec\n</code></pre>\n\n<hr>\n\n<p>Test Data</p>\n\n<p><strong><code>Holidays</code></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/Nx8Ur.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Nx8Ur.png\" alt=\"Holidays\"></a></p>\n\n<hr>\n\n<p><strong><code>Report</code></strong> - <strong><code>Before</code></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/SJxXt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SJxXt.png\" alt=\"ReportBefore\"></a></p>\n\n<p><strong><code>Report</code></strong> - <strong><code>After</code></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/3vKJW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3vKJW.png\" alt=\"ReportAfter\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 17, "user_id": 9605728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81754427bb7396706be2bc01d03ccf2f?s=128&d=identicon&r=PG&f=1", "display_name": "Akshit A.", "link": "https://stackoverflow.com/users/9605728/akshit-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1570601251, "last_edit_date": 1570601251, "creation_date": 1570600922, "answer_id": 58297893, "question_id": 50489113, "link": "https://stackoverflow.com/questions/50489113/deleting-rows-in-vba-based-on-a-list/58297893#58297893", "title": "Deleting rows in VBA based on a list", "body": "<h2>I would suggest using arrays.</h2>\n\n<ol>\n<li><p>Populate an Array for the list of dates. example:</p>\n\n<p>arr = Array(\"Alpha\",\"Bravo\",\"Charlie\")</p></li>\n<li><p>Filter the report based on Criteria. </p></li>\n</ol>\n\n<p><code>Sheet17.Range(\"E1\").AutoFilter Field:=5, Criteria1:=arr,</code> <code>Operator:=xlFilterValues</code></p>\n\n<ol start=\"3\">\n<li>Once the sheet is filtered, create a range of selected visible cells</li>\n</ol>\n\n<p><code>set myrange = range(\"A1:F\" &amp;_</code> </p>\n\n<pre><code>Cells(Rows.Count,\"A\").end(xlup).row).SpecialCells(xlCellTypeVisible)\n</code></pre>\n\n<ol start=\"4\">\n<li>Delele the Range using <code>Range(\u201cYourRange\u201d).EntireRow.Delete</code></li>\n</ol>\n\n<p>This will delete the range in 4 operations instead of looping through every row in the range based on the condition. </p>\n\n<p>Hope that helps!</p>\n"}], "owner": {"reputation": 43, "user_id": 9834548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b81e94d3ea46059ab08f90580f3f9e26?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9834548/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 360, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1570601251, "creation_date": 1527080407, "question_id": 50489113, "link": "https://stackoverflow.com/questions/50489113/deleting-rows-in-vba-based-on-a-list", "title": "Deleting rows in VBA based on a list", "body": "<p>I have two tabs in my spreadsheets (Report and Holidays). In column A of Holidays tab there is a list of dates (updated manually) which I want to exclude from Report tab (column E contains dates).</p>\n\n<p>I have found a code which does what is needed but takes some time when the number of rows is around 100-200k:</p>\n\n<pre><code>Sub Holidays()\nApplication.DisplayAlerts = False\nDim d As Object, e, rws&amp;, cls&amp;, i&amp;, j&amp;\nSet d = CreateObject(\"scripting.dictionary\")\nFor Each e In Sheets(\"Holidays\").Range(\"A1\").CurrentRegion\n    d(e.Value) = 1\nNext e\nSheets(\"Report\").Activate\nrws = Cells.Find(\"*\", After:=[a1], SearchOrder:=xlByRows, _\n        SearchDirection:=xlPrevious).Row\ncls = Cells.Find(\"*\", After:=[a1], SearchOrder:=xlByColumns, _\n        SearchDirection:=xlPrevious).Column\nFor i = rws To 1 Step -1\n    For j = 1 To cls\n        If d(Range(\"A1\").Resize(rws, cls)(i, j).Value) = 1 Then _\n            Cells.Rows(i).Delete: Exit For\nNext j, i\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>Is there a way to speed up that macro? Ideally it should take only several seconds to run. </p>\n\n<p>Thank you in advance for your help.  </p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1527079463, "post_id": 50488732, "comment_id": 87990321, "body": "Please show some sample data"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1527079681, "post_id": 50488732, "comment_id": 87990488, "body": "@Luuklag As in screenshots or do you want a link to a file?"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1527079753, "post_id": 50488732, "comment_id": 87990536, "body": "Just some of the data that are in the column, you can just post as text in your question"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1527080550, "post_id": 50488732, "comment_id": 87991108, "body": "are all the prefixes 2 chars?"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1527081120, "post_id": 50488732, "comment_id": 87991488, "body": "@Nathan_Sav Some might only be 1 char"}], "answers": [{"comments": [{"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1527255517, "post_id": 50490207, "comment_id": 88072850, "body": "Thank you very much for your reply, your method will work but I think this might bring up some false positives as the data in the table also contains prefix&#39;d numbers and non-prefix&#39;d numbers, so it is very possible that after the prefix is removed, it might end up matching with the same number in the table but that does not necessarily meant that it is the correct number.  Apart from this, I recon I would need to apply the same method to my table so as to attempt to match 12356 with 123456 instead of trying to match 123456 with AB123456."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1527255600, "post_id": 50490207, "comment_id": 88072920, "body": "What I believe I meant to ask was to search for a string match instead of a number match.. However, I asked it incorrectly and you answered what I asked. So I will mark this as solved. Thank you for the effort :)"}], "tags": [], "owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "is_accepted": true, "score": 1, "last_activity_date": 1527083596, "creation_date": 1527083596, "answer_id": 50490207, "question_id": 50488732, "link": "https://stackoverflow.com/questions/50488732/vba-isnumber-returns-nothing-due-to-prefix/50490207#50490207", "title": "VBA - IsNumber Returns Nothing Due to Prefix", "body": "<p>this formula tells you if there is 2,1 or 0 non number prefixes. You can use the number that this formula produces to cut the prefixes off of the number and then conduct your match.</p>\n\n<p>Formula 1:</p>\n\n<pre><code>=IF(ISNUMBER(NUMBERVALUE(LEFT(B2,1))),0,IF(ISNUMBER(NUMBERVALUE(RIGHT(LEFT(B2,2),1))),1,2))\n</code></pre>\n\n<p>If the first char on the from left of the string is a number, return 0, if it is not check if the first char from the right of the string formed when taking the first two chars from the left of the string is a number, if that too is a number then return 2, else 1</p>\n\n<p>Formula 2:</p>\n\n<pre><code>=RIGHT(B2,LEN(B2)-C2)\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/7gYyO.png\" alt=\"\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/zbqlb.png\" alt=\"\"></p>\n"}], "owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 50490207, "answer_count": 1, "score": 0, "last_activity_date": 1527254792, "creation_date": 1527079384, "last_edit_date": 1527254792, "question_id": 50488732, "link": "https://stackoverflow.com/questions/50488732/vba-isnumber-returns-nothing-due-to-prefix", "title": "VBA - IsNumber Returns Nothing Due to Prefix", "body": "<p>Follow Up Question from:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/50227693/vba-match-lookup-with-multiple-parameters\">VBA - Match Lookup With Multiple Parameters</a></p>\n\n<p>The code below works well, but I have since realized that the values in column A sometimes contain a prefix, which therefore returns nothing.</p>\n\n<p>Hoping someone can edit the actually formula to account for a 2 letter prefix in front of the number.</p>\n\n<p><strong><em>Code:</em></strong></p>\n\n<pre><code>Sub PlaceFormula()\nDim ws As Worksheet\nDim lr As Long\nDim lc As Long\n\nWith Application\n    .Calculation = xlCalculationManual\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\nSet ws = Sheets(\"Main\")\nlr = ws.Cells(Rows.Count, 1).End(xlUp).Row\nlc = ws.Cells(1, Columns.Count).End(xlToLeft).Column\n\nws.Range(\"B2\", ws.Cells(lr, lc)).Formula = \"=IF(ISNUMBER(MATCH($A2&amp;B$1,INDEX(tStatus[[Employee Number]:[Employee Number]]&amp;tStatus[[Wk Number]:[Wk Number]],),0)),\"\"Match\"\",\"\"\"\")\"\nws.Range(\"B2\", ws.Cells(lr, lc)).Value = ws.Range(\"B2\", ws.Cells(lr, lc)).Value\n\nWith Application\n    .Calculation = xlCalculationAutomatic\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Sample of data in Column A:</p>\n\n<p>12345</p>\n\n<p>24681</p>\n\n<p>78956</p>\n\n<p>AB12345</p>\n\n<p>A78956</p>\n\n<p>The data in the table will also contain  prefix IF the value is there.. So essentially, the MATCH is looking for an exact match.</p>\n\n<p>Link to a sample file:</p>\n\n<p><a href=\"https://drive.google.com/file/d/1Uoa0Yn72nSckQaBnl6Y-a2q6UMJX6H3f/view?usp=sharing\" rel=\"nofollow noreferrer\">https://drive.google.com/file/d/1Uoa0Yn72nSckQaBnl6Y-a2q6UMJX6H3f/view?usp=sharing</a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 0, "last_activity_date": 1527081588, "creation_date": 1527081588, "answer_id": 50489516, "question_id": 50488625, "link": "https://stackoverflow.com/questions/50488625/export-data-from-excel-to-text-file/50489516#50489516", "title": "Export Data from Excel to Text File", "body": "<p>To add the lines at the beginning of the file, just before the FOR loop add:</p>\n\n<pre><code>Print #FileNumber, x\nPrint #FileNumber, y\n</code></pre>\n\n<p>To put that dollar sign before only the first line while iterating change:</p>\n\n<pre><code>If i = 1 Then i = 2\nPrint #FileNumber, sLine\nsLine = \"\"\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>If i = 1 Then \n   i = 2\n   Print #FileNumber, \"$\" &amp; sLine\nElse\n   Print #FileNumber, sLine\nEnd If\nsLine = \"\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16, "user_id": 9834614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6i2kD.jpg?s=128&g=1", "display_name": "Yogesh", "link": "https://stackoverflow.com/users/9834614/yogesh"}, "is_accepted": true, "score": 0, "last_activity_date": 1527082640, "creation_date": 1527082640, "answer_id": 50489895, "question_id": 50488625, "link": "https://stackoverflow.com/questions/50488625/export-data-from-excel-to-text-file/50489895#50489895", "title": "Export Data from Excel to Text File", "body": "<p>Try this routine:</p>\n\n<p>Added the two lines outside your for loop.</p>\n\n<p>Also '&amp;' and '=' is the only difference in that line, so take it as a variable without those symbols.</p>\n\n<p>Sub ExceltoText()</p>\n\n<pre><code>Dim FileName As String, sLine As String, Deliminator As String\nDim x As String, y As String, z As String\nDim LastCol As Integer, LastRow As Integer, FileNumber As Integer\n\nFileName = \"C:\\Users\\Administrateur\\Desktop\\App vba\\ExcToTxt.txt\"\nDeliminator = \"|\"\nx = \"$=|1|SALARIES|PSA_etablissement|PSA_SALARIE|\"\ny = \"|0|Les Donn\u00e9es de SALARIES\"\nz = \"=|1|SALARIES|\"\n\nLastCol = ActiveSheet.Cells.Cells(1, Columns.Count).End(xlToLeft).Column\nLastRow = ActiveSheet.Cells.Cells(Rows.Count, 1).End(xlUp).Row\n\nFileNumber = FreeFile\n\nOpen FileName For Output As FileNumber\nPrint #FileNumber, \"$\" &amp; y\nPrint #FileNumber, \"=\" &amp; y\nPrint #FileNumber, x\n\nFor i = 1 To LastRow\n    For j = 1 To LastCol\n        If j = LastCol Then\n            sLine = z &amp; sLine &amp; Cells(i, j).Value\n        Else\n            sLine = sLine &amp; Cells(i, j).Value &amp; Deliminator\n        End If\n    Next j\n    Print #FileNumber, sLine\n    sLine = \"\"\nNext i\nClose #FileNumber\nMsgBox \"File generated\"\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 19, "user_id": 9834399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e2daa1c49288d77b7481eafaaf89869?s=128&d=identicon&r=PG&f=1", "display_name": "Ali", "link": "https://stackoverflow.com/users/9834399/ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 554, "favorite_count": 0, "accepted_answer_id": 50489895, "answer_count": 2, "score": 0, "last_activity_date": 1527082640, "creation_date": 1527079011, "last_edit_date": 1531164843, "question_id": 50488625, "link": "https://stackoverflow.com/questions/50488625/export-data-from-excel-to-text-file", "title": "Export Data from Excel to Text File", "body": "<p>i need help plz </p>\n\n<p>I have a excel file and I want to export all data from it to a text file.</p>\n\n<p>This the source code:</p>\n\n<hr>\n\n<pre><code>Sub ExceltoText()\n\n    Dim FileName, sLine, Deliminator, x, y, z As String\n    Dim LastCol, LastRow, FileNumber As Integer\n\n\n    FileName = \"C:\\Users\\Administrateur\\Desktop\\App vba\\ExcToTxt.txt\"\n\n    Deliminator = \"|\"\n    x = \"$|0|Les Donn\u00e9es de SALARIES\"\n    y = \"=|0|Les Donn\u00e9es de SALARIES\"\n    z = \"=|1|SALARIES|\"\n\n    LastCol = ActiveSheet.Cells.SpecialCells(xlCellTypeLastCell).Column\n    LastRow = ActiveSheet.Cells.SpecialCells(xlCellTypeLastCell).Row\n    FileNumber = FreeFile\n\n    Open FileName For Output As FileNumber\n\n    For i = 1 To LastRow\n        For j = 1 To LastCol\n            If j = LastCol Then\n                sLine = z &amp; sLine &amp; Cells(i, j).Value\n            Else\n                sLine = sLine &amp; Cells(i, j).Value &amp; Deliminator\n            End If\n        Next j\n        If i = 1 Then i = 2\n        Print #FileNumber, sLine\n        sLine = \"\"\n    Next i\n    Close #FileNumber\n    MsgBox \"File generated\"\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>In the result I got this text file in that format:</p>\n\n<hr>\n\n<pre><code>=|1|SALARIES|PSA_etablissement|PSA_SALARIE|\n\n=|1|SALARIES|001|10635|\n\n=|1|SALARIES|001|10637|\n</code></pre>\n\n<p>But I want my text file to be like that:</p>\n\n<hr>\n\n<pre><code>$=|1|SALARIES|PSA_etablissement|PSA_SALARIE|\n\n=|1|SALARIES|001|10635|\n\n=|1|SALARIES|001|10637|\n</code></pre>\n\n<p>and I want to add those lines in the beginning of the text file: </p>\n\n<hr>\n\n<pre><code>$|0|Les Donn\u00e9es de SALARIES\n\n=|0|Les Donn\u00e9es de SALARIES\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "Akina"}, "edited": false, "score": 0, "creation_date": 1527078525, "post_id": 50510094, "comment_id": 88032183, "body": "Autoexec macro is started when user interface part of MS Access database started. While connecting to DB and opening linking to its data You don&#39;t init user interface part, so autoexec macro is not executed. You may connect this DB to Your application as a library reference (independent of data connection) and then start execution of the code directly."}, {"owner": {"user_type": "does_not_exist", "display_name": "pbdudley"}, "edited": false, "score": 0, "creation_date": 1527080532, "post_id": 50510094, "comment_id": 88032184, "body": "Ok thank you Akina. I will look into doing that. That would be adding one of the references in ms access to the code? I need to look for a list of the references to find out which one I need, but I will look into it. Knowing that the macro isnt being executed is a good to know"}, {"owner": {"user_type": "does_not_exist", "display_name": "Akina"}, "edited": false, "score": 0, "creation_date": 1527081550, "post_id": 50510094, "comment_id": 88032185, "body": "Starting Access procedure from VBA (another database, Excel, Word, etc.) looks like <code>Dim app As Access.Application: Set app = CreateObject(&quot;Access.Application&quot;): app.OpenCurrentDatabase (strDatabaseFileName): app.Run strSubName: app.Quit acQuitSaveNone</code>. Maybe it help You."}, {"owner": {"user_type": "does_not_exist", "display_name": "pbdudley"}, "edited": false, "score": 0, "creation_date": 1527085718, "post_id": 50510094, "comment_id": 88032186, "body": "Ok For you&#39;re example replace Access.application with the correct referenced one? I see the correct one but I do not think Im setting it up           Option Compare Database &#39;Public Function Startup() ---commented this out as was used with the macro Dim app As esriArcMap: Set app = CreateObject(&quot;esriArcMap&quot;):   Dim strSql As String                   strSql = &quot; My SQL Query&quot;                           DoCmd.SetWarnings False         DoCmd.RunSQL strSql         DoCmd.SetWarnings False          End Function"}, {"owner": {"reputation": 205, "user_id": 3093192, "user_type": "registered", "profile_image": "https://graph.facebook.com/1428668068/picture?type=large", "display_name": "RDFozz", "link": "https://stackoverflow.com/users/3093192/rdfozz"}, "edited": false, "score": 0, "creation_date": 1527088685, "post_id": 50510094, "comment_id": 88032187, "body": "@Akina - Hmm - your comments look suspiciously like an answer :-)"}, {"owner": {"user_type": "does_not_exist", "display_name": "Akina"}, "reply_to_user": {"reputation": 205, "user_id": 3093192, "user_type": "registered", "profile_image": "https://graph.facebook.com/1428668068/picture?type=large", "display_name": "RDFozz", "link": "https://stackoverflow.com/users/3093192/rdfozz"}, "edited": false, "score": 0, "creation_date": 1527092908, "post_id": 50510094, "comment_id": 88032188, "body": "@RDFozz No. Answer is to solve the problem. If author decide comment do it, I&#39;ll convert."}, {"owner": {"user_type": "does_not_exist", "display_name": "Akina"}, "edited": false, "score": 0, "creation_date": 1527093048, "post_id": 50510094, "comment_id": 88032189, "body": "<i>For you&#39;re example replace Access.application with the correct referenced one?</i> It seems You want to execute Access code? If so You need to create Access Application object."}, {"owner": {"user_type": "does_not_exist", "display_name": "pbdudley"}, "edited": false, "score": 0, "creation_date": 1527096251, "post_id": 50510094, "comment_id": 88032190, "body": "ok, but if access is closed what will trigger it to open when I am in the esri map software, i need to place this in the CreateObject? I will test out different ways ans see"}, {"owner": {"user_type": "does_not_exist", "display_name": "pbdudley"}, "edited": false, "score": 0, "creation_date": 1527096531, "post_id": 50510094, "comment_id": 88032191, "body": "But yes I do want access to open when i am using the esri software. thank you Akina"}, {"owner": {"user_type": "does_not_exist", "display_name": "Akina"}, "edited": false, "score": 0, "creation_date": 1527098038, "post_id": 50510094, "comment_id": 88032192, "body": "<i>ok, but if access is closed what will trigger it to open when I am in the esri map software, i need to place this in the CreateObject?</i> CreateObject don&#39;t need in load user interface. But all modules nesessary to work with Access.Application will be loaded."}, {"owner": {"user_type": "does_not_exist", "display_name": "pbdudley"}, "edited": false, "score": 0, "creation_date": 1527103778, "post_id": 50510094, "comment_id": 88032193, "body": "Ok. Im doing it the way you described.  It  doesnt like this line app.OpenCurrentDatabase(C:\\test\\Open_Access.accdb)."}, {"owner": {"user_type": "does_not_exist", "display_name": "pbdudley"}, "edited": false, "score": 0, "creation_date": 1527103986, "post_id": 50510094, "comment_id": 88032194, "body": "Public Function Startup2()::Dim app As Access.Application::Set app = CreateObject(&quot;Access.Application&quot;)::app.OpenCurrentDatabase(&zwnj;&#8203;C:\\test\\Open_Access.&zwnj;&#8203;accdb):: app.Run:: I dont know what strSubName is::app.Run::app.Quit acQuitSaveNone"}, {"owner": {"user_type": "does_not_exist", "display_name": "pbdudley"}, "edited": false, "score": 0, "creation_date": 1527104299, "post_id": 50510094, "comment_id": 88032195, "body": "I thought this was it but it doesnt like this either app.OpenCurrentDatabase(C\\test\\Open_Access.accdb,[False],bst&zwnj;&#8203;rPassword As String])"}, {"owner": {"user_type": "does_not_exist", "display_name": "pbdudley"}, "edited": false, "score": 0, "creation_date": 1527109162, "post_id": 50510094, "comment_id": 88032196, "body": "Let us <a href=\"https://chat.stackexchange.com/rooms/77910/discussion-between-pbdudley-and-akina\">continue this discussion in chat</a>."}], "migrated_from": {"other_site": {"markdown_extensions": ["Prettify"], "launch_date": 1313521200, "open_beta_date": 1294686000, "closed_beta_date": 1294081200, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/dba/Img/apple-touch-icon@2.png", "twitter_account": "StackDBAs", "favicon_url": "https://cdn.sstatic.net/Sites/dba/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/dba/Img/apple-touch-icon.png", "audience": "database professionals who wish to improve their database skills and learn from others in the community", "site_url": "https://dba.stackexchange.com", "api_site_parameter": "dba", "logo_url": "https://cdn.sstatic.net/Sites/dba/Img/logo.png", "name": "Database Administrators", "site_type": "main_site"}, "on_date": 1527166693, "question_id": 207624}, "owner": {"user_type": "does_not_exist", "display_name": "pbdudley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527166693, "creation_date": 1527077743, "question_id": 50510094, "link": "https://stackoverflow.com/questions/50510094/running-ms-access-vb-module-from-arccatalog", "title": "Running MS Access VB Module from ArcCatalog", "body": "<p>I created some VBA code that runs a make table query in MS Access. Whenever the MS Access database is opened it automatically runs the SQL and updates the table.\nI then created a database connection in Arcatalog to the MS Access database where I can link to the MS Access .accdb file and add the table to ArcMap.</p>\n\n<p>When I have items linked in ArcMap with the db connection I get the .laccdb extension along with the .accdb extension. I was hoping that since arcatalog was linked to the access database that this would trigger the VBA code and re-run the code and update the linked table in ArcMap without having to go into the Access database each time.\nI noticed that in the VBA editor window I can click on some ESRI references.</p>\n\n<p>Is there any line of code that I can add that will make the access database run once it is initialized by ArcCatalog via the database connection that I have set up utilizing any of these ESRI references libraries that I see in MS Access?\nthanks</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9834288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e639c554653fe319d7f88231eee99cba?s=128&d=identicon&r=PG&f=1", "display_name": "VBA Newbie", "link": "https://stackoverflow.com/users/9834288/vba-newbie"}, "edited": false, "score": 0, "creation_date": 1527101559, "post_id": 50488469, "comment_id": 88003799, "body": "Hi John, Thank You so much for having a look at this."}, {"owner": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "reply_to_user": {"reputation": 11, "user_id": 9834288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e639c554653fe319d7f88231eee99cba?s=128&d=identicon&r=PG&f=1", "display_name": "VBA Newbie", "link": "https://stackoverflow.com/users/9834288/vba-newbie"}, "edited": false, "score": 0, "creation_date": 1527104605, "post_id": 50488469, "comment_id": 88005348, "body": "@VBANewbie, my pleasure and welcome to SO - Let me know if something catches you up, but I hope the code became a bit easier to understand once we removed a lot of the repetition. Also, if it does work, remember to mark it as a solution so others know this worked for you."}], "tags": [], "owner": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "is_accepted": false, "score": 0, "last_activity_date": 1527078611, "creation_date": 1527078611, "answer_id": 50488469, "question_id": 50488102, "link": "https://stackoverflow.com/questions/50488102/two-change-event-codes-needed-in-one-worksheet/50488469#50488469", "title": "Two change event codes needed in one worksheet", "body": "<p>Here is what the merged (and slightly cleaned-up) code would look like:</p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\n\nDim MergeWidth As Single\nDim cM As Range\nDim AutoFitRng As Range\nDim CWidth As Double\nDim NewRowHt As Double\n\n    ' Check once if we have more than one cell in the Target, if so, leave the sub:\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n\n    ' Changes related to Target = C13:\n    If Not Intersect(Target, Range(\"C13\")) Is Nothing Then\n        Range(\"C14\").ClearContents\n        Range(\"C15\").ClearContents\n        Range(\"C17\").ClearContents\n    End If\n\n    ' Changes related to Target = C14:\n    If Not Intersect(Target, Range(\"C14\")) Is Nothing Then\n        Range(\"C15\").ClearContents\n        Range(\"M14\").ClearContents\n    End If\n\n    ' Changes related to Target = C15:\n    If Not Intersect(Target, Range(\"C15\")) Is Nothing Then\n        Range(\"C17\").ClearContents\n    End If\n\n    ' Changes related to Target = Range named \"Note\":\n    If Not Intersect(Target, Range(\"Note\")) Is Nothing Then\n        Application.ScreenUpdating = False\n        On Error Resume Next\n        Set AutoFitRng = Range(Range(\"Note\").MergeArea.Address)\n        With AutoFitRng\n          .MergeCells = False\n          CWidth = .Cells(1).ColumnWidth\n          MergeWidth = 0\n          For Each cM In AutoFitRng\n              cM.WrapText = True\n              MergeWidth = cM.ColumnWidth + MergeWidth\n          Next\n          'small adjustment to temporary width\n          MergeWidth = MergeWidth + AutoFitRng.Cells.Count * 0.66\n          .Cells(1).ColumnWidth = MergeWidth\n          .EntireRow.AutoFit\n          NewRowHt = .RowHeight\n          .Cells(1).ColumnWidth = CWidth\n          .MergeCells = True\n          .RowHeight = NewRowHt\n        End With\n        Application.ScreenUpdating = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>As for the part you mentioned re:making the notes box hidden, I'm not sure what you did, but this is just the 2 methods conglomerated. If they worked well separately, they should work just as well in the code above.</p>\n\n<p>Also, just look at the changes I made to learn how / why they were possible - For example, you only need to check once if you have more than one cell in the target range since you'll leave the method at that point, so no need for checking more than that. Also, once you know which cell was affected, do all the changes related to that at once.</p>\n\n<p>Hope this helps you understand better... VBA is definitely worthwhile getting to understand.</p>\n"}], "owner": {"reputation": 11, "user_id": 9834288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e639c554653fe319d7f88231eee99cba?s=128&d=identicon&r=PG&f=1", "display_name": "VBA Newbie", "link": "https://stackoverflow.com/users/9834288/vba-newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527078611, "creation_date": 1527077513, "last_edit_date": 1531164843, "question_id": 50488102, "link": "https://stackoverflow.com/questions/50488102/two-change-event-codes-needed-in-one-worksheet", "title": "Two change event codes needed in one worksheet", "body": "<p>I need to run two change events codes (I found them on different websites) in one worksheet. I\u2019ve looked at a lot of examples and most seem to merge them in to one event. However I cannot work out how to do do that with mine (or even if I should).</p>\n\n<p>The first code is to clear dependant drop down menus:</p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Cells.Count &gt; 1 Then Exit Sub\n\nIf Not Intersect(Target, Range(\"C13\")) Is Nothing Then\nRange(\"C14\").ClearContents\nEnd If\n\nIf Target.Cells.Count &gt; 1 Then Exit Sub\n\nIf Not Intersect(Target, Range(\"C14\")) Is Nothing Then\nRange(\"C15\").ClearContents\nEnd If\n\nIf Target.Cells.Count &gt; 1 Then Exit Sub\n\nIf Not Intersect(Target, Range(\"C13\")) Is Nothing Then\nRange(\"C17\").ClearContents\nEnd If\n\nIf Target.Cells.Count &gt; 1 Then Exit Sub\n\nIf Not Intersect(Target, Range(\"C14\")) Is Nothing Then\nRange(\"M14\").ClearContents\nEnd If\nIf Target.Cells.Count &gt; 1 Then Exit Sub\n\nIf Not Intersect(Target, Range(\"C13\")) Is Nothing Then\nRange(\"C15\").ClearContents\nEnd If\n\nIf Target.Cells.Count &gt; 1 Then Exit Sub\n\nIf Not Intersect(Target, Range(\"C15\")) Is Nothing Then\nRange(\"C17\").ClearContents\nEnd If\n</code></pre>\n\n<p>The second code is to automatically enlarge a merged cell notes box on The worksheet:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim MergeWidth As Single\nDim cM As Range\nDim AutoFitRng As Range\nDim CWidth As Double\nDim NewRowHt As Double\nDim str01 As String\nstr01 = \"Note\"\nIf Not Intersect(Target, Range(str01)) Is Nothing Then\nApplication.ScreenUpdating = False\nOn Error Resume Next\nSet AutoFitRng = Range(Range(str01).MergeArea.Address)\nWith AutoFitRng\n  .MergeCells = False\n  CWidth = .Cells(1).ColumnWidth\n  MergeWidth = 0\n  For Each cM In AutoFitRng\n      cM.WrapText = True\n      MergeWidth = cM.ColumnWidth + MergeWidth\n  Next\n  'small adjustment to temporary width\nMergeWidth = MergeWidth + AutoFitRng.Cells.Count *      0.66\n  .Cells(1).ColumnWidth = MergeWidth\n  .EntireRow.AutoFit\n  NewRowHt = .RowHeight\n  .Cells(1).ColumnWidth = CWidth\n  .MergeCells = True\n  .RowHeight = NewRowHt\nEnd With\nApplication.ScreenUpdating = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Unfortunately, one of my attempts made the notes box on the worksheet hidden as well just because it didn\u2019t have anything entered in to it at the time, so i\u2019m not sure if the second code needs adjusting.</p>\n\n<p>Any help will be appreciated as I am completely new to VBA, and just struggling to complete something at work.</p>\n"}, {"tags": ["vba", "excel", "sorting"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1527077590, "creation_date": 1527077590, "answer_id": 50488123, "question_id": 50487973, "link": "https://stackoverflow.com/questions/50487973/how-to-sort-an-excel-sheet-by-two-different-columns/50488123#50488123", "title": "How to sort an Excel sheet by two different columns", "body": "<ol>\n<li>Record a macro;</li>\n<li>Select the table;</li>\n<li>In the ribbon - Data > Sort;</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/nybbZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nybbZ.png\" alt=\"enter image description here\"></a></p>\n\n<ol start=\"4\">\n<li>Select the first column that you want to sort;</li>\n<li>Press <kbd>Add Level</kbd>;</li>\n<li>Select the second column that you want to sort;</li>\n<li>See the generated code;;</li>\n<li>Refactor it, avoinding <code>Select</code>, <code>Activate</code> and putting the string variables;</li>\n</ol>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-sort-method-excel\" rel=\"nofollow noreferrer\">Range.Sort Method MSDN</a></p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 7792020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf33b1613ccd8d12a7dc8fc9bf937966?s=128&d=identicon&r=PG", "display_name": "os23", "link": "https://stackoverflow.com/users/7792020/os23"}, "edited": false, "score": 0, "creation_date": 1527083145, "post_id": 50488212, "comment_id": 87992973, "body": "Thanks @Ricards but this code only sorts the 2nd column. The first step is somehow overruled."}, {"owner": {"reputation": 385, "user_id": 9564026, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ricards Porins", "link": "https://stackoverflow.com/users/9564026/ricards-porins"}, "reply_to_user": {"reputation": 45, "user_id": 7792020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf33b1613ccd8d12a7dc8fc9bf937966?s=128&d=identicon&r=PG", "display_name": "os23", "link": "https://stackoverflow.com/users/7792020/os23"}, "edited": false, "score": 0, "creation_date": 1527112065, "post_id": 50488212, "comment_id": 88008777, "body": "I did a test, sorted both columns, so the column A was sorted after column B, but B remained sub sorted to A. definitely worked for me..."}], "tags": [], "owner": {"reputation": 385, "user_id": 9564026, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ricards Porins", "link": "https://stackoverflow.com/users/9564026/ricards-porins"}, "is_accepted": true, "score": 1, "last_activity_date": 1527077860, "creation_date": 1527077860, "answer_id": 50488212, "question_id": 50487973, "link": "https://stackoverflow.com/questions/50487973/how-to-sort-an-excel-sheet-by-two-different-columns/50488212#50488212", "title": "How to sort an Excel sheet by two different columns", "body": "<p>The simplest method is to sort Column B and then sort Column A, this will achieve your desired effect.\nUse the same method you used, but sort first column b then column a.</p>\n\n<p>If I modify your code it would look as follows</p>\n\n<pre><code>Sub sort()\nDim SortClmn As String\nDim Area As String\nArea = \"A1:B10\"\nSortClmn = \"B\"\nActiveSheet.Range(Area).sort _\nKey1:=Range(SortClmn &amp; \"1\"), Order1:=xlAscending, _\nHeader:=xlGuess, MatchCase:=False, _\nOrientation:=xlTopToBottom\nArea = \"A1:B10\"\nSortClmn = \"A\"\nActiveSheet.Range(Area).sort _\nKey1:=Range(SortClmn &amp; \"1\"), Order1:=xlAscending, _\nHeader:=xlGuess, MatchCase:=False, _\nOrientation:=xlTopToBottom\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 137, "user_id": 6906214, "user_type": "registered", "profile_image": "https://graph.facebook.com/1202325113158719/picture?type=large", "display_name": "Radek Piekn&#253;", "link": "https://stackoverflow.com/users/6906214/radek-piekn%c3%bd"}, "is_accepted": false, "score": 0, "last_activity_date": 1527077972, "creation_date": 1527077972, "answer_id": 50488252, "question_id": 50487973, "link": "https://stackoverflow.com/questions/50487973/how-to-sort-an-excel-sheet-by-two-different-columns/50488252#50488252", "title": "How to sort an Excel sheet by two different columns", "body": "<pre><code>Sub sort()\n    lastRow = ActiveWorkbook.ActiveSheet.Cells(Rows.Count, 2).End(xlUp).Row\n    With ActiveWorkbook.ActiveSheet.sort\n     .SortFields.Clear\n     .SortFields.Add Key:=Range(\"A1:A\" &amp; lastRow), Order:=xlAscending\n     .SortFields.Add Key:=Range(\"B1:B\" &amp; lastRow), Order:=xlAscending\n     .SetRange Range(\"A2:B\" &amp; lastRow)\n     .Header = xlNo\n     .Apply\n    End With\nEnd Sub\n</code></pre>\n\n<p>Something like this?</p>\n"}], "owner": {"reputation": 45, "user_id": 7792020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf33b1613ccd8d12a7dc8fc9bf937966?s=128&d=identicon&r=PG", "display_name": "os23", "link": "https://stackoverflow.com/users/7792020/os23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 50488212, "answer_count": 3, "score": 0, "last_activity_date": 1527143731, "creation_date": 1527077104, "last_edit_date": 1527077356, "question_id": 50487973, "link": "https://stackoverflow.com/questions/50487973/how-to-sort-an-excel-sheet-by-two-different-columns", "title": "How to sort an Excel sheet by two different columns", "body": "<p>Let's assume a chart with only values in the first two columns A and B like this </p>\n\n<p><a href=\"https://i.stack.imgur.com/dP2tw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dP2tw.png\" alt=\"enter image description here\"></a> </p>\n\n<p>First I'd like to sort the chart alphabetically by column A, i.e. the Xs at top, then the Ys and the Zs. </p>\n\n<p>The 2nd move should be a sorting of column B considering column A, i.e. keeping the block of Xs and sort their numbers in column B. The same with the blocks of Y and Z. </p>\n\n<p>The 1st step works fine with the following code:</p>\n\n<pre><code>Sub sort()\nDim SortClmn As String\nDim Area As String\nArea= \"A1:B10\"\nSortClmn = \"A\"\nActiveSheet.Range(Area).Sort _\nKey1:=Range(SortClmn &amp; \"1\"), Order1:=xlDescending, _\nHeader:=xlGuess, MatchCase:=False, _\nOrientation:=xlTopToBottom\nEnd Sub\n</code></pre>\n\n<p>How do I need to change this code to apply the 2nd step?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel", "path", "save"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1527077018, "post_id": 50487896, "comment_id": 87988575, "body": "Do you want to save a specific sheet or the workbook to a directory?"}, {"owner": {"reputation": 89, "user_id": 9771985, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RATNx_cZj94/AAAAAAAAAAI/AAAAAAAAAIk/m8nZ46xi8Jk/photo.jpg?sz=128", "display_name": "user1234", "link": "https://stackoverflow.com/users/9771985/user1234"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1527077077, "post_id": 50487896, "comment_id": 87988616, "body": "I extracted a sheet from the workbook and created a new workbook, so i guess i want to save the new workbook"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1527077379, "post_id": 50487896, "comment_id": 87988824, "body": "You cannot use <code>ChDir</code> with UNC (network) paths."}], "answers": [{"tags": [], "owner": {"reputation": 1632, "user_id": 6072648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qJ2RW.jpg?s=128&g=1", "display_name": "Kerry Jackson", "link": "https://stackoverflow.com/users/6072648/kerry-jackson"}, "is_accepted": true, "score": 2, "last_activity_date": 1527077195, "creation_date": 1527077195, "answer_id": 50487990, "question_id": 50487896, "link": "https://stackoverflow.com/questions/50487896/excel-vba-doesnt-follow-save-path-and-saves-in-my-documents/50487990#50487990", "title": "excel vba doesnt follow save path and saves in my documents", "body": "<p>Just specify the full path in the Filename argument for the SaveAs</p>\n\n<pre><code>Sheets(\"Sheet1\").Select\nSheets(\"Sheet1\").Copy\nActiveWorkbook.SaveAs Filename:= _\n    \"C:\\Users\\SI\\Desktop\\Generator\\\" &amp; Range(\"B4\").Value &amp; \" TRS - \" &amp; Range(\"E6\").Value &amp; \" vs \" _\n    &amp; Range(\"E7\").Value &amp; \" - \" &amp; Format(Date, \"dd-mm-yyyy\"), FileFormat:= _\n    xlOpenXMLWorkbook, CreateBackup:=False\nActiveWindow.Close\nSheets(\"ST\").Select\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 9771985, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RATNx_cZj94/AAAAAAAAAAI/AAAAAAAAAIk/m8nZ46xi8Jk/photo.jpg?sz=128", "display_name": "user1234", "link": "https://stackoverflow.com/users/9771985/user1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "accepted_answer_id": 50487990, "answer_count": 1, "score": 0, "last_activity_date": 1527077195, "creation_date": 1527076823, "last_edit_date": 1527077098, "question_id": 50487896, "link": "https://stackoverflow.com/questions/50487896/excel-vba-doesnt-follow-save-path-and-saves-in-my-documents", "title": "excel vba doesnt follow save path and saves in my documents", "body": "<p>I am quite new to vba. I wrote a piece of code to save an excel workbook. the original save path works and the file gets saved there, but when i try to change it (to a shared directory) it doesn't listen.Instead, it just saves in My Documents. Below is the code that works.</p>\n\n<p>Any help would be appreciated </p>\n\n<pre><code>Sheets(\"Sheet1\").Select\nSheets(\"Sheet1\").Copy\nChDir \"C:\\Users\\SI\\Desktop\\Generator\"\nActiveWorkbook.SaveAs Filename:= _\n    Range(\"B4\").Value &amp; \" TRS - \" &amp; Range(\"E6\").Value &amp; \" vs \" _\n    &amp; Range(\"E7\").Value &amp; \" - \" &amp; Format(Date, \"dd-mm-yyyy\"), FileFormat:= _\n    xlOpenXMLWorkbook, CreateBackup:=False\nActiveWindow.Close\nSheets(\"ST\").Select\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy", "paste"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1527076692, "post_id": 50487753, "comment_id": 87988335, "body": "Have you thought/researched about it yourself?"}, {"owner": {"reputation": 13, "user_id": 6762197, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BSz2yv_sT4E/AAAAAAAAAAI/AAAAAAAAAsA/WtuI8W08Vco/photo.jpg?sz=128", "display_name": "Pallam Raju", "link": "https://stackoverflow.com/users/6762197/pallam-raju"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1527078294, "post_id": 50487753, "comment_id": 87989451, "body": "yes, i dont know macro excel so please help me"}], "owner": {"reputation": 13, "user_id": 6762197, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BSz2yv_sT4E/AAAAAAAAAAI/AAAAAAAAAsA/WtuI8W08Vco/photo.jpg?sz=128", "display_name": "Pallam Raju", "link": "https://stackoverflow.com/users/6762197/pallam-raju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 537, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527091205, "creation_date": 1527076426, "last_edit_date": 1527091205, "question_id": 50487753, "link": "https://stackoverflow.com/questions/50487753/in-excel-macro-how-to-assign-negative-sign-when-copy-paste-function", "title": "In Excel macro how to assign negative sign when copy paste function", "body": "<p>In Excel macro how to assign negative sign when copy paste function , how to assign the negative sign for debit column when copy paste function</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1632, "user_id": 6072648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qJ2RW.jpg?s=128&g=1", "display_name": "Kerry Jackson", "link": "https://stackoverflow.com/users/6072648/kerry-jackson"}, "edited": false, "score": 0, "creation_date": 1527077539, "post_id": 50487760, "comment_id": 87988939, "body": "To refer to parts of a table using VBA, see the website: <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">thespreadsheetguru.com/blog/2014/6/20/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 9834172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5d383a0f5778600fa3636f30288e8ab?s=128&d=identicon&r=PG&f=1", "display_name": "Mitch Millership", "link": "https://stackoverflow.com/users/9834172/mitch-millership"}, "edited": false, "score": 0, "creation_date": 1527078009, "post_id": 50487760, "comment_id": 87989243, "body": "Thanks, this greatly improves my understanding of certain coding within VBA,  However this seems to have the same problem where everytime the macro is ran, it will always affect the same cell no matter what is selected, similar to if  you were to put (C1) in VBA, Rather than:   Table1[[#Headers],[Column3]]"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1527076460, "creation_date": 1527076460, "answer_id": 50487760, "question_id": 50487680, "link": "https://stackoverflow.com/questions/50487680/refering-to-table-cell-in-macro/50487760#50487760", "title": "Refering to Table cell in Macro", "body": "<p>Whenever you have a question, concerning the translation of a manual action in Excel to VBA the best answer is: </p>\n\n<p><em>Start the macro recorder, do the manual action and check yourself.</em></p>\n\n<p>This is a sample of a recorded macro, selecting <code>Table1</code>, <code>Column3</code>:</p>\n\n<pre><code>Sub Macro1()\n    Range(\"Table1[[#Headers],[Column3]]\").Select\n    ActiveCell.FormulaR1C1 = \"Testing\"\n    Range(\"C2\").Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9834172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5d383a0f5778600fa3636f30288e8ab?s=128&d=identicon&r=PG&f=1", "display_name": "Mitch Millership", "link": "https://stackoverflow.com/users/9834172/mitch-millership"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527076460, "creation_date": 1527076194, "last_edit_date": 1592644375, "question_id": 50487680, "link": "https://stackoverflow.com/questions/50487680/refering-to-table-cell-in-macro", "title": "Refering to Table cell in Macro", "body": "<p><em><strong>So, I am relatively new to VBA and Programming as a whole,</strong></em></p>\n<p>I know in Excel Formulae, Rather than refer directly to a Cell <strong>($B$27</strong>) you can refer to the Column name instead, <strong>(@[Condition]).</strong></p>\n<p>Now I am aware that this only works on &quot;linear&quot; tables, the formulae will only work on and affect the row its in, but for the table i am working on this is fine.</p>\n<p><em><strong>My question is, is there a way to refer to this inside VBA?</strong></em></p>\n<p>I am trying to create a function that takes the value of a &quot;Condition&quot; Cell and if this is &quot;Other&quot; it will open a custom User form with 3 buttons that allow the user to select the reason why the Condition is &quot;other&quot;</p>\n<p>Depending on the button click, the Value of another Cell in the same table (Works Completed) will be changed to what ever the reason they click.</p>\n<p>(E.G, user clicks &quot;To be Repaired&quot;,  the value of &quot;Works Complete&quot;  will be changed to &quot;For Repairs&quot;</p>\n<p>This currently only works when referred to a Cell directly ($B$27)</p>\n"}, {"tags": ["r", "vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1527076293, "post_id": 50487638, "comment_id": 87988045, "body": "<code>vLookup</code> doesn&#39;t need equality if your data is sorted and you set the 4th parameter to <code>True</code>"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1527076425, "post_id": 50487638, "comment_id": 87988129, "body": "Please, define &quot;nearest value&quot;..."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1527076524, "post_id": 50487638, "comment_id": 87988201, "body": "Seems like you can just join the two and sort it alfabetically?"}, {"owner": {"reputation": 11, "user_id": 9534775, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "data maths", "link": "https://stackoverflow.com/users/9534775/data-maths"}, "edited": false, "score": 0, "creation_date": 1527077207, "post_id": 50487638, "comment_id": 87988717, "body": "nearest value means like if I have 01/01/2016 22:18 and i need to join that row with the appropriate one from the 1st excel file i would choose 01/01/2016 22:20"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1527077981, "post_id": 50487638, "comment_id": 87989214, "body": "What about <code>01&#47;01&#47;2016 22:10</code> and <code>01&#47;01&#47;2016 22:13</code>? The nearest value is <code>01&#47;01&#47;2016 22:10</code> for both?"}, {"owner": {"reputation": 11, "user_id": 9534775, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "data maths", "link": "https://stackoverflow.com/users/9534775/data-maths"}, "edited": false, "score": 0, "creation_date": 1527078267, "post_id": 50487638, "comment_id": 87989432, "body": "Yes Marciej Los."}, {"owner": {"reputation": 73863, "user_id": 3358272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gteVQ.jpg?s=128&g=1", "display_name": "r2evans", "link": "https://stackoverflow.com/users/3358272/r2evans"}, "edited": false, "score": 0, "creation_date": 1527924360, "post_id": 50487638, "comment_id": 88319231, "body": "data maths, do any of the answers work for you? If so, please accept one. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 1, "last_activity_date": 1527076765, "creation_date": 1527076765, "answer_id": 50487872, "question_id": 50487638, "link": "https://stackoverflow.com/questions/50487638/join-excel-files-based-on-an-non-equal-time-variable/50487872#50487872", "title": "Join excel files based on an non-equal time variable", "body": "<p>If your longer list is in column A and your shorter list is in column B (assuming no headers etc.), then the following formula would VLOOKUP the nearest lower value:</p>\n\n<pre><code>=VLOOKUP(B1,A:A,1,1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73863, "user_id": 3358272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gteVQ.jpg?s=128&g=1", "display_name": "r2evans", "link": "https://stackoverflow.com/users/3358272/r2evans"}, "is_accepted": false, "score": 0, "last_activity_date": 1527080823, "creation_date": 1527080823, "answer_id": 50489255, "question_id": 50487638, "link": "https://stackoverflow.com/questions/50487638/join-excel-files-based-on-an-non-equal-time-variable/50489255#50489255", "title": "Join excel files based on an non-equal time variable", "body": "<p>An R solution. All <code>merge</code> (and <code>dplyr::*_join</code>) operators work on equality, so your first problem is converting your first vector to the closest in the second. The <code>findInterval</code> function is similar to the <code>VLOOKUP</code> function in Excel:</p>\n\n<pre><code>findInterval(v1df$v1, v2df$v2)\n#  [1] 0 1 1 1 1 1 2 2 2 2\n</code></pre>\n\n<p>This shows two artifacts:</p>\n\n<ol>\n<li>The first value has an index of <code>0</code>, indicating that it is before the first value in <code>v2</code> (your second vector).</li>\n<li>This doesn't provide the <em>closest</em>, it is the highest without going over.</li>\n</ol>\n\n<p>We can shift <code>v2</code> to accommodate. </p>\n\n<pre><code>d &lt;- diff(v2df$v2)\nunits(d) &lt;- \"secs\"\nv2df$v2shift &lt;- v2df$v2 - c(d[1], d)/2\nv2df\n#                    v2             v2shift\n# 1 2016-01-01 05:07:00 2016-01-01 04:05:30\n# 2 2016-01-01 07:10:00 2016-01-01 06:08:30\n# 3 2016-01-01 08:19:00 2016-01-01 07:44:30\n</code></pre>\n\n<p>Now the interval works:</p>\n\n<pre><code>findInterval(v1df$v1, v2df$v2shift)\n#  [1] 1 1 1 2 2 2 2 2 3 3\n</code></pre>\n\n<p>Now we add that to the first data:</p>\n\n<pre><code>v1df$closest &lt;- v2df$v2[findInterval(v1df$v1, v2df$v2shift)]\nv1df\n#                     v1             closest\n# 1  2016-01-01 05:00:00 2016-01-01 05:07:00\n# 2  2016-01-01 05:10:00 2016-01-01 05:07:00\n# 3  2016-01-01 05:20:00 2016-01-01 05:07:00\n# 4  2016-01-01 06:40:00 2016-01-01 07:10:00\n# 5  2016-01-01 06:50:00 2016-01-01 07:10:00\n# 6  2016-01-01 07:00:00 2016-01-01 07:10:00\n# 7  2016-01-01 07:10:00 2016-01-01 07:10:00\n# 8  2016-01-01 07:20:00 2016-01-01 07:10:00\n# 9  2016-01-01 08:00:00 2016-01-01 08:19:00\n# 10 2016-01-01 08:10:00 2016-01-01 08:19:00\n</code></pre>\n\n<p>and merge:</p>\n\n<pre><code>merge(v2df[\"v2\"], v1df, by.x=\"v2\", by.y=\"closest\")\n#                     v2                  v1\n# 1  2016-01-01 05:07:00 2016-01-01 05:00:00\n# 2  2016-01-01 05:07:00 2016-01-01 05:10:00\n# 3  2016-01-01 05:07:00 2016-01-01 05:20:00\n# 4  2016-01-01 07:10:00 2016-01-01 06:40:00\n# 5  2016-01-01 07:10:00 2016-01-01 06:50:00\n# 6  2016-01-01 07:10:00 2016-01-01 07:00:00\n# 7  2016-01-01 07:10:00 2016-01-01 07:10:00\n# 8  2016-01-01 07:10:00 2016-01-01 07:20:00\n# 9  2016-01-01 08:19:00 2016-01-01 08:00:00\n# 10 2016-01-01 08:19:00 2016-01-01 08:10:00\n</code></pre>\n\n<p>Similarly</p>\n\n<pre><code>dplyr::full_join(v2df[\"v2\"], v1df, by=c(\"v2\"=\"closest\"))\n</code></pre>\n\n<hr>\n\n<p>Data:</p>\n\n<pre><code>v1 &lt;- as.POSIXct(c(\n  '01/01/2016 05:00',\n  '01/01/2016 05:10',\n  '01/01/2016 05:20',\n  '01/01/2016 06:40',\n  '01/01/2016 06:50',\n  '01/01/2016 07:00',\n  '01/01/2016 07:10',\n  '01/01/2016 07:20',\n  '01/01/2016 08:00',\n  '01/01/2016 08:10'), format='%m/%d/%Y %H:%M')\n\nv2 &lt;- as.POSIXct(c(\n  '01/01/2016 05:07',\n  '01/01/2016 07:10',\n  '01/01/2016 08:19'), format='%m/%d/%Y %H:%M')\n\nv1df &lt;- data.frame(v1 = v1)\nv2df &lt;- data.frame(v2 = v2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": false, "score": 0, "last_activity_date": 1527083170, "creation_date": 1527083170, "answer_id": 50490058, "question_id": 50487638, "link": "https://stackoverflow.com/questions/50487638/join-excel-files-based-on-an-non-equal-time-variable/50490058#50490058", "title": "Join excel files based on an non-equal time variable", "body": "<p>Assuming that a string like <code>01/01/2016 08:00</code> is valid date in your system, you can use VBA solution within ADODB:</p>\n\n<pre><code>'needs reference to MS ActiveX Data Object Library x.x reference\n'menu: Tools-&gt;References... in VBA Code Pane\n\nSub GetDataByNearestDates()\n    Dim sSQL As String, sConn As String\n    Dim oConn As ADODB.Connection\n    Dim oRst As ADODB.Recordset\n\n    On Error GoTo Err_GetDataByNearestDates\n\n    sSQL = \"SELECT t1.A, t2.B, t1.A - t2.B\" &amp; vbCr\n    sSQL = sSQL &amp; \"FROM (\" &amp; vbCr\n    sSQL = sSQL &amp; \"SELECT [F1] AS A FROM [Sheet1$]\" &amp; vbCr\n    sSQL = sSQL &amp; \") AS t1\" &amp; vbCr\n    sSQL = sSQL &amp; \", (\" &amp; vbCr\n    sSQL = sSQL &amp; \"SELECT [F1] AS B FROM [Sheet2$]\" &amp; vbCr\n    sSQL = sSQL &amp; \") AS t2\" &amp; vbCr\n    sSQL = sSQL &amp; \"WHERE ((t1.A-t2.B &gt;-0.004) AND (t1.A-t2.B &lt;=0.004));\" &amp; vbCr\n\n    'if you use column-headers, change HDR=NO to HDR=YES\n    sConn = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; ThisWorkbook.FullName &amp; \";Extended Properties='Excel 12.0 Macro;HDR=NO';\"\n\n    Set oConn = New ADODB.Connection\n    With oConn\n        .ConnectionString = sConn\n        .Open\n        Set oRst = oConn.Execute(sSQL)\n    End With\n\n    ThisWorkbook.Worksheets(3).Cells.Clear\n    ThisWorkbook.Worksheets(3).Range(\"A1\").CopyFromRecordset oRst\n\nExit_GetDataByNearestDates:\n    On Error Resume Next\n    If Not oRst Is Nothing Then oRst.Close: Set oRst = Nothing\n    If Not oConn Is Nothing Then oConn.Close: Set oConn = Nothing\n    Exit Sub\n\nErr_GetDataByNearestDates:\n    MsgBox Err.Description, vbExclamation, Err.Number\n    Resume Exit_GetDataByNearestDates\n\nEnd Sub\n</code></pre>\n\n<p>Above code produces a result set of 'nearest values' in Sheet3</p>\n\n<p>To be able to use above code, you'll need:</p>\n\n<ol>\n<li>create an empty Excel file (with 3 worksheets)</li>\n<li>copy data from workbook1 into <code>Sheet1</code></li>\n<li>copy data from workbook2 into <code>Sheet2</code></li>\n<li>go to VBA Code Pane (<code>ALT</code>+<code>F11</code>)</li>\n<li>insert new module (menu <code>Insert-&gt;Module</code>)</li>\n<li>paste above code into it</li>\n<li>and... save file as *.xlsm file</li>\n</ol>\n\n<p>To run code move cursor into the body of <code>GetDataByNearestDates</code> procedure and hit <code>F5</code>. The result set should looks like</p>\n\n<pre><code>2016-01-01 05:10    2016-01-01 05:07\n2016-01-01 07:10    2016-01-01 07:10\n2016-01-01 08:20    2016-01-01 08:19\n2016-01-01 08:30    2016-01-01 08:27\n2016-01-01 09:20    2016-01-01 09:18\n2016-01-01 10:10    2016-01-01 10:13\n2016-01-01 10:20    2016-01-01 10:23\n2016-01-01 10:30    2016-01-01 10:30\n2016-01-01 11:00    2016-01-01 10:57\n2016-01-01 12:20    2016-01-01 12:20\n2016-01-01 14:50    2016-01-01 14:50\n2016-01-01 14:50    2016-01-01 14:54\n2016-01-01 15:00    2016-01-01 15:00\n2016-01-01 15:20    2016-01-01 15:20\n2016-01-01 16:10    2016-01-01 16:12\n2016-01-01 18:30    2016-01-01 18:26\n2016-01-01 19:10    2016-01-01 19:08\n2016-01-01 20:00    2016-01-01 20:00\n2016-01-01 21:10    2016-01-01 21:15\n2016-01-01 21:20    2016-01-01 21:15\n2016-01-01 21:20    2016-01-01 21:20\n2016-01-01 22:10    2016-01-01 22:10\n2016-01-01 22:10    2016-01-01 22:13\n2016-01-01 22:20    2016-01-01 22:18\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9534775, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "data maths", "link": "https://stackoverflow.com/users/9534775/data-maths"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1527083170, "creation_date": 1527076079, "question_id": 50487638, "link": "https://stackoverflow.com/questions/50487638/join-excel-files-based-on-an-non-equal-time-variable", "title": "Join excel files based on an non-equal time variable", "body": "<p>I need to join 2 excel files</p>\n\n<p>the 1st one contine this column:</p>\n\n<pre><code>01/01/2016 00:00\n01/01/2016 00:10\n01/01/2016 00:20\n01/01/2016 00:30\n01/01/2016 00:40\n01/01/2016 00:50\n01/01/2016 01:00\n01/01/2016 01:10\n01/01/2016 01:20\n01/01/2016 01:30\n01/01/2016 01:40\n01/01/2016 01:50\n01/01/2016 02:00\n01/01/2016 02:10\n01/01/2016 02:20\n01/01/2016 02:30\n01/01/2016 02:40\n01/01/2016 02:50\n01/01/2016 03:00\n01/01/2016 03:10\n01/01/2016 03:20\n01/01/2016 03:30\n01/01/2016 03:40\n01/01/2016 03:50\n01/01/2016 04:00\n01/01/2016 04:10\n01/01/2016 04:20\n01/01/2016 04:30\n01/01/2016 04:40\n01/01/2016 04:50\n01/01/2016 05:00\n01/01/2016 05:10\n01/01/2016 05:20\n01/01/2016 05:30\n01/01/2016 05:40\n01/01/2016 05:50\n01/01/2016 06:00\n01/01/2016 06:10\n01/01/2016 06:20\n01/01/2016 06:30\n01/01/2016 06:40\n01/01/2016 06:50\n01/01/2016 07:00\n01/01/2016 07:10\n01/01/2016 07:20\n01/01/2016 07:30\n01/01/2016 07:40\n01/01/2016 07:50\n01/01/2016 08:00\n01/01/2016 08:10\n01/01/2016 08:20\n01/01/2016 08:30\n01/01/2016 08:40\n01/01/2016 08:50\n01/01/2016 09:00\n01/01/2016 09:10\n01/01/2016 09:20\n01/01/2016 09:30\n01/01/2016 09:40\n01/01/2016 09:50\n01/01/2016 10:00\n01/01/2016 10:10\n01/01/2016 10:20\n01/01/2016 10:30\n01/01/2016 10:40\n01/01/2016 10:50\n01/01/2016 11:00\n01/01/2016 11:10\n01/01/2016 11:20\n01/01/2016 11:30\n01/01/2016 11:40\n01/01/2016 11:50\n01/01/2016 12:00\n01/01/2016 12:10\n01/01/2016 12:20\n01/01/2016 12:30\n01/01/2016 12:40\n01/01/2016 12:50\n01/01/2016 13:00\n01/01/2016 13:10\n01/01/2016 13:20\n01/01/2016 13:30\n01/01/2016 13:40\n01/01/2016 13:50\n01/01/2016 14:00\n01/01/2016 14:10\n01/01/2016 14:20\n01/01/2016 14:30\n01/01/2016 14:40\n01/01/2016 14:50\n01/01/2016 15:00\n01/01/2016 15:10\n01/01/2016 15:20\n01/01/2016 15:30\n01/01/2016 15:40\n01/01/2016 15:50\n01/01/2016 16:00\n01/01/2016 16:10\n01/01/2016 16:20\n01/01/2016 16:30\n01/01/2016 16:40\n01/01/2016 16:50\n01/01/2016 17:00\n01/01/2016 17:10\n01/01/2016 17:20\n01/01/2016 17:30\n01/01/2016 17:40\n01/01/2016 17:50\n01/01/2016 18:00\n01/01/2016 18:10\n01/01/2016 18:20\n01/01/2016 18:30\n01/01/2016 18:40\n01/01/2016 18:50\n01/01/2016 19:00\n01/01/2016 19:10\n01/01/2016 19:20\n01/01/2016 19:30\n01/01/2016 19:40\n01/01/2016 19:50\n01/01/2016 20:00\n01/01/2016 20:10\n01/01/2016 20:20\n01/01/2016 20:30\n01/01/2016 20:40\n01/01/2016 20:50\n01/01/2016 21:00\n01/01/2016 21:10\n01/01/2016 21:20\n01/01/2016 21:30\n01/01/2016 21:40\n01/01/2016 21:50\n01/01/2016 22:00\n01/01/2016 22:10\n01/01/2016 22:20\n01/01/2016 22:30\n01/01/2016 22:40\n01/01/2016 22:50\n01/01/2016 23:00\n01/01/2016 23:10\n01/01/2016 23:20\n01/01/2016 23:30\n01/01/2016 23:40\n01/01/2016 23:50\n</code></pre>\n\n<p>and for the second one :</p>\n\n<pre><code>01/01/2016 05:07\n01/01/2016 07:10\n01/01/2016 08:19\n01/01/2016 08:27\n01/01/2016 09:18\n01/01/2016 10:13\n01/01/2016 10:23\n01/01/2016 10:30\n01/01/2016 10:57\n01/01/2016 12:20\n01/01/2016 14:50\n01/01/2016 14:54\n01/01/2016 15:00\n01/01/2016 15:20\n01/01/2016 16:12\n01/01/2016 18:26\n01/01/2016 19:08\n01/01/2016 20:00\n01/01/2016 21:15\n01/01/2016 21:20\n01/01/2016 22:10\n01/01/2016 22:13\n01/01/2016 22:18\n</code></pre>\n\n<p>and i need to do the join btw them based on the nearest value from the 1st excel file to the 2nd.</p>\n\n<p>I've tried vlookup and power query but they assume equality between column's values.</p>\n\n<p>I really need your help.</p>\n\n<p>Thank you so much.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 5, "creation_date": 1527075359, "post_id": 50487376, "comment_id": 87987427, "body": "Could you please format your post properly."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1527081345, "post_id": 50487376, "comment_id": 87991655, "body": "What do you mean by <i>reference it to an excel file</i>?  If you dump the code into a module within an Excel file it will reference whichever Excel file is active when the code runs.  <code>Range([a1], Cells(Rows.Count, &quot;b&quot;).End(xlUp))</code> always references the active sheet in the active workbook as you haven&#39;t specified a specific sheet/file."}], "answers": [{"tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": false, "score": 0, "last_activity_date": 1527075840, "creation_date": 1527075840, "answer_id": 50487566, "question_id": 50487376, "link": "https://stackoverflow.com/questions/50487376/assigning-an-excel-file-to-the-script-so-i-can-run-the-code-below/50487566#50487566", "title": "Assigning an excel file to the script so I can run the code below", "body": "<p>Open the workbook, store it as a variable and work against that variable.</p>\n\n<pre><code>Sub OpenWorkbookFileAndRunAgainstThat()\nDim wb as Workbook\nSet wb = Workbooks.Open(\"C:\\SI\\workbook.xlsx\")\n\nWith wb\n    .Worksheets(\"yourSheet\").Range(\"A1\").value = \"something\" 'This is instead of Range in the sample above.\nEnd with\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9834144, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "VBScript_aficianado", "link": "https://stackoverflow.com/users/9834144/vbscript-aficianado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1527079691, "creation_date": 1527075261, "last_edit_date": 1527079691, "question_id": 50487376, "link": "https://stackoverflow.com/questions/50487376/assigning-an-excel-file-to-the-script-so-i-can-run-the-code-below", "title": "Assigning an excel file to the script so I can run the code below", "body": "<p>I have a similar scenario to the one below </p>\n\n<pre><code>Sub SliceNDice() \nDim objRegex As Object \nDim X \nDim Y \nDim lngRow As Long \nDim lngCnt As Long \nDim tempArr() As String \nDim strArr \n\nSet objRegex = CreateObject(\"vbscript.regexp\") \nobjRegex.Pattern = \"^\\s+(.+?)$\" \n'Define the range to be analysed\nX = Range([a1], Cells(Rows.Count, \"b\").End(xlUp)).Value2 \nRedim Y(1 To 2, 1 To 1000) \nFor lngRow = 1 To UBound(X, 1) \n'Split each string by \",\"\n   tempArr = Split(X(lngRow, 2), \",\") \nFor Each strArr In tempArr \n      lngCnt = lngCnt + 1 \n     'Add another 1000 records to resorted array every 1000 records\n      If lngCnt Mod 1000 = 0 Then Redim Preserve Y(1 To 2, 1 To lngCnt + 1000) \n           Y(1, lngCnt) = X(lngRow, 1) \n           Y(2, lngCnt) = objRegex.Replace(strArr, \"$1\") \n     Next \nNext lngRow\n'Dump the re-ordered range to columns C:D\n[c1].Resize(lngCnt, 2).Value2 = Application.Transpose(Y) \n\nEnd Sub \n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/18MuV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/18MuV.png\" alt=\"https://i.stack.imgur.com/18MuV.png\"></a></p>\n\n<p>But in order to implement the code above -- I need to reference it to an excel file . How do I do that ? For instance , my file is stored in the location C:\\SI .how do I reference it so that I can use the code above to work on that file. Thanks in anticipation.</p>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 21, "user_id": 9062664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af67b6b4be143cdc126b1fd1efd03a62?s=128&d=identicon&r=PG&f=1", "display_name": "a.rathi", "link": "https://stackoverflow.com/users/9062664/a-rathi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1527079819, "creation_date": 1527074418, "last_edit_date": 1531164843, "question_id": 50487084, "link": "https://stackoverflow.com/questions/50487084/dividing-a-cell-number-after-finding-the-other-cell-number-based-on-a-criteria", "title": "Dividing a cell number after finding the other cell number based on a criteria", "body": "<p>I am having a <code>2000x20</code> excel file. Each cell in column B has a 6 digit number. I am interested in dividing cell value M when I have  <code>502000</code> in column B with cell value with column B <code>501000</code>. The rest of the row is same from A to H except B. </p>\n\n<p>Right now I am using two for loops which takes 100sec to finish. I am looking for an efficient idea. Thanks in advance :)</p>\n\n<pre><code>Dim a As Integer, b As Integer\n\nFor a = Cells(Rows.Count, \"A\").End(xlUp).Row To 2 Step -1\n    For b = a To 2 Step -1\n\n        If Cells(a, \"A\") = Cells(b, \"A\") And Cells(a, \"B\") = \"502000\" _\n           And Cells(b, \"B\") = \"501000\" And Cells(a, \"C\") = Cells(b, \"C\") _\n           And Cells(a, \"D\") = Cells(b, \"D\") And Cells(a, \"E\") = Cells(b, \"E\") _ \n           And Cells(a, \"F\") = Cells(b, \"F\") And Cells(a, \"G\") = Cells(b, \"G\") _ \n           And Cells(a, \"H\") = Cells(b, \"H\") Then \n             Cells(a, \"P\") = Cells(a, \"L\") / Cells(b, \"L\")\n        end if\n    Next b\nNext a\n</code></pre>\n"}, {"tags": ["excel", "vba", "formatting", "conditional"], "comments": [{"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 1, "creation_date": 1527074800, "post_id": 50487083, "comment_id": 87987057, "body": "What have you researched / tried, so far? <a href=\"http://idownvotedbecau.se/noattempt/\" rel=\"nofollow noreferrer\">It looks like no attempt has been made</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9205553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73b10da0f4b7f3d250eb2ed336897fa8?s=128&d=identicon&r=PG&f=1", "display_name": "Focha", "link": "https://stackoverflow.com/users/9205553/focha"}, "edited": false, "score": 0, "creation_date": 1527098540, "post_id": 50487420, "comment_id": 88002263, "body": "Ok, this can be a solution, but what happens if I had more variables below or more entries?  I&#39;ll always have to add a new value on the pivot table?"}, {"owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "reply_to_user": {"reputation": 15, "user_id": 9205553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73b10da0f4b7f3d250eb2ed336897fa8?s=128&d=identicon&r=PG&f=1", "display_name": "Focha", "link": "https://stackoverflow.com/users/9205553/focha"}, "edited": false, "score": 0, "creation_date": 1527103261, "post_id": 50487420, "comment_id": 88004653, "body": "@Focha... no the pivot table will do that for you. Just select A:C as it&#39;s range. You will have to right click on the pivot table and click refresh when your data change but that&#39;s less intrusive than having to run VBA. If you add a new option in A then you will have to make a new conditional formatting rule (because you want a new colour). Also you can add a check to see if the cell is not blank in your conditional formatting and then also apply it to range A:C."}], "tags": [], "owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1527075402, "creation_date": 1527075402, "answer_id": 50487420, "question_id": 50487083, "link": "https://stackoverflow.com/questions/50487083/excel-formatting-highlight-row-based-on-the-last-date-and-equal-cell-value/50487420#50487420", "title": "Excel formatting/Highlight row based on the last date and equal cell value", "body": "<p>You don't need VBA for this. Make a small Pivot table where your column A is the rows and columns B are the values set to max. Then add a columns that is a <code>vlookup</code> to add the max date for each group (formula show in image) and finally just add conditional formatting, one rule per group again as shown in the image (note in this case the formatting is applied to the range <code>A1:C9</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/7iVQf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7iVQf.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can always hide column D and the pivot table or put them on another sheet if need be.</p>\n"}], "owner": {"reputation": 15, "user_id": 9205553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73b10da0f4b7f3d250eb2ed336897fa8?s=128&d=identicon&r=PG&f=1", "display_name": "Focha", "link": "https://stackoverflow.com/users/9205553/focha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 373, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527075402, "creation_date": 1527074418, "question_id": 50487083, "link": "https://stackoverflow.com/questions/50487083/excel-formatting-highlight-row-based-on-the-last-date-and-equal-cell-value", "title": "Excel formatting/Highlight row based on the last date and equal cell value", "body": "<p>My question relates with the following.</p>\n\n<p>I have a matrix in Excel of values, I want to highlight the entire row if two conditions are met. Those conditions are:</p>\n\n<p>a. For equal values on column A compare its date;</p>\n\n<p>b. If the value is equal, highlight the row with the most recent date.</p>\n\n<p>Graphically its the following:</p>\n\n<pre><code>    A   B\n1   Y   04-08-2006\n\n2   X   02-07-2008\n\n3   X   12-05-2014\n\n4   Z   09-08-2014\n\n5   X   25-06-2016\n\n6   Z   01-04-2018\n\n7   Y   24-07-2018\n\n8   X   25-09-2018\n</code></pre>\n\n<p>I want to highlight the 6, 7 and 8 row with different colors.</p>\n\n<p>Can I do that with conditional formatting or its not possible and the only way is to write code in VBA?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "charts", "vba"], "answers": [{"comments": [{"owner": {"reputation": 337, "user_id": 4374280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001915578210/picture?type=large", "display_name": "Jason Stallard", "link": "https://stackoverflow.com/users/4374280/jason-stallard"}, "edited": false, "score": 0, "creation_date": 1527073952, "post_id": 50486762, "comment_id": 87986513, "body": "Excellent. I had read this several times when searching for a solution but I didn&#39;t see how to apply it to my situation."}, {"owner": {"reputation": 337, "user_id": 4374280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001915578210/picture?type=large", "display_name": "Jason Stallard", "link": "https://stackoverflow.com/users/4374280/jason-stallard"}, "edited": false, "score": 0, "creation_date": 1527075149, "post_id": 50486762, "comment_id": 87987288, "body": "It did but I had to wait two minutes before I could mark it as an answer."}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": true, "score": 2, "last_activity_date": 1527074948, "last_edit_date": 1527074948, "creation_date": 1527073453, "answer_id": 50486762, "question_id": 50486653, "link": "https://stackoverflow.com/questions/50486653/excel-2013-vba-change-a-chart-object-source-using-dynamic-range/50486762#50486762", "title": "Excel 2013 VBA change a chart object source using dynamic range", "body": "<p>You're referring to the ChartObject.\n<code>SetSourceData</code> is a method of the <code>Chart</code> inside the <code>ChartObject</code>.</p>\n\n<p>Try</p>\n\n<pre><code>fdc = 26\nldc = 90\nws.ChartObjects(\"Chart 2\").Chart.SetSourceData Source:=ws.Range(\"S\" &amp; fdc &amp; \":V\" &amp; ldc)\n</code></pre>\n"}], "owner": {"reputation": 337, "user_id": 4374280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001915578210/picture?type=large", "display_name": "Jason Stallard", "link": "https://stackoverflow.com/users/4374280/jason-stallard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 50486762, "answer_count": 1, "score": 0, "last_activity_date": 1527074948, "creation_date": 1527073080, "last_edit_date": 1531164843, "question_id": 50486653, "link": "https://stackoverflow.com/questions/50486653/excel-2013-vba-change-a-chart-object-source-using-dynamic-range", "title": "Excel 2013 VBA change a chart object source using dynamic range", "body": "<p>I am trying to dynamically set a chart object source. The <em>fdc</em> and <em>ldc</em> variables will change over time.\nI've tried several variations of code; my latest attempt being:</p>\n\n<pre><code>fdc = 26\nldc = 90\nws.ChartObjects(\"Chart 2\").SetSourceData Source:=ws.Range(\"S\" &amp; fdc &amp; \":V\" &amp; ldc)\n</code></pre>\n\n<p>but they all give:</p>\n\n<blockquote>\n  <p>Run-time error '438': Object doesn't support this property or method.</p>\n</blockquote>\n"}, {"tags": ["json", "excel", "jira", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9833632, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7VKolyFCQHQ/AAAAAAAAAAI/AAAAAAAAAHg/j5a5EbNIg00/photo.jpg?sz=128", "display_name": "Magyc", "link": "https://stackoverflow.com/users/9833632/magyc"}, "edited": false, "score": 0, "creation_date": 1527079020, "post_id": 50486479, "comment_id": 87990006, "body": "Hi,  thx for your help   I tru this but I have still an error on this line ::         For Each componentItem In jsonObject(Item(&quot;fields&quot;)(&quot;components&quot;))   ==&gt; error &#39;13&#39; Type mismatch  .. I don&#39;t understand why ... i declare componentItem like Item... as Variant"}, {"owner": {"reputation": 13, "user_id": 9833632, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7VKolyFCQHQ/AAAAAAAAAAI/AAAAAAAAAHg/j5a5EbNIg00/photo.jpg?sz=128", "display_name": "Magyc", "link": "https://stackoverflow.com/users/9833632/magyc"}, "edited": false, "score": 0, "creation_date": 1527079413, "post_id": 50486479, "comment_id": 87990281, "body": "Ok, just need to remove jsonObject :: For Each componentItem In Item(&quot;fields&quot;)(&quot;components&quot;). Now I will try to use your method reach my goal !  I kepp you inform."}], "tags": [], "owner": {"reputation": 170, "user_id": 6826215, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-abbU47r4tA0/AAAAAAAAAAI/AAAAAAAAABA/sWTOBanDlwY/photo.jpg?sz=128", "display_name": "Abhishek Pandey", "link": "https://stackoverflow.com/users/6826215/abhishek-pandey"}, "is_accepted": true, "score": 0, "last_activity_date": 1527072612, "creation_date": 1527072612, "answer_id": 50486479, "question_id": 50486008, "link": "https://stackoverflow.com/questions/50486008/parsing-json-test-is-json-key-existing/50486479#50486479", "title": "Parsing json : Test is json key existing", "body": "<p>You can modify your solution some what like this,</p>\n\n<pre><code>For Each Item In jsonObject(\"issues\")\n    issueId = Item(\"id\")\n    For Each componentItem In jsonObject(Item(\"fields\")(\"components\"))\n      If componentItem(\"id\")==1 then\n         compoId1 = componentItem(\"id\")\n      EndIf\n      If componentItem(\"id\")==1 then\n         compoId2 = componentItem(\"id\")\n      EndIf\n\n    Next\n    i = i + 1\n\n    'PRINT_OF_MY_RESULT\n\nNext\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9833632, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7VKolyFCQHQ/AAAAAAAAAAI/AAAAAAAAAHg/j5a5EbNIg00/photo.jpg?sz=128", "display_name": "Magyc", "link": "https://stackoverflow.com/users/9833632/magyc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 674, "favorite_count": 1, "accepted_answer_id": 50486479, "answer_count": 1, "score": 1, "last_activity_date": 1527072612, "creation_date": 1527071346, "last_edit_date": 1531164843, "question_id": 50486008, "link": "https://stackoverflow.com/questions/50486008/parsing-json-test-is-json-key-existing", "title": "Parsing json : Test is json key existing", "body": "<p>I'm request with API REST a JIRA filter since Excel and I return my result in a json object. \nI'm parsing this object and I Try to show my result (in a msgbox for now) but I have a problem when the json Key doesn't exist ! </p>\n\n<p>A extract of my json : </p>\n\n<pre><code>{\n    \"expand\":\"schema,names\",\n    \"startAt\":0,\n    \"maxResults\":500,\n    \"total\":2,\n    \"issues\":[\n    {\n        \"expand\":\"operations,versionedRepresentations,editmeta,changelog,renderedFields\",\n        \"id\":\"00001\",\n        \"fields\":{\n            \"components\":[\n            {\n                \"id\":\"01\",\n                \"name\":\"component_1\"\n                },\n            {\n                \"id\":\"02\",\n                \"name\":\"component_02\"\n                }\n            ]\n            }\n        },\n    {\n        \"expand\":\"operations,versionedRepresentations,editmeta,changelog,renderedFields\",\n        \"id\":\"00002\",\n        \"fields\":{\n            \"components\":[\n            ]\n            }\n        },\n    ]\n    }\n</code></pre>\n\n<p>As you cans see, in my first issue (id 00001) I have a 2 components key but in my second issus (id 0002) I don't have component key, because this fields is empty in JIRA for this issue. </p>\n\n<p>So, a part of my code to show my result : </p>\n\n<pre><code>For Each Item In jsonObject(\"issues\")\n\n    issueId = Item(\"id\")\n    compoId1 = Item(\"fields\")(\"components\")(1)(\"id\")\n    compoId2 = Item(\"fields\")(\"components\")(2)(\"id\")\n    i = i + 1\n\n    'PRINT_OF_MY_RESULT\n\nNext\n</code></pre>\n\n<p>My problem : \nIf my issue (00001) has a \"component\" value, it's OK and I can return my result but ... if my issus (00002) hasn't a result, my code failled to define compoId ... and my code crash. </p>\n\n<p>Did you have a simple solution ? I try somethings with Exists, isEmpty, etc etc ... but nothing concluent for me :(</p>\n"}, {"tags": ["ms-access", "sas", "vba"], "comments": [{"owner": {"reputation": 16968, "user_id": 1919583, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/35a12f323e0bea76c8b442df11825d57?s=128&d=identicon&r=PG", "display_name": "Reeza", "link": "https://stackoverflow.com/users/1919583/reeza"}, "edited": false, "score": 0, "creation_date": 1527208945, "post_id": 50485634, "comment_id": 88052453, "body": "Can you trigger this differently, always write to the same file name and have a script that runs when you start the Access DB to update the files/records automatically? That&#39;s usually how I set it up."}, {"owner": {"reputation": 21, "user_id": 9812311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd90b1fa4050e811b45ee9bd3396666?s=128&d=identicon&r=PG&f=1", "display_name": "ELVEE", "link": "https://stackoverflow.com/users/9812311/elvee"}, "reply_to_user": {"reputation": 16968, "user_id": 1919583, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/35a12f323e0bea76c8b442df11825d57?s=128&d=identicon&r=PG", "display_name": "Reeza", "link": "https://stackoverflow.com/users/1919583/reeza"}, "edited": false, "score": 0, "creation_date": 1527500310, "post_id": 50485634, "comment_id": 88136922, "body": "Potentially, or use the autoexec macro as Richard describes, but as noted in my comment to Richard, it can take up to 5 min to update and it is also used as a front end to extract reports by other colleagues, and I do not wish to slow down their usage."}, {"owner": {"reputation": 16968, "user_id": 1919583, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/35a12f323e0bea76c8b442df11825d57?s=128&d=identicon&r=PG", "display_name": "Reeza", "link": "https://stackoverflow.com/users/1919583/reeza"}, "edited": false, "score": 0, "creation_date": 1527516376, "post_id": 50485634, "comment_id": 88146298, "body": "Sounds like you\u2019re reaching the limits of an Access DB and need an actual reporting and database tool."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9812311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd90b1fa4050e811b45ee9bd3396666?s=128&d=identicon&r=PG&f=1", "display_name": "ELVEE", "link": "https://stackoverflow.com/users/9812311/elvee"}, "edited": false, "score": 0, "creation_date": 1527083530, "post_id": 50486685, "comment_id": 87993237, "body": "Thank you @Richard. I am aware of running the autoexec macro at database start up but as the import can take 5 minutes and the database has a front end used by other colleagues to extract various reports, this is not an effective solution.  I have limited experience with %sysexec, so to ensure I understand you correctly, to trigger the code from SAS, it would be      %sysexec \u2018PATH\u2019 /x ImportTables; With PATH being the path to the Access db.  And can it trigger the ImportTables function as is, written in a module, or do I need to create a macro under Macros that contains the VBA code?"}, {"owner": {"reputation": 21516, "user_id": 1249962, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/rHCpd.gif?s=128&g=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/1249962/richard"}, "reply_to_user": {"reputation": 21, "user_id": 9812311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd90b1fa4050e811b45ee9bd3396666?s=128&d=identicon&r=PG&f=1", "display_name": "ELVEE", "link": "https://stackoverflow.com/users/9812311/elvee"}, "edited": false, "score": 0, "creation_date": 1527093048, "post_id": 50486685, "comment_id": 87999550, "body": "Potential use case to justify taking the step up to SQL Server or Azure for your data storage.  Access could still be used for reporting and entry front ends."}], "tags": [], "owner": {"reputation": 21516, "user_id": 1249962, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/rHCpd.gif?s=128&g=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/1249962/richard"}, "is_accepted": false, "score": 2, "last_activity_date": 1527073211, "creation_date": 1527073211, "answer_id": 50486685, "question_id": 50485634, "link": "https://stackoverflow.com/questions/50485634/trigger-ms-access-function-with-sas/50486685#50486685", "title": "Trigger MS Access function with SAS", "body": "<p>There are several SAS statements that can start external programs, including</p>\n\n<ul>\n<li>%sysexec</li>\n<li>call system</li>\n<li>filename pipe</li>\n</ul>\n\n<p>Access has the command line switch <code>/x mymacro</code> that will run a specific macro at startup, or you can create or update the <code>AutoExec</code> macro that is also run automatically every time Access is started.</p>\n\n<p>So your SAS code might look like</p>\n\n<pre><code>%Spit;\n%sysexec msaccess /x ImportTablesMacro;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 9812311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd90b1fa4050e811b45ee9bd3396666?s=128&d=identicon&r=PG&f=1", "display_name": "ELVEE", "link": "https://stackoverflow.com/users/9812311/elvee"}, "edited": false, "score": 0, "creation_date": 1527083605, "post_id": 50489344, "comment_id": 87993284, "body": "Thank you @DomPazz. I do have the ability to run command lines from my SAS sessions."}], "tags": [], "owner": {"reputation": 12195, "user_id": 2734437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34bd4e812424e1841ab39b4e2d869517?s=128&d=identicon&r=PG&f=1", "display_name": "DomPazz", "link": "https://stackoverflow.com/users/2734437/dompazz"}, "is_accepted": false, "score": 0, "last_activity_date": 1527081090, "creation_date": 1527081090, "answer_id": 50489344, "question_id": 50485634, "link": "https://stackoverflow.com/questions/50485634/trigger-ms-access-function-with-sas/50489344#50489344", "title": "Trigger MS Access function with SAS", "body": "<p>@Richard shows you how to call Access from SAS.  If you do not have the ability to run command lines from your SAS session (some system administrators disable this), you can write a shell script.  </p>\n\n<p>First call SAS to create the .txt files.</p>\n\n<p>Then call Access with the method Richard describes to run the macro.</p>\n"}], "owner": {"reputation": 21, "user_id": 9812311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd90b1fa4050e811b45ee9bd3396666?s=128&d=identicon&r=PG&f=1", "display_name": "ELVEE", "link": "https://stackoverflow.com/users/9812311/elvee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1527081090, "creation_date": 1527070355, "question_id": 50485634, "link": "https://stackoverflow.com/questions/50485634/trigger-ms-access-function-with-sas", "title": "Trigger MS Access function with SAS", "body": "<p>I\u2019m a newbie on here so please be gentle :)</p>\n\n<p>My question is: can I get SAS (9.4 with PC Files Server) to trigger a function in MS ACCESS that imports .txt files that SAS spat out earlier?</p>\n\n<p>Background: I have inherited an Access database (.accdb, using vers. 2010), which source data comes from SAS. Current method is that SAS spits out .txt files, which I (semi-manually) import into the database. Semi-manually in that there is a button/macro that imports the files but I have to open the database and press the button. I would prefer not to have to intervene at all.</p>\n\n<p>I tried to skip the import of tables by using PROC EXPORT (and PC FILES SERVER) and later PROC SQL (with Access database assigned via libname) to push the data from SAS directly. However, compared to the old approach, after doing a compact and repair, the database is still about twice the size. I searched the net on how to avoid increase in size but found no answers.</p>\n\n<p>I would therefore like to keep the method of SAS spitting out the .txt files but also have SAS trigger the Access function in the database that imports the files. </p>\n\n<p>The button in Access activates this code:</p>\n\n<pre><code>Private Sub ImportSASDataButton_Click()\nDim Update As Byte\n    Update = MsgBox(\"Have you ran the SAS program that creates the text files?\" _\n                    , vbYesNo, \"Check files have been created\")\n\nIf Update = vbYes Then ImportTables\nMe.CloseFormButton.SetFocus\nMe.ImportSASDataButton.Enabled = False\nEnd Sub\n</code></pre>\n\n<p>Which if \u201cYES\u201d activates this code (which is the function I wish to trigger directly):</p>\n\n<pre><code>Function ImportTables()\nDim db As Database\nDim ITables As Recordset\n\nSet db = CurrentDb\nSet ITables = db.OpenRecordset(\"Tables\", dbOpenDynaset)\n\nDo Until ITables.EOF\n    Call ImportData(ITables![TableName], _\n                    ITables![SpecificationName], _\n                    ITables![FileName], _\n                ITables![DeleteExisting], _\n                ITables![Use])\n    ITables.MoveNext\nLoop\nITables.Close\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 1, "creation_date": 1527070160, "post_id": 50485133, "comment_id": 87984034, "body": "Define &quot;doesn&#39;t want to work&quot;. Is there an error? If so, what is the error message, and on which line does the error occur? If there is no error, then what is the code not doing which it should, or doing which it should not? <a href=\"http://idownvotedbecau.se/itsnotworking/\" rel=\"nofollow noreferrer\">Saying &#39;it doesn&#39;t work&#39; isn&#39;t helpful</a>"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1527070259, "creation_date": 1527070259, "answer_id": 50485598, "question_id": 50485133, "link": "https://stackoverflow.com/questions/50485133/making-graphs-for-vba-with-different-kind-of-data/50485598#50485598", "title": "making Graphs for VBA, with different kind of data", "body": "<p>You have to declare the <code>rng</code> and the <code>cht</code> as objects. This works:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim rng As Object, cht As Object\n    Set rng = ActiveSheet.Range(\"A2: I2\")\n    Set cht = ActiveSheet.Shapes.AddChart2\n\n    With cht.Chart\n        .SetSourceData Source:=rng\n        .ChartType = xlXYScatterLines\n        .ChartTitle.Text = \"Statistic of Student\"\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/9GK57.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9GK57.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 194, "user_id": 8978777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c516087c61b368e673e81440bf15519?s=128&d=identicon&r=PG&f=1", "display_name": "Kajkrow", "link": "https://stackoverflow.com/users/8978777/kajkrow"}, "is_accepted": false, "score": 0, "last_activity_date": 1527070354, "creation_date": 1527070354, "answer_id": 50485633, "question_id": 50485133, "link": "https://stackoverflow.com/questions/50485133/making-graphs-for-vba-with-different-kind-of-data/50485633#50485633", "title": "making Graphs for VBA, with different kind of data", "body": "<p>I found this MSDN-page which explains how to create graphs via VBA:<br>\n<a href=\"https://msdn.microsoft.com/en-us/library/office/aa203725(v=office.11).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/aa203725(v=office.11).aspx</a>  </p>\n\n<blockquote>\n  <p>Code from their page:  </p>\n</blockquote>\n\n<pre><code>Sub AddChartSheet()\n        Dim chtChart As Chart\n        'Create a new chart.\n        Set chtChart = Charts.Add\n    With chtChart\n          .Name = \"Tool Sales2\"\n       .ChartType = xlColumnClustered\n       'Link to the source data range.\n       .SetSourceData Source:=Sheets(\"Sheet1\").Range(\"A1:D5\"), _\n         PlotBy:=xlRows\n       .HasTitle = True\n       .ChartTitle.Text = \"=Sheet1!R1C2\"\n       .Axes(xlCategory, xlPrimary).HasTitle = True\n       .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"Month\"\n       .Axes(xlValue, xlPrimary).HasTitle = True\n       .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"Sales\"\n   End With\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <hr>\n</blockquote>\n\n<p>So this removes your mistakes:</p>\n\n<pre><code>Dim cht As Chart\nDim rng as Range\nSet rng = ActiveSheet.Range (\"A2: I2\")\nSet cht = ActiveSheet.Shapes.AddChart2\ncht.Chart.ChartType = xlXYScatterLines\ncht.Chart.SetSourceData Source:= rng, PlotBy:=xlRows\ncht.Chart.ChartTitle.Text = \"Statistic of Student\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9833629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08c2d31c0462a1d7d643d02f95c901dc?s=128&d=identicon&r=PG&f=1", "display_name": "Ismail", "link": "https://stackoverflow.com/users/9833629/ismail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1527074900, "creation_date": 1527069054, "last_edit_date": 1527074900, "question_id": 50485133, "link": "https://stackoverflow.com/questions/50485133/making-graphs-for-vba-with-different-kind-of-data", "title": "making Graphs for VBA, with different kind of data", "body": "<p>I have an assignment for my school exam project and i have tried and tried and hope u can help me</p>\n\n<p>The question is like this:</p>\n\n<p>As \"delayed\" students constitute a \"risk\" for the university, it is important for the Head of Studies to be prepared\nSome additional statistics about this group of students. Create a sub / function that can graphs the following i\nThe sheet \"Delayed Students\":</p>\n\n<ul>\n<li>The percentage distribution of late students between each Study Board</li>\n<li>The percentage distribution of late students between each PROGRAM_ID's</li>\n<li>The percentage distribution of late students between each faculty</li>\n<li>The percentage distribution of late students between each campus</li>\n<li>The number of late students distributed by ENROLL_PERIOD</li>\n</ul>\n\n<p>The Head of Studies would like to be able to generate the statistics by pressing a button on the sheet \"Delayed Students\".</p>\n\n<p>This is my code and it doesn't want to work:</p>\n\n<pre><code>Set rng = ActiveSheet.Range (\"A2: I2\")\nSet cht = ActiveSheet.Shapes.AddChart2\ncht.Chart.SetSourceData Source: = rng\ncht.Chart.Chartype = xlXYScatterLines\ncht.Chart.ChartTitle.Text = \"Statistic of Student\"\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "declaration"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1527066767, "post_id": 50484210, "comment_id": 87981640, "body": "It talks about some functions, and you are having a <code>Sub</code>. Is there some other code? In general, this is a compiling error, thus something is not written as it should be. I have tried the code above, it compiles. Take a look here - <a href=\"https://superuser.com/questions/1160671/compile-error-syntax-error-in-excel-macro\" title=\"compile error syntax error in excel macro\">superuser.com/questions/1160671/&hellip;</a>"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1527067744, "post_id": 50484210, "comment_id": 87982364, "body": "If you are asking question on multinational forum, it would very kind of you to transalte your error to english, instead of posting it in your language."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1527067755, "post_id": 50484210, "comment_id": 87982367, "body": "I use the very same function and API declarations, and they work in 32bit Access 10. Do you perhaps use 64bit Office? If not, can you translate that error message for us?"}], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 2, "last_activity_date": 1527069647, "creation_date": 1527069647, "answer_id": 50485352, "question_id": 50484210, "link": "https://stackoverflow.com/questions/50484210/compilation-error-while-declaring-function-vba-ms-access/50485352#50485352", "title": "Compilation error while declaring function vba ms access", "body": "<p>The declarations aren't 64-bit compatible, and you're using longs instead of booleans for wRevert and the return of EnableMenuItem. You can try the following (needs VBA7 (Office 2010+) for LongPtr support):</p>\n\n<pre><code>Private Declare PtrSafe Function GetSystemMenu Lib \"user32\" (ByVal hwnd As LongPtr, ByVal wRevert As Boolean) As LongPtr\nPrivate Declare PtrSafe Function EnableMenuItem Lib \"user32\" (ByVal hMenu As LongPtr, ByVal wIDEnableItem As Long, ByVal wEnable As Long) As Boolean\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 8394044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RNGX9.jpg?s=128&g=1", "display_name": "Egor Filonov", "link": "https://stackoverflow.com/users/8394044/egor-filonov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 584, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527069647, "creation_date": 1527066439, "last_edit_date": 1527067990, "question_id": 50484210, "link": "https://stackoverflow.com/questions/50484210/compilation-error-while-declaring-function-vba-ms-access", "title": "Compilation error while declaring function vba ms access", "body": "<p>I am trying to implement a script which would disable \"close\" button of the ms access window.</p>\n\n<p>However, I get compilation error when trying to declare functions: </p>\n\n<pre><code>Option Compare Database\nOption Explicit\nPrivate Declare Function GetSystemMenu Lib \"user32\" (ByVal hwnd As Long, ByVal wRevert As Long) As Long\nPrivate Declare Function EnableMenuItem Lib \"user32\" (ByVal hMenu As Long, ByVal wIDEnableItem As Long, ByVal wEnable As Long) As Long\n\nPublic Sub AccessCloseButtonEnabled(pfEnabled As Boolean)\n  ' Comments: Control the Access close button.\n  '           Disabling it forces the user to exit within the application\n  ' Params  : pfEnabled       TRUE enables the close button, FALSE disabled it\n  ' Owner   : Copyright (c) FMS, Inc.\n  ' Source  : Total Visual SourceBook\n  ' Usage   : Permission granted to subscribers of the FMS Newsletter\n\n  On Error Resume Next\n\n  Const clngMF_ByCommand As Long = &amp;H0&amp;\n  Const clngMF_Grayed As Long = &amp;H1&amp;\n  Const clngSC_Close As Long = &amp;HF060&amp;\n\n  Dim lngWindow As Long\n  Dim lngMenu As Long\n  Dim lngFlags As Long\n\n  lngWindow = Application.hWndAccessApp\n  lngMenu = GetSystemMenu(lngWindow, 0)\n  If pfEnabled Then\n    lngFlags = clngMF_ByCommand And Not clngMF_Grayed\n  Else\n    lngFlags = clngMF_ByCommand Or clngMF_Grayed\n  End If\n  Call EnableMenuItem(lngMenu, clngSC_Close, lngFlags)\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/hwlrF.png\" alt=\"My Error\"></p>\n\n<p><em>Translation: Error in the compilation of the functions. Syntax Error in a Visual Basic Module. Check the program, and then recompile it.</em></p>\n\n<hr>\n\n<p>What do you think might have caused the problem? </p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 1747, "user_id": 6800303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d86ffb4271b65f9121097792b5f77af1?s=128&d=identicon&r=PG&f=1", "display_name": "NitinSingh", "link": "https://stackoverflow.com/users/6800303/nitinsingh"}, "edited": false, "score": 0, "creation_date": 1527066549, "post_id": 50483624, "comment_id": 87981485, "body": "1) What&#39;s the &quot;clickedEvent&quot;   2) You are yourself checking the condition of clicked event before showing the message box.."}, {"owner": {"reputation": 15, "user_id": 8103066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4888eea1f44a898bb57684de14da007e?s=128&d=identicon&r=PG&f=1", "display_name": "Shitalb ", "link": "https://stackoverflow.com/users/8103066/shitalb"}, "reply_to_user": {"reputation": 1747, "user_id": 6800303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d86ffb4271b65f9121097792b5f77af1?s=128&d=identicon&r=PG&f=1", "display_name": "NitinSingh", "link": "https://stackoverflow.com/users/6800303/nitinsingh"}, "edited": false, "score": 0, "creation_date": 1527066653, "post_id": 50483624, "comment_id": 87981562, "body": "@NitinSingh yes"}, {"owner": {"reputation": 1747, "user_id": 6800303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d86ffb4271b65f9121097792b5f77af1?s=128&d=identicon&r=PG&f=1", "display_name": "NitinSingh", "link": "https://stackoverflow.com/users/6800303/nitinsingh"}, "edited": false, "score": 0, "creation_date": 1527066790, "post_id": 50483624, "comment_id": 87981656, "body": "So unless the &quot;clickedEvent&quot; matches, the messagebox will not be shown.. That&#39;s what the code&#39;s doing.  First set the app to be activated and then remove the check."}, {"owner": {"reputation": 15, "user_id": 8103066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4888eea1f44a898bb57684de14da007e?s=128&d=identicon&r=PG&f=1", "display_name": "Shitalb ", "link": "https://stackoverflow.com/users/8103066/shitalb"}, "reply_to_user": {"reputation": 1747, "user_id": 6800303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d86ffb4271b65f9121097792b5f77af1?s=128&d=identicon&r=PG&f=1", "display_name": "NitinSingh", "link": "https://stackoverflow.com/users/6800303/nitinsingh"}, "edited": false, "score": 0, "creation_date": 1527067954, "post_id": 50483624, "comment_id": 87982511, "body": "@NitinSingh condition is always true in above case. anyway I got the answer. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "is_accepted": true, "score": 0, "last_activity_date": 1527065866, "creation_date": 1527065866, "answer_id": 50484024, "question_id": 50483624, "link": "https://stackoverflow.com/questions/50483624/msgbox-is-not-getting-displayed-in-outlookapp-send-event/50484024#50484024", "title": "Msgbox is not getting displayed in outlookApp_Send event", "body": "<p>This is a known issue with several MS Office applications. Try adding this code and see if it helps:</p>\n\n<pre><code>AppActivate Application.Caption\n</code></pre>\n\n<p>or</p>\n\n<pre><code>AppActivate \"Microsoft Excel\" ' name of application that needs to be in focus\n</code></pre>\n\n<p>From the documentation:</p>\n\n<blockquote>\n  <p>The <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/appactivate-statement\" rel=\"nofollow noreferrer\">AppActivate</a> statement changes the focus to the named\n  application or window but does not affect whether it is maximized or\n  minimized.</p>\n</blockquote>\n"}], "owner": {"reputation": 15, "user_id": 8103066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4888eea1f44a898bb57684de14da007e?s=128&d=identicon&r=PG&f=1", "display_name": "Shitalb ", "link": "https://stackoverflow.com/users/8103066/shitalb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 50484024, "answer_count": 1, "score": 0, "last_activity_date": 1592993348, "creation_date": 1527064663, "last_edit_date": 1592993348, "question_id": 50483624, "link": "https://stackoverflow.com/questions/50483624/msgbox-is-not-getting-displayed-in-outlookapp-send-event", "title": "Msgbox is not getting displayed in outlookApp_Send event", "body": "<p>I am sending mail using outlook, on send event I am trying to display message, but msgbox is not getting displayed till I clicked on screen( anywhere).\n(Once user click on Send in Outlook, I am changing the Outlook windowState to minimize.)</p>\n\n<pre><code>Public Sub oApp_ItemSend(ByVal Item As Object, Cancel As Boolean)\n    If(StrComp(clickedEvent, \"ClickMe\", vbTextCompare) = 0) Then\n        MsgBox \"HI\"\n    end if\nEnd sub\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "substitution", "textjoin"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 3544368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f19ef4ea1a7225759bb9f21d79315636?s=128&d=identicon&r=PG&f=1", "display_name": "Alok Shrestha", "link": "https://stackoverflow.com/users/3544368/alok-shrestha"}, "edited": false, "score": 0, "creation_date": 1528982114, "post_id": 50483880, "comment_id": 88719428, "body": "This helps but doesn&#39;t completely solve my question."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1527066041, "last_edit_date": 1527066041, "creation_date": 1527065420, "answer_id": 50483880, "question_id": 50483255, "link": "https://stackoverflow.com/questions/50483255/apply-formula-processing-to-range-before-passing-to-another-formula/50483880#50483880", "title": "Apply formula (processing) to Range before passing to another formula", "body": "<p>This is possibly a good solution to be done with a User-defined function in VBA:</p>\n\n<pre><code>Public Function someTest(firstVal As String, ParamArray otherVal() As Variant) As String\n\n    Dim someVal As Variant\n    Dim delim As String:    delim = \"|\"\n    Dim splitVal As String: splitVal = \"-\"\n\n    For Each someVal In otherVal\n        someTest = someTest &amp; Split(firstVal, splitVal)(0) &amp; delim &amp; someVal\n    Next someVal\n\nEnd Function\n</code></pre>\n\n<p>And this is how you call it:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vfe8Z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vfe8Z.png\" alt=\"enter image description here\"></a></p>\n\n<p>The function uses <code>ParamArray()</code> and it loops through every element of it, concatenating with the first part of the first parameter. Thus, from <code>English-test</code> only <code>English</code> is taken.</p>\n\n<hr>\n\n<p>With a small change it is possible to pass the second argument as a range. Thus, it will be a bit easier:</p>\n\n<pre><code>Public Function someTest2(firstVal As String, otherVal As Range) As String\n\n    Dim someVal As Range\n    Dim delim As String:    delim = \"|\"\n    Dim splitVal As String: splitVal = \"-\"\n\n    For Each someVal In otherVal\n        someTest2 = someTest2 &amp; Split(firstVal, splitVal)(0) &amp; delim &amp; someVal\n    Next someVal\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/QPvGy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QPvGy.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here the second parameter is given as a range. Every range has at least one cell, thus the function loops through the cells.</p>\n"}, {"tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": false, "score": 0, "last_activity_date": 1527067997, "creation_date": 1527067997, "answer_id": 50484771, "question_id": 50483255, "link": "https://stackoverflow.com/questions/50483255/apply-formula-processing-to-range-before-passing-to-another-formula/50484771#50484771", "title": "Apply formula (processing) to Range before passing to another formula", "body": "<p>Solution with a formula; less extensible than a UDF:</p>\n\n<blockquote>\n  <p>=SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(Rest,\"test\",Extras1&amp;\"|\",1),\"test\",Extras2&amp;\"|\",1),\"test\",Extras3&amp;\"|\",1),\"|\",\"\",COUNTA(Extras1:Extras3))</p>\n</blockquote>\n"}], "owner": {"reputation": 17, "user_id": 3544368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f19ef4ea1a7225759bb9f21d79315636?s=128&d=identicon&r=PG&f=1", "display_name": "Alok Shrestha", "link": "https://stackoverflow.com/users/3544368/alok-shrestha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1528982045, "creation_date": 1527063509, "last_edit_date": 1528982045, "question_id": 50483255, "link": "https://stackoverflow.com/questions/50483255/apply-formula-processing-to-range-before-passing-to-another-formula", "title": "Apply formula (processing) to Range before passing to another formula", "body": "<p>I am trying to apply <code>TEXTJOIN</code> formula in one of the cells.\nBut the problem occurred when I needed to pre-process each cell in the range.\nFor example the data is something as below.\n<code>\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551 Test \u2551     Rest     \u2551 Extras1 \u2551 Extras2 \u2551 Extras3 \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551      \u2551 English-test \u2551 corner  \u2551         \u2551         \u2551\n\u2551      \u2551 Chinese-test \u2551 corner  \u2551 view    \u2551         \u2551\n\u2551      \u2551 Korean-test  \u2551 corner  \u2551 room    \u2551 room_2  \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d</code></p>\n\n<p>In the Test column, I was seeking to Join the text in Rest after Substituting the word -test to each word in Extras. What I expect is the following.\n<code>\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551                  Test                   \u2551     Rest     \u2551 Extras1 \u2551 Extras2 \u2551 Extras3 \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551 English-corner                          \u2551 English-test \u2551 corner  \u2551         \u2551         \u2551\n\u2551 Chinese-corner|Chinese-view             \u2551 Chinese-test \u2551 corner  \u2551 view    \u2551         \u2551\n\u2551 Korean-corner|Korean-room|Korean-room_2 \u2551 Korean-test  \u2551 corner  \u2551 room    \u2551 room_2  \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d</code></p>\n\n<p>The basic formula I have used is <code>TEXTJOIN(\"|\",TRUE,Extras1:Extras3)</code>, however I want something like <code>TEXTJOIN(\"|\",TRUE,SUBSTITUTE(Rest,\"-test\",Extras1:Extras3))</code> if possible. Replave \"-test\" in Rest column with values from range, resulting in range.</p>\n\n<p>Tried VBA as well, but I couldnt find anything that would process Range before inputing in function.\nManual process works but takes longer time.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1527064926, "last_edit_date": 1527064926, "creation_date": 1527063646, "answer_id": 50483289, "question_id": 50482995, "link": "https://stackoverflow.com/questions/50482995/command-button-in-a-userform-to-delete-multiple-rows-depending-on-selection-in-l/50483289#50483289", "title": "Command button in a userform to delete multiple rows depending on selection in listbox", "body": "<p>Something as small as this one would set a range to a found value and delete it:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim findValue As Range\n    Set findValue = Selection.Find(\"Lisa\")\n    findValue.EntireRow.Delete\n\nEnd Sub\n</code></pre>\n\n<p>As a good practice, you may check whether the <code>findValue</code> is not nothing before deleting. Thus, you avoid an error:</p>\n\n<pre><code>If Not findValue Is Nothing Then\n    findValue.EntireRow.Delete\nEnd If\n</code></pre>\n\n<p>And if you want to make the code even one step further, keep in mind that the default value of the argument <code>After</code> in <code>Find()</code> is the first cell. Thus, <code>Find()</code> always start looking from the second cell. To avoid this, and to start looking from the first cell, it is considered a good practice to pass the <code>After:=</code> argument explicitly:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim findValue As Range\n    Dim selectedValue As Range\n\n    Set selectedValue = ActiveSheet.Range(Selection.Address)\n    With selectedValue\n        Set findValue = .Find(\"Lisa\", after:=.Cells(.Cells.Count))\n    End With\n\n    If Not findValue Is Nothing Then\n        findValue.EntireRow.Delete\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>To make the code even more \"interesting\", one may decide to check whether a range is selected (a shape can be also selected). Thus, the <code>TypeName(Selection)</code> can be used with something like this:</p>\n\n<pre><code>If TypeName(Selection) &lt;&gt; \"Range\" Then\n    MsgBox \"Range is not selected!\"\n    Exit Sub\nEnd If\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-find-method-excel?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Range.Find MSDN</a></p>\n"}, {"tags": [], "owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "is_accepted": false, "score": 0, "last_activity_date": 1527064544, "creation_date": 1527064544, "answer_id": 50483592, "question_id": 50482995, "link": "https://stackoverflow.com/questions/50482995/command-button-in-a-userform-to-delete-multiple-rows-depending-on-selection-in-l/50483592#50483592", "title": "Command button in a userform to delete multiple rows depending on selection in listbox", "body": "<p>If you use <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/refer-to-named-ranges\" rel=\"nofollow noreferrer\">Named ranges</a> for your processes, which seems to be almost mandatory in your case, then you can do the following:</p>\n\n<pre><code>Sub DeleteNamedRange(rngName As String)\n    Range(rngName).ClearContents\n    ThisWorkbook.Names(rngName).Delete\nEnd Sub\n</code></pre>\n\n<p>Invoke the <code>Sub</code> this way:</p>\n\n<pre><code>Call DeleteNamedRange(\"Lisa\")\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8349954, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5604dcc225474576f924b0f448bc9044?s=128&d=identicon&r=PG&f=1", "display_name": "L Johnstone", "link": "https://stackoverflow.com/users/8349954/l-johnstone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 430, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1527084544, "creation_date": 1527062607, "last_edit_date": 1527084544, "question_id": 50482995, "link": "https://stackoverflow.com/questions/50482995/command-button-in-a-userform-to-delete-multiple-rows-depending-on-selection-in-l", "title": "Command button in a userform to delete multiple rows depending on selection in listbox", "body": "<p>I am currently working on a userform which has a \"Clear Process\" command button.  The idea is that my userform has a listbox which will list all of the current processes.  </p>\n\n<p>From here the user will select which process(es) he/she would like to clear from the worksheet (delete all rows relating to the process).</p>\n\n<p>Embedded in the code I have used the word \"Lisa\" as a point of reference for the previous userform to know which cell the Process Name should be, using the offset function.  </p>\n\n<p>I would like to be able to use the word \"Lisa\" once the process to be deleted has been identified by the user.  This would always be the row where \"Lisa\" is found and 19 rows below.</p>\n\n<p>I have started some code but when trying to find \"Lisa\" depending on the selection made by the user I came across an issue.</p>\n\n<pre><code>Private Sub ClearButton_Click()\n\nDim findvalue As Range\nDim cDelete As VbMsgBoxResult\n\n'hold in memory\nApplication.ScreenUpdating = False\n\n'check for values\nIf Emp1.Value = \"\" Or Emp2.Value = \"\" Then\n    MsgBox \"There are no processes to delete\"\n    Exit Sub\nEnd If\n\n'confirm process should be deleted\ncDelete = MsgBox(\"Are you sure you want to delete this process?\", vbYesNo)\n\nIf cDelete = vbYes Then\n    'find the process to be deleted\n    '''''''set findvalue =\n\n'''''''delete entire process\nfindvalue.EntireRow.Delete\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Hopefully this is enough information, any help would be greatly appreciated :)</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": true, "score": 1, "last_activity_date": 1527064688, "creation_date": 1527064688, "answer_id": 50483630, "question_id": 50482930, "link": "https://stackoverflow.com/questions/50482930/sumifs-on-vba-2016/50483630#50483630", "title": "SumIfs on VBA 2016", "body": "<p>Convert your date to long:</p>\n\n<pre><code>Range(\"O1\").Value = Application.WorksheetFunction.SumIfs _\n        (MilkTableP, datemilk, \"&gt;=\" &amp; BeginWeek, _\n        datemilk, \"&lt;\" &amp; CLng(Today1))\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9832996, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-c-9rvyNmrhU/AAAAAAAAAAI/AAAAAAAACwk/e5q8S8d0zoY/photo.jpg?sz=128", "display_name": "Atikah Karimah", "link": "https://stackoverflow.com/users/9832996/atikah-karimah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 50483630, "answer_count": 1, "score": 2, "last_activity_date": 1527131944, "creation_date": 1527062381, "last_edit_date": 1531164843, "question_id": 50482930, "link": "https://stackoverflow.com/questions/50482930/sumifs-on-vba-2016", "title": "SumIfs on VBA 2016", "body": "<p>I made codes in Excel 2007 and it really went well. Then I reopened it in Excel 2016, but the value turns out to zero. I've tried to search the solution, but didn't find one. Can anyone help me?</p>\n\n<p>Here's some of my codes:</p>\n\n<pre><code>Set today1 = Range(\"C2\")\nSet BeginWeek = Range(\"C5\")\nSet MilkTableP = Range(\"MilkTable[Total Plan]\")\nSet datemilk = Range(\"MilkTable[Date]\")\n\nRange(\"O1\").Value = Application.WorksheetFunction.SumIfs _\n        (MilkTableP, datemilk, \"&gt;=\" &amp; BeginWeek, _\n        datemilk, \"&lt;\" &amp; today1)\n</code></pre>\n\n<p>Thank you so much</p>\n"}, {"tags": ["excel", "insert", "rows", "excel-tables", "vba"], "answers": [{"comments": [{"owner": {"reputation": 315, "user_id": 4448963, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000060642111/picture?type=large", "display_name": "Tam Le", "link": "https://stackoverflow.com/users/4448963/tam-le"}, "edited": false, "score": 0, "creation_date": 1527135208, "post_id": 50484964, "comment_id": 88014226, "body": "It seems this code would protect all sheets in a workbook. I have need to protect only 1 sheet (that&#39;s for data entry)."}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "reply_to_user": {"reputation": 315, "user_id": 4448963, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000060642111/picture?type=large", "display_name": "Tam Le", "link": "https://stackoverflow.com/users/4448963/tam-le"}, "edited": false, "score": 0, "creation_date": 1527146818, "post_id": 50484964, "comment_id": 88019084, "body": "Then it&#39;s even easier, I added it above"}, {"owner": {"reputation": 315, "user_id": 4448963, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000060642111/picture?type=large", "display_name": "Tam Le", "link": "https://stackoverflow.com/users/4448963/tam-le"}, "edited": false, "score": 0, "creation_date": 1527217133, "post_id": 50484964, "comment_id": 88053969, "body": "Still haven&#39;t figured out exactly how to use this :(. Does this code run when workbook open? Or Do I have to run it manually. How to I run it manually, I couldn&#39;t see it in the Macro menu? Or do I have to put it inside another code to that run to protect the workbook? Or it runs automatically when I protect the workbook?"}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "reply_to_user": {"reputation": 315, "user_id": 4448963, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000060642111/picture?type=large", "display_name": "Tam Le", "link": "https://stackoverflow.com/users/4448963/tam-le"}, "edited": false, "score": 0, "creation_date": 1527232708, "post_id": 50484964, "comment_id": 88058977, "body": "Put this code in the ThisWorkbook section, When opening the file this sub runs."}, {"owner": {"reputation": 315, "user_id": 4448963, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000060642111/picture?type=large", "display_name": "Tam Le", "link": "https://stackoverflow.com/users/4448963/tam-le"}, "edited": false, "score": 0, "creation_date": 1527235153, "post_id": 50484964, "comment_id": 88060432, "body": "When put this code in, open the file, it doesn&#39;t allow me to add row via the button. When I unprotect the sheet, the button works normally."}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "reply_to_user": {"reputation": 315, "user_id": 4448963, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000060642111/picture?type=large", "display_name": "Tam Le", "link": "https://stackoverflow.com/users/4448963/tam-le"}, "edited": false, "score": 0, "creation_date": 1527239418, "post_id": 50484964, "comment_id": 88062837, "body": "Added other workaround, protection on/off in your code"}], "tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": true, "score": 1, "last_activity_date": 1527239340, "last_edit_date": 1527239340, "creation_date": 1527068534, "answer_id": 50484964, "question_id": 50482822, "link": "https://stackoverflow.com/questions/50482822/prevent-user-from-inserting-row-in-table-except-using-vba/50484964#50484964", "title": "Prevent user from inserting row in table except using VBA", "body": "<p>When using sheet protection, you could add Userinterfaceonly= true, this will prevent user interference, but VBA code will still work.</p>\n\n<pre><code>Private Sub Workbook_Open()\nDim ws As Worksheet\n    For Each ws In ThisWorkbook.Worksheets\n        ws.Protect Password:=\"secret\", UserInterFaceOnly:=True\n    Next ws\nEnd Sub\n</code></pre>\n\n<p>or if you want to protect just one sheet:</p>\n\n<pre><code>Private Sub Workbook_Open()\n       Worksheets(\"YourSheetName\").Protect Password:=\"secret\", UserInterFaceOnly:=True    End Sub\n</code></pre>\n\n<p>Or just take protection off before running your macro and put it on afterwards:</p>\n\n<pre><code>Sub InsertRow_Click()\nActiveSheet.Unprotect Password:=\"secret\"\nDim i As Integer\n\nFor i = 1 To 10\n    ActiveSheet.ListObjects(\"Invoice\").ListRows.Add alwaysinsert:=True\nNext i\nActiveSheet.protect Password:=\"secret\"\nEnd Sub\n</code></pre>\n\n<p>Userinterfaceonly and tables looks if it's no good match</p>\n"}], "owner": {"reputation": 315, "user_id": 4448963, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000060642111/picture?type=large", "display_name": "Tam Le", "link": "https://stackoverflow.com/users/4448963/tam-le"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 968, "favorite_count": 0, "accepted_answer_id": 50484964, "answer_count": 1, "score": 2, "last_activity_date": 1527239340, "creation_date": 1527062050, "last_edit_date": 1531161705, "question_id": 50482822, "link": "https://stackoverflow.com/questions/50482822/prevent-user-from-inserting-row-in-table-except-using-vba", "title": "Prevent user from inserting row in table except using VBA", "body": "<p>I've created a table for data entering. However, as user use it, they insert rows in the middle of the table. That messes the formula up as the functions were designed only work forward. Also sometimes when the user add row manually (just by typing into the next row after the last row of the table), the function were filled automatically but the function is incorrect quite often.</p>\n\n<p>So I added a button to add the rows to the table and that works without problems. Now I want to disable the ability for user to add rows manually, meaning rows can ONLY be added via clicking the button.</p>\n\n<p>As far as I research, people all suggesting using protect sheet functionality. But it would remove all ability to add rows including via VBA. Other offer the VBA that only prevent inserting rows via right click at the Rows Column. I need to disable all user-accessible ways.</p>\n\n<p>This is the code for the button (if it's of any relevant).</p>\n\n<pre><code>Sub InsertRow_Click()\n\nDim i As Integer\n\nFor i = 1 To 10\n    ActiveSheet.ListObjects(\"Invoice\").ListRows.Add alwaysinsert:=True\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1527061818, "post_id": 50482535, "comment_id": 87978362, "body": "Dates in autofilter <b>must</b> be in U.S. format."}], "answers": [{"comments": [{"owner": {"reputation": 1328, "user_id": 3625350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7681bb9c5891b48d06ce43c6a847001?s=128&d=identicon&r=PG&f=1", "display_name": "Raunak Thomas", "link": "https://stackoverflow.com/users/3625350/raunak-thomas"}, "edited": false, "score": 0, "creation_date": 1527061577, "post_id": 50482612, "comment_id": 87978216, "body": "I think you had posted this question earlier and before I could answer it, you removed it."}, {"owner": {"reputation": 47, "user_id": 6500122, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0c0ce4bbbd979de5044576cab35fb3f5?s=128&d=identicon&r=PG&f=1", "display_name": "Avi22", "link": "https://stackoverflow.com/users/6500122/avi22"}, "edited": false, "score": 0, "creation_date": 1527062836, "post_id": 50482612, "comment_id": 87979014, "body": "Yes, yesterday I though I fix it so I remove it. Thanks anyway and thanks for the fast resound."}], "tags": [], "owner": {"reputation": 1328, "user_id": 3625350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7681bb9c5891b48d06ce43c6a847001?s=128&d=identicon&r=PG&f=1", "display_name": "Raunak Thomas", "link": "https://stackoverflow.com/users/3625350/raunak-thomas"}, "is_accepted": true, "score": 0, "last_activity_date": 1527061428, "creation_date": 1527061428, "answer_id": 50482612, "question_id": 50482535, "link": "https://stackoverflow.com/questions/50482535/column-filter-by-vba-code/50482612#50482612", "title": "Column filter by VBA code", "body": "<p>Comparisons should be made between dates, not strings, assuming that your column <code>Q</code> and the 2 input cells are formatted as a date </p>\n\n<p>just change your code to </p>\n\n<pre><code>Dim lngStart As date, lngEnd As date\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1527063134, "post_id": 50482783, "comment_id": 87979201, "body": "That code snippet doesn&#39;t work with the variables declared as <code>Date</code> when the dates are in UK <code>dd&#47;mm&#47;yyyy</code> format, without further processing of date format to pass to the filter. Excel treats dates as a number, so using the <code>Double</code> data type safely ignores the local date format."}], "tags": [], "owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "is_accepted": false, "score": 0, "last_activity_date": 1527061950, "creation_date": 1527061950, "answer_id": 50482783, "question_id": 50482535, "link": "https://stackoverflow.com/questions/50482535/column-filter-by-vba-code/50482783#50482783", "title": "Column filter by VBA code", "body": "<p>You've defined <code>lngStart</code> and <code>lngEnd</code> as <code>Long</code> which is a whole number - so the time element of your parameters is ignored, and datetimes > 12:00pm are 'rounded' up to the next day.</p>\n\n<p>Change these to type <code>Double</code> and your code works as intended:</p>\n\n<pre><code>Public Sub MyFilter()\n    Dim dStart As Double, dEnd As Double\n    dStart = Range(\"b1\").Value 'assume this is the start date\n    dEnd = Range(\"b2\").Value 'assume this is the end date\n    Range(\"q:q\").AutoFilter field:=1, _\n        Criteria1:=\"&gt;=\" &amp; dStart, _\n        Operator:=xlAnd, _\n        Criteria2:=\"&lt;=\" &amp; dEnd\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 6500122, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0c0ce4bbbd979de5044576cab35fb3f5?s=128&d=identicon&r=PG&f=1", "display_name": "Avi22", "link": "https://stackoverflow.com/users/6500122/avi22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 50482612, "answer_count": 2, "score": 0, "last_activity_date": 1527061950, "creation_date": 1527061197, "last_edit_date": 1531164843, "question_id": 50482535, "link": "https://stackoverflow.com/questions/50482535/column-filter-by-vba-code", "title": "Column filter by VBA code", "body": "<p>I want to filter date column with VBA code but im getting wrong results.</p>\n\n<p>My data (example only, I have many rows):</p>\n\n<pre><code>complete_date\n(blank)\n(blank)\n(blank)\n(blank)\n(blank)\n(blank)\n5/12/18 9:08 AM\n5/12/18 9:41 AM\n5/20/18 1:51 PM\n(blank)\n(blank)\n(blank)\n(blank)\n5/20/18 1:50 PM\n5/20/18 1:52 PM\n5/21/18 6:35 AM\n5/20/18 1:49 PM\n5/20/18 1:54 PM\n5/21/18 7:53 AM\n5/20/18 1:49 PM\n5/20/18 1:56 PM\n5/21/18 11:20 AM\n5/20/18 1:49 PM\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>Public Sub MyFilter()\n    Dim lngStart As Long, lngEnd As Long\n    lngStart = Range(\"b1\").Value 'assume this is the start date\n    lngEnd = Range(\"b2\").Value 'assume this is the end date\n    Range(\"q:q\").AutoFilter field:=1, _\n        Criteria1:=\"&gt;=\" &amp; lngStart, _\n        Operator:=xlAnd, _\n        Criteria2:=\"&lt;=\" &amp; lngEnd\nEnd Sub\n</code></pre>\n\n<p>For this example if im filtering according below dates im not getting all possible results ( I do not see any results from 5/20 day).\nMy search:</p>\n\n<p>5/20/18 13:51  ---> start time\n5/22/18 13:51  ---> end time</p>\n\n<p>Any idea why? Thanks,</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9298223"}, "edited": false, "score": 0, "creation_date": 1527061768, "post_id": 50482445, "comment_id": 87978325, "body": "No capitalization in the title, no content, unformatted code.  I can&#39;t even give you an E for effort.  You should read  [how to ask}.  In the future please put forth some effort.  Honestly, I shouldn&#39;t have edited your post or posted an answer."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1527063172, "post_id": 50482445, "comment_id": 87979224, "body": "<code>Updatable</code> rather than <code>Update</code>?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9298223"}, "is_accepted": false, "score": 0, "last_activity_date": 1527061517, "creation_date": 1527061517, "answer_id": 50482646, "question_id": 50482445, "link": "https://stackoverflow.com/questions/50482445/ms-access-error-91-object-variable-or-with-block-variable-not-set/50482646#50482646", "title": "MS Access Error 91: Object variable or With block variable not set", "body": "<p>The database variable is not set.</p>\n\n<pre><code>Private Sub Cmdsave_Click()\n    Dim db As database\n    Set db = CurrentDb\n    For i = 0 To LISTQTY.ListCount - 1 Step 1\n        db.Execute \"Updatable tblstock set boxQty = boxQty + \" &amp; LISTQTY.Column(1, i) &amp; \"  where PID=\" &amp; Me.LISTQTY.Column(0, i) &amp; \"\"\n    Next\nEnd Sub\n</code></pre>\n\n<p>Or just use the <code>CurrentDb</code></p>\n\n<blockquote>\n<pre><code>CurrentDb..Execute \"Updatable tblstock set boxQty = boxQty + \" &amp; LISTQTY.Column(1, i) &amp; \"  where PID=\" &amp; Me.LISTQTY.Column(0, i) &amp; \"\"\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 9447182, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rlfUyVLtOLM/AAAAAAAAAAI/AAAAAAAAANI/8QQIAxt0FqE/photo.jpg?sz=128", "display_name": "vivekananda reddy vicky", "link": "https://stackoverflow.com/users/9447182/vivekananda-reddy-vicky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 904, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527062831, "creation_date": 1527060915, "last_edit_date": 1527062831, "question_id": 50482445, "link": "https://stackoverflow.com/questions/50482445/ms-access-error-91-object-variable-or-with-block-variable-not-set", "title": "MS Access Error 91: Object variable or With block variable not set", "body": "<p>Error 91: Object variable or With block variable not set is thrown when I run this code:</p>\n\n<pre><code>Private Sub Cmdsave_Click()\n    Dim db As database\n    For i = 0 To LISTQTY.ListCount - 1 Step 1\n        db.Execute \"Updatable tblstock set boxQty = boxQty + \" &amp; LISTQTY.Column(1, i) &amp; \"  where PID=\" &amp; Me.LISTQTY.Column(0, i) &amp; \"\"\n        'CurrentDb.Updatable\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "conditional-statements"], "comments": [{"owner": {"reputation": 302, "user_id": 3637481, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cdbbf2770a9f599b23bca1fb11955693?s=128&d=identicon&r=PG&f=1", "display_name": "ygaft", "link": "https://stackoverflow.com/users/3637481/ygaft"}, "edited": false, "score": 0, "creation_date": 1527060854, "post_id": 50482163, "comment_id": 87977748, "body": "First you can combine your if statements with or, this will reduce iterations by half. Second why not to use PowerQuery?"}, {"owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "reply_to_user": {"reputation": 302, "user_id": 3637481, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cdbbf2770a9f599b23bca1fb11955693?s=128&d=identicon&r=PG&f=1", "display_name": "ygaft", "link": "https://stackoverflow.com/users/3637481/ygaft"}, "edited": false, "score": 0, "creation_date": 1527061840, "post_id": 50482163, "comment_id": 87978378, "body": "@ygaft OP can&#39;t combine the <code>If</code> statements with <code>Or</code> since the code needs to do two different things depending on which condition is met."}, {"owner": {"reputation": 302, "user_id": 3637481, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cdbbf2770a9f599b23bca1fb11955693?s=128&d=identicon&r=PG&f=1", "display_name": "ygaft", "link": "https://stackoverflow.com/users/3637481/ygaft"}, "reply_to_user": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "edited": false, "score": 0, "creation_date": 1527062080, "post_id": 50482163, "comment_id": 87978556, "body": "@DirtyDeffy yeap, you are correct, well then PowerQuery should be the easiest solution..."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8314942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bb135be321f7512aabd1791eabd635?s=128&d=identicon&r=PG&f=1", "display_name": "masterdata", "link": "https://stackoverflow.com/users/8314942/masterdata"}, "edited": false, "score": 0, "creation_date": 1527069863, "post_id": 50482876, "comment_id": 87983825, "body": "This should do the trick! Do you have any suggestions on how I should insert the rows from the array lists? I can only come up with some sort of loop solution, which (I guess) would offset all the benefits of including the rows to these array lists in the first place."}, {"owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "reply_to_user": {"reputation": 27, "user_id": 8314942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bb135be321f7512aabd1791eabd635?s=128&d=identicon&r=PG&f=1", "display_name": "masterdata", "link": "https://stackoverflow.com/users/8314942/masterdata"}, "edited": false, "score": 0, "creation_date": 1527085078, "post_id": 50482876, "comment_id": 87994287, "body": "Sorry for the late reply. Work. A loop is indeed required since you&#39;re copying entire rows. If you were only copying cell content in, say columns 1:5, you could just insert the array content in one go. However, this should not offset all the benefits of using arrays, since your code now switches much less between accessing the given documents, which is a costly operation."}], "tags": [], "owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "is_accepted": false, "score": 0, "last_activity_date": 1527084901, "last_edit_date": 1527084901, "creation_date": 1527062223, "answer_id": 50482876, "question_id": 50482163, "link": "https://stackoverflow.com/questions/50482163/copy-and-paste-rows-that-meet-a-condition-to-a-different-workbook-at-once/50482876#50482876", "title": "Copy and paste rows that meet a condition to a different workbook at once", "body": "<p>1) Set <code>Application.ScreenUpdating = False</code> </p>\n\n<p>2) You could stick all the rows into an array instead of copying the rows one by one and then insert them all at once when the loop is finished. It's the insertion that takes time, not so much the copying.</p>\n\n<p>Try this:</p>\n\n<pre><code>Dim newWorkbookOne As Workbook, newWorkbookTwo As Workbook\nDim conditionOne As String, conditionTwo as String\nDim arr1 (0 to 999) as Variant ' change parameters as required\nDim arr2 (0 to 999) as Variant ' change parameters as required\nDim j as Integer, n as Integer\n\na = Worksheets(\"Sheet1\").Cells(Rows.Count, 2).End(xlUp).Row\nSet newWorkbookOne = Workbooks.Add\nSet newWorkbookTwo = Workbooks.Add\n\nSet conditionOne = \"value1\"\nSet conditionTwo = \"value2\"\nFor i = 2 To a\n    If ThisWorkbook.Worksheets(\"Sheet1\").Cells(i, 1).Value = conditionOne Then\n    arr(j) = ThisWorkbook.Worksheets(\"Sheet1\").Rows(i)\n    j = j + 1\nEnd If\nIf ThisWorkbook.Worksheets(\"Sheet1\").Cells(i, 1).Value = nametwo Then\n    arr2(n) = ThisWorkbook.Worksheets(\"Sheet1\").Rows(i)\n    n = n + 1\nEnd If\nNext 'something\n\n' Insert the values of the arrays in the two new worksheets here\n</code></pre>\n\n<p><strong>Edit #1: Inserting the array values</strong> </p>\n\n<pre><code>lastRow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row ' change sheet to what's appropriate\n\nFor i = LBound(arr) To UBound(arr)\n    Rows(lastRow + 1 + i).Value2 = arr(i) ' presupposes the array starts at index 0\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 8314942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bb135be321f7512aabd1791eabd635?s=128&d=identicon&r=PG&f=1", "display_name": "masterdata", "link": "https://stackoverflow.com/users/8314942/masterdata"}, "edited": false, "score": 0, "creation_date": 1527066086, "post_id": 50482898, "comment_id": 87981186, "body": "this actually decreased the processing time from 90 seconds to 25 seconds when having eight different conditions and workbooks."}, {"owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "reply_to_user": {"reputation": 27, "user_id": 8314942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bb135be321f7512aabd1791eabd635?s=128&d=identicon&r=PG&f=1", "display_name": "masterdata", "link": "https://stackoverflow.com/users/8314942/masterdata"}, "edited": false, "score": 0, "creation_date": 1527067687, "post_id": 50482898, "comment_id": 87982327, "body": "Awesome - just by turning off <code>ScreenUpdating</code> or did you implement my suggestion aswell?"}, {"owner": {"reputation": 27, "user_id": 8314942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bb135be321f7512aabd1791eabd635?s=128&d=identicon&r=PG&f=1", "display_name": "masterdata", "link": "https://stackoverflow.com/users/8314942/masterdata"}, "edited": false, "score": 0, "creation_date": 1527068805, "post_id": 50482898, "comment_id": 87983121, "body": "Just by turning off ScreenUpdating but I&#39;ll try implement your suggestions as well."}], "tags": [], "owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "is_accepted": false, "score": 1, "last_activity_date": 1527062287, "creation_date": 1527062287, "answer_id": 50482898, "question_id": 50482163, "link": "https://stackoverflow.com/questions/50482163/copy-and-paste-rows-that-meet-a-condition-to-a-different-workbook-at-once/50482898#50482898", "title": "Copy and paste rows that meet a condition to a different workbook at once", "body": "<p>Start off by making sure that <code>ScreenUpdating</code> is turned off like this:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\nApplication.ScreenUpdating = False\n    a = Worksheets(\"Sheet1\").Cells(Rows.Count, 2).End(xlUp).Row\n    Dim newWorkbookOne As Workbook, newWorkbookTwo As Workbook\n    Set newWorkbookOne = Workbooks.Add\n    Set newWorkbookTwo = Workbooks.Add\n    Dim conditionOne As String, conditionTwo as String\n    Set conditionOne = \"value1\"\n    Set conditionTwo = \"value2\"\n    For i = 2 To a\n        If ThisWorkbook.Worksheets(\"Sheet1\").Cells(i, 1).Value = conditionOne Then\n        ThisWorkbook.Worksheets(\"Sheet1\").Rows(i).Copy\n        b = newWorkbookOne.ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n        newWorkbookOne.ActiveSheet.Cells(b + 1, 1).PasteSpecial xlPasteValuesAndNumberFormats\n    End If\n    If ThisWorkbook.Worksheets(\"Sheet1\").Cells(i, 1).Value = nametwo Then\n        ThisWorkbook.Worksheets(\"Sheet1\").Rows(i).Copy\n        h = newWorkbook.ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n        newWorkbookTwo.ActiveSheet.Cells(h + 1, 1).PasteSpecial xlPasteValuesAndNumberFormats\n\n    End If\n  Next 'something\n  Application.ScreenUpdating = True\n</code></pre>\n\n<p>This should reduce the time consumption drastically.  </p>\n\n<p>Furthermore, if you wish to do it differently, you could consider running the first <code>If</code> statement through and hide all rows that you dont want to copy. Then copy and paste all visible rows in the relevant range in one go. Then unhide those and run the second <code>If</code> statement the same way.<br>\nTry it yourself, and let me know if you need help :)</p>\n"}], "owner": {"reputation": 27, "user_id": 8314942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bb135be321f7512aabd1791eabd635?s=128&d=identicon&r=PG&f=1", "display_name": "masterdata", "link": "https://stackoverflow.com/users/8314942/masterdata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 710, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1527084901, "creation_date": 1527059946, "last_edit_date": 1527084603, "question_id": 50482163, "link": "https://stackoverflow.com/questions/50482163/copy-and-paste-rows-that-meet-a-condition-to-a-different-workbook-at-once", "title": "Copy and paste rows that meet a condition to a different workbook at once", "body": "<p>I would need to past rows from masterfile(thisworkbook) to different workbooks based on id. Issue that I am currently having with my code is that it's too slow to copy and paste all the rows one by one, since the masterfile is quite big and I would like to add more conditions (and workbooks) to my code afterwards. </p>\n\n<p>My current code, copying and pasting rows one by one whenever the condition is met:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n    a = Worksheets(\"Sheet1\").Cells(Rows.Count, 2).End(xlUp).Row\n    Dim newWorkbookOne As Workbook, newWorkbookTwo As Workbook\n    Set newWorkbookOne = Workbooks.Add\n    Set newWorkbookTwo = Workbooks.Add\n    Dim conditionOne As String, conditionTwo as String\n    Set conditionOne = \"value1\"\n    Set conditionTwo = \"value2\"\n    For i = 2 To a\n        If ThisWorkbook.Worksheets(\"Sheet1\").Cells(i, 1).Value = conditionOne Then\n        ThisWorkbook.Worksheets(\"Sheet1\").Rows(i).Copy\n        b = newWorkbookOne.ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n        newWorkbookOne.ActiveSheet.Cells(b + 1, 1).PasteSpecial xlPasteValuesAndNumberFormats\n    End If\n    If ThisWorkbook.Worksheets(\"Sheet1\").Cells(i, 1).Value = nametwo Then\n        ThisWorkbook.Worksheets(\"Sheet1\").Rows(i).Copy\n        h = newWorkbook.ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n        newWorkbookTwo.ActiveSheet.Cells(h + 1, 1).PasteSpecial xlPasteValuesAndNumberFormats\n\n    End If\n  Next 'something\n</code></pre>\n\n<p>This code is quite time consuming and definately not suitable for larger files. For this reason, I would like to paste all the rows to these new workbooks at once. Does anyone have solution on this matter?</p>\n"}, {"tags": ["vba", "msxml"], "answers": [{"comments": [{"owner": {"reputation": 180, "user_id": 9208302, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9c35d63bc17c24906d4d88921fd1c31b?s=128&d=identicon&r=PG&f=1", "display_name": "saransh", "link": "https://stackoverflow.com/users/9208302/saransh"}, "edited": false, "score": 0, "creation_date": 1527077090, "post_id": 50485468, "comment_id": 87988622, "body": "Hi,Ryszard J\u0119draszyk &amp; SIM thanks for the reply, your boath macro working fine."}], "tags": [], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "is_accepted": true, "score": 1, "last_activity_date": 1527069969, "creation_date": 1527069969, "answer_id": 50485468, "question_id": 50481767, "link": "https://stackoverflow.com/questions/50481767/vba-code-to-get-table-from-webpage-to-excel/50485468#50485468", "title": "Vba code to get table from webpage to excel", "body": "<p>Where did you get an idea to use <code>getElementsByTagName(\"table\")</code>, while there is no single <code>table</code> tag on this page? It's all DIVs.</p>\n\n<p>I operate on <code>HTMLDocument</code> which requires reference to Microsoft HTML Object Library, <code>Set html = CreateObject(\"htmlfile\")</code> gave me an object which didn't allow <code>getElementsByClassName</code>.</p>\n\n<p>I removed all (now) redundant variable declarations.</p>\n\n<pre><code>Option Explicit\n\nSub Web_Table_Option_One()\n\n    Dim xml As Object\n    Dim html As New HTMLDocument\n    Dim myTable As HTMLObjectElement\n    Dim result As String\n    Dim rowNum As Long\n    Dim colNum As Long      \n\n    Set xml = CreateObject(\"MSXML2.XMLHTTP.6.0\")\n\n    With xml\n        .Open \"GET\", \"https://www.99acres.com/microsite/ambey-group-eco-valley-new-town-kolkata-east/\", False\n        .Send\n    End With\n\n    result = xml.responseText\n\n    html.body.innerHTML = result\n    Set myTable = html.getElementsByClassName(\"divTableBody\")(0)\n\n    With ThisWorkbook.Sheets(\"Sheet3\")\n        For rowNum = 0 To myTable.Children.Length - 1\n            For colNum = 0 To myTable.Children(rowNum).Children.Length - 1\n                .Cells(rowNum + 1, colNum + 1) = myTable.Children(rowNum).Children(colNum).innerText\n            Next colNum\n        Next rowNum\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527083759, "post_id": 50486798, "comment_id": 87993396, "body": "Very nice there +1"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527091496, "post_id": 50486798, "comment_id": 87998712, "body": "Thanks for the kind words @QHarr."}], "tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": false, "score": 1, "last_activity_date": 1527073548, "creation_date": 1527073548, "answer_id": 50486798, "question_id": 50481767, "link": "https://stackoverflow.com/questions/50481767/vba-code-to-get-table-from-webpage-to-excel/50486798#50486798", "title": "Vba code to get table from webpage to excel", "body": "<p>You were after the wrong tag names. However, the below approach can fetch you the tabular data from that page:</p>\n\n<pre><code>Sub FetchTable()\n    Dim HTTP As New XMLHTTP60, HTML As New HTMLDocument\n    Dim trow As HTMLDivElement, tcel As HTMLDivElement, R&amp;, C&amp;\n\n    With HTTP\n        .Open \"GET\", \"https://www.99acres.com/microsite/ambey-group-eco-valley-new-town-kolkata-east/\", False\n        .send\n        HTML.body.innerHTML = .responseText\n    End With\n\n    For Each trow In HTML.getElementsByClassName(\"divTableBody\")(0).Children\n        For Each tcel In trow.getElementsByClassName(\"divTableCell\")\n            C = C + 1: Cells(R + 1, C) = tcel.innerText\n        Next tcel\n        C = 0: R = R + 1\n    Next trow\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 180, "user_id": 9208302, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9c35d63bc17c24906d4d88921fd1c31b?s=128&d=identicon&r=PG&f=1", "display_name": "saransh", "link": "https://stackoverflow.com/users/9208302/saransh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1868, "favorite_count": 0, "accepted_answer_id": 50485468, "answer_count": 2, "score": 1, "last_activity_date": 1527073548, "creation_date": 1527058729, "question_id": 50481767, "link": "https://stackoverflow.com/questions/50481767/vba-code-to-get-table-from-webpage-to-excel", "title": "Vba code to get table from webpage to excel", "body": "<p>I am trying to get table from webpage to excel but no result and also i am not getting any error message.Below is the code which i have try.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub Web_Table_Option_One()\r\nDim xml    As Object\r\nDim html   As Object\r\nDim objTable As Object\r\nDim result As String\r\nDim lRow As Long\r\nDim lngTable As Long\r\nDim lngRow As Long\r\nDim lngCol As Long\r\nDim ActRw As Long\r\nSet xml = CreateObject(\"MSXML2.XMLHTTP.6.0\")\r\nWith xml\r\n.Open \"GET\", \"https://www.99acres.com/microsite/ambey-group-eco-valley-new-town-kolkata-east/\", False\r\n.Send\r\nEnd With\r\nresult = xml.responseText\r\nSet html = CreateObject(\"htmlfile\")\r\nhtml.body.innerHTML = result\r\nSet objTable = html.getElementsByTagName(\"table\")\r\n For lngTable = 0 To objTable.Length - 1\r\n        For lngRow = 0 To objTable(lngTable).Rows.Length - 1\r\n            For lngCol = 0 To objTable(lngTable).Rows(lngRow).Cells.Length - 1\r\n                ThisWorkbook.Sheets(\"Sheet3\").Cells(ActRw + lngRow + 1, lngCol + 1) = objTable(lngTable).Rows(lngRow).Cells(lngCol).innerText\r\n            Next lngCol\r\n        Next lngRow\r\n        ActRw = ActRw + objTable(lngTable).Rows.Length + 1\r\n    Next lngTable\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I want to get table as shown in below pic</p>\n\n<p><a href=\"https://i.stack.imgur.com/9wejn.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9wejn.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "winforms", "excel"], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1527060139, "creation_date": 1527060139, "answer_id": 50482218, "question_id": 50481165, "link": "https://stackoverflow.com/questions/50481165/how-to-add-list-boxes-and-text-boxes-in-excel-vba-userforms-dynamically-as-neede/50482218#50482218", "title": "How to add list boxes and text boxes in Excel VBA Userforms dynamically as needed?", "body": "<p>A lot of examples and tutorials how to add controls dynamically can be found, for example  </p>\n\n<p><a href=\"https://stackoverflow.com/questions/46980677/how-to-create-controls-dynamically-at-runtime\">how-to-create-controls-dynamically-at-runtime</a><br>\n<a href=\"https://stackoverflow.com/questions/563972/adding-controls-to-a-frame-in-an-excel-userform-with-vba\">adding-controls-to-a-frame-in-an-excel-userform-with-vba</a><br>\n<a href=\"http://www.globaliconnect.com/excel/index.php?option=com_content&amp;view=article&amp;id=125:userforms-in-excel-vba-userform-basics-add-controls-dynamically-at-run-time-using-the-add-method-userform-controls-a-snapshot&amp;catid=79&amp;Itemid=475\" rel=\"nofollow noreferrer\">vba-userform-basics-add-controls-dynamically-at-run-time</a></p>\n\n<p>However, depending on the maximum number of lines, maybe it is a better solution to create all the controls at design time, set the <code>Visible</code>-property to <code>false</code> and change it to <code>true</code> when needed. </p>\n"}, {"tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": false, "score": 0, "last_activity_date": 1527097873, "last_edit_date": 1527097873, "creation_date": 1527060398, "answer_id": 50482292, "question_id": 50481165, "link": "https://stackoverflow.com/questions/50481165/how-to-add-list-boxes-and-text-boxes-in-excel-vba-userforms-dynamically-as-neede/50482292#50482292", "title": "How to add list boxes and text boxes in Excel VBA Userforms dynamically as needed?", "body": "<p>You can add controls based on the label click in the UserForm code.\nYou'll have to maintain a count of rows in order to utilize that to position them neatly and to move this label from your example down (otherwise it'll be hidden behind the textboxes you add).</p>\n\n<p>Sample code for the UserForm:</p>\n\n<pre><code>Private rowCount As Integer 'To keep track of rows.\nPrivate Sub UserForm_Initialize()\n    rowCount = 1\nEnd Sub\n\nPrivate Sub LabelAddRow_Click() 'Event handler: Add row on click of label.\n    Dim tb As Control\n    rowCount = rowCount + 1\n    Set tb = Me.Controls.Add(\"Forms.TextBox.1\", \"textBox\" &amp; rowCount &amp; \"left\", True) 'Add left TextBox.\n    With tb 'Position and size it:\n        .Top = 25 + (rowCount * 25) + 10\n        .Left = 25\n        .Height = 25\n        .Width = 100\n    End With\n    Set tb = Me.Controls.Add(\"Forms.TextBox.1\", \"textBox\" &amp; rowCount &amp; \"right\", True) 'Same for the right one:\n    With tb\n        .Top = 25 + (rowCount * 25) + 10\n        .Left = 150\n        .Height = 25\n        .Width = 100\n    End With\n    LabelAddRow.Top = LabelAddRow.Top + 25 'Move the label down.\nEnd Sub\n</code></pre>\n\n<p>You might want to add something to the height of the <code>UserForm</code> too, to make it grow with the added controls. Also you might want to reposition other controls that are below the TextBoxes.</p>\n\n<p>If you want to <em>automatically</em> add rows when the last box has been filled out, you're going to need to add some events to the newly added controls, however that's not the main issue listed in the question.</p>\n\n<p><em>Edit</em>: The above is obviously based on your last image, since that's the \"quick win\"; dealing with the events of dynamically added TextBoxes will add additional complexity. If you decide to take that route, I suggest to have a go at this first and post new questions as they come along.</p>\n"}], "owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 562, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1527097873, "creation_date": 1527056594, "last_edit_date": 1527059460, "question_id": 50481165, "link": "https://stackoverflow.com/questions/50481165/how-to-add-list-boxes-and-text-boxes-in-excel-vba-userforms-dynamically-as-neede", "title": "How to add list boxes and text boxes in Excel VBA Userforms dynamically as needed?", "body": "<p>I do not know if this is appropriate to place in stackoverflow despite being VBA related--particularly in the UserForms area, however, I cannot visualize at all how i'm going to code this.</p>\n\n<p>My Excel worksheet is shown below:\n<a href=\"https://i.stack.imgur.com/9krr2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9krr2.png\" alt=\"Excel Worksheet\"></a></p>\n\n<p>The UserForm I created to input the data is as shown below:\n<a href=\"https://i.stack.imgur.com/CAqKN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CAqKN.png\" alt=\"UserForm\"></a></p>\n\n<p>However, what I want to achieve is similar to how QuickBooks does it where the <code>Amount Due</code> is automatically distributed among the <code>Expense Accounts</code> without having to input them 1 by 1 as shown in the first image (My excel worksheet). Also, when there are more expense accounts than usual (e.g. 10 expense accounts, Quickbooks will automatically add new rows for that purpose). A sample is shown below:\n<a href=\"https://i.stack.imgur.com/d1IGE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/d1IGE.png\" alt=\"Quickbooks Sample\"></a></p>\n\n<p>My main issue is that I do not know how to let UserForms dynamically add more rows if I need to do so. It can be automatically add rows when all previous rows are filled or something as shown in the image below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3mYGV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3mYGV.png\" alt=\"Ideal Form\"></a></p>\n\n<p>Let <code>n</code> be the number of expense accounts</p>\n\n<p>So from having to input <code>n*2</code> (or in my case 4 values):</p>\n\n<p>Telephone/Insurance Expense: 40,000</p>\n\n<p>Cash in Bank 40,000</p>\n\n<p>Water Expense: 40,000</p>\n\n<p>Cash in Bank: 40,000</p>\n\n<p>I can to simplify it to <code>n+1</code> inputs (or in my case 3 inputs):</p>\n\n<p>Amount Due: 80,000</p>\n\n<p>Telephone/Insurance Expense: 40,000</p>\n\n<p>Water Expense 40,000</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1527055506, "post_id": 50480861, "comment_id": 87974867, "body": "The only way to force user to enable macros is to save your file as an Add-in and load it into Add-ins collection."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1527055726, "post_id": 50480861, "comment_id": 87974956, "body": "If the file is an add-in each user will have their own copy of the file in their add-in folder. And that won&#39;t work. The idea is to share the same file."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1527055787, "post_id": 50480861, "comment_id": 87974987, "body": "You can share data (not a file) between users by using Add-in ;) I&#39;ve been doing it before successfuly."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1527056103, "post_id": 50480861, "comment_id": 87975132, "body": "I did think about that prior but the file is pretty large. it has about 20 sheets with cell colors everywhere and about 6 MB of data. It will very heavy to store the data externaly in a different file. But yes I have also done something similar earlier."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1527056507, "post_id": 50480861, "comment_id": 87975324, "body": "This (20 sheets, colored cells, etc.) changes nothing. I&#39;d suggest to separate <a href=\"https://en.wikipedia.org/wiki/Business_logic\" rel=\"nofollow noreferrer\">Bussines Logic Layer</a> and <a href=\"https://en.wikipedia.org/wiki/Data_access_layer\" rel=\"nofollow noreferrer\">Data Access Layer</a>. This is the power of <a href=\"https://en.wikipedia.org/wiki/Object-oriented_programming\" rel=\"nofollow noreferrer\">OOP</a>."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1527056862, "post_id": 50480861, "comment_id": 87975494, "body": "@MaciejLos I think I actually found the solution. <code>SetAttr Application.ActiveWorkbook.FullName, vbReadonly</code> actually sets the tickmark in the properties and is saved on the file without saving."}], "answers": [{"tags": [], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "is_accepted": false, "score": 2, "last_activity_date": 1527057462, "creation_date": 1527057462, "answer_id": 50481385, "question_id": 50480861, "link": "https://stackoverflow.com/questions/50480861/excel-only-when-vba-is-enabled-it-should-be-possible-to-save-the-file-possible/50481385#50481385", "title": "Excel only when VBA is enabled it should be possible to save the file, possible?", "body": "<p>I found a solution that seems to work.  </p>\n\n<p>You can in <code>Workbook_BeforeClose</code> use this line to make the file read-only in file properties.  </p>\n\n<pre><code>SetAttr Application.ActiveWorkbook.FullName, vbReadonly\n</code></pre>\n\n<p>This will set the tickmark in the properties and Excel will notice the file is writeprotected.  </p>\n\n<p>Then in <code>Workbook_Open()</code> <em>(or as in my case when rights has been established)</em>  </p>\n\n<pre><code>SetAttr Application.ActiveWorkbook.FullName, vbReadwrite\nActiveWorkbook.ChangeFileAccess Mode:=xlReadWrite\n</code></pre>\n\n<p>The first line removes the tickmark in file properties, but Excel still \"remembers\" the file as read-only.<br>\nThe second line will tell Excel to make it ReadWrite and the file works as normal again.</p>\n"}, {"comments": [{"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1527073512, "post_id": 50485845, "comment_id": 87986250, "body": "I&#39;ll have a look at it but I think I earlier found a weakness on this type of method. Will give it a try as soon as I have time. Probably not today just to give you a heads up."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1527141799, "post_id": 50485845, "comment_id": 88016360, "body": "It does work. I was wrong. You used the before save and after save. I didn&#39;t think about that. I was thinking of before close, and that won&#39;t work. In the end I used a combination of the two methods. I show a splashscreen but the workbook is not completly locked down, there are still some sheets visible and the workbook is readonly in properties. I know you can get around it. But then again if someone who is not supposed to save the file does. I&#39;ll have  a little chat with that person."}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": true, "score": 1, "last_activity_date": 1527070895, "creation_date": 1527070895, "answer_id": 50485845, "question_id": 50480861, "link": "https://stackoverflow.com/questions/50480861/excel-only-when-vba-is-enabled-it-should-be-possible-to-save-the-file-possible/50485845#50485845", "title": "Excel only when VBA is enabled it should be possible to save the file, possible?", "body": "<p>This is a <em>far</em> more complicated method than <a href=\"https://stackoverflow.com/a/50481385/9290986\">Adreas'</a>, but doesn't feature the same risk of mildy tech-savvy users just right-clicking the file and popping into the \"Properties\" panel.</p>\n\n<p>Create 2 new worksheets.  One of them is set to <code>xlVeryHidden</code> - for the examples below, I have called it <code>hsSheetStatus</code>.  The other, with a nice large notice telling your <s>hapless minion</s> colleague to enable Macros, will be changing visibility.  I have called this <code>hsEnableNotice</code>.</p>\n\n<p>Then I have a Macro to show <code>hsEnableNotice</code> hide all of the other sheets (storing their visibility and the ActiveSheet on <code>hsSheetStatus</code>), and a second Macro to do the reverse (restore visibility/ActiveSheet from <code>hsSheetStatus</code>) and set these to run on <code>Workbook_BeforeSave</code>, <code>Workbook_AfterSave</code> and <code>Workbook_Open</code>:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_AfterSave(ByVal Success As Boolean)\n    UnlockAndShow\nEnd Sub\n\nPrivate Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    LockAndHide\nEnd Sub\n\nPrivate Sub Workbook_Open()\n    UnlockAndShow\nEnd Sub\n\nPrivate Sub LockAndHide()\n    Dim lSheet As Long, ActiveName As String\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    ActiveName = ThisWorkbook.ActiveSheet.Name\n    hsEnableNotice.Visible = xlSheetVisible\n    hsEnableNotice.Activate\n\n    hsSheetStatus.Range(hsSheetStatus.Cells(1, 1), hsSheetStatus.Cells(hsSheetStatus.Rows.Count, 1)).EntireRow.Delete\n\n    For lSheet = 1 To ThisWorkbook.Sheets.Count 'By using Sheets instead of Worksheets, we include Charts etc\n        hsSheetStatus.Cells(lSheet, 1).Value = ThisWorkbook.Sheets(lSheet).Name\n        hsSheetStatus.Cells(lSheet, 2).Value = ThisWorkbook.Sheets(lSheet).Visible\n        If ThisWorkbook.Sheets(lSheet).Name = ActiveName Then hsSheetStatus.Cells(lSheet, 3).Value = 1\n        If ThisWorkbook.Sheets(lSheet).Name &lt;&gt; hsEnableNotice.Name Then ThisWorkbook.Sheets(lSheet).Visible = xlSheetVeryHidden\n    Next lSheet\n\n    ThisWorkbook.Protect Password:=\"ThisIsMyPassword.ThereAreManyLikeIt,ButThisOneIsMine.\", Structure:=True, Windows:=False\n    Application.EnableEvents = True\nEnd Sub\n\nPrivate Sub UnlockAndShow()\n    Dim WasSaved As Boolean, lSheet As Long, lMax As Long\n    WasSaved = ThisWorkbook.Saved\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n    lMax = hsSheetStatus.Cells(hsSheetStatus.Rows.Count, 1).End(xlUp).Row\n\n    ThisWorkbook.Unprotect Password:=\"ThisIsMyPassword.ThereAreManyLikeIt,ButThisOneIsMine.\"\n    For lSheet = 1 To lMax\n        ThisWorkbook.Sheets(hsSheetStatus.Cells(lSheet, 1).Value).Visible = hsSheetStatus.Cells(lSheet, 2).Value\n        If hsSheetStatus.Cells(lSheet, 3).Value = 1 Then ThisWorkbook.Sheets(hsSheetStatus.Cells(lSheet, 1).Value).Activate\n    Next lSheet\n\n    hsSheetStatus.Visible = xlSheetVeryHidden\n    hsEnableNotice.Visible = xlSheetVeryHidden\n\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\n    ThisWorkbook.Saved = WasSaved\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 50485845, "answer_count": 2, "score": 0, "last_activity_date": 1527070895, "creation_date": 1527055316, "question_id": 50480861, "link": "https://stackoverflow.com/questions/50480861/excel-only-when-vba-is-enabled-it-should-be-possible-to-save-the-file-possible", "title": "Excel only when VBA is enabled it should be possible to save the file, possible?", "body": "<p>I have a file that I made with three levels of permissions.<br>\nYou get prompted to input a password on a userform and you get either admin rights, read/write or only read permissions.<br>\nThat works fine, unless you don't enable macros.  </p>\n\n<p>If you don't enable the macro prompting the userform is not shown and the rights are not set thus you have full access.  </p>\n\n<p>I have seen you can use a splash screen but for that to work you need to save the workbook as far as I understand?<br>\nThe basic concept of them is to beforeclose hide sheets and unhide splash screen, then save the workbook. \nBut what if the user made a mistake and what to close without save and reopen later? The file gets closed with all sheets visible?  </p>\n\n<p>So I thought maybe I can use the \"explorer -> right click -> properties -> Read-only\" attribute as an extra layer of protection?</p>\n\n<p>I found these functions.  </p>\n\n<pre><code>ActiveWorkbook.ChangeFileAccess Mode:=xlreadonly\nActiveWorkbook.ChangeFileAccess Mode:=xlreadwrite \n</code></pre>\n\n<p>But I tried the readonly line and it did set read only, file could not be saved.<br>\nThen I closed the workbook without saving and opened again. But it seems the attribute was not set in the properties of the file since it was not tickmarked and when I opened the file I could save it.  </p>\n\n<p>Is there any other way to solve this?<br>\nI want to either \"force\" VBA on the user or make sure he/she can't save the file if it's opened without VBA.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527055646, "post_id": 50480804, "comment_id": 87974924, "body": "It looks like you are trying to construct a string that consitutes range addresses in different sheets for summation? Is that correct?  I haven&#39;t looked properly but be careful with referring to sheets by index, in case they get moved around."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527056670, "post_id": 50480804, "comment_id": 87975404, "body": "Difficult to debug without some data and more of the code. I have guessed at declarations and put some dummy data in and works for me."}, {"owner": {"reputation": 1, "user_id": 9807395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a95f1ffeebd0a5356b8b6fbbc0bc40d?s=128&d=identicon&r=PG&f=1", "display_name": "Staryun", "link": "https://stackoverflow.com/users/9807395/staryun"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1527058210, "post_id": 50480804, "comment_id": 87976227, "body": "I solved the problem i need a &quot; &#39; &quot; before and after Of the name of the sheet:      suma &amp; &quot; &#39; &quot; &amp;                               sheets(h).name &amp; &quot; &#39; &quot; &amp;      &quot;!&quot;.....etc  The message of &quot;refresh the values of sheets&quot; happens because VBA takes the sheets(h).name as a workbook name without the &quot; &#39; &quot;. Thanks for the answer."}], "owner": {"reputation": 1, "user_id": 9807395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a95f1ffeebd0a5356b8b6fbbc0bc40d?s=128&d=identicon&r=PG&f=1", "display_name": "Staryun", "link": "https://stackoverflow.com/users/9807395/staryun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527055403, "creation_date": 1527055091, "last_edit_date": 1527055403, "question_id": 50480804, "link": "https://stackoverflow.com/questions/50480804/operate-cells-with-other-sheet-with-sheet-cells-format", "title": "operate cells with other sheet with sheet().cells() format", "body": "<p>I need iterate sheets that plus values in their cells in other sheet, the names of the \"sheets\" are save in sheet().index= man_prov and i iterate that. The code works but appears a window that requets \"refresh values to the sheets\" and the objetive cell value finally is \"#\u00bfNAME?\". The code is:</p>\n\n<pre><code>For k = pfila_mprov + 1 To ufila_mprov\n\n    sn = Sheets(man_prov).Cells(k, 2)\n    h = Sheets(sn).Index\n\n    Select Case k\n    Case ufila_mprov\n        suma = suma &amp; \" \" &amp; Sheets(h).Name &amp; \"!\" &amp; Sheets(h).Cells(4, 4).Address &amp; \"\"\n    Case Else\n        suma = suma &amp; \" \" &amp; Sheets(h).Name &amp; \"!\" &amp; Sheets(h).Cells(4, 4).Address &amp; \",\"\n    End Select\n\nNext k\n\nSheets(pro_pack).Cells(16, 4).Formula = \"=sum(\" &amp; suma &amp; \")\"\n\nEnd If\n</code></pre>\n\n<p>i need use the format sheets().cell() to iterate, and finally plus the values saved in \"suma\" .\nThanks.</p>\n"}, {"tags": ["forms", "excel", "validation", "vba"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 2440588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7009bf87eb318483a9a6f35a6f58a715?s=128&d=identicon&r=PG&f=1", "display_name": "user146297", "link": "https://stackoverflow.com/users/2440588/user146297"}, "edited": false, "score": 0, "creation_date": 1527064487, "post_id": 50482429, "comment_id": 87980085, "body": "Thank you for your answer. I had already modified my code and used a button. Basically the problem was due to incorrect formatting as I had declared wt as double and was reading from a text-box.I am posting my modified code below. It works fine. I also extended it to cover a range of cells."}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "reply_to_user": {"reputation": 79, "user_id": 2440588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7009bf87eb318483a9a6f35a6f58a715?s=128&d=identicon&r=PG&f=1", "display_name": "user146297", "link": "https://stackoverflow.com/users/2440588/user146297"}, "edited": false, "score": 0, "creation_date": 1527076820, "post_id": 50482429, "comment_id": 87988425, "body": "Glad to see it.  I really missed the mark with 0&gt;&lt;1  I use integers almost exclusively and didn&#39;t even consider the world that exists between them.  An observation on your flag.  If you declare it as a boolean and give it a helpful name then you can make plain english statements like : If UserQuit Then Exit    or   If not HeadersMatch Then ErrorFound = true"}, {"owner": {"reputation": 79, "user_id": 2440588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7009bf87eb318483a9a6f35a6f58a715?s=128&d=identicon&r=PG&f=1", "display_name": "user146297", "link": "https://stackoverflow.com/users/2440588/user146297"}, "edited": false, "score": 0, "creation_date": 1527093893, "post_id": 50482429, "comment_id": 87999991, "body": "Thank You @Profoundly Oblivious. I will try that."}], "tags": [], "owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "is_accepted": false, "score": 0, "last_activity_date": 1527060863, "creation_date": 1527060863, "answer_id": 50482429, "question_id": 50480544, "link": "https://stackoverflow.com/questions/50480544/validating-user-form-data-using-excel-vba/50482429#50482429", "title": "Validating User form Data using excel vba", "body": "<p>Many options.  It comes down to your personal preference.</p>\n\n<p>Are you annoyed that you get an error immediately after pressing an invalid key?\nI consider that good behavior.</p>\n\n<p>Are you annoyed that that you get an error when the text box is cleared?\nTry</p>\n\n<pre><code>If wt &gt;= 0 And wt &lt;= 1 Or wt = \"\" Then\nif wt &lt;&gt; \"\" then Range(\"Wt!B2\").Value = wt\n</code></pre>\n\n<p>Personally, I don't consider a text box an appropriate control for essentially a binary choice.  Have  you considered a toggle button?</p>\n"}, {"tags": [], "owner": {"reputation": 79, "user_id": 2440588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7009bf87eb318483a9a6f35a6f58a715?s=128&d=identicon&r=PG&f=1", "display_name": "user146297", "link": "https://stackoverflow.com/users/2440588/user146297"}, "is_accepted": true, "score": 0, "last_activity_date": 1527065395, "last_edit_date": 1527065395, "creation_date": 1527064969, "answer_id": 50483716, "question_id": 50480544, "link": "https://stackoverflow.com/questions/50480544/validating-user-form-data-using-excel-vba/50483716#50483716", "title": "Validating User form Data using excel vba", "body": "<p>The modified code is given below.</p>\n\n<pre><code>Dim flag As Integer\nPrivate Sub CommandButton2_Click()\n\n  If flag = 1 Then\n\n      MsgBox \"Enter values between 0 and 1\"\n  Else\n    Range(\"Wt!B2\").Value = TextBox1.Value\n    Unload Me\n  End If\nEnd Sub\n\n\nPrivate Sub TextBox1_Change()\n Dim wt As Double, new_value As Double\n TextBox1.SetFocus\nIf IsNumeric(TextBox1.Value) Then\n    new_value = CDbl(TextBox1.Value)\nElse\n    new_value = 0\nEnd If\nwt = new_value\nDataValidate (wt)\nEnd Sub\n\nSub DataValidate(wt)\n\nIf wt &gt;= 0 And wt &lt;= 1 Then\n\n   'do nothing\n\nElse\n   flag = 1\n\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 2440588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7009bf87eb318483a9a6f35a6f58a715?s=128&d=identicon&r=PG&f=1", "display_name": "user146297", "link": "https://stackoverflow.com/users/2440588/user146297"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 50483716, "answer_count": 2, "score": 0, "last_activity_date": 1527065395, "creation_date": 1527053818, "last_edit_date": 1531164843, "question_id": 50480544, "link": "https://stackoverflow.com/questions/50480544/validating-user-form-data-using-excel-vba", "title": "Validating User form Data using excel vba", "body": "<p>I am writing code to fill a cell through user form. I need to check if data is between 0 and 1 and prompt user to enter correct data. </p>\n\n<pre><code>Private Sub TextBox1_Change()\nwt = TextBox1.Value\nIf wt &gt;= 0 And wt &lt;= 1 Then\n\n        Range(\"Wt!B2\").Value = wt\n\n Else\n\n         MsgBox \"Enter a number between 0 and 1\"\n\n End If\n End Sub\n</code></pre>\n\n<p>`\nThe code works, but the irritating problem is even before I finish entering a number, the alert pops. How can I avoid it?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 269, "user_id": 9749834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500d6b7f8c456c25aeea5ab782f35af3?s=128&d=identicon&r=PG&f=1", "display_name": "Helloguys", "link": "https://stackoverflow.com/users/9749834/helloguys"}, "is_accepted": false, "score": 0, "last_activity_date": 1527097415, "creation_date": 1527097415, "answer_id": 50494461, "question_id": 50479207, "link": "https://stackoverflow.com/questions/50479207/excel-2016-qat-and-macros/50494461#50494461", "title": "Excel 2016 - QAT and Macros", "body": "<p>I finally figure it out!</p>\n\n<p>Whenever the code referencing an undefined data type, QAT customization won't work.  The symptoms are:</p>\n\n<p>1)  You'll see the workbook name was prefixed to the macro name on the list.  While in normal situation, you'll just see the macro name.</p>\n\n<p>2) If you associate the macro to a QAT button.  That button won't work.  Whenever you click the button, it will say \"<em>Cannot run the macro'XXX'.  The macro may not be available in this workbook or all macros may be disabled</em>\".  This is misleading as the macro is there and all macro is allowed.</p>\n\n<p>You may ask - \"Why your code references some undefined data type?\"  It was because my code reference some additional data types (such as Dictionary) that requires additional library (such as \"Microsoft Scripting Runtime).  If the library reference was not manually configured, the data type will become 'undefined'.</p>\n\n<p>I'm surprised that the program didn't throw compile error or runtime error.  Instead, it gave the message \"macro may not be available for this workbook\".  </p>\n"}], "owner": {"reputation": 269, "user_id": 9749834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500d6b7f8c456c25aeea5ab782f35af3?s=128&d=identicon&r=PG&f=1", "display_name": "Helloguys", "link": "https://stackoverflow.com/users/9749834/helloguys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527097415, "creation_date": 1527044656, "last_edit_date": 1531161705, "question_id": 50479207, "link": "https://stackoverflow.com/questions/50479207/excel-2016-qat-and-macros", "title": "Excel 2016 - QAT and Macros", "body": "<p>I built some macros and save the VBA project as .xlam (Excel Add In) file.  The macros (Public Subs) are visible when I go to Excel > File > Options > Quick Access Toolbar(QAT) > Choose 'Macros' from the left drop-down menu.  Then I can add the macros to the QAT so users can click the tools icon to run those macros.</p>\n\n<p>I observed a VERY strange behavior.  Here's what it was before, everything was normal.</p>\n\n<p><a href=\"https://i.stack.imgur.com/5g3Gu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5g3Gu.jpg\" alt=\"Quick Access Toolbar Customization\"></a>\n<a href=\"https://i.stack.imgur.com/tzocb.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tzocb.jpg\" alt=\"VBA Editor\"></a></p>\n\n<p>Here's what it was after.  Things start getting weird.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Q0WRq.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Q0WRq.jpg\" alt=\"QAT After\"></a>\n<a href=\"https://i.stack.imgur.com/NfybG.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NfybG.jpg\" alt=\"Editor After\"></a></p>\n\n<p>The only difference is I changed a Sub's argument type from a built-in variable type to a custom class type.  But I haven't run the macro yet.  I'm just entering the code.  But Excel changed the display on two other macros I'm NOT editing (macro names are Check() and CheckAndFix()).</p>\n\n<p>So the questions are:</p>\n\n<p>1) Why Excel GUI displays different formats while I'm entering the code?  And it seem to depends on the variable type I'm typing?  I didn't know that IntelliSense had such an influence on the Excel user interface.</p>\n\n<p>2) Why Excel changed the display of two other Subs that I didn't touch?</p>\n\n<p>By the way, this behavior is reproducible even after computer reboot.  i.e. I can change the argument type between String and cSettings and observed the macro list format changed accordingly.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["regex", "vba", "ms-word"], "comments": [{"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1527045702, "post_id": 50479205, "comment_id": 87972153, "body": "Please provide an example of the input and the expected match."}, {"owner": {"reputation": 95, "user_id": 583774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QEPuU.jpg?s=128&g=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/583774/allan"}, "reply_to_user": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1527045820, "post_id": 50479205, "comment_id": 87972177, "body": "52 52  52. $52.52 ($) ($52) ($5.52)  the above should highlight any dollar sign $ followed by a digit.  When there is a hyper link present such as www.adsfasdf.com or asdf@asdfasdf.com preceded or followed by arbitrary contents $123.12, the incorrect contents are highlighted by some seemingly random offset, again, only inside MS word"}, {"owner": {"reputation": 95, "user_id": 583774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QEPuU.jpg?s=128&g=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/583774/allan"}, "reply_to_user": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1527046156, "post_id": 50479205, "comment_id": 87972258, "body": "specifically, here are some links that may be helpful: www.smithany.com/test.docx and www.smithany.com/wordusd1.jpg and www.smithany.com/wordhighlighterrun.jpg and also www.smithany.com/whatactuallyhappens.jpg"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1527048855, "post_id": 50479205, "comment_id": 87972799, "body": "Put simply, you can&#39;t rely on the <code>Range.Start</code> and <code>.End</code> properties as &quot;set&quot; values. Word has too many non-printing (and non-visible) characters in the document that simply cannot be factored in. For hyperlinks, those are field codes. Does Word&#39;s wildcard find not work?"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 1, "creation_date": 1527052690, "post_id": 50479205, "comment_id": 87973870, "body": "Is there a reason you can&#39;t use a <i>wildcard</i> Find in Word for this? In your MSDN post you seem to think that can&#39;t be used to find dates or dollar amounts, neither of which is true. A <i>wildcard</i> Find in Word in Word would have no trouble identifying the ranges correctly."}, {"owner": {"reputation": 95, "user_id": 583774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QEPuU.jpg?s=128&g=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/583774/allan"}, "edited": false, "score": 0, "creation_date": 1527085047, "post_id": 50479205, "comment_id": 87994267, "body": "The MSDN article was not my OP, i just replied.  Without alternation at a minimum, it seems like that&#39;ll be very difficult.  Try this regex (ugly but seems functional).   In Word it&#39;ll be a nightmare if even possible:      (January|February|March|April|May|June|July|August|September&zwnj;&#8203;|October|November|De&zwnj;&#8203;cember|Jan[-\\.]?|Feb&zwnj;&#8203;[-\\.]?|Mar[-\\.]?|Apr&zwnj;&#8203;[-\\.]?|Jun[-\\.]?|Jul&zwnj;&#8203;[-\\.]?|Aug[-\\.]?|Sep&zwnj;&#8203;t?[-\\.]?|Oct[-\\.]?|N&zwnj;&#8203;ov[-\\.]?|Dec[-\\.]?)|&zwnj;&#8203;(\\d{1,2})[\\/-](\\d{1,&zwnj;&#8203;2})(?:[\\/-])?(\\d{4}|&zwnj;&#8203;\\d{2})?\\s?|(\\d{1,2})&zwnj;&#8203;[,\\s][,\\s&#39;]*(\\d{4}|\\&zwnj;&#8203;d{2})|(\\d{1,2})[thsn&zwnj;&#8203;rd]{0,2}[,\\s(?=\\b)][&zwnj;&#8203;,\\s&#39;]*(\\d{4}|\\d{2})?"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 583774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QEPuU.jpg?s=128&g=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/583774/allan"}, "edited": false, "score": 0, "creation_date": 1527084939, "post_id": 50480998, "comment_id": 87994199, "body": "For some reason, on larger documents, I believe any multi page document, your Collection of Word Wildcards subroutine above seems to hang.  I will take a closer look and see if I can make it work on larger documents in which case I would be inclined to mark as an answer.  Certainly my goal here was to be able to use my existing patterns from other sources to match dates (numbers and spelled months), emails etc which often require much broader pattern matching than I believe word can offer."}], "tags": [], "owner": {"reputation": 16007, "user_id": 8291949, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a7pBo.gif?s=128&g=1", "display_name": "wp78de", "link": "https://stackoverflow.com/users/8291949/wp78de"}, "is_accepted": true, "score": 3, "last_activity_date": 1527056986, "last_edit_date": 1527056986, "creation_date": 1527055918, "answer_id": 50480998, "question_id": 50479205, "link": "https://stackoverflow.com/questions/50479205/regex-with-hyperlinks-activedocument-range-and-format/50480998#50480998", "title": "Regex with hyperlinks ActiveDocument.Range and Format", "body": "<p>I had not touched VBA for years but I guess it's like bicycling. </p>\n\n<p>Anyways, here is a sub that should help you out. It's based on Cindy Meister sound recommendation and fills the gap between Regex and Wildcard Find using a collection of match patterns for optional parts. </p>\n\n<p>First, the Wildcard matches: <code>$[0-9,]{1,}</code> and <code>$[0-9,]{1,}.[0-9]{2}</code></p>\n\n<p>It's not that different after all, isn't it? However, to take the optional fraction part into account I have to use two patterns.</p>\n\n<p>And here's the routine:</p>\n\n<pre><code>Sub WildcardsHighlightWords()\n    Dim Word As Range\n    Dim WildcardCollection(2) As String\n    Dim Words As Variant\n    WildcardCollection(0) = \"$[0-9,]{1,}\"\n    WildcardCollection(1) = \"$[0-9,]{1,}.[0-9]{2}\"\n    Options.DefaultHighlightColorIndex = wdYellow\n    'Clear existing formatting and settings in Find\n    Selection.Find.ClearFormatting\n    Selection.Find.Replacement.ClearFormatting\n    'Set highlight to replace setting.\n    Selection.Find.Replacement.Highlight = True\n    'Cycle through document and find wildcards patterns, highlight words when found\n    For Each Word In ActiveDocument.Words\n        For Each WildcardsPattern In WildcardCollection\n            With Selection.Find\n                .Text = WildcardsPattern\n                .Replacement.Text = \"\"\n                .Forward = True\n                .Wrap = wdFindContinue\n                .Format = True\n                .MatchCase = False\n                .MatchWholeWord = False\n                .MatchWildcards = True\n                .MatchSoundsLike = False\n                .MatchAllWordForms = False\n            End With\n            Selection.Find.Execute Replace:=wdReplaceAll\n        Next\n    Next\nEnd Sub\n</code></pre>\n\n<p>It should be easy to extend or modify this approach if needed.</p>\n\n<p>This highlithts the Dollar amounts as desired on my end:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Krp3g.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Krp3g.png\" alt=\"enter image description here\"></a></p>\n\n<p>Note: The separator in the quantifier {n<code>,</code>m} is not the same in all localizations, e.g. it's {n<code>;</code>m} in the German version.</p>\n"}], "owner": {"reputation": 95, "user_id": 583774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QEPuU.jpg?s=128&g=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/583774/allan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "accepted_answer_id": 50480998, "answer_count": 1, "score": 3, "last_activity_date": 1527092049, "creation_date": 1527044647, "last_edit_date": 1527092049, "question_id": 50479205, "link": "https://stackoverflow.com/questions/50479205/regex-with-hyperlinks-activedocument-range-and-format", "title": "Regex with hyperlinks ActiveDocument.Range and Format", "body": "<p>I have seen several other StackOverflow posts such as this one:\n<a href=\"https://stackoverflow.com/questions/25102372/how-to-use-enable-regexp-object-regular-expression-using-vba-macro-in-word\">How to Use/Enable (RegExp object) Regular Expression using VBA (MACRO) in word</a>\non using regular expressions in Microsoft Word with VBA using the Microsoft VB script Regular Expressions 5.5 Reference.</p>\n\n<p>That helped me prepare the following, which I use in Word to highlight US Dollar amounts:</p>\n\n<pre><code>Sub dollarHighlighter()\nSet regExp = New regExp\nDim objMatch As Match\nDim colMatches As MatchCollection\nDim offsetStart As Long\noffsetStart = Selection.Start\nregExp.Pattern = \"\\$([\\,\\d{1,3}]*(?:\\.\\d{2})?)\"\nregExp.Global = True\nSet colMatches = regExp.Execute(Selection.Text)   ' Execute search.\nFor Each objMatch In colMatches   ' Iterate Matches collection.\n  Set myRange = ActiveDocument.Range(objMatch.FirstIndex + offsetStart, \n    End:=offsetStart + objMatch.FirstIndex + objMatch.Length)\n  myRange.FormattedText.HighlightColorIndex = wdYellow\nNext\n   End Sub\n</code></pre>\n\n<p>While this works as expected on a list of dollar amounts within text (for the most part - <em>among its imperfections the regex is intentionally a bit loose</em>) it does not work as anticipated when there are hyperlinks present in the Word document.</p>\n\n<p>In that instance, there appears to be a shift in offset of the highlighted characters in a somewhat unpredictable manner.  I assume this is because there is a lot of new xml/css in the document.xml source file.</p>\n\n<p>Ultimately, my overarching questions is, can I use regex to highlight word document contents even if it contains hyperlinks?  Is it an offset question or should I run the regex on the compressed xml, re compress and reopen for better results?  As when I test various regex variations on the source code, I get the anticipated results, but not when formatting what would be the Word range.</p>\n\n<p>I have also asked this here: <a href=\"https://social.msdn.microsoft.com/Forums/en-US/3a95c5e4-9e0c-4da9-970f-e0bf801c3170/macro-for-a-regexp-search-replace?forum=isvvba&amp;prof=required\" rel=\"nofollow noreferrer\">https://social.msdn.microsoft.com/Forums/en-US/3a95c5e4-9e0c-4da9-970f-e0bf801c3170/macro-for-a-regexp-search-replace?forum=isvvba&amp;prof=required</a> but realize it was an ancient post...</p>\n\n<p>Per question below, here are some possibly helpful links:\nan example document\n<a href=\"http://www.smithany.com/test.docx\" rel=\"nofollow noreferrer\">http://www.smithany.com/test.docx</a>\nstep 1\n<a href=\"http://www.smithany.com/wordusd1.jpg\" rel=\"nofollow noreferrer\">http://www.smithany.com/wordusd1.jpg</a> \nStep 2\n<a href=\"http://www.smithany.com/wordhighlighterrun.jpg\" rel=\"nofollow noreferrer\">http://www.smithany.com/wordhighlighterrun.jpg</a>\nand what happens\n<a href=\"http://www.smithany.com/whatactuallyhappens.jpg\" rel=\"nofollow noreferrer\">http://www.smithany.com/whatactuallyhappens.jpg</a></p>\n\n<p><strong>Temporary Workaround:</strong>  As suggested below Word's Wildcard find is fast if you do not stack the loops.  try this:</p>\n\n<pre><code>Sub Macro2()\nSelection.Find.ClearFormatting\nSelection.Find.Replacement.ClearFormatting\nSelection.Find.Replacement.highlight = True\nWith Selection.Find\n    .Text = \"$[0-9,]{1,}\"\n    .Replacement.Text = \"\"\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = True\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchAllWordForms = False\n    .MatchSoundsLike = False\n    .MatchWildcards = True\nEnd With\nSelection.Find.Execute Replace:=wdReplaceAll\nSelection.Find.ClearFormatting\nSelection.Find.Replacement.ClearFormatting\nSelection.Find.Replacement.highlight = True\nWith Selection.Find\n    .Text = \"$[0-9,]{1,}.[0-9]{2,3}\"\n    .Replacement.Text = \"\"\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = True\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchAllWordForms = False\n    .MatchSoundsLike = False\n    .MatchWildcards = True\nEnd With\nSelection.Find.Execute Replace:=wdReplaceAll\n</code></pre>\n\n<p>End Sub</p>\n\n<p>which basically gets all the dollar amounts highlighted.  That said, complex expressions like matching a variety of date formats could get messy, but i suppose it is all possible doing them one step at a time.</p>\n"}, {"tags": ["regex", "vba"], "comments": [{"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1527040748, "post_id": 50478211, "comment_id": 87971163, "body": "You&#39;re already using capturing groups (<code>SubMatches</code> in VBA), what&#39;s wrong with that? &quot;ABC(123)&quot; will return only &quot;123&quot; in <code>SubMatches(0)</code>."}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "reply_to_user": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 1, "creation_date": 1527044171, "post_id": 50478211, "comment_id": 87971836, "body": "It looks like I needed to add the last optional item, and it all works"}], "answers": [{"comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1527105649, "post_id": 50495801, "comment_id": 88005864, "body": "<i>Aren&#39;t allowed</i>? May be just doesn&#39;t exist?"}], "tags": [], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "is_accepted": false, "score": 0, "last_activity_date": 1527102553, "creation_date": 1527102553, "answer_id": 50495801, "question_id": 50478211, "link": "https://stackoverflow.com/questions/50478211/return-only-capturing-groups-or-any-other-lookback-hack/50495801#50495801", "title": "Return only capturing groups (Or any other lookback hack)", "body": "<p>So it turns out it's fairly simple, and in the code itself- simply use the last optional item, $!, and it grabs the first capture group. $2 for the second, etc.</p>\n\n<p>So instead of Regex(\"ABC123\",\"ABC(123)\"), I need Regex(\"ABC123\",\"ABC(123)\",\"$1\").</p>\n\n<p>Additionally, this lets me use pseudo-lookbacks in VBA, which normally aren't allowed!</p>\n"}], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1527102553, "creation_date": 1527035367, "last_edit_date": 1592644375, "question_id": 50478211, "link": "https://stackoverflow.com/questions/50478211/return-only-capturing-groups-or-any-other-lookback-hack", "title": "Return only capturing groups (Or any other lookback hack)", "body": "<p>So I'm dealing with fairly complex regular expressions in VBA. Horray for me. Lookbehind isn't supported AT ALL in VBA. Fine.</p>\n<p>One potential hack is to say &quot;The string starts at position X&quot;, and truncate the string to only search the first portion. I'd prefer not to go this route, but I will if I have to.</p>\n<p>Something that seems very promising is capturing groups.</p>\n<p>Is there any way to return just the capture group from a regular expression?</p>\n<p><strong>Code:</strong></p>\n<pre><code>Function regex(strInput As String, matchPattern As String, Optional ByVal outputPattern As String = &quot;$0&quot;) As Variant\n    Dim inputRegexObj As New VBScript_RegExp_55.RegExp, outputRegexObj As New VBScript_RegExp_55.RegExp, outReplaceRegexObj As New VBScript_RegExp_55.RegExp\n    Dim inputMatches As Object, replaceMatches As Object, replaceMatch As Object\n    Dim replaceNumber As Integer\n\n    strInput = Replace(strInput, Chr(160), &quot; &quot;)\n    \n    With inputRegexObj\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = True\n        .Pattern = matchPattern\n    End With\n    With outputRegexObj\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = True\n        .Pattern = &quot;\\$(\\d+)&quot;\n    End With\n    With outReplaceRegexObj\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = True\n    End With\n\n    Set inputMatches = inputRegexObj.Execute(strInput)\n    If inputMatches.Count = 0 Then\n        regex = &quot;&quot;\n    Else\n        Set replaceMatches = outputRegexObj.Execute(outputPattern)\n        For Each replaceMatch In replaceMatches\n            replaceNumber = replaceMatch.SubMatches(0)\n            outReplaceRegexObj.Pattern = &quot;\\$&quot; &amp; replaceNumber\n\n            If replaceNumber = 0 Then\n                outputPattern = outReplaceRegexObj.Replace(outputPattern, inputMatches(0).Value)\n            Else\n                If replaceNumber &gt; inputMatches(0).SubMatches.Count Then\n                    'regex = &quot;A to high $ tag found. Largest allowed is $&quot; &amp; inputMatches(0).SubMatches.Count &amp; &quot;.&quot;\n                    regex = CVErr(xlErrValue)\n                    Exit Function\n                Else\n                    outputPattern = outReplaceRegexObj.Replace(outputPattern, inputMatches(0).SubMatches(replaceNumber - 1))\n                End If\n            End If\n        Next\n        regex = outputPattern\n    End If\nEnd Function\n</code></pre>\n<p><strong>Simple Sample:</strong></p>\n<pre><code>Regex(&quot;ABC123&quot;,&quot;ABC(123)&quot;)\n</code></pre>\n<ul>\n<li>Currently returns: &quot;ABC123&quot;</li>\n<li>Desired return: &quot;123&quot;</li>\n</ul>\n<p><strong>Complex Sample/desired result:</strong></p>\n<ul>\n<li><p>String: ABC 33-99 AA 100-00</p>\n<p>A negative lookforward might be able to work here.</p>\n</li>\n<li><p>Strings: 123//45 ; 123//; 123</p>\n<p>I'd like to be able to get 123 in one place, and 45 in another. But how could a negative lookforward work on the 45 when I need to look backwards to establish prior numbers behind?</p>\n</li>\n</ul>\n"}, {"tags": ["excel", "sumifs", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1527034790, "post_id": 50478145, "comment_id": 87969879, "body": "<code>fails to work</code> does that mean it throws an error, or it returns the wrong value?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1527034903, "post_id": 50478145, "comment_id": 87969900, "body": "just a note by using wildcards and <code>&amp;</code> you are forcing numbers into strings.  SUMIFS will not find strings inside numbers."}, {"owner": {"reputation": 1, "user_id": 9754321, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4XuCaLOtxYk/AAAAAAAAAAI/AAAAAAAAAHs/fJ8ELrPxywA/photo.jpg?sz=128", "display_name": "Phil", "link": "https://stackoverflow.com/users/9754321/phil"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1527179931, "post_id": 50478145, "comment_id": 88040974, "body": "It processes, but instead of getting the value I expect, I get a zero."}, {"owner": {"reputation": 1, "user_id": 9754321, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4XuCaLOtxYk/AAAAAAAAAAI/AAAAAAAAAHs/fJ8ELrPxywA/photo.jpg?sz=128", "display_name": "Phil", "link": "https://stackoverflow.com/users/9754321/phil"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1527181550, "post_id": 50478145, "comment_id": 88041808, "body": "Your comment about using wildcards and &amp; are the problem, but I need to be able to type part of the criteria range into the range or leave the range blank to get the correct sum.  Any suggestions on how to force these fields into text format?  I&#39;ve tried everything in my wheelhouse of knowledge."}, {"owner": {"reputation": 1, "user_id": 9754321, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4XuCaLOtxYk/AAAAAAAAAAI/AAAAAAAAAHs/fJ8ELrPxywA/photo.jpg?sz=128", "display_name": "Phil", "link": "https://stackoverflow.com/users/9754321/phil"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1527200155, "post_id": 50478145, "comment_id": 88050418, "body": "I just figured out exactly what the problem is.  The code looks for the first blank row to find the end of the table.  Then the sumifs formula looks in each column, and if a cell has a blank, it zeros everything out.  So the data cannot have any blanks in it.  The only option I can think of is to force every cell in the data range to populate with something.  If someone else has another option, I&#39;d love to hear it."}, {"owner": {"reputation": 1, "user_id": 9754321, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4XuCaLOtxYk/AAAAAAAAAAI/AAAAAAAAAHs/fJ8ELrPxywA/photo.jpg?sz=128", "display_name": "Phil", "link": "https://stackoverflow.com/users/9754321/phil"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1535053023, "post_id": 50478145, "comment_id": 90935801, "body": "My solution was to create a process that filled in each blank field in the data rows with &quot;FALSE&quot;. Once I did this, everything worked fine because there were no more blanks in the data rows.  Very similar to using the NZ (forces blanks to zero) in Microsoft Access.  I hope this helps others having the same issue."}], "owner": {"reputation": 1, "user_id": 9754321, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4XuCaLOtxYk/AAAAAAAAAAI/AAAAAAAAAHs/fJ8ELrPxywA/photo.jpg?sz=128", "display_name": "Phil", "link": "https://stackoverflow.com/users/9754321/phil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527034568, "creation_date": 1527034568, "last_edit_date": 1531164843, "question_id": 50478145, "link": "https://stackoverflow.com/questions/50478145/sumifs-statement-works-until-a-numeric-field-in-criteria-is-applied-then-it-fai", "title": "SUMIFS statement works until a numeric field in criteria is applied, then it fails", "body": "<p>I have a sumif statement that uses 11 criterias.  It works with all criterias that have text in them, but it fails to work when I add a field that has blanks and/or numbers in it.  I can't figure out how to overcome this problem and would like some help.  Here is my code:</p>\n\n<pre><code>Dim GS As Worksheet\nSet GS = Worksheets(\"Grant Spreadsheet\")\n\nDim LastRow As Long\n\nWith GS\n    LastRow = GS.Range(\"W1000\").End(xlUp).Row\n    Me.TGATxtBx.Value = WorksheetFunction.SumIfs(.Range(\"w2:w\" &amp; LastRow),_ \n    .Range(\"e2:e\" &amp; LastRow), \"*\" &amp; Me.GrantNameCmboBx.Value &amp; \"*\",_\n    .Range(\"n2:n\" &amp; LastRow), \"*\" &amp; Me.GrantAgencyCmboBx.Value &amp; \"*\",_ \n    .Range(\"o2:o\" &amp; LastRow), \"*\" &amp; Me.GrantDeptCmboBx.Value &amp; \"*\",_ \n    .Range(\"p2:p\" &amp; LastRow), \"*\" &amp; Me.ProgramCmboBx.Value &amp; \"*\",_ \n    .Range(\"d2:d\" &amp; LastRow), \"*\" &amp; Me.ProjTypeCmboBx.Value &amp; \"*\",_ \n    .Range(\"r2:r\" &amp; LastRow), \"*\" &amp; Me.CatalogNoCmboBx.Value &amp; \"*\",_ \n    .Range(\"q2:q\" &amp; LastRow), \"*\" &amp; Me.PassthroughCmboBx.Value &amp; \"*\",_\n    .Range(\"s2:s\" &amp; LastRow), \"*\" &amp; Me.GrantIDCmboBx.Value &amp; \"*\",_ \n    .Range(\"h2:h\" &amp; LastRow), \"*\" &amp; Me.FundNoCmboBx.Value &amp; \"*\"_\n    .Range(\"i2:i\" &amp; LastRow), \"*\" &amp; Me.OrgTxtBx.Value &amp; \"*\",_\n    .Range(\"k2:k\" &amp; LastRow), \"*\" &amp; Me.AccountTxtBx.Value &amp; \"*\")\n</code></pre>\n\n<p>Me.PassthroughCmboBx.Value has blanks and the three fields after that have numbers.  If I move things around and bring these fields in earlier between the criterias that do work, it fails.  I could really use your help.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1527035149, "creation_date": 1527035149, "answer_id": 50478190, "question_id": 50478058, "link": "https://stackoverflow.com/questions/50478058/return-the-value-of-the-cell-one-over-to-the-right-from-found-text/50478190#50478190", "title": "Return the value of the cell one over to the right from found text", "body": "<p>To return the value of the cell one over to the right from \"Specific text\":</p>\n\n<pre><code>.Cells(lRow, 4) = rFound.Offset(0, 1).Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "is_accepted": false, "score": 0, "last_activity_date": 1527057343, "last_edit_date": 1527057343, "creation_date": 1527044836, "answer_id": 50479228, "question_id": 50478058, "link": "https://stackoverflow.com/questions/50478058/return-the-value-of-the-cell-one-over-to-the-right-from-found-text/50479228#50479228", "title": "Return the value of the cell one over to the right from found text", "body": "<p>To expand on the correct advice of @Tim Williams...</p>\n\n<p>Find the block of code that looks like:</p>\n\n<pre><code>.Cells(lRow, 1) = wbk.Name\n.Cells(lRow, 2) = wks.Name\n.Cells(lRow, 3) = rFound.Address\n.Cells(lRow, 4) = rFound.Value\n</code></pre>\n\n<p>And change the fourth line so it matches his code:</p>\n\n<pre><code>.Cells(lRow, 1) = wbk.Name\n.Cells(lRow, 2) = wks.Name\n.Cells(lRow, 3) = rFound.Address\n.Cells(lRow, 4) = rFound.Offset(0, 1).Value\n</code></pre>\n\n<p>This is a handy piece of code to keep available in a toolkit but there are times when it's too heavy handed.  One example is creating a list of filenames and/or path strings.  If there's no need to open one file then it becomes laughingly absurd to open all of the files. Naturally this tool should be modified to better suit a variety of requirements but there's a better alternative for many scenarios.  If there's anyone out there with the daunting challenge of searching the contents of a thousand files, logging all files that generate positive hits,  and you don't need to open any of the files you've identified or care if a file has one or many positive hits... if that's you then the tool I recommend using that will outperform the one suggested here is called ..... Windows.</p>\n\n<p>Windows must be configured to search file contents for this to work and the settings are in two different locations.  One is a checkbox in the Advanced Search drop drown menu of the Search window's Search Tab. The other is in the Search Tab of the Folder Options window.</p>\n\n<p>Using the OP's example, to generate a list of all file names and locations containing the string \"CUSTOMER ID\". Simply open explorer, activate the search box, and type:</p>\n\n<p>contents:CUSTOMER ID</p>\n\n<p>When the search is complete, highlight the results you want to include in the list, shift right click in the highlighted area, select copy as path.  Paste your newly generated list into the application of your choice.  Yes, it really is that easy.</p>\n"}], "owner": {"reputation": 1, "user_id": 4916789, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206636117492381/picture?type=large", "display_name": "Donal Jennings", "link": "https://stackoverflow.com/users/4916789/donal-jennings"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1555228199, "creation_date": 1527033861, "last_edit_date": 1555228199, "question_id": 50478058, "link": "https://stackoverflow.com/questions/50478058/return-the-value-of-the-cell-one-over-to-the-right-from-found-text", "title": "Return the value of the cell one over to the right from found text", "body": "<p>I'm trying to loop through a folder, find all workbooks which have the word \"CUSTOMER ID\" in them, and then copy from the adjacent cell (the customer's name one over to the right on the same row). The customer name is pasted into a master workbook along with workbook file names.</p>\n\n<p>I found the following code, it returns the text I'm searching for.</p>\n\n<pre><code>Sub SearchFolders()\n    Dim fso As Object\n    Dim fld As Object\n    Dim strSearch As String\n    Dim strPath As String\n    Dim strFile As String\n    Dim wOut As Worksheet\n    Dim wbk As Workbook\n    Dim wks As Worksheet\n    Dim lRow As Long\n    Dim rFound As Range\n    Dim strFirstAddress As String\n\n    On Error GoTo ErrHandler\n    Application.ScreenUpdating = False\n\n    'Change as desired\n    strPath = \"c:\\MyFolder\"\n    strSearch = \"Specific text\"\n\n    Set wOut = Worksheets.Add\n    lRow = 1\n    With wOut\n        .Cells(lRow, 1) = \"Workbook\"\n        .Cells(lRow, 2) = \"Worksheet\"\n        .Cells(lRow, 3) = \"Cell\"\n        .Cells(lRow, 4) = \"Text in Cell\"\n        Set fso = CreateObject(\"Scripting.FileSystemObject\")\n        Set fld = fso.GetFolder(strPath)\n\n        strFile = Dir(strPath &amp; \"\\*.xls*\")\n        Do While strFile &lt;&gt; \"\"\n            Set wbk = Workbooks.Open _\n              (Filename:=strPath &amp; \"\\\" &amp; strFile, _\n              UpdateLinks:=0, _\n              ReadOnly:=True, _\n              AddToMRU:=False)\n\n            For Each wks In wbk.Worksheets\n                Set rFound = wks.UsedRange.Find(strSearch)\n                If Not rFound Is Nothing Then\n                    strFirstAddress = rFound.Address\n                End If\n                Do\n                    If rFound Is Nothing Then\n                        Exit Do\n                    Else\n                        lRow = lRow + 1\n                        .Cells(lRow, 1) = wbk.Name\n                        .Cells(lRow, 2) = wks.Name\n                        .Cells(lRow, 3) = rFound.Address\n                        .Cells(lRow, 4) = rFound.Value\n                    End If\n                    Set rFound = wks.Cells.FindNext(After:=rFound)\n                Loop While strFirstAddress &lt;&gt; rFound.Address\n            Next\n\n            wbk.Close (False)\n            strFile = Dir\n        Loop\n        .Columns(\"A:D\").EntireColumn.AutoFit\n    End With\n    MsgBox \"Done\"\n\nExitHandler:\n    Set wOut = Nothing\n    Set wks = Nothing\n    Set wbk = Nothing\n    Set fld = Nothing\n    Set fso = Nothing\n    Application.ScreenUpdating = True\n    Exit Sub\n\nErrHandler:\n    MsgBox Err.Description, vbExclamation\n    Resume ExitHandler\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1527032948, "post_id": 50477779, "comment_id": 87969427, "body": "What are you trying to do with the results?"}, {"owner": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527033073, "post_id": 50477779, "comment_id": 87969457, "body": "I need to match 2 lists.. each list has the same items but each item is not exactly the very same as the other list.  i need to match each list with closest match from other list"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527035703, "post_id": 50478153, "comment_id": 87970031, "body": "thank you very very much.. i&#39;m sure this will solve my problem eventually.. but its still giving me &quot;no luck&quot; i&#39;m sure there is something i&#39;m missing.. i will try to attach a photo here"}, {"owner": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527035789, "post_id": 50478153, "comment_id": 87970051, "body": "i didn&#39;t find a way to add an picture.. here is the used formula:  =indexMX(A:A,B2,C2,E2,G2,I2)"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527035831, "post_id": 50478153, "comment_id": 87970058, "body": "@SamKay  pay careful attention to upper/lower case.......also watch out for accidental blanks, etc."}, {"owner": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527035841, "post_id": 50478153, "comment_id": 87970061, "body": "I need one more favor, I need to add your formula to the Index,match formula because i&#39;m looking in a different sheet and matching from that sheet"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527036132, "post_id": 50478153, "comment_id": 87970118, "body": "@SamKay  For a column in a different sheet, use something like <code>=indexmx(Sheet6!A:A,C1,D1,E1,F1,G1)</code>"}, {"owner": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527036226, "post_id": 50478153, "comment_id": 87970135, "body": "so i don&#39;t have to add the &quot;Match&quot; function?"}, {"owner": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527036287, "post_id": 50478153, "comment_id": 87970154, "body": "is there is away to ignore uppercase?  because you were right, its case sensitive and that&#39;s why it returned error"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527036332, "post_id": 50478153, "comment_id": 87970164, "body": "@SamKay  If you look at my Picture, the <code>INDEX()?MATCH()</code> thing is all built-in"}, {"owner": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527036429, "post_id": 50478153, "comment_id": 87970183, "body": "you are super genius :)  how about the case sensitive issue?"}, {"owner": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527036939, "post_id": 50478153, "comment_id": 87970282, "body": "works like a charm... thank you thank you thank you :)))"}, {"owner": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527191847, "post_id": 50478153, "comment_id": 88046992, "body": "@garys-student can i ask one more favor? i found that some result in the given VBA Code are returning by default first available item. example: I was searching for &quot;Homeostatic Mosquito Scissors&quot;, and the result came with &quot;Halsted-Mosquito Homeostatic Scissors&quot; but this is not the one i want.  I don&#39;t want the Halsted one."}, {"owner": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527192092, "post_id": 50478153, "comment_id": 88047107, "body": "my question no. 1: is there is away i can exclude certain text from the search string (like adding one more column to include any unwanted text (if any)?"}, {"owner": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527192188, "post_id": 50478153, "comment_id": 88047151, "body": "my question no. 2: is there is away i can get all results with that have the searching words and i choose among best result?  like i get a list of all results includes Homeostatic Mosquito Scissors which are around 10 results?"}, {"owner": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527273366, "post_id": 50478153, "comment_id": 88082119, "body": "please I need a final help in yesterday&#39;s tow questions: can i exclude particular text from my search? and can i have multiple possible results?  at least adding one more column to exclude its contents will do the job.  thanks"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527284132, "post_id": 50478153, "comment_id": 88086314, "body": "@SamKay  If you need multiple results and special exclusions, then I would not use this <b>UDF()</b>.  I would use an <i>AutoFilter</i> with a helper column...this support multiple criteria and exclusions and multiple results."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527284576, "post_id": 50478153, "comment_id": 88086451, "body": "@SamKay You could also consider using a <b>Sub()</b> rather than a <b>Udf()</b>.........it is easier to program a sub to achieve what you desire."}, {"owner": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527285751, "post_id": 50478153, "comment_id": 88086805, "body": "thank you very much sir.. i will take your advice and work on it.  appreciate your help sir.."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1527036682, "last_edit_date": 1527036682, "creation_date": 1527034663, "answer_id": 50478153, "question_id": 50477779, "link": "https://stackoverflow.com/questions/50477779/formula-to-search-3-words-text-in-any-sequence-in-different-cell/50478153#50478153", "title": "Formula to search 3 words &quot;text&quot; in any sequence in different cell", "body": "<p>Here is the user defined function:</p>\n\n<pre><code>Public Function indexMX(rng As Range, pat1 As Range, pat2 As Range, pat3 As Range, pat4 As Range, pat5 As Range) As Variant\n    Dim r As Range, rngx As Range, s(1 To 5) As String, Kount As Long, j As Long\n\n    s(1) = pat1.Value\n    s(2) = pat2.Value\n    s(3) = pat3.Value\n    s(4) = pat4.Value\n    s(5) = pat5.Value\n\n    Set rngx = Intersect(rng, rng.Parent.UsedRange)\n\n    For Each r In rngx\n        v = r.Value\n        Kount = 0\n        For j = 1 To 5\n            If InStr(1, v, s(j)) &gt; 0 Or s(j) = \"\" Then Kount = Kount + 1\n        Next j\n        If Kount = 5 Then\n            indexMX = v\n            Exit Function\n        End If\n    Next r\n    indexMX = \"no luck\"\nEnd Function\n</code></pre>\n\n<p>Here is an example of its usage:</p>\n\n<p><a href=\"https://i.stack.imgur.com/GP9EN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GP9EN.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you see, we give the UDF() the address of the column and the addresses of the five keywords and the UDF() finds the first item containing all five words.</p>\n\n<p>If a keyword is blank, it is not used. <em>(so if you want to search for only two keywords, leave the other three blank)</em>.  If no matches are found the phrase <strong><em>no luck</em></strong> is returned.</p>\n\n<p>User Defined Functions (UDFs) are very easy to install and use:</p>\n\n<ol>\n<li>ALT-F11  brings up the VBE window</li>\n<li>ALT-I\nALT-M opens a fresh module</li>\n<li>paste the stuff in and close the VBE window</li>\n</ol>\n\n<p>If you save the workbook, the UDF will be saved with it.\nIf you are using a version of Excel later then 2003, you must save\nthe file as .xlsm rather than .xlsx</p>\n\n<p>To remove the UDF:</p>\n\n<ol>\n<li>bring up the VBE window as above</li>\n<li>clear the code out</li>\n<li>close the VBE window</li>\n</ol>\n\n<p>To use the UDF from Excel:</p>\n\n<p>=myfunction(A1)</p>\n\n<p>To learn more about macros in general, see:</p>\n\n<p><a href=\"http://www.mvps.org/dmcritchie/excel/getstarted.htm\" rel=\"nofollow noreferrer\">http://www.mvps.org/dmcritchie/excel/getstarted.htm</a></p>\n\n<p>and</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/ee814735(v=office.14).aspx\" rel=\"nofollow noreferrer\">http://msdn.microsoft.com/en-us/library/ee814735(v=office.14).aspx</a></p>\n\n<p>and for specifics on UDFs, see:</p>\n\n<p><a href=\"http://www.cpearson.com/excel/WritingFunctionsInVBA.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/WritingFunctionsInVBA.aspx</a></p>\n\n<p><strong>Macros must be enabled for this to work!</strong></p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>to remove case sensitivity, replace:</p>\n\n<pre><code>If InStr(1, v, s(j)) &gt; 0 Or s(j) = \"\" Then Kount = Kount + 1\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>If InStr(1, LCase(v), LCase(s(j))) &gt; 0 Or s(j) = \"\" Then Kount = Kount + 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527144947, "post_id": 50501683, "comment_id": 88017950, "body": "Thank you very much for your answer.. I will give it a try tomorrow morning and let you know the result.. thanks again my dear :)"}, {"owner": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527191091, "post_id": 50501683, "comment_id": 88046609, "body": "unfortunately it didn&#39;t work! i replaced all targets with my cells and applied but it returned with error and didn&#39;t accept.. keep saying: you&#39;ve entered too few arguments for this function.  and more more thing, i did not know where to add my source file where the formula should search these keywords to find the best match!"}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "reply_to_user": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527233642, "post_id": 50501683, "comment_id": 88059518, "body": "Hi Sam, I&#39;m not 100% the formula does what you need but it won&#39;t take long to find out.  I&#39;m going to edit the answer to clarify the usage."}, {"owner": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527271610, "post_id": 50501683, "comment_id": 88081408, "body": "Hi @ProfoundlyOblivious thank you very much for the comprehensive explanation and for the time you spent on this.  I truly do appreciate your help sir.  I will follow the steps and see how it works.  Millions of thanks"}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "reply_to_user": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527281028, "post_id": 50501683, "comment_id": 88085265, "body": "It was genuinely my pleasure. I hope you find it useful.  Let me know if you want some help on the project you&#39;re working on.  I answered one of your other similar questions but later realized it really didn&#39;t solve your problem."}, {"owner": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527285911, "post_id": 50501683, "comment_id": 88086844, "body": "I really really appreciate your help.  i honestly tried on the formula you gave and i know that it should solve the problem if i used it the right way.  but for the lack of intelligence I couldn&#39;t apply it on my table.."}, {"owner": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527286313, "post_id": 50501683, "comment_id": 88086965, "body": "but I need to clarify one thing that might be not clear in my original question: I have a list of products.. sometimes I receive from customers a request for one of these products.. the problem that every customer use his own description for the very same product.   so when i receive any request, i have to go through my long list which is more than 20,000 different items and i need to match the best item for that description.  -to be continued-"}, {"owner": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527286700, "post_id": 50501683, "comment_id": 88087059, "body": "so as a part of the solution and after a long thinking, i&#39;ve created a formula that will extend the 1st word and 2nd word and 3rd word from each item (form the list i receive from my customers) and another column to determine the category and another one for the shape.  and i was looking for a formula to search for these 5 keywords from my list and get the closest match.  that&#39;s in general my concern :)  I have received a VBA code (very thankfully) from previous answer that already solved my problem, but it generated a new concern -to be continued-"}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "reply_to_user": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527286784, "post_id": 50501683, "comment_id": 88087079, "body": "Don&#39;t fret the problem is mine for not truly understanding your problem.  Two things.  One,  I think I have a better understanding of what you need. and two, i will try to cook something up."}, {"owner": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527286908, "post_id": 50501683, "comment_id": 88087105, "body": "the code was successfully giving the matching product, but the new concern arise when i faced some products which as similar names with slightly differences.  so the code was always giving the first possible match.  i was trying to get either a list of possible matches or add a column to exclude certain words from the search.  hope i didn&#39;t talk too much but i wanted to really thank all of you guys for trying to help out.  cheers!"}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "reply_to_user": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527287573, "post_id": 50501683, "comment_id": 88087278, "body": "Sam, I think I have a solution.  But I need to know what version of excel you have.  You have power pivot and power query?"}, {"owner": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "edited": false, "score": 0, "creation_date": 1527293526, "post_id": 50501683, "comment_id": 88088332, "body": "Hi.. I have office 365 ProPlus.. and yes i have power pivot but im not sure about the power query"}], "tags": [], "owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "is_accepted": false, "score": 1, "last_activity_date": 1527259285, "last_edit_date": 1527259285, "creation_date": 1527140098, "answer_id": 50501683, "question_id": 50477779, "link": "https://stackoverflow.com/questions/50477779/formula-to-search-3-words-text-in-any-sequence-in-different-cell/50501683#50501683", "title": "Formula to search 3 words &quot;text&quot; in any sequence in different cell", "body": "<p>Yes, it is possible for a single cell to return three matching words from a different cell.  The answer in this example uses a formula to return 6 matches.   VBA and special array functions are not used.</p>\n\n<p>This is the formula:</p>\n\n<pre><code>=SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUMPRODUCT((IFERROR(SEARCH(FIRST,TARGET),0)&gt;0)*100000+(IFERROR(SEARCH(SECOND,TARGET),0)&gt;0)*20000+(IFERROR(SEARCH(THIRD,TARGET),0)&gt;0)*3000+(IFERROR(SEARCH(FOURTH,TARGET),0)&gt;0)*400+(IFERROR(SEARCH(FIFTH,TARGET),0)&gt;0)*50+(IFERROR(SEARCH(SIXTH,TARGET),0)&gt;0)*6),\"1\",FIRST&amp;DELIM),\"2\",SECOND&amp;DELIM),\"3\",THIRD&amp;DELIM),\"4\",FOURTH&amp;DELIM),\"5\",FIFTH&amp;DELIM),\"6\",SIXTH&amp;DELIM),\"0\",\"\")\n</code></pre>\n\n<p>Did you notice the named ranges?  FIRST, SECOND, THIRD, etc are individual cells and each one holds a word. We are trying to find those words inside TARGET. If we find the words, then we will write them in this cell holding this formula and each word will be separated by DELIM</p>\n\n<p>The ranges are optional.  In the picture below, you'll see cell A2 contains the word \"named\". This is the first of the six words we're tying to find and it can be expressed as FIRST = \"A2\" = \"named\"  Inside the formula you'll see that FIRST appears twice.  You could replace it with \"named\" and the cell A2 would become blank but the functionality of the formula would not change.</p>\n\n<p>Even TARGET is optional.  It could be written as E1 or typed out word for word. \n I don't know why anyone would do that... but it is possible.</p>\n\n<p>DELIM is at cell B2, it is a double space</p>\n\n<p><a href=\"https://i.stack.imgur.com/wYX8k.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wYX8k.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Now to explain how it works</p>\n\n<p>SEARCH(search for what?,  search where?) This is responsible for determining if a match exists or not.  If you understand what the named ranges then you've already figured out the syntax is. The location of first letter that of match in  TARGET is returned.  In this formula it is always 1  If it is not found then the number is 0</p>\n\n<p>IFERROR(value,value) tries to perform the operation.  If successful then the result is displayed. If there's an error the second result is displayed.  Every IFERROR in this formula is practically the same:  <code>IFERROR(SEARCH(FIRST,TARGET),0)</code> It searches inside TARGET trying to find the FIRST word.  Result if found is 1 and if not found is 0</p>\n\n<p>It gets a little more complicated from here so lets recap.  We're calling SEARCH 6 times.  Once for each word we want to find and we're always looking in TARGET.  Result will be a 1 if match is found or a 0 if not. Ironically, us humans can put it together and see the match but the formula can't determine which words have been matched without more information</p>\n\n<p>SUMPRODUCT takes the sum (addition) of the product (multiplication) of two or more arrays.</p>\n\n<p>multiply two arrays to get the product\n<code>a, b, c  *  e, f, g  =  ae, bf, cg\ntakethe sum of the product to get the SUMPRODUCT\n</code>ae + bf + cg`   </p>\n\n<p>This is easiest when thought of a price  and quantity.  If one array is the price of a group of items and the other is quantity of the same group of items, then multiplying the two arrays will create a new array where each element is the cost to buy all items of that type in the group the total, and adding all those numbers give you the total cost you'd pay for all of the items</p>\n\n<p>Here we multiply two arrays:</p>\n\n<pre><code>Qty    Price\n12.0    0.3\n70.0    0.1\n20.0    0.4\n</code></pre>\n\n<p>Multiply them to get the product:</p>\n\n<pre><code>Qty    Price    Total\n12.0    0.3     3.8\n70.0    0.1     7.0\n20.0    0.4     8.0\n</code></pre>\n\n<p>Take the sum of the product:</p>\n\n<pre><code>Qty    Price    Total       \n12.0    0.3     3.8     \n70.0    0.1     7.0     \n20.0    0.4     8.0     \n                18.8 SUMPRODUCT \n</code></pre>\n\n<p>Lets look at part of the formula:</p>\n\n<p>SUMPRODUCT((IFERROR(SEARCH(FIRST,TARGET),0)>0)*100000+IFERROR(SEARCH(SECOND,TARGET),0)>0)*20000+...</p>\n\n<p>It is easy to see this segment is looking for two words.  We know SUMPRODUCT want's to multiply and add arrays.  If you're thinking <code>(IFERROR(SEARCH(FIRST,TARGET),0)&gt;0)</code> is an array, you'd be right!  It's not an array in the technical sense of the word, but it does evaluate into a single value which can thought of as a 1x1 array, or, a cell.  The sharp eyed and quick witted, may have noticed there is something on this array we have mentioned.  It's the inequality at the end! Many of you know that you can take numerical values and turn them into boolean by testing them with an inequality.  So lets evaluate.... SEARCH for FIRST inside TARGET = 1 because FIRST = \"named\" which is inside TARGET waaaaaaay in the back and because it wasn't an error we get to keep the 1.  Next we do the inequality  1 > 0 = TRUE  One is greater than zero and evaluates to TRUE</p>\n\n<p>This is what we have right now</p>\n\n<pre><code>SUMPRODUCT((TRUE*100000+IFERROR(SEARCH(SECOND,TARGET),0)&gt;0)*20000+....\n</code></pre>\n\n<p>Can you identify the arrays now?  We know TRUE is an array, a 1x1.  You know the IFERROR bit all the way to the inequality is also an array.  Lets evaluate that IFERROR .... Mathematically we should still be working from left to right but trust me, we're ok if we let it slide this once.</p>\n\n<pre><code>IFERROR(SEARCH(SECOND,TARGET),0)&gt;0)    SECOND = \"array\" = 1 = TRUE\n</code></pre>\n\n<p>Did you follow my short hand?  It's ok if you didn't just back up and practice on FIRST until you understand.</p>\n\n<p>Plugging in the value gives us something like this</p>\n\n<pre><code>SUMPRODUCT(TRUE*100000+TRUE*20000+...\n</code></pre>\n\n<p>SUMPRODUCT is the SUM(addition) of the PRODUCT(multiplication)\nSo we're adding the stuff we multiply</p>\n\n<pre><code>SUMPRODUCT = (TRUE * 100000) +  (TRUE * 20000)\n</code></pre>\n\n<p>Remember how easy it was to go from 1 > 0 to TRUE. We're \"getting all up into that boolean TRUE that\" equals 1   Here's a fun fact, -1 is also equal to TRUE. If you've ever seen a formula with a double negative in it like this STUFF(--(MORESTUFF( that's just some Excel wizard person making sure they get a +1 instead of a -1  ... ok, so lets get back on track and evalute</p>\n\n<pre><code>SUMPRODCUT = 1 * 100000 + 1 * 20000+....\nSUMPRODCUT =  100000 + 20000+....\nSUMPRODCUT =  120000+.....\n</code></pre>\n\n<p>I know you've been asking about those numbers. One hundred thousand?  What's one hundred thousand for?  I've been purposefully ignoring until it became convenient to talk about it.  And now it's convenient.  Go look at the whoooole formula and you'll find a pattern.  Those numbers are in a decreasing sequence.  Anyone who's ever done bitwise logic can see where this is going.I'm running short on time so I'll cut to the chase.  Assume a hypothetical situation where every word was matched. You'd end up with </p>\n\n<pre><code>SUMPRODUCT = 100000 + 20000 + 3000 + 400 + 50 + 6\nSUMPRODCUT = 123456\n</code></pre>\n\n<p>123456 are you pulling my leg?  No, I am not. We're almost done so if you're still with me then you're gonna drive it home.</p>\n\n<p>We have a large group of SUBSTITUTE teachers at the front of the line and we gotta get rid of them.</p>\n\n<p>We also have this to contend with <code>:\"1\",FIRST&amp;DELIM),\"2\",SECOND&amp;DELIM),\"3\",THIRD&amp;DELIM),\"4\",FOURTH&amp;DELIM),\"5\",FIFTH&amp;DELIM),\"6\",SIXTH&amp;DELIM),\"0\",\"\")</code></p>\n\n<p>Thankfully for us, they are part of the same problem.  We worked our way from the middle out.</p>\n\n<pre><code>SUBSTITUTE(SUBSTITUTE(text, old text, new text)\nSUBSTITUTE(SUBSTITUTE(\"123456\",\"1\", FIRST &amp; DELIM),\"2\",SECOND &amp; DELIM)....\n</code></pre>\n\n<p>Remember at top DELIM was pointing to a cell holding a double space.  Each DELIM can be replaced with \"  \" or any other delimiter you want.</p>\n\n<pre><code>SUBSTITUTE(SUBSTITUTE(\"123456\",\"1\", \"named\" &amp; \"  \"),\"2\",SECOND &amp; DELIM)...\nSUBSTITUTE(\"named  23456\",\"2\",SECOND &amp; DELIM)...\nSUBSTITUTE(\"named  23456\",\"2\",\"array\"&amp; \"  \")...\n(\"named  array  3456\")... and so on.\n</code></pre>\n\n<p>Any questions?</p>\n\n<p>Ok, class is dismissed!</p>\n"}], "owner": {"reputation": 17, "user_id": 9692628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76a86cdac2e168c546629c72562b33e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Kay", "link": "https://stackoverflow.com/users/9692628/sam-kay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "accepted_answer_id": 50478153, "answer_count": 2, "score": 0, "last_activity_date": 1527862049, "creation_date": 1527031472, "last_edit_date": 1531161705, "question_id": 50477779, "link": "https://stackoverflow.com/questions/50477779/formula-to-search-3-words-text-in-any-sequence-in-different-cell", "title": "Formula to search 3 words &quot;text&quot; in any sequence in different cell", "body": "<p>Please take a look at the attached image. I have a long list of items and I've created a common keywords to search in that list. I'm using this formula:</p>\n\n<pre><code>=INDEX(A:A,MATCH(((\"*\"&amp;B2&amp;\"*\")&amp;(\"*\"&amp;C2&amp;\"*\")&amp;(\"*\"&amp;D2&amp;\"*\")&amp;(\"*\"&amp;E2&amp;\"*\")&amp;(\"*\"&amp;F2&amp;\"*\")),A:A,0))\n</code></pre>\n\n<p>The problem that the search is going through the same sequence that I entered.\nIt gives error if the sequence of the words in the cell is different than the sequence in my formula which make sense.</p>\n\n<p>Is there a way I can search for 3 or more words that are existing in any cell in any sequence?</p>\n\n<p>I am open to using VBA if necessary.</p>\n\n<p>My search results:</p>\n\n<p><img src=\"https://i.stack.imgur.com/dX3ZB.png\" alt=\"my search results\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "edited": false, "score": 0, "creation_date": 1527032384, "post_id": 50477715, "comment_id": 87969296, "body": "Please post the code you have so far and state any <b>specific</b> problems you have with it and please read this: <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1527033897, "post_id": 50477715, "comment_id": 87969666, "body": "Lucky for you, I have this for something at work so I can share the code. Couple questions first: 1) what row would you expect to never have any blanks? Need this to determine how far down to copy. 2) what columns will be copied? I\u2019m guessing starting from A, but ending where?"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 7900306, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/745e563f4d288ccdcd3d2e736d67160f?s=128&d=identicon&r=PG&f=1", "display_name": "harsha kazama", "link": "https://stackoverflow.com/users/7900306/harsha-kazama"}, "edited": false, "score": 0, "creation_date": 1527088198, "post_id": 50478275, "comment_id": 87996576, "body": "few variables here not defined.. So I defined WB as workbook and WS as worksheet.. but still Im getting 1 error at the line                                                                                                                           LRow1 = WB.Sheets(&quot;SHEETNAME?&quot;).Range(&quot;A&quot; &amp; WS.Rows.Count).End(xlUp).Row..                                                   here my sheet name is sheet1 which I changed already, but WB unable to refer which sheet should be consider I guess"}, {"owner": {"reputation": 95, "user_id": 7900306, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/745e563f4d288ccdcd3d2e736d67160f?s=128&d=identicon&r=PG&f=1", "display_name": "harsha kazama", "link": "https://stackoverflow.com/users/7900306/harsha-kazama"}, "edited": false, "score": 0, "creation_date": 1527180519, "post_id": 50478275, "comment_id": 88041294, "body": "LRow2 = CurrentBook.ActiveSheet.Range(&quot;A2&quot; &amp; CurrentBook.ActivateSheet.Rows.Count).End(xlUp).Row                                                                                                              im getting error in this line.... Object doesn&#39;t support this property or method"}, {"owner": {"reputation": 95, "user_id": 7900306, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/745e563f4d288ccdcd3d2e736d67160f?s=128&d=identicon&r=PG&f=1", "display_name": "harsha kazama", "link": "https://stackoverflow.com/users/7900306/harsha-kazama"}, "edited": false, "score": 0, "creation_date": 1527198489, "post_id": 50478275, "comment_id": 88049869, "body": "after swapping with CurrentBook.Sheet.. no change in the error"}, {"owner": {"reputation": 95, "user_id": 7900306, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/745e563f4d288ccdcd3d2e736d67160f?s=128&d=identicon&r=PG&f=1", "display_name": "harsha kazama", "link": "https://stackoverflow.com/users/7900306/harsha-kazama"}, "edited": false, "score": 0, "creation_date": 1527202028, "post_id": 50478275, "comment_id": 88050944, "body": "same thing error on same line... no change.. Have you tried this code from your side ?"}, {"owner": {"reputation": 95, "user_id": 7900306, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/745e563f4d288ccdcd3d2e736d67160f?s=128&d=identicon&r=PG&f=1", "display_name": "harsha kazama", "link": "https://stackoverflow.com/users/7900306/harsha-kazama"}, "edited": false, "score": 0, "creation_date": 1527203972, "post_id": 50478275, "comment_id": 88051421, "body": "it worked for you??? could you pls replace the above code with your working code ..so that I can try with that working code."}, {"owner": {"reputation": 95, "user_id": 7900306, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/745e563f4d288ccdcd3d2e736d67160f?s=128&d=identicon&r=PG&f=1", "display_name": "harsha kazama", "link": "https://stackoverflow.com/users/7900306/harsha-kazama"}, "edited": false, "score": 0, "creation_date": 1527204713, "post_id": 50478275, "comment_id": 88051599, "body": "I found the error in this line LRow2 = CurrentBook.ActiveSheet.Range(&quot;A2&quot; &amp; CurrentBook.ActivateSheet.Rows.Count).End(xlUp).Row  its not activatesheet its active sheet. thanks a lot . code is working absolutely fine :)"}, {"owner": {"reputation": 189, "user_id": 9013483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75cfbfcf868871bc916951c96bfc8a64?s=128&d=identicon&r=PG&f=1", "display_name": "qbbq", "link": "https://stackoverflow.com/users/9013483/qbbq"}, "edited": false, "score": 0, "creation_date": 1566176698, "post_id": 50478275, "comment_id": 101561713, "body": "just a suggestion, it would be advisable to add <code>Application.CutCopyMode = False</code> at the end of the macro to ensure that Excel isn&#39;t taking up too much of the clipboard"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 1, "last_activity_date": 1527205156, "last_edit_date": 1527205156, "creation_date": 1527035957, "answer_id": 50478275, "question_id": 50477715, "link": "https://stackoverflow.com/questions/50477715/merging-multiple-workbooks-into-single-sheet-in-current-workbook/50478275#50478275", "title": "Merging multiple workbooks into single sheet in current workbook", "body": "<p>First, This will not paste any headers. Since they are all the same, just move the headers to the excel that will store the consolidation. (No need for a macro to do this since it only needs to happen once).  </p>\n\n<p>Second, in the code you need to change \"SHEETNAME?\" to the name of the sheet on your main book that will store the consolidation. (2 instances, do not remove quotes)  </p>\n\n<p>Third, I am assuming there is no blanks in Column A which is what determines how far down to copy. If you expect blanks in Column A, this needs to be amended to reflect a column that is least likely to have blanks.  </p>\n\n<p>Lastly, I am copying from Column A to Z. Change the \"Z\" to the last column in your file that contains data. </p>\n\n<p>Given the quality of (or lack of) your question, this is more than you bargained for :)<br>\nHappy Editing. </p>\n\n<pre><code>Option Explicit\n\nSub Consolidation()\n\nDim CurrentBook As Workbook\nDim WS As Worksheet\nSet WS = ThisWorkbook.Sheets(\"SHEETNAME?\")\nDim IndvFiles As FileDialog\nDim FileIdx As Long\nDim i As Integer, x As Integer\n\nSet IndvFiles = Application.FileDialog(msoFileDialogOpen)\nWith IndvFiles\n    .AllowMultiSelect = True\n    .Title = \"Multi-select target data files:\"\n    .ButtonName = \"\"\n    .Filters.Clear\n    .Filters.Add \".xlsx files\", \"*.xlsx\"\n    .Show\nEnd With\n\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\n\nFor FileIdx = 1 To IndvFiles.SelectedItems.Count\n    Set CurrentBook = Workbooks.Open(IndvFiles.SelectedItems(FileIdx))\n    For Each Sheet In CurrentBook.Sheets\n        Dim LRow1 As Long\n        LRow1 = WS.Range(\"A\" &amp; WS.Rows.Count).End(xlUp).Row\n        Dim LRow2 As Long\n        LRow2 = CurrentBook.ActiveSheet.Range(\"A\" &amp; CurrentBook.ActiveSheet.Rows.Count).End(xlUp).Row\n\n        Dim ImportRange As Range\n        Set ImportRange = CurrentBook.ActiveSheet.Range(\"A2:Z\" &amp; LRow2)\n        ImportRange.Copy\n        WS.Range(\"A\" &amp; LRow1 + 1).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    Next\n    CurrentBook.Close False\nNext FileIdx\n\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1529766782, "creation_date": 1529766782, "answer_id": 51002466, "question_id": 50477715, "link": "https://stackoverflow.com/questions/50477715/merging-multiple-workbooks-into-single-sheet-in-current-workbook/51002466#51002466", "title": "Merging multiple workbooks into single sheet in current workbook", "body": "<p>How about this option?  Modify to suit your needs.</p>\n\n<pre><code>Sub Basic_Example_1()\n    Dim MyPath As String, FilesInPath As String\n    Dim MyFiles() As String\n    Dim SourceRcount As Long, Fnum As Long\n    Dim mybook As Workbook, BaseWks As Worksheet\n    Dim sourceRange As Range, destrange As Range\n    Dim rnum As Long, CalcMode As Long\n\n    'Fill in the path\\folder where the files are\n    MyPath = \"C:\\Users\\Ron\\test\"\n\n    'Add a slash at the end if the user forget it\n    If Right(MyPath, 1) &lt;&gt; \"\\\" Then\n        MyPath = MyPath &amp; \"\\\"\n    End If\n\n    'If there are no Excel files in the folder exit the sub\n    FilesInPath = Dir(MyPath &amp; \"*.xl*\")\n    If FilesInPath = \"\" Then\n        MsgBox \"No files found\"\n        Exit Sub\n    End If\n\n    'Fill the array(myFiles)with the list of Excel files in the folder\n    Fnum = 0\n    Do While FilesInPath &lt;&gt; \"\"\n        Fnum = Fnum + 1\n        ReDim Preserve MyFiles(1 To Fnum)\n        MyFiles(Fnum) = FilesInPath\n        FilesInPath = Dir()\n    Loop\n\n    'Change ScreenUpdating, Calculation and EnableEvents\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    'Add a new workbook with one sheet\n    Set BaseWks = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n    rnum = 1\n\n    'Loop through all files in the array(myFiles)\n    If Fnum &gt; 0 Then\n        For Fnum = LBound(MyFiles) To UBound(MyFiles)\n            Set mybook = Nothing\n            On Error Resume Next\n            Set mybook = Workbooks.Open(MyPath &amp; MyFiles(Fnum))\n            On Error GoTo 0\n\n            If Not mybook Is Nothing Then\n\n                On Error Resume Next\n\n                With mybook.Worksheets(1)\n                    Set sourceRange = .Range(\"A1:C1\")\n                End With\n\n                If Err.Number &gt; 0 Then\n                    Err.Clear\n                    Set sourceRange = Nothing\n                Else\n                    'if SourceRange use all columns then skip this file\n                    If sourceRange.Columns.Count &gt;= BaseWks.Columns.Count Then\n                        Set sourceRange = Nothing\n                    End If\n                End If\n                On Error GoTo 0\n\n                If Not sourceRange Is Nothing Then\n\n                    SourceRcount = sourceRange.Rows.Count\n\n                    If rnum + SourceRcount &gt;= BaseWks.Rows.Count Then\n                        MsgBox \"Sorry there are not enough rows in the sheet\"\n                        BaseWks.Columns.AutoFit\n                        mybook.Close savechanges:=False\n                        GoTo ExitTheSub\n                    Else\n\n                        'Copy the file name in column A\n                        With sourceRange\n                            BaseWks.cells(rnum, \"A\"). _\n                                    Resize(.Rows.Count).Value = MyFiles(Fnum)\n                        End With\n\n                        'Set the destrange\n                        Set destrange = BaseWks.Range(\"B\" &amp; rnum)\n\n                        'we copy the values from the sourceRange to the destrange\n                        With sourceRange\n                            Set destrange = destrange. _\n                                            Resize(.Rows.Count, .Columns.Count)\n                        End With\n                        destrange.Value = sourceRange.Value\n\n                        rnum = rnum + SourceRcount\n                    End If\n                End If\n                mybook.Close savechanges:=False\n            End If\n\n        Next Fnum\n        BaseWks.Columns.AutoFit\n    End If\n\nExitTheSub:\n    'Restore ScreenUpdating, Calculation and EnableEvents\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://www.rondebruin.nl/win/s3/win008.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s3/win008.htm</a></p>\n"}], "owner": {"reputation": 95, "user_id": 7900306, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/745e563f4d288ccdcd3d2e736d67160f?s=128&d=identicon&r=PG&f=1", "display_name": "harsha kazama", "link": "https://stackoverflow.com/users/7900306/harsha-kazama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11147, "favorite_count": 0, "accepted_answer_id": 50478275, "answer_count": 2, "score": -3, "last_activity_date": 1565596140, "creation_date": 1527031054, "last_edit_date": 1531164843, "question_id": 50477715, "link": "https://stackoverflow.com/questions/50477715/merging-multiple-workbooks-into-single-sheet-in-current-workbook", "title": "Merging multiple workbooks into single sheet in current workbook", "body": "<p>I need VBA code to select multiple workbooks by browsing the files and then merge all those into 1 sheet of current workbook.</p>\n\n<p>All multiple workbooks having only 1 sheet</p>\n\n<p>headers is same for all workbooks so header is constant</p>\n\n<p>Merging should not get any empty rows while filling workbook by workbook</p>\n\n<p>No repetition of headers when merging. </p>\n\n<p>When 1st workbook merging is done, 2nd workbook data should be merged in the same sheet of current workbook exactly next row of the merged 1st workbook data ends which means no empty rows or gaps</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1527031206, "post_id": 50477678, "comment_id": 87968994, "body": "In the second, <code>Range(&quot;B5:92&quot;)</code> is malformed but overall you either don&#39;t have a worksheet named Sheet8 or one names Sheet10 or both. Note name, not codename. You probably have them as codenames."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6095724"}, "edited": false, "score": 0, "creation_date": 1527079549, "post_id": 50477678, "comment_id": 87990393, "body": "Not true.  I know the difference.  I do have sheet 8 and sheet 10. Those sheets are code named something entirely different - &quot;Training Log&quot; and &quot;Shop Employees&quot; respectively.  I did catch that missing letter in the range but that is not the issue either.  Same issue even if I make it (&quot;B5&quot;) instead of (&quot;B5:B92&quot;)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6095724"}, "edited": false, "score": 0, "creation_date": 1527079701, "post_id": 50477678, "comment_id": 87990503, "body": "Derp!  I totally blew that!  thanks for the answer."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1527031407, "creation_date": 1527031407, "answer_id": 50477769, "question_id": 50477678, "link": "https://stackoverflow.com/questions/50477678/copy-paste-subscript-out-of-range-error/50477769#50477769", "title": "Copy/Paste - Subscript out of range error", "body": "<p>If you want to use <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-codename-property-excel\" rel=\"nofollow noreferrer\">worksheet codenames</a> instead of <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-name-property-excel\" rel=\"nofollow noreferrer\">worksheet names</a> the syntax is different.</p>\n\n<pre><code>Sub ApacheGetCopyOfLogList()\n    Sheet8.Range(\"B5:B92\").Copy _\n        Destination:=Sheet10.Range(\"B5\")\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6095724"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 50477769, "answer_count": 1, "score": 1, "last_activity_date": 1527084752, "creation_date": 1527030785, "last_edit_date": 1527084752, "question_id": 50477678, "link": "https://stackoverflow.com/questions/50477678/copy-paste-subscript-out-of-range-error", "title": "Copy/Paste - Subscript out of range error", "body": "<p>I searched and did not find an exact duplicate of my question.  Maybe it's out there but I did not find it.</p>\n\n<p>I and using the following simple code to copy a range from one sheet to a range on another sheet.</p>\n\n<pre><code>Sub ApacheGetCopyOfLogList()\n    Sheets(\"Sheet8\").Range(\"B5:B92\").Copy _\n        Destination:=Sheets(\"Sheet10\").Range(\"B5\")\nEnd Sub\n</code></pre>\n\n<p>I have also tried:</p>\n\n<pre><code>Sub ApacheGetCopyOfLogList()\n    Sheets(\"Sheet8\").Range(\"B5:B92\").Copy _\n        Destination:=Sheets(\"Sheet10\").Range(\"B5:92\")\nEnd Sub\n</code></pre>\n\n<p>--thinking that destination range may need to be the same size, but that is not true.  I still get the same error.</p>\n\n<p>It has to be something about how I am referring to the different worksheets.  I say this since the following code always works without fail:</p>\n\n<pre><code>Sub Something\n    Range(\"L5:M1000\").Copy _\n        Destination:=Range(\"A5\")\nEnd Sub\n</code></pre>\n\n<p>I just can't see what I am getting wrong.  It's probably super simple!  But it's the end of a long day and I need some guidance.  Thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7410, "user_id": 2353523, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RXiBc.jpg?s=128&g=1", "display_name": "soulshined", "link": "https://stackoverflow.com/users/2353523/soulshined"}, "edited": false, "score": 0, "creation_date": 1527047244, "post_id": 50477666, "comment_id": 87972479, "body": "if you want to see if a table is empty just count how many rows it has, and per skipping the macro thats just simple logic validation. I will mark as duplicate because the fundamental question is the same. See the link attached, and make sure you read some comments as they are helpful"}, {"owner": {"reputation": 7410, "user_id": 2353523, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RXiBc.jpg?s=128&g=1", "display_name": "soulshined", "link": "https://stackoverflow.com/users/2353523/soulshined"}, "edited": false, "score": 0, "creation_date": 1527047252, "post_id": 50477666, "comment_id": 87972482, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/29639474/vba-counting-rows-in-a-table-list-object\">VBA: Counting rows in a table (list object)</a>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1527047903, "post_id": 50477666, "comment_id": 87972596, "body": "How is your filtering the table and then copying the <code>DataBodyRange</code> working as you say it is? Sounds like you only want to copy the visible cells after filtered - but you&#39;re copying the <b>entire</b> <code>DataBodyRange</code>... (?). Same goes for clearing the <code>DataBodyRange</code> at the end."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 7410, "user_id": 2353523, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RXiBc.jpg?s=128&g=1", "display_name": "soulshined", "link": "https://stackoverflow.com/users/2353523/soulshined"}, "edited": false, "score": 2, "creation_date": 1527048702, "post_id": 50477666, "comment_id": 87972764, "body": "@soulshined I&#39;d suggest OP use <code>WorksheetFunction.CountA</code> instead of counting rows - the table could have no data but still be formatted as a bunch of blank rows. Your referenced question is still helpful in this regard."}, {"owner": {"reputation": 7410, "user_id": 2353523, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RXiBc.jpg?s=128&g=1", "display_name": "soulshined", "link": "https://stackoverflow.com/users/2353523/soulshined"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1527049046, "post_id": 50477666, "comment_id": 87972845, "body": "You bring up a valid point @BigBen , but thats included in the link I provided as a possible solution. And that&#39;s why I mentioned reading comments :P"}, {"owner": {"reputation": 7, "user_id": 9661359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ab1e23c1eeb59082928220371b0e525?s=128&d=identicon&r=PG&f=1", "display_name": "Calmatt", "link": "https://stackoverflow.com/users/9661359/calmatt"}, "reply_to_user": {"reputation": 7410, "user_id": 2353523, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RXiBc.jpg?s=128&g=1", "display_name": "soulshined", "link": "https://stackoverflow.com/users/2353523/soulshined"}, "edited": false, "score": 0, "creation_date": 1527090965, "post_id": 50477666, "comment_id": 87998394, "body": "My reply was apparently too large for a comment. I&#39;ve edited my post instead @soulshined"}], "owner": {"reputation": 7, "user_id": 9661359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ab1e23c1eeb59082928220371b0e525?s=128&d=identicon&r=PG&f=1", "display_name": "Calmatt", "link": "https://stackoverflow.com/users/9661359/calmatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1364, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527090922, "creation_date": 1527030690, "last_edit_date": 1527090922, "question_id": 50477666, "link": "https://stackoverflow.com/questions/50477666/determine-if-table-is-empty-then-skip-rest-of-macro", "title": "Determine if table is empty, then skip rest of macro", "body": "<p>The code below is what I used to compare entries between two tabs on a worksheet. There is a helper column on the table object OpenComplaints labeled CCMS Notification. It searches for a match on the table object OpenQns. If there is no match it returns #N/A.</p>\n\n<p>The purpose of this macro is to autofilter column CCMS Notification on table OpenComplaints for #N/A, then copy over the DataBodyRange and paste these results onto a third tab. It then deletes the entries from OpenComplaints that were copied over.</p>\n\n<p>This all works great. However it breaks down if the table is empty. I want this to skip the macro if the table is empty. I've spent a few hours trying many examples from google and stackoverflow and I just can't seem to get any examples to work, so I apologize if this has been asked elsewhere but I can't seem to get other people's code to work. Currently, if the table is empty it selects the entire table (even when autofiltered) and then deletes the entries. </p>\n\n<p>Ideally, I'd like to use as many structured references as possible as the risk of people adding or removing columns is high on this worksheet.</p>\n\n<p>This is my code</p>\n\n<pre><code>Sub DeleteClosedQns()\n'\n' DeleteClosedQns Macro\n\nIf Range(\"D9\").Value = \"\" Then\nDim response As VbMsgBoxResult\nresponse = MsgBox(\"Previous step is not marked as complete. Proceed?\", vbYesNo)\nIf response = vbNo Then\n    Exit Sub\nEnd If\nEnd If\n\n'Checks if the previous step was completed, as marked by a X.\n\nSheets(\"BP -Tracker - Open Complaints\").Select\nSheets(\"BP -Tracker - Open Complaints\").ListObjects(\"OpenComplaints\").Range.AutoFilter Field:=2, Criteria1:= _\n    \"#N/A\"\nSheets(\"BP -Tracker - Open Complaints\").ListObjects(\"OpenComplaints\").DataBodyRange.Copy\n\n' Sets AutoFilter to #N/A, then copies the table body\n\nSheets(\"YTD History Closed\").Select\nWith activesheets\nDim LastRow As Long\n    LastRow = Sheets(\"YTD History Closed\").ListObjects(\"ClosedQns\").Range.Columns(4).Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row + 1\nEnd With\n\nRange(\"A\" &amp; LastRow).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\n' Navigates to the History Closed tab, calculates the last row used\n' Then pastes with special values\n\nSheets(\"BP -Tracker - Open Complaints\").Select\nSheets(\"BP -Tracker - Open Complaints\").ListObjects(\"OpenComplaints\").DataBodyRange.ClearContents\n\n' Selects the entries that have been copied over, then deletes them\n\nIf Sheets(\"BP -Tracker - Open Complaints\").ListObjects(\"OpenComplaints\").ShowAutoFilter Then\n    Sheets(\"BP -Tracker - Open Complaints\").ListObjects(\"OpenComplaints\").Range.AutoFilter\nEnd If\n\n' Removes the data filter\n\nSheets(\"Instructions\").Select\nRange(\"D10\", \"D10\").Value = \"X\"\n' Marks the step as complete with an X\n\nEnd Sub\n</code></pre>\n\n<p>edit: @soulshined. I'm glad it's just simple logic validation. However I've mentioned that I'm having trouble with it. Please don't disregard my question just because it's simple to you.</p>\n\n<p>@bigben sorry yes, I'm copying only the filtered data. Then later deleting the filtered data. It only copies the entire range if there are no results from autofilter, which is an error I'm trying to avoid.</p>\n\n<p>I tried CountA with the following test code\n     Sheets(\"BP -Tracker - Open Complaints\").ListObjects(\"OpenComplaints\").Range.AutoFilter Field:=2, Criteria1:= _\n        \"#N/A\"</p>\n\n<pre><code>If WorksheetFunction.CountA(Range(\"OpenComplaints[CCMS Notification]\")) &gt; 0 Then\nMsgBox (\"&gt; 0\")\nEnd If\nIf WorksheetFunction.CountA(Range(\"OpenComplaints[CCMS Notification]\")) = 0 Then\nMsgBox (\"Empty\")\nEnd If\n</code></pre>\n\n<p>It's not actually telling me if a filtered table is empty. It seems to count even hidden columns, as my table OpenComplaints has no \"#N/A\" entries and is empty when I apply that filter. XlCellTypeVisible doesn't appear to work with CountA.</p>\n\n<p>Thank you for showing me that other question, however the fundamental question is not a duplicate.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9465005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/619bdb05fffb24492789530d2d3e6503?s=128&d=identicon&r=PG&f=1", "display_name": "yomomo", "link": "https://stackoverflow.com/users/9465005/yomomo"}, "edited": false, "score": 0, "creation_date": 1527031167, "post_id": 50477545, "comment_id": 87968986, "body": "It works but the problem now is that it only works if there already is a sheet called Statistics. It says that subscript is out of range if i don&#39;t already have sheet called Statistics"}, {"owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "reply_to_user": {"reputation": 5, "user_id": 9465005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/619bdb05fffb24492789530d2d3e6503?s=128&d=identicon&r=PG&f=1", "display_name": "yomomo", "link": "https://stackoverflow.com/users/9465005/yomomo"}, "edited": false, "score": 0, "creation_date": 1527031574, "post_id": 50477545, "comment_id": 87969088, "body": "@yomomo. Fixed it."}], "tags": [], "owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "is_accepted": true, "score": 1, "last_activity_date": 1527031536, "last_edit_date": 1527031536, "creation_date": 1527029840, "answer_id": 50477545, "question_id": 50477412, "link": "https://stackoverflow.com/questions/50477412/overwrite-sheet-if-it-exists/50477545#50477545", "title": "Overwrite sheet if it exists", "body": "<p>The problem is this piece of code:</p>\n\n<pre><code>Sheets.Add After:=ActiveSheet\nOn Error Resume Next\nSheets.Add().Name = \"Statistics\"\nOn Error GoTo 0\n</code></pre>\n\n<p>This basically tells Excel to add a new sheet after the active sheet and when you run the macro the second time, the sheetname \"Statistics\" is already taken. (And if it wasn't for <code>On error resume next</code>, an error message would appear the second time). Add this at the top of your macro instead:</p>\n\n<pre><code>Dim newSheet As Worksheet\n\nApplication.DisplayAlerts = False\n\nSet newSheet = Sheets.Add(After:=ActiveSheet)\nWith newSheet\n    On Error Resume Next\n    ThisWorkbook.Sheets(\"Statistics\").Delete\n    On Error GoTo 0\n    .name = \"Statistics\"\nEnd With\n\nApplication.DisplayAlerts = True\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9465005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/619bdb05fffb24492789530d2d3e6503?s=128&d=identicon&r=PG&f=1", "display_name": "yomomo", "link": "https://stackoverflow.com/users/9465005/yomomo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 50477545, "answer_count": 1, "score": 0, "last_activity_date": 1527031536, "creation_date": 1527028806, "question_id": 50477412, "link": "https://stackoverflow.com/questions/50477412/overwrite-sheet-if-it-exists", "title": "Overwrite sheet if it exists", "body": "<p>I recorded a macro that makes some pivot tables in a new sheet and it works fine, so i tried to make it able to overwrite if the sheet already existed but i can't seem to make it work. The problem is that when i use the macro once it does add the new sheet but it also adds another one on top of the one already made, and when i try to use the macro again to see if it overwrites the other one, it doesn't it just adds another unnamed sheet.\nThe code looks like this:</p>\n\n<pre><code>Sub Makro7()\n\nSheets.Add After:=ActiveSheet\nOn Error Resume Next\nSheets.Add().Name = \"Statistics\"\nOn Error GoTo 0\n\nActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n    \"Base!R1C1:R18288C12\", Version:=6).CreatePivotTable TableDestination:= _\n    \"Statistics!R1C1\", TableName:=\"Pivottabel22\", DefaultVersion:=6\nSheets(\"Statistics\").Select\nCells(1, 1).Select\nActiveSheet.PivotTables(\"Pivottabel22\").AddDataField ActiveSheet.PivotTables( _\n    \"Pivottabel22\").PivotFields(\"FACULTY_ID\"), \"Antal af FACULTY_ID\", xlCount\nWith ActiveSheet.PivotTables(\"Pivottabel22\").PivotFields(\"FACULTY_ID\")\n    .Orientation = xlColumnField\n    .Position = 1\nEnd With\nWith ActiveSheet.PivotTables(\"Pivottabel22\").PivotFields(\"PROGRAM_TYPE_NAME\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\nRange(\"A1\").Select\nActiveSheet.PivotTables(\"Pivottabel22\").DataPivotField.PivotItems( _\n    \"Antal af FACULTY_ID\").Caption = \"Antal\"\nRange(\"B1\").Select\nActiveSheet.PivotTables(\"Pivottabel22\").CompactLayoutColumnHeader = \"Fakultet\"\nRange(\"A7\").Select\nActiveWorkbook.Worksheets(\"Statistics\").PivotTables(\"Pivottabel22\").PivotCache. _\n    CreatePivotTable TableDestination:=\"Statistics!R7C1\", TableName:= _\n    \"Pivottabel23\", DefaultVersion:=6\nSheets(\"Statistics\").Select\nCells(7, 1).Select\nActiveSheet.PivotTables(\"Pivottabel23\").AddDataField ActiveSheet.PivotTables( _\n    \"Pivottabel23\").PivotFields(\"FACULTY_ID\"), \"Antal af FACULTY_ID\", xlCount\nWith ActiveSheet.PivotTables(\"Pivottabel23\").PivotFields(\"PROGRAM_TYPE_NAME\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\nWith ActiveSheet.PivotTables(\"Pivottabel23\").PivotFields(\"FACULTY_ID\")\n    .Orientation = xlColumnField\n    .Position = 1\nEnd With\nWith ActiveSheet.PivotTables(\"Pivottabel23\").PivotFields(\"Antal af FACULTY_ID\")\n    .Calculation = xlPercentOfTotal\n    .NumberFormat = \"0.00%\"\nEnd With\nRange(\"A7\").Select\nActiveSheet.PivotTables(\"Pivottabel23\").DataPivotField.PivotItems( _\n    \"Antal af FACULTY_ID\").Caption = \"Procentvis\"\nRange(\"B7\").Select\nActiveSheet.PivotTables(\"Pivottabel23\").CompactLayoutColumnHeader = \"Fakultet\"\nRange(\"A13\").Select\nActiveWorkbook.Worksheets(\"Statistics\").PivotTables(\"Pivottabel23\").PivotCache. _\n    CreatePivotTable TableDestination:=\"Statistics!R13C1\", TableName:= _\n    \"Pivottabel24\", DefaultVersion:=6\nSheets(\"Statistics\").Select\nCells(13, 1).Select\nActiveSheet.PivotTables(\"Pivottabel24\").AddDataField ActiveSheet.PivotTables( _\n    \"Pivottabel24\").PivotFields(\"ENROLL_LOCATION_NAME\"), _\n    \"Antal af ENROLL_LOCATION_NAME\", xlCount\nWith ActiveSheet.PivotTables(\"Pivottabel24\").PivotFields(\"ENROLL_LOCATION_NAME\" _\n    )\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\nRange(\"B13\").Select\nActiveSheet.PivotTables(\"Pivottabel24\").DataPivotField.PivotItems( _\n    \"Antal af ENROLL_LOCATION_NAME\").Caption = \"Antal\"\nRange(\"A13\").Select\nActiveSheet.PivotTables(\"Pivottabel24\").CompactLayoutRowHeader = \"Campus\"\nRange(\"B13\").Select\nActiveSheet.PivotTables(\"Pivottabel24\").DataPivotField.PivotItems(\"Antal\"). _\n    Caption = \"Antal af studerende\"\nRange(\"A22\").Select\nActiveWorkbook.Worksheets(\"Statistics\").PivotTables(\"Pivottabel24\").PivotCache. _\n    CreatePivotTable TableDestination:=\"Statistics!R22C1\", TableName:= _\n    \"Pivottabel25\", DefaultVersion:=6\nSheets(\"Statistics\").Select\nCells(22, 1).Select\nActiveSheet.PivotTables(\"Pivottabel25\").AddDataField ActiveSheet.PivotTables( _\n    \"Pivottabel25\").PivotFields(\"ENROLL_LOCATION_NAME\"), _\n    \"Antal af ENROLL_LOCATION_NAME\", xlCount\nWith ActiveSheet.PivotTables(\"Pivottabel25\").PivotFields(\"ENROLL_LOCATION_NAME\" _\n    )\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\nWith ActiveSheet.PivotTables(\"Pivottabel25\").PivotFields( _\n    \"Antal af ENROLL_LOCATION_NAME\")\n    .Calculation = xlPercentOfTotal\n    .NumberFormat = \"0.00%\"\nEnd With\nRange(\"A22\").Select\nActiveSheet.PivotTables(\"Pivottabel25\").CompactLayoutRowHeader = \"Campus\"\nRange(\"B22\").Select\nActiveSheet.PivotTables(\"Pivottabel25\").DataPivotField.PivotItems( _\n    \"Antal af ENROLL_LOCATION_NAME\").Caption = \"Procentvis af studerende\"\nRange(\"I1\").Select\nActiveWorkbook.Worksheets(\"Statistics\").PivotTables(\"Pivottabel25\").PivotCache. _\n    CreatePivotTable TableDestination:=\"Statistics!R1C9\", TableName:= _\n    \"Pivottabel26\", DefaultVersion:=6\nSheets(\"Statistics\").Select\nCells(1, 9).Select\nActiveSheet.PivotTables(\"Pivottabel26\").AddDataField ActiveSheet.PivotTables( _\n    \"Pivottabel26\").PivotFields(\"STUDYBOARD_ID\"), \"Antal af STUDYBOARD_ID\", xlCount\nWith ActiveSheet.PivotTables(\"Pivottabel26\").PivotFields(\"STUDYBOARD_ID\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\nRange(\"I1\").Select\nActiveSheet.PivotTables(\"Pivottabel26\").CompactLayoutRowHeader = \"Studien\u00e6vn\"\nRange(\"J1\").Select\nActiveSheet.PivotTables(\"Pivottabel26\").DataPivotField.PivotItems( _\n    \"Antal af STUDYBOARD_ID\").Caption = \"Antal af studerende\"\nRange(\"L15\").Select\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 835, "user_id": 4629624, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/218b21a18c900e28e458c815f9c04f5b?s=128&d=identicon&r=PG&f=1", "display_name": "V. Brunelle", "link": "https://stackoverflow.com/users/4629624/v-brunelle"}, "edited": false, "score": 0, "creation_date": 1527028633, "post_id": 50477259, "comment_id": 87968318, "body": "It is somehow interesting to see that error kind of has something to do with cell &quot;J9&quot;.Any idea why? Is it always the same? On your screenshot, your other documents are opened. What happen if you close them? Can it be an interfering maccro?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1527029338, "post_id": 50477259, "comment_id": 87968510, "body": "This is strange. Most feasible and sensible solution is to get your Excel re-installed."}, {"owner": {"reputation": 1, "user_id": 9495834, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alex Xu", "link": "https://stackoverflow.com/users/9495834/alex-xu"}, "edited": false, "score": 0, "creation_date": 1527030083, "post_id": 50477259, "comment_id": 87968708, "body": "&quot;A1&quot; or &quot;J9&quot; is not a problem, the main focus here is this Macro recorder does not give me any object before &quot;.&quot;, and this made the value 222 with no place to store, this is really weird. I have worked with some complicated VB task before, never saw this problem"}, {"owner": {"reputation": 1, "user_id": 9495834, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alex Xu", "link": "https://stackoverflow.com/users/9495834/alex-xu"}, "edited": false, "score": 0, "creation_date": 1527030377, "post_id": 50477259, "comment_id": 87968782, "body": "Thank for the reply guys, I close all the other documents except for the one I use, still it does not help,if I got the answer by myself or from other persons I will let you know why this problem happen and how to solve it!"}, {"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1527030958, "post_id": 50477259, "comment_id": 87968936, "body": "What version of Office/Excel are you using? Is it the same on both machines?"}, {"owner": {"reputation": 1, "user_id": 9495834, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alex Xu", "link": "https://stackoverflow.com/users/9495834/alex-xu"}, "edited": false, "score": 0, "creation_date": 1527031411, "post_id": 50477259, "comment_id": 87969042, "body": "Both excel 2016"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1527057553, "post_id": 50477259, "comment_id": 87975863, "body": "I think this came up in a question last week where the computer in question was a new one. A re-install was the answer.  @ashleedawg - that ring any bells?"}, {"owner": {"reputation": 1, "user_id": 9495834, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alex Xu", "link": "https://stackoverflow.com/users/9495834/alex-xu"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527089234, "post_id": 50477259, "comment_id": 87997256, "body": "Oh yeah man! my workplace is using a brand new computer and we will do this today, hope it will work and I will feed you back if it really works @QHarr"}, {"owner": {"reputation": 1, "user_id": 9495834, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alex Xu", "link": "https://stackoverflow.com/users/9495834/alex-xu"}, "edited": false, "score": 0, "creation_date": 1527180893, "post_id": 50477259, "comment_id": 88041484, "body": "The only way to solve this problem is to re-install excel! All other ways failed,thanks guys"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9495834, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alex Xu", "link": "https://stackoverflow.com/users/9495834/alex-xu"}, "edited": false, "score": 0, "creation_date": 1527031347, "post_id": 50477682, "comment_id": 87969026, "body": "Thanks Bro, I think the best way is to re-install Excel and I will try that"}, {"owner": {"reputation": 1, "user_id": 9495834, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alex Xu", "link": "https://stackoverflow.com/users/9495834/alex-xu"}, "edited": false, "score": 0, "creation_date": 1527180873, "post_id": 50477682, "comment_id": 88041471, "body": "The only way to solve this problem is to re-install excel! All other ways failed, thanks man!"}], "tags": [], "owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "is_accepted": false, "score": 1, "last_activity_date": 1527030810, "creation_date": 1527030810, "answer_id": 50477682, "question_id": 50477259, "link": "https://stackoverflow.com/questions/50477259/cant-record-super-simple-macros-on-my-workplace-computer/50477682#50477682", "title": "Can&#39;t record super simple macros on my workplace computer", "body": "<p>I found a similar question asked on an MS Forum <a href=\"https://techcommunity.microsoft.com/t5/Excel/Excel-Macro-Recording-Generate-Wrong-VBA/td-p/190857\" rel=\"nofollow noreferrer\">https://techcommunity.microsoft.com/t5/Excel/Excel-Macro-Recording-Generate-Wrong-VBA/td-p/190857</a></p>\n\n<p>The user fixed the issue by re-installing Office. That would be the surest way to fix the issue, but you could just try a repair first as it might work and would be quicker.</p>\n\n<p>FWIW, I've used Excel macros for over 20 years and have never seen this problem.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9495834, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alex Xu", "link": "https://stackoverflow.com/users/9495834/alex-xu"}, "is_accepted": false, "score": 0, "last_activity_date": 1527180829, "creation_date": 1527180829, "answer_id": 50514504, "question_id": 50477259, "link": "https://stackoverflow.com/questions/50477259/cant-record-super-simple-macros-on-my-workplace-computer/50514504#50514504", "title": "Can&#39;t record super simple macros on my workplace computer", "body": "<p>The only way to solve this problem is to re-install excel! All other ways failed.\nThanks to the guys who answered my questions and have a nice day!</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10256545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a21676e2bbc07682b3e7c0287ed4d7bb?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/10256545/ben"}, "is_accepted": false, "score": 1, "last_activity_date": 1534880283, "creation_date": 1534880283, "answer_id": 51955591, "question_id": 50477259, "link": "https://stackoverflow.com/questions/50477259/cant-record-super-simple-macros-on-my-workplace-computer/51955591#51955591", "title": "Can&#39;t record super simple macros on my workplace computer", "body": "<p>I was able to correct this situation by turning off \"AutoSave\". This resolved two things for me:</p>\n\n<ul>\n<li>The errors when attempting to Record a Marco</li>\n<li>Situations where my macros aborted for no apparent reason shutting down Excel</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 9495834, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alex Xu", "link": "https://stackoverflow.com/users/9495834/alex-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1534880283, "creation_date": 1527027789, "last_edit_date": 1529331720, "question_id": 50477259, "link": "https://stackoverflow.com/questions/50477259/cant-record-super-simple-macros-on-my-workplace-computer", "title": "Can&#39;t record super simple macros on my workplace computer", "body": "<p>This should be a super simple macro, but it just doesn't record properly.\nI just wanna record a macro every time I run it, it inputs number 222 in the activecell. </p>\n\n<p>When I do record this macro on my own laptop,it is recorded as below:</p>\n\n<p><code>Sub Macro8()\n    ActiveCell.FormulaR1C1 = \"222\"\n    Range(\"A1\").Select\nEnd Sub</code></p>\n\n<p>Macro9 does not work and return me a error</p>\n\n<p>But when I do the exact same thing on my workplace computer, it is recorded as below:</p>\n\n<pre><code>Sub Macro9()\n    . = \"222\"\n    Range(\"A1\").ErrorString\nEnd Sub\n</code></pre>\n\n<p>Never see this before, tried many ways to solve this but failed. Someone has an idea of what is going on? Thanks a ton in advance!</p>\n\n<p><img src=\"https://i.stack.imgur.com/cf4pM.png\" alt=\"this is the screen shot\"></p>\n\n<p>===========================================================================\nI found a better way to describe this problem, wish this could help you guys understand what I am saying better!\nIn my own laptop, when I select Cell-A1, VB editor shows:</p>\n\n<pre><code>Range(\"A1\").Select\n</code></pre>\n\n<p>On my workplace computer, when I select Cell-A1, VB editor shows:</p>\n\n<pre><code>Range(\"A1\").ErrorString\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos", "user-defined-functions"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1527026804, "post_id": 50477043, "comment_id": 87967765, "body": "@ScottCraner - that question is the source of the posted code"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1527026842, "post_id": 50477043, "comment_id": 87967776, "body": "@TimWilliams and either of the other two answers will already ignore the text."}, {"owner": {"reputation": 33, "user_id": 9831006, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x4Ns4oH417I/AAAAAAAAAAI/AAAAAAAABhg/DsuQW7qK3Kc/photo.jpg?sz=128", "display_name": "Hayden Shirts", "link": "https://stackoverflow.com/users/9831006/hayden-shirts"}, "edited": false, "score": 0, "creation_date": 1527027052, "post_id": 50477043, "comment_id": 87967832, "body": "one of the answeres used regular expressions which im having troubles working on a mac and the other is an array formula which isnt working in this setting either"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1527027063, "post_id": 50477043, "comment_id": 87967840, "body": "@ScottCraner - granted.  It seemed the OP was trying to figure out how to fix the code they had..."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1527027271, "post_id": 50477043, "comment_id": 87967905, "body": "I reopened but it should be asked, what have you tried to adjust the code on your own?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1527027556, "post_id": 50477043, "comment_id": 87967995, "body": "@HaydenShirts  I posted an update.............the problem is that a string like <b>&quot;(text values)&quot;</b> was being reduced to <b>&quot;()&quot;</b> which the code could not handle."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1527028819, "last_edit_date": 1527028819, "creation_date": 1527027529, "answer_id": 50477211, "question_id": 50477043, "link": "https://stackoverflow.com/questions/50477043/edit-vba-udf-to-sum-numbers-in-parenthesis-while-ignoring-words-in-parenthesis/50477211#50477211", "title": "Edit VBA UDF to sum numbers in parenthesis while ignoring words in parenthesis", "body": "<p>Here is a late-bound <a href=\"/questions/tagged/regex\" class=\"post-tag\" title=\"show questions tagged &#39;regex&#39;\" rel=\"tag\">regex</a> udf.</p>\n\n<pre><code>Function sumNums(str As String) As Double\n    Dim n As Long\n    Static rgx As Object, cmat As Object\n\n    'with rgx as static, it only has to be created once; beneficial when filling a long column with this UDF\n    If rgx Is Nothing Then\n        Set rgx = CreateObject(\"VBScript.RegExp\")\n    End If\n\n    sumNums = 0\n\n    With rgx\n        .Global = True\n        .MultiLine = False\n        .Pattern = \"\\(\\d+(\\.\\d{1,2})?\\)\"\n        If .Test(str) Then\n            Set cmat = .Execute(str)\n            'sum the matches\n            For n = 0 To cmat.Count - 1\n                sumNums = sumNums + Abs(CDbl(cmat.Item(n)))\n            Next n\n        End If\n    End With\nEnd Function\n</code></pre>\n\n<p>For an <a href=\"/questions/tagged/excel-vba-mac\" class=\"post-tag\" title=\"show questions tagged &#39;excel-vba-mac&#39;\" rel=\"tag\">excel-vba-mac</a> that has trouble with <a href=\"/questions/tagged/regex\" class=\"post-tag\" title=\"show questions tagged &#39;regex&#39;\" rel=\"tag\">regex</a> this is the simplest I could come up with.</p>\n\n<pre><code>Option Explicit\n\nPublic Function Addum(str As String) As Double\n    Dim i As Long, j As Long, tmp As Variant\n\n    tmp = Split(str, Chr(40))\n\n    For i = LBound(tmp) + 1 To UBound(tmp)\n        If IsNumeric(Split(tmp(i), Chr(41))(0)) Then _\n            Addum = Application.Sum(Addum, Split(tmp(i), Chr(41))(0))\n    Next i\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/KGLLq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KGLLq.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1527029895, "post_id": 50477248, "comment_id": 87968659, "body": "This is MUCH better than my approach..........I never considered testing if in-between the parens"}, {"owner": {"reputation": 33, "user_id": 9831006, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x4Ns4oH417I/AAAAAAAAAAI/AAAAAAAABhg/DsuQW7qK3Kc/photo.jpg?sz=128", "display_name": "Hayden Shirts", "link": "https://stackoverflow.com/users/9831006/hayden-shirts"}, "edited": false, "score": 0, "creation_date": 1527096868, "post_id": 50477248, "comment_id": 88001467, "body": "@TimWilliams is there a way to get it to ignore dates i.e (9 /4) would end up adding on 13 to the final answer and (9/4/16) would add 29 to the final answer.  \u2013 Hayden Shirts"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1527116253, "post_id": 50477248, "comment_id": 88009996, "body": "Yes there likely is - why not give it a shot?"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1527027737, "creation_date": 1527027737, "answer_id": 50477248, "question_id": 50477043, "link": "https://stackoverflow.com/questions/50477043/edit-vba-udf-to-sum-numbers-in-parenthesis-while-ignoring-words-in-parenthesis/50477248#50477248", "title": "Edit VBA UDF to sum numbers in parenthesis while ignoring words in parenthesis", "body": "<pre><code>Public Function Addum(rng As Range) As Double\n    Dim s As String, temp As String, i As Long\n    Dim CH As String, inParens As Boolean, q As String\n    s = rng.Value\n    For i = 1 To Len(s)\n        CH = Mid(s, i, 1)\n        If CH = \"(\" Then\n            inParens = True\n            q = \"\"\n        ElseIf CH = \")\" Then\n            inParens = False\n            temp = temp &amp; \" \" &amp; q\n        Else\n            If inParens Then q = q &amp; _\n               IIf(CH Like \"[0-9]\" Or CH = \".\", CH, \" \")\n        End If\n    Next i\n\n    temp = Application.WorksheetFunction.Trim(temp)\n    arr = Split(temp, \" \")\n    For Each a In arr\n        If IsNumeric(a) Then Addum = Addum + CDbl(a)\n    Next a\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9831006, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x4Ns4oH417I/AAAAAAAAAAI/AAAAAAAABhg/DsuQW7qK3Kc/photo.jpg?sz=128", "display_name": "Hayden Shirts", "link": "https://stackoverflow.com/users/9831006/hayden-shirts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 0, "accepted_answer_id": 50477248, "answer_count": 2, "score": 1, "last_activity_date": 1593629564, "creation_date": 1527026404, "last_edit_date": 1593629564, "question_id": 50477043, "link": "https://stackoverflow.com/questions/50477043/edit-vba-udf-to-sum-numbers-in-parenthesis-while-ignoring-words-in-parenthesis", "title": "Edit VBA UDF to sum numbers in parenthesis while ignoring words in parenthesis", "body": "<p>I have a UDF that will look in a given cell for numbers inside of parenthesis then sum all numbers inside of parenthesis in a given cell, it works well 90% of the time but when I have something inside of parenthesis that is not a number i.e a word or phrase, it will return #VALUE! I'm trying to fix this so that it will ignore words etc that are inside parenthesis. Also for some reason, having a &quot;.&quot; after parenthesis makes it so that the numbers in the parenthesis before the &quot;.&quot; are ignored when they shouldn't be.</p>\n<h3>screenshot of problems explained above</h3>\n<p><img src=\"https://i.stack.imgur.com/N4D7n.png\" alt=\"screenshot of problems explained above\" /></p>\n<p>The function is as follows</p>\n<pre><code>Public Function Addum(rng As Range) As Double\n    Dim s As String, L As Long, temp As String\n    Dim CH As String\n    s = rng.Value\n    L = Len(s)\n    For i = 1 To L\n        CH = Mid(s, i, 1)\n        If CH Like &quot;[0-9]&quot; Or CH = &quot;.&quot; Or CH = &quot;(&quot; Or CH = &quot;)&quot; Then\n            temp = temp &amp; CH\n        Else\n            temp = temp &amp; &quot; &quot;\n        End If\n    Next i\n\n    temp = Application.WorksheetFunction.Trim(temp)\n    arr = Split(temp, &quot; &quot;)\n    For Each a In arr\n        If Left(a, 1) = &quot;(&quot; Then\n            a = Mid(a, 2, Len(a) - 2)\n            If IsNumeric(a) Then\n                Addum = Addum + CDbl(a)\n            End If\n        End If\n    Next a\nEnd Function\n</code></pre>\n<p>this question is different from <a href=\"https://stackoverflow.com/questions/50280451/excel-sum-numbers-inside-a-text-block-in-a-cell\">Excel: Sum numbers inside a text block in a cell</a>\nbecause im asking for it to work when there are words inside of parenthesis present and when there are &quot;.&quot; after the parenthesis.</p>\n<p>thanks in advance for any help that you can provide!</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 113, "user_id": 2986237, "user_type": "registered", "profile_image": "https://graph.facebook.com/655524639/picture?type=large", "display_name": "WiLLyxVKei", "link": "https://stackoverflow.com/users/2986237/willyxvkei"}, "edited": false, "score": 0, "creation_date": 1527028465, "post_id": 50476987, "comment_id": 87968270, "body": "In the code  you wrote before, <code>rcrdAdd</code> is only doing &quot;INSERT INTO&quot;. You should check all your code, clean your execute statement or maybe is a thrigger in SQL which start at INSERT in this table."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7426729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NfJwE.jpg?s=128&g=1", "display_name": "jaekma", "link": "https://stackoverflow.com/users/7426729/jaekma"}, "edited": false, "score": 0, "creation_date": 1527032491, "post_id": 50477635, "comment_id": 87969325, "body": "thank you dbmitch I don&#39;t know why I couldn&#39;t see this probably looking at it too long."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 13, "user_id": 7426729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NfJwE.jpg?s=128&g=1", "display_name": "jaekma", "link": "https://stackoverflow.com/users/7426729/jaekma"}, "edited": false, "score": 0, "creation_date": 1527033725, "post_id": 50477635, "comment_id": 87969635, "body": "No problem - sometimes a second set of eyes helps"}], "tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": true, "score": 0, "last_activity_date": 1527030496, "creation_date": 1527030496, "answer_id": 50477635, "question_id": 50476987, "link": "https://stackoverflow.com/questions/50476987/ms-access-updating-first-record-when-adding-record/50477635#50477635", "title": "MS-Access updating first record when adding record", "body": "<p>Your form is bound to a the table's recordsource and it looks like you've created a project number text box that is bound to the field </p>\n\n<p>Then it looks like you're typing in the new project number (<code>ProjectNumber.Value</code>) for the Insert.</p>\n\n<p>That will automatically update the current record when you leave - most likely you're opening the form to the first record in the table</p>\n\n<p>Just create a new TEXTBOX that is  UNBOUND - and use that in your <code>INSERT INTO</code> SQL instead of <code>ProjectNumber.Value</code></p>\n"}], "owner": {"reputation": 13, "user_id": 7426729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NfJwE.jpg?s=128&g=1", "display_name": "jaekma", "link": "https://stackoverflow.com/users/7426729/jaekma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 50477635, "answer_count": 1, "score": 0, "last_activity_date": 1527030578, "creation_date": 1527026111, "last_edit_date": 1527030578, "question_id": 50476987, "link": "https://stackoverflow.com/questions/50476987/ms-access-updating-first-record-when-adding-record", "title": "MS-Access updating first record when adding record", "body": "<p>I'm fairly new to access but not to vba. I have a form that inserts data to a table with vba </p>\n\n<pre><code>rcrdAdd = \"INSERT INTO \" &amp; timeTbl &amp; \" (ProjectNumber, AssignedTo, Task, taskStart) VALUES ('\" &amp; ProjectNumber.Value &amp; \"', '\" &amp; combobox.value &amp; \"', '\" &amp; combobox.value &amp; \"', '\" &amp; datetime.value &amp; \"');\"\n    db.Execute rcrdAdd, dbFailOnError\n</code></pre>\n\n<p>When i run this it does add the record but it also updates the first record in the table with the project number associated with record it just added. </p>\n\n<p>I don't know what or why. Can anyone shed any light here. I have tried to research why and can not find an answer</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 677, "user_id": 3692993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df58980e773a17b1c4258c5c143bb0e0?s=128&d=identicon&r=PG&f=1", "display_name": "TFrazee", "link": "https://stackoverflow.com/users/3692993/tfrazee"}, "edited": false, "score": 1, "creation_date": 1527025488, "post_id": 50476821, "comment_id": 87967299, "body": "Is this an actual snippet from your code? <code>FR</code> loses scope as soon as the sub ends, so it wouldn&#39;t be accessible outside the sub. Can you post a little more context?"}, {"owner": {"reputation": 43, "user_id": 9612772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e58c1893180a158bcd8b11526d4b309?s=128&d=identicon&r=PG&f=1", "display_name": "MaxF", "link": "https://stackoverflow.com/users/9612772/maxf"}, "reply_to_user": {"reputation": 677, "user_id": 3692993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df58980e773a17b1c4258c5c143bb0e0?s=128&d=identicon&r=PG&f=1", "display_name": "TFrazee", "link": "https://stackoverflow.com/users/3692993/tfrazee"}, "edited": false, "score": 0, "creation_date": 1527026158, "post_id": 50476821, "comment_id": 87967546, "body": "It is actually as simple as this. FR never gets defined, remains as &quot;Nothing&quot;. The rest of the code is running a very simple loop. Updated code is above."}, {"owner": {"reputation": 677, "user_id": 3692993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df58980e773a17b1c4258c5c143bb0e0?s=128&d=identicon&r=PG&f=1", "display_name": "TFrazee", "link": "https://stackoverflow.com/users/3692993/tfrazee"}, "edited": false, "score": 0, "creation_date": 1527031300, "post_id": 50476821, "comment_id": 87969012, "body": "Honestly, I don&#39;t see anything wrong, assuming that a sheet named &quot;FindReplace&quot; exists.  Try dropping a breakpoint on the line where you set the variable, dig down into the <code>ThisWorkbook</code> object and take a look at the <code>Worksheets</code> collection. If there&#39;s something unusual going on with this particular sheet, you may be able to find it there."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 9612772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e58c1893180a158bcd8b11526d4b309?s=128&d=identicon&r=PG&f=1", "display_name": "MaxF", "link": "https://stackoverflow.com/users/9612772/maxf"}, "edited": false, "score": 0, "creation_date": 1527028366, "post_id": 50477154, "comment_id": 87968244, "body": "Of course, I had another sub with the same name somewhere in the workbook, so it wasn&#39;t working because of the conflict. Thank you for your help!"}], "tags": [], "owner": {"reputation": 143, "user_id": 8938351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c53d73d2ce5a6b688080f28c24906da?s=128&d=identicon&r=PG&f=1", "display_name": "Kenna", "link": "https://stackoverflow.com/users/8938351/kenna"}, "is_accepted": false, "score": 0, "last_activity_date": 1527027165, "creation_date": 1527027165, "answer_id": 50477154, "question_id": 50476821, "link": "https://stackoverflow.com/questions/50476821/cant-define-workheet-in-vba/50477154#50477154", "title": "Can&#39;t define workheet in VBA", "body": "<p>The code as is seems correct. Make sure that \"FindReplace\" worksheet is in <code>ThisWorkbook</code>.</p>\n\n<p>Also, you can try to get \"FindReplace\" worksheet by <code>CodeName</code> instead of by the name of the sheet. The advantage is that if the user changes the name of the worksheet, the <code>CodeName</code> will remain the same and you won't need to update your code to the new worksheet name.</p>\n\n<pre><code>Public Function GetWsFromCodeName(codeName As String, wb As Workbook) As Worksheet\n\n    Dim ws As Worksheet\n    For Each ws In wb.Worksheets\n        If ws.CodeName = codeName Then\n           Set GetWsFromCodeName = ws\n           Exit For\n        End If\n    Next ws\n\nEnd Function\n</code></pre>\n\n<p>Add this function in your code:</p>\n\n<pre><code>Sub FindReplace()\n    Dim FRep As Worksheet\n    Set FRep = GetWsFromCodeName(\"YourCodeName\", ThisWorkbook)\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 9612772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e58c1893180a158bcd8b11526d4b309?s=128&d=identicon&r=PG&f=1", "display_name": "MaxF", "link": "https://stackoverflow.com/users/9612772/maxf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527027165, "creation_date": 1527025117, "last_edit_date": 1531164843, "question_id": 50476821, "link": "https://stackoverflow.com/questions/50476821/cant-define-workheet-in-vba", "title": "Can&#39;t define workheet in VBA", "body": "<p>Going crazy here. I use this definition of worksheet all the time. Copied every string to avoid typing errors. Still, the code below produces \"Nothing\" when I try to set FR worksheet. Pls help!</p>\n\n<pre><code>  Sub FindReplace()\n  Dim FRep As Worksheet\n  Dim c As Range\n  Dim cText As TextBox\n  Dim i As Integer\n\n  Set FRep = ThisWorkbook.Worksheets(\"FindReplace\")\n  For i = 1 To 23\n      cText = FRep.Cells(i, 3).Text\n      FRep.Cells(i, 2).NumberFormat = \"@\"\n      FRep.Cells(i, 2).Value = cText\n  Next i \n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1527023095, "post_id": 50476366, "comment_id": 87966393, "body": "shot in the dark, try : <code>sheet2.Cells(erow, 1) = cdbl(sheet1.Cells(i, 6)) * 2</code>"}, {"owner": {"reputation": 716, "user_id": 6819959, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/53e270754d794040cf238ecd9093c6eb?s=128&d=identicon&r=PG&f=1", "display_name": "S31", "link": "https://stackoverflow.com/users/6819959/s31"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1527023831, "post_id": 50476366, "comment_id": 87966677, "body": "No luck! Still gettin&#39; that type mismatch error."}, {"owner": {"reputation": 716, "user_id": 6819959, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/53e270754d794040cf238ecd9093c6eb?s=128&d=identicon&r=PG&f=1", "display_name": "S31", "link": "https://stackoverflow.com/users/6819959/s31"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1527023947, "post_id": 50476366, "comment_id": 87966722, "body": "Also not sure if this is helpful but the formats of the cells I&#39;m copying over range between General and Currency"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1527025319, "post_id": 50476366, "comment_id": 87967241, "body": "have you tried <code>.Value2</code>?  <code>sheet2.Cells(erow, 1).value = cdbl(sheet1.Cells(i, 6).value2) * 2</code>"}, {"owner": {"reputation": 716, "user_id": 6819959, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/53e270754d794040cf238ecd9093c6eb?s=128&d=identicon&r=PG&f=1", "display_name": "S31", "link": "https://stackoverflow.com/users/6819959/s31"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1527027629, "post_id": 50476366, "comment_id": 87968021, "body": "@ScottCraner still nothing!"}, {"owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 0, "creation_date": 1527035342, "post_id": 50476366, "comment_id": 87969979, "body": "What is entered in sheet1.cells(i,6)? Can you describe all variations, give examples?"}], "answers": [{"tags": [], "owner": {"reputation": 170, "user_id": 6142378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/593e89e4256dd201a541c13e29abdf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Dammer15", "link": "https://stackoverflow.com/users/6142378/dammer15"}, "is_accepted": false, "score": 0, "last_activity_date": 1527026690, "creation_date": 1527026690, "answer_id": 50477100, "question_id": 50476366, "link": "https://stackoverflow.com/questions/50476366/copy-and-paste-cell-range-while-multiplying-by-a-constant/50477100#50477100", "title": "Copy and paste cell range while multiplying by a constant", "body": "<pre><code>Dim Cell1Val As Integer\nDim Cell2Val As Integer\n\nDim lastrow As Integer\nDim i As Integer\nlastrow = 10\n\nFor i = 0 To lastrow\n\nCell1Val = Sheet2.Range(\"A1\").Offset(i, 0).Value\nCell2Val = Sheet2.Range(\"B1\").Offset(i, 0).Value\n\nSheet2.Range(\"C1\").Offset(i, 0).Value = Cell1Val * 2\n\nNext i\n</code></pre>\n\n<p>Here's the concept I use. Modify for you're application.</p>\n"}, {"comments": [{"owner": {"reputation": 716, "user_id": 6819959, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/53e270754d794040cf238ecd9093c6eb?s=128&d=identicon&r=PG&f=1", "display_name": "S31", "link": "https://stackoverflow.com/users/6819959/s31"}, "edited": false, "score": 0, "creation_date": 1527049734, "post_id": 50477730, "comment_id": 87972994, "body": "Aha! Awesome. First off - thanks for the comment, really helpful information scattered throughout. Seems like I was bringing in the title of the numeric columns with i = 1, switched it to i = 2 and the multiplicative factor worked throughout the whole column!"}], "tags": [], "owner": {"reputation": 543, "user_id": 7420518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DweYi.png?s=128&g=1", "display_name": "IvenBach", "link": "https://stackoverflow.com/users/7420518/ivenbach"}, "is_accepted": true, "score": 1, "last_activity_date": 1527031163, "creation_date": 1527031163, "answer_id": 50477730, "question_id": 50476366, "link": "https://stackoverflow.com/questions/50476366/copy-and-paste-cell-range-while-multiplying-by-a-constant/50477730#50477730", "title": "Copy and paste cell range while multiplying by a constant", "body": "<p>I'm nearly positive, as much as I can be without seeing the actual data, that you're trying to multiply a non-numeric (something textual like <code>dog</code> in a cell).</p>\n\n<p>You don't need to have any loop since only the <code>lastrow</code> variable is going to be used.</p>\n\n<p>When your code errors click <code>Debug</code> and then select <code>sheet1.Cells(lastrow, 6)</code>. Copy that then paste it into the Immediate window (View>Immediate Window or Ctrl+G to bring it up in the IDE) immediately following a question mark like <code>?sheet1.Cells(lastrow, 6)</code>. Hit enter and you'll see what the value in the cell is. The <code>?</code> is shorthand for <code>Debug.Print</code>. This will evaluate the expression and show you what the cell contains. I'd also suggest using either <code>.Value</code> or <code>.Value2</code> since <code>Value</code> is the default member of <code>Range</code> that's accessed when nothing is specified. If you're interested <a href=\"https://fastexcel.wordpress.com/2011/11/30/text-vs-value-vs-value2-slow-text-and-how-to-avoid-it/\" rel=\"nofollow noreferrer\">https://fastexcel.wordpress.com/2011/11/30/text-vs-value-vs-value2-slow-text-and-how-to-avoid-it/</a>.</p>\n\n<pre><code>Sub test()\n    Dim lastrow As Long\n    lastrow = sheet1.Cells(Rows.Count, 1).End(xlUp).Row\n\n    Dim erow As Long\n    erow = sheet2.Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).Row\n\n    sheet2.Cells(erow, 1) = sheet1.Cells(lastrow, 6) * 2\n    sheet2.Cells(erow, 2) = sheet1.Cells(lastrow, 7)\nEnd Sub\n</code></pre>\n\n<p><strong>NOTE:</strong> I want to bring up that using <code>Dim sheet1 as Worksheet</code> is something that can cause conflict with a worksheets <code>CodeName</code> property, since it names them as <code>Sheet1, Sheet2, ... SheetN</code> by default. Potentially confusing if/when you use the worksheet CodeName to access worksheets.</p>\n"}], "owner": {"reputation": 716, "user_id": 6819959, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/53e270754d794040cf238ecd9093c6eb?s=128&d=identicon&r=PG&f=1", "display_name": "S31", "link": "https://stackoverflow.com/users/6819959/s31"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 50477730, "answer_count": 2, "score": 1, "last_activity_date": 1527031163, "creation_date": 1527022751, "last_edit_date": 1531164843, "question_id": 50476366, "link": "https://stackoverflow.com/questions/50476366/copy-and-paste-cell-range-while-multiplying-by-a-constant", "title": "Copy and paste cell range while multiplying by a constant", "body": "<p>Can someone explain to me why: </p>\n\n<pre><code>Sub test()\nDim lastrow As Integer, erow As Integer, sheet1 As Worksheet, sheet2 As Worksheet\n\nSet sheet1 = Worksheets(\"Sheet1\")\nSet sheet2 = Worksheets(\"Sheet2\")\n\nlastrow = sheet1.Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 1 To lastrow\n    erow = sheet2.Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).Row\n    sheet2.Cells(erow, 1) = sheet1.Cells(i, 6) \n    sheet2.Cells(erow, 2) = sheet1.Cells(i, 7)\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Works fine, and I can see why. But, if I make </p>\n\n<pre><code>    sheet2.Cells(erow, 1) = sheet1.Cells(i, 6) \n</code></pre>\n\n<p>multiply by a constant:</p>\n\n<pre><code>    sheet2.Cells(erow, 1) = sheet1.Cells(i, 6) * 2\n</code></pre>\n\n<p>I get a type mismatch error. </p>\n"}, {"tags": ["vba", "excel", "dictionary"], "comments": [{"owner": {"reputation": 23, "user_id": 9329588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cfe78216271e99596a97840ac42e891?s=128&d=identicon&r=PG&f=1", "display_name": "Cody Alan", "link": "https://stackoverflow.com/users/9329588/cody-alan"}, "edited": false, "score": 0, "creation_date": 1527022668, "post_id": 50476211, "comment_id": 87966240, "body": "Of course the second I post about it I figure it out.  The if statement is:  &quot;If GetKey(BeginningData, BeginningData.Item(StartItem)) = _         GetKey(BeginningData, BeginningData.Item(EndItem)) And _         BeginningData.Item(StartItem) &lt;&gt; EndingData.Item(StartItem) Then&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 9329588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cfe78216271e99596a97840ac42e891?s=128&d=identicon&r=PG&f=1", "display_name": "Cody Alan", "link": "https://stackoverflow.com/users/9329588/cody-alan"}, "is_accepted": false, "score": 0, "last_activity_date": 1527022817, "creation_date": 1527022817, "answer_id": 50476379, "question_id": 50476211, "link": "https://stackoverflow.com/questions/50476211/comparing-data-between-two-dictionaries-in-vba/50476379#50476379", "title": "Comparing data between two dictionaries in VBA", "body": "<p>The full working code to compare the two dictionaries and produce the output I needed is: </p>\n\n<pre><code>Sub WorkingProcess()\n\nDim BeginningData As Dictionary, EndingData As Dictionary\n\nDim StartItem As Variant, EndItem As Variant\n\nSet BeginningData = New Dictionary\nSet EndingData = New Dictionary\n\nWith BeginningData\n    .Add \"John Smith\", 111111111\n    .Add \"Jane Jones\", 222222222\n    .Add \"Jim Brown\", 333333333\nEnd With\n\nWith EndingData\n    .Add \"John Smith\", 111111111\n    .Add \"Jane Jones\", 444444444\n    .Add \"Jim Brown\", 333333333\nEnd With\n\nFor Each StartItem In BeginningData.Keys\n    For Each EndItem In EndingData.Keys\n\n        If GetKey(BeginningData, BeginningData.Item(StartItem)) = _\n        GetKey(BeginningData, BeginningData.Item(EndItem)) And _\n        BeginningData.Item(StartItem) &lt;&gt; EndingData.Item(StartItem) Then\n            Debug.Print _\n            GetKey(BeginningData, BeginningData.Item(EndItem)) &amp; _\n            \" is \" &amp; _\n            BeginningData.Item(StartItem) &amp; _\n            \" in the first dictionary, but is \" &amp; _\n            EndingData.Item(StartItem) &amp; _\n            \" in the second dictionary.\"\n        End If\n\n    Next\nNext\n\nEnd Sub\n\nFunction GetKey(Dic As Dictionary, strItem As String) As String\n    Dim key As Variant\n    For Each key In Dic.Keys\n        If Dic.Item(key) = strItem Then\n            GetKey = CStr(key)\n            Exit Function\n        End If\n    Next\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 9329588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cfe78216271e99596a97840ac42e891?s=128&d=identicon&r=PG&f=1", "display_name": "Cody Alan", "link": "https://stackoverflow.com/users/9329588/cody-alan"}, "edited": false, "score": 0, "creation_date": 1527078191, "post_id": 50480672, "comment_id": 87989385, "body": "Excellent.  This operates exponentially faster than my way."}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 2, "last_activity_date": 1527054452, "creation_date": 1527054452, "answer_id": 50480672, "question_id": 50476211, "link": "https://stackoverflow.com/questions/50476211/comparing-data-between-two-dictionaries-in-vba/50480672#50480672", "title": "Comparing data between two dictionaries in VBA", "body": "<p>you don't need neither nested loops nor <code>GetKey()</code> function,  just use <code>Exists()</code> method of <code>Dictionary</code> object to check for a dictionary to contain a given key:</p>\n\n<pre><code>Option Explicit\n\nSub WorkingProcess()\n    Dim BeginningData As Dictionary, EndingData As Dictionary\n\n    Dim BeginningItem As Variant\n\n    Set BeginningData = New Dictionary\n    Set EndingData = New Dictionary\n\n    With BeginningData\n        .Add \"John Smith\", 111111111\n        .Add \"Jane Jones\", 222222222\n        .Add \"Jim Brown\", 333333333\n    End With\n\n    With EndingData\n        .Add \"John Smith\", 111111111\n        .Add \"Jane Jones\", 444444444\n        .Add \"Jim Brown\", 333333333\n    End With\n\n    For Each BeginningItem In BeginningData.Keys\n        If EndingData.Exists(BeginningItem) Then ' if current \"beginning\" dict key is in \"ending\" dict\n            If BeginningData.Item(BeginningItem) &lt;&gt; EndingData.Item(BeginningItem) Then ' if items don't match\n                Debug.Print _\n                BeginningItem &amp; _\n                \" is \" &amp; _\n                BeginningData.Item(BeginningItem) &amp; _\n                \" in the first dictionary, but is \" &amp; _\n                EndingData.Item(BeginningItem) &amp; _\n                \" in the second dictionary.\"\n            End If\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9329588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cfe78216271e99596a97840ac42e891?s=128&d=identicon&r=PG&f=1", "display_name": "Cody Alan", "link": "https://stackoverflow.com/users/9329588/cody-alan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2818, "favorite_count": 1, "accepted_answer_id": 50480672, "answer_count": 2, "score": 1, "last_activity_date": 1527054452, "creation_date": 1527021987, "last_edit_date": 1531164843, "question_id": 50476211, "link": "https://stackoverflow.com/questions/50476211/comparing-data-between-two-dictionaries-in-vba", "title": "Comparing data between two dictionaries in VBA", "body": "<p>I am trying to compare the data in two dictionaries in order to identify keys which have different items.  I'm having difficulty writing out the loop and the if statement to make it that happen.</p>\n\n<p>In the below example, it makes two dictionaries--<strong>BeginningData</strong> and <strong>EndingData</strong>.  The Key \"Jane Jones\" has a different item in each dictionary.  </p>\n\n<p>The output I am looking for in this situation is: <em>\"Jane Jones is 222222222 in the first dictionary, but is 444444444 in the second dictionary\"</em> </p>\n\n<p>Any ideas on how I would complete this code?  I am trying to avoid arrays in this particular project.  Thanks!</p>\n\n<pre><code>Sub MainProcess()\n\nDim BeginningData As Dictionary, EndingData As Dictionary\n\nDim StartItem As Variant, EndItem As Variant\n\nSet BeginningData = New Dictionary\nSet EndingData = New Dictionary\n\nWith BeginningData\n    .Add \"John Smith\", 111111111\n    .Add \"Jane Jones\", 222222222\n    .Add \"Jim Brown\", 333333333\nEnd With\n\nWith EndingData\n    .Add \"John Smith\", 111111111\n    .Add \"Jane Jones\", 444444444\n    .Add \"Jim Brown\", 333333333\nEnd With\n\nFor Each StartItem In BeginningData.Keys\n    For Each EndItem In EndingData.Keys\n\n        'Some sort of if statement here\n            Debug.Print _\n            GetKey(BeginningData, BeginningData.Item(EndItem)) &amp; _\n            \" is \" &amp; _\n            BeginningData.Item(StartItem) &amp; _\n            \" in the first dictionary, but is \" &amp; _\n            EndingData.Item(StartItem) &amp; _\n            \" in the second dictionary.\"\n        End If\n\n    Next\nNext\n\nEnd Sub\n\nFunction GetKey(Dic As Dictionary, strItem As String) As String\n    Dim key As Variant\n    For Each key In Dic.Keys\n        If Dic.Item(key) = strItem Then\n            GetKey = CStr(key)\n            Exit Function\n        End If\n    Next\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1527019494, "post_id": 50475631, "comment_id": 87964806, "body": "Toss some breakpoints in there (Place your cursor on a line of code and hit F9). Then execute. Does the code execution stop on your breakpoint? If so, set the breakpoint farther down the code. Something funky is happening as your <code>msgbox</code> should absolutely fire (or an error should be thrown)."}, {"owner": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1527019944, "post_id": 50475631, "comment_id": 87965001, "body": "That is so weird.... I figured it out after setting a breakpoint. I needed to re-select the initial sheet with the target activecell highlighted. Thank you"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 1, "creation_date": 1527020002, "post_id": 50475631, "comment_id": 87965025, "body": "What do you expect from <code>Range(&quot;L1&quot;).SpecialCells(xlLastCell)</code>?"}, {"owner": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1527020351, "post_id": 50475631, "comment_id": 87965187, "body": "@JohnyL It is selecting my table in another sheet. All columns to the last row of data"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1527020386, "post_id": 50475631, "comment_id": 87965206, "body": "@carter it&#39;s not weird at all. Most bugs happen to be identifiable using the debugger. That said when you hit an error it&#39;s usually a good idea to include its description, and specifically which statement is throwing the error (make sure your VBE settings are set to &quot;break on unhandled errors&quot;). Lastly, read up on <a href=\"https://stackoverflow.com/q/10714251/1188513\">avoiding Select and Activate</a>, you don&#39;t need to <code>Select</code> anything here."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 2, "creation_date": 1527021110, "post_id": 50475631, "comment_id": 87965552, "body": "@carter It operates <i>only</i> on cell <code>L1</code>"}], "owner": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527019297, "creation_date": 1527019297, "last_edit_date": 1531164843, "question_id": 50475631, "link": "https://stackoverflow.com/questions/50475631/vlookup-syntax-and-msgbox-error", "title": "Vlookup Syntax and MsgBox Error", "body": "<p>I'm looking to use an active cell as reference to return values from another sheet using a vlookup. I have set my table array and that seems to work fine. </p>\n\n<p>I run the macro and nothing happens- no errors and the message box at the end will not show. I know the active cell matches a value in the table I am referencing so there should not be an N/A error. </p>\n\n<p>Then end goal is to have a Msgbox with last name and first name after clicking a button with this macro assigned. </p>\n\n<pre><code>Sub ContactInfo()\n\nDim name As String\nDim ArrayRange As Variant\nDim ActCell As Variant\n\nSet ActCell = ActiveCell.Value\n\nSheets(\"results\").Select\nArrayRange = Sheets(\"Results\").Range(Range(\"L1\"), Range(\"L1\").SpecialCells(xlLastCell))\n\nLastname = Application.WorksheetFunction.VLookup(ActCell, ArrayRange, 3, False)\nFirstname = Application.WorksheetFunction.VLookup(ActCell, ArrayRange, 2, False)\n\nMsgBox Lastname &amp; Firstname\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["validation", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1527031212, "post_id": 50475395, "comment_id": 87968997, "body": "In the field definition itself? Or by vba code in the form&#39;s before_update event? Update your question with the answer"}], "answers": [{"tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": true, "score": 2, "last_activity_date": 1527031990, "creation_date": 1527031990, "answer_id": 50477850, "question_id": 50475395, "link": "https://stackoverflow.com/questions/50475395/form-data-validation/50477850#50477850", "title": "Form data validation", "body": "<p>Regardless of how you decide to validate the input you can use the <code>INSTR</code> function to test for the existence of the string <code>\", \"</code></p>\n\n<p>Here's the example of adding to the Table's definition of your field in the Validation Rule and Validation Message</p>\n\n<p><strong>FIELD DEFINITIO</strong>N</p>\n\n<p><a href=\"https://i.stack.imgur.com/egwQR.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/egwQR.jpg\" alt=\"Validation Rule Setup\"></a></p>\n\n<p>With the table showing error message if you try to enter a name without the \", \"</p>\n\n<p><strong>VALIDATION ERROR MESSAGE</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/SNjm5.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SNjm5.jpg\" alt=\"Error Message\"></a></p>\n"}], "owner": {"reputation": 569, "user_id": 4564588, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/4flFk.jpg?s=128&g=1", "display_name": "Arsee", "link": "https://stackoverflow.com/users/4564588/arsee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 50477850, "answer_count": 1, "score": 0, "last_activity_date": 1594634681, "creation_date": 1527018271, "last_edit_date": 1594634681, "question_id": 50475395, "link": "https://stackoverflow.com/questions/50475395/form-data-validation", "title": "Form data validation", "body": "<p>I have a form that has a text box for Name, and the format is LASTNAME, FIRSTNAME.  How can I add a validation check to make sure the user enters a \",\" after the last name.</p>\n\n<p>For example: Name: DOE, JOHN instead of DOE JOHN</p>\n"}]